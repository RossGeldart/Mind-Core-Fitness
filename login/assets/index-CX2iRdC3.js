const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-CWaQTxY7.js","assets/scheduleUtils-a2tn0x12.js","assets/Dashboard-DylplTM0.css","assets/AddClient-BYlyoXxi.js","assets/AddClient-DH1OFzHo.css","assets/ClientDashboard-hqNAETvV.js","assets/ClientDashboard-CSizO3dZ.css","assets/ClientForms-DoX1_17k.js","assets/ClientForms-QNtUjQJR.css","assets/ClientTools-DdBf-BNM.js","assets/ClientTools-Bezn5TAX.css","assets/MacroCalculator-DY7EBZnx.js","assets/ProteinSnacks-CgAX18L0.js","assets/DailyMotivation-C-WpUR0X.js","assets/CircuitDashboard-fHHRm4CA.js","assets/CircuitDashboard-C8T0uect.css","assets/CircuitBooking-CrNT0XkP.js","assets/CircuitBooking-ruk9Q4Wj.css","assets/PersonalBests-CYli7v6P.js","assets/PersonalBests-BkG3fixu.css","assets/Leaderboard-ClXB510Z.js","assets/Leaderboard-Bul59-ui.css","assets/UpgradePage-CCpR5Ys_.js","assets/stripe-Da7IPrZW.js","assets/UpgradePage-COYPjotf.css","assets/Onboarding-BXl4HbkY.js","assets/Onboarding-Cu4GeezY.css"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function t(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(l){if(l.ep)return;l.ep=!0;const u=t(l);fetch(l.href,u)}})();var Tg={exports:{}},Kc={};var Hb;function ST(){if(Hb)return Kc;Hb=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,l,u){var d=null;if(u!==void 0&&(d=""+u),l.key!==void 0&&(d=""+l.key),"key"in l){u={};for(var g in l)g!=="key"&&(u[g]=l[g])}else u=l;return l=u.ref,{$$typeof:s,type:i,key:d,ref:l!==void 0?l:null,props:u}}return Kc.Fragment=e,Kc.jsx=t,Kc.jsxs=t,Kc}var qb;function CT(){return qb||(qb=1,Tg.exports=ST()),Tg.exports}var a=CT(),Sg={exports:{}},Ct={};var $b;function NT(){if($b)return Ct;$b=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),d=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),y=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),j=Symbol.for("react.activity"),S=Symbol.iterator;function R(U){return U===null||typeof U!="object"?null:(U=S&&U[S]||U["@@iterator"],typeof U=="function"?U:null)}var H={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},K=Object.assign,B={};function Y(U,le,Ce){this.props=U,this.context=le,this.refs=B,this.updater=Ce||H}Y.prototype.isReactComponent={},Y.prototype.setState=function(U,le){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,U,le,"setState")},Y.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};function Q(){}Q.prototype=Y.prototype;function Z(U,le,Ce){this.props=U,this.context=le,this.refs=B,this.updater=Ce||H}var ge=Z.prototype=new Q;ge.constructor=Z,K(ge,Y.prototype),ge.isPureReactComponent=!0;var xe=Array.isArray;function pe(){}var I={H:null,A:null,T:null,S:null},T=Object.prototype.hasOwnProperty;function L(U,le,Ce){var Se=Ce.ref;return{$$typeof:s,type:U,key:le,ref:Se!==void 0?Se:null,props:Ce}}function V(U,le){return L(U.type,le,U.props)}function P(U){return typeof U=="object"&&U!==null&&U.$$typeof===s}function D(U){var le={"=":"=0",":":"=2"};return"$"+U.replace(/[=:]/g,function(Ce){return le[Ce]})}var M=/\/+/g;function Me(U,le){return typeof U=="object"&&U!==null&&U.key!=null?D(""+U.key):le.toString(36)}function st(U){switch(U.status){case"fulfilled":return U.value;case"rejected":throw U.reason;default:switch(typeof U.status=="string"?U.then(pe,pe):(U.status="pending",U.then(function(le){U.status==="pending"&&(U.status="fulfilled",U.value=le)},function(le){U.status==="pending"&&(U.status="rejected",U.reason=le)})),U.status){case"fulfilled":return U.value;case"rejected":throw U.reason}}throw U}function J(U,le,Ce,Se,ve){var Oe=typeof U;(Oe==="undefined"||Oe==="boolean")&&(U=null);var Fe=!1;if(U===null)Fe=!0;else switch(Oe){case"bigint":case"string":case"number":Fe=!0;break;case"object":switch(U.$$typeof){case s:case e:Fe=!0;break;case b:return Fe=U._init,J(Fe(U._payload),le,Ce,Se,ve)}}if(Fe)return ve=ve(U),Fe=Se===""?"."+Me(U,0):Se,xe(ve)?(Ce="",Fe!=null&&(Ce=Fe.replace(M,"$&/")+"/"),J(ve,le,Ce,"",function(sn){return sn})):ve!=null&&(P(ve)&&(ve=V(ve,Ce+(ve.key==null||U&&U.key===ve.key?"":(""+ve.key).replace(M,"$&/")+"/")+Fe)),le.push(ve)),1;Fe=0;var Ge=Se===""?".":Se+":";if(xe(U))for(var tt=0;tt<U.length;tt++)Se=U[tt],Oe=Ge+Me(Se,tt),Fe+=J(Se,le,Ce,Oe,ve);else if(tt=R(U),typeof tt=="function")for(U=tt.call(U),tt=0;!(Se=U.next()).done;)Se=Se.value,Oe=Ge+Me(Se,tt++),Fe+=J(Se,le,Ce,Oe,ve);else if(Oe==="object"){if(typeof U.then=="function")return J(st(U),le,Ce,Se,ve);throw le=String(U),Error("Objects are not valid as a React child (found: "+(le==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":le)+"). If you meant to render a collection of children, use an array instead.")}return Fe}function Te(U,le,Ce){if(U==null)return U;var Se=[],ve=0;return J(U,Se,"","",function(Oe){return le.call(Ce,Oe,ve++)}),Se}function Ue(U){if(U._status===-1){var le=U._result;le=le(),le.then(function(Ce){(U._status===0||U._status===-1)&&(U._status=1,U._result=Ce)},function(Ce){(U._status===0||U._status===-1)&&(U._status=2,U._result=Ce)}),U._status===-1&&(U._status=0,U._result=le)}if(U._status===1)return U._result.default;throw U._result}var Ne=typeof reportError=="function"?reportError:function(U){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var le=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof U=="object"&&U!==null&&typeof U.message=="string"?String(U.message):String(U),error:U});if(!window.dispatchEvent(le))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",U);return}console.error(U)},ze={map:Te,forEach:function(U,le,Ce){Te(U,function(){le.apply(this,arguments)},Ce)},count:function(U){var le=0;return Te(U,function(){le++}),le},toArray:function(U){return Te(U,function(le){return le})||[]},only:function(U){if(!P(U))throw Error("React.Children.only expected to receive a single React element child.");return U}};return Ct.Activity=j,Ct.Children=ze,Ct.Component=Y,Ct.Fragment=t,Ct.Profiler=l,Ct.PureComponent=Z,Ct.StrictMode=i,Ct.Suspense=y,Ct.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=I,Ct.__COMPILER_RUNTIME={__proto__:null,c:function(U){return I.H.useMemoCache(U)}},Ct.cache=function(U){return function(){return U.apply(null,arguments)}},Ct.cacheSignal=function(){return null},Ct.cloneElement=function(U,le,Ce){if(U==null)throw Error("The argument must be a React element, but you passed "+U+".");var Se=K({},U.props),ve=U.key;if(le!=null)for(Oe in le.key!==void 0&&(ve=""+le.key),le)!T.call(le,Oe)||Oe==="key"||Oe==="__self"||Oe==="__source"||Oe==="ref"&&le.ref===void 0||(Se[Oe]=le[Oe]);var Oe=arguments.length-2;if(Oe===1)Se.children=Ce;else if(1<Oe){for(var Fe=Array(Oe),Ge=0;Ge<Oe;Ge++)Fe[Ge]=arguments[Ge+2];Se.children=Fe}return L(U.type,ve,Se)},Ct.createContext=function(U){return U={$$typeof:d,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null},U.Provider=U,U.Consumer={$$typeof:u,_context:U},U},Ct.createElement=function(U,le,Ce){var Se,ve={},Oe=null;if(le!=null)for(Se in le.key!==void 0&&(Oe=""+le.key),le)T.call(le,Se)&&Se!=="key"&&Se!=="__self"&&Se!=="__source"&&(ve[Se]=le[Se]);var Fe=arguments.length-2;if(Fe===1)ve.children=Ce;else if(1<Fe){for(var Ge=Array(Fe),tt=0;tt<Fe;tt++)Ge[tt]=arguments[tt+2];ve.children=Ge}if(U&&U.defaultProps)for(Se in Fe=U.defaultProps,Fe)ve[Se]===void 0&&(ve[Se]=Fe[Se]);return L(U,Oe,ve)},Ct.createRef=function(){return{current:null}},Ct.forwardRef=function(U){return{$$typeof:g,render:U}},Ct.isValidElement=P,Ct.lazy=function(U){return{$$typeof:b,_payload:{_status:-1,_result:U},_init:Ue}},Ct.memo=function(U,le){return{$$typeof:p,type:U,compare:le===void 0?null:le}},Ct.startTransition=function(U){var le=I.T,Ce={};I.T=Ce;try{var Se=U(),ve=I.S;ve!==null&&ve(Ce,Se),typeof Se=="object"&&Se!==null&&typeof Se.then=="function"&&Se.then(pe,Ne)}catch(Oe){Ne(Oe)}finally{le!==null&&Ce.types!==null&&(le.types=Ce.types),I.T=le}},Ct.unstable_useCacheRefresh=function(){return I.H.useCacheRefresh()},Ct.use=function(U){return I.H.use(U)},Ct.useActionState=function(U,le,Ce){return I.H.useActionState(U,le,Ce)},Ct.useCallback=function(U,le){return I.H.useCallback(U,le)},Ct.useContext=function(U){return I.H.useContext(U)},Ct.useDebugValue=function(){},Ct.useDeferredValue=function(U,le){return I.H.useDeferredValue(U,le)},Ct.useEffect=function(U,le){return I.H.useEffect(U,le)},Ct.useEffectEvent=function(U){return I.H.useEffectEvent(U)},Ct.useId=function(){return I.H.useId()},Ct.useImperativeHandle=function(U,le,Ce){return I.H.useImperativeHandle(U,le,Ce)},Ct.useInsertionEffect=function(U,le){return I.H.useInsertionEffect(U,le)},Ct.useLayoutEffect=function(U,le){return I.H.useLayoutEffect(U,le)},Ct.useMemo=function(U,le){return I.H.useMemo(U,le)},Ct.useOptimistic=function(U,le){return I.H.useOptimistic(U,le)},Ct.useReducer=function(U,le,Ce){return I.H.useReducer(U,le,Ce)},Ct.useRef=function(U){return I.H.useRef(U)},Ct.useState=function(U){return I.H.useState(U)},Ct.useSyncExternalStore=function(U,le,Ce){return I.H.useSyncExternalStore(U,le,Ce)},Ct.useTransition=function(){return I.H.useTransition()},Ct.version="19.2.4",Ct}var Wb;function Xp(){return Wb||(Wb=1,Sg.exports=NT()),Sg.exports}var w=Xp(),Cg={exports:{}},Yc={},Ng={exports:{}},Ag={};var Gb;function AT(){return Gb||(Gb=1,(function(s){function e(J,Te){var Ue=J.length;J.push(Te);e:for(;0<Ue;){var Ne=Ue-1>>>1,ze=J[Ne];if(0<l(ze,Te))J[Ne]=Te,J[Ue]=ze,Ue=Ne;else break e}}function t(J){return J.length===0?null:J[0]}function i(J){if(J.length===0)return null;var Te=J[0],Ue=J.pop();if(Ue!==Te){J[0]=Ue;e:for(var Ne=0,ze=J.length,U=ze>>>1;Ne<U;){var le=2*(Ne+1)-1,Ce=J[le],Se=le+1,ve=J[Se];if(0>l(Ce,Ue))Se<ze&&0>l(ve,Ce)?(J[Ne]=ve,J[Se]=Ue,Ne=Se):(J[Ne]=Ce,J[le]=Ue,Ne=le);else if(Se<ze&&0>l(ve,Ue))J[Ne]=ve,J[Se]=Ue,Ne=Se;else break e}}return Te}function l(J,Te){var Ue=J.sortIndex-Te.sortIndex;return Ue!==0?Ue:J.id-Te.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;s.unstable_now=function(){return u.now()}}else{var d=Date,g=d.now();s.unstable_now=function(){return d.now()-g}}var y=[],p=[],b=1,j=null,S=3,R=!1,H=!1,K=!1,B=!1,Y=typeof setTimeout=="function"?setTimeout:null,Q=typeof clearTimeout=="function"?clearTimeout:null,Z=typeof setImmediate<"u"?setImmediate:null;function ge(J){for(var Te=t(p);Te!==null;){if(Te.callback===null)i(p);else if(Te.startTime<=J)i(p),Te.sortIndex=Te.expirationTime,e(y,Te);else break;Te=t(p)}}function xe(J){if(K=!1,ge(J),!H)if(t(y)!==null)H=!0,pe||(pe=!0,D());else{var Te=t(p);Te!==null&&st(xe,Te.startTime-J)}}var pe=!1,I=-1,T=5,L=-1;function V(){return B?!0:!(s.unstable_now()-L<T)}function P(){if(B=!1,pe){var J=s.unstable_now();L=J;var Te=!0;try{e:{H=!1,K&&(K=!1,Q(I),I=-1),R=!0;var Ue=S;try{t:{for(ge(J),j=t(y);j!==null&&!(j.expirationTime>J&&V());){var Ne=j.callback;if(typeof Ne=="function"){j.callback=null,S=j.priorityLevel;var ze=Ne(j.expirationTime<=J);if(J=s.unstable_now(),typeof ze=="function"){j.callback=ze,ge(J),Te=!0;break t}j===t(y)&&i(y),ge(J)}else i(y);j=t(y)}if(j!==null)Te=!0;else{var U=t(p);U!==null&&st(xe,U.startTime-J),Te=!1}}break e}finally{j=null,S=Ue,R=!1}Te=void 0}}finally{Te?D():pe=!1}}}var D;if(typeof Z=="function")D=function(){Z(P)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,Me=M.port2;M.port1.onmessage=P,D=function(){Me.postMessage(null)}}else D=function(){Y(P,0)};function st(J,Te){I=Y(function(){J(s.unstable_now())},Te)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(J){J.callback=null},s.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<J?Math.floor(1e3/J):5},s.unstable_getCurrentPriorityLevel=function(){return S},s.unstable_next=function(J){switch(S){case 1:case 2:case 3:var Te=3;break;default:Te=S}var Ue=S;S=Te;try{return J()}finally{S=Ue}},s.unstable_requestPaint=function(){B=!0},s.unstable_runWithPriority=function(J,Te){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var Ue=S;S=J;try{return Te()}finally{S=Ue}},s.unstable_scheduleCallback=function(J,Te,Ue){var Ne=s.unstable_now();switch(typeof Ue=="object"&&Ue!==null?(Ue=Ue.delay,Ue=typeof Ue=="number"&&0<Ue?Ne+Ue:Ne):Ue=Ne,J){case 1:var ze=-1;break;case 2:ze=250;break;case 5:ze=1073741823;break;case 4:ze=1e4;break;default:ze=5e3}return ze=Ue+ze,J={id:b++,callback:Te,priorityLevel:J,startTime:Ue,expirationTime:ze,sortIndex:-1},Ue>Ne?(J.sortIndex=Ue,e(p,J),t(y)===null&&J===t(p)&&(K?(Q(I),I=-1):K=!0,st(xe,Ue-Ne))):(J.sortIndex=ze,e(y,J),H||R||(H=!0,pe||(pe=!0,D()))),J},s.unstable_shouldYield=V,s.unstable_wrapCallback=function(J){var Te=S;return function(){var Ue=S;S=Te;try{return J.apply(this,arguments)}finally{S=Ue}}}})(Ag)),Ag}var Kb;function RT(){return Kb||(Kb=1,Ng.exports=AT()),Ng.exports}var Rg={exports:{}},qs={};var Yb;function IT(){if(Yb)return qs;Yb=1;var s=Xp();function e(y){var p="https://react.dev/errors/"+y;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)p+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+y+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},l=Symbol.for("react.portal");function u(y,p,b){var j=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:j==null?null:""+j,children:y,containerInfo:p,implementation:b}}var d=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function g(y,p){if(y==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return qs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,qs.createPortal=function(y,p){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return u(y,p,null,b)},qs.flushSync=function(y){var p=d.T,b=i.p;try{if(d.T=null,i.p=2,y)return y()}finally{d.T=p,i.p=b,i.d.f()}},qs.preconnect=function(y,p){typeof y=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,i.d.C(y,p))},qs.prefetchDNS=function(y){typeof y=="string"&&i.d.D(y)},qs.preinit=function(y,p){if(typeof y=="string"&&p&&typeof p.as=="string"){var b=p.as,j=g(b,p.crossOrigin),S=typeof p.integrity=="string"?p.integrity:void 0,R=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;b==="style"?i.d.S(y,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:j,integrity:S,fetchPriority:R}):b==="script"&&i.d.X(y,{crossOrigin:j,integrity:S,fetchPriority:R,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},qs.preinitModule=function(y,p){if(typeof y=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var b=g(p.as,p.crossOrigin);i.d.M(y,{crossOrigin:b,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&i.d.M(y)},qs.preload=function(y,p){if(typeof y=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var b=p.as,j=g(b,p.crossOrigin);i.d.L(y,b,{crossOrigin:j,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},qs.preloadModule=function(y,p){if(typeof y=="string")if(p){var b=g(p.as,p.crossOrigin);i.d.m(y,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:b,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else i.d.m(y)},qs.requestFormReset=function(y){i.d.r(y)},qs.unstable_batchedUpdates=function(y,p){return y(p)},qs.useFormState=function(y,p,b){return d.H.useFormState(y,p,b)},qs.useFormStatus=function(){return d.H.useHostTransitionStatus()},qs.version="19.2.4",qs}var Qb;function MT(){if(Qb)return Rg.exports;Qb=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Rg.exports=IT(),Rg.exports}var Xb;function DT(){if(Xb)return Yc;Xb=1;var s=RT(),e=Xp(),t=MT();function i(n){var r="https://react.dev/errors/"+n;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)r+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+n+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function u(n){var r=n,o=n;if(n.alternate)for(;r.return;)r=r.return;else{n=r;do r=n,(r.flags&4098)!==0&&(o=r.return),n=r.return;while(n)}return r.tag===3?o:null}function d(n){if(n.tag===13){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function g(n){if(n.tag===31){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function y(n){if(u(n)!==n)throw Error(i(188))}function p(n){var r=n.alternate;if(!r){if(r=u(n),r===null)throw Error(i(188));return r!==n?null:n}for(var o=n,c=r;;){var f=o.return;if(f===null)break;var m=f.alternate;if(m===null){if(c=f.return,c!==null){o=c;continue}break}if(f.child===m.child){for(m=f.child;m;){if(m===o)return y(f),n;if(m===c)return y(f),r;m=m.sibling}throw Error(i(188))}if(o.return!==c.return)o=f,c=m;else{for(var x=!1,E=f.child;E;){if(E===o){x=!0,o=f,c=m;break}if(E===c){x=!0,c=f,o=m;break}E=E.sibling}if(!x){for(E=m.child;E;){if(E===o){x=!0,o=m,c=f;break}if(E===c){x=!0,c=m,o=f;break}E=E.sibling}if(!x)throw Error(i(189))}}if(o.alternate!==c)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?n:r}function b(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n;for(n=n.child;n!==null;){if(r=b(n),r!==null)return r;n=n.sibling}return null}var j=Object.assign,S=Symbol.for("react.element"),R=Symbol.for("react.transitional.element"),H=Symbol.for("react.portal"),K=Symbol.for("react.fragment"),B=Symbol.for("react.strict_mode"),Y=Symbol.for("react.profiler"),Q=Symbol.for("react.consumer"),Z=Symbol.for("react.context"),ge=Symbol.for("react.forward_ref"),xe=Symbol.for("react.suspense"),pe=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),L=Symbol.for("react.activity"),V=Symbol.for("react.memo_cache_sentinel"),P=Symbol.iterator;function D(n){return n===null||typeof n!="object"?null:(n=P&&n[P]||n["@@iterator"],typeof n=="function"?n:null)}var M=Symbol.for("react.client.reference");function Me(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===M?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case K:return"Fragment";case Y:return"Profiler";case B:return"StrictMode";case xe:return"Suspense";case pe:return"SuspenseList";case L:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case H:return"Portal";case Z:return n.displayName||"Context";case Q:return(n._context.displayName||"Context")+".Consumer";case ge:var r=n.render;return n=n.displayName,n||(n=r.displayName||r.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case I:return r=n.displayName||null,r!==null?r:Me(n.type)||"Memo";case T:r=n._payload,n=n._init;try{return Me(n(r))}catch{}}return null}var st=Array.isArray,J=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Te=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ue={pending:!1,data:null,method:null,action:null},Ne=[],ze=-1;function U(n){return{current:n}}function le(n){0>ze||(n.current=Ne[ze],Ne[ze]=null,ze--)}function Ce(n,r){ze++,Ne[ze]=n.current,n.current=r}var Se=U(null),ve=U(null),Oe=U(null),Fe=U(null);function Ge(n,r){switch(Ce(Oe,r),Ce(ve,n),Ce(Se,null),r.nodeType){case 9:case 11:n=(n=r.documentElement)&&(n=n.namespaceURI)?hb(n):0;break;default:if(n=r.tagName,r=r.namespaceURI)r=hb(r),n=fb(r,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}le(Se),Ce(Se,n)}function tt(){le(Se),le(ve),le(Oe)}function sn(n){n.memoizedState!==null&&Ce(Fe,n);var r=Se.current,o=fb(r,n.type);r!==o&&(Ce(ve,n),Ce(Se,o))}function Tt(n){ve.current===n&&(le(Se),le(ve)),Fe.current===n&&(le(Fe),qc._currentValue=Ue)}var _n,gn;function Mt(n){if(_n===void 0)try{throw Error()}catch(o){var r=o.stack.trim().match(/\n( *(at )?)/);_n=r&&r[1]||"",gn=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+_n+n+gn}var ct=!1;function Bt(n,r){if(!n||ct)return"";ct=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(r){var _e=function(){throw Error()};if(Object.defineProperty(_e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(_e,[])}catch(fe){var ce=fe}Reflect.construct(n,[],_e)}else{try{_e.call()}catch(fe){ce=fe}n.call(_e.prototype)}}else{try{throw Error()}catch(fe){ce=fe}(_e=n())&&typeof _e.catch=="function"&&_e.catch(function(){})}}catch(fe){if(fe&&ce&&typeof fe.stack=="string")return[fe.stack,ce.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=c.DetermineComponentFrameRoot(),x=m[0],E=m[1];if(x&&E){var z=x.split(`
`),ie=E.split(`
`);for(f=c=0;c<z.length&&!z[c].includes("DetermineComponentFrameRoot");)c++;for(;f<ie.length&&!ie[f].includes("DetermineComponentFrameRoot");)f++;if(c===z.length||f===ie.length)for(c=z.length-1,f=ie.length-1;1<=c&&0<=f&&z[c]!==ie[f];)f--;for(;1<=c&&0<=f;c--,f--)if(z[c]!==ie[f]){if(c!==1||f!==1)do if(c--,f--,0>f||z[c]!==ie[f]){var ye=`
`+z[c].replace(" at new "," at ");return n.displayName&&ye.includes("<anonymous>")&&(ye=ye.replace("<anonymous>",n.displayName)),ye}while(1<=c&&0<=f);break}}}finally{ct=!1,Error.prepareStackTrace=o}return(o=n?n.displayName||n.name:"")?Mt(o):""}function rt(n,r){switch(n.tag){case 26:case 27:case 5:return Mt(n.type);case 16:return Mt("Lazy");case 13:return n.child!==r&&r!==null?Mt("Suspense Fallback"):Mt("Suspense");case 19:return Mt("SuspenseList");case 0:case 15:return Bt(n.type,!1);case 11:return Bt(n.type.render,!1);case 1:return Bt(n.type,!0);case 31:return Mt("Activity");default:return""}}function Vt(n){try{var r="",o=null;do r+=rt(n,o),o=n,n=n.return;while(n);return r}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var ue=Object.prototype.hasOwnProperty,kt=s.unstable_scheduleCallback,jt=s.unstable_cancelCallback,gt=s.unstable_shouldYield,Qe=s.unstable_requestPaint,ut=s.unstable_now,Wt=s.unstable_getCurrentPriorityLevel,en=s.unstable_ImmediatePriority,Gn=s.unstable_UserBlockingPriority,un=s.unstable_NormalPriority,Qn=s.unstable_LowPriority,Fn=s.unstable_IdlePriority,Rn=s.log,Ln=s.unstable_setDisableYieldValue,tn=null,zt=null;function bt(n){if(typeof Rn=="function"&&Ln(n),zt&&typeof zt.setStrictMode=="function")try{zt.setStrictMode(tn,n)}catch{}}var At=Math.clz32?Math.clz32:ae,ee=Math.log,C=Math.LN2;function ae(n){return n>>>=0,n===0?32:31-(ee(n)/C|0)|0}var Re=256,De=262144,Le=4194304;function qe(n){var r=n&42;if(r!==0)return r;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function Pe(n,r,o){var c=n.pendingLanes;if(c===0)return 0;var f=0,m=n.suspendedLanes,x=n.pingedLanes;n=n.warmLanes;var E=c&134217727;return E!==0?(c=E&~m,c!==0?f=qe(c):(x&=E,x!==0?f=qe(x):o||(o=E&~n,o!==0&&(f=qe(o))))):(E=c&~m,E!==0?f=qe(E):x!==0?f=qe(x):o||(o=c&~n,o!==0&&(f=qe(o)))),f===0?0:r!==0&&r!==f&&(r&m)===0&&(m=f&-f,o=r&-r,m>=o||m===32&&(o&4194048)!==0)?r:f}function Dt(n,r){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&r)===0}function yt(n,r){switch(n){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function at(){var n=Le;return Le<<=1,(Le&62914560)===0&&(Le=4194304),n}function oe(n){for(var r=[],o=0;31>o;o++)r.push(n);return r}function Ae(n,r){n.pendingLanes|=r,r!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function Xe(n,r,o,c,f,m){var x=n.pendingLanes;n.pendingLanes=o,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=o,n.entangledLanes&=o,n.errorRecoveryDisabledLanes&=o,n.shellSuspendCounter=0;var E=n.entanglements,z=n.expirationTimes,ie=n.hiddenUpdates;for(o=x&~o;0<o;){var ye=31-At(o),_e=1<<ye;E[ye]=0,z[ye]=-1;var ce=ie[ye];if(ce!==null)for(ie[ye]=null,ye=0;ye<ce.length;ye++){var fe=ce[ye];fe!==null&&(fe.lane&=-536870913)}o&=~_e}c!==0&&pt(n,c,0),m!==0&&f===0&&n.tag!==0&&(n.suspendedLanes|=m&~(x&~r))}function pt(n,r,o){n.pendingLanes|=r,n.suspendedLanes&=~r;var c=31-At(r);n.entangledLanes|=r,n.entanglements[c]=n.entanglements[c]|1073741824|o&261930}function ot(n,r){var o=n.entangledLanes|=r;for(n=n.entanglements;o;){var c=31-At(o),f=1<<c;f&r|n[c]&r&&(n[c]|=r),o&=~f}}function Gt(n,r){var o=r&-r;return o=(o&42)!==0?1:bn(o),(o&(n.suspendedLanes|r))!==0?0:o}function bn(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function Ht(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function on(){var n=Te.p;return n!==0?n:(n=window.event,n===void 0?32:Ob(n.type))}function Cn(n,r){var o=Te.p;try{return Te.p=n,r()}finally{Te.p=o}}var On=Math.random().toString(36).slice(2),Nn="__reactFiber$"+On,an="__reactProps$"+On,as="__reactContainer$"+On,br="__reactEvents$"+On,ya="__reactListeners$"+On,gi="__reactHandles$"+On,Lr="__reactResources$"+On,js="__reactMarker$"+On;function Es(n){delete n[Nn],delete n[an],delete n[br],delete n[ya],delete n[gi]}function Ts(n){var r=n[Nn];if(r)return r;for(var o=n.parentNode;o;){if(r=o[as]||o[Nn]){if(o=r.alternate,r.child!==null||o!==null&&o.child!==null)for(n=wb(n);n!==null;){if(o=n[Nn])return o;n=wb(n)}return r}n=o,o=n.parentNode}return null}function os(n){if(n=n[Nn]||n[as]){var r=n.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return n}return null}function In(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n.stateNode;throw Error(i(33))}function Xn(n){var r=n[Lr];return r||(r=n[Lr]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function pn(n){n[js]=!0}var Jn=new Set,Jr={};function Ds(n,r){Zn(n,r),Zn(n+"Capture",r)}function Zn(n,r){for(Jr[n]=r,n=0;n<r.length;n++)Jn.add(r[n])}var fs=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Xs={},Zr={};function O(n){return ue.call(Zr,n)?!0:ue.call(Xs,n)?!1:fs.test(n)?Zr[n]=!0:(Xs[n]=!0,!1)}function q(n,r,o){if(O(r))if(o===null)n.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":n.removeAttribute(r);return;case"boolean":var c=r.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){n.removeAttribute(r);return}}n.setAttribute(r,""+o)}}function se(n,r,o){if(o===null)n.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(r);return}n.setAttribute(r,""+o)}}function te(n,r,o,c){if(c===null)n.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(o);return}n.setAttributeNS(r,o,""+c)}}function $e(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Ke(n){var r=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function Ye(n,r,o){var c=Object.getOwnPropertyDescriptor(n.constructor.prototype,r);if(!n.hasOwnProperty(r)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var f=c.get,m=c.set;return Object.defineProperty(n,r,{configurable:!0,get:function(){return f.call(this)},set:function(x){o=""+x,m.call(this,x)}}),Object.defineProperty(n,r,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(x){o=""+x},stopTracking:function(){n._valueTracker=null,delete n[r]}}}}function it(n){if(!n._valueTracker){var r=Ke(n)?"checked":"value";n._valueTracker=Ye(n,r,""+n[r])}}function Et(n){if(!n)return!1;var r=n._valueTracker;if(!r)return!0;var o=r.getValue(),c="";return n&&(c=Ke(n)?n.checked?"true":"false":n.value),n=c,n!==o?(r.setValue(n),!0):!1}function kn(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var Ns=/[\n"\\]/g;function es(n){return n.replace(Ns,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function As(n,r,o,c,f,m,x,E){n.name="",x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?n.type=x:n.removeAttribute("type"),r!=null?x==="number"?(r===0&&n.value===""||n.value!=r)&&(n.value=""+$e(r)):n.value!==""+$e(r)&&(n.value=""+$e(r)):x!=="submit"&&x!=="reset"||n.removeAttribute("value"),r!=null?Ls(n,x,$e(r)):o!=null?Ls(n,x,$e(o)):c!=null&&n.removeAttribute("value"),f==null&&m!=null&&(n.defaultChecked=!!m),f!=null&&(n.checked=f&&typeof f!="function"&&typeof f!="symbol"),E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?n.name=""+$e(E):n.removeAttribute("name")}function ei(n,r,o,c,f,m,x,E){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(n.type=m),r!=null||o!=null){if(!(m!=="submit"&&m!=="reset"||r!=null)){it(n);return}o=o!=null?""+$e(o):"",r=r!=null?""+$e(r):o,E||r===n.value||(n.value=r),n.defaultValue=r}c=c??f,c=typeof c!="function"&&typeof c!="symbol"&&!!c,n.checked=E?n.checked:!!c,n.defaultChecked=!!c,x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(n.name=x),it(n)}function Ls(n,r,o){r==="number"&&kn(n.ownerDocument)===n||n.defaultValue===""+o||(n.defaultValue=""+o)}function Js(n,r,o,c){if(n=n.options,r){r={};for(var f=0;f<o.length;f++)r["$"+o[f]]=!0;for(o=0;o<n.length;o++)f=r.hasOwnProperty("$"+n[o].value),n[o].selected!==f&&(n[o].selected=f),f&&c&&(n[o].defaultSelected=!0)}else{for(o=""+$e(o),r=null,f=0;f<n.length;f++){if(n[f].value===o){n[f].selected=!0,c&&(n[f].defaultSelected=!0);return}r!==null||n[f].disabled||(r=n[f])}r!==null&&(r.selected=!0)}}function va(n,r,o){if(r!=null&&(r=""+$e(r),r!==n.value&&(n.value=r),o==null)){n.defaultValue!==r&&(n.defaultValue=r);return}n.defaultValue=o!=null?""+$e(o):""}function wr(n,r,o,c){if(r==null){if(c!=null){if(o!=null)throw Error(i(92));if(st(c)){if(1<c.length)throw Error(i(93));c=c[0]}o=c}o==null&&(o=""),r=o}o=$e(r),n.defaultValue=o,c=n.textContent,c===o&&c!==""&&c!==null&&(n.value=c),it(n)}function Rs(n,r){if(r){var o=n.firstChild;if(o&&o===n.lastChild&&o.nodeType===3){o.nodeValue=r;return}}n.textContent=r}var ba=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Li(n,r,o){var c=r.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?n.setProperty(r,""):r==="float"?n.cssFloat="":n[r]="":c?n.setProperty(r,o):typeof o!="number"||o===0||ba.has(r)?r==="float"?n.cssFloat=o:n[r]=(""+o).trim():n[r]=o+"px"}function xr(n,r,o){if(r!=null&&typeof r!="object")throw Error(i(62));if(n=n.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||r!=null&&r.hasOwnProperty(c)||(c.indexOf("--")===0?n.setProperty(c,""):c==="float"?n.cssFloat="":n[c]="");for(var f in r)c=r[f],r.hasOwnProperty(f)&&o[f]!==c&&Li(n,f,c)}else for(var m in r)r.hasOwnProperty(m)&&Li(n,m,r[m])}function ti(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Hs=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),_r=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function pi(n){return _r.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function Zs(){}var er=null;function F(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var k=null,N=null;function $(n){var r=os(n);if(r&&(n=r.stateNode)){var o=n[an]||null;e:switch(n=r.stateNode,r.type){case"input":if(As(n,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),r=o.name,o.type==="radio"&&r!=null){for(o=n;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+es(""+r)+'"][type="radio"]'),r=0;r<o.length;r++){var c=o[r];if(c!==n&&c.form===n.form){var f=c[an]||null;if(!f)throw Error(i(90));As(c,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(r=0;r<o.length;r++)c=o[r],c.form===n.form&&Et(c)}break e;case"textarea":va(n,o.value,o.defaultValue);break e;case"select":r=o.value,r!=null&&Js(n,!!o.multiple,r,!1)}}}var G=!1;function de(n,r,o){if(G)return n(r,o);G=!0;try{var c=n(r);return c}finally{if(G=!1,(k!==null||N!==null)&&(Ud(),k&&(r=k,n=N,N=k=null,$(r),n)))for(r=0;r<n.length;r++)$(n[r])}}function ke(n,r){var o=n.stateNode;if(o===null)return null;var c=o[an]||null;if(c===null)return null;o=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(n=n.type,c=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!c;break e;default:n=!1}if(n)return null;if(o&&typeof o!="function")throw Error(i(231,r,typeof o));return o}var Ee=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ve=!1;if(Ee)try{var Ie={};Object.defineProperty(Ie,"passive",{get:function(){Ve=!0}}),window.addEventListener("test",Ie,Ie),window.removeEventListener("test",Ie,Ie)}catch{Ve=!1}var Ze=null,Ut=null,Mn=null;function ft(){if(Mn)return Mn;var n,r=Ut,o=r.length,c,f="value"in Ze?Ze.value:Ze.textContent,m=f.length;for(n=0;n<o&&r[n]===f[n];n++);var x=o-n;for(c=1;c<=x&&r[o-c]===f[m-c];c++);return Mn=f.slice(n,1<c?1-c:void 0)}function dn(n){var r=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&r===13&&(n=13)):n=r,n===10&&(n=13),32<=n||n===13?n:0}function hn(){return!0}function mt(){return!1}function Lt(n){function r(o,c,f,m,x){this._reactName=o,this._targetInst=f,this.type=c,this.nativeEvent=m,this.target=x,this.currentTarget=null;for(var E in n)n.hasOwnProperty(E)&&(o=n[E],this[E]=o?o(m):m[E]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?hn:mt,this.isPropagationStopped=mt,this}return j(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=hn)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=hn)},persist:function(){},isPersistent:hn}),r}var ls={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Pn=Lt(ls),Kn=j({},ls,{view:0,detail:0}),Vn=Lt(Kn),Hn,ur,kr,wa=j({},Kn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xa,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==kr&&(kr&&n.type==="mousemove"?(Hn=n.screenX-kr.screenX,ur=n.screenY-kr.screenY):ur=Hn=0,kr=n),Hn)},movementY:function(n){return"movementY"in n?n.movementY:ur}}),Oi=Lt(wa),fo=j({},wa,{dataTransfer:0}),Gu=Lt(fo),Ku=j({},Kn,{relatedTarget:0}),mo=Lt(Ku),dc=j({},ls,{animationName:0,elapsedTime:0,pseudoElement:0}),Yu=Lt(dc),sl=j({},ls,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Qu=Lt(sl),Xu=j({},ls,{data:0}),yi=Lt(Xu),Ju={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Zu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ed={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function td(n){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(n):(n=ed[n])?!!r[n]:!1}function xa(){return td}var tr=j({},Kn,{key:function(n){if(n.key){var r=Ju[n.key]||n.key;if(r!=="Unidentified")return r}return n.type==="keypress"?(n=dn(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Zu[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xa,charCode:function(n){return n.type==="keypress"?dn(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?dn(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),nd=Lt(tr),sd=j({},wa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Pi=Lt(sd),h=j({},Kn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xa}),v=Lt(h),_=j({},ls,{propertyName:0,elapsedTime:0,pseudoElement:0}),A=Lt(_),ne=j({},wa,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),he=Lt(ne),Be=j({},ls,{newState:0,oldState:0}),Rt=Lt(Be),cs=[9,13,27,32],fn=Ee&&"CompositionEvent"in window,qn=null;Ee&&"documentMode"in document&&(qn=document.documentMode);var Or=Ee&&"TextEvent"in window&&!qn,vi=Ee&&(!fn||qn&&8<qn&&11>=qn),ni=" ",si=!1;function go(n,r){switch(n){case"keyup":return cs.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rl(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var il=!1;function Xj(n,r){switch(n){case"compositionend":return rl(r);case"keypress":return r.which!==32?null:(si=!0,ni);case"textInput":return n=r.data,n===ni&&si?null:n;default:return null}}function Jj(n,r){if(il)return n==="compositionend"||!fn&&go(n,r)?(n=ft(),Mn=Ut=Ze=null,il=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return vi&&r.locale!=="ko"?null:r.data;default:return null}}var Zj={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function k0(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r==="input"?!!Zj[n.type]:r==="textarea"}function j0(n,r,o,c){k?N?N.push(c):N=[c]:k=c,r=Wd(r,"onChange"),0<r.length&&(o=new Pn("onChange","change",null,o,c),n.push({event:o,listeners:r}))}var hc=null,fc=null;function eE(n){ab(n,0)}function rd(n){var r=In(n);if(Et(r))return n}function E0(n,r){if(n==="change")return r}var T0=!1;if(Ee){var Mf;if(Ee){var Df="oninput"in document;if(!Df){var S0=document.createElement("div");S0.setAttribute("oninput","return;"),Df=typeof S0.oninput=="function"}Mf=Df}else Mf=!1;T0=Mf&&(!document.documentMode||9<document.documentMode)}function C0(){hc&&(hc.detachEvent("onpropertychange",N0),fc=hc=null)}function N0(n){if(n.propertyName==="value"&&rd(fc)){var r=[];j0(r,fc,n,F(n)),de(eE,r)}}function tE(n,r,o){n==="focusin"?(C0(),hc=r,fc=o,hc.attachEvent("onpropertychange",N0)):n==="focusout"&&C0()}function nE(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return rd(fc)}function sE(n,r){if(n==="click")return rd(r)}function rE(n,r){if(n==="input"||n==="change")return rd(r)}function iE(n,r){return n===r&&(n!==0||1/n===1/r)||n!==n&&r!==r}var jr=typeof Object.is=="function"?Object.is:iE;function mc(n,r){if(jr(n,r))return!0;if(typeof n!="object"||n===null||typeof r!="object"||r===null)return!1;var o=Object.keys(n),c=Object.keys(r);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var f=o[c];if(!ue.call(r,f)||!jr(n[f],r[f]))return!1}return!0}function A0(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function R0(n,r){var o=A0(n);n=0;for(var c;o;){if(o.nodeType===3){if(c=n+o.textContent.length,n<=r&&c>=r)return{node:o,offset:r-n};n=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=A0(o)}}function I0(n,r){return n&&r?n===r?!0:n&&n.nodeType===3?!1:r&&r.nodeType===3?I0(n,r.parentNode):"contains"in n?n.contains(r):n.compareDocumentPosition?!!(n.compareDocumentPosition(r)&16):!1:!1}function M0(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var r=kn(n.document);r instanceof n.HTMLIFrameElement;){try{var o=typeof r.contentWindow.location.href=="string"}catch{o=!1}if(o)n=r.contentWindow;else break;r=kn(n.document)}return r}function Lf(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r&&(r==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||r==="textarea"||n.contentEditable==="true")}var aE=Ee&&"documentMode"in document&&11>=document.documentMode,al=null,Of=null,gc=null,Pf=!1;function D0(n,r,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Pf||al==null||al!==kn(c)||(c=al,"selectionStart"in c&&Lf(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),gc&&mc(gc,c)||(gc=c,c=Wd(Of,"onSelect"),0<c.length&&(r=new Pn("onSelect","select",null,r,o),n.push({event:r,listeners:c}),r.target=al)))}function po(n,r){var o={};return o[n.toLowerCase()]=r.toLowerCase(),o["Webkit"+n]="webkit"+r,o["Moz"+n]="moz"+r,o}var ol={animationend:po("Animation","AnimationEnd"),animationiteration:po("Animation","AnimationIteration"),animationstart:po("Animation","AnimationStart"),transitionrun:po("Transition","TransitionRun"),transitionstart:po("Transition","TransitionStart"),transitioncancel:po("Transition","TransitionCancel"),transitionend:po("Transition","TransitionEnd")},Vf={},L0={};Ee&&(L0=document.createElement("div").style,"AnimationEvent"in window||(delete ol.animationend.animation,delete ol.animationiteration.animation,delete ol.animationstart.animation),"TransitionEvent"in window||delete ol.transitionend.transition);function yo(n){if(Vf[n])return Vf[n];if(!ol[n])return n;var r=ol[n],o;for(o in r)if(r.hasOwnProperty(o)&&o in L0)return Vf[n]=r[o];return n}var O0=yo("animationend"),P0=yo("animationiteration"),V0=yo("animationstart"),oE=yo("transitionrun"),lE=yo("transitionstart"),cE=yo("transitioncancel"),U0=yo("transitionend"),B0=new Map,Uf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Uf.push("scrollEnd");function ri(n,r){B0.set(n,r),Ds(r,[n])}var id=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},Pr=[],ll=0,Bf=0;function ad(){for(var n=ll,r=Bf=ll=0;r<n;){var o=Pr[r];Pr[r++]=null;var c=Pr[r];Pr[r++]=null;var f=Pr[r];Pr[r++]=null;var m=Pr[r];if(Pr[r++]=null,c!==null&&f!==null){var x=c.pending;x===null?f.next=f:(f.next=x.next,x.next=f),c.pending=f}m!==0&&z0(o,f,m)}}function od(n,r,o,c){Pr[ll++]=n,Pr[ll++]=r,Pr[ll++]=o,Pr[ll++]=c,Bf|=c,n.lanes|=c,n=n.alternate,n!==null&&(n.lanes|=c)}function zf(n,r,o,c){return od(n,r,o,c),ld(n)}function vo(n,r){return od(n,null,null,r),ld(n)}function z0(n,r,o){n.lanes|=o;var c=n.alternate;c!==null&&(c.lanes|=o);for(var f=!1,m=n.return;m!==null;)m.childLanes|=o,c=m.alternate,c!==null&&(c.childLanes|=o),m.tag===22&&(n=m.stateNode,n===null||n._visibility&1||(f=!0)),n=m,m=m.return;return n.tag===3?(m=n.stateNode,f&&r!==null&&(f=31-At(o),n=m.hiddenUpdates,c=n[f],c===null?n[f]=[r]:c.push(r),r.lane=o|536870912),m):null}function ld(n){if(50<Pc)throw Pc=0,Qm=null,Error(i(185));for(var r=n.return;r!==null;)n=r,r=n.return;return n.tag===3?n.stateNode:null}var cl={};function uE(n,r,o,c){this.tag=n,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Er(n,r,o,c){return new uE(n,r,o,c)}function Ff(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Vi(n,r){var o=n.alternate;return o===null?(o=Er(n.tag,r,n.key,n.mode),o.elementType=n.elementType,o.type=n.type,o.stateNode=n.stateNode,o.alternate=n,n.alternate=o):(o.pendingProps=r,o.type=n.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=n.flags&65011712,o.childLanes=n.childLanes,o.lanes=n.lanes,o.child=n.child,o.memoizedProps=n.memoizedProps,o.memoizedState=n.memoizedState,o.updateQueue=n.updateQueue,r=n.dependencies,o.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},o.sibling=n.sibling,o.index=n.index,o.ref=n.ref,o.refCleanup=n.refCleanup,o}function F0(n,r){n.flags&=65011714;var o=n.alternate;return o===null?(n.childLanes=0,n.lanes=r,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,r=o.dependencies,n.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),n}function cd(n,r,o,c,f,m){var x=0;if(c=n,typeof n=="function")Ff(n)&&(x=1);else if(typeof n=="string")x=gT(n,o,Se.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case L:return n=Er(31,o,r,f),n.elementType=L,n.lanes=m,n;case K:return bo(o.children,f,m,r);case B:x=8,f|=24;break;case Y:return n=Er(12,o,r,f|2),n.elementType=Y,n.lanes=m,n;case xe:return n=Er(13,o,r,f),n.elementType=xe,n.lanes=m,n;case pe:return n=Er(19,o,r,f),n.elementType=pe,n.lanes=m,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case Z:x=10;break e;case Q:x=9;break e;case ge:x=11;break e;case I:x=14;break e;case T:x=16,c=null;break e}x=29,o=Error(i(130,n===null?"null":typeof n,"")),c=null}return r=Er(x,o,r,f),r.elementType=n,r.type=c,r.lanes=m,r}function bo(n,r,o,c){return n=Er(7,n,c,r),n.lanes=o,n}function Hf(n,r,o){return n=Er(6,n,null,r),n.lanes=o,n}function H0(n){var r=Er(18,null,null,0);return r.stateNode=n,r}function qf(n,r,o){return r=Er(4,n.children!==null?n.children:[],n.key,r),r.lanes=o,r.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},r}var q0=new WeakMap;function Vr(n,r){if(typeof n=="object"&&n!==null){var o=q0.get(n);return o!==void 0?o:(r={value:n,source:r,stack:Vt(r)},q0.set(n,r),r)}return{value:n,source:r,stack:Vt(r)}}var ul=[],dl=0,ud=null,pc=0,Ur=[],Br=0,_a=null,bi=1,wi="";function Ui(n,r){ul[dl++]=pc,ul[dl++]=ud,ud=n,pc=r}function $0(n,r,o){Ur[Br++]=bi,Ur[Br++]=wi,Ur[Br++]=_a,_a=n;var c=bi;n=wi;var f=32-At(c)-1;c&=~(1<<f),o+=1;var m=32-At(r)+f;if(30<m){var x=f-f%5;m=(c&(1<<x)-1).toString(32),c>>=x,f-=x,bi=1<<32-At(r)+f|o<<f|c,wi=m+n}else bi=1<<m|o<<f|c,wi=n}function $f(n){n.return!==null&&(Ui(n,1),$0(n,1,0))}function Wf(n){for(;n===ud;)ud=ul[--dl],ul[dl]=null,pc=ul[--dl],ul[dl]=null;for(;n===_a;)_a=Ur[--Br],Ur[Br]=null,wi=Ur[--Br],Ur[Br]=null,bi=Ur[--Br],Ur[Br]=null}function W0(n,r){Ur[Br++]=bi,Ur[Br++]=wi,Ur[Br++]=_a,bi=r.id,wi=r.overflow,_a=n}var Os=null,Un=null,nn=!1,ka=null,zr=!1,Gf=Error(i(519));function ja(n){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw yc(Vr(r,n)),Gf}function G0(n){var r=n.stateNode,o=n.type,c=n.memoizedProps;switch(r[Nn]=n,r[an]=c,o){case"dialog":$t("cancel",r),$t("close",r);break;case"iframe":case"object":case"embed":$t("load",r);break;case"video":case"audio":for(o=0;o<Uc.length;o++)$t(Uc[o],r);break;case"source":$t("error",r);break;case"img":case"image":case"link":$t("error",r),$t("load",r);break;case"details":$t("toggle",r);break;case"input":$t("invalid",r),ei(r,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":$t("invalid",r);break;case"textarea":$t("invalid",r),wr(r,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||r.textContent===""+o||c.suppressHydrationWarning===!0||ub(r.textContent,o)?(c.popover!=null&&($t("beforetoggle",r),$t("toggle",r)),c.onScroll!=null&&$t("scroll",r),c.onScrollEnd!=null&&$t("scrollend",r),c.onClick!=null&&(r.onclick=Zs),r=!0):r=!1,r||ja(n,!0)}function K0(n){for(Os=n.return;Os;)switch(Os.tag){case 5:case 31:case 13:zr=!1;return;case 27:case 3:zr=!0;return;default:Os=Os.return}}function hl(n){if(n!==Os)return!1;if(!nn)return K0(n),nn=!0,!1;var r=n.tag,o;if((o=r!==3&&r!==27)&&((o=r===5)&&(o=n.type,o=!(o!=="form"&&o!=="button")||dg(n.type,n.memoizedProps)),o=!o),o&&Un&&ja(n),K0(n),r===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));Un=bb(n)}else if(r===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));Un=bb(n)}else r===27?(r=Un,Va(n.type)?(n=pg,pg=null,Un=n):Un=r):Un=Os?Hr(n.stateNode.nextSibling):null;return!0}function wo(){Un=Os=null,nn=!1}function Kf(){var n=ka;return n!==null&&(mr===null?mr=n:mr.push.apply(mr,n),ka=null),n}function yc(n){ka===null?ka=[n]:ka.push(n)}var Yf=U(null),xo=null,Bi=null;function Ea(n,r,o){Ce(Yf,r._currentValue),r._currentValue=o}function zi(n){n._currentValue=Yf.current,le(Yf)}function Qf(n,r,o){for(;n!==null;){var c=n.alternate;if((n.childLanes&r)!==r?(n.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),n===o)break;n=n.return}}function Xf(n,r,o,c){var f=n.child;for(f!==null&&(f.return=n);f!==null;){var m=f.dependencies;if(m!==null){var x=f.child;m=m.firstContext;e:for(;m!==null;){var E=m;m=f;for(var z=0;z<r.length;z++)if(E.context===r[z]){m.lanes|=o,E=m.alternate,E!==null&&(E.lanes|=o),Qf(m.return,o,n),c||(x=null);break e}m=E.next}}else if(f.tag===18){if(x=f.return,x===null)throw Error(i(341));x.lanes|=o,m=x.alternate,m!==null&&(m.lanes|=o),Qf(x,o,n),x=null}else x=f.child;if(x!==null)x.return=f;else for(x=f;x!==null;){if(x===n){x=null;break}if(f=x.sibling,f!==null){f.return=x.return,x=f;break}x=x.return}f=x}}function fl(n,r,o,c){n=null;for(var f=r,m=!1;f!==null;){if(!m){if((f.flags&524288)!==0)m=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var x=f.alternate;if(x===null)throw Error(i(387));if(x=x.memoizedProps,x!==null){var E=f.type;jr(f.pendingProps.value,x.value)||(n!==null?n.push(E):n=[E])}}else if(f===Fe.current){if(x=f.alternate,x===null)throw Error(i(387));x.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(n!==null?n.push(qc):n=[qc])}f=f.return}n!==null&&Xf(r,n,o,c),r.flags|=262144}function dd(n){for(n=n.firstContext;n!==null;){if(!jr(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function _o(n){xo=n,Bi=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Ps(n){return Y0(xo,n)}function hd(n,r){return xo===null&&_o(n),Y0(n,r)}function Y0(n,r){var o=r._currentValue;if(r={context:r,memoizedValue:o,next:null},Bi===null){if(n===null)throw Error(i(308));Bi=r,n.dependencies={lanes:0,firstContext:r},n.flags|=524288}else Bi=Bi.next=r;return o}var dE=typeof AbortController<"u"?AbortController:function(){var n=[],r=this.signal={aborted:!1,addEventListener:function(o,c){n.push(c)}};this.abort=function(){r.aborted=!0,n.forEach(function(o){return o()})}},hE=s.unstable_scheduleCallback,fE=s.unstable_NormalPriority,ms={$$typeof:Z,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Jf(){return{controller:new dE,data:new Map,refCount:0}}function vc(n){n.refCount--,n.refCount===0&&hE(fE,function(){n.controller.abort()})}var bc=null,Zf=0,ml=0,gl=null;function mE(n,r){if(bc===null){var o=bc=[];Zf=0,ml=ng(),gl={status:"pending",value:void 0,then:function(c){o.push(c)}}}return Zf++,r.then(Q0,Q0),r}function Q0(){if(--Zf===0&&bc!==null){gl!==null&&(gl.status="fulfilled");var n=bc;bc=null,ml=0,gl=null;for(var r=0;r<n.length;r++)(0,n[r])()}}function gE(n,r){var o=[],c={status:"pending",value:null,reason:null,then:function(f){o.push(f)}};return n.then(function(){c.status="fulfilled",c.value=r;for(var f=0;f<o.length;f++)(0,o[f])(r)},function(f){for(c.status="rejected",c.reason=f,f=0;f<o.length;f++)(0,o[f])(void 0)}),c}var X0=J.S;J.S=function(n,r){D1=ut(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&mE(n,r),X0!==null&&X0(n,r)};var ko=U(null);function em(){var n=ko.current;return n!==null?n:An.pooledCache}function fd(n,r){r===null?Ce(ko,ko.current):Ce(ko,r.pool)}function J0(){var n=em();return n===null?null:{parent:ms._currentValue,pool:n}}var pl=Error(i(460)),tm=Error(i(474)),md=Error(i(542)),gd={then:function(){}};function Z0(n){return n=n.status,n==="fulfilled"||n==="rejected"}function ev(n,r,o){switch(o=n[o],o===void 0?n.push(r):o!==r&&(r.then(Zs,Zs),r=o),r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,nv(n),n;default:if(typeof r.status=="string")r.then(Zs,Zs);else{if(n=An,n!==null&&100<n.shellSuspendCounter)throw Error(i(482));n=r,n.status="pending",n.then(function(c){if(r.status==="pending"){var f=r;f.status="fulfilled",f.value=c}},function(c){if(r.status==="pending"){var f=r;f.status="rejected",f.reason=c}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,nv(n),n}throw Eo=r,pl}}function jo(n){try{var r=n._init;return r(n._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(Eo=o,pl):o}}var Eo=null;function tv(){if(Eo===null)throw Error(i(459));var n=Eo;return Eo=null,n}function nv(n){if(n===pl||n===md)throw Error(i(483))}var yl=null,wc=0;function pd(n){var r=wc;return wc+=1,yl===null&&(yl=[]),ev(yl,n,r)}function xc(n,r){r=r.props.ref,n.ref=r!==void 0?r:null}function yd(n,r){throw r.$$typeof===S?Error(i(525)):(n=Object.prototype.toString.call(r),Error(i(31,n==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":n)))}function sv(n){function r(X,W){if(n){var re=X.deletions;re===null?(X.deletions=[W],X.flags|=16):re.push(W)}}function o(X,W){if(!n)return null;for(;W!==null;)r(X,W),W=W.sibling;return null}function c(X){for(var W=new Map;X!==null;)X.key!==null?W.set(X.key,X):W.set(X.index,X),X=X.sibling;return W}function f(X,W){return X=Vi(X,W),X.index=0,X.sibling=null,X}function m(X,W,re){return X.index=re,n?(re=X.alternate,re!==null?(re=re.index,re<W?(X.flags|=67108866,W):re):(X.flags|=67108866,W)):(X.flags|=1048576,W)}function x(X){return n&&X.alternate===null&&(X.flags|=67108866),X}function E(X,W,re,we){return W===null||W.tag!==6?(W=Hf(re,X.mode,we),W.return=X,W):(W=f(W,re),W.return=X,W)}function z(X,W,re,we){var dt=re.type;return dt===K?ye(X,W,re.props.children,we,re.key):W!==null&&(W.elementType===dt||typeof dt=="object"&&dt!==null&&dt.$$typeof===T&&jo(dt)===W.type)?(W=f(W,re.props),xc(W,re),W.return=X,W):(W=cd(re.type,re.key,re.props,null,X.mode,we),xc(W,re),W.return=X,W)}function ie(X,W,re,we){return W===null||W.tag!==4||W.stateNode.containerInfo!==re.containerInfo||W.stateNode.implementation!==re.implementation?(W=qf(re,X.mode,we),W.return=X,W):(W=f(W,re.children||[]),W.return=X,W)}function ye(X,W,re,we,dt){return W===null||W.tag!==7?(W=bo(re,X.mode,we,dt),W.return=X,W):(W=f(W,re),W.return=X,W)}function _e(X,W,re){if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return W=Hf(""+W,X.mode,re),W.return=X,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case R:return re=cd(W.type,W.key,W.props,null,X.mode,re),xc(re,W),re.return=X,re;case H:return W=qf(W,X.mode,re),W.return=X,W;case T:return W=jo(W),_e(X,W,re)}if(st(W)||D(W))return W=bo(W,X.mode,re,null),W.return=X,W;if(typeof W.then=="function")return _e(X,pd(W),re);if(W.$$typeof===Z)return _e(X,hd(X,W),re);yd(X,W)}return null}function ce(X,W,re,we){var dt=W!==null?W.key:null;if(typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint")return dt!==null?null:E(X,W,""+re,we);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case R:return re.key===dt?z(X,W,re,we):null;case H:return re.key===dt?ie(X,W,re,we):null;case T:return re=jo(re),ce(X,W,re,we)}if(st(re)||D(re))return dt!==null?null:ye(X,W,re,we,null);if(typeof re.then=="function")return ce(X,W,pd(re),we);if(re.$$typeof===Z)return ce(X,W,hd(X,re),we);yd(X,re)}return null}function fe(X,W,re,we,dt){if(typeof we=="string"&&we!==""||typeof we=="number"||typeof we=="bigint")return X=X.get(re)||null,E(W,X,""+we,dt);if(typeof we=="object"&&we!==null){switch(we.$$typeof){case R:return X=X.get(we.key===null?re:we.key)||null,z(W,X,we,dt);case H:return X=X.get(we.key===null?re:we.key)||null,ie(W,X,we,dt);case T:return we=jo(we),fe(X,W,re,we,dt)}if(st(we)||D(we))return X=X.get(re)||null,ye(W,X,we,dt,null);if(typeof we.then=="function")return fe(X,W,re,pd(we),dt);if(we.$$typeof===Z)return fe(X,W,re,hd(W,we),dt);yd(W,we)}return null}function et(X,W,re,we){for(var dt=null,ln=null,nt=W,Ot=W=0,Yt=null;nt!==null&&Ot<re.length;Ot++){nt.index>Ot?(Yt=nt,nt=null):Yt=nt.sibling;var cn=ce(X,nt,re[Ot],we);if(cn===null){nt===null&&(nt=Yt);break}n&&nt&&cn.alternate===null&&r(X,nt),W=m(cn,W,Ot),ln===null?dt=cn:ln.sibling=cn,ln=cn,nt=Yt}if(Ot===re.length)return o(X,nt),nn&&Ui(X,Ot),dt;if(nt===null){for(;Ot<re.length;Ot++)nt=_e(X,re[Ot],we),nt!==null&&(W=m(nt,W,Ot),ln===null?dt=nt:ln.sibling=nt,ln=nt);return nn&&Ui(X,Ot),dt}for(nt=c(nt);Ot<re.length;Ot++)Yt=fe(nt,X,Ot,re[Ot],we),Yt!==null&&(n&&Yt.alternate!==null&&nt.delete(Yt.key===null?Ot:Yt.key),W=m(Yt,W,Ot),ln===null?dt=Yt:ln.sibling=Yt,ln=Yt);return n&&nt.forEach(function(Ha){return r(X,Ha)}),nn&&Ui(X,Ot),dt}function vt(X,W,re,we){if(re==null)throw Error(i(151));for(var dt=null,ln=null,nt=W,Ot=W=0,Yt=null,cn=re.next();nt!==null&&!cn.done;Ot++,cn=re.next()){nt.index>Ot?(Yt=nt,nt=null):Yt=nt.sibling;var Ha=ce(X,nt,cn.value,we);if(Ha===null){nt===null&&(nt=Yt);break}n&&nt&&Ha.alternate===null&&r(X,nt),W=m(Ha,W,Ot),ln===null?dt=Ha:ln.sibling=Ha,ln=Ha,nt=Yt}if(cn.done)return o(X,nt),nn&&Ui(X,Ot),dt;if(nt===null){for(;!cn.done;Ot++,cn=re.next())cn=_e(X,cn.value,we),cn!==null&&(W=m(cn,W,Ot),ln===null?dt=cn:ln.sibling=cn,ln=cn);return nn&&Ui(X,Ot),dt}for(nt=c(nt);!cn.done;Ot++,cn=re.next())cn=fe(nt,X,Ot,cn.value,we),cn!==null&&(n&&cn.alternate!==null&&nt.delete(cn.key===null?Ot:cn.key),W=m(cn,W,Ot),ln===null?dt=cn:ln.sibling=cn,ln=cn);return n&&nt.forEach(function(TT){return r(X,TT)}),nn&&Ui(X,Ot),dt}function Tn(X,W,re,we){if(typeof re=="object"&&re!==null&&re.type===K&&re.key===null&&(re=re.props.children),typeof re=="object"&&re!==null){switch(re.$$typeof){case R:e:{for(var dt=re.key;W!==null;){if(W.key===dt){if(dt=re.type,dt===K){if(W.tag===7){o(X,W.sibling),we=f(W,re.props.children),we.return=X,X=we;break e}}else if(W.elementType===dt||typeof dt=="object"&&dt!==null&&dt.$$typeof===T&&jo(dt)===W.type){o(X,W.sibling),we=f(W,re.props),xc(we,re),we.return=X,X=we;break e}o(X,W);break}else r(X,W);W=W.sibling}re.type===K?(we=bo(re.props.children,X.mode,we,re.key),we.return=X,X=we):(we=cd(re.type,re.key,re.props,null,X.mode,we),xc(we,re),we.return=X,X=we)}return x(X);case H:e:{for(dt=re.key;W!==null;){if(W.key===dt)if(W.tag===4&&W.stateNode.containerInfo===re.containerInfo&&W.stateNode.implementation===re.implementation){o(X,W.sibling),we=f(W,re.children||[]),we.return=X,X=we;break e}else{o(X,W);break}else r(X,W);W=W.sibling}we=qf(re,X.mode,we),we.return=X,X=we}return x(X);case T:return re=jo(re),Tn(X,W,re,we)}if(st(re))return et(X,W,re,we);if(D(re)){if(dt=D(re),typeof dt!="function")throw Error(i(150));return re=dt.call(re),vt(X,W,re,we)}if(typeof re.then=="function")return Tn(X,W,pd(re),we);if(re.$$typeof===Z)return Tn(X,W,hd(X,re),we);yd(X,re)}return typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint"?(re=""+re,W!==null&&W.tag===6?(o(X,W.sibling),we=f(W,re),we.return=X,X=we):(o(X,W),we=Hf(re,X.mode,we),we.return=X,X=we),x(X)):o(X,W)}return function(X,W,re,we){try{wc=0;var dt=Tn(X,W,re,we);return yl=null,dt}catch(nt){if(nt===pl||nt===md)throw nt;var ln=Er(29,nt,null,X.mode);return ln.lanes=we,ln.return=X,ln}}}var To=sv(!0),rv=sv(!1),Ta=!1;function nm(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function sm(n,r){n=n.updateQueue,r.updateQueue===n&&(r.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Sa(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Ca(n,r,o){var c=n.updateQueue;if(c===null)return null;if(c=c.shared,(mn&2)!==0){var f=c.pending;return f===null?r.next=r:(r.next=f.next,f.next=r),c.pending=r,r=ld(n),z0(n,null,o),r}return od(n,c,r,o),ld(n)}function _c(n,r,o){if(r=r.updateQueue,r!==null&&(r=r.shared,(o&4194048)!==0)){var c=r.lanes;c&=n.pendingLanes,o|=c,r.lanes=o,ot(n,o)}}function rm(n,r){var o=n.updateQueue,c=n.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var f=null,m=null;if(o=o.firstBaseUpdate,o!==null){do{var x={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};m===null?f=m=x:m=m.next=x,o=o.next}while(o!==null);m===null?f=m=r:m=m.next=r}else f=m=r;o={baseState:c.baseState,firstBaseUpdate:f,lastBaseUpdate:m,shared:c.shared,callbacks:c.callbacks},n.updateQueue=o;return}n=o.lastBaseUpdate,n===null?o.firstBaseUpdate=r:n.next=r,o.lastBaseUpdate=r}var im=!1;function kc(){if(im){var n=gl;if(n!==null)throw n}}function jc(n,r,o,c){im=!1;var f=n.updateQueue;Ta=!1;var m=f.firstBaseUpdate,x=f.lastBaseUpdate,E=f.shared.pending;if(E!==null){f.shared.pending=null;var z=E,ie=z.next;z.next=null,x===null?m=ie:x.next=ie,x=z;var ye=n.alternate;ye!==null&&(ye=ye.updateQueue,E=ye.lastBaseUpdate,E!==x&&(E===null?ye.firstBaseUpdate=ie:E.next=ie,ye.lastBaseUpdate=z))}if(m!==null){var _e=f.baseState;x=0,ye=ie=z=null,E=m;do{var ce=E.lane&-536870913,fe=ce!==E.lane;if(fe?(Kt&ce)===ce:(c&ce)===ce){ce!==0&&ce===ml&&(im=!0),ye!==null&&(ye=ye.next={lane:0,tag:E.tag,payload:E.payload,callback:null,next:null});e:{var et=n,vt=E;ce=r;var Tn=o;switch(vt.tag){case 1:if(et=vt.payload,typeof et=="function"){_e=et.call(Tn,_e,ce);break e}_e=et;break e;case 3:et.flags=et.flags&-65537|128;case 0:if(et=vt.payload,ce=typeof et=="function"?et.call(Tn,_e,ce):et,ce==null)break e;_e=j({},_e,ce);break e;case 2:Ta=!0}}ce=E.callback,ce!==null&&(n.flags|=64,fe&&(n.flags|=8192),fe=f.callbacks,fe===null?f.callbacks=[ce]:fe.push(ce))}else fe={lane:ce,tag:E.tag,payload:E.payload,callback:E.callback,next:null},ye===null?(ie=ye=fe,z=_e):ye=ye.next=fe,x|=ce;if(E=E.next,E===null){if(E=f.shared.pending,E===null)break;fe=E,E=fe.next,fe.next=null,f.lastBaseUpdate=fe,f.shared.pending=null}}while(!0);ye===null&&(z=_e),f.baseState=z,f.firstBaseUpdate=ie,f.lastBaseUpdate=ye,m===null&&(f.shared.lanes=0),Ma|=x,n.lanes=x,n.memoizedState=_e}}function iv(n,r){if(typeof n!="function")throw Error(i(191,n));n.call(r)}function av(n,r){var o=n.callbacks;if(o!==null)for(n.callbacks=null,n=0;n<o.length;n++)iv(o[n],r)}var vl=U(null),vd=U(0);function ov(n,r){n=Qi,Ce(vd,n),Ce(vl,r),Qi=n|r.baseLanes}function am(){Ce(vd,Qi),Ce(vl,vl.current)}function om(){Qi=vd.current,le(vl),le(vd)}var Tr=U(null),Fr=null;function Na(n){var r=n.alternate;Ce(us,us.current&1),Ce(Tr,n),Fr===null&&(r===null||vl.current!==null||r.memoizedState!==null)&&(Fr=n)}function lm(n){Ce(us,us.current),Ce(Tr,n),Fr===null&&(Fr=n)}function lv(n){n.tag===22?(Ce(us,us.current),Ce(Tr,n),Fr===null&&(Fr=n)):Aa()}function Aa(){Ce(us,us.current),Ce(Tr,Tr.current)}function Sr(n){le(Tr),Fr===n&&(Fr=null),le(us)}var us=U(0);function bd(n){for(var r=n;r!==null;){if(r.tag===13){var o=r.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||mg(o)||gg(o)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Fi=0,It=null,jn=null,gs=null,wd=!1,bl=!1,So=!1,xd=0,Ec=0,wl=null,pE=0;function ts(){throw Error(i(321))}function cm(n,r){if(r===null)return!1;for(var o=0;o<r.length&&o<n.length;o++)if(!jr(n[o],r[o]))return!1;return!0}function um(n,r,o,c,f,m){return Fi=m,It=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,J.H=n===null||n.memoizedState===null?$v:Em,So=!1,m=o(c,f),So=!1,bl&&(m=uv(r,o,c,f)),cv(n),m}function cv(n){J.H=Cc;var r=jn!==null&&jn.next!==null;if(Fi=0,gs=jn=It=null,wd=!1,Ec=0,wl=null,r)throw Error(i(300));n===null||ps||(n=n.dependencies,n!==null&&dd(n)&&(ps=!0))}function uv(n,r,o,c){It=n;var f=0;do{if(bl&&(wl=null),Ec=0,bl=!1,25<=f)throw Error(i(301));if(f+=1,gs=jn=null,n.updateQueue!=null){var m=n.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}J.H=Wv,m=r(o,c)}while(bl);return m}function yE(){var n=J.H,r=n.useState()[0];return r=typeof r.then=="function"?Tc(r):r,n=n.useState()[0],(jn!==null?jn.memoizedState:null)!==n&&(It.flags|=1024),r}function dm(){var n=xd!==0;return xd=0,n}function hm(n,r,o){r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~o}function fm(n){if(wd){for(n=n.memoizedState;n!==null;){var r=n.queue;r!==null&&(r.pending=null),n=n.next}wd=!1}Fi=0,gs=jn=It=null,bl=!1,Ec=xd=0,wl=null}function nr(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gs===null?It.memoizedState=gs=n:gs=gs.next=n,gs}function ds(){if(jn===null){var n=It.alternate;n=n!==null?n.memoizedState:null}else n=jn.next;var r=gs===null?It.memoizedState:gs.next;if(r!==null)gs=r,jn=n;else{if(n===null)throw It.alternate===null?Error(i(467)):Error(i(310));jn=n,n={memoizedState:jn.memoizedState,baseState:jn.baseState,baseQueue:jn.baseQueue,queue:jn.queue,next:null},gs===null?It.memoizedState=gs=n:gs=gs.next=n}return gs}function _d(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Tc(n){var r=Ec;return Ec+=1,wl===null&&(wl=[]),n=ev(wl,n,r),r=It,(gs===null?r.memoizedState:gs.next)===null&&(r=r.alternate,J.H=r===null||r.memoizedState===null?$v:Em),n}function kd(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return Tc(n);if(n.$$typeof===Z)return Ps(n)}throw Error(i(438,String(n)))}function mm(n){var r=null,o=It.updateQueue;if(o!==null&&(r=o.memoCache),r==null){var c=It.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(r={data:c.data.map(function(f){return f.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),o===null&&(o=_d(),It.updateQueue=o),o.memoCache=r,o=r.data[r.index],o===void 0)for(o=r.data[r.index]=Array(n),c=0;c<n;c++)o[c]=V;return r.index++,o}function Hi(n,r){return typeof r=="function"?r(n):r}function jd(n){var r=ds();return gm(r,jn,n)}function gm(n,r,o){var c=n.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=o;var f=n.baseQueue,m=c.pending;if(m!==null){if(f!==null){var x=f.next;f.next=m.next,m.next=x}r.baseQueue=f=m,c.pending=null}if(m=n.baseState,f===null)n.memoizedState=m;else{r=f.next;var E=x=null,z=null,ie=r,ye=!1;do{var _e=ie.lane&-536870913;if(_e!==ie.lane?(Kt&_e)===_e:(Fi&_e)===_e){var ce=ie.revertLane;if(ce===0)z!==null&&(z=z.next={lane:0,revertLane:0,gesture:null,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null}),_e===ml&&(ye=!0);else if((Fi&ce)===ce){ie=ie.next,ce===ml&&(ye=!0);continue}else _e={lane:0,revertLane:ie.revertLane,gesture:null,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null},z===null?(E=z=_e,x=m):z=z.next=_e,It.lanes|=ce,Ma|=ce;_e=ie.action,So&&o(m,_e),m=ie.hasEagerState?ie.eagerState:o(m,_e)}else ce={lane:_e,revertLane:ie.revertLane,gesture:ie.gesture,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null},z===null?(E=z=ce,x=m):z=z.next=ce,It.lanes|=_e,Ma|=_e;ie=ie.next}while(ie!==null&&ie!==r);if(z===null?x=m:z.next=E,!jr(m,n.memoizedState)&&(ps=!0,ye&&(o=gl,o!==null)))throw o;n.memoizedState=m,n.baseState=x,n.baseQueue=z,c.lastRenderedState=m}return f===null&&(c.lanes=0),[n.memoizedState,c.dispatch]}function pm(n){var r=ds(),o=r.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=n;var c=o.dispatch,f=o.pending,m=r.memoizedState;if(f!==null){o.pending=null;var x=f=f.next;do m=n(m,x.action),x=x.next;while(x!==f);jr(m,r.memoizedState)||(ps=!0),r.memoizedState=m,r.baseQueue===null&&(r.baseState=m),o.lastRenderedState=m}return[m,c]}function dv(n,r,o){var c=It,f=ds(),m=nn;if(m){if(o===void 0)throw Error(i(407));o=o()}else o=r();var x=!jr((jn||f).memoizedState,o);if(x&&(f.memoizedState=o,ps=!0),f=f.queue,bm(mv.bind(null,c,f,n),[n]),f.getSnapshot!==r||x||gs!==null&&gs.memoizedState.tag&1){if(c.flags|=2048,xl(9,{destroy:void 0},fv.bind(null,c,f,o,r),null),An===null)throw Error(i(349));m||(Fi&127)!==0||hv(c,r,o)}return o}function hv(n,r,o){n.flags|=16384,n={getSnapshot:r,value:o},r=It.updateQueue,r===null?(r=_d(),It.updateQueue=r,r.stores=[n]):(o=r.stores,o===null?r.stores=[n]:o.push(n))}function fv(n,r,o,c){r.value=o,r.getSnapshot=c,gv(r)&&pv(n)}function mv(n,r,o){return o(function(){gv(r)&&pv(n)})}function gv(n){var r=n.getSnapshot;n=n.value;try{var o=r();return!jr(n,o)}catch{return!0}}function pv(n){var r=vo(n,2);r!==null&&gr(r,n,2)}function ym(n){var r=nr();if(typeof n=="function"){var o=n;if(n=o(),So){bt(!0);try{o()}finally{bt(!1)}}}return r.memoizedState=r.baseState=n,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hi,lastRenderedState:n},r}function yv(n,r,o,c){return n.baseState=o,gm(n,jn,typeof c=="function"?c:Hi)}function vE(n,r,o,c,f){if(Sd(n))throw Error(i(485));if(n=r.action,n!==null){var m={payload:f,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(x){m.listeners.push(x)}};J.T!==null?o(!0):m.isTransition=!1,c(m),o=r.pending,o===null?(m.next=r.pending=m,vv(r,m)):(m.next=o.next,r.pending=o.next=m)}}function vv(n,r){var o=r.action,c=r.payload,f=n.state;if(r.isTransition){var m=J.T,x={};J.T=x;try{var E=o(f,c),z=J.S;z!==null&&z(x,E),bv(n,r,E)}catch(ie){vm(n,r,ie)}finally{m!==null&&x.types!==null&&(m.types=x.types),J.T=m}}else try{m=o(f,c),bv(n,r,m)}catch(ie){vm(n,r,ie)}}function bv(n,r,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){wv(n,r,c)},function(c){return vm(n,r,c)}):wv(n,r,o)}function wv(n,r,o){r.status="fulfilled",r.value=o,xv(r),n.state=o,r=n.pending,r!==null&&(o=r.next,o===r?n.pending=null:(o=o.next,r.next=o,vv(n,o)))}function vm(n,r,o){var c=n.pending;if(n.pending=null,c!==null){c=c.next;do r.status="rejected",r.reason=o,xv(r),r=r.next;while(r!==c)}n.action=null}function xv(n){n=n.listeners;for(var r=0;r<n.length;r++)(0,n[r])()}function _v(n,r){return r}function kv(n,r){if(nn){var o=An.formState;if(o!==null){e:{var c=It;if(nn){if(Un){t:{for(var f=Un,m=zr;f.nodeType!==8;){if(!m){f=null;break t}if(f=Hr(f.nextSibling),f===null){f=null;break t}}m=f.data,f=m==="F!"||m==="F"?f:null}if(f){Un=Hr(f.nextSibling),c=f.data==="F!";break e}}ja(c)}c=!1}c&&(r=o[0])}}return o=nr(),o.memoizedState=o.baseState=r,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:_v,lastRenderedState:r},o.queue=c,o=Fv.bind(null,It,c),c.dispatch=o,c=ym(!1),m=jm.bind(null,It,!1,c.queue),c=nr(),f={state:r,dispatch:null,action:n,pending:null},c.queue=f,o=vE.bind(null,It,f,m,o),f.dispatch=o,c.memoizedState=n,[r,o,!1]}function jv(n){var r=ds();return Ev(r,jn,n)}function Ev(n,r,o){if(r=gm(n,r,_v)[0],n=jd(Hi)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var c=Tc(r)}catch(x){throw x===pl?md:x}else c=r;r=ds();var f=r.queue,m=f.dispatch;return o!==r.memoizedState&&(It.flags|=2048,xl(9,{destroy:void 0},bE.bind(null,f,o),null)),[c,m,n]}function bE(n,r){n.action=r}function Tv(n){var r=ds(),o=jn;if(o!==null)return Ev(r,o,n);ds(),r=r.memoizedState,o=ds();var c=o.queue.dispatch;return o.memoizedState=n,[r,c,!1]}function xl(n,r,o,c){return n={tag:n,create:o,deps:c,inst:r,next:null},r=It.updateQueue,r===null&&(r=_d(),It.updateQueue=r),o=r.lastEffect,o===null?r.lastEffect=n.next=n:(c=o.next,o.next=n,n.next=c,r.lastEffect=n),n}function Sv(){return ds().memoizedState}function Ed(n,r,o,c){var f=nr();It.flags|=n,f.memoizedState=xl(1|r,{destroy:void 0},o,c===void 0?null:c)}function Td(n,r,o,c){var f=ds();c=c===void 0?null:c;var m=f.memoizedState.inst;jn!==null&&c!==null&&cm(c,jn.memoizedState.deps)?f.memoizedState=xl(r,m,o,c):(It.flags|=n,f.memoizedState=xl(1|r,m,o,c))}function Cv(n,r){Ed(8390656,8,n,r)}function bm(n,r){Td(2048,8,n,r)}function wE(n){It.flags|=4;var r=It.updateQueue;if(r===null)r=_d(),It.updateQueue=r,r.events=[n];else{var o=r.events;o===null?r.events=[n]:o.push(n)}}function Nv(n){var r=ds().memoizedState;return wE({ref:r,nextImpl:n}),function(){if((mn&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function Av(n,r){return Td(4,2,n,r)}function Rv(n,r){return Td(4,4,n,r)}function Iv(n,r){if(typeof r=="function"){n=n();var o=r(n);return function(){typeof o=="function"?o():r(null)}}if(r!=null)return n=n(),r.current=n,function(){r.current=null}}function Mv(n,r,o){o=o!=null?o.concat([n]):null,Td(4,4,Iv.bind(null,r,n),o)}function wm(){}function Dv(n,r){var o=ds();r=r===void 0?null:r;var c=o.memoizedState;return r!==null&&cm(r,c[1])?c[0]:(o.memoizedState=[n,r],n)}function Lv(n,r){var o=ds();r=r===void 0?null:r;var c=o.memoizedState;if(r!==null&&cm(r,c[1]))return c[0];if(c=n(),So){bt(!0);try{n()}finally{bt(!1)}}return o.memoizedState=[c,r],c}function xm(n,r,o){return o===void 0||(Fi&1073741824)!==0&&(Kt&261930)===0?n.memoizedState=r:(n.memoizedState=o,n=O1(),It.lanes|=n,Ma|=n,o)}function Ov(n,r,o,c){return jr(o,r)?o:vl.current!==null?(n=xm(n,o,c),jr(n,r)||(ps=!0),n):(Fi&42)===0||(Fi&1073741824)!==0&&(Kt&261930)===0?(ps=!0,n.memoizedState=o):(n=O1(),It.lanes|=n,Ma|=n,r)}function Pv(n,r,o,c,f){var m=Te.p;Te.p=m!==0&&8>m?m:8;var x=J.T,E={};J.T=E,jm(n,!1,r,o);try{var z=f(),ie=J.S;if(ie!==null&&ie(E,z),z!==null&&typeof z=="object"&&typeof z.then=="function"){var ye=gE(z,c);Sc(n,r,ye,Ar(n))}else Sc(n,r,c,Ar(n))}catch(_e){Sc(n,r,{then:function(){},status:"rejected",reason:_e},Ar())}finally{Te.p=m,x!==null&&E.types!==null&&(x.types=E.types),J.T=x}}function xE(){}function _m(n,r,o,c){if(n.tag!==5)throw Error(i(476));var f=Vv(n).queue;Pv(n,f,r,Ue,o===null?xE:function(){return Uv(n),o(c)})}function Vv(n){var r=n.memoizedState;if(r!==null)return r;r={memoizedState:Ue,baseState:Ue,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hi,lastRenderedState:Ue},next:null};var o={};return r.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hi,lastRenderedState:o},next:null},n.memoizedState=r,n=n.alternate,n!==null&&(n.memoizedState=r),r}function Uv(n){var r=Vv(n);r.next===null&&(r=n.alternate.memoizedState),Sc(n,r.next.queue,{},Ar())}function km(){return Ps(qc)}function Bv(){return ds().memoizedState}function zv(){return ds().memoizedState}function _E(n){for(var r=n.return;r!==null;){switch(r.tag){case 24:case 3:var o=Ar();n=Sa(o);var c=Ca(r,n,o);c!==null&&(gr(c,r,o),_c(c,r,o)),r={cache:Jf()},n.payload=r;return}r=r.return}}function kE(n,r,o){var c=Ar();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},Sd(n)?Hv(r,o):(o=zf(n,r,o,c),o!==null&&(gr(o,n,c),qv(o,r,c)))}function Fv(n,r,o){var c=Ar();Sc(n,r,o,c)}function Sc(n,r,o,c){var f={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(Sd(n))Hv(r,f);else{var m=n.alternate;if(n.lanes===0&&(m===null||m.lanes===0)&&(m=r.lastRenderedReducer,m!==null))try{var x=r.lastRenderedState,E=m(x,o);if(f.hasEagerState=!0,f.eagerState=E,jr(E,x))return od(n,r,f,0),An===null&&ad(),!1}catch{}if(o=zf(n,r,f,c),o!==null)return gr(o,n,c),qv(o,r,c),!0}return!1}function jm(n,r,o,c){if(c={lane:2,revertLane:ng(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Sd(n)){if(r)throw Error(i(479))}else r=zf(n,o,c,2),r!==null&&gr(r,n,2)}function Sd(n){var r=n.alternate;return n===It||r!==null&&r===It}function Hv(n,r){bl=wd=!0;var o=n.pending;o===null?r.next=r:(r.next=o.next,o.next=r),n.pending=r}function qv(n,r,o){if((o&4194048)!==0){var c=r.lanes;c&=n.pendingLanes,o|=c,r.lanes=o,ot(n,o)}}var Cc={readContext:Ps,use:kd,useCallback:ts,useContext:ts,useEffect:ts,useImperativeHandle:ts,useLayoutEffect:ts,useInsertionEffect:ts,useMemo:ts,useReducer:ts,useRef:ts,useState:ts,useDebugValue:ts,useDeferredValue:ts,useTransition:ts,useSyncExternalStore:ts,useId:ts,useHostTransitionStatus:ts,useFormState:ts,useActionState:ts,useOptimistic:ts,useMemoCache:ts,useCacheRefresh:ts};Cc.useEffectEvent=ts;var $v={readContext:Ps,use:kd,useCallback:function(n,r){return nr().memoizedState=[n,r===void 0?null:r],n},useContext:Ps,useEffect:Cv,useImperativeHandle:function(n,r,o){o=o!=null?o.concat([n]):null,Ed(4194308,4,Iv.bind(null,r,n),o)},useLayoutEffect:function(n,r){return Ed(4194308,4,n,r)},useInsertionEffect:function(n,r){Ed(4,2,n,r)},useMemo:function(n,r){var o=nr();r=r===void 0?null:r;var c=n();if(So){bt(!0);try{n()}finally{bt(!1)}}return o.memoizedState=[c,r],c},useReducer:function(n,r,o){var c=nr();if(o!==void 0){var f=o(r);if(So){bt(!0);try{o(r)}finally{bt(!1)}}}else f=r;return c.memoizedState=c.baseState=f,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:f},c.queue=n,n=n.dispatch=kE.bind(null,It,n),[c.memoizedState,n]},useRef:function(n){var r=nr();return n={current:n},r.memoizedState=n},useState:function(n){n=ym(n);var r=n.queue,o=Fv.bind(null,It,r);return r.dispatch=o,[n.memoizedState,o]},useDebugValue:wm,useDeferredValue:function(n,r){var o=nr();return xm(o,n,r)},useTransition:function(){var n=ym(!1);return n=Pv.bind(null,It,n.queue,!0,!1),nr().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,r,o){var c=It,f=nr();if(nn){if(o===void 0)throw Error(i(407));o=o()}else{if(o=r(),An===null)throw Error(i(349));(Kt&127)!==0||hv(c,r,o)}f.memoizedState=o;var m={value:o,getSnapshot:r};return f.queue=m,Cv(mv.bind(null,c,m,n),[n]),c.flags|=2048,xl(9,{destroy:void 0},fv.bind(null,c,m,o,r),null),o},useId:function(){var n=nr(),r=An.identifierPrefix;if(nn){var o=wi,c=bi;o=(c&~(1<<32-At(c)-1)).toString(32)+o,r="_"+r+"R_"+o,o=xd++,0<o&&(r+="H"+o.toString(32)),r+="_"}else o=pE++,r="_"+r+"r_"+o.toString(32)+"_";return n.memoizedState=r},useHostTransitionStatus:km,useFormState:kv,useActionState:kv,useOptimistic:function(n){var r=nr();r.memoizedState=r.baseState=n;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=o,r=jm.bind(null,It,!0,o),o.dispatch=r,[n,r]},useMemoCache:mm,useCacheRefresh:function(){return nr().memoizedState=_E.bind(null,It)},useEffectEvent:function(n){var r=nr(),o={impl:n};return r.memoizedState=o,function(){if((mn&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},Em={readContext:Ps,use:kd,useCallback:Dv,useContext:Ps,useEffect:bm,useImperativeHandle:Mv,useInsertionEffect:Av,useLayoutEffect:Rv,useMemo:Lv,useReducer:jd,useRef:Sv,useState:function(){return jd(Hi)},useDebugValue:wm,useDeferredValue:function(n,r){var o=ds();return Ov(o,jn.memoizedState,n,r)},useTransition:function(){var n=jd(Hi)[0],r=ds().memoizedState;return[typeof n=="boolean"?n:Tc(n),r]},useSyncExternalStore:dv,useId:Bv,useHostTransitionStatus:km,useFormState:jv,useActionState:jv,useOptimistic:function(n,r){var o=ds();return yv(o,jn,n,r)},useMemoCache:mm,useCacheRefresh:zv};Em.useEffectEvent=Nv;var Wv={readContext:Ps,use:kd,useCallback:Dv,useContext:Ps,useEffect:bm,useImperativeHandle:Mv,useInsertionEffect:Av,useLayoutEffect:Rv,useMemo:Lv,useReducer:pm,useRef:Sv,useState:function(){return pm(Hi)},useDebugValue:wm,useDeferredValue:function(n,r){var o=ds();return jn===null?xm(o,n,r):Ov(o,jn.memoizedState,n,r)},useTransition:function(){var n=pm(Hi)[0],r=ds().memoizedState;return[typeof n=="boolean"?n:Tc(n),r]},useSyncExternalStore:dv,useId:Bv,useHostTransitionStatus:km,useFormState:Tv,useActionState:Tv,useOptimistic:function(n,r){var o=ds();return jn!==null?yv(o,jn,n,r):(o.baseState=n,[n,o.queue.dispatch])},useMemoCache:mm,useCacheRefresh:zv};Wv.useEffectEvent=Nv;function Tm(n,r,o,c){r=n.memoizedState,o=o(c,r),o=o==null?r:j({},r,o),n.memoizedState=o,n.lanes===0&&(n.updateQueue.baseState=o)}var Sm={enqueueSetState:function(n,r,o){n=n._reactInternals;var c=Ar(),f=Sa(c);f.payload=r,o!=null&&(f.callback=o),r=Ca(n,f,c),r!==null&&(gr(r,n,c),_c(r,n,c))},enqueueReplaceState:function(n,r,o){n=n._reactInternals;var c=Ar(),f=Sa(c);f.tag=1,f.payload=r,o!=null&&(f.callback=o),r=Ca(n,f,c),r!==null&&(gr(r,n,c),_c(r,n,c))},enqueueForceUpdate:function(n,r){n=n._reactInternals;var o=Ar(),c=Sa(o);c.tag=2,r!=null&&(c.callback=r),r=Ca(n,c,o),r!==null&&(gr(r,n,o),_c(r,n,o))}};function Gv(n,r,o,c,f,m,x){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(c,m,x):r.prototype&&r.prototype.isPureReactComponent?!mc(o,c)||!mc(f,m):!0}function Kv(n,r,o,c){n=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(o,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(o,c),r.state!==n&&Sm.enqueueReplaceState(r,r.state,null)}function Co(n,r){var o=r;if("ref"in r){o={};for(var c in r)c!=="ref"&&(o[c]=r[c])}if(n=n.defaultProps){o===r&&(o=j({},o));for(var f in n)o[f]===void 0&&(o[f]=n[f])}return o}function Yv(n){id(n)}function Qv(n){console.error(n)}function Xv(n){id(n)}function Cd(n,r){try{var o=n.onUncaughtError;o(r.value,{componentStack:r.stack})}catch(c){setTimeout(function(){throw c})}}function Jv(n,r,o){try{var c=n.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function Cm(n,r,o){return o=Sa(o),o.tag=3,o.payload={element:null},o.callback=function(){Cd(n,r)},o}function Zv(n){return n=Sa(n),n.tag=3,n}function e1(n,r,o,c){var f=o.type.getDerivedStateFromError;if(typeof f=="function"){var m=c.value;n.payload=function(){return f(m)},n.callback=function(){Jv(r,o,c)}}var x=o.stateNode;x!==null&&typeof x.componentDidCatch=="function"&&(n.callback=function(){Jv(r,o,c),typeof f!="function"&&(Da===null?Da=new Set([this]):Da.add(this));var E=c.stack;this.componentDidCatch(c.value,{componentStack:E!==null?E:""})})}function jE(n,r,o,c,f){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(r=o.alternate,r!==null&&fl(r,o,f,!0),o=Tr.current,o!==null){switch(o.tag){case 31:case 13:return Fr===null?Bd():o.alternate===null&&ns===0&&(ns=3),o.flags&=-257,o.flags|=65536,o.lanes=f,c===gd?o.flags|=16384:(r=o.updateQueue,r===null?o.updateQueue=new Set([c]):r.add(c),Zm(n,c,f)),!1;case 22:return o.flags|=65536,c===gd?o.flags|=16384:(r=o.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=r):(o=r.retryQueue,o===null?r.retryQueue=new Set([c]):o.add(c)),Zm(n,c,f)),!1}throw Error(i(435,o.tag))}return Zm(n,c,f),Bd(),!1}if(nn)return r=Tr.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=f,c!==Gf&&(n=Error(i(422),{cause:c}),yc(Vr(n,o)))):(c!==Gf&&(r=Error(i(423),{cause:c}),yc(Vr(r,o))),n=n.current.alternate,n.flags|=65536,f&=-f,n.lanes|=f,c=Vr(c,o),f=Cm(n.stateNode,c,f),rm(n,f),ns!==4&&(ns=2)),!1;var m=Error(i(520),{cause:c});if(m=Vr(m,o),Oc===null?Oc=[m]:Oc.push(m),ns!==4&&(ns=2),r===null)return!0;c=Vr(c,o),o=r;do{switch(o.tag){case 3:return o.flags|=65536,n=f&-f,o.lanes|=n,n=Cm(o.stateNode,c,n),rm(o,n),!1;case 1:if(r=o.type,m=o.stateNode,(o.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Da===null||!Da.has(m))))return o.flags|=65536,f&=-f,o.lanes|=f,f=Zv(f),e1(f,n,o,c),rm(o,f),!1}o=o.return}while(o!==null);return!1}var Nm=Error(i(461)),ps=!1;function Vs(n,r,o,c){r.child=n===null?rv(r,null,o,c):To(r,n.child,o,c)}function t1(n,r,o,c,f){o=o.render;var m=r.ref;if("ref"in c){var x={};for(var E in c)E!=="ref"&&(x[E]=c[E])}else x=c;return _o(r),c=um(n,r,o,x,m,f),E=dm(),n!==null&&!ps?(hm(n,r,f),qi(n,r,f)):(nn&&E&&$f(r),r.flags|=1,Vs(n,r,c,f),r.child)}function n1(n,r,o,c,f){if(n===null){var m=o.type;return typeof m=="function"&&!Ff(m)&&m.defaultProps===void 0&&o.compare===null?(r.tag=15,r.type=m,s1(n,r,m,c,f)):(n=cd(o.type,null,c,r,r.mode,f),n.ref=r.ref,n.return=r,r.child=n)}if(m=n.child,!Pm(n,f)){var x=m.memoizedProps;if(o=o.compare,o=o!==null?o:mc,o(x,c)&&n.ref===r.ref)return qi(n,r,f)}return r.flags|=1,n=Vi(m,c),n.ref=r.ref,n.return=r,r.child=n}function s1(n,r,o,c,f){if(n!==null){var m=n.memoizedProps;if(mc(m,c)&&n.ref===r.ref)if(ps=!1,r.pendingProps=c=m,Pm(n,f))(n.flags&131072)!==0&&(ps=!0);else return r.lanes=n.lanes,qi(n,r,f)}return Am(n,r,o,c,f)}function r1(n,r,o,c){var f=c.children,m=n!==null?n.memoizedState:null;if(n===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((r.flags&128)!==0){if(m=m!==null?m.baseLanes|o:o,n!==null){for(c=r.child=n.child,f=0;c!==null;)f=f|c.lanes|c.childLanes,c=c.sibling;c=f&~m}else c=0,r.child=null;return i1(n,r,m,o,c)}if((o&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},n!==null&&fd(r,m!==null?m.cachePool:null),m!==null?ov(r,m):am(),lv(r);else return c=r.lanes=536870912,i1(n,r,m!==null?m.baseLanes|o:o,o,c)}else m!==null?(fd(r,m.cachePool),ov(r,m),Aa(),r.memoizedState=null):(n!==null&&fd(r,null),am(),Aa());return Vs(n,r,f,o),r.child}function Nc(n,r){return n!==null&&n.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function i1(n,r,o,c,f){var m=em();return m=m===null?null:{parent:ms._currentValue,pool:m},r.memoizedState={baseLanes:o,cachePool:m},n!==null&&fd(r,null),am(),lv(r),n!==null&&fl(n,r,c,!0),r.childLanes=f,null}function Nd(n,r){return r=Rd({mode:r.mode,children:r.children},n.mode),r.ref=n.ref,n.child=r,r.return=n,r}function a1(n,r,o){return To(r,n.child,null,o),n=Nd(r,r.pendingProps),n.flags|=2,Sr(r),r.memoizedState=null,n}function EE(n,r,o){var c=r.pendingProps,f=(r.flags&128)!==0;if(r.flags&=-129,n===null){if(nn){if(c.mode==="hidden")return n=Nd(r,c),r.lanes=536870912,Nc(null,n);if(lm(r),(n=Un)?(n=vb(n,zr),n=n!==null&&n.data==="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:_a!==null?{id:bi,overflow:wi}:null,retryLane:536870912,hydrationErrors:null},o=H0(n),o.return=r,r.child=o,Os=r,Un=null)):n=null,n===null)throw ja(r);return r.lanes=536870912,null}return Nd(r,c)}var m=n.memoizedState;if(m!==null){var x=m.dehydrated;if(lm(r),f)if(r.flags&256)r.flags&=-257,r=a1(n,r,o);else if(r.memoizedState!==null)r.child=n.child,r.flags|=128,r=null;else throw Error(i(558));else if(ps||fl(n,r,o,!1),f=(o&n.childLanes)!==0,ps||f){if(c=An,c!==null&&(x=Gt(c,o),x!==0&&x!==m.retryLane))throw m.retryLane=x,vo(n,x),gr(c,n,x),Nm;Bd(),r=a1(n,r,o)}else n=m.treeContext,Un=Hr(x.nextSibling),Os=r,nn=!0,ka=null,zr=!1,n!==null&&W0(r,n),r=Nd(r,c),r.flags|=4096;return r}return n=Vi(n.child,{mode:c.mode,children:c.children}),n.ref=r.ref,r.child=n,n.return=r,n}function Ad(n,r){var o=r.ref;if(o===null)n!==null&&n.ref!==null&&(r.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(n===null||n.ref!==o)&&(r.flags|=4194816)}}function Am(n,r,o,c,f){return _o(r),o=um(n,r,o,c,void 0,f),c=dm(),n!==null&&!ps?(hm(n,r,f),qi(n,r,f)):(nn&&c&&$f(r),r.flags|=1,Vs(n,r,o,f),r.child)}function o1(n,r,o,c,f,m){return _o(r),r.updateQueue=null,o=uv(r,c,o,f),cv(n),c=dm(),n!==null&&!ps?(hm(n,r,m),qi(n,r,m)):(nn&&c&&$f(r),r.flags|=1,Vs(n,r,o,m),r.child)}function l1(n,r,o,c,f){if(_o(r),r.stateNode===null){var m=cl,x=o.contextType;typeof x=="object"&&x!==null&&(m=Ps(x)),m=new o(c,m),r.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=Sm,r.stateNode=m,m._reactInternals=r,m=r.stateNode,m.props=c,m.state=r.memoizedState,m.refs={},nm(r),x=o.contextType,m.context=typeof x=="object"&&x!==null?Ps(x):cl,m.state=r.memoizedState,x=o.getDerivedStateFromProps,typeof x=="function"&&(Tm(r,o,x,c),m.state=r.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(x=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),x!==m.state&&Sm.enqueueReplaceState(m,m.state,null),jc(r,c,m,f),kc(),m.state=r.memoizedState),typeof m.componentDidMount=="function"&&(r.flags|=4194308),c=!0}else if(n===null){m=r.stateNode;var E=r.memoizedProps,z=Co(o,E);m.props=z;var ie=m.context,ye=o.contextType;x=cl,typeof ye=="object"&&ye!==null&&(x=Ps(ye));var _e=o.getDerivedStateFromProps;ye=typeof _e=="function"||typeof m.getSnapshotBeforeUpdate=="function",E=r.pendingProps!==E,ye||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(E||ie!==x)&&Kv(r,m,c,x),Ta=!1;var ce=r.memoizedState;m.state=ce,jc(r,c,m,f),kc(),ie=r.memoizedState,E||ce!==ie||Ta?(typeof _e=="function"&&(Tm(r,o,_e,c),ie=r.memoizedState),(z=Ta||Gv(r,o,z,c,ce,ie,x))?(ye||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(r.flags|=4194308)):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=ie),m.props=c,m.state=ie,m.context=x,c=z):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{m=r.stateNode,sm(n,r),x=r.memoizedProps,ye=Co(o,x),m.props=ye,_e=r.pendingProps,ce=m.context,ie=o.contextType,z=cl,typeof ie=="object"&&ie!==null&&(z=Ps(ie)),E=o.getDerivedStateFromProps,(ie=typeof E=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(x!==_e||ce!==z)&&Kv(r,m,c,z),Ta=!1,ce=r.memoizedState,m.state=ce,jc(r,c,m,f),kc();var fe=r.memoizedState;x!==_e||ce!==fe||Ta||n!==null&&n.dependencies!==null&&dd(n.dependencies)?(typeof E=="function"&&(Tm(r,o,E,c),fe=r.memoizedState),(ye=Ta||Gv(r,o,ye,c,ce,fe,z)||n!==null&&n.dependencies!==null&&dd(n.dependencies))?(ie||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(c,fe,z),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(c,fe,z)),typeof m.componentDidUpdate=="function"&&(r.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof m.componentDidUpdate!="function"||x===n.memoizedProps&&ce===n.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||x===n.memoizedProps&&ce===n.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=fe),m.props=c,m.state=fe,m.context=z,c=ye):(typeof m.componentDidUpdate!="function"||x===n.memoizedProps&&ce===n.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||x===n.memoizedProps&&ce===n.memoizedState||(r.flags|=1024),c=!1)}return m=c,Ad(n,r),c=(r.flags&128)!==0,m||c?(m=r.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:m.render(),r.flags|=1,n!==null&&c?(r.child=To(r,n.child,null,f),r.child=To(r,null,o,f)):Vs(n,r,o,f),r.memoizedState=m.state,n=r.child):n=qi(n,r,f),n}function c1(n,r,o,c){return wo(),r.flags|=256,Vs(n,r,o,c),r.child}var Rm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Im(n){return{baseLanes:n,cachePool:J0()}}function Mm(n,r,o){return n=n!==null?n.childLanes&~o:0,r&&(n|=Nr),n}function u1(n,r,o){var c=r.pendingProps,f=!1,m=(r.flags&128)!==0,x;if((x=m)||(x=n!==null&&n.memoizedState===null?!1:(us.current&2)!==0),x&&(f=!0,r.flags&=-129),x=(r.flags&32)!==0,r.flags&=-33,n===null){if(nn){if(f?Na(r):Aa(),(n=Un)?(n=vb(n,zr),n=n!==null&&n.data!=="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:_a!==null?{id:bi,overflow:wi}:null,retryLane:536870912,hydrationErrors:null},o=H0(n),o.return=r,r.child=o,Os=r,Un=null)):n=null,n===null)throw ja(r);return gg(n)?r.lanes=32:r.lanes=536870912,null}var E=c.children;return c=c.fallback,f?(Aa(),f=r.mode,E=Rd({mode:"hidden",children:E},f),c=bo(c,f,o,null),E.return=r,c.return=r,E.sibling=c,r.child=E,c=r.child,c.memoizedState=Im(o),c.childLanes=Mm(n,x,o),r.memoizedState=Rm,Nc(null,c)):(Na(r),Dm(r,E))}var z=n.memoizedState;if(z!==null&&(E=z.dehydrated,E!==null)){if(m)r.flags&256?(Na(r),r.flags&=-257,r=Lm(n,r,o)):r.memoizedState!==null?(Aa(),r.child=n.child,r.flags|=128,r=null):(Aa(),E=c.fallback,f=r.mode,c=Rd({mode:"visible",children:c.children},f),E=bo(E,f,o,null),E.flags|=2,c.return=r,E.return=r,c.sibling=E,r.child=c,To(r,n.child,null,o),c=r.child,c.memoizedState=Im(o),c.childLanes=Mm(n,x,o),r.memoizedState=Rm,r=Nc(null,c));else if(Na(r),gg(E)){if(x=E.nextSibling&&E.nextSibling.dataset,x)var ie=x.dgst;x=ie,c=Error(i(419)),c.stack="",c.digest=x,yc({value:c,source:null,stack:null}),r=Lm(n,r,o)}else if(ps||fl(n,r,o,!1),x=(o&n.childLanes)!==0,ps||x){if(x=An,x!==null&&(c=Gt(x,o),c!==0&&c!==z.retryLane))throw z.retryLane=c,vo(n,c),gr(x,n,c),Nm;mg(E)||Bd(),r=Lm(n,r,o)}else mg(E)?(r.flags|=192,r.child=n.child,r=null):(n=z.treeContext,Un=Hr(E.nextSibling),Os=r,nn=!0,ka=null,zr=!1,n!==null&&W0(r,n),r=Dm(r,c.children),r.flags|=4096);return r}return f?(Aa(),E=c.fallback,f=r.mode,z=n.child,ie=z.sibling,c=Vi(z,{mode:"hidden",children:c.children}),c.subtreeFlags=z.subtreeFlags&65011712,ie!==null?E=Vi(ie,E):(E=bo(E,f,o,null),E.flags|=2),E.return=r,c.return=r,c.sibling=E,r.child=c,Nc(null,c),c=r.child,E=n.child.memoizedState,E===null?E=Im(o):(f=E.cachePool,f!==null?(z=ms._currentValue,f=f.parent!==z?{parent:z,pool:z}:f):f=J0(),E={baseLanes:E.baseLanes|o,cachePool:f}),c.memoizedState=E,c.childLanes=Mm(n,x,o),r.memoizedState=Rm,Nc(n.child,c)):(Na(r),o=n.child,n=o.sibling,o=Vi(o,{mode:"visible",children:c.children}),o.return=r,o.sibling=null,n!==null&&(x=r.deletions,x===null?(r.deletions=[n],r.flags|=16):x.push(n)),r.child=o,r.memoizedState=null,o)}function Dm(n,r){return r=Rd({mode:"visible",children:r},n.mode),r.return=n,n.child=r}function Rd(n,r){return n=Er(22,n,null,r),n.lanes=0,n}function Lm(n,r,o){return To(r,n.child,null,o),n=Dm(r,r.pendingProps.children),n.flags|=2,r.memoizedState=null,n}function d1(n,r,o){n.lanes|=r;var c=n.alternate;c!==null&&(c.lanes|=r),Qf(n.return,r,o)}function Om(n,r,o,c,f,m){var x=n.memoizedState;x===null?n.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:f,treeForkCount:m}:(x.isBackwards=r,x.rendering=null,x.renderingStartTime=0,x.last=c,x.tail=o,x.tailMode=f,x.treeForkCount=m)}function h1(n,r,o){var c=r.pendingProps,f=c.revealOrder,m=c.tail;c=c.children;var x=us.current,E=(x&2)!==0;if(E?(x=x&1|2,r.flags|=128):x&=1,Ce(us,x),Vs(n,r,c,o),c=nn?pc:0,!E&&n!==null&&(n.flags&128)!==0)e:for(n=r.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&d1(n,o,r);else if(n.tag===19)d1(n,o,r);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break e;for(;n.sibling===null;){if(n.return===null||n.return===r)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(f){case"forwards":for(o=r.child,f=null;o!==null;)n=o.alternate,n!==null&&bd(n)===null&&(f=o),o=o.sibling;o=f,o===null?(f=r.child,r.child=null):(f=o.sibling,o.sibling=null),Om(r,!1,f,o,m,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,f=r.child,r.child=null;f!==null;){if(n=f.alternate,n!==null&&bd(n)===null){r.child=f;break}n=f.sibling,f.sibling=o,o=f,f=n}Om(r,!0,o,null,m,c);break;case"together":Om(r,!1,null,null,void 0,c);break;default:r.memoizedState=null}return r.child}function qi(n,r,o){if(n!==null&&(r.dependencies=n.dependencies),Ma|=r.lanes,(o&r.childLanes)===0)if(n!==null){if(fl(n,r,o,!1),(o&r.childLanes)===0)return null}else return null;if(n!==null&&r.child!==n.child)throw Error(i(153));if(r.child!==null){for(n=r.child,o=Vi(n,n.pendingProps),r.child=o,o.return=r;n.sibling!==null;)n=n.sibling,o=o.sibling=Vi(n,n.pendingProps),o.return=r;o.sibling=null}return r.child}function Pm(n,r){return(n.lanes&r)!==0?!0:(n=n.dependencies,!!(n!==null&&dd(n)))}function TE(n,r,o){switch(r.tag){case 3:Ge(r,r.stateNode.containerInfo),Ea(r,ms,n.memoizedState.cache),wo();break;case 27:case 5:sn(r);break;case 4:Ge(r,r.stateNode.containerInfo);break;case 10:Ea(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,lm(r),null;break;case 13:var c=r.memoizedState;if(c!==null)return c.dehydrated!==null?(Na(r),r.flags|=128,null):(o&r.child.childLanes)!==0?u1(n,r,o):(Na(r),n=qi(n,r,o),n!==null?n.sibling:null);Na(r);break;case 19:var f=(n.flags&128)!==0;if(c=(o&r.childLanes)!==0,c||(fl(n,r,o,!1),c=(o&r.childLanes)!==0),f){if(c)return h1(n,r,o);r.flags|=128}if(f=r.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),Ce(us,us.current),c)break;return null;case 22:return r.lanes=0,r1(n,r,o,r.pendingProps);case 24:Ea(r,ms,n.memoizedState.cache)}return qi(n,r,o)}function f1(n,r,o){if(n!==null)if(n.memoizedProps!==r.pendingProps)ps=!0;else{if(!Pm(n,o)&&(r.flags&128)===0)return ps=!1,TE(n,r,o);ps=(n.flags&131072)!==0}else ps=!1,nn&&(r.flags&1048576)!==0&&$0(r,pc,r.index);switch(r.lanes=0,r.tag){case 16:e:{var c=r.pendingProps;if(n=jo(r.elementType),r.type=n,typeof n=="function")Ff(n)?(c=Co(n,c),r.tag=1,r=l1(null,r,n,c,o)):(r.tag=0,r=Am(null,r,n,c,o));else{if(n!=null){var f=n.$$typeof;if(f===ge){r.tag=11,r=t1(null,r,n,c,o);break e}else if(f===I){r.tag=14,r=n1(null,r,n,c,o);break e}}throw r=Me(n)||n,Error(i(306,r,""))}}return r;case 0:return Am(n,r,r.type,r.pendingProps,o);case 1:return c=r.type,f=Co(c,r.pendingProps),l1(n,r,c,f,o);case 3:e:{if(Ge(r,r.stateNode.containerInfo),n===null)throw Error(i(387));c=r.pendingProps;var m=r.memoizedState;f=m.element,sm(n,r),jc(r,c,null,o);var x=r.memoizedState;if(c=x.cache,Ea(r,ms,c),c!==m.cache&&Xf(r,[ms],o,!0),kc(),c=x.element,m.isDehydrated)if(m={element:c,isDehydrated:!1,cache:x.cache},r.updateQueue.baseState=m,r.memoizedState=m,r.flags&256){r=c1(n,r,c,o);break e}else if(c!==f){f=Vr(Error(i(424)),r),yc(f),r=c1(n,r,c,o);break e}else for(n=r.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,Un=Hr(n.firstChild),Os=r,nn=!0,ka=null,zr=!0,o=rv(r,null,c,o),r.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(wo(),c===f){r=qi(n,r,o);break e}Vs(n,r,c,o)}r=r.child}return r;case 26:return Ad(n,r),n===null?(o=jb(r.type,null,r.pendingProps,null))?r.memoizedState=o:nn||(o=r.type,n=r.pendingProps,c=Gd(Oe.current).createElement(o),c[Nn]=r,c[an]=n,Us(c,o,n),pn(c),r.stateNode=c):r.memoizedState=jb(r.type,n.memoizedProps,r.pendingProps,n.memoizedState),null;case 27:return sn(r),n===null&&nn&&(c=r.stateNode=xb(r.type,r.pendingProps,Oe.current),Os=r,zr=!0,f=Un,Va(r.type)?(pg=f,Un=Hr(c.firstChild)):Un=f),Vs(n,r,r.pendingProps.children,o),Ad(n,r),n===null&&(r.flags|=4194304),r.child;case 5:return n===null&&nn&&((f=c=Un)&&(c=nT(c,r.type,r.pendingProps,zr),c!==null?(r.stateNode=c,Os=r,Un=Hr(c.firstChild),zr=!1,f=!0):f=!1),f||ja(r)),sn(r),f=r.type,m=r.pendingProps,x=n!==null?n.memoizedProps:null,c=m.children,dg(f,m)?c=null:x!==null&&dg(f,x)&&(r.flags|=32),r.memoizedState!==null&&(f=um(n,r,yE,null,null,o),qc._currentValue=f),Ad(n,r),Vs(n,r,c,o),r.child;case 6:return n===null&&nn&&((n=o=Un)&&(o=sT(o,r.pendingProps,zr),o!==null?(r.stateNode=o,Os=r,Un=null,n=!0):n=!1),n||ja(r)),null;case 13:return u1(n,r,o);case 4:return Ge(r,r.stateNode.containerInfo),c=r.pendingProps,n===null?r.child=To(r,null,c,o):Vs(n,r,c,o),r.child;case 11:return t1(n,r,r.type,r.pendingProps,o);case 7:return Vs(n,r,r.pendingProps,o),r.child;case 8:return Vs(n,r,r.pendingProps.children,o),r.child;case 12:return Vs(n,r,r.pendingProps.children,o),r.child;case 10:return c=r.pendingProps,Ea(r,r.type,c.value),Vs(n,r,c.children,o),r.child;case 9:return f=r.type._context,c=r.pendingProps.children,_o(r),f=Ps(f),c=c(f),r.flags|=1,Vs(n,r,c,o),r.child;case 14:return n1(n,r,r.type,r.pendingProps,o);case 15:return s1(n,r,r.type,r.pendingProps,o);case 19:return h1(n,r,o);case 31:return EE(n,r,o);case 22:return r1(n,r,o,r.pendingProps);case 24:return _o(r),c=Ps(ms),n===null?(f=em(),f===null&&(f=An,m=Jf(),f.pooledCache=m,m.refCount++,m!==null&&(f.pooledCacheLanes|=o),f=m),r.memoizedState={parent:c,cache:f},nm(r),Ea(r,ms,f)):((n.lanes&o)!==0&&(sm(n,r),jc(r,null,null,o),kc()),f=n.memoizedState,m=r.memoizedState,f.parent!==c?(f={parent:c,cache:c},r.memoizedState=f,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=f),Ea(r,ms,c)):(c=m.cache,Ea(r,ms,c),c!==f.cache&&Xf(r,[ms],o,!0))),Vs(n,r,r.pendingProps.children,o),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function $i(n){n.flags|=4}function Vm(n,r,o,c,f){if((r=(n.mode&32)!==0)&&(r=!1),r){if(n.flags|=16777216,(f&335544128)===f)if(n.stateNode.complete)n.flags|=8192;else if(B1())n.flags|=8192;else throw Eo=gd,tm}else n.flags&=-16777217}function m1(n,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!Nb(r))if(B1())n.flags|=8192;else throw Eo=gd,tm}function Id(n,r){r!==null&&(n.flags|=4),n.flags&16384&&(r=n.tag!==22?at():536870912,n.lanes|=r,El|=r)}function Ac(n,r){if(!nn)switch(n.tailMode){case"hidden":r=n.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?n.tail=null:o.sibling=null;break;case"collapsed":o=n.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?r||n.tail===null?n.tail=null:n.tail.sibling=null:c.sibling=null}}function Bn(n){var r=n.alternate!==null&&n.alternate.child===n.child,o=0,c=0;if(r)for(var f=n.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags&65011712,c|=f.flags&65011712,f.return=n,f=f.sibling;else for(f=n.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags,c|=f.flags,f.return=n,f=f.sibling;return n.subtreeFlags|=c,n.childLanes=o,r}function SE(n,r,o){var c=r.pendingProps;switch(Wf(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bn(r),null;case 1:return Bn(r),null;case 3:return o=r.stateNode,c=null,n!==null&&(c=n.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),zi(ms),tt(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(n===null||n.child===null)&&(hl(r)?$i(r):n===null||n.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Kf())),Bn(r),null;case 26:var f=r.type,m=r.memoizedState;return n===null?($i(r),m!==null?(Bn(r),m1(r,m)):(Bn(r),Vm(r,f,null,c,o))):m?m!==n.memoizedState?($i(r),Bn(r),m1(r,m)):(Bn(r),r.flags&=-16777217):(n=n.memoizedProps,n!==c&&$i(r),Bn(r),Vm(r,f,n,c,o)),null;case 27:if(Tt(r),o=Oe.current,f=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==c&&$i(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return Bn(r),null}n=Se.current,hl(r)?G0(r):(n=xb(f,c,o),r.stateNode=n,$i(r))}return Bn(r),null;case 5:if(Tt(r),f=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==c&&$i(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return Bn(r),null}if(m=Se.current,hl(r))G0(r);else{var x=Gd(Oe.current);switch(m){case 1:m=x.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:m=x.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":m=x.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":m=x.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":m=x.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild);break;case"select":m=typeof c.is=="string"?x.createElement("select",{is:c.is}):x.createElement("select"),c.multiple?m.multiple=!0:c.size&&(m.size=c.size);break;default:m=typeof c.is=="string"?x.createElement(f,{is:c.is}):x.createElement(f)}}m[Nn]=r,m[an]=c;e:for(x=r.child;x!==null;){if(x.tag===5||x.tag===6)m.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===r)break e;for(;x.sibling===null;){if(x.return===null||x.return===r)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}r.stateNode=m;e:switch(Us(m,f,c),f){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&$i(r)}}return Bn(r),Vm(r,r.type,n===null?null:n.memoizedProps,r.pendingProps,o),null;case 6:if(n&&r.stateNode!=null)n.memoizedProps!==c&&$i(r);else{if(typeof c!="string"&&r.stateNode===null)throw Error(i(166));if(n=Oe.current,hl(r)){if(n=r.stateNode,o=r.memoizedProps,c=null,f=Os,f!==null)switch(f.tag){case 27:case 5:c=f.memoizedProps}n[Nn]=r,n=!!(n.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||ub(n.nodeValue,o)),n||ja(r,!0)}else n=Gd(n).createTextNode(c),n[Nn]=r,r.stateNode=n}return Bn(r),null;case 31:if(o=r.memoizedState,n===null||n.memoizedState!==null){if(c=hl(r),o!==null){if(n===null){if(!c)throw Error(i(318));if(n=r.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(557));n[Nn]=r}else wo(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Bn(r),n=!1}else o=Kf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=o),n=!0;if(!n)return r.flags&256?(Sr(r),r):(Sr(r),null);if((r.flags&128)!==0)throw Error(i(558))}return Bn(r),null;case 13:if(c=r.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(f=hl(r),c!==null&&c.dehydrated!==null){if(n===null){if(!f)throw Error(i(318));if(f=r.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(i(317));f[Nn]=r}else wo(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Bn(r),f=!1}else f=Kf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=f),f=!0;if(!f)return r.flags&256?(Sr(r),r):(Sr(r),null)}return Sr(r),(r.flags&128)!==0?(r.lanes=o,r):(o=c!==null,n=n!==null&&n.memoizedState!==null,o&&(c=r.child,f=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(f=c.alternate.memoizedState.cachePool.pool),m=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(m=c.memoizedState.cachePool.pool),m!==f&&(c.flags|=2048)),o!==n&&o&&(r.child.flags|=8192),Id(r,r.updateQueue),Bn(r),null);case 4:return tt(),n===null&&ag(r.stateNode.containerInfo),Bn(r),null;case 10:return zi(r.type),Bn(r),null;case 19:if(le(us),c=r.memoizedState,c===null)return Bn(r),null;if(f=(r.flags&128)!==0,m=c.rendering,m===null)if(f)Ac(c,!1);else{if(ns!==0||n!==null&&(n.flags&128)!==0)for(n=r.child;n!==null;){if(m=bd(n),m!==null){for(r.flags|=128,Ac(c,!1),n=m.updateQueue,r.updateQueue=n,Id(r,n),r.subtreeFlags=0,n=o,o=r.child;o!==null;)F0(o,n),o=o.sibling;return Ce(us,us.current&1|2),nn&&Ui(r,c.treeForkCount),r.child}n=n.sibling}c.tail!==null&&ut()>Pd&&(r.flags|=128,f=!0,Ac(c,!1),r.lanes=4194304)}else{if(!f)if(n=bd(m),n!==null){if(r.flags|=128,f=!0,n=n.updateQueue,r.updateQueue=n,Id(r,n),Ac(c,!0),c.tail===null&&c.tailMode==="hidden"&&!m.alternate&&!nn)return Bn(r),null}else 2*ut()-c.renderingStartTime>Pd&&o!==536870912&&(r.flags|=128,f=!0,Ac(c,!1),r.lanes=4194304);c.isBackwards?(m.sibling=r.child,r.child=m):(n=c.last,n!==null?n.sibling=m:r.child=m,c.last=m)}return c.tail!==null?(n=c.tail,c.rendering=n,c.tail=n.sibling,c.renderingStartTime=ut(),n.sibling=null,o=us.current,Ce(us,f?o&1|2:o&1),nn&&Ui(r,c.treeForkCount),n):(Bn(r),null);case 22:case 23:return Sr(r),om(),c=r.memoizedState!==null,n!==null?n.memoizedState!==null!==c&&(r.flags|=8192):c&&(r.flags|=8192),c?(o&536870912)!==0&&(r.flags&128)===0&&(Bn(r),r.subtreeFlags&6&&(r.flags|=8192)):Bn(r),o=r.updateQueue,o!==null&&Id(r,o.retryQueue),o=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),c=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),c!==o&&(r.flags|=2048),n!==null&&le(ko),null;case 24:return o=null,n!==null&&(o=n.memoizedState.cache),r.memoizedState.cache!==o&&(r.flags|=2048),zi(ms),Bn(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function CE(n,r){switch(Wf(r),r.tag){case 1:return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 3:return zi(ms),tt(),n=r.flags,(n&65536)!==0&&(n&128)===0?(r.flags=n&-65537|128,r):null;case 26:case 27:case 5:return Tt(r),null;case 31:if(r.memoizedState!==null){if(Sr(r),r.alternate===null)throw Error(i(340));wo()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 13:if(Sr(r),n=r.memoizedState,n!==null&&n.dehydrated!==null){if(r.alternate===null)throw Error(i(340));wo()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 19:return le(us),null;case 4:return tt(),null;case 10:return zi(r.type),null;case 22:case 23:return Sr(r),om(),n!==null&&le(ko),n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 24:return zi(ms),null;case 25:return null;default:return null}}function g1(n,r){switch(Wf(r),r.tag){case 3:zi(ms),tt();break;case 26:case 27:case 5:Tt(r);break;case 4:tt();break;case 31:r.memoizedState!==null&&Sr(r);break;case 13:Sr(r);break;case 19:le(us);break;case 10:zi(r.type);break;case 22:case 23:Sr(r),om(),n!==null&&le(ko);break;case 24:zi(ms)}}function Rc(n,r){try{var o=r.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var f=c.next;o=f;do{if((o.tag&n)===n){c=void 0;var m=o.create,x=o.inst;c=m(),x.destroy=c}o=o.next}while(o!==f)}}catch(E){xn(r,r.return,E)}}function Ra(n,r,o){try{var c=r.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var m=f.next;c=m;do{if((c.tag&n)===n){var x=c.inst,E=x.destroy;if(E!==void 0){x.destroy=void 0,f=r;var z=o,ie=E;try{ie()}catch(ye){xn(f,z,ye)}}}c=c.next}while(c!==m)}}catch(ye){xn(r,r.return,ye)}}function p1(n){var r=n.updateQueue;if(r!==null){var o=n.stateNode;try{av(r,o)}catch(c){xn(n,n.return,c)}}}function y1(n,r,o){o.props=Co(n.type,n.memoizedProps),o.state=n.memoizedState;try{o.componentWillUnmount()}catch(c){xn(n,r,c)}}function Ic(n,r){try{var o=n.ref;if(o!==null){switch(n.tag){case 26:case 27:case 5:var c=n.stateNode;break;case 30:c=n.stateNode;break;default:c=n.stateNode}typeof o=="function"?n.refCleanup=o(c):o.current=c}}catch(f){xn(n,r,f)}}function xi(n,r){var o=n.ref,c=n.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(f){xn(n,r,f)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(f){xn(n,r,f)}else o.current=null}function v1(n){var r=n.type,o=n.memoizedProps,c=n.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(f){xn(n,n.return,f)}}function Um(n,r,o){try{var c=n.stateNode;QE(c,n.type,o,r),c[an]=r}catch(f){xn(n,n.return,f)}}function b1(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&Va(n.type)||n.tag===4}function Bm(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||b1(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&Va(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function zm(n,r,o){var c=n.tag;if(c===5||c===6)n=n.stateNode,r?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(n,r):(r=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,r.appendChild(n),o=o._reactRootContainer,o!=null||r.onclick!==null||(r.onclick=Zs));else if(c!==4&&(c===27&&Va(n.type)&&(o=n.stateNode,r=null),n=n.child,n!==null))for(zm(n,r,o),n=n.sibling;n!==null;)zm(n,r,o),n=n.sibling}function Md(n,r,o){var c=n.tag;if(c===5||c===6)n=n.stateNode,r?o.insertBefore(n,r):o.appendChild(n);else if(c!==4&&(c===27&&Va(n.type)&&(o=n.stateNode),n=n.child,n!==null))for(Md(n,r,o),n=n.sibling;n!==null;)Md(n,r,o),n=n.sibling}function w1(n){var r=n.stateNode,o=n.memoizedProps;try{for(var c=n.type,f=r.attributes;f.length;)r.removeAttributeNode(f[0]);Us(r,c,o),r[Nn]=n,r[an]=o}catch(m){xn(n,n.return,m)}}var Wi=!1,ys=!1,Fm=!1,x1=typeof WeakSet=="function"?WeakSet:Set,Is=null;function NE(n,r){if(n=n.containerInfo,cg=eh,n=M0(n),Lf(n)){if("selectionStart"in n)var o={start:n.selectionStart,end:n.selectionEnd};else e:{o=(o=n.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var f=c.anchorOffset,m=c.focusNode;c=c.focusOffset;try{o.nodeType,m.nodeType}catch{o=null;break e}var x=0,E=-1,z=-1,ie=0,ye=0,_e=n,ce=null;t:for(;;){for(var fe;_e!==o||f!==0&&_e.nodeType!==3||(E=x+f),_e!==m||c!==0&&_e.nodeType!==3||(z=x+c),_e.nodeType===3&&(x+=_e.nodeValue.length),(fe=_e.firstChild)!==null;)ce=_e,_e=fe;for(;;){if(_e===n)break t;if(ce===o&&++ie===f&&(E=x),ce===m&&++ye===c&&(z=x),(fe=_e.nextSibling)!==null)break;_e=ce,ce=_e.parentNode}_e=fe}o=E===-1||z===-1?null:{start:E,end:z}}else o=null}o=o||{start:0,end:0}}else o=null;for(ug={focusedElem:n,selectionRange:o},eh=!1,Is=r;Is!==null;)if(r=Is,n=r.child,(r.subtreeFlags&1028)!==0&&n!==null)n.return=r,Is=n;else for(;Is!==null;){switch(r=Is,m=r.alternate,n=r.flags,r.tag){case 0:if((n&4)!==0&&(n=r.updateQueue,n=n!==null?n.events:null,n!==null))for(o=0;o<n.length;o++)f=n[o],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&m!==null){n=void 0,o=r,f=m.memoizedProps,m=m.memoizedState,c=o.stateNode;try{var et=Co(o.type,f);n=c.getSnapshotBeforeUpdate(et,m),c.__reactInternalSnapshotBeforeUpdate=n}catch(vt){xn(o,o.return,vt)}}break;case 3:if((n&1024)!==0){if(n=r.stateNode.containerInfo,o=n.nodeType,o===9)fg(n);else if(o===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":fg(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(i(163))}if(n=r.sibling,n!==null){n.return=r.return,Is=n;break}Is=r.return}}function _1(n,r,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:Ki(n,o),c&4&&Rc(5,o);break;case 1:if(Ki(n,o),c&4)if(n=o.stateNode,r===null)try{n.componentDidMount()}catch(x){xn(o,o.return,x)}else{var f=Co(o.type,r.memoizedProps);r=r.memoizedState;try{n.componentDidUpdate(f,r,n.__reactInternalSnapshotBeforeUpdate)}catch(x){xn(o,o.return,x)}}c&64&&p1(o),c&512&&Ic(o,o.return);break;case 3:if(Ki(n,o),c&64&&(n=o.updateQueue,n!==null)){if(r=null,o.child!==null)switch(o.child.tag){case 27:case 5:r=o.child.stateNode;break;case 1:r=o.child.stateNode}try{av(n,r)}catch(x){xn(o,o.return,x)}}break;case 27:r===null&&c&4&&w1(o);case 26:case 5:Ki(n,o),r===null&&c&4&&v1(o),c&512&&Ic(o,o.return);break;case 12:Ki(n,o);break;case 31:Ki(n,o),c&4&&E1(n,o);break;case 13:Ki(n,o),c&4&&T1(n,o),c&64&&(n=o.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(o=VE.bind(null,o),rT(n,o))));break;case 22:if(c=o.memoizedState!==null||Wi,!c){r=r!==null&&r.memoizedState!==null||ys,f=Wi;var m=ys;Wi=c,(ys=r)&&!m?Yi(n,o,(o.subtreeFlags&8772)!==0):Ki(n,o),Wi=f,ys=m}break;case 30:break;default:Ki(n,o)}}function k1(n){var r=n.alternate;r!==null&&(n.alternate=null,k1(r)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(r=n.stateNode,r!==null&&Es(r)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var $n=null,dr=!1;function Gi(n,r,o){for(o=o.child;o!==null;)j1(n,r,o),o=o.sibling}function j1(n,r,o){if(zt&&typeof zt.onCommitFiberUnmount=="function")try{zt.onCommitFiberUnmount(tn,o)}catch{}switch(o.tag){case 26:ys||xi(o,r),Gi(n,r,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:ys||xi(o,r);var c=$n,f=dr;Va(o.type)&&($n=o.stateNode,dr=!1),Gi(n,r,o),zc(o.stateNode),$n=c,dr=f;break;case 5:ys||xi(o,r);case 6:if(c=$n,f=dr,$n=null,Gi(n,r,o),$n=c,dr=f,$n!==null)if(dr)try{($n.nodeType===9?$n.body:$n.nodeName==="HTML"?$n.ownerDocument.body:$n).removeChild(o.stateNode)}catch(m){xn(o,r,m)}else try{$n.removeChild(o.stateNode)}catch(m){xn(o,r,m)}break;case 18:$n!==null&&(dr?(n=$n,pb(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,o.stateNode),Ml(n)):pb($n,o.stateNode));break;case 4:c=$n,f=dr,$n=o.stateNode.containerInfo,dr=!0,Gi(n,r,o),$n=c,dr=f;break;case 0:case 11:case 14:case 15:Ra(2,o,r),ys||Ra(4,o,r),Gi(n,r,o);break;case 1:ys||(xi(o,r),c=o.stateNode,typeof c.componentWillUnmount=="function"&&y1(o,r,c)),Gi(n,r,o);break;case 21:Gi(n,r,o);break;case 22:ys=(c=ys)||o.memoizedState!==null,Gi(n,r,o),ys=c;break;default:Gi(n,r,o)}}function E1(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{Ml(n)}catch(o){xn(r,r.return,o)}}}function T1(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Ml(n)}catch(o){xn(r,r.return,o)}}function AE(n){switch(n.tag){case 31:case 13:case 19:var r=n.stateNode;return r===null&&(r=n.stateNode=new x1),r;case 22:return n=n.stateNode,r=n._retryCache,r===null&&(r=n._retryCache=new x1),r;default:throw Error(i(435,n.tag))}}function Dd(n,r){var o=AE(n);r.forEach(function(c){if(!o.has(c)){o.add(c);var f=UE.bind(null,n,c);c.then(f,f)}})}function hr(n,r){var o=r.deletions;if(o!==null)for(var c=0;c<o.length;c++){var f=o[c],m=n,x=r,E=x;e:for(;E!==null;){switch(E.tag){case 27:if(Va(E.type)){$n=E.stateNode,dr=!1;break e}break;case 5:$n=E.stateNode,dr=!1;break e;case 3:case 4:$n=E.stateNode.containerInfo,dr=!0;break e}E=E.return}if($n===null)throw Error(i(160));j1(m,x,f),$n=null,dr=!1,m=f.alternate,m!==null&&(m.return=null),f.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)S1(r,n),r=r.sibling}var ii=null;function S1(n,r){var o=n.alternate,c=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:hr(r,n),fr(n),c&4&&(Ra(3,n,n.return),Rc(3,n),Ra(5,n,n.return));break;case 1:hr(r,n),fr(n),c&512&&(ys||o===null||xi(o,o.return)),c&64&&Wi&&(n=n.updateQueue,n!==null&&(c=n.callbacks,c!==null&&(o=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var f=ii;if(hr(r,n),fr(n),c&512&&(ys||o===null||xi(o,o.return)),c&4){var m=o!==null?o.memoizedState:null;if(c=n.memoizedState,o===null)if(c===null)if(n.stateNode===null){e:{c=n.type,o=n.memoizedProps,f=f.ownerDocument||f;t:switch(c){case"title":m=f.getElementsByTagName("title")[0],(!m||m[js]||m[Nn]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=f.createElement(c),f.head.insertBefore(m,f.querySelector("head > title"))),Us(m,c,o),m[Nn]=n,pn(m),c=m;break e;case"link":var x=Sb("link","href",f).get(c+(o.href||""));if(x){for(var E=0;E<x.length;E++)if(m=x[E],m.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&m.getAttribute("rel")===(o.rel==null?null:o.rel)&&m.getAttribute("title")===(o.title==null?null:o.title)&&m.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){x.splice(E,1);break t}}m=f.createElement(c),Us(m,c,o),f.head.appendChild(m);break;case"meta":if(x=Sb("meta","content",f).get(c+(o.content||""))){for(E=0;E<x.length;E++)if(m=x[E],m.getAttribute("content")===(o.content==null?null:""+o.content)&&m.getAttribute("name")===(o.name==null?null:o.name)&&m.getAttribute("property")===(o.property==null?null:o.property)&&m.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&m.getAttribute("charset")===(o.charSet==null?null:o.charSet)){x.splice(E,1);break t}}m=f.createElement(c),Us(m,c,o),f.head.appendChild(m);break;default:throw Error(i(468,c))}m[Nn]=n,pn(m),c=m}n.stateNode=c}else Cb(f,n.type,n.stateNode);else n.stateNode=Tb(f,c,n.memoizedProps);else m!==c?(m===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):m.count--,c===null?Cb(f,n.type,n.stateNode):Tb(f,c,n.memoizedProps)):c===null&&n.stateNode!==null&&Um(n,n.memoizedProps,o.memoizedProps)}break;case 27:hr(r,n),fr(n),c&512&&(ys||o===null||xi(o,o.return)),o!==null&&c&4&&Um(n,n.memoizedProps,o.memoizedProps);break;case 5:if(hr(r,n),fr(n),c&512&&(ys||o===null||xi(o,o.return)),n.flags&32){f=n.stateNode;try{Rs(f,"")}catch(et){xn(n,n.return,et)}}c&4&&n.stateNode!=null&&(f=n.memoizedProps,Um(n,f,o!==null?o.memoizedProps:f)),c&1024&&(Fm=!0);break;case 6:if(hr(r,n),fr(n),c&4){if(n.stateNode===null)throw Error(i(162));c=n.memoizedProps,o=n.stateNode;try{o.nodeValue=c}catch(et){xn(n,n.return,et)}}break;case 3:if(Qd=null,f=ii,ii=Kd(r.containerInfo),hr(r,n),ii=f,fr(n),c&4&&o!==null&&o.memoizedState.isDehydrated)try{Ml(r.containerInfo)}catch(et){xn(n,n.return,et)}Fm&&(Fm=!1,C1(n));break;case 4:c=ii,ii=Kd(n.stateNode.containerInfo),hr(r,n),fr(n),ii=c;break;case 12:hr(r,n),fr(n);break;case 31:hr(r,n),fr(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Dd(n,c)));break;case 13:hr(r,n),fr(n),n.child.flags&8192&&n.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Od=ut()),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Dd(n,c)));break;case 22:f=n.memoizedState!==null;var z=o!==null&&o.memoizedState!==null,ie=Wi,ye=ys;if(Wi=ie||f,ys=ye||z,hr(r,n),ys=ye,Wi=ie,fr(n),c&8192)e:for(r=n.stateNode,r._visibility=f?r._visibility&-2:r._visibility|1,f&&(o===null||z||Wi||ys||No(n)),o=null,r=n;;){if(r.tag===5||r.tag===26){if(o===null){z=o=r;try{if(m=z.stateNode,f)x=m.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none";else{E=z.stateNode;var _e=z.memoizedProps.style,ce=_e!=null&&_e.hasOwnProperty("display")?_e.display:null;E.style.display=ce==null||typeof ce=="boolean"?"":(""+ce).trim()}}catch(et){xn(z,z.return,et)}}}else if(r.tag===6){if(o===null){z=r;try{z.stateNode.nodeValue=f?"":z.memoizedProps}catch(et){xn(z,z.return,et)}}}else if(r.tag===18){if(o===null){z=r;try{var fe=z.stateNode;f?yb(fe,!0):yb(z.stateNode,!1)}catch(et){xn(z,z.return,et)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===n)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break e;for(;r.sibling===null;){if(r.return===null||r.return===n)break e;o===r&&(o=null),r=r.return}o===r&&(o=null),r.sibling.return=r.return,r=r.sibling}c&4&&(c=n.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,Dd(n,o))));break;case 19:hr(r,n),fr(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Dd(n,c)));break;case 30:break;case 21:break;default:hr(r,n),fr(n)}}function fr(n){var r=n.flags;if(r&2){try{for(var o,c=n.return;c!==null;){if(b1(c)){o=c;break}c=c.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var f=o.stateNode,m=Bm(n);Md(n,m,f);break;case 5:var x=o.stateNode;o.flags&32&&(Rs(x,""),o.flags&=-33);var E=Bm(n);Md(n,E,x);break;case 3:case 4:var z=o.stateNode.containerInfo,ie=Bm(n);zm(n,ie,z);break;default:throw Error(i(161))}}catch(ye){xn(n,n.return,ye)}n.flags&=-3}r&4096&&(n.flags&=-4097)}function C1(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var r=n;C1(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),n=n.sibling}}function Ki(n,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)_1(n,r.alternate,r),r=r.sibling}function No(n){for(n=n.child;n!==null;){var r=n;switch(r.tag){case 0:case 11:case 14:case 15:Ra(4,r,r.return),No(r);break;case 1:xi(r,r.return);var o=r.stateNode;typeof o.componentWillUnmount=="function"&&y1(r,r.return,o),No(r);break;case 27:zc(r.stateNode);case 26:case 5:xi(r,r.return),No(r);break;case 22:r.memoizedState===null&&No(r);break;case 30:No(r);break;default:No(r)}n=n.sibling}}function Yi(n,r,o){for(o=o&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var c=r.alternate,f=n,m=r,x=m.flags;switch(m.tag){case 0:case 11:case 15:Yi(f,m,o),Rc(4,m);break;case 1:if(Yi(f,m,o),c=m,f=c.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(ie){xn(c,c.return,ie)}if(c=m,f=c.updateQueue,f!==null){var E=c.stateNode;try{var z=f.shared.hiddenCallbacks;if(z!==null)for(f.shared.hiddenCallbacks=null,f=0;f<z.length;f++)iv(z[f],E)}catch(ie){xn(c,c.return,ie)}}o&&x&64&&p1(m),Ic(m,m.return);break;case 27:w1(m);case 26:case 5:Yi(f,m,o),o&&c===null&&x&4&&v1(m),Ic(m,m.return);break;case 12:Yi(f,m,o);break;case 31:Yi(f,m,o),o&&x&4&&E1(f,m);break;case 13:Yi(f,m,o),o&&x&4&&T1(f,m);break;case 22:m.memoizedState===null&&Yi(f,m,o),Ic(m,m.return);break;case 30:break;default:Yi(f,m,o)}r=r.sibling}}function Hm(n,r){var o=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),n=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(n=r.memoizedState.cachePool.pool),n!==o&&(n!=null&&n.refCount++,o!=null&&vc(o))}function qm(n,r){n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&vc(n))}function ai(n,r,o,c){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)N1(n,r,o,c),r=r.sibling}function N1(n,r,o,c){var f=r.flags;switch(r.tag){case 0:case 11:case 15:ai(n,r,o,c),f&2048&&Rc(9,r);break;case 1:ai(n,r,o,c);break;case 3:ai(n,r,o,c),f&2048&&(n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&vc(n)));break;case 12:if(f&2048){ai(n,r,o,c),n=r.stateNode;try{var m=r.memoizedProps,x=m.id,E=m.onPostCommit;typeof E=="function"&&E(x,r.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(z){xn(r,r.return,z)}}else ai(n,r,o,c);break;case 31:ai(n,r,o,c);break;case 13:ai(n,r,o,c);break;case 23:break;case 22:m=r.stateNode,x=r.alternate,r.memoizedState!==null?m._visibility&2?ai(n,r,o,c):Mc(n,r):m._visibility&2?ai(n,r,o,c):(m._visibility|=2,_l(n,r,o,c,(r.subtreeFlags&10256)!==0||!1)),f&2048&&Hm(x,r);break;case 24:ai(n,r,o,c),f&2048&&qm(r.alternate,r);break;default:ai(n,r,o,c)}}function _l(n,r,o,c,f){for(f=f&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var m=n,x=r,E=o,z=c,ie=x.flags;switch(x.tag){case 0:case 11:case 15:_l(m,x,E,z,f),Rc(8,x);break;case 23:break;case 22:var ye=x.stateNode;x.memoizedState!==null?ye._visibility&2?_l(m,x,E,z,f):Mc(m,x):(ye._visibility|=2,_l(m,x,E,z,f)),f&&ie&2048&&Hm(x.alternate,x);break;case 24:_l(m,x,E,z,f),f&&ie&2048&&qm(x.alternate,x);break;default:_l(m,x,E,z,f)}r=r.sibling}}function Mc(n,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var o=n,c=r,f=c.flags;switch(c.tag){case 22:Mc(o,c),f&2048&&Hm(c.alternate,c);break;case 24:Mc(o,c),f&2048&&qm(c.alternate,c);break;default:Mc(o,c)}r=r.sibling}}var Dc=8192;function kl(n,r,o){if(n.subtreeFlags&Dc)for(n=n.child;n!==null;)A1(n,r,o),n=n.sibling}function A1(n,r,o){switch(n.tag){case 26:kl(n,r,o),n.flags&Dc&&n.memoizedState!==null&&pT(o,ii,n.memoizedState,n.memoizedProps);break;case 5:kl(n,r,o);break;case 3:case 4:var c=ii;ii=Kd(n.stateNode.containerInfo),kl(n,r,o),ii=c;break;case 22:n.memoizedState===null&&(c=n.alternate,c!==null&&c.memoizedState!==null?(c=Dc,Dc=16777216,kl(n,r,o),Dc=c):kl(n,r,o));break;default:kl(n,r,o)}}function R1(n){var r=n.alternate;if(r!==null&&(n=r.child,n!==null)){r.child=null;do r=n.sibling,n.sibling=null,n=r;while(n!==null)}}function Lc(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];Is=c,M1(c,n)}R1(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)I1(n),n=n.sibling}function I1(n){switch(n.tag){case 0:case 11:case 15:Lc(n),n.flags&2048&&Ra(9,n,n.return);break;case 3:Lc(n);break;case 12:Lc(n);break;case 22:var r=n.stateNode;n.memoizedState!==null&&r._visibility&2&&(n.return===null||n.return.tag!==13)?(r._visibility&=-3,Ld(n)):Lc(n);break;default:Lc(n)}}function Ld(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];Is=c,M1(c,n)}R1(n)}for(n=n.child;n!==null;){switch(r=n,r.tag){case 0:case 11:case 15:Ra(8,r,r.return),Ld(r);break;case 22:o=r.stateNode,o._visibility&2&&(o._visibility&=-3,Ld(r));break;default:Ld(r)}n=n.sibling}}function M1(n,r){for(;Is!==null;){var o=Is;switch(o.tag){case 0:case 11:case 15:Ra(8,o,r);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:vc(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,Is=c;else e:for(o=n;Is!==null;){c=Is;var f=c.sibling,m=c.return;if(k1(c),c===o){Is=null;break e}if(f!==null){f.return=m,Is=f;break e}Is=m}}}var RE={getCacheForType:function(n){var r=Ps(ms),o=r.data.get(n);return o===void 0&&(o=n(),r.data.set(n,o)),o},cacheSignal:function(){return Ps(ms).controller.signal}},IE=typeof WeakMap=="function"?WeakMap:Map,mn=0,An=null,qt=null,Kt=0,wn=0,Cr=null,Ia=!1,jl=!1,$m=!1,Qi=0,ns=0,Ma=0,Ao=0,Wm=0,Nr=0,El=0,Oc=null,mr=null,Gm=!1,Od=0,D1=0,Pd=1/0,Vd=null,Da=null,Ss=0,La=null,Tl=null,Xi=0,Km=0,Ym=null,L1=null,Pc=0,Qm=null;function Ar(){return(mn&2)!==0&&Kt!==0?Kt&-Kt:J.T!==null?ng():on()}function O1(){if(Nr===0)if((Kt&536870912)===0||nn){var n=De;De<<=1,(De&3932160)===0&&(De=262144),Nr=n}else Nr=536870912;return n=Tr.current,n!==null&&(n.flags|=32),Nr}function gr(n,r,o){(n===An&&(wn===2||wn===9)||n.cancelPendingCommit!==null)&&(Sl(n,0),Oa(n,Kt,Nr,!1)),Ae(n,o),((mn&2)===0||n!==An)&&(n===An&&((mn&2)===0&&(Ao|=o),ns===4&&Oa(n,Kt,Nr,!1)),_i(n))}function P1(n,r,o){if((mn&6)!==0)throw Error(i(327));var c=!o&&(r&127)===0&&(r&n.expiredLanes)===0||Dt(n,r),f=c?LE(n,r):Jm(n,r,!0),m=c;do{if(f===0){jl&&!c&&Oa(n,r,0,!1);break}else{if(o=n.current.alternate,m&&!ME(o)){f=Jm(n,r,!1),m=!1;continue}if(f===2){if(m=r,n.errorRecoveryDisabledLanes&m)var x=0;else x=n.pendingLanes&-536870913,x=x!==0?x:x&536870912?536870912:0;if(x!==0){r=x;e:{var E=n;f=Oc;var z=E.current.memoizedState.isDehydrated;if(z&&(Sl(E,x).flags|=256),x=Jm(E,x,!1),x!==2){if($m&&!z){E.errorRecoveryDisabledLanes|=m,Ao|=m,f=4;break e}m=mr,mr=f,m!==null&&(mr===null?mr=m:mr.push.apply(mr,m))}f=x}if(m=!1,f!==2)continue}}if(f===1){Sl(n,0),Oa(n,r,0,!0);break}e:{switch(c=n,m=f,m){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:Oa(c,r,Nr,!Ia);break e;case 2:mr=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(f=Od+300-ut(),10<f)){if(Oa(c,r,Nr,!Ia),Pe(c,0,!0)!==0)break e;Xi=r,c.timeoutHandle=mb(V1.bind(null,c,o,mr,Vd,Gm,r,Nr,Ao,El,Ia,m,"Throttled",-0,0),f);break e}V1(c,o,mr,Vd,Gm,r,Nr,Ao,El,Ia,m,null,-0,0)}}break}while(!0);_i(n)}function V1(n,r,o,c,f,m,x,E,z,ie,ye,_e,ce,fe){if(n.timeoutHandle=-1,_e=r.subtreeFlags,_e&8192||(_e&16785408)===16785408){_e={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Zs},A1(r,m,_e);var et=(m&62914560)===m?Od-ut():(m&4194048)===m?D1-ut():0;if(et=yT(_e,et),et!==null){Xi=m,n.cancelPendingCommit=et(W1.bind(null,n,r,m,o,c,f,x,E,z,ye,_e,null,ce,fe)),Oa(n,m,x,!ie);return}}W1(n,r,m,o,c,f,x,E,z)}function ME(n){for(var r=n;;){var o=r.tag;if((o===0||o===11||o===15)&&r.flags&16384&&(o=r.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var f=o[c],m=f.getSnapshot;f=f.value;try{if(!jr(m(),f))return!1}catch{return!1}}if(o=r.child,r.subtreeFlags&16384&&o!==null)o.return=r,r=o;else{if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Oa(n,r,o,c){r&=~Wm,r&=~Ao,n.suspendedLanes|=r,n.pingedLanes&=~r,c&&(n.warmLanes|=r),c=n.expirationTimes;for(var f=r;0<f;){var m=31-At(f),x=1<<m;c[m]=-1,f&=~x}o!==0&&pt(n,o,r)}function Ud(){return(mn&6)===0?(Vc(0),!1):!0}function Xm(){if(qt!==null){if(wn===0)var n=qt.return;else n=qt,Bi=xo=null,fm(n),yl=null,wc=0,n=qt;for(;n!==null;)g1(n.alternate,n),n=n.return;qt=null}}function Sl(n,r){var o=n.timeoutHandle;o!==-1&&(n.timeoutHandle=-1,ZE(o)),o=n.cancelPendingCommit,o!==null&&(n.cancelPendingCommit=null,o()),Xi=0,Xm(),An=n,qt=o=Vi(n.current,null),Kt=r,wn=0,Cr=null,Ia=!1,jl=Dt(n,r),$m=!1,El=Nr=Wm=Ao=Ma=ns=0,mr=Oc=null,Gm=!1,(r&8)!==0&&(r|=r&32);var c=n.entangledLanes;if(c!==0)for(n=n.entanglements,c&=r;0<c;){var f=31-At(c),m=1<<f;r|=n[f],c&=~m}return Qi=r,ad(),o}function U1(n,r){It=null,J.H=Cc,r===pl||r===md?(r=tv(),wn=3):r===tm?(r=tv(),wn=4):wn=r===Nm?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Cr=r,qt===null&&(ns=1,Cd(n,Vr(r,n.current)))}function B1(){var n=Tr.current;return n===null?!0:(Kt&4194048)===Kt?Fr===null:(Kt&62914560)===Kt||(Kt&536870912)!==0?n===Fr:!1}function z1(){var n=J.H;return J.H=Cc,n===null?Cc:n}function F1(){var n=J.A;return J.A=RE,n}function Bd(){ns=4,Ia||(Kt&4194048)!==Kt&&Tr.current!==null||(jl=!0),(Ma&134217727)===0&&(Ao&134217727)===0||An===null||Oa(An,Kt,Nr,!1)}function Jm(n,r,o){var c=mn;mn|=2;var f=z1(),m=F1();(An!==n||Kt!==r)&&(Vd=null,Sl(n,r)),r=!1;var x=ns;e:do try{if(wn!==0&&qt!==null){var E=qt,z=Cr;switch(wn){case 8:Xm(),x=6;break e;case 3:case 2:case 9:case 6:Tr.current===null&&(r=!0);var ie=wn;if(wn=0,Cr=null,Cl(n,E,z,ie),o&&jl){x=0;break e}break;default:ie=wn,wn=0,Cr=null,Cl(n,E,z,ie)}}DE(),x=ns;break}catch(ye){U1(n,ye)}while(!0);return r&&n.shellSuspendCounter++,Bi=xo=null,mn=c,J.H=f,J.A=m,qt===null&&(An=null,Kt=0,ad()),x}function DE(){for(;qt!==null;)H1(qt)}function LE(n,r){var o=mn;mn|=2;var c=z1(),f=F1();An!==n||Kt!==r?(Vd=null,Pd=ut()+500,Sl(n,r)):jl=Dt(n,r);e:do try{if(wn!==0&&qt!==null){r=qt;var m=Cr;t:switch(wn){case 1:wn=0,Cr=null,Cl(n,r,m,1);break;case 2:case 9:if(Z0(m)){wn=0,Cr=null,q1(r);break}r=function(){wn!==2&&wn!==9||An!==n||(wn=7),_i(n)},m.then(r,r);break e;case 3:wn=7;break e;case 4:wn=5;break e;case 7:Z0(m)?(wn=0,Cr=null,q1(r)):(wn=0,Cr=null,Cl(n,r,m,7));break;case 5:var x=null;switch(qt.tag){case 26:x=qt.memoizedState;case 5:case 27:var E=qt;if(x?Nb(x):E.stateNode.complete){wn=0,Cr=null;var z=E.sibling;if(z!==null)qt=z;else{var ie=E.return;ie!==null?(qt=ie,zd(ie)):qt=null}break t}}wn=0,Cr=null,Cl(n,r,m,5);break;case 6:wn=0,Cr=null,Cl(n,r,m,6);break;case 8:Xm(),ns=6;break e;default:throw Error(i(462))}}OE();break}catch(ye){U1(n,ye)}while(!0);return Bi=xo=null,J.H=c,J.A=f,mn=o,qt!==null?0:(An=null,Kt=0,ad(),ns)}function OE(){for(;qt!==null&&!gt();)H1(qt)}function H1(n){var r=f1(n.alternate,n,Qi);n.memoizedProps=n.pendingProps,r===null?zd(n):qt=r}function q1(n){var r=n,o=r.alternate;switch(r.tag){case 15:case 0:r=o1(o,r,r.pendingProps,r.type,void 0,Kt);break;case 11:r=o1(o,r,r.pendingProps,r.type.render,r.ref,Kt);break;case 5:fm(r);default:g1(o,r),r=qt=F0(r,Qi),r=f1(o,r,Qi)}n.memoizedProps=n.pendingProps,r===null?zd(n):qt=r}function Cl(n,r,o,c){Bi=xo=null,fm(r),yl=null,wc=0;var f=r.return;try{if(jE(n,f,r,o,Kt)){ns=1,Cd(n,Vr(o,n.current)),qt=null;return}}catch(m){if(f!==null)throw qt=f,m;ns=1,Cd(n,Vr(o,n.current)),qt=null;return}r.flags&32768?(nn||c===1?n=!0:jl||(Kt&536870912)!==0?n=!1:(Ia=n=!0,(c===2||c===9||c===3||c===6)&&(c=Tr.current,c!==null&&c.tag===13&&(c.flags|=16384))),$1(r,n)):zd(r)}function zd(n){var r=n;do{if((r.flags&32768)!==0){$1(r,Ia);return}n=r.return;var o=SE(r.alternate,r,Qi);if(o!==null){qt=o;return}if(r=r.sibling,r!==null){qt=r;return}qt=r=n}while(r!==null);ns===0&&(ns=5)}function $1(n,r){do{var o=CE(n.alternate,n);if(o!==null){o.flags&=32767,qt=o;return}if(o=n.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!r&&(n=n.sibling,n!==null)){qt=n;return}qt=n=o}while(n!==null);ns=6,qt=null}function W1(n,r,o,c,f,m,x,E,z){n.cancelPendingCommit=null;do Fd();while(Ss!==0);if((mn&6)!==0)throw Error(i(327));if(r!==null){if(r===n.current)throw Error(i(177));if(m=r.lanes|r.childLanes,m|=Bf,Xe(n,o,m,x,E,z),n===An&&(qt=An=null,Kt=0),Tl=r,La=n,Xi=o,Km=m,Ym=f,L1=c,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,BE(un,function(){return X1(),null})):(n.callbackNode=null,n.callbackPriority=0),c=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||c){c=J.T,J.T=null,f=Te.p,Te.p=2,x=mn,mn|=4;try{NE(n,r,o)}finally{mn=x,Te.p=f,J.T=c}}Ss=1,G1(),K1(),Y1()}}function G1(){if(Ss===1){Ss=0;var n=La,r=Tl,o=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||o){o=J.T,J.T=null;var c=Te.p;Te.p=2;var f=mn;mn|=4;try{S1(r,n);var m=ug,x=M0(n.containerInfo),E=m.focusedElem,z=m.selectionRange;if(x!==E&&E&&E.ownerDocument&&I0(E.ownerDocument.documentElement,E)){if(z!==null&&Lf(E)){var ie=z.start,ye=z.end;if(ye===void 0&&(ye=ie),"selectionStart"in E)E.selectionStart=ie,E.selectionEnd=Math.min(ye,E.value.length);else{var _e=E.ownerDocument||document,ce=_e&&_e.defaultView||window;if(ce.getSelection){var fe=ce.getSelection(),et=E.textContent.length,vt=Math.min(z.start,et),Tn=z.end===void 0?vt:Math.min(z.end,et);!fe.extend&&vt>Tn&&(x=Tn,Tn=vt,vt=x);var X=R0(E,vt),W=R0(E,Tn);if(X&&W&&(fe.rangeCount!==1||fe.anchorNode!==X.node||fe.anchorOffset!==X.offset||fe.focusNode!==W.node||fe.focusOffset!==W.offset)){var re=_e.createRange();re.setStart(X.node,X.offset),fe.removeAllRanges(),vt>Tn?(fe.addRange(re),fe.extend(W.node,W.offset)):(re.setEnd(W.node,W.offset),fe.addRange(re))}}}}for(_e=[],fe=E;fe=fe.parentNode;)fe.nodeType===1&&_e.push({element:fe,left:fe.scrollLeft,top:fe.scrollTop});for(typeof E.focus=="function"&&E.focus(),E=0;E<_e.length;E++){var we=_e[E];we.element.scrollLeft=we.left,we.element.scrollTop=we.top}}eh=!!cg,ug=cg=null}finally{mn=f,Te.p=c,J.T=o}}n.current=r,Ss=2}}function K1(){if(Ss===2){Ss=0;var n=La,r=Tl,o=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||o){o=J.T,J.T=null;var c=Te.p;Te.p=2;var f=mn;mn|=4;try{_1(n,r.alternate,r)}finally{mn=f,Te.p=c,J.T=o}}Ss=3}}function Y1(){if(Ss===4||Ss===3){Ss=0,Qe();var n=La,r=Tl,o=Xi,c=L1;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Ss=5:(Ss=0,Tl=La=null,Q1(n,n.pendingLanes));var f=n.pendingLanes;if(f===0&&(Da=null),Ht(o),r=r.stateNode,zt&&typeof zt.onCommitFiberRoot=="function")try{zt.onCommitFiberRoot(tn,r,void 0,(r.current.flags&128)===128)}catch{}if(c!==null){r=J.T,f=Te.p,Te.p=2,J.T=null;try{for(var m=n.onRecoverableError,x=0;x<c.length;x++){var E=c[x];m(E.value,{componentStack:E.stack})}}finally{J.T=r,Te.p=f}}(Xi&3)!==0&&Fd(),_i(n),f=n.pendingLanes,(o&261930)!==0&&(f&42)!==0?n===Qm?Pc++:(Pc=0,Qm=n):Pc=0,Vc(0)}}function Q1(n,r){(n.pooledCacheLanes&=r)===0&&(r=n.pooledCache,r!=null&&(n.pooledCache=null,vc(r)))}function Fd(){return G1(),K1(),Y1(),X1()}function X1(){if(Ss!==5)return!1;var n=La,r=Km;Km=0;var o=Ht(Xi),c=J.T,f=Te.p;try{Te.p=32>o?32:o,J.T=null,o=Ym,Ym=null;var m=La,x=Xi;if(Ss=0,Tl=La=null,Xi=0,(mn&6)!==0)throw Error(i(331));var E=mn;if(mn|=4,I1(m.current),N1(m,m.current,x,o),mn=E,Vc(0,!1),zt&&typeof zt.onPostCommitFiberRoot=="function")try{zt.onPostCommitFiberRoot(tn,m)}catch{}return!0}finally{Te.p=f,J.T=c,Q1(n,r)}}function J1(n,r,o){r=Vr(o,r),r=Cm(n.stateNode,r,2),n=Ca(n,r,2),n!==null&&(Ae(n,2),_i(n))}function xn(n,r,o){if(n.tag===3)J1(n,n,o);else for(;r!==null;){if(r.tag===3){J1(r,n,o);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Da===null||!Da.has(c))){n=Vr(o,n),o=Zv(2),c=Ca(r,o,2),c!==null&&(e1(o,c,r,n),Ae(c,2),_i(c));break}}r=r.return}}function Zm(n,r,o){var c=n.pingCache;if(c===null){c=n.pingCache=new IE;var f=new Set;c.set(r,f)}else f=c.get(r),f===void 0&&(f=new Set,c.set(r,f));f.has(o)||($m=!0,f.add(o),n=PE.bind(null,n,r,o),r.then(n,n))}function PE(n,r,o){var c=n.pingCache;c!==null&&c.delete(r),n.pingedLanes|=n.suspendedLanes&o,n.warmLanes&=~o,An===n&&(Kt&o)===o&&(ns===4||ns===3&&(Kt&62914560)===Kt&&300>ut()-Od?(mn&2)===0&&Sl(n,0):Wm|=o,El===Kt&&(El=0)),_i(n)}function Z1(n,r){r===0&&(r=at()),n=vo(n,r),n!==null&&(Ae(n,r),_i(n))}function VE(n){var r=n.memoizedState,o=0;r!==null&&(o=r.retryLane),Z1(n,o)}function UE(n,r){var o=0;switch(n.tag){case 31:case 13:var c=n.stateNode,f=n.memoizedState;f!==null&&(o=f.retryLane);break;case 19:c=n.stateNode;break;case 22:c=n.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(r),Z1(n,o)}function BE(n,r){return kt(n,r)}var Hd=null,Nl=null,eg=!1,qd=!1,tg=!1,Pa=0;function _i(n){n!==Nl&&n.next===null&&(Nl===null?Hd=Nl=n:Nl=Nl.next=n),qd=!0,eg||(eg=!0,FE())}function Vc(n,r){if(!tg&&qd){tg=!0;do for(var o=!1,c=Hd;c!==null;){if(n!==0){var f=c.pendingLanes;if(f===0)var m=0;else{var x=c.suspendedLanes,E=c.pingedLanes;m=(1<<31-At(42|n)+1)-1,m&=f&~(x&~E),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(o=!0,sb(c,m))}else m=Kt,m=Pe(c,c===An?m:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(m&3)===0||Dt(c,m)||(o=!0,sb(c,m));c=c.next}while(o);tg=!1}}function zE(){eb()}function eb(){qd=eg=!1;var n=0;Pa!==0&&JE()&&(n=Pa);for(var r=ut(),o=null,c=Hd;c!==null;){var f=c.next,m=tb(c,r);m===0?(c.next=null,o===null?Hd=f:o.next=f,f===null&&(Nl=o)):(o=c,(n!==0||(m&3)!==0)&&(qd=!0)),c=f}Ss!==0&&Ss!==5||Vc(n),Pa!==0&&(Pa=0)}function tb(n,r){for(var o=n.suspendedLanes,c=n.pingedLanes,f=n.expirationTimes,m=n.pendingLanes&-62914561;0<m;){var x=31-At(m),E=1<<x,z=f[x];z===-1?((E&o)===0||(E&c)!==0)&&(f[x]=yt(E,r)):z<=r&&(n.expiredLanes|=E),m&=~E}if(r=An,o=Kt,o=Pe(n,n===r?o:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c=n.callbackNode,o===0||n===r&&(wn===2||wn===9)||n.cancelPendingCommit!==null)return c!==null&&c!==null&&jt(c),n.callbackNode=null,n.callbackPriority=0;if((o&3)===0||Dt(n,o)){if(r=o&-o,r===n.callbackPriority)return r;switch(c!==null&&jt(c),Ht(o)){case 2:case 8:o=Gn;break;case 32:o=un;break;case 268435456:o=Fn;break;default:o=un}return c=nb.bind(null,n),o=kt(o,c),n.callbackPriority=r,n.callbackNode=o,r}return c!==null&&c!==null&&jt(c),n.callbackPriority=2,n.callbackNode=null,2}function nb(n,r){if(Ss!==0&&Ss!==5)return n.callbackNode=null,n.callbackPriority=0,null;var o=n.callbackNode;if(Fd()&&n.callbackNode!==o)return null;var c=Kt;return c=Pe(n,n===An?c:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c===0?null:(P1(n,c,r),tb(n,ut()),n.callbackNode!=null&&n.callbackNode===o?nb.bind(null,n):null)}function sb(n,r){if(Fd())return null;P1(n,r,!0)}function FE(){eT(function(){(mn&6)!==0?kt(en,zE):eb()})}function ng(){if(Pa===0){var n=ml;n===0&&(n=Re,Re<<=1,(Re&261888)===0&&(Re=256)),Pa=n}return Pa}function rb(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:pi(""+n)}function ib(n,r){var o=r.ownerDocument.createElement("input");return o.name=r.name,o.value=r.value,n.id&&o.setAttribute("form",n.id),r.parentNode.insertBefore(o,r),n=new FormData(n),o.parentNode.removeChild(o),n}function HE(n,r,o,c,f){if(r==="submit"&&o&&o.stateNode===f){var m=rb((f[an]||null).action),x=c.submitter;x&&(r=(r=x[an]||null)?rb(r.formAction):x.getAttribute("formAction"),r!==null&&(m=r,x=null));var E=new Pn("action","action",null,c,f);n.push({event:E,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Pa!==0){var z=x?ib(f,x):new FormData(f);_m(o,{pending:!0,data:z,method:f.method,action:m},null,z)}}else typeof m=="function"&&(E.preventDefault(),z=x?ib(f,x):new FormData(f),_m(o,{pending:!0,data:z,method:f.method,action:m},m,z))},currentTarget:f}]})}}for(var sg=0;sg<Uf.length;sg++){var rg=Uf[sg],qE=rg.toLowerCase(),$E=rg[0].toUpperCase()+rg.slice(1);ri(qE,"on"+$E)}ri(O0,"onAnimationEnd"),ri(P0,"onAnimationIteration"),ri(V0,"onAnimationStart"),ri("dblclick","onDoubleClick"),ri("focusin","onFocus"),ri("focusout","onBlur"),ri(oE,"onTransitionRun"),ri(lE,"onTransitionStart"),ri(cE,"onTransitionCancel"),ri(U0,"onTransitionEnd"),Zn("onMouseEnter",["mouseout","mouseover"]),Zn("onMouseLeave",["mouseout","mouseover"]),Zn("onPointerEnter",["pointerout","pointerover"]),Zn("onPointerLeave",["pointerout","pointerover"]),Ds("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ds("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ds("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ds("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ds("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ds("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Uc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),WE=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Uc));function ab(n,r){r=(r&4)!==0;for(var o=0;o<n.length;o++){var c=n[o],f=c.event;c=c.listeners;e:{var m=void 0;if(r)for(var x=c.length-1;0<=x;x--){var E=c[x],z=E.instance,ie=E.currentTarget;if(E=E.listener,z!==m&&f.isPropagationStopped())break e;m=E,f.currentTarget=ie;try{m(f)}catch(ye){id(ye)}f.currentTarget=null,m=z}else for(x=0;x<c.length;x++){if(E=c[x],z=E.instance,ie=E.currentTarget,E=E.listener,z!==m&&f.isPropagationStopped())break e;m=E,f.currentTarget=ie;try{m(f)}catch(ye){id(ye)}f.currentTarget=null,m=z}}}}function $t(n,r){var o=r[br];o===void 0&&(o=r[br]=new Set);var c=n+"__bubble";o.has(c)||(ob(r,n,2,!1),o.add(c))}function ig(n,r,o){var c=0;r&&(c|=4),ob(o,n,c,r)}var $d="_reactListening"+Math.random().toString(36).slice(2);function ag(n){if(!n[$d]){n[$d]=!0,Jn.forEach(function(o){o!=="selectionchange"&&(WE.has(o)||ig(o,!1,n),ig(o,!0,n))});var r=n.nodeType===9?n:n.ownerDocument;r===null||r[$d]||(r[$d]=!0,ig("selectionchange",!1,r))}}function ob(n,r,o,c){switch(Ob(r)){case 2:var f=wT;break;case 8:f=xT;break;default:f=xg}o=f.bind(null,r,o,n),f=void 0,!Ve||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(f=!0),c?f!==void 0?n.addEventListener(r,o,{capture:!0,passive:f}):n.addEventListener(r,o,!0):f!==void 0?n.addEventListener(r,o,{passive:f}):n.addEventListener(r,o,!1)}function og(n,r,o,c,f){var m=c;if((r&1)===0&&(r&2)===0&&c!==null)e:for(;;){if(c===null)return;var x=c.tag;if(x===3||x===4){var E=c.stateNode.containerInfo;if(E===f)break;if(x===4)for(x=c.return;x!==null;){var z=x.tag;if((z===3||z===4)&&x.stateNode.containerInfo===f)return;x=x.return}for(;E!==null;){if(x=Ts(E),x===null)return;if(z=x.tag,z===5||z===6||z===26||z===27){c=m=x;continue e}E=E.parentNode}}c=c.return}de(function(){var ie=m,ye=F(o),_e=[];e:{var ce=B0.get(n);if(ce!==void 0){var fe=Pn,et=n;switch(n){case"keypress":if(dn(o)===0)break e;case"keydown":case"keyup":fe=nd;break;case"focusin":et="focus",fe=mo;break;case"focusout":et="blur",fe=mo;break;case"beforeblur":case"afterblur":fe=mo;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":fe=Oi;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":fe=Gu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":fe=v;break;case O0:case P0:case V0:fe=Yu;break;case U0:fe=A;break;case"scroll":case"scrollend":fe=Vn;break;case"wheel":fe=he;break;case"copy":case"cut":case"paste":fe=Qu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":fe=Pi;break;case"toggle":case"beforetoggle":fe=Rt}var vt=(r&4)!==0,Tn=!vt&&(n==="scroll"||n==="scrollend"),X=vt?ce!==null?ce+"Capture":null:ce;vt=[];for(var W=ie,re;W!==null;){var we=W;if(re=we.stateNode,we=we.tag,we!==5&&we!==26&&we!==27||re===null||X===null||(we=ke(W,X),we!=null&&vt.push(Bc(W,we,re))),Tn)break;W=W.return}0<vt.length&&(ce=new fe(ce,et,null,o,ye),_e.push({event:ce,listeners:vt}))}}if((r&7)===0){e:{if(ce=n==="mouseover"||n==="pointerover",fe=n==="mouseout"||n==="pointerout",ce&&o!==er&&(et=o.relatedTarget||o.fromElement)&&(Ts(et)||et[as]))break e;if((fe||ce)&&(ce=ye.window===ye?ye:(ce=ye.ownerDocument)?ce.defaultView||ce.parentWindow:window,fe?(et=o.relatedTarget||o.toElement,fe=ie,et=et?Ts(et):null,et!==null&&(Tn=u(et),vt=et.tag,et!==Tn||vt!==5&&vt!==27&&vt!==6)&&(et=null)):(fe=null,et=ie),fe!==et)){if(vt=Oi,we="onMouseLeave",X="onMouseEnter",W="mouse",(n==="pointerout"||n==="pointerover")&&(vt=Pi,we="onPointerLeave",X="onPointerEnter",W="pointer"),Tn=fe==null?ce:In(fe),re=et==null?ce:In(et),ce=new vt(we,W+"leave",fe,o,ye),ce.target=Tn,ce.relatedTarget=re,we=null,Ts(ye)===ie&&(vt=new vt(X,W+"enter",et,o,ye),vt.target=re,vt.relatedTarget=Tn,we=vt),Tn=we,fe&&et)t:{for(vt=GE,X=fe,W=et,re=0,we=X;we;we=vt(we))re++;we=0;for(var dt=W;dt;dt=vt(dt))we++;for(;0<re-we;)X=vt(X),re--;for(;0<we-re;)W=vt(W),we--;for(;re--;){if(X===W||W!==null&&X===W.alternate){vt=X;break t}X=vt(X),W=vt(W)}vt=null}else vt=null;fe!==null&&lb(_e,ce,fe,vt,!1),et!==null&&Tn!==null&&lb(_e,Tn,et,vt,!0)}}e:{if(ce=ie?In(ie):window,fe=ce.nodeName&&ce.nodeName.toLowerCase(),fe==="select"||fe==="input"&&ce.type==="file")var ln=E0;else if(k0(ce))if(T0)ln=rE;else{ln=nE;var nt=tE}else fe=ce.nodeName,!fe||fe.toLowerCase()!=="input"||ce.type!=="checkbox"&&ce.type!=="radio"?ie&&ti(ie.elementType)&&(ln=E0):ln=sE;if(ln&&(ln=ln(n,ie))){j0(_e,ln,o,ye);break e}nt&&nt(n,ce,ie),n==="focusout"&&ie&&ce.type==="number"&&ie.memoizedProps.value!=null&&Ls(ce,"number",ce.value)}switch(nt=ie?In(ie):window,n){case"focusin":(k0(nt)||nt.contentEditable==="true")&&(al=nt,Of=ie,gc=null);break;case"focusout":gc=Of=al=null;break;case"mousedown":Pf=!0;break;case"contextmenu":case"mouseup":case"dragend":Pf=!1,D0(_e,o,ye);break;case"selectionchange":if(aE)break;case"keydown":case"keyup":D0(_e,o,ye)}var Ot;if(fn)e:{switch(n){case"compositionstart":var Yt="onCompositionStart";break e;case"compositionend":Yt="onCompositionEnd";break e;case"compositionupdate":Yt="onCompositionUpdate";break e}Yt=void 0}else il?go(n,o)&&(Yt="onCompositionEnd"):n==="keydown"&&o.keyCode===229&&(Yt="onCompositionStart");Yt&&(vi&&o.locale!=="ko"&&(il||Yt!=="onCompositionStart"?Yt==="onCompositionEnd"&&il&&(Ot=ft()):(Ze=ye,Ut="value"in Ze?Ze.value:Ze.textContent,il=!0)),nt=Wd(ie,Yt),0<nt.length&&(Yt=new yi(Yt,n,null,o,ye),_e.push({event:Yt,listeners:nt}),Ot?Yt.data=Ot:(Ot=rl(o),Ot!==null&&(Yt.data=Ot)))),(Ot=Or?Xj(n,o):Jj(n,o))&&(Yt=Wd(ie,"onBeforeInput"),0<Yt.length&&(nt=new yi("onBeforeInput","beforeinput",null,o,ye),_e.push({event:nt,listeners:Yt}),nt.data=Ot)),HE(_e,n,ie,o,ye)}ab(_e,r)})}function Bc(n,r,o){return{instance:n,listener:r,currentTarget:o}}function Wd(n,r){for(var o=r+"Capture",c=[];n!==null;){var f=n,m=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||m===null||(f=ke(n,o),f!=null&&c.unshift(Bc(n,f,m)),f=ke(n,r),f!=null&&c.push(Bc(n,f,m))),n.tag===3)return c;n=n.return}return[]}function GE(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function lb(n,r,o,c,f){for(var m=r._reactName,x=[];o!==null&&o!==c;){var E=o,z=E.alternate,ie=E.stateNode;if(E=E.tag,z!==null&&z===c)break;E!==5&&E!==26&&E!==27||ie===null||(z=ie,f?(ie=ke(o,m),ie!=null&&x.unshift(Bc(o,ie,z))):f||(ie=ke(o,m),ie!=null&&x.push(Bc(o,ie,z)))),o=o.return}x.length!==0&&n.push({event:r,listeners:x})}var KE=/\r\n?/g,YE=/\u0000|\uFFFD/g;function cb(n){return(typeof n=="string"?n:""+n).replace(KE,`
`).replace(YE,"")}function ub(n,r){return r=cb(r),cb(n)===r}function En(n,r,o,c,f,m){switch(o){case"children":typeof c=="string"?r==="body"||r==="textarea"&&c===""||Rs(n,c):(typeof c=="number"||typeof c=="bigint")&&r!=="body"&&Rs(n,""+c);break;case"className":se(n,"class",c);break;case"tabIndex":se(n,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":se(n,o,c);break;case"style":xr(n,c,m);break;case"data":if(r!=="object"){se(n,"data",c);break}case"src":case"href":if(c===""&&(r!=="a"||o!=="href")){n.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(o);break}c=pi(""+c),n.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){n.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(o==="formAction"?(r!=="input"&&En(n,r,"name",f.name,f,null),En(n,r,"formEncType",f.formEncType,f,null),En(n,r,"formMethod",f.formMethod,f,null),En(n,r,"formTarget",f.formTarget,f,null)):(En(n,r,"encType",f.encType,f,null),En(n,r,"method",f.method,f,null),En(n,r,"target",f.target,f,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(o);break}c=pi(""+c),n.setAttribute(o,c);break;case"onClick":c!=null&&(n.onclick=Zs);break;case"onScroll":c!=null&&$t("scroll",n);break;case"onScrollEnd":c!=null&&$t("scrollend",n);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"multiple":n.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":n.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){n.removeAttribute("xlink:href");break}o=pi(""+c),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,""+c):n.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,""):n.removeAttribute(o);break;case"capture":case"download":c===!0?n.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,c):n.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?n.setAttribute(o,c):n.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?n.removeAttribute(o):n.setAttribute(o,c);break;case"popover":$t("beforetoggle",n),$t("toggle",n),q(n,"popover",c);break;case"xlinkActuate":te(n,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":te(n,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":te(n,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":te(n,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":te(n,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":te(n,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":te(n,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":te(n,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":te(n,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":q(n,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Hs.get(o)||o,q(n,o,c))}}function lg(n,r,o,c,f,m){switch(o){case"style":xr(n,c,m);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"children":typeof c=="string"?Rs(n,c):(typeof c=="number"||typeof c=="bigint")&&Rs(n,""+c);break;case"onScroll":c!=null&&$t("scroll",n);break;case"onScrollEnd":c!=null&&$t("scrollend",n);break;case"onClick":c!=null&&(n.onclick=Zs);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Jr.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(f=o.endsWith("Capture"),r=o.slice(2,f?o.length-7:void 0),m=n[an]||null,m=m!=null?m[o]:null,typeof m=="function"&&n.removeEventListener(r,m,f),typeof c=="function")){typeof m!="function"&&m!==null&&(o in n?n[o]=null:n.hasAttribute(o)&&n.removeAttribute(o)),n.addEventListener(r,c,f);break e}o in n?n[o]=c:c===!0?n.setAttribute(o,""):q(n,o,c)}}}function Us(n,r,o){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":$t("error",n),$t("load",n);var c=!1,f=!1,m;for(m in o)if(o.hasOwnProperty(m)){var x=o[m];if(x!=null)switch(m){case"src":c=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:En(n,r,m,x,o,null)}}f&&En(n,r,"srcSet",o.srcSet,o,null),c&&En(n,r,"src",o.src,o,null);return;case"input":$t("invalid",n);var E=m=x=f=null,z=null,ie=null;for(c in o)if(o.hasOwnProperty(c)){var ye=o[c];if(ye!=null)switch(c){case"name":f=ye;break;case"type":x=ye;break;case"checked":z=ye;break;case"defaultChecked":ie=ye;break;case"value":m=ye;break;case"defaultValue":E=ye;break;case"children":case"dangerouslySetInnerHTML":if(ye!=null)throw Error(i(137,r));break;default:En(n,r,c,ye,o,null)}}ei(n,m,E,z,ie,x,f,!1);return;case"select":$t("invalid",n),c=x=m=null;for(f in o)if(o.hasOwnProperty(f)&&(E=o[f],E!=null))switch(f){case"value":m=E;break;case"defaultValue":x=E;break;case"multiple":c=E;default:En(n,r,f,E,o,null)}r=m,o=x,n.multiple=!!c,r!=null?Js(n,!!c,r,!1):o!=null&&Js(n,!!c,o,!0);return;case"textarea":$t("invalid",n),m=f=c=null;for(x in o)if(o.hasOwnProperty(x)&&(E=o[x],E!=null))switch(x){case"value":c=E;break;case"defaultValue":f=E;break;case"children":m=E;break;case"dangerouslySetInnerHTML":if(E!=null)throw Error(i(91));break;default:En(n,r,x,E,o,null)}wr(n,c,f,m);return;case"option":for(z in o)o.hasOwnProperty(z)&&(c=o[z],c!=null)&&(z==="selected"?n.selected=c&&typeof c!="function"&&typeof c!="symbol":En(n,r,z,c,o,null));return;case"dialog":$t("beforetoggle",n),$t("toggle",n),$t("cancel",n),$t("close",n);break;case"iframe":case"object":$t("load",n);break;case"video":case"audio":for(c=0;c<Uc.length;c++)$t(Uc[c],n);break;case"image":$t("error",n),$t("load",n);break;case"details":$t("toggle",n);break;case"embed":case"source":case"link":$t("error",n),$t("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ie in o)if(o.hasOwnProperty(ie)&&(c=o[ie],c!=null))switch(ie){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:En(n,r,ie,c,o,null)}return;default:if(ti(r)){for(ye in o)o.hasOwnProperty(ye)&&(c=o[ye],c!==void 0&&lg(n,r,ye,c,o,void 0));return}}for(E in o)o.hasOwnProperty(E)&&(c=o[E],c!=null&&En(n,r,E,c,o,null))}function QE(n,r,o,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,m=null,x=null,E=null,z=null,ie=null,ye=null;for(fe in o){var _e=o[fe];if(o.hasOwnProperty(fe)&&_e!=null)switch(fe){case"checked":break;case"value":break;case"defaultValue":z=_e;default:c.hasOwnProperty(fe)||En(n,r,fe,null,c,_e)}}for(var ce in c){var fe=c[ce];if(_e=o[ce],c.hasOwnProperty(ce)&&(fe!=null||_e!=null))switch(ce){case"type":m=fe;break;case"name":f=fe;break;case"checked":ie=fe;break;case"defaultChecked":ye=fe;break;case"value":x=fe;break;case"defaultValue":E=fe;break;case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(i(137,r));break;default:fe!==_e&&En(n,r,ce,fe,c,_e)}}As(n,x,E,z,ie,ye,m,f);return;case"select":fe=x=E=ce=null;for(m in o)if(z=o[m],o.hasOwnProperty(m)&&z!=null)switch(m){case"value":break;case"multiple":fe=z;default:c.hasOwnProperty(m)||En(n,r,m,null,c,z)}for(f in c)if(m=c[f],z=o[f],c.hasOwnProperty(f)&&(m!=null||z!=null))switch(f){case"value":ce=m;break;case"defaultValue":E=m;break;case"multiple":x=m;default:m!==z&&En(n,r,f,m,c,z)}r=E,o=x,c=fe,ce!=null?Js(n,!!o,ce,!1):!!c!=!!o&&(r!=null?Js(n,!!o,r,!0):Js(n,!!o,o?[]:"",!1));return;case"textarea":fe=ce=null;for(E in o)if(f=o[E],o.hasOwnProperty(E)&&f!=null&&!c.hasOwnProperty(E))switch(E){case"value":break;case"children":break;default:En(n,r,E,null,c,f)}for(x in c)if(f=c[x],m=o[x],c.hasOwnProperty(x)&&(f!=null||m!=null))switch(x){case"value":ce=f;break;case"defaultValue":fe=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(i(91));break;default:f!==m&&En(n,r,x,f,c,m)}va(n,ce,fe);return;case"option":for(var et in o)ce=o[et],o.hasOwnProperty(et)&&ce!=null&&!c.hasOwnProperty(et)&&(et==="selected"?n.selected=!1:En(n,r,et,null,c,ce));for(z in c)ce=c[z],fe=o[z],c.hasOwnProperty(z)&&ce!==fe&&(ce!=null||fe!=null)&&(z==="selected"?n.selected=ce&&typeof ce!="function"&&typeof ce!="symbol":En(n,r,z,ce,c,fe));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var vt in o)ce=o[vt],o.hasOwnProperty(vt)&&ce!=null&&!c.hasOwnProperty(vt)&&En(n,r,vt,null,c,ce);for(ie in c)if(ce=c[ie],fe=o[ie],c.hasOwnProperty(ie)&&ce!==fe&&(ce!=null||fe!=null))switch(ie){case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(i(137,r));break;default:En(n,r,ie,ce,c,fe)}return;default:if(ti(r)){for(var Tn in o)ce=o[Tn],o.hasOwnProperty(Tn)&&ce!==void 0&&!c.hasOwnProperty(Tn)&&lg(n,r,Tn,void 0,c,ce);for(ye in c)ce=c[ye],fe=o[ye],!c.hasOwnProperty(ye)||ce===fe||ce===void 0&&fe===void 0||lg(n,r,ye,ce,c,fe);return}}for(var X in o)ce=o[X],o.hasOwnProperty(X)&&ce!=null&&!c.hasOwnProperty(X)&&En(n,r,X,null,c,ce);for(_e in c)ce=c[_e],fe=o[_e],!c.hasOwnProperty(_e)||ce===fe||ce==null&&fe==null||En(n,r,_e,ce,c,fe)}function db(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function XE(){if(typeof performance.getEntriesByType=="function"){for(var n=0,r=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var f=o[c],m=f.transferSize,x=f.initiatorType,E=f.duration;if(m&&E&&db(x)){for(x=0,E=f.responseEnd,c+=1;c<o.length;c++){var z=o[c],ie=z.startTime;if(ie>E)break;var ye=z.transferSize,_e=z.initiatorType;ye&&db(_e)&&(z=z.responseEnd,x+=ye*(z<E?1:(E-ie)/(z-ie)))}if(--c,r+=8*(m+x)/(f.duration/1e3),n++,10<n)break}}if(0<n)return r/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var cg=null,ug=null;function Gd(n){return n.nodeType===9?n:n.ownerDocument}function hb(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function fb(n,r){if(n===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&r==="foreignObject"?0:n}function dg(n,r){return n==="textarea"||n==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var hg=null;function JE(){var n=window.event;return n&&n.type==="popstate"?n===hg?!1:(hg=n,!0):(hg=null,!1)}var mb=typeof setTimeout=="function"?setTimeout:void 0,ZE=typeof clearTimeout=="function"?clearTimeout:void 0,gb=typeof Promise=="function"?Promise:void 0,eT=typeof queueMicrotask=="function"?queueMicrotask:typeof gb<"u"?function(n){return gb.resolve(null).then(n).catch(tT)}:mb;function tT(n){setTimeout(function(){throw n})}function Va(n){return n==="head"}function pb(n,r){var o=r,c=0;do{var f=o.nextSibling;if(n.removeChild(o),f&&f.nodeType===8)if(o=f.data,o==="/$"||o==="/&"){if(c===0){n.removeChild(f),Ml(r);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")zc(n.ownerDocument.documentElement);else if(o==="head"){o=n.ownerDocument.head,zc(o);for(var m=o.firstChild;m;){var x=m.nextSibling,E=m.nodeName;m[js]||E==="SCRIPT"||E==="STYLE"||E==="LINK"&&m.rel.toLowerCase()==="stylesheet"||o.removeChild(m),m=x}}else o==="body"&&zc(n.ownerDocument.body);o=f}while(o);Ml(r)}function yb(n,r){var o=n;n=0;do{var c=o.nextSibling;if(o.nodeType===1?r?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(r?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(n===0)break;n--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||n++;o=c}while(o)}function fg(n){var r=n.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var o=r;switch(r=r.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":fg(o),Es(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}n.removeChild(o)}}function nT(n,r,o,c){for(;n.nodeType===1;){var f=o;if(n.nodeName.toLowerCase()!==r.toLowerCase()){if(!c&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(c){if(!n[js])switch(r){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(m=n.getAttribute("rel"),m==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(m!==f.rel||n.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||n.getAttribute("title")!==(f.title==null?null:f.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(m=n.getAttribute("src"),(m!==(f.src==null?null:f.src)||n.getAttribute("type")!==(f.type==null?null:f.type)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&m&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(r==="input"&&n.type==="hidden"){var m=f.name==null?null:""+f.name;if(f.type==="hidden"&&n.getAttribute("name")===m)return n}else return n;if(n=Hr(n.nextSibling),n===null)break}return null}function sT(n,r,o){if(r==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!o||(n=Hr(n.nextSibling),n===null))return null;return n}function vb(n,r){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!r||(n=Hr(n.nextSibling),n===null))return null;return n}function mg(n){return n.data==="$?"||n.data==="$~"}function gg(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function rT(n,r){var o=n.ownerDocument;if(n.data==="$~")n._reactRetry=r;else if(n.data!=="$?"||o.readyState!=="loading")r();else{var c=function(){r(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),n._reactRetry=c}}function Hr(n){for(;n!=null;n=n.nextSibling){var r=n.nodeType;if(r===1||r===3)break;if(r===8){if(r=n.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return n}var pg=null;function bb(n){n=n.nextSibling;for(var r=0;n;){if(n.nodeType===8){var o=n.data;if(o==="/$"||o==="/&"){if(r===0)return Hr(n.nextSibling);r--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||r++}n=n.nextSibling}return null}function wb(n){n=n.previousSibling;for(var r=0;n;){if(n.nodeType===8){var o=n.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(r===0)return n;r--}else o!=="/$"&&o!=="/&"||r++}n=n.previousSibling}return null}function xb(n,r,o){switch(r=Gd(o),n){case"html":if(n=r.documentElement,!n)throw Error(i(452));return n;case"head":if(n=r.head,!n)throw Error(i(453));return n;case"body":if(n=r.body,!n)throw Error(i(454));return n;default:throw Error(i(451))}}function zc(n){for(var r=n.attributes;r.length;)n.removeAttributeNode(r[0]);Es(n)}var qr=new Map,_b=new Set;function Kd(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var Ji=Te.d;Te.d={f:iT,r:aT,D:oT,C:lT,L:cT,m:uT,X:hT,S:dT,M:fT};function iT(){var n=Ji.f(),r=Ud();return n||r}function aT(n){var r=os(n);r!==null&&r.tag===5&&r.type==="form"?Uv(r):Ji.r(n)}var Al=typeof document>"u"?null:document;function kb(n,r,o){var c=Al;if(c&&typeof r=="string"&&r){var f=es(r);f='link[rel="'+n+'"][href="'+f+'"]',typeof o=="string"&&(f+='[crossorigin="'+o+'"]'),_b.has(f)||(_b.add(f),n={rel:n,crossOrigin:o,href:r},c.querySelector(f)===null&&(r=c.createElement("link"),Us(r,"link",n),pn(r),c.head.appendChild(r)))}}function oT(n){Ji.D(n),kb("dns-prefetch",n,null)}function lT(n,r){Ji.C(n,r),kb("preconnect",n,r)}function cT(n,r,o){Ji.L(n,r,o);var c=Al;if(c&&n&&r){var f='link[rel="preload"][as="'+es(r)+'"]';r==="image"&&o&&o.imageSrcSet?(f+='[imagesrcset="'+es(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(f+='[imagesizes="'+es(o.imageSizes)+'"]')):f+='[href="'+es(n)+'"]';var m=f;switch(r){case"style":m=Rl(n);break;case"script":m=Il(n)}qr.has(m)||(n=j({rel:"preload",href:r==="image"&&o&&o.imageSrcSet?void 0:n,as:r},o),qr.set(m,n),c.querySelector(f)!==null||r==="style"&&c.querySelector(Fc(m))||r==="script"&&c.querySelector(Hc(m))||(r=c.createElement("link"),Us(r,"link",n),pn(r),c.head.appendChild(r)))}}function uT(n,r){Ji.m(n,r);var o=Al;if(o&&n){var c=r&&typeof r.as=="string"?r.as:"script",f='link[rel="modulepreload"][as="'+es(c)+'"][href="'+es(n)+'"]',m=f;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=Il(n)}if(!qr.has(m)&&(n=j({rel:"modulepreload",href:n},r),qr.set(m,n),o.querySelector(f)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Hc(m)))return}c=o.createElement("link"),Us(c,"link",n),pn(c),o.head.appendChild(c)}}}function dT(n,r,o){Ji.S(n,r,o);var c=Al;if(c&&n){var f=Xn(c).hoistableStyles,m=Rl(n);r=r||"default";var x=f.get(m);if(!x){var E={loading:0,preload:null};if(x=c.querySelector(Fc(m)))E.loading=5;else{n=j({rel:"stylesheet",href:n,"data-precedence":r},o),(o=qr.get(m))&&yg(n,o);var z=x=c.createElement("link");pn(z),Us(z,"link",n),z._p=new Promise(function(ie,ye){z.onload=ie,z.onerror=ye}),z.addEventListener("load",function(){E.loading|=1}),z.addEventListener("error",function(){E.loading|=2}),E.loading|=4,Yd(x,r,c)}x={type:"stylesheet",instance:x,count:1,state:E},f.set(m,x)}}}function hT(n,r){Ji.X(n,r);var o=Al;if(o&&n){var c=Xn(o).hoistableScripts,f=Il(n),m=c.get(f);m||(m=o.querySelector(Hc(f)),m||(n=j({src:n,async:!0},r),(r=qr.get(f))&&vg(n,r),m=o.createElement("script"),pn(m),Us(m,"link",n),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function fT(n,r){Ji.M(n,r);var o=Al;if(o&&n){var c=Xn(o).hoistableScripts,f=Il(n),m=c.get(f);m||(m=o.querySelector(Hc(f)),m||(n=j({src:n,async:!0,type:"module"},r),(r=qr.get(f))&&vg(n,r),m=o.createElement("script"),pn(m),Us(m,"link",n),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function jb(n,r,o,c){var f=(f=Oe.current)?Kd(f):null;if(!f)throw Error(i(446));switch(n){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(r=Rl(o.href),o=Xn(f).hoistableStyles,c=o.get(r),c||(c={type:"style",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){n=Rl(o.href);var m=Xn(f).hoistableStyles,x=m.get(n);if(x||(f=f.ownerDocument||f,x={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(n,x),(m=f.querySelector(Fc(n)))&&!m._p&&(x.instance=m,x.state.loading=5),qr.has(n)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},qr.set(n,o),m||mT(f,n,o,x.state))),r&&c===null)throw Error(i(528,""));return x}if(r&&c!==null)throw Error(i(529,""));return null;case"script":return r=o.async,o=o.src,typeof o=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=Il(o),o=Xn(f).hoistableScripts,c=o.get(r),c||(c={type:"script",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,n))}}function Rl(n){return'href="'+es(n)+'"'}function Fc(n){return'link[rel="stylesheet"]['+n+"]"}function Eb(n){return j({},n,{"data-precedence":n.precedence,precedence:null})}function mT(n,r,o,c){n.querySelector('link[rel="preload"][as="style"]['+r+"]")?c.loading=1:(r=n.createElement("link"),c.preload=r,r.addEventListener("load",function(){return c.loading|=1}),r.addEventListener("error",function(){return c.loading|=2}),Us(r,"link",o),pn(r),n.head.appendChild(r))}function Il(n){return'[src="'+es(n)+'"]'}function Hc(n){return"script[async]"+n}function Tb(n,r,o){if(r.count++,r.instance===null)switch(r.type){case"style":var c=n.querySelector('style[data-href~="'+es(o.href)+'"]');if(c)return r.instance=c,pn(c),c;var f=j({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(n.ownerDocument||n).createElement("style"),pn(c),Us(c,"style",f),Yd(c,o.precedence,n),r.instance=c;case"stylesheet":f=Rl(o.href);var m=n.querySelector(Fc(f));if(m)return r.state.loading|=4,r.instance=m,pn(m),m;c=Eb(o),(f=qr.get(f))&&yg(c,f),m=(n.ownerDocument||n).createElement("link"),pn(m);var x=m;return x._p=new Promise(function(E,z){x.onload=E,x.onerror=z}),Us(m,"link",c),r.state.loading|=4,Yd(m,o.precedence,n),r.instance=m;case"script":return m=Il(o.src),(f=n.querySelector(Hc(m)))?(r.instance=f,pn(f),f):(c=o,(f=qr.get(m))&&(c=j({},o),vg(c,f)),n=n.ownerDocument||n,f=n.createElement("script"),pn(f),Us(f,"link",c),n.head.appendChild(f),r.instance=f);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(c=r.instance,r.state.loading|=4,Yd(c,o.precedence,n));return r.instance}function Yd(n,r,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=c.length?c[c.length-1]:null,m=f,x=0;x<c.length;x++){var E=c[x];if(E.dataset.precedence===r)m=E;else if(m!==f)break}m?m.parentNode.insertBefore(n,m.nextSibling):(r=o.nodeType===9?o.head:o,r.insertBefore(n,r.firstChild))}function yg(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.title==null&&(n.title=r.title)}function vg(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.integrity==null&&(n.integrity=r.integrity)}var Qd=null;function Sb(n,r,o){if(Qd===null){var c=new Map,f=Qd=new Map;f.set(o,c)}else f=Qd,c=f.get(o),c||(c=new Map,f.set(o,c));if(c.has(n))return c;for(c.set(n,null),o=o.getElementsByTagName(n),f=0;f<o.length;f++){var m=o[f];if(!(m[js]||m[Nn]||n==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var x=m.getAttribute(r)||"";x=n+x;var E=c.get(x);E?E.push(m):c.set(x,[m])}}return c}function Cb(n,r,o){n=n.ownerDocument||n,n.head.insertBefore(o,r==="title"?n.querySelector("head > title"):null)}function gT(n,r,o){if(o===1||r.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;return r.rel==="stylesheet"?(n=r.disabled,typeof r.precedence=="string"&&n==null):!0;case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function Nb(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function pT(n,r,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var f=Rl(c.href),m=r.querySelector(Fc(f));if(m){r=m._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(n.count++,n=Xd.bind(n),r.then(n,n)),o.state.loading|=4,o.instance=m,pn(m);return}m=r.ownerDocument||r,c=Eb(c),(f=qr.get(f))&&yg(c,f),m=m.createElement("link"),pn(m);var x=m;x._p=new Promise(function(E,z){x.onload=E,x.onerror=z}),Us(m,"link",c),o.instance=m}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(o,r),(r=o.state.preload)&&(o.state.loading&3)===0&&(n.count++,o=Xd.bind(n),r.addEventListener("load",o),r.addEventListener("error",o))}}var bg=0;function yT(n,r){return n.stylesheets&&n.count===0&&Zd(n,n.stylesheets),0<n.count||0<n.imgCount?function(o){var c=setTimeout(function(){if(n.stylesheets&&Zd(n,n.stylesheets),n.unsuspend){var m=n.unsuspend;n.unsuspend=null,m()}},6e4+r);0<n.imgBytes&&bg===0&&(bg=62500*XE());var f=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&Zd(n,n.stylesheets),n.unsuspend)){var m=n.unsuspend;n.unsuspend=null,m()}},(n.imgBytes>bg?50:800)+r);return n.unsuspend=o,function(){n.unsuspend=null,clearTimeout(c),clearTimeout(f)}}:null}function Xd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Zd(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Jd=null;function Zd(n,r){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Jd=new Map,r.forEach(vT,n),Jd=null,Xd.call(n))}function vT(n,r){if(!(r.state.loading&4)){var o=Jd.get(n);if(o)var c=o.get(null);else{o=new Map,Jd.set(n,o);for(var f=n.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<f.length;m++){var x=f[m];(x.nodeName==="LINK"||x.getAttribute("media")!=="not all")&&(o.set(x.dataset.precedence,x),c=x)}c&&o.set(null,c)}f=r.instance,x=f.getAttribute("data-precedence"),m=o.get(x)||c,m===c&&o.set(null,f),o.set(x,f),this.count++,c=Xd.bind(this),f.addEventListener("load",c),f.addEventListener("error",c),m?m.parentNode.insertBefore(f,m.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(f,n.firstChild)),r.state.loading|=4}}var qc={$$typeof:Z,Provider:null,Consumer:null,_currentValue:Ue,_currentValue2:Ue,_threadCount:0};function bT(n,r,o,c,f,m,x,E,z){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=oe(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=oe(0),this.hiddenUpdates=oe(null),this.identifierPrefix=c,this.onUncaughtError=f,this.onCaughtError=m,this.onRecoverableError=x,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=z,this.incompleteTransitions=new Map}function Ab(n,r,o,c,f,m,x,E,z,ie,ye,_e){return n=new bT(n,r,o,x,z,ie,ye,_e,E),r=1,m===!0&&(r|=24),m=Er(3,null,null,r),n.current=m,m.stateNode=n,r=Jf(),r.refCount++,n.pooledCache=r,r.refCount++,m.memoizedState={element:c,isDehydrated:o,cache:r},nm(m),n}function Rb(n){return n?(n=cl,n):cl}function Ib(n,r,o,c,f,m){f=Rb(f),c.context===null?c.context=f:c.pendingContext=f,c=Sa(r),c.payload={element:o},m=m===void 0?null:m,m!==null&&(c.callback=m),o=Ca(n,c,r),o!==null&&(gr(o,n,r),_c(o,n,r))}function Mb(n,r){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var o=n.retryLane;n.retryLane=o!==0&&o<r?o:r}}function wg(n,r){Mb(n,r),(n=n.alternate)&&Mb(n,r)}function Db(n){if(n.tag===13||n.tag===31){var r=vo(n,67108864);r!==null&&gr(r,n,67108864),wg(n,67108864)}}function Lb(n){if(n.tag===13||n.tag===31){var r=Ar();r=bn(r);var o=vo(n,r);o!==null&&gr(o,n,r),wg(n,r)}}var eh=!0;function wT(n,r,o,c){var f=J.T;J.T=null;var m=Te.p;try{Te.p=2,xg(n,r,o,c)}finally{Te.p=m,J.T=f}}function xT(n,r,o,c){var f=J.T;J.T=null;var m=Te.p;try{Te.p=8,xg(n,r,o,c)}finally{Te.p=m,J.T=f}}function xg(n,r,o,c){if(eh){var f=_g(c);if(f===null)og(n,r,c,th,o),Pb(n,c);else if(kT(f,n,r,o,c))c.stopPropagation();else if(Pb(n,c),r&4&&-1<_T.indexOf(n)){for(;f!==null;){var m=os(f);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var x=qe(m.pendingLanes);if(x!==0){var E=m;for(E.pendingLanes|=2,E.entangledLanes|=2;x;){var z=1<<31-At(x);E.entanglements[1]|=z,x&=~z}_i(m),(mn&6)===0&&(Pd=ut()+500,Vc(0))}}break;case 31:case 13:E=vo(m,2),E!==null&&gr(E,m,2),Ud(),wg(m,2)}if(m=_g(c),m===null&&og(n,r,c,th,o),m===f)break;f=m}f!==null&&c.stopPropagation()}else og(n,r,c,null,o)}}function _g(n){return n=F(n),kg(n)}var th=null;function kg(n){if(th=null,n=Ts(n),n!==null){var r=u(n);if(r===null)n=null;else{var o=r.tag;if(o===13){if(n=d(r),n!==null)return n;n=null}else if(o===31){if(n=g(r),n!==null)return n;n=null}else if(o===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;n=null}else r!==n&&(n=null)}}return th=n,null}function Ob(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Wt()){case en:return 2;case Gn:return 8;case un:case Qn:return 32;case Fn:return 268435456;default:return 32}default:return 32}}var jg=!1,Ua=null,Ba=null,za=null,$c=new Map,Wc=new Map,Fa=[],_T="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Pb(n,r){switch(n){case"focusin":case"focusout":Ua=null;break;case"dragenter":case"dragleave":Ba=null;break;case"mouseover":case"mouseout":za=null;break;case"pointerover":case"pointerout":$c.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Wc.delete(r.pointerId)}}function Gc(n,r,o,c,f,m){return n===null||n.nativeEvent!==m?(n={blockedOn:r,domEventName:o,eventSystemFlags:c,nativeEvent:m,targetContainers:[f]},r!==null&&(r=os(r),r!==null&&Db(r)),n):(n.eventSystemFlags|=c,r=n.targetContainers,f!==null&&r.indexOf(f)===-1&&r.push(f),n)}function kT(n,r,o,c,f){switch(r){case"focusin":return Ua=Gc(Ua,n,r,o,c,f),!0;case"dragenter":return Ba=Gc(Ba,n,r,o,c,f),!0;case"mouseover":return za=Gc(za,n,r,o,c,f),!0;case"pointerover":var m=f.pointerId;return $c.set(m,Gc($c.get(m)||null,n,r,o,c,f)),!0;case"gotpointercapture":return m=f.pointerId,Wc.set(m,Gc(Wc.get(m)||null,n,r,o,c,f)),!0}return!1}function Vb(n){var r=Ts(n.target);if(r!==null){var o=u(r);if(o!==null){if(r=o.tag,r===13){if(r=d(o),r!==null){n.blockedOn=r,Cn(n.priority,function(){Lb(o)});return}}else if(r===31){if(r=g(o),r!==null){n.blockedOn=r,Cn(n.priority,function(){Lb(o)});return}}else if(r===3&&o.stateNode.current.memoizedState.isDehydrated){n.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}n.blockedOn=null}function nh(n){if(n.blockedOn!==null)return!1;for(var r=n.targetContainers;0<r.length;){var o=_g(n.nativeEvent);if(o===null){o=n.nativeEvent;var c=new o.constructor(o.type,o);er=c,o.target.dispatchEvent(c),er=null}else return r=os(o),r!==null&&Db(r),n.blockedOn=o,!1;r.shift()}return!0}function Ub(n,r,o){nh(n)&&o.delete(r)}function jT(){jg=!1,Ua!==null&&nh(Ua)&&(Ua=null),Ba!==null&&nh(Ba)&&(Ba=null),za!==null&&nh(za)&&(za=null),$c.forEach(Ub),Wc.forEach(Ub)}function sh(n,r){n.blockedOn===r&&(n.blockedOn=null,jg||(jg=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,jT)))}var rh=null;function Bb(n){rh!==n&&(rh=n,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){rh===n&&(rh=null);for(var r=0;r<n.length;r+=3){var o=n[r],c=n[r+1],f=n[r+2];if(typeof c!="function"){if(kg(c||o)===null)continue;break}var m=os(o);m!==null&&(n.splice(r,3),r-=3,_m(m,{pending:!0,data:f,method:o.method,action:c},c,f))}}))}function Ml(n){function r(z){return sh(z,n)}Ua!==null&&sh(Ua,n),Ba!==null&&sh(Ba,n),za!==null&&sh(za,n),$c.forEach(r),Wc.forEach(r);for(var o=0;o<Fa.length;o++){var c=Fa[o];c.blockedOn===n&&(c.blockedOn=null)}for(;0<Fa.length&&(o=Fa[0],o.blockedOn===null);)Vb(o),o.blockedOn===null&&Fa.shift();if(o=(n.ownerDocument||n).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var f=o[c],m=o[c+1],x=f[an]||null;if(typeof m=="function")x||Bb(o);else if(x){var E=null;if(m&&m.hasAttribute("formAction")){if(f=m,x=m[an]||null)E=x.formAction;else if(kg(f)!==null)continue}else E=x.action;typeof E=="function"?o[c+1]=E:(o.splice(c,3),c-=3),Bb(o)}}}function zb(){function n(m){m.canIntercept&&m.info==="react-transition"&&m.intercept({handler:function(){return new Promise(function(x){return f=x})},focusReset:"manual",scroll:"manual"})}function r(){f!==null&&(f(),f=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var m=navigation.currentEntry;m&&m.url!=null&&navigation.navigate(m.url,{state:m.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,f=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),f!==null&&(f(),f=null)}}}function Eg(n){this._internalRoot=n}ih.prototype.render=Eg.prototype.render=function(n){var r=this._internalRoot;if(r===null)throw Error(i(409));var o=r.current,c=Ar();Ib(o,c,n,r,null,null)},ih.prototype.unmount=Eg.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var r=n.containerInfo;Ib(n.current,2,null,n,null,null),Ud(),r[as]=null}};function ih(n){this._internalRoot=n}ih.prototype.unstable_scheduleHydration=function(n){if(n){var r=on();n={blockedOn:null,target:n,priority:r};for(var o=0;o<Fa.length&&r!==0&&r<Fa[o].priority;o++);Fa.splice(o,0,n),o===0&&Vb(n)}};var Fb=e.version;if(Fb!=="19.2.4")throw Error(i(527,Fb,"19.2.4"));Te.findDOMNode=function(n){var r=n._reactInternals;if(r===void 0)throw typeof n.render=="function"?Error(i(188)):(n=Object.keys(n).join(","),Error(i(268,n)));return n=p(r),n=n!==null?b(n):null,n=n===null?null:n.stateNode,n};var ET={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:J,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ah=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ah.isDisabled&&ah.supportsFiber)try{tn=ah.inject(ET),zt=ah}catch{}}return Yc.createRoot=function(n,r){if(!l(n))throw Error(i(299));var o=!1,c="",f=Yv,m=Qv,x=Xv;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onUncaughtError!==void 0&&(f=r.onUncaughtError),r.onCaughtError!==void 0&&(m=r.onCaughtError),r.onRecoverableError!==void 0&&(x=r.onRecoverableError)),r=Ab(n,1,!1,null,null,o,c,null,f,m,x,zb),n[as]=r.current,ag(n),new Eg(r)},Yc.hydrateRoot=function(n,r,o){if(!l(n))throw Error(i(299));var c=!1,f="",m=Yv,x=Qv,E=Xv,z=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(m=o.onUncaughtError),o.onCaughtError!==void 0&&(x=o.onCaughtError),o.onRecoverableError!==void 0&&(E=o.onRecoverableError),o.formState!==void 0&&(z=o.formState)),r=Ab(n,1,!0,r,o??null,c,f,z,m,x,E,zb),r.context=Rb(null),o=r.current,c=Ar(),c=bn(c),f=Sa(c),f.callback=null,Ca(o,f,c),o=c,r.current.lanes=o,Ae(r,o),_i(r),n[as]=r.current,ag(n),new ih(r)},Yc.version="19.2.4",Yc}var Jb;function LT(){if(Jb)return Cg.exports;Jb=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Cg.exports=DT(),Cg.exports}var OT=LT();const PT="modulepreload",VT=function(s){return"/login/"+s},Zb={},Ys=function(e,t,i){let l=Promise.resolve();if(t&&t.length>0){let y=function(p){return Promise.all(p.map(b=>Promise.resolve(b).then(j=>({status:"fulfilled",value:j}),j=>({status:"rejected",reason:j}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),g=d?.nonce||d?.getAttribute("nonce");l=y(t.map(p=>{if(p=VT(p),p in Zb)return;Zb[p]=!0;const b=p.endsWith(".css"),j=b?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${j}`))return;const S=document.createElement("link");if(S.rel=b?"stylesheet":PT,b||(S.as="script"),S.crossOrigin="",S.href=p,g&&S.setAttribute("nonce",g),document.head.appendChild(S),b)return new Promise((R,H)=>{S.addEventListener("load",R),S.addEventListener("error",()=>H(new Error(`Unable to preload CSS for ${p}`)))})}))}function u(d){const g=new Event("vite:preloadError",{cancelable:!0});if(g.payload=d,window.dispatchEvent(g),!g.defaultPrevented)throw d}return l.then(d=>{for(const g of d||[])g.status==="rejected"&&u(g.reason);return e().catch(u)})};var e2="popstate";function UT(s={}){function e(i,l){let{pathname:u,search:d,hash:g}=i.location;return pp("",{pathname:u,search:d,hash:g},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function t(i,l){return typeof l=="string"?l:yu(l)}return zT(e,t,null,s)}function Wn(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function Yr(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function BT(){return Math.random().toString(36).substring(2,10)}function t2(s,e){return{usr:s.state,key:s.key,idx:e}}function pp(s,e,t=null,i){return{pathname:typeof s=="string"?s:s.pathname,search:"",hash:"",...typeof e=="string"?tc(e):e,state:t,key:e&&e.key||i||BT()}}function yu({pathname:s="/",search:e="",hash:t=""}){return e&&e!=="?"&&(s+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(s+=t.charAt(0)==="#"?t:"#"+t),s}function tc(s){let e={};if(s){let t=s.indexOf("#");t>=0&&(e.hash=s.substring(t),s=s.substring(0,t));let i=s.indexOf("?");i>=0&&(e.search=s.substring(i),s=s.substring(0,i)),s&&(e.pathname=s)}return e}function zT(s,e,t,i={}){let{window:l=document.defaultView,v5Compat:u=!1}=i,d=l.history,g="POP",y=null,p=b();p==null&&(p=0,d.replaceState({...d.state,idx:p},""));function b(){return(d.state||{idx:null}).idx}function j(){g="POP";let B=b(),Y=B==null?null:B-p;p=B,y&&y({action:g,location:K.location,delta:Y})}function S(B,Y){g="PUSH";let Q=pp(K.location,B,Y);p=b()+1;let Z=t2(Q,p),ge=K.createHref(Q);try{d.pushState(Z,"",ge)}catch(xe){if(xe instanceof DOMException&&xe.name==="DataCloneError")throw xe;l.location.assign(ge)}u&&y&&y({action:g,location:K.location,delta:1})}function R(B,Y){g="REPLACE";let Q=pp(K.location,B,Y);p=b();let Z=t2(Q,p),ge=K.createHref(Q);d.replaceState(Z,"",ge),u&&y&&y({action:g,location:K.location,delta:0})}function H(B){return FT(B)}let K={get action(){return g},get location(){return s(l,d)},listen(B){if(y)throw new Error("A history only accepts one active listener");return l.addEventListener(e2,j),y=B,()=>{l.removeEventListener(e2,j),y=null}},createHref(B){return e(l,B)},createURL:H,encodeLocation(B){let Y=H(B);return{pathname:Y.pathname,search:Y.search,hash:Y.hash}},push:S,replace:R,go(B){return d.go(B)}};return K}function FT(s,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Wn(t,"No window.location.(origin|href) available to create URL");let i=typeof s=="string"?s:yu(s);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function gx(s,e,t="/"){return HT(s,e,t,!1)}function HT(s,e,t,i){let l=typeof e=="string"?tc(e):e,u=la(l.pathname||"/",t);if(u==null)return null;let d=px(s);qT(d);let g=null;for(let y=0;g==null&&y<d.length;++y){let p=tS(u);g=ZT(d[y],p,i)}return g}function px(s,e=[],t=[],i="",l=!1){let u=(d,g,y=l,p)=>{let b={relativePath:p===void 0?d.path||"":p,caseSensitive:d.caseSensitive===!0,childrenIndex:g,route:d};if(b.relativePath.startsWith("/")){if(!b.relativePath.startsWith(i)&&y)return;Wn(b.relativePath.startsWith(i),`Absolute route path "${b.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),b.relativePath=b.relativePath.slice(i.length)}let j=ra([i,b.relativePath]),S=t.concat(b);d.children&&d.children.length>0&&(Wn(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${j}".`),px(d.children,e,S,j,y)),!(d.path==null&&!d.index)&&e.push({path:j,score:XT(j,d.index),routesMeta:S})};return s.forEach((d,g)=>{if(d.path===""||!d.path?.includes("?"))u(d,g);else for(let y of yx(d.path))u(d,g,!0,y)}),e}function yx(s){let e=s.split("/");if(e.length===0)return[];let[t,...i]=e,l=t.endsWith("?"),u=t.replace(/\?$/,"");if(i.length===0)return l?[u,""]:[u];let d=yx(i.join("/")),g=[];return g.push(...d.map(y=>y===""?u:[u,y].join("/"))),l&&g.push(...d),g.map(y=>s.startsWith("/")&&y===""?"/":y)}function qT(s){s.sort((e,t)=>e.score!==t.score?t.score-e.score:JT(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var $T=/^:[\w-]+$/,WT=3,GT=2,KT=1,YT=10,QT=-2,n2=s=>s==="*";function XT(s,e){let t=s.split("/"),i=t.length;return t.some(n2)&&(i+=QT),e&&(i+=GT),t.filter(l=>!n2(l)).reduce((l,u)=>l+($T.test(u)?WT:u===""?KT:YT),i)}function JT(s,e){return s.length===e.length&&s.slice(0,-1).every((i,l)=>i===e[l])?s[s.length-1]-e[e.length-1]:0}function ZT(s,e,t=!1){let{routesMeta:i}=s,l={},u="/",d=[];for(let g=0;g<i.length;++g){let y=i[g],p=g===i.length-1,b=u==="/"?e:e.slice(u.length)||"/",j=Mh({path:y.relativePath,caseSensitive:y.caseSensitive,end:p},b),S=y.route;if(!j&&p&&t&&!i[i.length-1].route.index&&(j=Mh({path:y.relativePath,caseSensitive:y.caseSensitive,end:!1},b)),!j)return null;Object.assign(l,j.params),d.push({params:l,pathname:ra([u,j.pathname]),pathnameBase:iS(ra([u,j.pathnameBase])),route:S}),j.pathnameBase!=="/"&&(u=ra([u,j.pathnameBase]))}return d}function Mh(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[t,i]=eS(s.path,s.caseSensitive,s.end),l=e.match(t);if(!l)return null;let u=l[0],d=u.replace(/(.)\/+$/,"$1"),g=l.slice(1);return{params:i.reduce((p,{paramName:b,isOptional:j},S)=>{if(b==="*"){let H=g[S]||"";d=u.slice(0,u.length-H.length).replace(/(.)\/+$/,"$1")}const R=g[S];return j&&!R?p[b]=void 0:p[b]=(R||"").replace(/%2F/g,"/"),p},{}),pathname:u,pathnameBase:d,pattern:s}}function eS(s,e=!1,t=!0){Yr(s==="*"||!s.endsWith("*")||s.endsWith("/*"),`Route path "${s}" will be treated as if it were "${s.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${s.replace(/\*$/,"/*")}".`);let i=[],l="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,g,y)=>(i.push({paramName:g,isOptional:y!=null}),y?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return s.endsWith("*")?(i.push({paramName:"*"}),l+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?l+="\\/*$":s!==""&&s!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,e?void 0:"i"),i]}function tS(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Yr(!1,`The URL path "${s}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),s}}function la(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=s.charAt(t);return i&&i!=="/"?null:s.slice(t)||"/"}var nS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function sS(s,e="/"){let{pathname:t,search:i="",hash:l=""}=typeof s=="string"?tc(s):s,u;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?u=s2(t.substring(1),"/"):u=s2(t,e)):u=e,{pathname:u,search:aS(i),hash:oS(l)}}function s2(s,e){let t=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(l=>{l===".."?t.length>1&&t.pop():l!=="."&&t.push(l)}),t.length>1?t.join("/"):"/"}function Ig(s,e,t,i){return`Cannot include a '${s}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function rS(s){return s.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Jp(s){let e=rS(s);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function Zp(s,e,t,i=!1){let l;typeof s=="string"?l=tc(s):(l={...s},Wn(!l.pathname||!l.pathname.includes("?"),Ig("?","pathname","search",l)),Wn(!l.pathname||!l.pathname.includes("#"),Ig("#","pathname","hash",l)),Wn(!l.search||!l.search.includes("#"),Ig("#","search","hash",l)));let u=s===""||l.pathname==="",d=u?"/":l.pathname,g;if(d==null)g=t;else{let j=e.length-1;if(!i&&d.startsWith("..")){let S=d.split("/");for(;S[0]==="..";)S.shift(),j-=1;l.pathname=S.join("/")}g=j>=0?e[j]:"/"}let y=sS(l,g),p=d&&d!=="/"&&d.endsWith("/"),b=(u||d===".")&&t.endsWith("/");return!y.pathname.endsWith("/")&&(p||b)&&(y.pathname+="/"),y}var ra=s=>s.join("/").replace(/\/\/+/g,"/"),iS=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),aS=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,oS=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s,lS=class{constructor(s,e,t,i=!1){this.status=s,this.statusText=e||"",this.internal=i,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function cS(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}function uS(s){return s.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var vx=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function bx(s,e){let t=s;if(typeof t!="string"||!nS.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let i=t,l=!1;if(vx)try{let u=new URL(window.location.href),d=t.startsWith("//")?new URL(u.protocol+t):new URL(t),g=la(d.pathname,e);d.origin===u.origin&&g!=null?t=g+d.search+d.hash:l=!0}catch{Yr(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:l,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var wx=["POST","PUT","PATCH","DELETE"];new Set(wx);var dS=["GET",...wx];new Set(dS);var nc=w.createContext(null);nc.displayName="DataRouter";var nf=w.createContext(null);nf.displayName="DataRouterState";var hS=w.createContext(!1),xx=w.createContext({isTransitioning:!1});xx.displayName="ViewTransition";var fS=w.createContext(new Map);fS.displayName="Fetchers";var mS=w.createContext(null);mS.displayName="Await";var Mr=w.createContext(null);Mr.displayName="Navigation";var Au=w.createContext(null);Au.displayName="Location";var fi=w.createContext({outlet:null,matches:[],isDataRoute:!1});fi.displayName="Route";var ey=w.createContext(null);ey.displayName="RouteError";var _x="REACT_ROUTER_ERROR",gS="REDIRECT",pS="ROUTE_ERROR_RESPONSE";function yS(s){if(s.startsWith(`${_x}:${gS}:{`))try{let e=JSON.parse(s.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function vS(s){if(s.startsWith(`${_x}:${pS}:{`))try{let e=JSON.parse(s.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new lS(e.status,e.statusText,e.data)}catch{}}function bS(s,{relative:e}={}){Wn(sc(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=w.useContext(Mr),{hash:l,pathname:u,search:d}=Ru(s,{relative:e}),g=u;return t!=="/"&&(g=u==="/"?t:ra([t,u])),i.createHref({pathname:g,search:d,hash:l})}function sc(){return w.useContext(Au)!=null}function Mi(){return Wn(sc(),"useLocation() may be used only in the context of a <Router> component."),w.useContext(Au).location}var kx="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function jx(s){w.useContext(Mr).static||w.useLayoutEffect(s)}function Qs(){let{isDataRoute:s}=w.useContext(fi);return s?MS():wS()}function wS(){Wn(sc(),"useNavigate() may be used only in the context of a <Router> component.");let s=w.useContext(nc),{basename:e,navigator:t}=w.useContext(Mr),{matches:i}=w.useContext(fi),{pathname:l}=Mi(),u=JSON.stringify(Jp(i)),d=w.useRef(!1);return jx(()=>{d.current=!0}),w.useCallback((y,p={})=>{if(Yr(d.current,kx),!d.current)return;if(typeof y=="number"){t.go(y);return}let b=Zp(y,JSON.parse(u),l,p.relative==="path");s==null&&e!=="/"&&(b.pathname=b.pathname==="/"?e:ra([e,b.pathname])),(p.replace?t.replace:t.push)(b,p.state,p)},[e,t,u,l,s])}w.createContext(null);function xS(){let{matches:s}=w.useContext(fi),e=s[s.length-1];return e?e.params:{}}function Ru(s,{relative:e}={}){let{matches:t}=w.useContext(fi),{pathname:i}=Mi(),l=JSON.stringify(Jp(t));return w.useMemo(()=>Zp(s,JSON.parse(l),i,e==="path"),[s,l,i,e])}function _S(s,e){return Ex(s,e)}function Ex(s,e,t,i,l){Wn(sc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=w.useContext(Mr),{matches:d}=w.useContext(fi),g=d[d.length-1],y=g?g.params:{},p=g?g.pathname:"/",b=g?g.pathnameBase:"/",j=g&&g.route;{let Q=j&&j.path||"";Sx(p,!j||Q.endsWith("*")||Q.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${p}" (under <Route path="${Q}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${Q}"> to <Route path="${Q==="/"?"*":`${Q}/*`}">.`)}let S=Mi(),R;if(e){let Q=typeof e=="string"?tc(e):e;Wn(b==="/"||Q.pathname?.startsWith(b),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${b}" but pathname "${Q.pathname}" was given in the \`location\` prop.`),R=Q}else R=S;let H=R.pathname||"/",K=H;if(b!=="/"){let Q=b.replace(/^\//,"").split("/");K="/"+H.replace(/^\//,"").split("/").slice(Q.length).join("/")}let B=gx(s,{pathname:K});Yr(j||B!=null,`No routes matched location "${R.pathname}${R.search}${R.hash}" `),Yr(B==null||B[B.length-1].route.element!==void 0||B[B.length-1].route.Component!==void 0||B[B.length-1].route.lazy!==void 0,`Matched leaf route at location "${R.pathname}${R.search}${R.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let Y=SS(B&&B.map(Q=>Object.assign({},Q,{params:Object.assign({},y,Q.params),pathname:ra([b,u.encodeLocation?u.encodeLocation(Q.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Q.pathname]),pathnameBase:Q.pathnameBase==="/"?b:ra([b,u.encodeLocation?u.encodeLocation(Q.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Q.pathnameBase])})),d,t,i,l);return e&&Y?w.createElement(Au.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...R},navigationType:"POP"}},Y):Y}function kS(){let s=IS(),e=cS(s)?`${s.status} ${s.statusText}`:s instanceof Error?s.message:JSON.stringify(s),t=s instanceof Error?s.stack:null,i="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:i},u={padding:"2px 4px",backgroundColor:i},d=null;return console.error("Error handled by React Router default ErrorBoundary:",s),d=w.createElement(w.Fragment,null,w.createElement("p",null," Hey developer "),w.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",w.createElement("code",{style:u},"ErrorBoundary")," or"," ",w.createElement("code",{style:u},"errorElement")," prop on your route.")),w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},e),t?w.createElement("pre",{style:l},t):null,d)}var jS=w.createElement(kS,null),Tx=class extends w.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,e){return e.location!==s.location||e.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:e.error,location:e.location,revalidation:s.revalidation||e.revalidation}}componentDidCatch(s,e){this.props.onError?this.props.onError(s,e):console.error("React Router caught the following error during render",s)}render(){let s=this.state.error;if(this.context&&typeof s=="object"&&s&&"digest"in s&&typeof s.digest=="string"){const t=vS(s.digest);t&&(s=t)}let e=s!==void 0?w.createElement(fi.Provider,{value:this.props.routeContext},w.createElement(ey.Provider,{value:s,children:this.props.component})):this.props.children;return this.context?w.createElement(ES,{error:s},e):e}};Tx.contextType=hS;var Mg=new WeakMap;function ES({children:s,error:e}){let{basename:t}=w.useContext(Mr);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=yS(e.digest);if(i){let l=Mg.get(e);if(l)throw l;let u=bx(i.location,t);if(vx&&!Mg.get(e))if(u.isExternal||i.reloadDocument)window.location.href=u.absoluteURL||u.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(u.to,{replace:i.replace}));throw Mg.set(e,d),d}return w.createElement("meta",{httpEquiv:"refresh",content:`0;url=${u.absoluteURL||u.to}`})}}return s}function TS({routeContext:s,match:e,children:t}){let i=w.useContext(nc);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),w.createElement(fi.Provider,{value:s},t)}function SS(s,e=[],t=null,i=null,l=null){if(s==null){if(!t)return null;if(t.errors)s=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)s=t.matches;else return null}let u=s,d=t?.errors;if(d!=null){let b=u.findIndex(j=>j.route.id&&d?.[j.route.id]!==void 0);Wn(b>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),u=u.slice(0,Math.min(u.length,b+1))}let g=!1,y=-1;if(t)for(let b=0;b<u.length;b++){let j=u[b];if((j.route.HydrateFallback||j.route.hydrateFallbackElement)&&(y=b),j.route.id){let{loaderData:S,errors:R}=t,H=j.route.loader&&!S.hasOwnProperty(j.route.id)&&(!R||R[j.route.id]===void 0);if(j.route.lazy||H){g=!0,y>=0?u=u.slice(0,y+1):u=[u[0]];break}}}let p=t&&i?(b,j)=>{i(b,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:uS(t.matches),errorInfo:j})}:void 0;return u.reduceRight((b,j,S)=>{let R,H=!1,K=null,B=null;t&&(R=d&&j.route.id?d[j.route.id]:void 0,K=j.route.errorElement||jS,g&&(y<0&&S===0?(Sx("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),H=!0,B=null):y===S&&(H=!0,B=j.route.hydrateFallbackElement||null)));let Y=e.concat(u.slice(0,S+1)),Q=()=>{let Z;return R?Z=K:H?Z=B:j.route.Component?Z=w.createElement(j.route.Component,null):j.route.element?Z=j.route.element:Z=b,w.createElement(TS,{match:j,routeContext:{outlet:b,matches:Y,isDataRoute:t!=null},children:Z})};return t&&(j.route.ErrorBoundary||j.route.errorElement||S===0)?w.createElement(Tx,{location:t.location,revalidation:t.revalidation,component:K,error:R,children:Q(),routeContext:{outlet:null,matches:Y,isDataRoute:!0},onError:p}):Q()},null)}function ty(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function CS(s){let e=w.useContext(nc);return Wn(e,ty(s)),e}function NS(s){let e=w.useContext(nf);return Wn(e,ty(s)),e}function AS(s){let e=w.useContext(fi);return Wn(e,ty(s)),e}function ny(s){let e=AS(s),t=e.matches[e.matches.length-1];return Wn(t.route.id,`${s} can only be used on routes that contain a unique "id"`),t.route.id}function RS(){return ny("useRouteId")}function IS(){let s=w.useContext(ey),e=NS("useRouteError"),t=ny("useRouteError");return s!==void 0?s:e.errors?.[t]}function MS(){let{router:s}=CS("useNavigate"),e=ny("useNavigate"),t=w.useRef(!1);return jx(()=>{t.current=!0}),w.useCallback(async(l,u={})=>{Yr(t.current,kx),t.current&&(typeof l=="number"?await s.navigate(l):await s.navigate(l,{fromRouteId:e,...u}))},[s,e])}var r2={};function Sx(s,e,t){!e&&!r2[s]&&(r2[s]=!0,Yr(!1,t))}w.memo(DS);function DS({routes:s,future:e,state:t,onError:i}){return Ex(s,void 0,t,i,e)}function Cx({to:s,replace:e,state:t,relative:i}){Wn(sc(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=w.useContext(Mr);Yr(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=w.useContext(fi),{pathname:d}=Mi(),g=Qs(),y=Zp(s,Jp(u),d,i==="path"),p=JSON.stringify(y);return w.useEffect(()=>{g(JSON.parse(p),{replace:e,state:t,relative:i})},[g,p,i,e,t]),null}function Sn(s){Wn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function LS({basename:s="/",children:e=null,location:t,navigationType:i="POP",navigator:l,static:u=!1,unstable_useTransitions:d}){Wn(!sc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let g=s.replace(/^\/*/,"/"),y=w.useMemo(()=>({basename:g,navigator:l,static:u,unstable_useTransitions:d,future:{}}),[g,l,u,d]);typeof t=="string"&&(t=tc(t));let{pathname:p="/",search:b="",hash:j="",state:S=null,key:R="default"}=t,H=w.useMemo(()=>{let K=la(p,g);return K==null?null:{location:{pathname:K,search:b,hash:j,state:S,key:R},navigationType:i}},[g,p,b,j,S,R,i]);return Yr(H!=null,`<Router basename="${g}"> is not able to match the URL "${p}${b}${j}" because it does not start with the basename, so the <Router> won't render anything.`),H==null?null:w.createElement(Mr.Provider,{value:y},w.createElement(Au.Provider,{children:e,value:H}))}function OS({children:s,location:e}){return _S(yp(s),e)}function yp(s,e=[]){let t=[];return w.Children.forEach(s,(i,l)=>{if(!w.isValidElement(i))return;let u=[...e,l];if(i.type===w.Fragment){t.push.apply(t,yp(i.props.children,u));return}Wn(i.type===Sn,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Wn(!i.props.index||!i.props.children,"An index route cannot have child routes.");let d={id:i.props.id||u.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(d.children=yp(i.props.children,u)),t.push(d)}),t}var xh="get",_h="application/x-www-form-urlencoded";function sf(s){return typeof HTMLElement<"u"&&s instanceof HTMLElement}function PS(s){return sf(s)&&s.tagName.toLowerCase()==="button"}function VS(s){return sf(s)&&s.tagName.toLowerCase()==="form"}function US(s){return sf(s)&&s.tagName.toLowerCase()==="input"}function BS(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function zS(s,e){return s.button===0&&(!e||e==="_self")&&!BS(s)}function vp(s=""){return new URLSearchParams(typeof s=="string"||Array.isArray(s)||s instanceof URLSearchParams?s:Object.keys(s).reduce((e,t)=>{let i=s[t];return e.concat(Array.isArray(i)?i.map(l=>[t,l]):[[t,i]])},[]))}function FS(s,e){let t=vp(s);return e&&e.forEach((i,l)=>{t.has(l)||e.getAll(l).forEach(u=>{t.append(l,u)})}),t}var oh=null;function HS(){if(oh===null)try{new FormData(document.createElement("form"),0),oh=!1}catch{oh=!0}return oh}var qS=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Dg(s){return s!=null&&!qS.has(s)?(Yr(!1,`"${s}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${_h}"`),null):s}function $S(s,e){let t,i,l,u,d;if(VS(s)){let g=s.getAttribute("action");i=g?la(g,e):null,t=s.getAttribute("method")||xh,l=Dg(s.getAttribute("enctype"))||_h,u=new FormData(s)}else if(PS(s)||US(s)&&(s.type==="submit"||s.type==="image")){let g=s.form;if(g==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let y=s.getAttribute("formaction")||g.getAttribute("action");if(i=y?la(y,e):null,t=s.getAttribute("formmethod")||g.getAttribute("method")||xh,l=Dg(s.getAttribute("formenctype"))||Dg(g.getAttribute("enctype"))||_h,u=new FormData(g,s),!HS()){let{name:p,type:b,value:j}=s;if(b==="image"){let S=p?`${p}.`:"";u.append(`${S}x`,"0"),u.append(`${S}y`,"0")}else p&&u.append(p,j)}}else{if(sf(s))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=xh,i=null,l=_h,d=s}return u&&l==="text/plain"&&(d=u,u=void 0),{action:i,method:t.toLowerCase(),encType:l,formData:u,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function sy(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function WS(s,e,t,i){let l=typeof s=="string"?new URL(s,typeof window>"u"?"server://singlefetch/":window.location.origin):s;return t?l.pathname.endsWith("/")?l.pathname=`${l.pathname}_.${i}`:l.pathname=`${l.pathname}.${i}`:l.pathname==="/"?l.pathname=`_root.${i}`:e&&la(l.pathname,e)==="/"?l.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:l.pathname=`${l.pathname.replace(/\/$/,"")}.${i}`,l}async function GS(s,e){if(s.id in e)return e[s.id];try{let t=await import(s.module);return e[s.id]=t,t}catch(t){return console.error(`Error loading route module \`${s.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function KS(s){return s==null?!1:s.href==null?s.rel==="preload"&&typeof s.imageSrcSet=="string"&&typeof s.imageSizes=="string":typeof s.rel=="string"&&typeof s.href=="string"}async function YS(s,e,t){let i=await Promise.all(s.map(async l=>{let u=e.routes[l.route.id];if(u){let d=await GS(u,t);return d.links?d.links():[]}return[]}));return ZS(i.flat(1).filter(KS).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function i2(s,e,t,i,l,u){let d=(y,p)=>t[p]?y.route.id!==t[p].route.id:!0,g=(y,p)=>t[p].pathname!==y.pathname||t[p].route.path?.endsWith("*")&&t[p].params["*"]!==y.params["*"];return u==="assets"?e.filter((y,p)=>d(y,p)||g(y,p)):u==="data"?e.filter((y,p)=>{let b=i.routes[y.route.id];if(!b||!b.hasLoader)return!1;if(d(y,p)||g(y,p))return!0;if(y.route.shouldRevalidate){let j=y.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(s,window.origin),nextParams:y.params,defaultShouldRevalidate:!0});if(typeof j=="boolean")return j}return!0}):[]}function QS(s,e,{includeHydrateFallback:t}={}){return XS(s.map(i=>{let l=e.routes[i.route.id];if(!l)return[];let u=[l.module];return l.clientActionModule&&(u=u.concat(l.clientActionModule)),l.clientLoaderModule&&(u=u.concat(l.clientLoaderModule)),t&&l.hydrateFallbackModule&&(u=u.concat(l.hydrateFallbackModule)),l.imports&&(u=u.concat(l.imports)),u}).flat(1))}function XS(s){return[...new Set(s)]}function JS(s){let e={},t=Object.keys(s).sort();for(let i of t)e[i]=s[i];return e}function ZS(s,e){let t=new Set;return new Set(e),s.reduce((i,l)=>{let u=JSON.stringify(JS(l));return t.has(u)||(t.add(u),i.push({key:u,link:l})),i},[])}function Nx(){let s=w.useContext(nc);return sy(s,"You must render this element inside a <DataRouterContext.Provider> element"),s}function eC(){let s=w.useContext(nf);return sy(s,"You must render this element inside a <DataRouterStateContext.Provider> element"),s}var ry=w.createContext(void 0);ry.displayName="FrameworkContext";function Ax(){let s=w.useContext(ry);return sy(s,"You must render this element inside a <HydratedRouter> element"),s}function tC(s,e){let t=w.useContext(ry),[i,l]=w.useState(!1),[u,d]=w.useState(!1),{onFocus:g,onBlur:y,onMouseEnter:p,onMouseLeave:b,onTouchStart:j}=e,S=w.useRef(null);w.useEffect(()=>{if(s==="render"&&d(!0),s==="viewport"){let K=Y=>{Y.forEach(Q=>{d(Q.isIntersecting)})},B=new IntersectionObserver(K,{threshold:.5});return S.current&&B.observe(S.current),()=>{B.disconnect()}}},[s]),w.useEffect(()=>{if(i){let K=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(K)}}},[i]);let R=()=>{l(!0)},H=()=>{l(!1),d(!1)};return t?s!=="intent"?[u,S,{}]:[u,S,{onFocus:Qc(g,R),onBlur:Qc(y,H),onMouseEnter:Qc(p,R),onMouseLeave:Qc(b,H),onTouchStart:Qc(j,R)}]:[!1,S,{}]}function Qc(s,e){return t=>{s&&s(t),t.defaultPrevented||e(t)}}function nC({page:s,...e}){let{router:t}=Nx(),i=w.useMemo(()=>gx(t.routes,s,t.basename),[t.routes,s,t.basename]);return i?w.createElement(rC,{page:s,matches:i,...e}):null}function sC(s){let{manifest:e,routeModules:t}=Ax(),[i,l]=w.useState([]);return w.useEffect(()=>{let u=!1;return YS(s,e,t).then(d=>{u||l(d)}),()=>{u=!0}},[s,e,t]),i}function rC({page:s,matches:e,...t}){let i=Mi(),{future:l,manifest:u,routeModules:d}=Ax(),{basename:g}=Nx(),{loaderData:y,matches:p}=eC(),b=w.useMemo(()=>i2(s,e,p,u,i,"data"),[s,e,p,u,i]),j=w.useMemo(()=>i2(s,e,p,u,i,"assets"),[s,e,p,u,i]),S=w.useMemo(()=>{if(s===i.pathname+i.search+i.hash)return[];let K=new Set,B=!1;if(e.forEach(Q=>{let Z=u.routes[Q.route.id];!Z||!Z.hasLoader||(!b.some(ge=>ge.route.id===Q.route.id)&&Q.route.id in y&&d[Q.route.id]?.shouldRevalidate||Z.hasClientLoader?B=!0:K.add(Q.route.id))}),K.size===0)return[];let Y=WS(s,g,l.unstable_trailingSlashAwareDataRequests,"data");return B&&K.size>0&&Y.searchParams.set("_routes",e.filter(Q=>K.has(Q.route.id)).map(Q=>Q.route.id).join(",")),[Y.pathname+Y.search]},[g,l.unstable_trailingSlashAwareDataRequests,y,i,u,b,e,s,d]),R=w.useMemo(()=>QS(j,u),[j,u]),H=sC(j);return w.createElement(w.Fragment,null,S.map(K=>w.createElement("link",{key:K,rel:"prefetch",as:"fetch",href:K,...t})),R.map(K=>w.createElement("link",{key:K,rel:"modulepreload",href:K,...t})),H.map(({key:K,link:B})=>w.createElement("link",{key:K,nonce:t.nonce,...B,crossOrigin:B.crossOrigin??t.crossOrigin})))}function iC(...s){return e=>{s.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var aC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{aC&&(window.__reactRouterVersion="7.13.0")}catch{}function oC({basename:s,children:e,unstable_useTransitions:t,window:i}){let l=w.useRef();l.current==null&&(l.current=UT({window:i,v5Compat:!0}));let u=l.current,[d,g]=w.useState({action:u.action,location:u.location}),y=w.useCallback(p=>{t===!1?g(p):w.startTransition(()=>g(p))},[t]);return w.useLayoutEffect(()=>u.listen(y),[u,y]),w.createElement(LS,{basename:s,children:e,location:d.location,navigationType:d.action,navigator:u,unstable_useTransitions:t})}var Rx=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ix=w.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:l,reloadDocument:u,replace:d,state:g,target:y,to:p,preventScrollReset:b,viewTransition:j,unstable_defaultShouldRevalidate:S,...R},H){let{basename:K,unstable_useTransitions:B}=w.useContext(Mr),Y=typeof p=="string"&&Rx.test(p),Q=bx(p,K);p=Q.to;let Z=bS(p,{relative:l}),[ge,xe,pe]=tC(i,R),I=dC(p,{replace:d,state:g,target:y,preventScrollReset:b,relative:l,viewTransition:j,unstable_defaultShouldRevalidate:S,unstable_useTransitions:B});function T(V){e&&e(V),V.defaultPrevented||I(V)}let L=w.createElement("a",{...R,...pe,href:Q.absoluteURL||Z,onClick:Q.isExternal||u?e:T,ref:iC(H,xe),target:y,"data-discover":!Y&&t==="render"?"true":void 0});return ge&&!Y?w.createElement(w.Fragment,null,L,w.createElement(nC,{page:Z})):L});Ix.displayName="Link";var lC=w.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:l=!1,style:u,to:d,viewTransition:g,children:y,...p},b){let j=Ru(d,{relative:p.relative}),S=Mi(),R=w.useContext(nf),{navigator:H,basename:K}=w.useContext(Mr),B=R!=null&&pC(j)&&g===!0,Y=H.encodeLocation?H.encodeLocation(j).pathname:j.pathname,Q=S.pathname,Z=R&&R.navigation&&R.navigation.location?R.navigation.location.pathname:null;t||(Q=Q.toLowerCase(),Z=Z?Z.toLowerCase():null,Y=Y.toLowerCase()),Z&&K&&(Z=la(Z,K)||Z);const ge=Y!=="/"&&Y.endsWith("/")?Y.length-1:Y.length;let xe=Q===Y||!l&&Q.startsWith(Y)&&Q.charAt(ge)==="/",pe=Z!=null&&(Z===Y||!l&&Z.startsWith(Y)&&Z.charAt(Y.length)==="/"),I={isActive:xe,isPending:pe,isTransitioning:B},T=xe?e:void 0,L;typeof i=="function"?L=i(I):L=[i,xe?"active":null,pe?"pending":null,B?"transitioning":null].filter(Boolean).join(" ");let V=typeof u=="function"?u(I):u;return w.createElement(Ix,{...p,"aria-current":T,className:L,ref:b,style:V,to:d,viewTransition:g},typeof y=="function"?y(I):y)});lC.displayName="NavLink";var cC=w.forwardRef(({discover:s="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:l,state:u,method:d=xh,action:g,onSubmit:y,relative:p,preventScrollReset:b,viewTransition:j,unstable_defaultShouldRevalidate:S,...R},H)=>{let{unstable_useTransitions:K}=w.useContext(Mr),B=mC(),Y=gC(g,{relative:p}),Q=d.toLowerCase()==="get"?"get":"post",Z=typeof g=="string"&&Rx.test(g),ge=xe=>{if(y&&y(xe),xe.defaultPrevented)return;xe.preventDefault();let pe=xe.nativeEvent.submitter,I=pe?.getAttribute("formmethod")||d,T=()=>B(pe||xe.currentTarget,{fetcherKey:e,method:I,navigate:t,replace:l,state:u,relative:p,preventScrollReset:b,viewTransition:j,unstable_defaultShouldRevalidate:S});K&&t!==!1?w.startTransition(()=>T()):T()};return w.createElement("form",{ref:H,method:Q,action:Y,onSubmit:i?y:ge,...R,"data-discover":!Z&&s==="render"?"true":void 0})});cC.displayName="Form";function uC(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Mx(s){let e=w.useContext(nc);return Wn(e,uC(s)),e}function dC(s,{target:e,replace:t,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:g,unstable_useTransitions:y}={}){let p=Qs(),b=Mi(),j=Ru(s,{relative:u});return w.useCallback(S=>{if(zS(S,e)){S.preventDefault();let R=t!==void 0?t:yu(b)===yu(j),H=()=>p(s,{replace:R,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:g});y?w.startTransition(()=>H()):H()}},[b,p,j,t,i,e,s,l,u,d,g,y])}function RO(s){Yr(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=w.useRef(vp(s)),t=w.useRef(!1),i=Mi(),l=w.useMemo(()=>FS(i.search,t.current?null:e.current),[i.search]),u=Qs(),d=w.useCallback((g,y)=>{const p=vp(typeof g=="function"?g(new URLSearchParams(l)):g);t.current=!0,u("?"+p,y)},[u,l]);return[l,d]}var hC=0,fC=()=>`__${String(++hC)}__`;function mC(){let{router:s}=Mx("useSubmit"),{basename:e}=w.useContext(Mr),t=RS(),i=s.fetch,l=s.navigate;return w.useCallback(async(u,d={})=>{let{action:g,method:y,encType:p,formData:b,body:j}=$S(u,e);if(d.navigate===!1){let S=d.fetcherKey||fC();await i(S,t,d.action||g,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:b,body:j,formMethod:d.method||y,formEncType:d.encType||p,flushSync:d.flushSync})}else await l(d.action||g,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:b,body:j,formMethod:d.method||y,formEncType:d.encType||p,replace:d.replace,state:d.state,fromRouteId:t,flushSync:d.flushSync,viewTransition:d.viewTransition})},[i,l,e,t])}function gC(s,{relative:e}={}){let{basename:t}=w.useContext(Mr),i=w.useContext(fi);Wn(i,"useFormAction must be used inside a RouteContext");let[l]=i.matches.slice(-1),u={...Ru(s||".",{relative:e})},d=Mi();if(s==null){u.search=d.search;let g=new URLSearchParams(u.search),y=g.getAll("index");if(y.some(b=>b==="")){g.delete("index"),y.filter(j=>j).forEach(j=>g.append("index",j));let b=g.toString();u.search=b?`?${b}`:""}}return(!s||s===".")&&l.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(u.pathname=u.pathname==="/"?t:ra([t,u.pathname])),yu(u)}function pC(s,{relative:e}={}){let t=w.useContext(xx);Wn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=Mx("useViewTransitionState"),l=Ru(s,{relative:e});if(!t.isTransitioning)return!1;let u=la(t.currentLocation.pathname,i)||t.currentLocation.pathname,d=la(t.nextLocation.pathname,i)||t.nextLocation.pathname;return Mh(l.pathname,d)!=null||Mh(l.pathname,u)!=null}const yC=()=>{};var a2={};const Dx=function(s){const e=[];let t=0;for(let i=0;i<s.length;i++){let l=s.charCodeAt(i);l<128?e[t++]=l:l<2048?(e[t++]=l>>6|192,e[t++]=l&63|128):(l&64512)===55296&&i+1<s.length&&(s.charCodeAt(i+1)&64512)===56320?(l=65536+((l&1023)<<10)+(s.charCodeAt(++i)&1023),e[t++]=l>>18|240,e[t++]=l>>12&63|128,e[t++]=l>>6&63|128,e[t++]=l&63|128):(e[t++]=l>>12|224,e[t++]=l>>6&63|128,e[t++]=l&63|128)}return e},vC=function(s){const e=[];let t=0,i=0;for(;t<s.length;){const l=s[t++];if(l<128)e[i++]=String.fromCharCode(l);else if(l>191&&l<224){const u=s[t++];e[i++]=String.fromCharCode((l&31)<<6|u&63)}else if(l>239&&l<365){const u=s[t++],d=s[t++],g=s[t++],y=((l&7)<<18|(u&63)<<12|(d&63)<<6|g&63)-65536;e[i++]=String.fromCharCode(55296+(y>>10)),e[i++]=String.fromCharCode(56320+(y&1023))}else{const u=s[t++],d=s[t++];e[i++]=String.fromCharCode((l&15)<<12|(u&63)<<6|d&63)}}return e.join("")},Lx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let l=0;l<s.length;l+=3){const u=s[l],d=l+1<s.length,g=d?s[l+1]:0,y=l+2<s.length,p=y?s[l+2]:0,b=u>>2,j=(u&3)<<4|g>>4;let S=(g&15)<<2|p>>6,R=p&63;y||(R=64,d||(S=64)),i.push(t[b],t[j],t[S],t[R])}return i.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(Dx(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):vC(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let l=0;l<s.length;){const u=t[s.charAt(l++)],g=l<s.length?t[s.charAt(l)]:0;++l;const p=l<s.length?t[s.charAt(l)]:64;++l;const j=l<s.length?t[s.charAt(l)]:64;if(++l,u==null||g==null||p==null||j==null)throw new bC;const S=u<<2|g>>4;if(i.push(S),p!==64){const R=g<<4&240|p>>2;if(i.push(R),j!==64){const H=p<<6&192|j;i.push(H)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class bC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const wC=function(s){const e=Dx(s);return Lx.encodeByteArray(e,!0)},Dh=function(s){return wC(s).replace(/\./g,"")},Ox=function(s){try{return Lx.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function xC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const _C=()=>xC().__FIREBASE_DEFAULTS__,kC=()=>{if(typeof process>"u"||typeof a2>"u")return;const s=a2.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},jC=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&Ox(s[1]);return e&&JSON.parse(e)},rf=()=>{try{return yC()||_C()||kC()||jC()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},Px=s=>rf()?.emulatorHosts?.[s],Vx=s=>{const e=Px(s);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},Ux=()=>rf()?.config,Bx=s=>rf()?.[`_${s}`];class EC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function lo(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function iy(s){return(await fetch(s,{credentials:"include"})).ok}function zx(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",l=s.iat||0,u=s.sub||s.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d={iss:`https://securetoken.google.com/${i}`,aud:i,iat:l,exp:l+3600,auth_time:l,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...s};return[Dh(JSON.stringify(t)),Dh(JSON.stringify(d)),""].join(".")}const cu={};function TC(){const s={prod:[],emulator:[]};for(const e of Object.keys(cu))cu[e]?s.emulator.push(e):s.prod.push(e);return s}function SC(s){let e=document.getElementById(s),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),t=!0),{created:t,element:e}}let o2=!1;function ay(s,e){if(typeof window>"u"||typeof document>"u"||!lo(window.location.host)||cu[s]===e||cu[s]||o2)return;cu[s]=e;function t(S){return`__firebase__banner__${S}`}const i="__firebase__banner",u=TC().prod.length>0;function d(){const S=document.getElementById(i);S&&S.remove()}function g(S){S.style.display="flex",S.style.background="#7faaf0",S.style.position="fixed",S.style.bottom="5px",S.style.left="5px",S.style.padding=".5em",S.style.borderRadius="5px",S.style.alignItems="center"}function y(S,R){S.setAttribute("width","24"),S.setAttribute("id",R),S.setAttribute("height","24"),S.setAttribute("viewBox","0 0 24 24"),S.setAttribute("fill","none"),S.style.marginLeft="-6px"}function p(){const S=document.createElement("span");return S.style.cursor="pointer",S.style.marginLeft="16px",S.style.fontSize="24px",S.innerHTML=" &times;",S.onclick=()=>{o2=!0,d()},S}function b(S,R){S.setAttribute("id",R),S.innerText="Learn more",S.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",S.setAttribute("target","__blank"),S.style.paddingLeft="5px",S.style.textDecoration="underline"}function j(){const S=SC(i),R=t("text"),H=document.getElementById(R)||document.createElement("span"),K=t("learnmore"),B=document.getElementById(K)||document.createElement("a"),Y=t("preprendIcon"),Q=document.getElementById(Y)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(S.created){const Z=S.element;g(Z),b(B,K);const ge=p();y(Q,Y),Z.append(Q,H,B,ge),document.body.appendChild(Z)}u?(H.innerText="Preview backend disconnected.",Q.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(Q.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,H.innerText="Preview backend running in this workspace."),H.setAttribute("id",R)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",j):j()}function Ks(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function CC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ks())}function NC(){const s=rf()?.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function AC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function RC(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function IC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function MC(){const s=Ks();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function DC(){return!NC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Fx(){try{return typeof indexedDB=="object"}catch{return!1}}function Hx(){return new Promise((s,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",l=self.indexedDB.open(i);l.onsuccess=()=>{l.result.close(),t||self.indexedDB.deleteDatabase(i),s(!0)},l.onupgradeneeded=()=>{t=!1},l.onerror=()=>{e(l.error?.message||"")}}catch(t){e(t)}})}function LC(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}const OC="FirebaseError";class mi extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=OC,Object.setPrototypeOf(this,mi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Yo.prototype.create)}}class Yo{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},l=`${this.service}/${e}`,u=this.errors[e],d=u?PC(u,i):"Error",g=`${this.serviceName}: ${d} (${l}).`;return new mi(l,g,i)}}function PC(s,e){return s.replace(VC,(t,i)=>{const l=e[i];return l!=null?String(l):`<${i}?>`})}const VC=/\{\$([^}]+)}/g;function UC(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function ca(s,e){if(s===e)return!0;const t=Object.keys(s),i=Object.keys(e);for(const l of t){if(!i.includes(l))return!1;const u=s[l],d=e[l];if(l2(u)&&l2(d)){if(!ca(u,d))return!1}else if(u!==d)return!1}for(const l of i)if(!t.includes(l))return!1;return!0}function l2(s){return s!==null&&typeof s=="object"}function Iu(s){const e=[];for(const[t,i]of Object.entries(s))Array.isArray(i)?i.forEach(l=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(l))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function su(s){const e={};return s.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[l,u]=i.split("=");e[decodeURIComponent(l)]=decodeURIComponent(u)}}),e}function ru(s){const e=s.indexOf("?");if(!e)return"";const t=s.indexOf("#",e);return s.substring(e,t>0?t:void 0)}function BC(s,e){const t=new zC(s,e);return t.subscribe.bind(t)}class zC{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let l;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");FC(e,["next","error","complete"])?l=e:l={next:e,error:t,complete:i},l.next===void 0&&(l.next=Lg),l.error===void 0&&(l.error=Lg),l.complete===void 0&&(l.complete=Lg);const u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?l.error(this.finalError):l.complete()}catch{}}),this.observers.push(l),u}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function FC(s,e){if(typeof s!="object"||s===null)return!1;for(const t of e)if(t in s&&typeof s[t]=="function")return!0;return!1}function Lg(){}function vn(s){return s&&s._delegate?s._delegate:s}class Qr{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Mo="[DEFAULT]";class HC{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new EC;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const l=this.getOrInitializeService({instanceIdentifier:t});l&&i.resolve(l)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(l){if(i)return null;throw l}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if($C(e))try{this.getOrInitializeService({instanceIdentifier:Mo})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(t);try{const u=this.getOrInitializeService({instanceIdentifier:l});i.resolve(u)}catch{}}}}clearInstance(e=Mo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Mo){return this.instances.has(e)}getOptions(e=Mo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const l=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[u,d]of this.instancesDeferred.entries()){const g=this.normalizeInstanceIdentifier(u);i===g&&d.resolve(l)}return l}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),l=this.onInitCallbacks.get(i)??new Set;l.add(e),this.onInitCallbacks.set(i,l);const u=this.instances.get(i);return u&&e(u,i),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const l of i)try{l(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:qC(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Mo){return this.component?this.component.multipleInstances?e:Mo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function qC(s){return s===Mo?void 0:s}function $C(s){return s.instantiationMode==="EAGER"}class WC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new HC(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Qt;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(Qt||(Qt={}));const GC={debug:Qt.DEBUG,verbose:Qt.VERBOSE,info:Qt.INFO,warn:Qt.WARN,error:Qt.ERROR,silent:Qt.SILENT},KC=Qt.INFO,YC={[Qt.DEBUG]:"log",[Qt.VERBOSE]:"log",[Qt.INFO]:"info",[Qt.WARN]:"warn",[Qt.ERROR]:"error"},QC=(s,e,...t)=>{if(e<s.logLevel)return;const i=new Date().toISOString(),l=YC[e];if(l)console[l](`[${i}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class oy{constructor(e){this.name=e,this._logLevel=KC,this._logHandler=QC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Qt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?GC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Qt.DEBUG,...e),this._logHandler(this,Qt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Qt.VERBOSE,...e),this._logHandler(this,Qt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Qt.INFO,...e),this._logHandler(this,Qt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Qt.WARN,...e),this._logHandler(this,Qt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Qt.ERROR,...e),this._logHandler(this,Qt.ERROR,...e)}}const XC=(s,e)=>e.some(t=>s instanceof t);let c2,u2;function JC(){return c2||(c2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ZC(){return u2||(u2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const qx=new WeakMap,bp=new WeakMap,$x=new WeakMap,Og=new WeakMap,ly=new WeakMap;function eN(s){const e=new Promise((t,i)=>{const l=()=>{s.removeEventListener("success",u),s.removeEventListener("error",d)},u=()=>{t(ia(s.result)),l()},d=()=>{i(s.error),l()};s.addEventListener("success",u),s.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&qx.set(t,s)}).catch(()=>{}),ly.set(e,s),e}function tN(s){if(bp.has(s))return;const e=new Promise((t,i)=>{const l=()=>{s.removeEventListener("complete",u),s.removeEventListener("error",d),s.removeEventListener("abort",d)},u=()=>{t(),l()},d=()=>{i(s.error||new DOMException("AbortError","AbortError")),l()};s.addEventListener("complete",u),s.addEventListener("error",d),s.addEventListener("abort",d)});bp.set(s,e)}let wp={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return bp.get(s);if(e==="objectStoreNames")return s.objectStoreNames||$x.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ia(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function nN(s){wp=s(wp)}function sN(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=s.call(Pg(this),e,...t);return $x.set(i,e.sort?e.sort():[e]),ia(i)}:ZC().includes(s)?function(...e){return s.apply(Pg(this),e),ia(qx.get(this))}:function(...e){return ia(s.apply(Pg(this),e))}}function rN(s){return typeof s=="function"?sN(s):(s instanceof IDBTransaction&&tN(s),XC(s,JC())?new Proxy(s,wp):s)}function ia(s){if(s instanceof IDBRequest)return eN(s);if(Og.has(s))return Og.get(s);const e=rN(s);return e!==s&&(Og.set(s,e),ly.set(e,s)),e}const Pg=s=>ly.get(s);function af(s,e,{blocked:t,upgrade:i,blocking:l,terminated:u}={}){const d=indexedDB.open(s,e),g=ia(d);return i&&d.addEventListener("upgradeneeded",y=>{i(ia(d.result),y.oldVersion,y.newVersion,ia(d.transaction),y)}),t&&d.addEventListener("blocked",y=>t(y.oldVersion,y.newVersion,y)),g.then(y=>{u&&y.addEventListener("close",()=>u()),l&&y.addEventListener("versionchange",p=>l(p.oldVersion,p.newVersion,p))}).catch(()=>{}),g}function Vg(s,{blocked:e}={}){const t=indexedDB.deleteDatabase(s);return e&&t.addEventListener("blocked",i=>e(i.oldVersion,i)),ia(t).then(()=>{})}const iN=["get","getKey","getAll","getAllKeys","count"],aN=["put","add","delete","clear"],Ug=new Map;function d2(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(Ug.get(e))return Ug.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,l=aN.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(l||iN.includes(t)))return;const u=async function(d,...g){const y=this.transaction(d,l?"readwrite":"readonly");let p=y.store;return i&&(p=p.index(g.shift())),(await Promise.all([p[t](...g),l&&y.done]))[0]};return Ug.set(e,u),u}nN(s=>({...s,get:(e,t,i)=>d2(e,t)||s.get(e,t,i),has:(e,t)=>!!d2(e,t)||s.has(e,t)}));class oN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(lN(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function lN(s){return s.getComponent()?.type==="VERSION"}const xp="@firebase/app",h2="0.14.7";const ua=new oy("@firebase/app"),cN="@firebase/app-compat",uN="@firebase/analytics-compat",dN="@firebase/analytics",hN="@firebase/app-check-compat",fN="@firebase/app-check",mN="@firebase/auth",gN="@firebase/auth-compat",pN="@firebase/database",yN="@firebase/data-connect",vN="@firebase/database-compat",bN="@firebase/functions",wN="@firebase/functions-compat",xN="@firebase/installations",_N="@firebase/installations-compat",kN="@firebase/messaging",jN="@firebase/messaging-compat",EN="@firebase/performance",TN="@firebase/performance-compat",SN="@firebase/remote-config",CN="@firebase/remote-config-compat",NN="@firebase/storage",AN="@firebase/storage-compat",RN="@firebase/firestore",IN="@firebase/ai",MN="@firebase/firestore-compat",DN="firebase",LN="12.8.0";const _p="[DEFAULT]",ON={[xp]:"fire-core",[cN]:"fire-core-compat",[dN]:"fire-analytics",[uN]:"fire-analytics-compat",[fN]:"fire-app-check",[hN]:"fire-app-check-compat",[mN]:"fire-auth",[gN]:"fire-auth-compat",[pN]:"fire-rtdb",[yN]:"fire-data-connect",[vN]:"fire-rtdb-compat",[bN]:"fire-fn",[wN]:"fire-fn-compat",[xN]:"fire-iid",[_N]:"fire-iid-compat",[kN]:"fire-fcm",[jN]:"fire-fcm-compat",[EN]:"fire-perf",[TN]:"fire-perf-compat",[SN]:"fire-rc",[CN]:"fire-rc-compat",[NN]:"fire-gcs",[AN]:"fire-gcs-compat",[RN]:"fire-fst",[MN]:"fire-fst-compat",[IN]:"fire-vertex","fire-js":"fire-js",[DN]:"fire-js-all"};const Lh=new Map,PN=new Map,kp=new Map;function f2(s,e){try{s.container.addComponent(e)}catch(t){ua.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function ui(s){const e=s.name;if(kp.has(e))return ua.debug(`There were multiple attempts to register component ${e}.`),!1;kp.set(e,s);for(const t of Lh.values())f2(t,s);for(const t of PN.values())f2(t,s);return!0}function Qo(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function Rr(s){return s==null?!1:s.settings!==void 0}const VN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ja=new Yo("app","Firebase",VN);class UN{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Qr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ja.create("app-deleted",{appName:this._name})}}const Xo=LN;function cy(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const i={name:_p,automaticDataCollectionEnabled:!0,...e},l=i.name;if(typeof l!="string"||!l)throw Ja.create("bad-app-name",{appName:String(l)});if(t||(t=Ux()),!t)throw Ja.create("no-options");const u=Lh.get(l);if(u){if(ca(t,u.options)&&ca(i,u.config))return u;throw Ja.create("duplicate-app",{appName:l})}const d=new WC(l);for(const y of kp.values())d.addComponent(y);const g=new UN(t,i,d);return Lh.set(l,g),g}function Mu(s=_p){const e=Lh.get(s);if(!e&&s===_p&&Ux())return cy();if(!e)throw Ja.create("no-app",{appName:s});return e}function vr(s,e,t){let i=ON[s]??s;t&&(i+=`-${t}`);const l=i.match(/\s|\//),u=e.match(/\s|\//);if(l||u){const d=[`Unable to register library "${i}" with version "${e}":`];l&&d.push(`library name "${i}" contains illegal characters (whitespace or "/")`),l&&u&&d.push("and"),u&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ua.warn(d.join(" "));return}ui(new Qr(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const BN="firebase-heartbeat-database",zN=1,vu="firebase-heartbeat-store";let Bg=null;function Wx(){return Bg||(Bg=af(BN,zN,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(vu)}catch(t){console.warn(t)}}}}).catch(s=>{throw Ja.create("idb-open",{originalErrorMessage:s.message})})),Bg}async function FN(s){try{const t=(await Wx()).transaction(vu),i=await t.objectStore(vu).get(Gx(s));return await t.done,i}catch(e){if(e instanceof mi)ua.warn(e.message);else{const t=Ja.create("idb-get",{originalErrorMessage:e?.message});ua.warn(t.message)}}}async function m2(s,e){try{const i=(await Wx()).transaction(vu,"readwrite");await i.objectStore(vu).put(e,Gx(s)),await i.done}catch(t){if(t instanceof mi)ua.warn(t.message);else{const i=Ja.create("idb-set",{originalErrorMessage:t?.message});ua.warn(i.message)}}}function Gx(s){return`${s.name}!${s.options.appId}`}const HN=1024,qN=30;class $N{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new GN(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=g2();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(l=>l.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>qN){const l=KN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){ua.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=g2(),{heartbeatsToSend:t,unsentEntries:i}=WN(this._heartbeatsCache.heartbeats),l=Dh(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(e){return ua.warn(e),""}}}function g2(){return new Date().toISOString().substring(0,10)}function WN(s,e=HN){const t=[];let i=s.slice();for(const l of s){const u=t.find(d=>d.agent===l.agent);if(u){if(u.dates.push(l.date),p2(t)>e){u.dates.pop();break}}else if(t.push({agent:l.agent,dates:[l.date]}),p2(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class GN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Fx()?Hx().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await FN(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return m2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return m2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function p2(s){return Dh(JSON.stringify({version:2,heartbeats:s})).length}function KN(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let i=1;i<s.length;i++)s[i].date<t&&(t=s[i].date,e=i);return e}function YN(s){ui(new Qr("platform-logger",e=>new oN(e),"PRIVATE")),ui(new Qr("heartbeat",e=>new $N(e),"PRIVATE")),vr(xp,h2,s),vr(xp,h2,"esm2020"),vr("fire-js","")}YN("");function Kx(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const QN=Kx,Yx=new Yo("auth","Firebase",Kx());const Oh=new oy("@firebase/auth");function XN(s,...e){Oh.logLevel<=Qt.WARN&&Oh.warn(`Auth (${Xo}): ${s}`,...e)}function kh(s,...e){Oh.logLevel<=Qt.ERROR&&Oh.error(`Auth (${Xo}): ${s}`,...e)}function di(s,...e){throw uy(s,...e)}function Ti(s,...e){return uy(s,...e)}function Qx(s,e,t){const i={...QN(),[e]:t};return new Yo("auth","Firebase",i).create(e,{appName:s.name})}function aa(s){return Qx(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function uy(s,...e){if(typeof s!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=s.name),s._errorFactory.create(t,...i)}return Yx.create(s,...e)}function xt(s,e,...t){if(!s)throw uy(e,...t)}function ea(s){const e="INTERNAL ASSERTION FAILED: "+s;throw kh(e),new Error(e)}function da(s,e){s||ea(e)}function jp(){return typeof self<"u"&&self.location?.href||""}function JN(){return y2()==="http:"||y2()==="https:"}function y2(){return typeof self<"u"&&self.location?.protocol||null}function ZN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(JN()||RC()||"connection"in navigator)?navigator.onLine:!0}function eA(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}class Du{constructor(e,t){this.shortDelay=e,this.longDelay=t,da(t>e,"Short delay should be less than long delay!"),this.isMobile=CC()||IC()}get(){return ZN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function dy(s,e){da(s.emulator,"Emulator should always be set here");const{url:t}=s.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class Xx{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ea("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ea("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ea("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const tA={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const nA=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],sA=new Du(3e4,6e4);function ma(s,e){return s.tenantId&&!e.tenantId?{...e,tenantId:s.tenantId}:e}async function ga(s,e,t,i,l={}){return Jx(s,l,async()=>{let u={},d={};i&&(e==="GET"?d=i:u={body:JSON.stringify(i)});const g=Iu({key:s.config.apiKey,...d}).slice(1),y=await s._getAdditionalHeaders();y["Content-Type"]="application/json",s.languageCode&&(y["X-Firebase-Locale"]=s.languageCode);const p={method:e,headers:y,...u};return AC()||(p.referrerPolicy="no-referrer"),s.emulatorConfig&&lo(s.emulatorConfig.host)&&(p.credentials="include"),Xx.fetch()(await Zx(s,s.config.apiHost,t,g),p)})}async function Jx(s,e,t){s._canInitEmulator=!1;const i={...tA,...e};try{const l=new iA(s),u=await Promise.race([t(),l.promise]);l.clearNetworkTimeout();const d=await u.json();if("needConfirmation"in d)throw lh(s,"account-exists-with-different-credential",d);if(u.ok&&!("errorMessage"in d))return d;{const g=u.ok?d.errorMessage:d.error.message,[y,p]=g.split(" : ");if(y==="FEDERATED_USER_ID_ALREADY_LINKED")throw lh(s,"credential-already-in-use",d);if(y==="EMAIL_EXISTS")throw lh(s,"email-already-in-use",d);if(y==="USER_DISABLED")throw lh(s,"user-disabled",d);const b=i[y]||y.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw Qx(s,b,p);di(s,b)}}catch(l){if(l instanceof mi)throw l;di(s,"network-request-failed",{message:String(l)})}}async function Lu(s,e,t,i,l={}){const u=await ga(s,e,t,i,l);return"mfaPendingCredential"in u&&di(s,"multi-factor-auth-required",{_serverResponse:u}),u}async function Zx(s,e,t,i){const l=`${e}${t}?${i}`,u=s,d=u.config.emulator?dy(s.config,l):`${s.config.apiScheme}://${l}`;return nA.includes(t)&&(await u._persistenceManagerAvailable,u._getPersistenceType()==="COOKIE")?u._getPersistence()._getFinalTarget(d).toString():d}function rA(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class iA{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Ti(this.auth,"network-request-failed")),sA.get())})}}function lh(s,e,t){const i={appName:s.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const l=Ti(s,e,i);return l.customData._tokenResponse=t,l}function v2(s){return s!==void 0&&s.enterprise!==void 0}class aA{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return rA(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function oA(s,e){return ga(s,"GET","/v2/recaptchaConfig",ma(s,e))}async function lA(s,e){return ga(s,"POST","/v1/accounts:delete",e)}async function Ph(s,e){return ga(s,"POST","/v1/accounts:lookup",e)}function uu(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function cA(s,e=!1){const t=vn(s),i=await t.getIdToken(e),l=hy(i);xt(l&&l.exp&&l.auth_time&&l.iat,t.auth,"internal-error");const u=typeof l.firebase=="object"?l.firebase:void 0,d=u?.sign_in_provider;return{claims:l,token:i,authTime:uu(zg(l.auth_time)),issuedAtTime:uu(zg(l.iat)),expirationTime:uu(zg(l.exp)),signInProvider:d||null,signInSecondFactor:u?.sign_in_second_factor||null}}function zg(s){return Number(s)*1e3}function hy(s){const[e,t,i]=s.split(".");if(e===void 0||t===void 0||i===void 0)return kh("JWT malformed, contained fewer than 3 sections"),null;try{const l=Ox(t);return l?JSON.parse(l):(kh("Failed to decode base64 JWT payload"),null)}catch(l){return kh("Caught error parsing JWT payload as JSON",l?.toString()),null}}function b2(s){const e=hy(s);return xt(e,"internal-error"),xt(typeof e.exp<"u","internal-error"),xt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function bu(s,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof mi&&uA(i)&&s.auth.currentUser===s&&await s.auth.signOut(),i}}function uA({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}class dA{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Ep{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=uu(this.lastLoginAt),this.creationTime=uu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Vh(s){const e=s.auth,t=await s.getIdToken(),i=await bu(s,Ph(e,{idToken:t}));xt(i?.users.length,e,"internal-error");const l=i.users[0];s._notifyReloadListener(l);const u=l.providerUserInfo?.length?e_(l.providerUserInfo):[],d=fA(s.providerData,u),g=s.isAnonymous,y=!(s.email&&l.passwordHash)&&!d?.length,p=g?y:!1,b={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:d,metadata:new Ep(l.createdAt,l.lastLoginAt),isAnonymous:p};Object.assign(s,b)}async function hA(s){const e=vn(s);await Vh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function fA(s,e){return[...s.filter(i=>!e.some(l=>l.providerId===i.providerId)),...e]}function e_(s){return s.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function mA(s,e){const t=await Jx(s,{},async()=>{const i=Iu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:l,apiKey:u}=s.config,d=await Zx(s,l,"/v1/token",`key=${u}`),g=await s._getAdditionalHeaders();g["Content-Type"]="application/x-www-form-urlencoded";const y={method:"POST",headers:g,body:i};return s.emulatorConfig&&lo(s.emulatorConfig.host)&&(y.credentials="include"),Xx.fetch()(d,y)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function gA(s,e){return ga(s,"POST","/v2/accounts:revokeToken",ma(s,e))}class zl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){xt(e.idToken,"internal-error"),xt(typeof e.idToken<"u","internal-error"),xt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):b2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){xt(e.length!==0,"internal-error");const t=b2(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(xt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:l,expiresIn:u}=await mA(e,t);this.updateTokensAndExpiration(i,l,Number(u))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:l,expirationTime:u}=t,d=new zl;return i&&(xt(typeof i=="string","internal-error",{appName:e}),d.refreshToken=i),l&&(xt(typeof l=="string","internal-error",{appName:e}),d.accessToken=l),u&&(xt(typeof u=="number","internal-error",{appName:e}),d.expirationTime=u),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new zl,this.toJSON())}_performRefresh(){return ea("not implemented")}}function qa(s,e){xt(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class oi{constructor({uid:e,auth:t,stsTokenManager:i,...l}){this.providerId="firebase",this.proactiveRefresh=new dA(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new Ep(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await bu(this,this.stsTokenManager.getToken(this.auth,e));return xt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return cA(this,e)}reload(){return hA(this)}_assign(e){this!==e&&(xt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new oi({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){xt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Vh(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Rr(this.auth.app))return Promise.reject(aa(this.auth));const e=await this.getIdToken();return await bu(this,lA(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,l=t.email??void 0,u=t.phoneNumber??void 0,d=t.photoURL??void 0,g=t.tenantId??void 0,y=t._redirectEventId??void 0,p=t.createdAt??void 0,b=t.lastLoginAt??void 0,{uid:j,emailVerified:S,isAnonymous:R,providerData:H,stsTokenManager:K}=t;xt(j&&K,e,"internal-error");const B=zl.fromJSON(this.name,K);xt(typeof j=="string",e,"internal-error"),qa(i,e.name),qa(l,e.name),xt(typeof S=="boolean",e,"internal-error"),xt(typeof R=="boolean",e,"internal-error"),qa(u,e.name),qa(d,e.name),qa(g,e.name),qa(y,e.name),qa(p,e.name),qa(b,e.name);const Y=new oi({uid:j,auth:e,email:l,emailVerified:S,displayName:i,isAnonymous:R,photoURL:d,phoneNumber:u,tenantId:g,stsTokenManager:B,createdAt:p,lastLoginAt:b});return H&&Array.isArray(H)&&(Y.providerData=H.map(Q=>({...Q}))),y&&(Y._redirectEventId=y),Y}static async _fromIdTokenResponse(e,t,i=!1){const l=new zl;l.updateFromServerResponse(t);const u=new oi({uid:t.localId,auth:e,stsTokenManager:l,isAnonymous:i});return await Vh(u),u}static async _fromGetAccountInfoResponse(e,t,i){const l=t.users[0];xt(l.localId!==void 0,"internal-error");const u=l.providerUserInfo!==void 0?e_(l.providerUserInfo):[],d=!(l.email&&l.passwordHash)&&!u?.length,g=new zl;g.updateFromIdToken(i);const y=new oi({uid:l.localId,auth:e,stsTokenManager:g,isAnonymous:d}),p={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:u,metadata:new Ep(l.createdAt,l.lastLoginAt),isAnonymous:!(l.email&&l.passwordHash)&&!u?.length};return Object.assign(y,p),y}}const w2=new Map;function ta(s){da(s instanceof Function,"Expected a class definition");let e=w2.get(s);return e?(da(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,w2.set(s,e),e)}class t_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}t_.type="NONE";const x2=t_;function jh(s,e,t){return`firebase:${s}:${e}:${t}`}class Fl{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:l,name:u}=this.auth;this.fullUserKey=jh(this.userKey,l.apiKey,u),this.fullPersistenceKey=jh("persistence",l.apiKey,u),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Ph(this.auth,{idToken:e}).catch(()=>{});return t?oi._fromGetAccountInfoResponse(this.auth,t,e):null}return oi._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Fl(ta(x2),e,i);const l=(await Promise.all(t.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let u=l[0]||ta(x2);const d=jh(i,e.config.apiKey,e.name);let g=null;for(const p of t)try{const b=await p._get(d);if(b){let j;if(typeof b=="string"){const S=await Ph(e,{idToken:b}).catch(()=>{});if(!S)break;j=await oi._fromGetAccountInfoResponse(e,S,b)}else j=oi._fromJSON(e,b);p!==u&&(g=j),u=p;break}}catch{}const y=l.filter(p=>p._shouldAllowMigration);return!u._shouldAllowMigration||!y.length?new Fl(u,e,i):(u=y[0],g&&await u._set(d,g.toJSON()),await Promise.all(t.map(async p=>{if(p!==u)try{await p._remove(d)}catch{}})),new Fl(u,e,i))}}function _2(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(i_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(n_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(o_(e))return"Blackberry";if(l_(e))return"Webos";if(s_(e))return"Safari";if((e.includes("chrome/")||r_(e))&&!e.includes("edge/"))return"Chrome";if(a_(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=s.match(t);if(i?.length===2)return i[1]}return"Other"}function n_(s=Ks()){return/firefox\//i.test(s)}function s_(s=Ks()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function r_(s=Ks()){return/crios\//i.test(s)}function i_(s=Ks()){return/iemobile/i.test(s)}function a_(s=Ks()){return/android/i.test(s)}function o_(s=Ks()){return/blackberry/i.test(s)}function l_(s=Ks()){return/webos/i.test(s)}function fy(s=Ks()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function pA(s=Ks()){return fy(s)&&!!window.navigator?.standalone}function yA(){return MC()&&document.documentMode===10}function c_(s=Ks()){return fy(s)||a_(s)||l_(s)||o_(s)||/windows phone/i.test(s)||i_(s)}function u_(s,e=[]){let t;switch(s){case"Browser":t=_2(Ks());break;case"Worker":t=`${_2(Ks())}-${s}`;break;default:t=s}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Xo}/${i}`}class vA{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=u=>new Promise((d,g)=>{try{const y=e(u);d(y)}catch(y){g(y)}});i.onAbort=t,this.queue.push(i);const l=this.queue.length-1;return()=>{this.queue[l]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const l of t)try{l()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function bA(s,e={}){return ga(s,"GET","/v2/passwordPolicy",ma(s,e))}const wA=6;class xA{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??wA,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,l=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),l&&(t.meetsMaxPasswordLength=e.length<=l)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let l=0;l<e.length;l++)i=e.charAt(l),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,l,u){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=l)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=u))}}class _A{constructor(e,t,i,l){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=l,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new k2(this),this.idTokenSubscription=new k2(this),this.beforeStateQueue=new vA(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Yx,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=l.sdkClientVersion,this._persistenceManagerAvailable=new Promise(u=>this._resolvePersistenceManagerAvailable=u)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ta(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Fl.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Ph(this,{idToken:e}),i=await oi._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Rr(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=this.redirectUser?._redirectEventId,d=i?._redirectEventId,g=await this.tryRedirectSignIn(e);(!u||u===d)&&g?.user&&(i=g.user,l=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return xt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Vh(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=eA()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Rr(this.app))return Promise.reject(aa(this));const t=e?vn(e):null;return t&&xt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&xt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Rr(this.app)?Promise.reject(aa(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Rr(this.app)?Promise.reject(aa(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ta(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await bA(this),t=new xA(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Yo("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await gA(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ta(e)||this._popupRedirectResolver;xt(t,this,"argument-error"),this.redirectPersistenceManager=await Fl.create(this,[ta(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,l){if(this._deleted)return()=>{};const u=typeof t=="function"?t:t.next.bind(t);let d=!1;const g=this._isInitialized?Promise.resolve():this._initializationPromise;if(xt(g,this,"internal-error"),g.then(()=>{d||u(this.currentUser)}),typeof t=="function"){const y=e.addObserver(t,i,l);return()=>{d=!0,y()}}else{const y=e.addObserver(t);return()=>{d=!0,y()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return xt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=u_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Rr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&XN(`Error while retrieving App Check token: ${e.error}`),e?.token}}function co(s){return vn(s)}class k2{constructor(e){this.auth=e,this.observer=null,this.addObserver=BC(t=>this.observer=t)}get next(){return xt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let of={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function kA(s){of=s}function d_(s){return of.loadJS(s)}function jA(){return of.recaptchaEnterpriseScript}function EA(){return of.gapiScript}function TA(s){return`__${s}${Math.floor(Math.random()*1e6)}`}class SA{constructor(){this.enterprise=new CA}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class CA{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const NA="recaptcha-enterprise",h_="NO_RECAPTCHA";class AA{constructor(e){this.type=NA,this.auth=co(e)}async verify(e="verify",t=!1){async function i(u){if(!t){if(u.tenantId==null&&u._agentRecaptchaConfig!=null)return u._agentRecaptchaConfig.siteKey;if(u.tenantId!=null&&u._tenantRecaptchaConfigs[u.tenantId]!==void 0)return u._tenantRecaptchaConfigs[u.tenantId].siteKey}return new Promise(async(d,g)=>{oA(u,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(y=>{if(y.recaptchaKey===void 0)g(new Error("recaptcha Enterprise site key undefined"));else{const p=new aA(y);return u.tenantId==null?u._agentRecaptchaConfig=p:u._tenantRecaptchaConfigs[u.tenantId]=p,d(p.siteKey)}}).catch(y=>{g(y)})})}function l(u,d,g){const y=window.grecaptcha;v2(y)?y.enterprise.ready(()=>{y.enterprise.execute(u,{action:e}).then(p=>{d(p)}).catch(()=>{d(h_)})}):g(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new SA().execute("siteKey",{action:"verify"}):new Promise((u,d)=>{i(this.auth).then(g=>{if(!t&&v2(window.grecaptcha))l(g,u,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let y=jA();y.length!==0&&(y+=g),d_(y).then(()=>{l(g,u,d)}).catch(p=>{d(p)})}}).catch(g=>{d(g)})})}}async function j2(s,e,t,i=!1,l=!1){const u=new AA(s);let d;if(l)d=h_;else try{d=await u.verify(t)}catch{d=await u.verify(t,!0)}const g={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in g){const y=g.phoneEnrollmentInfo.phoneNumber,p=g.phoneEnrollmentInfo.recaptchaToken;Object.assign(g,{phoneEnrollmentInfo:{phoneNumber:y,recaptchaToken:p,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in g){const y=g.phoneSignInInfo.recaptchaToken;Object.assign(g,{phoneSignInInfo:{recaptchaToken:y,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return g}return i?Object.assign(g,{captchaResp:d}):Object.assign(g,{captchaResponse:d}),Object.assign(g,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(g,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),g}async function Uh(s,e,t,i,l){if(s._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await j2(s,e,t,t==="getOobCode");return i(s,u)}else return i(s,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await j2(s,e,t,t==="getOobCode");return i(s,d)}else return Promise.reject(u)})}function RA(s,e){const t=Qo(s,"auth");if(t.isInitialized()){const l=t.getImmediate(),u=t.getOptions();if(ca(u,e??{}))return l;di(l,"already-initialized")}return t.initialize({options:e})}function IA(s,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(ta);e?.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(i,e?.popupRedirectResolver)}function MA(s,e,t){const i=co(s);xt(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const l=!1,u=f_(e),{host:d,port:g}=DA(e),y=g===null?"":`:${g}`,p={url:`${u}//${d}${y}/`},b=Object.freeze({host:d,port:g,protocol:u.replace(":",""),options:Object.freeze({disableWarnings:l})});if(!i._canInitEmulator){xt(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),xt(ca(p,i.config.emulator)&&ca(b,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=p,i.emulatorConfig=b,i.settings.appVerificationDisabledForTesting=!0,lo(d)?(iy(`${u}//${d}${y}`),ay("Auth",!0)):LA()}function f_(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function DA(s){const e=f_(s),t=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",l=/^(\[[^\]]+\])(:|$)/.exec(i);if(l){const u=l[1];return{host:u,port:E2(i.substr(u.length+1))}}else{const[u,d]=i.split(":");return{host:u,port:E2(d)}}}function E2(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function LA(){function s(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}class my{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ea("not implemented")}_getIdTokenResponse(e){return ea("not implemented")}_linkToIdToken(e,t){return ea("not implemented")}_getReauthenticationResolver(e){return ea("not implemented")}}async function OA(s,e){return ga(s,"POST","/v1/accounts:signUp",e)}async function PA(s,e){return Lu(s,"POST","/v1/accounts:signInWithPassword",ma(s,e))}async function m_(s,e){return ga(s,"POST","/v1/accounts:sendOobCode",ma(s,e))}async function VA(s,e){return m_(s,e)}async function UA(s,e){return m_(s,e)}async function BA(s,e){return Lu(s,"POST","/v1/accounts:signInWithEmailLink",ma(s,e))}async function zA(s,e){return Lu(s,"POST","/v1/accounts:signInWithEmailLink",ma(s,e))}class wu extends my{constructor(e,t,i,l=null){super("password",i),this._email=e,this._password=t,this._tenantId=l}static _fromEmailAndPassword(e,t){return new wu(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new wu(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Uh(e,t,"signInWithPassword",PA);case"emailLink":return BA(e,{email:this._email,oobCode:this._password});default:di(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Uh(e,i,"signUpPassword",OA);case"emailLink":return zA(e,{idToken:t,email:this._email,oobCode:this._password});default:di(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Hl(s,e){return Lu(s,"POST","/v1/accounts:signInWithIdp",ma(s,e))}const FA="http://localhost";class Uo extends my{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Uo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):di("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:l,...u}=t;if(!i||!l)return null;const d=new Uo(i,l);return d.idToken=u.idToken||void 0,d.accessToken=u.accessToken||void 0,d.secret=u.secret,d.nonce=u.nonce,d.pendingToken=u.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Hl(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Hl(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Hl(e,t)}buildRequest(){const e={requestUri:FA,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Iu(t)}return e}}function HA(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function qA(s){const e=su(ru(s)).link,t=e?su(ru(e)).deep_link_id:null,i=su(ru(s)).deep_link_id;return(i?su(ru(i)).link:null)||i||t||e||s}class gy{constructor(e){const t=su(ru(e)),i=t.apiKey??null,l=t.oobCode??null,u=HA(t.mode??null);xt(i&&l&&u,"argument-error"),this.apiKey=i,this.operation=u,this.code=l,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=qA(e);try{return new gy(t)}catch{return null}}}class rc{constructor(){this.providerId=rc.PROVIDER_ID}static credential(e,t){return wu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=gy.parseLink(t);return xt(i,"argument-error"),wu._fromEmailAndCode(e,i.code,i.tenantId)}}rc.PROVIDER_ID="password";rc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";rc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class g_{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Ou extends g_{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Wa extends Ou{constructor(){super("facebook.com")}static credential(e){return Uo._fromParams({providerId:Wa.PROVIDER_ID,signInMethod:Wa.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Wa.credentialFromTaggedObject(e)}static credentialFromError(e){return Wa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Wa.credential(e.oauthAccessToken)}catch{return null}}}Wa.FACEBOOK_SIGN_IN_METHOD="facebook.com";Wa.PROVIDER_ID="facebook.com";class Ga extends Ou{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Uo._fromParams({providerId:Ga.PROVIDER_ID,signInMethod:Ga.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ga.credentialFromTaggedObject(e)}static credentialFromError(e){return Ga.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Ga.credential(t,i)}catch{return null}}}Ga.GOOGLE_SIGN_IN_METHOD="google.com";Ga.PROVIDER_ID="google.com";class Ka extends Ou{constructor(){super("github.com")}static credential(e){return Uo._fromParams({providerId:Ka.PROVIDER_ID,signInMethod:Ka.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ka.credentialFromTaggedObject(e)}static credentialFromError(e){return Ka.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ka.credential(e.oauthAccessToken)}catch{return null}}}Ka.GITHUB_SIGN_IN_METHOD="github.com";Ka.PROVIDER_ID="github.com";class Ya extends Ou{constructor(){super("twitter.com")}static credential(e,t){return Uo._fromParams({providerId:Ya.PROVIDER_ID,signInMethod:Ya.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ya.credentialFromTaggedObject(e)}static credentialFromError(e){return Ya.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Ya.credential(t,i)}catch{return null}}}Ya.TWITTER_SIGN_IN_METHOD="twitter.com";Ya.PROVIDER_ID="twitter.com";async function $A(s,e){return Lu(s,"POST","/v1/accounts:signUp",ma(s,e))}class Bo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,l=!1){const u=await oi._fromIdTokenResponse(e,i,l),d=T2(i);return new Bo({user:u,providerId:d,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const l=T2(i);return new Bo({user:e,providerId:l,_tokenResponse:i,operationType:t})}}function T2(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}class Bh extends mi{constructor(e,t,i,l){super(t.code,t.message),this.operationType=i,this.user=l,Object.setPrototypeOf(this,Bh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,l){return new Bh(e,t,i,l)}}function p_(s,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(s):t._getIdTokenResponse(s)).catch(u=>{throw u.code==="auth/multi-factor-auth-required"?Bh._fromErrorAndOperation(s,u,e,i):u})}async function WA(s,e,t=!1){const i=await bu(s,e._linkToIdToken(s.auth,await s.getIdToken()),t);return Bo._forOperation(s,"link",i)}async function GA(s,e,t=!1){const{auth:i}=s;if(Rr(i.app))return Promise.reject(aa(i));const l="reauthenticate";try{const u=await bu(s,p_(i,l,e,s),t);xt(u.idToken,i,"internal-error");const d=hy(u.idToken);xt(d,i,"internal-error");const{sub:g}=d;return xt(s.uid===g,i,"user-mismatch"),Bo._forOperation(s,l,u)}catch(u){throw u?.code==="auth/user-not-found"&&di(i,"user-mismatch"),u}}async function y_(s,e,t=!1){if(Rr(s.app))return Promise.reject(aa(s));const i="signIn",l=await p_(s,i,e),u=await Bo._fromIdTokenResponse(s,i,l);return t||await s._updateCurrentUser(u.user),u}async function KA(s,e){return y_(co(s),e)}async function v_(s){const e=co(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function YA(s,e,t){const i=co(s);await Uh(i,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",UA)}async function QA(s,e,t){if(Rr(s.app))return Promise.reject(aa(s));const i=co(s),d=await Uh(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",$A).catch(y=>{throw y.code==="auth/password-does-not-meet-requirements"&&v_(s),y}),g=await Bo._fromIdTokenResponse(i,"signIn",d);return await i._updateCurrentUser(g.user),g}function XA(s,e,t){return Rr(s.app)?Promise.reject(aa(s)):KA(vn(s),rc.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&v_(s),i})}async function IO(s,e){const t=vn(s),l={requestType:"VERIFY_EMAIL",idToken:await s.getIdToken()},{email:u}=await VA(t.auth,l);u!==s.email&&await s.reload()}function S2(s,e){return vn(s).setPersistence(e)}function JA(s,e,t,i){return vn(s).onIdTokenChanged(e,t,i)}function ZA(s,e,t){return vn(s).beforeAuthStateChanged(e,t)}function e4(s,e,t,i){return vn(s).onAuthStateChanged(e,t,i)}function t4(s){return vn(s).signOut()}const zh="__sak";class b_{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(zh,"1"),this.storage.removeItem(zh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const n4=1e3,s4=10;class w_ extends b_{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=c_(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),l=this.localCache[t];i!==l&&e(t,l,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,g,y)=>{this.notifyListeners(d,y)});return}const i=e.key;t?this.detachListener():this.stopPolling();const l=()=>{const d=this.storage.getItem(i);!t&&this.localCache[i]===d||this.notifyListeners(i,d)},u=this.storage.getItem(i);yA()&&u!==e.newValue&&e.newValue!==e.oldValue?setTimeout(l,s4):l()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},n4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}w_.type="LOCAL";const Tp=w_;class x_ extends b_{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}x_.type="SESSION";const py=x_;function r4(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class lf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(l=>l.isListeningto(e));if(t)return t;const i=new lf(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:l,data:u}=t.data,d=this.handlersMap[l];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:l});const g=Array.from(d).map(async p=>p(t.origin,u)),y=await r4(g);t.ports[0].postMessage({status:"done",eventId:i,eventType:l,response:y})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}lf.receivers=[];function yy(s="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return s+t}class i4{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const l=typeof MessageChannel<"u"?new MessageChannel:null;if(!l)throw new Error("connection_unavailable");let u,d;return new Promise((g,y)=>{const p=yy("",20);l.port1.start();const b=setTimeout(()=>{y(new Error("unsupported_event"))},i);d={messageChannel:l,onMessage(j){const S=j;if(S.data.eventId===p)switch(S.data.status){case"ack":clearTimeout(b),u=setTimeout(()=>{y(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),g(S.data.response);break;default:clearTimeout(b),clearTimeout(u),y(new Error("invalid_response"));break}}},this.handlers.add(d),l.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:p,data:t},[l.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}function Si(){return window}function a4(s){Si().location.href=s}function __(){return typeof Si().WorkerGlobalScope<"u"&&typeof Si().importScripts=="function"}async function o4(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function l4(){return navigator?.serviceWorker?.controller||null}function c4(){return __()?self:null}const k_="firebaseLocalStorageDb",u4=1,Fh="firebaseLocalStorage",j_="fbase_key";class Pu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function cf(s,e){return s.transaction([Fh],e?"readwrite":"readonly").objectStore(Fh)}function d4(){const s=indexedDB.deleteDatabase(k_);return new Pu(s).toPromise()}function Sp(){const s=indexedDB.open(k_,u4);return new Promise((e,t)=>{s.addEventListener("error",()=>{t(s.error)}),s.addEventListener("upgradeneeded",()=>{const i=s.result;try{i.createObjectStore(Fh,{keyPath:j_})}catch(l){t(l)}}),s.addEventListener("success",async()=>{const i=s.result;i.objectStoreNames.contains(Fh)?e(i):(i.close(),await d4(),e(await Sp()))})})}async function C2(s,e,t){const i=cf(s,!0).put({[j_]:e,value:t});return new Pu(i).toPromise()}async function h4(s,e){const t=cf(s,!1).get(e),i=await new Pu(t).toPromise();return i===void 0?null:i.value}function N2(s,e){const t=cf(s,!0).delete(e);return new Pu(t).toPromise()}const f4=800,m4=3;class E_{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Sp(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>m4)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return __()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=lf._getInstance(c4()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await o4(),!this.activeServiceWorker)return;this.sender=new i4(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||l4()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Sp();return await C2(e,zh,"1"),await N2(e,zh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>C2(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>h4(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>N2(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(l=>{const u=cf(l,!1).getAll();return new Pu(u).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:l,value:u}of e)i.add(l),JSON.stringify(this.localCache[l])!==JSON.stringify(u)&&(this.notifyListeners(l,u),t.push(l));for(const l of Object.keys(this.localCache))this.localCache[l]&&!i.has(l)&&(this.notifyListeners(l,null),t.push(l));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),f4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}E_.type="LOCAL";const g4=E_;new Du(3e4,6e4);function p4(s,e){return e?ta(e):(xt(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}class vy extends my{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Hl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Hl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Hl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function y4(s){return y_(s.auth,new vy(s),s.bypassAuthState)}function v4(s){const{auth:e,user:t}=s;return xt(t,e,"internal-error"),GA(t,new vy(s),s.bypassAuthState)}async function b4(s){const{auth:e,user:t}=s;return xt(t,e,"internal-error"),WA(t,new vy(s),s.bypassAuthState)}class T_{constructor(e,t,i,l,u=!1){this.auth=e,this.resolver=i,this.user=l,this.bypassAuthState=u,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:l,tenantId:u,error:d,type:g}=e;if(d){this.reject(d);return}const y={auth:this.auth,requestUri:t,sessionId:i,tenantId:u||void 0,postBody:l||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(g)(y))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return y4;case"linkViaPopup":case"linkViaRedirect":return b4;case"reauthViaPopup":case"reauthViaRedirect":return v4;default:di(this.auth,"internal-error")}}resolve(e){da(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){da(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const w4=new Du(2e3,1e4);class Bl extends T_{constructor(e,t,i,l,u){super(e,t,l,u),this.provider=i,this.authWindow=null,this.pollId=null,Bl.currentPopupAction&&Bl.currentPopupAction.cancel(),Bl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return xt(e,this.auth,"internal-error"),e}async onExecution(){da(this.filter.length===1,"Popup operations only handle one event");const e=yy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ti(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Ti(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Bl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ti(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,w4.get())};e()}}Bl.currentPopupAction=null;const x4="pendingRedirect",Eh=new Map;class _4 extends T_{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Eh.get(this.auth._key());if(!e){try{const i=await k4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Eh.set(this.auth._key(),e)}return this.bypassAuthState||Eh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function k4(s,e){const t=T4(e),i=E4(s);if(!await i._isAvailable())return!1;const l=await i._get(t)==="true";return await i._remove(t),l}function j4(s,e){Eh.set(s._key(),e)}function E4(s){return ta(s._redirectPersistence)}function T4(s){return jh(x4,s.config.apiKey,s.name)}async function S4(s,e,t=!1){if(Rr(s.app))return Promise.reject(aa(s));const i=co(s),l=p4(i,e),d=await new _4(i,l,t).execute();return d&&!t&&(delete d.user._redirectEventId,await i._persistUserIfCurrent(d.user),await i._setRedirectUser(null,e)),d}const C4=600*1e3;class N4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!A4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!S_(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Ti(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=C4&&this.cachedEventUids.clear(),this.cachedEventUids.has(A2(e))}saveEventToCache(e){this.cachedEventUids.add(A2(e)),this.lastProcessedEventTime=Date.now()}}function A2(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function S_({type:s,error:e}){return s==="unknown"&&e?.code==="auth/no-auth-event"}function A4(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return S_(s);default:return!1}}async function R4(s,e={}){return ga(s,"GET","/v1/projects",e)}const I4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,M4=/^https?/;async function D4(s){if(s.config.emulator)return;const{authorizedDomains:e}=await R4(s);for(const t of e)try{if(L4(t))return}catch{}di(s,"unauthorized-domain")}function L4(s){const e=jp(),{protocol:t,hostname:i}=new URL(e);if(s.startsWith("chrome-extension://")){const d=new URL(s);return d.hostname===""&&i===""?t==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===i}if(!M4.test(t))return!1;if(I4.test(s))return i===s;const l=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+l+"|"+l+")$","i").test(i)}const O4=new Du(3e4,6e4);function R2(){const s=Si().___jsl;if(s?.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let t=0;t<s.CP.length;t++)s.CP[t]=null}}function P4(s){return new Promise((e,t)=>{function i(){R2(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{R2(),t(Ti(s,"network-request-failed"))},timeout:O4.get()})}if(Si().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Si().gapi?.load)i();else{const l=TA("iframefcb");return Si()[l]=()=>{gapi.load?i():t(Ti(s,"network-request-failed"))},d_(`${EA()}?onload=${l}`).catch(u=>t(u))}}).catch(e=>{throw Th=null,e})}let Th=null;function V4(s){return Th=Th||P4(s),Th}const U4=new Du(5e3,15e3),B4="__/auth/iframe",z4="emulator/auth/iframe",F4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},H4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function q4(s){const e=s.config;xt(e.authDomain,s,"auth-domain-config-required");const t=e.emulator?dy(e,z4):`https://${s.config.authDomain}/${B4}`,i={apiKey:e.apiKey,appName:s.name,v:Xo},l=H4.get(s.config.apiHost);l&&(i.eid=l);const u=s._getFrameworks();return u.length&&(i.fw=u.join(",")),`${t}?${Iu(i).slice(1)}`}async function $4(s){const e=await V4(s),t=Si().gapi;return xt(t,s,"internal-error"),e.open({where:document.body,url:q4(s),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:F4,dontclear:!0},i=>new Promise(async(l,u)=>{await i.restyle({setHideOnLeave:!1});const d=Ti(s,"network-request-failed"),g=Si().setTimeout(()=>{u(d)},U4.get());function y(){Si().clearTimeout(g),l(i)}i.ping(y).then(y,()=>{u(d)})}))}const W4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},G4=500,K4=600,Y4="_blank",Q4="http://localhost";class I2{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function X4(s,e,t,i=G4,l=K4){const u=Math.max((window.screen.availHeight-l)/2,0).toString(),d=Math.max((window.screen.availWidth-i)/2,0).toString();let g="";const y={...W4,width:i.toString(),height:l.toString(),top:u,left:d},p=Ks().toLowerCase();t&&(g=r_(p)?Y4:t),n_(p)&&(e=e||Q4,y.scrollbars="yes");const b=Object.entries(y).reduce((S,[R,H])=>`${S}${R}=${H},`,"");if(pA(p)&&g!=="_self")return J4(e||"",g),new I2(null);const j=window.open(e||"",g,b);xt(j,s,"popup-blocked");try{j.focus()}catch{}return new I2(j)}function J4(s,e){const t=document.createElement("a");t.href=s,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const Z4="__/auth/handler",eR="emulator/auth/handler",tR=encodeURIComponent("fac");async function M2(s,e,t,i,l,u){xt(s.config.authDomain,s,"auth-domain-config-required"),xt(s.config.apiKey,s,"invalid-api-key");const d={apiKey:s.config.apiKey,appName:s.name,authType:t,redirectUrl:i,v:Xo,eventId:l};if(e instanceof g_){e.setDefaultLanguage(s.languageCode),d.providerId=e.providerId||"",UC(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[b,j]of Object.entries({}))d[b]=j}if(e instanceof Ou){const b=e.getScopes().filter(j=>j!=="");b.length>0&&(d.scopes=b.join(","))}s.tenantId&&(d.tid=s.tenantId);const g=d;for(const b of Object.keys(g))g[b]===void 0&&delete g[b];const y=await s._getAppCheckToken(),p=y?`#${tR}=${encodeURIComponent(y)}`:"";return`${nR(s)}?${Iu(g).slice(1)}${p}`}function nR({config:s}){return s.emulator?dy(s,eR):`https://${s.authDomain}/${Z4}`}const Fg="webStorageSupport";class sR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=py,this._completeRedirectFn=S4,this._overrideRedirectResult=j4}async _openPopup(e,t,i,l){da(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const u=await M2(e,t,i,jp(),l);return X4(e,u,yy())}async _openRedirect(e,t,i,l){await this._originValidation(e);const u=await M2(e,t,i,jp(),l);return a4(u),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:l,promise:u}=this.eventManagers[t];return l?Promise.resolve(l):(da(u,"If manager is not set, promise should be"),u)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await $4(e),i=new N4(e);return t.register("authEvent",l=>(xt(l?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(l.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Fg,{type:Fg},l=>{const u=l?.[0]?.[Fg];u!==void 0&&t(!!u),di(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=D4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return c_()||s_()||fy()}}const rR=sR;var D2="@firebase/auth",L2="1.12.0";class iR{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){xt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function aR(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function oR(s){ui(new Qr("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),l=e.getProvider("heartbeat"),u=e.getProvider("app-check-internal"),{apiKey:d,authDomain:g}=i.options;xt(d&&!d.includes(":"),"invalid-api-key",{appName:i.name});const y={apiKey:d,authDomain:g,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:u_(s)},p=new _A(i,l,u,y);return IA(p,t),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),ui(new Qr("auth-internal",e=>{const t=co(e.getProvider("auth").getImmediate());return(i=>new iR(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),vr(D2,L2,aR(s)),vr(D2,L2,"esm2020")}const lR=300,cR=Bx("authIdTokenMaxAge")||lR;let O2=null;const uR=s=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>cR)return;const l=t?.token;O2!==l&&(O2=l,await fetch(s,{method:l?"POST":"DELETE",headers:l?{Authorization:`Bearer ${l}`}:{}}))};function C_(s=Mu()){const e=Qo(s,"auth");if(e.isInitialized())return e.getImmediate();const t=RA(s,{popupRedirectResolver:rR,persistence:[g4,Tp,py]}),i=Bx("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const u=new URL(i,location.origin);if(location.origin===u.origin){const d=uR(u.toString());ZA(t,d,()=>d(t.currentUser)),JA(t,g=>d(g))}}const l=Px("auth");return l&&MA(t,`http://${l}`),t}function dR(){return document.getElementsByTagName("head")?.[0]??document}kA({loadJS(s){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",s),i.onload=e,i.onerror=l=>{const u=Ti("internal-error");u.customData=l,t(u)},i.type="text/javascript",i.charset="UTF-8",dR().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});oR("Browser");var P2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Za,N_;(function(){var s;function e(I,T){function L(){}L.prototype=T.prototype,I.F=T.prototype,I.prototype=new L,I.prototype.constructor=I,I.D=function(V,P,D){for(var M=Array(arguments.length-2),Me=2;Me<arguments.length;Me++)M[Me-2]=arguments[Me];return T.prototype[P].apply(V,M)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function l(I,T,L){L||(L=0);const V=Array(16);if(typeof T=="string")for(var P=0;P<16;++P)V[P]=T.charCodeAt(L++)|T.charCodeAt(L++)<<8|T.charCodeAt(L++)<<16|T.charCodeAt(L++)<<24;else for(P=0;P<16;++P)V[P]=T[L++]|T[L++]<<8|T[L++]<<16|T[L++]<<24;T=I.g[0],L=I.g[1],P=I.g[2];let D=I.g[3],M;M=T+(D^L&(P^D))+V[0]+3614090360&4294967295,T=L+(M<<7&4294967295|M>>>25),M=D+(P^T&(L^P))+V[1]+3905402710&4294967295,D=T+(M<<12&4294967295|M>>>20),M=P+(L^D&(T^L))+V[2]+606105819&4294967295,P=D+(M<<17&4294967295|M>>>15),M=L+(T^P&(D^T))+V[3]+3250441966&4294967295,L=P+(M<<22&4294967295|M>>>10),M=T+(D^L&(P^D))+V[4]+4118548399&4294967295,T=L+(M<<7&4294967295|M>>>25),M=D+(P^T&(L^P))+V[5]+1200080426&4294967295,D=T+(M<<12&4294967295|M>>>20),M=P+(L^D&(T^L))+V[6]+2821735955&4294967295,P=D+(M<<17&4294967295|M>>>15),M=L+(T^P&(D^T))+V[7]+4249261313&4294967295,L=P+(M<<22&4294967295|M>>>10),M=T+(D^L&(P^D))+V[8]+1770035416&4294967295,T=L+(M<<7&4294967295|M>>>25),M=D+(P^T&(L^P))+V[9]+2336552879&4294967295,D=T+(M<<12&4294967295|M>>>20),M=P+(L^D&(T^L))+V[10]+4294925233&4294967295,P=D+(M<<17&4294967295|M>>>15),M=L+(T^P&(D^T))+V[11]+2304563134&4294967295,L=P+(M<<22&4294967295|M>>>10),M=T+(D^L&(P^D))+V[12]+1804603682&4294967295,T=L+(M<<7&4294967295|M>>>25),M=D+(P^T&(L^P))+V[13]+4254626195&4294967295,D=T+(M<<12&4294967295|M>>>20),M=P+(L^D&(T^L))+V[14]+2792965006&4294967295,P=D+(M<<17&4294967295|M>>>15),M=L+(T^P&(D^T))+V[15]+1236535329&4294967295,L=P+(M<<22&4294967295|M>>>10),M=T+(P^D&(L^P))+V[1]+4129170786&4294967295,T=L+(M<<5&4294967295|M>>>27),M=D+(L^P&(T^L))+V[6]+3225465664&4294967295,D=T+(M<<9&4294967295|M>>>23),M=P+(T^L&(D^T))+V[11]+643717713&4294967295,P=D+(M<<14&4294967295|M>>>18),M=L+(D^T&(P^D))+V[0]+3921069994&4294967295,L=P+(M<<20&4294967295|M>>>12),M=T+(P^D&(L^P))+V[5]+3593408605&4294967295,T=L+(M<<5&4294967295|M>>>27),M=D+(L^P&(T^L))+V[10]+38016083&4294967295,D=T+(M<<9&4294967295|M>>>23),M=P+(T^L&(D^T))+V[15]+3634488961&4294967295,P=D+(M<<14&4294967295|M>>>18),M=L+(D^T&(P^D))+V[4]+3889429448&4294967295,L=P+(M<<20&4294967295|M>>>12),M=T+(P^D&(L^P))+V[9]+568446438&4294967295,T=L+(M<<5&4294967295|M>>>27),M=D+(L^P&(T^L))+V[14]+3275163606&4294967295,D=T+(M<<9&4294967295|M>>>23),M=P+(T^L&(D^T))+V[3]+4107603335&4294967295,P=D+(M<<14&4294967295|M>>>18),M=L+(D^T&(P^D))+V[8]+1163531501&4294967295,L=P+(M<<20&4294967295|M>>>12),M=T+(P^D&(L^P))+V[13]+2850285829&4294967295,T=L+(M<<5&4294967295|M>>>27),M=D+(L^P&(T^L))+V[2]+4243563512&4294967295,D=T+(M<<9&4294967295|M>>>23),M=P+(T^L&(D^T))+V[7]+1735328473&4294967295,P=D+(M<<14&4294967295|M>>>18),M=L+(D^T&(P^D))+V[12]+2368359562&4294967295,L=P+(M<<20&4294967295|M>>>12),M=T+(L^P^D)+V[5]+4294588738&4294967295,T=L+(M<<4&4294967295|M>>>28),M=D+(T^L^P)+V[8]+2272392833&4294967295,D=T+(M<<11&4294967295|M>>>21),M=P+(D^T^L)+V[11]+1839030562&4294967295,P=D+(M<<16&4294967295|M>>>16),M=L+(P^D^T)+V[14]+4259657740&4294967295,L=P+(M<<23&4294967295|M>>>9),M=T+(L^P^D)+V[1]+2763975236&4294967295,T=L+(M<<4&4294967295|M>>>28),M=D+(T^L^P)+V[4]+1272893353&4294967295,D=T+(M<<11&4294967295|M>>>21),M=P+(D^T^L)+V[7]+4139469664&4294967295,P=D+(M<<16&4294967295|M>>>16),M=L+(P^D^T)+V[10]+3200236656&4294967295,L=P+(M<<23&4294967295|M>>>9),M=T+(L^P^D)+V[13]+681279174&4294967295,T=L+(M<<4&4294967295|M>>>28),M=D+(T^L^P)+V[0]+3936430074&4294967295,D=T+(M<<11&4294967295|M>>>21),M=P+(D^T^L)+V[3]+3572445317&4294967295,P=D+(M<<16&4294967295|M>>>16),M=L+(P^D^T)+V[6]+76029189&4294967295,L=P+(M<<23&4294967295|M>>>9),M=T+(L^P^D)+V[9]+3654602809&4294967295,T=L+(M<<4&4294967295|M>>>28),M=D+(T^L^P)+V[12]+3873151461&4294967295,D=T+(M<<11&4294967295|M>>>21),M=P+(D^T^L)+V[15]+530742520&4294967295,P=D+(M<<16&4294967295|M>>>16),M=L+(P^D^T)+V[2]+3299628645&4294967295,L=P+(M<<23&4294967295|M>>>9),M=T+(P^(L|~D))+V[0]+4096336452&4294967295,T=L+(M<<6&4294967295|M>>>26),M=D+(L^(T|~P))+V[7]+1126891415&4294967295,D=T+(M<<10&4294967295|M>>>22),M=P+(T^(D|~L))+V[14]+2878612391&4294967295,P=D+(M<<15&4294967295|M>>>17),M=L+(D^(P|~T))+V[5]+4237533241&4294967295,L=P+(M<<21&4294967295|M>>>11),M=T+(P^(L|~D))+V[12]+1700485571&4294967295,T=L+(M<<6&4294967295|M>>>26),M=D+(L^(T|~P))+V[3]+2399980690&4294967295,D=T+(M<<10&4294967295|M>>>22),M=P+(T^(D|~L))+V[10]+4293915773&4294967295,P=D+(M<<15&4294967295|M>>>17),M=L+(D^(P|~T))+V[1]+2240044497&4294967295,L=P+(M<<21&4294967295|M>>>11),M=T+(P^(L|~D))+V[8]+1873313359&4294967295,T=L+(M<<6&4294967295|M>>>26),M=D+(L^(T|~P))+V[15]+4264355552&4294967295,D=T+(M<<10&4294967295|M>>>22),M=P+(T^(D|~L))+V[6]+2734768916&4294967295,P=D+(M<<15&4294967295|M>>>17),M=L+(D^(P|~T))+V[13]+1309151649&4294967295,L=P+(M<<21&4294967295|M>>>11),M=T+(P^(L|~D))+V[4]+4149444226&4294967295,T=L+(M<<6&4294967295|M>>>26),M=D+(L^(T|~P))+V[11]+3174756917&4294967295,D=T+(M<<10&4294967295|M>>>22),M=P+(T^(D|~L))+V[2]+718787259&4294967295,P=D+(M<<15&4294967295|M>>>17),M=L+(D^(P|~T))+V[9]+3951481745&4294967295,I.g[0]=I.g[0]+T&4294967295,I.g[1]=I.g[1]+(P+(M<<21&4294967295|M>>>11))&4294967295,I.g[2]=I.g[2]+P&4294967295,I.g[3]=I.g[3]+D&4294967295}i.prototype.v=function(I,T){T===void 0&&(T=I.length);const L=T-this.blockSize,V=this.C;let P=this.h,D=0;for(;D<T;){if(P==0)for(;D<=L;)l(this,I,D),D+=this.blockSize;if(typeof I=="string"){for(;D<T;)if(V[P++]=I.charCodeAt(D++),P==this.blockSize){l(this,V),P=0;break}}else for(;D<T;)if(V[P++]=I[D++],P==this.blockSize){l(this,V),P=0;break}}this.h=P,this.o+=T},i.prototype.A=function(){var I=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);I[0]=128;for(var T=1;T<I.length-8;++T)I[T]=0;T=this.o*8;for(var L=I.length-8;L<I.length;++L)I[L]=T&255,T/=256;for(this.v(I),I=Array(16),T=0,L=0;L<4;++L)for(let V=0;V<32;V+=8)I[T++]=this.g[L]>>>V&255;return I};function u(I,T){var L=g;return Object.prototype.hasOwnProperty.call(L,I)?L[I]:L[I]=T(I)}function d(I,T){this.h=T;const L=[];let V=!0;for(let P=I.length-1;P>=0;P--){const D=I[P]|0;V&&D==T||(L[P]=D,V=!1)}this.g=L}var g={};function y(I){return-128<=I&&I<128?u(I,function(T){return new d([T|0],T<0?-1:0)}):new d([I|0],I<0?-1:0)}function p(I){if(isNaN(I)||!isFinite(I))return j;if(I<0)return B(p(-I));const T=[];let L=1;for(let V=0;I>=L;V++)T[V]=I/L|0,L*=4294967296;return new d(T,0)}function b(I,T){if(I.length==0)throw Error("number format error: empty string");if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(I.charAt(0)=="-")return B(b(I.substring(1),T));if(I.indexOf("-")>=0)throw Error('number format error: interior "-" character');const L=p(Math.pow(T,8));let V=j;for(let D=0;D<I.length;D+=8){var P=Math.min(8,I.length-D);const M=parseInt(I.substring(D,D+P),T);P<8?(P=p(Math.pow(T,P)),V=V.j(P).add(p(M))):(V=V.j(L),V=V.add(p(M)))}return V}var j=y(0),S=y(1),R=y(16777216);s=d.prototype,s.m=function(){if(K(this))return-B(this).m();let I=0,T=1;for(let L=0;L<this.g.length;L++){const V=this.i(L);I+=(V>=0?V:4294967296+V)*T,T*=4294967296}return I},s.toString=function(I){if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(H(this))return"0";if(K(this))return"-"+B(this).toString(I);const T=p(Math.pow(I,6));var L=this;let V="";for(;;){const P=ge(L,T).g;L=Y(L,P.j(T));let D=((L.g.length>0?L.g[0]:L.h)>>>0).toString(I);if(L=P,H(L))return D+V;for(;D.length<6;)D="0"+D;V=D+V}},s.i=function(I){return I<0?0:I<this.g.length?this.g[I]:this.h};function H(I){if(I.h!=0)return!1;for(let T=0;T<I.g.length;T++)if(I.g[T]!=0)return!1;return!0}function K(I){return I.h==-1}s.l=function(I){return I=Y(this,I),K(I)?-1:H(I)?0:1};function B(I){const T=I.g.length,L=[];for(let V=0;V<T;V++)L[V]=~I.g[V];return new d(L,~I.h).add(S)}s.abs=function(){return K(this)?B(this):this},s.add=function(I){const T=Math.max(this.g.length,I.g.length),L=[];let V=0;for(let P=0;P<=T;P++){let D=V+(this.i(P)&65535)+(I.i(P)&65535),M=(D>>>16)+(this.i(P)>>>16)+(I.i(P)>>>16);V=M>>>16,D&=65535,M&=65535,L[P]=M<<16|D}return new d(L,L[L.length-1]&-2147483648?-1:0)};function Y(I,T){return I.add(B(T))}s.j=function(I){if(H(this)||H(I))return j;if(K(this))return K(I)?B(this).j(B(I)):B(B(this).j(I));if(K(I))return B(this.j(B(I)));if(this.l(R)<0&&I.l(R)<0)return p(this.m()*I.m());const T=this.g.length+I.g.length,L=[];for(var V=0;V<2*T;V++)L[V]=0;for(V=0;V<this.g.length;V++)for(let P=0;P<I.g.length;P++){const D=this.i(V)>>>16,M=this.i(V)&65535,Me=I.i(P)>>>16,st=I.i(P)&65535;L[2*V+2*P]+=M*st,Q(L,2*V+2*P),L[2*V+2*P+1]+=D*st,Q(L,2*V+2*P+1),L[2*V+2*P+1]+=M*Me,Q(L,2*V+2*P+1),L[2*V+2*P+2]+=D*Me,Q(L,2*V+2*P+2)}for(I=0;I<T;I++)L[I]=L[2*I+1]<<16|L[2*I];for(I=T;I<2*T;I++)L[I]=0;return new d(L,0)};function Q(I,T){for(;(I[T]&65535)!=I[T];)I[T+1]+=I[T]>>>16,I[T]&=65535,T++}function Z(I,T){this.g=I,this.h=T}function ge(I,T){if(H(T))throw Error("division by zero");if(H(I))return new Z(j,j);if(K(I))return T=ge(B(I),T),new Z(B(T.g),B(T.h));if(K(T))return T=ge(I,B(T)),new Z(B(T.g),T.h);if(I.g.length>30){if(K(I)||K(T))throw Error("slowDivide_ only works with positive integers.");for(var L=S,V=T;V.l(I)<=0;)L=xe(L),V=xe(V);var P=pe(L,1),D=pe(V,1);for(V=pe(V,2),L=pe(L,2);!H(V);){var M=D.add(V);M.l(I)<=0&&(P=P.add(L),D=M),V=pe(V,1),L=pe(L,1)}return T=Y(I,P.j(T)),new Z(P,T)}for(P=j;I.l(T)>=0;){for(L=Math.max(1,Math.floor(I.m()/T.m())),V=Math.ceil(Math.log(L)/Math.LN2),V=V<=48?1:Math.pow(2,V-48),D=p(L),M=D.j(T);K(M)||M.l(I)>0;)L-=V,D=p(L),M=D.j(T);H(D)&&(D=S),P=P.add(D),I=Y(I,M)}return new Z(P,I)}s.B=function(I){return ge(this,I).h},s.and=function(I){const T=Math.max(this.g.length,I.g.length),L=[];for(let V=0;V<T;V++)L[V]=this.i(V)&I.i(V);return new d(L,this.h&I.h)},s.or=function(I){const T=Math.max(this.g.length,I.g.length),L=[];for(let V=0;V<T;V++)L[V]=this.i(V)|I.i(V);return new d(L,this.h|I.h)},s.xor=function(I){const T=Math.max(this.g.length,I.g.length),L=[];for(let V=0;V<T;V++)L[V]=this.i(V)^I.i(V);return new d(L,this.h^I.h)};function xe(I){const T=I.g.length+1,L=[];for(let V=0;V<T;V++)L[V]=I.i(V)<<1|I.i(V-1)>>>31;return new d(L,I.h)}function pe(I,T){const L=T>>5;T%=32;const V=I.g.length-L,P=[];for(let D=0;D<V;D++)P[D]=T>0?I.i(D+L)>>>T|I.i(D+L+1)<<32-T:I.i(D+L);return new d(P,I.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,N_=i,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.B,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=p,d.fromString=b,Za=d}).apply(typeof P2<"u"?P2:typeof self<"u"?self:typeof window<"u"?window:{});var ch=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var A_,iu,R_,Sh,Cp,I_,M_,D_;(function(){var s,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof ch=="object"&&ch];for(var v=0;v<h.length;++v){var _=h[v];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var i=t(this);function l(h,v){if(v)e:{var _=i;h=h.split(".");for(var A=0;A<h.length-1;A++){var ne=h[A];if(!(ne in _))break e;_=_[ne]}h=h[h.length-1],A=_[h],v=v(A),v!=A&&v!=null&&e(_,h,{configurable:!0,writable:!0,value:v})}}l("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),l("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),l("Object.entries",function(h){return h||function(v){var _=[],A;for(A in v)Object.prototype.hasOwnProperty.call(v,A)&&_.push([A,v[A]]);return _}});var u=u||{},d=this||self;function g(h){var v=typeof h;return v=="object"&&h!=null||v=="function"}function y(h,v,_){return h.call.apply(h.bind,arguments)}function p(h,v,_){return p=y,p.apply(null,arguments)}function b(h,v){var _=Array.prototype.slice.call(arguments,1);return function(){var A=_.slice();return A.push.apply(A,arguments),h.apply(this,A)}}function j(h,v){function _(){}_.prototype=v.prototype,h.Z=v.prototype,h.prototype=new _,h.prototype.constructor=h,h.Ob=function(A,ne,he){for(var Be=Array(arguments.length-2),Rt=2;Rt<arguments.length;Rt++)Be[Rt-2]=arguments[Rt];return v.prototype[ne].apply(A,Be)}}var S=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function R(h){const v=h.length;if(v>0){const _=Array(v);for(let A=0;A<v;A++)_[A]=h[A];return _}return[]}function H(h,v){for(let A=1;A<arguments.length;A++){const ne=arguments[A];var _=typeof ne;if(_=_!="object"?_:ne?Array.isArray(ne)?"array":_:"null",_=="array"||_=="object"&&typeof ne.length=="number"){_=h.length||0;const he=ne.length||0;h.length=_+he;for(let Be=0;Be<he;Be++)h[_+Be]=ne[Be]}else h.push(ne)}}class K{constructor(v,_){this.i=v,this.j=_,this.h=0,this.g=null}get(){let v;return this.h>0?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function B(h){d.setTimeout(()=>{throw h},0)}function Y(){var h=I;let v=null;return h.g&&(v=h.g,h.g=h.g.next,h.g||(h.h=null),v.next=null),v}class Q{constructor(){this.h=this.g=null}add(v,_){const A=Z.get();A.set(v,_),this.h?this.h.next=A:this.g=A,this.h=A}}var Z=new K(()=>new ge,h=>h.reset());class ge{constructor(){this.next=this.g=this.h=null}set(v,_){this.h=v,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let xe,pe=!1,I=new Q,T=()=>{const h=Promise.resolve(void 0);xe=()=>{h.then(L)}};function L(){for(var h;h=Y();){try{h.h.call(h.g)}catch(_){B(_)}var v=Z;v.j(h),v.h<100&&(v.h++,h.next=v.g,v.g=h)}pe=!1}function V(){this.u=this.u,this.C=this.C}V.prototype.u=!1,V.prototype.dispose=function(){this.u||(this.u=!0,this.N())},V.prototype[Symbol.dispose]=function(){this.dispose()},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function P(h,v){this.type=h,this.g=this.target=v,this.defaultPrevented=!1}P.prototype.h=function(){this.defaultPrevented=!0};var D=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var h=!1,v=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const _=()=>{};d.addEventListener("test",_,v),d.removeEventListener("test",_,v)}catch{}return h})();function M(h){return/^[\s\xa0]*$/.test(h)}function Me(h,v){P.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,v)}j(Me,P),Me.prototype.init=function(h,v){const _=this.type=h.type,A=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=v,v=h.relatedTarget,v||(_=="mouseover"?v=h.fromElement:_=="mouseout"&&(v=h.toElement)),this.relatedTarget=v,A?(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&Me.Z.h.call(this)},Me.prototype.h=function(){Me.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var st="closure_listenable_"+(Math.random()*1e6|0),J=0;function Te(h,v,_,A,ne){this.listener=h,this.proxy=null,this.src=v,this.type=_,this.capture=!!A,this.ha=ne,this.key=++J,this.da=this.fa=!1}function Ue(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Ne(h,v,_){for(const A in h)v.call(_,h[A],A,h)}function ze(h,v){for(const _ in h)v.call(void 0,h[_],_,h)}function U(h){const v={};for(const _ in h)v[_]=h[_];return v}const le="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ce(h,v){let _,A;for(let ne=1;ne<arguments.length;ne++){A=arguments[ne];for(_ in A)h[_]=A[_];for(let he=0;he<le.length;he++)_=le[he],Object.prototype.hasOwnProperty.call(A,_)&&(h[_]=A[_])}}function Se(h){this.src=h,this.g={},this.h=0}Se.prototype.add=function(h,v,_,A,ne){const he=h.toString();h=this.g[he],h||(h=this.g[he]=[],this.h++);const Be=Oe(h,v,A,ne);return Be>-1?(v=h[Be],_||(v.fa=!1)):(v=new Te(v,this.src,he,!!A,ne),v.fa=_,h.push(v)),v};function ve(h,v){const _=v.type;if(_ in h.g){var A=h.g[_],ne=Array.prototype.indexOf.call(A,v,void 0),he;(he=ne>=0)&&Array.prototype.splice.call(A,ne,1),he&&(Ue(v),h.g[_].length==0&&(delete h.g[_],h.h--))}}function Oe(h,v,_,A){for(let ne=0;ne<h.length;++ne){const he=h[ne];if(!he.da&&he.listener==v&&he.capture==!!_&&he.ha==A)return ne}return-1}var Fe="closure_lm_"+(Math.random()*1e6|0),Ge={};function tt(h,v,_,A,ne){if(Array.isArray(v)){for(let he=0;he<v.length;he++)tt(h,v[he],_,A,ne);return null}return _=Vt(_),h&&h[st]?h.J(v,_,g(A)?!!A.capture:!1,ne):sn(h,v,_,!1,A,ne)}function sn(h,v,_,A,ne,he){if(!v)throw Error("Invalid event type");const Be=g(ne)?!!ne.capture:!!ne;let Rt=Bt(h);if(Rt||(h[Fe]=Rt=new Se(h)),_=Rt.add(v,_,A,Be,he),_.proxy)return _;if(A=Tt(),_.proxy=A,A.src=h,A.listener=_,h.addEventListener)D||(ne=Be),ne===void 0&&(ne=!1),h.addEventListener(v.toString(),A,ne);else if(h.attachEvent)h.attachEvent(Mt(v.toString()),A);else if(h.addListener&&h.removeListener)h.addListener(A);else throw Error("addEventListener and attachEvent are unavailable.");return _}function Tt(){function h(_){return v.call(h.src,h.listener,_)}const v=ct;return h}function _n(h,v,_,A,ne){if(Array.isArray(v))for(var he=0;he<v.length;he++)_n(h,v[he],_,A,ne);else A=g(A)?!!A.capture:!!A,_=Vt(_),h&&h[st]?(h=h.i,he=String(v).toString(),he in h.g&&(v=h.g[he],_=Oe(v,_,A,ne),_>-1&&(Ue(v[_]),Array.prototype.splice.call(v,_,1),v.length==0&&(delete h.g[he],h.h--)))):h&&(h=Bt(h))&&(v=h.g[v.toString()],h=-1,v&&(h=Oe(v,_,A,ne)),(_=h>-1?v[h]:null)&&gn(_))}function gn(h){if(typeof h!="number"&&h&&!h.da){var v=h.src;if(v&&v[st])ve(v.i,h);else{var _=h.type,A=h.proxy;v.removeEventListener?v.removeEventListener(_,A,h.capture):v.detachEvent?v.detachEvent(Mt(_),A):v.addListener&&v.removeListener&&v.removeListener(A),(_=Bt(v))?(ve(_,h),_.h==0&&(_.src=null,v[Fe]=null)):Ue(h)}}}function Mt(h){return h in Ge?Ge[h]:Ge[h]="on"+h}function ct(h,v){if(h.da)h=!0;else{v=new Me(v,this);const _=h.listener,A=h.ha||h.src;h.fa&&gn(h),h=_.call(A,v)}return h}function Bt(h){return h=h[Fe],h instanceof Se?h:null}var rt="__closure_events_fn_"+(Math.random()*1e9>>>0);function Vt(h){return typeof h=="function"?h:(h[rt]||(h[rt]=function(v){return h.handleEvent(v)}),h[rt])}function ue(){V.call(this),this.i=new Se(this),this.M=this,this.G=null}j(ue,V),ue.prototype[st]=!0,ue.prototype.removeEventListener=function(h,v,_,A){_n(this,h,v,_,A)};function kt(h,v){var _,A=h.G;if(A)for(_=[];A;A=A.G)_.push(A);if(h=h.M,A=v.type||v,typeof v=="string")v=new P(v,h);else if(v instanceof P)v.target=v.target||h;else{var ne=v;v=new P(A,h),Ce(v,ne)}ne=!0;let he,Be;if(_)for(Be=_.length-1;Be>=0;Be--)he=v.g=_[Be],ne=jt(he,A,!0,v)&&ne;if(he=v.g=h,ne=jt(he,A,!0,v)&&ne,ne=jt(he,A,!1,v)&&ne,_)for(Be=0;Be<_.length;Be++)he=v.g=_[Be],ne=jt(he,A,!1,v)&&ne}ue.prototype.N=function(){if(ue.Z.N.call(this),this.i){var h=this.i;for(const v in h.g){const _=h.g[v];for(let A=0;A<_.length;A++)Ue(_[A]);delete h.g[v],h.h--}}this.G=null},ue.prototype.J=function(h,v,_,A){return this.i.add(String(h),v,!1,_,A)},ue.prototype.K=function(h,v,_,A){return this.i.add(String(h),v,!0,_,A)};function jt(h,v,_,A){if(v=h.i.g[String(v)],!v)return!0;v=v.concat();let ne=!0;for(let he=0;he<v.length;++he){const Be=v[he];if(Be&&!Be.da&&Be.capture==_){const Rt=Be.listener,cs=Be.ha||Be.src;Be.fa&&ve(h.i,Be),ne=Rt.call(cs,A)!==!1&&ne}}return ne&&!A.defaultPrevented}function gt(h,v){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=p(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(v)>2147483647?-1:d.setTimeout(h,v||0)}function Qe(h){h.g=gt(()=>{h.g=null,h.i&&(h.i=!1,Qe(h))},h.l);const v=h.h;h.h=null,h.m.apply(null,v)}class ut extends V{constructor(v,_){super(),this.m=v,this.l=_,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:Qe(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Wt(h){V.call(this),this.h=h,this.g={}}j(Wt,V);var en=[];function Gn(h){Ne(h.g,function(v,_){this.g.hasOwnProperty(_)&&gn(v)},h),h.g={}}Wt.prototype.N=function(){Wt.Z.N.call(this),Gn(this)},Wt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var un=d.JSON.stringify,Qn=d.JSON.parse,Fn=class{stringify(h){return d.JSON.stringify(h,void 0)}parse(h){return d.JSON.parse(h,void 0)}};function Rn(){}function Ln(){}var tn={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function zt(){P.call(this,"d")}j(zt,P);function bt(){P.call(this,"c")}j(bt,P);var At={},ee=null;function C(){return ee=ee||new ue}At.Ia="serverreachability";function ae(h){P.call(this,At.Ia,h)}j(ae,P);function Re(h){const v=C();kt(v,new ae(v))}At.STAT_EVENT="statevent";function De(h,v){P.call(this,At.STAT_EVENT,h),this.stat=v}j(De,P);function Le(h){const v=C();kt(v,new De(v,h))}At.Ja="timingevent";function qe(h,v){P.call(this,At.Ja,h),this.size=v}j(qe,P);function Pe(h,v){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){h()},v)}function Dt(){this.g=!0}Dt.prototype.ua=function(){this.g=!1};function yt(h,v,_,A,ne,he){h.info(function(){if(h.g)if(he){var Be="",Rt=he.split("&");for(let fn=0;fn<Rt.length;fn++){var cs=Rt[fn].split("=");if(cs.length>1){const qn=cs[0];cs=cs[1];const Or=qn.split("_");Be=Or.length>=2&&Or[1]=="type"?Be+(qn+"="+cs+"&"):Be+(qn+"=redacted&")}}}else Be=null;else Be=he;return"XMLHTTP REQ ("+A+") [attempt "+ne+"]: "+v+`
`+_+`
`+Be})}function at(h,v,_,A,ne,he,Be){h.info(function(){return"XMLHTTP RESP ("+A+") [ attempt "+ne+"]: "+v+`
`+_+`
`+he+" "+Be})}function oe(h,v,_,A){h.info(function(){return"XMLHTTP TEXT ("+v+"): "+Xe(h,_)+(A?" "+A:"")})}function Ae(h,v){h.info(function(){return"TIMEOUT: "+v})}Dt.prototype.info=function(){};function Xe(h,v){if(!h.g)return v;if(!v)return null;try{const he=JSON.parse(v);if(he){for(h=0;h<he.length;h++)if(Array.isArray(he[h])){var _=he[h];if(!(_.length<2)){var A=_[1];if(Array.isArray(A)&&!(A.length<1)){var ne=A[0];if(ne!="noop"&&ne!="stop"&&ne!="close")for(let Be=1;Be<A.length;Be++)A[Be]=""}}}}return un(he)}catch{return v}}var pt={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ot={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Gt;function bn(){}j(bn,Rn),bn.prototype.g=function(){return new XMLHttpRequest},Gt=new bn;function Ht(h){return encodeURIComponent(String(h))}function on(h){var v=1;h=h.split(":");const _=[];for(;v>0&&h.length;)_.push(h.shift()),v--;return h.length&&_.push(h.join(":")),_}function Cn(h,v,_,A){this.j=h,this.i=v,this.l=_,this.S=A||1,this.V=new Wt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new On}function On(){this.i=null,this.g="",this.h=!1}var Nn={},an={};function as(h,v,_){h.M=1,h.A=Et(te(v)),h.u=_,h.R=!0,br(h,null)}function br(h,v){h.F=Date.now(),js(h),h.B=te(h.A);var _=h.B,A=h.S;Array.isArray(A)||(A=[String(A)]),ti(_.i,"t",A),h.C=0,_=h.j.L,h.h=new On,h.g=ed(h.j,_?v:null,!h.u),h.P>0&&(h.O=new ut(p(h.Y,h,h.g),h.P)),v=h.V,_=h.g,A=h.ba;var ne="readystatechange";Array.isArray(ne)||(ne&&(en[0]=ne.toString()),ne=en);for(let he=0;he<ne.length;he++){const Be=tt(_,ne[he],A||v.handleEvent,!1,v.h||v);if(!Be)break;v.g[Be.key]=Be}v=h.J?U(h.J):{},h.u?(h.v||(h.v="POST"),v["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,v)):(h.v="GET",h.g.ea(h.B,h.v,null,v)),Re(),yt(h.i,h.v,h.B,h.l,h.S,h.u)}Cn.prototype.ba=function(h){h=h.target;const v=this.O;v&&mt(h)==3?v.j():this.Y(h)},Cn.prototype.Y=function(h){try{if(h==this.g)e:{const Rt=mt(this.g),cs=this.g.ya(),fn=this.g.ca();if(!(Rt<3)&&(Rt!=3||this.g&&(this.h.h||this.g.la()||Lt(this.g)))){this.K||Rt!=4||cs==7||(cs==8||fn<=0?Re(3):Re(2)),Ts(this);var v=this.g.ca();this.X=v;var _=ya(this);if(this.o=v==200,at(this.i,this.v,this.B,this.l,this.S,Rt,v),this.o){if(this.U&&!this.L){t:{if(this.g){var A,ne=this.g;if((A=ne.g?ne.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(A)){var he=A;break t}}he=null}if(h=he)oe(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Xn(this,h);else{this.o=!1,this.m=3,Le(12),In(this),os(this);break e}}if(this.R){h=!0;let qn;for(;!this.K&&this.C<_.length;)if(qn=Lr(this,_),qn==an){Rt==4&&(this.m=4,Le(14),h=!1),oe(this.i,this.l,null,"[Incomplete Response]");break}else if(qn==Nn){this.m=4,Le(15),oe(this.i,this.l,_,"[Invalid Chunk]"),h=!1;break}else oe(this.i,this.l,qn,null),Xn(this,qn);if(gi(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Rt!=4||_.length!=0||this.h.h||(this.m=1,Le(16),h=!1),this.o=this.o&&h,!h)oe(this.i,this.l,_,"[Invalid Chunked Response]"),In(this),os(this);else if(_.length>0&&!this.W){this.W=!0;var Be=this.j;Be.g==this&&Be.aa&&!Be.P&&(Be.j.info("Great, no buffering proxy detected. Bytes received: "+_.length),dc(Be),Be.P=!0,Le(11))}}else oe(this.i,this.l,_,null),Xn(this,_);Rt==4&&In(this),this.o&&!this.K&&(Rt==4?Qu(this.j,this):(this.o=!1,js(this)))}else ls(this.g),v==400&&_.indexOf("Unknown SID")>0?(this.m=3,Le(12)):(this.m=0,Le(13)),In(this),os(this)}}}catch{}};function ya(h){if(!gi(h))return h.g.la();const v=Lt(h.g);if(v==="")return"";let _="";const A=v.length,ne=mt(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return In(h),os(h),"";h.h.i=new d.TextDecoder}for(let he=0;he<A;he++)h.h.h=!0,_+=h.h.i.decode(v[he],{stream:!(ne&&he==A-1)});return v.length=0,h.h.g+=_,h.C=0,h.h.g}function gi(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function Lr(h,v){var _=h.C,A=v.indexOf(`
`,_);return A==-1?an:(_=Number(v.substring(_,A)),isNaN(_)?Nn:(A+=1,A+_>v.length?an:(v=v.slice(A,A+_),h.C=A+_,v)))}Cn.prototype.cancel=function(){this.K=!0,In(this)};function js(h){h.T=Date.now()+h.H,Es(h,h.H)}function Es(h,v){if(h.D!=null)throw Error("WatchDog timer not null");h.D=Pe(p(h.aa,h),v)}function Ts(h){h.D&&(d.clearTimeout(h.D),h.D=null)}Cn.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(Ae(this.i,this.B),this.M!=2&&(Re(),Le(17)),In(this),this.m=2,os(this)):Es(this,this.T-h)};function os(h){h.j.I==0||h.K||Qu(h.j,h)}function In(h){Ts(h);var v=h.O;v&&typeof v.dispose=="function"&&v.dispose(),h.O=null,Gn(h.V),h.g&&(v=h.g,h.g=null,v.abort(),v.dispose())}function Xn(h,v){try{var _=h.j;if(_.I!=0&&(_.g==h||Zn(_.h,h))){if(!h.L&&Zn(_.h,h)&&_.I==3){try{var A=_.Ba.g.parse(v)}catch{A=null}if(Array.isArray(A)&&A.length==3){var ne=A;if(ne[0]==0){e:if(!_.v){if(_.g)if(_.g.F+3e3<h.F)sl(_),Hn(_);else break e;mo(_),Le(18)}}else _.xa=ne[1],0<_.xa-_.K&&ne[2]<37500&&_.F&&_.A==0&&!_.C&&(_.C=Pe(p(_.Va,_),6e3));Ds(_.h)<=1&&_.ta&&(_.ta=void 0)}else yi(_,11)}else if((h.L||_.g==h)&&sl(_),!M(v))for(ne=_.Ba.g.parse(v),v=0;v<ne.length;v++){let fn=ne[v];const qn=fn[0];if(!(qn<=_.K))if(_.K=qn,fn=fn[1],_.I==2)if(fn[0]=="c"){_.M=fn[1],_.ba=fn[2];const Or=fn[3];Or!=null&&(_.ka=Or,_.j.info("VER="+_.ka));const vi=fn[4];vi!=null&&(_.za=vi,_.j.info("SVER="+_.za));const ni=fn[5];ni!=null&&typeof ni=="number"&&ni>0&&(A=1.5*ni,_.O=A,_.j.info("backChannelRequestTimeoutMs_="+A)),A=_;const si=h.g;if(si){const go=si.g?si.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(go){var he=A.h;he.g||go.indexOf("spdy")==-1&&go.indexOf("quic")==-1&&go.indexOf("h2")==-1||(he.j=he.l,he.g=new Set,he.h&&(fs(he,he.h),he.h=null))}if(A.G){const rl=si.g?si.g.getResponseHeader("X-HTTP-Session-Id"):null;rl&&(A.wa=rl,it(A.J,A.G,rl))}}_.I=3,_.l&&_.l.ra(),_.aa&&(_.T=Date.now()-h.F,_.j.info("Handshake RTT: "+_.T+"ms")),A=_;var Be=h;if(A.na=Zu(A,A.L?A.ba:null,A.W),Be.L){Xs(A.h,Be);var Rt=Be,cs=A.O;cs&&(Rt.H=cs),Rt.D&&(Ts(Rt),js(Rt)),A.g=Be}else Ku(A);_.i.length>0&&kr(_)}else fn[0]!="stop"&&fn[0]!="close"||yi(_,7);else _.I==3&&(fn[0]=="stop"||fn[0]=="close"?fn[0]=="stop"?yi(_,7):Vn(_):fn[0]!="noop"&&_.l&&_.l.qa(fn),_.A=0)}}Re(4)}catch{}}var pn=class{constructor(h,v){this.g=h,this.map=v}};function Jn(h){this.l=h||10,d.PerformanceNavigationTiming?(h=d.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Jr(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Ds(h){return h.h?1:h.g?h.g.size:0}function Zn(h,v){return h.h?h.h==v:h.g?h.g.has(v):!1}function fs(h,v){h.g?h.g.add(v):h.h=v}function Xs(h,v){h.h&&h.h==v?h.h=null:h.g&&h.g.has(v)&&h.g.delete(v)}Jn.prototype.cancel=function(){if(this.i=Zr(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Zr(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let v=h.i;for(const _ of h.g.values())v=v.concat(_.G);return v}return R(h.i)}var O=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function q(h,v){if(h){h=h.split("&");for(let _=0;_<h.length;_++){const A=h[_].indexOf("=");let ne,he=null;A>=0?(ne=h[_].substring(0,A),he=h[_].substring(A+1)):ne=h[_],v(ne,he?decodeURIComponent(he.replace(/\+/g," ")):"")}}}function se(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let v;h instanceof se?(this.l=h.l,$e(this,h.j),this.o=h.o,this.g=h.g,Ke(this,h.u),this.h=h.h,Ye(this,Hs(h.i)),this.m=h.m):h&&(v=String(h).match(O))?(this.l=!1,$e(this,v[1]||"",!0),this.o=kn(v[2]||""),this.g=kn(v[3]||"",!0),Ke(this,v[4]),this.h=kn(v[5]||"",!0),Ye(this,v[6]||"",!0),this.m=kn(v[7]||"")):(this.l=!1,this.i=new wr(null,this.l))}se.prototype.toString=function(){const h=[];var v=this.j;v&&h.push(Ns(v,As,!0),":");var _=this.g;return(_||v=="file")&&(h.push("//"),(v=this.o)&&h.push(Ns(v,As,!0),"@"),h.push(Ht(_).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.u,_!=null&&h.push(":",String(_))),(_=this.h)&&(this.g&&_.charAt(0)!="/"&&h.push("/"),h.push(Ns(_,_.charAt(0)=="/"?Ls:ei,!0))),(_=this.i.toString())&&h.push("?",_),(_=this.m)&&h.push("#",Ns(_,va)),h.join("")},se.prototype.resolve=function(h){const v=te(this);let _=!!h.j;_?$e(v,h.j):_=!!h.o,_?v.o=h.o:_=!!h.g,_?v.g=h.g:_=h.u!=null;var A=h.h;if(_)Ke(v,h.u);else if(_=!!h.h){if(A.charAt(0)!="/")if(this.g&&!this.h)A="/"+A;else{var ne=v.h.lastIndexOf("/");ne!=-1&&(A=v.h.slice(0,ne+1)+A)}if(ne=A,ne==".."||ne==".")A="";else if(ne.indexOf("./")!=-1||ne.indexOf("/.")!=-1){A=ne.lastIndexOf("/",0)==0,ne=ne.split("/");const he=[];for(let Be=0;Be<ne.length;){const Rt=ne[Be++];Rt=="."?A&&Be==ne.length&&he.push(""):Rt==".."?((he.length>1||he.length==1&&he[0]!="")&&he.pop(),A&&Be==ne.length&&he.push("")):(he.push(Rt),A=!0)}A=he.join("/")}else A=ne}return _?v.h=A:_=h.i.toString()!=="",_?Ye(v,Hs(h.i)):_=!!h.m,_&&(v.m=h.m),v};function te(h){return new se(h)}function $e(h,v,_){h.j=_?kn(v,!0):v,h.j&&(h.j=h.j.replace(/:$/,""))}function Ke(h,v){if(v){if(v=Number(v),isNaN(v)||v<0)throw Error("Bad port number "+v);h.u=v}else h.u=null}function Ye(h,v,_){v instanceof wr?(h.i=v,pi(h.i,h.l)):(_||(v=Ns(v,Js)),h.i=new wr(v,h.l))}function it(h,v,_){h.i.set(v,_)}function Et(h){return it(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function kn(h,v){return h?v?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Ns(h,v,_){return typeof h=="string"?(h=encodeURI(h).replace(v,es),_&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function es(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var As=/[#\/\?@]/g,ei=/[#\?:]/g,Ls=/[#\?]/g,Js=/[#\?@]/g,va=/#/g;function wr(h,v){this.h=this.g=null,this.i=h||null,this.j=!!v}function Rs(h){h.g||(h.g=new Map,h.h=0,h.i&&q(h.i,function(v,_){h.add(decodeURIComponent(v.replace(/\+/g," ")),_)}))}s=wr.prototype,s.add=function(h,v){Rs(this),this.i=null,h=_r(this,h);let _=this.g.get(h);return _||this.g.set(h,_=[]),_.push(v),this.h+=1,this};function ba(h,v){Rs(h),v=_r(h,v),h.g.has(v)&&(h.i=null,h.h-=h.g.get(v).length,h.g.delete(v))}function Li(h,v){return Rs(h),v=_r(h,v),h.g.has(v)}s.forEach=function(h,v){Rs(this),this.g.forEach(function(_,A){_.forEach(function(ne){h.call(v,ne,A,this)},this)},this)};function xr(h,v){Rs(h);let _=[];if(typeof v=="string")Li(h,v)&&(_=_.concat(h.g.get(_r(h,v))));else for(h=Array.from(h.g.values()),v=0;v<h.length;v++)_=_.concat(h[v]);return _}s.set=function(h,v){return Rs(this),this.i=null,h=_r(this,h),Li(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[v]),this.h+=1,this},s.get=function(h,v){return h?(h=xr(this,h),h.length>0?String(h[0]):v):v};function ti(h,v,_){ba(h,v),_.length>0&&(h.i=null,h.g.set(_r(h,v),R(_)),h.h+=_.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],v=Array.from(this.g.keys());for(let A=0;A<v.length;A++){var _=v[A];const ne=Ht(_);_=xr(this,_);for(let he=0;he<_.length;he++){let Be=ne;_[he]!==""&&(Be+="="+Ht(_[he])),h.push(Be)}}return this.i=h.join("&")};function Hs(h){const v=new wr;return v.i=h.i,h.g&&(v.g=new Map(h.g),v.h=h.h),v}function _r(h,v){return v=String(v),h.j&&(v=v.toLowerCase()),v}function pi(h,v){v&&!h.j&&(Rs(h),h.i=null,h.g.forEach(function(_,A){const ne=A.toLowerCase();A!=ne&&(ba(this,A),ti(this,ne,_))},h)),h.j=v}function Zs(h,v){const _=new Dt;if(d.Image){const A=new Image;A.onload=b(F,_,"TestLoadImage: loaded",!0,v,A),A.onerror=b(F,_,"TestLoadImage: error",!1,v,A),A.onabort=b(F,_,"TestLoadImage: abort",!1,v,A),A.ontimeout=b(F,_,"TestLoadImage: timeout",!1,v,A),d.setTimeout(function(){A.ontimeout&&A.ontimeout()},1e4),A.src=h}else v(!1)}function er(h,v){const _=new Dt,A=new AbortController,ne=setTimeout(()=>{A.abort(),F(_,"TestPingServer: timeout",!1,v)},1e4);fetch(h,{signal:A.signal}).then(he=>{clearTimeout(ne),he.ok?F(_,"TestPingServer: ok",!0,v):F(_,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(ne),F(_,"TestPingServer: error",!1,v)})}function F(h,v,_,A,ne){try{ne&&(ne.onload=null,ne.onerror=null,ne.onabort=null,ne.ontimeout=null),A(_)}catch{}}function k(){this.g=new Fn}function N(h){this.i=h.Sb||null,this.h=h.ab||!1}j(N,Rn),N.prototype.g=function(){return new $(this.i,this.h)};function $(h,v){ue.call(this),this.H=h,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}j($,ue),s=$.prototype,s.open=function(h,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=v,this.readyState=1,ke(this)},s.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const v={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(v.body=h),(this.H||d).fetch(new Request(this.D,v)).then(this.Pa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,de(this)),this.readyState=0},s.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,ke(this)),this.g&&(this.readyState=3,ke(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;G(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function G(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}s.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var v=h.value?h.value:new Uint8Array(0);(v=this.B.decode(v,{stream:!h.done}))&&(this.response=this.responseText+=v)}h.done?de(this):ke(this),this.readyState==3&&G(this)}},s.Oa=function(h){this.g&&(this.response=this.responseText=h,de(this))},s.Na=function(h){this.g&&(this.response=h,de(this))},s.ga=function(){this.g&&de(this)};function de(h){h.readyState=4,h.l=null,h.j=null,h.B=null,ke(h)}s.setRequestHeader=function(h,v){this.A.append(h,v)},s.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],v=this.h.entries();for(var _=v.next();!_.done;)_=_.value,h.push(_[0]+": "+_[1]),_=v.next();return h.join(`\r
`)};function ke(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty($.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Ee(h){let v="";return Ne(h,function(_,A){v+=A,v+=":",v+=_,v+=`\r
`}),v}function Ve(h,v,_){e:{for(A in _){var A=!1;break e}A=!0}A||(_=Ee(_),typeof h=="string"?_!=null&&Ht(_):it(h,v,_))}function Ie(h){ue.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}j(Ie,ue);var Ze=/^https?$/i,Ut=["POST","PUT"];s=Ie.prototype,s.Fa=function(h){this.H=h},s.ea=function(h,v,_,A){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);v=v?v.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Gt.g(),this.g.onreadystatechange=S(p(this.Ca,this));try{this.B=!0,this.g.open(v,String(h),!0),this.B=!1}catch(he){Mn(this,he);return}if(h=_||"",_=new Map(this.headers),A)if(Object.getPrototypeOf(A)===Object.prototype)for(var ne in A)_.set(ne,A[ne]);else if(typeof A.keys=="function"&&typeof A.get=="function")for(const he of A.keys())_.set(he,A.get(he));else throw Error("Unknown input type for opt_headers: "+String(A));A=Array.from(_.keys()).find(he=>he.toLowerCase()=="content-type"),ne=d.FormData&&h instanceof d.FormData,!(Array.prototype.indexOf.call(Ut,v,void 0)>=0)||A||ne||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[he,Be]of _)this.g.setRequestHeader(he,Be);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(he){Mn(this,he)}};function Mn(h,v){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=v,h.o=5,ft(h),hn(h)}function ft(h){h.A||(h.A=!0,kt(h,"complete"),kt(h,"error"))}s.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,kt(this,"complete"),kt(this,"abort"),hn(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),hn(this,!0)),Ie.Z.N.call(this)},s.Ca=function(){this.u||(this.B||this.v||this.j?dn(this):this.Xa())},s.Xa=function(){dn(this)};function dn(h){if(h.h&&typeof u<"u"){if(h.v&&mt(h)==4)setTimeout(h.Ca.bind(h),0);else if(kt(h,"readystatechange"),mt(h)==4){h.h=!1;try{const he=h.ca();e:switch(he){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var _;if(!(_=v)){var A;if(A=he===0){let Be=String(h.D).match(O)[1]||null;!Be&&d.self&&d.self.location&&(Be=d.self.location.protocol.slice(0,-1)),A=!Ze.test(Be?Be.toLowerCase():"")}_=A}if(_)kt(h,"complete"),kt(h,"success");else{h.o=6;try{var ne=mt(h)>2?h.g.statusText:""}catch{ne=""}h.l=ne+" ["+h.ca()+"]",ft(h)}}finally{hn(h)}}}}function hn(h,v){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const _=h.g;h.g=null,v||kt(h,"ready");try{_.onreadystatechange=null}catch{}}}s.isActive=function(){return!!this.g};function mt(h){return h.g?h.g.readyState:0}s.ca=function(){try{return mt(this)>2?this.g.status:-1}catch{return-1}},s.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.La=function(h){if(this.g){var v=this.g.responseText;return h&&v.indexOf(h)==0&&(v=v.substring(h.length)),Qn(v)}};function Lt(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function ls(h){const v={};h=(h.g&&mt(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let A=0;A<h.length;A++){if(M(h[A]))continue;var _=on(h[A]);const ne=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const he=v[ne]||[];v[ne]=he,he.push(_)}ze(v,function(A){return A.join(", ")})}s.ya=function(){return this.o},s.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Pn(h,v,_){return _&&_.internalChannelParams&&_.internalChannelParams[h]||v}function Kn(h){this.za=0,this.i=[],this.j=new Dt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Pn("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Pn("baseRetryDelayMs",5e3,h),this.Za=Pn("retryDelaySeedMs",1e4,h),this.Ta=Pn("forwardChannelMaxRetries",2,h),this.va=Pn("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new Jn(h&&h.concurrentRequestLimit),this.Ba=new k,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}s=Kn.prototype,s.ka=8,s.I=1,s.connect=function(h,v,_,A){Le(0),this.W=h,this.H=v||{},_&&A!==void 0&&(this.H.OSID=_,this.H.OAID=A),this.F=this.X,this.J=Zu(this,null,this.W),kr(this)};function Vn(h){if(ur(h),h.I==3){var v=h.V++,_=te(h.J);if(it(_,"SID",h.M),it(_,"RID",v),it(_,"TYPE","terminate"),fo(h,_),v=new Cn(h,h.j,v),v.M=2,v.A=Et(te(_)),_=!1,d.navigator&&d.navigator.sendBeacon)try{_=d.navigator.sendBeacon(v.A.toString(),"")}catch{}!_&&d.Image&&(new Image().src=v.A,_=!0),_||(v.g=ed(v.j,null),v.g.ea(v.A)),v.F=Date.now(),js(v)}Ju(h)}function Hn(h){h.g&&(dc(h),h.g.cancel(),h.g=null)}function ur(h){Hn(h),h.v&&(d.clearTimeout(h.v),h.v=null),sl(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&d.clearTimeout(h.m),h.m=null)}function kr(h){if(!Jr(h.h)&&!h.m){h.m=!0;var v=h.Ea;xe||T(),pe||(xe(),pe=!0),I.add(v,h),h.D=0}}function wa(h,v){return Ds(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=v.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=Pe(p(h.Ea,h,v),Xu(h,h.D)),h.D++,!0)}s.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const ne=new Cn(this,this.j,h);let he=this.o;if(this.U&&(he?(he=U(he),Ce(he,this.U)):he=this.U),this.u!==null||this.R||(ne.J=he,he=null),this.S)e:{for(var v=0,_=0;_<this.i.length;_++){t:{var A=this.i[_];if("__data__"in A.map&&(A=A.map.__data__,typeof A=="string")){A=A.length;break t}A=void 0}if(A===void 0)break;if(v+=A,v>4096){v=_;break e}if(v===4096||_===this.i.length-1){v=_+1;break e}}v=1e3}else v=1e3;v=Gu(this,ne,v),_=te(this.J),it(_,"RID",h),it(_,"CVER",22),this.G&&it(_,"X-HTTP-Session-Id",this.G),fo(this,_),he&&(this.R?v="headers="+Ht(Ee(he))+"&"+v:this.u&&Ve(_,this.u,he)),fs(this.h,ne),this.Ra&&it(_,"TYPE","init"),this.S?(it(_,"$req",v),it(_,"SID","null"),ne.U=!0,as(ne,_,null)):as(ne,_,v),this.I=2}}else this.I==3&&(h?Oi(this,h):this.i.length==0||Jr(this.h)||Oi(this))};function Oi(h,v){var _;v?_=v.l:_=h.V++;const A=te(h.J);it(A,"SID",h.M),it(A,"RID",_),it(A,"AID",h.K),fo(h,A),h.u&&h.o&&Ve(A,h.u,h.o),_=new Cn(h,h.j,_,h.D+1),h.u===null&&(_.J=h.o),v&&(h.i=v.G.concat(h.i)),v=Gu(h,_,1e3),_.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),fs(h.h,_),as(_,A,v)}function fo(h,v){h.H&&Ne(h.H,function(_,A){it(v,A,_)}),h.l&&Ne({},function(_,A){it(v,A,_)})}function Gu(h,v,_){_=Math.min(h.i.length,_);const A=h.l?p(h.l.Ka,h.l,h):null;e:{var ne=h.i;let Rt=-1;for(;;){const cs=["count="+_];Rt==-1?_>0?(Rt=ne[0].g,cs.push("ofs="+Rt)):Rt=0:cs.push("ofs="+Rt);let fn=!0;for(let qn=0;qn<_;qn++){var he=ne[qn].g;const Or=ne[qn].map;if(he-=Rt,he<0)Rt=Math.max(0,ne[qn].g-100),fn=!1;else try{he="req"+he+"_"||"";try{var Be=Or instanceof Map?Or:Object.entries(Or);for(const[vi,ni]of Be){let si=ni;g(ni)&&(si=un(ni)),cs.push(he+vi+"="+encodeURIComponent(si))}}catch(vi){throw cs.push(he+"type="+encodeURIComponent("_badmap")),vi}}catch{A&&A(Or)}}if(fn){Be=cs.join("&");break e}}Be=void 0}return h=h.i.splice(0,_),v.G=h,Be}function Ku(h){if(!h.g&&!h.v){h.Y=1;var v=h.Da;xe||T(),pe||(xe(),pe=!0),I.add(v,h),h.A=0}}function mo(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=Pe(p(h.Da,h),Xu(h,h.A)),h.A++,!0)}s.Da=function(){if(this.v=null,Yu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=Pe(p(this.Wa,this),h)}},s.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Le(10),Hn(this),Yu(this))};function dc(h){h.B!=null&&(d.clearTimeout(h.B),h.B=null)}function Yu(h){h.g=new Cn(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var v=te(h.na);it(v,"RID","rpc"),it(v,"SID",h.M),it(v,"AID",h.K),it(v,"CI",h.F?"0":"1"),!h.F&&h.ia&&it(v,"TO",h.ia),it(v,"TYPE","xmlhttp"),fo(h,v),h.u&&h.o&&Ve(v,h.u,h.o),h.O&&(h.g.H=h.O);var _=h.g;h=h.ba,_.M=1,_.A=Et(te(v)),_.u=null,_.R=!0,br(_,h)}s.Va=function(){this.C!=null&&(this.C=null,Hn(this),mo(this),Le(19))};function sl(h){h.C!=null&&(d.clearTimeout(h.C),h.C=null)}function Qu(h,v){var _=null;if(h.g==v){sl(h),dc(h),h.g=null;var A=2}else if(Zn(h.h,v))_=v.G,Xs(h.h,v),A=1;else return;if(h.I!=0){if(v.o)if(A==1){_=v.u?v.u.length:0,v=Date.now()-v.F;var ne=h.D;A=C(),kt(A,new qe(A,_)),kr(h)}else Ku(h);else if(ne=v.m,ne==3||ne==0&&v.X>0||!(A==1&&wa(h,v)||A==2&&mo(h)))switch(_&&_.length>0&&(v=h.h,v.i=v.i.concat(_)),ne){case 1:yi(h,5);break;case 4:yi(h,10);break;case 3:yi(h,6);break;default:yi(h,2)}}}function Xu(h,v){let _=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(_*=2),_*v}function yi(h,v){if(h.j.info("Error code "+v),v==2){var _=p(h.bb,h),A=h.Ua;const ne=!A;A=new se(A||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||$e(A,"https"),Et(A),ne?Zs(A.toString(),_):er(A.toString(),_)}else Le(2);h.I=0,h.l&&h.l.pa(v),Ju(h),ur(h)}s.bb=function(h){h?(this.j.info("Successfully pinged google.com"),Le(2)):(this.j.info("Failed to ping google.com"),Le(1))};function Ju(h){if(h.I=0,h.ja=[],h.l){const v=Zr(h.h);(v.length!=0||h.i.length!=0)&&(H(h.ja,v),H(h.ja,h.i),h.h.i.length=0,R(h.i),h.i.length=0),h.l.oa()}}function Zu(h,v,_){var A=_ instanceof se?te(_):new se(_);if(A.g!="")v&&(A.g=v+"."+A.g),Ke(A,A.u);else{var ne=d.location;A=ne.protocol,v=v?v+"."+ne.hostname:ne.hostname,ne=+ne.port;const he=new se(null);A&&$e(he,A),v&&(he.g=v),ne&&Ke(he,ne),_&&(he.h=_),A=he}return _=h.G,v=h.wa,_&&v&&it(A,_,v),it(A,"VER",h.ka),fo(h,A),A}function ed(h,v,_){if(v&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return v=h.Aa&&!h.ma?new Ie(new N({ab:_})):new Ie(h.ma),v.Fa(h.L),v}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function td(){}s=td.prototype,s.ra=function(){},s.qa=function(){},s.pa=function(){},s.oa=function(){},s.isActive=function(){return!0},s.Ka=function(){};function xa(){}xa.prototype.g=function(h,v){return new tr(h,v)};function tr(h,v){ue.call(this),this.g=new Kn(v),this.l=h,this.h=v&&v.messageUrlParams||null,h=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(h?h["X-WebChannel-Content-Type"]=v.messageContentType:h={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.sa&&(h?h["X-WebChannel-Client-Profile"]=v.sa:h={"X-WebChannel-Client-Profile":v.sa}),this.g.U=h,(h=v&&v.Qb)&&!M(h)&&(this.g.u=h),this.A=v&&v.supportsCrossDomainXhr||!1,this.v=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!M(v)&&(this.g.G=v,h=this.h,h!==null&&v in h&&(h=this.h,v in h&&delete h[v])),this.j=new Pi(this)}j(tr,ue),tr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},tr.prototype.close=function(){Vn(this.g)},tr.prototype.o=function(h){var v=this.g;if(typeof h=="string"){var _={};_.__data__=h,h=_}else this.v&&(_={},_.__data__=un(h),h=_);v.i.push(new pn(v.Ya++,h)),v.I==3&&kr(v)},tr.prototype.N=function(){this.g.l=null,delete this.j,Vn(this.g),delete this.g,tr.Z.N.call(this)};function nd(h){zt.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var v=h.__sm__;if(v){e:{for(const _ in v){h=_;break e}h=void 0}(this.i=h)&&(h=this.i,v=v!==null&&h in v?v[h]:void 0),this.data=v}else this.data=h}j(nd,zt);function sd(){bt.call(this),this.status=1}j(sd,bt);function Pi(h){this.g=h}j(Pi,td),Pi.prototype.ra=function(){kt(this.g,"a")},Pi.prototype.qa=function(h){kt(this.g,new nd(h))},Pi.prototype.pa=function(h){kt(this.g,new sd)},Pi.prototype.oa=function(){kt(this.g,"b")},xa.prototype.createWebChannel=xa.prototype.g,tr.prototype.send=tr.prototype.o,tr.prototype.open=tr.prototype.m,tr.prototype.close=tr.prototype.close,D_=function(){return new xa},M_=function(){return C()},I_=At,Cp={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},pt.NO_ERROR=0,pt.TIMEOUT=8,pt.HTTP_ERROR=6,Sh=pt,ot.COMPLETE="complete",R_=ot,Ln.EventType=tn,tn.OPEN="a",tn.CLOSE="b",tn.ERROR="c",tn.MESSAGE="d",ue.prototype.listen=ue.prototype.J,iu=Ln,Ie.prototype.listenOnce=Ie.prototype.K,Ie.prototype.getLastError=Ie.prototype.Ha,Ie.prototype.getLastErrorCode=Ie.prototype.ya,Ie.prototype.getStatus=Ie.prototype.ca,Ie.prototype.getResponseJson=Ie.prototype.La,Ie.prototype.getResponseText=Ie.prototype.la,Ie.prototype.send=Ie.prototype.ea,Ie.prototype.setWithCredentials=Ie.prototype.Fa,A_=Ie}).apply(typeof ch<"u"?ch:typeof self<"u"?self:typeof window<"u"?window:{});class Ws{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ws.UNAUTHENTICATED=new Ws(null),Ws.GOOGLE_CREDENTIALS=new Ws("google-credentials-uid"),Ws.FIRST_PARTY=new Ws("first-party-uid"),Ws.MOCK_USER=new Ws("mock-user");let ic="12.8.0";function hR(s){ic=s}const zo=new oy("@firebase/firestore");function Ol(){return zo.logLevel}function Je(s,...e){if(zo.logLevel<=Qt.DEBUG){const t=e.map(by);zo.debug(`Firestore (${ic}): ${s}`,...t)}}function ha(s,...e){if(zo.logLevel<=Qt.ERROR){const t=e.map(by);zo.error(`Firestore (${ic}): ${s}`,...t)}}function Gl(s,...e){if(zo.logLevel<=Qt.WARN){const t=e.map(by);zo.warn(`Firestore (${ic}): ${s}`,...t)}}function by(s){if(typeof s=="string")return s;try{return(function(t){return JSON.stringify(t)})(s)}catch{return s}}function _t(s,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,L_(s,i,t)}function L_(s,e,t){let i=`FIRESTORE (${ic}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw ha(i),new Error(i)}function yn(s,e,t,i){let l="Unexpected state";typeof t=="string"?l=t:i=t,s||L_(e,l,i)}function Nt(s,e){return s}const be={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class We extends mi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class oa{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class O_{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class fR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Ws.UNAUTHENTICATED)))}shutdown(){}}class mR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class gR{constructor(e){this.t=e,this.currentUser=Ws.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){yn(this.o===void 0,42304);let i=this.i;const l=y=>this.i!==i?(i=this.i,t(y)):Promise.resolve();let u=new oa;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new oa,e.enqueueRetryable((()=>l(this.currentUser)))};const d=()=>{const y=u;e.enqueueRetryable((async()=>{await y.promise,await l(this.currentUser)}))},g=y=>{Je("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=y,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((y=>g(y))),setTimeout((()=>{if(!this.auth){const y=this.t.getImmediate({optional:!0});y?g(y):(Je("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new oa)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(Je("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(yn(typeof i.accessToken=="string",31837,{l:i}),new O_(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return yn(e===null||typeof e=="string",2055,{h:e}),new Ws(e)}}class pR{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=Ws.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class yR{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new pR(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Ws.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class V2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class vR{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Rr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){yn(this.o===void 0,3512);const i=u=>{u.error!=null&&Je("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const d=u.token!==this.m;return this.m=u.token,Je("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable((()=>i(u)))};const l=u=>{Je("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>l(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?l(u):Je("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new V2(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(yn(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new V2(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function bR(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<s;i++)t[i]=Math.floor(256*Math.random());return t}class wy{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const l=bR(40);for(let u=0;u<l.length;++u)i.length<20&&l[u]<t&&(i+=e.charAt(l[u]%62))}return i}}function Jt(s,e){return s<e?-1:s>e?1:0}function Np(s,e){const t=Math.min(s.length,e.length);for(let i=0;i<t;i++){const l=s.charAt(i),u=e.charAt(i);if(l!==u)return Hg(l)===Hg(u)?Jt(l,u):Hg(l)?1:-1}return Jt(s.length,e.length)}const wR=55296,xR=57343;function Hg(s){const e=s.charCodeAt(0);return e>=wR&&e<=xR}function Kl(s,e,t){return s.length===e.length&&s.every(((i,l)=>t(i,e[l])))}const U2="__name__";class ji{constructor(e,t,i){t===void 0?t=0:t>e.length&&_t(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&_t(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return ji.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ji?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let l=0;l<i;l++){const u=ji.compareSegments(e.get(l),t.get(l));if(u!==0)return u}return Jt(e.length,t.length)}static compareSegments(e,t){const i=ji.isNumericId(e),l=ji.isNumericId(t);return i&&!l?-1:!i&&l?1:i&&l?ji.extractNumericId(e).compare(ji.extractNumericId(t)):Np(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Za.fromString(e.substring(4,e.length-2))}}class Dn extends ji{construct(e,t,i){return new Dn(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new We(be.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((l=>l.length>0)))}return new Dn(t)}static emptyPath(){return new Dn([])}}const _R=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class zs extends ji{construct(e,t,i){return new zs(e,t,i)}static isValidIdentifier(e){return _R.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),zs.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===U2}static keyField(){return new zs([U2])}static fromServerFormat(e){const t=[];let i="",l=0;const u=()=>{if(i.length===0)throw new We(be.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let d=!1;for(;l<e.length;){const g=e[l];if(g==="\\"){if(l+1===e.length)throw new We(be.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const y=e[l+1];if(y!=="\\"&&y!=="."&&y!=="`")throw new We(be.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=y,l+=2}else g==="`"?(d=!d,l++):g!=="."||d?(i+=g,l++):(u(),l++)}if(u(),d)throw new We(be.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new zs(t)}static emptyPath(){return new zs([])}}class ht{constructor(e){this.path=e}static fromPath(e){return new ht(Dn.fromString(e))}static fromName(e){return new ht(Dn.fromString(e).popFirst(5))}static empty(){return new ht(Dn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Dn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Dn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ht(new Dn(e.slice()))}}function P_(s,e,t){if(!t)throw new We(be.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function kR(s,e,t,i){if(e===!0&&i===!0)throw new We(be.INVALID_ARGUMENT,`${s} and ${t} cannot be used together.`)}function B2(s){if(!ht.isDocumentKey(s))throw new We(be.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function z2(s){if(ht.isDocumentKey(s))throw new We(be.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function V_(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function uf(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":_t(12329,{type:typeof s})}function or(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new We(be.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=uf(s);throw new We(be.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return s}function jR(s,e){if(e<=0)throw new We(be.INVALID_ARGUMENT,`Function ${s}() requires a positive number, but it was: ${e}.`)}function ks(s,e){const t={typeString:s};return e&&(t.value=e),t}function Vu(s,e){if(!V_(s))throw new We(be.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const l=e[i].typeString,u="value"in e[i]?{value:e[i].value}:void 0;if(!(i in s)){t=`JSON missing required field: '${i}'`;break}const d=s[i];if(l&&typeof d!==l){t=`JSON field '${i}' must be a ${l}.`;break}if(u!==void 0&&d!==u.value){t=`Expected '${i}' field to equal '${u.value}'`;break}}if(t)throw new We(be.INVALID_ARGUMENT,t);return!0}const F2=-62135596800,H2=1e6;class Pt{static now(){return Pt.fromMillis(Date.now())}static fromDate(e){return Pt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*H2);return new Pt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new We(be.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new We(be.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<F2)throw new We(be.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new We(be.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/H2}_compareTo(e){return this.seconds===e.seconds?Jt(this.nanoseconds,e.nanoseconds):Jt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Pt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Vu(e,Pt._jsonSchema))return new Pt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-F2;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Pt._jsonSchemaVersion="firestore/timestamp/1.0",Pt._jsonSchema={type:ks("string",Pt._jsonSchemaVersion),seconds:ks("number"),nanoseconds:ks("number")};class St{static fromTimestamp(e){return new St(e)}static min(){return new St(new Pt(0,0))}static max(){return new St(new Pt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const xu=-1;function ER(s,e){const t=s.toTimestamp().seconds,i=s.toTimestamp().nanoseconds+1,l=St.fromTimestamp(i===1e9?new Pt(t+1,0):new Pt(t,i));return new no(l,ht.empty(),e)}function TR(s){return new no(s.readTime,s.key,xu)}class no{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new no(St.min(),ht.empty(),xu)}static max(){return new no(St.max(),ht.empty(),xu)}}function SR(s,e){let t=s.readTime.compareTo(e.readTime);return t!==0?t:(t=ht.comparator(s.documentKey,e.documentKey),t!==0?t:Jt(s.largestBatchId,e.largestBatchId))}const CR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class NR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function ac(s){if(s.code!==be.FAILED_PRECONDITION||s.message!==CR)throw s;Je("LocalStore","Unexpectedly lost primary lease")}class je{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&_t(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new je(((i,l)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(i,l)},this.catchCallback=u=>{this.wrapFailure(t,u).next(i,l)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof je?t:je.resolve(t)}catch(t){return je.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):je.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):je.reject(t)}static resolve(e){return new je(((t,i)=>{t(e)}))}static reject(e){return new je(((t,i)=>{i(e)}))}static waitFor(e){return new je(((t,i)=>{let l=0,u=0,d=!1;e.forEach((g=>{++l,g.next((()=>{++u,d&&u===l&&t()}),(y=>i(y)))})),d=!0,u===l&&t()}))}static or(e){let t=je.resolve(!1);for(const i of e)t=t.next((l=>l?je.resolve(l):i()));return t}static forEach(e,t){const i=[];return e.forEach(((l,u)=>{i.push(t.call(this,l,u))})),this.waitFor(i)}static mapArray(e,t){return new je(((i,l)=>{const u=e.length,d=new Array(u);let g=0;for(let y=0;y<u;y++){const p=y;t(e[p]).next((b=>{d[p]=b,++g,g===u&&i(d)}),(b=>l(b)))}}))}static doWhile(e,t){return new je(((i,l)=>{const u=()=>{e()===!0?t().next((()=>{u()}),l):i()};u()}))}}function AR(s){const e=s.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function oc(s){return s.name==="IndexedDbTransactionError"}class df{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}df.ce=-1;const xy=-1;function hf(s){return s==null}function Hh(s){return s===0&&1/s==-1/0}function RR(s){return typeof s=="number"&&Number.isInteger(s)&&!Hh(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}const U_="";function IR(s){let e="";for(let t=0;t<s.length;t++)e.length>0&&(e=q2(e)),e=MR(s.get(t),e);return q2(e)}function MR(s,e){let t=e;const i=s.length;for(let l=0;l<i;l++){const u=s.charAt(l);switch(u){case"\0":t+="";break;case U_:t+="";break;default:t+=u}}return t}function q2(s){return s+U_+""}function $2(s){let e=0;for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e++;return e}function uo(s,e){for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e(t,s[t])}function B_(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}class Yn{constructor(e,t){this.comparator=e,this.root=t||Bs.EMPTY}insert(e,t){return new Yn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Bs.BLACK,null,null))}remove(e){return new Yn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Bs.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const l=this.comparator(e,i.key);if(l===0)return t+i.left.size;l<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new uh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new uh(this.root,e,this.comparator,!1)}getReverseIterator(){return new uh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new uh(this.root,e,this.comparator,!0)}}class uh{constructor(e,t,i,l){this.isReverse=l,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=t?i(e.key,t):1,t&&l&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Bs{constructor(e,t,i,l,u){this.key=e,this.value=t,this.color=i??Bs.RED,this.left=l??Bs.EMPTY,this.right=u??Bs.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,l,u){return new Bs(e??this.key,t??this.value,i??this.color,l??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let l=this;const u=i(e,l.key);return l=u<0?l.copy(null,null,null,l.left.insert(e,t,i),null):u===0?l.copy(null,t,null,null,null):l.copy(null,null,null,null,l.right.insert(e,t,i)),l.fixUp()}removeMin(){if(this.left.isEmpty())return Bs.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,l=this;if(t(e,l.key)<0)l.left.isEmpty()||l.left.isRed()||l.left.left.isRed()||(l=l.moveRedLeft()),l=l.copy(null,null,null,l.left.remove(e,t),null);else{if(l.left.isRed()&&(l=l.rotateRight()),l.right.isEmpty()||l.right.isRed()||l.right.left.isRed()||(l=l.moveRedRight()),t(e,l.key)===0){if(l.right.isEmpty())return Bs.EMPTY;i=l.right.min(),l=l.copy(i.key,i.value,null,null,l.right.removeMin())}l=l.copy(null,null,null,null,l.right.remove(e,t))}return l.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Bs.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Bs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw _t(43730,{key:this.key,value:this.value});if(this.right.isRed())throw _t(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw _t(27949);return e+(this.isRed()?0:1)}}Bs.EMPTY=null,Bs.RED=!0,Bs.BLACK=!1;Bs.EMPTY=new class{constructor(){this.size=0}get key(){throw _t(57766)}get value(){throw _t(16141)}get color(){throw _t(16727)}get left(){throw _t(29726)}get right(){throw _t(36894)}copy(e,t,i,l,u){return this}insert(e,t,i){return new Bs(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Cs{constructor(e){this.comparator=e,this.data=new Yn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const l=i.getNext();if(this.comparator(l.key,e[1])>=0)return;t(l.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new W2(this.data.getIterator())}getIteratorFrom(e){return new W2(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Cs)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(this.comparator(l,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Cs(this.comparator);return t.data=e,t}}class W2{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Ir{constructor(e){this.fields=e,e.sort(zs.comparator)}static empty(){return new Ir([])}unionWith(e){let t=new Cs(zs.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Ir(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Kl(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class z_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Fs{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(l){try{return atob(l)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new z_("Invalid base64 string: "+u):u}})(e);return new Fs(t)}static fromUint8Array(e){const t=(function(l){let u="";for(let d=0;d<l.length;++d)u+=String.fromCharCode(l[d]);return u})(e);return new Fs(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Jt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Fs.EMPTY_BYTE_STRING=new Fs("");const DR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function so(s){if(yn(!!s,39018),typeof s=="string"){let e=0;const t=DR.exec(s);if(yn(!!t,46558,{timestamp:s}),t[1]){let l=t[1];l=(l+"000000000").substr(0,9),e=Number(l)}const i=new Date(s);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:hs(s.seconds),nanos:hs(s.nanos)}}function hs(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function ro(s){return typeof s=="string"?Fs.fromBase64String(s):Fs.fromUint8Array(s)}const F_="server_timestamp",H_="__type__",q_="__previous_value__",$_="__local_write_time__";function _y(s){return(s?.mapValue?.fields||{})[H_]?.stringValue===F_}function ff(s){const e=s.mapValue.fields[q_];return _y(e)?ff(e):e}function _u(s){const e=so(s.mapValue.fields[$_].timestampValue);return new Pt(e.seconds,e.nanos)}class LR{constructor(e,t,i,l,u,d,g,y,p,b,j){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=l,this.ssl=u,this.forceLongPolling=d,this.autoDetectLongPolling=g,this.longPollingOptions=y,this.useFetchStreams=p,this.isUsingEmulator=b,this.apiKey=j}}const qh="(default)";class ku{constructor(e,t){this.projectId=e,this.database=t||qh}static empty(){return new ku("","")}get isDefaultDatabase(){return this.database===qh}isEqual(e){return e instanceof ku&&e.projectId===this.projectId&&e.database===this.database}}function OR(s,e){if(!Object.prototype.hasOwnProperty.apply(s.options,["projectId"]))throw new We(be.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ku(s.options.projectId,e)}const W_="__type__",PR="__max__",dh={mapValue:{}},G_="__vector__",$h="value";function io(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?_y(s)?4:UR(s)?9007199254740991:VR(s)?10:11:_t(28295,{value:s})}function Ri(s,e){if(s===e)return!0;const t=io(s);if(t!==io(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return _u(s).isEqual(_u(e));case 3:return(function(l,u){if(typeof l.timestampValue=="string"&&typeof u.timestampValue=="string"&&l.timestampValue.length===u.timestampValue.length)return l.timestampValue===u.timestampValue;const d=so(l.timestampValue),g=so(u.timestampValue);return d.seconds===g.seconds&&d.nanos===g.nanos})(s,e);case 5:return s.stringValue===e.stringValue;case 6:return(function(l,u){return ro(l.bytesValue).isEqual(ro(u.bytesValue))})(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return(function(l,u){return hs(l.geoPointValue.latitude)===hs(u.geoPointValue.latitude)&&hs(l.geoPointValue.longitude)===hs(u.geoPointValue.longitude)})(s,e);case 2:return(function(l,u){if("integerValue"in l&&"integerValue"in u)return hs(l.integerValue)===hs(u.integerValue);if("doubleValue"in l&&"doubleValue"in u){const d=hs(l.doubleValue),g=hs(u.doubleValue);return d===g?Hh(d)===Hh(g):isNaN(d)&&isNaN(g)}return!1})(s,e);case 9:return Kl(s.arrayValue.values||[],e.arrayValue.values||[],Ri);case 10:case 11:return(function(l,u){const d=l.mapValue.fields||{},g=u.mapValue.fields||{};if($2(d)!==$2(g))return!1;for(const y in d)if(d.hasOwnProperty(y)&&(g[y]===void 0||!Ri(d[y],g[y])))return!1;return!0})(s,e);default:return _t(52216,{left:s})}}function ju(s,e){return(s.values||[]).find((t=>Ri(t,e)))!==void 0}function Yl(s,e){if(s===e)return 0;const t=io(s),i=io(e);if(t!==i)return Jt(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Jt(s.booleanValue,e.booleanValue);case 2:return(function(u,d){const g=hs(u.integerValue||u.doubleValue),y=hs(d.integerValue||d.doubleValue);return g<y?-1:g>y?1:g===y?0:isNaN(g)?isNaN(y)?0:-1:1})(s,e);case 3:return G2(s.timestampValue,e.timestampValue);case 4:return G2(_u(s),_u(e));case 5:return Np(s.stringValue,e.stringValue);case 6:return(function(u,d){const g=ro(u),y=ro(d);return g.compareTo(y)})(s.bytesValue,e.bytesValue);case 7:return(function(u,d){const g=u.split("/"),y=d.split("/");for(let p=0;p<g.length&&p<y.length;p++){const b=Jt(g[p],y[p]);if(b!==0)return b}return Jt(g.length,y.length)})(s.referenceValue,e.referenceValue);case 8:return(function(u,d){const g=Jt(hs(u.latitude),hs(d.latitude));return g!==0?g:Jt(hs(u.longitude),hs(d.longitude))})(s.geoPointValue,e.geoPointValue);case 9:return K2(s.arrayValue,e.arrayValue);case 10:return(function(u,d){const g=u.fields||{},y=d.fields||{},p=g[$h]?.arrayValue,b=y[$h]?.arrayValue,j=Jt(p?.values?.length||0,b?.values?.length||0);return j!==0?j:K2(p,b)})(s.mapValue,e.mapValue);case 11:return(function(u,d){if(u===dh.mapValue&&d===dh.mapValue)return 0;if(u===dh.mapValue)return 1;if(d===dh.mapValue)return-1;const g=u.fields||{},y=Object.keys(g),p=d.fields||{},b=Object.keys(p);y.sort(),b.sort();for(let j=0;j<y.length&&j<b.length;++j){const S=Np(y[j],b[j]);if(S!==0)return S;const R=Yl(g[y[j]],p[b[j]]);if(R!==0)return R}return Jt(y.length,b.length)})(s.mapValue,e.mapValue);default:throw _t(23264,{he:t})}}function G2(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return Jt(s,e);const t=so(s),i=so(e),l=Jt(t.seconds,i.seconds);return l!==0?l:Jt(t.nanos,i.nanos)}function K2(s,e){const t=s.values||[],i=e.values||[];for(let l=0;l<t.length&&l<i.length;++l){const u=Yl(t[l],i[l]);if(u)return u}return Jt(t.length,i.length)}function Ql(s){return Ap(s)}function Ap(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?(function(t){const i=so(t);return`time(${i.seconds},${i.nanos})`})(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?(function(t){return ro(t).toBase64()})(s.bytesValue):"referenceValue"in s?(function(t){return ht.fromName(t).toString()})(s.referenceValue):"geoPointValue"in s?(function(t){return`geo(${t.latitude},${t.longitude})`})(s.geoPointValue):"arrayValue"in s?(function(t){let i="[",l=!0;for(const u of t.values||[])l?l=!1:i+=",",i+=Ap(u);return i+"]"})(s.arrayValue):"mapValue"in s?(function(t){const i=Object.keys(t.fields||{}).sort();let l="{",u=!0;for(const d of i)u?u=!1:l+=",",l+=`${d}:${Ap(t.fields[d])}`;return l+"}"})(s.mapValue):_t(61005,{value:s})}function Ch(s){switch(io(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=ff(s);return e?16+Ch(e):16;case 5:return 2*s.stringValue.length;case 6:return ro(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((l,u)=>l+Ch(u)),0)})(s.arrayValue);case 10:case 11:return(function(i){let l=0;return uo(i.fields,((u,d)=>{l+=u.length+Ch(d)})),l})(s.mapValue);default:throw _t(13486,{value:s})}}function Y2(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function Rp(s){return!!s&&"integerValue"in s}function ky(s){return!!s&&"arrayValue"in s}function Q2(s){return!!s&&"nullValue"in s}function X2(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function Nh(s){return!!s&&"mapValue"in s}function VR(s){return(s?.mapValue?.fields||{})[W_]?.stringValue===G_}function du(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return uo(s.mapValue.fields,((t,i)=>e.mapValue.fields[t]=du(i))),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(s.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=du(s.arrayValue.values[t]);return e}return{...s}}function UR(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===PR}class yr{constructor(e){this.value=e}static empty(){return new yr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Nh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=du(t)}setAll(e){let t=zs.emptyPath(),i={},l=[];e.forEach(((d,g)=>{if(!t.isImmediateParentOf(g)){const y=this.getFieldsMap(t);this.applyChanges(y,i,l),i={},l=[],t=g.popLast()}d?i[g.lastSegment()]=du(d):l.push(g.lastSegment())}));const u=this.getFieldsMap(t);this.applyChanges(u,i,l)}delete(e){const t=this.field(e.popLast());Nh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ri(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let l=t.mapValue.fields[e.get(i)];Nh(l)&&l.mapValue.fields||(l={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=l),t=l}return t.mapValue.fields}applyChanges(e,t,i){uo(t,((l,u)=>e[l]=u));for(const l of i)delete e[l]}clone(){return new yr(du(this.value))}}function K_(s){const e=[];return uo(s.fields,((t,i)=>{const l=new zs([t]);if(Nh(i)){const u=K_(i.mapValue).fields;if(u.length===0)e.push(l);else for(const d of u)e.push(l.child(d))}else e.push(l)})),new Ir(e)}class Gs{constructor(e,t,i,l,u,d,g){this.key=e,this.documentType=t,this.version=i,this.readTime=l,this.createTime=u,this.data=d,this.documentState=g}static newInvalidDocument(e){return new Gs(e,0,St.min(),St.min(),St.min(),yr.empty(),0)}static newFoundDocument(e,t,i,l){return new Gs(e,1,t,St.min(),i,l,0)}static newNoDocument(e,t){return new Gs(e,2,t,St.min(),St.min(),yr.empty(),0)}static newUnknownDocument(e,t){return new Gs(e,3,t,St.min(),St.min(),yr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(St.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=yr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=yr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=St.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Gs&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Gs(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Wh{constructor(e,t){this.position=e,this.inclusive=t}}function J2(s,e,t){let i=0;for(let l=0;l<s.position.length;l++){const u=e[l],d=s.position[l];if(u.field.isKeyField()?i=ht.comparator(ht.fromName(d.referenceValue),t.key):i=Yl(d,t.data.field(u.field)),u.dir==="desc"&&(i*=-1),i!==0)break}return i}function Z2(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let t=0;t<s.position.length;t++)if(!Ri(s.position[t],e.position[t]))return!1;return!0}class Eu{constructor(e,t="asc"){this.field=e,this.dir=t}}function BR(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}class Y_{}class bs extends Y_{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new FR(e,t,i):t==="array-contains"?new $R(e,i):t==="in"?new WR(e,i):t==="not-in"?new GR(e,i):t==="array-contains-any"?new KR(e,i):new bs(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new HR(e,i):new qR(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Yl(t,this.value)):t!==null&&io(this.value)===io(t)&&this.matchesComparison(Yl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return _t(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class hi extends Y_{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new hi(e,t)}matches(e){return Q_(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Q_(s){return s.op==="and"}function X_(s){return zR(s)&&Q_(s)}function zR(s){for(const e of s.filters)if(e instanceof hi)return!1;return!0}function Ip(s){if(s instanceof bs)return s.field.canonicalString()+s.op.toString()+Ql(s.value);if(X_(s))return s.filters.map((e=>Ip(e))).join(",");{const e=s.filters.map((t=>Ip(t))).join(",");return`${s.op}(${e})`}}function J_(s,e){return s instanceof bs?(function(i,l){return l instanceof bs&&i.op===l.op&&i.field.isEqual(l.field)&&Ri(i.value,l.value)})(s,e):s instanceof hi?(function(i,l){return l instanceof hi&&i.op===l.op&&i.filters.length===l.filters.length?i.filters.reduce(((u,d,g)=>u&&J_(d,l.filters[g])),!0):!1})(s,e):void _t(19439)}function Z_(s){return s instanceof bs?(function(t){return`${t.field.canonicalString()} ${t.op} ${Ql(t.value)}`})(s):s instanceof hi?(function(t){return t.op.toString()+" {"+t.getFilters().map(Z_).join(" ,")+"}"})(s):"Filter"}class FR extends bs{constructor(e,t,i){super(e,t,i),this.key=ht.fromName(i.referenceValue)}matches(e){const t=ht.comparator(e.key,this.key);return this.matchesComparison(t)}}class HR extends bs{constructor(e,t){super(e,"in",t),this.keys=ek("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class qR extends bs{constructor(e,t){super(e,"not-in",t),this.keys=ek("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function ek(s,e){return(e.arrayValue?.values||[]).map((t=>ht.fromName(t.referenceValue)))}class $R extends bs{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return ky(t)&&ju(t.arrayValue,this.value)}}class WR extends bs{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&ju(this.value.arrayValue,t)}}class GR extends bs{constructor(e,t){super(e,"not-in",t)}matches(e){if(ju(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!ju(this.value.arrayValue,t)}}class KR extends bs{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!ky(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>ju(this.value.arrayValue,i)))}}class YR{constructor(e,t=null,i=[],l=[],u=null,d=null,g=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=l,this.limit=u,this.startAt=d,this.endAt=g,this.Te=null}}function ew(s,e=null,t=[],i=[],l=null,u=null,d=null){return new YR(s,e,t,i,l,u,d)}function jy(s){const e=Nt(s);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>Ip(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(u){return u.field.canonicalString()+u.dir})(i))).join(","),hf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Ql(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Ql(i))).join(",")),e.Te=t}return e.Te}function Ey(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<s.orderBy.length;t++)if(!BR(s.orderBy[t],e.orderBy[t]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let t=0;t<s.filters.length;t++)if(!J_(s.filters[t],e.filters[t]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!Z2(s.startAt,e.startAt)&&Z2(s.endAt,e.endAt)}function Mp(s){return ht.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}class lc{constructor(e,t=null,i=[],l=[],u=null,d="F",g=null,y=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=l,this.limit=u,this.limitType=d,this.startAt=g,this.endAt=y,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function QR(s,e,t,i,l,u,d,g){return new lc(s,e,t,i,l,u,d,g)}function mf(s){return new lc(s)}function tw(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function XR(s){return ht.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}function tk(s){return s.collectionGroup!==null}function hu(s){const e=Nt(s);if(e.Ie===null){e.Ie=[];const t=new Set;for(const u of e.explicitOrderBy)e.Ie.push(u),t.add(u.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let g=new Cs(zs.comparator);return d.filters.forEach((y=>{y.getFlattenedFilters().forEach((p=>{p.isInequality()&&(g=g.add(p.field))}))})),g})(e).forEach((u=>{t.has(u.canonicalString())||u.isKeyField()||e.Ie.push(new Eu(u,i))})),t.has(zs.keyField().canonicalString())||e.Ie.push(new Eu(zs.keyField(),i))}return e.Ie}function Ci(s){const e=Nt(s);return e.Ee||(e.Ee=JR(e,hu(s))),e.Ee}function JR(s,e){if(s.limitType==="F")return ew(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map((l=>{const u=l.dir==="desc"?"asc":"desc";return new Eu(l.field,u)}));const t=s.endAt?new Wh(s.endAt.position,s.endAt.inclusive):null,i=s.startAt?new Wh(s.startAt.position,s.startAt.inclusive):null;return ew(s.path,s.collectionGroup,e,s.filters,s.limit,t,i)}}function Dp(s,e){const t=s.filters.concat([e]);return new lc(s.path,s.collectionGroup,s.explicitOrderBy.slice(),t,s.limit,s.limitType,s.startAt,s.endAt)}function ZR(s,e){const t=s.explicitOrderBy.concat([e]);return new lc(s.path,s.collectionGroup,t,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}function Gh(s,e,t){return new lc(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,t,s.startAt,s.endAt)}function gf(s,e){return Ey(Ci(s),Ci(e))&&s.limitType===e.limitType}function nk(s){return`${jy(Ci(s))}|lt:${s.limitType}`}function Pl(s){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((l=>Z_(l))).join(", ")}]`),hf(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((l=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(l))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((l=>Ql(l))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((l=>Ql(l))).join(",")),`Target(${i})`})(Ci(s))}; limitType=${s.limitType})`}function pf(s,e){return e.isFoundDocument()&&(function(i,l){const u=l.key.path;return i.collectionGroup!==null?l.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(u):ht.isDocumentKey(i.path)?i.path.isEqual(u):i.path.isImmediateParentOf(u)})(s,e)&&(function(i,l){for(const u of hu(i))if(!u.field.isKeyField()&&l.data.field(u.field)===null)return!1;return!0})(s,e)&&(function(i,l){for(const u of i.filters)if(!u.matches(l))return!1;return!0})(s,e)&&(function(i,l){return!(i.startAt&&!(function(d,g,y){const p=J2(d,g,y);return d.inclusive?p<=0:p<0})(i.startAt,hu(i),l)||i.endAt&&!(function(d,g,y){const p=J2(d,g,y);return d.inclusive?p>=0:p>0})(i.endAt,hu(i),l))})(s,e)}function eI(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function sk(s){return(e,t)=>{let i=!1;for(const l of hu(s)){const u=tI(l,e,t);if(u!==0)return u;i=i||l.field.isKeyField()}return 0}}function tI(s,e,t){const i=s.field.isKeyField()?ht.comparator(e.key,t.key):(function(u,d,g){const y=d.data.field(u),p=g.data.field(u);return y!==null&&p!==null?Yl(y,p):_t(42886)})(s.field,e,t);switch(s.dir){case"asc":return i;case"desc":return-1*i;default:return _t(19790,{direction:s.dir})}}class Jo{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[l,u]of i)if(this.equalsFn(l,e))return u}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),l=this.inner[i];if(l===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let u=0;u<l.length;u++)if(this.equalsFn(l[u][0],e))return void(l[u]=[e,t]);l.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let l=0;l<i.length;l++)if(this.equalsFn(i[l][0],e))return i.length===1?delete this.inner[t]:i.splice(l,1),this.innerSize--,!0;return!1}forEach(e){uo(this.inner,((t,i)=>{for(const[l,u]of i)e(l,u)}))}isEmpty(){return B_(this.inner)}size(){return this.innerSize}}const nI=new Yn(ht.comparator);function fa(){return nI}const rk=new Yn(ht.comparator);function au(...s){let e=rk;for(const t of s)e=e.insert(t.key,t);return e}function ik(s){let e=rk;return s.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Do(){return fu()}function ak(){return fu()}function fu(){return new Jo((s=>s.toString()),((s,e)=>s.isEqual(e)))}const sI=new Yn(ht.comparator),rI=new Cs(ht.comparator);function Zt(...s){let e=rI;for(const t of s)e=e.add(t);return e}const iI=new Cs(Jt);function aI(){return iI}function Ty(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Hh(e)?"-0":e}}function ok(s){return{integerValue:""+s}}function lk(s,e){return RR(e)?ok(e):Ty(s,e)}class yf{constructor(){this._=void 0}}function oI(s,e,t){return s instanceof Tu?(function(l,u){const d={fields:{[H_]:{stringValue:F_},[$_]:{timestampValue:{seconds:l.seconds,nanos:l.nanoseconds}}}};return u&&_y(u)&&(u=ff(u)),u&&(d.fields[q_]=u),{mapValue:d}})(t,e):s instanceof Xl?uk(s,e):s instanceof Jl?dk(s,e):(function(l,u){const d=ck(l,u),g=nw(d)+nw(l.Ae);return Rp(d)&&Rp(l.Ae)?ok(g):Ty(l.serializer,g)})(s,e)}function lI(s,e,t){return s instanceof Xl?uk(s,e):s instanceof Jl?dk(s,e):t}function ck(s,e){return s instanceof Su?(function(i){return Rp(i)||(function(u){return!!u&&"doubleValue"in u})(i)})(e)?e:{integerValue:0}:null}class Tu extends yf{}class Xl extends yf{constructor(e){super(),this.elements=e}}function uk(s,e){const t=hk(e);for(const i of s.elements)t.some((l=>Ri(l,i)))||t.push(i);return{arrayValue:{values:t}}}class Jl extends yf{constructor(e){super(),this.elements=e}}function dk(s,e){let t=hk(e);for(const i of s.elements)t=t.filter((l=>!Ri(l,i)));return{arrayValue:{values:t}}}class Su extends yf{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function nw(s){return hs(s.integerValue||s.doubleValue)}function hk(s){return ky(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}class vf{constructor(e,t){this.field=e,this.transform=t}}function cI(s,e){return s.field.isEqual(e.field)&&(function(i,l){return i instanceof Xl&&l instanceof Xl||i instanceof Jl&&l instanceof Jl?Kl(i.elements,l.elements,Ri):i instanceof Su&&l instanceof Su?Ri(i.Ae,l.Ae):i instanceof Tu&&l instanceof Tu})(s.transform,e.transform)}class uI{constructor(e,t){this.version=e,this.transformResults=t}}class lr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new lr}static exists(e){return new lr(void 0,e)}static updateTime(e){return new lr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ah(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class bf{}function fk(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new wf(s.key,lr.none()):new Uu(s.key,s.data,lr.none());{const t=s.data,i=yr.empty();let l=new Cs(zs.comparator);for(let u of e.fields)if(!l.has(u)){let d=t.field(u);d===null&&u.length>1&&(u=u.popLast(),d=t.field(u)),d===null?i.delete(u):i.set(u,d),l=l.add(u)}return new ho(s.key,i,new Ir(l.toArray()),lr.none())}}function dI(s,e,t){s instanceof Uu?(function(l,u,d){const g=l.value.clone(),y=rw(l.fieldTransforms,u,d.transformResults);g.setAll(y),u.convertToFoundDocument(d.version,g).setHasCommittedMutations()})(s,e,t):s instanceof ho?(function(l,u,d){if(!Ah(l.precondition,u))return void u.convertToUnknownDocument(d.version);const g=rw(l.fieldTransforms,u,d.transformResults),y=u.data;y.setAll(mk(l)),y.setAll(g),u.convertToFoundDocument(d.version,y).setHasCommittedMutations()})(s,e,t):(function(l,u,d){u.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function mu(s,e,t,i){return s instanceof Uu?(function(u,d,g,y){if(!Ah(u.precondition,d))return g;const p=u.value.clone(),b=iw(u.fieldTransforms,y,d);return p.setAll(b),d.convertToFoundDocument(d.version,p).setHasLocalMutations(),null})(s,e,t,i):s instanceof ho?(function(u,d,g,y){if(!Ah(u.precondition,d))return g;const p=iw(u.fieldTransforms,y,d),b=d.data;return b.setAll(mk(u)),b.setAll(p),d.convertToFoundDocument(d.version,b).setHasLocalMutations(),g===null?null:g.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((j=>j.field)))})(s,e,t,i):(function(u,d,g){return Ah(u.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):g})(s,e,t)}function hI(s,e){let t=null;for(const i of s.fieldTransforms){const l=e.data.field(i.field),u=ck(i.transform,l||null);u!=null&&(t===null&&(t=yr.empty()),t.set(i.field,u))}return t||null}function sw(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!(function(i,l){return i===void 0&&l===void 0||!(!i||!l)&&Kl(i,l,((u,d)=>cI(u,d)))})(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class Uu extends bf{constructor(e,t,i,l=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=l,this.type=0}getFieldMask(){return null}}class ho extends bf{constructor(e,t,i,l,u=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=l,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function mk(s){const e=new Map;return s.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=s.data.field(t);e.set(t,i)}})),e}function rw(s,e,t){const i=new Map;yn(s.length===t.length,32656,{Ve:t.length,de:s.length});for(let l=0;l<t.length;l++){const u=s[l],d=u.transform,g=e.data.field(u.field);i.set(u.field,lI(d,g,t[l]))}return i}function iw(s,e,t){const i=new Map;for(const l of s){const u=l.transform,d=t.data.field(l.field);i.set(l.field,oI(u,d,e))}return i}class wf extends bf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class fI extends bf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class mI{constructor(e,t,i,l){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=l}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let l=0;l<this.mutations.length;l++){const u=this.mutations[l];u.key.isEqual(e.key)&&dI(u,e,i[l])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=mu(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=mu(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=ak();return this.mutations.forEach((l=>{const u=e.get(l.key),d=u.overlayedDocument;let g=this.applyToLocalView(d,u.mutatedFields);g=t.has(l.key)?null:g;const y=fk(d,g);y!==null&&i.set(l.key,y),d.isValidDocument()||d.convertToNoDocument(St.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Zt())}isEqual(e){return this.batchId===e.batchId&&Kl(this.mutations,e.mutations,((t,i)=>sw(t,i)))&&Kl(this.baseMutations,e.baseMutations,((t,i)=>sw(t,i)))}}class Sy{constructor(e,t,i,l){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=l}static from(e,t,i){yn(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let l=(function(){return sI})();const u=e.mutations;for(let d=0;d<u.length;d++)l=l.insert(u[d].key,i[d].version);return new Sy(e,t,i,l)}}class gI{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class pI{constructor(e,t){this.count=e,this.unchangedNames=t}}var vs,rn;function yI(s){switch(s){case be.OK:return _t(64938);case be.CANCELLED:case be.UNKNOWN:case be.DEADLINE_EXCEEDED:case be.RESOURCE_EXHAUSTED:case be.INTERNAL:case be.UNAVAILABLE:case be.UNAUTHENTICATED:return!1;case be.INVALID_ARGUMENT:case be.NOT_FOUND:case be.ALREADY_EXISTS:case be.PERMISSION_DENIED:case be.FAILED_PRECONDITION:case be.ABORTED:case be.OUT_OF_RANGE:case be.UNIMPLEMENTED:case be.DATA_LOSS:return!0;default:return _t(15467,{code:s})}}function gk(s){if(s===void 0)return ha("GRPC error has no .code"),be.UNKNOWN;switch(s){case vs.OK:return be.OK;case vs.CANCELLED:return be.CANCELLED;case vs.UNKNOWN:return be.UNKNOWN;case vs.DEADLINE_EXCEEDED:return be.DEADLINE_EXCEEDED;case vs.RESOURCE_EXHAUSTED:return be.RESOURCE_EXHAUSTED;case vs.INTERNAL:return be.INTERNAL;case vs.UNAVAILABLE:return be.UNAVAILABLE;case vs.UNAUTHENTICATED:return be.UNAUTHENTICATED;case vs.INVALID_ARGUMENT:return be.INVALID_ARGUMENT;case vs.NOT_FOUND:return be.NOT_FOUND;case vs.ALREADY_EXISTS:return be.ALREADY_EXISTS;case vs.PERMISSION_DENIED:return be.PERMISSION_DENIED;case vs.FAILED_PRECONDITION:return be.FAILED_PRECONDITION;case vs.ABORTED:return be.ABORTED;case vs.OUT_OF_RANGE:return be.OUT_OF_RANGE;case vs.UNIMPLEMENTED:return be.UNIMPLEMENTED;case vs.DATA_LOSS:return be.DATA_LOSS;default:return _t(39323,{code:s})}}(rn=vs||(vs={}))[rn.OK=0]="OK",rn[rn.CANCELLED=1]="CANCELLED",rn[rn.UNKNOWN=2]="UNKNOWN",rn[rn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",rn[rn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",rn[rn.NOT_FOUND=5]="NOT_FOUND",rn[rn.ALREADY_EXISTS=6]="ALREADY_EXISTS",rn[rn.PERMISSION_DENIED=7]="PERMISSION_DENIED",rn[rn.UNAUTHENTICATED=16]="UNAUTHENTICATED",rn[rn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",rn[rn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",rn[rn.ABORTED=10]="ABORTED",rn[rn.OUT_OF_RANGE=11]="OUT_OF_RANGE",rn[rn.UNIMPLEMENTED=12]="UNIMPLEMENTED",rn[rn.INTERNAL=13]="INTERNAL",rn[rn.UNAVAILABLE=14]="UNAVAILABLE",rn[rn.DATA_LOSS=15]="DATA_LOSS";function vI(){return new TextEncoder}const bI=new Za([4294967295,4294967295],0);function aw(s){const e=vI().encode(s),t=new N_;return t.update(e),new Uint8Array(t.digest())}function ow(s){const e=new DataView(s.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),l=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new Za([t,i],0),new Za([l,u],0)]}class Cy{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new ou(`Invalid padding: ${t}`);if(i<0)throw new ou(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new ou(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new ou(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Za.fromNumber(this.ge)}ye(e,t,i){let l=e.add(t.multiply(Za.fromNumber(i)));return l.compare(bI)===1&&(l=new Za([l.getBits(0),l.getBits(1)],0)),l.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=aw(e),[i,l]=ow(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);if(!this.we(d))return!1}return!0}static create(e,t,i){const l=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),d=new Cy(u,l,t);return i.forEach((g=>d.insert(g))),d}insert(e){if(this.ge===0)return;const t=aw(e),[i,l]=ow(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);this.be(d)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class ou extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class xf{constructor(e,t,i,l,u){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=l,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const l=new Map;return l.set(e,Bu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new xf(St.min(),l,new Yn(Jt),fa(),Zt())}}class Bu{constructor(e,t,i,l,u){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=l,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Bu(i,t,Zt(),Zt(),Zt())}}class Rh{constructor(e,t,i,l){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=l}}class pk{constructor(e,t){this.targetId=e,this.Ce=t}}class yk{constructor(e,t,i=Fs.EMPTY_BYTE_STRING,l=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=l}}class lw{constructor(){this.ve=0,this.Fe=cw(),this.Me=Fs.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Zt(),t=Zt(),i=Zt();return this.Fe.forEach(((l,u)=>{switch(u){case 0:e=e.add(l);break;case 2:t=t.add(l);break;case 1:i=i.add(l);break;default:_t(38017,{changeType:u})}})),new Bu(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=cw()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,yn(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class wI{constructor(e){this.Ge=e,this.ze=new Map,this.je=fa(),this.He=hh(),this.Je=hh(),this.Ze=new Yn(Jt)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:_t(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,l)=>{this.rt(l)&&t(l)}))}st(e){const t=e.targetId,i=e.Ce.count,l=this.ot(t);if(l){const u=l.target;if(Mp(u))if(i===0){const d=new ht(u.path);this.et(t,d,Gs.newNoDocument(d,St.min()))}else yn(i===1,20013,{expectedCount:i});else{const d=this._t(t);if(d!==i){const g=this.ut(e),y=g?this.ct(g,e,d):1;if(y!==0){this.it(t);const p=y===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,p)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:l=0},hashCount:u=0}=t;let d,g;try{d=ro(i).toUint8Array()}catch(y){if(y instanceof z_)return Gl("Decoding the base64 bloom filter in existence filter failed ("+y.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw y}try{g=new Cy(d,l,u)}catch(y){return Gl(y instanceof ou?"BloomFilter error: ":"Applying bloom filter failed: ",y),null}return g.ge===0?null:g}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let l=0;return i.forEach((u=>{const d=this.Ge.ht(),g=`projects/${d.projectId}/databases/${d.database}/documents/${u.path.canonicalString()}`;e.mightContain(g)||(this.et(t,u,null),l++)})),l}Tt(e){const t=new Map;this.ze.forEach(((u,d)=>{const g=this.ot(d);if(g){if(u.current&&Mp(g.target)){const y=new ht(g.target.path);this.It(y).has(d)||this.Et(d,y)||this.et(d,y,Gs.newNoDocument(y,e))}u.Be&&(t.set(d,u.ke()),u.Ke())}}));let i=Zt();this.Je.forEach(((u,d)=>{let g=!0;d.forEachWhile((y=>{const p=this.ot(y);return!p||p.purpose==="TargetPurposeLimboResolution"||(g=!1,!1)})),g&&(i=i.add(u))})),this.je.forEach(((u,d)=>d.setReadTime(e)));const l=new xf(e,t,this.Ze,this.je,i);return this.je=fa(),this.He=hh(),this.Je=hh(),this.Ze=new Yn(Jt),l}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const l=this.nt(e);this.Et(e,t)?l.qe(t,1):l.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new lw,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Cs(Jt),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Cs(Jt),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Je("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new lw),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function hh(){return new Yn(ht.comparator)}function cw(){return new Yn(ht.comparator)}const xI={asc:"ASCENDING",desc:"DESCENDING"},_I={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},kI={and:"AND",or:"OR"};class jI{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Lp(s,e){return s.useProto3Json||hf(e)?e:{value:e}}function Kh(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function vk(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function EI(s,e){return Kh(s,e.toTimestamp())}function Ni(s){return yn(!!s,49232),St.fromTimestamp((function(t){const i=so(t);return new Pt(i.seconds,i.nanos)})(s))}function Ny(s,e){return Op(s,e).canonicalString()}function Op(s,e){const t=(function(l){return new Dn(["projects",l.projectId,"databases",l.database])})(s).child("documents");return e===void 0?t:t.child(e)}function bk(s){const e=Dn.fromString(s);return yn(jk(e),10190,{key:e.toString()}),e}function Pp(s,e){return Ny(s.databaseId,e.path)}function qg(s,e){const t=bk(e);if(t.get(1)!==s.databaseId.projectId)throw new We(be.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+s.databaseId.projectId);if(t.get(3)!==s.databaseId.database)throw new We(be.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+s.databaseId.database);return new ht(xk(t))}function wk(s,e){return Ny(s.databaseId,e)}function TI(s){const e=bk(s);return e.length===4?Dn.emptyPath():xk(e)}function Vp(s){return new Dn(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function xk(s){return yn(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function uw(s,e,t){return{name:Pp(s,e),fields:t.value.mapValue.fields}}function SI(s,e){let t;if("targetChange"in e){e.targetChange;const i=(function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:_t(39313,{state:p})})(e.targetChange.targetChangeType||"NO_CHANGE"),l=e.targetChange.targetIds||[],u=(function(p,b){return p.useProto3Json?(yn(b===void 0||typeof b=="string",58123),Fs.fromBase64String(b||"")):(yn(b===void 0||b instanceof Buffer||b instanceof Uint8Array,16193),Fs.fromUint8Array(b||new Uint8Array))})(s,e.targetChange.resumeToken),d=e.targetChange.cause,g=d&&(function(p){const b=p.code===void 0?be.UNKNOWN:gk(p.code);return new We(b,p.message||"")})(d);t=new yk(i,l,u,g||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const l=qg(s,i.document.name),u=Ni(i.document.updateTime),d=i.document.createTime?Ni(i.document.createTime):St.min(),g=new yr({mapValue:{fields:i.document.fields}}),y=Gs.newFoundDocument(l,u,d,g),p=i.targetIds||[],b=i.removedTargetIds||[];t=new Rh(p,b,y.key,y)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const l=qg(s,i.document),u=i.readTime?Ni(i.readTime):St.min(),d=Gs.newNoDocument(l,u),g=i.removedTargetIds||[];t=new Rh([],g,d.key,d)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const l=qg(s,i.document),u=i.removedTargetIds||[];t=new Rh([],u,l,null)}else{if(!("filter"in e))return _t(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:l=0,unchangedNames:u}=i,d=new pI(l,u),g=i.targetId;t=new pk(g,d)}}return t}function CI(s,e){let t;if(e instanceof Uu)t={update:uw(s,e.key,e.value)};else if(e instanceof wf)t={delete:Pp(s,e.key)};else if(e instanceof ho)t={update:uw(s,e.key,e.data),updateMask:PI(e.fieldMask)};else{if(!(e instanceof fI))return _t(16599,{dt:e.type});t={verify:Pp(s,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(u,d){const g=d.transform;if(g instanceof Tu)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(g instanceof Xl)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:g.elements}};if(g instanceof Jl)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:g.elements}};if(g instanceof Su)return{fieldPath:d.field.canonicalString(),increment:g.Ae};throw _t(20930,{transform:d.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(l,u){return u.updateTime!==void 0?{updateTime:EI(l,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:_t(27497)})(s,e.precondition)),t}function NI(s,e){return s&&s.length>0?(yn(e!==void 0,14353),s.map((t=>(function(l,u){let d=l.updateTime?Ni(l.updateTime):Ni(u);return d.isEqual(St.min())&&(d=Ni(u)),new uI(d,l.transformResults||[])})(t,e)))):[]}function AI(s,e){return{documents:[wk(s,e.path)]}}function RI(s,e){const t={structuredQuery:{}},i=e.path;let l;e.collectionGroup!==null?(l=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(l=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=wk(s,l);const u=(function(p){if(p.length!==0)return kk(hi.create(p,"and"))})(e.filters);u&&(t.structuredQuery.where=u);const d=(function(p){if(p.length!==0)return p.map((b=>(function(S){return{field:Vl(S.field),direction:DI(S.dir)}})(b)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const g=Lp(s,e.limit);return g!==null&&(t.structuredQuery.limit=g),e.startAt&&(t.structuredQuery.startAt=(function(p){return{before:p.inclusive,values:p.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(p){return{before:!p.inclusive,values:p.position}})(e.endAt)),{ft:t,parent:l}}function II(s){let e=TI(s.parent);const t=s.structuredQuery,i=t.from?t.from.length:0;let l=null;if(i>0){yn(i===1,65062);const b=t.from[0];b.allDescendants?l=b.collectionId:e=e.child(b.collectionId)}let u=[];t.where&&(u=(function(j){const S=_k(j);return S instanceof hi&&X_(S)?S.getFilters():[S]})(t.where));let d=[];t.orderBy&&(d=(function(j){return j.map((S=>(function(H){return new Eu(Ul(H.field),(function(B){switch(B){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(H.direction))})(S)))})(t.orderBy));let g=null;t.limit&&(g=(function(j){let S;return S=typeof j=="object"?j.value:j,hf(S)?null:S})(t.limit));let y=null;t.startAt&&(y=(function(j){const S=!!j.before,R=j.values||[];return new Wh(R,S)})(t.startAt));let p=null;return t.endAt&&(p=(function(j){const S=!j.before,R=j.values||[];return new Wh(R,S)})(t.endAt)),QR(e,l,d,u,g,"F",y,p)}function MI(s,e){const t=(function(l){switch(l){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return _t(28987,{purpose:l})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function _k(s){return s.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Ul(t.unaryFilter.field);return bs.create(i,"==",{doubleValue:NaN});case"IS_NULL":const l=Ul(t.unaryFilter.field);return bs.create(l,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=Ul(t.unaryFilter.field);return bs.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=Ul(t.unaryFilter.field);return bs.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return _t(61313);default:return _t(60726)}})(s):s.fieldFilter!==void 0?(function(t){return bs.create(Ul(t.fieldFilter.field),(function(l){switch(l){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return _t(58110);default:return _t(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(s):s.compositeFilter!==void 0?(function(t){return hi.create(t.compositeFilter.filters.map((i=>_k(i))),(function(l){switch(l){case"AND":return"and";case"OR":return"or";default:return _t(1026)}})(t.compositeFilter.op))})(s):_t(30097,{filter:s})}function DI(s){return xI[s]}function LI(s){return _I[s]}function OI(s){return kI[s]}function Vl(s){return{fieldPath:s.canonicalString()}}function Ul(s){return zs.fromServerFormat(s.fieldPath)}function kk(s){return s instanceof bs?(function(t){if(t.op==="=="){if(X2(t.value))return{unaryFilter:{field:Vl(t.field),op:"IS_NAN"}};if(Q2(t.value))return{unaryFilter:{field:Vl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(X2(t.value))return{unaryFilter:{field:Vl(t.field),op:"IS_NOT_NAN"}};if(Q2(t.value))return{unaryFilter:{field:Vl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Vl(t.field),op:LI(t.op),value:t.value}}})(s):s instanceof hi?(function(t){const i=t.getFilters().map((l=>kk(l)));return i.length===1?i[0]:{compositeFilter:{op:OI(t.op),filters:i}}})(s):_t(54877,{filter:s})}function PI(s){const e=[];return s.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function jk(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}function Ek(s){return!!s&&typeof s._toProto=="function"&&s._protoValueType==="ProtoValue"}class Xa{constructor(e,t,i,l,u=St.min(),d=St.min(),g=Fs.EMPTY_BYTE_STRING,y=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=l,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=g,this.expectedCount=y}withSequenceNumber(e){return new Xa(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Xa(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Xa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Xa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class VI{constructor(e){this.yt=e}}function UI(s){const e=II({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?Gh(e,e.limit,"L"):e}class BI{constructor(){this.Sn=new zI}addToCollectionParentIndex(e,t){return this.Sn.add(t),je.resolve()}getCollectionParents(e,t){return je.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return je.resolve()}deleteFieldIndex(e,t){return je.resolve()}deleteAllFieldIndexes(e){return je.resolve()}createTargetIndexes(e,t){return je.resolve()}getDocumentsMatchingTarget(e,t){return je.resolve(null)}getIndexType(e,t){return je.resolve(0)}getFieldIndexes(e,t){return je.resolve([])}getNextCollectionGroupToUpdate(e){return je.resolve(null)}getMinOffset(e,t){return je.resolve(no.min())}getMinOffsetFromCollectionGroup(e,t){return je.resolve(no.min())}updateCollectionGroup(e,t,i){return je.resolve()}updateIndexEntries(e,t){return je.resolve()}}class zI{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t]||new Cs(Dn.comparator),u=!l.has(i);return this.index[t]=l.add(i),u}has(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t];return l&&l.has(i)}getEntries(e){return(this.index[e]||new Cs(Dn.comparator)).toArray()}}const dw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Tk=41943040;class pr{static withCacheSize(e){return new pr(e,pr.DEFAULT_COLLECTION_PERCENTILE,pr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}pr.DEFAULT_COLLECTION_PERCENTILE=10,pr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,pr.DEFAULT=new pr(Tk,pr.DEFAULT_COLLECTION_PERCENTILE,pr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),pr.DISABLED=new pr(-1,0,0);class Zl{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Zl(0)}static ar(){return new Zl(-1)}}const hw="LruGarbageCollector",FI=1048576;function fw([s,e],[t,i]){const l=Jt(s,t);return l===0?Jt(e,i):l}class HI{constructor(e){this.Pr=e,this.buffer=new Cs(fw),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();fw(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class qI{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){Je(hw,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){oc(t)?Je(hw,"Ignoring IndexedDB error during garbage collection: ",t):await ac(t)}await this.Ar(3e5)}))}}class $I{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return je.resolve(df.ce);const i=new HI(t);return this.Vr.forEachTarget(e,(l=>i.Er(l.sequenceNumber))).next((()=>this.Vr.mr(e,(l=>i.Er(l))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Je("LruGarbageCollector","Garbage collection skipped; disabled"),je.resolve(dw)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(Je("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),dw):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,l,u,d,g,y,p;const b=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((j=>(j>this.params.maximumSequenceNumbersToCollect?(Je("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${j}`),l=this.params.maximumSequenceNumbersToCollect):l=j,d=Date.now(),this.nthSequenceNumber(e,l)))).next((j=>(i=j,g=Date.now(),this.removeTargets(e,i,t)))).next((j=>(u=j,y=Date.now(),this.removeOrphanedDocuments(e,i)))).next((j=>(p=Date.now(),Ol()<=Qt.DEBUG&&Je("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-b}ms
	Determined least recently used ${l} in `+(g-d)+`ms
	Removed ${u} targets in `+(y-g)+`ms
	Removed ${j} documents in `+(p-y)+`ms
Total Duration: ${p-b}ms`),je.resolve({didRun:!0,sequenceNumbersCollected:l,targetsRemoved:u,documentsRemoved:j}))))}}function WI(s,e){return new $I(s,e)}class GI{constructor(){this.changes=new Jo((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Gs.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?je.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class KI{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class YI{constructor(e,t,i,l){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=l}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((l=>(i=l,this.remoteDocumentCache.getEntry(e,t)))).next((l=>(i!==null&&mu(i.mutation,l,Ir.empty(),Pt.now()),l)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Zt()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Zt()){const l=Do();return this.populateOverlays(e,l,t).next((()=>this.computeViews(e,t,l,i).next((u=>{let d=au();return u.forEach(((g,y)=>{d=d.insert(g,y.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const i=Do();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Zt())))}populateOverlays(e,t,i){const l=[];return i.forEach((u=>{t.has(u)||l.push(u)})),this.documentOverlayCache.getOverlays(e,l).next((u=>{u.forEach(((d,g)=>{t.set(d,g)}))}))}computeViews(e,t,i,l){let u=fa();const d=fu(),g=(function(){return fu()})();return t.forEach(((y,p)=>{const b=i.get(p.key);l.has(p.key)&&(b===void 0||b.mutation instanceof ho)?u=u.insert(p.key,p):b!==void 0?(d.set(p.key,b.mutation.getFieldMask()),mu(b.mutation,p,b.mutation.getFieldMask(),Pt.now())):d.set(p.key,Ir.empty())})),this.recalculateAndSaveOverlays(e,u).next((y=>(y.forEach(((p,b)=>d.set(p,b))),t.forEach(((p,b)=>g.set(p,new KI(b,d.get(p)??null)))),g)))}recalculateAndSaveOverlays(e,t){const i=fu();let l=new Yn(((d,g)=>d-g)),u=Zt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const g of d)g.keys().forEach((y=>{const p=t.get(y);if(p===null)return;let b=i.get(y)||Ir.empty();b=g.applyToLocalView(p,b),i.set(y,b);const j=(l.get(g.batchId)||Zt()).add(y);l=l.insert(g.batchId,j)}))})).next((()=>{const d=[],g=l.getReverseIterator();for(;g.hasNext();){const y=g.getNext(),p=y.key,b=y.value,j=ak();b.forEach((S=>{if(!u.has(S)){const R=fk(t.get(S),i.get(S));R!==null&&j.set(S,R),u=u.add(S)}})),d.push(this.documentOverlayCache.saveOverlays(e,p,j))}return je.waitFor(d)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,l){return XR(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):tk(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,l):this.getDocumentsMatchingCollectionQuery(e,t,i,l)}getNextDocuments(e,t,i,l){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,l).next((u=>{const d=l-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,l-u.size):je.resolve(Do());let g=xu,y=u;return d.next((p=>je.forEach(p,((b,j)=>(g<j.largestBatchId&&(g=j.largestBatchId),u.get(b)?je.resolve():this.remoteDocumentCache.getEntry(e,b).next((S=>{y=y.insert(b,S)}))))).next((()=>this.populateOverlays(e,p,u))).next((()=>this.computeViews(e,y,p,Zt()))).next((b=>({batchId:g,changes:ik(b)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ht(t)).next((i=>{let l=au();return i.isFoundDocument()&&(l=l.insert(i.key,i)),l}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,l){const u=t.collectionGroup;let d=au();return this.indexManager.getCollectionParents(e,u).next((g=>je.forEach(g,(y=>{const p=(function(j,S){return new lc(S,null,j.explicitOrderBy.slice(),j.filters.slice(),j.limit,j.limitType,j.startAt,j.endAt)})(t,y.child(u));return this.getDocumentsMatchingCollectionQuery(e,p,i,l).next((b=>{b.forEach(((j,S)=>{d=d.insert(j,S)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,i,l){let u;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((d=>(u=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,u,l)))).next((d=>{u.forEach(((y,p)=>{const b=p.getKey();d.get(b)===null&&(d=d.insert(b,Gs.newInvalidDocument(b)))}));let g=au();return d.forEach(((y,p)=>{const b=u.get(y);b!==void 0&&mu(b.mutation,p,Ir.empty(),Pt.now()),pf(t,p)&&(g=g.insert(y,p))})),g}))}}class QI{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return je.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(l){return{id:l.id,version:l.version,createTime:Ni(l.createTime)}})(t)),je.resolve()}getNamedQuery(e,t){return je.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(l){return{name:l.name,query:UI(l.bundledQuery),readTime:Ni(l.readTime)}})(t)),je.resolve()}}class XI{constructor(){this.overlays=new Yn(ht.comparator),this.Lr=new Map}getOverlay(e,t){return je.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Do();return je.forEach(t,(l=>this.getOverlay(e,l).next((u=>{u!==null&&i.set(l,u)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((l,u)=>{this.bt(e,t,u)})),je.resolve()}removeOverlaysForBatchId(e,t,i){const l=this.Lr.get(i);return l!==void 0&&(l.forEach((u=>this.overlays=this.overlays.remove(u))),this.Lr.delete(i)),je.resolve()}getOverlaysForCollection(e,t,i){const l=Do(),u=t.length+1,d=new ht(t.child("")),g=this.overlays.getIteratorFrom(d);for(;g.hasNext();){const y=g.getNext().value,p=y.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===u&&y.largestBatchId>i&&l.set(y.getKey(),y)}return je.resolve(l)}getOverlaysForCollectionGroup(e,t,i,l){let u=new Yn(((p,b)=>p-b));const d=this.overlays.getIterator();for(;d.hasNext();){const p=d.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>i){let b=u.get(p.largestBatchId);b===null&&(b=Do(),u=u.insert(p.largestBatchId,b)),b.set(p.getKey(),p)}}const g=Do(),y=u.getIterator();for(;y.hasNext()&&(y.getNext().value.forEach(((p,b)=>g.set(p,b))),!(g.size()>=l)););return je.resolve(g)}bt(e,t,i){const l=this.overlays.get(i.key);if(l!==null){const d=this.Lr.get(l.largestBatchId).delete(i.key);this.Lr.set(l.largestBatchId,d)}this.overlays=this.overlays.insert(i.key,new gI(t,i));let u=this.Lr.get(t);u===void 0&&(u=Zt(),this.Lr.set(t,u)),this.Lr.set(t,u.add(i.key))}}class JI{constructor(){this.sessionToken=Fs.EMPTY_BYTE_STRING}getSessionToken(e){return je.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,je.resolve()}}class Ay{constructor(){this.kr=new Cs(Ms.Kr),this.qr=new Cs(Ms.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new Ms(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new Ms(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new ht(new Dn([])),i=new Ms(t,e),l=new Ms(t,e+1),u=[];return this.qr.forEachInRange([i,l],(d=>{this.Wr(d),u.push(d.key)})),u}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new ht(new Dn([])),i=new Ms(t,e),l=new Ms(t,e+1);let u=Zt();return this.qr.forEachInRange([i,l],(d=>{u=u.add(d.key)})),u}containsKey(e){const t=new Ms(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Ms{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return ht.comparator(e.key,t.key)||Jt(e.Hr,t.Hr)}static Ur(e,t){return Jt(e.Hr,t.Hr)||ht.comparator(e.key,t.key)}}class ZI{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Cs(Ms.Kr)}checkEmpty(e){return je.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,l){const u=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new mI(u,t,i,l);this.mutationQueue.push(d);for(const g of l)this.Jr=this.Jr.add(new Ms(g.key,u)),this.indexManager.addToCollectionParentIndex(e,g.key.path.popLast());return je.resolve(d)}lookupMutationBatch(e,t){return je.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,l=this.Xr(i),u=l<0?0:l;return je.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return je.resolve(this.mutationQueue.length===0?xy:this.Yn-1)}getAllMutationBatches(e){return je.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Ms(t,0),l=new Ms(t,Number.POSITIVE_INFINITY),u=[];return this.Jr.forEachInRange([i,l],(d=>{const g=this.Zr(d.Hr);u.push(g)})),je.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Cs(Jt);return t.forEach((l=>{const u=new Ms(l,0),d=new Ms(l,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([u,d],(g=>{i=i.add(g.Hr)}))})),je.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,l=i.length+1;let u=i;ht.isDocumentKey(u)||(u=u.child(""));const d=new Ms(new ht(u),0);let g=new Cs(Jt);return this.Jr.forEachWhile((y=>{const p=y.key.path;return!!i.isPrefixOf(p)&&(p.length===l&&(g=g.add(y.Hr)),!0)}),d),je.resolve(this.Yr(g))}Yr(e){const t=[];return e.forEach((i=>{const l=this.Zr(i);l!==null&&t.push(l)})),t}removeMutationBatch(e,t){yn(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return je.forEach(t.mutations,(l=>{const u=new Ms(l.key,t.batchId);return i=i.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,l.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new Ms(t,0),l=this.Jr.firstAfterOrEqual(i);return je.resolve(t.isEqual(l&&l.key))}performConsistencyCheck(e){return this.mutationQueue.length,je.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class eM{constructor(e){this.ti=e,this.docs=(function(){return new Yn(ht.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,l=this.docs.get(i),u=l?l.size:0,d=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:d}),this.size+=d-u,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return je.resolve(i?i.document.mutableCopy():Gs.newInvalidDocument(t))}getEntries(e,t){let i=fa();return t.forEach((l=>{const u=this.docs.get(l);i=i.insert(l,u?u.document.mutableCopy():Gs.newInvalidDocument(l))})),je.resolve(i)}getDocumentsMatchingQuery(e,t,i,l){let u=fa();const d=t.path,g=new ht(d.child("__id-9223372036854775808__")),y=this.docs.getIteratorFrom(g);for(;y.hasNext();){const{key:p,value:{document:b}}=y.getNext();if(!d.isPrefixOf(p.path))break;p.path.length>d.length+1||SR(TR(b),i)<=0||(l.has(b.key)||pf(t,b))&&(u=u.insert(b.key,b.mutableCopy()))}return je.resolve(u)}getAllFromCollectionGroup(e,t,i,l){_t(9500)}ni(e,t){return je.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new tM(this)}getSize(e){return je.resolve(this.size)}}class tM extends GI{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,l)=>{l.isValidDocument()?t.push(this.Mr.addEntry(e,l)):this.Mr.removeEntry(i)})),je.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class nM{constructor(e){this.persistence=e,this.ri=new Jo((t=>jy(t)),Ey),this.lastRemoteSnapshotVersion=St.min(),this.highestTargetId=0,this.ii=0,this.si=new Ay,this.targetCount=0,this.oi=Zl._r()}forEachTarget(e,t){return this.ri.forEach(((i,l)=>t(l))),je.resolve()}getLastRemoteSnapshotVersion(e){return je.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return je.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),je.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),je.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new Zl(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,je.resolve()}updateTargetData(e,t){return this.lr(t),je.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,je.resolve()}removeTargets(e,t,i){let l=0;const u=[];return this.ri.forEach(((d,g)=>{g.sequenceNumber<=t&&i.get(g.targetId)===null&&(this.ri.delete(d),u.push(this.removeMatchingKeysForTargetId(e,g.targetId)),l++)})),je.waitFor(u).next((()=>l))}getTargetCount(e){return je.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return je.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),je.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const l=this.persistence.referenceDelegate,u=[];return l&&t.forEach((d=>{u.push(l.markPotentiallyOrphaned(e,d))})),je.waitFor(u)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),je.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return je.resolve(i)}containsKey(e,t){return je.resolve(this.si.containsKey(t))}}class Sk{constructor(e,t){this._i={},this.overlays={},this.ai=new df(0),this.ui=!1,this.ui=!0,this.ci=new JI,this.referenceDelegate=e(this),this.li=new nM(this),this.indexManager=new BI,this.remoteDocumentCache=(function(l){return new eM(l)})((i=>this.referenceDelegate.hi(i))),this.serializer=new VI(t),this.Pi=new QI(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new XI,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new ZI(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){Je("MemoryPersistence","Starting transaction:",e);const l=new sM(this.ai.next());return this.referenceDelegate.Ti(),i(l).next((u=>this.referenceDelegate.Ii(l).next((()=>u)))).toPromise().then((u=>(l.raiseOnCommittedEvent(),u)))}Ei(e,t){return je.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class sM extends NR{constructor(e){super(),this.currentSequenceNumber=e}}class Ry{constructor(e){this.persistence=e,this.Ri=new Ay,this.Ai=null}static Vi(e){return new Ry(e)}get di(){if(this.Ai)return this.Ai;throw _t(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),je.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),je.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),je.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((l=>this.di.add(l.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((l=>{l.forEach((u=>this.di.add(u.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return je.forEach(this.di,(i=>{const l=ht.fromPath(i);return this.mi(e,l).next((u=>{u||t.removeEntry(l,St.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return je.or([()=>je.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Yh{constructor(e,t){this.persistence=e,this.fi=new Jo((i=>IR(i.path)),((i,l)=>i.isEqual(l))),this.garbageCollector=WI(this,t)}static Vi(e,t){return new Yh(e,t)}Ti(){}Ii(e){return je.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((l=>i+l))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return je.forEach(this.fi,((i,l)=>this.wr(e,i,l).next((u=>u?je.resolve():t(l)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const l=this.persistence.getRemoteDocumentCache(),u=l.newChangeBuffer();return l.ni(e,(d=>this.wr(e,d,t).next((g=>{g||(i++,u.removeEntry(d,St.min()))})))).next((()=>u.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),je.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),je.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),je.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),je.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Ch(e.data.value)),t}wr(e,t,i){return je.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const l=this.fi.get(t);return je.resolve(l!==void 0&&l>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Iy{constructor(e,t,i,l){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=l}static Es(e,t){let i=Zt(),l=Zt();for(const u of t.docChanges)switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:l=l.add(u.doc.key)}return new Iy(e,t.fromCache,i,l)}}class rM{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class iM{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return DC()?8:AR(Ks())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,l){const u={result:null};return this.gs(e,t).next((d=>{u.result=d})).next((()=>{if(!u.result)return this.ps(e,t,l,i).next((d=>{u.result=d}))})).next((()=>{if(u.result)return;const d=new rM;return this.ys(e,t,d).next((g=>{if(u.result=g,this.As)return this.ws(e,t,d,g.size)}))})).next((()=>u.result))}ws(e,t,i,l){return i.documentReadCount<this.Vs?(Ol()<=Qt.DEBUG&&Je("QueryEngine","SDK will not create cache indexes for query:",Pl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),je.resolve()):(Ol()<=Qt.DEBUG&&Je("QueryEngine","Query:",Pl(t),"scans",i.documentReadCount,"local documents and returns",l,"documents as results."),i.documentReadCount>this.ds*l?(Ol()<=Qt.DEBUG&&Je("QueryEngine","The SDK decides to create cache indexes for query:",Pl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ci(t))):je.resolve())}gs(e,t){if(tw(t))return je.resolve(null);let i=Ci(t);return this.indexManager.getIndexType(e,i).next((l=>l===0?null:(t.limit!==null&&l===1&&(t=Gh(t,null,"F"),i=Ci(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((u=>{const d=Zt(...u);return this.fs.getDocuments(e,d).next((g=>this.indexManager.getMinOffset(e,i).next((y=>{const p=this.bs(t,g);return this.Ss(t,p,d,y.readTime)?this.gs(e,Gh(t,null,"F")):this.Ds(e,p,t,y)}))))})))))}ps(e,t,i,l){return tw(t)||l.isEqual(St.min())?je.resolve(null):this.fs.getDocuments(e,i).next((u=>{const d=this.bs(t,u);return this.Ss(t,d,i,l)?je.resolve(null):(Ol()<=Qt.DEBUG&&Je("QueryEngine","Re-using previous result from %s to execute query: %s",l.toString(),Pl(t)),this.Ds(e,d,t,ER(l,xu)).next((g=>g)))}))}bs(e,t){let i=new Cs(sk(e));return t.forEach(((l,u)=>{pf(e,u)&&(i=i.add(u))})),i}Ss(e,t,i,l){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const u=e.limitType==="F"?t.last():t.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(l)>0)}ys(e,t,i){return Ol()<=Qt.DEBUG&&Je("QueryEngine","Using full collection scan to execute query:",Pl(t)),this.fs.getDocumentsMatchingQuery(e,t,no.min(),i)}Ds(e,t,i,l){return this.fs.getDocumentsMatchingQuery(e,i,l).next((u=>(t.forEach((d=>{u=u.insert(d.key,d)})),u)))}}const My="LocalStore",aM=3e8;class oM{constructor(e,t,i,l){this.persistence=e,this.Cs=t,this.serializer=l,this.vs=new Yn(Jt),this.Fs=new Jo((u=>jy(u)),Ey),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new YI(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function lM(s,e,t,i){return new oM(s,e,t,i)}async function Ck(s,e){const t=Nt(s);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let l;return t.mutationQueue.getAllMutationBatches(i).next((u=>(l=u,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((u=>{const d=[],g=[];let y=Zt();for(const p of l){d.push(p.batchId);for(const b of p.mutations)y=y.add(b.key)}for(const p of u){g.push(p.batchId);for(const b of p.mutations)y=y.add(b.key)}return t.localDocuments.getDocuments(i,y).next((p=>({Ns:p,removedBatchIds:d,addedBatchIds:g})))}))}))}function cM(s,e){const t=Nt(s);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const l=e.batch.keys(),u=t.xs.newChangeBuffer({trackRemovals:!0});return(function(g,y,p,b){const j=p.batch,S=j.keys();let R=je.resolve();return S.forEach((H=>{R=R.next((()=>b.getEntry(y,H))).next((K=>{const B=p.docVersions.get(H);yn(B!==null,48541),K.version.compareTo(B)<0&&(j.applyToRemoteDocument(K,p),K.isValidDocument()&&(K.setReadTime(p.commitVersion),b.addEntry(K)))}))})),R.next((()=>g.mutationQueue.removeMutationBatch(y,j)))})(t,i,e,u).next((()=>u.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,l,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(g){let y=Zt();for(let p=0;p<g.mutationResults.length;++p)g.mutationResults[p].transformResults.length>0&&(y=y.add(g.batch.mutations[p].key));return y})(e)))).next((()=>t.localDocuments.getDocuments(i,l)))}))}function Nk(s){const e=Nt(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function uM(s,e){const t=Nt(s),i=e.snapshotVersion;let l=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const d=t.xs.newChangeBuffer({trackRemovals:!0});l=t.vs;const g=[];e.targetChanges.forEach(((b,j)=>{const S=l.get(j);if(!S)return;g.push(t.li.removeMatchingKeys(u,b.removedDocuments,j).next((()=>t.li.addMatchingKeys(u,b.addedDocuments,j))));let R=S.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(j)!==null?R=R.withResumeToken(Fs.EMPTY_BYTE_STRING,St.min()).withLastLimboFreeSnapshotVersion(St.min()):b.resumeToken.approximateByteSize()>0&&(R=R.withResumeToken(b.resumeToken,i)),l=l.insert(j,R),(function(K,B,Y){return K.resumeToken.approximateByteSize()===0||B.snapshotVersion.toMicroseconds()-K.snapshotVersion.toMicroseconds()>=aM?!0:Y.addedDocuments.size+Y.modifiedDocuments.size+Y.removedDocuments.size>0})(S,R,b)&&g.push(t.li.updateTargetData(u,R))}));let y=fa(),p=Zt();if(e.documentUpdates.forEach((b=>{e.resolvedLimboDocuments.has(b)&&g.push(t.persistence.referenceDelegate.updateLimboDocument(u,b))})),g.push(dM(u,d,e.documentUpdates).next((b=>{y=b.Bs,p=b.Ls}))),!i.isEqual(St.min())){const b=t.li.getLastRemoteSnapshotVersion(u).next((j=>t.li.setTargetsMetadata(u,u.currentSequenceNumber,i)));g.push(b)}return je.waitFor(g).next((()=>d.apply(u))).next((()=>t.localDocuments.getLocalViewOfDocuments(u,y,p))).next((()=>y))})).then((u=>(t.vs=l,u)))}function dM(s,e,t){let i=Zt(),l=Zt();return t.forEach((u=>i=i.add(u))),e.getEntries(s,i).next((u=>{let d=fa();return t.forEach(((g,y)=>{const p=u.get(g);y.isFoundDocument()!==p.isFoundDocument()&&(l=l.add(g)),y.isNoDocument()&&y.version.isEqual(St.min())?(e.removeEntry(g,y.readTime),d=d.insert(g,y)):!p.isValidDocument()||y.version.compareTo(p.version)>0||y.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(y),d=d.insert(g,y)):Je(My,"Ignoring outdated watch update for ",g,". Current version:",p.version," Watch version:",y.version)})),{Bs:d,Ls:l}}))}function hM(s,e){const t=Nt(s);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=xy),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function fM(s,e){const t=Nt(s);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let l;return t.li.getTargetData(i,e).next((u=>u?(l=u,je.resolve(l)):t.li.allocateTargetId(i).next((d=>(l=new Xa(e,d,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,l).next((()=>l)))))))})).then((i=>{const l=t.vs.get(i.targetId);return(l===null||i.snapshotVersion.compareTo(l.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function Up(s,e,t){const i=Nt(s),l=i.vs.get(e),u=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",u,(d=>i.persistence.referenceDelegate.removeTarget(d,l)))}catch(d){if(!oc(d))throw d;Je(My,`Failed to update sequence numbers for target ${e}: ${d}`)}i.vs=i.vs.remove(e),i.Fs.delete(l.target)}function mw(s,e,t){const i=Nt(s);let l=St.min(),u=Zt();return i.persistence.runTransaction("Execute query","readwrite",(d=>(function(y,p,b){const j=Nt(y),S=j.Fs.get(b);return S!==void 0?je.resolve(j.vs.get(S)):j.li.getTargetData(p,b)})(i,d,Ci(e)).next((g=>{if(g)return l=g.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(d,g.targetId).next((y=>{u=y}))})).next((()=>i.Cs.getDocumentsMatchingQuery(d,e,t?l:St.min(),t?u:Zt()))).next((g=>(mM(i,eI(e),g),{documents:g,ks:u})))))}function mM(s,e,t){let i=s.Ms.get(e)||St.min();t.forEach(((l,u)=>{u.readTime.compareTo(i)>0&&(i=u.readTime)})),s.Ms.set(e,i)}class gw{constructor(){this.activeTargetIds=aI()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class gM{constructor(){this.vo=new gw,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new gw,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class pM{Mo(e){}shutdown(){}}const pw="ConnectivityMonitor";class yw{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){Je(pw,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){Je(pw,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let fh=null;function Bp(){return fh===null?fh=(function(){return 268435456+Math.round(2147483648*Math.random())})():fh++,"0x"+fh.toString(16)}const $g="RestConnection",yM={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class vM{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),l=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${l}`,this.$o=this.databaseId.database===qh?`project_id=${i}`:`project_id=${i}&database_id=${l}`}Wo(e,t,i,l,u){const d=Bp(),g=this.Qo(e,t.toUriEncodedString());Je($g,`Sending RPC '${e}' ${d}:`,g,i);const y={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(y,l,u);const{host:p}=new URL(g),b=lo(p);return this.zo(e,g,y,i,b).then((j=>(Je($g,`Received RPC '${e}' ${d}: `,j),j)),(j=>{throw Gl($g,`RPC '${e}' ${d} failed with error: `,j,"url: ",g,"request:",i),j}))}jo(e,t,i,l,u,d){return this.Wo(e,t,i,l,u)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+ic})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((l,u)=>e[u]=l)),i&&i.headers.forEach(((l,u)=>e[u]=l))}Qo(e,t){const i=yM[e];let l=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(l=`${l}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),l}terminate(){}}class bM{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const $s="WebChannelConnection",Xc=(s,e,t)=>{s.listen(e,(i=>{try{t(i)}catch(l){setTimeout((()=>{throw l}),0)}}))};class ql extends vM{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!ql.c_){const e=M_();Xc(e,I_.STAT_EVENT,(t=>{t.stat===Cp.PROXY?Je($s,"STAT_EVENT: detected buffering proxy"):t.stat===Cp.NOPROXY&&Je($s,"STAT_EVENT: detected no buffering proxy")})),ql.c_=!0}}zo(e,t,i,l,u){const d=Bp();return new Promise(((g,y)=>{const p=new A_;p.setWithCredentials(!0),p.listenOnce(R_.COMPLETE,(()=>{try{switch(p.getLastErrorCode()){case Sh.NO_ERROR:const j=p.getResponseJson();Je($s,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(j)),g(j);break;case Sh.TIMEOUT:Je($s,`RPC '${e}' ${d} timed out`),y(new We(be.DEADLINE_EXCEEDED,"Request time out"));break;case Sh.HTTP_ERROR:const S=p.getStatus();if(Je($s,`RPC '${e}' ${d} failed with status:`,S,"response text:",p.getResponseText()),S>0){let R=p.getResponseJson();Array.isArray(R)&&(R=R[0]);const H=R?.error;if(H&&H.status&&H.message){const K=(function(Y){const Q=Y.toLowerCase().replace(/_/g,"-");return Object.values(be).indexOf(Q)>=0?Q:be.UNKNOWN})(H.status);y(new We(K,H.message))}else y(new We(be.UNKNOWN,"Server responded with status "+p.getStatus()))}else y(new We(be.UNAVAILABLE,"Connection failed."));break;default:_t(9055,{l_:e,streamId:d,h_:p.getLastErrorCode(),P_:p.getLastError()})}}finally{Je($s,`RPC '${e}' ${d} completed.`)}}));const b=JSON.stringify(l);Je($s,`RPC '${e}' ${d} sending request:`,l),p.send(t,"POST",b,i,15)}))}T_(e,t,i){const l=Bp(),u=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=this.createWebChannelTransport(),g={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},y=this.longPollingOptions.timeoutSeconds;y!==void 0&&(g.longPollingTimeout=Math.round(1e3*y)),this.useFetchStreams&&(g.useFetchStreams=!0),this.Go(g.initMessageHeaders,t,i),g.encodeInitMessageHeaders=!0;const p=u.join("");Je($s,`Creating RPC '${e}' stream ${l}: ${p}`,g);const b=d.createWebChannel(p,g);this.I_(b);let j=!1,S=!1;const R=new bM({Ho:H=>{S?Je($s,`Not sending because RPC '${e}' stream ${l} is closed:`,H):(j||(Je($s,`Opening RPC '${e}' stream ${l} transport.`),b.open(),j=!0),Je($s,`RPC '${e}' stream ${l} sending:`,H),b.send(H))},Jo:()=>b.close()});return Xc(b,iu.EventType.OPEN,(()=>{S||(Je($s,`RPC '${e}' stream ${l} transport opened.`),R.i_())})),Xc(b,iu.EventType.CLOSE,(()=>{S||(S=!0,Je($s,`RPC '${e}' stream ${l} transport closed`),R.o_(),this.E_(b))})),Xc(b,iu.EventType.ERROR,(H=>{S||(S=!0,Gl($s,`RPC '${e}' stream ${l} transport errored. Name:`,H.name,"Message:",H.message),R.o_(new We(be.UNAVAILABLE,"The operation could not be completed")))})),Xc(b,iu.EventType.MESSAGE,(H=>{if(!S){const K=H.data[0];yn(!!K,16349);const B=K,Y=B?.error||B[0]?.error;if(Y){Je($s,`RPC '${e}' stream ${l} received error:`,Y);const Q=Y.status;let Z=(function(pe){const I=vs[pe];if(I!==void 0)return gk(I)})(Q),ge=Y.message;Z===void 0&&(Z=be.INTERNAL,ge="Unknown error status: "+Q+" with message "+Y.message),S=!0,R.o_(new We(Z,ge)),b.close()}else Je($s,`RPC '${e}' stream ${l} received:`,K),R.__(K)}})),ql.u_(),setTimeout((()=>{R.s_()}),0),R}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return D_()}}function wM(s){return new ql(s)}function Wg(){return typeof document<"u"?document:null}function _f(s){return new jI(s,!0)}ql.c_=!1;class Ak{constructor(e,t,i=1e3,l=1.5,u=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=l,this.V_=u,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),l=Math.max(0,t-i);l>0&&Je("ExponentialBackoff",`Backing off for ${l} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,l,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const vw="PersistentStream";class Rk{constructor(e,t,i,l,u,d,g,y){this.Ci=e,this.b_=i,this.S_=l,this.connection=u,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=g,this.listener=y,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Ak(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===be.RESOURCE_EXHAUSTED?(ha(t.toString()),ha("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===be.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,l])=>{this.D_===t&&this.G_(i,l)}),(i=>{e((()=>{const l=new We(be.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(l)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((l=>{i((()=>this.z_(l)))})),this.stream.onMessage((l=>{i((()=>++this.F_==1?this.H_(l):this.onNext(l)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Je(vw,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(Je(vw,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class xM extends Rk{constructor(e,t,i,l,u,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=SI(this.serializer,e),i=(function(u){if(!("targetChange"in u))return St.min();const d=u.targetChange;return d.targetIds&&d.targetIds.length?St.min():d.readTime?Ni(d.readTime):St.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=Vp(this.serializer),t.addTarget=(function(u,d){let g;const y=d.target;if(g=Mp(y)?{documents:AI(u,y)}:{query:RI(u,y).ft},g.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){g.resumeToken=vk(u,d.resumeToken);const p=Lp(u,d.expectedCount);p!==null&&(g.expectedCount=p)}else if(d.snapshotVersion.compareTo(St.min())>0){g.readTime=Kh(u,d.snapshotVersion.toTimestamp());const p=Lp(u,d.expectedCount);p!==null&&(g.expectedCount=p)}return g})(this.serializer,e);const i=MI(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=Vp(this.serializer),t.removeTarget=e,this.K_(t)}}class _M extends Rk{constructor(e,t,i,l,u,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return yn(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,yn(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){yn(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=NI(e.writeResults,e.commitTime),i=Ni(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=Vp(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>CI(this.serializer,i)))};this.K_(t)}}class kM{}class jM extends kM{constructor(e,t,i,l){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=l,this.ia=!1}sa(){if(this.ia)throw new We(be.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,d])=>this.connection.Wo(e,Op(t,i),l,u,d))).catch((u=>{throw u.name==="FirebaseError"?(u.code===be.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new We(be.UNKNOWN,u.toString())}))}jo(e,t,i,l,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,g])=>this.connection.jo(e,Op(t,i),l,d,g,u))).catch((d=>{throw d.name==="FirebaseError"?(d.code===be.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new We(be.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function EM(s,e,t,i){return new jM(s,e,t,i)}class TM{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ha(t),this.aa=!1):Je("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Fo="RemoteStore";class SM{constructor(e,t,i,l,u){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=u,this.Aa.Mo((d=>{i.enqueueAndForget((async()=>{Zo(this)&&(Je(Fo,"Restarting streams for network reachability change."),await(async function(y){const p=Nt(y);p.Ea.add(4),await zu(p),p.Va.set("Unknown"),p.Ea.delete(4),await kf(p)})(this))}))})),this.Va=new TM(i,l)}}async function kf(s){if(Zo(s))for(const e of s.Ra)await e(!0)}async function zu(s){for(const e of s.Ra)await e(!1)}function Ik(s,e){const t=Nt(s);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Py(t)?Oy(t):cc(t).O_()&&Ly(t,e))}function Dy(s,e){const t=Nt(s),i=cc(t);t.Ia.delete(e),i.O_()&&Mk(t,e),t.Ia.size===0&&(i.O_()?i.L_():Zo(t)&&t.Va.set("Unknown"))}function Ly(s,e){if(s.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(St.min())>0){const t=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}cc(s).Z_(e)}function Mk(s,e){s.da.$e(e),cc(s).X_(e)}function Oy(s){s.da=new wI({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),cc(s).start(),s.Va.ua()}function Py(s){return Zo(s)&&!cc(s).x_()&&s.Ia.size>0}function Zo(s){return Nt(s).Ea.size===0}function Dk(s){s.da=void 0}async function CM(s){s.Va.set("Online")}async function NM(s){s.Ia.forEach(((e,t)=>{Ly(s,e)}))}async function AM(s,e){Dk(s),Py(s)?(s.Va.ha(e),Oy(s)):s.Va.set("Unknown")}async function RM(s,e,t){if(s.Va.set("Online"),e instanceof yk&&e.state===2&&e.cause)try{await(async function(l,u){const d=u.cause;for(const g of u.targetIds)l.Ia.has(g)&&(await l.remoteSyncer.rejectListen(g,d),l.Ia.delete(g),l.da.removeTarget(g))})(s,e)}catch(i){Je(Fo,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Qh(s,i)}else if(e instanceof Rh?s.da.Xe(e):e instanceof pk?s.da.st(e):s.da.tt(e),!t.isEqual(St.min()))try{const i=await Nk(s.localStore);t.compareTo(i)>=0&&await(function(u,d){const g=u.da.Tt(d);return g.targetChanges.forEach(((y,p)=>{if(y.resumeToken.approximateByteSize()>0){const b=u.Ia.get(p);b&&u.Ia.set(p,b.withResumeToken(y.resumeToken,d))}})),g.targetMismatches.forEach(((y,p)=>{const b=u.Ia.get(y);if(!b)return;u.Ia.set(y,b.withResumeToken(Fs.EMPTY_BYTE_STRING,b.snapshotVersion)),Mk(u,y);const j=new Xa(b.target,y,p,b.sequenceNumber);Ly(u,j)})),u.remoteSyncer.applyRemoteEvent(g)})(s,t)}catch(i){Je(Fo,"Failed to raise snapshot:",i),await Qh(s,i)}}async function Qh(s,e,t){if(!oc(e))throw e;s.Ea.add(1),await zu(s),s.Va.set("Offline"),t||(t=()=>Nk(s.localStore)),s.asyncQueue.enqueueRetryable((async()=>{Je(Fo,"Retrying IndexedDB access"),await t(),s.Ea.delete(1),await kf(s)}))}function Lk(s,e){return e().catch((t=>Qh(s,t,e)))}async function jf(s){const e=Nt(s),t=ao(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:xy;for(;IM(e);)try{const l=await hM(e.localStore,i);if(l===null){e.Ta.length===0&&t.L_();break}i=l.batchId,MM(e,l)}catch(l){await Qh(e,l)}Ok(e)&&Pk(e)}function IM(s){return Zo(s)&&s.Ta.length<10}function MM(s,e){s.Ta.push(e);const t=ao(s);t.O_()&&t.Y_&&t.ea(e.mutations)}function Ok(s){return Zo(s)&&!ao(s).x_()&&s.Ta.length>0}function Pk(s){ao(s).start()}async function DM(s){ao(s).ra()}async function LM(s){const e=ao(s);for(const t of s.Ta)e.ea(t.mutations)}async function OM(s,e,t){const i=s.Ta.shift(),l=Sy.from(i,e,t);await Lk(s,(()=>s.remoteSyncer.applySuccessfulWrite(l))),await jf(s)}async function PM(s,e){e&&ao(s).Y_&&await(async function(i,l){if((function(d){return yI(d)&&d!==be.ABORTED})(l.code)){const u=i.Ta.shift();ao(i).B_(),await Lk(i,(()=>i.remoteSyncer.rejectFailedWrite(u.batchId,l))),await jf(i)}})(s,e),Ok(s)&&Pk(s)}async function bw(s,e){const t=Nt(s);t.asyncQueue.verifyOperationInProgress(),Je(Fo,"RemoteStore received new credentials");const i=Zo(t);t.Ea.add(3),await zu(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await kf(t)}async function VM(s,e){const t=Nt(s);e?(t.Ea.delete(2),await kf(t)):e||(t.Ea.add(2),await zu(t),t.Va.set("Unknown"))}function cc(s){return s.ma||(s.ma=(function(t,i,l){const u=Nt(t);return u.sa(),new xM(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(s.datastore,s.asyncQueue,{Zo:CM.bind(null,s),Yo:NM.bind(null,s),t_:AM.bind(null,s),J_:RM.bind(null,s)}),s.Ra.push((async e=>{e?(s.ma.B_(),Py(s)?Oy(s):s.Va.set("Unknown")):(await s.ma.stop(),Dk(s))}))),s.ma}function ao(s){return s.fa||(s.fa=(function(t,i,l){const u=Nt(t);return u.sa(),new _M(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(s.datastore,s.asyncQueue,{Zo:()=>Promise.resolve(),Yo:DM.bind(null,s),t_:PM.bind(null,s),ta:LM.bind(null,s),na:OM.bind(null,s)}),s.Ra.push((async e=>{e?(s.fa.B_(),await jf(s)):(await s.fa.stop(),s.Ta.length>0&&(Je(Fo,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))}))),s.fa}class Vy{constructor(e,t,i,l,u){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=l,this.removalCallback=u,this.deferred=new oa,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,l,u){const d=Date.now()+i,g=new Vy(e,t,d,l,u);return g.start(i),g}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new We(be.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Uy(s,e){if(ha("AsyncQueue",`${e}: ${s}`),oc(s))return new We(be.UNAVAILABLE,`${e}: ${s}`);throw s}class $l{static emptySet(e){return new $l(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||ht.comparator(t.key,i.key):(t,i)=>ht.comparator(t.key,i.key),this.keyedMap=au(),this.sortedSet=new Yn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof $l)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(!l.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new $l;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class ww{constructor(){this.ga=new Yn(ht.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):_t(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class ec{constructor(e,t,i,l,u,d,g,y,p){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=l,this.mutatedKeys=u,this.fromCache=d,this.syncStateChanged=g,this.excludesMetadataChanges=y,this.hasCachedResults=p}static fromInitialDocuments(e,t,i,l,u){const d=[];return t.forEach((g=>{d.push({type:0,doc:g})})),new ec(e,t,$l.emptySet(t),d,i,l,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&gf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let l=0;l<t.length;l++)if(t[l].type!==i[l].type||!t[l].doc.isEqual(i[l].doc))return!1;return!0}}class UM{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class BM{constructor(){this.queries=xw(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const l=Nt(t),u=l.queries;l.queries=xw(),u.forEach(((d,g)=>{for(const y of g.ba)y.onError(i)}))})(this,new We(be.ABORTED,"Firestore shutting down"))}}function xw(){return new Jo((s=>nk(s)),gf)}async function By(s,e){const t=Nt(s);let i=3;const l=e.query;let u=t.queries.get(l);u?!u.Sa()&&e.Da()&&(i=2):(u=new UM,i=e.Da()?0:1);try{switch(i){case 0:u.wa=await t.onListen(l,!0);break;case 1:u.wa=await t.onListen(l,!1);break;case 2:await t.onFirstRemoteStoreListen(l)}}catch(d){const g=Uy(d,`Initialization of query '${Pl(e.query)}' failed`);return void e.onError(g)}t.queries.set(l,u),u.ba.push(e),e.va(t.onlineState),u.wa&&e.Fa(u.wa)&&Fy(t)}async function zy(s,e){const t=Nt(s),i=e.query;let l=3;const u=t.queries.get(i);if(u){const d=u.ba.indexOf(e);d>=0&&(u.ba.splice(d,1),u.ba.length===0?l=e.Da()?0:1:!u.Sa()&&e.Da()&&(l=2))}switch(l){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function zM(s,e){const t=Nt(s);let i=!1;for(const l of e){const u=l.query,d=t.queries.get(u);if(d){for(const g of d.ba)g.Fa(l)&&(i=!0);d.wa=l}}i&&Fy(t)}function FM(s,e,t){const i=Nt(s),l=i.queries.get(e);if(l)for(const u of l.ba)u.onError(t);i.queries.delete(e)}function Fy(s){s.Ca.forEach((e=>{e.next()}))}var zp,_w;(_w=zp||(zp={})).Ma="default",_w.Cache="cache";class Hy{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const l of e.docChanges)l.type!==3&&i.push(l);e=new ec(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=ec.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==zp.Cache}}class Vk{constructor(e){this.key=e}}class Uk{constructor(e){this.key=e}}class HM{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Zt(),this.mutatedKeys=Zt(),this.eu=sk(e),this.tu=new $l(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new ww,l=t?t.tu:this.tu;let u=t?t.mutatedKeys:this.mutatedKeys,d=l,g=!1;const y=this.query.limitType==="F"&&l.size===this.query.limit?l.last():null,p=this.query.limitType==="L"&&l.size===this.query.limit?l.first():null;if(e.inorderTraversal(((b,j)=>{const S=l.get(b),R=pf(this.query,j)?j:null,H=!!S&&this.mutatedKeys.has(S.key),K=!!R&&(R.hasLocalMutations||this.mutatedKeys.has(R.key)&&R.hasCommittedMutations);let B=!1;S&&R?S.data.isEqual(R.data)?H!==K&&(i.track({type:3,doc:R}),B=!0):this.su(S,R)||(i.track({type:2,doc:R}),B=!0,(y&&this.eu(R,y)>0||p&&this.eu(R,p)<0)&&(g=!0)):!S&&R?(i.track({type:0,doc:R}),B=!0):S&&!R&&(i.track({type:1,doc:S}),B=!0,(y||p)&&(g=!0)),B&&(R?(d=d.add(R),u=K?u.add(b):u.delete(b)):(d=d.delete(b),u=u.delete(b)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const b=this.query.limitType==="F"?d.last():d.first();d=d.delete(b.key),u=u.delete(b.key),i.track({type:1,doc:b})}return{tu:d,iu:i,Ss:g,mutatedKeys:u}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,l){const u=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((b,j)=>(function(R,H){const K=B=>{switch(B){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return _t(20277,{Vt:B})}};return K(R)-K(H)})(b.type,j.type)||this.eu(b.doc,j.doc))),this.ou(i),l=l??!1;const g=t&&!l?this._u():[],y=this.Ya.size===0&&this.current&&!l?1:0,p=y!==this.Xa;return this.Xa=y,d.length!==0||p?{snapshot:new ec(this.query,e.tu,u,d,e.mutatedKeys,y===0,p,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:g}:{au:g}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new ww,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=Zt(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new Uk(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new Vk(i))})),t}cu(e){this.Za=e.ks,this.Ya=Zt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return ec.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const qy="SyncEngine";class qM{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class $M{constructor(e){this.key=e,this.hu=!1}}class WM{constructor(e,t,i,l,u,d){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=l,this.currentUser=u,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new Jo((g=>nk(g)),gf),this.Iu=new Map,this.Eu=new Set,this.Ru=new Yn(ht.comparator),this.Au=new Map,this.Vu=new Ay,this.du={},this.mu=new Map,this.fu=Zl.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function GM(s,e,t=!0){const i=$k(s);let l;const u=i.Tu.get(e);return u?(i.sharedClientState.addLocalQueryTarget(u.targetId),l=u.view.lu()):l=await Bk(i,e,t,!0),l}async function KM(s,e){const t=$k(s);await Bk(t,e,!0,!1)}async function Bk(s,e,t,i){const l=await fM(s.localStore,Ci(e)),u=l.targetId,d=s.sharedClientState.addLocalQueryTarget(u,t);let g;return i&&(g=await YM(s,e,u,d==="current",l.resumeToken)),s.isPrimaryClient&&t&&Ik(s.remoteStore,l),g}async function YM(s,e,t,i,l){s.pu=(j,S,R)=>(async function(K,B,Y,Q){let Z=B.view.ru(Y);Z.Ss&&(Z=await mw(K.localStore,B.query,!1).then((({documents:I})=>B.view.ru(I,Z))));const ge=Q&&Q.targetChanges.get(B.targetId),xe=Q&&Q.targetMismatches.get(B.targetId)!=null,pe=B.view.applyChanges(Z,K.isPrimaryClient,ge,xe);return jw(K,B.targetId,pe.au),pe.snapshot})(s,j,S,R);const u=await mw(s.localStore,e,!0),d=new HM(e,u.ks),g=d.ru(u.documents),y=Bu.createSynthesizedTargetChangeForCurrentChange(t,i&&s.onlineState!=="Offline",l),p=d.applyChanges(g,s.isPrimaryClient,y);jw(s,t,p.au);const b=new qM(e,t,d);return s.Tu.set(e,b),s.Iu.has(t)?s.Iu.get(t).push(e):s.Iu.set(t,[e]),p.snapshot}async function QM(s,e,t){const i=Nt(s),l=i.Tu.get(e),u=i.Iu.get(l.targetId);if(u.length>1)return i.Iu.set(l.targetId,u.filter((d=>!gf(d,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(l.targetId),i.sharedClientState.isActiveQueryTarget(l.targetId)||await Up(i.localStore,l.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(l.targetId),t&&Dy(i.remoteStore,l.targetId),Fp(i,l.targetId)})).catch(ac)):(Fp(i,l.targetId),await Up(i.localStore,l.targetId,!0))}async function XM(s,e){const t=Nt(s),i=t.Tu.get(e),l=t.Iu.get(i.targetId);t.isPrimaryClient&&l.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Dy(t.remoteStore,i.targetId))}async function JM(s,e,t){const i=i6(s);try{const l=await(function(d,g){const y=Nt(d),p=Pt.now(),b=g.reduce(((R,H)=>R.add(H.key)),Zt());let j,S;return y.persistence.runTransaction("Locally write mutations","readwrite",(R=>{let H=fa(),K=Zt();return y.xs.getEntries(R,b).next((B=>{H=B,H.forEach(((Y,Q)=>{Q.isValidDocument()||(K=K.add(Y))}))})).next((()=>y.localDocuments.getOverlayedDocuments(R,H))).next((B=>{j=B;const Y=[];for(const Q of g){const Z=hI(Q,j.get(Q.key).overlayedDocument);Z!=null&&Y.push(new ho(Q.key,Z,K_(Z.value.mapValue),lr.exists(!0)))}return y.mutationQueue.addMutationBatch(R,p,Y,g)})).next((B=>{S=B;const Y=B.applyToLocalDocumentSet(j,K);return y.documentOverlayCache.saveOverlays(R,B.batchId,Y)}))})).then((()=>({batchId:S.batchId,changes:ik(j)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(l.batchId),(function(d,g,y){let p=d.du[d.currentUser.toKey()];p||(p=new Yn(Jt)),p=p.insert(g,y),d.du[d.currentUser.toKey()]=p})(i,l.batchId,t),await Fu(i,l.changes),await jf(i.remoteStore)}catch(l){const u=Uy(l,"Failed to persist write");t.reject(u)}}async function zk(s,e){const t=Nt(s);try{const i=await uM(t.localStore,e);e.targetChanges.forEach(((l,u)=>{const d=t.Au.get(u);d&&(yn(l.addedDocuments.size+l.modifiedDocuments.size+l.removedDocuments.size<=1,22616),l.addedDocuments.size>0?d.hu=!0:l.modifiedDocuments.size>0?yn(d.hu,14607):l.removedDocuments.size>0&&(yn(d.hu,42227),d.hu=!1))})),await Fu(t,i,e)}catch(i){await ac(i)}}function kw(s,e,t){const i=Nt(s);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const l=[];i.Tu.forEach(((u,d)=>{const g=d.view.va(e);g.snapshot&&l.push(g.snapshot)})),(function(d,g){const y=Nt(d);y.onlineState=g;let p=!1;y.queries.forEach(((b,j)=>{for(const S of j.ba)S.va(g)&&(p=!0)})),p&&Fy(y)})(i.eventManager,e),l.length&&i.Pu.J_(l),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function ZM(s,e,t){const i=Nt(s);i.sharedClientState.updateQueryState(e,"rejected",t);const l=i.Au.get(e),u=l&&l.key;if(u){let d=new Yn(ht.comparator);d=d.insert(u,Gs.newNoDocument(u,St.min()));const g=Zt().add(u),y=new xf(St.min(),new Map,new Yn(Jt),d,g);await zk(i,y),i.Ru=i.Ru.remove(u),i.Au.delete(e),$y(i)}else await Up(i.localStore,e,!1).then((()=>Fp(i,e,t))).catch(ac)}async function e6(s,e){const t=Nt(s),i=e.batch.batchId;try{const l=await cM(t.localStore,e);Hk(t,i,null),Fk(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Fu(t,l)}catch(l){await ac(l)}}async function t6(s,e,t){const i=Nt(s);try{const l=await(function(d,g){const y=Nt(d);return y.persistence.runTransaction("Reject batch","readwrite-primary",(p=>{let b;return y.mutationQueue.lookupMutationBatch(p,g).next((j=>(yn(j!==null,37113),b=j.keys(),y.mutationQueue.removeMutationBatch(p,j)))).next((()=>y.mutationQueue.performConsistencyCheck(p))).next((()=>y.documentOverlayCache.removeOverlaysForBatchId(p,b,g))).next((()=>y.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,b))).next((()=>y.localDocuments.getDocuments(p,b)))}))})(i.localStore,e);Hk(i,e,t),Fk(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Fu(i,l)}catch(l){await ac(l)}}function Fk(s,e){(s.mu.get(e)||[]).forEach((t=>{t.resolve()})),s.mu.delete(e)}function Hk(s,e,t){const i=Nt(s);let l=i.du[i.currentUser.toKey()];if(l){const u=l.get(e);u&&(t?u.reject(t):u.resolve(),l=l.remove(e)),i.du[i.currentUser.toKey()]=l}}function Fp(s,e,t=null){s.sharedClientState.removeLocalQueryTarget(e);for(const i of s.Iu.get(e))s.Tu.delete(i),t&&s.Pu.yu(i,t);s.Iu.delete(e),s.isPrimaryClient&&s.Vu.Gr(e).forEach((i=>{s.Vu.containsKey(i)||qk(s,i)}))}function qk(s,e){s.Eu.delete(e.path.canonicalString());const t=s.Ru.get(e);t!==null&&(Dy(s.remoteStore,t),s.Ru=s.Ru.remove(e),s.Au.delete(t),$y(s))}function jw(s,e,t){for(const i of t)i instanceof Vk?(s.Vu.addReference(i.key,e),n6(s,i)):i instanceof Uk?(Je(qy,"Document no longer in limbo: "+i.key),s.Vu.removeReference(i.key,e),s.Vu.containsKey(i.key)||qk(s,i.key)):_t(19791,{wu:i})}function n6(s,e){const t=e.key,i=t.path.canonicalString();s.Ru.get(t)||s.Eu.has(i)||(Je(qy,"New document in limbo: "+t),s.Eu.add(i),$y(s))}function $y(s){for(;s.Eu.size>0&&s.Ru.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const t=new ht(Dn.fromString(e)),i=s.fu.next();s.Au.set(i,new $M(t)),s.Ru=s.Ru.insert(t,i),Ik(s.remoteStore,new Xa(Ci(mf(t.path)),i,"TargetPurposeLimboResolution",df.ce))}}async function Fu(s,e,t){const i=Nt(s),l=[],u=[],d=[];i.Tu.isEmpty()||(i.Tu.forEach(((g,y)=>{d.push(i.pu(y,e,t).then((p=>{if((p||t)&&i.isPrimaryClient){const b=p?!p.fromCache:t?.targetChanges.get(y.targetId)?.current;i.sharedClientState.updateQueryState(y.targetId,b?"current":"not-current")}if(p){l.push(p);const b=Iy.Es(y.targetId,p);u.push(b)}})))})),await Promise.all(d),i.Pu.J_(l),await(async function(y,p){const b=Nt(y);try{await b.persistence.runTransaction("notifyLocalViewChanges","readwrite",(j=>je.forEach(p,(S=>je.forEach(S.Ts,(R=>b.persistence.referenceDelegate.addReference(j,S.targetId,R))).next((()=>je.forEach(S.Is,(R=>b.persistence.referenceDelegate.removeReference(j,S.targetId,R)))))))))}catch(j){if(!oc(j))throw j;Je(My,"Failed to update sequence numbers: "+j)}for(const j of p){const S=j.targetId;if(!j.fromCache){const R=b.vs.get(S),H=R.snapshotVersion,K=R.withLastLimboFreeSnapshotVersion(H);b.vs=b.vs.insert(S,K)}}})(i.localStore,u))}async function s6(s,e){const t=Nt(s);if(!t.currentUser.isEqual(e)){Je(qy,"User change. New user:",e.toKey());const i=await Ck(t.localStore,e);t.currentUser=e,(function(u,d){u.mu.forEach((g=>{g.forEach((y=>{y.reject(new We(be.CANCELLED,d))}))})),u.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Fu(t,i.Ns)}}function r6(s,e){const t=Nt(s),i=t.Au.get(e);if(i&&i.hu)return Zt().add(i.key);{let l=Zt();const u=t.Iu.get(e);if(!u)return l;for(const d of u){const g=t.Tu.get(d);l=l.unionWith(g.view.nu)}return l}}function $k(s){const e=Nt(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=zk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=r6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=ZM.bind(null,e),e.Pu.J_=zM.bind(null,e.eventManager),e.Pu.yu=FM.bind(null,e.eventManager),e}function i6(s){const e=Nt(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=e6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=t6.bind(null,e),e}class Xh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=_f(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return lM(this.persistence,new iM,e.initialUser,this.serializer)}Cu(e){return new Sk(Ry.Vi,this.serializer)}Du(e){return new gM}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Xh.provider={build:()=>new Xh};class a6 extends Xh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){yn(this.persistence.referenceDelegate instanceof Yh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new qI(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?pr.withCacheSize(this.cacheSizeBytes):pr.DEFAULT;return new Sk((i=>Yh.Vi(i,t)),this.serializer)}}class Hp{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>kw(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=s6.bind(null,this.syncEngine),await VM(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new BM})()}createDatastore(e){const t=_f(e.databaseInfo.databaseId),i=wM(e.databaseInfo);return EM(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,l,u,d,g){return new SM(i,l,u,d,g)})(this.localStore,this.datastore,e.asyncQueue,(t=>kw(this.syncEngine,t,0)),(function(){return yw.v()?new yw:new pM})())}createSyncEngine(e,t){return(function(l,u,d,g,y,p,b){const j=new WM(l,u,d,g,y,p);return b&&(j.gu=!0),j})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=Nt(t);Je(Fo,"RemoteStore shutting down."),i.Ea.add(5),await zu(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Hp.provider={build:()=>new Hp};class Wy{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ha("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const oo="FirestoreClient";class o6{constructor(e,t,i,l,u){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=l,this.user=Ws.UNAUTHENTICATED,this.clientId=wy.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(i,(async d=>{Je(oo,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(i,(d=>(Je(oo,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new oa;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=Uy(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Gg(s,e){s.asyncQueue.verifyOperationInProgress(),Je(oo,"Initializing OfflineComponentProvider");const t=s.configuration;await e.initialize(t);let i=t.initialUser;s.setCredentialChangeListener((async l=>{i.isEqual(l)||(await Ck(e.localStore,l),i=l)})),e.persistence.setDatabaseDeletedListener((()=>s.terminate())),s._offlineComponents=e}async function Ew(s,e){s.asyncQueue.verifyOperationInProgress();const t=await l6(s);Je(oo,"Initializing OnlineComponentProvider"),await e.initialize(t,s.configuration),s.setCredentialChangeListener((i=>bw(e.remoteStore,i))),s.setAppCheckTokenChangeListener(((i,l)=>bw(e.remoteStore,l))),s._onlineComponents=e}async function l6(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){Je(oo,"Using user provided OfflineComponentProvider");try{await Gg(s,s._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(l){return l.name==="FirebaseError"?l.code===be.FAILED_PRECONDITION||l.code===be.UNIMPLEMENTED:!(typeof DOMException<"u"&&l instanceof DOMException)||l.code===22||l.code===20||l.code===11})(t))throw t;Gl("Error using user provided cache. Falling back to memory cache: "+t),await Gg(s,new Xh)}}else Je(oo,"Using default OfflineComponentProvider"),await Gg(s,new a6(void 0));return s._offlineComponents}async function Wk(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(Je(oo,"Using user provided OnlineComponentProvider"),await Ew(s,s._uninitializedComponentsProvider._online)):(Je(oo,"Using default OnlineComponentProvider"),await Ew(s,new Hp))),s._onlineComponents}function c6(s){return Wk(s).then((e=>e.syncEngine))}async function Jh(s){const e=await Wk(s),t=e.eventManager;return t.onListen=GM.bind(null,e.syncEngine),t.onUnlisten=QM.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=KM.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=XM.bind(null,e.syncEngine),t}function u6(s,e,t,i){const l=new Wy(i),u=new Hy(e,l,t);return s.asyncQueue.enqueueAndForget((async()=>By(await Jh(s),u))),()=>{l.Nu(),s.asyncQueue.enqueueAndForget((async()=>zy(await Jh(s),u)))}}function d6(s,e,t={}){const i=new oa;return s.asyncQueue.enqueueAndForget((async()=>(function(u,d,g,y,p){const b=new Wy({next:S=>{b.Nu(),d.enqueueAndForget((()=>zy(u,j)));const R=S.docs.has(g);!R&&S.fromCache?p.reject(new We(be.UNAVAILABLE,"Failed to get document because the client is offline.")):R&&S.fromCache&&y&&y.source==="server"?p.reject(new We(be.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(S)},error:S=>p.reject(S)}),j=new Hy(mf(g.path),b,{includeMetadataChanges:!0,Ka:!0});return By(u,j)})(await Jh(s),s.asyncQueue,e,t,i))),i.promise}function h6(s,e,t={}){const i=new oa;return s.asyncQueue.enqueueAndForget((async()=>(function(u,d,g,y,p){const b=new Wy({next:S=>{b.Nu(),d.enqueueAndForget((()=>zy(u,j))),S.fromCache&&y.source==="server"?p.reject(new We(be.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(S)},error:S=>p.reject(S)}),j=new Hy(g,b,{includeMetadataChanges:!0,Ka:!0});return By(u,j)})(await Jh(s),s.asyncQueue,e,t,i))),i.promise}function f6(s,e){const t=new oa;return s.asyncQueue.enqueueAndForget((async()=>JM(await c6(s),e,t))),t.promise}function Gk(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}const m6="ComponentProvider",Tw=new Map;function g6(s,e,t,i,l){return new LR(s,e,t,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,Gk(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator,i)}const Kk="firestore.googleapis.com",Sw=!0;class Cw{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new We(be.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Kk,this.ssl=Sw}else this.host=e.host,this.ssl=e.ssl??Sw;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Tk;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<FI)throw new We(be.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}kR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Gk(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new We(be.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new We(be.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new We(be.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,l){return i.timeoutSeconds===l.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ef{constructor(e,t,i,l){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=l,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Cw({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new We(be.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new We(be.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Cw(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new fR;switch(i.type){case"firstParty":return new yR(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new We(be.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=Tw.get(t);i&&(Je(m6,"Removing Datastore"),Tw.delete(t),i.terminate())})(this),Promise.resolve()}}function p6(s,e,t,i={}){s=or(s,Ef);const l=lo(e),u=s._getSettings(),d={...u,emulatorOptions:s._getEmulatorOptions()},g=`${e}:${t}`;l&&(iy(`https://${g}`),ay("Firestore",!0)),u.host!==Kk&&u.host!==g&&Gl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const y={...u,host:g,ssl:l,emulatorOptions:i};if(!ca(y,d)&&(s._setSettings(y),i.mockUserToken)){let p,b;if(typeof i.mockUserToken=="string")p=i.mockUserToken,b=Ws.MOCK_USER;else{p=zx(i.mockUserToken,s._app?.options.projectId);const j=i.mockUserToken.sub||i.mockUserToken.user_id;if(!j)throw new We(be.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");b=new Ws(j)}s._authCredentials=new mR(new O_(p,b))}}class pa{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new pa(this.firestore,e,this._query)}}class ss{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new eo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ss(this.firestore,e,this._key)}toJSON(){return{type:ss._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Vu(t,ss._jsonSchema))return new ss(e,i||null,new ht(Dn.fromString(t.referencePath)))}}ss._jsonSchemaVersion="firestore/documentReference/1.0",ss._jsonSchema={type:ks("string",ss._jsonSchemaVersion),referencePath:ks("string")};class eo extends pa{constructor(e,t,i){super(e,t,mf(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ss(this.firestore,null,new ht(e))}withConverter(e){return new eo(this.firestore,e,this._path)}}function lt(s,e,...t){if(s=vn(s),P_("collection","path",e),s instanceof Ef){const i=Dn.fromString(e,...t);return z2(i),new eo(s,null,i)}{if(!(s instanceof ss||s instanceof eo))throw new We(be.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(Dn.fromString(e,...t));return z2(i),new eo(s.firestore,null,i)}}function He(s,e,...t){if(s=vn(s),arguments.length===1&&(e=wy.newId()),P_("doc","path",e),s instanceof Ef){const i=Dn.fromString(e,...t);return B2(i),new ss(s,null,new ht(i))}{if(!(s instanceof ss||s instanceof eo))throw new We(be.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(Dn.fromString(e,...t));return B2(i),new ss(s.firestore,s instanceof eo?s.converter:null,new ht(i))}}const Nw="AsyncQueue";class Aw{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Ak(this,"async_queue_retry"),this._c=()=>{const i=Wg();i&&Je(Nw,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Wg();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Wg();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new oa;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!oc(e))throw e;Je(Nw,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,ha("INTERNAL UNHANDLED ERROR: ",Rw(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const l=Vy.createAndSchedule(this,e,t,i,(u=>this.hc(u)));return this.tc.push(l),l}uc(){this.nc&&_t(47125,{Pc:Rw(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Rw(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}class Ii extends Ef{constructor(e,t,i,l){super(e,t,i,l),this.type="firestore",this._queue=new Aw,this._persistenceKey=l?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Aw(e),this._firestoreClient=void 0,await e}}}function y6(s,e){const t=typeof s=="object"?s:Mu(),i=typeof s=="string"?s:qh,l=Qo(t,"firestore").getImmediate({identifier:i});if(!l._initialized){const u=Vx("firestore");u&&p6(l,...u)}return l}function Hu(s){if(s._terminated)throw new We(be.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||v6(s),s._firestoreClient}function v6(s){const e=s._freezeSettings(),t=g6(s._databaseId,s._app?.options.appId||"",s._persistenceKey,s._app?.options.apiKey,e);s._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new o6(s._authCredentials,s._appCheckCredentials,s._queue,t,s._componentsProvider&&(function(l){const u=l?._online.build();return{_offline:l?._offline.build(u),_online:u}})(s._componentsProvider))}class Gr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Gr(Fs.fromBase64String(e))}catch(t){throw new We(be.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Gr(Fs.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Gr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Vu(e,Gr._jsonSchema))return Gr.fromBase64String(e.bytes)}}Gr._jsonSchemaVersion="firestore/bytes/1.0",Gr._jsonSchema={type:ks("string",Gr._jsonSchemaVersion),bytes:ks("string")};class Tf{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new We(be.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new zs(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class el{constructor(e){this._methodName=e}}class Ai{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new We(be.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new We(be.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Jt(this._lat,e._lat)||Jt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ai._jsonSchemaVersion}}static fromJSON(e){if(Vu(e,Ai._jsonSchema))return new Ai(e.latitude,e.longitude)}}Ai._jsonSchemaVersion="firestore/geoPoint/1.0",Ai._jsonSchema={type:ks("string",Ai._jsonSchemaVersion),latitude:ks("number"),longitude:ks("number")};class ci{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,l){if(i.length!==l.length)return!1;for(let u=0;u<i.length;++u)if(i[u]!==l[u])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ci._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Vu(e,ci._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ci(e.vectorValues);throw new We(be.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ci._jsonSchemaVersion="firestore/vectorValue/1.0",ci._jsonSchema={type:ks("string",ci._jsonSchemaVersion),vectorValues:ks("object")};const b6=/^__.*__$/;class w6{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new ho(e,this.data,this.fieldMask,t,this.fieldTransforms):new Uu(e,this.data,t,this.fieldTransforms)}}class Yk{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new ho(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Qk(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw _t(40011,{dataSource:s})}}class Sf{constructor(e,t,i,l,u,d){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=l,u===void 0&&this.validatePath(),this.fieldTransforms=u||[],this.fieldMask=d||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Sf({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Zh(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(Qk(this.dataSource)&&b6.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class x6{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||_f(e)}createContext(e,t,i,l=!1){return new Sf({dataSource:e,methodName:t,targetDoc:i,path:zs.emptyPath(),arrayElement:!1,hasConverter:l},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function qu(s){const e=s._freezeSettings(),t=_f(s._databaseId);return new x6(s._databaseId,!!e.ignoreUndefinedProperties,t)}function Gy(s,e,t,i,l,u={}){const d=s.createContext(u.merge||u.mergeFields?2:0,e,t,l);Jy("Data must be an object, but it was:",d,i);const g=ej(i,d);let y,p;if(u.merge)y=new Ir(d.fieldMask),p=d.fieldTransforms;else if(u.mergeFields){const b=[];for(const j of u.mergeFields){const S=Ho(e,j,t);if(!d.contains(S))throw new We(be.INVALID_ARGUMENT,`Field '${S}' is specified in your field mask but missing from your input data.`);sj(b,S)||b.push(S)}y=new Ir(b),p=d.fieldTransforms.filter((j=>y.covers(j.field)))}else y=null,p=d.fieldTransforms;return new w6(new yr(g),y,p)}class Cf extends el{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Cf}}function Xk(s,e,t){return new Sf({dataSource:3,targetDoc:e.settings.targetDoc,methodName:s._methodName,arrayElement:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Ky extends el{_toFieldTransform(e){return new vf(e.path,new Tu)}isEqual(e){return e instanceof Ky}}class Yy extends el{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=Xk(this,e,!0),i=this.Ac.map((u=>tl(u,t))),l=new Xl(i);return new vf(e.path,l)}isEqual(e){return e instanceof Yy&&ca(this.Ac,e.Ac)}}class Qy extends el{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=Xk(this,e,!0),i=this.Ac.map((u=>tl(u,t))),l=new Jl(i);return new vf(e.path,l)}isEqual(e){return e instanceof Qy&&ca(this.Ac,e.Ac)}}class Xy extends el{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new Su(e.serializer,lk(e.serializer,this.Vc));return new vf(e.path,t)}isEqual(e){return e instanceof Xy&&this.Vc===e.Vc}}function Jk(s,e,t,i){const l=s.createContext(1,e,t);Jy("Data must be an object, but it was:",l,i);const u=[],d=yr.empty();uo(i,((y,p)=>{const b=nj(e,y,t);p=vn(p);const j=l.childContextForFieldPath(b);if(p instanceof Cf)u.push(b);else{const S=tl(p,j);S!=null&&(u.push(b),d.set(b,S))}}));const g=new Ir(u);return new Yk(d,g,l.fieldTransforms)}function Zk(s,e,t,i,l,u){const d=s.createContext(1,e,t),g=[Ho(e,i,t)],y=[l];if(u.length%2!=0)throw new We(be.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let S=0;S<u.length;S+=2)g.push(Ho(e,u[S])),y.push(u[S+1]);const p=[],b=yr.empty();for(let S=g.length-1;S>=0;--S)if(!sj(p,g[S])){const R=g[S];let H=y[S];H=vn(H);const K=d.childContextForFieldPath(R);if(H instanceof Cf)p.push(R);else{const B=tl(H,K);B!=null&&(p.push(R),b.set(R,B))}}const j=new Ir(p);return new Yk(b,j,d.fieldTransforms)}function _6(s,e,t,i=!1){return tl(t,s.createContext(i?4:3,e))}function tl(s,e){if(tj(s=vn(s)))return Jy("Unsupported field value:",e,s),ej(s,e);if(s instanceof el)return(function(i,l){if(!Qk(l.dataSource))throw l.createError(`${i._methodName}() can only be used with update() and set()`);if(!l.path)throw l.createError(`${i._methodName}() is not currently supported inside arrays`);const u=i._toFieldTransform(l);u&&l.fieldTransforms.push(u)})(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,l){const u=[];let d=0;for(const g of i){let y=tl(g,l.childContextForArray(d));y==null&&(y={nullValue:"NULL_VALUE"}),u.push(y),d++}return{arrayValue:{values:u}}})(s,e)}return(function(i,l){if((i=vn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return lk(l.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const u=Pt.fromDate(i);return{timestampValue:Kh(l.serializer,u)}}if(i instanceof Pt){const u=new Pt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Kh(l.serializer,u)}}if(i instanceof Ai)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Gr)return{bytesValue:vk(l.serializer,i._byteString)};if(i instanceof ss){const u=l.databaseId,d=i.firestore._databaseId;if(!d.isEqual(u))throw l.createError(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:Ny(i.firestore._databaseId||l.databaseId,i._key.path)}}if(i instanceof ci)return(function(d,g){const y=d instanceof ci?d.toArray():d;return{mapValue:{fields:{[W_]:{stringValue:G_},[$h]:{arrayValue:{values:y.map((b=>{if(typeof b!="number")throw g.createError("VectorValues must only contain numeric values.");return Ty(g.serializer,b)}))}}}}}})(i,l);if(Ek(i))return i._toProto(l.serializer);throw l.createError(`Unsupported field value: ${uf(i)}`)})(s,e)}function ej(s,e){const t={};return B_(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):uo(s,((i,l)=>{const u=tl(l,e.childContextForField(i));u!=null&&(t[i]=u)})),{mapValue:{fields:t}}}function tj(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof Pt||s instanceof Ai||s instanceof Gr||s instanceof ss||s instanceof el||s instanceof ci||Ek(s))}function Jy(s,e,t){if(!tj(t)||!V_(t)){const i=uf(t);throw i==="an object"?e.createError(s+" a custom object"):e.createError(s+" "+i)}}function Ho(s,e,t){if((e=vn(e))instanceof Tf)return e._internalPath;if(typeof e=="string")return nj(s,e);throw Zh("Field path arguments must be of type string or ",s,!1,void 0,t)}const k6=new RegExp("[~\\*/\\[\\]]");function nj(s,e,t){if(e.search(k6)>=0)throw Zh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,t);try{return new Tf(...e.split("."))._internalPath}catch{throw Zh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,t)}}function Zh(s,e,t,i,l){const u=i&&!i.isEmpty(),d=l!==void 0;let g=`Function ${e}() called with invalid data`;t&&(g+=" (via `toFirestore()`)"),g+=". ";let y="";return(u||d)&&(y+=" (found",u&&(y+=` in field ${i}`),d&&(y+=` in document ${l}`),y+=")"),new We(be.INVALID_ARGUMENT,g+s+y)}function sj(s,e){return s.some((t=>t.isEqual(e)))}class j6{convertValue(e,t="none"){switch(io(e)){case 0:return null;case 1:return e.booleanValue;case 2:return hs(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ro(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw _t(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return uo(e,((l,u)=>{i[l]=this.convertValue(u,t)})),i}convertVectorValue(e){const t=e.fields?.[$h].arrayValue?.values?.map((i=>hs(i.doubleValue)));return new ci(t)}convertGeoPoint(e){return new Ai(hs(e.latitude),hs(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=ff(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(_u(e));default:return null}}convertTimestamp(e){const t=so(e);return new Pt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=Dn.fromString(e);yn(jk(i),9688,{name:e});const l=new ku(i.get(1),i.get(3)),u=new ht(i.popFirst(5));return l.isEqual(t)||ha(`Document ${u} contains a document reference within a different database (${l.projectId}/${l.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),u}}class Zy extends j6{constructor(e){super(),this.firestore=e}convertBytes(e){return new Gr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ss(this.firestore,null,t)}}function ws(){return new Ky("serverTimestamp")}function E6(...s){return new Yy("arrayUnion",s)}function T6(...s){return new Qy("arrayRemove",s)}function li(s){return new Xy("increment",s)}const Iw="@firebase/firestore",Mw="4.10.0";function Dw(s){return(function(t,i){if(typeof t!="object"||t===null)return!1;const l=t;for(const u of i)if(u in l&&typeof l[u]=="function")return!0;return!1})(s,["next","error","complete"])}class rj{constructor(e,t,i,l,u){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=l,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new ss(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new S6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(Ho("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class S6 extends rj{data(){return super.data()}}function ij(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new We(be.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class e0{}class t0 extends e0{}function Xt(s,e,...t){let i=[];e instanceof e0&&i.push(e),i=i.concat(t),(function(u){const d=u.filter((y=>y instanceof n0)).length,g=u.filter((y=>y instanceof Nf)).length;if(d>1||d>0&&g>0)throw new We(be.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const l of i)s=l._apply(s);return s}class Nf extends t0{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new Nf(e,t,i)}_apply(e){const t=this._parse(e);return aj(e._query,t),new pa(e.firestore,e.converter,Dp(e._query,t))}_parse(e){const t=qu(e.firestore);return(function(u,d,g,y,p,b,j){let S;if(p.isKeyField()){if(b==="array-contains"||b==="array-contains-any")throw new We(be.INVALID_ARGUMENT,`Invalid Query. You can't perform '${b}' queries on documentId().`);if(b==="in"||b==="not-in"){Ow(j,b);const H=[];for(const K of j)H.push(Lw(y,u,K));S={arrayValue:{values:H}}}else S=Lw(y,u,j)}else b!=="in"&&b!=="not-in"&&b!=="array-contains-any"||Ow(j,b),S=_6(g,d,j,b==="in"||b==="not-in");return bs.create(p,b,S)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function wt(s,e,t){const i=e,l=Ho("where",s);return Nf._create(l,i,t)}class n0 extends e0{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n0(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:hi.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(l,u){let d=l;const g=u.getFlattenedFilters();for(const y of g)aj(d,y),d=Dp(d,y)})(e._query,t),new pa(e.firestore,e.converter,Dp(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class s0 extends t0{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new s0(e,t)}_apply(e){const t=(function(l,u,d){if(l.startAt!==null)throw new We(be.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(l.endAt!==null)throw new We(be.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Eu(u,d)})(e._query,this._field,this._direction);return new pa(e.firestore,e.converter,ZR(e._query,t))}}function qo(s,e="asc"){const t=e,i=Ho("orderBy",s);return s0._create(i,t)}class r0 extends t0{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new r0(e,t,i)}_apply(e){return new pa(e.firestore,e.converter,Gh(e._query,this._limit,this._limitType))}}function $o(s){return jR("limit",s),r0._create("limit",s,"F")}function Lw(s,e,t){if(typeof(t=vn(t))=="string"){if(t==="")throw new We(be.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!tk(e)&&t.indexOf("/")!==-1)throw new We(be.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(Dn.fromString(t));if(!ht.isDocumentKey(i))throw new We(be.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Y2(s,new ht(i))}if(t instanceof ss)return Y2(s,t._key);throw new We(be.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${uf(t)}.`)}function Ow(s,e){if(!Array.isArray(s)||s.length===0)throw new We(be.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function aj(s,e){const t=(function(l,u){for(const d of l)for(const g of d.getFlattenedFilters())if(u.indexOf(g.op)>=0)return g.op;return null})(s.filters,(function(l){switch(l){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new We(be.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new We(be.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function i0(s,e,t){let i;return i=s?t&&(t.merge||t.mergeFields)?s.toFirestore(e,t):s.toFirestore(e):e,i}class lu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Oo extends rj{constructor(e,t,i,l,u,d){super(e,t,i,l,d),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Ih(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(Ho("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new We(be.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Oo._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Oo._jsonSchemaVersion="firestore/documentSnapshot/1.0",Oo._jsonSchema={type:ks("string",Oo._jsonSchemaVersion),bundleSource:ks("string","DocumentSnapshot"),bundleName:ks("string"),bundle:ks("string")};class Ih extends Oo{data(e={}){return super.data(e)}}class Po{constructor(e,t,i,l){this._firestore=e,this._userDataWriter=t,this._snapshot=l,this.metadata=new lu(l.hasPendingWrites,l.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Ih(this._firestore,this._userDataWriter,i.key,i,new lu(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new We(be.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(l,u){if(l._snapshot.oldDocs.isEmpty()){let d=0;return l._snapshot.docChanges.map((g=>{const y=new Ih(l._firestore,l._userDataWriter,g.doc.key,g.doc,new lu(l._snapshot.mutatedKeys.has(g.doc.key),l._snapshot.fromCache),l.query.converter);return g.doc,{type:"added",doc:y,oldIndex:-1,newIndex:d++}}))}{let d=l._snapshot.oldDocs;return l._snapshot.docChanges.filter((g=>u||g.type!==3)).map((g=>{const y=new Ih(l._firestore,l._userDataWriter,g.doc.key,g.doc,new lu(l._snapshot.mutatedKeys.has(g.doc.key),l._snapshot.fromCache),l.query.converter);let p=-1,b=-1;return g.type!==0&&(p=d.indexOf(g.doc.key),d=d.delete(g.doc.key)),g.type!==1&&(d=d.add(g.doc),b=d.indexOf(g.doc.key)),{type:C6(g.type),doc:y,oldIndex:p,newIndex:b}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new We(be.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Po._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=wy.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],l=[];return this.docs.forEach((u=>{u._document!==null&&(t.push(u._document),i.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),l.push(u.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function C6(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return _t(61501,{type:s})}}Po._jsonSchemaVersion="firestore/querySnapshot/1.0",Po._jsonSchema={type:ks("string",Po._jsonSchemaVersion),bundleSource:ks("string","QuerySnapshot"),bundleName:ks("string"),bundle:ks("string")};class N6{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=qu(e)}set(e,t,i){this._verifyNotCommitted();const l=Kg(e,this._firestore),u=i0(l.converter,t,i),d=Gy(this._dataReader,"WriteBatch.set",l._key,u,l.converter!==null,i);return this._mutations.push(d.toMutation(l._key,lr.none())),this}update(e,t,i,...l){this._verifyNotCommitted();const u=Kg(e,this._firestore);let d;return d=typeof(t=vn(t))=="string"||t instanceof Tf?Zk(this._dataReader,"WriteBatch.update",u._key,t,i,l):Jk(this._dataReader,"WriteBatch.update",u._key,t),this._mutations.push(d.toMutation(u._key,lr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Kg(e,this._firestore);return this._mutations=this._mutations.concat(new wf(t._key,lr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new We(be.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Kg(s,e){if((s=vn(s)).firestore!==e)throw new We(be.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return s}function xs(s){s=or(s,ss);const e=or(s.firestore,Ii),t=Hu(e);return d6(t,s._key).then((i=>lj(e,s,i)))}function Ft(s){s=or(s,pa);const e=or(s.firestore,Ii),t=Hu(e),i=new Zy(e);return ij(s._query),h6(t,s._query).then((l=>new Po(e,i,s,l)))}function _s(s,e,t){s=or(s,ss);const i=or(s.firestore,Ii),l=i0(s.converter,e,t),u=qu(i);return $u(i,[Gy(u,"setDoc",s._key,l,s.converter!==null,t).toMutation(s._key,lr.none())])}function zn(s,e,t,...i){s=or(s,ss);const l=or(s.firestore,Ii),u=qu(l);let d;return d=typeof(e=vn(e))=="string"||e instanceof Tf?Zk(u,"updateDoc",s._key,e,t,i):Jk(u,"updateDoc",s._key,e),$u(l,[d.toMutation(s._key,lr.exists(!0))])}function rr(s){return $u(or(s.firestore,Ii),[new wf(s._key,lr.none())])}function ir(s,e){const t=or(s.firestore,Ii),i=He(s),l=i0(s.converter,e),u=qu(s.firestore);return $u(t,[Gy(u,"addDoc",i._key,l,s.converter!==null,{}).toMutation(i._key,lr.exists(!1))]).then((()=>i))}function oj(s,...e){s=vn(s);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||Dw(e[i])||(t=e[i++]);const l={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Dw(e[i])){const p=e[i];e[i]=p.next?.bind(p),e[i+1]=p.error?.bind(p),e[i+2]=p.complete?.bind(p)}let u,d,g;if(s instanceof ss)d=or(s.firestore,Ii),g=mf(s._key.path),u={next:p=>{e[i]&&e[i](lj(d,s,p))},error:e[i+1],complete:e[i+2]};else{const p=or(s,pa);d=or(p.firestore,Ii),g=p._query;const b=new Zy(d);u={next:j=>{e[i]&&e[i](new Po(d,b,p,j))},error:e[i+1],complete:e[i+2]},ij(s._query)}const y=Hu(d);return u6(y,g,l,u)}function $u(s,e){const t=Hu(s);return f6(t,e)}function lj(s,e,t){const i=t.docs.get(e._key),l=new Zy(s);return new Oo(s,l,e._key,i,new lu(t.hasPendingWrites,t.fromCache),e.converter)}function Pw(s){return s=or(s,Ii),Hu(s),new N6(s,(e=>$u(s,e)))}(function(e,t=!0){hR(Xo),ui(new Qr("firestore",((i,{instanceIdentifier:l,options:u})=>{const d=i.getProvider("app").getImmediate(),g=new Ii(new gR(i.getProvider("auth-internal")),new vR(d,i.getProvider("app-check-internal")),OR(d,l),d);return u={useFetchStreams:t,...u},g._setSettings(u),g}),"PUBLIC").setMultipleInstances(!0)),vr(Iw,Mw,e),vr(Iw,Mw,"esm2020")})();var A6="firebase",R6="12.8.0";vr(A6,R6,"app");const cj="firebasestorage.googleapis.com",uj="storageBucket",I6=120*1e3,M6=600*1e3;class is extends mi{constructor(e,t,i=0){super(Yg(e),`Firebase Storage: ${t} (${Yg(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,is.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Yg(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var rs;(function(s){s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(rs||(rs={}));function Yg(s){return"storage/"+s}function a0(){const s="An unknown error occurred, please check the error payload for server response.";return new is(rs.UNKNOWN,s)}function D6(s){return new is(rs.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")}function L6(s){return new is(rs.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function O6(){const s="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new is(rs.UNAUTHENTICATED,s)}function P6(){return new is(rs.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function V6(s){return new is(rs.UNAUTHORIZED,"User does not have permission to access '"+s+"'.")}function U6(){return new is(rs.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function B6(){return new is(rs.CANCELED,"User canceled the upload/download.")}function z6(s){return new is(rs.INVALID_URL,"Invalid URL '"+s+"'.")}function F6(s){return new is(rs.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function H6(){return new is(rs.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+uj+"' property when initializing the app?")}function q6(){return new is(rs.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function $6(){return new is(rs.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function W6(s){return new is(rs.UNSUPPORTED_ENVIRONMENT,`${s} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function qp(s){return new is(rs.INVALID_ARGUMENT,s)}function dj(){return new is(rs.APP_DELETED,"The Firebase app was deleted.")}function G6(s){return new is(rs.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function gu(s,e){return new is(rs.INVALID_FORMAT,"String does not match format '"+s+"': "+e)}function Jc(s){throw new is(rs.INTERNAL_ERROR,"Internal error: "+s)}class ar{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=ar.makeFromUrl(e,t)}catch{return new ar(e,"")}if(i.path==="")return i;throw F6(e)}static makeFromUrl(e,t){let i=null;const l="([A-Za-z0-9.\\-_]+)";function u(ge){ge.path.charAt(ge.path.length-1)==="/"&&(ge.path_=ge.path_.slice(0,-1))}const d="(/(.*))?$",g=new RegExp("^gs://"+l+d,"i"),y={bucket:1,path:3};function p(ge){ge.path_=decodeURIComponent(ge.path)}const b="v[A-Za-z0-9_]+",j=t.replace(/[.]/g,"\\."),S="(/([^?#]*).*)?$",R=new RegExp(`^https?://${j}/${b}/b/${l}/o${S}`,"i"),H={bucket:1,path:3},K=t===cj?"(?:storage.googleapis.com|storage.cloud.google.com)":t,B="([^?#]*)",Y=new RegExp(`^https?://${K}/${l}/${B}`,"i"),Z=[{regex:g,indices:y,postModify:u},{regex:R,indices:H,postModify:p},{regex:Y,indices:{bucket:1,path:2},postModify:p}];for(let ge=0;ge<Z.length;ge++){const xe=Z[ge],pe=xe.regex.exec(e);if(pe){const I=pe[xe.indices.bucket];let T=pe[xe.indices.path];T||(T=""),i=new ar(I,T),xe.postModify(i);break}}if(i==null)throw z6(e);return i}}class K6{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function Y6(s,e,t){let i=1,l=null,u=null,d=!1,g=0;function y(){return g===2}let p=!1;function b(...B){p||(p=!0,e.apply(null,B))}function j(B){l=setTimeout(()=>{l=null,s(R,y())},B)}function S(){u&&clearTimeout(u)}function R(B,...Y){if(p){S();return}if(B){S(),b.call(null,B,...Y);return}if(y()||d){S(),b.call(null,B,...Y);return}i<64&&(i*=2);let Z;g===1?(g=2,Z=0):Z=(i+Math.random())*1e3,j(Z)}let H=!1;function K(B){H||(H=!0,S(),!p&&(l!==null?(B||(g=2),clearTimeout(l),j(0)):B||(g=1)))}return j(0),u=setTimeout(()=>{d=!0,K(!0)},t),K}function Q6(s){s(!1)}function X6(s){return s!==void 0}function J6(s){return typeof s=="object"&&!Array.isArray(s)}function o0(s){return typeof s=="string"||s instanceof String}function Vw(s){return l0()&&s instanceof Blob}function l0(){return typeof Blob<"u"}function $p(s,e,t,i){if(i<e)throw qp(`Invalid value for '${s}'. Expected ${e} or greater.`);if(i>t)throw qp(`Invalid value for '${s}'. Expected ${t} or less.`)}function Af(s,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${s}`}function hj(s){const e=encodeURIComponent;let t="?";for(const i in s)if(s.hasOwnProperty(i)){const l=e(i)+"="+e(s[i]);t=t+l+"&"}return t=t.slice(0,-1),t}var Vo;(function(s){s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT"})(Vo||(Vo={}));function Z6(s,e){const t=s>=500&&s<600,l=[408,429].indexOf(s)!==-1,u=e.indexOf(s)!==-1;return t||l||u}class eD{constructor(e,t,i,l,u,d,g,y,p,b,j,S=!0,R=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=l,this.successCodes_=u,this.additionalRetryCodes_=d,this.callback_=g,this.errorCallback_=y,this.timeout_=p,this.progressCallback_=b,this.connectionFactory_=j,this.retry=S,this.isUsingEmulator=R,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((H,K)=>{this.resolve_=H,this.reject_=K,this.start_()})}start_(){const e=(i,l)=>{if(l){i(!1,new mh(!1,null,!0));return}const u=this.connectionFactory_();this.pendingConnection_=u;const d=g=>{const y=g.loaded,p=g.lengthComputable?g.total:-1;this.progressCallback_!==null&&this.progressCallback_(y,p)};this.progressCallback_!==null&&u.addUploadProgressListener(d),u.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&u.removeUploadProgressListener(d),this.pendingConnection_=null;const g=u.getErrorCode()===Vo.NO_ERROR,y=u.getStatus();if(!g||Z6(y,this.additionalRetryCodes_)&&this.retry){const b=u.getErrorCode()===Vo.ABORT;i(!1,new mh(!1,null,b));return}const p=this.successCodes_.indexOf(y)!==-1;i(!0,new mh(p,u))})},t=(i,l)=>{const u=this.resolve_,d=this.reject_,g=l.connection;if(l.wasSuccessCode)try{const y=this.callback_(g,g.getResponse());X6(y)?u(y):u()}catch(y){d(y)}else if(g!==null){const y=a0();y.serverResponse=g.getErrorText(),this.errorCallback_?d(this.errorCallback_(g,y)):d(y)}else if(l.canceled){const y=this.appDelete_?dj():B6();d(y)}else{const y=U6();d(y)}};this.canceled_?t(!1,new mh(!1,null,!0)):this.backoffId_=Y6(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Q6(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class mh{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function tD(s,e){e!==null&&e.length>0&&(s.Authorization="Firebase "+e)}function nD(s,e){s["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function sD(s,e){e&&(s["X-Firebase-GMPID"]=e)}function rD(s,e){e!==null&&(s["X-Firebase-AppCheck"]=e)}function iD(s,e,t,i,l,u,d=!0,g=!1){const y=hj(s.urlParams),p=s.url+y,b=Object.assign({},s.headers);return sD(b,e),tD(b,t),nD(b,u),rD(b,i),new eD(p,s.method,b,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,l,d,g)}function aD(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function oD(...s){const e=aD();if(e!==void 0){const t=new e;for(let i=0;i<s.length;i++)t.append(s[i]);return t.getBlob()}else{if(l0())return new Blob(s);throw new is(rs.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function lD(s,e,t){return s.webkitSlice?s.webkitSlice(e,t):s.mozSlice?s.mozSlice(e,t):s.slice?s.slice(e,t):null}function cD(s){if(typeof atob>"u")throw W6("base-64");return atob(s)}const Ei={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Qg{constructor(e,t){this.data=e,this.contentType=t||null}}function uD(s,e){switch(s){case Ei.RAW:return new Qg(fj(e));case Ei.BASE64:case Ei.BASE64URL:return new Qg(mj(s,e));case Ei.DATA_URL:return new Qg(hD(e),fD(e))}throw a0()}function fj(s){const e=[];for(let t=0;t<s.length;t++){let i=s.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<s.length-1&&(s.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const u=i,d=s.charCodeAt(++t);i=65536|(u&1023)<<10|d&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function dD(s){let e;try{e=decodeURIComponent(s)}catch{throw gu(Ei.DATA_URL,"Malformed data URL.")}return fj(e)}function mj(s,e){switch(s){case Ei.BASE64:{const l=e.indexOf("-")!==-1,u=e.indexOf("_")!==-1;if(l||u)throw gu(s,"Invalid character '"+(l?"-":"_")+"' found: is it base64url encoded?");break}case Ei.BASE64URL:{const l=e.indexOf("+")!==-1,u=e.indexOf("/")!==-1;if(l||u)throw gu(s,"Invalid character '"+(l?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=cD(e)}catch(l){throw l.message.includes("polyfill")?l:gu(s,"Invalid character found")}const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i}class gj{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw gu(Ei.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=mD(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function hD(s){const e=new gj(s);return e.base64?mj(Ei.BASE64,e.rest):dD(e.rest)}function fD(s){return new gj(s).contentType}function mD(s,e){return s.length>=e.length?s.substring(s.length-e.length)===e:!1}class Qa{constructor(e,t){let i=0,l="";Vw(e)?(this.data_=e,i=e.size,l=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=l}size(){return this.size_}type(){return this.type_}slice(e,t){if(Vw(this.data_)){const i=this.data_,l=lD(i,e,t);return l===null?null:new Qa(l)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new Qa(i,!0)}}static getBlob(...e){if(l0()){const t=e.map(i=>i instanceof Qa?i.data_:i);return new Qa(oD.apply(null,t))}else{const t=e.map(d=>o0(d)?uD(Ei.RAW,d).data:d.data_);let i=0;t.forEach(d=>{i+=d.byteLength});const l=new Uint8Array(i);let u=0;return t.forEach(d=>{for(let g=0;g<d.length;g++)l[u++]=d[g]}),new Qa(l,!0)}}uploadData(){return this.data_}}function c0(s){let e;try{e=JSON.parse(s)}catch{return null}return J6(e)?e:null}function gD(s){if(s.length===0)return null;const e=s.lastIndexOf("/");return e===-1?"":s.slice(0,e)}function pD(s,e){const t=e.split("/").filter(i=>i.length>0).join("/");return s.length===0?t:s+"/"+t}function pj(s){const e=s.lastIndexOf("/",s.length-2);return e===-1?s:s.slice(e+1)}function yD(s,e){return e}class sr{constructor(e,t,i,l){this.server=e,this.local=t||e,this.writable=!!i,this.xform=l||yD}}let gh=null;function vD(s){return!o0(s)||s.length<2?s:pj(s)}function yj(){if(gh)return gh;const s=[];s.push(new sr("bucket")),s.push(new sr("generation")),s.push(new sr("metageneration")),s.push(new sr("name","fullPath",!0));function e(u,d){return vD(d)}const t=new sr("name");t.xform=e,s.push(t);function i(u,d){return d!==void 0?Number(d):d}const l=new sr("size");return l.xform=i,s.push(l),s.push(new sr("timeCreated")),s.push(new sr("updated")),s.push(new sr("md5Hash",null,!0)),s.push(new sr("cacheControl",null,!0)),s.push(new sr("contentDisposition",null,!0)),s.push(new sr("contentEncoding",null,!0)),s.push(new sr("contentLanguage",null,!0)),s.push(new sr("contentType",null,!0)),s.push(new sr("metadata","customMetadata",!0)),gh=s,gh}function bD(s,e){function t(){const i=s.bucket,l=s.fullPath,u=new ar(i,l);return e._makeStorageReference(u)}Object.defineProperty(s,"ref",{get:t})}function wD(s,e,t){const i={};i.type="file";const l=t.length;for(let u=0;u<l;u++){const d=t[u];i[d.local]=d.xform(i,e[d.server])}return bD(i,s),i}function vj(s,e,t){const i=c0(e);return i===null?null:wD(s,i,t)}function xD(s,e,t,i){const l=c0(e);if(l===null||!o0(l.downloadTokens))return null;const u=l.downloadTokens;if(u.length===0)return null;const d=encodeURIComponent;return u.split(",").map(p=>{const b=s.bucket,j=s.fullPath,S="/b/"+d(b)+"/o/"+d(j),R=Af(S,t,i),H=hj({alt:"media",token:p});return R+H})[0]}function _D(s,e){const t={},i=e.length;for(let l=0;l<i;l++){const u=e[l];u.writable&&(t[u.server]=s[u.local])}return JSON.stringify(t)}const Uw="prefixes",Bw="items";function kD(s,e,t){const i={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[Uw])for(const l of t[Uw]){const u=l.replace(/\/$/,""),d=s._makeStorageReference(new ar(e,u));i.prefixes.push(d)}if(t[Bw])for(const l of t[Bw]){const u=s._makeStorageReference(new ar(e,l.name));i.items.push(u)}return i}function jD(s,e,t){const i=c0(t);return i===null?null:kD(s,e,i)}class u0{constructor(e,t,i,l){this.url=e,this.method=t,this.handler=i,this.timeout=l,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function d0(s){if(!s)throw a0()}function ED(s,e){function t(i,l){const u=vj(s,l,e);return d0(u!==null),u}return t}function TD(s,e){function t(i,l){const u=jD(s,e,l);return d0(u!==null),u}return t}function SD(s,e){function t(i,l){const u=vj(s,l,e);return d0(u!==null),xD(u,l,s.host,s._protocol)}return t}function h0(s){function e(t,i){let l;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?l=P6():l=O6():t.getStatus()===402?l=L6(s.bucket):t.getStatus()===403?l=V6(s.path):l=i,l.status=t.getStatus(),l.serverResponse=i.serverResponse,l}return e}function CD(s){const e=h0(s);function t(i,l){let u=e(i,l);return i.getStatus()===404&&(u=D6(s.path)),u.serverResponse=l.serverResponse,u}return t}function ND(s,e,t,i,l){const u={};e.isRoot?u.prefix="":u.prefix=e.path+"/",t.length>0&&(u.delimiter=t),i&&(u.pageToken=i),l&&(u.maxResults=l);const d=e.bucketOnlyServerUrl(),g=Af(d,s.host,s._protocol),y="GET",p=s.maxOperationRetryTime,b=new u0(g,y,TD(s,e.bucket),p);return b.urlParams=u,b.errorHandler=h0(e),b}function AD(s,e,t){const i=e.fullServerUrl(),l=Af(i,s.host,s._protocol),u="GET",d=s.maxOperationRetryTime,g=new u0(l,u,SD(s,t),d);return g.errorHandler=CD(e),g}function RD(s,e){return s&&s.contentType||e&&e.type()||"application/octet-stream"}function ID(s,e,t){const i=Object.assign({},t);return i.fullPath=s.path,i.size=e.size(),i.contentType||(i.contentType=RD(null,e)),i}function MD(s,e,t,i,l){const u=e.bucketOnlyServerUrl(),d={"X-Goog-Upload-Protocol":"multipart"};function g(){let Z="";for(let ge=0;ge<2;ge++)Z=Z+Math.random().toString().slice(2);return Z}const y=g();d["Content-Type"]="multipart/related; boundary="+y;const p=ID(e,i,l),b=_D(p,t),j="--"+y+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+b+`\r
--`+y+`\r
Content-Type: `+p.contentType+`\r
\r
`,S=`\r
--`+y+"--",R=Qa.getBlob(j,i,S);if(R===null)throw q6();const H={name:p.fullPath},K=Af(u,s.host,s._protocol),B="POST",Y=s.maxUploadRetryTime,Q=new u0(K,B,ED(s,t),Y);return Q.urlParams=H,Q.headers=d,Q.body=R.uploadData(),Q.errorHandler=h0(e),Q}class DD{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Vo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Vo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Vo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,l,u){if(this.sent_)throw Jc("cannot .send() more than once");if(lo(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),u!==void 0)for(const d in u)u.hasOwnProperty(d)&&this.xhr_.setRequestHeader(d,u[d].toString());return l!==void 0?this.xhr_.send(l):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Jc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Jc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Jc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Jc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class LD extends DD{initXhr(){this.xhr_.responseType="text"}}function f0(){return new LD}class Wo{constructor(e,t){this._service=e,t instanceof ar?this._location=t:this._location=ar.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Wo(e,t)}get root(){const e=new ar(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return pj(this._location.path)}get storage(){return this._service}get parent(){const e=gD(this._location.path);if(e===null)return null;const t=new ar(this._location.bucket,e);return new Wo(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw G6(e)}}function OD(s,e,t){s._throwIfRoot("uploadBytes");const i=MD(s.storage,s._location,yj(),new Qa(e,!0),t);return s.storage.makeRequestWithTokens(i,f0).then(l=>({metadata:l,ref:s}))}function PD(s){const e={prefixes:[],items:[]};return bj(s,e).then(()=>e)}async function bj(s,e,t){const l=await VD(s,{pageToken:t});e.prefixes.push(...l.prefixes),e.items.push(...l.items),l.nextPageToken!=null&&await bj(s,e,l.nextPageToken)}function VD(s,e){e!=null&&typeof e.maxResults=="number"&&$p("options.maxResults",1,1e3,e.maxResults);const t=e||{},i=ND(s.storage,s._location,"/",t.pageToken,t.maxResults);return s.storage.makeRequestWithTokens(i,f0)}function UD(s){s._throwIfRoot("getDownloadURL");const e=AD(s.storage,s._location,yj());return s.storage.makeRequestWithTokens(e,f0).then(t=>{if(t===null)throw $6();return t})}function BD(s,e){const t=pD(s._location.path,e),i=new ar(s._location.bucket,t);return new Wo(s.storage,i)}function zD(s){return/^[A-Za-z]+:\/\//.test(s)}function FD(s,e){return new Wo(s,e)}function wj(s,e){if(s instanceof m0){const t=s;if(t._bucket==null)throw H6();const i=new Wo(t,t._bucket);return e!=null?wj(i,e):i}else return e!==void 0?BD(s,e):s}function HD(s,e){if(e&&zD(e)){if(s instanceof m0)return FD(s,e);throw qp("To use ref(service, url), the first argument must be a Storage instance.")}else return wj(s,e)}function zw(s,e){const t=e?.[uj];return t==null?null:ar.makeFromBucketSpec(t,s)}function qD(s,e,t,i={}){s.host=`${e}:${t}`;const l=lo(e);l&&(iy(`https://${s.host}/b`),ay("Storage",!0)),s._isUsingEmulator=!0,s._protocol=l?"https":"http";const{mockUserToken:u}=i;u&&(s._overrideAuthToken=typeof u=="string"?u:zx(u,s.app.options.projectId))}class m0{constructor(e,t,i,l,u,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=l,this._firebaseVersion=u,this._isUsingEmulator=d,this._bucket=null,this._host=cj,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=I6,this._maxUploadRetryTime=M6,this._requests=new Set,l!=null?this._bucket=ar.makeFromBucketSpec(l,this._host):this._bucket=zw(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=ar.makeFromBucketSpec(this._url,e):this._bucket=zw(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){$p("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){$p("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Rr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Wo(this,e)}_makeRequest(e,t,i,l,u=!0){if(this._deleted)return new K6(dj());{const d=iD(e,this._appId,i,l,t,this._firebaseVersion,u,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[i,l]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,l).getPromise()}}const Fw="@firebase/storage",Hw="0.14.0";const xj="storage";function pu(s,e,t){return s=vn(s),OD(s,e,t)}function qw(s){return s=vn(s),PD(s)}function to(s){return s=vn(s),UD(s)}function na(s,e){return s=vn(s),HD(s,e)}function $D(s=Mu(),e){s=vn(s);const i=Qo(s,xj).getImmediate({identifier:e}),l=Vx("storage");return l&&WD(i,...l),i}function WD(s,e,t,i={}){qD(s,e,t,i)}function GD(s,{instanceIdentifier:e}){const t=s.getProvider("app").getImmediate(),i=s.getProvider("auth-internal"),l=s.getProvider("app-check-internal");return new m0(t,i,l,e,Xo)}function KD(){ui(new Qr(xj,GD,"PUBLIC").setMultipleInstances(!0)),vr(Fw,Hw,""),vr(Fw,Hw,"esm2020")}KD();const _j={apiKey:"AIzaSyBCIgMJd3By7qkWH27YiW9VooIBGE3bFLs",authDomain:"mind-core-fitness-client.firebaseapp.com",projectId:"mind-core-fitness-client",storageBucket:"mind-core-fitness-client.firebasestorage.app",messagingSenderId:"669343392406",appId:"1:669343392406:web:f5a35ee062387e7d6f58b7"},g0=cy(_j),Ro=C_(g0),me=y6(g0),sa=$D(g0),YD=cy(_j,"secondary"),DO=C_(YD),QD="EYdciKDOi3UYBLk1u8hHams5tmO2",kj=w.createContext();function Dr(){return w.useContext(kj)}function XD({children:s}){const[e,t]=w.useState(null),[i,l]=w.useState(!1),[u,d]=w.useState(!1),[g,y]=w.useState(null),[p,b]=w.useState(!0);w.useEffect(()=>{let Q=null;const Z=e4(Ro,ge=>{if(t(ge),Q&&(Q(),Q=null),ge)if(ge.uid===QD)l(!0),d(!1),y(null),b(!1);else{l(!1);const xe=Xt(lt(me,"clients"),wt("uid","==",ge.uid)),pe=async()=>{const I=localStorage.getItem("mcf_clientId");if(I)try{const T=await xs(He(me,"clients",I));T.exists()&&(d(!0),y({id:T.id,...T.data()}))}catch(T){console.error("Direct client read failed:",T)}};Q=oj(xe,async I=>{if(I.empty)await pe();else{const T=I.docs[0];d(!0),y({id:T.id,...T.data()});try{localStorage.setItem("mcf_clientId",T.id)}catch{}}b(!1)},async I=>{console.error("Error listening to client data:",I),await pe(),b(!1)})}else l(!1),d(!1),y(null),b(!1)});return()=>{Z(),Q&&Q()}},[]);const Y={currentUser:e,isAdmin:i,isClient:u,clientData:g,updateClientData:Q=>{y(Z=>Z?{...Z,...Q}:Q)},resolveClient:async()=>{if(g)return g;const Q=localStorage.getItem("mcf_clientId");if(Q)try{const Z=await xs(He(me,"clients",Q));if(Z.exists()){const ge={id:Z.id,...Z.data()};return d(!0),y(ge),ge}}catch(Z){console.error("resolveClient direct read failed:",Z)}if(e){const Z=Xt(lt(me,"clients"),wt("uid","==",e.uid)),ge=await Ft(Z);if(!ge.empty){const xe={id:ge.docs[0].id,...ge.docs[0].data()};return d(!0),y(xe),xe}}return null},login:async(Q,Z,ge=!0)=>(await S2(Ro,ge?Tp:py),await XA(Ro,Q,Z)),signup:async(Q,Z,ge)=>{await S2(Ro,Tp);const xe=await QA(Ro,Z.trim().toLowerCase(),ge),pe=xe.user,I=He(lt(me,"clients")),T={uid:pe.uid,name:Q.trim(),email:Z.trim().toLowerCase(),clientType:"core_buddy",coreBuddyAccess:!0,status:"active",tier:"free",subscriptionStatus:null,signupSource:"self_signup",createdAt:Pt.now()};await _s(I,T),d(!0),y({id:I.id,...T});try{localStorage.setItem("mcf_clientId",I.id)}catch{}return xe},logout:()=>{try{localStorage.removeItem("mcf_clientId")}catch{}return t4(Ro)},resetPassword:Q=>YA(Ro,Q),loading:p};return a.jsx(kj.Provider,{value:Y,children:s})}const jj=w.createContext();function Di(){return w.useContext(jj)}function JD({children:s}){const[e,t]=w.useState(()=>{const j=localStorage.getItem("theme");return j?j==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches}),[i,l]=w.useState(()=>localStorage.getItem("accent")||"red"),[u,d]=w.useState(()=>localStorage.getItem("mono")==="true");w.useEffect(()=>{document.documentElement.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("theme",e?"dark":"light")},[e]),w.useEffect(()=>{document.documentElement.setAttribute("data-accent",i),localStorage.setItem("accent",i)},[i]),w.useEffect(()=>{document.documentElement.setAttribute("data-mono",u?"true":"false"),localStorage.setItem("mono",u?"true":"false")},[u]);const b={isDark:e,toggleTheme:()=>{document.documentElement.setAttribute("data-theme-transitioning",""),t(!e),setTimeout(()=>{document.documentElement.removeAttribute("data-theme-transitioning")},350)},accent:i,setAccent:j=>l(j),isMono:u,toggleMono:()=>{document.documentElement.setAttribute("data-theme-transitioning",""),d(!u),setTimeout(()=>{document.documentElement.removeAttribute("data-theme-transitioning")},350)}};return a.jsx(jj.Provider,{value:b,children:s})}const Ej=w.createContext();function uc(){return w.useContext(Ej)}const ZD=["nutrition","buddies"],e3=[5,10],t3=2,n3=1;function s3({children:s}){const{clientData:e,loading:t}=Dr(),i=w.useMemo(()=>{const l=e?.tier||"free",u=e?.subscriptionStatus||null,d=e&&e.signupSource!=="self_signup",g=l==="premium"||!!d;function y(p){return g?!0:!ZD.includes(p)}return{tier:l,subscriptionStatus:u,isPremium:g,canAccess:y,loading:t,FREE_RANDOMISER_DURATIONS:e3,FREE_RANDOMISER_WEEKLY_LIMIT:t3,FREE_HABIT_LIMIT:n3}},[e?.tier,e?.subscriptionStatus,e?.signupSource,t]);return a.jsx(Ej.Provider,{value:i,children:s})}function r3(s){if(s?.signupSource==="self_signup"&&!s?.onboardingComplete)return"/onboarding";const e=s?.clientType;return e==="core_buddy"?"/client/core-buddy":e==="circuit_vip"||e==="circuit_dropin"?"/client/circuit":"/client"}function i3({className:s=""}){const{isDark:e,toggleTheme:t}=Di();return a.jsx("button",{className:s||"theme-toggle",onClick:t,"aria-label":e?"Switch to light mode":"Switch to dark mode",children:e?a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})})}function a3(){const[s,e]=w.useState(""),[t,i]=w.useState(""),[l,u]=w.useState(!0),[d,g]=w.useState(""),[y,p]=w.useState(!1),[b,j]=w.useState(!1),[S,R]=w.useState(!1),{login:H,resetPassword:K,currentUser:B,isAdmin:Y,isClient:Q,clientData:Z,loading:ge}=Dr(),xe=Qs();if(w.useEffect(()=>{if(!ge&&B){if(!B.emailVerified&&Z?.signupSource==="self_signup"){xe("/signup");return}Y?xe("/dashboard"):Q?xe(r3(Z)):(p(!1),g("No account found. Please sign up or contact your trainer."))}},[ge,B,Y,Q,Z,xe]),ge||B)return a.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh",background:"var(--bg-body)"},children:a.jsx("div",{style:{width:36,height:36,border:"3px solid var(--color-primary-light)",borderTopColor:"var(--color-primary)",borderRadius:"50%",animation:"app-spin .7s linear infinite"}})});const pe=async T=>{T.preventDefault(),g(""),p(!0);try{await H(s,t,l)}catch(L){g(L.message||"Failed to log in"),p(!1)}},I=async T=>{if(T.preventDefault(),g(""),!s.trim()){g("Please enter your email address");return}p(!0);try{await K(s.trim()),R(!0)}catch(L){L.code==="auth/user-not-found"?g("No account found with this email"):g(L.message||"Failed to send reset email")}p(!1)};return a.jsxs("div",{className:"login-container",children:[a.jsx(i3,{className:"login-theme-toggle"}),a.jsxs("div",{className:"login-card",children:[a.jsxs("div",{className:"login-header",children:[a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"login-logo"}),a.jsx("p",{children:a.jsx("strong",{children:b?"Reset Password":"Sign in as 1-2-1 or a Core Buddy"})})]}),d&&a.jsx("div",{className:"error-message",children:d}),S?a.jsxs("div",{className:"reset-sent",children:[a.jsx("div",{className:"reset-sent-icon",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M22 2L11 13",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("path",{d:"M22 2L15 22L11 13L2 9L22 2Z",strokeLinecap:"round",strokeLinejoin:"round"})]})}),a.jsx("p",{children:"Reset email sent!"}),a.jsx("span",{children:"Check your inbox for a password reset link"}),a.jsx("button",{className:"login-btn",style:{marginTop:"20px"},onClick:()=>{j(!1),R(!1),g("")},children:"Back to Log In"})]}):b?a.jsxs("form",{onSubmit:I,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:s,onChange:T=>e(T.target.value),placeholder:"Enter your email",required:!0})]}),a.jsx("button",{type:"submit",className:"login-btn",disabled:y,children:y?"Sending...":"Send Reset Link"}),a.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{j(!1),g("")},children:"Back to Log In"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("form",{onSubmit:pe,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:s,onChange:T=>e(T.target.value),required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"password",children:"Password"}),a.jsx("input",{type:"password",id:"password",value:t,onChange:T=>i(T.target.value),required:!0})]}),a.jsx("div",{className:"remember-me",children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:l,onChange:T=>u(T.target.checked)}),a.jsx("span",{children:"Remember me"})]})}),a.jsx("button",{type:"submit",className:"login-btn",disabled:y,children:y?"Logging in...":"Log In"})]}),a.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{j(!0),g("")},children:"Forgot password?"}),a.jsx("button",{type:"button",className:"login-btn login-btn-outline",onClick:()=>xe("/signup"),children:"Don't have an account? Create one free"})]}),a.jsx("a",{href:"/",className:"back-link",children:"Back to website"})]})]})}function ph({feature:s,children:e}){const{canAccess:t,loading:i}=uc();return i||t(s)?e:a.jsx(Cx,{to:"/upgrade",replace:!0})}function Xr({active:s}){const e=Qs(),{clientData:t}=Dr(),{isPremium:i}=uc(),l=t?.clientType==="block"&&t?.coreBuddyAccess;return a.jsxs("nav",{className:"block-bottom-nav",children:[a.jsxs("button",{className:`block-nav-tab${s==="home"?" active":""}`,onClick:()=>e("/client/core-buddy"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),a.jsx("span",{children:"Profile"})]}),a.jsxs("button",{className:`block-nav-tab${s==="workouts"?" active":""}`,onClick:()=>e("/client/core-buddy/workouts"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:a.jsx("path",{d:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"})}),a.jsx("span",{children:"Workout"})]}),i&&a.jsxs("button",{className:`block-nav-tab${s==="nutrition"?" active":""}`,onClick:()=>e("/client/core-buddy/nutrition"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"})}),a.jsx("span",{children:"Nutrition"})]}),i&&a.jsxs("button",{className:`block-nav-tab${s==="buddies"?" active":""}`,onClick:()=>e("/client/core-buddy/buddies"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("span",{children:"Buddies"})]}),l&&a.jsxs("button",{className:"block-nav-tab",onClick:()=>e("/client"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),a.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),a.jsx("span",{children:"Block"})]})]})}function nl({children:s,onRefresh:e}){const[t,i]=w.useState(0),[l,u]=w.useState(!1),d=w.useRef(null),g=w.useRef(0),y=w.useRef(!1),p=w.useCallback(S=>{window.scrollY<=0&&(g.current=S.touches[0].clientY,y.current=!0)},[]),b=w.useCallback(S=>{if(!y.current||l)return;const R=S.touches[0].clientY-g.current;R>20&&window.scrollY<=0&&(S.preventDefault(),i(Math.min((R-20)*.35,80)))},[l]),j=w.useCallback(async()=>{t>55&&!l&&(u(!0),e?await e():window.location.reload(),u(!1)),i(0),y.current=!1},[t,l,e]);return a.jsxs("div",{ref:d,onTouchStart:p,onTouchMove:b,onTouchEnd:j,children:[a.jsxs("div",{className:`pull-refresh-indicator ${t>0?"visible":""} ${l?"refreshing":""}`,style:{height:t},children:[a.jsx("div",{className:`refresh-spinner ${l?"spinning":""}`,children:a.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:a.jsx("path",{fill:"currentColor",d:"M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"})})}),a.jsx("span",{className:"refresh-text",children:l?"Refreshing...":"Pull to refresh"})]}),s]})}function Wu(s,e,t,i,l){const u=[];for(let d=0;d<s;d++){const g=(d*(360/s)-90)*(Math.PI/180);u.push({x1:e+i*Math.cos(g),y1:t+i*Math.sin(g),x2:e+l*Math.cos(g),y2:t+l*Math.sin(g),thick:d%5===0})}return u}const Tj=Wu(60,100,100,85,96),o3=Wu(60,100,100,78,94),l3=Wu(60,100,100,82,94);Wu(60,50,50,38,46);const LO=Wu(60,40,40,30,37);function c3({steps:s,onFinish:e,active:t}){const[i,l]=w.useState(0),[u,d]=w.useState(null),[g,y]=w.useState("below"),[p,b]=w.useState(!1),j=w.useRef(null),S=w.useRef(t);S.current=t,w.useEffect(()=>{t||l(0)},[t]),w.useEffect(()=>{if(!t)return;const xe=pe=>pe.preventDefault();return document.addEventListener("touchmove",xe,{passive:!1}),document.addEventListener("wheel",xe,{passive:!1}),document.body.style.overflow="hidden",()=>{document.removeEventListener("touchmove",xe),document.removeEventListener("wheel",xe),document.body.style.overflow=""}},[t]);const R=w.useMemo(()=>t?s.filter(xe=>document.querySelector(xe.selector)):[],[t]),H=R[i],K=i===R.length-1,B=H?.selector,Y=w.useCallback(()=>{if(!B)return;const xe=document.querySelector(B);if(!xe){d(null);return}const pe=xe.getBoundingClientRect(),I=8;d({top:pe.top-I,left:pe.left-I,width:pe.width+I*2,height:pe.height+I*2});const T=window.innerHeight-pe.bottom;y(T<260?"above":"below")},[B]);if(w.useEffect(()=>{if(!t||!B)return;b(!0);const xe=document.querySelector(B);if(xe){document.body.style.overflow="",xe.scrollIntoView({behavior:"smooth",block:"center"});let pe=null,I=0,T=0;const L=60,V=()=>{T++;const M=xe.getBoundingClientRect(),Me=Math.round(M.top);if(pe!==null&&Me===pe?I++:I=0,pe=Me,I>=3||T>=L){S.current&&(document.body.style.overflow="hidden"),Y(),b(!1);return}P=requestAnimationFrame(V)};let P;const D=setTimeout(()=>{P=requestAnimationFrame(V)},120);return()=>{clearTimeout(D),P&&cancelAnimationFrame(P),S.current&&(document.body.style.overflow="hidden")}}},[t,i,B,Y]),w.useEffect(()=>{if(!t)return;const xe=()=>{j.current&&cancelAnimationFrame(j.current),j.current=requestAnimationFrame(Y)};return window.addEventListener("scroll",xe,!0),window.addEventListener("resize",xe),()=>{window.removeEventListener("scroll",xe,!0),window.removeEventListener("resize",xe),j.current&&cancelAnimationFrame(j.current)}},[t,Y]),!t||!H||R.length===0)return null;const Q=()=>{K?e():l(i+1)},Z=()=>{i>0&&l(i-1)},ge=()=>e();return a.jsxs("div",{className:"st-overlay",onClick:xe=>{xe.stopPropagation()},children:[a.jsx("div",{className:"st-backdrop",onClick:Q}),u&&a.jsx("div",{className:`st-spotlight${p?" st-transitioning":""}`,style:{top:u.top,left:u.left,width:u.width,height:u.height}}),u&&a.jsxs("div",{className:`st-tooltip st-tooltip-${g}${p?" st-transitioning":""}`,style:{top:g==="below"?Math.min(Math.max(u.top+u.height+16,16),window.innerHeight-200):void 0,bottom:g==="above"?Math.min(Math.max(window.innerHeight-u.top+16,16),window.innerHeight-60):void 0,left:Math.max(16,Math.min(u.left,window.innerWidth-320))},children:[a.jsx("div",{className:"st-dots",children:R.map((xe,pe)=>a.jsx("span",{className:`st-dot${pe===i?" active":""}${pe<i?" done":""}`},pe))}),a.jsx("h3",{className:"st-title",children:H.title}),a.jsx("p",{className:"st-body",children:H.body}),a.jsxs("div",{className:"st-actions",children:[i>0&&a.jsx("button",{className:"st-btn st-btn-back",onClick:Z,children:"Back"}),a.jsx("button",{className:"st-btn st-btn-next",onClick:Q,children:H.cta||(K?"Let's Go!":"Next")})]}),a.jsx("button",{className:"st-skip",onClick:ge,children:"Skip tour"})]})]})}const u3="/login/assets/first_workout-B8SFkzJX.PNG",d3="/login/assets/workouts_10-Z5R3u0xH.PNG",h3="/login/assets/workouts_25-CzxSlcAj.PNG",f3="/login/assets/workouts_50-BpzWup3V.PNG",m3="/login/assets/workouts_100-D7_r6tn1.PNG",g3="/login/assets/streak_2-CsRr-XA9.PNG",p3="/login/assets/streak_4-BHO09tbw.PNG",y3="/login/assets/streak_8-DX2UWMko.PNG",v3="/login/assets/nutrition_7-CHVV11fj.PNG",b3="/login/assets/leaderboard_join-BLoId4Hz.PNG",w3="/login/assets/habits_7-Dvki70KO.PNG",x3="/login/assets/starter_streak-CCltAfrC.PNG",_3="/login/assets/consistency_king-Cho2jxBt.PNG",k3="/login/assets/thirty_in_thirty-B0BVHafW.PNG",j3="/login/assets/minute_master-hA2RLkIL.PNG",E3="/login/assets/habit_machine--nFXaIUW.PNG",T3="/login/assets/iron_will-Dh2dTaie.PNG",Kr=[{id:"first_workout",img:u3,name:"First Rep",desc:"Complete your first workout",category:"workouts",threshold:1},{id:"workouts_10",img:d3,name:"On Fire",desc:"Complete 10 workouts",category:"workouts",threshold:10},{id:"workouts_25",img:h3,name:"Dedicated",desc:"Complete 25 workouts",category:"workouts",threshold:25},{id:"workouts_50",img:f3,name:"Unstoppable",desc:"Complete 50 workouts",category:"workouts",threshold:50},{id:"workouts_100",img:m3,name:"Century",desc:"Complete 100 workouts",category:"workouts",threshold:100},{id:"streak_2",img:g3,name:"2 Week Streak",desc:"Work out for 2 weeks in a row",category:"streaks",threshold:2},{id:"streak_4",img:p3,name:"Month Strong",desc:"Work out for 4 weeks in a row",category:"streaks",threshold:4},{id:"streak_8",img:y3,name:"Iron Will",desc:"Work out for 8 weeks in a row",category:"streaks",threshold:8},{id:"nutrition_7",img:v3,name:"Macro Master",desc:"Hit your macro targets 7 days in a row",category:"nutrition",threshold:7},{id:"leaderboard_join",img:b3,name:"Competitor",desc:"Join the leaderboard",category:"leaderboard",threshold:1},{id:"habits_7",img:w3,name:"Habit Streak",desc:"Complete your daily habits 7 days in a row",category:"habits",threshold:7},{id:"starter_streak",img:x3,name:"Starter Streak",desc:"Complete 5 workouts in 7 days",category:"challenges",threshold:1},{id:"consistency_king",img:_3,name:"Consistency King",desc:"Complete 12 workouts in 30 days",category:"challenges",threshold:1},{id:"thirty_in_thirty",img:k3,name:"30 in 30",desc:"Complete 30 workouts in 30 days",category:"challenges",threshold:1},{id:"minute_master",img:j3,name:"Minute Master",desc:"Train for 300 total minutes in 30 days",category:"challenges",threshold:1},{id:"habit_machine",img:E3,name:"Habit Machine",desc:"Hit all daily habits for 7 days straight",category:"challenges",threshold:1},{id:"iron_will",img:T3,name:"Iron Will",desc:"Work out every day for 14 days straight",category:"challenges",threshold:1}],$w=3,Ww=5,S3=["trained","protein","steps","sleep","water"];function Xg(s){return s.toISOString().split("T")[0]}const Jg=[{text:"You have 24 hours a day...",bold:"make it count"},{text:"Discipline beats motivation...",bold:"every single time"},{text:"Rest when you're done,",bold:"not when you're tired"},{text:"Small daily gains...",bold:"create massive results"},{text:"Your body keeps score,",bold:"train it well"},{text:"Consistency over intensity...",bold:"always wins"},{text:"The only bad workout...",bold:"is the one you skipped"}],Zc={morning:[{main:"Rise and grind,",sub:"let's get after it!"},{main:"New day, new gains,",sub:"let's build something!"},{main:"The early bird gets the gains,",sub:"let's go!"},{main:"Winners wake up ready,",sub:"you showed up!"}],afternoon:[{main:"Oye",sub:"crack on and make it count!"},{main:"Halfway through the day,",sub:"don't ease off now!"},{main:"Afternoon push,",sub:"this is where champions are made!"},{main:"Still time to make today count,",sub:"let's go!"}],evening:[{main:"Evening session?",sub:"Let's finish strong!"},{main:"End the day on a high,",sub:"you earned it!"},{main:"Night owls lift heavier,",sub:"prove it!"},{main:"One more session today?",sub:"Close it out!"}],night:[{main:"Burning the midnight oil,",sub:"Respect the hustle!"},{main:"Late night dedication,",sub:"that's what sets you apart!"},{main:"While they sleep,",sub:"you grind!"}],allDone:[{main:"Smashed it today,",sub:"Rest up and go again tomorrow."},{main:"All tasks crushed,",sub:"Absolute machine!"},{main:"Nothing left undone,",sub:"That's elite-level discipline."}]};function Zg(s){if(!s)return"";const e=s instanceof Date?s:s.toDate?s.toDate():new Date(s),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function eu(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function C3(s,e=800){return new Promise(t=>{const i=new Image;i.onload=()=>{const l=document.createElement("canvas");let u=i.width,d=i.height;u>d?u>e&&(d=Math.round(d*e/u),u=e):d>e&&(u=Math.round(u*e/d),d=e),l.width=u,l.height=d,l.getContext("2d").drawImage(i,0,0,u,d),l.toBlob(g=>t(g),"image/jpeg",.8)},i.src=URL.createObjectURL(s)})}function N3(){const{currentUser:s,isClient:e,clientData:t,logout:i,updateClientData:l,loading:u}=Dr(),{isDark:d,toggleTheme:g}=Di(),{isPremium:y,FREE_HABIT_LIMIT:p}=uc(),b=Qs(),[j,S]=w.useState(y?Ww:p),R=j,[H,K]=w.useState({hours:0,minutes:0,seconds:0}),[B,Y]=w.useState(0),[Q,Z]=w.useState(0),[ge,xe]=w.useState(0),[pe,I]=w.useState(!1),[T,L]=w.useState({protein:0,carbs:0,fats:0,calories:0}),[V,P]=w.useState(null),[D,M]=w.useState(0),[Me,st]=w.useState(0),[J,Te]=w.useState($w),[Ue,Ne]=w.useState(!1),[ze,U]=w.useState(!1),[le,Ce]=w.useState([]),[Se,ve]=w.useState(null),[Oe,Fe]=w.useState(!1),Ge=w.useRef(null),[tt,sn]=w.useState(0),[Tt,_n]=w.useState(0),[gn,Mt]=w.useState(null),ct=w.useCallback((k,N="info")=>{Mt({message:k,type:N}),setTimeout(()=>Mt(null),4e3)},[]),[Bt,rt]=w.useState([]),[Vt,ue]=w.useState(!1),[kt,jt]=w.useState(""),[gt,Qe]=w.useState(null),[ut,Wt]=w.useState(null),[en,Gn]=w.useState(!1),[un,Qn]=w.useState(new Set),[Fn,Rn]=w.useState(new Set),[Ln,tn]=w.useState({}),[zt,bt]=w.useState({}),[At,ee]=w.useState({}),[C,ae]=w.useState({}),[Re,De]=w.useState({}),[Le,qe]=w.useState({}),Pe=w.useRef(null),Dt=w.useRef(null),yt=w.useRef({}),[at,oe]=w.useState([]),[Ae,Xe]=w.useState(!1),pt=w.useRef(null),[ot,Gt]=w.useState([]),[bn,Ht]=w.useState(""),[on,Cn]=w.useState(!1),[On,Nn]=w.useState(null),[an,as]=w.useState([]),[br,ya]=w.useState(null),[gi,Lr]=w.useState(!1),js=w.useRef(!1),[Es,Ts]=w.useState(null),[os,In]=w.useState(!1),Xn=w.useRef(!1),pn=(()=>{const k=[{selector:".cb-ring-container",title:"Your 24-Hour Countdown",body:"Every day resets. This ring tracks the time you have left  tap your photo to personalise your profile.",cta:"Next"},{selector:".cb-stats-row",title:"Progress at a Glance",body:"Your workout streak, sessions this week, and daily habits  all in one row. These fill up as you go."},{selector:".cb-nudge-card",title:"Smart Suggestions",body:"We'll highlight what needs your attention  your next session, unfinished habits, or a meal to log."},{selector:".cb-card-workouts-hero",title:"Workout",body:"Randomiser workouts  pick your focus, level and time. Save and replay your favourites.",cta:"Next"}];return y&&k.push({selector:".cb-card-nutrition",title:"Nutrition Tracking",body:"Set your macro targets, scan barcodes, and log meals to hit your daily goals."},{selector:".cb-card-consistency",title:"Daily Habits",body:"5 simple habits each day  train, hit protein, 10k steps, sleep, and hydrate. Build your streak."},{selector:".cb-card-buddies",title:"Buddies & Social",body:"Connect with other members, share your journey, and keep each other accountable."},{selector:".cb-journey-section",title:"Share Your Journey",body:"Post photos, updates, and milestones  your fitness journey in one place. Like and comment on each other's posts."}),k.push({selector:".block-bottom-nav",title:"You're All Set!",body:"Use the nav bar to jump between your profile, workouts, nutrition, and buddies. Time to get after it.",cta:"Let's Go!"}),k})();w.useEffect(()=>{!u&&!s&&b("/")},[u,s,b]),w.useEffect(()=>{!u&&t&&t.signupSource==="self_signup"&&!t.onboardingComplete&&b("/onboarding")},[u,t,b]),w.useEffect(()=>{let k=t?.tourComplete||Xn.current;if(!k&&t?.id)try{k=!!localStorage.getItem(`tourDone_${t.id}`)}catch{}if(pe&&t&&!k){const N=setTimeout(()=>In(!0),600);return()=>clearTimeout(N)}},[pe,t]),w.useEffect(()=>{if(!(!pe||!t?.id)){try{if(localStorage.getItem(`targetHint_${t.id}`))return}catch{}if(!t?.weeklyWorkoutTarget){const k=setTimeout(()=>U(!0),1500);return()=>clearTimeout(k)}}},[pe,t]),w.useEffect(()=>{if(t)try{const k=sessionStorage.getItem(`cbDash_${t.id}`);if(k){const N=JSON.parse(k);Z(N.totalWorkouts??0),xe(N.habitWeekPct??0),L(N.nutritionTotals??{protein:0,carbs:0,fats:0,calories:0}),P(N.nutritionTargetData??null),M(N.todayHabitsCount??0),N.realHabitCount&&S(N.realHabitCount),st(N.weeklyWorkouts??0),Te(N.weeklyWorkoutTarget??$w),Ce(N.leaderboardTop3??[]),sn(N.streakWeeks??0),I(!0)}}catch{}},[t]),w.useEffect(()=>{t?.photoURL&&ve(t.photoURL),t?.weeklyWorkoutTarget&&Te(t.weeklyWorkoutTarget)},[t]),w.useEffect(()=>{if(!t)return;const k=Xt(lt(me,"notifications"),wt("toId","==",t.id)),N=oj(k,$=>{const G=$.docs.map(de=>({id:de.id,...de.data()}));G.sort((de,ke)=>{const Ee=de.createdAt?.toMillis?.()||0;return(ke.createdAt?.toMillis?.()||0)-Ee}),oe(G.slice(0,50))},$=>{console.error("Notification listener error:",$),$.code==="permission-denied"&&console.warn("Firestore rules may be missing for the notifications collection. Please update your Firestore rules in the Firebase Console.")});return()=>N()},[t]),w.useEffect(()=>{const k=N=>{pt.current&&!pt.current.contains(N.target)&&Xe(!1)};return document.addEventListener("mousedown",k),()=>document.removeEventListener("mousedown",k)},[]),w.useEffect(()=>{if(!t)return;const k=t.id;(async()=>{try{const[N,$,G]=await Promise.all([Ft(Xt(lt(me,"buddies"),wt("user1","==",k))),Ft(Xt(lt(me,"buddies"),wt("user2","==",k))),Ft(lt(me,"clients"))]),de=new Set;[...N.docs,...$.docs].forEach(Ee=>{const Ve=Ee.data();de.add(Ve.user1===k?Ve.user2:Ve.user1)});const ke={};G.docs.forEach(Ee=>{ke[Ee.id]=Ee.data()}),Gt(Array.from(de).filter(Ee=>ke[Ee]).map(Ee=>({id:Ee,name:ke[Ee].name,photoURL:ke[Ee].photoURL||null})))}catch(N){console.error("Error loading buddies for mentions:",N)}})()},[t]);const Jn=at.filter(k=>!k.read).length,Jr=async()=>{const k=at.filter($=>!$.read);if(!k.length)return;const N=Pw(me);k.forEach($=>N.update(He(me,"notifications",$.id),{read:!0})),await N.commit()},Ds=async()=>{if(!at.length)return;const k=Pw(me);at.forEach(N=>k.delete(He(me,"notifications",N.id))),await k.commit()},Zn=async(k,N,$={})=>{if(!(!t||k===t.id))try{await ir(lt(me,"notifications"),{toId:k,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:N,read:!1,createdAt:ws(),...$})}catch(G){console.error("Notification create error:",G),G.code==="permission-denied"&&ct("Notifications blocked  check Firestore rules","error")}},fs=(k,N)=>{const $=N==="compose"?Pe.current?.selectionStart:null,de=($!=null?k.slice(0,$):k).match(/@(\w*)$/);if(de){Cn(!0),Nn(N),Ht(de[1].toLowerCase());const ke=ot.filter(Ee=>Ee.name&&Ee.name.toLowerCase().includes(de[1].toLowerCase())).slice(0,5);as(ke)}else Cn(!1),as([])},Xs=(k,N)=>{if(N==="compose"){const $=Pe.current,G=kt,de=$?.selectionStart??G.length,ke=G.slice(0,de),Ee=G.slice(de),Ve=ke.replace(/@\w*$/,`@${k.name} `);jt(Ve+Ee),setTimeout(()=>{$?.focus(),$.selectionStart=$.selectionEnd=Ve.length},0)}else{const G=(zt[N]||"").replace(/@\w*$/,`@${k.name} `);bt(de=>({...de,[N]:G}))}Cn(!1),as([])},Zr=k=>k&&k.split(/(@\w[\w\s]*?\s)/g).map(($,G)=>$.startsWith("@")&&ot.some(de=>$.trim()===`@${de.name}`)?a.jsx("span",{className:"mention-highlight",children:$.trim()},G):$),O=async k=>{const N=k.target.files?.[0];if(!(!N||!t)){if(!N.type.startsWith("image/")){ct("Please select an image file","error");return}if(N.size>5*1024*1024){ct("Image must be under 5MB","error");return}Fe(!0);try{const $=await new Promise(ke=>{const Ee=new Image;Ee.onload=()=>{const Ve=document.createElement("canvas"),Ie=400;let Ze=Ee.width,Ut=Ee.height;Ze>Ut?(Ut=Ut/Ze*Ie,Ze=Ie):(Ze=Ze/Ut*Ie,Ut=Ie),Ve.width=Ze,Ve.height=Ut,Ve.getContext("2d").drawImage(Ee,0,0,Ze,Ut),Ve.toBlob(Mn=>ke(Mn),"image/jpeg",.75)},Ee.src=URL.createObjectURL(N)}),G=na(sa,`profilePhotos/${t.id}`);await pu(G,$);const de=await to(G);await zn(He(me,"clients",t.id),{photoURL:de}),ve(de),l({photoURL:de}),ct("Profile photo updated!","success")}catch($){console.error("Photo upload error:",$),ct("Failed to upload photo","error")}Fe(!1),Ge.current&&(Ge.current.value="")}};w.useEffect(()=>{const k=()=>{const $=new Date,G=new Date($);G.setHours(23,59,59,999);const de=G-$,ke=Math.floor(de/(1e3*60*60)),Ee=Math.floor(de%(1e3*60*60)/(1e3*60)),Ve=Math.floor(de%(1e3*60)/1e3);K({hours:ke,minutes:Ee,seconds:Ve}),Y(60-Ve)};k();const N=setInterval(k,1e3);return()=>clearInterval(N)},[]),w.useEffect(()=>{const k=setInterval(()=>{_n(N=>(N+1)%Jg.length)},8e3);return()=>clearInterval(k)},[]),w.useEffect(()=>{if(!s||!t)return;(async()=>{let N=null,$=null;try{const G=Xg(new Date),de=lt(me,"workoutLogs"),ke=Xt(de,wt("clientId","==",t.id));N=await Ft(ke),Z(N.docs.length);const Ee=new Date,Ve=Ee.getDay(),Ie=Ve===0?6:Ve-1,Ze=new Date(Ee);Ze.setDate(Ee.getDate()-Ie),Ze.setHours(0,0,0,0);const Ut=Ze.getTime(),Mn=N.docs.filter(Pn=>{const Kn=Pn.data().completedAt;return Kn?(Kn.toDate?Kn.toDate().getTime():new Date(Kn).getTime())>=Ut:!1}).length;st(Mn);const[ft,dn]=await Promise.all([Ft(Xt(lt(me,"habitLogs"),wt("clientId","==",t.id),wt("date","==",G))),xs(He(me,"customHabits",t.id))]);let hn=Ww;if(dn.exists()){const Pn=dn.data(),Kn=Pn.habits||[],Vn=Pn.hiddenDefaults||[];hn=S3.filter(ur=>!Vn.includes(ur)).length+Kn.length}y||(hn=Math.min(hn,p)),S(hn);let mt=0;if(!ft.empty){const Pn=ft.docs[0].data().habits||{};mt=Object.values(Pn).filter(Boolean).length}xe(Math.round(mt/hn*100)),M(mt);const Lt=await xs(He(me,"nutritionTargets",t.id));Lt.exists()&&(P(Lt.data()),$=Lt.data());const ls=await xs(He(me,"nutritionLogs",`${t.id}_${G}`));if(ls.exists()){const Kn=(ls.data().entries||[]).reduce((Vn,Hn)=>({protein:Vn.protein+(Hn.protein||0),carbs:Vn.carbs+(Hn.carbs||0),fats:Vn.fats+(Hn.fats||0),calories:Vn.calories+(Hn.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});L(Kn)}}catch(G){console.error("Error loading dashboard stats:",G)}try{const G=lt(me,"clients"),de=Xt(G,wt("leaderboardOptIn","==",!0)),Ee=(await Ft(de)).docs.map(Ve=>({id:Ve.id,name:Ve.data().name,photoURL:Ve.data().photoURL||null}));if(Ce(Ee.slice(0,3)),t?.id){const Ve=Ee.findIndex(Ze=>Ze.id===t.id),Ie=Ve>=0?Ve+1:null;try{const Ze=`lbRank_${t.id}`,Ut=sessionStorage.getItem(Ze);Ut&&Ts(parseInt(Ut,10)),Ie&&sessionStorage.setItem(Ze,String(Ie))}catch{}}}catch(G){console.error("Leaderboard preview error:",G)}try{let G=0;if(N){const de=N.docs.map(ke=>ke.data().date).filter(Boolean).sort().reverse();if(de.length>0){const ke=new Date;let Ee=new Date(ke);e:for(let Ve=0;Ve<52;Ve++){const Ie=new Date(Ee),Ze=Ie.getDay(),Ut=Ze===0?6:Ze-1;Ie.setDate(Ie.getDate()-Ut),Ie.setHours(0,0,0,0);const Mn=new Date(Ie);Mn.setDate(Mn.getDate()+7);const ft=Xg(Ie),dn=Xg(Mn);if(de.some(mt=>mt>=ft&&mt<dn))G++;else{if(Ve>0)break e;break}Ee.setDate(Ee.getDate()-7)}}}sn(G)}catch(G){console.error("Streak computation error:",G)}I(!0)})()},[s,t,R]),w.useEffect(()=>{if(!(!pe||!t))try{sessionStorage.setItem(`cbDash_${t.id}`,JSON.stringify({totalWorkouts:Q,habitWeekPct:ge,nutritionTotals:T,nutritionTargetData:V,todayHabitsCount:D,realHabitCount:j,weeklyWorkouts:Me,weeklyWorkoutTarget:J,leaderboardTop3:le,streakWeeks:tt}))}catch{}},[pe,Q,ge,T,V,D,Me,J,le,tt,t]),w.useEffect(()=>{if(!(!pe||js.current)&&Me>=J&&J>0){const k=`weekCeleb_${t?.id}_${new Date().toISOString().slice(0,10).replace(/-\d{2}$/,"")}`;try{if(sessionStorage.getItem(k))return;sessionStorage.setItem(k,"1")}catch{}js.current=!0,Lr(!0),setTimeout(()=>Lr(!1),3500)}},[pe,Me,J,t]);const q=w.useCallback(async()=>{if(Xn.current=!0,In(!1),l({tourComplete:!0}),t?.id){try{localStorage.setItem(`tourDone_${t.id}`,"1")}catch{}try{await zn(He(me,"clients",t.id),{tourComplete:!0})}catch(k){console.error("Failed to save tour completion:",k)}}},[t,l]),se=w.useCallback(async k=>{if(Te(k),Ne(!1),U(!1),t?.id){try{localStorage.setItem(`targetHint_${t.id}`,"1")}catch{}try{await zn(He(me,"clients",t.id),{weeklyWorkoutTarget:k})}catch(N){console.error("Failed to save weekly target:",N)}}},[t]),te=k=>{const N=k.currentTarget,$=N.querySelector(".ripple");$&&$.remove();const G=N.getBoundingClientRect(),de=Math.max(G.width,G.height),ke=k.clientX-G.left-de/2,Ee=k.clientY-G.top-de/2,Ve=document.createElement("span");Ve.className="ripple",Ve.style.cssText=`width:${de}px;height:${de}px;left:${ke}px;top:${Ee}px;`,N.appendChild(Ve),setTimeout(()=>Ve.remove(),600)},$e=t?.name?.split(" ")[0]||"there",Ke=Math.min(Math.round(Me/J*100),100),Ye=tt>0?Math.min(Math.round(tt/12*100),100):0,it=[{label:"Wk Streak",value:`${tt}`,pct:Ye,color:"var(--color-primary)",size:"normal"},{label:"Workouts",value:`${Me}/${J}`,pct:Ke,color:"var(--color-primary)",size:"large",editable:!0},{label:"Habits Today",value:`${ge}%`,pct:ge,color:"var(--color-primary)",size:"normal"}],Et=T.calories>0&&V?.calories&&T.calories>=V.calories*.8,kn=Me>=J&&J>0,Ns=D>=R,es=(()=>{if(!pe)return null;const k=J-Me;return k===1?"1 more workout to hit your weekly goal":k===2?"2 more workouts to hit your weekly goal":R-D===1?"1 habit left to complete today":null})(),As=k=>!V||!V[k]?0:Math.min(Math.round(T[k]/V[k]*100),100),ei=(()=>{const k=new Date().getHours(),N=pe&&D>=R&&T.calories>0,$=G=>G[Math.floor(Date.now()/6e4%G.length)];return N?$(Zc.allDone):k>=5&&k<12?$(Zc.morning):k>=12&&k<17?$(Zc.afternoon):k>=17&&k<21?$(Zc.evening):$(Zc.night)})(),Ls=pe?Me===0?{label:"WORKOUT",message:"No workouts this week yet",cta:"Start One",action:()=>b("/client/core-buddy/workouts"),pct:0,ringLabel:"0"}:D<R?{label:"DAILY HABITS",message:`${D}/${R} completed`,cta:"Open Habits",action:()=>b("/client/core-buddy/consistency"),pct:ge,ringLabel:`${D}/${R}`}:y&&T.calories===0?{label:"NUTRITION",message:"No meals logged today",cta:"Log Meal",action:()=>b("/client/core-buddy/nutrition"),pct:0,ringLabel:"0"}:{label:"TODAY",message:"You're crushing it!",cta:null,action:null,pct:100,ringLabel:""}:null,Js=w.useCallback(async()=>{if(t){ue(!0);try{const k=await Ft(Xt(lt(me,"posts"),wt("authorId","==",t.id),qo("createdAt","desc"),$o(30)));rt(k.docs.map($=>({id:$.id,...$.data()})));const N=await Ft(Xt(lt(me,"postLikes"),wt("userId","==",t.id)));Qn(new Set(N.docs.map($=>$.data().postId)))}catch(k){console.error("Error loading journey:",k)}finally{ue(!1)}}},[t]);w.useEffect(()=>{pe&&t&&Js()},[pe,t,Js]);const va=k=>{const N=k.target.files?.[0];if(N){if(!N.type.startsWith("image/")){ct("Please select an image file","error");return}if(N.size>10*1024*1024){ct("Image must be under 10MB","error");return}Qe(N),Wt(URL.createObjectURL(N))}},wr=()=>{Qe(null),ut&&URL.revokeObjectURL(ut),Wt(null),Dt.current&&(Dt.current.value="")},Rs=async()=>{if(!(!kt.trim()&&!gt||en||!t)){Gn(!0);try{let k=null;if(gt){const de=await C3(gt),ke=`${Date.now()}_${Math.random().toString(36).slice(2,8)}`,Ee=na(sa,`postImages/${t.id}/${ke}`);await pu(Ee,de),k=await to(Ee)}await ir(lt(me,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:kt.trim(),type:k?"image":"text",imageURL:k||null,createdAt:ws(),likeCount:0,commentCount:0});const $=kt.trim().match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if($){const de=new Set;$.forEach(ke=>{const Ee=ke.slice(1).trim(),Ve=ot.find(Ie=>Ie.name&&Ie.name.toLowerCase()===Ee.toLowerCase());Ve&&!de.has(Ve.id)&&(de.add(Ve.id),Zn(Ve.id,"mention",{}))})}jt(""),wr(),Pe.current&&(Pe.current.style.height="auto"),await Js();const G=ot.length;ct(G>0?`Shared with ${G} ${G===1?"buddy":"buddies"}`:"Posted to your journey!","success")}catch(k){console.error("Error posting:",k),ct(k?.message||"Failed to post","error")}finally{Gn(!1)}}},ba=async k=>{if(window.confirm("Delete this post?"))try{await rr(He(me,"posts",k)),rt(N=>N.filter($=>$.id!==k)),ct("Post deleted","info")}catch(N){console.error("Delete error:",N),ct("Failed to delete","error")}},Li=async k=>{if(!t)return;const N=t.id,$=`${k}_${N}`,G=un.has(k),de=new Set(un);G?de.delete(k):de.add(k),Qn(de),rt(ke=>ke.map(Ee=>Ee.id===k?{...Ee,likeCount:Math.max(0,(Ee.likeCount||0)+(G?-1:1))}:Ee));try{if(G)await rr(He(me,"postLikes",$)),await zn(He(me,"posts",k),{likeCount:li(-1)});else{await _s(He(me,"postLikes",$),{postId:k,userId:N,createdAt:ws()}),await zn(He(me,"posts",k),{likeCount:li(1)});const ke=Bt.find(Ee=>Ee.id===k);ke&&Zn(ke.authorId,"like",{postId:k})}}catch(ke){console.error("Like error:",ke),Js()}},xr=async k=>{try{const N=await Ft(Xt(lt(me,"postComments"),wt("postId","==",k),qo("createdAt","asc"),$o(50)));tn($=>({...$,[k]:N.docs.map(G=>({id:G.id,...G.data()}))}))}catch(N){console.error("Error loading comments:",N)}},ti=k=>{const N=new Set(Fn);N.has(k)?N.delete(k):(N.add(k),Ln[k]||xr(k)),Rn(N)},Hs=async k=>{const N=(zt[k]||"").trim(),$=Re[k];if(!(!N&&!$||!t)){ee(G=>({...G,[k]:!0}));try{let G=null;if($){const Ie=na(sa,`comment-images/${Date.now()}_${$.name}`);await pu(Ie,$),G=await to(Ie)}const de={postId:k,authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:N||"",createdAt:ws()};G&&(de.imageURL=G);const ke=C[k];ke&&(de.replyToId=ke.id,de.replyToName=ke.authorName),await ir(lt(me,"postComments"),de),await zn(He(me,"posts",k),{commentCount:li(1)});const Ee=Bt.find(Ie=>Ie.id===k);Ee&&Zn(Ee.authorId,"comment",{postId:k});const Ve=N.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Ve){const Ie=new Set;Ve.forEach(Ze=>{const Ut=Ze.slice(1).trim(),Mn=ot.find(ft=>ft.name&&ft.name.toLowerCase()===Ut.toLowerCase());Mn&&!Ie.has(Mn.id)&&(Ie.add(Mn.id),Zn(Mn.id,"mention",{postId:k}))})}bt(Ie=>({...Ie,[k]:""})),De(Ie=>({...Ie,[k]:null})),qe(Ie=>({...Ie,[k]:null})),ae(Ie=>({...Ie,[k]:null})),yt.current[k]&&(yt.current[k].value=""),rt(Ie=>Ie.map(Ze=>Ze.id===k?{...Ze,commentCount:(Ze.commentCount||0)+1}:Ze)),await xr(k)}catch(G){console.error("Comment error:",G),ct("Failed to comment","error")}finally{ee(G=>({...G,[k]:!1}))}}},_r=async(k,N)=>{try{await rr(He(me,"postComments",N)),await zn(He(me,"posts",k),{commentCount:li(-1)}),tn($=>({...$,[k]:($[k]||[]).filter(G=>G.id!==N)})),rt($=>$.map(G=>G.id===k?{...G,commentCount:Math.max((G.commentCount||1)-1,0)}:G))}catch($){console.error("Delete comment error:",$),ct("Failed to delete comment","error")}},pi=(k,N)=>{const $=N.target.files?.[0];if(!$)return;if($.size>5*1024*1024){ct("Image must be under 5MB","error");return}De(de=>({...de,[k]:$}));const G=new FileReader;G.onload=de=>qe(ke=>({...ke,[k]:de.target.result})),G.readAsDataURL($)},Zs=k=>{De(N=>({...N,[k]:null})),qe(N=>({...N,[k]:null})),yt.current[k]&&(yt.current[k].value="")},er=k=>{jt(k.target.value),k.target.style.height="auto",k.target.style.height=Math.min(k.target.scrollHeight,120)+"px",fs(k.target.value,"compose")},F=(k,N)=>{bt($=>({...$,[k]:N})),fs(N,k)};return a.jsx(nl,{children:a.jsxs("div",{className:"cb-dashboard",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsxs("div",{className:"header-left-group",children:[a.jsxs("div",{className:"header-notif-wrap",ref:pt,children:[a.jsxs("button",{className:"header-notif-btn",onClick:()=>{Xe(!Ae),Ae||Jr()},"aria-label":"Notifications",children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),a.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),Jn>0&&a.jsx("span",{className:"header-notif-badge",children:Jn>9?"9+":Jn})]}),Ae&&a.jsxs("div",{className:"notif-panel",children:[a.jsxs("div",{className:"notif-panel-header",children:[a.jsx("span",{className:"notif-panel-title",children:"Notifications"}),at.length>0&&a.jsx("button",{className:"notif-clear-btn",onClick:Ds,children:"Clear all"})]}),a.jsx("div",{className:"notif-panel-list",children:at.length===0?a.jsx("div",{className:"notif-empty",children:"No notifications yet"}):at.map(k=>a.jsxs("div",{className:`notif-item${k.read?"":" unread"}`,onClick:()=>{if(Xe(!1),k.type==="buddy_request"||k.type==="buddy_accept")b(y?"/client/core-buddy/buddies":"/upgrade");else if((k.type==="like"||k.type==="comment")&&k.postId){if(!Fn.has(k.postId)){const N=new Set(Fn);N.add(k.postId),Rn(N),Ln[k.postId]||xr(k.postId)}setTimeout(()=>{const N=document.getElementById(`post-${k.postId}`);N&&N.scrollIntoView({behavior:"smooth",block:"center"})},150)}else k.type==="like"||k.type==="comment"?document.querySelector(".cb-journey-section")?.scrollIntoView({behavior:"smooth"}):k.type==="mention"&&b(`/client/core-buddy/profile/${k.fromId}`)},children:[a.jsx("div",{className:"notif-item-avatar",children:k.fromPhotoURL?a.jsx("img",{src:k.fromPhotoURL,alt:""}):a.jsx("span",{children:(k.fromName||"?")[0]})}),a.jsxs("div",{className:"notif-item-body",children:[a.jsxs("p",{className:"notif-item-text",children:[a.jsx("strong",{children:k.fromName})," ",k.type==="buddy_request"&&"sent you a buddy request",k.type==="buddy_accept"&&"accepted your buddy request",k.type==="like"&&"liked your post",k.type==="comment"&&"commented on your post",k.type==="mention"&&"mentioned you"]}),a.jsx("span",{className:"notif-item-time",children:Zg(k.createdAt)})]})]},k.id))})]})]}),a.jsx("button",{className:"header-icon-btn",onClick:()=>b("/client/core-buddy/settings"),"aria-label":"Settings",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})})]}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{className:"header-icon-btn",onClick:g,"aria-label":d?"Switch to light mode":"Switch to dark mode",children:d?a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})}),a.jsx("button",{className:"header-icon-btn",onClick:i,"aria-label":"Log out",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),a.jsxs("main",{className:"cb-main",children:[a.jsxs("div",{className:"cb-ring-container",children:[a.jsxs("div",{className:"cb-ring",children:[a.jsx("svg",{className:"cb-ring-svg",viewBox:"0 0 200 200",children:Tj.map((k,N)=>{const $=N<B;return a.jsx("line",{x1:k.x1,y1:k.y1,x2:k.x2,y2:k.y2,className:`ring-tick ${$?"elapsed":"remaining"}`,strokeWidth:k.thick?"3":"2"},N)})}),a.jsxs("div",{className:"cb-ring-center",children:[a.jsxs("div",{className:"cb-ring-logo",onClick:()=>Ge.current?.click(),role:"button",tabIndex:0,"aria-label":"Change profile photo",children:[a.jsx("img",{src:Se||"/Logo.webp",alt:Se?"Profile":"Mind Core Fitness"}),a.jsx("div",{className:`cb-photo-overlay${Oe?" uploading":""}`,children:Oe?a.jsx("div",{className:"cb-photo-spinner"}):a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),a.jsx("input",{ref:Ge,type:"file",accept:"image/*",onChange:O,style:{display:"none"}})]}),!Se&&!Oe&&a.jsx("div",{className:"cb-photo-badge",onClick:()=>Ge.current?.click(),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),a.jsxs("div",{className:"cb-ring-countdown",children:[a.jsx("span",{className:"cb-timer-digit",children:String(H.hours).padStart(2,"0")}),a.jsx("span",{className:"cb-timer-colon",children:":"}),a.jsx("span",{className:"cb-timer-digit",children:String(H.minutes).padStart(2,"0")}),a.jsx("span",{className:"cb-timer-colon",children:":"}),a.jsx("span",{className:"cb-timer-digit cb-timer-seconds",children:String(H.seconds).padStart(2,"0")})]}),a.jsx("span",{className:"cb-ring-label",children:"remaining today"}),a.jsxs("p",{className:"cb-ring-tagline",children:[Jg[Tt].text," ",a.jsx("strong",{children:Jg[Tt].bold})]},Tt)]}),a.jsx("div",{className:"cb-stats-row",children:it.map(k=>{const N=(k.size==="large",38),$=2*Math.PI*N,G=$-k.pct/100*$,de=k.editable,ke=k.pct>=75&&k.pct<100,Ee=k.pct>=100;return a.jsxs("div",{className:`cb-stat-item${k.size==="large"?" cb-stat-large":""}`,children:[a.jsxs("div",{className:`cb-stat-ring${de?" cb-stat-tappable":""}${de&&ze?" cb-stat-hint":""}${ke?" cb-stat-near":""}${Ee?" cb-stat-complete":""}`,onClick:de?()=>{Ne(!0),U(!1)}:void 0,children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-stat-track",cx:"50",cy:"50",r:N}),a.jsx("circle",{className:`cb-stat-fill${ke?" cb-fill-near":""}${Ee?" cb-fill-complete":""}`,cx:"50",cy:"50",r:N,strokeDasharray:$,strokeDashoffset:G})]}),a.jsx("span",{className:`cb-stat-value${Ee?" cb-val-complete":""}`,children:k.value})]}),a.jsxs("span",{className:"cb-stat-label",children:[k.label==="Wk Streak"&&tt>0&&a.jsx("svg",{className:"cb-streak-flame",width:"12",height:"12",viewBox:"0 0 24 24",fill:"var(--color-primary)",stroke:"none",children:a.jsx("path",{d:"M12 12c2-2.96 0-7-1-8 0 3.038-1.773 4.741-3 6-1.226 1.26-2 3.24-2 5a6 6 0 1 0 12 0c0-1.532-1.056-3.94-2-5-1.786 3-2.791 3-4 2z"})}),k.label]})]},k.label)})}),Ue&&a.jsx("div",{className:"cb-target-overlay",onClick:()=>Ne(!1),children:a.jsxs("div",{className:"cb-target-picker",onClick:k=>k.stopPropagation(),children:[a.jsx("h4",{children:"Weekly workout goal"}),a.jsx("p",{children:"How many sessions per week?"}),a.jsx("div",{className:"cb-target-options",children:[1,2,3,4,5,6,7].map(k=>a.jsx("button",{className:`cb-target-option${k===J?" active":""}`,onClick:()=>se(k),children:k},k))})]})}),a.jsxs("p",{className:"cb-coach-msg",children:[ei.main," ",a.jsx("strong",{children:$e}),"  ",ei.sub]}),es&&a.jsxs("div",{className:"cb-milestone-hint",children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),a.jsx("span",{children:es})]}),Ls&&a.jsxs("button",{className:"cb-nudge-card",onClick:Ls.action||void 0,style:Ls.action?void 0:{cursor:"default"},children:[a.jsxs("div",{className:"cb-nudge-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-nudge-ring-track",cx:"50",cy:"50",r:"38"}),a.jsx("circle",{className:"cb-nudge-ring-fill",cx:"50",cy:"50",r:"38",strokeDasharray:2*Math.PI*38,strokeDashoffset:2*Math.PI*38-Ls.pct/100*2*Math.PI*38})]}),a.jsx("span",{className:"cb-nudge-ring-val",children:Ls.ringLabel})]}),a.jsxs("div",{className:"cb-nudge-info",children:[a.jsx("span",{className:"cb-nudge-label",children:Ls.label}),a.jsx("span",{className:"cb-nudge-title",children:Ls.message}),Ls.cta&&a.jsxs("span",{className:"cb-nudge-cta",children:[Ls.cta," "]})]})]}),a.jsxs("div",{className:"cb-features",children:[y&&a.jsxs("button",{className:`cb-feature-card cb-card-nutrition cb-card-has-preview ripple-btn${Et?" cb-card-done":""}`,onClick:k=>{te(k),b("/client/core-buddy/nutrition")},children:[a.jsxs("div",{className:"cb-card-top-row",children:[a.jsx("div",{className:"cb-card-content",children:a.jsx("h3",{children:"Today's Nutrition"})}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsx("div",{className:"cb-card-preview-row",children:a.jsx("div",{className:"cb-mini-rings",children:[{label:"P",pct:As("protein"),color:"var(--color-primary)"},{label:"C",pct:As("carbs"),color:"var(--color-primary)"},{label:"F",pct:As("fats"),color:"var(--color-primary)"},{label:"Cal",pct:As("calories"),color:"var(--color-primary)"}].map(k=>{const $=2*Math.PI*38,G=$-k.pct/100*$;return a.jsxs("div",{className:"cb-mini-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-mini-track",cx:"50",cy:"50",r:38}),a.jsx("circle",{className:"cb-mini-fill",cx:"50",cy:"50",r:38,style:{stroke:k.color},strokeDasharray:$,strokeDashoffset:G})]}),a.jsx("span",{style:{color:k.color},children:k.label})]},k.label)})})}),a.jsx("p",{className:"cb-card-desc",children:"Track macros, scan barcodes, log water"})]}),a.jsxs("button",{className:`cb-feature-card cb-card-workouts-hero ripple-btn${kn?" cb-card-done":""}`,onClick:k=>{te(k),b("/client/core-buddy/workouts")},children:[a.jsx("h3",{className:"cb-hero-title",children:"Workout"}),a.jsxs("div",{className:"cb-hero-stats",children:[a.jsxs("span",{children:[Me," this week"]}),a.jsx("span",{className:"cb-hero-dot",children:""}),a.jsxs("span",{children:[Q," total"]})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:`cb-feature-card cb-card-consistency ripple-btn${Ns?" cb-card-done":""}`,onClick:k=>{te(k),b("/client/core-buddy/consistency")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Habits"}),a.jsx("div",{className:`cb-habit-dots${D>=R?" cb-habits-all-done":""}`,children:Array.from({length:R},(k,N)=>a.jsx("span",{className:`cb-habit-dot${N<D?" done":""}${!N&&D>0&&N>=D?" cb-dot-warming":""}`,style:N>=D&&D>0?{"--glow-intensity":Math.min(D/R,.9)}:void 0},N))}),a.jsxs("span",{className:"cb-habit-dots-label",children:[D,"/",R," today"]})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:"cb-feature-card cb-card-leaderboard ripple-btn",onClick:k=>{te(k),b("/client/leaderboard")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Leaderboard"}),le.length>0?a.jsx("div",{className:"cb-lb-preview",children:le.map((k,N)=>{const $=["#FFD700","#A8B4C0","#CD7F32"][N],G=k.name?k.name.split(" ").map(Ve=>Ve[0]).join("").slice(0,2).toUpperCase():"?",de=k.id===t?.id,ke=N+1,Ee=de&&Es?Es-ke:0;return a.jsxs("div",{className:`cb-lb-entry${de?" cb-lb-me":""}`,children:[a.jsx("div",{className:"cb-lb-avatar",style:{borderColor:$},children:k.photoURL?a.jsx("img",{src:k.photoURL,alt:"",className:"cb-lb-avatar-img"}):a.jsx("span",{children:G})}),a.jsxs("span",{className:"cb-lb-rank",style:{color:$},children:["#",ke,de&&Ee>0&&a.jsxs("span",{className:"cb-lb-movement cb-lb-up",children:["+",Ee]}),de&&Ee<0&&a.jsx("span",{className:"cb-lb-movement cb-lb-down",children:Ee})]})]},k.id)})}):a.jsx("p",{children:"Opt in to compete with your Core Buddies"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),y&&a.jsxs("div",{className:"cb-grid-row",children:[a.jsxs("button",{className:"cb-feature-card cb-grid-card cb-card-challenge ripple-btn",onClick:k=>{te(k),b("/client/core-buddy/challenges")},children:[a.jsx("div",{className:"cb-card-icon-wrap cb-card-icon-challenge",children:a.jsx("img",{src:Kr.find(k=>k.id==="iron_will")?.img,alt:"",className:"cb-card-badge-img",loading:"lazy"})}),a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Challenges"}),a.jsx("p",{children:"Push yourself with timed fitness challenges"})]}),a.jsx("svg",{className:"cb-grid-arrow",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:"cb-feature-card cb-grid-card cb-card-badges ripple-btn",onClick:k=>{te(k),b("/client/core-buddy/badges")},children:[a.jsx("div",{className:"cb-card-icon-wrap cb-card-icon-badges",children:a.jsx("img",{src:Kr.find(k=>k.id==="first_workout")?.img,alt:"",className:"cb-card-badge-img",loading:"lazy"})}),a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Badges"}),a.jsx("p",{children:"Collect badges as you hit milestones"})]}),a.jsx("svg",{className:"cb-grid-arrow",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]})]}),y&&a.jsxs("button",{className:"cb-feature-card cb-card-buddies ripple-btn",onClick:k=>{te(k),b("/client/core-buddy/buddies")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Buddies"}),a.jsx("p",{children:"Connect with other members and track each other's progress"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),y&&a.jsxs("div",{className:"cb-journey-section",children:[a.jsx("h3",{className:"cb-journey-title",children:"My Journey"}),a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"journey-compose",children:[a.jsx("div",{className:"journey-compose-avatar",children:Se?a.jsx("img",{src:Se,alt:""}):a.jsx("span",{children:eu(t?.name)})}),a.jsxs("div",{className:"journey-compose-body",style:{position:"relative"},children:[a.jsx("textarea",{ref:Pe,placeholder:"Share your progress... (use @ to mention)",value:kt,onChange:er,rows:1,maxLength:500}),on&&On==="compose"&&an.length>0&&a.jsx("div",{className:"mention-dropdown",children:an.map(k=>a.jsxs("button",{className:"mention-option",onClick:()=>Xs(k,"compose"),children:[a.jsx("div",{className:"mention-option-avatar",children:k.photoURL?a.jsx("img",{src:k.photoURL,alt:""}):a.jsx("span",{children:eu(k.name)})}),a.jsx("span",{children:k.name})]},k.id))}),ut&&a.jsxs("div",{className:"journey-image-preview",children:[a.jsx("img",{src:ut,alt:"Preview"}),a.jsx("button",{className:"journey-image-remove",onClick:wr,"aria-label":"Remove image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"journey-compose-actions",children:[a.jsx("button",{className:"journey-image-btn",onClick:()=>Dt.current?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:Dt,type:"file",accept:"image/*",onChange:va,hidden:!0}),(kt.trim()||gt)&&a.jsx("button",{className:"journey-post-btn",onClick:Rs,disabled:en,children:en?a.jsx("div",{className:"journey-btn-spinner"}):"Post"})]})]})]}),Vt?a.jsx("div",{className:"journey-loading",children:a.jsx("div",{className:"cb-spinner"})}):Bt.length===0?a.jsxs("div",{className:"journey-empty",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("p",{children:"Start sharing your fitness journey!"})]}):a.jsx("div",{className:"journey-list",children:Bt.map(k=>a.jsxs("div",{id:`post-${k.id}`,className:"journey-post",children:[a.jsxs("div",{className:"journey-post-header",children:[a.jsx("div",{className:"journey-post-avatar",children:k.authorPhotoURL?a.jsx("img",{src:k.authorPhotoURL,alt:""}):a.jsx("span",{children:eu(k.authorName)})}),a.jsxs("div",{className:"journey-post-meta",children:[a.jsx("span",{className:"journey-post-name",children:k.authorName}),a.jsx("span",{className:"journey-post-time",children:Zg(k.createdAt)})]}),a.jsx("button",{className:"journey-delete-btn",onClick:()=>ba(k.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),k.type==="workout_summary"&&k.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:k.metadata.title}),k.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:k.metadata.stats.map(N=>`${N.value} ${N.label}`).join("    ")}),!k.metadata.stats?.length&&k.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:k.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed a workout using Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):k.type==="badge_earned"&&k.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame journey-card-logo-badge",children:(()=>{const N=Kr.find($=>$.id===k.metadata.badgeId);return N?.img?a.jsx("img",{src:N.img,alt:k.metadata.title,className:"journey-card-logo-img",loading:"lazy"}):a.jsx("img",{src:"/Logo.webp",alt:k.metadata.title,className:"journey-card-logo-img"})})()}),a.jsx("h3",{className:"journey-card-title",children:k.metadata.title}),k.metadata.badgeDesc&&a.jsx("p",{className:"journey-card-stats-line",children:k.metadata.badgeDesc}),a.jsx("p",{className:"journey-card-cta",children:"I just earned a badge on Core Buddy"}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):k.type==="habits_summary"&&k.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:k.metadata.title}),k.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:k.metadata.stats.map(N=>`${N.value} ${N.label}`).join("    ")}),k.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:k.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed my daily habits with Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):a.jsxs(a.Fragment,{children:[k.content&&a.jsx("p",{className:"journey-post-content",children:Zr(k.content)}),k.imageURL&&a.jsx("div",{className:"journey-post-image",children:a.jsx("img",{src:k.imageURL,alt:"Post",loading:"lazy"})})]}),a.jsxs("div",{className:"journey-post-actions",children:[a.jsxs("button",{className:`journey-action-btn${un.has(k.id)?" liked":""}`,onClick:()=>Li(k.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:un.has(k.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:k.likeCount||0})]}),a.jsxs("button",{className:`journey-action-btn${Fn.has(k.id)?" active":""}`,onClick:()=>ti(k.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:k.commentCount||0})]})]}),Fn.has(k.id)&&a.jsxs("div",{className:"journey-comments",children:[Ln[k.id]?.length>0?Ln[k.id].map(N=>a.jsxs("div",{className:"journey-comment",children:[a.jsx("div",{className:"journey-comment-avatar",children:N.authorPhotoURL?a.jsx("img",{src:N.authorPhotoURL,alt:""}):a.jsx("span",{children:eu(N.authorName)})}),a.jsxs("div",{className:"journey-comment-body",children:[a.jsxs("div",{className:"journey-comment-bubble",children:[a.jsx("span",{className:"journey-comment-name",children:N.authorName}),N.replyToName&&a.jsxs("span",{className:"journey-comment-reply-tag",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"9 14 4 9 9 4"}),a.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),N.replyToName]}),N.content&&a.jsx("span",{className:"journey-comment-text",children:Zr(N.content)}),N.imageURL&&a.jsx("img",{className:"journey-comment-image",src:N.imageURL,alt:"Comment",loading:"lazy"})]}),a.jsxs("div",{className:"journey-comment-actions-row",children:[a.jsx("span",{className:"journey-comment-time",children:Zg(N.createdAt)}),a.jsx("button",{className:"journey-comment-reply-btn",onClick:()=>ae($=>({...$,[k.id]:{id:N.id,authorName:N.authorName}})),children:"Reply"}),a.jsx("button",{className:"journey-comment-delete-btn",onClick:()=>_r(k.id,N.id),"aria-label":"Delete comment",children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]})]},N.id)):a.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),C[k.id]&&a.jsxs("div",{className:"journey-comment-replying",children:[a.jsxs("span",{children:["Replying to ",a.jsx("strong",{children:C[k.id].authorName})]}),a.jsx("button",{onClick:()=>ae(N=>({...N,[k.id]:null})),"aria-label":"Cancel reply",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),Le[k.id]&&a.jsxs("div",{className:"journey-comment-img-preview",children:[a.jsx("img",{src:Le[k.id],alt:"Preview"}),a.jsx("button",{onClick:()=>Zs(k.id),"aria-label":"Remove image",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[a.jsx("button",{className:"journey-comment-img-btn",onClick:()=>yt.current[k.id]?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:N=>{yt.current[k.id]=N},type:"file",accept:"image/*",onChange:N=>pi(k.id,N),hidden:!0}),a.jsx("input",{type:"text",placeholder:"Comment",value:zt[k.id]||"",onChange:N=>F(k.id,N.target.value),onKeyDown:N=>{N.key==="Enter"&&Hs(k.id)},maxLength:300}),on&&On===k.id&&an.length>0&&a.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:an.map(N=>a.jsxs("button",{className:"mention-option",onClick:()=>Xs(N,k.id),children:[a.jsx("div",{className:"mention-option-avatar",children:N.photoURL?a.jsx("img",{src:N.photoURL,alt:""}):a.jsx("span",{children:eu(N.name)})}),a.jsx("span",{children:N.name})]},N.id))}),a.jsx("button",{onClick:()=>Hs(k.id),disabled:!(zt[k.id]||"").trim()&&!Re[k.id]||At[k.id],children:At[k.id]?a.jsx("div",{className:"journey-btn-spinner-sm"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),a.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},k.id))})]})]}),!y&&a.jsxs("button",{className:"cb-upgrade-cta",onClick:()=>b("/upgrade"),children:[a.jsx("span",{className:"cb-upgrade-cta-text",children:"Unlock the full experience"}),a.jsx("span",{className:"cb-upgrade-cta-sub",children:"Unlimited workout times, nutrition, buddies & more"}),a.jsxs("svg",{className:"cb-upgrade-cta-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]})]})]}),a.jsx(Xr,{active:"home"}),gi&&a.jsx("div",{className:"cb-weekly-celebration",children:a.jsxs("div",{className:"cb-weekly-celebration-card",children:[a.jsx("span",{className:"cb-weekly-celebration-icon",children:a.jsx("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsx("h4",{children:"Weekly Goal Smashed!"}),a.jsxs("p",{children:[Me,"/",J," sessions complete"]})]})}),gn&&a.jsxs("div",{className:`toast-notification ${gn.type}`,children:[gn.type==="info"&&a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),a.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),gn.type==="success"&&a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),gn.message]}),a.jsx(c3,{steps:pn,active:os,onFinish:q})]})})}async function ef(s,e){const t=Kr.find(i=>i.id===s);if(!t||!e?.id)return null;try{const i=He(me,"coreBuddyBadges",e.id),l=await xs(i),u=l.exists()?l.data().earned||[]:[];if(u.some(g=>g.id===t.id))return null;const d={id:t.id,earnedAt:new Date().toISOString()};return l.exists()?await zn(i,{earned:[...u,d]}):await _s(i,{earned:[d]}),await ir(lt(me,"posts"),{authorId:e.id,authorName:e.name||"Anonymous",authorPhotoURL:e.photoURL||null,type:"badge_earned",metadata:{title:t.name,badgeDesc:t.desc,badgeId:t.id},createdAt:ws(),likeCount:0,commentCount:0}),t}catch(i){return console.error("Badge award failed:",i),null}}function Wl({badge:s,onDismiss:e}){if(!s)return null;const t=Array.from({length:60}).map((i,l)=>({x:5+Math.random()*90,delay:Math.random()*.5,color:["#A12F3A","#ffffff","#000000"][l%3],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.6+Math.random()*1.8,width:4+Math.random()*6,height:4+Math.random()*8,shape:l%3}));return a.jsxs("div",{className:"bc-overlay",onClick:e,children:[a.jsx("div",{className:"bc-confetti","aria-hidden":"true",children:t.map((i,l)=>a.jsx("span",{className:`bc-confetti-piece bc-shape-${i.shape}`,style:{"--x":`${i.x}%`,"--delay":`${i.delay}s`,"--color":i.color,"--drift":`${i.drift}px`,"--spin":`${i.spin}deg`,"--duration":`${i.duration}s`,width:`${i.width}px`,height:`${i.height}px`}},l))}),a.jsxs("div",{className:"bc-content",onClick:i=>i.stopPropagation(),children:[a.jsx("div",{className:"bc-glow"}),s.img&&a.jsx("img",{src:s.img,alt:s.name,className:"bc-badge-img"}),a.jsx("h2",{className:"bc-title",children:"Badge Unlocked!"}),a.jsx("p",{className:"bc-name",children:s.name}),a.jsx("p",{className:"bc-desc",children:s.desc}),a.jsx("button",{className:"bc-dismiss",onClick:e,children:"Tap to dismiss"})]})]})}const ep=new Map;function $r(){return new Date().toISOString().split("T")[0]}const Gw=[{key:"breakfast",label:"Breakfast"},{key:"lunch",label:"Lunch"},{key:"dinner",label:"Dinner"},{key:"snacks",label:"Snacks"}],A3={breakfast:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1"}),a.jsx("path",{d:"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"}),a.jsx("line",{x1:"6",y1:"1",x2:"6",y2:"4"}),a.jsx("line",{x1:"10",y1:"1",x2:"10",y2:"4"}),a.jsx("line",{x1:"14",y1:"1",x2:"14",y2:"4"})]}),lunch:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}),dinner:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),snacks:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})};function R3(){const s=new Date().getHours();return s<11?"breakfast":s<14?"lunch":s<17?"snacks":"dinner"}function I3(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Dr(),{isDark:l,toggleTheme:u}=Di(),d=Qs(),[g,y]=w.useState("loading"),[p,b]=w.useState(null),[j,S]=w.useState(null),[R,H]=w.useState({gender:"male",age:"",weight:"",weightUnit:"kg",height:"",heightUnit:"cm",heightFeet:"",heightInches:"",dailyActivity:"sedentary",trainingFrequency:"moderate",goal:"maintain",deficitLevel:"moderate"}),[K,B]=w.useState(null),[Y,Q]=w.useState($r()),[Z,ge]=w.useState({entries:[]}),[xe,pe]=w.useState({protein:0,carbs:0,fats:0,calories:0}),[I,T]=w.useState(!1),[L,V]=w.useState(()=>{const O=new Date;return{year:O.getFullYear(),month:O.getMonth()}}),[P,D]=w.useState(!1),[M,Me]=w.useState(()=>{const O=new Date;return{year:O.getFullYear(),month:O.getMonth()}}),[st,J]=w.useState(!1),[Te,Ue]=w.useState(R3),[Ne,ze]=w.useState(null),[U,le]=w.useState(null),[Ce,Se]=w.useState(!1),[ve,Oe]=w.useState(null),[Fe,Ge]=w.useState(""),[tt,sn]=w.useState(!1),[Tt,_n]=w.useState(""),[gn,Mt]=w.useState([]),[ct,Bt]=w.useState(!1),[rt,Vt]=w.useState({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),[ue,kt]=w.useState(null),[jt,gt]=w.useState("100"),[Qe,ut]=w.useState(0),[Wt,en]=w.useState("weight"),[Gn,un]=w.useState(0),[Qn,Fn]=w.useState(null);w.useRef(null);const Rn=w.useRef(!1),Ln=w.useRef(null),tn=w.useRef(null),zt=w.useRef(null),bt=w.useCallback((O,q="info")=>{Fn({message:O,type:q}),setTimeout(()=>Fn(null),3e3)},[]);w.useEffect(()=>{!i&&(!s||!e)&&d("/")},[s,e,i,d]),w.useEffect(()=>{if(!t?.id)return;(async()=>{try{const q=await xs(He(me,"nutritionTargets",t.id));q.exists()?(b(q.data()),y("dashboard")):y("setup")}catch(q){console.error("Error loading nutrition data:",q),y("setup")}})()},[t?.id]),w.useEffect(()=>{if(!t?.id)return;(async()=>{try{const q=await xs(He(me,"nutritionLogs",`${t.id}_${Y}`));if(q.exists()){const se=q.data();ge({entries:se.entries||[]})}else ge({entries:[]})}catch(q){console.error("Error loading log:",q),ge({entries:[]})}})()},[t?.id,Y]),w.useEffect(()=>{const O=Z.entries.reduce((q,se)=>({protein:q.protein+(se.protein||0),carbs:q.carbs+(se.carbs||0),fats:q.fats+(se.fats||0),calories:q.calories+(se.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});pe(O)},[Z.entries]);const At=async O=>{try{if(await _s(He(me,"nutritionLogs",`${t.id}_${Y}`),{clientId:t.id,date:Y,entries:O.entries,updatedAt:Pt.now()}),p?.protein&&Y===$r()&&O.entries.reduce((se,te)=>se+(te.protein||0),0)>=p.protein){let se=1;for(let te=1;te<7;te++){const $e=new Date;$e.setDate($e.getDate()-te);const Ke=$e.toISOString().split("T")[0];try{const Ye=await xs(He(me,"nutritionLogs",`${t.id}_${Ke}`));if(Ye.exists())if((Ye.data().entries||[]).reduce((Et,kn)=>Et+(kn.protein||0),0)>=p.protein)se++;else break;else break}catch{break}}if(se>=7){const te=await ef("nutrition_7",t);te&&S(te)}}}catch(q){console.error("Error saving nutrition log:",q)}},ee=Y===$r(),C=(O,q)=>new Date(O,q+1,0).getDate(),ae=(O,q)=>new Date(O,q,1).getDay(),Re=O=>{if(O===$r())return"Today";const q=new Date(O+"T12:00:00"),se=new Date;return se.setDate(se.getDate()-1),O===se.toISOString().split("T")[0]?"Yesterday":q.toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short"})},De=["January","February","March","April","May","June","July","August","September","October","November","December"],Le=["Su","Mo","Tu","We","Th","Fr","Sa"],qe=()=>{let O=parseFloat(R.weight);R.weightUnit==="lbs"&&(O*=.453592);let q;R.heightUnit==="cm"?q=parseFloat(R.height):q=(parseFloat(R.heightFeet)||0)*30.48+(parseFloat(R.heightInches)||0)*2.54;const se=parseInt(R.age);let te=R.gender==="male"?10*O+6.25*q-5*se+5:10*O+6.25*q-5*se-161;const Ke=te*{sedentary:1.2,light:1.3,moderate:1.4,active:1.5}[R.dailyActivity],Ye={low:100,moderate:200,high:300,daily:400},it=Math.round(Ke+Ye[R.trainingFrequency]);let Et=it,kn,Ns;switch(R.goal){case"lose":Et=it*(1-{light:.15,moderate:.2,harsh:.25}[R.deficitLevel]),kn=2.2,Ns=.3;break;case"build":Et=it*1.1,kn=2,Ns=.22;break;default:kn=1.8,Ns=.25}Et=Math.max(Et,R.gender==="male"?1400:1100);const es=Math.round(O*kn),As=Math.round(Et*Ns/9),ei=Math.max(0,Math.round((Et-es*4-As*9)/4));B({calories:Math.round(Et),protein:es,carbs:ei,fats:As,bmr:Math.round(te),neat:Math.round(Ke),exerciseAdd:Ye[R.trainingFrequency],tdee:Math.round(it)})},Pe=async()=>{if(K)try{const O={clientId:t.id,calories:K.calories,protein:K.protein,carbs:K.carbs,fats:K.fats,goal:R.goal,updatedAt:Pt.now()};await _s(He(me,"nutritionTargets",t.id),O),b(O),y("dashboard"),bt("Macro targets saved!","success")}catch(O){console.error("Error saving targets:",O),bt("Failed to save targets. Please try again.","error")}},Dt=()=>{const O=R.weight&&parseFloat(R.weight)>0,q=R.age&&parseInt(R.age)>0,se=R.heightUnit==="cm"?R.height&&parseFloat(R.height)>0:R.heightFeet&&parseFloat(R.heightFeet)>0||R.heightInches&&parseFloat(R.heightInches)>0;return O&&q&&se},yt="nut_favourite_foods",at=()=>{try{return JSON.parse(localStorage.getItem(yt)||"[]")}catch{return[]}};w.useEffect(()=>{if(!t?.id)return;(async()=>{try{const q=await xs(He(me,"favouriteFoods",t.id));if(q.exists()){const se=q.data().items||[];localStorage.setItem(yt,JSON.stringify(se)),un(te=>te+1)}else{const se=at();se.length>0&&await _s(He(me,"favouriteFoods",t.id),{items:se,updatedAt:Pt.now()})}}catch(q){console.error("Error loading favourites:",q)}})()},[t?.id]);const oe=O=>at().some(q=>q.name.toLowerCase()===(O||"").toLowerCase()),Ae=O=>{const q=at(),se=q.findIndex(te=>te.name.toLowerCase()===O.name.toLowerCase());se>=0?q.splice(se,1):q.unshift({name:O.name,protein:O.protein,carbs:O.carbs,fats:O.fats,calories:O.calories,serving:O.serving,per100g:O.per100g||null,servingUnit:O.servingUnit||"g",portion:O.portion||null}),localStorage.setItem(yt,JSON.stringify(q)),t?.id&&_s(He(me,"favouriteFoods",t.id),{items:q,updatedAt:Pt.now()}).catch(te=>console.error("Error saving favourites:",te)),un(te=>te+1)},Xe=O=>{const q=[...Z.entries,{...O,meal:Te,id:Date.now(),addedAt:new Date().toISOString()}],se={...Z,entries:q};ge(se),At(se),le(null),kt(null),gt("100"),ut(0),en("weight"),Vt({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),bt("Food added!","success")},pt=O=>{const q=Z.entries.filter(te=>te.id!==O),se={...Z,entries:q};ge(se),At(se)},ot=async O=>{if(!(!t?.id||O===Y)){J(!0);try{const q=await xs(He(me,"nutritionLogs",`${t.id}_${O}`));if(!q.exists()||!q.data().entries?.length){bt("No food logged on that day","error");return}const se=q.data().entries.map(Ke=>({...Ke,id:Date.now()+Math.random(),addedAt:new Date().toISOString()})),te=[...Z.entries,...se],$e={...Z,entries:te};ge($e),At($e),D(!1),bt(`Copied ${se.length} items from ${Re(O)}`,"success")}catch(q){console.error("Error copying day:",q),bt("Failed to copy day","error")}finally{J(!1)}}},Gt=w.useRef(null),bn=w.useRef([]),Ht=3,on=5,Cn=async()=>{Se(!0);const O=document.querySelector("#barcode-reader");if(!O){Se(!1),bt("Scanner container not found.","error");return}if(!Gt.current)try{const se=await Ys(()=>import("./quagga.min-BbicSfvA.js").then(te=>te.q),[]);Gt.current=se.default}catch(se){console.error("Failed to load barcode scanner:",se),Se(!1),bt("Could not load scanner.","error");return}const q=Gt.current;q.init({inputStream:{type:"LiveStream",target:O,constraints:{facingMode:"environment",width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080}}},locator:{patchSize:"medium",halfSample:!0},numOfWorkers:navigator.hardwareConcurrency||2,decoder:{readers:["ean_reader","ean_8_reader","upc_reader","upc_e_reader","code_128_reader","code_39_reader"]},locate:!0},se=>{if(se){console.error("Quagga init error:",se),Se(!1),bt("Could not access camera. Check permissions.","error");return}q.start(),Rn.current=!0}),bn.current=[],q.onDetected(se=>{const te=se.codeResult.decodedCodes?.filter(Ke=>Ke.error!==void 0)?.map(Ke=>Ke.error)||[];if((te.length>0?te.reduce((Ke,Ye)=>Ke+Ye,0)/te.length:1)<.15){const Ke=se.codeResult.code,Ye=bn.current;Ye.push(Ke),Ye.length>on&&Ye.shift(),Ye.filter(Et=>Et===Ke).length>=Ht&&(q.offDetected(),bn.current=[],Oe(Ke))}})},On=()=>{const O=Gt.current;Rn.current&&O&&(O.stop(),O.offDetected(),Rn.current=!1),Se(!1)},Nn=/\b(milk|semi.skimmed|skimmed|whole milk|oat milk|almond milk|soy milk|juice|smoothie|water|squash|cordial|cola|pepsi|fanta|lemonade|soda|beer|wine|cider|lager|spirit|whisky|vodka|rum|gin|brandy|cream|yoghurt drink|milkshake|coffee|tea|broth|stock|soup|sauce|ketchup|vinegar|oil|syrup|honey|custard|coconut water|kombucha|energy drink|protein shake)\b/i,an=O=>/ml|cl|\dl(?!b)|litre|liter|fl\s?oz/i.test((O||"").replace(/\s/g,"")),as=O=>{if(!O)return{value:100,unit:"g"};const q=O.toLowerCase().replace(/\s/g,""),se=q.match(/([\d.]+)/),te=se?parseFloat(se[1]):100;return an(O)?/cl/.test(q)?{value:te*10,unit:"ml"}:/(?:^|\d)l(?!i)/.test(q)&&!/ml/.test(q)?{value:te*1e3,unit:"ml"}:{value:te,unit:"ml"}:{value:te,unit:"g"}},br=O=>{if(an(O.serving_size)||an(O.quantity))return"ml";const q=O.product_name||O.product_name_en||"";return Nn.test(q)?"ml":"g"},ya=[{pattern:/\b(toast|bread|loaf|brioche|bagel|pitta|wrap|tortilla|crumpet|muffin|waffle|pancake)\b/i,label:"slice",weight:36},{pattern:/\begg\b/i,label:"egg",weight:60},{pattern:/\b(biscuit|cookie|digestive|hobnob|rich tea|oreo)\b/i,label:"biscuit",weight:13},{pattern:/\b(sausage|banger)\b/i,label:"sausage",weight:57},{pattern:/\b(rasher|bacon)\b/i,label:"rasher",weight:25},{pattern:/\b(rice cake)\b/i,label:"cake",weight:9},{pattern:/\b(cracker|ryvita)\b/i,label:"cracker",weight:10}],gi=(O,q)=>{const se=O||"",te=se.match(/\((\d+\.?\d*)\s*g\)/i),$e=se.match(/(?:^|per\s+)(\d*\s*[a-z][a-z\s]*?)(?:\s*\(|\s*-\s*|\s*$)/i);if(te&&$e){const it=parseFloat(te[1]);let Et=$e[1].replace(/^\d+\s*/,"").trim();if(Et&&it>0)return{label:Et,weight:it}}const Ke=se.match(/(\d+\.?\d*)\s*g\s*[\/=]\s*(\d*\s*[a-z][a-z\s]*)/i);if(Ke){const it=parseFloat(Ke[1]);let Et=Ke[2].replace(/^\d+\s*/,"").trim();if(Et&&it>0)return{label:Et,weight:it}}const Ye=q||"";for(const{pattern:it,label:Et,weight:kn}of ya)if(it.test(Ye))return{label:Et,weight:kn};return null},Lr=O=>{const q=O.nutriments||{},se=br(O),te=as(O.serving_size),$e=se==="ml"?te.unit==="ml"?te.value:100:te.value,Ke=O.product_name||O.product_name_en||"Unknown Product",Ye=gi(O.serving_size,Ke);return{name:Ke,brand:O.brands||"",image:O.image_small_url||O.image_url||null,servingSize:O.serving_size||"100g",servingValue:$e,servingUnit:se,portion:Ye,protein:Math.round(q.proteins_100g||q.proteins||0),carbs:Math.round(q.carbohydrates_100g||q.carbohydrates||0),fats:Math.round(q.fat_100g||q.fat||0),calories:Math.round(q["energy-kcal_100g"]||q["energy-kcal"]||(q.energy_100g?q.energy_100g/4.184:0)),per100g:!0}},js=async O=>{sn(!0);try{const q=`https://world.openfoodfacts.org/api/v2/product/${O}?fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,se=await fetch(q);if(!se.ok)throw new Error(`HTTP ${se.status}`);const te=await se.json();if(te.status==="success"||te.status===1||te.product){const $e=Lr(te.product);$e.calories===0&&$e.protein===0&&$e.carbs===0?bt("Product found but no nutrition data available.","error"):(kt($e),$e.portion?(ut(1),gt(String($e.portion.weight)),en("portion")):(ut(0),gt(String($e.servingValue||100)),en("weight")),Ge(""))}else bt("Product not found. Try search or manual entry.","error")}catch(q){console.error("Barcode lookup error:",q),bt("Failed to look up product. Check your connection.","error")}sn(!1)},Es=(O,q,se)=>{const te=O.toLowerCase().trim(),$e=q.toLowerCase().trim(),Ke=se.toLowerCase().trim();let Ye=0;return(te===Ke||te===Ke+"s"||te+"s"===Ke)&&(Ye+=100),(te.endsWith(" "+Ke)||te.endsWith(" "+Ke+"s"))&&(Ye+=40),(te.startsWith(Ke+" ")||te.startsWith(Ke+"s "))&&(Ye+=15),Ke.split(/\s+/).some(Et=>$e===Et||$e.startsWith(Et))&&(Ye+=30),Ye+=Math.max(0,30-te.length),Ye},Ts=async()=>{if(!Tt.trim())return;Ln.current&&Ln.current.abort();const O=new AbortController;Ln.current=O;const q=Tt.trim().toLowerCase(),se=q.split(/\s+/).filter(Boolean);if(ep.has(q)){Mt(ep.get(q));return}Bt(!0);try{const $e=`https://world.openfoodfacts.org/cgi/search.pl?search_terms=${encodeURIComponent(Tt.trim())}&search_simple=1&action=process&json=1&page_size=10&lc=en&sort_by=unique_scans_n&fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,Ke=await fetch($e,{signal:O.signal});if(!Ke.ok)throw new Error(`HTTP ${Ke.status}`);const it=((await Ke.json()).products||[]).map(Et=>Lr(Et)).filter(Et=>Et.name!=="Unknown Product"&&(Et.calories>0||Et.protein>0)).filter(Et=>{const kn=(Et.name+" "+Et.brand).toLowerCase();return se.every(Ns=>kn.includes(Ns))}).sort((Et,kn)=>Es(kn.name,kn.brand,q)-Es(Et.name,Et.brand,q)).slice(0,10);ep.set(q,it),Mt(it),it.length===0&&bt("No results found. Try a different search.","info")}catch(te){if(te.name==="AbortError")return;console.error("Search error:",te),bt("Search failed. Check your connection.","error")}Bt(!1)};w.useEffect(()=>{if(tn.current&&clearTimeout(tn.current),!(!Tt.trim()||U!=="search"||ue))return tn.current=setTimeout(()=>{Ts()},700),()=>clearTimeout(tn.current)},[Tt]);const os=l,In={"ring-protein":os?"#2dd4bf":"#14b8a6","ring-carbs":os?"#fbbf24":"#f59e0b","ring-fats":os?"#a78bfa":"#8b5cf6","ring-cals":"var(--color-primary)"},Xn=80,pn=2*Math.PI*Xn,Jn=(O,q,se,te,$e)=>{const Ke=te>0?Math.min(100,Math.round(se/te*100)):0,Ye=pn-Ke/100*pn,it=In[$e]||"#14b8a6";return a.jsxs("div",{className:"nut-ring-wrap",children:[a.jsxs("svg",{className:"nut-ring-svg",viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"nut-arc-track",cx:"100",cy:"100",r:Xn}),a.jsx("circle",{className:"nut-arc-fill",cx:"100",cy:"100",r:Xn,style:{stroke:it},strokeDasharray:pn,strokeDashoffset:Ye})]}),a.jsxs("div",{className:"nut-ring-center",children:[a.jsx("span",{className:"nut-ring-value",style:{color:it},children:Math.round(se)}),a.jsxs("span",{className:"nut-ring-target",children:["/ ",te,O==="Calories"?"":"g"]}),a.jsx("span",{className:"nut-ring-label",style:{color:it},children:q})]}),a.jsxs("span",{className:"nut-ring-pct",style:{color:it},children:[Ke,"%"]})]})};if(w.useEffect(()=>{if(!ve)return;const O=setTimeout(()=>{const q=ve;On(),Oe(null),js(q)},1500);return()=>clearTimeout(O)},[ve]),w.useEffect(()=>()=>{const O=Gt.current;if(Rn.current&&O){try{O.stop(),O.offDetected()}catch{}Rn.current=!1}},[]),i||g==="loading")return a.jsxs("div",{className:"nut-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsx("div",{className:"nut-loading-inline",children:a.jsx("div",{className:"cb-loading-spinner"})})]});if(g==="setup")return a.jsxs("div",{className:"nut-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"nut-main",children:[a.jsxs("div",{className:"nut-setup-intro",children:[a.jsx("h2",{children:"Set Your Daily Targets"}),a.jsx("p",{children:"Calculate your personalised macros based on your body and goals."})]}),a.jsxs("div",{className:"nut-calc-form",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Gender"}),a.jsxs("div",{className:"nut-toggle-group",children:[a.jsx("button",{className:R.gender==="male"?"active":"",onClick:()=>{H(O=>({...O,gender:"male"})),B(null)},children:"Male"}),a.jsx("button",{className:R.gender==="female"?"active":"",onClick:()=>{H(O=>({...O,gender:"female"})),B(null)},children:"Female"})]})]}),a.jsxs("div",{className:"nut-form-row",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Age"}),a.jsx("input",{type:"number",value:R.age,onChange:O=>{H(q=>({...q,age:O.target.value})),B(null)},placeholder:"Years",min:"15",max:"100"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Weight"}),a.jsxs("div",{className:"nut-input-unit",children:[a.jsx("input",{type:"number",value:R.weight,onChange:O=>{H(q=>({...q,weight:O.target.value})),B(null)},placeholder:R.weightUnit,min:"30",max:"300"}),a.jsxs("div",{className:"nut-unit-toggle",children:[a.jsx("button",{className:R.weightUnit==="kg"?"active":"",onClick:()=>{H(O=>({...O,weightUnit:"kg"})),B(null)},children:"kg"}),a.jsx("button",{className:R.weightUnit==="lbs"?"active":"",onClick:()=>{H(O=>({...O,weightUnit:"lbs"})),B(null)},children:"lbs"})]})]})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Height"}),a.jsxs("div",{className:"nut-input-unit",children:[R.heightUnit==="cm"?a.jsx("input",{type:"number",value:R.height,onChange:O=>{H(q=>({...q,height:O.target.value})),B(null)},placeholder:"cm",min:"100",max:"250"}):a.jsxs("div",{className:"nut-height-imperial",children:[a.jsx("input",{type:"number",value:R.heightFeet,onChange:O=>{H(q=>({...q,heightFeet:O.target.value})),B(null)},placeholder:"ft",min:"4",max:"7"}),a.jsx("input",{type:"number",value:R.heightInches,onChange:O=>{H(q=>({...q,heightInches:O.target.value})),B(null)},placeholder:"in",min:"0",max:"11"})]}),a.jsxs("div",{className:"nut-unit-toggle",children:[a.jsx("button",{className:R.heightUnit==="cm"?"active":"",onClick:()=>{H(O=>({...O,heightUnit:"cm"})),B(null)},children:"cm"}),a.jsx("button",{className:R.heightUnit==="ft"?"active":"",onClick:()=>{H(O=>({...O,heightUnit:"ft"})),B(null)},children:"ft/in"})]})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Daily Activity (outside of training)"}),a.jsxs("select",{value:R.dailyActivity,onChange:O=>{H(q=>({...q,dailyActivity:O.target.value})),B(null)},children:[a.jsx("option",{value:"sedentary",children:"Sedentary  desk job, under 5k steps"}),a.jsx("option",{value:"light",children:"Lightly Active  office + walking, 5-8k steps"}),a.jsx("option",{value:"moderate",children:"Moderately Active  on feet often, 8-12k steps"}),a.jsx("option",{value:"active",children:"Very Active  physical job, 12k+ steps"})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Training Sessions per Week"}),a.jsxs("select",{value:R.trainingFrequency,onChange:O=>{H(q=>({...q,trainingFrequency:O.target.value})),B(null)},children:[a.jsx("option",{value:"low",children:"1-2 sessions"}),a.jsx("option",{value:"moderate",children:"3-4 sessions"}),a.jsx("option",{value:"high",children:"5-6 sessions"}),a.jsx("option",{value:"daily",children:"7+ sessions"})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Fitness Goal"}),a.jsxs("div",{className:"nut-goal-options",children:[a.jsxs("button",{className:R.goal==="lose"?"active":"",onClick:()=>{H(O=>({...O,goal:"lose"})),B(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"-"}),a.jsx("span",{children:"Lose Weight"})]}),a.jsxs("button",{className:R.goal==="maintain"?"active":"",onClick:()=>{H(O=>({...O,goal:"maintain"})),B(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"="}),a.jsx("span",{children:"Maintain"})]}),a.jsxs("button",{className:R.goal==="build"?"active":"",onClick:()=>{H(O=>({...O,goal:"build"})),B(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"+"}),a.jsx("span",{children:"Build Muscle"})]})]})]}),R.goal==="lose"&&a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Deficit Level"}),a.jsxs("div",{className:"nut-deficit-options",children:[a.jsxs("button",{className:R.deficitLevel==="light"?"active":"",onClick:()=>{H(O=>({...O,deficitLevel:"light"})),B(null)},children:[a.jsx("strong",{children:"Mild"}),a.jsx("span",{children:"15% below TDEE"})]}),a.jsxs("button",{className:R.deficitLevel==="moderate"?"active":"",onClick:()=>{H(O=>({...O,deficitLevel:"moderate"})),B(null)},children:[a.jsx("strong",{children:"Moderate"}),a.jsx("span",{children:"20% below TDEE"})]}),a.jsxs("button",{className:R.deficitLevel==="harsh"?"active":"",onClick:()=>{H(O=>({...O,deficitLevel:"harsh"})),B(null)},children:[a.jsx("strong",{children:"Aggressive"}),a.jsx("span",{children:"25% below TDEE"})]})]})]}),a.jsx("button",{className:"nut-calc-btn",onClick:qe,disabled:!Dt(),children:"Calculate Macros"})]}),K&&a.jsxs("div",{className:"nut-calc-results",children:[a.jsx("h3",{children:"Your Daily Targets"}),a.jsxs("div",{className:"nut-calc-rings",children:[Jn("Protein","Protein",K.protein,K.protein,"ring-protein"),Jn("Carbs","Carbs",K.carbs,K.carbs,"ring-carbs"),Jn("Fats","Fats",K.fats,K.fats,"ring-fats"),Jn("Calories","Calories",K.calories,K.calories,"ring-cals")]}),a.jsxs("div",{className:"nut-calc-info",children:[a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"BMR (body at rest)"}),a.jsxs("span",{children:[K.bmr," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"+ Daily activity (NEAT)"}),a.jsxs("span",{children:[K.neat," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"+ Training sessions"}),a.jsxs("span",{children:["+",K.exerciseAdd," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",style:{fontWeight:600},children:[a.jsx("span",{children:"TDEE (total burn)"}),a.jsxs("span",{children:[K.tdee," cal"]})]})]}),a.jsx("button",{className:"nut-save-targets-btn",onClick:Pe,children:"Set as My Daily Targets"})]})]}),Qn&&a.jsx("div",{className:`toast-notification ${Qn.type}`,children:Qn.message})]});const Jr=O=>{const q=new Date(O+"T12:00:00"),se=q.getDay(),te=new Date(q);te.setDate(q.getDate()-(se+6)%7);const $e=[];for(let Ke=0;Ke<7;Ke++){const Ye=new Date(te);Ye.setDate(te.getDate()+Ke),$e.push(Ye.toISOString().split("T")[0])}return $e},Ds=["M","T","W","T","F","S","S"],Zn=(O,q="search")=>{Ue(O),q==="scan"?(le("scan"),kt(null)):q==="manual"?(le("manual"),Vt({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""})):q==="favourites"?le("favourites"):(le("search"),Mt([]),_n(""))},fs=Jr(Y),Xs=new Date(Y+"T12:00:00"),Zr=`${De[Xs.getMonth()]} ${Xs.getFullYear()}`;return a.jsx(nl,{children:a.jsxs("div",{className:"nut-page",children:[a.jsxs("div",{className:"nut-dark-zone",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:()=>{y("setup"),B(null)},"aria-label":"Recalculate macros",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]})]})}),a.jsxs("div",{className:"nut-dark-content",children:[a.jsxs("div",{className:"nut-week-strip anim-fade-up",children:[a.jsxs("div",{className:"nut-week-header",children:[a.jsx("button",{className:"nut-week-arrow",onClick:()=>{const O=new Date(Y+"T12:00:00");O.setDate(O.getDate()-7);const q=O.toISOString().split("T")[0];Q(q)},"aria-label":"Previous week",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsx("button",{className:"nut-week-month-label",onClick:()=>{T(!I),V({year:Xs.getFullYear(),month:Xs.getMonth()})},children:Zr}),a.jsx("button",{className:"nut-week-arrow",onClick:()=>{const O=new Date(Y+"T12:00:00");O.setDate(O.getDate()+7);const q=O.toISOString().split("T")[0];q<=$r()&&Q(q)},"aria-label":"Next week",disabled:fs[6]>=$r(),children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-week-days",children:fs.map((O,q)=>{const se=new Date(O+"T12:00:00").getDate(),te=O===Y,$e=O>$r(),Ke=O===$r();return a.jsxs("button",{className:`nut-week-day${te?" selected":""}${Ke?" today":""}${$e?" future":""}`,disabled:$e,onClick:()=>Q(O),children:[a.jsx("span",{className:"nut-week-day-letter",children:Ds[q]}),a.jsx("span",{className:"nut-week-day-num",children:se})]},O)})})]}),I&&a.jsxs("div",{className:"nut-calendar nut-calendar-dark",children:[a.jsxs("div",{className:"nut-cal-header",children:[a.jsx("button",{onClick:()=>V(O=>{let q=O.month-1,se=O.year;return q<0&&(q=11,se--),{year:se,month:q}}),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsxs("span",{children:[De[L.month]," ",L.year]}),a.jsx("button",{onClick:()=>V(O=>{let q=O.month+1,se=O.year;return q>11&&(q=0,se++),{year:se,month:q}}),disabled:L.year===new Date().getFullYear()&&L.month>=new Date().getMonth(),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-cal-days-header",children:Le.map(O=>a.jsx("span",{children:O},O))}),a.jsxs("div",{className:"nut-cal-grid",children:[[...Array(ae(L.year,L.month))].map((O,q)=>a.jsx("span",{},`e${q}`)),[...Array(C(L.year,L.month))].map((O,q)=>{const se=q+1,te=`${L.year}-${String(L.month+1).padStart(2,"0")}-${String(se).padStart(2,"0")}`,$e=te>$r(),Ke=te===Y,Ye=te===$r();return a.jsx("button",{className:`nut-cal-day${Ke?" selected":""}${Ye?" today":""}${$e?" future":""}`,disabled:$e,onClick:()=>{Q(te),T(!1)},children:se},se)})]})]}),a.jsxs("div",{className:"nut-rings-row anim-fade-up-d2",children:[Jn("Protein","Protein",xe.protein,p.protein,"ring-protein"),Jn("Carbs","Carbs",xe.carbs,p.carbs,"ring-carbs"),Jn("Fats","Fats",xe.fats,p.fats,"ring-fats"),Jn("Calories","kCal",xe.calories,p.calories,"ring-cals")]})]})]}),a.jsx("div",{className:"nut-light-zone anim-fade-up-d4",children:a.jsxs("div",{className:"nut-light-content",children:[ee&&a.jsx("div",{className:"nut-quick-row",children:a.jsxs("button",{className:"nut-copy-day-btn",onClick:()=>{D(!0),Me({year:new Date().getFullYear(),month:new Date().getMonth()})},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",width:"18",height:"18",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),a.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),a.jsx("span",{children:"Copy day"})]})}),a.jsx("div",{className:"nut-log-section",children:a.jsx("div",{className:"nut-meals-list",children:Gw.map(O=>{const q=Z.entries.filter(te=>(te.meal||"snacks")===O.key),se=q.reduce((te,$e)=>({protein:te.protein+($e.protein||0),carbs:te.carbs+($e.carbs||0),fats:te.fats+($e.fats||0),calories:te.calories+($e.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});return a.jsxs("div",{className:"nut-meal-card",children:[a.jsxs("div",{className:"nut-meal-card-header",children:[a.jsx("span",{className:`nut-meal-card-icon nut-meal-icon-${O.key}`,children:A3[O.key]}),a.jsx("span",{className:"nut-meal-card-title",children:O.label}),q.length>0&&a.jsxs("span",{className:"nut-meal-card-cal",children:[se.calories," cal"]}),ee&&a.jsx("button",{className:"nut-meal-add-btn",onClick:()=>ze(Ne===O.key?null:O.key),"aria-label":`Add to ${O.label}`,children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]}),q.length>0&&a.jsxs("div",{className:"nut-meal-bars",children:[a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-p",children:"P"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-protein",style:{width:`${Math.min(100,p.protein>0?se.protein/p.protein*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[se.protein,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-c",children:"C"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-carbs",style:{width:`${Math.min(100,p.carbs>0?se.carbs/p.carbs*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[se.carbs,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-f",children:"F"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-fats",style:{width:`${Math.min(100,p.fats>0?se.fats/p.fats*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[se.fats,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-cal",children:"K"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-cals",style:{width:`${Math.min(100,p.calories>0?se.calories/p.calories*100:0)}%`}})}),a.jsx("span",{className:"nut-meal-bar-val",children:se.calories})]})]}),q.length>0&&a.jsx("div",{className:"nut-log-list",children:q.map(te=>a.jsxs("div",{className:"nut-log-item",children:[a.jsx("button",{className:`nut-fav-star log${oe(te.name)?" active":""}`,onClick:()=>Ae(te),"aria-label":oe(te.name)?"Remove from favourites":"Add to favourites",children:a.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:oe(te.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("div",{className:"nut-log-item-info",children:[a.jsx("span",{className:"nut-log-item-name",children:te.name}),te.serving&&a.jsx("span",{className:"nut-log-item-serving",children:te.serving})]}),a.jsxs("div",{className:"nut-log-item-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[te.protein,"p"]}),a.jsxs("span",{className:"nut-macro-c",children:[te.carbs,"c"]}),a.jsxs("span",{className:"nut-macro-f",children:[te.fats,"f"]}),a.jsx("span",{className:"nut-macro-cal",children:te.calories})]}),ee&&a.jsx("button",{className:"nut-log-delete",onClick:()=>pt(te.id),"aria-label":"Remove",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},te.id))}),q.length===0&&a.jsx("div",{className:"nut-meal-empty",children:a.jsx("p",{children:ee?"Tap + to add food":"No entries"})})]},O.key)})})})]})}),Ne&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"nut-add-picker-backdrop",onClick:()=>ze(null)}),a.jsxs("div",{className:"nut-add-picker",children:[a.jsx("div",{className:"nut-add-picker-handle"}),a.jsxs("h3",{className:"nut-add-picker-title",children:["Add to ",Gw.find(O=>O.key===Ne)?.label]}),a.jsxs("div",{className:"nut-add-picker-options",children:[a.jsxs("button",{onClick:()=>{const O=Ne;ze(null),Zn(O,"scan")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),a.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),a.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),a.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),a.jsx("span",{children:"Scan Barcode"})]}),a.jsxs("button",{onClick:()=>{const O=Ne;ze(null),Zn(O,"search")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("span",{children:"Search Food"})]}),a.jsxs("button",{onClick:()=>{const O=Ne;ze(null),Zn(O,"manual")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),a.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),a.jsx("span",{children:"Manual Entry"})]}),a.jsxs("button",{onClick:()=>{const O=Ne;ze(null),Zn(O,"favourites")},children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),a.jsx("span",{children:"Favourites"})]})]})]})]}),P&&a.jsx("div",{className:"nut-modal-overlay",onClick:()=>D(!1),children:a.jsxs("div",{className:"nut-copy-from-popup",onClick:O=>O.stopPropagation(),children:[a.jsxs("div",{className:"nut-copy-from-header",children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",width:"20",height:"20",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),a.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),a.jsx("span",{children:"Copy from..."}),a.jsx("button",{className:"nut-modal-close",onClick:()=>D(!1),children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),a.jsx("p",{className:"nut-copy-from-hint",children:"Pick a day to copy its food log into today"}),a.jsxs("div",{className:"nut-cal-header",children:[a.jsx("button",{onClick:()=>Me(O=>{let q=O.month-1,se=O.year;return q<0&&(q=11,se--),{year:se,month:q}}),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsxs("span",{children:[De[M.month]," ",M.year]}),a.jsx("button",{onClick:()=>Me(O=>{let q=O.month+1,se=O.year;return q>11&&(q=0,se++),{year:se,month:q}}),disabled:M.year===new Date().getFullYear()&&M.month>=new Date().getMonth(),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-cal-days-header",children:Le.map(O=>a.jsx("span",{children:O},O))}),a.jsxs("div",{className:"nut-cal-grid",children:[[...Array(ae(M.year,M.month))].map((O,q)=>a.jsx("span",{},`e${q}`)),[...Array(C(M.year,M.month))].map((O,q)=>{const se=q+1,te=`${M.year}-${String(M.month+1).padStart(2,"0")}-${String(se).padStart(2,"0")}`,$e=te>$r(),Ke=te===Y,Ye=te===$r(),it=$e||Ke;return a.jsx("button",{className:`nut-cal-day${Ke?" selected":""}${Ye?" today":""}${$e?" future":""}`,disabled:it,onClick:()=>ot(te),children:se},se)})]}),st&&a.jsxs("div",{className:"nut-copy-from-loading",children:[a.jsx("div",{className:"wk-loading-spinner"}),a.jsx("span",{children:"Copying..."})]})]})}),U&&a.jsx("div",{className:"nut-modal-overlay",onClick:()=>{On(),Oe(null),le(null),kt(null)},children:a.jsxs("div",{className:"nut-modal",onClick:O=>O.stopPropagation(),children:[a.jsxs("div",{className:"nut-modal-header",children:[a.jsx("h3",{children:U==="scan"?"Scan Barcode":U==="search"?"Search Food":U==="favourites"?"Favourites":"Manual Entry"}),a.jsx("button",{className:"nut-modal-close",onClick:()=>{On(),Oe(null),le(null),kt(null)},children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),U==="scan"&&!ue&&a.jsxs("div",{className:"nut-scan-area",children:[a.jsxs("div",{className:"nut-scanner-wrapper",children:[a.jsx("div",{id:"barcode-reader",className:"nut-scanner-view"}),Ce&&!ve&&a.jsx("div",{className:"nut-scan-line"}),ve&&a.jsxs("div",{className:"nut-scan-detected-overlay",children:[a.jsx("svg",{className:"nut-scan-detected-tick",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),a.jsx("p",{className:"nut-scan-detected-label",children:"Barcode found!"}),a.jsx("p",{className:"nut-scan-detected-code",children:ve})]})]}),!Ce&&a.jsxs("button",{className:"nut-scan-start-btn",onClick:Cn,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),a.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),a.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),a.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),"Open Camera"]}),Ce&&!ve&&a.jsx("p",{className:"nut-scan-hint",children:"Align barcode within the frame"}),a.jsx("div",{className:"nut-barcode-divider",children:a.jsx("span",{children:"or enter barcode manually"})}),a.jsxs("div",{className:"nut-barcode-manual",children:[a.jsx("input",{type:"text",inputMode:"numeric",value:Fe,onChange:O=>Ge(O.target.value),onKeyDown:O=>O.key==="Enter"&&Fe.trim()&&js(Fe.trim()),placeholder:"Enter barcode number"}),a.jsx("button",{onClick:()=>Fe.trim()&&js(Fe.trim()),disabled:!Fe.trim()||tt,children:tt?"...":"Look Up"})]})]}),U==="scan"&&ue&&(()=>{const O=ue.servingUnit||"g",q=ue.portion,se=Wt==="portion"&&q?Qe*q.weight:parseFloat(jt)||0,te=se/100,$e=O==="ml"?[100,200,250,500]:[50,100,150,200],Ke=Wt==="portion"&&q?`${Qe} ${q.label}${Qe!==1?"s":""} (${Math.round(se)}${O})`:`${Math.round(se)}${O}`;return a.jsxs("div",{className:"nut-product-result",children:[ue.image&&a.jsx("img",{src:ue.image,alt:ue.name||"Product",className:"nut-product-img",loading:"lazy"}),a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:ue.name}),a.jsx("button",{className:`nut-fav-star confirm${oe(ue.name)?" active":""}`,onClick:()=>Ae({name:ue.name,protein:ue.protein,carbs:ue.carbs,fats:ue.fats,calories:ue.calories,serving:ue.servingSize,per100g:{protein:ue.protein,carbs:ue.carbs,fats:ue.fats,calories:ue.calories},servingUnit:ue.servingUnit||"g",portion:ue.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:oe(ue.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),ue.brand&&a.jsx("p",{className:"nut-product-brand",children:ue.brand}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",O,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[ue.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[ue.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[ue.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[ue.calories," cal"]})]}),q&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:Wt==="portion"?"active":"",onClick:()=>{en("portion"),Qe<1&&ut(1)},children:"Portions"}),a.jsxs("button",{className:Wt==="weight"?"active":"",onClick:()=>{en("weight"),gt(String(Math.round(se)||100))},children:["Custom (",O,")"]})]}),Wt==="portion"&&q?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ut(Math.max(1,Qe-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:Qe}),a.jsxs("span",{className:"nut-stepper-label",children:[q.label,Qe!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(se),O]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ut(Qe+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",O,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:jt,onChange:Ye=>gt(Ye.target.value),onFocus:Ye=>Ye.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:$e.map(Ye=>a.jsxs("button",{className:`nut-quick-btn${jt===String(Ye)?" active":""}`,onClick:()=>gt(String(Ye)),children:[Ye,O]},Ye))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(ue.protein*te),"p / ",Math.round(ue.carbs*te),"c / ",Math.round(ue.fats*te),"f / ",Math.round(ue.calories*te)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>{kt(null),le("scan")},children:"Scan Again"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>Xe({name:ue.name,protein:Math.round(ue.protein*te),carbs:Math.round(ue.carbs*te),fats:Math.round(ue.fats*te),calories:Math.round(ue.calories*te),serving:Ke}),children:"Add"})]})]})})(),U==="search"&&!ue&&a.jsxs("div",{className:"nut-search-area",children:[a.jsxs("div",{className:"nut-search-bar",children:[a.jsx("input",{type:"text",ref:zt,value:Tt,onChange:O=>_n(O.target.value),onKeyDown:O=>{O.key==="Enter"&&(clearTimeout(tn.current),Ts())},onFocus:()=>setTimeout(()=>zt.current?.scrollIntoView({behavior:"smooth",block:"center"}),350),placeholder:"Search food or product...",autoFocus:!0}),a.jsx("button",{onClick:Ts,disabled:ct,children:ct?"...":"Search"})]}),a.jsxs("div",{className:"nut-search-results",children:[gn.map((O,q)=>a.jsxs("button",{className:"nut-search-item",onClick:()=>{kt(O),O.portion?(ut(1),gt(String(O.portion.weight)),en("portion")):(ut(0),gt(String(O.servingValue||100)),en("weight"))},children:[O.image&&a.jsx("img",{src:O.image,alt:O.name||"Product",loading:"lazy"}),a.jsxs("div",{className:"nut-search-item-info",children:[a.jsx("span",{className:"nut-search-item-name",children:O.name}),O.brand&&a.jsx("span",{className:"nut-search-item-brand",children:O.brand}),a.jsxs("span",{className:"nut-search-item-macros",children:[O.calories," cal  ",O.protein,"p  ",O.carbs,"c  ",O.fats,"f per 100",O.servingUnit||"g"]})]})]},q)),gn.length===0&&Tt&&!ct&&a.jsx("p",{className:"nut-search-empty",children:"No results found. Try a different search or use manual entry."})]})]}),U==="search"&&ue&&(()=>{const O=ue.servingUnit||"g",q=ue.portion,se=Wt==="portion"&&q?Qe*q.weight:parseFloat(jt)||0,te=se/100,$e=O==="ml"?[100,200,250,500]:[50,100,150,200],Ke=Wt==="portion"&&q?`${Qe} ${q.label}${Qe!==1?"s":""} (${Math.round(se)}${O})`:`${Math.round(se)}${O}`;return a.jsxs("div",{className:"nut-product-result",children:[ue.image&&a.jsx("img",{src:ue.image,alt:ue.name||"Product",className:"nut-product-img",loading:"lazy"}),a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:ue.name}),a.jsx("button",{className:`nut-fav-star confirm${oe(ue.name)?" active":""}`,onClick:()=>Ae({name:ue.name,protein:ue.protein,carbs:ue.carbs,fats:ue.fats,calories:ue.calories,serving:ue.servingSize,per100g:{protein:ue.protein,carbs:ue.carbs,fats:ue.fats,calories:ue.calories},servingUnit:ue.servingUnit||"g",portion:ue.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:oe(ue.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),ue.brand&&a.jsx("p",{className:"nut-product-brand",children:ue.brand}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",O,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[ue.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[ue.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[ue.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[ue.calories," cal"]})]}),q&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:Wt==="portion"?"active":"",onClick:()=>{en("portion"),Qe<1&&ut(1)},children:"Portions"}),a.jsxs("button",{className:Wt==="weight"?"active":"",onClick:()=>{en("weight"),gt(String(Math.round(se)||100))},children:["Custom (",O,")"]})]}),Wt==="portion"&&q?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ut(Math.max(1,Qe-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:Qe}),a.jsxs("span",{className:"nut-stepper-label",children:[q.label,Qe!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(se),O]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ut(Qe+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",O,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:jt,onChange:Ye=>gt(Ye.target.value),onFocus:Ye=>Ye.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:$e.map(Ye=>a.jsxs("button",{className:`nut-quick-btn${jt===String(Ye)?" active":""}`,onClick:()=>gt(String(Ye)),children:[Ye,O]},Ye))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(ue.protein*te),"p / ",Math.round(ue.carbs*te),"c / ",Math.round(ue.fats*te),"f / ",Math.round(ue.calories*te)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>kt(null),children:"Back to Search"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>Xe({name:ue.name,protein:Math.round(ue.protein*te),carbs:Math.round(ue.carbs*te),fats:Math.round(ue.fats*te),calories:Math.round(ue.calories*te),serving:Ke}),children:"Add"})]})]})})(),U==="manual"&&a.jsxs("div",{className:"nut-manual-form",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Food Name"}),a.jsx("input",{type:"text",value:rt.name,onChange:O=>Vt(q=>({...q,name:O.target.value})),placeholder:"e.g. Chicken Breast",autoFocus:!0})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Serving Size (optional)"}),a.jsx("input",{type:"text",value:rt.serving,onChange:O=>Vt(q=>({...q,serving:O.target.value})),placeholder:"e.g. 150g, 1 cup"})]}),a.jsxs("div",{className:"nut-manual-macros",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Protein (g)"}),a.jsx("input",{type:"number",value:rt.protein,onChange:O=>Vt(q=>({...q,protein:O.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Carbs (g)"}),a.jsx("input",{type:"number",value:rt.carbs,onChange:O=>Vt(q=>({...q,carbs:O.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Fats (g)"}),a.jsx("input",{type:"number",value:rt.fats,onChange:O=>Vt(q=>({...q,fats:O.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Calories"}),a.jsx("input",{type:"number",value:rt.calories,onChange:O=>Vt(q=>({...q,calories:O.target.value})),min:"0"})]})]}),a.jsx("button",{className:"nut-btn-primary",disabled:!rt.name.trim(),onClick:()=>Xe({name:rt.name,protein:parseFloat(rt.protein)||0,carbs:parseFloat(rt.carbs)||0,fats:parseFloat(rt.fats)||0,calories:parseFloat(rt.calories)||0,serving:rt.serving||""}),children:"Add Food"})]}),U==="favourites"&&!ue&&(()=>{const O=at(),q=se=>{if(se.per100g){const te=se.per100g;kt({name:se.name,brand:"",image:null,servingSize:se.serving||"100g",servingValue:100,servingUnit:se.servingUnit||"g",portion:se.portion||null,protein:te.protein,carbs:te.carbs,fats:te.fats,calories:te.calories,per100g:!0}),se.portion?(ut(1),gt(String(se.portion.weight)),en("portion")):(ut(0),gt("100"),en("weight"))}else Xe({name:se.name,protein:se.protein,carbs:se.carbs,fats:se.fats,calories:se.calories,serving:se.serving||""})};return a.jsx("div",{className:"nut-recent-area",children:O.length===0?a.jsx("p",{className:"nut-search-empty",children:"No favourites yet. Tap the star on any food to save it here."}):a.jsx("div",{className:"nut-recent-list",children:O.map((se,te)=>a.jsxs("div",{className:"nut-recent-item-row",children:[a.jsx("button",{className:"nut-fav-star active",onClick:$e=>{$e.stopPropagation(),Ae(se)},children:a.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("button",{className:"nut-recent-item",onClick:()=>q(se),children:[a.jsxs("div",{className:"nut-recent-item-info",children:[a.jsx("span",{className:"nut-recent-item-name",children:se.name}),a.jsx("span",{className:"nut-recent-item-serving",children:se.serving||""})]}),a.jsxs("span",{className:"nut-recent-item-macros",children:[se.calories," cal"]})]})]},te))})})})(),U==="favourites"&&ue&&(()=>{const O=ue.servingUnit||"g",q=ue.portion,se=Wt==="portion"&&q?Qe*q.weight:parseFloat(jt)||0,te=se/100,$e=O==="ml"?[100,200,250,500]:[50,100,150,200],Ke=Wt==="portion"&&q?`${Qe} ${q.label}${Qe!==1?"s":""} (${Math.round(se)}${O})`:`${Math.round(se)}${O}`;return a.jsxs("div",{className:"nut-product-result",children:[a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:ue.name}),a.jsx("button",{className:`nut-fav-star confirm${oe(ue.name)?" active":""}`,onClick:()=>Ae({name:ue.name,protein:ue.protein,carbs:ue.carbs,fats:ue.fats,calories:ue.calories,serving:ue.servingSize,per100g:{protein:ue.protein,carbs:ue.carbs,fats:ue.fats,calories:ue.calories},servingUnit:ue.servingUnit||"g",portion:ue.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:oe(ue.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",O,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[ue.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[ue.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[ue.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[ue.calories," cal"]})]}),q&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:Wt==="portion"?"active":"",onClick:()=>{en("portion"),Qe<1&&ut(1)},children:"Portions"}),a.jsxs("button",{className:Wt==="weight"?"active":"",onClick:()=>{en("weight"),gt(String(Math.round(se)||100))},children:["Custom (",O,")"]})]}),Wt==="portion"&&q?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ut(Math.max(1,Qe-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:Qe}),a.jsxs("span",{className:"nut-stepper-label",children:[q.label,Qe!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(se),O]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ut(Qe+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",O,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:jt,onChange:Ye=>gt(Ye.target.value),onFocus:Ye=>Ye.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:$e.map(Ye=>a.jsxs("button",{className:`nut-quick-btn${jt===String(Ye)?" active":""}`,onClick:()=>gt(String(Ye)),children:[Ye,O]},Ye))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(ue.protein*te),"p / ",Math.round(ue.carbs*te),"c / ",Math.round(ue.fats*te),"f / ",Math.round(ue.calories*te)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>kt(null),children:"Back to Favourites"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>Xe({name:ue.name,protein:Math.round(ue.protein*te),carbs:Math.round(ue.carbs*te),fats:Math.round(ue.fats*te),calories:Math.round(ue.calories*te),serving:Ke}),children:"Add"})]})]})})()]})}),a.jsx(Xr,{active:"nutrition"}),Qn&&a.jsx("div",{className:`toast-notification ${Qn.type}`,children:Qn.message}),a.jsx(Wl,{badge:j,onDismiss:()=>S(null)})]})})}async function M3(s){const{type:e="workout",title:t="Workout Complete!",stats:i=[],badges:l=[],badgeImage:u,badgeDesc:d}=s,g=1080,y=1920,p=document.createElement("canvas");p.width=g,p.height=y;const b=p.getContext("2d"),j="#2a2a28",S="#ffffff",R="#A12F3A",H="#1a1a1a",K="#555555";b.fillStyle=j,b.fillRect(0,0,g,y);const B=Math.round(g*.82),Y=Math.round(y*.75),Q=Math.round((g-B)/2),Z=Math.round((y-Y)/2),ge=28,xe=5;b.save(),b.shadowColor="rgba(0, 0, 0, 0.45)",b.shadowBlur=40,b.shadowOffsetY=10,Kw(b,Q,Z,B,Y,ge),b.fillStyle=S,b.fill(),b.restore(),b.save(),Kw(b,Q,Z,B,Y,ge),b.strokeStyle=R,b.lineWidth=xe,b.stroke(),b.restore();const pe=220,I=50,T=52,L=68,V=10,P=36,D=48,M=30,Me=34,st=46,J=30,Te=28;b.font=`bold ${T}px 'Orbitron', sans-serif`;const Ue=tu(b,t.toUpperCase(),B-100);b.font=`500 ${P}px 'Montserrat', sans-serif`;let Ne=[];e==="badge"&&d?Ne=tu(b,d,B-120):e==="badge"&&l.length>0?Ne=tu(b,l.join("    "),B-120):i.length>0&&(Ne=tu(b,i.map(ct=>`${ct.value} ${ct.label}`).join("    "),B-120));const ze=e==="badge"?"I just earned a badge on Core Buddy ":e==="habits"?"I just completed my daily habits with Core Buddy ":"I just completed a workout using Core Buddy ";b.font=`bold ${Me}px 'Montserrat', sans-serif`;const U=tu(b,ze,B-80);let le=Ue.length*L;Ne.length>0&&(le+=V+Ne.length*D),le+=M+U.length*st,le+=J+Te;const Se=Z+Y-60-le,Oe=Z+40,Fe=Se-I,Ge=g/2,tt=(Oe+Fe)/2,sn=e==="badge"&&u?u:"/Logo.webp";b.save();const Tt=e==="badge"?"rgba(255, 193, 7, 0.15)":"rgba(161, 47, 58, 0.12)",_n=b.createRadialGradient(Ge,tt,pe*.6,Ge,tt,pe*1.5);_n.addColorStop(0,Tt),_n.addColorStop(1,"rgba(0, 0, 0, 0)"),b.fillStyle=_n,b.fillRect(Ge-pe*1.5,tt-pe*1.5,pe*3,pe*3),b.restore(),b.beginPath(),b.arc(Ge,tt,pe+6,0,Math.PI*2),b.fillStyle=S,b.fill();const gn=e==="badge"?"#ffc107":R;b.beginPath(),b.arc(Ge,tt,pe,0,Math.PI*2),b.strokeStyle=gn,b.lineWidth=5,b.stroke();try{const ct=await D3(sn);b.save(),b.beginPath(),b.arc(Ge,tt,pe-6,0,Math.PI*2),b.clip();const Bt=(pe-6)*2;b.drawImage(ct,Ge-pe+6,tt-pe+6,Bt,Bt),b.restore()}catch{b.textAlign="center",b.textBaseline="middle",b.fillStyle=R,b.font="bold 80px 'Orbitron', sans-serif",b.fillText(e==="badge"?"":"MCF",Ge,tt)}let Mt=Se;b.textAlign="center",b.textBaseline="alphabetic",b.fillStyle=H,b.font=`bold ${T}px 'Orbitron', sans-serif`;for(const ct of Ue)b.fillText(ct,g/2,Mt),Mt+=L;if(Ne.length>0){Mt+=V,b.fillStyle=K,b.font=`500 ${P}px 'Montserrat', sans-serif`;for(const ct of Ne)b.fillText(ct,g/2,Mt),Mt+=D}Mt+=M,b.fillStyle=H,b.font=`bold ${Me}px 'Montserrat', sans-serif`;for(const ct of U)b.fillText(ct,g/2,Mt),Mt+=st;return Mt+=J,b.fillStyle=R,b.font=`600 ${Te}px 'Montserrat', sans-serif`,b.fillText("Make It Count with Core Buddy",g/2,Mt),new Promise(ct=>{p.toBlob(Bt=>ct(Bt),"image/png")})}function Kw(s,e,t,i,l,u){s.beginPath(),s.moveTo(e+u,t),s.lineTo(e+i-u,t),s.quadraticCurveTo(e+i,t,e+i,t+u),s.lineTo(e+i,t+l-u),s.quadraticCurveTo(e+i,t+l,e+i-u,t+l),s.lineTo(e+u,t+l),s.quadraticCurveTo(e,t+l,e,t+l-u),s.lineTo(e,t+u),s.quadraticCurveTo(e,t,e+u,t),s.closePath()}function D3(s){return new Promise((e,t)=>{const i=new Image;i.crossOrigin="anonymous",i.onload=()=>e(i),i.onerror=t,i.src=s})}function tu(s,e,t){if(s.measureText(e).width<=t)return[e];const i=e.split(" "),l=[];let u="";for(const d of i){const g=u?`${u} ${d}`:d;s.measureText(g).width>t&&u?(l.push(u),u=d):u=g}return u&&l.push(u),l}function L3(){const s=w.useRef(null),e=w.useCallback(()=>{if(!s.current)try{s.current=new(window.AudioContext||window.webkitAudioContext)}catch{}const u=s.current;return u?.state==="suspended"&&u.resume(),u},[]),t=w.useCallback(()=>{navigator.vibrate&&navigator.vibrate([40,60,30]);const u=e();if(!u)return;const d=u.currentTime,g=u.createBiquadFilter();g.type="lowpass",g.frequency.value=500,g.Q.value=.7,g.connect(u.destination);const y=u.createOscillator(),p=u.createGain();y.type="sine",y.frequency.value=50,p.gain.value=.3,p.gain.setTargetAtTime(0,d+.08,.04),y.connect(p).connect(g),y.start(d),y.stop(d+.2);const b=u.createOscillator(),j=u.createGain();b.type="sine",b.frequency.value=70,j.gain.value=.2,j.gain.setTargetAtTime(0,d+.22,.04),b.connect(j).connect(g),b.start(d+.15),b.stop(d+.35)},[e]),i=w.useCallback(()=>{navigator.vibrate&&navigator.vibrate(30);const u=e();if(!u)return;const d=u.currentTime,g=u.createBiquadFilter();g.type="lowpass",g.frequency.value=500,g.Q.value=.7,g.connect(u.destination);const y=u.createOscillator(),p=u.createGain();y.type="sine",y.frequency.value=55,p.gain.value=.35,p.gain.setTargetAtTime(0,d+.08,.04),y.connect(p).connect(g),y.start(d),y.stop(d+.2)},[e]),l=w.useCallback(()=>{navigator.vibrate&&navigator.vibrate([50,80,100]);const u=e();u&&[0,.12].forEach((d,g)=>{const y=u.createOscillator(),p=u.createGain();y.type="sine",y.frequency.value=g===0?523:784,p.gain.value=.12,p.gain.setTargetAtTime(0,u.currentTime+d+.15,.02),y.connect(p).connect(u.destination),y.start(u.currentTime+d),y.stop(u.currentTime+d+.2)})},[e]);return w.useEffect(()=>()=>{s.current?.close()},[]),{tap:i,tick:t,complete:l}}const O3=2e3,Wp=42,Dl=2*Math.PI*Wp,P3=1200,Yw=["Another one in the bank!","Consistency beats everything.","You showed up  that's what counts.","Stronger every session."];function Gp({title:s,subtitle:e,stats:t,onDone:i,onDismissStart:l,onShareJourney:u,userName:d,buttonLabel:g="Done",holdLabel:y="Hold To Complete Session",shareType:p="workout",hideShare:b=!1}){const[j,S]=w.useState("hold"),[R,H]=w.useState(!1),[K,B]=w.useState(0),[Y,Q]=w.useState(!1),[Z,ge]=w.useState(!1),[xe,pe]=w.useState(null),I=L3(),T=w.useRef(null),L=w.useRef(null),V=w.useRef(null),P=w.useRef(null),D=w.useRef(!1),M=w.useRef(!1),Me=w.useRef(0),st=w.useRef(Yw[Math.floor(Math.random()*Yw.length)]),J=w.useRef([...Array(80)].map((ve,Oe)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#ffffff","#000000"][Oe%3],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:Oe%3}))),Te=w.useCallback(()=>{if(D.current)return;D.current=!0,M.current=!1,Me.current=0,H(!0),B(0),P.current=performance.now(),I.tap(),T.current&&(T.current.style.strokeDashoffset=Dl);const ve=Oe=>{const Fe=Oe-P.current,Ge=Math.min(Fe/O3,1);if(T.current&&(T.current.style.strokeDashoffset=Dl-Ge*Dl),L.current){const tt=8*(1-Ge),sn=1-Ge,Tt=1+Ge*.15;L.current.style.filter=`blur(${tt}px) grayscale(${sn})`,L.current.style.transform=`scale(${Tt})`}B(Ge),Fe-Me.current>=P3&&(Me.current=Fe,I.tick()),Ge<1?V.current=requestAnimationFrame(ve):(D.current=!1,M.current=!0,V.current=null,H(!1),B(1),I.complete(),S("celebrate"))};V.current=requestAnimationFrame(ve)},[I]),Ue=w.useCallback(()=>{D.current&&(D.current=!1,V.current&&(cancelAnimationFrame(V.current),V.current=null),T.current&&(T.current.style.strokeDashoffset=Dl),L.current&&(L.current.style.filter="",L.current.style.transform=""),H(!1),B(0))},[]),Ne=w.useCallback(()=>{Q(!0),l?.(),setTimeout(()=>{i?.()},300)},[i,l]),ze=w.useCallback(()=>{const ve=[s||"Workout Complete!"];return e&&ve.push(e),t?.length&&ve.push(t.map(Oe=>`${Oe.value} ${Oe.label}`).join(" | ")),ve.push("#MindCoreFitness"),ve.join(`
`)},[s,e,t]),U=w.useCallback(async()=>{if(!(Z||!u))try{await u({type:p==="habits"?"habits_summary":"workout_summary",title:s||"Workout Complete!",subtitle:e,stats:t||[],quote:st.current}),ge(!0),pe("Posted to Journey!"),setTimeout(()=>pe(null),2500)}catch(ve){console.error("Journey post failed:",ve),pe(ve?.message||"Failed to post"),setTimeout(()=>pe(null),3500)}},[Z,u,s,e,t]),[le,Ce]=w.useState(!1),Se=w.useCallback(async()=>{Ce(!0);try{const ve=await M3({type:p||"workout",title:s||"Workout Complete!",subtitle:e,stats:t||[],quote:st.current,userName:d}),Oe=ze();if(navigator.share&&navigator.canShare?.({files:[new File([ve],"workout.png",{type:"image/png"})]})){const Fe=new File([ve],"workout.png",{type:"image/png"});await navigator.share({title:"Mind Core Fitness",text:Oe,files:[Fe]})}else navigator.share?await navigator.share({title:"Mind Core Fitness",text:Oe}):(await navigator.clipboard.writeText(Oe),pe("Copied to clipboard!"),setTimeout(()=>pe(null),2500))}catch{try{await navigator.clipboard.writeText(ze()),pe("Copied to clipboard!"),setTimeout(()=>pe(null),2500)}catch{}}finally{Ce(!1)}},[s,e,t,d,ze]);return j==="hold"?a.jsxs("div",{className:"wc-hold-page",children:[a.jsx("div",{className:"wc-hold-glow","aria-hidden":"true"}),a.jsx("p",{className:"wc-hold-label",children:y}),a.jsxs("div",{className:`wc-hold-ring-touch ${R?"wc-holding":""}`,onPointerDown:ve=>{ve.preventDefault(),Te()},onPointerUp:Ue,onPointerLeave:Ue,onPointerCancel:Ue,onClick:ve=>{ve.stopPropagation(),M.current&&(M.current=!1)},role:"button",tabIndex:0,"aria-label":"Press and hold to finish workout",onKeyDown:ve=>{(ve.key==="Enter"||ve.key===" ")&&(ve.preventDefault(),I.complete(),S("celebrate"))},children:[a.jsx("div",{className:"wc-hold-ring-glow","aria-hidden":"true"}),a.jsxs("svg",{className:"wc-hold-ring-svg",viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"wc-hold-ring-track",cx:"50",cy:"50",r:Wp}),a.jsx("circle",{className:"wc-hold-ring-fill",ref:T,cx:"50",cy:"50",r:Wp,style:{strokeDasharray:Dl,strokeDashoffset:Dl}})]}),a.jsx("img",{ref:L,src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-hold-logo",draggable:!1})]})]}):a.jsxs("div",{className:`wc-celeb-overlay ${Y?"wc-celeb-dismissing":""}`,children:[a.jsx("div",{className:"wc-celeb-confetti","aria-hidden":"true",children:J.current.map((ve,Oe)=>a.jsx("span",{className:`wc-celeb-confetti-piece wc-confetti-shape-${ve.shape}`,style:{"--x":`${ve.x}%`,"--delay":`${ve.delay}s`,"--color":ve.color,"--drift":`${ve.drift}px`,"--spin":`${ve.spin}deg`,"--duration":`${ve.duration}s`,width:`${ve.width}px`,height:`${ve.height}px`}},Oe))}),a.jsxs("div",{className:"wc-celeb-content",children:[a.jsx("div",{className:"wc-celeb-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-celeb-logo-img"})}),a.jsx("h2",{className:"wc-celeb-heading",children:s||"Congratulations!"}),e&&a.jsx("p",{className:"wc-celeb-subtext",children:e}),a.jsx("p",{className:"wc-celeb-quote",children:st.current}),t&&t.length>0&&a.jsx("div",{className:"wc-celeb-stats-row",children:t.map((ve,Oe)=>a.jsxs("div",{className:"wc-celeb-stat",children:[a.jsx("span",{className:"wc-celeb-stat-val",children:ve.value}),a.jsx("span",{className:"wc-celeb-stat-label",children:ve.label})]},Oe))}),!b&&a.jsxs("div",{className:"wc-share-row",children:[u&&a.jsxs("button",{className:`wc-share-btn wc-share-journey ${Z?"wc-share-done":""}`,onClick:U,disabled:Z,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 20h9"}),a.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4Z"})]}),Z?"Posted!":"Post to Journey"]}),a.jsxs("button",{className:"wc-share-btn wc-share-external",onClick:Se,disabled:le,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"18",cy:"5",r:"3"}),a.jsx("circle",{cx:"6",cy:"12",r:"3"}),a.jsx("circle",{cx:"18",cy:"19",r:"3"}),a.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),a.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),le?"Generating...":"Share"]})]}),a.jsx("button",{className:"wc-celeb-btn",onClick:Ne,children:g}),xe&&a.jsx("div",{className:"wc-share-toast",children:xe})]})]})}const Qw="/login/assets/randomiser-glq9YJkL.jpg",Xw="/login/assets/programme-card-workout-CnNzTYkz.webp",V3="/login/assets/prog-fullbody-4wk-r6m9HJys.jpg",U3="/login/assets/muscle-group-arms-C9AdZL4-.png",B3="/login/assets/arms-bicep-BUrmT1o-.png",z3="/login/assets/arms-tricep-D9tAnFnS.png",F3="/login/assets/arms-full-arms-BY3TvpJm.png",H3="/login/assets/muscle-group-chest-Cxfuc7XI.png",q3="/login/assets/chest-strength-BR4BAFTH.png",$3="/login/assets/chest-hypertrophy-B8yNrvjB.png",W3="/login/assets/chest-endurance-e-OSWtWO.png",G3="/login/assets/muscle-group-shoulders-DibNtCLF.png",K3="/login/assets/shoulders-strength-CKlZBF5A.png",Y3="/login/assets/shoulders-hypertrophy-BUd76jiS.png",Q3="/login/assets/shoulders-endurance-HuqNG5rD.png",X3="/login/assets/muscle-group-core-CPR-bdRg.png",J3="/login/assets/core-lower-abs-TVcqGMFJ.png",Z3="/login/assets/core-obliques-rotation-Djb7Qlbk.png",e5="/login/assets/core-weighted-core-4Kwh9mTv.png",t5="/login/assets/muscle-group-back-8JPV-YUo.png",n5="/login/assets/back-strength-BmSRxnwo.png",s5="/login/assets/back-hypertrophy-CXHmsnCz.png",r5="/login/assets/back-endurance-C8qJ8l5I.png",i5="/login/assets/muscle-group-legs-B8jcbdov.png",a5="/login/assets/legs-quads-DbnfsebI.png",o5="/login/assets/legs-hamstrings-glutes-BrfsvvzX.png",l5="/login/assets/legs-power-plyo-D2qBXeUR.png",c5=60,tp=5,u5={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},d5={fullbody:"linear-gradient(160deg, rgba(153,49,60,0.15) 0%, rgba(153,49,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",upper:"linear-gradient(160deg, rgba(100,60,140,0.2) 0%, rgba(100,60,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",lower:"linear-gradient(160deg, rgba(40,120,80,0.2) 0%, rgba(40,120,80,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)"},np={arms:"linear-gradient(160deg, rgba(180,60,60,0.2) 0%, rgba(180,60,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",chest:"linear-gradient(160deg, rgba(50,100,160,0.2) 0%, rgba(50,100,160,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",back:"linear-gradient(160deg, rgba(80,130,60,0.2) 0%, rgba(80,130,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",shoulders:"linear-gradient(160deg, rgba(160,100,40,0.2) 0%, rgba(160,100,40,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",legs:"linear-gradient(160deg, rgba(100,50,140,0.2) 0%, rgba(100,50,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)"},sp=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,level:"All Levels",daysPerWeek:3,image:V3},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,level:"Intermediate",daysPerWeek:3},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,level:"Advanced",daysPerWeek:3},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,level:"Beginner",daysPerWeek:3},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,level:"Intermediate",daysPerWeek:3},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,level:"Advanced",daysPerWeek:3},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,level:"Intermediate",daysPerWeek:3},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,level:"Intermediate",daysPerWeek:3}],nu=[{key:"arms",label:"Arms",icon:"M7 5h2v14H7V5zm8 0h2v14h-2V5zm-5 4h4v6h-4V9z",image:U3},{key:"chest",label:"Chest",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15H9v-2h2v2zm4 0h-2v-2h2v2zm3-6c0 1.1-.36 2.12-.97 2.95l-.87-.87C16.7 12.53 17 11.8 17 11c0-2.76-2.24-5-5-5S7 8.24 7 11c0 .8.3 1.53.84 2.08l-.87.87A4.977 4.977 0 0 1 6 11c0-3.31 2.69-6 6-6s6 2.69 6 6z",image:H3},{key:"back",label:"Back",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm4 18H8v-6l-4-4 1.41-1.41L8 11.17V8h8v3.17l2.59-2.58L20 10l-4 4v6z",image:t5},{key:"shoulders",label:"Shoulders",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z",image:G3},{key:"legs",label:"Legs",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z",image:i5},{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z",image:X3}],Jw={chest:[{id:"chest_strength",name:"Chest Strength",desc:"Heavy pressing for max strength",image:q3,level:"Intermediate",overview:"A heavy pressing session designed to build raw chest strength. Focus on controlled negatives and powerful pressing movements.",tips:["Go heavy  pick a weight where the last 2 reps are a real challenge","Control the negative (lowering phase) for 2-3 seconds","Keep your shoulder blades squeezed together throughout all pressing movements","Rest 90-120 seconds between sets to allow full recovery"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Squeeze Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"chest_hypertrophy",name:"Chest Hypertrophy",desc:"Volume training for muscle growth",image:$3,level:"Intermediate",overview:"A high-volume chest session focused on time under tension and muscle growth. Lighter weights, more reps, and slow controlled movements.",tips:["Use moderate weight  you should feel the burn by rep 10","Squeeze your chest at the top of every rep for 1 second","Keep rest periods short at 60-90 seconds to keep the pump going","On press ups, go to failure on the final set"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Press Up",type:"reps",sets:3,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"}]},{id:"chest_endurance",name:"Chest Endurance",desc:"Bodyweight pushing to failure",image:W3,level:"All Levels",overview:"No weights needed. This bodyweight-only session builds chest endurance and muscular stamina through high-rep push up variations.",tips:["Focus on full range of motion  chest to floor on every rep","Keep your core tight and body in a straight line throughout","Scale down to knee press ups if you can't maintain form","Push through the burn  the last 5 reps are where the growth happens"],exercises:[{name:"Press Up",type:"reps",sets:4,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null},{name:"Decline Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Press Up Hold",type:"timed",sets:3,time:30,storagePath:null}]}],back:[{id:"back_strength",name:"Back Strength",desc:"Heavy rows for a thick back",image:n5,level:"Intermediate",overview:"Build a thick, powerful back with heavy rowing movements. This session targets your lats, rhomboids, and traps for overall back development.",tips:["Go heavy on rows  use a weight that challenges you by rep 6-8","Drive your elbows back and squeeze your shoulder blades together at the top","Keep a slight bend in your knees and hinge at the hips for bent over movements","Rest 90-120 seconds between sets for full recovery"],exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"back_hypertrophy",name:"Back Hypertrophy",desc:"Width and thickness volume work",image:s5,level:"Intermediate",overview:"A volume-focused back session combining rows and isolation moves to build width and thickness. Focus on the mind-muscle connection.",tips:["Use moderate weight  feel the stretch and squeeze on every rep","On renegade rows, keep your hips square to the floor and avoid rotating","For reverse flys, use lighter weight and focus on squeezing your rear delts","Keep rest to 60-90 seconds to maintain intensity"],exercises:[{name:"Renegade Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Reverse Fly",type:"weighted",sets:3,reps:15,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null}]},{id:"back_endurance",name:"Back Endurance",desc:"Bodyweight back conditioning",image:r5,level:"All Levels",overview:"A bodyweight session to strengthen your posterior chain and improve posture. Great for back health, mobility, and muscular endurance.",tips:["On superman holds, lift your arms and legs simultaneously and hold tight","Focus on slow, controlled movements  quality over speed","Breathe steadily throughout timed holds  don't hold your breath","Engage your glutes and lower back together on every movement"],exercises:[{name:"Superman Hold",type:"timed",sets:4,time:30,storagePath:"exercises/bodyweight/upper/Superman Hold.mp4"},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:12,storagePath:null},{name:"Reverse Snow Angel",type:"reps",sets:3,reps:12,storagePath:null},{name:"Bird Dog",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Back Extension Hold",type:"timed",sets:3,time:30,storagePath:null}]}],shoulders:[{id:"shoulders_strength",name:"Shoulder Strength",desc:"Heavy pressing for boulder shoulders",image:K3,level:"Intermediate",overview:"A heavy overhead pressing session to build strong, powerful shoulders. Compound movements first, followed by isolation work for all three delt heads.",tips:["Go heavy on presses  pick a weight where you struggle on the last 2 reps","Brace your core and avoid arching your back during overhead movements","Press straight up and control the weight down slowly","Rest 90-120 seconds between pressing sets, 60 seconds for isolation moves"],exercises:[{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"shoulders_hypertrophy",name:"Shoulder Hypertrophy",desc:"Volume and isolation for 3D delts",image:Y3,level:"Intermediate",overview:"A high-volume session targeting all three heads of the deltoid for that 3D capped shoulder look. Moderate weight, high reps, constant tension.",tips:["Use lighter weight than you think  shoulders respond best to high reps","On lateral raises, lead with your elbows and don't swing the weight","Pause at the top of each raise for a 1-second squeeze","Keep rest periods at 60 seconds to maximise the pump"],exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Y-Raise",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"shoulders_endurance",name:"Shoulder Endurance",desc:"Bodyweight and high-rep work",image:Q3,level:"All Levels",overview:"A shoulder endurance session combining bodyweight movements with high-rep dumbbell work. Builds stamina, stability, and shoulder resilience.",tips:["On pike push ups, walk your feet close to your hands to increase the angle","For high-rep lateral raises, use a very light weight and focus on form","Wall walks are advanced  scale to pike push ups if needed","Keep your core braced throughout to protect your lower back"],exercises:[{name:"Pike Push Ups",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/upper/pike push ups.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,reps:20,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Wall Walks",type:"reps",sets:3,reps:6,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null},{name:"Shoulder Tap Hold",type:"timed",sets:3,time:30,storagePath:null}]}],arms:[{id:"arms_bicep",name:"Bicep Focus",desc:"Curl variations for peak biceps",image:B3,level:"All Levels",overview:"An arm session dedicated entirely to biceps. Multiple curl variations target different parts of the bicep for maximum peak and thickness.",tips:["Keep your elbows pinned to your sides  no swinging","Control the negative (lowering) for 2-3 seconds on every rep","Start with your heaviest weight and decrease as you fatigue","Squeeze hard at the top of each curl for a full contraction"],exercises:[{name:"Bicep Curl",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Concentration Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Isometric Bicep Hold",type:"timed",sets:3,time:20,storagePath:null}]},{id:"arms_tricep",name:"Tricep Focus",desc:"Extensions and dips for horseshoe triceps",image:z3,level:"All Levels",overview:"All-out tricep training with extensions, dips, and pressing movements. The triceps make up two-thirds of your arm  this session builds serious size.",tips:["On overhead extensions, keep your elbows close to your head","For skullcrushers, lower the weight slowly to just above your forehead","On dips, lean slightly forward to reduce shoulder strain","Full lockout at the top of every extension for maximum tricep contraction"],exercises:[{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Tricep Dips",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null}]},{id:"arms_full",name:"Full Arms",desc:"Superset biceps and triceps",image:F3,level:"All Levels",overview:"A balanced arm session alternating between biceps and triceps. Superset style keeps the intensity high and maximises the pump.",tips:["Superset each pair  do biceps then immediately hit triceps","Use moderate weight that lets you maintain strict form for all reps","Rest 60 seconds after each superset pair","Focus on the squeeze at the peak contraction of every rep"],exercises:[{name:"Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Wrist Curl",type:"weighted",sets:3,reps:15,storagePath:null}]}],legs:[{id:"legs_quad",name:"Quad Dominant",desc:"Squats and lunges for quad power",image:a5,level:"All Levels",overview:"A quad-focused leg session built around squats and lunges. Heavy compound movements to build strong, powerful quads and overall leg strength.",tips:["On goblet squats, hold the dumbbell close to your chest and sit deep","Keep your knees tracking over your toes  don't let them cave inward","Drive through your heels on all squatting movements","Rest 90-120 seconds between heavy sets, 60 seconds on bodyweight moves"],exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/lower/bulgarian split squats.mp4"},{name:"Squat And Hold",type:"timed",sets:3,time:30,storagePath:"exercises/bodyweight/lower/squat and hold.mp4"}]},{id:"legs_ham_glute",name:"Hamstring & Glute",desc:"Posterior chain focus",image:o5,level:"Intermediate",overview:"Target the back of your legs with deadlift and hip hinge variations. This session builds a strong posterior chain  hamstrings, glutes, and lower back.",tips:["On RDLs, push your hips back and feel the stretch in your hamstrings","Keep a slight bend in your knees throughout hip hinge movements","Squeeze your glutes hard at the top of every rep","For single leg work, start with your weaker side first"],exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/romanian deadlifts.mp4"},{name:"1 Legged RDL",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.mp4"},{name:"Hip Thrusts",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/hip thrusts.mp4"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.mp4"},{name:"Donkey Kicks",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.mp4"}]},{id:"legs_power",name:"Power & Plyo",desc:"Explosive leg training",image:l5,level:"Intermediate",overview:"An explosive leg session combining plyometrics with weighted movements. Build power, speed, and athletic performance.",tips:["On jump squats, land softly with bent knees to absorb the impact","Explode up on every rep  power comes from speed, not just weight","Keep rest periods at 60-90 seconds to maintain intensity","Focus on landing mechanics  knees out, chest up, soft landing"],exercises:[{name:"Jump Squats",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/lower/jump squats.mp4"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Skater Jumps",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/skater jumps.mp4"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.mp4"}]}],core:[{id:"core_lower_abs",name:"Lower Abs Blast",desc:"40s work / 20s rest  3 rounds",image:J3,level:"Intermediate",overview:"An interval-based core burner targeting the lower abdominals. 40 seconds of work followed by 20 seconds of rest  keep the intensity high and your lower back pressed into the floor throughout.",tips:["Press your lower back firmly into the floor on every rep","Exhale hard as you contract your abs  don't hold your breath","If your lower back lifts off the ground, reduce the range of motion","Focus on slow, controlled movements rather than speed"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Leg Raises",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Reverse Crunch To Leg Raise",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Flutter Kicks",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Dead Bug Single Leg Drop",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Hollow Hold Flutter Kicks",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"}]},{id:"core_obliques",name:"Obliques & Rotation",desc:"35s work / 25s rest  3 rounds",image:Z3,level:"Intermediate",overview:"Target the obliques and rotational core muscles with this interval session. 35 seconds of work with 25 seconds rest  every exercise involves twisting, rotating, or side-bracing movements.",tips:["Rotate from your ribcage, not just your arms","Keep your hips as still as possible during twisting exercises","Brace your core before each movement  think about squeezing a belt","On side planks, stack your hips and push the floor away"],interval:!0,rounds:3,work:35,rest:25,exercises:[{name:"Russian Twist",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank Rotation",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Cross Body Mountain Climbers",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Hip Dips Plank",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Bicycle Crunch",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank",storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{id:"core_weighted",name:"Weighted Core",desc:"40s work / 20s rest  3 rounds",image:e5,level:"Advanced",overview:"Add resistance to your core training with dumbbells and kettlebells. 40 seconds of weighted work followed by 20 seconds rest  this session builds serious core strength and stability.",tips:["Start with a moderate weight  form is more important than load","Brace your entire core before picking up the weight each round","Keep movements controlled  no swinging or using momentum","If grip fails before core does, go slightly lighter next time"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Russian Twists Dumbbell",storagePath:"exercises/dumbbells/core/russian twists dumbbell.mp4"},{name:"Kettlebell Russian Twist",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Dumbbell Plank Pull Through",storagePath:null}]}]},rp=[{key:"bodyweight",label:"Bodyweight",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"},{key:"dumbbells",label:"Dumbbells",icon:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"},{key:"kettlebells",label:"Kettlebells",icon:"M12 2C9.24 2 7 4.24 7 7c0 1.1.36 2.12.97 2.95C6.76 11.08 6 12.96 6 15c0 3.87 2.69 7 6 7s6-3.13 6-7c0-2.04-.76-3.92-1.97-5.05.61-.83.97-1.85.97-2.95 0-2.76-2.24-5-5-5zm0 2c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"}],Wr=[{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"},{key:"upper",label:"Upper",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"lower",label:"Lower",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"fullbody",label:"Full Body",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z"},{key:"mix",label:"Mix It Up",icon:"M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm-.83 9.41l-1.42 1.42L17.96 20.54l1.42-1.42-5.71-5.71z"}],ki=[{key:"beginner",label:"Beginner",work:30,rest:30,desc:"30s work / 30s rest"},{key:"intermediate",label:"Intermediate",work:40,rest:20,desc:"40s work / 20s rest"},{key:"advanced",label:"Advanced",work:40,rest:15,desc:"40s work / 15s rest"}],ip=[5,10,15,20,30],yh={core:"#e85d04",upper:"#2196f3",lower:"#4caf50",fullbody:"#9c27b0",mix:"#ff9800"},Zw=["Mix up your focus areas to build balanced strength.","Consistency beats intensity  show up and press play.","Try a new difficulty level to keep your body guessing.","Short on time? A 5-minute blast still counts.","Save your favourite combos so you can replay them anytime.","Your body adapts  switch equipment for fresh stimulus.","Rest days are growth days. Listen to your body.","Challenge yourself: go one level higher this week."];function h5(s){return s.replace(/\b\w/g,e=>e.toUpperCase())}function f5(s){const e=[...s];for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return e}function m5(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Dr(),{isDark:l,toggleTheme:u}=Di(),{isPremium:d,FREE_RANDOMISER_DURATIONS:g,FREE_RANDOMISER_WEEKLY_LIMIT:y}=uc(),p=Qs(),[b,j]=w.useState("randomiser_hub"),[S,R]=w.useState(["bodyweight"]),[H,K]=w.useState("core"),[B,Y]=w.useState("intermediate"),[Q,Z]=w.useState(d?15:5),[ge,xe]=w.useState([]),[pe,I]=w.useState(!1),T=w.useRef(!1),L=w.useRef([]),[V,P]=w.useState([]),[D,M]=w.useState(2),[Me,st]=w.useState(ki[1]),[J,Te]=w.useState(1),[Ue,Ne]=w.useState(0),[ze,U]=w.useState("work"),[le,Ce]=w.useState(0),[Se,ve]=w.useState(!1),[Oe,Fe]=w.useState(0),[Ge,tt]=w.useState(!1),[sn,Tt]=w.useState(!1),[_n,gn]=w.useState(null),Mt=w.useRef(null);w.useRef(null),w.useRef(null);const[ct,Bt]=w.useState(null),rt=w.useCallback((F,k="info")=>{Bt({message:F,type:k}),setTimeout(()=>Bt(null),3e3)},[]),Vt=w.useCallback(async F=>{if(!t)throw new Error("Not signed in");const k=F&&typeof F=="object"&&F.type;await ir(lt(me,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:k?"":F,type:k?F.type:"text",imageURL:null,createdAt:ws(),likeCount:0,commentCount:0,...k?{metadata:{title:F.title||"",subtitle:F.subtitle||"",stats:F.stats||[],quote:F.quote||"",badges:F.badges||[]}}:{}})},[t]),[ue,kt]=w.useState(null),[jt,gt]=w.useState(null),[Qe,ut]=w.useState(0),[Wt,en]=w.useState(0),[Gn,un]=w.useState([]),[Qn,Fn]=w.useState(""),[Rn,Ln]=w.useState(""),[tn,zt]=w.useState(!1),[bt,At]=w.useState(0),[ee,C]=w.useState(!1),[ae,Re]=w.useState({}),De=w.useRef(null),Le=w.useRef(null),[qe,Pe]=w.useState(0),[Dt,yt]=w.useState(0),[at,oe]=w.useState(0),[Ae,Xe]=w.useState(0),[pt,ot]=w.useState(0),[Gt,bn]=w.useState(0),[Ht,on]=w.useState(null),[Cn,On]=w.useState({beginner:0,intermediate:0,advanced:0}),Nn=d?ip:ip.filter(F=>g.includes(F)),an=!d&&qe>=y,[as,br]=w.useState([]),[ya,gi]=w.useState(!1),[Lr,js]=w.useState({}),[Es,Ts]=w.useState(!1),[os,In]=w.useState(!1),[Xn,pn]=w.useState(""),[Jn,Jr]=w.useState(null),[Ds,Zn]=w.useState([]),[fs,Xs]=w.useState({total:0,favouriteFocus:null,streak:0}),[Zr,O]=w.useState(null),[q,se]=w.useState(""),[te,$e]=w.useState(!1);w.useEffect(()=>{!i&&(!s||!e)&&p("/")},[s,e,i,p]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const k=lt(me,"workoutLogs"),N=Xt(k,wt("clientId","==",t.id)),G=(await Ft(N)).docs.map(mt=>mt.data()),de=G.filter(mt=>mt.type!=="programme");Xe(de.length);const ke=de.reduce((mt,Lt)=>mt+(Lt.duration||0),0);ot(ke);const Ee={beginner:0,intermediate:0,advanced:0};de.forEach(mt=>{mt.level&&Ee[mt.level]!==void 0&&Ee[mt.level]++}),On(Ee);const Ve=new Date,Ie=Ve.getDay(),Ze=Ie===0?-6:1-Ie,Ut=new Date(Ve);Ut.setDate(Ve.getDate()+Ze),Ut.setHours(0,0,0,0);const Mn=Ut.getTime(),ft=G.filter(mt=>{const Lt=mt.completedAt;return Lt?(Lt.toDate?Lt.toDate().getTime():new Date(Lt).getTime())>=Mn:!1});Pe(ft.filter(mt=>mt.type!=="programme").length);let dn=0;if(t)try{const mt=await xs(He(me,"clientProgrammes",t.id));if(mt.exists()){const Lt=mt.data(),ls=Lt.templateId;dn=ft.filter(Vn=>Vn.type==="programme"&&Vn.programmeId===ls).length,O(ls);const Pn=sp.find(Vn=>Vn.id===ls);Pn&&se(Pn.name);const Kn=u5[ls];if(Kn){const Vn=Object.keys(Lt.completedSessions||{}).length,Hn=Kn.duration*Kn.daysPerWeek;oe(Hn>0?Math.round(Vn/Hn*100):0)}}else O(null),se(""),oe(0)}catch{}yt(dn);const hn=de.map(mt=>mt.completedAt).filter(Boolean).map(mt=>mt.toDate?mt.toDate().getTime():new Date(mt).getTime()).sort((mt,Lt)=>Lt-mt);if(hn.length===0)bn(0);else{const mt=new Set;hn.forEach(Hn=>{const ur=new Date(Hn),kr=ur.getDay(),wa=kr===0?-6:1-kr,Oi=new Date(ur);Oi.setDate(ur.getDate()+wa),Oi.setHours(0,0,0,0),mt.add(Oi.getTime())});const Lt=[...mt].sort((Hn,ur)=>ur-Hn);let ls=0;const Pn=new Date(Ve),Kn=Ve.getDay()===0?-6:1-Ve.getDay();Pn.setDate(Ve.getDate()+Kn),Pn.setHours(0,0,0,0);let Vn=Pn.getTime();Lt.includes(Vn)||(Vn-=10080*60*1e3);for(let Hn=0;Hn<200&&Lt.includes(Vn);Hn++)ls++,Vn-=10080*60*1e3;bn(ls)}}catch(k){console.error("Error loading workout stats:",k)}finally{$e(!0)}})()},[s,t,b]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const k=Xt(lt(me,"savedWorkouts"),wt("clientId","==",t.id)),$=(await Ft(k)).docs.map(G=>({id:G.id,...G.data()}));$.sort((G,de)=>{const ke=G.savedAt?.toMillis?.()||G.savedAt?.seconds*1e3||0;return(de.savedAt?.toMillis?.()||de.savedAt?.seconds*1e3||0)-ke}),br($)}catch(k){console.error("Error loading saved workouts:",k)}finally{gi(!0)}})()},[s,t]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const k=Xt(lt(me,"workoutLogs"),wt("clientId","==",t.id),qo("completedAt","desc"),$o(20)),G=(await Ft(k)).docs.map(ft=>ft.data()).filter(ft=>ft.type!=="programme"&&ft.type!=="muscle_group");Zn(G.slice(0,3));const de=G.length,ke={};G.forEach(ft=>{ft.focus&&(ke[ft.focus]=(ke[ft.focus]||0)+1)});const Ee=Object.keys(ke).sort((ft,dn)=>ke[dn]-ke[ft])[0]||null;let Ve=0;if(G.length>0){const ft=new Set;G.forEach(mt=>{const Lt=mt.completedAt?.toDate?mt.completedAt.toDate():mt.completedAt?new Date(mt.completedAt):null;Lt&&ft.add(new Date(Lt.getFullYear(),Lt.getMonth(),Lt.getDate()).toDateString())});const dn=new Date;dn.setHours(0,0,0,0);let hn=new Date(dn);for(ft.has(hn.toDateString())||hn.setDate(hn.getDate()-1);ft.has(hn.toDateString());)Ve++,hn.setDate(hn.getDate()-1)}Xs({total:de,favouriteFocus:Ee,streak:Ve});const Ie={core:null,upper:null,lower:null,fullbody:null};G.forEach(ft=>{if(ft.focus&&Ie[ft.focus]===null&&ft.completedAt){const dn=ft.completedAt.toDate?ft.completedAt.toDate():new Date(ft.completedAt);Ie[ft.focus]=dn}});let Ze=null,Ut=new Date;const Mn=["core","upper","lower","fullbody"];for(const ft of Mn){if(Ie[ft]===null){const dn=Wr.find(hn=>hn.key===ft)?.label||ft;Ze={focus:ft,label:dn,daysAgo:null,message:`You haven't tried ${dn} yet`};break}if(Ie[ft]<Ut){Ut=Ie[ft];const dn=Math.floor((Date.now()-Ie[ft].getTime())/864e5);if(dn>=5){const hn=Wr.find(mt=>mt.key===ft)?.label||ft;Ze={focus:ft,label:hn,daysAgo:dn,message:`${hn}  ${dn} days ago`}}}}Jr(Ze)}catch(k){console.error("Error loading recent workouts:",k)}})()},[s,t,b]);const Ke=async F=>{if(!(!s||!t||V.length===0)){Ts(!0);try{const k=Wr.find(G=>G.key===H)?.label||H,N=F||`${k} ${Q}min`,$=await ir(lt(me,"savedWorkouts"),{clientId:t.id,name:N,equipment:S,focus:H,level:B,duration:Q,exercises:V.map(G=>({name:G.name,videoUrl:G.videoUrl,isGif:G.isGif||!1})),rounds:D,savedAt:Pt.now()});br(G=>[{id:$.id,clientId:t.id,name:N,equipment:S,focus:H,level:B,duration:Q,exercises:V.map(de=>({name:de.name,videoUrl:de.videoUrl,isGif:de.isGif||!1})),rounds:D,savedAt:Pt.now()},...G]),rt("Workout saved!","success")}catch(k){console.error("Error saving workout:",k),rt("Failed to save workout","error")}finally{Ts(!1),In(!1),pn("")}}},Ye=async F=>{try{await rr(He(me,"savedWorkouts",F)),br(k=>k.filter(N=>N.id!==F)),rt("Workout removed","info")}catch(k){console.error("Error deleting saved workout:",k),rt("Failed to remove workout","error")}},it=F=>{R(F.equipment||["bodyweight"]),K(F.focus||"core"),Y(F.level||"intermediate"),Z(F.duration||15);const k=ki.find(N=>N.key===(F.level||"intermediate"));st(k),P(F.exercises||[]),M(F.rounds||2),j("preview")},Et=async()=>{const F=JSON.parse(localStorage.getItem("mcf_last_randomiser")||"null");R(F?.equipment||["bodyweight"]),K(F?.focus||"core"),Y(F?.level||"intermediate"),Z(F?.duration||15),setTimeout(()=>As(),50)},kn=()=>{localStorage.setItem("mcf_last_randomiser",JSON.stringify({equipment:S,focus:H,level:B,duration:Q}))};localStorage.getItem("mcf_last_randomiser");const Ns=()=>{const F=[];let k;H==="mix"?k=["core","upper","lower"]:H==="fullbody"?k=["upper","lower"]:k=[H];for(const N of S)for(const $ of k)F.push(`exercises/${N}/${$}`);return F},es=async()=>{if(T.current){for(;T.current;)await new Promise(F=>setTimeout(F,200));return L.current}T.current=!0,I(!0);try{const F=Ns(),k=[];for(const de of F)try{const ke=na(sa,de),Ee=await qw(ke);k.push(...Ee.items)}catch{console.warn(`Folder ${de} not found, skipping.`)}if(k.length===0&&S.includes("bodyweight")&&H==="core")try{const de=na(sa,"core"),ke=await qw(de);k.push(...ke.items)}catch{console.warn("Legacy core/ folder not found either.")}if(k.length===0){const de=S.map(Ee=>rp.find(Ve=>Ve.key===Ee)?.label).join(" + "),ke=Wr.find(Ee=>Ee.key===H)?.label;return rt(`No exercises found for ${de} / ${ke}. Upload videos to Firebase Storage.`,"error"),T.current=!1,I(!1),[]}const N=new Set,$=k.filter(de=>{const ke=de.name.replace(/\.(mp4|gif)$/i,"");return N.has(ke)?!1:(N.add(ke),!0)}),G=await Promise.all($.map(async de=>{const ke=await to(de),Ee=h5(de.name.replace(/\.(mp4|gif)$/i,"")),Ve=/\.gif$/i.test(de.name);return{name:Ee,videoUrl:ke,isGif:Ve}}));return L.current=G,xe(G),T.current=!1,I(!1),G}catch(F){console.error("Error loading exercises:",F);const k=F.code==="storage/unauthorized"?"Storage access denied. Check Firebase Storage rules allow read access.":`Failed to load exercises: ${F.message||F.code||"Unknown error"}`;return rt(k,"error"),T.current=!1,I(!1),[]}},As=async()=>{if(an)return;kn(),j("spinning"),L.current=[];const F=await es();if(F.length===0){j("setup");return}const k=ki.find(Ie=>Ie.key===B);st(k);const N=k.work+k.rest,$=Q*60,G=Math.floor($/N);let de,ke;G<=6?(de=Math.max(3,Math.floor(G/2)),ke=Math.floor(G/de)):G<=12?(de=Math.min(6,Math.floor(G/2)),ke=Math.floor(G/de)):(de=Math.min(10,Math.floor(G/2)),ke=Math.floor(G/de)),ke=Math.max(2,ke);const Ee=f5(F),Ve=Ee.slice(0,Math.min(de,Ee.length));P(Ve),M(ke),setTimeout(()=>j("preview"),2e3)},ei=()=>{j("countdown"),Fe(3)};w.useEffect(()=>{if(b!=="countdown")return;if(Oe<=0){j("workout"),Te(1),Ne(0),U("work"),Ce(Me.work),ve(!1),_r();return}Hs();const F=setTimeout(()=>Fe(k=>k-1),1e3);return()=>clearTimeout(F)},[Oe,b]),w.useEffect(()=>{if(b!=="workout"||Se)return;if(le<=0){Ls();return}le<=3&&Hs();const F=setTimeout(()=>Ce(k=>k-1),1e3);return()=>clearTimeout(F)},[le,b,Se]);const Ls=()=>{if(ze==="work")U("rest"),Ce(Me.rest);else{const F=Ue+1;if(F>=V.length){const k=J+1;if(k>D){tt(!0),Js();return}Te(k),Ne(0)}else Ne(F);U("work"),Ce(Me.work),_r()}},Js=async()=>{if(s)try{await ir(lt(me,"workoutLogs"),{clientId:t.id,level:B,duration:Q,equipment:S,focus:H,exerciseCount:V.length,rounds:D,exercises:V.map(G=>G.name),completedAt:Pt.now()}),typeof fbq=="function"&&fbq("trackCustom","WorkoutCompleted",{duration:Q,level:B,focus_area:H,exercise_count:V.length}),Pe(G=>G+1);const F=Ae+1;Xe(F),ot(G=>G+Q),On(G=>({...G,[B]:(G[B]||0)+1}));const k=[{count:1,id:"first_workout"},{count:10,id:"workouts_10"},{count:25,id:"workouts_25"},{count:50,id:"workouts_50"},{count:100,id:"workouts_100"}];for(const G of k)if(F>=G.count){const de=await ef(G.id,t);if(de){on(de);break}}const N=Gt+(qe===0?1:0),$=[{weeks:2,id:"streak_2"},{weeks:4,id:"streak_4"},{weeks:8,id:"streak_8"}];for(const G of $)if(N>=G.weeks){const de=await ef(G.id,t);de&&!Ht&&on(de)}}catch(F){console.error("Error saving workout log:",F)}},va=async(F,k,N)=>{if(!(!t||!k))try{const $=t.id,G=await xs(He(me,"coreBuddyPBs",$)),ke=(G.exists()?G.data():null)?.exercises||{},Ee=ke[F];let Ve=!1;if(Ee?(k>(Ee.weight||0)||k===(Ee.weight||0)&&N>(Ee.reps||0))&&(Ve=!0):Ve=!0,Ve){const Ie={...ke,[F]:{weight:k,reps:N,achievedAt:Pt.now()}};await _s(He(me,"coreBuddyPBs",$),{clientId:t.id,exercises:Ie,updatedAt:Pt.now()}),rt(`New PB! ${k}kg  ${N} reps`,"success"),Hs()}}catch($){console.error("Error checking PB:",$)}},wr=async F=>{if(gt(F),F.interval){const $=[];for(const G of F.exercises){let de=null,ke=!1;if(G.storagePath)try{const Ee=na(sa,G.storagePath);de=await to(Ee),ke=/\.gif$/i.test(G.storagePath)}catch{}$.push({name:G.name,videoUrl:de,isGif:ke})}P($),M(F.rounds),st({work:F.work,rest:F.rest}),j("preview");return}const k={};for(const $ of F.exercises)if($.storagePath)try{const G=na(sa,$.storagePath);k[$.name]={url:await to(G),isGif:/\.gif$/i.test($.storagePath)}}catch{}Re(k);const N=F.exercises.map($=>({name:$.name,type:$.type,targetSets:$.sets,targetReps:$.reps||0,targetTime:$.time||0,sets:[]}));un(N),ut(0),en(0),Fn(""),Ln(""),C(!1),zt(!1),At(0),setMgSessionBadges([]),setMgBadgeCelebration(null),j("muscle_workout")},Rs=()=>{const F=De.current;F&&(F.paused?(F.play(),C(!0)):(F.pause(),C(!1)))};w.useEffect(()=>{if(b!=="muscle_workout"||!tn||bt<=0){b==="muscle_workout"&&tn&&bt<=0&&(zt(!1),Hs());return}return Le.current=setTimeout(()=>At(F=>F-1),1e3),()=>clearTimeout(Le.current)},[b,tn,bt]);const ba=async()=>{const F=Gn[Qe];let k={};if(F.type==="weighted"){const G=parseFloat(Qn)||0,de=parseInt(Rn)||0;if(de===0){rt("Enter your reps","error");return}k={weight:G,reps:de}}else if(F.type==="reps"){const G=parseInt(Rn)||0;if(G===0){rt("Enter your reps","error");return}k={reps:G}}else if(F.type==="timed"){const G=F.targetTime-bt;k={time:Math.max(G,1)}}const N=[...Gn];N[Qe]={...F,sets:[...F.sets,k]},un(N),F.type==="weighted"&&k.weight>0&&await va(F.name,k.weight,k.reps);const $=F.sets.length+1;if($<F.targetSets)en($),Ln(""),zt(!1),At(0);else if(Qe+1<Gn.length){const G=Qe+1;ut(G),en(0),Fn(""),Ln(""),C(!1),zt(!1),At(0)}else await Li(N),Tt(!0)},Li=async F=>{if(!(!s||!t))try{const k=F.reduce((N,$)=>N+$.sets.length,0);await ir(lt(me,"workoutLogs"),{clientId:t.id,type:"muscle_group",muscleGroup:ue,sessionId:jt?.id,sessionName:jt?.name,exerciseCount:F.length,totalSets:k,duration:Math.round(k*1.5),exercises:F.map(N=>({name:N.name,type:N.type,sets:N.sets})),completedAt:Pt.now()})}catch(k){console.error("Error saving muscle group workout log:",k)}},xr=w.useRef(null),ti=()=>(xr.current||(xr.current=new(window.AudioContext||window.webkitAudioContext)),xr.current),Hs=()=>{try{const F=ti(),k=F.createOscillator(),N=F.createGain();k.connect(N),N.connect(F.destination),k.frequency.value=880,N.gain.value=.3,k.start(F.currentTime),k.stop(F.currentTime+.15)}catch{}},_r=()=>{try{const F=ti(),k=F.createOscillator(),N=F.createGain();k.connect(N),N.connect(F.destination),k.frequency.value=1200,N.gain.value=.4,k.start(F.currentTime),k.stop(F.currentTime+.3)}catch{}};w.useEffect(()=>{if(b!=="workout"||ze!=="work"||!V[Ue]?.isGif)return;const k=setInterval(()=>{const N=Mt.current;if(!N)return;const $=N.getAttribute("src");N.removeAttribute("src"),setTimeout(()=>{Mt.current&&Mt.current.setAttribute("src",$)},0)},4e3);return()=>clearInterval(k)},[b,ze,Ue,J,V]);const pi=(F,k,N)=>{const $=Math.round(F/k*c5);return a.jsx("svg",{className:"wk-ring-svg",viewBox:"0 0 200 200",children:l3.map((G,de)=>a.jsx("line",{x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,className:de<$?`wk-tick-filled ${N}`:"wk-tick-empty",strokeWidth:G.thick?"3":"2"},de))})},Zs=()=>{const F=V.length*D;return((J-1)*V.length+Ue+(ze==="rest"?.5:0))/F},er=ct&&a.jsx("div",{className:`toast-notification ${ct.type}`,children:ct.message});if(i)return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsx("div",{className:"wk-loading-inline",children:a.jsx("div",{className:"wk-loading-spinner"})})]});if(b==="menu")return a.jsx(nl,{children:a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"wk-menu-heading",children:[a.jsx("h2",{children:"Choose Your Workout"}),a.jsx("p",{children:"No excuses. Just results."})]}),a.jsx("button",{className:"wk-hero-card",onClick:()=>j("randomiser_hub"),children:a.jsx("img",{src:Qw,alt:"Randomise Workout",className:"wk-hero-bg"})}),!d&&a.jsxs("button",{className:"wk-hero-card wk-free-card-premium",onClick:()=>p("/upgrade"),children:[a.jsx("img",{src:Xw,alt:"Programmes",className:"wk-hero-bg"}),a.jsx("div",{className:"wk-free-card-overlay"}),a.jsxs("div",{className:"wk-free-card-content",children:[a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{className:"wk-free-card-label",children:"Unlock Full Access"})]})]}),d&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"wk-section-header",children:[a.jsx("h2",{children:"Programmes"}),a.jsxs("span",{className:"wk-section-count",children:[sp.length," available"]})]}),a.jsx("div",{className:"wk-prog-scroll-wrap",children:a.jsx("div",{className:"wk-prog-scroll",children:sp.map((F,k)=>F.image?a.jsxs("button",{className:"wk-prog-img-card",onClick:()=>p("/client/core-buddy/programmes",{state:{templateId:F.id}}),style:{animationDelay:`${k*.06}s`},children:[a.jsx("img",{src:F.image,alt:F.name,className:"wk-prog-img"}),k===0&&a.jsx("div",{className:"wk-swipe-arrow",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},F.id):a.jsxs("button",{className:"wk-prog-hero-card",onClick:()=>p("/client/core-buddy/programmes",{state:{templateId:F.id}}),style:{animationDelay:`${k*.06}s`},children:[a.jsx("img",{src:Xw,alt:"Programme",className:"wk-prog-hero-bg",loading:"lazy"}),a.jsx("div",{className:"wk-prog-hero-overlay",style:{background:d5[F.focus]}}),a.jsxs("div",{className:"wk-prog-hero-content",children:[a.jsxs("div",{className:"wk-prog-hero-top",children:[a.jsxs("span",{className:"wk-prog-hero-badge",children:[F.duration," WEEKS"]}),a.jsx("span",{className:"wk-prog-hero-level",children:F.level})]}),a.jsxs("div",{className:"wk-prog-hero-bottom",children:[a.jsx("h3",{children:F.name.toUpperCase()}),a.jsxs("p",{children:[F.daysPerWeek,"x per week  ",F.focus==="fullbody"?"Full Body":F.focus.charAt(0).toUpperCase()+F.focus.slice(1)," Focus"]}),a.jsx("span",{className:"wk-prog-hero-go",children:"VIEW PROGRAMME "})]})]}),k===0&&a.jsx("div",{className:"wk-swipe-arrow",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},F.id))})})]}),d&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"wk-section-header",children:[a.jsx("h2",{children:"Muscle Groups"}),a.jsxs("span",{className:"wk-section-count",children:[nu.length," groups"]})]}),a.jsx("div",{className:"wk-muscle-grid",children:nu.map((F,k)=>a.jsx("button",{className:`wk-muscle-hero-card${F.image?" wk-muscle-thumb":""}`,onClick:()=>{kt(F.key),j("muscle_sessions")},style:{animationDelay:`${k*.05}s`},children:F.image?a.jsx("img",{src:F.image,alt:F.label,className:"wk-muscle-thumb-img"}):a.jsxs(a.Fragment,{children:[a.jsx("img",{src:Qw,alt:"Muscle group",className:"wk-muscle-hero-bg",loading:"lazy"}),a.jsx("div",{className:"wk-muscle-hero-overlay",style:{background:np[F.key]}}),a.jsxs("div",{className:"wk-muscle-hero-content",children:[a.jsx("div",{className:"wk-muscle-hero-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:F.icon})})}),a.jsxs("div",{className:"wk-muscle-hero-text",children:[a.jsx("span",{className:"wk-muscle-hero-name",children:F.label}),a.jsxs("span",{className:"wk-muscle-hero-count",children:[Jw[F.key]?.length||0," sessions"]})]})]})]})},F.key))})]})]}),a.jsx(Xr,{active:"workouts"}),er,a.jsx(Wl,{badge:Ht,onDismiss:()=>on(null)})]})});if(b==="randomiser_hub"){const F=JSON.parse(localStorage.getItem("mcf_last_randomiser")||"null")||{focus:"core",level:"intermediate",duration:15},k=Wr.find($=>$.key===F.focus)?.label||F.focus,N=ki.find($=>$.key===F.level)?.label||F.level;return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"wk-hub-heading wk-hub-heading-hero",children:[a.jsx("div",{className:"wk-hub-circle-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-hub-circle-logo"})}),a.jsx("h2",{children:"Randomiser"}),a.jsx("p",{children:"Generate, save & replay workouts"})]}),a.jsxs("div",{className:"wk-hub-launch-zone",children:[fs.total>0&&a.jsxs("div",{className:"wk-hub-stats",children:[a.jsxs("div",{className:"wk-hub-stat",children:[a.jsx("span",{className:"wk-hub-stat-value",children:fs.total}),a.jsx("span",{className:"wk-hub-stat-label",children:"Workouts"})]}),fs.streak>0&&a.jsxs("div",{className:"wk-hub-stat",children:[a.jsxs("span",{className:"wk-hub-stat-value",children:[fs.streak,a.jsx("small",{children:"d"})]}),a.jsx("span",{className:"wk-hub-stat-label",children:"Streak"})]}),fs.favouriteFocus&&a.jsxs("div",{className:"wk-hub-stat",children:[a.jsx("span",{className:"wk-hub-stat-value wk-hub-stat-focus",style:{color:yh[fs.favouriteFocus]||"var(--color-primary)"},children:Wr.find($=>$.key===fs.favouriteFocus)?.label||fs.favouriteFocus}),a.jsx("span",{className:"wk-hub-stat-label",children:"Top Focus"})]})]}),a.jsxs("div",{className:"wk-hub-actions",children:[a.jsxs("button",{className:"wk-hub-action-btn wk-hub-new wk-hub-new-glow",onClick:()=>j("setup"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"New Workout"]}),a.jsxs("button",{className:"wk-hub-action-btn wk-hub-quick",onClick:Et,disabled:an,children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})}),"Quick Start",a.jsxs("span",{className:"wk-hub-quick-meta",children:[k,"  ",N,"  ",F.duration,"min"]})]})]}),Jn&&a.jsxs("button",{className:"wk-hub-suggestion",onClick:()=>{K(Jn.focus),j("setup")},children:[a.jsx("svg",{className:"wk-hub-suggestion-bulb",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),a.jsxs("div",{className:"wk-hub-suggestion-info",children:[a.jsx("span",{className:"wk-hub-suggestion-label",children:Jn.message}),a.jsx("span",{className:"wk-hub-suggestion-cta",children:"Tap to set up "})]}),a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"wk-hub-tip",children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),Zw[Math.floor(Date.now()/864e5)%Zw.length]]})]}),d&&a.jsxs("div",{className:"wk-hub-section wk-hub-section--saved",children:[a.jsxs("h3",{className:"wk-hub-section-title",children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Saved Workouts",as.length>0&&a.jsx("span",{className:"wk-hub-count",children:as.length})]}),ya?as.length===0?a.jsxs("div",{className:"wk-hub-empty wk-hub-empty-enhanced",children:[a.jsx("svg",{className:"wk-hub-empty-icon",width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),a.jsx("p",{children:a.jsx("strong",{children:"No saved workouts yet"})}),a.jsx("p",{className:"wk-hub-empty-sub",children:"Generate a workout and hit save to stash it here for quick replay."})]}):a.jsx("div",{className:"wk-hub-saved-categories",children:Wr.map($=>{const G=as.filter(ke=>ke.focus===$.key);if(G.length===0)return null;const de=Lr[$.key]||!1;return a.jsxs("div",{className:"wk-hub-saved-cat",children:[a.jsxs("button",{className:`wk-hub-saved-cat-header${de?" wk-hub-saved-cat-open":""}`,style:{"--cat-color":yh[$.key]||"var(--color-primary)"},onClick:()=>js(ke=>({...ke,[$.key]:!ke[$.key]})),children:[a.jsxs("span",{className:"wk-hub-saved-cat-label",children:[a.jsx("span",{className:"wk-hub-focus-pill",style:{"--pill-color":yh[$.key]||"var(--color-primary)"},children:$.label}),a.jsx("span",{className:"wk-hub-saved-cat-count",children:G.length})]}),a.jsx("svg",{className:`wk-hub-saved-cat-chevron${de?" wk-hub-saved-cat-chevron-open":""}`,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),de&&a.jsx("div",{className:"wk-hub-saved-list",children:G.map((ke,Ee)=>{const Ve=(ke.equipment||[]).map(Ze=>rp.find(Ut=>Ut.key===Ze)?.label||Ze).join(", "),Ie=ki.find(Ze=>Ze.key===ke.level)?.label||ke.level;return a.jsxs("div",{className:"wk-hub-saved-card",style:{animationDelay:`${Ee*.05}s`},children:[a.jsxs("button",{className:"wk-hub-saved-main",onClick:()=>it(ke),children:[a.jsxs("div",{className:"wk-hub-saved-info",children:[a.jsx("span",{className:"wk-hub-saved-name",children:ke.name}),a.jsx("span",{className:"wk-hub-saved-tags",children:a.jsxs("span",{className:"wk-hub-saved-meta",children:[Ie,"  ",ke.duration,"min  ",(ke.exercises||[]).length," ex"]})}),Ve&&a.jsx("span",{className:"wk-hub-saved-equip",children:Ve})]}),a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]}),a.jsx("button",{className:"wk-hub-saved-delete",onClick:()=>Ye(ke.id),"aria-label":"Remove saved workout",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("polyline",{points:"3 6 5 6 21 6"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]},ke.id)})})]},$.key)})}):a.jsx("div",{className:"wk-hub-empty",children:a.jsx("div",{className:"wk-loading-spinner"})})]}),a.jsxs("div",{className:"wk-hub-section wk-hub-section--recent",children:[a.jsxs("h3",{className:"wk-hub-section-title",children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("polyline",{points:"12 6 12 12 16 14"})]}),"Recent"]}),Ds.length===0?a.jsxs("div",{className:"wk-hub-empty wk-hub-empty-enhanced",children:[a.jsxs("svg",{className:"wk-hub-empty-icon",width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("polyline",{points:"12 6 12 12 16 14"})]}),a.jsx("p",{children:a.jsx("strong",{children:"No workouts yet"})}),a.jsx("p",{className:"wk-hub-empty-sub",children:"Complete your first workout to see your history here."})]}):a.jsx("div",{className:"wk-hub-recent-list",children:Ds.map(($,G)=>{const de=Wr.find(Ie=>Ie.key===$.focus)?.label||$.focus||"",ke=ki.find(Ie=>Ie.key===$.level)?.label||$.level||"",Ee=$.completedAt?.toDate?$.completedAt.toDate():$.completedAt?new Date($.completedAt):null,Ve=Ee?(()=>{const Ie=Math.floor((Date.now()-Ee.getTime())/1e3);return Ie<3600?`${Math.floor(Ie/60)}m ago`:Ie<86400?`${Math.floor(Ie/3600)}h ago`:`${Math.floor(Ie/86400)}d ago`})():"";return a.jsxs("button",{className:"wk-hub-recent-card",style:{animationDelay:`${G*.05}s`},onClick:()=>{K($.focus||"core"),Y($.level||"intermediate"),Z($.duration||15),$.equipment&&R($.equipment),j("setup")},children:[a.jsx("div",{className:"wk-hub-recent-info",children:a.jsxs("span",{className:"wk-hub-recent-tags",children:[a.jsx("span",{className:"wk-hub-focus-pill",style:{"--pill-color":yh[$.focus]||"var(--color-primary)"},children:de}),a.jsxs("span",{className:"wk-hub-recent-meta",children:[ke,"  ",$.duration||"?","min  ",$.exerciseCount||"?"," ex"]})]})}),a.jsxs("div",{className:"wk-hub-recent-action",children:[a.jsx("span",{className:"wk-hub-recent-time",children:Ve}),a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]})]},G)})})]})]}),a.jsx(Xr,{active:"workouts"}),er,a.jsx(Wl,{badge:Ht,onDismiss:()=>on(null)})]})}if(b==="setup"){const F=Wr.find(N=>N.key===H)?.label||H,k=ki.find(N=>N.key===B)?.label||B;return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>j("randomiser_hub"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main wk-setup-main",children:[a.jsx("div",{className:"wk-stats-row",children:[{label:"Total",value:`${Ae}`,pct:Ae>0?Math.min(Math.round(Ae/100*100),100):0,color:"#14b8a6",size:"normal"},{label:"This Week",value:`${qe}/${tp}`,pct:Math.round(Math.min(qe,tp)/tp*100),color:"var(--color-primary)",size:"large"},{label:"Wk Streak",value:`${Gt}`,pct:Gt>0?Math.min(Math.round(Gt/12*100),100):0,color:"#38B6FF",size:"normal"}].map(N=>{const G=2*Math.PI*38,de=G-N.pct/100*G;return a.jsxs("div",{className:`wk-stat-item${N.size==="large"?" wk-stat-large":""}`,children:[a.jsxs("div",{className:"wk-stat-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"wk-stat-track",cx:"50",cy:"50",r:38}),a.jsx("circle",{className:"wk-stat-fill",cx:"50",cy:"50",r:38,style:{stroke:N.color},strokeDasharray:G,strokeDashoffset:de})]}),a.jsx("span",{className:"wk-stat-value",style:{color:N.color},children:N.value})]}),a.jsx("span",{className:"wk-stat-label",children:N.label})]},N.label)})}),a.jsxs("div",{className:"wk-setup-flow",children:[a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Focus Area"}),a.jsx("div",{className:"wk-focus-grid",children:Wr.map(N=>a.jsxs("button",{className:`wk-equip-btn${H===N.key?" active":""}${N.key==="mix"?" wk-mix-btn":""}`,onClick:()=>{Hs(),K(N.key)},children:[a.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:N.icon})}),a.jsx("span",{children:N.label})]},N.key))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Level"}),a.jsx("div",{className:"wk-level-cards",children:ki.map(N=>a.jsxs("button",{className:`wk-level-card wk-level-${N.key}${B===N.key?" active":""}`,onClick:()=>{Hs(),Y(N.key)},children:[a.jsx("span",{className:"wk-level-name",children:N.label}),a.jsx("span",{className:"wk-level-desc",children:N.desc})]},N.key))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Time"}),a.jsx("div",{className:"wk-time-options",children:ip.map(N=>{const $=!Nn.includes(N);return a.jsxs("button",{className:`wk-time-btn${Q===N?" active":""}${$?" locked":""}`,onClick:()=>{$||(Hs(),Z(N))},disabled:$,children:[a.jsx("span",{className:"wk-time-num",children:N}),a.jsx("span",{className:"wk-time-unit",children:$?a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}):"min"})]},N)})})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Equipment"}),a.jsx("div",{className:"wk-equip-options",children:rp.map(N=>{const $=S.includes(N.key);return a.jsxs("button",{className:`wk-equip-btn${$?" active":""}`,onClick:()=>{$&&S.length===1||(Hs(),R(G=>$&&G.length===1?G:$?G.filter(de=>de!==N.key):[...G,N.key]))},children:[a.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:N.icon})}),a.jsx("span",{children:N.label})]},N.key)})})]}),a.jsx("div",{className:"wk-setup-summary",children:a.jsxs("span",{children:[F,"  ",k,"  ",Q," min"]})})]})]}),a.jsxs("div",{className:"wk-go-sticky",children:[an&&a.jsx("p",{className:"wk-free-limit-msg",children:"You've used your free workout this week. Upgrade for unlimited access."}),a.jsx("button",{className:"wk-randomise-btn",onClick:As,disabled:pe||an,children:pe?"Loading exercises...":an?"Limit Reached":"Randomise Workout"})]}),er]})}if(b==="spinning")return a.jsxs("div",{className:"wk-page wk-page-center",children:[a.jsxs("div",{className:"wk-spin-container",children:[a.jsxs("div",{className:"wk-spin-ring",children:[a.jsx("svg",{className:"wk-spin-svg",viewBox:"0 0 200 200",children:o3.map((F,k)=>a.jsx("line",{x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,className:"wk-spin-tick",strokeWidth:F.thick?"3.5":"2",style:{animationDelay:`${k*.03}s`}},k))}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-spin-logo",width:"50",height:"50"})]}),a.jsx("p",{className:"wk-spin-text",children:"Generating workout..."})]}),er]});if(b==="preview"){const F=jt?.interval?{work:jt.work,rest:jt.rest}:ki.find(N=>N.key===B),k=V.length*D*(F.work+F.rest);return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>j(jt?.interval?"muscle_sessions":"setup"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[jt?.interval&&a.jsx("h2",{className:"mg-preview-title",children:jt.name}),a.jsxs("div",{className:"wk-preview-stats",children:[a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:V.length}),a.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:D}),a.jsx("span",{className:"wk-stat-label",children:"Rounds"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Math.ceil(k/60)}),a.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsxs("span",{className:"wk-stat-val",children:[F.work,"/",F.rest]}),a.jsx("span",{className:"wk-stat-label",children:"Work/Rest"})]})]}),a.jsx("div",{className:"wk-preview-list",children:V.map((N,$)=>a.jsxs("div",{className:"wk-preview-item",style:{animationDelay:`${$*.06}s`},onClick:()=>gn(N),children:[a.jsx("span",{className:"wk-preview-num",children:$+1}),a.jsx("div",{className:"wk-preview-thumb",children:N.isGif?a.jsx("img",{src:N.videoUrl,alt:N.name,loading:"lazy"}):a.jsx("video",{src:`${N.videoUrl}#t=0.1`,muted:!0,playsInline:!0,preload:"auto"})}),a.jsx("span",{className:"wk-preview-name",children:N.name}),a.jsx("svg",{className:"wk-preview-play",width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]},$))}),_n&&a.jsx("div",{className:"wk-preview-modal-backdrop",onClick:()=>gn(null),children:a.jsxs("div",{className:"wk-preview-modal",onClick:N=>N.stopPropagation(),children:[a.jsx("button",{className:"wk-preview-modal-close",onClick:()=>gn(null),"aria-label":"Close preview",children:a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),a.jsx("div",{className:"wk-preview-modal-video",children:_n.isGif?a.jsx("img",{src:_n.videoUrl,alt:_n.name}):a.jsx("video",{src:_n.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0})}),a.jsx("h3",{className:"wk-preview-modal-title",children:_n.name})]})}),a.jsxs("div",{className:"wk-preview-actions",children:[!jt?.interval&&a.jsxs("div",{className:"wk-preview-actions-row",children:[a.jsxs("button",{className:"wk-btn-secondary wk-btn-half",onClick:()=>As(),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"1 4 1 10 7 10"}),a.jsx("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})]}),"Reshuffle"]}),d&&a.jsxs("button",{className:"wk-btn-secondary wk-btn-half",onClick:()=>In(!0),disabled:Es,children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Save"]})]}),a.jsx("button",{className:"wk-btn-primary wk-btn-full",onClick:ei,children:"Start Workout"})]}),os&&a.jsx("div",{className:"wk-save-modal-backdrop",onClick:()=>In(!1),children:a.jsxs("div",{className:"wk-save-modal",onClick:N=>N.stopPropagation(),children:[a.jsx("h3",{children:"Save Workout"}),a.jsx("p",{children:"Give this workout a name (or leave blank for auto-name)"}),a.jsx("input",{type:"text",className:"wk-save-input",value:Xn,onChange:N=>pn(N.target.value),placeholder:`${Wr.find(N=>N.key===H)?.label||H} ${Q}min`,maxLength:40,autoFocus:!0}),a.jsxs("div",{className:"wk-save-modal-actions",children:[a.jsx("button",{className:"wk-btn-secondary",onClick:()=>In(!1),children:"Cancel"}),a.jsx("button",{className:"wk-btn-primary",onClick:()=>Ke(Xn),disabled:Es,children:Es?"Saving...":"Save"})]})]})})]})]})}if(b==="countdown")return a.jsx("div",{className:"wk-page wk-page-center wk-page-dark",children:a.jsxs("div",{className:"wk-countdown-big",children:[a.jsx("span",{className:"wk-countdown-num",children:Oe}),a.jsx("span",{className:"wk-countdown-label",children:"GET READY"})]})});if(b==="workout"){const F=V[Ue],k=ze==="work"?Me.work:Me.rest,N=ze==="rest"?Ue+1<V.length?V[Ue+1]:J<D?V[0]:null:null;return a.jsxs("div",{className:"wk-page wk-page-workout",children:[a.jsx("div",{className:"wk-video-container",children:ze==="work"?F.isGif?a.jsx("img",{ref:Mt,className:"wk-video",src:F.videoUrl,alt:F.name},F.videoUrl):a.jsx("video",{className:"wk-video",src:F.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0},F.videoUrl):a.jsxs("div",{className:"wk-rest-screen",children:[a.jsx("span",{className:"wk-rest-label",children:"REST"}),N&&a.jsxs("span",{className:"wk-next-label",children:["Next: ",N.name]})]})}),a.jsx("div",{className:"wk-back-row",children:a.jsxs("button",{className:"wk-back-btn",onClick:()=>{confirm("Leave workout?")&&j("randomiser_hub")},children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]})}),a.jsx("div",{className:"wk-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"wk-exercise-info",children:[a.jsxs("span",{className:"wk-exercise-counter",children:[Ue+1," / ",V.length]}),a.jsx("h2",{className:"wk-exercise-name",children:F.name}),a.jsxs("span",{className:"wk-round-label",children:["Round ",J," of ",D]})]}),a.jsx("div",{className:"wk-timer-section",children:a.jsxs("div",{className:"wk-timer-ring-wrap",children:[pi(le,k,ze==="work"?"wk-tick-work":"wk-tick-rest"),a.jsxs("div",{className:"wk-timer-center",children:[a.jsx("span",{className:"wk-timer-time",children:le}),a.jsx("span",{className:`wk-timer-phase ${ze}`,children:ze==="work"?"WORK":"REST"})]})]})}),a.jsxs("div",{className:"wk-controls",children:[a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-stop",onClick:()=>{confirm("End workout early?")&&j("randomiser_hub")},children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})})}),a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-pause",onClick:()=>ve(!Se),children:Se?a.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}):a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),a.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]})}),a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-skip",onClick:()=>{Ce(0)},children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("polygon",{points:"5 4 15 12 5 20 5 4"}),a.jsx("rect",{x:"15",y:"4",width:"4",height:"16"})]})})]}),a.jsx("div",{className:"wk-progress-bar",children:a.jsx("div",{className:"wk-progress-fill",style:{width:`${Zs()*100}%`}})}),Ge&&(()=>{const $=ki.find(de=>de.key===B),G=V.length*D*($.work+$.rest);return a.jsxs(a.Fragment,{children:[a.jsx(Gp,{title:"Workout Complete!",stats:[{value:Math.ceil(G/60),label:"Minutes"},{value:V.length*D,label:"Intervals"},{value:D,label:"Rounds"}],hideShare:!d,onShareJourney:t?Vt:null,userName:t?.name,onDismissStart:()=>j("randomiser_hub"),onDone:()=>{tt(!1),gt(null),kt(null)}}),!jt?.interval&&a.jsxs("button",{className:"wk-complete-save-btn",onClick:()=>In(!0),disabled:Es,children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Save This Workout"]}),os&&a.jsx("div",{className:"wk-save-modal-backdrop",onClick:()=>In(!1),style:{zIndex:10001},children:a.jsxs("div",{className:"wk-save-modal",onClick:de=>de.stopPropagation(),children:[a.jsx("h3",{children:"Save Workout"}),a.jsx("p",{children:"Give this workout a name (or leave blank for auto-name)"}),a.jsx("input",{type:"text",className:"wk-save-input",value:Xn,onChange:de=>pn(de.target.value),placeholder:`${Wr.find(de=>de.key===H)?.label||H} ${Q}min`,maxLength:40,autoFocus:!0}),a.jsxs("div",{className:"wk-save-modal-actions",children:[a.jsx("button",{className:"wk-btn-secondary",onClick:()=>In(!1),children:"Cancel"}),a.jsx("button",{className:"wk-btn-primary",onClick:()=>Ke(Xn),disabled:Es,children:Es?"Saving...":"Save"})]})]})})]})})()]})}if(b==="muscle_sessions"){const F=nu.find(N=>N.key===ue),k=Jw[ue]||[];return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>j("randomiser_hub"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"mg-sessions-header",children:[a.jsx("div",{className:"mg-sessions-icon",style:{background:np[ue]},children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:F?.icon})})}),a.jsxs("h2",{children:[F?.label," Workouts"]}),a.jsxs("p",{children:[k.length," sessions available"]})]}),a.jsx("div",{className:"mg-sessions-list",children:k.map((N,$)=>a.jsxs("button",{className:"mg-session-card",onClick:()=>{gt(N),j("muscle_overview")},style:{animationDelay:`${$*.08}s`},children:[a.jsxs("div",{className:"mg-session-info",children:[a.jsx("h3",{children:N.name}),a.jsx("p",{children:N.desc}),a.jsx("div",{className:"mg-session-meta",children:N.interval?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mg-session-tag mg-tag-interval",children:"Interval"}),a.jsxs("span",{className:"mg-session-tag",children:[N.exercises.length," exercises"]}),a.jsxs("span",{className:"mg-session-tag",children:[N.rounds," rounds"]})]}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mg-session-tag mg-tag-strength",children:"Strength"}),a.jsxs("span",{className:"mg-session-tag",children:[N.exercises.length," exercises"]}),a.jsx("span",{className:"mg-session-tag",children:(()=>{const G=N.exercises.map(Ee=>Ee.sets||0),de=Math.min(...G),ke=Math.max(...G);return de===ke?`${de} sets each`:`${de}-${ke} sets each`})()})]})})]}),a.jsx("div",{className:"mg-session-arrow",children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},N.id))})]}),er]})}if(b==="muscle_overview"){const F=jt;if(!F)return null;const k=nu.find(N=>N.key===ue);return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>j("muscle_sessions"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main mg-overview-main",children:[a.jsx("div",{className:"mg-overview-hero",style:F.image?void 0:{background:np[ue]},children:F.image?a.jsx("img",{src:F.image,alt:F.name,className:"mg-overview-hero-img"}):a.jsx("div",{className:"mg-overview-hero-content",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"mg-overview-hero-icon",children:a.jsx("path",{d:k?.icon})})})}),a.jsxs("div",{className:"mg-overview-header",children:[a.jsxs("div",{className:"mg-overview-title-row",children:[a.jsx("h2",{children:F.name}),F.level&&a.jsx("span",{className:"mg-overview-level",children:F.level})]}),a.jsx("p",{className:"mg-overview-desc",children:F.desc})]}),F.overview&&a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 16v-4M12 8h.01"})]}),"About This Workout"]}),a.jsx("p",{children:F.overview})]}),F.tips&&F.tips.length>0&&a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Tips & Form"]}),a.jsx("ul",{className:"mg-overview-tips",children:F.tips.map((N,$)=>a.jsx("li",{children:N},$))})]}),a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"}),a.jsx("rect",{x:"9",y:"3",width:"6",height:"4",rx:"1"}),a.jsx("path",{d:"M9 14l2 2 4-4"})]}),"Exercises (",F.exercises.length,")"]}),a.jsx("div",{className:"mg-overview-exercises",children:F.exercises.map((N,$)=>a.jsxs("div",{className:"mg-overview-exercise",children:[a.jsx("span",{className:"mg-overview-ex-num",children:$+1}),a.jsxs("div",{className:"mg-overview-ex-info",children:[a.jsx("span",{className:"mg-overview-ex-name",children:N.name}),F.interval?a.jsxs("span",{className:"mg-overview-ex-detail",children:[F.work,"s work / ",F.rest,"s rest"]}):a.jsxs("span",{className:"mg-overview-ex-detail",children:[N.sets," sets  ",N.reps?`${N.reps} reps`:`${N.time}s`,N.type==="weighted"&&"  weighted"]})]})]},$))})]}),a.jsxs("button",{className:"mg-overview-start-btn",onClick:()=>wr(F),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Workout"]})]}),er]})}if(b==="muscle_workout"){const F=jt;if(!F)return null;const k=F.exercises[Qe],N=Gn[Qe];if(!k||!N)return null;const $=N.sets.length,G=F.exercises.length,de=F.exercises.reduce((Ze,Ut)=>Ze+(Ut.sets||0),0),Ee=Gn.reduce((Ze,Ut)=>Ze+Ut.sets.length,0)/de*100,Ve=ae[k.name];k.type==="timed"&&bt===0&&!tn&&$===Wt&&setTimeout(()=>At(k.time),0);const Ie=$+1<k.sets?"Log Set":Qe+1<G?"Log Set  Next Exercise":"Log Set  Complete";return a.jsxs("div",{className:"wk-page",children:[a.jsx("div",{className:"mg-session-progress",children:a.jsx("div",{className:"mg-session-progress-fill",style:{width:`${Ee}%`}})}),a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>{confirm("End workout early?")&&j("muscle_overview")},"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsxs("span",{className:"mg-header-info",children:["Exercise ",Qe+1,"/",G]}),a.jsx("div",{style:{width:22}})]})}),a.jsxs("main",{className:"wk-main",children:[Ve?a.jsxs("div",{className:"mg-video-container",onClick:Rs,children:[Ve.isGif?a.jsx("img",{className:"mg-video",src:Ve.url,alt:k.name}):a.jsx("video",{ref:De,className:"mg-video",src:Ve.url,loop:!0,muted:!0,playsInline:!0},k.name),!ee&&!Ve.isGif&&a.jsxs("div",{className:"mg-video-overlay",children:[a.jsx("svg",{className:"mg-play-icon",width:"48",height:"48",viewBox:"0 0 24 24",fill:"rgba(255,255,255,0.9)",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),a.jsx("span",{className:"mg-video-hint",children:"Tap for demo"})]})]}):a.jsxs("div",{className:"mg-video-placeholder",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.4",children:[a.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),a.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),a.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),a.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),a.jsx("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),a.jsx("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),a.jsx("line",{x1:"17",y1:"7",x2:"22",y2:"7"}),a.jsx("line",{x1:"17",y1:"17",x2:"22",y2:"17"})]}),a.jsx("span",{children:"Video coming soon"})]}),a.jsx("div",{className:"wk-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"mg-exercise-card",children:[a.jsx("h2",{className:"mg-ex-name",children:k.name}),a.jsx("span",{className:`mg-ex-type-badge ${k.type}`,children:k.type==="weighted"?"Weight + Reps":k.type==="reps"?"Reps Only":"Timed"}),a.jsxs("div",{className:"mg-ex-set-info",children:[a.jsxs("span",{className:"mg-ex-set-num",children:["Set ",$+1," of ",k.sets]}),k.type!=="timed"&&a.jsxs("span",{className:"mg-ex-target",children:["Target: ",k.reps," reps"]}),k.type==="timed"&&a.jsxs("span",{className:"mg-ex-target",children:["Target: ",k.time,"s"]})]}),k.type==="weighted"&&a.jsxs("div",{className:"mg-input-area",children:[a.jsxs("div",{className:"mg-input-group",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",inputMode:"decimal",className:"mg-input",value:Qn,onChange:Ze=>Fn(Ze.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"mg-input-group",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:Rn,onChange:Ze=>Ln(Ze.target.value),placeholder:"0"})]})]}),k.type==="reps"&&a.jsx("div",{className:"mg-input-area",children:a.jsxs("div",{className:"mg-input-group mg-input-single",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:Rn,onChange:Ze=>Ln(Ze.target.value),placeholder:"0"})]})}),k.type==="timed"&&a.jsxs("div",{className:"mg-timer-area",children:[a.jsx("div",{className:"mg-timer-display",children:a.jsxs("span",{className:"mg-timer-value",children:[bt,"s"]})}),tn?a.jsx("button",{className:"mg-timer-btn mg-timer-stop",onClick:()=>zt(!1),children:"Stop"}):a.jsx("button",{className:"mg-timer-btn",onClick:()=>{bt===0&&At(k.time),zt(!0)},children:bt<k.time&&bt>0?"Resume":"Start Timer"})]}),a.jsx("button",{className:"mg-log-set-btn",onClick:ba,children:Ie}),N.sets.length>0&&a.jsx("div",{className:"mg-completed-sets",children:N.sets.map((Ze,Ut)=>a.jsxs("div",{className:"mg-completed-set",children:[a.jsx("span",{className:"mg-completed-set-check",children:""}),a.jsxs("span",{children:["Set ",Ut+1,": ",Ze.weight!=null?`${Ze.weight}kg  ${Ze.reps}`:Ze.reps!=null?`${Ze.reps} reps`:`${Ze.time}s`]})]},Ut))})]})]}),er,sn&&(()=>{const Ze=Gn.reduce((ft,dn)=>ft+dn.sets.length,0),Ut=nu.find(ft=>ft.key===ue)?.label||"",Mn=[{value:Gn.length,label:"Exercises"},{value:Ze,label:"Sets"}];return a.jsx(Gp,{title:`${Ut} Complete!`,subtitle:jt?.name,stats:Mn,hideShare:!d,onShareJourney:t?Vt:null,userName:t?.name,onDismissStart:()=>j("randomiser_hub"),onDone:()=>{Tt(!1),gt(null),kt(null)}})})()]})}return a.jsx(Wl,{badge:Ht,onDismiss:()=>on(null)})}const g5=[{key:"trained",label:"Trained",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4",color:"#A12F3A",darkColor:"#E8475A"},{key:"protein",label:"Hit Protein",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z",color:"#4caf50",darkColor:"#5CDB61"},{key:"steps",label:"10k Steps",icon:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20M4 12.5A2.5 2.5 0 0 1 6.5 10H20M4 5.5A2.5 2.5 0 0 1 6.5 3H20",color:"#ff9800",darkColor:"#FFB020"},{key:"sleep",label:"8hrs Sleep",icon:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z",color:"#7c3aed",darkColor:"#9B5AF2"},{key:"water",label:"2L Water",icon:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z",color:"#2196f3",darkColor:"#42A5F5"}],p5="M12 2l2.4 7.2L22 12l-7.6 2.8L12 22l-2.4-7.2L2 12l7.6-2.8z",y5="#e91e63",v5="#FF4D88",b5=700,Kp=42,Ll=2*Math.PI*Kp,vh=["Every day counts. See you tomorrow!","Consistency is your superpower.","Perfect day  keep the streak alive!","You showed up for yourself today."];function w5(s){const e=new Date(s),t=e.getDay(),i=t===0?-6:1-t;return e.setDate(e.getDate()+i),e.setHours(0,0,0,0),e}function $a(s){return s.toISOString().split("T")[0]}function x5(s){return Array.from({length:7},(e,t)=>{const i=new Date(s);return i.setDate(s.getDate()+t),i})}function _5(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Dr(),{isDark:l,toggleTheme:u}=Di(),{isPremium:d,FREE_HABIT_LIMIT:g}=uc(),y=Qs(),[p,b]=w.useState({}),[j,S]=w.useState([]),[R,H]=w.useState(!0),[K,B]=w.useState(!1),[Y,Q]=w.useState(0),[Z,ge]=w.useState(null),[xe,pe]=w.useState(null),[I,T]=w.useState(!1),[L,V]=w.useState(null),[P,D]=w.useState(!1),[M,Me]=w.useState(!1),[st,J]=w.useState(!1),[Te,Ue]=w.useState(""),[Ne,ze]=w.useState(null),[U,le]=w.useState([]),[Ce,Se]=w.useState(null),ve=w.useRef(null),Oe=w.useRef(null),Fe=w.useRef(null),Ge=w.useRef(null),tt=w.useRef(!1),sn=w.useRef({}),Tt=w.useRef([]),_n=w.useRef([]),gn=w.useRef(null),Mt=w.useRef(vh[Math.floor(Math.random()*vh.length)]),ct=w.useCallback((oe,Ae="info")=>{ge({message:oe,type:Ae}),setTimeout(()=>ge(null),3e3)},[]),Bt=new Date,rt=$a(Bt),Vt=w5(Bt),ue=x5(Vt),kt=["M","T","W","T","F","S","S"],jt=(oe,Ae)=>l&&Ae?Ae:oe,gt=[...g5.filter(oe=>!U.includes(oe.key)).map(oe=>({...oe,color:jt(oe.color,oe.darkColor)})),...j.map(oe=>({key:`custom_${oe.id}`,label:oe.label,icon:p5,color:jt(y5,v5),isCustom:!0,id:oe.id}))],Qe=d?gt:gt.slice(0,g);w.useEffect(()=>{!i&&(!s||!e)&&y("/")},[s,e,i,y]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const Ae=lt(me,"habitLogs"),Xe=Xt(Ae,wt("clientId","==",t.id)),pt=await Ft(Xe),ot={};pt.docs.forEach(on=>{const Cn=on.data();ot[Cn.date]={...Cn,_id:on.id}}),b(ot);const Gt=await xs(He(me,"customHabits",t.id));if(Gt.exists()){const on=Gt.data();S(on.habits||[]),le(on.hiddenDefaults||[])}let bn=0;const Ht=new Date(Bt);for(;;){const on=$a(Ht),Cn=ot[on];if(Cn)if(Object.values(Cn.habits||{}).filter(Boolean).length>=3)bn++,Ht.setDate(Ht.getDate()-1);else break;else if(on===rt)Ht.setDate(Ht.getDate()-1);else break}Q(bn)}catch(Ae){console.error("Error loading habit logs:",Ae)}finally{H(!1)}})()},[s,t]);const ut=p[rt]||{habits:{}};w.useEffect(()=>{Object.values(ut.habits||{}).filter(Boolean).length<Qe.length&&M&&Me(!1)},[Qe.length,ut.habits]);const Wt=async oe=>{if(!(!s||K||ut.habits?.[oe])){Tt.current=[...Array(10)].map((Xe,pt)=>{const ot=pt/10*2*Math.PI,Gt=18+Math.random()*20;return{tx:Math.cos(ot)*Gt,ty:Math.sin(ot)*Gt,size:3+Math.random()*4,duration:.4+Math.random()*.3}}),pe(oe),setTimeout(()=>pe(null),700),navigator.vibrate&&navigator.vibrate(50),B(!0);try{const pt={...ut.habits||{},[oe]:!0},ot=ut._id||`${t.id}_${rt}`;if(b(bn=>({...bn,[rt]:{clientId:t.id,date:rt,habits:pt,_id:ot}})),await _s(He(me,"habitLogs",ot),{clientId:t.id,date:rt,habits:pt}),Object.values(pt).filter(Boolean).length===Qe.length&&!M){Mt.current=vh[Math.floor(Math.random()*vh.length)],_n.current=[...Array(80)].map((Ht,on)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#ffffff","#000000"][on%3],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:on%3})),setTimeout(()=>{T(!0),Me(!0),setTimeout(()=>gn.current?.focus(),1100)},400);let bn=1;for(let Ht=1;Ht<7;Ht++){const on=new Date;on.setDate(on.getDate()-Ht);const Cn=$a(on),On=p[Cn];if(On)if(Object.values(On.habits||{}).filter(Boolean).length>=Qe.length)bn++;else break;else break}bn>=7&&ef("habits_7",t).then(Ht=>{Ht&&V(Ht)})}}catch(Xe){console.error("Error saving habit:",Xe),ct("Failed to save. Try again.","error"),b(pt=>({...pt,[rt]:{...pt[rt],habits:{...pt[rt]?.habits||{},[oe]:!1}}}))}finally{B(!1)}}},en=async oe=>{if(!(!s||K)){B(!0);try{const Xe={...ut.habits||{},[oe]:!1},pt=ut._id||`${t.id}_${rt}`;await _s(He(me,"habitLogs",pt),{clientId:t.id,date:rt,habits:Xe}),b(ot=>({...ot,[rt]:{clientId:t.id,date:rt,habits:Xe,_id:pt}}))}catch(Ae){console.error("Error undoing habit:",Ae),ct("Failed to undo. Try again.","error")}finally{B(!1)}}},Gn=oe=>{if(ut.habits?.[oe]||!1||K||Ge.current)return;Ge.current=oe,Se(oe),Oe.current=performance.now();const Xe=sn.current[oe];Xe&&(Xe.style.strokeDashoffset=Ll);const pt=ot=>{const Gt=ot-Oe.current,bn=Math.min(Gt/b5,1),Ht=sn.current[oe];Ht&&(Ht.style.strokeDashoffset=Ll-bn*Ll),bn<1?Fe.current=requestAnimationFrame(pt):(Ge.current=null,tt.current=!0,Fe.current=null,Se(null),Wt(oe))};Fe.current=requestAnimationFrame(pt)},un=()=>{if(!Ge.current)return;const oe=Ge.current;Ge.current=null,Fe.current&&(cancelAnimationFrame(Fe.current),Fe.current=null),ve.current&&(clearTimeout(ve.current),ve.current=null),sn.current[oe]&&(sn.current[oe].style.strokeDashoffset=Ll),Se(null),Oe.current=null};w.useEffect(()=>()=>{Fe.current&&cancelAnimationFrame(Fe.current),ve.current&&clearTimeout(ve.current)},[]);const Qn=w.useCallback(async oe=>{if(!t)throw new Error("Not signed in");const Ae=oe&&typeof oe=="object"&&oe.type;await ir(lt(me,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Ae?"":oe,type:Ae?oe.type:"text",imageURL:null,createdAt:ws(),likeCount:0,commentCount:0,...Ae?{metadata:{title:oe.title||"",subtitle:oe.subtitle||"",stats:oe.stats||[],quote:oe.quote||"",badges:oe.badges||[]}}:{}})},[t]),Fn=async()=>{const oe=Te.trim();if(!oe)return;if(!t?.id){ct("Still loading, try again","error");return}const Ae=Date.now().toString(36),Xe=[...j,{id:Ae,label:oe}];try{await _s(He(me,"customHabits",t.id),{clientId:t.id,habits:Xe,hiddenDefaults:U},{merge:!0}),S(Xe),Ue(""),J(!1),ct(`Added "${oe}"`,"success")}catch(pt){console.error("Error adding custom habit:",pt),ct(pt?.code==="permission-denied"?"Permission denied  check Firestore rules for customHabits":`Failed to add habit: ${pt?.message||"Unknown error"}`,"error")}},Rn=async oe=>{if(!t?.id)return;const Ae=j.filter(Xe=>Xe.id!==oe);try{await _s(He(me,"customHabits",t.id),{clientId:t.id,habits:Ae,hiddenDefaults:U},{merge:!0}),S(Ae),ze(null),ct("Habit removed","success")}catch(Xe){console.error("Error deleting habit:",Xe),ct("Failed to remove","error")}},Ln=async oe=>{if(!t?.id)return;const Ae=[...U,oe];try{await _s(He(me,"customHabits",t.id),{clientId:t.id,habits:j,hiddenDefaults:Ae},{merge:!0}),le(Ae),ze(null),ct("Habit removed","success")}catch(Xe){console.error("Error hiding default habit:",Xe),ct("Failed to remove","error")}},tn=ue.map(oe=>{const Ae=$a(oe),Xe=p[Ae],pt=Xe?Object.values(Xe.habits||{}).filter(Boolean).length:0;return{date:oe,dateStr:Ae,completed:pt,total:Qe.length}}),zt=tn.reduce((oe,Ae)=>oe+Ae.completed,0),bt=tn.reduce((oe,Ae)=>oe+Ae.total,0),At=bt>0?Math.round(zt/bt*100):0,ee=Object.values(ut.habits||{}).filter(Boolean).length,C=Qe.length>0?Math.round(ee/Qe.length*100):0,ae=ee===Qe.length&&Qe.length>0,Re=(()=>{const oe=Object.keys(p).sort();let Ae=0,Xe=0,pt=null;for(const ot of oe){const Gt=p[ot];if(Object.values(Gt.habits||{}).filter(Boolean).length>=3){if(pt){const Ht=new Date(pt);Xe=(new Date(ot)-Ht)/(1e3*60*60*24)===1?Xe+1:1}else Xe=1;Xe>Ae&&(Ae=Xe),pt=ot}else Xe=0,pt=null}return Math.max(Ae,Y)})(),De=new Date(Bt.getFullYear(),Bt.getMonth(),1),Le=De.toLocaleString("default",{month:"long"}),qe=new Date(Bt.getFullYear(),Bt.getMonth()+1,0).getDate(),Pe=(De.getDay()+6)%7,Dt=Array.from({length:qe},(oe,Ae)=>{const Xe=new Date(Bt.getFullYear(),Bt.getMonth(),Ae+1),pt=$a(Xe),ot=p[pt],Gt=ot?Object.values(ot.habits||{}).filter(Boolean).length:0,bn=Xe>Bt;return{day:Ae+1,dateStr:pt,completed:Gt,total:Qe.length,isFuture:bn,isToday:pt===rt}}),yt=Qe.map(oe=>({...oe,days:ue.map(Ae=>{const Xe=$a(Ae);return p[Xe]?.habits?.[oe.key]||!1})})),at=tn.filter(oe=>oe.completed===oe.total&&oe.total>0).length;return a.jsx(nl,{children:a.jsxs("div",{className:"cbc-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>y("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),i||R?a.jsx("div",{className:"cbc-loading-inline",children:a.jsx("div",{className:"cbc-loading-spinner"})}):a.jsxs("main",{className:"cbc-main",children:[a.jsxs("div",{className:"cbc-hero anim-fade-up",children:[a.jsxs("div",{className:`cbc-progress-ring${ae?" cbc-ring-complete":""}`,children:[a.jsxs("svg",{viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"cbc-arc-track",cx:"100",cy:"100",r:"80"}),a.jsx("circle",{className:"cbc-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-C/100*2*Math.PI*80})]}),a.jsxs("div",{className:"cbc-ring-center",children:[a.jsxs("span",{className:"cbc-ring-count",children:[ee,a.jsx("span",{className:"cbc-ring-divider",children:"/"}),Qe.length]}),a.jsx("span",{className:"cbc-ring-label",children:ae?"complete":"today"})]})]}),a.jsx("p",{className:"cbc-hero-tagline",children:ae?"You showed up for yourself today.":ee===0?"Start your day strong.":`${Qe.length-ee} to go  keep pushing.`})]}),a.jsxs("div",{className:"cbc-streak-card anim-fade-up-d1",children:[a.jsx("div",{className:"cbc-streak-icon",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})})}),a.jsxs("div",{className:"cbc-streak-info",children:[a.jsx("span",{className:"cbc-streak-count",children:Y}),a.jsx("span",{className:"cbc-streak-label",children:"day streak"})]}),a.jsxs("div",{className:"cbc-streak-best",children:[a.jsx("span",{className:"cbc-streak-best-val",children:Re}),a.jsx("span",{className:"cbc-streak-best-label",children:"best"})]})]}),a.jsxs("div",{className:"cbc-section anim-fade-up-d2",children:[a.jsx("h2",{className:"cbc-section-title",children:"Today's Habits"}),a.jsxs("div",{className:"cbc-habits-grid",children:[Qe.map(oe=>{const Ae=ut.habits?.[oe.key]||!1,Xe=xe===oe.key,pt=Ce===oe.key;return a.jsxs("div",{className:`cbc-habit-tile ${Ae?"cbc-habit-done":""} ${Xe?"cbc-habit-just-checked":""}`,style:{"--habit-color":oe.color},children:[d&&a.jsx("button",{className:"cbc-habit-delete",onClick:ot=>{ot.stopPropagation(),ze(oe.isCustom?{type:"custom",id:oe.id,label:oe.label}:{type:"default",key:oe.key,label:oe.label})},"aria-label":`Remove ${oe.label}`,children:a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),a.jsxs("div",{className:`cbc-habit-ring-touch ${pt?"cbc-holding":""} ${Ae?"cbc-ring-completed":""}`,onPointerDown:ot=>{Ae||(ot.preventDefault(),Gn(oe.key))},onPointerUp:un,onPointerLeave:un,onPointerCancel:un,onClick:ot=>{if(ot.stopPropagation(),tt.current){tt.current=!1;return}Ae&&en(oe.key)},role:"button",tabIndex:0,"aria-label":Ae?`Undo ${oe.label}`:`Press and hold to complete ${oe.label}`,onKeyDown:ot=>{(ot.key==="Enter"||ot.key===" ")&&(ot.preventDefault(),Ae?en(oe.key):Wt(oe.key))},children:[a.jsxs("svg",{className:"cbc-habit-ring-svg",viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cbc-habit-ring-track",cx:"50",cy:"50",r:Kp}),a.jsx("circle",{className:"cbc-habit-ring-fill",ref:ot=>{ot&&(sn.current[oe.key]=ot)},cx:"50",cy:"50",r:Kp,style:{stroke:oe.color,strokeDasharray:Ll,strokeDashoffset:Ae?0:Ll}})]}),Ae&&a.jsx("div",{className:"cbc-habit-glow-orb",style:{"--habit-color":oe.color}}),a.jsx("div",{className:"cbc-habit-ring-icon",style:{color:oe.color},children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:oe.icon})})}),Xe&&a.jsx("div",{className:"cbc-particles",children:Tt.current.map((ot,Gt)=>a.jsx("span",{className:"cbc-particle",style:{"--tx":`${ot.tx}px`,"--ty":`${ot.ty}px`,"--size":`${ot.size}px`,"--particle-color":oe.color,animationDuration:`${ot.duration}s`}},Gt))})]}),a.jsx("span",{className:"cbc-habit-label",children:oe.label}),Ae?a.jsx("span",{className:"cbc-habit-done-tag",children:"Done"}):a.jsx("span",{className:"cbc-habit-hold-hint",children:"Hold to complete"})]},oe.key)}),d?a.jsxs("div",{className:"cbc-habit-tile cbc-add-tile",onClick:()=>J(!0),role:"button",tabIndex:0,children:[a.jsx("div",{className:"cbc-add-ring",children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})}),a.jsx("span",{className:"cbc-habit-label",children:"Add Habit"}),a.jsx("span",{className:"cbc-habit-hold-hint",children:"Your own"})]}):a.jsxs("div",{className:"cbc-habit-tile cbc-unlock-tile",onClick:()=>y("/upgrade"),role:"button",tabIndex:0,children:[a.jsx("div",{className:"cbc-unlock-ring",children:a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),a.jsx("span",{className:"cbc-habit-label",children:"More Habits"}),a.jsx("span",{className:"cbc-habit-hold-hint",children:"Custom & editable"})]})]})]}),a.jsxs("div",{className:"cbc-section anim-fade-up-d3",children:[a.jsxs("div",{className:"cbc-section-header",children:[a.jsx("h2",{className:"cbc-section-title",children:"This Week"}),a.jsxs("span",{className:"cbc-section-badge",children:[at,"/7 perfect"]})]}),a.jsxs("div",{className:"cbc-weekly-card",children:[a.jsxs("div",{className:"cbc-weekly-header",children:[a.jsx("span",{className:"cbc-weekly-habit-name"}),kt.map((oe,Ae)=>a.jsx("span",{className:`cbc-weekly-day-label${ue[Ae]&&$a(ue[Ae])===rt?" cbc-today-label":""}`,children:oe},Ae))]}),yt.map(oe=>(oe.days.filter(Boolean).length,a.jsxs("div",{className:"cbc-weekly-row",children:[a.jsx("span",{className:"cbc-weekly-habit-name",style:{color:oe.color},children:oe.label}),oe.days.map((Ae,Xe)=>a.jsx("span",{className:`cbc-weekly-dot${Ae?" cbc-dot-done":""}${ue[Xe]&&$a(ue[Xe])===rt?" cbc-dot-today":""}`,style:Ae?{background:oe.color,borderColor:oe.color,boxShadow:`0 0 6px ${oe.color}40`}:void 0},Xe))]},oe.key))),a.jsxs("div",{className:"cbc-week-summary",children:[a.jsx("div",{className:"cbc-week-summary-bar",children:a.jsx("div",{className:"cbc-week-summary-fill",style:{width:`${At}%`}})}),a.jsxs("span",{className:"cbc-week-summary-text",children:[zt,"/",bt," completed (",At,"%)"]})]})]})]}),a.jsxs("div",{className:"cbc-section anim-fade-up-d4",children:[a.jsx("h2",{className:"cbc-section-title",children:Le}),a.jsxs("div",{className:"cbc-calendar-card",children:[a.jsx("div",{className:"cbc-cal-header",children:["M","T","W","T","F","S","S"].map((oe,Ae)=>a.jsx("span",{className:"cbc-cal-day-label",children:oe},Ae))}),a.jsxs("div",{className:"cbc-cal-grid",children:[Array.from({length:Pe},(oe,Ae)=>a.jsx("span",{className:"cbc-cal-cell cbc-cal-empty"},`e${Ae}`)),Dt.map(oe=>{const Ae=oe.total>0?oe.completed/oe.total:0,Xe=oe.isFuture?-1:Ae===0?0:Ae<.4?1:Ae<.75?2:Ae<1?3:4;return a.jsx("span",{className:`cbc-cal-cell${oe.isToday?" cbc-cal-today":""}${Xe===4?" cbc-cal-perfect":""} cbc-cal-heat-${Xe<0?"future":Xe}`,children:oe.day},oe.day)})]}),a.jsxs("div",{className:"cbc-cal-legend",children:[a.jsx("span",{className:"cbc-cal-legend-label",children:"Less"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-0"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-1"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-2"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-3"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-4"}),a.jsx("span",{className:"cbc-cal-legend-label",children:"More"})]})]})]})]}),a.jsx(Xr,{active:"home"}),st&&a.jsx("div",{className:"cbc-modal-overlay",onClick:()=>J(!1),children:a.jsxs("div",{className:"cbc-modal",onClick:oe=>oe.stopPropagation(),children:[a.jsx("h3",{className:"cbc-modal-title",children:"Add Habit"}),a.jsx("p",{className:"cbc-modal-desc",children:"Track something personal to your routine."}),a.jsx("input",{className:"cbc-modal-input",type:"text",placeholder:"e.g. Meditate, Stretch, Read...",value:Te,onChange:oe=>Ue(oe.target.value),maxLength:30,autoFocus:!0,onKeyDown:oe=>oe.key==="Enter"&&Fn()}),a.jsxs("div",{className:"cbc-modal-actions",children:[a.jsx("button",{className:"cbc-modal-cancel",onClick:()=>{J(!1),Ue("")},children:"Cancel"}),a.jsx("button",{className:"cbc-modal-save",onClick:Fn,disabled:!Te.trim(),children:"Add"})]})]})}),Ne&&a.jsx("div",{className:"cbc-modal-overlay",onClick:()=>ze(null),children:a.jsxs("div",{className:"cbc-modal",onClick:oe=>oe.stopPropagation(),children:[a.jsxs("h3",{className:"cbc-modal-title",children:['Remove "',Ne.label,'"?']}),a.jsx("p",{className:"cbc-modal-desc",children:"This will remove the habit from your daily tracker. Past logs won't be affected."}),a.jsxs("div",{className:"cbc-modal-actions",children:[a.jsx("button",{className:"cbc-modal-cancel",onClick:()=>ze(null),children:"Keep"}),a.jsx("button",{className:"cbc-modal-delete",onClick:()=>Ne.type==="custom"?Rn(Ne.id):Ln(Ne.key),children:"Remove"})]})]})}),I&&a.jsx(Gp,{title:"All Habits Complete!",subtitle:Mt.current,stats:[{value:`${ee}/${Qe.length}`,label:"Habits"},{value:Y||1,label:"Day Streak"}],buttonLabel:"Keep Going",holdLabel:"Hold To Complete Today's Habits",shareType:"habits",hideShare:!d,onShareJourney:t?Qn:null,userName:t?.name,onDone:()=>{T(!1),D(!1)}}),Z&&a.jsx("div",{className:`toast-notification ${Z.type}`,children:Z.message}),a.jsx(Wl,{badge:L,onDismiss:()=>V(null)})]})})}function Io(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function k5(s,e){return[s,e].sort().join("_")}function ex(s){if(!s)return"";const e=s instanceof Date?s:s.toDate?s.toDate():new Date(s),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function j5(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Dr(),{isDark:l,toggleTheme:u}=Di(),d=Qs(),[g,y]=w.useState("feed"),[p,b]=w.useState([]),[j,S]=w.useState([]),[R,H]=w.useState([]),[K,B]=w.useState(""),[Y,Q]=w.useState([]),[Z,ge]=w.useState([]),[xe,pe]=w.useState(!0),[I,T]=w.useState(null),[L,V]=w.useState(null),[P,D]=w.useState([]),[M,Me]=w.useState(!1),[st,J]=w.useState(new Set),[Te,Ue]=w.useState(new Set),[Ne,ze]=w.useState({}),[U,le]=w.useState({}),[Ce,Se]=w.useState({}),[ve,Oe]=w.useState({}),[Fe,Ge]=w.useState({}),[tt,sn]=w.useState({}),Tt=w.useRef({}),[_n,gn]=w.useState(!1),[Mt,ct]=w.useState(null),[Bt,rt]=w.useState([]),Vt=w.useCallback((C,ae="info")=>{V({message:C,type:ae}),setTimeout(()=>V(null),3500)},[]),ue=(C,ae)=>{const Re=C.match(/@(\w*)$/);if(Re){gn(!0),ct(ae);const De=p.filter(Le=>Le.name&&Le.name.toLowerCase().includes(Re[1].toLowerCase())).slice(0,5);rt(De)}else gn(!1),rt([])},kt=(C,ae)=>{const De=(U[ae]||"").replace(/@\w*$/,`@${C.name} `);le(Le=>({...Le,[ae]:De})),gn(!1),rt([])},jt=C=>C&&C.split(/(@\w[\w\s]*?\s)/g).map((Re,De)=>Re.startsWith("@")&&p.some(Le=>Re.trim()===`@${Le.name}`)?a.jsx("span",{className:"mention-highlight",children:Re.trim()},De):Re);w.useEffect(()=>{!i&&(!s||!e)&&d("/")},[s,e,i,d]);const gt=w.useCallback(async()=>{if(t){pe(!0);try{const C=t.id,Re=(await Ft(lt(me,"clients"))).docs.map(at=>({id:at.id,...at.data()}));ge(Re);const De=Object.fromEntries(Re.map(at=>[at.id,at])),Le=await Ft(Xt(lt(me,"buddies"),wt("user1","==",C))),qe=await Ft(Xt(lt(me,"buddies"),wt("user2","==",C))),Pe=new Set;[...Le.docs,...qe.docs].forEach(at=>{const oe=at.data(),Ae=oe.user1===C?oe.user2:oe.user1;Pe.add(Ae)}),b(Array.from(Pe).map(at=>De[at]).filter(Boolean));const Dt=await Ft(Xt(lt(me,"buddyRequests"),wt("toId","==",C),wt("status","==","pending")));S(Dt.docs.map(at=>({reqId:at.id,...at.data(),fromClient:De[at.data().fromId]})).filter(at=>at.fromClient));const yt=await Ft(Xt(lt(me,"buddyRequests"),wt("fromId","==",C),wt("status","==","pending")));H(yt.docs.map(at=>({reqId:at.id,...at.data(),toClient:De[at.data().toId]})).filter(at=>at.toClient))}catch(C){console.error("Error fetching buddy data:",C),Vt("Failed to load buddies","error")}finally{pe(!1)}}},[t,Vt]);w.useEffect(()=>{gt()},[gt]),w.useEffect(()=>{if(!K.trim()||!t){Q([]);return}const C=K.toLowerCase(),ae=t.id,Re=new Set(p.map(Pe=>Pe.id)),De=new Set(R.map(Pe=>Pe.toId)),Le=new Set(j.map(Pe=>Pe.fromId)),qe=Z.filter(Pe=>Pe.id===ae||!Pe.name||!Pe.coreBuddyAccess&&Pe.clientType!=="core_buddy"?!1:Pe.name.toLowerCase().includes(C)).map(Pe=>({...Pe,isBuddy:Re.has(Pe.id),isPendingOut:De.has(Pe.id),isPendingIn:Le.has(Pe.id)})).slice(0,20);Q(qe)},[K,Z,p,R,j,t]);const Qe=async(C,ae)=>{if(!(!t||C===t.id))try{await ir(lt(me,"notifications"),{toId:C,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:ae,read:!1,createdAt:ws()})}catch(Re){console.error("Notification error:",Re),Re.code==="permission-denied"&&Vt("Notifications blocked  check Firestore rules","error")}},ut=async C=>{T(C);try{const ae=`${t.id}_${C}`;await _s(He(me,"buddyRequests",ae),{fromId:t.id,toId:C,status:"pending",createdAt:ws()}),await Qe(C,"buddy_request"),Vt("Buddy request sent!","success"),await gt()}catch(ae){console.error("Error sending request:",ae),Vt("Failed to send request","error")}finally{T(null)}},Wt=async C=>{T(C.reqId);try{const ae=k5(C.fromId,t.id);await _s(He(me,"buddies",ae),{user1:[C.fromId,t.id].sort()[0],user2:[C.fromId,t.id].sort()[1],connectedAt:ws()}),await rr(He(me,"buddyRequests",C.reqId)),await Qe(C.fromId,"buddy_accept"),Vt("Buddy added!","success"),await gt()}catch(ae){console.error("Error accepting request:",ae),Vt("Failed to accept","error")}finally{T(null)}},en=async C=>{T(C.reqId);try{await rr(He(me,"buddyRequests",C.reqId)),Vt("Request declined","info"),await gt()}catch(ae){console.error("Error declining:",ae),Vt("Failed to decline","error")}finally{T(null)}},Gn=async C=>{T(C.reqId);try{await rr(He(me,"buddyRequests",C.reqId)),Vt("Request cancelled","info"),await gt()}catch(ae){console.error("Error cancelling:",ae),Vt("Failed to cancel","error")}finally{T(null)}},un=w.useCallback(async()=>{if(!t||p.length===0){D([]);return}Me(!0);try{const C=[t.id,...p.map(Le=>Le.id)],ae=[];for(let Le=0;Le<C.length;Le+=30)ae.push(C.slice(Le,Le+30));let Re=[];for(const Le of ae){const qe=await Ft(Xt(lt(me,"posts"),wt("authorId","in",Le),qo("createdAt","desc"),$o(50)));Re.push(...qe.docs.map(Pe=>({id:Pe.id,...Pe.data()})))}Re.sort((Le,qe)=>{const Pe=Le.createdAt?.toDate?.()||new Date(0);return(qe.createdAt?.toDate?.()||new Date(0))-Pe}),D(Re.slice(0,50));const De=await Ft(Xt(lt(me,"postLikes"),wt("userId","==",t.id)));J(new Set(De.docs.map(Le=>Le.data().postId)))}catch(C){console.error("Error loading feed:",C)}finally{Me(!1)}},[t,p]);w.useEffect(()=>{p.length>0&&g==="feed"&&un()},[p,g,un]);const Qn=async C=>{if(!t)return;const ae=t.id,Re=`${C}_${ae}`,De=st.has(C),Le=new Set(st);De?Le.delete(C):Le.add(C),J(Le),D(qe=>qe.map(Pe=>Pe.id===C?{...Pe,likeCount:Math.max(0,(Pe.likeCount||0)+(De?-1:1))}:Pe));try{if(De)await rr(He(me,"postLikes",Re)),await zn(He(me,"posts",C),{likeCount:li(-1)});else{await _s(He(me,"postLikes",Re),{postId:C,userId:ae,createdAt:ws()}),await zn(He(me,"posts",C),{likeCount:li(1)});const qe=P.find(Pe=>Pe.id===C);qe&&Qe(qe.authorId,"like")}}catch(qe){console.error("Like error:",qe),un()}},Fn=async C=>{if(window.confirm("Delete this post?"))try{await rr(He(me,"posts",C)),D(ae=>ae.filter(Re=>Re.id!==C)),Vt("Post deleted","info")}catch(ae){console.error("Delete error:",ae),Vt("Failed to delete","error")}},Rn=async C=>{try{const ae=await Ft(Xt(lt(me,"postComments"),wt("postId","==",C),qo("createdAt","asc"),$o(50)));ze(Re=>({...Re,[C]:ae.docs.map(De=>({id:De.id,...De.data()}))}))}catch(ae){console.error("Error loading comments:",ae)}},Ln=C=>{const ae=new Set(Te);ae.has(C)?ae.delete(C):(ae.add(C),Ne[C]||Rn(C)),Ue(ae)},tn=async C=>{const ae=(U[C]||"").trim(),Re=Fe[C];if(!(!ae&&!Re||!t)){Se(De=>({...De,[C]:!0}));try{let De=null;if(Re){const yt=na(sa,`comment-images/${Date.now()}_${Re.name}`);await pu(yt,Re),De=await to(yt)}const Le={postId:C,authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:ae||"",createdAt:ws()};De&&(Le.imageURL=De);const qe=ve[C];qe&&(Le.replyToId=qe.id,Le.replyToName=qe.authorName),await ir(lt(me,"postComments"),Le),await zn(He(me,"posts",C),{commentCount:li(1)});const Pe=P.find(yt=>yt.id===C);Pe&&Qe(Pe.authorId,"comment");const Dt=ae.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Dt){const yt=new Set;Dt.forEach(at=>{const oe=at.slice(1).trim(),Ae=p.find(Xe=>Xe.name&&Xe.name.toLowerCase()===oe.toLowerCase());Ae&&!yt.has(Ae.id)&&(yt.add(Ae.id),Qe(Ae.id,"mention"))})}le(yt=>({...yt,[C]:""})),Ge(yt=>({...yt,[C]:null})),sn(yt=>({...yt,[C]:null})),Oe(yt=>({...yt,[C]:null})),Tt.current[C]&&(Tt.current[C].value=""),D(yt=>yt.map(at=>at.id===C?{...at,commentCount:(at.commentCount||0)+1}:at)),await Rn(C)}catch(De){console.error("Comment error:",De),Vt("Failed to comment","error")}finally{Se(De=>({...De,[C]:!1}))}}},zt=async(C,ae)=>{try{await rr(He(me,"postComments",ae)),await zn(He(me,"posts",C),{commentCount:li(-1)}),ze(Re=>({...Re,[C]:(Re[C]||[]).filter(De=>De.id!==ae)})),D(Re=>Re.map(De=>De.id===C?{...De,commentCount:Math.max((De.commentCount||1)-1,0)}:De))}catch(Re){console.error("Delete comment error:",Re),Vt("Failed to delete comment","error")}},bt=(C,ae)=>{const Re=ae.target.files?.[0];if(!Re)return;if(Re.size>5*1024*1024){Vt("Image must be under 5MB","error");return}Ge(Le=>({...Le,[C]:Re}));const De=new FileReader;De.onload=Le=>sn(qe=>({...qe,[C]:Le.target.result})),De.readAsDataURL(Re)},At=C=>{Ge(ae=>({...ae,[C]:null})),sn(ae=>({...ae,[C]:null})),Tt.current[C]&&(Tt.current[C].value="")},ee=j.length;return i?a.jsx("div",{className:"bdy-loading",children:a.jsx("div",{className:"bdy-spinner"})}):!s||!e||!t?null:a.jsx(nl,{children:a.jsxs("div",{className:"bdy-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"bdy-main",children:[a.jsx("h1",{className:"bdy-title",children:"Buddies"}),a.jsxs("button",{className:"bdy-leaderboard-link",onClick:()=>d("/client/leaderboard"),children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C7 4 7 7 7 7"}),a.jsx("path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5C17 4 17 7 17 7"}),a.jsx("rect",{x:"6",y:"9",width:"12",height:"13",rx:"2"}),a.jsx("path",{d:"M12 9v13"}),a.jsx("path",{d:"M2 22h20"})]}),a.jsx("span",{children:"Leaderboard"}),a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"bdy-tabs",children:[a.jsxs("button",{className:`bdy-tab${g==="feed"?" active":""}`,onClick:()=>y("feed"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M4 11a9 9 0 0 1 9 9"}),a.jsx("path",{d:"M4 4a16 16 0 0 1 16 16"}),a.jsx("circle",{cx:"5",cy:"19",r:"1"})]}),a.jsx("span",{children:"Feed"})]}),a.jsxs("button",{className:`bdy-tab${g==="buddies"?" active":""}`,onClick:()=>y("buddies"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("span",{children:"Buddies"})]}),a.jsxs("button",{className:`bdy-tab${g==="requests"?" active":""}`,onClick:()=>y("requests"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("line",{x1:"19",y1:"8",x2:"19",y2:"14"}),a.jsx("line",{x1:"22",y1:"11",x2:"16",y2:"11"})]}),a.jsx("span",{children:"Requests"}),ee>0&&a.jsx("span",{className:"bdy-tab-badge",children:ee})]}),a.jsxs("button",{className:`bdy-tab${g==="search"?" active":""}`,onClick:()=>y("search"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("span",{children:"Find"})]})]}),xe?a.jsx("div",{className:"bdy-content-loading",children:a.jsx("div",{className:"bdy-spinner"})}):a.jsxs(a.Fragment,{children:[g==="feed"&&a.jsx("div",{className:"bdy-section",children:p.length===0?a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M4 11a9 9 0 0 1 9 9"}),a.jsx("path",{d:"M4 4a16 16 0 0 1 16 16"}),a.jsx("circle",{cx:"5",cy:"19",r:"1"})]}),a.jsx("h3",{children:"No buddies yet"}),a.jsx("p",{children:"Add buddies to see their posts here!"}),a.jsx("button",{className:"bdy-empty-btn",onClick:()=>y("search"),children:"Find Buddies"})]}):M?a.jsx("div",{className:"bdy-content-loading",children:a.jsx("div",{className:"bdy-spinner"})}):P.length===0?a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("h3",{children:"No posts yet"}),a.jsx("p",{children:"Your buddies haven't posted anything yet"})]}):a.jsx("div",{className:"bdy-feed-list",children:P.map(C=>a.jsxs("div",{className:"bdy-feed-post",children:[a.jsxs("div",{className:"bdy-feed-post-header",children:[a.jsx("div",{className:"bdy-feed-avatar",onClick:()=>d(`/client/core-buddy/profile/${C.authorId}`),children:C.authorPhotoURL?a.jsx("img",{src:C.authorPhotoURL,alt:""}):a.jsx("span",{children:Io(C.authorName)})}),a.jsxs("div",{className:"bdy-feed-meta",onClick:()=>d(`/client/core-buddy/profile/${C.authorId}`),children:[a.jsx("span",{className:"bdy-feed-name",children:C.authorName}),a.jsx("span",{className:"bdy-feed-time",children:ex(C.createdAt)})]}),C.authorId===t?.id&&a.jsx("button",{className:"bdy-feed-delete-btn",onClick:()=>Fn(C.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),C.type==="workout_summary"&&C.metadata?a.jsxs("div",{className:"bdy-feed-card",children:[a.jsx("div",{className:"bdy-feed-card-logo",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF"})}),a.jsx("h3",{className:"bdy-feed-card-title",children:C.metadata.title}),C.metadata.stats?.length>0&&a.jsx("p",{className:"bdy-feed-card-stats",children:C.metadata.stats.map(ae=>`${ae.value} ${ae.label}`).join("    ")}),!C.metadata.stats?.length&&C.metadata.subtitle&&a.jsx("p",{className:"bdy-feed-card-stats",children:C.metadata.subtitle}),a.jsx("p",{className:"bdy-feed-card-cta",children:"Completed a workout using Core Buddy"})]}):C.type==="badge_earned"&&C.metadata?a.jsxs("div",{className:"bdy-feed-card",children:[a.jsx("div",{className:"bdy-feed-card-logo bdy-feed-card-badge",children:(()=>{const ae=Kr.find(Re=>Re.id===C.metadata.badgeId);return ae?.img?a.jsx("img",{src:ae.img,alt:C.metadata.title,loading:"lazy"}):a.jsx("img",{src:"/Logo.webp",alt:C.metadata.title})})()}),a.jsx("h3",{className:"bdy-feed-card-title",children:C.metadata.title}),C.metadata.badgeDesc&&a.jsx("p",{className:"bdy-feed-card-stats",children:C.metadata.badgeDesc}),a.jsx("p",{className:"bdy-feed-card-cta",children:"Earned a badge on Core Buddy"})]}):C.type==="habits_summary"&&C.metadata?a.jsxs("div",{className:"bdy-feed-card",children:[a.jsx("div",{className:"bdy-feed-card-logo",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF"})}),a.jsx("h3",{className:"bdy-feed-card-title",children:C.metadata.title}),C.metadata.stats?.length>0&&a.jsx("p",{className:"bdy-feed-card-stats",children:C.metadata.stats.map(ae=>`${ae.value} ${ae.label}`).join("    ")}),C.metadata.subtitle&&a.jsx("p",{className:"bdy-feed-card-stats",children:C.metadata.subtitle}),a.jsx("p",{className:"bdy-feed-card-cta",children:"Completed daily habits with Core Buddy"})]}):a.jsxs(a.Fragment,{children:[C.content&&a.jsx("p",{className:"bdy-feed-content",children:jt(C.content)}),C.imageURL&&a.jsx("div",{className:"bdy-feed-image",children:a.jsx("img",{src:C.imageURL,alt:"Post",loading:"lazy"})})]}),a.jsxs("div",{className:"bdy-feed-actions",children:[a.jsxs("button",{className:`bdy-feed-action-btn${st.has(C.id)?" liked":""}`,onClick:()=>Qn(C.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:st.has(C.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:C.likeCount||0})]}),a.jsxs("button",{className:`bdy-feed-action-btn${Te.has(C.id)?" active":""}`,onClick:()=>Ln(C.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:C.commentCount||0})]})]}),Te.has(C.id)&&a.jsxs("div",{className:"bdy-feed-comments",children:[Ne[C.id]?.length>0?Ne[C.id].map(ae=>a.jsxs("div",{className:"bdy-feed-comment",children:[a.jsx("div",{className:"bdy-feed-comment-avatar",children:ae.authorPhotoURL?a.jsx("img",{src:ae.authorPhotoURL,alt:""}):a.jsx("span",{children:Io(ae.authorName)})}),a.jsxs("div",{className:"bdy-feed-comment-body",children:[a.jsxs("div",{className:"bdy-feed-comment-bubble",children:[a.jsx("span",{className:"bdy-feed-comment-name",children:ae.authorName}),ae.replyToName&&a.jsxs("span",{className:"bdy-feed-comment-reply-tag",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"9 14 4 9 9 4"}),a.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),ae.replyToName]}),ae.content&&a.jsx("span",{className:"bdy-feed-comment-text",children:jt(ae.content)}),ae.imageURL&&a.jsx("img",{className:"bdy-feed-comment-img",src:ae.imageURL,alt:"Comment",loading:"lazy"})]}),a.jsxs("div",{className:"bdy-feed-comment-row",children:[a.jsx("span",{className:"bdy-feed-comment-time",children:ex(ae.createdAt)}),a.jsx("button",{className:"bdy-feed-comment-reply-btn",onClick:()=>Oe(Re=>({...Re,[C.id]:{id:ae.id,authorName:ae.authorName}})),children:"Reply"}),ae.authorId===t?.id&&a.jsx("button",{className:"bdy-feed-comment-del-btn",onClick:()=>zt(C.id,ae.id),"aria-label":"Delete comment",children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]})]},ae.id)):a.jsx("p",{className:"bdy-feed-no-comments",children:"No comments yet"}),ve[C.id]&&a.jsxs("div",{className:"bdy-feed-replying",children:[a.jsxs("span",{children:["Replying to ",a.jsx("strong",{children:ve[C.id].authorName})]}),a.jsx("button",{onClick:()=>Oe(ae=>({...ae,[C.id]:null})),"aria-label":"Cancel reply",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),tt[C.id]&&a.jsxs("div",{className:"bdy-feed-comment-img-preview",children:[a.jsx("img",{src:tt[C.id],alt:"Preview"}),a.jsx("button",{onClick:()=>At(C.id),"aria-label":"Remove image",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"bdy-feed-comment-input",style:{position:"relative"},children:[a.jsx("button",{className:"bdy-feed-comment-img-btn",onClick:()=>Tt.current[C.id]?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:ae=>{Tt.current[C.id]=ae},type:"file",accept:"image/*",onChange:ae=>bt(C.id,ae),hidden:!0}),a.jsx("input",{type:"text",placeholder:"Comment",value:U[C.id]||"",onChange:ae=>{le(Re=>({...Re,[C.id]:ae.target.value})),ue(ae.target.value,C.id)},onKeyDown:ae=>{ae.key==="Enter"&&tn(C.id)},maxLength:300}),_n&&Mt===C.id&&Bt.length>0&&a.jsx("div",{className:"bdy-feed-mention-dropdown",children:Bt.map(ae=>a.jsxs("button",{className:"bdy-feed-mention-option",onClick:()=>kt(ae,C.id),children:[a.jsx("div",{className:"bdy-feed-mention-avatar",children:ae.photoURL?a.jsx("img",{src:ae.photoURL,alt:""}):a.jsx("span",{children:Io(ae.name)})}),a.jsx("span",{children:ae.name})]},ae.id))}),a.jsx("button",{onClick:()=>tn(C.id),disabled:!(U[C.id]||"").trim()&&!Fe[C.id]||Ce[C.id],children:Ce[C.id]?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"var(--color-primary)",stroke:"none",children:a.jsx("path",{d:"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"})})})]})]})]},C.id))})}),g==="buddies"&&a.jsx("div",{className:"bdy-section",children:p.length===0?a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("h3",{children:"No buddies yet"}),a.jsx("p",{children:"Find members and send buddy requests to connect!"}),a.jsx("button",{className:"bdy-empty-btn",onClick:()=>y("search"),children:"Find Buddies"})]}):a.jsx("div",{className:"bdy-list",children:p.map(C=>a.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${C.id}`),children:[a.jsx("div",{className:"bdy-avatar",children:C.photoURL?a.jsx("img",{src:C.photoURL,alt:C.name}):a.jsx("span",{children:Io(C.name)})}),a.jsx("div",{className:"bdy-card-info",children:a.jsx("span",{className:"bdy-card-name",children:C.name})}),a.jsx("button",{className:"bdy-view-btn",onClick:ae=>{ae.stopPropagation(),d(`/client/core-buddy/profile/${C.id}`)},"aria-label":"View profile",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]})})]},C.id))})}),g==="requests"&&a.jsxs("div",{className:"bdy-section",children:[j.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"bdy-section-title",children:"Incoming"}),a.jsx("div",{className:"bdy-list",children:j.map(C=>a.jsxs("div",{className:"bdy-card",children:[a.jsx("div",{className:"bdy-avatar",children:C.fromClient.photoURL?a.jsx("img",{src:C.fromClient.photoURL,alt:C.fromClient.name}):a.jsx("span",{children:Io(C.fromClient.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:C.fromClient.name}),a.jsx("span",{className:"bdy-card-sub",children:"wants to be your buddy"})]}),a.jsxs("div",{className:"bdy-action-pair",children:[a.jsx("button",{className:"bdy-accept-btn",onClick:()=>Wt(C),disabled:I===C.reqId,children:I===C.reqId?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}),a.jsx("button",{className:"bdy-decline-btn",onClick:()=>en(C),disabled:I===C.reqId,children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]},C.reqId))})]}),R.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"bdy-section-title",children:"Sent"}),a.jsx("div",{className:"bdy-list",children:R.map(C=>a.jsxs("div",{className:"bdy-card",children:[a.jsx("div",{className:"bdy-avatar",children:C.toClient?.photoURL?a.jsx("img",{src:C.toClient.photoURL,alt:C.toClient.name}):a.jsx("span",{children:Io(C.toClient?.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:C.toClient?.name}),a.jsx("span",{className:"bdy-card-sub",children:"pending"})]}),a.jsx("button",{className:"bdy-cancel-btn",onClick:()=>Gn(C),disabled:I===C.reqId,children:I===C.reqId?a.jsx("div",{className:"bdy-btn-spinner"}):"Cancel"})]},C.reqId))})]}),j.length===0&&R.length===0&&a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),a.jsx("h3",{children:"No pending requests"}),a.jsx("p",{children:"All caught up!"})]})]}),g==="search"&&a.jsxs("div",{className:"bdy-section",children:[a.jsxs("div",{className:"bdy-search-bar",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("input",{type:"text",placeholder:"Search by name...",value:K,onChange:C=>B(C.target.value),autoFocus:!0}),K&&a.jsx("button",{className:"bdy-search-clear",onClick:()=>B(""),children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),K.trim()&&Y.length===0&&a.jsx("div",{className:"bdy-empty bdy-empty-sm",children:a.jsxs("p",{children:['No members found for "',K,'"']})}),Y.length>0&&a.jsx("div",{className:"bdy-list",children:Y.map(C=>a.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${C.id}`),children:[a.jsx("div",{className:"bdy-avatar",children:C.photoURL?a.jsx("img",{src:C.photoURL,alt:C.name}):a.jsx("span",{children:Io(C.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:C.name}),C.isBuddy&&a.jsx("span",{className:"bdy-card-badge",children:"Buddy"})]}),C.isBuddy?a.jsx("span",{className:"bdy-status-icon",children:a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-success)",strokeWidth:"2.5",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}):C.isPendingOut?a.jsx("span",{className:"bdy-pending-label",children:"Pending"}):C.isPendingIn?a.jsx("button",{className:"bdy-accept-btn",onClick:ae=>{ae.stopPropagation();const Re=j.find(De=>De.fromId===C.id);Re&&Wt(Re)},disabled:!!I,children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}):a.jsx("button",{className:"bdy-add-btn",onClick:ae=>{ae.stopPropagation(),ut(C.id)},disabled:I===C.id,children:I===C.id?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]},C.id))})]})]})]}),a.jsx(Xr,{active:"buddies"}),L&&a.jsxs("div",{className:`toast-notification ${L.type}`,children:[a.jsx("span",{className:"toast-icon",children:L.type==="success"?a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M5 13 L9 17 L19 7"})}):L.type==="error"?a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),a.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),a.jsx("span",{className:"toast-message",children:L.message})]})]})})}function bh(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function ap(s,e){return[s,e].sort().join("_")}const E5=5;function op(s){return s.toISOString().split("T")[0]}function tx(s){if(!s)return"";const e=s instanceof Date?s:s.toDate?s.toDate():new Date(s),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function T5(){const{userId:s}=xS(),{currentUser:e,isClient:t,clientData:i,loading:l}=Dr(),{isDark:u,toggleTheme:d}=Di(),g=Qs(),[y,p]=w.useState(null),[b,j]=w.useState("none"),[S,R]=w.useState(null),[H,K]=w.useState(!0),[B,Y]=w.useState(!1),[Q,Z]=w.useState(null),[ge,xe]=w.useState([]),[pe,I]=w.useState(!1),[T,L]=w.useState(new Set),[V,P]=w.useState(new Set),[D,M]=w.useState({}),[Me,st]=w.useState({}),[J,Te]=w.useState({}),[Ue,Ne]=w.useState(!0),[ze,U]=w.useState(0),[le,Ce]=w.useState(0),[Se,ve]=w.useState(0),[Oe,Fe]=w.useState(new Set),[Ge,tt]=w.useState(null),[sn,Tt]=w.useState(!1),[_n,gn]=w.useState(!1),[Mt,ct]=w.useState([]),[Bt,rt]=w.useState(!1),[Vt,ue]=w.useState(null),[kt,jt]=w.useState([]),gt=w.useCallback((ee,C="info")=>{Z({message:ee,type:C}),setTimeout(()=>Z(null),3500)},[]);w.useEffect(()=>{!l&&(!e||!t)&&g("/")},[e,t,l,g]),w.useEffect(()=>{i&&s&&i.id===s&&g("/client/core-buddy",{replace:!0})},[i,s,g]),w.useEffect(()=>{if(!i||!s||i.id===s)return;let ee=!1;return(async()=>{K(!0);try{const Re=(await Ft(lt(me,"clients"))).docs.map(Pe=>({id:Pe.id,...Pe.data()})).find(Pe=>Pe.id===s);if(!Re){ee||K(!1);return}ee||p(Re);const De=i.id,Le=ap(De,s);if((await xs(He(me,"buddies",Le))).exists())ee||j("buddy");else{const Pe=`${De}_${s}`,Dt=await xs(He(me,"buddyRequests",Pe));if(Dt.exists()&&Dt.data().status==="pending")ee||(j("pending_out"),R(Pe));else{const yt=`${s}_${De}`,at=await xs(He(me,"buddyRequests",yt));at.exists()&&at.data().status==="pending"?ee||(j("pending_in"),R(yt)):ee||j("none")}}}catch(C){console.error("Error loading profile:",C)}finally{ee||K(!1)}})(),()=>{ee=!0}},[i,s]),w.useEffect(()=>{if(!s||!y)return;let ee=!1;return(async()=>{Ne(!0);try{const C=await Ft(Xt(lt(me,"workoutLogs"),wt("clientId","==",s)));if(ee)return;const ae=C.docs.length;U(ae);let Re=0;const De=C.docs.map(qe=>qe.data().date).filter(Boolean).sort().reverse();if(De.length>0){const qe=new Date;let Pe=new Date(qe);for(let Dt=0;Dt<52;Dt++){const yt=new Date(Pe),at=yt.getDay(),oe=at===0?6:at-1;yt.setDate(yt.getDate()-oe),yt.setHours(0,0,0,0);const Ae=new Date(yt);Ae.setDate(Ae.getDate()+7);const Xe=op(yt),pt=op(Ae);if(De.some(Gt=>Gt>=Xe&&Gt<pt))Re++;else{if(Dt>0)break;break}Pe.setDate(Pe.getDate()-7)}}ee||Ce(Re);let Le=0;for(let qe=0;qe<30;qe++){const Pe=new Date;Pe.setDate(Pe.getDate()-qe);const Dt=op(Pe);try{const yt=await Ft(Xt(lt(me,"habitLogs"),wt("clientId","==",s),wt("date","==",Dt)));if(yt.empty)break;{const at=yt.docs[0].data().habits||{};if(Object.values(at).filter(Boolean).length>=E5)Le++;else break}}catch{break}}ee||ve(Le);try{const qe=await xs(He(me,"coreBuddyBadges",s));if(!ee&&qe.exists()){const Pe=qe.data().earned||[];Fe(new Set(Pe.map(Dt=>Dt.id)))}}catch(qe){console.error("Error loading buddy badges:",qe)}}catch(C){console.error("Error loading buddy stats:",C)}finally{ee||Ne(!1)}})(),()=>{ee=!0}},[s,y]),w.useEffect(()=>{if(!i)return;const ee=i.id;(async()=>{try{const[C,ae,Re]=await Promise.all([Ft(Xt(lt(me,"buddies"),wt("user1","==",ee))),Ft(Xt(lt(me,"buddies"),wt("user2","==",ee))),Ft(lt(me,"clients"))]),De=new Set;[...C.docs,...ae.docs].forEach(qe=>{const Pe=qe.data();De.add(Pe.user1===ee?Pe.user2:Pe.user1)});const Le={};Re.docs.forEach(qe=>{Le[qe.id]=qe.data()}),ct(Array.from(De).filter(qe=>Le[qe]).map(qe=>({id:qe,name:Le[qe].name,photoURL:Le[qe].photoURL||null})))}catch(C){console.error("Error loading buddies for mentions:",C)}})()},[i]);const Qe=async(ee,C,ae={})=>{if(!(!i||ee===i.id))try{await ir(lt(me,"notifications"),{toId:ee,fromId:i.id,fromName:i.name||"Someone",fromPhotoURL:i.photoURL||null,type:C,read:!1,createdAt:ws(),...ae})}catch(Re){console.error("Notification error:",Re),Re.code==="permission-denied"&&gt("Notifications blocked  check Firestore rules","error")}},ut=async()=>{Y(!0);try{const ee=`${i.id}_${s}`;await _s(He(me,"buddyRequests",ee),{fromId:i.id,toId:s,status:"pending",createdAt:ws()}),await Qe(s,"buddy_request"),j("pending_out"),R(ee),gt("Buddy request sent!","success")}catch(ee){console.error(ee),gt("Failed to send request","error")}finally{Y(!1)}},Wt=async()=>{if(S){Y(!0);try{const ee=ap(i.id,s);await _s(He(me,"buddies",ee),{user1:[i.id,s].sort()[0],user2:[i.id,s].sort()[1],connectedAt:ws()}),await rr(He(me,"buddyRequests",S)),await Qe(s,"buddy_accept"),j("buddy"),gt("Buddy added!","success")}catch(ee){console.error(ee),gt("Failed to accept","error")}finally{Y(!1)}}},en=async()=>{if(S){Y(!0);try{await rr(He(me,"buddyRequests",S)),j("none"),gt(b==="pending_out"?"Request cancelled":"Request declined","info")}catch(ee){console.error(ee),gt("Failed","error")}finally{Y(!1)}}},Gn=async()=>{Y(!0);try{const ee=ap(i.id,s);await rr(He(me,"buddies",ee)),j("none"),Tt(!1),gt("Buddy removed","info")}catch(ee){console.error(ee),gt("Failed to remove","error")}finally{Y(!1)}},un=w.useCallback(async()=>{if(s){I(!0);try{const ee=await Ft(Xt(lt(me,"posts"),wt("authorId","==",s),qo("createdAt","desc"),$o(30)));if(xe(ee.docs.map(C=>({id:C.id,...C.data()}))),i){const C=await Ft(Xt(lt(me,"postLikes"),wt("userId","==",i.id)));L(new Set(C.docs.map(ae=>ae.data().postId)))}}catch(ee){console.error("Error loading journey:",ee)}finally{I(!1)}}},[s,i]);w.useEffect(()=>{!H&&y&&un()},[H,y,un]);const Qn=async ee=>{if(window.confirm("Delete this post?"))try{await rr(He(me,"posts",ee)),xe(C=>C.filter(ae=>ae.id!==ee)),gt("Post deleted","info")}catch(C){console.error("Delete error:",C),gt("Failed to delete","error")}},Fn=async ee=>{if(!i)return;const C=i.id,ae=`${ee}_${C}`,Re=T.has(ee),De=new Set(T);Re?De.delete(ee):De.add(ee),L(De),xe(Le=>Le.map(qe=>qe.id===ee?{...qe,likeCount:Math.max(0,(qe.likeCount||0)+(Re?-1:1))}:qe));try{if(Re)await rr(He(me,"postLikes",ae)),await zn(He(me,"posts",ee),{likeCount:li(-1)});else{await _s(He(me,"postLikes",ae),{postId:ee,userId:C,createdAt:ws()}),await zn(He(me,"posts",ee),{likeCount:li(1)});const Le=ge.find(qe=>qe.id===ee);Le&&Qe(Le.authorId,"like",{postId:ee})}}catch(Le){console.error("Like error:",Le),un()}},Rn=async ee=>{try{const C=await Ft(Xt(lt(me,"postComments"),wt("postId","==",ee),qo("createdAt","asc"),$o(50)));M(ae=>({...ae,[ee]:C.docs.map(Re=>({id:Re.id,...Re.data()}))}))}catch(C){console.error("Error loading comments:",C)}},Ln=ee=>{const C=new Set(V);C.has(ee)?C.delete(ee):(C.add(ee),D[ee]||Rn(ee)),P(C)},tn=(ee,C)=>{const ae=ee.match(/@(\w*)$/);if(ae){rt(!0),ue(C);const Re=Mt.filter(De=>De.name&&De.name.toLowerCase().includes(ae[1].toLowerCase())).slice(0,5);jt(Re)}else rt(!1),jt([])},zt=(ee,C)=>{const Re=(Me[C]||"").replace(/@\w*$/,`@${ee.name} `);st(De=>({...De,[C]:Re})),rt(!1),jt([])},bt=(ee,C)=>{st(ae=>({...ae,[ee]:C})),tn(C,ee)},At=async ee=>{const C=(Me[ee]||"").trim();if(!(!C||!i)){Te(ae=>({...ae,[ee]:!0}));try{await ir(lt(me,"postComments"),{postId:ee,authorId:i.id,authorName:i.name||"Unknown",authorPhotoURL:i.photoURL||null,content:C,createdAt:ws()}),await zn(He(me,"posts",ee),{commentCount:li(1)});const ae=ge.find(De=>De.id===ee);ae&&Qe(ae.authorId,"comment",{postId:ee});const Re=C.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Re){const De=new Set;Re.forEach(Le=>{const qe=Le.slice(1).trim(),Pe=Mt.find(Dt=>Dt.name&&Dt.name.toLowerCase()===qe.toLowerCase());Pe&&!De.has(Pe.id)&&(De.add(Pe.id),Qe(Pe.id,"mention",{postId:ee}))})}st(De=>({...De,[ee]:""})),xe(De=>De.map(Le=>Le.id===ee?{...Le,commentCount:(Le.commentCount||0)+1}:Le)),await Rn(ee)}catch(ae){console.error("Comment error:",ae),gt("Failed to comment","error")}finally{Te(ae=>({...ae,[ee]:!1}))}}};return l||H||!i?a.jsx("div",{className:"prf-loading",children:a.jsx("div",{className:"prf-spinner"})}):!e||!t?null:y?a.jsx(nl,{children:a.jsxs("div",{className:"prf-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>g(-1),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:u?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"prf-main",children:[a.jsxs("div",{className:"prf-hero",children:[b==="buddy"&&a.jsx("div",{className:"prf-manage-wrap",children:a.jsx("button",{className:"prf-manage-btn",onClick:()=>Tt(!0),"aria-label":"Manage buddy",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("circle",{cx:"12",cy:"5",r:"2"}),a.jsx("circle",{cx:"12",cy:"12",r:"2"}),a.jsx("circle",{cx:"12",cy:"19",r:"2"})]})})}),a.jsx("div",{className:`prf-avatar-lg${y.photoURL?" tappable":""}`,onClick:()=>y.photoURL&&gn(!0),children:y.photoURL?a.jsx("img",{src:y.photoURL,alt:y.name}):a.jsx("span",{children:bh(y.name)})}),a.jsx("h1",{className:"prf-name",children:y.name}),a.jsxs("div",{className:"prf-buddy-action",children:[b==="none"&&a.jsx("button",{className:"prf-btn prf-btn-primary",onClick:ut,disabled:B,children:B?a.jsx("div",{className:"prf-btn-spinner"}):a.jsxs(a.Fragment,{children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Buddy"]})}),b==="pending_out"&&a.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:en,disabled:B,children:B?a.jsx("div",{className:"prf-btn-spinner dark"}):"Cancel Request"}),b==="pending_in"&&a.jsxs("div",{className:"prf-btn-pair",children:[a.jsx("button",{className:"prf-btn prf-btn-success",onClick:Wt,disabled:B,children:B?a.jsx("div",{className:"prf-btn-spinner"}):"Accept"}),a.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:en,disabled:B,children:"Decline"})]}),b==="buddy"&&a.jsxs("span",{className:"prf-buddy-label",children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),"Buddies"]})]})]}),Ue?a.jsx("div",{className:"prf-stats-loading",children:a.jsx("div",{className:"prf-spinner"})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"prf-stats",children:[a.jsxs("div",{className:"prf-stat",children:[a.jsx("span",{className:"prf-stat-value",children:ze}),a.jsx("span",{className:"prf-stat-label",children:"Workouts"})]}),a.jsxs("div",{className:"prf-stat",children:[a.jsxs("span",{className:"prf-stat-value",children:[le,a.jsx("span",{className:"prf-stat-unit",children:"wk"})]}),a.jsx("span",{className:"prf-stat-label",children:"Streak"})]})]}),Se>0&&a.jsx("div",{className:"prf-info-row",children:a.jsxs("div",{className:"prf-info-card info-habit",children:[a.jsx("div",{className:"prf-info-icon",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]})}),a.jsxs("div",{className:"prf-info-text",children:[a.jsxs("span",{className:"prf-info-value",children:[Se," day",Se!==1?"s":""]}),a.jsx("span",{className:"prf-info-sub",children:"Habit Streak"})]})]})}),(()=>{const ee=Kr.filter(C=>Oe.has(C.id));return ee.length>0?a.jsxs("div",{className:"prf-section prf-badges-section",children:[a.jsxs("h2",{className:"prf-section-title",children:[`${y.name?.split(" ")[0]}'s Badges`," ",a.jsxs("span",{className:"prf-badges-tally",children:[ee.length,"/",Kr.length]})]}),a.jsx("div",{className:"prf-badges-carousel",children:ee.map(C=>a.jsxs("button",{className:"prf-carousel-badge",onClick:()=>tt(C),children:[a.jsx("img",{src:C.img,alt:C.name,className:"prf-carousel-badge-img",loading:"lazy"}),a.jsx("span",{className:"prf-carousel-badge-name",children:C.name})]},C.id))})]}):null})()]}),a.jsxs("div",{className:"prf-section",children:[a.jsx("h2",{className:"prf-section-title",children:`${y.name?.split(" ")[0]}'s Journey`}),pe?a.jsx("div",{className:"journey-loading",children:a.jsx("div",{className:"prf-spinner"})}):ge.length===0?a.jsxs("div",{className:"journey-empty",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("p",{children:"No posts yet"})]}):a.jsx("div",{className:"journey-list",children:ge.map(ee=>a.jsxs("div",{className:"journey-post",children:[a.jsxs("div",{className:"journey-post-header",children:[a.jsx("div",{className:"journey-post-avatar",children:ee.authorPhotoURL?a.jsx("img",{src:ee.authorPhotoURL,alt:""}):a.jsx("span",{children:bh(ee.authorName)})}),a.jsxs("div",{className:"journey-post-meta",children:[a.jsx("span",{className:"journey-post-name",children:ee.authorName}),a.jsx("span",{className:"journey-post-time",children:tx(ee.createdAt)})]}),ee.authorId===i.id&&a.jsx("button",{className:"journey-delete-btn",onClick:()=>Qn(ee.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),ee.type==="workout_summary"&&ee.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:ee.metadata.title}),ee.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:ee.metadata.stats.map(C=>`${C.value} ${C.label}`).join("    ")}),!ee.metadata.stats?.length&&ee.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:ee.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed a workout using Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):ee.type==="badge_earned"&&ee.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame journey-card-logo-badge",children:(()=>{const C=Kr.find(ae=>ae.id===ee.metadata.badgeId);return C?.img?a.jsx("img",{src:C.img,alt:ee.metadata.title,className:"journey-card-logo-img",loading:"lazy"}):a.jsx("img",{src:"/Logo.webp",alt:ee.metadata.title,className:"journey-card-logo-img"})})()}),a.jsx("h3",{className:"journey-card-title",children:ee.metadata.title}),ee.metadata.badgeDesc&&a.jsx("p",{className:"journey-card-stats-line",children:ee.metadata.badgeDesc}),a.jsx("p",{className:"journey-card-cta",children:"I just earned a badge on Core Buddy"}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):ee.type==="habits_summary"&&ee.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:ee.metadata.title}),ee.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:ee.metadata.stats.map(C=>`${C.value} ${C.label}`).join("    ")}),ee.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:ee.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed my daily habits with Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):a.jsxs(a.Fragment,{children:[ee.content&&a.jsx("p",{className:"journey-post-content",children:ee.content}),ee.imageURL&&a.jsx("div",{className:"journey-post-image",children:a.jsx("img",{src:ee.imageURL,alt:"Post",loading:"lazy"})})]}),a.jsxs("div",{className:"journey-post-actions",children:[a.jsxs("button",{className:`journey-action-btn${T.has(ee.id)?" liked":""}`,onClick:()=>Fn(ee.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:T.has(ee.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:ee.likeCount||0})]}),a.jsxs("button",{className:`journey-action-btn${V.has(ee.id)?" active":""}`,onClick:()=>Ln(ee.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:ee.commentCount||0})]})]}),V.has(ee.id)&&a.jsxs("div",{className:"journey-comments",children:[D[ee.id]?.length>0?D[ee.id].map(C=>a.jsxs("div",{className:"journey-comment",children:[a.jsx("div",{className:"journey-comment-avatar",onClick:()=>g(`/client/core-buddy/profile/${C.authorId}`),children:C.authorPhotoURL?a.jsx("img",{src:C.authorPhotoURL,alt:""}):a.jsx("span",{children:bh(C.authorName)})}),a.jsxs("div",{className:"journey-comment-body",children:[a.jsxs("div",{className:"journey-comment-bubble",children:[a.jsx("span",{className:"journey-comment-name",children:C.authorName}),a.jsx("span",{className:"journey-comment-text",children:C.content})]}),a.jsx("span",{className:"journey-comment-time",children:tx(C.createdAt)})]})]},C.id)):a.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),a.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[a.jsx("input",{type:"text",placeholder:"Comment... (@ to mention)",value:Me[ee.id]||"",onChange:C=>bt(ee.id,C.target.value),onKeyDown:C=>{C.key==="Enter"&&At(ee.id)},maxLength:300}),Bt&&Vt===ee.id&&kt.length>0&&a.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:kt.map(C=>a.jsxs("button",{className:"mention-option",onClick:()=>zt(C,ee.id),children:[a.jsx("div",{className:"mention-option-avatar",children:C.photoURL?a.jsx("img",{src:C.photoURL,alt:""}):a.jsx("span",{children:bh(C.name)})}),a.jsx("span",{children:C.name})]},C.id))}),a.jsx("button",{onClick:()=>At(ee.id),disabled:!(Me[ee.id]||"").trim()||J[ee.id],children:J[ee.id]?a.jsx("div",{className:"journey-btn-spinner-sm"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),a.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},ee.id))})]})]}),a.jsx(Xr,{active:"buddies"}),_n&&y.photoURL&&a.jsx("div",{className:"prf-photo-overlay",onClick:()=>gn(!1),children:a.jsx("img",{src:y.photoURL,alt:y.name,className:"prf-photo-overlay-img"})}),Ge&&a.jsx("div",{className:"prf-badge-overlay",onClick:()=>tt(null),children:a.jsxs("div",{className:"prf-badge-overlay-content",onClick:ee=>ee.stopPropagation(),children:[a.jsx("img",{src:Ge.img,alt:Ge.name,className:"prf-badge-overlay-img"}),a.jsx("h3",{className:"prf-badge-overlay-name",children:Ge.name}),a.jsx("p",{className:"prf-badge-overlay-desc",children:Ge.desc}),a.jsx("button",{className:"prf-badge-overlay-close",onClick:()=>tt(null),children:"Close"})]})}),sn&&a.jsx("div",{className:"prf-confirm-overlay",onClick:()=>Tt(!1),children:a.jsxs("div",{className:"prf-confirm-card",onClick:ee=>ee.stopPropagation(),children:[a.jsx("div",{className:"prf-confirm-icon",children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("line",{x1:"18",y1:"11",x2:"23",y2:"11"})]})}),a.jsx("h3",{className:"prf-confirm-title",children:"Remove Buddy"}),a.jsxs("p",{className:"prf-confirm-text",children:["Are you sure you want to remove ",y.name?.split(" ")[0]," as a buddy?"]}),a.jsxs("div",{className:"prf-confirm-actions",children:[a.jsx("button",{className:"prf-confirm-btn prf-confirm-cancel",onClick:()=>Tt(!1),children:"Cancel"}),a.jsx("button",{className:"prf-confirm-btn prf-confirm-remove",onClick:Gn,disabled:B,children:B?a.jsx("div",{className:"prf-btn-spinner dark"}):"Remove"})]})]})}),Q&&a.jsxs("div",{className:`toast-notification ${Q.type}`,children:[a.jsx("span",{className:"toast-icon",children:Q.type==="success"?a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M5 13 L9 17 L19 7"})}):Q.type==="error"?a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),a.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),a.jsx("span",{className:"toast-message",children:Q.message})]})]})}):a.jsxs("div",{className:"prf-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>g(-1),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions"})]})}),a.jsx("main",{className:"prf-main",children:a.jsx("p",{style:{textAlign:"center",color:"var(--text-tertiary)",padding:"40px 0"},children:"User not found"})}),a.jsx(Xr,{active:"buddies"})]})}const lp=[{text:"Build your dashboard...",bold:"your way"},{text:"Pick what matters to you...",bold:"nothing else"},{text:"Your goals, your layout...",bold:"your rules"}],nx=[{id:"stats",label:"Stats Rings",desc:"Programme %, workouts this week, habits today",icon:"rings",defaultOn:!0},{id:"workouts",label:"Workouts",desc:"Sessions this week and total count",icon:"dumbbell",defaultOn:!0},{id:"habits",label:"Habits",desc:"Daily habit tracker dots",icon:"check",defaultOn:!0},{id:"pbs",label:"Personal Bests",desc:"Your top lifts at a glance",icon:"trophy"},{id:"nutrition",label:"Nutrition",desc:"Macro rings  protein, carbs, fats, cals",icon:"apple"},{id:"leaderboard",label:"Leaderboard",desc:"See where you rank among buddies",icon:"podium"},{id:"journey",label:"Journey",desc:"Your posts, likes and comments feed",icon:"feed"},{id:"coach",label:"Coach Message",desc:"Motivational nudge from Buddy",icon:"message",defaultOn:!0},{id:"nudge",label:"Smart Nudge",desc:"Contextual reminder of what to do next",icon:"lightbulb"}];function S5(s){switch(s){case"rings":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("circle",{cx:"12",cy:"12",r:"6"}),a.jsx("circle",{cx:"12",cy:"12",r:"2"})]});case"dumbbell":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M6.5 6.5h11v11h-11z",strokeLinejoin:"round"}),a.jsx("line",{x1:"2",y1:"12",x2:"6.5",y2:"12"}),a.jsx("line",{x1:"17.5",y1:"12",x2:"22",y2:"12"})]});case"check":return a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})});case"trophy":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M6 9H3V6a1 1 0 0 1 1-1h2M18 9h3V6a1 1 0 0 0-1-1h-2"}),a.jsx("path",{d:"M6 5h12v7a6 6 0 0 1-12 0V5z"}),a.jsx("path",{d:"M9 21h6"}),a.jsx("path",{d:"M12 17v4"})]});case"apple":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M12 3c-1.5 0-3 1-3 1s-3-.5-4.5 1.5S3 9 3 12s1.5 6 3 8 3 3 6 3 4.5-1 6-3 3-5 3-8-1.5-4-3-6.5S13.5 3 12 3z"}),a.jsx("path",{d:"M12 3c0 0 1-2 3-2"})]});case"podium":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"2",y:"14",width:"6",height:"8",rx:"1"}),a.jsx("rect",{x:"9",y:"8",width:"6",height:"14",rx:"1"}),a.jsx("rect",{x:"16",y:"11",width:"6",height:"11",rx:"1"})]});case"medal":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"15",r:"6"}),a.jsx("path",{d:"M8.21 13.89L7 2h10l-1.21 11.89"})]});case"feed":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"3"}),a.jsx("line",{x1:"3",y1:"9",x2:"21",y2:"9"}),a.jsx("line",{x1:"3",y1:"15",x2:"21",y2:"15"})]});case"message":return a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})});case"lightbulb":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 18h6"}),a.jsx("path",{d:"M10 22h4"}),a.jsx("path",{d:"M12 2a7 7 0 0 0-4 12.7V17h8v-2.3A7 7 0 0 0 12 2z"})]});default:return null}}function C5(){const s=Qs(),{clientData:e,currentUser:t,updateClientData:i,resolveClient:l}=Dr(),[u,d]=w.useState({hours:0,minutes:0,seconds:0}),[g,y]=w.useState(0),[p,b]=w.useState(0),[j,S]=w.useState(null),[R,H]=w.useState(!1),K=w.useRef(null),[B,Y]=w.useState(()=>{const D=e?.dashboardWidgets;return D&&Array.isArray(D)?D:nx.filter(M=>M.defaultOn).map(M=>M.id)}),[Q,Z]=w.useState(!1),[ge,xe]=w.useState(!1),[pe,I]=w.useState(null);w.useEffect(()=>{e?.photoURL&&S(e.photoURL)},[e?.photoURL]),w.useEffect(()=>{const D=()=>{const Me=new Date,st=new Date(Me);st.setHours(23,59,59,999);const J=st-Me;d({hours:Math.floor(J/36e5),minutes:Math.floor(J%36e5/6e4),seconds:Math.floor(J%6e4/1e3)}),y(60-Math.floor(J%6e4/1e3))};D();const M=setInterval(D,1e3);return()=>clearInterval(M)},[]),w.useEffect(()=>{const D=setInterval(()=>b(M=>(M+1)%lp.length),8e3);return()=>clearInterval(D)},[]);const T=async D=>{const M=D.target.files?.[0];if(!(!M||!e?.id)){H(!0);try{const Me=na(sa,`profilePhotos/${e.id}`);await pu(Me,M);const st=await to(Me);await zn(He(me,"clients",e.id),{photoURL:st}),S(st),i({photoURL:st})}catch(Me){console.error("Photo upload error:",Me)}finally{H(!1)}}},L=D=>{xe(!1),Y(M=>M.includes(D)?M.filter(Me=>Me!==D):[...M,D])},V=(D,M)=>{xe(!1),Y(Me=>{const st=Me.indexOf(D);if(st<0)return Me;const J=st+M;if(J<0||J>=Me.length)return Me;const Te=[...Me];return[Te[st],Te[J]]=[Te[J],Te[st]],Te})},P=async()=>{Z(!0),I(null);try{const D=e||await l();if(!D?.id){I("Could not find your profile. Try refreshing."),Z(!1);return}await zn(He(me,"clients",D.id),{dashboardWidgets:B}),i({dashboardWidgets:B}),xe(!0)}catch(D){console.error("Save config error:",D),I("Save failed  please try again.")}finally{Z(!1)}};return a.jsx(nl,{children:a.jsxs("div",{className:"bldr-page",children:[a.jsxs("div",{className:"bldr-container",children:[a.jsxs("div",{className:"bldr-header",children:[a.jsx("button",{className:"bldr-back",onClick:()=>s("/client/core-buddy"),children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("h1",{className:"bldr-title",children:"Build Your Dashboard"})]}),a.jsxs("div",{className:"bldr-ring-container",children:[a.jsxs("div",{className:"bldr-ring",children:[a.jsx("svg",{className:"bldr-ring-svg",viewBox:"0 0 200 200",children:Tj.map((D,M)=>a.jsx("line",{x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,className:`bldr-tick ${M<g?"elapsed":"remaining"}`,strokeWidth:D.thick?"3":"2"},M))}),a.jsxs("div",{className:"bldr-ring-center",children:[a.jsxs("div",{className:"bldr-ring-photo",onClick:()=>K.current?.click(),children:[a.jsx("img",{src:j||"/Logo.webp",alt:j?"Profile":"Mind Core Fitness"}),a.jsx("div",{className:`bldr-photo-overlay${R?" uploading":""}`,children:R?a.jsx("div",{className:"bldr-photo-spinner"}):a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),a.jsx("input",{ref:K,type:"file",accept:"image/*",onChange:T,style:{display:"none"}})]}),!j&&!R&&a.jsx("div",{className:"bldr-photo-badge",onClick:()=>K.current?.click(),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),a.jsxs("div",{className:"bldr-countdown",children:[a.jsx("span",{className:"bldr-timer-digit",children:String(u.hours).padStart(2,"0")}),a.jsx("span",{className:"bldr-timer-colon",children:":"}),a.jsx("span",{className:"bldr-timer-digit",children:String(u.minutes).padStart(2,"0")}),a.jsx("span",{className:"bldr-timer-colon",children:":"}),a.jsx("span",{className:"bldr-timer-digit bldr-timer-sec",children:String(u.seconds).padStart(2,"0")})]}),a.jsx("span",{className:"bldr-ring-label",children:"remaining today"}),a.jsxs("p",{className:"bldr-tagline",children:[lp[p].text," ",a.jsx("strong",{children:lp[p].bold})]})]}),a.jsxs("div",{className:"bldr-section",children:[a.jsx("h2",{className:"bldr-section-title",children:"Choose Your Widgets"}),a.jsx("p",{className:"bldr-section-desc",children:"The countdown ring and your profile always stay at the top. Pick what goes below."}),a.jsx("div",{className:"bldr-widgets-list",children:nx.map(D=>{const M=B.includes(D.id),Me=B.indexOf(D.id);return a.jsxs("div",{className:`bldr-widget-card${M?" active":""}`,children:[a.jsx("div",{className:"bldr-widget-icon",children:S5(D.icon)}),a.jsxs("div",{className:"bldr-widget-info",children:[a.jsx("div",{className:"bldr-widget-label",children:D.label}),a.jsx("div",{className:"bldr-widget-desc",children:D.desc})]}),a.jsxs("div",{className:"bldr-widget-actions",children:[M&&a.jsxs("div",{className:"bldr-widget-order",children:[a.jsx("button",{className:"bldr-order-btn",onClick:()=>V(D.id,-1),disabled:Me===0,"aria-label":"Move up",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M18 15l-6-6-6 6"})})}),a.jsx("span",{className:"bldr-order-num",children:Me+1}),a.jsx("button",{className:"bldr-order-btn",onClick:()=>V(D.id,1),disabled:Me===B.length-1,"aria-label":"Move down",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M6 9l6 6 6-6"})})})]}),a.jsx("button",{className:`bldr-toggle${M?" on":""}`,onClick:()=>L(D.id),"aria-label":M?`Remove ${D.label}`:`Add ${D.label}`,children:a.jsx("div",{className:"bldr-toggle-thumb"})})]})]},D.id)})})]}),a.jsxs("div",{className:"bldr-save-wrap",children:[a.jsx("button",{className:`bldr-save-btn${ge?" saved":""}`,onClick:P,disabled:Q||ge,children:Q?"Saving...":ge?"Saved":"Save Dashboard"}),pe&&a.jsx("p",{className:"bldr-save-error",children:pe}),ge&&a.jsx("button",{className:"bldr-view-btn",onClick:()=>s("/client/core-buddy"),children:"View Dashboard"})]})]}),a.jsx(Xr,{active:"home"})]})})}const Sj="@firebase/installations",p0="0.6.19";const Cj=1e4,Nj=`w:${p0}`,Aj="FIS_v2",N5="https://firebaseinstallations.googleapis.com/v1",A5=3600*1e3,R5="installations",I5="Installations";const M5={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Go=new Yo(R5,I5,M5);function Rj(s){return s instanceof mi&&s.code.includes("request-failed")}function Ij({projectId:s}){return`${N5}/projects/${s}/installations`}function Mj(s){return{token:s.token,requestStatus:2,expiresIn:L5(s.expiresIn),creationTime:Date.now()}}async function Dj(s,e){const i=(await e.json()).error;return Go.create("request-failed",{requestName:s,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function Lj({apiKey:s}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":s})}function D5(s,{refreshToken:e}){const t=Lj(s);return t.append("Authorization",O5(e)),t}async function Oj(s){const e=await s();return e.status>=500&&e.status<600?s():e}function L5(s){return Number(s.replace("s","000"))}function O5(s){return`${Aj} ${s}`}async function P5({appConfig:s,heartbeatServiceProvider:e},{fid:t}){const i=Ij(s),l=Lj(s),u=e.getImmediate({optional:!0});if(u){const p=await u.getHeartbeatsHeader();p&&l.append("x-firebase-client",p)}const d={fid:t,authVersion:Aj,appId:s.appId,sdkVersion:Nj},g={method:"POST",headers:l,body:JSON.stringify(d)},y=await Oj(()=>fetch(i,g));if(y.ok){const p=await y.json();return{fid:p.fid||t,registrationStatus:2,refreshToken:p.refreshToken,authToken:Mj(p.authToken)}}else throw await Dj("Create Installation",y)}function Pj(s){return new Promise(e=>{setTimeout(e,s)})}function V5(s){return btoa(String.fromCharCode(...s)).replace(/\+/g,"-").replace(/\//g,"_")}const U5=/^[cdef][\w-]{21}$/,Yp="";function B5(){try{const s=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(s),s[0]=112+s[0]%16;const t=z5(s);return U5.test(t)?t:Yp}catch{return Yp}}function z5(s){return V5(s).substr(0,22)}function Rf(s){return`${s.appName}!${s.appId}`}const Vj=new Map;function Uj(s,e){const t=Rf(s);Bj(t,e),F5(t,e)}function Bj(s,e){const t=Vj.get(s);if(t)for(const i of t)i(e)}function F5(s,e){const t=H5();t&&t.postMessage({key:s,fid:e}),q5()}let Lo=null;function H5(){return!Lo&&"BroadcastChannel"in self&&(Lo=new BroadcastChannel("[Firebase] FID Change"),Lo.onmessage=s=>{Bj(s.data.key,s.data.fid)}),Lo}function q5(){Vj.size===0&&Lo&&(Lo.close(),Lo=null)}const $5="firebase-installations-database",W5=1,Ko="firebase-installations-store";let cp=null;function y0(){return cp||(cp=af($5,W5,{upgrade:(s,e)=>{e===0&&s.createObjectStore(Ko)}})),cp}async function tf(s,e){const t=Rf(s),l=(await y0()).transaction(Ko,"readwrite"),u=l.objectStore(Ko),d=await u.get(t);return await u.put(e,t),await l.done,(!d||d.fid!==e.fid)&&Uj(s,e.fid),e}async function zj(s){const e=Rf(s),i=(await y0()).transaction(Ko,"readwrite");await i.objectStore(Ko).delete(e),await i.done}async function If(s,e){const t=Rf(s),l=(await y0()).transaction(Ko,"readwrite"),u=l.objectStore(Ko),d=await u.get(t),g=e(d);return g===void 0?await u.delete(t):await u.put(g,t),await l.done,g&&(!d||d.fid!==g.fid)&&Uj(s,g.fid),g}async function v0(s){let e;const t=await If(s.appConfig,i=>{const l=G5(i),u=K5(s,l);return e=u.registrationPromise,u.installationEntry});return t.fid===Yp?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function G5(s){const e=s||{fid:B5(),registrationStatus:0};return Fj(e)}function K5(s,e){if(e.registrationStatus===0){if(!navigator.onLine){const l=Promise.reject(Go.create("app-offline"));return{installationEntry:e,registrationPromise:l}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=Y5(s,t);return{installationEntry:t,registrationPromise:i}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:Q5(s)}:{installationEntry:e}}async function Y5(s,e){try{const t=await P5(s,e);return tf(s.appConfig,t)}catch(t){throw Rj(t)&&t.customData.serverCode===409?await zj(s.appConfig):await tf(s.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function Q5(s){let e=await sx(s.appConfig);for(;e.registrationStatus===1;)await Pj(100),e=await sx(s.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:i}=await v0(s);return i||t}return e}function sx(s){return If(s,e=>{if(!e)throw Go.create("installation-not-found");return Fj(e)})}function Fj(s){return X5(s)?{fid:s.fid,registrationStatus:0}:s}function X5(s){return s.registrationStatus===1&&s.registrationTime+Cj<Date.now()}async function J5({appConfig:s,heartbeatServiceProvider:e},t){const i=Z5(s,t),l=D5(s,t),u=e.getImmediate({optional:!0});if(u){const p=await u.getHeartbeatsHeader();p&&l.append("x-firebase-client",p)}const d={installation:{sdkVersion:Nj,appId:s.appId}},g={method:"POST",headers:l,body:JSON.stringify(d)},y=await Oj(()=>fetch(i,g));if(y.ok){const p=await y.json();return Mj(p)}else throw await Dj("Generate Auth Token",y)}function Z5(s,{fid:e}){return`${Ij(s)}/${e}/authTokens:generate`}async function b0(s,e=!1){let t;const i=await If(s.appConfig,u=>{if(!Hj(u))throw Go.create("not-registered");const d=u.authToken;if(!e&&nL(d))return u;if(d.requestStatus===1)return t=eL(s,e),u;{if(!navigator.onLine)throw Go.create("app-offline");const g=rL(u);return t=tL(s,g),g}});return t?await t:i.authToken}async function eL(s,e){let t=await rx(s.appConfig);for(;t.authToken.requestStatus===1;)await Pj(100),t=await rx(s.appConfig);const i=t.authToken;return i.requestStatus===0?b0(s,e):i}function rx(s){return If(s,e=>{if(!Hj(e))throw Go.create("not-registered");const t=e.authToken;return iL(t)?{...e,authToken:{requestStatus:0}}:e})}async function tL(s,e){try{const t=await J5(s,e),i={...e,authToken:t};return await tf(s.appConfig,i),t}catch(t){if(Rj(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await zj(s.appConfig);else{const i={...e,authToken:{requestStatus:0}};await tf(s.appConfig,i)}throw t}}function Hj(s){return s!==void 0&&s.registrationStatus===2}function nL(s){return s.requestStatus===2&&!sL(s)}function sL(s){const e=Date.now();return e<s.creationTime||s.creationTime+s.expiresIn<e+A5}function rL(s){const e={requestStatus:1,requestTime:Date.now()};return{...s,authToken:e}}function iL(s){return s.requestStatus===1&&s.requestTime+Cj<Date.now()}async function aL(s){const e=s,{installationEntry:t,registrationPromise:i}=await v0(e);return i?i.catch(console.error):b0(e).catch(console.error),t.fid}async function oL(s,e=!1){const t=s;return await lL(t),(await b0(t,e)).token}async function lL(s){const{registrationPromise:e}=await v0(s);e&&await e}function cL(s){if(!s||!s.options)throw up("App Configuration");if(!s.name)throw up("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!s.options[t])throw up(t);return{appName:s.name,projectId:s.options.projectId,apiKey:s.options.apiKey,appId:s.options.appId}}function up(s){return Go.create("missing-app-config-values",{valueName:s})}const qj="installations",uL="installations-internal",dL=s=>{const e=s.getProvider("app").getImmediate(),t=cL(e),i=Qo(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},hL=s=>{const e=s.getProvider("app").getImmediate(),t=Qo(e,qj).getImmediate();return{getId:()=>aL(t),getToken:l=>oL(t,l)}};function fL(){ui(new Qr(qj,dL,"PUBLIC")),ui(new Qr(uL,hL,"PRIVATE"))}fL();vr(Sj,p0);vr(Sj,p0,"esm2020");const mL="/firebase-messaging-sw.js",gL="/firebase-cloud-messaging-push-scope",$j="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",pL="https://fcmregistrations.googleapis.com/v1",Wj="google.c.a.c_id",yL="google.c.a.c_l",vL="google.c.a.ts",bL="google.c.a.e",ix=1e4;var ax;(function(s){s[s.DATA_MESSAGE=1]="DATA_MESSAGE",s[s.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(ax||(ax={}));var Cu;(function(s){s.PUSH_RECEIVED="push-received",s.NOTIFICATION_CLICKED="notification-clicked"})(Cu||(Cu={}));function Zi(s){const e=new Uint8Array(s);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function wL(s){const e="=".repeat((4-s.length%4)%4),t=(s+e).replace(/\-/g,"+").replace(/_/g,"/"),i=atob(t),l=new Uint8Array(i.length);for(let u=0;u<i.length;++u)l[u]=i.charCodeAt(u);return l}const dp="fcm_token_details_db",xL=5,ox="fcm_token_object_Store";async function _L(s){if("databases"in indexedDB&&!(await indexedDB.databases()).map(u=>u.name).includes(dp))return null;let e=null;return(await af(dp,xL,{upgrade:async(i,l,u,d)=>{if(l<2||!i.objectStoreNames.contains(ox))return;const g=d.objectStore(ox),y=await g.index("fcmSenderId").get(s);if(await g.clear(),!!y){if(l===2){const p=y;if(!p.auth||!p.p256dh||!p.endpoint)return;e={token:p.fcmToken,createTime:p.createTime??Date.now(),subscriptionOptions:{auth:p.auth,p256dh:p.p256dh,endpoint:p.endpoint,swScope:p.swScope,vapidKey:typeof p.vapidKey=="string"?p.vapidKey:Zi(p.vapidKey)}}}else if(l===3){const p=y;e={token:p.fcmToken,createTime:p.createTime,subscriptionOptions:{auth:Zi(p.auth),p256dh:Zi(p.p256dh),endpoint:p.endpoint,swScope:p.swScope,vapidKey:Zi(p.vapidKey)}}}else if(l===4){const p=y;e={token:p.fcmToken,createTime:p.createTime,subscriptionOptions:{auth:Zi(p.auth),p256dh:Zi(p.p256dh),endpoint:p.endpoint,swScope:p.swScope,vapidKey:Zi(p.vapidKey)}}}}}})).close(),await Vg(dp),await Vg("fcm_vapid_details_db"),await Vg("undefined"),kL(e)?e:null}function kL(s){if(!s||!s.subscriptionOptions)return!1;const{subscriptionOptions:e}=s;return typeof s.createTime=="number"&&s.createTime>0&&typeof s.token=="string"&&s.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}const jL="firebase-messaging-database",EL=1,Nu="firebase-messaging-store";let hp=null;function Gj(){return hp||(hp=af(jL,EL,{upgrade:(s,e)=>{e===0&&s.createObjectStore(Nu)}})),hp}async function TL(s){const e=Kj(s),i=await(await Gj()).transaction(Nu).objectStore(Nu).get(e);if(i)return i;{const l=await _L(s.appConfig.senderId);if(l)return await w0(s,l),l}}async function w0(s,e){const t=Kj(s),l=(await Gj()).transaction(Nu,"readwrite");return await l.objectStore(Nu).put(e,t),await l.done,e}function Kj({appConfig:s}){return s.appId}const SL={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},cr=new Yo("messaging","Messaging",SL);async function CL(s,e){const t=await _0(s),i=Yj(e),l={method:"POST",headers:t,body:JSON.stringify(i)};let u;try{u=await(await fetch(x0(s.appConfig),l)).json()}catch(d){throw cr.create("token-subscribe-failed",{errorInfo:d?.toString()})}if(u.error){const d=u.error.message;throw cr.create("token-subscribe-failed",{errorInfo:d})}if(!u.token)throw cr.create("token-subscribe-no-token");return u.token}async function NL(s,e){const t=await _0(s),i=Yj(e.subscriptionOptions),l={method:"PATCH",headers:t,body:JSON.stringify(i)};let u;try{u=await(await fetch(`${x0(s.appConfig)}/${e.token}`,l)).json()}catch(d){throw cr.create("token-update-failed",{errorInfo:d?.toString()})}if(u.error){const d=u.error.message;throw cr.create("token-update-failed",{errorInfo:d})}if(!u.token)throw cr.create("token-update-no-token");return u.token}async function AL(s,e){const i={method:"DELETE",headers:await _0(s)};try{const u=await(await fetch(`${x0(s.appConfig)}/${e}`,i)).json();if(u.error){const d=u.error.message;throw cr.create("token-unsubscribe-failed",{errorInfo:d})}}catch(l){throw cr.create("token-unsubscribe-failed",{errorInfo:l?.toString()})}}function x0({projectId:s}){return`${pL}/projects/${s}/registrations`}async function _0({appConfig:s,installations:e}){const t=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":s.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})}function Yj({p256dh:s,auth:e,endpoint:t,vapidKey:i}){const l={web:{endpoint:t,auth:e,p256dh:s}};return i!==$j&&(l.web.applicationPubKey=i),l}const RL=10080*60*1e3;async function IL(s){const e=await DL(s.swRegistration,s.vapidKey),t={vapidKey:s.vapidKey,swScope:s.swRegistration.scope,endpoint:e.endpoint,auth:Zi(e.getKey("auth")),p256dh:Zi(e.getKey("p256dh"))},i=await TL(s.firebaseDependencies);if(i){if(LL(i.subscriptionOptions,t))return Date.now()>=i.createTime+RL?ML(s,{token:i.token,createTime:Date.now(),subscriptionOptions:t}):i.token;try{await AL(s.firebaseDependencies,i.token)}catch(l){console.warn(l)}return lx(s.firebaseDependencies,t)}else return lx(s.firebaseDependencies,t)}async function ML(s,e){try{const t=await NL(s.firebaseDependencies,e),i={...e,token:t,createTime:Date.now()};return await w0(s.firebaseDependencies,i),t}catch(t){throw t}}async function lx(s,e){const i={token:await CL(s,e),createTime:Date.now(),subscriptionOptions:e};return await w0(s,i),i.token}async function DL(s,e){const t=await s.pushManager.getSubscription();return t||s.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:wL(e)})}function LL(s,e){const t=e.vapidKey===s.vapidKey,i=e.endpoint===s.endpoint,l=e.auth===s.auth,u=e.p256dh===s.p256dh;return t&&i&&l&&u}function cx(s){const e={from:s.from,collapseKey:s.collapse_key,messageId:s.fcmMessageId};return OL(e,s),PL(e,s),VL(e,s),e}function OL(s,e){if(!e.notification)return;s.notification={};const t=e.notification.title;t&&(s.notification.title=t);const i=e.notification.body;i&&(s.notification.body=i);const l=e.notification.image;l&&(s.notification.image=l);const u=e.notification.icon;u&&(s.notification.icon=u)}function PL(s,e){e.data&&(s.data=e.data)}function VL(s,e){if(!e.fcmOptions&&!e.notification?.click_action)return;s.fcmOptions={};const t=e.fcmOptions?.link??e.notification?.click_action;t&&(s.fcmOptions.link=t);const i=e.fcmOptions?.analytics_label;i&&(s.fcmOptions.analyticsLabel=i)}function UL(s){return typeof s=="object"&&!!s&&Wj in s}function BL(s){if(!s||!s.options)throw fp("App Configuration Object");if(!s.name)throw fp("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=s;for(const i of e)if(!t[i])throw fp(i);return{appName:s.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}function fp(s){return cr.create("missing-app-config-values",{valueName:s})}class zL{constructor(e,t,i){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const l=BL(e);this.firebaseDependencies={app:e,appConfig:l,installations:t,analyticsProvider:i}}_delete(){return Promise.resolve()}}async function FL(s){try{s.swRegistration=await navigator.serviceWorker.register(mL,{scope:gL}),s.swRegistration.update().catch(()=>{}),await HL(s.swRegistration)}catch(e){throw cr.create("failed-service-worker-registration",{browserErrorMessage:e?.message})}}async function HL(s){return new Promise((e,t)=>{const i=setTimeout(()=>t(new Error(`Service worker not registered after ${ix} ms`)),ix),l=s.installing||s.waiting;s.active?(clearTimeout(i),e()):l?l.onstatechange=u=>{u.target?.state==="activated"&&(l.onstatechange=null,clearTimeout(i),e())}:(clearTimeout(i),t(new Error("No incoming service worker found.")))})}async function qL(s,e){if(!e&&!s.swRegistration&&await FL(s),!(!e&&s.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw cr.create("invalid-sw-registration");s.swRegistration=e}}async function $L(s,e){e?s.vapidKey=e:s.vapidKey||(s.vapidKey=$j)}async function Qj(s,e){if(!navigator)throw cr.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw cr.create("permission-blocked");return await $L(s,e?.vapidKey),await qL(s,e?.serviceWorkerRegistration),IL(s)}async function WL(s,e,t){const i=GL(e);(await s.firebaseDependencies.analyticsProvider.get()).logEvent(i,{message_id:t[Wj],message_name:t[yL],message_time:t[vL],message_device_time:Math.floor(Date.now()/1e3)})}function GL(s){switch(s){case Cu.NOTIFICATION_CLICKED:return"notification_open";case Cu.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}async function KL(s,e){const t=e.data;if(!t.isFirebaseMessaging)return;s.onMessageHandler&&t.messageType===Cu.PUSH_RECEIVED&&(typeof s.onMessageHandler=="function"?s.onMessageHandler(cx(t)):s.onMessageHandler.next(cx(t)));const i=t.data;UL(i)&&i[bL]==="1"&&await WL(s,t.messageType,i)}const ux="@firebase/messaging",dx="0.12.23";const YL=s=>{const e=new zL(s.getProvider("app").getImmediate(),s.getProvider("installations-internal").getImmediate(),s.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>KL(e,t)),e},QL=s=>{const e=s.getProvider("messaging").getImmediate();return{getToken:i=>Qj(e,i)}};function XL(){ui(new Qr("messaging",YL,"PUBLIC")),ui(new Qr("messaging-internal",QL,"PRIVATE")),vr(ux,dx),vr(ux,dx,"esm2020")}async function JL(){try{await Hx()}catch{return!1}return typeof window<"u"&&Fx()&&LC()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}function ZL(s=Mu()){return JL().then(e=>{if(!e)throw cr.create("unsupported-browser")},e=>{throw cr.create("indexed-db-unsupported")}),Qo(vn(s),"messaging").getImmediate()}async function eO(s,e){return s=vn(s),Qj(s,e)}XL();const tO="BNVNdqAPfJYhKBjF9qd-YPEMYIbecZLWiOGUF5tOBfNuv6P1iXgJS6IoS9dHLM5gp-WMrExfir0pCpkMzOdTWKY";let mp=null;function nO(){if(!mp)try{mp=ZL(Mu())}catch{return null}return mp}function Qp(){return"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window}function hx(){return"Notification"in window?Notification.permission:"denied"}function sO(s){const e=Object.getOwnPropertyDescriptor(Notification,"permission");Object.defineProperty(Notification,"permission",{get:()=>"granted",configurable:!0});const t=()=>{e?Object.defineProperty(Notification,"permission",e):delete Notification.permission};try{const i=s();return i&&typeof i.then=="function"?i.then(l=>(t(),l),l=>{throw t(),l}):(t(),i)}catch(i){throw t(),i}}async function rO(s){if(!Qp())return null;try{const e=await Notification.requestPermission(),t=nO();if(!t)return console.error("Push: could not initialise Firebase Messaging"),null;const i=await navigator.serviceWorker.ready,l=e!=="granted";let u=null;const d=3;for(let g=1;g<=d;g++){try{const y=()=>eO(t,{vapidKey:tO,serviceWorkerRegistration:i});if(u=l?await sO(y):await y(),u)break}catch(y){console.warn(`Push getToken attempt ${g}/${d} failed:`,y)}g<d&&await new Promise(y=>setTimeout(y,1500*g))}return u&&s&&await zn(He(me,"clients",s),{fcmTokens:E6(u)}),u}catch(e){return console.error("Push permission request failed:",e),null}}async function iO(s,e){if(!(!e||!s))try{await zn(He(me,"clients",s),{fcmTokens:T6(e)})}catch(t){console.error("Token revoke failed:",t)}}const aO=[{key:"buddy_request",label:"Buddy requests",desc:"When someone sends you a buddy request"},{key:"buddy_accept",label:"Buddy accepted",desc:"When your buddy request is accepted"},{key:"like",label:"Likes",desc:"When someone likes your post"},{key:"comment",label:"Comments",desc:"When someone comments on your post"},{key:"mention",label:"Mentions",desc:"When someone @mentions you"}];function oO(){const{currentUser:s,clientData:e,updateClientData:t,logout:i,loading:l}=Dr(),{isDark:u,toggleTheme:d,accent:g,setAccent:y,isMono:p,toggleMono:b}=Di(),j=Qs(),[S,R]=w.useState(!1),[H,K]=w.useState(null),[B,Y]=w.useState(!1),[Q,Z]=w.useState("default"),[ge,xe]=w.useState({buddy_request:!0,buddy_accept:!0,like:!0,comment:!0,mention:!0}),[pe,I]=w.useState(null),T=w.useCallback((P,D="info")=>{I({message:P,type:D}),setTimeout(()=>I(null),4e3)},[]);w.useEffect(()=>{!l&&!s&&j("/")},[l,s,j]),w.useEffect(()=>{if(!e)return;const P=e.notificationPrefs;P&&xe(M=>({...M,...P}));const D=e.fcmTokens||[];D.length>0&&(R(!0),K(D[D.length-1])),Z(hx())},[e]);const L=async()=>{if(e){Y(!0);try{if(S)H&&await iO(e.id,H),R(!1),K(null),t({fcmTokens:[]}),T("Push notifications disabled","info");else{if(!Qp()){T("Push notifications are not supported on this device","error");return}const P=await rO(e.id),D=hx();Z(D),P?(R(!0),K(P),t({fcmTokens:[...e.fcmTokens||[],P]}),T("Push notifications enabled!","success")):T(D==="denied"?"Notifications blocked  enable them in your device settings, remove the app from your home screen and re-add it":D==="granted"?"Permission granted but setup failed  try closing and reopening the app, then toggle again":"Could not enable notifications  please try again","error")}}catch(P){console.error("Push toggle failed:",P),T("Something went wrong  please try again","error")}finally{Y(!1)}}},V=async P=>{if(!e)return;const D={...ge,[P]:!ge[P]};xe(D);try{await zn(He(me,"clients",e.id),{notificationPrefs:D}),t({notificationPrefs:D})}catch(M){console.error("Failed to save pref:",M),xe(Me=>({...Me,[P]:!Me[P]})),T("Failed to save preference","error")}};return l||!e?a.jsx("div",{className:"cb-loading",children:a.jsx("div",{className:"cb-loading-spinner"})}):a.jsxs("div",{className:"cb-settings",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>j("/client/core-buddy"),"aria-label":"Back",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M19 12H5"}),a.jsx("path",{d:"M12 19l-7-7 7-7"})]})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:u?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})}),a.jsx("button",{onClick:i,"aria-label":"Log out",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),a.jsxs("main",{className:"settings-main",children:[a.jsx("h1",{className:"settings-title",children:"Settings"}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"13.5",cy:"6.5",r:"2.5"}),a.jsx("circle",{cx:"19",cy:"13.5",r:"2.5"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"2.5"}),a.jsx("circle",{cx:"5",cy:"15.5",r:"2.5"}),a.jsx("circle",{cx:"11",cy:"19.5",r:"2.5"}),a.jsx("path",{d:"M12 2a10 10 0 0 0 0 20 2 2 0 0 0 2-2v-1a2 2 0 0 1 2-2h1a2 2 0 0 0 2-2 10 10 0 0 0-7-13z"})]}),"Accent Colour"]}),a.jsx("div",{className:"settings-accent-row",children:[{key:"red",color:"#B8313D",label:"Red"},{key:"orange",color:"#FF8533",label:"Orange"},{key:"blue",color:"#1AADFF",label:"Blue"},{key:"green",color:"#C1FF72",label:"Green"},{key:"purple",color:"#CB6CE6",label:"Purple"}].map(P=>a.jsxs("button",{className:`settings-accent-option${g===P.key?" active":""}`,onClick:()=>y(P.key),"aria-label":`${P.label} accent`,children:[a.jsx("span",{className:"settings-accent-dot",style:{background:P.color}}),a.jsx("span",{className:"settings-accent-label",children:P.label})]},P.key))}),a.jsxs("div",{className:"settings-row settings-mono-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Mono"}),a.jsx("span",{className:"settings-row-desc",children:"Black & white with frosted glass"})]}),a.jsx("button",{className:`settings-toggle${p?" on":""}`,onClick:b,"aria-label":"Toggle mono theme",children:a.jsx("span",{className:"settings-toggle-knob"})})]})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),a.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),"Notifications"]}),Qp()?a.jsxs("div",{className:"settings-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Push notifications"}),a.jsx("span",{className:"settings-row-desc",children:"Receive notifications even when the app is closed"})]}),a.jsx("button",{className:`settings-toggle${S?" on":""}${B?" loading":""}`,onClick:L,disabled:B,"aria-label":"Toggle push notifications",children:a.jsx("span",{className:"settings-toggle-knob"})})]}):a.jsx("p",{className:"settings-hint",children:"Add the app to your home screen for background push notifications. In-app notifications still work below."}),a.jsxs("div",{className:"settings-sub-section",children:[a.jsx("span",{className:"settings-sub-title",children:"Notify me about"}),aO.map(P=>a.jsxs("div",{className:"settings-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:P.label}),a.jsx("span",{className:"settings-row-desc",children:P.desc})]}),a.jsx("button",{className:`settings-toggle${ge[P.key]?" on":""}`,onClick:()=>V(P.key),"aria-label":`Toggle ${P.label}`,children:a.jsx("span",{className:"settings-toggle-knob"})})]},P.key))]})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),"Account"]}),a.jsxs("div",{className:"settings-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Dark mode"}),a.jsx("span",{className:"settings-row-desc",children:"Switch between light and dark themes"})]}),a.jsx("button",{className:`settings-toggle${u?" on":""}`,onClick:d,"aria-label":"Toggle dark mode",children:a.jsx("span",{className:"settings-toggle-knob"})})]}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Email"}),a.jsx("span",{className:"settings-row-desc",children:e?.email||""})]})}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Plan"}),a.jsx("span",{className:"settings-row-desc",style:{textTransform:"capitalize"},children:e?.tier||"free"})]})})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),"Support & Feedback"]}),a.jsxs("a",{href:"mailto:ross@mindcorefitness.com?subject=Core%20Buddy%20Bug%20Report",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Report a Bug"}),a.jsx("span",{className:"settings-row-desc",children:"Found something not working? Let us know"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]}),a.jsxs("a",{href:"mailto:ross@mindcorefitness.com?subject=Core%20Buddy%20Feature%20Request",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Request a Feature"}),a.jsx("span",{className:"settings-row-desc",children:"Have an idea to improve Core Buddy?"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]}),a.jsxs("a",{href:"mailto:ross@mindcorefitness.com?subject=Core%20Buddy%20Feedback",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"General Feedback"}),a.jsx("span",{className:"settings-row-desc",children:"We'd love to hear from you"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Contact Email"}),a.jsx("span",{className:"settings-row-desc",children:"ross@mindcorefitness.com"})]})})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),a.jsx("polyline",{points:"10 9 9 9 8 9"})]}),"Legal"]}),a.jsxs("a",{href:"/privacy-policy",target:"_blank",rel:"noopener noreferrer",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Privacy Policy"}),a.jsx("span",{className:"settings-row-desc",children:"How we collect, use, and protect your data"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),a.jsx("polyline",{points:"15 3 21 3 21 9"}),a.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})]}),a.jsxs("a",{href:"/terms",target:"_blank",rel:"noopener noreferrer",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Terms & Conditions"}),a.jsx("span",{className:"settings-row-desc",children:"Terms of use for Core Buddy"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),a.jsx("polyline",{points:"15 3 21 3 21 9"}),a.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})]})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),a.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),"About"]}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Core Buddy"}),a.jsx("span",{className:"settings-row-desc",children:"Food. Habits. Move."})]})}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Version"}),a.jsx("span",{className:"settings-row-desc",children:"1.0.0"})]})}),a.jsxs("a",{href:"/core-buddy",target:"_blank",rel:"noopener noreferrer",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Visit Our Website"}),a.jsx("span",{className:"settings-row-desc",children:"mindcorefitness.com"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),a.jsx("polyline",{points:"15 3 21 3 21 9"}),a.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})]})]})]}),pe&&a.jsx("div",{className:`settings-toast ${pe.type}`,children:pe.message}),a.jsx(Xr,{active:"home"})]})}const wh=[{id:"starter_streak",name:"Starter Streak",description:"Complete 5 workouts in 7 days",goal:5,duration:7,type:"workouts",difficulty:"easy",icon:"flame",premium:!0},{id:"consistency_king",name:"Consistency King",description:"Complete 12 workouts in 30 days",goal:12,duration:30,type:"workouts",difficulty:"medium",icon:"crown",premium:!0},{id:"thirty_in_thirty",name:"30 in 30",description:"Complete 30 workouts in 30 days",goal:30,duration:30,type:"workouts",difficulty:"hard",icon:"fire",premium:!0},{id:"minute_master",name:"Minute Master",description:"Train for 300 total minutes in 30 days",goal:300,duration:30,type:"minutes",difficulty:"medium",icon:"clock",premium:!0},{id:"habit_machine",name:"Habit Machine",description:"Hit all daily habits for 7 days straight",goal:7,duration:7,type:"habits_perfect",difficulty:"medium",icon:"check",premium:!0},{id:"iron_will",name:"Iron Will",description:"Work out every day for 14 days straight",goal:14,duration:14,type:"streak",difficulty:"hard",icon:"shield",premium:!0}];function gp({icon:s,size:e=28}){const t={width:e,height:e};switch(s){case"flame":return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 12c2-2.96 0-7-1-8 0 3.038-1.773 4.741-3 6-1.226 1.26-2 3.24-2 5a6 6 0 1 0 12 0c0-1.532-1.056-3.94-2-5-1.786 3-2.791 3-4 2z"})});case"crown":return a.jsxs("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M2 4l3 12h14l3-12-6 7-4-7-4 7-6-7z"}),a.jsx("path",{d:"M3 20h18"})]});case"fire":return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 12c2-2.96 0-7-1-8 0 3.038-1.773 4.741-3 6-1.226 1.26-2 3.24-2 5a6 6 0 1 0 12 0c0-1.532-1.056-3.94-2-5-1.786 3-2.791 3-4 2z"})});case"clock":return a.jsxs("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 6v6l4 2"})]});case"check":return a.jsxs("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]});case"shield":return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})});default:return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("circle",{cx:"12",cy:"12",r:"10"})})}}function fx({progress:s,goal:e,size:t=160,stroke:i=10,label:l}){const u=Math.min(s/e,1),d=(t-i)/2,g=2*Math.PI*d,y=g*(1-u);return a.jsxs("div",{className:"ch-ring-wrap",children:[a.jsxs("svg",{width:t,height:t,className:"ch-ring-svg",children:[a.jsx("circle",{cx:t/2,cy:t/2,r:d,fill:"none",stroke:"var(--ch-ring-bg)",strokeWidth:i}),a.jsx("circle",{cx:t/2,cy:t/2,r:d,fill:"none",stroke:"var(--color-primary)",strokeWidth:i,strokeDasharray:g,strokeDashoffset:y,strokeLinecap:"round",style:{transition:"stroke-dashoffset 0.6s ease",transform:"rotate(-90deg)",transformOrigin:"50% 50%"}})]}),a.jsxs("div",{className:"ch-ring-centre",children:[a.jsxs("span",{className:"ch-ring-num",children:[s,a.jsxs("span",{className:"ch-ring-slash",children:[" / ",e]})]}),l&&a.jsx("span",{className:"ch-ring-label",children:l})]})]})}const mx={easy:"#34C759",medium:"#FF9500",hard:"#FF3B30"};async function lO(s,e,t){const i=t instanceof Pt?t:Pt.fromDate(new Date(t)),l=Pt.now();switch(s.type){case"workouts":{const u=Xt(lt(me,"workoutLogs"),wt("clientId","==",e),wt("completedAt",">=",i),wt("completedAt","<=",l));return(await Ft(u)).size}case"minutes":{const u=Xt(lt(me,"workoutLogs"),wt("clientId","==",e),wt("completedAt",">=",i),wt("completedAt","<=",l));return(await Ft(u)).docs.reduce((g,y)=>g+(y.data().duration||0),0)}case"habits_perfect":{const u=i.toDate().toISOString().slice(0,10),d=new Date().toISOString().slice(0,10),g=Xt(lt(me,"habitLogs"),wt("clientId","==",e));return(await Ft(g)).docs.filter(p=>{const b=p.data().date;if(b<u||b>d)return!1;const j=p.data().habits||{};return Object.values(j).length>0&&Object.values(j).every(S=>S===!0)}).length}case"streak":{const u=Xt(lt(me,"workoutLogs"),wt("clientId","==",e),wt("completedAt",">=",i),wt("completedAt","<=",l)),d=await Ft(u),g=new Set(d.docs.map(j=>j.data().completedAt.toDate().toISOString().slice(0,10)));let y=0;const p=new Date(i.toDate()),b=new Date;for(;g.has(p.toISOString().slice(0,10))&&p<=b;)y++,p.setDate(p.getDate()+1);return y}default:return 0}}function cO(){const{currentUser:s,clientData:e,loading:t}=Dr(),{isDark:i,toggleTheme:l}=Di(),{isPremium:u}=uc(),d=Qs(),[g,y]=w.useState(null),[p,b]=w.useState(null),[j,S]=w.useState(0),[R,H]=w.useState(0),[K,B]=w.useState(!0),[Y,Q]=w.useState(!1),[Z,ge]=w.useState(null),[xe,pe]=w.useState(null),[I,T]=w.useState(!1),[L,V]=w.useState(null),P=w.useCallback((Ne,ze="info")=>{pe({message:Ne,type:ze}),setTimeout(()=>pe(null),4e3)},[]);w.useEffect(()=>{!t&&!s&&d("/")},[t,s,d]);const D=w.useCallback(async()=>{if(e){B(!0);try{const Ne=Xt(lt(me,"userChallenges"),wt("clientId","==",e.id),wt("status","==","active")),ze=await Ft(Ne);if(ze.empty)y(null),b(null);else{const Ce=ze.docs[0],Se={id:Ce.id,...Ce.data()},ve=wh.find(Oe=>Oe.id===Se.challengeId);if(Se.endDate.toDate()<new Date)await zn(He(me,"userChallenges",Ce.id),{status:"failed"}),y(null),b(null),P("Challenge expired  time ran out","error");else if(y(Se),b(ve),ve){const Oe=await lO(ve,e.id,Se.startDate);if(S(Oe),Oe>=ve.goal&&Se.status==="active"){if(await zn(He(me,"userChallenges",Ce.id),{status:"completed",completedAt:ws()}),T(!0),y(Fe=>Fe?{...Fe,status:"completed"}:null),!Se.badgeAwarded){const Fe=Kr.find(Ge=>Ge.id===ve.id);if(Fe)try{const Ge=He(me,"coreBuddyBadges",e.id),tt=await xs(Ge),sn=tt.exists()?tt.data().earned||[]:[];if(!sn.some(Tt=>Tt.id===Fe.id)){const Tt={id:Fe.id,earnedAt:new Date().toISOString()};tt.exists()?await zn(Ge,{earned:[...sn,Tt]}):await _s(Ge,{earned:[Tt]})}await zn(He(me,"userChallenges",Ce.id),{badgeAwarded:!0}),await ir(lt(me,"posts"),{authorId:e.id,authorName:e.name||"Anonymous",authorPhotoURL:e.photoURL||null,type:"badge_earned",metadata:{title:Fe.name,badgeDesc:Fe.desc,badgeId:Fe.id},createdAt:ws(),likeCount:0,commentCount:0}),V(Fe)}catch(Ge){console.error("Badge award failed:",Ge)}}typeof fbq=="function"&&fbq("trackCustom","ChallengeCompleted",{challenge_name:ve.name,challenge_type:ve.type,duration_days:ve.duration})}}}const U=Xt(lt(me,"userChallenges"),wt("clientId","==",e.id),wt("status","==","completed")),le=await Ft(U);H(le.size)}catch(Ne){console.error("Failed to load challenges:",Ne)}finally{B(!1)}}},[e,P]);w.useEffect(()=>{D()},[D]);const M=async Ne=>{if(!(!e||Y)){Q(!0);try{const ze=wh.find(ve=>ve.id===Ne);if(!ze)return;const U=Xt(lt(me,"userChallenges"),wt("clientId","==",e.id),wt("status","==","active"));if(!(await Ft(U)).empty){ge(null),P("You already have an active challenge","info"),await D();return}const Ce=Pt.now(),Se=Pt.fromDate(new Date(Date.now()+ze.duration*864e5));await ir(lt(me,"userChallenges"),{clientId:e.id,challengeId:Ne,startDate:Ce,endDate:Se,status:"active",completedAt:null,badgeAwarded:!1,createdAt:ws()}),ge(null),P(`${ze.name} started  let's go!`,"success"),await D()}catch(ze){console.error("Start challenge failed:",ze),ze?.code==="permission-denied"?P("Permission denied  please re-login and try again","error"):P("Something went wrong  try again","error")}finally{Q(!1)}}},Me=async()=>{if(!(!g||Y)){Q(!0);try{await zn(He(me,"userChallenges",g.id),{status:"failed"}),y(null),b(null),S(0),ge(null),P("Challenge abandoned","info"),await D()}catch(Ne){console.error("Give up failed:",Ne),P("Something went wrong","error")}finally{Q(!1)}}},st=g?.endDate?Math.max(0,Math.ceil((g.endDate.toDate()-new Date)/864e5)):0,J=()=>{if(!p||!g)return"";const Ne=Math.max(1,Math.ceil((Date.now()-g.startDate.toDate())/864e5)),ze=p.goal/p.duration*Ne;return j>=ze*1.15?"Ahead":j>=ze*.85?"On Track":"Behind"};if(t||!e)return a.jsx("div",{className:"ch-loading",children:a.jsx("div",{className:"ch-spinner"})});const Te=g&&g.status==="active"&&p,Ue=I||g&&g.status==="completed";return a.jsxs("div",{className:"ch-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Back",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M19 12H5"}),a.jsx("path",{d:"M12 19l-7-7 7-7"})]})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:l,"aria-label":"Toggle theme",children:i?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"ch-main",children:[a.jsx("h1",{className:"ch-title",children:"Challenges"}),a.jsx("p",{className:"ch-subtitle",children:"Push yourself with timed fitness challenges"}),K?a.jsx("div",{className:"ch-loading",children:a.jsx("div",{className:"ch-spinner"})}):Ue?a.jsxs("div",{className:"ch-completed-section",children:[a.jsx(fx,{progress:p?.goal||1,goal:p?.goal||1,label:"Complete"}),a.jsx("div",{className:"ch-completed-pulse"}),a.jsx("h2",{className:"ch-completed-heading",children:"Challenge Complete!"}),a.jsx("p",{className:"ch-completed-name",children:p?.name}),a.jsxs("p",{className:"ch-completed-count",children:[R+(I?1:0)," challenge",R!==0?"s":""," completed"]}),a.jsx("button",{className:"ch-btn ch-btn-primary",onClick:()=>{T(!1),y(null),b(null),D()},children:"Choose Next Challenge"})]}):Te?a.jsxs("div",{className:"ch-active-section",children:[a.jsx(fx,{progress:j,goal:p.goal,label:p.type==="minutes"?"minutes":p.type==="streak"?"day streak":p.type==="habits_perfect"?"perfect days":"workouts"}),a.jsxs("div",{className:"ch-active-info",children:[a.jsxs("div",{className:"ch-info-row",children:[a.jsxs("div",{className:"ch-info-item",children:[a.jsx("span",{className:"ch-info-val",children:st}),a.jsx("span",{className:"ch-info-key",children:"days left"})]}),a.jsx("div",{className:`ch-pace ch-pace-${J().toLowerCase().replace(" ","")}`,children:J()})]}),a.jsx("h2",{className:"ch-active-name",children:p.name}),a.jsx("p",{className:"ch-active-desc",children:p.description})]}),a.jsx("button",{className:"ch-give-up",onClick:()=>ge("giveup"),children:"Give Up"}),a.jsxs("div",{className:"ch-browse-locked",children:[a.jsx("p",{className:"ch-browse-locked-note",children:"Complete your current challenge to start a new one"}),a.jsx("div",{className:"ch-grid ch-grid-dimmed",children:wh.filter(Ne=>Ne.id!==p.id).map(Ne=>a.jsxs("div",{className:"ch-card ch-card-locked",children:[a.jsx("div",{className:"ch-card-icon",children:a.jsx(gp,{icon:Ne.icon,size:24})}),a.jsxs("div",{className:"ch-card-body",children:[a.jsx("h3",{children:Ne.name}),a.jsx("p",{children:Ne.description})]})]},Ne.id))})]})]}):a.jsxs("div",{className:"ch-browse-section",children:[!u&&a.jsxs("div",{className:"ch-premium-banner",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{children:"Challenges are a premium feature"}),a.jsx("button",{className:"ch-upgrade-link",onClick:()=>d("/upgrade"),children:"Upgrade"})]}),a.jsx("div",{className:"ch-grid",children:wh.map(Ne=>a.jsxs("button",{className:`ch-card${u?"":" ch-card-gated"}`,onClick:()=>u?ge(Ne):d("/upgrade"),children:[!u&&a.jsx("div",{className:"ch-lock-overlay",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),a.jsx("div",{className:"ch-card-icon",children:a.jsx(gp,{icon:Ne.icon})}),a.jsxs("div",{className:"ch-card-body",children:[a.jsx("h3",{children:Ne.name}),a.jsx("p",{children:Ne.description}),a.jsxs("div",{className:"ch-card-tags",children:[a.jsxs("span",{className:"ch-tag ch-tag-dur",children:[Ne.duration," days"]}),a.jsx("span",{className:"ch-tag ch-tag-diff",style:{color:mx[Ne.difficulty]},children:Ne.difficulty})]})]}),a.jsx("svg",{className:"ch-card-arrow",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]},Ne.id))})]})]}),Z&&Z!=="giveup"&&a.jsx("div",{className:"ch-modal-backdrop",onClick:()=>!Y&&ge(null),children:a.jsxs("div",{className:"ch-modal",onClick:Ne=>Ne.stopPropagation(),children:[a.jsx("div",{className:"ch-modal-icon",children:a.jsx(gp,{icon:Z.icon,size:36})}),a.jsx("h2",{children:Z.name}),a.jsx("p",{children:Z.description}),a.jsxs("div",{className:"ch-modal-details",children:[a.jsxs("span",{children:[Z.duration," days"]}),a.jsx("span",{style:{color:mx[Z.difficulty]},children:Z.difficulty})]}),a.jsx("button",{className:"ch-btn ch-btn-primary",onClick:()=>M(Z.id),disabled:Y,children:Y?"Starting...":"Start Challenge"}),a.jsx("button",{className:"ch-btn ch-btn-secondary",onClick:()=>ge(null),disabled:Y,children:"Cancel"})]})}),Z==="giveup"&&a.jsx("div",{className:"ch-modal-backdrop",onClick:()=>!Y&&ge(null),children:a.jsxs("div",{className:"ch-modal",onClick:Ne=>Ne.stopPropagation(),children:[a.jsx("h2",{children:"Give Up?"}),a.jsx("p",{children:"Your progress will be lost and this challenge will be marked as failed."}),a.jsx("button",{className:"ch-btn ch-btn-danger",onClick:Me,disabled:Y,children:Y?"Abandoning...":"Yes, Give Up"}),a.jsx("button",{className:"ch-btn ch-btn-secondary",onClick:()=>ge(null),disabled:Y,children:"Keep Going"})]})}),a.jsx(Wl,{badge:L,onDismiss:()=>V(null)}),xe&&a.jsx("div",{className:`ch-toast ch-toast-${xe.type}`,children:xe.message}),a.jsx(Xr,{})]})}const uO={workouts:"Workouts",streaks:"Streaks",nutrition:"Nutrition",leaderboard:"Leaderboard",habits:"Habits",challenges:"Challenges"},dO=["workouts","streaks","nutrition","leaderboard","habits","challenges"];function hO(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Dr(),{isDark:l,toggleTheme:u}=Di(),d=Qs(),[g,y]=w.useState(new Set),[p,b]=w.useState({}),[j,S]=w.useState(!0),[R,H]=w.useState(null);w.useEffect(()=>{!i&&(!s||!e)&&d("/")},[s,e,i,d]),w.useEffect(()=>{t&&(async()=>{S(!0);try{const Y=await xs(He(me,"coreBuddyBadges",t.id));if(Y.exists()){const Q=Y.data().earned||[];y(new Set(Q.map(ge=>ge.id)));const Z={};Q.forEach(ge=>{Z[ge.id]=ge}),b(Z)}}catch(Y){console.error("Failed to load badges:",Y)}finally{S(!1)}})()},[t]);const K=dO.map(Y=>({key:Y,label:uO[Y],badges:Kr.filter(Q=>Q.category===Y)})).filter(Y=>Y.badges.length>0),B=Kr.filter(Y=>g.has(Y.id)).length;return i||!t?a.jsx("div",{className:"bdg-loading",children:a.jsx("div",{className:"bdg-spinner"})}):a.jsxs("div",{className:"bdg-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Back",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M19 12H5"}),a.jsx("path",{d:"M12 19l-7-7 7-7"})]})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"bdg-main",children:[a.jsx("h1",{className:"bdg-title",children:"Badges"}),a.jsxs("p",{className:"bdg-subtitle",children:[B," / ",Kr.length," earned"]}),j?a.jsx("div",{className:"bdg-loading-inline",children:a.jsx("div",{className:"bdg-spinner"})}):K.map(Y=>a.jsxs("div",{className:"bdg-category",children:[a.jsx("h2",{className:"bdg-category-title",children:Y.label}),a.jsx("div",{className:"bdg-grid",children:Y.badges.map(Q=>{const Z=g.has(Q.id);return a.jsxs("button",{className:`bdg-item${Z?" earned":" locked"}`,onClick:()=>H(Q),children:[a.jsxs("div",{className:"bdg-img-wrap",children:[Q.img?a.jsx("img",{src:Q.img,alt:Q.name,className:"bdg-img",loading:"lazy"}):a.jsx("div",{className:"bdg-img-placeholder",children:a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("circle",{cx:"12",cy:"8",r:"6"}),a.jsx("path",{d:"M9 14l-4 8h14l-4-8"})]})}),!Z&&a.jsx("div",{className:"bdg-lock-overlay",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})})]}),a.jsx("span",{className:"bdg-name",children:Q.name})]},Q.id)})})]},Y.key))]}),R&&a.jsx("div",{className:"bdg-modal-backdrop",onClick:()=>H(null),children:a.jsxs("div",{className:"bdg-modal",onClick:Y=>Y.stopPropagation(),children:[a.jsx("div",{className:`bdg-modal-img-wrap${g.has(R.id)?" earned":" locked"}`,children:R.img?a.jsx("img",{src:R.img,alt:R.name,className:"bdg-modal-img"}):a.jsx("div",{className:"bdg-modal-placeholder",children:a.jsxs("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("circle",{cx:"12",cy:"8",r:"6"}),a.jsx("path",{d:"M9 14l-4 8h14l-4-8"})]})})}),a.jsx("h2",{className:"bdg-modal-name",children:R.name}),a.jsx("p",{className:"bdg-modal-desc",children:R.desc}),g.has(R.id)?a.jsxs("span",{className:"bdg-modal-status earned",children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})}),"Earned",p[R.id]?.earnedAt?`  ${new Date(p[R.id].earnedAt).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}`:""]}):a.jsxs("span",{className:"bdg-modal-status locked",children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),"Locked"]}),a.jsx("button",{className:"bdg-modal-close",onClick:()=>H(null),children:"Close"})]})}),a.jsx(Xr,{active:"badges"})]})}const fO=w.lazy(()=>Ys(()=>import("./Dashboard-CWaQTxY7.js"),__vite__mapDeps([0,1,2]))),mO=w.lazy(()=>Ys(()=>import("./AddClient-BYlyoXxi.js"),__vite__mapDeps([3,4]))),gO=w.lazy(()=>Ys(()=>import("./ClientDashboard-hqNAETvV.js"),__vite__mapDeps([5,1,6]))),pO=w.lazy(()=>Ys(()=>import("./ClientForms-DoX1_17k.js"),__vite__mapDeps([7,8,6]))),yO=w.lazy(()=>Ys(()=>import("./ClientTools-DdBf-BNM.js"),__vite__mapDeps([9,10,6]))),vO=w.lazy(()=>Ys(()=>import("./MacroCalculator-DY7EBZnx.js"),__vite__mapDeps([11,10,6]))),bO=w.lazy(()=>Ys(()=>import("./ProteinSnacks-CgAX18L0.js"),__vite__mapDeps([12,10,6]))),wO=w.lazy(()=>Ys(()=>import("./DailyMotivation-C-WpUR0X.js"),__vite__mapDeps([13,10,6]))),xO=w.lazy(()=>Ys(()=>import("./CircuitDashboard-fHHRm4CA.js"),__vite__mapDeps([14,15]))),_O=w.lazy(()=>Ys(()=>import("./CircuitBooking-CrNT0XkP.js"),__vite__mapDeps([16,17,15]))),kO=w.lazy(()=>Ys(()=>import("./PersonalBests-CYli7v6P.js"),__vite__mapDeps([18,19,6]))),jO=w.lazy(()=>Ys(()=>import("./Leaderboard-ClXB510Z.js"),__vite__mapDeps([20,21]))),EO=w.lazy(()=>Ys(()=>import("./UpgradePage-CCpR5Ys_.js"),__vite__mapDeps([22,23,24]))),TO=w.lazy(()=>Ys(()=>import("./SignUp-2FHPqB4M.js"),[])),SO=w.lazy(()=>Ys(()=>import("./Onboarding-BXl4HbkY.js"),__vite__mapDeps([25,23,26])));function CO({children:s}){const{pathname:e}=Mi();return w.useEffect(()=>{"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")},[]),w.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"})},[e]),s}function NO(){const s=Qs();return w.useEffect(()=>{const e=sessionStorage.getItem("redirect");if(e){sessionStorage.removeItem("redirect");const t=e.replace("/login","")||"/";s(t,{replace:!0})}},[s]),null}function AO(){return a.jsx(JD,{children:a.jsx(XD,{children:a.jsx(s3,{children:a.jsxs(oC,{basename:"/login",children:[a.jsx(NO,{}),a.jsx(CO,{children:a.jsx(w.Suspense,{fallback:a.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"60vh"},children:a.jsx("div",{style:{width:36,height:36,border:"3px solid var(--color-primary-light)",borderTopColor:"var(--color-primary)",borderRadius:"50%",animation:"app-spin .7s linear infinite"}})}),children:a.jsxs(OS,{children:[a.jsx(Sn,{path:"/",element:a.jsx(a3,{})}),a.jsx(Sn,{path:"/dashboard",element:a.jsx(fO,{})}),a.jsx(Sn,{path:"/add-client",element:a.jsx(mO,{})}),a.jsx(Sn,{path:"/client",element:a.jsx(gO,{})}),a.jsx(Sn,{path:"/client/forms",element:a.jsx(pO,{})}),a.jsx(Sn,{path:"/client/tools",element:a.jsx(yO,{})}),a.jsx(Sn,{path:"/client/tools/macros",element:a.jsx(vO,{})}),a.jsx(Sn,{path:"/client/tools/snacks",element:a.jsx(bO,{})}),a.jsx(Sn,{path:"/client/tools/motivation",element:a.jsx(wO,{})}),a.jsx(Sn,{path:"/client/personal-bests",element:a.jsx(kO,{})}),a.jsx(Sn,{path:"/client/circuit",element:a.jsx(xO,{})}),a.jsx(Sn,{path:"/client/circuit/booking",element:a.jsx(_O,{})}),a.jsx(Sn,{path:"/client/core-buddy",element:a.jsx(N3,{})}),a.jsx(Sn,{path:"/client/core-buddy/nutrition",element:a.jsx(ph,{feature:"nutrition",children:a.jsx(I3,{})})}),a.jsx(Sn,{path:"/client/core-buddy/workouts",element:a.jsx(m5,{})}),a.jsx(Sn,{path:"/client/core-buddy/consistency",element:a.jsx(ph,{feature:"consistency",children:a.jsx(_5,{})})}),a.jsx(Sn,{path:"/client/core-buddy/buddies",element:a.jsx(ph,{feature:"buddies",children:a.jsx(j5,{})})}),a.jsx(Sn,{path:"/client/core-buddy/builder",element:a.jsx(C5,{})}),a.jsx(Sn,{path:"/client/core-buddy/profile/:userId",element:a.jsx(T5,{})}),a.jsx(Sn,{path:"/client/core-buddy/settings",element:a.jsx(oO,{})}),a.jsx(Sn,{path:"/client/core-buddy/challenges",element:a.jsx(cO,{})}),a.jsx(Sn,{path:"/client/core-buddy/badges",element:a.jsx(hO,{})}),a.jsx(Sn,{path:"/client/leaderboard",element:a.jsx(ph,{feature:"leaderboard",children:a.jsx(jO,{})})}),a.jsx(Sn,{path:"/signup",element:a.jsx(TO,{})}),a.jsx(Sn,{path:"/onboarding",element:a.jsx(SO,{})}),a.jsx(Sn,{path:"/upgrade",element:a.jsx(EO,{})}),a.jsx(Sn,{path:"*",element:a.jsx(Cx,{to:"/",replace:!0})})]})})})]})})})})}OT.createRoot(document.getElementById("root")).render(a.jsx(w.StrictMode,{children:a.jsx(AO,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/login/sw.js").then(s=>{setInterval(()=>s.update(),3600*1e3)}).catch(s=>console.warn("SW registration failed:",s))});export{r3 as A,Wl as B,Xr as C,IO as D,ws as E,nl as P,Pt as T,ir as a,rr as b,lt as c,me as d,He as e,QA as f,Ft as g,t4 as h,_s as i,a as j,xs as k,Dr as l,Di as m,Qs as n,qo as o,Tj as p,Xt as q,w as r,DO as s,RO as t,zn as u,LO as v,wt as w,ef as x,uc as y,i3 as z};
