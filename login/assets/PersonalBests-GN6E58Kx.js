import{r as h,l as bs,m as xs,n as js,q as Re,c as Le,d as B,w as Fe,g as We,j as e,i as ae,e as G,T as I,b as vs,p as fs}from"./index-C-N-wVvC.js";import{T as ys}from"./ringTicks-DmxOeRVl.js";/* empty css                        */import{P as Ns}from"./PullToRefresh-zF8cwWs3.js";const Z=[{key:"pressUps",name:"Press-Ups",category:"Upper Body",unit:"reps"},{key:"squats",name:"Squats",category:"Lower Body",unit:"reps"},{key:"longJump",name:"Standing Long Jump",category:"Power",unit:"distance"},{key:"deadHang",name:"Dead Hang",category:"Upper Body",unit:"time"},{key:"plank",name:"Plank",category:"Core",unit:"time"},{key:"wallSit",name:"Wall Sit",category:"Lower Body",unit:"time"},{key:"chestPress",name:"Chest Press",category:"Upper Body",unit:"weight"}],Ce=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function ws(){const o=new Date;return`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}`}function K(o){const[d,p]=o.split("-");return new Date(parseInt(d),parseInt(p)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function Ts(o){if(!o&&o!==0)return"-";const d=Math.floor(o/60),p=(o%60).toFixed(2);return d>0?`${d}m ${parseFloat(p).toFixed(0)}s`:`${parseFloat(p).toFixed(2)}s`}function Cs(o,d){return!o&&o!==0?"-":!d&&d!==0?`${o}kg`:`${o}kg x ${d}`}function ss(o,d){if(!d)return"-";switch(o.unit){case"weight":return Cs(d.weight,d.reps);case"time":return Ts(d.time);case"reps":return d.reps?`${d.reps} reps`:"-";case"distance":return d.distance?`${d.distance} cm`:"-";default:return"-"}}function Be(o,d){if(!d)return 0;switch(o.unit){case"weight":return(d.weight||0)*(d.reps||0);case"time":return d.time||0;case"reps":return d.reps||0;case"distance":return d.distance||0;default:return 0}}function ps(o,d){return!d||d===0?null:(o-d)/d*100}function Ms({data:o,exerciseKey:d,unit:p}){if(!o||o.length<2)return e.jsx("div",{className:"pb-trend-empty",children:e.jsx("p",{children:"Not enough data for trend line yet"})});const F=o.map(x=>{const u=x.benchmarks?.[d];if(!u)return 0;switch(p){case"weight":return(u.weight||0)*(u.reps||0);case"time":return u.time||0;case"reps":return u.reps||0;case"distance":return u.distance||0;default:return 0}}),me=Math.max(...F),re=Math.min(...F),y=me-re||1,v=300,k=100,S=20,Y=v-S*2,M=k-S*2,R=F.map((x,u)=>{const A=S+u/(F.length-1)*Y,O=S+M-(x-re)/y*M;return{x:A,y:O,value:x}}),W=R.map((x,u)=>`${u===0?"M":"L"} ${x.x} ${x.y}`).join(" "),ne=W+` L ${R[R.length-1].x} ${S+M} L ${R[0].x} ${S+M} Z`;return e.jsxs("div",{className:"pb-trend-chart",children:[e.jsxs("svg",{viewBox:`0 0 ${v} ${k}`,preserveAspectRatio:"xMidYMid meet",children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"trendGradientJr",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),e.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),e.jsx("path",{d:ne,fill:"url(#trendGradientJr)"}),e.jsx("path",{d:W,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),R.map((x,u)=>e.jsx("circle",{cx:x.x,cy:x.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},u))]}),e.jsx("div",{className:"pb-trend-labels",children:o.map((x,u)=>e.jsxs("span",{className:"pb-trend-label",children:[x.month.split("-")[1],"/",x.month.split("-")[0].slice(2)]},u))})]})}function $s(){const[o,d]=h.useState("bests"),[p,F]=h.useState([]),[me,re]=h.useState(!0),[y,v]=h.useState(!1),[k,S]=h.useState(0),[Y,M]=h.useState(!1),[R,W]=h.useState(!1),[ne,x]=h.useState(!1),[u,A]=h.useState({}),[O,U]=h.useState({}),[T,pe]=h.useState({}),[C,ue]=h.useState({}),[f,z]=h.useState({}),[Ae,ie]=h.useState(!1),[ge,H]=h.useState({}),[w,Ee]=h.useState([]),[ce,be]=h.useState(null),[le,xe]=h.useState(null),[q,as]=h.useState(!1),[oe,De]=h.useState(""),[de,Pe]=h.useState(""),rs=h.useRef(null),Ie=h.useRef(0),X=h.useRef(0),Oe=h.useRef("right"),J=h.useCallback(s=>{S(t=>{const a=Math.max(0,Math.min(Z.length-1,s));return a===t?t:(Oe.current=a>t?"right":"left",a)})},[]),{currentUser:je,isClient:ve,clientData:b,loading:ye}=bs(),{isDark:ks}=xs(),E=js(),_=h.useCallback((s,t="info")=>{xe({message:s,type:t}),setTimeout(()=>xe(null),4e3)},[]);h.useEffect(()=>{!ye&&(!je||!ve)&&E("/")},[je,ve,ye,E]),h.useEffect(()=>{b&&P()},[b]);const P=async()=>{try{const s=Re(Le(B,"juniorPBs"),Fe("clientId","==",b.id)),a=(await We(s)).docs.map(i=>({id:i.id,...i.data()}));a.sort((i,c)=>i.month.localeCompare(c.month)),F(a);const r=Re(Le(B,"juniorPBTargets"),Fe("clientId","==",b.id)),n=await We(r);if(!n.empty){const i=n.docs[0].data();pe(i.targets||{}),ue(i.metricTargets||{}),z(i.targets||{}),H(i.metricTargets||{})}const l=Re(Le(B,"juniorAchievements"),Fe("clientId","==",b.id)),g=await We(l);g.empty||Ee(g.docs[0].data().badges||[])}catch(s){console.error("Error fetching junior personal bests:",s)}re(!1)},D=ws(),j=p.find(s=>s.month===D),N=p.filter(s=>s.month<D),$e=N.length>0?N[N.length-1]:null;h.useEffect(()=>{j?(A(j.benchmarks||{}),U(j.bodyMetrics||{})):(A({}),U({}))},[j?.id]);const ze=async(s,t)=>{const a=[];if(s==="strength"?Z.forEach(r=>{const n=T[r.key];if(!n)return;const l=t[r.key];if(!l)return;let g;if(n.targetType==="time"){if(!n.targetValue)return;const i=n.startValue||0,c=l.time||0,m=n.targetValue-i;g=m===0?c>=n.targetValue?1:0:Math.max(0,(c-i)/m)}else if(n.targetType==="reps"){if(!n.targetReps)return;const i=n.startReps||0,c=l.reps||0,m=n.targetReps-i;g=m===0?c>=n.targetReps?1:0:Math.max(0,(c-i)/m)}else if(n.targetType==="distance"){if(!n.targetDistance)return;const i=n.startDistance||0,c=l.distance||0,m=n.targetDistance-i;g=m===0?c>=n.targetDistance?1:0:Math.max(0,(c-i)/m)}else{if(!n.targetWeight&&!n.targetReps)return;const i=(n.startWeight||0)*(n.startReps||0),c=(n.targetWeight||0)*(n.targetReps||0),m=(l.weight||0)*(l.reps||0),$=c-i;g=$===0?m>=c?1:0:Math.max(0,(m-i)/$)}if(g>=1){let i,c;n.targetType==="time"?(i=w.some(m=>m.type==="strength"&&m.key===r.key&&m.targetValue===n.targetValue),c=`${r.name} ${n.targetValue}s`):n.targetType==="reps"?(i=w.some(m=>m.type==="strength"&&m.key===r.key&&m.targetReps===n.targetReps),c=`${r.name} ${n.targetReps} reps`):n.targetType==="distance"?(i=w.some(m=>m.type==="strength"&&m.key===r.key&&m.targetDistance===n.targetDistance),c=`${r.name} ${n.targetDistance}cm`):(i=w.some(m=>m.type==="strength"&&m.key===r.key&&m.targetWeight===n.targetWeight&&m.targetReps===n.targetReps),c=`${r.name} ${n.targetWeight}kg × ${n.targetReps}`),i||a.push({type:"strength",key:r.key,...n.targetType==="time"?{targetType:"time",targetValue:n.targetValue}:n.targetType==="reps"?{targetType:"reps",targetReps:n.targetReps}:n.targetType==="distance"?{targetType:"distance",targetDistance:n.targetDistance}:{targetWeight:n.targetWeight,targetReps:n.targetReps},achievedMonth:D,label:c})}}):Ce.forEach(r=>{const n=C[r.key];if(!n||!n.targetValue)return;const l=t[r.key];if(l==null)return;const g=n.startValue||0,i=n.targetValue,c=i-g;(c===0?l===i?1:0:Math.max(0,(l-g)/c))>=1&&(w.some(Te=>Te.type==="metric"&&Te.key===r.key&&Te.targetValue===i)||a.push({type:"metric",key:r.key,targetValue:i,achievedMonth:D,label:`${r.name} ${i}${r.suffix}`}))}),a.length>0){const r=[...w,...a];await ae(G(B,"juniorAchievements",b.id),{clientId:b.id,badges:r,updatedAt:I.now()}),Ee(r),be(a),setTimeout(()=>be(null),5e3)}},He=(s,t)=>{if(s==="strength"){const a=T[t];if(!a)return!1;switch(Z.find(n=>n.key===t)?.unit){case"time":return w.some(n=>n.type==="strength"&&n.key===t&&n.targetValue===a.targetValue);case"reps":return w.some(n=>n.type==="strength"&&n.key===t&&n.targetReps===a.targetReps);case"distance":return w.some(n=>n.type==="strength"&&n.key===t&&n.targetDistance===a.targetDistance);default:return!a.targetWeight&&!a.targetReps?!1:w.some(n=>n.type==="strength"&&n.key===t&&n.targetWeight===a.targetWeight&&n.targetReps===a.targetReps)}}else{const a=C[t];return!a||!a.targetValue?!1:w.some(r=>r.type==="metric"&&r.key===t&&r.targetValue===a.targetValue)}},Je=async()=>{v(!0);try{const s=`${b.id}_${D}`,t=j||{};await ae(G(B,"juniorPBs",s),{clientId:b.id,month:D,benchmarks:u,bodyMetrics:t.bodyMetrics||O||{},createdAt:t.createdAt||I.now(),updatedAt:I.now()}),await ze("strength",u),_("Benchmarks saved!","success"),M(!1),await P()}catch(s){console.error("Error saving benchmarks:",s),_("Failed to save. Please try again.","error")}v(!1)},ns=async()=>{v(!0);try{const s=`${b.id}_${D}`,t=j||{};await ae(G(B,"juniorPBs",s),{clientId:b.id,month:D,benchmarks:t.benchmarks||u||{},bodyMetrics:O,createdAt:t.createdAt||I.now(),updatedAt:I.now()}),await ze("metric",O),_("Body metrics saved!","success"),W(!1),await P()}catch(s){console.error("Error saving metrics:",s),_("Failed to save. Please try again.","error")}v(!1)},ke=(s,t,a)=>{A(r=>({...r,[s]:{...r[s],[t]:a===""?"":parseFloat(a)}}))},_e=(s,t)=>{U(a=>({...a,[s]:t===""?"":parseFloat(t)}))},fe=(s,t,a)=>{z(r=>({...r,[s]:{...r[s],[t]:a===""?"":parseFloat(a)}}))},Ge=async()=>{v(!0);try{const s=`targets_${b.id}`,t=j?.benchmarks||{},a={};Z.forEach(r=>{const n=t[r.key];switch(r.unit){case"time":f[r.key]?.targetValue&&(a[r.key]={targetType:"time",targetValue:f[r.key].targetValue,startValue:n?.time||0});break;case"reps":f[r.key]?.targetReps&&(a[r.key]={targetType:"reps",targetReps:f[r.key].targetReps,startReps:n?.reps||0});break;case"distance":f[r.key]?.targetDistance&&(a[r.key]={targetType:"distance",targetDistance:f[r.key].targetDistance,startDistance:n?.distance||0});break;default:(f[r.key]?.targetWeight||f[r.key]?.targetReps)&&(a[r.key]={targetWeight:f[r.key].targetWeight||0,targetReps:f[r.key].targetReps||0,startWeight:n?.weight||0,startReps:n?.reps||0})}}),await ae(G(B,"juniorPBTargets",s),{clientId:b.id,targets:a,metricTargets:C,updatedAt:I.now()}),pe(a),z(a),_("Targets saved!","success"),x(!1)}catch(s){console.error("Error saving targets:",s),_("Failed to save targets.","error")}v(!1)},is=(s,t)=>{H(a=>({...a,[s]:{...a[s],targetValue:t===""?"":parseFloat(t)}}))},cs=async()=>{v(!0);try{const s=`targets_${b.id}`,t={};Ce.forEach(a=>{if(ge[a.key]?.targetValue){const r=j?.bodyMetrics?.[a.key]||0;t[a.key]={targetValue:ge[a.key].targetValue,startValue:r}}}),await ae(G(B,"juniorPBTargets",s),{clientId:b.id,targets:T,metricTargets:t,updatedAt:I.now()}),ue(t),H(t),_("Metric targets saved!","success"),ie(!1)}catch(s){console.error("Error saving metric targets:",s),_("Failed to save targets.","error")}v(!1)},Qe=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){v(!0);try{const s=G(B,"juniorPBTargets",`targets_${b.id}`);await vs(s),pe({}),ue({}),z({}),H({}),_("All goals have been reset","success")}catch(s){console.error("Error resetting targets:",s),_("Failed to reset goals","error")}v(!1)}},Ze=(s,t)=>{const a=T[s];if(!a||!t)return null;if(a.targetType==="time"){if(!a.targetValue)return null;const i=a.startValue||0,c=a.targetValue,m=t.time||0,$=c-i;return $<=0?m>=c?1:0:Math.max(0,Math.min((m-i)/$,1))}if(a.targetType==="reps"){if(!a.targetReps)return null;const i=a.startReps||0,c=a.targetReps,m=t.reps||0,$=c-i;return $<=0?m>=c?1:0:Math.max(0,Math.min((m-i)/$,1))}if(a.targetType==="distance"){if(!a.targetDistance)return null;const i=a.startDistance||0,c=a.targetDistance,m=t.distance||0,$=c-i;return $<=0?m>=c?1:0:Math.max(0,Math.min((m-i)/$,1))}if(!a.targetWeight&&!a.targetReps)return null;const r=(a.startWeight||0)*(a.startReps||0),n=(a.targetWeight||0)*(a.targetReps||0),l=(t.weight||0)*(t.reps||0),g=n-r;return g<=0?l>=n?1:0:Math.max(0,Math.min((l-r)/g,1))},ls=s=>{const t=C[s];if(!t||!t.targetValue)return null;const a=j?.bodyMetrics?.[s];if(a==null)return null;const r=t.startValue||0,n=t.targetValue,l=n-r;return l===0?a===n?1:0:Math.max(0,Math.min((a-r)/l,1))},os=s=>{Ie.current=s.touches[0].clientX,X.current=0},ds=s=>{X.current=s.touches[0].clientX-Ie.current},hs=()=>{X.current<-50?J(k+1):X.current>50&&J(k-1),X.current=0},ms=s=>{const t=j?.bodyMetrics?.[s],a=$e?.bodyMetrics?.[s];return t==null||a==null?null:parseFloat((t-a).toFixed(2))},Ye=p.find(s=>s.month===oe),Ne=p.find(s=>s.month===de);if(ye||me)return e.jsxs("div",{className:"pb-page",children:[e.jsx("header",{className:"client-header",children:e.jsx("div",{className:"header-content",children:e.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),e.jsxs("main",{className:"pb-main",children:[e.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),e.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!je||!ve||!b)return null;const L=Z[k],V=j?.benchmarks?.[L.key],he=$e?.benchmarks?.[L.key],Ke=Be(L,V),es=Be(L,he),we=ps(Ke,es),se=Ze(L.key,V),Ve=se!==null,Ue=se!==null&&se>=1,qe=Ve?Math.round(se*60):Ke>0?15:0,Xe=T[L.key],Q=s=>s?s.targetType==="time"?`${s.startValue||0}s → ${s.targetValue}s`:s.targetType==="reps"?`${s.startReps||0} → ${s.targetReps} reps`:s.targetType==="distance"?`${s.startDistance||0} → ${s.targetDistance}cm`:`${s.startWeight||0}kg×${s.startReps||0} → ${s.targetWeight}kg×${s.targetReps}`:null;return e.jsxs("div",{className:"pb-page",children:[e.jsx("header",{className:"client-header",children:e.jsxs("div",{className:"header-content",children:[e.jsx("button",{className:"header-back-btn",onClick:()=>E("/client"),"aria-label":"Go back",children:e.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M15 18l-6-6 6-6"})})}),e.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),e.jsxs("main",{className:"pb-main page-transition-enter",children:[e.jsxs("div",{className:"pb-intro",children:[e.jsx("h2",{children:"Junior Strength Tests"}),e.jsx("p",{children:"Track your strength test results and body measurements each month."})]}),e.jsxs("div",{className:"pb-tabs",children:[e.jsx("button",{className:`pb-tab ${o==="bests"?"active":""}`,onClick:()=>d("bests"),children:"Strength"}),e.jsx("button",{className:`pb-tab ${o==="metrics"?"active":""}`,onClick:()=>d("metrics"),children:"Body Metrics"}),e.jsx("button",{className:`pb-tab ${o==="history"?"active":""}`,onClick:()=>d("history"),children:"History"})]}),o==="bests"&&e.jsxs("div",{className:"pb-strength-section",children:[!Y&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"pb-carousel",ref:rs,onTouchStart:os,onTouchMove:ds,onTouchEnd:hs,children:[e.jsx("div",{className:`pb-ring-container slide-from-${Oe.current}`,children:e.jsxs("div",{className:"pb-ring",children:[e.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:ys.map((s,t)=>{const a=t<Math.round(qe);return e.jsx("line",{x1:s.x1,y1:s.y1,x2:s.x2,y2:s.y2,className:`pb-ring-tick ${a?Ue?"hit":"filled":"empty"}`,strokeWidth:s.thick?"3":"2"},t)})}),e.jsxs("div",{className:"pb-ring-center",children:[e.jsx("div",{className:"pb-ring-category",children:L.category}),e.jsxs("div",{className:"pb-ring-exercise",children:[L.name,He("strength",L.key)&&e.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),e.jsx("div",{className:"pb-ring-value",children:V?ss(L,V):"-"}),we!==null&&e.jsxs("div",{className:`pb-ring-change ${we>=0?"positive":"negative"}`,children:[we>=0?"+":"",we.toFixed(1),"%"]}),we===null&&V&&e.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),Xe&&e.jsx("div",{className:`pb-ring-target ${Ue?"hit":""}`,children:Ue?"Target hit!":Q(Xe)}),!Xe&&e.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},k),e.jsx("div",{className:"pb-carousel-dots",children:Z.map((s,t)=>e.jsx("button",{className:`pb-dot ${t===k?"active":""}`,onClick:()=>J(t)},t))}),e.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>J(k-1),disabled:k===0,children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),e.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>J(k+1),disabled:k===Z.length-1,children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),e.jsxs("div",{className:"pb-trend-section",children:[e.jsx("h4",{children:"Trend"}),e.jsx(Ms,{data:p,exerciseKey:L.key,unit:L.unit})]})]}),!Y&&!ne&&e.jsxs("div",{className:"pb-action-buttons",children:[e.jsx("button",{className:"pb-edit-btn",onClick:()=>M(!0),children:j?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),e.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>x(!0),children:Object.keys(T).length>0?"Edit Targets":"Set Targets"}),(Object.keys(T).length>0||Object.keys(C).length>0)&&e.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:Qe,disabled:y,children:"Reset All Goals"})]}),Y&&e.jsxs("div",{className:"pb-edit-card",children:[e.jsxs("div",{className:"pb-edit-header",children:[e.jsxs("h3",{children:["Benchmarks - ",K(D)]}),e.jsx("button",{className:"pb-edit-close",onClick:()=>{M(!1),A(j?.benchmarks||{})},children:"×"})]}),e.jsx("div",{className:"pb-edit-body",children:Z.map(s=>e.jsxs("div",{className:"pb-edit-exercise",children:[e.jsx("div",{className:"pb-edit-exercise-name",children:s.name}),s.unit==="weight"?e.jsxs("div",{className:"pb-edit-row",children:[e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Weight (kg)"}),e.jsx("input",{type:"number",step:"0.5",value:u[s.key]?.weight??"",onChange:t=>ke(s.key,"weight",t.target.value),placeholder:"0"})]}),e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Reps"}),e.jsx("input",{type:"number",value:u[s.key]?.reps??"",onChange:t=>ke(s.key,"reps",t.target.value),placeholder:"0"})]})]}):s.unit==="reps"?e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsx("label",{children:"Reps (max in 1 min)"}),e.jsx("input",{type:"number",value:u[s.key]?.reps??"",onChange:t=>ke(s.key,"reps",t.target.value),placeholder:"0"})]})}):s.unit==="distance"?e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsx("label",{children:"Distance (cm)"}),e.jsx("input",{type:"number",step:"0.5",value:u[s.key]?.distance??"",onChange:t=>ke(s.key,"distance",t.target.value),placeholder:"0"})]})}):e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsx("label",{children:"Time (seconds)"}),e.jsx("input",{type:"number",step:"0.01",value:u[s.key]?.time??"",onChange:t=>ke(s.key,"time",t.target.value),placeholder:"0"})]})})]},s.key))}),e.jsxs("div",{className:"pb-edit-actions",children:[e.jsx("button",{className:"pb-cancel-btn",onClick:()=>{M(!1),A(j?.benchmarks||{})},children:"Cancel"}),e.jsx("button",{className:"pb-save-btn",onClick:Je,disabled:y,children:y?"Saving...":"Save"})]})]}),ne&&e.jsxs("div",{className:"pb-edit-card",children:[e.jsxs("div",{className:"pb-edit-header",children:[e.jsx("h3",{children:"Set Your Targets"}),e.jsx("button",{className:"pb-edit-close",onClick:()=>{x(!1),z(T)},children:"×"})]}),e.jsxs("div",{className:"pb-edit-body",children:[e.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),Z.map(s=>{const t=j?.benchmarks?.[s.key];let a="-";if(t)switch(s.unit){case"weight":(t.weight||t.reps)&&(a=`${t.weight||0}kg × ${t.reps||0}`);break;case"time":t.time&&(a=`${t.time}s`);break;case"reps":t.reps&&(a=`${t.reps} reps`);break;case"distance":t.distance&&(a=`${t.distance} cm`);break}return e.jsxs("div",{className:"pb-edit-exercise",children:[e.jsxs("div",{className:"pb-edit-exercise-header",children:[e.jsx("div",{className:"pb-edit-exercise-name",children:s.name}),e.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",a]})]}),s.unit==="weight"?e.jsxs("div",{className:"pb-edit-row",children:[e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Target Weight (kg)"}),e.jsx("input",{type:"number",step:"0.5",value:f[s.key]?.targetWeight??"",onChange:r=>fe(s.key,"targetWeight",r.target.value),placeholder:"0"})]}),e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Target Reps"}),e.jsx("input",{type:"number",value:f[s.key]?.targetReps??"",onChange:r=>fe(s.key,"targetReps",r.target.value),placeholder:"0"})]})]}):s.unit==="reps"?e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsx("label",{children:"Target Reps (in 1 min)"}),e.jsx("input",{type:"number",value:f[s.key]?.targetReps??"",onChange:r=>fe(s.key,"targetReps",r.target.value),placeholder:"0"})]})}):s.unit==="distance"?e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsx("label",{children:"Target Distance (cm)"}),e.jsx("input",{type:"number",step:"0.5",value:f[s.key]?.targetDistance??"",onChange:r=>fe(s.key,"targetDistance",r.target.value),placeholder:"0"})]})}):e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsx("label",{children:"Target (seconds)"}),e.jsx("input",{type:"number",step:"1",value:f[s.key]?.targetValue??"",onChange:r=>fe(s.key,"targetValue",r.target.value),placeholder:"0"})]})})]},s.key)})]}),e.jsxs("div",{className:"pb-edit-actions",children:[e.jsx("button",{className:"pb-cancel-btn",onClick:()=>{x(!1),z(T)},children:"Cancel"}),e.jsx("button",{className:"pb-save-btn",onClick:Ge,disabled:y,children:y?"Saving...":"Save Targets"})]})]})]}),o==="metrics"&&e.jsxs("div",{className:"pb-metrics-section",children:[!R&&!Ae&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"pb-metrics-card",children:[e.jsx("h3",{children:"Body Measurements"}),e.jsx("p",{className:"pb-metrics-month",children:K(D)}),e.jsx("div",{className:"pb-metrics-list",children:Ce.map(s=>{const t=j?.bodyMetrics?.[s.key],a=ms(s.key),r=C[s.key],n=ls(s.key),l=n!==null&&n>=1;return e.jsxs("div",{className:"pb-metric-row",children:[e.jsxs("div",{className:"pb-metric-top",children:[e.jsxs("div",{className:"pb-metric-left",children:[e.jsxs("span",{className:"pb-metric-name",children:[s.name,He("metric",s.key)&&e.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),r&&e.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",r.targetValue," ",s.suffix]})]}),e.jsxs("div",{className:"pb-metric-values",children:[e.jsx("span",{className:"pb-metric-current",children:t!=null?`${t} ${s.suffix}`:"-"}),a!==null&&e.jsxs("span",{className:`pb-metric-change ${a>0?"up":a<0?"down":"same"}`,children:[a>0?"+":"",a," ",s.suffix]})]})]}),n!==null&&e.jsxs("div",{className:"pb-metric-progress",children:[e.jsx("div",{className:"pb-metric-bar",children:e.jsx("div",{className:`pb-metric-bar-fill ${l?"hit":""}`,style:{width:`${Math.round(n*100)}%`}})}),e.jsx("span",{className:`pb-metric-percent ${l?"hit":""}`,children:l?"Hit!":`${Math.round(n*100)}%`})]})]},s.key)})})]}),e.jsxs("div",{className:"pb-action-buttons",children:[e.jsx("button",{className:"pb-edit-btn",onClick:()=>W(!0),children:j?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),e.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>ie(!0),children:Object.keys(C).length>0?"Edit Targets":"Set Targets"}),(Object.keys(T).length>0||Object.keys(C).length>0)&&e.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:Qe,disabled:y,children:"Reset All Goals"})]})]}),R&&e.jsxs("div",{className:"pb-edit-card",children:[e.jsxs("div",{className:"pb-edit-header",children:[e.jsxs("h3",{children:["Measurements - ",K(D)]}),e.jsx("button",{className:"pb-edit-close",onClick:()=>{W(!1),U(j?.bodyMetrics||{})},children:"×"})]}),e.jsx("div",{className:"pb-edit-body",children:Ce.map(s=>e.jsx("div",{className:"pb-edit-metric",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsxs("label",{children:[s.name," (",s.suffix,")"]}),e.jsx("input",{type:"number",step:"0.1",value:O[s.key]??"",onChange:t=>_e(s.key,t.target.value),placeholder:"0"})]})},s.key))}),e.jsxs("div",{className:"pb-edit-actions",children:[e.jsx("button",{className:"pb-cancel-btn",onClick:()=>{W(!1),U(j?.bodyMetrics||{})},children:"Cancel"}),e.jsx("button",{className:"pb-save-btn",onClick:ns,disabled:y,children:y?"Saving...":"Save"})]})]}),Ae&&e.jsxs("div",{className:"pb-edit-card",children:[e.jsxs("div",{className:"pb-edit-header",children:[e.jsx("h3",{children:"Body Metric Targets"}),e.jsx("button",{className:"pb-edit-close",onClick:()=>{ie(!1),H(C)},children:"×"})]}),e.jsxs("div",{className:"pb-edit-body",children:[e.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),Ce.map(s=>{const t=j?.bodyMetrics?.[s.key];return e.jsxs("div",{className:"pb-edit-exercise",children:[e.jsxs("div",{className:"pb-edit-exercise-header",children:[e.jsx("div",{className:"pb-edit-exercise-name",children:s.name}),e.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",t!=null?`${t} ${s.suffix}`:"-"]})]}),e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsxs("label",{children:["Target (",s.suffix,")"]}),e.jsx("input",{type:"number",step:"0.1",value:ge[s.key]?.targetValue??"",onChange:a=>is(s.key,a.target.value),placeholder:"0"})]})})]},s.key)})]}),e.jsxs("div",{className:"pb-edit-actions",children:[e.jsx("button",{className:"pb-cancel-btn",onClick:()=>{ie(!1),H(C)},children:"Cancel"}),e.jsx("button",{className:"pb-save-btn",onClick:cs,disabled:y,children:y?"Saving...":"Save Targets"})]})]})]}),o==="history"&&e.jsx("div",{className:"pb-history-section",children:p.length===0?e.jsxs("div",{className:"pb-empty",children:[e.jsx("h4",{children:"No records yet"}),e.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):e.jsxs(e.Fragment,{children:[w.length>0&&e.jsxs("div",{className:"pb-achievements-wall",children:[e.jsxs("h4",{className:"pb-achievements-wall-title",children:[e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),e.jsx("div",{className:"pb-achievements-list",children:[...w].reverse().map((s,t)=>e.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${t*.05}s`},children:[e.jsx("div",{className:"pb-achievement-star",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),e.jsxs("div",{className:"pb-achievement-info",children:[e.jsx("span",{className:"pb-achievement-label",children:s.label}),e.jsx("span",{className:"pb-achievement-date",children:K(s.achievedMonth)})]})]},t))})]}),e.jsx("div",{className:"pb-history-controls",children:e.jsx("button",{className:`pb-compare-toggle ${q?"active":""}`,onClick:()=>{as(!q),!q&&p.length>=2&&(De(p[0].month),Pe(p[p.length-1].month))},children:q?"Back to Timeline":"Compare Months"})}),q?e.jsxs("div",{className:"pb-compare",children:[e.jsxs("div",{className:"pb-compare-selectors",children:[e.jsxs("div",{className:"pb-compare-select",children:[e.jsx("label",{children:"From"}),e.jsx("select",{value:oe,onChange:s=>De(s.target.value),children:p.map(s=>e.jsx("option",{value:s.month,children:K(s.month)},s.month))})]}),e.jsx("div",{className:"pb-compare-vs",children:"vs"}),e.jsxs("div",{className:"pb-compare-select",children:[e.jsx("label",{children:"To"}),e.jsx("select",{value:de,onChange:s=>Pe(s.target.value),children:p.map(s=>e.jsx("option",{value:s.month,children:K(s.month)},s.month))})]})]}),Ye&&Ne&&e.jsxs("div",{className:"pb-compare-results",children:[e.jsxs("div",{className:"pb-compare-group",children:[e.jsx("h4",{children:"Strength Tests"}),e.jsxs("div",{className:"pb-compare-table",children:[e.jsxs("div",{className:"pb-compare-header-row",children:[e.jsx("span",{children:"Exercise"}),e.jsx("span",{children:K(oe).split(" ")[0]}),e.jsx("span",{children:K(de).split(" ")[0]}),e.jsx("span",{children:"Change"})]}),Z.map(s=>{const t=Ye.benchmarks?.[s.key],a=Ne.benchmarks?.[s.key],r=Be(s,t),n=Be(s,a),l=ps(n,r);return e.jsxs("div",{className:"pb-compare-row",children:[e.jsx("span",{className:"pb-compare-name",children:s.name}),e.jsx("span",{className:"pb-compare-val",children:t?ss(s,t):"-"}),e.jsx("span",{className:"pb-compare-val",children:a?ss(s,a):"-"}),e.jsx("span",{className:`pb-compare-change ${l!==null?l>=0?"positive":"negative":""}`,children:l!==null?`${l>=0?"+":""}${l.toFixed(1)}%`:"-"})]},s.key)})]})]}),e.jsxs("div",{className:"pb-compare-group",children:[e.jsx("h4",{children:"Body Measurements"}),e.jsxs("div",{className:"pb-compare-table",children:[e.jsxs("div",{className:"pb-compare-header-row",children:[e.jsx("span",{children:"Measurement"}),e.jsx("span",{children:K(oe).split(" ")[0]}),e.jsx("span",{children:K(de).split(" ")[0]}),e.jsx("span",{children:"Change"})]}),Ce.map(s=>{const t=Ye.bodyMetrics?.[s.key],a=Ne.bodyMetrics?.[s.key],r=t!=null&&a!=null?parseFloat((a-t).toFixed(2)):null;return e.jsxs("div",{className:"pb-compare-row",children:[e.jsx("span",{className:"pb-compare-name",children:s.name}),e.jsx("span",{className:"pb-compare-val",children:t!=null?`${t}`:"-"}),e.jsx("span",{className:"pb-compare-val",children:a!=null?`${a}`:"-"}),e.jsx("span",{className:`pb-compare-change ${r!==null?r>0?"positive":r<0?"negative":"neutral":""}`,children:r!==null?`${r>0?"+":""}${r} ${s.suffix}`:"-"})]},s.key)})]})]})]})]}):e.jsx("div",{className:"pb-timeline",children:[...p].reverse().map((s,t)=>{const a=p.filter(r=>r.month<s.month).pop();return e.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${t*.05}s`},children:[e.jsx("div",{className:"pb-timeline-dot"}),e.jsxs("div",{className:"pb-timeline-card",children:[e.jsx("h4",{children:K(s.month)}),s.benchmarks&&Object.keys(s.benchmarks).length>0&&e.jsxs("div",{className:"pb-timeline-group",children:[e.jsx("h5",{children:"Strength Tests"}),Z.map(r=>{const n=s.benchmarks[r.key];if(!n)return null;const l=a?.benchmarks?.[r.key],g=Be(r,n),i=Be(r,l),c=ps(g,i);return e.jsxs("div",{className:"pb-timeline-row",children:[e.jsx("span",{className:"pb-timeline-label",children:r.name}),e.jsxs("div",{className:"pb-timeline-values",children:[e.jsx("span",{className:"pb-timeline-value",children:ss(r,n)}),c!==null&&e.jsxs("span",{className:`pb-timeline-change ${c>=0?"positive":"negative"}`,children:[c>=0?"+":"",c.toFixed(1),"%"]})]})]},r.key)})]}),s.bodyMetrics&&Object.keys(s.bodyMetrics).length>0&&e.jsxs("div",{className:"pb-timeline-group",children:[e.jsx("h5",{children:"Body Measurements"}),Ce.map(r=>{const n=s.bodyMetrics[r.key];if(n==null)return null;const l=a?.bodyMetrics?.[r.key],g=l!=null?parseFloat((n-l).toFixed(2)):null;return e.jsxs("div",{className:"pb-timeline-row",children:[e.jsx("span",{className:"pb-timeline-label",children:r.name}),e.jsxs("div",{className:"pb-timeline-values",children:[e.jsxs("span",{className:"pb-timeline-value",children:[n," ",r.suffix]}),g!==null&&e.jsxs("span",{className:`pb-timeline-change ${g>0?"positive":g<0?"negative":"neutral"}`,children:[g>0?"+":"",g," ",r.suffix]})]})]},r.key)})]})]})]},s.id)})})]})})]}),ce&&e.jsx("div",{className:"pb-celebration-overlay",onClick:()=>be(null),children:e.jsxs("div",{className:"pb-celebration-card",children:[e.jsx("div",{className:"pb-celebration-icon",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),e.jsx("h3",{className:"pb-celebration-title",children:ce.length===1?"Target Achieved!":`${ce.length} Targets Achieved!`}),e.jsx("div",{className:"pb-celebration-badges",children:ce.map((s,t)=>e.jsx("div",{className:"pb-celebration-badge",children:s.label},t))}),e.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),le&&e.jsxs("div",{className:`toast-notification ${le.type}`,children:[e.jsx("span",{className:"toast-icon",children:le.type==="success"?e.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),e.jsx("span",{className:"toast-message",children:le.message}),e.jsx("button",{className:"toast-close",onClick:()=>xe(null),children:"×"})]}),e.jsxs("nav",{className:"block-bottom-nav",children:[e.jsxs("button",{className:"block-nav-tab",onClick:()=>E("/client"),children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),e.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),e.jsx("span",{children:"Home"})]}),e.jsxs("button",{className:"block-nav-tab",onClick:()=>E("/client/forms"),children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"}),e.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),e.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),e.jsx("span",{children:"Forms"})]}),e.jsxs("button",{className:"block-nav-tab",onClick:()=>E("/client/tools"),children:[e.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),e.jsx("span",{children:"Tools"})]}),e.jsxs("button",{className:"block-nav-tab active",children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M12 20V10"}),e.jsx("path",{d:"M18 20V4"}),e.jsx("path",{d:"M6 20v-4"})]}),e.jsx("span",{children:"PBs"})]}),b?.circuitAccess&&e.jsxs("button",{className:"block-nav-tab",onClick:()=>E("/client/circuit"),children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M12 6v6l4 2"})]}),e.jsx("span",{children:"Circuit"})]})]})]})}const te=[{key:"chestPress",name:"Chest Press",category:"Upper Body - Push",unit:"weight"},{key:"shoulderPress",name:"Shoulder Press",category:"Upper Body - Push",unit:"weight"},{key:"seatedRow",name:"Seated Row",category:"Upper Body - Pull",unit:"weight"},{key:"latPulldown",name:"Lat Pulldown",category:"Upper Body - Pull",unit:"weight"},{key:"squat",name:"Squat",category:"Lower Body",unit:"weight"},{key:"deadlift",name:"Deadlift",category:"Lower Body",unit:"weight"},{key:"plank",name:"Plank",category:"Core",unit:"time"}],Me=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function Vs(){const o=new Date;return`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}`}function ee(o){const[d,p]=o.split("-");return new Date(parseInt(d),parseInt(p)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function ts(o){if(!o&&o!==0)return"-";const d=Math.floor(o/60),p=(o%60).toFixed(2);return d>0?`${d}m ${parseFloat(p).toFixed(0)}s`:`${parseFloat(p).toFixed(2)}s`}function gs(o,d){return!o&&o!==0?"-":!d&&d!==0?`${o}kg`:`${o}kg x ${d}`}function Se(o,d){return d?o.unit==="time"?d.time||0:(d.weight||0)*(d.reps||0):0}function us(o,d){return!d||d===0?null:(o-d)/d*100}function Bs({data:o,exerciseKey:d,unit:p}){if(!o||o.length<2)return e.jsx("div",{className:"pb-trend-empty",children:e.jsx("p",{children:"Not enough data for trend line yet"})});const F=o.map(x=>{const u=x.benchmarks?.[d];return u?p==="time"?u.time||0:(u.weight||0)*(u.reps||0):0}),me=Math.max(...F),re=Math.min(...F),y=me-re||1,v=300,k=100,S=20,Y=v-S*2,M=k-S*2,R=F.map((x,u)=>{const A=S+u/(F.length-1)*Y,O=S+M-(x-re)/y*M;return{x:A,y:O,value:x}}),W=R.map((x,u)=>`${u===0?"M":"L"} ${x.x} ${x.y}`).join(" "),ne=W+` L ${R[R.length-1].x} ${S+M} L ${R[0].x} ${S+M} Z`;return e.jsxs("div",{className:"pb-trend-chart",children:[e.jsxs("svg",{viewBox:`0 0 ${v} ${k}`,preserveAspectRatio:"xMidYMid meet",children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"trendGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),e.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),e.jsx("path",{d:ne,fill:"url(#trendGradient)"}),e.jsx("path",{d:W,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),R.map((x,u)=>e.jsx("circle",{cx:x.x,cy:x.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},u))]}),e.jsx("div",{className:"pb-trend-labels",children:o.map((x,u)=>e.jsxs("span",{className:"pb-trend-label",children:[x.month.split("-")[1],"/",x.month.split("-")[0].slice(2)]},u))})]})}function Ws(){const[o,d]=h.useState("bests"),[p,F]=h.useState([]),[me,re]=h.useState(!0),[y,v]=h.useState(!1),[k,S]=h.useState(0),[Y,M]=h.useState(!1),[R,W]=h.useState(!1),[ne,x]=h.useState(!1),[u,A]=h.useState({}),[O,U]=h.useState({}),[T,pe]=h.useState({}),[C,ue]=h.useState({}),[f,z]=h.useState({}),[Ae,ie]=h.useState(!1),[ge,H]=h.useState({}),[w,Ee]=h.useState([]),[ce,be]=h.useState(null),[le,xe]=h.useState(null),[q,as]=h.useState(!1),[oe,De]=h.useState(""),[de,Pe]=h.useState(""),rs=h.useRef(null),Ie=h.useRef(0),X=h.useRef(0),Oe=h.useRef("right"),J=h.useCallback(s=>{S(t=>{const a=Math.max(0,Math.min(te.length-1,s));return a===t?t:(Oe.current=a>t?"right":"left",a)})},[]),{currentUser:je,isClient:ve,clientData:b,loading:ye}=bs(),{isDark:ks}=xs(),E=js();fs();const _=!b?.clientType||b.clientType==="block",P=h.useCallback((s,t="info")=>{xe({message:s,type:t}),setTimeout(()=>xe(null),4e3)},[]);h.useEffect(()=>{!ye&&(!je||!ve)&&E("/")},[je,ve,ye,E]),h.useEffect(()=>{b&&D()},[b]);const D=async()=>{try{const s=Re(Le(B,"personalBests"),Fe("clientId","==",b.id)),a=(await We(s)).docs.map(i=>({id:i.id,...i.data()}));a.sort((i,c)=>i.month.localeCompare(c.month)),F(a);const r=Re(Le(B,"personalBestTargets"),Fe("clientId","==",b.id)),n=await We(r);if(!n.empty){const i=n.docs[0].data();pe(i.targets||{}),ue(i.metricTargets||{}),z(i.targets||{}),H(i.metricTargets||{})}const l=Re(Le(B,"achievements"),Fe("clientId","==",b.id)),g=await We(l);g.empty||Ee(g.docs[0].data().badges||[])}catch(s){console.error("Error fetching personal bests:",s)}re(!1)},j=Vs(),N=p.find(s=>s.month===j),$e=p.filter(s=>s.month<j),ze=$e.length>0?$e[$e.length-1]:null;h.useEffect(()=>{N?(A(N.benchmarks||{}),U(N.bodyMetrics||{})):(A({}),U({}))},[N?.id]);const He=async(s,t)=>{const a=[];if(s==="strength"?te.forEach(r=>{const n=T[r.key];if(!n)return;const l=t[r.key];if(!l)return;let g;if(n.targetType==="time"){if(!n.targetValue)return;const i=n.startValue||0,c=l.time||0,m=n.targetValue-i;g=m===0?c>=n.targetValue?1:0:Math.max(0,(c-i)/m)}else{if(!n.targetWeight&&!n.targetReps)return;const i=(n.startWeight||0)*(n.startReps||0),c=(n.targetWeight||0)*(n.targetReps||0),m=(l.weight||0)*(l.reps||0),$=c-i;g=$===0?m>=c?1:0:Math.max(0,(m-i)/$)}if(g>=1&&!(n.targetType==="time"?w.some(c=>c.type==="strength"&&c.key===r.key&&c.targetValue===n.targetValue):w.some(c=>c.type==="strength"&&c.key===r.key&&c.targetWeight===n.targetWeight&&c.targetReps===n.targetReps))){const c=n.targetType==="time"?`${r.name} ${n.targetValue}s`:`${r.name} ${n.targetWeight}kg × ${n.targetReps}`;a.push({type:"strength",key:r.key,...n.targetType==="time"?{targetType:"time",targetValue:n.targetValue}:{targetWeight:n.targetWeight,targetReps:n.targetReps},achievedMonth:j,label:c})}}):Me.forEach(r=>{const n=C[r.key];if(!n||!n.targetValue)return;const l=t[r.key];if(l==null)return;const g=n.startValue||0,i=n.targetValue,c=i-g;(c===0?l===i?1:0:Math.max(0,(l-g)/c))>=1&&(w.some(Te=>Te.type==="metric"&&Te.key===r.key&&Te.targetValue===i)||a.push({type:"metric",key:r.key,targetValue:i,achievedMonth:j,label:`${r.name} ${i}${r.suffix}`}))}),a.length>0){const r=[...w,...a];await ae(G(B,"achievements",b.id),{clientId:b.id,badges:r,updatedAt:I.now()}),Ee(r),be(a),setTimeout(()=>be(null),5e3)}},Je=(s,t)=>{if(s==="strength"){const a=T[t];return a?a.targetType==="time"?w.some(r=>r.type==="strength"&&r.key===t&&r.targetValue===a.targetValue):!a.targetWeight&&!a.targetReps?!1:w.some(r=>r.type==="strength"&&r.key===t&&r.targetWeight===a.targetWeight&&r.targetReps===a.targetReps):!1}else{const a=C[t];return!a||!a.targetValue?!1:w.some(r=>r.type==="metric"&&r.key===t&&r.targetValue===a.targetValue)}},ns=async()=>{v(!0);try{const s=`${b.id}_${j}`,t=N||{};await ae(G(B,"personalBests",s),{clientId:b.id,month:j,benchmarks:u,bodyMetrics:t.bodyMetrics||O||{},createdAt:t.createdAt||I.now(),updatedAt:I.now()}),await He("strength",u),P("Benchmarks saved!","success"),M(!1),await D()}catch(s){console.error("Error saving benchmarks:",s),P("Failed to save. Please try again.","error")}v(!1)},ke=async()=>{v(!0);try{const s=`${b.id}_${j}`,t=N||{};await ae(G(B,"personalBests",s),{clientId:b.id,month:j,benchmarks:t.benchmarks||u||{},bodyMetrics:O,createdAt:t.createdAt||I.now(),updatedAt:I.now()}),await He("metric",O),P("Body metrics saved!","success"),W(!1),await D()}catch(s){console.error("Error saving metrics:",s),P("Failed to save. Please try again.","error")}v(!1)},_e=(s,t,a)=>{A(r=>({...r,[s]:{...r[s],[t]:a===""?"":parseFloat(a)}}))},fe=(s,t)=>{U(a=>({...a,[s]:t===""?"":parseFloat(t)}))},Ge=(s,t,a)=>{z(r=>({...r,[s]:{...r[s],[t]:a===""?"":parseFloat(a)}}))},is=async()=>{v(!0);try{const s=`targets_${b.id}`,t=N?.benchmarks||{},a={};te.forEach(r=>{const n=t[r.key];r.unit==="time"?f[r.key]?.targetValue&&(a[r.key]={targetType:"time",targetValue:f[r.key].targetValue,startValue:n?.time||0}):(f[r.key]?.targetWeight||f[r.key]?.targetReps)&&(a[r.key]={targetWeight:f[r.key].targetWeight||0,targetReps:f[r.key].targetReps||0,startWeight:n?.weight||0,startReps:n?.reps||0})}),await ae(G(B,"personalBestTargets",s),{clientId:b.id,targets:a,metricTargets:C,updatedAt:I.now()}),pe(a),z(a),P("Targets saved!","success"),x(!1)}catch(s){console.error("Error saving targets:",s),P("Failed to save targets.","error")}v(!1)},cs=(s,t)=>{H(a=>({...a,[s]:{...a[s],targetValue:t===""?"":parseFloat(t)}}))},Qe=async()=>{v(!0);try{const s=`targets_${b.id}`,t={};Me.forEach(a=>{if(ge[a.key]?.targetValue){const r=N?.bodyMetrics?.[a.key]||0;t[a.key]={targetValue:ge[a.key].targetValue,startValue:r}}}),await ae(G(B,"personalBestTargets",s),{clientId:b.id,targets:T,metricTargets:t,updatedAt:I.now()}),ue(t),H(t),P("Metric targets saved!","success"),ie(!1)}catch(s){console.error("Error saving metric targets:",s),P("Failed to save targets.","error")}v(!1)},Ze=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){v(!0);try{const s=G(B,"personalBestTargets",`targets_${b.id}`);await vs(s),pe({}),ue({}),z({}),H({}),P("All goals have been reset","success")}catch(s){console.error("Error resetting targets:",s),P("Failed to reset goals","error")}v(!1)}},ls=(s,t)=>{const a=T[s];if(!a||!t)return null;if(a.targetType==="time"){if(!a.targetValue)return null;const i=a.startValue||0,c=a.targetValue,m=t.time||0,$=c-i;return $<=0?m>=c?1:0:Math.max(0,Math.min((m-i)/$,1))}if(!a.targetWeight&&!a.targetReps)return null;const r=(a.startWeight||0)*(a.startReps||0),n=(a.targetWeight||0)*(a.targetReps||0),l=(t.weight||0)*(t.reps||0),g=n-r;return g<=0?l>=n?1:0:Math.max(0,Math.min((l-r)/g,1))},os=s=>{const t=C[s];if(!t||!t.targetValue)return null;const a=N?.bodyMetrics?.[s];if(a==null)return null;const r=t.startValue||0,n=t.targetValue,l=n-r;return l===0?a===n?1:0:Math.max(0,Math.min((a-r)/l,1))},ds=s=>{Ie.current=s.touches[0].clientX,X.current=0},hs=s=>{X.current=s.touches[0].clientX-Ie.current},ms=()=>{X.current<-50?J(k+1):X.current>50&&J(k-1),X.current=0},Ye=s=>{const t=N?.bodyMetrics?.[s],a=ze?.bodyMetrics?.[s];return t==null||a==null?null:parseFloat((t-a).toFixed(2))},Ne=p.find(s=>s.month===oe),L=p.find(s=>s.month===de);if(ye||me)return e.jsxs("div",{className:"pb-page",children:[e.jsx("header",{className:"client-header",children:e.jsx("div",{className:"header-content",children:e.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),e.jsxs("main",{className:"pb-main",children:[e.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),e.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!je||!ve||!b)return null;if(_&&b?.isJunior)return e.jsx($s,{});const V=te[k],he=N?.benchmarks?.[V.key],Ke=ze?.benchmarks?.[V.key],es=Se(V,he),we=Se(V,Ke),se=us(es,we),Ve=ls(V.key,he),Ue=Ve!==null,qe=Ve!==null&&Ve>=1,Xe=Ue?Math.round(Ve*60):es>0?15:0,Q=T[V.key];return e.jsx(Ns,{children:e.jsxs("div",{className:"pb-page",children:[e.jsx("header",{className:"client-header",children:e.jsxs("div",{className:"header-content",children:[e.jsx("button",{className:"header-back-btn",onClick:()=>E("/client"),"aria-label":"Go back",children:e.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M15 18l-6-6 6-6"})})}),e.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),e.jsxs("main",{className:"pb-main page-transition-enter",children:[e.jsxs("div",{className:"pb-intro anim-fade-up",children:[e.jsx("h2",{children:"Personal Bests"}),e.jsx("p",{children:"Track your strength benchmarks and body measurements each month."})]}),e.jsxs("div",{className:"pb-tabs",children:[e.jsx("button",{className:`pb-tab ${o==="bests"?"active":""}`,onClick:()=>d("bests"),children:"Strength"}),e.jsx("button",{className:`pb-tab ${o==="metrics"?"active":""}`,onClick:()=>d("metrics"),children:"Body Metrics"}),e.jsx("button",{className:`pb-tab ${o==="history"?"active":""}`,onClick:()=>d("history"),children:"History"})]}),o==="bests"&&e.jsxs("div",{className:"pb-strength-section",children:[!Y&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"pb-carousel",ref:rs,onTouchStart:ds,onTouchMove:hs,onTouchEnd:ms,children:[e.jsx("div",{className:`pb-ring-container slide-from-${Oe.current}`,children:e.jsxs("div",{className:"pb-ring",children:[e.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:ys.map((s,t)=>{const a=t<Math.round(Xe);return e.jsx("line",{x1:s.x1,y1:s.y1,x2:s.x2,y2:s.y2,className:`pb-ring-tick ${a?qe?"hit":"filled":"empty"}`,strokeWidth:s.thick?"3":"2"},t)})}),e.jsxs("div",{className:"pb-ring-center",children:[e.jsx("div",{className:"pb-ring-category",children:V.category}),e.jsxs("div",{className:"pb-ring-exercise",children:[V.name,Je("strength",V.key)&&e.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),e.jsx("div",{className:"pb-ring-value",children:he?V.unit==="time"?ts(he.time):gs(he.weight,he.reps):"-"}),se!==null&&e.jsxs("div",{className:`pb-ring-change ${se>=0?"positive":"negative"}`,children:[se>=0?"+":"",se.toFixed(1),"%"]}),se===null&&he&&e.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),Q&&e.jsx("div",{className:`pb-ring-target ${qe?"hit":""}`,children:qe?"Target hit!":Q.targetType==="time"?`${Q.startValue||0}s → ${Q.targetValue}s`:`${Q.startWeight||0}kg×${Q.startReps||0} → ${Q.targetWeight}kg×${Q.targetReps}`}),!Q&&e.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},k),e.jsx("div",{className:"pb-carousel-dots",children:te.map((s,t)=>e.jsx("button",{className:`pb-dot ${t===k?"active":""}`,onClick:()=>J(t)},t))}),e.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>J(k-1),disabled:k===0,children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),e.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>J(k+1),disabled:k===te.length-1,children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),e.jsxs("div",{className:"pb-trend-section",children:[e.jsx("h4",{children:"Trend"}),e.jsx(Bs,{data:p,exerciseKey:V.key,unit:V.unit})]})]}),!Y&&!ne&&e.jsxs("div",{className:"pb-action-buttons",children:[e.jsx("button",{className:"pb-edit-btn",onClick:()=>M(!0),children:N?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),e.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>x(!0),children:Object.keys(T).length>0?"Edit Targets":"Set Targets"}),(Object.keys(T).length>0||Object.keys(C).length>0)&&e.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:Ze,disabled:y,children:"Reset All Goals"})]}),Y&&e.jsxs("div",{className:"pb-edit-card",children:[e.jsxs("div",{className:"pb-edit-header",children:[e.jsxs("h3",{children:["Benchmarks - ",ee(j)]}),e.jsx("button",{className:"pb-edit-close",onClick:()=>{M(!1),A(N?.benchmarks||{})},children:"×"})]}),e.jsx("div",{className:"pb-edit-body",children:te.map(s=>e.jsxs("div",{className:"pb-edit-exercise",children:[e.jsx("div",{className:"pb-edit-exercise-name",children:s.name}),s.unit==="weight"?e.jsxs("div",{className:"pb-edit-row",children:[e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Weight (kg)"}),e.jsx("input",{type:"number",step:"0.5",value:u[s.key]?.weight??"",onChange:t=>_e(s.key,"weight",t.target.value),placeholder:"0"})]}),e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Reps"}),e.jsx("input",{type:"number",value:u[s.key]?.reps??"",onChange:t=>_e(s.key,"reps",t.target.value),placeholder:"0"})]})]}):e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsx("label",{children:"Time (seconds)"}),e.jsx("input",{type:"number",step:"0.01",value:u[s.key]?.time??"",onChange:t=>_e(s.key,"time",t.target.value),placeholder:"0"})]})})]},s.key))}),e.jsxs("div",{className:"pb-edit-actions",children:[e.jsx("button",{className:"pb-cancel-btn",onClick:()=>{M(!1),A(N?.benchmarks||{})},children:"Cancel"}),e.jsx("button",{className:"pb-save-btn",onClick:ns,disabled:y,children:y?"Saving...":"Save"})]})]}),ne&&e.jsxs("div",{className:"pb-edit-card",children:[e.jsxs("div",{className:"pb-edit-header",children:[e.jsx("h3",{children:"Set Your Targets"}),e.jsx("button",{className:"pb-edit-close",onClick:()=>{x(!1),z(T)},children:"×"})]}),e.jsxs("div",{className:"pb-edit-body",children:[e.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),te.map(s=>{const t=N?.benchmarks?.[s.key];let a="-";return t&&(s.unit==="time"&&t.time?a=`${t.time}s`:(t.weight||t.reps)&&(a=`${t.weight||0}kg × ${t.reps||0}`)),e.jsxs("div",{className:"pb-edit-exercise",children:[e.jsxs("div",{className:"pb-edit-exercise-header",children:[e.jsx("div",{className:"pb-edit-exercise-name",children:s.name}),e.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",a]})]}),s.unit==="weight"?e.jsxs("div",{className:"pb-edit-row",children:[e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Target Weight (kg)"}),e.jsx("input",{type:"number",step:"0.5",value:f[s.key]?.targetWeight??"",onChange:r=>Ge(s.key,"targetWeight",r.target.value),placeholder:"0"})]}),e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Target Reps"}),e.jsx("input",{type:"number",value:f[s.key]?.targetReps??"",onChange:r=>Ge(s.key,"targetReps",r.target.value),placeholder:"0"})]})]}):e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsx("label",{children:"Target (seconds)"}),e.jsx("input",{type:"number",step:"1",value:f[s.key]?.targetValue??"",onChange:r=>Ge(s.key,"targetValue",r.target.value),placeholder:"0"})]})})]},s.key)})]}),e.jsxs("div",{className:"pb-edit-actions",children:[e.jsx("button",{className:"pb-cancel-btn",onClick:()=>{x(!1),z(T)},children:"Cancel"}),e.jsx("button",{className:"pb-save-btn",onClick:is,disabled:y,children:y?"Saving...":"Save Targets"})]})]})]}),o==="metrics"&&e.jsxs("div",{className:"pb-metrics-section",children:[!R&&!Ae&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"pb-metrics-card",children:[e.jsx("h3",{children:"Body Measurements"}),e.jsx("p",{className:"pb-metrics-month",children:ee(j)}),e.jsx("div",{className:"pb-metrics-list",children:Me.map(s=>{const t=N?.bodyMetrics?.[s.key],a=Ye(s.key),r=C[s.key],n=os(s.key),l=n!==null&&n>=1;return e.jsxs("div",{className:"pb-metric-row",children:[e.jsxs("div",{className:"pb-metric-top",children:[e.jsxs("div",{className:"pb-metric-left",children:[e.jsxs("span",{className:"pb-metric-name",children:[s.name,Je("metric",s.key)&&e.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),r&&e.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",r.targetValue," ",s.suffix]})]}),e.jsxs("div",{className:"pb-metric-values",children:[e.jsx("span",{className:"pb-metric-current",children:t!=null?`${t} ${s.suffix}`:"-"}),a!==null&&e.jsxs("span",{className:`pb-metric-change ${a>0?"up":a<0?"down":"same"}`,children:[a>0?"+":"",a," ",s.suffix]})]})]}),n!==null&&e.jsxs("div",{className:"pb-metric-progress",children:[e.jsx("div",{className:"pb-metric-bar",children:e.jsx("div",{className:`pb-metric-bar-fill ${l?"hit":""}`,style:{width:`${Math.round(n*100)}%`}})}),e.jsx("span",{className:`pb-metric-percent ${l?"hit":""}`,children:l?"Hit!":`${Math.round(n*100)}%`})]})]},s.key)})})]}),e.jsxs("div",{className:"pb-action-buttons",children:[e.jsx("button",{className:"pb-edit-btn",onClick:()=>W(!0),children:N?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),e.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>ie(!0),children:Object.keys(C).length>0?"Edit Targets":"Set Targets"}),(Object.keys(T).length>0||Object.keys(C).length>0)&&e.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:Ze,disabled:y,children:"Reset All Goals"})]})]}),R&&e.jsxs("div",{className:"pb-edit-card",children:[e.jsxs("div",{className:"pb-edit-header",children:[e.jsxs("h3",{children:["Measurements - ",ee(j)]}),e.jsx("button",{className:"pb-edit-close",onClick:()=>{W(!1),U(N?.bodyMetrics||{})},children:"×"})]}),e.jsx("div",{className:"pb-edit-body",children:Me.map(s=>e.jsx("div",{className:"pb-edit-metric",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsxs("label",{children:[s.name," (",s.suffix,")"]}),e.jsx("input",{type:"number",step:"0.1",value:O[s.key]??"",onChange:t=>fe(s.key,t.target.value),placeholder:"0"})]})},s.key))}),e.jsxs("div",{className:"pb-edit-actions",children:[e.jsx("button",{className:"pb-cancel-btn",onClick:()=>{W(!1),U(N?.bodyMetrics||{})},children:"Cancel"}),e.jsx("button",{className:"pb-save-btn",onClick:ke,disabled:y,children:y?"Saving...":"Save"})]})]}),Ae&&e.jsxs("div",{className:"pb-edit-card",children:[e.jsxs("div",{className:"pb-edit-header",children:[e.jsx("h3",{children:"Body Metric Targets"}),e.jsx("button",{className:"pb-edit-close",onClick:()=>{ie(!1),H(C)},children:"×"})]}),e.jsxs("div",{className:"pb-edit-body",children:[e.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),Me.map(s=>{const t=N?.bodyMetrics?.[s.key];return e.jsxs("div",{className:"pb-edit-exercise",children:[e.jsxs("div",{className:"pb-edit-exercise-header",children:[e.jsx("div",{className:"pb-edit-exercise-name",children:s.name}),e.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",t!=null?`${t} ${s.suffix}`:"-"]})]}),e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsxs("label",{children:["Target (",s.suffix,")"]}),e.jsx("input",{type:"number",step:"0.1",value:ge[s.key]?.targetValue??"",onChange:a=>cs(s.key,a.target.value),placeholder:"0"})]})})]},s.key)})]}),e.jsxs("div",{className:"pb-edit-actions",children:[e.jsx("button",{className:"pb-cancel-btn",onClick:()=>{ie(!1),H(C)},children:"Cancel"}),e.jsx("button",{className:"pb-save-btn",onClick:Qe,disabled:y,children:y?"Saving...":"Save Targets"})]})]})]}),o==="history"&&e.jsx("div",{className:"pb-history-section",children:p.length===0?e.jsxs("div",{className:"pb-empty",children:[e.jsx("h4",{children:"No records yet"}),e.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):e.jsxs(e.Fragment,{children:[w.length>0&&e.jsxs("div",{className:"pb-achievements-wall",children:[e.jsxs("h4",{className:"pb-achievements-wall-title",children:[e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),e.jsx("div",{className:"pb-achievements-list",children:[...w].reverse().map((s,t)=>e.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${t*.05}s`},children:[e.jsx("div",{className:"pb-achievement-star",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),e.jsxs("div",{className:"pb-achievement-info",children:[e.jsx("span",{className:"pb-achievement-label",children:s.label}),e.jsx("span",{className:"pb-achievement-date",children:ee(s.achievedMonth)})]})]},t))})]}),e.jsx("div",{className:"pb-history-controls",children:e.jsx("button",{className:`pb-compare-toggle ${q?"active":""}`,onClick:()=>{as(!q),!q&&p.length>=2&&(De(p[0].month),Pe(p[p.length-1].month))},children:q?"Back to Timeline":"Compare Months"})}),q?e.jsxs("div",{className:"pb-compare",children:[e.jsxs("div",{className:"pb-compare-selectors",children:[e.jsxs("div",{className:"pb-compare-select",children:[e.jsx("label",{children:"From"}),e.jsx("select",{value:oe,onChange:s=>De(s.target.value),children:p.map(s=>e.jsx("option",{value:s.month,children:ee(s.month)},s.month))})]}),e.jsx("div",{className:"pb-compare-vs",children:"vs"}),e.jsxs("div",{className:"pb-compare-select",children:[e.jsx("label",{children:"To"}),e.jsx("select",{value:de,onChange:s=>Pe(s.target.value),children:p.map(s=>e.jsx("option",{value:s.month,children:ee(s.month)},s.month))})]})]}),Ne&&L&&e.jsxs("div",{className:"pb-compare-results",children:[e.jsxs("div",{className:"pb-compare-group",children:[e.jsx("h4",{children:"Strength Benchmarks"}),e.jsxs("div",{className:"pb-compare-table",children:[e.jsxs("div",{className:"pb-compare-header-row",children:[e.jsx("span",{children:"Exercise"}),e.jsx("span",{children:ee(oe).split(" ")[0]}),e.jsx("span",{children:ee(de).split(" ")[0]}),e.jsx("span",{children:"Change"})]}),te.map(s=>{const t=Ne.benchmarks?.[s.key],a=L.benchmarks?.[s.key],r=Se(s,t),n=Se(s,a),l=us(n,r);return e.jsxs("div",{className:"pb-compare-row",children:[e.jsx("span",{className:"pb-compare-name",children:s.name}),e.jsx("span",{className:"pb-compare-val",children:t?s.unit==="time"?ts(t.time):`${t.weight}x${t.reps}`:"-"}),e.jsx("span",{className:"pb-compare-val",children:a?s.unit==="time"?ts(a.time):`${a.weight}x${a.reps}`:"-"}),e.jsx("span",{className:`pb-compare-change ${l!==null?l>=0?"positive":"negative":""}`,children:l!==null?`${l>=0?"+":""}${l.toFixed(1)}%`:"-"})]},s.key)})]})]}),e.jsxs("div",{className:"pb-compare-group",children:[e.jsx("h4",{children:"Body Measurements"}),e.jsxs("div",{className:"pb-compare-table",children:[e.jsxs("div",{className:"pb-compare-header-row",children:[e.jsx("span",{children:"Measurement"}),e.jsx("span",{children:ee(oe).split(" ")[0]}),e.jsx("span",{children:ee(de).split(" ")[0]}),e.jsx("span",{children:"Change"})]}),Me.map(s=>{const t=Ne.bodyMetrics?.[s.key],a=L.bodyMetrics?.[s.key],r=t!=null&&a!=null?parseFloat((a-t).toFixed(2)):null;return e.jsxs("div",{className:"pb-compare-row",children:[e.jsx("span",{className:"pb-compare-name",children:s.name}),e.jsx("span",{className:"pb-compare-val",children:t!=null?`${t}`:"-"}),e.jsx("span",{className:"pb-compare-val",children:a!=null?`${a}`:"-"}),e.jsx("span",{className:`pb-compare-change ${r!==null?r>0?"positive":r<0?"negative":"neutral":""}`,children:r!==null?`${r>0?"+":""}${r} ${s.suffix}`:"-"})]},s.key)})]})]})]})]}):e.jsx("div",{className:"pb-timeline",children:[...p].reverse().map((s,t)=>{const a=p.find(r=>r.month<s.month&&p.indexOf(r)===p.indexOf(s)-1)||p.filter(r=>r.month<s.month).pop();return e.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${t*.05}s`},children:[e.jsx("div",{className:"pb-timeline-dot"}),e.jsxs("div",{className:"pb-timeline-card",children:[e.jsx("h4",{children:ee(s.month)}),s.benchmarks&&Object.keys(s.benchmarks).length>0&&e.jsxs("div",{className:"pb-timeline-group",children:[e.jsx("h5",{children:"Strength Benchmarks"}),te.map(r=>{const n=s.benchmarks[r.key];if(!n)return null;const l=a?.benchmarks?.[r.key],g=Se(r,n),i=Se(r,l),c=us(g,i);return e.jsxs("div",{className:"pb-timeline-row",children:[e.jsx("span",{className:"pb-timeline-label",children:r.name}),e.jsxs("div",{className:"pb-timeline-values",children:[e.jsx("span",{className:"pb-timeline-value",children:r.unit==="time"?ts(n.time):gs(n.weight,n.reps)}),c!==null&&e.jsxs("span",{className:`pb-timeline-change ${c>=0?"positive":"negative"}`,children:[c>=0?"+":"",c.toFixed(1),"%"]})]})]},r.key)})]}),s.bodyMetrics&&Object.keys(s.bodyMetrics).length>0&&e.jsxs("div",{className:"pb-timeline-group",children:[e.jsx("h5",{children:"Body Measurements"}),Me.map(r=>{const n=s.bodyMetrics[r.key];if(n==null)return null;const l=a?.bodyMetrics?.[r.key],g=l!=null?parseFloat((n-l).toFixed(2)):null;return e.jsxs("div",{className:"pb-timeline-row",children:[e.jsx("span",{className:"pb-timeline-label",children:r.name}),e.jsxs("div",{className:"pb-timeline-values",children:[e.jsxs("span",{className:"pb-timeline-value",children:[n," ",r.suffix]}),g!==null&&e.jsxs("span",{className:`pb-timeline-change ${g>0?"positive":g<0?"negative":"neutral"}`,children:[g>0?"+":"",g," ",r.suffix]})]})]},r.key)})]})]})]},s.id)})})]})})]}),ce&&e.jsx("div",{className:"pb-celebration-overlay",onClick:()=>be(null),children:e.jsxs("div",{className:"pb-celebration-card",children:[e.jsx("div",{className:"pb-celebration-icon",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),e.jsx("h3",{className:"pb-celebration-title",children:ce.length===1?"Target Achieved!":`${ce.length} Targets Achieved!`}),e.jsx("div",{className:"pb-celebration-badges",children:ce.map((s,t)=>e.jsx("div",{className:"pb-celebration-badge",children:s.label},t))}),e.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),le&&e.jsxs("div",{className:`toast-notification ${le.type}`,children:[e.jsx("span",{className:"toast-icon",children:le.type==="success"?e.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),e.jsx("span",{className:"toast-message",children:le.message}),e.jsx("button",{className:"toast-close",onClick:()=>xe(null),children:"×"})]}),e.jsxs("nav",{className:"block-bottom-nav",children:[e.jsxs("button",{className:"block-nav-tab",onClick:()=>E("/client"),children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),e.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),e.jsx("span",{children:"Home"})]}),e.jsxs("button",{className:"block-nav-tab",onClick:()=>E("/client/forms"),children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"}),e.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),e.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),e.jsx("span",{children:"Forms"})]}),e.jsxs("button",{className:"block-nav-tab",onClick:()=>E("/client/tools"),children:[e.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),e.jsx("span",{children:"Tools"})]}),e.jsxs("button",{className:"block-nav-tab active",children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M12 20V10"}),e.jsx("path",{d:"M18 20V4"}),e.jsx("path",{d:"M6 20v-4"})]}),e.jsx("span",{children:"PBs"})]}),b?.circuitAccess&&e.jsxs("button",{className:"block-nav-tab",onClick:()=>E("/client/circuit"),children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M12 6v6l4 2"})]}),e.jsx("span",{children:"Circuit"})]})]})]})})}export{Ws as default};
