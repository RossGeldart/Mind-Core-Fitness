const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-CMz5FSRy.js","assets/scheduleUtils-a2tn0x12.js","assets/Dashboard-BvdLF0uv.css","assets/AddClient-Dfwwnsdx.js","assets/AddClient-DH1OFzHo.css","assets/ClientDashboard-CT0Qn03r.js","assets/ClientDashboard-BI8UXFpK.css","assets/ClientForms-Au3js0Jg.js","assets/ClientForms-GDNtnrAx.css","assets/ClientTools-OKtsjzEE.js","assets/ClientTools-DQRPoST3.css","assets/MacroCalculator-a5e4Lh1L.js","assets/ProteinSnacks-D2ExTnjw.js","assets/DailyMotivation-vI2oNP7I.js","assets/CircuitDashboard-Bp8GPoNY.js","assets/CircuitDashboard-C8T0uect.css","assets/CircuitBooking-DgUgctYW.js","assets/CircuitBooking-ruk9Q4Wj.css","assets/PersonalBests-slMv00Lv.js","assets/PersonalBests-BkG3fixu.css","assets/Leaderboard-Bz4iomo9.js","assets/Leaderboard-Dq-r5svP.css","assets/UpgradePage-Kw0Cio_m.js","assets/stripe-Da7IPrZW.js","assets/UpgradePage-Chom0F_j.css","assets/Onboarding-DjYuQmkp.js","assets/Onboarding-DvZF-mkH.css"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const h of u.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function t(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(l){if(l.ep)return;l.ep=!0;const u=t(l);fetch(l.href,u)}})();var xp={exports:{}},qc={};var Ub;function xS(){if(Ub)return qc;Ub=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,l,u){var h=null;if(u!==void 0&&(h=""+u),l.key!==void 0&&(h=""+l.key),"key"in l){u={};for(var p in l)p!=="key"&&(u[p]=l[p])}else u=l;return l=u.ref,{$$typeof:s,type:i,key:h,ref:l!==void 0?l:null,props:u}}return qc.Fragment=e,qc.jsx=t,qc.jsxs=t,qc}var Bb;function kS(){return Bb||(Bb=1,xp.exports=xS()),xp.exports}var a=kS(),kp={exports:{}},Nt={};var zb;function ES(){if(zb)return Nt;zb=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),h=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),E=Symbol.iterator;function O(D){return D===null||typeof D!="object"?null:(D=E&&D[E]||D["@@iterator"],typeof D=="function"?D:null)}var H={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},q=Object.assign,B={};function K(D,ne,ve){this.props=D,this.context=ne,this.refs=B,this.updater=ve||H}K.prototype.isReactComponent={},K.prototype.setState=function(D,ne){if(typeof D!="object"&&typeof D!="function"&&D!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,D,ne,"setState")},K.prototype.forceUpdate=function(D){this.updater.enqueueForceUpdate(this,D,"forceUpdate")};function $(){}$.prototype=K.prototype;function G(D,ne,ve){this.props=D,this.context=ne,this.refs=B,this.updater=ve||H}var fe=G.prototype=new $;fe.constructor=G,q(fe,K.prototype),fe.isPureReactComponent=!0;var xe=Array.isArray;function be(){}var j={H:null,A:null,T:null,S:null},T=Object.prototype.hasOwnProperty;function R(D,ne,ve){var Ee=ve.ref;return{$$typeof:s,type:D,key:ne,ref:Ee!==void 0?Ee:null,props:ve}}function P(D,ne){return R(D.type,ne,D.props)}function M(D){return typeof D=="object"&&D!==null&&D.$$typeof===s}function L(D){var ne={"=":"=0",":":"=2"};return"$"+D.replace(/[=:]/g,function(ve){return ne[ve]})}var A=/\/+/g;function Ve(D,ne){return typeof D=="object"&&D!==null&&D.key!=null?L(""+D.key):ne.toString(36)}function Qe(D){switch(D.status){case"fulfilled":return D.value;case"rejected":throw D.reason;default:switch(typeof D.status=="string"?D.then(be,be):(D.status="pending",D.then(function(ne){D.status==="pending"&&(D.status="fulfilled",D.value=ne)},function(ne){D.status==="pending"&&(D.status="rejected",D.reason=ne)})),D.status){case"fulfilled":return D.value;case"rejected":throw D.reason}}throw D}function Z(D,ne,ve,Ee,Te){var Se=typeof D;(Se==="undefined"||Se==="boolean")&&(D=null);var Ke=!1;if(D===null)Ke=!0;else switch(Se){case"bigint":case"string":case"number":Ke=!0;break;case"object":switch(D.$$typeof){case s:case e:Ke=!0;break;case b:return Ke=D._init,Z(Ke(D._payload),ne,ve,Ee,Te)}}if(Ke)return Te=Te(D),Ke=Ee===""?"."+Ve(D,0):Ee,xe(Te)?(ve="",Ke!=null&&(ve=Ke.replace(A,"$&/")+"/"),Z(Te,ne,ve,"",function(sn){return sn})):Te!=null&&(M(Te)&&(Te=P(Te,ve+(Te.key==null||D&&D.key===Te.key?"":(""+Te.key).replace(A,"$&/")+"/")+Ke)),ne.push(Te)),1;Ke=0;var ct=Ee===""?".":Ee+":";if(xe(D))for(var Be=0;Be<D.length;Be++)Ee=D[Be],Se=ct+Ve(Ee,Be),Ke+=Z(Ee,ne,ve,Se,Te);else if(Be=O(D),typeof Be=="function")for(D=Be.call(D),Be=0;!(Ee=D.next()).done;)Ee=Ee.value,Se=ct+Ve(Ee,Be++),Ke+=Z(Ee,ne,ve,Se,Te);else if(Se==="object"){if(typeof D.then=="function")return Z(Qe(D),ne,ve,Ee,Te);throw ne=String(D),Error("Objects are not valid as a React child (found: "+(ne==="[object Object]"?"object with keys {"+Object.keys(D).join(", ")+"}":ne)+"). If you meant to render a collection of children, use an array instead.")}return Ke}function ue(D,ne,ve){if(D==null)return D;var Ee=[],Te=0;return Z(D,Ee,"","",function(Se){return ne.call(ve,Se,Te++)}),Ee}function Ce(D){if(D._status===-1){var ne=D._result;ne=ne(),ne.then(function(ve){(D._status===0||D._status===-1)&&(D._status=1,D._result=ve)},function(ve){(D._status===0||D._status===-1)&&(D._status=2,D._result=ve)}),D._status===-1&&(D._status=0,D._result=ne)}if(D._status===1)return D._result.default;throw D._result}var Pe=typeof reportError=="function"?reportError:function(D){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ne=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof D=="object"&&D!==null&&typeof D.message=="string"?String(D.message):String(D),error:D});if(!window.dispatchEvent(ne))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",D);return}console.error(D)},se={map:ue,forEach:function(D,ne,ve){ue(D,function(){ne.apply(this,arguments)},ve)},count:function(D){var ne=0;return ue(D,function(){ne++}),ne},toArray:function(D){return ue(D,function(ne){return ne})||[]},only:function(D){if(!M(D))throw Error("React.Children.only expected to receive a single React element child.");return D}};return Nt.Activity=k,Nt.Children=se,Nt.Component=K,Nt.Fragment=t,Nt.Profiler=l,Nt.PureComponent=G,Nt.StrictMode=i,Nt.Suspense=g,Nt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=j,Nt.__COMPILER_RUNTIME={__proto__:null,c:function(D){return j.H.useMemoCache(D)}},Nt.cache=function(D){return function(){return D.apply(null,arguments)}},Nt.cacheSignal=function(){return null},Nt.cloneElement=function(D,ne,ve){if(D==null)throw Error("The argument must be a React element, but you passed "+D+".");var Ee=q({},D.props),Te=D.key;if(ne!=null)for(Se in ne.key!==void 0&&(Te=""+ne.key),ne)!T.call(ne,Se)||Se==="key"||Se==="__self"||Se==="__source"||Se==="ref"&&ne.ref===void 0||(Ee[Se]=ne[Se]);var Se=arguments.length-2;if(Se===1)Ee.children=ve;else if(1<Se){for(var Ke=Array(Se),ct=0;ct<Se;ct++)Ke[ct]=arguments[ct+2];Ee.children=Ke}return R(D.type,Te,Ee)},Nt.createContext=function(D){return D={$$typeof:h,_currentValue:D,_currentValue2:D,_threadCount:0,Provider:null,Consumer:null},D.Provider=D,D.Consumer={$$typeof:u,_context:D},D},Nt.createElement=function(D,ne,ve){var Ee,Te={},Se=null;if(ne!=null)for(Ee in ne.key!==void 0&&(Se=""+ne.key),ne)T.call(ne,Ee)&&Ee!=="key"&&Ee!=="__self"&&Ee!=="__source"&&(Te[Ee]=ne[Ee]);var Ke=arguments.length-2;if(Ke===1)Te.children=ve;else if(1<Ke){for(var ct=Array(Ke),Be=0;Be<Ke;Be++)ct[Be]=arguments[Be+2];Te.children=ct}if(D&&D.defaultProps)for(Ee in Ke=D.defaultProps,Ke)Te[Ee]===void 0&&(Te[Ee]=Ke[Ee]);return R(D,Se,Te)},Nt.createRef=function(){return{current:null}},Nt.forwardRef=function(D){return{$$typeof:p,render:D}},Nt.isValidElement=M,Nt.lazy=function(D){return{$$typeof:b,_payload:{_status:-1,_result:D},_init:Ce}},Nt.memo=function(D,ne){return{$$typeof:y,type:D,compare:ne===void 0?null:ne}},Nt.startTransition=function(D){var ne=j.T,ve={};j.T=ve;try{var Ee=D(),Te=j.S;Te!==null&&Te(ve,Ee),typeof Ee=="object"&&Ee!==null&&typeof Ee.then=="function"&&Ee.then(be,Pe)}catch(Se){Pe(Se)}finally{ne!==null&&ve.types!==null&&(ne.types=ve.types),j.T=ne}},Nt.unstable_useCacheRefresh=function(){return j.H.useCacheRefresh()},Nt.use=function(D){return j.H.use(D)},Nt.useActionState=function(D,ne,ve){return j.H.useActionState(D,ne,ve)},Nt.useCallback=function(D,ne){return j.H.useCallback(D,ne)},Nt.useContext=function(D){return j.H.useContext(D)},Nt.useDebugValue=function(){},Nt.useDeferredValue=function(D,ne){return j.H.useDeferredValue(D,ne)},Nt.useEffect=function(D,ne){return j.H.useEffect(D,ne)},Nt.useEffectEvent=function(D){return j.H.useEffectEvent(D)},Nt.useId=function(){return j.H.useId()},Nt.useImperativeHandle=function(D,ne,ve){return j.H.useImperativeHandle(D,ne,ve)},Nt.useInsertionEffect=function(D,ne){return j.H.useInsertionEffect(D,ne)},Nt.useLayoutEffect=function(D,ne){return j.H.useLayoutEffect(D,ne)},Nt.useMemo=function(D,ne){return j.H.useMemo(D,ne)},Nt.useOptimistic=function(D,ne){return j.H.useOptimistic(D,ne)},Nt.useReducer=function(D,ne,ve){return j.H.useReducer(D,ne,ve)},Nt.useRef=function(D){return j.H.useRef(D)},Nt.useState=function(D){return j.H.useState(D)},Nt.useSyncExternalStore=function(D,ne,ve){return j.H.useSyncExternalStore(D,ne,ve)},Nt.useTransition=function(){return j.H.useTransition()},Nt.version="19.2.4",Nt}var Fb;function Gg(){return Fb||(Fb=1,kp.exports=ES()),kp.exports}var _=Gg(),Ep={exports:{}},Hc={},Tp={exports:{}},Sp={};var qb;function TS(){return qb||(qb=1,(function(s){function e(Z,ue){var Ce=Z.length;Z.push(ue);e:for(;0<Ce;){var Pe=Ce-1>>>1,se=Z[Pe];if(0<l(se,ue))Z[Pe]=ue,Z[Ce]=se,Ce=Pe;else break e}}function t(Z){return Z.length===0?null:Z[0]}function i(Z){if(Z.length===0)return null;var ue=Z[0],Ce=Z.pop();if(Ce!==ue){Z[0]=Ce;e:for(var Pe=0,se=Z.length,D=se>>>1;Pe<D;){var ne=2*(Pe+1)-1,ve=Z[ne],Ee=ne+1,Te=Z[Ee];if(0>l(ve,Ce))Ee<se&&0>l(Te,ve)?(Z[Pe]=Te,Z[Ee]=Ce,Pe=Ee):(Z[Pe]=ve,Z[ne]=Ce,Pe=ne);else if(Ee<se&&0>l(Te,Ce))Z[Pe]=Te,Z[Ee]=Ce,Pe=Ee;else break e}}return ue}function l(Z,ue){var Ce=Z.sortIndex-ue.sortIndex;return Ce!==0?Ce:Z.id-ue.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;s.unstable_now=function(){return u.now()}}else{var h=Date,p=h.now();s.unstable_now=function(){return h.now()-p}}var g=[],y=[],b=1,k=null,E=3,O=!1,H=!1,q=!1,B=!1,K=typeof setTimeout=="function"?setTimeout:null,$=typeof clearTimeout=="function"?clearTimeout:null,G=typeof setImmediate<"u"?setImmediate:null;function fe(Z){for(var ue=t(y);ue!==null;){if(ue.callback===null)i(y);else if(ue.startTime<=Z)i(y),ue.sortIndex=ue.expirationTime,e(g,ue);else break;ue=t(y)}}function xe(Z){if(q=!1,fe(Z),!H)if(t(g)!==null)H=!0,be||(be=!0,L());else{var ue=t(y);ue!==null&&Qe(xe,ue.startTime-Z)}}var be=!1,j=-1,T=5,R=-1;function P(){return B?!0:!(s.unstable_now()-R<T)}function M(){if(B=!1,be){var Z=s.unstable_now();R=Z;var ue=!0;try{e:{H=!1,q&&(q=!1,$(j),j=-1),O=!0;var Ce=E;try{t:{for(fe(Z),k=t(g);k!==null&&!(k.expirationTime>Z&&P());){var Pe=k.callback;if(typeof Pe=="function"){k.callback=null,E=k.priorityLevel;var se=Pe(k.expirationTime<=Z);if(Z=s.unstable_now(),typeof se=="function"){k.callback=se,fe(Z),ue=!0;break t}k===t(g)&&i(g),fe(Z)}else i(g);k=t(g)}if(k!==null)ue=!0;else{var D=t(y);D!==null&&Qe(xe,D.startTime-Z),ue=!1}}break e}finally{k=null,E=Ce,O=!1}ue=void 0}}finally{ue?L():be=!1}}}var L;if(typeof G=="function")L=function(){G(M)};else if(typeof MessageChannel<"u"){var A=new MessageChannel,Ve=A.port2;A.port1.onmessage=M,L=function(){Ve.postMessage(null)}}else L=function(){K(M,0)};function Qe(Z,ue){j=K(function(){Z(s.unstable_now())},ue)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(Z){Z.callback=null},s.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<Z?Math.floor(1e3/Z):5},s.unstable_getCurrentPriorityLevel=function(){return E},s.unstable_next=function(Z){switch(E){case 1:case 2:case 3:var ue=3;break;default:ue=E}var Ce=E;E=ue;try{return Z()}finally{E=Ce}},s.unstable_requestPaint=function(){B=!0},s.unstable_runWithPriority=function(Z,ue){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var Ce=E;E=Z;try{return ue()}finally{E=Ce}},s.unstable_scheduleCallback=function(Z,ue,Ce){var Pe=s.unstable_now();switch(typeof Ce=="object"&&Ce!==null?(Ce=Ce.delay,Ce=typeof Ce=="number"&&0<Ce?Pe+Ce:Pe):Ce=Pe,Z){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=Ce+se,Z={id:b++,callback:ue,priorityLevel:Z,startTime:Ce,expirationTime:se,sortIndex:-1},Ce>Pe?(Z.sortIndex=Ce,e(y,Z),t(g)===null&&Z===t(y)&&(q?($(j),j=-1):q=!0,Qe(xe,Ce-Pe))):(Z.sortIndex=se,e(g,Z),H||O||(H=!0,be||(be=!0,L()))),Z},s.unstable_shouldYield=P,s.unstable_wrapCallback=function(Z){var ue=E;return function(){var Ce=E;E=ue;try{return Z.apply(this,arguments)}finally{E=Ce}}}})(Sp)),Sp}var Hb;function SS(){return Hb||(Hb=1,Tp.exports=TS()),Tp.exports}var jp={exports:{}},qs={};var $b;function jS(){if($b)return qs;$b=1;var s=Gg();function e(g){var y="https://react.dev/errors/"+g;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)y+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+g+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},l=Symbol.for("react.portal");function u(g,y,b){var k=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:k==null?null:""+k,children:g,containerInfo:y,implementation:b}}var h=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(g,y){if(g==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return qs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,qs.createPortal=function(g,y){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(e(299));return u(g,y,null,b)},qs.flushSync=function(g){var y=h.T,b=i.p;try{if(h.T=null,i.p=2,g)return g()}finally{h.T=y,i.p=b,i.d.f()}},qs.preconnect=function(g,y){typeof g=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,i.d.C(g,y))},qs.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},qs.preinit=function(g,y){if(typeof g=="string"&&y&&typeof y.as=="string"){var b=y.as,k=p(b,y.crossOrigin),E=typeof y.integrity=="string"?y.integrity:void 0,O=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;b==="style"?i.d.S(g,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:k,integrity:E,fetchPriority:O}):b==="script"&&i.d.X(g,{crossOrigin:k,integrity:E,fetchPriority:O,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},qs.preinitModule=function(g,y){if(typeof g=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var b=p(y.as,y.crossOrigin);i.d.M(g,{crossOrigin:b,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&i.d.M(g)},qs.preload=function(g,y){if(typeof g=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var b=y.as,k=p(b,y.crossOrigin);i.d.L(g,b,{crossOrigin:k,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},qs.preloadModule=function(g,y){if(typeof g=="string")if(y){var b=p(y.as,y.crossOrigin);i.d.m(g,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:b,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else i.d.m(g)},qs.requestFormReset=function(g){i.d.r(g)},qs.unstable_batchedUpdates=function(g,y){return g(y)},qs.useFormState=function(g,y,b){return h.H.useFormState(g,y,b)},qs.useFormStatus=function(){return h.H.useHostTransitionStatus()},qs.version="19.2.4",qs}var Wb;function CS(){if(Wb)return jp.exports;Wb=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),jp.exports=jS(),jp.exports}var Gb;function NS(){if(Gb)return Hc;Gb=1;var s=SS(),e=Gg(),t=CS();function i(n){var r="https://react.dev/errors/"+n;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)r+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+n+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function u(n){var r=n,o=n;if(n.alternate)for(;r.return;)r=r.return;else{n=r;do r=n,(r.flags&4098)!==0&&(o=r.return),n=r.return;while(n)}return r.tag===3?o:null}function h(n){if(n.tag===13){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function p(n){if(n.tag===31){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function g(n){if(u(n)!==n)throw Error(i(188))}function y(n){var r=n.alternate;if(!r){if(r=u(n),r===null)throw Error(i(188));return r!==n?null:n}for(var o=n,c=r;;){var f=o.return;if(f===null)break;var m=f.alternate;if(m===null){if(c=f.return,c!==null){o=c;continue}break}if(f.child===m.child){for(m=f.child;m;){if(m===o)return g(f),n;if(m===c)return g(f),r;m=m.sibling}throw Error(i(188))}if(o.return!==c.return)o=f,c=m;else{for(var w=!1,S=f.child;S;){if(S===o){w=!0,o=f,c=m;break}if(S===c){w=!0,c=f,o=m;break}S=S.sibling}if(!w){for(S=m.child;S;){if(S===o){w=!0,o=m,c=f;break}if(S===c){w=!0,c=m,o=f;break}S=S.sibling}if(!w)throw Error(i(189))}}if(o.alternate!==c)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?n:r}function b(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n;for(n=n.child;n!==null;){if(r=b(n),r!==null)return r;n=n.sibling}return null}var k=Object.assign,E=Symbol.for("react.element"),O=Symbol.for("react.transitional.element"),H=Symbol.for("react.portal"),q=Symbol.for("react.fragment"),B=Symbol.for("react.strict_mode"),K=Symbol.for("react.profiler"),$=Symbol.for("react.consumer"),G=Symbol.for("react.context"),fe=Symbol.for("react.forward_ref"),xe=Symbol.for("react.suspense"),be=Symbol.for("react.suspense_list"),j=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),P=Symbol.for("react.memo_cache_sentinel"),M=Symbol.iterator;function L(n){return n===null||typeof n!="object"?null:(n=M&&n[M]||n["@@iterator"],typeof n=="function"?n:null)}var A=Symbol.for("react.client.reference");function Ve(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===A?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case q:return"Fragment";case K:return"Profiler";case B:return"StrictMode";case xe:return"Suspense";case be:return"SuspenseList";case R:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case H:return"Portal";case G:return n.displayName||"Context";case $:return(n._context.displayName||"Context")+".Consumer";case fe:var r=n.render;return n=n.displayName,n||(n=r.displayName||r.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case j:return r=n.displayName||null,r!==null?r:Ve(n.type)||"Memo";case T:r=n._payload,n=n._init;try{return Ve(n(r))}catch{}}return null}var Qe=Array.isArray,Z=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ue=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ce={pending:!1,data:null,method:null,action:null},Pe=[],se=-1;function D(n){return{current:n}}function ne(n){0>se||(n.current=Pe[se],Pe[se]=null,se--)}function ve(n,r){se++,Pe[se]=n.current,n.current=r}var Ee=D(null),Te=D(null),Se=D(null),Ke=D(null);function ct(n,r){switch(ve(Se,r),ve(Te,n),ve(Ee,null),r.nodeType){case 9:case 11:n=(n=r.documentElement)&&(n=n.namespaceURI)?lb(n):0;break;default:if(n=r.tagName,r=r.namespaceURI)r=lb(r),n=cb(r,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}ne(Ee),ve(Ee,n)}function Be(){ne(Ee),ne(Te),ne(Se)}function sn(n){n.memoizedState!==null&&ve(Ke,n);var r=Ee.current,o=cb(r,n.type);r!==o&&(ve(Te,n),ve(Ee,o))}function Nn(n){Te.current===n&&(ne(Ee),ne(Te)),Ke.current===n&&(ne(Ke),Uc._currentValue=Ce)}var Un,Ot;function rt(n){if(Un===void 0)try{throw Error()}catch(o){var r=o.stack.trim().match(/\n( *(at )?)/);Un=r&&r[1]||"",Ot=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Un+n+Ot}var gt=!1;function ut(n,r){if(!n||gt)return"";gt=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(r){var we=function(){throw Error()};if(Object.defineProperty(we.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(we,[])}catch(de){var ie=de}Reflect.construct(n,[],we)}else{try{we.call()}catch(de){ie=de}n.call(we.prototype)}}else{try{throw Error()}catch(de){ie=de}(we=n())&&typeof we.catch=="function"&&we.catch(function(){})}}catch(de){if(de&&ie&&typeof de.stack=="string")return[de.stack,ie.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=c.DetermineComponentFrameRoot(),w=m[0],S=m[1];if(w&&S){var U=w.split(`
`),te=S.split(`
`);for(f=c=0;c<U.length&&!U[c].includes("DetermineComponentFrameRoot");)c++;for(;f<te.length&&!te[f].includes("DetermineComponentFrameRoot");)f++;if(c===U.length||f===te.length)for(c=U.length-1,f=te.length-1;1<=c&&0<=f&&U[c]!==te[f];)f--;for(;1<=c&&0<=f;c--,f--)if(U[c]!==te[f]){if(c!==1||f!==1)do if(c--,f--,0>f||U[c]!==te[f]){var me=`
`+U[c].replace(" at new "," at ");return n.displayName&&me.includes("<anonymous>")&&(me=me.replace("<anonymous>",n.displayName)),me}while(1<=c&&0<=f);break}}}finally{gt=!1,Error.prepareStackTrace=o}return(o=n?n.displayName||n.name:"")?rt(o):""}function Bn(n,r){switch(n.tag){case 26:case 27:case 5:return rt(n.type);case 16:return rt("Lazy");case 13:return n.child!==r&&r!==null?rt("Suspense Fallback"):rt("Suspense");case 19:return rt("SuspenseList");case 0:case 15:return ut(n.type,!1);case 11:return ut(n.type.render,!1);case 1:return ut(n.type,!0);case 31:return rt("Activity");default:return""}}function he(n){try{var r="",o=null;do r+=Bn(n,o),o=n,n=n.return;while(n);return r}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var Dt=Object.prototype.hasOwnProperty,yt=s.unstable_scheduleCallback,Bt=s.unstable_cancelCallback,et=s.unstable_shouldYield,It=s.unstable_requestPaint,vt=s.unstable_now,rn=s.unstable_getCurrentPriorityLevel,Cs=s.unstable_ImmediatePriority,rs=s.unstable_UserBlockingPriority,Jt=s.unstable_NormalPriority,re=s.unstable_LowPriority,Ae=s.unstable_IdlePriority,kt=s.log,bt=s.unstable_setDisableYieldValue,it=null,$e=null;function st(n){if(typeof kt=="function"&&bt(n),$e&&typeof $e.setStrictMode=="function")try{$e.setStrictMode(it,n)}catch{}}var Fe=Math.clz32?Math.clz32:Ln,an=Math.log,un=Math.LN2;function Ln(n){return n>>>=0,n===0?32:31-(an(n)/un|0)|0}var zn=256,Xn=262144,Qt=4194304;function Fn(n){var r=n&42;if(r!==0)return r;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function An(n,r,o){var c=n.pendingLanes;if(c===0)return 0;var f=0,m=n.suspendedLanes,w=n.pingedLanes;n=n.warmLanes;var S=c&134217727;return S!==0?(c=S&~m,c!==0?f=Fn(c):(w&=S,w!==0?f=Fn(w):o||(o=S&~n,o!==0&&(f=Fn(o))))):(S=c&~m,S!==0?f=Fn(S):w!==0?f=Fn(w):o||(o=c&~n,o!==0&&(f=Fn(o)))),f===0?0:r!==0&&r!==f&&(r&m)===0&&(m=f&-f,o=r&-r,m>=o||m===32&&(o&4194048)!==0)?r:f}function hn(n,r){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&r)===0}function yr(n,r){switch(n){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function oe(){var n=Qt;return Qt<<=1,(Qt&62914560)===0&&(Qt=4194304),n}function Re(n){for(var r=[],o=0;31>o;o++)r.push(n);return r}function Ge(n,r){n.pendingLanes|=r,r!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function mt(n,r,o,c,f,m){var w=n.pendingLanes;n.pendingLanes=o,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=o,n.entangledLanes&=o,n.errorRecoveryDisabledLanes&=o,n.shellSuspendCounter=0;var S=n.entanglements,U=n.expirationTimes,te=n.hiddenUpdates;for(o=w&~o;0<o;){var me=31-Fe(o),we=1<<me;S[me]=0,U[me]=-1;var ie=te[me];if(ie!==null)for(te[me]=null,me=0;me<ie.length;me++){var de=ie[me];de!==null&&(de.lane&=-536870913)}o&=~we}c!==0&&lt(n,c,0),m!==0&&f===0&&n.tag!==0&&(n.suspendedLanes|=m&~(w&~r))}function lt(n,r,o){n.pendingLanes|=r,n.suspendedLanes&=~r;var c=31-Fe(r);n.entangledLanes|=r,n.entanglements[c]=n.entanglements[c]|1073741824|o&261930}function _n(n,r){var o=n.entangledLanes|=r;for(n=n.entanglements;o;){var c=31-Fe(o),f=1<<c;f&r|n[c]&r&&(n[c]|=r),o&=~f}}function Rn(n,r){var o=r&-r;return o=(o&42)!==0?1:pn(o),(o&(n.suspendedLanes|r))!==0?0:o}function pn(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function xn(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function Ns(){var n=ue.p;return n!==0?n:(n=window.event,n===void 0?32:Ib(n.type))}function is(n,r){var o=ue.p;try{return ue.p=n,r()}finally{ue.p=o}}var ds=Math.random().toString(36).slice(2),Zt="__reactFiber$"+ds,In="__reactProps$"+ds,As="__reactContainer$"+ds,Ar="__reactEvents$"+ds,fi="__reactListeners$"+ds,Rr="__reactHandles$"+ds,Ir="__reactResources$"+ds,qn="__reactMarker$"+ds;function Ys(n){delete n[Zt],delete n[In],delete n[Ar],delete n[fi],delete n[Rr]}function _s(n){var r=n[Zt];if(r)return r;for(var o=n.parentNode;o;){if(r=o[As]||o[Zt]){if(o=r.alternate,r.child!==null||o!==null&&o.child!==null)for(n=gb(n);n!==null;){if(o=n[Zt])return o;n=gb(n)}return r}n=o,o=n.parentNode}return null}function Sn(n){if(n=n[Zt]||n[As]){var r=n.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return n}return null}function On(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n.stateNode;throw Error(i(33))}function as(n){var r=n[Ir];return r||(r=n[Ir]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function qt(n){n[qn]=!0}var Jr=new Set,Dr={};function xs(n,r){vn(n,r),vn(n+"Capture",r)}function vn(n,r){for(Dr[n]=r,n=0;n<r.length;n++)Jr.add(r[n])}var ar=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),mi={},I={};function z(n){return Dt.call(I,n)?!0:Dt.call(mi,n)?!1:ar.test(n)?I[n]=!0:(mi[n]=!0,!1)}function ae(n,r,o){if(z(r))if(o===null)n.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":n.removeAttribute(r);return;case"boolean":var c=r.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){n.removeAttribute(r);return}}n.setAttribute(r,""+o)}}function le(n,r,o){if(o===null)n.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(r);return}n.setAttribute(r,""+o)}}function Me(n,r,o,c){if(c===null)n.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(o);return}n.setAttributeNS(r,o,""+c)}}function Le(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function He(n){var r=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function Ht(n,r,o){var c=Object.getOwnPropertyDescriptor(n.constructor.prototype,r);if(!n.hasOwnProperty(r)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var f=c.get,m=c.set;return Object.defineProperty(n,r,{configurable:!0,get:function(){return f.call(this)},set:function(w){o=""+w,m.call(this,w)}}),Object.defineProperty(n,r,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(w){o=""+w},stopTracking:function(){n._valueTracker=null,delete n[r]}}}}function Ye(n){if(!n._valueTracker){var r=He(n)?"checked":"value";n._valueTracker=Ht(n,r,""+n[r])}}function Kn(n){if(!n)return!1;var r=n._valueTracker;if(!r)return!0;var o=r.getValue(),c="";return n&&(c=He(n)?n.checked?"true":"false":n.value),n=c,n!==o?(r.setValue(n),!0):!1}function os(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var Us=/[\n"\\]/g;function Yn(n){return n.replace(Us,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function vr(n,r,o,c,f,m,w,S){n.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?n.type=w:n.removeAttribute("type"),r!=null?w==="number"?(r===0&&n.value===""||n.value!=r)&&(n.value=""+Le(r)):n.value!==""+Le(r)&&(n.value=""+Le(r)):w!=="submit"&&w!=="reset"||n.removeAttribute("value"),r!=null?Di(n,w,Le(r)):o!=null?Di(n,w,Le(o)):c!=null&&n.removeAttribute("value"),f==null&&m!=null&&(n.defaultChecked=!!m),f!=null&&(n.checked=f&&typeof f!="function"&&typeof f!="symbol"),S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?n.name=""+Le(S):n.removeAttribute("name")}function ma(n,r,o,c,f,m,w,S){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(n.type=m),r!=null||o!=null){if(!(m!=="submit"&&m!=="reset"||r!=null)){Ye(n);return}o=o!=null?""+Le(o):"",r=r!=null?""+Le(r):o,S||r===n.value||(n.value=r),n.defaultValue=r}c=c??f,c=typeof c!="function"&&typeof c!="symbol"&&!!c,n.checked=S?n.checked:!!c,n.defaultChecked=!!c,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(n.name=w),Ye(n)}function Di(n,r,o){r==="number"&&os(n.ownerDocument)===n||n.defaultValue===""+o||(n.defaultValue=""+o)}function Mr(n,r,o,c){if(n=n.options,r){r={};for(var f=0;f<o.length;f++)r["$"+o[f]]=!0;for(o=0;o<n.length;o++)f=r.hasOwnProperty("$"+n[o].value),n[o].selected!==f&&(n[o].selected=f),f&&c&&(n[o].defaultSelected=!0)}else{for(o=""+Le(o),r=null,f=0;f<n.length;f++){if(n[f].value===o){n[f].selected=!0,c&&(n[f].defaultSelected=!0);return}r!==null||n[f].disabled||(r=n[f])}r!==null&&(r.selected=!0)}}function pa(n,r,o){if(r!=null&&(r=""+Le(r),r!==n.value&&(n.value=r),o==null)){n.defaultValue!==r&&(n.defaultValue=r);return}n.defaultValue=o!=null?""+Le(o):""}function Lr(n,r,o,c){if(r==null){if(c!=null){if(o!=null)throw Error(i(92));if(Qe(c)){if(1<c.length)throw Error(i(93));c=c[0]}o=c}o==null&&(o=""),r=o}o=Le(r),n.defaultValue=o,c=n.textContent,c===o&&c!==""&&c!==null&&(n.value=c),Ye(n)}function C(n,r){if(r){var o=n.firstChild;if(o&&o===n.lastChild&&o.nodeType===3){o.nodeValue=r;return}}n.textContent=r}var Y=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ne(n,r,o){var c=r.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?n.setProperty(r,""):r==="float"?n.cssFloat="":n[r]="":c?n.setProperty(r,o):typeof o!="number"||o===0||Y.has(r)?r==="float"?n.cssFloat=o:n[r]=(""+o).trim():n[r]=o+"px"}function Ie(n,r,o){if(r!=null&&typeof r!="object")throw Error(i(62));if(n=n.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||r!=null&&r.hasOwnProperty(c)||(c.indexOf("--")===0?n.setProperty(c,""):c==="float"?n.cssFloat="":n[c]="");for(var f in r)c=r[f],r.hasOwnProperty(f)&&o[f]!==c&&Ne(n,f,c)}else for(var m in r)r.hasOwnProperty(m)&&Ne(n,m,r[m])}function Ue(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ht=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),tt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function St(n){return tt.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function dt(){}var V=null;function X(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var ee=null,ge=null;function je(n){var r=Sn(n);if(r&&(n=r.stateNode)){var o=n[In]||null;e:switch(n=r.stateNode,r.type){case"input":if(vr(n,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),r=o.name,o.type==="radio"&&r!=null){for(o=n;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Yn(""+r)+'"][type="radio"]'),r=0;r<o.length;r++){var c=o[r];if(c!==n&&c.form===n.form){var f=c[In]||null;if(!f)throw Error(i(90));vr(c,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(r=0;r<o.length;r++)c=o[r],c.form===n.form&&Kn(c)}break e;case"textarea":pa(n,o.value,o.defaultValue);break e;case"select":r=o.value,r!=null&&Mr(n,!!o.multiple,r,!1)}}}var Oe=!1;function qe(n,r,o){if(Oe)return n(r,o);Oe=!0;try{var c=n(r);return c}finally{if(Oe=!1,(ee!==null||ge!==null)&&(Mh(),ee&&(r=ee,n=ge,ge=ee=null,je(r),n)))for(r=0;r<n.length;r++)je(n[r])}}function pt(n,r){var o=n.stateNode;if(o===null)return null;var c=o[In]||null;if(c===null)return null;o=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(n=n.type,c=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!c;break e;default:n=!1}if(n)return null;if(o&&typeof o!="function")throw Error(i(231,r,typeof o));return o}var Et=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ut=!1;if(Et)try{var Xe={};Object.defineProperty(Xe,"passive",{get:function(){Ut=!0}}),window.addEventListener("test",Xe,Xe),window.removeEventListener("test",Xe,Xe)}catch{Ut=!1}var en=null,Bs=null,Tt=null;function Hn(){if(Tt)return Tt;var n,r=Bs,o=r.length,c,f="value"in en?en.value:en.textContent,m=f.length;for(n=0;n<o&&r[n]===f[n];n++);var w=o-n;for(c=1;c<=w&&r[o-c]===f[m-c];c++);return Tt=f.slice(n,1<c?1-c:void 0)}function Jn(n){var r=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&r===13&&(n=13)):n=r,n===10&&(n=13),32<=n||n===13?n:0}function jt(){return!0}function dn(){return!1}function Dn(n){function r(o,c,f,m,w){this._reactName=o,this._targetInst=f,this.type=c,this.nativeEvent=m,this.target=w,this.currentTarget=null;for(var S in n)n.hasOwnProperty(S)&&(o=n[S],this[S]=o?o(m):m[S]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?jt:dn,this.isPropagationStopped=dn,this}return k(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=jt)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=jt)},persist:function(){},isPersistent:jt}),r}var zs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Fs=Dn(zs),fs=k({},zs,{view:0,detail:0}),Qs=Dn(fs),or,Mi,Or,pi=k({},fs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ga,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Or&&(Or&&n.type==="mousemove"?(or=n.screenX-Or.screenX,Mi=n.screenY-Or.screenY):Mi=or=0,Or=n),or)},movementY:function(n){return"movementY"in n?n.movementY:Mi}}),ic=Dn(pi),oo=k({},pi,{dataTransfer:0}),Fu=Dn(oo),qu=k({},fs,{relatedTarget:0}),lo=Dn(qu),ac=k({},zs,{animationName:0,elapsedTime:0,pseudoElement:0}),Hu=Dn(ac),Jo=k({},zs,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),$u=Dn(Jo),Wu=k({},zs,{data:0}),gi=Dn(Wu),Gu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ku={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Yu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Qu(n){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(n):(n=Yu[n])?!!r[n]:!1}function ga(){return Qu}var Xs=k({},fs,{key:function(n){if(n.key){var r=Gu[n.key]||n.key;if(r!=="Unidentified")return r}return n.type==="keypress"?(n=Jn(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Ku[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ga,charCode:function(n){return n.type==="keypress"?Jn(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Jn(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Xu=Dn(Xs),Ju=k({},pi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Li=Dn(Ju),d=k({},fs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ga}),v=Dn(d),x=k({},zs,{propertyName:0,elapsedTime:0,pseudoElement:0}),N=Dn(x),Q=k({},pi,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),ce=Dn(Q),De=k({},zs,{newState:0,oldState:0}),Mt=Dn(De),ls=[9,13,27,32],fn=Et&&"CompositionEvent"in window,$n=null;Et&&"documentMode"in document&&($n=document.documentMode);var Pr=Et&&"TextEvent"in window&&!$n,yi=Et&&(!fn||$n&&8<$n&&11>=$n),Zr=" ",ei=!1;function co(n,r){switch(n){case"keyup":return ls.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Zo(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var el=!1;function WE(n,r){switch(n){case"compositionend":return Zo(r);case"keypress":return r.which!==32?null:(ei=!0,Zr);case"textInput":return n=r.data,n===Zr&&ei?null:n;default:return null}}function GE(n,r){if(el)return n==="compositionend"||!fn&&co(n,r)?(n=Hn(),Tt=Bs=en=null,el=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return yi&&r.locale!=="ko"?null:r.data;default:return null}}var KE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function b0(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r==="input"?!!KE[n.type]:r==="textarea"}function w0(n,r,o,c){ee?ge?ge.push(c):ge=[c]:ee=c,r=zh(r,"onChange"),0<r.length&&(o=new Fs("onChange","change",null,o,c),n.push({event:o,listeners:r}))}var oc=null,lc=null;function YE(n){nb(n,0)}function Zu(n){var r=On(n);if(Kn(r))return n}function _0(n,r){if(n==="change")return r}var x0=!1;if(Et){var Nf;if(Et){var Af="oninput"in document;if(!Af){var k0=document.createElement("div");k0.setAttribute("oninput","return;"),Af=typeof k0.oninput=="function"}Nf=Af}else Nf=!1;x0=Nf&&(!document.documentMode||9<document.documentMode)}function E0(){oc&&(oc.detachEvent("onpropertychange",T0),lc=oc=null)}function T0(n){if(n.propertyName==="value"&&Zu(lc)){var r=[];w0(r,lc,n,X(n)),qe(YE,r)}}function QE(n,r,o){n==="focusin"?(E0(),oc=r,lc=o,oc.attachEvent("onpropertychange",T0)):n==="focusout"&&E0()}function XE(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Zu(lc)}function JE(n,r){if(n==="click")return Zu(r)}function ZE(n,r){if(n==="input"||n==="change")return Zu(r)}function eT(n,r){return n===r&&(n!==0||1/n===1/r)||n!==n&&r!==r}var br=typeof Object.is=="function"?Object.is:eT;function cc(n,r){if(br(n,r))return!0;if(typeof n!="object"||n===null||typeof r!="object"||r===null)return!1;var o=Object.keys(n),c=Object.keys(r);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var f=o[c];if(!Dt.call(r,f)||!br(n[f],r[f]))return!1}return!0}function S0(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function j0(n,r){var o=S0(n);n=0;for(var c;o;){if(o.nodeType===3){if(c=n+o.textContent.length,n<=r&&c>=r)return{node:o,offset:r-n};n=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=S0(o)}}function C0(n,r){return n&&r?n===r?!0:n&&n.nodeType===3?!1:r&&r.nodeType===3?C0(n,r.parentNode):"contains"in n?n.contains(r):n.compareDocumentPosition?!!(n.compareDocumentPosition(r)&16):!1:!1}function N0(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var r=os(n.document);r instanceof n.HTMLIFrameElement;){try{var o=typeof r.contentWindow.location.href=="string"}catch{o=!1}if(o)n=r.contentWindow;else break;r=os(n.document)}return r}function Rf(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r&&(r==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||r==="textarea"||n.contentEditable==="true")}var tT=Et&&"documentMode"in document&&11>=document.documentMode,tl=null,If=null,uc=null,Df=!1;function A0(n,r,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Df||tl==null||tl!==os(c)||(c=tl,"selectionStart"in c&&Rf(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),uc&&cc(uc,c)||(uc=c,c=zh(If,"onSelect"),0<c.length&&(r=new Fs("onSelect","select",null,r,o),n.push({event:r,listeners:c}),r.target=tl)))}function uo(n,r){var o={};return o[n.toLowerCase()]=r.toLowerCase(),o["Webkit"+n]="webkit"+r,o["Moz"+n]="moz"+r,o}var nl={animationend:uo("Animation","AnimationEnd"),animationiteration:uo("Animation","AnimationIteration"),animationstart:uo("Animation","AnimationStart"),transitionrun:uo("Transition","TransitionRun"),transitionstart:uo("Transition","TransitionStart"),transitioncancel:uo("Transition","TransitionCancel"),transitionend:uo("Transition","TransitionEnd")},Mf={},R0={};Et&&(R0=document.createElement("div").style,"AnimationEvent"in window||(delete nl.animationend.animation,delete nl.animationiteration.animation,delete nl.animationstart.animation),"TransitionEvent"in window||delete nl.transitionend.transition);function ho(n){if(Mf[n])return Mf[n];if(!nl[n])return n;var r=nl[n],o;for(o in r)if(r.hasOwnProperty(o)&&o in R0)return Mf[n]=r[o];return n}var I0=ho("animationend"),D0=ho("animationiteration"),M0=ho("animationstart"),nT=ho("transitionrun"),sT=ho("transitionstart"),rT=ho("transitioncancel"),L0=ho("transitionend"),O0=new Map,Lf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Lf.push("scrollEnd");function ti(n,r){O0.set(n,r),xs(r,[n])}var eh=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},Vr=[],sl=0,Of=0;function th(){for(var n=sl,r=Of=sl=0;r<n;){var o=Vr[r];Vr[r++]=null;var c=Vr[r];Vr[r++]=null;var f=Vr[r];Vr[r++]=null;var m=Vr[r];if(Vr[r++]=null,c!==null&&f!==null){var w=c.pending;w===null?f.next=f:(f.next=w.next,w.next=f),c.pending=f}m!==0&&P0(o,f,m)}}function nh(n,r,o,c){Vr[sl++]=n,Vr[sl++]=r,Vr[sl++]=o,Vr[sl++]=c,Of|=c,n.lanes|=c,n=n.alternate,n!==null&&(n.lanes|=c)}function Pf(n,r,o,c){return nh(n,r,o,c),sh(n)}function fo(n,r){return nh(n,null,null,r),sh(n)}function P0(n,r,o){n.lanes|=o;var c=n.alternate;c!==null&&(c.lanes|=o);for(var f=!1,m=n.return;m!==null;)m.childLanes|=o,c=m.alternate,c!==null&&(c.childLanes|=o),m.tag===22&&(n=m.stateNode,n===null||n._visibility&1||(f=!0)),n=m,m=m.return;return n.tag===3?(m=n.stateNode,f&&r!==null&&(f=31-Fe(o),n=m.hiddenUpdates,c=n[f],c===null?n[f]=[r]:c.push(r),r.lane=o|536870912),m):null}function sh(n){if(50<Ic)throw Ic=0,Wm=null,Error(i(185));for(var r=n.return;r!==null;)n=r,r=n.return;return n.tag===3?n.stateNode:null}var rl={};function iT(n,r,o,c){this.tag=n,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wr(n,r,o,c){return new iT(n,r,o,c)}function Vf(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Oi(n,r){var o=n.alternate;return o===null?(o=wr(n.tag,r,n.key,n.mode),o.elementType=n.elementType,o.type=n.type,o.stateNode=n.stateNode,o.alternate=n,n.alternate=o):(o.pendingProps=r,o.type=n.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=n.flags&65011712,o.childLanes=n.childLanes,o.lanes=n.lanes,o.child=n.child,o.memoizedProps=n.memoizedProps,o.memoizedState=n.memoizedState,o.updateQueue=n.updateQueue,r=n.dependencies,o.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},o.sibling=n.sibling,o.index=n.index,o.ref=n.ref,o.refCleanup=n.refCleanup,o}function V0(n,r){n.flags&=65011714;var o=n.alternate;return o===null?(n.childLanes=0,n.lanes=r,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,r=o.dependencies,n.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),n}function rh(n,r,o,c,f,m){var w=0;if(c=n,typeof n=="function")Vf(n)&&(w=1);else if(typeof n=="string")w=uS(n,o,Ee.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case R:return n=wr(31,o,r,f),n.elementType=R,n.lanes=m,n;case q:return mo(o.children,f,m,r);case B:w=8,f|=24;break;case K:return n=wr(12,o,r,f|2),n.elementType=K,n.lanes=m,n;case xe:return n=wr(13,o,r,f),n.elementType=xe,n.lanes=m,n;case be:return n=wr(19,o,r,f),n.elementType=be,n.lanes=m,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case G:w=10;break e;case $:w=9;break e;case fe:w=11;break e;case j:w=14;break e;case T:w=16,c=null;break e}w=29,o=Error(i(130,n===null?"null":typeof n,"")),c=null}return r=wr(w,o,r,f),r.elementType=n,r.type=c,r.lanes=m,r}function mo(n,r,o,c){return n=wr(7,n,c,r),n.lanes=o,n}function Uf(n,r,o){return n=wr(6,n,null,r),n.lanes=o,n}function U0(n){var r=wr(18,null,null,0);return r.stateNode=n,r}function Bf(n,r,o){return r=wr(4,n.children!==null?n.children:[],n.key,r),r.lanes=o,r.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},r}var B0=new WeakMap;function Ur(n,r){if(typeof n=="object"&&n!==null){var o=B0.get(n);return o!==void 0?o:(r={value:n,source:r,stack:he(r)},B0.set(n,r),r)}return{value:n,source:r,stack:he(r)}}var il=[],al=0,ih=null,hc=0,Br=[],zr=0,ya=null,vi=1,bi="";function Pi(n,r){il[al++]=hc,il[al++]=ih,ih=n,hc=r}function z0(n,r,o){Br[zr++]=vi,Br[zr++]=bi,Br[zr++]=ya,ya=n;var c=vi;n=bi;var f=32-Fe(c)-1;c&=~(1<<f),o+=1;var m=32-Fe(r)+f;if(30<m){var w=f-f%5;m=(c&(1<<w)-1).toString(32),c>>=w,f-=w,vi=1<<32-Fe(r)+f|o<<f|c,bi=m+n}else vi=1<<m|o<<f|c,bi=n}function zf(n){n.return!==null&&(Pi(n,1),z0(n,1,0))}function Ff(n){for(;n===ih;)ih=il[--al],il[al]=null,hc=il[--al],il[al]=null;for(;n===ya;)ya=Br[--zr],Br[zr]=null,bi=Br[--zr],Br[zr]=null,vi=Br[--zr],Br[zr]=null}function F0(n,r){Br[zr++]=vi,Br[zr++]=bi,Br[zr++]=ya,vi=r.id,bi=r.overflow,ya=n}var Rs=null,Pn=null,Xt=!1,va=null,Fr=!1,qf=Error(i(519));function ba(n){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw dc(Ur(r,n)),qf}function q0(n){var r=n.stateNode,o=n.type,c=n.memoizedProps;switch(r[Zt]=n,r[In]=c,o){case"dialog":Ft("cancel",r),Ft("close",r);break;case"iframe":case"object":case"embed":Ft("load",r);break;case"video":case"audio":for(o=0;o<Mc.length;o++)Ft(Mc[o],r);break;case"source":Ft("error",r);break;case"img":case"image":case"link":Ft("error",r),Ft("load",r);break;case"details":Ft("toggle",r);break;case"input":Ft("invalid",r),ma(r,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":Ft("invalid",r);break;case"textarea":Ft("invalid",r),Lr(r,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||r.textContent===""+o||c.suppressHydrationWarning===!0||ab(r.textContent,o)?(c.popover!=null&&(Ft("beforetoggle",r),Ft("toggle",r)),c.onScroll!=null&&Ft("scroll",r),c.onScrollEnd!=null&&Ft("scrollend",r),c.onClick!=null&&(r.onclick=dt),r=!0):r=!1,r||ba(n,!0)}function H0(n){for(Rs=n.return;Rs;)switch(Rs.tag){case 5:case 31:case 13:Fr=!1;return;case 27:case 3:Fr=!0;return;default:Rs=Rs.return}}function ol(n){if(n!==Rs)return!1;if(!Xt)return H0(n),Xt=!0,!1;var r=n.tag,o;if((o=r!==3&&r!==27)&&((o=r===5)&&(o=n.type,o=!(o!=="form"&&o!=="button")||op(n.type,n.memoizedProps)),o=!o),o&&Pn&&ba(n),H0(n),r===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));Pn=pb(n)}else if(r===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));Pn=pb(n)}else r===27?(r=Pn,Da(n.type)?(n=dp,dp=null,Pn=n):Pn=r):Pn=Rs?Hr(n.stateNode.nextSibling):null;return!0}function po(){Pn=Rs=null,Xt=!1}function Hf(){var n=va;return n!==null&&(hr===null?hr=n:hr.push.apply(hr,n),va=null),n}function dc(n){va===null?va=[n]:va.push(n)}var $f=D(null),go=null,Vi=null;function wa(n,r,o){ve($f,r._currentValue),r._currentValue=o}function Ui(n){n._currentValue=$f.current,ne($f)}function Wf(n,r,o){for(;n!==null;){var c=n.alternate;if((n.childLanes&r)!==r?(n.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),n===o)break;n=n.return}}function Gf(n,r,o,c){var f=n.child;for(f!==null&&(f.return=n);f!==null;){var m=f.dependencies;if(m!==null){var w=f.child;m=m.firstContext;e:for(;m!==null;){var S=m;m=f;for(var U=0;U<r.length;U++)if(S.context===r[U]){m.lanes|=o,S=m.alternate,S!==null&&(S.lanes|=o),Wf(m.return,o,n),c||(w=null);break e}m=S.next}}else if(f.tag===18){if(w=f.return,w===null)throw Error(i(341));w.lanes|=o,m=w.alternate,m!==null&&(m.lanes|=o),Wf(w,o,n),w=null}else w=f.child;if(w!==null)w.return=f;else for(w=f;w!==null;){if(w===n){w=null;break}if(f=w.sibling,f!==null){f.return=w.return,w=f;break}w=w.return}f=w}}function ll(n,r,o,c){n=null;for(var f=r,m=!1;f!==null;){if(!m){if((f.flags&524288)!==0)m=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var w=f.alternate;if(w===null)throw Error(i(387));if(w=w.memoizedProps,w!==null){var S=f.type;br(f.pendingProps.value,w.value)||(n!==null?n.push(S):n=[S])}}else if(f===Ke.current){if(w=f.alternate,w===null)throw Error(i(387));w.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(n!==null?n.push(Uc):n=[Uc])}f=f.return}n!==null&&Gf(r,n,o,c),r.flags|=262144}function ah(n){for(n=n.firstContext;n!==null;){if(!br(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function yo(n){go=n,Vi=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Is(n){return $0(go,n)}function oh(n,r){return go===null&&yo(n),$0(n,r)}function $0(n,r){var o=r._currentValue;if(r={context:r,memoizedValue:o,next:null},Vi===null){if(n===null)throw Error(i(308));Vi=r,n.dependencies={lanes:0,firstContext:r},n.flags|=524288}else Vi=Vi.next=r;return o}var aT=typeof AbortController<"u"?AbortController:function(){var n=[],r=this.signal={aborted:!1,addEventListener:function(o,c){n.push(c)}};this.abort=function(){r.aborted=!0,n.forEach(function(o){return o()})}},oT=s.unstable_scheduleCallback,lT=s.unstable_NormalPriority,ms={$$typeof:G,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Kf(){return{controller:new aT,data:new Map,refCount:0}}function fc(n){n.refCount--,n.refCount===0&&oT(lT,function(){n.controller.abort()})}var mc=null,Yf=0,cl=0,ul=null;function cT(n,r){if(mc===null){var o=mc=[];Yf=0,cl=Jm(),ul={status:"pending",value:void 0,then:function(c){o.push(c)}}}return Yf++,r.then(W0,W0),r}function W0(){if(--Yf===0&&mc!==null){ul!==null&&(ul.status="fulfilled");var n=mc;mc=null,cl=0,ul=null;for(var r=0;r<n.length;r++)(0,n[r])()}}function uT(n,r){var o=[],c={status:"pending",value:null,reason:null,then:function(f){o.push(f)}};return n.then(function(){c.status="fulfilled",c.value=r;for(var f=0;f<o.length;f++)(0,o[f])(r)},function(f){for(c.status="rejected",c.reason=f,f=0;f<o.length;f++)(0,o[f])(void 0)}),c}var G0=Z.S;Z.S=function(n,r){A1=vt(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&cT(n,r),G0!==null&&G0(n,r)};var vo=D(null);function Qf(){var n=vo.current;return n!==null?n:jn.pooledCache}function lh(n,r){r===null?ve(vo,vo.current):ve(vo,r.pool)}function K0(){var n=Qf();return n===null?null:{parent:ms._currentValue,pool:n}}var hl=Error(i(460)),Xf=Error(i(474)),ch=Error(i(542)),uh={then:function(){}};function Y0(n){return n=n.status,n==="fulfilled"||n==="rejected"}function Q0(n,r,o){switch(o=n[o],o===void 0?n.push(r):o!==r&&(r.then(dt,dt),r=o),r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,J0(n),n;default:if(typeof r.status=="string")r.then(dt,dt);else{if(n=jn,n!==null&&100<n.shellSuspendCounter)throw Error(i(482));n=r,n.status="pending",n.then(function(c){if(r.status==="pending"){var f=r;f.status="fulfilled",f.value=c}},function(c){if(r.status==="pending"){var f=r;f.status="rejected",f.reason=c}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,J0(n),n}throw wo=r,hl}}function bo(n){try{var r=n._init;return r(n._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(wo=o,hl):o}}var wo=null;function X0(){if(wo===null)throw Error(i(459));var n=wo;return wo=null,n}function J0(n){if(n===hl||n===ch)throw Error(i(483))}var dl=null,pc=0;function hh(n){var r=pc;return pc+=1,dl===null&&(dl=[]),Q0(dl,n,r)}function gc(n,r){r=r.props.ref,n.ref=r!==void 0?r:null}function dh(n,r){throw r.$$typeof===E?Error(i(525)):(n=Object.prototype.toString.call(r),Error(i(31,n==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":n)))}function Z0(n){function r(W,F){if(n){var J=W.deletions;J===null?(W.deletions=[F],W.flags|=16):J.push(F)}}function o(W,F){if(!n)return null;for(;F!==null;)r(W,F),F=F.sibling;return null}function c(W){for(var F=new Map;W!==null;)W.key!==null?F.set(W.key,W):F.set(W.index,W),W=W.sibling;return F}function f(W,F){return W=Oi(W,F),W.index=0,W.sibling=null,W}function m(W,F,J){return W.index=J,n?(J=W.alternate,J!==null?(J=J.index,J<F?(W.flags|=67108866,F):J):(W.flags|=67108866,F)):(W.flags|=1048576,F)}function w(W){return n&&W.alternate===null&&(W.flags|=67108866),W}function S(W,F,J,ye){return F===null||F.tag!==6?(F=Uf(J,W.mode,ye),F.return=W,F):(F=f(F,J),F.return=W,F)}function U(W,F,J,ye){var at=J.type;return at===q?me(W,F,J.props.children,ye,J.key):F!==null&&(F.elementType===at||typeof at=="object"&&at!==null&&at.$$typeof===T&&bo(at)===F.type)?(F=f(F,J.props),gc(F,J),F.return=W,F):(F=rh(J.type,J.key,J.props,null,W.mode,ye),gc(F,J),F.return=W,F)}function te(W,F,J,ye){return F===null||F.tag!==4||F.stateNode.containerInfo!==J.containerInfo||F.stateNode.implementation!==J.implementation?(F=Bf(J,W.mode,ye),F.return=W,F):(F=f(F,J.children||[]),F.return=W,F)}function me(W,F,J,ye,at){return F===null||F.tag!==7?(F=mo(J,W.mode,ye,at),F.return=W,F):(F=f(F,J),F.return=W,F)}function we(W,F,J){if(typeof F=="string"&&F!==""||typeof F=="number"||typeof F=="bigint")return F=Uf(""+F,W.mode,J),F.return=W,F;if(typeof F=="object"&&F!==null){switch(F.$$typeof){case O:return J=rh(F.type,F.key,F.props,null,W.mode,J),gc(J,F),J.return=W,J;case H:return F=Bf(F,W.mode,J),F.return=W,F;case T:return F=bo(F),we(W,F,J)}if(Qe(F)||L(F))return F=mo(F,W.mode,J,null),F.return=W,F;if(typeof F.then=="function")return we(W,hh(F),J);if(F.$$typeof===G)return we(W,oh(W,F),J);dh(W,F)}return null}function ie(W,F,J,ye){var at=F!==null?F.key:null;if(typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint")return at!==null?null:S(W,F,""+J,ye);if(typeof J=="object"&&J!==null){switch(J.$$typeof){case O:return J.key===at?U(W,F,J,ye):null;case H:return J.key===at?te(W,F,J,ye):null;case T:return J=bo(J),ie(W,F,J,ye)}if(Qe(J)||L(J))return at!==null?null:me(W,F,J,ye,null);if(typeof J.then=="function")return ie(W,F,hh(J),ye);if(J.$$typeof===G)return ie(W,F,oh(W,J),ye);dh(W,J)}return null}function de(W,F,J,ye,at){if(typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint")return W=W.get(J)||null,S(F,W,""+ye,at);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case O:return W=W.get(ye.key===null?J:ye.key)||null,U(F,W,ye,at);case H:return W=W.get(ye.key===null?J:ye.key)||null,te(F,W,ye,at);case T:return ye=bo(ye),de(W,F,J,ye,at)}if(Qe(ye)||L(ye))return W=W.get(J)||null,me(F,W,ye,at,null);if(typeof ye.then=="function")return de(W,F,J,hh(ye),at);if(ye.$$typeof===G)return de(W,F,J,oh(F,ye),at);dh(F,ye)}return null}function Je(W,F,J,ye){for(var at=null,on=null,nt=F,Pt=F=0,Wt=null;nt!==null&&Pt<J.length;Pt++){nt.index>Pt?(Wt=nt,nt=null):Wt=nt.sibling;var ln=ie(W,nt,J[Pt],ye);if(ln===null){nt===null&&(nt=Wt);break}n&&nt&&ln.alternate===null&&r(W,nt),F=m(ln,F,Pt),on===null?at=ln:on.sibling=ln,on=ln,nt=Wt}if(Pt===J.length)return o(W,nt),Xt&&Pi(W,Pt),at;if(nt===null){for(;Pt<J.length;Pt++)nt=we(W,J[Pt],ye),nt!==null&&(F=m(nt,F,Pt),on===null?at=nt:on.sibling=nt,on=nt);return Xt&&Pi(W,Pt),at}for(nt=c(nt);Pt<J.length;Pt++)Wt=de(nt,W,Pt,J[Pt],ye),Wt!==null&&(n&&Wt.alternate!==null&&nt.delete(Wt.key===null?Pt:Wt.key),F=m(Wt,F,Pt),on===null?at=Wt:on.sibling=Wt,on=Wt);return n&&nt.forEach(function(Va){return r(W,Va)}),Xt&&Pi(W,Pt),at}function ft(W,F,J,ye){if(J==null)throw Error(i(151));for(var at=null,on=null,nt=F,Pt=F=0,Wt=null,ln=J.next();nt!==null&&!ln.done;Pt++,ln=J.next()){nt.index>Pt?(Wt=nt,nt=null):Wt=nt.sibling;var Va=ie(W,nt,ln.value,ye);if(Va===null){nt===null&&(nt=Wt);break}n&&nt&&Va.alternate===null&&r(W,nt),F=m(Va,F,Pt),on===null?at=Va:on.sibling=Va,on=Va,nt=Wt}if(ln.done)return o(W,nt),Xt&&Pi(W,Pt),at;if(nt===null){for(;!ln.done;Pt++,ln=J.next())ln=we(W,ln.value,ye),ln!==null&&(F=m(ln,F,Pt),on===null?at=ln:on.sibling=ln,on=ln);return Xt&&Pi(W,Pt),at}for(nt=c(nt);!ln.done;Pt++,ln=J.next())ln=de(nt,W,Pt,ln.value,ye),ln!==null&&(n&&ln.alternate!==null&&nt.delete(ln.key===null?Pt:ln.key),F=m(ln,F,Pt),on===null?at=ln:on.sibling=ln,on=ln);return n&&nt.forEach(function(_S){return r(W,_S)}),Xt&&Pi(W,Pt),at}function Tn(W,F,J,ye){if(typeof J=="object"&&J!==null&&J.type===q&&J.key===null&&(J=J.props.children),typeof J=="object"&&J!==null){switch(J.$$typeof){case O:e:{for(var at=J.key;F!==null;){if(F.key===at){if(at=J.type,at===q){if(F.tag===7){o(W,F.sibling),ye=f(F,J.props.children),ye.return=W,W=ye;break e}}else if(F.elementType===at||typeof at=="object"&&at!==null&&at.$$typeof===T&&bo(at)===F.type){o(W,F.sibling),ye=f(F,J.props),gc(ye,J),ye.return=W,W=ye;break e}o(W,F);break}else r(W,F);F=F.sibling}J.type===q?(ye=mo(J.props.children,W.mode,ye,J.key),ye.return=W,W=ye):(ye=rh(J.type,J.key,J.props,null,W.mode,ye),gc(ye,J),ye.return=W,W=ye)}return w(W);case H:e:{for(at=J.key;F!==null;){if(F.key===at)if(F.tag===4&&F.stateNode.containerInfo===J.containerInfo&&F.stateNode.implementation===J.implementation){o(W,F.sibling),ye=f(F,J.children||[]),ye.return=W,W=ye;break e}else{o(W,F);break}else r(W,F);F=F.sibling}ye=Bf(J,W.mode,ye),ye.return=W,W=ye}return w(W);case T:return J=bo(J),Tn(W,F,J,ye)}if(Qe(J))return Je(W,F,J,ye);if(L(J)){if(at=L(J),typeof at!="function")throw Error(i(150));return J=at.call(J),ft(W,F,J,ye)}if(typeof J.then=="function")return Tn(W,F,hh(J),ye);if(J.$$typeof===G)return Tn(W,F,oh(W,J),ye);dh(W,J)}return typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint"?(J=""+J,F!==null&&F.tag===6?(o(W,F.sibling),ye=f(F,J),ye.return=W,W=ye):(o(W,F),ye=Uf(J,W.mode,ye),ye.return=W,W=ye),w(W)):o(W,F)}return function(W,F,J,ye){try{pc=0;var at=Tn(W,F,J,ye);return dl=null,at}catch(nt){if(nt===hl||nt===ch)throw nt;var on=wr(29,nt,null,W.mode);return on.lanes=ye,on.return=W,on}}}var _o=Z0(!0),ev=Z0(!1),_a=!1;function Jf(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Zf(n,r){n=n.updateQueue,r.updateQueue===n&&(r.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function xa(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function ka(n,r,o){var c=n.updateQueue;if(c===null)return null;if(c=c.shared,(mn&2)!==0){var f=c.pending;return f===null?r.next=r:(r.next=f.next,f.next=r),c.pending=r,r=sh(n),P0(n,null,o),r}return nh(n,c,r,o),sh(n)}function yc(n,r,o){if(r=r.updateQueue,r!==null&&(r=r.shared,(o&4194048)!==0)){var c=r.lanes;c&=n.pendingLanes,o|=c,r.lanes=o,_n(n,o)}}function em(n,r){var o=n.updateQueue,c=n.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var f=null,m=null;if(o=o.firstBaseUpdate,o!==null){do{var w={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};m===null?f=m=w:m=m.next=w,o=o.next}while(o!==null);m===null?f=m=r:m=m.next=r}else f=m=r;o={baseState:c.baseState,firstBaseUpdate:f,lastBaseUpdate:m,shared:c.shared,callbacks:c.callbacks},n.updateQueue=o;return}n=o.lastBaseUpdate,n===null?o.firstBaseUpdate=r:n.next=r,o.lastBaseUpdate=r}var tm=!1;function vc(){if(tm){var n=ul;if(n!==null)throw n}}function bc(n,r,o,c){tm=!1;var f=n.updateQueue;_a=!1;var m=f.firstBaseUpdate,w=f.lastBaseUpdate,S=f.shared.pending;if(S!==null){f.shared.pending=null;var U=S,te=U.next;U.next=null,w===null?m=te:w.next=te,w=U;var me=n.alternate;me!==null&&(me=me.updateQueue,S=me.lastBaseUpdate,S!==w&&(S===null?me.firstBaseUpdate=te:S.next=te,me.lastBaseUpdate=U))}if(m!==null){var we=f.baseState;w=0,me=te=U=null,S=m;do{var ie=S.lane&-536870913,de=ie!==S.lane;if(de?($t&ie)===ie:(c&ie)===ie){ie!==0&&ie===cl&&(tm=!0),me!==null&&(me=me.next={lane:0,tag:S.tag,payload:S.payload,callback:null,next:null});e:{var Je=n,ft=S;ie=r;var Tn=o;switch(ft.tag){case 1:if(Je=ft.payload,typeof Je=="function"){we=Je.call(Tn,we,ie);break e}we=Je;break e;case 3:Je.flags=Je.flags&-65537|128;case 0:if(Je=ft.payload,ie=typeof Je=="function"?Je.call(Tn,we,ie):Je,ie==null)break e;we=k({},we,ie);break e;case 2:_a=!0}}ie=S.callback,ie!==null&&(n.flags|=64,de&&(n.flags|=8192),de=f.callbacks,de===null?f.callbacks=[ie]:de.push(ie))}else de={lane:ie,tag:S.tag,payload:S.payload,callback:S.callback,next:null},me===null?(te=me=de,U=we):me=me.next=de,w|=ie;if(S=S.next,S===null){if(S=f.shared.pending,S===null)break;de=S,S=de.next,de.next=null,f.lastBaseUpdate=de,f.shared.pending=null}}while(!0);me===null&&(U=we),f.baseState=U,f.firstBaseUpdate=te,f.lastBaseUpdate=me,m===null&&(f.shared.lanes=0),Ca|=w,n.lanes=w,n.memoizedState=we}}function tv(n,r){if(typeof n!="function")throw Error(i(191,n));n.call(r)}function nv(n,r){var o=n.callbacks;if(o!==null)for(n.callbacks=null,n=0;n<o.length;n++)tv(o[n],r)}var fl=D(null),fh=D(0);function sv(n,r){n=Ki,ve(fh,n),ve(fl,r),Ki=n|r.baseLanes}function nm(){ve(fh,Ki),ve(fl,fl.current)}function sm(){Ki=fh.current,ne(fl),ne(fh)}var _r=D(null),qr=null;function Ea(n){var r=n.alternate;ve(cs,cs.current&1),ve(_r,n),qr===null&&(r===null||fl.current!==null||r.memoizedState!==null)&&(qr=n)}function rm(n){ve(cs,cs.current),ve(_r,n),qr===null&&(qr=n)}function rv(n){n.tag===22?(ve(cs,cs.current),ve(_r,n),qr===null&&(qr=n)):Ta()}function Ta(){ve(cs,cs.current),ve(_r,_r.current)}function xr(n){ne(_r),qr===n&&(qr=null),ne(cs)}var cs=D(0);function mh(n){for(var r=n;r!==null;){if(r.tag===13){var o=r.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||up(o)||hp(o)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Bi=0,Lt=null,kn=null,ps=null,ph=!1,ml=!1,xo=!1,gh=0,wc=0,pl=null,hT=0;function Zn(){throw Error(i(321))}function im(n,r){if(r===null)return!1;for(var o=0;o<r.length&&o<n.length;o++)if(!br(n[o],r[o]))return!1;return!0}function am(n,r,o,c,f,m){return Bi=m,Lt=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,Z.H=n===null||n.memoizedState===null?zv:_m,xo=!1,m=o(c,f),xo=!1,ml&&(m=av(r,o,c,f)),iv(n),m}function iv(n){Z.H=kc;var r=kn!==null&&kn.next!==null;if(Bi=0,ps=kn=Lt=null,ph=!1,wc=0,pl=null,r)throw Error(i(300));n===null||gs||(n=n.dependencies,n!==null&&ah(n)&&(gs=!0))}function av(n,r,o,c){Lt=n;var f=0;do{if(ml&&(pl=null),wc=0,ml=!1,25<=f)throw Error(i(301));if(f+=1,ps=kn=null,n.updateQueue!=null){var m=n.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}Z.H=Fv,m=r(o,c)}while(ml);return m}function dT(){var n=Z.H,r=n.useState()[0];return r=typeof r.then=="function"?_c(r):r,n=n.useState()[0],(kn!==null?kn.memoizedState:null)!==n&&(Lt.flags|=1024),r}function om(){var n=gh!==0;return gh=0,n}function lm(n,r,o){r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~o}function cm(n){if(ph){for(n=n.memoizedState;n!==null;){var r=n.queue;r!==null&&(r.pending=null),n=n.next}ph=!1}Bi=0,ps=kn=Lt=null,ml=!1,wc=gh=0,pl=null}function Js(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ps===null?Lt.memoizedState=ps=n:ps=ps.next=n,ps}function us(){if(kn===null){var n=Lt.alternate;n=n!==null?n.memoizedState:null}else n=kn.next;var r=ps===null?Lt.memoizedState:ps.next;if(r!==null)ps=r,kn=n;else{if(n===null)throw Lt.alternate===null?Error(i(467)):Error(i(310));kn=n,n={memoizedState:kn.memoizedState,baseState:kn.baseState,baseQueue:kn.baseQueue,queue:kn.queue,next:null},ps===null?Lt.memoizedState=ps=n:ps=ps.next=n}return ps}function yh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function _c(n){var r=wc;return wc+=1,pl===null&&(pl=[]),n=Q0(pl,n,r),r=Lt,(ps===null?r.memoizedState:ps.next)===null&&(r=r.alternate,Z.H=r===null||r.memoizedState===null?zv:_m),n}function vh(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return _c(n);if(n.$$typeof===G)return Is(n)}throw Error(i(438,String(n)))}function um(n){var r=null,o=Lt.updateQueue;if(o!==null&&(r=o.memoCache),r==null){var c=Lt.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(r={data:c.data.map(function(f){return f.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),o===null&&(o=yh(),Lt.updateQueue=o),o.memoCache=r,o=r.data[r.index],o===void 0)for(o=r.data[r.index]=Array(n),c=0;c<n;c++)o[c]=P;return r.index++,o}function zi(n,r){return typeof r=="function"?r(n):r}function bh(n){var r=us();return hm(r,kn,n)}function hm(n,r,o){var c=n.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=o;var f=n.baseQueue,m=c.pending;if(m!==null){if(f!==null){var w=f.next;f.next=m.next,m.next=w}r.baseQueue=f=m,c.pending=null}if(m=n.baseState,f===null)n.memoizedState=m;else{r=f.next;var S=w=null,U=null,te=r,me=!1;do{var we=te.lane&-536870913;if(we!==te.lane?($t&we)===we:(Bi&we)===we){var ie=te.revertLane;if(ie===0)U!==null&&(U=U.next={lane:0,revertLane:0,gesture:null,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null}),we===cl&&(me=!0);else if((Bi&ie)===ie){te=te.next,ie===cl&&(me=!0);continue}else we={lane:0,revertLane:te.revertLane,gesture:null,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null},U===null?(S=U=we,w=m):U=U.next=we,Lt.lanes|=ie,Ca|=ie;we=te.action,xo&&o(m,we),m=te.hasEagerState?te.eagerState:o(m,we)}else ie={lane:we,revertLane:te.revertLane,gesture:te.gesture,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null},U===null?(S=U=ie,w=m):U=U.next=ie,Lt.lanes|=we,Ca|=we;te=te.next}while(te!==null&&te!==r);if(U===null?w=m:U.next=S,!br(m,n.memoizedState)&&(gs=!0,me&&(o=ul,o!==null)))throw o;n.memoizedState=m,n.baseState=w,n.baseQueue=U,c.lastRenderedState=m}return f===null&&(c.lanes=0),[n.memoizedState,c.dispatch]}function dm(n){var r=us(),o=r.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=n;var c=o.dispatch,f=o.pending,m=r.memoizedState;if(f!==null){o.pending=null;var w=f=f.next;do m=n(m,w.action),w=w.next;while(w!==f);br(m,r.memoizedState)||(gs=!0),r.memoizedState=m,r.baseQueue===null&&(r.baseState=m),o.lastRenderedState=m}return[m,c]}function ov(n,r,o){var c=Lt,f=us(),m=Xt;if(m){if(o===void 0)throw Error(i(407));o=o()}else o=r();var w=!br((kn||f).memoizedState,o);if(w&&(f.memoizedState=o,gs=!0),f=f.queue,pm(uv.bind(null,c,f,n),[n]),f.getSnapshot!==r||w||ps!==null&&ps.memoizedState.tag&1){if(c.flags|=2048,gl(9,{destroy:void 0},cv.bind(null,c,f,o,r),null),jn===null)throw Error(i(349));m||(Bi&127)!==0||lv(c,r,o)}return o}function lv(n,r,o){n.flags|=16384,n={getSnapshot:r,value:o},r=Lt.updateQueue,r===null?(r=yh(),Lt.updateQueue=r,r.stores=[n]):(o=r.stores,o===null?r.stores=[n]:o.push(n))}function cv(n,r,o,c){r.value=o,r.getSnapshot=c,hv(r)&&dv(n)}function uv(n,r,o){return o(function(){hv(r)&&dv(n)})}function hv(n){var r=n.getSnapshot;n=n.value;try{var o=r();return!br(n,o)}catch{return!0}}function dv(n){var r=fo(n,2);r!==null&&dr(r,n,2)}function fm(n){var r=Js();if(typeof n=="function"){var o=n;if(n=o(),xo){st(!0);try{o()}finally{st(!1)}}}return r.memoizedState=r.baseState=n,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:zi,lastRenderedState:n},r}function fv(n,r,o,c){return n.baseState=o,hm(n,kn,typeof c=="function"?c:zi)}function fT(n,r,o,c,f){if(xh(n))throw Error(i(485));if(n=r.action,n!==null){var m={payload:f,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){m.listeners.push(w)}};Z.T!==null?o(!0):m.isTransition=!1,c(m),o=r.pending,o===null?(m.next=r.pending=m,mv(r,m)):(m.next=o.next,r.pending=o.next=m)}}function mv(n,r){var o=r.action,c=r.payload,f=n.state;if(r.isTransition){var m=Z.T,w={};Z.T=w;try{var S=o(f,c),U=Z.S;U!==null&&U(w,S),pv(n,r,S)}catch(te){mm(n,r,te)}finally{m!==null&&w.types!==null&&(m.types=w.types),Z.T=m}}else try{m=o(f,c),pv(n,r,m)}catch(te){mm(n,r,te)}}function pv(n,r,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){gv(n,r,c)},function(c){return mm(n,r,c)}):gv(n,r,o)}function gv(n,r,o){r.status="fulfilled",r.value=o,yv(r),n.state=o,r=n.pending,r!==null&&(o=r.next,o===r?n.pending=null:(o=o.next,r.next=o,mv(n,o)))}function mm(n,r,o){var c=n.pending;if(n.pending=null,c!==null){c=c.next;do r.status="rejected",r.reason=o,yv(r),r=r.next;while(r!==c)}n.action=null}function yv(n){n=n.listeners;for(var r=0;r<n.length;r++)(0,n[r])()}function vv(n,r){return r}function bv(n,r){if(Xt){var o=jn.formState;if(o!==null){e:{var c=Lt;if(Xt){if(Pn){t:{for(var f=Pn,m=Fr;f.nodeType!==8;){if(!m){f=null;break t}if(f=Hr(f.nextSibling),f===null){f=null;break t}}m=f.data,f=m==="F!"||m==="F"?f:null}if(f){Pn=Hr(f.nextSibling),c=f.data==="F!";break e}}ba(c)}c=!1}c&&(r=o[0])}}return o=Js(),o.memoizedState=o.baseState=r,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:vv,lastRenderedState:r},o.queue=c,o=Vv.bind(null,Lt,c),c.dispatch=o,c=fm(!1),m=wm.bind(null,Lt,!1,c.queue),c=Js(),f={state:r,dispatch:null,action:n,pending:null},c.queue=f,o=fT.bind(null,Lt,f,m,o),f.dispatch=o,c.memoizedState=n,[r,o,!1]}function wv(n){var r=us();return _v(r,kn,n)}function _v(n,r,o){if(r=hm(n,r,vv)[0],n=bh(zi)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var c=_c(r)}catch(w){throw w===hl?ch:w}else c=r;r=us();var f=r.queue,m=f.dispatch;return o!==r.memoizedState&&(Lt.flags|=2048,gl(9,{destroy:void 0},mT.bind(null,f,o),null)),[c,m,n]}function mT(n,r){n.action=r}function xv(n){var r=us(),o=kn;if(o!==null)return _v(r,o,n);us(),r=r.memoizedState,o=us();var c=o.queue.dispatch;return o.memoizedState=n,[r,c,!1]}function gl(n,r,o,c){return n={tag:n,create:o,deps:c,inst:r,next:null},r=Lt.updateQueue,r===null&&(r=yh(),Lt.updateQueue=r),o=r.lastEffect,o===null?r.lastEffect=n.next=n:(c=o.next,o.next=n,n.next=c,r.lastEffect=n),n}function kv(){return us().memoizedState}function wh(n,r,o,c){var f=Js();Lt.flags|=n,f.memoizedState=gl(1|r,{destroy:void 0},o,c===void 0?null:c)}function _h(n,r,o,c){var f=us();c=c===void 0?null:c;var m=f.memoizedState.inst;kn!==null&&c!==null&&im(c,kn.memoizedState.deps)?f.memoizedState=gl(r,m,o,c):(Lt.flags|=n,f.memoizedState=gl(1|r,m,o,c))}function Ev(n,r){wh(8390656,8,n,r)}function pm(n,r){_h(2048,8,n,r)}function pT(n){Lt.flags|=4;var r=Lt.updateQueue;if(r===null)r=yh(),Lt.updateQueue=r,r.events=[n];else{var o=r.events;o===null?r.events=[n]:o.push(n)}}function Tv(n){var r=us().memoizedState;return pT({ref:r,nextImpl:n}),function(){if((mn&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function Sv(n,r){return _h(4,2,n,r)}function jv(n,r){return _h(4,4,n,r)}function Cv(n,r){if(typeof r=="function"){n=n();var o=r(n);return function(){typeof o=="function"?o():r(null)}}if(r!=null)return n=n(),r.current=n,function(){r.current=null}}function Nv(n,r,o){o=o!=null?o.concat([n]):null,_h(4,4,Cv.bind(null,r,n),o)}function gm(){}function Av(n,r){var o=us();r=r===void 0?null:r;var c=o.memoizedState;return r!==null&&im(r,c[1])?c[0]:(o.memoizedState=[n,r],n)}function Rv(n,r){var o=us();r=r===void 0?null:r;var c=o.memoizedState;if(r!==null&&im(r,c[1]))return c[0];if(c=n(),xo){st(!0);try{n()}finally{st(!1)}}return o.memoizedState=[c,r],c}function ym(n,r,o){return o===void 0||(Bi&1073741824)!==0&&($t&261930)===0?n.memoizedState=r:(n.memoizedState=o,n=I1(),Lt.lanes|=n,Ca|=n,o)}function Iv(n,r,o,c){return br(o,r)?o:fl.current!==null?(n=ym(n,o,c),br(n,r)||(gs=!0),n):(Bi&42)===0||(Bi&1073741824)!==0&&($t&261930)===0?(gs=!0,n.memoizedState=o):(n=I1(),Lt.lanes|=n,Ca|=n,r)}function Dv(n,r,o,c,f){var m=ue.p;ue.p=m!==0&&8>m?m:8;var w=Z.T,S={};Z.T=S,wm(n,!1,r,o);try{var U=f(),te=Z.S;if(te!==null&&te(S,U),U!==null&&typeof U=="object"&&typeof U.then=="function"){var me=uT(U,c);xc(n,r,me,Tr(n))}else xc(n,r,c,Tr(n))}catch(we){xc(n,r,{then:function(){},status:"rejected",reason:we},Tr())}finally{ue.p=m,w!==null&&S.types!==null&&(w.types=S.types),Z.T=w}}function gT(){}function vm(n,r,o,c){if(n.tag!==5)throw Error(i(476));var f=Mv(n).queue;Dv(n,f,r,Ce,o===null?gT:function(){return Lv(n),o(c)})}function Mv(n){var r=n.memoizedState;if(r!==null)return r;r={memoizedState:Ce,baseState:Ce,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:zi,lastRenderedState:Ce},next:null};var o={};return r.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:zi,lastRenderedState:o},next:null},n.memoizedState=r,n=n.alternate,n!==null&&(n.memoizedState=r),r}function Lv(n){var r=Mv(n);r.next===null&&(r=n.alternate.memoizedState),xc(n,r.next.queue,{},Tr())}function bm(){return Is(Uc)}function Ov(){return us().memoizedState}function Pv(){return us().memoizedState}function yT(n){for(var r=n.return;r!==null;){switch(r.tag){case 24:case 3:var o=Tr();n=xa(o);var c=ka(r,n,o);c!==null&&(dr(c,r,o),yc(c,r,o)),r={cache:Kf()},n.payload=r;return}r=r.return}}function vT(n,r,o){var c=Tr();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},xh(n)?Uv(r,o):(o=Pf(n,r,o,c),o!==null&&(dr(o,n,c),Bv(o,r,c)))}function Vv(n,r,o){var c=Tr();xc(n,r,o,c)}function xc(n,r,o,c){var f={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(xh(n))Uv(r,f);else{var m=n.alternate;if(n.lanes===0&&(m===null||m.lanes===0)&&(m=r.lastRenderedReducer,m!==null))try{var w=r.lastRenderedState,S=m(w,o);if(f.hasEagerState=!0,f.eagerState=S,br(S,w))return nh(n,r,f,0),jn===null&&th(),!1}catch{}if(o=Pf(n,r,f,c),o!==null)return dr(o,n,c),Bv(o,r,c),!0}return!1}function wm(n,r,o,c){if(c={lane:2,revertLane:Jm(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},xh(n)){if(r)throw Error(i(479))}else r=Pf(n,o,c,2),r!==null&&dr(r,n,2)}function xh(n){var r=n.alternate;return n===Lt||r!==null&&r===Lt}function Uv(n,r){ml=ph=!0;var o=n.pending;o===null?r.next=r:(r.next=o.next,o.next=r),n.pending=r}function Bv(n,r,o){if((o&4194048)!==0){var c=r.lanes;c&=n.pendingLanes,o|=c,r.lanes=o,_n(n,o)}}var kc={readContext:Is,use:vh,useCallback:Zn,useContext:Zn,useEffect:Zn,useImperativeHandle:Zn,useLayoutEffect:Zn,useInsertionEffect:Zn,useMemo:Zn,useReducer:Zn,useRef:Zn,useState:Zn,useDebugValue:Zn,useDeferredValue:Zn,useTransition:Zn,useSyncExternalStore:Zn,useId:Zn,useHostTransitionStatus:Zn,useFormState:Zn,useActionState:Zn,useOptimistic:Zn,useMemoCache:Zn,useCacheRefresh:Zn};kc.useEffectEvent=Zn;var zv={readContext:Is,use:vh,useCallback:function(n,r){return Js().memoizedState=[n,r===void 0?null:r],n},useContext:Is,useEffect:Ev,useImperativeHandle:function(n,r,o){o=o!=null?o.concat([n]):null,wh(4194308,4,Cv.bind(null,r,n),o)},useLayoutEffect:function(n,r){return wh(4194308,4,n,r)},useInsertionEffect:function(n,r){wh(4,2,n,r)},useMemo:function(n,r){var o=Js();r=r===void 0?null:r;var c=n();if(xo){st(!0);try{n()}finally{st(!1)}}return o.memoizedState=[c,r],c},useReducer:function(n,r,o){var c=Js();if(o!==void 0){var f=o(r);if(xo){st(!0);try{o(r)}finally{st(!1)}}}else f=r;return c.memoizedState=c.baseState=f,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:f},c.queue=n,n=n.dispatch=vT.bind(null,Lt,n),[c.memoizedState,n]},useRef:function(n){var r=Js();return n={current:n},r.memoizedState=n},useState:function(n){n=fm(n);var r=n.queue,o=Vv.bind(null,Lt,r);return r.dispatch=o,[n.memoizedState,o]},useDebugValue:gm,useDeferredValue:function(n,r){var o=Js();return ym(o,n,r)},useTransition:function(){var n=fm(!1);return n=Dv.bind(null,Lt,n.queue,!0,!1),Js().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,r,o){var c=Lt,f=Js();if(Xt){if(o===void 0)throw Error(i(407));o=o()}else{if(o=r(),jn===null)throw Error(i(349));($t&127)!==0||lv(c,r,o)}f.memoizedState=o;var m={value:o,getSnapshot:r};return f.queue=m,Ev(uv.bind(null,c,m,n),[n]),c.flags|=2048,gl(9,{destroy:void 0},cv.bind(null,c,m,o,r),null),o},useId:function(){var n=Js(),r=jn.identifierPrefix;if(Xt){var o=bi,c=vi;o=(c&~(1<<32-Fe(c)-1)).toString(32)+o,r="_"+r+"R_"+o,o=gh++,0<o&&(r+="H"+o.toString(32)),r+="_"}else o=hT++,r="_"+r+"r_"+o.toString(32)+"_";return n.memoizedState=r},useHostTransitionStatus:bm,useFormState:bv,useActionState:bv,useOptimistic:function(n){var r=Js();r.memoizedState=r.baseState=n;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=o,r=wm.bind(null,Lt,!0,o),o.dispatch=r,[n,r]},useMemoCache:um,useCacheRefresh:function(){return Js().memoizedState=yT.bind(null,Lt)},useEffectEvent:function(n){var r=Js(),o={impl:n};return r.memoizedState=o,function(){if((mn&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},_m={readContext:Is,use:vh,useCallback:Av,useContext:Is,useEffect:pm,useImperativeHandle:Nv,useInsertionEffect:Sv,useLayoutEffect:jv,useMemo:Rv,useReducer:bh,useRef:kv,useState:function(){return bh(zi)},useDebugValue:gm,useDeferredValue:function(n,r){var o=us();return Iv(o,kn.memoizedState,n,r)},useTransition:function(){var n=bh(zi)[0],r=us().memoizedState;return[typeof n=="boolean"?n:_c(n),r]},useSyncExternalStore:ov,useId:Ov,useHostTransitionStatus:bm,useFormState:wv,useActionState:wv,useOptimistic:function(n,r){var o=us();return fv(o,kn,n,r)},useMemoCache:um,useCacheRefresh:Pv};_m.useEffectEvent=Tv;var Fv={readContext:Is,use:vh,useCallback:Av,useContext:Is,useEffect:pm,useImperativeHandle:Nv,useInsertionEffect:Sv,useLayoutEffect:jv,useMemo:Rv,useReducer:dm,useRef:kv,useState:function(){return dm(zi)},useDebugValue:gm,useDeferredValue:function(n,r){var o=us();return kn===null?ym(o,n,r):Iv(o,kn.memoizedState,n,r)},useTransition:function(){var n=dm(zi)[0],r=us().memoizedState;return[typeof n=="boolean"?n:_c(n),r]},useSyncExternalStore:ov,useId:Ov,useHostTransitionStatus:bm,useFormState:xv,useActionState:xv,useOptimistic:function(n,r){var o=us();return kn!==null?fv(o,kn,n,r):(o.baseState=n,[n,o.queue.dispatch])},useMemoCache:um,useCacheRefresh:Pv};Fv.useEffectEvent=Tv;function xm(n,r,o,c){r=n.memoizedState,o=o(c,r),o=o==null?r:k({},r,o),n.memoizedState=o,n.lanes===0&&(n.updateQueue.baseState=o)}var km={enqueueSetState:function(n,r,o){n=n._reactInternals;var c=Tr(),f=xa(c);f.payload=r,o!=null&&(f.callback=o),r=ka(n,f,c),r!==null&&(dr(r,n,c),yc(r,n,c))},enqueueReplaceState:function(n,r,o){n=n._reactInternals;var c=Tr(),f=xa(c);f.tag=1,f.payload=r,o!=null&&(f.callback=o),r=ka(n,f,c),r!==null&&(dr(r,n,c),yc(r,n,c))},enqueueForceUpdate:function(n,r){n=n._reactInternals;var o=Tr(),c=xa(o);c.tag=2,r!=null&&(c.callback=r),r=ka(n,c,o),r!==null&&(dr(r,n,o),yc(r,n,o))}};function qv(n,r,o,c,f,m,w){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(c,m,w):r.prototype&&r.prototype.isPureReactComponent?!cc(o,c)||!cc(f,m):!0}function Hv(n,r,o,c){n=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(o,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(o,c),r.state!==n&&km.enqueueReplaceState(r,r.state,null)}function ko(n,r){var o=r;if("ref"in r){o={};for(var c in r)c!=="ref"&&(o[c]=r[c])}if(n=n.defaultProps){o===r&&(o=k({},o));for(var f in n)o[f]===void 0&&(o[f]=n[f])}return o}function $v(n){eh(n)}function Wv(n){console.error(n)}function Gv(n){eh(n)}function kh(n,r){try{var o=n.onUncaughtError;o(r.value,{componentStack:r.stack})}catch(c){setTimeout(function(){throw c})}}function Kv(n,r,o){try{var c=n.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function Em(n,r,o){return o=xa(o),o.tag=3,o.payload={element:null},o.callback=function(){kh(n,r)},o}function Yv(n){return n=xa(n),n.tag=3,n}function Qv(n,r,o,c){var f=o.type.getDerivedStateFromError;if(typeof f=="function"){var m=c.value;n.payload=function(){return f(m)},n.callback=function(){Kv(r,o,c)}}var w=o.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(n.callback=function(){Kv(r,o,c),typeof f!="function"&&(Na===null?Na=new Set([this]):Na.add(this));var S=c.stack;this.componentDidCatch(c.value,{componentStack:S!==null?S:""})})}function bT(n,r,o,c,f){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(r=o.alternate,r!==null&&ll(r,o,f,!0),o=_r.current,o!==null){switch(o.tag){case 31:case 13:return qr===null?Lh():o.alternate===null&&es===0&&(es=3),o.flags&=-257,o.flags|=65536,o.lanes=f,c===uh?o.flags|=16384:(r=o.updateQueue,r===null?o.updateQueue=new Set([c]):r.add(c),Ym(n,c,f)),!1;case 22:return o.flags|=65536,c===uh?o.flags|=16384:(r=o.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=r):(o=r.retryQueue,o===null?r.retryQueue=new Set([c]):o.add(c)),Ym(n,c,f)),!1}throw Error(i(435,o.tag))}return Ym(n,c,f),Lh(),!1}if(Xt)return r=_r.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=f,c!==qf&&(n=Error(i(422),{cause:c}),dc(Ur(n,o)))):(c!==qf&&(r=Error(i(423),{cause:c}),dc(Ur(r,o))),n=n.current.alternate,n.flags|=65536,f&=-f,n.lanes|=f,c=Ur(c,o),f=Em(n.stateNode,c,f),em(n,f),es!==4&&(es=2)),!1;var m=Error(i(520),{cause:c});if(m=Ur(m,o),Rc===null?Rc=[m]:Rc.push(m),es!==4&&(es=2),r===null)return!0;c=Ur(c,o),o=r;do{switch(o.tag){case 3:return o.flags|=65536,n=f&-f,o.lanes|=n,n=Em(o.stateNode,c,n),em(o,n),!1;case 1:if(r=o.type,m=o.stateNode,(o.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Na===null||!Na.has(m))))return o.flags|=65536,f&=-f,o.lanes|=f,f=Yv(f),Qv(f,n,o,c),em(o,f),!1}o=o.return}while(o!==null);return!1}var Tm=Error(i(461)),gs=!1;function Ds(n,r,o,c){r.child=n===null?ev(r,null,o,c):_o(r,n.child,o,c)}function Xv(n,r,o,c,f){o=o.render;var m=r.ref;if("ref"in c){var w={};for(var S in c)S!=="ref"&&(w[S]=c[S])}else w=c;return yo(r),c=am(n,r,o,w,m,f),S=om(),n!==null&&!gs?(lm(n,r,f),Fi(n,r,f)):(Xt&&S&&zf(r),r.flags|=1,Ds(n,r,c,f),r.child)}function Jv(n,r,o,c,f){if(n===null){var m=o.type;return typeof m=="function"&&!Vf(m)&&m.defaultProps===void 0&&o.compare===null?(r.tag=15,r.type=m,Zv(n,r,m,c,f)):(n=rh(o.type,null,c,r,r.mode,f),n.ref=r.ref,n.return=r,r.child=n)}if(m=n.child,!Dm(n,f)){var w=m.memoizedProps;if(o=o.compare,o=o!==null?o:cc,o(w,c)&&n.ref===r.ref)return Fi(n,r,f)}return r.flags|=1,n=Oi(m,c),n.ref=r.ref,n.return=r,r.child=n}function Zv(n,r,o,c,f){if(n!==null){var m=n.memoizedProps;if(cc(m,c)&&n.ref===r.ref)if(gs=!1,r.pendingProps=c=m,Dm(n,f))(n.flags&131072)!==0&&(gs=!0);else return r.lanes=n.lanes,Fi(n,r,f)}return Sm(n,r,o,c,f)}function e1(n,r,o,c){var f=c.children,m=n!==null?n.memoizedState:null;if(n===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((r.flags&128)!==0){if(m=m!==null?m.baseLanes|o:o,n!==null){for(c=r.child=n.child,f=0;c!==null;)f=f|c.lanes|c.childLanes,c=c.sibling;c=f&~m}else c=0,r.child=null;return t1(n,r,m,o,c)}if((o&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},n!==null&&lh(r,m!==null?m.cachePool:null),m!==null?sv(r,m):nm(),rv(r);else return c=r.lanes=536870912,t1(n,r,m!==null?m.baseLanes|o:o,o,c)}else m!==null?(lh(r,m.cachePool),sv(r,m),Ta(),r.memoizedState=null):(n!==null&&lh(r,null),nm(),Ta());return Ds(n,r,f,o),r.child}function Ec(n,r){return n!==null&&n.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function t1(n,r,o,c,f){var m=Qf();return m=m===null?null:{parent:ms._currentValue,pool:m},r.memoizedState={baseLanes:o,cachePool:m},n!==null&&lh(r,null),nm(),rv(r),n!==null&&ll(n,r,c,!0),r.childLanes=f,null}function Eh(n,r){return r=Sh({mode:r.mode,children:r.children},n.mode),r.ref=n.ref,n.child=r,r.return=n,r}function n1(n,r,o){return _o(r,n.child,null,o),n=Eh(r,r.pendingProps),n.flags|=2,xr(r),r.memoizedState=null,n}function wT(n,r,o){var c=r.pendingProps,f=(r.flags&128)!==0;if(r.flags&=-129,n===null){if(Xt){if(c.mode==="hidden")return n=Eh(r,c),r.lanes=536870912,Ec(null,n);if(rm(r),(n=Pn)?(n=mb(n,Fr),n=n!==null&&n.data==="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:ya!==null?{id:vi,overflow:bi}:null,retryLane:536870912,hydrationErrors:null},o=U0(n),o.return=r,r.child=o,Rs=r,Pn=null)):n=null,n===null)throw ba(r);return r.lanes=536870912,null}return Eh(r,c)}var m=n.memoizedState;if(m!==null){var w=m.dehydrated;if(rm(r),f)if(r.flags&256)r.flags&=-257,r=n1(n,r,o);else if(r.memoizedState!==null)r.child=n.child,r.flags|=128,r=null;else throw Error(i(558));else if(gs||ll(n,r,o,!1),f=(o&n.childLanes)!==0,gs||f){if(c=jn,c!==null&&(w=Rn(c,o),w!==0&&w!==m.retryLane))throw m.retryLane=w,fo(n,w),dr(c,n,w),Tm;Lh(),r=n1(n,r,o)}else n=m.treeContext,Pn=Hr(w.nextSibling),Rs=r,Xt=!0,va=null,Fr=!1,n!==null&&F0(r,n),r=Eh(r,c),r.flags|=4096;return r}return n=Oi(n.child,{mode:c.mode,children:c.children}),n.ref=r.ref,r.child=n,n.return=r,n}function Th(n,r){var o=r.ref;if(o===null)n!==null&&n.ref!==null&&(r.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(n===null||n.ref!==o)&&(r.flags|=4194816)}}function Sm(n,r,o,c,f){return yo(r),o=am(n,r,o,c,void 0,f),c=om(),n!==null&&!gs?(lm(n,r,f),Fi(n,r,f)):(Xt&&c&&zf(r),r.flags|=1,Ds(n,r,o,f),r.child)}function s1(n,r,o,c,f,m){return yo(r),r.updateQueue=null,o=av(r,c,o,f),iv(n),c=om(),n!==null&&!gs?(lm(n,r,m),Fi(n,r,m)):(Xt&&c&&zf(r),r.flags|=1,Ds(n,r,o,m),r.child)}function r1(n,r,o,c,f){if(yo(r),r.stateNode===null){var m=rl,w=o.contextType;typeof w=="object"&&w!==null&&(m=Is(w)),m=new o(c,m),r.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=km,r.stateNode=m,m._reactInternals=r,m=r.stateNode,m.props=c,m.state=r.memoizedState,m.refs={},Jf(r),w=o.contextType,m.context=typeof w=="object"&&w!==null?Is(w):rl,m.state=r.memoizedState,w=o.getDerivedStateFromProps,typeof w=="function"&&(xm(r,o,w,c),m.state=r.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(w=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),w!==m.state&&km.enqueueReplaceState(m,m.state,null),bc(r,c,m,f),vc(),m.state=r.memoizedState),typeof m.componentDidMount=="function"&&(r.flags|=4194308),c=!0}else if(n===null){m=r.stateNode;var S=r.memoizedProps,U=ko(o,S);m.props=U;var te=m.context,me=o.contextType;w=rl,typeof me=="object"&&me!==null&&(w=Is(me));var we=o.getDerivedStateFromProps;me=typeof we=="function"||typeof m.getSnapshotBeforeUpdate=="function",S=r.pendingProps!==S,me||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(S||te!==w)&&Hv(r,m,c,w),_a=!1;var ie=r.memoizedState;m.state=ie,bc(r,c,m,f),vc(),te=r.memoizedState,S||ie!==te||_a?(typeof we=="function"&&(xm(r,o,we,c),te=r.memoizedState),(U=_a||qv(r,o,U,c,ie,te,w))?(me||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(r.flags|=4194308)):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=te),m.props=c,m.state=te,m.context=w,c=U):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{m=r.stateNode,Zf(n,r),w=r.memoizedProps,me=ko(o,w),m.props=me,we=r.pendingProps,ie=m.context,te=o.contextType,U=rl,typeof te=="object"&&te!==null&&(U=Is(te)),S=o.getDerivedStateFromProps,(te=typeof S=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(w!==we||ie!==U)&&Hv(r,m,c,U),_a=!1,ie=r.memoizedState,m.state=ie,bc(r,c,m,f),vc();var de=r.memoizedState;w!==we||ie!==de||_a||n!==null&&n.dependencies!==null&&ah(n.dependencies)?(typeof S=="function"&&(xm(r,o,S,c),de=r.memoizedState),(me=_a||qv(r,o,me,c,ie,de,U)||n!==null&&n.dependencies!==null&&ah(n.dependencies))?(te||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(c,de,U),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(c,de,U)),typeof m.componentDidUpdate=="function"&&(r.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof m.componentDidUpdate!="function"||w===n.memoizedProps&&ie===n.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||w===n.memoizedProps&&ie===n.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=de),m.props=c,m.state=de,m.context=U,c=me):(typeof m.componentDidUpdate!="function"||w===n.memoizedProps&&ie===n.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||w===n.memoizedProps&&ie===n.memoizedState||(r.flags|=1024),c=!1)}return m=c,Th(n,r),c=(r.flags&128)!==0,m||c?(m=r.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:m.render(),r.flags|=1,n!==null&&c?(r.child=_o(r,n.child,null,f),r.child=_o(r,null,o,f)):Ds(n,r,o,f),r.memoizedState=m.state,n=r.child):n=Fi(n,r,f),n}function i1(n,r,o,c){return po(),r.flags|=256,Ds(n,r,o,c),r.child}var jm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Cm(n){return{baseLanes:n,cachePool:K0()}}function Nm(n,r,o){return n=n!==null?n.childLanes&~o:0,r&&(n|=Er),n}function a1(n,r,o){var c=r.pendingProps,f=!1,m=(r.flags&128)!==0,w;if((w=m)||(w=n!==null&&n.memoizedState===null?!1:(cs.current&2)!==0),w&&(f=!0,r.flags&=-129),w=(r.flags&32)!==0,r.flags&=-33,n===null){if(Xt){if(f?Ea(r):Ta(),(n=Pn)?(n=mb(n,Fr),n=n!==null&&n.data!=="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:ya!==null?{id:vi,overflow:bi}:null,retryLane:536870912,hydrationErrors:null},o=U0(n),o.return=r,r.child=o,Rs=r,Pn=null)):n=null,n===null)throw ba(r);return hp(n)?r.lanes=32:r.lanes=536870912,null}var S=c.children;return c=c.fallback,f?(Ta(),f=r.mode,S=Sh({mode:"hidden",children:S},f),c=mo(c,f,o,null),S.return=r,c.return=r,S.sibling=c,r.child=S,c=r.child,c.memoizedState=Cm(o),c.childLanes=Nm(n,w,o),r.memoizedState=jm,Ec(null,c)):(Ea(r),Am(r,S))}var U=n.memoizedState;if(U!==null&&(S=U.dehydrated,S!==null)){if(m)r.flags&256?(Ea(r),r.flags&=-257,r=Rm(n,r,o)):r.memoizedState!==null?(Ta(),r.child=n.child,r.flags|=128,r=null):(Ta(),S=c.fallback,f=r.mode,c=Sh({mode:"visible",children:c.children},f),S=mo(S,f,o,null),S.flags|=2,c.return=r,S.return=r,c.sibling=S,r.child=c,_o(r,n.child,null,o),c=r.child,c.memoizedState=Cm(o),c.childLanes=Nm(n,w,o),r.memoizedState=jm,r=Ec(null,c));else if(Ea(r),hp(S)){if(w=S.nextSibling&&S.nextSibling.dataset,w)var te=w.dgst;w=te,c=Error(i(419)),c.stack="",c.digest=w,dc({value:c,source:null,stack:null}),r=Rm(n,r,o)}else if(gs||ll(n,r,o,!1),w=(o&n.childLanes)!==0,gs||w){if(w=jn,w!==null&&(c=Rn(w,o),c!==0&&c!==U.retryLane))throw U.retryLane=c,fo(n,c),dr(w,n,c),Tm;up(S)||Lh(),r=Rm(n,r,o)}else up(S)?(r.flags|=192,r.child=n.child,r=null):(n=U.treeContext,Pn=Hr(S.nextSibling),Rs=r,Xt=!0,va=null,Fr=!1,n!==null&&F0(r,n),r=Am(r,c.children),r.flags|=4096);return r}return f?(Ta(),S=c.fallback,f=r.mode,U=n.child,te=U.sibling,c=Oi(U,{mode:"hidden",children:c.children}),c.subtreeFlags=U.subtreeFlags&65011712,te!==null?S=Oi(te,S):(S=mo(S,f,o,null),S.flags|=2),S.return=r,c.return=r,c.sibling=S,r.child=c,Ec(null,c),c=r.child,S=n.child.memoizedState,S===null?S=Cm(o):(f=S.cachePool,f!==null?(U=ms._currentValue,f=f.parent!==U?{parent:U,pool:U}:f):f=K0(),S={baseLanes:S.baseLanes|o,cachePool:f}),c.memoizedState=S,c.childLanes=Nm(n,w,o),r.memoizedState=jm,Ec(n.child,c)):(Ea(r),o=n.child,n=o.sibling,o=Oi(o,{mode:"visible",children:c.children}),o.return=r,o.sibling=null,n!==null&&(w=r.deletions,w===null?(r.deletions=[n],r.flags|=16):w.push(n)),r.child=o,r.memoizedState=null,o)}function Am(n,r){return r=Sh({mode:"visible",children:r},n.mode),r.return=n,n.child=r}function Sh(n,r){return n=wr(22,n,null,r),n.lanes=0,n}function Rm(n,r,o){return _o(r,n.child,null,o),n=Am(r,r.pendingProps.children),n.flags|=2,r.memoizedState=null,n}function o1(n,r,o){n.lanes|=r;var c=n.alternate;c!==null&&(c.lanes|=r),Wf(n.return,r,o)}function Im(n,r,o,c,f,m){var w=n.memoizedState;w===null?n.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:f,treeForkCount:m}:(w.isBackwards=r,w.rendering=null,w.renderingStartTime=0,w.last=c,w.tail=o,w.tailMode=f,w.treeForkCount=m)}function l1(n,r,o){var c=r.pendingProps,f=c.revealOrder,m=c.tail;c=c.children;var w=cs.current,S=(w&2)!==0;if(S?(w=w&1|2,r.flags|=128):w&=1,ve(cs,w),Ds(n,r,c,o),c=Xt?hc:0,!S&&n!==null&&(n.flags&128)!==0)e:for(n=r.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&o1(n,o,r);else if(n.tag===19)o1(n,o,r);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break e;for(;n.sibling===null;){if(n.return===null||n.return===r)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(f){case"forwards":for(o=r.child,f=null;o!==null;)n=o.alternate,n!==null&&mh(n)===null&&(f=o),o=o.sibling;o=f,o===null?(f=r.child,r.child=null):(f=o.sibling,o.sibling=null),Im(r,!1,f,o,m,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,f=r.child,r.child=null;f!==null;){if(n=f.alternate,n!==null&&mh(n)===null){r.child=f;break}n=f.sibling,f.sibling=o,o=f,f=n}Im(r,!0,o,null,m,c);break;case"together":Im(r,!1,null,null,void 0,c);break;default:r.memoizedState=null}return r.child}function Fi(n,r,o){if(n!==null&&(r.dependencies=n.dependencies),Ca|=r.lanes,(o&r.childLanes)===0)if(n!==null){if(ll(n,r,o,!1),(o&r.childLanes)===0)return null}else return null;if(n!==null&&r.child!==n.child)throw Error(i(153));if(r.child!==null){for(n=r.child,o=Oi(n,n.pendingProps),r.child=o,o.return=r;n.sibling!==null;)n=n.sibling,o=o.sibling=Oi(n,n.pendingProps),o.return=r;o.sibling=null}return r.child}function Dm(n,r){return(n.lanes&r)!==0?!0:(n=n.dependencies,!!(n!==null&&ah(n)))}function _T(n,r,o){switch(r.tag){case 3:ct(r,r.stateNode.containerInfo),wa(r,ms,n.memoizedState.cache),po();break;case 27:case 5:sn(r);break;case 4:ct(r,r.stateNode.containerInfo);break;case 10:wa(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,rm(r),null;break;case 13:var c=r.memoizedState;if(c!==null)return c.dehydrated!==null?(Ea(r),r.flags|=128,null):(o&r.child.childLanes)!==0?a1(n,r,o):(Ea(r),n=Fi(n,r,o),n!==null?n.sibling:null);Ea(r);break;case 19:var f=(n.flags&128)!==0;if(c=(o&r.childLanes)!==0,c||(ll(n,r,o,!1),c=(o&r.childLanes)!==0),f){if(c)return l1(n,r,o);r.flags|=128}if(f=r.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),ve(cs,cs.current),c)break;return null;case 22:return r.lanes=0,e1(n,r,o,r.pendingProps);case 24:wa(r,ms,n.memoizedState.cache)}return Fi(n,r,o)}function c1(n,r,o){if(n!==null)if(n.memoizedProps!==r.pendingProps)gs=!0;else{if(!Dm(n,o)&&(r.flags&128)===0)return gs=!1,_T(n,r,o);gs=(n.flags&131072)!==0}else gs=!1,Xt&&(r.flags&1048576)!==0&&z0(r,hc,r.index);switch(r.lanes=0,r.tag){case 16:e:{var c=r.pendingProps;if(n=bo(r.elementType),r.type=n,typeof n=="function")Vf(n)?(c=ko(n,c),r.tag=1,r=r1(null,r,n,c,o)):(r.tag=0,r=Sm(null,r,n,c,o));else{if(n!=null){var f=n.$$typeof;if(f===fe){r.tag=11,r=Xv(null,r,n,c,o);break e}else if(f===j){r.tag=14,r=Jv(null,r,n,c,o);break e}}throw r=Ve(n)||n,Error(i(306,r,""))}}return r;case 0:return Sm(n,r,r.type,r.pendingProps,o);case 1:return c=r.type,f=ko(c,r.pendingProps),r1(n,r,c,f,o);case 3:e:{if(ct(r,r.stateNode.containerInfo),n===null)throw Error(i(387));c=r.pendingProps;var m=r.memoizedState;f=m.element,Zf(n,r),bc(r,c,null,o);var w=r.memoizedState;if(c=w.cache,wa(r,ms,c),c!==m.cache&&Gf(r,[ms],o,!0),vc(),c=w.element,m.isDehydrated)if(m={element:c,isDehydrated:!1,cache:w.cache},r.updateQueue.baseState=m,r.memoizedState=m,r.flags&256){r=i1(n,r,c,o);break e}else if(c!==f){f=Ur(Error(i(424)),r),dc(f),r=i1(n,r,c,o);break e}else for(n=r.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,Pn=Hr(n.firstChild),Rs=r,Xt=!0,va=null,Fr=!0,o=ev(r,null,c,o),r.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(po(),c===f){r=Fi(n,r,o);break e}Ds(n,r,c,o)}r=r.child}return r;case 26:return Th(n,r),n===null?(o=wb(r.type,null,r.pendingProps,null))?r.memoizedState=o:Xt||(o=r.type,n=r.pendingProps,c=Fh(Se.current).createElement(o),c[Zt]=r,c[In]=n,Ms(c,o,n),qt(c),r.stateNode=c):r.memoizedState=wb(r.type,n.memoizedProps,r.pendingProps,n.memoizedState),null;case 27:return sn(r),n===null&&Xt&&(c=r.stateNode=yb(r.type,r.pendingProps,Se.current),Rs=r,Fr=!0,f=Pn,Da(r.type)?(dp=f,Pn=Hr(c.firstChild)):Pn=f),Ds(n,r,r.pendingProps.children,o),Th(n,r),n===null&&(r.flags|=4194304),r.child;case 5:return n===null&&Xt&&((f=c=Pn)&&(c=XT(c,r.type,r.pendingProps,Fr),c!==null?(r.stateNode=c,Rs=r,Pn=Hr(c.firstChild),Fr=!1,f=!0):f=!1),f||ba(r)),sn(r),f=r.type,m=r.pendingProps,w=n!==null?n.memoizedProps:null,c=m.children,op(f,m)?c=null:w!==null&&op(f,w)&&(r.flags|=32),r.memoizedState!==null&&(f=am(n,r,dT,null,null,o),Uc._currentValue=f),Th(n,r),Ds(n,r,c,o),r.child;case 6:return n===null&&Xt&&((n=o=Pn)&&(o=JT(o,r.pendingProps,Fr),o!==null?(r.stateNode=o,Rs=r,Pn=null,n=!0):n=!1),n||ba(r)),null;case 13:return a1(n,r,o);case 4:return ct(r,r.stateNode.containerInfo),c=r.pendingProps,n===null?r.child=_o(r,null,c,o):Ds(n,r,c,o),r.child;case 11:return Xv(n,r,r.type,r.pendingProps,o);case 7:return Ds(n,r,r.pendingProps,o),r.child;case 8:return Ds(n,r,r.pendingProps.children,o),r.child;case 12:return Ds(n,r,r.pendingProps.children,o),r.child;case 10:return c=r.pendingProps,wa(r,r.type,c.value),Ds(n,r,c.children,o),r.child;case 9:return f=r.type._context,c=r.pendingProps.children,yo(r),f=Is(f),c=c(f),r.flags|=1,Ds(n,r,c,o),r.child;case 14:return Jv(n,r,r.type,r.pendingProps,o);case 15:return Zv(n,r,r.type,r.pendingProps,o);case 19:return l1(n,r,o);case 31:return wT(n,r,o);case 22:return e1(n,r,o,r.pendingProps);case 24:return yo(r),c=Is(ms),n===null?(f=Qf(),f===null&&(f=jn,m=Kf(),f.pooledCache=m,m.refCount++,m!==null&&(f.pooledCacheLanes|=o),f=m),r.memoizedState={parent:c,cache:f},Jf(r),wa(r,ms,f)):((n.lanes&o)!==0&&(Zf(n,r),bc(r,null,null,o),vc()),f=n.memoizedState,m=r.memoizedState,f.parent!==c?(f={parent:c,cache:c},r.memoizedState=f,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=f),wa(r,ms,c)):(c=m.cache,wa(r,ms,c),c!==f.cache&&Gf(r,[ms],o,!0))),Ds(n,r,r.pendingProps.children,o),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function qi(n){n.flags|=4}function Mm(n,r,o,c,f){if((r=(n.mode&32)!==0)&&(r=!1),r){if(n.flags|=16777216,(f&335544128)===f)if(n.stateNode.complete)n.flags|=8192;else if(O1())n.flags|=8192;else throw wo=uh,Xf}else n.flags&=-16777217}function u1(n,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!Tb(r))if(O1())n.flags|=8192;else throw wo=uh,Xf}function jh(n,r){r!==null&&(n.flags|=4),n.flags&16384&&(r=n.tag!==22?oe():536870912,n.lanes|=r,wl|=r)}function Tc(n,r){if(!Xt)switch(n.tailMode){case"hidden":r=n.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?n.tail=null:o.sibling=null;break;case"collapsed":o=n.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?r||n.tail===null?n.tail=null:n.tail.sibling=null:c.sibling=null}}function Vn(n){var r=n.alternate!==null&&n.alternate.child===n.child,o=0,c=0;if(r)for(var f=n.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags&65011712,c|=f.flags&65011712,f.return=n,f=f.sibling;else for(f=n.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags,c|=f.flags,f.return=n,f=f.sibling;return n.subtreeFlags|=c,n.childLanes=o,r}function xT(n,r,o){var c=r.pendingProps;switch(Ff(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vn(r),null;case 1:return Vn(r),null;case 3:return o=r.stateNode,c=null,n!==null&&(c=n.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),Ui(ms),Be(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(n===null||n.child===null)&&(ol(r)?qi(r):n===null||n.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Hf())),Vn(r),null;case 26:var f=r.type,m=r.memoizedState;return n===null?(qi(r),m!==null?(Vn(r),u1(r,m)):(Vn(r),Mm(r,f,null,c,o))):m?m!==n.memoizedState?(qi(r),Vn(r),u1(r,m)):(Vn(r),r.flags&=-16777217):(n=n.memoizedProps,n!==c&&qi(r),Vn(r),Mm(r,f,n,c,o)),null;case 27:if(Nn(r),o=Se.current,f=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==c&&qi(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return Vn(r),null}n=Ee.current,ol(r)?q0(r):(n=yb(f,c,o),r.stateNode=n,qi(r))}return Vn(r),null;case 5:if(Nn(r),f=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==c&&qi(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return Vn(r),null}if(m=Ee.current,ol(r))q0(r);else{var w=Fh(Se.current);switch(m){case 1:m=w.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:m=w.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":m=w.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":m=w.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":m=w.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild);break;case"select":m=typeof c.is=="string"?w.createElement("select",{is:c.is}):w.createElement("select"),c.multiple?m.multiple=!0:c.size&&(m.size=c.size);break;default:m=typeof c.is=="string"?w.createElement(f,{is:c.is}):w.createElement(f)}}m[Zt]=r,m[In]=c;e:for(w=r.child;w!==null;){if(w.tag===5||w.tag===6)m.appendChild(w.stateNode);else if(w.tag!==4&&w.tag!==27&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===r)break e;for(;w.sibling===null;){if(w.return===null||w.return===r)break e;w=w.return}w.sibling.return=w.return,w=w.sibling}r.stateNode=m;e:switch(Ms(m,f,c),f){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&qi(r)}}return Vn(r),Mm(r,r.type,n===null?null:n.memoizedProps,r.pendingProps,o),null;case 6:if(n&&r.stateNode!=null)n.memoizedProps!==c&&qi(r);else{if(typeof c!="string"&&r.stateNode===null)throw Error(i(166));if(n=Se.current,ol(r)){if(n=r.stateNode,o=r.memoizedProps,c=null,f=Rs,f!==null)switch(f.tag){case 27:case 5:c=f.memoizedProps}n[Zt]=r,n=!!(n.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||ab(n.nodeValue,o)),n||ba(r,!0)}else n=Fh(n).createTextNode(c),n[Zt]=r,r.stateNode=n}return Vn(r),null;case 31:if(o=r.memoizedState,n===null||n.memoizedState!==null){if(c=ol(r),o!==null){if(n===null){if(!c)throw Error(i(318));if(n=r.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(557));n[Zt]=r}else po(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Vn(r),n=!1}else o=Hf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=o),n=!0;if(!n)return r.flags&256?(xr(r),r):(xr(r),null);if((r.flags&128)!==0)throw Error(i(558))}return Vn(r),null;case 13:if(c=r.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(f=ol(r),c!==null&&c.dehydrated!==null){if(n===null){if(!f)throw Error(i(318));if(f=r.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(i(317));f[Zt]=r}else po(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Vn(r),f=!1}else f=Hf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=f),f=!0;if(!f)return r.flags&256?(xr(r),r):(xr(r),null)}return xr(r),(r.flags&128)!==0?(r.lanes=o,r):(o=c!==null,n=n!==null&&n.memoizedState!==null,o&&(c=r.child,f=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(f=c.alternate.memoizedState.cachePool.pool),m=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(m=c.memoizedState.cachePool.pool),m!==f&&(c.flags|=2048)),o!==n&&o&&(r.child.flags|=8192),jh(r,r.updateQueue),Vn(r),null);case 4:return Be(),n===null&&np(r.stateNode.containerInfo),Vn(r),null;case 10:return Ui(r.type),Vn(r),null;case 19:if(ne(cs),c=r.memoizedState,c===null)return Vn(r),null;if(f=(r.flags&128)!==0,m=c.rendering,m===null)if(f)Tc(c,!1);else{if(es!==0||n!==null&&(n.flags&128)!==0)for(n=r.child;n!==null;){if(m=mh(n),m!==null){for(r.flags|=128,Tc(c,!1),n=m.updateQueue,r.updateQueue=n,jh(r,n),r.subtreeFlags=0,n=o,o=r.child;o!==null;)V0(o,n),o=o.sibling;return ve(cs,cs.current&1|2),Xt&&Pi(r,c.treeForkCount),r.child}n=n.sibling}c.tail!==null&&vt()>Ih&&(r.flags|=128,f=!0,Tc(c,!1),r.lanes=4194304)}else{if(!f)if(n=mh(m),n!==null){if(r.flags|=128,f=!0,n=n.updateQueue,r.updateQueue=n,jh(r,n),Tc(c,!0),c.tail===null&&c.tailMode==="hidden"&&!m.alternate&&!Xt)return Vn(r),null}else 2*vt()-c.renderingStartTime>Ih&&o!==536870912&&(r.flags|=128,f=!0,Tc(c,!1),r.lanes=4194304);c.isBackwards?(m.sibling=r.child,r.child=m):(n=c.last,n!==null?n.sibling=m:r.child=m,c.last=m)}return c.tail!==null?(n=c.tail,c.rendering=n,c.tail=n.sibling,c.renderingStartTime=vt(),n.sibling=null,o=cs.current,ve(cs,f?o&1|2:o&1),Xt&&Pi(r,c.treeForkCount),n):(Vn(r),null);case 22:case 23:return xr(r),sm(),c=r.memoizedState!==null,n!==null?n.memoizedState!==null!==c&&(r.flags|=8192):c&&(r.flags|=8192),c?(o&536870912)!==0&&(r.flags&128)===0&&(Vn(r),r.subtreeFlags&6&&(r.flags|=8192)):Vn(r),o=r.updateQueue,o!==null&&jh(r,o.retryQueue),o=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),c=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),c!==o&&(r.flags|=2048),n!==null&&ne(vo),null;case 24:return o=null,n!==null&&(o=n.memoizedState.cache),r.memoizedState.cache!==o&&(r.flags|=2048),Ui(ms),Vn(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function kT(n,r){switch(Ff(r),r.tag){case 1:return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 3:return Ui(ms),Be(),n=r.flags,(n&65536)!==0&&(n&128)===0?(r.flags=n&-65537|128,r):null;case 26:case 27:case 5:return Nn(r),null;case 31:if(r.memoizedState!==null){if(xr(r),r.alternate===null)throw Error(i(340));po()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 13:if(xr(r),n=r.memoizedState,n!==null&&n.dehydrated!==null){if(r.alternate===null)throw Error(i(340));po()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 19:return ne(cs),null;case 4:return Be(),null;case 10:return Ui(r.type),null;case 22:case 23:return xr(r),sm(),n!==null&&ne(vo),n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 24:return Ui(ms),null;case 25:return null;default:return null}}function h1(n,r){switch(Ff(r),r.tag){case 3:Ui(ms),Be();break;case 26:case 27:case 5:Nn(r);break;case 4:Be();break;case 31:r.memoizedState!==null&&xr(r);break;case 13:xr(r);break;case 19:ne(cs);break;case 10:Ui(r.type);break;case 22:case 23:xr(r),sm(),n!==null&&ne(vo);break;case 24:Ui(ms)}}function Sc(n,r){try{var o=r.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var f=c.next;o=f;do{if((o.tag&n)===n){c=void 0;var m=o.create,w=o.inst;c=m(),w.destroy=c}o=o.next}while(o!==f)}}catch(S){wn(r,r.return,S)}}function Sa(n,r,o){try{var c=r.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var m=f.next;c=m;do{if((c.tag&n)===n){var w=c.inst,S=w.destroy;if(S!==void 0){w.destroy=void 0,f=r;var U=o,te=S;try{te()}catch(me){wn(f,U,me)}}}c=c.next}while(c!==m)}}catch(me){wn(r,r.return,me)}}function d1(n){var r=n.updateQueue;if(r!==null){var o=n.stateNode;try{nv(r,o)}catch(c){wn(n,n.return,c)}}}function f1(n,r,o){o.props=ko(n.type,n.memoizedProps),o.state=n.memoizedState;try{o.componentWillUnmount()}catch(c){wn(n,r,c)}}function jc(n,r){try{var o=n.ref;if(o!==null){switch(n.tag){case 26:case 27:case 5:var c=n.stateNode;break;case 30:c=n.stateNode;break;default:c=n.stateNode}typeof o=="function"?n.refCleanup=o(c):o.current=c}}catch(f){wn(n,r,f)}}function wi(n,r){var o=n.ref,c=n.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(f){wn(n,r,f)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(f){wn(n,r,f)}else o.current=null}function m1(n){var r=n.type,o=n.memoizedProps,c=n.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(f){wn(n,n.return,f)}}function Lm(n,r,o){try{var c=n.stateNode;$T(c,n.type,o,r),c[In]=r}catch(f){wn(n,n.return,f)}}function p1(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&Da(n.type)||n.tag===4}function Om(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||p1(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&Da(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Pm(n,r,o){var c=n.tag;if(c===5||c===6)n=n.stateNode,r?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(n,r):(r=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,r.appendChild(n),o=o._reactRootContainer,o!=null||r.onclick!==null||(r.onclick=dt));else if(c!==4&&(c===27&&Da(n.type)&&(o=n.stateNode,r=null),n=n.child,n!==null))for(Pm(n,r,o),n=n.sibling;n!==null;)Pm(n,r,o),n=n.sibling}function Ch(n,r,o){var c=n.tag;if(c===5||c===6)n=n.stateNode,r?o.insertBefore(n,r):o.appendChild(n);else if(c!==4&&(c===27&&Da(n.type)&&(o=n.stateNode),n=n.child,n!==null))for(Ch(n,r,o),n=n.sibling;n!==null;)Ch(n,r,o),n=n.sibling}function g1(n){var r=n.stateNode,o=n.memoizedProps;try{for(var c=n.type,f=r.attributes;f.length;)r.removeAttributeNode(f[0]);Ms(r,c,o),r[Zt]=n,r[In]=o}catch(m){wn(n,n.return,m)}}var Hi=!1,ys=!1,Vm=!1,y1=typeof WeakSet=="function"?WeakSet:Set,Ts=null;function ET(n,r){if(n=n.containerInfo,ip=Yh,n=N0(n),Rf(n)){if("selectionStart"in n)var o={start:n.selectionStart,end:n.selectionEnd};else e:{o=(o=n.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var f=c.anchorOffset,m=c.focusNode;c=c.focusOffset;try{o.nodeType,m.nodeType}catch{o=null;break e}var w=0,S=-1,U=-1,te=0,me=0,we=n,ie=null;t:for(;;){for(var de;we!==o||f!==0&&we.nodeType!==3||(S=w+f),we!==m||c!==0&&we.nodeType!==3||(U=w+c),we.nodeType===3&&(w+=we.nodeValue.length),(de=we.firstChild)!==null;)ie=we,we=de;for(;;){if(we===n)break t;if(ie===o&&++te===f&&(S=w),ie===m&&++me===c&&(U=w),(de=we.nextSibling)!==null)break;we=ie,ie=we.parentNode}we=de}o=S===-1||U===-1?null:{start:S,end:U}}else o=null}o=o||{start:0,end:0}}else o=null;for(ap={focusedElem:n,selectionRange:o},Yh=!1,Ts=r;Ts!==null;)if(r=Ts,n=r.child,(r.subtreeFlags&1028)!==0&&n!==null)n.return=r,Ts=n;else for(;Ts!==null;){switch(r=Ts,m=r.alternate,n=r.flags,r.tag){case 0:if((n&4)!==0&&(n=r.updateQueue,n=n!==null?n.events:null,n!==null))for(o=0;o<n.length;o++)f=n[o],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&m!==null){n=void 0,o=r,f=m.memoizedProps,m=m.memoizedState,c=o.stateNode;try{var Je=ko(o.type,f);n=c.getSnapshotBeforeUpdate(Je,m),c.__reactInternalSnapshotBeforeUpdate=n}catch(ft){wn(o,o.return,ft)}}break;case 3:if((n&1024)!==0){if(n=r.stateNode.containerInfo,o=n.nodeType,o===9)cp(n);else if(o===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":cp(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(i(163))}if(n=r.sibling,n!==null){n.return=r.return,Ts=n;break}Ts=r.return}}function v1(n,r,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:Wi(n,o),c&4&&Sc(5,o);break;case 1:if(Wi(n,o),c&4)if(n=o.stateNode,r===null)try{n.componentDidMount()}catch(w){wn(o,o.return,w)}else{var f=ko(o.type,r.memoizedProps);r=r.memoizedState;try{n.componentDidUpdate(f,r,n.__reactInternalSnapshotBeforeUpdate)}catch(w){wn(o,o.return,w)}}c&64&&d1(o),c&512&&jc(o,o.return);break;case 3:if(Wi(n,o),c&64&&(n=o.updateQueue,n!==null)){if(r=null,o.child!==null)switch(o.child.tag){case 27:case 5:r=o.child.stateNode;break;case 1:r=o.child.stateNode}try{nv(n,r)}catch(w){wn(o,o.return,w)}}break;case 27:r===null&&c&4&&g1(o);case 26:case 5:Wi(n,o),r===null&&c&4&&m1(o),c&512&&jc(o,o.return);break;case 12:Wi(n,o);break;case 31:Wi(n,o),c&4&&_1(n,o);break;case 13:Wi(n,o),c&4&&x1(n,o),c&64&&(n=o.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(o=DT.bind(null,o),ZT(n,o))));break;case 22:if(c=o.memoizedState!==null||Hi,!c){r=r!==null&&r.memoizedState!==null||ys,f=Hi;var m=ys;Hi=c,(ys=r)&&!m?Gi(n,o,(o.subtreeFlags&8772)!==0):Wi(n,o),Hi=f,ys=m}break;case 30:break;default:Wi(n,o)}}function b1(n){var r=n.alternate;r!==null&&(n.alternate=null,b1(r)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(r=n.stateNode,r!==null&&Ys(r)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var Wn=null,lr=!1;function $i(n,r,o){for(o=o.child;o!==null;)w1(n,r,o),o=o.sibling}function w1(n,r,o){if($e&&typeof $e.onCommitFiberUnmount=="function")try{$e.onCommitFiberUnmount(it,o)}catch{}switch(o.tag){case 26:ys||wi(o,r),$i(n,r,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:ys||wi(o,r);var c=Wn,f=lr;Da(o.type)&&(Wn=o.stateNode,lr=!1),$i(n,r,o),Oc(o.stateNode),Wn=c,lr=f;break;case 5:ys||wi(o,r);case 6:if(c=Wn,f=lr,Wn=null,$i(n,r,o),Wn=c,lr=f,Wn!==null)if(lr)try{(Wn.nodeType===9?Wn.body:Wn.nodeName==="HTML"?Wn.ownerDocument.body:Wn).removeChild(o.stateNode)}catch(m){wn(o,r,m)}else try{Wn.removeChild(o.stateNode)}catch(m){wn(o,r,m)}break;case 18:Wn!==null&&(lr?(n=Wn,db(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,o.stateNode),Cl(n)):db(Wn,o.stateNode));break;case 4:c=Wn,f=lr,Wn=o.stateNode.containerInfo,lr=!0,$i(n,r,o),Wn=c,lr=f;break;case 0:case 11:case 14:case 15:Sa(2,o,r),ys||Sa(4,o,r),$i(n,r,o);break;case 1:ys||(wi(o,r),c=o.stateNode,typeof c.componentWillUnmount=="function"&&f1(o,r,c)),$i(n,r,o);break;case 21:$i(n,r,o);break;case 22:ys=(c=ys)||o.memoizedState!==null,$i(n,r,o),ys=c;break;default:$i(n,r,o)}}function _1(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{Cl(n)}catch(o){wn(r,r.return,o)}}}function x1(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Cl(n)}catch(o){wn(r,r.return,o)}}function TT(n){switch(n.tag){case 31:case 13:case 19:var r=n.stateNode;return r===null&&(r=n.stateNode=new y1),r;case 22:return n=n.stateNode,r=n._retryCache,r===null&&(r=n._retryCache=new y1),r;default:throw Error(i(435,n.tag))}}function Nh(n,r){var o=TT(n);r.forEach(function(c){if(!o.has(c)){o.add(c);var f=MT.bind(null,n,c);c.then(f,f)}})}function cr(n,r){var o=r.deletions;if(o!==null)for(var c=0;c<o.length;c++){var f=o[c],m=n,w=r,S=w;e:for(;S!==null;){switch(S.tag){case 27:if(Da(S.type)){Wn=S.stateNode,lr=!1;break e}break;case 5:Wn=S.stateNode,lr=!1;break e;case 3:case 4:Wn=S.stateNode.containerInfo,lr=!0;break e}S=S.return}if(Wn===null)throw Error(i(160));w1(m,w,f),Wn=null,lr=!1,m=f.alternate,m!==null&&(m.return=null),f.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)k1(r,n),r=r.sibling}var ni=null;function k1(n,r){var o=n.alternate,c=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:cr(r,n),ur(n),c&4&&(Sa(3,n,n.return),Sc(3,n),Sa(5,n,n.return));break;case 1:cr(r,n),ur(n),c&512&&(ys||o===null||wi(o,o.return)),c&64&&Hi&&(n=n.updateQueue,n!==null&&(c=n.callbacks,c!==null&&(o=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var f=ni;if(cr(r,n),ur(n),c&512&&(ys||o===null||wi(o,o.return)),c&4){var m=o!==null?o.memoizedState:null;if(c=n.memoizedState,o===null)if(c===null)if(n.stateNode===null){e:{c=n.type,o=n.memoizedProps,f=f.ownerDocument||f;t:switch(c){case"title":m=f.getElementsByTagName("title")[0],(!m||m[qn]||m[Zt]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=f.createElement(c),f.head.insertBefore(m,f.querySelector("head > title"))),Ms(m,c,o),m[Zt]=n,qt(m),c=m;break e;case"link":var w=kb("link","href",f).get(c+(o.href||""));if(w){for(var S=0;S<w.length;S++)if(m=w[S],m.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&m.getAttribute("rel")===(o.rel==null?null:o.rel)&&m.getAttribute("title")===(o.title==null?null:o.title)&&m.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){w.splice(S,1);break t}}m=f.createElement(c),Ms(m,c,o),f.head.appendChild(m);break;case"meta":if(w=kb("meta","content",f).get(c+(o.content||""))){for(S=0;S<w.length;S++)if(m=w[S],m.getAttribute("content")===(o.content==null?null:""+o.content)&&m.getAttribute("name")===(o.name==null?null:o.name)&&m.getAttribute("property")===(o.property==null?null:o.property)&&m.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&m.getAttribute("charset")===(o.charSet==null?null:o.charSet)){w.splice(S,1);break t}}m=f.createElement(c),Ms(m,c,o),f.head.appendChild(m);break;default:throw Error(i(468,c))}m[Zt]=n,qt(m),c=m}n.stateNode=c}else Eb(f,n.type,n.stateNode);else n.stateNode=xb(f,c,n.memoizedProps);else m!==c?(m===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):m.count--,c===null?Eb(f,n.type,n.stateNode):xb(f,c,n.memoizedProps)):c===null&&n.stateNode!==null&&Lm(n,n.memoizedProps,o.memoizedProps)}break;case 27:cr(r,n),ur(n),c&512&&(ys||o===null||wi(o,o.return)),o!==null&&c&4&&Lm(n,n.memoizedProps,o.memoizedProps);break;case 5:if(cr(r,n),ur(n),c&512&&(ys||o===null||wi(o,o.return)),n.flags&32){f=n.stateNode;try{C(f,"")}catch(Je){wn(n,n.return,Je)}}c&4&&n.stateNode!=null&&(f=n.memoizedProps,Lm(n,f,o!==null?o.memoizedProps:f)),c&1024&&(Vm=!0);break;case 6:if(cr(r,n),ur(n),c&4){if(n.stateNode===null)throw Error(i(162));c=n.memoizedProps,o=n.stateNode;try{o.nodeValue=c}catch(Je){wn(n,n.return,Je)}}break;case 3:if($h=null,f=ni,ni=qh(r.containerInfo),cr(r,n),ni=f,ur(n),c&4&&o!==null&&o.memoizedState.isDehydrated)try{Cl(r.containerInfo)}catch(Je){wn(n,n.return,Je)}Vm&&(Vm=!1,E1(n));break;case 4:c=ni,ni=qh(n.stateNode.containerInfo),cr(r,n),ur(n),ni=c;break;case 12:cr(r,n),ur(n);break;case 31:cr(r,n),ur(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Nh(n,c)));break;case 13:cr(r,n),ur(n),n.child.flags&8192&&n.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Rh=vt()),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Nh(n,c)));break;case 22:f=n.memoizedState!==null;var U=o!==null&&o.memoizedState!==null,te=Hi,me=ys;if(Hi=te||f,ys=me||U,cr(r,n),ys=me,Hi=te,ur(n),c&8192)e:for(r=n.stateNode,r._visibility=f?r._visibility&-2:r._visibility|1,f&&(o===null||U||Hi||ys||Eo(n)),o=null,r=n;;){if(r.tag===5||r.tag===26){if(o===null){U=o=r;try{if(m=U.stateNode,f)w=m.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{S=U.stateNode;var we=U.memoizedProps.style,ie=we!=null&&we.hasOwnProperty("display")?we.display:null;S.style.display=ie==null||typeof ie=="boolean"?"":(""+ie).trim()}}catch(Je){wn(U,U.return,Je)}}}else if(r.tag===6){if(o===null){U=r;try{U.stateNode.nodeValue=f?"":U.memoizedProps}catch(Je){wn(U,U.return,Je)}}}else if(r.tag===18){if(o===null){U=r;try{var de=U.stateNode;f?fb(de,!0):fb(U.stateNode,!1)}catch(Je){wn(U,U.return,Je)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===n)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break e;for(;r.sibling===null;){if(r.return===null||r.return===n)break e;o===r&&(o=null),r=r.return}o===r&&(o=null),r.sibling.return=r.return,r=r.sibling}c&4&&(c=n.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,Nh(n,o))));break;case 19:cr(r,n),ur(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Nh(n,c)));break;case 30:break;case 21:break;default:cr(r,n),ur(n)}}function ur(n){var r=n.flags;if(r&2){try{for(var o,c=n.return;c!==null;){if(p1(c)){o=c;break}c=c.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var f=o.stateNode,m=Om(n);Ch(n,m,f);break;case 5:var w=o.stateNode;o.flags&32&&(C(w,""),o.flags&=-33);var S=Om(n);Ch(n,S,w);break;case 3:case 4:var U=o.stateNode.containerInfo,te=Om(n);Pm(n,te,U);break;default:throw Error(i(161))}}catch(me){wn(n,n.return,me)}n.flags&=-3}r&4096&&(n.flags&=-4097)}function E1(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var r=n;E1(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),n=n.sibling}}function Wi(n,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)v1(n,r.alternate,r),r=r.sibling}function Eo(n){for(n=n.child;n!==null;){var r=n;switch(r.tag){case 0:case 11:case 14:case 15:Sa(4,r,r.return),Eo(r);break;case 1:wi(r,r.return);var o=r.stateNode;typeof o.componentWillUnmount=="function"&&f1(r,r.return,o),Eo(r);break;case 27:Oc(r.stateNode);case 26:case 5:wi(r,r.return),Eo(r);break;case 22:r.memoizedState===null&&Eo(r);break;case 30:Eo(r);break;default:Eo(r)}n=n.sibling}}function Gi(n,r,o){for(o=o&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var c=r.alternate,f=n,m=r,w=m.flags;switch(m.tag){case 0:case 11:case 15:Gi(f,m,o),Sc(4,m);break;case 1:if(Gi(f,m,o),c=m,f=c.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(te){wn(c,c.return,te)}if(c=m,f=c.updateQueue,f!==null){var S=c.stateNode;try{var U=f.shared.hiddenCallbacks;if(U!==null)for(f.shared.hiddenCallbacks=null,f=0;f<U.length;f++)tv(U[f],S)}catch(te){wn(c,c.return,te)}}o&&w&64&&d1(m),jc(m,m.return);break;case 27:g1(m);case 26:case 5:Gi(f,m,o),o&&c===null&&w&4&&m1(m),jc(m,m.return);break;case 12:Gi(f,m,o);break;case 31:Gi(f,m,o),o&&w&4&&_1(f,m);break;case 13:Gi(f,m,o),o&&w&4&&x1(f,m);break;case 22:m.memoizedState===null&&Gi(f,m,o),jc(m,m.return);break;case 30:break;default:Gi(f,m,o)}r=r.sibling}}function Um(n,r){var o=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),n=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(n=r.memoizedState.cachePool.pool),n!==o&&(n!=null&&n.refCount++,o!=null&&fc(o))}function Bm(n,r){n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&fc(n))}function si(n,r,o,c){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)T1(n,r,o,c),r=r.sibling}function T1(n,r,o,c){var f=r.flags;switch(r.tag){case 0:case 11:case 15:si(n,r,o,c),f&2048&&Sc(9,r);break;case 1:si(n,r,o,c);break;case 3:si(n,r,o,c),f&2048&&(n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&fc(n)));break;case 12:if(f&2048){si(n,r,o,c),n=r.stateNode;try{var m=r.memoizedProps,w=m.id,S=m.onPostCommit;typeof S=="function"&&S(w,r.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(U){wn(r,r.return,U)}}else si(n,r,o,c);break;case 31:si(n,r,o,c);break;case 13:si(n,r,o,c);break;case 23:break;case 22:m=r.stateNode,w=r.alternate,r.memoizedState!==null?m._visibility&2?si(n,r,o,c):Cc(n,r):m._visibility&2?si(n,r,o,c):(m._visibility|=2,yl(n,r,o,c,(r.subtreeFlags&10256)!==0||!1)),f&2048&&Um(w,r);break;case 24:si(n,r,o,c),f&2048&&Bm(r.alternate,r);break;default:si(n,r,o,c)}}function yl(n,r,o,c,f){for(f=f&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var m=n,w=r,S=o,U=c,te=w.flags;switch(w.tag){case 0:case 11:case 15:yl(m,w,S,U,f),Sc(8,w);break;case 23:break;case 22:var me=w.stateNode;w.memoizedState!==null?me._visibility&2?yl(m,w,S,U,f):Cc(m,w):(me._visibility|=2,yl(m,w,S,U,f)),f&&te&2048&&Um(w.alternate,w);break;case 24:yl(m,w,S,U,f),f&&te&2048&&Bm(w.alternate,w);break;default:yl(m,w,S,U,f)}r=r.sibling}}function Cc(n,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var o=n,c=r,f=c.flags;switch(c.tag){case 22:Cc(o,c),f&2048&&Um(c.alternate,c);break;case 24:Cc(o,c),f&2048&&Bm(c.alternate,c);break;default:Cc(o,c)}r=r.sibling}}var Nc=8192;function vl(n,r,o){if(n.subtreeFlags&Nc)for(n=n.child;n!==null;)S1(n,r,o),n=n.sibling}function S1(n,r,o){switch(n.tag){case 26:vl(n,r,o),n.flags&Nc&&n.memoizedState!==null&&hS(o,ni,n.memoizedState,n.memoizedProps);break;case 5:vl(n,r,o);break;case 3:case 4:var c=ni;ni=qh(n.stateNode.containerInfo),vl(n,r,o),ni=c;break;case 22:n.memoizedState===null&&(c=n.alternate,c!==null&&c.memoizedState!==null?(c=Nc,Nc=16777216,vl(n,r,o),Nc=c):vl(n,r,o));break;default:vl(n,r,o)}}function j1(n){var r=n.alternate;if(r!==null&&(n=r.child,n!==null)){r.child=null;do r=n.sibling,n.sibling=null,n=r;while(n!==null)}}function Ac(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];Ts=c,N1(c,n)}j1(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)C1(n),n=n.sibling}function C1(n){switch(n.tag){case 0:case 11:case 15:Ac(n),n.flags&2048&&Sa(9,n,n.return);break;case 3:Ac(n);break;case 12:Ac(n);break;case 22:var r=n.stateNode;n.memoizedState!==null&&r._visibility&2&&(n.return===null||n.return.tag!==13)?(r._visibility&=-3,Ah(n)):Ac(n);break;default:Ac(n)}}function Ah(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];Ts=c,N1(c,n)}j1(n)}for(n=n.child;n!==null;){switch(r=n,r.tag){case 0:case 11:case 15:Sa(8,r,r.return),Ah(r);break;case 22:o=r.stateNode,o._visibility&2&&(o._visibility&=-3,Ah(r));break;default:Ah(r)}n=n.sibling}}function N1(n,r){for(;Ts!==null;){var o=Ts;switch(o.tag){case 0:case 11:case 15:Sa(8,o,r);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:fc(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,Ts=c;else e:for(o=n;Ts!==null;){c=Ts;var f=c.sibling,m=c.return;if(b1(c),c===o){Ts=null;break e}if(f!==null){f.return=m,Ts=f;break e}Ts=m}}}var ST={getCacheForType:function(n){var r=Is(ms),o=r.data.get(n);return o===void 0&&(o=n(),r.data.set(n,o)),o},cacheSignal:function(){return Is(ms).controller.signal}},jT=typeof WeakMap=="function"?WeakMap:Map,mn=0,jn=null,zt=null,$t=0,bn=0,kr=null,ja=!1,bl=!1,zm=!1,Ki=0,es=0,Ca=0,To=0,Fm=0,Er=0,wl=0,Rc=null,hr=null,qm=!1,Rh=0,A1=0,Ih=1/0,Dh=null,Na=null,ks=0,Aa=null,_l=null,Yi=0,Hm=0,$m=null,R1=null,Ic=0,Wm=null;function Tr(){return(mn&2)!==0&&$t!==0?$t&-$t:Z.T!==null?Jm():Ns()}function I1(){if(Er===0)if(($t&536870912)===0||Xt){var n=Xn;Xn<<=1,(Xn&3932160)===0&&(Xn=262144),Er=n}else Er=536870912;return n=_r.current,n!==null&&(n.flags|=32),Er}function dr(n,r,o){(n===jn&&(bn===2||bn===9)||n.cancelPendingCommit!==null)&&(xl(n,0),Ra(n,$t,Er,!1)),Ge(n,o),((mn&2)===0||n!==jn)&&(n===jn&&((mn&2)===0&&(To|=o),es===4&&Ra(n,$t,Er,!1)),_i(n))}function D1(n,r,o){if((mn&6)!==0)throw Error(i(327));var c=!o&&(r&127)===0&&(r&n.expiredLanes)===0||hn(n,r),f=c?AT(n,r):Km(n,r,!0),m=c;do{if(f===0){bl&&!c&&Ra(n,r,0,!1);break}else{if(o=n.current.alternate,m&&!CT(o)){f=Km(n,r,!1),m=!1;continue}if(f===2){if(m=r,n.errorRecoveryDisabledLanes&m)var w=0;else w=n.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){r=w;e:{var S=n;f=Rc;var U=S.current.memoizedState.isDehydrated;if(U&&(xl(S,w).flags|=256),w=Km(S,w,!1),w!==2){if(zm&&!U){S.errorRecoveryDisabledLanes|=m,To|=m,f=4;break e}m=hr,hr=f,m!==null&&(hr===null?hr=m:hr.push.apply(hr,m))}f=w}if(m=!1,f!==2)continue}}if(f===1){xl(n,0),Ra(n,r,0,!0);break}e:{switch(c=n,m=f,m){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:Ra(c,r,Er,!ja);break e;case 2:hr=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(f=Rh+300-vt(),10<f)){if(Ra(c,r,Er,!ja),An(c,0,!0)!==0)break e;Yi=r,c.timeoutHandle=ub(M1.bind(null,c,o,hr,Dh,qm,r,Er,To,wl,ja,m,"Throttled",-0,0),f);break e}M1(c,o,hr,Dh,qm,r,Er,To,wl,ja,m,null,-0,0)}}break}while(!0);_i(n)}function M1(n,r,o,c,f,m,w,S,U,te,me,we,ie,de){if(n.timeoutHandle=-1,we=r.subtreeFlags,we&8192||(we&16785408)===16785408){we={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:dt},S1(r,m,we);var Je=(m&62914560)===m?Rh-vt():(m&4194048)===m?A1-vt():0;if(Je=dS(we,Je),Je!==null){Yi=m,n.cancelPendingCommit=Je(F1.bind(null,n,r,m,o,c,f,w,S,U,me,we,null,ie,de)),Ra(n,m,w,!te);return}}F1(n,r,m,o,c,f,w,S,U)}function CT(n){for(var r=n;;){var o=r.tag;if((o===0||o===11||o===15)&&r.flags&16384&&(o=r.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var f=o[c],m=f.getSnapshot;f=f.value;try{if(!br(m(),f))return!1}catch{return!1}}if(o=r.child,r.subtreeFlags&16384&&o!==null)o.return=r,r=o;else{if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Ra(n,r,o,c){r&=~Fm,r&=~To,n.suspendedLanes|=r,n.pingedLanes&=~r,c&&(n.warmLanes|=r),c=n.expirationTimes;for(var f=r;0<f;){var m=31-Fe(f),w=1<<m;c[m]=-1,f&=~w}o!==0&&lt(n,o,r)}function Mh(){return(mn&6)===0?(Dc(0),!1):!0}function Gm(){if(zt!==null){if(bn===0)var n=zt.return;else n=zt,Vi=go=null,cm(n),dl=null,pc=0,n=zt;for(;n!==null;)h1(n.alternate,n),n=n.return;zt=null}}function xl(n,r){var o=n.timeoutHandle;o!==-1&&(n.timeoutHandle=-1,KT(o)),o=n.cancelPendingCommit,o!==null&&(n.cancelPendingCommit=null,o()),Yi=0,Gm(),jn=n,zt=o=Oi(n.current,null),$t=r,bn=0,kr=null,ja=!1,bl=hn(n,r),zm=!1,wl=Er=Fm=To=Ca=es=0,hr=Rc=null,qm=!1,(r&8)!==0&&(r|=r&32);var c=n.entangledLanes;if(c!==0)for(n=n.entanglements,c&=r;0<c;){var f=31-Fe(c),m=1<<f;r|=n[f],c&=~m}return Ki=r,th(),o}function L1(n,r){Lt=null,Z.H=kc,r===hl||r===ch?(r=X0(),bn=3):r===Xf?(r=X0(),bn=4):bn=r===Tm?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,kr=r,zt===null&&(es=1,kh(n,Ur(r,n.current)))}function O1(){var n=_r.current;return n===null?!0:($t&4194048)===$t?qr===null:($t&62914560)===$t||($t&536870912)!==0?n===qr:!1}function P1(){var n=Z.H;return Z.H=kc,n===null?kc:n}function V1(){var n=Z.A;return Z.A=ST,n}function Lh(){es=4,ja||($t&4194048)!==$t&&_r.current!==null||(bl=!0),(Ca&134217727)===0&&(To&134217727)===0||jn===null||Ra(jn,$t,Er,!1)}function Km(n,r,o){var c=mn;mn|=2;var f=P1(),m=V1();(jn!==n||$t!==r)&&(Dh=null,xl(n,r)),r=!1;var w=es;e:do try{if(bn!==0&&zt!==null){var S=zt,U=kr;switch(bn){case 8:Gm(),w=6;break e;case 3:case 2:case 9:case 6:_r.current===null&&(r=!0);var te=bn;if(bn=0,kr=null,kl(n,S,U,te),o&&bl){w=0;break e}break;default:te=bn,bn=0,kr=null,kl(n,S,U,te)}}NT(),w=es;break}catch(me){L1(n,me)}while(!0);return r&&n.shellSuspendCounter++,Vi=go=null,mn=c,Z.H=f,Z.A=m,zt===null&&(jn=null,$t=0,th()),w}function NT(){for(;zt!==null;)U1(zt)}function AT(n,r){var o=mn;mn|=2;var c=P1(),f=V1();jn!==n||$t!==r?(Dh=null,Ih=vt()+500,xl(n,r)):bl=hn(n,r);e:do try{if(bn!==0&&zt!==null){r=zt;var m=kr;t:switch(bn){case 1:bn=0,kr=null,kl(n,r,m,1);break;case 2:case 9:if(Y0(m)){bn=0,kr=null,B1(r);break}r=function(){bn!==2&&bn!==9||jn!==n||(bn=7),_i(n)},m.then(r,r);break e;case 3:bn=7;break e;case 4:bn=5;break e;case 7:Y0(m)?(bn=0,kr=null,B1(r)):(bn=0,kr=null,kl(n,r,m,7));break;case 5:var w=null;switch(zt.tag){case 26:w=zt.memoizedState;case 5:case 27:var S=zt;if(w?Tb(w):S.stateNode.complete){bn=0,kr=null;var U=S.sibling;if(U!==null)zt=U;else{var te=S.return;te!==null?(zt=te,Oh(te)):zt=null}break t}}bn=0,kr=null,kl(n,r,m,5);break;case 6:bn=0,kr=null,kl(n,r,m,6);break;case 8:Gm(),es=6;break e;default:throw Error(i(462))}}RT();break}catch(me){L1(n,me)}while(!0);return Vi=go=null,Z.H=c,Z.A=f,mn=o,zt!==null?0:(jn=null,$t=0,th(),es)}function RT(){for(;zt!==null&&!et();)U1(zt)}function U1(n){var r=c1(n.alternate,n,Ki);n.memoizedProps=n.pendingProps,r===null?Oh(n):zt=r}function B1(n){var r=n,o=r.alternate;switch(r.tag){case 15:case 0:r=s1(o,r,r.pendingProps,r.type,void 0,$t);break;case 11:r=s1(o,r,r.pendingProps,r.type.render,r.ref,$t);break;case 5:cm(r);default:h1(o,r),r=zt=V0(r,Ki),r=c1(o,r,Ki)}n.memoizedProps=n.pendingProps,r===null?Oh(n):zt=r}function kl(n,r,o,c){Vi=go=null,cm(r),dl=null,pc=0;var f=r.return;try{if(bT(n,f,r,o,$t)){es=1,kh(n,Ur(o,n.current)),zt=null;return}}catch(m){if(f!==null)throw zt=f,m;es=1,kh(n,Ur(o,n.current)),zt=null;return}r.flags&32768?(Xt||c===1?n=!0:bl||($t&536870912)!==0?n=!1:(ja=n=!0,(c===2||c===9||c===3||c===6)&&(c=_r.current,c!==null&&c.tag===13&&(c.flags|=16384))),z1(r,n)):Oh(r)}function Oh(n){var r=n;do{if((r.flags&32768)!==0){z1(r,ja);return}n=r.return;var o=xT(r.alternate,r,Ki);if(o!==null){zt=o;return}if(r=r.sibling,r!==null){zt=r;return}zt=r=n}while(r!==null);es===0&&(es=5)}function z1(n,r){do{var o=kT(n.alternate,n);if(o!==null){o.flags&=32767,zt=o;return}if(o=n.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!r&&(n=n.sibling,n!==null)){zt=n;return}zt=n=o}while(n!==null);es=6,zt=null}function F1(n,r,o,c,f,m,w,S,U){n.cancelPendingCommit=null;do Ph();while(ks!==0);if((mn&6)!==0)throw Error(i(327));if(r!==null){if(r===n.current)throw Error(i(177));if(m=r.lanes|r.childLanes,m|=Of,mt(n,o,m,w,S,U),n===jn&&(zt=jn=null,$t=0),_l=r,Aa=n,Yi=o,Hm=m,$m=f,R1=c,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,LT(Jt,function(){return G1(),null})):(n.callbackNode=null,n.callbackPriority=0),c=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||c){c=Z.T,Z.T=null,f=ue.p,ue.p=2,w=mn,mn|=4;try{ET(n,r,o)}finally{mn=w,ue.p=f,Z.T=c}}ks=1,q1(),H1(),$1()}}function q1(){if(ks===1){ks=0;var n=Aa,r=_l,o=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||o){o=Z.T,Z.T=null;var c=ue.p;ue.p=2;var f=mn;mn|=4;try{k1(r,n);var m=ap,w=N0(n.containerInfo),S=m.focusedElem,U=m.selectionRange;if(w!==S&&S&&S.ownerDocument&&C0(S.ownerDocument.documentElement,S)){if(U!==null&&Rf(S)){var te=U.start,me=U.end;if(me===void 0&&(me=te),"selectionStart"in S)S.selectionStart=te,S.selectionEnd=Math.min(me,S.value.length);else{var we=S.ownerDocument||document,ie=we&&we.defaultView||window;if(ie.getSelection){var de=ie.getSelection(),Je=S.textContent.length,ft=Math.min(U.start,Je),Tn=U.end===void 0?ft:Math.min(U.end,Je);!de.extend&&ft>Tn&&(w=Tn,Tn=ft,ft=w);var W=j0(S,ft),F=j0(S,Tn);if(W&&F&&(de.rangeCount!==1||de.anchorNode!==W.node||de.anchorOffset!==W.offset||de.focusNode!==F.node||de.focusOffset!==F.offset)){var J=we.createRange();J.setStart(W.node,W.offset),de.removeAllRanges(),ft>Tn?(de.addRange(J),de.extend(F.node,F.offset)):(J.setEnd(F.node,F.offset),de.addRange(J))}}}}for(we=[],de=S;de=de.parentNode;)de.nodeType===1&&we.push({element:de,left:de.scrollLeft,top:de.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<we.length;S++){var ye=we[S];ye.element.scrollLeft=ye.left,ye.element.scrollTop=ye.top}}Yh=!!ip,ap=ip=null}finally{mn=f,ue.p=c,Z.T=o}}n.current=r,ks=2}}function H1(){if(ks===2){ks=0;var n=Aa,r=_l,o=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||o){o=Z.T,Z.T=null;var c=ue.p;ue.p=2;var f=mn;mn|=4;try{v1(n,r.alternate,r)}finally{mn=f,ue.p=c,Z.T=o}}ks=3}}function $1(){if(ks===4||ks===3){ks=0,It();var n=Aa,r=_l,o=Yi,c=R1;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?ks=5:(ks=0,_l=Aa=null,W1(n,n.pendingLanes));var f=n.pendingLanes;if(f===0&&(Na=null),xn(o),r=r.stateNode,$e&&typeof $e.onCommitFiberRoot=="function")try{$e.onCommitFiberRoot(it,r,void 0,(r.current.flags&128)===128)}catch{}if(c!==null){r=Z.T,f=ue.p,ue.p=2,Z.T=null;try{for(var m=n.onRecoverableError,w=0;w<c.length;w++){var S=c[w];m(S.value,{componentStack:S.stack})}}finally{Z.T=r,ue.p=f}}(Yi&3)!==0&&Ph(),_i(n),f=n.pendingLanes,(o&261930)!==0&&(f&42)!==0?n===Wm?Ic++:(Ic=0,Wm=n):Ic=0,Dc(0)}}function W1(n,r){(n.pooledCacheLanes&=r)===0&&(r=n.pooledCache,r!=null&&(n.pooledCache=null,fc(r)))}function Ph(){return q1(),H1(),$1(),G1()}function G1(){if(ks!==5)return!1;var n=Aa,r=Hm;Hm=0;var o=xn(Yi),c=Z.T,f=ue.p;try{ue.p=32>o?32:o,Z.T=null,o=$m,$m=null;var m=Aa,w=Yi;if(ks=0,_l=Aa=null,Yi=0,(mn&6)!==0)throw Error(i(331));var S=mn;if(mn|=4,C1(m.current),T1(m,m.current,w,o),mn=S,Dc(0,!1),$e&&typeof $e.onPostCommitFiberRoot=="function")try{$e.onPostCommitFiberRoot(it,m)}catch{}return!0}finally{ue.p=f,Z.T=c,W1(n,r)}}function K1(n,r,o){r=Ur(o,r),r=Em(n.stateNode,r,2),n=ka(n,r,2),n!==null&&(Ge(n,2),_i(n))}function wn(n,r,o){if(n.tag===3)K1(n,n,o);else for(;r!==null;){if(r.tag===3){K1(r,n,o);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Na===null||!Na.has(c))){n=Ur(o,n),o=Yv(2),c=ka(r,o,2),c!==null&&(Qv(o,c,r,n),Ge(c,2),_i(c));break}}r=r.return}}function Ym(n,r,o){var c=n.pingCache;if(c===null){c=n.pingCache=new jT;var f=new Set;c.set(r,f)}else f=c.get(r),f===void 0&&(f=new Set,c.set(r,f));f.has(o)||(zm=!0,f.add(o),n=IT.bind(null,n,r,o),r.then(n,n))}function IT(n,r,o){var c=n.pingCache;c!==null&&c.delete(r),n.pingedLanes|=n.suspendedLanes&o,n.warmLanes&=~o,jn===n&&($t&o)===o&&(es===4||es===3&&($t&62914560)===$t&&300>vt()-Rh?(mn&2)===0&&xl(n,0):Fm|=o,wl===$t&&(wl=0)),_i(n)}function Y1(n,r){r===0&&(r=oe()),n=fo(n,r),n!==null&&(Ge(n,r),_i(n))}function DT(n){var r=n.memoizedState,o=0;r!==null&&(o=r.retryLane),Y1(n,o)}function MT(n,r){var o=0;switch(n.tag){case 31:case 13:var c=n.stateNode,f=n.memoizedState;f!==null&&(o=f.retryLane);break;case 19:c=n.stateNode;break;case 22:c=n.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(r),Y1(n,o)}function LT(n,r){return yt(n,r)}var Vh=null,El=null,Qm=!1,Uh=!1,Xm=!1,Ia=0;function _i(n){n!==El&&n.next===null&&(El===null?Vh=El=n:El=El.next=n),Uh=!0,Qm||(Qm=!0,PT())}function Dc(n,r){if(!Xm&&Uh){Xm=!0;do for(var o=!1,c=Vh;c!==null;){if(n!==0){var f=c.pendingLanes;if(f===0)var m=0;else{var w=c.suspendedLanes,S=c.pingedLanes;m=(1<<31-Fe(42|n)+1)-1,m&=f&~(w&~S),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(o=!0,Z1(c,m))}else m=$t,m=An(c,c===jn?m:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(m&3)===0||hn(c,m)||(o=!0,Z1(c,m));c=c.next}while(o);Xm=!1}}function OT(){Q1()}function Q1(){Uh=Qm=!1;var n=0;Ia!==0&&GT()&&(n=Ia);for(var r=vt(),o=null,c=Vh;c!==null;){var f=c.next,m=X1(c,r);m===0?(c.next=null,o===null?Vh=f:o.next=f,f===null&&(El=o)):(o=c,(n!==0||(m&3)!==0)&&(Uh=!0)),c=f}ks!==0&&ks!==5||Dc(n),Ia!==0&&(Ia=0)}function X1(n,r){for(var o=n.suspendedLanes,c=n.pingedLanes,f=n.expirationTimes,m=n.pendingLanes&-62914561;0<m;){var w=31-Fe(m),S=1<<w,U=f[w];U===-1?((S&o)===0||(S&c)!==0)&&(f[w]=yr(S,r)):U<=r&&(n.expiredLanes|=S),m&=~S}if(r=jn,o=$t,o=An(n,n===r?o:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c=n.callbackNode,o===0||n===r&&(bn===2||bn===9)||n.cancelPendingCommit!==null)return c!==null&&c!==null&&Bt(c),n.callbackNode=null,n.callbackPriority=0;if((o&3)===0||hn(n,o)){if(r=o&-o,r===n.callbackPriority)return r;switch(c!==null&&Bt(c),xn(o)){case 2:case 8:o=rs;break;case 32:o=Jt;break;case 268435456:o=Ae;break;default:o=Jt}return c=J1.bind(null,n),o=yt(o,c),n.callbackPriority=r,n.callbackNode=o,r}return c!==null&&c!==null&&Bt(c),n.callbackPriority=2,n.callbackNode=null,2}function J1(n,r){if(ks!==0&&ks!==5)return n.callbackNode=null,n.callbackPriority=0,null;var o=n.callbackNode;if(Ph()&&n.callbackNode!==o)return null;var c=$t;return c=An(n,n===jn?c:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c===0?null:(D1(n,c,r),X1(n,vt()),n.callbackNode!=null&&n.callbackNode===o?J1.bind(null,n):null)}function Z1(n,r){if(Ph())return null;D1(n,r,!0)}function PT(){YT(function(){(mn&6)!==0?yt(Cs,OT):Q1()})}function Jm(){if(Ia===0){var n=cl;n===0&&(n=zn,zn<<=1,(zn&261888)===0&&(zn=256)),Ia=n}return Ia}function eb(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:St(""+n)}function tb(n,r){var o=r.ownerDocument.createElement("input");return o.name=r.name,o.value=r.value,n.id&&o.setAttribute("form",n.id),r.parentNode.insertBefore(o,r),n=new FormData(n),o.parentNode.removeChild(o),n}function VT(n,r,o,c,f){if(r==="submit"&&o&&o.stateNode===f){var m=eb((f[In]||null).action),w=c.submitter;w&&(r=(r=w[In]||null)?eb(r.formAction):w.getAttribute("formAction"),r!==null&&(m=r,w=null));var S=new Fs("action","action",null,c,f);n.push({event:S,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Ia!==0){var U=w?tb(f,w):new FormData(f);vm(o,{pending:!0,data:U,method:f.method,action:m},null,U)}}else typeof m=="function"&&(S.preventDefault(),U=w?tb(f,w):new FormData(f),vm(o,{pending:!0,data:U,method:f.method,action:m},m,U))},currentTarget:f}]})}}for(var Zm=0;Zm<Lf.length;Zm++){var ep=Lf[Zm],UT=ep.toLowerCase(),BT=ep[0].toUpperCase()+ep.slice(1);ti(UT,"on"+BT)}ti(I0,"onAnimationEnd"),ti(D0,"onAnimationIteration"),ti(M0,"onAnimationStart"),ti("dblclick","onDoubleClick"),ti("focusin","onFocus"),ti("focusout","onBlur"),ti(nT,"onTransitionRun"),ti(sT,"onTransitionStart"),ti(rT,"onTransitionCancel"),ti(L0,"onTransitionEnd"),vn("onMouseEnter",["mouseout","mouseover"]),vn("onMouseLeave",["mouseout","mouseover"]),vn("onPointerEnter",["pointerout","pointerover"]),vn("onPointerLeave",["pointerout","pointerover"]),xs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),xs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),xs("onBeforeInput",["compositionend","keypress","textInput","paste"]),xs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),xs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),xs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zT=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Mc));function nb(n,r){r=(r&4)!==0;for(var o=0;o<n.length;o++){var c=n[o],f=c.event;c=c.listeners;e:{var m=void 0;if(r)for(var w=c.length-1;0<=w;w--){var S=c[w],U=S.instance,te=S.currentTarget;if(S=S.listener,U!==m&&f.isPropagationStopped())break e;m=S,f.currentTarget=te;try{m(f)}catch(me){eh(me)}f.currentTarget=null,m=U}else for(w=0;w<c.length;w++){if(S=c[w],U=S.instance,te=S.currentTarget,S=S.listener,U!==m&&f.isPropagationStopped())break e;m=S,f.currentTarget=te;try{m(f)}catch(me){eh(me)}f.currentTarget=null,m=U}}}}function Ft(n,r){var o=r[Ar];o===void 0&&(o=r[Ar]=new Set);var c=n+"__bubble";o.has(c)||(sb(r,n,2,!1),o.add(c))}function tp(n,r,o){var c=0;r&&(c|=4),sb(o,n,c,r)}var Bh="_reactListening"+Math.random().toString(36).slice(2);function np(n){if(!n[Bh]){n[Bh]=!0,Jr.forEach(function(o){o!=="selectionchange"&&(zT.has(o)||tp(o,!1,n),tp(o,!0,n))});var r=n.nodeType===9?n:n.ownerDocument;r===null||r[Bh]||(r[Bh]=!0,tp("selectionchange",!1,r))}}function sb(n,r,o,c){switch(Ib(r)){case 2:var f=pS;break;case 8:f=gS;break;default:f=yp}o=f.bind(null,r,o,n),f=void 0,!Ut||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(f=!0),c?f!==void 0?n.addEventListener(r,o,{capture:!0,passive:f}):n.addEventListener(r,o,!0):f!==void 0?n.addEventListener(r,o,{passive:f}):n.addEventListener(r,o,!1)}function sp(n,r,o,c,f){var m=c;if((r&1)===0&&(r&2)===0&&c!==null)e:for(;;){if(c===null)return;var w=c.tag;if(w===3||w===4){var S=c.stateNode.containerInfo;if(S===f)break;if(w===4)for(w=c.return;w!==null;){var U=w.tag;if((U===3||U===4)&&w.stateNode.containerInfo===f)return;w=w.return}for(;S!==null;){if(w=_s(S),w===null)return;if(U=w.tag,U===5||U===6||U===26||U===27){c=m=w;continue e}S=S.parentNode}}c=c.return}qe(function(){var te=m,me=X(o),we=[];e:{var ie=O0.get(n);if(ie!==void 0){var de=Fs,Je=n;switch(n){case"keypress":if(Jn(o)===0)break e;case"keydown":case"keyup":de=Xu;break;case"focusin":Je="focus",de=lo;break;case"focusout":Je="blur",de=lo;break;case"beforeblur":case"afterblur":de=lo;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":de=ic;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":de=Fu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":de=v;break;case I0:case D0:case M0:de=Hu;break;case L0:de=N;break;case"scroll":case"scrollend":de=Qs;break;case"wheel":de=ce;break;case"copy":case"cut":case"paste":de=$u;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":de=Li;break;case"toggle":case"beforetoggle":de=Mt}var ft=(r&4)!==0,Tn=!ft&&(n==="scroll"||n==="scrollend"),W=ft?ie!==null?ie+"Capture":null:ie;ft=[];for(var F=te,J;F!==null;){var ye=F;if(J=ye.stateNode,ye=ye.tag,ye!==5&&ye!==26&&ye!==27||J===null||W===null||(ye=pt(F,W),ye!=null&&ft.push(Lc(F,ye,J))),Tn)break;F=F.return}0<ft.length&&(ie=new de(ie,Je,null,o,me),we.push({event:ie,listeners:ft}))}}if((r&7)===0){e:{if(ie=n==="mouseover"||n==="pointerover",de=n==="mouseout"||n==="pointerout",ie&&o!==V&&(Je=o.relatedTarget||o.fromElement)&&(_s(Je)||Je[As]))break e;if((de||ie)&&(ie=me.window===me?me:(ie=me.ownerDocument)?ie.defaultView||ie.parentWindow:window,de?(Je=o.relatedTarget||o.toElement,de=te,Je=Je?_s(Je):null,Je!==null&&(Tn=u(Je),ft=Je.tag,Je!==Tn||ft!==5&&ft!==27&&ft!==6)&&(Je=null)):(de=null,Je=te),de!==Je)){if(ft=ic,ye="onMouseLeave",W="onMouseEnter",F="mouse",(n==="pointerout"||n==="pointerover")&&(ft=Li,ye="onPointerLeave",W="onPointerEnter",F="pointer"),Tn=de==null?ie:On(de),J=Je==null?ie:On(Je),ie=new ft(ye,F+"leave",de,o,me),ie.target=Tn,ie.relatedTarget=J,ye=null,_s(me)===te&&(ft=new ft(W,F+"enter",Je,o,me),ft.target=J,ft.relatedTarget=Tn,ye=ft),Tn=ye,de&&Je)t:{for(ft=FT,W=de,F=Je,J=0,ye=W;ye;ye=ft(ye))J++;ye=0;for(var at=F;at;at=ft(at))ye++;for(;0<J-ye;)W=ft(W),J--;for(;0<ye-J;)F=ft(F),ye--;for(;J--;){if(W===F||F!==null&&W===F.alternate){ft=W;break t}W=ft(W),F=ft(F)}ft=null}else ft=null;de!==null&&rb(we,ie,de,ft,!1),Je!==null&&Tn!==null&&rb(we,Tn,Je,ft,!0)}}e:{if(ie=te?On(te):window,de=ie.nodeName&&ie.nodeName.toLowerCase(),de==="select"||de==="input"&&ie.type==="file")var on=_0;else if(b0(ie))if(x0)on=ZE;else{on=XE;var nt=QE}else de=ie.nodeName,!de||de.toLowerCase()!=="input"||ie.type!=="checkbox"&&ie.type!=="radio"?te&&Ue(te.elementType)&&(on=_0):on=JE;if(on&&(on=on(n,te))){w0(we,on,o,me);break e}nt&&nt(n,ie,te),n==="focusout"&&te&&ie.type==="number"&&te.memoizedProps.value!=null&&Di(ie,"number",ie.value)}switch(nt=te?On(te):window,n){case"focusin":(b0(nt)||nt.contentEditable==="true")&&(tl=nt,If=te,uc=null);break;case"focusout":uc=If=tl=null;break;case"mousedown":Df=!0;break;case"contextmenu":case"mouseup":case"dragend":Df=!1,A0(we,o,me);break;case"selectionchange":if(tT)break;case"keydown":case"keyup":A0(we,o,me)}var Pt;if(fn)e:{switch(n){case"compositionstart":var Wt="onCompositionStart";break e;case"compositionend":Wt="onCompositionEnd";break e;case"compositionupdate":Wt="onCompositionUpdate";break e}Wt=void 0}else el?co(n,o)&&(Wt="onCompositionEnd"):n==="keydown"&&o.keyCode===229&&(Wt="onCompositionStart");Wt&&(yi&&o.locale!=="ko"&&(el||Wt!=="onCompositionStart"?Wt==="onCompositionEnd"&&el&&(Pt=Hn()):(en=me,Bs="value"in en?en.value:en.textContent,el=!0)),nt=zh(te,Wt),0<nt.length&&(Wt=new gi(Wt,n,null,o,me),we.push({event:Wt,listeners:nt}),Pt?Wt.data=Pt:(Pt=Zo(o),Pt!==null&&(Wt.data=Pt)))),(Pt=Pr?WE(n,o):GE(n,o))&&(Wt=zh(te,"onBeforeInput"),0<Wt.length&&(nt=new gi("onBeforeInput","beforeinput",null,o,me),we.push({event:nt,listeners:Wt}),nt.data=Pt)),VT(we,n,te,o,me)}nb(we,r)})}function Lc(n,r,o){return{instance:n,listener:r,currentTarget:o}}function zh(n,r){for(var o=r+"Capture",c=[];n!==null;){var f=n,m=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||m===null||(f=pt(n,o),f!=null&&c.unshift(Lc(n,f,m)),f=pt(n,r),f!=null&&c.push(Lc(n,f,m))),n.tag===3)return c;n=n.return}return[]}function FT(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function rb(n,r,o,c,f){for(var m=r._reactName,w=[];o!==null&&o!==c;){var S=o,U=S.alternate,te=S.stateNode;if(S=S.tag,U!==null&&U===c)break;S!==5&&S!==26&&S!==27||te===null||(U=te,f?(te=pt(o,m),te!=null&&w.unshift(Lc(o,te,U))):f||(te=pt(o,m),te!=null&&w.push(Lc(o,te,U)))),o=o.return}w.length!==0&&n.push({event:r,listeners:w})}var qT=/\r\n?/g,HT=/\u0000|\uFFFD/g;function ib(n){return(typeof n=="string"?n:""+n).replace(qT,`
`).replace(HT,"")}function ab(n,r){return r=ib(r),ib(n)===r}function En(n,r,o,c,f,m){switch(o){case"children":typeof c=="string"?r==="body"||r==="textarea"&&c===""||C(n,c):(typeof c=="number"||typeof c=="bigint")&&r!=="body"&&C(n,""+c);break;case"className":le(n,"class",c);break;case"tabIndex":le(n,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":le(n,o,c);break;case"style":Ie(n,c,m);break;case"data":if(r!=="object"){le(n,"data",c);break}case"src":case"href":if(c===""&&(r!=="a"||o!=="href")){n.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(o);break}c=St(""+c),n.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){n.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(o==="formAction"?(r!=="input"&&En(n,r,"name",f.name,f,null),En(n,r,"formEncType",f.formEncType,f,null),En(n,r,"formMethod",f.formMethod,f,null),En(n,r,"formTarget",f.formTarget,f,null)):(En(n,r,"encType",f.encType,f,null),En(n,r,"method",f.method,f,null),En(n,r,"target",f.target,f,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(o);break}c=St(""+c),n.setAttribute(o,c);break;case"onClick":c!=null&&(n.onclick=dt);break;case"onScroll":c!=null&&Ft("scroll",n);break;case"onScrollEnd":c!=null&&Ft("scrollend",n);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"multiple":n.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":n.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){n.removeAttribute("xlink:href");break}o=St(""+c),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,""+c):n.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,""):n.removeAttribute(o);break;case"capture":case"download":c===!0?n.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,c):n.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?n.setAttribute(o,c):n.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?n.removeAttribute(o):n.setAttribute(o,c);break;case"popover":Ft("beforetoggle",n),Ft("toggle",n),ae(n,"popover",c);break;case"xlinkActuate":Me(n,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Me(n,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Me(n,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Me(n,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Me(n,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Me(n,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Me(n,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Me(n,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Me(n,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":ae(n,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=ht.get(o)||o,ae(n,o,c))}}function rp(n,r,o,c,f,m){switch(o){case"style":Ie(n,c,m);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"children":typeof c=="string"?C(n,c):(typeof c=="number"||typeof c=="bigint")&&C(n,""+c);break;case"onScroll":c!=null&&Ft("scroll",n);break;case"onScrollEnd":c!=null&&Ft("scrollend",n);break;case"onClick":c!=null&&(n.onclick=dt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Dr.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(f=o.endsWith("Capture"),r=o.slice(2,f?o.length-7:void 0),m=n[In]||null,m=m!=null?m[o]:null,typeof m=="function"&&n.removeEventListener(r,m,f),typeof c=="function")){typeof m!="function"&&m!==null&&(o in n?n[o]=null:n.hasAttribute(o)&&n.removeAttribute(o)),n.addEventListener(r,c,f);break e}o in n?n[o]=c:c===!0?n.setAttribute(o,""):ae(n,o,c)}}}function Ms(n,r,o){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ft("error",n),Ft("load",n);var c=!1,f=!1,m;for(m in o)if(o.hasOwnProperty(m)){var w=o[m];if(w!=null)switch(m){case"src":c=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:En(n,r,m,w,o,null)}}f&&En(n,r,"srcSet",o.srcSet,o,null),c&&En(n,r,"src",o.src,o,null);return;case"input":Ft("invalid",n);var S=m=w=f=null,U=null,te=null;for(c in o)if(o.hasOwnProperty(c)){var me=o[c];if(me!=null)switch(c){case"name":f=me;break;case"type":w=me;break;case"checked":U=me;break;case"defaultChecked":te=me;break;case"value":m=me;break;case"defaultValue":S=me;break;case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(i(137,r));break;default:En(n,r,c,me,o,null)}}ma(n,m,S,U,te,w,f,!1);return;case"select":Ft("invalid",n),c=w=m=null;for(f in o)if(o.hasOwnProperty(f)&&(S=o[f],S!=null))switch(f){case"value":m=S;break;case"defaultValue":w=S;break;case"multiple":c=S;default:En(n,r,f,S,o,null)}r=m,o=w,n.multiple=!!c,r!=null?Mr(n,!!c,r,!1):o!=null&&Mr(n,!!c,o,!0);return;case"textarea":Ft("invalid",n),m=f=c=null;for(w in o)if(o.hasOwnProperty(w)&&(S=o[w],S!=null))switch(w){case"value":c=S;break;case"defaultValue":f=S;break;case"children":m=S;break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(i(91));break;default:En(n,r,w,S,o,null)}Lr(n,c,f,m);return;case"option":for(U in o)o.hasOwnProperty(U)&&(c=o[U],c!=null)&&(U==="selected"?n.selected=c&&typeof c!="function"&&typeof c!="symbol":En(n,r,U,c,o,null));return;case"dialog":Ft("beforetoggle",n),Ft("toggle",n),Ft("cancel",n),Ft("close",n);break;case"iframe":case"object":Ft("load",n);break;case"video":case"audio":for(c=0;c<Mc.length;c++)Ft(Mc[c],n);break;case"image":Ft("error",n),Ft("load",n);break;case"details":Ft("toggle",n);break;case"embed":case"source":case"link":Ft("error",n),Ft("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(te in o)if(o.hasOwnProperty(te)&&(c=o[te],c!=null))switch(te){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:En(n,r,te,c,o,null)}return;default:if(Ue(r)){for(me in o)o.hasOwnProperty(me)&&(c=o[me],c!==void 0&&rp(n,r,me,c,o,void 0));return}}for(S in o)o.hasOwnProperty(S)&&(c=o[S],c!=null&&En(n,r,S,c,o,null))}function $T(n,r,o,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,m=null,w=null,S=null,U=null,te=null,me=null;for(de in o){var we=o[de];if(o.hasOwnProperty(de)&&we!=null)switch(de){case"checked":break;case"value":break;case"defaultValue":U=we;default:c.hasOwnProperty(de)||En(n,r,de,null,c,we)}}for(var ie in c){var de=c[ie];if(we=o[ie],c.hasOwnProperty(ie)&&(de!=null||we!=null))switch(ie){case"type":m=de;break;case"name":f=de;break;case"checked":te=de;break;case"defaultChecked":me=de;break;case"value":w=de;break;case"defaultValue":S=de;break;case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(i(137,r));break;default:de!==we&&En(n,r,ie,de,c,we)}}vr(n,w,S,U,te,me,m,f);return;case"select":de=w=S=ie=null;for(m in o)if(U=o[m],o.hasOwnProperty(m)&&U!=null)switch(m){case"value":break;case"multiple":de=U;default:c.hasOwnProperty(m)||En(n,r,m,null,c,U)}for(f in c)if(m=c[f],U=o[f],c.hasOwnProperty(f)&&(m!=null||U!=null))switch(f){case"value":ie=m;break;case"defaultValue":S=m;break;case"multiple":w=m;default:m!==U&&En(n,r,f,m,c,U)}r=S,o=w,c=de,ie!=null?Mr(n,!!o,ie,!1):!!c!=!!o&&(r!=null?Mr(n,!!o,r,!0):Mr(n,!!o,o?[]:"",!1));return;case"textarea":de=ie=null;for(S in o)if(f=o[S],o.hasOwnProperty(S)&&f!=null&&!c.hasOwnProperty(S))switch(S){case"value":break;case"children":break;default:En(n,r,S,null,c,f)}for(w in c)if(f=c[w],m=o[w],c.hasOwnProperty(w)&&(f!=null||m!=null))switch(w){case"value":ie=f;break;case"defaultValue":de=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(i(91));break;default:f!==m&&En(n,r,w,f,c,m)}pa(n,ie,de);return;case"option":for(var Je in o)ie=o[Je],o.hasOwnProperty(Je)&&ie!=null&&!c.hasOwnProperty(Je)&&(Je==="selected"?n.selected=!1:En(n,r,Je,null,c,ie));for(U in c)ie=c[U],de=o[U],c.hasOwnProperty(U)&&ie!==de&&(ie!=null||de!=null)&&(U==="selected"?n.selected=ie&&typeof ie!="function"&&typeof ie!="symbol":En(n,r,U,ie,c,de));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ft in o)ie=o[ft],o.hasOwnProperty(ft)&&ie!=null&&!c.hasOwnProperty(ft)&&En(n,r,ft,null,c,ie);for(te in c)if(ie=c[te],de=o[te],c.hasOwnProperty(te)&&ie!==de&&(ie!=null||de!=null))switch(te){case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(i(137,r));break;default:En(n,r,te,ie,c,de)}return;default:if(Ue(r)){for(var Tn in o)ie=o[Tn],o.hasOwnProperty(Tn)&&ie!==void 0&&!c.hasOwnProperty(Tn)&&rp(n,r,Tn,void 0,c,ie);for(me in c)ie=c[me],de=o[me],!c.hasOwnProperty(me)||ie===de||ie===void 0&&de===void 0||rp(n,r,me,ie,c,de);return}}for(var W in o)ie=o[W],o.hasOwnProperty(W)&&ie!=null&&!c.hasOwnProperty(W)&&En(n,r,W,null,c,ie);for(we in c)ie=c[we],de=o[we],!c.hasOwnProperty(we)||ie===de||ie==null&&de==null||En(n,r,we,ie,c,de)}function ob(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function WT(){if(typeof performance.getEntriesByType=="function"){for(var n=0,r=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var f=o[c],m=f.transferSize,w=f.initiatorType,S=f.duration;if(m&&S&&ob(w)){for(w=0,S=f.responseEnd,c+=1;c<o.length;c++){var U=o[c],te=U.startTime;if(te>S)break;var me=U.transferSize,we=U.initiatorType;me&&ob(we)&&(U=U.responseEnd,w+=me*(U<S?1:(S-te)/(U-te)))}if(--c,r+=8*(m+w)/(f.duration/1e3),n++,10<n)break}}if(0<n)return r/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var ip=null,ap=null;function Fh(n){return n.nodeType===9?n:n.ownerDocument}function lb(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function cb(n,r){if(n===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&r==="foreignObject"?0:n}function op(n,r){return n==="textarea"||n==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var lp=null;function GT(){var n=window.event;return n&&n.type==="popstate"?n===lp?!1:(lp=n,!0):(lp=null,!1)}var ub=typeof setTimeout=="function"?setTimeout:void 0,KT=typeof clearTimeout=="function"?clearTimeout:void 0,hb=typeof Promise=="function"?Promise:void 0,YT=typeof queueMicrotask=="function"?queueMicrotask:typeof hb<"u"?function(n){return hb.resolve(null).then(n).catch(QT)}:ub;function QT(n){setTimeout(function(){throw n})}function Da(n){return n==="head"}function db(n,r){var o=r,c=0;do{var f=o.nextSibling;if(n.removeChild(o),f&&f.nodeType===8)if(o=f.data,o==="/$"||o==="/&"){if(c===0){n.removeChild(f),Cl(r);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")Oc(n.ownerDocument.documentElement);else if(o==="head"){o=n.ownerDocument.head,Oc(o);for(var m=o.firstChild;m;){var w=m.nextSibling,S=m.nodeName;m[qn]||S==="SCRIPT"||S==="STYLE"||S==="LINK"&&m.rel.toLowerCase()==="stylesheet"||o.removeChild(m),m=w}}else o==="body"&&Oc(n.ownerDocument.body);o=f}while(o);Cl(r)}function fb(n,r){var o=n;n=0;do{var c=o.nextSibling;if(o.nodeType===1?r?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(r?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(n===0)break;n--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||n++;o=c}while(o)}function cp(n){var r=n.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var o=r;switch(r=r.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":cp(o),Ys(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}n.removeChild(o)}}function XT(n,r,o,c){for(;n.nodeType===1;){var f=o;if(n.nodeName.toLowerCase()!==r.toLowerCase()){if(!c&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(c){if(!n[qn])switch(r){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(m=n.getAttribute("rel"),m==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(m!==f.rel||n.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||n.getAttribute("title")!==(f.title==null?null:f.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(m=n.getAttribute("src"),(m!==(f.src==null?null:f.src)||n.getAttribute("type")!==(f.type==null?null:f.type)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&m&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(r==="input"&&n.type==="hidden"){var m=f.name==null?null:""+f.name;if(f.type==="hidden"&&n.getAttribute("name")===m)return n}else return n;if(n=Hr(n.nextSibling),n===null)break}return null}function JT(n,r,o){if(r==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!o||(n=Hr(n.nextSibling),n===null))return null;return n}function mb(n,r){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!r||(n=Hr(n.nextSibling),n===null))return null;return n}function up(n){return n.data==="$?"||n.data==="$~"}function hp(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function ZT(n,r){var o=n.ownerDocument;if(n.data==="$~")n._reactRetry=r;else if(n.data!=="$?"||o.readyState!=="loading")r();else{var c=function(){r(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),n._reactRetry=c}}function Hr(n){for(;n!=null;n=n.nextSibling){var r=n.nodeType;if(r===1||r===3)break;if(r===8){if(r=n.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return n}var dp=null;function pb(n){n=n.nextSibling;for(var r=0;n;){if(n.nodeType===8){var o=n.data;if(o==="/$"||o==="/&"){if(r===0)return Hr(n.nextSibling);r--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||r++}n=n.nextSibling}return null}function gb(n){n=n.previousSibling;for(var r=0;n;){if(n.nodeType===8){var o=n.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(r===0)return n;r--}else o!=="/$"&&o!=="/&"||r++}n=n.previousSibling}return null}function yb(n,r,o){switch(r=Fh(o),n){case"html":if(n=r.documentElement,!n)throw Error(i(452));return n;case"head":if(n=r.head,!n)throw Error(i(453));return n;case"body":if(n=r.body,!n)throw Error(i(454));return n;default:throw Error(i(451))}}function Oc(n){for(var r=n.attributes;r.length;)n.removeAttributeNode(r[0]);Ys(n)}var $r=new Map,vb=new Set;function qh(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var Qi=ue.d;ue.d={f:eS,r:tS,D:nS,C:sS,L:rS,m:iS,X:oS,S:aS,M:lS};function eS(){var n=Qi.f(),r=Mh();return n||r}function tS(n){var r=Sn(n);r!==null&&r.tag===5&&r.type==="form"?Lv(r):Qi.r(n)}var Tl=typeof document>"u"?null:document;function bb(n,r,o){var c=Tl;if(c&&typeof r=="string"&&r){var f=Yn(r);f='link[rel="'+n+'"][href="'+f+'"]',typeof o=="string"&&(f+='[crossorigin="'+o+'"]'),vb.has(f)||(vb.add(f),n={rel:n,crossOrigin:o,href:r},c.querySelector(f)===null&&(r=c.createElement("link"),Ms(r,"link",n),qt(r),c.head.appendChild(r)))}}function nS(n){Qi.D(n),bb("dns-prefetch",n,null)}function sS(n,r){Qi.C(n,r),bb("preconnect",n,r)}function rS(n,r,o){Qi.L(n,r,o);var c=Tl;if(c&&n&&r){var f='link[rel="preload"][as="'+Yn(r)+'"]';r==="image"&&o&&o.imageSrcSet?(f+='[imagesrcset="'+Yn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(f+='[imagesizes="'+Yn(o.imageSizes)+'"]')):f+='[href="'+Yn(n)+'"]';var m=f;switch(r){case"style":m=Sl(n);break;case"script":m=jl(n)}$r.has(m)||(n=k({rel:"preload",href:r==="image"&&o&&o.imageSrcSet?void 0:n,as:r},o),$r.set(m,n),c.querySelector(f)!==null||r==="style"&&c.querySelector(Pc(m))||r==="script"&&c.querySelector(Vc(m))||(r=c.createElement("link"),Ms(r,"link",n),qt(r),c.head.appendChild(r)))}}function iS(n,r){Qi.m(n,r);var o=Tl;if(o&&n){var c=r&&typeof r.as=="string"?r.as:"script",f='link[rel="modulepreload"][as="'+Yn(c)+'"][href="'+Yn(n)+'"]',m=f;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=jl(n)}if(!$r.has(m)&&(n=k({rel:"modulepreload",href:n},r),$r.set(m,n),o.querySelector(f)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Vc(m)))return}c=o.createElement("link"),Ms(c,"link",n),qt(c),o.head.appendChild(c)}}}function aS(n,r,o){Qi.S(n,r,o);var c=Tl;if(c&&n){var f=as(c).hoistableStyles,m=Sl(n);r=r||"default";var w=f.get(m);if(!w){var S={loading:0,preload:null};if(w=c.querySelector(Pc(m)))S.loading=5;else{n=k({rel:"stylesheet",href:n,"data-precedence":r},o),(o=$r.get(m))&&fp(n,o);var U=w=c.createElement("link");qt(U),Ms(U,"link",n),U._p=new Promise(function(te,me){U.onload=te,U.onerror=me}),U.addEventListener("load",function(){S.loading|=1}),U.addEventListener("error",function(){S.loading|=2}),S.loading|=4,Hh(w,r,c)}w={type:"stylesheet",instance:w,count:1,state:S},f.set(m,w)}}}function oS(n,r){Qi.X(n,r);var o=Tl;if(o&&n){var c=as(o).hoistableScripts,f=jl(n),m=c.get(f);m||(m=o.querySelector(Vc(f)),m||(n=k({src:n,async:!0},r),(r=$r.get(f))&&mp(n,r),m=o.createElement("script"),qt(m),Ms(m,"link",n),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function lS(n,r){Qi.M(n,r);var o=Tl;if(o&&n){var c=as(o).hoistableScripts,f=jl(n),m=c.get(f);m||(m=o.querySelector(Vc(f)),m||(n=k({src:n,async:!0,type:"module"},r),(r=$r.get(f))&&mp(n,r),m=o.createElement("script"),qt(m),Ms(m,"link",n),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function wb(n,r,o,c){var f=(f=Se.current)?qh(f):null;if(!f)throw Error(i(446));switch(n){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(r=Sl(o.href),o=as(f).hoistableStyles,c=o.get(r),c||(c={type:"style",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){n=Sl(o.href);var m=as(f).hoistableStyles,w=m.get(n);if(w||(f=f.ownerDocument||f,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(n,w),(m=f.querySelector(Pc(n)))&&!m._p&&(w.instance=m,w.state.loading=5),$r.has(n)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},$r.set(n,o),m||cS(f,n,o,w.state))),r&&c===null)throw Error(i(528,""));return w}if(r&&c!==null)throw Error(i(529,""));return null;case"script":return r=o.async,o=o.src,typeof o=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=jl(o),o=as(f).hoistableScripts,c=o.get(r),c||(c={type:"script",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,n))}}function Sl(n){return'href="'+Yn(n)+'"'}function Pc(n){return'link[rel="stylesheet"]['+n+"]"}function _b(n){return k({},n,{"data-precedence":n.precedence,precedence:null})}function cS(n,r,o,c){n.querySelector('link[rel="preload"][as="style"]['+r+"]")?c.loading=1:(r=n.createElement("link"),c.preload=r,r.addEventListener("load",function(){return c.loading|=1}),r.addEventListener("error",function(){return c.loading|=2}),Ms(r,"link",o),qt(r),n.head.appendChild(r))}function jl(n){return'[src="'+Yn(n)+'"]'}function Vc(n){return"script[async]"+n}function xb(n,r,o){if(r.count++,r.instance===null)switch(r.type){case"style":var c=n.querySelector('style[data-href~="'+Yn(o.href)+'"]');if(c)return r.instance=c,qt(c),c;var f=k({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(n.ownerDocument||n).createElement("style"),qt(c),Ms(c,"style",f),Hh(c,o.precedence,n),r.instance=c;case"stylesheet":f=Sl(o.href);var m=n.querySelector(Pc(f));if(m)return r.state.loading|=4,r.instance=m,qt(m),m;c=_b(o),(f=$r.get(f))&&fp(c,f),m=(n.ownerDocument||n).createElement("link"),qt(m);var w=m;return w._p=new Promise(function(S,U){w.onload=S,w.onerror=U}),Ms(m,"link",c),r.state.loading|=4,Hh(m,o.precedence,n),r.instance=m;case"script":return m=jl(o.src),(f=n.querySelector(Vc(m)))?(r.instance=f,qt(f),f):(c=o,(f=$r.get(m))&&(c=k({},o),mp(c,f)),n=n.ownerDocument||n,f=n.createElement("script"),qt(f),Ms(f,"link",c),n.head.appendChild(f),r.instance=f);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(c=r.instance,r.state.loading|=4,Hh(c,o.precedence,n));return r.instance}function Hh(n,r,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=c.length?c[c.length-1]:null,m=f,w=0;w<c.length;w++){var S=c[w];if(S.dataset.precedence===r)m=S;else if(m!==f)break}m?m.parentNode.insertBefore(n,m.nextSibling):(r=o.nodeType===9?o.head:o,r.insertBefore(n,r.firstChild))}function fp(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.title==null&&(n.title=r.title)}function mp(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.integrity==null&&(n.integrity=r.integrity)}var $h=null;function kb(n,r,o){if($h===null){var c=new Map,f=$h=new Map;f.set(o,c)}else f=$h,c=f.get(o),c||(c=new Map,f.set(o,c));if(c.has(n))return c;for(c.set(n,null),o=o.getElementsByTagName(n),f=0;f<o.length;f++){var m=o[f];if(!(m[qn]||m[Zt]||n==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var w=m.getAttribute(r)||"";w=n+w;var S=c.get(w);S?S.push(m):c.set(w,[m])}}return c}function Eb(n,r,o){n=n.ownerDocument||n,n.head.insertBefore(o,r==="title"?n.querySelector("head > title"):null)}function uS(n,r,o){if(o===1||r.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;return r.rel==="stylesheet"?(n=r.disabled,typeof r.precedence=="string"&&n==null):!0;case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function Tb(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function hS(n,r,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var f=Sl(c.href),m=r.querySelector(Pc(f));if(m){r=m._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(n.count++,n=Wh.bind(n),r.then(n,n)),o.state.loading|=4,o.instance=m,qt(m);return}m=r.ownerDocument||r,c=_b(c),(f=$r.get(f))&&fp(c,f),m=m.createElement("link"),qt(m);var w=m;w._p=new Promise(function(S,U){w.onload=S,w.onerror=U}),Ms(m,"link",c),o.instance=m}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(o,r),(r=o.state.preload)&&(o.state.loading&3)===0&&(n.count++,o=Wh.bind(n),r.addEventListener("load",o),r.addEventListener("error",o))}}var pp=0;function dS(n,r){return n.stylesheets&&n.count===0&&Kh(n,n.stylesheets),0<n.count||0<n.imgCount?function(o){var c=setTimeout(function(){if(n.stylesheets&&Kh(n,n.stylesheets),n.unsuspend){var m=n.unsuspend;n.unsuspend=null,m()}},6e4+r);0<n.imgBytes&&pp===0&&(pp=62500*WT());var f=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&Kh(n,n.stylesheets),n.unsuspend)){var m=n.unsuspend;n.unsuspend=null,m()}},(n.imgBytes>pp?50:800)+r);return n.unsuspend=o,function(){n.unsuspend=null,clearTimeout(c),clearTimeout(f)}}:null}function Wh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Kh(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Gh=null;function Kh(n,r){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Gh=new Map,r.forEach(fS,n),Gh=null,Wh.call(n))}function fS(n,r){if(!(r.state.loading&4)){var o=Gh.get(n);if(o)var c=o.get(null);else{o=new Map,Gh.set(n,o);for(var f=n.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<f.length;m++){var w=f[m];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(o.set(w.dataset.precedence,w),c=w)}c&&o.set(null,c)}f=r.instance,w=f.getAttribute("data-precedence"),m=o.get(w)||c,m===c&&o.set(null,f),o.set(w,f),this.count++,c=Wh.bind(this),f.addEventListener("load",c),f.addEventListener("error",c),m?m.parentNode.insertBefore(f,m.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(f,n.firstChild)),r.state.loading|=4}}var Uc={$$typeof:G,Provider:null,Consumer:null,_currentValue:Ce,_currentValue2:Ce,_threadCount:0};function mS(n,r,o,c,f,m,w,S,U){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Re(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Re(0),this.hiddenUpdates=Re(null),this.identifierPrefix=c,this.onUncaughtError=f,this.onCaughtError=m,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=U,this.incompleteTransitions=new Map}function Sb(n,r,o,c,f,m,w,S,U,te,me,we){return n=new mS(n,r,o,w,U,te,me,we,S),r=1,m===!0&&(r|=24),m=wr(3,null,null,r),n.current=m,m.stateNode=n,r=Kf(),r.refCount++,n.pooledCache=r,r.refCount++,m.memoizedState={element:c,isDehydrated:o,cache:r},Jf(m),n}function jb(n){return n?(n=rl,n):rl}function Cb(n,r,o,c,f,m){f=jb(f),c.context===null?c.context=f:c.pendingContext=f,c=xa(r),c.payload={element:o},m=m===void 0?null:m,m!==null&&(c.callback=m),o=ka(n,c,r),o!==null&&(dr(o,n,r),yc(o,n,r))}function Nb(n,r){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var o=n.retryLane;n.retryLane=o!==0&&o<r?o:r}}function gp(n,r){Nb(n,r),(n=n.alternate)&&Nb(n,r)}function Ab(n){if(n.tag===13||n.tag===31){var r=fo(n,67108864);r!==null&&dr(r,n,67108864),gp(n,67108864)}}function Rb(n){if(n.tag===13||n.tag===31){var r=Tr();r=pn(r);var o=fo(n,r);o!==null&&dr(o,n,r),gp(n,r)}}var Yh=!0;function pS(n,r,o,c){var f=Z.T;Z.T=null;var m=ue.p;try{ue.p=2,yp(n,r,o,c)}finally{ue.p=m,Z.T=f}}function gS(n,r,o,c){var f=Z.T;Z.T=null;var m=ue.p;try{ue.p=8,yp(n,r,o,c)}finally{ue.p=m,Z.T=f}}function yp(n,r,o,c){if(Yh){var f=vp(c);if(f===null)sp(n,r,c,Qh,o),Db(n,c);else if(vS(f,n,r,o,c))c.stopPropagation();else if(Db(n,c),r&4&&-1<yS.indexOf(n)){for(;f!==null;){var m=Sn(f);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var w=Fn(m.pendingLanes);if(w!==0){var S=m;for(S.pendingLanes|=2,S.entangledLanes|=2;w;){var U=1<<31-Fe(w);S.entanglements[1]|=U,w&=~U}_i(m),(mn&6)===0&&(Ih=vt()+500,Dc(0))}}break;case 31:case 13:S=fo(m,2),S!==null&&dr(S,m,2),Mh(),gp(m,2)}if(m=vp(c),m===null&&sp(n,r,c,Qh,o),m===f)break;f=m}f!==null&&c.stopPropagation()}else sp(n,r,c,null,o)}}function vp(n){return n=X(n),bp(n)}var Qh=null;function bp(n){if(Qh=null,n=_s(n),n!==null){var r=u(n);if(r===null)n=null;else{var o=r.tag;if(o===13){if(n=h(r),n!==null)return n;n=null}else if(o===31){if(n=p(r),n!==null)return n;n=null}else if(o===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;n=null}else r!==n&&(n=null)}}return Qh=n,null}function Ib(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(rn()){case Cs:return 2;case rs:return 8;case Jt:case re:return 32;case Ae:return 268435456;default:return 32}default:return 32}}var wp=!1,Ma=null,La=null,Oa=null,Bc=new Map,zc=new Map,Pa=[],yS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Db(n,r){switch(n){case"focusin":case"focusout":Ma=null;break;case"dragenter":case"dragleave":La=null;break;case"mouseover":case"mouseout":Oa=null;break;case"pointerover":case"pointerout":Bc.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":zc.delete(r.pointerId)}}function Fc(n,r,o,c,f,m){return n===null||n.nativeEvent!==m?(n={blockedOn:r,domEventName:o,eventSystemFlags:c,nativeEvent:m,targetContainers:[f]},r!==null&&(r=Sn(r),r!==null&&Ab(r)),n):(n.eventSystemFlags|=c,r=n.targetContainers,f!==null&&r.indexOf(f)===-1&&r.push(f),n)}function vS(n,r,o,c,f){switch(r){case"focusin":return Ma=Fc(Ma,n,r,o,c,f),!0;case"dragenter":return La=Fc(La,n,r,o,c,f),!0;case"mouseover":return Oa=Fc(Oa,n,r,o,c,f),!0;case"pointerover":var m=f.pointerId;return Bc.set(m,Fc(Bc.get(m)||null,n,r,o,c,f)),!0;case"gotpointercapture":return m=f.pointerId,zc.set(m,Fc(zc.get(m)||null,n,r,o,c,f)),!0}return!1}function Mb(n){var r=_s(n.target);if(r!==null){var o=u(r);if(o!==null){if(r=o.tag,r===13){if(r=h(o),r!==null){n.blockedOn=r,is(n.priority,function(){Rb(o)});return}}else if(r===31){if(r=p(o),r!==null){n.blockedOn=r,is(n.priority,function(){Rb(o)});return}}else if(r===3&&o.stateNode.current.memoizedState.isDehydrated){n.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Xh(n){if(n.blockedOn!==null)return!1;for(var r=n.targetContainers;0<r.length;){var o=vp(n.nativeEvent);if(o===null){o=n.nativeEvent;var c=new o.constructor(o.type,o);V=c,o.target.dispatchEvent(c),V=null}else return r=Sn(o),r!==null&&Ab(r),n.blockedOn=o,!1;r.shift()}return!0}function Lb(n,r,o){Xh(n)&&o.delete(r)}function bS(){wp=!1,Ma!==null&&Xh(Ma)&&(Ma=null),La!==null&&Xh(La)&&(La=null),Oa!==null&&Xh(Oa)&&(Oa=null),Bc.forEach(Lb),zc.forEach(Lb)}function Jh(n,r){n.blockedOn===r&&(n.blockedOn=null,wp||(wp=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,bS)))}var Zh=null;function Ob(n){Zh!==n&&(Zh=n,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){Zh===n&&(Zh=null);for(var r=0;r<n.length;r+=3){var o=n[r],c=n[r+1],f=n[r+2];if(typeof c!="function"){if(bp(c||o)===null)continue;break}var m=Sn(o);m!==null&&(n.splice(r,3),r-=3,vm(m,{pending:!0,data:f,method:o.method,action:c},c,f))}}))}function Cl(n){function r(U){return Jh(U,n)}Ma!==null&&Jh(Ma,n),La!==null&&Jh(La,n),Oa!==null&&Jh(Oa,n),Bc.forEach(r),zc.forEach(r);for(var o=0;o<Pa.length;o++){var c=Pa[o];c.blockedOn===n&&(c.blockedOn=null)}for(;0<Pa.length&&(o=Pa[0],o.blockedOn===null);)Mb(o),o.blockedOn===null&&Pa.shift();if(o=(n.ownerDocument||n).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var f=o[c],m=o[c+1],w=f[In]||null;if(typeof m=="function")w||Ob(o);else if(w){var S=null;if(m&&m.hasAttribute("formAction")){if(f=m,w=m[In]||null)S=w.formAction;else if(bp(f)!==null)continue}else S=w.action;typeof S=="function"?o[c+1]=S:(o.splice(c,3),c-=3),Ob(o)}}}function Pb(){function n(m){m.canIntercept&&m.info==="react-transition"&&m.intercept({handler:function(){return new Promise(function(w){return f=w})},focusReset:"manual",scroll:"manual"})}function r(){f!==null&&(f(),f=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var m=navigation.currentEntry;m&&m.url!=null&&navigation.navigate(m.url,{state:m.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,f=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),f!==null&&(f(),f=null)}}}function _p(n){this._internalRoot=n}ed.prototype.render=_p.prototype.render=function(n){var r=this._internalRoot;if(r===null)throw Error(i(409));var o=r.current,c=Tr();Cb(o,c,n,r,null,null)},ed.prototype.unmount=_p.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var r=n.containerInfo;Cb(n.current,2,null,n,null,null),Mh(),r[As]=null}};function ed(n){this._internalRoot=n}ed.prototype.unstable_scheduleHydration=function(n){if(n){var r=Ns();n={blockedOn:null,target:n,priority:r};for(var o=0;o<Pa.length&&r!==0&&r<Pa[o].priority;o++);Pa.splice(o,0,n),o===0&&Mb(n)}};var Vb=e.version;if(Vb!=="19.2.4")throw Error(i(527,Vb,"19.2.4"));ue.findDOMNode=function(n){var r=n._reactInternals;if(r===void 0)throw typeof n.render=="function"?Error(i(188)):(n=Object.keys(n).join(","),Error(i(268,n)));return n=y(r),n=n!==null?b(n):null,n=n===null?null:n.stateNode,n};var wS={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:Z,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var td=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!td.isDisabled&&td.supportsFiber)try{it=td.inject(wS),$e=td}catch{}}return Hc.createRoot=function(n,r){if(!l(n))throw Error(i(299));var o=!1,c="",f=$v,m=Wv,w=Gv;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onUncaughtError!==void 0&&(f=r.onUncaughtError),r.onCaughtError!==void 0&&(m=r.onCaughtError),r.onRecoverableError!==void 0&&(w=r.onRecoverableError)),r=Sb(n,1,!1,null,null,o,c,null,f,m,w,Pb),n[As]=r.current,np(n),new _p(r)},Hc.hydrateRoot=function(n,r,o){if(!l(n))throw Error(i(299));var c=!1,f="",m=$v,w=Wv,S=Gv,U=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(m=o.onUncaughtError),o.onCaughtError!==void 0&&(w=o.onCaughtError),o.onRecoverableError!==void 0&&(S=o.onRecoverableError),o.formState!==void 0&&(U=o.formState)),r=Sb(n,1,!0,r,o??null,c,f,U,m,w,S,Pb),r.context=jb(null),o=r.current,c=Tr(),c=pn(c),f=xa(c),f.callback=null,ka(o,f,c),o=c,r.current.lanes=o,Ge(r,o),_i(r),n[As]=r.current,np(n),new ed(r)},Hc.version="19.2.4",Hc}var Kb;function AS(){if(Kb)return Ep.exports;Kb=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Ep.exports=NS(),Ep.exports}var RS=AS();const IS="modulepreload",DS=function(s){return"/login/"+s},Yb={},Ks=function(e,t,i){let l=Promise.resolve();if(t&&t.length>0){let g=function(y){return Promise.all(y.map(b=>Promise.resolve(b).then(k=>({status:"fulfilled",value:k}),k=>({status:"rejected",reason:k}))))};document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),p=h?.nonce||h?.getAttribute("nonce");l=g(t.map(y=>{if(y=DS(y),y in Yb)return;Yb[y]=!0;const b=y.endsWith(".css"),k=b?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${k}`))return;const E=document.createElement("link");if(E.rel=b?"stylesheet":IS,b||(E.as="script"),E.crossOrigin="",E.href=y,p&&E.setAttribute("nonce",p),document.head.appendChild(E),b)return new Promise((O,H)=>{E.addEventListener("load",O),E.addEventListener("error",()=>H(new Error(`Unable to preload CSS for ${y}`)))})}))}function u(h){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=h,window.dispatchEvent(p),!p.defaultPrevented)throw h}return l.then(h=>{for(const p of h||[])p.status==="rejected"&&u(p.reason);return e().catch(u)})};var Qb="popstate";function MS(s={}){function e(i,l){let{pathname:u,search:h,hash:p}=i.location;return dg("",{pathname:u,search:h,hash:p},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function t(i,l){return typeof l=="string"?l:uu(l)}return OS(e,t,null,s)}function Gn(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function Yr(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function LS(){return Math.random().toString(36).substring(2,10)}function Xb(s,e){return{usr:s.state,key:s.key,idx:e}}function dg(s,e,t=null,i){return{pathname:typeof s=="string"?s:s.pathname,search:"",hash:"",...typeof e=="string"?Yl(e):e,state:t,key:e&&e.key||i||LS()}}function uu({pathname:s="/",search:e="",hash:t=""}){return e&&e!=="?"&&(s+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(s+=t.charAt(0)==="#"?t:"#"+t),s}function Yl(s){let e={};if(s){let t=s.indexOf("#");t>=0&&(e.hash=s.substring(t),s=s.substring(0,t));let i=s.indexOf("?");i>=0&&(e.search=s.substring(i),s=s.substring(0,i)),s&&(e.pathname=s)}return e}function OS(s,e,t,i={}){let{window:l=document.defaultView,v5Compat:u=!1}=i,h=l.history,p="POP",g=null,y=b();y==null&&(y=0,h.replaceState({...h.state,idx:y},""));function b(){return(h.state||{idx:null}).idx}function k(){p="POP";let B=b(),K=B==null?null:B-y;y=B,g&&g({action:p,location:q.location,delta:K})}function E(B,K){p="PUSH";let $=dg(q.location,B,K);y=b()+1;let G=Xb($,y),fe=q.createHref($);try{h.pushState(G,"",fe)}catch(xe){if(xe instanceof DOMException&&xe.name==="DataCloneError")throw xe;l.location.assign(fe)}u&&g&&g({action:p,location:q.location,delta:1})}function O(B,K){p="REPLACE";let $=dg(q.location,B,K);y=b();let G=Xb($,y),fe=q.createHref($);h.replaceState(G,"",fe),u&&g&&g({action:p,location:q.location,delta:0})}function H(B){return PS(B)}let q={get action(){return p},get location(){return s(l,h)},listen(B){if(g)throw new Error("A history only accepts one active listener");return l.addEventListener(Qb,k),g=B,()=>{l.removeEventListener(Qb,k),g=null}},createHref(B){return e(l,B)},createURL:H,encodeLocation(B){let K=H(B);return{pathname:K.pathname,search:K.search,hash:K.hash}},push:E,replace:O,go(B){return h.go(B)}};return q}function PS(s,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Gn(t,"No window.location.(origin|href) available to create URL");let i=typeof s=="string"?s:uu(s);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function u_(s,e,t="/"){return VS(s,e,t,!1)}function VS(s,e,t,i){let l=typeof e=="string"?Yl(e):e,u=ra(l.pathname||"/",t);if(u==null)return null;let h=h_(s);US(h);let p=null;for(let g=0;p==null&&g<h.length;++g){let y=QS(u);p=KS(h[g],y,i)}return p}function h_(s,e=[],t=[],i="",l=!1){let u=(h,p,g=l,y)=>{let b={relativePath:y===void 0?h.path||"":y,caseSensitive:h.caseSensitive===!0,childrenIndex:p,route:h};if(b.relativePath.startsWith("/")){if(!b.relativePath.startsWith(i)&&g)return;Gn(b.relativePath.startsWith(i),`Absolute route path "${b.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),b.relativePath=b.relativePath.slice(i.length)}let k=ea([i,b.relativePath]),E=t.concat(b);h.children&&h.children.length>0&&(Gn(h.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${k}".`),h_(h.children,e,E,k,g)),!(h.path==null&&!h.index)&&e.push({path:k,score:WS(k,h.index),routesMeta:E})};return s.forEach((h,p)=>{if(h.path===""||!h.path?.includes("?"))u(h,p);else for(let g of d_(h.path))u(h,p,!0,g)}),e}function d_(s){let e=s.split("/");if(e.length===0)return[];let[t,...i]=e,l=t.endsWith("?"),u=t.replace(/\?$/,"");if(i.length===0)return l?[u,""]:[u];let h=d_(i.join("/")),p=[];return p.push(...h.map(g=>g===""?u:[u,g].join("/"))),l&&p.push(...h),p.map(g=>s.startsWith("/")&&g===""?"/":g)}function US(s){s.sort((e,t)=>e.score!==t.score?t.score-e.score:GS(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var BS=/^:[\w-]+$/,zS=3,FS=2,qS=1,HS=10,$S=-2,Jb=s=>s==="*";function WS(s,e){let t=s.split("/"),i=t.length;return t.some(Jb)&&(i+=$S),e&&(i+=FS),t.filter(l=>!Jb(l)).reduce((l,u)=>l+(BS.test(u)?zS:u===""?qS:HS),i)}function GS(s,e){return s.length===e.length&&s.slice(0,-1).every((i,l)=>i===e[l])?s[s.length-1]-e[e.length-1]:0}function KS(s,e,t=!1){let{routesMeta:i}=s,l={},u="/",h=[];for(let p=0;p<i.length;++p){let g=i[p],y=p===i.length-1,b=u==="/"?e:e.slice(u.length)||"/",k=Ad({path:g.relativePath,caseSensitive:g.caseSensitive,end:y},b),E=g.route;if(!k&&y&&t&&!i[i.length-1].route.index&&(k=Ad({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},b)),!k)return null;Object.assign(l,k.params),h.push({params:l,pathname:ea([u,k.pathname]),pathnameBase:ej(ea([u,k.pathnameBase])),route:E}),k.pathnameBase!=="/"&&(u=ea([u,k.pathnameBase]))}return h}function Ad(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[t,i]=YS(s.path,s.caseSensitive,s.end),l=e.match(t);if(!l)return null;let u=l[0],h=u.replace(/(.)\/+$/,"$1"),p=l.slice(1);return{params:i.reduce((y,{paramName:b,isOptional:k},E)=>{if(b==="*"){let H=p[E]||"";h=u.slice(0,u.length-H.length).replace(/(.)\/+$/,"$1")}const O=p[E];return k&&!O?y[b]=void 0:y[b]=(O||"").replace(/%2F/g,"/"),y},{}),pathname:u,pathnameBase:h,pattern:s}}function YS(s,e=!1,t=!0){Yr(s==="*"||!s.endsWith("*")||s.endsWith("/*"),`Route path "${s}" will be treated as if it were "${s.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${s.replace(/\*$/,"/*")}".`);let i=[],l="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(h,p,g)=>(i.push({paramName:p,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return s.endsWith("*")?(i.push({paramName:"*"}),l+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?l+="\\/*$":s!==""&&s!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,e?void 0:"i"),i]}function QS(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Yr(!1,`The URL path "${s}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),s}}function ra(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=s.charAt(t);return i&&i!=="/"?null:s.slice(t)||"/"}var XS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function JS(s,e="/"){let{pathname:t,search:i="",hash:l=""}=typeof s=="string"?Yl(s):s,u;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?u=Zb(t.substring(1),"/"):u=Zb(t,e)):u=e,{pathname:u,search:tj(i),hash:nj(l)}}function Zb(s,e){let t=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(l=>{l===".."?t.length>1&&t.pop():l!=="."&&t.push(l)}),t.length>1?t.join("/"):"/"}function Cp(s,e,t,i){return`Cannot include a '${s}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function ZS(s){return s.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Kg(s){let e=ZS(s);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function Yg(s,e,t,i=!1){let l;typeof s=="string"?l=Yl(s):(l={...s},Gn(!l.pathname||!l.pathname.includes("?"),Cp("?","pathname","search",l)),Gn(!l.pathname||!l.pathname.includes("#"),Cp("#","pathname","hash",l)),Gn(!l.search||!l.search.includes("#"),Cp("#","search","hash",l)));let u=s===""||l.pathname==="",h=u?"/":l.pathname,p;if(h==null)p=t;else{let k=e.length-1;if(!i&&h.startsWith("..")){let E=h.split("/");for(;E[0]==="..";)E.shift(),k-=1;l.pathname=E.join("/")}p=k>=0?e[k]:"/"}let g=JS(l,p),y=h&&h!=="/"&&h.endsWith("/"),b=(u||h===".")&&t.endsWith("/");return!g.pathname.endsWith("/")&&(y||b)&&(g.pathname+="/"),g}var ea=s=>s.join("/").replace(/\/\/+/g,"/"),ej=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),tj=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,nj=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s,sj=class{constructor(s,e,t,i=!1){this.status=s,this.statusText=e||"",this.internal=i,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function rj(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}function ij(s){return s.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var f_=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function m_(s,e){let t=s;if(typeof t!="string"||!XS.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let i=t,l=!1;if(f_)try{let u=new URL(window.location.href),h=t.startsWith("//")?new URL(u.protocol+t):new URL(t),p=ra(h.pathname,e);h.origin===u.origin&&p!=null?t=p+h.search+h.hash:l=!0}catch{Yr(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:l,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var p_=["POST","PUT","PATCH","DELETE"];new Set(p_);var aj=["GET",...p_];new Set(aj);var Ql=_.createContext(null);Ql.displayName="DataRouter";var Jd=_.createContext(null);Jd.displayName="DataRouterState";var oj=_.createContext(!1),g_=_.createContext({isTransitioning:!1});g_.displayName="ViewTransition";var lj=_.createContext(new Map);lj.displayName="Fetchers";var cj=_.createContext(null);cj.displayName="Await";var Nr=_.createContext(null);Nr.displayName="Navigation";var Tu=_.createContext(null);Tu.displayName="Location";var hi=_.createContext({outlet:null,matches:[],isDataRoute:!1});hi.displayName="Route";var Qg=_.createContext(null);Qg.displayName="RouteError";var y_="REACT_ROUTER_ERROR",uj="REDIRECT",hj="ROUTE_ERROR_RESPONSE";function dj(s){if(s.startsWith(`${y_}:${uj}:{`))try{let e=JSON.parse(s.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function fj(s){if(s.startsWith(`${y_}:${hj}:{`))try{let e=JSON.parse(s.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new sj(e.status,e.statusText,e.data)}catch{}}function mj(s,{relative:e}={}){Gn(Xl(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=_.useContext(Nr),{hash:l,pathname:u,search:h}=Su(s,{relative:e}),p=u;return t!=="/"&&(p=u==="/"?t:ea([t,u])),i.createHref({pathname:p,search:h,hash:l})}function Xl(){return _.useContext(Tu)!=null}function Ii(){return Gn(Xl(),"useLocation() may be used only in the context of a <Router> component."),_.useContext(Tu).location}var v_="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function b_(s){_.useContext(Nr).static||_.useLayoutEffect(s)}function ir(){let{isDataRoute:s}=_.useContext(hi);return s?Cj():pj()}function pj(){Gn(Xl(),"useNavigate() may be used only in the context of a <Router> component.");let s=_.useContext(Ql),{basename:e,navigator:t}=_.useContext(Nr),{matches:i}=_.useContext(hi),{pathname:l}=Ii(),u=JSON.stringify(Kg(i)),h=_.useRef(!1);return b_(()=>{h.current=!0}),_.useCallback((g,y={})=>{if(Yr(h.current,v_),!h.current)return;if(typeof g=="number"){t.go(g);return}let b=Yg(g,JSON.parse(u),l,y.relative==="path");s==null&&e!=="/"&&(b.pathname=b.pathname==="/"?e:ea([e,b.pathname])),(y.replace?t.replace:t.push)(b,y.state,y)},[e,t,u,l,s])}_.createContext(null);function gj(){let{matches:s}=_.useContext(hi),e=s[s.length-1];return e?e.params:{}}function Su(s,{relative:e}={}){let{matches:t}=_.useContext(hi),{pathname:i}=Ii(),l=JSON.stringify(Kg(t));return _.useMemo(()=>Yg(s,JSON.parse(l),i,e==="path"),[s,l,i,e])}function yj(s,e){return w_(s,e)}function w_(s,e,t,i,l){Gn(Xl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=_.useContext(Nr),{matches:h}=_.useContext(hi),p=h[h.length-1],g=p?p.params:{},y=p?p.pathname:"/",b=p?p.pathnameBase:"/",k=p&&p.route;{let $=k&&k.path||"";x_(y,!k||$.endsWith("*")||$.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${y}" (under <Route path="${$}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${$}"> to <Route path="${$==="/"?"*":`${$}/*`}">.`)}let E=Ii(),O;if(e){let $=typeof e=="string"?Yl(e):e;Gn(b==="/"||$.pathname?.startsWith(b),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${b}" but pathname "${$.pathname}" was given in the \`location\` prop.`),O=$}else O=E;let H=O.pathname||"/",q=H;if(b!=="/"){let $=b.replace(/^\//,"").split("/");q="/"+H.replace(/^\//,"").split("/").slice($.length).join("/")}let B=u_(s,{pathname:q});Yr(k||B!=null,`No routes matched location "${O.pathname}${O.search}${O.hash}" `),Yr(B==null||B[B.length-1].route.element!==void 0||B[B.length-1].route.Component!==void 0||B[B.length-1].route.lazy!==void 0,`Matched leaf route at location "${O.pathname}${O.search}${O.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let K=xj(B&&B.map($=>Object.assign({},$,{params:Object.assign({},g,$.params),pathname:ea([b,u.encodeLocation?u.encodeLocation($.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:$.pathname]),pathnameBase:$.pathnameBase==="/"?b:ea([b,u.encodeLocation?u.encodeLocation($.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:$.pathnameBase])})),h,t,i,l);return e&&K?_.createElement(Tu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...O},navigationType:"POP"}},K):K}function vj(){let s=jj(),e=rj(s)?`${s.status} ${s.statusText}`:s instanceof Error?s.message:JSON.stringify(s),t=s instanceof Error?s.stack:null,i="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:i},u={padding:"2px 4px",backgroundColor:i},h=null;return console.error("Error handled by React Router default ErrorBoundary:",s),h=_.createElement(_.Fragment,null,_.createElement("p",null," Hey developer "),_.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",_.createElement("code",{style:u},"ErrorBoundary")," or"," ",_.createElement("code",{style:u},"errorElement")," prop on your route.")),_.createElement(_.Fragment,null,_.createElement("h2",null,"Unexpected Application Error!"),_.createElement("h3",{style:{fontStyle:"italic"}},e),t?_.createElement("pre",{style:l},t):null,h)}var bj=_.createElement(vj,null),__=class extends _.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,e){return e.location!==s.location||e.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:e.error,location:e.location,revalidation:s.revalidation||e.revalidation}}componentDidCatch(s,e){this.props.onError?this.props.onError(s,e):console.error("React Router caught the following error during render",s)}render(){let s=this.state.error;if(this.context&&typeof s=="object"&&s&&"digest"in s&&typeof s.digest=="string"){const t=fj(s.digest);t&&(s=t)}let e=s!==void 0?_.createElement(hi.Provider,{value:this.props.routeContext},_.createElement(Qg.Provider,{value:s,children:this.props.component})):this.props.children;return this.context?_.createElement(wj,{error:s},e):e}};__.contextType=oj;var Np=new WeakMap;function wj({children:s,error:e}){let{basename:t}=_.useContext(Nr);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=dj(e.digest);if(i){let l=Np.get(e);if(l)throw l;let u=m_(i.location,t);if(f_&&!Np.get(e))if(u.isExternal||i.reloadDocument)window.location.href=u.absoluteURL||u.to;else{const h=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(u.to,{replace:i.replace}));throw Np.set(e,h),h}return _.createElement("meta",{httpEquiv:"refresh",content:`0;url=${u.absoluteURL||u.to}`})}}return s}function _j({routeContext:s,match:e,children:t}){let i=_.useContext(Ql);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),_.createElement(hi.Provider,{value:s},t)}function xj(s,e=[],t=null,i=null,l=null){if(s==null){if(!t)return null;if(t.errors)s=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)s=t.matches;else return null}let u=s,h=t?.errors;if(h!=null){let b=u.findIndex(k=>k.route.id&&h?.[k.route.id]!==void 0);Gn(b>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(h).join(",")}`),u=u.slice(0,Math.min(u.length,b+1))}let p=!1,g=-1;if(t)for(let b=0;b<u.length;b++){let k=u[b];if((k.route.HydrateFallback||k.route.hydrateFallbackElement)&&(g=b),k.route.id){let{loaderData:E,errors:O}=t,H=k.route.loader&&!E.hasOwnProperty(k.route.id)&&(!O||O[k.route.id]===void 0);if(k.route.lazy||H){p=!0,g>=0?u=u.slice(0,g+1):u=[u[0]];break}}}let y=t&&i?(b,k)=>{i(b,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:ij(t.matches),errorInfo:k})}:void 0;return u.reduceRight((b,k,E)=>{let O,H=!1,q=null,B=null;t&&(O=h&&k.route.id?h[k.route.id]:void 0,q=k.route.errorElement||bj,p&&(g<0&&E===0?(x_("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),H=!0,B=null):g===E&&(H=!0,B=k.route.hydrateFallbackElement||null)));let K=e.concat(u.slice(0,E+1)),$=()=>{let G;return O?G=q:H?G=B:k.route.Component?G=_.createElement(k.route.Component,null):k.route.element?G=k.route.element:G=b,_.createElement(_j,{match:k,routeContext:{outlet:b,matches:K,isDataRoute:t!=null},children:G})};return t&&(k.route.ErrorBoundary||k.route.errorElement||E===0)?_.createElement(__,{location:t.location,revalidation:t.revalidation,component:q,error:O,children:$(),routeContext:{outlet:null,matches:K,isDataRoute:!0},onError:y}):$()},null)}function Xg(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function kj(s){let e=_.useContext(Ql);return Gn(e,Xg(s)),e}function Ej(s){let e=_.useContext(Jd);return Gn(e,Xg(s)),e}function Tj(s){let e=_.useContext(hi);return Gn(e,Xg(s)),e}function Jg(s){let e=Tj(s),t=e.matches[e.matches.length-1];return Gn(t.route.id,`${s} can only be used on routes that contain a unique "id"`),t.route.id}function Sj(){return Jg("useRouteId")}function jj(){let s=_.useContext(Qg),e=Ej("useRouteError"),t=Jg("useRouteError");return s!==void 0?s:e.errors?.[t]}function Cj(){let{router:s}=kj("useNavigate"),e=Jg("useNavigate"),t=_.useRef(!1);return b_(()=>{t.current=!0}),_.useCallback(async(l,u={})=>{Yr(t.current,v_),t.current&&(typeof l=="number"?await s.navigate(l):await s.navigate(l,{fromRouteId:e,...u}))},[s,e])}var e2={};function x_(s,e,t){!e&&!e2[s]&&(e2[s]=!0,Yr(!1,t))}_.memo(Nj);function Nj({routes:s,future:e,state:t,onError:i}){return w_(s,void 0,t,i,e)}function k_({to:s,replace:e,state:t,relative:i}){Gn(Xl(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=_.useContext(Nr);Yr(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=_.useContext(hi),{pathname:h}=Ii(),p=ir(),g=Yg(s,Kg(u),h,i==="path"),y=JSON.stringify(g);return _.useEffect(()=>{p(JSON.parse(y),{replace:e,state:t,relative:i})},[p,y,i,e,t]),null}function Cn(s){Gn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Aj({basename:s="/",children:e=null,location:t,navigationType:i="POP",navigator:l,static:u=!1,unstable_useTransitions:h}){Gn(!Xl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let p=s.replace(/^\/*/,"/"),g=_.useMemo(()=>({basename:p,navigator:l,static:u,unstable_useTransitions:h,future:{}}),[p,l,u,h]);typeof t=="string"&&(t=Yl(t));let{pathname:y="/",search:b="",hash:k="",state:E=null,key:O="default"}=t,H=_.useMemo(()=>{let q=ra(y,p);return q==null?null:{location:{pathname:q,search:b,hash:k,state:E,key:O},navigationType:i}},[p,y,b,k,E,O,i]);return Yr(H!=null,`<Router basename="${p}"> is not able to match the URL "${y}${b}${k}" because it does not start with the basename, so the <Router> won't render anything.`),H==null?null:_.createElement(Nr.Provider,{value:g},_.createElement(Tu.Provider,{children:e,value:H}))}function Rj({children:s,location:e}){return yj(fg(s),e)}function fg(s,e=[]){let t=[];return _.Children.forEach(s,(i,l)=>{if(!_.isValidElement(i))return;let u=[...e,l];if(i.type===_.Fragment){t.push.apply(t,fg(i.props.children,u));return}Gn(i.type===Cn,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Gn(!i.props.index||!i.props.children,"An index route cannot have child routes.");let h={id:i.props.id||u.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(h.children=fg(i.props.children,u)),t.push(h)}),t}var yd="get",vd="application/x-www-form-urlencoded";function Zd(s){return typeof HTMLElement<"u"&&s instanceof HTMLElement}function Ij(s){return Zd(s)&&s.tagName.toLowerCase()==="button"}function Dj(s){return Zd(s)&&s.tagName.toLowerCase()==="form"}function Mj(s){return Zd(s)&&s.tagName.toLowerCase()==="input"}function Lj(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function Oj(s,e){return s.button===0&&(!e||e==="_self")&&!Lj(s)}function mg(s=""){return new URLSearchParams(typeof s=="string"||Array.isArray(s)||s instanceof URLSearchParams?s:Object.keys(s).reduce((e,t)=>{let i=s[t];return e.concat(Array.isArray(i)?i.map(l=>[t,l]):[[t,i]])},[]))}function Pj(s,e){let t=mg(s);return e&&e.forEach((i,l)=>{t.has(l)||e.getAll(l).forEach(u=>{t.append(l,u)})}),t}var nd=null;function Vj(){if(nd===null)try{new FormData(document.createElement("form"),0),nd=!1}catch{nd=!0}return nd}var Uj=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Ap(s){return s!=null&&!Uj.has(s)?(Yr(!1,`"${s}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${vd}"`),null):s}function Bj(s,e){let t,i,l,u,h;if(Dj(s)){let p=s.getAttribute("action");i=p?ra(p,e):null,t=s.getAttribute("method")||yd,l=Ap(s.getAttribute("enctype"))||vd,u=new FormData(s)}else if(Ij(s)||Mj(s)&&(s.type==="submit"||s.type==="image")){let p=s.form;if(p==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let g=s.getAttribute("formaction")||p.getAttribute("action");if(i=g?ra(g,e):null,t=s.getAttribute("formmethod")||p.getAttribute("method")||yd,l=Ap(s.getAttribute("formenctype"))||Ap(p.getAttribute("enctype"))||vd,u=new FormData(p,s),!Vj()){let{name:y,type:b,value:k}=s;if(b==="image"){let E=y?`${y}.`:"";u.append(`${E}x`,"0"),u.append(`${E}y`,"0")}else y&&u.append(y,k)}}else{if(Zd(s))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=yd,i=null,l=vd,h=s}return u&&l==="text/plain"&&(h=u,u=void 0),{action:i,method:t.toLowerCase(),encType:l,formData:u,body:h}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Zg(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function zj(s,e,t,i){let l=typeof s=="string"?new URL(s,typeof window>"u"?"server://singlefetch/":window.location.origin):s;return t?l.pathname.endsWith("/")?l.pathname=`${l.pathname}_.${i}`:l.pathname=`${l.pathname}.${i}`:l.pathname==="/"?l.pathname=`_root.${i}`:e&&ra(l.pathname,e)==="/"?l.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:l.pathname=`${l.pathname.replace(/\/$/,"")}.${i}`,l}async function Fj(s,e){if(s.id in e)return e[s.id];try{let t=await import(s.module);return e[s.id]=t,t}catch(t){return console.error(`Error loading route module \`${s.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function qj(s){return s==null?!1:s.href==null?s.rel==="preload"&&typeof s.imageSrcSet=="string"&&typeof s.imageSizes=="string":typeof s.rel=="string"&&typeof s.href=="string"}async function Hj(s,e,t){let i=await Promise.all(s.map(async l=>{let u=e.routes[l.route.id];if(u){let h=await Fj(u,t);return h.links?h.links():[]}return[]}));return Kj(i.flat(1).filter(qj).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function t2(s,e,t,i,l,u){let h=(g,y)=>t[y]?g.route.id!==t[y].route.id:!0,p=(g,y)=>t[y].pathname!==g.pathname||t[y].route.path?.endsWith("*")&&t[y].params["*"]!==g.params["*"];return u==="assets"?e.filter((g,y)=>h(g,y)||p(g,y)):u==="data"?e.filter((g,y)=>{let b=i.routes[g.route.id];if(!b||!b.hasLoader)return!1;if(h(g,y)||p(g,y))return!0;if(g.route.shouldRevalidate){let k=g.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(s,window.origin),nextParams:g.params,defaultShouldRevalidate:!0});if(typeof k=="boolean")return k}return!0}):[]}function $j(s,e,{includeHydrateFallback:t}={}){return Wj(s.map(i=>{let l=e.routes[i.route.id];if(!l)return[];let u=[l.module];return l.clientActionModule&&(u=u.concat(l.clientActionModule)),l.clientLoaderModule&&(u=u.concat(l.clientLoaderModule)),t&&l.hydrateFallbackModule&&(u=u.concat(l.hydrateFallbackModule)),l.imports&&(u=u.concat(l.imports)),u}).flat(1))}function Wj(s){return[...new Set(s)]}function Gj(s){let e={},t=Object.keys(s).sort();for(let i of t)e[i]=s[i];return e}function Kj(s,e){let t=new Set;return new Set(e),s.reduce((i,l)=>{let u=JSON.stringify(Gj(l));return t.has(u)||(t.add(u),i.push({key:u,link:l})),i},[])}function E_(){let s=_.useContext(Ql);return Zg(s,"You must render this element inside a <DataRouterContext.Provider> element"),s}function Yj(){let s=_.useContext(Jd);return Zg(s,"You must render this element inside a <DataRouterStateContext.Provider> element"),s}var ey=_.createContext(void 0);ey.displayName="FrameworkContext";function T_(){let s=_.useContext(ey);return Zg(s,"You must render this element inside a <HydratedRouter> element"),s}function Qj(s,e){let t=_.useContext(ey),[i,l]=_.useState(!1),[u,h]=_.useState(!1),{onFocus:p,onBlur:g,onMouseEnter:y,onMouseLeave:b,onTouchStart:k}=e,E=_.useRef(null);_.useEffect(()=>{if(s==="render"&&h(!0),s==="viewport"){let q=K=>{K.forEach($=>{h($.isIntersecting)})},B=new IntersectionObserver(q,{threshold:.5});return E.current&&B.observe(E.current),()=>{B.disconnect()}}},[s]),_.useEffect(()=>{if(i){let q=setTimeout(()=>{h(!0)},100);return()=>{clearTimeout(q)}}},[i]);let O=()=>{l(!0)},H=()=>{l(!1),h(!1)};return t?s!=="intent"?[u,E,{}]:[u,E,{onFocus:$c(p,O),onBlur:$c(g,H),onMouseEnter:$c(y,O),onMouseLeave:$c(b,H),onTouchStart:$c(k,O)}]:[!1,E,{}]}function $c(s,e){return t=>{s&&s(t),t.defaultPrevented||e(t)}}function Xj({page:s,...e}){let{router:t}=E_(),i=_.useMemo(()=>u_(t.routes,s,t.basename),[t.routes,s,t.basename]);return i?_.createElement(Zj,{page:s,matches:i,...e}):null}function Jj(s){let{manifest:e,routeModules:t}=T_(),[i,l]=_.useState([]);return _.useEffect(()=>{let u=!1;return Hj(s,e,t).then(h=>{u||l(h)}),()=>{u=!0}},[s,e,t]),i}function Zj({page:s,matches:e,...t}){let i=Ii(),{future:l,manifest:u,routeModules:h}=T_(),{basename:p}=E_(),{loaderData:g,matches:y}=Yj(),b=_.useMemo(()=>t2(s,e,y,u,i,"data"),[s,e,y,u,i]),k=_.useMemo(()=>t2(s,e,y,u,i,"assets"),[s,e,y,u,i]),E=_.useMemo(()=>{if(s===i.pathname+i.search+i.hash)return[];let q=new Set,B=!1;if(e.forEach($=>{let G=u.routes[$.route.id];!G||!G.hasLoader||(!b.some(fe=>fe.route.id===$.route.id)&&$.route.id in g&&h[$.route.id]?.shouldRevalidate||G.hasClientLoader?B=!0:q.add($.route.id))}),q.size===0)return[];let K=zj(s,p,l.unstable_trailingSlashAwareDataRequests,"data");return B&&q.size>0&&K.searchParams.set("_routes",e.filter($=>q.has($.route.id)).map($=>$.route.id).join(",")),[K.pathname+K.search]},[p,l.unstable_trailingSlashAwareDataRequests,g,i,u,b,e,s,h]),O=_.useMemo(()=>$j(k,u),[k,u]),H=Jj(k);return _.createElement(_.Fragment,null,E.map(q=>_.createElement("link",{key:q,rel:"prefetch",as:"fetch",href:q,...t})),O.map(q=>_.createElement("link",{key:q,rel:"modulepreload",href:q,...t})),H.map(({key:q,link:B})=>_.createElement("link",{key:q,nonce:t.nonce,...B,crossOrigin:B.crossOrigin??t.crossOrigin})))}function eC(...s){return e=>{s.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var tC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{tC&&(window.__reactRouterVersion="7.13.0")}catch{}function nC({basename:s,children:e,unstable_useTransitions:t,window:i}){let l=_.useRef();l.current==null&&(l.current=MS({window:i,v5Compat:!0}));let u=l.current,[h,p]=_.useState({action:u.action,location:u.location}),g=_.useCallback(y=>{t===!1?p(y):_.startTransition(()=>p(y))},[t]);return _.useLayoutEffect(()=>u.listen(g),[u,g]),_.createElement(Aj,{basename:s,children:e,location:h.location,navigationType:h.action,navigator:u,unstable_useTransitions:t})}var S_=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,j_=_.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:l,reloadDocument:u,replace:h,state:p,target:g,to:y,preventScrollReset:b,viewTransition:k,unstable_defaultShouldRevalidate:E,...O},H){let{basename:q,unstable_useTransitions:B}=_.useContext(Nr),K=typeof y=="string"&&S_.test(y),$=m_(y,q);y=$.to;let G=mj(y,{relative:l}),[fe,xe,be]=Qj(i,O),j=aC(y,{replace:h,state:p,target:g,preventScrollReset:b,relative:l,viewTransition:k,unstable_defaultShouldRevalidate:E,unstable_useTransitions:B});function T(P){e&&e(P),P.defaultPrevented||j(P)}let R=_.createElement("a",{...O,...be,href:$.absoluteURL||G,onClick:$.isExternal||u?e:T,ref:eC(H,xe),target:g,"data-discover":!K&&t==="render"?"true":void 0});return fe&&!K?_.createElement(_.Fragment,null,R,_.createElement(Xj,{page:G})):R});j_.displayName="Link";var sC=_.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:l=!1,style:u,to:h,viewTransition:p,children:g,...y},b){let k=Su(h,{relative:y.relative}),E=Ii(),O=_.useContext(Jd),{navigator:H,basename:q}=_.useContext(Nr),B=O!=null&&hC(k)&&p===!0,K=H.encodeLocation?H.encodeLocation(k).pathname:k.pathname,$=E.pathname,G=O&&O.navigation&&O.navigation.location?O.navigation.location.pathname:null;t||($=$.toLowerCase(),G=G?G.toLowerCase():null,K=K.toLowerCase()),G&&q&&(G=ra(G,q)||G);const fe=K!=="/"&&K.endsWith("/")?K.length-1:K.length;let xe=$===K||!l&&$.startsWith(K)&&$.charAt(fe)==="/",be=G!=null&&(G===K||!l&&G.startsWith(K)&&G.charAt(K.length)==="/"),j={isActive:xe,isPending:be,isTransitioning:B},T=xe?e:void 0,R;typeof i=="function"?R=i(j):R=[i,xe?"active":null,be?"pending":null,B?"transitioning":null].filter(Boolean).join(" ");let P=typeof u=="function"?u(j):u;return _.createElement(j_,{...y,"aria-current":T,className:R,ref:b,style:P,to:h,viewTransition:p},typeof g=="function"?g(j):g)});sC.displayName="NavLink";var rC=_.forwardRef(({discover:s="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:l,state:u,method:h=yd,action:p,onSubmit:g,relative:y,preventScrollReset:b,viewTransition:k,unstable_defaultShouldRevalidate:E,...O},H)=>{let{unstable_useTransitions:q}=_.useContext(Nr),B=cC(),K=uC(p,{relative:y}),$=h.toLowerCase()==="get"?"get":"post",G=typeof p=="string"&&S_.test(p),fe=xe=>{if(g&&g(xe),xe.defaultPrevented)return;xe.preventDefault();let be=xe.nativeEvent.submitter,j=be?.getAttribute("formmethod")||h,T=()=>B(be||xe.currentTarget,{fetcherKey:e,method:j,navigate:t,replace:l,state:u,relative:y,preventScrollReset:b,viewTransition:k,unstable_defaultShouldRevalidate:E});q&&t!==!1?_.startTransition(()=>T()):T()};return _.createElement("form",{ref:H,method:$,action:K,onSubmit:i?g:fe,...O,"data-discover":!G&&s==="render"?"true":void 0})});rC.displayName="Form";function iC(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function C_(s){let e=_.useContext(Ql);return Gn(e,iC(s)),e}function aC(s,{target:e,replace:t,state:i,preventScrollReset:l,relative:u,viewTransition:h,unstable_defaultShouldRevalidate:p,unstable_useTransitions:g}={}){let y=ir(),b=Ii(),k=Su(s,{relative:u});return _.useCallback(E=>{if(Oj(E,e)){E.preventDefault();let O=t!==void 0?t:uu(b)===uu(k),H=()=>y(s,{replace:O,state:i,preventScrollReset:l,relative:u,viewTransition:h,unstable_defaultShouldRevalidate:p});g?_.startTransition(()=>H()):H()}},[b,y,k,t,i,e,s,l,u,h,p,g])}function iO(s){Yr(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=_.useRef(mg(s)),t=_.useRef(!1),i=Ii(),l=_.useMemo(()=>Pj(i.search,t.current?null:e.current),[i.search]),u=ir(),h=_.useCallback((p,g)=>{const y=mg(typeof p=="function"?p(new URLSearchParams(l)):p);t.current=!0,u("?"+y,g)},[u,l]);return[l,h]}var oC=0,lC=()=>`__${String(++oC)}__`;function cC(){let{router:s}=C_("useSubmit"),{basename:e}=_.useContext(Nr),t=Sj(),i=s.fetch,l=s.navigate;return _.useCallback(async(u,h={})=>{let{action:p,method:g,encType:y,formData:b,body:k}=Bj(u,e);if(h.navigate===!1){let E=h.fetcherKey||lC();await i(E,t,h.action||p,{unstable_defaultShouldRevalidate:h.unstable_defaultShouldRevalidate,preventScrollReset:h.preventScrollReset,formData:b,body:k,formMethod:h.method||g,formEncType:h.encType||y,flushSync:h.flushSync})}else await l(h.action||p,{unstable_defaultShouldRevalidate:h.unstable_defaultShouldRevalidate,preventScrollReset:h.preventScrollReset,formData:b,body:k,formMethod:h.method||g,formEncType:h.encType||y,replace:h.replace,state:h.state,fromRouteId:t,flushSync:h.flushSync,viewTransition:h.viewTransition})},[i,l,e,t])}function uC(s,{relative:e}={}){let{basename:t}=_.useContext(Nr),i=_.useContext(hi);Gn(i,"useFormAction must be used inside a RouteContext");let[l]=i.matches.slice(-1),u={...Su(s||".",{relative:e})},h=Ii();if(s==null){u.search=h.search;let p=new URLSearchParams(u.search),g=p.getAll("index");if(g.some(b=>b==="")){p.delete("index"),g.filter(k=>k).forEach(k=>p.append("index",k));let b=p.toString();u.search=b?`?${b}`:""}}return(!s||s===".")&&l.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(u.pathname=u.pathname==="/"?t:ea([t,u.pathname])),uu(u)}function hC(s,{relative:e}={}){let t=_.useContext(g_);Gn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=C_("useViewTransitionState"),l=Su(s,{relative:e});if(!t.isTransitioning)return!1;let u=ra(t.currentLocation.pathname,i)||t.currentLocation.pathname,h=ra(t.nextLocation.pathname,i)||t.nextLocation.pathname;return Ad(l.pathname,h)!=null||Ad(l.pathname,u)!=null}const dC=()=>{};var n2={};const N_=function(s){const e=[];let t=0;for(let i=0;i<s.length;i++){let l=s.charCodeAt(i);l<128?e[t++]=l:l<2048?(e[t++]=l>>6|192,e[t++]=l&63|128):(l&64512)===55296&&i+1<s.length&&(s.charCodeAt(i+1)&64512)===56320?(l=65536+((l&1023)<<10)+(s.charCodeAt(++i)&1023),e[t++]=l>>18|240,e[t++]=l>>12&63|128,e[t++]=l>>6&63|128,e[t++]=l&63|128):(e[t++]=l>>12|224,e[t++]=l>>6&63|128,e[t++]=l&63|128)}return e},fC=function(s){const e=[];let t=0,i=0;for(;t<s.length;){const l=s[t++];if(l<128)e[i++]=String.fromCharCode(l);else if(l>191&&l<224){const u=s[t++];e[i++]=String.fromCharCode((l&31)<<6|u&63)}else if(l>239&&l<365){const u=s[t++],h=s[t++],p=s[t++],g=((l&7)<<18|(u&63)<<12|(h&63)<<6|p&63)-65536;e[i++]=String.fromCharCode(55296+(g>>10)),e[i++]=String.fromCharCode(56320+(g&1023))}else{const u=s[t++],h=s[t++];e[i++]=String.fromCharCode((l&15)<<12|(u&63)<<6|h&63)}}return e.join("")},A_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let l=0;l<s.length;l+=3){const u=s[l],h=l+1<s.length,p=h?s[l+1]:0,g=l+2<s.length,y=g?s[l+2]:0,b=u>>2,k=(u&3)<<4|p>>4;let E=(p&15)<<2|y>>6,O=y&63;g||(O=64,h||(E=64)),i.push(t[b],t[k],t[E],t[O])}return i.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(N_(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):fC(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let l=0;l<s.length;){const u=t[s.charAt(l++)],p=l<s.length?t[s.charAt(l)]:0;++l;const y=l<s.length?t[s.charAt(l)]:64;++l;const k=l<s.length?t[s.charAt(l)]:64;if(++l,u==null||p==null||y==null||k==null)throw new mC;const E=u<<2|p>>4;if(i.push(E),y!==64){const O=p<<4&240|y>>2;if(i.push(O),k!==64){const H=y<<6&192|k;i.push(H)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class mC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const pC=function(s){const e=N_(s);return A_.encodeByteArray(e,!0)},Rd=function(s){return pC(s).replace(/\./g,"")},R_=function(s){try{return A_.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function gC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const yC=()=>gC().__FIREBASE_DEFAULTS__,vC=()=>{if(typeof process>"u"||typeof n2>"u")return;const s=n2.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},bC=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&R_(s[1]);return e&&JSON.parse(e)},ef=()=>{try{return dC()||yC()||vC()||bC()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},I_=s=>ef()?.emulatorHosts?.[s],D_=s=>{const e=I_(s);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},M_=()=>ef()?.config,L_=s=>ef()?.[`_${s}`];class wC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function so(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function ty(s){return(await fetch(s,{credentials:"include"})).ok}function O_(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",l=s.iat||0,u=s.sub||s.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const h={iss:`https://securetoken.google.com/${i}`,aud:i,iat:l,exp:l+3600,auth_time:l,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...s};return[Rd(JSON.stringify(t)),Rd(JSON.stringify(h)),""].join(".")}const su={};function _C(){const s={prod:[],emulator:[]};for(const e of Object.keys(su))su[e]?s.emulator.push(e):s.prod.push(e);return s}function xC(s){let e=document.getElementById(s),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),t=!0),{created:t,element:e}}let s2=!1;function ny(s,e){if(typeof window>"u"||typeof document>"u"||!so(window.location.host)||su[s]===e||su[s]||s2)return;su[s]=e;function t(E){return`__firebase__banner__${E}`}const i="__firebase__banner",u=_C().prod.length>0;function h(){const E=document.getElementById(i);E&&E.remove()}function p(E){E.style.display="flex",E.style.background="#7faaf0",E.style.position="fixed",E.style.bottom="5px",E.style.left="5px",E.style.padding=".5em",E.style.borderRadius="5px",E.style.alignItems="center"}function g(E,O){E.setAttribute("width","24"),E.setAttribute("id",O),E.setAttribute("height","24"),E.setAttribute("viewBox","0 0 24 24"),E.setAttribute("fill","none"),E.style.marginLeft="-6px"}function y(){const E=document.createElement("span");return E.style.cursor="pointer",E.style.marginLeft="16px",E.style.fontSize="24px",E.innerHTML=" &times;",E.onclick=()=>{s2=!0,h()},E}function b(E,O){E.setAttribute("id",O),E.innerText="Learn more",E.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",E.setAttribute("target","__blank"),E.style.paddingLeft="5px",E.style.textDecoration="underline"}function k(){const E=xC(i),O=t("text"),H=document.getElementById(O)||document.createElement("span"),q=t("learnmore"),B=document.getElementById(q)||document.createElement("a"),K=t("preprendIcon"),$=document.getElementById(K)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(E.created){const G=E.element;p(G),b(B,q);const fe=y();g($,K),G.append($,H,B,fe),document.body.appendChild(G)}u?(H.innerText="Preview backend disconnected.",$.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):($.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,H.innerText="Preview backend running in this workspace."),H.setAttribute("id",O)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",k):k()}function Gs(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function kC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Gs())}function EC(){const s=ef()?.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function TC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function SC(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function jC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function CC(){const s=Gs();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function NC(){return!EC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function P_(){try{return typeof indexedDB=="object"}catch{return!1}}function V_(){return new Promise((s,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",l=self.indexedDB.open(i);l.onsuccess=()=>{l.result.close(),t||self.indexedDB.deleteDatabase(i),s(!0)},l.onupgradeneeded=()=>{t=!1},l.onerror=()=>{e(l.error?.message||"")}}catch(t){e(t)}})}function AC(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}const RC="FirebaseError";class di extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=RC,Object.setPrototypeOf(this,di.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ho.prototype.create)}}class Ho{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},l=`${this.service}/${e}`,u=this.errors[e],h=u?IC(u,i):"Error",p=`${this.serviceName}: ${h} (${l}).`;return new di(l,p,i)}}function IC(s,e){return s.replace(DC,(t,i)=>{const l=e[i];return l!=null?String(l):`<${i}?>`})}const DC=/\{\$([^}]+)}/g;function MC(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function ia(s,e){if(s===e)return!0;const t=Object.keys(s),i=Object.keys(e);for(const l of t){if(!i.includes(l))return!1;const u=s[l],h=e[l];if(r2(u)&&r2(h)){if(!ia(u,h))return!1}else if(u!==h)return!1}for(const l of i)if(!t.includes(l))return!1;return!0}function r2(s){return s!==null&&typeof s=="object"}function ju(s){const e=[];for(const[t,i]of Object.entries(s))Array.isArray(i)?i.forEach(l=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(l))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Xc(s){const e={};return s.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[l,u]=i.split("=");e[decodeURIComponent(l)]=decodeURIComponent(u)}}),e}function Jc(s){const e=s.indexOf("?");if(!e)return"";const t=s.indexOf("#",e);return s.substring(e,t>0?t:void 0)}function LC(s,e){const t=new OC(s,e);return t.subscribe.bind(t)}class OC{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let l;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");PC(e,["next","error","complete"])?l=e:l={next:e,error:t,complete:i},l.next===void 0&&(l.next=Rp),l.error===void 0&&(l.error=Rp),l.complete===void 0&&(l.complete=Rp);const u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?l.error(this.finalError):l.complete()}catch{}}),this.observers.push(l),u}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function PC(s,e){if(typeof s!="object"||s===null)return!1;for(const t of e)if(t in s&&typeof s[t]=="function")return!0;return!1}function Rp(){}function yn(s){return s&&s._delegate?s._delegate:s}class Qr{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Co="[DEFAULT]";class VC{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new wC;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const l=this.getOrInitializeService({instanceIdentifier:t});l&&i.resolve(l)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(l){if(i)return null;throw l}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(BC(e))try{this.getOrInitializeService({instanceIdentifier:Co})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(t);try{const u=this.getOrInitializeService({instanceIdentifier:l});i.resolve(u)}catch{}}}}clearInstance(e=Co){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Co){return this.instances.has(e)}getOptions(e=Co){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const l=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[u,h]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(u);i===p&&h.resolve(l)}return l}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),l=this.onInitCallbacks.get(i)??new Set;l.add(e),this.onInitCallbacks.set(i,l);const u=this.instances.get(i);return u&&e(u,i),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const l of i)try{l(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:UC(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Co){return this.component?this.component.multipleInstances?e:Co:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function UC(s){return s===Co?void 0:s}function BC(s){return s.instantiationMode==="EAGER"}class zC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new VC(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Gt;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(Gt||(Gt={}));const FC={debug:Gt.DEBUG,verbose:Gt.VERBOSE,info:Gt.INFO,warn:Gt.WARN,error:Gt.ERROR,silent:Gt.SILENT},qC=Gt.INFO,HC={[Gt.DEBUG]:"log",[Gt.VERBOSE]:"log",[Gt.INFO]:"info",[Gt.WARN]:"warn",[Gt.ERROR]:"error"},$C=(s,e,...t)=>{if(e<s.logLevel)return;const i=new Date().toISOString(),l=HC[e];if(l)console[l](`[${i}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class sy{constructor(e){this.name=e,this._logLevel=qC,this._logHandler=$C,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Gt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?FC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Gt.DEBUG,...e),this._logHandler(this,Gt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Gt.VERBOSE,...e),this._logHandler(this,Gt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Gt.INFO,...e),this._logHandler(this,Gt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Gt.WARN,...e),this._logHandler(this,Gt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Gt.ERROR,...e),this._logHandler(this,Gt.ERROR,...e)}}const WC=(s,e)=>e.some(t=>s instanceof t);let i2,a2;function GC(){return i2||(i2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function KC(){return a2||(a2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const U_=new WeakMap,pg=new WeakMap,B_=new WeakMap,Ip=new WeakMap,ry=new WeakMap;function YC(s){const e=new Promise((t,i)=>{const l=()=>{s.removeEventListener("success",u),s.removeEventListener("error",h)},u=()=>{t(ta(s.result)),l()},h=()=>{i(s.error),l()};s.addEventListener("success",u),s.addEventListener("error",h)});return e.then(t=>{t instanceof IDBCursor&&U_.set(t,s)}).catch(()=>{}),ry.set(e,s),e}function QC(s){if(pg.has(s))return;const e=new Promise((t,i)=>{const l=()=>{s.removeEventListener("complete",u),s.removeEventListener("error",h),s.removeEventListener("abort",h)},u=()=>{t(),l()},h=()=>{i(s.error||new DOMException("AbortError","AbortError")),l()};s.addEventListener("complete",u),s.addEventListener("error",h),s.addEventListener("abort",h)});pg.set(s,e)}let gg={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return pg.get(s);if(e==="objectStoreNames")return s.objectStoreNames||B_.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ta(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function XC(s){gg=s(gg)}function JC(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=s.call(Dp(this),e,...t);return B_.set(i,e.sort?e.sort():[e]),ta(i)}:KC().includes(s)?function(...e){return s.apply(Dp(this),e),ta(U_.get(this))}:function(...e){return ta(s.apply(Dp(this),e))}}function ZC(s){return typeof s=="function"?JC(s):(s instanceof IDBTransaction&&QC(s),WC(s,GC())?new Proxy(s,gg):s)}function ta(s){if(s instanceof IDBRequest)return YC(s);if(Ip.has(s))return Ip.get(s);const e=ZC(s);return e!==s&&(Ip.set(s,e),ry.set(e,s)),e}const Dp=s=>ry.get(s);function tf(s,e,{blocked:t,upgrade:i,blocking:l,terminated:u}={}){const h=indexedDB.open(s,e),p=ta(h);return i&&h.addEventListener("upgradeneeded",g=>{i(ta(h.result),g.oldVersion,g.newVersion,ta(h.transaction),g)}),t&&h.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),p.then(g=>{u&&g.addEventListener("close",()=>u()),l&&g.addEventListener("versionchange",y=>l(y.oldVersion,y.newVersion,y))}).catch(()=>{}),p}function Mp(s,{blocked:e}={}){const t=indexedDB.deleteDatabase(s);return e&&t.addEventListener("blocked",i=>e(i.oldVersion,i)),ta(t).then(()=>{})}const eN=["get","getKey","getAll","getAllKeys","count"],tN=["put","add","delete","clear"],Lp=new Map;function o2(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(Lp.get(e))return Lp.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,l=tN.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(l||eN.includes(t)))return;const u=async function(h,...p){const g=this.transaction(h,l?"readwrite":"readonly");let y=g.store;return i&&(y=y.index(p.shift())),(await Promise.all([y[t](...p),l&&g.done]))[0]};return Lp.set(e,u),u}XC(s=>({...s,get:(e,t,i)=>o2(e,t)||s.get(e,t,i),has:(e,t)=>!!o2(e,t)||s.has(e,t)}));class nN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(sN(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function sN(s){return s.getComponent()?.type==="VERSION"}const yg="@firebase/app",l2="0.14.7";const aa=new sy("@firebase/app"),rN="@firebase/app-compat",iN="@firebase/analytics-compat",aN="@firebase/analytics",oN="@firebase/app-check-compat",lN="@firebase/app-check",cN="@firebase/auth",uN="@firebase/auth-compat",hN="@firebase/database",dN="@firebase/data-connect",fN="@firebase/database-compat",mN="@firebase/functions",pN="@firebase/functions-compat",gN="@firebase/installations",yN="@firebase/installations-compat",vN="@firebase/messaging",bN="@firebase/messaging-compat",wN="@firebase/performance",_N="@firebase/performance-compat",xN="@firebase/remote-config",kN="@firebase/remote-config-compat",EN="@firebase/storage",TN="@firebase/storage-compat",SN="@firebase/firestore",jN="@firebase/ai",CN="@firebase/firestore-compat",NN="firebase",AN="12.8.0";const vg="[DEFAULT]",RN={[yg]:"fire-core",[rN]:"fire-core-compat",[aN]:"fire-analytics",[iN]:"fire-analytics-compat",[lN]:"fire-app-check",[oN]:"fire-app-check-compat",[cN]:"fire-auth",[uN]:"fire-auth-compat",[hN]:"fire-rtdb",[dN]:"fire-data-connect",[fN]:"fire-rtdb-compat",[mN]:"fire-fn",[pN]:"fire-fn-compat",[gN]:"fire-iid",[yN]:"fire-iid-compat",[vN]:"fire-fcm",[bN]:"fire-fcm-compat",[wN]:"fire-perf",[_N]:"fire-perf-compat",[xN]:"fire-rc",[kN]:"fire-rc-compat",[EN]:"fire-gcs",[TN]:"fire-gcs-compat",[SN]:"fire-fst",[CN]:"fire-fst-compat",[jN]:"fire-vertex","fire-js":"fire-js",[NN]:"fire-js-all"};const Id=new Map,IN=new Map,bg=new Map;function c2(s,e){try{s.container.addComponent(e)}catch(t){aa.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function oi(s){const e=s.name;if(bg.has(e))return aa.debug(`There were multiple attempts to register component ${e}.`),!1;bg.set(e,s);for(const t of Id.values())c2(t,s);for(const t of IN.values())c2(t,s);return!0}function $o(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function Sr(s){return s==null?!1:s.settings!==void 0}const DN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ka=new Ho("app","Firebase",DN);class MN{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Qr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ka.create("app-deleted",{appName:this._name})}}const Wo=AN;function iy(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const i={name:vg,automaticDataCollectionEnabled:!0,...e},l=i.name;if(typeof l!="string"||!l)throw Ka.create("bad-app-name",{appName:String(l)});if(t||(t=M_()),!t)throw Ka.create("no-options");const u=Id.get(l);if(u){if(ia(t,u.options)&&ia(i,u.config))return u;throw Ka.create("duplicate-app",{appName:l})}const h=new zC(l);for(const g of bg.values())h.addComponent(g);const p=new MN(t,i,h);return Id.set(l,p),p}function Cu(s=vg){const e=Id.get(s);if(!e&&s===vg&&M_())return iy();if(!e)throw Ka.create("no-app",{appName:s});return e}function gr(s,e,t){let i=RN[s]??s;t&&(i+=`-${t}`);const l=i.match(/\s|\//),u=e.match(/\s|\//);if(l||u){const h=[`Unable to register library "${i}" with version "${e}":`];l&&h.push(`library name "${i}" contains illegal characters (whitespace or "/")`),l&&u&&h.push("and"),u&&h.push(`version name "${e}" contains illegal characters (whitespace or "/")`),aa.warn(h.join(" "));return}oi(new Qr(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const LN="firebase-heartbeat-database",ON=1,hu="firebase-heartbeat-store";let Op=null;function z_(){return Op||(Op=tf(LN,ON,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(hu)}catch(t){console.warn(t)}}}}).catch(s=>{throw Ka.create("idb-open",{originalErrorMessage:s.message})})),Op}async function PN(s){try{const t=(await z_()).transaction(hu),i=await t.objectStore(hu).get(F_(s));return await t.done,i}catch(e){if(e instanceof di)aa.warn(e.message);else{const t=Ka.create("idb-get",{originalErrorMessage:e?.message});aa.warn(t.message)}}}async function u2(s,e){try{const i=(await z_()).transaction(hu,"readwrite");await i.objectStore(hu).put(e,F_(s)),await i.done}catch(t){if(t instanceof di)aa.warn(t.message);else{const i=Ka.create("idb-set",{originalErrorMessage:t?.message});aa.warn(i.message)}}}function F_(s){return`${s.name}!${s.options.appId}`}const VN=1024,UN=30;class BN{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new FN(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=h2();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(l=>l.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>UN){const l=qN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){aa.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=h2(),{heartbeatsToSend:t,unsentEntries:i}=zN(this._heartbeatsCache.heartbeats),l=Rd(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(e){return aa.warn(e),""}}}function h2(){return new Date().toISOString().substring(0,10)}function zN(s,e=VN){const t=[];let i=s.slice();for(const l of s){const u=t.find(h=>h.agent===l.agent);if(u){if(u.dates.push(l.date),d2(t)>e){u.dates.pop();break}}else if(t.push({agent:l.agent,dates:[l.date]}),d2(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class FN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return P_()?V_().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await PN(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return u2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return u2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function d2(s){return Rd(JSON.stringify({version:2,heartbeats:s})).length}function qN(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let i=1;i<s.length;i++)s[i].date<t&&(t=s[i].date,e=i);return e}function HN(s){oi(new Qr("platform-logger",e=>new nN(e),"PRIVATE")),oi(new Qr("heartbeat",e=>new BN(e),"PRIVATE")),gr(yg,l2,s),gr(yg,l2,"esm2020"),gr("fire-js","")}HN("");function q_(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const $N=q_,H_=new Ho("auth","Firebase",q_());const Dd=new sy("@firebase/auth");function WN(s,...e){Dd.logLevel<=Gt.WARN&&Dd.warn(`Auth (${Wo}): ${s}`,...e)}function bd(s,...e){Dd.logLevel<=Gt.ERROR&&Dd.error(`Auth (${Wo}): ${s}`,...e)}function li(s,...e){throw ay(s,...e)}function Ti(s,...e){return ay(s,...e)}function $_(s,e,t){const i={...$N(),[e]:t};return new Ho("auth","Firebase",i).create(e,{appName:s.name})}function na(s){return $_(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ay(s,...e){if(typeof s!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=s.name),s._errorFactory.create(t,...i)}return H_.create(s,...e)}function _t(s,e,...t){if(!s)throw ay(e,...t)}function Ji(s){const e="INTERNAL ASSERTION FAILED: "+s;throw bd(e),new Error(e)}function oa(s,e){s||Ji(e)}function wg(){return typeof self<"u"&&self.location?.href||""}function GN(){return f2()==="http:"||f2()==="https:"}function f2(){return typeof self<"u"&&self.location?.protocol||null}function KN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(GN()||SC()||"connection"in navigator)?navigator.onLine:!0}function YN(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}class Nu{constructor(e,t){this.shortDelay=e,this.longDelay=t,oa(t>e,"Short delay should be less than long delay!"),this.isMobile=kC()||jC()}get(){return KN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function oy(s,e){oa(s.emulator,"Emulator should always be set here");const{url:t}=s.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class W_{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ji("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ji("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ji("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const QN={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const XN=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],JN=new Nu(3e4,6e4);function ua(s,e){return s.tenantId&&!e.tenantId?{...e,tenantId:s.tenantId}:e}async function ha(s,e,t,i,l={}){return G_(s,l,async()=>{let u={},h={};i&&(e==="GET"?h=i:u={body:JSON.stringify(i)});const p=ju({key:s.config.apiKey,...h}).slice(1),g=await s._getAdditionalHeaders();g["Content-Type"]="application/json",s.languageCode&&(g["X-Firebase-Locale"]=s.languageCode);const y={method:e,headers:g,...u};return TC()||(y.referrerPolicy="no-referrer"),s.emulatorConfig&&so(s.emulatorConfig.host)&&(y.credentials="include"),W_.fetch()(await K_(s,s.config.apiHost,t,p),y)})}async function G_(s,e,t){s._canInitEmulator=!1;const i={...QN,...e};try{const l=new eA(s),u=await Promise.race([t(),l.promise]);l.clearNetworkTimeout();const h=await u.json();if("needConfirmation"in h)throw sd(s,"account-exists-with-different-credential",h);if(u.ok&&!("errorMessage"in h))return h;{const p=u.ok?h.errorMessage:h.error.message,[g,y]=p.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw sd(s,"credential-already-in-use",h);if(g==="EMAIL_EXISTS")throw sd(s,"email-already-in-use",h);if(g==="USER_DISABLED")throw sd(s,"user-disabled",h);const b=i[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw $_(s,b,y);li(s,b)}}catch(l){if(l instanceof di)throw l;li(s,"network-request-failed",{message:String(l)})}}async function Au(s,e,t,i,l={}){const u=await ha(s,e,t,i,l);return"mfaPendingCredential"in u&&li(s,"multi-factor-auth-required",{_serverResponse:u}),u}async function K_(s,e,t,i){const l=`${e}${t}?${i}`,u=s,h=u.config.emulator?oy(s.config,l):`${s.config.apiScheme}://${l}`;return XN.includes(t)&&(await u._persistenceManagerAvailable,u._getPersistenceType()==="COOKIE")?u._getPersistence()._getFinalTarget(h).toString():h}function ZN(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class eA{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Ti(this.auth,"network-request-failed")),JN.get())})}}function sd(s,e,t){const i={appName:s.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const l=Ti(s,e,i);return l.customData._tokenResponse=t,l}function m2(s){return s!==void 0&&s.enterprise!==void 0}class tA{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return ZN(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function nA(s,e){return ha(s,"GET","/v2/recaptchaConfig",ua(s,e))}async function sA(s,e){return ha(s,"POST","/v1/accounts:delete",e)}async function Md(s,e){return ha(s,"POST","/v1/accounts:lookup",e)}function ru(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function rA(s,e=!1){const t=yn(s),i=await t.getIdToken(e),l=ly(i);_t(l&&l.exp&&l.auth_time&&l.iat,t.auth,"internal-error");const u=typeof l.firebase=="object"?l.firebase:void 0,h=u?.sign_in_provider;return{claims:l,token:i,authTime:ru(Pp(l.auth_time)),issuedAtTime:ru(Pp(l.iat)),expirationTime:ru(Pp(l.exp)),signInProvider:h||null,signInSecondFactor:u?.sign_in_second_factor||null}}function Pp(s){return Number(s)*1e3}function ly(s){const[e,t,i]=s.split(".");if(e===void 0||t===void 0||i===void 0)return bd("JWT malformed, contained fewer than 3 sections"),null;try{const l=R_(t);return l?JSON.parse(l):(bd("Failed to decode base64 JWT payload"),null)}catch(l){return bd("Caught error parsing JWT payload as JSON",l?.toString()),null}}function p2(s){const e=ly(s);return _t(e,"internal-error"),_t(typeof e.exp<"u","internal-error"),_t(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function du(s,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof di&&iA(i)&&s.auth.currentUser===s&&await s.auth.signOut(),i}}function iA({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}class aA{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class _g{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ru(this.lastLoginAt),this.creationTime=ru(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Ld(s){const e=s.auth,t=await s.getIdToken(),i=await du(s,Md(e,{idToken:t}));_t(i?.users.length,e,"internal-error");const l=i.users[0];s._notifyReloadListener(l);const u=l.providerUserInfo?.length?Y_(l.providerUserInfo):[],h=lA(s.providerData,u),p=s.isAnonymous,g=!(s.email&&l.passwordHash)&&!h?.length,y=p?g:!1,b={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:h,metadata:new _g(l.createdAt,l.lastLoginAt),isAnonymous:y};Object.assign(s,b)}async function oA(s){const e=yn(s);await Ld(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function lA(s,e){return[...s.filter(i=>!e.some(l=>l.providerId===i.providerId)),...e]}function Y_(s){return s.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function cA(s,e){const t=await G_(s,{},async()=>{const i=ju({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:l,apiKey:u}=s.config,h=await K_(s,l,"/v1/token",`key=${u}`),p=await s._getAdditionalHeaders();p["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:p,body:i};return s.emulatorConfig&&so(s.emulatorConfig.host)&&(g.credentials="include"),W_.fetch()(h,g)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function uA(s,e){return ha(s,"POST","/v2/accounts:revokeToken",ua(s,e))}class Ol{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){_t(e.idToken,"internal-error"),_t(typeof e.idToken<"u","internal-error"),_t(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):p2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){_t(e.length!==0,"internal-error");const t=p2(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(_t(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:l,expiresIn:u}=await cA(e,t);this.updateTokensAndExpiration(i,l,Number(u))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:l,expirationTime:u}=t,h=new Ol;return i&&(_t(typeof i=="string","internal-error",{appName:e}),h.refreshToken=i),l&&(_t(typeof l=="string","internal-error",{appName:e}),h.accessToken=l),u&&(_t(typeof u=="number","internal-error",{appName:e}),h.expirationTime=u),h}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ol,this.toJSON())}_performRefresh(){return Ji("not implemented")}}function Ua(s,e){_t(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class ii{constructor({uid:e,auth:t,stsTokenManager:i,...l}){this.providerId="firebase",this.proactiveRefresh=new aA(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new _g(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await du(this,this.stsTokenManager.getToken(this.auth,e));return _t(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return rA(this,e)}reload(){return oA(this)}_assign(e){this!==e&&(_t(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ii({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){_t(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Ld(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Sr(this.auth.app))return Promise.reject(na(this.auth));const e=await this.getIdToken();return await du(this,sA(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,l=t.email??void 0,u=t.phoneNumber??void 0,h=t.photoURL??void 0,p=t.tenantId??void 0,g=t._redirectEventId??void 0,y=t.createdAt??void 0,b=t.lastLoginAt??void 0,{uid:k,emailVerified:E,isAnonymous:O,providerData:H,stsTokenManager:q}=t;_t(k&&q,e,"internal-error");const B=Ol.fromJSON(this.name,q);_t(typeof k=="string",e,"internal-error"),Ua(i,e.name),Ua(l,e.name),_t(typeof E=="boolean",e,"internal-error"),_t(typeof O=="boolean",e,"internal-error"),Ua(u,e.name),Ua(h,e.name),Ua(p,e.name),Ua(g,e.name),Ua(y,e.name),Ua(b,e.name);const K=new ii({uid:k,auth:e,email:l,emailVerified:E,displayName:i,isAnonymous:O,photoURL:h,phoneNumber:u,tenantId:p,stsTokenManager:B,createdAt:y,lastLoginAt:b});return H&&Array.isArray(H)&&(K.providerData=H.map($=>({...$}))),g&&(K._redirectEventId=g),K}static async _fromIdTokenResponse(e,t,i=!1){const l=new Ol;l.updateFromServerResponse(t);const u=new ii({uid:t.localId,auth:e,stsTokenManager:l,isAnonymous:i});return await Ld(u),u}static async _fromGetAccountInfoResponse(e,t,i){const l=t.users[0];_t(l.localId!==void 0,"internal-error");const u=l.providerUserInfo!==void 0?Y_(l.providerUserInfo):[],h=!(l.email&&l.passwordHash)&&!u?.length,p=new Ol;p.updateFromIdToken(i);const g=new ii({uid:l.localId,auth:e,stsTokenManager:p,isAnonymous:h}),y={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:u,metadata:new _g(l.createdAt,l.lastLoginAt),isAnonymous:!(l.email&&l.passwordHash)&&!u?.length};return Object.assign(g,y),g}}const g2=new Map;function Zi(s){oa(s instanceof Function,"Expected a class definition");let e=g2.get(s);return e?(oa(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,g2.set(s,e),e)}class Q_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Q_.type="NONE";const y2=Q_;function wd(s,e,t){return`firebase:${s}:${e}:${t}`}class Pl{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:l,name:u}=this.auth;this.fullUserKey=wd(this.userKey,l.apiKey,u),this.fullPersistenceKey=wd("persistence",l.apiKey,u),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Md(this.auth,{idToken:e}).catch(()=>{});return t?ii._fromGetAccountInfoResponse(this.auth,t,e):null}return ii._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Pl(Zi(y2),e,i);const l=(await Promise.all(t.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let u=l[0]||Zi(y2);const h=wd(i,e.config.apiKey,e.name);let p=null;for(const y of t)try{const b=await y._get(h);if(b){let k;if(typeof b=="string"){const E=await Md(e,{idToken:b}).catch(()=>{});if(!E)break;k=await ii._fromGetAccountInfoResponse(e,E,b)}else k=ii._fromJSON(e,b);y!==u&&(p=k),u=y;break}}catch{}const g=l.filter(y=>y._shouldAllowMigration);return!u._shouldAllowMigration||!g.length?new Pl(u,e,i):(u=g[0],p&&await u._set(h,p.toJSON()),await Promise.all(t.map(async y=>{if(y!==u)try{await y._remove(h)}catch{}})),new Pl(u,e,i))}}function v2(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(ex(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(X_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(nx(e))return"Blackberry";if(sx(e))return"Webos";if(J_(e))return"Safari";if((e.includes("chrome/")||Z_(e))&&!e.includes("edge/"))return"Chrome";if(tx(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=s.match(t);if(i?.length===2)return i[1]}return"Other"}function X_(s=Gs()){return/firefox\//i.test(s)}function J_(s=Gs()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Z_(s=Gs()){return/crios\//i.test(s)}function ex(s=Gs()){return/iemobile/i.test(s)}function tx(s=Gs()){return/android/i.test(s)}function nx(s=Gs()){return/blackberry/i.test(s)}function sx(s=Gs()){return/webos/i.test(s)}function cy(s=Gs()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function hA(s=Gs()){return cy(s)&&!!window.navigator?.standalone}function dA(){return CC()&&document.documentMode===10}function rx(s=Gs()){return cy(s)||tx(s)||sx(s)||nx(s)||/windows phone/i.test(s)||ex(s)}function ix(s,e=[]){let t;switch(s){case"Browser":t=v2(Gs());break;case"Worker":t=`${v2(Gs())}-${s}`;break;default:t=s}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Wo}/${i}`}class fA{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=u=>new Promise((h,p)=>{try{const g=e(u);h(g)}catch(g){p(g)}});i.onAbort=t,this.queue.push(i);const l=this.queue.length-1;return()=>{this.queue[l]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const l of t)try{l()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function mA(s,e={}){return ha(s,"GET","/v2/passwordPolicy",ua(s,e))}const pA=6;class gA{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??pA,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,l=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),l&&(t.meetsMaxPasswordLength=e.length<=l)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let l=0;l<e.length;l++)i=e.charAt(l),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,l,u){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=l)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=u))}}class yA{constructor(e,t,i,l){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=l,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new b2(this),this.idTokenSubscription=new b2(this),this.beforeStateQueue=new fA(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=H_,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=l.sdkClientVersion,this._persistenceManagerAvailable=new Promise(u=>this._resolvePersistenceManagerAvailable=u)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Zi(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Pl.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Md(this,{idToken:e}),i=await ii._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Sr(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(h=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(h,h))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=this.redirectUser?._redirectEventId,h=i?._redirectEventId,p=await this.tryRedirectSignIn(e);(!u||u===h)&&p?.user&&(i=p.user,l=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return _t(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Ld(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=YN()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Sr(this.app))return Promise.reject(na(this));const t=e?yn(e):null;return t&&_t(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&_t(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Sr(this.app)?Promise.reject(na(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Sr(this.app)?Promise.reject(na(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Zi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await mA(this),t=new gA(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ho("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await uA(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Zi(e)||this._popupRedirectResolver;_t(t,this,"argument-error"),this.redirectPersistenceManager=await Pl.create(this,[Zi(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,l){if(this._deleted)return()=>{};const u=typeof t=="function"?t:t.next.bind(t);let h=!1;const p=this._isInitialized?Promise.resolve():this._initializationPromise;if(_t(p,this,"internal-error"),p.then(()=>{h||u(this.currentUser)}),typeof t=="function"){const g=e.addObserver(t,i,l);return()=>{h=!0,g()}}else{const g=e.addObserver(t);return()=>{h=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return _t(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ix(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Sr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&WN(`Error while retrieving App Check token: ${e.error}`),e?.token}}function ro(s){return yn(s)}class b2{constructor(e){this.auth=e,this.observer=null,this.addObserver=LC(t=>this.observer=t)}get next(){return _t(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let nf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function vA(s){nf=s}function ax(s){return nf.loadJS(s)}function bA(){return nf.recaptchaEnterpriseScript}function wA(){return nf.gapiScript}function _A(s){return`__${s}${Math.floor(Math.random()*1e6)}`}class xA{constructor(){this.enterprise=new kA}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class kA{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const EA="recaptcha-enterprise",ox="NO_RECAPTCHA";class TA{constructor(e){this.type=EA,this.auth=ro(e)}async verify(e="verify",t=!1){async function i(u){if(!t){if(u.tenantId==null&&u._agentRecaptchaConfig!=null)return u._agentRecaptchaConfig.siteKey;if(u.tenantId!=null&&u._tenantRecaptchaConfigs[u.tenantId]!==void 0)return u._tenantRecaptchaConfigs[u.tenantId].siteKey}return new Promise(async(h,p)=>{nA(u,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)p(new Error("recaptcha Enterprise site key undefined"));else{const y=new tA(g);return u.tenantId==null?u._agentRecaptchaConfig=y:u._tenantRecaptchaConfigs[u.tenantId]=y,h(y.siteKey)}}).catch(g=>{p(g)})})}function l(u,h,p){const g=window.grecaptcha;m2(g)?g.enterprise.ready(()=>{g.enterprise.execute(u,{action:e}).then(y=>{h(y)}).catch(()=>{h(ox)})}):p(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new xA().execute("siteKey",{action:"verify"}):new Promise((u,h)=>{i(this.auth).then(p=>{if(!t&&m2(window.grecaptcha))l(p,u,h);else{if(typeof window>"u"){h(new Error("RecaptchaVerifier is only supported in browser"));return}let g=bA();g.length!==0&&(g+=p),ax(g).then(()=>{l(p,u,h)}).catch(y=>{h(y)})}}).catch(p=>{h(p)})})}}async function w2(s,e,t,i=!1,l=!1){const u=new TA(s);let h;if(l)h=ox;else try{h=await u.verify(t)}catch{h=await u.verify(t,!0)}const p={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in p){const g=p.phoneEnrollmentInfo.phoneNumber,y=p.phoneEnrollmentInfo.recaptchaToken;Object.assign(p,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:y,captchaResponse:h,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in p){const g=p.phoneSignInInfo.recaptchaToken;Object.assign(p,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:h,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return p}return i?Object.assign(p,{captchaResp:h}):Object.assign(p,{captchaResponse:h}),Object.assign(p,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(p,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),p}async function Od(s,e,t,i,l){if(s._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await w2(s,e,t,t==="getOobCode");return i(s,u)}else return i(s,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const h=await w2(s,e,t,t==="getOobCode");return i(s,h)}else return Promise.reject(u)})}function SA(s,e){const t=$o(s,"auth");if(t.isInitialized()){const l=t.getImmediate(),u=t.getOptions();if(ia(u,e??{}))return l;li(l,"already-initialized")}return t.initialize({options:e})}function jA(s,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(Zi);e?.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(i,e?.popupRedirectResolver)}function CA(s,e,t){const i=ro(s);_t(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const l=!1,u=lx(e),{host:h,port:p}=NA(e),g=p===null?"":`:${p}`,y={url:`${u}//${h}${g}/`},b=Object.freeze({host:h,port:p,protocol:u.replace(":",""),options:Object.freeze({disableWarnings:l})});if(!i._canInitEmulator){_t(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),_t(ia(y,i.config.emulator)&&ia(b,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=y,i.emulatorConfig=b,i.settings.appVerificationDisabledForTesting=!0,so(h)?(ty(`${u}//${h}${g}`),ny("Auth",!0)):AA()}function lx(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function NA(s){const e=lx(s),t=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",l=/^(\[[^\]]+\])(:|$)/.exec(i);if(l){const u=l[1];return{host:u,port:_2(i.substr(u.length+1))}}else{const[u,h]=i.split(":");return{host:u,port:_2(h)}}}function _2(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function AA(){function s(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}class uy{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ji("not implemented")}_getIdTokenResponse(e){return Ji("not implemented")}_linkToIdToken(e,t){return Ji("not implemented")}_getReauthenticationResolver(e){return Ji("not implemented")}}async function RA(s,e){return ha(s,"POST","/v1/accounts:signUp",e)}async function IA(s,e){return Au(s,"POST","/v1/accounts:signInWithPassword",ua(s,e))}async function cx(s,e){return ha(s,"POST","/v1/accounts:sendOobCode",ua(s,e))}async function DA(s,e){return cx(s,e)}async function MA(s,e){return cx(s,e)}async function LA(s,e){return Au(s,"POST","/v1/accounts:signInWithEmailLink",ua(s,e))}async function OA(s,e){return Au(s,"POST","/v1/accounts:signInWithEmailLink",ua(s,e))}class fu extends uy{constructor(e,t,i,l=null){super("password",i),this._email=e,this._password=t,this._tenantId=l}static _fromEmailAndPassword(e,t){return new fu(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new fu(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Od(e,t,"signInWithPassword",IA);case"emailLink":return LA(e,{email:this._email,oobCode:this._password});default:li(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Od(e,i,"signUpPassword",RA);case"emailLink":return OA(e,{idToken:t,email:this._email,oobCode:this._password});default:li(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Vl(s,e){return Au(s,"POST","/v1/accounts:signInWithIdp",ua(s,e))}const PA="http://localhost";class Oo extends uy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Oo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):li("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:l,...u}=t;if(!i||!l)return null;const h=new Oo(i,l);return h.idToken=u.idToken||void 0,h.accessToken=u.accessToken||void 0,h.secret=u.secret,h.nonce=u.nonce,h.pendingToken=u.pendingToken||null,h}_getIdTokenResponse(e){const t=this.buildRequest();return Vl(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Vl(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Vl(e,t)}buildRequest(){const e={requestUri:PA,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=ju(t)}return e}}function VA(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function UA(s){const e=Xc(Jc(s)).link,t=e?Xc(Jc(e)).deep_link_id:null,i=Xc(Jc(s)).deep_link_id;return(i?Xc(Jc(i)).link:null)||i||t||e||s}class hy{constructor(e){const t=Xc(Jc(e)),i=t.apiKey??null,l=t.oobCode??null,u=VA(t.mode??null);_t(i&&l&&u,"argument-error"),this.apiKey=i,this.operation=u,this.code=l,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=UA(e);try{return new hy(t)}catch{return null}}}class Jl{constructor(){this.providerId=Jl.PROVIDER_ID}static credential(e,t){return fu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=hy.parseLink(t);return _t(i,"argument-error"),fu._fromEmailAndCode(e,i.code,i.tenantId)}}Jl.PROVIDER_ID="password";Jl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Jl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class ux{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Ru extends ux{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ba extends Ru{constructor(){super("facebook.com")}static credential(e){return Oo._fromParams({providerId:Ba.PROVIDER_ID,signInMethod:Ba.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ba.credentialFromTaggedObject(e)}static credentialFromError(e){return Ba.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ba.credential(e.oauthAccessToken)}catch{return null}}}Ba.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ba.PROVIDER_ID="facebook.com";class za extends Ru{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Oo._fromParams({providerId:za.PROVIDER_ID,signInMethod:za.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return za.credentialFromTaggedObject(e)}static credentialFromError(e){return za.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return za.credential(t,i)}catch{return null}}}za.GOOGLE_SIGN_IN_METHOD="google.com";za.PROVIDER_ID="google.com";class Fa extends Ru{constructor(){super("github.com")}static credential(e){return Oo._fromParams({providerId:Fa.PROVIDER_ID,signInMethod:Fa.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Fa.credentialFromTaggedObject(e)}static credentialFromError(e){return Fa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Fa.credential(e.oauthAccessToken)}catch{return null}}}Fa.GITHUB_SIGN_IN_METHOD="github.com";Fa.PROVIDER_ID="github.com";class qa extends Ru{constructor(){super("twitter.com")}static credential(e,t){return Oo._fromParams({providerId:qa.PROVIDER_ID,signInMethod:qa.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return qa.credentialFromTaggedObject(e)}static credentialFromError(e){return qa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return qa.credential(t,i)}catch{return null}}}qa.TWITTER_SIGN_IN_METHOD="twitter.com";qa.PROVIDER_ID="twitter.com";async function BA(s,e){return Au(s,"POST","/v1/accounts:signUp",ua(s,e))}class Po{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,l=!1){const u=await ii._fromIdTokenResponse(e,i,l),h=x2(i);return new Po({user:u,providerId:h,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const l=x2(i);return new Po({user:e,providerId:l,_tokenResponse:i,operationType:t})}}function x2(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}class Pd extends di{constructor(e,t,i,l){super(t.code,t.message),this.operationType=i,this.user=l,Object.setPrototypeOf(this,Pd.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,l){return new Pd(e,t,i,l)}}function hx(s,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(s):t._getIdTokenResponse(s)).catch(u=>{throw u.code==="auth/multi-factor-auth-required"?Pd._fromErrorAndOperation(s,u,e,i):u})}async function zA(s,e,t=!1){const i=await du(s,e._linkToIdToken(s.auth,await s.getIdToken()),t);return Po._forOperation(s,"link",i)}async function FA(s,e,t=!1){const{auth:i}=s;if(Sr(i.app))return Promise.reject(na(i));const l="reauthenticate";try{const u=await du(s,hx(i,l,e,s),t);_t(u.idToken,i,"internal-error");const h=ly(u.idToken);_t(h,i,"internal-error");const{sub:p}=h;return _t(s.uid===p,i,"user-mismatch"),Po._forOperation(s,l,u)}catch(u){throw u?.code==="auth/user-not-found"&&li(i,"user-mismatch"),u}}async function dx(s,e,t=!1){if(Sr(s.app))return Promise.reject(na(s));const i="signIn",l=await hx(s,i,e),u=await Po._fromIdTokenResponse(s,i,l);return t||await s._updateCurrentUser(u.user),u}async function qA(s,e){return dx(ro(s),e)}async function fx(s){const e=ro(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function HA(s,e,t){const i=ro(s);await Od(i,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",MA)}async function $A(s,e,t){if(Sr(s.app))return Promise.reject(na(s));const i=ro(s),h=await Od(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",BA).catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&fx(s),g}),p=await Po._fromIdTokenResponse(i,"signIn",h);return await i._updateCurrentUser(p.user),p}function WA(s,e,t){return Sr(s.app)?Promise.reject(na(s)):qA(yn(s),Jl.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&fx(s),i})}async function aO(s,e){const t=yn(s),l={requestType:"VERIFY_EMAIL",idToken:await s.getIdToken()},{email:u}=await DA(t.auth,l);u!==s.email&&await s.reload()}function k2(s,e){return yn(s).setPersistence(e)}function GA(s,e,t,i){return yn(s).onIdTokenChanged(e,t,i)}function KA(s,e,t){return yn(s).beforeAuthStateChanged(e,t)}function YA(s,e,t,i){return yn(s).onAuthStateChanged(e,t,i)}function QA(s){return yn(s).signOut()}const Vd="__sak";class mx{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Vd,"1"),this.storage.removeItem(Vd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const XA=1e3,JA=10;class px extends mx{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=rx(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),l=this.localCache[t];i!==l&&e(t,l,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((h,p,g)=>{this.notifyListeners(h,g)});return}const i=e.key;t?this.detachListener():this.stopPolling();const l=()=>{const h=this.storage.getItem(i);!t&&this.localCache[i]===h||this.notifyListeners(i,h)},u=this.storage.getItem(i);dA()&&u!==e.newValue&&e.newValue!==e.oldValue?setTimeout(l,JA):l()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},XA)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}px.type="LOCAL";const xg=px;class gx extends mx{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}gx.type="SESSION";const dy=gx;function ZA(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class sf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(l=>l.isListeningto(e));if(t)return t;const i=new sf(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:l,data:u}=t.data,h=this.handlersMap[l];if(!h?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:l});const p=Array.from(h).map(async y=>y(t.origin,u)),g=await ZA(p);t.ports[0].postMessage({status:"done",eventId:i,eventType:l,response:g})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}sf.receivers=[];function fy(s="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return s+t}class eR{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const l=typeof MessageChannel<"u"?new MessageChannel:null;if(!l)throw new Error("connection_unavailable");let u,h;return new Promise((p,g)=>{const y=fy("",20);l.port1.start();const b=setTimeout(()=>{g(new Error("unsupported_event"))},i);h={messageChannel:l,onMessage(k){const E=k;if(E.data.eventId===y)switch(E.data.status){case"ack":clearTimeout(b),u=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),p(E.data.response);break;default:clearTimeout(b),clearTimeout(u),g(new Error("invalid_response"));break}}},this.handlers.add(h),l.port1.addEventListener("message",h.onMessage),this.target.postMessage({eventType:e,eventId:y,data:t},[l.port2])}).finally(()=>{h&&this.removeMessageHandler(h)})}}function Si(){return window}function tR(s){Si().location.href=s}function yx(){return typeof Si().WorkerGlobalScope<"u"&&typeof Si().importScripts=="function"}async function nR(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function sR(){return navigator?.serviceWorker?.controller||null}function rR(){return yx()?self:null}const vx="firebaseLocalStorageDb",iR=1,Ud="firebaseLocalStorage",bx="fbase_key";class Iu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function rf(s,e){return s.transaction([Ud],e?"readwrite":"readonly").objectStore(Ud)}function aR(){const s=indexedDB.deleteDatabase(vx);return new Iu(s).toPromise()}function kg(){const s=indexedDB.open(vx,iR);return new Promise((e,t)=>{s.addEventListener("error",()=>{t(s.error)}),s.addEventListener("upgradeneeded",()=>{const i=s.result;try{i.createObjectStore(Ud,{keyPath:bx})}catch(l){t(l)}}),s.addEventListener("success",async()=>{const i=s.result;i.objectStoreNames.contains(Ud)?e(i):(i.close(),await aR(),e(await kg()))})})}async function E2(s,e,t){const i=rf(s,!0).put({[bx]:e,value:t});return new Iu(i).toPromise()}async function oR(s,e){const t=rf(s,!1).get(e),i=await new Iu(t).toPromise();return i===void 0?null:i.value}function T2(s,e){const t=rf(s,!0).delete(e);return new Iu(t).toPromise()}const lR=800,cR=3;class wx{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await kg(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>cR)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return yx()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=sf._getInstance(rR()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await nR(),!this.activeServiceWorker)return;this.sender=new eR(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||sR()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await kg();return await E2(e,Vd,"1"),await T2(e,Vd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>E2(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>oR(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>T2(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(l=>{const u=rf(l,!1).getAll();return new Iu(u).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:l,value:u}of e)i.add(l),JSON.stringify(this.localCache[l])!==JSON.stringify(u)&&(this.notifyListeners(l,u),t.push(l));for(const l of Object.keys(this.localCache))this.localCache[l]&&!i.has(l)&&(this.notifyListeners(l,null),t.push(l));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),lR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}wx.type="LOCAL";const uR=wx;new Nu(3e4,6e4);function hR(s,e){return e?Zi(e):(_t(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}class my extends uy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Vl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Vl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Vl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function dR(s){return dx(s.auth,new my(s),s.bypassAuthState)}function fR(s){const{auth:e,user:t}=s;return _t(t,e,"internal-error"),FA(t,new my(s),s.bypassAuthState)}async function mR(s){const{auth:e,user:t}=s;return _t(t,e,"internal-error"),zA(t,new my(s),s.bypassAuthState)}class _x{constructor(e,t,i,l,u=!1){this.auth=e,this.resolver=i,this.user=l,this.bypassAuthState=u,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:l,tenantId:u,error:h,type:p}=e;if(h){this.reject(h);return}const g={auth:this.auth,requestUri:t,sessionId:i,tenantId:u||void 0,postBody:l||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(p)(g))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return dR;case"linkViaPopup":case"linkViaRedirect":return mR;case"reauthViaPopup":case"reauthViaRedirect":return fR;default:li(this.auth,"internal-error")}}resolve(e){oa(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){oa(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const pR=new Nu(2e3,1e4);class Ll extends _x{constructor(e,t,i,l,u){super(e,t,l,u),this.provider=i,this.authWindow=null,this.pollId=null,Ll.currentPopupAction&&Ll.currentPopupAction.cancel(),Ll.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return _t(e,this.auth,"internal-error"),e}async onExecution(){oa(this.filter.length===1,"Popup operations only handle one event");const e=fy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ti(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Ti(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ll.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ti(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,pR.get())};e()}}Ll.currentPopupAction=null;const gR="pendingRedirect",_d=new Map;class yR extends _x{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=_d.get(this.auth._key());if(!e){try{const i=await vR(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}_d.set(this.auth._key(),e)}return this.bypassAuthState||_d.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function vR(s,e){const t=_R(e),i=wR(s);if(!await i._isAvailable())return!1;const l=await i._get(t)==="true";return await i._remove(t),l}function bR(s,e){_d.set(s._key(),e)}function wR(s){return Zi(s._redirectPersistence)}function _R(s){return wd(gR,s.config.apiKey,s.name)}async function xR(s,e,t=!1){if(Sr(s.app))return Promise.reject(na(s));const i=ro(s),l=hR(i,e),h=await new yR(i,l,t).execute();return h&&!t&&(delete h.user._redirectEventId,await i._persistUserIfCurrent(h.user),await i._setRedirectUser(null,e)),h}const kR=600*1e3;class ER{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!TR(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!xx(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Ti(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=kR&&this.cachedEventUids.clear(),this.cachedEventUids.has(S2(e))}saveEventToCache(e){this.cachedEventUids.add(S2(e)),this.lastProcessedEventTime=Date.now()}}function S2(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function xx({type:s,error:e}){return s==="unknown"&&e?.code==="auth/no-auth-event"}function TR(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return xx(s);default:return!1}}async function SR(s,e={}){return ha(s,"GET","/v1/projects",e)}const jR=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,CR=/^https?/;async function NR(s){if(s.config.emulator)return;const{authorizedDomains:e}=await SR(s);for(const t of e)try{if(AR(t))return}catch{}li(s,"unauthorized-domain")}function AR(s){const e=wg(),{protocol:t,hostname:i}=new URL(e);if(s.startsWith("chrome-extension://")){const h=new URL(s);return h.hostname===""&&i===""?t==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&h.hostname===i}if(!CR.test(t))return!1;if(jR.test(s))return i===s;const l=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+l+"|"+l+")$","i").test(i)}const RR=new Nu(3e4,6e4);function j2(){const s=Si().___jsl;if(s?.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let t=0;t<s.CP.length;t++)s.CP[t]=null}}function IR(s){return new Promise((e,t)=>{function i(){j2(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{j2(),t(Ti(s,"network-request-failed"))},timeout:RR.get()})}if(Si().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Si().gapi?.load)i();else{const l=_A("iframefcb");return Si()[l]=()=>{gapi.load?i():t(Ti(s,"network-request-failed"))},ax(`${wA()}?onload=${l}`).catch(u=>t(u))}}).catch(e=>{throw xd=null,e})}let xd=null;function DR(s){return xd=xd||IR(s),xd}const MR=new Nu(5e3,15e3),LR="__/auth/iframe",OR="emulator/auth/iframe",PR={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},VR=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function UR(s){const e=s.config;_t(e.authDomain,s,"auth-domain-config-required");const t=e.emulator?oy(e,OR):`https://${s.config.authDomain}/${LR}`,i={apiKey:e.apiKey,appName:s.name,v:Wo},l=VR.get(s.config.apiHost);l&&(i.eid=l);const u=s._getFrameworks();return u.length&&(i.fw=u.join(",")),`${t}?${ju(i).slice(1)}`}async function BR(s){const e=await DR(s),t=Si().gapi;return _t(t,s,"internal-error"),e.open({where:document.body,url:UR(s),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:PR,dontclear:!0},i=>new Promise(async(l,u)=>{await i.restyle({setHideOnLeave:!1});const h=Ti(s,"network-request-failed"),p=Si().setTimeout(()=>{u(h)},MR.get());function g(){Si().clearTimeout(p),l(i)}i.ping(g).then(g,()=>{u(h)})}))}const zR={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},FR=500,qR=600,HR="_blank",$R="http://localhost";class C2{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function WR(s,e,t,i=FR,l=qR){const u=Math.max((window.screen.availHeight-l)/2,0).toString(),h=Math.max((window.screen.availWidth-i)/2,0).toString();let p="";const g={...zR,width:i.toString(),height:l.toString(),top:u,left:h},y=Gs().toLowerCase();t&&(p=Z_(y)?HR:t),X_(y)&&(e=e||$R,g.scrollbars="yes");const b=Object.entries(g).reduce((E,[O,H])=>`${E}${O}=${H},`,"");if(hA(y)&&p!=="_self")return GR(e||"",p),new C2(null);const k=window.open(e||"",p,b);_t(k,s,"popup-blocked");try{k.focus()}catch{}return new C2(k)}function GR(s,e){const t=document.createElement("a");t.href=s,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const KR="__/auth/handler",YR="emulator/auth/handler",QR=encodeURIComponent("fac");async function N2(s,e,t,i,l,u){_t(s.config.authDomain,s,"auth-domain-config-required"),_t(s.config.apiKey,s,"invalid-api-key");const h={apiKey:s.config.apiKey,appName:s.name,authType:t,redirectUrl:i,v:Wo,eventId:l};if(e instanceof ux){e.setDefaultLanguage(s.languageCode),h.providerId=e.providerId||"",MC(e.getCustomParameters())||(h.customParameters=JSON.stringify(e.getCustomParameters()));for(const[b,k]of Object.entries({}))h[b]=k}if(e instanceof Ru){const b=e.getScopes().filter(k=>k!=="");b.length>0&&(h.scopes=b.join(","))}s.tenantId&&(h.tid=s.tenantId);const p=h;for(const b of Object.keys(p))p[b]===void 0&&delete p[b];const g=await s._getAppCheckToken(),y=g?`#${QR}=${encodeURIComponent(g)}`:"";return`${XR(s)}?${ju(p).slice(1)}${y}`}function XR({config:s}){return s.emulator?oy(s,YR):`https://${s.authDomain}/${KR}`}const Vp="webStorageSupport";class JR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=dy,this._completeRedirectFn=xR,this._overrideRedirectResult=bR}async _openPopup(e,t,i,l){oa(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const u=await N2(e,t,i,wg(),l);return WR(e,u,fy())}async _openRedirect(e,t,i,l){await this._originValidation(e);const u=await N2(e,t,i,wg(),l);return tR(u),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:l,promise:u}=this.eventManagers[t];return l?Promise.resolve(l):(oa(u,"If manager is not set, promise should be"),u)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await BR(e),i=new ER(e);return t.register("authEvent",l=>(_t(l?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(l.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Vp,{type:Vp},l=>{const u=l?.[0]?.[Vp];u!==void 0&&t(!!u),li(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=NR(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return rx()||J_()||cy()}}const ZR=JR;var A2="@firebase/auth",R2="1.12.0";class e4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){_t(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function t4(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function n4(s){oi(new Qr("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),l=e.getProvider("heartbeat"),u=e.getProvider("app-check-internal"),{apiKey:h,authDomain:p}=i.options;_t(h&&!h.includes(":"),"invalid-api-key",{appName:i.name});const g={apiKey:h,authDomain:p,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ix(s)},y=new yA(i,l,u,g);return jA(y,t),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),oi(new Qr("auth-internal",e=>{const t=ro(e.getProvider("auth").getImmediate());return(i=>new e4(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),gr(A2,R2,t4(s)),gr(A2,R2,"esm2020")}const s4=300,r4=L_("authIdTokenMaxAge")||s4;let I2=null;const i4=s=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>r4)return;const l=t?.token;I2!==l&&(I2=l,await fetch(s,{method:l?"POST":"DELETE",headers:l?{Authorization:`Bearer ${l}`}:{}}))};function kx(s=Cu()){const e=$o(s,"auth");if(e.isInitialized())return e.getImmediate();const t=SA(s,{popupRedirectResolver:ZR,persistence:[uR,xg,dy]}),i=L_("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const u=new URL(i,location.origin);if(location.origin===u.origin){const h=i4(u.toString());KA(t,h,()=>h(t.currentUser)),GA(t,p=>h(p))}}const l=I_("auth");return l&&CA(t,`http://${l}`),t}function a4(){return document.getElementsByTagName("head")?.[0]??document}vA({loadJS(s){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",s),i.onload=e,i.onerror=l=>{const u=Ti("internal-error");u.customData=l,t(u)},i.type="text/javascript",i.charset="UTF-8",a4().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});n4("Browser");var D2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Ya,Ex;(function(){var s;function e(j,T){function R(){}R.prototype=T.prototype,j.F=T.prototype,j.prototype=new R,j.prototype.constructor=j,j.D=function(P,M,L){for(var A=Array(arguments.length-2),Ve=2;Ve<arguments.length;Ve++)A[Ve-2]=arguments[Ve];return T.prototype[M].apply(P,A)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function l(j,T,R){R||(R=0);const P=Array(16);if(typeof T=="string")for(var M=0;M<16;++M)P[M]=T.charCodeAt(R++)|T.charCodeAt(R++)<<8|T.charCodeAt(R++)<<16|T.charCodeAt(R++)<<24;else for(M=0;M<16;++M)P[M]=T[R++]|T[R++]<<8|T[R++]<<16|T[R++]<<24;T=j.g[0],R=j.g[1],M=j.g[2];let L=j.g[3],A;A=T+(L^R&(M^L))+P[0]+3614090360&4294967295,T=R+(A<<7&4294967295|A>>>25),A=L+(M^T&(R^M))+P[1]+3905402710&4294967295,L=T+(A<<12&4294967295|A>>>20),A=M+(R^L&(T^R))+P[2]+606105819&4294967295,M=L+(A<<17&4294967295|A>>>15),A=R+(T^M&(L^T))+P[3]+3250441966&4294967295,R=M+(A<<22&4294967295|A>>>10),A=T+(L^R&(M^L))+P[4]+4118548399&4294967295,T=R+(A<<7&4294967295|A>>>25),A=L+(M^T&(R^M))+P[5]+1200080426&4294967295,L=T+(A<<12&4294967295|A>>>20),A=M+(R^L&(T^R))+P[6]+2821735955&4294967295,M=L+(A<<17&4294967295|A>>>15),A=R+(T^M&(L^T))+P[7]+4249261313&4294967295,R=M+(A<<22&4294967295|A>>>10),A=T+(L^R&(M^L))+P[8]+1770035416&4294967295,T=R+(A<<7&4294967295|A>>>25),A=L+(M^T&(R^M))+P[9]+2336552879&4294967295,L=T+(A<<12&4294967295|A>>>20),A=M+(R^L&(T^R))+P[10]+4294925233&4294967295,M=L+(A<<17&4294967295|A>>>15),A=R+(T^M&(L^T))+P[11]+2304563134&4294967295,R=M+(A<<22&4294967295|A>>>10),A=T+(L^R&(M^L))+P[12]+1804603682&4294967295,T=R+(A<<7&4294967295|A>>>25),A=L+(M^T&(R^M))+P[13]+4254626195&4294967295,L=T+(A<<12&4294967295|A>>>20),A=M+(R^L&(T^R))+P[14]+2792965006&4294967295,M=L+(A<<17&4294967295|A>>>15),A=R+(T^M&(L^T))+P[15]+1236535329&4294967295,R=M+(A<<22&4294967295|A>>>10),A=T+(M^L&(R^M))+P[1]+4129170786&4294967295,T=R+(A<<5&4294967295|A>>>27),A=L+(R^M&(T^R))+P[6]+3225465664&4294967295,L=T+(A<<9&4294967295|A>>>23),A=M+(T^R&(L^T))+P[11]+643717713&4294967295,M=L+(A<<14&4294967295|A>>>18),A=R+(L^T&(M^L))+P[0]+3921069994&4294967295,R=M+(A<<20&4294967295|A>>>12),A=T+(M^L&(R^M))+P[5]+3593408605&4294967295,T=R+(A<<5&4294967295|A>>>27),A=L+(R^M&(T^R))+P[10]+38016083&4294967295,L=T+(A<<9&4294967295|A>>>23),A=M+(T^R&(L^T))+P[15]+3634488961&4294967295,M=L+(A<<14&4294967295|A>>>18),A=R+(L^T&(M^L))+P[4]+3889429448&4294967295,R=M+(A<<20&4294967295|A>>>12),A=T+(M^L&(R^M))+P[9]+568446438&4294967295,T=R+(A<<5&4294967295|A>>>27),A=L+(R^M&(T^R))+P[14]+3275163606&4294967295,L=T+(A<<9&4294967295|A>>>23),A=M+(T^R&(L^T))+P[3]+4107603335&4294967295,M=L+(A<<14&4294967295|A>>>18),A=R+(L^T&(M^L))+P[8]+1163531501&4294967295,R=M+(A<<20&4294967295|A>>>12),A=T+(M^L&(R^M))+P[13]+2850285829&4294967295,T=R+(A<<5&4294967295|A>>>27),A=L+(R^M&(T^R))+P[2]+4243563512&4294967295,L=T+(A<<9&4294967295|A>>>23),A=M+(T^R&(L^T))+P[7]+1735328473&4294967295,M=L+(A<<14&4294967295|A>>>18),A=R+(L^T&(M^L))+P[12]+2368359562&4294967295,R=M+(A<<20&4294967295|A>>>12),A=T+(R^M^L)+P[5]+4294588738&4294967295,T=R+(A<<4&4294967295|A>>>28),A=L+(T^R^M)+P[8]+2272392833&4294967295,L=T+(A<<11&4294967295|A>>>21),A=M+(L^T^R)+P[11]+1839030562&4294967295,M=L+(A<<16&4294967295|A>>>16),A=R+(M^L^T)+P[14]+4259657740&4294967295,R=M+(A<<23&4294967295|A>>>9),A=T+(R^M^L)+P[1]+2763975236&4294967295,T=R+(A<<4&4294967295|A>>>28),A=L+(T^R^M)+P[4]+1272893353&4294967295,L=T+(A<<11&4294967295|A>>>21),A=M+(L^T^R)+P[7]+4139469664&4294967295,M=L+(A<<16&4294967295|A>>>16),A=R+(M^L^T)+P[10]+3200236656&4294967295,R=M+(A<<23&4294967295|A>>>9),A=T+(R^M^L)+P[13]+681279174&4294967295,T=R+(A<<4&4294967295|A>>>28),A=L+(T^R^M)+P[0]+3936430074&4294967295,L=T+(A<<11&4294967295|A>>>21),A=M+(L^T^R)+P[3]+3572445317&4294967295,M=L+(A<<16&4294967295|A>>>16),A=R+(M^L^T)+P[6]+76029189&4294967295,R=M+(A<<23&4294967295|A>>>9),A=T+(R^M^L)+P[9]+3654602809&4294967295,T=R+(A<<4&4294967295|A>>>28),A=L+(T^R^M)+P[12]+3873151461&4294967295,L=T+(A<<11&4294967295|A>>>21),A=M+(L^T^R)+P[15]+530742520&4294967295,M=L+(A<<16&4294967295|A>>>16),A=R+(M^L^T)+P[2]+3299628645&4294967295,R=M+(A<<23&4294967295|A>>>9),A=T+(M^(R|~L))+P[0]+4096336452&4294967295,T=R+(A<<6&4294967295|A>>>26),A=L+(R^(T|~M))+P[7]+1126891415&4294967295,L=T+(A<<10&4294967295|A>>>22),A=M+(T^(L|~R))+P[14]+2878612391&4294967295,M=L+(A<<15&4294967295|A>>>17),A=R+(L^(M|~T))+P[5]+4237533241&4294967295,R=M+(A<<21&4294967295|A>>>11),A=T+(M^(R|~L))+P[12]+1700485571&4294967295,T=R+(A<<6&4294967295|A>>>26),A=L+(R^(T|~M))+P[3]+2399980690&4294967295,L=T+(A<<10&4294967295|A>>>22),A=M+(T^(L|~R))+P[10]+4293915773&4294967295,M=L+(A<<15&4294967295|A>>>17),A=R+(L^(M|~T))+P[1]+2240044497&4294967295,R=M+(A<<21&4294967295|A>>>11),A=T+(M^(R|~L))+P[8]+1873313359&4294967295,T=R+(A<<6&4294967295|A>>>26),A=L+(R^(T|~M))+P[15]+4264355552&4294967295,L=T+(A<<10&4294967295|A>>>22),A=M+(T^(L|~R))+P[6]+2734768916&4294967295,M=L+(A<<15&4294967295|A>>>17),A=R+(L^(M|~T))+P[13]+1309151649&4294967295,R=M+(A<<21&4294967295|A>>>11),A=T+(M^(R|~L))+P[4]+4149444226&4294967295,T=R+(A<<6&4294967295|A>>>26),A=L+(R^(T|~M))+P[11]+3174756917&4294967295,L=T+(A<<10&4294967295|A>>>22),A=M+(T^(L|~R))+P[2]+718787259&4294967295,M=L+(A<<15&4294967295|A>>>17),A=R+(L^(M|~T))+P[9]+3951481745&4294967295,j.g[0]=j.g[0]+T&4294967295,j.g[1]=j.g[1]+(M+(A<<21&4294967295|A>>>11))&4294967295,j.g[2]=j.g[2]+M&4294967295,j.g[3]=j.g[3]+L&4294967295}i.prototype.v=function(j,T){T===void 0&&(T=j.length);const R=T-this.blockSize,P=this.C;let M=this.h,L=0;for(;L<T;){if(M==0)for(;L<=R;)l(this,j,L),L+=this.blockSize;if(typeof j=="string"){for(;L<T;)if(P[M++]=j.charCodeAt(L++),M==this.blockSize){l(this,P),M=0;break}}else for(;L<T;)if(P[M++]=j[L++],M==this.blockSize){l(this,P),M=0;break}}this.h=M,this.o+=T},i.prototype.A=function(){var j=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);j[0]=128;for(var T=1;T<j.length-8;++T)j[T]=0;T=this.o*8;for(var R=j.length-8;R<j.length;++R)j[R]=T&255,T/=256;for(this.v(j),j=Array(16),T=0,R=0;R<4;++R)for(let P=0;P<32;P+=8)j[T++]=this.g[R]>>>P&255;return j};function u(j,T){var R=p;return Object.prototype.hasOwnProperty.call(R,j)?R[j]:R[j]=T(j)}function h(j,T){this.h=T;const R=[];let P=!0;for(let M=j.length-1;M>=0;M--){const L=j[M]|0;P&&L==T||(R[M]=L,P=!1)}this.g=R}var p={};function g(j){return-128<=j&&j<128?u(j,function(T){return new h([T|0],T<0?-1:0)}):new h([j|0],j<0?-1:0)}function y(j){if(isNaN(j)||!isFinite(j))return k;if(j<0)return B(y(-j));const T=[];let R=1;for(let P=0;j>=R;P++)T[P]=j/R|0,R*=4294967296;return new h(T,0)}function b(j,T){if(j.length==0)throw Error("number format error: empty string");if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(j.charAt(0)=="-")return B(b(j.substring(1),T));if(j.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=y(Math.pow(T,8));let P=k;for(let L=0;L<j.length;L+=8){var M=Math.min(8,j.length-L);const A=parseInt(j.substring(L,L+M),T);M<8?(M=y(Math.pow(T,M)),P=P.j(M).add(y(A))):(P=P.j(R),P=P.add(y(A)))}return P}var k=g(0),E=g(1),O=g(16777216);s=h.prototype,s.m=function(){if(q(this))return-B(this).m();let j=0,T=1;for(let R=0;R<this.g.length;R++){const P=this.i(R);j+=(P>=0?P:4294967296+P)*T,T*=4294967296}return j},s.toString=function(j){if(j=j||10,j<2||36<j)throw Error("radix out of range: "+j);if(H(this))return"0";if(q(this))return"-"+B(this).toString(j);const T=y(Math.pow(j,6));var R=this;let P="";for(;;){const M=fe(R,T).g;R=K(R,M.j(T));let L=((R.g.length>0?R.g[0]:R.h)>>>0).toString(j);if(R=M,H(R))return L+P;for(;L.length<6;)L="0"+L;P=L+P}},s.i=function(j){return j<0?0:j<this.g.length?this.g[j]:this.h};function H(j){if(j.h!=0)return!1;for(let T=0;T<j.g.length;T++)if(j.g[T]!=0)return!1;return!0}function q(j){return j.h==-1}s.l=function(j){return j=K(this,j),q(j)?-1:H(j)?0:1};function B(j){const T=j.g.length,R=[];for(let P=0;P<T;P++)R[P]=~j.g[P];return new h(R,~j.h).add(E)}s.abs=function(){return q(this)?B(this):this},s.add=function(j){const T=Math.max(this.g.length,j.g.length),R=[];let P=0;for(let M=0;M<=T;M++){let L=P+(this.i(M)&65535)+(j.i(M)&65535),A=(L>>>16)+(this.i(M)>>>16)+(j.i(M)>>>16);P=A>>>16,L&=65535,A&=65535,R[M]=A<<16|L}return new h(R,R[R.length-1]&-2147483648?-1:0)};function K(j,T){return j.add(B(T))}s.j=function(j){if(H(this)||H(j))return k;if(q(this))return q(j)?B(this).j(B(j)):B(B(this).j(j));if(q(j))return B(this.j(B(j)));if(this.l(O)<0&&j.l(O)<0)return y(this.m()*j.m());const T=this.g.length+j.g.length,R=[];for(var P=0;P<2*T;P++)R[P]=0;for(P=0;P<this.g.length;P++)for(let M=0;M<j.g.length;M++){const L=this.i(P)>>>16,A=this.i(P)&65535,Ve=j.i(M)>>>16,Qe=j.i(M)&65535;R[2*P+2*M]+=A*Qe,$(R,2*P+2*M),R[2*P+2*M+1]+=L*Qe,$(R,2*P+2*M+1),R[2*P+2*M+1]+=A*Ve,$(R,2*P+2*M+1),R[2*P+2*M+2]+=L*Ve,$(R,2*P+2*M+2)}for(j=0;j<T;j++)R[j]=R[2*j+1]<<16|R[2*j];for(j=T;j<2*T;j++)R[j]=0;return new h(R,0)};function $(j,T){for(;(j[T]&65535)!=j[T];)j[T+1]+=j[T]>>>16,j[T]&=65535,T++}function G(j,T){this.g=j,this.h=T}function fe(j,T){if(H(T))throw Error("division by zero");if(H(j))return new G(k,k);if(q(j))return T=fe(B(j),T),new G(B(T.g),B(T.h));if(q(T))return T=fe(j,B(T)),new G(B(T.g),T.h);if(j.g.length>30){if(q(j)||q(T))throw Error("slowDivide_ only works with positive integers.");for(var R=E,P=T;P.l(j)<=0;)R=xe(R),P=xe(P);var M=be(R,1),L=be(P,1);for(P=be(P,2),R=be(R,2);!H(P);){var A=L.add(P);A.l(j)<=0&&(M=M.add(R),L=A),P=be(P,1),R=be(R,1)}return T=K(j,M.j(T)),new G(M,T)}for(M=k;j.l(T)>=0;){for(R=Math.max(1,Math.floor(j.m()/T.m())),P=Math.ceil(Math.log(R)/Math.LN2),P=P<=48?1:Math.pow(2,P-48),L=y(R),A=L.j(T);q(A)||A.l(j)>0;)R-=P,L=y(R),A=L.j(T);H(L)&&(L=E),M=M.add(L),j=K(j,A)}return new G(M,j)}s.B=function(j){return fe(this,j).h},s.and=function(j){const T=Math.max(this.g.length,j.g.length),R=[];for(let P=0;P<T;P++)R[P]=this.i(P)&j.i(P);return new h(R,this.h&j.h)},s.or=function(j){const T=Math.max(this.g.length,j.g.length),R=[];for(let P=0;P<T;P++)R[P]=this.i(P)|j.i(P);return new h(R,this.h|j.h)},s.xor=function(j){const T=Math.max(this.g.length,j.g.length),R=[];for(let P=0;P<T;P++)R[P]=this.i(P)^j.i(P);return new h(R,this.h^j.h)};function xe(j){const T=j.g.length+1,R=[];for(let P=0;P<T;P++)R[P]=j.i(P)<<1|j.i(P-1)>>>31;return new h(R,j.h)}function be(j,T){const R=T>>5;T%=32;const P=j.g.length-R,M=[];for(let L=0;L<P;L++)M[L]=T>0?j.i(L+R)>>>T|j.i(L+R+1)<<32-T:j.i(L+R);return new h(M,j.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,Ex=i,h.prototype.add=h.prototype.add,h.prototype.multiply=h.prototype.j,h.prototype.modulo=h.prototype.B,h.prototype.compare=h.prototype.l,h.prototype.toNumber=h.prototype.m,h.prototype.toString=h.prototype.toString,h.prototype.getBits=h.prototype.i,h.fromNumber=y,h.fromString=b,Ya=h}).apply(typeof D2<"u"?D2:typeof self<"u"?self:typeof window<"u"?window:{});var rd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Tx,Zc,Sx,kd,Eg,jx,Cx,Nx;(function(){var s,e=Object.defineProperty;function t(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof rd=="object"&&rd];for(var v=0;v<d.length;++v){var x=d[v];if(x&&x.Math==Math)return x}throw Error("Cannot find global object")}var i=t(this);function l(d,v){if(v)e:{var x=i;d=d.split(".");for(var N=0;N<d.length-1;N++){var Q=d[N];if(!(Q in x))break e;x=x[Q]}d=d[d.length-1],N=x[d],v=v(N),v!=N&&v!=null&&e(x,d,{configurable:!0,writable:!0,value:v})}}l("Symbol.dispose",function(d){return d||Symbol("Symbol.dispose")}),l("Array.prototype.values",function(d){return d||function(){return this[Symbol.iterator]()}}),l("Object.entries",function(d){return d||function(v){var x=[],N;for(N in v)Object.prototype.hasOwnProperty.call(v,N)&&x.push([N,v[N]]);return x}});var u=u||{},h=this||self;function p(d){var v=typeof d;return v=="object"&&d!=null||v=="function"}function g(d,v,x){return d.call.apply(d.bind,arguments)}function y(d,v,x){return y=g,y.apply(null,arguments)}function b(d,v){var x=Array.prototype.slice.call(arguments,1);return function(){var N=x.slice();return N.push.apply(N,arguments),d.apply(this,N)}}function k(d,v){function x(){}x.prototype=v.prototype,d.Z=v.prototype,d.prototype=new x,d.prototype.constructor=d,d.Ob=function(N,Q,ce){for(var De=Array(arguments.length-2),Mt=2;Mt<arguments.length;Mt++)De[Mt-2]=arguments[Mt];return v.prototype[Q].apply(N,De)}}var E=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?d=>d&&AsyncContext.Snapshot.wrap(d):d=>d;function O(d){const v=d.length;if(v>0){const x=Array(v);for(let N=0;N<v;N++)x[N]=d[N];return x}return[]}function H(d,v){for(let N=1;N<arguments.length;N++){const Q=arguments[N];var x=typeof Q;if(x=x!="object"?x:Q?Array.isArray(Q)?"array":x:"null",x=="array"||x=="object"&&typeof Q.length=="number"){x=d.length||0;const ce=Q.length||0;d.length=x+ce;for(let De=0;De<ce;De++)d[x+De]=Q[De]}else d.push(Q)}}class q{constructor(v,x){this.i=v,this.j=x,this.h=0,this.g=null}get(){let v;return this.h>0?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function B(d){h.setTimeout(()=>{throw d},0)}function K(){var d=j;let v=null;return d.g&&(v=d.g,d.g=d.g.next,d.g||(d.h=null),v.next=null),v}class ${constructor(){this.h=this.g=null}add(v,x){const N=G.get();N.set(v,x),this.h?this.h.next=N:this.g=N,this.h=N}}var G=new q(()=>new fe,d=>d.reset());class fe{constructor(){this.next=this.g=this.h=null}set(v,x){this.h=v,this.g=x,this.next=null}reset(){this.next=this.g=this.h=null}}let xe,be=!1,j=new $,T=()=>{const d=Promise.resolve(void 0);xe=()=>{d.then(R)}};function R(){for(var d;d=K();){try{d.h.call(d.g)}catch(x){B(x)}var v=G;v.j(d),v.h<100&&(v.h++,d.next=v.g,v.g=d)}be=!1}function P(){this.u=this.u,this.C=this.C}P.prototype.u=!1,P.prototype.dispose=function(){this.u||(this.u=!0,this.N())},P.prototype[Symbol.dispose]=function(){this.dispose()},P.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function M(d,v){this.type=d,this.g=this.target=v,this.defaultPrevented=!1}M.prototype.h=function(){this.defaultPrevented=!0};var L=(function(){if(!h.addEventListener||!Object.defineProperty)return!1;var d=!1,v=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const x=()=>{};h.addEventListener("test",x,v),h.removeEventListener("test",x,v)}catch{}return d})();function A(d){return/^[\s\xa0]*$/.test(d)}function Ve(d,v){M.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d&&this.init(d,v)}k(Ve,M),Ve.prototype.init=function(d,v){const x=this.type=d.type,N=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;this.target=d.target||d.srcElement,this.g=v,v=d.relatedTarget,v||(x=="mouseover"?v=d.fromElement:x=="mouseout"&&(v=d.toElement)),this.relatedTarget=v,N?(this.clientX=N.clientX!==void 0?N.clientX:N.pageX,this.clientY=N.clientY!==void 0?N.clientY:N.pageY,this.screenX=N.screenX||0,this.screenY=N.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=d.pointerType,this.state=d.state,this.i=d,d.defaultPrevented&&Ve.Z.h.call(this)},Ve.prototype.h=function(){Ve.Z.h.call(this);const d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var Qe="closure_listenable_"+(Math.random()*1e6|0),Z=0;function ue(d,v,x,N,Q){this.listener=d,this.proxy=null,this.src=v,this.type=x,this.capture=!!N,this.ha=Q,this.key=++Z,this.da=this.fa=!1}function Ce(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function Pe(d,v,x){for(const N in d)v.call(x,d[N],N,d)}function se(d,v){for(const x in d)v.call(void 0,d[x],x,d)}function D(d){const v={};for(const x in d)v[x]=d[x];return v}const ne="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ve(d,v){let x,N;for(let Q=1;Q<arguments.length;Q++){N=arguments[Q];for(x in N)d[x]=N[x];for(let ce=0;ce<ne.length;ce++)x=ne[ce],Object.prototype.hasOwnProperty.call(N,x)&&(d[x]=N[x])}}function Ee(d){this.src=d,this.g={},this.h=0}Ee.prototype.add=function(d,v,x,N,Q){const ce=d.toString();d=this.g[ce],d||(d=this.g[ce]=[],this.h++);const De=Se(d,v,N,Q);return De>-1?(v=d[De],x||(v.fa=!1)):(v=new ue(v,this.src,ce,!!N,Q),v.fa=x,d.push(v)),v};function Te(d,v){const x=v.type;if(x in d.g){var N=d.g[x],Q=Array.prototype.indexOf.call(N,v,void 0),ce;(ce=Q>=0)&&Array.prototype.splice.call(N,Q,1),ce&&(Ce(v),d.g[x].length==0&&(delete d.g[x],d.h--))}}function Se(d,v,x,N){for(let Q=0;Q<d.length;++Q){const ce=d[Q];if(!ce.da&&ce.listener==v&&ce.capture==!!x&&ce.ha==N)return Q}return-1}var Ke="closure_lm_"+(Math.random()*1e6|0),ct={};function Be(d,v,x,N,Q){if(Array.isArray(v)){for(let ce=0;ce<v.length;ce++)Be(d,v[ce],x,N,Q);return null}return x=he(x),d&&d[Qe]?d.J(v,x,p(N)?!!N.capture:!1,Q):sn(d,v,x,!1,N,Q)}function sn(d,v,x,N,Q,ce){if(!v)throw Error("Invalid event type");const De=p(Q)?!!Q.capture:!!Q;let Mt=ut(d);if(Mt||(d[Ke]=Mt=new Ee(d)),x=Mt.add(v,x,N,De,ce),x.proxy)return x;if(N=Nn(),x.proxy=N,N.src=d,N.listener=x,d.addEventListener)L||(Q=De),Q===void 0&&(Q=!1),d.addEventListener(v.toString(),N,Q);else if(d.attachEvent)d.attachEvent(rt(v.toString()),N);else if(d.addListener&&d.removeListener)d.addListener(N);else throw Error("addEventListener and attachEvent are unavailable.");return x}function Nn(){function d(x){return v.call(d.src,d.listener,x)}const v=gt;return d}function Un(d,v,x,N,Q){if(Array.isArray(v))for(var ce=0;ce<v.length;ce++)Un(d,v[ce],x,N,Q);else N=p(N)?!!N.capture:!!N,x=he(x),d&&d[Qe]?(d=d.i,ce=String(v).toString(),ce in d.g&&(v=d.g[ce],x=Se(v,x,N,Q),x>-1&&(Ce(v[x]),Array.prototype.splice.call(v,x,1),v.length==0&&(delete d.g[ce],d.h--)))):d&&(d=ut(d))&&(v=d.g[v.toString()],d=-1,v&&(d=Se(v,x,N,Q)),(x=d>-1?v[d]:null)&&Ot(x))}function Ot(d){if(typeof d!="number"&&d&&!d.da){var v=d.src;if(v&&v[Qe])Te(v.i,d);else{var x=d.type,N=d.proxy;v.removeEventListener?v.removeEventListener(x,N,d.capture):v.detachEvent?v.detachEvent(rt(x),N):v.addListener&&v.removeListener&&v.removeListener(N),(x=ut(v))?(Te(x,d),x.h==0&&(x.src=null,v[Ke]=null)):Ce(d)}}}function rt(d){return d in ct?ct[d]:ct[d]="on"+d}function gt(d,v){if(d.da)d=!0;else{v=new Ve(v,this);const x=d.listener,N=d.ha||d.src;d.fa&&Ot(d),d=x.call(N,v)}return d}function ut(d){return d=d[Ke],d instanceof Ee?d:null}var Bn="__closure_events_fn_"+(Math.random()*1e9>>>0);function he(d){return typeof d=="function"?d:(d[Bn]||(d[Bn]=function(v){return d.handleEvent(v)}),d[Bn])}function Dt(){P.call(this),this.i=new Ee(this),this.M=this,this.G=null}k(Dt,P),Dt.prototype[Qe]=!0,Dt.prototype.removeEventListener=function(d,v,x,N){Un(this,d,v,x,N)};function yt(d,v){var x,N=d.G;if(N)for(x=[];N;N=N.G)x.push(N);if(d=d.M,N=v.type||v,typeof v=="string")v=new M(v,d);else if(v instanceof M)v.target=v.target||d;else{var Q=v;v=new M(N,d),ve(v,Q)}Q=!0;let ce,De;if(x)for(De=x.length-1;De>=0;De--)ce=v.g=x[De],Q=Bt(ce,N,!0,v)&&Q;if(ce=v.g=d,Q=Bt(ce,N,!0,v)&&Q,Q=Bt(ce,N,!1,v)&&Q,x)for(De=0;De<x.length;De++)ce=v.g=x[De],Q=Bt(ce,N,!1,v)&&Q}Dt.prototype.N=function(){if(Dt.Z.N.call(this),this.i){var d=this.i;for(const v in d.g){const x=d.g[v];for(let N=0;N<x.length;N++)Ce(x[N]);delete d.g[v],d.h--}}this.G=null},Dt.prototype.J=function(d,v,x,N){return this.i.add(String(d),v,!1,x,N)},Dt.prototype.K=function(d,v,x,N){return this.i.add(String(d),v,!0,x,N)};function Bt(d,v,x,N){if(v=d.i.g[String(v)],!v)return!0;v=v.concat();let Q=!0;for(let ce=0;ce<v.length;++ce){const De=v[ce];if(De&&!De.da&&De.capture==x){const Mt=De.listener,ls=De.ha||De.src;De.fa&&Te(d.i,De),Q=Mt.call(ls,N)!==!1&&Q}}return Q&&!N.defaultPrevented}function et(d,v){if(typeof d!="function")if(d&&typeof d.handleEvent=="function")d=y(d.handleEvent,d);else throw Error("Invalid listener argument");return Number(v)>2147483647?-1:h.setTimeout(d,v||0)}function It(d){d.g=et(()=>{d.g=null,d.i&&(d.i=!1,It(d))},d.l);const v=d.h;d.h=null,d.m.apply(null,v)}class vt extends P{constructor(v,x){super(),this.m=v,this.l=x,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:It(this)}N(){super.N(),this.g&&(h.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function rn(d){P.call(this),this.h=d,this.g={}}k(rn,P);var Cs=[];function rs(d){Pe(d.g,function(v,x){this.g.hasOwnProperty(x)&&Ot(v)},d),d.g={}}rn.prototype.N=function(){rn.Z.N.call(this),rs(this)},rn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Jt=h.JSON.stringify,re=h.JSON.parse,Ae=class{stringify(d){return h.JSON.stringify(d,void 0)}parse(d){return h.JSON.parse(d,void 0)}};function kt(){}function bt(){}var it={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function $e(){M.call(this,"d")}k($e,M);function st(){M.call(this,"c")}k(st,M);var Fe={},an=null;function un(){return an=an||new Dt}Fe.Ia="serverreachability";function Ln(d){M.call(this,Fe.Ia,d)}k(Ln,M);function zn(d){const v=un();yt(v,new Ln(v))}Fe.STAT_EVENT="statevent";function Xn(d,v){M.call(this,Fe.STAT_EVENT,d),this.stat=v}k(Xn,M);function Qt(d){const v=un();yt(v,new Xn(v,d))}Fe.Ja="timingevent";function Fn(d,v){M.call(this,Fe.Ja,d),this.size=v}k(Fn,M);function An(d,v){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return h.setTimeout(function(){d()},v)}function hn(){this.g=!0}hn.prototype.ua=function(){this.g=!1};function yr(d,v,x,N,Q,ce){d.info(function(){if(d.g)if(ce){var De="",Mt=ce.split("&");for(let fn=0;fn<Mt.length;fn++){var ls=Mt[fn].split("=");if(ls.length>1){const $n=ls[0];ls=ls[1];const Pr=$n.split("_");De=Pr.length>=2&&Pr[1]=="type"?De+($n+"="+ls+"&"):De+($n+"=redacted&")}}}else De=null;else De=ce;return"XMLHTTP REQ ("+N+") [attempt "+Q+"]: "+v+`
`+x+`
`+De})}function oe(d,v,x,N,Q,ce,De){d.info(function(){return"XMLHTTP RESP ("+N+") [ attempt "+Q+"]: "+v+`
`+x+`
`+ce+" "+De})}function Re(d,v,x,N){d.info(function(){return"XMLHTTP TEXT ("+v+"): "+mt(d,x)+(N?" "+N:"")})}function Ge(d,v){d.info(function(){return"TIMEOUT: "+v})}hn.prototype.info=function(){};function mt(d,v){if(!d.g)return v;if(!v)return null;try{const ce=JSON.parse(v);if(ce){for(d=0;d<ce.length;d++)if(Array.isArray(ce[d])){var x=ce[d];if(!(x.length<2)){var N=x[1];if(Array.isArray(N)&&!(N.length<1)){var Q=N[0];if(Q!="noop"&&Q!="stop"&&Q!="close")for(let De=1;De<N.length;De++)N[De]=""}}}}return Jt(ce)}catch{return v}}var lt={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},_n={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Rn;function pn(){}k(pn,kt),pn.prototype.g=function(){return new XMLHttpRequest},Rn=new pn;function xn(d){return encodeURIComponent(String(d))}function Ns(d){var v=1;d=d.split(":");const x=[];for(;v>0&&d.length;)x.push(d.shift()),v--;return d.length&&x.push(d.join(":")),x}function is(d,v,x,N){this.j=d,this.i=v,this.l=x,this.S=N||1,this.V=new rn(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new ds}function ds(){this.i=null,this.g="",this.h=!1}var Zt={},In={};function As(d,v,x){d.M=1,d.A=Kn(Me(v)),d.u=x,d.R=!0,Ar(d,null)}function Ar(d,v){d.F=Date.now(),qn(d),d.B=Me(d.A);var x=d.B,N=d.S;Array.isArray(N)||(N=[String(N)]),Ue(x.i,"t",N),d.C=0,x=d.j.L,d.h=new ds,d.g=Yu(d.j,x?v:null,!d.u),d.P>0&&(d.O=new vt(y(d.Y,d,d.g),d.P)),v=d.V,x=d.g,N=d.ba;var Q="readystatechange";Array.isArray(Q)||(Q&&(Cs[0]=Q.toString()),Q=Cs);for(let ce=0;ce<Q.length;ce++){const De=Be(x,Q[ce],N||v.handleEvent,!1,v.h||v);if(!De)break;v.g[De.key]=De}v=d.J?D(d.J):{},d.u?(d.v||(d.v="POST"),v["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.B,d.v,d.u,v)):(d.v="GET",d.g.ea(d.B,d.v,null,v)),zn(),yr(d.i,d.v,d.B,d.l,d.S,d.u)}is.prototype.ba=function(d){d=d.target;const v=this.O;v&&dn(d)==3?v.j():this.Y(d)},is.prototype.Y=function(d){try{if(d==this.g)e:{const Mt=dn(this.g),ls=this.g.ya(),fn=this.g.ca();if(!(Mt<3)&&(Mt!=3||this.g&&(this.h.h||this.g.la()||Dn(this.g)))){this.K||Mt!=4||ls==7||(ls==8||fn<=0?zn(3):zn(2)),_s(this);var v=this.g.ca();this.X=v;var x=fi(this);if(this.o=v==200,oe(this.i,this.v,this.B,this.l,this.S,Mt,v),this.o){if(this.U&&!this.L){t:{if(this.g){var N,Q=this.g;if((N=Q.g?Q.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!A(N)){var ce=N;break t}}ce=null}if(d=ce)Re(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,as(this,d);else{this.o=!1,this.m=3,Qt(12),On(this),Sn(this);break e}}if(this.R){d=!0;let $n;for(;!this.K&&this.C<x.length;)if($n=Ir(this,x),$n==In){Mt==4&&(this.m=4,Qt(14),d=!1),Re(this.i,this.l,null,"[Incomplete Response]");break}else if($n==Zt){this.m=4,Qt(15),Re(this.i,this.l,x,"[Invalid Chunk]"),d=!1;break}else Re(this.i,this.l,$n,null),as(this,$n);if(Rr(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Mt!=4||x.length!=0||this.h.h||(this.m=1,Qt(16),d=!1),this.o=this.o&&d,!d)Re(this.i,this.l,x,"[Invalid Chunked Response]"),On(this),Sn(this);else if(x.length>0&&!this.W){this.W=!0;var De=this.j;De.g==this&&De.aa&&!De.P&&(De.j.info("Great, no buffering proxy detected. Bytes received: "+x.length),ac(De),De.P=!0,Qt(11))}}else Re(this.i,this.l,x,null),as(this,x);Mt==4&&On(this),this.o&&!this.K&&(Mt==4?$u(this.j,this):(this.o=!1,qn(this)))}else zs(this.g),v==400&&x.indexOf("Unknown SID")>0?(this.m=3,Qt(12)):(this.m=0,Qt(13)),On(this),Sn(this)}}}catch{}};function fi(d){if(!Rr(d))return d.g.la();const v=Dn(d.g);if(v==="")return"";let x="";const N=v.length,Q=dn(d.g)==4;if(!d.h.i){if(typeof TextDecoder>"u")return On(d),Sn(d),"";d.h.i=new h.TextDecoder}for(let ce=0;ce<N;ce++)d.h.h=!0,x+=d.h.i.decode(v[ce],{stream:!(Q&&ce==N-1)});return v.length=0,d.h.g+=x,d.C=0,d.h.g}function Rr(d){return d.g?d.v=="GET"&&d.M!=2&&d.j.Aa:!1}function Ir(d,v){var x=d.C,N=v.indexOf(`
`,x);return N==-1?In:(x=Number(v.substring(x,N)),isNaN(x)?Zt:(N+=1,N+x>v.length?In:(v=v.slice(N,N+x),d.C=N+x,v)))}is.prototype.cancel=function(){this.K=!0,On(this)};function qn(d){d.T=Date.now()+d.H,Ys(d,d.H)}function Ys(d,v){if(d.D!=null)throw Error("WatchDog timer not null");d.D=An(y(d.aa,d),v)}function _s(d){d.D&&(h.clearTimeout(d.D),d.D=null)}is.prototype.aa=function(){this.D=null;const d=Date.now();d-this.T>=0?(Ge(this.i,this.B),this.M!=2&&(zn(),Qt(17)),On(this),this.m=2,Sn(this)):Ys(this,this.T-d)};function Sn(d){d.j.I==0||d.K||$u(d.j,d)}function On(d){_s(d);var v=d.O;v&&typeof v.dispose=="function"&&v.dispose(),d.O=null,rs(d.V),d.g&&(v=d.g,d.g=null,v.abort(),v.dispose())}function as(d,v){try{var x=d.j;if(x.I!=0&&(x.g==d||vn(x.h,d))){if(!d.L&&vn(x.h,d)&&x.I==3){try{var N=x.Ba.g.parse(v)}catch{N=null}if(Array.isArray(N)&&N.length==3){var Q=N;if(Q[0]==0){e:if(!x.v){if(x.g)if(x.g.F+3e3<d.F)Jo(x),or(x);else break e;lo(x),Qt(18)}}else x.xa=Q[1],0<x.xa-x.K&&Q[2]<37500&&x.F&&x.A==0&&!x.C&&(x.C=An(y(x.Va,x),6e3));xs(x.h)<=1&&x.ta&&(x.ta=void 0)}else gi(x,11)}else if((d.L||x.g==d)&&Jo(x),!A(v))for(Q=x.Ba.g.parse(v),v=0;v<Q.length;v++){let fn=Q[v];const $n=fn[0];if(!($n<=x.K))if(x.K=$n,fn=fn[1],x.I==2)if(fn[0]=="c"){x.M=fn[1],x.ba=fn[2];const Pr=fn[3];Pr!=null&&(x.ka=Pr,x.j.info("VER="+x.ka));const yi=fn[4];yi!=null&&(x.za=yi,x.j.info("SVER="+x.za));const Zr=fn[5];Zr!=null&&typeof Zr=="number"&&Zr>0&&(N=1.5*Zr,x.O=N,x.j.info("backChannelRequestTimeoutMs_="+N)),N=x;const ei=d.g;if(ei){const co=ei.g?ei.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(co){var ce=N.h;ce.g||co.indexOf("spdy")==-1&&co.indexOf("quic")==-1&&co.indexOf("h2")==-1||(ce.j=ce.l,ce.g=new Set,ce.h&&(ar(ce,ce.h),ce.h=null))}if(N.G){const Zo=ei.g?ei.g.getResponseHeader("X-HTTP-Session-Id"):null;Zo&&(N.wa=Zo,Ye(N.J,N.G,Zo))}}x.I=3,x.l&&x.l.ra(),x.aa&&(x.T=Date.now()-d.F,x.j.info("Handshake RTT: "+x.T+"ms")),N=x;var De=d;if(N.na=Ku(N,N.L?N.ba:null,N.W),De.L){mi(N.h,De);var Mt=De,ls=N.O;ls&&(Mt.H=ls),Mt.D&&(_s(Mt),qn(Mt)),N.g=De}else qu(N);x.i.length>0&&Or(x)}else fn[0]!="stop"&&fn[0]!="close"||gi(x,7);else x.I==3&&(fn[0]=="stop"||fn[0]=="close"?fn[0]=="stop"?gi(x,7):Qs(x):fn[0]!="noop"&&x.l&&x.l.qa(fn),x.A=0)}}zn(4)}catch{}}var qt=class{constructor(d,v){this.g=d,this.map=v}};function Jr(d){this.l=d||10,h.PerformanceNavigationTiming?(d=h.performance.getEntriesByType("navigation"),d=d.length>0&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(h.chrome&&h.chrome.loadTimes&&h.chrome.loadTimes()&&h.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Dr(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function xs(d){return d.h?1:d.g?d.g.size:0}function vn(d,v){return d.h?d.h==v:d.g?d.g.has(v):!1}function ar(d,v){d.g?d.g.add(v):d.h=v}function mi(d,v){d.h&&d.h==v?d.h=null:d.g&&d.g.has(v)&&d.g.delete(v)}Jr.prototype.cancel=function(){if(this.i=I(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function I(d){if(d.h!=null)return d.i.concat(d.h.G);if(d.g!=null&&d.g.size!==0){let v=d.i;for(const x of d.g.values())v=v.concat(x.G);return v}return O(d.i)}var z=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ae(d,v){if(d){d=d.split("&");for(let x=0;x<d.length;x++){const N=d[x].indexOf("=");let Q,ce=null;N>=0?(Q=d[x].substring(0,N),ce=d[x].substring(N+1)):Q=d[x],v(Q,ce?decodeURIComponent(ce.replace(/\+/g," ")):"")}}}function le(d){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let v;d instanceof le?(this.l=d.l,Le(this,d.j),this.o=d.o,this.g=d.g,He(this,d.u),this.h=d.h,Ht(this,ht(d.i)),this.m=d.m):d&&(v=String(d).match(z))?(this.l=!1,Le(this,v[1]||"",!0),this.o=os(v[2]||""),this.g=os(v[3]||"",!0),He(this,v[4]),this.h=os(v[5]||"",!0),Ht(this,v[6]||"",!0),this.m=os(v[7]||"")):(this.l=!1,this.i=new Lr(null,this.l))}le.prototype.toString=function(){const d=[];var v=this.j;v&&d.push(Us(v,vr,!0),":");var x=this.g;return(x||v=="file")&&(d.push("//"),(v=this.o)&&d.push(Us(v,vr,!0),"@"),d.push(xn(x).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),x=this.u,x!=null&&d.push(":",String(x))),(x=this.h)&&(this.g&&x.charAt(0)!="/"&&d.push("/"),d.push(Us(x,x.charAt(0)=="/"?Di:ma,!0))),(x=this.i.toString())&&d.push("?",x),(x=this.m)&&d.push("#",Us(x,pa)),d.join("")},le.prototype.resolve=function(d){const v=Me(this);let x=!!d.j;x?Le(v,d.j):x=!!d.o,x?v.o=d.o:x=!!d.g,x?v.g=d.g:x=d.u!=null;var N=d.h;if(x)He(v,d.u);else if(x=!!d.h){if(N.charAt(0)!="/")if(this.g&&!this.h)N="/"+N;else{var Q=v.h.lastIndexOf("/");Q!=-1&&(N=v.h.slice(0,Q+1)+N)}if(Q=N,Q==".."||Q==".")N="";else if(Q.indexOf("./")!=-1||Q.indexOf("/.")!=-1){N=Q.lastIndexOf("/",0)==0,Q=Q.split("/");const ce=[];for(let De=0;De<Q.length;){const Mt=Q[De++];Mt=="."?N&&De==Q.length&&ce.push(""):Mt==".."?((ce.length>1||ce.length==1&&ce[0]!="")&&ce.pop(),N&&De==Q.length&&ce.push("")):(ce.push(Mt),N=!0)}N=ce.join("/")}else N=Q}return x?v.h=N:x=d.i.toString()!=="",x?Ht(v,ht(d.i)):x=!!d.m,x&&(v.m=d.m),v};function Me(d){return new le(d)}function Le(d,v,x){d.j=x?os(v,!0):v,d.j&&(d.j=d.j.replace(/:$/,""))}function He(d,v){if(v){if(v=Number(v),isNaN(v)||v<0)throw Error("Bad port number "+v);d.u=v}else d.u=null}function Ht(d,v,x){v instanceof Lr?(d.i=v,St(d.i,d.l)):(x||(v=Us(v,Mr)),d.i=new Lr(v,d.l))}function Ye(d,v,x){d.i.set(v,x)}function Kn(d){return Ye(d,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),d}function os(d,v){return d?v?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function Us(d,v,x){return typeof d=="string"?(d=encodeURI(d).replace(v,Yn),x&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function Yn(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var vr=/[#\/\?@]/g,ma=/[#\?:]/g,Di=/[#\?]/g,Mr=/[#\?@]/g,pa=/#/g;function Lr(d,v){this.h=this.g=null,this.i=d||null,this.j=!!v}function C(d){d.g||(d.g=new Map,d.h=0,d.i&&ae(d.i,function(v,x){d.add(decodeURIComponent(v.replace(/\+/g," ")),x)}))}s=Lr.prototype,s.add=function(d,v){C(this),this.i=null,d=tt(this,d);let x=this.g.get(d);return x||this.g.set(d,x=[]),x.push(v),this.h+=1,this};function Y(d,v){C(d),v=tt(d,v),d.g.has(v)&&(d.i=null,d.h-=d.g.get(v).length,d.g.delete(v))}function Ne(d,v){return C(d),v=tt(d,v),d.g.has(v)}s.forEach=function(d,v){C(this),this.g.forEach(function(x,N){x.forEach(function(Q){d.call(v,Q,N,this)},this)},this)};function Ie(d,v){C(d);let x=[];if(typeof v=="string")Ne(d,v)&&(x=x.concat(d.g.get(tt(d,v))));else for(d=Array.from(d.g.values()),v=0;v<d.length;v++)x=x.concat(d[v]);return x}s.set=function(d,v){return C(this),this.i=null,d=tt(this,d),Ne(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[v]),this.h+=1,this},s.get=function(d,v){return d?(d=Ie(this,d),d.length>0?String(d[0]):v):v};function Ue(d,v,x){Y(d,v),x.length>0&&(d.i=null,d.g.set(tt(d,v),O(x)),d.h+=x.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],v=Array.from(this.g.keys());for(let N=0;N<v.length;N++){var x=v[N];const Q=xn(x);x=Ie(this,x);for(let ce=0;ce<x.length;ce++){let De=Q;x[ce]!==""&&(De+="="+xn(x[ce])),d.push(De)}}return this.i=d.join("&")};function ht(d){const v=new Lr;return v.i=d.i,d.g&&(v.g=new Map(d.g),v.h=d.h),v}function tt(d,v){return v=String(v),d.j&&(v=v.toLowerCase()),v}function St(d,v){v&&!d.j&&(C(d),d.i=null,d.g.forEach(function(x,N){const Q=N.toLowerCase();N!=Q&&(Y(this,N),Ue(this,Q,x))},d)),d.j=v}function dt(d,v){const x=new hn;if(h.Image){const N=new Image;N.onload=b(X,x,"TestLoadImage: loaded",!0,v,N),N.onerror=b(X,x,"TestLoadImage: error",!1,v,N),N.onabort=b(X,x,"TestLoadImage: abort",!1,v,N),N.ontimeout=b(X,x,"TestLoadImage: timeout",!1,v,N),h.setTimeout(function(){N.ontimeout&&N.ontimeout()},1e4),N.src=d}else v(!1)}function V(d,v){const x=new hn,N=new AbortController,Q=setTimeout(()=>{N.abort(),X(x,"TestPingServer: timeout",!1,v)},1e4);fetch(d,{signal:N.signal}).then(ce=>{clearTimeout(Q),ce.ok?X(x,"TestPingServer: ok",!0,v):X(x,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(Q),X(x,"TestPingServer: error",!1,v)})}function X(d,v,x,N,Q){try{Q&&(Q.onload=null,Q.onerror=null,Q.onabort=null,Q.ontimeout=null),N(x)}catch{}}function ee(){this.g=new Ae}function ge(d){this.i=d.Sb||null,this.h=d.ab||!1}k(ge,kt),ge.prototype.g=function(){return new je(this.i,this.h)};function je(d,v){Dt.call(this),this.H=d,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}k(je,Dt),s=je.prototype,s.open=function(d,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=d,this.D=v,this.readyState=1,pt(this)},s.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const v={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};d&&(v.body=d),(this.H||h).fetch(new Request(this.D,v)).then(this.Pa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,qe(this)),this.readyState=0},s.Pa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,pt(this)),this.g&&(this.readyState=3,pt(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof h.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Oe(this)}else d.text().then(this.Oa.bind(this),this.ga.bind(this))};function Oe(d){d.j.read().then(d.Ma.bind(d)).catch(d.ga.bind(d))}s.Ma=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var v=d.value?d.value:new Uint8Array(0);(v=this.B.decode(v,{stream:!d.done}))&&(this.response=this.responseText+=v)}d.done?qe(this):pt(this),this.readyState==3&&Oe(this)}},s.Oa=function(d){this.g&&(this.response=this.responseText=d,qe(this))},s.Na=function(d){this.g&&(this.response=d,qe(this))},s.ga=function(){this.g&&qe(this)};function qe(d){d.readyState=4,d.l=null,d.j=null,d.B=null,pt(d)}s.setRequestHeader=function(d,v){this.A.append(d,v)},s.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],v=this.h.entries();for(var x=v.next();!x.done;)x=x.value,d.push(x[0]+": "+x[1]),x=v.next();return d.join(`\r
`)};function pt(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(je.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function Et(d){let v="";return Pe(d,function(x,N){v+=N,v+=":",v+=x,v+=`\r
`}),v}function Ut(d,v,x){e:{for(N in x){var N=!1;break e}N=!0}N||(x=Et(x),typeof d=="string"?x!=null&&xn(x):Ye(d,v,x))}function Xe(d){Dt.call(this),this.headers=new Map,this.L=d||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}k(Xe,Dt);var en=/^https?$/i,Bs=["POST","PUT"];s=Xe.prototype,s.Fa=function(d){this.H=d},s.ea=function(d,v,x,N){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);v=v?v.toUpperCase():"GET",this.D=d,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Rn.g(),this.g.onreadystatechange=E(y(this.Ca,this));try{this.B=!0,this.g.open(v,String(d),!0),this.B=!1}catch(ce){Tt(this,ce);return}if(d=x||"",x=new Map(this.headers),N)if(Object.getPrototypeOf(N)===Object.prototype)for(var Q in N)x.set(Q,N[Q]);else if(typeof N.keys=="function"&&typeof N.get=="function")for(const ce of N.keys())x.set(ce,N.get(ce));else throw Error("Unknown input type for opt_headers: "+String(N));N=Array.from(x.keys()).find(ce=>ce.toLowerCase()=="content-type"),Q=h.FormData&&d instanceof h.FormData,!(Array.prototype.indexOf.call(Bs,v,void 0)>=0)||N||Q||x.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ce,De]of x)this.g.setRequestHeader(ce,De);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(d),this.v=!1}catch(ce){Tt(this,ce)}};function Tt(d,v){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=v,d.o=5,Hn(d),jt(d)}function Hn(d){d.A||(d.A=!0,yt(d,"complete"),yt(d,"error"))}s.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=d||7,yt(this,"complete"),yt(this,"abort"),jt(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),jt(this,!0)),Xe.Z.N.call(this)},s.Ca=function(){this.u||(this.B||this.v||this.j?Jn(this):this.Xa())},s.Xa=function(){Jn(this)};function Jn(d){if(d.h&&typeof u<"u"){if(d.v&&dn(d)==4)setTimeout(d.Ca.bind(d),0);else if(yt(d,"readystatechange"),dn(d)==4){d.h=!1;try{const ce=d.ca();e:switch(ce){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var x;if(!(x=v)){var N;if(N=ce===0){let De=String(d.D).match(z)[1]||null;!De&&h.self&&h.self.location&&(De=h.self.location.protocol.slice(0,-1)),N=!en.test(De?De.toLowerCase():"")}x=N}if(x)yt(d,"complete"),yt(d,"success");else{d.o=6;try{var Q=dn(d)>2?d.g.statusText:""}catch{Q=""}d.l=Q+" ["+d.ca()+"]",Hn(d)}}finally{jt(d)}}}}function jt(d,v){if(d.g){d.m&&(clearTimeout(d.m),d.m=null);const x=d.g;d.g=null,v||yt(d,"ready");try{x.onreadystatechange=null}catch{}}}s.isActive=function(){return!!this.g};function dn(d){return d.g?d.g.readyState:0}s.ca=function(){try{return dn(this)>2?this.g.status:-1}catch{return-1}},s.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.La=function(d){if(this.g){var v=this.g.responseText;return d&&v.indexOf(d)==0&&(v=v.substring(d.length)),re(v)}};function Dn(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.F){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function zs(d){const v={};d=(d.g&&dn(d)>=2&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let N=0;N<d.length;N++){if(A(d[N]))continue;var x=Ns(d[N]);const Q=x[0];if(x=x[1],typeof x!="string")continue;x=x.trim();const ce=v[Q]||[];v[Q]=ce,ce.push(x)}se(v,function(N){return N.join(", ")})}s.ya=function(){return this.o},s.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Fs(d,v,x){return x&&x.internalChannelParams&&x.internalChannelParams[d]||v}function fs(d){this.za=0,this.i=[],this.j=new hn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Fs("failFast",!1,d),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Fs("baseRetryDelayMs",5e3,d),this.Za=Fs("retryDelaySeedMs",1e4,d),this.Ta=Fs("forwardChannelMaxRetries",2,d),this.va=Fs("forwardChannelRequestTimeoutMs",2e4,d),this.ma=d&&d.xmlHttpFactory||void 0,this.Ua=d&&d.Rb||void 0,this.Aa=d&&d.useFetchStreams||!1,this.O=void 0,this.L=d&&d.supportsCrossDomainXhr||!1,this.M="",this.h=new Jr(d&&d.concurrentRequestLimit),this.Ba=new ee,this.S=d&&d.fastHandshake||!1,this.R=d&&d.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=d&&d.Pb||!1,d&&d.ua&&this.j.ua(),d&&d.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&d&&d.detectBufferingProxy||!1,this.ia=void 0,d&&d.longPollingTimeout&&d.longPollingTimeout>0&&(this.ia=d.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}s=fs.prototype,s.ka=8,s.I=1,s.connect=function(d,v,x,N){Qt(0),this.W=d,this.H=v||{},x&&N!==void 0&&(this.H.OSID=x,this.H.OAID=N),this.F=this.X,this.J=Ku(this,null,this.W),Or(this)};function Qs(d){if(Mi(d),d.I==3){var v=d.V++,x=Me(d.J);if(Ye(x,"SID",d.M),Ye(x,"RID",v),Ye(x,"TYPE","terminate"),oo(d,x),v=new is(d,d.j,v),v.M=2,v.A=Kn(Me(x)),x=!1,h.navigator&&h.navigator.sendBeacon)try{x=h.navigator.sendBeacon(v.A.toString(),"")}catch{}!x&&h.Image&&(new Image().src=v.A,x=!0),x||(v.g=Yu(v.j,null),v.g.ea(v.A)),v.F=Date.now(),qn(v)}Gu(d)}function or(d){d.g&&(ac(d),d.g.cancel(),d.g=null)}function Mi(d){or(d),d.v&&(h.clearTimeout(d.v),d.v=null),Jo(d),d.h.cancel(),d.m&&(typeof d.m=="number"&&h.clearTimeout(d.m),d.m=null)}function Or(d){if(!Dr(d.h)&&!d.m){d.m=!0;var v=d.Ea;xe||T(),be||(xe(),be=!0),j.add(v,d),d.D=0}}function pi(d,v){return xs(d.h)>=d.h.j-(d.m?1:0)?!1:d.m?(d.i=v.G.concat(d.i),!0):d.I==1||d.I==2||d.D>=(d.Sa?0:d.Ta)?!1:(d.m=An(y(d.Ea,d,v),Wu(d,d.D)),d.D++,!0)}s.Ea=function(d){if(this.m)if(this.m=null,this.I==1){if(!d){this.V=Math.floor(Math.random()*1e5),d=this.V++;const Q=new is(this,this.j,d);let ce=this.o;if(this.U&&(ce?(ce=D(ce),ve(ce,this.U)):ce=this.U),this.u!==null||this.R||(Q.J=ce,ce=null),this.S)e:{for(var v=0,x=0;x<this.i.length;x++){t:{var N=this.i[x];if("__data__"in N.map&&(N=N.map.__data__,typeof N=="string")){N=N.length;break t}N=void 0}if(N===void 0)break;if(v+=N,v>4096){v=x;break e}if(v===4096||x===this.i.length-1){v=x+1;break e}}v=1e3}else v=1e3;v=Fu(this,Q,v),x=Me(this.J),Ye(x,"RID",d),Ye(x,"CVER",22),this.G&&Ye(x,"X-HTTP-Session-Id",this.G),oo(this,x),ce&&(this.R?v="headers="+xn(Et(ce))+"&"+v:this.u&&Ut(x,this.u,ce)),ar(this.h,Q),this.Ra&&Ye(x,"TYPE","init"),this.S?(Ye(x,"$req",v),Ye(x,"SID","null"),Q.U=!0,As(Q,x,null)):As(Q,x,v),this.I=2}}else this.I==3&&(d?ic(this,d):this.i.length==0||Dr(this.h)||ic(this))};function ic(d,v){var x;v?x=v.l:x=d.V++;const N=Me(d.J);Ye(N,"SID",d.M),Ye(N,"RID",x),Ye(N,"AID",d.K),oo(d,N),d.u&&d.o&&Ut(N,d.u,d.o),x=new is(d,d.j,x,d.D+1),d.u===null&&(x.J=d.o),v&&(d.i=v.G.concat(d.i)),v=Fu(d,x,1e3),x.H=Math.round(d.va*.5)+Math.round(d.va*.5*Math.random()),ar(d.h,x),As(x,N,v)}function oo(d,v){d.H&&Pe(d.H,function(x,N){Ye(v,N,x)}),d.l&&Pe({},function(x,N){Ye(v,N,x)})}function Fu(d,v,x){x=Math.min(d.i.length,x);const N=d.l?y(d.l.Ka,d.l,d):null;e:{var Q=d.i;let Mt=-1;for(;;){const ls=["count="+x];Mt==-1?x>0?(Mt=Q[0].g,ls.push("ofs="+Mt)):Mt=0:ls.push("ofs="+Mt);let fn=!0;for(let $n=0;$n<x;$n++){var ce=Q[$n].g;const Pr=Q[$n].map;if(ce-=Mt,ce<0)Mt=Math.max(0,Q[$n].g-100),fn=!1;else try{ce="req"+ce+"_"||"";try{var De=Pr instanceof Map?Pr:Object.entries(Pr);for(const[yi,Zr]of De){let ei=Zr;p(Zr)&&(ei=Jt(Zr)),ls.push(ce+yi+"="+encodeURIComponent(ei))}}catch(yi){throw ls.push(ce+"type="+encodeURIComponent("_badmap")),yi}}catch{N&&N(Pr)}}if(fn){De=ls.join("&");break e}}De=void 0}return d=d.i.splice(0,x),v.G=d,De}function qu(d){if(!d.g&&!d.v){d.Y=1;var v=d.Da;xe||T(),be||(xe(),be=!0),j.add(v,d),d.A=0}}function lo(d){return d.g||d.v||d.A>=3?!1:(d.Y++,d.v=An(y(d.Da,d),Wu(d,d.A)),d.A++,!0)}s.Da=function(){if(this.v=null,Hu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var d=4*this.T;this.j.info("BP detection timer enabled: "+d),this.B=An(y(this.Wa,this),d)}},s.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Qt(10),or(this),Hu(this))};function ac(d){d.B!=null&&(h.clearTimeout(d.B),d.B=null)}function Hu(d){d.g=new is(d,d.j,"rpc",d.Y),d.u===null&&(d.g.J=d.o),d.g.P=0;var v=Me(d.na);Ye(v,"RID","rpc"),Ye(v,"SID",d.M),Ye(v,"AID",d.K),Ye(v,"CI",d.F?"0":"1"),!d.F&&d.ia&&Ye(v,"TO",d.ia),Ye(v,"TYPE","xmlhttp"),oo(d,v),d.u&&d.o&&Ut(v,d.u,d.o),d.O&&(d.g.H=d.O);var x=d.g;d=d.ba,x.M=1,x.A=Kn(Me(v)),x.u=null,x.R=!0,Ar(x,d)}s.Va=function(){this.C!=null&&(this.C=null,or(this),lo(this),Qt(19))};function Jo(d){d.C!=null&&(h.clearTimeout(d.C),d.C=null)}function $u(d,v){var x=null;if(d.g==v){Jo(d),ac(d),d.g=null;var N=2}else if(vn(d.h,v))x=v.G,mi(d.h,v),N=1;else return;if(d.I!=0){if(v.o)if(N==1){x=v.u?v.u.length:0,v=Date.now()-v.F;var Q=d.D;N=un(),yt(N,new Fn(N,x)),Or(d)}else qu(d);else if(Q=v.m,Q==3||Q==0&&v.X>0||!(N==1&&pi(d,v)||N==2&&lo(d)))switch(x&&x.length>0&&(v=d.h,v.i=v.i.concat(x)),Q){case 1:gi(d,5);break;case 4:gi(d,10);break;case 3:gi(d,6);break;default:gi(d,2)}}}function Wu(d,v){let x=d.Qa+Math.floor(Math.random()*d.Za);return d.isActive()||(x*=2),x*v}function gi(d,v){if(d.j.info("Error code "+v),v==2){var x=y(d.bb,d),N=d.Ua;const Q=!N;N=new le(N||"//www.google.com/images/cleardot.gif"),h.location&&h.location.protocol=="http"||Le(N,"https"),Kn(N),Q?dt(N.toString(),x):V(N.toString(),x)}else Qt(2);d.I=0,d.l&&d.l.pa(v),Gu(d),Mi(d)}s.bb=function(d){d?(this.j.info("Successfully pinged google.com"),Qt(2)):(this.j.info("Failed to ping google.com"),Qt(1))};function Gu(d){if(d.I=0,d.ja=[],d.l){const v=I(d.h);(v.length!=0||d.i.length!=0)&&(H(d.ja,v),H(d.ja,d.i),d.h.i.length=0,O(d.i),d.i.length=0),d.l.oa()}}function Ku(d,v,x){var N=x instanceof le?Me(x):new le(x);if(N.g!="")v&&(N.g=v+"."+N.g),He(N,N.u);else{var Q=h.location;N=Q.protocol,v=v?v+"."+Q.hostname:Q.hostname,Q=+Q.port;const ce=new le(null);N&&Le(ce,N),v&&(ce.g=v),Q&&He(ce,Q),x&&(ce.h=x),N=ce}return x=d.G,v=d.wa,x&&v&&Ye(N,x,v),Ye(N,"VER",d.ka),oo(d,N),N}function Yu(d,v,x){if(v&&!d.L)throw Error("Can't create secondary domain capable XhrIo object.");return v=d.Aa&&!d.ma?new Xe(new ge({ab:x})):new Xe(d.ma),v.Fa(d.L),v}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function Qu(){}s=Qu.prototype,s.ra=function(){},s.qa=function(){},s.pa=function(){},s.oa=function(){},s.isActive=function(){return!0},s.Ka=function(){};function ga(){}ga.prototype.g=function(d,v){return new Xs(d,v)};function Xs(d,v){Dt.call(this),this.g=new fs(v),this.l=d,this.h=v&&v.messageUrlParams||null,d=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(d?d["X-WebChannel-Content-Type"]=v.messageContentType:d={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.sa&&(d?d["X-WebChannel-Client-Profile"]=v.sa:d={"X-WebChannel-Client-Profile":v.sa}),this.g.U=d,(d=v&&v.Qb)&&!A(d)&&(this.g.u=d),this.A=v&&v.supportsCrossDomainXhr||!1,this.v=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!A(v)&&(this.g.G=v,d=this.h,d!==null&&v in d&&(d=this.h,v in d&&delete d[v])),this.j=new Li(this)}k(Xs,Dt),Xs.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Xs.prototype.close=function(){Qs(this.g)},Xs.prototype.o=function(d){var v=this.g;if(typeof d=="string"){var x={};x.__data__=d,d=x}else this.v&&(x={},x.__data__=Jt(d),d=x);v.i.push(new qt(v.Ya++,d)),v.I==3&&Or(v)},Xs.prototype.N=function(){this.g.l=null,delete this.j,Qs(this.g),delete this.g,Xs.Z.N.call(this)};function Xu(d){$e.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var v=d.__sm__;if(v){e:{for(const x in v){d=x;break e}d=void 0}(this.i=d)&&(d=this.i,v=v!==null&&d in v?v[d]:void 0),this.data=v}else this.data=d}k(Xu,$e);function Ju(){st.call(this),this.status=1}k(Ju,st);function Li(d){this.g=d}k(Li,Qu),Li.prototype.ra=function(){yt(this.g,"a")},Li.prototype.qa=function(d){yt(this.g,new Xu(d))},Li.prototype.pa=function(d){yt(this.g,new Ju)},Li.prototype.oa=function(){yt(this.g,"b")},ga.prototype.createWebChannel=ga.prototype.g,Xs.prototype.send=Xs.prototype.o,Xs.prototype.open=Xs.prototype.m,Xs.prototype.close=Xs.prototype.close,Nx=function(){return new ga},Cx=function(){return un()},jx=Fe,Eg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},lt.NO_ERROR=0,lt.TIMEOUT=8,lt.HTTP_ERROR=6,kd=lt,_n.COMPLETE="complete",Sx=_n,bt.EventType=it,it.OPEN="a",it.CLOSE="b",it.ERROR="c",it.MESSAGE="d",Dt.prototype.listen=Dt.prototype.J,Zc=bt,Xe.prototype.listenOnce=Xe.prototype.K,Xe.prototype.getLastError=Xe.prototype.Ha,Xe.prototype.getLastErrorCode=Xe.prototype.ya,Xe.prototype.getStatus=Xe.prototype.ca,Xe.prototype.getResponseJson=Xe.prototype.La,Xe.prototype.getResponseText=Xe.prototype.la,Xe.prototype.send=Xe.prototype.ea,Xe.prototype.setWithCredentials=Xe.prototype.Fa,Tx=Xe}).apply(typeof rd<"u"?rd:typeof self<"u"?self:typeof window<"u"?window:{});class $s{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}$s.UNAUTHENTICATED=new $s(null),$s.GOOGLE_CREDENTIALS=new $s("google-credentials-uid"),$s.FIRST_PARTY=new $s("first-party-uid"),$s.MOCK_USER=new $s("mock-user");let Zl="12.8.0";function o4(s){Zl=s}const Vo=new sy("@firebase/firestore");function Rl(){return Vo.logLevel}function We(s,...e){if(Vo.logLevel<=Gt.DEBUG){const t=e.map(py);Vo.debug(`Firestore (${Zl}): ${s}`,...t)}}function la(s,...e){if(Vo.logLevel<=Gt.ERROR){const t=e.map(py);Vo.error(`Firestore (${Zl}): ${s}`,...t)}}function zl(s,...e){if(Vo.logLevel<=Gt.WARN){const t=e.map(py);Vo.warn(`Firestore (${Zl}): ${s}`,...t)}}function py(s){if(typeof s=="string")return s;try{return(function(t){return JSON.stringify(t)})(s)}catch{return s}}function xt(s,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,Ax(s,i,t)}function Ax(s,e,t){let i=`FIRESTORE (${Zl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw la(i),new Error(i)}function gn(s,e,t,i){let l="Unexpected state";typeof t=="string"?l=t:i=t,s||Ax(e,l,i)}function Rt(s,e){return s}const pe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ze extends di{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class sa{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Rx{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class l4{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t($s.UNAUTHENTICATED)))}shutdown(){}}class c4{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class u4{constructor(e){this.t=e,this.currentUser=$s.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){gn(this.o===void 0,42304);let i=this.i;const l=g=>this.i!==i?(i=this.i,t(g)):Promise.resolve();let u=new sa;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new sa,e.enqueueRetryable((()=>l(this.currentUser)))};const h=()=>{const g=u;e.enqueueRetryable((async()=>{await g.promise,await l(this.currentUser)}))},p=g=>{We("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),h())};this.t.onInit((g=>p(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?p(g):(We("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new sa)}}),0),h()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(We("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(gn(typeof i.accessToken=="string",31837,{l:i}),new Rx(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return gn(e===null||typeof e=="string",2055,{h:e}),new $s(e)}}class h4{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=$s.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class d4{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new h4(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t($s.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class M2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class f4{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Sr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){gn(this.o===void 0,3512);const i=u=>{u.error!=null&&We("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const h=u.token!==this.m;return this.m=u.token,We("FirebaseAppCheckTokenProvider",`Received ${h?"new":"existing"} token.`),h?t(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable((()=>i(u)))};const l=u=>{We("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>l(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?l(u):We("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new M2(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(gn(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new M2(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function m4(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<s;i++)t[i]=Math.floor(256*Math.random());return t}class gy{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const l=m4(40);for(let u=0;u<l.length;++u)i.length<20&&l[u]<t&&(i+=e.charAt(l[u]%62))}return i}}function Kt(s,e){return s<e?-1:s>e?1:0}function Tg(s,e){const t=Math.min(s.length,e.length);for(let i=0;i<t;i++){const l=s.charAt(i),u=e.charAt(i);if(l!==u)return Up(l)===Up(u)?Kt(l,u):Up(l)?1:-1}return Kt(s.length,e.length)}const p4=55296,g4=57343;function Up(s){const e=s.charCodeAt(0);return e>=p4&&e<=g4}function Fl(s,e,t){return s.length===e.length&&s.every(((i,l)=>t(i,e[l])))}const L2="__name__";class ki{constructor(e,t,i){t===void 0?t=0:t>e.length&&xt(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&xt(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return ki.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ki?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let l=0;l<i;l++){const u=ki.compareSegments(e.get(l),t.get(l));if(u!==0)return u}return Kt(e.length,t.length)}static compareSegments(e,t){const i=ki.isNumericId(e),l=ki.isNumericId(t);return i&&!l?-1:!i&&l?1:i&&l?ki.extractNumericId(e).compare(ki.extractNumericId(t)):Tg(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ya.fromString(e.substring(4,e.length-2))}}class Mn extends ki{construct(e,t,i){return new Mn(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new ze(pe.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((l=>l.length>0)))}return new Mn(t)}static emptyPath(){return new Mn([])}}const y4=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Os extends ki{construct(e,t,i){return new Os(e,t,i)}static isValidIdentifier(e){return y4.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Os.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===L2}static keyField(){return new Os([L2])}static fromServerFormat(e){const t=[];let i="",l=0;const u=()=>{if(i.length===0)throw new ze(pe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let h=!1;for(;l<e.length;){const p=e[l];if(p==="\\"){if(l+1===e.length)throw new ze(pe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[l+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new ze(pe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=g,l+=2}else p==="`"?(h=!h,l++):p!=="."||h?(i+=p,l++):(u(),l++)}if(u(),h)throw new ze(pe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Os(t)}static emptyPath(){return new Os([])}}class ot{constructor(e){this.path=e}static fromPath(e){return new ot(Mn.fromString(e))}static fromName(e){return new ot(Mn.fromString(e).popFirst(5))}static empty(){return new ot(Mn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Mn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Mn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ot(new Mn(e.slice()))}}function Ix(s,e,t){if(!t)throw new ze(pe.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function v4(s,e,t,i){if(e===!0&&i===!0)throw new ze(pe.INVALID_ARGUMENT,`${s} and ${t} cannot be used together.`)}function O2(s){if(!ot.isDocumentKey(s))throw new ze(pe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function P2(s){if(ot.isDocumentKey(s))throw new ze(pe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function Dx(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function af(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":xt(12329,{type:typeof s})}function nr(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new ze(pe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=af(s);throw new ze(pe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return s}function b4(s,e){if(e<=0)throw new ze(pe.INVALID_ARGUMENT,`Function ${s}() requires a positive number, but it was: ${e}.`)}function ws(s,e){const t={typeString:s};return e&&(t.value=e),t}function Du(s,e){if(!Dx(s))throw new ze(pe.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const l=e[i].typeString,u="value"in e[i]?{value:e[i].value}:void 0;if(!(i in s)){t=`JSON missing required field: '${i}'`;break}const h=s[i];if(l&&typeof h!==l){t=`JSON field '${i}' must be a ${l}.`;break}if(u!==void 0&&h!==u.value){t=`Expected '${i}' field to equal '${u.value}'`;break}}if(t)throw new ze(pe.INVALID_ARGUMENT,t);return!0}const V2=-62135596800,U2=1e6;class Vt{static now(){return Vt.fromMillis(Date.now())}static fromDate(e){return Vt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*U2);return new Vt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ze(pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ze(pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<V2)throw new ze(pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ze(pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/U2}_compareTo(e){return this.seconds===e.seconds?Kt(this.nanoseconds,e.nanoseconds):Kt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Vt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Du(e,Vt._jsonSchema))return new Vt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-V2;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Vt._jsonSchemaVersion="firestore/timestamp/1.0",Vt._jsonSchema={type:ws("string",Vt._jsonSchemaVersion),seconds:ws("number"),nanoseconds:ws("number")};class Ct{static fromTimestamp(e){return new Ct(e)}static min(){return new Ct(new Vt(0,0))}static max(){return new Ct(new Vt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const mu=-1;function w4(s,e){const t=s.toTimestamp().seconds,i=s.toTimestamp().nanoseconds+1,l=Ct.fromTimestamp(i===1e9?new Vt(t+1,0):new Vt(t,i));return new Xa(l,ot.empty(),e)}function _4(s){return new Xa(s.readTime,s.key,mu)}class Xa{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Xa(Ct.min(),ot.empty(),mu)}static max(){return new Xa(Ct.max(),ot.empty(),mu)}}function x4(s,e){let t=s.readTime.compareTo(e.readTime);return t!==0?t:(t=ot.comparator(s.documentKey,e.documentKey),t!==0?t:Kt(s.largestBatchId,e.largestBatchId))}const k4="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class E4{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function ec(s){if(s.code!==pe.FAILED_PRECONDITION||s.message!==k4)throw s;We("LocalStore","Unexpectedly lost primary lease")}class ke{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&xt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ke(((i,l)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(i,l)},this.catchCallback=u=>{this.wrapFailure(t,u).next(i,l)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ke?t:ke.resolve(t)}catch(t){return ke.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ke.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ke.reject(t)}static resolve(e){return new ke(((t,i)=>{t(e)}))}static reject(e){return new ke(((t,i)=>{i(e)}))}static waitFor(e){return new ke(((t,i)=>{let l=0,u=0,h=!1;e.forEach((p=>{++l,p.next((()=>{++u,h&&u===l&&t()}),(g=>i(g)))})),h=!0,u===l&&t()}))}static or(e){let t=ke.resolve(!1);for(const i of e)t=t.next((l=>l?ke.resolve(l):i()));return t}static forEach(e,t){const i=[];return e.forEach(((l,u)=>{i.push(t.call(this,l,u))})),this.waitFor(i)}static mapArray(e,t){return new ke(((i,l)=>{const u=e.length,h=new Array(u);let p=0;for(let g=0;g<u;g++){const y=g;t(e[y]).next((b=>{h[y]=b,++p,p===u&&i(h)}),(b=>l(b)))}}))}static doWhile(e,t){return new ke(((i,l)=>{const u=()=>{e()===!0?t().next((()=>{u()}),l):i()};u()}))}}function T4(s){const e=s.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function tc(s){return s.name==="IndexedDbTransactionError"}class of{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}of.ce=-1;const yy=-1;function lf(s){return s==null}function Bd(s){return s===0&&1/s==-1/0}function S4(s){return typeof s=="number"&&Number.isInteger(s)&&!Bd(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}const Mx="";function j4(s){let e="";for(let t=0;t<s.length;t++)e.length>0&&(e=B2(e)),e=C4(s.get(t),e);return B2(e)}function C4(s,e){let t=e;const i=s.length;for(let l=0;l<i;l++){const u=s.charAt(l);switch(u){case"\0":t+="";break;case Mx:t+="";break;default:t+=u}}return t}function B2(s){return s+Mx+""}function z2(s){let e=0;for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e++;return e}function io(s,e){for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e(t,s[t])}function Lx(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}class Qn{constructor(e,t){this.comparator=e,this.root=t||Ls.EMPTY}insert(e,t){return new Qn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ls.BLACK,null,null))}remove(e){return new Qn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ls.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const l=this.comparator(e,i.key);if(l===0)return t+i.left.size;l<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new id(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new id(this.root,e,this.comparator,!1)}getReverseIterator(){return new id(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new id(this.root,e,this.comparator,!0)}}class id{constructor(e,t,i,l){this.isReverse=l,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=t?i(e.key,t):1,t&&l&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ls{constructor(e,t,i,l,u){this.key=e,this.value=t,this.color=i??Ls.RED,this.left=l??Ls.EMPTY,this.right=u??Ls.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,l,u){return new Ls(e??this.key,t??this.value,i??this.color,l??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let l=this;const u=i(e,l.key);return l=u<0?l.copy(null,null,null,l.left.insert(e,t,i),null):u===0?l.copy(null,t,null,null,null):l.copy(null,null,null,null,l.right.insert(e,t,i)),l.fixUp()}removeMin(){if(this.left.isEmpty())return Ls.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,l=this;if(t(e,l.key)<0)l.left.isEmpty()||l.left.isRed()||l.left.left.isRed()||(l=l.moveRedLeft()),l=l.copy(null,null,null,l.left.remove(e,t),null);else{if(l.left.isRed()&&(l=l.rotateRight()),l.right.isEmpty()||l.right.isRed()||l.right.left.isRed()||(l=l.moveRedRight()),t(e,l.key)===0){if(l.right.isEmpty())return Ls.EMPTY;i=l.right.min(),l=l.copy(i.key,i.value,null,null,l.right.removeMin())}l=l.copy(null,null,null,null,l.right.remove(e,t))}return l.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ls.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ls.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw xt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw xt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw xt(27949);return e+(this.isRed()?0:1)}}Ls.EMPTY=null,Ls.RED=!0,Ls.BLACK=!1;Ls.EMPTY=new class{constructor(){this.size=0}get key(){throw xt(57766)}get value(){throw xt(16141)}get color(){throw xt(16727)}get left(){throw xt(29726)}get right(){throw xt(36894)}copy(e,t,i,l,u){return this}insert(e,t,i){return new Ls(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Es{constructor(e){this.comparator=e,this.data=new Qn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const l=i.getNext();if(this.comparator(l.key,e[1])>=0)return;t(l.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new F2(this.data.getIterator())}getIteratorFrom(e){return new F2(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Es)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(this.comparator(l,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Es(this.comparator);return t.data=e,t}}class F2{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Cr{constructor(e){this.fields=e,e.sort(Os.comparator)}static empty(){return new Cr([])}unionWith(e){let t=new Es(Os.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Cr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Fl(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class Ox extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Vs{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(l){try{return atob(l)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new Ox("Invalid base64 string: "+u):u}})(e);return new Vs(t)}static fromUint8Array(e){const t=(function(l){let u="";for(let h=0;h<l.length;++h)u+=String.fromCharCode(l[h]);return u})(e);return new Vs(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Kt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Vs.EMPTY_BYTE_STRING=new Vs("");const N4=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ja(s){if(gn(!!s,39018),typeof s=="string"){let e=0;const t=N4.exec(s);if(gn(!!t,46558,{timestamp:s}),t[1]){let l=t[1];l=(l+"000000000").substr(0,9),e=Number(l)}const i=new Date(s);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:hs(s.seconds),nanos:hs(s.nanos)}}function hs(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function Za(s){return typeof s=="string"?Vs.fromBase64String(s):Vs.fromUint8Array(s)}const Px="server_timestamp",Vx="__type__",Ux="__previous_value__",Bx="__local_write_time__";function vy(s){return(s?.mapValue?.fields||{})[Vx]?.stringValue===Px}function cf(s){const e=s.mapValue.fields[Ux];return vy(e)?cf(e):e}function pu(s){const e=Ja(s.mapValue.fields[Bx].timestampValue);return new Vt(e.seconds,e.nanos)}class A4{constructor(e,t,i,l,u,h,p,g,y,b,k){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=l,this.ssl=u,this.forceLongPolling=h,this.autoDetectLongPolling=p,this.longPollingOptions=g,this.useFetchStreams=y,this.isUsingEmulator=b,this.apiKey=k}}const zd="(default)";class gu{constructor(e,t){this.projectId=e,this.database=t||zd}static empty(){return new gu("","")}get isDefaultDatabase(){return this.database===zd}isEqual(e){return e instanceof gu&&e.projectId===this.projectId&&e.database===this.database}}function R4(s,e){if(!Object.prototype.hasOwnProperty.apply(s.options,["projectId"]))throw new ze(pe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new gu(s.options.projectId,e)}const zx="__type__",I4="__max__",ad={mapValue:{}},Fx="__vector__",Fd="value";function eo(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?vy(s)?4:M4(s)?9007199254740991:D4(s)?10:11:xt(28295,{value:s})}function Ai(s,e){if(s===e)return!0;const t=eo(s);if(t!==eo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return pu(s).isEqual(pu(e));case 3:return(function(l,u){if(typeof l.timestampValue=="string"&&typeof u.timestampValue=="string"&&l.timestampValue.length===u.timestampValue.length)return l.timestampValue===u.timestampValue;const h=Ja(l.timestampValue),p=Ja(u.timestampValue);return h.seconds===p.seconds&&h.nanos===p.nanos})(s,e);case 5:return s.stringValue===e.stringValue;case 6:return(function(l,u){return Za(l.bytesValue).isEqual(Za(u.bytesValue))})(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return(function(l,u){return hs(l.geoPointValue.latitude)===hs(u.geoPointValue.latitude)&&hs(l.geoPointValue.longitude)===hs(u.geoPointValue.longitude)})(s,e);case 2:return(function(l,u){if("integerValue"in l&&"integerValue"in u)return hs(l.integerValue)===hs(u.integerValue);if("doubleValue"in l&&"doubleValue"in u){const h=hs(l.doubleValue),p=hs(u.doubleValue);return h===p?Bd(h)===Bd(p):isNaN(h)&&isNaN(p)}return!1})(s,e);case 9:return Fl(s.arrayValue.values||[],e.arrayValue.values||[],Ai);case 10:case 11:return(function(l,u){const h=l.mapValue.fields||{},p=u.mapValue.fields||{};if(z2(h)!==z2(p))return!1;for(const g in h)if(h.hasOwnProperty(g)&&(p[g]===void 0||!Ai(h[g],p[g])))return!1;return!0})(s,e);default:return xt(52216,{left:s})}}function yu(s,e){return(s.values||[]).find((t=>Ai(t,e)))!==void 0}function ql(s,e){if(s===e)return 0;const t=eo(s),i=eo(e);if(t!==i)return Kt(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Kt(s.booleanValue,e.booleanValue);case 2:return(function(u,h){const p=hs(u.integerValue||u.doubleValue),g=hs(h.integerValue||h.doubleValue);return p<g?-1:p>g?1:p===g?0:isNaN(p)?isNaN(g)?0:-1:1})(s,e);case 3:return q2(s.timestampValue,e.timestampValue);case 4:return q2(pu(s),pu(e));case 5:return Tg(s.stringValue,e.stringValue);case 6:return(function(u,h){const p=Za(u),g=Za(h);return p.compareTo(g)})(s.bytesValue,e.bytesValue);case 7:return(function(u,h){const p=u.split("/"),g=h.split("/");for(let y=0;y<p.length&&y<g.length;y++){const b=Kt(p[y],g[y]);if(b!==0)return b}return Kt(p.length,g.length)})(s.referenceValue,e.referenceValue);case 8:return(function(u,h){const p=Kt(hs(u.latitude),hs(h.latitude));return p!==0?p:Kt(hs(u.longitude),hs(h.longitude))})(s.geoPointValue,e.geoPointValue);case 9:return H2(s.arrayValue,e.arrayValue);case 10:return(function(u,h){const p=u.fields||{},g=h.fields||{},y=p[Fd]?.arrayValue,b=g[Fd]?.arrayValue,k=Kt(y?.values?.length||0,b?.values?.length||0);return k!==0?k:H2(y,b)})(s.mapValue,e.mapValue);case 11:return(function(u,h){if(u===ad.mapValue&&h===ad.mapValue)return 0;if(u===ad.mapValue)return 1;if(h===ad.mapValue)return-1;const p=u.fields||{},g=Object.keys(p),y=h.fields||{},b=Object.keys(y);g.sort(),b.sort();for(let k=0;k<g.length&&k<b.length;++k){const E=Tg(g[k],b[k]);if(E!==0)return E;const O=ql(p[g[k]],y[b[k]]);if(O!==0)return O}return Kt(g.length,b.length)})(s.mapValue,e.mapValue);default:throw xt(23264,{he:t})}}function q2(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return Kt(s,e);const t=Ja(s),i=Ja(e),l=Kt(t.seconds,i.seconds);return l!==0?l:Kt(t.nanos,i.nanos)}function H2(s,e){const t=s.values||[],i=e.values||[];for(let l=0;l<t.length&&l<i.length;++l){const u=ql(t[l],i[l]);if(u)return u}return Kt(t.length,i.length)}function Hl(s){return Sg(s)}function Sg(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?(function(t){const i=Ja(t);return`time(${i.seconds},${i.nanos})`})(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?(function(t){return Za(t).toBase64()})(s.bytesValue):"referenceValue"in s?(function(t){return ot.fromName(t).toString()})(s.referenceValue):"geoPointValue"in s?(function(t){return`geo(${t.latitude},${t.longitude})`})(s.geoPointValue):"arrayValue"in s?(function(t){let i="[",l=!0;for(const u of t.values||[])l?l=!1:i+=",",i+=Sg(u);return i+"]"})(s.arrayValue):"mapValue"in s?(function(t){const i=Object.keys(t.fields||{}).sort();let l="{",u=!0;for(const h of i)u?u=!1:l+=",",l+=`${h}:${Sg(t.fields[h])}`;return l+"}"})(s.mapValue):xt(61005,{value:s})}function Ed(s){switch(eo(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=cf(s);return e?16+Ed(e):16;case 5:return 2*s.stringValue.length;case 6:return Za(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((l,u)=>l+Ed(u)),0)})(s.arrayValue);case 10:case 11:return(function(i){let l=0;return io(i.fields,((u,h)=>{l+=u.length+Ed(h)})),l})(s.mapValue);default:throw xt(13486,{value:s})}}function $2(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function jg(s){return!!s&&"integerValue"in s}function by(s){return!!s&&"arrayValue"in s}function W2(s){return!!s&&"nullValue"in s}function G2(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function Td(s){return!!s&&"mapValue"in s}function D4(s){return(s?.mapValue?.fields||{})[zx]?.stringValue===Fx}function iu(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return io(s.mapValue.fields,((t,i)=>e.mapValue.fields[t]=iu(i))),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(s.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=iu(s.arrayValue.values[t]);return e}return{...s}}function M4(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===I4}class mr{constructor(e){this.value=e}static empty(){return new mr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Td(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=iu(t)}setAll(e){let t=Os.emptyPath(),i={},l=[];e.forEach(((h,p)=>{if(!t.isImmediateParentOf(p)){const g=this.getFieldsMap(t);this.applyChanges(g,i,l),i={},l=[],t=p.popLast()}h?i[p.lastSegment()]=iu(h):l.push(p.lastSegment())}));const u=this.getFieldsMap(t);this.applyChanges(u,i,l)}delete(e){const t=this.field(e.popLast());Td(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ai(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let l=t.mapValue.fields[e.get(i)];Td(l)&&l.mapValue.fields||(l={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=l),t=l}return t.mapValue.fields}applyChanges(e,t,i){io(t,((l,u)=>e[l]=u));for(const l of i)delete e[l]}clone(){return new mr(iu(this.value))}}function qx(s){const e=[];return io(s.fields,((t,i)=>{const l=new Os([t]);if(Td(i)){const u=qx(i.mapValue).fields;if(u.length===0)e.push(l);else for(const h of u)e.push(l.child(h))}else e.push(l)})),new Cr(e)}class Ws{constructor(e,t,i,l,u,h,p){this.key=e,this.documentType=t,this.version=i,this.readTime=l,this.createTime=u,this.data=h,this.documentState=p}static newInvalidDocument(e){return new Ws(e,0,Ct.min(),Ct.min(),Ct.min(),mr.empty(),0)}static newFoundDocument(e,t,i,l){return new Ws(e,1,t,Ct.min(),i,l,0)}static newNoDocument(e,t){return new Ws(e,2,t,Ct.min(),Ct.min(),mr.empty(),0)}static newUnknownDocument(e,t){return new Ws(e,3,t,Ct.min(),Ct.min(),mr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ct.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=mr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=mr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ct.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ws&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ws(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class qd{constructor(e,t){this.position=e,this.inclusive=t}}function K2(s,e,t){let i=0;for(let l=0;l<s.position.length;l++){const u=e[l],h=s.position[l];if(u.field.isKeyField()?i=ot.comparator(ot.fromName(h.referenceValue),t.key):i=ql(h,t.data.field(u.field)),u.dir==="desc"&&(i*=-1),i!==0)break}return i}function Y2(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let t=0;t<s.position.length;t++)if(!Ai(s.position[t],e.position[t]))return!1;return!0}class vu{constructor(e,t="asc"){this.field=e,this.dir=t}}function L4(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}class Hx{}class bs extends Hx{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new P4(e,t,i):t==="array-contains"?new B4(e,i):t==="in"?new z4(e,i):t==="not-in"?new F4(e,i):t==="array-contains-any"?new q4(e,i):new bs(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new V4(e,i):new U4(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(ql(t,this.value)):t!==null&&eo(this.value)===eo(t)&&this.matchesComparison(ql(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return xt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ci extends Hx{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new ci(e,t)}matches(e){return $x(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function $x(s){return s.op==="and"}function Wx(s){return O4(s)&&$x(s)}function O4(s){for(const e of s.filters)if(e instanceof ci)return!1;return!0}function Cg(s){if(s instanceof bs)return s.field.canonicalString()+s.op.toString()+Hl(s.value);if(Wx(s))return s.filters.map((e=>Cg(e))).join(",");{const e=s.filters.map((t=>Cg(t))).join(",");return`${s.op}(${e})`}}function Gx(s,e){return s instanceof bs?(function(i,l){return l instanceof bs&&i.op===l.op&&i.field.isEqual(l.field)&&Ai(i.value,l.value)})(s,e):s instanceof ci?(function(i,l){return l instanceof ci&&i.op===l.op&&i.filters.length===l.filters.length?i.filters.reduce(((u,h,p)=>u&&Gx(h,l.filters[p])),!0):!1})(s,e):void xt(19439)}function Kx(s){return s instanceof bs?(function(t){return`${t.field.canonicalString()} ${t.op} ${Hl(t.value)}`})(s):s instanceof ci?(function(t){return t.op.toString()+" {"+t.getFilters().map(Kx).join(" ,")+"}"})(s):"Filter"}class P4 extends bs{constructor(e,t,i){super(e,t,i),this.key=ot.fromName(i.referenceValue)}matches(e){const t=ot.comparator(e.key,this.key);return this.matchesComparison(t)}}class V4 extends bs{constructor(e,t){super(e,"in",t),this.keys=Yx("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class U4 extends bs{constructor(e,t){super(e,"not-in",t),this.keys=Yx("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Yx(s,e){return(e.arrayValue?.values||[]).map((t=>ot.fromName(t.referenceValue)))}class B4 extends bs{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return by(t)&&yu(t.arrayValue,this.value)}}class z4 extends bs{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&yu(this.value.arrayValue,t)}}class F4 extends bs{constructor(e,t){super(e,"not-in",t)}matches(e){if(yu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!yu(this.value.arrayValue,t)}}class q4 extends bs{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!by(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>yu(this.value.arrayValue,i)))}}class H4{constructor(e,t=null,i=[],l=[],u=null,h=null,p=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=l,this.limit=u,this.startAt=h,this.endAt=p,this.Te=null}}function Q2(s,e=null,t=[],i=[],l=null,u=null,h=null){return new H4(s,e,t,i,l,u,h)}function wy(s){const e=Rt(s);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>Cg(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(u){return u.field.canonicalString()+u.dir})(i))).join(","),lf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Hl(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Hl(i))).join(",")),e.Te=t}return e.Te}function _y(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<s.orderBy.length;t++)if(!L4(s.orderBy[t],e.orderBy[t]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let t=0;t<s.filters.length;t++)if(!Gx(s.filters[t],e.filters[t]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!Y2(s.startAt,e.startAt)&&Y2(s.endAt,e.endAt)}function Ng(s){return ot.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}class nc{constructor(e,t=null,i=[],l=[],u=null,h="F",p=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=l,this.limit=u,this.limitType=h,this.startAt=p,this.endAt=g,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function $4(s,e,t,i,l,u,h,p){return new nc(s,e,t,i,l,u,h,p)}function uf(s){return new nc(s)}function X2(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function W4(s){return ot.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}function Qx(s){return s.collectionGroup!==null}function au(s){const e=Rt(s);if(e.Ie===null){e.Ie=[];const t=new Set;for(const u of e.explicitOrderBy)e.Ie.push(u),t.add(u.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(h){let p=new Es(Os.comparator);return h.filters.forEach((g=>{g.getFlattenedFilters().forEach((y=>{y.isInequality()&&(p=p.add(y.field))}))})),p})(e).forEach((u=>{t.has(u.canonicalString())||u.isKeyField()||e.Ie.push(new vu(u,i))})),t.has(Os.keyField().canonicalString())||e.Ie.push(new vu(Os.keyField(),i))}return e.Ie}function ji(s){const e=Rt(s);return e.Ee||(e.Ee=G4(e,au(s))),e.Ee}function G4(s,e){if(s.limitType==="F")return Q2(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map((l=>{const u=l.dir==="desc"?"asc":"desc";return new vu(l.field,u)}));const t=s.endAt?new qd(s.endAt.position,s.endAt.inclusive):null,i=s.startAt?new qd(s.startAt.position,s.startAt.inclusive):null;return Q2(s.path,s.collectionGroup,e,s.filters,s.limit,t,i)}}function Ag(s,e){const t=s.filters.concat([e]);return new nc(s.path,s.collectionGroup,s.explicitOrderBy.slice(),t,s.limit,s.limitType,s.startAt,s.endAt)}function K4(s,e){const t=s.explicitOrderBy.concat([e]);return new nc(s.path,s.collectionGroup,t,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}function Hd(s,e,t){return new nc(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,t,s.startAt,s.endAt)}function hf(s,e){return _y(ji(s),ji(e))&&s.limitType===e.limitType}function Xx(s){return`${wy(ji(s))}|lt:${s.limitType}`}function Il(s){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((l=>Kx(l))).join(", ")}]`),lf(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((l=>(function(h){return`${h.field.canonicalString()} (${h.dir})`})(l))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((l=>Hl(l))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((l=>Hl(l))).join(",")),`Target(${i})`})(ji(s))}; limitType=${s.limitType})`}function df(s,e){return e.isFoundDocument()&&(function(i,l){const u=l.key.path;return i.collectionGroup!==null?l.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(u):ot.isDocumentKey(i.path)?i.path.isEqual(u):i.path.isImmediateParentOf(u)})(s,e)&&(function(i,l){for(const u of au(i))if(!u.field.isKeyField()&&l.data.field(u.field)===null)return!1;return!0})(s,e)&&(function(i,l){for(const u of i.filters)if(!u.matches(l))return!1;return!0})(s,e)&&(function(i,l){return!(i.startAt&&!(function(h,p,g){const y=K2(h,p,g);return h.inclusive?y<=0:y<0})(i.startAt,au(i),l)||i.endAt&&!(function(h,p,g){const y=K2(h,p,g);return h.inclusive?y>=0:y>0})(i.endAt,au(i),l))})(s,e)}function Y4(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function Jx(s){return(e,t)=>{let i=!1;for(const l of au(s)){const u=Q4(l,e,t);if(u!==0)return u;i=i||l.field.isKeyField()}return 0}}function Q4(s,e,t){const i=s.field.isKeyField()?ot.comparator(e.key,t.key):(function(u,h,p){const g=h.data.field(u),y=p.data.field(u);return g!==null&&y!==null?ql(g,y):xt(42886)})(s.field,e,t);switch(s.dir){case"asc":return i;case"desc":return-1*i;default:return xt(19790,{direction:s.dir})}}class Go{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[l,u]of i)if(this.equalsFn(l,e))return u}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),l=this.inner[i];if(l===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let u=0;u<l.length;u++)if(this.equalsFn(l[u][0],e))return void(l[u]=[e,t]);l.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let l=0;l<i.length;l++)if(this.equalsFn(i[l][0],e))return i.length===1?delete this.inner[t]:i.splice(l,1),this.innerSize--,!0;return!1}forEach(e){io(this.inner,((t,i)=>{for(const[l,u]of i)e(l,u)}))}isEmpty(){return Lx(this.inner)}size(){return this.innerSize}}const X4=new Qn(ot.comparator);function ca(){return X4}const Zx=new Qn(ot.comparator);function eu(...s){let e=Zx;for(const t of s)e=e.insert(t.key,t);return e}function ek(s){let e=Zx;return s.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function No(){return ou()}function tk(){return ou()}function ou(){return new Go((s=>s.toString()),((s,e)=>s.isEqual(e)))}const J4=new Qn(ot.comparator),Z4=new Es(ot.comparator);function Yt(...s){let e=Z4;for(const t of s)e=e.add(t);return e}const eI=new Es(Kt);function tI(){return eI}function xy(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Bd(e)?"-0":e}}function nk(s){return{integerValue:""+s}}function sk(s,e){return S4(e)?nk(e):xy(s,e)}class ff{constructor(){this._=void 0}}function nI(s,e,t){return s instanceof bu?(function(l,u){const h={fields:{[Vx]:{stringValue:Px},[Bx]:{timestampValue:{seconds:l.seconds,nanos:l.nanoseconds}}}};return u&&vy(u)&&(u=cf(u)),u&&(h.fields[Ux]=u),{mapValue:h}})(t,e):s instanceof $l?ik(s,e):s instanceof Wl?ak(s,e):(function(l,u){const h=rk(l,u),p=J2(h)+J2(l.Ae);return jg(h)&&jg(l.Ae)?nk(p):xy(l.serializer,p)})(s,e)}function sI(s,e,t){return s instanceof $l?ik(s,e):s instanceof Wl?ak(s,e):t}function rk(s,e){return s instanceof wu?(function(i){return jg(i)||(function(u){return!!u&&"doubleValue"in u})(i)})(e)?e:{integerValue:0}:null}class bu extends ff{}class $l extends ff{constructor(e){super(),this.elements=e}}function ik(s,e){const t=ok(e);for(const i of s.elements)t.some((l=>Ai(l,i)))||t.push(i);return{arrayValue:{values:t}}}class Wl extends ff{constructor(e){super(),this.elements=e}}function ak(s,e){let t=ok(e);for(const i of s.elements)t=t.filter((l=>!Ai(l,i)));return{arrayValue:{values:t}}}class wu extends ff{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function J2(s){return hs(s.integerValue||s.doubleValue)}function ok(s){return by(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}class mf{constructor(e,t){this.field=e,this.transform=t}}function rI(s,e){return s.field.isEqual(e.field)&&(function(i,l){return i instanceof $l&&l instanceof $l||i instanceof Wl&&l instanceof Wl?Fl(i.elements,l.elements,Ai):i instanceof wu&&l instanceof wu?Ai(i.Ae,l.Ae):i instanceof bu&&l instanceof bu})(s.transform,e.transform)}class iI{constructor(e,t){this.version=e,this.transformResults=t}}class sr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new sr}static exists(e){return new sr(void 0,e)}static updateTime(e){return new sr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Sd(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class pf{}function lk(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new gf(s.key,sr.none()):new Mu(s.key,s.data,sr.none());{const t=s.data,i=mr.empty();let l=new Es(Os.comparator);for(let u of e.fields)if(!l.has(u)){let h=t.field(u);h===null&&u.length>1&&(u=u.popLast(),h=t.field(u)),h===null?i.delete(u):i.set(u,h),l=l.add(u)}return new ao(s.key,i,new Cr(l.toArray()),sr.none())}}function aI(s,e,t){s instanceof Mu?(function(l,u,h){const p=l.value.clone(),g=ew(l.fieldTransforms,u,h.transformResults);p.setAll(g),u.convertToFoundDocument(h.version,p).setHasCommittedMutations()})(s,e,t):s instanceof ao?(function(l,u,h){if(!Sd(l.precondition,u))return void u.convertToUnknownDocument(h.version);const p=ew(l.fieldTransforms,u,h.transformResults),g=u.data;g.setAll(ck(l)),g.setAll(p),u.convertToFoundDocument(h.version,g).setHasCommittedMutations()})(s,e,t):(function(l,u,h){u.convertToNoDocument(h.version).setHasCommittedMutations()})(0,e,t)}function lu(s,e,t,i){return s instanceof Mu?(function(u,h,p,g){if(!Sd(u.precondition,h))return p;const y=u.value.clone(),b=tw(u.fieldTransforms,g,h);return y.setAll(b),h.convertToFoundDocument(h.version,y).setHasLocalMutations(),null})(s,e,t,i):s instanceof ao?(function(u,h,p,g){if(!Sd(u.precondition,h))return p;const y=tw(u.fieldTransforms,g,h),b=h.data;return b.setAll(ck(u)),b.setAll(y),h.convertToFoundDocument(h.version,b).setHasLocalMutations(),p===null?null:p.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((k=>k.field)))})(s,e,t,i):(function(u,h,p){return Sd(u.precondition,h)?(h.convertToNoDocument(h.version).setHasLocalMutations(),null):p})(s,e,t)}function oI(s,e){let t=null;for(const i of s.fieldTransforms){const l=e.data.field(i.field),u=rk(i.transform,l||null);u!=null&&(t===null&&(t=mr.empty()),t.set(i.field,u))}return t||null}function Z2(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!(function(i,l){return i===void 0&&l===void 0||!(!i||!l)&&Fl(i,l,((u,h)=>rI(u,h)))})(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class Mu extends pf{constructor(e,t,i,l=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=l,this.type=0}getFieldMask(){return null}}class ao extends pf{constructor(e,t,i,l,u=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=l,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function ck(s){const e=new Map;return s.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=s.data.field(t);e.set(t,i)}})),e}function ew(s,e,t){const i=new Map;gn(s.length===t.length,32656,{Ve:t.length,de:s.length});for(let l=0;l<t.length;l++){const u=s[l],h=u.transform,p=e.data.field(u.field);i.set(u.field,sI(h,p,t[l]))}return i}function tw(s,e,t){const i=new Map;for(const l of s){const u=l.transform,h=t.data.field(l.field);i.set(l.field,nI(u,h,e))}return i}class gf extends pf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class lI extends pf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class cI{constructor(e,t,i,l){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=l}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let l=0;l<this.mutations.length;l++){const u=this.mutations[l];u.key.isEqual(e.key)&&aI(u,e,i[l])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=lu(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=lu(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=tk();return this.mutations.forEach((l=>{const u=e.get(l.key),h=u.overlayedDocument;let p=this.applyToLocalView(h,u.mutatedFields);p=t.has(l.key)?null:p;const g=lk(h,p);g!==null&&i.set(l.key,g),h.isValidDocument()||h.convertToNoDocument(Ct.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Yt())}isEqual(e){return this.batchId===e.batchId&&Fl(this.mutations,e.mutations,((t,i)=>Z2(t,i)))&&Fl(this.baseMutations,e.baseMutations,((t,i)=>Z2(t,i)))}}class ky{constructor(e,t,i,l){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=l}static from(e,t,i){gn(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let l=(function(){return J4})();const u=e.mutations;for(let h=0;h<u.length;h++)l=l.insert(u[h].key,i[h].version);return new ky(e,t,i,l)}}class uI{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class hI{constructor(e,t){this.count=e,this.unchangedNames=t}}var vs,tn;function dI(s){switch(s){case pe.OK:return xt(64938);case pe.CANCELLED:case pe.UNKNOWN:case pe.DEADLINE_EXCEEDED:case pe.RESOURCE_EXHAUSTED:case pe.INTERNAL:case pe.UNAVAILABLE:case pe.UNAUTHENTICATED:return!1;case pe.INVALID_ARGUMENT:case pe.NOT_FOUND:case pe.ALREADY_EXISTS:case pe.PERMISSION_DENIED:case pe.FAILED_PRECONDITION:case pe.ABORTED:case pe.OUT_OF_RANGE:case pe.UNIMPLEMENTED:case pe.DATA_LOSS:return!0;default:return xt(15467,{code:s})}}function uk(s){if(s===void 0)return la("GRPC error has no .code"),pe.UNKNOWN;switch(s){case vs.OK:return pe.OK;case vs.CANCELLED:return pe.CANCELLED;case vs.UNKNOWN:return pe.UNKNOWN;case vs.DEADLINE_EXCEEDED:return pe.DEADLINE_EXCEEDED;case vs.RESOURCE_EXHAUSTED:return pe.RESOURCE_EXHAUSTED;case vs.INTERNAL:return pe.INTERNAL;case vs.UNAVAILABLE:return pe.UNAVAILABLE;case vs.UNAUTHENTICATED:return pe.UNAUTHENTICATED;case vs.INVALID_ARGUMENT:return pe.INVALID_ARGUMENT;case vs.NOT_FOUND:return pe.NOT_FOUND;case vs.ALREADY_EXISTS:return pe.ALREADY_EXISTS;case vs.PERMISSION_DENIED:return pe.PERMISSION_DENIED;case vs.FAILED_PRECONDITION:return pe.FAILED_PRECONDITION;case vs.ABORTED:return pe.ABORTED;case vs.OUT_OF_RANGE:return pe.OUT_OF_RANGE;case vs.UNIMPLEMENTED:return pe.UNIMPLEMENTED;case vs.DATA_LOSS:return pe.DATA_LOSS;default:return xt(39323,{code:s})}}(tn=vs||(vs={}))[tn.OK=0]="OK",tn[tn.CANCELLED=1]="CANCELLED",tn[tn.UNKNOWN=2]="UNKNOWN",tn[tn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",tn[tn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",tn[tn.NOT_FOUND=5]="NOT_FOUND",tn[tn.ALREADY_EXISTS=6]="ALREADY_EXISTS",tn[tn.PERMISSION_DENIED=7]="PERMISSION_DENIED",tn[tn.UNAUTHENTICATED=16]="UNAUTHENTICATED",tn[tn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",tn[tn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",tn[tn.ABORTED=10]="ABORTED",tn[tn.OUT_OF_RANGE=11]="OUT_OF_RANGE",tn[tn.UNIMPLEMENTED=12]="UNIMPLEMENTED",tn[tn.INTERNAL=13]="INTERNAL",tn[tn.UNAVAILABLE=14]="UNAVAILABLE",tn[tn.DATA_LOSS=15]="DATA_LOSS";function fI(){return new TextEncoder}const mI=new Ya([4294967295,4294967295],0);function nw(s){const e=fI().encode(s),t=new Ex;return t.update(e),new Uint8Array(t.digest())}function sw(s){const e=new DataView(s.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),l=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new Ya([t,i],0),new Ya([l,u],0)]}class Ey{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new tu(`Invalid padding: ${t}`);if(i<0)throw new tu(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new tu(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new tu(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Ya.fromNumber(this.ge)}ye(e,t,i){let l=e.add(t.multiply(Ya.fromNumber(i)));return l.compare(mI)===1&&(l=new Ya([l.getBits(0),l.getBits(1)],0)),l.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=nw(e),[i,l]=sw(t);for(let u=0;u<this.hashCount;u++){const h=this.ye(i,l,u);if(!this.we(h))return!1}return!0}static create(e,t,i){const l=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),h=new Ey(u,l,t);return i.forEach((p=>h.insert(p))),h}insert(e){if(this.ge===0)return;const t=nw(e),[i,l]=sw(t);for(let u=0;u<this.hashCount;u++){const h=this.ye(i,l,u);this.be(h)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class tu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class yf{constructor(e,t,i,l,u){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=l,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const l=new Map;return l.set(e,Lu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new yf(Ct.min(),l,new Qn(Kt),ca(),Yt())}}class Lu{constructor(e,t,i,l,u){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=l,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Lu(i,t,Yt(),Yt(),Yt())}}class jd{constructor(e,t,i,l){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=l}}class hk{constructor(e,t){this.targetId=e,this.Ce=t}}class dk{constructor(e,t,i=Vs.EMPTY_BYTE_STRING,l=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=l}}class rw{constructor(){this.ve=0,this.Fe=iw(),this.Me=Vs.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Yt(),t=Yt(),i=Yt();return this.Fe.forEach(((l,u)=>{switch(u){case 0:e=e.add(l);break;case 2:t=t.add(l);break;case 1:i=i.add(l);break;default:xt(38017,{changeType:u})}})),new Lu(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=iw()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,gn(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class pI{constructor(e){this.Ge=e,this.ze=new Map,this.je=ca(),this.He=od(),this.Je=od(),this.Ze=new Qn(Kt)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:xt(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,l)=>{this.rt(l)&&t(l)}))}st(e){const t=e.targetId,i=e.Ce.count,l=this.ot(t);if(l){const u=l.target;if(Ng(u))if(i===0){const h=new ot(u.path);this.et(t,h,Ws.newNoDocument(h,Ct.min()))}else gn(i===1,20013,{expectedCount:i});else{const h=this._t(t);if(h!==i){const p=this.ut(e),g=p?this.ct(p,e,h):1;if(g!==0){this.it(t);const y=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,y)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:l=0},hashCount:u=0}=t;let h,p;try{h=Za(i).toUint8Array()}catch(g){if(g instanceof Ox)return zl("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{p=new Ey(h,l,u)}catch(g){return zl(g instanceof tu?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return p.ge===0?null:p}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let l=0;return i.forEach((u=>{const h=this.Ge.ht(),p=`projects/${h.projectId}/databases/${h.database}/documents/${u.path.canonicalString()}`;e.mightContain(p)||(this.et(t,u,null),l++)})),l}Tt(e){const t=new Map;this.ze.forEach(((u,h)=>{const p=this.ot(h);if(p){if(u.current&&Ng(p.target)){const g=new ot(p.target.path);this.It(g).has(h)||this.Et(h,g)||this.et(h,g,Ws.newNoDocument(g,e))}u.Be&&(t.set(h,u.ke()),u.Ke())}}));let i=Yt();this.Je.forEach(((u,h)=>{let p=!0;h.forEachWhile((g=>{const y=this.ot(g);return!y||y.purpose==="TargetPurposeLimboResolution"||(p=!1,!1)})),p&&(i=i.add(u))})),this.je.forEach(((u,h)=>h.setReadTime(e)));const l=new yf(e,t,this.Ze,this.je,i);return this.je=ca(),this.He=od(),this.Je=od(),this.Ze=new Qn(Kt),l}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const l=this.nt(e);this.Et(e,t)?l.qe(t,1):l.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new rw,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Es(Kt),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Es(Kt),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||We("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new rw),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function od(){return new Qn(ot.comparator)}function iw(){return new Qn(ot.comparator)}const gI={asc:"ASCENDING",desc:"DESCENDING"},yI={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},vI={and:"AND",or:"OR"};class bI{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Rg(s,e){return s.useProto3Json||lf(e)?e:{value:e}}function $d(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function fk(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function wI(s,e){return $d(s,e.toTimestamp())}function Ci(s){return gn(!!s,49232),Ct.fromTimestamp((function(t){const i=Ja(t);return new Vt(i.seconds,i.nanos)})(s))}function Ty(s,e){return Ig(s,e).canonicalString()}function Ig(s,e){const t=(function(l){return new Mn(["projects",l.projectId,"databases",l.database])})(s).child("documents");return e===void 0?t:t.child(e)}function mk(s){const e=Mn.fromString(s);return gn(bk(e),10190,{key:e.toString()}),e}function Dg(s,e){return Ty(s.databaseId,e.path)}function Bp(s,e){const t=mk(e);if(t.get(1)!==s.databaseId.projectId)throw new ze(pe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+s.databaseId.projectId);if(t.get(3)!==s.databaseId.database)throw new ze(pe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+s.databaseId.database);return new ot(gk(t))}function pk(s,e){return Ty(s.databaseId,e)}function _I(s){const e=mk(s);return e.length===4?Mn.emptyPath():gk(e)}function Mg(s){return new Mn(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function gk(s){return gn(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function aw(s,e,t){return{name:Dg(s,e),fields:t.value.mapValue.fields}}function xI(s,e){let t;if("targetChange"in e){e.targetChange;const i=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:xt(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),l=e.targetChange.targetIds||[],u=(function(y,b){return y.useProto3Json?(gn(b===void 0||typeof b=="string",58123),Vs.fromBase64String(b||"")):(gn(b===void 0||b instanceof Buffer||b instanceof Uint8Array,16193),Vs.fromUint8Array(b||new Uint8Array))})(s,e.targetChange.resumeToken),h=e.targetChange.cause,p=h&&(function(y){const b=y.code===void 0?pe.UNKNOWN:uk(y.code);return new ze(b,y.message||"")})(h);t=new dk(i,l,u,p||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const l=Bp(s,i.document.name),u=Ci(i.document.updateTime),h=i.document.createTime?Ci(i.document.createTime):Ct.min(),p=new mr({mapValue:{fields:i.document.fields}}),g=Ws.newFoundDocument(l,u,h,p),y=i.targetIds||[],b=i.removedTargetIds||[];t=new jd(y,b,g.key,g)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const l=Bp(s,i.document),u=i.readTime?Ci(i.readTime):Ct.min(),h=Ws.newNoDocument(l,u),p=i.removedTargetIds||[];t=new jd([],p,h.key,h)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const l=Bp(s,i.document),u=i.removedTargetIds||[];t=new jd([],u,l,null)}else{if(!("filter"in e))return xt(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:l=0,unchangedNames:u}=i,h=new hI(l,u),p=i.targetId;t=new hk(p,h)}}return t}function kI(s,e){let t;if(e instanceof Mu)t={update:aw(s,e.key,e.value)};else if(e instanceof gf)t={delete:Dg(s,e.key)};else if(e instanceof ao)t={update:aw(s,e.key,e.data),updateMask:II(e.fieldMask)};else{if(!(e instanceof lI))return xt(16599,{dt:e.type});t={verify:Dg(s,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(u,h){const p=h.transform;if(p instanceof bu)return{fieldPath:h.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(p instanceof $l)return{fieldPath:h.field.canonicalString(),appendMissingElements:{values:p.elements}};if(p instanceof Wl)return{fieldPath:h.field.canonicalString(),removeAllFromArray:{values:p.elements}};if(p instanceof wu)return{fieldPath:h.field.canonicalString(),increment:p.Ae};throw xt(20930,{transform:h.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(l,u){return u.updateTime!==void 0?{updateTime:wI(l,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:xt(27497)})(s,e.precondition)),t}function EI(s,e){return s&&s.length>0?(gn(e!==void 0,14353),s.map((t=>(function(l,u){let h=l.updateTime?Ci(l.updateTime):Ci(u);return h.isEqual(Ct.min())&&(h=Ci(u)),new iI(h,l.transformResults||[])})(t,e)))):[]}function TI(s,e){return{documents:[pk(s,e.path)]}}function SI(s,e){const t={structuredQuery:{}},i=e.path;let l;e.collectionGroup!==null?(l=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(l=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=pk(s,l);const u=(function(y){if(y.length!==0)return vk(ci.create(y,"and"))})(e.filters);u&&(t.structuredQuery.where=u);const h=(function(y){if(y.length!==0)return y.map((b=>(function(E){return{field:Dl(E.field),direction:NI(E.dir)}})(b)))})(e.orderBy);h&&(t.structuredQuery.orderBy=h);const p=Rg(s,e.limit);return p!==null&&(t.structuredQuery.limit=p),e.startAt&&(t.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{ft:t,parent:l}}function jI(s){let e=_I(s.parent);const t=s.structuredQuery,i=t.from?t.from.length:0;let l=null;if(i>0){gn(i===1,65062);const b=t.from[0];b.allDescendants?l=b.collectionId:e=e.child(b.collectionId)}let u=[];t.where&&(u=(function(k){const E=yk(k);return E instanceof ci&&Wx(E)?E.getFilters():[E]})(t.where));let h=[];t.orderBy&&(h=(function(k){return k.map((E=>(function(H){return new vu(Ml(H.field),(function(B){switch(B){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(H.direction))})(E)))})(t.orderBy));let p=null;t.limit&&(p=(function(k){let E;return E=typeof k=="object"?k.value:k,lf(E)?null:E})(t.limit));let g=null;t.startAt&&(g=(function(k){const E=!!k.before,O=k.values||[];return new qd(O,E)})(t.startAt));let y=null;return t.endAt&&(y=(function(k){const E=!k.before,O=k.values||[];return new qd(O,E)})(t.endAt)),$4(e,l,h,u,p,"F",g,y)}function CI(s,e){const t=(function(l){switch(l){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return xt(28987,{purpose:l})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function yk(s){return s.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Ml(t.unaryFilter.field);return bs.create(i,"==",{doubleValue:NaN});case"IS_NULL":const l=Ml(t.unaryFilter.field);return bs.create(l,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=Ml(t.unaryFilter.field);return bs.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const h=Ml(t.unaryFilter.field);return bs.create(h,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return xt(61313);default:return xt(60726)}})(s):s.fieldFilter!==void 0?(function(t){return bs.create(Ml(t.fieldFilter.field),(function(l){switch(l){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return xt(58110);default:return xt(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(s):s.compositeFilter!==void 0?(function(t){return ci.create(t.compositeFilter.filters.map((i=>yk(i))),(function(l){switch(l){case"AND":return"and";case"OR":return"or";default:return xt(1026)}})(t.compositeFilter.op))})(s):xt(30097,{filter:s})}function NI(s){return gI[s]}function AI(s){return yI[s]}function RI(s){return vI[s]}function Dl(s){return{fieldPath:s.canonicalString()}}function Ml(s){return Os.fromServerFormat(s.fieldPath)}function vk(s){return s instanceof bs?(function(t){if(t.op==="=="){if(G2(t.value))return{unaryFilter:{field:Dl(t.field),op:"IS_NAN"}};if(W2(t.value))return{unaryFilter:{field:Dl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(G2(t.value))return{unaryFilter:{field:Dl(t.field),op:"IS_NOT_NAN"}};if(W2(t.value))return{unaryFilter:{field:Dl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Dl(t.field),op:AI(t.op),value:t.value}}})(s):s instanceof ci?(function(t){const i=t.getFilters().map((l=>vk(l)));return i.length===1?i[0]:{compositeFilter:{op:RI(t.op),filters:i}}})(s):xt(54877,{filter:s})}function II(s){const e=[];return s.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function bk(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}function wk(s){return!!s&&typeof s._toProto=="function"&&s._protoValueType==="ProtoValue"}class $a{constructor(e,t,i,l,u=Ct.min(),h=Ct.min(),p=Vs.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=l,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=h,this.resumeToken=p,this.expectedCount=g}withSequenceNumber(e){return new $a(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new $a(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new $a(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new $a(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class DI{constructor(e){this.yt=e}}function MI(s){const e=jI({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?Hd(e,e.limit,"L"):e}class LI{constructor(){this.Sn=new OI}addToCollectionParentIndex(e,t){return this.Sn.add(t),ke.resolve()}getCollectionParents(e,t){return ke.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return ke.resolve()}deleteFieldIndex(e,t){return ke.resolve()}deleteAllFieldIndexes(e){return ke.resolve()}createTargetIndexes(e,t){return ke.resolve()}getDocumentsMatchingTarget(e,t){return ke.resolve(null)}getIndexType(e,t){return ke.resolve(0)}getFieldIndexes(e,t){return ke.resolve([])}getNextCollectionGroupToUpdate(e){return ke.resolve(null)}getMinOffset(e,t){return ke.resolve(Xa.min())}getMinOffsetFromCollectionGroup(e,t){return ke.resolve(Xa.min())}updateCollectionGroup(e,t,i){return ke.resolve()}updateIndexEntries(e,t){return ke.resolve()}}class OI{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t]||new Es(Mn.comparator),u=!l.has(i);return this.index[t]=l.add(i),u}has(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t];return l&&l.has(i)}getEntries(e){return(this.index[e]||new Es(Mn.comparator)).toArray()}}const ow={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},_k=41943040;class fr{static withCacheSize(e){return new fr(e,fr.DEFAULT_COLLECTION_PERCENTILE,fr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}fr.DEFAULT_COLLECTION_PERCENTILE=10,fr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,fr.DEFAULT=new fr(_k,fr.DEFAULT_COLLECTION_PERCENTILE,fr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),fr.DISABLED=new fr(-1,0,0);class Gl{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Gl(0)}static ar(){return new Gl(-1)}}const lw="LruGarbageCollector",PI=1048576;function cw([s,e],[t,i]){const l=Kt(s,t);return l===0?Kt(e,i):l}class VI{constructor(e){this.Pr=e,this.buffer=new Es(cw),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();cw(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class UI{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){We(lw,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){tc(t)?We(lw,"Ignoring IndexedDB error during garbage collection: ",t):await ec(t)}await this.Ar(3e5)}))}}class BI{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return ke.resolve(of.ce);const i=new VI(t);return this.Vr.forEachTarget(e,(l=>i.Er(l.sequenceNumber))).next((()=>this.Vr.mr(e,(l=>i.Er(l))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(We("LruGarbageCollector","Garbage collection skipped; disabled"),ke.resolve(ow)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(We("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),ow):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,l,u,h,p,g,y;const b=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((k=>(k>this.params.maximumSequenceNumbersToCollect?(We("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${k}`),l=this.params.maximumSequenceNumbersToCollect):l=k,h=Date.now(),this.nthSequenceNumber(e,l)))).next((k=>(i=k,p=Date.now(),this.removeTargets(e,i,t)))).next((k=>(u=k,g=Date.now(),this.removeOrphanedDocuments(e,i)))).next((k=>(y=Date.now(),Rl()<=Gt.DEBUG&&We("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${h-b}ms
	Determined least recently used ${l} in `+(p-h)+`ms
	Removed ${u} targets in `+(g-p)+`ms
	Removed ${k} documents in `+(y-g)+`ms
Total Duration: ${y-b}ms`),ke.resolve({didRun:!0,sequenceNumbersCollected:l,targetsRemoved:u,documentsRemoved:k}))))}}function zI(s,e){return new BI(s,e)}class FI{constructor(){this.changes=new Go((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ws.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?ke.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class qI{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class HI{constructor(e,t,i,l){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=l}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((l=>(i=l,this.remoteDocumentCache.getEntry(e,t)))).next((l=>(i!==null&&lu(i.mutation,l,Cr.empty(),Vt.now()),l)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Yt()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Yt()){const l=No();return this.populateOverlays(e,l,t).next((()=>this.computeViews(e,t,l,i).next((u=>{let h=eu();return u.forEach(((p,g)=>{h=h.insert(p,g.overlayedDocument)})),h}))))}getOverlayedDocuments(e,t){const i=No();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Yt())))}populateOverlays(e,t,i){const l=[];return i.forEach((u=>{t.has(u)||l.push(u)})),this.documentOverlayCache.getOverlays(e,l).next((u=>{u.forEach(((h,p)=>{t.set(h,p)}))}))}computeViews(e,t,i,l){let u=ca();const h=ou(),p=(function(){return ou()})();return t.forEach(((g,y)=>{const b=i.get(y.key);l.has(y.key)&&(b===void 0||b.mutation instanceof ao)?u=u.insert(y.key,y):b!==void 0?(h.set(y.key,b.mutation.getFieldMask()),lu(b.mutation,y,b.mutation.getFieldMask(),Vt.now())):h.set(y.key,Cr.empty())})),this.recalculateAndSaveOverlays(e,u).next((g=>(g.forEach(((y,b)=>h.set(y,b))),t.forEach(((y,b)=>p.set(y,new qI(b,h.get(y)??null)))),p)))}recalculateAndSaveOverlays(e,t){const i=ou();let l=new Qn(((h,p)=>h-p)),u=Yt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((h=>{for(const p of h)p.keys().forEach((g=>{const y=t.get(g);if(y===null)return;let b=i.get(g)||Cr.empty();b=p.applyToLocalView(y,b),i.set(g,b);const k=(l.get(p.batchId)||Yt()).add(g);l=l.insert(p.batchId,k)}))})).next((()=>{const h=[],p=l.getReverseIterator();for(;p.hasNext();){const g=p.getNext(),y=g.key,b=g.value,k=tk();b.forEach((E=>{if(!u.has(E)){const O=lk(t.get(E),i.get(E));O!==null&&k.set(E,O),u=u.add(E)}})),h.push(this.documentOverlayCache.saveOverlays(e,y,k))}return ke.waitFor(h)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,l){return W4(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Qx(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,l):this.getDocumentsMatchingCollectionQuery(e,t,i,l)}getNextDocuments(e,t,i,l){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,l).next((u=>{const h=l-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,l-u.size):ke.resolve(No());let p=mu,g=u;return h.next((y=>ke.forEach(y,((b,k)=>(p<k.largestBatchId&&(p=k.largestBatchId),u.get(b)?ke.resolve():this.remoteDocumentCache.getEntry(e,b).next((E=>{g=g.insert(b,E)}))))).next((()=>this.populateOverlays(e,y,u))).next((()=>this.computeViews(e,g,y,Yt()))).next((b=>({batchId:p,changes:ek(b)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ot(t)).next((i=>{let l=eu();return i.isFoundDocument()&&(l=l.insert(i.key,i)),l}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,l){const u=t.collectionGroup;let h=eu();return this.indexManager.getCollectionParents(e,u).next((p=>ke.forEach(p,(g=>{const y=(function(k,E){return new nc(E,null,k.explicitOrderBy.slice(),k.filters.slice(),k.limit,k.limitType,k.startAt,k.endAt)})(t,g.child(u));return this.getDocumentsMatchingCollectionQuery(e,y,i,l).next((b=>{b.forEach(((k,E)=>{h=h.insert(k,E)}))}))})).next((()=>h))))}getDocumentsMatchingCollectionQuery(e,t,i,l){let u;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((h=>(u=h,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,u,l)))).next((h=>{u.forEach(((g,y)=>{const b=y.getKey();h.get(b)===null&&(h=h.insert(b,Ws.newInvalidDocument(b)))}));let p=eu();return h.forEach(((g,y)=>{const b=u.get(g);b!==void 0&&lu(b.mutation,y,Cr.empty(),Vt.now()),df(t,y)&&(p=p.insert(g,y))})),p}))}}class $I{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return ke.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(l){return{id:l.id,version:l.version,createTime:Ci(l.createTime)}})(t)),ke.resolve()}getNamedQuery(e,t){return ke.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(l){return{name:l.name,query:MI(l.bundledQuery),readTime:Ci(l.readTime)}})(t)),ke.resolve()}}class WI{constructor(){this.overlays=new Qn(ot.comparator),this.Lr=new Map}getOverlay(e,t){return ke.resolve(this.overlays.get(t))}getOverlays(e,t){const i=No();return ke.forEach(t,(l=>this.getOverlay(e,l).next((u=>{u!==null&&i.set(l,u)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((l,u)=>{this.bt(e,t,u)})),ke.resolve()}removeOverlaysForBatchId(e,t,i){const l=this.Lr.get(i);return l!==void 0&&(l.forEach((u=>this.overlays=this.overlays.remove(u))),this.Lr.delete(i)),ke.resolve()}getOverlaysForCollection(e,t,i){const l=No(),u=t.length+1,h=new ot(t.child("")),p=this.overlays.getIteratorFrom(h);for(;p.hasNext();){const g=p.getNext().value,y=g.getKey();if(!t.isPrefixOf(y.path))break;y.path.length===u&&g.largestBatchId>i&&l.set(g.getKey(),g)}return ke.resolve(l)}getOverlaysForCollectionGroup(e,t,i,l){let u=new Qn(((y,b)=>y-b));const h=this.overlays.getIterator();for(;h.hasNext();){const y=h.getNext().value;if(y.getKey().getCollectionGroup()===t&&y.largestBatchId>i){let b=u.get(y.largestBatchId);b===null&&(b=No(),u=u.insert(y.largestBatchId,b)),b.set(y.getKey(),y)}}const p=No(),g=u.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((y,b)=>p.set(y,b))),!(p.size()>=l)););return ke.resolve(p)}bt(e,t,i){const l=this.overlays.get(i.key);if(l!==null){const h=this.Lr.get(l.largestBatchId).delete(i.key);this.Lr.set(l.largestBatchId,h)}this.overlays=this.overlays.insert(i.key,new uI(t,i));let u=this.Lr.get(t);u===void 0&&(u=Yt(),this.Lr.set(t,u)),this.Lr.set(t,u.add(i.key))}}class GI{constructor(){this.sessionToken=Vs.EMPTY_BYTE_STRING}getSessionToken(e){return ke.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ke.resolve()}}class Sy{constructor(){this.kr=new Es(Ss.Kr),this.qr=new Es(Ss.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new Ss(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new Ss(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new ot(new Mn([])),i=new Ss(t,e),l=new Ss(t,e+1),u=[];return this.qr.forEachInRange([i,l],(h=>{this.Wr(h),u.push(h.key)})),u}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new ot(new Mn([])),i=new Ss(t,e),l=new Ss(t,e+1);let u=Yt();return this.qr.forEachInRange([i,l],(h=>{u=u.add(h.key)})),u}containsKey(e){const t=new Ss(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Ss{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return ot.comparator(e.key,t.key)||Kt(e.Hr,t.Hr)}static Ur(e,t){return Kt(e.Hr,t.Hr)||ot.comparator(e.key,t.key)}}class KI{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Es(Ss.Kr)}checkEmpty(e){return ke.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,l){const u=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const h=new cI(u,t,i,l);this.mutationQueue.push(h);for(const p of l)this.Jr=this.Jr.add(new Ss(p.key,u)),this.indexManager.addToCollectionParentIndex(e,p.key.path.popLast());return ke.resolve(h)}lookupMutationBatch(e,t){return ke.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,l=this.Xr(i),u=l<0?0:l;return ke.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return ke.resolve(this.mutationQueue.length===0?yy:this.Yn-1)}getAllMutationBatches(e){return ke.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Ss(t,0),l=new Ss(t,Number.POSITIVE_INFINITY),u=[];return this.Jr.forEachInRange([i,l],(h=>{const p=this.Zr(h.Hr);u.push(p)})),ke.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Es(Kt);return t.forEach((l=>{const u=new Ss(l,0),h=new Ss(l,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([u,h],(p=>{i=i.add(p.Hr)}))})),ke.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,l=i.length+1;let u=i;ot.isDocumentKey(u)||(u=u.child(""));const h=new Ss(new ot(u),0);let p=new Es(Kt);return this.Jr.forEachWhile((g=>{const y=g.key.path;return!!i.isPrefixOf(y)&&(y.length===l&&(p=p.add(g.Hr)),!0)}),h),ke.resolve(this.Yr(p))}Yr(e){const t=[];return e.forEach((i=>{const l=this.Zr(i);l!==null&&t.push(l)})),t}removeMutationBatch(e,t){gn(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return ke.forEach(t.mutations,(l=>{const u=new Ss(l.key,t.batchId);return i=i.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,l.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new Ss(t,0),l=this.Jr.firstAfterOrEqual(i);return ke.resolve(t.isEqual(l&&l.key))}performConsistencyCheck(e){return this.mutationQueue.length,ke.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class YI{constructor(e){this.ti=e,this.docs=(function(){return new Qn(ot.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,l=this.docs.get(i),u=l?l.size:0,h=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:h}),this.size+=h-u,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return ke.resolve(i?i.document.mutableCopy():Ws.newInvalidDocument(t))}getEntries(e,t){let i=ca();return t.forEach((l=>{const u=this.docs.get(l);i=i.insert(l,u?u.document.mutableCopy():Ws.newInvalidDocument(l))})),ke.resolve(i)}getDocumentsMatchingQuery(e,t,i,l){let u=ca();const h=t.path,p=new ot(h.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(p);for(;g.hasNext();){const{key:y,value:{document:b}}=g.getNext();if(!h.isPrefixOf(y.path))break;y.path.length>h.length+1||x4(_4(b),i)<=0||(l.has(b.key)||df(t,b))&&(u=u.insert(b.key,b.mutableCopy()))}return ke.resolve(u)}getAllFromCollectionGroup(e,t,i,l){xt(9500)}ni(e,t){return ke.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new QI(this)}getSize(e){return ke.resolve(this.size)}}class QI extends FI{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,l)=>{l.isValidDocument()?t.push(this.Mr.addEntry(e,l)):this.Mr.removeEntry(i)})),ke.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class XI{constructor(e){this.persistence=e,this.ri=new Go((t=>wy(t)),_y),this.lastRemoteSnapshotVersion=Ct.min(),this.highestTargetId=0,this.ii=0,this.si=new Sy,this.targetCount=0,this.oi=Gl._r()}forEachTarget(e,t){return this.ri.forEach(((i,l)=>t(l))),ke.resolve()}getLastRemoteSnapshotVersion(e){return ke.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ke.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),ke.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),ke.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new Gl(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,ke.resolve()}updateTargetData(e,t){return this.lr(t),ke.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,ke.resolve()}removeTargets(e,t,i){let l=0;const u=[];return this.ri.forEach(((h,p)=>{p.sequenceNumber<=t&&i.get(p.targetId)===null&&(this.ri.delete(h),u.push(this.removeMatchingKeysForTargetId(e,p.targetId)),l++)})),ke.waitFor(u).next((()=>l))}getTargetCount(e){return ke.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return ke.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),ke.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const l=this.persistence.referenceDelegate,u=[];return l&&t.forEach((h=>{u.push(l.markPotentiallyOrphaned(e,h))})),ke.waitFor(u)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),ke.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return ke.resolve(i)}containsKey(e,t){return ke.resolve(this.si.containsKey(t))}}class xk{constructor(e,t){this._i={},this.overlays={},this.ai=new of(0),this.ui=!1,this.ui=!0,this.ci=new GI,this.referenceDelegate=e(this),this.li=new XI(this),this.indexManager=new LI,this.remoteDocumentCache=(function(l){return new YI(l)})((i=>this.referenceDelegate.hi(i))),this.serializer=new DI(t),this.Pi=new $I(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new WI,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new KI(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){We("MemoryPersistence","Starting transaction:",e);const l=new JI(this.ai.next());return this.referenceDelegate.Ti(),i(l).next((u=>this.referenceDelegate.Ii(l).next((()=>u)))).toPromise().then((u=>(l.raiseOnCommittedEvent(),u)))}Ei(e,t){return ke.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class JI extends E4{constructor(e){super(),this.currentSequenceNumber=e}}class jy{constructor(e){this.persistence=e,this.Ri=new Sy,this.Ai=null}static Vi(e){return new jy(e)}get di(){if(this.Ai)return this.Ai;throw xt(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),ke.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),ke.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),ke.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((l=>this.di.add(l.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((l=>{l.forEach((u=>this.di.add(u.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ke.forEach(this.di,(i=>{const l=ot.fromPath(i);return this.mi(e,l).next((u=>{u||t.removeEntry(l,Ct.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return ke.or([()=>ke.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Wd{constructor(e,t){this.persistence=e,this.fi=new Go((i=>j4(i.path)),((i,l)=>i.isEqual(l))),this.garbageCollector=zI(this,t)}static Vi(e,t){return new Wd(e,t)}Ti(){}Ii(e){return ke.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((l=>i+l))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return ke.forEach(this.fi,((i,l)=>this.wr(e,i,l).next((u=>u?ke.resolve():t(l)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const l=this.persistence.getRemoteDocumentCache(),u=l.newChangeBuffer();return l.ni(e,(h=>this.wr(e,h,t).next((p=>{p||(i++,u.removeEntry(h,Ct.min()))})))).next((()=>u.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),ke.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),ke.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),ke.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),ke.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Ed(e.data.value)),t}wr(e,t,i){return ke.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const l=this.fi.get(t);return ke.resolve(l!==void 0&&l>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Cy{constructor(e,t,i,l){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=l}static Es(e,t){let i=Yt(),l=Yt();for(const u of t.docChanges)switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:l=l.add(u.doc.key)}return new Cy(e,t.fromCache,i,l)}}class ZI{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class eD{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return NC()?8:T4(Gs())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,l){const u={result:null};return this.gs(e,t).next((h=>{u.result=h})).next((()=>{if(!u.result)return this.ps(e,t,l,i).next((h=>{u.result=h}))})).next((()=>{if(u.result)return;const h=new ZI;return this.ys(e,t,h).next((p=>{if(u.result=p,this.As)return this.ws(e,t,h,p.size)}))})).next((()=>u.result))}ws(e,t,i,l){return i.documentReadCount<this.Vs?(Rl()<=Gt.DEBUG&&We("QueryEngine","SDK will not create cache indexes for query:",Il(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),ke.resolve()):(Rl()<=Gt.DEBUG&&We("QueryEngine","Query:",Il(t),"scans",i.documentReadCount,"local documents and returns",l,"documents as results."),i.documentReadCount>this.ds*l?(Rl()<=Gt.DEBUG&&We("QueryEngine","The SDK decides to create cache indexes for query:",Il(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ji(t))):ke.resolve())}gs(e,t){if(X2(t))return ke.resolve(null);let i=ji(t);return this.indexManager.getIndexType(e,i).next((l=>l===0?null:(t.limit!==null&&l===1&&(t=Hd(t,null,"F"),i=ji(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((u=>{const h=Yt(...u);return this.fs.getDocuments(e,h).next((p=>this.indexManager.getMinOffset(e,i).next((g=>{const y=this.bs(t,p);return this.Ss(t,y,h,g.readTime)?this.gs(e,Hd(t,null,"F")):this.Ds(e,y,t,g)}))))})))))}ps(e,t,i,l){return X2(t)||l.isEqual(Ct.min())?ke.resolve(null):this.fs.getDocuments(e,i).next((u=>{const h=this.bs(t,u);return this.Ss(t,h,i,l)?ke.resolve(null):(Rl()<=Gt.DEBUG&&We("QueryEngine","Re-using previous result from %s to execute query: %s",l.toString(),Il(t)),this.Ds(e,h,t,w4(l,mu)).next((p=>p)))}))}bs(e,t){let i=new Es(Jx(e));return t.forEach(((l,u)=>{df(e,u)&&(i=i.add(u))})),i}Ss(e,t,i,l){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const u=e.limitType==="F"?t.last():t.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(l)>0)}ys(e,t,i){return Rl()<=Gt.DEBUG&&We("QueryEngine","Using full collection scan to execute query:",Il(t)),this.fs.getDocumentsMatchingQuery(e,t,Xa.min(),i)}Ds(e,t,i,l){return this.fs.getDocumentsMatchingQuery(e,i,l).next((u=>(t.forEach((h=>{u=u.insert(h.key,h)})),u)))}}const Ny="LocalStore",tD=3e8;class nD{constructor(e,t,i,l){this.persistence=e,this.Cs=t,this.serializer=l,this.vs=new Qn(Kt),this.Fs=new Go((u=>wy(u)),_y),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new HI(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function sD(s,e,t,i){return new nD(s,e,t,i)}async function kk(s,e){const t=Rt(s);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let l;return t.mutationQueue.getAllMutationBatches(i).next((u=>(l=u,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((u=>{const h=[],p=[];let g=Yt();for(const y of l){h.push(y.batchId);for(const b of y.mutations)g=g.add(b.key)}for(const y of u){p.push(y.batchId);for(const b of y.mutations)g=g.add(b.key)}return t.localDocuments.getDocuments(i,g).next((y=>({Ns:y,removedBatchIds:h,addedBatchIds:p})))}))}))}function rD(s,e){const t=Rt(s);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const l=e.batch.keys(),u=t.xs.newChangeBuffer({trackRemovals:!0});return(function(p,g,y,b){const k=y.batch,E=k.keys();let O=ke.resolve();return E.forEach((H=>{O=O.next((()=>b.getEntry(g,H))).next((q=>{const B=y.docVersions.get(H);gn(B!==null,48541),q.version.compareTo(B)<0&&(k.applyToRemoteDocument(q,y),q.isValidDocument()&&(q.setReadTime(y.commitVersion),b.addEntry(q)))}))})),O.next((()=>p.mutationQueue.removeMutationBatch(g,k)))})(t,i,e,u).next((()=>u.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,l,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(p){let g=Yt();for(let y=0;y<p.mutationResults.length;++y)p.mutationResults[y].transformResults.length>0&&(g=g.add(p.batch.mutations[y].key));return g})(e)))).next((()=>t.localDocuments.getDocuments(i,l)))}))}function Ek(s){const e=Rt(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function iD(s,e){const t=Rt(s),i=e.snapshotVersion;let l=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const h=t.xs.newChangeBuffer({trackRemovals:!0});l=t.vs;const p=[];e.targetChanges.forEach(((b,k)=>{const E=l.get(k);if(!E)return;p.push(t.li.removeMatchingKeys(u,b.removedDocuments,k).next((()=>t.li.addMatchingKeys(u,b.addedDocuments,k))));let O=E.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(k)!==null?O=O.withResumeToken(Vs.EMPTY_BYTE_STRING,Ct.min()).withLastLimboFreeSnapshotVersion(Ct.min()):b.resumeToken.approximateByteSize()>0&&(O=O.withResumeToken(b.resumeToken,i)),l=l.insert(k,O),(function(q,B,K){return q.resumeToken.approximateByteSize()===0||B.snapshotVersion.toMicroseconds()-q.snapshotVersion.toMicroseconds()>=tD?!0:K.addedDocuments.size+K.modifiedDocuments.size+K.removedDocuments.size>0})(E,O,b)&&p.push(t.li.updateTargetData(u,O))}));let g=ca(),y=Yt();if(e.documentUpdates.forEach((b=>{e.resolvedLimboDocuments.has(b)&&p.push(t.persistence.referenceDelegate.updateLimboDocument(u,b))})),p.push(aD(u,h,e.documentUpdates).next((b=>{g=b.Bs,y=b.Ls}))),!i.isEqual(Ct.min())){const b=t.li.getLastRemoteSnapshotVersion(u).next((k=>t.li.setTargetsMetadata(u,u.currentSequenceNumber,i)));p.push(b)}return ke.waitFor(p).next((()=>h.apply(u))).next((()=>t.localDocuments.getLocalViewOfDocuments(u,g,y))).next((()=>g))})).then((u=>(t.vs=l,u)))}function aD(s,e,t){let i=Yt(),l=Yt();return t.forEach((u=>i=i.add(u))),e.getEntries(s,i).next((u=>{let h=ca();return t.forEach(((p,g)=>{const y=u.get(p);g.isFoundDocument()!==y.isFoundDocument()&&(l=l.add(p)),g.isNoDocument()&&g.version.isEqual(Ct.min())?(e.removeEntry(p,g.readTime),h=h.insert(p,g)):!y.isValidDocument()||g.version.compareTo(y.version)>0||g.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(g),h=h.insert(p,g)):We(Ny,"Ignoring outdated watch update for ",p,". Current version:",y.version," Watch version:",g.version)})),{Bs:h,Ls:l}}))}function oD(s,e){const t=Rt(s);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=yy),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function lD(s,e){const t=Rt(s);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let l;return t.li.getTargetData(i,e).next((u=>u?(l=u,ke.resolve(l)):t.li.allocateTargetId(i).next((h=>(l=new $a(e,h,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,l).next((()=>l)))))))})).then((i=>{const l=t.vs.get(i.targetId);return(l===null||i.snapshotVersion.compareTo(l.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function Lg(s,e,t){const i=Rt(s),l=i.vs.get(e),u=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",u,(h=>i.persistence.referenceDelegate.removeTarget(h,l)))}catch(h){if(!tc(h))throw h;We(Ny,`Failed to update sequence numbers for target ${e}: ${h}`)}i.vs=i.vs.remove(e),i.Fs.delete(l.target)}function uw(s,e,t){const i=Rt(s);let l=Ct.min(),u=Yt();return i.persistence.runTransaction("Execute query","readwrite",(h=>(function(g,y,b){const k=Rt(g),E=k.Fs.get(b);return E!==void 0?ke.resolve(k.vs.get(E)):k.li.getTargetData(y,b)})(i,h,ji(e)).next((p=>{if(p)return l=p.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(h,p.targetId).next((g=>{u=g}))})).next((()=>i.Cs.getDocumentsMatchingQuery(h,e,t?l:Ct.min(),t?u:Yt()))).next((p=>(cD(i,Y4(e),p),{documents:p,ks:u})))))}function cD(s,e,t){let i=s.Ms.get(e)||Ct.min();t.forEach(((l,u)=>{u.readTime.compareTo(i)>0&&(i=u.readTime)})),s.Ms.set(e,i)}class hw{constructor(){this.activeTargetIds=tI()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class uD{constructor(){this.vo=new hw,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new hw,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class hD{Mo(e){}shutdown(){}}const dw="ConnectivityMonitor";class fw{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){We(dw,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){We(dw,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let ld=null;function Og(){return ld===null?ld=(function(){return 268435456+Math.round(2147483648*Math.random())})():ld++,"0x"+ld.toString(16)}const zp="RestConnection",dD={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class fD{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),l=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${l}`,this.$o=this.databaseId.database===zd?`project_id=${i}`:`project_id=${i}&database_id=${l}`}Wo(e,t,i,l,u){const h=Og(),p=this.Qo(e,t.toUriEncodedString());We(zp,`Sending RPC '${e}' ${h}:`,p,i);const g={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(g,l,u);const{host:y}=new URL(p),b=so(y);return this.zo(e,p,g,i,b).then((k=>(We(zp,`Received RPC '${e}' ${h}: `,k),k)),(k=>{throw zl(zp,`RPC '${e}' ${h} failed with error: `,k,"url: ",p,"request:",i),k}))}jo(e,t,i,l,u,h){return this.Wo(e,t,i,l,u)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Zl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((l,u)=>e[u]=l)),i&&i.headers.forEach(((l,u)=>e[u]=l))}Qo(e,t){const i=dD[e];let l=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(l=`${l}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),l}terminate(){}}class mD{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const Hs="WebChannelConnection",Wc=(s,e,t)=>{s.listen(e,(i=>{try{t(i)}catch(l){setTimeout((()=>{throw l}),0)}}))};class Ul extends fD{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Ul.c_){const e=Cx();Wc(e,jx.STAT_EVENT,(t=>{t.stat===Eg.PROXY?We(Hs,"STAT_EVENT: detected buffering proxy"):t.stat===Eg.NOPROXY&&We(Hs,"STAT_EVENT: detected no buffering proxy")})),Ul.c_=!0}}zo(e,t,i,l,u){const h=Og();return new Promise(((p,g)=>{const y=new Tx;y.setWithCredentials(!0),y.listenOnce(Sx.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case kd.NO_ERROR:const k=y.getResponseJson();We(Hs,`XHR for RPC '${e}' ${h} received:`,JSON.stringify(k)),p(k);break;case kd.TIMEOUT:We(Hs,`RPC '${e}' ${h} timed out`),g(new ze(pe.DEADLINE_EXCEEDED,"Request time out"));break;case kd.HTTP_ERROR:const E=y.getStatus();if(We(Hs,`RPC '${e}' ${h} failed with status:`,E,"response text:",y.getResponseText()),E>0){let O=y.getResponseJson();Array.isArray(O)&&(O=O[0]);const H=O?.error;if(H&&H.status&&H.message){const q=(function(K){const $=K.toLowerCase().replace(/_/g,"-");return Object.values(pe).indexOf($)>=0?$:pe.UNKNOWN})(H.status);g(new ze(q,H.message))}else g(new ze(pe.UNKNOWN,"Server responded with status "+y.getStatus()))}else g(new ze(pe.UNAVAILABLE,"Connection failed."));break;default:xt(9055,{l_:e,streamId:h,h_:y.getLastErrorCode(),P_:y.getLastError()})}}finally{We(Hs,`RPC '${e}' ${h} completed.`)}}));const b=JSON.stringify(l);We(Hs,`RPC '${e}' ${h} sending request:`,l),y.send(t,"POST",b,i,15)}))}T_(e,t,i){const l=Og(),u=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],h=this.createWebChannelTransport(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(p.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Go(p.initMessageHeaders,t,i),p.encodeInitMessageHeaders=!0;const y=u.join("");We(Hs,`Creating RPC '${e}' stream ${l}: ${y}`,p);const b=h.createWebChannel(y,p);this.I_(b);let k=!1,E=!1;const O=new mD({Ho:H=>{E?We(Hs,`Not sending because RPC '${e}' stream ${l} is closed:`,H):(k||(We(Hs,`Opening RPC '${e}' stream ${l} transport.`),b.open(),k=!0),We(Hs,`RPC '${e}' stream ${l} sending:`,H),b.send(H))},Jo:()=>b.close()});return Wc(b,Zc.EventType.OPEN,(()=>{E||(We(Hs,`RPC '${e}' stream ${l} transport opened.`),O.i_())})),Wc(b,Zc.EventType.CLOSE,(()=>{E||(E=!0,We(Hs,`RPC '${e}' stream ${l} transport closed`),O.o_(),this.E_(b))})),Wc(b,Zc.EventType.ERROR,(H=>{E||(E=!0,zl(Hs,`RPC '${e}' stream ${l} transport errored. Name:`,H.name,"Message:",H.message),O.o_(new ze(pe.UNAVAILABLE,"The operation could not be completed")))})),Wc(b,Zc.EventType.MESSAGE,(H=>{if(!E){const q=H.data[0];gn(!!q,16349);const B=q,K=B?.error||B[0]?.error;if(K){We(Hs,`RPC '${e}' stream ${l} received error:`,K);const $=K.status;let G=(function(be){const j=vs[be];if(j!==void 0)return uk(j)})($),fe=K.message;G===void 0&&(G=pe.INTERNAL,fe="Unknown error status: "+$+" with message "+K.message),E=!0,O.o_(new ze(G,fe)),b.close()}else We(Hs,`RPC '${e}' stream ${l} received:`,q),O.__(q)}})),Ul.u_(),setTimeout((()=>{O.s_()}),0),O}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return Nx()}}function pD(s){return new Ul(s)}function Fp(){return typeof document<"u"?document:null}function vf(s){return new bI(s,!0)}Ul.c_=!1;class Tk{constructor(e,t,i=1e3,l=1.5,u=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=l,this.V_=u,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),l=Math.max(0,t-i);l>0&&We("ExponentialBackoff",`Backing off for ${l} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,l,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const mw="PersistentStream";class Sk{constructor(e,t,i,l,u,h,p,g){this.Ci=e,this.b_=i,this.S_=l,this.connection=u,this.authCredentialsProvider=h,this.appCheckCredentialsProvider=p,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Tk(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===pe.RESOURCE_EXHAUSTED?(la(t.toString()),la("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===pe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,l])=>{this.D_===t&&this.G_(i,l)}),(i=>{e((()=>{const l=new ze(pe.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(l)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((l=>{i((()=>this.z_(l)))})),this.stream.onMessage((l=>{i((()=>++this.F_==1?this.H_(l):this.onNext(l)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return We(mw,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(We(mw,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class gD extends Sk{constructor(e,t,i,l,u,h){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,l,h),this.serializer=u}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=xI(this.serializer,e),i=(function(u){if(!("targetChange"in u))return Ct.min();const h=u.targetChange;return h.targetIds&&h.targetIds.length?Ct.min():h.readTime?Ci(h.readTime):Ct.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=Mg(this.serializer),t.addTarget=(function(u,h){let p;const g=h.target;if(p=Ng(g)?{documents:TI(u,g)}:{query:SI(u,g).ft},p.targetId=h.targetId,h.resumeToken.approximateByteSize()>0){p.resumeToken=fk(u,h.resumeToken);const y=Rg(u,h.expectedCount);y!==null&&(p.expectedCount=y)}else if(h.snapshotVersion.compareTo(Ct.min())>0){p.readTime=$d(u,h.snapshotVersion.toTimestamp());const y=Rg(u,h.expectedCount);y!==null&&(p.expectedCount=y)}return p})(this.serializer,e);const i=CI(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=Mg(this.serializer),t.removeTarget=e,this.K_(t)}}class yD extends Sk{constructor(e,t,i,l,u,h){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,l,h),this.serializer=u}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return gn(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,gn(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){gn(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=EI(e.writeResults,e.commitTime),i=Ci(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=Mg(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>kI(this.serializer,i)))};this.K_(t)}}class vD{}class bD extends vD{constructor(e,t,i,l){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=l,this.ia=!1}sa(){if(this.ia)throw new ze(pe.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,h])=>this.connection.Wo(e,Ig(t,i),l,u,h))).catch((u=>{throw u.name==="FirebaseError"?(u.code===pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new ze(pe.UNKNOWN,u.toString())}))}jo(e,t,i,l,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([h,p])=>this.connection.jo(e,Ig(t,i),l,h,p,u))).catch((h=>{throw h.name==="FirebaseError"?(h.code===pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),h):new ze(pe.UNKNOWN,h.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function wD(s,e,t,i){return new bD(s,e,t,i)}class _D{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(la(t),this.aa=!1):We("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Uo="RemoteStore";class xD{constructor(e,t,i,l,u){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=u,this.Aa.Mo((h=>{i.enqueueAndForget((async()=>{Ko(this)&&(We(Uo,"Restarting streams for network reachability change."),await(async function(g){const y=Rt(g);y.Ea.add(4),await Ou(y),y.Va.set("Unknown"),y.Ea.delete(4),await bf(y)})(this))}))})),this.Va=new _D(i,l)}}async function bf(s){if(Ko(s))for(const e of s.Ra)await e(!0)}async function Ou(s){for(const e of s.Ra)await e(!1)}function jk(s,e){const t=Rt(s);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Dy(t)?Iy(t):sc(t).O_()&&Ry(t,e))}function Ay(s,e){const t=Rt(s),i=sc(t);t.Ia.delete(e),i.O_()&&Ck(t,e),t.Ia.size===0&&(i.O_()?i.L_():Ko(t)&&t.Va.set("Unknown"))}function Ry(s,e){if(s.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ct.min())>0){const t=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}sc(s).Z_(e)}function Ck(s,e){s.da.$e(e),sc(s).X_(e)}function Iy(s){s.da=new pI({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),sc(s).start(),s.Va.ua()}function Dy(s){return Ko(s)&&!sc(s).x_()&&s.Ia.size>0}function Ko(s){return Rt(s).Ea.size===0}function Nk(s){s.da=void 0}async function kD(s){s.Va.set("Online")}async function ED(s){s.Ia.forEach(((e,t)=>{Ry(s,e)}))}async function TD(s,e){Nk(s),Dy(s)?(s.Va.ha(e),Iy(s)):s.Va.set("Unknown")}async function SD(s,e,t){if(s.Va.set("Online"),e instanceof dk&&e.state===2&&e.cause)try{await(async function(l,u){const h=u.cause;for(const p of u.targetIds)l.Ia.has(p)&&(await l.remoteSyncer.rejectListen(p,h),l.Ia.delete(p),l.da.removeTarget(p))})(s,e)}catch(i){We(Uo,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Gd(s,i)}else if(e instanceof jd?s.da.Xe(e):e instanceof hk?s.da.st(e):s.da.tt(e),!t.isEqual(Ct.min()))try{const i=await Ek(s.localStore);t.compareTo(i)>=0&&await(function(u,h){const p=u.da.Tt(h);return p.targetChanges.forEach(((g,y)=>{if(g.resumeToken.approximateByteSize()>0){const b=u.Ia.get(y);b&&u.Ia.set(y,b.withResumeToken(g.resumeToken,h))}})),p.targetMismatches.forEach(((g,y)=>{const b=u.Ia.get(g);if(!b)return;u.Ia.set(g,b.withResumeToken(Vs.EMPTY_BYTE_STRING,b.snapshotVersion)),Ck(u,g);const k=new $a(b.target,g,y,b.sequenceNumber);Ry(u,k)})),u.remoteSyncer.applyRemoteEvent(p)})(s,t)}catch(i){We(Uo,"Failed to raise snapshot:",i),await Gd(s,i)}}async function Gd(s,e,t){if(!tc(e))throw e;s.Ea.add(1),await Ou(s),s.Va.set("Offline"),t||(t=()=>Ek(s.localStore)),s.asyncQueue.enqueueRetryable((async()=>{We(Uo,"Retrying IndexedDB access"),await t(),s.Ea.delete(1),await bf(s)}))}function Ak(s,e){return e().catch((t=>Gd(s,t,e)))}async function wf(s){const e=Rt(s),t=to(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:yy;for(;jD(e);)try{const l=await oD(e.localStore,i);if(l===null){e.Ta.length===0&&t.L_();break}i=l.batchId,CD(e,l)}catch(l){await Gd(e,l)}Rk(e)&&Ik(e)}function jD(s){return Ko(s)&&s.Ta.length<10}function CD(s,e){s.Ta.push(e);const t=to(s);t.O_()&&t.Y_&&t.ea(e.mutations)}function Rk(s){return Ko(s)&&!to(s).x_()&&s.Ta.length>0}function Ik(s){to(s).start()}async function ND(s){to(s).ra()}async function AD(s){const e=to(s);for(const t of s.Ta)e.ea(t.mutations)}async function RD(s,e,t){const i=s.Ta.shift(),l=ky.from(i,e,t);await Ak(s,(()=>s.remoteSyncer.applySuccessfulWrite(l))),await wf(s)}async function ID(s,e){e&&to(s).Y_&&await(async function(i,l){if((function(h){return dI(h)&&h!==pe.ABORTED})(l.code)){const u=i.Ta.shift();to(i).B_(),await Ak(i,(()=>i.remoteSyncer.rejectFailedWrite(u.batchId,l))),await wf(i)}})(s,e),Rk(s)&&Ik(s)}async function pw(s,e){const t=Rt(s);t.asyncQueue.verifyOperationInProgress(),We(Uo,"RemoteStore received new credentials");const i=Ko(t);t.Ea.add(3),await Ou(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await bf(t)}async function DD(s,e){const t=Rt(s);e?(t.Ea.delete(2),await bf(t)):e||(t.Ea.add(2),await Ou(t),t.Va.set("Unknown"))}function sc(s){return s.ma||(s.ma=(function(t,i,l){const u=Rt(t);return u.sa(),new gD(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(s.datastore,s.asyncQueue,{Zo:kD.bind(null,s),Yo:ED.bind(null,s),t_:TD.bind(null,s),J_:SD.bind(null,s)}),s.Ra.push((async e=>{e?(s.ma.B_(),Dy(s)?Iy(s):s.Va.set("Unknown")):(await s.ma.stop(),Nk(s))}))),s.ma}function to(s){return s.fa||(s.fa=(function(t,i,l){const u=Rt(t);return u.sa(),new yD(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(s.datastore,s.asyncQueue,{Zo:()=>Promise.resolve(),Yo:ND.bind(null,s),t_:ID.bind(null,s),ta:AD.bind(null,s),na:RD.bind(null,s)}),s.Ra.push((async e=>{e?(s.fa.B_(),await wf(s)):(await s.fa.stop(),s.Ta.length>0&&(We(Uo,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))}))),s.fa}class My{constructor(e,t,i,l,u){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=l,this.removalCallback=u,this.deferred=new sa,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((h=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,l,u){const h=Date.now()+i,p=new My(e,t,h,l,u);return p.start(i),p}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ze(pe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ly(s,e){if(la("AsyncQueue",`${e}: ${s}`),tc(s))return new ze(pe.UNAVAILABLE,`${e}: ${s}`);throw s}class Bl{static emptySet(e){return new Bl(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||ot.comparator(t.key,i.key):(t,i)=>ot.comparator(t.key,i.key),this.keyedMap=eu(),this.sortedSet=new Qn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Bl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(!l.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Bl;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class gw{constructor(){this.ga=new Qn(ot.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):xt(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class Kl{constructor(e,t,i,l,u,h,p,g,y){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=l,this.mutatedKeys=u,this.fromCache=h,this.syncStateChanged=p,this.excludesMetadataChanges=g,this.hasCachedResults=y}static fromInitialDocuments(e,t,i,l,u){const h=[];return t.forEach((p=>{h.push({type:0,doc:p})})),new Kl(e,t,Bl.emptySet(t),h,i,l,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&hf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let l=0;l<t.length;l++)if(t[l].type!==i[l].type||!t[l].doc.isEqual(i[l].doc))return!1;return!0}}class MD{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class LD{constructor(){this.queries=yw(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const l=Rt(t),u=l.queries;l.queries=yw(),u.forEach(((h,p)=>{for(const g of p.ba)g.onError(i)}))})(this,new ze(pe.ABORTED,"Firestore shutting down"))}}function yw(){return new Go((s=>Xx(s)),hf)}async function Oy(s,e){const t=Rt(s);let i=3;const l=e.query;let u=t.queries.get(l);u?!u.Sa()&&e.Da()&&(i=2):(u=new MD,i=e.Da()?0:1);try{switch(i){case 0:u.wa=await t.onListen(l,!0);break;case 1:u.wa=await t.onListen(l,!1);break;case 2:await t.onFirstRemoteStoreListen(l)}}catch(h){const p=Ly(h,`Initialization of query '${Il(e.query)}' failed`);return void e.onError(p)}t.queries.set(l,u),u.ba.push(e),e.va(t.onlineState),u.wa&&e.Fa(u.wa)&&Vy(t)}async function Py(s,e){const t=Rt(s),i=e.query;let l=3;const u=t.queries.get(i);if(u){const h=u.ba.indexOf(e);h>=0&&(u.ba.splice(h,1),u.ba.length===0?l=e.Da()?0:1:!u.Sa()&&e.Da()&&(l=2))}switch(l){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function OD(s,e){const t=Rt(s);let i=!1;for(const l of e){const u=l.query,h=t.queries.get(u);if(h){for(const p of h.ba)p.Fa(l)&&(i=!0);h.wa=l}}i&&Vy(t)}function PD(s,e,t){const i=Rt(s),l=i.queries.get(e);if(l)for(const u of l.ba)u.onError(t);i.queries.delete(e)}function Vy(s){s.Ca.forEach((e=>{e.next()}))}var Pg,vw;(vw=Pg||(Pg={})).Ma="default",vw.Cache="cache";class Uy{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const l of e.docChanges)l.type!==3&&i.push(l);e=new Kl(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Kl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Pg.Cache}}class Dk{constructor(e){this.key=e}}class Mk{constructor(e){this.key=e}}class VD{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Yt(),this.mutatedKeys=Yt(),this.eu=Jx(e),this.tu=new Bl(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new gw,l=t?t.tu:this.tu;let u=t?t.mutatedKeys:this.mutatedKeys,h=l,p=!1;const g=this.query.limitType==="F"&&l.size===this.query.limit?l.last():null,y=this.query.limitType==="L"&&l.size===this.query.limit?l.first():null;if(e.inorderTraversal(((b,k)=>{const E=l.get(b),O=df(this.query,k)?k:null,H=!!E&&this.mutatedKeys.has(E.key),q=!!O&&(O.hasLocalMutations||this.mutatedKeys.has(O.key)&&O.hasCommittedMutations);let B=!1;E&&O?E.data.isEqual(O.data)?H!==q&&(i.track({type:3,doc:O}),B=!0):this.su(E,O)||(i.track({type:2,doc:O}),B=!0,(g&&this.eu(O,g)>0||y&&this.eu(O,y)<0)&&(p=!0)):!E&&O?(i.track({type:0,doc:O}),B=!0):E&&!O&&(i.track({type:1,doc:E}),B=!0,(g||y)&&(p=!0)),B&&(O?(h=h.add(O),u=q?u.add(b):u.delete(b)):(h=h.delete(b),u=u.delete(b)))})),this.query.limit!==null)for(;h.size>this.query.limit;){const b=this.query.limitType==="F"?h.last():h.first();h=h.delete(b.key),u=u.delete(b.key),i.track({type:1,doc:b})}return{tu:h,iu:i,Ss:p,mutatedKeys:u}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,l){const u=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const h=e.iu.ya();h.sort(((b,k)=>(function(O,H){const q=B=>{switch(B){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return xt(20277,{Vt:B})}};return q(O)-q(H)})(b.type,k.type)||this.eu(b.doc,k.doc))),this.ou(i),l=l??!1;const p=t&&!l?this._u():[],g=this.Ya.size===0&&this.current&&!l?1:0,y=g!==this.Xa;return this.Xa=g,h.length!==0||y?{snapshot:new Kl(this.query,e.tu,u,h,e.mutatedKeys,g===0,y,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:p}:{au:p}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new gw,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=Yt(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new Mk(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new Dk(i))})),t}cu(e){this.Za=e.ks,this.Ya=Yt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Kl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const By="SyncEngine";class UD{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class BD{constructor(e){this.key=e,this.hu=!1}}class zD{constructor(e,t,i,l,u,h){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=l,this.currentUser=u,this.maxConcurrentLimboResolutions=h,this.Pu={},this.Tu=new Go((p=>Xx(p)),hf),this.Iu=new Map,this.Eu=new Set,this.Ru=new Qn(ot.comparator),this.Au=new Map,this.Vu=new Sy,this.du={},this.mu=new Map,this.fu=Gl.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function FD(s,e,t=!0){const i=Bk(s);let l;const u=i.Tu.get(e);return u?(i.sharedClientState.addLocalQueryTarget(u.targetId),l=u.view.lu()):l=await Lk(i,e,t,!0),l}async function qD(s,e){const t=Bk(s);await Lk(t,e,!0,!1)}async function Lk(s,e,t,i){const l=await lD(s.localStore,ji(e)),u=l.targetId,h=s.sharedClientState.addLocalQueryTarget(u,t);let p;return i&&(p=await HD(s,e,u,h==="current",l.resumeToken)),s.isPrimaryClient&&t&&jk(s.remoteStore,l),p}async function HD(s,e,t,i,l){s.pu=(k,E,O)=>(async function(q,B,K,$){let G=B.view.ru(K);G.Ss&&(G=await uw(q.localStore,B.query,!1).then((({documents:j})=>B.view.ru(j,G))));const fe=$&&$.targetChanges.get(B.targetId),xe=$&&$.targetMismatches.get(B.targetId)!=null,be=B.view.applyChanges(G,q.isPrimaryClient,fe,xe);return ww(q,B.targetId,be.au),be.snapshot})(s,k,E,O);const u=await uw(s.localStore,e,!0),h=new VD(e,u.ks),p=h.ru(u.documents),g=Lu.createSynthesizedTargetChangeForCurrentChange(t,i&&s.onlineState!=="Offline",l),y=h.applyChanges(p,s.isPrimaryClient,g);ww(s,t,y.au);const b=new UD(e,t,h);return s.Tu.set(e,b),s.Iu.has(t)?s.Iu.get(t).push(e):s.Iu.set(t,[e]),y.snapshot}async function $D(s,e,t){const i=Rt(s),l=i.Tu.get(e),u=i.Iu.get(l.targetId);if(u.length>1)return i.Iu.set(l.targetId,u.filter((h=>!hf(h,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(l.targetId),i.sharedClientState.isActiveQueryTarget(l.targetId)||await Lg(i.localStore,l.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(l.targetId),t&&Ay(i.remoteStore,l.targetId),Vg(i,l.targetId)})).catch(ec)):(Vg(i,l.targetId),await Lg(i.localStore,l.targetId,!0))}async function WD(s,e){const t=Rt(s),i=t.Tu.get(e),l=t.Iu.get(i.targetId);t.isPrimaryClient&&l.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Ay(t.remoteStore,i.targetId))}async function GD(s,e,t){const i=eM(s);try{const l=await(function(h,p){const g=Rt(h),y=Vt.now(),b=p.reduce(((O,H)=>O.add(H.key)),Yt());let k,E;return g.persistence.runTransaction("Locally write mutations","readwrite",(O=>{let H=ca(),q=Yt();return g.xs.getEntries(O,b).next((B=>{H=B,H.forEach(((K,$)=>{$.isValidDocument()||(q=q.add(K))}))})).next((()=>g.localDocuments.getOverlayedDocuments(O,H))).next((B=>{k=B;const K=[];for(const $ of p){const G=oI($,k.get($.key).overlayedDocument);G!=null&&K.push(new ao($.key,G,qx(G.value.mapValue),sr.exists(!0)))}return g.mutationQueue.addMutationBatch(O,y,K,p)})).next((B=>{E=B;const K=B.applyToLocalDocumentSet(k,q);return g.documentOverlayCache.saveOverlays(O,B.batchId,K)}))})).then((()=>({batchId:E.batchId,changes:ek(k)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(l.batchId),(function(h,p,g){let y=h.du[h.currentUser.toKey()];y||(y=new Qn(Kt)),y=y.insert(p,g),h.du[h.currentUser.toKey()]=y})(i,l.batchId,t),await Pu(i,l.changes),await wf(i.remoteStore)}catch(l){const u=Ly(l,"Failed to persist write");t.reject(u)}}async function Ok(s,e){const t=Rt(s);try{const i=await iD(t.localStore,e);e.targetChanges.forEach(((l,u)=>{const h=t.Au.get(u);h&&(gn(l.addedDocuments.size+l.modifiedDocuments.size+l.removedDocuments.size<=1,22616),l.addedDocuments.size>0?h.hu=!0:l.modifiedDocuments.size>0?gn(h.hu,14607):l.removedDocuments.size>0&&(gn(h.hu,42227),h.hu=!1))})),await Pu(t,i,e)}catch(i){await ec(i)}}function bw(s,e,t){const i=Rt(s);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const l=[];i.Tu.forEach(((u,h)=>{const p=h.view.va(e);p.snapshot&&l.push(p.snapshot)})),(function(h,p){const g=Rt(h);g.onlineState=p;let y=!1;g.queries.forEach(((b,k)=>{for(const E of k.ba)E.va(p)&&(y=!0)})),y&&Vy(g)})(i.eventManager,e),l.length&&i.Pu.J_(l),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function KD(s,e,t){const i=Rt(s);i.sharedClientState.updateQueryState(e,"rejected",t);const l=i.Au.get(e),u=l&&l.key;if(u){let h=new Qn(ot.comparator);h=h.insert(u,Ws.newNoDocument(u,Ct.min()));const p=Yt().add(u),g=new yf(Ct.min(),new Map,new Qn(Kt),h,p);await Ok(i,g),i.Ru=i.Ru.remove(u),i.Au.delete(e),zy(i)}else await Lg(i.localStore,e,!1).then((()=>Vg(i,e,t))).catch(ec)}async function YD(s,e){const t=Rt(s),i=e.batch.batchId;try{const l=await rD(t.localStore,e);Vk(t,i,null),Pk(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Pu(t,l)}catch(l){await ec(l)}}async function QD(s,e,t){const i=Rt(s);try{const l=await(function(h,p){const g=Rt(h);return g.persistence.runTransaction("Reject batch","readwrite-primary",(y=>{let b;return g.mutationQueue.lookupMutationBatch(y,p).next((k=>(gn(k!==null,37113),b=k.keys(),g.mutationQueue.removeMutationBatch(y,k)))).next((()=>g.mutationQueue.performConsistencyCheck(y))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(y,b,p))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,b))).next((()=>g.localDocuments.getDocuments(y,b)))}))})(i.localStore,e);Vk(i,e,t),Pk(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Pu(i,l)}catch(l){await ec(l)}}function Pk(s,e){(s.mu.get(e)||[]).forEach((t=>{t.resolve()})),s.mu.delete(e)}function Vk(s,e,t){const i=Rt(s);let l=i.du[i.currentUser.toKey()];if(l){const u=l.get(e);u&&(t?u.reject(t):u.resolve(),l=l.remove(e)),i.du[i.currentUser.toKey()]=l}}function Vg(s,e,t=null){s.sharedClientState.removeLocalQueryTarget(e);for(const i of s.Iu.get(e))s.Tu.delete(i),t&&s.Pu.yu(i,t);s.Iu.delete(e),s.isPrimaryClient&&s.Vu.Gr(e).forEach((i=>{s.Vu.containsKey(i)||Uk(s,i)}))}function Uk(s,e){s.Eu.delete(e.path.canonicalString());const t=s.Ru.get(e);t!==null&&(Ay(s.remoteStore,t),s.Ru=s.Ru.remove(e),s.Au.delete(t),zy(s))}function ww(s,e,t){for(const i of t)i instanceof Dk?(s.Vu.addReference(i.key,e),XD(s,i)):i instanceof Mk?(We(By,"Document no longer in limbo: "+i.key),s.Vu.removeReference(i.key,e),s.Vu.containsKey(i.key)||Uk(s,i.key)):xt(19791,{wu:i})}function XD(s,e){const t=e.key,i=t.path.canonicalString();s.Ru.get(t)||s.Eu.has(i)||(We(By,"New document in limbo: "+t),s.Eu.add(i),zy(s))}function zy(s){for(;s.Eu.size>0&&s.Ru.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const t=new ot(Mn.fromString(e)),i=s.fu.next();s.Au.set(i,new BD(t)),s.Ru=s.Ru.insert(t,i),jk(s.remoteStore,new $a(ji(uf(t.path)),i,"TargetPurposeLimboResolution",of.ce))}}async function Pu(s,e,t){const i=Rt(s),l=[],u=[],h=[];i.Tu.isEmpty()||(i.Tu.forEach(((p,g)=>{h.push(i.pu(g,e,t).then((y=>{if((y||t)&&i.isPrimaryClient){const b=y?!y.fromCache:t?.targetChanges.get(g.targetId)?.current;i.sharedClientState.updateQueryState(g.targetId,b?"current":"not-current")}if(y){l.push(y);const b=Cy.Es(g.targetId,y);u.push(b)}})))})),await Promise.all(h),i.Pu.J_(l),await(async function(g,y){const b=Rt(g);try{await b.persistence.runTransaction("notifyLocalViewChanges","readwrite",(k=>ke.forEach(y,(E=>ke.forEach(E.Ts,(O=>b.persistence.referenceDelegate.addReference(k,E.targetId,O))).next((()=>ke.forEach(E.Is,(O=>b.persistence.referenceDelegate.removeReference(k,E.targetId,O)))))))))}catch(k){if(!tc(k))throw k;We(Ny,"Failed to update sequence numbers: "+k)}for(const k of y){const E=k.targetId;if(!k.fromCache){const O=b.vs.get(E),H=O.snapshotVersion,q=O.withLastLimboFreeSnapshotVersion(H);b.vs=b.vs.insert(E,q)}}})(i.localStore,u))}async function JD(s,e){const t=Rt(s);if(!t.currentUser.isEqual(e)){We(By,"User change. New user:",e.toKey());const i=await kk(t.localStore,e);t.currentUser=e,(function(u,h){u.mu.forEach((p=>{p.forEach((g=>{g.reject(new ze(pe.CANCELLED,h))}))})),u.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Pu(t,i.Ns)}}function ZD(s,e){const t=Rt(s),i=t.Au.get(e);if(i&&i.hu)return Yt().add(i.key);{let l=Yt();const u=t.Iu.get(e);if(!u)return l;for(const h of u){const p=t.Tu.get(h);l=l.unionWith(p.view.nu)}return l}}function Bk(s){const e=Rt(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=Ok.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=ZD.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=KD.bind(null,e),e.Pu.J_=OD.bind(null,e.eventManager),e.Pu.yu=PD.bind(null,e.eventManager),e}function eM(s){const e=Rt(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=YD.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=QD.bind(null,e),e}class Kd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=vf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return sD(this.persistence,new eD,e.initialUser,this.serializer)}Cu(e){return new xk(jy.Vi,this.serializer)}Du(e){return new uD}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Kd.provider={build:()=>new Kd};class tM extends Kd{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){gn(this.persistence.referenceDelegate instanceof Wd,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new UI(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?fr.withCacheSize(this.cacheSizeBytes):fr.DEFAULT;return new xk((i=>Wd.Vi(i,t)),this.serializer)}}class Ug{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>bw(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=JD.bind(null,this.syncEngine),await DD(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new LD})()}createDatastore(e){const t=vf(e.databaseInfo.databaseId),i=pD(e.databaseInfo);return wD(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,l,u,h,p){return new xD(i,l,u,h,p)})(this.localStore,this.datastore,e.asyncQueue,(t=>bw(this.syncEngine,t,0)),(function(){return fw.v()?new fw:new hD})())}createSyncEngine(e,t){return(function(l,u,h,p,g,y,b){const k=new zD(l,u,h,p,g,y);return b&&(k.gu=!0),k})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=Rt(t);We(Uo,"RemoteStore shutting down."),i.Ea.add(5),await Ou(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Ug.provider={build:()=>new Ug};class Fy{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):la("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const no="FirestoreClient";class nM{constructor(e,t,i,l,u){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=l,this.user=$s.UNAUTHENTICATED,this.clientId=gy.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(i,(async h=>{We(no,"Received user=",h.uid),await this.authCredentialListener(h),this.user=h})),this.appCheckCredentials.start(i,(h=>(We(no,"Received new app check token=",h),this.appCheckCredentialListener(h,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new sa;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=Ly(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function qp(s,e){s.asyncQueue.verifyOperationInProgress(),We(no,"Initializing OfflineComponentProvider");const t=s.configuration;await e.initialize(t);let i=t.initialUser;s.setCredentialChangeListener((async l=>{i.isEqual(l)||(await kk(e.localStore,l),i=l)})),e.persistence.setDatabaseDeletedListener((()=>s.terminate())),s._offlineComponents=e}async function _w(s,e){s.asyncQueue.verifyOperationInProgress();const t=await sM(s);We(no,"Initializing OnlineComponentProvider"),await e.initialize(t,s.configuration),s.setCredentialChangeListener((i=>pw(e.remoteStore,i))),s.setAppCheckTokenChangeListener(((i,l)=>pw(e.remoteStore,l))),s._onlineComponents=e}async function sM(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){We(no,"Using user provided OfflineComponentProvider");try{await qp(s,s._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(l){return l.name==="FirebaseError"?l.code===pe.FAILED_PRECONDITION||l.code===pe.UNIMPLEMENTED:!(typeof DOMException<"u"&&l instanceof DOMException)||l.code===22||l.code===20||l.code===11})(t))throw t;zl("Error using user provided cache. Falling back to memory cache: "+t),await qp(s,new Kd)}}else We(no,"Using default OfflineComponentProvider"),await qp(s,new tM(void 0));return s._offlineComponents}async function zk(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(We(no,"Using user provided OnlineComponentProvider"),await _w(s,s._uninitializedComponentsProvider._online)):(We(no,"Using default OnlineComponentProvider"),await _w(s,new Ug))),s._onlineComponents}function rM(s){return zk(s).then((e=>e.syncEngine))}async function Yd(s){const e=await zk(s),t=e.eventManager;return t.onListen=FD.bind(null,e.syncEngine),t.onUnlisten=$D.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=qD.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=WD.bind(null,e.syncEngine),t}function iM(s,e,t,i){const l=new Fy(i),u=new Uy(e,l,t);return s.asyncQueue.enqueueAndForget((async()=>Oy(await Yd(s),u))),()=>{l.Nu(),s.asyncQueue.enqueueAndForget((async()=>Py(await Yd(s),u)))}}function aM(s,e,t={}){const i=new sa;return s.asyncQueue.enqueueAndForget((async()=>(function(u,h,p,g,y){const b=new Fy({next:E=>{b.Nu(),h.enqueueAndForget((()=>Py(u,k)));const O=E.docs.has(p);!O&&E.fromCache?y.reject(new ze(pe.UNAVAILABLE,"Failed to get document because the client is offline.")):O&&E.fromCache&&g&&g.source==="server"?y.reject(new ze(pe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(E)},error:E=>y.reject(E)}),k=new Uy(uf(p.path),b,{includeMetadataChanges:!0,Ka:!0});return Oy(u,k)})(await Yd(s),s.asyncQueue,e,t,i))),i.promise}function oM(s,e,t={}){const i=new sa;return s.asyncQueue.enqueueAndForget((async()=>(function(u,h,p,g,y){const b=new Fy({next:E=>{b.Nu(),h.enqueueAndForget((()=>Py(u,k))),E.fromCache&&g.source==="server"?y.reject(new ze(pe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(E)},error:E=>y.reject(E)}),k=new Uy(p,b,{includeMetadataChanges:!0,Ka:!0});return Oy(u,k)})(await Yd(s),s.asyncQueue,e,t,i))),i.promise}function lM(s,e){const t=new sa;return s.asyncQueue.enqueueAndForget((async()=>GD(await rM(s),e,t))),t.promise}function Fk(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}const cM="ComponentProvider",xw=new Map;function uM(s,e,t,i,l){return new A4(s,e,t,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,Fk(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator,i)}const qk="firestore.googleapis.com",kw=!0;class Ew{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ze(pe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=qk,this.ssl=kw}else this.host=e.host,this.ssl=e.ssl??kw;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=_k;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<PI)throw new ze(pe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}v4("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Fk(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new ze(pe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new ze(pe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new ze(pe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,l){return i.timeoutSeconds===l.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class _f{constructor(e,t,i,l){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=l,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ew({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ze(pe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ze(pe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ew(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new l4;switch(i.type){case"firstParty":return new d4(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new ze(pe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=xw.get(t);i&&(We(cM,"Removing Datastore"),xw.delete(t),i.terminate())})(this),Promise.resolve()}}function hM(s,e,t,i={}){s=nr(s,_f);const l=so(e),u=s._getSettings(),h={...u,emulatorOptions:s._getEmulatorOptions()},p=`${e}:${t}`;l&&(ty(`https://${p}`),ny("Firestore",!0)),u.host!==qk&&u.host!==p&&zl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...u,host:p,ssl:l,emulatorOptions:i};if(!ia(g,h)&&(s._setSettings(g),i.mockUserToken)){let y,b;if(typeof i.mockUserToken=="string")y=i.mockUserToken,b=$s.MOCK_USER;else{y=O_(i.mockUserToken,s._app?.options.projectId);const k=i.mockUserToken.sub||i.mockUserToken.user_id;if(!k)throw new ze(pe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");b=new $s(k)}s._authCredentials=new c4(new Rx(y,b))}}class da{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new da(this.firestore,e,this._query)}}class ts{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Qa(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ts(this.firestore,e,this._key)}toJSON(){return{type:ts._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Du(t,ts._jsonSchema))return new ts(e,i||null,new ot(Mn.fromString(t.referencePath)))}}ts._jsonSchemaVersion="firestore/documentReference/1.0",ts._jsonSchema={type:ws("string",ts._jsonSchemaVersion),referencePath:ws("string")};class Qa extends da{constructor(e,t,i){super(e,t,uf(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ts(this.firestore,null,new ot(e))}withConverter(e){return new Qa(this.firestore,e,this._path)}}function wt(s,e,...t){if(s=yn(s),Ix("collection","path",e),s instanceof _f){const i=Mn.fromString(e,...t);return P2(i),new Qa(s,null,i)}{if(!(s instanceof ts||s instanceof Qa))throw new ze(pe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(Mn.fromString(e,...t));return P2(i),new Qa(s.firestore,null,i)}}function Ze(s,e,...t){if(s=yn(s),arguments.length===1&&(e=gy.newId()),Ix("doc","path",e),s instanceof _f){const i=Mn.fromString(e,...t);return O2(i),new ts(s,null,new ot(i))}{if(!(s instanceof ts||s instanceof Qa))throw new ze(pe.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(Mn.fromString(e,...t));return O2(i),new ts(s.firestore,s instanceof Qa?s.converter:null,new ot(i))}}const Tw="AsyncQueue";class Sw{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Tk(this,"async_queue_retry"),this._c=()=>{const i=Fp();i&&We(Tw,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Fp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Fp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new sa;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!tc(e))throw e;We(Tw,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,la("INTERNAL UNHANDLED ERROR: ",jw(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const l=My.createAndSchedule(this,e,t,i,(u=>this.hc(u)));return this.tc.push(l),l}uc(){this.nc&&xt(47125,{Pc:jw(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function jw(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}class Ri extends _f{constructor(e,t,i,l){super(e,t,i,l),this.type="firestore",this._queue=new Sw,this._persistenceKey=l?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Sw(e),this._firestoreClient=void 0,await e}}}function dM(s,e){const t=typeof s=="object"?s:Cu(),i=typeof s=="string"?s:zd,l=$o(t,"firestore").getImmediate({identifier:i});if(!l._initialized){const u=D_("firestore");u&&hM(l,...u)}return l}function Vu(s){if(s._terminated)throw new ze(pe.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||fM(s),s._firestoreClient}function fM(s){const e=s._freezeSettings(),t=uM(s._databaseId,s._app?.options.appId||"",s._persistenceKey,s._app?.options.apiKey,e);s._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new nM(s._authCredentials,s._appCheckCredentials,s._queue,t,s._componentsProvider&&(function(l){const u=l?._online.build();return{_offline:l?._offline.build(u),_online:u}})(s._componentsProvider))}class Gr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Gr(Vs.fromBase64String(e))}catch(t){throw new ze(pe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Gr(Vs.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Gr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Du(e,Gr._jsonSchema))return Gr.fromBase64String(e.bytes)}}Gr._jsonSchemaVersion="firestore/bytes/1.0",Gr._jsonSchema={type:ws("string",Gr._jsonSchemaVersion),bytes:ws("string")};class xf{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ze(pe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Os(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Yo{constructor(e){this._methodName=e}}class Ni{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ze(pe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ze(pe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Kt(this._lat,e._lat)||Kt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ni._jsonSchemaVersion}}static fromJSON(e){if(Du(e,Ni._jsonSchema))return new Ni(e.latitude,e.longitude)}}Ni._jsonSchemaVersion="firestore/geoPoint/1.0",Ni._jsonSchema={type:ws("string",Ni._jsonSchemaVersion),latitude:ws("number"),longitude:ws("number")};class ai{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,l){if(i.length!==l.length)return!1;for(let u=0;u<i.length;++u)if(i[u]!==l[u])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ai._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Du(e,ai._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ai(e.vectorValues);throw new ze(pe.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ai._jsonSchemaVersion="firestore/vectorValue/1.0",ai._jsonSchema={type:ws("string",ai._jsonSchemaVersion),vectorValues:ws("object")};const mM=/^__.*__$/;class pM{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new ao(e,this.data,this.fieldMask,t,this.fieldTransforms):new Mu(e,this.data,t,this.fieldTransforms)}}class Hk{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new ao(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function $k(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw xt(40011,{dataSource:s})}}class kf{constructor(e,t,i,l,u,h){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=l,u===void 0&&this.validatePath(),this.fieldTransforms=u||[],this.fieldMask=h||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new kf({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Qd(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if($k(this.dataSource)&&mM.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class gM{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||vf(e)}createContext(e,t,i,l=!1){return new kf({dataSource:e,methodName:t,targetDoc:i,path:Os.emptyPath(),arrayElement:!1,hasConverter:l},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Uu(s){const e=s._freezeSettings(),t=vf(s._databaseId);return new gM(s._databaseId,!!e.ignoreUndefinedProperties,t)}function qy(s,e,t,i,l,u={}){const h=s.createContext(u.merge||u.mergeFields?2:0,e,t,l);Ky("Data must be an object, but it was:",h,i);const p=Yk(i,h);let g,y;if(u.merge)g=new Cr(h.fieldMask),y=h.fieldTransforms;else if(u.mergeFields){const b=[];for(const k of u.mergeFields){const E=Bo(e,k,t);if(!h.contains(E))throw new ze(pe.INVALID_ARGUMENT,`Field '${E}' is specified in your field mask but missing from your input data.`);Jk(b,E)||b.push(E)}g=new Cr(b),y=h.fieldTransforms.filter((k=>g.covers(k.field)))}else g=null,y=h.fieldTransforms;return new pM(new mr(p),g,y)}class Ef extends Yo{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Ef}}function Wk(s,e,t){return new kf({dataSource:3,targetDoc:e.settings.targetDoc,methodName:s._methodName,arrayElement:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Hy extends Yo{_toFieldTransform(e){return new mf(e.path,new bu)}isEqual(e){return e instanceof Hy}}class $y extends Yo{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=Wk(this,e,!0),i=this.Ac.map((u=>Qo(u,t))),l=new $l(i);return new mf(e.path,l)}isEqual(e){return e instanceof $y&&ia(this.Ac,e.Ac)}}class Wy extends Yo{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=Wk(this,e,!0),i=this.Ac.map((u=>Qo(u,t))),l=new Wl(i);return new mf(e.path,l)}isEqual(e){return e instanceof Wy&&ia(this.Ac,e.Ac)}}class Gy extends Yo{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new wu(e.serializer,sk(e.serializer,this.Vc));return new mf(e.path,t)}isEqual(e){return e instanceof Gy&&this.Vc===e.Vc}}function Gk(s,e,t,i){const l=s.createContext(1,e,t);Ky("Data must be an object, but it was:",l,i);const u=[],h=mr.empty();io(i,((g,y)=>{const b=Xk(e,g,t);y=yn(y);const k=l.childContextForFieldPath(b);if(y instanceof Ef)u.push(b);else{const E=Qo(y,k);E!=null&&(u.push(b),h.set(b,E))}}));const p=new Cr(u);return new Hk(h,p,l.fieldTransforms)}function Kk(s,e,t,i,l,u){const h=s.createContext(1,e,t),p=[Bo(e,i,t)],g=[l];if(u.length%2!=0)throw new ze(pe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let E=0;E<u.length;E+=2)p.push(Bo(e,u[E])),g.push(u[E+1]);const y=[],b=mr.empty();for(let E=p.length-1;E>=0;--E)if(!Jk(y,p[E])){const O=p[E];let H=g[E];H=yn(H);const q=h.childContextForFieldPath(O);if(H instanceof Ef)y.push(O);else{const B=Qo(H,q);B!=null&&(y.push(O),b.set(O,B))}}const k=new Cr(y);return new Hk(b,k,h.fieldTransforms)}function yM(s,e,t,i=!1){return Qo(t,s.createContext(i?4:3,e))}function Qo(s,e){if(Qk(s=yn(s)))return Ky("Unsupported field value:",e,s),Yk(s,e);if(s instanceof Yo)return(function(i,l){if(!$k(l.dataSource))throw l.createError(`${i._methodName}() can only be used with update() and set()`);if(!l.path)throw l.createError(`${i._methodName}() is not currently supported inside arrays`);const u=i._toFieldTransform(l);u&&l.fieldTransforms.push(u)})(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,l){const u=[];let h=0;for(const p of i){let g=Qo(p,l.childContextForArray(h));g==null&&(g={nullValue:"NULL_VALUE"}),u.push(g),h++}return{arrayValue:{values:u}}})(s,e)}return(function(i,l){if((i=yn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return sk(l.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const u=Vt.fromDate(i);return{timestampValue:$d(l.serializer,u)}}if(i instanceof Vt){const u=new Vt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:$d(l.serializer,u)}}if(i instanceof Ni)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Gr)return{bytesValue:fk(l.serializer,i._byteString)};if(i instanceof ts){const u=l.databaseId,h=i.firestore._databaseId;if(!h.isEqual(u))throw l.createError(`Document reference is for database ${h.projectId}/${h.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:Ty(i.firestore._databaseId||l.databaseId,i._key.path)}}if(i instanceof ai)return(function(h,p){const g=h instanceof ai?h.toArray():h;return{mapValue:{fields:{[zx]:{stringValue:Fx},[Fd]:{arrayValue:{values:g.map((b=>{if(typeof b!="number")throw p.createError("VectorValues must only contain numeric values.");return xy(p.serializer,b)}))}}}}}})(i,l);if(wk(i))return i._toProto(l.serializer);throw l.createError(`Unsupported field value: ${af(i)}`)})(s,e)}function Yk(s,e){const t={};return Lx(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):io(s,((i,l)=>{const u=Qo(l,e.childContextForField(i));u!=null&&(t[i]=u)})),{mapValue:{fields:t}}}function Qk(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof Vt||s instanceof Ni||s instanceof Gr||s instanceof ts||s instanceof Yo||s instanceof ai||wk(s))}function Ky(s,e,t){if(!Qk(t)||!Dx(t)){const i=af(t);throw i==="an object"?e.createError(s+" a custom object"):e.createError(s+" "+i)}}function Bo(s,e,t){if((e=yn(e))instanceof xf)return e._internalPath;if(typeof e=="string")return Xk(s,e);throw Qd("Field path arguments must be of type string or ",s,!1,void 0,t)}const vM=new RegExp("[~\\*/\\[\\]]");function Xk(s,e,t){if(e.search(vM)>=0)throw Qd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,t);try{return new xf(...e.split("."))._internalPath}catch{throw Qd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,t)}}function Qd(s,e,t,i,l){const u=i&&!i.isEmpty(),h=l!==void 0;let p=`Function ${e}() called with invalid data`;t&&(p+=" (via `toFirestore()`)"),p+=". ";let g="";return(u||h)&&(g+=" (found",u&&(g+=` in field ${i}`),h&&(g+=` in document ${l}`),g+=")"),new ze(pe.INVALID_ARGUMENT,p+s+g)}function Jk(s,e){return s.some((t=>t.isEqual(e)))}class bM{convertValue(e,t="none"){switch(eo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return hs(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Za(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw xt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return io(e,((l,u)=>{i[l]=this.convertValue(u,t)})),i}convertVectorValue(e){const t=e.fields?.[Fd].arrayValue?.values?.map((i=>hs(i.doubleValue)));return new ai(t)}convertGeoPoint(e){return new Ni(hs(e.latitude),hs(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=cf(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(pu(e));default:return null}}convertTimestamp(e){const t=Ja(e);return new Vt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=Mn.fromString(e);gn(bk(i),9688,{name:e});const l=new gu(i.get(1),i.get(3)),u=new ot(i.popFirst(5));return l.isEqual(t)||la(`Document ${u} contains a document reference within a different database (${l.projectId}/${l.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),u}}class Yy extends bM{constructor(e){super(),this.firestore=e}convertBytes(e){return new Gr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ts(this.firestore,null,t)}}function er(){return new Hy("serverTimestamp")}function wM(...s){return new $y("arrayUnion",s)}function _M(...s){return new Wy("arrayRemove",s)}function Ao(s){return new Gy("increment",s)}const Cw="@firebase/firestore",Nw="4.10.0";function Aw(s){return(function(t,i){if(typeof t!="object"||t===null)return!1;const l=t;for(const u of i)if(u in l&&typeof l[u]=="function")return!0;return!1})(s,["next","error","complete"])}class Zk{constructor(e,t,i,l,u){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=l,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new ts(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new xM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(Bo("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class xM extends Zk{data(){return super.data()}}function eE(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new ze(pe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Qy{}class Xy extends Qy{}function cn(s,e,...t){let i=[];e instanceof Qy&&i.push(e),i=i.concat(t),(function(u){const h=u.filter((g=>g instanceof Jy)).length,p=u.filter((g=>g instanceof Tf)).length;if(h>1||h>0&&p>0)throw new ze(pe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const l of i)s=l._apply(s);return s}class Tf extends Xy{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new Tf(e,t,i)}_apply(e){const t=this._parse(e);return tE(e._query,t),new da(e.firestore,e.converter,Ag(e._query,t))}_parse(e){const t=Uu(e.firestore);return(function(u,h,p,g,y,b,k){let E;if(y.isKeyField()){if(b==="array-contains"||b==="array-contains-any")throw new ze(pe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${b}' queries on documentId().`);if(b==="in"||b==="not-in"){Iw(k,b);const H=[];for(const q of k)H.push(Rw(g,u,q));E={arrayValue:{values:H}}}else E=Rw(g,u,k)}else b!=="in"&&b!=="not-in"&&b!=="array-contains-any"||Iw(k,b),E=yM(p,h,k,b==="in"||b==="not-in");return bs.create(y,b,E)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function At(s,e,t){const i=e,l=Bo("where",s);return Tf._create(l,i,t)}class Jy extends Qy{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Jy(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:ci.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(l,u){let h=l;const p=u.getFlattenedFilters();for(const g of p)tE(h,g),h=Ag(h,g)})(e._query,t),new da(e.firestore,e.converter,Ag(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Zy extends Xy{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Zy(e,t)}_apply(e){const t=(function(l,u,h){if(l.startAt!==null)throw new ze(pe.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(l.endAt!==null)throw new ze(pe.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new vu(u,h)})(e._query,this._field,this._direction);return new da(e.firestore,e.converter,K4(e._query,t))}}function _u(s,e="asc"){const t=e,i=Bo("orderBy",s);return Zy._create(i,t)}class e0 extends Xy{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new e0(e,t,i)}_apply(e){return new da(e.firestore,e.converter,Hd(e._query,this._limit,this._limitType))}}function xu(s){return b4("limit",s),e0._create("limit",s,"F")}function Rw(s,e,t){if(typeof(t=yn(t))=="string"){if(t==="")throw new ze(pe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Qx(e)&&t.indexOf("/")!==-1)throw new ze(pe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(Mn.fromString(t));if(!ot.isDocumentKey(i))throw new ze(pe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return $2(s,new ot(i))}if(t instanceof ts)return $2(s,t._key);throw new ze(pe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${af(t)}.`)}function Iw(s,e){if(!Array.isArray(s)||s.length===0)throw new ze(pe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function tE(s,e){const t=(function(l,u){for(const h of l)for(const p of h.getFlattenedFilters())if(u.indexOf(p.op)>=0)return p.op;return null})(s.filters,(function(l){switch(l){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new ze(pe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ze(pe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function t0(s,e,t){let i;return i=s?t&&(t.merge||t.mergeFields)?s.toFirestore(e,t):s.toFirestore(e):e,i}class nu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Io extends Zk{constructor(e,t,i,l,u,h){super(e,t,i,l,h),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Cd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(Bo("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ze(pe.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Io._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Io._jsonSchemaVersion="firestore/documentSnapshot/1.0",Io._jsonSchema={type:ws("string",Io._jsonSchemaVersion),bundleSource:ws("string","DocumentSnapshot"),bundleName:ws("string"),bundle:ws("string")};class Cd extends Io{data(e={}){return super.data(e)}}class Do{constructor(e,t,i,l){this._firestore=e,this._userDataWriter=t,this._snapshot=l,this.metadata=new nu(l.hasPendingWrites,l.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Cd(this._firestore,this._userDataWriter,i.key,i,new nu(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ze(pe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(l,u){if(l._snapshot.oldDocs.isEmpty()){let h=0;return l._snapshot.docChanges.map((p=>{const g=new Cd(l._firestore,l._userDataWriter,p.doc.key,p.doc,new nu(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);return p.doc,{type:"added",doc:g,oldIndex:-1,newIndex:h++}}))}{let h=l._snapshot.oldDocs;return l._snapshot.docChanges.filter((p=>u||p.type!==3)).map((p=>{const g=new Cd(l._firestore,l._userDataWriter,p.doc.key,p.doc,new nu(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);let y=-1,b=-1;return p.type!==0&&(y=h.indexOf(p.doc.key),h=h.delete(p.doc.key)),p.type!==1&&(h=h.add(p.doc),b=h.indexOf(p.doc.key)),{type:kM(p.type),doc:g,oldIndex:y,newIndex:b}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ze(pe.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Do._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=gy.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],l=[];return this.docs.forEach((u=>{u._document!==null&&(t.push(u._document),i.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),l.push(u.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function kM(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return xt(61501,{type:s})}}Do._jsonSchemaVersion="firestore/querySnapshot/1.0",Do._jsonSchema={type:ws("string",Do._jsonSchemaVersion),bundleSource:ws("string","QuerySnapshot"),bundleName:ws("string"),bundle:ws("string")};class EM{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Uu(e)}set(e,t,i){this._verifyNotCommitted();const l=Hp(e,this._firestore),u=t0(l.converter,t,i),h=qy(this._dataReader,"WriteBatch.set",l._key,u,l.converter!==null,i);return this._mutations.push(h.toMutation(l._key,sr.none())),this}update(e,t,i,...l){this._verifyNotCommitted();const u=Hp(e,this._firestore);let h;return h=typeof(t=yn(t))=="string"||t instanceof xf?Kk(this._dataReader,"WriteBatch.update",u._key,t,i,l):Gk(this._dataReader,"WriteBatch.update",u._key,t),this._mutations.push(h.toMutation(u._key,sr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Hp(e,this._firestore);return this._mutations=this._mutations.concat(new gf(t._key,sr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ze(pe.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Hp(s,e){if((s=yn(s)).firestore!==e)throw new ze(pe.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return s}function pr(s){s=nr(s,ts);const e=nr(s.firestore,Ri),t=Vu(e);return aM(t,s._key).then((i=>sE(e,s,i)))}function nn(s){s=nr(s,da);const e=nr(s.firestore,Ri),t=Vu(e),i=new Yy(e);return eE(s._query),oM(t,s._query).then((l=>new Do(e,i,s,l)))}function Ps(s,e,t){s=nr(s,ts);const i=nr(s.firestore,Ri),l=t0(s.converter,e,t),u=Uu(i);return Bu(i,[qy(u,"setDoc",s._key,l,s.converter!==null,t).toMutation(s._key,sr.none())])}function js(s,e,t,...i){s=nr(s,ts);const l=nr(s.firestore,Ri),u=Uu(l);let h;return h=typeof(e=yn(e))=="string"||e instanceof xf?Kk(u,"updateDoc",s._key,e,t,i):Gk(u,"updateDoc",s._key,e),Bu(l,[h.toMutation(s._key,sr.exists(!0))])}function jr(s){return Bu(nr(s.firestore,Ri),[new gf(s._key,sr.none())])}function Kr(s,e){const t=nr(s.firestore,Ri),i=Ze(s),l=t0(s.converter,e),u=Uu(s.firestore);return Bu(t,[qy(u,"addDoc",i._key,l,s.converter!==null,{}).toMutation(i._key,sr.exists(!1))]).then((()=>i))}function nE(s,...e){s=yn(s);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||Aw(e[i])||(t=e[i++]);const l={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Aw(e[i])){const y=e[i];e[i]=y.next?.bind(y),e[i+1]=y.error?.bind(y),e[i+2]=y.complete?.bind(y)}let u,h,p;if(s instanceof ts)h=nr(s.firestore,Ri),p=uf(s._key.path),u={next:y=>{e[i]&&e[i](sE(h,s,y))},error:e[i+1],complete:e[i+2]};else{const y=nr(s,da);h=nr(y.firestore,Ri),p=y._query;const b=new Yy(h);u={next:k=>{e[i]&&e[i](new Do(h,b,y,k))},error:e[i+1],complete:e[i+2]},eE(s._query)}const g=Vu(h);return iM(g,p,l,u)}function Bu(s,e){const t=Vu(s);return lM(t,e)}function sE(s,e,t){const i=t.docs.get(e._key),l=new Yy(s);return new Io(s,l,e._key,i,new nu(t.hasPendingWrites,t.fromCache),e.converter)}function Dw(s){return s=nr(s,Ri),Vu(s),new EM(s,(e=>Bu(s,e)))}(function(e,t=!0){o4(Wo),oi(new Qr("firestore",((i,{instanceIdentifier:l,options:u})=>{const h=i.getProvider("app").getImmediate(),p=new Ri(new u4(i.getProvider("auth-internal")),new f4(h,i.getProvider("app-check-internal")),R4(h,l),h);return u={useFetchStreams:t,...u},p._setSettings(u),p}),"PUBLIC").setMultipleInstances(!0)),gr(Cw,Nw,e),gr(Cw,Nw,"esm2020")})();var TM="firebase",SM="12.8.0";gr(TM,SM,"app");const rE="firebasestorage.googleapis.com",iE="storageBucket",jM=120*1e3,CM=600*1e3;class ss extends di{constructor(e,t,i=0){super($p(e),`Firebase Storage: ${t} (${$p(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ss.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return $p(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ns;(function(s){s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ns||(ns={}));function $p(s){return"storage/"+s}function n0(){const s="An unknown error occurred, please check the error payload for server response.";return new ss(ns.UNKNOWN,s)}function NM(s){return new ss(ns.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")}function AM(s){return new ss(ns.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function RM(){const s="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new ss(ns.UNAUTHENTICATED,s)}function IM(){return new ss(ns.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function DM(s){return new ss(ns.UNAUTHORIZED,"User does not have permission to access '"+s+"'.")}function MM(){return new ss(ns.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function LM(){return new ss(ns.CANCELED,"User canceled the upload/download.")}function OM(s){return new ss(ns.INVALID_URL,"Invalid URL '"+s+"'.")}function PM(s){return new ss(ns.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function VM(){return new ss(ns.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+iE+"' property when initializing the app?")}function UM(){return new ss(ns.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function BM(){return new ss(ns.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function zM(s){return new ss(ns.UNSUPPORTED_ENVIRONMENT,`${s} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Bg(s){return new ss(ns.INVALID_ARGUMENT,s)}function aE(){return new ss(ns.APP_DELETED,"The Firebase app was deleted.")}function FM(s){return new ss(ns.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function cu(s,e){return new ss(ns.INVALID_FORMAT,"String does not match format '"+s+"': "+e)}function Gc(s){throw new ss(ns.INTERNAL_ERROR,"Internal error: "+s)}class tr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=tr.makeFromUrl(e,t)}catch{return new tr(e,"")}if(i.path==="")return i;throw PM(e)}static makeFromUrl(e,t){let i=null;const l="([A-Za-z0-9.\\-_]+)";function u(fe){fe.path.charAt(fe.path.length-1)==="/"&&(fe.path_=fe.path_.slice(0,-1))}const h="(/(.*))?$",p=new RegExp("^gs://"+l+h,"i"),g={bucket:1,path:3};function y(fe){fe.path_=decodeURIComponent(fe.path)}const b="v[A-Za-z0-9_]+",k=t.replace(/[.]/g,"\\."),E="(/([^?#]*).*)?$",O=new RegExp(`^https?://${k}/${b}/b/${l}/o${E}`,"i"),H={bucket:1,path:3},q=t===rE?"(?:storage.googleapis.com|storage.cloud.google.com)":t,B="([^?#]*)",K=new RegExp(`^https?://${q}/${l}/${B}`,"i"),G=[{regex:p,indices:g,postModify:u},{regex:O,indices:H,postModify:y},{regex:K,indices:{bucket:1,path:2},postModify:y}];for(let fe=0;fe<G.length;fe++){const xe=G[fe],be=xe.regex.exec(e);if(be){const j=be[xe.indices.bucket];let T=be[xe.indices.path];T||(T=""),i=new tr(j,T),xe.postModify(i);break}}if(i==null)throw OM(e);return i}}class qM{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function HM(s,e,t){let i=1,l=null,u=null,h=!1,p=0;function g(){return p===2}let y=!1;function b(...B){y||(y=!0,e.apply(null,B))}function k(B){l=setTimeout(()=>{l=null,s(O,g())},B)}function E(){u&&clearTimeout(u)}function O(B,...K){if(y){E();return}if(B){E(),b.call(null,B,...K);return}if(g()||h){E(),b.call(null,B,...K);return}i<64&&(i*=2);let G;p===1?(p=2,G=0):G=(i+Math.random())*1e3,k(G)}let H=!1;function q(B){H||(H=!0,E(),!y&&(l!==null?(B||(p=2),clearTimeout(l),k(0)):B||(p=1)))}return k(0),u=setTimeout(()=>{h=!0,q(!0)},t),q}function $M(s){s(!1)}function WM(s){return s!==void 0}function GM(s){return typeof s=="object"&&!Array.isArray(s)}function s0(s){return typeof s=="string"||s instanceof String}function Mw(s){return r0()&&s instanceof Blob}function r0(){return typeof Blob<"u"}function zg(s,e,t,i){if(i<e)throw Bg(`Invalid value for '${s}'. Expected ${e} or greater.`);if(i>t)throw Bg(`Invalid value for '${s}'. Expected ${t} or less.`)}function Sf(s,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${s}`}function oE(s){const e=encodeURIComponent;let t="?";for(const i in s)if(s.hasOwnProperty(i)){const l=e(i)+"="+e(s[i]);t=t+l+"&"}return t=t.slice(0,-1),t}var Mo;(function(s){s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT"})(Mo||(Mo={}));function KM(s,e){const t=s>=500&&s<600,l=[408,429].indexOf(s)!==-1,u=e.indexOf(s)!==-1;return t||l||u}class YM{constructor(e,t,i,l,u,h,p,g,y,b,k,E=!0,O=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=l,this.successCodes_=u,this.additionalRetryCodes_=h,this.callback_=p,this.errorCallback_=g,this.timeout_=y,this.progressCallback_=b,this.connectionFactory_=k,this.retry=E,this.isUsingEmulator=O,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((H,q)=>{this.resolve_=H,this.reject_=q,this.start_()})}start_(){const e=(i,l)=>{if(l){i(!1,new cd(!1,null,!0));return}const u=this.connectionFactory_();this.pendingConnection_=u;const h=p=>{const g=p.loaded,y=p.lengthComputable?p.total:-1;this.progressCallback_!==null&&this.progressCallback_(g,y)};this.progressCallback_!==null&&u.addUploadProgressListener(h),u.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&u.removeUploadProgressListener(h),this.pendingConnection_=null;const p=u.getErrorCode()===Mo.NO_ERROR,g=u.getStatus();if(!p||KM(g,this.additionalRetryCodes_)&&this.retry){const b=u.getErrorCode()===Mo.ABORT;i(!1,new cd(!1,null,b));return}const y=this.successCodes_.indexOf(g)!==-1;i(!0,new cd(y,u))})},t=(i,l)=>{const u=this.resolve_,h=this.reject_,p=l.connection;if(l.wasSuccessCode)try{const g=this.callback_(p,p.getResponse());WM(g)?u(g):u()}catch(g){h(g)}else if(p!==null){const g=n0();g.serverResponse=p.getErrorText(),this.errorCallback_?h(this.errorCallback_(p,g)):h(g)}else if(l.canceled){const g=this.appDelete_?aE():LM();h(g)}else{const g=MM();h(g)}};this.canceled_?t(!1,new cd(!1,null,!0)):this.backoffId_=HM(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&$M(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class cd{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function QM(s,e){e!==null&&e.length>0&&(s.Authorization="Firebase "+e)}function XM(s,e){s["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function JM(s,e){e&&(s["X-Firebase-GMPID"]=e)}function ZM(s,e){e!==null&&(s["X-Firebase-AppCheck"]=e)}function e6(s,e,t,i,l,u,h=!0,p=!1){const g=oE(s.urlParams),y=s.url+g,b=Object.assign({},s.headers);return JM(b,e),QM(b,t),XM(b,u),ZM(b,i),new YM(y,s.method,b,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,l,h,p)}function t6(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function n6(...s){const e=t6();if(e!==void 0){const t=new e;for(let i=0;i<s.length;i++)t.append(s[i]);return t.getBlob()}else{if(r0())return new Blob(s);throw new ss(ns.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function s6(s,e,t){return s.webkitSlice?s.webkitSlice(e,t):s.mozSlice?s.mozSlice(e,t):s.slice?s.slice(e,t):null}function r6(s){if(typeof atob>"u")throw zM("base-64");return atob(s)}const Ei={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Wp{constructor(e,t){this.data=e,this.contentType=t||null}}function i6(s,e){switch(s){case Ei.RAW:return new Wp(lE(e));case Ei.BASE64:case Ei.BASE64URL:return new Wp(cE(s,e));case Ei.DATA_URL:return new Wp(o6(e),l6(e))}throw n0()}function lE(s){const e=[];for(let t=0;t<s.length;t++){let i=s.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<s.length-1&&(s.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const u=i,h=s.charCodeAt(++t);i=65536|(u&1023)<<10|h&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function a6(s){let e;try{e=decodeURIComponent(s)}catch{throw cu(Ei.DATA_URL,"Malformed data URL.")}return lE(e)}function cE(s,e){switch(s){case Ei.BASE64:{const l=e.indexOf("-")!==-1,u=e.indexOf("_")!==-1;if(l||u)throw cu(s,"Invalid character '"+(l?"-":"_")+"' found: is it base64url encoded?");break}case Ei.BASE64URL:{const l=e.indexOf("+")!==-1,u=e.indexOf("/")!==-1;if(l||u)throw cu(s,"Invalid character '"+(l?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=r6(e)}catch(l){throw l.message.includes("polyfill")?l:cu(s,"Invalid character found")}const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i}class uE{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw cu(Ei.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=c6(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function o6(s){const e=new uE(s);return e.base64?cE(Ei.BASE64,e.rest):a6(e.rest)}function l6(s){return new uE(s).contentType}function c6(s,e){return s.length>=e.length?s.substring(s.length-e.length)===e:!1}class Ha{constructor(e,t){let i=0,l="";Mw(e)?(this.data_=e,i=e.size,l=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=l}size(){return this.size_}type(){return this.type_}slice(e,t){if(Mw(this.data_)){const i=this.data_,l=s6(i,e,t);return l===null?null:new Ha(l)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new Ha(i,!0)}}static getBlob(...e){if(r0()){const t=e.map(i=>i instanceof Ha?i.data_:i);return new Ha(n6.apply(null,t))}else{const t=e.map(h=>s0(h)?i6(Ei.RAW,h).data:h.data_);let i=0;t.forEach(h=>{i+=h.byteLength});const l=new Uint8Array(i);let u=0;return t.forEach(h=>{for(let p=0;p<h.length;p++)l[u++]=h[p]}),new Ha(l,!0)}}uploadData(){return this.data_}}function i0(s){let e;try{e=JSON.parse(s)}catch{return null}return GM(e)?e:null}function u6(s){if(s.length===0)return null;const e=s.lastIndexOf("/");return e===-1?"":s.slice(0,e)}function h6(s,e){const t=e.split("/").filter(i=>i.length>0).join("/");return s.length===0?t:s+"/"+t}function hE(s){const e=s.lastIndexOf("/",s.length-2);return e===-1?s:s.slice(e+1)}function d6(s,e){return e}class Zs{constructor(e,t,i,l){this.server=e,this.local=t||e,this.writable=!!i,this.xform=l||d6}}let ud=null;function f6(s){return!s0(s)||s.length<2?s:hE(s)}function dE(){if(ud)return ud;const s=[];s.push(new Zs("bucket")),s.push(new Zs("generation")),s.push(new Zs("metageneration")),s.push(new Zs("name","fullPath",!0));function e(u,h){return f6(h)}const t=new Zs("name");t.xform=e,s.push(t);function i(u,h){return h!==void 0?Number(h):h}const l=new Zs("size");return l.xform=i,s.push(l),s.push(new Zs("timeCreated")),s.push(new Zs("updated")),s.push(new Zs("md5Hash",null,!0)),s.push(new Zs("cacheControl",null,!0)),s.push(new Zs("contentDisposition",null,!0)),s.push(new Zs("contentEncoding",null,!0)),s.push(new Zs("contentLanguage",null,!0)),s.push(new Zs("contentType",null,!0)),s.push(new Zs("metadata","customMetadata",!0)),ud=s,ud}function m6(s,e){function t(){const i=s.bucket,l=s.fullPath,u=new tr(i,l);return e._makeStorageReference(u)}Object.defineProperty(s,"ref",{get:t})}function p6(s,e,t){const i={};i.type="file";const l=t.length;for(let u=0;u<l;u++){const h=t[u];i[h.local]=h.xform(i,e[h.server])}return m6(i,s),i}function fE(s,e,t){const i=i0(e);return i===null?null:p6(s,i,t)}function g6(s,e,t,i){const l=i0(e);if(l===null||!s0(l.downloadTokens))return null;const u=l.downloadTokens;if(u.length===0)return null;const h=encodeURIComponent;return u.split(",").map(y=>{const b=s.bucket,k=s.fullPath,E="/b/"+h(b)+"/o/"+h(k),O=Sf(E,t,i),H=oE({alt:"media",token:y});return O+H})[0]}function y6(s,e){const t={},i=e.length;for(let l=0;l<i;l++){const u=e[l];u.writable&&(t[u.server]=s[u.local])}return JSON.stringify(t)}const Lw="prefixes",Ow="items";function v6(s,e,t){const i={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[Lw])for(const l of t[Lw]){const u=l.replace(/\/$/,""),h=s._makeStorageReference(new tr(e,u));i.prefixes.push(h)}if(t[Ow])for(const l of t[Ow]){const u=s._makeStorageReference(new tr(e,l.name));i.items.push(u)}return i}function b6(s,e,t){const i=i0(t);return i===null?null:v6(s,e,i)}class a0{constructor(e,t,i,l){this.url=e,this.method=t,this.handler=i,this.timeout=l,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function o0(s){if(!s)throw n0()}function w6(s,e){function t(i,l){const u=fE(s,l,e);return o0(u!==null),u}return t}function _6(s,e){function t(i,l){const u=b6(s,e,l);return o0(u!==null),u}return t}function x6(s,e){function t(i,l){const u=fE(s,l,e);return o0(u!==null),g6(u,l,s.host,s._protocol)}return t}function l0(s){function e(t,i){let l;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?l=IM():l=RM():t.getStatus()===402?l=AM(s.bucket):t.getStatus()===403?l=DM(s.path):l=i,l.status=t.getStatus(),l.serverResponse=i.serverResponse,l}return e}function k6(s){const e=l0(s);function t(i,l){let u=e(i,l);return i.getStatus()===404&&(u=NM(s.path)),u.serverResponse=l.serverResponse,u}return t}function E6(s,e,t,i,l){const u={};e.isRoot?u.prefix="":u.prefix=e.path+"/",t.length>0&&(u.delimiter=t),i&&(u.pageToken=i),l&&(u.maxResults=l);const h=e.bucketOnlyServerUrl(),p=Sf(h,s.host,s._protocol),g="GET",y=s.maxOperationRetryTime,b=new a0(p,g,_6(s,e.bucket),y);return b.urlParams=u,b.errorHandler=l0(e),b}function T6(s,e,t){const i=e.fullServerUrl(),l=Sf(i,s.host,s._protocol),u="GET",h=s.maxOperationRetryTime,p=new a0(l,u,x6(s,t),h);return p.errorHandler=k6(e),p}function S6(s,e){return s&&s.contentType||e&&e.type()||"application/octet-stream"}function j6(s,e,t){const i=Object.assign({},t);return i.fullPath=s.path,i.size=e.size(),i.contentType||(i.contentType=S6(null,e)),i}function C6(s,e,t,i,l){const u=e.bucketOnlyServerUrl(),h={"X-Goog-Upload-Protocol":"multipart"};function p(){let G="";for(let fe=0;fe<2;fe++)G=G+Math.random().toString().slice(2);return G}const g=p();h["Content-Type"]="multipart/related; boundary="+g;const y=j6(e,i,l),b=y6(y,t),k="--"+g+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+b+`\r
--`+g+`\r
Content-Type: `+y.contentType+`\r
\r
`,E=`\r
--`+g+"--",O=Ha.getBlob(k,i,E);if(O===null)throw UM();const H={name:y.fullPath},q=Sf(u,s.host,s._protocol),B="POST",K=s.maxUploadRetryTime,$=new a0(q,B,w6(s,t),K);return $.urlParams=H,$.headers=h,$.body=O.uploadData(),$.errorHandler=l0(e),$}class N6{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Mo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Mo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Mo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,l,u){if(this.sent_)throw Gc("cannot .send() more than once");if(so(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),u!==void 0)for(const h in u)u.hasOwnProperty(h)&&this.xhr_.setRequestHeader(h,u[h].toString());return l!==void 0?this.xhr_.send(l):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Gc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Gc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Gc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Gc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class A6 extends N6{initXhr(){this.xhr_.responseType="text"}}function c0(){return new A6}class zo{constructor(e,t){this._service=e,t instanceof tr?this._location=t:this._location=tr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new zo(e,t)}get root(){const e=new tr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return hE(this._location.path)}get storage(){return this._service}get parent(){const e=u6(this._location.path);if(e===null)return null;const t=new tr(this._location.bucket,e);return new zo(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw FM(e)}}function R6(s,e,t){s._throwIfRoot("uploadBytes");const i=C6(s.storage,s._location,dE(),new Ha(e,!0),t);return s.storage.makeRequestWithTokens(i,c0).then(l=>({metadata:l,ref:s}))}function I6(s){const e={prefixes:[],items:[]};return mE(s,e).then(()=>e)}async function mE(s,e,t){const l=await D6(s,{pageToken:t});e.prefixes.push(...l.prefixes),e.items.push(...l.items),l.nextPageToken!=null&&await mE(s,e,l.nextPageToken)}function D6(s,e){e!=null&&typeof e.maxResults=="number"&&zg("options.maxResults",1,1e3,e.maxResults);const t=e||{},i=E6(s.storage,s._location,"/",t.pageToken,t.maxResults);return s.storage.makeRequestWithTokens(i,c0)}function M6(s){s._throwIfRoot("getDownloadURL");const e=T6(s.storage,s._location,dE());return s.storage.makeRequestWithTokens(e,c0).then(t=>{if(t===null)throw BM();return t})}function L6(s,e){const t=h6(s._location.path,e),i=new tr(s._location.bucket,t);return new zo(s.storage,i)}function O6(s){return/^[A-Za-z]+:\/\//.test(s)}function P6(s,e){return new zo(s,e)}function pE(s,e){if(s instanceof u0){const t=s;if(t._bucket==null)throw VM();const i=new zo(t,t._bucket);return e!=null?pE(i,e):i}else return e!==void 0?L6(s,e):s}function V6(s,e){if(e&&O6(e)){if(s instanceof u0)return P6(s,e);throw Bg("To use ref(service, url), the first argument must be a Storage instance.")}else return pE(s,e)}function Pw(s,e){const t=e?.[iE];return t==null?null:tr.makeFromBucketSpec(t,s)}function U6(s,e,t,i={}){s.host=`${e}:${t}`;const l=so(e);l&&(ty(`https://${s.host}/b`),ny("Storage",!0)),s._isUsingEmulator=!0,s._protocol=l?"https":"http";const{mockUserToken:u}=i;u&&(s._overrideAuthToken=typeof u=="string"?u:O_(u,s.app.options.projectId))}class u0{constructor(e,t,i,l,u,h=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=l,this._firebaseVersion=u,this._isUsingEmulator=h,this._bucket=null,this._host=rE,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=jM,this._maxUploadRetryTime=CM,this._requests=new Set,l!=null?this._bucket=tr.makeFromBucketSpec(l,this._host):this._bucket=Pw(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=tr.makeFromBucketSpec(this._url,e):this._bucket=Pw(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){zg("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){zg("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Sr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new zo(this,e)}_makeRequest(e,t,i,l,u=!0){if(this._deleted)return new qM(aE());{const h=e6(e,this._appId,i,l,t,this._firebaseVersion,u,this._isUsingEmulator);return this._requests.add(h),h.getPromise().then(()=>this._requests.delete(h),()=>this._requests.delete(h)),h}}async makeRequestWithTokens(e,t){const[i,l]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,l).getPromise()}}const Vw="@firebase/storage",Uw="0.14.0";const gE="storage";function Nd(s,e,t){return s=yn(s),R6(s,e,t)}function Bw(s){return s=yn(s),I6(s)}function Lo(s){return s=yn(s),M6(s)}function Wa(s,e){return s=yn(s),V6(s,e)}function B6(s=Cu(),e){s=yn(s);const i=$o(s,gE).getImmediate({identifier:e}),l=D_("storage");return l&&z6(i,...l),i}function z6(s,e,t,i={}){U6(s,e,t,i)}function F6(s,{instanceIdentifier:e}){const t=s.getProvider("app").getImmediate(),i=s.getProvider("auth-internal"),l=s.getProvider("app-check-internal");return new u0(t,i,l,e,Wo)}function q6(){oi(new Qr(gE,F6,"PUBLIC").setMultipleInstances(!0)),gr(Vw,Uw,""),gr(Vw,Uw,"esm2020")}q6();const yE={apiKey:"AIzaSyBCIgMJd3By7qkWH27YiW9VooIBGE3bFLs",authDomain:"mind-core-fitness-client.firebaseapp.com",projectId:"mind-core-fitness-client",storageBucket:"mind-core-fitness-client.firebasestorage.app",messagingSenderId:"669343392406",appId:"1:669343392406:web:f5a35ee062387e7d6f58b7"},h0=iy(yE),So=kx(h0),_e=dM(h0),Ga=B6(h0),H6=iy(yE,"secondary"),lO=kx(H6),$6="EYdciKDOi3UYBLk1u8hHams5tmO2",vE=_.createContext();function Xr(){return _.useContext(vE)}function W6({children:s}){const[e,t]=_.useState(null),[i,l]=_.useState(!1),[u,h]=_.useState(!1),[p,g]=_.useState(null),[y,b]=_.useState(!0);_.useEffect(()=>{let $=null;const G=YA(So,fe=>{if(t(fe),$&&($(),$=null),fe)if(fe.uid===$6)l(!0),h(!1),g(null),b(!1);else{l(!1);const xe=cn(wt(_e,"clients"),At("uid","==",fe.uid)),be=async()=>{const j=localStorage.getItem("mcf_clientId");if(j)try{const T=await pr(Ze(_e,"clients",j));T.exists()&&(h(!0),g({id:T.id,...T.data()}))}catch(T){console.error("Direct client read failed:",T)}};$=nE(xe,async j=>{if(j.empty)await be();else{const T=j.docs[0];h(!0),g({id:T.id,...T.data()});try{localStorage.setItem("mcf_clientId",T.id)}catch{}}b(!1)},async j=>{console.error("Error listening to client data:",j),await be(),b(!1)})}else l(!1),h(!1),g(null),b(!1)});return()=>{G(),$&&$()}},[]);const K={currentUser:e,isAdmin:i,isClient:u,clientData:p,updateClientData:$=>{g(G=>G?{...G,...$}:$)},resolveClient:async()=>{if(p)return p;const $=localStorage.getItem("mcf_clientId");if($)try{const G=await pr(Ze(_e,"clients",$));if(G.exists()){const fe={id:G.id,...G.data()};return h(!0),g(fe),fe}}catch(G){console.error("resolveClient direct read failed:",G)}if(e){const G=cn(wt(_e,"clients"),At("uid","==",e.uid)),fe=await nn(G);if(!fe.empty){const xe={id:fe.docs[0].id,...fe.docs[0].data()};return h(!0),g(xe),xe}}return null},login:async($,G,fe=!0)=>(await k2(So,fe?xg:dy),await WA(So,$,G)),signup:async($,G,fe)=>{await k2(So,xg);const xe=await $A(So,G.trim().toLowerCase(),fe),be=xe.user,j=Ze(wt(_e,"clients")),T={uid:be.uid,name:$.trim(),email:G.trim().toLowerCase(),clientType:"core_buddy",coreBuddyAccess:!0,status:"active",tier:"free",subscriptionStatus:null,signupSource:"self_signup",createdAt:Vt.now()};await Ps(j,T),h(!0),g({id:j.id,...T});try{localStorage.setItem("mcf_clientId",j.id)}catch{}return xe},logout:()=>{try{localStorage.removeItem("mcf_clientId")}catch{}return QA(So)},resetPassword:$=>HA(So,$),loading:y};return a.jsx(vE.Provider,{value:K,children:s})}const bE=_.createContext();function fa(){return _.useContext(bE)}function G6({children:s}){const[e,t]=_.useState(()=>{const g=localStorage.getItem("theme");return g?g==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches}),[i,l]=_.useState(()=>localStorage.getItem("accent")||"red");_.useEffect(()=>{document.documentElement.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("theme",e?"dark":"light")},[e]),_.useEffect(()=>{localStorage.setItem("accent",i)},[i]);const p={isDark:e,toggleTheme:()=>{document.documentElement.setAttribute("data-theme-transitioning",""),t(!e),setTimeout(()=>{document.documentElement.removeAttribute("data-theme-transitioning")},350)},accent:i,setAccent:g=>l(g)};return a.jsx(bE.Provider,{value:p,children:s})}const wE=_.createContext();function rc(){return _.useContext(wE)}const K6=["nutrition","buddies"],Y6=[5,10],Q6=2,X6=1;function J6({children:s}){const{clientData:e,loading:t}=Xr(),i=_.useMemo(()=>{const l=e?.tier||"free",u=e?.subscriptionStatus||null,h=e&&e.signupSource!=="self_signup",p=l==="premium"||!!h;function g(y){return p?!0:!K6.includes(y)}return{tier:l,subscriptionStatus:u,isPremium:p,canAccess:g,loading:t,FREE_RANDOMISER_DURATIONS:Y6,FREE_RANDOMISER_WEEKLY_LIMIT:Q6,FREE_HABIT_LIMIT:X6}},[e?.tier,e?.subscriptionStatus,e?.signupSource,t]);return a.jsx(wE.Provider,{value:i,children:s})}function Z6(s){if(s?.signupSource==="self_signup"&&!s?.onboardingComplete)return"/onboarding";const e=s?.clientType;return e==="core_buddy"?"/client/core-buddy":e==="circuit_vip"||e==="circuit_dropin"?"/client/circuit":"/client"}function e3({className:s=""}){const{isDark:e,toggleTheme:t}=fa();return a.jsx("button",{className:s||"theme-toggle",onClick:t,"aria-label":e?"Switch to light mode":"Switch to dark mode",children:e?a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})})}function t3(){const[s,e]=_.useState(""),[t,i]=_.useState(""),[l,u]=_.useState(!0),[h,p]=_.useState(""),[g,y]=_.useState(!1),[b,k]=_.useState(!1),[E,O]=_.useState(!1),{login:H,resetPassword:q,currentUser:B,isAdmin:K,isClient:$,clientData:G,loading:fe}=Xr(),xe=ir();if(_.useEffect(()=>{if(!fe&&B){if(!B.emailVerified&&G?.signupSource==="self_signup"){xe("/signup");return}K?xe("/dashboard"):$?xe(Z6(G)):(y(!1),p("No account found. Please sign up or contact your trainer."))}},[fe,B,K,$,G,xe]),fe||B)return a.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh",background:"var(--bg-body)"},children:a.jsx("div",{style:{width:36,height:36,border:"3px solid var(--color-primary-light)",borderTopColor:"var(--color-primary)",borderRadius:"50%",animation:"app-spin .7s linear infinite"}})});const be=async T=>{T.preventDefault(),p(""),y(!0);try{await H(s,t,l)}catch(R){p(R.message||"Failed to log in"),y(!1)}},j=async T=>{if(T.preventDefault(),p(""),!s.trim()){p("Please enter your email address");return}y(!0);try{await q(s.trim()),O(!0)}catch(R){R.code==="auth/user-not-found"?p("No account found with this email"):p(R.message||"Failed to send reset email")}y(!1)};return a.jsxs("div",{className:"login-container",children:[a.jsx(e3,{className:"login-theme-toggle"}),a.jsxs("div",{className:"login-card",children:[a.jsxs("div",{className:"login-header",children:[a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"login-logo"}),a.jsx("p",{children:a.jsx("strong",{children:b?"Reset Password":"Sign in as 1-2-1 or a Core Buddy"})})]}),h&&a.jsx("div",{className:"error-message",children:h}),E?a.jsxs("div",{className:"reset-sent",children:[a.jsx("div",{className:"reset-sent-icon",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M22 2L11 13",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("path",{d:"M22 2L15 22L11 13L2 9L22 2Z",strokeLinecap:"round",strokeLinejoin:"round"})]})}),a.jsx("p",{children:"Reset email sent!"}),a.jsx("span",{children:"Check your inbox for a password reset link"}),a.jsx("button",{className:"login-btn",style:{marginTop:"20px"},onClick:()=>{k(!1),O(!1),p("")},children:"Back to Log In"})]}):b?a.jsxs("form",{onSubmit:j,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:s,onChange:T=>e(T.target.value),placeholder:"Enter your email",required:!0})]}),a.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Sending...":"Send Reset Link"}),a.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{k(!1),p("")},children:"Back to Log In"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("form",{onSubmit:be,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:s,onChange:T=>e(T.target.value),required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"password",children:"Password"}),a.jsx("input",{type:"password",id:"password",value:t,onChange:T=>i(T.target.value),required:!0})]}),a.jsx("div",{className:"remember-me",children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:l,onChange:T=>u(T.target.checked)}),a.jsx("span",{children:"Remember me"})]})}),a.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Logging in...":"Log In"})]}),a.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{k(!0),p("")},children:"Forgot password?"}),a.jsx("button",{type:"button",className:"login-btn login-btn-outline",onClick:()=>xe("/signup"),children:"Don't have an account? Create one free"})]}),a.jsx("a",{href:"/",className:"back-link",children:"Back to website"})]})]})}function hd({feature:s,children:e}){const{canAccess:t,loading:i}=rc();return i||t(s)?e:a.jsx(k_,{to:"/upgrade",replace:!0})}function ui({active:s}){const e=ir(),{clientData:t}=Xr(),{isPremium:i}=rc(),l=t?.clientType==="block"&&t?.coreBuddyAccess;return a.jsxs("nav",{className:"block-bottom-nav",children:[a.jsxs("button",{className:`block-nav-tab${s==="home"?" active":""}`,onClick:()=>e("/client/core-buddy"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),a.jsx("span",{children:"Profile"})]}),a.jsxs("button",{className:`block-nav-tab${s==="workouts"?" active":""}`,onClick:()=>e("/client/core-buddy/workouts"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:a.jsx("path",{d:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"})}),a.jsx("span",{children:"Workout"})]}),i&&a.jsxs("button",{className:`block-nav-tab${s==="nutrition"?" active":""}`,onClick:()=>e("/client/core-buddy/nutrition"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"})}),a.jsx("span",{children:"Nutrition"})]}),i&&a.jsxs("button",{className:`block-nav-tab${s==="buddies"?" active":""}`,onClick:()=>e("/client/core-buddy/buddies"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("span",{children:"Buddies"})]}),l&&a.jsxs("button",{className:"block-nav-tab",onClick:()=>e("/client"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),a.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),a.jsx("span",{children:"Block"})]})]})}function Xo({children:s,onRefresh:e}){const[t,i]=_.useState(0),[l,u]=_.useState(!1),h=_.useRef(null),p=_.useRef(0),g=_.useRef(!1),y=_.useCallback(E=>{window.scrollY<=0&&(p.current=E.touches[0].clientY,g.current=!0)},[]),b=_.useCallback(E=>{if(!g.current||l)return;const O=E.touches[0].clientY-p.current;O>20&&window.scrollY<=0&&(E.preventDefault(),i(Math.min((O-20)*.35,80)))},[l]),k=_.useCallback(async()=>{t>55&&!l&&(u(!0),e?await e():window.location.reload(),u(!1)),i(0),g.current=!1},[t,l,e]);return a.jsxs("div",{ref:h,onTouchStart:y,onTouchMove:b,onTouchEnd:k,children:[a.jsxs("div",{className:`pull-refresh-indicator ${t>0?"visible":""} ${l?"refreshing":""}`,style:{height:t},children:[a.jsx("div",{className:`refresh-spinner ${l?"spinning":""}`,children:a.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:a.jsx("path",{fill:"currentColor",d:"M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"})})}),a.jsx("span",{className:"refresh-text",children:l?"Refreshing...":"Pull to refresh"})]}),s]})}function zu(s,e,t,i,l){const u=[];for(let h=0;h<s;h++){const p=(h*(360/s)-90)*(Math.PI/180);u.push({x1:e+i*Math.cos(p),y1:t+i*Math.sin(p),x2:e+l*Math.cos(p),y2:t+l*Math.sin(p),thick:h%5===0})}return u}const _E=zu(60,100,100,85,96),n3=zu(60,100,100,78,94),s3=zu(60,100,100,82,94);zu(60,50,50,38,46);const cO=zu(60,40,40,30,37);function r3({steps:s,onFinish:e,active:t}){const[i,l]=_.useState(0),[u,h]=_.useState(null),[p,g]=_.useState("below"),[y,b]=_.useState(!1),k=_.useRef(null),E=_.useRef(t);E.current=t,_.useEffect(()=>{t||l(0)},[t]),_.useEffect(()=>{if(!t)return;const xe=be=>be.preventDefault();return document.addEventListener("touchmove",xe,{passive:!1}),document.addEventListener("wheel",xe,{passive:!1}),document.body.style.overflow="hidden",()=>{document.removeEventListener("touchmove",xe),document.removeEventListener("wheel",xe),document.body.style.overflow=""}},[t]);const O=_.useMemo(()=>t?s.filter(xe=>document.querySelector(xe.selector)):[],[t]),H=O[i],q=i===O.length-1,B=H?.selector,K=_.useCallback(()=>{if(!B)return;const xe=document.querySelector(B);if(!xe){h(null);return}const be=xe.getBoundingClientRect(),j=8;h({top:be.top-j,left:be.left-j,width:be.width+j*2,height:be.height+j*2});const T=window.innerHeight-be.bottom;g(T<260?"above":"below")},[B]);if(_.useEffect(()=>{if(!t||!B)return;b(!0);const xe=document.querySelector(B);if(xe){document.body.style.overflow="",xe.scrollIntoView({behavior:"smooth",block:"center"});let be=null,j=0,T=0;const R=60,P=()=>{T++;const A=xe.getBoundingClientRect(),Ve=Math.round(A.top);if(be!==null&&Ve===be?j++:j=0,be=Ve,j>=3||T>=R){E.current&&(document.body.style.overflow="hidden"),K(),b(!1);return}M=requestAnimationFrame(P)};let M;const L=setTimeout(()=>{M=requestAnimationFrame(P)},120);return()=>{clearTimeout(L),M&&cancelAnimationFrame(M),E.current&&(document.body.style.overflow="hidden")}}},[t,i,B,K]),_.useEffect(()=>{if(!t)return;const xe=()=>{k.current&&cancelAnimationFrame(k.current),k.current=requestAnimationFrame(K)};return window.addEventListener("scroll",xe,!0),window.addEventListener("resize",xe),()=>{window.removeEventListener("scroll",xe,!0),window.removeEventListener("resize",xe),k.current&&cancelAnimationFrame(k.current)}},[t,K]),!t||!H||O.length===0)return null;const $=()=>{q?e():l(i+1)},G=()=>{i>0&&l(i-1)},fe=()=>e();return a.jsxs("div",{className:"st-overlay",onClick:xe=>{xe.stopPropagation()},children:[a.jsx("div",{className:"st-backdrop",onClick:$}),u&&a.jsx("div",{className:`st-spotlight${y?" st-transitioning":""}`,style:{top:u.top,left:u.left,width:u.width,height:u.height}}),u&&a.jsxs("div",{className:`st-tooltip st-tooltip-${p}${y?" st-transitioning":""}`,style:{top:p==="below"?Math.min(Math.max(u.top+u.height+16,16),window.innerHeight-200):void 0,bottom:p==="above"?Math.min(Math.max(window.innerHeight-u.top+16,16),window.innerHeight-60):void 0,left:Math.max(16,Math.min(u.left,window.innerWidth-320))},children:[a.jsx("div",{className:"st-dots",children:O.map((xe,be)=>a.jsx("span",{className:`st-dot${be===i?" active":""}${be<i?" done":""}`},be))}),a.jsx("h3",{className:"st-title",children:H.title}),a.jsx("p",{className:"st-body",children:H.body}),a.jsxs("div",{className:"st-actions",children:[i>0&&a.jsx("button",{className:"st-btn st-btn-back",onClick:G,children:"Back"}),a.jsx("button",{className:"st-btn st-btn-next",onClick:$,children:H.cta||(q?"Let's Go!":"Next")})]}),a.jsx("button",{className:"st-skip",onClick:fe,children:"Skip tour"})]})]})}const zw=3,i3=5;function Gp(s){return s.toISOString().split("T")[0]}const Kp=[{text:"You have 24 hours a day...",bold:"make it count"},{text:"Discipline beats motivation...",bold:"every single time"},{text:"Rest when you're done,",bold:"not when you're tired"},{text:"Small daily gains...",bold:"create massive results"},{text:"Your body keeps score,",bold:"train it well"},{text:"Consistency over intensity...",bold:"always wins"},{text:"The only bad workout...",bold:"is the one you skipped"}];function Yp(s){if(!s)return"";const e=s instanceof Date?s:s.toDate?s.toDate():new Date(s),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function Kc(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function a3(s,e=800){return new Promise(t=>{const i=new Image;i.onload=()=>{const l=document.createElement("canvas");let u=i.width,h=i.height;u>h?u>e&&(h=Math.round(h*e/u),u=e):h>e&&(u=Math.round(u*e/h),h=e),l.width=u,l.height=h,l.getContext("2d").drawImage(i,0,0,u,h),l.toBlob(p=>t(p),"image/jpeg",.8)},i.src=URL.createObjectURL(s)})}function o3(){const{currentUser:s,isClient:e,clientData:t,logout:i,updateClientData:l,loading:u}=Xr(),{isDark:h,toggleTheme:p}=fa(),{isPremium:g,FREE_HABIT_LIMIT:y}=rc(),b=ir(),k=g?i3:y,[E,O]=_.useState({hours:0,minutes:0,seconds:0}),[H,q]=_.useState(0),[B,K]=_.useState(0),[$,G]=_.useState(0),[fe,xe]=_.useState(!1),[be,j]=_.useState({protein:0,carbs:0,fats:0,calories:0}),[T,R]=_.useState(null),[P,M]=_.useState(0),[L,A]=_.useState(0),[Ve,Qe]=_.useState(zw),[Z,ue]=_.useState(!1),[Ce,Pe]=_.useState(!1),[se,D]=_.useState([]),[ne,ve]=_.useState(null),[Ee,Te]=_.useState(!1),Se=_.useRef(null),[Ke,ct]=_.useState(0),[Be,sn]=_.useState(0),[Nn,Un]=_.useState(null),Ot=_.useCallback((C,Y="info")=>{Un({message:C,type:Y}),setTimeout(()=>Un(null),4e3)},[]),[rt,gt]=_.useState([]),[ut,Bn]=_.useState(!1),[he,Dt]=_.useState(""),[yt,Bt]=_.useState(null),[et,It]=_.useState(null),[vt,rn]=_.useState(!1),[Cs,rs]=_.useState(new Set),[Jt,re]=_.useState(new Set),[Ae,kt]=_.useState({}),[bt,it]=_.useState({}),[$e,st]=_.useState({}),[Fe,an]=_.useState({}),[un,Ln]=_.useState({}),[zn,Xn]=_.useState({}),Qt=_.useRef(null),Fn=_.useRef(null),An=_.useRef({}),[hn,yr]=_.useState([]),[oe,Re]=_.useState(!1),Ge=_.useRef(null),[mt,lt]=_.useState([]),[_n,Rn]=_.useState(""),[pn,xn]=_.useState(!1),[Ns,is]=_.useState(null),[ds,Zt]=_.useState([]),[In,As]=_.useState(null),[Ar,fi]=_.useState(!1),Rr=_.useRef(!1),Ir=(()=>{const C=[{selector:".cb-ring-container",title:"Your 24-Hour Countdown",body:"Every day resets. This ring tracks the time you have left  tap your photo to personalise your profile.",cta:"Next"},{selector:".cb-stats-row",title:"Progress at a Glance",body:"Your workout streak, sessions this week, and daily habits  all in one row. These fill up as you go."},{selector:".cb-nudge-card",title:"Smart Suggestions",body:"We'll highlight what needs your attention  your next session, unfinished habits, or a meal to log."},{selector:".cb-card-workouts-hero",title:"Workout",body:"Randomiser workouts  pick your focus, level and time. Save and replay your favourites.",cta:"Next"}];return g&&C.push({selector:".cb-card-nutrition",title:"Nutrition Tracking",body:"Set your macro targets, scan barcodes, and log meals to hit your daily goals."},{selector:".cb-card-consistency",title:"Daily Habits",body:"5 simple habits each day  train, hit protein, 10k steps, sleep, and hydrate. Build your streak."},{selector:".cb-card-buddies",title:"Buddies & Social",body:"Connect with other members, share your journey, and keep each other accountable."},{selector:".cb-journey-section",title:"Share Your Journey",body:"Post photos, updates, and milestones  your fitness journey in one place. Like and comment on each other's posts."}),C.push({selector:".block-bottom-nav",title:"You're All Set!",body:"Use the nav bar to jump between your profile, workouts, nutrition, and buddies. Time to get after it.",cta:"Let's Go!"}),C})();_.useEffect(()=>{!u&&!s&&b("/")},[u,s,b]),_.useEffect(()=>{!u&&t&&t.signupSource==="self_signup"&&!t.onboardingComplete&&b("/onboarding")},[u,t,b]),_.useEffect(()=>{let C=t?.tourComplete||Rr.current;if(!C&&t?.id)try{C=!!localStorage.getItem(`tourDone_${t.id}`)}catch{}if(fe&&t&&!C){const Y=setTimeout(()=>fi(!0),600);return()=>clearTimeout(Y)}},[fe,t]),_.useEffect(()=>{if(!(!fe||!t?.id)){try{if(localStorage.getItem(`targetHint_${t.id}`))return}catch{}if(!t?.weeklyWorkoutTarget){const C=setTimeout(()=>Pe(!0),1500);return()=>clearTimeout(C)}}},[fe,t]),_.useEffect(()=>{if(t)try{const C=sessionStorage.getItem(`cbDash_${t.id}`);if(C){const Y=JSON.parse(C);K(Y.totalWorkouts??0),G(Y.habitWeekPct??0),j(Y.nutritionTotals??{protein:0,carbs:0,fats:0,calories:0}),R(Y.nutritionTargetData??null),M(Y.todayHabitsCount??0),A(Y.weeklyWorkouts??0),Qe(Y.weeklyWorkoutTarget??zw),D(Y.leaderboardTop3??[]),ct(Y.streakWeeks??0),xe(!0)}}catch{}},[t]),_.useEffect(()=>{t?.photoURL&&ve(t.photoURL),t?.weeklyWorkoutTarget&&Qe(t.weeklyWorkoutTarget)},[t]),_.useEffect(()=>{if(!t)return;const C=cn(wt(_e,"notifications"),At("toId","==",t.id)),Y=nE(C,Ne=>{const Ie=Ne.docs.map(Ue=>({id:Ue.id,...Ue.data()}));Ie.sort((Ue,ht)=>{const tt=Ue.createdAt?.toMillis?.()||0;return(ht.createdAt?.toMillis?.()||0)-tt}),yr(Ie.slice(0,50))},Ne=>{console.error("Notification listener error:",Ne),Ne.code==="permission-denied"&&console.warn("Firestore rules may be missing for the notifications collection. Please update your Firestore rules in the Firebase Console.")});return()=>Y()},[t]),_.useEffect(()=>{const C=Y=>{Ge.current&&!Ge.current.contains(Y.target)&&Re(!1)};return document.addEventListener("mousedown",C),()=>document.removeEventListener("mousedown",C)},[]),_.useEffect(()=>{if(!t)return;const C=t.id;(async()=>{try{const[Y,Ne,Ie]=await Promise.all([nn(cn(wt(_e,"buddies"),At("user1","==",C))),nn(cn(wt(_e,"buddies"),At("user2","==",C))),nn(wt(_e,"clients"))]),Ue=new Set;[...Y.docs,...Ne.docs].forEach(tt=>{const St=tt.data();Ue.add(St.user1===C?St.user2:St.user1)});const ht={};Ie.docs.forEach(tt=>{ht[tt.id]=tt.data()}),lt(Array.from(Ue).filter(tt=>ht[tt]).map(tt=>({id:tt,name:ht[tt].name,photoURL:ht[tt].photoURL||null})))}catch(Y){console.error("Error loading buddies for mentions:",Y)}})()},[t]);const qn=hn.filter(C=>!C.read).length,Ys=async()=>{const C=hn.filter(Ne=>!Ne.read);if(!C.length)return;const Y=Dw(_e);C.forEach(Ne=>Y.update(Ze(_e,"notifications",Ne.id),{read:!0})),await Y.commit()},_s=async()=>{if(!hn.length)return;const C=Dw(_e);hn.forEach(Y=>C.delete(Ze(_e,"notifications",Y.id))),await C.commit()},Sn=async(C,Y,Ne={})=>{if(!(!t||C===t.id))try{await Kr(wt(_e,"notifications"),{toId:C,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:Y,read:!1,createdAt:er(),...Ne})}catch(Ie){console.error("Notification create error:",Ie),Ie.code==="permission-denied"&&Ot("Notifications blocked  check Firestore rules","error")}},On=(C,Y)=>{const Ne=Y==="compose"?Qt.current?.selectionStart:null,Ue=(Ne!=null?C.slice(0,Ne):C).match(/@(\w*)$/);if(Ue){xn(!0),is(Y),Rn(Ue[1].toLowerCase());const ht=mt.filter(tt=>tt.name&&tt.name.toLowerCase().includes(Ue[1].toLowerCase())).slice(0,5);Zt(ht)}else xn(!1),Zt([])},as=(C,Y)=>{if(Y==="compose"){const Ne=Qt.current,Ie=he,Ue=Ne?.selectionStart??Ie.length,ht=Ie.slice(0,Ue),tt=Ie.slice(Ue),St=ht.replace(/@\w*$/,`@${C.name} `);Dt(St+tt),setTimeout(()=>{Ne?.focus(),Ne.selectionStart=Ne.selectionEnd=St.length},0)}else{const Ie=(bt[Y]||"").replace(/@\w*$/,`@${C.name} `);it(Ue=>({...Ue,[Y]:Ie}))}xn(!1),Zt([])},qt=C=>C&&C.split(/(@\w[\w\s]*?\s)/g).map((Ne,Ie)=>Ne.startsWith("@")&&mt.some(Ue=>Ne.trim()===`@${Ue.name}`)?a.jsx("span",{className:"mention-highlight",children:Ne.trim()},Ie):Ne),Jr=async C=>{const Y=C.target.files?.[0];if(!(!Y||!t)){if(!Y.type.startsWith("image/")){Ot("Please select an image file","error");return}if(Y.size>5*1024*1024){Ot("Image must be under 5MB","error");return}Te(!0);try{const Ne=await new Promise(ht=>{const tt=new Image;tt.onload=()=>{const St=document.createElement("canvas"),dt=400;let V=tt.width,X=tt.height;V>X?(X=X/V*dt,V=dt):(V=V/X*dt,X=dt),St.width=V,St.height=X,St.getContext("2d").drawImage(tt,0,0,V,X),St.toBlob(ee=>ht(ee),"image/jpeg",.75)},tt.src=URL.createObjectURL(Y)}),Ie=Wa(Ga,`profilePhotos/${t.id}`);await Nd(Ie,Ne);const Ue=await Lo(Ie);await js(Ze(_e,"clients",t.id),{photoURL:Ue}),ve(Ue),l({photoURL:Ue}),Ot("Profile photo updated!","success")}catch(Ne){console.error("Photo upload error:",Ne),Ot("Failed to upload photo","error")}Te(!1),Se.current&&(Se.current.value="")}};_.useEffect(()=>{const C=()=>{const Ne=new Date,Ie=new Date(Ne);Ie.setHours(23,59,59,999);const Ue=Ie-Ne,ht=Math.floor(Ue/(1e3*60*60)),tt=Math.floor(Ue%(1e3*60*60)/(1e3*60)),St=Math.floor(Ue%(1e3*60)/1e3);O({hours:ht,minutes:tt,seconds:St}),q(60-St)};C();const Y=setInterval(C,1e3);return()=>clearInterval(Y)},[]),_.useEffect(()=>{const C=setInterval(()=>{sn(Y=>(Y+1)%Kp.length)},8e3);return()=>clearInterval(C)},[]),_.useEffect(()=>{if(!s||!t)return;(async()=>{let Y=null,Ne=null;try{const Ie=Gp(new Date),Ue=wt(_e,"workoutLogs"),ht=cn(Ue,At("clientId","==",t.id));Y=await nn(ht),K(Y.docs.length);const tt=new Date,St=tt.getDay(),dt=St===0?6:St-1,V=new Date(tt);V.setDate(tt.getDate()-dt),V.setHours(0,0,0,0);const X=V.getTime(),ee=Y.docs.filter(Ut=>{const Xe=Ut.data().completedAt;return Xe?(Xe.toDate?Xe.toDate().getTime():new Date(Xe).getTime())>=X:!1}).length;A(ee);const ge=wt(_e,"habitLogs"),je=cn(ge,At("clientId","==",t.id),At("date","==",Ie)),Oe=await nn(je);let qe=0;if(!Oe.empty){const Ut=Oe.docs[0].data().habits||{};qe=Math.min(Object.values(Ut).filter(Boolean).length,k)}G(Math.round(qe/k*100)),M(qe);const pt=await pr(Ze(_e,"nutritionTargets",t.id));pt.exists()&&(R(pt.data()),Ne=pt.data());const Et=await pr(Ze(_e,"nutritionLogs",`${t.id}_${Ie}`));if(Et.exists()){const Xe=(Et.data().entries||[]).reduce((en,Bs)=>({protein:en.protein+(Bs.protein||0),carbs:en.carbs+(Bs.carbs||0),fats:en.fats+(Bs.fats||0),calories:en.calories+(Bs.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});j(Xe)}}catch(Ie){console.error("Error loading dashboard stats:",Ie)}try{const Ie=wt(_e,"clients"),Ue=cn(Ie,At("leaderboardOptIn","==",!0)),tt=(await nn(Ue)).docs.map(St=>({id:St.id,name:St.data().name,photoURL:St.data().photoURL||null}));D(tt.slice(0,3))}catch(Ie){console.error("Leaderboard preview error:",Ie)}try{let Ie=0;if(Y){const Ue=Y.docs.map(ht=>ht.data().date).filter(Boolean).sort().reverse();if(Ue.length>0){const ht=new Date;let tt=new Date(ht);e:for(let St=0;St<52;St++){const dt=new Date(tt),V=dt.getDay(),X=V===0?6:V-1;dt.setDate(dt.getDate()-X),dt.setHours(0,0,0,0);const ee=new Date(dt);ee.setDate(ee.getDate()+7);const ge=Gp(dt),je=Gp(ee);if(Ue.some(qe=>qe>=ge&&qe<je))Ie++;else{if(St>0)break e;break}tt.setDate(tt.getDate()-7)}}}ct(Ie)}catch(Ie){console.error("Streak computation error:",Ie)}xe(!0)})()},[s,t,k]),_.useEffect(()=>{if(!(!fe||!t))try{sessionStorage.setItem(`cbDash_${t.id}`,JSON.stringify({totalWorkouts:B,habitWeekPct:$,nutritionTotals:be,nutritionTargetData:T,todayHabitsCount:P,weeklyWorkouts:L,weeklyWorkoutTarget:Ve,leaderboardTop3:se,streakWeeks:Ke}))}catch{}},[fe,B,$,be,T,P,L,Ve,se,Ke,t]);const Dr=_.useCallback(async()=>{if(Rr.current=!0,fi(!1),l({tourComplete:!0}),t?.id){try{localStorage.setItem(`tourDone_${t.id}`,"1")}catch{}try{await js(Ze(_e,"clients",t.id),{tourComplete:!0})}catch(C){console.error("Failed to save tour completion:",C)}}},[t,l]),xs=_.useCallback(async C=>{if(Qe(C),ue(!1),Pe(!1),t?.id){try{localStorage.setItem(`targetHint_${t.id}`,"1")}catch{}try{await js(Ze(_e,"clients",t.id),{weeklyWorkoutTarget:C})}catch(Y){console.error("Failed to save weekly target:",Y)}}},[t]),vn=C=>{const Y=C.currentTarget,Ne=Y.querySelector(".ripple");Ne&&Ne.remove();const Ie=Y.getBoundingClientRect(),Ue=Math.max(Ie.width,Ie.height),ht=C.clientX-Ie.left-Ue/2,tt=C.clientY-Ie.top-Ue/2,St=document.createElement("span");St.className="ripple",St.style.cssText=`width:${Ue}px;height:${Ue}px;left:${ht}px;top:${tt}px;`,Y.appendChild(St),setTimeout(()=>St.remove(),600)},ar=t?.name?.split(" ")[0]||"there",mi=Math.min(Math.round(L/Ve*100),100),I=Ke>0?Math.min(Math.round(Ke/12*100),100):0,z=[{label:"Wk Streak",value:`${Ke}`,pct:I,color:"var(--color-primary)",size:"normal"},{label:"Workouts",value:`${L}/${Ve}`,pct:mi,color:"var(--color-primary)",size:"large",editable:!0},{label:"Habits Today",value:`${$}%`,pct:$,color:"var(--color-primary)",size:"normal"}],ae=C=>!T||!T[C]?0:Math.min(Math.round(be[C]/T[C]*100),100),le=(()=>{const C=new Date().getHours();return fe&&P>=k&&be.calories>0?{main:"Smashed it today,",sub:"Rest up and go again tomorrow."}:C>=5&&C<12?{main:"Rise and grind,",sub:"let's get after it!"}:C>=12&&C<17?{main:"Oye",sub:"crack on and make it count!"}:C>=17&&C<21?{main:"Evening session?",sub:"Let's finish strong!"}:{main:"Burning the midnight oil,",sub:"Respect the hustle!"}})(),Me=fe?L===0?{label:"WORKOUT",message:"No workouts this week yet",cta:"Start One",action:()=>b("/client/core-buddy/workouts"),pct:0,ringLabel:"0"}:P<k?{label:"DAILY HABITS",message:`${P}/${k} completed`,cta:"Open Habits",action:()=>b("/client/core-buddy/consistency"),pct:$,ringLabel:`${P}/${k}`}:g&&be.calories===0?{label:"NUTRITION",message:"No meals logged today",cta:"Log Meal",action:()=>b("/client/core-buddy/nutrition"),pct:0,ringLabel:"0"}:{label:"TODAY",message:"You're crushing it!",cta:null,action:null,pct:100,ringLabel:""}:null,Le=_.useCallback(async()=>{if(t){Bn(!0);try{const C=await nn(cn(wt(_e,"posts"),At("authorId","==",t.id),_u("createdAt","desc"),xu(30)));gt(C.docs.map(Ne=>({id:Ne.id,...Ne.data()})));const Y=await nn(cn(wt(_e,"postLikes"),At("userId","==",t.id)));rs(new Set(Y.docs.map(Ne=>Ne.data().postId)))}catch(C){console.error("Error loading journey:",C)}finally{Bn(!1)}}},[t]);_.useEffect(()=>{fe&&t&&Le()},[fe,t,Le]);const He=C=>{const Y=C.target.files?.[0];if(Y){if(!Y.type.startsWith("image/")){Ot("Please select an image file","error");return}if(Y.size>10*1024*1024){Ot("Image must be under 10MB","error");return}Bt(Y),It(URL.createObjectURL(Y))}},Ht=()=>{Bt(null),et&&URL.revokeObjectURL(et),It(null),Fn.current&&(Fn.current.value="")},Ye=async()=>{if(!(!he.trim()&&!yt||vt||!t)){rn(!0);try{let C=null;if(yt){const Ie=await a3(yt),Ue=`${Date.now()}_${Math.random().toString(36).slice(2,8)}`,ht=Wa(Ga,`postImages/${t.id}/${Ue}`);await Nd(ht,Ie),C=await Lo(ht)}await Kr(wt(_e,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:he.trim(),type:C?"image":"text",imageURL:C||null,createdAt:er(),likeCount:0,commentCount:0});const Ne=he.trim().match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Ne){const Ie=new Set;Ne.forEach(Ue=>{const ht=Ue.slice(1).trim(),tt=mt.find(St=>St.name&&St.name.toLowerCase()===ht.toLowerCase());tt&&!Ie.has(tt.id)&&(Ie.add(tt.id),Sn(tt.id,"mention",{}))})}Dt(""),Ht(),Qt.current&&(Qt.current.style.height="auto"),await Le(),Ot("Posted!","success")}catch(C){console.error("Error posting:",C),Ot(C?.message||"Failed to post","error")}finally{rn(!1)}}},Kn=async C=>{if(window.confirm("Delete this post?"))try{await jr(Ze(_e,"posts",C)),gt(Y=>Y.filter(Ne=>Ne.id!==C)),Ot("Post deleted","info")}catch(Y){console.error("Delete error:",Y),Ot("Failed to delete","error")}},os=async C=>{if(!t)return;const Y=t.id,Ne=`${C}_${Y}`,Ie=Cs.has(C),Ue=new Set(Cs);Ie?Ue.delete(C):Ue.add(C),rs(Ue),gt(ht=>ht.map(tt=>tt.id===C?{...tt,likeCount:Math.max(0,(tt.likeCount||0)+(Ie?-1:1))}:tt));try{if(Ie)await jr(Ze(_e,"postLikes",Ne)),await js(Ze(_e,"posts",C),{likeCount:Ao(-1)});else{await Ps(Ze(_e,"postLikes",Ne),{postId:C,userId:Y,createdAt:er()}),await js(Ze(_e,"posts",C),{likeCount:Ao(1)});const ht=rt.find(tt=>tt.id===C);ht&&Sn(ht.authorId,"like",{postId:C})}}catch(ht){console.error("Like error:",ht),Le()}},Us=async C=>{try{const Y=await nn(cn(wt(_e,"postComments"),At("postId","==",C),_u("createdAt","asc"),xu(50)));kt(Ne=>({...Ne,[C]:Y.docs.map(Ie=>({id:Ie.id,...Ie.data()}))}))}catch(Y){console.error("Error loading comments:",Y)}},Yn=C=>{const Y=new Set(Jt);Y.has(C)?Y.delete(C):(Y.add(C),Ae[C]||Us(C)),re(Y)},vr=async C=>{const Y=(bt[C]||"").trim(),Ne=un[C];if(!(!Y&&!Ne||!t)){st(Ie=>({...Ie,[C]:!0}));try{let Ie=null;if(Ne){const dt=Wa(Ga,`comment-images/${Date.now()}_${Ne.name}`);await Nd(dt,Ne),Ie=await Lo(dt)}const Ue={postId:C,authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Y||"",createdAt:er()};Ie&&(Ue.imageURL=Ie);const ht=Fe[C];ht&&(Ue.replyToId=ht.id,Ue.replyToName=ht.authorName),await Kr(wt(_e,"postComments"),Ue),await js(Ze(_e,"posts",C),{commentCount:Ao(1)});const tt=rt.find(dt=>dt.id===C);tt&&Sn(tt.authorId,"comment",{postId:C});const St=Y.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(St){const dt=new Set;St.forEach(V=>{const X=V.slice(1).trim(),ee=mt.find(ge=>ge.name&&ge.name.toLowerCase()===X.toLowerCase());ee&&!dt.has(ee.id)&&(dt.add(ee.id),Sn(ee.id,"mention",{postId:C}))})}it(dt=>({...dt,[C]:""})),Ln(dt=>({...dt,[C]:null})),Xn(dt=>({...dt,[C]:null})),an(dt=>({...dt,[C]:null})),An.current[C]&&(An.current[C].value=""),gt(dt=>dt.map(V=>V.id===C?{...V,commentCount:(V.commentCount||0)+1}:V)),await Us(C)}catch(Ie){console.error("Comment error:",Ie),Ot("Failed to comment","error")}finally{st(Ie=>({...Ie,[C]:!1}))}}},ma=async(C,Y)=>{try{await jr(Ze(_e,"postComments",Y)),await js(Ze(_e,"posts",C),{commentCount:Ao(-1)}),kt(Ne=>({...Ne,[C]:(Ne[C]||[]).filter(Ie=>Ie.id!==Y)})),gt(Ne=>Ne.map(Ie=>Ie.id===C?{...Ie,commentCount:Math.max((Ie.commentCount||1)-1,0)}:Ie))}catch(Ne){console.error("Delete comment error:",Ne),Ot("Failed to delete comment","error")}},Di=(C,Y)=>{const Ne=Y.target.files?.[0];if(!Ne)return;if(Ne.size>5*1024*1024){Ot("Image must be under 5MB","error");return}Ln(Ue=>({...Ue,[C]:Ne}));const Ie=new FileReader;Ie.onload=Ue=>Xn(ht=>({...ht,[C]:Ue.target.result})),Ie.readAsDataURL(Ne)},Mr=C=>{Ln(Y=>({...Y,[C]:null})),Xn(Y=>({...Y,[C]:null})),An.current[C]&&(An.current[C].value="")},pa=C=>{Dt(C.target.value),C.target.style.height="auto",C.target.style.height=Math.min(C.target.scrollHeight,120)+"px",On(C.target.value,"compose")},Lr=(C,Y)=>{it(Ne=>({...Ne,[C]:Y})),On(Y,C)};return a.jsx(Xo,{children:a.jsxs("div",{className:"cb-dashboard","data-theme":h?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsxs("div",{className:"header-notif-wrap",ref:Ge,children:[a.jsxs("button",{className:"header-notif-btn",onClick:()=>{Re(!oe),oe||Ys()},"aria-label":"Notifications",children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),a.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),qn>0&&a.jsx("span",{className:"header-notif-badge",children:qn>9?"9+":qn})]}),oe&&a.jsxs("div",{className:"notif-panel",children:[a.jsxs("div",{className:"notif-panel-header",children:[a.jsx("span",{className:"notif-panel-title",children:"Notifications"}),hn.length>0&&a.jsx("button",{className:"notif-clear-btn",onClick:_s,children:"Clear all"})]}),a.jsx("div",{className:"notif-panel-list",children:hn.length===0?a.jsx("div",{className:"notif-empty",children:"No notifications yet"}):hn.map(C=>a.jsxs("div",{className:`notif-item${C.read?"":" unread"}`,onClick:()=>{if(Re(!1),C.type==="buddy_request"||C.type==="buddy_accept")b(g?"/client/core-buddy/buddies":"/upgrade");else if((C.type==="like"||C.type==="comment")&&C.postId){if(!Jt.has(C.postId)){const Y=new Set(Jt);Y.add(C.postId),re(Y),Ae[C.postId]||Us(C.postId)}setTimeout(()=>{const Y=document.getElementById(`post-${C.postId}`);Y&&Y.scrollIntoView({behavior:"smooth",block:"center"})},150)}else C.type==="like"||C.type==="comment"?document.querySelector(".cb-journey-section")?.scrollIntoView({behavior:"smooth"}):C.type==="mention"&&b(`/client/core-buddy/profile/${C.fromId}`)},children:[a.jsx("div",{className:"notif-item-avatar",children:C.fromPhotoURL?a.jsx("img",{src:C.fromPhotoURL,alt:""}):a.jsx("span",{children:(C.fromName||"?")[0]})}),a.jsxs("div",{className:"notif-item-body",children:[a.jsxs("p",{className:"notif-item-text",children:[a.jsx("strong",{children:C.fromName})," ",C.type==="buddy_request"&&"sent you a buddy request",C.type==="buddy_accept"&&"accepted your buddy request",C.type==="like"&&"liked your post",C.type==="comment"&&"commented on your post",C.type==="mention"&&"mentioned you"]}),a.jsx("span",{className:"notif-item-time",children:Yp(C.createdAt)})]})]},C.id))})]})]}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:()=>b("/client/core-buddy/settings"),"aria-label":"Settings",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),a.jsx("button",{onClick:i,"aria-label":"Log out",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),a.jsxs("main",{className:"cb-main",children:[a.jsxs("div",{className:"cb-ring-container",children:[a.jsxs("div",{className:"cb-ring",children:[a.jsx("svg",{className:"cb-ring-svg",viewBox:"0 0 200 200",children:_E.map((C,Y)=>{const Ne=Y<H;return a.jsx("line",{x1:C.x1,y1:C.y1,x2:C.x2,y2:C.y2,className:`ring-tick ${Ne?"elapsed":"remaining"}`,strokeWidth:C.thick?"3":"2"},Y)})}),a.jsxs("div",{className:"cb-ring-center",children:[a.jsxs("div",{className:"cb-ring-logo",onClick:()=>Se.current?.click(),role:"button",tabIndex:0,"aria-label":"Change profile photo",children:[a.jsx("img",{src:ne||"/Logo.webp",alt:ne?"Profile":"Mind Core Fitness"}),a.jsx("div",{className:`cb-photo-overlay${Ee?" uploading":""}`,children:Ee?a.jsx("div",{className:"cb-photo-spinner"}):a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),a.jsx("input",{ref:Se,type:"file",accept:"image/*",onChange:Jr,style:{display:"none"}})]}),!ne&&!Ee&&a.jsx("div",{className:"cb-photo-badge",onClick:()=>Se.current?.click(),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),a.jsxs("div",{className:"cb-ring-countdown",children:[a.jsx("span",{className:"cb-timer-digit",children:String(E.hours).padStart(2,"0")}),a.jsx("span",{className:"cb-timer-colon",children:":"}),a.jsx("span",{className:"cb-timer-digit",children:String(E.minutes).padStart(2,"0")}),a.jsx("span",{className:"cb-timer-colon",children:":"}),a.jsx("span",{className:"cb-timer-digit cb-timer-seconds",children:String(E.seconds).padStart(2,"0")})]}),a.jsx("span",{className:"cb-ring-label",children:"remaining today"}),a.jsxs("p",{className:"cb-ring-tagline",children:[Kp[Be].text," ",a.jsx("strong",{children:Kp[Be].bold})]},Be)]}),a.jsx("div",{className:"cb-stats-row",children:z.map(C=>{const Y=(C.size==="large",38),Ne=2*Math.PI*Y,Ie=Ne-C.pct/100*Ne,Ue=C.editable;return a.jsxs("div",{className:`cb-stat-item${C.size==="large"?" cb-stat-large":""}`,children:[a.jsxs("div",{className:`cb-stat-ring${Ue?" cb-stat-tappable":""}${Ue&&Ce?" cb-stat-hint":""}`,onClick:Ue?()=>{ue(!0),Pe(!1)}:void 0,children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-stat-track",cx:"50",cy:"50",r:Y}),a.jsx("circle",{className:"cb-stat-fill",cx:"50",cy:"50",r:Y,style:{stroke:C.color},strokeDasharray:Ne,strokeDashoffset:Ie})]}),a.jsx("span",{className:"cb-stat-value",style:{color:C.color},children:C.value})]}),a.jsx("span",{className:"cb-stat-label",children:C.label})]},C.label)})}),Z&&a.jsx("div",{className:"cb-target-overlay",onClick:()=>ue(!1),children:a.jsxs("div",{className:"cb-target-picker",onClick:C=>C.stopPropagation(),children:[a.jsx("h4",{children:"Weekly workout goal"}),a.jsx("p",{children:"How many sessions per week?"}),a.jsx("div",{className:"cb-target-options",children:[1,2,3,4,5,6,7].map(C=>a.jsx("button",{className:`cb-target-option${C===Ve?" active":""}`,onClick:()=>xs(C),children:C},C))})]})}),a.jsxs("p",{className:"cb-coach-msg",children:[le.main," ",a.jsx("strong",{children:ar}),"  ",le.sub]}),Me&&a.jsxs("button",{className:"cb-nudge-card",onClick:Me.action||void 0,style:Me.action?void 0:{cursor:"default"},children:[a.jsxs("div",{className:"cb-nudge-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-nudge-ring-track",cx:"50",cy:"50",r:"38"}),a.jsx("circle",{className:"cb-nudge-ring-fill",cx:"50",cy:"50",r:"38",strokeDasharray:2*Math.PI*38,strokeDashoffset:2*Math.PI*38-Me.pct/100*2*Math.PI*38})]}),a.jsx("span",{className:"cb-nudge-ring-val",children:Me.ringLabel})]}),a.jsxs("div",{className:"cb-nudge-info",children:[a.jsx("span",{className:"cb-nudge-label",children:Me.label}),a.jsx("span",{className:"cb-nudge-title",children:Me.message}),Me.cta&&a.jsxs("span",{className:"cb-nudge-cta",children:[Me.cta," "]})]})]}),a.jsxs("div",{className:"cb-features",children:[g&&a.jsxs("button",{className:"cb-feature-card cb-card-nutrition cb-card-has-preview ripple-btn",onClick:C=>{vn(C),b("/client/core-buddy/nutrition")},children:[a.jsxs("div",{className:"cb-card-top-row",children:[a.jsx("div",{className:"cb-card-content",children:a.jsx("h3",{children:"Today's Nutrition"})}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsx("div",{className:"cb-card-preview-row",children:a.jsx("div",{className:"cb-mini-rings",children:[{label:"P",pct:ae("protein"),color:"var(--color-primary)"},{label:"C",pct:ae("carbs"),color:"var(--color-primary)"},{label:"F",pct:ae("fats"),color:"var(--color-primary)"},{label:"Cal",pct:ae("calories"),color:"var(--color-primary)"}].map(C=>{const Ne=2*Math.PI*38,Ie=Ne-C.pct/100*Ne;return a.jsxs("div",{className:"cb-mini-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-mini-track",cx:"50",cy:"50",r:38}),a.jsx("circle",{className:"cb-mini-fill",cx:"50",cy:"50",r:38,style:{stroke:C.color},strokeDasharray:Ne,strokeDashoffset:Ie})]}),a.jsx("span",{style:{color:C.color},children:C.label})]},C.label)})})}),a.jsx("p",{className:"cb-card-desc",children:"Track macros, scan barcodes, log water"})]}),a.jsxs("button",{className:"cb-feature-card cb-card-workouts-hero ripple-btn",onClick:C=>{vn(C),b("/client/core-buddy/workouts")},children:[a.jsx("h3",{className:"cb-hero-title",children:"Workout"}),a.jsxs("div",{className:"cb-hero-stats",children:[a.jsxs("span",{children:[L," this week"]}),a.jsx("span",{className:"cb-hero-dot",children:""}),a.jsxs("span",{children:[B," total"]})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:"cb-feature-card cb-card-consistency ripple-btn",onClick:C=>{vn(C),b("/client/core-buddy/consistency")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Habits"}),a.jsx("div",{className:"cb-habit-dots",children:Array.from({length:k},(C,Y)=>a.jsx("span",{className:`cb-habit-dot${Y<P?" done":""}`},Y))}),a.jsxs("span",{className:"cb-habit-dots-label",children:[P,"/",k," today"]})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:"cb-feature-card cb-card-leaderboard ripple-btn",onClick:C=>{vn(C),b("/client/leaderboard")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Leaderboard"}),se.length>0?a.jsx("div",{className:"cb-lb-preview",children:se.map((C,Y)=>{const Ne=["#FFD700","#A8B4C0","#CD7F32"][Y],Ie=C.name?C.name.split(" ").map(ht=>ht[0]).join("").slice(0,2).toUpperCase():"?",Ue=C.id===t?.id;return a.jsxs("div",{className:`cb-lb-entry${Ue?" cb-lb-me":""}`,children:[a.jsx("div",{className:"cb-lb-avatar",style:{borderColor:Ne},children:C.photoURL?a.jsx("img",{src:C.photoURL,alt:"",className:"cb-lb-avatar-img"}):a.jsx("span",{children:Ie})}),a.jsxs("span",{className:"cb-lb-rank",style:{color:Ne},children:["#",Y+1]})]},C.id)})}):a.jsx("p",{children:"Opt in to compete with your Core Buddies"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),g&&a.jsxs("button",{className:"cb-feature-card cb-card-challenge ripple-btn",onClick:C=>{vn(C),b("/client/core-buddy/challenges")},children:[a.jsx("div",{className:"cb-card-icon-wrap cb-card-icon-challenge",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 12c2-2.96 0-7-1-8 0 3.038-1.773 4.741-3 6-1.226 1.26-2 3.24-2 5a6 6 0 1 0 12 0c0-1.532-1.056-3.94-2-5-1.786 3-2.791 3-4 2z"})})}),a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Challenges"}),a.jsx("p",{children:"Push yourself with timed fitness challenges"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),g&&a.jsxs("button",{className:"cb-feature-card cb-card-buddies ripple-btn",onClick:C=>{vn(C),b("/client/core-buddy/buddies")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Buddies"}),a.jsx("p",{children:"Connect with other members and track each other's progress"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),g&&a.jsxs("div",{className:"cb-journey-section",children:[a.jsx("h3",{className:"cb-journey-title",children:"My Journey"}),a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"journey-compose",children:[a.jsx("div",{className:"journey-compose-avatar",children:ne?a.jsx("img",{src:ne,alt:""}):a.jsx("span",{children:Kc(t?.name)})}),a.jsxs("div",{className:"journey-compose-body",style:{position:"relative"},children:[a.jsx("textarea",{ref:Qt,placeholder:"Share your progress... (use @ to mention)",value:he,onChange:pa,rows:1,maxLength:500}),pn&&Ns==="compose"&&ds.length>0&&a.jsx("div",{className:"mention-dropdown",children:ds.map(C=>a.jsxs("button",{className:"mention-option",onClick:()=>as(C,"compose"),children:[a.jsx("div",{className:"mention-option-avatar",children:C.photoURL?a.jsx("img",{src:C.photoURL,alt:""}):a.jsx("span",{children:Kc(C.name)})}),a.jsx("span",{children:C.name})]},C.id))}),et&&a.jsxs("div",{className:"journey-image-preview",children:[a.jsx("img",{src:et,alt:"Preview"}),a.jsx("button",{className:"journey-image-remove",onClick:Ht,"aria-label":"Remove image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"journey-compose-actions",children:[a.jsx("button",{className:"journey-image-btn",onClick:()=>Fn.current?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:Fn,type:"file",accept:"image/*",onChange:He,hidden:!0}),(he.trim()||yt)&&a.jsx("button",{className:"journey-post-btn",onClick:Ye,disabled:vt,children:vt?a.jsx("div",{className:"journey-btn-spinner"}):"Post"})]})]})]}),ut?a.jsx("div",{className:"journey-loading",children:a.jsx("div",{className:"cb-spinner"})}):rt.length===0?a.jsxs("div",{className:"journey-empty",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("p",{children:"Start sharing your fitness journey!"})]}):a.jsx("div",{className:"journey-list",children:rt.map(C=>a.jsxs("div",{id:`post-${C.id}`,className:"journey-post",children:[a.jsxs("div",{className:"journey-post-header",children:[a.jsx("div",{className:"journey-post-avatar",children:C.authorPhotoURL?a.jsx("img",{src:C.authorPhotoURL,alt:""}):a.jsx("span",{children:Kc(C.authorName)})}),a.jsxs("div",{className:"journey-post-meta",children:[a.jsx("span",{className:"journey-post-name",children:C.authorName}),a.jsx("span",{className:"journey-post-time",children:Yp(C.createdAt)})]}),a.jsx("button",{className:"journey-delete-btn",onClick:()=>Kn(C.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),C.type==="workout_summary"&&C.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:C.metadata.title}),C.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:C.metadata.stats.map(Y=>`${Y.value} ${Y.label}`).join("    ")}),!C.metadata.stats?.length&&C.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:C.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed a workout using Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):C.type==="badge_earned"&&C.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame journey-card-logo-badge",children:a.jsx("img",{src:"/Logo.webp",alt:C.metadata.title,className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:C.metadata.title}),C.metadata.badgeDesc&&a.jsx("p",{className:"journey-card-stats-line",children:C.metadata.badgeDesc}),a.jsx("p",{className:"journey-card-cta",children:"I just earned a badge on Core Buddy"}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):C.type==="habits_summary"&&C.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:C.metadata.title}),C.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:C.metadata.stats.map(Y=>`${Y.value} ${Y.label}`).join("    ")}),C.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:C.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed my daily habits with Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):a.jsxs(a.Fragment,{children:[C.content&&a.jsx("p",{className:"journey-post-content",children:qt(C.content)}),C.imageURL&&a.jsx("div",{className:"journey-post-image",children:a.jsx("img",{src:C.imageURL,alt:"Post",loading:"lazy"})})]}),a.jsxs("div",{className:"journey-post-actions",children:[a.jsxs("button",{className:`journey-action-btn${Cs.has(C.id)?" liked":""}`,onClick:()=>os(C.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:Cs.has(C.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:C.likeCount||0})]}),a.jsxs("button",{className:`journey-action-btn${Jt.has(C.id)?" active":""}`,onClick:()=>Yn(C.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:C.commentCount||0})]})]}),Jt.has(C.id)&&a.jsxs("div",{className:"journey-comments",children:[Ae[C.id]?.length>0?Ae[C.id].map(Y=>a.jsxs("div",{className:"journey-comment",children:[a.jsx("div",{className:"journey-comment-avatar",children:Y.authorPhotoURL?a.jsx("img",{src:Y.authorPhotoURL,alt:""}):a.jsx("span",{children:Kc(Y.authorName)})}),a.jsxs("div",{className:"journey-comment-body",children:[a.jsxs("div",{className:"journey-comment-bubble",children:[a.jsx("span",{className:"journey-comment-name",children:Y.authorName}),Y.replyToName&&a.jsxs("span",{className:"journey-comment-reply-tag",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"9 14 4 9 9 4"}),a.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),Y.replyToName]}),Y.content&&a.jsx("span",{className:"journey-comment-text",children:qt(Y.content)}),Y.imageURL&&a.jsx("img",{className:"journey-comment-image",src:Y.imageURL,alt:"Comment",loading:"lazy"})]}),a.jsxs("div",{className:"journey-comment-actions-row",children:[a.jsx("span",{className:"journey-comment-time",children:Yp(Y.createdAt)}),a.jsx("button",{className:"journey-comment-reply-btn",onClick:()=>an(Ne=>({...Ne,[C.id]:{id:Y.id,authorName:Y.authorName}})),children:"Reply"}),a.jsx("button",{className:"journey-comment-delete-btn",onClick:()=>ma(C.id,Y.id),"aria-label":"Delete comment",children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]})]},Y.id)):a.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),Fe[C.id]&&a.jsxs("div",{className:"journey-comment-replying",children:[a.jsxs("span",{children:["Replying to ",a.jsx("strong",{children:Fe[C.id].authorName})]}),a.jsx("button",{onClick:()=>an(Y=>({...Y,[C.id]:null})),"aria-label":"Cancel reply",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),zn[C.id]&&a.jsxs("div",{className:"journey-comment-img-preview",children:[a.jsx("img",{src:zn[C.id],alt:"Preview"}),a.jsx("button",{onClick:()=>Mr(C.id),"aria-label":"Remove image",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[a.jsx("button",{className:"journey-comment-img-btn",onClick:()=>An.current[C.id]?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:Y=>{An.current[C.id]=Y},type:"file",accept:"image/*",onChange:Y=>Di(C.id,Y),hidden:!0}),a.jsx("input",{type:"text",placeholder:"Comment",value:bt[C.id]||"",onChange:Y=>Lr(C.id,Y.target.value),onKeyDown:Y=>{Y.key==="Enter"&&vr(C.id)},maxLength:300}),pn&&Ns===C.id&&ds.length>0&&a.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:ds.map(Y=>a.jsxs("button",{className:"mention-option",onClick:()=>as(Y,C.id),children:[a.jsx("div",{className:"mention-option-avatar",children:Y.photoURL?a.jsx("img",{src:Y.photoURL,alt:""}):a.jsx("span",{children:Kc(Y.name)})}),a.jsx("span",{children:Y.name})]},Y.id))}),a.jsx("button",{onClick:()=>vr(C.id),disabled:!(bt[C.id]||"").trim()&&!un[C.id]||$e[C.id],children:$e[C.id]?a.jsx("div",{className:"journey-btn-spinner-sm"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),a.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},C.id))})]})]}),!g&&a.jsxs("button",{className:"cb-upgrade-cta",onClick:()=>b("/upgrade"),children:[a.jsx("span",{className:"cb-upgrade-cta-text",children:"Unlock the full experience"}),a.jsx("span",{className:"cb-upgrade-cta-sub",children:"Unlimited workout times, nutrition, buddies & more"}),a.jsxs("svg",{className:"cb-upgrade-cta-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]})]})]}),a.jsx(ui,{active:"home"}),Nn&&a.jsxs("div",{className:`toast-notification ${Nn.type}`,children:[Nn.type==="info"&&a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),a.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),Nn.message]}),a.jsx(r3,{steps:Ir,active:Ar,onFinish:Dr})]})})}const Qp=new Map;function ri(){return new Date().toISOString().split("T")[0]}const Fw=[{key:"breakfast",label:"Breakfast"},{key:"lunch",label:"Lunch"},{key:"dinner",label:"Dinner"},{key:"snacks",label:"Snacks"}],l3={breakfast:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1"}),a.jsx("path",{d:"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"}),a.jsx("line",{x1:"6",y1:"1",x2:"6",y2:"4"}),a.jsx("line",{x1:"10",y1:"1",x2:"10",y2:"4"}),a.jsx("line",{x1:"14",y1:"1",x2:"14",y2:"4"})]}),lunch:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}),dinner:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),snacks:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})};function c3(){const s=new Date().getHours();return s<11?"breakfast":s<14?"lunch":s<17?"snacks":"dinner"}function u3(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Xr(),{isDark:l,toggleTheme:u,accent:h}=fa(),p=ir(),[g,y]=_.useState("loading"),[b,k]=_.useState(null),[E,O]=_.useState({gender:"male",age:"",weight:"",weightUnit:"kg",height:"",heightUnit:"cm",heightFeet:"",heightInches:"",dailyActivity:"sedentary",trainingFrequency:"moderate",goal:"maintain",deficitLevel:"moderate"}),[H,q]=_.useState(null),[B,K]=_.useState(ri()),[$,G]=_.useState({entries:[]}),[fe,xe]=_.useState({protein:0,carbs:0,fats:0,calories:0}),[be,j]=_.useState(!1),[T,R]=_.useState(()=>{const I=new Date;return{year:I.getFullYear(),month:I.getMonth()}}),[P,M]=_.useState(!1),[L,A]=_.useState(()=>{const I=new Date;return{year:I.getFullYear(),month:I.getMonth()}}),[Ve,Qe]=_.useState(!1),[Z,ue]=_.useState(c3),[Ce,Pe]=_.useState(null),[se,D]=_.useState(null),[ne,ve]=_.useState(!1),[Ee,Te]=_.useState(null),[Se,Ke]=_.useState(""),[ct,Be]=_.useState(!1),[sn,Nn]=_.useState(""),[Un,Ot]=_.useState([]),[rt,gt]=_.useState(!1),[ut,Bn]=_.useState({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),[he,Dt]=_.useState(null),[yt,Bt]=_.useState("100"),[et,It]=_.useState(0),[vt,rn]=_.useState("weight"),[Cs,rs]=_.useState(0),[Jt,re]=_.useState(null);_.useRef(null);const Ae=_.useRef(!1),kt=_.useRef(null),bt=_.useRef(null),it=_.useRef(null),$e=_.useCallback((I,z="info")=>{re({message:I,type:z}),setTimeout(()=>re(null),3e3)},[]);_.useEffect(()=>{!i&&(!s||!e)&&p("/")},[s,e,i,p]),_.useEffect(()=>{if(!t?.id)return;(async()=>{try{const z=await pr(Ze(_e,"nutritionTargets",t.id));z.exists()?(k(z.data()),y("dashboard")):y("setup")}catch(z){console.error("Error loading nutrition data:",z),y("setup")}})()},[t?.id]),_.useEffect(()=>{if(!t?.id)return;(async()=>{try{const z=await pr(Ze(_e,"nutritionLogs",`${t.id}_${B}`));if(z.exists()){const ae=z.data();G({entries:ae.entries||[]})}else G({entries:[]})}catch(z){console.error("Error loading log:",z),G({entries:[]})}})()},[t?.id,B]),_.useEffect(()=>{const I=$.entries.reduce((z,ae)=>({protein:z.protein+(ae.protein||0),carbs:z.carbs+(ae.carbs||0),fats:z.fats+(ae.fats||0),calories:z.calories+(ae.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});xe(I)},[$.entries]);const st=async I=>{try{await Ps(Ze(_e,"nutritionLogs",`${t.id}_${B}`),{clientId:t.id,date:B,entries:I.entries,updatedAt:Vt.now()})}catch(z){console.error("Error saving nutrition log:",z)}},Fe=B===ri(),an=(I,z)=>new Date(I,z+1,0).getDate(),un=(I,z)=>new Date(I,z,1).getDay(),Ln=I=>{if(I===ri())return"Today";const z=new Date(I+"T12:00:00"),ae=new Date;return ae.setDate(ae.getDate()-1),I===ae.toISOString().split("T")[0]?"Yesterday":z.toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short"})},zn=["January","February","March","April","May","June","July","August","September","October","November","December"],Xn=["Su","Mo","Tu","We","Th","Fr","Sa"],Qt=()=>{let I=parseFloat(E.weight);E.weightUnit==="lbs"&&(I*=.453592);let z;E.heightUnit==="cm"?z=parseFloat(E.height):z=(parseFloat(E.heightFeet)||0)*30.48+(parseFloat(E.heightInches)||0)*2.54;const ae=parseInt(E.age);let le=E.gender==="male"?10*I+6.25*z-5*ae+5:10*I+6.25*z-5*ae-161;const Le=le*{sedentary:1.2,light:1.3,moderate:1.4,active:1.5}[E.dailyActivity],He={low:100,moderate:200,high:300,daily:400},Ht=Math.round(Le+He[E.trainingFrequency]);let Ye=Ht,Kn,os;switch(E.goal){case"lose":Ye=Ht*(1-{light:.15,moderate:.2,harsh:.25}[E.deficitLevel]),Kn=2.2,os=.3;break;case"build":Ye=Ht*1.1,Kn=2,os=.22;break;default:Kn=1.8,os=.25}Ye=Math.max(Ye,E.gender==="male"?1400:1100);const Us=Math.round(I*Kn),Yn=Math.round(Ye*os/9),vr=Math.max(0,Math.round((Ye-Us*4-Yn*9)/4));q({calories:Math.round(Ye),protein:Us,carbs:vr,fats:Yn,bmr:Math.round(le),neat:Math.round(Le),exerciseAdd:He[E.trainingFrequency],tdee:Math.round(Ht)})},Fn=async()=>{if(H)try{const I={clientId:t.id,calories:H.calories,protein:H.protein,carbs:H.carbs,fats:H.fats,goal:E.goal,updatedAt:Vt.now()};await Ps(Ze(_e,"nutritionTargets",t.id),I),k(I),y("dashboard"),$e("Macro targets saved!","success")}catch(I){console.error("Error saving targets:",I),$e("Failed to save targets. Please try again.","error")}},An=()=>{const I=E.weight&&parseFloat(E.weight)>0,z=E.age&&parseInt(E.age)>0,ae=E.heightUnit==="cm"?E.height&&parseFloat(E.height)>0:E.heightFeet&&parseFloat(E.heightFeet)>0||E.heightInches&&parseFloat(E.heightInches)>0;return I&&z&&ae},hn="nut_favourite_foods",yr=()=>{try{return JSON.parse(localStorage.getItem(hn)||"[]")}catch{return[]}};_.useEffect(()=>{if(!t?.id)return;(async()=>{try{const z=await pr(Ze(_e,"favouriteFoods",t.id));if(z.exists()){const ae=z.data().items||[];localStorage.setItem(hn,JSON.stringify(ae)),rs(le=>le+1)}else{const ae=yr();ae.length>0&&await Ps(Ze(_e,"favouriteFoods",t.id),{items:ae,updatedAt:Vt.now()})}}catch(z){console.error("Error loading favourites:",z)}})()},[t?.id]);const oe=I=>yr().some(z=>z.name.toLowerCase()===(I||"").toLowerCase()),Re=I=>{const z=yr(),ae=z.findIndex(le=>le.name.toLowerCase()===I.name.toLowerCase());ae>=0?z.splice(ae,1):z.unshift({name:I.name,protein:I.protein,carbs:I.carbs,fats:I.fats,calories:I.calories,serving:I.serving,per100g:I.per100g||null,servingUnit:I.servingUnit||"g",portion:I.portion||null}),localStorage.setItem(hn,JSON.stringify(z)),t?.id&&Ps(Ze(_e,"favouriteFoods",t.id),{items:z,updatedAt:Vt.now()}).catch(le=>console.error("Error saving favourites:",le)),rs(le=>le+1)},Ge=I=>{const z=[...$.entries,{...I,meal:Z,id:Date.now(),addedAt:new Date().toISOString()}],ae={...$,entries:z};G(ae),st(ae),D(null),Dt(null),Bt("100"),It(0),rn("weight"),Bn({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),$e("Food added!","success")},mt=I=>{const z=$.entries.filter(le=>le.id!==I),ae={...$,entries:z};G(ae),st(ae)},lt=async I=>{if(!(!t?.id||I===B)){Qe(!0);try{const z=await pr(Ze(_e,"nutritionLogs",`${t.id}_${I}`));if(!z.exists()||!z.data().entries?.length){$e("No food logged on that day","error");return}const ae=z.data().entries.map(Le=>({...Le,id:Date.now()+Math.random(),addedAt:new Date().toISOString()})),le=[...$.entries,...ae],Me={...$,entries:le};G(Me),st(Me),M(!1),$e(`Copied ${ae.length} items from ${Ln(I)}`,"success")}catch(z){console.error("Error copying day:",z),$e("Failed to copy day","error")}finally{Qe(!1)}}},_n=_.useRef(null),Rn=_.useRef([]),pn=3,xn=5,Ns=async()=>{ve(!0);const I=document.querySelector("#barcode-reader");if(!I){ve(!1),$e("Scanner container not found.","error");return}if(!_n.current)try{const ae=await Ks(()=>import("./quagga.min-BbicSfvA.js").then(le=>le.q),[]);_n.current=ae.default}catch(ae){console.error("Failed to load barcode scanner:",ae),ve(!1),$e("Could not load scanner.","error");return}const z=_n.current;z.init({inputStream:{type:"LiveStream",target:I,constraints:{facingMode:"environment",width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080}}},locator:{patchSize:"medium",halfSample:!0},numOfWorkers:navigator.hardwareConcurrency||2,decoder:{readers:["ean_reader","ean_8_reader","upc_reader","upc_e_reader","code_128_reader","code_39_reader"]},locate:!0},ae=>{if(ae){console.error("Quagga init error:",ae),ve(!1),$e("Could not access camera. Check permissions.","error");return}z.start(),Ae.current=!0}),Rn.current=[],z.onDetected(ae=>{const le=ae.codeResult.decodedCodes?.filter(Le=>Le.error!==void 0)?.map(Le=>Le.error)||[];if((le.length>0?le.reduce((Le,He)=>Le+He,0)/le.length:1)<.15){const Le=ae.codeResult.code,He=Rn.current;He.push(Le),He.length>xn&&He.shift(),He.filter(Ye=>Ye===Le).length>=pn&&(z.offDetected(),Rn.current=[],Te(Le))}})},is=()=>{const I=_n.current;Ae.current&&I&&(I.stop(),I.offDetected(),Ae.current=!1),ve(!1)},ds=/\b(milk|semi.skimmed|skimmed|whole milk|oat milk|almond milk|soy milk|juice|smoothie|water|squash|cordial|cola|pepsi|fanta|lemonade|soda|beer|wine|cider|lager|spirit|whisky|vodka|rum|gin|brandy|cream|yoghurt drink|milkshake|coffee|tea|broth|stock|soup|sauce|ketchup|vinegar|oil|syrup|honey|custard|coconut water|kombucha|energy drink|protein shake)\b/i,Zt=I=>/ml|cl|\dl(?!b)|litre|liter|fl\s?oz/i.test((I||"").replace(/\s/g,"")),In=I=>{if(!I)return{value:100,unit:"g"};const z=I.toLowerCase().replace(/\s/g,""),ae=z.match(/([\d.]+)/),le=ae?parseFloat(ae[1]):100;return Zt(I)?/cl/.test(z)?{value:le*10,unit:"ml"}:/(?:^|\d)l(?!i)/.test(z)&&!/ml/.test(z)?{value:le*1e3,unit:"ml"}:{value:le,unit:"ml"}:{value:le,unit:"g"}},As=I=>{if(Zt(I.serving_size)||Zt(I.quantity))return"ml";const z=I.product_name||I.product_name_en||"";return ds.test(z)?"ml":"g"},Ar=[{pattern:/\b(toast|bread|loaf|brioche|bagel|pitta|wrap|tortilla|crumpet|muffin|waffle|pancake)\b/i,label:"slice",weight:36},{pattern:/\begg\b/i,label:"egg",weight:60},{pattern:/\b(biscuit|cookie|digestive|hobnob|rich tea|oreo)\b/i,label:"biscuit",weight:13},{pattern:/\b(sausage|banger)\b/i,label:"sausage",weight:57},{pattern:/\b(rasher|bacon)\b/i,label:"rasher",weight:25},{pattern:/\b(rice cake)\b/i,label:"cake",weight:9},{pattern:/\b(cracker|ryvita)\b/i,label:"cracker",weight:10}],fi=(I,z)=>{const ae=I||"",le=ae.match(/\((\d+\.?\d*)\s*g\)/i),Me=ae.match(/(?:^|per\s+)(\d*\s*[a-z][a-z\s]*?)(?:\s*\(|\s*-\s*|\s*$)/i);if(le&&Me){const Ht=parseFloat(le[1]);let Ye=Me[1].replace(/^\d+\s*/,"").trim();if(Ye&&Ht>0)return{label:Ye,weight:Ht}}const Le=ae.match(/(\d+\.?\d*)\s*g\s*[\/=]\s*(\d*\s*[a-z][a-z\s]*)/i);if(Le){const Ht=parseFloat(Le[1]);let Ye=Le[2].replace(/^\d+\s*/,"").trim();if(Ye&&Ht>0)return{label:Ye,weight:Ht}}const He=z||"";for(const{pattern:Ht,label:Ye,weight:Kn}of Ar)if(Ht.test(He))return{label:Ye,weight:Kn};return null},Rr=I=>{const z=I.nutriments||{},ae=As(I),le=In(I.serving_size),Me=ae==="ml"?le.unit==="ml"?le.value:100:le.value,Le=I.product_name||I.product_name_en||"Unknown Product",He=fi(I.serving_size,Le);return{name:Le,brand:I.brands||"",image:I.image_small_url||I.image_url||null,servingSize:I.serving_size||"100g",servingValue:Me,servingUnit:ae,portion:He,protein:Math.round(z.proteins_100g||z.proteins||0),carbs:Math.round(z.carbohydrates_100g||z.carbohydrates||0),fats:Math.round(z.fat_100g||z.fat||0),calories:Math.round(z["energy-kcal_100g"]||z["energy-kcal"]||(z.energy_100g?z.energy_100g/4.184:0)),per100g:!0}},Ir=async I=>{Be(!0);try{const z=`https://world.openfoodfacts.org/api/v2/product/${I}?fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,ae=await fetch(z);if(!ae.ok)throw new Error(`HTTP ${ae.status}`);const le=await ae.json();if(le.status==="success"||le.status===1||le.product){const Me=Rr(le.product);Me.calories===0&&Me.protein===0&&Me.carbs===0?$e("Product found but no nutrition data available.","error"):(Dt(Me),Me.portion?(It(1),Bt(String(Me.portion.weight)),rn("portion")):(It(0),Bt(String(Me.servingValue||100)),rn("weight")),Ke(""))}else $e("Product not found. Try search or manual entry.","error")}catch(z){console.error("Barcode lookup error:",z),$e("Failed to look up product. Check your connection.","error")}Be(!1)},qn=(I,z,ae)=>{const le=I.toLowerCase().trim(),Me=z.toLowerCase().trim(),Le=ae.toLowerCase().trim();let He=0;return(le===Le||le===Le+"s"||le+"s"===Le)&&(He+=100),(le.endsWith(" "+Le)||le.endsWith(" "+Le+"s"))&&(He+=40),(le.startsWith(Le+" ")||le.startsWith(Le+"s "))&&(He+=15),Le.split(/\s+/).some(Ye=>Me===Ye||Me.startsWith(Ye))&&(He+=30),He+=Math.max(0,30-le.length),He},Ys=async()=>{if(!sn.trim())return;kt.current&&kt.current.abort();const I=new AbortController;kt.current=I;const z=sn.trim().toLowerCase(),ae=z.split(/\s+/).filter(Boolean);if(Qp.has(z)){Ot(Qp.get(z));return}gt(!0);try{const Me=`https://world.openfoodfacts.org/cgi/search.pl?search_terms=${encodeURIComponent(sn.trim())}&search_simple=1&action=process&json=1&page_size=10&lc=en&sort_by=unique_scans_n&fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,Le=await fetch(Me,{signal:I.signal});if(!Le.ok)throw new Error(`HTTP ${Le.status}`);const Ht=((await Le.json()).products||[]).map(Ye=>Rr(Ye)).filter(Ye=>Ye.name!=="Unknown Product"&&(Ye.calories>0||Ye.protein>0)).filter(Ye=>{const Kn=(Ye.name+" "+Ye.brand).toLowerCase();return ae.every(os=>Kn.includes(os))}).sort((Ye,Kn)=>qn(Kn.name,Kn.brand,z)-qn(Ye.name,Ye.brand,z)).slice(0,10);Qp.set(z,Ht),Ot(Ht),Ht.length===0&&$e("No results found. Try a different search.","info")}catch(le){if(le.name==="AbortError")return;console.error("Search error:",le),$e("Search failed. Check your connection.","error")}gt(!1)};_.useEffect(()=>{if(bt.current&&clearTimeout(bt.current),!(!sn.trim()||se!=="search"||he))return bt.current=setTimeout(()=>{Ys()},700),()=>clearTimeout(bt.current)},[sn]);const _s=l,Sn={"ring-protein":_s?"#2dd4bf":"#14b8a6","ring-carbs":_s?"#fbbf24":"#f59e0b","ring-fats":_s?"#a78bfa":"#8b5cf6","ring-cals":"var(--color-primary)"},On=80,as=2*Math.PI*On,qt=(I,z,ae,le,Me)=>{const Le=le>0?Math.min(100,Math.round(ae/le*100)):0,He=as-Le/100*as,Ht=Sn[Me]||"#14b8a6";return a.jsxs("div",{className:"nut-ring-wrap",children:[a.jsxs("svg",{className:"nut-ring-svg",viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"nut-arc-track",cx:"100",cy:"100",r:On}),a.jsx("circle",{className:"nut-arc-fill",cx:"100",cy:"100",r:On,style:{stroke:Ht},strokeDasharray:as,strokeDashoffset:He})]}),a.jsxs("div",{className:"nut-ring-center",children:[a.jsx("span",{className:"nut-ring-value",style:{color:Ht},children:Math.round(ae)}),a.jsxs("span",{className:"nut-ring-target",children:["/ ",le,I==="Calories"?"":"g"]}),a.jsx("span",{className:"nut-ring-label",style:{color:Ht},children:z})]}),a.jsxs("span",{className:"nut-ring-pct",style:{color:Ht},children:[Le,"%"]})]})};if(_.useEffect(()=>{if(!Ee)return;const I=setTimeout(()=>{const z=Ee;is(),Te(null),Ir(z)},1500);return()=>clearTimeout(I)},[Ee]),_.useEffect(()=>()=>{const I=_n.current;if(Ae.current&&I){try{I.stop(),I.offDetected()}catch{}Ae.current=!1}},[]),i||g==="loading")return a.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsx("div",{className:"nut-loading-inline",children:a.jsx("div",{className:"cb-loading-spinner"})})]});if(g==="setup")return a.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"nut-main",children:[a.jsxs("div",{className:"nut-setup-intro",children:[a.jsx("h2",{children:"Set Your Daily Targets"}),a.jsx("p",{children:"Calculate your personalised macros based on your body and goals."})]}),a.jsxs("div",{className:"nut-calc-form",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Gender"}),a.jsxs("div",{className:"nut-toggle-group",children:[a.jsx("button",{className:E.gender==="male"?"active":"",onClick:()=>{O(I=>({...I,gender:"male"})),q(null)},children:"Male"}),a.jsx("button",{className:E.gender==="female"?"active":"",onClick:()=>{O(I=>({...I,gender:"female"})),q(null)},children:"Female"})]})]}),a.jsxs("div",{className:"nut-form-row",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Age"}),a.jsx("input",{type:"number",value:E.age,onChange:I=>{O(z=>({...z,age:I.target.value})),q(null)},placeholder:"Years",min:"15",max:"100"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Weight"}),a.jsxs("div",{className:"nut-input-unit",children:[a.jsx("input",{type:"number",value:E.weight,onChange:I=>{O(z=>({...z,weight:I.target.value})),q(null)},placeholder:E.weightUnit,min:"30",max:"300"}),a.jsxs("div",{className:"nut-unit-toggle",children:[a.jsx("button",{className:E.weightUnit==="kg"?"active":"",onClick:()=>{O(I=>({...I,weightUnit:"kg"})),q(null)},children:"kg"}),a.jsx("button",{className:E.weightUnit==="lbs"?"active":"",onClick:()=>{O(I=>({...I,weightUnit:"lbs"})),q(null)},children:"lbs"})]})]})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Height"}),a.jsxs("div",{className:"nut-input-unit",children:[E.heightUnit==="cm"?a.jsx("input",{type:"number",value:E.height,onChange:I=>{O(z=>({...z,height:I.target.value})),q(null)},placeholder:"cm",min:"100",max:"250"}):a.jsxs("div",{className:"nut-height-imperial",children:[a.jsx("input",{type:"number",value:E.heightFeet,onChange:I=>{O(z=>({...z,heightFeet:I.target.value})),q(null)},placeholder:"ft",min:"4",max:"7"}),a.jsx("input",{type:"number",value:E.heightInches,onChange:I=>{O(z=>({...z,heightInches:I.target.value})),q(null)},placeholder:"in",min:"0",max:"11"})]}),a.jsxs("div",{className:"nut-unit-toggle",children:[a.jsx("button",{className:E.heightUnit==="cm"?"active":"",onClick:()=>{O(I=>({...I,heightUnit:"cm"})),q(null)},children:"cm"}),a.jsx("button",{className:E.heightUnit==="ft"?"active":"",onClick:()=>{O(I=>({...I,heightUnit:"ft"})),q(null)},children:"ft/in"})]})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Daily Activity (outside of training)"}),a.jsxs("select",{value:E.dailyActivity,onChange:I=>{O(z=>({...z,dailyActivity:I.target.value})),q(null)},children:[a.jsx("option",{value:"sedentary",children:"Sedentary  desk job, under 5k steps"}),a.jsx("option",{value:"light",children:"Lightly Active  office + walking, 5-8k steps"}),a.jsx("option",{value:"moderate",children:"Moderately Active  on feet often, 8-12k steps"}),a.jsx("option",{value:"active",children:"Very Active  physical job, 12k+ steps"})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Training Sessions per Week"}),a.jsxs("select",{value:E.trainingFrequency,onChange:I=>{O(z=>({...z,trainingFrequency:I.target.value})),q(null)},children:[a.jsx("option",{value:"low",children:"1-2 sessions"}),a.jsx("option",{value:"moderate",children:"3-4 sessions"}),a.jsx("option",{value:"high",children:"5-6 sessions"}),a.jsx("option",{value:"daily",children:"7+ sessions"})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Fitness Goal"}),a.jsxs("div",{className:"nut-goal-options",children:[a.jsxs("button",{className:E.goal==="lose"?"active":"",onClick:()=>{O(I=>({...I,goal:"lose"})),q(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"-"}),a.jsx("span",{children:"Lose Weight"})]}),a.jsxs("button",{className:E.goal==="maintain"?"active":"",onClick:()=>{O(I=>({...I,goal:"maintain"})),q(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"="}),a.jsx("span",{children:"Maintain"})]}),a.jsxs("button",{className:E.goal==="build"?"active":"",onClick:()=>{O(I=>({...I,goal:"build"})),q(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"+"}),a.jsx("span",{children:"Build Muscle"})]})]})]}),E.goal==="lose"&&a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Deficit Level"}),a.jsxs("div",{className:"nut-deficit-options",children:[a.jsxs("button",{className:E.deficitLevel==="light"?"active":"",onClick:()=>{O(I=>({...I,deficitLevel:"light"})),q(null)},children:[a.jsx("strong",{children:"Mild"}),a.jsx("span",{children:"15% below TDEE"})]}),a.jsxs("button",{className:E.deficitLevel==="moderate"?"active":"",onClick:()=>{O(I=>({...I,deficitLevel:"moderate"})),q(null)},children:[a.jsx("strong",{children:"Moderate"}),a.jsx("span",{children:"20% below TDEE"})]}),a.jsxs("button",{className:E.deficitLevel==="harsh"?"active":"",onClick:()=>{O(I=>({...I,deficitLevel:"harsh"})),q(null)},children:[a.jsx("strong",{children:"Aggressive"}),a.jsx("span",{children:"25% below TDEE"})]})]})]}),a.jsx("button",{className:"nut-calc-btn",onClick:Qt,disabled:!An(),children:"Calculate Macros"})]}),H&&a.jsxs("div",{className:"nut-calc-results",children:[a.jsx("h3",{children:"Your Daily Targets"}),a.jsxs("div",{className:"nut-calc-rings",children:[qt("Protein","Protein",H.protein,H.protein,"ring-protein"),qt("Carbs","Carbs",H.carbs,H.carbs,"ring-carbs"),qt("Fats","Fats",H.fats,H.fats,"ring-fats"),qt("Calories","Calories",H.calories,H.calories,"ring-cals")]}),a.jsxs("div",{className:"nut-calc-info",children:[a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"BMR (body at rest)"}),a.jsxs("span",{children:[H.bmr," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"+ Daily activity (NEAT)"}),a.jsxs("span",{children:[H.neat," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"+ Training sessions"}),a.jsxs("span",{children:["+",H.exerciseAdd," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",style:{fontWeight:600},children:[a.jsx("span",{children:"TDEE (total burn)"}),a.jsxs("span",{children:[H.tdee," cal"]})]})]}),a.jsx("button",{className:"nut-save-targets-btn",onClick:Fn,children:"Set as My Daily Targets"})]})]}),Jt&&a.jsx("div",{className:`toast-notification ${Jt.type}`,children:Jt.message})]});const Jr=I=>{const z=new Date(I+"T12:00:00"),ae=z.getDay(),le=new Date(z);le.setDate(z.getDate()-(ae+6)%7);const Me=[];for(let Le=0;Le<7;Le++){const He=new Date(le);He.setDate(le.getDate()+Le),Me.push(He.toISOString().split("T")[0])}return Me},Dr=["M","T","W","T","F","S","S"],xs=(I,z="search")=>{ue(I),z==="scan"?(D("scan"),Dt(null)):z==="manual"?(D("manual"),Bn({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""})):z==="favourites"?D("favourites"):(D("search"),Ot([]),Nn(""))},vn=Jr(B),ar=new Date(B+"T12:00:00"),mi=`${zn[ar.getMonth()]} ${ar.getFullYear()}`;return a.jsx(Xo,{children:a.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsxs("div",{className:"nut-dark-zone",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:()=>{y("setup"),q(null)},"aria-label":"Recalculate macros",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]})]})}),a.jsxs("div",{className:"nut-dark-content",children:[a.jsxs("div",{className:"nut-week-strip anim-fade-up",children:[a.jsxs("div",{className:"nut-week-header",children:[a.jsx("button",{className:"nut-week-arrow",onClick:()=>{const I=new Date(B+"T12:00:00");I.setDate(I.getDate()-7);const z=I.toISOString().split("T")[0];K(z)},"aria-label":"Previous week",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsx("button",{className:"nut-week-month-label",onClick:()=>{j(!be),R({year:ar.getFullYear(),month:ar.getMonth()})},children:mi}),a.jsx("button",{className:"nut-week-arrow",onClick:()=>{const I=new Date(B+"T12:00:00");I.setDate(I.getDate()+7);const z=I.toISOString().split("T")[0];z<=ri()&&K(z)},"aria-label":"Next week",disabled:vn[6]>=ri(),children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-week-days",children:vn.map((I,z)=>{const ae=new Date(I+"T12:00:00").getDate(),le=I===B,Me=I>ri(),Le=I===ri();return a.jsxs("button",{className:`nut-week-day${le?" selected":""}${Le?" today":""}${Me?" future":""}`,disabled:Me,onClick:()=>K(I),children:[a.jsx("span",{className:"nut-week-day-letter",children:Dr[z]}),a.jsx("span",{className:"nut-week-day-num",children:ae})]},I)})})]}),be&&a.jsxs("div",{className:"nut-calendar nut-calendar-dark",children:[a.jsxs("div",{className:"nut-cal-header",children:[a.jsx("button",{onClick:()=>R(I=>{let z=I.month-1,ae=I.year;return z<0&&(z=11,ae--),{year:ae,month:z}}),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsxs("span",{children:[zn[T.month]," ",T.year]}),a.jsx("button",{onClick:()=>R(I=>{let z=I.month+1,ae=I.year;return z>11&&(z=0,ae++),{year:ae,month:z}}),disabled:T.year===new Date().getFullYear()&&T.month>=new Date().getMonth(),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-cal-days-header",children:Xn.map(I=>a.jsx("span",{children:I},I))}),a.jsxs("div",{className:"nut-cal-grid",children:[[...Array(un(T.year,T.month))].map((I,z)=>a.jsx("span",{},`e${z}`)),[...Array(an(T.year,T.month))].map((I,z)=>{const ae=z+1,le=`${T.year}-${String(T.month+1).padStart(2,"0")}-${String(ae).padStart(2,"0")}`,Me=le>ri(),Le=le===B,He=le===ri();return a.jsx("button",{className:`nut-cal-day${Le?" selected":""}${He?" today":""}${Me?" future":""}`,disabled:Me,onClick:()=>{K(le),j(!1)},children:ae},ae)})]})]}),a.jsxs("div",{className:"nut-rings-row anim-fade-up-d2",children:[qt("Protein","Protein",fe.protein,b.protein,"ring-protein"),qt("Carbs","Carbs",fe.carbs,b.carbs,"ring-carbs"),qt("Fats","Fats",fe.fats,b.fats,"ring-fats"),qt("Calories","kCal",fe.calories,b.calories,"ring-cals")]})]})]}),a.jsx("div",{className:"nut-light-zone anim-fade-up-d4",children:a.jsxs("div",{className:"nut-light-content",children:[Fe&&a.jsx("div",{className:"nut-quick-row",children:a.jsxs("button",{className:"nut-copy-day-btn",onClick:()=>{M(!0),A({year:new Date().getFullYear(),month:new Date().getMonth()})},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",width:"18",height:"18",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),a.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),a.jsx("span",{children:"Copy day"})]})}),a.jsx("div",{className:"nut-log-section",children:a.jsx("div",{className:"nut-meals-list",children:Fw.map(I=>{const z=$.entries.filter(le=>(le.meal||"snacks")===I.key),ae=z.reduce((le,Me)=>({protein:le.protein+(Me.protein||0),carbs:le.carbs+(Me.carbs||0),fats:le.fats+(Me.fats||0),calories:le.calories+(Me.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});return a.jsxs("div",{className:"nut-meal-card",children:[a.jsxs("div",{className:"nut-meal-card-header",children:[a.jsx("span",{className:`nut-meal-card-icon nut-meal-icon-${I.key}`,children:l3[I.key]}),a.jsx("span",{className:"nut-meal-card-title",children:I.label}),z.length>0&&a.jsxs("span",{className:"nut-meal-card-cal",children:[ae.calories," cal"]}),Fe&&a.jsx("button",{className:"nut-meal-add-btn",onClick:()=>Pe(Ce===I.key?null:I.key),"aria-label":`Add to ${I.label}`,children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]}),z.length>0&&a.jsxs("div",{className:"nut-meal-bars",children:[a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-p",children:"P"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-protein",style:{width:`${Math.min(100,b.protein>0?ae.protein/b.protein*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[ae.protein,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-c",children:"C"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-carbs",style:{width:`${Math.min(100,b.carbs>0?ae.carbs/b.carbs*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[ae.carbs,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-f",children:"F"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-fats",style:{width:`${Math.min(100,b.fats>0?ae.fats/b.fats*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[ae.fats,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-cal",children:"K"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-cals",style:{width:`${Math.min(100,b.calories>0?ae.calories/b.calories*100:0)}%`}})}),a.jsx("span",{className:"nut-meal-bar-val",children:ae.calories})]})]}),z.length>0&&a.jsx("div",{className:"nut-log-list",children:z.map(le=>a.jsxs("div",{className:"nut-log-item",children:[a.jsx("button",{className:`nut-fav-star log${oe(le.name)?" active":""}`,onClick:()=>Re(le),"aria-label":oe(le.name)?"Remove from favourites":"Add to favourites",children:a.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:oe(le.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("div",{className:"nut-log-item-info",children:[a.jsx("span",{className:"nut-log-item-name",children:le.name}),le.serving&&a.jsx("span",{className:"nut-log-item-serving",children:le.serving})]}),a.jsxs("div",{className:"nut-log-item-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[le.protein,"p"]}),a.jsxs("span",{className:"nut-macro-c",children:[le.carbs,"c"]}),a.jsxs("span",{className:"nut-macro-f",children:[le.fats,"f"]}),a.jsx("span",{className:"nut-macro-cal",children:le.calories})]}),Fe&&a.jsx("button",{className:"nut-log-delete",onClick:()=>mt(le.id),"aria-label":"Remove",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},le.id))}),z.length===0&&a.jsx("div",{className:"nut-meal-empty",children:a.jsx("p",{children:Fe?"Tap + to add food":"No entries"})})]},I.key)})})})]})}),Ce&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"nut-add-picker-backdrop",onClick:()=>Pe(null)}),a.jsxs("div",{className:"nut-add-picker",children:[a.jsx("div",{className:"nut-add-picker-handle"}),a.jsxs("h3",{className:"nut-add-picker-title",children:["Add to ",Fw.find(I=>I.key===Ce)?.label]}),a.jsxs("div",{className:"nut-add-picker-options",children:[a.jsxs("button",{onClick:()=>{const I=Ce;Pe(null),xs(I,"scan")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),a.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),a.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),a.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),a.jsx("span",{children:"Scan Barcode"})]}),a.jsxs("button",{onClick:()=>{const I=Ce;Pe(null),xs(I,"search")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("span",{children:"Search Food"})]}),a.jsxs("button",{onClick:()=>{const I=Ce;Pe(null),xs(I,"manual")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),a.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),a.jsx("span",{children:"Manual Entry"})]}),a.jsxs("button",{onClick:()=>{const I=Ce;Pe(null),xs(I,"favourites")},children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),a.jsx("span",{children:"Favourites"})]})]})]})]}),P&&a.jsx("div",{className:"nut-modal-overlay",onClick:()=>M(!1),children:a.jsxs("div",{className:"nut-copy-from-popup",onClick:I=>I.stopPropagation(),children:[a.jsxs("div",{className:"nut-copy-from-header",children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",width:"20",height:"20",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),a.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),a.jsx("span",{children:"Copy from..."}),a.jsx("button",{className:"nut-modal-close",onClick:()=>M(!1),children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),a.jsx("p",{className:"nut-copy-from-hint",children:"Pick a day to copy its food log into today"}),a.jsxs("div",{className:"nut-cal-header",children:[a.jsx("button",{onClick:()=>A(I=>{let z=I.month-1,ae=I.year;return z<0&&(z=11,ae--),{year:ae,month:z}}),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsxs("span",{children:[zn[L.month]," ",L.year]}),a.jsx("button",{onClick:()=>A(I=>{let z=I.month+1,ae=I.year;return z>11&&(z=0,ae++),{year:ae,month:z}}),disabled:L.year===new Date().getFullYear()&&L.month>=new Date().getMonth(),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-cal-days-header",children:Xn.map(I=>a.jsx("span",{children:I},I))}),a.jsxs("div",{className:"nut-cal-grid",children:[[...Array(un(L.year,L.month))].map((I,z)=>a.jsx("span",{},`e${z}`)),[...Array(an(L.year,L.month))].map((I,z)=>{const ae=z+1,le=`${L.year}-${String(L.month+1).padStart(2,"0")}-${String(ae).padStart(2,"0")}`,Me=le>ri(),Le=le===B,He=le===ri(),Ht=Me||Le;return a.jsx("button",{className:`nut-cal-day${Le?" selected":""}${He?" today":""}${Me?" future":""}`,disabled:Ht,onClick:()=>lt(le),children:ae},ae)})]}),Ve&&a.jsxs("div",{className:"nut-copy-from-loading",children:[a.jsx("div",{className:"wk-loading-spinner"}),a.jsx("span",{children:"Copying..."})]})]})}),se&&a.jsx("div",{className:"nut-modal-overlay",onClick:()=>{is(),Te(null),D(null),Dt(null)},children:a.jsxs("div",{className:"nut-modal",onClick:I=>I.stopPropagation(),children:[a.jsxs("div",{className:"nut-modal-header",children:[a.jsx("h3",{children:se==="scan"?"Scan Barcode":se==="search"?"Search Food":se==="favourites"?"Favourites":"Manual Entry"}),a.jsx("button",{className:"nut-modal-close",onClick:()=>{is(),Te(null),D(null),Dt(null)},children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),se==="scan"&&!he&&a.jsxs("div",{className:"nut-scan-area",children:[a.jsxs("div",{className:"nut-scanner-wrapper",children:[a.jsx("div",{id:"barcode-reader",className:"nut-scanner-view"}),ne&&!Ee&&a.jsx("div",{className:"nut-scan-line"}),Ee&&a.jsxs("div",{className:"nut-scan-detected-overlay",children:[a.jsx("svg",{className:"nut-scan-detected-tick",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),a.jsx("p",{className:"nut-scan-detected-label",children:"Barcode found!"}),a.jsx("p",{className:"nut-scan-detected-code",children:Ee})]})]}),!ne&&a.jsxs("button",{className:"nut-scan-start-btn",onClick:Ns,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),a.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),a.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),a.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),"Open Camera"]}),ne&&!Ee&&a.jsx("p",{className:"nut-scan-hint",children:"Align barcode within the frame"}),a.jsx("div",{className:"nut-barcode-divider",children:a.jsx("span",{children:"or enter barcode manually"})}),a.jsxs("div",{className:"nut-barcode-manual",children:[a.jsx("input",{type:"text",inputMode:"numeric",value:Se,onChange:I=>Ke(I.target.value),onKeyDown:I=>I.key==="Enter"&&Se.trim()&&Ir(Se.trim()),placeholder:"Enter barcode number"}),a.jsx("button",{onClick:()=>Se.trim()&&Ir(Se.trim()),disabled:!Se.trim()||ct,children:ct?"...":"Look Up"})]})]}),se==="scan"&&he&&(()=>{const I=he.servingUnit||"g",z=he.portion,ae=vt==="portion"&&z?et*z.weight:parseFloat(yt)||0,le=ae/100,Me=I==="ml"?[100,200,250,500]:[50,100,150,200],Le=vt==="portion"&&z?`${et} ${z.label}${et!==1?"s":""} (${Math.round(ae)}${I})`:`${Math.round(ae)}${I}`;return a.jsxs("div",{className:"nut-product-result",children:[he.image&&a.jsx("img",{src:he.image,alt:he.name||"Product",className:"nut-product-img",loading:"lazy"}),a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:he.name}),a.jsx("button",{className:`nut-fav-star confirm${oe(he.name)?" active":""}`,onClick:()=>Re({name:he.name,protein:he.protein,carbs:he.carbs,fats:he.fats,calories:he.calories,serving:he.servingSize,per100g:{protein:he.protein,carbs:he.carbs,fats:he.fats,calories:he.calories},servingUnit:he.servingUnit||"g",portion:he.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:oe(he.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),he.brand&&a.jsx("p",{className:"nut-product-brand",children:he.brand}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",I,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[he.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[he.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[he.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[he.calories," cal"]})]}),z&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:vt==="portion"?"active":"",onClick:()=>{rn("portion"),et<1&&It(1)},children:"Portions"}),a.jsxs("button",{className:vt==="weight"?"active":"",onClick:()=>{rn("weight"),Bt(String(Math.round(ae)||100))},children:["Custom (",I,")"]})]}),vt==="portion"&&z?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>It(Math.max(1,et-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:et}),a.jsxs("span",{className:"nut-stepper-label",children:[z.label,et!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(ae),I]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>It(et+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",I,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:yt,onChange:He=>Bt(He.target.value),onFocus:He=>He.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Me.map(He=>a.jsxs("button",{className:`nut-quick-btn${yt===String(He)?" active":""}`,onClick:()=>Bt(String(He)),children:[He,I]},He))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(he.protein*le),"p / ",Math.round(he.carbs*le),"c / ",Math.round(he.fats*le),"f / ",Math.round(he.calories*le)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>{Dt(null),D("scan")},children:"Scan Again"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>Ge({name:he.name,protein:Math.round(he.protein*le),carbs:Math.round(he.carbs*le),fats:Math.round(he.fats*le),calories:Math.round(he.calories*le),serving:Le}),children:"Add"})]})]})})(),se==="search"&&!he&&a.jsxs("div",{className:"nut-search-area",children:[a.jsxs("div",{className:"nut-search-bar",children:[a.jsx("input",{type:"text",ref:it,value:sn,onChange:I=>Nn(I.target.value),onKeyDown:I=>{I.key==="Enter"&&(clearTimeout(bt.current),Ys())},onFocus:()=>setTimeout(()=>it.current?.scrollIntoView({behavior:"smooth",block:"center"}),350),placeholder:"Search food or product...",autoFocus:!0}),a.jsx("button",{onClick:Ys,disabled:rt,children:rt?"...":"Search"})]}),a.jsxs("div",{className:"nut-search-results",children:[Un.map((I,z)=>a.jsxs("button",{className:"nut-search-item",onClick:()=>{Dt(I),I.portion?(It(1),Bt(String(I.portion.weight)),rn("portion")):(It(0),Bt(String(I.servingValue||100)),rn("weight"))},children:[I.image&&a.jsx("img",{src:I.image,alt:I.name||"Product",loading:"lazy"}),a.jsxs("div",{className:"nut-search-item-info",children:[a.jsx("span",{className:"nut-search-item-name",children:I.name}),I.brand&&a.jsx("span",{className:"nut-search-item-brand",children:I.brand}),a.jsxs("span",{className:"nut-search-item-macros",children:[I.calories," cal  ",I.protein,"p  ",I.carbs,"c  ",I.fats,"f per 100",I.servingUnit||"g"]})]})]},z)),Un.length===0&&sn&&!rt&&a.jsx("p",{className:"nut-search-empty",children:"No results found. Try a different search or use manual entry."})]})]}),se==="search"&&he&&(()=>{const I=he.servingUnit||"g",z=he.portion,ae=vt==="portion"&&z?et*z.weight:parseFloat(yt)||0,le=ae/100,Me=I==="ml"?[100,200,250,500]:[50,100,150,200],Le=vt==="portion"&&z?`${et} ${z.label}${et!==1?"s":""} (${Math.round(ae)}${I})`:`${Math.round(ae)}${I}`;return a.jsxs("div",{className:"nut-product-result",children:[he.image&&a.jsx("img",{src:he.image,alt:he.name||"Product",className:"nut-product-img",loading:"lazy"}),a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:he.name}),a.jsx("button",{className:`nut-fav-star confirm${oe(he.name)?" active":""}`,onClick:()=>Re({name:he.name,protein:he.protein,carbs:he.carbs,fats:he.fats,calories:he.calories,serving:he.servingSize,per100g:{protein:he.protein,carbs:he.carbs,fats:he.fats,calories:he.calories},servingUnit:he.servingUnit||"g",portion:he.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:oe(he.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),he.brand&&a.jsx("p",{className:"nut-product-brand",children:he.brand}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",I,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[he.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[he.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[he.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[he.calories," cal"]})]}),z&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:vt==="portion"?"active":"",onClick:()=>{rn("portion"),et<1&&It(1)},children:"Portions"}),a.jsxs("button",{className:vt==="weight"?"active":"",onClick:()=>{rn("weight"),Bt(String(Math.round(ae)||100))},children:["Custom (",I,")"]})]}),vt==="portion"&&z?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>It(Math.max(1,et-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:et}),a.jsxs("span",{className:"nut-stepper-label",children:[z.label,et!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(ae),I]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>It(et+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",I,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:yt,onChange:He=>Bt(He.target.value),onFocus:He=>He.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Me.map(He=>a.jsxs("button",{className:`nut-quick-btn${yt===String(He)?" active":""}`,onClick:()=>Bt(String(He)),children:[He,I]},He))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(he.protein*le),"p / ",Math.round(he.carbs*le),"c / ",Math.round(he.fats*le),"f / ",Math.round(he.calories*le)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>Dt(null),children:"Back to Search"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>Ge({name:he.name,protein:Math.round(he.protein*le),carbs:Math.round(he.carbs*le),fats:Math.round(he.fats*le),calories:Math.round(he.calories*le),serving:Le}),children:"Add"})]})]})})(),se==="manual"&&a.jsxs("div",{className:"nut-manual-form",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Food Name"}),a.jsx("input",{type:"text",value:ut.name,onChange:I=>Bn(z=>({...z,name:I.target.value})),placeholder:"e.g. Chicken Breast",autoFocus:!0})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Serving Size (optional)"}),a.jsx("input",{type:"text",value:ut.serving,onChange:I=>Bn(z=>({...z,serving:I.target.value})),placeholder:"e.g. 150g, 1 cup"})]}),a.jsxs("div",{className:"nut-manual-macros",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Protein (g)"}),a.jsx("input",{type:"number",value:ut.protein,onChange:I=>Bn(z=>({...z,protein:I.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Carbs (g)"}),a.jsx("input",{type:"number",value:ut.carbs,onChange:I=>Bn(z=>({...z,carbs:I.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Fats (g)"}),a.jsx("input",{type:"number",value:ut.fats,onChange:I=>Bn(z=>({...z,fats:I.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Calories"}),a.jsx("input",{type:"number",value:ut.calories,onChange:I=>Bn(z=>({...z,calories:I.target.value})),min:"0"})]})]}),a.jsx("button",{className:"nut-btn-primary",disabled:!ut.name.trim(),onClick:()=>Ge({name:ut.name,protein:parseFloat(ut.protein)||0,carbs:parseFloat(ut.carbs)||0,fats:parseFloat(ut.fats)||0,calories:parseFloat(ut.calories)||0,serving:ut.serving||""}),children:"Add Food"})]}),se==="favourites"&&!he&&(()=>{const I=yr(),z=ae=>{if(ae.per100g){const le=ae.per100g;Dt({name:ae.name,brand:"",image:null,servingSize:ae.serving||"100g",servingValue:100,servingUnit:ae.servingUnit||"g",portion:ae.portion||null,protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories,per100g:!0}),ae.portion?(It(1),Bt(String(ae.portion.weight)),rn("portion")):(It(0),Bt("100"),rn("weight"))}else Ge({name:ae.name,protein:ae.protein,carbs:ae.carbs,fats:ae.fats,calories:ae.calories,serving:ae.serving||""})};return a.jsx("div",{className:"nut-recent-area",children:I.length===0?a.jsx("p",{className:"nut-search-empty",children:"No favourites yet. Tap the star on any food to save it here."}):a.jsx("div",{className:"nut-recent-list",children:I.map((ae,le)=>a.jsxs("div",{className:"nut-recent-item-row",children:[a.jsx("button",{className:"nut-fav-star active",onClick:Me=>{Me.stopPropagation(),Re(ae)},children:a.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("button",{className:"nut-recent-item",onClick:()=>z(ae),children:[a.jsxs("div",{className:"nut-recent-item-info",children:[a.jsx("span",{className:"nut-recent-item-name",children:ae.name}),a.jsx("span",{className:"nut-recent-item-serving",children:ae.serving||""})]}),a.jsxs("span",{className:"nut-recent-item-macros",children:[ae.calories," cal"]})]})]},le))})})})(),se==="favourites"&&he&&(()=>{const I=he.servingUnit||"g",z=he.portion,ae=vt==="portion"&&z?et*z.weight:parseFloat(yt)||0,le=ae/100,Me=I==="ml"?[100,200,250,500]:[50,100,150,200],Le=vt==="portion"&&z?`${et} ${z.label}${et!==1?"s":""} (${Math.round(ae)}${I})`:`${Math.round(ae)}${I}`;return a.jsxs("div",{className:"nut-product-result",children:[a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:he.name}),a.jsx("button",{className:`nut-fav-star confirm${oe(he.name)?" active":""}`,onClick:()=>Re({name:he.name,protein:he.protein,carbs:he.carbs,fats:he.fats,calories:he.calories,serving:he.servingSize,per100g:{protein:he.protein,carbs:he.carbs,fats:he.fats,calories:he.calories},servingUnit:he.servingUnit||"g",portion:he.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:oe(he.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",I,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[he.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[he.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[he.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[he.calories," cal"]})]}),z&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:vt==="portion"?"active":"",onClick:()=>{rn("portion"),et<1&&It(1)},children:"Portions"}),a.jsxs("button",{className:vt==="weight"?"active":"",onClick:()=>{rn("weight"),Bt(String(Math.round(ae)||100))},children:["Custom (",I,")"]})]}),vt==="portion"&&z?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>It(Math.max(1,et-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:et}),a.jsxs("span",{className:"nut-stepper-label",children:[z.label,et!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(ae),I]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>It(et+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",I,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:yt,onChange:He=>Bt(He.target.value),onFocus:He=>He.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Me.map(He=>a.jsxs("button",{className:`nut-quick-btn${yt===String(He)?" active":""}`,onClick:()=>Bt(String(He)),children:[He,I]},He))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(he.protein*le),"p / ",Math.round(he.carbs*le),"c / ",Math.round(he.fats*le),"f / ",Math.round(he.calories*le)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>Dt(null),children:"Back to Favourites"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>Ge({name:he.name,protein:Math.round(he.protein*le),carbs:Math.round(he.carbs*le),fats:Math.round(he.fats*le),calories:Math.round(he.calories*le),serving:Le}),children:"Add"})]})]})})()]})}),a.jsx(ui,{active:"nutrition"}),Jt&&a.jsx("div",{className:`toast-notification ${Jt.type}`,children:Jt.message})]})})}async function h3(s){const{type:e="workout",title:t="Workout Complete!",stats:i=[],badges:l=[],badgeImage:u,badgeDesc:h}=s,p=1080,g=1920,y=document.createElement("canvas");y.width=p,y.height=g;const b=y.getContext("2d"),k="#2a2a28",E="#ffffff",O="#A12F3A",H="#1a1a1a",q="#555555";b.fillStyle=k,b.fillRect(0,0,p,g);const B=Math.round(p*.82),K=Math.round(g*.75),$=Math.round((p-B)/2),G=Math.round((g-K)/2),fe=28,xe=5;b.save(),b.shadowColor="rgba(0, 0, 0, 0.45)",b.shadowBlur=40,b.shadowOffsetY=10,qw(b,$,G,B,K,fe),b.fillStyle=E,b.fill(),b.restore(),b.save(),qw(b,$,G,B,K,fe),b.strokeStyle=O,b.lineWidth=xe,b.stroke(),b.restore();const be=220,j=50,T=52,R=68,P=10,M=36,L=48,A=30,Ve=34,Qe=46,Z=30,ue=28;b.font=`bold ${T}px 'Orbitron', sans-serif`;const Ce=Yc(b,t.toUpperCase(),B-100);b.font=`500 ${M}px 'Montserrat', sans-serif`;let Pe=[];e==="badge"&&h?Pe=Yc(b,h,B-120):e==="badge"&&l.length>0?Pe=Yc(b,l.join("    "),B-120):i.length>0&&(Pe=Yc(b,i.map(gt=>`${gt.value} ${gt.label}`).join("    "),B-120));const se=e==="badge"?"I just earned a badge on Core Buddy ":e==="habits"?"I just completed my daily habits with Core Buddy ":"I just completed a workout using Core Buddy ";b.font=`bold ${Ve}px 'Montserrat', sans-serif`;const D=Yc(b,se,B-80);let ne=Ce.length*R;Pe.length>0&&(ne+=P+Pe.length*L),ne+=A+D.length*Qe,ne+=Z+ue;const Ee=G+K-60-ne,Se=G+40,Ke=Ee-j,ct=p/2,Be=(Se+Ke)/2,sn=e==="badge"&&u?u:"/Logo.webp";b.save();const Nn=e==="badge"?"rgba(255, 193, 7, 0.15)":"rgba(161, 47, 58, 0.12)",Un=b.createRadialGradient(ct,Be,be*.6,ct,Be,be*1.5);Un.addColorStop(0,Nn),Un.addColorStop(1,"rgba(0, 0, 0, 0)"),b.fillStyle=Un,b.fillRect(ct-be*1.5,Be-be*1.5,be*3,be*3),b.restore(),b.beginPath(),b.arc(ct,Be,be+6,0,Math.PI*2),b.fillStyle=E,b.fill();const Ot=e==="badge"?"#ffc107":O;b.beginPath(),b.arc(ct,Be,be,0,Math.PI*2),b.strokeStyle=Ot,b.lineWidth=5,b.stroke();try{const gt=await d3(sn);b.save(),b.beginPath(),b.arc(ct,Be,be-6,0,Math.PI*2),b.clip();const ut=(be-6)*2;b.drawImage(gt,ct-be+6,Be-be+6,ut,ut),b.restore()}catch{b.textAlign="center",b.textBaseline="middle",b.fillStyle=O,b.font="bold 80px 'Orbitron', sans-serif",b.fillText(e==="badge"?"":"MCF",ct,Be)}let rt=Ee;b.textAlign="center",b.textBaseline="alphabetic",b.fillStyle=H,b.font=`bold ${T}px 'Orbitron', sans-serif`;for(const gt of Ce)b.fillText(gt,p/2,rt),rt+=R;if(Pe.length>0){rt+=P,b.fillStyle=q,b.font=`500 ${M}px 'Montserrat', sans-serif`;for(const gt of Pe)b.fillText(gt,p/2,rt),rt+=L}rt+=A,b.fillStyle=H,b.font=`bold ${Ve}px 'Montserrat', sans-serif`;for(const gt of D)b.fillText(gt,p/2,rt),rt+=Qe;return rt+=Z,b.fillStyle=O,b.font=`600 ${ue}px 'Montserrat', sans-serif`,b.fillText("Make It Count with Core Buddy",p/2,rt),new Promise(gt=>{y.toBlob(ut=>gt(ut),"image/png")})}function qw(s,e,t,i,l,u){s.beginPath(),s.moveTo(e+u,t),s.lineTo(e+i-u,t),s.quadraticCurveTo(e+i,t,e+i,t+u),s.lineTo(e+i,t+l-u),s.quadraticCurveTo(e+i,t+l,e+i-u,t+l),s.lineTo(e+u,t+l),s.quadraticCurveTo(e,t+l,e,t+l-u),s.lineTo(e,t+u),s.quadraticCurveTo(e,t,e+u,t),s.closePath()}function d3(s){return new Promise((e,t)=>{const i=new Image;i.crossOrigin="anonymous",i.onload=()=>e(i),i.onerror=t,i.src=s})}function Yc(s,e,t){if(s.measureText(e).width<=t)return[e];const i=e.split(" "),l=[];let u="";for(const h of i){const p=u?`${u} ${h}`:h;s.measureText(p).width>t&&u?(l.push(u),u=h):u=p}return u&&l.push(u),l}function f3(){const s=_.useRef(null),e=_.useCallback(()=>{if(!s.current)try{s.current=new(window.AudioContext||window.webkitAudioContext)}catch{}const u=s.current;return u?.state==="suspended"&&u.resume(),u},[]),t=_.useCallback(()=>{navigator.vibrate&&navigator.vibrate([40,60,30]);const u=e();if(!u)return;const h=u.currentTime,p=u.createBiquadFilter();p.type="lowpass",p.frequency.value=500,p.Q.value=.7,p.connect(u.destination);const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=50,y.gain.value=.3,y.gain.setTargetAtTime(0,h+.08,.04),g.connect(y).connect(p),g.start(h),g.stop(h+.2);const b=u.createOscillator(),k=u.createGain();b.type="sine",b.frequency.value=70,k.gain.value=.2,k.gain.setTargetAtTime(0,h+.22,.04),b.connect(k).connect(p),b.start(h+.15),b.stop(h+.35)},[e]),i=_.useCallback(()=>{navigator.vibrate&&navigator.vibrate(30);const u=e();if(!u)return;const h=u.currentTime,p=u.createBiquadFilter();p.type="lowpass",p.frequency.value=500,p.Q.value=.7,p.connect(u.destination);const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=55,y.gain.value=.35,y.gain.setTargetAtTime(0,h+.08,.04),g.connect(y).connect(p),g.start(h),g.stop(h+.2)},[e]),l=_.useCallback(()=>{navigator.vibrate&&navigator.vibrate([50,80,100]);const u=e();u&&[0,.12].forEach((h,p)=>{const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=p===0?523:784,y.gain.value=.12,y.gain.setTargetAtTime(0,u.currentTime+h+.15,.02),g.connect(y).connect(u.destination),g.start(u.currentTime+h),g.stop(u.currentTime+h+.2)})},[e]);return _.useEffect(()=>()=>{s.current?.close()},[]),{tap:i,tick:t,complete:l}}const m3=2e3,Fg=42,Nl=2*Math.PI*Fg,p3=1200,Hw=["Another one in the bank!","Consistency beats everything.","You showed up  that's what counts.","Stronger every session."];function qg({title:s,subtitle:e,stats:t,onDone:i,onDismissStart:l,onShareJourney:u,userName:h,buttonLabel:p="Done",holdLabel:g="Hold To Complete Session",shareType:y="workout",hideShare:b=!1}){const[k,E]=_.useState("hold"),[O,H]=_.useState(!1),[q,B]=_.useState(0),[K,$]=_.useState(!1),[G,fe]=_.useState(!1),[xe,be]=_.useState(null),j=f3(),T=_.useRef(null),R=_.useRef(null),P=_.useRef(null),M=_.useRef(null),L=_.useRef(!1),A=_.useRef(!1),Ve=_.useRef(0),Qe=_.useRef(Hw[Math.floor(Math.random()*Hw.length)]),Z=_.useRef([...Array(80)].map((Te,Se)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#ffffff","#000000"][Se%3],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:Se%3}))),ue=_.useCallback(()=>{if(L.current)return;L.current=!0,A.current=!1,Ve.current=0,H(!0),B(0),M.current=performance.now(),j.tap(),T.current&&(T.current.style.strokeDashoffset=Nl);const Te=Se=>{const Ke=Se-M.current,ct=Math.min(Ke/m3,1);if(T.current&&(T.current.style.strokeDashoffset=Nl-ct*Nl),R.current){const Be=8*(1-ct),sn=1-ct,Nn=1+ct*.15;R.current.style.filter=`blur(${Be}px) grayscale(${sn})`,R.current.style.transform=`scale(${Nn})`}B(ct),Ke-Ve.current>=p3&&(Ve.current=Ke,j.tick()),ct<1?P.current=requestAnimationFrame(Te):(L.current=!1,A.current=!0,P.current=null,H(!1),B(1),j.complete(),E("celebrate"))};P.current=requestAnimationFrame(Te)},[j]),Ce=_.useCallback(()=>{L.current&&(L.current=!1,P.current&&(cancelAnimationFrame(P.current),P.current=null),T.current&&(T.current.style.strokeDashoffset=Nl),R.current&&(R.current.style.filter="",R.current.style.transform=""),H(!1),B(0))},[]),Pe=_.useCallback(()=>{$(!0),l?.(),setTimeout(()=>{i?.()},300)},[i,l]),se=_.useCallback(()=>{const Te=[s||"Workout Complete!"];return e&&Te.push(e),t?.length&&Te.push(t.map(Se=>`${Se.value} ${Se.label}`).join(" | ")),Te.push("#MindCoreFitness"),Te.join(`
`)},[s,e,t]),D=_.useCallback(async()=>{if(!(G||!u))try{await u({type:y==="habits"?"habits_summary":"workout_summary",title:s||"Workout Complete!",subtitle:e,stats:t||[],quote:Qe.current}),fe(!0),be("Posted to Journey!"),setTimeout(()=>be(null),2500)}catch(Te){console.error("Journey post failed:",Te),be(Te?.message||"Failed to post"),setTimeout(()=>be(null),3500)}},[G,u,s,e,t]),[ne,ve]=_.useState(!1),Ee=_.useCallback(async()=>{ve(!0);try{const Te=await h3({type:y||"workout",title:s||"Workout Complete!",subtitle:e,stats:t||[],quote:Qe.current,userName:h}),Se=se();if(navigator.share&&navigator.canShare?.({files:[new File([Te],"workout.png",{type:"image/png"})]})){const Ke=new File([Te],"workout.png",{type:"image/png"});await navigator.share({title:"Mind Core Fitness",text:Se,files:[Ke]})}else navigator.share?await navigator.share({title:"Mind Core Fitness",text:Se}):(await navigator.clipboard.writeText(Se),be("Copied to clipboard!"),setTimeout(()=>be(null),2500))}catch{try{await navigator.clipboard.writeText(se()),be("Copied to clipboard!"),setTimeout(()=>be(null),2500)}catch{}}finally{ve(!1)}},[s,e,t,h,se]);return k==="hold"?a.jsxs("div",{className:"wc-hold-page",children:[a.jsx("div",{className:"wc-hold-glow","aria-hidden":"true"}),a.jsx("p",{className:"wc-hold-label",children:g}),a.jsxs("div",{className:`wc-hold-ring-touch ${O?"wc-holding":""}`,onPointerDown:Te=>{Te.preventDefault(),ue()},onPointerUp:Ce,onPointerLeave:Ce,onPointerCancel:Ce,onClick:Te=>{Te.stopPropagation(),A.current&&(A.current=!1)},role:"button",tabIndex:0,"aria-label":"Press and hold to finish workout",onKeyDown:Te=>{(Te.key==="Enter"||Te.key===" ")&&(Te.preventDefault(),j.complete(),E("celebrate"))},children:[a.jsx("div",{className:"wc-hold-ring-glow","aria-hidden":"true"}),a.jsxs("svg",{className:"wc-hold-ring-svg",viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"wc-hold-ring-track",cx:"50",cy:"50",r:Fg}),a.jsx("circle",{className:"wc-hold-ring-fill",ref:T,cx:"50",cy:"50",r:Fg,style:{strokeDasharray:Nl,strokeDashoffset:Nl}})]}),a.jsx("img",{ref:R,src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-hold-logo",draggable:!1})]})]}):a.jsxs("div",{className:`wc-celeb-overlay ${K?"wc-celeb-dismissing":""}`,children:[a.jsx("div",{className:"wc-celeb-confetti","aria-hidden":"true",children:Z.current.map((Te,Se)=>a.jsx("span",{className:`wc-celeb-confetti-piece wc-confetti-shape-${Te.shape}`,style:{"--x":`${Te.x}%`,"--delay":`${Te.delay}s`,"--color":Te.color,"--drift":`${Te.drift}px`,"--spin":`${Te.spin}deg`,"--duration":`${Te.duration}s`,width:`${Te.width}px`,height:`${Te.height}px`}},Se))}),a.jsxs("div",{className:"wc-celeb-content",children:[a.jsx("div",{className:"wc-celeb-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-celeb-logo-img"})}),a.jsx("h2",{className:"wc-celeb-heading",children:s||"Congratulations!"}),e&&a.jsx("p",{className:"wc-celeb-subtext",children:e}),a.jsx("p",{className:"wc-celeb-quote",children:Qe.current}),t&&t.length>0&&a.jsx("div",{className:"wc-celeb-stats-row",children:t.map((Te,Se)=>a.jsxs("div",{className:"wc-celeb-stat",children:[a.jsx("span",{className:"wc-celeb-stat-val",children:Te.value}),a.jsx("span",{className:"wc-celeb-stat-label",children:Te.label})]},Se))}),!b&&a.jsxs("div",{className:"wc-share-row",children:[u&&a.jsxs("button",{className:`wc-share-btn wc-share-journey ${G?"wc-share-done":""}`,onClick:D,disabled:G,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 20h9"}),a.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4Z"})]}),G?"Posted!":"Post to Journey"]}),a.jsxs("button",{className:"wc-share-btn wc-share-external",onClick:Ee,disabled:ne,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"18",cy:"5",r:"3"}),a.jsx("circle",{cx:"6",cy:"12",r:"3"}),a.jsx("circle",{cx:"18",cy:"19",r:"3"}),a.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),a.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),ne?"Generating...":"Share"]})]}),a.jsx("button",{className:"wc-celeb-btn",onClick:Pe,children:p}),xe&&a.jsx("div",{className:"wc-share-toast",children:xe})]})]})}const $w="/login/assets/randomiser-glq9YJkL.jpg",Ww="/login/assets/programme-card-workout-CnNzTYkz.webp",g3="/login/assets/prog-fullbody-4wk-r6m9HJys.jpg",y3="/login/assets/muscle-group-arms-C9AdZL4-.png",v3="/login/assets/arms-bicep-BUrmT1o-.png",b3="/login/assets/arms-tricep-D9tAnFnS.png",w3="/login/assets/arms-full-arms-BY3TvpJm.png",_3="/login/assets/muscle-group-chest-Cxfuc7XI.png",x3="/login/assets/chest-strength-BR4BAFTH.png",k3="/login/assets/chest-hypertrophy-B8yNrvjB.png",E3="/login/assets/chest-endurance-e-OSWtWO.png",T3="/login/assets/muscle-group-shoulders-DibNtCLF.png",S3="/login/assets/shoulders-strength-CKlZBF5A.png",j3="/login/assets/shoulders-hypertrophy-BUd76jiS.png",C3="/login/assets/shoulders-endurance-HuqNG5rD.png",N3="/login/assets/muscle-group-core-CPR-bdRg.png",A3="/login/assets/core-lower-abs-TVcqGMFJ.png",R3="/login/assets/core-obliques-rotation-Djb7Qlbk.png",I3="/login/assets/core-weighted-core-4Kwh9mTv.png",D3="/login/assets/muscle-group-back-8JPV-YUo.png",M3="/login/assets/back-strength-BmSRxnwo.png",L3="/login/assets/back-hypertrophy-CXHmsnCz.png",O3="/login/assets/back-endurance-C8qJ8l5I.png",P3="/login/assets/muscle-group-legs-B8jcbdov.png",V3="/login/assets/legs-quads-DbnfsebI.png",U3="/login/assets/legs-hamstrings-glutes-BrfsvvzX.png",B3="/login/assets/legs-power-plyo-D2qBXeUR.png",z3=60,Xp=5,F3={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},q3={fullbody:"linear-gradient(160deg, rgba(153,49,60,0.15) 0%, rgba(153,49,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",upper:"linear-gradient(160deg, rgba(100,60,140,0.2) 0%, rgba(100,60,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",lower:"linear-gradient(160deg, rgba(40,120,80,0.2) 0%, rgba(40,120,80,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)"},Jp={arms:"linear-gradient(160deg, rgba(180,60,60,0.2) 0%, rgba(180,60,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",chest:"linear-gradient(160deg, rgba(50,100,160,0.2) 0%, rgba(50,100,160,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",back:"linear-gradient(160deg, rgba(80,130,60,0.2) 0%, rgba(80,130,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",shoulders:"linear-gradient(160deg, rgba(160,100,40,0.2) 0%, rgba(160,100,40,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",legs:"linear-gradient(160deg, rgba(100,50,140,0.2) 0%, rgba(100,50,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)"},Zp=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,level:"All Levels",daysPerWeek:3,image:g3},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,level:"Intermediate",daysPerWeek:3},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,level:"Advanced",daysPerWeek:3},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,level:"Beginner",daysPerWeek:3},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,level:"Intermediate",daysPerWeek:3},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,level:"Advanced",daysPerWeek:3},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,level:"Intermediate",daysPerWeek:3},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,level:"Intermediate",daysPerWeek:3}],Qc=[{key:"arms",label:"Arms",icon:"M7 5h2v14H7V5zm8 0h2v14h-2V5zm-5 4h4v6h-4V9z",image:y3},{key:"chest",label:"Chest",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15H9v-2h2v2zm4 0h-2v-2h2v2zm3-6c0 1.1-.36 2.12-.97 2.95l-.87-.87C16.7 12.53 17 11.8 17 11c0-2.76-2.24-5-5-5S7 8.24 7 11c0 .8.3 1.53.84 2.08l-.87.87A4.977 4.977 0 0 1 6 11c0-3.31 2.69-6 6-6s6 2.69 6 6z",image:_3},{key:"back",label:"Back",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm4 18H8v-6l-4-4 1.41-1.41L8 11.17V8h8v3.17l2.59-2.58L20 10l-4 4v6z",image:D3},{key:"shoulders",label:"Shoulders",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z",image:T3},{key:"legs",label:"Legs",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z",image:P3},{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z",image:N3}],Gw={chest:[{id:"chest_strength",name:"Chest Strength",desc:"Heavy pressing for max strength",image:x3,level:"Intermediate",overview:"A heavy pressing session designed to build raw chest strength. Focus on controlled negatives and powerful pressing movements.",tips:["Go heavy  pick a weight where the last 2 reps are a real challenge","Control the negative (lowering phase) for 2-3 seconds","Keep your shoulder blades squeezed together throughout all pressing movements","Rest 90-120 seconds between sets to allow full recovery"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Squeeze Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"chest_hypertrophy",name:"Chest Hypertrophy",desc:"Volume training for muscle growth",image:k3,level:"Intermediate",overview:"A high-volume chest session focused on time under tension and muscle growth. Lighter weights, more reps, and slow controlled movements.",tips:["Use moderate weight  you should feel the burn by rep 10","Squeeze your chest at the top of every rep for 1 second","Keep rest periods short at 60-90 seconds to keep the pump going","On press ups, go to failure on the final set"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Press Up",type:"reps",sets:3,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"}]},{id:"chest_endurance",name:"Chest Endurance",desc:"Bodyweight pushing to failure",image:E3,level:"All Levels",overview:"No weights needed. This bodyweight-only session builds chest endurance and muscular stamina through high-rep push up variations.",tips:["Focus on full range of motion  chest to floor on every rep","Keep your core tight and body in a straight line throughout","Scale down to knee press ups if you can't maintain form","Push through the burn  the last 5 reps are where the growth happens"],exercises:[{name:"Press Up",type:"reps",sets:4,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null},{name:"Decline Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Press Up Hold",type:"timed",sets:3,time:30,storagePath:null}]}],back:[{id:"back_strength",name:"Back Strength",desc:"Heavy rows for a thick back",image:M3,level:"Intermediate",overview:"Build a thick, powerful back with heavy rowing movements. This session targets your lats, rhomboids, and traps for overall back development.",tips:["Go heavy on rows  use a weight that challenges you by rep 6-8","Drive your elbows back and squeeze your shoulder blades together at the top","Keep a slight bend in your knees and hinge at the hips for bent over movements","Rest 90-120 seconds between sets for full recovery"],exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"back_hypertrophy",name:"Back Hypertrophy",desc:"Width and thickness volume work",image:L3,level:"Intermediate",overview:"A volume-focused back session combining rows and isolation moves to build width and thickness. Focus on the mind-muscle connection.",tips:["Use moderate weight  feel the stretch and squeeze on every rep","On renegade rows, keep your hips square to the floor and avoid rotating","For reverse flys, use lighter weight and focus on squeezing your rear delts","Keep rest to 60-90 seconds to maintain intensity"],exercises:[{name:"Renegade Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Reverse Fly",type:"weighted",sets:3,reps:15,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null}]},{id:"back_endurance",name:"Back Endurance",desc:"Bodyweight back conditioning",image:O3,level:"All Levels",overview:"A bodyweight session to strengthen your posterior chain and improve posture. Great for back health, mobility, and muscular endurance.",tips:["On superman holds, lift your arms and legs simultaneously and hold tight","Focus on slow, controlled movements  quality over speed","Breathe steadily throughout timed holds  don't hold your breath","Engage your glutes and lower back together on every movement"],exercises:[{name:"Superman Hold",type:"timed",sets:4,time:30,storagePath:"exercises/bodyweight/upper/Superman Hold.mp4"},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:12,storagePath:null},{name:"Reverse Snow Angel",type:"reps",sets:3,reps:12,storagePath:null},{name:"Bird Dog",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Back Extension Hold",type:"timed",sets:3,time:30,storagePath:null}]}],shoulders:[{id:"shoulders_strength",name:"Shoulder Strength",desc:"Heavy pressing for boulder shoulders",image:S3,level:"Intermediate",overview:"A heavy overhead pressing session to build strong, powerful shoulders. Compound movements first, followed by isolation work for all three delt heads.",tips:["Go heavy on presses  pick a weight where you struggle on the last 2 reps","Brace your core and avoid arching your back during overhead movements","Press straight up and control the weight down slowly","Rest 90-120 seconds between pressing sets, 60 seconds for isolation moves"],exercises:[{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"shoulders_hypertrophy",name:"Shoulder Hypertrophy",desc:"Volume and isolation for 3D delts",image:j3,level:"Intermediate",overview:"A high-volume session targeting all three heads of the deltoid for that 3D capped shoulder look. Moderate weight, high reps, constant tension.",tips:["Use lighter weight than you think  shoulders respond best to high reps","On lateral raises, lead with your elbows and don't swing the weight","Pause at the top of each raise for a 1-second squeeze","Keep rest periods at 60 seconds to maximise the pump"],exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Y-Raise",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"shoulders_endurance",name:"Shoulder Endurance",desc:"Bodyweight and high-rep work",image:C3,level:"All Levels",overview:"A shoulder endurance session combining bodyweight movements with high-rep dumbbell work. Builds stamina, stability, and shoulder resilience.",tips:["On pike push ups, walk your feet close to your hands to increase the angle","For high-rep lateral raises, use a very light weight and focus on form","Wall walks are advanced  scale to pike push ups if needed","Keep your core braced throughout to protect your lower back"],exercises:[{name:"Pike Push Ups",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/upper/pike push ups.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,reps:20,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Wall Walks",type:"reps",sets:3,reps:6,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null},{name:"Shoulder Tap Hold",type:"timed",sets:3,time:30,storagePath:null}]}],arms:[{id:"arms_bicep",name:"Bicep Focus",desc:"Curl variations for peak biceps",image:v3,level:"All Levels",overview:"An arm session dedicated entirely to biceps. Multiple curl variations target different parts of the bicep for maximum peak and thickness.",tips:["Keep your elbows pinned to your sides  no swinging","Control the negative (lowering) for 2-3 seconds on every rep","Start with your heaviest weight and decrease as you fatigue","Squeeze hard at the top of each curl for a full contraction"],exercises:[{name:"Bicep Curl",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Concentration Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Isometric Bicep Hold",type:"timed",sets:3,time:20,storagePath:null}]},{id:"arms_tricep",name:"Tricep Focus",desc:"Extensions and dips for horseshoe triceps",image:b3,level:"All Levels",overview:"All-out tricep training with extensions, dips, and pressing movements. The triceps make up two-thirds of your arm  this session builds serious size.",tips:["On overhead extensions, keep your elbows close to your head","For skullcrushers, lower the weight slowly to just above your forehead","On dips, lean slightly forward to reduce shoulder strain","Full lockout at the top of every extension for maximum tricep contraction"],exercises:[{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Tricep Dips",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null}]},{id:"arms_full",name:"Full Arms",desc:"Superset biceps and triceps",image:w3,level:"All Levels",overview:"A balanced arm session alternating between biceps and triceps. Superset style keeps the intensity high and maximises the pump.",tips:["Superset each pair  do biceps then immediately hit triceps","Use moderate weight that lets you maintain strict form for all reps","Rest 60 seconds after each superset pair","Focus on the squeeze at the peak contraction of every rep"],exercises:[{name:"Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Wrist Curl",type:"weighted",sets:3,reps:15,storagePath:null}]}],legs:[{id:"legs_quad",name:"Quad Dominant",desc:"Squats and lunges for quad power",image:V3,level:"All Levels",overview:"A quad-focused leg session built around squats and lunges. Heavy compound movements to build strong, powerful quads and overall leg strength.",tips:["On goblet squats, hold the dumbbell close to your chest and sit deep","Keep your knees tracking over your toes  don't let them cave inward","Drive through your heels on all squatting movements","Rest 90-120 seconds between heavy sets, 60 seconds on bodyweight moves"],exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/lower/bulgarian split squats.mp4"},{name:"Squat And Hold",type:"timed",sets:3,time:30,storagePath:"exercises/bodyweight/lower/squat and hold.mp4"}]},{id:"legs_ham_glute",name:"Hamstring & Glute",desc:"Posterior chain focus",image:U3,level:"Intermediate",overview:"Target the back of your legs with deadlift and hip hinge variations. This session builds a strong posterior chain  hamstrings, glutes, and lower back.",tips:["On RDLs, push your hips back and feel the stretch in your hamstrings","Keep a slight bend in your knees throughout hip hinge movements","Squeeze your glutes hard at the top of every rep","For single leg work, start with your weaker side first"],exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/romanian deadlifts.mp4"},{name:"1 Legged RDL",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.mp4"},{name:"Hip Thrusts",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/hip thrusts.mp4"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.mp4"},{name:"Donkey Kicks",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.mp4"}]},{id:"legs_power",name:"Power & Plyo",desc:"Explosive leg training",image:B3,level:"Intermediate",overview:"An explosive leg session combining plyometrics with weighted movements. Build power, speed, and athletic performance.",tips:["On jump squats, land softly with bent knees to absorb the impact","Explode up on every rep  power comes from speed, not just weight","Keep rest periods at 60-90 seconds to maintain intensity","Focus on landing mechanics  knees out, chest up, soft landing"],exercises:[{name:"Jump Squats",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/lower/jump squats.mp4"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Skater Jumps",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/skater jumps.mp4"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.mp4"}]}],core:[{id:"core_lower_abs",name:"Lower Abs Blast",desc:"40s work / 20s rest  3 rounds",image:A3,level:"Intermediate",overview:"An interval-based core burner targeting the lower abdominals. 40 seconds of work followed by 20 seconds of rest  keep the intensity high and your lower back pressed into the floor throughout.",tips:["Press your lower back firmly into the floor on every rep","Exhale hard as you contract your abs  don't hold your breath","If your lower back lifts off the ground, reduce the range of motion","Focus on slow, controlled movements rather than speed"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Leg Raises",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Reverse Crunch To Leg Raise",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Flutter Kicks",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Dead Bug Single Leg Drop",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Hollow Hold Flutter Kicks",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"}]},{id:"core_obliques",name:"Obliques & Rotation",desc:"35s work / 25s rest  3 rounds",image:R3,level:"Intermediate",overview:"Target the obliques and rotational core muscles with this interval session. 35 seconds of work with 25 seconds rest  every exercise involves twisting, rotating, or side-bracing movements.",tips:["Rotate from your ribcage, not just your arms","Keep your hips as still as possible during twisting exercises","Brace your core before each movement  think about squeezing a belt","On side planks, stack your hips and push the floor away"],interval:!0,rounds:3,work:35,rest:25,exercises:[{name:"Russian Twist",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank Rotation",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Cross Body Mountain Climbers",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Hip Dips Plank",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Bicycle Crunch",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank",storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{id:"core_weighted",name:"Weighted Core",desc:"40s work / 20s rest  3 rounds",image:I3,level:"Advanced",overview:"Add resistance to your core training with dumbbells and kettlebells. 40 seconds of weighted work followed by 20 seconds rest  this session builds serious core strength and stability.",tips:["Start with a moderate weight  form is more important than load","Brace your entire core before picking up the weight each round","Keep movements controlled  no swinging or using momentum","If grip fails before core does, go slightly lighter next time"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Russian Twists Dumbbell",storagePath:"exercises/dumbbells/core/russian twists dumbbell.mp4"},{name:"Kettlebell Russian Twist",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Dumbbell Plank Pull Through",storagePath:null}]}]},eg=[{key:"bodyweight",label:"Bodyweight",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"},{key:"dumbbells",label:"Dumbbells",icon:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"},{key:"kettlebells",label:"Kettlebells",icon:"M12 2C9.24 2 7 4.24 7 7c0 1.1.36 2.12.97 2.95C6.76 11.08 6 12.96 6 15c0 3.87 2.69 7 6 7s6-3.13 6-7c0-2.04-.76-3.92-1.97-5.05.61-.83.97-1.85.97-2.95 0-2.76-2.24-5-5-5zm0 2c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"}],Wr=[{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"},{key:"upper",label:"Upper",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"lower",label:"Lower",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"fullbody",label:"Full Body",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z"},{key:"mix",label:"Mix It Up",icon:"M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm-.83 9.41l-1.42 1.42L17.96 20.54l1.42-1.42-5.71-5.71z"}],xi=[{key:"beginner",label:"Beginner",work:30,rest:30,desc:"30s work / 30s rest"},{key:"intermediate",label:"Intermediate",work:40,rest:20,desc:"40s work / 20s rest"},{key:"advanced",label:"Advanced",work:40,rest:15,desc:"40s work / 15s rest"}],tg=[5,10,15,20,30],dd={core:"#e85d04",upper:"#2196f3",lower:"#4caf50",fullbody:"#9c27b0",mix:"#ff9800"},Kw=["Mix up your focus areas to build balanced strength.","Consistency beats intensity  show up and press play.","Try a new difficulty level to keep your body guessing.","Short on time? A 5-minute blast still counts.","Save your favourite combos so you can replay them anytime.","Your body adapts  switch equipment for fresh stimulus.","Rest days are growth days. Listen to your body.","Challenge yourself: go one level higher this week."];function H3(s){return s.replace(/\b\w/g,e=>e.toUpperCase())}function $3(s){const e=[...s];for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return e}function W3(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Xr(),{isDark:l,toggleTheme:u,accent:h}=fa(),{isPremium:p,FREE_RANDOMISER_DURATIONS:g,FREE_RANDOMISER_WEEKLY_LIMIT:y}=rc(),b=ir(),[k,E]=_.useState("randomiser_hub"),[O,H]=_.useState(["bodyweight"]),[q,B]=_.useState("core"),[K,$]=_.useState("intermediate"),[G,fe]=_.useState(p?15:5),[xe,be]=_.useState([]),[j,T]=_.useState(!1),R=_.useRef(!1),P=_.useRef([]),[M,L]=_.useState([]),[A,Ve]=_.useState(2),[Qe,Z]=_.useState(xi[1]),[ue,Ce]=_.useState(1),[Pe,se]=_.useState(0),[D,ne]=_.useState("work"),[ve,Ee]=_.useState(0),[Te,Se]=_.useState(!1),[Ke,ct]=_.useState(0),[Be,sn]=_.useState(!1),[Nn,Un]=_.useState(!1),[Ot,rt]=_.useState(null),gt=_.useRef(null);_.useRef(null),_.useRef(null);const[ut,Bn]=_.useState(null),he=_.useCallback((V,X="info")=>{Bn({message:V,type:X}),setTimeout(()=>Bn(null),3e3)},[]),Dt=_.useCallback(async V=>{if(!t)throw new Error("Not signed in");const X=V&&typeof V=="object"&&V.type;await Kr(wt(_e,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:X?"":V,type:X?V.type:"text",imageURL:null,createdAt:er(),likeCount:0,commentCount:0,...X?{metadata:{title:V.title||"",subtitle:V.subtitle||"",stats:V.stats||[],quote:V.quote||"",badges:V.badges||[]}}:{}})},[t]),[yt,Bt]=_.useState(null),[et,It]=_.useState(null),[vt,rn]=_.useState(0),[Cs,rs]=_.useState(0),[Jt,re]=_.useState([]),[Ae,kt]=_.useState(""),[bt,it]=_.useState(""),[$e,st]=_.useState(!1),[Fe,an]=_.useState(0),[un,Ln]=_.useState(!1),[zn,Xn]=_.useState({}),Qt=_.useRef(null),Fn=_.useRef(null),[An,hn]=_.useState(0),[yr,oe]=_.useState(0),[Re,Ge]=_.useState(0),[mt,lt]=_.useState(0),[_n,Rn]=_.useState(0),[pn,xn]=_.useState(0),[Ns,is]=_.useState({beginner:0,intermediate:0,advanced:0}),ds=p?tg:tg.filter(V=>g.includes(V)),Zt=!p&&An>=y,[In,As]=_.useState([]),[Ar,fi]=_.useState(!1),[Rr,Ir]=_.useState({}),[qn,Ys]=_.useState(!1),[_s,Sn]=_.useState(!1),[On,as]=_.useState(""),[qt,Jr]=_.useState(null),[Dr,xs]=_.useState([]),[vn,ar]=_.useState({total:0,favouriteFocus:null,streak:0}),[mi,I]=_.useState(null),[z,ae]=_.useState(""),[le,Me]=_.useState(!1);_.useEffect(()=>{!i&&(!s||!e)&&b("/")},[s,e,i,b]),_.useEffect(()=>{if(!s||!t)return;(async()=>{try{const X=wt(_e,"workoutLogs"),ee=cn(X,At("clientId","==",t.id)),je=(await nn(ee)).docs.map(jt=>jt.data()),Oe=je.filter(jt=>jt.type!=="programme");lt(Oe.length);const qe=Oe.reduce((jt,dn)=>jt+(dn.duration||0),0);Rn(qe);const pt={beginner:0,intermediate:0,advanced:0};Oe.forEach(jt=>{jt.level&&pt[jt.level]!==void 0&&pt[jt.level]++}),is(pt);const Et=new Date,Ut=Et.getDay(),Xe=Ut===0?-6:1-Ut,en=new Date(Et);en.setDate(Et.getDate()+Xe),en.setHours(0,0,0,0);const Bs=en.getTime(),Tt=je.filter(jt=>{const dn=jt.completedAt;return dn?(dn.toDate?dn.toDate().getTime():new Date(dn).getTime())>=Bs:!1});hn(Tt.filter(jt=>jt.type!=="programme").length);let Hn=0;if(t)try{const jt=await pr(Ze(_e,"clientProgrammes",t.id));if(jt.exists()){const dn=jt.data(),Dn=dn.templateId;Hn=Tt.filter(fs=>fs.type==="programme"&&fs.programmeId===Dn).length,I(Dn);const zs=Zp.find(fs=>fs.id===Dn);zs&&ae(zs.name);const Fs=F3[Dn];if(Fs){const fs=Object.keys(dn.completedSessions||{}).length,Qs=Fs.duration*Fs.daysPerWeek;Ge(Qs>0?Math.round(fs/Qs*100):0)}}else I(null),ae(""),Ge(0)}catch{}oe(Hn);const Jn=Oe.map(jt=>jt.completedAt).filter(Boolean).map(jt=>jt.toDate?jt.toDate().getTime():new Date(jt).getTime()).sort((jt,dn)=>dn-jt);if(Jn.length===0)xn(0);else{const jt=new Set;Jn.forEach(Qs=>{const or=new Date(Qs),Mi=or.getDay(),Or=Mi===0?-6:1-Mi,pi=new Date(or);pi.setDate(or.getDate()+Or),pi.setHours(0,0,0,0),jt.add(pi.getTime())});const dn=[...jt].sort((Qs,or)=>or-Qs);let Dn=0;const zs=new Date(Et),Fs=Et.getDay()===0?-6:1-Et.getDay();zs.setDate(Et.getDate()+Fs),zs.setHours(0,0,0,0);let fs=zs.getTime();dn.includes(fs)||(fs-=10080*60*1e3);for(let Qs=0;Qs<200&&dn.includes(fs);Qs++)Dn++,fs-=10080*60*1e3;xn(Dn)}}catch(X){console.error("Error loading workout stats:",X)}finally{Me(!0)}})()},[s,t,k]),_.useEffect(()=>{if(!s||!t)return;(async()=>{try{const X=cn(wt(_e,"savedWorkouts"),At("clientId","==",t.id)),ge=(await nn(X)).docs.map(je=>({id:je.id,...je.data()}));ge.sort((je,Oe)=>{const qe=je.savedAt?.toMillis?.()||je.savedAt?.seconds*1e3||0;return(Oe.savedAt?.toMillis?.()||Oe.savedAt?.seconds*1e3||0)-qe}),As(ge)}catch(X){console.error("Error loading saved workouts:",X)}finally{fi(!0)}})()},[s,t]),_.useEffect(()=>{if(!s||!t)return;(async()=>{try{const X=cn(wt(_e,"workoutLogs"),At("clientId","==",t.id),_u("completedAt","desc"),xu(20)),je=(await nn(X)).docs.map(Tt=>Tt.data()).filter(Tt=>Tt.type!=="programme"&&Tt.type!=="muscle_group");xs(je.slice(0,3));const Oe=je.length,qe={};je.forEach(Tt=>{Tt.focus&&(qe[Tt.focus]=(qe[Tt.focus]||0)+1)});const pt=Object.keys(qe).sort((Tt,Hn)=>qe[Hn]-qe[Tt])[0]||null;let Et=0;if(je.length>0){const Tt=new Set;je.forEach(jt=>{const dn=jt.completedAt?.toDate?jt.completedAt.toDate():jt.completedAt?new Date(jt.completedAt):null;dn&&Tt.add(new Date(dn.getFullYear(),dn.getMonth(),dn.getDate()).toDateString())});const Hn=new Date;Hn.setHours(0,0,0,0);let Jn=new Date(Hn);for(Tt.has(Jn.toDateString())||Jn.setDate(Jn.getDate()-1);Tt.has(Jn.toDateString());)Et++,Jn.setDate(Jn.getDate()-1)}ar({total:Oe,favouriteFocus:pt,streak:Et});const Ut={core:null,upper:null,lower:null,fullbody:null};je.forEach(Tt=>{if(Tt.focus&&Ut[Tt.focus]===null&&Tt.completedAt){const Hn=Tt.completedAt.toDate?Tt.completedAt.toDate():new Date(Tt.completedAt);Ut[Tt.focus]=Hn}});let Xe=null,en=new Date;const Bs=["core","upper","lower","fullbody"];for(const Tt of Bs){if(Ut[Tt]===null){const Hn=Wr.find(Jn=>Jn.key===Tt)?.label||Tt;Xe={focus:Tt,label:Hn,daysAgo:null,message:`You haven't tried ${Hn} yet`};break}if(Ut[Tt]<en){en=Ut[Tt];const Hn=Math.floor((Date.now()-Ut[Tt].getTime())/864e5);if(Hn>=5){const Jn=Wr.find(jt=>jt.key===Tt)?.label||Tt;Xe={focus:Tt,label:Jn,daysAgo:Hn,message:`${Jn}  ${Hn} days ago`}}}}Jr(Xe)}catch(X){console.error("Error loading recent workouts:",X)}})()},[s,t,k]);const Le=async V=>{if(!(!s||!t||M.length===0)){Ys(!0);try{const X=Wr.find(je=>je.key===q)?.label||q,ee=V||`${X} ${G}min`,ge=await Kr(wt(_e,"savedWorkouts"),{clientId:t.id,name:ee,equipment:O,focus:q,level:K,duration:G,exercises:M.map(je=>({name:je.name,videoUrl:je.videoUrl,isGif:je.isGif||!1})),rounds:A,savedAt:Vt.now()});As(je=>[{id:ge.id,clientId:t.id,name:ee,equipment:O,focus:q,level:K,duration:G,exercises:M.map(Oe=>({name:Oe.name,videoUrl:Oe.videoUrl,isGif:Oe.isGif||!1})),rounds:A,savedAt:Vt.now()},...je]),he("Workout saved!","success")}catch(X){console.error("Error saving workout:",X),he("Failed to save workout","error")}finally{Ys(!1),Sn(!1),as("")}}},He=async V=>{try{await jr(Ze(_e,"savedWorkouts",V)),As(X=>X.filter(ee=>ee.id!==V)),he("Workout removed","info")}catch(X){console.error("Error deleting saved workout:",X),he("Failed to remove workout","error")}},Ht=V=>{H(V.equipment||["bodyweight"]),B(V.focus||"core"),$(V.level||"intermediate"),fe(V.duration||15);const X=xi.find(ee=>ee.key===(V.level||"intermediate"));Z(X),L(V.exercises||[]),Ve(V.rounds||2),E("preview")},Ye=async()=>{const V=JSON.parse(localStorage.getItem("mcf_last_randomiser")||"null");H(V?.equipment||["bodyweight"]),B(V?.focus||"core"),$(V?.level||"intermediate"),fe(V?.duration||15),setTimeout(()=>Yn(),50)},Kn=()=>{localStorage.setItem("mcf_last_randomiser",JSON.stringify({equipment:O,focus:q,level:K,duration:G}))};localStorage.getItem("mcf_last_randomiser");const os=()=>{const V=[];let X;q==="mix"?X=["core","upper","lower"]:q==="fullbody"?X=["upper","lower"]:X=[q];for(const ee of O)for(const ge of X)V.push(`exercises/${ee}/${ge}`);return V},Us=async()=>{if(R.current){for(;R.current;)await new Promise(V=>setTimeout(V,200));return P.current}R.current=!0,T(!0);try{const V=os(),X=[];for(const Oe of V)try{const qe=Wa(Ga,Oe),pt=await Bw(qe);X.push(...pt.items)}catch{console.warn(`Folder ${Oe} not found, skipping.`)}if(X.length===0&&O.includes("bodyweight")&&q==="core")try{const Oe=Wa(Ga,"core"),qe=await Bw(Oe);X.push(...qe.items)}catch{console.warn("Legacy core/ folder not found either.")}if(X.length===0){const Oe=O.map(pt=>eg.find(Et=>Et.key===pt)?.label).join(" + "),qe=Wr.find(pt=>pt.key===q)?.label;return he(`No exercises found for ${Oe} / ${qe}. Upload videos to Firebase Storage.`,"error"),R.current=!1,T(!1),[]}const ee=new Set,ge=X.filter(Oe=>{const qe=Oe.name.replace(/\.(mp4|gif)$/i,"");return ee.has(qe)?!1:(ee.add(qe),!0)}),je=await Promise.all(ge.map(async Oe=>{const qe=await Lo(Oe),pt=H3(Oe.name.replace(/\.(mp4|gif)$/i,"")),Et=/\.gif$/i.test(Oe.name);return{name:pt,videoUrl:qe,isGif:Et}}));return P.current=je,be(je),R.current=!1,T(!1),je}catch(V){console.error("Error loading exercises:",V);const X=V.code==="storage/unauthorized"?"Storage access denied. Check Firebase Storage rules allow read access.":`Failed to load exercises: ${V.message||V.code||"Unknown error"}`;return he(X,"error"),R.current=!1,T(!1),[]}},Yn=async()=>{if(Zt)return;Kn(),E("spinning"),P.current=[];const V=await Us();if(V.length===0){E("setup");return}const X=xi.find(Ut=>Ut.key===K);Z(X);const ee=X.work+X.rest,ge=G*60,je=Math.floor(ge/ee);let Oe,qe;je<=6?(Oe=Math.max(3,Math.floor(je/2)),qe=Math.floor(je/Oe)):je<=12?(Oe=Math.min(6,Math.floor(je/2)),qe=Math.floor(je/Oe)):(Oe=Math.min(10,Math.floor(je/2)),qe=Math.floor(je/Oe)),qe=Math.max(2,qe);const pt=$3(V),Et=pt.slice(0,Math.min(Oe,pt.length));L(Et),Ve(qe),setTimeout(()=>E("preview"),2e3)},vr=()=>{E("countdown"),ct(3)};_.useEffect(()=>{if(k!=="countdown")return;if(Ke<=0){E("workout"),Ce(1),se(0),ne("work"),Ee(Qe.work),Se(!1),ht();return}Ue();const V=setTimeout(()=>ct(X=>X-1),1e3);return()=>clearTimeout(V)},[Ke,k]),_.useEffect(()=>{if(k!=="workout"||Te)return;if(ve<=0){ma();return}ve<=3&&Ue();const V=setTimeout(()=>Ee(X=>X-1),1e3);return()=>clearTimeout(V)},[ve,k,Te]);const ma=()=>{if(D==="work")ne("rest"),Ee(Qe.rest);else{const V=Pe+1;if(V>=M.length){const X=ue+1;if(X>A){sn(!0),Di();return}Ce(X),se(0)}else se(V);ne("work"),Ee(Qe.work),ht()}},Di=async()=>{if(s)try{await Kr(wt(_e,"workoutLogs"),{clientId:t.id,level:K,duration:G,equipment:O,focus:q,exerciseCount:M.length,rounds:A,exercises:M.map(V=>V.name),completedAt:Vt.now()}),typeof fbq=="function"&&fbq("trackCustom","WorkoutCompleted",{duration:G,level:K,focus_area:q,exercise_count:M.length}),hn(V=>V+1),lt(V=>V+1),Rn(V=>V+G),is(V=>({...V,[K]:(V[K]||0)+1}))}catch(V){console.error("Error saving workout log:",V)}},Mr=async(V,X,ee)=>{if(!(!t||!X))try{const ge=t.id,je=await pr(Ze(_e,"coreBuddyPBs",ge)),qe=(je.exists()?je.data():null)?.exercises||{},pt=qe[V];let Et=!1;if(pt?(X>(pt.weight||0)||X===(pt.weight||0)&&ee>(pt.reps||0))&&(Et=!0):Et=!0,Et){const Ut={...qe,[V]:{weight:X,reps:ee,achievedAt:Vt.now()}};await Ps(Ze(_e,"coreBuddyPBs",ge),{clientId:t.id,exercises:Ut,updatedAt:Vt.now()}),he(`New PB! ${X}kg  ${ee} reps`,"success"),Ue()}}catch(ge){console.error("Error checking PB:",ge)}},pa=async V=>{if(It(V),V.interval){const ge=[];for(const je of V.exercises){let Oe=null,qe=!1;if(je.storagePath)try{const pt=Wa(Ga,je.storagePath);Oe=await Lo(pt),qe=/\.gif$/i.test(je.storagePath)}catch{}ge.push({name:je.name,videoUrl:Oe,isGif:qe})}L(ge),Ve(V.rounds),Z({work:V.work,rest:V.rest}),E("preview");return}const X={};for(const ge of V.exercises)if(ge.storagePath)try{const je=Wa(Ga,ge.storagePath);X[ge.name]={url:await Lo(je),isGif:/\.gif$/i.test(ge.storagePath)}}catch{}Xn(X);const ee=V.exercises.map(ge=>({name:ge.name,type:ge.type,targetSets:ge.sets,targetReps:ge.reps||0,targetTime:ge.time||0,sets:[]}));re(ee),rn(0),rs(0),kt(""),it(""),Ln(!1),st(!1),an(0),setMgSessionBadges([]),setMgBadgeCelebration(null),E("muscle_workout")},Lr=()=>{const V=Qt.current;V&&(V.paused?(V.play(),Ln(!0)):(V.pause(),Ln(!1)))};_.useEffect(()=>{if(k!=="muscle_workout"||!$e||Fe<=0){k==="muscle_workout"&&$e&&Fe<=0&&(st(!1),Ue());return}return Fn.current=setTimeout(()=>an(V=>V-1),1e3),()=>clearTimeout(Fn.current)},[k,$e,Fe]);const C=async()=>{const V=Jt[vt];let X={};if(V.type==="weighted"){const je=parseFloat(Ae)||0,Oe=parseInt(bt)||0;if(Oe===0){he("Enter your reps","error");return}X={weight:je,reps:Oe}}else if(V.type==="reps"){const je=parseInt(bt)||0;if(je===0){he("Enter your reps","error");return}X={reps:je}}else if(V.type==="timed"){const je=V.targetTime-Fe;X={time:Math.max(je,1)}}const ee=[...Jt];ee[vt]={...V,sets:[...V.sets,X]},re(ee),V.type==="weighted"&&X.weight>0&&await Mr(V.name,X.weight,X.reps);const ge=V.sets.length+1;if(ge<V.targetSets)rs(ge),it(""),st(!1),an(0);else if(vt+1<Jt.length){const je=vt+1;rn(je),rs(0),kt(""),it(""),Ln(!1),st(!1),an(0)}else await Y(ee),Un(!0)},Y=async V=>{if(!(!s||!t))try{const X=V.reduce((ee,ge)=>ee+ge.sets.length,0);await Kr(wt(_e,"workoutLogs"),{clientId:t.id,type:"muscle_group",muscleGroup:yt,sessionId:et?.id,sessionName:et?.name,exerciseCount:V.length,totalSets:X,duration:Math.round(X*1.5),exercises:V.map(ee=>({name:ee.name,type:ee.type,sets:ee.sets})),completedAt:Vt.now()})}catch(X){console.error("Error saving muscle group workout log:",X)}},Ne=_.useRef(null),Ie=()=>(Ne.current||(Ne.current=new(window.AudioContext||window.webkitAudioContext)),Ne.current),Ue=()=>{try{const V=Ie(),X=V.createOscillator(),ee=V.createGain();X.connect(ee),ee.connect(V.destination),X.frequency.value=880,ee.gain.value=.3,X.start(V.currentTime),X.stop(V.currentTime+.15)}catch{}},ht=()=>{try{const V=Ie(),X=V.createOscillator(),ee=V.createGain();X.connect(ee),ee.connect(V.destination),X.frequency.value=1200,ee.gain.value=.4,X.start(V.currentTime),X.stop(V.currentTime+.3)}catch{}};_.useEffect(()=>{if(k!=="workout"||D!=="work"||!M[Pe]?.isGif)return;const X=setInterval(()=>{const ee=gt.current;if(!ee)return;const ge=ee.getAttribute("src");ee.removeAttribute("src"),setTimeout(()=>{gt.current&&gt.current.setAttribute("src",ge)},0)},4e3);return()=>clearInterval(X)},[k,D,Pe,ue,M]);const tt=(V,X,ee)=>{const ge=Math.round(V/X*z3);return a.jsx("svg",{className:"wk-ring-svg",viewBox:"0 0 200 200",children:s3.map((je,Oe)=>a.jsx("line",{x1:je.x1,y1:je.y1,x2:je.x2,y2:je.y2,className:Oe<ge?`wk-tick-filled ${ee}`:"wk-tick-empty",strokeWidth:je.thick?"3":"2"},Oe))})},St=()=>{const V=M.length*A;return((ue-1)*M.length+Pe+(D==="rest"?.5:0))/V},dt=ut&&a.jsx("div",{className:`toast-notification ${ut.type}`,children:ut.message});if(i)return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>b("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsx("div",{className:"wk-loading-inline",children:a.jsx("div",{className:"wk-loading-spinner"})})]});if(k==="menu")return a.jsx(Xo,{children:a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>b("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"wk-menu-heading",children:[a.jsx("h2",{children:"Choose Your Workout"}),a.jsx("p",{children:"No excuses. Just results."})]}),a.jsx("button",{className:"wk-hero-card",onClick:()=>E("randomiser_hub"),children:a.jsx("img",{src:$w,alt:"Randomise Workout",className:"wk-hero-bg"})}),!p&&a.jsxs("button",{className:"wk-hero-card wk-free-card-premium",onClick:()=>b("/upgrade"),children:[a.jsx("img",{src:Ww,alt:"Programmes",className:"wk-hero-bg"}),a.jsx("div",{className:"wk-free-card-overlay"}),a.jsxs("div",{className:"wk-free-card-content",children:[a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{className:"wk-free-card-label",children:"Unlock Full Access"})]})]}),p&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"wk-section-header",children:[a.jsx("h2",{children:"Programmes"}),a.jsxs("span",{className:"wk-section-count",children:[Zp.length," available"]})]}),a.jsx("div",{className:"wk-prog-scroll-wrap",children:a.jsx("div",{className:"wk-prog-scroll",children:Zp.map((V,X)=>V.image?a.jsxs("button",{className:"wk-prog-img-card",onClick:()=>b("/client/core-buddy/programmes",{state:{templateId:V.id}}),style:{animationDelay:`${X*.06}s`},children:[a.jsx("img",{src:V.image,alt:V.name,className:"wk-prog-img"}),X===0&&a.jsx("div",{className:"wk-swipe-arrow",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},V.id):a.jsxs("button",{className:"wk-prog-hero-card",onClick:()=>b("/client/core-buddy/programmes",{state:{templateId:V.id}}),style:{animationDelay:`${X*.06}s`},children:[a.jsx("img",{src:Ww,alt:"Programme",className:"wk-prog-hero-bg",loading:"lazy"}),a.jsx("div",{className:"wk-prog-hero-overlay",style:{background:q3[V.focus]}}),a.jsxs("div",{className:"wk-prog-hero-content",children:[a.jsxs("div",{className:"wk-prog-hero-top",children:[a.jsxs("span",{className:"wk-prog-hero-badge",children:[V.duration," WEEKS"]}),a.jsx("span",{className:"wk-prog-hero-level",children:V.level})]}),a.jsxs("div",{className:"wk-prog-hero-bottom",children:[a.jsx("h3",{children:V.name.toUpperCase()}),a.jsxs("p",{children:[V.daysPerWeek,"x per week  ",V.focus==="fullbody"?"Full Body":V.focus.charAt(0).toUpperCase()+V.focus.slice(1)," Focus"]}),a.jsx("span",{className:"wk-prog-hero-go",children:"VIEW PROGRAMME "})]})]}),X===0&&a.jsx("div",{className:"wk-swipe-arrow",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},V.id))})})]}),p&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"wk-section-header",children:[a.jsx("h2",{children:"Muscle Groups"}),a.jsxs("span",{className:"wk-section-count",children:[Qc.length," groups"]})]}),a.jsx("div",{className:"wk-muscle-grid",children:Qc.map((V,X)=>a.jsx("button",{className:`wk-muscle-hero-card${V.image?" wk-muscle-thumb":""}`,onClick:()=>{Bt(V.key),E("muscle_sessions")},style:{animationDelay:`${X*.05}s`},children:V.image?a.jsx("img",{src:V.image,alt:V.label,className:"wk-muscle-thumb-img"}):a.jsxs(a.Fragment,{children:[a.jsx("img",{src:$w,alt:"Muscle group",className:"wk-muscle-hero-bg",loading:"lazy"}),a.jsx("div",{className:"wk-muscle-hero-overlay",style:{background:Jp[V.key]}}),a.jsxs("div",{className:"wk-muscle-hero-content",children:[a.jsx("div",{className:"wk-muscle-hero-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:V.icon})})}),a.jsxs("div",{className:"wk-muscle-hero-text",children:[a.jsx("span",{className:"wk-muscle-hero-name",children:V.label}),a.jsxs("span",{className:"wk-muscle-hero-count",children:[Gw[V.key]?.length||0," sessions"]})]})]})]})},V.key))})]})]}),a.jsx(ui,{active:"workouts"}),dt]})});if(k==="randomiser_hub"){const V=JSON.parse(localStorage.getItem("mcf_last_randomiser")||"null")||{focus:"core",level:"intermediate",duration:15},X=Wr.find(ge=>ge.key===V.focus)?.label||V.focus,ee=xi.find(ge=>ge.key===V.level)?.label||V.level;return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>b("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"wk-hub-heading wk-hub-heading-hero",children:[a.jsx("div",{className:"wk-hub-circle-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-hub-circle-logo"})}),a.jsx("h2",{children:"Randomiser"}),a.jsx("p",{children:"Generate, save & replay workouts"})]}),a.jsxs("div",{className:"wk-hub-launch-zone",children:[vn.total>0&&a.jsxs("div",{className:"wk-hub-stats",children:[a.jsxs("div",{className:"wk-hub-stat",children:[a.jsx("span",{className:"wk-hub-stat-value",children:vn.total}),a.jsx("span",{className:"wk-hub-stat-label",children:"Workouts"})]}),vn.streak>0&&a.jsxs("div",{className:"wk-hub-stat",children:[a.jsxs("span",{className:"wk-hub-stat-value",children:[vn.streak,a.jsx("small",{children:"d"})]}),a.jsx("span",{className:"wk-hub-stat-label",children:"Streak"})]}),vn.favouriteFocus&&a.jsxs("div",{className:"wk-hub-stat",children:[a.jsx("span",{className:"wk-hub-stat-value wk-hub-stat-focus",style:{color:dd[vn.favouriteFocus]||"var(--color-primary)"},children:Wr.find(ge=>ge.key===vn.favouriteFocus)?.label||vn.favouriteFocus}),a.jsx("span",{className:"wk-hub-stat-label",children:"Top Focus"})]})]}),a.jsxs("div",{className:"wk-hub-actions",children:[a.jsxs("button",{className:"wk-hub-action-btn wk-hub-new wk-hub-new-glow",onClick:()=>E("setup"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"New Workout"]}),a.jsxs("button",{className:"wk-hub-action-btn wk-hub-quick",onClick:Ye,disabled:Zt,children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})}),"Quick Start",a.jsxs("span",{className:"wk-hub-quick-meta",children:[X,"  ",ee,"  ",V.duration,"min"]})]})]}),qt&&a.jsxs("button",{className:"wk-hub-suggestion",onClick:()=>{B(qt.focus),E("setup")},children:[a.jsx("svg",{className:"wk-hub-suggestion-bulb",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),a.jsxs("div",{className:"wk-hub-suggestion-info",children:[a.jsx("span",{className:"wk-hub-suggestion-label",children:qt.message}),a.jsx("span",{className:"wk-hub-suggestion-cta",children:"Tap to set up "})]}),a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"wk-hub-tip",children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),Kw[Math.floor(Date.now()/864e5)%Kw.length]]})]}),p&&a.jsxs("div",{className:"wk-hub-section wk-hub-section--saved",children:[a.jsxs("h3",{className:"wk-hub-section-title",children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Saved Workouts",In.length>0&&a.jsx("span",{className:"wk-hub-count",children:In.length})]}),Ar?In.length===0?a.jsxs("div",{className:"wk-hub-empty wk-hub-empty-enhanced",children:[a.jsx("svg",{className:"wk-hub-empty-icon",width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),a.jsx("p",{children:a.jsx("strong",{children:"No saved workouts yet"})}),a.jsx("p",{className:"wk-hub-empty-sub",children:"Generate a workout and hit save to stash it here for quick replay."})]}):a.jsx("div",{className:"wk-hub-saved-categories",children:Wr.map(ge=>{const je=In.filter(qe=>qe.focus===ge.key);if(je.length===0)return null;const Oe=Rr[ge.key]||!1;return a.jsxs("div",{className:"wk-hub-saved-cat",children:[a.jsxs("button",{className:`wk-hub-saved-cat-header${Oe?" wk-hub-saved-cat-open":""}`,style:{"--cat-color":dd[ge.key]||"var(--color-primary)"},onClick:()=>Ir(qe=>({...qe,[ge.key]:!qe[ge.key]})),children:[a.jsxs("span",{className:"wk-hub-saved-cat-label",children:[a.jsx("span",{className:"wk-hub-focus-pill",style:{"--pill-color":dd[ge.key]||"var(--color-primary)"},children:ge.label}),a.jsx("span",{className:"wk-hub-saved-cat-count",children:je.length})]}),a.jsx("svg",{className:`wk-hub-saved-cat-chevron${Oe?" wk-hub-saved-cat-chevron-open":""}`,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),Oe&&a.jsx("div",{className:"wk-hub-saved-list",children:je.map((qe,pt)=>{const Et=(qe.equipment||[]).map(Xe=>eg.find(en=>en.key===Xe)?.label||Xe).join(", "),Ut=xi.find(Xe=>Xe.key===qe.level)?.label||qe.level;return a.jsxs("div",{className:"wk-hub-saved-card",style:{animationDelay:`${pt*.05}s`},children:[a.jsxs("button",{className:"wk-hub-saved-main",onClick:()=>Ht(qe),children:[a.jsxs("div",{className:"wk-hub-saved-info",children:[a.jsx("span",{className:"wk-hub-saved-name",children:qe.name}),a.jsx("span",{className:"wk-hub-saved-tags",children:a.jsxs("span",{className:"wk-hub-saved-meta",children:[Ut,"  ",qe.duration,"min  ",(qe.exercises||[]).length," ex"]})}),Et&&a.jsx("span",{className:"wk-hub-saved-equip",children:Et})]}),a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]}),a.jsx("button",{className:"wk-hub-saved-delete",onClick:()=>He(qe.id),"aria-label":"Remove saved workout",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("polyline",{points:"3 6 5 6 21 6"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]},qe.id)})})]},ge.key)})}):a.jsx("div",{className:"wk-hub-empty",children:a.jsx("div",{className:"wk-loading-spinner"})})]}),a.jsxs("div",{className:"wk-hub-section wk-hub-section--recent",children:[a.jsxs("h3",{className:"wk-hub-section-title",children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("polyline",{points:"12 6 12 12 16 14"})]}),"Recent"]}),Dr.length===0?a.jsxs("div",{className:"wk-hub-empty wk-hub-empty-enhanced",children:[a.jsxs("svg",{className:"wk-hub-empty-icon",width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("polyline",{points:"12 6 12 12 16 14"})]}),a.jsx("p",{children:a.jsx("strong",{children:"No workouts yet"})}),a.jsx("p",{className:"wk-hub-empty-sub",children:"Complete your first workout to see your history here."})]}):a.jsx("div",{className:"wk-hub-recent-list",children:Dr.map((ge,je)=>{const Oe=Wr.find(Ut=>Ut.key===ge.focus)?.label||ge.focus||"",qe=xi.find(Ut=>Ut.key===ge.level)?.label||ge.level||"",pt=ge.completedAt?.toDate?ge.completedAt.toDate():ge.completedAt?new Date(ge.completedAt):null,Et=pt?(()=>{const Ut=Math.floor((Date.now()-pt.getTime())/1e3);return Ut<3600?`${Math.floor(Ut/60)}m ago`:Ut<86400?`${Math.floor(Ut/3600)}h ago`:`${Math.floor(Ut/86400)}d ago`})():"";return a.jsxs("button",{className:"wk-hub-recent-card",style:{animationDelay:`${je*.05}s`},onClick:()=>{B(ge.focus||"core"),$(ge.level||"intermediate"),fe(ge.duration||15),ge.equipment&&H(ge.equipment),E("setup")},children:[a.jsx("div",{className:"wk-hub-recent-info",children:a.jsxs("span",{className:"wk-hub-recent-tags",children:[a.jsx("span",{className:"wk-hub-focus-pill",style:{"--pill-color":dd[ge.focus]||"var(--color-primary)"},children:Oe}),a.jsxs("span",{className:"wk-hub-recent-meta",children:[qe,"  ",ge.duration||"?","min  ",ge.exerciseCount||"?"," ex"]})]})}),a.jsxs("div",{className:"wk-hub-recent-action",children:[a.jsx("span",{className:"wk-hub-recent-time",children:Et}),a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]})]},je)})})]})]}),a.jsx(ui,{active:"workouts"}),dt]})}if(k==="setup"){const V=Wr.find(ee=>ee.key===q)?.label||q,X=xi.find(ee=>ee.key===K)?.label||K;return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>E("randomiser_hub"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main wk-setup-main",children:[a.jsx("div",{className:"wk-stats-row",children:[{label:"Total",value:`${mt}`,pct:mt>0?Math.min(Math.round(mt/100*100),100):0,color:"#14b8a6",size:"normal"},{label:"This Week",value:`${An}/${Xp}`,pct:Math.round(Math.min(An,Xp)/Xp*100),color:"var(--color-primary)",size:"large"},{label:"Wk Streak",value:`${pn}`,pct:pn>0?Math.min(Math.round(pn/12*100),100):0,color:"#38B6FF",size:"normal"}].map(ee=>{const je=2*Math.PI*38,Oe=je-ee.pct/100*je;return a.jsxs("div",{className:`wk-stat-item${ee.size==="large"?" wk-stat-large":""}`,children:[a.jsxs("div",{className:"wk-stat-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"wk-stat-track",cx:"50",cy:"50",r:38}),a.jsx("circle",{className:"wk-stat-fill",cx:"50",cy:"50",r:38,style:{stroke:ee.color},strokeDasharray:je,strokeDashoffset:Oe})]}),a.jsx("span",{className:"wk-stat-value",style:{color:ee.color},children:ee.value})]}),a.jsx("span",{className:"wk-stat-label",children:ee.label})]},ee.label)})}),a.jsxs("div",{className:"wk-setup-flow",children:[a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Focus Area"}),a.jsx("div",{className:"wk-focus-grid",children:Wr.map(ee=>a.jsxs("button",{className:`wk-equip-btn${q===ee.key?" active":""}${ee.key==="mix"?" wk-mix-btn":""}`,onClick:()=>{Ue(),B(ee.key)},children:[a.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:ee.icon})}),a.jsx("span",{children:ee.label})]},ee.key))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Level"}),a.jsx("div",{className:"wk-level-cards",children:xi.map(ee=>a.jsxs("button",{className:`wk-level-card wk-level-${ee.key}${K===ee.key?" active":""}`,onClick:()=>{Ue(),$(ee.key)},children:[a.jsx("span",{className:"wk-level-name",children:ee.label}),a.jsx("span",{className:"wk-level-desc",children:ee.desc})]},ee.key))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Time"}),a.jsx("div",{className:"wk-time-options",children:tg.map(ee=>{const ge=!ds.includes(ee);return a.jsxs("button",{className:`wk-time-btn${G===ee?" active":""}${ge?" locked":""}`,onClick:()=>{ge||(Ue(),fe(ee))},disabled:ge,children:[a.jsx("span",{className:"wk-time-num",children:ee}),a.jsx("span",{className:"wk-time-unit",children:ge?a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}):"min"})]},ee)})})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Equipment"}),a.jsx("div",{className:"wk-equip-options",children:eg.map(ee=>{const ge=O.includes(ee.key);return a.jsxs("button",{className:`wk-equip-btn${ge?" active":""}`,onClick:()=>{ge&&O.length===1||(Ue(),H(je=>ge&&je.length===1?je:ge?je.filter(Oe=>Oe!==ee.key):[...je,ee.key]))},children:[a.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:ee.icon})}),a.jsx("span",{children:ee.label})]},ee.key)})})]}),a.jsx("div",{className:"wk-setup-summary",children:a.jsxs("span",{children:[V,"  ",X,"  ",G," min"]})})]})]}),a.jsxs("div",{className:"wk-go-sticky",children:[Zt&&a.jsx("p",{className:"wk-free-limit-msg",children:"You've used your free workout this week. Upgrade for unlimited access."}),a.jsx("button",{className:"wk-randomise-btn",onClick:Yn,disabled:j||Zt,children:j?"Loading exercises...":Zt?"Limit Reached":"Randomise Workout"})]}),dt]})}if(k==="spinning")return a.jsxs("div",{className:"wk-page wk-page-center","data-theme":l?"dark":"light","data-accent":h,children:[a.jsxs("div",{className:"wk-spin-container",children:[a.jsxs("div",{className:"wk-spin-ring",children:[a.jsx("svg",{className:"wk-spin-svg",viewBox:"0 0 200 200",children:n3.map((V,X)=>a.jsx("line",{x1:V.x1,y1:V.y1,x2:V.x2,y2:V.y2,className:"wk-spin-tick",strokeWidth:V.thick?"3.5":"2",style:{animationDelay:`${X*.03}s`}},X))}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-spin-logo",width:"50",height:"50"})]}),a.jsx("p",{className:"wk-spin-text",children:"Generating workout..."})]}),dt]});if(k==="preview"){const V=et?.interval?{work:et.work,rest:et.rest}:xi.find(ee=>ee.key===K),X=M.length*A*(V.work+V.rest);return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>E(et?.interval?"muscle_sessions":"setup"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[et?.interval&&a.jsx("h2",{className:"mg-preview-title",children:et.name}),a.jsxs("div",{className:"wk-preview-stats",children:[a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:M.length}),a.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:A}),a.jsx("span",{className:"wk-stat-label",children:"Rounds"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Math.ceil(X/60)}),a.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsxs("span",{className:"wk-stat-val",children:[V.work,"/",V.rest]}),a.jsx("span",{className:"wk-stat-label",children:"Work/Rest"})]})]}),a.jsx("div",{className:"wk-preview-list",children:M.map((ee,ge)=>a.jsxs("div",{className:"wk-preview-item",style:{animationDelay:`${ge*.06}s`},onClick:()=>rt(ee),children:[a.jsx("span",{className:"wk-preview-num",children:ge+1}),a.jsx("div",{className:"wk-preview-thumb",children:ee.isGif?a.jsx("img",{src:ee.videoUrl,alt:ee.name,loading:"lazy"}):a.jsx("video",{src:`${ee.videoUrl}#t=0.1`,muted:!0,playsInline:!0,preload:"auto"})}),a.jsx("span",{className:"wk-preview-name",children:ee.name}),a.jsx("svg",{className:"wk-preview-play",width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]},ge))}),Ot&&a.jsx("div",{className:"wk-preview-modal-backdrop",onClick:()=>rt(null),children:a.jsxs("div",{className:"wk-preview-modal",onClick:ee=>ee.stopPropagation(),children:[a.jsx("button",{className:"wk-preview-modal-close",onClick:()=>rt(null),"aria-label":"Close preview",children:a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),a.jsx("div",{className:"wk-preview-modal-video",children:Ot.isGif?a.jsx("img",{src:Ot.videoUrl,alt:Ot.name}):a.jsx("video",{src:Ot.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0})}),a.jsx("h3",{className:"wk-preview-modal-title",children:Ot.name})]})}),a.jsxs("div",{className:"wk-preview-actions",children:[!et?.interval&&a.jsxs("div",{className:"wk-preview-actions-row",children:[a.jsxs("button",{className:"wk-btn-secondary wk-btn-half",onClick:()=>Yn(),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"1 4 1 10 7 10"}),a.jsx("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})]}),"Reshuffle"]}),p&&a.jsxs("button",{className:"wk-btn-secondary wk-btn-half",onClick:()=>Sn(!0),disabled:qn,children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Save"]})]}),a.jsx("button",{className:"wk-btn-primary wk-btn-full",onClick:vr,children:"Start Workout"})]}),_s&&a.jsx("div",{className:"wk-save-modal-backdrop",onClick:()=>Sn(!1),children:a.jsxs("div",{className:"wk-save-modal",onClick:ee=>ee.stopPropagation(),children:[a.jsx("h3",{children:"Save Workout"}),a.jsx("p",{children:"Give this workout a name (or leave blank for auto-name)"}),a.jsx("input",{type:"text",className:"wk-save-input",value:On,onChange:ee=>as(ee.target.value),placeholder:`${Wr.find(ee=>ee.key===q)?.label||q} ${G}min`,maxLength:40,autoFocus:!0}),a.jsxs("div",{className:"wk-save-modal-actions",children:[a.jsx("button",{className:"wk-btn-secondary",onClick:()=>Sn(!1),children:"Cancel"}),a.jsx("button",{className:"wk-btn-primary",onClick:()=>Le(On),disabled:qn,children:qn?"Saving...":"Save"})]})]})})]})]})}if(k==="countdown")return a.jsx("div",{className:"wk-page wk-page-center wk-page-dark","data-theme":l?"dark":"light","data-accent":h,children:a.jsxs("div",{className:"wk-countdown-big",children:[a.jsx("span",{className:"wk-countdown-num",children:Ke}),a.jsx("span",{className:"wk-countdown-label",children:"GET READY"})]})});if(k==="workout"){const V=M[Pe],X=D==="work"?Qe.work:Qe.rest,ee=D==="rest"?Pe+1<M.length?M[Pe+1]:ue<A?M[0]:null:null;return a.jsxs("div",{className:"wk-page wk-page-workout","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("div",{className:"wk-video-container",children:D==="work"?V.isGif?a.jsx("img",{ref:gt,className:"wk-video",src:V.videoUrl,alt:V.name},V.videoUrl):a.jsx("video",{className:"wk-video",src:V.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0},V.videoUrl):a.jsxs("div",{className:"wk-rest-screen",children:[a.jsx("span",{className:"wk-rest-label",children:"REST"}),ee&&a.jsxs("span",{className:"wk-next-label",children:["Next: ",ee.name]})]})}),a.jsx("div",{className:"wk-back-row",children:a.jsxs("button",{className:"wk-back-btn",onClick:()=>{confirm("Leave workout?")&&E("randomiser_hub")},children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]})}),a.jsx("div",{className:"wk-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"wk-exercise-info",children:[a.jsxs("span",{className:"wk-exercise-counter",children:[Pe+1," / ",M.length]}),a.jsx("h2",{className:"wk-exercise-name",children:V.name}),a.jsxs("span",{className:"wk-round-label",children:["Round ",ue," of ",A]})]}),a.jsx("div",{className:"wk-timer-section",children:a.jsxs("div",{className:"wk-timer-ring-wrap",children:[tt(ve,X,D==="work"?"wk-tick-work":"wk-tick-rest"),a.jsxs("div",{className:"wk-timer-center",children:[a.jsx("span",{className:"wk-timer-time",children:ve}),a.jsx("span",{className:`wk-timer-phase ${D}`,children:D==="work"?"WORK":"REST"})]})]})}),a.jsxs("div",{className:"wk-controls",children:[a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-stop",onClick:()=>{confirm("End workout early?")&&E("randomiser_hub")},children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})})}),a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-pause",onClick:()=>Se(!Te),children:Te?a.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}):a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),a.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]})}),a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-skip",onClick:()=>{Ee(0)},children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("polygon",{points:"5 4 15 12 5 20 5 4"}),a.jsx("rect",{x:"15",y:"4",width:"4",height:"16"})]})})]}),a.jsx("div",{className:"wk-progress-bar",children:a.jsx("div",{className:"wk-progress-fill",style:{width:`${St()*100}%`}})}),Be&&(()=>{const ge=xi.find(Oe=>Oe.key===K),je=M.length*A*(ge.work+ge.rest);return a.jsxs(a.Fragment,{children:[a.jsx(qg,{title:"Workout Complete!",stats:[{value:Math.ceil(je/60),label:"Minutes"},{value:M.length*A,label:"Intervals"},{value:A,label:"Rounds"}],hideShare:!p,onShareJourney:t?Dt:null,userName:t?.name,onDismissStart:()=>E("randomiser_hub"),onDone:()=>{sn(!1),It(null),Bt(null)}}),!et?.interval&&a.jsxs("button",{className:"wk-complete-save-btn",onClick:()=>Sn(!0),disabled:qn,children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Save This Workout"]}),_s&&a.jsx("div",{className:"wk-save-modal-backdrop",onClick:()=>Sn(!1),style:{zIndex:10001},children:a.jsxs("div",{className:"wk-save-modal",onClick:Oe=>Oe.stopPropagation(),children:[a.jsx("h3",{children:"Save Workout"}),a.jsx("p",{children:"Give this workout a name (or leave blank for auto-name)"}),a.jsx("input",{type:"text",className:"wk-save-input",value:On,onChange:Oe=>as(Oe.target.value),placeholder:`${Wr.find(Oe=>Oe.key===q)?.label||q} ${G}min`,maxLength:40,autoFocus:!0}),a.jsxs("div",{className:"wk-save-modal-actions",children:[a.jsx("button",{className:"wk-btn-secondary",onClick:()=>Sn(!1),children:"Cancel"}),a.jsx("button",{className:"wk-btn-primary",onClick:()=>Le(On),disabled:qn,children:qn?"Saving...":"Save"})]})]})})]})})()]})}if(k==="muscle_sessions"){const V=Qc.find(ee=>ee.key===yt),X=Gw[yt]||[];return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>E("randomiser_hub"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"mg-sessions-header",children:[a.jsx("div",{className:"mg-sessions-icon",style:{background:Jp[yt]},children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:V?.icon})})}),a.jsxs("h2",{children:[V?.label," Workouts"]}),a.jsxs("p",{children:[X.length," sessions available"]})]}),a.jsx("div",{className:"mg-sessions-list",children:X.map((ee,ge)=>a.jsxs("button",{className:"mg-session-card",onClick:()=>{It(ee),E("muscle_overview")},style:{animationDelay:`${ge*.08}s`},children:[a.jsxs("div",{className:"mg-session-info",children:[a.jsx("h3",{children:ee.name}),a.jsx("p",{children:ee.desc}),a.jsx("div",{className:"mg-session-meta",children:ee.interval?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mg-session-tag mg-tag-interval",children:"Interval"}),a.jsxs("span",{className:"mg-session-tag",children:[ee.exercises.length," exercises"]}),a.jsxs("span",{className:"mg-session-tag",children:[ee.rounds," rounds"]})]}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mg-session-tag mg-tag-strength",children:"Strength"}),a.jsxs("span",{className:"mg-session-tag",children:[ee.exercises.length," exercises"]}),a.jsx("span",{className:"mg-session-tag",children:(()=>{const je=ee.exercises.map(pt=>pt.sets||0),Oe=Math.min(...je),qe=Math.max(...je);return Oe===qe?`${Oe} sets each`:`${Oe}-${qe} sets each`})()})]})})]}),a.jsx("div",{className:"mg-session-arrow",children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},ee.id))})]}),dt]})}if(k==="muscle_overview"){const V=et;if(!V)return null;const X=Qc.find(ee=>ee.key===yt);return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>E("muscle_sessions"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main mg-overview-main",children:[a.jsx("div",{className:"mg-overview-hero",style:V.image?void 0:{background:Jp[yt]},children:V.image?a.jsx("img",{src:V.image,alt:V.name,className:"mg-overview-hero-img"}):a.jsx("div",{className:"mg-overview-hero-content",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"mg-overview-hero-icon",children:a.jsx("path",{d:X?.icon})})})}),a.jsxs("div",{className:"mg-overview-header",children:[a.jsxs("div",{className:"mg-overview-title-row",children:[a.jsx("h2",{children:V.name}),V.level&&a.jsx("span",{className:"mg-overview-level",children:V.level})]}),a.jsx("p",{className:"mg-overview-desc",children:V.desc})]}),V.overview&&a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 16v-4M12 8h.01"})]}),"About This Workout"]}),a.jsx("p",{children:V.overview})]}),V.tips&&V.tips.length>0&&a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Tips & Form"]}),a.jsx("ul",{className:"mg-overview-tips",children:V.tips.map((ee,ge)=>a.jsx("li",{children:ee},ge))})]}),a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"}),a.jsx("rect",{x:"9",y:"3",width:"6",height:"4",rx:"1"}),a.jsx("path",{d:"M9 14l2 2 4-4"})]}),"Exercises (",V.exercises.length,")"]}),a.jsx("div",{className:"mg-overview-exercises",children:V.exercises.map((ee,ge)=>a.jsxs("div",{className:"mg-overview-exercise",children:[a.jsx("span",{className:"mg-overview-ex-num",children:ge+1}),a.jsxs("div",{className:"mg-overview-ex-info",children:[a.jsx("span",{className:"mg-overview-ex-name",children:ee.name}),V.interval?a.jsxs("span",{className:"mg-overview-ex-detail",children:[V.work,"s work / ",V.rest,"s rest"]}):a.jsxs("span",{className:"mg-overview-ex-detail",children:[ee.sets," sets  ",ee.reps?`${ee.reps} reps`:`${ee.time}s`,ee.type==="weighted"&&"  weighted"]})]})]},ge))})]}),a.jsxs("button",{className:"mg-overview-start-btn",onClick:()=>pa(V),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Workout"]})]}),dt]})}if(k==="muscle_workout"){const V=et;if(!V)return null;const X=V.exercises[vt],ee=Jt[vt];if(!X||!ee)return null;const ge=ee.sets.length,je=V.exercises.length,Oe=V.exercises.reduce((Xe,en)=>Xe+(en.sets||0),0),pt=Jt.reduce((Xe,en)=>Xe+en.sets.length,0)/Oe*100,Et=zn[X.name];X.type==="timed"&&Fe===0&&!$e&&ge===Cs&&setTimeout(()=>an(X.time),0);const Ut=ge+1<X.sets?"Log Set":vt+1<je?"Log Set  Next Exercise":"Log Set  Complete";return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("div",{className:"mg-session-progress",children:a.jsx("div",{className:"mg-session-progress-fill",style:{width:`${pt}%`}})}),a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>{confirm("End workout early?")&&E("muscle_overview")},"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsxs("span",{className:"mg-header-info",children:["Exercise ",vt+1,"/",je]}),a.jsx("div",{style:{width:22}})]})}),a.jsxs("main",{className:"wk-main",children:[Et?a.jsxs("div",{className:"mg-video-container",onClick:Lr,children:[Et.isGif?a.jsx("img",{className:"mg-video",src:Et.url,alt:X.name}):a.jsx("video",{ref:Qt,className:"mg-video",src:Et.url,loop:!0,muted:!0,playsInline:!0},X.name),!un&&!Et.isGif&&a.jsxs("div",{className:"mg-video-overlay",children:[a.jsx("svg",{className:"mg-play-icon",width:"48",height:"48",viewBox:"0 0 24 24",fill:"rgba(255,255,255,0.9)",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),a.jsx("span",{className:"mg-video-hint",children:"Tap for demo"})]})]}):a.jsxs("div",{className:"mg-video-placeholder",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.4",children:[a.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),a.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),a.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),a.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),a.jsx("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),a.jsx("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),a.jsx("line",{x1:"17",y1:"7",x2:"22",y2:"7"}),a.jsx("line",{x1:"17",y1:"17",x2:"22",y2:"17"})]}),a.jsx("span",{children:"Video coming soon"})]}),a.jsx("div",{className:"wk-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"mg-exercise-card",children:[a.jsx("h2",{className:"mg-ex-name",children:X.name}),a.jsx("span",{className:`mg-ex-type-badge ${X.type}`,children:X.type==="weighted"?"Weight + Reps":X.type==="reps"?"Reps Only":"Timed"}),a.jsxs("div",{className:"mg-ex-set-info",children:[a.jsxs("span",{className:"mg-ex-set-num",children:["Set ",ge+1," of ",X.sets]}),X.type!=="timed"&&a.jsxs("span",{className:"mg-ex-target",children:["Target: ",X.reps," reps"]}),X.type==="timed"&&a.jsxs("span",{className:"mg-ex-target",children:["Target: ",X.time,"s"]})]}),X.type==="weighted"&&a.jsxs("div",{className:"mg-input-area",children:[a.jsxs("div",{className:"mg-input-group",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",inputMode:"decimal",className:"mg-input",value:Ae,onChange:Xe=>kt(Xe.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"mg-input-group",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:bt,onChange:Xe=>it(Xe.target.value),placeholder:"0"})]})]}),X.type==="reps"&&a.jsx("div",{className:"mg-input-area",children:a.jsxs("div",{className:"mg-input-group mg-input-single",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:bt,onChange:Xe=>it(Xe.target.value),placeholder:"0"})]})}),X.type==="timed"&&a.jsxs("div",{className:"mg-timer-area",children:[a.jsx("div",{className:"mg-timer-display",children:a.jsxs("span",{className:"mg-timer-value",children:[Fe,"s"]})}),$e?a.jsx("button",{className:"mg-timer-btn mg-timer-stop",onClick:()=>st(!1),children:"Stop"}):a.jsx("button",{className:"mg-timer-btn",onClick:()=>{Fe===0&&an(X.time),st(!0)},children:Fe<X.time&&Fe>0?"Resume":"Start Timer"})]}),a.jsx("button",{className:"mg-log-set-btn",onClick:C,children:Ut}),ee.sets.length>0&&a.jsx("div",{className:"mg-completed-sets",children:ee.sets.map((Xe,en)=>a.jsxs("div",{className:"mg-completed-set",children:[a.jsx("span",{className:"mg-completed-set-check",children:""}),a.jsxs("span",{children:["Set ",en+1,": ",Xe.weight!=null?`${Xe.weight}kg  ${Xe.reps}`:Xe.reps!=null?`${Xe.reps} reps`:`${Xe.time}s`]})]},en))})]})]}),dt,Nn&&(()=>{const Xe=Jt.reduce((Tt,Hn)=>Tt+Hn.sets.length,0),en=Qc.find(Tt=>Tt.key===yt)?.label||"",Bs=[{value:Jt.length,label:"Exercises"},{value:Xe,label:"Sets"}];return a.jsx(qg,{title:`${en} Complete!`,subtitle:et?.name,stats:Bs,hideShare:!p,onShareJourney:t?Dt:null,userName:t?.name,onDismissStart:()=>E("randomiser_hub"),onDone:()=>{Un(!1),It(null),Bt(null)}})})()]})}return null}const G3=[{key:"trained",label:"Trained",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4",color:"#A12F3A",darkColor:"#E8475A"},{key:"protein",label:"Hit Protein",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z",color:"#4caf50",darkColor:"#5CDB61"},{key:"steps",label:"10k Steps",icon:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20M4 12.5A2.5 2.5 0 0 1 6.5 10H20M4 5.5A2.5 2.5 0 0 1 6.5 3H20",color:"#ff9800",darkColor:"#FFB020"},{key:"sleep",label:"8hrs Sleep",icon:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z",color:"#7c3aed",darkColor:"#9B5AF2"},{key:"water",label:"2L Water",icon:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z",color:"#2196f3",darkColor:"#42A5F5"}],K3="M12 2l2.4 7.2L22 12l-7.6 2.8L12 22l-2.4-7.2L2 12l7.6-2.8z",Y3="#e91e63",Q3="#FF4D88",X3=700,Hg=42,Al=2*Math.PI*Hg,fd=["Every day counts. See you tomorrow!","Consistency is your superpower.","Perfect day  keep the streak alive!","You showed up for yourself today."];function J3(s){const e=new Date(s),t=e.getDay(),i=t===0?-6:1-t;return e.setDate(e.getDate()+i),e.setHours(0,0,0,0),e}function jo(s){return s.toISOString().split("T")[0]}function Z3(s){return Array.from({length:7},(e,t)=>{const i=new Date(s);return i.setDate(s.getDate()+t),i})}function eL(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Xr(),{isDark:l,toggleTheme:u,accent:h}=fa(),{isPremium:p,FREE_HABIT_LIMIT:g}=rc(),y=ir(),[b,k]=_.useState({}),[E,O]=_.useState([]),[H,q]=_.useState(!0),[B,K]=_.useState(!1),[$,G]=_.useState(0),[fe,xe]=_.useState(null),[be,j]=_.useState(null),[T,R]=_.useState(!1),[P,M]=_.useState(!1),[L,A]=_.useState(!1),[Ve,Qe]=_.useState(!1),[Z,ue]=_.useState(""),[Ce,Pe]=_.useState(null),[se,D]=_.useState([]),[ne,ve]=_.useState(null),Ee=_.useRef(null),Te=_.useRef(null),Se=_.useRef(null),Ke=_.useRef(null),ct=_.useRef(!1),Be=_.useRef({}),sn=_.useRef([]),Nn=_.useRef([]),Un=_.useRef(null),Ot=_.useRef(fd[Math.floor(Math.random()*fd.length)]),rt=_.useCallback((oe,Re="info")=>{xe({message:oe,type:Re}),setTimeout(()=>xe(null),3e3)},[]),gt=new Date,ut=jo(gt),Bn=J3(gt),he=Z3(Bn),Dt=["M","T","W","T","F","S","S"],yt=(oe,Re)=>l&&Re?Re:oe,Bt=[...G3.filter(oe=>!se.includes(oe.key)).map(oe=>({...oe,color:yt(oe.color,oe.darkColor)})),...E.map(oe=>({key:`custom_${oe.id}`,label:oe.label,icon:K3,color:yt(Y3,Q3),isCustom:!0,id:oe.id}))],et=p?Bt:Bt.slice(0,g);_.useEffect(()=>{!i&&(!s||!e)&&y("/")},[s,e,i,y]),_.useEffect(()=>{if(!s||!t)return;(async()=>{try{const Re=wt(_e,"habitLogs"),Ge=cn(Re,At("clientId","==",t.id)),mt=await nn(Ge),lt={};mt.docs.forEach(xn=>{const Ns=xn.data();lt[Ns.date]={...Ns,_id:xn.id}}),k(lt);const _n=await pr(Ze(_e,"customHabits",t.id));if(_n.exists()){const xn=_n.data();O(xn.habits||[]),D(xn.hiddenDefaults||[])}let Rn=0;const pn=new Date(gt);for(;;){const xn=jo(pn),Ns=lt[xn];if(Ns)if(Object.values(Ns.habits||{}).filter(Boolean).length>=3)Rn++,pn.setDate(pn.getDate()-1);else break;else if(xn===ut)pn.setDate(pn.getDate()-1);else break}G(Rn)}catch(Re){console.error("Error loading habit logs:",Re)}finally{q(!1)}})()},[s,t]);const It=b[ut]||{habits:{}};_.useEffect(()=>{Object.values(It.habits||{}).filter(Boolean).length<et.length&&L&&A(!1)},[et.length,It.habits]);const vt=async oe=>{if(!(!s||B||It.habits?.[oe])){sn.current=[...Array(10)].map((Ge,mt)=>{const lt=mt/10*2*Math.PI,_n=18+Math.random()*20;return{tx:Math.cos(lt)*_n,ty:Math.sin(lt)*_n,size:3+Math.random()*4,duration:.4+Math.random()*.3}}),j(oe),setTimeout(()=>j(null),700),navigator.vibrate&&navigator.vibrate(50),K(!0);try{const mt={...It.habits||{},[oe]:!0},lt=It._id||`${t.id}_${ut}`;k(Rn=>({...Rn,[ut]:{clientId:t.id,date:ut,habits:mt,_id:lt}})),await Ps(Ze(_e,"habitLogs",lt),{clientId:t.id,date:ut,habits:mt}),Object.values(mt).filter(Boolean).length===et.length&&!L&&(Ot.current=fd[Math.floor(Math.random()*fd.length)],Nn.current=[...Array(80)].map((Rn,pn)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#4caf50","#ff9800","#2196f3","#e91e63","#ffeb3b","#FFD700","#ffffff","#9c27b0"][pn%9],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:pn%3})),setTimeout(()=>{R(!0),A(!0),setTimeout(()=>Un.current?.focus(),1100)},400))}catch(Ge){console.error("Error saving habit:",Ge),rt("Failed to save. Try again.","error"),k(mt=>({...mt,[ut]:{...mt[ut],habits:{...mt[ut]?.habits||{},[oe]:!1}}}))}finally{K(!1)}}},rn=async oe=>{if(!(!s||B)){K(!0);try{const Ge={...It.habits||{},[oe]:!1},mt=It._id||`${t.id}_${ut}`;await Ps(Ze(_e,"habitLogs",mt),{clientId:t.id,date:ut,habits:Ge}),k(lt=>({...lt,[ut]:{clientId:t.id,date:ut,habits:Ge,_id:mt}}))}catch(Re){console.error("Error undoing habit:",Re),rt("Failed to undo. Try again.","error")}finally{K(!1)}}},Cs=oe=>{if(It.habits?.[oe]||!1||B||Ke.current)return;Ke.current=oe,ve(oe),Te.current=performance.now();const Ge=Be.current[oe];Ge&&(Ge.style.strokeDashoffset=Al);const mt=lt=>{const _n=lt-Te.current,Rn=Math.min(_n/X3,1),pn=Be.current[oe];pn&&(pn.style.strokeDashoffset=Al-Rn*Al),Rn<1?Se.current=requestAnimationFrame(mt):(Ke.current=null,ct.current=!0,Se.current=null,ve(null),vt(oe))};Se.current=requestAnimationFrame(mt)},rs=()=>{if(!Ke.current)return;const oe=Ke.current;Ke.current=null,Se.current&&(cancelAnimationFrame(Se.current),Se.current=null),Ee.current&&(clearTimeout(Ee.current),Ee.current=null),Be.current[oe]&&(Be.current[oe].style.strokeDashoffset=Al),ve(null),Te.current=null};_.useEffect(()=>()=>{Se.current&&cancelAnimationFrame(Se.current),Ee.current&&clearTimeout(Ee.current)},[]);const Jt=_.useCallback(async oe=>{if(!t)throw new Error("Not signed in");const Re=oe&&typeof oe=="object"&&oe.type;await Kr(wt(_e,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Re?"":oe,type:Re?oe.type:"text",imageURL:null,createdAt:er(),likeCount:0,commentCount:0,...Re?{metadata:{title:oe.title||"",subtitle:oe.subtitle||"",stats:oe.stats||[],quote:oe.quote||"",badges:oe.badges||[]}}:{}})},[t]),re=async()=>{const oe=Z.trim();if(!oe)return;if(!t?.id){rt("Still loading, try again","error");return}const Re=Date.now().toString(36),Ge=[...E,{id:Re,label:oe}];try{await Ps(Ze(_e,"customHabits",t.id),{clientId:t.id,habits:Ge,hiddenDefaults:se},{merge:!0}),O(Ge),ue(""),Qe(!1),rt(`Added "${oe}"`,"success")}catch(mt){console.error("Error adding custom habit:",mt),rt(mt?.code==="permission-denied"?"Permission denied  check Firestore rules for customHabits":`Failed to add habit: ${mt?.message||"Unknown error"}`,"error")}},Ae=async oe=>{if(!t?.id)return;const Re=E.filter(Ge=>Ge.id!==oe);try{await Ps(Ze(_e,"customHabits",t.id),{clientId:t.id,habits:Re,hiddenDefaults:se},{merge:!0}),O(Re),Pe(null),rt("Habit removed","success")}catch(Ge){console.error("Error deleting habit:",Ge),rt("Failed to remove","error")}},kt=async oe=>{if(!t?.id)return;const Re=[...se,oe];try{await Ps(Ze(_e,"customHabits",t.id),{clientId:t.id,habits:E,hiddenDefaults:Re},{merge:!0}),D(Re),Pe(null),rt("Habit removed","success")}catch(Ge){console.error("Error hiding default habit:",Ge),rt("Failed to remove","error")}},bt=he.map(oe=>{const Re=jo(oe),Ge=b[Re],mt=Ge?Object.values(Ge.habits||{}).filter(Boolean).length:0;return{date:oe,dateStr:Re,completed:mt,total:et.length}}),it=bt.reduce((oe,Re)=>oe+Re.completed,0),$e=bt.reduce((oe,Re)=>oe+Re.total,0),st=$e>0?Math.round(it/$e*100):0,Fe=Object.values(It.habits||{}).filter(Boolean).length,an=et.length>0?Math.round(Fe/et.length*100):0,un=Fe===et.length&&et.length>0,Ln=(()=>{const oe=Object.keys(b).sort();let Re=0,Ge=0,mt=null;for(const lt of oe){const _n=b[lt];if(Object.values(_n.habits||{}).filter(Boolean).length>=3){if(mt){const pn=new Date(mt);Ge=(new Date(lt)-pn)/(1e3*60*60*24)===1?Ge+1:1}else Ge=1;Ge>Re&&(Re=Ge),mt=lt}else Ge=0,mt=null}return Math.max(Re,$)})(),zn=new Date(gt.getFullYear(),gt.getMonth(),1),Xn=zn.toLocaleString("default",{month:"long"}),Qt=new Date(gt.getFullYear(),gt.getMonth()+1,0).getDate(),Fn=(zn.getDay()+6)%7,An=Array.from({length:Qt},(oe,Re)=>{const Ge=new Date(gt.getFullYear(),gt.getMonth(),Re+1),mt=jo(Ge),lt=b[mt],_n=lt?Object.values(lt.habits||{}).filter(Boolean).length:0,Rn=Ge>gt;return{day:Re+1,dateStr:mt,completed:_n,total:et.length,isFuture:Rn,isToday:mt===ut}}),hn=et.map(oe=>({...oe,days:he.map(Re=>{const Ge=jo(Re);return b[Ge]?.habits?.[oe.key]||!1})})),yr=bt.filter(oe=>oe.completed===oe.total&&oe.total>0).length;return a.jsx(Xo,{children:a.jsxs("div",{className:"cbc-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>y("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),i||H?a.jsx("div",{className:"cbc-loading-inline",children:a.jsx("div",{className:"cbc-loading-spinner"})}):a.jsxs("main",{className:"cbc-main",children:[a.jsxs("div",{className:"cbc-hero anim-fade-up",children:[a.jsxs("div",{className:`cbc-progress-ring${un?" cbc-ring-complete":""}`,children:[a.jsxs("svg",{viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"cbc-arc-track",cx:"100",cy:"100",r:"80"}),a.jsx("circle",{className:"cbc-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-an/100*2*Math.PI*80})]}),a.jsxs("div",{className:"cbc-ring-center",children:[a.jsxs("span",{className:"cbc-ring-count",children:[Fe,a.jsx("span",{className:"cbc-ring-divider",children:"/"}),et.length]}),a.jsx("span",{className:"cbc-ring-label",children:un?"complete":"today"})]})]}),a.jsx("p",{className:"cbc-hero-tagline",children:un?"You showed up for yourself today.":Fe===0?"Start your day strong.":`${et.length-Fe} to go  keep pushing.`})]}),a.jsxs("div",{className:"cbc-streak-card anim-fade-up-d1",children:[a.jsx("div",{className:"cbc-streak-icon",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})})}),a.jsxs("div",{className:"cbc-streak-info",children:[a.jsx("span",{className:"cbc-streak-count",children:$}),a.jsx("span",{className:"cbc-streak-label",children:"day streak"})]}),a.jsxs("div",{className:"cbc-streak-best",children:[a.jsx("span",{className:"cbc-streak-best-val",children:Ln}),a.jsx("span",{className:"cbc-streak-best-label",children:"best"})]})]}),a.jsxs("div",{className:"cbc-section anim-fade-up-d2",children:[a.jsx("h2",{className:"cbc-section-title",children:"Today's Habits"}),a.jsxs("div",{className:"cbc-habits-grid",children:[et.map(oe=>{const Re=It.habits?.[oe.key]||!1,Ge=be===oe.key,mt=ne===oe.key;return a.jsxs("div",{className:`cbc-habit-tile ${Re?"cbc-habit-done":""} ${Ge?"cbc-habit-just-checked":""}`,style:{"--habit-color":oe.color},children:[p&&a.jsx("button",{className:"cbc-habit-delete",onClick:lt=>{lt.stopPropagation(),Pe(oe.isCustom?{type:"custom",id:oe.id,label:oe.label}:{type:"default",key:oe.key,label:oe.label})},"aria-label":`Remove ${oe.label}`,children:a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),a.jsxs("div",{className:`cbc-habit-ring-touch ${mt?"cbc-holding":""} ${Re?"cbc-ring-completed":""}`,onPointerDown:lt=>{Re||(lt.preventDefault(),Cs(oe.key))},onPointerUp:rs,onPointerLeave:rs,onPointerCancel:rs,onClick:lt=>{if(lt.stopPropagation(),ct.current){ct.current=!1;return}Re&&rn(oe.key)},role:"button",tabIndex:0,"aria-label":Re?`Undo ${oe.label}`:`Press and hold to complete ${oe.label}`,onKeyDown:lt=>{(lt.key==="Enter"||lt.key===" ")&&(lt.preventDefault(),Re?rn(oe.key):vt(oe.key))},children:[a.jsxs("svg",{className:"cbc-habit-ring-svg",viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cbc-habit-ring-track",cx:"50",cy:"50",r:Hg}),a.jsx("circle",{className:"cbc-habit-ring-fill",ref:lt=>{lt&&(Be.current[oe.key]=lt)},cx:"50",cy:"50",r:Hg,style:{stroke:oe.color,strokeDasharray:Al,strokeDashoffset:Re?0:Al}})]}),Re&&a.jsx("div",{className:"cbc-habit-glow-orb",style:{"--habit-color":oe.color}}),a.jsx("div",{className:"cbc-habit-ring-icon",style:{color:oe.color},children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:oe.icon})})}),Ge&&a.jsx("div",{className:"cbc-particles",children:sn.current.map((lt,_n)=>a.jsx("span",{className:"cbc-particle",style:{"--tx":`${lt.tx}px`,"--ty":`${lt.ty}px`,"--size":`${lt.size}px`,"--particle-color":oe.color,animationDuration:`${lt.duration}s`}},_n))})]}),a.jsx("span",{className:"cbc-habit-label",children:oe.label}),Re?a.jsx("span",{className:"cbc-habit-done-tag",children:"Done"}):a.jsx("span",{className:"cbc-habit-hold-hint",children:"Hold to complete"})]},oe.key)}),p?a.jsxs("div",{className:"cbc-habit-tile cbc-add-tile",onClick:()=>Qe(!0),role:"button",tabIndex:0,children:[a.jsx("div",{className:"cbc-add-ring",children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})}),a.jsx("span",{className:"cbc-habit-label",children:"Add Habit"}),a.jsx("span",{className:"cbc-habit-hold-hint",children:"Your own"})]}):a.jsxs("div",{className:"cbc-habit-tile cbc-unlock-tile",onClick:()=>y("/upgrade"),role:"button",tabIndex:0,children:[a.jsx("div",{className:"cbc-unlock-ring",children:a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),a.jsx("span",{className:"cbc-habit-label",children:"More Habits"}),a.jsx("span",{className:"cbc-habit-hold-hint",children:"Custom & editable"})]})]})]}),a.jsxs("div",{className:"cbc-section anim-fade-up-d3",children:[a.jsxs("div",{className:"cbc-section-header",children:[a.jsx("h2",{className:"cbc-section-title",children:"This Week"}),a.jsxs("span",{className:"cbc-section-badge",children:[yr,"/7 perfect"]})]}),a.jsxs("div",{className:"cbc-weekly-card",children:[a.jsxs("div",{className:"cbc-weekly-header",children:[a.jsx("span",{className:"cbc-weekly-habit-name"}),Dt.map((oe,Re)=>a.jsx("span",{className:`cbc-weekly-day-label${he[Re]&&jo(he[Re])===ut?" cbc-today-label":""}`,children:oe},Re))]}),hn.map(oe=>(oe.days.filter(Boolean).length,a.jsxs("div",{className:"cbc-weekly-row",children:[a.jsx("span",{className:"cbc-weekly-habit-name",style:{color:oe.color},children:oe.label}),oe.days.map((Re,Ge)=>a.jsx("span",{className:`cbc-weekly-dot${Re?" cbc-dot-done":""}${he[Ge]&&jo(he[Ge])===ut?" cbc-dot-today":""}`,style:Re?{background:oe.color,borderColor:oe.color,boxShadow:`0 0 6px ${oe.color}40`}:void 0},Ge))]},oe.key))),a.jsxs("div",{className:"cbc-week-summary",children:[a.jsx("div",{className:"cbc-week-summary-bar",children:a.jsx("div",{className:"cbc-week-summary-fill",style:{width:`${st}%`}})}),a.jsxs("span",{className:"cbc-week-summary-text",children:[it,"/",$e," completed (",st,"%)"]})]})]})]}),a.jsxs("div",{className:"cbc-section anim-fade-up-d4",children:[a.jsx("h2",{className:"cbc-section-title",children:Xn}),a.jsxs("div",{className:"cbc-calendar-card",children:[a.jsx("div",{className:"cbc-cal-header",children:["M","T","W","T","F","S","S"].map((oe,Re)=>a.jsx("span",{className:"cbc-cal-day-label",children:oe},Re))}),a.jsxs("div",{className:"cbc-cal-grid",children:[Array.from({length:Fn},(oe,Re)=>a.jsx("span",{className:"cbc-cal-cell cbc-cal-empty"},`e${Re}`)),An.map(oe=>{const Re=oe.total>0?oe.completed/oe.total:0,Ge=oe.isFuture?-1:Re===0?0:Re<.4?1:Re<.75?2:Re<1?3:4;return a.jsx("span",{className:`cbc-cal-cell${oe.isToday?" cbc-cal-today":""}${Ge===4?" cbc-cal-perfect":""} cbc-cal-heat-${Ge<0?"future":Ge}`,children:oe.day},oe.day)})]}),a.jsxs("div",{className:"cbc-cal-legend",children:[a.jsx("span",{className:"cbc-cal-legend-label",children:"Less"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-0"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-1"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-2"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-3"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-4"}),a.jsx("span",{className:"cbc-cal-legend-label",children:"More"})]})]})]})]}),a.jsx(ui,{active:"home"}),Ve&&a.jsx("div",{className:"cbc-modal-overlay",onClick:()=>Qe(!1),children:a.jsxs("div",{className:"cbc-modal",onClick:oe=>oe.stopPropagation(),children:[a.jsx("h3",{className:"cbc-modal-title",children:"Add Habit"}),a.jsx("p",{className:"cbc-modal-desc",children:"Track something personal to your routine."}),a.jsx("input",{className:"cbc-modal-input",type:"text",placeholder:"e.g. Meditate, Stretch, Read...",value:Z,onChange:oe=>ue(oe.target.value),maxLength:30,autoFocus:!0,onKeyDown:oe=>oe.key==="Enter"&&re()}),a.jsxs("div",{className:"cbc-modal-actions",children:[a.jsx("button",{className:"cbc-modal-cancel",onClick:()=>{Qe(!1),ue("")},children:"Cancel"}),a.jsx("button",{className:"cbc-modal-save",onClick:re,disabled:!Z.trim(),children:"Add"})]})]})}),Ce&&a.jsx("div",{className:"cbc-modal-overlay",onClick:()=>Pe(null),children:a.jsxs("div",{className:"cbc-modal",onClick:oe=>oe.stopPropagation(),children:[a.jsxs("h3",{className:"cbc-modal-title",children:['Remove "',Ce.label,'"?']}),a.jsx("p",{className:"cbc-modal-desc",children:"This will remove the habit from your daily tracker. Past logs won't be affected."}),a.jsxs("div",{className:"cbc-modal-actions",children:[a.jsx("button",{className:"cbc-modal-cancel",onClick:()=>Pe(null),children:"Keep"}),a.jsx("button",{className:"cbc-modal-delete",onClick:()=>Ce.type==="custom"?Ae(Ce.id):kt(Ce.key),children:"Remove"})]})]})}),T&&a.jsx(qg,{title:"All Habits Complete!",subtitle:Ot.current,stats:[{value:`${Fe}/${et.length}`,label:"Habits"},{value:$||1,label:"Day Streak"}],buttonLabel:"Keep Going",holdLabel:"Hold To Complete Today's Habits",shareType:"habits",hideShare:!p,onShareJourney:t?Jt:null,userName:t?.name,onDone:()=>{R(!1),M(!1)}}),fe&&a.jsx("div",{className:`toast-notification ${fe.type}`,children:fe.message})]})})}function md(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function Yw(s,e){return[s,e].sort().join("_")}function tL(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Xr(),{isDark:l,toggleTheme:u}=fa(),h=ir(),[p,g]=_.useState("buddies"),[y,b]=_.useState([]),[k,E]=_.useState([]),[O,H]=_.useState([]),[q,B]=_.useState(""),[K,$]=_.useState([]),[G,fe]=_.useState([]),[xe,be]=_.useState(!0),[j,T]=_.useState(null),[R,P]=_.useState(null),M=_.useCallback((se,D="info")=>{P({message:se,type:D}),setTimeout(()=>P(null),3500)},[]);_.useEffect(()=>{!i&&(!s||!e)&&h("/")},[s,e,i,h]);const L=_.useCallback(async()=>{if(t){be(!0);try{const se=t.id,ne=(await nn(wt(_e,"clients"))).docs.map(Be=>({id:Be.id,...Be.data()}));fe(ne);const ve=Object.fromEntries(ne.map(Be=>[Be.id,Be])),Ee=await nn(cn(wt(_e,"buddies"),At("user1","==",se))),Te=await nn(cn(wt(_e,"buddies"),At("user2","==",se))),Se=new Set;[...Ee.docs,...Te.docs].forEach(Be=>{const sn=Be.data(),Nn=sn.user1===se?sn.user2:sn.user1;Se.add(Nn)}),b(Array.from(Se).map(Be=>ve[Be]).filter(Boolean));const Ke=await nn(cn(wt(_e,"buddyRequests"),At("toId","==",se),At("status","==","pending")));E(Ke.docs.map(Be=>({reqId:Be.id,...Be.data(),fromClient:ve[Be.data().fromId]})).filter(Be=>Be.fromClient));const ct=await nn(cn(wt(_e,"buddyRequests"),At("fromId","==",se),At("status","==","pending")));H(ct.docs.map(Be=>({reqId:Be.id,...Be.data(),toClient:ve[Be.data().toId]})).filter(Be=>Be.toClient))}catch(se){console.error("Error fetching buddy data:",se),M("Failed to load buddies","error")}finally{be(!1)}}},[t,M]);_.useEffect(()=>{L()},[L]),_.useEffect(()=>{if(!q.trim()||!t){$([]);return}const se=q.toLowerCase(),D=t.id,ne=new Set(y.map(Se=>Se.id)),ve=new Set(O.map(Se=>Se.toId)),Ee=new Set(k.map(Se=>Se.fromId)),Te=G.filter(Se=>Se.id===D||!Se.name||!Se.coreBuddyAccess&&Se.clientType!=="core_buddy"?!1:Se.name.toLowerCase().includes(se)).map(Se=>({...Se,isBuddy:ne.has(Se.id),isPendingOut:ve.has(Se.id),isPendingIn:Ee.has(Se.id)})).slice(0,20);$(Te)},[q,G,y,O,k,t]);const A=async(se,D)=>{if(!(!t||se===t.id))try{await Kr(wt(_e,"notifications"),{toId:se,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:D,read:!1,createdAt:er()})}catch(ne){console.error("Notification error:",ne),ne.code==="permission-denied"&&M("Notifications blocked  check Firestore rules","error")}},Ve=async se=>{T(se);try{const D=`${t.id}_${se}`;await Ps(Ze(_e,"buddyRequests",D),{fromId:t.id,toId:se,status:"pending",createdAt:er()}),await A(se,"buddy_request"),M("Buddy request sent!","success"),await L()}catch(D){console.error("Error sending request:",D),M("Failed to send request","error")}finally{T(null)}},Qe=async se=>{T(se.reqId);try{const D=Yw(se.fromId,t.id);await Ps(Ze(_e,"buddies",D),{user1:[se.fromId,t.id].sort()[0],user2:[se.fromId,t.id].sort()[1],connectedAt:er()}),await jr(Ze(_e,"buddyRequests",se.reqId)),await A(se.fromId,"buddy_accept"),M("Buddy added!","success"),await L()}catch(D){console.error("Error accepting request:",D),M("Failed to accept","error")}finally{T(null)}},Z=async se=>{T(se.reqId);try{await jr(Ze(_e,"buddyRequests",se.reqId)),M("Request declined","info"),await L()}catch(D){console.error("Error declining:",D),M("Failed to decline","error")}finally{T(null)}},ue=async se=>{T(se.reqId);try{await jr(Ze(_e,"buddyRequests",se.reqId)),M("Request cancelled","info"),await L()}catch(D){console.error("Error cancelling:",D),M("Failed to cancel","error")}finally{T(null)}},Ce=async se=>{T(se);try{const D=Yw(t.id,se);await jr(Ze(_e,"buddies",D)),M("Buddy removed","info"),await L()}catch(D){console.error("Error removing buddy:",D),M("Failed to remove buddy","error")}finally{T(null)}},Pe=k.length;return i?a.jsx("div",{className:"bdy-loading",children:a.jsx("div",{className:"bdy-spinner"})}):!s||!e||!t?null:a.jsx(Xo,{children:a.jsxs("div",{className:"bdy-page","data-theme":l?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>h("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"bdy-main",children:[a.jsx("h1",{className:"bdy-title",children:"Buddies"}),a.jsxs("button",{className:"bdy-leaderboard-link",onClick:()=>h("/client/leaderboard"),children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C7 4 7 7 7 7"}),a.jsx("path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5C17 4 17 7 17 7"}),a.jsx("rect",{x:"6",y:"9",width:"12",height:"13",rx:"2"}),a.jsx("path",{d:"M12 9v13"}),a.jsx("path",{d:"M2 22h20"})]}),a.jsx("span",{children:"Leaderboard"}),a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"bdy-tabs",children:[a.jsxs("button",{className:`bdy-tab${p==="buddies"?" active":""}`,onClick:()=>g("buddies"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("span",{children:"My Buddies"})]}),a.jsxs("button",{className:`bdy-tab${p==="requests"?" active":""}`,onClick:()=>g("requests"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("line",{x1:"19",y1:"8",x2:"19",y2:"14"}),a.jsx("line",{x1:"22",y1:"11",x2:"16",y2:"11"})]}),a.jsx("span",{children:"Requests"}),Pe>0&&a.jsx("span",{className:"bdy-tab-badge",children:Pe})]}),a.jsxs("button",{className:`bdy-tab${p==="search"?" active":""}`,onClick:()=>g("search"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("span",{children:"Find"})]})]}),xe?a.jsx("div",{className:"bdy-content-loading",children:a.jsx("div",{className:"bdy-spinner"})}):a.jsxs(a.Fragment,{children:[p==="buddies"&&a.jsx("div",{className:"bdy-section",children:y.length===0?a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("h3",{children:"No buddies yet"}),a.jsx("p",{children:"Find members and send buddy requests to connect!"}),a.jsx("button",{className:"bdy-empty-btn",onClick:()=>g("search"),children:"Find Buddies"})]}):a.jsx("div",{className:"bdy-list",children:y.map(se=>a.jsxs("div",{className:"bdy-card",onClick:()=>h(`/client/core-buddy/profile/${se.id}`),children:[a.jsx("div",{className:"bdy-avatar",children:se.photoURL?a.jsx("img",{src:se.photoURL,alt:se.name}):a.jsx("span",{children:md(se.name)})}),a.jsx("div",{className:"bdy-card-info",children:a.jsx("span",{className:"bdy-card-name",children:se.name})}),a.jsx("button",{className:"bdy-remove-btn",onClick:D=>{D.stopPropagation(),Ce(se.id)},disabled:j===se.id,"aria-label":"Remove buddy",children:j===se.id?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},se.id))})}),p==="requests"&&a.jsxs("div",{className:"bdy-section",children:[k.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"bdy-section-title",children:"Incoming"}),a.jsx("div",{className:"bdy-list",children:k.map(se=>a.jsxs("div",{className:"bdy-card",children:[a.jsx("div",{className:"bdy-avatar",children:se.fromClient.photoURL?a.jsx("img",{src:se.fromClient.photoURL,alt:se.fromClient.name}):a.jsx("span",{children:md(se.fromClient.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:se.fromClient.name}),a.jsx("span",{className:"bdy-card-sub",children:"wants to be your buddy"})]}),a.jsxs("div",{className:"bdy-action-pair",children:[a.jsx("button",{className:"bdy-accept-btn",onClick:()=>Qe(se),disabled:j===se.reqId,children:j===se.reqId?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}),a.jsx("button",{className:"bdy-decline-btn",onClick:()=>Z(se),disabled:j===se.reqId,children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]},se.reqId))})]}),O.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"bdy-section-title",children:"Sent"}),a.jsx("div",{className:"bdy-list",children:O.map(se=>a.jsxs("div",{className:"bdy-card",children:[a.jsx("div",{className:"bdy-avatar",children:se.toClient?.photoURL?a.jsx("img",{src:se.toClient.photoURL,alt:se.toClient.name}):a.jsx("span",{children:md(se.toClient?.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:se.toClient?.name}),a.jsx("span",{className:"bdy-card-sub",children:"pending"})]}),a.jsx("button",{className:"bdy-cancel-btn",onClick:()=>ue(se),disabled:j===se.reqId,children:j===se.reqId?a.jsx("div",{className:"bdy-btn-spinner"}):"Cancel"})]},se.reqId))})]}),k.length===0&&O.length===0&&a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),a.jsx("h3",{children:"No pending requests"}),a.jsx("p",{children:"All caught up!"})]})]}),p==="search"&&a.jsxs("div",{className:"bdy-section",children:[a.jsxs("div",{className:"bdy-search-bar",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("input",{type:"text",placeholder:"Search by name...",value:q,onChange:se=>B(se.target.value),autoFocus:!0}),q&&a.jsx("button",{className:"bdy-search-clear",onClick:()=>B(""),children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),q.trim()&&K.length===0&&a.jsx("div",{className:"bdy-empty bdy-empty-sm",children:a.jsxs("p",{children:['No members found for "',q,'"']})}),K.length>0&&a.jsx("div",{className:"bdy-list",children:K.map(se=>a.jsxs("div",{className:"bdy-card",onClick:()=>h(`/client/core-buddy/profile/${se.id}`),children:[a.jsx("div",{className:"bdy-avatar",children:se.photoURL?a.jsx("img",{src:se.photoURL,alt:se.name}):a.jsx("span",{children:md(se.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:se.name}),se.isBuddy&&a.jsx("span",{className:"bdy-card-badge",children:"Buddy"})]}),se.isBuddy?a.jsx("span",{className:"bdy-status-icon",children:a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-success)",strokeWidth:"2.5",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}):se.isPendingOut?a.jsx("span",{className:"bdy-pending-label",children:"Pending"}):se.isPendingIn?a.jsx("button",{className:"bdy-accept-btn",onClick:D=>{D.stopPropagation();const ne=k.find(ve=>ve.fromId===se.id);ne&&Qe(ne)},disabled:!!j,children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}):a.jsx("button",{className:"bdy-add-btn",onClick:D=>{D.stopPropagation(),Ve(se.id)},disabled:j===se.id,children:j===se.id?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]},se.id))})]})]})]}),a.jsx(ui,{}),R&&a.jsxs("div",{className:`toast-notification ${R.type}`,children:[a.jsx("span",{className:"toast-icon",children:R.type==="success"?a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M5 13 L9 17 L19 7"})}):R.type==="error"?a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),a.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),a.jsx("span",{className:"toast-message",children:R.message})]})]})})}function pd(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function ng(s,e){return[s,e].sort().join("_")}const nL=5;function sg(s){return s.toISOString().split("T")[0]}function Qw(s){if(!s)return"";const e=s instanceof Date?s:s.toDate?s.toDate():new Date(s),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function sL(){const{userId:s}=gj(),{currentUser:e,isClient:t,clientData:i,loading:l}=Xr(),{isDark:u,toggleTheme:h}=fa(),p=ir(),[g,y]=_.useState(null),[b,k]=_.useState("none"),[E,O]=_.useState(null),[H,q]=_.useState(!0),[B,K]=_.useState(!1),[$,G]=_.useState(null),[fe,xe]=_.useState([]),[be,j]=_.useState(!1),[T,R]=_.useState(new Set),[P,M]=_.useState(new Set),[L,A]=_.useState({}),[Ve,Qe]=_.useState({}),[Z,ue]=_.useState({}),[Ce,Pe]=_.useState(!0),[se,D]=_.useState(0),[ne,ve]=_.useState(0),[Ee,Te]=_.useState(0),[Se,Ke]=_.useState([]),[ct,Be]=_.useState(!1),[sn,Nn]=_.useState(null),[Un,Ot]=_.useState([]),rt=_.useCallback((re,Ae="info")=>{G({message:re,type:Ae}),setTimeout(()=>G(null),3500)},[]);_.useEffect(()=>{!l&&(!e||!t)&&p("/")},[e,t,l,p]),_.useEffect(()=>{i&&s&&i.id===s&&p("/client/core-buddy",{replace:!0})},[i,s,p]),_.useEffect(()=>{if(!i||!s||i.id===s)return;let re=!1;return(async()=>{q(!0);try{const bt=(await nn(wt(_e,"clients"))).docs.map(Fe=>({id:Fe.id,...Fe.data()})).find(Fe=>Fe.id===s);if(!bt){re||q(!1);return}re||y(bt);const it=i.id,$e=ng(it,s);if((await pr(Ze(_e,"buddies",$e))).exists())re||k("buddy");else{const Fe=`${it}_${s}`,an=await pr(Ze(_e,"buddyRequests",Fe));if(an.exists()&&an.data().status==="pending")re||(k("pending_out"),O(Fe));else{const un=`${s}_${it}`,Ln=await pr(Ze(_e,"buddyRequests",un));Ln.exists()&&Ln.data().status==="pending"?re||(k("pending_in"),O(un)):re||k("none")}}}catch(Ae){console.error("Error loading profile:",Ae)}finally{re||q(!1)}})(),()=>{re=!0}},[i,s]),_.useEffect(()=>{if(!s||!g)return;let re=!1;return(async()=>{Pe(!0);try{const Ae=await nn(cn(wt(_e,"workoutLogs"),At("clientId","==",s)));if(re)return;const kt=Ae.docs.length;D(kt);let bt=0;const it=Ae.docs.map(st=>st.data().date).filter(Boolean).sort().reverse();if(it.length>0){const st=new Date;let Fe=new Date(st);for(let an=0;an<52;an++){const un=new Date(Fe),Ln=un.getDay(),zn=Ln===0?6:Ln-1;un.setDate(un.getDate()-zn),un.setHours(0,0,0,0);const Xn=new Date(un);Xn.setDate(Xn.getDate()+7);const Qt=sg(un),Fn=sg(Xn);if(it.some(hn=>hn>=Qt&&hn<Fn))bt++;else{if(an>0)break;break}Fe.setDate(Fe.getDate()-7)}}re||ve(bt);let $e=0;for(let st=0;st<30;st++){const Fe=new Date;Fe.setDate(Fe.getDate()-st);const an=sg(Fe);try{const un=await nn(cn(wt(_e,"habitLogs"),At("clientId","==",s),At("date","==",an)));if(un.empty)break;{const Ln=un.docs[0].data().habits||{};if(Object.values(Ln).filter(Boolean).length>=nL)$e++;else break}}catch{break}}re||Te($e)}catch(Ae){console.error("Error loading buddy stats:",Ae)}finally{re||Pe(!1)}})(),()=>{re=!0}},[s,g]),_.useEffect(()=>{if(!i)return;const re=i.id;(async()=>{try{const[Ae,kt,bt]=await Promise.all([nn(cn(wt(_e,"buddies"),At("user1","==",re))),nn(cn(wt(_e,"buddies"),At("user2","==",re))),nn(wt(_e,"clients"))]),it=new Set;[...Ae.docs,...kt.docs].forEach(st=>{const Fe=st.data();it.add(Fe.user1===re?Fe.user2:Fe.user1)});const $e={};bt.docs.forEach(st=>{$e[st.id]=st.data()}),Ke(Array.from(it).filter(st=>$e[st]).map(st=>({id:st,name:$e[st].name,photoURL:$e[st].photoURL||null})))}catch(Ae){console.error("Error loading buddies for mentions:",Ae)}})()},[i]);const gt=async(re,Ae,kt={})=>{if(!(!i||re===i.id))try{await Kr(wt(_e,"notifications"),{toId:re,fromId:i.id,fromName:i.name||"Someone",fromPhotoURL:i.photoURL||null,type:Ae,read:!1,createdAt:er(),...kt})}catch(bt){console.error("Notification error:",bt),bt.code==="permission-denied"&&rt("Notifications blocked  check Firestore rules","error")}},ut=async()=>{K(!0);try{const re=`${i.id}_${s}`;await Ps(Ze(_e,"buddyRequests",re),{fromId:i.id,toId:s,status:"pending",createdAt:er()}),await gt(s,"buddy_request"),k("pending_out"),O(re),rt("Buddy request sent!","success")}catch(re){console.error(re),rt("Failed to send request","error")}finally{K(!1)}},Bn=async()=>{if(E){K(!0);try{const re=ng(i.id,s);await Ps(Ze(_e,"buddies",re),{user1:[i.id,s].sort()[0],user2:[i.id,s].sort()[1],connectedAt:er()}),await jr(Ze(_e,"buddyRequests",E)),await gt(s,"buddy_accept"),k("buddy"),rt("Buddy added!","success")}catch(re){console.error(re),rt("Failed to accept","error")}finally{K(!1)}}},he=async()=>{if(E){K(!0);try{await jr(Ze(_e,"buddyRequests",E)),k("none"),rt(b==="pending_out"?"Request cancelled":"Request declined","info")}catch(re){console.error(re),rt("Failed","error")}finally{K(!1)}}},Dt=async()=>{K(!0);try{const re=ng(i.id,s);await jr(Ze(_e,"buddies",re)),k("none"),rt("Buddy removed","info")}catch(re){console.error(re),rt("Failed to remove","error")}finally{K(!1)}},yt=_.useCallback(async()=>{if(s){j(!0);try{const re=await nn(cn(wt(_e,"posts"),At("authorId","==",s),_u("createdAt","desc"),xu(30)));if(xe(re.docs.map(Ae=>({id:Ae.id,...Ae.data()}))),i){const Ae=await nn(cn(wt(_e,"postLikes"),At("userId","==",i.id)));R(new Set(Ae.docs.map(kt=>kt.data().postId)))}}catch(re){console.error("Error loading journey:",re)}finally{j(!1)}}},[s,i]);_.useEffect(()=>{!H&&g&&yt()},[H,g,yt]);const Bt=async re=>{if(window.confirm("Delete this post?"))try{await jr(Ze(_e,"posts",re)),xe(Ae=>Ae.filter(kt=>kt.id!==re)),rt("Post deleted","info")}catch(Ae){console.error("Delete error:",Ae),rt("Failed to delete","error")}},et=async re=>{if(!i)return;const Ae=i.id,kt=`${re}_${Ae}`,bt=T.has(re),it=new Set(T);bt?it.delete(re):it.add(re),R(it),xe($e=>$e.map(st=>st.id===re?{...st,likeCount:Math.max(0,(st.likeCount||0)+(bt?-1:1))}:st));try{if(bt)await jr(Ze(_e,"postLikes",kt)),await js(Ze(_e,"posts",re),{likeCount:Ao(-1)});else{await Ps(Ze(_e,"postLikes",kt),{postId:re,userId:Ae,createdAt:er()}),await js(Ze(_e,"posts",re),{likeCount:Ao(1)});const $e=fe.find(st=>st.id===re);$e&&gt($e.authorId,"like",{postId:re})}}catch($e){console.error("Like error:",$e),yt()}},It=async re=>{try{const Ae=await nn(cn(wt(_e,"postComments"),At("postId","==",re),_u("createdAt","asc"),xu(50)));A(kt=>({...kt,[re]:Ae.docs.map(bt=>({id:bt.id,...bt.data()}))}))}catch(Ae){console.error("Error loading comments:",Ae)}},vt=re=>{const Ae=new Set(P);Ae.has(re)?Ae.delete(re):(Ae.add(re),L[re]||It(re)),M(Ae)},rn=(re,Ae)=>{const kt=re.match(/@(\w*)$/);if(kt){Be(!0),Nn(Ae);const bt=Se.filter(it=>it.name&&it.name.toLowerCase().includes(kt[1].toLowerCase())).slice(0,5);Ot(bt)}else Be(!1),Ot([])},Cs=(re,Ae)=>{const bt=(Ve[Ae]||"").replace(/@\w*$/,`@${re.name} `);Qe(it=>({...it,[Ae]:bt})),Be(!1),Ot([])},rs=(re,Ae)=>{Qe(kt=>({...kt,[re]:Ae})),rn(Ae,re)},Jt=async re=>{const Ae=(Ve[re]||"").trim();if(!(!Ae||!i)){ue(kt=>({...kt,[re]:!0}));try{await Kr(wt(_e,"postComments"),{postId:re,authorId:i.id,authorName:i.name||"Unknown",authorPhotoURL:i.photoURL||null,content:Ae,createdAt:er()}),await js(Ze(_e,"posts",re),{commentCount:Ao(1)});const kt=fe.find(it=>it.id===re);kt&&gt(kt.authorId,"comment",{postId:re});const bt=Ae.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(bt){const it=new Set;bt.forEach($e=>{const st=$e.slice(1).trim(),Fe=Se.find(an=>an.name&&an.name.toLowerCase()===st.toLowerCase());Fe&&!it.has(Fe.id)&&(it.add(Fe.id),gt(Fe.id,"mention",{postId:re}))})}Qe(it=>({...it,[re]:""})),xe(it=>it.map($e=>$e.id===re?{...$e,commentCount:($e.commentCount||0)+1}:$e)),await It(re)}catch(kt){console.error("Comment error:",kt),rt("Failed to comment","error")}finally{ue(kt=>({...kt,[re]:!1}))}}};return l||H||!i?a.jsx("div",{className:"prf-loading","data-theme":u?"dark":"light",children:a.jsx("div",{className:"prf-spinner"})}):!e||!t?null:g?a.jsx(Xo,{children:a.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:h,"aria-label":"Toggle theme",children:u?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"prf-main",children:[a.jsxs("div",{className:"prf-hero",children:[a.jsx("div",{className:"prf-avatar-lg",children:g.photoURL?a.jsx("img",{src:g.photoURL,alt:g.name}):a.jsx("span",{children:pd(g.name)})}),a.jsx("h1",{className:"prf-name",children:g.name}),a.jsxs("div",{className:"prf-buddy-action",children:[b==="none"&&a.jsx("button",{className:"prf-btn prf-btn-primary",onClick:ut,disabled:B,children:B?a.jsx("div",{className:"prf-btn-spinner"}):a.jsxs(a.Fragment,{children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Buddy"]})}),b==="pending_out"&&a.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:he,disabled:B,children:B?a.jsx("div",{className:"prf-btn-spinner dark"}):"Cancel Request"}),b==="pending_in"&&a.jsxs("div",{className:"prf-btn-pair",children:[a.jsx("button",{className:"prf-btn prf-btn-success",onClick:Bn,disabled:B,children:B?a.jsx("div",{className:"prf-btn-spinner"}):"Accept"}),a.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:he,disabled:B,children:"Decline"})]}),b==="buddy"&&a.jsx("button",{className:"prf-btn prf-btn-danger",onClick:Dt,disabled:B,children:B?a.jsx("div",{className:"prf-btn-spinner"}):"Remove Buddy"})]})]}),Ce?a.jsx("div",{className:"prf-stats-loading",children:a.jsx("div",{className:"prf-spinner"})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"prf-stats",children:[a.jsxs("div",{className:"prf-stat",children:[a.jsx("span",{className:"prf-stat-value",children:se}),a.jsx("span",{className:"prf-stat-label",children:"Workouts"})]}),a.jsxs("div",{className:"prf-stat",children:[a.jsxs("span",{className:"prf-stat-value",children:[ne,a.jsx("span",{className:"prf-stat-unit",children:"wk"})]}),a.jsx("span",{className:"prf-stat-label",children:"Streak"})]})]}),Ee>0&&a.jsx("div",{className:"prf-info-row",children:a.jsxs("div",{className:"prf-info-card info-habit",children:[a.jsx("div",{className:"prf-info-icon",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]})}),a.jsxs("div",{className:"prf-info-text",children:[a.jsxs("span",{className:"prf-info-value",children:[Ee," day",Ee!==1?"s":""]}),a.jsx("span",{className:"prf-info-sub",children:"Habit Streak"})]})]})})]}),a.jsxs("div",{className:"prf-section",children:[a.jsx("h2",{className:"prf-section-title",children:`${g.name?.split(" ")[0]}'s Journey`}),be?a.jsx("div",{className:"journey-loading",children:a.jsx("div",{className:"prf-spinner"})}):fe.length===0?a.jsxs("div",{className:"journey-empty",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("p",{children:"No posts yet"})]}):a.jsx("div",{className:"journey-list",children:fe.map(re=>a.jsxs("div",{className:"journey-post",children:[a.jsxs("div",{className:"journey-post-header",children:[a.jsx("div",{className:"journey-post-avatar",children:re.authorPhotoURL?a.jsx("img",{src:re.authorPhotoURL,alt:""}):a.jsx("span",{children:pd(re.authorName)})}),a.jsxs("div",{className:"journey-post-meta",children:[a.jsx("span",{className:"journey-post-name",children:re.authorName}),a.jsx("span",{className:"journey-post-time",children:Qw(re.createdAt)})]}),re.authorId===i.id&&a.jsx("button",{className:"journey-delete-btn",onClick:()=>Bt(re.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),re.type==="workout_summary"&&re.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:re.metadata.title}),re.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:re.metadata.stats.map(Ae=>`${Ae.value} ${Ae.label}`).join("    ")}),!re.metadata.stats?.length&&re.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:re.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed a workout using Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):re.type==="badge_earned"&&re.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame journey-card-logo-badge",children:a.jsx("img",{src:"/Logo.webp",alt:re.metadata.title,className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:re.metadata.title}),re.metadata.badgeDesc&&a.jsx("p",{className:"journey-card-stats-line",children:re.metadata.badgeDesc}),a.jsx("p",{className:"journey-card-cta",children:"I just earned a badge on Core Buddy"}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):re.type==="habits_summary"&&re.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:re.metadata.title}),re.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:re.metadata.stats.map(Ae=>`${Ae.value} ${Ae.label}`).join("    ")}),re.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:re.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed my daily habits with Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):a.jsxs(a.Fragment,{children:[re.content&&a.jsx("p",{className:"journey-post-content",children:re.content}),re.imageURL&&a.jsx("div",{className:"journey-post-image",children:a.jsx("img",{src:re.imageURL,alt:"Post",loading:"lazy"})})]}),a.jsxs("div",{className:"journey-post-actions",children:[a.jsxs("button",{className:`journey-action-btn${T.has(re.id)?" liked":""}`,onClick:()=>et(re.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:T.has(re.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:re.likeCount||0})]}),a.jsxs("button",{className:`journey-action-btn${P.has(re.id)?" active":""}`,onClick:()=>vt(re.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:re.commentCount||0})]})]}),P.has(re.id)&&a.jsxs("div",{className:"journey-comments",children:[L[re.id]?.length>0?L[re.id].map(Ae=>a.jsxs("div",{className:"journey-comment",children:[a.jsx("div",{className:"journey-comment-avatar",onClick:()=>p(`/client/core-buddy/profile/${Ae.authorId}`),children:Ae.authorPhotoURL?a.jsx("img",{src:Ae.authorPhotoURL,alt:""}):a.jsx("span",{children:pd(Ae.authorName)})}),a.jsxs("div",{className:"journey-comment-body",children:[a.jsxs("div",{className:"journey-comment-bubble",children:[a.jsx("span",{className:"journey-comment-name",children:Ae.authorName}),a.jsx("span",{className:"journey-comment-text",children:Ae.content})]}),a.jsx("span",{className:"journey-comment-time",children:Qw(Ae.createdAt)})]})]},Ae.id)):a.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),a.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[a.jsx("input",{type:"text",placeholder:"Comment... (@ to mention)",value:Ve[re.id]||"",onChange:Ae=>rs(re.id,Ae.target.value),onKeyDown:Ae=>{Ae.key==="Enter"&&Jt(re.id)},maxLength:300}),ct&&sn===re.id&&Un.length>0&&a.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:Un.map(Ae=>a.jsxs("button",{className:"mention-option",onClick:()=>Cs(Ae,re.id),children:[a.jsx("div",{className:"mention-option-avatar",children:Ae.photoURL?a.jsx("img",{src:Ae.photoURL,alt:""}):a.jsx("span",{children:pd(Ae.name)})}),a.jsx("span",{children:Ae.name})]},Ae.id))}),a.jsx("button",{onClick:()=>Jt(re.id),disabled:!(Ve[re.id]||"").trim()||Z[re.id],children:Z[re.id]?a.jsx("div",{className:"journey-btn-spinner-sm"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),a.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},re.id))})]})]}),a.jsx(ui,{}),$&&a.jsxs("div",{className:`toast-notification ${$.type}`,children:[a.jsx("span",{className:"toast-icon",children:$.type==="success"?a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M5 13 L9 17 L19 7"})}):$.type==="error"?a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),a.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),a.jsx("span",{className:"toast-message",children:$.message})]})]})}):a.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions"})]})}),a.jsx("main",{className:"prf-main",children:a.jsx("p",{style:{textAlign:"center",color:"var(--text-tertiary)",padding:"40px 0"},children:"User not found"})}),a.jsx(ui,{})]})}const rg=[{text:"Build your dashboard...",bold:"your way"},{text:"Pick what matters to you...",bold:"nothing else"},{text:"Your goals, your layout...",bold:"your rules"}],Xw=[{id:"stats",label:"Stats Rings",desc:"Programme %, workouts this week, habits today",icon:"rings",defaultOn:!0},{id:"workouts",label:"Workouts",desc:"Sessions this week and total count",icon:"dumbbell",defaultOn:!0},{id:"habits",label:"Habits",desc:"Daily habit tracker dots",icon:"check",defaultOn:!0},{id:"pbs",label:"Personal Bests",desc:"Your top lifts at a glance",icon:"trophy"},{id:"nutrition",label:"Nutrition",desc:"Macro rings  protein, carbs, fats, cals",icon:"apple"},{id:"leaderboard",label:"Leaderboard",desc:"See where you rank among buddies",icon:"podium"},{id:"journey",label:"Journey",desc:"Your posts, likes and comments feed",icon:"feed"},{id:"coach",label:"Coach Message",desc:"Motivational nudge from Buddy",icon:"message",defaultOn:!0},{id:"nudge",label:"Smart Nudge",desc:"Contextual reminder of what to do next",icon:"lightbulb"}];function rL(s){switch(s){case"rings":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("circle",{cx:"12",cy:"12",r:"6"}),a.jsx("circle",{cx:"12",cy:"12",r:"2"})]});case"dumbbell":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M6.5 6.5h11v11h-11z",strokeLinejoin:"round"}),a.jsx("line",{x1:"2",y1:"12",x2:"6.5",y2:"12"}),a.jsx("line",{x1:"17.5",y1:"12",x2:"22",y2:"12"})]});case"check":return a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})});case"trophy":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M6 9H3V6a1 1 0 0 1 1-1h2M18 9h3V6a1 1 0 0 0-1-1h-2"}),a.jsx("path",{d:"M6 5h12v7a6 6 0 0 1-12 0V5z"}),a.jsx("path",{d:"M9 21h6"}),a.jsx("path",{d:"M12 17v4"})]});case"apple":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M12 3c-1.5 0-3 1-3 1s-3-.5-4.5 1.5S3 9 3 12s1.5 6 3 8 3 3 6 3 4.5-1 6-3 3-5 3-8-1.5-4-3-6.5S13.5 3 12 3z"}),a.jsx("path",{d:"M12 3c0 0 1-2 3-2"})]});case"podium":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"2",y:"14",width:"6",height:"8",rx:"1"}),a.jsx("rect",{x:"9",y:"8",width:"6",height:"14",rx:"1"}),a.jsx("rect",{x:"16",y:"11",width:"6",height:"11",rx:"1"})]});case"medal":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"15",r:"6"}),a.jsx("path",{d:"M8.21 13.89L7 2h10l-1.21 11.89"})]});case"feed":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"3"}),a.jsx("line",{x1:"3",y1:"9",x2:"21",y2:"9"}),a.jsx("line",{x1:"3",y1:"15",x2:"21",y2:"15"})]});case"message":return a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})});case"lightbulb":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 18h6"}),a.jsx("path",{d:"M10 22h4"}),a.jsx("path",{d:"M12 2a7 7 0 0 0-4 12.7V17h8v-2.3A7 7 0 0 0 12 2z"})]});default:return null}}function iL(){const s=ir(),{clientData:e,currentUser:t,updateClientData:i,resolveClient:l}=Xr(),[u,h]=_.useState({hours:0,minutes:0,seconds:0}),[p,g]=_.useState(0),[y,b]=_.useState(0),[k,E]=_.useState(null),[O,H]=_.useState(!1),q=_.useRef(null),[B,K]=_.useState(()=>{const L=e?.dashboardWidgets;return L&&Array.isArray(L)?L:Xw.filter(A=>A.defaultOn).map(A=>A.id)}),[$,G]=_.useState(!1),[fe,xe]=_.useState(!1),[be,j]=_.useState(null);_.useEffect(()=>{e?.photoURL&&E(e.photoURL)},[e?.photoURL]),_.useEffect(()=>{const L=()=>{const Ve=new Date,Qe=new Date(Ve);Qe.setHours(23,59,59,999);const Z=Qe-Ve;h({hours:Math.floor(Z/36e5),minutes:Math.floor(Z%36e5/6e4),seconds:Math.floor(Z%6e4/1e3)}),g(60-Math.floor(Z%6e4/1e3))};L();const A=setInterval(L,1e3);return()=>clearInterval(A)},[]),_.useEffect(()=>{const L=setInterval(()=>b(A=>(A+1)%rg.length),8e3);return()=>clearInterval(L)},[]);const T=async L=>{const A=L.target.files?.[0];if(!(!A||!e?.id)){H(!0);try{const Ve=Wa(Ga,`profilePhotos/${e.id}`);await Nd(Ve,A);const Qe=await Lo(Ve);await js(Ze(_e,"clients",e.id),{photoURL:Qe}),E(Qe),i({photoURL:Qe})}catch(Ve){console.error("Photo upload error:",Ve)}finally{H(!1)}}},R=L=>{xe(!1),K(A=>A.includes(L)?A.filter(Ve=>Ve!==L):[...A,L])},P=(L,A)=>{xe(!1),K(Ve=>{const Qe=Ve.indexOf(L);if(Qe<0)return Ve;const Z=Qe+A;if(Z<0||Z>=Ve.length)return Ve;const ue=[...Ve];return[ue[Qe],ue[Z]]=[ue[Z],ue[Qe]],ue})},M=async()=>{G(!0),j(null);try{const L=e||await l();if(!L?.id){j("Could not find your profile. Try refreshing."),G(!1);return}await js(Ze(_e,"clients",L.id),{dashboardWidgets:B}),i({dashboardWidgets:B}),xe(!0)}catch(L){console.error("Save config error:",L),j("Save failed  please try again.")}finally{G(!1)}};return a.jsx(Xo,{children:a.jsxs("div",{className:"bldr-page",children:[a.jsxs("div",{className:"bldr-container",children:[a.jsxs("div",{className:"bldr-header",children:[a.jsx("button",{className:"bldr-back",onClick:()=>s("/client/core-buddy"),children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("h1",{className:"bldr-title",children:"Build Your Dashboard"})]}),a.jsxs("div",{className:"bldr-ring-container",children:[a.jsxs("div",{className:"bldr-ring",children:[a.jsx("svg",{className:"bldr-ring-svg",viewBox:"0 0 200 200",children:_E.map((L,A)=>a.jsx("line",{x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,className:`bldr-tick ${A<p?"elapsed":"remaining"}`,strokeWidth:L.thick?"3":"2"},A))}),a.jsxs("div",{className:"bldr-ring-center",children:[a.jsxs("div",{className:"bldr-ring-photo",onClick:()=>q.current?.click(),children:[a.jsx("img",{src:k||"/Logo.webp",alt:k?"Profile":"Mind Core Fitness"}),a.jsx("div",{className:`bldr-photo-overlay${O?" uploading":""}`,children:O?a.jsx("div",{className:"bldr-photo-spinner"}):a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),a.jsx("input",{ref:q,type:"file",accept:"image/*",onChange:T,style:{display:"none"}})]}),!k&&!O&&a.jsx("div",{className:"bldr-photo-badge",onClick:()=>q.current?.click(),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),a.jsxs("div",{className:"bldr-countdown",children:[a.jsx("span",{className:"bldr-timer-digit",children:String(u.hours).padStart(2,"0")}),a.jsx("span",{className:"bldr-timer-colon",children:":"}),a.jsx("span",{className:"bldr-timer-digit",children:String(u.minutes).padStart(2,"0")}),a.jsx("span",{className:"bldr-timer-colon",children:":"}),a.jsx("span",{className:"bldr-timer-digit bldr-timer-sec",children:String(u.seconds).padStart(2,"0")})]}),a.jsx("span",{className:"bldr-ring-label",children:"remaining today"}),a.jsxs("p",{className:"bldr-tagline",children:[rg[y].text," ",a.jsx("strong",{children:rg[y].bold})]})]}),a.jsxs("div",{className:"bldr-section",children:[a.jsx("h2",{className:"bldr-section-title",children:"Choose Your Widgets"}),a.jsx("p",{className:"bldr-section-desc",children:"The countdown ring and your profile always stay at the top. Pick what goes below."}),a.jsx("div",{className:"bldr-widgets-list",children:Xw.map(L=>{const A=B.includes(L.id),Ve=B.indexOf(L.id);return a.jsxs("div",{className:`bldr-widget-card${A?" active":""}`,children:[a.jsx("div",{className:"bldr-widget-icon",children:rL(L.icon)}),a.jsxs("div",{className:"bldr-widget-info",children:[a.jsx("div",{className:"bldr-widget-label",children:L.label}),a.jsx("div",{className:"bldr-widget-desc",children:L.desc})]}),a.jsxs("div",{className:"bldr-widget-actions",children:[A&&a.jsxs("div",{className:"bldr-widget-order",children:[a.jsx("button",{className:"bldr-order-btn",onClick:()=>P(L.id,-1),disabled:Ve===0,"aria-label":"Move up",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M18 15l-6-6-6 6"})})}),a.jsx("span",{className:"bldr-order-num",children:Ve+1}),a.jsx("button",{className:"bldr-order-btn",onClick:()=>P(L.id,1),disabled:Ve===B.length-1,"aria-label":"Move down",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M6 9l6 6 6-6"})})})]}),a.jsx("button",{className:`bldr-toggle${A?" on":""}`,onClick:()=>R(L.id),"aria-label":A?`Remove ${L.label}`:`Add ${L.label}`,children:a.jsx("div",{className:"bldr-toggle-thumb"})})]})]},L.id)})})]}),a.jsxs("div",{className:"bldr-save-wrap",children:[a.jsx("button",{className:`bldr-save-btn${fe?" saved":""}`,onClick:M,disabled:$||fe,children:$?"Saving...":fe?"Saved":"Save Dashboard"}),be&&a.jsx("p",{className:"bldr-save-error",children:be}),fe&&a.jsx("button",{className:"bldr-view-btn",onClick:()=>s("/client/core-buddy"),children:"View Dashboard"})]})]}),a.jsx(ui,{active:"home"})]})})}const xE="@firebase/installations",d0="0.6.19";const kE=1e4,EE=`w:${d0}`,TE="FIS_v2",aL="https://firebaseinstallations.googleapis.com/v1",oL=3600*1e3,lL="installations",cL="Installations";const uL={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Fo=new Ho(lL,cL,uL);function SE(s){return s instanceof di&&s.code.includes("request-failed")}function jE({projectId:s}){return`${aL}/projects/${s}/installations`}function CE(s){return{token:s.token,requestStatus:2,expiresIn:dL(s.expiresIn),creationTime:Date.now()}}async function NE(s,e){const i=(await e.json()).error;return Fo.create("request-failed",{requestName:s,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function AE({apiKey:s}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":s})}function hL(s,{refreshToken:e}){const t=AE(s);return t.append("Authorization",fL(e)),t}async function RE(s){const e=await s();return e.status>=500&&e.status<600?s():e}function dL(s){return Number(s.replace("s","000"))}function fL(s){return`${TE} ${s}`}async function mL({appConfig:s,heartbeatServiceProvider:e},{fid:t}){const i=jE(s),l=AE(s),u=e.getImmediate({optional:!0});if(u){const y=await u.getHeartbeatsHeader();y&&l.append("x-firebase-client",y)}const h={fid:t,authVersion:TE,appId:s.appId,sdkVersion:EE},p={method:"POST",headers:l,body:JSON.stringify(h)},g=await RE(()=>fetch(i,p));if(g.ok){const y=await g.json();return{fid:y.fid||t,registrationStatus:2,refreshToken:y.refreshToken,authToken:CE(y.authToken)}}else throw await NE("Create Installation",g)}function IE(s){return new Promise(e=>{setTimeout(e,s)})}function pL(s){return btoa(String.fromCharCode(...s)).replace(/\+/g,"-").replace(/\//g,"_")}const gL=/^[cdef][\w-]{21}$/,$g="";function yL(){try{const s=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(s),s[0]=112+s[0]%16;const t=vL(s);return gL.test(t)?t:$g}catch{return $g}}function vL(s){return pL(s).substr(0,22)}function jf(s){return`${s.appName}!${s.appId}`}const DE=new Map;function ME(s,e){const t=jf(s);LE(t,e),bL(t,e)}function LE(s,e){const t=DE.get(s);if(t)for(const i of t)i(e)}function bL(s,e){const t=wL();t&&t.postMessage({key:s,fid:e}),_L()}let Ro=null;function wL(){return!Ro&&"BroadcastChannel"in self&&(Ro=new BroadcastChannel("[Firebase] FID Change"),Ro.onmessage=s=>{LE(s.data.key,s.data.fid)}),Ro}function _L(){DE.size===0&&Ro&&(Ro.close(),Ro=null)}const xL="firebase-installations-database",kL=1,qo="firebase-installations-store";let ig=null;function f0(){return ig||(ig=tf(xL,kL,{upgrade:(s,e)=>{e===0&&s.createObjectStore(qo)}})),ig}async function Xd(s,e){const t=jf(s),l=(await f0()).transaction(qo,"readwrite"),u=l.objectStore(qo),h=await u.get(t);return await u.put(e,t),await l.done,(!h||h.fid!==e.fid)&&ME(s,e.fid),e}async function OE(s){const e=jf(s),i=(await f0()).transaction(qo,"readwrite");await i.objectStore(qo).delete(e),await i.done}async function Cf(s,e){const t=jf(s),l=(await f0()).transaction(qo,"readwrite"),u=l.objectStore(qo),h=await u.get(t),p=e(h);return p===void 0?await u.delete(t):await u.put(p,t),await l.done,p&&(!h||h.fid!==p.fid)&&ME(s,p.fid),p}async function m0(s){let e;const t=await Cf(s.appConfig,i=>{const l=EL(i),u=TL(s,l);return e=u.registrationPromise,u.installationEntry});return t.fid===$g?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function EL(s){const e=s||{fid:yL(),registrationStatus:0};return PE(e)}function TL(s,e){if(e.registrationStatus===0){if(!navigator.onLine){const l=Promise.reject(Fo.create("app-offline"));return{installationEntry:e,registrationPromise:l}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=SL(s,t);return{installationEntry:t,registrationPromise:i}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:jL(s)}:{installationEntry:e}}async function SL(s,e){try{const t=await mL(s,e);return Xd(s.appConfig,t)}catch(t){throw SE(t)&&t.customData.serverCode===409?await OE(s.appConfig):await Xd(s.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function jL(s){let e=await Jw(s.appConfig);for(;e.registrationStatus===1;)await IE(100),e=await Jw(s.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:i}=await m0(s);return i||t}return e}function Jw(s){return Cf(s,e=>{if(!e)throw Fo.create("installation-not-found");return PE(e)})}function PE(s){return CL(s)?{fid:s.fid,registrationStatus:0}:s}function CL(s){return s.registrationStatus===1&&s.registrationTime+kE<Date.now()}async function NL({appConfig:s,heartbeatServiceProvider:e},t){const i=AL(s,t),l=hL(s,t),u=e.getImmediate({optional:!0});if(u){const y=await u.getHeartbeatsHeader();y&&l.append("x-firebase-client",y)}const h={installation:{sdkVersion:EE,appId:s.appId}},p={method:"POST",headers:l,body:JSON.stringify(h)},g=await RE(()=>fetch(i,p));if(g.ok){const y=await g.json();return CE(y)}else throw await NE("Generate Auth Token",g)}function AL(s,{fid:e}){return`${jE(s)}/${e}/authTokens:generate`}async function p0(s,e=!1){let t;const i=await Cf(s.appConfig,u=>{if(!VE(u))throw Fo.create("not-registered");const h=u.authToken;if(!e&&DL(h))return u;if(h.requestStatus===1)return t=RL(s,e),u;{if(!navigator.onLine)throw Fo.create("app-offline");const p=LL(u);return t=IL(s,p),p}});return t?await t:i.authToken}async function RL(s,e){let t=await Zw(s.appConfig);for(;t.authToken.requestStatus===1;)await IE(100),t=await Zw(s.appConfig);const i=t.authToken;return i.requestStatus===0?p0(s,e):i}function Zw(s){return Cf(s,e=>{if(!VE(e))throw Fo.create("not-registered");const t=e.authToken;return OL(t)?{...e,authToken:{requestStatus:0}}:e})}async function IL(s,e){try{const t=await NL(s,e),i={...e,authToken:t};return await Xd(s.appConfig,i),t}catch(t){if(SE(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await OE(s.appConfig);else{const i={...e,authToken:{requestStatus:0}};await Xd(s.appConfig,i)}throw t}}function VE(s){return s!==void 0&&s.registrationStatus===2}function DL(s){return s.requestStatus===2&&!ML(s)}function ML(s){const e=Date.now();return e<s.creationTime||s.creationTime+s.expiresIn<e+oL}function LL(s){const e={requestStatus:1,requestTime:Date.now()};return{...s,authToken:e}}function OL(s){return s.requestStatus===1&&s.requestTime+kE<Date.now()}async function PL(s){const e=s,{installationEntry:t,registrationPromise:i}=await m0(e);return i?i.catch(console.error):p0(e).catch(console.error),t.fid}async function VL(s,e=!1){const t=s;return await UL(t),(await p0(t,e)).token}async function UL(s){const{registrationPromise:e}=await m0(s);e&&await e}function BL(s){if(!s||!s.options)throw ag("App Configuration");if(!s.name)throw ag("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!s.options[t])throw ag(t);return{appName:s.name,projectId:s.options.projectId,apiKey:s.options.apiKey,appId:s.options.appId}}function ag(s){return Fo.create("missing-app-config-values",{valueName:s})}const UE="installations",zL="installations-internal",FL=s=>{const e=s.getProvider("app").getImmediate(),t=BL(e),i=$o(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},qL=s=>{const e=s.getProvider("app").getImmediate(),t=$o(e,UE).getImmediate();return{getId:()=>PL(t),getToken:l=>VL(t,l)}};function HL(){oi(new Qr(UE,FL,"PUBLIC")),oi(new Qr(zL,qL,"PRIVATE"))}HL();gr(xE,d0);gr(xE,d0,"esm2020");const $L="/firebase-messaging-sw.js",WL="/firebase-cloud-messaging-push-scope",BE="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",GL="https://fcmregistrations.googleapis.com/v1",zE="google.c.a.c_id",KL="google.c.a.c_l",YL="google.c.a.ts",QL="google.c.a.e",e_=1e4;var t_;(function(s){s[s.DATA_MESSAGE=1]="DATA_MESSAGE",s[s.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(t_||(t_={}));var ku;(function(s){s.PUSH_RECEIVED="push-received",s.NOTIFICATION_CLICKED="notification-clicked"})(ku||(ku={}));function Xi(s){const e=new Uint8Array(s);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function XL(s){const e="=".repeat((4-s.length%4)%4),t=(s+e).replace(/\-/g,"+").replace(/_/g,"/"),i=atob(t),l=new Uint8Array(i.length);for(let u=0;u<i.length;++u)l[u]=i.charCodeAt(u);return l}const og="fcm_token_details_db",JL=5,n_="fcm_token_object_Store";async function ZL(s){if("databases"in indexedDB&&!(await indexedDB.databases()).map(u=>u.name).includes(og))return null;let e=null;return(await tf(og,JL,{upgrade:async(i,l,u,h)=>{if(l<2||!i.objectStoreNames.contains(n_))return;const p=h.objectStore(n_),g=await p.index("fcmSenderId").get(s);if(await p.clear(),!!g){if(l===2){const y=g;if(!y.auth||!y.p256dh||!y.endpoint)return;e={token:y.fcmToken,createTime:y.createTime??Date.now(),subscriptionOptions:{auth:y.auth,p256dh:y.p256dh,endpoint:y.endpoint,swScope:y.swScope,vapidKey:typeof y.vapidKey=="string"?y.vapidKey:Xi(y.vapidKey)}}}else if(l===3){const y=g;e={token:y.fcmToken,createTime:y.createTime,subscriptionOptions:{auth:Xi(y.auth),p256dh:Xi(y.p256dh),endpoint:y.endpoint,swScope:y.swScope,vapidKey:Xi(y.vapidKey)}}}else if(l===4){const y=g;e={token:y.fcmToken,createTime:y.createTime,subscriptionOptions:{auth:Xi(y.auth),p256dh:Xi(y.p256dh),endpoint:y.endpoint,swScope:y.swScope,vapidKey:Xi(y.vapidKey)}}}}}})).close(),await Mp(og),await Mp("fcm_vapid_details_db"),await Mp("undefined"),e5(e)?e:null}function e5(s){if(!s||!s.subscriptionOptions)return!1;const{subscriptionOptions:e}=s;return typeof s.createTime=="number"&&s.createTime>0&&typeof s.token=="string"&&s.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}const t5="firebase-messaging-database",n5=1,Eu="firebase-messaging-store";let lg=null;function FE(){return lg||(lg=tf(t5,n5,{upgrade:(s,e)=>{e===0&&s.createObjectStore(Eu)}})),lg}async function s5(s){const e=qE(s),i=await(await FE()).transaction(Eu).objectStore(Eu).get(e);if(i)return i;{const l=await ZL(s.appConfig.senderId);if(l)return await g0(s,l),l}}async function g0(s,e){const t=qE(s),l=(await FE()).transaction(Eu,"readwrite");return await l.objectStore(Eu).put(e,t),await l.done,e}function qE({appConfig:s}){return s.appId}const r5={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},rr=new Ho("messaging","Messaging",r5);async function i5(s,e){const t=await v0(s),i=HE(e),l={method:"POST",headers:t,body:JSON.stringify(i)};let u;try{u=await(await fetch(y0(s.appConfig),l)).json()}catch(h){throw rr.create("token-subscribe-failed",{errorInfo:h?.toString()})}if(u.error){const h=u.error.message;throw rr.create("token-subscribe-failed",{errorInfo:h})}if(!u.token)throw rr.create("token-subscribe-no-token");return u.token}async function a5(s,e){const t=await v0(s),i=HE(e.subscriptionOptions),l={method:"PATCH",headers:t,body:JSON.stringify(i)};let u;try{u=await(await fetch(`${y0(s.appConfig)}/${e.token}`,l)).json()}catch(h){throw rr.create("token-update-failed",{errorInfo:h?.toString()})}if(u.error){const h=u.error.message;throw rr.create("token-update-failed",{errorInfo:h})}if(!u.token)throw rr.create("token-update-no-token");return u.token}async function o5(s,e){const i={method:"DELETE",headers:await v0(s)};try{const u=await(await fetch(`${y0(s.appConfig)}/${e}`,i)).json();if(u.error){const h=u.error.message;throw rr.create("token-unsubscribe-failed",{errorInfo:h})}}catch(l){throw rr.create("token-unsubscribe-failed",{errorInfo:l?.toString()})}}function y0({projectId:s}){return`${GL}/projects/${s}/registrations`}async function v0({appConfig:s,installations:e}){const t=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":s.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})}function HE({p256dh:s,auth:e,endpoint:t,vapidKey:i}){const l={web:{endpoint:t,auth:e,p256dh:s}};return i!==BE&&(l.web.applicationPubKey=i),l}const l5=10080*60*1e3;async function c5(s){const e=await h5(s.swRegistration,s.vapidKey),t={vapidKey:s.vapidKey,swScope:s.swRegistration.scope,endpoint:e.endpoint,auth:Xi(e.getKey("auth")),p256dh:Xi(e.getKey("p256dh"))},i=await s5(s.firebaseDependencies);if(i){if(d5(i.subscriptionOptions,t))return Date.now()>=i.createTime+l5?u5(s,{token:i.token,createTime:Date.now(),subscriptionOptions:t}):i.token;try{await o5(s.firebaseDependencies,i.token)}catch(l){console.warn(l)}return s_(s.firebaseDependencies,t)}else return s_(s.firebaseDependencies,t)}async function u5(s,e){try{const t=await a5(s.firebaseDependencies,e),i={...e,token:t,createTime:Date.now()};return await g0(s.firebaseDependencies,i),t}catch(t){throw t}}async function s_(s,e){const i={token:await i5(s,e),createTime:Date.now(),subscriptionOptions:e};return await g0(s,i),i.token}async function h5(s,e){const t=await s.pushManager.getSubscription();return t||s.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:XL(e)})}function d5(s,e){const t=e.vapidKey===s.vapidKey,i=e.endpoint===s.endpoint,l=e.auth===s.auth,u=e.p256dh===s.p256dh;return t&&i&&l&&u}function r_(s){const e={from:s.from,collapseKey:s.collapse_key,messageId:s.fcmMessageId};return f5(e,s),m5(e,s),p5(e,s),e}function f5(s,e){if(!e.notification)return;s.notification={};const t=e.notification.title;t&&(s.notification.title=t);const i=e.notification.body;i&&(s.notification.body=i);const l=e.notification.image;l&&(s.notification.image=l);const u=e.notification.icon;u&&(s.notification.icon=u)}function m5(s,e){e.data&&(s.data=e.data)}function p5(s,e){if(!e.fcmOptions&&!e.notification?.click_action)return;s.fcmOptions={};const t=e.fcmOptions?.link??e.notification?.click_action;t&&(s.fcmOptions.link=t);const i=e.fcmOptions?.analytics_label;i&&(s.fcmOptions.analyticsLabel=i)}function g5(s){return typeof s=="object"&&!!s&&zE in s}function y5(s){if(!s||!s.options)throw cg("App Configuration Object");if(!s.name)throw cg("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=s;for(const i of e)if(!t[i])throw cg(i);return{appName:s.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}function cg(s){return rr.create("missing-app-config-values",{valueName:s})}class v5{constructor(e,t,i){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const l=y5(e);this.firebaseDependencies={app:e,appConfig:l,installations:t,analyticsProvider:i}}_delete(){return Promise.resolve()}}async function b5(s){try{s.swRegistration=await navigator.serviceWorker.register($L,{scope:WL}),s.swRegistration.update().catch(()=>{}),await w5(s.swRegistration)}catch(e){throw rr.create("failed-service-worker-registration",{browserErrorMessage:e?.message})}}async function w5(s){return new Promise((e,t)=>{const i=setTimeout(()=>t(new Error(`Service worker not registered after ${e_} ms`)),e_),l=s.installing||s.waiting;s.active?(clearTimeout(i),e()):l?l.onstatechange=u=>{u.target?.state==="activated"&&(l.onstatechange=null,clearTimeout(i),e())}:(clearTimeout(i),t(new Error("No incoming service worker found.")))})}async function _5(s,e){if(!e&&!s.swRegistration&&await b5(s),!(!e&&s.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw rr.create("invalid-sw-registration");s.swRegistration=e}}async function x5(s,e){e?s.vapidKey=e:s.vapidKey||(s.vapidKey=BE)}async function $E(s,e){if(!navigator)throw rr.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw rr.create("permission-blocked");return await x5(s,e?.vapidKey),await _5(s,e?.serviceWorkerRegistration),c5(s)}async function k5(s,e,t){const i=E5(e);(await s.firebaseDependencies.analyticsProvider.get()).logEvent(i,{message_id:t[zE],message_name:t[KL],message_time:t[YL],message_device_time:Math.floor(Date.now()/1e3)})}function E5(s){switch(s){case ku.NOTIFICATION_CLICKED:return"notification_open";case ku.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}async function T5(s,e){const t=e.data;if(!t.isFirebaseMessaging)return;s.onMessageHandler&&t.messageType===ku.PUSH_RECEIVED&&(typeof s.onMessageHandler=="function"?s.onMessageHandler(r_(t)):s.onMessageHandler.next(r_(t)));const i=t.data;g5(i)&&i[QL]==="1"&&await k5(s,t.messageType,i)}const i_="@firebase/messaging",a_="0.12.23";const S5=s=>{const e=new v5(s.getProvider("app").getImmediate(),s.getProvider("installations-internal").getImmediate(),s.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>T5(e,t)),e},j5=s=>{const e=s.getProvider("messaging").getImmediate();return{getToken:i=>$E(e,i)}};function C5(){oi(new Qr("messaging",S5,"PUBLIC")),oi(new Qr("messaging-internal",j5,"PRIVATE")),gr(i_,a_),gr(i_,a_,"esm2020")}async function N5(){try{await V_()}catch{return!1}return typeof window<"u"&&P_()&&AC()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}function A5(s=Cu()){return N5().then(e=>{if(!e)throw rr.create("unsupported-browser")},e=>{throw rr.create("indexed-db-unsupported")}),$o(yn(s),"messaging").getImmediate()}async function R5(s,e){return s=yn(s),$E(s,e)}C5();const I5="BNVNdqAPfJYhKBjF9qd-YPEMYIbecZLWiOGUF5tOBfNuv6P1iXgJS6IoS9dHLM5gp-WMrExfir0pCpkMzOdTWKY";let ug=null;function D5(){if(!ug)try{ug=A5(Cu())}catch{return null}return ug}function Wg(){return"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window}function o_(){return"Notification"in window?Notification.permission:"denied"}function M5(s){const e=Object.getOwnPropertyDescriptor(Notification,"permission");Object.defineProperty(Notification,"permission",{get:()=>"granted",configurable:!0});const t=()=>{e?Object.defineProperty(Notification,"permission",e):delete Notification.permission};try{const i=s();return i&&typeof i.then=="function"?i.then(l=>(t(),l),l=>{throw t(),l}):(t(),i)}catch(i){throw t(),i}}async function L5(s){if(!Wg())return null;try{const e=await Notification.requestPermission(),t=D5();if(!t)return console.error("Push: could not initialise Firebase Messaging"),null;const i=await navigator.serviceWorker.ready,l=e!=="granted";let u=null;const h=3;for(let p=1;p<=h;p++){try{const g=()=>R5(t,{vapidKey:I5,serviceWorkerRegistration:i});if(u=l?await M5(g):await g(),u)break}catch(g){console.warn(`Push getToken attempt ${p}/${h} failed:`,g)}p<h&&await new Promise(g=>setTimeout(g,1500*p))}return u&&s&&await js(Ze(_e,"clients",s),{fcmTokens:wM(u)}),u}catch(e){return console.error("Push permission request failed:",e),null}}async function O5(s,e){if(!(!e||!s))try{await js(Ze(_e,"clients",s),{fcmTokens:_M(e)})}catch(t){console.error("Token revoke failed:",t)}}const P5=[{key:"buddy_request",label:"Buddy requests",desc:"When someone sends you a buddy request"},{key:"buddy_accept",label:"Buddy accepted",desc:"When your buddy request is accepted"},{key:"like",label:"Likes",desc:"When someone likes your post"},{key:"comment",label:"Comments",desc:"When someone comments on your post"},{key:"mention",label:"Mentions",desc:"When someone @mentions you"}];function V5(){const{currentUser:s,clientData:e,updateClientData:t,logout:i,loading:l}=Xr(),{isDark:u,toggleTheme:h}=fa(),p=ir(),[g,y]=_.useState(!1),[b,k]=_.useState(null),[E,O]=_.useState(!1),[H,q]=_.useState("default"),[B,K]=_.useState({buddy_request:!0,buddy_accept:!0,like:!0,comment:!0,mention:!0}),[$,G]=_.useState(null),fe=_.useCallback((j,T="info")=>{G({message:j,type:T}),setTimeout(()=>G(null),4e3)},[]);_.useEffect(()=>{!l&&!s&&p("/")},[l,s,p]),_.useEffect(()=>{if(!e)return;const j=e.notificationPrefs;j&&K(R=>({...R,...j}));const T=e.fcmTokens||[];T.length>0&&(y(!0),k(T[T.length-1])),q(o_())},[e]);const xe=async()=>{if(e){O(!0);try{if(g)b&&await O5(e.id,b),y(!1),k(null),t({fcmTokens:[]}),fe("Push notifications disabled","info");else{if(!Wg()){fe("Push notifications are not supported on this device","error");return}const j=await L5(e.id),T=o_();q(T),j?(y(!0),k(j),t({fcmTokens:[...e.fcmTokens||[],j]}),fe("Push notifications enabled!","success")):fe(T==="denied"?"Notifications blocked  enable them in your device settings, remove the app from your home screen and re-add it":T==="granted"?"Permission granted but setup failed  try closing and reopening the app, then toggle again":"Could not enable notifications  please try again","error")}}catch(j){console.error("Push toggle failed:",j),fe("Something went wrong  please try again","error")}finally{O(!1)}}},be=async j=>{if(!e)return;const T={...B,[j]:!B[j]};K(T);try{await js(Ze(_e,"clients",e.id),{notificationPrefs:T}),t({notificationPrefs:T})}catch(R){console.error("Failed to save pref:",R),K(P=>({...P,[j]:!P[j]})),fe("Failed to save preference","error")}};return l||!e?a.jsx("div",{className:"cb-loading",children:a.jsx("div",{className:"cb-loading-spinner"})}):a.jsxs("div",{className:"cb-settings","data-theme":u?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Back",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M19 12H5"}),a.jsx("path",{d:"M12 19l-7-7 7-7"})]})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:h,"aria-label":"Toggle theme",children:u?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})}),a.jsx("button",{onClick:i,"aria-label":"Log out",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),a.jsxs("main",{className:"settings-main",children:[a.jsx("h1",{className:"settings-title",children:"Settings"}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),a.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),"Notifications"]}),Wg()?a.jsxs("div",{className:"settings-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Push notifications"}),a.jsx("span",{className:"settings-row-desc",children:"Receive notifications even when the app is closed"})]}),a.jsx("button",{className:`settings-toggle${g?" on":""}${E?" loading":""}`,onClick:xe,disabled:E,"aria-label":"Toggle push notifications",children:a.jsx("span",{className:"settings-toggle-knob"})})]}):a.jsx("p",{className:"settings-hint",children:"Add the app to your home screen for background push notifications. In-app notifications still work below."}),a.jsxs("div",{className:"settings-sub-section",children:[a.jsx("span",{className:"settings-sub-title",children:"Notify me about"}),P5.map(j=>a.jsxs("div",{className:"settings-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:j.label}),a.jsx("span",{className:"settings-row-desc",children:j.desc})]}),a.jsx("button",{className:`settings-toggle${B[j.key]?" on":""}`,onClick:()=>be(j.key),"aria-label":`Toggle ${j.label}`,children:a.jsx("span",{className:"settings-toggle-knob"})})]},j.key))]})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),"Account"]}),a.jsxs("div",{className:"settings-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Dark mode"}),a.jsx("span",{className:"settings-row-desc",children:"Switch between light and dark themes"})]}),a.jsx("button",{className:`settings-toggle${u?" on":""}`,onClick:h,"aria-label":"Toggle dark mode",children:a.jsx("span",{className:"settings-toggle-knob"})})]}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Email"}),a.jsx("span",{className:"settings-row-desc",children:e?.email||""})]})}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Plan"}),a.jsx("span",{className:"settings-row-desc",style:{textTransform:"capitalize"},children:e?.tier||"free"})]})})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),"Support & Feedback"]}),a.jsxs("a",{href:"mailto:ross@mindcorefitness.com?subject=Core%20Buddy%20Bug%20Report",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Report a Bug"}),a.jsx("span",{className:"settings-row-desc",children:"Found something not working? Let us know"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]}),a.jsxs("a",{href:"mailto:ross@mindcorefitness.com?subject=Core%20Buddy%20Feature%20Request",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Request a Feature"}),a.jsx("span",{className:"settings-row-desc",children:"Have an idea to improve Core Buddy?"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]}),a.jsxs("a",{href:"mailto:ross@mindcorefitness.com?subject=Core%20Buddy%20Feedback",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"General Feedback"}),a.jsx("span",{className:"settings-row-desc",children:"We'd love to hear from you"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Contact Email"}),a.jsx("span",{className:"settings-row-desc",children:"ross@mindcorefitness.com"})]})})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),a.jsx("polyline",{points:"10 9 9 9 8 9"})]}),"Legal"]}),a.jsxs("a",{href:"/privacy-policy",target:"_blank",rel:"noopener noreferrer",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Privacy Policy"}),a.jsx("span",{className:"settings-row-desc",children:"How we collect, use, and protect your data"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),a.jsx("polyline",{points:"15 3 21 3 21 9"}),a.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})]}),a.jsxs("a",{href:"/terms",target:"_blank",rel:"noopener noreferrer",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Terms & Conditions"}),a.jsx("span",{className:"settings-row-desc",children:"Terms of use for Core Buddy"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),a.jsx("polyline",{points:"15 3 21 3 21 9"}),a.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})]})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),a.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),"About"]}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Core Buddy"}),a.jsx("span",{className:"settings-row-desc",children:"Food. Habits. Move."})]})}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Version"}),a.jsx("span",{className:"settings-row-desc",children:"1.0.0"})]})}),a.jsxs("a",{href:"/core-buddy",target:"_blank",rel:"noopener noreferrer",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Visit Our Website"}),a.jsx("span",{className:"settings-row-desc",children:"mindcorefitness.com"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),a.jsx("polyline",{points:"15 3 21 3 21 9"}),a.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})]})]})]}),$&&a.jsx("div",{className:`settings-toast ${$.type}`,children:$.message}),a.jsx(ui,{active:"home"})]})}const gd=[{id:"starter_streak",name:"Starter Streak",description:"Complete 5 workouts in 7 days",goal:5,duration:7,type:"workouts",difficulty:"easy",icon:"flame",premium:!0},{id:"consistency_king",name:"Consistency King",description:"Complete 12 workouts in 30 days",goal:12,duration:30,type:"workouts",difficulty:"medium",icon:"crown",premium:!0},{id:"thirty_in_thirty",name:"30 in 30",description:"Complete 30 workouts in 30 days",goal:30,duration:30,type:"workouts",difficulty:"hard",icon:"fire",premium:!0},{id:"minute_master",name:"Minute Master",description:"Train for 300 total minutes in 30 days",goal:300,duration:30,type:"minutes",difficulty:"medium",icon:"clock",premium:!0},{id:"habit_machine",name:"Habit Machine",description:"Hit all daily habits for 7 days straight",goal:7,duration:7,type:"habits_perfect",difficulty:"medium",icon:"check",premium:!0},{id:"iron_will",name:"Iron Will",description:"Work out every day for 14 days straight",goal:14,duration:14,type:"streak",difficulty:"hard",icon:"shield",premium:!0}];function hg({icon:s,size:e=28}){const t={width:e,height:e};switch(s){case"flame":return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 12c2-2.96 0-7-1-8 0 3.038-1.773 4.741-3 6-1.226 1.26-2 3.24-2 5a6 6 0 1 0 12 0c0-1.532-1.056-3.94-2-5-1.786 3-2.791 3-4 2z"})});case"crown":return a.jsxs("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M2 4l3 12h14l3-12-6 7-4-7-4 7-6-7z"}),a.jsx("path",{d:"M3 20h18"})]});case"fire":return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 12c2-2.96 0-7-1-8 0 3.038-1.773 4.741-3 6-1.226 1.26-2 3.24-2 5a6 6 0 1 0 12 0c0-1.532-1.056-3.94-2-5-1.786 3-2.791 3-4 2z"})});case"clock":return a.jsxs("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 6v6l4 2"})]});case"check":return a.jsxs("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]});case"shield":return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})});default:return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("circle",{cx:"12",cy:"12",r:"10"})})}}function l_({progress:s,goal:e,size:t=160,stroke:i=10,label:l}){const u=Math.min(s/e,1),h=(t-i)/2,p=2*Math.PI*h,g=p*(1-u);return a.jsxs("div",{className:"ch-ring-wrap",children:[a.jsxs("svg",{width:t,height:t,className:"ch-ring-svg",children:[a.jsx("circle",{cx:t/2,cy:t/2,r:h,fill:"none",stroke:"var(--ch-ring-bg)",strokeWidth:i}),a.jsx("circle",{cx:t/2,cy:t/2,r:h,fill:"none",stroke:"var(--color-primary)",strokeWidth:i,strokeDasharray:p,strokeDashoffset:g,strokeLinecap:"round",style:{transition:"stroke-dashoffset 0.6s ease",transform:"rotate(-90deg)",transformOrigin:"50% 50%"}})]}),a.jsxs("div",{className:"ch-ring-centre",children:[a.jsxs("span",{className:"ch-ring-num",children:[s,a.jsxs("span",{className:"ch-ring-slash",children:[" / ",e]})]}),l&&a.jsx("span",{className:"ch-ring-label",children:l})]})]})}const c_={easy:"#34C759",medium:"#FF9500",hard:"#FF3B30"};async function U5(s,e,t){const i=t instanceof Vt?t:Vt.fromDate(new Date(t)),l=Vt.now();switch(s.type){case"workouts":{const u=cn(wt(_e,"workoutLogs"),At("clientId","==",e),At("completedAt",">=",i),At("completedAt","<=",l));return(await nn(u)).size}case"minutes":{const u=cn(wt(_e,"workoutLogs"),At("clientId","==",e),At("completedAt",">=",i),At("completedAt","<=",l));return(await nn(u)).docs.reduce((p,g)=>p+(g.data().duration||0),0)}case"habits_perfect":{const u=i.toDate().toISOString().slice(0,10),h=new Date().toISOString().slice(0,10),p=cn(wt(_e,"habitLogs"),At("clientId","==",e));return(await nn(p)).docs.filter(y=>{const b=y.data().date;if(b<u||b>h)return!1;const k=y.data().habits||{};return Object.values(k).length>0&&Object.values(k).every(E=>E===!0)}).length}case"streak":{const u=cn(wt(_e,"workoutLogs"),At("clientId","==",e),At("completedAt",">=",i),At("completedAt","<=",l)),h=await nn(u),p=new Set(h.docs.map(k=>k.data().completedAt.toDate().toISOString().slice(0,10)));let g=0;const y=new Date(i.toDate()),b=new Date;for(;p.has(y.toISOString().slice(0,10))&&y<=b;)g++,y.setDate(y.getDate()+1);return g}default:return 0}}function B5(){const{currentUser:s,clientData:e,loading:t}=Xr(),{isDark:i,toggleTheme:l}=fa(),{isPremium:u}=rc(),h=ir(),[p,g]=_.useState(null),[y,b]=_.useState(null),[k,E]=_.useState(0),[O,H]=_.useState(0),[q,B]=_.useState(!0),[K,$]=_.useState(!1),[G,fe]=_.useState(null),[xe,be]=_.useState(null),[j,T]=_.useState(!1),R=_.useCallback((ue,Ce="info")=>{be({message:ue,type:Ce}),setTimeout(()=>be(null),4e3)},[]);_.useEffect(()=>{!t&&!s&&h("/")},[t,s,h]);const P=_.useCallback(async()=>{if(e){B(!0);try{const ue=cn(wt(_e,"userChallenges"),At("clientId","==",e.id),At("status","==","active")),Ce=await nn(ue);if(Ce.empty)g(null),b(null);else{const D=Ce.docs[0],ne={id:D.id,...D.data()},ve=gd.find(Ee=>Ee.id===ne.challengeId);if(ne.endDate.toDate()<new Date)await js(Ze(_e,"userChallenges",D.id),{status:"failed"}),g(null),b(null),R("Challenge expired  time ran out","error");else if(g(ne),b(ve),ve){const Ee=await U5(ve,e.id,ne.startDate);E(Ee),Ee>=ve.goal&&ne.status==="active"&&(await js(Ze(_e,"userChallenges",D.id),{status:"completed",completedAt:er()}),T(!0),g(Te=>Te?{...Te,status:"completed"}:null),typeof fbq=="function"&&fbq("trackCustom","ChallengeCompleted",{challenge_name:ve.name,challenge_type:ve.type,duration_days:ve.duration}))}}const Pe=cn(wt(_e,"userChallenges"),At("clientId","==",e.id),At("status","==","completed")),se=await nn(Pe);H(se.size)}catch(ue){console.error("Failed to load challenges:",ue)}finally{B(!1)}}},[e,R]);_.useEffect(()=>{P()},[P]);const M=async ue=>{if(!(!e||K)){$(!0);try{const Ce=gd.find(D=>D.id===ue);if(!Ce)return;const Pe=Vt.now(),se=Vt.fromDate(new Date(Date.now()+Ce.duration*864e5));await Kr(wt(_e,"userChallenges"),{clientId:e.id,challengeId:ue,startDate:Pe,endDate:se,status:"active",completedAt:null,badgeAwarded:!1}),fe(null),R(`${Ce.name} started  let's go!`,"success"),await P()}catch(Ce){console.error("Start challenge failed:",Ce),R("Something went wrong  try again","error")}finally{$(!1)}}},L=async()=>{if(!(!p||K)){$(!0);try{await js(Ze(_e,"userChallenges",p.id),{status:"failed"}),g(null),b(null),E(0),fe(null),R("Challenge abandoned","info"),await P()}catch(ue){console.error("Give up failed:",ue),R("Something went wrong","error")}finally{$(!1)}}},A=p?.endDate?Math.max(0,Math.ceil((p.endDate.toDate()-new Date)/864e5)):0,Ve=()=>{if(!y||!p)return"";const ue=Math.max(1,Math.ceil((Date.now()-p.startDate.toDate())/864e5)),Ce=y.goal/y.duration*ue;return k>=Ce*1.15?"Ahead":k>=Ce*.85?"On Track":"Behind"};if(t||!e)return a.jsx("div",{className:"ch-loading",children:a.jsx("div",{className:"ch-spinner"})});const Qe=p&&p.status==="active"&&y,Z=j||p&&p.status==="completed";return a.jsxs("div",{className:"ch-page","data-theme":i?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>h("/client/core-buddy"),"aria-label":"Back",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M19 12H5"}),a.jsx("path",{d:"M12 19l-7-7 7-7"})]})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:l,"aria-label":"Toggle theme",children:i?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"ch-main",children:[a.jsx("h1",{className:"ch-title",children:"Challenges"}),a.jsx("p",{className:"ch-subtitle",children:"Push yourself with timed fitness challenges"}),q?a.jsx("div",{className:"ch-loading",children:a.jsx("div",{className:"ch-spinner"})}):Z?a.jsxs("div",{className:"ch-completed-section",children:[a.jsx(l_,{progress:y?.goal||1,goal:y?.goal||1,label:"Complete"}),a.jsx("div",{className:"ch-completed-pulse"}),a.jsx("h2",{className:"ch-completed-heading",children:"Challenge Complete!"}),a.jsx("p",{className:"ch-completed-name",children:y?.name}),a.jsxs("p",{className:"ch-completed-count",children:[O+(j?1:0)," challenge",O!==0?"s":""," completed"]}),a.jsx("button",{className:"ch-btn ch-btn-primary",onClick:()=>{T(!1),g(null),b(null),P()},children:"Choose Next Challenge"})]}):Qe?a.jsxs("div",{className:"ch-active-section",children:[a.jsx(l_,{progress:k,goal:y.goal,label:y.type==="minutes"?"minutes":y.type==="streak"?"day streak":y.type==="habits_perfect"?"perfect days":"workouts"}),a.jsxs("div",{className:"ch-active-info",children:[a.jsxs("div",{className:"ch-info-row",children:[a.jsxs("div",{className:"ch-info-item",children:[a.jsx("span",{className:"ch-info-val",children:A}),a.jsx("span",{className:"ch-info-key",children:"days left"})]}),a.jsx("div",{className:`ch-pace ch-pace-${Ve().toLowerCase().replace(" ","")}`,children:Ve()})]}),a.jsx("h2",{className:"ch-active-name",children:y.name}),a.jsx("p",{className:"ch-active-desc",children:y.description})]}),a.jsx("button",{className:"ch-give-up",onClick:()=>fe("giveup"),children:"Give Up"}),a.jsxs("div",{className:"ch-browse-locked",children:[a.jsx("p",{className:"ch-browse-locked-note",children:"Complete your current challenge to start a new one"}),a.jsx("div",{className:"ch-grid ch-grid-dimmed",children:gd.filter(ue=>ue.id!==y.id).map(ue=>a.jsxs("div",{className:"ch-card ch-card-locked",children:[a.jsx("div",{className:"ch-card-icon",children:a.jsx(hg,{icon:ue.icon,size:24})}),a.jsxs("div",{className:"ch-card-body",children:[a.jsx("h3",{children:ue.name}),a.jsx("p",{children:ue.description})]})]},ue.id))})]})]}):a.jsxs("div",{className:"ch-browse-section",children:[!u&&a.jsxs("div",{className:"ch-premium-banner",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{children:"Challenges are a premium feature"}),a.jsx("button",{className:"ch-upgrade-link",onClick:()=>h("/upgrade"),children:"Upgrade"})]}),a.jsx("div",{className:"ch-grid",children:gd.map(ue=>a.jsxs("button",{className:`ch-card${u?"":" ch-card-gated"}`,onClick:()=>u?fe(ue):h("/upgrade"),children:[!u&&a.jsx("div",{className:"ch-lock-overlay",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),a.jsx("div",{className:"ch-card-icon",children:a.jsx(hg,{icon:ue.icon})}),a.jsxs("div",{className:"ch-card-body",children:[a.jsx("h3",{children:ue.name}),a.jsx("p",{children:ue.description}),a.jsxs("div",{className:"ch-card-tags",children:[a.jsxs("span",{className:"ch-tag ch-tag-dur",children:[ue.duration," days"]}),a.jsx("span",{className:"ch-tag ch-tag-diff",style:{color:c_[ue.difficulty]},children:ue.difficulty})]})]}),a.jsx("svg",{className:"ch-card-arrow",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]},ue.id))})]})]}),G&&G!=="giveup"&&a.jsx("div",{className:"ch-modal-backdrop",onClick:()=>!K&&fe(null),children:a.jsxs("div",{className:"ch-modal",onClick:ue=>ue.stopPropagation(),children:[a.jsx("div",{className:"ch-modal-icon",children:a.jsx(hg,{icon:G.icon,size:36})}),a.jsx("h2",{children:G.name}),a.jsx("p",{children:G.description}),a.jsxs("div",{className:"ch-modal-details",children:[a.jsxs("span",{children:[G.duration," days"]}),a.jsx("span",{style:{color:c_[G.difficulty]},children:G.difficulty})]}),a.jsx("button",{className:"ch-btn ch-btn-primary",onClick:()=>M(G.id),disabled:K,children:K?"Starting...":"Start Challenge"}),a.jsx("button",{className:"ch-btn ch-btn-secondary",onClick:()=>fe(null),disabled:K,children:"Cancel"})]})}),G==="giveup"&&a.jsx("div",{className:"ch-modal-backdrop",onClick:()=>!K&&fe(null),children:a.jsxs("div",{className:"ch-modal",onClick:ue=>ue.stopPropagation(),children:[a.jsx("h2",{children:"Give Up?"}),a.jsx("p",{children:"Your progress will be lost and this challenge will be marked as failed."}),a.jsx("button",{className:"ch-btn ch-btn-danger",onClick:L,disabled:K,children:K?"Abandoning...":"Yes, Give Up"}),a.jsx("button",{className:"ch-btn ch-btn-secondary",onClick:()=>fe(null),disabled:K,children:"Keep Going"})]})}),xe&&a.jsx("div",{className:`ch-toast ch-toast-${xe.type}`,children:xe.message}),a.jsx(ui,{})]})}const z5=_.lazy(()=>Ks(()=>import("./Dashboard-CMz5FSRy.js"),__vite__mapDeps([0,1,2]))),F5=_.lazy(()=>Ks(()=>import("./AddClient-Dfwwnsdx.js"),__vite__mapDeps([3,4]))),q5=_.lazy(()=>Ks(()=>import("./ClientDashboard-CT0Qn03r.js"),__vite__mapDeps([5,1,6]))),H5=_.lazy(()=>Ks(()=>import("./ClientForms-Au3js0Jg.js"),__vite__mapDeps([7,8,6]))),$5=_.lazy(()=>Ks(()=>import("./ClientTools-OKtsjzEE.js"),__vite__mapDeps([9,10,6]))),W5=_.lazy(()=>Ks(()=>import("./MacroCalculator-a5e4Lh1L.js"),__vite__mapDeps([11,10,6]))),G5=_.lazy(()=>Ks(()=>import("./ProteinSnacks-D2ExTnjw.js"),__vite__mapDeps([12,10,6]))),K5=_.lazy(()=>Ks(()=>import("./DailyMotivation-vI2oNP7I.js"),__vite__mapDeps([13,10,6]))),Y5=_.lazy(()=>Ks(()=>import("./CircuitDashboard-Bp8GPoNY.js"),__vite__mapDeps([14,15]))),Q5=_.lazy(()=>Ks(()=>import("./CircuitBooking-DgUgctYW.js"),__vite__mapDeps([16,17,15]))),X5=_.lazy(()=>Ks(()=>import("./PersonalBests-slMv00Lv.js"),__vite__mapDeps([18,19,6]))),J5=_.lazy(()=>Ks(()=>import("./Leaderboard-Bz4iomo9.js"),__vite__mapDeps([20,21]))),Z5=_.lazy(()=>Ks(()=>import("./UpgradePage-Kw0Cio_m.js"),__vite__mapDeps([22,23,24]))),eO=_.lazy(()=>Ks(()=>import("./SignUp-D4TFGnmI.js"),[])),tO=_.lazy(()=>Ks(()=>import("./Onboarding-DjYuQmkp.js"),__vite__mapDeps([25,23,26])));function nO({children:s}){const{pathname:e}=Ii();return _.useEffect(()=>{"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")},[]),_.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"})},[e]),s}function sO(){const s=ir();return _.useEffect(()=>{const e=sessionStorage.getItem("redirect");if(e){sessionStorage.removeItem("redirect");const t=e.replace("/login","")||"/";s(t,{replace:!0})}},[s]),null}function rO(){return a.jsx(G6,{children:a.jsx(W6,{children:a.jsx(J6,{children:a.jsxs(nC,{basename:"/login",children:[a.jsx(sO,{}),a.jsx(nO,{children:a.jsx(_.Suspense,{fallback:a.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"60vh"},children:a.jsx("div",{style:{width:36,height:36,border:"3px solid var(--color-primary-light)",borderTopColor:"var(--color-primary)",borderRadius:"50%",animation:"app-spin .7s linear infinite"}})}),children:a.jsxs(Rj,{children:[a.jsx(Cn,{path:"/",element:a.jsx(t3,{})}),a.jsx(Cn,{path:"/dashboard",element:a.jsx(z5,{})}),a.jsx(Cn,{path:"/add-client",element:a.jsx(F5,{})}),a.jsx(Cn,{path:"/client",element:a.jsx(q5,{})}),a.jsx(Cn,{path:"/client/forms",element:a.jsx(H5,{})}),a.jsx(Cn,{path:"/client/tools",element:a.jsx($5,{})}),a.jsx(Cn,{path:"/client/tools/macros",element:a.jsx(W5,{})}),a.jsx(Cn,{path:"/client/tools/snacks",element:a.jsx(G5,{})}),a.jsx(Cn,{path:"/client/tools/motivation",element:a.jsx(K5,{})}),a.jsx(Cn,{path:"/client/personal-bests",element:a.jsx(X5,{})}),a.jsx(Cn,{path:"/client/circuit",element:a.jsx(Y5,{})}),a.jsx(Cn,{path:"/client/circuit/booking",element:a.jsx(Q5,{})}),a.jsx(Cn,{path:"/client/core-buddy",element:a.jsx(o3,{})}),a.jsx(Cn,{path:"/client/core-buddy/nutrition",element:a.jsx(hd,{feature:"nutrition",children:a.jsx(u3,{})})}),a.jsx(Cn,{path:"/client/core-buddy/workouts",element:a.jsx(W3,{})}),a.jsx(Cn,{path:"/client/core-buddy/consistency",element:a.jsx(hd,{feature:"consistency",children:a.jsx(eL,{})})}),a.jsx(Cn,{path:"/client/core-buddy/buddies",element:a.jsx(hd,{feature:"buddies",children:a.jsx(tL,{})})}),a.jsx(Cn,{path:"/client/core-buddy/builder",element:a.jsx(iL,{})}),a.jsx(Cn,{path:"/client/core-buddy/profile/:userId",element:a.jsx(sL,{})}),a.jsx(Cn,{path:"/client/core-buddy/settings",element:a.jsx(V5,{})}),a.jsx(Cn,{path:"/client/core-buddy/challenges",element:a.jsx(B5,{})}),a.jsx(Cn,{path:"/client/leaderboard",element:a.jsx(hd,{feature:"leaderboard",children:a.jsx(J5,{})})}),a.jsx(Cn,{path:"/signup",element:a.jsx(eO,{})}),a.jsx(Cn,{path:"/onboarding",element:a.jsx(tO,{})}),a.jsx(Cn,{path:"/upgrade",element:a.jsx(Z5,{})}),a.jsx(Cn,{path:"*",element:a.jsx(k_,{to:"/",replace:!0})})]})})})]})})})})}RS.createRoot(document.getElementById("root")).render(a.jsx(_.StrictMode,{children:a.jsx(rO,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/login/sw.js").then(s=>{setInterval(()=>s.update(),3600*1e3)}).catch(s=>console.warn("SW registration failed:",s))});export{aO as A,er as B,ui as C,Xo as P,Vt as T,Kr as a,jr as b,wt as c,_e as d,Ze as e,$A as f,nn as g,QA as h,Ps as i,a as j,pr as k,Xr as l,fa as m,ir as n,_u as o,_E as p,cn as q,_ as r,lO as s,iO as t,js as u,cO as v,At as w,rc as x,e3 as y,Z6 as z};
