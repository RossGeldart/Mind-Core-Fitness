const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-DX_JuNPp.js","assets/scheduleUtils-a2tn0x12.js","assets/Dashboard-BvdLF0uv.css","assets/AddClient-DU7djmhB.js","assets/AddClient-DH1OFzHo.css","assets/ClientDashboard-BU2yXe9o.js","assets/ClientForms-CRGsrGFb.js","assets/ClientForms-GDNtnrAx.css","assets/ClientTools-Dy7OZ6_Z.js","assets/ClientTools-DQRPoST3.css","assets/MacroCalculator-xlibVqxu.js","assets/ProteinSnacks-DYBYmMKS.js","assets/DailyMotivation-CSHWkDm0.js","assets/CircuitDashboard-Dp7cTnam.js","assets/CircuitDashboard-C8T0uect.css","assets/CircuitBooking-DeSaIU56.js","assets/CircuitBooking-ruk9Q4Wj.css","assets/Leaderboard-BOEGiHoM.js","assets/Leaderboard-Dq-r5svP.css","assets/UpgradePage-DRUCCksG.js","assets/UpgradePage-Blt11CID.css","assets/Onboarding-DBp4TnNv.js","assets/Onboarding-Bku4iVdQ.css"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function t(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(l){if(l.ep)return;l.ep=!0;const u=t(l);fetch(l.href,u)}})();var wp={exports:{}},eu={};var j1;function NT(){if(j1)return eu;j1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,l,u){var d=null;if(u!==void 0&&(d=""+u),l.key!==void 0&&(d=""+l.key),"key"in l){u={};for(var p in l)p!=="key"&&(u[p]=l[p])}else u=l;return l=u.ref,{$$typeof:n,type:i,key:d,ref:l!==void 0?l:null,props:u}}return eu.Fragment=e,eu.jsx=t,eu.jsxs=t,eu}var T1;function CT(){return T1||(T1=1,wp.exports=NT()),wp.exports}var r=CT(),_p={exports:{}},rs={};var S1;function RT(){if(S1)return rs;S1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),d=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),_=Symbol.for("react.activity"),j=Symbol.iterator;function O(P){return P===null||typeof P!="object"?null:(P=j&&P[j]||P["@@iterator"],typeof P=="function"?P:null)}var K={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},B=Object.assign,D={};function se(P,re,Fe){this.props=P,this.context=re,this.refs=D,this.updater=Fe||K}se.prototype.isReactComponent={},se.prototype.setState=function(P,re){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,re,"setState")},se.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function Y(){}Y.prototype=se.prototype;function Z(P,re,Fe){this.props=P,this.context=re,this.refs=D,this.updater=Fe||K}var je=Z.prototype=new Y;je.constructor=Z,B(je,se.prototype),je.isPureReactComponent=!0;var Re=Array.isArray;function ke(){}var C={H:null,A:null,T:null,S:null},T=Object.prototype.hasOwnProperty;function M(P,re,Fe){var qe=Fe.ref;return{$$typeof:n,type:P,key:re,ref:qe!==void 0?qe:null,props:Fe}}function V(P,re){return M(P.type,re,P.props)}function I(P){return typeof P=="object"&&P!==null&&P.$$typeof===n}function L(P){var re={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(Fe){return re[Fe]})}var A=/\/+/g;function Oe(P,re){return typeof P=="object"&&P!==null&&P.key!=null?L(""+P.key):re.toString(36)}function ht(P){switch(P.status){case"fulfilled":return P.value;case"rejected":throw P.reason;default:switch(typeof P.status=="string"?P.then(ke,ke):(P.status="pending",P.then(function(re){P.status==="pending"&&(P.status="fulfilled",P.value=re)},function(re){P.status==="pending"&&(P.status="rejected",P.reason=re)})),P.status){case"fulfilled":return P.value;case"rejected":throw P.reason}}throw P}function H(P,re,Fe,qe,Ue){var Ie=typeof P;(Ie==="undefined"||Ie==="boolean")&&(P=null);var mt=!1;if(P===null)mt=!0;else switch(Ie){case"bigint":case"string":case"number":mt=!0;break;case"object":switch(P.$$typeof){case n:case e:mt=!0;break;case x:return mt=P._init,H(mt(P._payload),re,Fe,qe,Ue)}}if(mt)return Ue=Ue(P),mt=qe===""?"."+Oe(P,0):qe,Re(Ue)?(Fe="",mt!=null&&(Fe=mt.replace(A,"$&/")+"/"),H(Ue,re,Fe,"",function(ss){return ss})):Ue!=null&&(I(Ue)&&(Ue=V(Ue,Fe+(Ue.key==null||P&&P.key===Ue.key?"":(""+Ue.key).replace(A,"$&/")+"/")+mt)),re.push(Ue)),1;mt=0;var xt=qe===""?".":qe+":";if(Re(P))for(var it=0;it<P.length;it++)qe=P[it],Ie=xt+Oe(qe,it),mt+=H(qe,re,Fe,Ie,Ue);else if(it=O(P),typeof it=="function")for(P=it.call(P),it=0;!(qe=P.next()).done;)qe=qe.value,Ie=xt+Oe(qe,it++),mt+=H(qe,re,Fe,Ie,Ue);else if(Ie==="object"){if(typeof P.then=="function")return H(ht(P),re,Fe,qe,Ue);throw re=String(P),Error("Objects are not valid as a React child (found: "+(re==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":re)+"). If you meant to render a collection of children, use an array instead.")}return mt}function fe(P,re,Fe){if(P==null)return P;var qe=[],Ue=0;return H(P,qe,"","",function(Ie){return re.call(Fe,Ie,Ue++)}),qe}function Ve(P){if(P._status===-1){var re=P._result;re=re(),re.then(function(Fe){(P._status===0||P._status===-1)&&(P._status=1,P._result=Fe)},function(Fe){(P._status===0||P._status===-1)&&(P._status=2,P._result=Fe)}),P._status===-1&&(P._status=0,P._result=re)}if(P._status===1)return P._result.default;throw P._result}var $e=typeof reportError=="function"?reportError:function(P){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var re=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof P=="object"&&P!==null&&typeof P.message=="string"?String(P.message):String(P),error:P});if(!window.dispatchEvent(re))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",P);return}console.error(P)},J={map:fe,forEach:function(P,re,Fe){fe(P,function(){re.apply(this,arguments)},Fe)},count:function(P){var re=0;return fe(P,function(){re++}),re},toArray:function(P){return fe(P,function(re){return re})||[]},only:function(P){if(!I(P))throw Error("React.Children.only expected to receive a single React element child.");return P}};return rs.Activity=_,rs.Children=J,rs.Component=se,rs.Fragment=t,rs.Profiler=l,rs.PureComponent=Z,rs.StrictMode=i,rs.Suspense=g,rs.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=C,rs.__COMPILER_RUNTIME={__proto__:null,c:function(P){return C.H.useMemoCache(P)}},rs.cache=function(P){return function(){return P.apply(null,arguments)}},rs.cacheSignal=function(){return null},rs.cloneElement=function(P,re,Fe){if(P==null)throw Error("The argument must be a React element, but you passed "+P+".");var qe=B({},P.props),Ue=P.key;if(re!=null)for(Ie in re.key!==void 0&&(Ue=""+re.key),re)!T.call(re,Ie)||Ie==="key"||Ie==="__self"||Ie==="__source"||Ie==="ref"&&re.ref===void 0||(qe[Ie]=re[Ie]);var Ie=arguments.length-2;if(Ie===1)qe.children=Fe;else if(1<Ie){for(var mt=Array(Ie),xt=0;xt<Ie;xt++)mt[xt]=arguments[xt+2];qe.children=mt}return M(P.type,Ue,qe)},rs.createContext=function(P){return P={$$typeof:d,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null},P.Provider=P,P.Consumer={$$typeof:u,_context:P},P},rs.createElement=function(P,re,Fe){var qe,Ue={},Ie=null;if(re!=null)for(qe in re.key!==void 0&&(Ie=""+re.key),re)T.call(re,qe)&&qe!=="key"&&qe!=="__self"&&qe!=="__source"&&(Ue[qe]=re[qe]);var mt=arguments.length-2;if(mt===1)Ue.children=Fe;else if(1<mt){for(var xt=Array(mt),it=0;it<mt;it++)xt[it]=arguments[it+2];Ue.children=xt}if(P&&P.defaultProps)for(qe in mt=P.defaultProps,mt)Ue[qe]===void 0&&(Ue[qe]=mt[qe]);return M(P,Ie,Ue)},rs.createRef=function(){return{current:null}},rs.forwardRef=function(P){return{$$typeof:p,render:P}},rs.isValidElement=I,rs.lazy=function(P){return{$$typeof:x,_payload:{_status:-1,_result:P},_init:Ve}},rs.memo=function(P,re){return{$$typeof:y,type:P,compare:re===void 0?null:re}},rs.startTransition=function(P){var re=C.T,Fe={};C.T=Fe;try{var qe=P(),Ue=C.S;Ue!==null&&Ue(Fe,qe),typeof qe=="object"&&qe!==null&&typeof qe.then=="function"&&qe.then(ke,$e)}catch(Ie){$e(Ie)}finally{re!==null&&Fe.types!==null&&(re.types=Fe.types),C.T=re}},rs.unstable_useCacheRefresh=function(){return C.H.useCacheRefresh()},rs.use=function(P){return C.H.use(P)},rs.useActionState=function(P,re,Fe){return C.H.useActionState(P,re,Fe)},rs.useCallback=function(P,re){return C.H.useCallback(P,re)},rs.useContext=function(P){return C.H.useContext(P)},rs.useDebugValue=function(){},rs.useDeferredValue=function(P,re){return C.H.useDeferredValue(P,re)},rs.useEffect=function(P,re){return C.H.useEffect(P,re)},rs.useEffectEvent=function(P){return C.H.useEffectEvent(P)},rs.useId=function(){return C.H.useId()},rs.useImperativeHandle=function(P,re,Fe){return C.H.useImperativeHandle(P,re,Fe)},rs.useInsertionEffect=function(P,re){return C.H.useInsertionEffect(P,re)},rs.useLayoutEffect=function(P,re){return C.H.useLayoutEffect(P,re)},rs.useMemo=function(P,re){return C.H.useMemo(P,re)},rs.useOptimistic=function(P,re){return C.H.useOptimistic(P,re)},rs.useReducer=function(P,re,Fe){return C.H.useReducer(P,re,Fe)},rs.useRef=function(P){return C.H.useRef(P)},rs.useState=function(P){return C.H.useState(P)},rs.useSyncExternalStore=function(P,re,Fe){return C.H.useSyncExternalStore(P,re,Fe)},rs.useTransition=function(){return C.H.useTransition()},rs.version="19.2.4",rs}var E1;function Bg(){return E1||(E1=1,_p.exports=RT()),_p.exports}var b=Bg(),kp={exports:{}},tu={},jp={exports:{}},Tp={};var N1;function AT(){return N1||(N1=1,(function(n){function e(H,fe){var Ve=H.length;H.push(fe);e:for(;0<Ve;){var $e=Ve-1>>>1,J=H[$e];if(0<l(J,fe))H[$e]=fe,H[Ve]=J,Ve=$e;else break e}}function t(H){return H.length===0?null:H[0]}function i(H){if(H.length===0)return null;var fe=H[0],Ve=H.pop();if(Ve!==fe){H[0]=Ve;e:for(var $e=0,J=H.length,P=J>>>1;$e<P;){var re=2*($e+1)-1,Fe=H[re],qe=re+1,Ue=H[qe];if(0>l(Fe,Ve))qe<J&&0>l(Ue,Fe)?(H[$e]=Ue,H[qe]=Ve,$e=qe):(H[$e]=Fe,H[re]=Ve,$e=re);else if(qe<J&&0>l(Ue,Ve))H[$e]=Ue,H[qe]=Ve,$e=qe;else break e}}return fe}function l(H,fe){var Ve=H.sortIndex-fe.sortIndex;return Ve!==0?Ve:H.id-fe.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;n.unstable_now=function(){return u.now()}}else{var d=Date,p=d.now();n.unstable_now=function(){return d.now()-p}}var g=[],y=[],x=1,_=null,j=3,O=!1,K=!1,B=!1,D=!1,se=typeof setTimeout=="function"?setTimeout:null,Y=typeof clearTimeout=="function"?clearTimeout:null,Z=typeof setImmediate<"u"?setImmediate:null;function je(H){for(var fe=t(y);fe!==null;){if(fe.callback===null)i(y);else if(fe.startTime<=H)i(y),fe.sortIndex=fe.expirationTime,e(g,fe);else break;fe=t(y)}}function Re(H){if(B=!1,je(H),!K)if(t(g)!==null)K=!0,ke||(ke=!0,L());else{var fe=t(y);fe!==null&&ht(Re,fe.startTime-H)}}var ke=!1,C=-1,T=5,M=-1;function V(){return D?!0:!(n.unstable_now()-M<T)}function I(){if(D=!1,ke){var H=n.unstable_now();M=H;var fe=!0;try{e:{K=!1,B&&(B=!1,Y(C),C=-1),O=!0;var Ve=j;try{t:{for(je(H),_=t(g);_!==null&&!(_.expirationTime>H&&V());){var $e=_.callback;if(typeof $e=="function"){_.callback=null,j=_.priorityLevel;var J=$e(_.expirationTime<=H);if(H=n.unstable_now(),typeof J=="function"){_.callback=J,je(H),fe=!0;break t}_===t(g)&&i(g),je(H)}else i(g);_=t(g)}if(_!==null)fe=!0;else{var P=t(y);P!==null&&ht(Re,P.startTime-H),fe=!1}}break e}finally{_=null,j=Ve,O=!1}fe=void 0}}finally{fe?L():ke=!1}}}var L;if(typeof Z=="function")L=function(){Z(I)};else if(typeof MessageChannel<"u"){var A=new MessageChannel,Oe=A.port2;A.port1.onmessage=I,L=function(){Oe.postMessage(null)}}else L=function(){se(I,0)};function ht(H,fe){C=se(function(){H(n.unstable_now())},fe)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(H){H.callback=null},n.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<H?Math.floor(1e3/H):5},n.unstable_getCurrentPriorityLevel=function(){return j},n.unstable_next=function(H){switch(j){case 1:case 2:case 3:var fe=3;break;default:fe=j}var Ve=j;j=fe;try{return H()}finally{j=Ve}},n.unstable_requestPaint=function(){D=!0},n.unstable_runWithPriority=function(H,fe){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var Ve=j;j=H;try{return fe()}finally{j=Ve}},n.unstable_scheduleCallback=function(H,fe,Ve){var $e=n.unstable_now();switch(typeof Ve=="object"&&Ve!==null?(Ve=Ve.delay,Ve=typeof Ve=="number"&&0<Ve?$e+Ve:$e):Ve=$e,H){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=Ve+J,H={id:x++,callback:fe,priorityLevel:H,startTime:Ve,expirationTime:J,sortIndex:-1},Ve>$e?(H.sortIndex=Ve,e(y,H),t(g)===null&&H===t(y)&&(B?(Y(C),C=-1):B=!0,ht(Re,Ve-$e))):(H.sortIndex=J,e(g,H),K||O||(K=!0,ke||(ke=!0,L()))),H},n.unstable_shouldYield=V,n.unstable_wrapCallback=function(H){var fe=j;return function(){var Ve=j;j=fe;try{return H.apply(this,arguments)}finally{j=Ve}}}})(Tp)),Tp}var C1;function MT(){return C1||(C1=1,jp.exports=AT()),jp.exports}var Sp={exports:{}},ir={};var R1;function IT(){if(R1)return ir;R1=1;var n=Bg();function e(g){var y="https://react.dev/errors/"+g;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)y+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+g+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},l=Symbol.for("react.portal");function u(g,y,x){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:_==null?null:""+_,children:g,containerInfo:y,implementation:x}}var d=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(g,y){if(g==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return ir.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,ir.createPortal=function(g,y){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(e(299));return u(g,y,null,x)},ir.flushSync=function(g){var y=d.T,x=i.p;try{if(d.T=null,i.p=2,g)return g()}finally{d.T=y,i.p=x,i.d.f()}},ir.preconnect=function(g,y){typeof g=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,i.d.C(g,y))},ir.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},ir.preinit=function(g,y){if(typeof g=="string"&&y&&typeof y.as=="string"){var x=y.as,_=p(x,y.crossOrigin),j=typeof y.integrity=="string"?y.integrity:void 0,O=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;x==="style"?i.d.S(g,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:_,integrity:j,fetchPriority:O}):x==="script"&&i.d.X(g,{crossOrigin:_,integrity:j,fetchPriority:O,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},ir.preinitModule=function(g,y){if(typeof g=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var x=p(y.as,y.crossOrigin);i.d.M(g,{crossOrigin:x,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&i.d.M(g)},ir.preload=function(g,y){if(typeof g=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var x=y.as,_=p(x,y.crossOrigin);i.d.L(g,x,{crossOrigin:_,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},ir.preloadModule=function(g,y){if(typeof g=="string")if(y){var x=p(y.as,y.crossOrigin);i.d.m(g,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:x,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else i.d.m(g)},ir.requestFormReset=function(g){i.d.r(g)},ir.unstable_batchedUpdates=function(g,y){return g(y)},ir.useFormState=function(g,y,x){return d.H.useFormState(g,y,x)},ir.useFormStatus=function(){return d.H.useHostTransitionStatus()},ir.version="19.2.4",ir}var A1;function DT(){if(A1)return Sp.exports;A1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Sp.exports=IT(),Sp.exports}var M1;function PT(){if(M1)return tu;M1=1;var n=MT(),e=Bg(),t=DT();function i(s){var a="https://react.dev/errors/"+s;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)a+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+s+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function u(s){var a=s,o=s;if(s.alternate)for(;a.return;)a=a.return;else{s=a;do a=s,(a.flags&4098)!==0&&(o=a.return),s=a.return;while(s)}return a.tag===3?o:null}function d(s){if(s.tag===13){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function p(s){if(s.tag===31){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function g(s){if(u(s)!==s)throw Error(i(188))}function y(s){var a=s.alternate;if(!a){if(a=u(s),a===null)throw Error(i(188));return a!==s?null:s}for(var o=s,c=a;;){var m=o.return;if(m===null)break;var f=m.alternate;if(f===null){if(c=m.return,c!==null){o=c;continue}break}if(m.child===f.child){for(f=m.child;f;){if(f===o)return g(m),s;if(f===c)return g(m),a;f=f.sibling}throw Error(i(188))}if(o.return!==c.return)o=m,c=f;else{for(var w=!1,N=m.child;N;){if(N===o){w=!0,o=m,c=f;break}if(N===c){w=!0,c=m,o=f;break}N=N.sibling}if(!w){for(N=f.child;N;){if(N===o){w=!0,o=f,c=m;break}if(N===c){w=!0,c=f,o=m;break}N=N.sibling}if(!w)throw Error(i(189))}}if(o.alternate!==c)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?s:a}function x(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s;for(s=s.child;s!==null;){if(a=x(s),a!==null)return a;s=s.sibling}return null}var _=Object.assign,j=Symbol.for("react.element"),O=Symbol.for("react.transitional.element"),K=Symbol.for("react.portal"),B=Symbol.for("react.fragment"),D=Symbol.for("react.strict_mode"),se=Symbol.for("react.profiler"),Y=Symbol.for("react.consumer"),Z=Symbol.for("react.context"),je=Symbol.for("react.forward_ref"),Re=Symbol.for("react.suspense"),ke=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),M=Symbol.for("react.activity"),V=Symbol.for("react.memo_cache_sentinel"),I=Symbol.iterator;function L(s){return s===null||typeof s!="object"?null:(s=I&&s[I]||s["@@iterator"],typeof s=="function"?s:null)}var A=Symbol.for("react.client.reference");function Oe(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===A?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case B:return"Fragment";case se:return"Profiler";case D:return"StrictMode";case Re:return"Suspense";case ke:return"SuspenseList";case M:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case K:return"Portal";case Z:return s.displayName||"Context";case Y:return(s._context.displayName||"Context")+".Consumer";case je:var a=s.render;return s=s.displayName,s||(s=a.displayName||a.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case C:return a=s.displayName||null,a!==null?a:Oe(s.type)||"Memo";case T:a=s._payload,s=s._init;try{return Oe(s(a))}catch{}}return null}var ht=Array.isArray,H=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,fe=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ve={pending:!1,data:null,method:null,action:null},$e=[],J=-1;function P(s){return{current:s}}function re(s){0>J||(s.current=$e[J],$e[J]=null,J--)}function Fe(s,a){J++,$e[J]=s.current,s.current=a}var qe=P(null),Ue=P(null),Ie=P(null),mt=P(null);function xt(s,a){switch(Fe(Ie,a),Fe(Ue,s),Fe(qe,null),a.nodeType){case 9:case 11:s=(s=a.documentElement)&&(s=s.namespaceURI)?G0(s):0;break;default:if(s=a.tagName,a=a.namespaceURI)a=G0(a),s=K0(a,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}re(qe),Fe(qe,s)}function it(){re(qe),re(Ue),re(Ie)}function ss(s){s.memoizedState!==null&&Fe(mt,s);var a=qe.current,o=K0(a,s.type);a!==o&&(Fe(Ue,s),Fe(qe,o))}function Rs(s){Ue.current===s&&(re(qe),re(Ue)),mt.current===s&&(re(mt),Qc._currentValue=Ve)}var Ut,jt;function ie(s){if(Ut===void 0)try{throw Error()}catch(o){var a=o.stack.trim().match(/\n( *(at )?)/);Ut=a&&a[1]||"",jt=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ut+s+jt}var Mt=!1;function St(s,a){if(!s||Mt)return"";Mt=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(a){var ze=function(){throw Error()};if(Object.defineProperty(ze.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ze,[])}catch(_e){var me=_e}Reflect.construct(s,[],ze)}else{try{ze.call()}catch(_e){me=_e}s.call(ze.prototype)}}else{try{throw Error()}catch(_e){me=_e}(ze=s())&&typeof ze.catch=="function"&&ze.catch(function(){})}}catch(_e){if(_e&&me&&typeof _e.stack=="string")return[_e.stack,me.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var f=c.DetermineComponentFrameRoot(),w=f[0],N=f[1];if(w&&N){var q=w.split(`
`),ue=N.split(`
`);for(m=c=0;c<q.length&&!q[c].includes("DetermineComponentFrameRoot");)c++;for(;m<ue.length&&!ue[m].includes("DetermineComponentFrameRoot");)m++;if(c===q.length||m===ue.length)for(c=q.length-1,m=ue.length-1;1<=c&&0<=m&&q[c]!==ue[m];)m--;for(;1<=c&&0<=m;c--,m--)if(q[c]!==ue[m]){if(c!==1||m!==1)do if(c--,m--,0>m||q[c]!==ue[m]){var Ne=`
`+q[c].replace(" at new "," at ");return s.displayName&&Ne.includes("<anonymous>")&&(Ne=Ne.replace("<anonymous>",s.displayName)),Ne}while(1<=c&&0<=m);break}}}finally{Mt=!1,Error.prepareStackTrace=o}return(o=s?s.displayName||s.name:"")?ie(o):""}function Yt(s,a){switch(s.tag){case 26:case 27:case 5:return ie(s.type);case 16:return ie("Lazy");case 13:return s.child!==a&&a!==null?ie("Suspense Fallback"):ie("Suspense");case 19:return ie("SuspenseList");case 0:case 15:return St(s.type,!1);case 11:return St(s.type.render,!1);case 1:return St(s.type,!0);case 31:return ie("Activity");default:return""}}function Tt(s){try{var a="",o=null;do a+=Yt(s,o),o=s,s=s.return;while(s);return a}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var Et=Object.prototype.hasOwnProperty,ot=n.unstable_scheduleCallback,Pt=n.unstable_cancelCallback,Gt=n.unstable_shouldYield,ps=n.unstable_requestPaint,Kt=n.unstable_now,It=n.unstable_getCurrentPriorityLevel,hs=n.unstable_ImmediatePriority,ws=n.unstable_UserBlockingPriority,is=n.unstable_NormalPriority,Xs=n.unstable_LowPriority,Ps=n.unstable_IdlePriority,qs=n.log,os=n.unstable_setDisableYieldValue,_s=null,ve=null;function De(s){if(typeof qs=="function"&&os(s),ve&&typeof ve.setStrictMode=="function")try{ve.setStrictMode(_s,s)}catch{}}var Pe=Math.clz32?Math.clz32:nt,st=Math.log,Ge=Math.LN2;function nt(s){return s>>>=0,s===0?32:31-(st(s)/Ge|0)|0}var gt=256,X=262144,ne=4194304;function Ke(s){var a=s&42;if(a!==0)return a;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function wt(s,a,o){var c=s.pendingLanes;if(c===0)return 0;var m=0,f=s.suspendedLanes,w=s.pingedLanes;s=s.warmLanes;var N=c&134217727;return N!==0?(c=N&~f,c!==0?m=Ke(c):(w&=N,w!==0?m=Ke(w):o||(o=N&~s,o!==0&&(m=Ke(o))))):(N=c&~f,N!==0?m=Ke(N):w!==0?m=Ke(w):o||(o=c&~s,o!==0&&(m=Ke(o)))),m===0?0:a!==0&&a!==m&&(a&f)===0&&(f=m&-m,o=a&-a,f>=o||f===32&&(o&4194048)!==0)?a:m}function et(s,a){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&a)===0}function _t(s,a){switch(s){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Q(){var s=ne;return ne<<=1,(ne&62914560)===0&&(ne=4194304),s}function Ae(s){for(var a=[],o=0;31>o;o++)a.push(s);return a}function Je(s,a){s.pendingLanes|=a,a!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function yt(s,a,o,c,m,f){var w=s.pendingLanes;s.pendingLanes=o,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=o,s.entangledLanes&=o,s.errorRecoveryDisabledLanes&=o,s.shellSuspendCounter=0;var N=s.entanglements,q=s.expirationTimes,ue=s.hiddenUpdates;for(o=w&~o;0<o;){var Ne=31-Pe(o),ze=1<<Ne;N[Ne]=0,q[Ne]=-1;var me=ue[Ne];if(me!==null)for(ue[Ne]=null,Ne=0;Ne<me.length;Ne++){var _e=me[Ne];_e!==null&&(_e.lane&=-536870913)}o&=~ze}c!==0&&at(s,c,0),f!==0&&m===0&&s.tag!==0&&(s.suspendedLanes|=f&~(w&~a))}function at(s,a,o){s.pendingLanes|=a,s.suspendedLanes&=~a;var c=31-Pe(a);s.entangledLanes|=a,s.entanglements[c]=s.entanglements[c]|1073741824|o&261930}function Zt(s,a){var o=s.entangledLanes|=a;for(s=s.entanglements;o;){var c=31-Pe(o),m=1<<c;m&a|s[c]&a&&(s[c]|=a),o&=~m}}function Qt(s,a){var o=a&-a;return o=(o&42)!==0?1:U(o),(o&(s.suspendedLanes|a))!==0?0:o}function U(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function be(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Ee(){var s=fe.p;return s!==0?s:(s=window.event,s===void 0?32:y1(s.type))}function Te(s,a){var o=fe.p;try{return fe.p=s,a()}finally{fe.p=o}}var Se=Math.random().toString(36).slice(2),bt="__reactFiber$"+Se,Ct="__reactProps$"+Se,ft="__reactContainer$"+Se,zt="__reactEvents$"+Se,Lt="__reactListeners$"+Se,Bs="__reactHandles$"+Se,hn="__reactResources$"+Se,rn="__reactMarker$"+Se;function Tn(s){delete s[bt],delete s[Ct],delete s[zt],delete s[Lt],delete s[Bs]}function As(s){var a=s[bt];if(a)return a;for(var o=s.parentNode;o;){if(a=o[ft]||o[bt]){if(o=a.alternate,a.child!==null||o!==null&&o.child!==null)for(s=t1(s);s!==null;){if(o=s[bt])return o;s=t1(s)}return a}s=o,o=s.parentNode}return null}function sn(s){if(s=s[bt]||s[ft]){var a=s.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return s}return null}function ks(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s.stateNode;throw Error(i(33))}function W(s){var a=s[hn];return a||(a=s[hn]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function de(s){s[rn]=!0}var le=new Set,we={};function S(s,a){F(s,a),F(s+"Capture",a)}function F(s,a){for(we[s]=a,s=0;s<a.length;s++)le.add(a[s])}var ae=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),te={},Ze={};function ut(s){return Et.call(Ze,s)?!0:Et.call(te,s)?!1:ae.test(s)?Ze[s]=!0:(te[s]=!0,!1)}function lt(s,a,o){if(ut(a))if(o===null)s.removeAttribute(a);else{switch(typeof o){case"undefined":case"function":case"symbol":s.removeAttribute(a);return;case"boolean":var c=a.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){s.removeAttribute(a);return}}s.setAttribute(a,""+o)}}function Dt(s,a,o){if(o===null)s.removeAttribute(a);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(a);return}s.setAttribute(a,""+o)}}function vt(s,a,o,c){if(c===null)s.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttributeNS(a,o,""+c)}}function gs(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function ln(s){var a=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function hr(s,a,o){var c=Object.getOwnPropertyDescriptor(s.constructor.prototype,a);if(!s.hasOwnProperty(a)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var m=c.get,f=c.set;return Object.defineProperty(s,a,{configurable:!0,get:function(){return m.call(this)},set:function(w){o=""+w,f.call(this,w)}}),Object.defineProperty(s,a,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(w){o=""+w},stopTracking:function(){s._valueTracker=null,delete s[a]}}}}function ys(s){if(!s._valueTracker){var a=ln(s)?"checked":"value";s._valueTracker=hr(s,a,""+s[a])}}function _r(s){if(!s)return!1;var a=s._valueTracker;if(!a)return!0;var o=a.getValue(),c="";return s&&(c=ln(s)?s.checked?"true":"false":s.value),s=c,s!==o?(a.setValue(s),!0):!1}function mr(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var da=/[\n"\\]/g;function Sn(s){return s.replace(da,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function Ra(s,a,o,c,m,f,w,N){s.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?s.type=w:s.removeAttribute("type"),a!=null?w==="number"?(a===0&&s.value===""||s.value!=a)&&(s.value=""+gs(a)):s.value!==""+gs(a)&&(s.value=""+gs(a)):w!=="submit"&&w!=="reset"||s.removeAttribute("value"),a!=null?Qr(s,w,gs(a)):o!=null?Qr(s,w,gs(o)):c!=null&&s.removeAttribute("value"),m==null&&f!=null&&(s.defaultChecked=!!f),m!=null&&(s.checked=m&&typeof m!="function"&&typeof m!="symbol"),N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?s.name=""+gs(N):s.removeAttribute("name")}function Aa(s,a,o,c,m,f,w,N){if(f!=null&&typeof f!="function"&&typeof f!="symbol"&&typeof f!="boolean"&&(s.type=f),a!=null||o!=null){if(!(f!=="submit"&&f!=="reset"||a!=null)){ys(s);return}o=o!=null?""+gs(o):"",a=a!=null?""+gs(a):o,N||a===s.value||(s.value=a),s.defaultValue=a}c=c??m,c=typeof c!="function"&&typeof c!="symbol"&&!!c,s.checked=N?s.checked:!!c,s.defaultChecked=!!c,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(s.name=w),ys(s)}function Qr(s,a,o){a==="number"&&mr(s.ownerDocument)===s||s.defaultValue===""+o||(s.defaultValue=""+o)}function Or(s,a,o,c){if(s=s.options,a){a={};for(var m=0;m<o.length;m++)a["$"+o[m]]=!0;for(o=0;o<s.length;o++)m=a.hasOwnProperty("$"+s[o].value),s[o].selected!==m&&(s[o].selected=m),m&&c&&(s[o].defaultSelected=!0)}else{for(o=""+gs(o),a=null,m=0;m<s.length;m++){if(s[m].value===o){s[m].selected=!0,c&&(s[m].defaultSelected=!0);return}a!==null||s[m].disabled||(a=s[m])}a!==null&&(a.selected=!0)}}function Ja(s,a,o){if(a!=null&&(a=""+gs(a),a!==s.value&&(s.value=a),o==null)){s.defaultValue!==a&&(s.defaultValue=a);return}s.defaultValue=o!=null?""+gs(o):""}function Br(s,a,o,c){if(a==null){if(c!=null){if(o!=null)throw Error(i(92));if(ht(c)){if(1<c.length)throw Error(i(93));c=c[0]}o=c}o==null&&(o=""),a=o}o=gs(a),s.defaultValue=o,c=s.textContent,c===o&&c!==""&&c!==null&&(s.value=c),ys(s)}function zn(s,a){if(a){var o=s.firstChild;if(o&&o===s.lastChild&&o.nodeType===3){o.nodeValue=a;return}}s.textContent=a}var Ai=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Za(s,a,o){var c=a.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?s.setProperty(a,""):a==="float"?s.cssFloat="":s[a]="":c?s.setProperty(a,o):typeof o!="number"||o===0||Ai.has(a)?a==="float"?s.cssFloat=o:s[a]=(""+o).trim():s[a]=o+"px"}function kr(s,a,o){if(a!=null&&typeof a!="object")throw Error(i(62));if(s=s.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||a!=null&&a.hasOwnProperty(c)||(c.indexOf("--")===0?s.setProperty(c,""):c==="float"?s.cssFloat="":s[c]="");for(var m in a)c=a[m],a.hasOwnProperty(m)&&o[m]!==c&&Za(s,m,c)}else for(var f in a)a.hasOwnProperty(f)&&Za(s,f,a[f])}function Ma(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Mi=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),jr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Tr(s){return jr.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Dn(){}var qn=null;function Pn(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Xr=null,xn=null;function z(s){var a=sn(s);if(a&&(s=a.stateNode)){var o=s[Ct]||null;e:switch(s=a.stateNode,a.type){case"input":if(Ra(s,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),a=o.name,o.type==="radio"&&a!=null){for(o=s;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Sn(""+a)+'"][type="radio"]'),a=0;a<o.length;a++){var c=o[a];if(c!==s&&c.form===s.form){var m=c[Ct]||null;if(!m)throw Error(i(90));Ra(c,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(a=0;a<o.length;a++)c=o[a],c.form===s.form&&_r(c)}break e;case"textarea":Ja(s,o.value,o.defaultValue);break e;case"select":a=o.value,a!=null&&Or(s,!!o.multiple,a,!1)}}}var pe=!1;function he(s,a,o){if(pe)return s(a,o);pe=!0;try{var c=s(a);return c}finally{if(pe=!1,(Xr!==null||xn!==null)&&(Ld(),Xr&&(a=Xr,s=xn,xn=Xr=null,z(a),s)))for(a=0;a<s.length;a++)z(s[a])}}function Ce(s,a){var o=s.stateNode;if(o===null)return null;var c=o[Ct]||null;if(c===null)return null;o=c[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(s=s.type,c=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!c;break e;default:s=!1}if(s)return null;if(o&&typeof o!="function")throw Error(i(231,a,typeof o));return o}var We=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),rt=!1;if(We)try{var dt={};Object.defineProperty(dt,"passive",{get:function(){rt=!0}}),window.addEventListener("test",dt,dt),window.removeEventListener("test",dt,dt)}catch{rt=!1}var Ot=null,es=null,ls=null;function ts(){if(ls)return ls;var s,a=es,o=a.length,c,m="value"in Ot?Ot.value:Ot.textContent,f=m.length;for(s=0;s<o&&a[s]===m[s];s++);var w=o-s;for(c=1;c<=w&&a[o-c]===m[f-c];c++);return ls=m.slice(s,1<c?1-c:void 0)}function E(s){var a=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&a===13&&(s=13)):s=a,s===10&&(s=13),32<=s||s===13?s:0}function $(){return!0}function ge(){return!1}function Me(s){function a(o,c,m,f,w){this._reactName=o,this._targetInst=m,this.type=c,this.nativeEvent=f,this.target=w,this.currentTarget=null;for(var N in s)s.hasOwnProperty(N)&&(o=s[N],this[N]=o?o(f):f[N]);return this.isDefaultPrevented=(f.defaultPrevented!=null?f.defaultPrevented:f.returnValue===!1)?$:ge,this.isPropagationStopped=ge,this}return _(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=$)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=$)},persist:function(){},isPersistent:$}),a}var Qe={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},tt=Me(Qe),Ye=_({},Qe,{view:0,detail:0}),Ft=Me(Ye),Ht,ms,$t,cs=_({},Ye,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ia,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==$t&&($t&&s.type==="mousemove"?(Ht=s.screenX-$t.screenX,ms=s.screenY-$t.screenY):ms=Ht=0,$t=s),Ht)},movementY:function(s){return"movementY"in s?s.movementY:ms}}),Ln=Me(cs),Gn=_({},cs,{dataTransfer:0}),Js=Me(Gn),Zs=_({},Ye,{relatedTarget:0}),On=Me(Zs),Hn=_({},Qe,{animationName:0,elapsedTime:0,pseudoElement:0}),Kn=Me(Hn),Yn=_({},Qe,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Sr=Me(Yn),fr=_({},Qe,{data:0}),fn=Me(fr),Bn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Er={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function So(s){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(s):(s=Nr[s])?!!a[s]:!1}function Ia(){return So}var Qn=_({},Ye,{key:function(s){if(s.key){var a=Bn[s.key]||s.key;if(a!=="Unidentified")return a}return s.type==="keypress"?(s=E(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Er[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ia,charCode:function(s){return s.type==="keypress"?E(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?E(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),ei=Me(Qn),ha=_({},cs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ar=Me(ha),h=_({},Ye,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ia}),v=Me(h),k=_({},Qe,{propertyName:0,elapsedTime:0,pseudoElement:0}),R=Me(k),oe=_({},cs,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),xe=Me(oe),ct=_({},Qe,{newState:0,oldState:0}),us=Me(ct),wn=[9,13,27,32],Fs=We&&"CompositionEvent"in window,cn=null;We&&"documentMode"in document&&(cn=document.documentMode);var Jr=We&&"TextEvent"in window&&!cn,Da=We&&(!Fs||cn&&8<cn&&11>=cn),ma=" ",fa=!1;function Eo(s,a){switch(s){case"keyup":return wn.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ul(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var dl=!1;function Jk(s,a){switch(s){case"compositionend":return ul(a);case"keypress":return a.which!==32?null:(fa=!0,ma);case"textInput":return s=a.data,s===ma&&fa?null:s;default:return null}}function Zk(s,a){if(dl)return s==="compositionend"||!Fs&&Eo(s,a)?(s=ts(),ls=es=Ot=null,dl=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Da&&a.locale!=="ko"?null:a.data;default:return null}}var ej={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function rb(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a==="input"?!!ej[s.type]:a==="textarea"}function ab(s,a,o,c){Xr?xn?xn.push(c):xn=[c]:Xr=c,a=qd(a,"onChange"),0<a.length&&(o=new tt("onChange","change",null,o,c),s.push({event:o,listeners:a}))}var bc=null,vc=null;function tj(s){F0(s,0)}function td(s){var a=ks(s);if(_r(a))return s}function ib(s,a){if(s==="change")return a}var ob=!1;if(We){var Em;if(We){var Nm="oninput"in document;if(!Nm){var lb=document.createElement("div");lb.setAttribute("oninput","return;"),Nm=typeof lb.oninput=="function"}Em=Nm}else Em=!1;ob=Em&&(!document.documentMode||9<document.documentMode)}function cb(){bc&&(bc.detachEvent("onpropertychange",ub),vc=bc=null)}function ub(s){if(s.propertyName==="value"&&td(vc)){var a=[];ab(a,vc,s,Pn(s)),he(tj,a)}}function sj(s,a,o){s==="focusin"?(cb(),bc=a,vc=o,bc.attachEvent("onpropertychange",ub)):s==="focusout"&&cb()}function nj(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return td(vc)}function rj(s,a){if(s==="click")return td(a)}function aj(s,a){if(s==="input"||s==="change")return td(a)}function ij(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var Vr=typeof Object.is=="function"?Object.is:ij;function xc(s,a){if(Vr(s,a))return!0;if(typeof s!="object"||s===null||typeof a!="object"||a===null)return!1;var o=Object.keys(s),c=Object.keys(a);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var m=o[c];if(!Et.call(a,m)||!Vr(s[m],a[m]))return!1}return!0}function db(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function hb(s,a){var o=db(s);s=0;for(var c;o;){if(o.nodeType===3){if(c=s+o.textContent.length,s<=a&&c>=a)return{node:o,offset:a-s};s=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=db(o)}}function mb(s,a){return s&&a?s===a?!0:s&&s.nodeType===3?!1:a&&a.nodeType===3?mb(s,a.parentNode):"contains"in s?s.contains(a):s.compareDocumentPosition?!!(s.compareDocumentPosition(a)&16):!1:!1}function fb(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var a=mr(s.document);a instanceof s.HTMLIFrameElement;){try{var o=typeof a.contentWindow.location.href=="string"}catch{o=!1}if(o)s=a.contentWindow;else break;a=mr(s.document)}return a}function Cm(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a&&(a==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||a==="textarea"||s.contentEditable==="true")}var oj=We&&"documentMode"in document&&11>=document.documentMode,hl=null,Rm=null,wc=null,Am=!1;function pb(s,a,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Am||hl==null||hl!==mr(c)||(c=hl,"selectionStart"in c&&Cm(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),wc&&xc(wc,c)||(wc=c,c=qd(Rm,"onSelect"),0<c.length&&(a=new tt("onSelect","select",null,a,o),s.push({event:a,listeners:c}),a.target=hl)))}function No(s,a){var o={};return o[s.toLowerCase()]=a.toLowerCase(),o["Webkit"+s]="webkit"+a,o["Moz"+s]="moz"+a,o}var ml={animationend:No("Animation","AnimationEnd"),animationiteration:No("Animation","AnimationIteration"),animationstart:No("Animation","AnimationStart"),transitionrun:No("Transition","TransitionRun"),transitionstart:No("Transition","TransitionStart"),transitioncancel:No("Transition","TransitionCancel"),transitionend:No("Transition","TransitionEnd")},Mm={},gb={};We&&(gb=document.createElement("div").style,"AnimationEvent"in window||(delete ml.animationend.animation,delete ml.animationiteration.animation,delete ml.animationstart.animation),"TransitionEvent"in window||delete ml.transitionend.transition);function Co(s){if(Mm[s])return Mm[s];if(!ml[s])return s;var a=ml[s],o;for(o in a)if(a.hasOwnProperty(o)&&o in gb)return Mm[s]=a[o];return s}var yb=Co("animationend"),bb=Co("animationiteration"),vb=Co("animationstart"),lj=Co("transitionrun"),cj=Co("transitionstart"),uj=Co("transitioncancel"),xb=Co("transitionend"),wb=new Map,Im="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Im.push("scrollEnd");function pa(s,a){wb.set(s,a),S(a,[s])}var sd=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Zr=[],fl=0,Dm=0;function nd(){for(var s=fl,a=Dm=fl=0;a<s;){var o=Zr[a];Zr[a++]=null;var c=Zr[a];Zr[a++]=null;var m=Zr[a];Zr[a++]=null;var f=Zr[a];if(Zr[a++]=null,c!==null&&m!==null){var w=c.pending;w===null?m.next=m:(m.next=w.next,w.next=m),c.pending=m}f!==0&&_b(o,m,f)}}function rd(s,a,o,c){Zr[fl++]=s,Zr[fl++]=a,Zr[fl++]=o,Zr[fl++]=c,Dm|=c,s.lanes|=c,s=s.alternate,s!==null&&(s.lanes|=c)}function Pm(s,a,o,c){return rd(s,a,o,c),ad(s)}function Ro(s,a){return rd(s,null,null,a),ad(s)}function _b(s,a,o){s.lanes|=o;var c=s.alternate;c!==null&&(c.lanes|=o);for(var m=!1,f=s.return;f!==null;)f.childLanes|=o,c=f.alternate,c!==null&&(c.childLanes|=o),f.tag===22&&(s=f.stateNode,s===null||s._visibility&1||(m=!0)),s=f,f=f.return;return s.tag===3?(f=s.stateNode,m&&a!==null&&(m=31-Pe(o),s=f.hiddenUpdates,c=s[m],c===null?s[m]=[a]:c.push(a),a.lane=o|536870912),f):null}function ad(s){if(50<qc)throw qc=0,$f=null,Error(i(185));for(var a=s.return;a!==null;)s=a,a=s.return;return s.tag===3?s.stateNode:null}var pl={};function dj(s,a,o,c){this.tag=s,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ur(s,a,o,c){return new dj(s,a,o,c)}function Lm(s){return s=s.prototype,!(!s||!s.isReactComponent)}function ti(s,a){var o=s.alternate;return o===null?(o=Ur(s.tag,a,s.key,s.mode),o.elementType=s.elementType,o.type=s.type,o.stateNode=s.stateNode,o.alternate=s,s.alternate=o):(o.pendingProps=a,o.type=s.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=s.flags&65011712,o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,a=s.dependencies,o.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},o.sibling=s.sibling,o.index=s.index,o.ref=s.ref,o.refCleanup=s.refCleanup,o}function kb(s,a){s.flags&=65011714;var o=s.alternate;return o===null?(s.childLanes=0,s.lanes=a,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,a=o.dependencies,s.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),s}function id(s,a,o,c,m,f){var w=0;if(c=s,typeof s=="function")Lm(s)&&(w=1);else if(typeof s=="string")w=gT(s,o,qe.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case M:return s=Ur(31,o,a,m),s.elementType=M,s.lanes=f,s;case B:return Ao(o.children,m,f,a);case D:w=8,m|=24;break;case se:return s=Ur(12,o,a,m|2),s.elementType=se,s.lanes=f,s;case Re:return s=Ur(13,o,a,m),s.elementType=Re,s.lanes=f,s;case ke:return s=Ur(19,o,a,m),s.elementType=ke,s.lanes=f,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case Z:w=10;break e;case Y:w=9;break e;case je:w=11;break e;case C:w=14;break e;case T:w=16,c=null;break e}w=29,o=Error(i(130,s===null?"null":typeof s,"")),c=null}return a=Ur(w,o,a,m),a.elementType=s,a.type=c,a.lanes=f,a}function Ao(s,a,o,c){return s=Ur(7,s,c,a),s.lanes=o,s}function Om(s,a,o){return s=Ur(6,s,null,a),s.lanes=o,s}function jb(s){var a=Ur(18,null,null,0);return a.stateNode=s,a}function Bm(s,a,o){return a=Ur(4,s.children!==null?s.children:[],s.key,a),a.lanes=o,a.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},a}var Tb=new WeakMap;function ea(s,a){if(typeof s=="object"&&s!==null){var o=Tb.get(s);return o!==void 0?o:(a={value:s,source:a,stack:Tt(a)},Tb.set(s,a),a)}return{value:s,source:a,stack:Tt(a)}}var gl=[],yl=0,od=null,_c=0,ta=[],sa=0,Ii=null,Pa=1,La="";function si(s,a){gl[yl++]=_c,gl[yl++]=od,od=s,_c=a}function Sb(s,a,o){ta[sa++]=Pa,ta[sa++]=La,ta[sa++]=Ii,Ii=s;var c=Pa;s=La;var m=32-Pe(c)-1;c&=~(1<<m),o+=1;var f=32-Pe(a)+m;if(30<f){var w=m-m%5;f=(c&(1<<w)-1).toString(32),c>>=w,m-=w,Pa=1<<32-Pe(a)+m|o<<m|c,La=f+s}else Pa=1<<f|o<<m|c,La=s}function Vm(s){s.return!==null&&(si(s,1),Sb(s,1,0))}function Um(s){for(;s===od;)od=gl[--yl],gl[yl]=null,_c=gl[--yl],gl[yl]=null;for(;s===Ii;)Ii=ta[--sa],ta[sa]=null,La=ta[--sa],ta[sa]=null,Pa=ta[--sa],ta[sa]=null}function Eb(s,a){ta[sa++]=Pa,ta[sa++]=La,ta[sa++]=Ii,Pa=a.id,La=a.overflow,Ii=s}var Xn=null,an=null,Ms=!1,Di=null,na=!1,Fm=Error(i(519));function Pi(s){var a=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw kc(ea(a,s)),Fm}function Nb(s){var a=s.stateNode,o=s.type,c=s.memoizedProps;switch(a[bt]=s,a[Ct]=c,o){case"dialog":xs("cancel",a),xs("close",a);break;case"iframe":case"object":case"embed":xs("load",a);break;case"video":case"audio":for(o=0;o<$c.length;o++)xs($c[o],a);break;case"source":xs("error",a);break;case"img":case"image":case"link":xs("error",a),xs("load",a);break;case"details":xs("toggle",a);break;case"input":xs("invalid",a),Aa(a,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":xs("invalid",a);break;case"textarea":xs("invalid",a),Br(a,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||a.textContent===""+o||c.suppressHydrationWarning===!0||$0(a.textContent,o)?(c.popover!=null&&(xs("beforetoggle",a),xs("toggle",a)),c.onScroll!=null&&xs("scroll",a),c.onScrollEnd!=null&&xs("scrollend",a),c.onClick!=null&&(a.onclick=Dn),a=!0):a=!1,a||Pi(s,!0)}function Cb(s){for(Xn=s.return;Xn;)switch(Xn.tag){case 5:case 31:case 13:na=!1;return;case 27:case 3:na=!0;return;default:Xn=Xn.return}}function bl(s){if(s!==Xn)return!1;if(!Ms)return Cb(s),Ms=!0,!1;var a=s.tag,o;if((o=a!==3&&a!==27)&&((o=a===5)&&(o=s.type,o=!(o!=="form"&&o!=="button")||ip(s.type,s.memoizedProps)),o=!o),o&&an&&Pi(s),Cb(s),a===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));an=e1(s)}else if(a===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));an=e1(s)}else a===27?(a=an,Yi(s.type)?(s=dp,dp=null,an=s):an=a):an=Xn?aa(s.stateNode.nextSibling):null;return!0}function Mo(){an=Xn=null,Ms=!1}function zm(){var s=Di;return s!==null&&(Mr===null?Mr=s:Mr.push.apply(Mr,s),Di=null),s}function kc(s){Di===null?Di=[s]:Di.push(s)}var qm=P(null),Io=null,ni=null;function Li(s,a,o){Fe(qm,a._currentValue),a._currentValue=o}function ri(s){s._currentValue=qm.current,re(qm)}function Hm(s,a,o){for(;s!==null;){var c=s.alternate;if((s.childLanes&a)!==a?(s.childLanes|=a,c!==null&&(c.childLanes|=a)):c!==null&&(c.childLanes&a)!==a&&(c.childLanes|=a),s===o)break;s=s.return}}function $m(s,a,o,c){var m=s.child;for(m!==null&&(m.return=s);m!==null;){var f=m.dependencies;if(f!==null){var w=m.child;f=f.firstContext;e:for(;f!==null;){var N=f;f=m;for(var q=0;q<a.length;q++)if(N.context===a[q]){f.lanes|=o,N=f.alternate,N!==null&&(N.lanes|=o),Hm(f.return,o,s),c||(w=null);break e}f=N.next}}else if(m.tag===18){if(w=m.return,w===null)throw Error(i(341));w.lanes|=o,f=w.alternate,f!==null&&(f.lanes|=o),Hm(w,o,s),w=null}else w=m.child;if(w!==null)w.return=m;else for(w=m;w!==null;){if(w===s){w=null;break}if(m=w.sibling,m!==null){m.return=w.return,w=m;break}w=w.return}m=w}}function vl(s,a,o,c){s=null;for(var m=a,f=!1;m!==null;){if(!f){if((m.flags&524288)!==0)f=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var w=m.alternate;if(w===null)throw Error(i(387));if(w=w.memoizedProps,w!==null){var N=m.type;Vr(m.pendingProps.value,w.value)||(s!==null?s.push(N):s=[N])}}else if(m===mt.current){if(w=m.alternate,w===null)throw Error(i(387));w.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(s!==null?s.push(Qc):s=[Qc])}m=m.return}s!==null&&$m(a,s,o,c),a.flags|=262144}function ld(s){for(s=s.firstContext;s!==null;){if(!Vr(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Do(s){Io=s,ni=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Jn(s){return Rb(Io,s)}function cd(s,a){return Io===null&&Do(s),Rb(s,a)}function Rb(s,a){var o=a._currentValue;if(a={context:a,memoizedValue:o,next:null},ni===null){if(s===null)throw Error(i(308));ni=a,s.dependencies={lanes:0,firstContext:a},s.flags|=524288}else ni=ni.next=a;return o}var hj=typeof AbortController<"u"?AbortController:function(){var s=[],a=this.signal={aborted:!1,addEventListener:function(o,c){s.push(c)}};this.abort=function(){a.aborted=!0,s.forEach(function(o){return o()})}},mj=n.unstable_scheduleCallback,fj=n.unstable_NormalPriority,En={$$typeof:Z,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Wm(){return{controller:new hj,data:new Map,refCount:0}}function jc(s){s.refCount--,s.refCount===0&&mj(fj,function(){s.controller.abort()})}var Tc=null,Gm=0,xl=0,wl=null;function pj(s,a){if(Tc===null){var o=Tc=[];Gm=0,xl=Xf(),wl={status:"pending",value:void 0,then:function(c){o.push(c)}}}return Gm++,a.then(Ab,Ab),a}function Ab(){if(--Gm===0&&Tc!==null){wl!==null&&(wl.status="fulfilled");var s=Tc;Tc=null,xl=0,wl=null;for(var a=0;a<s.length;a++)(0,s[a])()}}function gj(s,a){var o=[],c={status:"pending",value:null,reason:null,then:function(m){o.push(m)}};return s.then(function(){c.status="fulfilled",c.value=a;for(var m=0;m<o.length;m++)(0,o[m])(a)},function(m){for(c.status="rejected",c.reason=m,m=0;m<o.length;m++)(0,o[m])(void 0)}),c}var Mb=H.S;H.S=function(s,a){p0=Kt(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&pj(s,a),Mb!==null&&Mb(s,a)};var Po=P(null);function Km(){var s=Po.current;return s!==null?s:en.pooledCache}function ud(s,a){a===null?Fe(Po,Po.current):Fe(Po,a.pool)}function Ib(){var s=Km();return s===null?null:{parent:En._currentValue,pool:s}}var _l=Error(i(460)),Ym=Error(i(474)),dd=Error(i(542)),hd={then:function(){}};function Db(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Pb(s,a,o){switch(o=s[o],o===void 0?s.push(a):o!==a&&(a.then(Dn,Dn),a=o),a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,Ob(s),s;default:if(typeof a.status=="string")a.then(Dn,Dn);else{if(s=en,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=a,s.status="pending",s.then(function(c){if(a.status==="pending"){var m=a;m.status="fulfilled",m.value=c}},function(c){if(a.status==="pending"){var m=a;m.status="rejected",m.reason=c}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,Ob(s),s}throw Oo=a,_l}}function Lo(s){try{var a=s._init;return a(s._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(Oo=o,_l):o}}var Oo=null;function Lb(){if(Oo===null)throw Error(i(459));var s=Oo;return Oo=null,s}function Ob(s){if(s===_l||s===dd)throw Error(i(483))}var kl=null,Sc=0;function md(s){var a=Sc;return Sc+=1,kl===null&&(kl=[]),Pb(kl,s,a)}function Ec(s,a){a=a.props.ref,s.ref=a!==void 0?a:null}function fd(s,a){throw a.$$typeof===j?Error(i(525)):(s=Object.prototype.toString.call(a),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":s)))}function Bb(s){function a(ee,G){if(s){var ce=ee.deletions;ce===null?(ee.deletions=[G],ee.flags|=16):ce.push(G)}}function o(ee,G){if(!s)return null;for(;G!==null;)a(ee,G),G=G.sibling;return null}function c(ee){for(var G=new Map;ee!==null;)ee.key!==null?G.set(ee.key,ee):G.set(ee.index,ee),ee=ee.sibling;return G}function m(ee,G){return ee=ti(ee,G),ee.index=0,ee.sibling=null,ee}function f(ee,G,ce){return ee.index=ce,s?(ce=ee.alternate,ce!==null?(ce=ce.index,ce<G?(ee.flags|=67108866,G):ce):(ee.flags|=67108866,G)):(ee.flags|=1048576,G)}function w(ee){return s&&ee.alternate===null&&(ee.flags|=67108866),ee}function N(ee,G,ce,Be){return G===null||G.tag!==6?(G=Om(ce,ee.mode,Be),G.return=ee,G):(G=m(G,ce),G.return=ee,G)}function q(ee,G,ce,Be){var Bt=ce.type;return Bt===B?Ne(ee,G,ce.props.children,Be,ce.key):G!==null&&(G.elementType===Bt||typeof Bt=="object"&&Bt!==null&&Bt.$$typeof===T&&Lo(Bt)===G.type)?(G=m(G,ce.props),Ec(G,ce),G.return=ee,G):(G=id(ce.type,ce.key,ce.props,null,ee.mode,Be),Ec(G,ce),G.return=ee,G)}function ue(ee,G,ce,Be){return G===null||G.tag!==4||G.stateNode.containerInfo!==ce.containerInfo||G.stateNode.implementation!==ce.implementation?(G=Bm(ce,ee.mode,Be),G.return=ee,G):(G=m(G,ce.children||[]),G.return=ee,G)}function Ne(ee,G,ce,Be,Bt){return G===null||G.tag!==7?(G=Ao(ce,ee.mode,Be,Bt),G.return=ee,G):(G=m(G,ce),G.return=ee,G)}function ze(ee,G,ce){if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return G=Om(""+G,ee.mode,ce),G.return=ee,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case O:return ce=id(G.type,G.key,G.props,null,ee.mode,ce),Ec(ce,G),ce.return=ee,ce;case K:return G=Bm(G,ee.mode,ce),G.return=ee,G;case T:return G=Lo(G),ze(ee,G,ce)}if(ht(G)||L(G))return G=Ao(G,ee.mode,ce,null),G.return=ee,G;if(typeof G.then=="function")return ze(ee,md(G),ce);if(G.$$typeof===Z)return ze(ee,cd(ee,G),ce);fd(ee,G)}return null}function me(ee,G,ce,Be){var Bt=G!==null?G.key:null;if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return Bt!==null?null:N(ee,G,""+ce,Be);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case O:return ce.key===Bt?q(ee,G,ce,Be):null;case K:return ce.key===Bt?ue(ee,G,ce,Be):null;case T:return ce=Lo(ce),me(ee,G,ce,Be)}if(ht(ce)||L(ce))return Bt!==null?null:Ne(ee,G,ce,Be,null);if(typeof ce.then=="function")return me(ee,G,md(ce),Be);if(ce.$$typeof===Z)return me(ee,G,cd(ee,ce),Be);fd(ee,ce)}return null}function _e(ee,G,ce,Be,Bt){if(typeof Be=="string"&&Be!==""||typeof Be=="number"||typeof Be=="bigint")return ee=ee.get(ce)||null,N(G,ee,""+Be,Bt);if(typeof Be=="object"&&Be!==null){switch(Be.$$typeof){case O:return ee=ee.get(Be.key===null?ce:Be.key)||null,q(G,ee,Be,Bt);case K:return ee=ee.get(Be.key===null?ce:Be.key)||null,ue(G,ee,Be,Bt);case T:return Be=Lo(Be),_e(ee,G,ce,Be,Bt)}if(ht(Be)||L(Be))return ee=ee.get(ce)||null,Ne(G,ee,Be,Bt,null);if(typeof Be.then=="function")return _e(ee,G,ce,md(Be),Bt);if(Be.$$typeof===Z)return _e(ee,G,ce,cd(G,Be),Bt);fd(G,Be)}return null}function Nt(ee,G,ce,Be){for(var Bt=null,Vs=null,At=G,fs=G=0,Ts=null;At!==null&&fs<ce.length;fs++){At.index>fs?(Ts=At,At=null):Ts=At.sibling;var Us=me(ee,At,ce[fs],Be);if(Us===null){At===null&&(At=Ts);break}s&&At&&Us.alternate===null&&a(ee,At),G=f(Us,G,fs),Vs===null?Bt=Us:Vs.sibling=Us,Vs=Us,At=Ts}if(fs===ce.length)return o(ee,At),Ms&&si(ee,fs),Bt;if(At===null){for(;fs<ce.length;fs++)At=ze(ee,ce[fs],Be),At!==null&&(G=f(At,G,fs),Vs===null?Bt=At:Vs.sibling=At,Vs=At);return Ms&&si(ee,fs),Bt}for(At=c(At);fs<ce.length;fs++)Ts=_e(At,ee,fs,ce[fs],Be),Ts!==null&&(s&&Ts.alternate!==null&&At.delete(Ts.key===null?fs:Ts.key),G=f(Ts,G,fs),Vs===null?Bt=Ts:Vs.sibling=Ts,Vs=Ts);return s&&At.forEach(function(eo){return a(ee,eo)}),Ms&&si(ee,fs),Bt}function Wt(ee,G,ce,Be){if(ce==null)throw Error(i(151));for(var Bt=null,Vs=null,At=G,fs=G=0,Ts=null,Us=ce.next();At!==null&&!Us.done;fs++,Us=ce.next()){At.index>fs?(Ts=At,At=null):Ts=At.sibling;var eo=me(ee,At,Us.value,Be);if(eo===null){At===null&&(At=Ts);break}s&&At&&eo.alternate===null&&a(ee,At),G=f(eo,G,fs),Vs===null?Bt=eo:Vs.sibling=eo,Vs=eo,At=Ts}if(Us.done)return o(ee,At),Ms&&si(ee,fs),Bt;if(At===null){for(;!Us.done;fs++,Us=ce.next())Us=ze(ee,Us.value,Be),Us!==null&&(G=f(Us,G,fs),Vs===null?Bt=Us:Vs.sibling=Us,Vs=Us);return Ms&&si(ee,fs),Bt}for(At=c(At);!Us.done;fs++,Us=ce.next())Us=_e(At,ee,fs,Us.value,Be),Us!==null&&(s&&Us.alternate!==null&&At.delete(Us.key===null?fs:Us.key),G=f(Us,G,fs),Vs===null?Bt=Us:Vs.sibling=Us,Vs=Us);return s&&At.forEach(function(ET){return a(ee,ET)}),Ms&&si(ee,fs),Bt}function Ys(ee,G,ce,Be){if(typeof ce=="object"&&ce!==null&&ce.type===B&&ce.key===null&&(ce=ce.props.children),typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case O:e:{for(var Bt=ce.key;G!==null;){if(G.key===Bt){if(Bt=ce.type,Bt===B){if(G.tag===7){o(ee,G.sibling),Be=m(G,ce.props.children),Be.return=ee,ee=Be;break e}}else if(G.elementType===Bt||typeof Bt=="object"&&Bt!==null&&Bt.$$typeof===T&&Lo(Bt)===G.type){o(ee,G.sibling),Be=m(G,ce.props),Ec(Be,ce),Be.return=ee,ee=Be;break e}o(ee,G);break}else a(ee,G);G=G.sibling}ce.type===B?(Be=Ao(ce.props.children,ee.mode,Be,ce.key),Be.return=ee,ee=Be):(Be=id(ce.type,ce.key,ce.props,null,ee.mode,Be),Ec(Be,ce),Be.return=ee,ee=Be)}return w(ee);case K:e:{for(Bt=ce.key;G!==null;){if(G.key===Bt)if(G.tag===4&&G.stateNode.containerInfo===ce.containerInfo&&G.stateNode.implementation===ce.implementation){o(ee,G.sibling),Be=m(G,ce.children||[]),Be.return=ee,ee=Be;break e}else{o(ee,G);break}else a(ee,G);G=G.sibling}Be=Bm(ce,ee.mode,Be),Be.return=ee,ee=Be}return w(ee);case T:return ce=Lo(ce),Ys(ee,G,ce,Be)}if(ht(ce))return Nt(ee,G,ce,Be);if(L(ce)){if(Bt=L(ce),typeof Bt!="function")throw Error(i(150));return ce=Bt.call(ce),Wt(ee,G,ce,Be)}if(typeof ce.then=="function")return Ys(ee,G,md(ce),Be);if(ce.$$typeof===Z)return Ys(ee,G,cd(ee,ce),Be);fd(ee,ce)}return typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint"?(ce=""+ce,G!==null&&G.tag===6?(o(ee,G.sibling),Be=m(G,ce),Be.return=ee,ee=Be):(o(ee,G),Be=Om(ce,ee.mode,Be),Be.return=ee,ee=Be),w(ee)):o(ee,G)}return function(ee,G,ce,Be){try{Sc=0;var Bt=Ys(ee,G,ce,Be);return kl=null,Bt}catch(At){if(At===_l||At===dd)throw At;var Vs=Ur(29,At,null,ee.mode);return Vs.lanes=Be,Vs.return=ee,Vs}}}var Bo=Bb(!0),Vb=Bb(!1),Oi=!1;function Qm(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Xm(s,a){s=s.updateQueue,a.updateQueue===s&&(a.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Bi(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Vi(s,a,o){var c=s.updateQueue;if(c===null)return null;if(c=c.shared,(zs&2)!==0){var m=c.pending;return m===null?a.next=a:(a.next=m.next,m.next=a),c.pending=a,a=ad(s),_b(s,null,o),a}return rd(s,c,a,o),ad(s)}function Nc(s,a,o){if(a=a.updateQueue,a!==null&&(a=a.shared,(o&4194048)!==0)){var c=a.lanes;c&=s.pendingLanes,o|=c,a.lanes=o,Zt(s,o)}}function Jm(s,a){var o=s.updateQueue,c=s.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var m=null,f=null;if(o=o.firstBaseUpdate,o!==null){do{var w={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};f===null?m=f=w:f=f.next=w,o=o.next}while(o!==null);f===null?m=f=a:f=f.next=a}else m=f=a;o={baseState:c.baseState,firstBaseUpdate:m,lastBaseUpdate:f,shared:c.shared,callbacks:c.callbacks},s.updateQueue=o;return}s=o.lastBaseUpdate,s===null?o.firstBaseUpdate=a:s.next=a,o.lastBaseUpdate=a}var Zm=!1;function Cc(){if(Zm){var s=wl;if(s!==null)throw s}}function Rc(s,a,o,c){Zm=!1;var m=s.updateQueue;Oi=!1;var f=m.firstBaseUpdate,w=m.lastBaseUpdate,N=m.shared.pending;if(N!==null){m.shared.pending=null;var q=N,ue=q.next;q.next=null,w===null?f=ue:w.next=ue,w=q;var Ne=s.alternate;Ne!==null&&(Ne=Ne.updateQueue,N=Ne.lastBaseUpdate,N!==w&&(N===null?Ne.firstBaseUpdate=ue:N.next=ue,Ne.lastBaseUpdate=q))}if(f!==null){var ze=m.baseState;w=0,Ne=ue=q=null,N=f;do{var me=N.lane&-536870913,_e=me!==N.lane;if(_e?(js&me)===me:(c&me)===me){me!==0&&me===xl&&(Zm=!0),Ne!==null&&(Ne=Ne.next={lane:0,tag:N.tag,payload:N.payload,callback:null,next:null});e:{var Nt=s,Wt=N;me=a;var Ys=o;switch(Wt.tag){case 1:if(Nt=Wt.payload,typeof Nt=="function"){ze=Nt.call(Ys,ze,me);break e}ze=Nt;break e;case 3:Nt.flags=Nt.flags&-65537|128;case 0:if(Nt=Wt.payload,me=typeof Nt=="function"?Nt.call(Ys,ze,me):Nt,me==null)break e;ze=_({},ze,me);break e;case 2:Oi=!0}}me=N.callback,me!==null&&(s.flags|=64,_e&&(s.flags|=8192),_e=m.callbacks,_e===null?m.callbacks=[me]:_e.push(me))}else _e={lane:me,tag:N.tag,payload:N.payload,callback:N.callback,next:null},Ne===null?(ue=Ne=_e,q=ze):Ne=Ne.next=_e,w|=me;if(N=N.next,N===null){if(N=m.shared.pending,N===null)break;_e=N,N=_e.next,_e.next=null,m.lastBaseUpdate=_e,m.shared.pending=null}}while(!0);Ne===null&&(q=ze),m.baseState=q,m.firstBaseUpdate=ue,m.lastBaseUpdate=Ne,f===null&&(m.shared.lanes=0),Hi|=w,s.lanes=w,s.memoizedState=ze}}function Ub(s,a){if(typeof s!="function")throw Error(i(191,s));s.call(a)}function Fb(s,a){var o=s.callbacks;if(o!==null)for(s.callbacks=null,s=0;s<o.length;s++)Ub(o[s],a)}var jl=P(null),pd=P(0);function zb(s,a){s=mi,Fe(pd,s),Fe(jl,a),mi=s|a.baseLanes}function ef(){Fe(pd,mi),Fe(jl,jl.current)}function tf(){mi=pd.current,re(jl),re(pd)}var Fr=P(null),ra=null;function Ui(s){var a=s.alternate;Fe(_n,_n.current&1),Fe(Fr,s),ra===null&&(a===null||jl.current!==null||a.memoizedState!==null)&&(ra=s)}function sf(s){Fe(_n,_n.current),Fe(Fr,s),ra===null&&(ra=s)}function qb(s){s.tag===22?(Fe(_n,_n.current),Fe(Fr,s),ra===null&&(ra=s)):Fi()}function Fi(){Fe(_n,_n.current),Fe(Fr,Fr.current)}function zr(s){re(Fr),ra===s&&(ra=null),re(_n)}var _n=P(0);function gd(s){for(var a=s;a!==null;){if(a.tag===13){var o=a.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||cp(o)||up(o)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var ai=0,ds=null,Gs=null,Nn=null,yd=!1,Tl=!1,Vo=!1,bd=0,Ac=0,Sl=null,yj=0;function pn(){throw Error(i(321))}function nf(s,a){if(a===null)return!1;for(var o=0;o<a.length&&o<s.length;o++)if(!Vr(s[o],a[o]))return!1;return!0}function rf(s,a,o,c,m,f){return ai=f,ds=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,H.H=s===null||s.memoizedState===null?Sv:xf,Vo=!1,f=o(c,m),Vo=!1,Tl&&(f=$b(a,o,c,m)),Hb(s),f}function Hb(s){H.H=Dc;var a=Gs!==null&&Gs.next!==null;if(ai=0,Nn=Gs=ds=null,yd=!1,Ac=0,Sl=null,a)throw Error(i(300));s===null||Cn||(s=s.dependencies,s!==null&&ld(s)&&(Cn=!0))}function $b(s,a,o,c){ds=s;var m=0;do{if(Tl&&(Sl=null),Ac=0,Tl=!1,25<=m)throw Error(i(301));if(m+=1,Nn=Gs=null,s.updateQueue!=null){var f=s.updateQueue;f.lastEffect=null,f.events=null,f.stores=null,f.memoCache!=null&&(f.memoCache.index=0)}H.H=Ev,f=a(o,c)}while(Tl);return f}function bj(){var s=H.H,a=s.useState()[0];return a=typeof a.then=="function"?Mc(a):a,s=s.useState()[0],(Gs!==null?Gs.memoizedState:null)!==s&&(ds.flags|=1024),a}function af(){var s=bd!==0;return bd=0,s}function of(s,a,o){a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~o}function lf(s){if(yd){for(s=s.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}yd=!1}ai=0,Nn=Gs=ds=null,Tl=!1,Ac=bd=0,Sl=null}function pr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Nn===null?ds.memoizedState=Nn=s:Nn=Nn.next=s,Nn}function kn(){if(Gs===null){var s=ds.alternate;s=s!==null?s.memoizedState:null}else s=Gs.next;var a=Nn===null?ds.memoizedState:Nn.next;if(a!==null)Nn=a,Gs=s;else{if(s===null)throw ds.alternate===null?Error(i(467)):Error(i(310));Gs=s,s={memoizedState:Gs.memoizedState,baseState:Gs.baseState,baseQueue:Gs.baseQueue,queue:Gs.queue,next:null},Nn===null?ds.memoizedState=Nn=s:Nn=Nn.next=s}return Nn}function vd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Mc(s){var a=Ac;return Ac+=1,Sl===null&&(Sl=[]),s=Pb(Sl,s,a),a=ds,(Nn===null?a.memoizedState:Nn.next)===null&&(a=a.alternate,H.H=a===null||a.memoizedState===null?Sv:xf),s}function xd(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Mc(s);if(s.$$typeof===Z)return Jn(s)}throw Error(i(438,String(s)))}function cf(s){var a=null,o=ds.updateQueue;if(o!==null&&(a=o.memoCache),a==null){var c=ds.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(a={data:c.data.map(function(m){return m.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),o===null&&(o=vd(),ds.updateQueue=o),o.memoCache=a,o=a.data[a.index],o===void 0)for(o=a.data[a.index]=Array(s),c=0;c<s;c++)o[c]=V;return a.index++,o}function ii(s,a){return typeof a=="function"?a(s):a}function wd(s){var a=kn();return uf(a,Gs,s)}function uf(s,a,o){var c=s.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=o;var m=s.baseQueue,f=c.pending;if(f!==null){if(m!==null){var w=m.next;m.next=f.next,f.next=w}a.baseQueue=m=f,c.pending=null}if(f=s.baseState,m===null)s.memoizedState=f;else{a=m.next;var N=w=null,q=null,ue=a,Ne=!1;do{var ze=ue.lane&-536870913;if(ze!==ue.lane?(js&ze)===ze:(ai&ze)===ze){var me=ue.revertLane;if(me===0)q!==null&&(q=q.next={lane:0,revertLane:0,gesture:null,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null}),ze===xl&&(Ne=!0);else if((ai&me)===me){ue=ue.next,me===xl&&(Ne=!0);continue}else ze={lane:0,revertLane:ue.revertLane,gesture:null,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null},q===null?(N=q=ze,w=f):q=q.next=ze,ds.lanes|=me,Hi|=me;ze=ue.action,Vo&&o(f,ze),f=ue.hasEagerState?ue.eagerState:o(f,ze)}else me={lane:ze,revertLane:ue.revertLane,gesture:ue.gesture,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null},q===null?(N=q=me,w=f):q=q.next=me,ds.lanes|=ze,Hi|=ze;ue=ue.next}while(ue!==null&&ue!==a);if(q===null?w=f:q.next=N,!Vr(f,s.memoizedState)&&(Cn=!0,Ne&&(o=wl,o!==null)))throw o;s.memoizedState=f,s.baseState=w,s.baseQueue=q,c.lastRenderedState=f}return m===null&&(c.lanes=0),[s.memoizedState,c.dispatch]}function df(s){var a=kn(),o=a.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=s;var c=o.dispatch,m=o.pending,f=a.memoizedState;if(m!==null){o.pending=null;var w=m=m.next;do f=s(f,w.action),w=w.next;while(w!==m);Vr(f,a.memoizedState)||(Cn=!0),a.memoizedState=f,a.baseQueue===null&&(a.baseState=f),o.lastRenderedState=f}return[f,c]}function Wb(s,a,o){var c=ds,m=kn(),f=Ms;if(f){if(o===void 0)throw Error(i(407));o=o()}else o=a();var w=!Vr((Gs||m).memoizedState,o);if(w&&(m.memoizedState=o,Cn=!0),m=m.queue,ff(Yb.bind(null,c,m,s),[s]),m.getSnapshot!==a||w||Nn!==null&&Nn.memoizedState.tag&1){if(c.flags|=2048,El(9,{destroy:void 0},Kb.bind(null,c,m,o,a),null),en===null)throw Error(i(349));f||(ai&127)!==0||Gb(c,a,o)}return o}function Gb(s,a,o){s.flags|=16384,s={getSnapshot:a,value:o},a=ds.updateQueue,a===null?(a=vd(),ds.updateQueue=a,a.stores=[s]):(o=a.stores,o===null?a.stores=[s]:o.push(s))}function Kb(s,a,o,c){a.value=o,a.getSnapshot=c,Qb(a)&&Xb(s)}function Yb(s,a,o){return o(function(){Qb(a)&&Xb(s)})}function Qb(s){var a=s.getSnapshot;s=s.value;try{var o=a();return!Vr(s,o)}catch{return!0}}function Xb(s){var a=Ro(s,2);a!==null&&Ir(a,s,2)}function hf(s){var a=pr();if(typeof s=="function"){var o=s;if(s=o(),Vo){De(!0);try{o()}finally{De(!1)}}}return a.memoizedState=a.baseState=s,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ii,lastRenderedState:s},a}function Jb(s,a,o,c){return s.baseState=o,uf(s,Gs,typeof c=="function"?c:ii)}function vj(s,a,o,c,m){if(jd(s))throw Error(i(485));if(s=a.action,s!==null){var f={payload:m,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){f.listeners.push(w)}};H.T!==null?o(!0):f.isTransition=!1,c(f),o=a.pending,o===null?(f.next=a.pending=f,Zb(a,f)):(f.next=o.next,a.pending=o.next=f)}}function Zb(s,a){var o=a.action,c=a.payload,m=s.state;if(a.isTransition){var f=H.T,w={};H.T=w;try{var N=o(m,c),q=H.S;q!==null&&q(w,N),ev(s,a,N)}catch(ue){mf(s,a,ue)}finally{f!==null&&w.types!==null&&(f.types=w.types),H.T=f}}else try{f=o(m,c),ev(s,a,f)}catch(ue){mf(s,a,ue)}}function ev(s,a,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){tv(s,a,c)},function(c){return mf(s,a,c)}):tv(s,a,o)}function tv(s,a,o){a.status="fulfilled",a.value=o,sv(a),s.state=o,a=s.pending,a!==null&&(o=a.next,o===a?s.pending=null:(o=o.next,a.next=o,Zb(s,o)))}function mf(s,a,o){var c=s.pending;if(s.pending=null,c!==null){c=c.next;do a.status="rejected",a.reason=o,sv(a),a=a.next;while(a!==c)}s.action=null}function sv(s){s=s.listeners;for(var a=0;a<s.length;a++)(0,s[a])()}function nv(s,a){return a}function rv(s,a){if(Ms){var o=en.formState;if(o!==null){e:{var c=ds;if(Ms){if(an){t:{for(var m=an,f=na;m.nodeType!==8;){if(!f){m=null;break t}if(m=aa(m.nextSibling),m===null){m=null;break t}}f=m.data,m=f==="F!"||f==="F"?m:null}if(m){an=aa(m.nextSibling),c=m.data==="F!";break e}}Pi(c)}c=!1}c&&(a=o[0])}}return o=pr(),o.memoizedState=o.baseState=a,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:nv,lastRenderedState:a},o.queue=c,o=kv.bind(null,ds,c),c.dispatch=o,c=hf(!1),f=vf.bind(null,ds,!1,c.queue),c=pr(),m={state:a,dispatch:null,action:s,pending:null},c.queue=m,o=vj.bind(null,ds,m,f,o),m.dispatch=o,c.memoizedState=s,[a,o,!1]}function av(s){var a=kn();return iv(a,Gs,s)}function iv(s,a,o){if(a=uf(s,a,nv)[0],s=wd(ii)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var c=Mc(a)}catch(w){throw w===_l?dd:w}else c=a;a=kn();var m=a.queue,f=m.dispatch;return o!==a.memoizedState&&(ds.flags|=2048,El(9,{destroy:void 0},xj.bind(null,m,o),null)),[c,f,s]}function xj(s,a){s.action=a}function ov(s){var a=kn(),o=Gs;if(o!==null)return iv(a,o,s);kn(),a=a.memoizedState,o=kn();var c=o.queue.dispatch;return o.memoizedState=s,[a,c,!1]}function El(s,a,o,c){return s={tag:s,create:o,deps:c,inst:a,next:null},a=ds.updateQueue,a===null&&(a=vd(),ds.updateQueue=a),o=a.lastEffect,o===null?a.lastEffect=s.next=s:(c=o.next,o.next=s,s.next=c,a.lastEffect=s),s}function lv(){return kn().memoizedState}function _d(s,a,o,c){var m=pr();ds.flags|=s,m.memoizedState=El(1|a,{destroy:void 0},o,c===void 0?null:c)}function kd(s,a,o,c){var m=kn();c=c===void 0?null:c;var f=m.memoizedState.inst;Gs!==null&&c!==null&&nf(c,Gs.memoizedState.deps)?m.memoizedState=El(a,f,o,c):(ds.flags|=s,m.memoizedState=El(1|a,f,o,c))}function cv(s,a){_d(8390656,8,s,a)}function ff(s,a){kd(2048,8,s,a)}function wj(s){ds.flags|=4;var a=ds.updateQueue;if(a===null)a=vd(),ds.updateQueue=a,a.events=[s];else{var o=a.events;o===null?a.events=[s]:o.push(s)}}function uv(s){var a=kn().memoizedState;return wj({ref:a,nextImpl:s}),function(){if((zs&2)!==0)throw Error(i(440));return a.impl.apply(void 0,arguments)}}function dv(s,a){return kd(4,2,s,a)}function hv(s,a){return kd(4,4,s,a)}function mv(s,a){if(typeof a=="function"){s=s();var o=a(s);return function(){typeof o=="function"?o():a(null)}}if(a!=null)return s=s(),a.current=s,function(){a.current=null}}function fv(s,a,o){o=o!=null?o.concat([s]):null,kd(4,4,mv.bind(null,a,s),o)}function pf(){}function pv(s,a){var o=kn();a=a===void 0?null:a;var c=o.memoizedState;return a!==null&&nf(a,c[1])?c[0]:(o.memoizedState=[s,a],s)}function gv(s,a){var o=kn();a=a===void 0?null:a;var c=o.memoizedState;if(a!==null&&nf(a,c[1]))return c[0];if(c=s(),Vo){De(!0);try{s()}finally{De(!1)}}return o.memoizedState=[c,a],c}function gf(s,a,o){return o===void 0||(ai&1073741824)!==0&&(js&261930)===0?s.memoizedState=a:(s.memoizedState=o,s=y0(),ds.lanes|=s,Hi|=s,o)}function yv(s,a,o,c){return Vr(o,a)?o:jl.current!==null?(s=gf(s,o,c),Vr(s,a)||(Cn=!0),s):(ai&42)===0||(ai&1073741824)!==0&&(js&261930)===0?(Cn=!0,s.memoizedState=o):(s=y0(),ds.lanes|=s,Hi|=s,a)}function bv(s,a,o,c,m){var f=fe.p;fe.p=f!==0&&8>f?f:8;var w=H.T,N={};H.T=N,vf(s,!1,a,o);try{var q=m(),ue=H.S;if(ue!==null&&ue(N,q),q!==null&&typeof q=="object"&&typeof q.then=="function"){var Ne=gj(q,c);Ic(s,a,Ne,$r(s))}else Ic(s,a,c,$r(s))}catch(ze){Ic(s,a,{then:function(){},status:"rejected",reason:ze},$r())}finally{fe.p=f,w!==null&&N.types!==null&&(w.types=N.types),H.T=w}}function _j(){}function yf(s,a,o,c){if(s.tag!==5)throw Error(i(476));var m=vv(s).queue;bv(s,m,a,Ve,o===null?_j:function(){return xv(s),o(c)})}function vv(s){var a=s.memoizedState;if(a!==null)return a;a={memoizedState:Ve,baseState:Ve,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ii,lastRenderedState:Ve},next:null};var o={};return a.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ii,lastRenderedState:o},next:null},s.memoizedState=a,s=s.alternate,s!==null&&(s.memoizedState=a),a}function xv(s){var a=vv(s);a.next===null&&(a=s.alternate.memoizedState),Ic(s,a.next.queue,{},$r())}function bf(){return Jn(Qc)}function wv(){return kn().memoizedState}function _v(){return kn().memoizedState}function kj(s){for(var a=s.return;a!==null;){switch(a.tag){case 24:case 3:var o=$r();s=Bi(o);var c=Vi(a,s,o);c!==null&&(Ir(c,a,o),Nc(c,a,o)),a={cache:Wm()},s.payload=a;return}a=a.return}}function jj(s,a,o){var c=$r();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},jd(s)?jv(a,o):(o=Pm(s,a,o,c),o!==null&&(Ir(o,s,c),Tv(o,a,c)))}function kv(s,a,o){var c=$r();Ic(s,a,o,c)}function Ic(s,a,o,c){var m={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(jd(s))jv(a,m);else{var f=s.alternate;if(s.lanes===0&&(f===null||f.lanes===0)&&(f=a.lastRenderedReducer,f!==null))try{var w=a.lastRenderedState,N=f(w,o);if(m.hasEagerState=!0,m.eagerState=N,Vr(N,w))return rd(s,a,m,0),en===null&&nd(),!1}catch{}if(o=Pm(s,a,m,c),o!==null)return Ir(o,s,c),Tv(o,a,c),!0}return!1}function vf(s,a,o,c){if(c={lane:2,revertLane:Xf(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},jd(s)){if(a)throw Error(i(479))}else a=Pm(s,o,c,2),a!==null&&Ir(a,s,2)}function jd(s){var a=s.alternate;return s===ds||a!==null&&a===ds}function jv(s,a){Tl=yd=!0;var o=s.pending;o===null?a.next=a:(a.next=o.next,o.next=a),s.pending=a}function Tv(s,a,o){if((o&4194048)!==0){var c=a.lanes;c&=s.pendingLanes,o|=c,a.lanes=o,Zt(s,o)}}var Dc={readContext:Jn,use:xd,useCallback:pn,useContext:pn,useEffect:pn,useImperativeHandle:pn,useLayoutEffect:pn,useInsertionEffect:pn,useMemo:pn,useReducer:pn,useRef:pn,useState:pn,useDebugValue:pn,useDeferredValue:pn,useTransition:pn,useSyncExternalStore:pn,useId:pn,useHostTransitionStatus:pn,useFormState:pn,useActionState:pn,useOptimistic:pn,useMemoCache:pn,useCacheRefresh:pn};Dc.useEffectEvent=pn;var Sv={readContext:Jn,use:xd,useCallback:function(s,a){return pr().memoizedState=[s,a===void 0?null:a],s},useContext:Jn,useEffect:cv,useImperativeHandle:function(s,a,o){o=o!=null?o.concat([s]):null,_d(4194308,4,mv.bind(null,a,s),o)},useLayoutEffect:function(s,a){return _d(4194308,4,s,a)},useInsertionEffect:function(s,a){_d(4,2,s,a)},useMemo:function(s,a){var o=pr();a=a===void 0?null:a;var c=s();if(Vo){De(!0);try{s()}finally{De(!1)}}return o.memoizedState=[c,a],c},useReducer:function(s,a,o){var c=pr();if(o!==void 0){var m=o(a);if(Vo){De(!0);try{o(a)}finally{De(!1)}}}else m=a;return c.memoizedState=c.baseState=m,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:m},c.queue=s,s=s.dispatch=jj.bind(null,ds,s),[c.memoizedState,s]},useRef:function(s){var a=pr();return s={current:s},a.memoizedState=s},useState:function(s){s=hf(s);var a=s.queue,o=kv.bind(null,ds,a);return a.dispatch=o,[s.memoizedState,o]},useDebugValue:pf,useDeferredValue:function(s,a){var o=pr();return gf(o,s,a)},useTransition:function(){var s=hf(!1);return s=bv.bind(null,ds,s.queue,!0,!1),pr().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,a,o){var c=ds,m=pr();if(Ms){if(o===void 0)throw Error(i(407));o=o()}else{if(o=a(),en===null)throw Error(i(349));(js&127)!==0||Gb(c,a,o)}m.memoizedState=o;var f={value:o,getSnapshot:a};return m.queue=f,cv(Yb.bind(null,c,f,s),[s]),c.flags|=2048,El(9,{destroy:void 0},Kb.bind(null,c,f,o,a),null),o},useId:function(){var s=pr(),a=en.identifierPrefix;if(Ms){var o=La,c=Pa;o=(c&~(1<<32-Pe(c)-1)).toString(32)+o,a="_"+a+"R_"+o,o=bd++,0<o&&(a+="H"+o.toString(32)),a+="_"}else o=yj++,a="_"+a+"r_"+o.toString(32)+"_";return s.memoizedState=a},useHostTransitionStatus:bf,useFormState:rv,useActionState:rv,useOptimistic:function(s){var a=pr();a.memoizedState=a.baseState=s;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=o,a=vf.bind(null,ds,!0,o),o.dispatch=a,[s,a]},useMemoCache:cf,useCacheRefresh:function(){return pr().memoizedState=kj.bind(null,ds)},useEffectEvent:function(s){var a=pr(),o={impl:s};return a.memoizedState=o,function(){if((zs&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},xf={readContext:Jn,use:xd,useCallback:pv,useContext:Jn,useEffect:ff,useImperativeHandle:fv,useInsertionEffect:dv,useLayoutEffect:hv,useMemo:gv,useReducer:wd,useRef:lv,useState:function(){return wd(ii)},useDebugValue:pf,useDeferredValue:function(s,a){var o=kn();return yv(o,Gs.memoizedState,s,a)},useTransition:function(){var s=wd(ii)[0],a=kn().memoizedState;return[typeof s=="boolean"?s:Mc(s),a]},useSyncExternalStore:Wb,useId:wv,useHostTransitionStatus:bf,useFormState:av,useActionState:av,useOptimistic:function(s,a){var o=kn();return Jb(o,Gs,s,a)},useMemoCache:cf,useCacheRefresh:_v};xf.useEffectEvent=uv;var Ev={readContext:Jn,use:xd,useCallback:pv,useContext:Jn,useEffect:ff,useImperativeHandle:fv,useInsertionEffect:dv,useLayoutEffect:hv,useMemo:gv,useReducer:df,useRef:lv,useState:function(){return df(ii)},useDebugValue:pf,useDeferredValue:function(s,a){var o=kn();return Gs===null?gf(o,s,a):yv(o,Gs.memoizedState,s,a)},useTransition:function(){var s=df(ii)[0],a=kn().memoizedState;return[typeof s=="boolean"?s:Mc(s),a]},useSyncExternalStore:Wb,useId:wv,useHostTransitionStatus:bf,useFormState:ov,useActionState:ov,useOptimistic:function(s,a){var o=kn();return Gs!==null?Jb(o,Gs,s,a):(o.baseState=s,[s,o.queue.dispatch])},useMemoCache:cf,useCacheRefresh:_v};Ev.useEffectEvent=uv;function wf(s,a,o,c){a=s.memoizedState,o=o(c,a),o=o==null?a:_({},a,o),s.memoizedState=o,s.lanes===0&&(s.updateQueue.baseState=o)}var _f={enqueueSetState:function(s,a,o){s=s._reactInternals;var c=$r(),m=Bi(c);m.payload=a,o!=null&&(m.callback=o),a=Vi(s,m,c),a!==null&&(Ir(a,s,c),Nc(a,s,c))},enqueueReplaceState:function(s,a,o){s=s._reactInternals;var c=$r(),m=Bi(c);m.tag=1,m.payload=a,o!=null&&(m.callback=o),a=Vi(s,m,c),a!==null&&(Ir(a,s,c),Nc(a,s,c))},enqueueForceUpdate:function(s,a){s=s._reactInternals;var o=$r(),c=Bi(o);c.tag=2,a!=null&&(c.callback=a),a=Vi(s,c,o),a!==null&&(Ir(a,s,o),Nc(a,s,o))}};function Nv(s,a,o,c,m,f,w){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(c,f,w):a.prototype&&a.prototype.isPureReactComponent?!xc(o,c)||!xc(m,f):!0}function Cv(s,a,o,c){s=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(o,c),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(o,c),a.state!==s&&_f.enqueueReplaceState(a,a.state,null)}function Uo(s,a){var o=a;if("ref"in a){o={};for(var c in a)c!=="ref"&&(o[c]=a[c])}if(s=s.defaultProps){o===a&&(o=_({},o));for(var m in s)o[m]===void 0&&(o[m]=s[m])}return o}function Rv(s){sd(s)}function Av(s){console.error(s)}function Mv(s){sd(s)}function Td(s,a){try{var o=s.onUncaughtError;o(a.value,{componentStack:a.stack})}catch(c){setTimeout(function(){throw c})}}function Iv(s,a,o){try{var c=s.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function kf(s,a,o){return o=Bi(o),o.tag=3,o.payload={element:null},o.callback=function(){Td(s,a)},o}function Dv(s){return s=Bi(s),s.tag=3,s}function Pv(s,a,o,c){var m=o.type.getDerivedStateFromError;if(typeof m=="function"){var f=c.value;s.payload=function(){return m(f)},s.callback=function(){Iv(a,o,c)}}var w=o.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(s.callback=function(){Iv(a,o,c),typeof m!="function"&&($i===null?$i=new Set([this]):$i.add(this));var N=c.stack;this.componentDidCatch(c.value,{componentStack:N!==null?N:""})})}function Tj(s,a,o,c,m){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(a=o.alternate,a!==null&&vl(a,o,m,!0),o=Fr.current,o!==null){switch(o.tag){case 31:case 13:return ra===null?Od():o.alternate===null&&gn===0&&(gn=3),o.flags&=-257,o.flags|=65536,o.lanes=m,c===hd?o.flags|=16384:(a=o.updateQueue,a===null?o.updateQueue=new Set([c]):a.add(c),Kf(s,c,m)),!1;case 22:return o.flags|=65536,c===hd?o.flags|=16384:(a=o.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=a):(o=a.retryQueue,o===null?a.retryQueue=new Set([c]):o.add(c)),Kf(s,c,m)),!1}throw Error(i(435,o.tag))}return Kf(s,c,m),Od(),!1}if(Ms)return a=Fr.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=m,c!==Fm&&(s=Error(i(422),{cause:c}),kc(ea(s,o)))):(c!==Fm&&(a=Error(i(423),{cause:c}),kc(ea(a,o))),s=s.current.alternate,s.flags|=65536,m&=-m,s.lanes|=m,c=ea(c,o),m=kf(s.stateNode,c,m),Jm(s,m),gn!==4&&(gn=2)),!1;var f=Error(i(520),{cause:c});if(f=ea(f,o),zc===null?zc=[f]:zc.push(f),gn!==4&&(gn=2),a===null)return!0;c=ea(c,o),o=a;do{switch(o.tag){case 3:return o.flags|=65536,s=m&-m,o.lanes|=s,s=kf(o.stateNode,c,s),Jm(o,s),!1;case 1:if(a=o.type,f=o.stateNode,(o.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||f!==null&&typeof f.componentDidCatch=="function"&&($i===null||!$i.has(f))))return o.flags|=65536,m&=-m,o.lanes|=m,m=Dv(m),Pv(m,s,o,c),Jm(o,m),!1}o=o.return}while(o!==null);return!1}var jf=Error(i(461)),Cn=!1;function Zn(s,a,o,c){a.child=s===null?Vb(a,null,o,c):Bo(a,s.child,o,c)}function Lv(s,a,o,c,m){o=o.render;var f=a.ref;if("ref"in c){var w={};for(var N in c)N!=="ref"&&(w[N]=c[N])}else w=c;return Do(a),c=rf(s,a,o,w,f,m),N=af(),s!==null&&!Cn?(of(s,a,m),oi(s,a,m)):(Ms&&N&&Vm(a),a.flags|=1,Zn(s,a,c,m),a.child)}function Ov(s,a,o,c,m){if(s===null){var f=o.type;return typeof f=="function"&&!Lm(f)&&f.defaultProps===void 0&&o.compare===null?(a.tag=15,a.type=f,Bv(s,a,f,c,m)):(s=id(o.type,null,c,a,a.mode,m),s.ref=a.ref,s.return=a,a.child=s)}if(f=s.child,!Mf(s,m)){var w=f.memoizedProps;if(o=o.compare,o=o!==null?o:xc,o(w,c)&&s.ref===a.ref)return oi(s,a,m)}return a.flags|=1,s=ti(f,c),s.ref=a.ref,s.return=a,a.child=s}function Bv(s,a,o,c,m){if(s!==null){var f=s.memoizedProps;if(xc(f,c)&&s.ref===a.ref)if(Cn=!1,a.pendingProps=c=f,Mf(s,m))(s.flags&131072)!==0&&(Cn=!0);else return a.lanes=s.lanes,oi(s,a,m)}return Tf(s,a,o,c,m)}function Vv(s,a,o,c){var m=c.children,f=s!==null?s.memoizedState:null;if(s===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((a.flags&128)!==0){if(f=f!==null?f.baseLanes|o:o,s!==null){for(c=a.child=s.child,m=0;c!==null;)m=m|c.lanes|c.childLanes,c=c.sibling;c=m&~f}else c=0,a.child=null;return Uv(s,a,f,o,c)}if((o&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},s!==null&&ud(a,f!==null?f.cachePool:null),f!==null?zb(a,f):ef(),qb(a);else return c=a.lanes=536870912,Uv(s,a,f!==null?f.baseLanes|o:o,o,c)}else f!==null?(ud(a,f.cachePool),zb(a,f),Fi(),a.memoizedState=null):(s!==null&&ud(a,null),ef(),Fi());return Zn(s,a,m,o),a.child}function Pc(s,a){return s!==null&&s.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function Uv(s,a,o,c,m){var f=Km();return f=f===null?null:{parent:En._currentValue,pool:f},a.memoizedState={baseLanes:o,cachePool:f},s!==null&&ud(a,null),ef(),qb(a),s!==null&&vl(s,a,c,!0),a.childLanes=m,null}function Sd(s,a){return a=Nd({mode:a.mode,children:a.children},s.mode),a.ref=s.ref,s.child=a,a.return=s,a}function Fv(s,a,o){return Bo(a,s.child,null,o),s=Sd(a,a.pendingProps),s.flags|=2,zr(a),a.memoizedState=null,s}function Sj(s,a,o){var c=a.pendingProps,m=(a.flags&128)!==0;if(a.flags&=-129,s===null){if(Ms){if(c.mode==="hidden")return s=Sd(a,c),a.lanes=536870912,Pc(null,s);if(sf(a),(s=an)?(s=Z0(s,na),s=s!==null&&s.data==="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:Ii!==null?{id:Pa,overflow:La}:null,retryLane:536870912,hydrationErrors:null},o=jb(s),o.return=a,a.child=o,Xn=a,an=null)):s=null,s===null)throw Pi(a);return a.lanes=536870912,null}return Sd(a,c)}var f=s.memoizedState;if(f!==null){var w=f.dehydrated;if(sf(a),m)if(a.flags&256)a.flags&=-257,a=Fv(s,a,o);else if(a.memoizedState!==null)a.child=s.child,a.flags|=128,a=null;else throw Error(i(558));else if(Cn||vl(s,a,o,!1),m=(o&s.childLanes)!==0,Cn||m){if(c=en,c!==null&&(w=Qt(c,o),w!==0&&w!==f.retryLane))throw f.retryLane=w,Ro(s,w),Ir(c,s,w),jf;Od(),a=Fv(s,a,o)}else s=f.treeContext,an=aa(w.nextSibling),Xn=a,Ms=!0,Di=null,na=!1,s!==null&&Eb(a,s),a=Sd(a,c),a.flags|=4096;return a}return s=ti(s.child,{mode:c.mode,children:c.children}),s.ref=a.ref,a.child=s,s.return=a,s}function Ed(s,a){var o=a.ref;if(o===null)s!==null&&s.ref!==null&&(a.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(s===null||s.ref!==o)&&(a.flags|=4194816)}}function Tf(s,a,o,c,m){return Do(a),o=rf(s,a,o,c,void 0,m),c=af(),s!==null&&!Cn?(of(s,a,m),oi(s,a,m)):(Ms&&c&&Vm(a),a.flags|=1,Zn(s,a,o,m),a.child)}function zv(s,a,o,c,m,f){return Do(a),a.updateQueue=null,o=$b(a,c,o,m),Hb(s),c=af(),s!==null&&!Cn?(of(s,a,f),oi(s,a,f)):(Ms&&c&&Vm(a),a.flags|=1,Zn(s,a,o,f),a.child)}function qv(s,a,o,c,m){if(Do(a),a.stateNode===null){var f=pl,w=o.contextType;typeof w=="object"&&w!==null&&(f=Jn(w)),f=new o(c,f),a.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,f.updater=_f,a.stateNode=f,f._reactInternals=a,f=a.stateNode,f.props=c,f.state=a.memoizedState,f.refs={},Qm(a),w=o.contextType,f.context=typeof w=="object"&&w!==null?Jn(w):pl,f.state=a.memoizedState,w=o.getDerivedStateFromProps,typeof w=="function"&&(wf(a,o,w,c),f.state=a.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(w=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),w!==f.state&&_f.enqueueReplaceState(f,f.state,null),Rc(a,c,f,m),Cc(),f.state=a.memoizedState),typeof f.componentDidMount=="function"&&(a.flags|=4194308),c=!0}else if(s===null){f=a.stateNode;var N=a.memoizedProps,q=Uo(o,N);f.props=q;var ue=f.context,Ne=o.contextType;w=pl,typeof Ne=="object"&&Ne!==null&&(w=Jn(Ne));var ze=o.getDerivedStateFromProps;Ne=typeof ze=="function"||typeof f.getSnapshotBeforeUpdate=="function",N=a.pendingProps!==N,Ne||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(N||ue!==w)&&Cv(a,f,c,w),Oi=!1;var me=a.memoizedState;f.state=me,Rc(a,c,f,m),Cc(),ue=a.memoizedState,N||me!==ue||Oi?(typeof ze=="function"&&(wf(a,o,ze,c),ue=a.memoizedState),(q=Oi||Nv(a,o,q,c,me,ue,w))?(Ne||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(a.flags|=4194308)):(typeof f.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=c,a.memoizedState=ue),f.props=c,f.state=ue,f.context=w,c=q):(typeof f.componentDidMount=="function"&&(a.flags|=4194308),c=!1)}else{f=a.stateNode,Xm(s,a),w=a.memoizedProps,Ne=Uo(o,w),f.props=Ne,ze=a.pendingProps,me=f.context,ue=o.contextType,q=pl,typeof ue=="object"&&ue!==null&&(q=Jn(ue)),N=o.getDerivedStateFromProps,(ue=typeof N=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(w!==ze||me!==q)&&Cv(a,f,c,q),Oi=!1,me=a.memoizedState,f.state=me,Rc(a,c,f,m),Cc();var _e=a.memoizedState;w!==ze||me!==_e||Oi||s!==null&&s.dependencies!==null&&ld(s.dependencies)?(typeof N=="function"&&(wf(a,o,N,c),_e=a.memoizedState),(Ne=Oi||Nv(a,o,Ne,c,me,_e,q)||s!==null&&s.dependencies!==null&&ld(s.dependencies))?(ue||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(c,_e,q),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(c,_e,q)),typeof f.componentDidUpdate=="function"&&(a.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof f.componentDidUpdate!="function"||w===s.memoizedProps&&me===s.memoizedState||(a.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||w===s.memoizedProps&&me===s.memoizedState||(a.flags|=1024),a.memoizedProps=c,a.memoizedState=_e),f.props=c,f.state=_e,f.context=q,c=Ne):(typeof f.componentDidUpdate!="function"||w===s.memoizedProps&&me===s.memoizedState||(a.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||w===s.memoizedProps&&me===s.memoizedState||(a.flags|=1024),c=!1)}return f=c,Ed(s,a),c=(a.flags&128)!==0,f||c?(f=a.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:f.render(),a.flags|=1,s!==null&&c?(a.child=Bo(a,s.child,null,m),a.child=Bo(a,null,o,m)):Zn(s,a,o,m),a.memoizedState=f.state,s=a.child):s=oi(s,a,m),s}function Hv(s,a,o,c){return Mo(),a.flags|=256,Zn(s,a,o,c),a.child}var Sf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ef(s){return{baseLanes:s,cachePool:Ib()}}function Nf(s,a,o){return s=s!==null?s.childLanes&~o:0,a&&(s|=Hr),s}function $v(s,a,o){var c=a.pendingProps,m=!1,f=(a.flags&128)!==0,w;if((w=f)||(w=s!==null&&s.memoizedState===null?!1:(_n.current&2)!==0),w&&(m=!0,a.flags&=-129),w=(a.flags&32)!==0,a.flags&=-33,s===null){if(Ms){if(m?Ui(a):Fi(),(s=an)?(s=Z0(s,na),s=s!==null&&s.data!=="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:Ii!==null?{id:Pa,overflow:La}:null,retryLane:536870912,hydrationErrors:null},o=jb(s),o.return=a,a.child=o,Xn=a,an=null)):s=null,s===null)throw Pi(a);return up(s)?a.lanes=32:a.lanes=536870912,null}var N=c.children;return c=c.fallback,m?(Fi(),m=a.mode,N=Nd({mode:"hidden",children:N},m),c=Ao(c,m,o,null),N.return=a,c.return=a,N.sibling=c,a.child=N,c=a.child,c.memoizedState=Ef(o),c.childLanes=Nf(s,w,o),a.memoizedState=Sf,Pc(null,c)):(Ui(a),Cf(a,N))}var q=s.memoizedState;if(q!==null&&(N=q.dehydrated,N!==null)){if(f)a.flags&256?(Ui(a),a.flags&=-257,a=Rf(s,a,o)):a.memoizedState!==null?(Fi(),a.child=s.child,a.flags|=128,a=null):(Fi(),N=c.fallback,m=a.mode,c=Nd({mode:"visible",children:c.children},m),N=Ao(N,m,o,null),N.flags|=2,c.return=a,N.return=a,c.sibling=N,a.child=c,Bo(a,s.child,null,o),c=a.child,c.memoizedState=Ef(o),c.childLanes=Nf(s,w,o),a.memoizedState=Sf,a=Pc(null,c));else if(Ui(a),up(N)){if(w=N.nextSibling&&N.nextSibling.dataset,w)var ue=w.dgst;w=ue,c=Error(i(419)),c.stack="",c.digest=w,kc({value:c,source:null,stack:null}),a=Rf(s,a,o)}else if(Cn||vl(s,a,o,!1),w=(o&s.childLanes)!==0,Cn||w){if(w=en,w!==null&&(c=Qt(w,o),c!==0&&c!==q.retryLane))throw q.retryLane=c,Ro(s,c),Ir(w,s,c),jf;cp(N)||Od(),a=Rf(s,a,o)}else cp(N)?(a.flags|=192,a.child=s.child,a=null):(s=q.treeContext,an=aa(N.nextSibling),Xn=a,Ms=!0,Di=null,na=!1,s!==null&&Eb(a,s),a=Cf(a,c.children),a.flags|=4096);return a}return m?(Fi(),N=c.fallback,m=a.mode,q=s.child,ue=q.sibling,c=ti(q,{mode:"hidden",children:c.children}),c.subtreeFlags=q.subtreeFlags&65011712,ue!==null?N=ti(ue,N):(N=Ao(N,m,o,null),N.flags|=2),N.return=a,c.return=a,c.sibling=N,a.child=c,Pc(null,c),c=a.child,N=s.child.memoizedState,N===null?N=Ef(o):(m=N.cachePool,m!==null?(q=En._currentValue,m=m.parent!==q?{parent:q,pool:q}:m):m=Ib(),N={baseLanes:N.baseLanes|o,cachePool:m}),c.memoizedState=N,c.childLanes=Nf(s,w,o),a.memoizedState=Sf,Pc(s.child,c)):(Ui(a),o=s.child,s=o.sibling,o=ti(o,{mode:"visible",children:c.children}),o.return=a,o.sibling=null,s!==null&&(w=a.deletions,w===null?(a.deletions=[s],a.flags|=16):w.push(s)),a.child=o,a.memoizedState=null,o)}function Cf(s,a){return a=Nd({mode:"visible",children:a},s.mode),a.return=s,s.child=a}function Nd(s,a){return s=Ur(22,s,null,a),s.lanes=0,s}function Rf(s,a,o){return Bo(a,s.child,null,o),s=Cf(a,a.pendingProps.children),s.flags|=2,a.memoizedState=null,s}function Wv(s,a,o){s.lanes|=a;var c=s.alternate;c!==null&&(c.lanes|=a),Hm(s.return,a,o)}function Af(s,a,o,c,m,f){var w=s.memoizedState;w===null?s.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:m,treeForkCount:f}:(w.isBackwards=a,w.rendering=null,w.renderingStartTime=0,w.last=c,w.tail=o,w.tailMode=m,w.treeForkCount=f)}function Gv(s,a,o){var c=a.pendingProps,m=c.revealOrder,f=c.tail;c=c.children;var w=_n.current,N=(w&2)!==0;if(N?(w=w&1|2,a.flags|=128):w&=1,Fe(_n,w),Zn(s,a,c,o),c=Ms?_c:0,!N&&s!==null&&(s.flags&128)!==0)e:for(s=a.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Wv(s,o,a);else if(s.tag===19)Wv(s,o,a);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(m){case"forwards":for(o=a.child,m=null;o!==null;)s=o.alternate,s!==null&&gd(s)===null&&(m=o),o=o.sibling;o=m,o===null?(m=a.child,a.child=null):(m=o.sibling,o.sibling=null),Af(a,!1,m,o,f,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,m=a.child,a.child=null;m!==null;){if(s=m.alternate,s!==null&&gd(s)===null){a.child=m;break}s=m.sibling,m.sibling=o,o=m,m=s}Af(a,!0,o,null,f,c);break;case"together":Af(a,!1,null,null,void 0,c);break;default:a.memoizedState=null}return a.child}function oi(s,a,o){if(s!==null&&(a.dependencies=s.dependencies),Hi|=a.lanes,(o&a.childLanes)===0)if(s!==null){if(vl(s,a,o,!1),(o&a.childLanes)===0)return null}else return null;if(s!==null&&a.child!==s.child)throw Error(i(153));if(a.child!==null){for(s=a.child,o=ti(s,s.pendingProps),a.child=o,o.return=a;s.sibling!==null;)s=s.sibling,o=o.sibling=ti(s,s.pendingProps),o.return=a;o.sibling=null}return a.child}function Mf(s,a){return(s.lanes&a)!==0?!0:(s=s.dependencies,!!(s!==null&&ld(s)))}function Ej(s,a,o){switch(a.tag){case 3:xt(a,a.stateNode.containerInfo),Li(a,En,s.memoizedState.cache),Mo();break;case 27:case 5:ss(a);break;case 4:xt(a,a.stateNode.containerInfo);break;case 10:Li(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,sf(a),null;break;case 13:var c=a.memoizedState;if(c!==null)return c.dehydrated!==null?(Ui(a),a.flags|=128,null):(o&a.child.childLanes)!==0?$v(s,a,o):(Ui(a),s=oi(s,a,o),s!==null?s.sibling:null);Ui(a);break;case 19:var m=(s.flags&128)!==0;if(c=(o&a.childLanes)!==0,c||(vl(s,a,o,!1),c=(o&a.childLanes)!==0),m){if(c)return Gv(s,a,o);a.flags|=128}if(m=a.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),Fe(_n,_n.current),c)break;return null;case 22:return a.lanes=0,Vv(s,a,o,a.pendingProps);case 24:Li(a,En,s.memoizedState.cache)}return oi(s,a,o)}function Kv(s,a,o){if(s!==null)if(s.memoizedProps!==a.pendingProps)Cn=!0;else{if(!Mf(s,o)&&(a.flags&128)===0)return Cn=!1,Ej(s,a,o);Cn=(s.flags&131072)!==0}else Cn=!1,Ms&&(a.flags&1048576)!==0&&Sb(a,_c,a.index);switch(a.lanes=0,a.tag){case 16:e:{var c=a.pendingProps;if(s=Lo(a.elementType),a.type=s,typeof s=="function")Lm(s)?(c=Uo(s,c),a.tag=1,a=qv(null,a,s,c,o)):(a.tag=0,a=Tf(null,a,s,c,o));else{if(s!=null){var m=s.$$typeof;if(m===je){a.tag=11,a=Lv(null,a,s,c,o);break e}else if(m===C){a.tag=14,a=Ov(null,a,s,c,o);break e}}throw a=Oe(s)||s,Error(i(306,a,""))}}return a;case 0:return Tf(s,a,a.type,a.pendingProps,o);case 1:return c=a.type,m=Uo(c,a.pendingProps),qv(s,a,c,m,o);case 3:e:{if(xt(a,a.stateNode.containerInfo),s===null)throw Error(i(387));c=a.pendingProps;var f=a.memoizedState;m=f.element,Xm(s,a),Rc(a,c,null,o);var w=a.memoizedState;if(c=w.cache,Li(a,En,c),c!==f.cache&&$m(a,[En],o,!0),Cc(),c=w.element,f.isDehydrated)if(f={element:c,isDehydrated:!1,cache:w.cache},a.updateQueue.baseState=f,a.memoizedState=f,a.flags&256){a=Hv(s,a,c,o);break e}else if(c!==m){m=ea(Error(i(424)),a),kc(m),a=Hv(s,a,c,o);break e}else for(s=a.stateNode.containerInfo,s.nodeType===9?s=s.body:s=s.nodeName==="HTML"?s.ownerDocument.body:s,an=aa(s.firstChild),Xn=a,Ms=!0,Di=null,na=!0,o=Vb(a,null,c,o),a.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Mo(),c===m){a=oi(s,a,o);break e}Zn(s,a,c,o)}a=a.child}return a;case 26:return Ed(s,a),s===null?(o=a1(a.type,null,a.pendingProps,null))?a.memoizedState=o:Ms||(o=a.type,s=a.pendingProps,c=Hd(Ie.current).createElement(o),c[bt]=a,c[Ct]=s,er(c,o,s),de(c),a.stateNode=c):a.memoizedState=a1(a.type,s.memoizedProps,a.pendingProps,s.memoizedState),null;case 27:return ss(a),s===null&&Ms&&(c=a.stateNode=s1(a.type,a.pendingProps,Ie.current),Xn=a,na=!0,m=an,Yi(a.type)?(dp=m,an=aa(c.firstChild)):an=m),Zn(s,a,a.pendingProps.children,o),Ed(s,a),s===null&&(a.flags|=4194304),a.child;case 5:return s===null&&Ms&&((m=c=an)&&(c=nT(c,a.type,a.pendingProps,na),c!==null?(a.stateNode=c,Xn=a,an=aa(c.firstChild),na=!1,m=!0):m=!1),m||Pi(a)),ss(a),m=a.type,f=a.pendingProps,w=s!==null?s.memoizedProps:null,c=f.children,ip(m,f)?c=null:w!==null&&ip(m,w)&&(a.flags|=32),a.memoizedState!==null&&(m=rf(s,a,bj,null,null,o),Qc._currentValue=m),Ed(s,a),Zn(s,a,c,o),a.child;case 6:return s===null&&Ms&&((s=o=an)&&(o=rT(o,a.pendingProps,na),o!==null?(a.stateNode=o,Xn=a,an=null,s=!0):s=!1),s||Pi(a)),null;case 13:return $v(s,a,o);case 4:return xt(a,a.stateNode.containerInfo),c=a.pendingProps,s===null?a.child=Bo(a,null,c,o):Zn(s,a,c,o),a.child;case 11:return Lv(s,a,a.type,a.pendingProps,o);case 7:return Zn(s,a,a.pendingProps,o),a.child;case 8:return Zn(s,a,a.pendingProps.children,o),a.child;case 12:return Zn(s,a,a.pendingProps.children,o),a.child;case 10:return c=a.pendingProps,Li(a,a.type,c.value),Zn(s,a,c.children,o),a.child;case 9:return m=a.type._context,c=a.pendingProps.children,Do(a),m=Jn(m),c=c(m),a.flags|=1,Zn(s,a,c,o),a.child;case 14:return Ov(s,a,a.type,a.pendingProps,o);case 15:return Bv(s,a,a.type,a.pendingProps,o);case 19:return Gv(s,a,o);case 31:return Sj(s,a,o);case 22:return Vv(s,a,o,a.pendingProps);case 24:return Do(a),c=Jn(En),s===null?(m=Km(),m===null&&(m=en,f=Wm(),m.pooledCache=f,f.refCount++,f!==null&&(m.pooledCacheLanes|=o),m=f),a.memoizedState={parent:c,cache:m},Qm(a),Li(a,En,m)):((s.lanes&o)!==0&&(Xm(s,a),Rc(a,null,null,o),Cc()),m=s.memoizedState,f=a.memoizedState,m.parent!==c?(m={parent:c,cache:c},a.memoizedState=m,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=m),Li(a,En,c)):(c=f.cache,Li(a,En,c),c!==m.cache&&$m(a,[En],o,!0))),Zn(s,a,a.pendingProps.children,o),a.child;case 29:throw a.pendingProps}throw Error(i(156,a.tag))}function li(s){s.flags|=4}function If(s,a,o,c,m){if((a=(s.mode&32)!==0)&&(a=!1),a){if(s.flags|=16777216,(m&335544128)===m)if(s.stateNode.complete)s.flags|=8192;else if(w0())s.flags|=8192;else throw Oo=hd,Ym}else s.flags&=-16777217}function Yv(s,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!u1(a))if(w0())s.flags|=8192;else throw Oo=hd,Ym}function Cd(s,a){a!==null&&(s.flags|=4),s.flags&16384&&(a=s.tag!==22?Q():536870912,s.lanes|=a,Al|=a)}function Lc(s,a){if(!Ms)switch(s.tailMode){case"hidden":a=s.tail;for(var o=null;a!==null;)a.alternate!==null&&(o=a),a=a.sibling;o===null?s.tail=null:o.sibling=null;break;case"collapsed":o=s.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?a||s.tail===null?s.tail=null:s.tail.sibling=null:c.sibling=null}}function on(s){var a=s.alternate!==null&&s.alternate.child===s.child,o=0,c=0;if(a)for(var m=s.child;m!==null;)o|=m.lanes|m.childLanes,c|=m.subtreeFlags&65011712,c|=m.flags&65011712,m.return=s,m=m.sibling;else for(m=s.child;m!==null;)o|=m.lanes|m.childLanes,c|=m.subtreeFlags,c|=m.flags,m.return=s,m=m.sibling;return s.subtreeFlags|=c,s.childLanes=o,a}function Nj(s,a,o){var c=a.pendingProps;switch(Um(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return on(a),null;case 1:return on(a),null;case 3:return o=a.stateNode,c=null,s!==null&&(c=s.memoizedState.cache),a.memoizedState.cache!==c&&(a.flags|=2048),ri(En),it(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(s===null||s.child===null)&&(bl(a)?li(a):s===null||s.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,zm())),on(a),null;case 26:var m=a.type,f=a.memoizedState;return s===null?(li(a),f!==null?(on(a),Yv(a,f)):(on(a),If(a,m,null,c,o))):f?f!==s.memoizedState?(li(a),on(a),Yv(a,f)):(on(a),a.flags&=-16777217):(s=s.memoizedProps,s!==c&&li(a),on(a),If(a,m,s,c,o)),null;case 27:if(Rs(a),o=Ie.current,m=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==c&&li(a);else{if(!c){if(a.stateNode===null)throw Error(i(166));return on(a),null}s=qe.current,bl(a)?Nb(a):(s=s1(m,c,o),a.stateNode=s,li(a))}return on(a),null;case 5:if(Rs(a),m=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==c&&li(a);else{if(!c){if(a.stateNode===null)throw Error(i(166));return on(a),null}if(f=qe.current,bl(a))Nb(a);else{var w=Hd(Ie.current);switch(f){case 1:f=w.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:f=w.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":f=w.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":f=w.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":f=w.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild);break;case"select":f=typeof c.is=="string"?w.createElement("select",{is:c.is}):w.createElement("select"),c.multiple?f.multiple=!0:c.size&&(f.size=c.size);break;default:f=typeof c.is=="string"?w.createElement(m,{is:c.is}):w.createElement(m)}}f[bt]=a,f[Ct]=c;e:for(w=a.child;w!==null;){if(w.tag===5||w.tag===6)f.appendChild(w.stateNode);else if(w.tag!==4&&w.tag!==27&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===a)break e;for(;w.sibling===null;){if(w.return===null||w.return===a)break e;w=w.return}w.sibling.return=w.return,w=w.sibling}a.stateNode=f;e:switch(er(f,m,c),m){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&li(a)}}return on(a),If(a,a.type,s===null?null:s.memoizedProps,a.pendingProps,o),null;case 6:if(s&&a.stateNode!=null)s.memoizedProps!==c&&li(a);else{if(typeof c!="string"&&a.stateNode===null)throw Error(i(166));if(s=Ie.current,bl(a)){if(s=a.stateNode,o=a.memoizedProps,c=null,m=Xn,m!==null)switch(m.tag){case 27:case 5:c=m.memoizedProps}s[bt]=a,s=!!(s.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||$0(s.nodeValue,o)),s||Pi(a,!0)}else s=Hd(s).createTextNode(c),s[bt]=a,a.stateNode=s}return on(a),null;case 31:if(o=a.memoizedState,s===null||s.memoizedState!==null){if(c=bl(a),o!==null){if(s===null){if(!c)throw Error(i(318));if(s=a.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[bt]=a}else Mo(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;on(a),s=!1}else o=zm(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=o),s=!0;if(!s)return a.flags&256?(zr(a),a):(zr(a),null);if((a.flags&128)!==0)throw Error(i(558))}return on(a),null;case 13:if(c=a.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(m=bl(a),c!==null&&c.dehydrated!==null){if(s===null){if(!m)throw Error(i(318));if(m=a.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(i(317));m[bt]=a}else Mo(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;on(a),m=!1}else m=zm(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=m),m=!0;if(!m)return a.flags&256?(zr(a),a):(zr(a),null)}return zr(a),(a.flags&128)!==0?(a.lanes=o,a):(o=c!==null,s=s!==null&&s.memoizedState!==null,o&&(c=a.child,m=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(m=c.alternate.memoizedState.cachePool.pool),f=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(f=c.memoizedState.cachePool.pool),f!==m&&(c.flags|=2048)),o!==s&&o&&(a.child.flags|=8192),Cd(a,a.updateQueue),on(a),null);case 4:return it(),s===null&&tp(a.stateNode.containerInfo),on(a),null;case 10:return ri(a.type),on(a),null;case 19:if(re(_n),c=a.memoizedState,c===null)return on(a),null;if(m=(a.flags&128)!==0,f=c.rendering,f===null)if(m)Lc(c,!1);else{if(gn!==0||s!==null&&(s.flags&128)!==0)for(s=a.child;s!==null;){if(f=gd(s),f!==null){for(a.flags|=128,Lc(c,!1),s=f.updateQueue,a.updateQueue=s,Cd(a,s),a.subtreeFlags=0,s=o,o=a.child;o!==null;)kb(o,s),o=o.sibling;return Fe(_n,_n.current&1|2),Ms&&si(a,c.treeForkCount),a.child}s=s.sibling}c.tail!==null&&Kt()>Dd&&(a.flags|=128,m=!0,Lc(c,!1),a.lanes=4194304)}else{if(!m)if(s=gd(f),s!==null){if(a.flags|=128,m=!0,s=s.updateQueue,a.updateQueue=s,Cd(a,s),Lc(c,!0),c.tail===null&&c.tailMode==="hidden"&&!f.alternate&&!Ms)return on(a),null}else 2*Kt()-c.renderingStartTime>Dd&&o!==536870912&&(a.flags|=128,m=!0,Lc(c,!1),a.lanes=4194304);c.isBackwards?(f.sibling=a.child,a.child=f):(s=c.last,s!==null?s.sibling=f:a.child=f,c.last=f)}return c.tail!==null?(s=c.tail,c.rendering=s,c.tail=s.sibling,c.renderingStartTime=Kt(),s.sibling=null,o=_n.current,Fe(_n,m?o&1|2:o&1),Ms&&si(a,c.treeForkCount),s):(on(a),null);case 22:case 23:return zr(a),tf(),c=a.memoizedState!==null,s!==null?s.memoizedState!==null!==c&&(a.flags|=8192):c&&(a.flags|=8192),c?(o&536870912)!==0&&(a.flags&128)===0&&(on(a),a.subtreeFlags&6&&(a.flags|=8192)):on(a),o=a.updateQueue,o!==null&&Cd(a,o.retryQueue),o=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),c=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),c!==o&&(a.flags|=2048),s!==null&&re(Po),null;case 24:return o=null,s!==null&&(o=s.memoizedState.cache),a.memoizedState.cache!==o&&(a.flags|=2048),ri(En),on(a),null;case 25:return null;case 30:return null}throw Error(i(156,a.tag))}function Cj(s,a){switch(Um(a),a.tag){case 1:return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 3:return ri(En),it(),s=a.flags,(s&65536)!==0&&(s&128)===0?(a.flags=s&-65537|128,a):null;case 26:case 27:case 5:return Rs(a),null;case 31:if(a.memoizedState!==null){if(zr(a),a.alternate===null)throw Error(i(340));Mo()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 13:if(zr(a),s=a.memoizedState,s!==null&&s.dehydrated!==null){if(a.alternate===null)throw Error(i(340));Mo()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 19:return re(_n),null;case 4:return it(),null;case 10:return ri(a.type),null;case 22:case 23:return zr(a),tf(),s!==null&&re(Po),s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 24:return ri(En),null;case 25:return null;default:return null}}function Qv(s,a){switch(Um(a),a.tag){case 3:ri(En),it();break;case 26:case 27:case 5:Rs(a);break;case 4:it();break;case 31:a.memoizedState!==null&&zr(a);break;case 13:zr(a);break;case 19:re(_n);break;case 10:ri(a.type);break;case 22:case 23:zr(a),tf(),s!==null&&re(Po);break;case 24:ri(En)}}function Oc(s,a){try{var o=a.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var m=c.next;o=m;do{if((o.tag&s)===s){c=void 0;var f=o.create,w=o.inst;c=f(),w.destroy=c}o=o.next}while(o!==m)}}catch(N){Ws(a,a.return,N)}}function zi(s,a,o){try{var c=a.updateQueue,m=c!==null?c.lastEffect:null;if(m!==null){var f=m.next;c=f;do{if((c.tag&s)===s){var w=c.inst,N=w.destroy;if(N!==void 0){w.destroy=void 0,m=a;var q=o,ue=N;try{ue()}catch(Ne){Ws(m,q,Ne)}}}c=c.next}while(c!==f)}}catch(Ne){Ws(a,a.return,Ne)}}function Xv(s){var a=s.updateQueue;if(a!==null){var o=s.stateNode;try{Fb(a,o)}catch(c){Ws(s,s.return,c)}}}function Jv(s,a,o){o.props=Uo(s.type,s.memoizedProps),o.state=s.memoizedState;try{o.componentWillUnmount()}catch(c){Ws(s,a,c)}}function Bc(s,a){try{var o=s.ref;if(o!==null){switch(s.tag){case 26:case 27:case 5:var c=s.stateNode;break;case 30:c=s.stateNode;break;default:c=s.stateNode}typeof o=="function"?s.refCleanup=o(c):o.current=c}}catch(m){Ws(s,a,m)}}function Oa(s,a){var o=s.ref,c=s.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(m){Ws(s,a,m)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(m){Ws(s,a,m)}else o.current=null}function Zv(s){var a=s.type,o=s.memoizedProps,c=s.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(m){Ws(s,s.return,m)}}function Df(s,a,o){try{var c=s.stateNode;Xj(c,s.type,o,a),c[Ct]=a}catch(m){Ws(s,s.return,m)}}function e0(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Yi(s.type)||s.tag===4}function Pf(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||e0(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Yi(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Lf(s,a,o){var c=s.tag;if(c===5||c===6)s=s.stateNode,a?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(s,a):(a=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,a.appendChild(s),o=o._reactRootContainer,o!=null||a.onclick!==null||(a.onclick=Dn));else if(c!==4&&(c===27&&Yi(s.type)&&(o=s.stateNode,a=null),s=s.child,s!==null))for(Lf(s,a,o),s=s.sibling;s!==null;)Lf(s,a,o),s=s.sibling}function Rd(s,a,o){var c=s.tag;if(c===5||c===6)s=s.stateNode,a?o.insertBefore(s,a):o.appendChild(s);else if(c!==4&&(c===27&&Yi(s.type)&&(o=s.stateNode),s=s.child,s!==null))for(Rd(s,a,o),s=s.sibling;s!==null;)Rd(s,a,o),s=s.sibling}function t0(s){var a=s.stateNode,o=s.memoizedProps;try{for(var c=s.type,m=a.attributes;m.length;)a.removeAttributeNode(m[0]);er(a,c,o),a[bt]=s,a[Ct]=o}catch(f){Ws(s,s.return,f)}}var ci=!1,Rn=!1,Of=!1,s0=typeof WeakSet=="function"?WeakSet:Set,$n=null;function Rj(s,a){if(s=s.containerInfo,rp=Xd,s=fb(s),Cm(s)){if("selectionStart"in s)var o={start:s.selectionStart,end:s.selectionEnd};else e:{o=(o=s.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var m=c.anchorOffset,f=c.focusNode;c=c.focusOffset;try{o.nodeType,f.nodeType}catch{o=null;break e}var w=0,N=-1,q=-1,ue=0,Ne=0,ze=s,me=null;t:for(;;){for(var _e;ze!==o||m!==0&&ze.nodeType!==3||(N=w+m),ze!==f||c!==0&&ze.nodeType!==3||(q=w+c),ze.nodeType===3&&(w+=ze.nodeValue.length),(_e=ze.firstChild)!==null;)me=ze,ze=_e;for(;;){if(ze===s)break t;if(me===o&&++ue===m&&(N=w),me===f&&++Ne===c&&(q=w),(_e=ze.nextSibling)!==null)break;ze=me,me=ze.parentNode}ze=_e}o=N===-1||q===-1?null:{start:N,end:q}}else o=null}o=o||{start:0,end:0}}else o=null;for(ap={focusedElem:s,selectionRange:o},Xd=!1,$n=a;$n!==null;)if(a=$n,s=a.child,(a.subtreeFlags&1028)!==0&&s!==null)s.return=a,$n=s;else for(;$n!==null;){switch(a=$n,f=a.alternate,s=a.flags,a.tag){case 0:if((s&4)!==0&&(s=a.updateQueue,s=s!==null?s.events:null,s!==null))for(o=0;o<s.length;o++)m=s[o],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&f!==null){s=void 0,o=a,m=f.memoizedProps,f=f.memoizedState,c=o.stateNode;try{var Nt=Uo(o.type,m);s=c.getSnapshotBeforeUpdate(Nt,f),c.__reactInternalSnapshotBeforeUpdate=s}catch(Wt){Ws(o,o.return,Wt)}}break;case 3:if((s&1024)!==0){if(s=a.stateNode.containerInfo,o=s.nodeType,o===9)lp(s);else if(o===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":lp(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=a.sibling,s!==null){s.return=a.return,$n=s;break}$n=a.return}}function n0(s,a,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:di(s,o),c&4&&Oc(5,o);break;case 1:if(di(s,o),c&4)if(s=o.stateNode,a===null)try{s.componentDidMount()}catch(w){Ws(o,o.return,w)}else{var m=Uo(o.type,a.memoizedProps);a=a.memoizedState;try{s.componentDidUpdate(m,a,s.__reactInternalSnapshotBeforeUpdate)}catch(w){Ws(o,o.return,w)}}c&64&&Xv(o),c&512&&Bc(o,o.return);break;case 3:if(di(s,o),c&64&&(s=o.updateQueue,s!==null)){if(a=null,o.child!==null)switch(o.child.tag){case 27:case 5:a=o.child.stateNode;break;case 1:a=o.child.stateNode}try{Fb(s,a)}catch(w){Ws(o,o.return,w)}}break;case 27:a===null&&c&4&&t0(o);case 26:case 5:di(s,o),a===null&&c&4&&Zv(o),c&512&&Bc(o,o.return);break;case 12:di(s,o);break;case 31:di(s,o),c&4&&i0(s,o);break;case 13:di(s,o),c&4&&o0(s,o),c&64&&(s=o.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(o=Vj.bind(null,o),aT(s,o))));break;case 22:if(c=o.memoizedState!==null||ci,!c){a=a!==null&&a.memoizedState!==null||Rn,m=ci;var f=Rn;ci=c,(Rn=a)&&!f?hi(s,o,(o.subtreeFlags&8772)!==0):di(s,o),ci=m,Rn=f}break;case 30:break;default:di(s,o)}}function r0(s){var a=s.alternate;a!==null&&(s.alternate=null,r0(a)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(a=s.stateNode,a!==null&&Tn(a)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var un=null,Cr=!1;function ui(s,a,o){for(o=o.child;o!==null;)a0(s,a,o),o=o.sibling}function a0(s,a,o){if(ve&&typeof ve.onCommitFiberUnmount=="function")try{ve.onCommitFiberUnmount(_s,o)}catch{}switch(o.tag){case 26:Rn||Oa(o,a),ui(s,a,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Rn||Oa(o,a);var c=un,m=Cr;Yi(o.type)&&(un=o.stateNode,Cr=!1),ui(s,a,o),Gc(o.stateNode),un=c,Cr=m;break;case 5:Rn||Oa(o,a);case 6:if(c=un,m=Cr,un=null,ui(s,a,o),un=c,Cr=m,un!==null)if(Cr)try{(un.nodeType===9?un.body:un.nodeName==="HTML"?un.ownerDocument.body:un).removeChild(o.stateNode)}catch(f){Ws(o,a,f)}else try{un.removeChild(o.stateNode)}catch(f){Ws(o,a,f)}break;case 18:un!==null&&(Cr?(s=un,X0(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,o.stateNode),Vl(s)):X0(un,o.stateNode));break;case 4:c=un,m=Cr,un=o.stateNode.containerInfo,Cr=!0,ui(s,a,o),un=c,Cr=m;break;case 0:case 11:case 14:case 15:zi(2,o,a),Rn||zi(4,o,a),ui(s,a,o);break;case 1:Rn||(Oa(o,a),c=o.stateNode,typeof c.componentWillUnmount=="function"&&Jv(o,a,c)),ui(s,a,o);break;case 21:ui(s,a,o);break;case 22:Rn=(c=Rn)||o.memoizedState!==null,ui(s,a,o),Rn=c;break;default:ui(s,a,o)}}function i0(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Vl(s)}catch(o){Ws(a,a.return,o)}}}function o0(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Vl(s)}catch(o){Ws(a,a.return,o)}}function Aj(s){switch(s.tag){case 31:case 13:case 19:var a=s.stateNode;return a===null&&(a=s.stateNode=new s0),a;case 22:return s=s.stateNode,a=s._retryCache,a===null&&(a=s._retryCache=new s0),a;default:throw Error(i(435,s.tag))}}function Ad(s,a){var o=Aj(s);a.forEach(function(c){if(!o.has(c)){o.add(c);var m=Uj.bind(null,s,c);c.then(m,m)}})}function Rr(s,a){var o=a.deletions;if(o!==null)for(var c=0;c<o.length;c++){var m=o[c],f=s,w=a,N=w;e:for(;N!==null;){switch(N.tag){case 27:if(Yi(N.type)){un=N.stateNode,Cr=!1;break e}break;case 5:un=N.stateNode,Cr=!1;break e;case 3:case 4:un=N.stateNode.containerInfo,Cr=!0;break e}N=N.return}if(un===null)throw Error(i(160));a0(f,w,m),un=null,Cr=!1,f=m.alternate,f!==null&&(f.return=null),m.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)l0(a,s),a=a.sibling}var ga=null;function l0(s,a){var o=s.alternate,c=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Rr(a,s),Ar(s),c&4&&(zi(3,s,s.return),Oc(3,s),zi(5,s,s.return));break;case 1:Rr(a,s),Ar(s),c&512&&(Rn||o===null||Oa(o,o.return)),c&64&&ci&&(s=s.updateQueue,s!==null&&(c=s.callbacks,c!==null&&(o=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var m=ga;if(Rr(a,s),Ar(s),c&512&&(Rn||o===null||Oa(o,o.return)),c&4){var f=o!==null?o.memoizedState:null;if(c=s.memoizedState,o===null)if(c===null)if(s.stateNode===null){e:{c=s.type,o=s.memoizedProps,m=m.ownerDocument||m;t:switch(c){case"title":f=m.getElementsByTagName("title")[0],(!f||f[rn]||f[bt]||f.namespaceURI==="http://www.w3.org/2000/svg"||f.hasAttribute("itemprop"))&&(f=m.createElement(c),m.head.insertBefore(f,m.querySelector("head > title"))),er(f,c,o),f[bt]=s,de(f),c=f;break e;case"link":var w=l1("link","href",m).get(c+(o.href||""));if(w){for(var N=0;N<w.length;N++)if(f=w[N],f.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&f.getAttribute("rel")===(o.rel==null?null:o.rel)&&f.getAttribute("title")===(o.title==null?null:o.title)&&f.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){w.splice(N,1);break t}}f=m.createElement(c),er(f,c,o),m.head.appendChild(f);break;case"meta":if(w=l1("meta","content",m).get(c+(o.content||""))){for(N=0;N<w.length;N++)if(f=w[N],f.getAttribute("content")===(o.content==null?null:""+o.content)&&f.getAttribute("name")===(o.name==null?null:o.name)&&f.getAttribute("property")===(o.property==null?null:o.property)&&f.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&f.getAttribute("charset")===(o.charSet==null?null:o.charSet)){w.splice(N,1);break t}}f=m.createElement(c),er(f,c,o),m.head.appendChild(f);break;default:throw Error(i(468,c))}f[bt]=s,de(f),c=f}s.stateNode=c}else c1(m,s.type,s.stateNode);else s.stateNode=o1(m,c,s.memoizedProps);else f!==c?(f===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):f.count--,c===null?c1(m,s.type,s.stateNode):o1(m,c,s.memoizedProps)):c===null&&s.stateNode!==null&&Df(s,s.memoizedProps,o.memoizedProps)}break;case 27:Rr(a,s),Ar(s),c&512&&(Rn||o===null||Oa(o,o.return)),o!==null&&c&4&&Df(s,s.memoizedProps,o.memoizedProps);break;case 5:if(Rr(a,s),Ar(s),c&512&&(Rn||o===null||Oa(o,o.return)),s.flags&32){m=s.stateNode;try{zn(m,"")}catch(Nt){Ws(s,s.return,Nt)}}c&4&&s.stateNode!=null&&(m=s.memoizedProps,Df(s,m,o!==null?o.memoizedProps:m)),c&1024&&(Of=!0);break;case 6:if(Rr(a,s),Ar(s),c&4){if(s.stateNode===null)throw Error(i(162));c=s.memoizedProps,o=s.stateNode;try{o.nodeValue=c}catch(Nt){Ws(s,s.return,Nt)}}break;case 3:if(Gd=null,m=ga,ga=$d(a.containerInfo),Rr(a,s),ga=m,Ar(s),c&4&&o!==null&&o.memoizedState.isDehydrated)try{Vl(a.containerInfo)}catch(Nt){Ws(s,s.return,Nt)}Of&&(Of=!1,c0(s));break;case 4:c=ga,ga=$d(s.stateNode.containerInfo),Rr(a,s),Ar(s),ga=c;break;case 12:Rr(a,s),Ar(s);break;case 31:Rr(a,s),Ar(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Ad(s,c)));break;case 13:Rr(a,s),Ar(s),s.child.flags&8192&&s.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Id=Kt()),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Ad(s,c)));break;case 22:m=s.memoizedState!==null;var q=o!==null&&o.memoizedState!==null,ue=ci,Ne=Rn;if(ci=ue||m,Rn=Ne||q,Rr(a,s),Rn=Ne,ci=ue,Ar(s),c&8192)e:for(a=s.stateNode,a._visibility=m?a._visibility&-2:a._visibility|1,m&&(o===null||q||ci||Rn||Fo(s)),o=null,a=s;;){if(a.tag===5||a.tag===26){if(o===null){q=o=a;try{if(f=q.stateNode,m)w=f.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{N=q.stateNode;var ze=q.memoizedProps.style,me=ze!=null&&ze.hasOwnProperty("display")?ze.display:null;N.style.display=me==null||typeof me=="boolean"?"":(""+me).trim()}}catch(Nt){Ws(q,q.return,Nt)}}}else if(a.tag===6){if(o===null){q=a;try{q.stateNode.nodeValue=m?"":q.memoizedProps}catch(Nt){Ws(q,q.return,Nt)}}}else if(a.tag===18){if(o===null){q=a;try{var _e=q.stateNode;m?J0(_e,!0):J0(q.stateNode,!1)}catch(Nt){Ws(q,q.return,Nt)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===s)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;o===a&&(o=null),a=a.return}o===a&&(o=null),a.sibling.return=a.return,a=a.sibling}c&4&&(c=s.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,Ad(s,o))));break;case 19:Rr(a,s),Ar(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Ad(s,c)));break;case 30:break;case 21:break;default:Rr(a,s),Ar(s)}}function Ar(s){var a=s.flags;if(a&2){try{for(var o,c=s.return;c!==null;){if(e0(c)){o=c;break}c=c.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var m=o.stateNode,f=Pf(s);Rd(s,f,m);break;case 5:var w=o.stateNode;o.flags&32&&(zn(w,""),o.flags&=-33);var N=Pf(s);Rd(s,N,w);break;case 3:case 4:var q=o.stateNode.containerInfo,ue=Pf(s);Lf(s,ue,q);break;default:throw Error(i(161))}}catch(Ne){Ws(s,s.return,Ne)}s.flags&=-3}a&4096&&(s.flags&=-4097)}function c0(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var a=s;c0(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),s=s.sibling}}function di(s,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)n0(s,a.alternate,a),a=a.sibling}function Fo(s){for(s=s.child;s!==null;){var a=s;switch(a.tag){case 0:case 11:case 14:case 15:zi(4,a,a.return),Fo(a);break;case 1:Oa(a,a.return);var o=a.stateNode;typeof o.componentWillUnmount=="function"&&Jv(a,a.return,o),Fo(a);break;case 27:Gc(a.stateNode);case 26:case 5:Oa(a,a.return),Fo(a);break;case 22:a.memoizedState===null&&Fo(a);break;case 30:Fo(a);break;default:Fo(a)}s=s.sibling}}function hi(s,a,o){for(o=o&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var c=a.alternate,m=s,f=a,w=f.flags;switch(f.tag){case 0:case 11:case 15:hi(m,f,o),Oc(4,f);break;case 1:if(hi(m,f,o),c=f,m=c.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(ue){Ws(c,c.return,ue)}if(c=f,m=c.updateQueue,m!==null){var N=c.stateNode;try{var q=m.shared.hiddenCallbacks;if(q!==null)for(m.shared.hiddenCallbacks=null,m=0;m<q.length;m++)Ub(q[m],N)}catch(ue){Ws(c,c.return,ue)}}o&&w&64&&Xv(f),Bc(f,f.return);break;case 27:t0(f);case 26:case 5:hi(m,f,o),o&&c===null&&w&4&&Zv(f),Bc(f,f.return);break;case 12:hi(m,f,o);break;case 31:hi(m,f,o),o&&w&4&&i0(m,f);break;case 13:hi(m,f,o),o&&w&4&&o0(m,f);break;case 22:f.memoizedState===null&&hi(m,f,o),Bc(f,f.return);break;case 30:break;default:hi(m,f,o)}a=a.sibling}}function Bf(s,a){var o=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),s=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(s=a.memoizedState.cachePool.pool),s!==o&&(s!=null&&s.refCount++,o!=null&&jc(o))}function Vf(s,a){s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&jc(s))}function ya(s,a,o,c){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)u0(s,a,o,c),a=a.sibling}function u0(s,a,o,c){var m=a.flags;switch(a.tag){case 0:case 11:case 15:ya(s,a,o,c),m&2048&&Oc(9,a);break;case 1:ya(s,a,o,c);break;case 3:ya(s,a,o,c),m&2048&&(s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&jc(s)));break;case 12:if(m&2048){ya(s,a,o,c),s=a.stateNode;try{var f=a.memoizedProps,w=f.id,N=f.onPostCommit;typeof N=="function"&&N(w,a.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(q){Ws(a,a.return,q)}}else ya(s,a,o,c);break;case 31:ya(s,a,o,c);break;case 13:ya(s,a,o,c);break;case 23:break;case 22:f=a.stateNode,w=a.alternate,a.memoizedState!==null?f._visibility&2?ya(s,a,o,c):Vc(s,a):f._visibility&2?ya(s,a,o,c):(f._visibility|=2,Nl(s,a,o,c,(a.subtreeFlags&10256)!==0||!1)),m&2048&&Bf(w,a);break;case 24:ya(s,a,o,c),m&2048&&Vf(a.alternate,a);break;default:ya(s,a,o,c)}}function Nl(s,a,o,c,m){for(m=m&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var f=s,w=a,N=o,q=c,ue=w.flags;switch(w.tag){case 0:case 11:case 15:Nl(f,w,N,q,m),Oc(8,w);break;case 23:break;case 22:var Ne=w.stateNode;w.memoizedState!==null?Ne._visibility&2?Nl(f,w,N,q,m):Vc(f,w):(Ne._visibility|=2,Nl(f,w,N,q,m)),m&&ue&2048&&Bf(w.alternate,w);break;case 24:Nl(f,w,N,q,m),m&&ue&2048&&Vf(w.alternate,w);break;default:Nl(f,w,N,q,m)}a=a.sibling}}function Vc(s,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var o=s,c=a,m=c.flags;switch(c.tag){case 22:Vc(o,c),m&2048&&Bf(c.alternate,c);break;case 24:Vc(o,c),m&2048&&Vf(c.alternate,c);break;default:Vc(o,c)}a=a.sibling}}var Uc=8192;function Cl(s,a,o){if(s.subtreeFlags&Uc)for(s=s.child;s!==null;)d0(s,a,o),s=s.sibling}function d0(s,a,o){switch(s.tag){case 26:Cl(s,a,o),s.flags&Uc&&s.memoizedState!==null&&yT(o,ga,s.memoizedState,s.memoizedProps);break;case 5:Cl(s,a,o);break;case 3:case 4:var c=ga;ga=$d(s.stateNode.containerInfo),Cl(s,a,o),ga=c;break;case 22:s.memoizedState===null&&(c=s.alternate,c!==null&&c.memoizedState!==null?(c=Uc,Uc=16777216,Cl(s,a,o),Uc=c):Cl(s,a,o));break;default:Cl(s,a,o)}}function h0(s){var a=s.alternate;if(a!==null&&(s=a.child,s!==null)){a.child=null;do a=s.sibling,s.sibling=null,s=a;while(s!==null)}}function Fc(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var o=0;o<a.length;o++){var c=a[o];$n=c,f0(c,s)}h0(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)m0(s),s=s.sibling}function m0(s){switch(s.tag){case 0:case 11:case 15:Fc(s),s.flags&2048&&zi(9,s,s.return);break;case 3:Fc(s);break;case 12:Fc(s);break;case 22:var a=s.stateNode;s.memoizedState!==null&&a._visibility&2&&(s.return===null||s.return.tag!==13)?(a._visibility&=-3,Md(s)):Fc(s);break;default:Fc(s)}}function Md(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var o=0;o<a.length;o++){var c=a[o];$n=c,f0(c,s)}h0(s)}for(s=s.child;s!==null;){switch(a=s,a.tag){case 0:case 11:case 15:zi(8,a,a.return),Md(a);break;case 22:o=a.stateNode,o._visibility&2&&(o._visibility&=-3,Md(a));break;default:Md(a)}s=s.sibling}}function f0(s,a){for(;$n!==null;){var o=$n;switch(o.tag){case 0:case 11:case 15:zi(8,o,a);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:jc(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,$n=c;else e:for(o=s;$n!==null;){c=$n;var m=c.sibling,f=c.return;if(r0(c),c===o){$n=null;break e}if(m!==null){m.return=f,$n=m;break e}$n=f}}}var Mj={getCacheForType:function(s){var a=Jn(En),o=a.data.get(s);return o===void 0&&(o=s(),a.data.set(s,o)),o},cacheSignal:function(){return Jn(En).controller.signal}},Ij=typeof WeakMap=="function"?WeakMap:Map,zs=0,en=null,vs=null,js=0,$s=0,qr=null,qi=!1,Rl=!1,Uf=!1,mi=0,gn=0,Hi=0,zo=0,Ff=0,Hr=0,Al=0,zc=null,Mr=null,zf=!1,Id=0,p0=0,Dd=1/0,Pd=null,$i=null,Vn=0,Wi=null,Ml=null,fi=0,qf=0,Hf=null,g0=null,qc=0,$f=null;function $r(){return(zs&2)!==0&&js!==0?js&-js:H.T!==null?Xf():Ee()}function y0(){if(Hr===0)if((js&536870912)===0||Ms){var s=X;X<<=1,(X&3932160)===0&&(X=262144),Hr=s}else Hr=536870912;return s=Fr.current,s!==null&&(s.flags|=32),Hr}function Ir(s,a,o){(s===en&&($s===2||$s===9)||s.cancelPendingCommit!==null)&&(Il(s,0),Gi(s,js,Hr,!1)),Je(s,o),((zs&2)===0||s!==en)&&(s===en&&((zs&2)===0&&(zo|=o),gn===4&&Gi(s,js,Hr,!1)),Ba(s))}function b0(s,a,o){if((zs&6)!==0)throw Error(i(327));var c=!o&&(a&127)===0&&(a&s.expiredLanes)===0||et(s,a),m=c?Lj(s,a):Gf(s,a,!0),f=c;do{if(m===0){Rl&&!c&&Gi(s,a,0,!1);break}else{if(o=s.current.alternate,f&&!Dj(o)){m=Gf(s,a,!1),f=!1;continue}if(m===2){if(f=a,s.errorRecoveryDisabledLanes&f)var w=0;else w=s.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){a=w;e:{var N=s;m=zc;var q=N.current.memoizedState.isDehydrated;if(q&&(Il(N,w).flags|=256),w=Gf(N,w,!1),w!==2){if(Uf&&!q){N.errorRecoveryDisabledLanes|=f,zo|=f,m=4;break e}f=Mr,Mr=m,f!==null&&(Mr===null?Mr=f:Mr.push.apply(Mr,f))}m=w}if(f=!1,m!==2)continue}}if(m===1){Il(s,0),Gi(s,a,0,!0);break}e:{switch(c=s,f=m,f){case 0:case 1:throw Error(i(345));case 4:if((a&4194048)!==a)break;case 6:Gi(c,a,Hr,!qi);break e;case 2:Mr=null;break;case 3:case 5:break;default:throw Error(i(329))}if((a&62914560)===a&&(m=Id+300-Kt(),10<m)){if(Gi(c,a,Hr,!qi),wt(c,0,!0)!==0)break e;fi=a,c.timeoutHandle=Y0(v0.bind(null,c,o,Mr,Pd,zf,a,Hr,zo,Al,qi,f,"Throttled",-0,0),m);break e}v0(c,o,Mr,Pd,zf,a,Hr,zo,Al,qi,f,null,-0,0)}}break}while(!0);Ba(s)}function v0(s,a,o,c,m,f,w,N,q,ue,Ne,ze,me,_e){if(s.timeoutHandle=-1,ze=a.subtreeFlags,ze&8192||(ze&16785408)===16785408){ze={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Dn},d0(a,f,ze);var Nt=(f&62914560)===f?Id-Kt():(f&4194048)===f?p0-Kt():0;if(Nt=bT(ze,Nt),Nt!==null){fi=f,s.cancelPendingCommit=Nt(E0.bind(null,s,a,f,o,c,m,w,N,q,Ne,ze,null,me,_e)),Gi(s,f,w,!ue);return}}E0(s,a,f,o,c,m,w,N,q)}function Dj(s){for(var a=s;;){var o=a.tag;if((o===0||o===11||o===15)&&a.flags&16384&&(o=a.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var m=o[c],f=m.getSnapshot;m=m.value;try{if(!Vr(f(),m))return!1}catch{return!1}}if(o=a.child,a.subtreeFlags&16384&&o!==null)o.return=a,a=o;else{if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Gi(s,a,o,c){a&=~Ff,a&=~zo,s.suspendedLanes|=a,s.pingedLanes&=~a,c&&(s.warmLanes|=a),c=s.expirationTimes;for(var m=a;0<m;){var f=31-Pe(m),w=1<<f;c[f]=-1,m&=~w}o!==0&&at(s,o,a)}function Ld(){return(zs&6)===0?(Hc(0),!1):!0}function Wf(){if(vs!==null){if($s===0)var s=vs.return;else s=vs,ni=Io=null,lf(s),kl=null,Sc=0,s=vs;for(;s!==null;)Qv(s.alternate,s),s=s.return;vs=null}}function Il(s,a){var o=s.timeoutHandle;o!==-1&&(s.timeoutHandle=-1,eT(o)),o=s.cancelPendingCommit,o!==null&&(s.cancelPendingCommit=null,o()),fi=0,Wf(),en=s,vs=o=ti(s.current,null),js=a,$s=0,qr=null,qi=!1,Rl=et(s,a),Uf=!1,Al=Hr=Ff=zo=Hi=gn=0,Mr=zc=null,zf=!1,(a&8)!==0&&(a|=a&32);var c=s.entangledLanes;if(c!==0)for(s=s.entanglements,c&=a;0<c;){var m=31-Pe(c),f=1<<m;a|=s[m],c&=~f}return mi=a,nd(),o}function x0(s,a){ds=null,H.H=Dc,a===_l||a===dd?(a=Lb(),$s=3):a===Ym?(a=Lb(),$s=4):$s=a===jf?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,qr=a,vs===null&&(gn=1,Td(s,ea(a,s.current)))}function w0(){var s=Fr.current;return s===null?!0:(js&4194048)===js?ra===null:(js&62914560)===js||(js&536870912)!==0?s===ra:!1}function _0(){var s=H.H;return H.H=Dc,s===null?Dc:s}function k0(){var s=H.A;return H.A=Mj,s}function Od(){gn=4,qi||(js&4194048)!==js&&Fr.current!==null||(Rl=!0),(Hi&134217727)===0&&(zo&134217727)===0||en===null||Gi(en,js,Hr,!1)}function Gf(s,a,o){var c=zs;zs|=2;var m=_0(),f=k0();(en!==s||js!==a)&&(Pd=null,Il(s,a)),a=!1;var w=gn;e:do try{if($s!==0&&vs!==null){var N=vs,q=qr;switch($s){case 8:Wf(),w=6;break e;case 3:case 2:case 9:case 6:Fr.current===null&&(a=!0);var ue=$s;if($s=0,qr=null,Dl(s,N,q,ue),o&&Rl){w=0;break e}break;default:ue=$s,$s=0,qr=null,Dl(s,N,q,ue)}}Pj(),w=gn;break}catch(Ne){x0(s,Ne)}while(!0);return a&&s.shellSuspendCounter++,ni=Io=null,zs=c,H.H=m,H.A=f,vs===null&&(en=null,js=0,nd()),w}function Pj(){for(;vs!==null;)j0(vs)}function Lj(s,a){var o=zs;zs|=2;var c=_0(),m=k0();en!==s||js!==a?(Pd=null,Dd=Kt()+500,Il(s,a)):Rl=et(s,a);e:do try{if($s!==0&&vs!==null){a=vs;var f=qr;t:switch($s){case 1:$s=0,qr=null,Dl(s,a,f,1);break;case 2:case 9:if(Db(f)){$s=0,qr=null,T0(a);break}a=function(){$s!==2&&$s!==9||en!==s||($s=7),Ba(s)},f.then(a,a);break e;case 3:$s=7;break e;case 4:$s=5;break e;case 7:Db(f)?($s=0,qr=null,T0(a)):($s=0,qr=null,Dl(s,a,f,7));break;case 5:var w=null;switch(vs.tag){case 26:w=vs.memoizedState;case 5:case 27:var N=vs;if(w?u1(w):N.stateNode.complete){$s=0,qr=null;var q=N.sibling;if(q!==null)vs=q;else{var ue=N.return;ue!==null?(vs=ue,Bd(ue)):vs=null}break t}}$s=0,qr=null,Dl(s,a,f,5);break;case 6:$s=0,qr=null,Dl(s,a,f,6);break;case 8:Wf(),gn=6;break e;default:throw Error(i(462))}}Oj();break}catch(Ne){x0(s,Ne)}while(!0);return ni=Io=null,H.H=c,H.A=m,zs=o,vs!==null?0:(en=null,js=0,nd(),gn)}function Oj(){for(;vs!==null&&!Gt();)j0(vs)}function j0(s){var a=Kv(s.alternate,s,mi);s.memoizedProps=s.pendingProps,a===null?Bd(s):vs=a}function T0(s){var a=s,o=a.alternate;switch(a.tag){case 15:case 0:a=zv(o,a,a.pendingProps,a.type,void 0,js);break;case 11:a=zv(o,a,a.pendingProps,a.type.render,a.ref,js);break;case 5:lf(a);default:Qv(o,a),a=vs=kb(a,mi),a=Kv(o,a,mi)}s.memoizedProps=s.pendingProps,a===null?Bd(s):vs=a}function Dl(s,a,o,c){ni=Io=null,lf(a),kl=null,Sc=0;var m=a.return;try{if(Tj(s,m,a,o,js)){gn=1,Td(s,ea(o,s.current)),vs=null;return}}catch(f){if(m!==null)throw vs=m,f;gn=1,Td(s,ea(o,s.current)),vs=null;return}a.flags&32768?(Ms||c===1?s=!0:Rl||(js&536870912)!==0?s=!1:(qi=s=!0,(c===2||c===9||c===3||c===6)&&(c=Fr.current,c!==null&&c.tag===13&&(c.flags|=16384))),S0(a,s)):Bd(a)}function Bd(s){var a=s;do{if((a.flags&32768)!==0){S0(a,qi);return}s=a.return;var o=Nj(a.alternate,a,mi);if(o!==null){vs=o;return}if(a=a.sibling,a!==null){vs=a;return}vs=a=s}while(a!==null);gn===0&&(gn=5)}function S0(s,a){do{var o=Cj(s.alternate,s);if(o!==null){o.flags&=32767,vs=o;return}if(o=s.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!a&&(s=s.sibling,s!==null)){vs=s;return}vs=s=o}while(s!==null);gn=6,vs=null}function E0(s,a,o,c,m,f,w,N,q){s.cancelPendingCommit=null;do Vd();while(Vn!==0);if((zs&6)!==0)throw Error(i(327));if(a!==null){if(a===s.current)throw Error(i(177));if(f=a.lanes|a.childLanes,f|=Dm,yt(s,o,f,w,N,q),s===en&&(vs=en=null,js=0),Ml=a,Wi=s,fi=o,qf=f,Hf=m,g0=c,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Fj(is,function(){return M0(),null})):(s.callbackNode=null,s.callbackPriority=0),c=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||c){c=H.T,H.T=null,m=fe.p,fe.p=2,w=zs,zs|=4;try{Rj(s,a,o)}finally{zs=w,fe.p=m,H.T=c}}Vn=1,N0(),C0(),R0()}}function N0(){if(Vn===1){Vn=0;var s=Wi,a=Ml,o=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||o){o=H.T,H.T=null;var c=fe.p;fe.p=2;var m=zs;zs|=4;try{l0(a,s);var f=ap,w=fb(s.containerInfo),N=f.focusedElem,q=f.selectionRange;if(w!==N&&N&&N.ownerDocument&&mb(N.ownerDocument.documentElement,N)){if(q!==null&&Cm(N)){var ue=q.start,Ne=q.end;if(Ne===void 0&&(Ne=ue),"selectionStart"in N)N.selectionStart=ue,N.selectionEnd=Math.min(Ne,N.value.length);else{var ze=N.ownerDocument||document,me=ze&&ze.defaultView||window;if(me.getSelection){var _e=me.getSelection(),Nt=N.textContent.length,Wt=Math.min(q.start,Nt),Ys=q.end===void 0?Wt:Math.min(q.end,Nt);!_e.extend&&Wt>Ys&&(w=Ys,Ys=Wt,Wt=w);var ee=hb(N,Wt),G=hb(N,Ys);if(ee&&G&&(_e.rangeCount!==1||_e.anchorNode!==ee.node||_e.anchorOffset!==ee.offset||_e.focusNode!==G.node||_e.focusOffset!==G.offset)){var ce=ze.createRange();ce.setStart(ee.node,ee.offset),_e.removeAllRanges(),Wt>Ys?(_e.addRange(ce),_e.extend(G.node,G.offset)):(ce.setEnd(G.node,G.offset),_e.addRange(ce))}}}}for(ze=[],_e=N;_e=_e.parentNode;)_e.nodeType===1&&ze.push({element:_e,left:_e.scrollLeft,top:_e.scrollTop});for(typeof N.focus=="function"&&N.focus(),N=0;N<ze.length;N++){var Be=ze[N];Be.element.scrollLeft=Be.left,Be.element.scrollTop=Be.top}}Xd=!!rp,ap=rp=null}finally{zs=m,fe.p=c,H.T=o}}s.current=a,Vn=2}}function C0(){if(Vn===2){Vn=0;var s=Wi,a=Ml,o=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||o){o=H.T,H.T=null;var c=fe.p;fe.p=2;var m=zs;zs|=4;try{n0(s,a.alternate,a)}finally{zs=m,fe.p=c,H.T=o}}Vn=3}}function R0(){if(Vn===4||Vn===3){Vn=0,ps();var s=Wi,a=Ml,o=fi,c=g0;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?Vn=5:(Vn=0,Ml=Wi=null,A0(s,s.pendingLanes));var m=s.pendingLanes;if(m===0&&($i=null),be(o),a=a.stateNode,ve&&typeof ve.onCommitFiberRoot=="function")try{ve.onCommitFiberRoot(_s,a,void 0,(a.current.flags&128)===128)}catch{}if(c!==null){a=H.T,m=fe.p,fe.p=2,H.T=null;try{for(var f=s.onRecoverableError,w=0;w<c.length;w++){var N=c[w];f(N.value,{componentStack:N.stack})}}finally{H.T=a,fe.p=m}}(fi&3)!==0&&Vd(),Ba(s),m=s.pendingLanes,(o&261930)!==0&&(m&42)!==0?s===$f?qc++:(qc=0,$f=s):qc=0,Hc(0)}}function A0(s,a){(s.pooledCacheLanes&=a)===0&&(a=s.pooledCache,a!=null&&(s.pooledCache=null,jc(a)))}function Vd(){return N0(),C0(),R0(),M0()}function M0(){if(Vn!==5)return!1;var s=Wi,a=qf;qf=0;var o=be(fi),c=H.T,m=fe.p;try{fe.p=32>o?32:o,H.T=null,o=Hf,Hf=null;var f=Wi,w=fi;if(Vn=0,Ml=Wi=null,fi=0,(zs&6)!==0)throw Error(i(331));var N=zs;if(zs|=4,m0(f.current),u0(f,f.current,w,o),zs=N,Hc(0,!1),ve&&typeof ve.onPostCommitFiberRoot=="function")try{ve.onPostCommitFiberRoot(_s,f)}catch{}return!0}finally{fe.p=m,H.T=c,A0(s,a)}}function I0(s,a,o){a=ea(o,a),a=kf(s.stateNode,a,2),s=Vi(s,a,2),s!==null&&(Je(s,2),Ba(s))}function Ws(s,a,o){if(s.tag===3)I0(s,s,o);else for(;a!==null;){if(a.tag===3){I0(a,s,o);break}else if(a.tag===1){var c=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&($i===null||!$i.has(c))){s=ea(o,s),o=Dv(2),c=Vi(a,o,2),c!==null&&(Pv(o,c,a,s),Je(c,2),Ba(c));break}}a=a.return}}function Kf(s,a,o){var c=s.pingCache;if(c===null){c=s.pingCache=new Ij;var m=new Set;c.set(a,m)}else m=c.get(a),m===void 0&&(m=new Set,c.set(a,m));m.has(o)||(Uf=!0,m.add(o),s=Bj.bind(null,s,a,o),a.then(s,s))}function Bj(s,a,o){var c=s.pingCache;c!==null&&c.delete(a),s.pingedLanes|=s.suspendedLanes&o,s.warmLanes&=~o,en===s&&(js&o)===o&&(gn===4||gn===3&&(js&62914560)===js&&300>Kt()-Id?(zs&2)===0&&Il(s,0):Ff|=o,Al===js&&(Al=0)),Ba(s)}function D0(s,a){a===0&&(a=Q()),s=Ro(s,a),s!==null&&(Je(s,a),Ba(s))}function Vj(s){var a=s.memoizedState,o=0;a!==null&&(o=a.retryLane),D0(s,o)}function Uj(s,a){var o=0;switch(s.tag){case 31:case 13:var c=s.stateNode,m=s.memoizedState;m!==null&&(o=m.retryLane);break;case 19:c=s.stateNode;break;case 22:c=s.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(a),D0(s,o)}function Fj(s,a){return ot(s,a)}var Ud=null,Pl=null,Yf=!1,Fd=!1,Qf=!1,Ki=0;function Ba(s){s!==Pl&&s.next===null&&(Pl===null?Ud=Pl=s:Pl=Pl.next=s),Fd=!0,Yf||(Yf=!0,qj())}function Hc(s,a){if(!Qf&&Fd){Qf=!0;do for(var o=!1,c=Ud;c!==null;){if(s!==0){var m=c.pendingLanes;if(m===0)var f=0;else{var w=c.suspendedLanes,N=c.pingedLanes;f=(1<<31-Pe(42|s)+1)-1,f&=m&~(w&~N),f=f&201326741?f&201326741|1:f?f|2:0}f!==0&&(o=!0,B0(c,f))}else f=js,f=wt(c,c===en?f:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(f&3)===0||et(c,f)||(o=!0,B0(c,f));c=c.next}while(o);Qf=!1}}function zj(){P0()}function P0(){Fd=Yf=!1;var s=0;Ki!==0&&Zj()&&(s=Ki);for(var a=Kt(),o=null,c=Ud;c!==null;){var m=c.next,f=L0(c,a);f===0?(c.next=null,o===null?Ud=m:o.next=m,m===null&&(Pl=o)):(o=c,(s!==0||(f&3)!==0)&&(Fd=!0)),c=m}Vn!==0&&Vn!==5||Hc(s),Ki!==0&&(Ki=0)}function L0(s,a){for(var o=s.suspendedLanes,c=s.pingedLanes,m=s.expirationTimes,f=s.pendingLanes&-62914561;0<f;){var w=31-Pe(f),N=1<<w,q=m[w];q===-1?((N&o)===0||(N&c)!==0)&&(m[w]=_t(N,a)):q<=a&&(s.expiredLanes|=N),f&=~N}if(a=en,o=js,o=wt(s,s===a?o:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c=s.callbackNode,o===0||s===a&&($s===2||$s===9)||s.cancelPendingCommit!==null)return c!==null&&c!==null&&Pt(c),s.callbackNode=null,s.callbackPriority=0;if((o&3)===0||et(s,o)){if(a=o&-o,a===s.callbackPriority)return a;switch(c!==null&&Pt(c),be(o)){case 2:case 8:o=ws;break;case 32:o=is;break;case 268435456:o=Ps;break;default:o=is}return c=O0.bind(null,s),o=ot(o,c),s.callbackPriority=a,s.callbackNode=o,a}return c!==null&&c!==null&&Pt(c),s.callbackPriority=2,s.callbackNode=null,2}function O0(s,a){if(Vn!==0&&Vn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var o=s.callbackNode;if(Vd()&&s.callbackNode!==o)return null;var c=js;return c=wt(s,s===en?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c===0?null:(b0(s,c,a),L0(s,Kt()),s.callbackNode!=null&&s.callbackNode===o?O0.bind(null,s):null)}function B0(s,a){if(Vd())return null;b0(s,a,!0)}function qj(){tT(function(){(zs&6)!==0?ot(hs,zj):P0()})}function Xf(){if(Ki===0){var s=xl;s===0&&(s=gt,gt<<=1,(gt&261888)===0&&(gt=256)),Ki=s}return Ki}function V0(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Tr(""+s)}function U0(s,a){var o=a.ownerDocument.createElement("input");return o.name=a.name,o.value=a.value,s.id&&o.setAttribute("form",s.id),a.parentNode.insertBefore(o,a),s=new FormData(s),o.parentNode.removeChild(o),s}function Hj(s,a,o,c,m){if(a==="submit"&&o&&o.stateNode===m){var f=V0((m[Ct]||null).action),w=c.submitter;w&&(a=(a=w[Ct]||null)?V0(a.formAction):w.getAttribute("formAction"),a!==null&&(f=a,w=null));var N=new tt("action","action",null,c,m);s.push({event:N,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Ki!==0){var q=w?U0(m,w):new FormData(m);yf(o,{pending:!0,data:q,method:m.method,action:f},null,q)}}else typeof f=="function"&&(N.preventDefault(),q=w?U0(m,w):new FormData(m),yf(o,{pending:!0,data:q,method:m.method,action:f},f,q))},currentTarget:m}]})}}for(var Jf=0;Jf<Im.length;Jf++){var Zf=Im[Jf],$j=Zf.toLowerCase(),Wj=Zf[0].toUpperCase()+Zf.slice(1);pa($j,"on"+Wj)}pa(yb,"onAnimationEnd"),pa(bb,"onAnimationIteration"),pa(vb,"onAnimationStart"),pa("dblclick","onDoubleClick"),pa("focusin","onFocus"),pa("focusout","onBlur"),pa(lj,"onTransitionRun"),pa(cj,"onTransitionStart"),pa(uj,"onTransitionCancel"),pa(xb,"onTransitionEnd"),F("onMouseEnter",["mouseout","mouseover"]),F("onMouseLeave",["mouseout","mouseover"]),F("onPointerEnter",["pointerout","pointerover"]),F("onPointerLeave",["pointerout","pointerover"]),S("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),S("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),S("onBeforeInput",["compositionend","keypress","textInput","paste"]),S("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),S("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),S("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $c="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Gj=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat($c));function F0(s,a){a=(a&4)!==0;for(var o=0;o<s.length;o++){var c=s[o],m=c.event;c=c.listeners;e:{var f=void 0;if(a)for(var w=c.length-1;0<=w;w--){var N=c[w],q=N.instance,ue=N.currentTarget;if(N=N.listener,q!==f&&m.isPropagationStopped())break e;f=N,m.currentTarget=ue;try{f(m)}catch(Ne){sd(Ne)}m.currentTarget=null,f=q}else for(w=0;w<c.length;w++){if(N=c[w],q=N.instance,ue=N.currentTarget,N=N.listener,q!==f&&m.isPropagationStopped())break e;f=N,m.currentTarget=ue;try{f(m)}catch(Ne){sd(Ne)}m.currentTarget=null,f=q}}}}function xs(s,a){var o=a[zt];o===void 0&&(o=a[zt]=new Set);var c=s+"__bubble";o.has(c)||(z0(a,s,2,!1),o.add(c))}function ep(s,a,o){var c=0;a&&(c|=4),z0(o,s,c,a)}var zd="_reactListening"+Math.random().toString(36).slice(2);function tp(s){if(!s[zd]){s[zd]=!0,le.forEach(function(o){o!=="selectionchange"&&(Gj.has(o)||ep(o,!1,s),ep(o,!0,s))});var a=s.nodeType===9?s:s.ownerDocument;a===null||a[zd]||(a[zd]=!0,ep("selectionchange",!1,a))}}function z0(s,a,o,c){switch(y1(a)){case 2:var m=wT;break;case 8:m=_T;break;default:m=gp}o=m.bind(null,a,o,s),m=void 0,!rt||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(m=!0),c?m!==void 0?s.addEventListener(a,o,{capture:!0,passive:m}):s.addEventListener(a,o,!0):m!==void 0?s.addEventListener(a,o,{passive:m}):s.addEventListener(a,o,!1)}function sp(s,a,o,c,m){var f=c;if((a&1)===0&&(a&2)===0&&c!==null)e:for(;;){if(c===null)return;var w=c.tag;if(w===3||w===4){var N=c.stateNode.containerInfo;if(N===m)break;if(w===4)for(w=c.return;w!==null;){var q=w.tag;if((q===3||q===4)&&w.stateNode.containerInfo===m)return;w=w.return}for(;N!==null;){if(w=As(N),w===null)return;if(q=w.tag,q===5||q===6||q===26||q===27){c=f=w;continue e}N=N.parentNode}}c=c.return}he(function(){var ue=f,Ne=Pn(o),ze=[];e:{var me=wb.get(s);if(me!==void 0){var _e=tt,Nt=s;switch(s){case"keypress":if(E(o)===0)break e;case"keydown":case"keyup":_e=ei;break;case"focusin":Nt="focus",_e=On;break;case"focusout":Nt="blur",_e=On;break;case"beforeblur":case"afterblur":_e=On;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_e=Ln;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_e=Js;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_e=v;break;case yb:case bb:case vb:_e=Kn;break;case xb:_e=R;break;case"scroll":case"scrollend":_e=Ft;break;case"wheel":_e=xe;break;case"copy":case"cut":case"paste":_e=Sr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_e=ar;break;case"toggle":case"beforetoggle":_e=us}var Wt=(a&4)!==0,Ys=!Wt&&(s==="scroll"||s==="scrollend"),ee=Wt?me!==null?me+"Capture":null:me;Wt=[];for(var G=ue,ce;G!==null;){var Be=G;if(ce=Be.stateNode,Be=Be.tag,Be!==5&&Be!==26&&Be!==27||ce===null||ee===null||(Be=Ce(G,ee),Be!=null&&Wt.push(Wc(G,Be,ce))),Ys)break;G=G.return}0<Wt.length&&(me=new _e(me,Nt,null,o,Ne),ze.push({event:me,listeners:Wt}))}}if((a&7)===0){e:{if(me=s==="mouseover"||s==="pointerover",_e=s==="mouseout"||s==="pointerout",me&&o!==qn&&(Nt=o.relatedTarget||o.fromElement)&&(As(Nt)||Nt[ft]))break e;if((_e||me)&&(me=Ne.window===Ne?Ne:(me=Ne.ownerDocument)?me.defaultView||me.parentWindow:window,_e?(Nt=o.relatedTarget||o.toElement,_e=ue,Nt=Nt?As(Nt):null,Nt!==null&&(Ys=u(Nt),Wt=Nt.tag,Nt!==Ys||Wt!==5&&Wt!==27&&Wt!==6)&&(Nt=null)):(_e=null,Nt=ue),_e!==Nt)){if(Wt=Ln,Be="onMouseLeave",ee="onMouseEnter",G="mouse",(s==="pointerout"||s==="pointerover")&&(Wt=ar,Be="onPointerLeave",ee="onPointerEnter",G="pointer"),Ys=_e==null?me:ks(_e),ce=Nt==null?me:ks(Nt),me=new Wt(Be,G+"leave",_e,o,Ne),me.target=Ys,me.relatedTarget=ce,Be=null,As(Ne)===ue&&(Wt=new Wt(ee,G+"enter",Nt,o,Ne),Wt.target=ce,Wt.relatedTarget=Ys,Be=Wt),Ys=Be,_e&&Nt)t:{for(Wt=Kj,ee=_e,G=Nt,ce=0,Be=ee;Be;Be=Wt(Be))ce++;Be=0;for(var Bt=G;Bt;Bt=Wt(Bt))Be++;for(;0<ce-Be;)ee=Wt(ee),ce--;for(;0<Be-ce;)G=Wt(G),Be--;for(;ce--;){if(ee===G||G!==null&&ee===G.alternate){Wt=ee;break t}ee=Wt(ee),G=Wt(G)}Wt=null}else Wt=null;_e!==null&&q0(ze,me,_e,Wt,!1),Nt!==null&&Ys!==null&&q0(ze,Ys,Nt,Wt,!0)}}e:{if(me=ue?ks(ue):window,_e=me.nodeName&&me.nodeName.toLowerCase(),_e==="select"||_e==="input"&&me.type==="file")var Vs=ib;else if(rb(me))if(ob)Vs=aj;else{Vs=nj;var At=sj}else _e=me.nodeName,!_e||_e.toLowerCase()!=="input"||me.type!=="checkbox"&&me.type!=="radio"?ue&&Ma(ue.elementType)&&(Vs=ib):Vs=rj;if(Vs&&(Vs=Vs(s,ue))){ab(ze,Vs,o,Ne);break e}At&&At(s,me,ue),s==="focusout"&&ue&&me.type==="number"&&ue.memoizedProps.value!=null&&Qr(me,"number",me.value)}switch(At=ue?ks(ue):window,s){case"focusin":(rb(At)||At.contentEditable==="true")&&(hl=At,Rm=ue,wc=null);break;case"focusout":wc=Rm=hl=null;break;case"mousedown":Am=!0;break;case"contextmenu":case"mouseup":case"dragend":Am=!1,pb(ze,o,Ne);break;case"selectionchange":if(oj)break;case"keydown":case"keyup":pb(ze,o,Ne)}var fs;if(Fs)e:{switch(s){case"compositionstart":var Ts="onCompositionStart";break e;case"compositionend":Ts="onCompositionEnd";break e;case"compositionupdate":Ts="onCompositionUpdate";break e}Ts=void 0}else dl?Eo(s,o)&&(Ts="onCompositionEnd"):s==="keydown"&&o.keyCode===229&&(Ts="onCompositionStart");Ts&&(Da&&o.locale!=="ko"&&(dl||Ts!=="onCompositionStart"?Ts==="onCompositionEnd"&&dl&&(fs=ts()):(Ot=Ne,es="value"in Ot?Ot.value:Ot.textContent,dl=!0)),At=qd(ue,Ts),0<At.length&&(Ts=new fn(Ts,s,null,o,Ne),ze.push({event:Ts,listeners:At}),fs?Ts.data=fs:(fs=ul(o),fs!==null&&(Ts.data=fs)))),(fs=Jr?Jk(s,o):Zk(s,o))&&(Ts=qd(ue,"onBeforeInput"),0<Ts.length&&(At=new fn("onBeforeInput","beforeinput",null,o,Ne),ze.push({event:At,listeners:Ts}),At.data=fs)),Hj(ze,s,ue,o,Ne)}F0(ze,a)})}function Wc(s,a,o){return{instance:s,listener:a,currentTarget:o}}function qd(s,a){for(var o=a+"Capture",c=[];s!==null;){var m=s,f=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||f===null||(m=Ce(s,o),m!=null&&c.unshift(Wc(s,m,f)),m=Ce(s,a),m!=null&&c.push(Wc(s,m,f))),s.tag===3)return c;s=s.return}return[]}function Kj(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function q0(s,a,o,c,m){for(var f=a._reactName,w=[];o!==null&&o!==c;){var N=o,q=N.alternate,ue=N.stateNode;if(N=N.tag,q!==null&&q===c)break;N!==5&&N!==26&&N!==27||ue===null||(q=ue,m?(ue=Ce(o,f),ue!=null&&w.unshift(Wc(o,ue,q))):m||(ue=Ce(o,f),ue!=null&&w.push(Wc(o,ue,q)))),o=o.return}w.length!==0&&s.push({event:a,listeners:w})}var Yj=/\r\n?/g,Qj=/\u0000|\uFFFD/g;function H0(s){return(typeof s=="string"?s:""+s).replace(Yj,`
`).replace(Qj,"")}function $0(s,a){return a=H0(a),H0(s)===a}function Ks(s,a,o,c,m,f){switch(o){case"children":typeof c=="string"?a==="body"||a==="textarea"&&c===""||zn(s,c):(typeof c=="number"||typeof c=="bigint")&&a!=="body"&&zn(s,""+c);break;case"className":Dt(s,"class",c);break;case"tabIndex":Dt(s,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":Dt(s,o,c);break;case"style":kr(s,c,f);break;case"data":if(a!=="object"){Dt(s,"data",c);break}case"src":case"href":if(c===""&&(a!=="a"||o!=="href")){s.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(o);break}c=Tr(""+c),s.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){s.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof f=="function"&&(o==="formAction"?(a!=="input"&&Ks(s,a,"name",m.name,m,null),Ks(s,a,"formEncType",m.formEncType,m,null),Ks(s,a,"formMethod",m.formMethod,m,null),Ks(s,a,"formTarget",m.formTarget,m,null)):(Ks(s,a,"encType",m.encType,m,null),Ks(s,a,"method",m.method,m,null),Ks(s,a,"target",m.target,m,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(o);break}c=Tr(""+c),s.setAttribute(o,c);break;case"onClick":c!=null&&(s.onclick=Dn);break;case"onScroll":c!=null&&xs("scroll",s);break;case"onScrollEnd":c!=null&&xs("scrollend",s);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(m.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"multiple":s.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":s.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){s.removeAttribute("xlink:href");break}o=Tr(""+c),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,""+c):s.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,""):s.removeAttribute(o);break;case"capture":case"download":c===!0?s.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,c):s.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?s.setAttribute(o,c):s.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?s.removeAttribute(o):s.setAttribute(o,c);break;case"popover":xs("beforetoggle",s),xs("toggle",s),lt(s,"popover",c);break;case"xlinkActuate":vt(s,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":vt(s,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":vt(s,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":vt(s,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":vt(s,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":vt(s,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":vt(s,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":vt(s,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":vt(s,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":lt(s,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Mi.get(o)||o,lt(s,o,c))}}function np(s,a,o,c,m,f){switch(o){case"style":kr(s,c,f);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(m.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"children":typeof c=="string"?zn(s,c):(typeof c=="number"||typeof c=="bigint")&&zn(s,""+c);break;case"onScroll":c!=null&&xs("scroll",s);break;case"onScrollEnd":c!=null&&xs("scrollend",s);break;case"onClick":c!=null&&(s.onclick=Dn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!we.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(m=o.endsWith("Capture"),a=o.slice(2,m?o.length-7:void 0),f=s[Ct]||null,f=f!=null?f[o]:null,typeof f=="function"&&s.removeEventListener(a,f,m),typeof c=="function")){typeof f!="function"&&f!==null&&(o in s?s[o]=null:s.hasAttribute(o)&&s.removeAttribute(o)),s.addEventListener(a,c,m);break e}o in s?s[o]=c:c===!0?s.setAttribute(o,""):lt(s,o,c)}}}function er(s,a,o){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":xs("error",s),xs("load",s);var c=!1,m=!1,f;for(f in o)if(o.hasOwnProperty(f)){var w=o[f];if(w!=null)switch(f){case"src":c=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Ks(s,a,f,w,o,null)}}m&&Ks(s,a,"srcSet",o.srcSet,o,null),c&&Ks(s,a,"src",o.src,o,null);return;case"input":xs("invalid",s);var N=f=w=m=null,q=null,ue=null;for(c in o)if(o.hasOwnProperty(c)){var Ne=o[c];if(Ne!=null)switch(c){case"name":m=Ne;break;case"type":w=Ne;break;case"checked":q=Ne;break;case"defaultChecked":ue=Ne;break;case"value":f=Ne;break;case"defaultValue":N=Ne;break;case"children":case"dangerouslySetInnerHTML":if(Ne!=null)throw Error(i(137,a));break;default:Ks(s,a,c,Ne,o,null)}}Aa(s,f,N,q,ue,w,m,!1);return;case"select":xs("invalid",s),c=w=f=null;for(m in o)if(o.hasOwnProperty(m)&&(N=o[m],N!=null))switch(m){case"value":f=N;break;case"defaultValue":w=N;break;case"multiple":c=N;default:Ks(s,a,m,N,o,null)}a=f,o=w,s.multiple=!!c,a!=null?Or(s,!!c,a,!1):o!=null&&Or(s,!!c,o,!0);return;case"textarea":xs("invalid",s),f=m=c=null;for(w in o)if(o.hasOwnProperty(w)&&(N=o[w],N!=null))switch(w){case"value":c=N;break;case"defaultValue":m=N;break;case"children":f=N;break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(i(91));break;default:Ks(s,a,w,N,o,null)}Br(s,c,m,f);return;case"option":for(q in o)o.hasOwnProperty(q)&&(c=o[q],c!=null)&&(q==="selected"?s.selected=c&&typeof c!="function"&&typeof c!="symbol":Ks(s,a,q,c,o,null));return;case"dialog":xs("beforetoggle",s),xs("toggle",s),xs("cancel",s),xs("close",s);break;case"iframe":case"object":xs("load",s);break;case"video":case"audio":for(c=0;c<$c.length;c++)xs($c[c],s);break;case"image":xs("error",s),xs("load",s);break;case"details":xs("toggle",s);break;case"embed":case"source":case"link":xs("error",s),xs("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ue in o)if(o.hasOwnProperty(ue)&&(c=o[ue],c!=null))switch(ue){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Ks(s,a,ue,c,o,null)}return;default:if(Ma(a)){for(Ne in o)o.hasOwnProperty(Ne)&&(c=o[Ne],c!==void 0&&np(s,a,Ne,c,o,void 0));return}}for(N in o)o.hasOwnProperty(N)&&(c=o[N],c!=null&&Ks(s,a,N,c,o,null))}function Xj(s,a,o,c){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,f=null,w=null,N=null,q=null,ue=null,Ne=null;for(_e in o){var ze=o[_e];if(o.hasOwnProperty(_e)&&ze!=null)switch(_e){case"checked":break;case"value":break;case"defaultValue":q=ze;default:c.hasOwnProperty(_e)||Ks(s,a,_e,null,c,ze)}}for(var me in c){var _e=c[me];if(ze=o[me],c.hasOwnProperty(me)&&(_e!=null||ze!=null))switch(me){case"type":f=_e;break;case"name":m=_e;break;case"checked":ue=_e;break;case"defaultChecked":Ne=_e;break;case"value":w=_e;break;case"defaultValue":N=_e;break;case"children":case"dangerouslySetInnerHTML":if(_e!=null)throw Error(i(137,a));break;default:_e!==ze&&Ks(s,a,me,_e,c,ze)}}Ra(s,w,N,q,ue,Ne,f,m);return;case"select":_e=w=N=me=null;for(f in o)if(q=o[f],o.hasOwnProperty(f)&&q!=null)switch(f){case"value":break;case"multiple":_e=q;default:c.hasOwnProperty(f)||Ks(s,a,f,null,c,q)}for(m in c)if(f=c[m],q=o[m],c.hasOwnProperty(m)&&(f!=null||q!=null))switch(m){case"value":me=f;break;case"defaultValue":N=f;break;case"multiple":w=f;default:f!==q&&Ks(s,a,m,f,c,q)}a=N,o=w,c=_e,me!=null?Or(s,!!o,me,!1):!!c!=!!o&&(a!=null?Or(s,!!o,a,!0):Or(s,!!o,o?[]:"",!1));return;case"textarea":_e=me=null;for(N in o)if(m=o[N],o.hasOwnProperty(N)&&m!=null&&!c.hasOwnProperty(N))switch(N){case"value":break;case"children":break;default:Ks(s,a,N,null,c,m)}for(w in c)if(m=c[w],f=o[w],c.hasOwnProperty(w)&&(m!=null||f!=null))switch(w){case"value":me=m;break;case"defaultValue":_e=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(i(91));break;default:m!==f&&Ks(s,a,w,m,c,f)}Ja(s,me,_e);return;case"option":for(var Nt in o)me=o[Nt],o.hasOwnProperty(Nt)&&me!=null&&!c.hasOwnProperty(Nt)&&(Nt==="selected"?s.selected=!1:Ks(s,a,Nt,null,c,me));for(q in c)me=c[q],_e=o[q],c.hasOwnProperty(q)&&me!==_e&&(me!=null||_e!=null)&&(q==="selected"?s.selected=me&&typeof me!="function"&&typeof me!="symbol":Ks(s,a,q,me,c,_e));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Wt in o)me=o[Wt],o.hasOwnProperty(Wt)&&me!=null&&!c.hasOwnProperty(Wt)&&Ks(s,a,Wt,null,c,me);for(ue in c)if(me=c[ue],_e=o[ue],c.hasOwnProperty(ue)&&me!==_e&&(me!=null||_e!=null))switch(ue){case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(i(137,a));break;default:Ks(s,a,ue,me,c,_e)}return;default:if(Ma(a)){for(var Ys in o)me=o[Ys],o.hasOwnProperty(Ys)&&me!==void 0&&!c.hasOwnProperty(Ys)&&np(s,a,Ys,void 0,c,me);for(Ne in c)me=c[Ne],_e=o[Ne],!c.hasOwnProperty(Ne)||me===_e||me===void 0&&_e===void 0||np(s,a,Ne,me,c,_e);return}}for(var ee in o)me=o[ee],o.hasOwnProperty(ee)&&me!=null&&!c.hasOwnProperty(ee)&&Ks(s,a,ee,null,c,me);for(ze in c)me=c[ze],_e=o[ze],!c.hasOwnProperty(ze)||me===_e||me==null&&_e==null||Ks(s,a,ze,me,c,_e)}function W0(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Jj(){if(typeof performance.getEntriesByType=="function"){for(var s=0,a=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var m=o[c],f=m.transferSize,w=m.initiatorType,N=m.duration;if(f&&N&&W0(w)){for(w=0,N=m.responseEnd,c+=1;c<o.length;c++){var q=o[c],ue=q.startTime;if(ue>N)break;var Ne=q.transferSize,ze=q.initiatorType;Ne&&W0(ze)&&(q=q.responseEnd,w+=Ne*(q<N?1:(N-ue)/(q-ue)))}if(--c,a+=8*(f+w)/(m.duration/1e3),s++,10<s)break}}if(0<s)return a/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var rp=null,ap=null;function Hd(s){return s.nodeType===9?s:s.ownerDocument}function G0(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function K0(s,a){if(s===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&a==="foreignObject"?0:s}function ip(s,a){return s==="textarea"||s==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var op=null;function Zj(){var s=window.event;return s&&s.type==="popstate"?s===op?!1:(op=s,!0):(op=null,!1)}var Y0=typeof setTimeout=="function"?setTimeout:void 0,eT=typeof clearTimeout=="function"?clearTimeout:void 0,Q0=typeof Promise=="function"?Promise:void 0,tT=typeof queueMicrotask=="function"?queueMicrotask:typeof Q0<"u"?function(s){return Q0.resolve(null).then(s).catch(sT)}:Y0;function sT(s){setTimeout(function(){throw s})}function Yi(s){return s==="head"}function X0(s,a){var o=a,c=0;do{var m=o.nextSibling;if(s.removeChild(o),m&&m.nodeType===8)if(o=m.data,o==="/$"||o==="/&"){if(c===0){s.removeChild(m),Vl(a);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")Gc(s.ownerDocument.documentElement);else if(o==="head"){o=s.ownerDocument.head,Gc(o);for(var f=o.firstChild;f;){var w=f.nextSibling,N=f.nodeName;f[rn]||N==="SCRIPT"||N==="STYLE"||N==="LINK"&&f.rel.toLowerCase()==="stylesheet"||o.removeChild(f),f=w}}else o==="body"&&Gc(s.ownerDocument.body);o=m}while(o);Vl(a)}function J0(s,a){var o=s;s=0;do{var c=o.nextSibling;if(o.nodeType===1?a?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(a?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(s===0)break;s--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||s++;o=c}while(o)}function lp(s){var a=s.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var o=a;switch(a=a.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":lp(o),Tn(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}s.removeChild(o)}}function nT(s,a,o,c){for(;s.nodeType===1;){var m=o;if(s.nodeName.toLowerCase()!==a.toLowerCase()){if(!c&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(c){if(!s[rn])switch(a){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(f=s.getAttribute("rel"),f==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(f!==m.rel||s.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||s.getAttribute("title")!==(m.title==null?null:m.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(f=s.getAttribute("src"),(f!==(m.src==null?null:m.src)||s.getAttribute("type")!==(m.type==null?null:m.type)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&f&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(a==="input"&&s.type==="hidden"){var f=m.name==null?null:""+m.name;if(m.type==="hidden"&&s.getAttribute("name")===f)return s}else return s;if(s=aa(s.nextSibling),s===null)break}return null}function rT(s,a,o){if(a==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!o||(s=aa(s.nextSibling),s===null))return null;return s}function Z0(s,a){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!a||(s=aa(s.nextSibling),s===null))return null;return s}function cp(s){return s.data==="$?"||s.data==="$~"}function up(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function aT(s,a){var o=s.ownerDocument;if(s.data==="$~")s._reactRetry=a;else if(s.data!=="$?"||o.readyState!=="loading")a();else{var c=function(){a(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),s._reactRetry=c}}function aa(s){for(;s!=null;s=s.nextSibling){var a=s.nodeType;if(a===1||a===3)break;if(a===8){if(a=s.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return s}var dp=null;function e1(s){s=s.nextSibling;for(var a=0;s;){if(s.nodeType===8){var o=s.data;if(o==="/$"||o==="/&"){if(a===0)return aa(s.nextSibling);a--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||a++}s=s.nextSibling}return null}function t1(s){s=s.previousSibling;for(var a=0;s;){if(s.nodeType===8){var o=s.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(a===0)return s;a--}else o!=="/$"&&o!=="/&"||a++}s=s.previousSibling}return null}function s1(s,a,o){switch(a=Hd(o),s){case"html":if(s=a.documentElement,!s)throw Error(i(452));return s;case"head":if(s=a.head,!s)throw Error(i(453));return s;case"body":if(s=a.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function Gc(s){for(var a=s.attributes;a.length;)s.removeAttributeNode(a[0]);Tn(s)}var ia=new Map,n1=new Set;function $d(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var pi=fe.d;fe.d={f:iT,r:oT,D:lT,C:cT,L:uT,m:dT,X:mT,S:hT,M:fT};function iT(){var s=pi.f(),a=Ld();return s||a}function oT(s){var a=sn(s);a!==null&&a.tag===5&&a.type==="form"?xv(a):pi.r(s)}var Ll=typeof document>"u"?null:document;function r1(s,a,o){var c=Ll;if(c&&typeof a=="string"&&a){var m=Sn(a);m='link[rel="'+s+'"][href="'+m+'"]',typeof o=="string"&&(m+='[crossorigin="'+o+'"]'),n1.has(m)||(n1.add(m),s={rel:s,crossOrigin:o,href:a},c.querySelector(m)===null&&(a=c.createElement("link"),er(a,"link",s),de(a),c.head.appendChild(a)))}}function lT(s){pi.D(s),r1("dns-prefetch",s,null)}function cT(s,a){pi.C(s,a),r1("preconnect",s,a)}function uT(s,a,o){pi.L(s,a,o);var c=Ll;if(c&&s&&a){var m='link[rel="preload"][as="'+Sn(a)+'"]';a==="image"&&o&&o.imageSrcSet?(m+='[imagesrcset="'+Sn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(m+='[imagesizes="'+Sn(o.imageSizes)+'"]')):m+='[href="'+Sn(s)+'"]';var f=m;switch(a){case"style":f=Ol(s);break;case"script":f=Bl(s)}ia.has(f)||(s=_({rel:"preload",href:a==="image"&&o&&o.imageSrcSet?void 0:s,as:a},o),ia.set(f,s),c.querySelector(m)!==null||a==="style"&&c.querySelector(Kc(f))||a==="script"&&c.querySelector(Yc(f))||(a=c.createElement("link"),er(a,"link",s),de(a),c.head.appendChild(a)))}}function dT(s,a){pi.m(s,a);var o=Ll;if(o&&s){var c=a&&typeof a.as=="string"?a.as:"script",m='link[rel="modulepreload"][as="'+Sn(c)+'"][href="'+Sn(s)+'"]',f=m;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":f=Bl(s)}if(!ia.has(f)&&(s=_({rel:"modulepreload",href:s},a),ia.set(f,s),o.querySelector(m)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Yc(f)))return}c=o.createElement("link"),er(c,"link",s),de(c),o.head.appendChild(c)}}}function hT(s,a,o){pi.S(s,a,o);var c=Ll;if(c&&s){var m=W(c).hoistableStyles,f=Ol(s);a=a||"default";var w=m.get(f);if(!w){var N={loading:0,preload:null};if(w=c.querySelector(Kc(f)))N.loading=5;else{s=_({rel:"stylesheet",href:s,"data-precedence":a},o),(o=ia.get(f))&&hp(s,o);var q=w=c.createElement("link");de(q),er(q,"link",s),q._p=new Promise(function(ue,Ne){q.onload=ue,q.onerror=Ne}),q.addEventListener("load",function(){N.loading|=1}),q.addEventListener("error",function(){N.loading|=2}),N.loading|=4,Wd(w,a,c)}w={type:"stylesheet",instance:w,count:1,state:N},m.set(f,w)}}}function mT(s,a){pi.X(s,a);var o=Ll;if(o&&s){var c=W(o).hoistableScripts,m=Bl(s),f=c.get(m);f||(f=o.querySelector(Yc(m)),f||(s=_({src:s,async:!0},a),(a=ia.get(m))&&mp(s,a),f=o.createElement("script"),de(f),er(f,"link",s),o.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},c.set(m,f))}}function fT(s,a){pi.M(s,a);var o=Ll;if(o&&s){var c=W(o).hoistableScripts,m=Bl(s),f=c.get(m);f||(f=o.querySelector(Yc(m)),f||(s=_({src:s,async:!0,type:"module"},a),(a=ia.get(m))&&mp(s,a),f=o.createElement("script"),de(f),er(f,"link",s),o.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},c.set(m,f))}}function a1(s,a,o,c){var m=(m=Ie.current)?$d(m):null;if(!m)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(a=Ol(o.href),o=W(m).hoistableStyles,c=o.get(a),c||(c={type:"style",instance:null,count:0,state:null},o.set(a,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){s=Ol(o.href);var f=W(m).hoistableStyles,w=f.get(s);if(w||(m=m.ownerDocument||m,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},f.set(s,w),(f=m.querySelector(Kc(s)))&&!f._p&&(w.instance=f,w.state.loading=5),ia.has(s)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},ia.set(s,o),f||pT(m,s,o,w.state))),a&&c===null)throw Error(i(528,""));return w}if(a&&c!==null)throw Error(i(529,""));return null;case"script":return a=o.async,o=o.src,typeof o=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Bl(o),o=W(m).hoistableScripts,c=o.get(a),c||(c={type:"script",instance:null,count:0,state:null},o.set(a,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function Ol(s){return'href="'+Sn(s)+'"'}function Kc(s){return'link[rel="stylesheet"]['+s+"]"}function i1(s){return _({},s,{"data-precedence":s.precedence,precedence:null})}function pT(s,a,o,c){s.querySelector('link[rel="preload"][as="style"]['+a+"]")?c.loading=1:(a=s.createElement("link"),c.preload=a,a.addEventListener("load",function(){return c.loading|=1}),a.addEventListener("error",function(){return c.loading|=2}),er(a,"link",o),de(a),s.head.appendChild(a))}function Bl(s){return'[src="'+Sn(s)+'"]'}function Yc(s){return"script[async]"+s}function o1(s,a,o){if(a.count++,a.instance===null)switch(a.type){case"style":var c=s.querySelector('style[data-href~="'+Sn(o.href)+'"]');if(c)return a.instance=c,de(c),c;var m=_({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(s.ownerDocument||s).createElement("style"),de(c),er(c,"style",m),Wd(c,o.precedence,s),a.instance=c;case"stylesheet":m=Ol(o.href);var f=s.querySelector(Kc(m));if(f)return a.state.loading|=4,a.instance=f,de(f),f;c=i1(o),(m=ia.get(m))&&hp(c,m),f=(s.ownerDocument||s).createElement("link"),de(f);var w=f;return w._p=new Promise(function(N,q){w.onload=N,w.onerror=q}),er(f,"link",c),a.state.loading|=4,Wd(f,o.precedence,s),a.instance=f;case"script":return f=Bl(o.src),(m=s.querySelector(Yc(f)))?(a.instance=m,de(m),m):(c=o,(m=ia.get(f))&&(c=_({},o),mp(c,m)),s=s.ownerDocument||s,m=s.createElement("script"),de(m),er(m,"link",c),s.head.appendChild(m),a.instance=m);case"void":return null;default:throw Error(i(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(c=a.instance,a.state.loading|=4,Wd(c,o.precedence,s));return a.instance}function Wd(s,a,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=c.length?c[c.length-1]:null,f=m,w=0;w<c.length;w++){var N=c[w];if(N.dataset.precedence===a)f=N;else if(f!==m)break}f?f.parentNode.insertBefore(s,f.nextSibling):(a=o.nodeType===9?o.head:o,a.insertBefore(s,a.firstChild))}function hp(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.title==null&&(s.title=a.title)}function mp(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.integrity==null&&(s.integrity=a.integrity)}var Gd=null;function l1(s,a,o){if(Gd===null){var c=new Map,m=Gd=new Map;m.set(o,c)}else m=Gd,c=m.get(o),c||(c=new Map,m.set(o,c));if(c.has(s))return c;for(c.set(s,null),o=o.getElementsByTagName(s),m=0;m<o.length;m++){var f=o[m];if(!(f[rn]||f[bt]||s==="link"&&f.getAttribute("rel")==="stylesheet")&&f.namespaceURI!=="http://www.w3.org/2000/svg"){var w=f.getAttribute(a)||"";w=s+w;var N=c.get(w);N?N.push(f):c.set(w,[f])}}return c}function c1(s,a,o){s=s.ownerDocument||s,s.head.insertBefore(o,a==="title"?s.querySelector("head > title"):null)}function gT(s,a,o){if(o===1||a.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;return a.rel==="stylesheet"?(s=a.disabled,typeof a.precedence=="string"&&s==null):!0;case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function u1(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function yT(s,a,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var m=Ol(c.href),f=a.querySelector(Kc(m));if(f){a=f._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(s.count++,s=Kd.bind(s),a.then(s,s)),o.state.loading|=4,o.instance=f,de(f);return}f=a.ownerDocument||a,c=i1(c),(m=ia.get(m))&&hp(c,m),f=f.createElement("link"),de(f);var w=f;w._p=new Promise(function(N,q){w.onload=N,w.onerror=q}),er(f,"link",c),o.instance=f}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(o,a),(a=o.state.preload)&&(o.state.loading&3)===0&&(s.count++,o=Kd.bind(s),a.addEventListener("load",o),a.addEventListener("error",o))}}var fp=0;function bT(s,a){return s.stylesheets&&s.count===0&&Qd(s,s.stylesheets),0<s.count||0<s.imgCount?function(o){var c=setTimeout(function(){if(s.stylesheets&&Qd(s,s.stylesheets),s.unsuspend){var f=s.unsuspend;s.unsuspend=null,f()}},6e4+a);0<s.imgBytes&&fp===0&&(fp=62500*Jj());var m=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&Qd(s,s.stylesheets),s.unsuspend)){var f=s.unsuspend;s.unsuspend=null,f()}},(s.imgBytes>fp?50:800)+a);return s.unsuspend=o,function(){s.unsuspend=null,clearTimeout(c),clearTimeout(m)}}:null}function Kd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Qd(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Yd=null;function Qd(s,a){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Yd=new Map,a.forEach(vT,s),Yd=null,Kd.call(s))}function vT(s,a){if(!(a.state.loading&4)){var o=Yd.get(s);if(o)var c=o.get(null);else{o=new Map,Yd.set(s,o);for(var m=s.querySelectorAll("link[data-precedence],style[data-precedence]"),f=0;f<m.length;f++){var w=m[f];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(o.set(w.dataset.precedence,w),c=w)}c&&o.set(null,c)}m=a.instance,w=m.getAttribute("data-precedence"),f=o.get(w)||c,f===c&&o.set(null,m),o.set(w,m),this.count++,c=Kd.bind(this),m.addEventListener("load",c),m.addEventListener("error",c),f?f.parentNode.insertBefore(m,f.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(m,s.firstChild)),a.state.loading|=4}}var Qc={$$typeof:Z,Provider:null,Consumer:null,_currentValue:Ve,_currentValue2:Ve,_threadCount:0};function xT(s,a,o,c,m,f,w,N,q){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ae(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ae(0),this.hiddenUpdates=Ae(null),this.identifierPrefix=c,this.onUncaughtError=m,this.onCaughtError=f,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=q,this.incompleteTransitions=new Map}function d1(s,a,o,c,m,f,w,N,q,ue,Ne,ze){return s=new xT(s,a,o,w,q,ue,Ne,ze,N),a=1,f===!0&&(a|=24),f=Ur(3,null,null,a),s.current=f,f.stateNode=s,a=Wm(),a.refCount++,s.pooledCache=a,a.refCount++,f.memoizedState={element:c,isDehydrated:o,cache:a},Qm(f),s}function h1(s){return s?(s=pl,s):pl}function m1(s,a,o,c,m,f){m=h1(m),c.context===null?c.context=m:c.pendingContext=m,c=Bi(a),c.payload={element:o},f=f===void 0?null:f,f!==null&&(c.callback=f),o=Vi(s,c,a),o!==null&&(Ir(o,s,a),Nc(o,s,a))}function f1(s,a){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var o=s.retryLane;s.retryLane=o!==0&&o<a?o:a}}function pp(s,a){f1(s,a),(s=s.alternate)&&f1(s,a)}function p1(s){if(s.tag===13||s.tag===31){var a=Ro(s,67108864);a!==null&&Ir(a,s,67108864),pp(s,67108864)}}function g1(s){if(s.tag===13||s.tag===31){var a=$r();a=U(a);var o=Ro(s,a);o!==null&&Ir(o,s,a),pp(s,a)}}var Xd=!0;function wT(s,a,o,c){var m=H.T;H.T=null;var f=fe.p;try{fe.p=2,gp(s,a,o,c)}finally{fe.p=f,H.T=m}}function _T(s,a,o,c){var m=H.T;H.T=null;var f=fe.p;try{fe.p=8,gp(s,a,o,c)}finally{fe.p=f,H.T=m}}function gp(s,a,o,c){if(Xd){var m=yp(c);if(m===null)sp(s,a,c,Jd,o),b1(s,c);else if(jT(m,s,a,o,c))c.stopPropagation();else if(b1(s,c),a&4&&-1<kT.indexOf(s)){for(;m!==null;){var f=sn(m);if(f!==null)switch(f.tag){case 3:if(f=f.stateNode,f.current.memoizedState.isDehydrated){var w=Ke(f.pendingLanes);if(w!==0){var N=f;for(N.pendingLanes|=2,N.entangledLanes|=2;w;){var q=1<<31-Pe(w);N.entanglements[1]|=q,w&=~q}Ba(f),(zs&6)===0&&(Dd=Kt()+500,Hc(0))}}break;case 31:case 13:N=Ro(f,2),N!==null&&Ir(N,f,2),Ld(),pp(f,2)}if(f=yp(c),f===null&&sp(s,a,c,Jd,o),f===m)break;m=f}m!==null&&c.stopPropagation()}else sp(s,a,c,null,o)}}function yp(s){return s=Pn(s),bp(s)}var Jd=null;function bp(s){if(Jd=null,s=As(s),s!==null){var a=u(s);if(a===null)s=null;else{var o=a.tag;if(o===13){if(s=d(a),s!==null)return s;s=null}else if(o===31){if(s=p(a),s!==null)return s;s=null}else if(o===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;s=null}else a!==s&&(s=null)}}return Jd=s,null}function y1(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(It()){case hs:return 2;case ws:return 8;case is:case Xs:return 32;case Ps:return 268435456;default:return 32}default:return 32}}var vp=!1,Qi=null,Xi=null,Ji=null,Xc=new Map,Jc=new Map,Zi=[],kT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function b1(s,a){switch(s){case"focusin":case"focusout":Qi=null;break;case"dragenter":case"dragleave":Xi=null;break;case"mouseover":case"mouseout":Ji=null;break;case"pointerover":case"pointerout":Xc.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Jc.delete(a.pointerId)}}function Zc(s,a,o,c,m,f){return s===null||s.nativeEvent!==f?(s={blockedOn:a,domEventName:o,eventSystemFlags:c,nativeEvent:f,targetContainers:[m]},a!==null&&(a=sn(a),a!==null&&p1(a)),s):(s.eventSystemFlags|=c,a=s.targetContainers,m!==null&&a.indexOf(m)===-1&&a.push(m),s)}function jT(s,a,o,c,m){switch(a){case"focusin":return Qi=Zc(Qi,s,a,o,c,m),!0;case"dragenter":return Xi=Zc(Xi,s,a,o,c,m),!0;case"mouseover":return Ji=Zc(Ji,s,a,o,c,m),!0;case"pointerover":var f=m.pointerId;return Xc.set(f,Zc(Xc.get(f)||null,s,a,o,c,m)),!0;case"gotpointercapture":return f=m.pointerId,Jc.set(f,Zc(Jc.get(f)||null,s,a,o,c,m)),!0}return!1}function v1(s){var a=As(s.target);if(a!==null){var o=u(a);if(o!==null){if(a=o.tag,a===13){if(a=d(o),a!==null){s.blockedOn=a,Te(s.priority,function(){g1(o)});return}}else if(a===31){if(a=p(o),a!==null){s.blockedOn=a,Te(s.priority,function(){g1(o)});return}}else if(a===3&&o.stateNode.current.memoizedState.isDehydrated){s.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Zd(s){if(s.blockedOn!==null)return!1;for(var a=s.targetContainers;0<a.length;){var o=yp(s.nativeEvent);if(o===null){o=s.nativeEvent;var c=new o.constructor(o.type,o);qn=c,o.target.dispatchEvent(c),qn=null}else return a=sn(o),a!==null&&p1(a),s.blockedOn=o,!1;a.shift()}return!0}function x1(s,a,o){Zd(s)&&o.delete(a)}function TT(){vp=!1,Qi!==null&&Zd(Qi)&&(Qi=null),Xi!==null&&Zd(Xi)&&(Xi=null),Ji!==null&&Zd(Ji)&&(Ji=null),Xc.forEach(x1),Jc.forEach(x1)}function eh(s,a){s.blockedOn===a&&(s.blockedOn=null,vp||(vp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,TT)))}var th=null;function w1(s){th!==s&&(th=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){th===s&&(th=null);for(var a=0;a<s.length;a+=3){var o=s[a],c=s[a+1],m=s[a+2];if(typeof c!="function"){if(bp(c||o)===null)continue;break}var f=sn(o);f!==null&&(s.splice(a,3),a-=3,yf(f,{pending:!0,data:m,method:o.method,action:c},c,m))}}))}function Vl(s){function a(q){return eh(q,s)}Qi!==null&&eh(Qi,s),Xi!==null&&eh(Xi,s),Ji!==null&&eh(Ji,s),Xc.forEach(a),Jc.forEach(a);for(var o=0;o<Zi.length;o++){var c=Zi[o];c.blockedOn===s&&(c.blockedOn=null)}for(;0<Zi.length&&(o=Zi[0],o.blockedOn===null);)v1(o),o.blockedOn===null&&Zi.shift();if(o=(s.ownerDocument||s).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var m=o[c],f=o[c+1],w=m[Ct]||null;if(typeof f=="function")w||w1(o);else if(w){var N=null;if(f&&f.hasAttribute("formAction")){if(m=f,w=f[Ct]||null)N=w.formAction;else if(bp(m)!==null)continue}else N=w.action;typeof N=="function"?o[c+1]=N:(o.splice(c,3),c-=3),w1(o)}}}function _1(){function s(f){f.canIntercept&&f.info==="react-transition"&&f.intercept({handler:function(){return new Promise(function(w){return m=w})},focusReset:"manual",scroll:"manual"})}function a(){m!==null&&(m(),m=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var f=navigation.currentEntry;f&&f.url!=null&&navigation.navigate(f.url,{state:f.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,m=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),m!==null&&(m(),m=null)}}}function xp(s){this._internalRoot=s}sh.prototype.render=xp.prototype.render=function(s){var a=this._internalRoot;if(a===null)throw Error(i(409));var o=a.current,c=$r();m1(o,c,s,a,null,null)},sh.prototype.unmount=xp.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var a=s.containerInfo;m1(s.current,2,null,s,null,null),Ld(),a[ft]=null}};function sh(s){this._internalRoot=s}sh.prototype.unstable_scheduleHydration=function(s){if(s){var a=Ee();s={blockedOn:null,target:s,priority:a};for(var o=0;o<Zi.length&&a!==0&&a<Zi[o].priority;o++);Zi.splice(o,0,s),o===0&&v1(s)}};var k1=e.version;if(k1!=="19.2.4")throw Error(i(527,k1,"19.2.4"));fe.findDOMNode=function(s){var a=s._reactInternals;if(a===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=y(a),s=s!==null?x(s):null,s=s===null?null:s.stateNode,s};var ST={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:H,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var nh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nh.isDisabled&&nh.supportsFiber)try{_s=nh.inject(ST),ve=nh}catch{}}return tu.createRoot=function(s,a){if(!l(s))throw Error(i(299));var o=!1,c="",m=Rv,f=Av,w=Mv;return a!=null&&(a.unstable_strictMode===!0&&(o=!0),a.identifierPrefix!==void 0&&(c=a.identifierPrefix),a.onUncaughtError!==void 0&&(m=a.onUncaughtError),a.onCaughtError!==void 0&&(f=a.onCaughtError),a.onRecoverableError!==void 0&&(w=a.onRecoverableError)),a=d1(s,1,!1,null,null,o,c,null,m,f,w,_1),s[ft]=a.current,tp(s),new xp(a)},tu.hydrateRoot=function(s,a,o){if(!l(s))throw Error(i(299));var c=!1,m="",f=Rv,w=Av,N=Mv,q=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(m=o.identifierPrefix),o.onUncaughtError!==void 0&&(f=o.onUncaughtError),o.onCaughtError!==void 0&&(w=o.onCaughtError),o.onRecoverableError!==void 0&&(N=o.onRecoverableError),o.formState!==void 0&&(q=o.formState)),a=d1(s,1,!0,a,o??null,c,m,q,f,w,N,_1),a.context=h1(null),o=a.current,c=$r(),c=U(c),m=Bi(c),m.callback=null,Vi(o,m,c),o=c,a.current.lanes=o,Je(a,o),Ba(a),s[ft]=a.current,tp(s),new sh(a)},tu.version="19.2.4",tu}var I1;function LT(){if(I1)return kp.exports;I1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),kp.exports=PT(),kp.exports}var OT=LT();const BT="modulepreload",VT=function(n){return"/login/"+n},D1={},wr=function(e,t,i){let l=Promise.resolve();if(t&&t.length>0){let g=function(y){return Promise.all(y.map(x=>Promise.resolve(x).then(_=>({status:"fulfilled",value:_}),_=>({status:"rejected",reason:_}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),p=d?.nonce||d?.getAttribute("nonce");l=g(t.map(y=>{if(y=VT(y),y in D1)return;D1[y]=!0;const x=y.endsWith(".css"),_=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${_}`))return;const j=document.createElement("link");if(j.rel=x?"stylesheet":BT,x||(j.as="script"),j.crossOrigin="",j.href=y,p&&j.setAttribute("nonce",p),document.head.appendChild(j),x)return new Promise((O,K)=>{j.addEventListener("load",O),j.addEventListener("error",()=>K(new Error(`Unable to preload CSS for ${y}`)))})}))}function u(d){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=d,window.dispatchEvent(p),!p.defaultPrevented)throw d}return l.then(d=>{for(const p of d||[])p.status==="rejected"&&u(p.reason);return e().catch(u)})};var P1="popstate";function UT(n={}){function e(i,l){let{pathname:u,search:d,hash:p}=i.location;return ig("",{pathname:u,search:d,hash:p},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function t(i,l){return typeof l=="string"?l:_u(l)}return zT(e,t,null,n)}function dn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function ua(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function FT(){return Math.random().toString(36).substring(2,10)}function L1(n,e){return{usr:n.state,key:n.key,idx:e}}function ig(n,e,t=null,i){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?lc(e):e,state:t,key:e&&e.key||i||FT()}}function _u({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function lc(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substring(i),n=n.substring(0,i)),n&&(e.pathname=n)}return e}function zT(n,e,t,i={}){let{window:l=document.defaultView,v5Compat:u=!1}=i,d=l.history,p="POP",g=null,y=x();y==null&&(y=0,d.replaceState({...d.state,idx:y},""));function x(){return(d.state||{idx:null}).idx}function _(){p="POP";let D=x(),se=D==null?null:D-y;y=D,g&&g({action:p,location:B.location,delta:se})}function j(D,se){p="PUSH";let Y=ig(B.location,D,se);y=x()+1;let Z=L1(Y,y),je=B.createHref(Y);try{d.pushState(Z,"",je)}catch(Re){if(Re instanceof DOMException&&Re.name==="DataCloneError")throw Re;l.location.assign(je)}u&&g&&g({action:p,location:B.location,delta:1})}function O(D,se){p="REPLACE";let Y=ig(B.location,D,se);y=x();let Z=L1(Y,y),je=B.createHref(Y);d.replaceState(Z,"",je),u&&g&&g({action:p,location:B.location,delta:0})}function K(D){return qT(D)}let B={get action(){return p},get location(){return n(l,d)},listen(D){if(g)throw new Error("A history only accepts one active listener");return l.addEventListener(P1,_),g=D,()=>{l.removeEventListener(P1,_),g=null}},createHref(D){return e(l,D)},createURL:K,encodeLocation(D){let se=K(D);return{pathname:se.pathname,search:se.search,hash:se.hash}},push:j,replace:O,go(D){return d.go(D)}};return B}function qT(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),dn(t,"No window.location.(origin|href) available to create URL");let i=typeof n=="string"?n:_u(n);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function U2(n,e,t="/"){return HT(n,e,t,!1)}function HT(n,e,t,i){let l=typeof e=="string"?lc(e):e,u=ki(l.pathname||"/",t);if(u==null)return null;let d=F2(n);$T(d);let p=null;for(let g=0;p==null&&g<d.length;++g){let y=sS(u);p=eS(d[g],y,i)}return p}function F2(n,e=[],t=[],i="",l=!1){let u=(d,p,g=l,y)=>{let x={relativePath:y===void 0?d.path||"":y,caseSensitive:d.caseSensitive===!0,childrenIndex:p,route:d};if(x.relativePath.startsWith("/")){if(!x.relativePath.startsWith(i)&&g)return;dn(x.relativePath.startsWith(i),`Absolute route path "${x.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),x.relativePath=x.relativePath.slice(i.length)}let _=xi([i,x.relativePath]),j=t.concat(x);d.children&&d.children.length>0&&(dn(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${_}".`),F2(d.children,e,j,_,g)),!(d.path==null&&!d.index)&&e.push({path:_,score:JT(_,d.index),routesMeta:j})};return n.forEach((d,p)=>{if(d.path===""||!d.path?.includes("?"))u(d,p);else for(let g of z2(d.path))u(d,p,!0,g)}),e}function z2(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,l=t.endsWith("?"),u=t.replace(/\?$/,"");if(i.length===0)return l?[u,""]:[u];let d=z2(i.join("/")),p=[];return p.push(...d.map(g=>g===""?u:[u,g].join("/"))),l&&p.push(...d),p.map(g=>n.startsWith("/")&&g===""?"/":g)}function $T(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:ZT(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var WT=/^:[\w-]+$/,GT=3,KT=2,YT=1,QT=10,XT=-2,O1=n=>n==="*";function JT(n,e){let t=n.split("/"),i=t.length;return t.some(O1)&&(i+=XT),e&&(i+=KT),t.filter(l=>!O1(l)).reduce((l,u)=>l+(WT.test(u)?GT:u===""?YT:QT),i)}function ZT(n,e){return n.length===e.length&&n.slice(0,-1).every((i,l)=>i===e[l])?n[n.length-1]-e[e.length-1]:0}function eS(n,e,t=!1){let{routesMeta:i}=n,l={},u="/",d=[];for(let p=0;p<i.length;++p){let g=i[p],y=p===i.length-1,x=u==="/"?e:e.slice(u.length)||"/",_=Mh({path:g.relativePath,caseSensitive:g.caseSensitive,end:y},x),j=g.route;if(!_&&y&&t&&!i[i.length-1].route.index&&(_=Mh({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},x)),!_)return null;Object.assign(l,_.params),d.push({params:l,pathname:xi([u,_.pathname]),pathnameBase:iS(xi([u,_.pathnameBase])),route:j}),_.pathnameBase!=="/"&&(u=xi([u,_.pathnameBase]))}return d}function Mh(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=tS(n.path,n.caseSensitive,n.end),l=e.match(t);if(!l)return null;let u=l[0],d=u.replace(/(.)\/+$/,"$1"),p=l.slice(1);return{params:i.reduce((y,{paramName:x,isOptional:_},j)=>{if(x==="*"){let K=p[j]||"";d=u.slice(0,u.length-K.length).replace(/(.)\/+$/,"$1")}const O=p[j];return _&&!O?y[x]=void 0:y[x]=(O||"").replace(/%2F/g,"/"),y},{}),pathname:u,pathnameBase:d,pattern:n}}function tS(n,e=!1,t=!0){ua(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let i=[],l="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,p,g)=>(i.push({paramName:p,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(i.push({paramName:"*"}),l+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?l+="\\/*$":n!==""&&n!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,e?void 0:"i"),i]}function sS(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ua(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function ki(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}var nS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function rS(n,e="/"){let{pathname:t,search:i="",hash:l=""}=typeof n=="string"?lc(n):n,u;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?u=B1(t.substring(1),"/"):u=B1(t,e)):u=e,{pathname:u,search:oS(i),hash:lS(l)}}function B1(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(l=>{l===".."?t.length>1&&t.pop():l!=="."&&t.push(l)}),t.length>1?t.join("/"):"/"}function Ep(n,e,t,i){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function aS(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Vg(n){let e=aS(n);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function Ug(n,e,t,i=!1){let l;typeof n=="string"?l=lc(n):(l={...n},dn(!l.pathname||!l.pathname.includes("?"),Ep("?","pathname","search",l)),dn(!l.pathname||!l.pathname.includes("#"),Ep("#","pathname","hash",l)),dn(!l.search||!l.search.includes("#"),Ep("#","search","hash",l)));let u=n===""||l.pathname==="",d=u?"/":l.pathname,p;if(d==null)p=t;else{let _=e.length-1;if(!i&&d.startsWith("..")){let j=d.split("/");for(;j[0]==="..";)j.shift(),_-=1;l.pathname=j.join("/")}p=_>=0?e[_]:"/"}let g=rS(l,p),y=d&&d!=="/"&&d.endsWith("/"),x=(u||d===".")&&t.endsWith("/");return!g.pathname.endsWith("/")&&(y||x)&&(g.pathname+="/"),g}var xi=n=>n.join("/").replace(/\/\/+/g,"/"),iS=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),oS=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,lS=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,cS=class{constructor(n,e,t,i=!1){this.status=n,this.statusText=e||"",this.internal=i,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function uS(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function dS(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var q2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function H2(n,e){let t=n;if(typeof t!="string"||!nS.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let i=t,l=!1;if(q2)try{let u=new URL(window.location.href),d=t.startsWith("//")?new URL(u.protocol+t):new URL(t),p=ki(d.pathname,e);d.origin===u.origin&&p!=null?t=p+d.search+d.hash:l=!0}catch{ua(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:l,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var $2=["POST","PUT","PATCH","DELETE"];new Set($2);var hS=["GET",...$2];new Set(hS);var cc=b.createContext(null);cc.displayName="DataRouter";var em=b.createContext(null);em.displayName="DataRouterState";var mS=b.createContext(!1),W2=b.createContext({isTransitioning:!1});W2.displayName="ViewTransition";var fS=b.createContext(new Map);fS.displayName="Fetchers";var pS=b.createContext(null);pS.displayName="Await";var Yr=b.createContext(null);Yr.displayName="Navigation";var Lu=b.createContext(null);Lu.displayName="Location";var Ea=b.createContext({outlet:null,matches:[],isDataRoute:!1});Ea.displayName="Route";var Fg=b.createContext(null);Fg.displayName="RouteError";var G2="REACT_ROUTER_ERROR",gS="REDIRECT",yS="ROUTE_ERROR_RESPONSE";function bS(n){if(n.startsWith(`${G2}:${gS}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function vS(n){if(n.startsWith(`${G2}:${yS}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new cS(e.status,e.statusText,e.data)}catch{}}function xS(n,{relative:e}={}){dn(uc(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=b.useContext(Yr),{hash:l,pathname:u,search:d}=Ou(n,{relative:e}),p=u;return t!=="/"&&(p=u==="/"?t:xi([t,u])),i.createHref({pathname:p,search:d,hash:l})}function uc(){return b.useContext(Lu)!=null}function Na(){return dn(uc(),"useLocation() may be used only in the context of a <Router> component."),b.useContext(Lu).location}var K2="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Y2(n){b.useContext(Yr).static||b.useLayoutEffect(n)}function rr(){let{isDataRoute:n}=b.useContext(Ea);return n?DS():wS()}function wS(){dn(uc(),"useNavigate() may be used only in the context of a <Router> component.");let n=b.useContext(cc),{basename:e,navigator:t}=b.useContext(Yr),{matches:i}=b.useContext(Ea),{pathname:l}=Na(),u=JSON.stringify(Vg(i)),d=b.useRef(!1);return Y2(()=>{d.current=!0}),b.useCallback((g,y={})=>{if(ua(d.current,K2),!d.current)return;if(typeof g=="number"){t.go(g);return}let x=Ug(g,JSON.parse(u),l,y.relative==="path");n==null&&e!=="/"&&(x.pathname=x.pathname==="/"?e:xi([e,x.pathname])),(y.replace?t.replace:t.push)(x,y.state,y)},[e,t,u,l,n])}b.createContext(null);function _S(){let{matches:n}=b.useContext(Ea),e=n[n.length-1];return e?e.params:{}}function Ou(n,{relative:e}={}){let{matches:t}=b.useContext(Ea),{pathname:i}=Na(),l=JSON.stringify(Vg(t));return b.useMemo(()=>Ug(n,JSON.parse(l),i,e==="path"),[n,l,i,e])}function kS(n,e){return Q2(n,e)}function Q2(n,e,t,i,l){dn(uc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=b.useContext(Yr),{matches:d}=b.useContext(Ea),p=d[d.length-1],g=p?p.params:{},y=p?p.pathname:"/",x=p?p.pathnameBase:"/",_=p&&p.route;{let Y=_&&_.path||"";J2(y,!_||Y.endsWith("*")||Y.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${y}" (under <Route path="${Y}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${Y}"> to <Route path="${Y==="/"?"*":`${Y}/*`}">.`)}let j=Na(),O;if(e){let Y=typeof e=="string"?lc(e):e;dn(x==="/"||Y.pathname?.startsWith(x),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${x}" but pathname "${Y.pathname}" was given in the \`location\` prop.`),O=Y}else O=j;let K=O.pathname||"/",B=K;if(x!=="/"){let Y=x.replace(/^\//,"").split("/");B="/"+K.replace(/^\//,"").split("/").slice(Y.length).join("/")}let D=U2(n,{pathname:B});ua(_||D!=null,`No routes matched location "${O.pathname}${O.search}${O.hash}" `),ua(D==null||D[D.length-1].route.element!==void 0||D[D.length-1].route.Component!==void 0||D[D.length-1].route.lazy!==void 0,`Matched leaf route at location "${O.pathname}${O.search}${O.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let se=NS(D&&D.map(Y=>Object.assign({},Y,{params:Object.assign({},g,Y.params),pathname:xi([x,u.encodeLocation?u.encodeLocation(Y.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Y.pathname]),pathnameBase:Y.pathnameBase==="/"?x:xi([x,u.encodeLocation?u.encodeLocation(Y.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Y.pathnameBase])})),d,t,i,l);return e&&se?b.createElement(Lu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...O},navigationType:"POP"}},se):se}function jS(){let n=IS(),e=uS(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:i},u={padding:"2px 4px",backgroundColor:i},d=null;return console.error("Error handled by React Router default ErrorBoundary:",n),d=b.createElement(b.Fragment,null,b.createElement("p",null," Hey developer "),b.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",b.createElement("code",{style:u},"ErrorBoundary")," or"," ",b.createElement("code",{style:u},"errorElement")," prop on your route.")),b.createElement(b.Fragment,null,b.createElement("h2",null,"Unexpected Application Error!"),b.createElement("h3",{style:{fontStyle:"italic"}},e),t?b.createElement("pre",{style:l},t):null,d)}var TS=b.createElement(jS,null),X2=class extends b.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=vS(n.digest);t&&(n=t)}let e=n!==void 0?b.createElement(Ea.Provider,{value:this.props.routeContext},b.createElement(Fg.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?b.createElement(SS,{error:n},e):e}};X2.contextType=mS;var Np=new WeakMap;function SS({children:n,error:e}){let{basename:t}=b.useContext(Yr);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=bS(e.digest);if(i){let l=Np.get(e);if(l)throw l;let u=H2(i.location,t);if(q2&&!Np.get(e))if(u.isExternal||i.reloadDocument)window.location.href=u.absoluteURL||u.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(u.to,{replace:i.replace}));throw Np.set(e,d),d}return b.createElement("meta",{httpEquiv:"refresh",content:`0;url=${u.absoluteURL||u.to}`})}}return n}function ES({routeContext:n,match:e,children:t}){let i=b.useContext(cc);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),b.createElement(Ea.Provider,{value:n},t)}function NS(n,e=[],t=null,i=null,l=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let u=n,d=t?.errors;if(d!=null){let x=u.findIndex(_=>_.route.id&&d?.[_.route.id]!==void 0);dn(x>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),u=u.slice(0,Math.min(u.length,x+1))}let p=!1,g=-1;if(t)for(let x=0;x<u.length;x++){let _=u[x];if((_.route.HydrateFallback||_.route.hydrateFallbackElement)&&(g=x),_.route.id){let{loaderData:j,errors:O}=t,K=_.route.loader&&!j.hasOwnProperty(_.route.id)&&(!O||O[_.route.id]===void 0);if(_.route.lazy||K){p=!0,g>=0?u=u.slice(0,g+1):u=[u[0]];break}}}let y=t&&i?(x,_)=>{i(x,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:dS(t.matches),errorInfo:_})}:void 0;return u.reduceRight((x,_,j)=>{let O,K=!1,B=null,D=null;t&&(O=d&&_.route.id?d[_.route.id]:void 0,B=_.route.errorElement||TS,p&&(g<0&&j===0?(J2("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),K=!0,D=null):g===j&&(K=!0,D=_.route.hydrateFallbackElement||null)));let se=e.concat(u.slice(0,j+1)),Y=()=>{let Z;return O?Z=B:K?Z=D:_.route.Component?Z=b.createElement(_.route.Component,null):_.route.element?Z=_.route.element:Z=x,b.createElement(ES,{match:_,routeContext:{outlet:x,matches:se,isDataRoute:t!=null},children:Z})};return t&&(_.route.ErrorBoundary||_.route.errorElement||j===0)?b.createElement(X2,{location:t.location,revalidation:t.revalidation,component:B,error:O,children:Y(),routeContext:{outlet:null,matches:se,isDataRoute:!0},onError:y}):Y()},null)}function zg(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function CS(n){let e=b.useContext(cc);return dn(e,zg(n)),e}function RS(n){let e=b.useContext(em);return dn(e,zg(n)),e}function AS(n){let e=b.useContext(Ea);return dn(e,zg(n)),e}function qg(n){let e=AS(n),t=e.matches[e.matches.length-1];return dn(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function MS(){return qg("useRouteId")}function IS(){let n=b.useContext(Fg),e=RS("useRouteError"),t=qg("useRouteError");return n!==void 0?n:e.errors?.[t]}function DS(){let{router:n}=CS("useNavigate"),e=qg("useNavigate"),t=b.useRef(!1);return Y2(()=>{t.current=!0}),b.useCallback(async(l,u={})=>{ua(t.current,K2),t.current&&(typeof l=="number"?await n.navigate(l):await n.navigate(l,{fromRouteId:e,...u}))},[n,e])}var V1={};function J2(n,e,t){!e&&!V1[n]&&(V1[n]=!0,ua(!1,t))}b.memo(PS);function PS({routes:n,future:e,state:t,onError:i}){return Q2(n,void 0,t,i,e)}function Z2({to:n,replace:e,state:t,relative:i}){dn(uc(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=b.useContext(Yr);ua(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=b.useContext(Ea),{pathname:d}=Na(),p=rr(),g=Ug(n,Vg(u),d,i==="path"),y=JSON.stringify(g);return b.useEffect(()=>{p(JSON.parse(y),{replace:e,state:t,relative:i})},[p,y,i,e,t]),null}function tn(n){dn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function LS({basename:n="/",children:e=null,location:t,navigationType:i="POP",navigator:l,static:u=!1,unstable_useTransitions:d}){dn(!uc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let p=n.replace(/^\/*/,"/"),g=b.useMemo(()=>({basename:p,navigator:l,static:u,unstable_useTransitions:d,future:{}}),[p,l,u,d]);typeof t=="string"&&(t=lc(t));let{pathname:y="/",search:x="",hash:_="",state:j=null,key:O="default"}=t,K=b.useMemo(()=>{let B=ki(y,p);return B==null?null:{location:{pathname:B,search:x,hash:_,state:j,key:O},navigationType:i}},[p,y,x,_,j,O,i]);return ua(K!=null,`<Router basename="${p}"> is not able to match the URL "${y}${x}${_}" because it does not start with the basename, so the <Router> won't render anything.`),K==null?null:b.createElement(Yr.Provider,{value:g},b.createElement(Lu.Provider,{children:e,value:K}))}function OS({children:n,location:e}){return kS(og(n),e)}function og(n,e=[]){let t=[];return b.Children.forEach(n,(i,l)=>{if(!b.isValidElement(i))return;let u=[...e,l];if(i.type===b.Fragment){t.push.apply(t,og(i.props.children,u));return}dn(i.type===tn,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),dn(!i.props.index||!i.props.children,"An index route cannot have child routes.");let d={id:i.props.id||u.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(d.children=og(i.props.children,u)),t.push(d)}),t}var vh="get",xh="application/x-www-form-urlencoded";function tm(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function BS(n){return tm(n)&&n.tagName.toLowerCase()==="button"}function VS(n){return tm(n)&&n.tagName.toLowerCase()==="form"}function US(n){return tm(n)&&n.tagName.toLowerCase()==="input"}function FS(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function zS(n,e){return n.button===0&&(!e||e==="_self")&&!FS(n)}function lg(n=""){return new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let i=n[t];return e.concat(Array.isArray(i)?i.map(l=>[t,l]):[[t,i]])},[]))}function qS(n,e){let t=lg(n);return e&&e.forEach((i,l)=>{t.has(l)||e.getAll(l).forEach(u=>{t.append(l,u)})}),t}var rh=null;function HS(){if(rh===null)try{new FormData(document.createElement("form"),0),rh=!1}catch{rh=!0}return rh}var $S=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Cp(n){return n!=null&&!$S.has(n)?(ua(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${xh}"`),null):n}function WS(n,e){let t,i,l,u,d;if(VS(n)){let p=n.getAttribute("action");i=p?ki(p,e):null,t=n.getAttribute("method")||vh,l=Cp(n.getAttribute("enctype"))||xh,u=new FormData(n)}else if(BS(n)||US(n)&&(n.type==="submit"||n.type==="image")){let p=n.form;if(p==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let g=n.getAttribute("formaction")||p.getAttribute("action");if(i=g?ki(g,e):null,t=n.getAttribute("formmethod")||p.getAttribute("method")||vh,l=Cp(n.getAttribute("formenctype"))||Cp(p.getAttribute("enctype"))||xh,u=new FormData(p,n),!HS()){let{name:y,type:x,value:_}=n;if(x==="image"){let j=y?`${y}.`:"";u.append(`${j}x`,"0"),u.append(`${j}y`,"0")}else y&&u.append(y,_)}}else{if(tm(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=vh,i=null,l=xh,d=n}return u&&l==="text/plain"&&(d=u,u=void 0),{action:i,method:t.toLowerCase(),encType:l,formData:u,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Hg(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function GS(n,e,t,i){let l=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t?l.pathname.endsWith("/")?l.pathname=`${l.pathname}_.${i}`:l.pathname=`${l.pathname}.${i}`:l.pathname==="/"?l.pathname=`_root.${i}`:e&&ki(l.pathname,e)==="/"?l.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:l.pathname=`${l.pathname.replace(/\/$/,"")}.${i}`,l}async function KS(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function YS(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function QS(n,e,t){let i=await Promise.all(n.map(async l=>{let u=e.routes[l.route.id];if(u){let d=await KS(u,t);return d.links?d.links():[]}return[]}));return eE(i.flat(1).filter(YS).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function U1(n,e,t,i,l,u){let d=(g,y)=>t[y]?g.route.id!==t[y].route.id:!0,p=(g,y)=>t[y].pathname!==g.pathname||t[y].route.path?.endsWith("*")&&t[y].params["*"]!==g.params["*"];return u==="assets"?e.filter((g,y)=>d(g,y)||p(g,y)):u==="data"?e.filter((g,y)=>{let x=i.routes[g.route.id];if(!x||!x.hasLoader)return!1;if(d(g,y)||p(g,y))return!0;if(g.route.shouldRevalidate){let _=g.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:g.params,defaultShouldRevalidate:!0});if(typeof _=="boolean")return _}return!0}):[]}function XS(n,e,{includeHydrateFallback:t}={}){return JS(n.map(i=>{let l=e.routes[i.route.id];if(!l)return[];let u=[l.module];return l.clientActionModule&&(u=u.concat(l.clientActionModule)),l.clientLoaderModule&&(u=u.concat(l.clientLoaderModule)),t&&l.hydrateFallbackModule&&(u=u.concat(l.hydrateFallbackModule)),l.imports&&(u=u.concat(l.imports)),u}).flat(1))}function JS(n){return[...new Set(n)]}function ZS(n){let e={},t=Object.keys(n).sort();for(let i of t)e[i]=n[i];return e}function eE(n,e){let t=new Set;return new Set(e),n.reduce((i,l)=>{let u=JSON.stringify(ZS(l));return t.has(u)||(t.add(u),i.push({key:u,link:l})),i},[])}function ew(){let n=b.useContext(cc);return Hg(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function tE(){let n=b.useContext(em);return Hg(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var $g=b.createContext(void 0);$g.displayName="FrameworkContext";function tw(){let n=b.useContext($g);return Hg(n,"You must render this element inside a <HydratedRouter> element"),n}function sE(n,e){let t=b.useContext($g),[i,l]=b.useState(!1),[u,d]=b.useState(!1),{onFocus:p,onBlur:g,onMouseEnter:y,onMouseLeave:x,onTouchStart:_}=e,j=b.useRef(null);b.useEffect(()=>{if(n==="render"&&d(!0),n==="viewport"){let B=se=>{se.forEach(Y=>{d(Y.isIntersecting)})},D=new IntersectionObserver(B,{threshold:.5});return j.current&&D.observe(j.current),()=>{D.disconnect()}}},[n]),b.useEffect(()=>{if(i){let B=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(B)}}},[i]);let O=()=>{l(!0)},K=()=>{l(!1),d(!1)};return t?n!=="intent"?[u,j,{}]:[u,j,{onFocus:su(p,O),onBlur:su(g,K),onMouseEnter:su(y,O),onMouseLeave:su(x,K),onTouchStart:su(_,O)}]:[!1,j,{}]}function su(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function nE({page:n,...e}){let{router:t}=ew(),i=b.useMemo(()=>U2(t.routes,n,t.basename),[t.routes,n,t.basename]);return i?b.createElement(aE,{page:n,matches:i,...e}):null}function rE(n){let{manifest:e,routeModules:t}=tw(),[i,l]=b.useState([]);return b.useEffect(()=>{let u=!1;return QS(n,e,t).then(d=>{u||l(d)}),()=>{u=!0}},[n,e,t]),i}function aE({page:n,matches:e,...t}){let i=Na(),{future:l,manifest:u,routeModules:d}=tw(),{basename:p}=ew(),{loaderData:g,matches:y}=tE(),x=b.useMemo(()=>U1(n,e,y,u,i,"data"),[n,e,y,u,i]),_=b.useMemo(()=>U1(n,e,y,u,i,"assets"),[n,e,y,u,i]),j=b.useMemo(()=>{if(n===i.pathname+i.search+i.hash)return[];let B=new Set,D=!1;if(e.forEach(Y=>{let Z=u.routes[Y.route.id];!Z||!Z.hasLoader||(!x.some(je=>je.route.id===Y.route.id)&&Y.route.id in g&&d[Y.route.id]?.shouldRevalidate||Z.hasClientLoader?D=!0:B.add(Y.route.id))}),B.size===0)return[];let se=GS(n,p,l.unstable_trailingSlashAwareDataRequests,"data");return D&&B.size>0&&se.searchParams.set("_routes",e.filter(Y=>B.has(Y.route.id)).map(Y=>Y.route.id).join(",")),[se.pathname+se.search]},[p,l.unstable_trailingSlashAwareDataRequests,g,i,u,x,e,n,d]),O=b.useMemo(()=>XS(_,u),[_,u]),K=rE(_);return b.createElement(b.Fragment,null,j.map(B=>b.createElement("link",{key:B,rel:"prefetch",as:"fetch",href:B,...t})),O.map(B=>b.createElement("link",{key:B,rel:"modulepreload",href:B,...t})),K.map(({key:B,link:D})=>b.createElement("link",{key:B,nonce:t.nonce,...D,crossOrigin:D.crossOrigin??t.crossOrigin})))}function iE(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var oE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{oE&&(window.__reactRouterVersion="7.13.0")}catch{}function lE({basename:n,children:e,unstable_useTransitions:t,window:i}){let l=b.useRef();l.current==null&&(l.current=UT({window:i,v5Compat:!0}));let u=l.current,[d,p]=b.useState({action:u.action,location:u.location}),g=b.useCallback(y=>{t===!1?p(y):b.startTransition(()=>p(y))},[t]);return b.useLayoutEffect(()=>u.listen(g),[u,g]),b.createElement(LS,{basename:n,children:e,location:d.location,navigationType:d.action,navigator:u,unstable_useTransitions:t})}var sw=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,nw=b.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:l,reloadDocument:u,replace:d,state:p,target:g,to:y,preventScrollReset:x,viewTransition:_,unstable_defaultShouldRevalidate:j,...O},K){let{basename:B,unstable_useTransitions:D}=b.useContext(Yr),se=typeof y=="string"&&sw.test(y),Y=H2(y,B);y=Y.to;let Z=xS(y,{relative:l}),[je,Re,ke]=sE(i,O),C=hE(y,{replace:d,state:p,target:g,preventScrollReset:x,relative:l,viewTransition:_,unstable_defaultShouldRevalidate:j,unstable_useTransitions:D});function T(V){e&&e(V),V.defaultPrevented||C(V)}let M=b.createElement("a",{...O,...ke,href:Y.absoluteURL||Z,onClick:Y.isExternal||u?e:T,ref:iE(K,Re),target:g,"data-discover":!se&&t==="render"?"true":void 0});return je&&!se?b.createElement(b.Fragment,null,M,b.createElement(nE,{page:Z})):M});nw.displayName="Link";var cE=b.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:l=!1,style:u,to:d,viewTransition:p,children:g,...y},x){let _=Ou(d,{relative:y.relative}),j=Na(),O=b.useContext(em),{navigator:K,basename:B}=b.useContext(Yr),D=O!=null&&bE(_)&&p===!0,se=K.encodeLocation?K.encodeLocation(_).pathname:_.pathname,Y=j.pathname,Z=O&&O.navigation&&O.navigation.location?O.navigation.location.pathname:null;t||(Y=Y.toLowerCase(),Z=Z?Z.toLowerCase():null,se=se.toLowerCase()),Z&&B&&(Z=ki(Z,B)||Z);const je=se!=="/"&&se.endsWith("/")?se.length-1:se.length;let Re=Y===se||!l&&Y.startsWith(se)&&Y.charAt(je)==="/",ke=Z!=null&&(Z===se||!l&&Z.startsWith(se)&&Z.charAt(se.length)==="/"),C={isActive:Re,isPending:ke,isTransitioning:D},T=Re?e:void 0,M;typeof i=="function"?M=i(C):M=[i,Re?"active":null,ke?"pending":null,D?"transitioning":null].filter(Boolean).join(" ");let V=typeof u=="function"?u(C):u;return b.createElement(nw,{...y,"aria-current":T,className:M,ref:x,style:V,to:d,viewTransition:p},typeof g=="function"?g(C):g)});cE.displayName="NavLink";var uE=b.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:l,state:u,method:d=vh,action:p,onSubmit:g,relative:y,preventScrollReset:x,viewTransition:_,unstable_defaultShouldRevalidate:j,...O},K)=>{let{unstable_useTransitions:B}=b.useContext(Yr),D=gE(),se=yE(p,{relative:y}),Y=d.toLowerCase()==="get"?"get":"post",Z=typeof p=="string"&&sw.test(p),je=Re=>{if(g&&g(Re),Re.defaultPrevented)return;Re.preventDefault();let ke=Re.nativeEvent.submitter,C=ke?.getAttribute("formmethod")||d,T=()=>D(ke||Re.currentTarget,{fetcherKey:e,method:C,navigate:t,replace:l,state:u,relative:y,preventScrollReset:x,viewTransition:_,unstable_defaultShouldRevalidate:j});B&&t!==!1?b.startTransition(()=>T()):T()};return b.createElement("form",{ref:K,method:Y,action:se,onSubmit:i?g:je,...O,"data-discover":!Z&&n==="render"?"true":void 0})});uE.displayName="Form";function dE(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function rw(n){let e=b.useContext(cc);return dn(e,dE(n)),e}function hE(n,{target:e,replace:t,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p,unstable_useTransitions:g}={}){let y=rr(),x=Na(),_=Ou(n,{relative:u});return b.useCallback(j=>{if(zS(j,e)){j.preventDefault();let O=t!==void 0?t:_u(x)===_u(_),K=()=>y(n,{replace:O,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p});g?b.startTransition(()=>K()):K()}},[x,y,_,t,i,e,n,l,u,d,p,g])}function mE(n){ua(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=b.useRef(lg(n)),t=b.useRef(!1),i=Na(),l=b.useMemo(()=>qS(i.search,t.current?null:e.current),[i.search]),u=rr(),d=b.useCallback((p,g)=>{const y=lg(typeof p=="function"?p(new URLSearchParams(l)):p);t.current=!0,u("?"+y,g)},[u,l]);return[l,d]}var fE=0,pE=()=>`__${String(++fE)}__`;function gE(){let{router:n}=rw("useSubmit"),{basename:e}=b.useContext(Yr),t=MS(),i=n.fetch,l=n.navigate;return b.useCallback(async(u,d={})=>{let{action:p,method:g,encType:y,formData:x,body:_}=WS(u,e);if(d.navigate===!1){let j=d.fetcherKey||pE();await i(j,t,d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:x,body:_,formMethod:d.method||g,formEncType:d.encType||y,flushSync:d.flushSync})}else await l(d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:x,body:_,formMethod:d.method||g,formEncType:d.encType||y,replace:d.replace,state:d.state,fromRouteId:t,flushSync:d.flushSync,viewTransition:d.viewTransition})},[i,l,e,t])}function yE(n,{relative:e}={}){let{basename:t}=b.useContext(Yr),i=b.useContext(Ea);dn(i,"useFormAction must be used inside a RouteContext");let[l]=i.matches.slice(-1),u={...Ou(n||".",{relative:e})},d=Na();if(n==null){u.search=d.search;let p=new URLSearchParams(u.search),g=p.getAll("index");if(g.some(x=>x==="")){p.delete("index"),g.filter(_=>_).forEach(_=>p.append("index",_));let x=p.toString();u.search=x?`?${x}`:""}}return(!n||n===".")&&l.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(u.pathname=u.pathname==="/"?t:xi([t,u.pathname])),_u(u)}function bE(n,{relative:e}={}){let t=b.useContext(W2);dn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=rw("useViewTransitionState"),l=Ou(n,{relative:e});if(!t.isTransitioning)return!1;let u=ki(t.currentLocation.pathname,i)||t.currentLocation.pathname,d=ki(t.nextLocation.pathname,i)||t.nextLocation.pathname;return Mh(l.pathname,d)!=null||Mh(l.pathname,u)!=null}const vE=()=>{};var F1={};const aw=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let l=n.charCodeAt(i);l<128?e[t++]=l:l<2048?(e[t++]=l>>6|192,e[t++]=l&63|128):(l&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(l=65536+((l&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=l>>18|240,e[t++]=l>>12&63|128,e[t++]=l>>6&63|128,e[t++]=l&63|128):(e[t++]=l>>12|224,e[t++]=l>>6&63|128,e[t++]=l&63|128)}return e},xE=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const l=n[t++];if(l<128)e[i++]=String.fromCharCode(l);else if(l>191&&l<224){const u=n[t++];e[i++]=String.fromCharCode((l&31)<<6|u&63)}else if(l>239&&l<365){const u=n[t++],d=n[t++],p=n[t++],g=((l&7)<<18|(u&63)<<12|(d&63)<<6|p&63)-65536;e[i++]=String.fromCharCode(55296+(g>>10)),e[i++]=String.fromCharCode(56320+(g&1023))}else{const u=n[t++],d=n[t++];e[i++]=String.fromCharCode((l&15)<<12|(u&63)<<6|d&63)}}return e.join("")},iw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let l=0;l<n.length;l+=3){const u=n[l],d=l+1<n.length,p=d?n[l+1]:0,g=l+2<n.length,y=g?n[l+2]:0,x=u>>2,_=(u&3)<<4|p>>4;let j=(p&15)<<2|y>>6,O=y&63;g||(O=64,d||(j=64)),i.push(t[x],t[_],t[j],t[O])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(aw(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):xE(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let l=0;l<n.length;){const u=t[n.charAt(l++)],p=l<n.length?t[n.charAt(l)]:0;++l;const y=l<n.length?t[n.charAt(l)]:64;++l;const _=l<n.length?t[n.charAt(l)]:64;if(++l,u==null||p==null||y==null||_==null)throw new wE;const j=u<<2|p>>4;if(i.push(j),y!==64){const O=p<<4&240|y>>2;if(i.push(O),_!==64){const K=y<<6&192|_;i.push(K)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class wE extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const _E=function(n){const e=aw(n);return iw.encodeByteArray(e,!0)},Ih=function(n){return _E(n).replace(/\./g,"")},ow=function(n){try{return iw.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function kE(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const jE=()=>kE().__FIREBASE_DEFAULTS__,TE=()=>{if(typeof process>"u"||typeof F1>"u")return;const n=F1.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},SE=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&ow(n[1]);return e&&JSON.parse(e)},sm=()=>{try{return vE()||jE()||TE()||SE()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},lw=n=>sm()?.emulatorHosts?.[n],cw=n=>{const e=lw(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},uw=()=>sm()?.config,dw=n=>sm()?.[`_${n}`];class EE{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function _o(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Wg(n){return(await fetch(n,{credentials:"include"})).ok}function hw(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",l=n.iat||0,u=n.sub||n.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d={iss:`https://securetoken.google.com/${i}`,aud:i,iat:l,exp:l+3600,auth_time:l,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Ih(JSON.stringify(t)),Ih(JSON.stringify(d)),""].join(".")}const pu={};function NE(){const n={prod:[],emulator:[]};for(const e of Object.keys(pu))pu[e]?n.emulator.push(e):n.prod.push(e);return n}function CE(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let z1=!1;function Gg(n,e){if(typeof window>"u"||typeof document>"u"||!_o(window.location.host)||pu[n]===e||pu[n]||z1)return;pu[n]=e;function t(j){return`__firebase__banner__${j}`}const i="__firebase__banner",u=NE().prod.length>0;function d(){const j=document.getElementById(i);j&&j.remove()}function p(j){j.style.display="flex",j.style.background="#7faaf0",j.style.position="fixed",j.style.bottom="5px",j.style.left="5px",j.style.padding=".5em",j.style.borderRadius="5px",j.style.alignItems="center"}function g(j,O){j.setAttribute("width","24"),j.setAttribute("id",O),j.setAttribute("height","24"),j.setAttribute("viewBox","0 0 24 24"),j.setAttribute("fill","none"),j.style.marginLeft="-6px"}function y(){const j=document.createElement("span");return j.style.cursor="pointer",j.style.marginLeft="16px",j.style.fontSize="24px",j.innerHTML=" &times;",j.onclick=()=>{z1=!0,d()},j}function x(j,O){j.setAttribute("id",O),j.innerText="Learn more",j.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",j.setAttribute("target","__blank"),j.style.paddingLeft="5px",j.style.textDecoration="underline"}function _(){const j=CE(i),O=t("text"),K=document.getElementById(O)||document.createElement("span"),B=t("learnmore"),D=document.getElementById(B)||document.createElement("a"),se=t("preprendIcon"),Y=document.getElementById(se)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(j.created){const Z=j.element;p(Z),x(D,B);const je=y();g(Y,se),Z.append(Y,K,D,je),document.body.appendChild(Z)}u?(K.innerText="Preview backend disconnected.",Y.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(Y.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,K.innerText="Preview backend running in this workspace."),K.setAttribute("id",O)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",_):_()}function dr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function RE(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(dr())}function AE(){const n=sm()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function ME(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function IE(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function DE(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function PE(){const n=dr();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function LE(){return!AE()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function OE(){try{return typeof indexedDB=="object"}catch{return!1}}function BE(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",l=self.indexedDB.open(i);l.onsuccess=()=>{l.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},l.onupgradeneeded=()=>{t=!1},l.onerror=()=>{e(l.error?.message||"")}}catch(t){e(t)}})}const VE="FirebaseError";class Xa extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=VE,Object.setPrototypeOf(this,Xa.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Bu.prototype.create)}}class Bu{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},l=`${this.service}/${e}`,u=this.errors[e],d=u?UE(u,i):"Error",p=`${this.serviceName}: ${d} (${l}).`;return new Xa(l,p,i)}}function UE(n,e){return n.replace(FE,(t,i)=>{const l=e[i];return l!=null?String(l):`<${i}?>`})}const FE=/\{\$([^}]+)}/g;function zE(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Zo(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const l of t){if(!i.includes(l))return!1;const u=n[l],d=e[l];if(q1(u)&&q1(d)){if(!Zo(u,d))return!1}else if(u!==d)return!1}for(const l of i)if(!t.includes(l))return!1;return!0}function q1(n){return n!==null&&typeof n=="object"}function Vu(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(l=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(l))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function cu(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[l,u]=i.split("=");e[decodeURIComponent(l)]=decodeURIComponent(u)}}),e}function uu(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function qE(n,e){const t=new HE(n,e);return t.subscribe.bind(t)}class HE{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let l;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");$E(e,["next","error","complete"])?l=e:l={next:e,error:t,complete:i},l.next===void 0&&(l.next=Rp),l.error===void 0&&(l.error=Rp),l.complete===void 0&&(l.complete=Rp);const u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?l.error(this.finalError):l.complete()}catch{}}),this.observers.push(l),u}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function $E(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Rp(){}function Qs(n){return n&&n._delegate?n._delegate:n}class po{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Go="[DEFAULT]";class WE{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new EE;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const l=this.getOrInitializeService({instanceIdentifier:t});l&&i.resolve(l)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(l){if(i)return null;throw l}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(KE(e))try{this.getOrInitializeService({instanceIdentifier:Go})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(t);try{const u=this.getOrInitializeService({instanceIdentifier:l});i.resolve(u)}catch{}}}}clearInstance(e=Go){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Go){return this.instances.has(e)}getOptions(e=Go){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const l=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[u,d]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(u);i===p&&d.resolve(l)}return l}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),l=this.onInitCallbacks.get(i)??new Set;l.add(e),this.onInitCallbacks.set(i,l);const u=this.instances.get(i);return u&&e(u,i),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const l of i)try{l(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:GE(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Go){return this.component?this.component.multipleInstances?e:Go:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function GE(n){return n===Go?void 0:n}function KE(n){return n.instantiationMode==="EAGER"}class YE{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new WE(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Ss;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ss||(Ss={}));const QE={debug:Ss.DEBUG,verbose:Ss.VERBOSE,info:Ss.INFO,warn:Ss.WARN,error:Ss.ERROR,silent:Ss.SILENT},XE=Ss.INFO,JE={[Ss.DEBUG]:"log",[Ss.VERBOSE]:"log",[Ss.INFO]:"info",[Ss.WARN]:"warn",[Ss.ERROR]:"error"},ZE=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),l=JE[e];if(l)console[l](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Kg{constructor(e){this.name=e,this._logLevel=XE,this._logHandler=ZE,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ss))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?QE[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ss.DEBUG,...e),this._logHandler(this,Ss.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ss.VERBOSE,...e),this._logHandler(this,Ss.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ss.INFO,...e),this._logHandler(this,Ss.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ss.WARN,...e),this._logHandler(this,Ss.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ss.ERROR,...e),this._logHandler(this,Ss.ERROR,...e)}}const eN=(n,e)=>e.some(t=>n instanceof t);let H1,$1;function tN(){return H1||(H1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function sN(){return $1||($1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const mw=new WeakMap,cg=new WeakMap,fw=new WeakMap,Ap=new WeakMap,Yg=new WeakMap;function nN(n){const e=new Promise((t,i)=>{const l=()=>{n.removeEventListener("success",u),n.removeEventListener("error",d)},u=()=>{t(co(n.result)),l()},d=()=>{i(n.error),l()};n.addEventListener("success",u),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&mw.set(t,n)}).catch(()=>{}),Yg.set(e,n),e}function rN(n){if(cg.has(n))return;const e=new Promise((t,i)=>{const l=()=>{n.removeEventListener("complete",u),n.removeEventListener("error",d),n.removeEventListener("abort",d)},u=()=>{t(),l()},d=()=>{i(n.error||new DOMException("AbortError","AbortError")),l()};n.addEventListener("complete",u),n.addEventListener("error",d),n.addEventListener("abort",d)});cg.set(n,e)}let ug={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return cg.get(n);if(e==="objectStoreNames")return n.objectStoreNames||fw.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return co(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function aN(n){ug=n(ug)}function iN(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Mp(this),e,...t);return fw.set(i,e.sort?e.sort():[e]),co(i)}:sN().includes(n)?function(...e){return n.apply(Mp(this),e),co(mw.get(this))}:function(...e){return co(n.apply(Mp(this),e))}}function oN(n){return typeof n=="function"?iN(n):(n instanceof IDBTransaction&&rN(n),eN(n,tN())?new Proxy(n,ug):n)}function co(n){if(n instanceof IDBRequest)return nN(n);if(Ap.has(n))return Ap.get(n);const e=oN(n);return e!==n&&(Ap.set(n,e),Yg.set(e,n)),e}const Mp=n=>Yg.get(n);function lN(n,e,{blocked:t,upgrade:i,blocking:l,terminated:u}={}){const d=indexedDB.open(n,e),p=co(d);return i&&d.addEventListener("upgradeneeded",g=>{i(co(d.result),g.oldVersion,g.newVersion,co(d.transaction),g)}),t&&d.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),p.then(g=>{u&&g.addEventListener("close",()=>u()),l&&g.addEventListener("versionchange",y=>l(y.oldVersion,y.newVersion,y))}).catch(()=>{}),p}const cN=["get","getKey","getAll","getAllKeys","count"],uN=["put","add","delete","clear"],Ip=new Map;function W1(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Ip.get(e))return Ip.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,l=uN.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(l||cN.includes(t)))return;const u=async function(d,...p){const g=this.transaction(d,l?"readwrite":"readonly");let y=g.store;return i&&(y=y.index(p.shift())),(await Promise.all([y[t](...p),l&&g.done]))[0]};return Ip.set(e,u),u}aN(n=>({...n,get:(e,t,i)=>W1(e,t)||n.get(e,t,i),has:(e,t)=>!!W1(e,t)||n.has(e,t)}));class dN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(hN(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function hN(n){return n.getComponent()?.type==="VERSION"}const dg="@firebase/app",G1="0.14.7";const ji=new Kg("@firebase/app"),mN="@firebase/app-compat",fN="@firebase/analytics-compat",pN="@firebase/analytics",gN="@firebase/app-check-compat",yN="@firebase/app-check",bN="@firebase/auth",vN="@firebase/auth-compat",xN="@firebase/database",wN="@firebase/data-connect",_N="@firebase/database-compat",kN="@firebase/functions",jN="@firebase/functions-compat",TN="@firebase/installations",SN="@firebase/installations-compat",EN="@firebase/messaging",NN="@firebase/messaging-compat",CN="@firebase/performance",RN="@firebase/performance-compat",AN="@firebase/remote-config",MN="@firebase/remote-config-compat",IN="@firebase/storage",DN="@firebase/storage-compat",PN="@firebase/firestore",LN="@firebase/ai",ON="@firebase/firestore-compat",BN="firebase",VN="12.8.0";const hg="[DEFAULT]",UN={[dg]:"fire-core",[mN]:"fire-core-compat",[pN]:"fire-analytics",[fN]:"fire-analytics-compat",[yN]:"fire-app-check",[gN]:"fire-app-check-compat",[bN]:"fire-auth",[vN]:"fire-auth-compat",[xN]:"fire-rtdb",[wN]:"fire-data-connect",[_N]:"fire-rtdb-compat",[kN]:"fire-fn",[jN]:"fire-fn-compat",[TN]:"fire-iid",[SN]:"fire-iid-compat",[EN]:"fire-fcm",[NN]:"fire-fcm-compat",[CN]:"fire-perf",[RN]:"fire-perf-compat",[AN]:"fire-rc",[MN]:"fire-rc-compat",[IN]:"fire-gcs",[DN]:"fire-gcs-compat",[PN]:"fire-fst",[ON]:"fire-fst-compat",[LN]:"fire-vertex","fire-js":"fire-js",[BN]:"fire-js-all"};const Dh=new Map,FN=new Map,mg=new Map;function K1(n,e){try{n.container.addComponent(e)}catch(t){ji.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function el(n){const e=n.name;if(mg.has(e))return ji.debug(`There were multiple attempts to register component ${e}.`),!1;mg.set(e,n);for(const t of Dh.values())K1(t,n);for(const t of FN.values())K1(t,n);return!0}function nm(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Wr(n){return n==null?!1:n.settings!==void 0}const zN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},uo=new Bu("app","Firebase",zN);class qN{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new po("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw uo.create("app-deleted",{appName:this._name})}}const ol=VN;function Qg(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:hg,automaticDataCollectionEnabled:!0,...e},l=i.name;if(typeof l!="string"||!l)throw uo.create("bad-app-name",{appName:String(l)});if(t||(t=uw()),!t)throw uo.create("no-options");const u=Dh.get(l);if(u){if(Zo(t,u.options)&&Zo(i,u.config))return u;throw uo.create("duplicate-app",{appName:l})}const d=new YE(l);for(const g of mg.values())d.addComponent(g);const p=new qN(t,i,d);return Dh.set(l,p),p}function Xg(n=hg){const e=Dh.get(n);if(!e&&n===hg&&uw())return Qg();if(!e)throw uo.create("no-app",{appName:n});return e}function qa(n,e,t){let i=UN[n]??n;t&&(i+=`-${t}`);const l=i.match(/\s|\//),u=e.match(/\s|\//);if(l||u){const d=[`Unable to register library "${i}" with version "${e}":`];l&&d.push(`library name "${i}" contains illegal characters (whitespace or "/")`),l&&u&&d.push("and"),u&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ji.warn(d.join(" "));return}el(new po(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const HN="firebase-heartbeat-database",$N=1,ku="firebase-heartbeat-store";let Dp=null;function pw(){return Dp||(Dp=lN(HN,$N,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(ku)}catch(t){console.warn(t)}}}}).catch(n=>{throw uo.create("idb-open",{originalErrorMessage:n.message})})),Dp}async function WN(n){try{const t=(await pw()).transaction(ku),i=await t.objectStore(ku).get(gw(n));return await t.done,i}catch(e){if(e instanceof Xa)ji.warn(e.message);else{const t=uo.create("idb-get",{originalErrorMessage:e?.message});ji.warn(t.message)}}}async function Y1(n,e){try{const i=(await pw()).transaction(ku,"readwrite");await i.objectStore(ku).put(e,gw(n)),await i.done}catch(t){if(t instanceof Xa)ji.warn(t.message);else{const i=uo.create("idb-set",{originalErrorMessage:t?.message});ji.warn(i.message)}}}function gw(n){return`${n.name}!${n.options.appId}`}const GN=1024,KN=30;class YN{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new XN(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Q1();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(l=>l.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>KN){const l=JN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){ji.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Q1(),{heartbeatsToSend:t,unsentEntries:i}=QN(this._heartbeatsCache.heartbeats),l=Ih(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(e){return ji.warn(e),""}}}function Q1(){return new Date().toISOString().substring(0,10)}function QN(n,e=GN){const t=[];let i=n.slice();for(const l of n){const u=t.find(d=>d.agent===l.agent);if(u){if(u.dates.push(l.date),X1(t)>e){u.dates.pop();break}}else if(t.push({agent:l.agent,dates:[l.date]}),X1(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class XN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return OE()?BE().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await WN(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Y1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Y1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function X1(n){return Ih(JSON.stringify({version:2,heartbeats:n})).length}function JN(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function ZN(n){el(new po("platform-logger",e=>new dN(e),"PRIVATE")),el(new po("heartbeat",e=>new YN(e),"PRIVATE")),qa(dg,G1,n),qa(dg,G1,"esm2020"),qa("fire-js","")}ZN("");function yw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const eC=yw,bw=new Bu("auth","Firebase",yw());const Ph=new Kg("@firebase/auth");function tC(n,...e){Ph.logLevel<=Ss.WARN&&Ph.warn(`Auth (${ol}): ${n}`,...e)}function wh(n,...e){Ph.logLevel<=Ss.ERROR&&Ph.error(`Auth (${ol}): ${n}`,...e)}function ka(n,...e){throw Jg(n,...e)}function Ha(n,...e){return Jg(n,...e)}function vw(n,e,t){const i={...eC(),[e]:t};return new Bu("auth","Firebase",i).create(e,{appName:n.name})}function wi(n){return vw(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Jg(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return bw.create(n,...e)}function Xt(n,e,...t){if(!n)throw Jg(e,...t)}function gi(n){const e="INTERNAL ASSERTION FAILED: "+n;throw wh(e),new Error(e)}function Ti(n,e){n||gi(e)}function fg(){return typeof self<"u"&&self.location?.href||""}function sC(){return J1()==="http:"||J1()==="https:"}function J1(){return typeof self<"u"&&self.location?.protocol||null}function nC(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(sC()||IE()||"connection"in navigator)?navigator.onLine:!0}function rC(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Uu{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ti(t>e,"Short delay should be less than long delay!"),this.isMobile=RE()||DE()}get(){return nC()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Zg(n,e){Ti(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class xw{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;gi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;gi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;gi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const aC={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const iC=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],oC=new Uu(3e4,6e4);function Ni(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Ci(n,e,t,i,l={}){return ww(n,l,async()=>{let u={},d={};i&&(e==="GET"?d=i:u={body:JSON.stringify(i)});const p=Vu({key:n.config.apiKey,...d}).slice(1),g=await n._getAdditionalHeaders();g["Content-Type"]="application/json",n.languageCode&&(g["X-Firebase-Locale"]=n.languageCode);const y={method:e,headers:g,...u};return ME()||(y.referrerPolicy="no-referrer"),n.emulatorConfig&&_o(n.emulatorConfig.host)&&(y.credentials="include"),xw.fetch()(await _w(n,n.config.apiHost,t,p),y)})}async function ww(n,e,t){n._canInitEmulator=!1;const i={...aC,...e};try{const l=new cC(n),u=await Promise.race([t(),l.promise]);l.clearNetworkTimeout();const d=await u.json();if("needConfirmation"in d)throw ah(n,"account-exists-with-different-credential",d);if(u.ok&&!("errorMessage"in d))return d;{const p=u.ok?d.errorMessage:d.error.message,[g,y]=p.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw ah(n,"credential-already-in-use",d);if(g==="EMAIL_EXISTS")throw ah(n,"email-already-in-use",d);if(g==="USER_DISABLED")throw ah(n,"user-disabled",d);const x=i[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw vw(n,x,y);ka(n,x)}}catch(l){if(l instanceof Xa)throw l;ka(n,"network-request-failed",{message:String(l)})}}async function Fu(n,e,t,i,l={}){const u=await Ci(n,e,t,i,l);return"mfaPendingCredential"in u&&ka(n,"multi-factor-auth-required",{_serverResponse:u}),u}async function _w(n,e,t,i){const l=`${e}${t}?${i}`,u=n,d=u.config.emulator?Zg(n.config,l):`${n.config.apiScheme}://${l}`;return iC.includes(t)&&(await u._persistenceManagerAvailable,u._getPersistenceType()==="COOKIE")?u._getPersistence()._getFinalTarget(d).toString():d}function lC(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class cC{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Ha(this.auth,"network-request-failed")),oC.get())})}}function ah(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const l=Ha(n,e,i);return l.customData._tokenResponse=t,l}function Z1(n){return n!==void 0&&n.enterprise!==void 0}class uC{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return lC(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function dC(n,e){return Ci(n,"GET","/v2/recaptchaConfig",Ni(n,e))}async function hC(n,e){return Ci(n,"POST","/v1/accounts:delete",e)}async function Lh(n,e){return Ci(n,"POST","/v1/accounts:lookup",e)}function gu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function mC(n,e=!1){const t=Qs(n),i=await t.getIdToken(e),l=ey(i);Xt(l&&l.exp&&l.auth_time&&l.iat,t.auth,"internal-error");const u=typeof l.firebase=="object"?l.firebase:void 0,d=u?.sign_in_provider;return{claims:l,token:i,authTime:gu(Pp(l.auth_time)),issuedAtTime:gu(Pp(l.iat)),expirationTime:gu(Pp(l.exp)),signInProvider:d||null,signInSecondFactor:u?.sign_in_second_factor||null}}function Pp(n){return Number(n)*1e3}function ey(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return wh("JWT malformed, contained fewer than 3 sections"),null;try{const l=ow(t);return l?JSON.parse(l):(wh("Failed to decode base64 JWT payload"),null)}catch(l){return wh("Caught error parsing JWT payload as JSON",l?.toString()),null}}function ex(n){const e=ey(n);return Xt(e,"internal-error"),Xt(typeof e.exp<"u","internal-error"),Xt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function ju(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Xa&&fC(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function fC({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class pC{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class pg{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=gu(this.lastLoginAt),this.creationTime=gu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Oh(n){const e=n.auth,t=await n.getIdToken(),i=await ju(n,Lh(e,{idToken:t}));Xt(i?.users.length,e,"internal-error");const l=i.users[0];n._notifyReloadListener(l);const u=l.providerUserInfo?.length?kw(l.providerUserInfo):[],d=yC(n.providerData,u),p=n.isAnonymous,g=!(n.email&&l.passwordHash)&&!d?.length,y=p?g:!1,x={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:d,metadata:new pg(l.createdAt,l.lastLoginAt),isAnonymous:y};Object.assign(n,x)}async function gC(n){const e=Qs(n);await Oh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function yC(n,e){return[...n.filter(i=>!e.some(l=>l.providerId===i.providerId)),...e]}function kw(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function bC(n,e){const t=await ww(n,{},async()=>{const i=Vu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:l,apiKey:u}=n.config,d=await _w(n,l,"/v1/token",`key=${u}`),p=await n._getAdditionalHeaders();p["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:p,body:i};return n.emulatorConfig&&_o(n.emulatorConfig.host)&&(g.credentials="include"),xw.fetch()(d,g)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function vC(n,e){return Ci(n,"POST","/v2/accounts:revokeToken",Ni(n,e))}class Ql{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Xt(e.idToken,"internal-error"),Xt(typeof e.idToken<"u","internal-error"),Xt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ex(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Xt(e.length!==0,"internal-error");const t=ex(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Xt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:l,expiresIn:u}=await bC(e,t);this.updateTokensAndExpiration(i,l,Number(u))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:l,expirationTime:u}=t,d=new Ql;return i&&(Xt(typeof i=="string","internal-error",{appName:e}),d.refreshToken=i),l&&(Xt(typeof l=="string","internal-error",{appName:e}),d.accessToken=l),u&&(Xt(typeof u=="number","internal-error",{appName:e}),d.expirationTime=u),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ql,this.toJSON())}_performRefresh(){return gi("not implemented")}}function to(n,e){Xt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class wa{constructor({uid:e,auth:t,stsTokenManager:i,...l}){this.providerId="firebase",this.proactiveRefresh=new pC(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new pg(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await ju(this,this.stsTokenManager.getToken(this.auth,e));return Xt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return mC(this,e)}reload(){return gC(this)}_assign(e){this!==e&&(Xt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new wa({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Xt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Oh(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Wr(this.auth.app))return Promise.reject(wi(this.auth));const e=await this.getIdToken();return await ju(this,hC(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,l=t.email??void 0,u=t.phoneNumber??void 0,d=t.photoURL??void 0,p=t.tenantId??void 0,g=t._redirectEventId??void 0,y=t.createdAt??void 0,x=t.lastLoginAt??void 0,{uid:_,emailVerified:j,isAnonymous:O,providerData:K,stsTokenManager:B}=t;Xt(_&&B,e,"internal-error");const D=Ql.fromJSON(this.name,B);Xt(typeof _=="string",e,"internal-error"),to(i,e.name),to(l,e.name),Xt(typeof j=="boolean",e,"internal-error"),Xt(typeof O=="boolean",e,"internal-error"),to(u,e.name),to(d,e.name),to(p,e.name),to(g,e.name),to(y,e.name),to(x,e.name);const se=new wa({uid:_,auth:e,email:l,emailVerified:j,displayName:i,isAnonymous:O,photoURL:d,phoneNumber:u,tenantId:p,stsTokenManager:D,createdAt:y,lastLoginAt:x});return K&&Array.isArray(K)&&(se.providerData=K.map(Y=>({...Y}))),g&&(se._redirectEventId=g),se}static async _fromIdTokenResponse(e,t,i=!1){const l=new Ql;l.updateFromServerResponse(t);const u=new wa({uid:t.localId,auth:e,stsTokenManager:l,isAnonymous:i});return await Oh(u),u}static async _fromGetAccountInfoResponse(e,t,i){const l=t.users[0];Xt(l.localId!==void 0,"internal-error");const u=l.providerUserInfo!==void 0?kw(l.providerUserInfo):[],d=!(l.email&&l.passwordHash)&&!u?.length,p=new Ql;p.updateFromIdToken(i);const g=new wa({uid:l.localId,auth:e,stsTokenManager:p,isAnonymous:d}),y={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:u,metadata:new pg(l.createdAt,l.lastLoginAt),isAnonymous:!(l.email&&l.passwordHash)&&!u?.length};return Object.assign(g,y),g}}const tx=new Map;function yi(n){Ti(n instanceof Function,"Expected a class definition");let e=tx.get(n);return e?(Ti(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,tx.set(n,e),e)}class jw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}jw.type="NONE";const sx=jw;function _h(n,e,t){return`firebase:${n}:${e}:${t}`}class Xl{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:l,name:u}=this.auth;this.fullUserKey=_h(this.userKey,l.apiKey,u),this.fullPersistenceKey=_h("persistence",l.apiKey,u),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Lh(this.auth,{idToken:e}).catch(()=>{});return t?wa._fromGetAccountInfoResponse(this.auth,t,e):null}return wa._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Xl(yi(sx),e,i);const l=(await Promise.all(t.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let u=l[0]||yi(sx);const d=_h(i,e.config.apiKey,e.name);let p=null;for(const y of t)try{const x=await y._get(d);if(x){let _;if(typeof x=="string"){const j=await Lh(e,{idToken:x}).catch(()=>{});if(!j)break;_=await wa._fromGetAccountInfoResponse(e,j,x)}else _=wa._fromJSON(e,x);y!==u&&(p=_),u=y;break}}catch{}const g=l.filter(y=>y._shouldAllowMigration);return!u._shouldAllowMigration||!g.length?new Xl(u,e,i):(u=g[0],p&&await u._set(d,p.toJSON()),await Promise.all(t.map(async y=>{if(y!==u)try{await y._remove(d)}catch{}})),new Xl(u,e,i))}}function nx(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Nw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Tw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Rw(e))return"Blackberry";if(Aw(e))return"Webos";if(Sw(e))return"Safari";if((e.includes("chrome/")||Ew(e))&&!e.includes("edge/"))return"Chrome";if(Cw(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function Tw(n=dr()){return/firefox\//i.test(n)}function Sw(n=dr()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Ew(n=dr()){return/crios\//i.test(n)}function Nw(n=dr()){return/iemobile/i.test(n)}function Cw(n=dr()){return/android/i.test(n)}function Rw(n=dr()){return/blackberry/i.test(n)}function Aw(n=dr()){return/webos/i.test(n)}function ty(n=dr()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function xC(n=dr()){return ty(n)&&!!window.navigator?.standalone}function wC(){return PE()&&document.documentMode===10}function Mw(n=dr()){return ty(n)||Cw(n)||Aw(n)||Rw(n)||/windows phone/i.test(n)||Nw(n)}function Iw(n,e=[]){let t;switch(n){case"Browser":t=nx(dr());break;case"Worker":t=`${nx(dr())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${ol}/${i}`}class _C{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=u=>new Promise((d,p)=>{try{const g=e(u);d(g)}catch(g){p(g)}});i.onAbort=t,this.queue.push(i);const l=this.queue.length-1;return()=>{this.queue[l]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const l of t)try{l()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function kC(n,e={}){return Ci(n,"GET","/v2/passwordPolicy",Ni(n,e))}const jC=6;class TC{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??jC,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,l=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),l&&(t.meetsMaxPasswordLength=e.length<=l)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let l=0;l<e.length;l++)i=e.charAt(l),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,l,u){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=l)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=u))}}class SC{constructor(e,t,i,l){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=l,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new rx(this),this.idTokenSubscription=new rx(this),this.beforeStateQueue=new _C(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=bw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=l.sdkClientVersion,this._persistenceManagerAvailable=new Promise(u=>this._resolvePersistenceManagerAvailable=u)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=yi(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Xl.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Lh(this,{idToken:e}),i=await wa._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Wr(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=this.redirectUser?._redirectEventId,d=i?._redirectEventId,p=await this.tryRedirectSignIn(e);(!u||u===d)&&p?.user&&(i=p.user,l=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Xt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Oh(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=rC()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Wr(this.app))return Promise.reject(wi(this));const t=e?Qs(e):null;return t&&Xt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Xt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Wr(this.app)?Promise.reject(wi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Wr(this.app)?Promise.reject(wi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(yi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await kC(this),t=new TC(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Bu("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await vC(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&yi(e)||this._popupRedirectResolver;Xt(t,this,"argument-error"),this.redirectPersistenceManager=await Xl.create(this,[yi(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,l){if(this._deleted)return()=>{};const u=typeof t=="function"?t:t.next.bind(t);let d=!1;const p=this._isInitialized?Promise.resolve():this._initializationPromise;if(Xt(p,this,"internal-error"),p.then(()=>{d||u(this.currentUser)}),typeof t=="function"){const g=e.addObserver(t,i,l);return()=>{d=!0,g()}}else{const g=e.addObserver(t);return()=>{d=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Xt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Iw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Wr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&tC(`Error while retrieving App Check token: ${e.error}`),e?.token}}function ko(n){return Qs(n)}class rx{constructor(e){this.auth=e,this.observer=null,this.addObserver=qE(t=>this.observer=t)}get next(){return Xt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let rm={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function EC(n){rm=n}function Dw(n){return rm.loadJS(n)}function NC(){return rm.recaptchaEnterpriseScript}function CC(){return rm.gapiScript}function RC(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class AC{constructor(){this.enterprise=new MC}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class MC{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const IC="recaptcha-enterprise",Pw="NO_RECAPTCHA";class DC{constructor(e){this.type=IC,this.auth=ko(e)}async verify(e="verify",t=!1){async function i(u){if(!t){if(u.tenantId==null&&u._agentRecaptchaConfig!=null)return u._agentRecaptchaConfig.siteKey;if(u.tenantId!=null&&u._tenantRecaptchaConfigs[u.tenantId]!==void 0)return u._tenantRecaptchaConfigs[u.tenantId].siteKey}return new Promise(async(d,p)=>{dC(u,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)p(new Error("recaptcha Enterprise site key undefined"));else{const y=new uC(g);return u.tenantId==null?u._agentRecaptchaConfig=y:u._tenantRecaptchaConfigs[u.tenantId]=y,d(y.siteKey)}}).catch(g=>{p(g)})})}function l(u,d,p){const g=window.grecaptcha;Z1(g)?g.enterprise.ready(()=>{g.enterprise.execute(u,{action:e}).then(y=>{d(y)}).catch(()=>{d(Pw)})}):p(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new AC().execute("siteKey",{action:"verify"}):new Promise((u,d)=>{i(this.auth).then(p=>{if(!t&&Z1(window.grecaptcha))l(p,u,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let g=NC();g.length!==0&&(g+=p),Dw(g).then(()=>{l(p,u,d)}).catch(y=>{d(y)})}}).catch(p=>{d(p)})})}}async function ax(n,e,t,i=!1,l=!1){const u=new DC(n);let d;if(l)d=Pw;else try{d=await u.verify(t)}catch{d=await u.verify(t,!0)}const p={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in p){const g=p.phoneEnrollmentInfo.phoneNumber,y=p.phoneEnrollmentInfo.recaptchaToken;Object.assign(p,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:y,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in p){const g=p.phoneSignInInfo.recaptchaToken;Object.assign(p,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return p}return i?Object.assign(p,{captchaResp:d}):Object.assign(p,{captchaResponse:d}),Object.assign(p,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(p,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),p}async function Bh(n,e,t,i,l){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await ax(n,e,t,t==="getOobCode");return i(n,u)}else return i(n,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await ax(n,e,t,t==="getOobCode");return i(n,d)}else return Promise.reject(u)})}function PC(n,e){const t=nm(n,"auth");if(t.isInitialized()){const l=t.getImmediate(),u=t.getOptions();if(Zo(u,e??{}))return l;ka(l,"already-initialized")}return t.initialize({options:e})}function LC(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(yi);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function OC(n,e,t){const i=ko(n);Xt(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const l=!1,u=Lw(e),{host:d,port:p}=BC(e),g=p===null?"":`:${p}`,y={url:`${u}//${d}${g}/`},x=Object.freeze({host:d,port:p,protocol:u.replace(":",""),options:Object.freeze({disableWarnings:l})});if(!i._canInitEmulator){Xt(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Xt(Zo(y,i.config.emulator)&&Zo(x,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=y,i.emulatorConfig=x,i.settings.appVerificationDisabledForTesting=!0,_o(d)?(Wg(`${u}//${d}${g}`),Gg("Auth",!0)):VC()}function Lw(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function BC(n){const e=Lw(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",l=/^(\[[^\]]+\])(:|$)/.exec(i);if(l){const u=l[1];return{host:u,port:ix(i.substr(u.length+1))}}else{const[u,d]=i.split(":");return{host:u,port:ix(d)}}}function ix(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function VC(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class sy{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return gi("not implemented")}_getIdTokenResponse(e){return gi("not implemented")}_linkToIdToken(e,t){return gi("not implemented")}_getReauthenticationResolver(e){return gi("not implemented")}}async function UC(n,e){return Ci(n,"POST","/v1/accounts:signUp",e)}async function FC(n,e){return Fu(n,"POST","/v1/accounts:signInWithPassword",Ni(n,e))}async function Ow(n,e){return Ci(n,"POST","/v1/accounts:sendOobCode",Ni(n,e))}async function zC(n,e){return Ow(n,e)}async function qC(n,e){return Ow(n,e)}async function HC(n,e){return Fu(n,"POST","/v1/accounts:signInWithEmailLink",Ni(n,e))}async function $C(n,e){return Fu(n,"POST","/v1/accounts:signInWithEmailLink",Ni(n,e))}class Tu extends sy{constructor(e,t,i,l=null){super("password",i),this._email=e,this._password=t,this._tenantId=l}static _fromEmailAndPassword(e,t){return new Tu(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new Tu(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Bh(e,t,"signInWithPassword",FC);case"emailLink":return HC(e,{email:this._email,oobCode:this._password});default:ka(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Bh(e,i,"signUpPassword",UC);case"emailLink":return $C(e,{idToken:t,email:this._email,oobCode:this._password});default:ka(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Jl(n,e){return Fu(n,"POST","/v1/accounts:signInWithIdp",Ni(n,e))}const WC="http://localhost";class tl extends sy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new tl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ka("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:l,...u}=t;if(!i||!l)return null;const d=new tl(i,l);return d.idToken=u.idToken||void 0,d.accessToken=u.accessToken||void 0,d.secret=u.secret,d.nonce=u.nonce,d.pendingToken=u.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Jl(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Jl(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Jl(e,t)}buildRequest(){const e={requestUri:WC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Vu(t)}return e}}function GC(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function KC(n){const e=cu(uu(n)).link,t=e?cu(uu(e)).deep_link_id:null,i=cu(uu(n)).deep_link_id;return(i?cu(uu(i)).link:null)||i||t||e||n}class ny{constructor(e){const t=cu(uu(e)),i=t.apiKey??null,l=t.oobCode??null,u=GC(t.mode??null);Xt(i&&l&&u,"argument-error"),this.apiKey=i,this.operation=u,this.code=l,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=KC(e);try{return new ny(t)}catch{return null}}}class dc{constructor(){this.providerId=dc.PROVIDER_ID}static credential(e,t){return Tu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=ny.parseLink(t);return Xt(i,"argument-error"),Tu._fromEmailAndCode(e,i.code,i.tenantId)}}dc.PROVIDER_ID="password";dc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";dc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Bw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class zu extends Bw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class no extends zu{constructor(){super("facebook.com")}static credential(e){return tl._fromParams({providerId:no.PROVIDER_ID,signInMethod:no.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return no.credentialFromTaggedObject(e)}static credentialFromError(e){return no.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return no.credential(e.oauthAccessToken)}catch{return null}}}no.FACEBOOK_SIGN_IN_METHOD="facebook.com";no.PROVIDER_ID="facebook.com";class ro extends zu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return tl._fromParams({providerId:ro.PROVIDER_ID,signInMethod:ro.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ro.credentialFromTaggedObject(e)}static credentialFromError(e){return ro.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return ro.credential(t,i)}catch{return null}}}ro.GOOGLE_SIGN_IN_METHOD="google.com";ro.PROVIDER_ID="google.com";class ao extends zu{constructor(){super("github.com")}static credential(e){return tl._fromParams({providerId:ao.PROVIDER_ID,signInMethod:ao.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ao.credentialFromTaggedObject(e)}static credentialFromError(e){return ao.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ao.credential(e.oauthAccessToken)}catch{return null}}}ao.GITHUB_SIGN_IN_METHOD="github.com";ao.PROVIDER_ID="github.com";class io extends zu{constructor(){super("twitter.com")}static credential(e,t){return tl._fromParams({providerId:io.PROVIDER_ID,signInMethod:io.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return io.credentialFromTaggedObject(e)}static credentialFromError(e){return io.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return io.credential(t,i)}catch{return null}}}io.TWITTER_SIGN_IN_METHOD="twitter.com";io.PROVIDER_ID="twitter.com";async function YC(n,e){return Fu(n,"POST","/v1/accounts:signUp",Ni(n,e))}class sl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,l=!1){const u=await wa._fromIdTokenResponse(e,i,l),d=ox(i);return new sl({user:u,providerId:d,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const l=ox(i);return new sl({user:e,providerId:l,_tokenResponse:i,operationType:t})}}function ox(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Vh extends Xa{constructor(e,t,i,l){super(t.code,t.message),this.operationType=i,this.user=l,Object.setPrototypeOf(this,Vh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,l){return new Vh(e,t,i,l)}}function Vw(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(u=>{throw u.code==="auth/multi-factor-auth-required"?Vh._fromErrorAndOperation(n,u,e,i):u})}async function QC(n,e,t=!1){const i=await ju(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return sl._forOperation(n,"link",i)}async function XC(n,e,t=!1){const{auth:i}=n;if(Wr(i.app))return Promise.reject(wi(i));const l="reauthenticate";try{const u=await ju(n,Vw(i,l,e,n),t);Xt(u.idToken,i,"internal-error");const d=ey(u.idToken);Xt(d,i,"internal-error");const{sub:p}=d;return Xt(n.uid===p,i,"user-mismatch"),sl._forOperation(n,l,u)}catch(u){throw u?.code==="auth/user-not-found"&&ka(i,"user-mismatch"),u}}async function Uw(n,e,t=!1){if(Wr(n.app))return Promise.reject(wi(n));const i="signIn",l=await Vw(n,i,e),u=await sl._fromIdTokenResponse(n,i,l);return t||await n._updateCurrentUser(u.user),u}async function JC(n,e){return Uw(ko(n),e)}async function Fw(n){const e=ko(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function ZC(n,e,t){const i=ko(n);await Bh(i,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",qC)}async function e4(n,e,t){if(Wr(n.app))return Promise.reject(wi(n));const i=ko(n),d=await Bh(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",YC).catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&Fw(n),g}),p=await sl._fromIdTokenResponse(i,"signIn",d);return await i._updateCurrentUser(p.user),p}function t4(n,e,t){return Wr(n.app)?Promise.reject(wi(n)):JC(Qs(n),dc.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&Fw(n),i})}async function gP(n,e){const t=Qs(n),l={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()},{email:u}=await zC(t.auth,l);u!==n.email&&await n.reload()}function lx(n,e){return Qs(n).setPersistence(e)}function s4(n,e,t,i){return Qs(n).onIdTokenChanged(e,t,i)}function n4(n,e,t){return Qs(n).beforeAuthStateChanged(e,t)}function r4(n,e,t,i){return Qs(n).onAuthStateChanged(e,t,i)}function a4(n){return Qs(n).signOut()}const Uh="__sak";class zw{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Uh,"1"),this.storage.removeItem(Uh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const i4=1e3,o4=10;class qw extends zw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Mw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),l=this.localCache[t];i!==l&&e(t,l,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,p,g)=>{this.notifyListeners(d,g)});return}const i=e.key;t?this.detachListener():this.stopPolling();const l=()=>{const d=this.storage.getItem(i);!t&&this.localCache[i]===d||this.notifyListeners(i,d)},u=this.storage.getItem(i);wC()&&u!==e.newValue&&e.newValue!==e.oldValue?setTimeout(l,o4):l()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},i4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}qw.type="LOCAL";const gg=qw;class Hw extends zw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Hw.type="SESSION";const ry=Hw;function l4(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class am{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(l=>l.isListeningto(e));if(t)return t;const i=new am(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:l,data:u}=t.data,d=this.handlersMap[l];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:l});const p=Array.from(d).map(async y=>y(t.origin,u)),g=await l4(p);t.ports[0].postMessage({status:"done",eventId:i,eventType:l,response:g})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}am.receivers=[];function ay(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class c4{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const l=typeof MessageChannel<"u"?new MessageChannel:null;if(!l)throw new Error("connection_unavailable");let u,d;return new Promise((p,g)=>{const y=ay("",20);l.port1.start();const x=setTimeout(()=>{g(new Error("unsupported_event"))},i);d={messageChannel:l,onMessage(_){const j=_;if(j.data.eventId===y)switch(j.data.status){case"ack":clearTimeout(x),u=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),p(j.data.response);break;default:clearTimeout(x),clearTimeout(u),g(new Error("invalid_response"));break}}},this.handlers.add(d),l.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:y,data:t},[l.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}function $a(){return window}function u4(n){$a().location.href=n}function $w(){return typeof $a().WorkerGlobalScope<"u"&&typeof $a().importScripts=="function"}async function d4(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function h4(){return navigator?.serviceWorker?.controller||null}function m4(){return $w()?self:null}const Ww="firebaseLocalStorageDb",f4=1,Fh="firebaseLocalStorage",Gw="fbase_key";class qu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function im(n,e){return n.transaction([Fh],e?"readwrite":"readonly").objectStore(Fh)}function p4(){const n=indexedDB.deleteDatabase(Ww);return new qu(n).toPromise()}function yg(){const n=indexedDB.open(Ww,f4);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Fh,{keyPath:Gw})}catch(l){t(l)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Fh)?e(i):(i.close(),await p4(),e(await yg()))})})}async function cx(n,e,t){const i=im(n,!0).put({[Gw]:e,value:t});return new qu(i).toPromise()}async function g4(n,e){const t=im(n,!1).get(e),i=await new qu(t).toPromise();return i===void 0?null:i.value}function ux(n,e){const t=im(n,!0).delete(e);return new qu(t).toPromise()}const y4=800,b4=3;class Kw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await yg(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>b4)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return $w()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=am._getInstance(m4()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await d4(),!this.activeServiceWorker)return;this.sender=new c4(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||h4()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await yg();return await cx(e,Uh,"1"),await ux(e,Uh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>cx(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>g4(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>ux(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(l=>{const u=im(l,!1).getAll();return new qu(u).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:l,value:u}of e)i.add(l),JSON.stringify(this.localCache[l])!==JSON.stringify(u)&&(this.notifyListeners(l,u),t.push(l));for(const l of Object.keys(this.localCache))this.localCache[l]&&!i.has(l)&&(this.notifyListeners(l,null),t.push(l));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),y4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Kw.type="LOCAL";const v4=Kw;new Uu(3e4,6e4);function x4(n,e){return e?yi(e):(Xt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class iy extends sy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Jl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Jl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Jl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function w4(n){return Uw(n.auth,new iy(n),n.bypassAuthState)}function _4(n){const{auth:e,user:t}=n;return Xt(t,e,"internal-error"),XC(t,new iy(n),n.bypassAuthState)}async function k4(n){const{auth:e,user:t}=n;return Xt(t,e,"internal-error"),QC(t,new iy(n),n.bypassAuthState)}class Yw{constructor(e,t,i,l,u=!1){this.auth=e,this.resolver=i,this.user=l,this.bypassAuthState=u,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:l,tenantId:u,error:d,type:p}=e;if(d){this.reject(d);return}const g={auth:this.auth,requestUri:t,sessionId:i,tenantId:u||void 0,postBody:l||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(p)(g))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return w4;case"linkViaPopup":case"linkViaRedirect":return k4;case"reauthViaPopup":case"reauthViaRedirect":return _4;default:ka(this.auth,"internal-error")}}resolve(e){Ti(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ti(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const j4=new Uu(2e3,1e4);class Yl extends Yw{constructor(e,t,i,l,u){super(e,t,l,u),this.provider=i,this.authWindow=null,this.pollId=null,Yl.currentPopupAction&&Yl.currentPopupAction.cancel(),Yl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Xt(e,this.auth,"internal-error"),e}async onExecution(){Ti(this.filter.length===1,"Popup operations only handle one event");const e=ay();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ha(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Ha(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Yl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ha(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,j4.get())};e()}}Yl.currentPopupAction=null;const T4="pendingRedirect",kh=new Map;class S4 extends Yw{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=kh.get(this.auth._key());if(!e){try{const i=await E4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}kh.set(this.auth._key(),e)}return this.bypassAuthState||kh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function E4(n,e){const t=R4(e),i=C4(n);if(!await i._isAvailable())return!1;const l=await i._get(t)==="true";return await i._remove(t),l}function N4(n,e){kh.set(n._key(),e)}function C4(n){return yi(n._redirectPersistence)}function R4(n){return _h(T4,n.config.apiKey,n.name)}async function A4(n,e,t=!1){if(Wr(n.app))return Promise.reject(wi(n));const i=ko(n),l=x4(i,e),d=await new S4(i,l,t).execute();return d&&!t&&(delete d.user._redirectEventId,await i._persistUserIfCurrent(d.user),await i._setRedirectUser(null,e)),d}const M4=600*1e3;class I4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!D4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Qw(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Ha(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=M4&&this.cachedEventUids.clear(),this.cachedEventUids.has(dx(e))}saveEventToCache(e){this.cachedEventUids.add(dx(e)),this.lastProcessedEventTime=Date.now()}}function dx(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Qw({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function D4(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Qw(n);default:return!1}}async function P4(n,e={}){return Ci(n,"GET","/v1/projects",e)}const L4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,O4=/^https?/;async function B4(n){if(n.config.emulator)return;const{authorizedDomains:e}=await P4(n);for(const t of e)try{if(V4(t))return}catch{}ka(n,"unauthorized-domain")}function V4(n){const e=fg(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===i}if(!O4.test(t))return!1;if(L4.test(n))return i===n;const l=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+l+"|"+l+")$","i").test(i)}const U4=new Uu(3e4,6e4);function hx(){const n=$a().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function F4(n){return new Promise((e,t)=>{function i(){hx(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{hx(),t(Ha(n,"network-request-failed"))},timeout:U4.get()})}if($a().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if($a().gapi?.load)i();else{const l=RC("iframefcb");return $a()[l]=()=>{gapi.load?i():t(Ha(n,"network-request-failed"))},Dw(`${CC()}?onload=${l}`).catch(u=>t(u))}}).catch(e=>{throw jh=null,e})}let jh=null;function z4(n){return jh=jh||F4(n),jh}const q4=new Uu(5e3,15e3),H4="__/auth/iframe",$4="emulator/auth/iframe",W4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},G4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function K4(n){const e=n.config;Xt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Zg(e,$4):`https://${n.config.authDomain}/${H4}`,i={apiKey:e.apiKey,appName:n.name,v:ol},l=G4.get(n.config.apiHost);l&&(i.eid=l);const u=n._getFrameworks();return u.length&&(i.fw=u.join(",")),`${t}?${Vu(i).slice(1)}`}async function Y4(n){const e=await z4(n),t=$a().gapi;return Xt(t,n,"internal-error"),e.open({where:document.body,url:K4(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:W4,dontclear:!0},i=>new Promise(async(l,u)=>{await i.restyle({setHideOnLeave:!1});const d=Ha(n,"network-request-failed"),p=$a().setTimeout(()=>{u(d)},q4.get());function g(){$a().clearTimeout(p),l(i)}i.ping(g).then(g,()=>{u(d)})}))}const Q4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},X4=500,J4=600,Z4="_blank",eR="http://localhost";class mx{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function tR(n,e,t,i=X4,l=J4){const u=Math.max((window.screen.availHeight-l)/2,0).toString(),d=Math.max((window.screen.availWidth-i)/2,0).toString();let p="";const g={...Q4,width:i.toString(),height:l.toString(),top:u,left:d},y=dr().toLowerCase();t&&(p=Ew(y)?Z4:t),Tw(y)&&(e=e||eR,g.scrollbars="yes");const x=Object.entries(g).reduce((j,[O,K])=>`${j}${O}=${K},`,"");if(xC(y)&&p!=="_self")return sR(e||"",p),new mx(null);const _=window.open(e||"",p,x);Xt(_,n,"popup-blocked");try{_.focus()}catch{}return new mx(_)}function sR(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const nR="__/auth/handler",rR="emulator/auth/handler",aR=encodeURIComponent("fac");async function fx(n,e,t,i,l,u){Xt(n.config.authDomain,n,"auth-domain-config-required"),Xt(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:ol,eventId:l};if(e instanceof Bw){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",zE(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[x,_]of Object.entries({}))d[x]=_}if(e instanceof zu){const x=e.getScopes().filter(_=>_!=="");x.length>0&&(d.scopes=x.join(","))}n.tenantId&&(d.tid=n.tenantId);const p=d;for(const x of Object.keys(p))p[x]===void 0&&delete p[x];const g=await n._getAppCheckToken(),y=g?`#${aR}=${encodeURIComponent(g)}`:"";return`${iR(n)}?${Vu(p).slice(1)}${y}`}function iR({config:n}){return n.emulator?Zg(n,rR):`https://${n.authDomain}/${nR}`}const Lp="webStorageSupport";class oR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ry,this._completeRedirectFn=A4,this._overrideRedirectResult=N4}async _openPopup(e,t,i,l){Ti(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const u=await fx(e,t,i,fg(),l);return tR(e,u,ay())}async _openRedirect(e,t,i,l){await this._originValidation(e);const u=await fx(e,t,i,fg(),l);return u4(u),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:l,promise:u}=this.eventManagers[t];return l?Promise.resolve(l):(Ti(u,"If manager is not set, promise should be"),u)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await Y4(e),i=new I4(e);return t.register("authEvent",l=>(Xt(l?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(l.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Lp,{type:Lp},l=>{const u=l?.[0]?.[Lp];u!==void 0&&t(!!u),ka(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=B4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Mw()||Sw()||ty()}}const lR=oR;var px="@firebase/auth",gx="1.12.0";class cR{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Xt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function uR(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function dR(n){el(new po("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),l=e.getProvider("heartbeat"),u=e.getProvider("app-check-internal"),{apiKey:d,authDomain:p}=i.options;Xt(d&&!d.includes(":"),"invalid-api-key",{appName:i.name});const g={apiKey:d,authDomain:p,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Iw(n)},y=new SC(i,l,u,g);return LC(y,t),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),el(new po("auth-internal",e=>{const t=ko(e.getProvider("auth").getImmediate());return(i=>new cR(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),qa(px,gx,uR(n)),qa(px,gx,"esm2020")}const hR=300,mR=dw("authIdTokenMaxAge")||hR;let yx=null;const fR=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>mR)return;const l=t?.token;yx!==l&&(yx=l,await fetch(n,{method:l?"POST":"DELETE",headers:l?{Authorization:`Bearer ${l}`}:{}}))};function Xw(n=Xg()){const e=nm(n,"auth");if(e.isInitialized())return e.getImmediate();const t=PC(n,{popupRedirectResolver:lR,persistence:[v4,gg,ry]}),i=dw("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const u=new URL(i,location.origin);if(location.origin===u.origin){const d=fR(u.toString());n4(t,d,()=>d(t.currentUser)),s4(t,p=>d(p))}}const l=lw("auth");return l&&OC(t,`http://${l}`),t}function pR(){return document.getElementsByTagName("head")?.[0]??document}EC({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=l=>{const u=Ha("internal-error");u.customData=l,t(u)},i.type="text/javascript",i.charset="UTF-8",pR().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});dR("Browser");var bx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ho,Jw;(function(){var n;function e(C,T){function M(){}M.prototype=T.prototype,C.F=T.prototype,C.prototype=new M,C.prototype.constructor=C,C.D=function(V,I,L){for(var A=Array(arguments.length-2),Oe=2;Oe<arguments.length;Oe++)A[Oe-2]=arguments[Oe];return T.prototype[I].apply(V,A)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function l(C,T,M){M||(M=0);const V=Array(16);if(typeof T=="string")for(var I=0;I<16;++I)V[I]=T.charCodeAt(M++)|T.charCodeAt(M++)<<8|T.charCodeAt(M++)<<16|T.charCodeAt(M++)<<24;else for(I=0;I<16;++I)V[I]=T[M++]|T[M++]<<8|T[M++]<<16|T[M++]<<24;T=C.g[0],M=C.g[1],I=C.g[2];let L=C.g[3],A;A=T+(L^M&(I^L))+V[0]+3614090360&4294967295,T=M+(A<<7&4294967295|A>>>25),A=L+(I^T&(M^I))+V[1]+3905402710&4294967295,L=T+(A<<12&4294967295|A>>>20),A=I+(M^L&(T^M))+V[2]+606105819&4294967295,I=L+(A<<17&4294967295|A>>>15),A=M+(T^I&(L^T))+V[3]+3250441966&4294967295,M=I+(A<<22&4294967295|A>>>10),A=T+(L^M&(I^L))+V[4]+4118548399&4294967295,T=M+(A<<7&4294967295|A>>>25),A=L+(I^T&(M^I))+V[5]+1200080426&4294967295,L=T+(A<<12&4294967295|A>>>20),A=I+(M^L&(T^M))+V[6]+2821735955&4294967295,I=L+(A<<17&4294967295|A>>>15),A=M+(T^I&(L^T))+V[7]+4249261313&4294967295,M=I+(A<<22&4294967295|A>>>10),A=T+(L^M&(I^L))+V[8]+1770035416&4294967295,T=M+(A<<7&4294967295|A>>>25),A=L+(I^T&(M^I))+V[9]+2336552879&4294967295,L=T+(A<<12&4294967295|A>>>20),A=I+(M^L&(T^M))+V[10]+4294925233&4294967295,I=L+(A<<17&4294967295|A>>>15),A=M+(T^I&(L^T))+V[11]+2304563134&4294967295,M=I+(A<<22&4294967295|A>>>10),A=T+(L^M&(I^L))+V[12]+1804603682&4294967295,T=M+(A<<7&4294967295|A>>>25),A=L+(I^T&(M^I))+V[13]+4254626195&4294967295,L=T+(A<<12&4294967295|A>>>20),A=I+(M^L&(T^M))+V[14]+2792965006&4294967295,I=L+(A<<17&4294967295|A>>>15),A=M+(T^I&(L^T))+V[15]+1236535329&4294967295,M=I+(A<<22&4294967295|A>>>10),A=T+(I^L&(M^I))+V[1]+4129170786&4294967295,T=M+(A<<5&4294967295|A>>>27),A=L+(M^I&(T^M))+V[6]+3225465664&4294967295,L=T+(A<<9&4294967295|A>>>23),A=I+(T^M&(L^T))+V[11]+643717713&4294967295,I=L+(A<<14&4294967295|A>>>18),A=M+(L^T&(I^L))+V[0]+3921069994&4294967295,M=I+(A<<20&4294967295|A>>>12),A=T+(I^L&(M^I))+V[5]+3593408605&4294967295,T=M+(A<<5&4294967295|A>>>27),A=L+(M^I&(T^M))+V[10]+38016083&4294967295,L=T+(A<<9&4294967295|A>>>23),A=I+(T^M&(L^T))+V[15]+3634488961&4294967295,I=L+(A<<14&4294967295|A>>>18),A=M+(L^T&(I^L))+V[4]+3889429448&4294967295,M=I+(A<<20&4294967295|A>>>12),A=T+(I^L&(M^I))+V[9]+568446438&4294967295,T=M+(A<<5&4294967295|A>>>27),A=L+(M^I&(T^M))+V[14]+3275163606&4294967295,L=T+(A<<9&4294967295|A>>>23),A=I+(T^M&(L^T))+V[3]+4107603335&4294967295,I=L+(A<<14&4294967295|A>>>18),A=M+(L^T&(I^L))+V[8]+1163531501&4294967295,M=I+(A<<20&4294967295|A>>>12),A=T+(I^L&(M^I))+V[13]+2850285829&4294967295,T=M+(A<<5&4294967295|A>>>27),A=L+(M^I&(T^M))+V[2]+4243563512&4294967295,L=T+(A<<9&4294967295|A>>>23),A=I+(T^M&(L^T))+V[7]+1735328473&4294967295,I=L+(A<<14&4294967295|A>>>18),A=M+(L^T&(I^L))+V[12]+2368359562&4294967295,M=I+(A<<20&4294967295|A>>>12),A=T+(M^I^L)+V[5]+4294588738&4294967295,T=M+(A<<4&4294967295|A>>>28),A=L+(T^M^I)+V[8]+2272392833&4294967295,L=T+(A<<11&4294967295|A>>>21),A=I+(L^T^M)+V[11]+1839030562&4294967295,I=L+(A<<16&4294967295|A>>>16),A=M+(I^L^T)+V[14]+4259657740&4294967295,M=I+(A<<23&4294967295|A>>>9),A=T+(M^I^L)+V[1]+2763975236&4294967295,T=M+(A<<4&4294967295|A>>>28),A=L+(T^M^I)+V[4]+1272893353&4294967295,L=T+(A<<11&4294967295|A>>>21),A=I+(L^T^M)+V[7]+4139469664&4294967295,I=L+(A<<16&4294967295|A>>>16),A=M+(I^L^T)+V[10]+3200236656&4294967295,M=I+(A<<23&4294967295|A>>>9),A=T+(M^I^L)+V[13]+681279174&4294967295,T=M+(A<<4&4294967295|A>>>28),A=L+(T^M^I)+V[0]+3936430074&4294967295,L=T+(A<<11&4294967295|A>>>21),A=I+(L^T^M)+V[3]+3572445317&4294967295,I=L+(A<<16&4294967295|A>>>16),A=M+(I^L^T)+V[6]+76029189&4294967295,M=I+(A<<23&4294967295|A>>>9),A=T+(M^I^L)+V[9]+3654602809&4294967295,T=M+(A<<4&4294967295|A>>>28),A=L+(T^M^I)+V[12]+3873151461&4294967295,L=T+(A<<11&4294967295|A>>>21),A=I+(L^T^M)+V[15]+530742520&4294967295,I=L+(A<<16&4294967295|A>>>16),A=M+(I^L^T)+V[2]+3299628645&4294967295,M=I+(A<<23&4294967295|A>>>9),A=T+(I^(M|~L))+V[0]+4096336452&4294967295,T=M+(A<<6&4294967295|A>>>26),A=L+(M^(T|~I))+V[7]+1126891415&4294967295,L=T+(A<<10&4294967295|A>>>22),A=I+(T^(L|~M))+V[14]+2878612391&4294967295,I=L+(A<<15&4294967295|A>>>17),A=M+(L^(I|~T))+V[5]+4237533241&4294967295,M=I+(A<<21&4294967295|A>>>11),A=T+(I^(M|~L))+V[12]+1700485571&4294967295,T=M+(A<<6&4294967295|A>>>26),A=L+(M^(T|~I))+V[3]+2399980690&4294967295,L=T+(A<<10&4294967295|A>>>22),A=I+(T^(L|~M))+V[10]+4293915773&4294967295,I=L+(A<<15&4294967295|A>>>17),A=M+(L^(I|~T))+V[1]+2240044497&4294967295,M=I+(A<<21&4294967295|A>>>11),A=T+(I^(M|~L))+V[8]+1873313359&4294967295,T=M+(A<<6&4294967295|A>>>26),A=L+(M^(T|~I))+V[15]+4264355552&4294967295,L=T+(A<<10&4294967295|A>>>22),A=I+(T^(L|~M))+V[6]+2734768916&4294967295,I=L+(A<<15&4294967295|A>>>17),A=M+(L^(I|~T))+V[13]+1309151649&4294967295,M=I+(A<<21&4294967295|A>>>11),A=T+(I^(M|~L))+V[4]+4149444226&4294967295,T=M+(A<<6&4294967295|A>>>26),A=L+(M^(T|~I))+V[11]+3174756917&4294967295,L=T+(A<<10&4294967295|A>>>22),A=I+(T^(L|~M))+V[2]+718787259&4294967295,I=L+(A<<15&4294967295|A>>>17),A=M+(L^(I|~T))+V[9]+3951481745&4294967295,C.g[0]=C.g[0]+T&4294967295,C.g[1]=C.g[1]+(I+(A<<21&4294967295|A>>>11))&4294967295,C.g[2]=C.g[2]+I&4294967295,C.g[3]=C.g[3]+L&4294967295}i.prototype.v=function(C,T){T===void 0&&(T=C.length);const M=T-this.blockSize,V=this.C;let I=this.h,L=0;for(;L<T;){if(I==0)for(;L<=M;)l(this,C,L),L+=this.blockSize;if(typeof C=="string"){for(;L<T;)if(V[I++]=C.charCodeAt(L++),I==this.blockSize){l(this,V),I=0;break}}else for(;L<T;)if(V[I++]=C[L++],I==this.blockSize){l(this,V),I=0;break}}this.h=I,this.o+=T},i.prototype.A=function(){var C=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);C[0]=128;for(var T=1;T<C.length-8;++T)C[T]=0;T=this.o*8;for(var M=C.length-8;M<C.length;++M)C[M]=T&255,T/=256;for(this.v(C),C=Array(16),T=0,M=0;M<4;++M)for(let V=0;V<32;V+=8)C[T++]=this.g[M]>>>V&255;return C};function u(C,T){var M=p;return Object.prototype.hasOwnProperty.call(M,C)?M[C]:M[C]=T(C)}function d(C,T){this.h=T;const M=[];let V=!0;for(let I=C.length-1;I>=0;I--){const L=C[I]|0;V&&L==T||(M[I]=L,V=!1)}this.g=M}var p={};function g(C){return-128<=C&&C<128?u(C,function(T){return new d([T|0],T<0?-1:0)}):new d([C|0],C<0?-1:0)}function y(C){if(isNaN(C)||!isFinite(C))return _;if(C<0)return D(y(-C));const T=[];let M=1;for(let V=0;C>=M;V++)T[V]=C/M|0,M*=4294967296;return new d(T,0)}function x(C,T){if(C.length==0)throw Error("number format error: empty string");if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(C.charAt(0)=="-")return D(x(C.substring(1),T));if(C.indexOf("-")>=0)throw Error('number format error: interior "-" character');const M=y(Math.pow(T,8));let V=_;for(let L=0;L<C.length;L+=8){var I=Math.min(8,C.length-L);const A=parseInt(C.substring(L,L+I),T);I<8?(I=y(Math.pow(T,I)),V=V.j(I).add(y(A))):(V=V.j(M),V=V.add(y(A)))}return V}var _=g(0),j=g(1),O=g(16777216);n=d.prototype,n.m=function(){if(B(this))return-D(this).m();let C=0,T=1;for(let M=0;M<this.g.length;M++){const V=this.i(M);C+=(V>=0?V:4294967296+V)*T,T*=4294967296}return C},n.toString=function(C){if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(K(this))return"0";if(B(this))return"-"+D(this).toString(C);const T=y(Math.pow(C,6));var M=this;let V="";for(;;){const I=je(M,T).g;M=se(M,I.j(T));let L=((M.g.length>0?M.g[0]:M.h)>>>0).toString(C);if(M=I,K(M))return L+V;for(;L.length<6;)L="0"+L;V=L+V}},n.i=function(C){return C<0?0:C<this.g.length?this.g[C]:this.h};function K(C){if(C.h!=0)return!1;for(let T=0;T<C.g.length;T++)if(C.g[T]!=0)return!1;return!0}function B(C){return C.h==-1}n.l=function(C){return C=se(this,C),B(C)?-1:K(C)?0:1};function D(C){const T=C.g.length,M=[];for(let V=0;V<T;V++)M[V]=~C.g[V];return new d(M,~C.h).add(j)}n.abs=function(){return B(this)?D(this):this},n.add=function(C){const T=Math.max(this.g.length,C.g.length),M=[];let V=0;for(let I=0;I<=T;I++){let L=V+(this.i(I)&65535)+(C.i(I)&65535),A=(L>>>16)+(this.i(I)>>>16)+(C.i(I)>>>16);V=A>>>16,L&=65535,A&=65535,M[I]=A<<16|L}return new d(M,M[M.length-1]&-2147483648?-1:0)};function se(C,T){return C.add(D(T))}n.j=function(C){if(K(this)||K(C))return _;if(B(this))return B(C)?D(this).j(D(C)):D(D(this).j(C));if(B(C))return D(this.j(D(C)));if(this.l(O)<0&&C.l(O)<0)return y(this.m()*C.m());const T=this.g.length+C.g.length,M=[];for(var V=0;V<2*T;V++)M[V]=0;for(V=0;V<this.g.length;V++)for(let I=0;I<C.g.length;I++){const L=this.i(V)>>>16,A=this.i(V)&65535,Oe=C.i(I)>>>16,ht=C.i(I)&65535;M[2*V+2*I]+=A*ht,Y(M,2*V+2*I),M[2*V+2*I+1]+=L*ht,Y(M,2*V+2*I+1),M[2*V+2*I+1]+=A*Oe,Y(M,2*V+2*I+1),M[2*V+2*I+2]+=L*Oe,Y(M,2*V+2*I+2)}for(C=0;C<T;C++)M[C]=M[2*C+1]<<16|M[2*C];for(C=T;C<2*T;C++)M[C]=0;return new d(M,0)};function Y(C,T){for(;(C[T]&65535)!=C[T];)C[T+1]+=C[T]>>>16,C[T]&=65535,T++}function Z(C,T){this.g=C,this.h=T}function je(C,T){if(K(T))throw Error("division by zero");if(K(C))return new Z(_,_);if(B(C))return T=je(D(C),T),new Z(D(T.g),D(T.h));if(B(T))return T=je(C,D(T)),new Z(D(T.g),T.h);if(C.g.length>30){if(B(C)||B(T))throw Error("slowDivide_ only works with positive integers.");for(var M=j,V=T;V.l(C)<=0;)M=Re(M),V=Re(V);var I=ke(M,1),L=ke(V,1);for(V=ke(V,2),M=ke(M,2);!K(V);){var A=L.add(V);A.l(C)<=0&&(I=I.add(M),L=A),V=ke(V,1),M=ke(M,1)}return T=se(C,I.j(T)),new Z(I,T)}for(I=_;C.l(T)>=0;){for(M=Math.max(1,Math.floor(C.m()/T.m())),V=Math.ceil(Math.log(M)/Math.LN2),V=V<=48?1:Math.pow(2,V-48),L=y(M),A=L.j(T);B(A)||A.l(C)>0;)M-=V,L=y(M),A=L.j(T);K(L)&&(L=j),I=I.add(L),C=se(C,A)}return new Z(I,C)}n.B=function(C){return je(this,C).h},n.and=function(C){const T=Math.max(this.g.length,C.g.length),M=[];for(let V=0;V<T;V++)M[V]=this.i(V)&C.i(V);return new d(M,this.h&C.h)},n.or=function(C){const T=Math.max(this.g.length,C.g.length),M=[];for(let V=0;V<T;V++)M[V]=this.i(V)|C.i(V);return new d(M,this.h|C.h)},n.xor=function(C){const T=Math.max(this.g.length,C.g.length),M=[];for(let V=0;V<T;V++)M[V]=this.i(V)^C.i(V);return new d(M,this.h^C.h)};function Re(C){const T=C.g.length+1,M=[];for(let V=0;V<T;V++)M[V]=C.i(V)<<1|C.i(V-1)>>>31;return new d(M,C.h)}function ke(C,T){const M=T>>5;T%=32;const V=C.g.length-M,I=[];for(let L=0;L<V;L++)I[L]=T>0?C.i(L+M)>>>T|C.i(L+M+1)<<32-T:C.i(L+M);return new d(I,C.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,Jw=i,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.B,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=y,d.fromString=x,ho=d}).apply(typeof bx<"u"?bx:typeof self<"u"?self:typeof window<"u"?window:{});var ih=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Zw,du,e_,Th,bg,t_,s_,n_;(function(){var n,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof ih=="object"&&ih];for(var v=0;v<h.length;++v){var k=h[v];if(k&&k.Math==Math)return k}throw Error("Cannot find global object")}var i=t(this);function l(h,v){if(v)e:{var k=i;h=h.split(".");for(var R=0;R<h.length-1;R++){var oe=h[R];if(!(oe in k))break e;k=k[oe]}h=h[h.length-1],R=k[h],v=v(R),v!=R&&v!=null&&e(k,h,{configurable:!0,writable:!0,value:v})}}l("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),l("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),l("Object.entries",function(h){return h||function(v){var k=[],R;for(R in v)Object.prototype.hasOwnProperty.call(v,R)&&k.push([R,v[R]]);return k}});var u=u||{},d=this||self;function p(h){var v=typeof h;return v=="object"&&h!=null||v=="function"}function g(h,v,k){return h.call.apply(h.bind,arguments)}function y(h,v,k){return y=g,y.apply(null,arguments)}function x(h,v){var k=Array.prototype.slice.call(arguments,1);return function(){var R=k.slice();return R.push.apply(R,arguments),h.apply(this,R)}}function _(h,v){function k(){}k.prototype=v.prototype,h.Z=v.prototype,h.prototype=new k,h.prototype.constructor=h,h.Ob=function(R,oe,xe){for(var ct=Array(arguments.length-2),us=2;us<arguments.length;us++)ct[us-2]=arguments[us];return v.prototype[oe].apply(R,ct)}}var j=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function O(h){const v=h.length;if(v>0){const k=Array(v);for(let R=0;R<v;R++)k[R]=h[R];return k}return[]}function K(h,v){for(let R=1;R<arguments.length;R++){const oe=arguments[R];var k=typeof oe;if(k=k!="object"?k:oe?Array.isArray(oe)?"array":k:"null",k=="array"||k=="object"&&typeof oe.length=="number"){k=h.length||0;const xe=oe.length||0;h.length=k+xe;for(let ct=0;ct<xe;ct++)h[k+ct]=oe[ct]}else h.push(oe)}}class B{constructor(v,k){this.i=v,this.j=k,this.h=0,this.g=null}get(){let v;return this.h>0?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function D(h){d.setTimeout(()=>{throw h},0)}function se(){var h=C;let v=null;return h.g&&(v=h.g,h.g=h.g.next,h.g||(h.h=null),v.next=null),v}class Y{constructor(){this.h=this.g=null}add(v,k){const R=Z.get();R.set(v,k),this.h?this.h.next=R:this.g=R,this.h=R}}var Z=new B(()=>new je,h=>h.reset());class je{constructor(){this.next=this.g=this.h=null}set(v,k){this.h=v,this.g=k,this.next=null}reset(){this.next=this.g=this.h=null}}let Re,ke=!1,C=new Y,T=()=>{const h=Promise.resolve(void 0);Re=()=>{h.then(M)}};function M(){for(var h;h=se();){try{h.h.call(h.g)}catch(k){D(k)}var v=Z;v.j(h),v.h<100&&(v.h++,h.next=v.g,v.g=h)}ke=!1}function V(){this.u=this.u,this.C=this.C}V.prototype.u=!1,V.prototype.dispose=function(){this.u||(this.u=!0,this.N())},V.prototype[Symbol.dispose]=function(){this.dispose()},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function I(h,v){this.type=h,this.g=this.target=v,this.defaultPrevented=!1}I.prototype.h=function(){this.defaultPrevented=!0};var L=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var h=!1,v=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const k=()=>{};d.addEventListener("test",k,v),d.removeEventListener("test",k,v)}catch{}return h})();function A(h){return/^[\s\xa0]*$/.test(h)}function Oe(h,v){I.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,v)}_(Oe,I),Oe.prototype.init=function(h,v){const k=this.type=h.type,R=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=v,v=h.relatedTarget,v||(k=="mouseover"?v=h.fromElement:k=="mouseout"&&(v=h.toElement)),this.relatedTarget=v,R?(this.clientX=R.clientX!==void 0?R.clientX:R.pageX,this.clientY=R.clientY!==void 0?R.clientY:R.pageY,this.screenX=R.screenX||0,this.screenY=R.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&Oe.Z.h.call(this)},Oe.prototype.h=function(){Oe.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var ht="closure_listenable_"+(Math.random()*1e6|0),H=0;function fe(h,v,k,R,oe){this.listener=h,this.proxy=null,this.src=v,this.type=k,this.capture=!!R,this.ha=oe,this.key=++H,this.da=this.fa=!1}function Ve(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function $e(h,v,k){for(const R in h)v.call(k,h[R],R,h)}function J(h,v){for(const k in h)v.call(void 0,h[k],k,h)}function P(h){const v={};for(const k in h)v[k]=h[k];return v}const re="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Fe(h,v){let k,R;for(let oe=1;oe<arguments.length;oe++){R=arguments[oe];for(k in R)h[k]=R[k];for(let xe=0;xe<re.length;xe++)k=re[xe],Object.prototype.hasOwnProperty.call(R,k)&&(h[k]=R[k])}}function qe(h){this.src=h,this.g={},this.h=0}qe.prototype.add=function(h,v,k,R,oe){const xe=h.toString();h=this.g[xe],h||(h=this.g[xe]=[],this.h++);const ct=Ie(h,v,R,oe);return ct>-1?(v=h[ct],k||(v.fa=!1)):(v=new fe(v,this.src,xe,!!R,oe),v.fa=k,h.push(v)),v};function Ue(h,v){const k=v.type;if(k in h.g){var R=h.g[k],oe=Array.prototype.indexOf.call(R,v,void 0),xe;(xe=oe>=0)&&Array.prototype.splice.call(R,oe,1),xe&&(Ve(v),h.g[k].length==0&&(delete h.g[k],h.h--))}}function Ie(h,v,k,R){for(let oe=0;oe<h.length;++oe){const xe=h[oe];if(!xe.da&&xe.listener==v&&xe.capture==!!k&&xe.ha==R)return oe}return-1}var mt="closure_lm_"+(Math.random()*1e6|0),xt={};function it(h,v,k,R,oe){if(Array.isArray(v)){for(let xe=0;xe<v.length;xe++)it(h,v[xe],k,R,oe);return null}return k=Tt(k),h&&h[ht]?h.J(v,k,p(R)?!!R.capture:!1,oe):ss(h,v,k,!1,R,oe)}function ss(h,v,k,R,oe,xe){if(!v)throw Error("Invalid event type");const ct=p(oe)?!!oe.capture:!!oe;let us=St(h);if(us||(h[mt]=us=new qe(h)),k=us.add(v,k,R,ct,xe),k.proxy)return k;if(R=Rs(),k.proxy=R,R.src=h,R.listener=k,h.addEventListener)L||(oe=ct),oe===void 0&&(oe=!1),h.addEventListener(v.toString(),R,oe);else if(h.attachEvent)h.attachEvent(ie(v.toString()),R);else if(h.addListener&&h.removeListener)h.addListener(R);else throw Error("addEventListener and attachEvent are unavailable.");return k}function Rs(){function h(k){return v.call(h.src,h.listener,k)}const v=Mt;return h}function Ut(h,v,k,R,oe){if(Array.isArray(v))for(var xe=0;xe<v.length;xe++)Ut(h,v[xe],k,R,oe);else R=p(R)?!!R.capture:!!R,k=Tt(k),h&&h[ht]?(h=h.i,xe=String(v).toString(),xe in h.g&&(v=h.g[xe],k=Ie(v,k,R,oe),k>-1&&(Ve(v[k]),Array.prototype.splice.call(v,k,1),v.length==0&&(delete h.g[xe],h.h--)))):h&&(h=St(h))&&(v=h.g[v.toString()],h=-1,v&&(h=Ie(v,k,R,oe)),(k=h>-1?v[h]:null)&&jt(k))}function jt(h){if(typeof h!="number"&&h&&!h.da){var v=h.src;if(v&&v[ht])Ue(v.i,h);else{var k=h.type,R=h.proxy;v.removeEventListener?v.removeEventListener(k,R,h.capture):v.detachEvent?v.detachEvent(ie(k),R):v.addListener&&v.removeListener&&v.removeListener(R),(k=St(v))?(Ue(k,h),k.h==0&&(k.src=null,v[mt]=null)):Ve(h)}}}function ie(h){return h in xt?xt[h]:xt[h]="on"+h}function Mt(h,v){if(h.da)h=!0;else{v=new Oe(v,this);const k=h.listener,R=h.ha||h.src;h.fa&&jt(h),h=k.call(R,v)}return h}function St(h){return h=h[mt],h instanceof qe?h:null}var Yt="__closure_events_fn_"+(Math.random()*1e9>>>0);function Tt(h){return typeof h=="function"?h:(h[Yt]||(h[Yt]=function(v){return h.handleEvent(v)}),h[Yt])}function Et(){V.call(this),this.i=new qe(this),this.M=this,this.G=null}_(Et,V),Et.prototype[ht]=!0,Et.prototype.removeEventListener=function(h,v,k,R){Ut(this,h,v,k,R)};function ot(h,v){var k,R=h.G;if(R)for(k=[];R;R=R.G)k.push(R);if(h=h.M,R=v.type||v,typeof v=="string")v=new I(v,h);else if(v instanceof I)v.target=v.target||h;else{var oe=v;v=new I(R,h),Fe(v,oe)}oe=!0;let xe,ct;if(k)for(ct=k.length-1;ct>=0;ct--)xe=v.g=k[ct],oe=Pt(xe,R,!0,v)&&oe;if(xe=v.g=h,oe=Pt(xe,R,!0,v)&&oe,oe=Pt(xe,R,!1,v)&&oe,k)for(ct=0;ct<k.length;ct++)xe=v.g=k[ct],oe=Pt(xe,R,!1,v)&&oe}Et.prototype.N=function(){if(Et.Z.N.call(this),this.i){var h=this.i;for(const v in h.g){const k=h.g[v];for(let R=0;R<k.length;R++)Ve(k[R]);delete h.g[v],h.h--}}this.G=null},Et.prototype.J=function(h,v,k,R){return this.i.add(String(h),v,!1,k,R)},Et.prototype.K=function(h,v,k,R){return this.i.add(String(h),v,!0,k,R)};function Pt(h,v,k,R){if(v=h.i.g[String(v)],!v)return!0;v=v.concat();let oe=!0;for(let xe=0;xe<v.length;++xe){const ct=v[xe];if(ct&&!ct.da&&ct.capture==k){const us=ct.listener,wn=ct.ha||ct.src;ct.fa&&Ue(h.i,ct),oe=us.call(wn,R)!==!1&&oe}}return oe&&!R.defaultPrevented}function Gt(h,v){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=y(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(v)>2147483647?-1:d.setTimeout(h,v||0)}function ps(h){h.g=Gt(()=>{h.g=null,h.i&&(h.i=!1,ps(h))},h.l);const v=h.h;h.h=null,h.m.apply(null,v)}class Kt extends V{constructor(v,k){super(),this.m=v,this.l=k,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:ps(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function It(h){V.call(this),this.h=h,this.g={}}_(It,V);var hs=[];function ws(h){$e(h.g,function(v,k){this.g.hasOwnProperty(k)&&jt(v)},h),h.g={}}It.prototype.N=function(){It.Z.N.call(this),ws(this)},It.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var is=d.JSON.stringify,Xs=d.JSON.parse,Ps=class{stringify(h){return d.JSON.stringify(h,void 0)}parse(h){return d.JSON.parse(h,void 0)}};function qs(){}function os(){}var _s={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ve(){I.call(this,"d")}_(ve,I);function De(){I.call(this,"c")}_(De,I);var Pe={},st=null;function Ge(){return st=st||new Et}Pe.Ia="serverreachability";function nt(h){I.call(this,Pe.Ia,h)}_(nt,I);function gt(h){const v=Ge();ot(v,new nt(v))}Pe.STAT_EVENT="statevent";function X(h,v){I.call(this,Pe.STAT_EVENT,h),this.stat=v}_(X,I);function ne(h){const v=Ge();ot(v,new X(v,h))}Pe.Ja="timingevent";function Ke(h,v){I.call(this,Pe.Ja,h),this.size=v}_(Ke,I);function wt(h,v){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){h()},v)}function et(){this.g=!0}et.prototype.ua=function(){this.g=!1};function _t(h,v,k,R,oe,xe){h.info(function(){if(h.g)if(xe){var ct="",us=xe.split("&");for(let Fs=0;Fs<us.length;Fs++){var wn=us[Fs].split("=");if(wn.length>1){const cn=wn[0];wn=wn[1];const Jr=cn.split("_");ct=Jr.length>=2&&Jr[1]=="type"?ct+(cn+"="+wn+"&"):ct+(cn+"=redacted&")}}}else ct=null;else ct=xe;return"XMLHTTP REQ ("+R+") [attempt "+oe+"]: "+v+`
`+k+`
`+ct})}function Q(h,v,k,R,oe,xe,ct){h.info(function(){return"XMLHTTP RESP ("+R+") [ attempt "+oe+"]: "+v+`
`+k+`
`+xe+" "+ct})}function Ae(h,v,k,R){h.info(function(){return"XMLHTTP TEXT ("+v+"): "+yt(h,k)+(R?" "+R:"")})}function Je(h,v){h.info(function(){return"TIMEOUT: "+v})}et.prototype.info=function(){};function yt(h,v){if(!h.g)return v;if(!v)return null;try{const xe=JSON.parse(v);if(xe){for(h=0;h<xe.length;h++)if(Array.isArray(xe[h])){var k=xe[h];if(!(k.length<2)){var R=k[1];if(Array.isArray(R)&&!(R.length<1)){var oe=R[0];if(oe!="noop"&&oe!="stop"&&oe!="close")for(let ct=1;ct<R.length;ct++)R[ct]=""}}}}return is(xe)}catch{return v}}var at={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Zt={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Qt;function U(){}_(U,qs),U.prototype.g=function(){return new XMLHttpRequest},Qt=new U;function be(h){return encodeURIComponent(String(h))}function Ee(h){var v=1;h=h.split(":");const k=[];for(;v>0&&h.length;)k.push(h.shift()),v--;return h.length&&k.push(h.join(":")),k}function Te(h,v,k,R){this.j=h,this.i=v,this.l=k,this.S=R||1,this.V=new It(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Se}function Se(){this.i=null,this.g="",this.h=!1}var bt={},Ct={};function ft(h,v,k){h.M=1,h.A=_r(vt(v)),h.u=k,h.R=!0,zt(h,null)}function zt(h,v){h.F=Date.now(),rn(h),h.B=vt(h.A);var k=h.B,R=h.S;Array.isArray(R)||(R=[String(R)]),Ma(k.i,"t",R),h.C=0,k=h.j.L,h.h=new Se,h.g=Nr(h.j,k?v:null,!h.u),h.P>0&&(h.O=new Kt(y(h.Y,h,h.g),h.P)),v=h.V,k=h.g,R=h.ba;var oe="readystatechange";Array.isArray(oe)||(oe&&(hs[0]=oe.toString()),oe=hs);for(let xe=0;xe<oe.length;xe++){const ct=it(k,oe[xe],R||v.handleEvent,!1,v.h||v);if(!ct)break;v.g[ct.key]=ct}v=h.J?P(h.J):{},h.u?(h.v||(h.v="POST"),v["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,v)):(h.v="GET",h.g.ea(h.B,h.v,null,v)),gt(),_t(h.i,h.v,h.B,h.l,h.S,h.u)}Te.prototype.ba=function(h){h=h.target;const v=this.O;v&&ge(h)==3?v.j():this.Y(h)},Te.prototype.Y=function(h){try{if(h==this.g)e:{const us=ge(this.g),wn=this.g.ya(),Fs=this.g.ca();if(!(us<3)&&(us!=3||this.g&&(this.h.h||this.g.la()||Me(this.g)))){this.K||us!=4||wn==7||(wn==8||Fs<=0?gt(3):gt(2)),As(this);var v=this.g.ca();this.X=v;var k=Lt(this);if(this.o=v==200,Q(this.i,this.v,this.B,this.l,this.S,us,v),this.o){if(this.U&&!this.L){t:{if(this.g){var R,oe=this.g;if((R=oe.g?oe.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!A(R)){var xe=R;break t}}xe=null}if(h=xe)Ae(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,W(this,h);else{this.o=!1,this.m=3,ne(12),ks(this),sn(this);break e}}if(this.R){h=!0;let cn;for(;!this.K&&this.C<k.length;)if(cn=hn(this,k),cn==Ct){us==4&&(this.m=4,ne(14),h=!1),Ae(this.i,this.l,null,"[Incomplete Response]");break}else if(cn==bt){this.m=4,ne(15),Ae(this.i,this.l,k,"[Invalid Chunk]"),h=!1;break}else Ae(this.i,this.l,cn,null),W(this,cn);if(Bs(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),us!=4||k.length!=0||this.h.h||(this.m=1,ne(16),h=!1),this.o=this.o&&h,!h)Ae(this.i,this.l,k,"[Invalid Chunked Response]"),ks(this),sn(this);else if(k.length>0&&!this.W){this.W=!0;var ct=this.j;ct.g==this&&ct.aa&&!ct.P&&(ct.j.info("Great, no buffering proxy detected. Bytes received: "+k.length),Hn(ct),ct.P=!0,ne(11))}}else Ae(this.i,this.l,k,null),W(this,k);us==4&&ks(this),this.o&&!this.K&&(us==4?Sr(this.j,this):(this.o=!1,rn(this)))}else Qe(this.g),v==400&&k.indexOf("Unknown SID")>0?(this.m=3,ne(12)):(this.m=0,ne(13)),ks(this),sn(this)}}}catch{}};function Lt(h){if(!Bs(h))return h.g.la();const v=Me(h.g);if(v==="")return"";let k="";const R=v.length,oe=ge(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return ks(h),sn(h),"";h.h.i=new d.TextDecoder}for(let xe=0;xe<R;xe++)h.h.h=!0,k+=h.h.i.decode(v[xe],{stream:!(oe&&xe==R-1)});return v.length=0,h.h.g+=k,h.C=0,h.h.g}function Bs(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function hn(h,v){var k=h.C,R=v.indexOf(`
`,k);return R==-1?Ct:(k=Number(v.substring(k,R)),isNaN(k)?bt:(R+=1,R+k>v.length?Ct:(v=v.slice(R,R+k),h.C=R+k,v)))}Te.prototype.cancel=function(){this.K=!0,ks(this)};function rn(h){h.T=Date.now()+h.H,Tn(h,h.H)}function Tn(h,v){if(h.D!=null)throw Error("WatchDog timer not null");h.D=wt(y(h.aa,h),v)}function As(h){h.D&&(d.clearTimeout(h.D),h.D=null)}Te.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(Je(this.i,this.B),this.M!=2&&(gt(),ne(17)),ks(this),this.m=2,sn(this)):Tn(this,this.T-h)};function sn(h){h.j.I==0||h.K||Sr(h.j,h)}function ks(h){As(h);var v=h.O;v&&typeof v.dispose=="function"&&v.dispose(),h.O=null,ws(h.V),h.g&&(v=h.g,h.g=null,v.abort(),v.dispose())}function W(h,v){try{var k=h.j;if(k.I!=0&&(k.g==h||F(k.h,h))){if(!h.L&&F(k.h,h)&&k.I==3){try{var R=k.Ba.g.parse(v)}catch{R=null}if(Array.isArray(R)&&R.length==3){var oe=R;if(oe[0]==0){e:if(!k.v){if(k.g)if(k.g.F+3e3<h.F)Yn(k),Ht(k);else break e;On(k),ne(18)}}else k.xa=oe[1],0<k.xa-k.K&&oe[2]<37500&&k.F&&k.A==0&&!k.C&&(k.C=wt(y(k.Va,k),6e3));S(k.h)<=1&&k.ta&&(k.ta=void 0)}else fn(k,11)}else if((h.L||k.g==h)&&Yn(k),!A(v))for(oe=k.Ba.g.parse(v),v=0;v<oe.length;v++){let Fs=oe[v];const cn=Fs[0];if(!(cn<=k.K))if(k.K=cn,Fs=Fs[1],k.I==2)if(Fs[0]=="c"){k.M=Fs[1],k.ba=Fs[2];const Jr=Fs[3];Jr!=null&&(k.ka=Jr,k.j.info("VER="+k.ka));const Da=Fs[4];Da!=null&&(k.za=Da,k.j.info("SVER="+k.za));const ma=Fs[5];ma!=null&&typeof ma=="number"&&ma>0&&(R=1.5*ma,k.O=R,k.j.info("backChannelRequestTimeoutMs_="+R)),R=k;const fa=h.g;if(fa){const Eo=fa.g?fa.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Eo){var xe=R.h;xe.g||Eo.indexOf("spdy")==-1&&Eo.indexOf("quic")==-1&&Eo.indexOf("h2")==-1||(xe.j=xe.l,xe.g=new Set,xe.h&&(ae(xe,xe.h),xe.h=null))}if(R.G){const ul=fa.g?fa.g.getResponseHeader("X-HTTP-Session-Id"):null;ul&&(R.wa=ul,ys(R.J,R.G,ul))}}k.I=3,k.l&&k.l.ra(),k.aa&&(k.T=Date.now()-h.F,k.j.info("Handshake RTT: "+k.T+"ms")),R=k;var ct=h;if(R.na=Er(R,R.L?R.ba:null,R.W),ct.L){te(R.h,ct);var us=ct,wn=R.O;wn&&(us.H=wn),us.D&&(As(us),rn(us)),R.g=ct}else Zs(R);k.i.length>0&&$t(k)}else Fs[0]!="stop"&&Fs[0]!="close"||fn(k,7);else k.I==3&&(Fs[0]=="stop"||Fs[0]=="close"?Fs[0]=="stop"?fn(k,7):Ft(k):Fs[0]!="noop"&&k.l&&k.l.qa(Fs),k.A=0)}}gt(4)}catch{}}var de=class{constructor(h,v){this.g=h,this.map=v}};function le(h){this.l=h||10,d.PerformanceNavigationTiming?(h=d.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function we(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function S(h){return h.h?1:h.g?h.g.size:0}function F(h,v){return h.h?h.h==v:h.g?h.g.has(v):!1}function ae(h,v){h.g?h.g.add(v):h.h=v}function te(h,v){h.h&&h.h==v?h.h=null:h.g&&h.g.has(v)&&h.g.delete(v)}le.prototype.cancel=function(){if(this.i=Ze(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Ze(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let v=h.i;for(const k of h.g.values())v=v.concat(k.G);return v}return O(h.i)}var ut=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function lt(h,v){if(h){h=h.split("&");for(let k=0;k<h.length;k++){const R=h[k].indexOf("=");let oe,xe=null;R>=0?(oe=h[k].substring(0,R),xe=h[k].substring(R+1)):oe=h[k],v(oe,xe?decodeURIComponent(xe.replace(/\+/g," ")):"")}}}function Dt(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let v;h instanceof Dt?(this.l=h.l,gs(this,h.j),this.o=h.o,this.g=h.g,ln(this,h.u),this.h=h.h,hr(this,Mi(h.i)),this.m=h.m):h&&(v=String(h).match(ut))?(this.l=!1,gs(this,v[1]||"",!0),this.o=mr(v[2]||""),this.g=mr(v[3]||"",!0),ln(this,v[4]),this.h=mr(v[5]||"",!0),hr(this,v[6]||"",!0),this.m=mr(v[7]||"")):(this.l=!1,this.i=new Br(null,this.l))}Dt.prototype.toString=function(){const h=[];var v=this.j;v&&h.push(da(v,Ra,!0),":");var k=this.g;return(k||v=="file")&&(h.push("//"),(v=this.o)&&h.push(da(v,Ra,!0),"@"),h.push(be(k).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),k=this.u,k!=null&&h.push(":",String(k))),(k=this.h)&&(this.g&&k.charAt(0)!="/"&&h.push("/"),h.push(da(k,k.charAt(0)=="/"?Qr:Aa,!0))),(k=this.i.toString())&&h.push("?",k),(k=this.m)&&h.push("#",da(k,Ja)),h.join("")},Dt.prototype.resolve=function(h){const v=vt(this);let k=!!h.j;k?gs(v,h.j):k=!!h.o,k?v.o=h.o:k=!!h.g,k?v.g=h.g:k=h.u!=null;var R=h.h;if(k)ln(v,h.u);else if(k=!!h.h){if(R.charAt(0)!="/")if(this.g&&!this.h)R="/"+R;else{var oe=v.h.lastIndexOf("/");oe!=-1&&(R=v.h.slice(0,oe+1)+R)}if(oe=R,oe==".."||oe==".")R="";else if(oe.indexOf("./")!=-1||oe.indexOf("/.")!=-1){R=oe.lastIndexOf("/",0)==0,oe=oe.split("/");const xe=[];for(let ct=0;ct<oe.length;){const us=oe[ct++];us=="."?R&&ct==oe.length&&xe.push(""):us==".."?((xe.length>1||xe.length==1&&xe[0]!="")&&xe.pop(),R&&ct==oe.length&&xe.push("")):(xe.push(us),R=!0)}R=xe.join("/")}else R=oe}return k?v.h=R:k=h.i.toString()!=="",k?hr(v,Mi(h.i)):k=!!h.m,k&&(v.m=h.m),v};function vt(h){return new Dt(h)}function gs(h,v,k){h.j=k?mr(v,!0):v,h.j&&(h.j=h.j.replace(/:$/,""))}function ln(h,v){if(v){if(v=Number(v),isNaN(v)||v<0)throw Error("Bad port number "+v);h.u=v}else h.u=null}function hr(h,v,k){v instanceof Br?(h.i=v,Tr(h.i,h.l)):(k||(v=da(v,Or)),h.i=new Br(v,h.l))}function ys(h,v,k){h.i.set(v,k)}function _r(h){return ys(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function mr(h,v){return h?v?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function da(h,v,k){return typeof h=="string"?(h=encodeURI(h).replace(v,Sn),k&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function Sn(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Ra=/[#\/\?@]/g,Aa=/[#\?:]/g,Qr=/[#\?]/g,Or=/[#\?@]/g,Ja=/#/g;function Br(h,v){this.h=this.g=null,this.i=h||null,this.j=!!v}function zn(h){h.g||(h.g=new Map,h.h=0,h.i&&lt(h.i,function(v,k){h.add(decodeURIComponent(v.replace(/\+/g," ")),k)}))}n=Br.prototype,n.add=function(h,v){zn(this),this.i=null,h=jr(this,h);let k=this.g.get(h);return k||this.g.set(h,k=[]),k.push(v),this.h+=1,this};function Ai(h,v){zn(h),v=jr(h,v),h.g.has(v)&&(h.i=null,h.h-=h.g.get(v).length,h.g.delete(v))}function Za(h,v){return zn(h),v=jr(h,v),h.g.has(v)}n.forEach=function(h,v){zn(this),this.g.forEach(function(k,R){k.forEach(function(oe){h.call(v,oe,R,this)},this)},this)};function kr(h,v){zn(h);let k=[];if(typeof v=="string")Za(h,v)&&(k=k.concat(h.g.get(jr(h,v))));else for(h=Array.from(h.g.values()),v=0;v<h.length;v++)k=k.concat(h[v]);return k}n.set=function(h,v){return zn(this),this.i=null,h=jr(this,h),Za(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[v]),this.h+=1,this},n.get=function(h,v){return h?(h=kr(this,h),h.length>0?String(h[0]):v):v};function Ma(h,v,k){Ai(h,v),k.length>0&&(h.i=null,h.g.set(jr(h,v),O(k)),h.h+=k.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],v=Array.from(this.g.keys());for(let R=0;R<v.length;R++){var k=v[R];const oe=be(k);k=kr(this,k);for(let xe=0;xe<k.length;xe++){let ct=oe;k[xe]!==""&&(ct+="="+be(k[xe])),h.push(ct)}}return this.i=h.join("&")};function Mi(h){const v=new Br;return v.i=h.i,h.g&&(v.g=new Map(h.g),v.h=h.h),v}function jr(h,v){return v=String(v),h.j&&(v=v.toLowerCase()),v}function Tr(h,v){v&&!h.j&&(zn(h),h.i=null,h.g.forEach(function(k,R){const oe=R.toLowerCase();R!=oe&&(Ai(this,R),Ma(this,oe,k))},h)),h.j=v}function Dn(h,v){const k=new et;if(d.Image){const R=new Image;R.onload=x(Pn,k,"TestLoadImage: loaded",!0,v,R),R.onerror=x(Pn,k,"TestLoadImage: error",!1,v,R),R.onabort=x(Pn,k,"TestLoadImage: abort",!1,v,R),R.ontimeout=x(Pn,k,"TestLoadImage: timeout",!1,v,R),d.setTimeout(function(){R.ontimeout&&R.ontimeout()},1e4),R.src=h}else v(!1)}function qn(h,v){const k=new et,R=new AbortController,oe=setTimeout(()=>{R.abort(),Pn(k,"TestPingServer: timeout",!1,v)},1e4);fetch(h,{signal:R.signal}).then(xe=>{clearTimeout(oe),xe.ok?Pn(k,"TestPingServer: ok",!0,v):Pn(k,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(oe),Pn(k,"TestPingServer: error",!1,v)})}function Pn(h,v,k,R,oe){try{oe&&(oe.onload=null,oe.onerror=null,oe.onabort=null,oe.ontimeout=null),R(k)}catch{}}function Xr(){this.g=new Ps}function xn(h){this.i=h.Sb||null,this.h=h.ab||!1}_(xn,qs),xn.prototype.g=function(){return new z(this.i,this.h)};function z(h,v){Et.call(this),this.H=h,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}_(z,Et),n=z.prototype,n.open=function(h,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=v,this.readyState=1,Ce(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const v={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(v.body=h),(this.H||d).fetch(new Request(this.D,v)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,he(this)),this.readyState=0},n.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Ce(this)),this.g&&(this.readyState=3,Ce(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;pe(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function pe(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}n.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var v=h.value?h.value:new Uint8Array(0);(v=this.B.decode(v,{stream:!h.done}))&&(this.response=this.responseText+=v)}h.done?he(this):Ce(this),this.readyState==3&&pe(this)}},n.Oa=function(h){this.g&&(this.response=this.responseText=h,he(this))},n.Na=function(h){this.g&&(this.response=h,he(this))},n.ga=function(){this.g&&he(this)};function he(h){h.readyState=4,h.l=null,h.j=null,h.B=null,Ce(h)}n.setRequestHeader=function(h,v){this.A.append(h,v)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],v=this.h.entries();for(var k=v.next();!k.done;)k=k.value,h.push(k[0]+": "+k[1]),k=v.next();return h.join(`\r
`)};function Ce(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(z.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function We(h){let v="";return $e(h,function(k,R){v+=R,v+=":",v+=k,v+=`\r
`}),v}function rt(h,v,k){e:{for(R in k){var R=!1;break e}R=!0}R||(k=We(k),typeof h=="string"?k!=null&&be(k):ys(h,v,k))}function dt(h){Et.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}_(dt,Et);var Ot=/^https?$/i,es=["POST","PUT"];n=dt.prototype,n.Fa=function(h){this.H=h},n.ea=function(h,v,k,R){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);v=v?v.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Qt.g(),this.g.onreadystatechange=j(y(this.Ca,this));try{this.B=!0,this.g.open(v,String(h),!0),this.B=!1}catch(xe){ls(this,xe);return}if(h=k||"",k=new Map(this.headers),R)if(Object.getPrototypeOf(R)===Object.prototype)for(var oe in R)k.set(oe,R[oe]);else if(typeof R.keys=="function"&&typeof R.get=="function")for(const xe of R.keys())k.set(xe,R.get(xe));else throw Error("Unknown input type for opt_headers: "+String(R));R=Array.from(k.keys()).find(xe=>xe.toLowerCase()=="content-type"),oe=d.FormData&&h instanceof d.FormData,!(Array.prototype.indexOf.call(es,v,void 0)>=0)||R||oe||k.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[xe,ct]of k)this.g.setRequestHeader(xe,ct);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(xe){ls(this,xe)}};function ls(h,v){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=v,h.o=5,ts(h),$(h)}function ts(h){h.A||(h.A=!0,ot(h,"complete"),ot(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,ot(this,"complete"),ot(this,"abort"),$(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),$(this,!0)),dt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?E(this):this.Xa())},n.Xa=function(){E(this)};function E(h){if(h.h&&typeof u<"u"){if(h.v&&ge(h)==4)setTimeout(h.Ca.bind(h),0);else if(ot(h,"readystatechange"),ge(h)==4){h.h=!1;try{const xe=h.ca();e:switch(xe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var k;if(!(k=v)){var R;if(R=xe===0){let ct=String(h.D).match(ut)[1]||null;!ct&&d.self&&d.self.location&&(ct=d.self.location.protocol.slice(0,-1)),R=!Ot.test(ct?ct.toLowerCase():"")}k=R}if(k)ot(h,"complete"),ot(h,"success");else{h.o=6;try{var oe=ge(h)>2?h.g.statusText:""}catch{oe=""}h.l=oe+" ["+h.ca()+"]",ts(h)}}finally{$(h)}}}}function $(h,v){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const k=h.g;h.g=null,v||ot(h,"ready");try{k.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function ge(h){return h.g?h.g.readyState:0}n.ca=function(){try{return ge(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(h){if(this.g){var v=this.g.responseText;return h&&v.indexOf(h)==0&&(v=v.substring(h.length)),Xs(v)}};function Me(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function Qe(h){const v={};h=(h.g&&ge(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let R=0;R<h.length;R++){if(A(h[R]))continue;var k=Ee(h[R]);const oe=k[0];if(k=k[1],typeof k!="string")continue;k=k.trim();const xe=v[oe]||[];v[oe]=xe,xe.push(k)}J(v,function(R){return R.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function tt(h,v,k){return k&&k.internalChannelParams&&k.internalChannelParams[h]||v}function Ye(h){this.za=0,this.i=[],this.j=new et,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=tt("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=tt("baseRetryDelayMs",5e3,h),this.Za=tt("retryDelaySeedMs",1e4,h),this.Ta=tt("forwardChannelMaxRetries",2,h),this.va=tt("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new le(h&&h.concurrentRequestLimit),this.Ba=new Xr,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Ye.prototype,n.ka=8,n.I=1,n.connect=function(h,v,k,R){ne(0),this.W=h,this.H=v||{},k&&R!==void 0&&(this.H.OSID=k,this.H.OAID=R),this.F=this.X,this.J=Er(this,null,this.W),$t(this)};function Ft(h){if(ms(h),h.I==3){var v=h.V++,k=vt(h.J);if(ys(k,"SID",h.M),ys(k,"RID",v),ys(k,"TYPE","terminate"),Gn(h,k),v=new Te(h,h.j,v),v.M=2,v.A=_r(vt(k)),k=!1,d.navigator&&d.navigator.sendBeacon)try{k=d.navigator.sendBeacon(v.A.toString(),"")}catch{}!k&&d.Image&&(new Image().src=v.A,k=!0),k||(v.g=Nr(v.j,null),v.g.ea(v.A)),v.F=Date.now(),rn(v)}Bn(h)}function Ht(h){h.g&&(Hn(h),h.g.cancel(),h.g=null)}function ms(h){Ht(h),h.v&&(d.clearTimeout(h.v),h.v=null),Yn(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&d.clearTimeout(h.m),h.m=null)}function $t(h){if(!we(h.h)&&!h.m){h.m=!0;var v=h.Ea;Re||T(),ke||(Re(),ke=!0),C.add(v,h),h.D=0}}function cs(h,v){return S(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=v.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=wt(y(h.Ea,h,v),fr(h,h.D)),h.D++,!0)}n.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const oe=new Te(this,this.j,h);let xe=this.o;if(this.U&&(xe?(xe=P(xe),Fe(xe,this.U)):xe=this.U),this.u!==null||this.R||(oe.J=xe,xe=null),this.S)e:{for(var v=0,k=0;k<this.i.length;k++){t:{var R=this.i[k];if("__data__"in R.map&&(R=R.map.__data__,typeof R=="string")){R=R.length;break t}R=void 0}if(R===void 0)break;if(v+=R,v>4096){v=k;break e}if(v===4096||k===this.i.length-1){v=k+1;break e}}v=1e3}else v=1e3;v=Js(this,oe,v),k=vt(this.J),ys(k,"RID",h),ys(k,"CVER",22),this.G&&ys(k,"X-HTTP-Session-Id",this.G),Gn(this,k),xe&&(this.R?v="headers="+be(We(xe))+"&"+v:this.u&&rt(k,this.u,xe)),ae(this.h,oe),this.Ra&&ys(k,"TYPE","init"),this.S?(ys(k,"$req",v),ys(k,"SID","null"),oe.U=!0,ft(oe,k,null)):ft(oe,k,v),this.I=2}}else this.I==3&&(h?Ln(this,h):this.i.length==0||we(this.h)||Ln(this))};function Ln(h,v){var k;v?k=v.l:k=h.V++;const R=vt(h.J);ys(R,"SID",h.M),ys(R,"RID",k),ys(R,"AID",h.K),Gn(h,R),h.u&&h.o&&rt(R,h.u,h.o),k=new Te(h,h.j,k,h.D+1),h.u===null&&(k.J=h.o),v&&(h.i=v.G.concat(h.i)),v=Js(h,k,1e3),k.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),ae(h.h,k),ft(k,R,v)}function Gn(h,v){h.H&&$e(h.H,function(k,R){ys(v,R,k)}),h.l&&$e({},function(k,R){ys(v,R,k)})}function Js(h,v,k){k=Math.min(h.i.length,k);const R=h.l?y(h.l.Ka,h.l,h):null;e:{var oe=h.i;let us=-1;for(;;){const wn=["count="+k];us==-1?k>0?(us=oe[0].g,wn.push("ofs="+us)):us=0:wn.push("ofs="+us);let Fs=!0;for(let cn=0;cn<k;cn++){var xe=oe[cn].g;const Jr=oe[cn].map;if(xe-=us,xe<0)us=Math.max(0,oe[cn].g-100),Fs=!1;else try{xe="req"+xe+"_"||"";try{var ct=Jr instanceof Map?Jr:Object.entries(Jr);for(const[Da,ma]of ct){let fa=ma;p(ma)&&(fa=is(ma)),wn.push(xe+Da+"="+encodeURIComponent(fa))}}catch(Da){throw wn.push(xe+"type="+encodeURIComponent("_badmap")),Da}}catch{R&&R(Jr)}}if(Fs){ct=wn.join("&");break e}}ct=void 0}return h=h.i.splice(0,k),v.G=h,ct}function Zs(h){if(!h.g&&!h.v){h.Y=1;var v=h.Da;Re||T(),ke||(Re(),ke=!0),C.add(v,h),h.A=0}}function On(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=wt(y(h.Da,h),fr(h,h.A)),h.A++,!0)}n.Da=function(){if(this.v=null,Kn(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=wt(y(this.Wa,this),h)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ne(10),Ht(this),Kn(this))};function Hn(h){h.B!=null&&(d.clearTimeout(h.B),h.B=null)}function Kn(h){h.g=new Te(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var v=vt(h.na);ys(v,"RID","rpc"),ys(v,"SID",h.M),ys(v,"AID",h.K),ys(v,"CI",h.F?"0":"1"),!h.F&&h.ia&&ys(v,"TO",h.ia),ys(v,"TYPE","xmlhttp"),Gn(h,v),h.u&&h.o&&rt(v,h.u,h.o),h.O&&(h.g.H=h.O);var k=h.g;h=h.ba,k.M=1,k.A=_r(vt(v)),k.u=null,k.R=!0,zt(k,h)}n.Va=function(){this.C!=null&&(this.C=null,Ht(this),On(this),ne(19))};function Yn(h){h.C!=null&&(d.clearTimeout(h.C),h.C=null)}function Sr(h,v){var k=null;if(h.g==v){Yn(h),Hn(h),h.g=null;var R=2}else if(F(h.h,v))k=v.G,te(h.h,v),R=1;else return;if(h.I!=0){if(v.o)if(R==1){k=v.u?v.u.length:0,v=Date.now()-v.F;var oe=h.D;R=Ge(),ot(R,new Ke(R,k)),$t(h)}else Zs(h);else if(oe=v.m,oe==3||oe==0&&v.X>0||!(R==1&&cs(h,v)||R==2&&On(h)))switch(k&&k.length>0&&(v=h.h,v.i=v.i.concat(k)),oe){case 1:fn(h,5);break;case 4:fn(h,10);break;case 3:fn(h,6);break;default:fn(h,2)}}}function fr(h,v){let k=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(k*=2),k*v}function fn(h,v){if(h.j.info("Error code "+v),v==2){var k=y(h.bb,h),R=h.Ua;const oe=!R;R=new Dt(R||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||gs(R,"https"),_r(R),oe?Dn(R.toString(),k):qn(R.toString(),k)}else ne(2);h.I=0,h.l&&h.l.pa(v),Bn(h),ms(h)}n.bb=function(h){h?(this.j.info("Successfully pinged google.com"),ne(2)):(this.j.info("Failed to ping google.com"),ne(1))};function Bn(h){if(h.I=0,h.ja=[],h.l){const v=Ze(h.h);(v.length!=0||h.i.length!=0)&&(K(h.ja,v),K(h.ja,h.i),h.h.i.length=0,O(h.i),h.i.length=0),h.l.oa()}}function Er(h,v,k){var R=k instanceof Dt?vt(k):new Dt(k);if(R.g!="")v&&(R.g=v+"."+R.g),ln(R,R.u);else{var oe=d.location;R=oe.protocol,v=v?v+"."+oe.hostname:oe.hostname,oe=+oe.port;const xe=new Dt(null);R&&gs(xe,R),v&&(xe.g=v),oe&&ln(xe,oe),k&&(xe.h=k),R=xe}return k=h.G,v=h.wa,k&&v&&ys(R,k,v),ys(R,"VER",h.ka),Gn(h,R),R}function Nr(h,v,k){if(v&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return v=h.Aa&&!h.ma?new dt(new xn({ab:k})):new dt(h.ma),v.Fa(h.L),v}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function So(){}n=So.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Ia(){}Ia.prototype.g=function(h,v){return new Qn(h,v)};function Qn(h,v){Et.call(this),this.g=new Ye(v),this.l=h,this.h=v&&v.messageUrlParams||null,h=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(h?h["X-WebChannel-Content-Type"]=v.messageContentType:h={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.sa&&(h?h["X-WebChannel-Client-Profile"]=v.sa:h={"X-WebChannel-Client-Profile":v.sa}),this.g.U=h,(h=v&&v.Qb)&&!A(h)&&(this.g.u=h),this.A=v&&v.supportsCrossDomainXhr||!1,this.v=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!A(v)&&(this.g.G=v,h=this.h,h!==null&&v in h&&(h=this.h,v in h&&delete h[v])),this.j=new ar(this)}_(Qn,Et),Qn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Qn.prototype.close=function(){Ft(this.g)},Qn.prototype.o=function(h){var v=this.g;if(typeof h=="string"){var k={};k.__data__=h,h=k}else this.v&&(k={},k.__data__=is(h),h=k);v.i.push(new de(v.Ya++,h)),v.I==3&&$t(v)},Qn.prototype.N=function(){this.g.l=null,delete this.j,Ft(this.g),delete this.g,Qn.Z.N.call(this)};function ei(h){ve.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var v=h.__sm__;if(v){e:{for(const k in v){h=k;break e}h=void 0}(this.i=h)&&(h=this.i,v=v!==null&&h in v?v[h]:void 0),this.data=v}else this.data=h}_(ei,ve);function ha(){De.call(this),this.status=1}_(ha,De);function ar(h){this.g=h}_(ar,So),ar.prototype.ra=function(){ot(this.g,"a")},ar.prototype.qa=function(h){ot(this.g,new ei(h))},ar.prototype.pa=function(h){ot(this.g,new ha)},ar.prototype.oa=function(){ot(this.g,"b")},Ia.prototype.createWebChannel=Ia.prototype.g,Qn.prototype.send=Qn.prototype.o,Qn.prototype.open=Qn.prototype.m,Qn.prototype.close=Qn.prototype.close,n_=function(){return new Ia},s_=function(){return Ge()},t_=Pe,bg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},at.NO_ERROR=0,at.TIMEOUT=8,at.HTTP_ERROR=6,Th=at,Zt.COMPLETE="complete",e_=Zt,os.EventType=_s,_s.OPEN="a",_s.CLOSE="b",_s.ERROR="c",_s.MESSAGE="d",Et.prototype.listen=Et.prototype.J,du=os,dt.prototype.listenOnce=dt.prototype.K,dt.prototype.getLastError=dt.prototype.Ha,dt.prototype.getLastErrorCode=dt.prototype.ya,dt.prototype.getStatus=dt.prototype.ca,dt.prototype.getResponseJson=dt.prototype.La,dt.prototype.getResponseText=dt.prototype.la,dt.prototype.send=dt.prototype.ea,dt.prototype.setWithCredentials=dt.prototype.Fa,Zw=dt}).apply(typeof ih<"u"?ih:typeof self<"u"?self:typeof window<"u"?window:{});class lr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}lr.UNAUTHENTICATED=new lr(null),lr.GOOGLE_CREDENTIALS=new lr("google-credentials-uid"),lr.FIRST_PARTY=new lr("first-party-uid"),lr.MOCK_USER=new lr("mock-user");let hc="12.8.0";function gR(n){hc=n}const nl=new Kg("@firebase/firestore");function $l(){return nl.logLevel}function kt(n,...e){if(nl.logLevel<=Ss.DEBUG){const t=e.map(oy);nl.debug(`Firestore (${hc}): ${n}`,...t)}}function Si(n,...e){if(nl.logLevel<=Ss.ERROR){const t=e.map(oy);nl.error(`Firestore (${hc}): ${n}`,...t)}}function tc(n,...e){if(nl.logLevel<=Ss.WARN){const t=e.map(oy);nl.warn(`Firestore (${hc}): ${n}`,...t)}}function oy(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Jt(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,r_(n,i,t)}function r_(n,e,t){let i=`FIRESTORE (${hc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw Si(i),new Error(i)}function Hs(n,e,t,i){let l="Unexpected state";typeof t=="string"?l=t:i=t,n||r_(e,l,i)}function as(n,e){return n}const Le={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class pt extends Xa{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class _i{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class a_{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class yR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(lr.UNAUTHENTICATED)))}shutdown(){}}class bR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class vR{constructor(e){this.t=e,this.currentUser=lr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Hs(this.o===void 0,42304);let i=this.i;const l=g=>this.i!==i?(i=this.i,t(g)):Promise.resolve();let u=new _i;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new _i,e.enqueueRetryable((()=>l(this.currentUser)))};const d=()=>{const g=u;e.enqueueRetryable((async()=>{await g.promise,await l(this.currentUser)}))},p=g=>{kt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((g=>p(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?p(g):(kt("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new _i)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(kt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Hs(typeof i.accessToken=="string",31837,{l:i}),new a_(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Hs(e===null||typeof e=="string",2055,{h:e}),new lr(e)}}class xR{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=lr.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class wR{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new xR(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(lr.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class vx{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class _R{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Wr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Hs(this.o===void 0,3512);const i=u=>{u.error!=null&&kt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const d=u.token!==this.m;return this.m=u.token,kt("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable((()=>i(u)))};const l=u=>{kt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>l(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?l(u):kt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new vx(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Hs(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new vx(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function kR(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class ly{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const l=kR(40);for(let u=0;u<l.length;++u)i.length<20&&l[u]<t&&(i+=e.charAt(l[u]%62))}return i}}function Ns(n,e){return n<e?-1:n>e?1:0}function vg(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const l=n.charAt(i),u=e.charAt(i);if(l!==u)return Op(l)===Op(u)?Ns(l,u):Op(l)?1:-1}return Ns(n.length,e.length)}const jR=55296,TR=57343;function Op(n){const e=n.charCodeAt(0);return e>=jR&&e<=TR}function sc(n,e,t){return n.length===e.length&&n.every(((i,l)=>t(i,e[l])))}const xx="__name__";class Fa{constructor(e,t,i){t===void 0?t=0:t>e.length&&Jt(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Jt(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Fa.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Fa?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let l=0;l<i;l++){const u=Fa.compareSegments(e.get(l),t.get(l));if(u!==0)return u}return Ns(e.length,t.length)}static compareSegments(e,t){const i=Fa.isNumericId(e),l=Fa.isNumericId(t);return i&&!l?-1:!i&&l?1:i&&l?Fa.extractNumericId(e).compare(Fa.extractNumericId(t)):vg(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ho.fromString(e.substring(4,e.length-2))}}class nn extends Fa{construct(e,t,i){return new nn(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new pt(Le.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((l=>l.length>0)))}return new nn(t)}static emptyPath(){return new nn([])}}const SR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class sr extends Fa{construct(e,t,i){return new sr(e,t,i)}static isValidIdentifier(e){return SR.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),sr.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===xx}static keyField(){return new sr([xx])}static fromServerFormat(e){const t=[];let i="",l=0;const u=()=>{if(i.length===0)throw new pt(Le.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let d=!1;for(;l<e.length;){const p=e[l];if(p==="\\"){if(l+1===e.length)throw new pt(Le.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[l+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new pt(Le.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=g,l+=2}else p==="`"?(d=!d,l++):p!=="."||d?(i+=p,l++):(u(),l++)}if(u(),d)throw new pt(Le.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new sr(t)}static emptyPath(){return new sr([])}}class Vt{constructor(e){this.path=e}static fromPath(e){return new Vt(nn.fromString(e))}static fromName(e){return new Vt(nn.fromString(e).popFirst(5))}static empty(){return new Vt(nn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&nn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return nn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Vt(new nn(e.slice()))}}function i_(n,e,t){if(!t)throw new pt(Le.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function ER(n,e,t,i){if(e===!0&&i===!0)throw new pt(Le.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function wx(n){if(!Vt.isDocumentKey(n))throw new pt(Le.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function _x(n){if(Vt.isDocumentKey(n))throw new pt(Le.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function o_(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function om(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Jt(12329,{type:typeof n})}function vr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new pt(Le.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=om(n);throw new pt(Le.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function NR(n,e){if(e<=0)throw new pt(Le.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function In(n,e){const t={typeString:n};return e&&(t.value=e),t}function Hu(n,e){if(!o_(n))throw new pt(Le.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const l=e[i].typeString,u="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const d=n[i];if(l&&typeof d!==l){t=`JSON field '${i}' must be a ${l}.`;break}if(u!==void 0&&d!==u.value){t=`Expected '${i}' field to equal '${u.value}'`;break}}if(t)throw new pt(Le.INVALID_ARGUMENT,t);return!0}const kx=-62135596800,jx=1e6;class Rt{static now(){return Rt.fromMillis(Date.now())}static fromDate(e){return Rt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*jx);return new Rt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new pt(Le.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new pt(Le.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<kx)throw new pt(Le.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new pt(Le.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/jx}_compareTo(e){return this.seconds===e.seconds?Ns(this.nanoseconds,e.nanoseconds):Ns(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Rt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Hu(e,Rt._jsonSchema))return new Rt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-kx;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Rt._jsonSchemaVersion="firestore/timestamp/1.0",Rt._jsonSchema={type:In("string",Rt._jsonSchemaVersion),seconds:In("number"),nanoseconds:In("number")};class ns{static fromTimestamp(e){return new ns(e)}static min(){return new ns(new Rt(0,0))}static max(){return new ns(new Rt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Su=-1;function CR(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,l=ns.fromTimestamp(i===1e9?new Rt(t+1,0):new Rt(t,i));return new go(l,Vt.empty(),e)}function RR(n){return new go(n.readTime,n.key,Su)}class go{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new go(ns.min(),Vt.empty(),Su)}static max(){return new go(ns.max(),Vt.empty(),Su)}}function AR(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Vt.comparator(n.documentKey,e.documentKey),t!==0?t:Ns(n.largestBatchId,e.largestBatchId))}const MR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class IR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function mc(n){if(n.code!==Le.FAILED_PRECONDITION||n.message!==MR)throw n;kt("LocalStore","Unexpectedly lost primary lease")}class He{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Jt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new He(((i,l)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(i,l)},this.catchCallback=u=>{this.wrapFailure(t,u).next(i,l)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof He?t:He.resolve(t)}catch(t){return He.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):He.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):He.reject(t)}static resolve(e){return new He(((t,i)=>{t(e)}))}static reject(e){return new He(((t,i)=>{i(e)}))}static waitFor(e){return new He(((t,i)=>{let l=0,u=0,d=!1;e.forEach((p=>{++l,p.next((()=>{++u,d&&u===l&&t()}),(g=>i(g)))})),d=!0,u===l&&t()}))}static or(e){let t=He.resolve(!1);for(const i of e)t=t.next((l=>l?He.resolve(l):i()));return t}static forEach(e,t){const i=[];return e.forEach(((l,u)=>{i.push(t.call(this,l,u))})),this.waitFor(i)}static mapArray(e,t){return new He(((i,l)=>{const u=e.length,d=new Array(u);let p=0;for(let g=0;g<u;g++){const y=g;t(e[y]).next((x=>{d[y]=x,++p,p===u&&i(d)}),(x=>l(x)))}}))}static doWhile(e,t){return new He(((i,l)=>{const u=()=>{e()===!0?t().next((()=>{u()}),l):i()};u()}))}}function DR(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function fc(n){return n.name==="IndexedDbTransactionError"}class lm{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}lm.ce=-1;const cy=-1;function cm(n){return n==null}function zh(n){return n===0&&1/n==-1/0}function PR(n){return typeof n=="number"&&Number.isInteger(n)&&!zh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const l_="";function LR(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Tx(e)),e=OR(n.get(t),e);return Tx(e)}function OR(n,e){let t=e;const i=n.length;for(let l=0;l<i;l++){const u=n.charAt(l);switch(u){case"\0":t+="";break;case l_:t+="";break;default:t+=u}}return t}function Tx(n){return n+l_+""}function Sx(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function jo(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function c_(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class mn{constructor(e,t){this.comparator=e,this.root=t||tr.EMPTY}insert(e,t){return new mn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,tr.BLACK,null,null))}remove(e){return new mn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,tr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const l=this.comparator(e,i.key);if(l===0)return t+i.left.size;l<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new oh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new oh(this.root,e,this.comparator,!1)}getReverseIterator(){return new oh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new oh(this.root,e,this.comparator,!0)}}class oh{constructor(e,t,i,l){this.isReverse=l,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=t?i(e.key,t):1,t&&l&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class tr{constructor(e,t,i,l,u){this.key=e,this.value=t,this.color=i??tr.RED,this.left=l??tr.EMPTY,this.right=u??tr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,l,u){return new tr(e??this.key,t??this.value,i??this.color,l??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let l=this;const u=i(e,l.key);return l=u<0?l.copy(null,null,null,l.left.insert(e,t,i),null):u===0?l.copy(null,t,null,null,null):l.copy(null,null,null,null,l.right.insert(e,t,i)),l.fixUp()}removeMin(){if(this.left.isEmpty())return tr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,l=this;if(t(e,l.key)<0)l.left.isEmpty()||l.left.isRed()||l.left.left.isRed()||(l=l.moveRedLeft()),l=l.copy(null,null,null,l.left.remove(e,t),null);else{if(l.left.isRed()&&(l=l.rotateRight()),l.right.isEmpty()||l.right.isRed()||l.right.left.isRed()||(l=l.moveRedRight()),t(e,l.key)===0){if(l.right.isEmpty())return tr.EMPTY;i=l.right.min(),l=l.copy(i.key,i.value,null,null,l.right.removeMin())}l=l.copy(null,null,null,null,l.right.remove(e,t))}return l.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,tr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,tr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Jt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Jt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Jt(27949);return e+(this.isRed()?0:1)}}tr.EMPTY=null,tr.RED=!0,tr.BLACK=!1;tr.EMPTY=new class{constructor(){this.size=0}get key(){throw Jt(57766)}get value(){throw Jt(16141)}get color(){throw Jt(16727)}get left(){throw Jt(29726)}get right(){throw Jt(36894)}copy(e,t,i,l,u){return this}insert(e,t,i){return new tr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Fn{constructor(e){this.comparator=e,this.data=new mn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const l=i.getNext();if(this.comparator(l.key,e[1])>=0)return;t(l.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Ex(this.data.getIterator())}getIteratorFrom(e){return new Ex(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Fn)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(this.comparator(l,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Fn(this.comparator);return t.data=e,t}}class Ex{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Gr{constructor(e){this.fields=e,e.sort(sr.comparator)}static empty(){return new Gr([])}unionWith(e){let t=new Fn(sr.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Gr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return sc(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class u_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class nr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(l){try{return atob(l)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new u_("Invalid base64 string: "+u):u}})(e);return new nr(t)}static fromUint8Array(e){const t=(function(l){let u="";for(let d=0;d<l.length;++d)u+=String.fromCharCode(l[d]);return u})(e);return new nr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ns(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}nr.EMPTY_BYTE_STRING=new nr("");const BR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function yo(n){if(Hs(!!n,39018),typeof n=="string"){let e=0;const t=BR.exec(n);if(Hs(!!t,46558,{timestamp:n}),t[1]){let l=t[1];l=(l+"000000000").substr(0,9),e=Number(l)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:jn(n.seconds),nanos:jn(n.nanos)}}function jn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function bo(n){return typeof n=="string"?nr.fromBase64String(n):nr.fromUint8Array(n)}const d_="server_timestamp",h_="__type__",m_="__previous_value__",f_="__local_write_time__";function uy(n){return(n?.mapValue?.fields||{})[h_]?.stringValue===d_}function um(n){const e=n.mapValue.fields[m_];return uy(e)?um(e):e}function Eu(n){const e=yo(n.mapValue.fields[f_].timestampValue);return new Rt(e.seconds,e.nanos)}class VR{constructor(e,t,i,l,u,d,p,g,y,x,_){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=l,this.ssl=u,this.forceLongPolling=d,this.autoDetectLongPolling=p,this.longPollingOptions=g,this.useFetchStreams=y,this.isUsingEmulator=x,this.apiKey=_}}const qh="(default)";class Nu{constructor(e,t){this.projectId=e,this.database=t||qh}static empty(){return new Nu("","")}get isDefaultDatabase(){return this.database===qh}isEqual(e){return e instanceof Nu&&e.projectId===this.projectId&&e.database===this.database}}function UR(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new pt(Le.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Nu(n.options.projectId,e)}const p_="__type__",FR="__max__",lh={mapValue:{}},g_="__vector__",Hh="value";function vo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?uy(n)?4:qR(n)?9007199254740991:zR(n)?10:11:Jt(28295,{value:n})}function Ya(n,e){if(n===e)return!0;const t=vo(n);if(t!==vo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Eu(n).isEqual(Eu(e));case 3:return(function(l,u){if(typeof l.timestampValue=="string"&&typeof u.timestampValue=="string"&&l.timestampValue.length===u.timestampValue.length)return l.timestampValue===u.timestampValue;const d=yo(l.timestampValue),p=yo(u.timestampValue);return d.seconds===p.seconds&&d.nanos===p.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(l,u){return bo(l.bytesValue).isEqual(bo(u.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(l,u){return jn(l.geoPointValue.latitude)===jn(u.geoPointValue.latitude)&&jn(l.geoPointValue.longitude)===jn(u.geoPointValue.longitude)})(n,e);case 2:return(function(l,u){if("integerValue"in l&&"integerValue"in u)return jn(l.integerValue)===jn(u.integerValue);if("doubleValue"in l&&"doubleValue"in u){const d=jn(l.doubleValue),p=jn(u.doubleValue);return d===p?zh(d)===zh(p):isNaN(d)&&isNaN(p)}return!1})(n,e);case 9:return sc(n.arrayValue.values||[],e.arrayValue.values||[],Ya);case 10:case 11:return(function(l,u){const d=l.mapValue.fields||{},p=u.mapValue.fields||{};if(Sx(d)!==Sx(p))return!1;for(const g in d)if(d.hasOwnProperty(g)&&(p[g]===void 0||!Ya(d[g],p[g])))return!1;return!0})(n,e);default:return Jt(52216,{left:n})}}function Cu(n,e){return(n.values||[]).find((t=>Ya(t,e)))!==void 0}function nc(n,e){if(n===e)return 0;const t=vo(n),i=vo(e);if(t!==i)return Ns(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ns(n.booleanValue,e.booleanValue);case 2:return(function(u,d){const p=jn(u.integerValue||u.doubleValue),g=jn(d.integerValue||d.doubleValue);return p<g?-1:p>g?1:p===g?0:isNaN(p)?isNaN(g)?0:-1:1})(n,e);case 3:return Nx(n.timestampValue,e.timestampValue);case 4:return Nx(Eu(n),Eu(e));case 5:return vg(n.stringValue,e.stringValue);case 6:return(function(u,d){const p=bo(u),g=bo(d);return p.compareTo(g)})(n.bytesValue,e.bytesValue);case 7:return(function(u,d){const p=u.split("/"),g=d.split("/");for(let y=0;y<p.length&&y<g.length;y++){const x=Ns(p[y],g[y]);if(x!==0)return x}return Ns(p.length,g.length)})(n.referenceValue,e.referenceValue);case 8:return(function(u,d){const p=Ns(jn(u.latitude),jn(d.latitude));return p!==0?p:Ns(jn(u.longitude),jn(d.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Cx(n.arrayValue,e.arrayValue);case 10:return(function(u,d){const p=u.fields||{},g=d.fields||{},y=p[Hh]?.arrayValue,x=g[Hh]?.arrayValue,_=Ns(y?.values?.length||0,x?.values?.length||0);return _!==0?_:Cx(y,x)})(n.mapValue,e.mapValue);case 11:return(function(u,d){if(u===lh.mapValue&&d===lh.mapValue)return 0;if(u===lh.mapValue)return 1;if(d===lh.mapValue)return-1;const p=u.fields||{},g=Object.keys(p),y=d.fields||{},x=Object.keys(y);g.sort(),x.sort();for(let _=0;_<g.length&&_<x.length;++_){const j=vg(g[_],x[_]);if(j!==0)return j;const O=nc(p[g[_]],y[x[_]]);if(O!==0)return O}return Ns(g.length,x.length)})(n.mapValue,e.mapValue);default:throw Jt(23264,{he:t})}}function Nx(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Ns(n,e);const t=yo(n),i=yo(e),l=Ns(t.seconds,i.seconds);return l!==0?l:Ns(t.nanos,i.nanos)}function Cx(n,e){const t=n.values||[],i=e.values||[];for(let l=0;l<t.length&&l<i.length;++l){const u=nc(t[l],i[l]);if(u)return u}return Ns(t.length,i.length)}function rc(n){return xg(n)}function xg(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=yo(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return bo(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Vt.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",l=!0;for(const u of t.values||[])l?l=!1:i+=",",i+=xg(u);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let l="{",u=!0;for(const d of i)u?u=!1:l+=",",l+=`${d}:${xg(t.fields[d])}`;return l+"}"})(n.mapValue):Jt(61005,{value:n})}function Sh(n){switch(vo(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=um(n);return e?16+Sh(e):16;case 5:return 2*n.stringValue.length;case 6:return bo(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((l,u)=>l+Sh(u)),0)})(n.arrayValue);case 10:case 11:return(function(i){let l=0;return jo(i.fields,((u,d)=>{l+=u.length+Sh(d)})),l})(n.mapValue);default:throw Jt(13486,{value:n})}}function Rx(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function wg(n){return!!n&&"integerValue"in n}function dy(n){return!!n&&"arrayValue"in n}function Ax(n){return!!n&&"nullValue"in n}function Mx(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Eh(n){return!!n&&"mapValue"in n}function zR(n){return(n?.mapValue?.fields||{})[p_]?.stringValue===g_}function yu(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return jo(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=yu(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=yu(n.arrayValue.values[t]);return e}return{...n}}function qR(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===FR}class Pr{constructor(e){this.value=e}static empty(){return new Pr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Eh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=yu(t)}setAll(e){let t=sr.emptyPath(),i={},l=[];e.forEach(((d,p)=>{if(!t.isImmediateParentOf(p)){const g=this.getFieldsMap(t);this.applyChanges(g,i,l),i={},l=[],t=p.popLast()}d?i[p.lastSegment()]=yu(d):l.push(p.lastSegment())}));const u=this.getFieldsMap(t);this.applyChanges(u,i,l)}delete(e){const t=this.field(e.popLast());Eh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ya(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let l=t.mapValue.fields[e.get(i)];Eh(l)&&l.mapValue.fields||(l={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=l),t=l}return t.mapValue.fields}applyChanges(e,t,i){jo(t,((l,u)=>e[l]=u));for(const l of i)delete e[l]}clone(){return new Pr(yu(this.value))}}function y_(n){const e=[];return jo(n.fields,((t,i)=>{const l=new sr([t]);if(Eh(i)){const u=y_(i.mapValue).fields;if(u.length===0)e.push(l);else for(const d of u)e.push(l.child(d))}else e.push(l)})),new Gr(e)}class cr{constructor(e,t,i,l,u,d,p){this.key=e,this.documentType=t,this.version=i,this.readTime=l,this.createTime=u,this.data=d,this.documentState=p}static newInvalidDocument(e){return new cr(e,0,ns.min(),ns.min(),ns.min(),Pr.empty(),0)}static newFoundDocument(e,t,i,l){return new cr(e,1,t,ns.min(),i,l,0)}static newNoDocument(e,t){return new cr(e,2,t,ns.min(),ns.min(),Pr.empty(),0)}static newUnknownDocument(e,t){return new cr(e,3,t,ns.min(),ns.min(),Pr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ns.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Pr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Pr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ns.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof cr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new cr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class $h{constructor(e,t){this.position=e,this.inclusive=t}}function Ix(n,e,t){let i=0;for(let l=0;l<n.position.length;l++){const u=e[l],d=n.position[l];if(u.field.isKeyField()?i=Vt.comparator(Vt.fromName(d.referenceValue),t.key):i=nc(d,t.data.field(u.field)),u.dir==="desc"&&(i*=-1),i!==0)break}return i}function Dx(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ya(n.position[t],e.position[t]))return!1;return!0}class Ru{constructor(e,t="asc"){this.field=e,this.dir=t}}function HR(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class b_{}class Mn extends b_{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new WR(e,t,i):t==="array-contains"?new YR(e,i):t==="in"?new QR(e,i):t==="not-in"?new XR(e,i):t==="array-contains-any"?new JR(e,i):new Mn(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new GR(e,i):new KR(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(nc(t,this.value)):t!==null&&vo(this.value)===vo(t)&&this.matchesComparison(nc(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Jt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ja extends b_{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new ja(e,t)}matches(e){return v_(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function v_(n){return n.op==="and"}function x_(n){return $R(n)&&v_(n)}function $R(n){for(const e of n.filters)if(e instanceof ja)return!1;return!0}function _g(n){if(n instanceof Mn)return n.field.canonicalString()+n.op.toString()+rc(n.value);if(x_(n))return n.filters.map((e=>_g(e))).join(",");{const e=n.filters.map((t=>_g(t))).join(",");return`${n.op}(${e})`}}function w_(n,e){return n instanceof Mn?(function(i,l){return l instanceof Mn&&i.op===l.op&&i.field.isEqual(l.field)&&Ya(i.value,l.value)})(n,e):n instanceof ja?(function(i,l){return l instanceof ja&&i.op===l.op&&i.filters.length===l.filters.length?i.filters.reduce(((u,d,p)=>u&&w_(d,l.filters[p])),!0):!1})(n,e):void Jt(19439)}function __(n){return n instanceof Mn?(function(t){return`${t.field.canonicalString()} ${t.op} ${rc(t.value)}`})(n):n instanceof ja?(function(t){return t.op.toString()+" {"+t.getFilters().map(__).join(" ,")+"}"})(n):"Filter"}class WR extends Mn{constructor(e,t,i){super(e,t,i),this.key=Vt.fromName(i.referenceValue)}matches(e){const t=Vt.comparator(e.key,this.key);return this.matchesComparison(t)}}class GR extends Mn{constructor(e,t){super(e,"in",t),this.keys=k_("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class KR extends Mn{constructor(e,t){super(e,"not-in",t),this.keys=k_("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function k_(n,e){return(e.arrayValue?.values||[]).map((t=>Vt.fromName(t.referenceValue)))}class YR extends Mn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return dy(t)&&Cu(t.arrayValue,this.value)}}class QR extends Mn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Cu(this.value.arrayValue,t)}}class XR extends Mn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Cu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Cu(this.value.arrayValue,t)}}class JR extends Mn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!dy(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Cu(this.value.arrayValue,i)))}}class ZR{constructor(e,t=null,i=[],l=[],u=null,d=null,p=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=l,this.limit=u,this.startAt=d,this.endAt=p,this.Te=null}}function Px(n,e=null,t=[],i=[],l=null,u=null,d=null){return new ZR(n,e,t,i,l,u,d)}function hy(n){const e=as(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>_g(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(u){return u.field.canonicalString()+u.dir})(i))).join(","),cm(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>rc(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>rc(i))).join(",")),e.Te=t}return e.Te}function my(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!HR(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!w_(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Dx(n.startAt,e.startAt)&&Dx(n.endAt,e.endAt)}function kg(n){return Vt.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class pc{constructor(e,t=null,i=[],l=[],u=null,d="F",p=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=l,this.limit=u,this.limitType=d,this.startAt=p,this.endAt=g,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function eA(n,e,t,i,l,u,d,p){return new pc(n,e,t,i,l,u,d,p)}function dm(n){return new pc(n)}function Lx(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function tA(n){return Vt.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function j_(n){return n.collectionGroup!==null}function bu(n){const e=as(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const u of e.explicitOrderBy)e.Ie.push(u),t.add(u.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let p=new Fn(sr.comparator);return d.filters.forEach((g=>{g.getFlattenedFilters().forEach((y=>{y.isInequality()&&(p=p.add(y.field))}))})),p})(e).forEach((u=>{t.has(u.canonicalString())||u.isKeyField()||e.Ie.push(new Ru(u,i))})),t.has(sr.keyField().canonicalString())||e.Ie.push(new Ru(sr.keyField(),i))}return e.Ie}function Wa(n){const e=as(n);return e.Ee||(e.Ee=sA(e,bu(n))),e.Ee}function sA(n,e){if(n.limitType==="F")return Px(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((l=>{const u=l.dir==="desc"?"asc":"desc";return new Ru(l.field,u)}));const t=n.endAt?new $h(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new $h(n.startAt.position,n.startAt.inclusive):null;return Px(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function jg(n,e){const t=n.filters.concat([e]);return new pc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function nA(n,e){const t=n.explicitOrderBy.concat([e]);return new pc(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function Wh(n,e,t){return new pc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function hm(n,e){return my(Wa(n),Wa(e))&&n.limitType===e.limitType}function T_(n){return`${hy(Wa(n))}|lt:${n.limitType}`}function Wl(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((l=>__(l))).join(", ")}]`),cm(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((l=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(l))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((l=>rc(l))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((l=>rc(l))).join(",")),`Target(${i})`})(Wa(n))}; limitType=${n.limitType})`}function mm(n,e){return e.isFoundDocument()&&(function(i,l){const u=l.key.path;return i.collectionGroup!==null?l.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(u):Vt.isDocumentKey(i.path)?i.path.isEqual(u):i.path.isImmediateParentOf(u)})(n,e)&&(function(i,l){for(const u of bu(i))if(!u.field.isKeyField()&&l.data.field(u.field)===null)return!1;return!0})(n,e)&&(function(i,l){for(const u of i.filters)if(!u.matches(l))return!1;return!0})(n,e)&&(function(i,l){return!(i.startAt&&!(function(d,p,g){const y=Ix(d,p,g);return d.inclusive?y<=0:y<0})(i.startAt,bu(i),l)||i.endAt&&!(function(d,p,g){const y=Ix(d,p,g);return d.inclusive?y>=0:y>0})(i.endAt,bu(i),l))})(n,e)}function rA(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function S_(n){return(e,t)=>{let i=!1;for(const l of bu(n)){const u=aA(l,e,t);if(u!==0)return u;i=i||l.field.isKeyField()}return 0}}function aA(n,e,t){const i=n.field.isKeyField()?Vt.comparator(e.key,t.key):(function(u,d,p){const g=d.data.field(u),y=p.data.field(u);return g!==null&&y!==null?nc(g,y):Jt(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Jt(19790,{direction:n.dir})}}class ll{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[l,u]of i)if(this.equalsFn(l,e))return u}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),l=this.inner[i];if(l===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let u=0;u<l.length;u++)if(this.equalsFn(l[u][0],e))return void(l[u]=[e,t]);l.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let l=0;l<i.length;l++)if(this.equalsFn(i[l][0],e))return i.length===1?delete this.inner[t]:i.splice(l,1),this.innerSize--,!0;return!1}forEach(e){jo(this.inner,((t,i)=>{for(const[l,u]of i)e(l,u)}))}isEmpty(){return c_(this.inner)}size(){return this.innerSize}}const iA=new mn(Vt.comparator);function Ei(){return iA}const E_=new mn(Vt.comparator);function hu(...n){let e=E_;for(const t of n)e=e.insert(t.key,t);return e}function N_(n){let e=E_;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Ko(){return vu()}function C_(){return vu()}function vu(){return new ll((n=>n.toString()),((n,e)=>n.isEqual(e)))}const oA=new mn(Vt.comparator),lA=new Fn(Vt.comparator);function Cs(...n){let e=lA;for(const t of n)e=e.add(t);return e}const cA=new Fn(Ns);function uA(){return cA}function fy(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:zh(e)?"-0":e}}function R_(n){return{integerValue:""+n}}function A_(n,e){return PR(e)?R_(e):fy(n,e)}class fm{constructor(){this._=void 0}}function dA(n,e,t){return n instanceof Au?(function(l,u){const d={fields:{[h_]:{stringValue:d_},[f_]:{timestampValue:{seconds:l.seconds,nanos:l.nanoseconds}}}};return u&&uy(u)&&(u=um(u)),u&&(d.fields[m_]=u),{mapValue:d}})(t,e):n instanceof Mu?I_(n,e):n instanceof Iu?D_(n,e):(function(l,u){const d=M_(l,u),p=Ox(d)+Ox(l.Ae);return wg(d)&&wg(l.Ae)?R_(p):fy(l.serializer,p)})(n,e)}function hA(n,e,t){return n instanceof Mu?I_(n,e):n instanceof Iu?D_(n,e):t}function M_(n,e){return n instanceof Du?(function(i){return wg(i)||(function(u){return!!u&&"doubleValue"in u})(i)})(e)?e:{integerValue:0}:null}class Au extends fm{}class Mu extends fm{constructor(e){super(),this.elements=e}}function I_(n,e){const t=P_(e);for(const i of n.elements)t.some((l=>Ya(l,i)))||t.push(i);return{arrayValue:{values:t}}}class Iu extends fm{constructor(e){super(),this.elements=e}}function D_(n,e){let t=P_(e);for(const i of n.elements)t=t.filter((l=>!Ya(l,i)));return{arrayValue:{values:t}}}class Du extends fm{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Ox(n){return jn(n.integerValue||n.doubleValue)}function P_(n){return dy(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class L_{constructor(e,t){this.field=e,this.transform=t}}function mA(n,e){return n.field.isEqual(e.field)&&(function(i,l){return i instanceof Mu&&l instanceof Mu||i instanceof Iu&&l instanceof Iu?sc(i.elements,l.elements,Ya):i instanceof Du&&l instanceof Du?Ya(i.Ae,l.Ae):i instanceof Au&&l instanceof Au})(n.transform,e.transform)}class fA{constructor(e,t){this.version=e,this.transformResults=t}}class xr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new xr}static exists(e){return new xr(void 0,e)}static updateTime(e){return new xr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Nh(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class pm{}function O_(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new gm(n.key,xr.none()):new $u(n.key,n.data,xr.none());{const t=n.data,i=Pr.empty();let l=new Fn(sr.comparator);for(let u of e.fields)if(!l.has(u)){let d=t.field(u);d===null&&u.length>1&&(u=u.popLast(),d=t.field(u)),d===null?i.delete(u):i.set(u,d),l=l.add(u)}return new To(n.key,i,new Gr(l.toArray()),xr.none())}}function pA(n,e,t){n instanceof $u?(function(l,u,d){const p=l.value.clone(),g=Vx(l.fieldTransforms,u,d.transformResults);p.setAll(g),u.convertToFoundDocument(d.version,p).setHasCommittedMutations()})(n,e,t):n instanceof To?(function(l,u,d){if(!Nh(l.precondition,u))return void u.convertToUnknownDocument(d.version);const p=Vx(l.fieldTransforms,u,d.transformResults),g=u.data;g.setAll(B_(l)),g.setAll(p),u.convertToFoundDocument(d.version,g).setHasCommittedMutations()})(n,e,t):(function(l,u,d){u.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function xu(n,e,t,i){return n instanceof $u?(function(u,d,p,g){if(!Nh(u.precondition,d))return p;const y=u.value.clone(),x=Ux(u.fieldTransforms,g,d);return y.setAll(x),d.convertToFoundDocument(d.version,y).setHasLocalMutations(),null})(n,e,t,i):n instanceof To?(function(u,d,p,g){if(!Nh(u.precondition,d))return p;const y=Ux(u.fieldTransforms,g,d),x=d.data;return x.setAll(B_(u)),x.setAll(y),d.convertToFoundDocument(d.version,x).setHasLocalMutations(),p===null?null:p.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((_=>_.field)))})(n,e,t,i):(function(u,d,p){return Nh(u.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):p})(n,e,t)}function gA(n,e){let t=null;for(const i of n.fieldTransforms){const l=e.data.field(i.field),u=M_(i.transform,l||null);u!=null&&(t===null&&(t=Pr.empty()),t.set(i.field,u))}return t||null}function Bx(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,l){return i===void 0&&l===void 0||!(!i||!l)&&sc(i,l,((u,d)=>mA(u,d)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class $u extends pm{constructor(e,t,i,l=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=l,this.type=0}getFieldMask(){return null}}class To extends pm{constructor(e,t,i,l,u=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=l,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function B_(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function Vx(n,e,t){const i=new Map;Hs(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let l=0;l<t.length;l++){const u=n[l],d=u.transform,p=e.data.field(u.field);i.set(u.field,hA(d,p,t[l]))}return i}function Ux(n,e,t){const i=new Map;for(const l of n){const u=l.transform,d=t.data.field(l.field);i.set(l.field,dA(u,d,e))}return i}class gm extends pm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class yA extends pm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class bA{constructor(e,t,i,l){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=l}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let l=0;l<this.mutations.length;l++){const u=this.mutations[l];u.key.isEqual(e.key)&&pA(u,e,i[l])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=xu(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=xu(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=C_();return this.mutations.forEach((l=>{const u=e.get(l.key),d=u.overlayedDocument;let p=this.applyToLocalView(d,u.mutatedFields);p=t.has(l.key)?null:p;const g=O_(d,p);g!==null&&i.set(l.key,g),d.isValidDocument()||d.convertToNoDocument(ns.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Cs())}isEqual(e){return this.batchId===e.batchId&&sc(this.mutations,e.mutations,((t,i)=>Bx(t,i)))&&sc(this.baseMutations,e.baseMutations,((t,i)=>Bx(t,i)))}}class py{constructor(e,t,i,l){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=l}static from(e,t,i){Hs(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let l=(function(){return oA})();const u=e.mutations;for(let d=0;d<u.length;d++)l=l.insert(u[d].key,i[d].version);return new py(e,t,i,l)}}class vA{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class xA{constructor(e,t){this.count=e,this.unchangedNames=t}}var An,Is;function wA(n){switch(n){case Le.OK:return Jt(64938);case Le.CANCELLED:case Le.UNKNOWN:case Le.DEADLINE_EXCEEDED:case Le.RESOURCE_EXHAUSTED:case Le.INTERNAL:case Le.UNAVAILABLE:case Le.UNAUTHENTICATED:return!1;case Le.INVALID_ARGUMENT:case Le.NOT_FOUND:case Le.ALREADY_EXISTS:case Le.PERMISSION_DENIED:case Le.FAILED_PRECONDITION:case Le.ABORTED:case Le.OUT_OF_RANGE:case Le.UNIMPLEMENTED:case Le.DATA_LOSS:return!0;default:return Jt(15467,{code:n})}}function V_(n){if(n===void 0)return Si("GRPC error has no .code"),Le.UNKNOWN;switch(n){case An.OK:return Le.OK;case An.CANCELLED:return Le.CANCELLED;case An.UNKNOWN:return Le.UNKNOWN;case An.DEADLINE_EXCEEDED:return Le.DEADLINE_EXCEEDED;case An.RESOURCE_EXHAUSTED:return Le.RESOURCE_EXHAUSTED;case An.INTERNAL:return Le.INTERNAL;case An.UNAVAILABLE:return Le.UNAVAILABLE;case An.UNAUTHENTICATED:return Le.UNAUTHENTICATED;case An.INVALID_ARGUMENT:return Le.INVALID_ARGUMENT;case An.NOT_FOUND:return Le.NOT_FOUND;case An.ALREADY_EXISTS:return Le.ALREADY_EXISTS;case An.PERMISSION_DENIED:return Le.PERMISSION_DENIED;case An.FAILED_PRECONDITION:return Le.FAILED_PRECONDITION;case An.ABORTED:return Le.ABORTED;case An.OUT_OF_RANGE:return Le.OUT_OF_RANGE;case An.UNIMPLEMENTED:return Le.UNIMPLEMENTED;case An.DATA_LOSS:return Le.DATA_LOSS;default:return Jt(39323,{code:n})}}(Is=An||(An={}))[Is.OK=0]="OK",Is[Is.CANCELLED=1]="CANCELLED",Is[Is.UNKNOWN=2]="UNKNOWN",Is[Is.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Is[Is.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Is[Is.NOT_FOUND=5]="NOT_FOUND",Is[Is.ALREADY_EXISTS=6]="ALREADY_EXISTS",Is[Is.PERMISSION_DENIED=7]="PERMISSION_DENIED",Is[Is.UNAUTHENTICATED=16]="UNAUTHENTICATED",Is[Is.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Is[Is.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Is[Is.ABORTED=10]="ABORTED",Is[Is.OUT_OF_RANGE=11]="OUT_OF_RANGE",Is[Is.UNIMPLEMENTED=12]="UNIMPLEMENTED",Is[Is.INTERNAL=13]="INTERNAL",Is[Is.UNAVAILABLE=14]="UNAVAILABLE",Is[Is.DATA_LOSS=15]="DATA_LOSS";function _A(){return new TextEncoder}const kA=new ho([4294967295,4294967295],0);function Fx(n){const e=_A().encode(n),t=new Jw;return t.update(e),new Uint8Array(t.digest())}function zx(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),l=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new ho([t,i],0),new ho([l,u],0)]}class gy{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new mu(`Invalid padding: ${t}`);if(i<0)throw new mu(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new mu(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new mu(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=ho.fromNumber(this.ge)}ye(e,t,i){let l=e.add(t.multiply(ho.fromNumber(i)));return l.compare(kA)===1&&(l=new ho([l.getBits(0),l.getBits(1)],0)),l.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Fx(e),[i,l]=zx(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);if(!this.we(d))return!1}return!0}static create(e,t,i){const l=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),d=new gy(u,l,t);return i.forEach((p=>d.insert(p))),d}insert(e){if(this.ge===0)return;const t=Fx(e),[i,l]=zx(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);this.be(d)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class mu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class ym{constructor(e,t,i,l,u){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=l,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const l=new Map;return l.set(e,Wu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new ym(ns.min(),l,new mn(Ns),Ei(),Cs())}}class Wu{constructor(e,t,i,l,u){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=l,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Wu(i,t,Cs(),Cs(),Cs())}}class Ch{constructor(e,t,i,l){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=l}}class U_{constructor(e,t){this.targetId=e,this.Ce=t}}class F_{constructor(e,t,i=nr.EMPTY_BYTE_STRING,l=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=l}}class qx{constructor(){this.ve=0,this.Fe=Hx(),this.Me=nr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Cs(),t=Cs(),i=Cs();return this.Fe.forEach(((l,u)=>{switch(u){case 0:e=e.add(l);break;case 2:t=t.add(l);break;case 1:i=i.add(l);break;default:Jt(38017,{changeType:u})}})),new Wu(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=Hx()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Hs(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class jA{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ei(),this.He=ch(),this.Je=ch(),this.Ze=new mn(Ns)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:Jt(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,l)=>{this.rt(l)&&t(l)}))}st(e){const t=e.targetId,i=e.Ce.count,l=this.ot(t);if(l){const u=l.target;if(kg(u))if(i===0){const d=new Vt(u.path);this.et(t,d,cr.newNoDocument(d,ns.min()))}else Hs(i===1,20013,{expectedCount:i});else{const d=this._t(t);if(d!==i){const p=this.ut(e),g=p?this.ct(p,e,d):1;if(g!==0){this.it(t);const y=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,y)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:l=0},hashCount:u=0}=t;let d,p;try{d=bo(i).toUint8Array()}catch(g){if(g instanceof u_)return tc("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{p=new gy(d,l,u)}catch(g){return tc(g instanceof mu?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return p.ge===0?null:p}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let l=0;return i.forEach((u=>{const d=this.Ge.ht(),p=`projects/${d.projectId}/databases/${d.database}/documents/${u.path.canonicalString()}`;e.mightContain(p)||(this.et(t,u,null),l++)})),l}Tt(e){const t=new Map;this.ze.forEach(((u,d)=>{const p=this.ot(d);if(p){if(u.current&&kg(p.target)){const g=new Vt(p.target.path);this.It(g).has(d)||this.Et(d,g)||this.et(d,g,cr.newNoDocument(g,e))}u.Be&&(t.set(d,u.ke()),u.Ke())}}));let i=Cs();this.Je.forEach(((u,d)=>{let p=!0;d.forEachWhile((g=>{const y=this.ot(g);return!y||y.purpose==="TargetPurposeLimboResolution"||(p=!1,!1)})),p&&(i=i.add(u))})),this.je.forEach(((u,d)=>d.setReadTime(e)));const l=new ym(e,t,this.Ze,this.je,i);return this.je=Ei(),this.He=ch(),this.Je=ch(),this.Ze=new mn(Ns),l}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const l=this.nt(e);this.Et(e,t)?l.qe(t,1):l.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new qx,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Fn(Ns),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Fn(Ns),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||kt("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new qx),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function ch(){return new mn(Vt.comparator)}function Hx(){return new mn(Vt.comparator)}const TA={asc:"ASCENDING",desc:"DESCENDING"},SA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},EA={and:"AND",or:"OR"};class NA{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Tg(n,e){return n.useProto3Json||cm(e)?e:{value:e}}function Gh(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function z_(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function CA(n,e){return Gh(n,e.toTimestamp())}function Ga(n){return Hs(!!n,49232),ns.fromTimestamp((function(t){const i=yo(t);return new Rt(i.seconds,i.nanos)})(n))}function yy(n,e){return Sg(n,e).canonicalString()}function Sg(n,e){const t=(function(l){return new nn(["projects",l.projectId,"databases",l.database])})(n).child("documents");return e===void 0?t:t.child(e)}function q_(n){const e=nn.fromString(n);return Hs(K_(e),10190,{key:e.toString()}),e}function Eg(n,e){return yy(n.databaseId,e.path)}function Bp(n,e){const t=q_(e);if(t.get(1)!==n.databaseId.projectId)throw new pt(Le.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new pt(Le.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Vt($_(t))}function H_(n,e){return yy(n.databaseId,e)}function RA(n){const e=q_(n);return e.length===4?nn.emptyPath():$_(e)}function Ng(n){return new nn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function $_(n){return Hs(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function $x(n,e,t){return{name:Eg(n,e),fields:t.value.mapValue.fields}}function AA(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:Jt(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),l=e.targetChange.targetIds||[],u=(function(y,x){return y.useProto3Json?(Hs(x===void 0||typeof x=="string",58123),nr.fromBase64String(x||"")):(Hs(x===void 0||x instanceof Buffer||x instanceof Uint8Array,16193),nr.fromUint8Array(x||new Uint8Array))})(n,e.targetChange.resumeToken),d=e.targetChange.cause,p=d&&(function(y){const x=y.code===void 0?Le.UNKNOWN:V_(y.code);return new pt(x,y.message||"")})(d);t=new F_(i,l,u,p||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const l=Bp(n,i.document.name),u=Ga(i.document.updateTime),d=i.document.createTime?Ga(i.document.createTime):ns.min(),p=new Pr({mapValue:{fields:i.document.fields}}),g=cr.newFoundDocument(l,u,d,p),y=i.targetIds||[],x=i.removedTargetIds||[];t=new Ch(y,x,g.key,g)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const l=Bp(n,i.document),u=i.readTime?Ga(i.readTime):ns.min(),d=cr.newNoDocument(l,u),p=i.removedTargetIds||[];t=new Ch([],p,d.key,d)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const l=Bp(n,i.document),u=i.removedTargetIds||[];t=new Ch([],u,l,null)}else{if(!("filter"in e))return Jt(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:l=0,unchangedNames:u}=i,d=new xA(l,u),p=i.targetId;t=new U_(p,d)}}return t}function MA(n,e){let t;if(e instanceof $u)t={update:$x(n,e.key,e.value)};else if(e instanceof gm)t={delete:Eg(n,e.key)};else if(e instanceof To)t={update:$x(n,e.key,e.data),updateMask:FA(e.fieldMask)};else{if(!(e instanceof yA))return Jt(16599,{dt:e.type});t={verify:Eg(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(u,d){const p=d.transform;if(p instanceof Au)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(p instanceof Mu)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:p.elements}};if(p instanceof Iu)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:p.elements}};if(p instanceof Du)return{fieldPath:d.field.canonicalString(),increment:p.Ae};throw Jt(20930,{transform:d.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(l,u){return u.updateTime!==void 0?{updateTime:CA(l,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:Jt(27497)})(n,e.precondition)),t}function IA(n,e){return n&&n.length>0?(Hs(e!==void 0,14353),n.map((t=>(function(l,u){let d=l.updateTime?Ga(l.updateTime):Ga(u);return d.isEqual(ns.min())&&(d=Ga(u)),new fA(d,l.transformResults||[])})(t,e)))):[]}function DA(n,e){return{documents:[H_(n,e.path)]}}function PA(n,e){const t={structuredQuery:{}},i=e.path;let l;e.collectionGroup!==null?(l=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(l=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=H_(n,l);const u=(function(y){if(y.length!==0)return G_(ja.create(y,"and"))})(e.filters);u&&(t.structuredQuery.where=u);const d=(function(y){if(y.length!==0)return y.map((x=>(function(j){return{field:Gl(j.field),direction:BA(j.dir)}})(x)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const p=Tg(n,e.limit);return p!==null&&(t.structuredQuery.limit=p),e.startAt&&(t.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{ft:t,parent:l}}function LA(n){let e=RA(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let l=null;if(i>0){Hs(i===1,65062);const x=t.from[0];x.allDescendants?l=x.collectionId:e=e.child(x.collectionId)}let u=[];t.where&&(u=(function(_){const j=W_(_);return j instanceof ja&&x_(j)?j.getFilters():[j]})(t.where));let d=[];t.orderBy&&(d=(function(_){return _.map((j=>(function(K){return new Ru(Kl(K.field),(function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(K.direction))})(j)))})(t.orderBy));let p=null;t.limit&&(p=(function(_){let j;return j=typeof _=="object"?_.value:_,cm(j)?null:j})(t.limit));let g=null;t.startAt&&(g=(function(_){const j=!!_.before,O=_.values||[];return new $h(O,j)})(t.startAt));let y=null;return t.endAt&&(y=(function(_){const j=!_.before,O=_.values||[];return new $h(O,j)})(t.endAt)),eA(e,l,d,u,p,"F",g,y)}function OA(n,e){const t=(function(l){switch(l){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Jt(28987,{purpose:l})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function W_(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Kl(t.unaryFilter.field);return Mn.create(i,"==",{doubleValue:NaN});case"IS_NULL":const l=Kl(t.unaryFilter.field);return Mn.create(l,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=Kl(t.unaryFilter.field);return Mn.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=Kl(t.unaryFilter.field);return Mn.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Jt(61313);default:return Jt(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Mn.create(Kl(t.fieldFilter.field),(function(l){switch(l){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Jt(58110);default:return Jt(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return ja.create(t.compositeFilter.filters.map((i=>W_(i))),(function(l){switch(l){case"AND":return"and";case"OR":return"or";default:return Jt(1026)}})(t.compositeFilter.op))})(n):Jt(30097,{filter:n})}function BA(n){return TA[n]}function VA(n){return SA[n]}function UA(n){return EA[n]}function Gl(n){return{fieldPath:n.canonicalString()}}function Kl(n){return sr.fromServerFormat(n.fieldPath)}function G_(n){return n instanceof Mn?(function(t){if(t.op==="=="){if(Mx(t.value))return{unaryFilter:{field:Gl(t.field),op:"IS_NAN"}};if(Ax(t.value))return{unaryFilter:{field:Gl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Mx(t.value))return{unaryFilter:{field:Gl(t.field),op:"IS_NOT_NAN"}};if(Ax(t.value))return{unaryFilter:{field:Gl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Gl(t.field),op:VA(t.op),value:t.value}}})(n):n instanceof ja?(function(t){const i=t.getFilters().map((l=>G_(l)));return i.length===1?i[0]:{compositeFilter:{op:UA(t.op),filters:i}}})(n):Jt(54877,{filter:n})}function FA(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function K_(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function Y_(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}class lo{constructor(e,t,i,l,u=ns.min(),d=ns.min(),p=nr.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=l,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=p,this.expectedCount=g}withSequenceNumber(e){return new lo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new lo(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new lo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new lo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class zA{constructor(e){this.yt=e}}function qA(n){const e=LA({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Wh(e,e.limit,"L"):e}class HA{constructor(){this.Sn=new $A}addToCollectionParentIndex(e,t){return this.Sn.add(t),He.resolve()}getCollectionParents(e,t){return He.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return He.resolve()}deleteFieldIndex(e,t){return He.resolve()}deleteAllFieldIndexes(e){return He.resolve()}createTargetIndexes(e,t){return He.resolve()}getDocumentsMatchingTarget(e,t){return He.resolve(null)}getIndexType(e,t){return He.resolve(0)}getFieldIndexes(e,t){return He.resolve([])}getNextCollectionGroupToUpdate(e){return He.resolve(null)}getMinOffset(e,t){return He.resolve(go.min())}getMinOffsetFromCollectionGroup(e,t){return He.resolve(go.min())}updateCollectionGroup(e,t,i){return He.resolve()}updateIndexEntries(e,t){return He.resolve()}}class $A{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t]||new Fn(nn.comparator),u=!l.has(i);return this.index[t]=l.add(i),u}has(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t];return l&&l.has(i)}getEntries(e){return(this.index[e]||new Fn(nn.comparator)).toArray()}}const Wx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Q_=41943040;class Dr{static withCacheSize(e){return new Dr(e,Dr.DEFAULT_COLLECTION_PERCENTILE,Dr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}Dr.DEFAULT_COLLECTION_PERCENTILE=10,Dr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Dr.DEFAULT=new Dr(Q_,Dr.DEFAULT_COLLECTION_PERCENTILE,Dr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Dr.DISABLED=new Dr(-1,0,0);class ac{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new ac(0)}static ar(){return new ac(-1)}}const Gx="LruGarbageCollector",WA=1048576;function Kx([n,e],[t,i]){const l=Ns(n,t);return l===0?Ns(e,i):l}class GA{constructor(e){this.Pr=e,this.buffer=new Fn(Kx),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();Kx(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class KA{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){kt(Gx,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){fc(t)?kt(Gx,"Ignoring IndexedDB error during garbage collection: ",t):await mc(t)}await this.Ar(3e5)}))}}class YA{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return He.resolve(lm.ce);const i=new GA(t);return this.Vr.forEachTarget(e,(l=>i.Er(l.sequenceNumber))).next((()=>this.Vr.mr(e,(l=>i.Er(l))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(kt("LruGarbageCollector","Garbage collection skipped; disabled"),He.resolve(Wx)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(kt("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Wx):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,l,u,d,p,g,y;const x=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((_=>(_>this.params.maximumSequenceNumbersToCollect?(kt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${_}`),l=this.params.maximumSequenceNumbersToCollect):l=_,d=Date.now(),this.nthSequenceNumber(e,l)))).next((_=>(i=_,p=Date.now(),this.removeTargets(e,i,t)))).next((_=>(u=_,g=Date.now(),this.removeOrphanedDocuments(e,i)))).next((_=>(y=Date.now(),$l()<=Ss.DEBUG&&kt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-x}ms
	Determined least recently used ${l} in `+(p-d)+`ms
	Removed ${u} targets in `+(g-p)+`ms
	Removed ${_} documents in `+(y-g)+`ms
Total Duration: ${y-x}ms`),He.resolve({didRun:!0,sequenceNumbersCollected:l,targetsRemoved:u,documentsRemoved:_}))))}}function QA(n,e){return new YA(n,e)}class XA{constructor(){this.changes=new ll((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,cr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?He.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class JA{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class ZA{constructor(e,t,i,l){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=l}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((l=>(i=l,this.remoteDocumentCache.getEntry(e,t)))).next((l=>(i!==null&&xu(i.mutation,l,Gr.empty(),Rt.now()),l)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Cs()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Cs()){const l=Ko();return this.populateOverlays(e,l,t).next((()=>this.computeViews(e,t,l,i).next((u=>{let d=hu();return u.forEach(((p,g)=>{d=d.insert(p,g.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const i=Ko();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Cs())))}populateOverlays(e,t,i){const l=[];return i.forEach((u=>{t.has(u)||l.push(u)})),this.documentOverlayCache.getOverlays(e,l).next((u=>{u.forEach(((d,p)=>{t.set(d,p)}))}))}computeViews(e,t,i,l){let u=Ei();const d=vu(),p=(function(){return vu()})();return t.forEach(((g,y)=>{const x=i.get(y.key);l.has(y.key)&&(x===void 0||x.mutation instanceof To)?u=u.insert(y.key,y):x!==void 0?(d.set(y.key,x.mutation.getFieldMask()),xu(x.mutation,y,x.mutation.getFieldMask(),Rt.now())):d.set(y.key,Gr.empty())})),this.recalculateAndSaveOverlays(e,u).next((g=>(g.forEach(((y,x)=>d.set(y,x))),t.forEach(((y,x)=>p.set(y,new JA(x,d.get(y)??null)))),p)))}recalculateAndSaveOverlays(e,t){const i=vu();let l=new mn(((d,p)=>d-p)),u=Cs();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const p of d)p.keys().forEach((g=>{const y=t.get(g);if(y===null)return;let x=i.get(g)||Gr.empty();x=p.applyToLocalView(y,x),i.set(g,x);const _=(l.get(p.batchId)||Cs()).add(g);l=l.insert(p.batchId,_)}))})).next((()=>{const d=[],p=l.getReverseIterator();for(;p.hasNext();){const g=p.getNext(),y=g.key,x=g.value,_=C_();x.forEach((j=>{if(!u.has(j)){const O=O_(t.get(j),i.get(j));O!==null&&_.set(j,O),u=u.add(j)}})),d.push(this.documentOverlayCache.saveOverlays(e,y,_))}return He.waitFor(d)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,l){return tA(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):j_(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,l):this.getDocumentsMatchingCollectionQuery(e,t,i,l)}getNextDocuments(e,t,i,l){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,l).next((u=>{const d=l-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,l-u.size):He.resolve(Ko());let p=Su,g=u;return d.next((y=>He.forEach(y,((x,_)=>(p<_.largestBatchId&&(p=_.largestBatchId),u.get(x)?He.resolve():this.remoteDocumentCache.getEntry(e,x).next((j=>{g=g.insert(x,j)}))))).next((()=>this.populateOverlays(e,y,u))).next((()=>this.computeViews(e,g,y,Cs()))).next((x=>({batchId:p,changes:N_(x)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Vt(t)).next((i=>{let l=hu();return i.isFoundDocument()&&(l=l.insert(i.key,i)),l}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,l){const u=t.collectionGroup;let d=hu();return this.indexManager.getCollectionParents(e,u).next((p=>He.forEach(p,(g=>{const y=(function(_,j){return new pc(j,null,_.explicitOrderBy.slice(),_.filters.slice(),_.limit,_.limitType,_.startAt,_.endAt)})(t,g.child(u));return this.getDocumentsMatchingCollectionQuery(e,y,i,l).next((x=>{x.forEach(((_,j)=>{d=d.insert(_,j)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,i,l){let u;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((d=>(u=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,u,l)))).next((d=>{u.forEach(((g,y)=>{const x=y.getKey();d.get(x)===null&&(d=d.insert(x,cr.newInvalidDocument(x)))}));let p=hu();return d.forEach(((g,y)=>{const x=u.get(g);x!==void 0&&xu(x.mutation,y,Gr.empty(),Rt.now()),mm(t,y)&&(p=p.insert(g,y))})),p}))}}class e3{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return He.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(l){return{id:l.id,version:l.version,createTime:Ga(l.createTime)}})(t)),He.resolve()}getNamedQuery(e,t){return He.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(l){return{name:l.name,query:qA(l.bundledQuery),readTime:Ga(l.readTime)}})(t)),He.resolve()}}class t3{constructor(){this.overlays=new mn(Vt.comparator),this.Lr=new Map}getOverlay(e,t){return He.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Ko();return He.forEach(t,(l=>this.getOverlay(e,l).next((u=>{u!==null&&i.set(l,u)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((l,u)=>{this.bt(e,t,u)})),He.resolve()}removeOverlaysForBatchId(e,t,i){const l=this.Lr.get(i);return l!==void 0&&(l.forEach((u=>this.overlays=this.overlays.remove(u))),this.Lr.delete(i)),He.resolve()}getOverlaysForCollection(e,t,i){const l=Ko(),u=t.length+1,d=new Vt(t.child("")),p=this.overlays.getIteratorFrom(d);for(;p.hasNext();){const g=p.getNext().value,y=g.getKey();if(!t.isPrefixOf(y.path))break;y.path.length===u&&g.largestBatchId>i&&l.set(g.getKey(),g)}return He.resolve(l)}getOverlaysForCollectionGroup(e,t,i,l){let u=new mn(((y,x)=>y-x));const d=this.overlays.getIterator();for(;d.hasNext();){const y=d.getNext().value;if(y.getKey().getCollectionGroup()===t&&y.largestBatchId>i){let x=u.get(y.largestBatchId);x===null&&(x=Ko(),u=u.insert(y.largestBatchId,x)),x.set(y.getKey(),y)}}const p=Ko(),g=u.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((y,x)=>p.set(y,x))),!(p.size()>=l)););return He.resolve(p)}bt(e,t,i){const l=this.overlays.get(i.key);if(l!==null){const d=this.Lr.get(l.largestBatchId).delete(i.key);this.Lr.set(l.largestBatchId,d)}this.overlays=this.overlays.insert(i.key,new vA(t,i));let u=this.Lr.get(t);u===void 0&&(u=Cs(),this.Lr.set(t,u)),this.Lr.set(t,u.add(i.key))}}class s3{constructor(){this.sessionToken=nr.EMPTY_BYTE_STRING}getSessionToken(e){return He.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,He.resolve()}}class by{constructor(){this.kr=new Fn(Wn.Kr),this.qr=new Fn(Wn.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new Wn(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new Wn(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new Vt(new nn([])),i=new Wn(t,e),l=new Wn(t,e+1),u=[];return this.qr.forEachInRange([i,l],(d=>{this.Wr(d),u.push(d.key)})),u}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new Vt(new nn([])),i=new Wn(t,e),l=new Wn(t,e+1);let u=Cs();return this.qr.forEachInRange([i,l],(d=>{u=u.add(d.key)})),u}containsKey(e){const t=new Wn(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Wn{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return Vt.comparator(e.key,t.key)||Ns(e.Hr,t.Hr)}static Ur(e,t){return Ns(e.Hr,t.Hr)||Vt.comparator(e.key,t.key)}}class n3{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Fn(Wn.Kr)}checkEmpty(e){return He.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,l){const u=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new bA(u,t,i,l);this.mutationQueue.push(d);for(const p of l)this.Jr=this.Jr.add(new Wn(p.key,u)),this.indexManager.addToCollectionParentIndex(e,p.key.path.popLast());return He.resolve(d)}lookupMutationBatch(e,t){return He.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,l=this.Xr(i),u=l<0?0:l;return He.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return He.resolve(this.mutationQueue.length===0?cy:this.Yn-1)}getAllMutationBatches(e){return He.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Wn(t,0),l=new Wn(t,Number.POSITIVE_INFINITY),u=[];return this.Jr.forEachInRange([i,l],(d=>{const p=this.Zr(d.Hr);u.push(p)})),He.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Fn(Ns);return t.forEach((l=>{const u=new Wn(l,0),d=new Wn(l,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([u,d],(p=>{i=i.add(p.Hr)}))})),He.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,l=i.length+1;let u=i;Vt.isDocumentKey(u)||(u=u.child(""));const d=new Wn(new Vt(u),0);let p=new Fn(Ns);return this.Jr.forEachWhile((g=>{const y=g.key.path;return!!i.isPrefixOf(y)&&(y.length===l&&(p=p.add(g.Hr)),!0)}),d),He.resolve(this.Yr(p))}Yr(e){const t=[];return e.forEach((i=>{const l=this.Zr(i);l!==null&&t.push(l)})),t}removeMutationBatch(e,t){Hs(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return He.forEach(t.mutations,(l=>{const u=new Wn(l.key,t.batchId);return i=i.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,l.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new Wn(t,0),l=this.Jr.firstAfterOrEqual(i);return He.resolve(t.isEqual(l&&l.key))}performConsistencyCheck(e){return this.mutationQueue.length,He.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class r3{constructor(e){this.ti=e,this.docs=(function(){return new mn(Vt.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,l=this.docs.get(i),u=l?l.size:0,d=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:d}),this.size+=d-u,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return He.resolve(i?i.document.mutableCopy():cr.newInvalidDocument(t))}getEntries(e,t){let i=Ei();return t.forEach((l=>{const u=this.docs.get(l);i=i.insert(l,u?u.document.mutableCopy():cr.newInvalidDocument(l))})),He.resolve(i)}getDocumentsMatchingQuery(e,t,i,l){let u=Ei();const d=t.path,p=new Vt(d.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(p);for(;g.hasNext();){const{key:y,value:{document:x}}=g.getNext();if(!d.isPrefixOf(y.path))break;y.path.length>d.length+1||AR(RR(x),i)<=0||(l.has(x.key)||mm(t,x))&&(u=u.insert(x.key,x.mutableCopy()))}return He.resolve(u)}getAllFromCollectionGroup(e,t,i,l){Jt(9500)}ni(e,t){return He.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new a3(this)}getSize(e){return He.resolve(this.size)}}class a3 extends XA{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,l)=>{l.isValidDocument()?t.push(this.Mr.addEntry(e,l)):this.Mr.removeEntry(i)})),He.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class i3{constructor(e){this.persistence=e,this.ri=new ll((t=>hy(t)),my),this.lastRemoteSnapshotVersion=ns.min(),this.highestTargetId=0,this.ii=0,this.si=new by,this.targetCount=0,this.oi=ac._r()}forEachTarget(e,t){return this.ri.forEach(((i,l)=>t(l))),He.resolve()}getLastRemoteSnapshotVersion(e){return He.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return He.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),He.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),He.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new ac(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,He.resolve()}updateTargetData(e,t){return this.lr(t),He.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,He.resolve()}removeTargets(e,t,i){let l=0;const u=[];return this.ri.forEach(((d,p)=>{p.sequenceNumber<=t&&i.get(p.targetId)===null&&(this.ri.delete(d),u.push(this.removeMatchingKeysForTargetId(e,p.targetId)),l++)})),He.waitFor(u).next((()=>l))}getTargetCount(e){return He.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return He.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),He.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const l=this.persistence.referenceDelegate,u=[];return l&&t.forEach((d=>{u.push(l.markPotentiallyOrphaned(e,d))})),He.waitFor(u)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),He.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return He.resolve(i)}containsKey(e,t){return He.resolve(this.si.containsKey(t))}}class X_{constructor(e,t){this._i={},this.overlays={},this.ai=new lm(0),this.ui=!1,this.ui=!0,this.ci=new s3,this.referenceDelegate=e(this),this.li=new i3(this),this.indexManager=new HA,this.remoteDocumentCache=(function(l){return new r3(l)})((i=>this.referenceDelegate.hi(i))),this.serializer=new zA(t),this.Pi=new e3(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new t3,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new n3(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){kt("MemoryPersistence","Starting transaction:",e);const l=new o3(this.ai.next());return this.referenceDelegate.Ti(),i(l).next((u=>this.referenceDelegate.Ii(l).next((()=>u)))).toPromise().then((u=>(l.raiseOnCommittedEvent(),u)))}Ei(e,t){return He.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class o3 extends IR{constructor(e){super(),this.currentSequenceNumber=e}}class vy{constructor(e){this.persistence=e,this.Ri=new by,this.Ai=null}static Vi(e){return new vy(e)}get di(){if(this.Ai)return this.Ai;throw Jt(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),He.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),He.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),He.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((l=>this.di.add(l.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((l=>{l.forEach((u=>this.di.add(u.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return He.forEach(this.di,(i=>{const l=Vt.fromPath(i);return this.mi(e,l).next((u=>{u||t.removeEntry(l,ns.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return He.or([()=>He.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Kh{constructor(e,t){this.persistence=e,this.fi=new ll((i=>LR(i.path)),((i,l)=>i.isEqual(l))),this.garbageCollector=QA(this,t)}static Vi(e,t){return new Kh(e,t)}Ti(){}Ii(e){return He.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((l=>i+l))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return He.forEach(this.fi,((i,l)=>this.wr(e,i,l).next((u=>u?He.resolve():t(l)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const l=this.persistence.getRemoteDocumentCache(),u=l.newChangeBuffer();return l.ni(e,(d=>this.wr(e,d,t).next((p=>{p||(i++,u.removeEntry(d,ns.min()))})))).next((()=>u.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),He.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),He.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),He.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),He.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Sh(e.data.value)),t}wr(e,t,i){return He.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const l=this.fi.get(t);return He.resolve(l!==void 0&&l>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class xy{constructor(e,t,i,l){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=l}static Es(e,t){let i=Cs(),l=Cs();for(const u of t.docChanges)switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:l=l.add(u.doc.key)}return new xy(e,t.fromCache,i,l)}}class l3{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class c3{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return LE()?8:DR(dr())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,l){const u={result:null};return this.gs(e,t).next((d=>{u.result=d})).next((()=>{if(!u.result)return this.ps(e,t,l,i).next((d=>{u.result=d}))})).next((()=>{if(u.result)return;const d=new l3;return this.ys(e,t,d).next((p=>{if(u.result=p,this.As)return this.ws(e,t,d,p.size)}))})).next((()=>u.result))}ws(e,t,i,l){return i.documentReadCount<this.Vs?($l()<=Ss.DEBUG&&kt("QueryEngine","SDK will not create cache indexes for query:",Wl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),He.resolve()):($l()<=Ss.DEBUG&&kt("QueryEngine","Query:",Wl(t),"scans",i.documentReadCount,"local documents and returns",l,"documents as results."),i.documentReadCount>this.ds*l?($l()<=Ss.DEBUG&&kt("QueryEngine","The SDK decides to create cache indexes for query:",Wl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Wa(t))):He.resolve())}gs(e,t){if(Lx(t))return He.resolve(null);let i=Wa(t);return this.indexManager.getIndexType(e,i).next((l=>l===0?null:(t.limit!==null&&l===1&&(t=Wh(t,null,"F"),i=Wa(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((u=>{const d=Cs(...u);return this.fs.getDocuments(e,d).next((p=>this.indexManager.getMinOffset(e,i).next((g=>{const y=this.bs(t,p);return this.Ss(t,y,d,g.readTime)?this.gs(e,Wh(t,null,"F")):this.Ds(e,y,t,g)}))))})))))}ps(e,t,i,l){return Lx(t)||l.isEqual(ns.min())?He.resolve(null):this.fs.getDocuments(e,i).next((u=>{const d=this.bs(t,u);return this.Ss(t,d,i,l)?He.resolve(null):($l()<=Ss.DEBUG&&kt("QueryEngine","Re-using previous result from %s to execute query: %s",l.toString(),Wl(t)),this.Ds(e,d,t,CR(l,Su)).next((p=>p)))}))}bs(e,t){let i=new Fn(S_(e));return t.forEach(((l,u)=>{mm(e,u)&&(i=i.add(u))})),i}Ss(e,t,i,l){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const u=e.limitType==="F"?t.last():t.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(l)>0)}ys(e,t,i){return $l()<=Ss.DEBUG&&kt("QueryEngine","Using full collection scan to execute query:",Wl(t)),this.fs.getDocumentsMatchingQuery(e,t,go.min(),i)}Ds(e,t,i,l){return this.fs.getDocumentsMatchingQuery(e,i,l).next((u=>(t.forEach((d=>{u=u.insert(d.key,d)})),u)))}}const wy="LocalStore",u3=3e8;class d3{constructor(e,t,i,l){this.persistence=e,this.Cs=t,this.serializer=l,this.vs=new mn(Ns),this.Fs=new ll((u=>hy(u)),my),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ZA(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function h3(n,e,t,i){return new d3(n,e,t,i)}async function J_(n,e){const t=as(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let l;return t.mutationQueue.getAllMutationBatches(i).next((u=>(l=u,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((u=>{const d=[],p=[];let g=Cs();for(const y of l){d.push(y.batchId);for(const x of y.mutations)g=g.add(x.key)}for(const y of u){p.push(y.batchId);for(const x of y.mutations)g=g.add(x.key)}return t.localDocuments.getDocuments(i,g).next((y=>({Ns:y,removedBatchIds:d,addedBatchIds:p})))}))}))}function m3(n,e){const t=as(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const l=e.batch.keys(),u=t.xs.newChangeBuffer({trackRemovals:!0});return(function(p,g,y,x){const _=y.batch,j=_.keys();let O=He.resolve();return j.forEach((K=>{O=O.next((()=>x.getEntry(g,K))).next((B=>{const D=y.docVersions.get(K);Hs(D!==null,48541),B.version.compareTo(D)<0&&(_.applyToRemoteDocument(B,y),B.isValidDocument()&&(B.setReadTime(y.commitVersion),x.addEntry(B)))}))})),O.next((()=>p.mutationQueue.removeMutationBatch(g,_)))})(t,i,e,u).next((()=>u.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,l,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(p){let g=Cs();for(let y=0;y<p.mutationResults.length;++y)p.mutationResults[y].transformResults.length>0&&(g=g.add(p.batch.mutations[y].key));return g})(e)))).next((()=>t.localDocuments.getDocuments(i,l)))}))}function Z_(n){const e=as(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function f3(n,e){const t=as(n),i=e.snapshotVersion;let l=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const d=t.xs.newChangeBuffer({trackRemovals:!0});l=t.vs;const p=[];e.targetChanges.forEach(((x,_)=>{const j=l.get(_);if(!j)return;p.push(t.li.removeMatchingKeys(u,x.removedDocuments,_).next((()=>t.li.addMatchingKeys(u,x.addedDocuments,_))));let O=j.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(_)!==null?O=O.withResumeToken(nr.EMPTY_BYTE_STRING,ns.min()).withLastLimboFreeSnapshotVersion(ns.min()):x.resumeToken.approximateByteSize()>0&&(O=O.withResumeToken(x.resumeToken,i)),l=l.insert(_,O),(function(B,D,se){return B.resumeToken.approximateByteSize()===0||D.snapshotVersion.toMicroseconds()-B.snapshotVersion.toMicroseconds()>=u3?!0:se.addedDocuments.size+se.modifiedDocuments.size+se.removedDocuments.size>0})(j,O,x)&&p.push(t.li.updateTargetData(u,O))}));let g=Ei(),y=Cs();if(e.documentUpdates.forEach((x=>{e.resolvedLimboDocuments.has(x)&&p.push(t.persistence.referenceDelegate.updateLimboDocument(u,x))})),p.push(p3(u,d,e.documentUpdates).next((x=>{g=x.Bs,y=x.Ls}))),!i.isEqual(ns.min())){const x=t.li.getLastRemoteSnapshotVersion(u).next((_=>t.li.setTargetsMetadata(u,u.currentSequenceNumber,i)));p.push(x)}return He.waitFor(p).next((()=>d.apply(u))).next((()=>t.localDocuments.getLocalViewOfDocuments(u,g,y))).next((()=>g))})).then((u=>(t.vs=l,u)))}function p3(n,e,t){let i=Cs(),l=Cs();return t.forEach((u=>i=i.add(u))),e.getEntries(n,i).next((u=>{let d=Ei();return t.forEach(((p,g)=>{const y=u.get(p);g.isFoundDocument()!==y.isFoundDocument()&&(l=l.add(p)),g.isNoDocument()&&g.version.isEqual(ns.min())?(e.removeEntry(p,g.readTime),d=d.insert(p,g)):!y.isValidDocument()||g.version.compareTo(y.version)>0||g.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(g),d=d.insert(p,g)):kt(wy,"Ignoring outdated watch update for ",p,". Current version:",y.version," Watch version:",g.version)})),{Bs:d,Ls:l}}))}function g3(n,e){const t=as(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=cy),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function y3(n,e){const t=as(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let l;return t.li.getTargetData(i,e).next((u=>u?(l=u,He.resolve(l)):t.li.allocateTargetId(i).next((d=>(l=new lo(e,d,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,l).next((()=>l)))))))})).then((i=>{const l=t.vs.get(i.targetId);return(l===null||i.snapshotVersion.compareTo(l.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function Cg(n,e,t){const i=as(n),l=i.vs.get(e),u=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",u,(d=>i.persistence.referenceDelegate.removeTarget(d,l)))}catch(d){if(!fc(d))throw d;kt(wy,`Failed to update sequence numbers for target ${e}: ${d}`)}i.vs=i.vs.remove(e),i.Fs.delete(l.target)}function Yx(n,e,t){const i=as(n);let l=ns.min(),u=Cs();return i.persistence.runTransaction("Execute query","readwrite",(d=>(function(g,y,x){const _=as(g),j=_.Fs.get(x);return j!==void 0?He.resolve(_.vs.get(j)):_.li.getTargetData(y,x)})(i,d,Wa(e)).next((p=>{if(p)return l=p.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(d,p.targetId).next((g=>{u=g}))})).next((()=>i.Cs.getDocumentsMatchingQuery(d,e,t?l:ns.min(),t?u:Cs()))).next((p=>(b3(i,rA(e),p),{documents:p,ks:u})))))}function b3(n,e,t){let i=n.Ms.get(e)||ns.min();t.forEach(((l,u)=>{u.readTime.compareTo(i)>0&&(i=u.readTime)})),n.Ms.set(e,i)}class Qx{constructor(){this.activeTargetIds=uA()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class v3{constructor(){this.vo=new Qx,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new Qx,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class x3{Mo(e){}shutdown(){}}const Xx="ConnectivityMonitor";class Jx{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){kt(Xx,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){kt(Xx,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let uh=null;function Rg(){return uh===null?uh=(function(){return 268435456+Math.round(2147483648*Math.random())})():uh++,"0x"+uh.toString(16)}const Vp="RestConnection",w3={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class _3{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),l=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${l}`,this.$o=this.databaseId.database===qh?`project_id=${i}`:`project_id=${i}&database_id=${l}`}Wo(e,t,i,l,u){const d=Rg(),p=this.Qo(e,t.toUriEncodedString());kt(Vp,`Sending RPC '${e}' ${d}:`,p,i);const g={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(g,l,u);const{host:y}=new URL(p),x=_o(y);return this.zo(e,p,g,i,x).then((_=>(kt(Vp,`Received RPC '${e}' ${d}: `,_),_)),(_=>{throw tc(Vp,`RPC '${e}' ${d} failed with error: `,_,"url: ",p,"request:",i),_}))}jo(e,t,i,l,u,d){return this.Wo(e,t,i,l,u)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+hc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((l,u)=>e[u]=l)),i&&i.headers.forEach(((l,u)=>e[u]=l))}Qo(e,t){const i=w3[e];let l=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(l=`${l}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),l}terminate(){}}class k3{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const or="WebChannelConnection",nu=(n,e,t)=>{n.listen(e,(i=>{try{t(i)}catch(l){setTimeout((()=>{throw l}),0)}}))};class Zl extends _3{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Zl.c_){const e=s_();nu(e,t_.STAT_EVENT,(t=>{t.stat===bg.PROXY?kt(or,"STAT_EVENT: detected buffering proxy"):t.stat===bg.NOPROXY&&kt(or,"STAT_EVENT: detected no buffering proxy")})),Zl.c_=!0}}zo(e,t,i,l,u){const d=Rg();return new Promise(((p,g)=>{const y=new Zw;y.setWithCredentials(!0),y.listenOnce(e_.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case Th.NO_ERROR:const _=y.getResponseJson();kt(or,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(_)),p(_);break;case Th.TIMEOUT:kt(or,`RPC '${e}' ${d} timed out`),g(new pt(Le.DEADLINE_EXCEEDED,"Request time out"));break;case Th.HTTP_ERROR:const j=y.getStatus();if(kt(or,`RPC '${e}' ${d} failed with status:`,j,"response text:",y.getResponseText()),j>0){let O=y.getResponseJson();Array.isArray(O)&&(O=O[0]);const K=O?.error;if(K&&K.status&&K.message){const B=(function(se){const Y=se.toLowerCase().replace(/_/g,"-");return Object.values(Le).indexOf(Y)>=0?Y:Le.UNKNOWN})(K.status);g(new pt(B,K.message))}else g(new pt(Le.UNKNOWN,"Server responded with status "+y.getStatus()))}else g(new pt(Le.UNAVAILABLE,"Connection failed."));break;default:Jt(9055,{l_:e,streamId:d,h_:y.getLastErrorCode(),P_:y.getLastError()})}}finally{kt(or,`RPC '${e}' ${d} completed.`)}}));const x=JSON.stringify(l);kt(or,`RPC '${e}' ${d} sending request:`,l),y.send(t,"POST",x,i,15)}))}T_(e,t,i){const l=Rg(),u=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=this.createWebChannelTransport(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(p.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Go(p.initMessageHeaders,t,i),p.encodeInitMessageHeaders=!0;const y=u.join("");kt(or,`Creating RPC '${e}' stream ${l}: ${y}`,p);const x=d.createWebChannel(y,p);this.I_(x);let _=!1,j=!1;const O=new k3({Ho:K=>{j?kt(or,`Not sending because RPC '${e}' stream ${l} is closed:`,K):(_||(kt(or,`Opening RPC '${e}' stream ${l} transport.`),x.open(),_=!0),kt(or,`RPC '${e}' stream ${l} sending:`,K),x.send(K))},Jo:()=>x.close()});return nu(x,du.EventType.OPEN,(()=>{j||(kt(or,`RPC '${e}' stream ${l} transport opened.`),O.i_())})),nu(x,du.EventType.CLOSE,(()=>{j||(j=!0,kt(or,`RPC '${e}' stream ${l} transport closed`),O.o_(),this.E_(x))})),nu(x,du.EventType.ERROR,(K=>{j||(j=!0,tc(or,`RPC '${e}' stream ${l} transport errored. Name:`,K.name,"Message:",K.message),O.o_(new pt(Le.UNAVAILABLE,"The operation could not be completed")))})),nu(x,du.EventType.MESSAGE,(K=>{if(!j){const B=K.data[0];Hs(!!B,16349);const D=B,se=D?.error||D[0]?.error;if(se){kt(or,`RPC '${e}' stream ${l} received error:`,se);const Y=se.status;let Z=(function(ke){const C=An[ke];if(C!==void 0)return V_(C)})(Y),je=se.message;Z===void 0&&(Z=Le.INTERNAL,je="Unknown error status: "+Y+" with message "+se.message),j=!0,O.o_(new pt(Z,je)),x.close()}else kt(or,`RPC '${e}' stream ${l} received:`,B),O.__(B)}})),Zl.u_(),setTimeout((()=>{O.s_()}),0),O}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return n_()}}function j3(n){return new Zl(n)}function Up(){return typeof document<"u"?document:null}function bm(n){return new NA(n,!0)}Zl.c_=!1;class ek{constructor(e,t,i=1e3,l=1.5,u=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=l,this.V_=u,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),l=Math.max(0,t-i);l>0&&kt("ExponentialBackoff",`Backing off for ${l} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,l,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const Zx="PersistentStream";class tk{constructor(e,t,i,l,u,d,p,g){this.Ci=e,this.b_=i,this.S_=l,this.connection=u,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=p,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new ek(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Le.RESOURCE_EXHAUSTED?(Si(t.toString()),Si("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Le.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,l])=>{this.D_===t&&this.G_(i,l)}),(i=>{e((()=>{const l=new pt(Le.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(l)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((l=>{i((()=>this.z_(l)))})),this.stream.onMessage((l=>{i((()=>++this.F_==1?this.H_(l):this.onNext(l)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return kt(Zx,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(kt(Zx,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class T3 extends tk{constructor(e,t,i,l,u,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=AA(this.serializer,e),i=(function(u){if(!("targetChange"in u))return ns.min();const d=u.targetChange;return d.targetIds&&d.targetIds.length?ns.min():d.readTime?Ga(d.readTime):ns.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=Ng(this.serializer),t.addTarget=(function(u,d){let p;const g=d.target;if(p=kg(g)?{documents:DA(u,g)}:{query:PA(u,g).ft},p.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){p.resumeToken=z_(u,d.resumeToken);const y=Tg(u,d.expectedCount);y!==null&&(p.expectedCount=y)}else if(d.snapshotVersion.compareTo(ns.min())>0){p.readTime=Gh(u,d.snapshotVersion.toTimestamp());const y=Tg(u,d.expectedCount);y!==null&&(p.expectedCount=y)}return p})(this.serializer,e);const i=OA(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=Ng(this.serializer),t.removeTarget=e,this.K_(t)}}class S3 extends tk{constructor(e,t,i,l,u,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return Hs(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Hs(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Hs(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=IA(e.writeResults,e.commitTime),i=Ga(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=Ng(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>MA(this.serializer,i)))};this.K_(t)}}class E3{}class N3 extends E3{constructor(e,t,i,l){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=l,this.ia=!1}sa(){if(this.ia)throw new pt(Le.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,d])=>this.connection.Wo(e,Sg(t,i),l,u,d))).catch((u=>{throw u.name==="FirebaseError"?(u.code===Le.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new pt(Le.UNKNOWN,u.toString())}))}jo(e,t,i,l,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,p])=>this.connection.jo(e,Sg(t,i),l,d,p,u))).catch((d=>{throw d.name==="FirebaseError"?(d.code===Le.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new pt(Le.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function C3(n,e,t,i){return new N3(n,e,t,i)}class R3{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Si(t),this.aa=!1):kt("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const rl="RemoteStore";class A3{constructor(e,t,i,l,u){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=u,this.Aa.Mo((d=>{i.enqueueAndForget((async()=>{cl(this)&&(kt(rl,"Restarting streams for network reachability change."),await(async function(g){const y=as(g);y.Ea.add(4),await Gu(y),y.Va.set("Unknown"),y.Ea.delete(4),await vm(y)})(this))}))})),this.Va=new R3(i,l)}}async function vm(n){if(cl(n))for(const e of n.Ra)await e(!0)}async function Gu(n){for(const e of n.Ra)await e(!1)}function sk(n,e){const t=as(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Ty(t)?jy(t):gc(t).O_()&&ky(t,e))}function _y(n,e){const t=as(n),i=gc(t);t.Ia.delete(e),i.O_()&&nk(t,e),t.Ia.size===0&&(i.O_()?i.L_():cl(t)&&t.Va.set("Unknown"))}function ky(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ns.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}gc(n).Z_(e)}function nk(n,e){n.da.$e(e),gc(n).X_(e)}function jy(n){n.da=new jA({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),gc(n).start(),n.Va.ua()}function Ty(n){return cl(n)&&!gc(n).x_()&&n.Ia.size>0}function cl(n){return as(n).Ea.size===0}function rk(n){n.da=void 0}async function M3(n){n.Va.set("Online")}async function I3(n){n.Ia.forEach(((e,t)=>{ky(n,e)}))}async function D3(n,e){rk(n),Ty(n)?(n.Va.ha(e),jy(n)):n.Va.set("Unknown")}async function P3(n,e,t){if(n.Va.set("Online"),e instanceof F_&&e.state===2&&e.cause)try{await(async function(l,u){const d=u.cause;for(const p of u.targetIds)l.Ia.has(p)&&(await l.remoteSyncer.rejectListen(p,d),l.Ia.delete(p),l.da.removeTarget(p))})(n,e)}catch(i){kt(rl,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Yh(n,i)}else if(e instanceof Ch?n.da.Xe(e):e instanceof U_?n.da.st(e):n.da.tt(e),!t.isEqual(ns.min()))try{const i=await Z_(n.localStore);t.compareTo(i)>=0&&await(function(u,d){const p=u.da.Tt(d);return p.targetChanges.forEach(((g,y)=>{if(g.resumeToken.approximateByteSize()>0){const x=u.Ia.get(y);x&&u.Ia.set(y,x.withResumeToken(g.resumeToken,d))}})),p.targetMismatches.forEach(((g,y)=>{const x=u.Ia.get(g);if(!x)return;u.Ia.set(g,x.withResumeToken(nr.EMPTY_BYTE_STRING,x.snapshotVersion)),nk(u,g);const _=new lo(x.target,g,y,x.sequenceNumber);ky(u,_)})),u.remoteSyncer.applyRemoteEvent(p)})(n,t)}catch(i){kt(rl,"Failed to raise snapshot:",i),await Yh(n,i)}}async function Yh(n,e,t){if(!fc(e))throw e;n.Ea.add(1),await Gu(n),n.Va.set("Offline"),t||(t=()=>Z_(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{kt(rl,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await vm(n)}))}function ak(n,e){return e().catch((t=>Yh(n,t,e)))}async function xm(n){const e=as(n),t=xo(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:cy;for(;L3(e);)try{const l=await g3(e.localStore,i);if(l===null){e.Ta.length===0&&t.L_();break}i=l.batchId,O3(e,l)}catch(l){await Yh(e,l)}ik(e)&&ok(e)}function L3(n){return cl(n)&&n.Ta.length<10}function O3(n,e){n.Ta.push(e);const t=xo(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function ik(n){return cl(n)&&!xo(n).x_()&&n.Ta.length>0}function ok(n){xo(n).start()}async function B3(n){xo(n).ra()}async function V3(n){const e=xo(n);for(const t of n.Ta)e.ea(t.mutations)}async function U3(n,e,t){const i=n.Ta.shift(),l=py.from(i,e,t);await ak(n,(()=>n.remoteSyncer.applySuccessfulWrite(l))),await xm(n)}async function F3(n,e){e&&xo(n).Y_&&await(async function(i,l){if((function(d){return wA(d)&&d!==Le.ABORTED})(l.code)){const u=i.Ta.shift();xo(i).B_(),await ak(i,(()=>i.remoteSyncer.rejectFailedWrite(u.batchId,l))),await xm(i)}})(n,e),ik(n)&&ok(n)}async function e2(n,e){const t=as(n);t.asyncQueue.verifyOperationInProgress(),kt(rl,"RemoteStore received new credentials");const i=cl(t);t.Ea.add(3),await Gu(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await vm(t)}async function z3(n,e){const t=as(n);e?(t.Ea.delete(2),await vm(t)):e||(t.Ea.add(2),await Gu(t),t.Va.set("Unknown"))}function gc(n){return n.ma||(n.ma=(function(t,i,l){const u=as(t);return u.sa(),new T3(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(n.datastore,n.asyncQueue,{Zo:M3.bind(null,n),Yo:I3.bind(null,n),t_:D3.bind(null,n),J_:P3.bind(null,n)}),n.Ra.push((async e=>{e?(n.ma.B_(),Ty(n)?jy(n):n.Va.set("Unknown")):(await n.ma.stop(),rk(n))}))),n.ma}function xo(n){return n.fa||(n.fa=(function(t,i,l){const u=as(t);return u.sa(),new S3(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:B3.bind(null,n),t_:F3.bind(null,n),ta:V3.bind(null,n),na:U3.bind(null,n)}),n.Ra.push((async e=>{e?(n.fa.B_(),await xm(n)):(await n.fa.stop(),n.Ta.length>0&&(kt(rl,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class Sy{constructor(e,t,i,l,u){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=l,this.removalCallback=u,this.deferred=new _i,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,l,u){const d=Date.now()+i,p=new Sy(e,t,d,l,u);return p.start(i),p}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new pt(Le.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ey(n,e){if(Si("AsyncQueue",`${e}: ${n}`),fc(n))return new pt(Le.UNAVAILABLE,`${e}: ${n}`);throw n}class ec{static emptySet(e){return new ec(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Vt.comparator(t.key,i.key):(t,i)=>Vt.comparator(t.key,i.key),this.keyedMap=hu(),this.sortedSet=new mn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ec)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(!l.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new ec;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class t2{constructor(){this.ga=new mn(Vt.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Jt(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class ic{constructor(e,t,i,l,u,d,p,g,y){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=l,this.mutatedKeys=u,this.fromCache=d,this.syncStateChanged=p,this.excludesMetadataChanges=g,this.hasCachedResults=y}static fromInitialDocuments(e,t,i,l,u){const d=[];return t.forEach((p=>{d.push({type:0,doc:p})})),new ic(e,t,ec.emptySet(t),d,i,l,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&hm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let l=0;l<t.length;l++)if(t[l].type!==i[l].type||!t[l].doc.isEqual(i[l].doc))return!1;return!0}}class q3{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class H3{constructor(){this.queries=s2(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const l=as(t),u=l.queries;l.queries=s2(),u.forEach(((d,p)=>{for(const g of p.ba)g.onError(i)}))})(this,new pt(Le.ABORTED,"Firestore shutting down"))}}function s2(){return new ll((n=>T_(n)),hm)}async function Ny(n,e){const t=as(n);let i=3;const l=e.query;let u=t.queries.get(l);u?!u.Sa()&&e.Da()&&(i=2):(u=new q3,i=e.Da()?0:1);try{switch(i){case 0:u.wa=await t.onListen(l,!0);break;case 1:u.wa=await t.onListen(l,!1);break;case 2:await t.onFirstRemoteStoreListen(l)}}catch(d){const p=Ey(d,`Initialization of query '${Wl(e.query)}' failed`);return void e.onError(p)}t.queries.set(l,u),u.ba.push(e),e.va(t.onlineState),u.wa&&e.Fa(u.wa)&&Ry(t)}async function Cy(n,e){const t=as(n),i=e.query;let l=3;const u=t.queries.get(i);if(u){const d=u.ba.indexOf(e);d>=0&&(u.ba.splice(d,1),u.ba.length===0?l=e.Da()?0:1:!u.Sa()&&e.Da()&&(l=2))}switch(l){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function $3(n,e){const t=as(n);let i=!1;for(const l of e){const u=l.query,d=t.queries.get(u);if(d){for(const p of d.ba)p.Fa(l)&&(i=!0);d.wa=l}}i&&Ry(t)}function W3(n,e,t){const i=as(n),l=i.queries.get(e);if(l)for(const u of l.ba)u.onError(t);i.queries.delete(e)}function Ry(n){n.Ca.forEach((e=>{e.next()}))}var Ag,n2;(n2=Ag||(Ag={})).Ma="default",n2.Cache="cache";class Ay{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const l of e.docChanges)l.type!==3&&i.push(l);e=new ic(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=ic.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Ag.Cache}}class lk{constructor(e){this.key=e}}class ck{constructor(e){this.key=e}}class G3{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Cs(),this.mutatedKeys=Cs(),this.eu=S_(e),this.tu=new ec(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new t2,l=t?t.tu:this.tu;let u=t?t.mutatedKeys:this.mutatedKeys,d=l,p=!1;const g=this.query.limitType==="F"&&l.size===this.query.limit?l.last():null,y=this.query.limitType==="L"&&l.size===this.query.limit?l.first():null;if(e.inorderTraversal(((x,_)=>{const j=l.get(x),O=mm(this.query,_)?_:null,K=!!j&&this.mutatedKeys.has(j.key),B=!!O&&(O.hasLocalMutations||this.mutatedKeys.has(O.key)&&O.hasCommittedMutations);let D=!1;j&&O?j.data.isEqual(O.data)?K!==B&&(i.track({type:3,doc:O}),D=!0):this.su(j,O)||(i.track({type:2,doc:O}),D=!0,(g&&this.eu(O,g)>0||y&&this.eu(O,y)<0)&&(p=!0)):!j&&O?(i.track({type:0,doc:O}),D=!0):j&&!O&&(i.track({type:1,doc:j}),D=!0,(g||y)&&(p=!0)),D&&(O?(d=d.add(O),u=B?u.add(x):u.delete(x)):(d=d.delete(x),u=u.delete(x)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const x=this.query.limitType==="F"?d.last():d.first();d=d.delete(x.key),u=u.delete(x.key),i.track({type:1,doc:x})}return{tu:d,iu:i,Ss:p,mutatedKeys:u}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,l){const u=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((x,_)=>(function(O,K){const B=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Jt(20277,{Vt:D})}};return B(O)-B(K)})(x.type,_.type)||this.eu(x.doc,_.doc))),this.ou(i),l=l??!1;const p=t&&!l?this._u():[],g=this.Ya.size===0&&this.current&&!l?1:0,y=g!==this.Xa;return this.Xa=g,d.length!==0||y?{snapshot:new ic(this.query,e.tu,u,d,e.mutatedKeys,g===0,y,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:p}:{au:p}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new t2,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=Cs(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new ck(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new lk(i))})),t}cu(e){this.Za=e.ks,this.Ya=Cs();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return ic.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const My="SyncEngine";class K3{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class Y3{constructor(e){this.key=e,this.hu=!1}}class Q3{constructor(e,t,i,l,u,d){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=l,this.currentUser=u,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new ll((p=>T_(p)),hm),this.Iu=new Map,this.Eu=new Set,this.Ru=new mn(Vt.comparator),this.Au=new Map,this.Vu=new by,this.du={},this.mu=new Map,this.fu=ac.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function X3(n,e,t=!0){const i=pk(n);let l;const u=i.Tu.get(e);return u?(i.sharedClientState.addLocalQueryTarget(u.targetId),l=u.view.lu()):l=await uk(i,e,t,!0),l}async function J3(n,e){const t=pk(n);await uk(t,e,!0,!1)}async function uk(n,e,t,i){const l=await y3(n.localStore,Wa(e)),u=l.targetId,d=n.sharedClientState.addLocalQueryTarget(u,t);let p;return i&&(p=await Z3(n,e,u,d==="current",l.resumeToken)),n.isPrimaryClient&&t&&sk(n.remoteStore,l),p}async function Z3(n,e,t,i,l){n.pu=(_,j,O)=>(async function(B,D,se,Y){let Z=D.view.ru(se);Z.Ss&&(Z=await Yx(B.localStore,D.query,!1).then((({documents:C})=>D.view.ru(C,Z))));const je=Y&&Y.targetChanges.get(D.targetId),Re=Y&&Y.targetMismatches.get(D.targetId)!=null,ke=D.view.applyChanges(Z,B.isPrimaryClient,je,Re);return a2(B,D.targetId,ke.au),ke.snapshot})(n,_,j,O);const u=await Yx(n.localStore,e,!0),d=new G3(e,u.ks),p=d.ru(u.documents),g=Wu.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",l),y=d.applyChanges(p,n.isPrimaryClient,g);a2(n,t,y.au);const x=new K3(e,t,d);return n.Tu.set(e,x),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),y.snapshot}async function eM(n,e,t){const i=as(n),l=i.Tu.get(e),u=i.Iu.get(l.targetId);if(u.length>1)return i.Iu.set(l.targetId,u.filter((d=>!hm(d,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(l.targetId),i.sharedClientState.isActiveQueryTarget(l.targetId)||await Cg(i.localStore,l.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(l.targetId),t&&_y(i.remoteStore,l.targetId),Mg(i,l.targetId)})).catch(mc)):(Mg(i,l.targetId),await Cg(i.localStore,l.targetId,!0))}async function tM(n,e){const t=as(n),i=t.Tu.get(e),l=t.Iu.get(i.targetId);t.isPrimaryClient&&l.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),_y(t.remoteStore,i.targetId))}async function sM(n,e,t){const i=cM(n);try{const l=await(function(d,p){const g=as(d),y=Rt.now(),x=p.reduce(((O,K)=>O.add(K.key)),Cs());let _,j;return g.persistence.runTransaction("Locally write mutations","readwrite",(O=>{let K=Ei(),B=Cs();return g.xs.getEntries(O,x).next((D=>{K=D,K.forEach(((se,Y)=>{Y.isValidDocument()||(B=B.add(se))}))})).next((()=>g.localDocuments.getOverlayedDocuments(O,K))).next((D=>{_=D;const se=[];for(const Y of p){const Z=gA(Y,_.get(Y.key).overlayedDocument);Z!=null&&se.push(new To(Y.key,Z,y_(Z.value.mapValue),xr.exists(!0)))}return g.mutationQueue.addMutationBatch(O,y,se,p)})).next((D=>{j=D;const se=D.applyToLocalDocumentSet(_,B);return g.documentOverlayCache.saveOverlays(O,D.batchId,se)}))})).then((()=>({batchId:j.batchId,changes:N_(_)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(l.batchId),(function(d,p,g){let y=d.du[d.currentUser.toKey()];y||(y=new mn(Ns)),y=y.insert(p,g),d.du[d.currentUser.toKey()]=y})(i,l.batchId,t),await Ku(i,l.changes),await xm(i.remoteStore)}catch(l){const u=Ey(l,"Failed to persist write");t.reject(u)}}async function dk(n,e){const t=as(n);try{const i=await f3(t.localStore,e);e.targetChanges.forEach(((l,u)=>{const d=t.Au.get(u);d&&(Hs(l.addedDocuments.size+l.modifiedDocuments.size+l.removedDocuments.size<=1,22616),l.addedDocuments.size>0?d.hu=!0:l.modifiedDocuments.size>0?Hs(d.hu,14607):l.removedDocuments.size>0&&(Hs(d.hu,42227),d.hu=!1))})),await Ku(t,i,e)}catch(i){await mc(i)}}function r2(n,e,t){const i=as(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const l=[];i.Tu.forEach(((u,d)=>{const p=d.view.va(e);p.snapshot&&l.push(p.snapshot)})),(function(d,p){const g=as(d);g.onlineState=p;let y=!1;g.queries.forEach(((x,_)=>{for(const j of _.ba)j.va(p)&&(y=!0)})),y&&Ry(g)})(i.eventManager,e),l.length&&i.Pu.J_(l),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function nM(n,e,t){const i=as(n);i.sharedClientState.updateQueryState(e,"rejected",t);const l=i.Au.get(e),u=l&&l.key;if(u){let d=new mn(Vt.comparator);d=d.insert(u,cr.newNoDocument(u,ns.min()));const p=Cs().add(u),g=new ym(ns.min(),new Map,new mn(Ns),d,p);await dk(i,g),i.Ru=i.Ru.remove(u),i.Au.delete(e),Iy(i)}else await Cg(i.localStore,e,!1).then((()=>Mg(i,e,t))).catch(mc)}async function rM(n,e){const t=as(n),i=e.batch.batchId;try{const l=await m3(t.localStore,e);mk(t,i,null),hk(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Ku(t,l)}catch(l){await mc(l)}}async function aM(n,e,t){const i=as(n);try{const l=await(function(d,p){const g=as(d);return g.persistence.runTransaction("Reject batch","readwrite-primary",(y=>{let x;return g.mutationQueue.lookupMutationBatch(y,p).next((_=>(Hs(_!==null,37113),x=_.keys(),g.mutationQueue.removeMutationBatch(y,_)))).next((()=>g.mutationQueue.performConsistencyCheck(y))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(y,x,p))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,x))).next((()=>g.localDocuments.getDocuments(y,x)))}))})(i.localStore,e);mk(i,e,t),hk(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Ku(i,l)}catch(l){await mc(l)}}function hk(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function mk(n,e,t){const i=as(n);let l=i.du[i.currentUser.toKey()];if(l){const u=l.get(e);u&&(t?u.reject(t):u.resolve(),l=l.remove(e)),i.du[i.currentUser.toKey()]=l}}function Mg(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach((i=>{n.Vu.containsKey(i)||fk(n,i)}))}function fk(n,e){n.Eu.delete(e.path.canonicalString());const t=n.Ru.get(e);t!==null&&(_y(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),Iy(n))}function a2(n,e,t){for(const i of t)i instanceof lk?(n.Vu.addReference(i.key,e),iM(n,i)):i instanceof ck?(kt(My,"Document no longer in limbo: "+i.key),n.Vu.removeReference(i.key,e),n.Vu.containsKey(i.key)||fk(n,i.key)):Jt(19791,{wu:i})}function iM(n,e){const t=e.key,i=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(i)||(kt(My,"New document in limbo: "+t),n.Eu.add(i),Iy(n))}function Iy(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Vt(nn.fromString(e)),i=n.fu.next();n.Au.set(i,new Y3(t)),n.Ru=n.Ru.insert(t,i),sk(n.remoteStore,new lo(Wa(dm(t.path)),i,"TargetPurposeLimboResolution",lm.ce))}}async function Ku(n,e,t){const i=as(n),l=[],u=[],d=[];i.Tu.isEmpty()||(i.Tu.forEach(((p,g)=>{d.push(i.pu(g,e,t).then((y=>{if((y||t)&&i.isPrimaryClient){const x=y?!y.fromCache:t?.targetChanges.get(g.targetId)?.current;i.sharedClientState.updateQueryState(g.targetId,x?"current":"not-current")}if(y){l.push(y);const x=xy.Es(g.targetId,y);u.push(x)}})))})),await Promise.all(d),i.Pu.J_(l),await(async function(g,y){const x=as(g);try{await x.persistence.runTransaction("notifyLocalViewChanges","readwrite",(_=>He.forEach(y,(j=>He.forEach(j.Ts,(O=>x.persistence.referenceDelegate.addReference(_,j.targetId,O))).next((()=>He.forEach(j.Is,(O=>x.persistence.referenceDelegate.removeReference(_,j.targetId,O)))))))))}catch(_){if(!fc(_))throw _;kt(wy,"Failed to update sequence numbers: "+_)}for(const _ of y){const j=_.targetId;if(!_.fromCache){const O=x.vs.get(j),K=O.snapshotVersion,B=O.withLastLimboFreeSnapshotVersion(K);x.vs=x.vs.insert(j,B)}}})(i.localStore,u))}async function oM(n,e){const t=as(n);if(!t.currentUser.isEqual(e)){kt(My,"User change. New user:",e.toKey());const i=await J_(t.localStore,e);t.currentUser=e,(function(u,d){u.mu.forEach((p=>{p.forEach((g=>{g.reject(new pt(Le.CANCELLED,d))}))})),u.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Ku(t,i.Ns)}}function lM(n,e){const t=as(n),i=t.Au.get(e);if(i&&i.hu)return Cs().add(i.key);{let l=Cs();const u=t.Iu.get(e);if(!u)return l;for(const d of u){const p=t.Tu.get(d);l=l.unionWith(p.view.nu)}return l}}function pk(n){const e=as(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=dk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=lM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=nM.bind(null,e),e.Pu.J_=$3.bind(null,e.eventManager),e.Pu.yu=W3.bind(null,e.eventManager),e}function cM(n){const e=as(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=rM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=aM.bind(null,e),e}class Qh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=bm(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return h3(this.persistence,new c3,e.initialUser,this.serializer)}Cu(e){return new X_(vy.Vi,this.serializer)}Du(e){return new v3}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Qh.provider={build:()=>new Qh};class uM extends Qh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Hs(this.persistence.referenceDelegate instanceof Kh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new KA(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Dr.withCacheSize(this.cacheSizeBytes):Dr.DEFAULT;return new X_((i=>Kh.Vi(i,t)),this.serializer)}}class Ig{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>r2(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=oM.bind(null,this.syncEngine),await z3(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new H3})()}createDatastore(e){const t=bm(e.databaseInfo.databaseId),i=j3(e.databaseInfo);return C3(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,l,u,d,p){return new A3(i,l,u,d,p)})(this.localStore,this.datastore,e.asyncQueue,(t=>r2(this.syncEngine,t,0)),(function(){return Jx.v()?new Jx:new x3})())}createSyncEngine(e,t){return(function(l,u,d,p,g,y,x){const _=new Q3(l,u,d,p,g,y);return x&&(_.gu=!0),_})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=as(t);kt(rl,"RemoteStore shutting down."),i.Ea.add(5),await Gu(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Ig.provider={build:()=>new Ig};class Dy{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Si("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const wo="FirestoreClient";class dM{constructor(e,t,i,l,u){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=l,this.user=lr.UNAUTHENTICATED,this.clientId=ly.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(i,(async d=>{kt(wo,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(i,(d=>(kt(wo,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new _i;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=Ey(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Fp(n,e){n.asyncQueue.verifyOperationInProgress(),kt(wo,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async l=>{i.isEqual(l)||(await J_(e.localStore,l),i=l)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function i2(n,e){n.asyncQueue.verifyOperationInProgress();const t=await hM(n);kt(wo,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>e2(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,l)=>e2(e.remoteStore,l))),n._onlineComponents=e}async function hM(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){kt(wo,"Using user provided OfflineComponentProvider");try{await Fp(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(l){return l.name==="FirebaseError"?l.code===Le.FAILED_PRECONDITION||l.code===Le.UNIMPLEMENTED:!(typeof DOMException<"u"&&l instanceof DOMException)||l.code===22||l.code===20||l.code===11})(t))throw t;tc("Error using user provided cache. Falling back to memory cache: "+t),await Fp(n,new Qh)}}else kt(wo,"Using default OfflineComponentProvider"),await Fp(n,new uM(void 0));return n._offlineComponents}async function gk(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(kt(wo,"Using user provided OnlineComponentProvider"),await i2(n,n._uninitializedComponentsProvider._online)):(kt(wo,"Using default OnlineComponentProvider"),await i2(n,new Ig))),n._onlineComponents}function mM(n){return gk(n).then((e=>e.syncEngine))}async function Xh(n){const e=await gk(n),t=e.eventManager;return t.onListen=X3.bind(null,e.syncEngine),t.onUnlisten=eM.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=J3.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=tM.bind(null,e.syncEngine),t}function fM(n,e,t,i){const l=new Dy(i),u=new Ay(e,l,t);return n.asyncQueue.enqueueAndForget((async()=>Ny(await Xh(n),u))),()=>{l.Nu(),n.asyncQueue.enqueueAndForget((async()=>Cy(await Xh(n),u)))}}function pM(n,e,t={}){const i=new _i;return n.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,y){const x=new Dy({next:j=>{x.Nu(),d.enqueueAndForget((()=>Cy(u,_)));const O=j.docs.has(p);!O&&j.fromCache?y.reject(new pt(Le.UNAVAILABLE,"Failed to get document because the client is offline.")):O&&j.fromCache&&g&&g.source==="server"?y.reject(new pt(Le.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(j)},error:j=>y.reject(j)}),_=new Ay(dm(p.path),x,{includeMetadataChanges:!0,Ka:!0});return Ny(u,_)})(await Xh(n),n.asyncQueue,e,t,i))),i.promise}function gM(n,e,t={}){const i=new _i;return n.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,y){const x=new Dy({next:j=>{x.Nu(),d.enqueueAndForget((()=>Cy(u,_))),j.fromCache&&g.source==="server"?y.reject(new pt(Le.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(j)},error:j=>y.reject(j)}),_=new Ay(p,x,{includeMetadataChanges:!0,Ka:!0});return Ny(u,_)})(await Xh(n),n.asyncQueue,e,t,i))),i.promise}function yM(n,e){const t=new _i;return n.asyncQueue.enqueueAndForget((async()=>sM(await mM(n),e,t))),t.promise}function yk(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const bM="ComponentProvider",o2=new Map;function vM(n,e,t,i,l){return new VR(n,e,t,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,yk(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator,i)}const bk="firestore.googleapis.com",l2=!0;class c2{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new pt(Le.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=bk,this.ssl=l2}else this.host=e.host,this.ssl=e.ssl??l2;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Q_;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<WA)throw new pt(Le.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}ER("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=yk(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new pt(Le.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new pt(Le.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new pt(Le.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,l){return i.timeoutSeconds===l.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class wm{constructor(e,t,i,l){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=l,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new c2({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new pt(Le.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new pt(Le.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new c2(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new yR;switch(i.type){case"firstParty":return new wR(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new pt(Le.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=o2.get(t);i&&(kt(bM,"Removing Datastore"),o2.delete(t),i.terminate())})(this),Promise.resolve()}}function xM(n,e,t,i={}){n=vr(n,wm);const l=_o(e),u=n._getSettings(),d={...u,emulatorOptions:n._getEmulatorOptions()},p=`${e}:${t}`;l&&(Wg(`https://${p}`),Gg("Firestore",!0)),u.host!==bk&&u.host!==p&&tc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...u,host:p,ssl:l,emulatorOptions:i};if(!Zo(g,d)&&(n._setSettings(g),i.mockUserToken)){let y,x;if(typeof i.mockUserToken=="string")y=i.mockUserToken,x=lr.MOCK_USER;else{y=hw(i.mockUserToken,n._app?.options.projectId);const _=i.mockUserToken.sub||i.mockUserToken.user_id;if(!_)throw new pt(Le.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");x=new lr(_)}n._authCredentials=new bR(new a_(y,x))}}class Ri{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Ri(this.firestore,e,this._query)}}class yn{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new mo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new yn(this.firestore,e,this._key)}toJSON(){return{type:yn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Hu(t,yn._jsonSchema))return new yn(e,i||null,new Vt(nn.fromString(t.referencePath)))}}yn._jsonSchemaVersion="firestore/documentReference/1.0",yn._jsonSchema={type:In("string",yn._jsonSchemaVersion),referencePath:In("string")};class mo extends Ri{constructor(e,t,i){super(e,t,dm(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new yn(this.firestore,null,new Vt(e))}withConverter(e){return new mo(this.firestore,e,this._path)}}function qt(n,e,...t){if(n=Qs(n),i_("collection","path",e),n instanceof wm){const i=nn.fromString(e,...t);return _x(i),new mo(n,null,i)}{if(!(n instanceof yn||n instanceof mo))throw new pt(Le.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(nn.fromString(e,...t));return _x(i),new mo(n.firestore,null,i)}}function Xe(n,e,...t){if(n=Qs(n),arguments.length===1&&(e=ly.newId()),i_("doc","path",e),n instanceof wm){const i=nn.fromString(e,...t);return wx(i),new yn(n,null,new Vt(i))}{if(!(n instanceof yn||n instanceof mo))throw new pt(Le.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(nn.fromString(e,...t));return wx(i),new yn(n.firestore,n instanceof mo?n.converter:null,new Vt(i))}}const u2="AsyncQueue";class d2{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new ek(this,"async_queue_retry"),this._c=()=>{const i=Up();i&&kt(u2,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Up();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Up();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new _i;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!fc(e))throw e;kt(u2,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Si("INTERNAL UNHANDLED ERROR: ",h2(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const l=Sy.createAndSchedule(this,e,t,i,(u=>this.hc(u)));return this.tc.push(l),l}uc(){this.nc&&Jt(47125,{Pc:h2(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function h2(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Qa extends wm{constructor(e,t,i,l){super(e,t,i,l),this.type="firestore",this._queue=new d2,this._persistenceKey=l?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new d2(e),this._firestoreClient=void 0,await e}}}function wM(n,e){const t=typeof n=="object"?n:Xg(),i=typeof n=="string"?n:qh,l=nm(t,"firestore").getImmediate({identifier:i});if(!l._initialized){const u=cw("firestore");u&&xM(l,...u)}return l}function Yu(n){if(n._terminated)throw new pt(Le.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||_M(n),n._firestoreClient}function _M(n){const e=n._freezeSettings(),t=vM(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new dM(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(l){const u=l?._online.build();return{_offline:l?._offline.build(u),_online:u}})(n._componentsProvider))}class ca{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ca(nr.fromBase64String(e))}catch(t){throw new pt(Le.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ca(nr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ca._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Hu(e,ca._jsonSchema))return ca.fromBase64String(e.bytes)}}ca._jsonSchemaVersion="firestore/bytes/1.0",ca._jsonSchema={type:In("string",ca._jsonSchemaVersion),bytes:In("string")};class _m{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new pt(Le.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new sr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Qu{constructor(e){this._methodName=e}}class Ka{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new pt(Le.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new pt(Le.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ns(this._lat,e._lat)||Ns(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ka._jsonSchemaVersion}}static fromJSON(e){if(Hu(e,Ka._jsonSchema))return new Ka(e.latitude,e.longitude)}}Ka._jsonSchemaVersion="firestore/geoPoint/1.0",Ka._jsonSchema={type:In("string",Ka._jsonSchemaVersion),latitude:In("number"),longitude:In("number")};class _a{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,l){if(i.length!==l.length)return!1;for(let u=0;u<i.length;++u)if(i[u]!==l[u])return!1;return!0})(this._values,e._values)}toJSON(){return{type:_a._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Hu(e,_a._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new _a(e.vectorValues);throw new pt(Le.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}_a._jsonSchemaVersion="firestore/vectorValue/1.0",_a._jsonSchema={type:In("string",_a._jsonSchemaVersion),vectorValues:In("object")};const kM=/^__.*__$/;class jM{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new To(e,this.data,this.fieldMask,t,this.fieldTransforms):new $u(e,this.data,t,this.fieldTransforms)}}class vk{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new To(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function xk(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Jt(40011,{dataSource:n})}}class Py{constructor(e,t,i,l,u,d){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=l,u===void 0&&this.validatePath(),this.fieldTransforms=u||[],this.fieldMask=d||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Py({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Jh(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(xk(this.dataSource)&&kM.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class TM{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||bm(e)}createContext(e,t,i,l=!1){return new Py({dataSource:e,methodName:t,targetDoc:i,path:sr.emptyPath(),arrayElement:!1,hasConverter:l},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Xu(n){const e=n._freezeSettings(),t=bm(n._databaseId);return new TM(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Ly(n,e,t,i,l,u={}){const d=n.createContext(u.merge||u.mergeFields?2:0,e,t,l);Vy("Data must be an object, but it was:",d,i);const p=kk(i,d);let g,y;if(u.merge)g=new Gr(d.fieldMask),y=d.fieldTransforms;else if(u.mergeFields){const x=[];for(const _ of u.mergeFields){const j=al(e,_,t);if(!d.contains(j))throw new pt(Le.INVALID_ARGUMENT,`Field '${j}' is specified in your field mask but missing from your input data.`);Sk(x,j)||x.push(j)}g=new Gr(x),y=d.fieldTransforms.filter((_=>g.covers(_.field)))}else g=null,y=d.fieldTransforms;return new jM(new Pr(p),g,y)}class km extends Qu{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof km}}class Oy extends Qu{_toFieldTransform(e){return new L_(e.path,new Au)}isEqual(e){return e instanceof Oy}}class By extends Qu{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new Du(e.serializer,A_(e.serializer,this.Vc));return new L_(e.path,t)}isEqual(e){return e instanceof By&&this.Vc===e.Vc}}function wk(n,e,t,i){const l=n.createContext(1,e,t);Vy("Data must be an object, but it was:",l,i);const u=[],d=Pr.empty();jo(i,((g,y)=>{const x=Tk(e,g,t);y=Qs(y);const _=l.childContextForFieldPath(x);if(y instanceof km)u.push(x);else{const j=Ju(y,_);j!=null&&(u.push(x),d.set(x,j))}}));const p=new Gr(u);return new vk(d,p,l.fieldTransforms)}function _k(n,e,t,i,l,u){const d=n.createContext(1,e,t),p=[al(e,i,t)],g=[l];if(u.length%2!=0)throw new pt(Le.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let j=0;j<u.length;j+=2)p.push(al(e,u[j])),g.push(u[j+1]);const y=[],x=Pr.empty();for(let j=p.length-1;j>=0;--j)if(!Sk(y,p[j])){const O=p[j];let K=g[j];K=Qs(K);const B=d.childContextForFieldPath(O);if(K instanceof km)y.push(O);else{const D=Ju(K,B);D!=null&&(y.push(O),x.set(O,D))}}const _=new Gr(y);return new vk(x,_,d.fieldTransforms)}function SM(n,e,t,i=!1){return Ju(t,n.createContext(i?4:3,e))}function Ju(n,e){if(jk(n=Qs(n)))return Vy("Unsupported field value:",e,n),kk(n,e);if(n instanceof Qu)return(function(i,l){if(!xk(l.dataSource))throw l.createError(`${i._methodName}() can only be used with update() and set()`);if(!l.path)throw l.createError(`${i._methodName}() is not currently supported inside arrays`);const u=i._toFieldTransform(l);u&&l.fieldTransforms.push(u)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,l){const u=[];let d=0;for(const p of i){let g=Ju(p,l.childContextForArray(d));g==null&&(g={nullValue:"NULL_VALUE"}),u.push(g),d++}return{arrayValue:{values:u}}})(n,e)}return(function(i,l){if((i=Qs(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return A_(l.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const u=Rt.fromDate(i);return{timestampValue:Gh(l.serializer,u)}}if(i instanceof Rt){const u=new Rt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Gh(l.serializer,u)}}if(i instanceof Ka)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof ca)return{bytesValue:z_(l.serializer,i._byteString)};if(i instanceof yn){const u=l.databaseId,d=i.firestore._databaseId;if(!d.isEqual(u))throw l.createError(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:yy(i.firestore._databaseId||l.databaseId,i._key.path)}}if(i instanceof _a)return(function(d,p){const g=d instanceof _a?d.toArray():d;return{mapValue:{fields:{[p_]:{stringValue:g_},[Hh]:{arrayValue:{values:g.map((x=>{if(typeof x!="number")throw p.createError("VectorValues must only contain numeric values.");return fy(p.serializer,x)}))}}}}}})(i,l);if(Y_(i))return i._toProto(l.serializer);throw l.createError(`Unsupported field value: ${om(i)}`)})(n,e)}function kk(n,e){const t={};return c_(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):jo(n,((i,l)=>{const u=Ju(l,e.childContextForField(i));u!=null&&(t[i]=u)})),{mapValue:{fields:t}}}function jk(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Rt||n instanceof Ka||n instanceof ca||n instanceof yn||n instanceof Qu||n instanceof _a||Y_(n))}function Vy(n,e,t){if(!jk(t)||!o_(t)){const i=om(t);throw i==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+i)}}function al(n,e,t){if((e=Qs(e))instanceof _m)return e._internalPath;if(typeof e=="string")return Tk(n,e);throw Jh("Field path arguments must be of type string or ",n,!1,void 0,t)}const EM=new RegExp("[~\\*/\\[\\]]");function Tk(n,e,t){if(e.search(EM)>=0)throw Jh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new _m(...e.split("."))._internalPath}catch{throw Jh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Jh(n,e,t,i,l){const u=i&&!i.isEmpty(),d=l!==void 0;let p=`Function ${e}() called with invalid data`;t&&(p+=" (via `toFirestore()`)"),p+=". ";let g="";return(u||d)&&(g+=" (found",u&&(g+=` in field ${i}`),d&&(g+=` in document ${l}`),g+=")"),new pt(Le.INVALID_ARGUMENT,p+n+g)}function Sk(n,e){return n.some((t=>t.isEqual(e)))}class NM{convertValue(e,t="none"){switch(vo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return jn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(bo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Jt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return jo(e,((l,u)=>{i[l]=this.convertValue(u,t)})),i}convertVectorValue(e){const t=e.fields?.[Hh].arrayValue?.values?.map((i=>jn(i.doubleValue)));return new _a(t)}convertGeoPoint(e){return new Ka(jn(e.latitude),jn(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=um(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Eu(e));default:return null}}convertTimestamp(e){const t=yo(e);return new Rt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=nn.fromString(e);Hs(K_(i),9688,{name:e});const l=new Nu(i.get(1),i.get(3)),u=new Vt(i.popFirst(5));return l.isEqual(t)||Si(`Document ${u} contains a document reference within a different database (${l.projectId}/${l.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),u}}class Uy extends NM{constructor(e){super(),this.firestore=e}convertBytes(e){return new ca(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new yn(this.firestore,null,t)}}function yr(){return new Oy("serverTimestamp")}function Yo(n){return new By("increment",n)}const m2="@firebase/firestore",f2="4.10.0";function p2(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;const l=t;for(const u of i)if(u in l&&typeof l[u]=="function")return!0;return!1})(n,["next","error","complete"])}class Ek{constructor(e,t,i,l,u){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=l,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new yn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new CM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(al("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class CM extends Ek{data(){return super.data()}}function Nk(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new pt(Le.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Fy{}class zy extends Fy{}function Ds(n,e,...t){let i=[];e instanceof Fy&&i.push(e),i=i.concat(t),(function(u){const d=u.filter((g=>g instanceof qy)).length,p=u.filter((g=>g instanceof jm)).length;if(d>1||d>0&&p>0)throw new pt(Le.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const l of i)n=l._apply(n);return n}class jm extends zy{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new jm(e,t,i)}_apply(e){const t=this._parse(e);return Ck(e._query,t),new Ri(e.firestore,e.converter,jg(e._query,t))}_parse(e){const t=Xu(e.firestore);return(function(u,d,p,g,y,x,_){let j;if(y.isKeyField()){if(x==="array-contains"||x==="array-contains-any")throw new pt(Le.INVALID_ARGUMENT,`Invalid Query. You can't perform '${x}' queries on documentId().`);if(x==="in"||x==="not-in"){y2(_,x);const K=[];for(const B of _)K.push(g2(g,u,B));j={arrayValue:{values:K}}}else j=g2(g,u,_)}else x!=="in"&&x!=="not-in"&&x!=="array-contains-any"||y2(_,x),j=SM(p,d,_,x==="in"||x==="not-in");return Mn.create(y,x,j)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function bs(n,e,t){const i=e,l=al("where",n);return jm._create(l,i,t)}class qy extends Fy{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new qy(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:ja.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(l,u){let d=l;const p=u.getFlattenedFilters();for(const g of p)Ck(d,g),d=jg(d,g)})(e._query,t),new Ri(e.firestore,e.converter,jg(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Hy extends zy{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Hy(e,t)}_apply(e){const t=(function(l,u,d){if(l.startAt!==null)throw new pt(Le.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(l.endAt!==null)throw new pt(Le.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ru(u,d)})(e._query,this._field,this._direction);return new Ri(e.firestore,e.converter,nA(e._query,t))}}function oc(n,e="asc"){const t=e,i=al("orderBy",n);return Hy._create(i,t)}class $y extends zy{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new $y(e,t,i)}_apply(e){return new Ri(e.firestore,e.converter,Wh(e._query,this._limit,this._limitType))}}function Pu(n){return NR("limit",n),$y._create("limit",n,"F")}function g2(n,e,t){if(typeof(t=Qs(t))=="string"){if(t==="")throw new pt(Le.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!j_(e)&&t.indexOf("/")!==-1)throw new pt(Le.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(nn.fromString(t));if(!Vt.isDocumentKey(i))throw new pt(Le.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Rx(n,new Vt(i))}if(t instanceof yn)return Rx(n,t._key);throw new pt(Le.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${om(t)}.`)}function y2(n,e){if(!Array.isArray(n)||n.length===0)throw new pt(Le.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Ck(n,e){const t=(function(l,u){for(const d of l)for(const p of d.getFlattenedFilters())if(u.indexOf(p.op)>=0)return p.op;return null})(n.filters,(function(l){switch(l){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new pt(Le.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new pt(Le.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function Wy(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class fu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Qo extends Ek{constructor(e,t,i,l,u,d){super(e,t,i,l,d),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Rh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(al("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new pt(Le.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Qo._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Qo._jsonSchemaVersion="firestore/documentSnapshot/1.0",Qo._jsonSchema={type:In("string",Qo._jsonSchemaVersion),bundleSource:In("string","DocumentSnapshot"),bundleName:In("string"),bundle:In("string")};class Rh extends Qo{data(e={}){return super.data(e)}}class Xo{constructor(e,t,i,l){this._firestore=e,this._userDataWriter=t,this._snapshot=l,this.metadata=new fu(l.hasPendingWrites,l.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Rh(this._firestore,this._userDataWriter,i.key,i,new fu(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new pt(Le.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(l,u){if(l._snapshot.oldDocs.isEmpty()){let d=0;return l._snapshot.docChanges.map((p=>{const g=new Rh(l._firestore,l._userDataWriter,p.doc.key,p.doc,new fu(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);return p.doc,{type:"added",doc:g,oldIndex:-1,newIndex:d++}}))}{let d=l._snapshot.oldDocs;return l._snapshot.docChanges.filter((p=>u||p.type!==3)).map((p=>{const g=new Rh(l._firestore,l._userDataWriter,p.doc.key,p.doc,new fu(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);let y=-1,x=-1;return p.type!==0&&(y=d.indexOf(p.doc.key),d=d.delete(p.doc.key)),p.type!==1&&(d=d.add(p.doc),x=d.indexOf(p.doc.key)),{type:RM(p.type),doc:g,oldIndex:y,newIndex:x}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new pt(Le.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Xo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ly.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],l=[];return this.docs.forEach((u=>{u._document!==null&&(t.push(u._document),i.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),l.push(u.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function RM(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Jt(61501,{type:n})}}Xo._jsonSchemaVersion="firestore/querySnapshot/1.0",Xo._jsonSchema={type:In("string",Xo._jsonSchemaVersion),bundleSource:In("string","QuerySnapshot"),bundleName:In("string"),bundle:In("string")};class AM{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Xu(e)}set(e,t,i){this._verifyNotCommitted();const l=zp(e,this._firestore),u=Wy(l.converter,t,i),d=Ly(this._dataReader,"WriteBatch.set",l._key,u,l.converter!==null,i);return this._mutations.push(d.toMutation(l._key,xr.none())),this}update(e,t,i,...l){this._verifyNotCommitted();const u=zp(e,this._firestore);let d;return d=typeof(t=Qs(t))=="string"||t instanceof _m?_k(this._dataReader,"WriteBatch.update",u._key,t,i,l):wk(this._dataReader,"WriteBatch.update",u._key,t),this._mutations.push(d.toMutation(u._key,xr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=zp(e,this._firestore);return this._mutations=this._mutations.concat(new gm(t._key,xr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new pt(Le.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function zp(n,e){if((n=Qs(n)).firestore!==e)throw new pt(Le.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}function Ls(n){n=vr(n,yn);const e=vr(n.firestore,Qa),t=Yu(e);return pM(t,n._key).then((i=>Ak(e,n,i)))}function Es(n){n=vr(n,Ri);const e=vr(n.firestore,Qa),t=Yu(e),i=new Uy(e);return Nk(n._query),gM(t,n._query).then((l=>new Xo(e,i,n,l)))}function Os(n,e,t){n=vr(n,yn);const i=vr(n.firestore,Qa),l=Wy(n.converter,e,t),u=Xu(i);return Zu(i,[Ly(u,"setDoc",n._key,l,n.converter!==null,t).toMutation(n._key,xr.none())])}function la(n,e,t,...i){n=vr(n,yn);const l=vr(n.firestore,Qa),u=Xu(l);let d;return d=typeof(e=Qs(e))=="string"||e instanceof _m?_k(u,"updateDoc",n._key,e,t,i):wk(u,"updateDoc",n._key,e),Zu(l,[d.toMutation(n._key,xr.exists(!0))])}function ur(n){return Zu(vr(n.firestore,Qa),[new gm(n._key,xr.none())])}function Kr(n,e){const t=vr(n.firestore,Qa),i=Xe(n),l=Wy(n.converter,e),u=Xu(n.firestore);return Zu(t,[Ly(u,"addDoc",i._key,l,n.converter!==null,{}).toMutation(i._key,xr.exists(!1))]).then((()=>i))}function Rk(n,...e){n=Qs(n);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||p2(e[i])||(t=e[i++]);const l={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(p2(e[i])){const y=e[i];e[i]=y.next?.bind(y),e[i+1]=y.error?.bind(y),e[i+2]=y.complete?.bind(y)}let u,d,p;if(n instanceof yn)d=vr(n.firestore,Qa),p=dm(n._key.path),u={next:y=>{e[i]&&e[i](Ak(d,n,y))},error:e[i+1],complete:e[i+2]};else{const y=vr(n,Ri);d=vr(y.firestore,Qa),p=y._query;const x=new Uy(d);u={next:_=>{e[i]&&e[i](new Xo(d,x,y,_))},error:e[i+1],complete:e[i+2]},Nk(n._query)}const g=Yu(d);return fM(g,p,l,u)}function Zu(n,e){const t=Yu(n);return yM(t,e)}function Ak(n,e,t){const i=t.docs.get(e._key),l=new Uy(n);return new Qo(n,l,e._key,i,new fu(t.hasPendingWrites,t.fromCache),e.converter)}function b2(n){return n=vr(n,Qa),Yu(n),new AM(n,(e=>Zu(n,e)))}(function(e,t=!0){gR(ol),el(new po("firestore",((i,{instanceIdentifier:l,options:u})=>{const d=i.getProvider("app").getImmediate(),p=new Qa(new vR(i.getProvider("auth-internal")),new _R(d,i.getProvider("app-check-internal")),UR(d,l),d);return u={useFetchStreams:t,...u},p._setSettings(u),p}),"PUBLIC").setMultipleInstances(!0)),qa(m2,f2,e),qa(m2,f2,"esm2020")})();var MM="firebase",IM="12.8.0";qa(MM,IM,"app");const Mk="firebasestorage.googleapis.com",Ik="storageBucket",DM=120*1e3,PM=600*1e3;class vn extends Xa{constructor(e,t,i=0){super(qp(e),`Firebase Storage: ${t} (${qp(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,vn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return qp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var bn;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(bn||(bn={}));function qp(n){return"storage/"+n}function Gy(){const n="An unknown error occurred, please check the error payload for server response.";return new vn(bn.UNKNOWN,n)}function LM(n){return new vn(bn.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function OM(n){return new vn(bn.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function BM(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new vn(bn.UNAUTHENTICATED,n)}function VM(){return new vn(bn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function UM(n){return new vn(bn.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function FM(){return new vn(bn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function zM(){return new vn(bn.CANCELED,"User canceled the upload/download.")}function qM(n){return new vn(bn.INVALID_URL,"Invalid URL '"+n+"'.")}function HM(n){return new vn(bn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function $M(){return new vn(bn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Ik+"' property when initializing the app?")}function WM(){return new vn(bn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function GM(){return new vn(bn.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function KM(n){return new vn(bn.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Dg(n){return new vn(bn.INVALID_ARGUMENT,n)}function Dk(){return new vn(bn.APP_DELETED,"The Firebase app was deleted.")}function YM(n){return new vn(bn.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function wu(n,e){return new vn(bn.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function ru(n){throw new vn(bn.INTERNAL_ERROR,"Internal error: "+n)}class br{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=br.makeFromUrl(e,t)}catch{return new br(e,"")}if(i.path==="")return i;throw HM(e)}static makeFromUrl(e,t){let i=null;const l="([A-Za-z0-9.\\-_]+)";function u(je){je.path.charAt(je.path.length-1)==="/"&&(je.path_=je.path_.slice(0,-1))}const d="(/(.*))?$",p=new RegExp("^gs://"+l+d,"i"),g={bucket:1,path:3};function y(je){je.path_=decodeURIComponent(je.path)}const x="v[A-Za-z0-9_]+",_=t.replace(/[.]/g,"\\."),j="(/([^?#]*).*)?$",O=new RegExp(`^https?://${_}/${x}/b/${l}/o${j}`,"i"),K={bucket:1,path:3},B=t===Mk?"(?:storage.googleapis.com|storage.cloud.google.com)":t,D="([^?#]*)",se=new RegExp(`^https?://${B}/${l}/${D}`,"i"),Z=[{regex:p,indices:g,postModify:u},{regex:O,indices:K,postModify:y},{regex:se,indices:{bucket:1,path:2},postModify:y}];for(let je=0;je<Z.length;je++){const Re=Z[je],ke=Re.regex.exec(e);if(ke){const C=ke[Re.indices.bucket];let T=ke[Re.indices.path];T||(T=""),i=new br(C,T),Re.postModify(i);break}}if(i==null)throw qM(e);return i}}class QM{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function XM(n,e,t){let i=1,l=null,u=null,d=!1,p=0;function g(){return p===2}let y=!1;function x(...D){y||(y=!0,e.apply(null,D))}function _(D){l=setTimeout(()=>{l=null,n(O,g())},D)}function j(){u&&clearTimeout(u)}function O(D,...se){if(y){j();return}if(D){j(),x.call(null,D,...se);return}if(g()||d){j(),x.call(null,D,...se);return}i<64&&(i*=2);let Z;p===1?(p=2,Z=0):Z=(i+Math.random())*1e3,_(Z)}let K=!1;function B(D){K||(K=!0,j(),!y&&(l!==null?(D||(p=2),clearTimeout(l),_(0)):D||(p=1)))}return _(0),u=setTimeout(()=>{d=!0,B(!0)},t),B}function JM(n){n(!1)}function ZM(n){return n!==void 0}function eI(n){return typeof n=="object"&&!Array.isArray(n)}function Ky(n){return typeof n=="string"||n instanceof String}function v2(n){return Yy()&&n instanceof Blob}function Yy(){return typeof Blob<"u"}function Pg(n,e,t,i){if(i<e)throw Dg(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw Dg(`Invalid value for '${n}'. Expected ${t} or less.`)}function Tm(n,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${n}`}function Pk(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const l=e(i)+"="+e(n[i]);t=t+l+"&"}return t=t.slice(0,-1),t}var Jo;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Jo||(Jo={}));function tI(n,e){const t=n>=500&&n<600,l=[408,429].indexOf(n)!==-1,u=e.indexOf(n)!==-1;return t||l||u}class sI{constructor(e,t,i,l,u,d,p,g,y,x,_,j=!0,O=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=l,this.successCodes_=u,this.additionalRetryCodes_=d,this.callback_=p,this.errorCallback_=g,this.timeout_=y,this.progressCallback_=x,this.connectionFactory_=_,this.retry=j,this.isUsingEmulator=O,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((K,B)=>{this.resolve_=K,this.reject_=B,this.start_()})}start_(){const e=(i,l)=>{if(l){i(!1,new dh(!1,null,!0));return}const u=this.connectionFactory_();this.pendingConnection_=u;const d=p=>{const g=p.loaded,y=p.lengthComputable?p.total:-1;this.progressCallback_!==null&&this.progressCallback_(g,y)};this.progressCallback_!==null&&u.addUploadProgressListener(d),u.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&u.removeUploadProgressListener(d),this.pendingConnection_=null;const p=u.getErrorCode()===Jo.NO_ERROR,g=u.getStatus();if(!p||tI(g,this.additionalRetryCodes_)&&this.retry){const x=u.getErrorCode()===Jo.ABORT;i(!1,new dh(!1,null,x));return}const y=this.successCodes_.indexOf(g)!==-1;i(!0,new dh(y,u))})},t=(i,l)=>{const u=this.resolve_,d=this.reject_,p=l.connection;if(l.wasSuccessCode)try{const g=this.callback_(p,p.getResponse());ZM(g)?u(g):u()}catch(g){d(g)}else if(p!==null){const g=Gy();g.serverResponse=p.getErrorText(),this.errorCallback_?d(this.errorCallback_(p,g)):d(g)}else if(l.canceled){const g=this.appDelete_?Dk():zM();d(g)}else{const g=FM();d(g)}};this.canceled_?t(!1,new dh(!1,null,!0)):this.backoffId_=XM(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&JM(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class dh{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function nI(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function rI(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function aI(n,e){e&&(n["X-Firebase-GMPID"]=e)}function iI(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function oI(n,e,t,i,l,u,d=!0,p=!1){const g=Pk(n.urlParams),y=n.url+g,x=Object.assign({},n.headers);return aI(x,e),nI(x,t),rI(x,u),iI(x,i),new sI(y,n.method,x,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,l,d,p)}function lI(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function cI(...n){const e=lI();if(e!==void 0){const t=new e;for(let i=0;i<n.length;i++)t.append(n[i]);return t.getBlob()}else{if(Yy())return new Blob(n);throw new vn(bn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function uI(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function dI(n){if(typeof atob>"u")throw KM("base-64");return atob(n)}const za={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Hp{constructor(e,t){this.data=e,this.contentType=t||null}}function hI(n,e){switch(n){case za.RAW:return new Hp(Lk(e));case za.BASE64:case za.BASE64URL:return new Hp(Ok(n,e));case za.DATA_URL:return new Hp(fI(e),pI(e))}throw Gy()}function Lk(n){const e=[];for(let t=0;t<n.length;t++){let i=n.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const u=i,d=n.charCodeAt(++t);i=65536|(u&1023)<<10|d&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function mI(n){let e;try{e=decodeURIComponent(n)}catch{throw wu(za.DATA_URL,"Malformed data URL.")}return Lk(e)}function Ok(n,e){switch(n){case za.BASE64:{const l=e.indexOf("-")!==-1,u=e.indexOf("_")!==-1;if(l||u)throw wu(n,"Invalid character '"+(l?"-":"_")+"' found: is it base64url encoded?");break}case za.BASE64URL:{const l=e.indexOf("+")!==-1,u=e.indexOf("/")!==-1;if(l||u)throw wu(n,"Invalid character '"+(l?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=dI(e)}catch(l){throw l.message.includes("polyfill")?l:wu(n,"Invalid character found")}const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i}class Bk{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw wu(za.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=gI(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function fI(n){const e=new Bk(n);return e.base64?Ok(za.BASE64,e.rest):mI(e.rest)}function pI(n){return new Bk(n).contentType}function gI(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}class oo{constructor(e,t){let i=0,l="";v2(e)?(this.data_=e,i=e.size,l=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=l}size(){return this.size_}type(){return this.type_}slice(e,t){if(v2(this.data_)){const i=this.data_,l=uI(i,e,t);return l===null?null:new oo(l)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new oo(i,!0)}}static getBlob(...e){if(Yy()){const t=e.map(i=>i instanceof oo?i.data_:i);return new oo(cI.apply(null,t))}else{const t=e.map(d=>Ky(d)?hI(za.RAW,d).data:d.data_);let i=0;t.forEach(d=>{i+=d.byteLength});const l=new Uint8Array(i);let u=0;return t.forEach(d=>{for(let p=0;p<d.length;p++)l[u++]=d[p]}),new oo(l,!0)}}uploadData(){return this.data_}}function Qy(n){let e;try{e=JSON.parse(n)}catch{return null}return eI(e)?e:null}function yI(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function bI(n,e){const t=e.split("/").filter(i=>i.length>0).join("/");return n.length===0?t:n+"/"+t}function Vk(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function vI(n,e){return e}class gr{constructor(e,t,i,l){this.server=e,this.local=t||e,this.writable=!!i,this.xform=l||vI}}let hh=null;function xI(n){return!Ky(n)||n.length<2?n:Vk(n)}function Uk(){if(hh)return hh;const n=[];n.push(new gr("bucket")),n.push(new gr("generation")),n.push(new gr("metageneration")),n.push(new gr("name","fullPath",!0));function e(u,d){return xI(d)}const t=new gr("name");t.xform=e,n.push(t);function i(u,d){return d!==void 0?Number(d):d}const l=new gr("size");return l.xform=i,n.push(l),n.push(new gr("timeCreated")),n.push(new gr("updated")),n.push(new gr("md5Hash",null,!0)),n.push(new gr("cacheControl",null,!0)),n.push(new gr("contentDisposition",null,!0)),n.push(new gr("contentEncoding",null,!0)),n.push(new gr("contentLanguage",null,!0)),n.push(new gr("contentType",null,!0)),n.push(new gr("metadata","customMetadata",!0)),hh=n,hh}function wI(n,e){function t(){const i=n.bucket,l=n.fullPath,u=new br(i,l);return e._makeStorageReference(u)}Object.defineProperty(n,"ref",{get:t})}function _I(n,e,t){const i={};i.type="file";const l=t.length;for(let u=0;u<l;u++){const d=t[u];i[d.local]=d.xform(i,e[d.server])}return wI(i,n),i}function Fk(n,e,t){const i=Qy(e);return i===null?null:_I(n,i,t)}function kI(n,e,t,i){const l=Qy(e);if(l===null||!Ky(l.downloadTokens))return null;const u=l.downloadTokens;if(u.length===0)return null;const d=encodeURIComponent;return u.split(",").map(y=>{const x=n.bucket,_=n.fullPath,j="/b/"+d(x)+"/o/"+d(_),O=Tm(j,t,i),K=Pk({alt:"media",token:y});return O+K})[0]}function jI(n,e){const t={},i=e.length;for(let l=0;l<i;l++){const u=e[l];u.writable&&(t[u.server]=n[u.local])}return JSON.stringify(t)}const x2="prefixes",w2="items";function TI(n,e,t){const i={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[x2])for(const l of t[x2]){const u=l.replace(/\/$/,""),d=n._makeStorageReference(new br(e,u));i.prefixes.push(d)}if(t[w2])for(const l of t[w2]){const u=n._makeStorageReference(new br(e,l.name));i.items.push(u)}return i}function SI(n,e,t){const i=Qy(t);return i===null?null:TI(n,e,i)}class Xy{constructor(e,t,i,l){this.url=e,this.method=t,this.handler=i,this.timeout=l,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Jy(n){if(!n)throw Gy()}function EI(n,e){function t(i,l){const u=Fk(n,l,e);return Jy(u!==null),u}return t}function NI(n,e){function t(i,l){const u=SI(n,e,l);return Jy(u!==null),u}return t}function CI(n,e){function t(i,l){const u=Fk(n,l,e);return Jy(u!==null),kI(u,l,n.host,n._protocol)}return t}function Zy(n){function e(t,i){let l;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?l=VM():l=BM():t.getStatus()===402?l=OM(n.bucket):t.getStatus()===403?l=UM(n.path):l=i,l.status=t.getStatus(),l.serverResponse=i.serverResponse,l}return e}function RI(n){const e=Zy(n);function t(i,l){let u=e(i,l);return i.getStatus()===404&&(u=LM(n.path)),u.serverResponse=l.serverResponse,u}return t}function AI(n,e,t,i,l){const u={};e.isRoot?u.prefix="":u.prefix=e.path+"/",t.length>0&&(u.delimiter=t),i&&(u.pageToken=i),l&&(u.maxResults=l);const d=e.bucketOnlyServerUrl(),p=Tm(d,n.host,n._protocol),g="GET",y=n.maxOperationRetryTime,x=new Xy(p,g,NI(n,e.bucket),y);return x.urlParams=u,x.errorHandler=Zy(e),x}function MI(n,e,t){const i=e.fullServerUrl(),l=Tm(i,n.host,n._protocol),u="GET",d=n.maxOperationRetryTime,p=new Xy(l,u,CI(n,t),d);return p.errorHandler=RI(e),p}function II(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function DI(n,e,t){const i=Object.assign({},t);return i.fullPath=n.path,i.size=e.size(),i.contentType||(i.contentType=II(null,e)),i}function PI(n,e,t,i,l){const u=e.bucketOnlyServerUrl(),d={"X-Goog-Upload-Protocol":"multipart"};function p(){let Z="";for(let je=0;je<2;je++)Z=Z+Math.random().toString().slice(2);return Z}const g=p();d["Content-Type"]="multipart/related; boundary="+g;const y=DI(e,i,l),x=jI(y,t),_="--"+g+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+x+`\r
--`+g+`\r
Content-Type: `+y.contentType+`\r
\r
`,j=`\r
--`+g+"--",O=oo.getBlob(_,i,j);if(O===null)throw WM();const K={name:y.fullPath},B=Tm(u,n.host,n._protocol),D="POST",se=n.maxUploadRetryTime,Y=new Xy(B,D,EI(n,t),se);return Y.urlParams=K,Y.headers=d,Y.body=O.uploadData(),Y.errorHandler=Zy(e),Y}class LI{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Jo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Jo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Jo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,l,u){if(this.sent_)throw ru("cannot .send() more than once");if(_o(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),u!==void 0)for(const d in u)u.hasOwnProperty(d)&&this.xhr_.setRequestHeader(d,u[d].toString());return l!==void 0?this.xhr_.send(l):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw ru("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw ru("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw ru("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw ru("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class OI extends LI{initXhr(){this.xhr_.responseType="text"}}function eb(){return new OI}class il{constructor(e,t){this._service=e,t instanceof br?this._location=t:this._location=br.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new il(e,t)}get root(){const e=new br(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Vk(this._location.path)}get storage(){return this._service}get parent(){const e=yI(this._location.path);if(e===null)return null;const t=new br(this._location.bucket,e);return new il(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw YM(e)}}function BI(n,e,t){n._throwIfRoot("uploadBytes");const i=PI(n.storage,n._location,Uk(),new oo(e,!0),t);return n.storage.makeRequestWithTokens(i,eb).then(l=>({metadata:l,ref:n}))}function VI(n){const e={prefixes:[],items:[]};return zk(n,e).then(()=>e)}async function zk(n,e,t){const l=await UI(n,{pageToken:t});e.prefixes.push(...l.prefixes),e.items.push(...l.items),l.nextPageToken!=null&&await zk(n,e,l.nextPageToken)}function UI(n,e){e!=null&&typeof e.maxResults=="number"&&Pg("options.maxResults",1,1e3,e.maxResults);const t=e||{},i=AI(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(i,eb)}function FI(n){n._throwIfRoot("getDownloadURL");const e=MI(n.storage,n._location,Uk());return n.storage.makeRequestWithTokens(e,eb).then(t=>{if(t===null)throw GM();return t})}function zI(n,e){const t=bI(n._location.path,e),i=new br(n._location.bucket,t);return new il(n.storage,i)}function qI(n){return/^[A-Za-z]+:\/\//.test(n)}function HI(n,e){return new il(n,e)}function qk(n,e){if(n instanceof tb){const t=n;if(t._bucket==null)throw $M();const i=new il(t,t._bucket);return e!=null?qk(i,e):i}else return e!==void 0?zI(n,e):n}function $I(n,e){if(e&&qI(e)){if(n instanceof tb)return HI(n,e);throw Dg("To use ref(service, url), the first argument must be a Storage instance.")}else return qk(n,e)}function _2(n,e){const t=e?.[Ik];return t==null?null:br.makeFromBucketSpec(t,n)}function WI(n,e,t,i={}){n.host=`${e}:${t}`;const l=_o(e);l&&(Wg(`https://${n.host}/b`),Gg("Storage",!0)),n._isUsingEmulator=!0,n._protocol=l?"https":"http";const{mockUserToken:u}=i;u&&(n._overrideAuthToken=typeof u=="string"?u:hw(u,n.app.options.projectId))}class tb{constructor(e,t,i,l,u,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=l,this._firebaseVersion=u,this._isUsingEmulator=d,this._bucket=null,this._host=Mk,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=DM,this._maxUploadRetryTime=PM,this._requests=new Set,l!=null?this._bucket=br.makeFromBucketSpec(l,this._host):this._bucket=_2(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=br.makeFromBucketSpec(this._url,e):this._bucket=_2(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Pg("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Pg("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Wr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new il(this,e)}_makeRequest(e,t,i,l,u=!0){if(this._deleted)return new QM(Dk());{const d=oI(e,this._appId,i,l,t,this._firebaseVersion,u,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[i,l]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,l).getPromise()}}const k2="@firebase/storage",j2="0.14.0";const Hk="storage";function Ah(n,e,t){return n=Qs(n),BI(n,e,t)}function T2(n){return n=Qs(n),VI(n)}function fo(n){return n=Qs(n),FI(n)}function bi(n,e){return n=Qs(n),$I(n,e)}function GI(n=Xg(),e){n=Qs(n);const i=nm(n,Hk).getImmediate({identifier:e}),l=cw("storage");return l&&KI(i,...l),i}function KI(n,e,t,i={}){WI(n,e,t,i)}function YI(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),l=n.getProvider("app-check-internal");return new tb(t,i,l,e,ol)}function QI(){el(new po(Hk,YI,"PUBLIC").setMultipleInstances(!0)),qa(k2,j2,""),qa(k2,j2,"esm2020")}QI();const $k={apiKey:"AIzaSyBCIgMJd3By7qkWH27YiW9VooIBGE3bFLs",authDomain:"mind-core-fitness-client.firebaseapp.com",projectId:"mind-core-fitness-client",storageBucket:"mind-core-fitness-client.firebasestorage.app",messagingSenderId:"669343392406",appId:"1:669343392406:web:f5a35ee062387e7d6f58b7"},sb=Qg($k),qo=Xw(sb),ye=wM(sb),vi=GI(sb),XI=Qg($k,"secondary"),bP=Xw(XI),JI="EYdciKDOi3UYBLk1u8hHams5tmO2",Wk=b.createContext();function Lr(){return b.useContext(Wk)}function ZI({children:n}){const[e,t]=b.useState(null),[i,l]=b.useState(!1),[u,d]=b.useState(!1),[p,g]=b.useState(null),[y,x]=b.useState(!0);b.useEffect(()=>{let Y=null;const Z=r4(qo,je=>{if(t(je),Y&&(Y(),Y=null),je)if(je.uid===JI)l(!0),d(!1),g(null),x(!1);else{l(!1);const Re=Ds(qt(ye,"clients"),bs("uid","==",je.uid)),ke=async()=>{const C=localStorage.getItem("mcf_clientId");if(C)try{const T=await Ls(Xe(ye,"clients",C));T.exists()&&(d(!0),g({id:T.id,...T.data()}))}catch(T){console.error("Direct client read failed:",T)}};Y=Rk(Re,async C=>{if(C.empty)await ke();else{const T=C.docs[0];d(!0),g({id:T.id,...T.data()});try{localStorage.setItem("mcf_clientId",T.id)}catch{}}x(!1)},async C=>{console.error("Error listening to client data:",C),await ke(),x(!1)})}else l(!1),d(!1),g(null),x(!1)});return()=>{Z(),Y&&Y()}},[]);const se={currentUser:e,isAdmin:i,isClient:u,clientData:p,updateClientData:Y=>{g(Z=>Z?{...Z,...Y}:Y)},resolveClient:async()=>{if(p)return p;const Y=localStorage.getItem("mcf_clientId");if(Y)try{const Z=await Ls(Xe(ye,"clients",Y));if(Z.exists()){const je={id:Z.id,...Z.data()};return d(!0),g(je),je}}catch(Z){console.error("resolveClient direct read failed:",Z)}if(e){const Z=Ds(qt(ye,"clients"),bs("uid","==",e.uid)),je=await Es(Z);if(!je.empty){const Re={id:je.docs[0].id,...je.docs[0].data()};return d(!0),g(Re),Re}}return null},login:async(Y,Z,je=!0)=>(await lx(qo,je?gg:ry),await t4(qo,Y,Z)),signup:async(Y,Z,je)=>{await lx(qo,gg);const Re=await e4(qo,Z.trim().toLowerCase(),je),ke=Re.user,C=Xe(qt(ye,"clients")),T={uid:ke.uid,name:Y.trim(),email:Z.trim().toLowerCase(),clientType:"core_buddy",coreBuddyAccess:!0,status:"active",tier:"free",subscriptionStatus:null,signupSource:"self_signup",createdAt:Rt.now()};await Os(C,T),d(!0),g({id:C.id,...T});try{localStorage.setItem("mcf_clientId",C.id)}catch{}return Re},logout:()=>{try{localStorage.removeItem("mcf_clientId")}catch{}return a4(qo)},resetPassword:Y=>ZC(qo,Y),loading:y};return r.jsx(Wk.Provider,{value:se,children:n})}const Gk=b.createContext();function Ca(){return b.useContext(Gk)}function eD({children:n}){const[e,t]=b.useState(()=>{const g=localStorage.getItem("theme");return g?g==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches}),[i,l]=b.useState(()=>localStorage.getItem("accent")||"red");b.useEffect(()=>{document.documentElement.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("theme",e?"dark":"light")},[e]),b.useEffect(()=>{localStorage.setItem("accent",i)},[i]);const p={isDark:e,toggleTheme:()=>{document.documentElement.setAttribute("data-theme-transitioning",""),t(!e),setTimeout(()=>{document.documentElement.removeAttribute("data-theme-transitioning")},350)},accent:i,setAccent:g=>l(g)};return r.jsx(Gk.Provider,{value:p,children:n})}const Kk=b.createContext();function yc(){return b.useContext(Kk)}const tD=["nutrition","personalBests","achievements","buddies","programmes"],sD=[5,10],nD=3,rD=1;function aD({children:n}){const{clientData:e,loading:t}=Lr(),i=b.useMemo(()=>{const l=e?.tier||"free",u=e?.subscriptionStatus||null,d=e&&e.signupSource!=="self_signup",p=l==="premium"||!!d;function g(y){return p?!0:!tD.includes(y)}return{tier:l,subscriptionStatus:u,isPremium:p,canAccess:g,loading:t,FREE_RANDOMISER_DURATIONS:sD,FREE_RANDOMISER_WEEKLY_LIMIT:nD,FREE_HABIT_LIMIT:rD}},[e?.tier,e?.subscriptionStatus,e?.signupSource,t]);return r.jsx(Kk.Provider,{value:i,children:n})}function iD(n){if(n?.signupSource==="self_signup"&&!n?.onboardingComplete)return"/onboarding";const e=n?.clientType;return e==="core_buddy"?"/client/core-buddy":e==="circuit_vip"||e==="circuit_dropin"?"/client/circuit":"/client"}function oD({className:n=""}){const{isDark:e,toggleTheme:t}=Ca();return r.jsx("button",{className:n||"theme-toggle",onClick:t,"aria-label":e?"Switch to light mode":"Switch to dark mode",children:e?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})})}function lD(){const[n,e]=b.useState(""),[t,i]=b.useState(""),[l,u]=b.useState(!0),[d,p]=b.useState(""),[g,y]=b.useState(!1),[x,_]=b.useState(!1),[j,O]=b.useState(!1),{login:K,resetPassword:B,currentUser:D,isAdmin:se,isClient:Y,clientData:Z,loading:je}=Lr(),Re=rr();if(b.useEffect(()=>{!je&&D&&(se?Re("/dashboard"):Y?Re(iD(Z)):(y(!1),p("No account found. Please sign up or contact your trainer.")))},[je,D,se,Y,Z,Re]),je||D)return r.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh",background:"var(--bg-body)"},children:r.jsx("div",{style:{width:36,height:36,border:"3px solid var(--color-primary-light)",borderTopColor:"var(--color-primary)",borderRadius:"50%",animation:"app-spin .7s linear infinite"}})});const ke=async T=>{T.preventDefault(),p(""),y(!0);try{await K(n,t,l)}catch(M){p(M.message||"Failed to log in"),y(!1)}},C=async T=>{if(T.preventDefault(),p(""),!n.trim()){p("Please enter your email address");return}y(!0);try{await B(n.trim()),O(!0)}catch(M){M.code==="auth/user-not-found"?p("No account found with this email"):p(M.message||"Failed to send reset email")}y(!1)};return r.jsxs("div",{className:"login-container",children:[r.jsx(oD,{className:"login-theme-toggle"}),r.jsxs("div",{className:"login-card",children:[r.jsxs("div",{className:"login-header",children:[r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"login-logo"}),r.jsx("p",{children:r.jsx("strong",{children:x?"Reset Password":"Sign in as 1-2-1 or a Core Buddy"})})]}),d&&r.jsx("div",{className:"error-message",children:d}),j?r.jsxs("div",{className:"reset-sent",children:[r.jsx("div",{className:"reset-sent-icon",children:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M22 2L11 13",strokeLinecap:"round",strokeLinejoin:"round"}),r.jsx("path",{d:"M22 2L15 22L11 13L2 9L22 2Z",strokeLinecap:"round",strokeLinejoin:"round"})]})}),r.jsx("p",{children:"Reset email sent!"}),r.jsx("span",{children:"Check your inbox for a password reset link"}),r.jsx("button",{className:"login-btn",style:{marginTop:"20px"},onClick:()=>{_(!1),O(!1),p("")},children:"Back to Log In"})]}):x?r.jsxs("form",{onSubmit:C,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email"}),r.jsx("input",{type:"email",id:"email",value:n,onChange:T=>e(T.target.value),placeholder:"Enter your email",required:!0})]}),r.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Sending...":"Send Reset Link"}),r.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{_(!1),p("")},children:"Back to Log In"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("form",{onSubmit:ke,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email"}),r.jsx("input",{type:"email",id:"email",value:n,onChange:T=>e(T.target.value),required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"password",children:"Password"}),r.jsx("input",{type:"password",id:"password",value:t,onChange:T=>i(T.target.value),required:!0})]}),r.jsx("div",{className:"remember-me",children:r.jsxs("label",{children:[r.jsx("input",{type:"checkbox",checked:l,onChange:T=>u(T.target.checked)}),r.jsx("span",{children:"Remember me"})]})}),r.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Logging in...":"Log In"})]}),r.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{_(!0),p("")},children:"Forgot password?"}),r.jsx("button",{type:"button",className:"login-btn login-btn-outline",onClick:()=>Re("/signup"),children:"Don't have an account? Create one free"})]}),r.jsx("a",{href:"/",className:"back-link",children:"Back to website"})]})]})}function Ul({feature:n,children:e}){const{canAccess:t,loading:i}=yc();return i||t(n)?e:r.jsx(Z2,{to:"/upgrade",replace:!0})}function Ta({active:n}){const e=rr(),{clientData:t}=Lr(),{isPremium:i}=yc(),l=t?.clientType==="block"&&t?.coreBuddyAccess;return r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:`block-nav-tab${n==="home"?" active":""}`,onClick:()=>e("/client/core-buddy"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),r.jsx("span",{children:"Profile"})]}),r.jsxs("button",{className:`block-nav-tab${n==="workouts"?" active":""}`,onClick:()=>e("/client/core-buddy/workouts"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:r.jsx("path",{d:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"})}),r.jsx("span",{children:"Workouts"})]}),i&&r.jsxs("button",{className:`block-nav-tab${n==="nutrition"?" active":""}`,onClick:()=>e("/client/core-buddy/nutrition"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"})}),r.jsx("span",{children:"Nutrition"})]}),i&&r.jsxs("button",{className:`block-nav-tab${n==="buddies"?" active":""}`,onClick:()=>e("/client/core-buddy/buddies"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("span",{children:"Buddies"})]}),l&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>e("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),r.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),r.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),r.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),r.jsx("span",{children:"Block"})]})]})}function Sa({children:n,onRefresh:e}){const[t,i]=b.useState(0),[l,u]=b.useState(!1),d=b.useRef(null),p=b.useRef(0),g=b.useRef(!1),y=b.useCallback(j=>{window.scrollY<=0&&(p.current=j.touches[0].clientY,g.current=!0)},[]),x=b.useCallback(j=>{if(!g.current||l)return;const O=j.touches[0].clientY-p.current;O>20&&window.scrollY<=0&&(j.preventDefault(),i(Math.min((O-20)*.35,80)))},[l]),_=b.useCallback(async()=>{t>55&&!l&&(u(!0),e?await e():window.location.reload(),u(!1)),i(0),g.current=!1},[t,l,e]);return r.jsxs("div",{ref:d,onTouchStart:y,onTouchMove:x,onTouchEnd:_,children:[r.jsxs("div",{className:`pull-refresh-indicator ${t>0?"visible":""} ${l?"refreshing":""}`,style:{height:t},children:[r.jsx("div",{className:`refresh-spinner ${l?"spinning":""}`,children:r.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:r.jsx("path",{fill:"currentColor",d:"M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"})})}),r.jsx("span",{className:"refresh-text",children:l?"Refreshing...":"Pull to refresh"})]}),n]})}function ed(n,e,t,i,l){const u=[];for(let d=0;d<n;d++){const p=(d*(360/n)-90)*(Math.PI/180);u.push({x1:e+i*Math.cos(p),y1:t+i*Math.sin(p),x2:e+l*Math.cos(p),y2:t+l*Math.sin(p),thick:d%5===0})}return u}const Sm=ed(60,100,100,85,96),Yk=ed(60,100,100,78,94),cD=ed(60,100,100,82,94);ed(60,50,50,38,46);const S2=ed(60,40,40,30,37),uD="/login/assets/first_workout-B8SFkzJX.PNG",dD="/login/assets/workouts_10-Z5R3u0xH.PNG",hD="/login/assets/workouts_25-CzxSlcAj.PNG",mD="/login/assets/workouts_50-BpzWup3V.PNG",fD="/login/assets/workouts_100-D7_r6tn1.PNG",pD="/login/assets/streak_2-CsRr-XA9.PNG",gD="/login/assets/streak_4-BHO09tbw.PNG",yD="/login/assets/streak_8-DX2UWMko.PNG",bD="/login/assets/first_pb-aVf_CNWy.PNG",vD="/login/assets/pbs_5-Cippawgg.PNG",xD="/login/assets/pbs_10-CZgGh9Kv.PNG",wD="/login/assets/pbs_100-C67b1wfS.PNG",_D="/login/assets/nutrition_7-CHVV11fj.PNG",kD="/login/assets/leaderboard_join-BLoId4Hz.PNG",jD="/login/assets/habits_7-Dvki70KO.PNG",Un=[{id:"first_workout",img:uD,name:"First Rep",desc:"Complete your first workout",category:"workouts",threshold:1},{id:"workouts_10",img:dD,name:"On Fire",desc:"Complete 10 workouts",category:"workouts",threshold:10},{id:"workouts_25",img:hD,name:"Dedicated",desc:"Complete 25 workouts",category:"workouts",threshold:25},{id:"workouts_50",img:mD,name:"Unstoppable",desc:"Complete 50 workouts",category:"workouts",threshold:50},{id:"workouts_100",img:fD,name:"Century",desc:"Complete 100 workouts",category:"workouts",threshold:100},{id:"streak_2",img:pD,name:"2 Week Streak",desc:"Work out for 2 weeks in a row",category:"streaks",threshold:2},{id:"streak_4",img:gD,name:"Month Strong",desc:"Work out for 4 weeks in a row",category:"streaks",threshold:4},{id:"streak_8",img:yD,name:"Iron Will",desc:"Work out for 8 weeks in a row",category:"streaks",threshold:8},{id:"first_pb",img:bD,name:"First PB",desc:"Set your first personal best",category:"pbs",threshold:1},{id:"pbs_5",img:vD,name:"PB Hunter",desc:"Set 5 personal bests",category:"pbs",threshold:5},{id:"pbs_10",img:xD,name:"PB Machine",desc:"Set 10 personal bests",category:"pbs",threshold:10},{id:"pbs_100",img:wD,name:"PB Legend",desc:"Set 100 personal bests",category:"pbs",threshold:100},{id:"nutrition_7",img:_D,name:"Macro Master",desc:"Hit your macro targets 7 days in a row",category:"nutrition",threshold:7},{id:"leaderboard_join",img:kD,name:"Competitor",desc:"Join the leaderboard",category:"leaderboard",threshold:1},{id:"habits_7",img:jD,name:"Habit Streak",desc:"Complete your daily habits 7 days in a row",category:"habits",threshold:7}];function TD({steps:n,onFinish:e,active:t}){const[i,l]=b.useState(0),[u,d]=b.useState(null),[p,g]=b.useState("below"),[y,x]=b.useState(!1),_=b.useRef(null),j=b.useRef(t);j.current=t,b.useEffect(()=>{t||l(0)},[t]),b.useEffect(()=>{if(!t)return;const Re=ke=>ke.preventDefault();return document.addEventListener("touchmove",Re,{passive:!1}),document.addEventListener("wheel",Re,{passive:!1}),document.body.style.overflow="hidden",()=>{document.removeEventListener("touchmove",Re),document.removeEventListener("wheel",Re),document.body.style.overflow=""}},[t]);const O=b.useMemo(()=>t?n.filter(Re=>document.querySelector(Re.selector)):[],[t]),K=O[i],B=i===O.length-1,D=K?.selector,se=b.useCallback(()=>{if(!D)return;const Re=document.querySelector(D);if(!Re){d(null);return}const ke=Re.getBoundingClientRect(),C=8;d({top:ke.top-C,left:ke.left-C,width:ke.width+C*2,height:ke.height+C*2});const T=window.innerHeight-ke.bottom;g(T<260?"above":"below")},[D]);if(b.useEffect(()=>{if(!t||!D)return;x(!0);const Re=document.querySelector(D);if(Re){document.body.style.overflow="",Re.scrollIntoView({behavior:"smooth",block:"center"});let ke=null,C=0,T=0;const M=60,V=()=>{T++;const A=Re.getBoundingClientRect(),Oe=Math.round(A.top);if(ke!==null&&Oe===ke?C++:C=0,ke=Oe,C>=3||T>=M){j.current&&(document.body.style.overflow="hidden"),se(),x(!1);return}I=requestAnimationFrame(V)};let I;const L=setTimeout(()=>{I=requestAnimationFrame(V)},120);return()=>{clearTimeout(L),I&&cancelAnimationFrame(I),j.current&&(document.body.style.overflow="hidden")}}},[t,i,D,se]),b.useEffect(()=>{if(!t)return;const Re=()=>{_.current&&cancelAnimationFrame(_.current),_.current=requestAnimationFrame(se)};return window.addEventListener("scroll",Re,!0),window.addEventListener("resize",Re),()=>{window.removeEventListener("scroll",Re,!0),window.removeEventListener("resize",Re),_.current&&cancelAnimationFrame(_.current)}},[t,se]),!t||!K||O.length===0)return null;const Y=()=>{B?e():l(i+1)},Z=()=>{i>0&&l(i-1)},je=()=>e();return r.jsxs("div",{className:"st-overlay",onClick:Re=>{Re.stopPropagation()},children:[r.jsx("div",{className:"st-backdrop",onClick:Y}),u&&r.jsx("div",{className:`st-spotlight${y?" st-transitioning":""}`,style:{top:u.top,left:u.left,width:u.width,height:u.height}}),u&&r.jsxs("div",{className:`st-tooltip st-tooltip-${p}${y?" st-transitioning":""}`,style:{top:p==="below"?Math.min(Math.max(u.top+u.height+16,16),window.innerHeight-200):void 0,bottom:p==="above"?Math.min(Math.max(window.innerHeight-u.top+16,16),window.innerHeight-60):void 0,left:Math.max(16,Math.min(u.left,window.innerWidth-320))},children:[r.jsx("div",{className:"st-dots",children:O.map((Re,ke)=>r.jsx("span",{className:`st-dot${ke===i?" active":""}${ke<i?" done":""}`},ke))}),r.jsx("h3",{className:"st-title",children:K.title}),r.jsx("p",{className:"st-body",children:K.body}),r.jsxs("div",{className:"st-actions",children:[i>0&&r.jsx("button",{className:"st-btn st-btn-back",onClick:Z,children:"Back"}),r.jsx("button",{className:"st-btn st-btn-next",onClick:Y,children:K.cta||(B?"Let's Go!":"Next")})]}),r.jsx("button",{className:"st-skip",onClick:je,children:"Skip tour"})]})]})}const E2=3,SD=5;function au(n){return n.toISOString().split("T")[0]}const ED={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},ND={fullbody_4wk:["Push Focus","Pull Focus","Legs & Core"],fullbody_8wk:["Strength","Power","Endurance"],fullbody_12wk:["Upper Push","Lower Body","Upper Pull"],core_4wk:["Abs","Stability","Power Core"],core_8wk:["Anti-Extension","Rotation","Power"],core_12wk:["Strength","Endurance","Power"],upper_4wk:["Push","Pull","Mixed"],lower_4wk:["Quad Dominant","Hamstring & Glute","Power & Stability"]},$p=[{text:"You have 24 hours a day...",bold:"make it count"},{text:"Discipline beats motivation...",bold:"every single time"},{text:"Rest when you're done,",bold:"not when you're tired"},{text:"Small daily gains...",bold:"create massive results"},{text:"Your body keeps score,",bold:"train it well"},{text:"Consistency over intensity...",bold:"always wins"},{text:"The only bad workout...",bold:"is the one you skipped"}];function Wp(n){if(!n)return"";const e=n instanceof Date?n:n.toDate?n.toDate():new Date(n),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function iu(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function CD(n,e=800){return new Promise(t=>{const i=new Image;i.onload=()=>{const l=document.createElement("canvas");let u=i.width,d=i.height;u>d?u>e&&(d=Math.round(d*e/u),u=e):d>e&&(u=Math.round(u*e/d),d=e),l.width=u,l.height=d,l.getContext("2d").drawImage(i,0,0,u,d),l.toBlob(p=>t(p),"image/jpeg",.8)},i.src=URL.createObjectURL(n)})}function RD(){const{currentUser:n,isClient:e,clientData:t,logout:i,updateClientData:l,loading:u}=Lr(),{isDark:d,toggleTheme:p}=Ca(),{isPremium:g,FREE_HABIT_LIMIT:y}=yc(),x=rr(),_=g?SD:y,[j,O]=b.useState({hours:0,minutes:0,seconds:0}),[K,B]=b.useState(0),[D,se]=b.useState(0),[Y,Z]=b.useState(""),[je,Re]=b.useState(0),[ke,C]=b.useState(0),[T,M]=b.useState(!1),[V,I]=b.useState({protein:0,carbs:0,fats:0,calories:0}),[L,A]=b.useState(null),[Oe,ht]=b.useState(0),[H,fe]=b.useState(null),[Ve,$e]=b.useState(!1),[J,P]=b.useState(!1),[re,Fe]=b.useState(0),[qe,Ue]=b.useState(E2),[Ie,mt]=b.useState(!1),[xt,it]=b.useState(!1),[ss,Rs]=b.useState(0),[Ut,jt]=b.useState([]),[ie,Mt]=b.useState([]),[St,Yt]=b.useState(null),[Tt,Et]=b.useState(!1),ot=b.useRef(null),[Pt,Gt]=b.useState([]),[ps,Kt]=b.useState(null),[It,hs]=b.useState(null),ws=b.useRef(null),[is,Xs]=b.useState(0),[Ps,qs]=b.useState(0),[os,_s]=b.useState(0),[ve,De]=b.useState(0),[Pe,st]=b.useState(null),Ge=b.useCallback((E,$="info")=>{st({message:E,type:$}),setTimeout(()=>st(null),4e3)},[]),[nt,gt]=b.useState([]),[X,ne]=b.useState(!1),[Ke,wt]=b.useState(""),[et,_t]=b.useState(null),[Q,Ae]=b.useState(null),[Je,yt]=b.useState(!1),[at,Zt]=b.useState(new Set),[Qt,U]=b.useState(new Set),[be,Ee]=b.useState({}),[Te,Se]=b.useState({}),[bt,Ct]=b.useState({}),[ft,zt]=b.useState({}),[Lt,Bs]=b.useState({}),[hn,rn]=b.useState({}),Tn=b.useRef(null),As=b.useRef(null),sn=b.useRef({}),[ks,W]=b.useState([]),[de,le]=b.useState(!1),we=b.useRef(null),[S,F]=b.useState([]),[ae,te]=b.useState(""),[Ze,ut]=b.useState(!1),[lt,Dt]=b.useState(null),[vt,gs]=b.useState([]),[ln,hr]=b.useState(null),[ys,_r]=b.useState(!1),mr=b.useRef(!1),da=(()=>{const E=[{selector:".cb-ring-container",title:"Your 24-Hour Countdown",body:"Every day resets. This ring tracks the time you have left  tap your photo to personalise your profile.",cta:"Next"},{selector:".cb-stats-row",title:"Progress at a Glance",body:"Programme completion, workouts this week, and daily habits  all in one row. These fill up as you go."},{selector:".cb-nudge-card",title:"Smart Suggestions",body:"We'll highlight what needs your attention  your next session, unfinished habits, or a meal to log."},{selector:".cb-card-workouts-hero",title:"Workouts",body:"Quick randomiser sessions or structured programmes  pick your focus, level and time.",cta:"Next"}];return g&&E.push({selector:".cb-card-nutrition",title:"Nutrition Tracking",body:"Set your macro targets, scan barcodes, and log meals to hit your daily goals."},{selector:".cb-card-consistency",title:"Daily Habits",body:"5 simple habits each day  train, hit protein, 10k steps, sleep, and hydrate. Build your streak."},{selector:".cb-card-buddies",title:"Buddies & Social",body:"Connect with other members, share your journey, and keep each other accountable."},{selector:".cb-journey-section",title:"Share Your Journey",body:"Post photos, updates, and milestones  your fitness journey in one place. Like and comment on each other's posts."},{selector:".cb-achievements-section",title:"Achievements",body:"Every rep counts towards badges  volume milestones, workout streaks, and more to unlock."}),E.push({selector:".block-bottom-nav",title:"You're All Set!",body:"Use the nav bar to jump between your profile, workouts, nutrition, and buddies. Time to get after it.",cta:"Let's Go!"}),E})();b.useEffect(()=>{!u&&!n&&x("/")},[u,n,x]),b.useEffect(()=>{!u&&t&&t.signupSource==="self_signup"&&!t.onboardingComplete&&x("/onboarding")},[u,t,x]),b.useEffect(()=>{let E=t?.tourComplete||mr.current;if(!E&&t?.id)try{E=!!localStorage.getItem(`tourDone_${t.id}`)}catch{}if(T&&t&&!E){const $=setTimeout(()=>_r(!0),600);return()=>clearTimeout($)}},[T,t]),b.useEffect(()=>{if(!(!T||!t?.id)){try{if(localStorage.getItem(`targetHint_${t.id}`))return}catch{}if(!t?.weeklyWorkoutTarget){const E=setTimeout(()=>it(!0),1500);return()=>clearTimeout(E)}}},[T,t]),b.useEffect(()=>{if(t)try{const E=sessionStorage.getItem(`cbDash_${t.id}`);if(E){const $=JSON.parse(E);se($.programmePct??0),Z($.programmeName??""),Re($.totalWorkouts??0),C($.habitWeekPct??0),I($.nutritionTotals??{protein:0,carbs:0,fats:0,calories:0}),A($.nutritionTargetData??null),ht($.todayHabitsCount??0),fe($.nextSession??null),$e($.hasProgramme??!1),P($.programmeComplete??!1),Fe($.weeklyWorkouts??0),Ue($.weeklyWorkoutTarget??E2),Rs($.pbCount??0),jt($.topPBs??[]),Mt($.leaderboardTop3??[]),Gt($.unlockedBadges??[]),ws.current=$.unlockedBadges??[],Xs($.streakWeeks??0),M(!0)}}catch{}},[t]),b.useEffect(()=>{t?.photoURL&&Yt(t.photoURL),t?.weeklyWorkoutTarget&&Ue(t.weeklyWorkoutTarget)},[t]),b.useEffect(()=>{if(!t)return;const E=Ds(qt(ye,"notifications"),bs("toId","==",t.id)),$=Rk(E,ge=>{const Me=ge.docs.map(Qe=>({id:Qe.id,...Qe.data()}));Me.sort((Qe,tt)=>{const Ye=Qe.createdAt?.toMillis?.()||0;return(tt.createdAt?.toMillis?.()||0)-Ye}),W(Me.slice(0,50))},ge=>{console.error("Notification listener error:",ge),ge.code==="permission-denied"&&console.warn("Firestore rules may be missing for the notifications collection. Please update your Firestore rules in the Firebase Console.")});return()=>$()},[t]),b.useEffect(()=>{const E=$=>{we.current&&!we.current.contains($.target)&&le(!1)};return document.addEventListener("mousedown",E),()=>document.removeEventListener("mousedown",E)},[]),b.useEffect(()=>{if(!t)return;const E=t.id;(async()=>{try{const[$,ge,Me]=await Promise.all([Es(Ds(qt(ye,"buddies"),bs("user1","==",E))),Es(Ds(qt(ye,"buddies"),bs("user2","==",E))),Es(qt(ye,"clients"))]),Qe=new Set;[...$.docs,...ge.docs].forEach(Ye=>{const Ft=Ye.data();Qe.add(Ft.user1===E?Ft.user2:Ft.user1)});const tt={};Me.docs.forEach(Ye=>{tt[Ye.id]=Ye.data()}),F(Array.from(Qe).filter(Ye=>tt[Ye]).map(Ye=>({id:Ye,name:tt[Ye].name,photoURL:tt[Ye].photoURL||null})))}catch($){console.error("Error loading buddies for mentions:",$)}})()},[t]);const Sn=ks.filter(E=>!E.read).length,Ra=async()=>{const E=ks.filter(ge=>!ge.read);if(!E.length)return;const $=b2(ye);E.forEach(ge=>$.update(Xe(ye,"notifications",ge.id),{read:!0})),await $.commit()},Aa=async()=>{if(!ks.length)return;const E=b2(ye);ks.forEach($=>E.delete(Xe(ye,"notifications",$.id))),await E.commit()},Qr=async(E,$,ge={})=>{if(!(!t||E===t.id))try{await Kr(qt(ye,"notifications"),{toId:E,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:$,read:!1,createdAt:yr(),...ge})}catch(Me){console.error("Notification create error:",Me),Me.code==="permission-denied"&&Ge("Notifications blocked  check Firestore rules","error")}},Or=(E,$)=>{const ge=$==="compose"?Tn.current?.selectionStart:null,Qe=(ge!=null?E.slice(0,ge):E).match(/@(\w*)$/);if(Qe){ut(!0),Dt($),te(Qe[1].toLowerCase());const tt=S.filter(Ye=>Ye.name&&Ye.name.toLowerCase().includes(Qe[1].toLowerCase())).slice(0,5);gs(tt)}else ut(!1),gs([])},Ja=(E,$)=>{if($==="compose"){const ge=Tn.current,Me=Ke,Qe=ge?.selectionStart??Me.length,tt=Me.slice(0,Qe),Ye=Me.slice(Qe),Ft=tt.replace(/@\w*$/,`@${E.name} `);wt(Ft+Ye),setTimeout(()=>{ge?.focus(),ge.selectionStart=ge.selectionEnd=Ft.length},0)}else{const Me=(Te[$]||"").replace(/@\w*$/,`@${E.name} `);Se(Qe=>({...Qe,[$]:Me}))}ut(!1),gs([])},Br=E=>E&&E.split(/(@\w[\w\s]*?\s)/g).map((ge,Me)=>ge.startsWith("@")&&S.some(Qe=>ge.trim()===`@${Qe.name}`)?r.jsx("span",{className:"mention-highlight",children:ge.trim()},Me):ge),zn=async E=>{const $=E.target.files?.[0];if(!(!$||!t)){if(!$.type.startsWith("image/")){Ge("Please select an image file","error");return}if($.size>5*1024*1024){Ge("Image must be under 5MB","error");return}Et(!0);try{const ge=await new Promise(tt=>{const Ye=new Image;Ye.onload=()=>{const Ft=document.createElement("canvas"),Ht=400;let ms=Ye.width,$t=Ye.height;ms>$t?($t=$t/ms*Ht,ms=Ht):(ms=ms/$t*Ht,$t=Ht),Ft.width=ms,Ft.height=$t,Ft.getContext("2d").drawImage(Ye,0,0,ms,$t),Ft.toBlob(cs=>tt(cs),"image/jpeg",.75)},Ye.src=URL.createObjectURL($)}),Me=bi(vi,`profilePhotos/${t.id}`);await Ah(Me,ge);const Qe=await fo(Me);await la(Xe(ye,"clients",t.id),{photoURL:Qe}),Yt(Qe),l({photoURL:Qe}),Ge("Profile photo updated!","success")}catch(ge){console.error("Photo upload error:",ge),Ge("Failed to upload photo","error")}Et(!1),ot.current&&(ot.current.value="")}};b.useEffect(()=>{const E=()=>{const ge=new Date,Me=new Date(ge);Me.setHours(23,59,59,999);const Qe=Me-ge,tt=Math.floor(Qe/(1e3*60*60)),Ye=Math.floor(Qe%(1e3*60*60)/(1e3*60)),Ft=Math.floor(Qe%(1e3*60)/1e3);O({hours:tt,minutes:Ye,seconds:Ft}),B(60-Ft)};E();const $=setInterval(E,1e3);return()=>clearInterval($)},[]),b.useEffect(()=>{const E=setInterval(()=>{De($=>($+1)%$p.length)},8e3);return()=>clearInterval(E)},[]),b.useEffect(()=>{if(!n||!t)return;(async()=>{let $=null,ge=0,Me=[],Qe=!1,tt=null;try{const Ye=au(new Date),Ft=await Ls(Xe(ye,"clientProgrammes",t.id));if(Ft.exists()){const fn=Ft.data(),Bn=ED[fn.templateId];if($e(!0),Bn){const Er=fn.completedSessions||{},Nr=Object.keys(Er).length,So=Bn.duration*Bn.daysPerWeek;se(So>0?Math.round(Nr/So*100):0);const Ia=fn.templateId.replace(/_/g," ").replace(/\b\w/g,ha=>ha.toUpperCase());Z(Ia);const Qn=ND[fn.templateId];let ei=!1;for(let ha=1;ha<=Bn.duration&&!ei;ha++)for(let ar=0;ar<Bn.daysPerWeek&&!ei;ar++)Er[`w${ha}d${ar}`]||(fe({week:ha,dayIdx:ar,label:Qn?.[ar]||`Day ${ar+1}`}),ei=!0);ei||(P(!0),Qe=!0)}}const Ht=qt(ye,"workoutLogs"),ms=Ds(Ht,bs("clientId","==",t.id));$=await Es(ms),Re($.docs.length);const $t=new Date,cs=$t.getDay(),Ln=cs===0?6:cs-1,Gn=new Date($t);Gn.setDate($t.getDate()-Ln),Gn.setHours(0,0,0,0);const Js=Gn.getTime(),Zs=$.docs.filter(fn=>{const Bn=fn.data().completedAt;return Bn?(Bn.toDate?Bn.toDate().getTime():new Date(Bn).getTime())>=Js:!1}).length;Fe(Zs);const On=qt(ye,"habitLogs"),Hn=Ds(On,bs("clientId","==",t.id),bs("date","==",Ye)),Kn=await Es(Hn);let Yn=0;if(!Kn.empty){const fn=Kn.docs[0].data().habits||{};Yn=Math.min(Object.values(fn).filter(Boolean).length,_)}C(Math.round(Yn/_*100)),ht(Yn);const Sr=await Ls(Xe(ye,"nutritionTargets",t.id));Sr.exists()&&(A(Sr.data()),tt=Sr.data());const fr=await Ls(Xe(ye,"nutritionLogs",`${t.id}_${Ye}`));if(fr.exists()){const Bn=(fr.data().entries||[]).reduce((Er,Nr)=>({protein:Er.protein+(Nr.protein||0),carbs:Er.carbs+(Nr.carbs||0),fats:Er.fats+(Nr.fats||0),calories:Er.calories+(Nr.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});I(Bn)}}catch(Ye){console.error("Error loading dashboard stats:",Ye)}try{let Ye=[];const Ft=await Ls(Xe(ye,"coreBuddyPBs",t.id));if(Ft.exists()){const Ht=Ft.data().exercises||{};Rs(Object.keys(Ht).length),ge=Object.keys(Ht).length,Ye=Object.entries(Ht).sort(([,ms],[,$t])=>($t.weight||0)-(ms.weight||0)).slice(0,3).map(([ms,$t])=>({name:ms,weight:$t.weight,reps:$t.reps}))}Me=Ye,jt(Ye)}catch(Ye){console.error("PB fetch error:",Ye)}try{const Ye=qt(ye,"clients"),Ft=Ds(Ye,bs("leaderboardOptIn","==",!0)),ms=(await Es(Ft)).docs.map($t=>({id:$t.id,name:$t.data().name,photoURL:$t.data().photoURL||null}));Mt(ms.slice(0,3))}catch(Ye){console.error("Leaderboard preview error:",Ye)}try{let Ye=0;if($){const Js=$.docs.map(Zs=>Zs.data().date).filter(Boolean).sort().reverse();if(Js.length>0){const Zs=new Date;let On=new Date(Zs);e:for(let Hn=0;Hn<52;Hn++){const Kn=new Date(On),Yn=Kn.getDay(),Sr=Yn===0?6:Yn-1;Kn.setDate(Kn.getDate()-Sr),Kn.setHours(0,0,0,0);const fr=new Date(Kn);fr.setDate(fr.getDate()+7);const fn=au(Kn),Bn=au(fr);if(Js.some(Nr=>Nr>=fn&&Nr<Bn))Ye++;else{if(Hn>0)break e;break}On.setDate(On.getDate()-7)}}}Xs(Ye);let Ft=0;for(let Js=0;Js<30;Js++){const Zs=new Date;Zs.setDate(Zs.getDate()-Js);const On=au(Zs);try{const Hn=await Es(Ds(qt(ye,"habitLogs"),bs("clientId","==",t.id),bs("date","==",On)));if(Hn.empty)break;{const Kn=Hn.docs[0].data().habits||{};if(Object.values(Kn).filter(Boolean).length>=_)Ft++;else break}}catch{break}}qs(Ft);let Ht=0;for(let Js=0;Js<30;Js++){const Zs=new Date;Zs.setDate(Zs.getDate()-Js);const On=au(Zs);try{const Hn=await Ls(Xe(ye,"nutritionLogs",`${t.id}_${On}`));if(Hn.exists()&&(Hn.data().entries||[]).length>0)if(tt){const Yn=(Hn.data().entries||[]).reduce((Sr,fr)=>({protein:Sr.protein+(fr.protein||0),carbs:Sr.carbs+(fr.carbs||0),fats:Sr.fats+(fr.fats||0)}),{protein:0,carbs:0,fats:0});if(Yn.protein>=(tt.protein||0)&&Yn.carbs>=(tt.carbs||0)&&Yn.fats>=(tt.fats||0))Ht++;else break}else Ht++;else break}catch{break}}_s(Ht);const ms=$?$.docs.length:0,$t=[],cs=Js=>$t.push(Js);ms>=1&&cs("first_workout"),ms>=10&&cs("workouts_10"),ms>=25&&cs("workouts_25"),ms>=50&&cs("workouts_50"),ms>=100&&cs("workouts_100"),Ye>=2&&cs("streak_2"),Ye>=4&&cs("streak_4"),Ye>=8&&cs("streak_8"),ge>=1&&cs("first_pb"),ge>=5&&cs("pbs_5"),ge>=10&&cs("pbs_10"),ge>=100&&cs("pbs_100"),Ht>=7&&cs("nutrition_7"),t.leaderboardOptIn&&cs("leaderboard_join"),Ft>=7&&cs("habits_7"),Gt($t);const Ln=ws.current;if(Ln!==null){const Js=$t.filter(Zs=>!Ln.includes(Zs));if(Js.length>0){const Zs=Un.find(On=>On.id===Js[Js.length-1]);Zs&&setTimeout(()=>hs(Zs),600)}}ws.current=$t;const Gn={};$t.forEach(Js=>{Gn[Js]={unlockedAt:new Date().toISOString()}}),Os(Xe(ye,"achievements",t.id),{badges:Gn,progress:{streakWeeks:Ye,pbCount:ge,nutritionStreak:Ht,habitStreak:Ft},updatedAt:new Date().toISOString()},{merge:!0}).catch(()=>{})}catch(Ye){console.error("Achievement computation error:",Ye)}M(!0)})()},[n,t,_]),b.useEffect(()=>{if(!(!T||!t))try{sessionStorage.setItem(`cbDash_${t.id}`,JSON.stringify({programmePct:D,programmeName:Y,totalWorkouts:je,habitWeekPct:ke,nutritionTotals:V,nutritionTargetData:L,todayHabitsCount:Oe,nextSession:H,hasProgramme:Ve,programmeComplete:J,weeklyWorkouts:re,weeklyWorkoutTarget:qe,pbCount:ss,topPBs:Ut,leaderboardTop3:ie,unlockedBadges:Pt,streakWeeks:is}))}catch{}},[T,D,Y,je,ke,V,L,Oe,H,Ve,J,re,qe,ss,Ut,ie,Pt,is,t]);const Ai=b.useCallback(async()=>{if(mr.current=!0,_r(!1),l({tourComplete:!0}),t?.id){try{localStorage.setItem(`tourDone_${t.id}`,"1")}catch{}try{await la(Xe(ye,"clients",t.id),{tourComplete:!0})}catch(E){console.error("Failed to save tour completion:",E)}}},[t,l]),Za=b.useCallback(async E=>{if(Ue(E),mt(!1),it(!1),t?.id){try{localStorage.setItem(`targetHint_${t.id}`,"1")}catch{}try{await la(Xe(ye,"clients",t.id),{weeklyWorkoutTarget:E})}catch($){console.error("Failed to save weekly target:",$)}}},[t]),kr=E=>{const $=E.currentTarget,ge=$.querySelector(".ripple");ge&&ge.remove();const Me=$.getBoundingClientRect(),Qe=Math.max(Me.width,Me.height),tt=E.clientX-Me.left-Qe/2,Ye=E.clientY-Me.top-Qe/2,Ft=document.createElement("span");Ft.className="ripple",Ft.style.cssText=`width:${Qe}px;height:${Qe}px;left:${tt}px;top:${Ye}px;`,$.appendChild(Ft),setTimeout(()=>Ft.remove(),600)},Ma=t?.name?.split(" ")[0]||"there",Mi=Math.min(Math.round(re/qe*100),100),jr=[{label:"Programme",value:`${D}%`,pct:D,color:"var(--color-primary)",size:"normal"},{label:"Workouts",value:`${re}/${qe}`,pct:Mi,color:"var(--color-primary)",size:"large",editable:!0},{label:"Habits Today",value:`${ke}%`,pct:ke,color:"var(--color-primary)",size:"normal"}],Tr=E=>!L||!L[E]?0:Math.min(Math.round(V[E]/L[E]*100),100),Dn=(()=>{const E=new Date().getHours();return T&&Oe>=_&&V.calories>0?{main:"Smashed it today,",sub:"Rest up and go again tomorrow."}:E>=5&&E<12?{main:"Rise and grind,",sub:"let's get after it!"}:E>=12&&E<17?{main:"Oye",sub:"crack on and make it count!"}:E>=17&&E<21?{main:"Evening session?",sub:"Let's finish strong!"}:{main:"Burning the midnight oil,",sub:"Respect the hustle!"}})(),qn=T?g&&Ve&&H&&!J?{label:"NEXT SESSION",message:`Week ${H.week}, Day ${H.dayIdx+1}  ${H.label}`,cta:"Continue",action:()=>x("/client/core-buddy/programmes"),pct:D,ringLabel:`${D}%`}:Oe<_?{label:"DAILY HABITS",message:`${Oe}/${_} completed`,cta:"Open Habits",action:()=>x("/client/core-buddy/consistency"),pct:ke,ringLabel:`${Oe}/${_}`}:g&&V.calories===0?{label:"NUTRITION",message:"No meals logged today",cta:"Log Meal",action:()=>x("/client/core-buddy/nutrition"),pct:0,ringLabel:"0"}:g&&!Ve?{label:"PROGRAMMES",message:"Start a programme to level up",cta:"Browse",action:()=>x("/client/core-buddy/workouts"),pct:0,ringLabel:""}:g&&J?{label:"COMPLETE",message:"Programme finished!",cta:"New Programme",action:()=>x("/client/core-buddy/workouts"),pct:100,ringLabel:"100%"}:{label:"TODAY",message:"You're crushing it!",cta:null,action:null,pct:100,ringLabel:""}:null,Pn=b.useCallback(async()=>{if(t){ne(!0);try{const E=await Es(Ds(qt(ye,"posts"),bs("authorId","==",t.id),oc("createdAt","desc"),Pu(30)));gt(E.docs.map(ge=>({id:ge.id,...ge.data()})));const $=await Es(Ds(qt(ye,"postLikes"),bs("userId","==",t.id)));Zt(new Set($.docs.map(ge=>ge.data().postId)))}catch(E){console.error("Error loading journey:",E)}finally{ne(!1)}}},[t]);b.useEffect(()=>{T&&t&&Pn()},[T,t,Pn]);const Xr=E=>{const $=E.target.files?.[0];if($){if(!$.type.startsWith("image/")){Ge("Please select an image file","error");return}if($.size>10*1024*1024){Ge("Image must be under 10MB","error");return}_t($),Ae(URL.createObjectURL($))}},xn=()=>{_t(null),Q&&URL.revokeObjectURL(Q),Ae(null),As.current&&(As.current.value="")},z=async()=>{if(!(!Ke.trim()&&!et||Je||!t)){yt(!0);try{let E=null;if(et){const Me=await CD(et),Qe=`${Date.now()}_${Math.random().toString(36).slice(2,8)}`,tt=bi(vi,`postImages/${t.id}/${Qe}`);await Ah(tt,Me),E=await fo(tt)}await Kr(qt(ye,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Ke.trim(),type:E?"image":"text",imageURL:E||null,createdAt:yr(),likeCount:0,commentCount:0});const ge=Ke.trim().match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(ge){const Me=new Set;ge.forEach(Qe=>{const tt=Qe.slice(1).trim(),Ye=S.find(Ft=>Ft.name&&Ft.name.toLowerCase()===tt.toLowerCase());Ye&&!Me.has(Ye.id)&&(Me.add(Ye.id),Qr(Ye.id,"mention",{}))})}wt(""),xn(),Tn.current&&(Tn.current.style.height="auto"),await Pn(),Ge("Posted!","success")}catch(E){console.error("Error posting:",E),Ge(E?.message||"Failed to post","error")}finally{yt(!1)}}},pe=async E=>{if(window.confirm("Delete this post?"))try{await ur(Xe(ye,"posts",E)),gt($=>$.filter(ge=>ge.id!==E)),Ge("Post deleted","info")}catch($){console.error("Delete error:",$),Ge("Failed to delete","error")}},he=async E=>{if(!t)return;const $=t.id,ge=`${E}_${$}`,Me=at.has(E),Qe=new Set(at);Me?Qe.delete(E):Qe.add(E),Zt(Qe),gt(tt=>tt.map(Ye=>Ye.id===E?{...Ye,likeCount:Math.max(0,(Ye.likeCount||0)+(Me?-1:1))}:Ye));try{if(Me)await ur(Xe(ye,"postLikes",ge)),await la(Xe(ye,"posts",E),{likeCount:Yo(-1)});else{await Os(Xe(ye,"postLikes",ge),{postId:E,userId:$,createdAt:yr()}),await la(Xe(ye,"posts",E),{likeCount:Yo(1)});const tt=nt.find(Ye=>Ye.id===E);tt&&Qr(tt.authorId,"like",{postId:E})}}catch(tt){console.error("Like error:",tt),Pn()}},Ce=async E=>{try{const $=await Es(Ds(qt(ye,"postComments"),bs("postId","==",E),oc("createdAt","asc"),Pu(50)));Ee(ge=>({...ge,[E]:$.docs.map(Me=>({id:Me.id,...Me.data()}))}))}catch($){console.error("Error loading comments:",$)}},We=E=>{const $=new Set(Qt);$.has(E)?$.delete(E):($.add(E),be[E]||Ce(E)),U($)},rt=async E=>{const $=(Te[E]||"").trim(),ge=Lt[E];if(!(!$&&!ge||!t)){Ct(Me=>({...Me,[E]:!0}));try{let Me=null;if(ge){const Ht=bi(vi,`comment-images/${Date.now()}_${ge.name}`);await Ah(Ht,ge),Me=await fo(Ht)}const Qe={postId:E,authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:$||"",createdAt:yr()};Me&&(Qe.imageURL=Me);const tt=ft[E];tt&&(Qe.replyToId=tt.id,Qe.replyToName=tt.authorName),await Kr(qt(ye,"postComments"),Qe),await la(Xe(ye,"posts",E),{commentCount:Yo(1)});const Ye=nt.find(Ht=>Ht.id===E);Ye&&Qr(Ye.authorId,"comment",{postId:E});const Ft=$.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Ft){const Ht=new Set;Ft.forEach(ms=>{const $t=ms.slice(1).trim(),cs=S.find(Ln=>Ln.name&&Ln.name.toLowerCase()===$t.toLowerCase());cs&&!Ht.has(cs.id)&&(Ht.add(cs.id),Qr(cs.id,"mention",{postId:E}))})}Se(Ht=>({...Ht,[E]:""})),Bs(Ht=>({...Ht,[E]:null})),rn(Ht=>({...Ht,[E]:null})),zt(Ht=>({...Ht,[E]:null})),sn.current[E]&&(sn.current[E].value=""),gt(Ht=>Ht.map(ms=>ms.id===E?{...ms,commentCount:(ms.commentCount||0)+1}:ms)),await Ce(E)}catch(Me){console.error("Comment error:",Me),Ge("Failed to comment","error")}finally{Ct(Me=>({...Me,[E]:!1}))}}},dt=async(E,$)=>{try{await ur(Xe(ye,"postComments",$)),await la(Xe(ye,"posts",E),{commentCount:Yo(-1)}),Ee(ge=>({...ge,[E]:(ge[E]||[]).filter(Me=>Me.id!==$)})),gt(ge=>ge.map(Me=>Me.id===E?{...Me,commentCount:Math.max((Me.commentCount||1)-1,0)}:Me))}catch(ge){console.error("Delete comment error:",ge),Ge("Failed to delete comment","error")}},Ot=(E,$)=>{const ge=$.target.files?.[0];if(!ge)return;if(ge.size>5*1024*1024){Ge("Image must be under 5MB","error");return}Bs(Qe=>({...Qe,[E]:ge}));const Me=new FileReader;Me.onload=Qe=>rn(tt=>({...tt,[E]:Qe.target.result})),Me.readAsDataURL(ge)},es=E=>{Bs($=>({...$,[E]:null})),rn($=>({...$,[E]:null})),sn.current[E]&&(sn.current[E].value="")},ls=E=>{wt(E.target.value),E.target.style.height="auto",E.target.style.height=Math.min(E.target.scrollHeight,120)+"px",Or(E.target.value,"compose")},ts=(E,$)=>{Se(ge=>({...ge,[E]:$})),Or($,E)};return r.jsx(Sa,{children:r.jsxs("div",{className:"cb-dashboard","data-theme":d?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsxs("div",{className:"header-notif-wrap",ref:we,children:[r.jsxs("button",{className:"header-notif-btn",onClick:()=>{le(!de),de||Ra()},"aria-label":"Notifications",children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),r.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),Sn>0&&r.jsx("span",{className:"header-notif-badge",children:Sn>9?"9+":Sn})]}),de&&r.jsxs("div",{className:"notif-panel",children:[r.jsxs("div",{className:"notif-panel-header",children:[r.jsx("span",{className:"notif-panel-title",children:"Notifications"}),ks.length>0&&r.jsx("button",{className:"notif-clear-btn",onClick:Aa,children:"Clear all"})]}),r.jsx("div",{className:"notif-panel-list",children:ks.length===0?r.jsx("div",{className:"notif-empty",children:"No notifications yet"}):ks.map(E=>r.jsxs("div",{className:`notif-item${E.read?"":" unread"}`,onClick:()=>{if(le(!1),E.type==="buddy_request"||E.type==="buddy_accept")x(g?"/client/core-buddy/buddies":"/upgrade");else if((E.type==="like"||E.type==="comment")&&E.postId){if(!Qt.has(E.postId)){const $=new Set(Qt);$.add(E.postId),U($),be[E.postId]||Ce(E.postId)}setTimeout(()=>{const $=document.getElementById(`post-${E.postId}`);$&&$.scrollIntoView({behavior:"smooth",block:"center"})},150)}else E.type==="like"||E.type==="comment"?document.querySelector(".cb-journey-section")?.scrollIntoView({behavior:"smooth"}):E.type==="mention"&&x(`/client/core-buddy/profile/${E.fromId}`)},children:[r.jsx("div",{className:"notif-item-avatar",children:E.fromPhotoURL?r.jsx("img",{src:E.fromPhotoURL,alt:""}):r.jsx("span",{children:(E.fromName||"?")[0]})}),r.jsxs("div",{className:"notif-item-body",children:[r.jsxs("p",{className:"notif-item-text",children:[r.jsx("strong",{children:E.fromName})," ",E.type==="buddy_request"&&"sent you a buddy request",E.type==="buddy_accept"&&"accepted your buddy request",E.type==="like"&&"liked your post",E.type==="comment"&&"commented on your post",E.type==="mention"&&"mentioned you"]}),r.jsx("span",{className:"notif-item-time",children:Wp(E.createdAt)})]})]},E.id))})]})]}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsxs("div",{className:"header-actions",children:[r.jsx("button",{onClick:p,"aria-label":"Toggle theme",children:d?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})}),r.jsx("button",{onClick:i,"aria-label":"Log out",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),r.jsx("polyline",{points:"16 17 21 12 16 7"}),r.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),r.jsxs("main",{className:"cb-main",children:[r.jsxs("div",{className:"cb-ring-container",children:[r.jsxs("div",{className:"cb-ring",children:[r.jsx("svg",{className:"cb-ring-svg",viewBox:"0 0 200 200",children:Sm.map((E,$)=>{const ge=$<K;return r.jsx("line",{x1:E.x1,y1:E.y1,x2:E.x2,y2:E.y2,className:`ring-tick ${ge?"elapsed":"remaining"}`,strokeWidth:E.thick?"3":"2"},$)})}),r.jsxs("div",{className:"cb-ring-center",children:[r.jsxs("div",{className:"cb-ring-logo",onClick:()=>ot.current?.click(),role:"button",tabIndex:0,"aria-label":"Change profile photo",children:[r.jsx("img",{src:St||"/Logo.webp",alt:St?"Profile":"Mind Core Fitness"}),r.jsx("div",{className:`cb-photo-overlay${Tt?" uploading":""}`,children:Tt?r.jsx("div",{className:"cb-photo-spinner"}):r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[r.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),r.jsx("input",{ref:ot,type:"file",accept:"image/*",onChange:zn,style:{display:"none"}})]}),!St&&!Tt&&r.jsx("div",{className:"cb-photo-badge",onClick:()=>ot.current?.click(),children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[r.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),r.jsxs("div",{className:"cb-ring-countdown",children:[r.jsx("span",{className:"cb-timer-digit",children:String(j.hours).padStart(2,"0")}),r.jsx("span",{className:"cb-timer-colon",children:":"}),r.jsx("span",{className:"cb-timer-digit",children:String(j.minutes).padStart(2,"0")}),r.jsx("span",{className:"cb-timer-colon",children:":"}),r.jsx("span",{className:"cb-timer-digit cb-timer-seconds",children:String(j.seconds).padStart(2,"0")})]}),r.jsx("span",{className:"cb-ring-label",children:"remaining today"}),r.jsxs("p",{className:"cb-ring-tagline",children:[$p[ve].text," ",r.jsx("strong",{children:$p[ve].bold})]},ve)]}),r.jsx("div",{className:"cb-stats-row",children:jr.map(E=>{const $=(E.size==="large",38),ge=2*Math.PI*$,Me=ge-E.pct/100*ge,Qe=E.editable;return r.jsxs("div",{className:`cb-stat-item${E.size==="large"?" cb-stat-large":""}`,children:[r.jsxs("div",{className:`cb-stat-ring${Qe?" cb-stat-tappable":""}${Qe&&xt?" cb-stat-hint":""}`,onClick:Qe?()=>{mt(!0),it(!1)}:void 0,children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-stat-track",cx:"50",cy:"50",r:$}),r.jsx("circle",{className:"cb-stat-fill",cx:"50",cy:"50",r:$,style:{stroke:E.color},strokeDasharray:ge,strokeDashoffset:Me})]}),r.jsx("span",{className:"cb-stat-value",style:{color:E.color},children:E.value})]}),r.jsx("span",{className:"cb-stat-label",children:E.label})]},E.label)})}),Ie&&r.jsx("div",{className:"cb-target-overlay",onClick:()=>mt(!1),children:r.jsxs("div",{className:"cb-target-picker",onClick:E=>E.stopPropagation(),children:[r.jsx("h4",{children:"Weekly workout goal"}),r.jsx("p",{children:"How many sessions per week?"}),r.jsx("div",{className:"cb-target-options",children:[1,2,3,4,5,6,7].map(E=>r.jsx("button",{className:`cb-target-option${E===qe?" active":""}`,onClick:()=>Za(E),children:E},E))})]})}),r.jsxs("p",{className:"cb-coach-msg",children:[Dn.main," ",r.jsx("strong",{children:Ma}),"  ",Dn.sub]}),qn&&r.jsxs("button",{className:"cb-nudge-card",onClick:qn.action||void 0,style:qn.action?void 0:{cursor:"default"},children:[r.jsxs("div",{className:"cb-nudge-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-nudge-ring-track",cx:"50",cy:"50",r:"38"}),r.jsx("circle",{className:"cb-nudge-ring-fill",cx:"50",cy:"50",r:"38",strokeDasharray:2*Math.PI*38,strokeDashoffset:2*Math.PI*38-qn.pct/100*2*Math.PI*38})]}),r.jsx("span",{className:"cb-nudge-ring-val",children:qn.ringLabel})]}),r.jsxs("div",{className:"cb-nudge-info",children:[r.jsx("span",{className:"cb-nudge-label",children:qn.label}),r.jsx("span",{className:"cb-nudge-title",children:qn.message}),qn.cta&&r.jsxs("span",{className:"cb-nudge-cta",children:[qn.cta," "]})]})]}),r.jsxs("div",{className:"cb-features",children:[g&&r.jsxs("button",{className:"cb-feature-card cb-card-nutrition cb-card-has-preview ripple-btn",onClick:E=>{kr(E),x("/client/core-buddy/nutrition")},children:[r.jsxs("div",{className:"cb-card-top-row",children:[r.jsx("div",{className:"cb-card-content",children:r.jsx("h3",{children:"Today's Nutrition"})}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsx("div",{className:"cb-card-preview-row",children:r.jsx("div",{className:"cb-mini-rings",children:[{label:"P",pct:Tr("protein"),color:"var(--color-primary)"},{label:"C",pct:Tr("carbs"),color:"var(--color-primary)"},{label:"F",pct:Tr("fats"),color:"var(--color-primary)"},{label:"Cal",pct:Tr("calories"),color:"var(--color-primary)"}].map(E=>{const ge=2*Math.PI*38,Me=ge-E.pct/100*ge;return r.jsxs("div",{className:"cb-mini-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-mini-track",cx:"50",cy:"50",r:38}),r.jsx("circle",{className:"cb-mini-fill",cx:"50",cy:"50",r:38,style:{stroke:E.color},strokeDasharray:ge,strokeDashoffset:Me})]}),r.jsx("span",{style:{color:E.color},children:E.label})]},E.label)})})}),r.jsx("p",{className:"cb-card-desc",children:"Track macros, scan barcodes, log water"})]}),r.jsxs("button",{className:"cb-feature-card cb-card-workouts-hero ripple-btn",onClick:E=>{kr(E),x("/client/core-buddy/workouts")},children:[r.jsx("h3",{className:"cb-hero-title",children:"Workouts"}),r.jsxs("div",{className:"cb-hero-stats",children:[r.jsxs("span",{children:[re," this week"]}),r.jsx("span",{className:"cb-hero-dot",children:""}),r.jsxs("span",{children:[je," total"]})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("div",{className:`cb-grid-row${g?"":" cb-grid-single"}`,children:[r.jsxs("button",{className:"cb-feature-card cb-grid-card cb-card-consistency ripple-btn",onClick:E=>{kr(E),x("/client/core-buddy/consistency")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsx("h3",{children:"Habits"}),r.jsx("div",{className:"cb-habit-dots",children:Array.from({length:_},(E,$)=>r.jsx("span",{className:`cb-habit-dot${$<Oe?" done":""}`},$))}),r.jsxs("span",{className:"cb-habit-dots-label",children:[Oe,"/",_," today"]})]}),r.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),g&&r.jsxs("button",{className:"cb-feature-card cb-grid-card cb-card-progress ripple-btn",onClick:E=>{kr(E),x("/client/personal-bests?mode=corebuddy")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsx("h3",{children:"PBs"}),Ut.length>0?r.jsx("div",{className:"cb-pb-preview",children:Ut.slice(0,2).map(E=>r.jsxs("div",{className:"cb-pb-entry",children:[r.jsx("span",{className:"cb-pb-name",children:E.name}),r.jsxs("span",{className:"cb-pb-value",children:[E.weight,"kg"]})]},E.name))}):r.jsxs("div",{className:"cb-progress-preview",children:[r.jsx("svg",{className:"cb-progress-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),r.jsx("span",{children:"Start lifting!"})]})]}),r.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]})]}),r.jsxs("button",{className:"cb-feature-card cb-card-leaderboard ripple-btn",onClick:E=>{kr(E),x("/client/leaderboard")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsx("h3",{children:"Leaderboard"}),ie.length>0?r.jsx("div",{className:"cb-lb-preview",children:ie.map((E,$)=>{const ge=["#FFD700","#A8B4C0","#CD7F32"][$],Me=E.name?E.name.split(" ").map(tt=>tt[0]).join("").slice(0,2).toUpperCase():"?",Qe=E.id===t?.id;return r.jsxs("div",{className:`cb-lb-entry${Qe?" cb-lb-me":""}`,children:[r.jsx("div",{className:"cb-lb-avatar",style:{borderColor:ge},children:E.photoURL?r.jsx("img",{src:E.photoURL,alt:"",className:"cb-lb-avatar-img"}):r.jsx("span",{children:Me})}),r.jsxs("span",{className:"cb-lb-rank",style:{color:ge},children:["#",$+1]})]},E.id)})}):r.jsx("p",{children:"Opt in to compete with your Core Buddies"})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),g&&r.jsxs("button",{className:"cb-feature-card cb-card-buddies ripple-btn",onClick:E=>{kr(E),x("/client/core-buddy/buddies")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsx("h3",{children:"Buddies"}),r.jsx("p",{children:"Connect with other members and track each other's progress"})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),g&&r.jsxs("div",{className:"cb-achievements-section",children:[r.jsx("h3",{className:"cb-achievements-title",children:"Achievements"}),r.jsx("div",{className:"cb-badges-scroll",children:Un.map(E=>{const $=Pt.includes(E.id);return r.jsx("button",{className:`cb-badge${$?" unlocked":" locked"}`,onClick:()=>Kt(E),children:r.jsx("img",{src:E.img,alt:E.name,className:"cb-badge-img"})},E.id)})}),r.jsxs("p",{className:"cb-badges-count",children:[Pt.length,"/",Un.length," unlocked"]})]}),g&&r.jsxs("div",{className:"cb-journey-section",children:[r.jsx("h3",{className:"cb-journey-title",children:"My Journey"}),r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"journey-compose",children:[r.jsx("div",{className:"journey-compose-avatar",children:St?r.jsx("img",{src:St,alt:""}):r.jsx("span",{children:iu(t?.name)})}),r.jsxs("div",{className:"journey-compose-body",style:{position:"relative"},children:[r.jsx("textarea",{ref:Tn,placeholder:"Share your progress... (use @ to mention)",value:Ke,onChange:ls,rows:1,maxLength:500}),Ze&&lt==="compose"&&vt.length>0&&r.jsx("div",{className:"mention-dropdown",children:vt.map(E=>r.jsxs("button",{className:"mention-option",onClick:()=>Ja(E,"compose"),children:[r.jsx("div",{className:"mention-option-avatar",children:E.photoURL?r.jsx("img",{src:E.photoURL,alt:""}):r.jsx("span",{children:iu(E.name)})}),r.jsx("span",{children:E.name})]},E.id))}),Q&&r.jsxs("div",{className:"journey-image-preview",children:[r.jsx("img",{src:Q,alt:"Preview"}),r.jsx("button",{className:"journey-image-remove",onClick:xn,"aria-label":"Remove image",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),r.jsxs("div",{className:"journey-compose-actions",children:[r.jsx("button",{className:"journey-image-btn",onClick:()=>As.current?.click(),"aria-label":"Add image",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),r.jsx("input",{ref:As,type:"file",accept:"image/*",onChange:Xr,hidden:!0}),(Ke.trim()||et)&&r.jsx("button",{className:"journey-post-btn",onClick:z,disabled:Je,children:Je?r.jsx("div",{className:"journey-btn-spinner"}):"Post"})]})]})]}),X?r.jsx("div",{className:"journey-loading",children:r.jsx("div",{className:"cb-spinner"})}):nt.length===0?r.jsxs("div",{className:"journey-empty",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]}),r.jsx("p",{children:"Start sharing your fitness journey!"})]}):r.jsx("div",{className:"journey-list",children:nt.map(E=>r.jsxs("div",{id:`post-${E.id}`,className:"journey-post",children:[r.jsxs("div",{className:"journey-post-header",children:[r.jsx("div",{className:"journey-post-avatar",children:E.authorPhotoURL?r.jsx("img",{src:E.authorPhotoURL,alt:""}):r.jsx("span",{children:iu(E.authorName)})}),r.jsxs("div",{className:"journey-post-meta",children:[r.jsx("span",{className:"journey-post-name",children:E.authorName}),r.jsx("span",{className:"journey-post-time",children:Wp(E.createdAt)})]}),r.jsx("button",{className:"journey-delete-btn",onClick:()=>pe(E.id),"aria-label":"Delete post",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),E.type==="workout_summary"&&E.metadata?r.jsxs("div",{className:"journey-card",children:[r.jsx("div",{className:"journey-card-logo-frame",children:r.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),r.jsx("h3",{className:"journey-card-title",children:E.metadata.title}),E.metadata.stats?.length>0&&r.jsx("p",{className:"journey-card-stats-line",children:E.metadata.stats.map($=>`${$.value} ${$.label}`).join("    ")}),!E.metadata.stats?.length&&E.metadata.subtitle&&r.jsx("p",{className:"journey-card-stats-line",children:E.metadata.subtitle}),r.jsx("p",{className:"journey-card-cta",children:"I just completed a workout using Core Buddy "}),r.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):E.type==="badge_earned"&&E.metadata?r.jsxs("div",{className:"journey-card",children:[r.jsx("div",{className:"journey-card-logo-frame journey-card-logo-badge",children:r.jsx("img",{src:(Un.find($=>$.name===E.metadata.title)||Un.find($=>E.metadata.badges?.includes($.name)))?.img||"/Logo.webp",alt:E.metadata.title,className:"journey-card-logo-img"})}),r.jsx("h3",{className:"journey-card-title",children:E.metadata.title}),(E.metadata.badgeDesc||(Un.find($=>$.name===E.metadata.title)||Un.find($=>E.metadata.badges?.includes($.name)))?.desc)&&r.jsx("p",{className:"journey-card-stats-line",children:E.metadata.badgeDesc||(Un.find($=>$.name===E.metadata.title)||Un.find($=>E.metadata.badges?.includes($.name)))?.desc}),r.jsx("p",{className:"journey-card-cta",children:"I just earned a badge on Core Buddy "}),r.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):E.type==="habits_summary"&&E.metadata?r.jsxs("div",{className:"journey-card",children:[r.jsx("div",{className:"journey-card-logo-frame",children:r.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),r.jsx("h3",{className:"journey-card-title",children:E.metadata.title}),E.metadata.stats?.length>0&&r.jsx("p",{className:"journey-card-stats-line",children:E.metadata.stats.map($=>`${$.value} ${$.label}`).join("    ")}),E.metadata.subtitle&&r.jsx("p",{className:"journey-card-stats-line",children:E.metadata.subtitle}),r.jsx("p",{className:"journey-card-cta",children:"I just completed my daily habits with Core Buddy "}),r.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):r.jsxs(r.Fragment,{children:[E.content&&r.jsx("p",{className:"journey-post-content",children:Br(E.content)}),E.imageURL&&r.jsx("div",{className:"journey-post-image",children:r.jsx("img",{src:E.imageURL,alt:"Post",loading:"lazy"})})]}),r.jsxs("div",{className:"journey-post-actions",children:[r.jsxs("button",{className:`journey-action-btn${at.has(E.id)?" liked":""}`,onClick:()=>he(E.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:at.has(E.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),r.jsx("span",{children:E.likeCount||0})]}),r.jsxs("button",{className:`journey-action-btn${Qt.has(E.id)?" active":""}`,onClick:()=>We(E.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),r.jsx("span",{children:E.commentCount||0})]})]}),Qt.has(E.id)&&r.jsxs("div",{className:"journey-comments",children:[be[E.id]?.length>0?be[E.id].map($=>r.jsxs("div",{className:"journey-comment",children:[r.jsx("div",{className:"journey-comment-avatar",children:$.authorPhotoURL?r.jsx("img",{src:$.authorPhotoURL,alt:""}):r.jsx("span",{children:iu($.authorName)})}),r.jsxs("div",{className:"journey-comment-body",children:[r.jsxs("div",{className:"journey-comment-bubble",children:[r.jsx("span",{className:"journey-comment-name",children:$.authorName}),$.replyToName&&r.jsxs("span",{className:"journey-comment-reply-tag",children:[r.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("polyline",{points:"9 14 4 9 9 4"}),r.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),$.replyToName]}),$.content&&r.jsx("span",{className:"journey-comment-text",children:Br($.content)}),$.imageURL&&r.jsx("img",{className:"journey-comment-image",src:$.imageURL,alt:"Comment",loading:"lazy"})]}),r.jsxs("div",{className:"journey-comment-actions-row",children:[r.jsx("span",{className:"journey-comment-time",children:Wp($.createdAt)}),r.jsx("button",{className:"journey-comment-reply-btn",onClick:()=>zt(ge=>({...ge,[E.id]:{id:$.id,authorName:$.authorName}})),children:"Reply"}),r.jsx("button",{className:"journey-comment-delete-btn",onClick:()=>dt(E.id,$.id),"aria-label":"Delete comment",children:r.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]})]},$.id)):r.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),ft[E.id]&&r.jsxs("div",{className:"journey-comment-replying",children:[r.jsxs("span",{children:["Replying to ",r.jsx("strong",{children:ft[E.id].authorName})]}),r.jsx("button",{onClick:()=>zt($=>({...$,[E.id]:null})),"aria-label":"Cancel reply",children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),hn[E.id]&&r.jsxs("div",{className:"journey-comment-img-preview",children:[r.jsx("img",{src:hn[E.id],alt:"Preview"}),r.jsx("button",{onClick:()=>es(E.id),"aria-label":"Remove image",children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),r.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[r.jsx("button",{className:"journey-comment-img-btn",onClick:()=>sn.current[E.id]?.click(),"aria-label":"Add image",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),r.jsx("input",{ref:$=>{sn.current[E.id]=$},type:"file",accept:"image/*",onChange:$=>Ot(E.id,$),hidden:!0}),r.jsx("input",{type:"text",placeholder:"Comment",value:Te[E.id]||"",onChange:$=>ts(E.id,$.target.value),onKeyDown:$=>{$.key==="Enter"&&rt(E.id)},maxLength:300}),Ze&&lt===E.id&&vt.length>0&&r.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:vt.map($=>r.jsxs("button",{className:"mention-option",onClick:()=>Ja($,E.id),children:[r.jsx("div",{className:"mention-option-avatar",children:$.photoURL?r.jsx("img",{src:$.photoURL,alt:""}):r.jsx("span",{children:iu($.name)})}),r.jsx("span",{children:$.name})]},$.id))}),r.jsx("button",{onClick:()=>rt(E.id),disabled:!(Te[E.id]||"").trim()&&!Lt[E.id]||bt[E.id],children:bt[E.id]?r.jsx("div",{className:"journey-btn-spinner-sm"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),r.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},E.id))})]})]}),!g&&r.jsxs("button",{className:"cb-upgrade-cta",onClick:()=>x("/upgrade"),children:[r.jsx("span",{className:"cb-upgrade-cta-text",children:"Unlock the full experience"}),r.jsx("span",{className:"cb-upgrade-cta-sub",children:"Nutrition, buddies, achievements & more"}),r.jsxs("svg",{className:"cb-upgrade-cta-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M5 12h14"}),r.jsx("path",{d:"M12 5l7 7-7 7"})]})]})]})]}),ps&&r.jsx("div",{className:"cb-badge-overlay",onClick:()=>Kt(null),children:r.jsxs("div",{className:"cb-badge-overlay-content",onClick:E=>E.stopPropagation(),children:[r.jsx("img",{src:ps.img,alt:ps.name,className:`cb-badge-overlay-img${Pt.includes(ps.id)?"":" cb-badge-overlay-img-locked"}`}),Pt.includes(ps.id)?r.jsx("span",{className:"cb-badge-status unlocked",children:"Unlocked"}):r.jsx("span",{className:"cb-badge-status locked",children:"Locked"}),r.jsx("button",{className:"cb-badge-overlay-close",onClick:()=>Kt(null),children:"Tap to close"})]})}),r.jsx(Ta,{active:"home"}),Pe&&r.jsxs("div",{className:`toast-notification ${Pe.type}`,children:[Pe.type==="info"&&r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),r.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),Pe.message]}),r.jsx(TD,{steps:da,active:ys,onFinish:Ai}),It&&r.jsxs("div",{className:"cb-celebration-overlay",onClick:()=>hs(null),children:[r.jsx("div",{className:"cb-confetti-container",children:Array.from({length:30},(E,$)=>r.jsx("span",{className:"cb-confetti-piece",style:{"--angle":`${Math.random()*360}deg`,"--distance":`${80+Math.random()*120}px`,"--delay":`${Math.random()*.3}s`,"--color":["#FFD700","#FF6B6B","#4ECDC4","#45B7D1","#F7DC6F","#BB8FCE","#FF8C42","#38B6FF"][$%8],"--size":`${6+Math.random()*6}px`,"--drift":`${(Math.random()-.5)*60}px`}},$))}),r.jsxs("div",{className:"cb-celebration-content",onClick:E=>E.stopPropagation(),children:[r.jsx("div",{className:"cb-celebration-glow"}),r.jsx("img",{src:It.img,alt:It.name,className:"cb-celebration-badge-img"}),r.jsx("h2",{className:"cb-celebration-title",children:"Badge Unlocked!"}),r.jsx("p",{className:"cb-celebration-name",children:It.name}),r.jsx("button",{className:"cb-celebration-dismiss",onClick:()=>hs(null),children:"Tap to continue"})]})]})]})})}const Gp=new Map;function so(){return new Date().toISOString().split("T")[0]}const N2=[{key:"breakfast",label:"Breakfast"},{key:"lunch",label:"Lunch"},{key:"dinner",label:"Dinner"},{key:"snacks",label:"Snacks"}],AD={breakfast:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1"}),r.jsx("path",{d:"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"}),r.jsx("line",{x1:"6",y1:"1",x2:"6",y2:"4"}),r.jsx("line",{x1:"10",y1:"1",x2:"10",y2:"4"}),r.jsx("line",{x1:"14",y1:"1",x2:"14",y2:"4"})]}),lunch:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}),dinner:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),snacks:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})};function MD(){const n=new Date().getHours();return n<11?"breakfast":n<14?"lunch":n<17?"snacks":"dinner"}function ID(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Lr(),{isDark:l,toggleTheme:u,accent:d}=Ca(),p=rr(),[g,y]=b.useState("loading"),[x,_]=b.useState(null),[j,O]=b.useState({gender:"male",age:"",weight:"",weightUnit:"kg",height:"",heightUnit:"cm",heightFeet:"",heightInches:"",dailyActivity:"sedentary",trainingFrequency:"moderate",goal:"maintain",deficitLevel:"moderate"}),[K,B]=b.useState(null),[D,se]=b.useState(so()),[Y,Z]=b.useState({entries:[],water:0}),[je,Re]=b.useState({protein:0,carbs:0,fats:0,calories:0}),[ke,C]=b.useState(!1),[T,M]=b.useState(!1),[V,I]=b.useState(()=>{const S=new Date;return{year:S.getFullYear(),month:S.getMonth()}}),[L,A]=b.useState(MD),[Oe,ht]=b.useState(null),[H,fe]=b.useState(null),[Ve,$e]=b.useState(!1),[J,P]=b.useState(null),[re,Fe]=b.useState(""),[qe,Ue]=b.useState(!1),[Ie,mt]=b.useState(""),[xt,it]=b.useState([]),[ss,Rs]=b.useState(!1),[Ut,jt]=b.useState({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),[ie,Mt]=b.useState(null),[St,Yt]=b.useState("100"),[Tt,Et]=b.useState(0),[ot,Pt]=b.useState("weight"),[Gt,ps]=b.useState(0),[Kt,It]=b.useState(null);b.useRef(null);const hs=b.useRef(!1),ws=b.useRef(null),is=b.useRef(null),Xs=b.useRef(null),Ps=b.useCallback((S,F="info")=>{It({message:S,type:F}),setTimeout(()=>It(null),3e3)},[]);b.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),b.useEffect(()=>{if(!t?.id)return;(async()=>{try{const F=await Ls(Xe(ye,"nutritionTargets",t.id));F.exists()?(_(F.data()),y("dashboard")):y("setup")}catch(F){console.error("Error loading nutrition data:",F),y("setup")}})()},[t?.id]),b.useEffect(()=>{if(!t?.id)return;(async()=>{try{const F=await Ls(Xe(ye,"nutritionLogs",`${t.id}_${D}`));if(F.exists()){const ae=F.data();Z({entries:ae.entries||[],water:ae.water||0})}else Z({entries:[],water:0})}catch(F){console.error("Error loading log:",F),Z({entries:[],water:0})}})()},[t?.id,D]),b.useEffect(()=>{const S=Y.entries.reduce((F,ae)=>({protein:F.protein+(ae.protein||0),carbs:F.carbs+(ae.carbs||0),fats:F.fats+(ae.fats||0),calories:F.calories+(ae.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});Re(S)},[Y.entries]);const qs=async S=>{try{await Os(Xe(ye,"nutritionLogs",`${t.id}_${D}`),{clientId:t.id,date:D,entries:S.entries,water:S.water,updatedAt:Rt.now()})}catch(F){console.error("Error saving nutrition log:",F)}},os=D===so(),_s=(S,F)=>new Date(S,F+1,0).getDate(),ve=(S,F)=>new Date(S,F,1).getDay(),De=["January","February","March","April","May","June","July","August","September","October","November","December"],Pe=["Su","Mo","Tu","We","Th","Fr","Sa"],st=()=>{let S=parseFloat(j.weight);j.weightUnit==="lbs"&&(S*=.453592);let F;j.heightUnit==="cm"?F=parseFloat(j.height):F=(parseFloat(j.heightFeet)||0)*30.48+(parseFloat(j.heightInches)||0)*2.54;const ae=parseInt(j.age);let te=j.gender==="male"?10*S+6.25*F-5*ae+5:10*S+6.25*F-5*ae-161;const ut=te*{sedentary:1.2,light:1.3,moderate:1.4,active:1.5}[j.dailyActivity],lt={low:100,moderate:200,high:300,daily:400},Dt=Math.round(ut+lt[j.trainingFrequency]);let vt=Dt,gs,ln;switch(j.goal){case"lose":vt=Dt*(1-{light:.15,moderate:.2,harsh:.25}[j.deficitLevel]),gs=2.2,ln=.3;break;case"build":vt=Dt*1.1,gs=2,ln=.22;break;default:gs=1.8,ln=.25}vt=Math.max(vt,j.gender==="male"?1400:1100);const hr=Math.round(S*gs),ys=Math.round(vt*ln/9),_r=Math.max(0,Math.round((vt-hr*4-ys*9)/4));B({calories:Math.round(vt),protein:hr,carbs:_r,fats:ys,bmr:Math.round(te),neat:Math.round(ut),exerciseAdd:lt[j.trainingFrequency],tdee:Math.round(Dt)})},Ge=async()=>{if(K)try{const S={clientId:t.id,calories:K.calories,protein:K.protein,carbs:K.carbs,fats:K.fats,waterGoal:8,goal:j.goal,updatedAt:Rt.now()};await Os(Xe(ye,"nutritionTargets",t.id),S),_(S),y("dashboard"),Ps("Macro targets saved!","success")}catch(S){console.error("Error saving targets:",S),Ps("Failed to save targets. Please try again.","error")}},nt=()=>{const S=j.weight&&parseFloat(j.weight)>0,F=j.age&&parseInt(j.age)>0,ae=j.heightUnit==="cm"?j.height&&parseFloat(j.height)>0:j.heightFeet&&parseFloat(j.heightFeet)>0||j.heightInches&&parseFloat(j.heightInches)>0;return S&&F&&ae},gt="nut_favourite_foods",X=()=>{try{return JSON.parse(localStorage.getItem(gt)||"[]")}catch{return[]}},ne=S=>X().some(F=>F.name.toLowerCase()===(S||"").toLowerCase()),Ke=S=>{const F=X(),ae=F.findIndex(te=>te.name.toLowerCase()===S.name.toLowerCase());ae>=0?F.splice(ae,1):F.unshift({name:S.name,protein:S.protein,carbs:S.carbs,fats:S.fats,calories:S.calories,serving:S.serving,per100g:S.per100g||null,servingUnit:S.servingUnit||"g",portion:S.portion||null}),localStorage.setItem(gt,JSON.stringify(F)),ps(te=>te+1)},wt=S=>{const F=[...Y.entries,{...S,meal:L,id:Date.now(),addedAt:new Date().toISOString()}],ae={...Y,entries:F};Z(ae),qs(ae),fe(null),Mt(null),Yt("100"),Et(0),Pt("weight"),jt({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),Ps("Food added!","success")},et=S=>{const F=Y.entries.filter(te=>te.id!==S),ae={...Y,entries:F};Z(ae),qs(ae)},_t=b.useRef(null),Q=b.useRef([]),Ae=3,Je=5,yt=async()=>{$e(!0);const S=document.querySelector("#barcode-reader");if(!S){$e(!1),Ps("Scanner container not found.","error");return}if(!_t.current)try{const ae=await wr(()=>import("./quagga.min-BbicSfvA.js").then(te=>te.q),[]);_t.current=ae.default}catch(ae){console.error("Failed to load barcode scanner:",ae),$e(!1),Ps("Could not load scanner.","error");return}const F=_t.current;F.init({inputStream:{type:"LiveStream",target:S,constraints:{facingMode:"environment",width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080}}},locator:{patchSize:"medium",halfSample:!0},numOfWorkers:navigator.hardwareConcurrency||2,decoder:{readers:["ean_reader","ean_8_reader","upc_reader","upc_e_reader","code_128_reader","code_39_reader"]},locate:!0},ae=>{if(ae){console.error("Quagga init error:",ae),$e(!1),Ps("Could not access camera. Check permissions.","error");return}F.start(),hs.current=!0}),Q.current=[],F.onDetected(ae=>{const te=ae.codeResult.decodedCodes?.filter(ut=>ut.error!==void 0)?.map(ut=>ut.error)||[];if((te.length>0?te.reduce((ut,lt)=>ut+lt,0)/te.length:1)<.15){const ut=ae.codeResult.code,lt=Q.current;lt.push(ut),lt.length>Je&&lt.shift(),lt.filter(vt=>vt===ut).length>=Ae&&(F.offDetected(),Q.current=[],P(ut))}})},at=()=>{const S=_t.current;hs.current&&S&&(S.stop(),S.offDetected(),hs.current=!1),$e(!1)},Zt=/\b(milk|semi.skimmed|skimmed|whole milk|oat milk|almond milk|soy milk|juice|smoothie|water|squash|cordial|cola|pepsi|fanta|lemonade|soda|beer|wine|cider|lager|spirit|whisky|vodka|rum|gin|brandy|cream|yoghurt drink|milkshake|coffee|tea|broth|stock|soup|sauce|ketchup|vinegar|oil|syrup|honey|custard|coconut water|kombucha|energy drink|protein shake)\b/i,Qt=S=>/ml|cl|\dl(?!b)|litre|liter|fl\s?oz/i.test((S||"").replace(/\s/g,"")),U=S=>{if(!S)return{value:100,unit:"g"};const F=S.toLowerCase().replace(/\s/g,""),ae=F.match(/([\d.]+)/),te=ae?parseFloat(ae[1]):100;return Qt(S)?/cl/.test(F)?{value:te*10,unit:"ml"}:/(?:^|\d)l(?!i)/.test(F)&&!/ml/.test(F)?{value:te*1e3,unit:"ml"}:{value:te,unit:"ml"}:{value:te,unit:"g"}},be=S=>{if(Qt(S.serving_size)||Qt(S.quantity))return"ml";const F=S.product_name||S.product_name_en||"";return Zt.test(F)?"ml":"g"},Ee=[{pattern:/\b(toast|bread|loaf|brioche|bagel|pitta|wrap|tortilla|crumpet|muffin|waffle|pancake)\b/i,label:"slice",weight:36},{pattern:/\begg\b/i,label:"egg",weight:60},{pattern:/\b(biscuit|cookie|digestive|hobnob|rich tea|oreo)\b/i,label:"biscuit",weight:13},{pattern:/\b(sausage|banger)\b/i,label:"sausage",weight:57},{pattern:/\b(rasher|bacon)\b/i,label:"rasher",weight:25},{pattern:/\b(rice cake)\b/i,label:"cake",weight:9},{pattern:/\b(cracker|ryvita)\b/i,label:"cracker",weight:10}],Te=(S,F)=>{const ae=S||"",te=ae.match(/\((\d+\.?\d*)\s*g\)/i),Ze=ae.match(/(?:^|per\s+)(\d*\s*[a-z][a-z\s]*?)(?:\s*\(|\s*-\s*|\s*$)/i);if(te&&Ze){const Dt=parseFloat(te[1]);let vt=Ze[1].replace(/^\d+\s*/,"").trim();if(vt&&Dt>0)return{label:vt,weight:Dt}}const ut=ae.match(/(\d+\.?\d*)\s*g\s*[\/=]\s*(\d*\s*[a-z][a-z\s]*)/i);if(ut){const Dt=parseFloat(ut[1]);let vt=ut[2].replace(/^\d+\s*/,"").trim();if(vt&&Dt>0)return{label:vt,weight:Dt}}const lt=F||"";for(const{pattern:Dt,label:vt,weight:gs}of Ee)if(Dt.test(lt))return{label:vt,weight:gs};return null},Se=S=>{const F=S.nutriments||{},ae=be(S),te=U(S.serving_size),Ze=ae==="ml"?te.unit==="ml"?te.value:100:te.value,ut=S.product_name||S.product_name_en||"Unknown Product",lt=Te(S.serving_size,ut);return{name:ut,brand:S.brands||"",image:S.image_small_url||S.image_url||null,servingSize:S.serving_size||"100g",servingValue:Ze,servingUnit:ae,portion:lt,protein:Math.round(F.proteins_100g||F.proteins||0),carbs:Math.round(F.carbohydrates_100g||F.carbohydrates||0),fats:Math.round(F.fat_100g||F.fat||0),calories:Math.round(F["energy-kcal_100g"]||F["energy-kcal"]||(F.energy_100g?F.energy_100g/4.184:0)),per100g:!0}},bt=async S=>{Ue(!0);try{const F=`https://world.openfoodfacts.org/api/v2/product/${S}?fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,ae=await fetch(F);if(!ae.ok)throw new Error(`HTTP ${ae.status}`);const te=await ae.json();if(te.status==="success"||te.status===1||te.product){const Ze=Se(te.product);Ze.calories===0&&Ze.protein===0&&Ze.carbs===0?Ps("Product found but no nutrition data available.","error"):(Mt(Ze),Ze.portion?(Et(1),Yt(String(Ze.portion.weight)),Pt("portion")):(Et(0),Yt(String(Ze.servingValue||100)),Pt("weight")),Fe(""))}else Ps("Product not found. Try search or manual entry.","error")}catch(F){console.error("Barcode lookup error:",F),Ps("Failed to look up product. Check your connection.","error")}Ue(!1)},Ct=(S,F,ae)=>{const te=S.toLowerCase().trim(),Ze=F.toLowerCase().trim(),ut=ae.toLowerCase().trim();let lt=0;return(te===ut||te===ut+"s"||te+"s"===ut)&&(lt+=100),(te.endsWith(" "+ut)||te.endsWith(" "+ut+"s"))&&(lt+=40),(te.startsWith(ut+" ")||te.startsWith(ut+"s "))&&(lt+=15),ut.split(/\s+/).some(vt=>Ze===vt||Ze.startsWith(vt))&&(lt+=30),lt+=Math.max(0,30-te.length),lt},ft=async()=>{if(!Ie.trim())return;ws.current&&ws.current.abort();const S=new AbortController;ws.current=S;const F=Ie.trim().toLowerCase(),ae=F.split(/\s+/).filter(Boolean);if(Gp.has(F)){it(Gp.get(F));return}Rs(!0);try{const Ze=`https://world.openfoodfacts.org/cgi/search.pl?search_terms=${encodeURIComponent(Ie.trim())}&search_simple=1&action=process&json=1&page_size=10&lc=en&sort_by=unique_scans_n&fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,ut=await fetch(Ze,{signal:S.signal});if(!ut.ok)throw new Error(`HTTP ${ut.status}`);const Dt=((await ut.json()).products||[]).map(vt=>Se(vt)).filter(vt=>vt.name!=="Unknown Product"&&(vt.calories>0||vt.protein>0)).filter(vt=>{const gs=(vt.name+" "+vt.brand).toLowerCase();return ae.every(ln=>gs.includes(ln))}).sort((vt,gs)=>Ct(gs.name,gs.brand,F)-Ct(vt.name,vt.brand,F)).slice(0,10);Gp.set(F,Dt),it(Dt),Dt.length===0&&Ps("No results found. Try a different search.","info")}catch(te){if(te.name==="AbortError")return;console.error("Search error:",te),Ps("Search failed. Check your connection.","error")}Rs(!1)};b.useEffect(()=>{if(is.current&&clearTimeout(is.current),!(!Ie.trim()||H!=="search"||ie))return is.current=setTimeout(()=>{ft()},700),()=>clearTimeout(is.current)},[Ie]);const zt=()=>{const S={...Y,water:Y.water+1};Z(S),qs(S)},Lt=()=>{if(Y.water<=0)return;const S={...Y,water:Y.water-1};Z(S),qs(S)},Bs=l,hn={"ring-protein":Bs?"#2dd4bf":"#14b8a6","ring-carbs":Bs?"#fbbf24":"#f59e0b","ring-fats":Bs?"#a78bfa":"#8b5cf6","ring-cals":"var(--color-primary)"},rn=80,Tn=2*Math.PI*rn,As=(S,F,ae,te,Ze)=>{const ut=te>0?Math.min(100,Math.round(ae/te*100)):0,lt=Tn-ut/100*Tn,Dt=hn[Ze]||"#14b8a6";return r.jsxs("div",{className:"nut-ring-wrap",children:[r.jsxs("svg",{className:"nut-ring-svg",viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"nut-arc-track",cx:"100",cy:"100",r:rn}),r.jsx("circle",{className:"nut-arc-fill",cx:"100",cy:"100",r:rn,style:{stroke:Dt},strokeDasharray:Tn,strokeDashoffset:lt})]}),r.jsxs("div",{className:"nut-ring-center",children:[r.jsx("span",{className:"nut-ring-value",style:{color:Dt},children:Math.round(ae)}),r.jsxs("span",{className:"nut-ring-target",children:["/ ",te,S==="Calories"?"":"g"]}),r.jsx("span",{className:"nut-ring-label",style:{color:Dt},children:F})]}),r.jsxs("span",{className:"nut-ring-pct",style:{color:Dt},children:[ut,"%"]})]})};if(b.useEffect(()=>{if(!J)return;const S=setTimeout(()=>{const F=J;at(),P(null),bt(F)},1500);return()=>clearTimeout(S)},[J]),b.useEffect(()=>()=>{const S=_t.current;if(hs.current&&S){try{S.stop(),S.offDetected()}catch{}hs.current=!1}},[]),i||g==="loading")return r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsx("div",{className:"nut-loading-inline",children:r.jsx("div",{className:"cb-loading-spinner"})})]});if(g==="setup")return r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"nut-main",children:[r.jsxs("div",{className:"nut-setup-intro",children:[r.jsx("h2",{children:"Set Your Daily Targets"}),r.jsx("p",{children:"Calculate your personalised macros based on your body and goals."})]}),r.jsxs("div",{className:"nut-calc-form",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Gender"}),r.jsxs("div",{className:"nut-toggle-group",children:[r.jsx("button",{className:j.gender==="male"?"active":"",onClick:()=>{O(S=>({...S,gender:"male"})),B(null)},children:"Male"}),r.jsx("button",{className:j.gender==="female"?"active":"",onClick:()=>{O(S=>({...S,gender:"female"})),B(null)},children:"Female"})]})]}),r.jsxs("div",{className:"nut-form-row",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Age"}),r.jsx("input",{type:"number",value:j.age,onChange:S=>{O(F=>({...F,age:S.target.value})),B(null)},placeholder:"Years",min:"15",max:"100"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Weight"}),r.jsxs("div",{className:"nut-input-unit",children:[r.jsx("input",{type:"number",value:j.weight,onChange:S=>{O(F=>({...F,weight:S.target.value})),B(null)},placeholder:j.weightUnit,min:"30",max:"300"}),r.jsxs("div",{className:"nut-unit-toggle",children:[r.jsx("button",{className:j.weightUnit==="kg"?"active":"",onClick:()=>{O(S=>({...S,weightUnit:"kg"})),B(null)},children:"kg"}),r.jsx("button",{className:j.weightUnit==="lbs"?"active":"",onClick:()=>{O(S=>({...S,weightUnit:"lbs"})),B(null)},children:"lbs"})]})]})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Height"}),r.jsxs("div",{className:"nut-input-unit",children:[j.heightUnit==="cm"?r.jsx("input",{type:"number",value:j.height,onChange:S=>{O(F=>({...F,height:S.target.value})),B(null)},placeholder:"cm",min:"100",max:"250"}):r.jsxs("div",{className:"nut-height-imperial",children:[r.jsx("input",{type:"number",value:j.heightFeet,onChange:S=>{O(F=>({...F,heightFeet:S.target.value})),B(null)},placeholder:"ft",min:"4",max:"7"}),r.jsx("input",{type:"number",value:j.heightInches,onChange:S=>{O(F=>({...F,heightInches:S.target.value})),B(null)},placeholder:"in",min:"0",max:"11"})]}),r.jsxs("div",{className:"nut-unit-toggle",children:[r.jsx("button",{className:j.heightUnit==="cm"?"active":"",onClick:()=>{O(S=>({...S,heightUnit:"cm"})),B(null)},children:"cm"}),r.jsx("button",{className:j.heightUnit==="ft"?"active":"",onClick:()=>{O(S=>({...S,heightUnit:"ft"})),B(null)},children:"ft/in"})]})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Daily Activity (outside of training)"}),r.jsxs("select",{value:j.dailyActivity,onChange:S=>{O(F=>({...F,dailyActivity:S.target.value})),B(null)},children:[r.jsx("option",{value:"sedentary",children:"Sedentary  desk job, under 5k steps"}),r.jsx("option",{value:"light",children:"Lightly Active  office + walking, 5-8k steps"}),r.jsx("option",{value:"moderate",children:"Moderately Active  on feet often, 8-12k steps"}),r.jsx("option",{value:"active",children:"Very Active  physical job, 12k+ steps"})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Training Sessions per Week"}),r.jsxs("select",{value:j.trainingFrequency,onChange:S=>{O(F=>({...F,trainingFrequency:S.target.value})),B(null)},children:[r.jsx("option",{value:"low",children:"1-2 sessions"}),r.jsx("option",{value:"moderate",children:"3-4 sessions"}),r.jsx("option",{value:"high",children:"5-6 sessions"}),r.jsx("option",{value:"daily",children:"7+ sessions"})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Fitness Goal"}),r.jsxs("div",{className:"nut-goal-options",children:[r.jsxs("button",{className:j.goal==="lose"?"active":"",onClick:()=>{O(S=>({...S,goal:"lose"})),B(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"-"}),r.jsx("span",{children:"Lose Weight"})]}),r.jsxs("button",{className:j.goal==="maintain"?"active":"",onClick:()=>{O(S=>({...S,goal:"maintain"})),B(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"="}),r.jsx("span",{children:"Maintain"})]}),r.jsxs("button",{className:j.goal==="build"?"active":"",onClick:()=>{O(S=>({...S,goal:"build"})),B(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"+"}),r.jsx("span",{children:"Build Muscle"})]})]})]}),j.goal==="lose"&&r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Deficit Level"}),r.jsxs("div",{className:"nut-deficit-options",children:[r.jsxs("button",{className:j.deficitLevel==="light"?"active":"",onClick:()=>{O(S=>({...S,deficitLevel:"light"})),B(null)},children:[r.jsx("strong",{children:"Mild"}),r.jsx("span",{children:"15% below TDEE"})]}),r.jsxs("button",{className:j.deficitLevel==="moderate"?"active":"",onClick:()=>{O(S=>({...S,deficitLevel:"moderate"})),B(null)},children:[r.jsx("strong",{children:"Moderate"}),r.jsx("span",{children:"20% below TDEE"})]}),r.jsxs("button",{className:j.deficitLevel==="harsh"?"active":"",onClick:()=>{O(S=>({...S,deficitLevel:"harsh"})),B(null)},children:[r.jsx("strong",{children:"Aggressive"}),r.jsx("span",{children:"25% below TDEE"})]})]})]}),r.jsx("button",{className:"nut-calc-btn",onClick:st,disabled:!nt(),children:"Calculate Macros"})]}),K&&r.jsxs("div",{className:"nut-calc-results",children:[r.jsx("h3",{children:"Your Daily Targets"}),r.jsxs("div",{className:"nut-calc-rings",children:[As("Protein","Protein",K.protein,K.protein,"ring-protein"),As("Carbs","Carbs",K.carbs,K.carbs,"ring-carbs"),As("Fats","Fats",K.fats,K.fats,"ring-fats"),As("Calories","Calories",K.calories,K.calories,"ring-cals")]}),r.jsxs("div",{className:"nut-calc-info",children:[r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"BMR (body at rest)"}),r.jsxs("span",{children:[K.bmr," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"+ Daily activity (NEAT)"}),r.jsxs("span",{children:[K.neat," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"+ Training sessions"}),r.jsxs("span",{children:["+",K.exerciseAdd," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",style:{fontWeight:600},children:[r.jsx("span",{children:"TDEE (total burn)"}),r.jsxs("span",{children:[K.tdee," cal"]})]})]}),r.jsx("button",{className:"nut-save-targets-btn",onClick:Ge,children:"Set as My Daily Targets"})]})]}),Kt&&r.jsx("div",{className:`toast-notification ${Kt.type}`,children:Kt.message})]});const sn=S=>{const F=new Date(S+"T12:00:00"),ae=F.getDay(),te=new Date(F);te.setDate(F.getDate()-(ae+6)%7);const Ze=[];for(let ut=0;ut<7;ut++){const lt=new Date(te);lt.setDate(te.getDate()+ut),Ze.push(lt.toISOString().split("T")[0])}return Ze},ks=["M","T","W","T","F","S","S"],W=(S,F="search")=>{A(S),F==="scan"?(fe("scan"),Mt(null)):F==="manual"?(fe("manual"),jt({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""})):F==="favourites"?fe("favourites"):(fe("search"),it([]),mt(""))},de=sn(D),le=new Date(D+"T12:00:00"),we=`${De[le.getMonth()]} ${le.getFullYear()}`;return r.jsx(Sa,{children:r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsxs("div",{className:"nut-dark-zone",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsxs("div",{className:"header-actions",children:[r.jsx("button",{onClick:()=>{y("setup"),B(null)},"aria-label":"Recalculate macros",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"3"}),r.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]})]})}),r.jsxs("div",{className:"nut-dark-content",children:[r.jsxs("div",{className:"nut-week-strip anim-fade-up",children:[r.jsxs("div",{className:"nut-week-header",children:[r.jsx("button",{className:"nut-week-arrow",onClick:()=>{const S=new Date(D+"T12:00:00");S.setDate(S.getDate()-7);const F=S.toISOString().split("T")[0];se(F)},"aria-label":"Previous week",children:r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:r.jsx("polyline",{points:"15 18 9 12 15 6"})})}),r.jsx("button",{className:"nut-week-month-label",onClick:()=>{C(!ke),I({year:le.getFullYear(),month:le.getMonth()})},children:we}),r.jsx("button",{className:"nut-week-arrow",onClick:()=>{const S=new Date(D+"T12:00:00");S.setDate(S.getDate()+7);const F=S.toISOString().split("T")[0];F<=so()&&se(F)},"aria-label":"Next week",disabled:de[6]>=so(),children:r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:r.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),r.jsx("div",{className:"nut-week-days",children:de.map((S,F)=>{const ae=new Date(S+"T12:00:00").getDate(),te=S===D,Ze=S>so(),ut=S===so();return r.jsxs("button",{className:`nut-week-day${te?" selected":""}${ut?" today":""}${Ze?" future":""}`,disabled:Ze,onClick:()=>se(S),children:[r.jsx("span",{className:"nut-week-day-letter",children:ks[F]}),r.jsx("span",{className:"nut-week-day-num",children:ae})]},S)})})]}),ke&&r.jsxs("div",{className:"nut-calendar nut-calendar-dark",children:[r.jsxs("div",{className:"nut-cal-header",children:[r.jsx("button",{onClick:()=>I(S=>{let F=S.month-1,ae=S.year;return F<0&&(F=11,ae--),{year:ae,month:F}}),children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("polyline",{points:"15 18 9 12 15 6"})})}),r.jsxs("span",{children:[De[V.month]," ",V.year]}),r.jsx("button",{onClick:()=>I(S=>{let F=S.month+1,ae=S.year;return F>11&&(F=0,ae++),{year:ae,month:F}}),disabled:V.year===new Date().getFullYear()&&V.month>=new Date().getMonth(),children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),r.jsx("div",{className:"nut-cal-days-header",children:Pe.map(S=>r.jsx("span",{children:S},S))}),r.jsxs("div",{className:"nut-cal-grid",children:[[...Array(ve(V.year,V.month))].map((S,F)=>r.jsx("span",{},`e${F}`)),[...Array(_s(V.year,V.month))].map((S,F)=>{const ae=F+1,te=`${V.year}-${String(V.month+1).padStart(2,"0")}-${String(ae).padStart(2,"0")}`,Ze=te>so(),ut=te===D,lt=te===so();return r.jsx("button",{className:`nut-cal-day${ut?" selected":""}${lt?" today":""}${Ze?" future":""}`,disabled:Ze,onClick:()=>{se(te),C(!1)},children:ae},ae)})]})]}),r.jsxs("div",{className:"nut-rings-row anim-fade-up-d2",children:[As("Protein","Protein",je.protein,x.protein,"ring-protein"),As("Carbs","Carbs",je.carbs,x.carbs,"ring-carbs"),As("Fats","Fats",je.fats,x.fats,"ring-fats"),As("Calories","kCal",je.calories,x.calories,"ring-cals")]})]})]}),r.jsx("div",{className:"nut-light-zone anim-fade-up-d4",children:r.jsxs("div",{className:"nut-light-content",children:[os&&r.jsxs("button",{className:"nut-water-quick",onClick:()=>M(!0),children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"18",height:"18",children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),r.jsxs("span",{className:"nut-water-quick-count",children:[Y.water," / ",x?.waterGoal||8]}),r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",width:"14",height:"14",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})]}),r.jsx("div",{className:"nut-log-section",children:r.jsx("div",{className:"nut-meals-list",children:N2.map(S=>{const F=Y.entries.filter(te=>(te.meal||"snacks")===S.key),ae=F.reduce((te,Ze)=>({protein:te.protein+(Ze.protein||0),carbs:te.carbs+(Ze.carbs||0),fats:te.fats+(Ze.fats||0),calories:te.calories+(Ze.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});return r.jsxs("div",{className:"nut-meal-card",children:[r.jsxs("div",{className:"nut-meal-card-header",children:[r.jsx("span",{className:`nut-meal-card-icon nut-meal-icon-${S.key}`,children:AD[S.key]}),r.jsx("span",{className:"nut-meal-card-title",children:S.label}),F.length>0&&r.jsxs("span",{className:"nut-meal-card-cal",children:[ae.calories," cal"]}),os&&r.jsx("button",{className:"nut-meal-add-btn",onClick:()=>ht(Oe===S.key?null:S.key),"aria-label":`Add to ${S.label}`,children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]}),F.length>0&&r.jsxs("div",{className:"nut-meal-bars",children:[r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-p",children:"P"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-protein",style:{width:`${Math.min(100,x.protein>0?ae.protein/x.protein*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[ae.protein,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-c",children:"C"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-carbs",style:{width:`${Math.min(100,x.carbs>0?ae.carbs/x.carbs*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[ae.carbs,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-f",children:"F"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-fats",style:{width:`${Math.min(100,x.fats>0?ae.fats/x.fats*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[ae.fats,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-cal",children:"K"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-cals",style:{width:`${Math.min(100,x.calories>0?ae.calories/x.calories*100:0)}%`}})}),r.jsx("span",{className:"nut-meal-bar-val",children:ae.calories})]})]}),F.length>0&&r.jsx("div",{className:"nut-log-list",children:F.map(te=>r.jsxs("div",{className:"nut-log-item",children:[r.jsx("button",{className:`nut-fav-star log${ne(te.name)?" active":""}`,onClick:()=>Ke(te),"aria-label":ne(te.name)?"Remove from favourites":"Add to favourites",children:r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:ne(te.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("div",{className:"nut-log-item-info",children:[r.jsx("span",{className:"nut-log-item-name",children:te.name}),te.serving&&r.jsx("span",{className:"nut-log-item-serving",children:te.serving})]}),r.jsxs("div",{className:"nut-log-item-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[te.protein,"p"]}),r.jsxs("span",{className:"nut-macro-c",children:[te.carbs,"c"]}),r.jsxs("span",{className:"nut-macro-f",children:[te.fats,"f"]}),r.jsx("span",{className:"nut-macro-cal",children:te.calories})]}),os&&r.jsx("button",{className:"nut-log-delete",onClick:()=>et(te.id),"aria-label":"Remove",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},te.id))}),F.length===0&&r.jsx("div",{className:"nut-meal-empty",children:r.jsx("p",{children:os?"Tap + to add food":"No entries"})})]},S.key)})})})]})}),Oe&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"nut-add-picker-backdrop",onClick:()=>ht(null)}),r.jsxs("div",{className:"nut-add-picker",children:[r.jsx("div",{className:"nut-add-picker-handle"}),r.jsxs("h3",{className:"nut-add-picker-title",children:["Add to ",N2.find(S=>S.key===Oe)?.label]}),r.jsxs("div",{className:"nut-add-picker-options",children:[r.jsxs("button",{onClick:()=>{const S=Oe;ht(null),W(S,"scan")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),r.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),r.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),r.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),r.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),r.jsx("span",{children:"Scan Barcode"})]}),r.jsxs("button",{onClick:()=>{const S=Oe;ht(null),W(S,"search")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("span",{children:"Search Food"})]}),r.jsxs("button",{onClick:()=>{const S=Oe;ht(null),W(S,"manual")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),r.jsx("span",{children:"Manual Entry"})]}),r.jsxs("button",{onClick:()=>{const S=Oe;ht(null),W(S,"favourites")},children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),r.jsx("span",{children:"Favourites"})]})]})]})]}),T&&r.jsx("div",{className:"nut-modal-overlay",onClick:()=>M(!1),children:r.jsxs("div",{className:"nut-water-popup",onClick:S=>S.stopPropagation(),children:[r.jsxs("div",{className:"nut-water-popup-header",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"20",height:"20",style:{color:"#2196f3"},children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),r.jsx("span",{children:"Water Intake"}),r.jsx("button",{className:"nut-modal-close",onClick:()=>M(!1),children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),r.jsxs("div",{className:"nut-water-popup-body",children:[r.jsx("div",{className:"nut-water-glasses",children:[...Array(x?.waterGoal||8)].map((S,F)=>r.jsx("div",{className:`nut-water-glass ${F<Y.water?"filled":""}`,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:F<Y.water?"currentColor":"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})})},F))}),r.jsxs("div",{className:"nut-water-popup-count",children:[Y.water," / ",x?.waterGoal||8," glasses"]}),r.jsxs("div",{className:"nut-water-btns",children:[r.jsx("button",{onClick:Lt,disabled:Y.water<=0,children:"-"}),r.jsx("button",{onClick:zt,children:"+"})]})]})]})}),H&&r.jsx("div",{className:"nut-modal-overlay",onClick:()=>{at(),P(null),fe(null),Mt(null)},children:r.jsxs("div",{className:"nut-modal",onClick:S=>S.stopPropagation(),children:[r.jsxs("div",{className:"nut-modal-header",children:[r.jsx("h3",{children:H==="scan"?"Scan Barcode":H==="search"?"Search Food":H==="favourites"?"Favourites":"Manual Entry"}),r.jsx("button",{className:"nut-modal-close",onClick:()=>{at(),P(null),fe(null),Mt(null)},children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),H==="scan"&&!ie&&r.jsxs("div",{className:"nut-scan-area",children:[r.jsxs("div",{className:"nut-scanner-wrapper",children:[r.jsx("div",{id:"barcode-reader",className:"nut-scanner-view"}),Ve&&!J&&r.jsx("div",{className:"nut-scan-line"}),J&&r.jsxs("div",{className:"nut-scan-detected-overlay",children:[r.jsx("svg",{className:"nut-scan-detected-tick",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20 6L9 17l-5-5"})}),r.jsx("p",{className:"nut-scan-detected-label",children:"Barcode found!"}),r.jsx("p",{className:"nut-scan-detected-code",children:J})]})]}),!Ve&&r.jsxs("button",{className:"nut-scan-start-btn",onClick:yt,children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),r.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),r.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),r.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),r.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),"Open Camera"]}),Ve&&!J&&r.jsx("p",{className:"nut-scan-hint",children:"Align barcode within the frame"}),r.jsx("div",{className:"nut-barcode-divider",children:r.jsx("span",{children:"or enter barcode manually"})}),r.jsxs("div",{className:"nut-barcode-manual",children:[r.jsx("input",{type:"text",inputMode:"numeric",value:re,onChange:S=>Fe(S.target.value),onKeyDown:S=>S.key==="Enter"&&re.trim()&&bt(re.trim()),placeholder:"Enter barcode number"}),r.jsx("button",{onClick:()=>re.trim()&&bt(re.trim()),disabled:!re.trim()||qe,children:qe?"...":"Look Up"})]})]}),H==="scan"&&ie&&(()=>{const S=ie.servingUnit||"g",F=ie.portion,ae=ot==="portion"&&F?Tt*F.weight:parseFloat(St)||0,te=ae/100,Ze=S==="ml"?[100,200,250,500]:[50,100,150,200],ut=ot==="portion"&&F?`${Tt} ${F.label}${Tt!==1?"s":""} (${Math.round(ae)}${S})`:`${Math.round(ae)}${S}`;return r.jsxs("div",{className:"nut-product-result",children:[ie.image&&r.jsx("img",{src:ie.image,alt:ie.name||"Product",className:"nut-product-img",loading:"lazy"}),r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:ie.name}),r.jsx("button",{className:`nut-fav-star confirm${ne(ie.name)?" active":""}`,onClick:()=>Ke({name:ie.name,protein:ie.protein,carbs:ie.carbs,fats:ie.fats,calories:ie.calories,serving:ie.servingSize,per100g:{protein:ie.protein,carbs:ie.carbs,fats:ie.fats,calories:ie.calories},servingUnit:ie.servingUnit||"g",portion:ie.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:ne(ie.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),ie.brand&&r.jsx("p",{className:"nut-product-brand",children:ie.brand}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",S,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[ie.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[ie.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[ie.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[ie.calories," cal"]})]}),F&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:ot==="portion"?"active":"",onClick:()=>{Pt("portion"),Tt<1&&Et(1)},children:"Portions"}),r.jsxs("button",{className:ot==="weight"?"active":"",onClick:()=>{Pt("weight"),Yt(String(Math.round(ae)||100))},children:["Custom (",S,")"]})]}),ot==="portion"&&F?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>Et(Math.max(1,Tt-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:Tt}),r.jsxs("span",{className:"nut-stepper-label",children:[F.label,Tt!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(ae),S]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>Et(Tt+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",S,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:St,onChange:lt=>Yt(lt.target.value),onFocus:lt=>lt.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:Ze.map(lt=>r.jsxs("button",{className:`nut-quick-btn${St===String(lt)?" active":""}`,onClick:()=>Yt(String(lt)),children:[lt,S]},lt))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(ie.protein*te),"p / ",Math.round(ie.carbs*te),"c / ",Math.round(ie.fats*te),"f / ",Math.round(ie.calories*te)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>{Mt(null),fe("scan")},children:"Scan Again"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>wt({name:ie.name,protein:Math.round(ie.protein*te),carbs:Math.round(ie.carbs*te),fats:Math.round(ie.fats*te),calories:Math.round(ie.calories*te),serving:ut}),children:"Add"})]})]})})(),H==="search"&&!ie&&r.jsxs("div",{className:"nut-search-area",children:[r.jsxs("div",{className:"nut-search-bar",children:[r.jsx("input",{type:"text",ref:Xs,value:Ie,onChange:S=>mt(S.target.value),onKeyDown:S=>{S.key==="Enter"&&(clearTimeout(is.current),ft())},onFocus:()=>setTimeout(()=>Xs.current?.scrollIntoView({behavior:"smooth",block:"center"}),350),placeholder:"Search food or product...",autoFocus:!0}),r.jsx("button",{onClick:ft,disabled:ss,children:ss?"...":"Search"})]}),r.jsxs("div",{className:"nut-search-results",children:[xt.map((S,F)=>r.jsxs("button",{className:"nut-search-item",onClick:()=>{Mt(S),S.portion?(Et(1),Yt(String(S.portion.weight)),Pt("portion")):(Et(0),Yt(String(S.servingValue||100)),Pt("weight"))},children:[S.image&&r.jsx("img",{src:S.image,alt:S.name||"Product",loading:"lazy"}),r.jsxs("div",{className:"nut-search-item-info",children:[r.jsx("span",{className:"nut-search-item-name",children:S.name}),S.brand&&r.jsx("span",{className:"nut-search-item-brand",children:S.brand}),r.jsxs("span",{className:"nut-search-item-macros",children:[S.calories," cal  ",S.protein,"p  ",S.carbs,"c  ",S.fats,"f per 100",S.servingUnit||"g"]})]})]},F)),xt.length===0&&Ie&&!ss&&r.jsx("p",{className:"nut-search-empty",children:"No results found. Try a different search or use manual entry."})]})]}),H==="search"&&ie&&(()=>{const S=ie.servingUnit||"g",F=ie.portion,ae=ot==="portion"&&F?Tt*F.weight:parseFloat(St)||0,te=ae/100,Ze=S==="ml"?[100,200,250,500]:[50,100,150,200],ut=ot==="portion"&&F?`${Tt} ${F.label}${Tt!==1?"s":""} (${Math.round(ae)}${S})`:`${Math.round(ae)}${S}`;return r.jsxs("div",{className:"nut-product-result",children:[ie.image&&r.jsx("img",{src:ie.image,alt:ie.name||"Product",className:"nut-product-img",loading:"lazy"}),r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:ie.name}),r.jsx("button",{className:`nut-fav-star confirm${ne(ie.name)?" active":""}`,onClick:()=>Ke({name:ie.name,protein:ie.protein,carbs:ie.carbs,fats:ie.fats,calories:ie.calories,serving:ie.servingSize,per100g:{protein:ie.protein,carbs:ie.carbs,fats:ie.fats,calories:ie.calories},servingUnit:ie.servingUnit||"g",portion:ie.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:ne(ie.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),ie.brand&&r.jsx("p",{className:"nut-product-brand",children:ie.brand}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",S,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[ie.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[ie.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[ie.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[ie.calories," cal"]})]}),F&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:ot==="portion"?"active":"",onClick:()=>{Pt("portion"),Tt<1&&Et(1)},children:"Portions"}),r.jsxs("button",{className:ot==="weight"?"active":"",onClick:()=>{Pt("weight"),Yt(String(Math.round(ae)||100))},children:["Custom (",S,")"]})]}),ot==="portion"&&F?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>Et(Math.max(1,Tt-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:Tt}),r.jsxs("span",{className:"nut-stepper-label",children:[F.label,Tt!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(ae),S]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>Et(Tt+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",S,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:St,onChange:lt=>Yt(lt.target.value),onFocus:lt=>lt.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:Ze.map(lt=>r.jsxs("button",{className:`nut-quick-btn${St===String(lt)?" active":""}`,onClick:()=>Yt(String(lt)),children:[lt,S]},lt))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(ie.protein*te),"p / ",Math.round(ie.carbs*te),"c / ",Math.round(ie.fats*te),"f / ",Math.round(ie.calories*te)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>Mt(null),children:"Back to Search"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>wt({name:ie.name,protein:Math.round(ie.protein*te),carbs:Math.round(ie.carbs*te),fats:Math.round(ie.fats*te),calories:Math.round(ie.calories*te),serving:ut}),children:"Add"})]})]})})(),H==="manual"&&r.jsxs("div",{className:"nut-manual-form",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Food Name"}),r.jsx("input",{type:"text",value:Ut.name,onChange:S=>jt(F=>({...F,name:S.target.value})),placeholder:"e.g. Chicken Breast",autoFocus:!0})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Serving Size (optional)"}),r.jsx("input",{type:"text",value:Ut.serving,onChange:S=>jt(F=>({...F,serving:S.target.value})),placeholder:"e.g. 150g, 1 cup"})]}),r.jsxs("div",{className:"nut-manual-macros",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Protein (g)"}),r.jsx("input",{type:"number",value:Ut.protein,onChange:S=>jt(F=>({...F,protein:S.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Carbs (g)"}),r.jsx("input",{type:"number",value:Ut.carbs,onChange:S=>jt(F=>({...F,carbs:S.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Fats (g)"}),r.jsx("input",{type:"number",value:Ut.fats,onChange:S=>jt(F=>({...F,fats:S.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Calories"}),r.jsx("input",{type:"number",value:Ut.calories,onChange:S=>jt(F=>({...F,calories:S.target.value})),min:"0"})]})]}),r.jsx("button",{className:"nut-btn-primary",disabled:!Ut.name.trim(),onClick:()=>wt({name:Ut.name,protein:parseFloat(Ut.protein)||0,carbs:parseFloat(Ut.carbs)||0,fats:parseFloat(Ut.fats)||0,calories:parseFloat(Ut.calories)||0,serving:Ut.serving||""}),children:"Add Food"})]}),H==="favourites"&&!ie&&(()=>{const S=X(),F=ae=>{if(ae.per100g){const te=ae.per100g;Mt({name:ae.name,brand:"",image:null,servingSize:ae.serving||"100g",servingValue:100,servingUnit:ae.servingUnit||"g",portion:ae.portion||null,protein:te.protein,carbs:te.carbs,fats:te.fats,calories:te.calories,per100g:!0}),ae.portion?(Et(1),Yt(String(ae.portion.weight)),Pt("portion")):(Et(0),Yt("100"),Pt("weight"))}else wt({name:ae.name,protein:ae.protein,carbs:ae.carbs,fats:ae.fats,calories:ae.calories,serving:ae.serving||""})};return r.jsx("div",{className:"nut-recent-area",children:S.length===0?r.jsx("p",{className:"nut-search-empty",children:"No favourites yet. Tap the star on any food to save it here."}):r.jsx("div",{className:"nut-recent-list",children:S.map((ae,te)=>r.jsxs("div",{className:"nut-recent-item-row",children:[r.jsx("button",{className:"nut-fav-star active",onClick:Ze=>{Ze.stopPropagation(),Ke(ae)},children:r.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("button",{className:"nut-recent-item",onClick:()=>F(ae),children:[r.jsxs("div",{className:"nut-recent-item-info",children:[r.jsx("span",{className:"nut-recent-item-name",children:ae.name}),r.jsx("span",{className:"nut-recent-item-serving",children:ae.serving||""})]}),r.jsxs("span",{className:"nut-recent-item-macros",children:[ae.calories," cal"]})]})]},te))})})})(),H==="favourites"&&ie&&(()=>{const S=ie.servingUnit||"g",F=ie.portion,ae=ot==="portion"&&F?Tt*F.weight:parseFloat(St)||0,te=ae/100,Ze=S==="ml"?[100,200,250,500]:[50,100,150,200],ut=ot==="portion"&&F?`${Tt} ${F.label}${Tt!==1?"s":""} (${Math.round(ae)}${S})`:`${Math.round(ae)}${S}`;return r.jsxs("div",{className:"nut-product-result",children:[r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:ie.name}),r.jsx("button",{className:`nut-fav-star confirm${ne(ie.name)?" active":""}`,onClick:()=>Ke({name:ie.name,protein:ie.protein,carbs:ie.carbs,fats:ie.fats,calories:ie.calories,serving:ie.servingSize,per100g:{protein:ie.protein,carbs:ie.carbs,fats:ie.fats,calories:ie.calories},servingUnit:ie.servingUnit||"g",portion:ie.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:ne(ie.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",S,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[ie.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[ie.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[ie.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[ie.calories," cal"]})]}),F&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:ot==="portion"?"active":"",onClick:()=>{Pt("portion"),Tt<1&&Et(1)},children:"Portions"}),r.jsxs("button",{className:ot==="weight"?"active":"",onClick:()=>{Pt("weight"),Yt(String(Math.round(ae)||100))},children:["Custom (",S,")"]})]}),ot==="portion"&&F?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>Et(Math.max(1,Tt-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:Tt}),r.jsxs("span",{className:"nut-stepper-label",children:[F.label,Tt!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(ae),S]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>Et(Tt+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",S,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:St,onChange:lt=>Yt(lt.target.value),onFocus:lt=>lt.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:Ze.map(lt=>r.jsxs("button",{className:`nut-quick-btn${St===String(lt)?" active":""}`,onClick:()=>Yt(String(lt)),children:[lt,S]},lt))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(ie.protein*te),"p / ",Math.round(ie.carbs*te),"c / ",Math.round(ie.fats*te),"f / ",Math.round(ie.calories*te)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>Mt(null),children:"Back to Favourites"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>wt({name:ie.name,protein:Math.round(ie.protein*te),carbs:Math.round(ie.carbs*te),fats:Math.round(ie.fats*te),calories:Math.round(ie.calories*te),serving:ut}),children:"Add"})]})]})})()]})}),r.jsx(Ta,{active:"nutrition"}),Kt&&r.jsx("div",{className:`toast-notification ${Kt.type}`,children:Kt.message})]})})}async function nb(n){const{type:e="workout",title:t="Workout Complete!",stats:i=[],badges:l=[],badgeImage:u,badgeDesc:d}=n,p=1080,g=1920,y=document.createElement("canvas");y.width=p,y.height=g;const x=y.getContext("2d"),_="#2a2a28",j="#ffffff",O="#A12F3A",K="#1a1a1a",B="#555555";x.fillStyle=_,x.fillRect(0,0,p,g);const D=Math.round(p*.82),se=Math.round(g*.75),Y=Math.round((p-D)/2),Z=Math.round((g-se)/2),je=28,Re=5;x.save(),x.shadowColor="rgba(0, 0, 0, 0.45)",x.shadowBlur=40,x.shadowOffsetY=10,C2(x,Y,Z,D,se,je),x.fillStyle=j,x.fill(),x.restore(),x.save(),C2(x,Y,Z,D,se,je),x.strokeStyle=O,x.lineWidth=Re,x.stroke(),x.restore();const ke=220,C=50,T=52,M=68,V=10,I=36,L=48,A=30,Oe=34,ht=46,H=30,fe=28;x.font=`bold ${T}px 'Orbitron', sans-serif`;const Ve=ou(x,t.toUpperCase(),D-100);x.font=`500 ${I}px 'Montserrat', sans-serif`;let $e=[];e==="badge"&&d?$e=ou(x,d,D-120):e==="badge"&&l.length>0?$e=ou(x,l.join("    "),D-120):i.length>0&&($e=ou(x,i.map(Mt=>`${Mt.value} ${Mt.label}`).join("    "),D-120));const J=e==="badge"?"I just earned a badge on Core Buddy ":e==="habits"?"I just completed my daily habits with Core Buddy ":"I just completed a workout using Core Buddy ";x.font=`bold ${Oe}px 'Montserrat', sans-serif`;const P=ou(x,J,D-80);let re=Ve.length*M;$e.length>0&&(re+=V+$e.length*L),re+=A+P.length*ht,re+=H+fe;const qe=Z+se-60-re,Ie=Z+40,mt=qe-C,xt=p/2,it=(Ie+mt)/2,ss=e==="badge"&&u?u:"/Logo.webp";x.save();const Rs=e==="badge"?"rgba(255, 193, 7, 0.15)":"rgba(161, 47, 58, 0.12)",Ut=x.createRadialGradient(xt,it,ke*.6,xt,it,ke*1.5);Ut.addColorStop(0,Rs),Ut.addColorStop(1,"rgba(0, 0, 0, 0)"),x.fillStyle=Ut,x.fillRect(xt-ke*1.5,it-ke*1.5,ke*3,ke*3),x.restore(),x.beginPath(),x.arc(xt,it,ke+6,0,Math.PI*2),x.fillStyle=j,x.fill();const jt=e==="badge"?"#ffc107":O;x.beginPath(),x.arc(xt,it,ke,0,Math.PI*2),x.strokeStyle=jt,x.lineWidth=5,x.stroke();try{const Mt=await DD(ss);x.save(),x.beginPath(),x.arc(xt,it,ke-6,0,Math.PI*2),x.clip();const St=(ke-6)*2;x.drawImage(Mt,xt-ke+6,it-ke+6,St,St),x.restore()}catch{x.textAlign="center",x.textBaseline="middle",x.fillStyle=O,x.font="bold 80px 'Orbitron', sans-serif",x.fillText(e==="badge"?"":"MCF",xt,it)}let ie=qe;x.textAlign="center",x.textBaseline="alphabetic",x.fillStyle=K,x.font=`bold ${T}px 'Orbitron', sans-serif`;for(const Mt of Ve)x.fillText(Mt,p/2,ie),ie+=M;if($e.length>0){ie+=V,x.fillStyle=B,x.font=`500 ${I}px 'Montserrat', sans-serif`;for(const Mt of $e)x.fillText(Mt,p/2,ie),ie+=L}ie+=A,x.fillStyle=K,x.font=`bold ${Oe}px 'Montserrat', sans-serif`;for(const Mt of P)x.fillText(Mt,p/2,ie),ie+=ht;return ie+=H,x.fillStyle=O,x.font=`600 ${fe}px 'Montserrat', sans-serif`,x.fillText("Make It Count with Core Buddy",p/2,ie),new Promise(Mt=>{y.toBlob(St=>Mt(St),"image/png")})}function C2(n,e,t,i,l,u){n.beginPath(),n.moveTo(e+u,t),n.lineTo(e+i-u,t),n.quadraticCurveTo(e+i,t,e+i,t+u),n.lineTo(e+i,t+l-u),n.quadraticCurveTo(e+i,t+l,e+i-u,t+l),n.lineTo(e+u,t+l),n.quadraticCurveTo(e,t+l,e,t+l-u),n.lineTo(e,t+u),n.quadraticCurveTo(e,t,e+u,t),n.closePath()}function DD(n){return new Promise((e,t)=>{const i=new Image;i.crossOrigin="anonymous",i.onload=()=>e(i),i.onerror=t,i.src=n})}function ou(n,e,t){if(n.measureText(e).width<=t)return[e];const i=e.split(" "),l=[];let u="";for(const d of i){const p=u?`${u} ${d}`:d;n.measureText(p).width>t&&u?(l.push(u),u=d):u=p}return u&&l.push(u),l}function PD(){const n=b.useRef(null),e=b.useCallback(()=>{if(!n.current)try{n.current=new(window.AudioContext||window.webkitAudioContext)}catch{}const u=n.current;return u?.state==="suspended"&&u.resume(),u},[]),t=b.useCallback(()=>{navigator.vibrate&&navigator.vibrate([40,60,30]);const u=e();if(!u)return;const d=u.currentTime,p=u.createBiquadFilter();p.type="lowpass",p.frequency.value=500,p.Q.value=.7,p.connect(u.destination);const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=50,y.gain.value=.3,y.gain.setTargetAtTime(0,d+.08,.04),g.connect(y).connect(p),g.start(d),g.stop(d+.2);const x=u.createOscillator(),_=u.createGain();x.type="sine",x.frequency.value=70,_.gain.value=.2,_.gain.setTargetAtTime(0,d+.22,.04),x.connect(_).connect(p),x.start(d+.15),x.stop(d+.35)},[e]),i=b.useCallback(()=>{navigator.vibrate&&navigator.vibrate(30);const u=e();if(!u)return;const d=u.currentTime,p=u.createBiquadFilter();p.type="lowpass",p.frequency.value=500,p.Q.value=.7,p.connect(u.destination);const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=55,y.gain.value=.35,y.gain.setTargetAtTime(0,d+.08,.04),g.connect(y).connect(p),g.start(d),g.stop(d+.2)},[e]),l=b.useCallback(()=>{navigator.vibrate&&navigator.vibrate([50,80,100]);const u=e();u&&[0,.12].forEach((d,p)=>{const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=p===0?523:784,y.gain.value=.12,y.gain.setTargetAtTime(0,u.currentTime+d+.15,.02),g.connect(y).connect(u.destination),g.start(u.currentTime+d),g.stop(u.currentTime+d+.2)})},[e]);return b.useEffect(()=>()=>{n.current?.close()},[]),{tap:i,tick:t,complete:l}}const LD=2e3,Lg=42,Fl=2*Math.PI*Lg,OD=1200,R2=["Another one in the bank!","Consistency beats everything.","You showed up  that's what counts.","Stronger every session."];function Zh({title:n,subtitle:e,stats:t,onDone:i,onDismissStart:l,onShareJourney:u,userName:d,buttonLabel:p="Done",holdLabel:g="Hold To Complete Session",shareType:y="workout",hideShare:x=!1}){const[_,j]=b.useState("hold"),[O,K]=b.useState(!1),[B,D]=b.useState(0),[se,Y]=b.useState(!1),[Z,je]=b.useState(!1),[Re,ke]=b.useState(null),C=PD(),T=b.useRef(null),M=b.useRef(null),V=b.useRef(null),I=b.useRef(null),L=b.useRef(!1),A=b.useRef(!1),Oe=b.useRef(0),ht=b.useRef(R2[Math.floor(Math.random()*R2.length)]),H=b.useRef([...Array(80)].map((Ue,Ie)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#ffffff","#000000"][Ie%3],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:Ie%3}))),fe=b.useCallback(()=>{if(L.current)return;L.current=!0,A.current=!1,Oe.current=0,K(!0),D(0),I.current=performance.now(),C.tap(),T.current&&(T.current.style.strokeDashoffset=Fl);const Ue=Ie=>{const mt=Ie-I.current,xt=Math.min(mt/LD,1);if(T.current&&(T.current.style.strokeDashoffset=Fl-xt*Fl),M.current){const it=8*(1-xt),ss=1-xt,Rs=1+xt*.15;M.current.style.filter=`blur(${it}px) grayscale(${ss})`,M.current.style.transform=`scale(${Rs})`}D(xt),mt-Oe.current>=OD&&(Oe.current=mt,C.tick()),xt<1?V.current=requestAnimationFrame(Ue):(L.current=!1,A.current=!0,V.current=null,K(!1),D(1),C.complete(),j("celebrate"))};V.current=requestAnimationFrame(Ue)},[C]),Ve=b.useCallback(()=>{L.current&&(L.current=!1,V.current&&(cancelAnimationFrame(V.current),V.current=null),T.current&&(T.current.style.strokeDashoffset=Fl),M.current&&(M.current.style.filter="",M.current.style.transform=""),K(!1),D(0))},[]),$e=b.useCallback(()=>{Y(!0),l?.(),setTimeout(()=>{i?.()},300)},[i,l]),J=b.useCallback(()=>{const Ue=[n||"Workout Complete!"];return e&&Ue.push(e),t?.length&&Ue.push(t.map(Ie=>`${Ie.value} ${Ie.label}`).join(" | ")),Ue.push("#MindCoreFitness"),Ue.join(`
`)},[n,e,t]),P=b.useCallback(async()=>{if(!(Z||!u))try{await u({type:y==="habits"?"habits_summary":"workout_summary",title:n||"Workout Complete!",subtitle:e,stats:t||[],quote:ht.current}),je(!0),ke("Posted to Journey!"),setTimeout(()=>ke(null),2500)}catch(Ue){console.error("Journey post failed:",Ue),ke(Ue?.message||"Failed to post"),setTimeout(()=>ke(null),3500)}},[Z,u,n,e,t]),[re,Fe]=b.useState(!1),qe=b.useCallback(async()=>{Fe(!0);try{const Ue=await nb({type:y||"workout",title:n||"Workout Complete!",subtitle:e,stats:t||[],quote:ht.current,userName:d}),Ie=J();if(navigator.share&&navigator.canShare?.({files:[new File([Ue],"workout.png",{type:"image/png"})]})){const mt=new File([Ue],"workout.png",{type:"image/png"});await navigator.share({title:"Mind Core Fitness",text:Ie,files:[mt]})}else navigator.share?await navigator.share({title:"Mind Core Fitness",text:Ie}):(await navigator.clipboard.writeText(Ie),ke("Copied to clipboard!"),setTimeout(()=>ke(null),2500))}catch{try{await navigator.clipboard.writeText(J()),ke("Copied to clipboard!"),setTimeout(()=>ke(null),2500)}catch{}}finally{Fe(!1)}},[n,e,t,d,J]);return _==="hold"?r.jsxs("div",{className:"wc-hold-page",children:[r.jsx("div",{className:"wc-hold-glow","aria-hidden":"true"}),r.jsx("p",{className:"wc-hold-label",children:g}),r.jsxs("div",{className:`wc-hold-ring-touch ${O?"wc-holding":""}`,onPointerDown:Ue=>{Ue.preventDefault(),fe()},onPointerUp:Ve,onPointerLeave:Ve,onPointerCancel:Ve,onClick:Ue=>{Ue.stopPropagation(),A.current&&(A.current=!1)},role:"button",tabIndex:0,"aria-label":"Press and hold to finish workout",onKeyDown:Ue=>{(Ue.key==="Enter"||Ue.key===" ")&&(Ue.preventDefault(),C.complete(),j("celebrate"))},children:[r.jsx("div",{className:"wc-hold-ring-glow","aria-hidden":"true"}),r.jsxs("svg",{className:"wc-hold-ring-svg",viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"wc-hold-ring-track",cx:"50",cy:"50",r:Lg}),r.jsx("circle",{className:"wc-hold-ring-fill",ref:T,cx:"50",cy:"50",r:Lg,style:{strokeDasharray:Fl,strokeDashoffset:Fl}})]}),r.jsx("img",{ref:M,src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-hold-logo",draggable:!1})]})]}):r.jsxs("div",{className:`wc-celeb-overlay ${se?"wc-celeb-dismissing":""}`,children:[r.jsx("div",{className:"wc-celeb-confetti","aria-hidden":"true",children:H.current.map((Ue,Ie)=>r.jsx("span",{className:`wc-celeb-confetti-piece wc-confetti-shape-${Ue.shape}`,style:{"--x":`${Ue.x}%`,"--delay":`${Ue.delay}s`,"--color":Ue.color,"--drift":`${Ue.drift}px`,"--spin":`${Ue.spin}deg`,"--duration":`${Ue.duration}s`,width:`${Ue.width}px`,height:`${Ue.height}px`}},Ie))}),r.jsxs("div",{className:"wc-celeb-content",children:[r.jsx("div",{className:"wc-celeb-logo-frame",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-celeb-logo-img"})}),r.jsx("h2",{className:"wc-celeb-heading",children:n||"Congratulations!"}),e&&r.jsx("p",{className:"wc-celeb-subtext",children:e}),r.jsx("p",{className:"wc-celeb-quote",children:ht.current}),t&&t.length>0&&r.jsx("div",{className:"wc-celeb-stats-row",children:t.map((Ue,Ie)=>r.jsxs("div",{className:"wc-celeb-stat",children:[r.jsx("span",{className:"wc-celeb-stat-val",children:Ue.value}),r.jsx("span",{className:"wc-celeb-stat-label",children:Ue.label})]},Ie))}),!x&&r.jsxs("div",{className:"wc-share-row",children:[u&&r.jsxs("button",{className:`wc-share-btn wc-share-journey ${Z?"wc-share-done":""}`,onClick:P,disabled:Z,children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20h9"}),r.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4Z"})]}),Z?"Posted!":"Post to Journey"]}),r.jsxs("button",{className:"wc-share-btn wc-share-external",onClick:qe,disabled:re,children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"18",cy:"5",r:"3"}),r.jsx("circle",{cx:"6",cy:"12",r:"3"}),r.jsx("circle",{cx:"18",cy:"19",r:"3"}),r.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),r.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),re?"Generating...":"Share"]})]}),r.jsx("button",{className:"wc-celeb-btn",onClick:$e,children:p}),Re&&r.jsx("div",{className:"wc-share-toast",children:Re})]})]})}const A2="/login/assets/randomiser-glq9YJkL.jpg",M2="/login/assets/programme-card-workout-CnNzTYkz.webp",BD="/login/assets/prog-fullbody-4wk-r6m9HJys.jpg",VD="/login/assets/muscle-group-arms-C9AdZL4-.png",UD="/login/assets/arms-bicep-BUrmT1o-.png",FD="/login/assets/arms-tricep-D9tAnFnS.png",zD="/login/assets/arms-full-arms-BY3TvpJm.png",qD="/login/assets/muscle-group-chest-Cxfuc7XI.png",HD="/login/assets/chest-strength-BR4BAFTH.png",$D="/login/assets/chest-hypertrophy-B8yNrvjB.png",WD="/login/assets/chest-endurance-e-OSWtWO.png",GD="/login/assets/muscle-group-shoulders-DibNtCLF.png",KD="/login/assets/shoulders-strength-CKlZBF5A.png",YD="/login/assets/shoulders-hypertrophy-BUd76jiS.png",QD="/login/assets/shoulders-endurance-HuqNG5rD.png",XD="/login/assets/muscle-group-core-CPR-bdRg.png",JD="/login/assets/core-lower-abs-TVcqGMFJ.png",ZD="/login/assets/core-obliques-rotation-Djb7Qlbk.png",e6="/login/assets/core-weighted-core-4Kwh9mTv.png",t6="/login/assets/muscle-group-back-8JPV-YUo.png",s6="/login/assets/back-strength-BmSRxnwo.png",n6="/login/assets/back-hypertrophy-CXHmsnCz.png",r6="/login/assets/back-endurance-C8qJ8l5I.png",a6="/login/assets/muscle-group-legs-B8jcbdov.png",i6="/login/assets/legs-quads-DbnfsebI.png",o6="/login/assets/legs-hamstrings-glutes-BrfsvvzX.png",l6="/login/assets/legs-power-plyo-D2qBXeUR.png",c6=60,Kp=5,u6=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],d6={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Squeeze Press":"push","Incline Dumbbell Press":"push","Dumbbell Fly":"push","Dumbbell Pullover":"push","Tricep Kickback":"push","Dumbbell Shrug":"push","Dumbbell Y-Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Wide Dumbbell Bent Over Row":"pull","Reverse Fly":"pull","Concentration Curl":"pull","Wide Grip Bicep Curl":"pull","Wrist Curl":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core","Kettlebell Bird Dog Drag":"core"},h6={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},m6={fullbody:"linear-gradient(160deg, rgba(153,49,60,0.15) 0%, rgba(153,49,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",upper:"linear-gradient(160deg, rgba(100,60,140,0.2) 0%, rgba(100,60,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",lower:"linear-gradient(160deg, rgba(40,120,80,0.2) 0%, rgba(40,120,80,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)"},Yp={arms:"linear-gradient(160deg, rgba(180,60,60,0.2) 0%, rgba(180,60,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",chest:"linear-gradient(160deg, rgba(50,100,160,0.2) 0%, rgba(50,100,160,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",back:"linear-gradient(160deg, rgba(80,130,60,0.2) 0%, rgba(80,130,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",shoulders:"linear-gradient(160deg, rgba(160,100,40,0.2) 0%, rgba(160,100,40,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",legs:"linear-gradient(160deg, rgba(100,50,140,0.2) 0%, rgba(100,50,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)"},Qp=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,level:"All Levels",daysPerWeek:3,image:BD},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,level:"Intermediate",daysPerWeek:3},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,level:"Advanced",daysPerWeek:3},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,level:"Beginner",daysPerWeek:3},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,level:"Intermediate",daysPerWeek:3},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,level:"Advanced",daysPerWeek:3},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,level:"Intermediate",daysPerWeek:3},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,level:"Intermediate",daysPerWeek:3}],lu=[{key:"arms",label:"Arms",icon:"M7 5h2v14H7V5zm8 0h2v14h-2V5zm-5 4h4v6h-4V9z",image:VD},{key:"chest",label:"Chest",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15H9v-2h2v2zm4 0h-2v-2h2v2zm3-6c0 1.1-.36 2.12-.97 2.95l-.87-.87C16.7 12.53 17 11.8 17 11c0-2.76-2.24-5-5-5S7 8.24 7 11c0 .8.3 1.53.84 2.08l-.87.87A4.977 4.977 0 0 1 6 11c0-3.31 2.69-6 6-6s6 2.69 6 6z",image:qD},{key:"back",label:"Back",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm4 18H8v-6l-4-4 1.41-1.41L8 11.17V8h8v3.17l2.59-2.58L20 10l-4 4v6z",image:t6},{key:"shoulders",label:"Shoulders",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z",image:GD},{key:"legs",label:"Legs",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z",image:a6},{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z",image:XD}],I2={chest:[{id:"chest_strength",name:"Chest Strength",desc:"Heavy pressing for max strength",image:HD,level:"Intermediate",overview:"A heavy pressing session designed to build raw chest strength. Focus on controlled negatives and powerful pressing movements.",tips:["Go heavy  pick a weight where the last 2 reps are a real challenge","Control the negative (lowering phase) for 2-3 seconds","Keep your shoulder blades squeezed together throughout all pressing movements","Rest 90-120 seconds between sets to allow full recovery"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Squeeze Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"chest_hypertrophy",name:"Chest Hypertrophy",desc:"Volume training for muscle growth",image:$D,level:"Intermediate",overview:"A high-volume chest session focused on time under tension and muscle growth. Lighter weights, more reps, and slow controlled movements.",tips:["Use moderate weight  you should feel the burn by rep 10","Squeeze your chest at the top of every rep for 1 second","Keep rest periods short at 60-90 seconds to keep the pump going","On press ups, go to failure on the final set"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Press Up",type:"reps",sets:3,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"}]},{id:"chest_endurance",name:"Chest Endurance",desc:"Bodyweight pushing to failure",image:WD,level:"All Levels",overview:"No weights needed. This bodyweight-only session builds chest endurance and muscular stamina through high-rep push up variations.",tips:["Focus on full range of motion  chest to floor on every rep","Keep your core tight and body in a straight line throughout","Scale down to knee press ups if you can't maintain form","Push through the burn  the last 5 reps are where the growth happens"],exercises:[{name:"Press Up",type:"reps",sets:4,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null},{name:"Decline Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Press Up Hold",type:"timed",sets:3,time:30,storagePath:null}]}],back:[{id:"back_strength",name:"Back Strength",desc:"Heavy rows for a thick back",image:s6,level:"Intermediate",overview:"Build a thick, powerful back with heavy rowing movements. This session targets your lats, rhomboids, and traps for overall back development.",tips:["Go heavy on rows  use a weight that challenges you by rep 6-8","Drive your elbows back and squeeze your shoulder blades together at the top","Keep a slight bend in your knees and hinge at the hips for bent over movements","Rest 90-120 seconds between sets for full recovery"],exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"back_hypertrophy",name:"Back Hypertrophy",desc:"Width and thickness volume work",image:n6,level:"Intermediate",overview:"A volume-focused back session combining rows and isolation moves to build width and thickness. Focus on the mind-muscle connection.",tips:["Use moderate weight  feel the stretch and squeeze on every rep","On renegade rows, keep your hips square to the floor and avoid rotating","For reverse flys, use lighter weight and focus on squeezing your rear delts","Keep rest to 60-90 seconds to maintain intensity"],exercises:[{name:"Renegade Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Reverse Fly",type:"weighted",sets:3,reps:15,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null}]},{id:"back_endurance",name:"Back Endurance",desc:"Bodyweight back conditioning",image:r6,level:"All Levels",overview:"A bodyweight session to strengthen your posterior chain and improve posture. Great for back health, mobility, and muscular endurance.",tips:["On superman holds, lift your arms and legs simultaneously and hold tight","Focus on slow, controlled movements  quality over speed","Breathe steadily throughout timed holds  don't hold your breath","Engage your glutes and lower back together on every movement"],exercises:[{name:"Superman Hold",type:"timed",sets:4,time:30,storagePath:"exercises/bodyweight/upper/Superman Hold.mp4"},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:12,storagePath:null},{name:"Reverse Snow Angel",type:"reps",sets:3,reps:12,storagePath:null},{name:"Bird Dog",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Back Extension Hold",type:"timed",sets:3,time:30,storagePath:null}]}],shoulders:[{id:"shoulders_strength",name:"Shoulder Strength",desc:"Heavy pressing for boulder shoulders",image:KD,level:"Intermediate",overview:"A heavy overhead pressing session to build strong, powerful shoulders. Compound movements first, followed by isolation work for all three delt heads.",tips:["Go heavy on presses  pick a weight where you struggle on the last 2 reps","Brace your core and avoid arching your back during overhead movements","Press straight up and control the weight down slowly","Rest 90-120 seconds between pressing sets, 60 seconds for isolation moves"],exercises:[{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"shoulders_hypertrophy",name:"Shoulder Hypertrophy",desc:"Volume and isolation for 3D delts",image:YD,level:"Intermediate",overview:"A high-volume session targeting all three heads of the deltoid for that 3D capped shoulder look. Moderate weight, high reps, constant tension.",tips:["Use lighter weight than you think  shoulders respond best to high reps","On lateral raises, lead with your elbows and don't swing the weight","Pause at the top of each raise for a 1-second squeeze","Keep rest periods at 60 seconds to maximise the pump"],exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Y-Raise",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"shoulders_endurance",name:"Shoulder Endurance",desc:"Bodyweight and high-rep work",image:QD,level:"All Levels",overview:"A shoulder endurance session combining bodyweight movements with high-rep dumbbell work. Builds stamina, stability, and shoulder resilience.",tips:["On pike push ups, walk your feet close to your hands to increase the angle","For high-rep lateral raises, use a very light weight and focus on form","Wall walks are advanced  scale to pike push ups if needed","Keep your core braced throughout to protect your lower back"],exercises:[{name:"Pike Push Ups",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/upper/pike push ups.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,reps:20,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Wall Walks",type:"reps",sets:3,reps:6,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null},{name:"Shoulder Tap Hold",type:"timed",sets:3,time:30,storagePath:null}]}],arms:[{id:"arms_bicep",name:"Bicep Focus",desc:"Curl variations for peak biceps",image:UD,level:"All Levels",overview:"An arm session dedicated entirely to biceps. Multiple curl variations target different parts of the bicep for maximum peak and thickness.",tips:["Keep your elbows pinned to your sides  no swinging","Control the negative (lowering) for 2-3 seconds on every rep","Start with your heaviest weight and decrease as you fatigue","Squeeze hard at the top of each curl for a full contraction"],exercises:[{name:"Bicep Curl",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Concentration Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Isometric Bicep Hold",type:"timed",sets:3,time:20,storagePath:null}]},{id:"arms_tricep",name:"Tricep Focus",desc:"Extensions and dips for horseshoe triceps",image:FD,level:"All Levels",overview:"All-out tricep training with extensions, dips, and pressing movements. The triceps make up two-thirds of your arm  this session builds serious size.",tips:["On overhead extensions, keep your elbows close to your head","For skullcrushers, lower the weight slowly to just above your forehead","On dips, lean slightly forward to reduce shoulder strain","Full lockout at the top of every extension for maximum tricep contraction"],exercises:[{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Tricep Dips",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null}]},{id:"arms_full",name:"Full Arms",desc:"Superset biceps and triceps",image:zD,level:"All Levels",overview:"A balanced arm session alternating between biceps and triceps. Superset style keeps the intensity high and maximises the pump.",tips:["Superset each pair  do biceps then immediately hit triceps","Use moderate weight that lets you maintain strict form for all reps","Rest 60 seconds after each superset pair","Focus on the squeeze at the peak contraction of every rep"],exercises:[{name:"Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Wrist Curl",type:"weighted",sets:3,reps:15,storagePath:null}]}],legs:[{id:"legs_quad",name:"Quad Dominant",desc:"Squats and lunges for quad power",image:i6,level:"All Levels",overview:"A quad-focused leg session built around squats and lunges. Heavy compound movements to build strong, powerful quads and overall leg strength.",tips:["On goblet squats, hold the dumbbell close to your chest and sit deep","Keep your knees tracking over your toes  don't let them cave inward","Drive through your heels on all squatting movements","Rest 90-120 seconds between heavy sets, 60 seconds on bodyweight moves"],exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/lower/bulgarian split squats.mp4"},{name:"Squat And Hold",type:"timed",sets:3,time:30,storagePath:"exercises/bodyweight/lower/squat and hold.mp4"}]},{id:"legs_ham_glute",name:"Hamstring & Glute",desc:"Posterior chain focus",image:o6,level:"Intermediate",overview:"Target the back of your legs with deadlift and hip hinge variations. This session builds a strong posterior chain  hamstrings, glutes, and lower back.",tips:["On RDLs, push your hips back and feel the stretch in your hamstrings","Keep a slight bend in your knees throughout hip hinge movements","Squeeze your glutes hard at the top of every rep","For single leg work, start with your weaker side first"],exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/romanian deadlifts.mp4"},{name:"1 Legged RDL",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.mp4"},{name:"Hip Thrusts",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/hip thrusts.mp4"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.mp4"},{name:"Donkey Kicks",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.mp4"}]},{id:"legs_power",name:"Power & Plyo",desc:"Explosive leg training",image:l6,level:"Intermediate",overview:"An explosive leg session combining plyometrics with weighted movements. Build power, speed, and athletic performance.",tips:["On jump squats, land softly with bent knees to absorb the impact","Explode up on every rep  power comes from speed, not just weight","Keep rest periods at 60-90 seconds to maintain intensity","Focus on landing mechanics  knees out, chest up, soft landing"],exercises:[{name:"Jump Squats",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/lower/jump squats.mp4"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Skater Jumps",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/skater jumps.mp4"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.mp4"}]}],core:[{id:"core_lower_abs",name:"Lower Abs Blast",desc:"40s work / 20s rest  3 rounds",image:JD,level:"Intermediate",overview:"An interval-based core burner targeting the lower abdominals. 40 seconds of work followed by 20 seconds of rest  keep the intensity high and your lower back pressed into the floor throughout.",tips:["Press your lower back firmly into the floor on every rep","Exhale hard as you contract your abs  don't hold your breath","If your lower back lifts off the ground, reduce the range of motion","Focus on slow, controlled movements rather than speed"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Leg Raises",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Reverse Crunch To Leg Raise",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Flutter Kicks",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Dead Bug Single Leg Drop",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Hollow Hold Flutter Kicks",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"}]},{id:"core_obliques",name:"Obliques & Rotation",desc:"35s work / 25s rest  3 rounds",image:ZD,level:"Intermediate",overview:"Target the obliques and rotational core muscles with this interval session. 35 seconds of work with 25 seconds rest  every exercise involves twisting, rotating, or side-bracing movements.",tips:["Rotate from your ribcage, not just your arms","Keep your hips as still as possible during twisting exercises","Brace your core before each movement  think about squeezing a belt","On side planks, stack your hips and push the floor away"],interval:!0,rounds:3,work:35,rest:25,exercises:[{name:"Russian Twist",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank Rotation",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Cross Body Mountain Climbers",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Hip Dips Plank",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Bicycle Crunch",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank",storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{id:"core_weighted",name:"Weighted Core",desc:"40s work / 20s rest  3 rounds",image:e6,level:"Advanced",overview:"Add resistance to your core training with dumbbells and kettlebells. 40 seconds of weighted work followed by 20 seconds rest  this session builds serious core strength and stability.",tips:["Start with a moderate weight  form is more important than load","Brace your entire core before picking up the weight each round","Keep movements controlled  no swinging or using momentum","If grip fails before core does, go slightly lighter next time"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Russian Twists Dumbbell",storagePath:"exercises/dumbbells/core/russian twists dumbbell.mp4"},{name:"Kettlebell Russian Twist",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Dumbbell Plank Pull Through",storagePath:null}]}]},Xp=[{key:"bodyweight",label:"Bodyweight",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"},{key:"dumbbells",label:"Dumbbells",icon:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"},{key:"kettlebells",label:"Kettlebells",icon:"M12 2C9.24 2 7 4.24 7 7c0 1.1.36 2.12.97 2.95C6.76 11.08 6 12.96 6 15c0 3.87 2.69 7 6 7s6-3.13 6-7c0-2.04-.76-3.92-1.97-5.05.61-.83.97-1.85.97-2.95 0-2.76-2.24-5-5-5zm0 2c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"}],oa=[{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"},{key:"upper",label:"Upper",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"lower",label:"Lower",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"fullbody",label:"Full Body",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z"},{key:"mix",label:"Mix It Up",icon:"M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm-.83 9.41l-1.42 1.42L17.96 20.54l1.42-1.42-5.71-5.71z"}],Va=[{key:"beginner",label:"Beginner",work:30,rest:30,desc:"30s work / 30s rest"},{key:"intermediate",label:"Intermediate",work:40,rest:20,desc:"40s work / 20s rest"},{key:"advanced",label:"Advanced",work:40,rest:15,desc:"40s work / 15s rest"}],Jp=[5,10,15,20,30],Zp={core:"#e85d04",upper:"#2196f3",lower:"#4caf50",fullbody:"#9c27b0",mix:"#ff9800"},D2=["Mix up your focus areas to build balanced strength.","Consistency beats intensity  show up and press play.","Try a new difficulty level to keep your body guessing.","Short on time? A 5-minute blast still counts.","Save your favourite combos so you can replay them anytime.","Your body adapts  switch equipment for fresh stimulus.","Rest days are growth days. Listen to your body.","Challenge yourself: go one level higher this week."];function f6(n){return n.replace(/\b\w/g,e=>e.toUpperCase())}function p6(n){const e=[...n];for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return e}function g6(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Lr(),{isDark:l,toggleTheme:u,accent:d}=Ca(),{isPremium:p,FREE_RANDOMISER_DURATIONS:g,FREE_RANDOMISER_WEEKLY_LIMIT:y}=yc(),x=rr(),[_,j]=b.useState("menu"),[O,K]=b.useState(["bodyweight"]),[B,D]=b.useState("core"),[se,Y]=b.useState("intermediate"),[Z,je]=b.useState(p?15:5),[Re,ke]=b.useState([]),[C,T]=b.useState(!1),M=b.useRef(!1),V=b.useRef([]),[I,L]=b.useState([]),[A,Oe]=b.useState(2),[ht,H]=b.useState(Va[1]),[fe,Ve]=b.useState(1),[$e,J]=b.useState(0),[P,re]=b.useState("work"),[Fe,qe]=b.useState(0),[Ue,Ie]=b.useState(!1),[mt,xt]=b.useState(0),[it,ss]=b.useState(!1),[Rs,Ut]=b.useState(!1),[jt,ie]=b.useState(null),Mt=b.useRef(null);b.useRef(null),b.useRef(null);const[St,Yt]=b.useState(null),Tt=b.useCallback((z,pe="info")=>{Yt({message:z,type:pe}),setTimeout(()=>Yt(null),3e3)},[]),Et=b.useCallback(async z=>{if(!t)throw new Error("Not signed in");const pe=z&&typeof z=="object"&&z.type;await Kr(qt(ye,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:pe?"":z,type:pe?z.type:"text",imageURL:null,createdAt:yr(),likeCount:0,commentCount:0,...pe?{metadata:{title:z.title||"",subtitle:z.subtitle||"",stats:z.stats||[],quote:z.quote||"",badges:z.badges||[]}}:{}})},[t]),[ot,Pt]=b.useState(null),[Gt,ps]=b.useState(null),[Kt,It]=b.useState(0),[hs,ws]=b.useState(0),[is,Xs]=b.useState([]),[Ps,qs]=b.useState(""),[os,_s]=b.useState(""),[ve,De]=b.useState(!1),[Pe,st]=b.useState(0),[Ge,nt]=b.useState(!1),[gt,X]=b.useState({}),ne=b.useRef(null),Ke=b.useRef(null),[wt,et]=b.useState([]),[_t,Q]=b.useState(null),[Ae,Je]=b.useState(0),[yt,at]=b.useState(0),[Zt,Qt]=b.useState(0),[U,be]=b.useState(0),[Ee,Te]=b.useState(0),[Se,bt]=b.useState(0),[Ct,ft]=b.useState({beginner:0,intermediate:0,advanced:0}),zt=p?Jp:Jp.filter(z=>g.includes(z)),Lt=!p&&Ae>=y,[Bs,hn]=b.useState([]),[rn,Tn]=b.useState(!1),[As,sn]=b.useState(!1),[ks,W]=b.useState(!1),[de,le]=b.useState(""),[we,S]=b.useState(null),[F,ae]=b.useState([]),[te,Ze]=b.useState({total:0,favouriteFocus:null,streak:0}),[ut,lt]=b.useState(null),[Dt,vt]=b.useState(""),[gs,ln]=b.useState(!1);b.useEffect(()=>{!i&&(!n||!e)&&x("/")},[n,e,i,x]),b.useEffect(()=>{if(!n||!t)return;(async()=>{try{const pe=qt(ye,"workoutLogs"),he=Ds(pe,bs("clientId","==",t.id)),We=(await Es(he)).docs.map(tt=>tt.data()),rt=We.filter(tt=>tt.type!=="programme");be(rt.length);const dt=rt.reduce((tt,Ye)=>tt+(Ye.duration||0),0);Te(dt);const Ot={beginner:0,intermediate:0,advanced:0};rt.forEach(tt=>{tt.level&&Ot[tt.level]!==void 0&&Ot[tt.level]++}),ft(Ot);const es=new Date,ls=es.getDay(),ts=ls===0?-6:1-ls,E=new Date(es);E.setDate(es.getDate()+ts),E.setHours(0,0,0,0);const $=E.getTime(),ge=We.filter(tt=>{const Ye=tt.completedAt;return Ye?(Ye.toDate?Ye.toDate().getTime():new Date(Ye).getTime())>=$:!1});Je(ge.filter(tt=>tt.type!=="programme").length);let Me=0;if(t)try{const tt=await Ls(Xe(ye,"clientProgrammes",t.id));if(tt.exists()){const Ye=tt.data(),Ft=Ye.templateId;Me=ge.filter($t=>$t.type==="programme"&&$t.programmeId===Ft).length,lt(Ft);const Ht=Qp.find($t=>$t.id===Ft);Ht&&vt(Ht.name);const ms=h6[Ft];if(ms){const $t=Object.keys(Ye.completedSessions||{}).length,cs=ms.duration*ms.daysPerWeek;Qt(cs>0?Math.round($t/cs*100):0)}}else lt(null),vt(""),Qt(0)}catch{}at(Me);const Qe=rt.map(tt=>tt.completedAt).filter(Boolean).map(tt=>tt.toDate?tt.toDate().getTime():new Date(tt).getTime()).sort((tt,Ye)=>Ye-tt);if(Qe.length===0)bt(0);else{const tt=new Set;Qe.forEach(cs=>{const Ln=new Date(cs),Gn=Ln.getDay(),Js=Gn===0?-6:1-Gn,Zs=new Date(Ln);Zs.setDate(Ln.getDate()+Js),Zs.setHours(0,0,0,0),tt.add(Zs.getTime())});const Ye=[...tt].sort((cs,Ln)=>Ln-cs);let Ft=0;const Ht=new Date(es),ms=es.getDay()===0?-6:1-es.getDay();Ht.setDate(es.getDate()+ms),Ht.setHours(0,0,0,0);let $t=Ht.getTime();Ye.includes($t)||($t-=10080*60*1e3);for(let cs=0;cs<200&&Ye.includes($t);cs++)Ft++,$t-=10080*60*1e3;bt(Ft)}}catch(pe){console.error("Error loading workout stats:",pe)}finally{ln(!0)}})()},[n,t,_]),b.useEffect(()=>{if(!n||!t)return;(async()=>{try{const pe=Ds(qt(ye,"savedWorkouts"),bs("clientId","==",t.id),oc("savedAt","desc")),he=await Es(pe);hn(he.docs.map(Ce=>({id:Ce.id,...Ce.data()})))}catch(pe){console.error("Error loading saved workouts:",pe)}finally{Tn(!0)}})()},[n,t]),b.useEffect(()=>{if(!n||!t)return;(async()=>{try{const pe=Ds(qt(ye,"workoutLogs"),bs("clientId","==",t.id),oc("completedAt","desc"),Pu(20)),We=(await Es(pe)).docs.map(ge=>ge.data()).filter(ge=>ge.type!=="programme"&&ge.type!=="muscle_group");ae(We.slice(0,3));const rt=We.length,dt={};We.forEach(ge=>{ge.focus&&(dt[ge.focus]=(dt[ge.focus]||0)+1)});const Ot=Object.keys(dt).sort((ge,Me)=>dt[Me]-dt[ge])[0]||null;let es=0;if(We.length>0){const ge=new Set;We.forEach(tt=>{const Ye=tt.completedAt?.toDate?tt.completedAt.toDate():tt.completedAt?new Date(tt.completedAt):null;Ye&&ge.add(new Date(Ye.getFullYear(),Ye.getMonth(),Ye.getDate()).toDateString())});const Me=new Date;Me.setHours(0,0,0,0);let Qe=new Date(Me);for(ge.has(Qe.toDateString())||Qe.setDate(Qe.getDate()-1);ge.has(Qe.toDateString());)es++,Qe.setDate(Qe.getDate()-1)}Ze({total:rt,favouriteFocus:Ot,streak:es});const ls={core:null,upper:null,lower:null,fullbody:null};We.forEach(ge=>{if(ge.focus&&ls[ge.focus]===null&&ge.completedAt){const Me=ge.completedAt.toDate?ge.completedAt.toDate():new Date(ge.completedAt);ls[ge.focus]=Me}});let ts=null,E=new Date;const $=["core","upper","lower","fullbody"];for(const ge of $){if(ls[ge]===null){const Me=oa.find(Qe=>Qe.key===ge)?.label||ge;ts={focus:ge,label:Me,daysAgo:null,message:`You haven't tried ${Me} yet`};break}if(ls[ge]<E){E=ls[ge];const Me=Math.floor((Date.now()-ls[ge].getTime())/864e5);if(Me>=5){const Qe=oa.find(tt=>tt.key===ge)?.label||ge;ts={focus:ge,label:Qe,daysAgo:Me,message:`${Qe}  ${Me} days ago`}}}}S(ts)}catch(pe){console.error("Error loading recent workouts:",pe)}})()},[n,t,_]);const hr=async z=>{if(!(!n||!t||I.length===0)){sn(!0);try{const pe=oa.find(We=>We.key===B)?.label||B,he=z||`${pe} ${Z}min`,Ce=await Kr(qt(ye,"savedWorkouts"),{clientId:t.id,name:he,equipment:O,focus:B,level:se,duration:Z,exercises:I.map(We=>({name:We.name,videoUrl:We.videoUrl,isGif:We.isGif||!1})),rounds:A,savedAt:Rt.now()});hn(We=>[{id:Ce.id,clientId:t.id,name:he,equipment:O,focus:B,level:se,duration:Z,exercises:I.map(rt=>({name:rt.name,videoUrl:rt.videoUrl,isGif:rt.isGif||!1})),rounds:A,savedAt:Rt.now()},...We]),Tt("Workout saved!","success")}catch(pe){console.error("Error saving workout:",pe),Tt("Failed to save workout","error")}finally{sn(!1),W(!1),le("")}}},ys=async z=>{try{await ur(Xe(ye,"savedWorkouts",z)),hn(pe=>pe.filter(he=>he.id!==z)),Tt("Workout removed","info")}catch(pe){console.error("Error deleting saved workout:",pe),Tt("Failed to remove workout","error")}},_r=z=>{K(z.equipment||["bodyweight"]),D(z.focus||"core"),Y(z.level||"intermediate"),je(z.duration||15);const pe=Va.find(he=>he.key===(z.level||"intermediate"));H(pe),L(z.exercises||[]),Oe(z.rounds||2),j("preview")},mr=async()=>{const z=JSON.parse(localStorage.getItem("mcf_last_randomiser")||"null");z&&(K(z.equipment||["bodyweight"]),D(z.focus||"core"),Y(z.level||"intermediate"),je(z.duration||15)),setTimeout(()=>Aa(),50)},da=()=>{localStorage.setItem("mcf_last_randomiser",JSON.stringify({equipment:O,focus:B,level:se,duration:Z}))};localStorage.getItem("mcf_last_randomiser");const Sn=()=>{const z=[];let pe;B==="mix"?pe=["core","upper","lower"]:B==="fullbody"?pe=["upper","lower"]:pe=[B];for(const he of O)for(const Ce of pe)z.push(`exercises/${he}/${Ce}`);return z},Ra=async()=>{if(M.current){for(;M.current;)await new Promise(z=>setTimeout(z,200));return V.current}M.current=!0,T(!0);try{const z=Sn(),pe=[];for(const rt of z)try{const dt=bi(vi,rt),Ot=await T2(dt);pe.push(...Ot.items)}catch{console.warn(`Folder ${rt} not found, skipping.`)}if(pe.length===0&&O.includes("bodyweight")&&B==="core")try{const rt=bi(vi,"core"),dt=await T2(rt);pe.push(...dt.items)}catch{console.warn("Legacy core/ folder not found either.")}if(pe.length===0){const rt=O.map(Ot=>Xp.find(es=>es.key===Ot)?.label).join(" + "),dt=oa.find(Ot=>Ot.key===B)?.label;return Tt(`No exercises found for ${rt} / ${dt}. Upload videos to Firebase Storage.`,"error"),M.current=!1,T(!1),[]}const he=new Set,Ce=pe.filter(rt=>{const dt=rt.name.replace(/\.(mp4|gif)$/i,"");return he.has(dt)?!1:(he.add(dt),!0)}),We=await Promise.all(Ce.map(async rt=>{const dt=await fo(rt),Ot=f6(rt.name.replace(/\.(mp4|gif)$/i,"")),es=/\.gif$/i.test(rt.name);return{name:Ot,videoUrl:dt,isGif:es}}));return V.current=We,ke(We),M.current=!1,T(!1),We}catch(z){console.error("Error loading exercises:",z);const pe=z.code==="storage/unauthorized"?"Storage access denied. Check Firebase Storage rules allow read access.":`Failed to load exercises: ${z.message||z.code||"Unknown error"}`;return Tt(pe,"error"),M.current=!1,T(!1),[]}},Aa=async()=>{if(Lt)return;da(),j("spinning"),V.current=[];const z=await Ra();if(z.length===0){j("setup");return}const pe=Va.find(ls=>ls.key===se);H(pe);const he=pe.work+pe.rest,Ce=Z*60,We=Math.floor(Ce/he);let rt,dt;We<=6?(rt=Math.max(3,Math.floor(We/2)),dt=Math.floor(We/rt)):We<=12?(rt=Math.min(6,Math.floor(We/2)),dt=Math.floor(We/rt)):(rt=Math.min(10,Math.floor(We/2)),dt=Math.floor(We/rt)),dt=Math.max(2,dt);const Ot=p6(z),es=Ot.slice(0,Math.min(rt,Ot.length));L(es),Oe(dt),setTimeout(()=>j("preview"),2e3)},Qr=()=>{j("countdown"),xt(3)};b.useEffect(()=>{if(_!=="countdown")return;if(mt<=0){j("workout"),Ve(1),J(0),re("work"),qe(ht.work),Ie(!1),qn();return}Dn();const z=setTimeout(()=>xt(pe=>pe-1),1e3);return()=>clearTimeout(z)},[mt,_]),b.useEffect(()=>{if(_!=="workout"||Ue)return;if(Fe<=0){Or();return}Fe<=3&&Dn();const z=setTimeout(()=>qe(pe=>pe-1),1e3);return()=>clearTimeout(z)},[Fe,_,Ue]);const Or=()=>{if(P==="work")re("rest"),qe(ht.rest);else{const z=$e+1;if(z>=I.length){const pe=fe+1;if(pe>A){ss(!0),Ja();return}Ve(pe),J(0)}else J(z);re("work"),qe(ht.work),qn()}},Ja=async()=>{if(n)try{await Kr(qt(ye,"workoutLogs"),{clientId:t.id,level:se,duration:Z,equipment:O,focus:B,exerciseCount:I.length,rounds:A,exercises:I.map(z=>z.name),completedAt:Rt.now()}),Je(z=>z+1),be(z=>z+1),Te(z=>z+Z),ft(z=>({...z,[se]:(z[se]||0)+1}))}catch(z){console.error("Error saving workout log:",z)}},Br=async(z,pe,he)=>{if(!(!t||!pe))try{const Ce=t.id,We=await Ls(Xe(ye,"coreBuddyPBs",Ce)),dt=(We.exists()?We.data():null)?.exercises||{},Ot=dt[z];let es=!1;if(Ot?(pe>(Ot.weight||0)||pe===(Ot.weight||0)&&he>(Ot.reps||0))&&(es=!0):es=!0,es){const ls={...dt,[z]:{weight:pe,reps:he,achievedAt:Rt.now()}};await Os(Xe(ye,"coreBuddyPBs",Ce),{clientId:t.id,exercises:ls,updatedAt:Rt.now()}),Tt(`New PB! ${pe}kg  ${he} reps`,"success"),Dn(),await zn(z,pe)}}catch(Ce){console.error("Error checking PB:",Ce)}},zn=async(z,pe)=>{if(t)try{const he=await Ls(Xe(ye,"coreBuddyTargets",t.id));if(!he.exists())return;const We=(he.data().targets||{})[z];if(!We||pe<We.targetWeight)return;const rt=await Ls(Xe(ye,"coreBuddyAchievements",t.id)),dt=rt.exists()?rt.data():{clientId:t.id,badges:[],totalVolume:0};if(dt.badges.some(ts=>ts.type==="pb_target"&&ts.exercise===z&&ts.targetWeight===We.targetWeight))return;const es={type:"pb_target",exercise:z,group:d6[z]||"push",targetWeight:We.targetWeight,achievedAt:Rt.now()},ls=[...dt.badges,es];await Os(Xe(ye,"coreBuddyAchievements",t.id),{...dt,badges:ls,updatedAt:Rt.now()}),et(ts=>[...ts,es])}catch(he){console.error("Error checking target badge:",he)}},Ai=async z=>{if(!(!t||z<=0))try{const pe=await Ls(Xe(ye,"coreBuddyAchievements",t.id)),he=pe.exists()?pe.data():{clientId:t.id,badges:[],totalVolume:0},Ce=he.totalVolume||0,We=Ce+z,rt=[];u6.forEach(Ot=>{We>=Ot.threshold&&Ce<Ot.threshold&&(he.badges.some(ls=>ls.type==="volume_milestone"&&ls.milestone===Ot.threshold)||rt.push({type:"volume_milestone",milestone:Ot.threshold,label:Ot.label,achievedAt:Rt.now()}))});const dt=[...he.badges,...rt];await Os(Xe(ye,"coreBuddyAchievements",t.id),{clientId:t.id,badges:dt,totalVolume:Math.round(We),updatedAt:Rt.now()}),rt.length>0&&et(Ot=>[...Ot,...rt])}catch(pe){console.error("Error updating volume:",pe)}},Za=async z=>{if(ps(z),z.interval){const Ce=[];for(const We of z.exercises){let rt=null,dt=!1;if(We.storagePath)try{const Ot=bi(vi,We.storagePath);rt=await fo(Ot),dt=/\.gif$/i.test(We.storagePath)}catch{}Ce.push({name:We.name,videoUrl:rt,isGif:dt})}L(Ce),Oe(z.rounds),H({work:z.work,rest:z.rest}),j("preview");return}const pe={};for(const Ce of z.exercises)if(Ce.storagePath)try{const We=bi(vi,Ce.storagePath);pe[Ce.name]={url:await fo(We),isGif:/\.gif$/i.test(Ce.storagePath)}}catch{}X(pe);const he=z.exercises.map(Ce=>({name:Ce.name,type:Ce.type,targetSets:Ce.sets,targetReps:Ce.reps||0,targetTime:Ce.time||0,sets:[]}));Xs(he),It(0),ws(0),qs(""),_s(""),nt(!1),De(!1),st(0),et([]),Q(null),j("muscle_workout")},kr=()=>{const z=ne.current;z&&(z.paused?(z.play(),nt(!0)):(z.pause(),nt(!1)))};b.useEffect(()=>{if(_!=="muscle_workout"||!ve||Pe<=0){_==="muscle_workout"&&ve&&Pe<=0&&(De(!1),Dn());return}return Ke.current=setTimeout(()=>st(z=>z-1),1e3),()=>clearTimeout(Ke.current)},[_,ve,Pe]);const Ma=async()=>{const z=is[Kt];let pe={};if(z.type==="weighted"){const We=parseFloat(Ps)||0,rt=parseInt(os)||0;if(rt===0){Tt("Enter your reps","error");return}pe={weight:We,reps:rt}}else if(z.type==="reps"){const We=parseInt(os)||0;if(We===0){Tt("Enter your reps","error");return}pe={reps:We}}else if(z.type==="timed"){const We=z.targetTime-Pe;pe={time:Math.max(We,1)}}const he=[...is];he[Kt]={...z,sets:[...z.sets,pe]},Xs(he),z.type==="weighted"&&pe.weight>0&&await Br(z.name,pe.weight,pe.reps);const Ce=z.sets.length+1;if(Ce<z.targetSets)ws(Ce),_s(""),De(!1),st(0);else if(Kt+1<is.length){const We=Kt+1;It(We),ws(0),qs(""),_s(""),nt(!1),De(!1),st(0)}else await Mi(he),Ut(!0)},Mi=async z=>{if(!(!n||!t))try{const pe=z.reduce((Ce,We)=>Ce+We.sets.reduce((rt,dt)=>rt+(dt.weight||0)*(dt.reps||0),0),0),he=z.reduce((Ce,We)=>Ce+We.sets.length,0);await Kr(qt(ye,"workoutLogs"),{clientId:t.id,type:"muscle_group",muscleGroup:ot,sessionId:Gt?.id,sessionName:Gt?.name,exerciseCount:z.length,totalSets:he,duration:Math.round(he*1.5),volume:Math.round(pe),exercises:z.map(Ce=>({name:Ce.name,type:Ce.type,sets:Ce.sets})),completedAt:Rt.now()}),pe>0&&await Ai(pe),wt.length>0&&Q({badges:[...wt]})}catch(pe){console.error("Error saving muscle group workout log:",pe)}},jr=b.useRef(null),Tr=()=>(jr.current||(jr.current=new(window.AudioContext||window.webkitAudioContext)),jr.current),Dn=()=>{try{const z=Tr(),pe=z.createOscillator(),he=z.createGain();pe.connect(he),he.connect(z.destination),pe.frequency.value=880,he.gain.value=.3,pe.start(z.currentTime),pe.stop(z.currentTime+.15)}catch{}},qn=()=>{try{const z=Tr(),pe=z.createOscillator(),he=z.createGain();pe.connect(he),he.connect(z.destination),pe.frequency.value=1200,he.gain.value=.4,pe.start(z.currentTime),pe.stop(z.currentTime+.3)}catch{}};b.useEffect(()=>{if(_!=="workout"||P!=="work"||!I[$e]?.isGif)return;const pe=setInterval(()=>{const he=Mt.current;if(!he)return;const Ce=he.getAttribute("src");he.removeAttribute("src"),setTimeout(()=>{Mt.current&&Mt.current.setAttribute("src",Ce)},0)},4e3);return()=>clearInterval(pe)},[_,P,$e,fe,I]);const Pn=(z,pe,he)=>{const Ce=Math.round(z/pe*c6);return r.jsx("svg",{className:"wk-ring-svg",viewBox:"0 0 200 200",children:cD.map((We,rt)=>r.jsx("line",{x1:We.x1,y1:We.y1,x2:We.x2,y2:We.y2,className:rt<Ce?`wk-tick-filled ${he}`:"wk-tick-empty",strokeWidth:We.thick?"3":"2"},rt))})},Xr=()=>{const z=I.length*A;return((fe-1)*I.length+$e+(P==="rest"?.5:0))/z},xn=St&&r.jsx("div",{className:`toast-notification ${St.type}`,children:St.message});if(i)return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>x("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsx("div",{className:"wk-loading-inline",children:r.jsx("div",{className:"wk-loading-spinner"})})]});if(_==="menu")return r.jsx(Sa,{children:r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>x("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[r.jsxs("div",{className:"wk-menu-heading",children:[r.jsx("h2",{children:"Choose Your Workout"}),r.jsx("p",{children:"No excuses. Just results."})]}),r.jsx("button",{className:"wk-hero-card",onClick:()=>j("randomiser_hub"),children:r.jsx("img",{src:A2,alt:"Randomise Workout",className:"wk-hero-bg"})}),!p&&r.jsxs("button",{className:"wk-hero-card wk-free-card-premium",onClick:()=>x("/upgrade"),children:[r.jsx("img",{src:M2,alt:"Programmes",className:"wk-hero-bg"}),r.jsx("div",{className:"wk-free-card-overlay"}),r.jsxs("div",{className:"wk-free-card-content",children:[r.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),r.jsx("span",{className:"wk-free-card-label",children:"Unlock Full Access"})]})]}),p&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"wk-section-header",children:[r.jsx("h2",{children:"Programmes"}),r.jsxs("span",{className:"wk-section-count",children:[Qp.length," available"]})]}),r.jsx("div",{className:"wk-prog-scroll-wrap",children:r.jsx("div",{className:"wk-prog-scroll",children:Qp.map((z,pe)=>z.image?r.jsxs("button",{className:"wk-prog-img-card",onClick:()=>x("/client/core-buddy/programmes",{state:{templateId:z.id}}),style:{animationDelay:`${pe*.06}s`},children:[r.jsx("img",{src:z.image,alt:z.name,className:"wk-prog-img"}),pe===0&&r.jsx("div",{className:"wk-swipe-arrow",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},z.id):r.jsxs("button",{className:"wk-prog-hero-card",onClick:()=>x("/client/core-buddy/programmes",{state:{templateId:z.id}}),style:{animationDelay:`${pe*.06}s`},children:[r.jsx("img",{src:M2,alt:"Programme",className:"wk-prog-hero-bg",loading:"lazy"}),r.jsx("div",{className:"wk-prog-hero-overlay",style:{background:m6[z.focus]}}),r.jsxs("div",{className:"wk-prog-hero-content",children:[r.jsxs("div",{className:"wk-prog-hero-top",children:[r.jsxs("span",{className:"wk-prog-hero-badge",children:[z.duration," WEEKS"]}),r.jsx("span",{className:"wk-prog-hero-level",children:z.level})]}),r.jsxs("div",{className:"wk-prog-hero-bottom",children:[r.jsx("h3",{children:z.name.toUpperCase()}),r.jsxs("p",{children:[z.daysPerWeek,"x per week  ",z.focus==="fullbody"?"Full Body":z.focus.charAt(0).toUpperCase()+z.focus.slice(1)," Focus"]}),r.jsx("span",{className:"wk-prog-hero-go",children:"VIEW PROGRAMME "})]})]}),pe===0&&r.jsx("div",{className:"wk-swipe-arrow",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},z.id))})})]}),p&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"wk-section-header",children:[r.jsx("h2",{children:"Muscle Groups"}),r.jsxs("span",{className:"wk-section-count",children:[lu.length," groups"]})]}),r.jsx("div",{className:"wk-muscle-grid",children:lu.map((z,pe)=>r.jsx("button",{className:`wk-muscle-hero-card${z.image?" wk-muscle-thumb":""}`,onClick:()=>{Pt(z.key),j("muscle_sessions")},style:{animationDelay:`${pe*.05}s`},children:z.image?r.jsx("img",{src:z.image,alt:z.label,className:"wk-muscle-thumb-img"}):r.jsxs(r.Fragment,{children:[r.jsx("img",{src:A2,alt:"Muscle group",className:"wk-muscle-hero-bg",loading:"lazy"}),r.jsx("div",{className:"wk-muscle-hero-overlay",style:{background:Yp[z.key]}}),r.jsxs("div",{className:"wk-muscle-hero-content",children:[r.jsx("div",{className:"wk-muscle-hero-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:z.icon})})}),r.jsxs("div",{className:"wk-muscle-hero-text",children:[r.jsx("span",{className:"wk-muscle-hero-name",children:z.label}),r.jsxs("span",{className:"wk-muscle-hero-count",children:[I2[z.key]?.length||0," sessions"]})]})]})]})},z.key))})]})]}),r.jsx(Ta,{active:"workouts"}),xn]})});if(_==="randomiser_hub"){const z=JSON.parse(localStorage.getItem("mcf_last_randomiser")||"null"),pe=z?oa.find(Ce=>Ce.key===z.focus)?.label||z.focus:null,he=z?Va.find(Ce=>Ce.key===z.level)?.label||z.level:null;return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>j("menu"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[r.jsxs("div",{className:"wk-hub-heading",children:[r.jsx("div",{className:"wk-hub-icon-wrap",children:r.jsxs("svg",{className:"wk-hub-dice-icon",width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"3"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.2",fill:"currentColor",stroke:"none"}),r.jsx("circle",{cx:"15.5",cy:"8.5",r:"1.2",fill:"currentColor",stroke:"none"}),r.jsx("circle",{cx:"12",cy:"12",r:"1.2",fill:"currentColor",stroke:"none"}),r.jsx("circle",{cx:"8.5",cy:"15.5",r:"1.2",fill:"currentColor",stroke:"none"}),r.jsx("circle",{cx:"15.5",cy:"15.5",r:"1.2",fill:"currentColor",stroke:"none"})]})}),r.jsx("h2",{children:"Randomiser"}),r.jsx("p",{children:"Generate, save & replay workouts"})]}),te.total>0&&r.jsxs("div",{className:"wk-hub-stats",children:[r.jsxs("div",{className:"wk-hub-stat",children:[r.jsx("span",{className:"wk-hub-stat-value",children:te.total}),r.jsx("span",{className:"wk-hub-stat-label",children:"Workouts"})]}),te.streak>0&&r.jsxs("div",{className:"wk-hub-stat",children:[r.jsxs("span",{className:"wk-hub-stat-value",children:[te.streak,r.jsx("small",{children:"d"})]}),r.jsx("span",{className:"wk-hub-stat-label",children:"Streak"})]}),te.favouriteFocus&&r.jsxs("div",{className:"wk-hub-stat",children:[r.jsx("span",{className:"wk-hub-stat-value wk-hub-stat-focus",style:{color:Zp[te.favouriteFocus]||"var(--color-primary)"},children:oa.find(Ce=>Ce.key===te.favouriteFocus)?.label||te.favouriteFocus}),r.jsx("span",{className:"wk-hub-stat-label",children:"Top Focus"})]})]}),r.jsxs("div",{className:"wk-hub-tip",children:[r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),D2[Math.floor(Date.now()/864e5)%D2.length]]}),r.jsxs("div",{className:"wk-hub-actions",children:[r.jsxs("button",{className:"wk-hub-action-btn wk-hub-new wk-hub-new-glow",onClick:()=>j("setup"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"New Workout"]}),z&&r.jsxs("button",{className:"wk-hub-action-btn wk-hub-quick",onClick:mr,disabled:Lt,children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})}),"Quick Start",r.jsxs("span",{className:"wk-hub-quick-meta",children:[pe,"  ",he,"  ",z.duration,"min"]})]})]}),we&&r.jsxs("div",{className:"wk-hub-section",children:[r.jsxs("h3",{className:"wk-hub-section-title",children:[r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Suggested For You"]}),r.jsxs("button",{className:"wk-hub-suggestion",onClick:()=>{D(we.focus),j("setup")},children:[r.jsxs("div",{className:"wk-hub-suggestion-info",children:[r.jsx("span",{className:"wk-hub-suggestion-label",children:we.message}),r.jsx("span",{className:"wk-hub-suggestion-cta",children:"Tap to set up "})]}),r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]})]}),r.jsxs("div",{className:"wk-hub-section",children:[r.jsxs("h3",{className:"wk-hub-section-title",children:[r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Saved Workouts",Bs.length>0&&r.jsx("span",{className:"wk-hub-count",children:Bs.length})]}),rn?Bs.length===0?r.jsxs("div",{className:"wk-hub-empty wk-hub-empty-enhanced",children:[r.jsx("svg",{className:"wk-hub-empty-icon",width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),r.jsx("p",{children:r.jsx("strong",{children:"No saved workouts yet"})}),r.jsx("p",{className:"wk-hub-empty-sub",children:"Generate a workout and hit save to stash it here for quick replay."})]}):r.jsx("div",{className:"wk-hub-saved-list",children:Bs.map((Ce,We)=>{const rt=(Ce.equipment||[]).map(es=>Xp.find(ls=>ls.key===es)?.label||es).join(", "),dt=oa.find(es=>es.key===Ce.focus)?.label||Ce.focus,Ot=Va.find(es=>es.key===Ce.level)?.label||Ce.level;return r.jsxs("div",{className:"wk-hub-saved-card",style:{animationDelay:`${We*.05}s`},children:[r.jsxs("button",{className:"wk-hub-saved-main",onClick:()=>_r(Ce),children:[r.jsxs("div",{className:"wk-hub-saved-info",children:[r.jsx("span",{className:"wk-hub-saved-name",children:Ce.name}),r.jsxs("span",{className:"wk-hub-saved-tags",children:[r.jsx("span",{className:"wk-hub-focus-pill",style:{"--pill-color":Zp[Ce.focus]||"var(--color-primary)"},children:dt}),r.jsxs("span",{className:"wk-hub-saved-meta",children:[Ot,"  ",Ce.duration,"min  ",(Ce.exercises||[]).length," ex"]})]}),rt&&r.jsx("span",{className:"wk-hub-saved-equip",children:rt})]}),r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]}),r.jsx("button",{className:"wk-hub-saved-delete",onClick:()=>ys(Ce.id),"aria-label":"Remove saved workout",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("polyline",{points:"3 6 5 6 21 6"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]},Ce.id)})}):r.jsx("div",{className:"wk-hub-empty",children:r.jsx("div",{className:"wk-loading-spinner"})})]}),F.length>0&&r.jsxs("div",{className:"wk-hub-section",children:[r.jsxs("h3",{className:"wk-hub-section-title",children:[r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("polyline",{points:"12 6 12 12 16 14"})]}),"Recent"]}),r.jsx("div",{className:"wk-hub-recent-list",children:F.map((Ce,We)=>{const rt=oa.find(ls=>ls.key===Ce.focus)?.label||Ce.focus||"",dt=Va.find(ls=>ls.key===Ce.level)?.label||Ce.level||"",Ot=Ce.completedAt?.toDate?Ce.completedAt.toDate():Ce.completedAt?new Date(Ce.completedAt):null,es=Ot?(()=>{const ls=Math.floor((Date.now()-Ot.getTime())/1e3);return ls<3600?`${Math.floor(ls/60)}m ago`:ls<86400?`${Math.floor(ls/3600)}h ago`:`${Math.floor(ls/86400)}d ago`})():"";return r.jsxs("div",{className:"wk-hub-recent-card",style:{animationDelay:`${We*.05}s`},children:[r.jsx("div",{className:"wk-hub-recent-info",children:r.jsxs("span",{className:"wk-hub-recent-tags",children:[r.jsx("span",{className:"wk-hub-focus-pill",style:{"--pill-color":Zp[Ce.focus]||"var(--color-primary)"},children:rt}),r.jsxs("span",{className:"wk-hub-recent-meta",children:[dt,"  ",Ce.duration||"?","min  ",Ce.exerciseCount||"?"," ex"]})]})}),r.jsx("span",{className:"wk-hub-recent-time",children:es})]},We)})})]})]}),xn]})}if(_==="setup"){const z=oa.find(he=>he.key===B)?.label||B,pe=Va.find(he=>he.key===se)?.label||se;return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>j("randomiser_hub"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main wk-setup-main",children:[r.jsx("div",{className:"wk-stats-row",children:[{label:"Total",value:`${U}`,pct:U>0?Math.min(Math.round(U/100*100),100):0,color:"#14b8a6",size:"normal"},{label:"This Week",value:`${Ae}/${Kp}`,pct:Math.round(Math.min(Ae,Kp)/Kp*100),color:"var(--color-primary)",size:"large"},{label:"Wk Streak",value:`${Se}`,pct:Se>0?Math.min(Math.round(Se/12*100),100):0,color:"#38B6FF",size:"normal"}].map(he=>{const We=2*Math.PI*38,rt=We-he.pct/100*We;return r.jsxs("div",{className:`wk-stat-item${he.size==="large"?" wk-stat-large":""}`,children:[r.jsxs("div",{className:"wk-stat-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"wk-stat-track",cx:"50",cy:"50",r:38}),r.jsx("circle",{className:"wk-stat-fill",cx:"50",cy:"50",r:38,style:{stroke:he.color},strokeDasharray:We,strokeDashoffset:rt})]}),r.jsx("span",{className:"wk-stat-value",style:{color:he.color},children:he.value})]}),r.jsx("span",{className:"wk-stat-label",children:he.label})]},he.label)})}),r.jsxs("div",{className:"wk-setup-flow",children:[r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Focus Area"}),r.jsx("div",{className:"wk-focus-grid",children:oa.map(he=>r.jsxs("button",{className:`wk-equip-btn${B===he.key?" active":""}${he.key==="mix"?" wk-mix-btn":""}`,onClick:()=>D(he.key),children:[r.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:he.icon})}),r.jsx("span",{children:he.label})]},he.key))})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Level"}),r.jsx("div",{className:"wk-level-cards",children:Va.map(he=>r.jsxs("button",{className:`wk-level-card wk-level-${he.key}${se===he.key?" active":""}`,onClick:()=>Y(he.key),children:[r.jsx("span",{className:"wk-level-name",children:he.label}),r.jsx("span",{className:"wk-level-desc",children:he.desc})]},he.key))})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Time"}),r.jsx("div",{className:"wk-time-options",children:Jp.map(he=>{const Ce=!zt.includes(he);return r.jsxs("button",{className:`wk-time-btn${Z===he?" active":""}${Ce?" locked":""}`,onClick:()=>!Ce&&je(he),disabled:Ce,children:[r.jsx("span",{className:"wk-time-num",children:he}),r.jsx("span",{className:"wk-time-unit",children:Ce?r.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}):"min"})]},he)})})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Equipment"}),r.jsx("div",{className:"wk-equip-options",children:Xp.map(he=>{const Ce=O.includes(he.key);return r.jsxs("button",{className:`wk-equip-btn${Ce?" active":""}`,onClick:()=>{K(We=>Ce&&We.length===1?We:Ce?We.filter(rt=>rt!==he.key):[...We,he.key])},children:[r.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:he.icon})}),r.jsx("span",{children:he.label})]},he.key)})})]}),r.jsx("div",{className:"wk-setup-summary",children:r.jsxs("span",{children:[z,"  ",pe,"  ",Z," min"]})})]})]}),r.jsxs("div",{className:"wk-go-sticky",children:[Lt&&r.jsx("p",{className:"wk-free-limit-msg",children:"You've used your free workout this week. Upgrade for unlimited access."}),r.jsx("button",{className:"wk-randomise-btn",onClick:Aa,disabled:C||Lt,children:C?"Loading exercises...":Lt?"Limit Reached":"Randomise Workout"})]}),xn]})}if(_==="spinning")return r.jsxs("div",{className:"wk-page wk-page-center","data-theme":l?"dark":"light","data-accent":d,children:[r.jsxs("div",{className:"wk-spin-container",children:[r.jsxs("div",{className:"wk-spin-ring",children:[r.jsx("svg",{className:"wk-spin-svg",viewBox:"0 0 200 200",children:Yk.map((z,pe)=>r.jsx("line",{x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,className:"wk-spin-tick",strokeWidth:z.thick?"3.5":"2",style:{animationDelay:`${pe*.03}s`}},pe))}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-spin-logo",width:"50",height:"50"})]}),r.jsx("p",{className:"wk-spin-text",children:"Generating workout..."})]}),xn]});if(_==="preview"){const z=Gt?.interval?{work:Gt.work,rest:Gt.rest}:Va.find(he=>he.key===se),pe=I.length*A*(z.work+z.rest);return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>j(Gt?.interval?"muscle_sessions":"setup"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[Gt?.interval&&r.jsx("h2",{className:"mg-preview-title",children:Gt.name}),r.jsxs("div",{className:"wk-preview-stats",children:[r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:I.length}),r.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:A}),r.jsx("span",{className:"wk-stat-label",children:"Rounds"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:Math.ceil(pe/60)}),r.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsxs("span",{className:"wk-stat-val",children:[z.work,"/",z.rest]}),r.jsx("span",{className:"wk-stat-label",children:"Work/Rest"})]})]}),r.jsx("div",{className:"wk-preview-list",children:I.map((he,Ce)=>r.jsxs("div",{className:"wk-preview-item",style:{animationDelay:`${Ce*.06}s`},onClick:()=>ie(he),children:[r.jsx("span",{className:"wk-preview-num",children:Ce+1}),r.jsx("div",{className:"wk-preview-thumb",children:he.isGif?r.jsx("img",{src:he.videoUrl,alt:he.name,loading:"lazy"}):r.jsx("video",{src:`${he.videoUrl}#t=0.1`,muted:!0,playsInline:!0,preload:"auto"})}),r.jsx("span",{className:"wk-preview-name",children:he.name}),r.jsx("svg",{className:"wk-preview-play",width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]},Ce))}),jt&&r.jsx("div",{className:"wk-preview-modal-backdrop",onClick:()=>ie(null),children:r.jsxs("div",{className:"wk-preview-modal",onClick:he=>he.stopPropagation(),children:[r.jsx("button",{className:"wk-preview-modal-close",onClick:()=>ie(null),"aria-label":"Close preview",children:r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),r.jsx("div",{className:"wk-preview-modal-video",children:jt.isGif?r.jsx("img",{src:jt.videoUrl,alt:jt.name}):r.jsx("video",{src:jt.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0})}),r.jsx("h3",{className:"wk-preview-modal-title",children:jt.name})]})}),r.jsxs("div",{className:"wk-preview-actions",children:[!Gt?.interval&&r.jsxs(r.Fragment,{children:[r.jsxs("button",{className:"wk-btn-secondary",onClick:()=>Aa(),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("polyline",{points:"1 4 1 10 7 10"}),r.jsx("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})]}),"Reshuffle"]}),r.jsxs("button",{className:"wk-btn-save",onClick:()=>W(!0),disabled:As,children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Save"]})]}),r.jsx("button",{className:"wk-btn-primary",onClick:Qr,children:"Start Workout"})]}),ks&&r.jsx("div",{className:"wk-save-modal-backdrop",onClick:()=>W(!1),children:r.jsxs("div",{className:"wk-save-modal",onClick:he=>he.stopPropagation(),children:[r.jsx("h3",{children:"Save Workout"}),r.jsx("p",{children:"Give this workout a name (or leave blank for auto-name)"}),r.jsx("input",{type:"text",className:"wk-save-input",value:de,onChange:he=>le(he.target.value),placeholder:`${oa.find(he=>he.key===B)?.label||B} ${Z}min`,maxLength:40,autoFocus:!0}),r.jsxs("div",{className:"wk-save-modal-actions",children:[r.jsx("button",{className:"wk-btn-secondary",onClick:()=>W(!1),children:"Cancel"}),r.jsx("button",{className:"wk-btn-primary",onClick:()=>hr(de),disabled:As,children:As?"Saving...":"Save"})]})]})})]})]})}if(_==="countdown")return r.jsx("div",{className:"wk-page wk-page-center wk-page-dark","data-theme":l?"dark":"light","data-accent":d,children:r.jsxs("div",{className:"wk-countdown-big",children:[r.jsx("span",{className:"wk-countdown-num",children:mt}),r.jsx("span",{className:"wk-countdown-label",children:"GET READY"})]})});if(_==="workout"){const z=I[$e],pe=P==="work"?ht.work:ht.rest,he=P==="rest"?$e+1<I.length?I[$e+1]:fe<A?I[0]:null:null;return r.jsxs("div",{className:"wk-page wk-page-workout","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("div",{className:"wk-video-container",children:P==="work"?z.isGif?r.jsx("img",{ref:Mt,className:"wk-video",src:z.videoUrl,alt:z.name},z.videoUrl):r.jsx("video",{className:"wk-video",src:z.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0},z.videoUrl):r.jsxs("div",{className:"wk-rest-screen",children:[r.jsx("span",{className:"wk-rest-label",children:"REST"}),he&&r.jsxs("span",{className:"wk-next-label",children:["Next: ",he.name]})]})}),r.jsx("div",{className:"wk-back-row",children:r.jsxs("button",{className:"wk-back-btn",onClick:()=>{confirm("Leave workout?")&&j("menu")},children:[r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]})}),r.jsx("div",{className:"wk-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"wk-exercise-info",children:[r.jsxs("span",{className:"wk-exercise-counter",children:[$e+1," / ",I.length]}),r.jsx("h2",{className:"wk-exercise-name",children:z.name}),r.jsxs("span",{className:"wk-round-label",children:["Round ",fe," of ",A]})]}),r.jsx("div",{className:"wk-timer-section",children:r.jsxs("div",{className:"wk-timer-ring-wrap",children:[Pn(Fe,pe,P==="work"?"wk-tick-work":"wk-tick-rest"),r.jsxs("div",{className:"wk-timer-center",children:[r.jsx("span",{className:"wk-timer-time",children:Fe}),r.jsx("span",{className:`wk-timer-phase ${P}`,children:P==="work"?"WORK":"REST"})]})]})}),r.jsxs("div",{className:"wk-controls",children:[r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-stop",onClick:()=>{confirm("End workout early?")&&j("menu")},children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})})}),r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-pause",onClick:()=>Ie(!Ue),children:Ue?r.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}):r.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:[r.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),r.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]})}),r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-skip",onClick:()=>{qe(0)},children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:[r.jsx("polygon",{points:"5 4 15 12 5 20 5 4"}),r.jsx("rect",{x:"15",y:"4",width:"4",height:"16"})]})})]}),r.jsx("div",{className:"wk-progress-bar",children:r.jsx("div",{className:"wk-progress-fill",style:{width:`${Xr()*100}%`}})}),it&&(()=>{const Ce=Va.find(rt=>rt.key===se),We=I.length*A*(Ce.work+Ce.rest);return r.jsxs(r.Fragment,{children:[r.jsx(Zh,{title:"Workout Complete!",stats:[{value:Math.ceil(We/60),label:"Minutes"},{value:I.length*A,label:"Intervals"},{value:A,label:"Rounds"}],hideShare:!p,onShareJourney:t?Et:null,userName:t?.name,onDismissStart:()=>j("menu"),onDone:()=>{ss(!1),ps(null),Pt(null)}}),!Gt?.interval&&r.jsxs("button",{className:"wk-complete-save-btn",onClick:()=>W(!0),disabled:As,children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Save This Workout"]}),ks&&r.jsx("div",{className:"wk-save-modal-backdrop",onClick:()=>W(!1),style:{zIndex:10001},children:r.jsxs("div",{className:"wk-save-modal",onClick:rt=>rt.stopPropagation(),children:[r.jsx("h3",{children:"Save Workout"}),r.jsx("p",{children:"Give this workout a name (or leave blank for auto-name)"}),r.jsx("input",{type:"text",className:"wk-save-input",value:de,onChange:rt=>le(rt.target.value),placeholder:`${oa.find(rt=>rt.key===B)?.label||B} ${Z}min`,maxLength:40,autoFocus:!0}),r.jsxs("div",{className:"wk-save-modal-actions",children:[r.jsx("button",{className:"wk-btn-secondary",onClick:()=>W(!1),children:"Cancel"}),r.jsx("button",{className:"wk-btn-primary",onClick:()=>hr(de),disabled:As,children:As?"Saving...":"Save"})]})]})})]})})()]})}if(_==="muscle_sessions"){const z=lu.find(he=>he.key===ot),pe=I2[ot]||[];return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>j("menu"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[r.jsxs("div",{className:"mg-sessions-header",children:[r.jsx("div",{className:"mg-sessions-icon",style:{background:Yp[ot]},children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:z?.icon})})}),r.jsxs("h2",{children:[z?.label," Workouts"]}),r.jsxs("p",{children:[pe.length," sessions available"]})]}),r.jsx("div",{className:"mg-sessions-list",children:pe.map((he,Ce)=>r.jsxs("button",{className:"mg-session-card",onClick:()=>{ps(he),j("muscle_overview")},style:{animationDelay:`${Ce*.08}s`},children:[r.jsxs("div",{className:"mg-session-info",children:[r.jsx("h3",{children:he.name}),r.jsx("p",{children:he.desc}),r.jsx("div",{className:"mg-session-meta",children:he.interval?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"mg-session-tag mg-tag-interval",children:"Interval"}),r.jsxs("span",{className:"mg-session-tag",children:[he.exercises.length," exercises"]}),r.jsxs("span",{className:"mg-session-tag",children:[he.rounds," rounds"]})]}):r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"mg-session-tag mg-tag-strength",children:"Strength"}),r.jsxs("span",{className:"mg-session-tag",children:[he.exercises.length," exercises"]}),r.jsx("span",{className:"mg-session-tag",children:(()=>{const We=he.exercises.map(Ot=>Ot.sets||0),rt=Math.min(...We),dt=Math.max(...We);return rt===dt?`${rt} sets each`:`${rt}-${dt} sets each`})()})]})})]}),r.jsx("div",{className:"mg-session-arrow",children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},he.id))})]}),xn]})}if(_==="muscle_overview"){const z=Gt;if(!z)return null;const pe=lu.find(he=>he.key===ot);return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>j("muscle_sessions"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main mg-overview-main",children:[r.jsx("div",{className:"mg-overview-hero",style:z.image?void 0:{background:Yp[ot]},children:z.image?r.jsx("img",{src:z.image,alt:z.name,className:"mg-overview-hero-img"}):r.jsx("div",{className:"mg-overview-hero-content",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"mg-overview-hero-icon",children:r.jsx("path",{d:pe?.icon})})})}),r.jsxs("div",{className:"mg-overview-header",children:[r.jsxs("div",{className:"mg-overview-title-row",children:[r.jsx("h2",{children:z.name}),z.level&&r.jsx("span",{className:"mg-overview-level",children:z.level})]}),r.jsx("p",{className:"mg-overview-desc",children:z.desc})]}),z.overview&&r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 16v-4M12 8h.01"})]}),"About This Workout"]}),r.jsx("p",{children:z.overview})]}),z.tips&&z.tips.length>0&&r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Tips & Form"]}),r.jsx("ul",{className:"mg-overview-tips",children:z.tips.map((he,Ce)=>r.jsx("li",{children:he},Ce))})]}),r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"}),r.jsx("rect",{x:"9",y:"3",width:"6",height:"4",rx:"1"}),r.jsx("path",{d:"M9 14l2 2 4-4"})]}),"Exercises (",z.exercises.length,")"]}),r.jsx("div",{className:"mg-overview-exercises",children:z.exercises.map((he,Ce)=>r.jsxs("div",{className:"mg-overview-exercise",children:[r.jsx("span",{className:"mg-overview-ex-num",children:Ce+1}),r.jsxs("div",{className:"mg-overview-ex-info",children:[r.jsx("span",{className:"mg-overview-ex-name",children:he.name}),z.interval?r.jsxs("span",{className:"mg-overview-ex-detail",children:[z.work,"s work / ",z.rest,"s rest"]}):r.jsxs("span",{className:"mg-overview-ex-detail",children:[he.sets," sets  ",he.reps?`${he.reps} reps`:`${he.time}s`,he.type==="weighted"&&"  weighted"]})]})]},Ce))})]}),r.jsxs("button",{className:"mg-overview-start-btn",onClick:()=>Za(z),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Workout"]})]}),xn]})}if(_==="muscle_workout"){const z=Gt;if(!z)return null;const pe=z.exercises[Kt],he=is[Kt];if(!pe||!he)return null;const Ce=he.sets.length,We=z.exercises.length,rt=z.exercises.reduce((ts,E)=>ts+(E.sets||0),0),Ot=is.reduce((ts,E)=>ts+E.sets.length,0)/rt*100,es=gt[pe.name];pe.type==="timed"&&Pe===0&&!ve&&Ce===hs&&setTimeout(()=>st(pe.time),0);const ls=Ce+1<pe.sets?"Log Set":Kt+1<We?"Log Set  Next Exercise":"Log Set  Complete";return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("div",{className:"mg-session-progress",children:r.jsx("div",{className:"mg-session-progress-fill",style:{width:`${Ot}%`}})}),r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>{confirm("End workout early?")&&j("muscle_overview")},"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsxs("span",{className:"mg-header-info",children:["Exercise ",Kt+1,"/",We]}),r.jsx("div",{style:{width:22}})]})}),r.jsxs("main",{className:"wk-main",children:[es?r.jsxs("div",{className:"mg-video-container",onClick:kr,children:[es.isGif?r.jsx("img",{className:"mg-video",src:es.url,alt:pe.name}):r.jsx("video",{ref:ne,className:"mg-video",src:es.url,loop:!0,muted:!0,playsInline:!0},pe.name),!Ge&&!es.isGif&&r.jsxs("div",{className:"mg-video-overlay",children:[r.jsx("svg",{className:"mg-play-icon",width:"48",height:"48",viewBox:"0 0 24 24",fill:"rgba(255,255,255,0.9)",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),r.jsx("span",{className:"mg-video-hint",children:"Tap for demo"})]})]}):r.jsxs("div",{className:"mg-video-placeholder",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.4",children:[r.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),r.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),r.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),r.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),r.jsx("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),r.jsx("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),r.jsx("line",{x1:"17",y1:"7",x2:"22",y2:"7"}),r.jsx("line",{x1:"17",y1:"17",x2:"22",y2:"17"})]}),r.jsx("span",{children:"Video coming soon"})]}),r.jsx("div",{className:"wk-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"mg-exercise-card",children:[r.jsx("h2",{className:"mg-ex-name",children:pe.name}),r.jsx("span",{className:`mg-ex-type-badge ${pe.type}`,children:pe.type==="weighted"?"Weight + Reps":pe.type==="reps"?"Reps Only":"Timed"}),r.jsxs("div",{className:"mg-ex-set-info",children:[r.jsxs("span",{className:"mg-ex-set-num",children:["Set ",Ce+1," of ",pe.sets]}),pe.type!=="timed"&&r.jsxs("span",{className:"mg-ex-target",children:["Target: ",pe.reps," reps"]}),pe.type==="timed"&&r.jsxs("span",{className:"mg-ex-target",children:["Target: ",pe.time,"s"]})]}),pe.type==="weighted"&&r.jsxs("div",{className:"mg-input-area",children:[r.jsxs("div",{className:"mg-input-group",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",className:"mg-input",value:Ps,onChange:ts=>qs(ts.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"mg-input-group",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:os,onChange:ts=>_s(ts.target.value),placeholder:"0"})]})]}),pe.type==="reps"&&r.jsx("div",{className:"mg-input-area",children:r.jsxs("div",{className:"mg-input-group mg-input-single",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:os,onChange:ts=>_s(ts.target.value),placeholder:"0"})]})}),pe.type==="timed"&&r.jsxs("div",{className:"mg-timer-area",children:[r.jsx("div",{className:"mg-timer-display",children:r.jsxs("span",{className:"mg-timer-value",children:[Pe,"s"]})}),ve?r.jsx("button",{className:"mg-timer-btn mg-timer-stop",onClick:()=>De(!1),children:"Stop"}):r.jsx("button",{className:"mg-timer-btn",onClick:()=>{Pe===0&&st(pe.time),De(!0)},children:Pe<pe.time&&Pe>0?"Resume":"Start Timer"})]}),r.jsx("button",{className:"mg-log-set-btn",onClick:Ma,children:ls}),he.sets.length>0&&r.jsx("div",{className:"mg-completed-sets",children:he.sets.map((ts,E)=>r.jsxs("div",{className:"mg-completed-set",children:[r.jsx("span",{className:"mg-completed-set-check",children:""}),r.jsxs("span",{children:["Set ",E+1,": ",ts.weight!=null?`${ts.weight}kg  ${ts.reps}`:ts.reps!=null?`${ts.reps} reps`:`${ts.time}s`]})]},E))})]})]}),xn,Rs&&(()=>{const ts=is.reduce((Me,Qe)=>Me+Qe.sets.length,0),E=is.reduce((Me,Qe)=>Me+Qe.sets.reduce((tt,Ye)=>tt+(Ye.weight||0)*(Ye.reps||0),0),0),$=lu.find(Me=>Me.key===ot)?.label||"",ge=[{value:is.length,label:"Exercises"},{value:ts,label:"Sets"}];return E>0&&ge.push({value:Math.round(E).toLocaleString(),label:"Volume (kg)"}),r.jsx(Zh,{title:`${$} Complete!`,subtitle:Gt?.name,stats:ge,hideShare:!p,onShareJourney:t?Et:null,userName:t?.name,onDismissStart:()=>j("menu"),onDone:()=>{Ut(!1),ps(null),Pt(null),Q(null)}})})(),_t&&r.jsx("div",{className:"mg-badge-celebration",onClick:()=>Q(null),children:r.jsxs("div",{className:"mg-badge-celebration-card",children:[r.jsx("div",{className:"mg-badge-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",width:"48",height:"48",fill:"#ffc107",children:r.jsx("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})})}),r.jsx("h3",{className:"mg-badge-celebration-title",children:_t.badges.length===1?"Badge Earned!":`${_t.badges.length} Badges Earned!`}),r.jsx("div",{className:"mg-badge-celebration-list",children:_t.badges.map((ts,E)=>r.jsx("div",{className:"mg-badge-celebration-item",children:ts.type==="pb_target"?`${ts.exercise}  ${ts.targetWeight}kg`:ts.label},E))}),r.jsxs("div",{className:"mg-badge-share-row",children:[r.jsxs("button",{className:"mg-badge-share-btn",onClick:async ts=>{ts.stopPropagation();const E=_t.badges[0],$=_t.badges.map(Me=>Me.type==="pb_target"?`PB Target Hit: ${Me.exercise}  ${Me.targetWeight}kg`:Me.label),ge=Un.find(Me=>Me.id===E?.id)||Un.find(Me=>Me.name===E?.label);await Et({type:"badge_earned",title:$.length===1?$[0]:`${$.length} Badges Earned!`,badges:$,badgeDesc:ge?.desc}),Tt("Posted to Journey!","success")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20h9"}),r.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4Z"})]}),"Journey"]}),r.jsxs("button",{className:"mg-badge-share-btn",onClick:async ts=>{ts.stopPropagation();const E=_t.badges[0],$=_t.badges.map(Qe=>Qe.type==="pb_target"?`PB Target Hit: ${Qe.exercise}  ${Qe.targetWeight}kg`:Qe.label),ge=Un.find(Qe=>Qe.id===E?.id)||Un.find(Qe=>Qe.name===E?.label),Me=`Badge Earned! ${$.join(", ")}
#MindCoreFitness`;try{const Qe=await nb({type:"badge",title:$.length===1?$[0]:"Badges Earned!",badges:$,badgeImage:ge?.img,badgeDesc:ge?.desc});navigator.share&&navigator.canShare?.({files:[new File([Qe],"badge.png",{type:"image/png"})]})?await navigator.share({title:"Mind Core Fitness",text:Me,files:[new File([Qe],"badge.png",{type:"image/png"})]}):navigator.share?await navigator.share({title:"Mind Core Fitness",text:Me}):(await navigator.clipboard.writeText(Me),Tt("Copied!","success"))}catch{try{await navigator.clipboard.writeText(Me),Tt("Copied!","success")}catch{}}},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"18",cy:"5",r:"3"}),r.jsx("circle",{cx:"6",cy:"12",r:"3"}),r.jsx("circle",{cx:"18",cy:"19",r:"3"}),r.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),r.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),"Share"]})]}),r.jsx("button",{className:"mg-badge-celebration-dismiss",children:"Tap to dismiss"})]})})]})}return null}const y6=60,b6={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},v6=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],P2=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,daysPerWeek:3,level:"All Levels",description:"Build total body strength with compound dumbbell movements and bodyweight finishers",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push Focus",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Goblet Squats",type:"weighted",sets:3,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull Focus",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:3,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:3,baseReps:10,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Reverse Lunge",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/reverse lunge.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Legs & Core",exercises:[{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Box Step Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/box step ups.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,daysPerWeek:3,level:"Intermediate",description:"Two-phase programme building strength and endurance across your full body",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Power",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"}]},{name:"Day 3",label:"Endurance",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,daysPerWeek:3,level:"Advanced",description:"Complete transformation programme: push, pull, and legs over three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Upper Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Lower Body",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 3",label:"Upper Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,daysPerWeek:3,level:"Beginner",description:"Build a solid core foundation with targeted ab and stability work",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Abs",exercises:[{name:"Crunch",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Stability",exercises:[{name:"Dead Bug",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Bird Dog",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:20,storagePath:"exercises/bodyweight/core/Side Plank.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"}]},{name:"Day 3",label:"Power Core",exercises:[{name:"Single Leg V-Up",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Single Leg V-Up.mp4"},{name:"Toe Reaches",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/toe reaches.GIF"},{name:"Russian Twists Dumbbell",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/core/russian twists dumbbell.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Fast Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Fast Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,daysPerWeek:3,level:"Intermediate",description:"Develop deep core strength and rotational power over two phases",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Anti-Extension",exercises:[{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Dead Bug",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Plank Walkout",type:"reps",sets:3,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"}]},{name:"Day 2",label:"Rotation",exercises:[{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank Rotation",type:"reps",sets:2,baseReps:10,storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"},{name:"Hollow Hold To V-Sit",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Kettlebell Bird Dog Drag",type:"reps",sets:3,baseReps:10,storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,daysPerWeek:3,level:"Advanced",description:"Ultimate core transformation: stability, strength, and power across three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Forearm Plank",type:"timed",sets:4,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Plank Walkout",type:"reps",sets:4,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Leg Raises",type:"reps",sets:4,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Kettlebell Side Bends",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Dead Bug Single Leg Drop",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 2",label:"Endurance",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:4,baseReps:15,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Hollow Hold Flutter Kicks",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"},{name:"Cross Body Mountain Climbers",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Hollow Hold To V-Sit",type:"reps",sets:4,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Hip Dips Plank",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Kneeling Kettlebell Halo",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,daysPerWeek:3,level:"Intermediate",description:"Sculpt and strengthen your chest, back, shoulders, and arms",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Tricep Dips",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Pike Push Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/upper/pike push ups.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Reverse Plank",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/upper/reverse plank.GIF"}]},{name:"Day 3",label:"Mixed",exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Renegade Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Superman Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Superman Hold.mp4"}]}]},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,daysPerWeek:3,level:"Intermediate",description:"Build powerful legs and glutes with squats, deadlifts, and plyometrics",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Quad Dominant",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Squat And Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/lower/squat and hold.GIF"}]},{name:"Day 2",label:"Hamstring & Glute",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"1 Legged RDL",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.GIF"},{name:"Hip Thrusts",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/hip thrusts.GIF"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.GIF"},{name:"Donkey Kicks",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 3",label:"Power & Stability",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Kettlebell Romanian Deadlift",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/kettlebells/lower/kettlebell romanian deadlift.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Skater Jumps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/skater jumps.GIF"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]}];function mh(n,e,t){const i=n.baseReps?n.baseReps+(e-1)*(t.repProg||0):void 0,l=n.baseTime?n.baseTime+(e-1)*(t.timeProg||0):void 0;return{sets:n.sets,reps:i,time:l}}const x6={fullbody:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z",core:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z",upper:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z",lower:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"};function w6(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Lr(),{isPremium:l}=yc(),{isDark:u,toggleTheme:d,accent:p}=Ca(),g=rr(),y=Na(),[x,_]=b.useState("loading"),[j,O]=b.useState(null),K=b.useRef(!1),[B,D]=b.useState(null),[se,Y]=b.useState(!1),[Z,je]=b.useState(1),[Re,ke]=b.useState(0),[C,T]=b.useState(0),[M,V]=b.useState(0),[I,L]=b.useState([]),[A,Oe]=b.useState(""),[ht,H]=b.useState(""),[fe,Ve]=b.useState(!1),[$e,J]=b.useState(0),P=b.useRef(null),[re,Fe]=b.useState({}),[qe,Ue]=b.useState(!1),Ie=b.useRef(null),[mt,xt]=b.useState(null),[it,ss]=b.useState([]);b.useEffect(()=>{window.scrollTo(0,0)},[x]);const[Rs,Ut]=b.useState(null),jt=b.useCallback((ve,De="info")=>{Ut({message:ve,type:De}),setTimeout(()=>Ut(null),4e3)},[]),ie=b.useCallback(async ve=>{if(!t)throw new Error("Not signed in");const De=ve&&typeof ve=="object"&&ve.type;await Kr(qt(ye,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:De?"":ve,type:De?ve.type:"text",imageURL:null,createdAt:yr(),likeCount:0,commentCount:0,...De?{metadata:{title:ve.title||"",subtitle:ve.subtitle||"",stats:ve.stats||[],quote:ve.quote||"",badges:ve.badges||[]}}:{}})},[t]),Mt=b.useRef(null),St=()=>(Mt.current||(Mt.current=new(window.AudioContext||window.webkitAudioContext)),Mt.current),Yt=()=>{try{const ve=St(),De=ve.createOscillator(),Pe=ve.createGain();De.connect(Pe),Pe.connect(ve.destination),De.frequency.value=1200,Pe.gain.value=.4,De.start(ve.currentTime),De.stop(ve.currentTime+.3)}catch{}};b.useEffect(()=>{!i&&(!n||!e)&&g("/")},[n,e,i,g]),b.useEffect(()=>{if(!t)return;(async()=>{try{const De=Xe(ye,"clientProgrammes",t.id),Pe=await Ls(De);Pe.exists()&&D(Pe.data());const st=y.state?.templateId;if(st&&!K.current){const Ge=P2.find(nt=>nt.id===st);if(Ge){K.current=!0,O(Ge),_("overview");return}}Pe.exists()?_("dashboard"):g("/client/core-buddy/workouts",{replace:!0})}catch(De){console.error("Error loading programme:",De),g("/client/core-buddy/workouts",{replace:!0})}})()},[t]),b.useEffect(()=>{if(!fe||$e<=0){fe&&$e<=0&&(Ve(!1),Yt());return}return P.current=setTimeout(()=>J(ve=>ve-1),1e3),()=>clearTimeout(P.current)},[fe,$e]);const Tt=async ve=>{if(t)try{await Os(Xe(ye,"clientProgrammes",t.id),ve),D(ve)}catch(De){console.error("Error saving programme:",De),jt("Failed to save. Check Firestore rules for clientProgrammes.","error")}},Et=async ve=>{const De={templateId:ve.id,startDate:Rt.now(),completedSessions:{}};await Tt(De),_("dashboard")},ot=async()=>{if(t)try{await ur(Xe(ye,"clientProgrammes",t.id)),D(null),_("browse")}catch(ve){console.error("Error quitting programme:",ve)}},Pt=()=>B?P2.find(ve=>ve.id===B.templateId):null,Gt=()=>{if(!B?.startDate)return 1;const ve=B.startDate.toDate?B.startDate.toDate():new Date(B.startDate),Pe=new Date-ve,st=Math.floor(Pe/(1e3*60*60*24));return Math.floor(st/7)+1},ps=()=>{if(!B)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const ve=B.completedSessions||{},De=Object.keys(ve).length,Pe=Pt();if(!Pe)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const st=Pe.duration*Pe.daysPerWeek,Ge=Gt(),nt=Math.min(Ge,Pe.duration);let gt=0;for(let ne=0;ne<Pe.daysPerWeek;ne++)ve[`w${nt}d${ne}`]&&gt++;if(De>=st)return{currentWeek:Pe.duration,completedThisWeek:Pe.daysPerWeek,nextDay:-1,totalCompleted:De,totalSessions:st,complete:!0};if(Ge>Pe.duration)return{currentWeek:Pe.duration,completedThisWeek:gt,nextDay:-1,totalCompleted:De,totalSessions:st,complete:!0};let X=-1;for(let ne=0;ne<Pe.daysPerWeek;ne++)if(!ve[`w${nt}d${ne}`]){X=ne;break}return{currentWeek:nt,completedThisWeek:gt,nextDay:X,nextWeek:nt,totalCompleted:De,totalSessions:st}},Kt=ve=>{const De=Gt();return ve<De},It=(ve,De,Pe)=>{if(!B||ve<=1)return null;const st=`w${ve-1}d${De}`,Ge=B.completedSessions?.[st];if(!Ge)return null;const nt=Ge.exercises?.find(gt=>gt.name===Pe);return nt?.sets?.length?nt.sets[nt.sets.length-1]:null},hs=(ve,De)=>{const Pe=Pt();if(!Pe)return;je(ve),ke(De),T(0),V(0),L([]),H(""),Ve(!1),J(0),Ue(!1),Fe({});const st=Pe.days[De],Ge=st.exercises.map(ne=>{const Ke=mh(ne,ve,Pe);return{name:ne.name,type:ne.type,pbKey:ne.pbKey,targetSets:Ke.sets,targetReps:Ke.reps,targetTime:Ke.time,sets:[]}});L(Ge);const nt=st.exercises[0],gt=It(ve,De,nt.name);gt?.weight&&nt.type==="weighted"?Oe(String(gt.weight)):Oe(""),(async()=>{const ne={};for(const Ke of st.exercises)if(Ke.storagePath)try{const wt=bi(vi,Ke.storagePath),et=await fo(wt);ne[Ke.name]={url:et,isGif:/\.gif$/i.test(Ke.storagePath)}}catch(wt){console.warn(`Video not found for ${Ke.name}:`,wt)}Fe(ne)})(),_("session")},ws=async()=>{Pt();const ve=I[C];if(!ve)return;let De={};if(ve.type==="weighted"){const Ge=parseFloat(A)||0,nt=parseInt(ht)||0;if(nt===0){jt("Enter your reps","error");return}De={weight:Ge,reps:nt}}else if(ve.type==="reps"){const Ge=parseInt(ht)||0;if(Ge===0){jt("Enter your reps","error");return}De={reps:Ge}}else if(ve.type==="timed"){const Ge=ve.targetTime-$e;De={time:Math.max(Ge,1)}}const Pe=[...I];Pe[C]={...ve,sets:[...ve.sets,De]},L(Pe),ve.type==="weighted"&&De.weight>0&&await Ps(ve.name,De.weight,De.reps);const st=ve.sets.length+1;if(st<ve.targetSets)V(st),Oe(De.weight?String(De.weight):""),H(""),Ve(!1),J(0);else if(C+1<I.length){const Ge=C+1;T(Ge),V(0),Ue(!1);const gt=Pt()?.days[Re]?.exercises[Ge],X=It(Z,Re,gt?.name);X?.weight&&gt?.type==="weighted"?Oe(String(X.weight)):Oe(""),H(""),Ve(!1),J(0)}else await is(Pe)},is=async ve=>{if(!B||!t)return;const De=`w${Z}d${Re}`,Pe={...B.completedSessions,[De]:{completedAt:new Date().toISOString(),exercises:ve.map(nt=>({name:nt.name,type:nt.type,sets:nt.sets}))}},st={...B,completedSessions:Pe};await Tt(st);const Ge=ve.reduce((nt,gt)=>nt+gt.sets.reduce((X,ne)=>X+(ne.weight||0)*(ne.reps||0),0),0);Ge>0&&await Xs(Ge);try{const nt=Pt();await Kr(qt(ye,"workoutLogs"),{clientId:t.id,type:"programme",programmeId:nt?.id,programmeName:nt?.name,week:Z,day:Re+1,exerciseCount:ve.length,duration:Math.round(ve.reduce((gt,X)=>gt+X.sets.length*1.5,0)),volume:Math.round(Ge),completedAt:Rt.now()})}catch(nt){console.error("Error saving workout log:",nt)}it.length>0&&(xt({badges:[...it]}),ss([])),Y(!0)},Xs=async ve=>{if(t)try{const De=await Ls(Xe(ye,"coreBuddyAchievements",t.id)),Pe=De.exists()?De.data():{clientId:t.id,badges:[],totalVolume:0},st=Pe.totalVolume||0,Ge=st+ve,nt=[];v6.forEach(X=>{Ge>=X.threshold&&st<X.threshold&&(Pe.badges.some(Ke=>Ke.type==="volume_milestone"&&Ke.milestone===X.threshold)||nt.push({type:"volume_milestone",milestone:X.threshold,label:X.label,achievedAt:Rt.now()}))});const gt=[...Pe.badges,...nt];await Os(Xe(ye,"coreBuddyAchievements",t.id),{clientId:t.id,badges:gt,totalVolume:Math.round(Ge),updatedAt:Rt.now()}),nt.length>0&&ss(X=>[...X,...nt])}catch(De){console.error("Error updating volume:",De)}},Ps=async(ve,De,Pe)=>{if(t)try{const st=t.id,Ge=await Ls(Xe(ye,"coreBuddyPBs",st)),gt=(Ge.exists()?Ge.data():null)?.exercises||{},X=gt[ve];let ne=!1;if(X?(De>(X.weight||0)||De===(X.weight||0)&&Pe>(X.reps||0))&&(ne=!0):ne=!0,ne){const Ke={...gt,[ve]:{weight:De,reps:Pe,achievedAt:Rt.now()}};await Os(Xe(ye,"coreBuddyPBs",st),{clientId:t.id,exercises:Ke,updatedAt:Rt.now()}),jt(`New PB! ${De}kg  ${Pe} reps`,"success"),Yt(),await qs(ve,De)}}catch(st){console.error("Error checking PB:",st)}},qs=async(ve,De)=>{if(t)try{const Pe=await Ls(Xe(ye,"coreBuddyTargets",t.id));if(!Pe.exists())return;const Ge=(Pe.data().targets||{})[ve];if(!Ge||De<Ge.targetWeight)return;const nt=await Ls(Xe(ye,"coreBuddyAchievements",t.id)),gt=nt.exists()?nt.data():{clientId:t.id,badges:[],totalVolume:0};if(gt.badges.some(wt=>wt.type==="pb_target"&&wt.exercise===ve&&wt.targetWeight===Ge.targetWeight))return;const ne={type:"pb_target",exercise:ve,group:b6[ve]||"push",targetWeight:Ge.targetWeight,achievedAt:Rt.now()},Ke=[...gt.badges,ne];await Os(Xe(ye,"coreBuddyAchievements",t.id),{...gt,badges:Ke,updatedAt:Rt.now()}),ss(wt=>[...wt,ne])}catch(Pe){console.error("Error checking target badge:",Pe)}},os=Rs&&r.jsxs("div",{className:`toast-notification ${Rs.type}`,children:[Rs.type==="success"&&r.jsx("span",{children:" "}),Rs.message]}),_s=(ve,De)=>r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:De,"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:u?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})});if(i||x==="loading")return r.jsx("div",{className:"cb-loading",children:r.jsx("div",{className:"cb-loading-spinner"})});if(x==="browse")return g("/client/core-buddy/workouts",{replace:!0}),null;if(x==="overview"&&j){const ve=j;return r.jsx(Sa,{children:r.jsxs("div",{className:"pg-page","data-theme":u?"dark":"light","data-accent":p,children:[_s(ve.name,()=>g("/client/core-buddy/workouts")),r.jsxs("main",{className:"pg-main",children:[r.jsxs("div",{className:"pg-overview-hero",children:[r.jsx("svg",{className:"pg-overview-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:x6[ve.focus]})}),r.jsx("h2",{className:"pg-overview-name",children:ve.name}),r.jsx("p",{className:"pg-overview-desc",children:ve.description}),r.jsxs("div",{className:"pg-overview-stats",children:[r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:ve.duration}),r.jsx("span",{className:"pg-ov-stat-label",children:"Weeks"})]}),r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:ve.daysPerWeek}),r.jsx("span",{className:"pg-ov-stat-label",children:"Days/Week"})]}),r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:ve.duration*ve.daysPerWeek}),r.jsx("span",{className:"pg-ov-stat-label",children:"Sessions"})]})]})]}),r.jsx("div",{className:"pg-overview-days",children:ve.days.map((De,Pe)=>r.jsxs("div",{className:"pg-day-card",children:[r.jsxs("div",{className:"pg-day-header",children:[r.jsx("span",{className:"pg-day-name",children:De.name}),r.jsx("span",{className:"pg-day-label",children:De.label})]}),r.jsx("div",{className:"pg-day-exercises",children:De.exercises.map((st,Ge)=>{const nt=mh(st,1,ve);return r.jsxs("div",{className:"pg-day-ex",children:[r.jsx("span",{className:"pg-day-ex-name",children:st.name}),r.jsx("span",{className:"pg-day-ex-target",children:st.type==="timed"?`${nt.sets}${nt.time}s`:`${nt.sets}${nt.reps}`}),r.jsx("span",{className:`pg-day-ex-badge pg-badge-${st.type}`,children:st.type==="weighted"?"WT":st.type==="timed"?"TMR":"BW"})]},Ge)})})]},Pe))}),r.jsxs("div",{className:"pg-overview-note",children:[r.jsx("strong",{children:"Progressive Overload:"})," +",ve.repProg," reps/week",ve.timeProg?`, +${ve.timeProg}s/week for timed`:""]}),r.jsx("button",{className:"pg-start-btn",onClick:()=>Et(ve),children:"Start Programme"})]}),os]})})}if(x==="dashboard"){const ve=Pt();if(!ve)return _("browse"),null;const De=ps(),Pe=B?.completedSessions||{},st=De.totalSessions?Math.round(De.totalCompleted/De.totalSessions*100):0;return Math.round(De.totalCompleted/(De.totalSessions||1)*y6),r.jsx(Sa,{children:r.jsxs("div",{className:"pg-page","data-theme":u?"dark":"light","data-accent":p,children:[_s("Programme",()=>g("/client/core-buddy/workouts")),r.jsxs("main",{className:"pg-main",children:[r.jsxs("div",{className:"pg-dash-hero",children:[r.jsxs("div",{className:"pg-dash-ring-wrap",children:[r.jsxs("svg",{viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"pg-arc-track",cx:"100",cy:"100",r:"80"}),r.jsx("circle",{className:"pg-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-st/100*2*Math.PI*80})]}),r.jsxs("div",{className:"pg-ring-center",children:[r.jsxs("span",{className:"pg-ring-pct",children:[st,"%"]}),r.jsx("span",{className:"pg-ring-label",children:"complete"})]})]}),r.jsx("h2",{className:"pg-dash-name",children:ve.name}),r.jsxs("div",{className:"pg-dash-progress-text",children:[r.jsxs("span",{className:"pg-dash-pct",children:[st,"%"]}),r.jsxs("span",{className:"pg-dash-week",children:["Week ",De.currentWeek," of ",ve.duration]})]})]}),r.jsx("div",{className:"pg-weeks",children:Array.from({length:ve.duration},(Ge,nt)=>{const gt=nt+1,X=Kt(gt);return r.jsxs("div",{className:`pg-week-row${gt===De.currentWeek?" pg-week-current":""}`,children:[r.jsxs("span",{className:"pg-week-label",children:["W",gt]}),r.jsx("div",{className:"pg-week-days",children:ve.days.map((ne,Ke)=>{const wt=`w${gt}d${Ke}`,et=!!Pe[wt],_t=!et&&X,Q=!et&&!_t&&gt===De.currentWeek&&!De.complete;return r.jsx("button",{className:`pg-day-dot${et?" done":""}${_t?" missed":""}${Q?" next":""}`,disabled:!Q,onClick:()=>{Q&&hs(gt,Ke)},children:et?r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M20 6L9 17l-5-5"})}):_t?r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsx("span",{children:ne.name.replace("Day ","")})},Ke)})})]},nt)})}),!De.complete&&(()=>{const Ge=ve.days.map((nt,gt)=>({day:nt,d:gt})).filter(({d:nt})=>!Pe[`w${De.currentWeek}d${nt}`]);return Ge.length===0?null:r.jsxs("div",{className:"pg-next-session",children:[r.jsx("h3",{children:Ge.length===ve.daysPerWeek?"Choose a Session":"Remaining Sessions"}),r.jsxs("p",{className:"pg-next-info",children:["Week ",De.currentWeek,"  ",Ge.length," session",Ge.length!==1?"s":""," left this week"]}),Ge.map(({day:nt,d:gt})=>r.jsxs("div",{className:"pg-available-session",children:[r.jsxs("div",{className:"pg-next-exercises",children:[r.jsxs("span",{className:"pg-avail-day-label",children:[nt.name,": ",nt.label]}),nt.exercises.map((X,ne)=>{const Ke=mh(X,De.currentWeek,ve);return r.jsxs("div",{className:"pg-next-ex",children:[r.jsx("span",{className:"pg-next-ex-name",children:X.name}),r.jsx("span",{className:"pg-next-ex-target",children:X.type==="timed"?`${Ke.sets}${Ke.time}s`:`${Ke.sets}${Ke.reps}`})]},ne)})]}),r.jsxs("button",{className:"pg-start-btn",onClick:()=>hs(De.currentWeek,gt),children:["Start ",nt.name]})]},gt))]})})(),De.complete&&r.jsxs("div",{className:"pg-complete-msg",children:[r.jsx("h3",{children:"Programme Complete! "}),r.jsxs("p",{children:["You finished all ",De.totalSessions," sessions."]}),r.jsx("button",{className:"pg-start-btn",onClick:ot,children:"Choose New Programme"})]}),r.jsx("button",{className:"pg-quit-btn",onClick:()=>{confirm("Quit this programme? Progress will be lost.")&&ot()},children:"Quit Programme"})]}),r.jsx(Ta,{active:"workouts"}),os]})})}if(x==="session"){const ve=Pt();if(!ve)return null;const De=ve.days[Re],Pe=De.exercises[C],st=mh(Pe,Z,ve),Ge=I[C],nt=Ge?.sets?.length||0,gt=De.exercises.length,X=(C+nt/st.sets)/gt,ne=re[Pe.name],Ke=It(Z,Re,Pe.name);Pe.type==="timed"&&$e===0&&!fe&&nt===M&&setTimeout(()=>J(st.time),0);const wt=()=>{ne?.isGif?Ue(!qe):Ie.current&&(qe?Ie.current.pause():Ie.current.play(),Ue(!qe))};return r.jsxs("div",{className:"pg-page pg-page-session","data-theme":u?"dark":"light","data-accent":p,children:[r.jsx("div",{className:"pg-session-progress",children:r.jsx("div",{className:"pg-session-progress-fill",style:{width:`${X*100}%`}})}),r.jsxs("div",{className:"pg-session-header",children:[r.jsx("button",{className:"pg-session-back",onClick:()=>{confirm("Leave session? Progress will be lost.")&&_("dashboard")},children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M19 12H5M12 5l-7 7 7 7"})})}),r.jsxs("div",{className:"pg-session-title",children:[r.jsxs("span",{className:"pg-session-counter",children:[C+1," / ",gt]}),r.jsxs("span",{className:"pg-session-week",children:["Week ",Z,"  ",De.name]})]})]}),ne&&r.jsxs("div",{className:"pg-video-container",onClick:wt,children:[ne.isGif?r.jsx("img",{className:"pg-video",src:ne.url,alt:Pe.name}):r.jsx("video",{ref:Ie,className:"pg-video",src:ne.url,loop:!0,muted:!0,playsInline:!0},Pe.name),!qe&&r.jsxs("div",{className:"pg-video-overlay",children:[r.jsx("svg",{className:"pg-play-icon",viewBox:"0 0 24 24",fill:"white",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),r.jsx("span",{className:"pg-video-hint",children:"Tap for demo"})]})]}),r.jsx("div",{className:"pg-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"pg-exercise-card",children:[r.jsx("h2",{className:"pg-ex-name",children:Pe.name}),r.jsx("span",{className:`pg-ex-type-badge pg-badge-${Pe.type}`,children:Pe.type==="weighted"?"Weight + Reps":Pe.type==="timed"?"Timed":"Reps Only"}),Pe.type==="weighted"&&Ke&&r.jsxs("div",{className:"pg-last-week",children:[r.jsx("span",{className:"pg-last-week-label",children:"Last week:"}),r.jsxs("span",{className:"pg-last-week-value",children:[Ke.weight,"kg x ",Ke.reps," reps"]})]}),r.jsxs("div",{className:"pg-ex-set-info",children:[r.jsxs("span",{className:"pg-ex-set-num",children:["Set ",nt+1," of ",st.sets]}),r.jsxs("span",{className:"pg-ex-target",children:["Target: ",Pe.type==="timed"?`${st.time}s hold`:`${st.reps} reps`]})]}),Pe.type==="weighted"&&r.jsxs("div",{className:"pg-input-area",children:[r.jsxs("div",{className:"pg-input-group",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",value:A,onChange:et=>Oe(et.target.value),placeholder:"0",className:"pg-input"})]}),r.jsxs("div",{className:"pg-input-group",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",value:ht,onChange:et=>H(et.target.value),placeholder:String(st.reps),className:"pg-input"})]})]}),Pe.type==="reps"&&r.jsx("div",{className:"pg-input-area",children:r.jsxs("div",{className:"pg-input-group pg-input-single",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",value:ht,onChange:et=>H(et.target.value),placeholder:String(st.reps),className:"pg-input"})]})}),Pe.type==="timed"&&r.jsxs("div",{className:"pg-timer-area",children:[r.jsx("div",{className:"pg-timer-display",children:r.jsxs("span",{className:"pg-timer-value",children:[$e,"s"]})}),fe?r.jsx("button",{className:"pg-timer-btn pg-timer-stop",onClick:()=>Ve(!1),children:"Stop"}):r.jsx("button",{className:"pg-timer-btn",onClick:()=>{$e===0&&J(st.time),Ve(!0)},children:$e<st.time&&$e>0?"Resume":"Start Timer"})]}),r.jsx("button",{className:"pg-log-set-btn",onClick:ws,disabled:Pe.type==="timed"&&fe,children:nt+1<st.sets?"Log Set":C+1<gt?"Log Set  Next Exercise":"Log Set  Complete"}),Ge?.sets?.length>0&&r.jsx("div",{className:"pg-completed-sets",children:Ge.sets.map((et,_t)=>r.jsxs("div",{className:"pg-completed-set",children:[r.jsx("span",{className:"pg-completed-set-check",children:""}),r.jsxs("span",{children:["Set ",_t+1,": ",et.weight!==void 0?`${et.weight}kg  ${et.reps}`:et.time!==void 0?`${et.time}s`:`${et.reps} reps`]})]},_t))})]}),se&&(()=>{const _t=Pt()?.days[Re],Q=I.reduce((yt,at)=>yt+at.sets.length,0),Ae=I.reduce((yt,at)=>yt+at.sets.reduce((Zt,Qt)=>Zt+(Qt.weight||0)*(Qt.reps||0),0),0),Je=[{value:I.length,label:"Exercises"},{value:Q,label:"Sets"}];return Ae>0&&Je.push({value:Math.round(Ae).toLocaleString(),label:"Volume (kg)"}),r.jsx(Zh,{title:"Session Complete!",subtitle:`Week ${Z}  ${_t?.name}: ${_t?.label}`,stats:Je,buttonLabel:"Back to Programme",hideShare:!l,onShareJourney:t?ie:null,userName:t?.name,onDismissStart:()=>_("dashboard"),onDone:()=>{Y(!1)}})})(),mt&&r.jsx("div",{className:"pg-badge-celebration",onClick:()=>xt(null),children:r.jsxs("div",{className:"pg-badge-celebration-card",onClick:et=>et.stopPropagation(),children:[r.jsx("div",{className:"pg-badge-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pg-badge-celebration-title",children:mt.badges.length===1?"Badge Earned!":`${mt.badges.length} Badges Earned!`}),r.jsx("div",{className:"pg-badge-celebration-list",children:mt.badges.map((et,_t)=>r.jsx("div",{className:"pg-badge-celebration-item",children:et.type==="pb_target"?`${et.exercise}  ${et.targetWeight}kg`:et.label},_t))}),r.jsxs("div",{className:"pg-badge-share-row",children:[r.jsxs("button",{className:"pg-badge-share-btn",onClick:async et=>{et.stopPropagation();const _t=mt.badges[0],Q=mt.badges.map(Je=>Je.type==="pb_target"?`PB Target Hit: ${Je.exercise}  ${Je.targetWeight}kg`:Je.label),Ae=Un.find(Je=>Je.id===_t?.id)||Un.find(Je=>Je.name===_t?.label);await ie({type:"badge_earned",title:Q.length===1?Q[0]:`${Q.length} Badges Earned!`,badges:Q,badgeDesc:Ae?.desc}),jt("Posted to Journey!","success")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20h9"}),r.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4Z"})]}),"Journey"]}),r.jsxs("button",{className:"pg-badge-share-btn",onClick:async et=>{et.stopPropagation();const _t=mt.badges[0],Q=mt.badges.map(yt=>yt.type==="pb_target"?`PB Target Hit: ${yt.exercise}  ${yt.targetWeight}kg`:yt.label),Ae=Un.find(yt=>yt.id===_t?.id)||Un.find(yt=>yt.name===_t?.label),Je=`Badge Earned! ${Q.join(", ")}
#MindCoreFitness`;try{const yt=await nb({type:"badge",title:Q.length===1?Q[0]:"Badges Earned!",badges:Q,badgeImage:Ae?.img,badgeDesc:Ae?.desc});navigator.share&&navigator.canShare?.({files:[new File([yt],"badge.png",{type:"image/png"})]})?await navigator.share({title:"Mind Core Fitness",text:Je,files:[new File([yt],"badge.png",{type:"image/png"})]}):navigator.share?await navigator.share({title:"Mind Core Fitness",text:Je}):(await navigator.clipboard.writeText(Je),jt("Copied!","success"))}catch{try{await navigator.clipboard.writeText(Je),jt("Copied!","success")}catch{}}},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"18",cy:"5",r:"3"}),r.jsx("circle",{cx:"6",cy:"12",r:"3"}),r.jsx("circle",{cx:"18",cy:"19",r:"3"}),r.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),r.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),"Share"]})]}),r.jsx("button",{className:"pg-badge-celebration-dismiss",onClick:()=>xt(null),children:"Tap to dismiss"})]})}),os]})}return null}const _6={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},k6={push:{label:"Push",color:"#c75f6b",icon:"M4 12h3l3-9 4 18 3-9h3"},pull:{label:"Pull",color:"#5f8ac7",icon:"M12 2v10m0 0l-4-4m4 4l4-4M4 20h16"},lower:{label:"Lower",color:"#5fc77a",icon:"M12 2v8m-4 4l4 8 4-8m-8 0h8"},core:{label:"Core",color:"#c7a45f",icon:"M12 2a4 4 0 014 4v1h-2V6a2 2 0 10-4 0v1H8V6a4 4 0 014-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"}},eg=[{threshold:1e3,label:"1 Tonne",icon:"1T"},{threshold:5e3,label:"5 Tonne",icon:"5T"},{threshold:1e4,label:"10 Tonne",icon:"10T"},{threshold:25e3,label:"25 Tonne",icon:"25T"},{threshold:5e4,label:"50 Tonne",icon:"50T"},{threshold:1e5,label:"100 Tonne",icon:"100T"},{threshold:25e4,label:"250 Tonne",icon:"250T"},{threshold:5e5,label:"500 Tonne",icon:"500T"},{threshold:1e6,label:"1 Million kg",icon:"1M"}];function j6(n){return _6[n]||"push"}function T6(n){return n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}T`:`${Math.round(n)}`}function S6(n){return n>=1e6?"million kg":n>=1e3?"tonnes":"kg"}function E6(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Lr(),{isDark:l,toggleTheme:u,accent:d}=Ca(),p=rr(),[g,y]=b.useState(!0),[x,_]=b.useState(null),[j,O]=b.useState({}),[K,B]=b.useState([]),[D,se]=b.useState(null),[Y,Z]=b.useState(0),[je,Re]=b.useState({});b.useRef(null),b.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),b.useEffect(()=>{if(!t)return;(async()=>{try{const[fe,Ve,$e,J]=await Promise.all([Ls(Xe(ye,"coreBuddyAchievements",t.id)),Ls(Xe(ye,"coreBuddyPBs",t.id)),Ls(Xe(ye,"achievements",t.id)),Es(Ds(qt(ye,"workoutLogs"),bs("clientId","==",t.id)))]);fe.exists()&&_(fe.data()),Ve.exists()&&O(Ve.data().exercises||{}),$e.exists()&&(B(Object.keys($e.data().badges||{})),Re($e.data().progress||{})),Z(J.docs.length)}catch(fe){console.error("Error loading achievements:",fe)}y(!1)})()},[t]);const ke=x?.badges||[],C=x?.totalVolume||0,T=ke.filter(H=>H.type==="pb_target"),M=ke.filter(H=>H.type==="volume_milestone"),V={push:[],pull:[],lower:[],core:[]};T.forEach(H=>{const fe=H.group||j6(H.exercise);V[fe]&&V[fe].push(H)});const I=eg.find(H=>C<H.threshold),L=eg.filter(H=>C>=H.threshold).pop()?.threshold||0,A=I?(C-L)/(I.threshold-L):1;if(i||g)return r.jsxs("div",{className:"ach-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsx("div",{className:"ach-loading-inline",children:r.jsx("div",{className:"cb-loading-spinner"})})]});const Oe=ke.length+K.length,ht=Oe>0||C>0||Y>0;return r.jsx(Sa,{children:r.jsxs("div",{className:"ach-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"ach-main",children:[r.jsx("button",{className:"nut-back-btn",onClick:()=>p("/client/personal-bests?mode=corebuddy"),children:" Back"}),r.jsxs("div",{className:"ach-stats-banner",children:[r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:Oe}),r.jsx("span",{className:"ach-stat-label",children:Oe===1?"Badge":"Badges"})]}),r.jsx("div",{className:"ach-stat-divider"}),r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:T6(C)}),r.jsxs("span",{className:"ach-stat-label",children:[S6(C)," lifted"]})]}),r.jsx("div",{className:"ach-stat-divider"}),r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:Object.keys(j).length}),r.jsx("span",{className:"ach-stat-label",children:"PBs"})]})]}),!ht&&r.jsxs("div",{className:"ach-empty",children:[r.jsx("div",{className:"ach-empty-icon",children:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[r.jsx("path",{d:"M12 15l-3-3h6l-3 3z"}),r.jsx("path",{d:"M5 7h14l-1.5 9h-11L5 7z"}),r.jsx("path",{d:"M8.5 7V5a3.5 3.5 0 017 0v2"})]})}),r.jsx("h4",{children:"No achievements yet"}),r.jsx("p",{children:"Complete workouts to track volume and set PB targets to start earning badges."})]}),[{key:"workouts",title:"Workout Badges",iconPath:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"},{key:"streaks",title:"Streak Badges",iconPath:"M13.5.67s.74 2.65.74 4.8c0 2.06-1.35 3.73-3.41 3.73-2.07 0-3.63-1.67-3.63-3.73l.03-.36C5.21 7.51 4 10.62 4 14c0 4.42 3.58 8 8 8s8-3.58 8-8C20 8.61 17.41 3.8 13.5.67z"},{key:"pbs",title:"Personal Best Badges",iconPath:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"},{key:"nutrition",title:"Nutrition Badges",iconPath:"M18.06 23h1.66c.84 0 1.53-.65 1.63-1.47L23 5.05h-5V1h-2v4.05h-5l.3 2.34c1.71.47 3.31 1.32 4.27 2.26 1.44 1.42 2.43 2.89 2.43 5.29V23zM1 22v-1h15.03v1c0 .55-.45 1-1.01 1H2.01c-.56 0-1.01-.45-1.01-1zm15.03-7c0-4.87-4.66-5.84-8.03-5.97l.72 5.52L1 15.05v5.95h15.03V15z"},{key:"habits",title:"Habit Badges",iconPath:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"},{key:"leaderboard",title:"Leaderboard Badges",iconPath:"M7.5 21H2V9h5.5v12zm7.25-18h-5.5v18h5.5V3zM22 11h-5.5v10H22V11z"}].map(H=>{const fe=Un.filter(J=>J.category===H.key);if(fe.length===0)return null;const Ve=(()=>{switch(H.key){case"workouts":return Y;case"streaks":return je.streakWeeks||0;case"pbs":return Object.keys(j).length;case"nutrition":return je.nutritionStreak||0;case"leaderboard":return t?.leaderboardOptIn?1:0;case"habits":return je.habitStreak||0;default:return 0}})(),$e=fe.filter(J=>K.includes(J.id)).length;return r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:H.iconPath})}),H.title]}),r.jsx("div",{className:"ach-workout-carousel",children:fe.map(J=>{const P=K.includes(J.id);return r.jsxs("button",{className:`ach-workout-badge${P?" unlocked":" locked"}`,onClick:()=>se(J),children:[r.jsx("img",{src:J.img,alt:J.name,className:"ach-workout-badge-img"}),!P&&J.threshold&&r.jsx("div",{className:"ach-workout-badge-progress",children:r.jsx("div",{className:"ach-workout-badge-progress-fill",style:{width:`${Math.min(Ve/J.threshold*100,100)}%`}})})]},J.id)})}),r.jsxs("p",{className:"ach-workout-badges-count",children:[$e,"/",fe.length," unlocked"]})]},H.key)}),D&&r.jsx("div",{className:"ach-badge-overlay",onClick:()=>se(null),children:r.jsxs("div",{className:"ach-badge-overlay-content",onClick:H=>H.stopPropagation(),children:[r.jsx("img",{src:D.img,alt:D.name,className:`ach-badge-overlay-img${K.includes(D.id)?"":" ach-badge-overlay-img-locked"}`}),r.jsx("p",{className:"ach-badge-overlay-desc",children:D.desc}),K.includes(D.id)?r.jsx("span",{className:"ach-badge-overlay-status unlocked",children:"Unlocked"}):r.jsx("span",{className:"ach-badge-overlay-status locked",children:"Locked"}),r.jsx("button",{className:"ach-badge-overlay-close",onClick:()=>se(null),children:"Tap to close"})]})}),r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})}),"Volume Milestones"]}),r.jsxs("div",{className:"ach-volume-hero",children:[r.jsxs("div",{className:"ach-volume-ring",children:[r.jsx("svg",{className:"ach-volume-ring-svg",viewBox:"0 0 200 200",children:Yk.map((H,fe)=>{const Ve=fe<Math.round(A*60);return r.jsx("line",{x1:H.x1,y1:H.y1,x2:H.x2,y2:H.y2,className:Ve?"ach-tick-filled":"ach-tick-empty",strokeWidth:H.thick?"3":"2"},fe)})}),r.jsxs("div",{className:"ach-volume-center",children:[r.jsx("span",{className:"ach-volume-number",children:Math.round(C).toLocaleString()}),r.jsx("span",{className:"ach-volume-unit",children:"kg lifted"})]})]}),I&&r.jsxs("div",{className:"ach-volume-next",children:["Next: ",r.jsx("strong",{children:I.label})," (",(I.threshold-C).toLocaleString(),"kg to go)"]})]}),r.jsx("div",{className:"ach-milestone-shelf",children:eg.map((H,fe)=>{const Ve=C>=H.threshold,$e=M.find(J=>J.milestone===H.threshold);return r.jsxs("div",{className:`ach-milestone ${Ve?"unlocked":"locked"}`,children:[r.jsx("div",{className:"ach-milestone-hex",children:r.jsx("span",{className:"ach-milestone-icon",children:H.icon})}),r.jsx("span",{className:"ach-milestone-label",children:H.label}),$e?.achievedAt&&r.jsx("span",{className:"ach-milestone-date",children:($e.achievedAt.toDate?$e.achievedAt.toDate():new Date($e.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short"})})]},fe)})})]}),r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"PB Target Badges"]}),T.length===0?r.jsx("div",{className:"ach-pb-empty",children:r.jsxs("p",{children:["Set targets on your personal bests to start earning badges. Go to ",r.jsx("strong",{children:"My Progress"}),' and tap "Set Target" on any PB.']})}):Object.entries(V).map(([H,fe])=>{if(fe.length===0)return null;const Ve=k6[H];return r.jsxs("div",{className:"ach-group",children:[r.jsxs("div",{className:"ach-group-header",style:{borderLeftColor:Ve.color},children:[r.jsx("span",{className:"ach-group-label",style:{color:Ve.color},children:Ve.label}),r.jsx("span",{className:"ach-group-count",children:fe.length})]}),r.jsx("div",{className:"ach-badge-grid",children:fe.map(($e,J)=>r.jsxs("div",{className:"ach-badge-card",style:{animationDelay:`${J*.06}s`,"--group-color":Ve.color},children:[r.jsx("div",{className:"ach-badge-hex",style:{borderColor:Ve.color,boxShadow:`0 0 12px ${Ve.color}33`},children:r.jsx("svg",{className:"ach-badge-hex-icon",viewBox:"0 0 24 24",fill:"none",stroke:Ve.color,strokeWidth:"2",strokeLinecap:"round",children:r.jsx("path",{d:Ve.icon})})}),r.jsxs("div",{className:"ach-badge-info",children:[r.jsx("span",{className:"ach-badge-exercise",children:$e.exercise}),r.jsxs("span",{className:"ach-badge-value",style:{color:Ve.color},children:[$e.targetWeight,"kg"]}),$e.achievedAt&&r.jsx("span",{className:"ach-badge-date",children:($e.achievedAt.toDate?$e.achievedAt.toDate():new Date($e.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})})]})]},J))})]},H)})]})]}),r.jsx(Ta,{active:"home"})]})})}const N6=[{key:"trained",label:"Trained",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4",color:"#A12F3A",darkColor:"#E8475A"},{key:"protein",label:"Hit Protein",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z",color:"#4caf50",darkColor:"#5CDB61"},{key:"steps",label:"10k Steps",icon:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20M4 12.5A2.5 2.5 0 0 1 6.5 10H20M4 5.5A2.5 2.5 0 0 1 6.5 3H20",color:"#ff9800",darkColor:"#FFB020"},{key:"sleep",label:"8hrs Sleep",icon:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z",color:"#7c3aed",darkColor:"#9B5AF2"},{key:"water",label:"2L Water",icon:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z",color:"#2196f3",darkColor:"#42A5F5"}],C6="M12 2l2.4 7.2L22 12l-7.6 2.8L12 22l-2.4-7.2L2 12l7.6-2.8z",R6="#e91e63",A6="#FF4D88",M6=700,Og=42,zl=2*Math.PI*Og,fh=["Every day counts. See you tomorrow!","Consistency is your superpower.","Perfect day  keep the streak alive!","You showed up for yourself today."];function I6(n){const e=new Date(n),t=e.getDay(),i=t===0?-6:1-t;return e.setDate(e.getDate()+i),e.setHours(0,0,0,0),e}function Ho(n){return n.toISOString().split("T")[0]}function D6(n){return Array.from({length:7},(e,t)=>{const i=new Date(n);return i.setDate(n.getDate()+t),i})}function P6(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Lr(),{isDark:l,toggleTheme:u,accent:d}=Ca(),{isPremium:p,FREE_HABIT_LIMIT:g}=yc(),y=rr(),[x,_]=b.useState({}),[j,O]=b.useState([]),[K,B]=b.useState(!0),[D,se]=b.useState(!1),[Y,Z]=b.useState(0),[je,Re]=b.useState(null),[ke,C]=b.useState(null),[T,M]=b.useState(!1),[V,I]=b.useState(!1),[L,A]=b.useState(!1),[Oe,ht]=b.useState(!1),[H,fe]=b.useState(""),[Ve,$e]=b.useState(null),[J,P]=b.useState([]),[re,Fe]=b.useState(null),qe=b.useRef(null),Ue=b.useRef(null),Ie=b.useRef(null),mt=b.useRef(null),xt=b.useRef(!1),it=b.useRef({}),ss=b.useRef([]),Rs=b.useRef([]),Ut=b.useRef(null),jt=b.useRef(fh[Math.floor(Math.random()*fh.length)]),ie=b.useCallback((Q,Ae="info")=>{Re({message:Q,type:Ae}),setTimeout(()=>Re(null),3e3)},[]),Mt=new Date,St=Ho(Mt),Yt=I6(Mt),Tt=D6(Yt),Et=["M","T","W","T","F","S","S"],ot=(Q,Ae)=>l&&Ae?Ae:Q,Pt=[...N6.filter(Q=>!J.includes(Q.key)).map(Q=>({...Q,color:ot(Q.color,Q.darkColor)})),...j.map(Q=>({key:`custom_${Q.id}`,label:Q.label,icon:C6,color:ot(R6,A6),isCustom:!0,id:Q.id}))],Gt=p?Pt:Pt.slice(0,g);b.useEffect(()=>{!i&&(!n||!e)&&y("/")},[n,e,i,y]),b.useEffect(()=>{if(!n||!t)return;(async()=>{try{const Ae=qt(ye,"habitLogs"),Je=Ds(Ae,bs("clientId","==",t.id)),yt=await Es(Je),at={};yt.docs.forEach(be=>{const Ee=be.data();at[Ee.date]={...Ee,_id:be.id}}),_(at);const Zt=await Ls(Xe(ye,"customHabits",t.id));if(Zt.exists()){const be=Zt.data();O(be.habits||[]),P(be.hiddenDefaults||[])}let Qt=0;const U=new Date(Mt);for(;;){const be=Ho(U),Ee=at[be];if(Ee)if(Object.values(Ee.habits||{}).filter(Boolean).length>=3)Qt++,U.setDate(U.getDate()-1);else break;else if(be===St)U.setDate(U.getDate()-1);else break}Z(Qt)}catch(Ae){console.error("Error loading habit logs:",Ae)}finally{B(!1)}})()},[n,t]);const ps=x[St]||{habits:{}};b.useEffect(()=>{Object.values(ps.habits||{}).filter(Boolean).length<Gt.length&&L&&A(!1)},[Gt.length,ps.habits]);const Kt=async Q=>{if(!(!n||D||ps.habits?.[Q])){ss.current=[...Array(10)].map((Je,yt)=>{const at=yt/10*2*Math.PI,Zt=18+Math.random()*20;return{tx:Math.cos(at)*Zt,ty:Math.sin(at)*Zt,size:3+Math.random()*4,duration:.4+Math.random()*.3}}),C(Q),setTimeout(()=>C(null),700),navigator.vibrate&&navigator.vibrate(50),se(!0);try{const yt={...ps.habits||{},[Q]:!0},at=ps._id||`${t.id}_${St}`;_(Qt=>({...Qt,[St]:{clientId:t.id,date:St,habits:yt,_id:at}})),await Os(Xe(ye,"habitLogs",at),{clientId:t.id,date:St,habits:yt}),Object.values(yt).filter(Boolean).length===Gt.length&&!L&&(jt.current=fh[Math.floor(Math.random()*fh.length)],Rs.current=[...Array(80)].map((Qt,U)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#4caf50","#ff9800","#2196f3","#e91e63","#ffeb3b","#FFD700","#ffffff","#9c27b0"][U%9],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:U%3})),setTimeout(()=>{M(!0),A(!0),setTimeout(()=>Ut.current?.focus(),1100)},400))}catch(Je){console.error("Error saving habit:",Je),ie("Failed to save. Try again.","error"),_(yt=>({...yt,[St]:{...yt[St],habits:{...yt[St]?.habits||{},[Q]:!1}}}))}finally{se(!1)}}},It=async Q=>{if(!(!n||D)){se(!0);try{const Je={...ps.habits||{},[Q]:!1},yt=ps._id||`${t.id}_${St}`;await Os(Xe(ye,"habitLogs",yt),{clientId:t.id,date:St,habits:Je}),_(at=>({...at,[St]:{clientId:t.id,date:St,habits:Je,_id:yt}}))}catch(Ae){console.error("Error undoing habit:",Ae),ie("Failed to undo. Try again.","error")}finally{se(!1)}}},hs=Q=>{if(ps.habits?.[Q]||!1||D||mt.current)return;mt.current=Q,Fe(Q),Ue.current=performance.now();const Je=it.current[Q];Je&&(Je.style.strokeDashoffset=zl);const yt=at=>{const Zt=at-Ue.current,Qt=Math.min(Zt/M6,1),U=it.current[Q];U&&(U.style.strokeDashoffset=zl-Qt*zl),Qt<1?Ie.current=requestAnimationFrame(yt):(mt.current=null,xt.current=!0,Ie.current=null,Fe(null),Kt(Q))};Ie.current=requestAnimationFrame(yt)},ws=()=>{if(!mt.current)return;const Q=mt.current;mt.current=null,Ie.current&&(cancelAnimationFrame(Ie.current),Ie.current=null),qe.current&&(clearTimeout(qe.current),qe.current=null),it.current[Q]&&(it.current[Q].style.strokeDashoffset=zl),Fe(null),Ue.current=null};b.useEffect(()=>()=>{Ie.current&&cancelAnimationFrame(Ie.current),qe.current&&clearTimeout(qe.current)},[]);const is=b.useCallback(async Q=>{if(!t)throw new Error("Not signed in");const Ae=Q&&typeof Q=="object"&&Q.type;await Kr(qt(ye,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Ae?"":Q,type:Ae?Q.type:"text",imageURL:null,createdAt:yr(),likeCount:0,commentCount:0,...Ae?{metadata:{title:Q.title||"",subtitle:Q.subtitle||"",stats:Q.stats||[],quote:Q.quote||"",badges:Q.badges||[]}}:{}})},[t]),Xs=async()=>{const Q=H.trim();if(!Q)return;if(!t?.id){ie("Still loading, try again","error");return}const Ae=Date.now().toString(36),Je=[...j,{id:Ae,label:Q}];try{await Os(Xe(ye,"customHabits",t.id),{clientId:t.id,habits:Je,hiddenDefaults:J},{merge:!0}),O(Je),fe(""),ht(!1),ie(`Added "${Q}"`,"success")}catch(yt){console.error("Error adding custom habit:",yt),ie(yt?.code==="permission-denied"?"Permission denied  check Firestore rules for customHabits":`Failed to add habit: ${yt?.message||"Unknown error"}`,"error")}},Ps=async Q=>{if(!t?.id)return;const Ae=j.filter(Je=>Je.id!==Q);try{await Os(Xe(ye,"customHabits",t.id),{clientId:t.id,habits:Ae,hiddenDefaults:J},{merge:!0}),O(Ae),$e(null),ie("Habit removed","success")}catch(Je){console.error("Error deleting habit:",Je),ie("Failed to remove","error")}},qs=async Q=>{if(!t?.id)return;const Ae=[...J,Q];try{await Os(Xe(ye,"customHabits",t.id),{clientId:t.id,habits:j,hiddenDefaults:Ae},{merge:!0}),P(Ae),$e(null),ie("Habit removed","success")}catch(Je){console.error("Error hiding default habit:",Je),ie("Failed to remove","error")}},os=Tt.map(Q=>{const Ae=Ho(Q),Je=x[Ae],yt=Je?Object.values(Je.habits||{}).filter(Boolean).length:0;return{date:Q,dateStr:Ae,completed:yt,total:Gt.length}}),_s=os.reduce((Q,Ae)=>Q+Ae.completed,0),ve=os.reduce((Q,Ae)=>Q+Ae.total,0),De=ve>0?Math.round(_s/ve*100):0,Pe=Object.values(ps.habits||{}).filter(Boolean).length,st=Gt.length>0?Math.round(Pe/Gt.length*100):0,Ge=Pe===Gt.length&&Gt.length>0,nt=(()=>{const Q=Object.keys(x).sort();let Ae=0,Je=0,yt=null;for(const at of Q){const Zt=x[at];if(Object.values(Zt.habits||{}).filter(Boolean).length>=3){if(yt){const U=new Date(yt);Je=(new Date(at)-U)/(1e3*60*60*24)===1?Je+1:1}else Je=1;Je>Ae&&(Ae=Je),yt=at}else Je=0,yt=null}return Math.max(Ae,Y)})(),gt=new Date(Mt.getFullYear(),Mt.getMonth(),1),X=gt.toLocaleString("default",{month:"long"}),ne=new Date(Mt.getFullYear(),Mt.getMonth()+1,0).getDate(),Ke=(gt.getDay()+6)%7,wt=Array.from({length:ne},(Q,Ae)=>{const Je=new Date(Mt.getFullYear(),Mt.getMonth(),Ae+1),yt=Ho(Je),at=x[yt],Zt=at?Object.values(at.habits||{}).filter(Boolean).length:0,Qt=Je>Mt;return{day:Ae+1,dateStr:yt,completed:Zt,total:Gt.length,isFuture:Qt,isToday:yt===St}}),et=Gt.map(Q=>({...Q,days:Tt.map(Ae=>{const Je=Ho(Ae);return x[Je]?.habits?.[Q.key]||!1})})),_t=os.filter(Q=>Q.completed===Q.total&&Q.total>0).length;return r.jsx(Sa,{children:r.jsxs("div",{className:"cbc-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>y("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),i||K?r.jsx("div",{className:"cbc-loading-inline",children:r.jsx("div",{className:"cbc-loading-spinner"})}):r.jsxs("main",{className:"cbc-main",children:[r.jsxs("div",{className:"cbc-hero anim-fade-up",children:[r.jsxs("div",{className:`cbc-progress-ring${Ge?" cbc-ring-complete":""}`,children:[r.jsxs("svg",{viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"cbc-arc-track",cx:"100",cy:"100",r:"80"}),r.jsx("circle",{className:"cbc-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-st/100*2*Math.PI*80})]}),r.jsxs("div",{className:"cbc-ring-center",children:[r.jsxs("span",{className:"cbc-ring-count",children:[Pe,r.jsx("span",{className:"cbc-ring-divider",children:"/"}),Gt.length]}),r.jsx("span",{className:"cbc-ring-label",children:Ge?"complete":"today"})]})]}),r.jsx("p",{className:"cbc-hero-tagline",children:Ge?"You showed up for yourself today.":Pe===0?"Start your day strong.":`${Gt.length-Pe} to go  keep pushing.`})]}),r.jsxs("div",{className:"cbc-streak-card anim-fade-up-d1",children:[r.jsx("div",{className:"cbc-streak-icon",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})})}),r.jsxs("div",{className:"cbc-streak-info",children:[r.jsx("span",{className:"cbc-streak-count",children:Y}),r.jsx("span",{className:"cbc-streak-label",children:"day streak"})]}),r.jsxs("div",{className:"cbc-streak-best",children:[r.jsx("span",{className:"cbc-streak-best-val",children:nt}),r.jsx("span",{className:"cbc-streak-best-label",children:"best"})]})]}),r.jsxs("div",{className:"cbc-section anim-fade-up-d2",children:[r.jsx("h2",{className:"cbc-section-title",children:"Today's Habits"}),r.jsxs("div",{className:"cbc-habits-grid",children:[Gt.map(Q=>{const Ae=ps.habits?.[Q.key]||!1,Je=ke===Q.key,yt=re===Q.key;return r.jsxs("div",{className:`cbc-habit-tile ${Ae?"cbc-habit-done":""} ${Je?"cbc-habit-just-checked":""}`,style:{"--habit-color":Q.color},children:[p&&r.jsx("button",{className:"cbc-habit-delete",onClick:at=>{at.stopPropagation(),$e(Q.isCustom?{type:"custom",id:Q.id,label:Q.label}:{type:"default",key:Q.key,label:Q.label})},"aria-label":`Remove ${Q.label}`,children:r.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),r.jsxs("div",{className:`cbc-habit-ring-touch ${yt?"cbc-holding":""} ${Ae?"cbc-ring-completed":""}`,onPointerDown:at=>{Ae||(at.preventDefault(),hs(Q.key))},onPointerUp:ws,onPointerLeave:ws,onPointerCancel:ws,onClick:at=>{if(at.stopPropagation(),xt.current){xt.current=!1;return}Ae&&It(Q.key)},role:"button",tabIndex:0,"aria-label":Ae?`Undo ${Q.label}`:`Press and hold to complete ${Q.label}`,onKeyDown:at=>{(at.key==="Enter"||at.key===" ")&&(at.preventDefault(),Ae?It(Q.key):Kt(Q.key))},children:[r.jsxs("svg",{className:"cbc-habit-ring-svg",viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cbc-habit-ring-track",cx:"50",cy:"50",r:Og}),r.jsx("circle",{className:"cbc-habit-ring-fill",ref:at=>{at&&(it.current[Q.key]=at)},cx:"50",cy:"50",r:Og,style:{stroke:Q.color,strokeDasharray:zl,strokeDashoffset:Ae?0:zl}})]}),Ae&&r.jsx("div",{className:"cbc-habit-glow-orb",style:{"--habit-color":Q.color}}),r.jsx("div",{className:"cbc-habit-ring-icon",style:{color:Q.color},children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:Q.icon})})}),Je&&r.jsx("div",{className:"cbc-particles",children:ss.current.map((at,Zt)=>r.jsx("span",{className:"cbc-particle",style:{"--tx":`${at.tx}px`,"--ty":`${at.ty}px`,"--size":`${at.size}px`,"--particle-color":Q.color,animationDuration:`${at.duration}s`}},Zt))})]}),r.jsx("span",{className:"cbc-habit-label",children:Q.label}),Ae?r.jsx("span",{className:"cbc-habit-done-tag",children:"Done"}):r.jsx("span",{className:"cbc-habit-hold-hint",children:"Hold to complete"})]},Q.key)}),p?r.jsxs("div",{className:"cbc-habit-tile cbc-add-tile",onClick:()=>ht(!0),role:"button",tabIndex:0,children:[r.jsx("div",{className:"cbc-add-ring",children:r.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})}),r.jsx("span",{className:"cbc-habit-label",children:"Add Habit"}),r.jsx("span",{className:"cbc-habit-hold-hint",children:"Your own"})]}):r.jsxs("div",{className:"cbc-habit-tile cbc-unlock-tile",onClick:()=>y("/upgrade"),role:"button",tabIndex:0,children:[r.jsx("div",{className:"cbc-unlock-ring",children:r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),r.jsx("span",{className:"cbc-habit-label",children:"More Habits"}),r.jsx("span",{className:"cbc-habit-hold-hint",children:"Custom & editable"})]})]})]}),r.jsxs("div",{className:"cbc-section anim-fade-up-d3",children:[r.jsxs("div",{className:"cbc-section-header",children:[r.jsx("h2",{className:"cbc-section-title",children:"This Week"}),r.jsxs("span",{className:"cbc-section-badge",children:[_t,"/7 perfect"]})]}),r.jsxs("div",{className:"cbc-weekly-card",children:[r.jsxs("div",{className:"cbc-weekly-header",children:[r.jsx("span",{className:"cbc-weekly-habit-name"}),Et.map((Q,Ae)=>r.jsx("span",{className:`cbc-weekly-day-label${Tt[Ae]&&Ho(Tt[Ae])===St?" cbc-today-label":""}`,children:Q},Ae))]}),et.map(Q=>(Q.days.filter(Boolean).length,r.jsxs("div",{className:"cbc-weekly-row",children:[r.jsx("span",{className:"cbc-weekly-habit-name",style:{color:Q.color},children:Q.label}),Q.days.map((Ae,Je)=>r.jsx("span",{className:`cbc-weekly-dot${Ae?" cbc-dot-done":""}${Tt[Je]&&Ho(Tt[Je])===St?" cbc-dot-today":""}`,style:Ae?{background:Q.color,borderColor:Q.color,boxShadow:`0 0 6px ${Q.color}40`}:void 0},Je))]},Q.key))),r.jsxs("div",{className:"cbc-week-summary",children:[r.jsx("div",{className:"cbc-week-summary-bar",children:r.jsx("div",{className:"cbc-week-summary-fill",style:{width:`${De}%`}})}),r.jsxs("span",{className:"cbc-week-summary-text",children:[_s,"/",ve," completed (",De,"%)"]})]})]})]}),r.jsxs("div",{className:"cbc-section anim-fade-up-d4",children:[r.jsx("h2",{className:"cbc-section-title",children:X}),r.jsxs("div",{className:"cbc-calendar-card",children:[r.jsx("div",{className:"cbc-cal-header",children:["M","T","W","T","F","S","S"].map((Q,Ae)=>r.jsx("span",{className:"cbc-cal-day-label",children:Q},Ae))}),r.jsxs("div",{className:"cbc-cal-grid",children:[Array.from({length:Ke},(Q,Ae)=>r.jsx("span",{className:"cbc-cal-cell cbc-cal-empty"},`e${Ae}`)),wt.map(Q=>{const Ae=Q.total>0?Q.completed/Q.total:0,Je=Q.isFuture?-1:Ae===0?0:Ae<.4?1:Ae<.75?2:Ae<1?3:4;return r.jsx("span",{className:`cbc-cal-cell${Q.isToday?" cbc-cal-today":""}${Je===4?" cbc-cal-perfect":""} cbc-cal-heat-${Je<0?"future":Je}`,children:Q.day},Q.day)})]}),r.jsxs("div",{className:"cbc-cal-legend",children:[r.jsx("span",{className:"cbc-cal-legend-label",children:"Less"}),r.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-0"}),r.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-1"}),r.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-2"}),r.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-3"}),r.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-4"}),r.jsx("span",{className:"cbc-cal-legend-label",children:"More"})]})]})]})]}),r.jsx(Ta,{active:"home"}),Oe&&r.jsx("div",{className:"cbc-modal-overlay",onClick:()=>ht(!1),children:r.jsxs("div",{className:"cbc-modal",onClick:Q=>Q.stopPropagation(),children:[r.jsx("h3",{className:"cbc-modal-title",children:"Add Habit"}),r.jsx("p",{className:"cbc-modal-desc",children:"Track something personal to your routine."}),r.jsx("input",{className:"cbc-modal-input",type:"text",placeholder:"e.g. Meditate, Stretch, Read...",value:H,onChange:Q=>fe(Q.target.value),maxLength:30,autoFocus:!0,onKeyDown:Q=>Q.key==="Enter"&&Xs()}),r.jsxs("div",{className:"cbc-modal-actions",children:[r.jsx("button",{className:"cbc-modal-cancel",onClick:()=>{ht(!1),fe("")},children:"Cancel"}),r.jsx("button",{className:"cbc-modal-save",onClick:Xs,disabled:!H.trim(),children:"Add"})]})]})}),Ve&&r.jsx("div",{className:"cbc-modal-overlay",onClick:()=>$e(null),children:r.jsxs("div",{className:"cbc-modal",onClick:Q=>Q.stopPropagation(),children:[r.jsxs("h3",{className:"cbc-modal-title",children:['Remove "',Ve.label,'"?']}),r.jsx("p",{className:"cbc-modal-desc",children:"This will remove the habit from your daily tracker. Past logs won't be affected."}),r.jsxs("div",{className:"cbc-modal-actions",children:[r.jsx("button",{className:"cbc-modal-cancel",onClick:()=>$e(null),children:"Keep"}),r.jsx("button",{className:"cbc-modal-delete",onClick:()=>Ve.type==="custom"?Ps(Ve.id):qs(Ve.key),children:"Remove"})]})]})}),T&&r.jsx(Zh,{title:"All Habits Complete!",subtitle:jt.current,stats:[{value:`${Pe}/${Gt.length}`,label:"Habits"},{value:Y||1,label:"Day Streak"}],buttonLabel:"Keep Going",holdLabel:"Hold To Complete Today's Habits",shareType:"habits",hideShare:!p,onShareJourney:t?is:null,userName:t?.name,onDone:()=>{M(!1),I(!1)}}),je&&r.jsx("div",{className:`toast-notification ${je.type}`,children:je.message})]})})}function ph(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function L2(n,e){return[n,e].sort().join("_")}function L6(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Lr(),{isDark:l,toggleTheme:u}=Ca(),d=rr(),[p,g]=b.useState("buddies"),[y,x]=b.useState([]),[_,j]=b.useState([]),[O,K]=b.useState([]),[B,D]=b.useState(""),[se,Y]=b.useState([]),[Z,je]=b.useState([]),[Re,ke]=b.useState(!0),[C,T]=b.useState(null),[M,V]=b.useState(null),I=b.useCallback((J,P="info")=>{V({message:J,type:P}),setTimeout(()=>V(null),3500)},[]);b.useEffect(()=>{!i&&(!n||!e)&&d("/")},[n,e,i,d]);const L=b.useCallback(async()=>{if(t){ke(!0);try{const J=t.id,re=(await Es(qt(ye,"clients"))).docs.map(it=>({id:it.id,...it.data()}));je(re);const Fe=Object.fromEntries(re.map(it=>[it.id,it])),qe=await Es(Ds(qt(ye,"buddies"),bs("user1","==",J))),Ue=await Es(Ds(qt(ye,"buddies"),bs("user2","==",J))),Ie=new Set;[...qe.docs,...Ue.docs].forEach(it=>{const ss=it.data(),Rs=ss.user1===J?ss.user2:ss.user1;Ie.add(Rs)}),x(Array.from(Ie).map(it=>Fe[it]).filter(Boolean));const mt=await Es(Ds(qt(ye,"buddyRequests"),bs("toId","==",J),bs("status","==","pending")));j(mt.docs.map(it=>({reqId:it.id,...it.data(),fromClient:Fe[it.data().fromId]})).filter(it=>it.fromClient));const xt=await Es(Ds(qt(ye,"buddyRequests"),bs("fromId","==",J),bs("status","==","pending")));K(xt.docs.map(it=>({reqId:it.id,...it.data(),toClient:Fe[it.data().toId]})).filter(it=>it.toClient))}catch(J){console.error("Error fetching buddy data:",J),I("Failed to load buddies","error")}finally{ke(!1)}}},[t,I]);b.useEffect(()=>{L()},[L]),b.useEffect(()=>{if(!B.trim()||!t){Y([]);return}const J=B.toLowerCase(),P=t.id,re=new Set(y.map(Ie=>Ie.id)),Fe=new Set(O.map(Ie=>Ie.toId)),qe=new Set(_.map(Ie=>Ie.fromId)),Ue=Z.filter(Ie=>Ie.id===P||!Ie.name||!Ie.coreBuddyAccess&&Ie.clientType!=="core_buddy"?!1:Ie.name.toLowerCase().includes(J)).map(Ie=>({...Ie,isBuddy:re.has(Ie.id),isPendingOut:Fe.has(Ie.id),isPendingIn:qe.has(Ie.id)})).slice(0,20);Y(Ue)},[B,Z,y,O,_,t]);const A=async(J,P)=>{if(!(!t||J===t.id))try{await Kr(qt(ye,"notifications"),{toId:J,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:P,read:!1,createdAt:yr()})}catch(re){console.error("Notification error:",re),re.code==="permission-denied"&&I("Notifications blocked  check Firestore rules","error")}},Oe=async J=>{T(J);try{const P=`${t.id}_${J}`;await Os(Xe(ye,"buddyRequests",P),{fromId:t.id,toId:J,status:"pending",createdAt:yr()}),await A(J,"buddy_request"),I("Buddy request sent!","success"),await L()}catch(P){console.error("Error sending request:",P),I("Failed to send request","error")}finally{T(null)}},ht=async J=>{T(J.reqId);try{const P=L2(J.fromId,t.id);await Os(Xe(ye,"buddies",P),{user1:[J.fromId,t.id].sort()[0],user2:[J.fromId,t.id].sort()[1],connectedAt:yr()}),await ur(Xe(ye,"buddyRequests",J.reqId)),await A(J.fromId,"buddy_accept"),I("Buddy added!","success"),await L()}catch(P){console.error("Error accepting request:",P),I("Failed to accept","error")}finally{T(null)}},H=async J=>{T(J.reqId);try{await ur(Xe(ye,"buddyRequests",J.reqId)),I("Request declined","info"),await L()}catch(P){console.error("Error declining:",P),I("Failed to decline","error")}finally{T(null)}},fe=async J=>{T(J.reqId);try{await ur(Xe(ye,"buddyRequests",J.reqId)),I("Request cancelled","info"),await L()}catch(P){console.error("Error cancelling:",P),I("Failed to cancel","error")}finally{T(null)}},Ve=async J=>{T(J);try{const P=L2(t.id,J);await ur(Xe(ye,"buddies",P)),I("Buddy removed","info"),await L()}catch(P){console.error("Error removing buddy:",P),I("Failed to remove buddy","error")}finally{T(null)}},$e=_.length;return i?r.jsx("div",{className:"bdy-loading",children:r.jsx("div",{className:"bdy-spinner"})}):!n||!e||!t?null:r.jsx(Sa,{children:r.jsxs("div",{className:"bdy-page","data-theme":l?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"bdy-main",children:[r.jsx("h1",{className:"bdy-title",children:"Buddies"}),r.jsxs("button",{className:"bdy-leaderboard-link",onClick:()=>d("/client/leaderboard"),children:[r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C7 4 7 7 7 7"}),r.jsx("path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5C17 4 17 7 17 7"}),r.jsx("rect",{x:"6",y:"9",width:"12",height:"13",rx:"2"}),r.jsx("path",{d:"M12 9v13"}),r.jsx("path",{d:"M2 22h20"})]}),r.jsx("span",{children:"Leaderboard"}),r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("div",{className:"bdy-tabs",children:[r.jsxs("button",{className:`bdy-tab${p==="buddies"?" active":""}`,onClick:()=>g("buddies"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("span",{children:"My Buddies"})]}),r.jsxs("button",{className:`bdy-tab${p==="requests"?" active":""}`,onClick:()=>g("requests"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("line",{x1:"19",y1:"8",x2:"19",y2:"14"}),r.jsx("line",{x1:"22",y1:"11",x2:"16",y2:"11"})]}),r.jsx("span",{children:"Requests"}),$e>0&&r.jsx("span",{className:"bdy-tab-badge",children:$e})]}),r.jsxs("button",{className:`bdy-tab${p==="search"?" active":""}`,onClick:()=>g("search"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("span",{children:"Find"})]})]}),Re?r.jsx("div",{className:"bdy-content-loading",children:r.jsx("div",{className:"bdy-spinner"})}):r.jsxs(r.Fragment,{children:[p==="buddies"&&r.jsx("div",{className:"bdy-section",children:y.length===0?r.jsxs("div",{className:"bdy-empty",children:[r.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("h3",{children:"No buddies yet"}),r.jsx("p",{children:"Find members and send buddy requests to connect!"}),r.jsx("button",{className:"bdy-empty-btn",onClick:()=>g("search"),children:"Find Buddies"})]}):r.jsx("div",{className:"bdy-list",children:y.map(J=>r.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${J.id}`),children:[r.jsx("div",{className:"bdy-avatar",children:J.photoURL?r.jsx("img",{src:J.photoURL,alt:J.name}):r.jsx("span",{children:ph(J.name)})}),r.jsx("div",{className:"bdy-card-info",children:r.jsx("span",{className:"bdy-card-name",children:J.name})}),r.jsx("button",{className:"bdy-remove-btn",onClick:P=>{P.stopPropagation(),Ve(J.id)},disabled:C===J.id,"aria-label":"Remove buddy",children:C===J.id?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},J.id))})}),p==="requests"&&r.jsxs("div",{className:"bdy-section",children:[_.length>0&&r.jsxs(r.Fragment,{children:[r.jsx("h3",{className:"bdy-section-title",children:"Incoming"}),r.jsx("div",{className:"bdy-list",children:_.map(J=>r.jsxs("div",{className:"bdy-card",children:[r.jsx("div",{className:"bdy-avatar",children:J.fromClient.photoURL?r.jsx("img",{src:J.fromClient.photoURL,alt:J.fromClient.name}):r.jsx("span",{children:ph(J.fromClient.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:J.fromClient.name}),r.jsx("span",{className:"bdy-card-sub",children:"wants to be your buddy"})]}),r.jsxs("div",{className:"bdy-action-pair",children:[r.jsx("button",{className:"bdy-accept-btn",onClick:()=>ht(J),disabled:C===J.reqId,children:C===J.reqId?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}),r.jsx("button",{className:"bdy-decline-btn",onClick:()=>H(J),disabled:C===J.reqId,children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]},J.reqId))})]}),O.length>0&&r.jsxs(r.Fragment,{children:[r.jsx("h3",{className:"bdy-section-title",children:"Sent"}),r.jsx("div",{className:"bdy-list",children:O.map(J=>r.jsxs("div",{className:"bdy-card",children:[r.jsx("div",{className:"bdy-avatar",children:J.toClient?.photoURL?r.jsx("img",{src:J.toClient.photoURL,alt:J.toClient.name}):r.jsx("span",{children:ph(J.toClient?.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:J.toClient?.name}),r.jsx("span",{className:"bdy-card-sub",children:"pending"})]}),r.jsx("button",{className:"bdy-cancel-btn",onClick:()=>fe(J),disabled:C===J.reqId,children:C===J.reqId?r.jsx("div",{className:"bdy-btn-spinner"}):"Cancel"})]},J.reqId))})]}),_.length===0&&O.length===0&&r.jsxs("div",{className:"bdy-empty",children:[r.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[r.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),r.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),r.jsx("h3",{children:"No pending requests"}),r.jsx("p",{children:"All caught up!"})]})]}),p==="search"&&r.jsxs("div",{className:"bdy-section",children:[r.jsxs("div",{className:"bdy-search-bar",children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("input",{type:"text",placeholder:"Search by name...",value:B,onChange:J=>D(J.target.value),autoFocus:!0}),B&&r.jsx("button",{className:"bdy-search-clear",onClick:()=>D(""),children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),B.trim()&&se.length===0&&r.jsx("div",{className:"bdy-empty bdy-empty-sm",children:r.jsxs("p",{children:['No members found for "',B,'"']})}),se.length>0&&r.jsx("div",{className:"bdy-list",children:se.map(J=>r.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${J.id}`),children:[r.jsx("div",{className:"bdy-avatar",children:J.photoURL?r.jsx("img",{src:J.photoURL,alt:J.name}):r.jsx("span",{children:ph(J.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:J.name}),J.isBuddy&&r.jsx("span",{className:"bdy-card-badge",children:"Buddy"})]}),J.isBuddy?r.jsx("span",{className:"bdy-status-icon",children:r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-success)",strokeWidth:"2.5",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}):J.isPendingOut?r.jsx("span",{className:"bdy-pending-label",children:"Pending"}):J.isPendingIn?r.jsx("button",{className:"bdy-accept-btn",onClick:P=>{P.stopPropagation();const re=_.find(Fe=>Fe.fromId===J.id);re&&ht(re)},disabled:!!C,children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}):r.jsx("button",{className:"bdy-add-btn",onClick:P=>{P.stopPropagation(),Oe(J.id)},disabled:C===J.id,children:C===J.id?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]},J.id))})]})]})]}),r.jsx(Ta,{}),M&&r.jsxs("div",{className:`toast-notification ${M.type}`,children:[r.jsx("span",{className:"toast-icon",children:M.type==="success"?r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M5 13 L9 17 L19 7"})}):M.type==="error"?r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),r.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),r.jsx("span",{className:"toast-message",children:M.message})]})]})})}function gh(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function tg(n,e){return[n,e].sort().join("_")}const O6=5;function sg(n){return n.toISOString().split("T")[0]}function B6(n){return n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}T`:`${Math.round(n)}`}const V6={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}};function O2(n){if(!n)return"";const e=n instanceof Date?n:n.toDate?n.toDate():new Date(n),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function U6(){const{userId:n}=_S(),{currentUser:e,isClient:t,clientData:i,loading:l}=Lr(),{isDark:u,toggleTheme:d}=Ca(),p=rr(),[g,y]=b.useState(null),[x,_]=b.useState("none"),[j,O]=b.useState(null),[K,B]=b.useState(!0),[D,se]=b.useState(!1),[Y,Z]=b.useState(null),[je,Re]=b.useState([]),[ke,C]=b.useState(!1),[T,M]=b.useState(new Set),[V,I]=b.useState(new Set),[L,A]=b.useState({}),[Oe,ht]=b.useState({}),[H,fe]=b.useState({}),[Ve,$e]=b.useState(!0),[J,P]=b.useState(0),[re,Fe]=b.useState(0),[qe,Ue]=b.useState(0),[Ie,mt]=b.useState(0),[xt,it]=b.useState([]),[ss,Rs]=b.useState([]),[Ut,jt]=b.useState(null),[ie,Mt]=b.useState(null),[St,Yt]=b.useState(0),[Tt,Et]=b.useState([]),[ot,Pt]=b.useState(!1),[Gt,ps]=b.useState(null),[Kt,It]=b.useState([]),hs=b.useCallback((X,ne="info")=>{Z({message:X,type:ne}),setTimeout(()=>Z(null),3500)},[]);b.useEffect(()=>{!l&&(!e||!t)&&p("/")},[e,t,l,p]),b.useEffect(()=>{i&&n&&i.id===n&&p("/client/core-buddy",{replace:!0})},[i,n,p]),b.useEffect(()=>{if(!i||!n||i.id===n)return;let X=!1;return(async()=>{B(!0);try{const wt=(await Es(qt(ye,"clients"))).docs.map(Ae=>({id:Ae.id,...Ae.data()})).find(Ae=>Ae.id===n);if(!wt){X||B(!1);return}X||y(wt);const et=i.id,_t=tg(et,n);if((await Ls(Xe(ye,"buddies",_t))).exists())X||_("buddy");else{const Ae=`${et}_${n}`,Je=await Ls(Xe(ye,"buddyRequests",Ae));if(Je.exists()&&Je.data().status==="pending")X||(_("pending_out"),O(Ae));else{const yt=`${n}_${et}`,at=await Ls(Xe(ye,"buddyRequests",yt));at.exists()&&at.data().status==="pending"?X||(_("pending_in"),O(yt)):X||_("none")}}}catch(ne){console.error("Error loading profile:",ne)}finally{X||B(!1)}})(),()=>{X=!0}},[i,n]),b.useEffect(()=>{if(!n||!g)return;let X=!1;return(async()=>{$e(!0);try{const[ne,Ke,wt,et]=await Promise.all([Es(Ds(qt(ye,"workoutLogs"),bs("clientId","==",n))),Ls(Xe(ye,"coreBuddyAchievements",n)),Ls(Xe(ye,"coreBuddyPBs",n)),Ls(Xe(ye,"clientProgrammes",n))]);if(X)return;const _t=ne.docs.length;P(_t),Ke.exists()&&Fe(Ke.data().totalVolume||0);let Q=0;const Ae=ne.docs.map(at=>at.data().date).filter(Boolean).sort().reverse();if(Ae.length>0){const at=new Date;let Zt=new Date(at);for(let Qt=0;Qt<52;Qt++){const U=new Date(Zt),be=U.getDay(),Ee=be===0?6:be-1;U.setDate(U.getDate()-Ee),U.setHours(0,0,0,0);const Te=new Date(U);Te.setDate(Te.getDate()+7);const Se=sg(U),bt=sg(Te);if(Ae.some(ft=>ft>=Se&&ft<bt))Q++;else{if(Qt>0)break;break}Zt.setDate(Zt.getDate()-7)}}if(X||Ue(Q),wt.exists()){const at=wt.data().exercises||{},Zt=Object.entries(at).sort(([,Qt],[,U])=>(U.weight||0)-(Qt.weight||0)).slice(0,3).map(([Qt,U])=>({name:Qt,weight:U.weight,reps:U.reps}));X||it(Zt)}if(et.exists()){const at=et.data(),Zt=V6[at.templateId];if(Zt){const Qt=Object.keys(at.completedSessions||{}).length,U=Zt.duration*Zt.daysPerWeek;X||(Mt(at.templateId.replace(/_/g," ").replace(/\b\w/g,be=>be.toUpperCase())),Yt(U>0?Math.round(Qt/U*100):0))}}const Je=await Ls(Xe(ye,"achievements",n));if(!X&&Je.exists()){const at=Je.data().badges||{};Rs(Object.keys(at))}let yt=0;for(let at=0;at<30;at++){const Zt=new Date;Zt.setDate(Zt.getDate()-at);const Qt=sg(Zt);try{const U=await Es(Ds(qt(ye,"habitLogs"),bs("clientId","==",n),bs("date","==",Qt)));if(U.empty)break;{const be=U.docs[0].data().habits||{};if(Object.values(be).filter(Boolean).length>=O6)yt++;else break}}catch{break}}X||mt(yt)}catch(ne){console.error("Error loading buddy stats:",ne)}finally{X||$e(!1)}})(),()=>{X=!0}},[n,g]),b.useEffect(()=>{if(!i)return;const X=i.id;(async()=>{try{const[ne,Ke,wt]=await Promise.all([Es(Ds(qt(ye,"buddies"),bs("user1","==",X))),Es(Ds(qt(ye,"buddies"),bs("user2","==",X))),Es(qt(ye,"clients"))]),et=new Set;[...ne.docs,...Ke.docs].forEach(Q=>{const Ae=Q.data();et.add(Ae.user1===X?Ae.user2:Ae.user1)});const _t={};wt.docs.forEach(Q=>{_t[Q.id]=Q.data()}),Et(Array.from(et).filter(Q=>_t[Q]).map(Q=>({id:Q,name:_t[Q].name,photoURL:_t[Q].photoURL||null})))}catch(ne){console.error("Error loading buddies for mentions:",ne)}})()},[i]);const ws=async(X,ne,Ke={})=>{if(!(!i||X===i.id))try{await Kr(qt(ye,"notifications"),{toId:X,fromId:i.id,fromName:i.name||"Someone",fromPhotoURL:i.photoURL||null,type:ne,read:!1,createdAt:yr(),...Ke})}catch(wt){console.error("Notification error:",wt),wt.code==="permission-denied"&&hs("Notifications blocked  check Firestore rules","error")}},is=async()=>{se(!0);try{const X=`${i.id}_${n}`;await Os(Xe(ye,"buddyRequests",X),{fromId:i.id,toId:n,status:"pending",createdAt:yr()}),await ws(n,"buddy_request"),_("pending_out"),O(X),hs("Buddy request sent!","success")}catch(X){console.error(X),hs("Failed to send request","error")}finally{se(!1)}},Xs=async()=>{if(j){se(!0);try{const X=tg(i.id,n);await Os(Xe(ye,"buddies",X),{user1:[i.id,n].sort()[0],user2:[i.id,n].sort()[1],connectedAt:yr()}),await ur(Xe(ye,"buddyRequests",j)),await ws(n,"buddy_accept"),_("buddy"),hs("Buddy added!","success")}catch(X){console.error(X),hs("Failed to accept","error")}finally{se(!1)}}},Ps=async()=>{if(j){se(!0);try{await ur(Xe(ye,"buddyRequests",j)),_("none"),hs(x==="pending_out"?"Request cancelled":"Request declined","info")}catch(X){console.error(X),hs("Failed","error")}finally{se(!1)}}},qs=async()=>{se(!0);try{const X=tg(i.id,n);await ur(Xe(ye,"buddies",X)),_("none"),hs("Buddy removed","info")}catch(X){console.error(X),hs("Failed to remove","error")}finally{se(!1)}},os=b.useCallback(async()=>{if(n){C(!0);try{const X=await Es(Ds(qt(ye,"posts"),bs("authorId","==",n),oc("createdAt","desc"),Pu(30)));if(Re(X.docs.map(ne=>({id:ne.id,...ne.data()}))),i){const ne=await Es(Ds(qt(ye,"postLikes"),bs("userId","==",i.id)));M(new Set(ne.docs.map(Ke=>Ke.data().postId)))}}catch(X){console.error("Error loading journey:",X)}finally{C(!1)}}},[n,i]);b.useEffect(()=>{!K&&g&&os()},[K,g,os]);const _s=async X=>{if(window.confirm("Delete this post?"))try{await ur(Xe(ye,"posts",X)),Re(ne=>ne.filter(Ke=>Ke.id!==X)),hs("Post deleted","info")}catch(ne){console.error("Delete error:",ne),hs("Failed to delete","error")}},ve=async X=>{if(!i)return;const ne=i.id,Ke=`${X}_${ne}`,wt=T.has(X),et=new Set(T);wt?et.delete(X):et.add(X),M(et),Re(_t=>_t.map(Q=>Q.id===X?{...Q,likeCount:Math.max(0,(Q.likeCount||0)+(wt?-1:1))}:Q));try{if(wt)await ur(Xe(ye,"postLikes",Ke)),await la(Xe(ye,"posts",X),{likeCount:Yo(-1)});else{await Os(Xe(ye,"postLikes",Ke),{postId:X,userId:ne,createdAt:yr()}),await la(Xe(ye,"posts",X),{likeCount:Yo(1)});const _t=je.find(Q=>Q.id===X);_t&&ws(_t.authorId,"like",{postId:X})}}catch(_t){console.error("Like error:",_t),os()}},De=async X=>{try{const ne=await Es(Ds(qt(ye,"postComments"),bs("postId","==",X),oc("createdAt","asc"),Pu(50)));A(Ke=>({...Ke,[X]:ne.docs.map(wt=>({id:wt.id,...wt.data()}))}))}catch(ne){console.error("Error loading comments:",ne)}},Pe=X=>{const ne=new Set(V);ne.has(X)?ne.delete(X):(ne.add(X),L[X]||De(X)),I(ne)},st=(X,ne)=>{const Ke=X.match(/@(\w*)$/);if(Ke){Pt(!0),ps(ne);const wt=Tt.filter(et=>et.name&&et.name.toLowerCase().includes(Ke[1].toLowerCase())).slice(0,5);It(wt)}else Pt(!1),It([])},Ge=(X,ne)=>{const wt=(Oe[ne]||"").replace(/@\w*$/,`@${X.name} `);ht(et=>({...et,[ne]:wt})),Pt(!1),It([])},nt=(X,ne)=>{ht(Ke=>({...Ke,[X]:ne})),st(ne,X)},gt=async X=>{const ne=(Oe[X]||"").trim();if(!(!ne||!i)){fe(Ke=>({...Ke,[X]:!0}));try{await Kr(qt(ye,"postComments"),{postId:X,authorId:i.id,authorName:i.name||"Unknown",authorPhotoURL:i.photoURL||null,content:ne,createdAt:yr()}),await la(Xe(ye,"posts",X),{commentCount:Yo(1)});const Ke=je.find(et=>et.id===X);Ke&&ws(Ke.authorId,"comment",{postId:X});const wt=ne.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(wt){const et=new Set;wt.forEach(_t=>{const Q=_t.slice(1).trim(),Ae=Tt.find(Je=>Je.name&&Je.name.toLowerCase()===Q.toLowerCase());Ae&&!et.has(Ae.id)&&(et.add(Ae.id),ws(Ae.id,"mention",{postId:X}))})}ht(et=>({...et,[X]:""})),Re(et=>et.map(_t=>_t.id===X?{..._t,commentCount:(_t.commentCount||0)+1}:_t)),await De(X)}catch(Ke){console.error("Comment error:",Ke),hs("Failed to comment","error")}finally{fe(Ke=>({...Ke,[X]:!1}))}}};return l||K||!i?r.jsx("div",{className:"prf-loading","data-theme":u?"dark":"light",children:r.jsx("div",{className:"prf-spinner"})}):!e||!t?null:g?r.jsx(Sa,{children:r.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:u?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"prf-main",children:[r.jsxs("div",{className:"prf-hero",children:[r.jsx("div",{className:"prf-avatar-lg",children:g.photoURL?r.jsx("img",{src:g.photoURL,alt:g.name}):r.jsx("span",{children:gh(g.name)})}),r.jsx("h1",{className:"prf-name",children:g.name}),r.jsxs("div",{className:"prf-buddy-action",children:[x==="none"&&r.jsx("button",{className:"prf-btn prf-btn-primary",onClick:is,disabled:D,children:D?r.jsx("div",{className:"prf-btn-spinner"}):r.jsxs(r.Fragment,{children:[r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Buddy"]})}),x==="pending_out"&&r.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:Ps,disabled:D,children:D?r.jsx("div",{className:"prf-btn-spinner dark"}):"Cancel Request"}),x==="pending_in"&&r.jsxs("div",{className:"prf-btn-pair",children:[r.jsx("button",{className:"prf-btn prf-btn-success",onClick:Xs,disabled:D,children:D?r.jsx("div",{className:"prf-btn-spinner"}):"Accept"}),r.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:Ps,disabled:D,children:"Decline"})]}),x==="buddy"&&r.jsx("button",{className:"prf-btn prf-btn-danger",onClick:qs,disabled:D,children:D?r.jsx("div",{className:"prf-btn-spinner"}):"Remove Buddy"})]})]}),Ve?r.jsx("div",{className:"prf-stats-loading",children:r.jsx("div",{className:"prf-spinner"})}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"prf-stats",children:[r.jsxs("div",{className:"prf-stat",children:[r.jsx("span",{className:"prf-stat-value",children:J}),r.jsx("span",{className:"prf-stat-label",children:"Workouts"})]}),r.jsxs("div",{className:"prf-stat",children:[r.jsxs("span",{className:"prf-stat-value",children:[B6(re),r.jsx("span",{className:"prf-stat-unit",children:re>=1e3?"":"kg"})]}),r.jsxs("span",{className:"prf-stat-label",children:[re>=1e6?"Million kg":re>=1e3?"Tonnes":"Volume"," Lifted"]})]}),r.jsxs("div",{className:"prf-stat",children:[r.jsxs("span",{className:"prf-stat-value",children:[qe,r.jsx("span",{className:"prf-stat-unit",children:"wk"})]}),r.jsx("span",{className:"prf-stat-label",children:"Streak"})]})]}),(ie||Ie>0)&&r.jsxs("div",{className:"prf-info-row",children:[ie&&r.jsxs("div",{className:"prf-info-card info-programme",children:[r.jsx("div",{className:"prf-info-icon",children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"}),r.jsx("path",{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"})]})}),r.jsxs("div",{className:"prf-info-text",children:[r.jsx("span",{className:"prf-info-label",children:ie}),r.jsx("div",{className:"prf-info-progress-bar",children:r.jsx("div",{className:"prf-info-progress-fill",style:{width:`${Math.min(St,100)}%`}})}),r.jsxs("span",{className:"prf-info-sub",children:[St,"% complete"]})]})]}),Ie>0&&r.jsxs("div",{className:"prf-info-card info-habit",children:[r.jsx("div",{className:"prf-info-icon",children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),r.jsx("path",{d:"M22 4L12 14.01l-3-3"})]})}),r.jsxs("div",{className:"prf-info-text",children:[r.jsxs("span",{className:"prf-info-value",children:[Ie," day",Ie!==1?"s":""]}),r.jsx("span",{className:"prf-info-sub",children:"Habit Streak"})]})]})]}),xt.length>0&&r.jsxs("div",{className:"prf-section",children:[r.jsx("h2",{className:"prf-section-title",children:"Top Lifts"}),r.jsx("div",{className:"prf-pb-list",children:xt.map((X,ne)=>r.jsxs("div",{className:"prf-pb-item",children:[r.jsx("div",{className:"prf-pb-rank",children:ne===0?r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:r.jsx("path",{d:"M12 2l2.4 7.4H22l-6 4.4 2.3 7.2L12 16.6 5.7 21l2.3-7.2-6-4.4h7.6z"})}):`#${ne+1}`}),r.jsx("span",{className:"prf-pb-name",children:X.name}),r.jsxs("span",{className:"prf-pb-weight",children:[X.weight,r.jsx("span",{className:"prf-pb-unit",children:"kg"})," x",X.reps]})]},ne))})]}),ss.length>0&&r.jsxs("div",{className:"prf-section",children:[r.jsxs("h2",{className:"prf-section-title",children:["Badges Earned (",ss.length,")"]}),r.jsx("div",{className:"prf-badge-row",children:ss.map(X=>{const ne=Un.find(Ke=>Ke.id===X);return ne?r.jsx("button",{className:"prf-badge-chip",onClick:()=>jt(ne),children:r.jsx("img",{src:ne.img,alt:ne.name,className:"prf-badge-chip-img"})},X):null})})]}),Ut&&r.jsx("div",{className:"prf-badge-overlay",onClick:()=>jt(null),children:r.jsxs("div",{className:"prf-badge-overlay-content",onClick:X=>X.stopPropagation(),children:[r.jsx("img",{src:Ut.img,alt:Ut.name,className:"prf-badge-overlay-img"}),r.jsx("p",{className:"prf-badge-overlay-desc",children:Ut.desc}),r.jsx("button",{className:"prf-badge-overlay-close",onClick:()=>jt(null),children:"Tap to close"})]})})]}),r.jsxs("div",{className:"prf-section",children:[r.jsx("h2",{className:"prf-section-title",children:`${g.name?.split(" ")[0]}'s Journey`}),ke?r.jsx("div",{className:"journey-loading",children:r.jsx("div",{className:"prf-spinner"})}):je.length===0?r.jsxs("div",{className:"journey-empty",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]}),r.jsx("p",{children:"No posts yet"})]}):r.jsx("div",{className:"journey-list",children:je.map(X=>r.jsxs("div",{className:"journey-post",children:[r.jsxs("div",{className:"journey-post-header",children:[r.jsx("div",{className:"journey-post-avatar",children:X.authorPhotoURL?r.jsx("img",{src:X.authorPhotoURL,alt:""}):r.jsx("span",{children:gh(X.authorName)})}),r.jsxs("div",{className:"journey-post-meta",children:[r.jsx("span",{className:"journey-post-name",children:X.authorName}),r.jsx("span",{className:"journey-post-time",children:O2(X.createdAt)})]}),X.authorId===i.id&&r.jsx("button",{className:"journey-delete-btn",onClick:()=>_s(X.id),"aria-label":"Delete post",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),X.content&&r.jsx("p",{className:"journey-post-content",children:X.content}),X.imageURL&&r.jsx("div",{className:"journey-post-image",children:r.jsx("img",{src:X.imageURL,alt:"Post",loading:"lazy"})}),r.jsxs("div",{className:"journey-post-actions",children:[r.jsxs("button",{className:`journey-action-btn${T.has(X.id)?" liked":""}`,onClick:()=>ve(X.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:T.has(X.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),r.jsx("span",{children:X.likeCount||0})]}),r.jsxs("button",{className:`journey-action-btn${V.has(X.id)?" active":""}`,onClick:()=>Pe(X.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),r.jsx("span",{children:X.commentCount||0})]})]}),V.has(X.id)&&r.jsxs("div",{className:"journey-comments",children:[L[X.id]?.length>0?L[X.id].map(ne=>r.jsxs("div",{className:"journey-comment",children:[r.jsx("div",{className:"journey-comment-avatar",onClick:()=>p(`/client/core-buddy/profile/${ne.authorId}`),children:ne.authorPhotoURL?r.jsx("img",{src:ne.authorPhotoURL,alt:""}):r.jsx("span",{children:gh(ne.authorName)})}),r.jsxs("div",{className:"journey-comment-body",children:[r.jsxs("div",{className:"journey-comment-bubble",children:[r.jsx("span",{className:"journey-comment-name",children:ne.authorName}),r.jsx("span",{className:"journey-comment-text",children:ne.content})]}),r.jsx("span",{className:"journey-comment-time",children:O2(ne.createdAt)})]})]},ne.id)):r.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),r.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[r.jsx("input",{type:"text",placeholder:"Comment... (@ to mention)",value:Oe[X.id]||"",onChange:ne=>nt(X.id,ne.target.value),onKeyDown:ne=>{ne.key==="Enter"&&gt(X.id)},maxLength:300}),ot&&Gt===X.id&&Kt.length>0&&r.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:Kt.map(ne=>r.jsxs("button",{className:"mention-option",onClick:()=>Ge(ne,X.id),children:[r.jsx("div",{className:"mention-option-avatar",children:ne.photoURL?r.jsx("img",{src:ne.photoURL,alt:""}):r.jsx("span",{children:gh(ne.name)})}),r.jsx("span",{children:ne.name})]},ne.id))}),r.jsx("button",{onClick:()=>gt(X.id),disabled:!(Oe[X.id]||"").trim()||H[X.id],children:H[X.id]?r.jsx("div",{className:"journey-btn-spinner-sm"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),r.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},X.id))})]})]}),r.jsx(Ta,{}),Y&&r.jsxs("div",{className:`toast-notification ${Y.type}`,children:[r.jsx("span",{className:"toast-icon",children:Y.type==="success"?r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M5 13 L9 17 L19 7"})}):Y.type==="error"?r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),r.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),r.jsx("span",{className:"toast-message",children:Y.message})]})]})}):r.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions"})]})}),r.jsx("main",{className:"prf-main",children:r.jsx("p",{style:{textAlign:"center",color:"var(--text-tertiary)",padding:"40px 0"},children:"User not found"})}),r.jsx(Ta,{})]})}const ng=[{text:"Build your dashboard...",bold:"your way"},{text:"Pick what matters to you...",bold:"nothing else"},{text:"Your goals, your layout...",bold:"your rules"}],B2=[{id:"stats",label:"Stats Rings",desc:"Programme %, workouts this week, habits today",icon:"rings",defaultOn:!0},{id:"workouts",label:"Workouts",desc:"Sessions this week and total count",icon:"dumbbell",defaultOn:!0},{id:"habits",label:"Habits",desc:"Daily habit tracker dots",icon:"check",defaultOn:!0},{id:"pbs",label:"Personal Bests",desc:"Your top lifts at a glance",icon:"trophy"},{id:"nutrition",label:"Nutrition",desc:"Macro rings  protein, carbs, fats, cals",icon:"apple"},{id:"leaderboard",label:"Leaderboard",desc:"See where you rank among buddies",icon:"podium"},{id:"achievements",label:"Achievements",desc:"Badge showcase and progress",icon:"medal"},{id:"journey",label:"Journey",desc:"Your posts, likes and comments feed",icon:"feed"},{id:"coach",label:"Coach Message",desc:"Motivational nudge from Buddy",icon:"message",defaultOn:!0},{id:"nudge",label:"Smart Nudge",desc:"Contextual reminder of what to do next",icon:"lightbulb"}];function F6(n){switch(n){case"rings":return r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("circle",{cx:"12",cy:"12",r:"6"}),r.jsx("circle",{cx:"12",cy:"12",r:"2"})]});case"dumbbell":return r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M6.5 6.5h11v11h-11z",strokeLinejoin:"round"}),r.jsx("line",{x1:"2",y1:"12",x2:"6.5",y2:"12"}),r.jsx("line",{x1:"17.5",y1:"12",x2:"22",y2:"12"})]});case"check":return r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("polyline",{points:"20 6 9 17 4 12"})});case"trophy":return r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M6 9H3V6a1 1 0 0 1 1-1h2M18 9h3V6a1 1 0 0 0-1-1h-2"}),r.jsx("path",{d:"M6 5h12v7a6 6 0 0 1-12 0V5z"}),r.jsx("path",{d:"M9 21h6"}),r.jsx("path",{d:"M12 17v4"})]});case"apple":return r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M12 3c-1.5 0-3 1-3 1s-3-.5-4.5 1.5S3 9 3 12s1.5 6 3 8 3 3 6 3 4.5-1 6-3 3-5 3-8-1.5-4-3-6.5S13.5 3 12 3z"}),r.jsx("path",{d:"M12 3c0 0 1-2 3-2"})]});case"podium":return r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("rect",{x:"2",y:"14",width:"6",height:"8",rx:"1"}),r.jsx("rect",{x:"9",y:"8",width:"6",height:"14",rx:"1"}),r.jsx("rect",{x:"16",y:"11",width:"6",height:"11",rx:"1"})]});case"medal":return r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"15",r:"6"}),r.jsx("path",{d:"M8.21 13.89L7 2h10l-1.21 11.89"})]});case"feed":return r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"3"}),r.jsx("line",{x1:"3",y1:"9",x2:"21",y2:"9"}),r.jsx("line",{x1:"3",y1:"15",x2:"21",y2:"15"})]});case"message":return r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})});case"lightbulb":return r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M9 18h6"}),r.jsx("path",{d:"M10 22h4"}),r.jsx("path",{d:"M12 2a7 7 0 0 0-4 12.7V17h8v-2.3A7 7 0 0 0 12 2z"})]});default:return null}}function z6(){const n=rr(),{clientData:e,currentUser:t,updateClientData:i,resolveClient:l}=Lr(),[u,d]=b.useState({hours:0,minutes:0,seconds:0}),[p,g]=b.useState(0),[y,x]=b.useState(0),[_,j]=b.useState(null),[O,K]=b.useState(!1),B=b.useRef(null),[D,se]=b.useState(()=>{const L=e?.dashboardWidgets;return L&&Array.isArray(L)?L:B2.filter(A=>A.defaultOn).map(A=>A.id)}),[Y,Z]=b.useState(!1),[je,Re]=b.useState(!1),[ke,C]=b.useState(null);b.useEffect(()=>{e?.photoURL&&j(e.photoURL)},[e?.photoURL]),b.useEffect(()=>{const L=()=>{const Oe=new Date,ht=new Date(Oe);ht.setHours(23,59,59,999);const H=ht-Oe;d({hours:Math.floor(H/36e5),minutes:Math.floor(H%36e5/6e4),seconds:Math.floor(H%6e4/1e3)}),g(60-Math.floor(H%6e4/1e3))};L();const A=setInterval(L,1e3);return()=>clearInterval(A)},[]),b.useEffect(()=>{const L=setInterval(()=>x(A=>(A+1)%ng.length),8e3);return()=>clearInterval(L)},[]);const T=async L=>{const A=L.target.files?.[0];if(!(!A||!e?.id)){K(!0);try{const Oe=bi(vi,`profilePhotos/${e.id}`);await Ah(Oe,A);const ht=await fo(Oe);await la(Xe(ye,"clients",e.id),{photoURL:ht}),j(ht),i({photoURL:ht})}catch(Oe){console.error("Photo upload error:",Oe)}finally{K(!1)}}},M=L=>{Re(!1),se(A=>A.includes(L)?A.filter(Oe=>Oe!==L):[...A,L])},V=(L,A)=>{Re(!1),se(Oe=>{const ht=Oe.indexOf(L);if(ht<0)return Oe;const H=ht+A;if(H<0||H>=Oe.length)return Oe;const fe=[...Oe];return[fe[ht],fe[H]]=[fe[H],fe[ht]],fe})},I=async()=>{Z(!0),C(null);try{const L=e||await l();if(!L?.id){C("Could not find your profile. Try refreshing."),Z(!1);return}await la(Xe(ye,"clients",L.id),{dashboardWidgets:D}),i({dashboardWidgets:D}),Re(!0)}catch(L){console.error("Save config error:",L),C("Save failed  please try again.")}finally{Z(!1)}};return r.jsx(Sa,{children:r.jsxs("div",{className:"bldr-page",children:[r.jsxs("div",{className:"bldr-container",children:[r.jsxs("div",{className:"bldr-header",children:[r.jsx("button",{className:"bldr-back",onClick:()=>n("/client/core-buddy"),children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("h1",{className:"bldr-title",children:"Build Your Dashboard"})]}),r.jsxs("div",{className:"bldr-ring-container",children:[r.jsxs("div",{className:"bldr-ring",children:[r.jsx("svg",{className:"bldr-ring-svg",viewBox:"0 0 200 200",children:Sm.map((L,A)=>r.jsx("line",{x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,className:`bldr-tick ${A<p?"elapsed":"remaining"}`,strokeWidth:L.thick?"3":"2"},A))}),r.jsxs("div",{className:"bldr-ring-center",children:[r.jsxs("div",{className:"bldr-ring-photo",onClick:()=>B.current?.click(),children:[r.jsx("img",{src:_||"/Logo.webp",alt:_?"Profile":"Mind Core Fitness"}),r.jsx("div",{className:`bldr-photo-overlay${O?" uploading":""}`,children:O?r.jsx("div",{className:"bldr-photo-spinner"}):r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[r.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),r.jsx("input",{ref:B,type:"file",accept:"image/*",onChange:T,style:{display:"none"}})]}),!_&&!O&&r.jsx("div",{className:"bldr-photo-badge",onClick:()=>B.current?.click(),children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[r.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),r.jsxs("div",{className:"bldr-countdown",children:[r.jsx("span",{className:"bldr-timer-digit",children:String(u.hours).padStart(2,"0")}),r.jsx("span",{className:"bldr-timer-colon",children:":"}),r.jsx("span",{className:"bldr-timer-digit",children:String(u.minutes).padStart(2,"0")}),r.jsx("span",{className:"bldr-timer-colon",children:":"}),r.jsx("span",{className:"bldr-timer-digit bldr-timer-sec",children:String(u.seconds).padStart(2,"0")})]}),r.jsx("span",{className:"bldr-ring-label",children:"remaining today"}),r.jsxs("p",{className:"bldr-tagline",children:[ng[y].text," ",r.jsx("strong",{children:ng[y].bold})]})]}),r.jsxs("div",{className:"bldr-section",children:[r.jsx("h2",{className:"bldr-section-title",children:"Choose Your Widgets"}),r.jsx("p",{className:"bldr-section-desc",children:"The countdown ring and your profile always stay at the top. Pick what goes below."}),r.jsx("div",{className:"bldr-widgets-list",children:B2.map(L=>{const A=D.includes(L.id),Oe=D.indexOf(L.id);return r.jsxs("div",{className:`bldr-widget-card${A?" active":""}`,children:[r.jsx("div",{className:"bldr-widget-icon",children:F6(L.icon)}),r.jsxs("div",{className:"bldr-widget-info",children:[r.jsx("div",{className:"bldr-widget-label",children:L.label}),r.jsx("div",{className:"bldr-widget-desc",children:L.desc})]}),r.jsxs("div",{className:"bldr-widget-actions",children:[A&&r.jsxs("div",{className:"bldr-widget-order",children:[r.jsx("button",{className:"bldr-order-btn",onClick:()=>V(L.id,-1),disabled:Oe===0,"aria-label":"Move up",children:r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:r.jsx("path",{d:"M18 15l-6-6-6 6"})})}),r.jsx("span",{className:"bldr-order-num",children:Oe+1}),r.jsx("button",{className:"bldr-order-btn",onClick:()=>V(L.id,1),disabled:Oe===D.length-1,"aria-label":"Move down",children:r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:r.jsx("path",{d:"M6 9l6 6 6-6"})})})]}),r.jsx("button",{className:`bldr-toggle${A?" on":""}`,onClick:()=>M(L.id),"aria-label":A?`Remove ${L.label}`:`Add ${L.label}`,children:r.jsx("div",{className:"bldr-toggle-thumb"})})]})]},L.id)})})]}),r.jsxs("div",{className:"bldr-save-wrap",children:[r.jsx("button",{className:`bldr-save-btn${je?" saved":""}`,onClick:I,disabled:Y||je,children:Y?"Saving...":je?"Saved":"Save Dashboard"}),ke&&r.jsx("p",{className:"bldr-save-error",children:ke}),je&&r.jsx("button",{className:"bldr-view-btn",onClick:()=>n("/client/core-buddy"),children:"View Dashboard"})]})]}),r.jsx(Ta,{active:"home"})]})})}const ba=[{key:"pressUps",name:"Press-Ups",category:"Upper Body",unit:"reps"},{key:"squats",name:"Squats",category:"Lower Body",unit:"reps"},{key:"longJump",name:"Standing Long Jump",category:"Power",unit:"distance"},{key:"deadHang",name:"Dead Hang",category:"Upper Body",unit:"time"},{key:"plank",name:"Plank",category:"Core",unit:"time"},{key:"wallSit",name:"Wall Sit",category:"Lower Body",unit:"time"},{key:"chestPress",name:"Chest Press",category:"Upper Body",unit:"weight"}],$o=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function q6(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}function va(n){const[e,t]=n.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function H6(n){if(!n&&n!==0)return"-";const e=Math.floor(n/60),t=(n%60).toFixed(2);return e>0?`${e}m ${parseFloat(t).toFixed(0)}s`:`${parseFloat(t).toFixed(2)}s`}function $6(n,e){return!n&&n!==0?"-":!e&&e!==0?`${n}kg`:`${n}kg x ${e}`}function yh(n,e){if(!e)return"-";switch(n.unit){case"weight":return $6(e.weight,e.reps);case"time":return H6(e.time);case"reps":return e.reps?`${e.reps} reps`:"-";case"distance":return e.distance?`${e.distance} cm`:"-";default:return"-"}}function ql(n,e){if(!e)return 0;switch(n.unit){case"weight":return(e.weight||0)*(e.reps||0);case"time":return e.time||0;case"reps":return e.reps||0;case"distance":return e.distance||0;default:return 0}}function rg(n,e){return!e||e===0?null:(n-e)/e*100}function W6({data:n,exerciseKey:e,unit:t}){if(!n||n.length<2)return r.jsx("div",{className:"pb-trend-empty",children:r.jsx("p",{children:"Not enough data for trend line yet"})});const i=n.map(B=>{const D=B.benchmarks?.[e];if(!D)return 0;switch(t){case"weight":return(D.weight||0)*(D.reps||0);case"time":return D.time||0;case"reps":return D.reps||0;case"distance":return D.distance||0;default:return 0}}),l=Math.max(...i),u=Math.min(...i),d=l-u||1,p=300,g=100,y=20,x=p-y*2,_=g-y*2,j=i.map((B,D)=>{const se=y+D/(i.length-1)*x,Y=y+_-(B-u)/d*_;return{x:se,y:Y,value:B}}),O=j.map((B,D)=>`${D===0?"M":"L"} ${B.x} ${B.y}`).join(" "),K=O+` L ${j[j.length-1].x} ${y+_} L ${j[0].x} ${y+_} Z`;return r.jsxs("div",{className:"pb-trend-chart",children:[r.jsxs("svg",{viewBox:`0 0 ${p} ${g}`,preserveAspectRatio:"xMidYMid meet",children:[r.jsx("defs",{children:r.jsxs("linearGradient",{id:"trendGradientJr",x1:"0",y1:"0",x2:"0",y2:"1",children:[r.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),r.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),r.jsx("path",{d:K,fill:"url(#trendGradientJr)"}),r.jsx("path",{d:O,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),j.map((B,D)=>r.jsx("circle",{cx:B.x,cy:B.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},D))]}),r.jsx("div",{className:"pb-trend-labels",children:n.map((B,D)=>r.jsxs("span",{className:"pb-trend-label",children:[B.month.split("-")[1],"/",B.month.split("-")[0].slice(2)]},D))})]})}function G6(){const[n,e]=b.useState("bests"),[t,i]=b.useState([]),[l,u]=b.useState(!0),[d,p]=b.useState(!1),[g,y]=b.useState(0),[x,_]=b.useState(!1),[j,O]=b.useState(!1),[K,B]=b.useState(!1),[D,se]=b.useState({}),[Y,Z]=b.useState({}),[je,Re]=b.useState({}),[ke,C]=b.useState({}),[T,M]=b.useState({}),[V,I]=b.useState(!1),[L,A]=b.useState({}),[Oe,ht]=b.useState([]),[H,fe]=b.useState(null),[Ve,$e]=b.useState(null),[J,P]=b.useState(!1),[re,Fe]=b.useState(""),[qe,Ue]=b.useState(""),Ie=b.useRef(null),mt=b.useRef(0),xt=b.useRef(0),it=b.useRef("right"),ss=b.useCallback(U=>{y(be=>{const Ee=Math.max(0,Math.min(ba.length-1,U));return Ee===be?be:(it.current=Ee>be?"right":"left",Ee)})},[]),{currentUser:Rs,isClient:Ut,clientData:jt,loading:ie}=Lr(),{isDark:Mt}=Ca(),St=rr(),Yt=b.useCallback((U,be="info")=>{$e({message:U,type:be}),setTimeout(()=>$e(null),4e3)},[]);b.useEffect(()=>{!ie&&(!Rs||!Ut)&&St("/")},[Rs,Ut,ie,St]),b.useEffect(()=>{jt&&Tt()},[jt]);const Tt=async()=>{try{const U=Ds(qt(ye,"juniorPBs"),bs("clientId","==",jt.id)),Ee=(await Es(U)).docs.map(ft=>({id:ft.id,...ft.data()}));Ee.sort((ft,zt)=>ft.month.localeCompare(zt.month)),i(Ee);const Te=Ds(qt(ye,"juniorPBTargets"),bs("clientId","==",jt.id)),Se=await Es(Te);if(!Se.empty){const ft=Se.docs[0].data();Re(ft.targets||{}),C(ft.metricTargets||{}),M(ft.targets||{}),A(ft.metricTargets||{})}const bt=Ds(qt(ye,"juniorAchievements"),bs("clientId","==",jt.id)),Ct=await Es(bt);Ct.empty||ht(Ct.docs[0].data().badges||[])}catch(U){console.error("Error fetching junior personal bests:",U)}u(!1)},Et=q6(),ot=t.find(U=>U.month===Et),Pt=t.filter(U=>U.month<Et),Gt=Pt.length>0?Pt[Pt.length-1]:null;b.useEffect(()=>{ot?(se(ot.benchmarks||{}),Z(ot.bodyMetrics||{})):(se({}),Z({}))},[ot?.id]);const ps=async(U,be)=>{const Ee=[];if(U==="strength"?ba.forEach(Te=>{const Se=je[Te.key];if(!Se)return;const bt=be[Te.key];if(!bt)return;let Ct;if(Se.targetType==="time"){if(!Se.targetValue)return;const ft=Se.startValue||0,zt=bt.time||0,Lt=Se.targetValue-ft;Ct=Lt===0?zt>=Se.targetValue?1:0:Math.max(0,(zt-ft)/Lt)}else if(Se.targetType==="reps"){if(!Se.targetReps)return;const ft=Se.startReps||0,zt=bt.reps||0,Lt=Se.targetReps-ft;Ct=Lt===0?zt>=Se.targetReps?1:0:Math.max(0,(zt-ft)/Lt)}else if(Se.targetType==="distance"){if(!Se.targetDistance)return;const ft=Se.startDistance||0,zt=bt.distance||0,Lt=Se.targetDistance-ft;Ct=Lt===0?zt>=Se.targetDistance?1:0:Math.max(0,(zt-ft)/Lt)}else{if(!Se.targetWeight&&!Se.targetReps)return;const ft=(Se.startWeight||0)*(Se.startReps||0),zt=(Se.targetWeight||0)*(Se.targetReps||0),Lt=(bt.weight||0)*(bt.reps||0),Bs=zt-ft;Ct=Bs===0?Lt>=zt?1:0:Math.max(0,(Lt-ft)/Bs)}if(Ct>=1){let ft,zt;Se.targetType==="time"?(ft=Oe.some(Lt=>Lt.type==="strength"&&Lt.key===Te.key&&Lt.targetValue===Se.targetValue),zt=`${Te.name} ${Se.targetValue}s`):Se.targetType==="reps"?(ft=Oe.some(Lt=>Lt.type==="strength"&&Lt.key===Te.key&&Lt.targetReps===Se.targetReps),zt=`${Te.name} ${Se.targetReps} reps`):Se.targetType==="distance"?(ft=Oe.some(Lt=>Lt.type==="strength"&&Lt.key===Te.key&&Lt.targetDistance===Se.targetDistance),zt=`${Te.name} ${Se.targetDistance}cm`):(ft=Oe.some(Lt=>Lt.type==="strength"&&Lt.key===Te.key&&Lt.targetWeight===Se.targetWeight&&Lt.targetReps===Se.targetReps),zt=`${Te.name} ${Se.targetWeight}kg  ${Se.targetReps}`),ft||Ee.push({type:"strength",key:Te.key,...Se.targetType==="time"?{targetType:"time",targetValue:Se.targetValue}:Se.targetType==="reps"?{targetType:"reps",targetReps:Se.targetReps}:Se.targetType==="distance"?{targetType:"distance",targetDistance:Se.targetDistance}:{targetWeight:Se.targetWeight,targetReps:Se.targetReps},achievedMonth:Et,label:zt})}}):$o.forEach(Te=>{const Se=ke[Te.key];if(!Se||!Se.targetValue)return;const bt=be[Te.key];if(bt==null)return;const Ct=Se.startValue||0,ft=Se.targetValue,zt=ft-Ct;(zt===0?bt===ft?1:0:Math.max(0,(bt-Ct)/zt))>=1&&(Oe.some(hn=>hn.type==="metric"&&hn.key===Te.key&&hn.targetValue===ft)||Ee.push({type:"metric",key:Te.key,targetValue:ft,achievedMonth:Et,label:`${Te.name} ${ft}${Te.suffix}`}))}),Ee.length>0){const Te=[...Oe,...Ee];await Os(Xe(ye,"juniorAchievements",jt.id),{clientId:jt.id,badges:Te,updatedAt:Rt.now()}),ht(Te),fe(Ee),setTimeout(()=>fe(null),5e3)}},Kt=(U,be)=>{if(U==="strength"){const Ee=je[be];if(!Ee)return!1;switch(ba.find(Se=>Se.key===be)?.unit){case"time":return Oe.some(Se=>Se.type==="strength"&&Se.key===be&&Se.targetValue===Ee.targetValue);case"reps":return Oe.some(Se=>Se.type==="strength"&&Se.key===be&&Se.targetReps===Ee.targetReps);case"distance":return Oe.some(Se=>Se.type==="strength"&&Se.key===be&&Se.targetDistance===Ee.targetDistance);default:return!Ee.targetWeight&&!Ee.targetReps?!1:Oe.some(Se=>Se.type==="strength"&&Se.key===be&&Se.targetWeight===Ee.targetWeight&&Se.targetReps===Ee.targetReps)}}else{const Ee=ke[be];return!Ee||!Ee.targetValue?!1:Oe.some(Te=>Te.type==="metric"&&Te.key===be&&Te.targetValue===Ee.targetValue)}},It=async()=>{p(!0);try{const U=`${jt.id}_${Et}`,be=ot||{};await Os(Xe(ye,"juniorPBs",U),{clientId:jt.id,month:Et,benchmarks:D,bodyMetrics:be.bodyMetrics||Y||{},createdAt:be.createdAt||Rt.now(),updatedAt:Rt.now()}),await ps("strength",D),Yt("Benchmarks saved!","success"),_(!1),await Tt()}catch(U){console.error("Error saving benchmarks:",U),Yt("Failed to save. Please try again.","error")}p(!1)},hs=async()=>{p(!0);try{const U=`${jt.id}_${Et}`,be=ot||{};await Os(Xe(ye,"juniorPBs",U),{clientId:jt.id,month:Et,benchmarks:be.benchmarks||D||{},bodyMetrics:Y,createdAt:be.createdAt||Rt.now(),updatedAt:Rt.now()}),await ps("metric",Y),Yt("Body metrics saved!","success"),O(!1),await Tt()}catch(U){console.error("Error saving metrics:",U),Yt("Failed to save. Please try again.","error")}p(!1)},ws=(U,be,Ee)=>{se(Te=>({...Te,[U]:{...Te[U],[be]:Ee===""?"":parseFloat(Ee)}}))},is=(U,be)=>{Z(Ee=>({...Ee,[U]:be===""?"":parseFloat(be)}))},Xs=(U,be,Ee)=>{M(Te=>({...Te,[U]:{...Te[U],[be]:Ee===""?"":parseFloat(Ee)}}))},Ps=async()=>{p(!0);try{const U=`targets_${jt.id}`,be=ot?.benchmarks||{},Ee={};ba.forEach(Te=>{const Se=be[Te.key];switch(Te.unit){case"time":T[Te.key]?.targetValue&&(Ee[Te.key]={targetType:"time",targetValue:T[Te.key].targetValue,startValue:Se?.time||0});break;case"reps":T[Te.key]?.targetReps&&(Ee[Te.key]={targetType:"reps",targetReps:T[Te.key].targetReps,startReps:Se?.reps||0});break;case"distance":T[Te.key]?.targetDistance&&(Ee[Te.key]={targetType:"distance",targetDistance:T[Te.key].targetDistance,startDistance:Se?.distance||0});break;default:(T[Te.key]?.targetWeight||T[Te.key]?.targetReps)&&(Ee[Te.key]={targetWeight:T[Te.key].targetWeight||0,targetReps:T[Te.key].targetReps||0,startWeight:Se?.weight||0,startReps:Se?.reps||0})}}),await Os(Xe(ye,"juniorPBTargets",U),{clientId:jt.id,targets:Ee,metricTargets:ke,updatedAt:Rt.now()}),Re(Ee),M(Ee),Yt("Targets saved!","success"),B(!1)}catch(U){console.error("Error saving targets:",U),Yt("Failed to save targets.","error")}p(!1)},qs=(U,be)=>{A(Ee=>({...Ee,[U]:{...Ee[U],targetValue:be===""?"":parseFloat(be)}}))},os=async()=>{p(!0);try{const U=`targets_${jt.id}`,be={};$o.forEach(Ee=>{if(L[Ee.key]?.targetValue){const Te=ot?.bodyMetrics?.[Ee.key]||0;be[Ee.key]={targetValue:L[Ee.key].targetValue,startValue:Te}}}),await Os(Xe(ye,"juniorPBTargets",U),{clientId:jt.id,targets:je,metricTargets:be,updatedAt:Rt.now()}),C(be),A(be),Yt("Metric targets saved!","success"),I(!1)}catch(U){console.error("Error saving metric targets:",U),Yt("Failed to save targets.","error")}p(!1)},_s=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){p(!0);try{const U=Xe(ye,"juniorPBTargets",`targets_${jt.id}`);await ur(U),Re({}),C({}),M({}),A({}),Yt("All goals have been reset","success")}catch(U){console.error("Error resetting targets:",U),Yt("Failed to reset goals","error")}p(!1)}},ve=(U,be)=>{const Ee=je[U];if(!Ee||!be)return null;if(Ee.targetType==="time"){if(!Ee.targetValue)return null;const ft=Ee.startValue||0,zt=Ee.targetValue,Lt=be.time||0,Bs=zt-ft;return Bs<=0?Lt>=zt?1:0:Math.max(0,Math.min((Lt-ft)/Bs,1))}if(Ee.targetType==="reps"){if(!Ee.targetReps)return null;const ft=Ee.startReps||0,zt=Ee.targetReps,Lt=be.reps||0,Bs=zt-ft;return Bs<=0?Lt>=zt?1:0:Math.max(0,Math.min((Lt-ft)/Bs,1))}if(Ee.targetType==="distance"){if(!Ee.targetDistance)return null;const ft=Ee.startDistance||0,zt=Ee.targetDistance,Lt=be.distance||0,Bs=zt-ft;return Bs<=0?Lt>=zt?1:0:Math.max(0,Math.min((Lt-ft)/Bs,1))}if(!Ee.targetWeight&&!Ee.targetReps)return null;const Te=(Ee.startWeight||0)*(Ee.startReps||0),Se=(Ee.targetWeight||0)*(Ee.targetReps||0),bt=(be.weight||0)*(be.reps||0),Ct=Se-Te;return Ct<=0?bt>=Se?1:0:Math.max(0,Math.min((bt-Te)/Ct,1))},De=U=>{const be=ke[U];if(!be||!be.targetValue)return null;const Ee=ot?.bodyMetrics?.[U];if(Ee==null)return null;const Te=be.startValue||0,Se=be.targetValue,bt=Se-Te;return bt===0?Ee===Se?1:0:Math.max(0,Math.min((Ee-Te)/bt,1))},Pe=U=>{mt.current=U.touches[0].clientX,xt.current=0},st=U=>{xt.current=U.touches[0].clientX-mt.current},Ge=()=>{xt.current<-50?ss(g+1):xt.current>50&&ss(g-1),xt.current=0},nt=U=>{const be=ot?.bodyMetrics?.[U],Ee=Gt?.bodyMetrics?.[U];return be==null||Ee==null?null:parseFloat((be-Ee).toFixed(2))},gt=t.find(U=>U.month===re),X=t.find(U=>U.month===qe);if(ie||l)return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsxs("main",{className:"pb-main",children:[r.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),r.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!Rs||!Ut||!jt)return null;const ne=ba[g],Ke=ot?.benchmarks?.[ne.key],wt=Gt?.benchmarks?.[ne.key],et=ql(ne,Ke),_t=ql(ne,wt),Q=rg(et,_t),Ae=ve(ne.key,Ke),Je=Ae!==null,yt=Ae!==null&&Ae>=1,at=Je?Math.round(Ae*60):et>0?15:0,Zt=je[ne.key],Qt=U=>U?U.targetType==="time"?`${U.startValue||0}s  ${U.targetValue}s`:U.targetType==="reps"?`${U.startReps||0}  ${U.targetReps} reps`:U.targetType==="distance"?`${U.startDistance||0}  ${U.targetDistance}cm`:`${U.startWeight||0}kg${U.startReps||0}  ${U.targetWeight}kg${U.targetReps}`:null;return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>St("/client"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsxs("main",{className:"pb-main page-transition-enter",children:[r.jsxs("div",{className:"pb-intro",children:[r.jsx("h2",{children:"Junior Strength Tests"}),r.jsx("p",{children:"Track your strength test results and body measurements each month."})]}),r.jsxs("div",{className:"pb-tabs",children:[r.jsx("button",{className:`pb-tab ${n==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),r.jsx("button",{className:`pb-tab ${n==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),r.jsx("button",{className:`pb-tab ${n==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),n==="bests"&&r.jsxs("div",{className:"pb-strength-section",children:[!x&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-carousel",ref:Ie,onTouchStart:Pe,onTouchMove:st,onTouchEnd:Ge,children:[r.jsx("div",{className:`pb-ring-container slide-from-${it.current}`,children:r.jsxs("div",{className:"pb-ring",children:[r.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:Sm.map((U,be)=>{const Ee=be<Math.round(at);return r.jsx("line",{x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,className:`pb-ring-tick ${Ee?yt?"hit":"filled":"empty"}`,strokeWidth:U.thick?"3":"2"},be)})}),r.jsxs("div",{className:"pb-ring-center",children:[r.jsx("div",{className:"pb-ring-category",children:ne.category}),r.jsxs("div",{className:"pb-ring-exercise",children:[ne.name,Kt("strength",ne.key)&&r.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),r.jsx("div",{className:"pb-ring-value",children:Ke?yh(ne,Ke):"-"}),Q!==null&&r.jsxs("div",{className:`pb-ring-change ${Q>=0?"positive":"negative"}`,children:[Q>=0?"+":"",Q.toFixed(1),"%"]}),Q===null&&Ke&&r.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),Zt&&r.jsx("div",{className:`pb-ring-target ${yt?"hit":""}`,children:yt?"Target hit!":Qt(Zt)}),!Zt&&r.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},g),r.jsx("div",{className:"pb-carousel-dots",children:ba.map((U,be)=>r.jsx("button",{className:`pb-dot ${be===g?"active":""}`,onClick:()=>ss(be)},be))}),r.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>ss(g-1),disabled:g===0,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),r.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>ss(g+1),disabled:g===ba.length-1,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),r.jsxs("div",{className:"pb-trend-section",children:[r.jsx("h4",{children:"Trend"}),r.jsx(W6,{data:t,exerciseKey:ne.key,unit:ne.unit})]})]}),!x&&!K&&r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>_(!0),children:ot?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>B(!0),children:Object.keys(je).length>0?"Edit Targets":"Set Targets"}),(Object.keys(je).length>0||Object.keys(ke).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:_s,disabled:d,children:"Reset All Goals"})]}),x&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Benchmarks - ",va(Et)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{_(!1),se(ot?.benchmarks||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:ba.map(U=>r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:U.name}),U.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:D[U.key]?.weight??"",onChange:be=>ws(U.key,"weight",be.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",value:D[U.key]?.reps??"",onChange:be=>ws(U.key,"reps",be.target.value),placeholder:"0"})]})]}):U.unit==="reps"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Reps (max in 1 min)"}),r.jsx("input",{type:"number",value:D[U.key]?.reps??"",onChange:be=>ws(U.key,"reps",be.target.value),placeholder:"0"})]})}):U.unit==="distance"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Distance (cm)"}),r.jsx("input",{type:"number",step:"0.5",value:D[U.key]?.distance??"",onChange:be=>ws(U.key,"distance",be.target.value),placeholder:"0"})]})}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Time (seconds)"}),r.jsx("input",{type:"number",step:"0.01",value:D[U.key]?.time??"",onChange:be=>ws(U.key,"time",be.target.value),placeholder:"0"})]})})]},U.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{_(!1),se(ot?.benchmarks||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:It,disabled:d,children:d?"Saving...":"Save"})]})]}),K&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Set Your Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{B(!1),M(je)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),ba.map(U=>{const be=ot?.benchmarks?.[U.key];let Ee="-";if(be)switch(U.unit){case"weight":(be.weight||be.reps)&&(Ee=`${be.weight||0}kg  ${be.reps||0}`);break;case"time":be.time&&(Ee=`${be.time}s`);break;case"reps":be.reps&&(Ee=`${be.reps} reps`);break;case"distance":be.distance&&(Ee=`${be.distance} cm`);break}return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:U.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",Ee]})]}),U.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:T[U.key]?.targetWeight??"",onChange:Te=>Xs(U.key,"targetWeight",Te.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Reps"}),r.jsx("input",{type:"number",value:T[U.key]?.targetReps??"",onChange:Te=>Xs(U.key,"targetReps",Te.target.value),placeholder:"0"})]})]}):U.unit==="reps"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target Reps (in 1 min)"}),r.jsx("input",{type:"number",value:T[U.key]?.targetReps??"",onChange:Te=>Xs(U.key,"targetReps",Te.target.value),placeholder:"0"})]})}):U.unit==="distance"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target Distance (cm)"}),r.jsx("input",{type:"number",step:"0.5",value:T[U.key]?.targetDistance??"",onChange:Te=>Xs(U.key,"targetDistance",Te.target.value),placeholder:"0"})]})}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target (seconds)"}),r.jsx("input",{type:"number",step:"1",value:T[U.key]?.targetValue??"",onChange:Te=>Xs(U.key,"targetValue",Te.target.value),placeholder:"0"})]})})]},U.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{B(!1),M(je)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Ps,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="metrics"&&r.jsxs("div",{className:"pb-metrics-section",children:[!j&&!V&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-metrics-card",children:[r.jsx("h3",{children:"Body Measurements"}),r.jsx("p",{className:"pb-metrics-month",children:va(Et)}),r.jsx("div",{className:"pb-metrics-list",children:$o.map(U=>{const be=ot?.bodyMetrics?.[U.key],Ee=nt(U.key),Te=ke[U.key],Se=De(U.key),bt=Se!==null&&Se>=1;return r.jsxs("div",{className:"pb-metric-row",children:[r.jsxs("div",{className:"pb-metric-top",children:[r.jsxs("div",{className:"pb-metric-left",children:[r.jsxs("span",{className:"pb-metric-name",children:[U.name,Kt("metric",U.key)&&r.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),Te&&r.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",Te.targetValue," ",U.suffix]})]}),r.jsxs("div",{className:"pb-metric-values",children:[r.jsx("span",{className:"pb-metric-current",children:be!=null?`${be} ${U.suffix}`:"-"}),Ee!==null&&r.jsxs("span",{className:`pb-metric-change ${Ee>0?"up":Ee<0?"down":"same"}`,children:[Ee>0?"+":"",Ee," ",U.suffix]})]})]}),Se!==null&&r.jsxs("div",{className:"pb-metric-progress",children:[r.jsx("div",{className:"pb-metric-bar",children:r.jsx("div",{className:`pb-metric-bar-fill ${bt?"hit":""}`,style:{width:`${Math.round(Se*100)}%`}})}),r.jsx("span",{className:`pb-metric-percent ${bt?"hit":""}`,children:bt?"Hit!":`${Math.round(Se*100)}%`})]})]},U.key)})})]}),r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>O(!0),children:ot?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>I(!0),children:Object.keys(ke).length>0?"Edit Targets":"Set Targets"}),(Object.keys(je).length>0||Object.keys(ke).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:_s,disabled:d,children:"Reset All Goals"})]})]}),j&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Measurements - ",va(Et)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{O(!1),Z(ot?.bodyMetrics||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:$o.map(U=>r.jsx("div",{className:"pb-edit-metric",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:[U.name," (",U.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:Y[U.key]??"",onChange:be=>is(U.key,be.target.value),placeholder:"0"})]})},U.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{O(!1),Z(ot?.bodyMetrics||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:hs,disabled:d,children:d?"Saving...":"Save"})]})]}),V&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Body Metric Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{I(!1),A(ke)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),$o.map(U=>{const be=ot?.bodyMetrics?.[U.key];return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:U.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",be!=null?`${be} ${U.suffix}`:"-"]})]}),r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:["Target (",U.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:L[U.key]?.targetValue??"",onChange:Ee=>qs(U.key,Ee.target.value),placeholder:"0"})]})})]},U.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{I(!1),A(ke)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:os,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="history"&&r.jsx("div",{className:"pb-history-section",children:t.length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("h4",{children:"No records yet"}),r.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):r.jsxs(r.Fragment,{children:[Oe.length>0&&r.jsxs("div",{className:"pb-achievements-wall",children:[r.jsxs("h4",{className:"pb-achievements-wall-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),r.jsx("div",{className:"pb-achievements-list",children:[...Oe].reverse().map((U,be)=>r.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${be*.05}s`},children:[r.jsx("div",{className:"pb-achievement-star",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("div",{className:"pb-achievement-info",children:[r.jsx("span",{className:"pb-achievement-label",children:U.label}),r.jsx("span",{className:"pb-achievement-date",children:va(U.achievedMonth)})]})]},be))})]}),r.jsx("div",{className:"pb-history-controls",children:r.jsx("button",{className:`pb-compare-toggle ${J?"active":""}`,onClick:()=>{P(!J),!J&&t.length>=2&&(Fe(t[0].month),Ue(t[t.length-1].month))},children:J?"Back to Timeline":"Compare Months"})}),J?r.jsxs("div",{className:"pb-compare",children:[r.jsxs("div",{className:"pb-compare-selectors",children:[r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"From"}),r.jsx("select",{value:re,onChange:U=>Fe(U.target.value),children:t.map(U=>r.jsx("option",{value:U.month,children:va(U.month)},U.month))})]}),r.jsx("div",{className:"pb-compare-vs",children:"vs"}),r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"To"}),r.jsx("select",{value:qe,onChange:U=>Ue(U.target.value),children:t.map(U=>r.jsx("option",{value:U.month,children:va(U.month)},U.month))})]})]}),gt&&X&&r.jsxs("div",{className:"pb-compare-results",children:[r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Strength Tests"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Exercise"}),r.jsx("span",{children:va(re).split(" ")[0]}),r.jsx("span",{children:va(qe).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),ba.map(U=>{const be=gt.benchmarks?.[U.key],Ee=X.benchmarks?.[U.key],Te=ql(U,be),Se=ql(U,Ee),bt=rg(Se,Te);return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:U.name}),r.jsx("span",{className:"pb-compare-val",children:be?yh(U,be):"-"}),r.jsx("span",{className:"pb-compare-val",children:Ee?yh(U,Ee):"-"}),r.jsx("span",{className:`pb-compare-change ${bt!==null?bt>=0?"positive":"negative":""}`,children:bt!==null?`${bt>=0?"+":""}${bt.toFixed(1)}%`:"-"})]},U.key)})]})]}),r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Body Measurements"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Measurement"}),r.jsx("span",{children:va(re).split(" ")[0]}),r.jsx("span",{children:va(qe).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),$o.map(U=>{const be=gt.bodyMetrics?.[U.key],Ee=X.bodyMetrics?.[U.key],Te=be!=null&&Ee!=null?parseFloat((Ee-be).toFixed(2)):null;return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:U.name}),r.jsx("span",{className:"pb-compare-val",children:be!=null?`${be}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:Ee!=null?`${Ee}`:"-"}),r.jsx("span",{className:`pb-compare-change ${Te!==null?Te>0?"positive":Te<0?"negative":"neutral":""}`,children:Te!==null?`${Te>0?"+":""}${Te} ${U.suffix}`:"-"})]},U.key)})]})]})]})]}):r.jsx("div",{className:"pb-timeline",children:[...t].reverse().map((U,be)=>{const Ee=t.filter(Te=>Te.month<U.month).pop();return r.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${be*.05}s`},children:[r.jsx("div",{className:"pb-timeline-dot"}),r.jsxs("div",{className:"pb-timeline-card",children:[r.jsx("h4",{children:va(U.month)}),U.benchmarks&&Object.keys(U.benchmarks).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Strength Tests"}),ba.map(Te=>{const Se=U.benchmarks[Te.key];if(!Se)return null;const bt=Ee?.benchmarks?.[Te.key],Ct=ql(Te,Se),ft=ql(Te,bt),zt=rg(Ct,ft);return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:Te.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsx("span",{className:"pb-timeline-value",children:yh(Te,Se)}),zt!==null&&r.jsxs("span",{className:`pb-timeline-change ${zt>=0?"positive":"negative"}`,children:[zt>=0?"+":"",zt.toFixed(1),"%"]})]})]},Te.key)})]}),U.bodyMetrics&&Object.keys(U.bodyMetrics).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Body Measurements"}),$o.map(Te=>{const Se=U.bodyMetrics[Te.key];if(Se==null)return null;const bt=Ee?.bodyMetrics?.[Te.key],Ct=bt!=null?parseFloat((Se-bt).toFixed(2)):null;return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:Te.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsxs("span",{className:"pb-timeline-value",children:[Se," ",Te.suffix]}),Ct!==null&&r.jsxs("span",{className:`pb-timeline-change ${Ct>0?"positive":Ct<0?"negative":"neutral"}`,children:[Ct>0?"+":"",Ct," ",Te.suffix]})]})]},Te.key)})]})]})]},U.id)})})]})})]}),H&&r.jsx("div",{className:"pb-celebration-overlay",onClick:()=>fe(null),children:r.jsxs("div",{className:"pb-celebration-card",children:[r.jsx("div",{className:"pb-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pb-celebration-title",children:H.length===1?"Target Achieved!":`${H.length} Targets Achieved!`}),r.jsx("div",{className:"pb-celebration-badges",children:H.map((U,be)=>r.jsx("div",{className:"pb-celebration-badge",children:U.label},be))}),r.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),Ve&&r.jsxs("div",{className:`toast-notification ${Ve.type}`,children:[r.jsx("span",{className:"toast-icon",children:Ve.type==="success"?r.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),r.jsx("span",{className:"toast-message",children:Ve.message}),r.jsx("button",{className:"toast-close",onClick:()=>$e(null),children:""})]}),r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:"block-nav-tab",onClick:()=>St("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),r.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),r.jsx("span",{children:"Home"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>St("/client/forms"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),r.jsx("polyline",{points:"14 2 14 8 20 8"}),r.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),r.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),r.jsx("span",{children:"Forms"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>St("/client/tools"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),r.jsx("span",{children:"Tools"})]}),r.jsxs("button",{className:"block-nav-tab active",children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20V10"}),r.jsx("path",{d:"M18 20V4"}),r.jsx("path",{d:"M6 20v-4"})]}),r.jsx("span",{children:"PBs"})]}),jt?.circuitAccess&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>St("/client/circuit"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 6v6l4 2"})]}),r.jsx("span",{children:"Circuit"})]})]})]})}const Qk=[{name:"Dumbbell Floor Press",type:"weighted",equipment:"dumbbells",group:"push",pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",equipment:"dumbbells",group:"push",pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Tricep Dips",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Pike Push Ups",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/pike push ups.GIF"},{name:"Reverse Plank",type:"timed",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/reverse plank.GIF"},{name:"Dumbbell Squeeze Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Pullover",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Fly",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Tricep Kickback",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Shrug",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Y-Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Wide Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Diamond Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Decline Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Wall Walks",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Press Up Hold",type:"timed",equipment:"bodyweight",group:"push",storagePath:null},{name:"Shoulder Tap Hold",type:"timed",equipment:"bodyweight",group:"push",storagePath:null},{name:"Dumbbell Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Bicep Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Renegade Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Reverse Fly",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Concentration Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Wrist Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Reverse Snow Angel",type:"reps",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Isometric Bicep Hold",type:"timed",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Dumbbell Goblet Squats",type:"weighted",equipment:"dumbbells",group:"lower",pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Romanian Deadlifts",type:"weighted",equipment:"dumbbells",group:"lower",pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Sumo Squats",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"1 Legged RDL",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/1 legged rdl.GIF"},{name:"Dumbbell Box Step Ups",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.GIF"},{name:"Dumbbell Reverse Lunges",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.GIF"},{name:"Kettlebell Romanian Deadlift",type:"weighted",equipment:"kettlebell",group:"lower",storagePath:"exercises/kettlebells/lower/kettlebell romanian deadlift.mp4"},{name:"Reverse Lunge",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/reverse lunge.GIF"},{name:"Box Step Ups",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/box step ups.GIF"},{name:"Bulgarian Split Squats",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Jump Squats",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Hip Thrusts",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/hip thrusts.GIF"},{name:"Donkey Kicks",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/donkey kicks.GIF"},{name:"Skater Jumps",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/skater jumps.GIF"},{name:"Squat And Hold",type:"timed",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/squat and hold.GIF"},{name:"Forearm Plank",type:"timed",equipment:"bodyweight",group:"core",pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Side Plank",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Side Plank.mp4"},{name:"Hollow Body Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Superman Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Superman Hold.mp4"},{name:"Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Fast Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Fast Mountain Climbers.mp4"},{name:"Cross Body Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Russian Twist",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Crunch",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Bicycle Crunch",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Leg Raises",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Dead Bug",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Dead Bug Single Leg Drop",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Bird Dog",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Flutter Kicks",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Hollow Hold Flutter Kicks",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"},{name:"High Plank Shoulder Taps",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"},{name:"Hip Dips Plank",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Single Leg V-Up",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Single Leg V-Up.mp4"},{name:"Hollow Hold To V-Sit",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"},{name:"Toe Reaches",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/toe reaches.GIF"},{name:"Side Plank Rotation",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Plank Walkout",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Russian Twists Dumbbell",type:"weighted",equipment:"dumbbells",group:"core",storagePath:"exercises/dumbbells/core/russian twists dumbbell.GIF"},{name:"Kettlebell Russian Twist",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",type:"reps",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Back Extension Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:null},{name:"Dumbbell Plank Pull Through",type:"weighted",equipment:"dumbbells",group:"core",storagePath:null}];Qk.filter(n=>n.storagePath!==null);const K6=[{key:"push",label:"Push",subtitle:"Chest / Shoulders / Triceps",color:"#A12F3A",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4"},{key:"pull",label:"Pull",subtitle:"Back / Biceps",color:"#2196f3",icon:"M4 12h16M12 4v16M7 7l10 10M17 7L7 17"},{key:"lower",label:"Lower",subtitle:"Legs / Glutes",color:"#ff9800",icon:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"},{key:"core",label:"Core",subtitle:"Abs / Stability",color:"#7c3aed",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"}],Xk={};Qk.forEach(n=>{Xk[n.name]=n.group});function Y6(n){return Xk[n]||null}const Ua=[{key:"chestPress",name:"Chest Press",category:"Upper Body - Push",unit:"weight"},{key:"shoulderPress",name:"Shoulder Press",category:"Upper Body - Push",unit:"weight"},{key:"seatedRow",name:"Seated Row",category:"Upper Body - Pull",unit:"weight"},{key:"latPulldown",name:"Lat Pulldown",category:"Upper Body - Pull",unit:"weight"},{key:"squat",name:"Squat",category:"Lower Body",unit:"weight"},{key:"deadlift",name:"Deadlift",category:"Lower Body",unit:"weight"},{key:"plank",name:"Plank",category:"Core",unit:"time"}],Wo=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function Q6(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}function xa(n){const[e,t]=n.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function bh(n){if(!n&&n!==0)return"-";const e=Math.floor(n/60),t=(n%60).toFixed(2);return e>0?`${e}m ${parseFloat(t).toFixed(0)}s`:`${parseFloat(t).toFixed(2)}s`}function V2(n,e){return!n&&n!==0?"-":!e&&e!==0?`${n}kg`:`${n}kg x ${e}`}function Hl(n,e){return e?n.unit==="time"?e.time||0:(e.weight||0)*(e.reps||0):0}function ag(n,e){return!e||e===0?null:(n-e)/e*100}function X6({data:n,exerciseKey:e,unit:t}){if(!n||n.length<2)return r.jsx("div",{className:"pb-trend-empty",children:r.jsx("p",{children:"Not enough data for trend line yet"})});const i=n.map(B=>{const D=B.benchmarks?.[e];return D?t==="time"?D.time||0:(D.weight||0)*(D.reps||0):0}),l=Math.max(...i),u=Math.min(...i),d=l-u||1,p=300,g=100,y=20,x=p-y*2,_=g-y*2,j=i.map((B,D)=>{const se=y+D/(i.length-1)*x,Y=y+_-(B-u)/d*_;return{x:se,y:Y,value:B}}),O=j.map((B,D)=>`${D===0?"M":"L"} ${B.x} ${B.y}`).join(" "),K=O+` L ${j[j.length-1].x} ${y+_} L ${j[0].x} ${y+_} Z`;return r.jsxs("div",{className:"pb-trend-chart",children:[r.jsxs("svg",{viewBox:`0 0 ${p} ${g}`,preserveAspectRatio:"xMidYMid meet",children:[r.jsx("defs",{children:r.jsxs("linearGradient",{id:"trendGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[r.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),r.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),r.jsx("path",{d:K,fill:"url(#trendGradient)"}),r.jsx("path",{d:O,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),j.map((B,D)=>r.jsx("circle",{cx:B.x,cy:B.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},D))]}),r.jsx("div",{className:"pb-trend-labels",children:n.map((B,D)=>r.jsxs("span",{className:"pb-trend-label",children:[B.month.split("-")[1],"/",B.month.split("-")[0].slice(2)]},D))})]})}function J6(){const[n,e]=b.useState("bests"),[t,i]=b.useState([]),[l,u]=b.useState(!0),[d,p]=b.useState(!1),[g,y]=b.useState(0),[x,_]=b.useState(!1),[j,O]=b.useState(!1),[K,B]=b.useState(!1),[D,se]=b.useState({}),[Y,Z]=b.useState({}),[je,Re]=b.useState({}),[ke,C]=b.useState({}),[T,M]=b.useState({}),[V,I]=b.useState(!1),[L,A]=b.useState({}),[Oe,ht]=b.useState([]),[H,fe]=b.useState(null),[Ve,$e]=b.useState(null),[J,P]=b.useState(!1),[re,Fe]=b.useState(""),[qe,Ue]=b.useState(""),[Ie,mt]=b.useState({}),[xt,it]=b.useState({}),[ss,Rs]=b.useState(null),[Ut,jt]=b.useState(null),[ie,Mt]=b.useState(""),[St,Yt]=b.useState({}),Tt=b.useRef(null),Et=b.useRef(0),ot=b.useRef(0),Pt=b.useRef("right"),Gt=b.useCallback(W=>{y(de=>{const le=Math.max(0,Math.min(Ua.length-1,W));return le===de?de:(Pt.current=le>de?"right":"left",le)})},[]),{currentUser:ps,isClient:Kt,clientData:It,loading:hs}=Lr(),{isDark:ws}=Ca(),is=rr(),[Xs]=mE(),Ps=Xs.get("mode")==="corebuddy",qs=!Ps&&(!It?.clientType||It.clientType==="block"),os=b.useCallback((W,de="info")=>{$e({message:W,type:de}),setTimeout(()=>$e(null),4e3)},[]);b.useEffect(()=>{!hs&&(!ps||!Kt)&&is("/")},[ps,Kt,hs,is]),b.useEffect(()=>{It&&(qs?_s():(async()=>{try{const[de,le,we]=await Promise.all([Ls(Xe(ye,"coreBuddyPBs",It.id)),Ls(Xe(ye,"coreBuddyTargets",It.id)),Ls(Xe(ye,"coreBuddyAchievements",It.id))]);de.exists()&&mt(de.data().exercises||{}),le.exists()&&it(le.data().targets||{}),we.exists()&&Rs(we.data())}catch(de){console.error("Error loading Core Buddy PBs:",de)}u(!1)})())},[It]);const _s=async()=>{try{const W=Ds(qt(ye,"personalBests"),bs("clientId","==",It.id)),le=(await Es(W)).docs.map(te=>({id:te.id,...te.data()}));le.sort((te,Ze)=>te.month.localeCompare(Ze.month)),i(le);const we=Ds(qt(ye,"personalBestTargets"),bs("clientId","==",It.id)),S=await Es(we);if(!S.empty){const te=S.docs[0].data();Re(te.targets||{}),C(te.metricTargets||{}),M(te.targets||{}),A(te.metricTargets||{})}const F=Ds(qt(ye,"achievements"),bs("clientId","==",It.id)),ae=await Es(F);ae.empty||ht(ae.docs[0].data().badges||[])}catch(W){console.error("Error fetching personal bests:",W)}u(!1)},ve=async()=>{if(!Ut||!ie||!It)return;const W=parseFloat(ie),de=Ie[Ut];if(!de||W<=de.weight){os("Target must be higher than current PB","error");return}p(!0);try{const le={...xt,[Ut]:{targetWeight:W,setAt:Rt.now(),currentPBWhenSet:de.weight}};await Os(Xe(ye,"coreBuddyTargets",It.id),{clientId:It.id,targets:le,updatedAt:Rt.now()}),it(le),jt(null),Mt(""),os("Target set!","success")}catch(le){console.error("Error saving target:",le),os("Failed to save target","error")}p(!1)},De=W=>{if(!ss?.badges)return!1;const de=xt[W];return de?ss.badges.some(le=>le.type==="pb_target"&&le.exercise===W&&le.targetWeight===de.targetWeight):!1},Pe=W=>{const de=xt[W];if(!de)return null;const le=Ie[W];if(!le)return 0;const we=de.currentPBWhenSet||0,S=de.targetWeight,F=S-we;return F<=0?le.weight>=S?1:0:Math.max(0,Math.min((le.weight-we)/F,1))},st=Q6(),Ge=t.find(W=>W.month===st),nt=t.filter(W=>W.month<st),gt=nt.length>0?nt[nt.length-1]:null;b.useEffect(()=>{Ge?(se(Ge.benchmarks||{}),Z(Ge.bodyMetrics||{})):(se({}),Z({}))},[Ge?.id]);const X=async(W,de)=>{const le=[];if(W==="strength"?Ua.forEach(we=>{const S=je[we.key];if(!S)return;const F=de[we.key];if(!F)return;let ae;if(S.targetType==="time"){if(!S.targetValue)return;const te=S.startValue||0,Ze=F.time||0,ut=S.targetValue-te;ae=ut===0?Ze>=S.targetValue?1:0:Math.max(0,(Ze-te)/ut)}else{if(!S.targetWeight&&!S.targetReps)return;const te=(S.startWeight||0)*(S.startReps||0),Ze=(S.targetWeight||0)*(S.targetReps||0),ut=(F.weight||0)*(F.reps||0),lt=Ze-te;ae=lt===0?ut>=Ze?1:0:Math.max(0,(ut-te)/lt)}if(ae>=1&&!(S.targetType==="time"?Oe.some(Ze=>Ze.type==="strength"&&Ze.key===we.key&&Ze.targetValue===S.targetValue):Oe.some(Ze=>Ze.type==="strength"&&Ze.key===we.key&&Ze.targetWeight===S.targetWeight&&Ze.targetReps===S.targetReps))){const Ze=S.targetType==="time"?`${we.name} ${S.targetValue}s`:`${we.name} ${S.targetWeight}kg  ${S.targetReps}`;le.push({type:"strength",key:we.key,...S.targetType==="time"?{targetType:"time",targetValue:S.targetValue}:{targetWeight:S.targetWeight,targetReps:S.targetReps},achievedMonth:st,label:Ze})}}):Wo.forEach(we=>{const S=ke[we.key];if(!S||!S.targetValue)return;const F=de[we.key];if(F==null)return;const ae=S.startValue||0,te=S.targetValue,Ze=te-ae;(Ze===0?F===te?1:0:Math.max(0,(F-ae)/Ze))>=1&&(Oe.some(Dt=>Dt.type==="metric"&&Dt.key===we.key&&Dt.targetValue===te)||le.push({type:"metric",key:we.key,targetValue:te,achievedMonth:st,label:`${we.name} ${te}${we.suffix}`}))}),le.length>0){const we=[...Oe,...le];await Os(Xe(ye,"achievements",It.id),{clientId:It.id,badges:we,updatedAt:Rt.now()}),ht(we),fe(le),setTimeout(()=>fe(null),5e3)}},ne=(W,de)=>{if(W==="strength"){const le=je[de];return le?le.targetType==="time"?Oe.some(we=>we.type==="strength"&&we.key===de&&we.targetValue===le.targetValue):!le.targetWeight&&!le.targetReps?!1:Oe.some(we=>we.type==="strength"&&we.key===de&&we.targetWeight===le.targetWeight&&we.targetReps===le.targetReps):!1}else{const le=ke[de];return!le||!le.targetValue?!1:Oe.some(we=>we.type==="metric"&&we.key===de&&we.targetValue===le.targetValue)}},Ke=async()=>{p(!0);try{const W=`${It.id}_${st}`,de=Ge||{};await Os(Xe(ye,"personalBests",W),{clientId:It.id,month:st,benchmarks:D,bodyMetrics:de.bodyMetrics||Y||{},createdAt:de.createdAt||Rt.now(),updatedAt:Rt.now()}),await X("strength",D),os("Benchmarks saved!","success"),_(!1),await _s()}catch(W){console.error("Error saving benchmarks:",W),os("Failed to save. Please try again.","error")}p(!1)},wt=async()=>{p(!0);try{const W=`${It.id}_${st}`,de=Ge||{};await Os(Xe(ye,"personalBests",W),{clientId:It.id,month:st,benchmarks:de.benchmarks||D||{},bodyMetrics:Y,createdAt:de.createdAt||Rt.now(),updatedAt:Rt.now()}),await X("metric",Y),os("Body metrics saved!","success"),O(!1),await _s()}catch(W){console.error("Error saving metrics:",W),os("Failed to save. Please try again.","error")}p(!1)},et=(W,de,le)=>{se(we=>({...we,[W]:{...we[W],[de]:le===""?"":parseFloat(le)}}))},_t=(W,de)=>{Z(le=>({...le,[W]:de===""?"":parseFloat(de)}))},Q=(W,de,le)=>{M(we=>({...we,[W]:{...we[W],[de]:le===""?"":parseFloat(le)}}))},Ae=async()=>{p(!0);try{const W=`targets_${It.id}`,de=Ge?.benchmarks||{},le={};Ua.forEach(we=>{const S=de[we.key];we.unit==="time"?T[we.key]?.targetValue&&(le[we.key]={targetType:"time",targetValue:T[we.key].targetValue,startValue:S?.time||0}):(T[we.key]?.targetWeight||T[we.key]?.targetReps)&&(le[we.key]={targetWeight:T[we.key].targetWeight||0,targetReps:T[we.key].targetReps||0,startWeight:S?.weight||0,startReps:S?.reps||0})}),await Os(Xe(ye,"personalBestTargets",W),{clientId:It.id,targets:le,metricTargets:ke,updatedAt:Rt.now()}),Re(le),M(le),os("Targets saved!","success"),B(!1)}catch(W){console.error("Error saving targets:",W),os("Failed to save targets.","error")}p(!1)},Je=(W,de)=>{A(le=>({...le,[W]:{...le[W],targetValue:de===""?"":parseFloat(de)}}))},yt=async()=>{p(!0);try{const W=`targets_${It.id}`,de={};Wo.forEach(le=>{if(L[le.key]?.targetValue){const we=Ge?.bodyMetrics?.[le.key]||0;de[le.key]={targetValue:L[le.key].targetValue,startValue:we}}}),await Os(Xe(ye,"personalBestTargets",W),{clientId:It.id,targets:je,metricTargets:de,updatedAt:Rt.now()}),C(de),A(de),os("Metric targets saved!","success"),I(!1)}catch(W){console.error("Error saving metric targets:",W),os("Failed to save targets.","error")}p(!1)},at=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){p(!0);try{const W=Xe(ye,"personalBestTargets",`targets_${It.id}`);await ur(W),Re({}),C({}),M({}),A({}),os("All goals have been reset","success")}catch(W){console.error("Error resetting targets:",W),os("Failed to reset goals","error")}p(!1)}},Zt=(W,de)=>{const le=je[W];if(!le||!de)return null;if(le.targetType==="time"){if(!le.targetValue)return null;const te=le.startValue||0,Ze=le.targetValue,ut=de.time||0,lt=Ze-te;return lt<=0?ut>=Ze?1:0:Math.max(0,Math.min((ut-te)/lt,1))}if(!le.targetWeight&&!le.targetReps)return null;const we=(le.startWeight||0)*(le.startReps||0),S=(le.targetWeight||0)*(le.targetReps||0),F=(de.weight||0)*(de.reps||0),ae=S-we;return ae<=0?F>=S?1:0:Math.max(0,Math.min((F-we)/ae,1))},Qt=W=>{const de=ke[W];if(!de||!de.targetValue)return null;const le=Ge?.bodyMetrics?.[W];if(le==null)return null;const we=de.startValue||0,S=de.targetValue,F=S-we;return F===0?le===S?1:0:Math.max(0,Math.min((le-we)/F,1))},U=W=>{Et.current=W.touches[0].clientX,ot.current=0},be=W=>{ot.current=W.touches[0].clientX-Et.current},Ee=()=>{ot.current<-50?Gt(g+1):ot.current>50&&Gt(g-1),ot.current=0},Te=W=>{const de=Ge?.bodyMetrics?.[W],le=gt?.bodyMetrics?.[W];return de==null||le==null?null:parseFloat((de-le).toFixed(2))},Se=t.find(W=>W.month===re),bt=t.find(W=>W.month===qe);if(hs||l)return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsxs("main",{className:"pb-main",children:[r.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),r.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!ps||!Kt||!It)return null;if(qs&&It?.isJunior)return r.jsx(G6,{});const Ct=Ua[g],ft=Ge?.benchmarks?.[Ct.key],zt=gt?.benchmarks?.[Ct.key],Lt=Hl(Ct,ft),Bs=Hl(Ct,zt),hn=ag(Lt,Bs),rn=Zt(Ct.key,ft),Tn=rn!==null,As=rn!==null&&rn>=1,sn=Tn?Math.round(rn*60):Lt>0?15:0,ks=je[Ct.key];return r.jsx(Sa,{children:r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>is(Ps?"/client/core-buddy":"/client"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsxs("main",{className:"pb-main page-transition-enter",children:[r.jsxs("div",{className:"pb-intro anim-fade-up",children:[r.jsx("h2",{children:"Personal Bests"}),r.jsx("p",{children:qs?"Track your strength benchmarks and body measurements each month.":"Your all-time best lifts from programme workouts."})]}),!qs&&r.jsxs("div",{className:"pb-cb-section anim-fade-up-d2",children:[Object.keys(Ie).length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("div",{className:"pb-cb-empty-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})}),r.jsx("h4",{children:"No personal bests yet"}),r.jsx("p",{children:"Complete weight-based workouts to start tracking your personal bests."})]}):r.jsx("div",{className:"pb-cb-grouped",children:(()=>{const W={},de=[];return Object.entries(Ie).forEach(([le,we])=>{const S=Y6(le);S?(W[S]||(W[S]=[]),W[S].push([le,we])):de.push([le,we])}),Object.values(W).forEach(le=>le.sort(([we],[S])=>we.localeCompare(S))),de.sort(([le],[we])=>le.localeCompare(we)),r.jsxs(r.Fragment,{children:[K6.map(le=>{const we=W[le.key];if(!we||we.length===0)return null;const S=!!St[le.key],F=we.reduce((ae,[,te])=>!ae||te.weight>ae.weight?te:ae,null);return r.jsxs("div",{className:`pb-cb-group ${S?"open":""}`,style:{"--group-color":le.color},children:[r.jsxs("button",{className:"pb-cb-group-header",onClick:()=>Yt(ae=>({...ae,[le.key]:!ae[le.key]})),children:[r.jsx("div",{className:"pb-cb-group-accent"}),r.jsx("div",{className:"pb-cb-group-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:le.icon})})}),r.jsxs("div",{className:"pb-cb-group-text",children:[r.jsx("h3",{className:"pb-cb-group-label",children:le.label}),r.jsx("span",{className:"pb-cb-group-subtitle",children:le.subtitle})]}),r.jsxs("div",{className:"pb-cb-group-meta",children:[r.jsxs("span",{className:"pb-cb-group-count",children:[we.length," PB",we.length!==1?"s":""]}),F&&r.jsxs("span",{className:"pb-cb-group-best",children:["Best: ",F.weight,"kg"]})]}),r.jsx("svg",{className:`pb-cb-group-chevron ${S?"open":""}`,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M6 9l6 6 6-6"})})]}),r.jsx("div",{className:"pb-cb-group-body",style:{display:S?"block":"none"},children:r.jsx("div",{className:"pb-cb-grid",children:we.map(([ae,te],Ze)=>{const ut=xt[ae],lt=Pe(ae),Dt=lt!==null&&lt>=1,vt=De(ae),gs=lt!==null?Math.round(lt*60):60;return r.jsxs("div",{className:"pb-cb-card",style:{"--group-color":le.color,animationDelay:`${Ze*.05}s`},children:[r.jsxs("div",{className:"pb-cb-card-top",children:[r.jsxs("div",{className:"pb-cb-card-ring",children:[r.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:S2.map((ln,hr)=>{const ys=hr<gs;return r.jsx("line",{x1:ln.x1,y1:ln.y1,x2:ln.x2,y2:ln.y2,className:`pb-ring-tick ${ys?Dt?"hit":"filled":"empty"}`,style:ys&&!Dt?{stroke:le.color}:void 0,strokeWidth:ln.thick?"2":"1.5"},hr)})}),r.jsx("div",{className:"pb-cb-ring-icon",style:{color:le.color},children:vt?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"pb-cb-badge-earned",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:le.icon})})})]}),r.jsxs("div",{className:"pb-cb-card-info",children:[r.jsx("h4",{className:"pb-cb-card-name",children:ae}),r.jsxs("div",{className:"pb-cb-card-value",style:{color:le.color},children:[te.weight,"kg  ",te.reps]}),te.achievedAt&&r.jsx("div",{className:"pb-cb-card-date",children:(te.achievedAt.toDate?te.achievedAt.toDate():new Date(te.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),ut&&Dt&&!vt&&r.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"}),vt&&r.jsx("div",{className:"pb-cb-target-info earned",children:"Badge earned!"})]}),r.jsx("div",{className:"pb-cb-card-action",children:r.jsx("button",{className:"pb-cb-target-btn",style:{borderColor:le.color,background:`color-mix(in srgb, ${le.color} 10%, transparent)`,color:le.color},onClick:()=>{jt(ae),Mt("")},children:ut?Dt&&vt?r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 5v14M5 12h14"})}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("circle",{cx:"12",cy:"12",r:"6"}),r.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]}),ut&&!Dt&&r.jsxs("div",{className:"pb-cb-card-progress",children:[r.jsxs("div",{className:"pb-cb-progress-labels",children:[r.jsxs("span",{className:"pb-cb-progress-current",children:[te.weight,"kg"]}),r.jsxs("span",{className:"pb-cb-progress-target",style:{color:le.color},children:["Target: ",ut.targetWeight,"kg"]})]}),r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill",style:{width:`${Math.round((lt||0)*100)}%`,background:le.color}})}),r.jsxs("div",{className:"pb-cb-progress-pct",style:{color:le.color},children:[Math.round((lt||0)*100),"%"]})]}),ut&&Dt&&r.jsx("div",{className:"pb-cb-card-progress",children:r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill hit",style:{width:"100%"}})})})]},ae)})})})]},le.key)}),de.length>0&&(()=>{const le=!!St.other;return r.jsxs("div",{className:`pb-cb-group ${le?"open":""}`,style:{"--group-color":"var(--text-tertiary)"},children:[r.jsxs("button",{className:"pb-cb-group-header",onClick:()=>Yt(we=>({...we,other:!we.other})),children:[r.jsx("div",{className:"pb-cb-group-accent"}),r.jsx("div",{className:"pb-cb-group-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})}),r.jsx("div",{className:"pb-cb-group-text",children:r.jsx("h3",{className:"pb-cb-group-label",children:"Other"})}),r.jsx("div",{className:"pb-cb-group-meta",children:r.jsxs("span",{className:"pb-cb-group-count",children:[de.length," PB",de.length!==1?"s":""]})}),r.jsx("svg",{className:`pb-cb-group-chevron ${le?"open":""}`,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M6 9l6 6 6-6"})})]}),r.jsx("div",{className:"pb-cb-group-body",style:{display:le?"block":"none"},children:r.jsx("div",{className:"pb-cb-grid",children:de.map(([we,S],F)=>{const ae=xt[we],te=Pe(we),Ze=te!==null&&te>=1,ut=De(we),lt=te!==null?Math.round(te*60):60;return r.jsxs("div",{className:"pb-cb-card",style:{animationDelay:`${F*.05}s`},children:[r.jsxs("div",{className:"pb-cb-card-top",children:[r.jsxs("div",{className:"pb-cb-card-ring",children:[r.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:S2.map((Dt,vt)=>{const gs=vt<lt;return r.jsx("line",{x1:Dt.x1,y1:Dt.y1,x2:Dt.x2,y2:Dt.y2,className:`pb-ring-tick ${gs?Ze?"hit":"filled":"empty"}`,strokeWidth:Dt.thick?"2":"1.5"},vt)})}),r.jsx("div",{className:"pb-cb-ring-icon",children:ut?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"pb-cb-badge-earned",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})})]}),r.jsxs("div",{className:"pb-cb-card-info",children:[r.jsx("h4",{className:"pb-cb-card-name",children:we}),r.jsxs("div",{className:"pb-cb-card-value",children:[S.weight,"kg  ",S.reps]}),S.achievedAt&&r.jsx("div",{className:"pb-cb-card-date",children:(S.achievedAt.toDate?S.achievedAt.toDate():new Date(S.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),ae&&Ze&&!ut&&r.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"}),ut&&r.jsx("div",{className:"pb-cb-target-info earned",children:"Badge earned!"})]}),r.jsx("div",{className:"pb-cb-card-action",children:r.jsx("button",{className:"pb-cb-target-btn",onClick:()=>{jt(we),Mt("")},children:ae?Ze&&ut?r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 5v14M5 12h14"})}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("circle",{cx:"12",cy:"12",r:"6"}),r.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]}),ae&&!Ze&&r.jsxs("div",{className:"pb-cb-card-progress",children:[r.jsxs("div",{className:"pb-cb-progress-labels",children:[r.jsxs("span",{className:"pb-cb-progress-current",children:[S.weight,"kg"]}),r.jsxs("span",{className:"pb-cb-progress-target",children:["Target: ",ae.targetWeight,"kg"]})]}),r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill",style:{width:`${Math.round((te||0)*100)}%`}})}),r.jsxs("div",{className:"pb-cb-progress-pct",children:[Math.round((te||0)*100),"%"]})]}),ae&&Ze&&r.jsx("div",{className:"pb-cb-card-progress",children:r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill hit",style:{width:"100%"}})})})]},we)})})})]})})()]})})()}),Object.keys(Ie).length>0&&r.jsxs("button",{className:"pb-cb-achievements-link anim-fade-up-d4",onClick:()=>is("/client/core-buddy/achievements"),children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"View Achievements",r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),Ut&&r.jsx("div",{className:"pb-cb-target-modal-overlay",onClick:()=>jt(null),children:r.jsxs("div",{className:"pb-cb-target-modal",onClick:W=>W.stopPropagation(),children:[r.jsx("h3",{children:"Set Target"}),r.jsx("p",{className:"pb-cb-target-exercise-name",children:Ut}),r.jsxs("div",{className:"pb-cb-target-current",children:["Current PB: ",r.jsxs("strong",{children:[Ie[Ut]?.weight,"kg"]})]}),r.jsxs("div",{className:"pb-cb-target-input-wrap",children:[r.jsx("label",{children:"Your target (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",step:"0.5",value:ie,onChange:W=>Mt(W.target.value),placeholder:String((Ie[Ut]?.weight||0)+5),className:"pb-cb-target-input",autoFocus:!0})]}),r.jsxs("div",{className:"pb-cb-target-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>jt(null),children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:ve,disabled:d,children:d?"Saving...":"Set Target"})]})]})})]}),qs&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-tabs",children:[r.jsx("button",{className:`pb-tab ${n==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),r.jsx("button",{className:`pb-tab ${n==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),r.jsx("button",{className:`pb-tab ${n==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),n==="bests"&&r.jsxs("div",{className:"pb-strength-section",children:[!x&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-carousel",ref:Tt,onTouchStart:U,onTouchMove:be,onTouchEnd:Ee,children:[r.jsx("div",{className:`pb-ring-container slide-from-${Pt.current}`,children:r.jsxs("div",{className:"pb-ring",children:[r.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:Sm.map((W,de)=>{const le=de<Math.round(sn);return r.jsx("line",{x1:W.x1,y1:W.y1,x2:W.x2,y2:W.y2,className:`pb-ring-tick ${le?As?"hit":"filled":"empty"}`,strokeWidth:W.thick?"3":"2"},de)})}),r.jsxs("div",{className:"pb-ring-center",children:[r.jsx("div",{className:"pb-ring-category",children:Ct.category}),r.jsxs("div",{className:"pb-ring-exercise",children:[Ct.name,ne("strength",Ct.key)&&r.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),r.jsx("div",{className:"pb-ring-value",children:ft?Ct.unit==="time"?bh(ft.time):V2(ft.weight,ft.reps):"-"}),hn!==null&&r.jsxs("div",{className:`pb-ring-change ${hn>=0?"positive":"negative"}`,children:[hn>=0?"+":"",hn.toFixed(1),"%"]}),hn===null&&ft&&r.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),ks&&r.jsx("div",{className:`pb-ring-target ${As?"hit":""}`,children:As?"Target hit!":ks.targetType==="time"?`${ks.startValue||0}s  ${ks.targetValue}s`:`${ks.startWeight||0}kg${ks.startReps||0}  ${ks.targetWeight}kg${ks.targetReps}`}),!ks&&r.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},g),r.jsx("div",{className:"pb-carousel-dots",children:Ua.map((W,de)=>r.jsx("button",{className:`pb-dot ${de===g?"active":""}`,onClick:()=>Gt(de)},de))}),r.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>Gt(g-1),disabled:g===0,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),r.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>Gt(g+1),disabled:g===Ua.length-1,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),r.jsxs("div",{className:"pb-trend-section",children:[r.jsx("h4",{children:"Trend"}),r.jsx(X6,{data:t,exerciseKey:Ct.key,unit:Ct.unit})]})]}),!x&&!K&&r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>_(!0),children:Ge?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>B(!0),children:Object.keys(je).length>0?"Edit Targets":"Set Targets"}),(Object.keys(je).length>0||Object.keys(ke).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:at,disabled:d,children:"Reset All Goals"})]}),x&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Benchmarks - ",xa(st)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{_(!1),se(Ge?.benchmarks||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:Ua.map(W=>r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:W.name}),W.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:D[W.key]?.weight??"",onChange:de=>et(W.key,"weight",de.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",value:D[W.key]?.reps??"",onChange:de=>et(W.key,"reps",de.target.value),placeholder:"0"})]})]}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Time (seconds)"}),r.jsx("input",{type:"number",step:"0.01",value:D[W.key]?.time??"",onChange:de=>et(W.key,"time",de.target.value),placeholder:"0"})]})})]},W.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{_(!1),se(Ge?.benchmarks||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Ke,disabled:d,children:d?"Saving...":"Save"})]})]}),K&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Set Your Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{B(!1),M(je)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),Ua.map(W=>{const de=Ge?.benchmarks?.[W.key];let le="-";return de&&(W.unit==="time"&&de.time?le=`${de.time}s`:(de.weight||de.reps)&&(le=`${de.weight||0}kg  ${de.reps||0}`)),r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:W.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",le]})]}),W.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:T[W.key]?.targetWeight??"",onChange:we=>Q(W.key,"targetWeight",we.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Reps"}),r.jsx("input",{type:"number",value:T[W.key]?.targetReps??"",onChange:we=>Q(W.key,"targetReps",we.target.value),placeholder:"0"})]})]}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target (seconds)"}),r.jsx("input",{type:"number",step:"1",value:T[W.key]?.targetValue??"",onChange:we=>Q(W.key,"targetValue",we.target.value),placeholder:"0"})]})})]},W.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{B(!1),M(je)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Ae,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="metrics"&&r.jsxs("div",{className:"pb-metrics-section",children:[!j&&!V&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-metrics-card",children:[r.jsx("h3",{children:"Body Measurements"}),r.jsx("p",{className:"pb-metrics-month",children:xa(st)}),r.jsx("div",{className:"pb-metrics-list",children:Wo.map(W=>{const de=Ge?.bodyMetrics?.[W.key],le=Te(W.key),we=ke[W.key],S=Qt(W.key),F=S!==null&&S>=1;return r.jsxs("div",{className:"pb-metric-row",children:[r.jsxs("div",{className:"pb-metric-top",children:[r.jsxs("div",{className:"pb-metric-left",children:[r.jsxs("span",{className:"pb-metric-name",children:[W.name,ne("metric",W.key)&&r.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),we&&r.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",we.targetValue," ",W.suffix]})]}),r.jsxs("div",{className:"pb-metric-values",children:[r.jsx("span",{className:"pb-metric-current",children:de!=null?`${de} ${W.suffix}`:"-"}),le!==null&&r.jsxs("span",{className:`pb-metric-change ${le>0?"up":le<0?"down":"same"}`,children:[le>0?"+":"",le," ",W.suffix]})]})]}),S!==null&&r.jsxs("div",{className:"pb-metric-progress",children:[r.jsx("div",{className:"pb-metric-bar",children:r.jsx("div",{className:`pb-metric-bar-fill ${F?"hit":""}`,style:{width:`${Math.round(S*100)}%`}})}),r.jsx("span",{className:`pb-metric-percent ${F?"hit":""}`,children:F?"Hit!":`${Math.round(S*100)}%`})]})]},W.key)})})]}),r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>O(!0),children:Ge?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>I(!0),children:Object.keys(ke).length>0?"Edit Targets":"Set Targets"}),(Object.keys(je).length>0||Object.keys(ke).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:at,disabled:d,children:"Reset All Goals"})]})]}),j&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Measurements - ",xa(st)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{O(!1),Z(Ge?.bodyMetrics||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:Wo.map(W=>r.jsx("div",{className:"pb-edit-metric",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:[W.name," (",W.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:Y[W.key]??"",onChange:de=>_t(W.key,de.target.value),placeholder:"0"})]})},W.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{O(!1),Z(Ge?.bodyMetrics||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:wt,disabled:d,children:d?"Saving...":"Save"})]})]}),V&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Body Metric Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{I(!1),A(ke)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),Wo.map(W=>{const de=Ge?.bodyMetrics?.[W.key];return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:W.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",de!=null?`${de} ${W.suffix}`:"-"]})]}),r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:["Target (",W.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:L[W.key]?.targetValue??"",onChange:le=>Je(W.key,le.target.value),placeholder:"0"})]})})]},W.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{I(!1),A(ke)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:yt,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="history"&&r.jsx("div",{className:"pb-history-section",children:t.length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("h4",{children:"No records yet"}),r.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):r.jsxs(r.Fragment,{children:[Oe.length>0&&r.jsxs("div",{className:"pb-achievements-wall",children:[r.jsxs("h4",{className:"pb-achievements-wall-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),r.jsx("div",{className:"pb-achievements-list",children:[...Oe].reverse().map((W,de)=>r.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${de*.05}s`},children:[r.jsx("div",{className:"pb-achievement-star",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("div",{className:"pb-achievement-info",children:[r.jsx("span",{className:"pb-achievement-label",children:W.label}),r.jsx("span",{className:"pb-achievement-date",children:xa(W.achievedMonth)})]})]},de))})]}),r.jsx("div",{className:"pb-history-controls",children:r.jsx("button",{className:`pb-compare-toggle ${J?"active":""}`,onClick:()=>{P(!J),!J&&t.length>=2&&(Fe(t[0].month),Ue(t[t.length-1].month))},children:J?"Back to Timeline":"Compare Months"})}),J?r.jsxs("div",{className:"pb-compare",children:[r.jsxs("div",{className:"pb-compare-selectors",children:[r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"From"}),r.jsx("select",{value:re,onChange:W=>Fe(W.target.value),children:t.map(W=>r.jsx("option",{value:W.month,children:xa(W.month)},W.month))})]}),r.jsx("div",{className:"pb-compare-vs",children:"vs"}),r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"To"}),r.jsx("select",{value:qe,onChange:W=>Ue(W.target.value),children:t.map(W=>r.jsx("option",{value:W.month,children:xa(W.month)},W.month))})]})]}),Se&&bt&&r.jsxs("div",{className:"pb-compare-results",children:[r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Strength Benchmarks"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Exercise"}),r.jsx("span",{children:xa(re).split(" ")[0]}),r.jsx("span",{children:xa(qe).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),Ua.map(W=>{const de=Se.benchmarks?.[W.key],le=bt.benchmarks?.[W.key],we=Hl(W,de),S=Hl(W,le),F=ag(S,we);return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:W.name}),r.jsx("span",{className:"pb-compare-val",children:de?W.unit==="time"?bh(de.time):`${de.weight}x${de.reps}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:le?W.unit==="time"?bh(le.time):`${le.weight}x${le.reps}`:"-"}),r.jsx("span",{className:`pb-compare-change ${F!==null?F>=0?"positive":"negative":""}`,children:F!==null?`${F>=0?"+":""}${F.toFixed(1)}%`:"-"})]},W.key)})]})]}),r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Body Measurements"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Measurement"}),r.jsx("span",{children:xa(re).split(" ")[0]}),r.jsx("span",{children:xa(qe).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),Wo.map(W=>{const de=Se.bodyMetrics?.[W.key],le=bt.bodyMetrics?.[W.key],we=de!=null&&le!=null?parseFloat((le-de).toFixed(2)):null;return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:W.name}),r.jsx("span",{className:"pb-compare-val",children:de!=null?`${de}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:le!=null?`${le}`:"-"}),r.jsx("span",{className:`pb-compare-change ${we!==null?we>0?"positive":we<0?"negative":"neutral":""}`,children:we!==null?`${we>0?"+":""}${we} ${W.suffix}`:"-"})]},W.key)})]})]})]})]}):r.jsx("div",{className:"pb-timeline",children:[...t].reverse().map((W,de)=>{const le=t.find(we=>we.month<W.month&&t.indexOf(we)===t.indexOf(W)-1)||t.filter(we=>we.month<W.month).pop();return r.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${de*.05}s`},children:[r.jsx("div",{className:"pb-timeline-dot"}),r.jsxs("div",{className:"pb-timeline-card",children:[r.jsx("h4",{children:xa(W.month)}),W.benchmarks&&Object.keys(W.benchmarks).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Strength Benchmarks"}),Ua.map(we=>{const S=W.benchmarks[we.key];if(!S)return null;const F=le?.benchmarks?.[we.key],ae=Hl(we,S),te=Hl(we,F),Ze=ag(ae,te);return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:we.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsx("span",{className:"pb-timeline-value",children:we.unit==="time"?bh(S.time):V2(S.weight,S.reps)}),Ze!==null&&r.jsxs("span",{className:`pb-timeline-change ${Ze>=0?"positive":"negative"}`,children:[Ze>=0?"+":"",Ze.toFixed(1),"%"]})]})]},we.key)})]}),W.bodyMetrics&&Object.keys(W.bodyMetrics).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Body Measurements"}),Wo.map(we=>{const S=W.bodyMetrics[we.key];if(S==null)return null;const F=le?.bodyMetrics?.[we.key],ae=F!=null?parseFloat((S-F).toFixed(2)):null;return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:we.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsxs("span",{className:"pb-timeline-value",children:[S," ",we.suffix]}),ae!==null&&r.jsxs("span",{className:`pb-timeline-change ${ae>0?"positive":ae<0?"negative":"neutral"}`,children:[ae>0?"+":"",ae," ",we.suffix]})]})]},we.key)})]})]})]},W.id)})})]})})]})]}),H&&r.jsx("div",{className:"pb-celebration-overlay",onClick:()=>fe(null),children:r.jsxs("div",{className:"pb-celebration-card",children:[r.jsx("div",{className:"pb-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pb-celebration-title",children:H.length===1?"Target Achieved!":`${H.length} Targets Achieved!`}),r.jsx("div",{className:"pb-celebration-badges",children:H.map((W,de)=>r.jsx("div",{className:"pb-celebration-badge",children:W.label},de))}),r.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),Ve&&r.jsxs("div",{className:`toast-notification ${Ve.type}`,children:[r.jsx("span",{className:"toast-icon",children:Ve.type==="success"?r.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),r.jsx("span",{className:"toast-message",children:Ve.message}),r.jsx("button",{className:"toast-close",onClick:()=>$e(null),children:""})]}),qs&&r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:"block-nav-tab",onClick:()=>is("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),r.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),r.jsx("span",{children:"Home"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>is("/client/forms"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),r.jsx("polyline",{points:"14 2 14 8 20 8"}),r.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),r.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),r.jsx("span",{children:"Forms"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>is("/client/tools"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),r.jsx("span",{children:"Tools"})]}),r.jsxs("button",{className:"block-nav-tab active",children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20V10"}),r.jsx("path",{d:"M18 20V4"}),r.jsx("path",{d:"M6 20v-4"})]}),r.jsx("span",{children:"PBs"})]}),It?.circuitAccess&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>is("/client/circuit"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 6v6l4 2"})]}),r.jsx("span",{children:"Circuit"})]})]}),Ps&&r.jsx(Ta,{active:"progress"})]})})}const Z6=b.lazy(()=>wr(()=>import("./Dashboard-DX_JuNPp.js"),__vite__mapDeps([0,1,2]))),eP=b.lazy(()=>wr(()=>import("./AddClient-DU7djmhB.js"),__vite__mapDeps([3,4]))),tP=b.lazy(()=>wr(()=>import("./ClientDashboard-BU2yXe9o.js"),__vite__mapDeps([5,1]))),sP=b.lazy(()=>wr(()=>import("./ClientForms-CRGsrGFb.js"),__vite__mapDeps([6,7]))),nP=b.lazy(()=>wr(()=>import("./ClientTools-Dy7OZ6_Z.js"),__vite__mapDeps([8,9]))),rP=b.lazy(()=>wr(()=>import("./MacroCalculator-xlibVqxu.js"),__vite__mapDeps([10,9]))),aP=b.lazy(()=>wr(()=>import("./ProteinSnacks-DYBYmMKS.js"),__vite__mapDeps([11,9]))),iP=b.lazy(()=>wr(()=>import("./DailyMotivation-CSHWkDm0.js"),__vite__mapDeps([12,9]))),oP=b.lazy(()=>wr(()=>import("./CircuitDashboard-Dp7cTnam.js"),__vite__mapDeps([13,14]))),lP=b.lazy(()=>wr(()=>import("./CircuitBooking-DeSaIU56.js"),__vite__mapDeps([15,16,14]))),cP=b.lazy(()=>wr(()=>import("./Leaderboard-BOEGiHoM.js"),__vite__mapDeps([17,18]))),uP=b.lazy(()=>wr(()=>import("./UpgradePage-DRUCCksG.js"),__vite__mapDeps([19,20]))),dP=b.lazy(()=>wr(()=>import("./SignUp-CS0JOj0L.js"),[])),hP=b.lazy(()=>wr(()=>import("./Onboarding-DBp4TnNv.js"),__vite__mapDeps([21,22])));function mP({children:n}){const{pathname:e}=Na();return b.useEffect(()=>{"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")},[]),b.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"})},[e]),n}function fP(){const n=rr();return b.useEffect(()=>{const e=sessionStorage.getItem("redirect");if(e){sessionStorage.removeItem("redirect");const t=e.replace("/login","")||"/";n(t,{replace:!0})}},[n]),null}function pP(){return r.jsx(eD,{children:r.jsx(ZI,{children:r.jsx(aD,{children:r.jsxs(lE,{basename:"/login",children:[r.jsx(fP,{}),r.jsx(mP,{children:r.jsx(b.Suspense,{fallback:r.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"60vh"},children:r.jsx("div",{style:{width:36,height:36,border:"3px solid var(--color-primary-light)",borderTopColor:"var(--color-primary)",borderRadius:"50%",animation:"app-spin .7s linear infinite"}})}),children:r.jsxs(OS,{children:[r.jsx(tn,{path:"/",element:r.jsx(lD,{})}),r.jsx(tn,{path:"/dashboard",element:r.jsx(Z6,{})}),r.jsx(tn,{path:"/add-client",element:r.jsx(eP,{})}),r.jsx(tn,{path:"/client",element:r.jsx(tP,{})}),r.jsx(tn,{path:"/client/forms",element:r.jsx(sP,{})}),r.jsx(tn,{path:"/client/tools",element:r.jsx(nP,{})}),r.jsx(tn,{path:"/client/tools/macros",element:r.jsx(rP,{})}),r.jsx(tn,{path:"/client/tools/snacks",element:r.jsx(aP,{})}),r.jsx(tn,{path:"/client/tools/motivation",element:r.jsx(iP,{})}),r.jsx(tn,{path:"/client/personal-bests",element:r.jsx(J6,{})}),r.jsx(tn,{path:"/client/circuit",element:r.jsx(oP,{})}),r.jsx(tn,{path:"/client/circuit/booking",element:r.jsx(lP,{})}),r.jsx(tn,{path:"/client/core-buddy",element:r.jsx(RD,{})}),r.jsx(tn,{path:"/client/core-buddy/nutrition",element:r.jsx(Ul,{feature:"nutrition",children:r.jsx(ID,{})})}),r.jsx(tn,{path:"/client/core-buddy/workouts",element:r.jsx(g6,{})}),r.jsx(tn,{path:"/client/core-buddy/programmes",element:r.jsx(Ul,{feature:"programmes",children:r.jsx(w6,{})})}),r.jsx(tn,{path:"/client/core-buddy/achievements",element:r.jsx(Ul,{feature:"achievements",children:r.jsx(E6,{})})}),r.jsx(tn,{path:"/client/core-buddy/consistency",element:r.jsx(Ul,{feature:"consistency",children:r.jsx(P6,{})})}),r.jsx(tn,{path:"/client/core-buddy/buddies",element:r.jsx(Ul,{feature:"buddies",children:r.jsx(L6,{})})}),r.jsx(tn,{path:"/client/core-buddy/builder",element:r.jsx(z6,{})}),r.jsx(tn,{path:"/client/core-buddy/profile/:userId",element:r.jsx(U6,{})}),r.jsx(tn,{path:"/client/leaderboard",element:r.jsx(Ul,{feature:"leaderboard",children:r.jsx(cP,{})})}),r.jsx(tn,{path:"/signup",element:r.jsx(dP,{})}),r.jsx(tn,{path:"/onboarding",element:r.jsx(hP,{})}),r.jsx(tn,{path:"/upgrade",element:r.jsx(uP,{})}),r.jsx(tn,{path:"*",element:r.jsx(Z2,{to:"/",replace:!0})})]})})})]})})})})}OT.createRoot(document.getElementById("root")).render(r.jsx(b.StrictMode,{children:r.jsx(pP,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/login/sw.js").then(n=>{setInterval(()=>n.update(),3600*1e3)}).catch(n=>console.warn("SW registration failed:",n))});export{yr as A,Ta as C,Sa as P,Rt as T,Kr as a,ur as b,qt as c,ye as d,Xe as e,e4 as f,Es as g,a4 as h,Os as i,r as j,Ls as k,Lr as l,Ca as m,rr as n,oc as o,Sm as p,Ds as q,b as r,bP as s,yc as t,la as u,oD as v,bs as w,iD as x,gP as y,mE as z};
