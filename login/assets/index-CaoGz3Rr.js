const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-CSYunldb.js","assets/Dashboard-BI21Q1GR.css","assets/AddClient-C7WJf7G-.js","assets/AddClient-DH1OFzHo.css","assets/ClientForms-DxfFB1P1.js","assets/ClientForms-GDNtnrAx.css","assets/ClientTools-2HXjZQot.js","assets/ClientTools-DQRPoST3.css","assets/MacroCalculator-DFlNDg3y.js","assets/ProteinSnacks-D4kxzXNz.js","assets/DailyMotivation-D5_xO2yY.js","assets/CircuitDashboard-cjTMET2Y.js","assets/CircuitDashboard-MPNVarsJ.css","assets/CircuitBooking-DCGVfQYM.js","assets/CircuitBooking-ruk9Q4Wj.css","assets/Leaderboard-Cv2KisP8.js","assets/Leaderboard-Dq-r5svP.css","assets/UpgradePage-Dy70SnrW.js","assets/stripe-XWxY_-qU.js","assets/UpgradePage-BB1WAf13.css","assets/Onboarding-DHxhQOhf.js","assets/Onboarding-Ivvu2oeT.css"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function t(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(o){if(o.ep)return;o.ep=!0;const c=t(o);fetch(o.href,c)}})();var jy={exports:{}},bd={};var uw;function FC(){if(uw)return bd;uw=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(s,o,c){var u=null;if(c!==void 0&&(u=""+c),o.key!==void 0&&(u=""+o.key),"key"in o){c={};for(var h in o)h!=="key"&&(c[h]=o[h])}else c=o;return o=c.ref,{$$typeof:n,type:s,key:u,ref:o!==void 0?o:null,props:c}}return bd.Fragment=e,bd.jsx=t,bd.jsxs=t,bd}var dw;function zC(){return dw||(dw=1,jy.exports=FC()),jy.exports}var a=zC(),Ny={exports:{}},en={};var hw;function qC(){if(hw)return en;hw=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),u=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),T=Symbol.iterator;function N(O){return O===null||typeof O!="object"?null:(O=T&&O[T]||O["@@iterator"],typeof O=="function"?O:null)}var B={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},P=Object.assign,M={};function Y(O,ie,Ie){this.props=O,this.context=ie,this.refs=M,this.updater=Ie||B}Y.prototype.isReactComponent={},Y.prototype.setState=function(O,ie){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,ie,"setState")},Y.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function H(){}H.prototype=Y.prototype;function X(O,ie,Ie){this.props=O,this.context=ie,this.refs=M,this.updater=Ie||B}var fe=X.prototype=new H;fe.constructor=X,P(fe,Y.prototype),fe.isPureReactComponent=!0;var je=Array.isArray;function Te(){}var C={H:null,A:null,T:null,S:null},S=Object.prototype.hasOwnProperty;function D(O,ie,Ie){var Oe=Ie.ref;return{$$typeof:n,type:O,key:ie,ref:Oe!==void 0?Oe:null,props:Ie}}function U(O,ie){return D(O.type,ie,O.props)}function V(O){return typeof O=="object"&&O!==null&&O.$$typeof===n}function q(O){var ie={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(Ie){return ie[Ie]})}var L=/\/+/g;function Ke(O,ie){return typeof O=="object"&&O!==null&&O.key!=null?q(""+O.key):ie.toString(36)}function _t(O){switch(O.status){case"fulfilled":return O.value;case"rejected":throw O.reason;default:switch(typeof O.status=="string"?O.then(Te,Te):(O.status="pending",O.then(function(ie){O.status==="pending"&&(O.status="fulfilled",O.value=ie)},function(ie){O.status==="pending"&&(O.status="rejected",O.reason=ie)})),O.status){case"fulfilled":return O.value;case"rejected":throw O.reason}}throw O}function $(O,ie,Ie,Oe,it){var ze=typeof O;(ze==="undefined"||ze==="boolean")&&(O=null);var vt=!1;if(O===null)vt=!0;else switch(ze){case"bigint":case"string":case"number":vt=!0;break;case"object":switch(O.$$typeof){case n:case e:vt=!0;break;case b:return vt=O._init,$(vt(O._payload),ie,Ie,Oe,it)}}if(vt)return it=it(O),vt=Oe===""?"."+Ke(O,0):Oe,je(it)?(Ie="",vt!=null&&(Ie=vt.replace(L,"$&/")+"/"),$(it,ie,Ie,"",function(Xt){return Xt})):it!=null&&(V(it)&&(it=U(it,Ie+(it.key==null||O&&O.key===it.key?"":(""+it.key).replace(L,"$&/")+"/")+vt)),ie.push(it)),1;vt=0;var Nt=Oe===""?".":Oe+":";if(je(O))for(var at=0;at<O.length;at++)Oe=O[at],ze=Nt+Ke(Oe,at),vt+=$(Oe,ie,Ie,ze,it);else if(at=N(O),typeof at=="function")for(O=at.call(O),at=0;!(Oe=O.next()).done;)Oe=Oe.value,ze=Nt+Ke(Oe,at++),vt+=$(Oe,ie,Ie,ze,it);else if(ze==="object"){if(typeof O.then=="function")return $(_t(O),ie,Ie,Oe,it);throw ie=String(O),Error("Objects are not valid as a React child (found: "+(ie==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":ie)+"). If you meant to render a collection of children, use an array instead.")}return vt}function ge(O,ie,Ie){if(O==null)return O;var Oe=[],it=0;return $(O,Oe,"","",function(ze){return ie.call(Ie,ze,it++)}),Oe}function Le(O){if(O._status===-1){var ie=O._result;ie=ie(),ie.then(function(Ie){(O._status===0||O._status===-1)&&(O._status=1,O._result=Ie)},function(Ie){(O._status===0||O._status===-1)&&(O._status=2,O._result=Ie)}),O._status===-1&&(O._status=0,O._result=ie)}if(O._status===1)return O._result.default;throw O._result}var Qe=typeof reportError=="function"?reportError:function(O){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ie=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof O=="object"&&O!==null&&typeof O.message=="string"?String(O.message):String(O),error:O});if(!window.dispatchEvent(ie))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",O);return}console.error(O)},ne={map:ge,forEach:function(O,ie,Ie){ge(O,function(){ie.apply(this,arguments)},Ie)},count:function(O){var ie=0;return ge(O,function(){ie++}),ie},toArray:function(O){return ge(O,function(ie){return ie})||[]},only:function(O){if(!V(O))throw Error("React.Children.only expected to receive a single React element child.");return O}};return en.Activity=x,en.Children=ne,en.Component=Y,en.Fragment=t,en.Profiler=o,en.PureComponent=X,en.StrictMode=s,en.Suspense=m,en.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=C,en.__COMPILER_RUNTIME={__proto__:null,c:function(O){return C.H.useMemoCache(O)}},en.cache=function(O){return function(){return O.apply(null,arguments)}},en.cacheSignal=function(){return null},en.cloneElement=function(O,ie,Ie){if(O==null)throw Error("The argument must be a React element, but you passed "+O+".");var Oe=P({},O.props),it=O.key;if(ie!=null)for(ze in ie.key!==void 0&&(it=""+ie.key),ie)!S.call(ie,ze)||ze==="key"||ze==="__self"||ze==="__source"||ze==="ref"&&ie.ref===void 0||(Oe[ze]=ie[ze]);var ze=arguments.length-2;if(ze===1)Oe.children=Ie;else if(1<ze){for(var vt=Array(ze),Nt=0;Nt<ze;Nt++)vt[Nt]=arguments[Nt+2];Oe.children=vt}return D(O.type,it,Oe)},en.createContext=function(O){return O={$$typeof:u,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null},O.Provider=O,O.Consumer={$$typeof:c,_context:O},O},en.createElement=function(O,ie,Ie){var Oe,it={},ze=null;if(ie!=null)for(Oe in ie.key!==void 0&&(ze=""+ie.key),ie)S.call(ie,Oe)&&Oe!=="key"&&Oe!=="__self"&&Oe!=="__source"&&(it[Oe]=ie[Oe]);var vt=arguments.length-2;if(vt===1)it.children=Ie;else if(1<vt){for(var Nt=Array(vt),at=0;at<vt;at++)Nt[at]=arguments[at+2];it.children=Nt}if(O&&O.defaultProps)for(Oe in vt=O.defaultProps,vt)it[Oe]===void 0&&(it[Oe]=vt[Oe]);return D(O,ze,it)},en.createRef=function(){return{current:null}},en.forwardRef=function(O){return{$$typeof:h,render:O}},en.isValidElement=V,en.lazy=function(O){return{$$typeof:b,_payload:{_status:-1,_result:O},_init:Le}},en.memo=function(O,ie){return{$$typeof:g,type:O,compare:ie===void 0?null:ie}},en.startTransition=function(O){var ie=C.T,Ie={};C.T=Ie;try{var Oe=O(),it=C.S;it!==null&&it(Ie,Oe),typeof Oe=="object"&&Oe!==null&&typeof Oe.then=="function"&&Oe.then(Te,Qe)}catch(ze){Qe(ze)}finally{ie!==null&&Ie.types!==null&&(ie.types=Ie.types),C.T=ie}},en.unstable_useCacheRefresh=function(){return C.H.useCacheRefresh()},en.use=function(O){return C.H.use(O)},en.useActionState=function(O,ie,Ie){return C.H.useActionState(O,ie,Ie)},en.useCallback=function(O,ie){return C.H.useCallback(O,ie)},en.useContext=function(O){return C.H.useContext(O)},en.useDebugValue=function(){},en.useDeferredValue=function(O,ie){return C.H.useDeferredValue(O,ie)},en.useEffect=function(O,ie){return C.H.useEffect(O,ie)},en.useEffectEvent=function(O){return C.H.useEffectEvent(O)},en.useId=function(){return C.H.useId()},en.useImperativeHandle=function(O,ie,Ie){return C.H.useImperativeHandle(O,ie,Ie)},en.useInsertionEffect=function(O,ie){return C.H.useInsertionEffect(O,ie)},en.useLayoutEffect=function(O,ie){return C.H.useLayoutEffect(O,ie)},en.useMemo=function(O,ie){return C.H.useMemo(O,ie)},en.useOptimistic=function(O,ie){return C.H.useOptimistic(O,ie)},en.useReducer=function(O,ie,Ie){return C.H.useReducer(O,ie,Ie)},en.useRef=function(O){return C.H.useRef(O)},en.useState=function(O){return C.H.useState(O)},en.useSyncExternalStore=function(O,ie,Ie){return C.H.useSyncExternalStore(O,ie,Ie)},en.useTransition=function(){return C.H.useTransition()},en.version="19.2.4",en}var fw;function sv(){return fw||(fw=1,Ny.exports=qC()),Ny.exports}var _=sv(),Cy={exports:{}},vd={},Ay={exports:{}},Ry={};var mw;function HC(){return mw||(mw=1,(function(n){function e($,ge){var Le=$.length;$.push(ge);e:for(;0<Le;){var Qe=Le-1>>>1,ne=$[Qe];if(0<o(ne,ge))$[Qe]=ge,$[Le]=ne,Le=Qe;else break e}}function t($){return $.length===0?null:$[0]}function s($){if($.length===0)return null;var ge=$[0],Le=$.pop();if(Le!==ge){$[0]=Le;e:for(var Qe=0,ne=$.length,O=ne>>>1;Qe<O;){var ie=2*(Qe+1)-1,Ie=$[ie],Oe=ie+1,it=$[Oe];if(0>o(Ie,Le))Oe<ne&&0>o(it,Ie)?($[Qe]=it,$[Oe]=Le,Qe=Oe):($[Qe]=Ie,$[ie]=Le,Qe=ie);else if(Oe<ne&&0>o(it,Le))$[Qe]=it,$[Oe]=Le,Qe=Oe;else break e}}return ge}function o($,ge){var Le=$.sortIndex-ge.sortIndex;return Le!==0?Le:$.id-ge.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;n.unstable_now=function(){return c.now()}}else{var u=Date,h=u.now();n.unstable_now=function(){return u.now()-h}}var m=[],g=[],b=1,x=null,T=3,N=!1,B=!1,P=!1,M=!1,Y=typeof setTimeout=="function"?setTimeout:null,H=typeof clearTimeout=="function"?clearTimeout:null,X=typeof setImmediate<"u"?setImmediate:null;function fe($){for(var ge=t(g);ge!==null;){if(ge.callback===null)s(g);else if(ge.startTime<=$)s(g),ge.sortIndex=ge.expirationTime,e(m,ge);else break;ge=t(g)}}function je($){if(P=!1,fe($),!B)if(t(m)!==null)B=!0,Te||(Te=!0,q());else{var ge=t(g);ge!==null&&_t(je,ge.startTime-$)}}var Te=!1,C=-1,S=5,D=-1;function U(){return M?!0:!(n.unstable_now()-D<S)}function V(){if(M=!1,Te){var $=n.unstable_now();D=$;var ge=!0;try{e:{B=!1,P&&(P=!1,H(C),C=-1),N=!0;var Le=T;try{t:{for(fe($),x=t(m);x!==null&&!(x.expirationTime>$&&U());){var Qe=x.callback;if(typeof Qe=="function"){x.callback=null,T=x.priorityLevel;var ne=Qe(x.expirationTime<=$);if($=n.unstable_now(),typeof ne=="function"){x.callback=ne,fe($),ge=!0;break t}x===t(m)&&s(m),fe($)}else s(m);x=t(m)}if(x!==null)ge=!0;else{var O=t(g);O!==null&&_t(je,O.startTime-$),ge=!1}}break e}finally{x=null,T=Le,N=!1}ge=void 0}}finally{ge?q():Te=!1}}}var q;if(typeof X=="function")q=function(){X(V)};else if(typeof MessageChannel<"u"){var L=new MessageChannel,Ke=L.port2;L.port1.onmessage=V,q=function(){Ke.postMessage(null)}}else q=function(){Y(V,0)};function _t($,ge){C=Y(function(){$(n.unstable_now())},ge)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function($){$.callback=null},n.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<$?Math.floor(1e3/$):5},n.unstable_getCurrentPriorityLevel=function(){return T},n.unstable_next=function($){switch(T){case 1:case 2:case 3:var ge=3;break;default:ge=T}var Le=T;T=ge;try{return $()}finally{T=Le}},n.unstable_requestPaint=function(){M=!0},n.unstable_runWithPriority=function($,ge){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var Le=T;T=$;try{return ge()}finally{T=Le}},n.unstable_scheduleCallback=function($,ge,Le){var Qe=n.unstable_now();switch(typeof Le=="object"&&Le!==null?(Le=Le.delay,Le=typeof Le=="number"&&0<Le?Qe+Le:Qe):Le=Qe,$){case 1:var ne=-1;break;case 2:ne=250;break;case 5:ne=1073741823;break;case 4:ne=1e4;break;default:ne=5e3}return ne=Le+ne,$={id:b++,callback:ge,priorityLevel:$,startTime:Le,expirationTime:ne,sortIndex:-1},Le>Qe?($.sortIndex=Le,e(g,$),t(m)===null&&$===t(g)&&(P?(H(C),C=-1):P=!0,_t(je,Le-Qe))):($.sortIndex=ne,e(m,$),B||N||(B=!0,Te||(Te=!0,q()))),$},n.unstable_shouldYield=U,n.unstable_wrapCallback=function($){var ge=T;return function(){var Le=T;T=ge;try{return $.apply(this,arguments)}finally{T=Le}}}})(Ry)),Ry}var pw;function $C(){return pw||(pw=1,Ay.exports=HC()),Ay.exports}var Iy={exports:{}},xr={};var gw;function WC(){if(gw)return xr;gw=1;var n=sv();function e(m){var g="https://react.dev/errors/"+m;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)g+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+m+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var s={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},o=Symbol.for("react.portal");function c(m,g,b){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:x==null?null:""+x,children:m,containerInfo:g,implementation:b}}var u=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(m,g){if(m==="font")return"";if(typeof g=="string")return g==="use-credentials"?g:""}return xr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,xr.createPortal=function(m,g){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)throw Error(e(299));return c(m,g,null,b)},xr.flushSync=function(m){var g=u.T,b=s.p;try{if(u.T=null,s.p=2,m)return m()}finally{u.T=g,s.p=b,s.d.f()}},xr.preconnect=function(m,g){typeof m=="string"&&(g?(g=g.crossOrigin,g=typeof g=="string"?g==="use-credentials"?g:"":void 0):g=null,s.d.C(m,g))},xr.prefetchDNS=function(m){typeof m=="string"&&s.d.D(m)},xr.preinit=function(m,g){if(typeof m=="string"&&g&&typeof g.as=="string"){var b=g.as,x=h(b,g.crossOrigin),T=typeof g.integrity=="string"?g.integrity:void 0,N=typeof g.fetchPriority=="string"?g.fetchPriority:void 0;b==="style"?s.d.S(m,typeof g.precedence=="string"?g.precedence:void 0,{crossOrigin:x,integrity:T,fetchPriority:N}):b==="script"&&s.d.X(m,{crossOrigin:x,integrity:T,fetchPriority:N,nonce:typeof g.nonce=="string"?g.nonce:void 0})}},xr.preinitModule=function(m,g){if(typeof m=="string")if(typeof g=="object"&&g!==null){if(g.as==null||g.as==="script"){var b=h(g.as,g.crossOrigin);s.d.M(m,{crossOrigin:b,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0})}}else g==null&&s.d.M(m)},xr.preload=function(m,g){if(typeof m=="string"&&typeof g=="object"&&g!==null&&typeof g.as=="string"){var b=g.as,x=h(b,g.crossOrigin);s.d.L(m,b,{crossOrigin:x,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0,type:typeof g.type=="string"?g.type:void 0,fetchPriority:typeof g.fetchPriority=="string"?g.fetchPriority:void 0,referrerPolicy:typeof g.referrerPolicy=="string"?g.referrerPolicy:void 0,imageSrcSet:typeof g.imageSrcSet=="string"?g.imageSrcSet:void 0,imageSizes:typeof g.imageSizes=="string"?g.imageSizes:void 0,media:typeof g.media=="string"?g.media:void 0})}},xr.preloadModule=function(m,g){if(typeof m=="string")if(g){var b=h(g.as,g.crossOrigin);s.d.m(m,{as:typeof g.as=="string"&&g.as!=="script"?g.as:void 0,crossOrigin:b,integrity:typeof g.integrity=="string"?g.integrity:void 0})}else s.d.m(m)},xr.requestFormReset=function(m){s.d.r(m)},xr.unstable_batchedUpdates=function(m,g){return m(g)},xr.useFormState=function(m,g,b){return u.H.useFormState(m,g,b)},xr.useFormStatus=function(){return u.H.useHostTransitionStatus()},xr.version="19.2.4",xr}var yw;function GC(){if(yw)return Iy.exports;yw=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Iy.exports=WC(),Iy.exports}var bw;function KC(){if(bw)return vd;bw=1;var n=$C(),e=sv(),t=GC();function s(r){var i="https://react.dev/errors/"+r;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)i+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+r+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function c(r){var i=r,l=r;if(r.alternate)for(;i.return;)i=i.return;else{r=i;do i=r,(i.flags&4098)!==0&&(l=i.return),r=i.return;while(r)}return i.tag===3?l:null}function u(r){if(r.tag===13){var i=r.memoizedState;if(i===null&&(r=r.alternate,r!==null&&(i=r.memoizedState)),i!==null)return i.dehydrated}return null}function h(r){if(r.tag===31){var i=r.memoizedState;if(i===null&&(r=r.alternate,r!==null&&(i=r.memoizedState)),i!==null)return i.dehydrated}return null}function m(r){if(c(r)!==r)throw Error(s(188))}function g(r){var i=r.alternate;if(!i){if(i=c(r),i===null)throw Error(s(188));return i!==r?null:r}for(var l=r,d=i;;){var p=l.return;if(p===null)break;var y=p.alternate;if(y===null){if(d=p.return,d!==null){l=d;continue}break}if(p.child===y.child){for(y=p.child;y;){if(y===l)return m(p),r;if(y===d)return m(p),i;y=y.sibling}throw Error(s(188))}if(l.return!==d.return)l=p,d=y;else{for(var w=!1,j=p.child;j;){if(j===l){w=!0,l=p,d=y;break}if(j===d){w=!0,d=p,l=y;break}j=j.sibling}if(!w){for(j=y.child;j;){if(j===l){w=!0,l=y,d=p;break}if(j===d){w=!0,d=y,l=p;break}j=j.sibling}if(!w)throw Error(s(189))}}if(l.alternate!==d)throw Error(s(190))}if(l.tag!==3)throw Error(s(188));return l.stateNode.current===l?r:i}function b(r){var i=r.tag;if(i===5||i===26||i===27||i===6)return r;for(r=r.child;r!==null;){if(i=b(r),i!==null)return i;r=r.sibling}return null}var x=Object.assign,T=Symbol.for("react.element"),N=Symbol.for("react.transitional.element"),B=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),M=Symbol.for("react.strict_mode"),Y=Symbol.for("react.profiler"),H=Symbol.for("react.consumer"),X=Symbol.for("react.context"),fe=Symbol.for("react.forward_ref"),je=Symbol.for("react.suspense"),Te=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),S=Symbol.for("react.lazy"),D=Symbol.for("react.activity"),U=Symbol.for("react.memo_cache_sentinel"),V=Symbol.iterator;function q(r){return r===null||typeof r!="object"?null:(r=V&&r[V]||r["@@iterator"],typeof r=="function"?r:null)}var L=Symbol.for("react.client.reference");function Ke(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===L?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case P:return"Fragment";case Y:return"Profiler";case M:return"StrictMode";case je:return"Suspense";case Te:return"SuspenseList";case D:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case B:return"Portal";case X:return r.displayName||"Context";case H:return(r._context.displayName||"Context")+".Consumer";case fe:var i=r.render;return r=r.displayName,r||(r=i.displayName||i.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case C:return i=r.displayName||null,i!==null?i:Ke(r.type)||"Memo";case S:i=r._payload,r=r._init;try{return Ke(r(i))}catch{}}return null}var _t=Array.isArray,$=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ge=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Le={pending:!1,data:null,method:null,action:null},Qe=[],ne=-1;function O(r){return{current:r}}function ie(r){0>ne||(r.current=Qe[ne],Qe[ne]=null,ne--)}function Ie(r,i){ne++,Qe[ne]=r.current,r.current=i}var Oe=O(null),it=O(null),ze=O(null),vt=O(null);function Nt(r,i){switch(Ie(ze,i),Ie(it,r),Ie(Oe,null),i.nodeType){case 9:case 11:r=(r=i.documentElement)&&(r=r.namespaceURI)?D_(r):0;break;default:if(r=i.tagName,i=i.namespaceURI)i=D_(i),r=P_(i,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}ie(Oe),Ie(Oe,r)}function at(){ie(Oe),ie(it),ie(ze)}function Xt(r){r.memoizedState!==null&&Ie(vt,r);var i=Oe.current,l=P_(i,r.type);i!==l&&(Ie(it,r),Ie(Oe,l))}function An(r){it.current===r&&(ie(Oe),ie(it)),vt.current===r&&(ie(vt),md._currentValue=Le)}var Pt,Ce;function ee(r){if(Pt===void 0)try{throw Error()}catch(l){var i=l.stack.trim().match(/\n( *(at )?)/);Pt=i&&i[1]||"",Ce=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Pt+r+Ce}var yt=!1;function bt(r,i){if(!r||yt)return"";yt=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(i){var Pe=function(){throw Error()};if(Object.defineProperty(Pe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Pe,[])}catch(ye){var de=ye}Reflect.construct(r,[],Pe)}else{try{Pe.call()}catch(ye){de=ye}r.call(Pe.prototype)}}else{try{throw Error()}catch(ye){de=ye}(Pe=r())&&typeof Pe.catch=="function"&&Pe.catch(function(){})}}catch(ye){if(ye&&de&&typeof ye.stack=="string")return[ye.stack,de.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=d.DetermineComponentFrameRoot(),w=y[0],j=y[1];if(w&&j){var F=w.split(`
`),ce=j.split(`
`);for(p=d=0;d<F.length&&!F[d].includes("DetermineComponentFrameRoot");)d++;for(;p<ce.length&&!ce[p].includes("DetermineComponentFrameRoot");)p++;if(d===F.length||p===ce.length)for(d=F.length-1,p=ce.length-1;1<=d&&0<=p&&F[d]!==ce[p];)p--;for(;1<=d&&0<=p;d--,p--)if(F[d]!==ce[p]){if(d!==1||p!==1)do if(d--,p--,0>p||F[d]!==ce[p]){var Se=`
`+F[d].replace(" at new "," at ");return r.displayName&&Se.includes("<anonymous>")&&(Se=Se.replace("<anonymous>",r.displayName)),Se}while(1<=d&&0<=p);break}}}finally{yt=!1,Error.prepareStackTrace=l}return(l=r?r.displayName||r.name:"")?ee(l):""}function et(r,i){switch(r.tag){case 26:case 27:case 5:return ee(r.type);case 16:return ee("Lazy");case 13:return r.child!==i&&i!==null?ee("Suspense Fallback"):ee("Suspense");case 19:return ee("SuspenseList");case 0:case 15:return bt(r.type,!1);case 11:return bt(r.type.render,!1);case 1:return bt(r.type,!0);case 31:return ee("Activity");default:return""}}function ft(r){try{var i="",l=null;do i+=et(r,l),l=r,r=r.return;while(r);return i}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}var rt=Object.prototype.hasOwnProperty,tt=n.unstable_scheduleCallback,Ft=n.unstable_cancelCallback,ts=n.unstable_shouldYield,Dt=n.unstable_requestPaint,un=n.unstable_now,fs=n.unstable_getCurrentPriorityLevel,Yt=n.unstable_ImmediatePriority,Mn=n.unstable_UserBlockingPriority,dn=n.unstable_NormalPriority,Rn=n.unstable_LowPriority,he=n.unstable_IdlePriority,De=n.log,Be=n.unstable_setDisableYieldValue,nt=null,Fe=null;function Me(r){if(typeof De=="function"&&Be(r),Fe&&typeof Fe.setStrictMode=="function")try{Fe.setStrictMode(nt,r)}catch{}}var qe=Math.clz32?Math.clz32:Mt,St=Math.log,wt=Math.LN2;function Mt(r){return r>>>=0,r===0?32:31-(St(r)/wt|0)|0}var Jt=256,Z=262144,xe=4194304;function ct(r){var i=r&42;if(i!==0)return i;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function Lt(r,i,l){var d=r.pendingLanes;if(d===0)return 0;var p=0,y=r.suspendedLanes,w=r.pingedLanes;r=r.warmLanes;var j=d&134217727;return j!==0?(d=j&~y,d!==0?p=ct(d):(w&=j,w!==0?p=ct(w):l||(l=j&~r,l!==0&&(p=ct(l))))):(j=d&~y,j!==0?p=ct(j):w!==0?p=ct(w):l||(l=d&~r,l!==0&&(p=ct(l)))),p===0?0:i!==0&&i!==p&&(i&y)===0&&(y=p&-p,l=i&-i,y>=l||y===32&&(l&4194048)!==0)?i:p}function Ct(r,i){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&i)===0}function an(r,i){switch(r){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Zt(){var r=xe;return xe<<=1,(xe&62914560)===0&&(xe=4194304),r}function Wt(r){for(var i=[],l=0;31>l;l++)i.push(r);return i}function Ln(r,i){r.pendingLanes|=i,i!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function as(r,i,l,d,p,y){var w=r.pendingLanes;r.pendingLanes=l,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=l,r.entangledLanes&=l,r.errorRecoveryDisabledLanes&=l,r.shellSuspendCounter=0;var j=r.entanglements,F=r.expirationTimes,ce=r.hiddenUpdates;for(l=w&~l;0<l;){var Se=31-qe(l),Pe=1<<Se;j[Se]=0,F[Se]=-1;var de=ce[Se];if(de!==null)for(ce[Se]=null,Se=0;Se<de.length;Se++){var ye=de[Se];ye!==null&&(ye.lane&=-536870913)}l&=~Pe}d!==0&&bn(r,d,0),y!==0&&p===0&&r.tag!==0&&(r.suspendedLanes|=y&~(w&~i))}function bn(r,i,l){r.pendingLanes|=i,r.suspendedLanes&=~i;var d=31-qe(i);r.entangledLanes|=i,r.entanglements[d]=r.entanglements[d]|1073741824|l&261930}function In(r,i){var l=r.entangledLanes|=i;for(r=r.entanglements;l;){var d=31-qe(l),p=1<<d;p&i|r[d]&i&&(r[d]|=i),l&=~p}}function Bn(r,i){var l=i&-i;return l=(l&42)!==0?1:z(l),(l&(r.suspendedLanes|i))!==0?0:l}function z(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function _e(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function ke(){var r=ge.p;return r!==0?r:(r=window.event,r===void 0?32:sw(r.type))}function Ee(r,i){var l=ge.p;try{return ge.p=r,i()}finally{ge.p=l}}var be=Math.random().toString(36).slice(2),lt="__reactFiber$"+be,It="__reactProps$"+be,ut="__reactContainer$"+be,Tt="__reactEvents$"+be,At="__reactListeners$"+be,mn="__reactHandles$"+be,er="__reactResources$"+be,ks="__reactMarker$"+be;function Ds(r){delete r[lt],delete r[It],delete r[Tt],delete r[At],delete r[mn]}function ns(r){var i=r[lt];if(i)return i;for(var l=r.parentNode;l;){if(i=l[ut]||l[lt]){if(l=i.alternate,i.child!==null||l!==null&&l.child!==null)for(r=F_(r);r!==null;){if(l=r[lt])return l;r=F_(r)}return i}r=l,l=r.parentNode}return null}function W(r){if(r=r[lt]||r[ut]){var i=r.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return r}return null}function me(r){var i=r.tag;if(i===5||i===26||i===27||i===6)return r.stateNode;throw Error(s(33))}function E(r){var i=r[er];return i||(i=r[er]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function A(r){r[ks]=!0}var K=new Set,oe={};function Ye(r,i){$e(r,i),$e(r+"Capture",i)}function $e(r,i){for(oe[r]=i,r=0;r<i.length;r++)K.add(i[r])}var He=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Qt={},Ot={};function Yn(r){return rt.call(Ot,r)?!0:rt.call(Qt,r)?!1:He.test(r)?Ot[r]=!0:(Qt[r]=!0,!1)}function Gs(r,i,l){if(Yn(i))if(l===null)r.removeAttribute(i);else{switch(typeof l){case"undefined":case"function":case"symbol":r.removeAttribute(i);return;case"boolean":var d=i.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){r.removeAttribute(i);return}}r.setAttribute(i,""+l)}}function Bs(r,i,l){if(l===null)r.removeAttribute(i);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(i);return}r.setAttribute(i,""+l)}}function Hn(r,i,l,d){if(d===null)r.removeAttribute(l);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(l);return}r.setAttributeNS(i,l,""+d)}}function $n(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Q(r){var i=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function we(r,i,l){var d=Object.getOwnPropertyDescriptor(r.constructor.prototype,i);if(!r.hasOwnProperty(i)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var p=d.get,y=d.set;return Object.defineProperty(r,i,{configurable:!0,get:function(){return p.call(this)},set:function(w){l=""+w,y.call(this,w)}}),Object.defineProperty(r,i,{enumerable:d.enumerable}),{getValue:function(){return l},setValue:function(w){l=""+w},stopTracking:function(){r._valueTracker=null,delete r[i]}}}}function se(r){if(!r._valueTracker){var i=Q(r)?"checked":"value";r._valueTracker=we(r,i,""+r[i])}}function Ue(r){if(!r)return!1;var i=r._valueTracker;if(!i)return!0;var l=i.getValue(),d="";return r&&(d=Q(r)?r.checked?"true":"false":r.value),r=d,r!==l?(i.setValue(r),!0):!1}function We(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var ht=/[\n"\\]/g;function kt(r){return r.replace(ht,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function Bt(r,i,l,d,p,y,w,j){r.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?r.type=w:r.removeAttribute("type"),i!=null?w==="number"?(i===0&&r.value===""||r.value!=i)&&(r.value=""+$n(i)):r.value!==""+$n(i)&&(r.value=""+$n(i)):w!=="submit"&&w!=="reset"||r.removeAttribute("value"),i!=null?_s(r,w,$n(i)):l!=null?_s(r,w,$n(l)):d!=null&&r.removeAttribute("value"),p==null&&y!=null&&(r.defaultChecked=!!y),p!=null&&(r.checked=p&&typeof p!="function"&&typeof p!="symbol"),j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"?r.name=""+$n(j):r.removeAttribute("name")}function kn(r,i,l,d,p,y,w,j){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(r.type=y),i!=null||l!=null){if(!(y!=="submit"&&y!=="reset"||i!=null)){se(r);return}l=l!=null?""+$n(l):"",i=i!=null?""+$n(i):l,j||i===r.value||(r.value=i),r.defaultValue=i}d=d??p,d=typeof d!="function"&&typeof d!="symbol"&&!!d,r.checked=j?r.checked:!!d,r.defaultChecked=!!d,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(r.name=w),se(r)}function _s(r,i,l){i==="number"&&We(r.ownerDocument)===r||r.defaultValue===""+l||(r.defaultValue=""+l)}function vn(r,i,l,d){if(r=r.options,i){i={};for(var p=0;p<l.length;p++)i["$"+l[p]]=!0;for(l=0;l<r.length;l++)p=i.hasOwnProperty("$"+r[l].value),r[l].selected!==p&&(r[l].selected=p),p&&d&&(r[l].defaultSelected=!0)}else{for(l=""+$n(l),i=null,p=0;p<r.length;p++){if(r[p].value===l){r[p].selected=!0,d&&(r[p].defaultSelected=!0);return}i!==null||r[p].disabled||(i=r[p])}i!==null&&(i.selected=!0)}}function cr(r,i,l){if(i!=null&&(i=""+$n(i),i!==r.value&&(r.value=i),l==null)){r.defaultValue!==i&&(r.defaultValue=i);return}r.defaultValue=l!=null?""+$n(l):""}function ci(r,i,l,d){if(i==null){if(d!=null){if(l!=null)throw Error(s(92));if(_t(d)){if(1<d.length)throw Error(s(93));d=d[0]}l=d}l==null&&(l=""),i=l}l=$n(i),r.defaultValue=l,d=r.textContent,d===l&&d!==""&&d!==null&&(r.value=d),se(r)}function Es(r,i){if(i){var l=r.firstChild;if(l&&l===r.lastChild&&l.nodeType===3){l.nodeValue=i;return}}r.textContent=i}var Fi=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function tr(r,i,l){var d=i.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?d?r.setProperty(i,""):i==="float"?r.cssFloat="":r[i]="":d?r.setProperty(i,l):typeof l!="number"||l===0||Fi.has(i)?i==="float"?r.cssFloat=l:r[i]=(""+l).trim():r[i]=l+"px"}function cn(r,i,l){if(i!=null&&typeof i!="object")throw Error(s(62));if(r=r.style,l!=null){for(var d in l)!l.hasOwnProperty(d)||i!=null&&i.hasOwnProperty(d)||(d.indexOf("--")===0?r.setProperty(d,""):d==="float"?r.cssFloat="":r[d]="");for(var p in i)d=i[p],i.hasOwnProperty(p)&&l[p]!==d&&tr(r,p,d)}else for(var y in i)i.hasOwnProperty(y)&&tr(r,y,i[y])}function ws(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yr=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ur=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Pr(r){return ur.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function ls(){}var Ks=null;function Us(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Mr=null,Lr=null;function Gr(r){var i=W(r);if(i&&(r=i.stateNode)){var l=r[It]||null;e:switch(r=i.stateNode,i.type){case"input":if(Bt(r,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),i=l.name,l.type==="radio"&&i!=null){for(l=r;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+kt(""+i)+'"][type="radio"]'),i=0;i<l.length;i++){var d=l[i];if(d!==r&&d.form===r.form){var p=d[It]||null;if(!p)throw Error(s(90));Bt(d,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(i=0;i<l.length;i++)d=l[i],d.form===r.form&&Ue(d)}break e;case"textarea":cr(r,l.value,l.defaultValue);break e;case"select":i=l.value,i!=null&&vn(r,!!l.multiple,i,!1)}}}var Wa=!1;function zi(r,i,l){if(Wa)return r(i,l);Wa=!0;try{var d=r(i);return d}finally{if(Wa=!1,(Mr!==null||Lr!==null)&&(wf(),Mr&&(i=Mr,r=Lr,Lr=Mr=null,Gr(i),r)))for(i=0;i<r.length;i++)Gr(r[i])}}function Kr(r,i){var l=r.stateNode;if(l===null)return null;var d=l[It]||null;if(d===null)return null;l=d[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(r=r.type,d=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!d;break e;default:r=!1}if(r)return null;if(l&&typeof l!="function")throw Error(s(231,i,typeof l));return l}var I=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),te=!1;if(I)try{var Ne={};Object.defineProperty(Ne,"passive",{get:function(){te=!0}}),window.addEventListener("test",Ne,Ne),window.removeEventListener("test",Ne,Ne)}catch{te=!1}var st=null,jt=null,Ut=null;function ot(){if(Ut)return Ut;var r,i=jt,l=i.length,d,p="value"in st?st.value:st.textContent,y=p.length;for(r=0;r<l&&i[r]===p[r];r++);var w=l-r;for(d=1;d<=w&&i[l-d]===p[y-d];d++);return Ut=p.slice(r,1<d?1-d:void 0)}function Gt(r){var i=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&i===13&&(r=13)):r=i,r===10&&(r=13),32<=r||r===13?r:0}function $t(){return!0}function nn(){return!1}function zt(r){function i(l,d,p,y,w){this._reactName=l,this._targetInst=p,this.type=d,this.nativeEvent=y,this.target=w,this.currentTarget=null;for(var j in r)r.hasOwnProperty(j)&&(l=r[j],this[j]=l?l(y):y[j]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?$t:nn,this.isPropagationStopped=nn,this}return x(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=$t)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=$t)},persist:function(){},isPersistent:$t}),i}var on={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ss=zt(on),Qs=x({},on,{view:0,detail:0}),qn=zt(Qs),Nn,ms,cs,Ys=x({},Qs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ga,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==cs&&(cs&&r.type==="mousemove"?(Nn=r.screenX-cs.screenX,ms=r.screenY-cs.screenY):ms=Nn=0,cs=r),Nn)},movementY:function(r){return"movementY"in r?r.movementY:ms}}),br=zt(Ys),dr=x({},Ys,{dataTransfer:0}),Er=zt(dr),vr=x({},Qs,{relatedTarget:0}),js=zt(vr),Sr=x({},on,{animationName:0,elapsedTime:0,pseudoElement:0}),Vr=zt(Sr),ca=x({},on,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),ec=zt(ca),tc=x({},on,{data:0}),jr=zt(tc),ki={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ei={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Lh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Vh(r){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(r):(r=Lh[r])?!!i[r]:!1}function Ga(){return Vh}var Nr=x({},Qs,{key:function(r){if(r.key){var i=ki[r.key]||r.key;if(i!=="Unidentified")return i}return r.type==="keypress"?(r=Gt(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?Ei[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ga,charCode:function(r){return r.type==="keypress"?Gt(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Gt(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Oh=zt(Nr),Bh=x({},Ys,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ua=zt(Bh),f=x({},Qs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ga}),v=zt(f),k=x({},on,{propertyName:0,elapsedTime:0,pseudoElement:0}),R=zt(k),ae=x({},Ys,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),pe=zt(ae),Xe=x({},on,{newState:0,oldState:0}),sn=zt(Xe),Ps=[9,13,27,32],Un=I&&"CompositionEvent"in window,ps=null;I&&"documentMode"in document&&(ps=document.documentMode);var ui=I&&"TextEvent"in window&&!ps,qi=I&&(!Un||ps&&8<ps&&11>=ps),Si=" ",ji=!1;function el(r,i){switch(r){case"keyup":return Ps.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function nc(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var sc=!1;function dN(r,i){switch(r){case"compositionend":return nc(i);case"keypress":return i.which!==32?null:(ji=!0,Si);case"textInput":return r=i.data,r===Si&&ji?null:r;default:return null}}function hN(r,i){if(sc)return r==="compositionend"||!Un&&el(r,i)?(r=ot(),Ut=jt=st=null,sc=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return qi&&i.locale!=="ko"?null:i.data;default:return null}}var fN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function H0(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i==="input"?!!fN[r.type]:i==="textarea"}function $0(r,i,l,d){Mr?Lr?Lr.push(d):Lr=[d]:Mr=d,i=Cf(i,"onChange"),0<i.length&&(l=new Ss("onChange","change",null,l,d),r.push({event:l,listeners:i}))}var Lu=null,Vu=null;function mN(r){j_(r,0)}function Uh(r){var i=me(r);if(Ue(i))return r}function W0(r,i){if(r==="change")return i}var G0=!1;if(I){var Pp;if(I){var Mp="oninput"in document;if(!Mp){var K0=document.createElement("div");K0.setAttribute("oninput","return;"),Mp=typeof K0.oninput=="function"}Pp=Mp}else Pp=!1;G0=Pp&&(!document.documentMode||9<document.documentMode)}function Q0(){Lu&&(Lu.detachEvent("onpropertychange",Y0),Vu=Lu=null)}function Y0(r){if(r.propertyName==="value"&&Uh(Vu)){var i=[];$0(i,Vu,r,Us(r)),zi(mN,i)}}function pN(r,i,l){r==="focusin"?(Q0(),Lu=i,Vu=l,Lu.attachEvent("onpropertychange",Y0)):r==="focusout"&&Q0()}function gN(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Uh(Vu)}function yN(r,i){if(r==="click")return Uh(i)}function bN(r,i){if(r==="input"||r==="change")return Uh(i)}function vN(r,i){return r===i&&(r!==0||1/r===1/i)||r!==r&&i!==i}var Qr=typeof Object.is=="function"?Object.is:vN;function Ou(r,i){if(Qr(r,i))return!0;if(typeof r!="object"||r===null||typeof i!="object"||i===null)return!1;var l=Object.keys(r),d=Object.keys(i);if(l.length!==d.length)return!1;for(d=0;d<l.length;d++){var p=l[d];if(!rt.call(i,p)||!Qr(r[p],i[p]))return!1}return!0}function X0(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function J0(r,i){var l=X0(r);r=0;for(var d;l;){if(l.nodeType===3){if(d=r+l.textContent.length,r<=i&&d>=i)return{node:l,offset:i-r};r=d}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=X0(l)}}function Z0(r,i){return r&&i?r===i?!0:r&&r.nodeType===3?!1:i&&i.nodeType===3?Z0(r,i.parentNode):"contains"in r?r.contains(i):r.compareDocumentPosition?!!(r.compareDocumentPosition(i)&16):!1:!1}function e1(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var i=We(r.document);i instanceof r.HTMLIFrameElement;){try{var l=typeof i.contentWindow.location.href=="string"}catch{l=!1}if(l)r=i.contentWindow;else break;i=We(r.document)}return i}function Lp(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i&&(i==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||i==="textarea"||r.contentEditable==="true")}var xN=I&&"documentMode"in document&&11>=document.documentMode,rc=null,Vp=null,Bu=null,Op=!1;function t1(r,i,l){var d=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Op||rc==null||rc!==We(d)||(d=rc,"selectionStart"in d&&Lp(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),Bu&&Ou(Bu,d)||(Bu=d,d=Cf(Vp,"onSelect"),0<d.length&&(i=new Ss("onSelect","select",null,i,l),r.push({event:i,listeners:d}),i.target=rc)))}function tl(r,i){var l={};return l[r.toLowerCase()]=i.toLowerCase(),l["Webkit"+r]="webkit"+i,l["Moz"+r]="moz"+i,l}var ic={animationend:tl("Animation","AnimationEnd"),animationiteration:tl("Animation","AnimationIteration"),animationstart:tl("Animation","AnimationStart"),transitionrun:tl("Transition","TransitionRun"),transitionstart:tl("Transition","TransitionStart"),transitioncancel:tl("Transition","TransitionCancel"),transitionend:tl("Transition","TransitionEnd")},Bp={},n1={};I&&(n1=document.createElement("div").style,"AnimationEvent"in window||(delete ic.animationend.animation,delete ic.animationiteration.animation,delete ic.animationstart.animation),"TransitionEvent"in window||delete ic.transitionend.transition);function nl(r){if(Bp[r])return Bp[r];if(!ic[r])return r;var i=ic[r],l;for(l in i)if(i.hasOwnProperty(l)&&l in n1)return Bp[r]=i[l];return r}var s1=nl("animationend"),r1=nl("animationiteration"),i1=nl("animationstart"),_N=nl("transitionrun"),wN=nl("transitionstart"),TN=nl("transitioncancel"),a1=nl("transitionend"),o1=new Map,Up="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Up.push("scrollEnd");function Ni(r,i){o1.set(r,i),Ye(i,[r])}var Fh=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},di=[],ac=0,Fp=0;function zh(){for(var r=ac,i=Fp=ac=0;i<r;){var l=di[i];di[i++]=null;var d=di[i];di[i++]=null;var p=di[i];di[i++]=null;var y=di[i];if(di[i++]=null,d!==null&&p!==null){var w=d.pending;w===null?p.next=p:(p.next=w.next,w.next=p),d.pending=p}y!==0&&l1(l,p,y)}}function qh(r,i,l,d){di[ac++]=r,di[ac++]=i,di[ac++]=l,di[ac++]=d,Fp|=d,r.lanes|=d,r=r.alternate,r!==null&&(r.lanes|=d)}function zp(r,i,l,d){return qh(r,i,l,d),Hh(r)}function sl(r,i){return qh(r,null,null,i),Hh(r)}function l1(r,i,l){r.lanes|=l;var d=r.alternate;d!==null&&(d.lanes|=l);for(var p=!1,y=r.return;y!==null;)y.childLanes|=l,d=y.alternate,d!==null&&(d.childLanes|=l),y.tag===22&&(r=y.stateNode,r===null||r._visibility&1||(p=!0)),r=y,y=y.return;return r.tag===3?(y=r.stateNode,p&&i!==null&&(p=31-qe(l),r=y.hiddenUpdates,d=r[p],d===null?r[p]=[i]:d.push(i),i.lane=l|536870912),y):null}function Hh(r){if(50<od)throw od=0,Xg=null,Error(s(185));for(var i=r.return;i!==null;)r=i,i=r.return;return r.tag===3?r.stateNode:null}var oc={};function kN(r,i,l,d){this.tag=r,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Yr(r,i,l,d){return new kN(r,i,l,d)}function qp(r){return r=r.prototype,!(!r||!r.isReactComponent)}function da(r,i){var l=r.alternate;return l===null?(l=Yr(r.tag,i,r.key,r.mode),l.elementType=r.elementType,l.type=r.type,l.stateNode=r.stateNode,l.alternate=r,r.alternate=l):(l.pendingProps=i,l.type=r.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=r.flags&65011712,l.childLanes=r.childLanes,l.lanes=r.lanes,l.child=r.child,l.memoizedProps=r.memoizedProps,l.memoizedState=r.memoizedState,l.updateQueue=r.updateQueue,i=r.dependencies,l.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},l.sibling=r.sibling,l.index=r.index,l.ref=r.ref,l.refCleanup=r.refCleanup,l}function c1(r,i){r.flags&=65011714;var l=r.alternate;return l===null?(r.childLanes=0,r.lanes=i,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=l.childLanes,r.lanes=l.lanes,r.child=l.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=l.memoizedProps,r.memoizedState=l.memoizedState,r.updateQueue=l.updateQueue,r.type=l.type,i=l.dependencies,r.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),r}function $h(r,i,l,d,p,y){var w=0;if(d=r,typeof r=="function")qp(r)&&(w=1);else if(typeof r=="string")w=CC(r,l,Oe.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case D:return r=Yr(31,l,i,p),r.elementType=D,r.lanes=y,r;case P:return rl(l.children,p,y,i);case M:w=8,p|=24;break;case Y:return r=Yr(12,l,i,p|2),r.elementType=Y,r.lanes=y,r;case je:return r=Yr(13,l,i,p),r.elementType=je,r.lanes=y,r;case Te:return r=Yr(19,l,i,p),r.elementType=Te,r.lanes=y,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case X:w=10;break e;case H:w=9;break e;case fe:w=11;break e;case C:w=14;break e;case S:w=16,d=null;break e}w=29,l=Error(s(130,r===null?"null":typeof r,"")),d=null}return i=Yr(w,l,i,p),i.elementType=r,i.type=d,i.lanes=y,i}function rl(r,i,l,d){return r=Yr(7,r,d,i),r.lanes=l,r}function Hp(r,i,l){return r=Yr(6,r,null,i),r.lanes=l,r}function u1(r){var i=Yr(18,null,null,0);return i.stateNode=r,i}function $p(r,i,l){return i=Yr(4,r.children!==null?r.children:[],r.key,i),i.lanes=l,i.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},i}var d1=new WeakMap;function hi(r,i){if(typeof r=="object"&&r!==null){var l=d1.get(r);return l!==void 0?l:(i={value:r,source:i,stack:ft(i)},d1.set(r,i),i)}return{value:r,source:i,stack:ft(i)}}var lc=[],cc=0,Wh=null,Uu=0,fi=[],mi=0,Ka=null,Hi=1,$i="";function ha(r,i){lc[cc++]=Uu,lc[cc++]=Wh,Wh=r,Uu=i}function h1(r,i,l){fi[mi++]=Hi,fi[mi++]=$i,fi[mi++]=Ka,Ka=r;var d=Hi;r=$i;var p=32-qe(d)-1;d&=~(1<<p),l+=1;var y=32-qe(i)+p;if(30<y){var w=p-p%5;y=(d&(1<<w)-1).toString(32),d>>=w,p-=w,Hi=1<<32-qe(i)+p|l<<p|d,$i=y+r}else Hi=1<<y|l<<p|d,$i=r}function Wp(r){r.return!==null&&(ha(r,1),h1(r,1,0))}function Gp(r){for(;r===Wh;)Wh=lc[--cc],lc[cc]=null,Uu=lc[--cc],lc[cc]=null;for(;r===Ka;)Ka=fi[--mi],fi[mi]=null,$i=fi[--mi],fi[mi]=null,Hi=fi[--mi],fi[mi]=null}function f1(r,i){fi[mi++]=Hi,fi[mi++]=$i,fi[mi++]=Ka,Hi=i.id,$i=i.overflow,Ka=r}var hr=null,us=null,En=!1,Qa=null,pi=!1,Kp=Error(s(519));function Ya(r){var i=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Fu(hi(i,r)),Kp}function m1(r){var i=r.stateNode,l=r.type,d=r.memoizedProps;switch(i[lt]=r,i[It]=d,l){case"dialog":gn("cancel",i),gn("close",i);break;case"iframe":case"object":case"embed":gn("load",i);break;case"video":case"audio":for(l=0;l<cd.length;l++)gn(cd[l],i);break;case"source":gn("error",i);break;case"img":case"image":case"link":gn("error",i),gn("load",i);break;case"details":gn("toggle",i);break;case"input":gn("invalid",i),kn(i,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0);break;case"select":gn("invalid",i);break;case"textarea":gn("invalid",i),ci(i,d.value,d.defaultValue,d.children)}l=d.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||i.textContent===""+l||d.suppressHydrationWarning===!0||R_(i.textContent,l)?(d.popover!=null&&(gn("beforetoggle",i),gn("toggle",i)),d.onScroll!=null&&gn("scroll",i),d.onScrollEnd!=null&&gn("scrollend",i),d.onClick!=null&&(i.onclick=ls),i=!0):i=!1,i||Ya(r,!0)}function p1(r){for(hr=r.return;hr;)switch(hr.tag){case 5:case 31:case 13:pi=!1;return;case 27:case 3:pi=!0;return;default:hr=hr.return}}function uc(r){if(r!==hr)return!1;if(!En)return p1(r),En=!0,!1;var i=r.tag,l;if((l=i!==3&&i!==27)&&((l=i===5)&&(l=r.type,l=!(l!=="form"&&l!=="button")||hy(r.type,r.memoizedProps)),l=!l),l&&us&&Ya(r),p1(r),i===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(s(317));us=U_(r)}else if(i===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(s(317));us=U_(r)}else i===27?(i=us,uo(r.type)?(r=yy,yy=null,us=r):us=i):us=hr?yi(r.stateNode.nextSibling):null;return!0}function il(){us=hr=null,En=!1}function Qp(){var r=Qa;return r!==null&&(Fr===null?Fr=r:Fr.push.apply(Fr,r),Qa=null),r}function Fu(r){Qa===null?Qa=[r]:Qa.push(r)}var Yp=O(null),al=null,fa=null;function Xa(r,i,l){Ie(Yp,i._currentValue),i._currentValue=l}function ma(r){r._currentValue=Yp.current,ie(Yp)}function Xp(r,i,l){for(;r!==null;){var d=r.alternate;if((r.childLanes&i)!==i?(r.childLanes|=i,d!==null&&(d.childLanes|=i)):d!==null&&(d.childLanes&i)!==i&&(d.childLanes|=i),r===l)break;r=r.return}}function Jp(r,i,l,d){var p=r.child;for(p!==null&&(p.return=r);p!==null;){var y=p.dependencies;if(y!==null){var w=p.child;y=y.firstContext;e:for(;y!==null;){var j=y;y=p;for(var F=0;F<i.length;F++)if(j.context===i[F]){y.lanes|=l,j=y.alternate,j!==null&&(j.lanes|=l),Xp(y.return,l,r),d||(w=null);break e}y=j.next}}else if(p.tag===18){if(w=p.return,w===null)throw Error(s(341));w.lanes|=l,y=w.alternate,y!==null&&(y.lanes|=l),Xp(w,l,r),w=null}else w=p.child;if(w!==null)w.return=p;else for(w=p;w!==null;){if(w===r){w=null;break}if(p=w.sibling,p!==null){p.return=w.return,w=p;break}w=w.return}p=w}}function dc(r,i,l,d){r=null;for(var p=i,y=!1;p!==null;){if(!y){if((p.flags&524288)!==0)y=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var w=p.alternate;if(w===null)throw Error(s(387));if(w=w.memoizedProps,w!==null){var j=p.type;Qr(p.pendingProps.value,w.value)||(r!==null?r.push(j):r=[j])}}else if(p===vt.current){if(w=p.alternate,w===null)throw Error(s(387));w.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(r!==null?r.push(md):r=[md])}p=p.return}r!==null&&Jp(i,r,l,d),i.flags|=262144}function Gh(r){for(r=r.firstContext;r!==null;){if(!Qr(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function ol(r){al=r,fa=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function fr(r){return g1(al,r)}function Kh(r,i){return al===null&&ol(r),g1(r,i)}function g1(r,i){var l=i._currentValue;if(i={context:i,memoizedValue:l,next:null},fa===null){if(r===null)throw Error(s(308));fa=i,r.dependencies={lanes:0,firstContext:i},r.flags|=524288}else fa=fa.next=i;return l}var EN=typeof AbortController<"u"?AbortController:function(){var r=[],i=this.signal={aborted:!1,addEventListener:function(l,d){r.push(d)}};this.abort=function(){i.aborted=!0,r.forEach(function(l){return l()})}},SN=n.unstable_scheduleCallback,jN=n.unstable_NormalPriority,Fs={$$typeof:X,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Zp(){return{controller:new EN,data:new Map,refCount:0}}function zu(r){r.refCount--,r.refCount===0&&SN(jN,function(){r.controller.abort()})}var qu=null,eg=0,hc=0,fc=null;function NN(r,i){if(qu===null){var l=qu=[];eg=0,hc=sy(),fc={status:"pending",value:void 0,then:function(d){l.push(d)}}}return eg++,i.then(y1,y1),i}function y1(){if(--eg===0&&qu!==null){fc!==null&&(fc.status="fulfilled");var r=qu;qu=null,hc=0,fc=null;for(var i=0;i<r.length;i++)(0,r[i])()}}function CN(r,i){var l=[],d={status:"pending",value:null,reason:null,then:function(p){l.push(p)}};return r.then(function(){d.status="fulfilled",d.value=i;for(var p=0;p<l.length;p++)(0,l[p])(i)},function(p){for(d.status="rejected",d.reason=p,p=0;p<l.length;p++)(0,l[p])(void 0)}),d}var b1=$.S;$.S=function(r,i){t_=un(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&NN(r,i),b1!==null&&b1(r,i)};var ll=O(null);function tg(){var r=ll.current;return r!==null?r:ss.pooledCache}function Qh(r,i){i===null?Ie(ll,ll.current):Ie(ll,i.pool)}function v1(){var r=tg();return r===null?null:{parent:Fs._currentValue,pool:r}}var mc=Error(s(460)),ng=Error(s(474)),Yh=Error(s(542)),Xh={then:function(){}};function x1(r){return r=r.status,r==="fulfilled"||r==="rejected"}function _1(r,i,l){switch(l=r[l],l===void 0?r.push(i):l!==i&&(i.then(ls,ls),i=l),i.status){case"fulfilled":return i.value;case"rejected":throw r=i.reason,T1(r),r;default:if(typeof i.status=="string")i.then(ls,ls);else{if(r=ss,r!==null&&100<r.shellSuspendCounter)throw Error(s(482));r=i,r.status="pending",r.then(function(d){if(i.status==="pending"){var p=i;p.status="fulfilled",p.value=d}},function(d){if(i.status==="pending"){var p=i;p.status="rejected",p.reason=d}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw r=i.reason,T1(r),r}throw ul=i,mc}}function cl(r){try{var i=r._init;return i(r._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(ul=l,mc):l}}var ul=null;function w1(){if(ul===null)throw Error(s(459));var r=ul;return ul=null,r}function T1(r){if(r===mc||r===Yh)throw Error(s(483))}var pc=null,Hu=0;function Jh(r){var i=Hu;return Hu+=1,pc===null&&(pc=[]),_1(pc,r,i)}function $u(r,i){i=i.props.ref,r.ref=i!==void 0?i:null}function Zh(r,i){throw i.$$typeof===T?Error(s(525)):(r=Object.prototype.toString.call(i),Error(s(31,r==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":r)))}function k1(r){function i(J,G){if(r){var le=J.deletions;le===null?(J.deletions=[G],J.flags|=16):le.push(G)}}function l(J,G){if(!r)return null;for(;G!==null;)i(J,G),G=G.sibling;return null}function d(J){for(var G=new Map;J!==null;)J.key!==null?G.set(J.key,J):G.set(J.index,J),J=J.sibling;return G}function p(J,G){return J=da(J,G),J.index=0,J.sibling=null,J}function y(J,G,le){return J.index=le,r?(le=J.alternate,le!==null?(le=le.index,le<G?(J.flags|=67108866,G):le):(J.flags|=67108866,G)):(J.flags|=1048576,G)}function w(J){return r&&J.alternate===null&&(J.flags|=67108866),J}function j(J,G,le,Ae){return G===null||G.tag!==6?(G=Hp(le,J.mode,Ae),G.return=J,G):(G=p(G,le),G.return=J,G)}function F(J,G,le,Ae){var Rt=le.type;return Rt===P?Se(J,G,le.props.children,Ae,le.key):G!==null&&(G.elementType===Rt||typeof Rt=="object"&&Rt!==null&&Rt.$$typeof===S&&cl(Rt)===G.type)?(G=p(G,le.props),$u(G,le),G.return=J,G):(G=$h(le.type,le.key,le.props,null,J.mode,Ae),$u(G,le),G.return=J,G)}function ce(J,G,le,Ae){return G===null||G.tag!==4||G.stateNode.containerInfo!==le.containerInfo||G.stateNode.implementation!==le.implementation?(G=$p(le,J.mode,Ae),G.return=J,G):(G=p(G,le.children||[]),G.return=J,G)}function Se(J,G,le,Ae,Rt){return G===null||G.tag!==7?(G=rl(le,J.mode,Ae,Rt),G.return=J,G):(G=p(G,le),G.return=J,G)}function Pe(J,G,le){if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return G=Hp(""+G,J.mode,le),G.return=J,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case N:return le=$h(G.type,G.key,G.props,null,J.mode,le),$u(le,G),le.return=J,le;case B:return G=$p(G,J.mode,le),G.return=J,G;case S:return G=cl(G),Pe(J,G,le)}if(_t(G)||q(G))return G=rl(G,J.mode,le,null),G.return=J,G;if(typeof G.then=="function")return Pe(J,Jh(G),le);if(G.$$typeof===X)return Pe(J,Kh(J,G),le);Zh(J,G)}return null}function de(J,G,le,Ae){var Rt=G!==null?G.key:null;if(typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint")return Rt!==null?null:j(J,G,""+le,Ae);if(typeof le=="object"&&le!==null){switch(le.$$typeof){case N:return le.key===Rt?F(J,G,le,Ae):null;case B:return le.key===Rt?ce(J,G,le,Ae):null;case S:return le=cl(le),de(J,G,le,Ae)}if(_t(le)||q(le))return Rt!==null?null:Se(J,G,le,Ae,null);if(typeof le.then=="function")return de(J,G,Jh(le),Ae);if(le.$$typeof===X)return de(J,G,Kh(J,le),Ae);Zh(J,le)}return null}function ye(J,G,le,Ae,Rt){if(typeof Ae=="string"&&Ae!==""||typeof Ae=="number"||typeof Ae=="bigint")return J=J.get(le)||null,j(G,J,""+Ae,Rt);if(typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case N:return J=J.get(Ae.key===null?le:Ae.key)||null,F(G,J,Ae,Rt);case B:return J=J.get(Ae.key===null?le:Ae.key)||null,ce(G,J,Ae,Rt);case S:return Ae=cl(Ae),ye(J,G,le,Ae,Rt)}if(_t(Ae)||q(Ae))return J=J.get(le)||null,Se(G,J,Ae,Rt,null);if(typeof Ae.then=="function")return ye(J,G,le,Jh(Ae),Rt);if(Ae.$$typeof===X)return ye(J,G,le,Kh(G,Ae),Rt);Zh(G,Ae)}return null}function mt(J,G,le,Ae){for(var Rt=null,Vn=null,xt=G,ln=G=0,_n=null;xt!==null&&ln<le.length;ln++){xt.index>ln?(_n=xt,xt=null):_n=xt.sibling;var On=de(J,xt,le[ln],Ae);if(On===null){xt===null&&(xt=_n);break}r&&xt&&On.alternate===null&&i(J,xt),G=y(On,G,ln),Vn===null?Rt=On:Vn.sibling=On,Vn=On,xt=_n}if(ln===le.length)return l(J,xt),En&&ha(J,ln),Rt;if(xt===null){for(;ln<le.length;ln++)xt=Pe(J,le[ln],Ae),xt!==null&&(G=y(xt,G,ln),Vn===null?Rt=xt:Vn.sibling=xt,Vn=xt);return En&&ha(J,ln),Rt}for(xt=d(xt);ln<le.length;ln++)_n=ye(xt,J,ln,le[ln],Ae),_n!==null&&(r&&_n.alternate!==null&&xt.delete(_n.key===null?ln:_n.key),G=y(_n,G,ln),Vn===null?Rt=_n:Vn.sibling=_n,Vn=_n);return r&&xt.forEach(function(go){return i(J,go)}),En&&ha(J,ln),Rt}function Vt(J,G,le,Ae){if(le==null)throw Error(s(151));for(var Rt=null,Vn=null,xt=G,ln=G=0,_n=null,On=le.next();xt!==null&&!On.done;ln++,On=le.next()){xt.index>ln?(_n=xt,xt=null):_n=xt.sibling;var go=de(J,xt,On.value,Ae);if(go===null){xt===null&&(xt=_n);break}r&&xt&&go.alternate===null&&i(J,xt),G=y(go,G,ln),Vn===null?Rt=go:Vn.sibling=go,Vn=go,xt=_n}if(On.done)return l(J,xt),En&&ha(J,ln),Rt;if(xt===null){for(;!On.done;ln++,On=le.next())On=Pe(J,On.value,Ae),On!==null&&(G=y(On,G,ln),Vn===null?Rt=On:Vn.sibling=On,Vn=On);return En&&ha(J,ln),Rt}for(xt=d(xt);!On.done;ln++,On=le.next())On=ye(xt,J,ln,On.value,Ae),On!==null&&(r&&On.alternate!==null&&xt.delete(On.key===null?ln:On.key),G=y(On,G,ln),Vn===null?Rt=On:Vn.sibling=On,Vn=On);return r&&xt.forEach(function(UC){return i(J,UC)}),En&&ha(J,ln),Rt}function Zn(J,G,le,Ae){if(typeof le=="object"&&le!==null&&le.type===P&&le.key===null&&(le=le.props.children),typeof le=="object"&&le!==null){switch(le.$$typeof){case N:e:{for(var Rt=le.key;G!==null;){if(G.key===Rt){if(Rt=le.type,Rt===P){if(G.tag===7){l(J,G.sibling),Ae=p(G,le.props.children),Ae.return=J,J=Ae;break e}}else if(G.elementType===Rt||typeof Rt=="object"&&Rt!==null&&Rt.$$typeof===S&&cl(Rt)===G.type){l(J,G.sibling),Ae=p(G,le.props),$u(Ae,le),Ae.return=J,J=Ae;break e}l(J,G);break}else i(J,G);G=G.sibling}le.type===P?(Ae=rl(le.props.children,J.mode,Ae,le.key),Ae.return=J,J=Ae):(Ae=$h(le.type,le.key,le.props,null,J.mode,Ae),$u(Ae,le),Ae.return=J,J=Ae)}return w(J);case B:e:{for(Rt=le.key;G!==null;){if(G.key===Rt)if(G.tag===4&&G.stateNode.containerInfo===le.containerInfo&&G.stateNode.implementation===le.implementation){l(J,G.sibling),Ae=p(G,le.children||[]),Ae.return=J,J=Ae;break e}else{l(J,G);break}else i(J,G);G=G.sibling}Ae=$p(le,J.mode,Ae),Ae.return=J,J=Ae}return w(J);case S:return le=cl(le),Zn(J,G,le,Ae)}if(_t(le))return mt(J,G,le,Ae);if(q(le)){if(Rt=q(le),typeof Rt!="function")throw Error(s(150));return le=Rt.call(le),Vt(J,G,le,Ae)}if(typeof le.then=="function")return Zn(J,G,Jh(le),Ae);if(le.$$typeof===X)return Zn(J,G,Kh(J,le),Ae);Zh(J,le)}return typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint"?(le=""+le,G!==null&&G.tag===6?(l(J,G.sibling),Ae=p(G,le),Ae.return=J,J=Ae):(l(J,G),Ae=Hp(le,J.mode,Ae),Ae.return=J,J=Ae),w(J)):l(J,G)}return function(J,G,le,Ae){try{Hu=0;var Rt=Zn(J,G,le,Ae);return pc=null,Rt}catch(xt){if(xt===mc||xt===Yh)throw xt;var Vn=Yr(29,xt,null,J.mode);return Vn.lanes=Ae,Vn.return=J,Vn}}}var dl=k1(!0),E1=k1(!1),Ja=!1;function sg(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function rg(r,i){r=r.updateQueue,i.updateQueue===r&&(i.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function Za(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function eo(r,i,l){var d=r.updateQueue;if(d===null)return null;if(d=d.shared,(Fn&2)!==0){var p=d.pending;return p===null?i.next=i:(i.next=p.next,p.next=i),d.pending=i,i=Hh(r),l1(r,null,l),i}return qh(r,d,i,l),Hh(r)}function Wu(r,i,l){if(i=i.updateQueue,i!==null&&(i=i.shared,(l&4194048)!==0)){var d=i.lanes;d&=r.pendingLanes,l|=d,i.lanes=l,In(r,l)}}function ig(r,i){var l=r.updateQueue,d=r.alternate;if(d!==null&&(d=d.updateQueue,l===d)){var p=null,y=null;if(l=l.firstBaseUpdate,l!==null){do{var w={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};y===null?p=y=w:y=y.next=w,l=l.next}while(l!==null);y===null?p=y=i:y=y.next=i}else p=y=i;l={baseState:d.baseState,firstBaseUpdate:p,lastBaseUpdate:y,shared:d.shared,callbacks:d.callbacks},r.updateQueue=l;return}r=l.lastBaseUpdate,r===null?l.firstBaseUpdate=i:r.next=i,l.lastBaseUpdate=i}var ag=!1;function Gu(){if(ag){var r=fc;if(r!==null)throw r}}function Ku(r,i,l,d){ag=!1;var p=r.updateQueue;Ja=!1;var y=p.firstBaseUpdate,w=p.lastBaseUpdate,j=p.shared.pending;if(j!==null){p.shared.pending=null;var F=j,ce=F.next;F.next=null,w===null?y=ce:w.next=ce,w=F;var Se=r.alternate;Se!==null&&(Se=Se.updateQueue,j=Se.lastBaseUpdate,j!==w&&(j===null?Se.firstBaseUpdate=ce:j.next=ce,Se.lastBaseUpdate=F))}if(y!==null){var Pe=p.baseState;w=0,Se=ce=F=null,j=y;do{var de=j.lane&-536870913,ye=de!==j.lane;if(ye?(xn&de)===de:(d&de)===de){de!==0&&de===hc&&(ag=!0),Se!==null&&(Se=Se.next={lane:0,tag:j.tag,payload:j.payload,callback:null,next:null});e:{var mt=r,Vt=j;de=i;var Zn=l;switch(Vt.tag){case 1:if(mt=Vt.payload,typeof mt=="function"){Pe=mt.call(Zn,Pe,de);break e}Pe=mt;break e;case 3:mt.flags=mt.flags&-65537|128;case 0:if(mt=Vt.payload,de=typeof mt=="function"?mt.call(Zn,Pe,de):mt,de==null)break e;Pe=x({},Pe,de);break e;case 2:Ja=!0}}de=j.callback,de!==null&&(r.flags|=64,ye&&(r.flags|=8192),ye=p.callbacks,ye===null?p.callbacks=[de]:ye.push(de))}else ye={lane:de,tag:j.tag,payload:j.payload,callback:j.callback,next:null},Se===null?(ce=Se=ye,F=Pe):Se=Se.next=ye,w|=de;if(j=j.next,j===null){if(j=p.shared.pending,j===null)break;ye=j,j=ye.next,ye.next=null,p.lastBaseUpdate=ye,p.shared.pending=null}}while(!0);Se===null&&(F=Pe),p.baseState=F,p.firstBaseUpdate=ce,p.lastBaseUpdate=Se,y===null&&(p.shared.lanes=0),io|=w,r.lanes=w,r.memoizedState=Pe}}function S1(r,i){if(typeof r!="function")throw Error(s(191,r));r.call(i)}function j1(r,i){var l=r.callbacks;if(l!==null)for(r.callbacks=null,r=0;r<l.length;r++)S1(l[r],i)}var gc=O(null),ef=O(0);function N1(r,i){r=Ta,Ie(ef,r),Ie(gc,i),Ta=r|i.baseLanes}function og(){Ie(ef,Ta),Ie(gc,gc.current)}function lg(){Ta=ef.current,ie(gc),ie(ef)}var Xr=O(null),gi=null;function to(r){var i=r.alternate;Ie(Ms,Ms.current&1),Ie(Xr,r),gi===null&&(i===null||gc.current!==null||i.memoizedState!==null)&&(gi=r)}function cg(r){Ie(Ms,Ms.current),Ie(Xr,r),gi===null&&(gi=r)}function C1(r){r.tag===22?(Ie(Ms,Ms.current),Ie(Xr,r),gi===null&&(gi=r)):no()}function no(){Ie(Ms,Ms.current),Ie(Xr,Xr.current)}function Jr(r){ie(Xr),gi===r&&(gi=null),ie(Ms)}var Ms=O(0);function tf(r){for(var i=r;i!==null;){if(i.tag===13){var l=i.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||py(l)||gy(l)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var pa=0,rn=null,Xn=null,zs=null,nf=!1,yc=!1,hl=!1,sf=0,Qu=0,bc=null,AN=0;function Ns(){throw Error(s(321))}function ug(r,i){if(i===null)return!1;for(var l=0;l<i.length&&l<r.length;l++)if(!Qr(r[l],i[l]))return!1;return!0}function dg(r,i,l,d,p,y){return pa=y,rn=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,$.H=r===null||r.memoizedState===null?hx:Sg,hl=!1,y=l(d,p),hl=!1,yc&&(y=R1(i,l,d,p)),A1(r),y}function A1(r){$.H=Ju;var i=Xn!==null&&Xn.next!==null;if(pa=0,zs=Xn=rn=null,nf=!1,Qu=0,bc=null,i)throw Error(s(300));r===null||qs||(r=r.dependencies,r!==null&&Gh(r)&&(qs=!0))}function R1(r,i,l,d){rn=r;var p=0;do{if(yc&&(bc=null),Qu=0,yc=!1,25<=p)throw Error(s(301));if(p+=1,zs=Xn=null,r.updateQueue!=null){var y=r.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}$.H=fx,y=i(l,d)}while(yc);return y}function RN(){var r=$.H,i=r.useState()[0];return i=typeof i.then=="function"?Yu(i):i,r=r.useState()[0],(Xn!==null?Xn.memoizedState:null)!==r&&(rn.flags|=1024),i}function hg(){var r=sf!==0;return sf=0,r}function fg(r,i,l){i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~l}function mg(r){if(nf){for(r=r.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}nf=!1}pa=0,zs=Xn=rn=null,yc=!1,Qu=sf=0,bc=null}function Cr(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zs===null?rn.memoizedState=zs=r:zs=zs.next=r,zs}function Ls(){if(Xn===null){var r=rn.alternate;r=r!==null?r.memoizedState:null}else r=Xn.next;var i=zs===null?rn.memoizedState:zs.next;if(i!==null)zs=i,Xn=r;else{if(r===null)throw rn.alternate===null?Error(s(467)):Error(s(310));Xn=r,r={memoizedState:Xn.memoizedState,baseState:Xn.baseState,baseQueue:Xn.baseQueue,queue:Xn.queue,next:null},zs===null?rn.memoizedState=zs=r:zs=zs.next=r}return zs}function rf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Yu(r){var i=Qu;return Qu+=1,bc===null&&(bc=[]),r=_1(bc,r,i),i=rn,(zs===null?i.memoizedState:zs.next)===null&&(i=i.alternate,$.H=i===null||i.memoizedState===null?hx:Sg),r}function af(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return Yu(r);if(r.$$typeof===X)return fr(r)}throw Error(s(438,String(r)))}function pg(r){var i=null,l=rn.updateQueue;if(l!==null&&(i=l.memoCache),i==null){var d=rn.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(i={data:d.data.map(function(p){return p.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),l===null&&(l=rf(),rn.updateQueue=l),l.memoCache=i,l=i.data[i.index],l===void 0)for(l=i.data[i.index]=Array(r),d=0;d<r;d++)l[d]=U;return i.index++,l}function ga(r,i){return typeof i=="function"?i(r):i}function of(r){var i=Ls();return gg(i,Xn,r)}function gg(r,i,l){var d=r.queue;if(d===null)throw Error(s(311));d.lastRenderedReducer=l;var p=r.baseQueue,y=d.pending;if(y!==null){if(p!==null){var w=p.next;p.next=y.next,y.next=w}i.baseQueue=p=y,d.pending=null}if(y=r.baseState,p===null)r.memoizedState=y;else{i=p.next;var j=w=null,F=null,ce=i,Se=!1;do{var Pe=ce.lane&-536870913;if(Pe!==ce.lane?(xn&Pe)===Pe:(pa&Pe)===Pe){var de=ce.revertLane;if(de===0)F!==null&&(F=F.next={lane:0,revertLane:0,gesture:null,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null}),Pe===hc&&(Se=!0);else if((pa&de)===de){ce=ce.next,de===hc&&(Se=!0);continue}else Pe={lane:0,revertLane:ce.revertLane,gesture:null,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null},F===null?(j=F=Pe,w=y):F=F.next=Pe,rn.lanes|=de,io|=de;Pe=ce.action,hl&&l(y,Pe),y=ce.hasEagerState?ce.eagerState:l(y,Pe)}else de={lane:Pe,revertLane:ce.revertLane,gesture:ce.gesture,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null},F===null?(j=F=de,w=y):F=F.next=de,rn.lanes|=Pe,io|=Pe;ce=ce.next}while(ce!==null&&ce!==i);if(F===null?w=y:F.next=j,!Qr(y,r.memoizedState)&&(qs=!0,Se&&(l=fc,l!==null)))throw l;r.memoizedState=y,r.baseState=w,r.baseQueue=F,d.lastRenderedState=y}return p===null&&(d.lanes=0),[r.memoizedState,d.dispatch]}function yg(r){var i=Ls(),l=i.queue;if(l===null)throw Error(s(311));l.lastRenderedReducer=r;var d=l.dispatch,p=l.pending,y=i.memoizedState;if(p!==null){l.pending=null;var w=p=p.next;do y=r(y,w.action),w=w.next;while(w!==p);Qr(y,i.memoizedState)||(qs=!0),i.memoizedState=y,i.baseQueue===null&&(i.baseState=y),l.lastRenderedState=y}return[y,d]}function I1(r,i,l){var d=rn,p=Ls(),y=En;if(y){if(l===void 0)throw Error(s(407));l=l()}else l=i();var w=!Qr((Xn||p).memoizedState,l);if(w&&(p.memoizedState=l,qs=!0),p=p.queue,xg(M1.bind(null,d,p,r),[r]),p.getSnapshot!==i||w||zs!==null&&zs.memoizedState.tag&1){if(d.flags|=2048,vc(9,{destroy:void 0},P1.bind(null,d,p,l,i),null),ss===null)throw Error(s(349));y||(pa&127)!==0||D1(d,i,l)}return l}function D1(r,i,l){r.flags|=16384,r={getSnapshot:i,value:l},i=rn.updateQueue,i===null?(i=rf(),rn.updateQueue=i,i.stores=[r]):(l=i.stores,l===null?i.stores=[r]:l.push(r))}function P1(r,i,l,d){i.value=l,i.getSnapshot=d,L1(i)&&V1(r)}function M1(r,i,l){return l(function(){L1(i)&&V1(r)})}function L1(r){var i=r.getSnapshot;r=r.value;try{var l=i();return!Qr(r,l)}catch{return!0}}function V1(r){var i=sl(r,2);i!==null&&zr(i,r,2)}function bg(r){var i=Cr();if(typeof r=="function"){var l=r;if(r=l(),hl){Me(!0);try{l()}finally{Me(!1)}}}return i.memoizedState=i.baseState=r,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ga,lastRenderedState:r},i}function O1(r,i,l,d){return r.baseState=l,gg(r,Xn,typeof d=="function"?d:ga)}function IN(r,i,l,d,p){if(uf(r))throw Error(s(485));if(r=i.action,r!==null){var y={payload:p,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){y.listeners.push(w)}};$.T!==null?l(!0):y.isTransition=!1,d(y),l=i.pending,l===null?(y.next=i.pending=y,B1(i,y)):(y.next=l.next,i.pending=l.next=y)}}function B1(r,i){var l=i.action,d=i.payload,p=r.state;if(i.isTransition){var y=$.T,w={};$.T=w;try{var j=l(p,d),F=$.S;F!==null&&F(w,j),U1(r,i,j)}catch(ce){vg(r,i,ce)}finally{y!==null&&w.types!==null&&(y.types=w.types),$.T=y}}else try{y=l(p,d),U1(r,i,y)}catch(ce){vg(r,i,ce)}}function U1(r,i,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(d){F1(r,i,d)},function(d){return vg(r,i,d)}):F1(r,i,l)}function F1(r,i,l){i.status="fulfilled",i.value=l,z1(i),r.state=l,i=r.pending,i!==null&&(l=i.next,l===i?r.pending=null:(l=l.next,i.next=l,B1(r,l)))}function vg(r,i,l){var d=r.pending;if(r.pending=null,d!==null){d=d.next;do i.status="rejected",i.reason=l,z1(i),i=i.next;while(i!==d)}r.action=null}function z1(r){r=r.listeners;for(var i=0;i<r.length;i++)(0,r[i])()}function q1(r,i){return i}function H1(r,i){if(En){var l=ss.formState;if(l!==null){e:{var d=rn;if(En){if(us){t:{for(var p=us,y=pi;p.nodeType!==8;){if(!y){p=null;break t}if(p=yi(p.nextSibling),p===null){p=null;break t}}y=p.data,p=y==="F!"||y==="F"?p:null}if(p){us=yi(p.nextSibling),d=p.data==="F!";break e}}Ya(d)}d=!1}d&&(i=l[0])}}return l=Cr(),l.memoizedState=l.baseState=i,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:q1,lastRenderedState:i},l.queue=d,l=cx.bind(null,rn,d),d.dispatch=l,d=bg(!1),y=Eg.bind(null,rn,!1,d.queue),d=Cr(),p={state:i,dispatch:null,action:r,pending:null},d.queue=p,l=IN.bind(null,rn,p,y,l),p.dispatch=l,d.memoizedState=r,[i,l,!1]}function $1(r){var i=Ls();return W1(i,Xn,r)}function W1(r,i,l){if(i=gg(r,i,q1)[0],r=of(ga)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var d=Yu(i)}catch(w){throw w===mc?Yh:w}else d=i;i=Ls();var p=i.queue,y=p.dispatch;return l!==i.memoizedState&&(rn.flags|=2048,vc(9,{destroy:void 0},DN.bind(null,p,l),null)),[d,y,r]}function DN(r,i){r.action=i}function G1(r){var i=Ls(),l=Xn;if(l!==null)return W1(i,l,r);Ls(),i=i.memoizedState,l=Ls();var d=l.queue.dispatch;return l.memoizedState=r,[i,d,!1]}function vc(r,i,l,d){return r={tag:r,create:l,deps:d,inst:i,next:null},i=rn.updateQueue,i===null&&(i=rf(),rn.updateQueue=i),l=i.lastEffect,l===null?i.lastEffect=r.next=r:(d=l.next,l.next=r,r.next=d,i.lastEffect=r),r}function K1(){return Ls().memoizedState}function lf(r,i,l,d){var p=Cr();rn.flags|=r,p.memoizedState=vc(1|i,{destroy:void 0},l,d===void 0?null:d)}function cf(r,i,l,d){var p=Ls();d=d===void 0?null:d;var y=p.memoizedState.inst;Xn!==null&&d!==null&&ug(d,Xn.memoizedState.deps)?p.memoizedState=vc(i,y,l,d):(rn.flags|=r,p.memoizedState=vc(1|i,y,l,d))}function Q1(r,i){lf(8390656,8,r,i)}function xg(r,i){cf(2048,8,r,i)}function PN(r){rn.flags|=4;var i=rn.updateQueue;if(i===null)i=rf(),rn.updateQueue=i,i.events=[r];else{var l=i.events;l===null?i.events=[r]:l.push(r)}}function Y1(r){var i=Ls().memoizedState;return PN({ref:i,nextImpl:r}),function(){if((Fn&2)!==0)throw Error(s(440));return i.impl.apply(void 0,arguments)}}function X1(r,i){return cf(4,2,r,i)}function J1(r,i){return cf(4,4,r,i)}function Z1(r,i){if(typeof i=="function"){r=r();var l=i(r);return function(){typeof l=="function"?l():i(null)}}if(i!=null)return r=r(),i.current=r,function(){i.current=null}}function ex(r,i,l){l=l!=null?l.concat([r]):null,cf(4,4,Z1.bind(null,i,r),l)}function _g(){}function tx(r,i){var l=Ls();i=i===void 0?null:i;var d=l.memoizedState;return i!==null&&ug(i,d[1])?d[0]:(l.memoizedState=[r,i],r)}function nx(r,i){var l=Ls();i=i===void 0?null:i;var d=l.memoizedState;if(i!==null&&ug(i,d[1]))return d[0];if(d=r(),hl){Me(!0);try{r()}finally{Me(!1)}}return l.memoizedState=[d,i],d}function wg(r,i,l){return l===void 0||(pa&1073741824)!==0&&(xn&261930)===0?r.memoizedState=i:(r.memoizedState=l,r=s_(),rn.lanes|=r,io|=r,l)}function sx(r,i,l,d){return Qr(l,i)?l:gc.current!==null?(r=wg(r,l,d),Qr(r,i)||(qs=!0),r):(pa&42)===0||(pa&1073741824)!==0&&(xn&261930)===0?(qs=!0,r.memoizedState=l):(r=s_(),rn.lanes|=r,io|=r,i)}function rx(r,i,l,d,p){var y=ge.p;ge.p=y!==0&&8>y?y:8;var w=$.T,j={};$.T=j,Eg(r,!1,i,l);try{var F=p(),ce=$.S;if(ce!==null&&ce(j,F),F!==null&&typeof F=="object"&&typeof F.then=="function"){var Se=CN(F,d);Xu(r,i,Se,ti(r))}else Xu(r,i,d,ti(r))}catch(Pe){Xu(r,i,{then:function(){},status:"rejected",reason:Pe},ti())}finally{ge.p=y,w!==null&&j.types!==null&&(w.types=j.types),$.T=w}}function MN(){}function Tg(r,i,l,d){if(r.tag!==5)throw Error(s(476));var p=ix(r).queue;rx(r,p,i,Le,l===null?MN:function(){return ax(r),l(d)})}function ix(r){var i=r.memoizedState;if(i!==null)return i;i={memoizedState:Le,baseState:Le,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ga,lastRenderedState:Le},next:null};var l={};return i.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ga,lastRenderedState:l},next:null},r.memoizedState=i,r=r.alternate,r!==null&&(r.memoizedState=i),i}function ax(r){var i=ix(r);i.next===null&&(i=r.alternate.memoizedState),Xu(r,i.next.queue,{},ti())}function kg(){return fr(md)}function ox(){return Ls().memoizedState}function lx(){return Ls().memoizedState}function LN(r){for(var i=r.return;i!==null;){switch(i.tag){case 24:case 3:var l=ti();r=Za(l);var d=eo(i,r,l);d!==null&&(zr(d,i,l),Wu(d,i,l)),i={cache:Zp()},r.payload=i;return}i=i.return}}function VN(r,i,l){var d=ti();l={lane:d,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},uf(r)?ux(i,l):(l=zp(r,i,l,d),l!==null&&(zr(l,r,d),dx(l,i,d)))}function cx(r,i,l){var d=ti();Xu(r,i,l,d)}function Xu(r,i,l,d){var p={lane:d,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(uf(r))ux(i,p);else{var y=r.alternate;if(r.lanes===0&&(y===null||y.lanes===0)&&(y=i.lastRenderedReducer,y!==null))try{var w=i.lastRenderedState,j=y(w,l);if(p.hasEagerState=!0,p.eagerState=j,Qr(j,w))return qh(r,i,p,0),ss===null&&zh(),!1}catch{}if(l=zp(r,i,p,d),l!==null)return zr(l,r,d),dx(l,i,d),!0}return!1}function Eg(r,i,l,d){if(d={lane:2,revertLane:sy(),gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null},uf(r)){if(i)throw Error(s(479))}else i=zp(r,l,d,2),i!==null&&zr(i,r,2)}function uf(r){var i=r.alternate;return r===rn||i!==null&&i===rn}function ux(r,i){yc=nf=!0;var l=r.pending;l===null?i.next=i:(i.next=l.next,l.next=i),r.pending=i}function dx(r,i,l){if((l&4194048)!==0){var d=i.lanes;d&=r.pendingLanes,l|=d,i.lanes=l,In(r,l)}}var Ju={readContext:fr,use:af,useCallback:Ns,useContext:Ns,useEffect:Ns,useImperativeHandle:Ns,useLayoutEffect:Ns,useInsertionEffect:Ns,useMemo:Ns,useReducer:Ns,useRef:Ns,useState:Ns,useDebugValue:Ns,useDeferredValue:Ns,useTransition:Ns,useSyncExternalStore:Ns,useId:Ns,useHostTransitionStatus:Ns,useFormState:Ns,useActionState:Ns,useOptimistic:Ns,useMemoCache:Ns,useCacheRefresh:Ns};Ju.useEffectEvent=Ns;var hx={readContext:fr,use:af,useCallback:function(r,i){return Cr().memoizedState=[r,i===void 0?null:i],r},useContext:fr,useEffect:Q1,useImperativeHandle:function(r,i,l){l=l!=null?l.concat([r]):null,lf(4194308,4,Z1.bind(null,i,r),l)},useLayoutEffect:function(r,i){return lf(4194308,4,r,i)},useInsertionEffect:function(r,i){lf(4,2,r,i)},useMemo:function(r,i){var l=Cr();i=i===void 0?null:i;var d=r();if(hl){Me(!0);try{r()}finally{Me(!1)}}return l.memoizedState=[d,i],d},useReducer:function(r,i,l){var d=Cr();if(l!==void 0){var p=l(i);if(hl){Me(!0);try{l(i)}finally{Me(!1)}}}else p=i;return d.memoizedState=d.baseState=p,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:p},d.queue=r,r=r.dispatch=VN.bind(null,rn,r),[d.memoizedState,r]},useRef:function(r){var i=Cr();return r={current:r},i.memoizedState=r},useState:function(r){r=bg(r);var i=r.queue,l=cx.bind(null,rn,i);return i.dispatch=l,[r.memoizedState,l]},useDebugValue:_g,useDeferredValue:function(r,i){var l=Cr();return wg(l,r,i)},useTransition:function(){var r=bg(!1);return r=rx.bind(null,rn,r.queue,!0,!1),Cr().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,i,l){var d=rn,p=Cr();if(En){if(l===void 0)throw Error(s(407));l=l()}else{if(l=i(),ss===null)throw Error(s(349));(xn&127)!==0||D1(d,i,l)}p.memoizedState=l;var y={value:l,getSnapshot:i};return p.queue=y,Q1(M1.bind(null,d,y,r),[r]),d.flags|=2048,vc(9,{destroy:void 0},P1.bind(null,d,y,l,i),null),l},useId:function(){var r=Cr(),i=ss.identifierPrefix;if(En){var l=$i,d=Hi;l=(d&~(1<<32-qe(d)-1)).toString(32)+l,i="_"+i+"R_"+l,l=sf++,0<l&&(i+="H"+l.toString(32)),i+="_"}else l=AN++,i="_"+i+"r_"+l.toString(32)+"_";return r.memoizedState=i},useHostTransitionStatus:kg,useFormState:H1,useActionState:H1,useOptimistic:function(r){var i=Cr();i.memoizedState=i.baseState=r;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=l,i=Eg.bind(null,rn,!0,l),l.dispatch=i,[r,i]},useMemoCache:pg,useCacheRefresh:function(){return Cr().memoizedState=LN.bind(null,rn)},useEffectEvent:function(r){var i=Cr(),l={impl:r};return i.memoizedState=l,function(){if((Fn&2)!==0)throw Error(s(440));return l.impl.apply(void 0,arguments)}}},Sg={readContext:fr,use:af,useCallback:tx,useContext:fr,useEffect:xg,useImperativeHandle:ex,useInsertionEffect:X1,useLayoutEffect:J1,useMemo:nx,useReducer:of,useRef:K1,useState:function(){return of(ga)},useDebugValue:_g,useDeferredValue:function(r,i){var l=Ls();return sx(l,Xn.memoizedState,r,i)},useTransition:function(){var r=of(ga)[0],i=Ls().memoizedState;return[typeof r=="boolean"?r:Yu(r),i]},useSyncExternalStore:I1,useId:ox,useHostTransitionStatus:kg,useFormState:$1,useActionState:$1,useOptimistic:function(r,i){var l=Ls();return O1(l,Xn,r,i)},useMemoCache:pg,useCacheRefresh:lx};Sg.useEffectEvent=Y1;var fx={readContext:fr,use:af,useCallback:tx,useContext:fr,useEffect:xg,useImperativeHandle:ex,useInsertionEffect:X1,useLayoutEffect:J1,useMemo:nx,useReducer:yg,useRef:K1,useState:function(){return yg(ga)},useDebugValue:_g,useDeferredValue:function(r,i){var l=Ls();return Xn===null?wg(l,r,i):sx(l,Xn.memoizedState,r,i)},useTransition:function(){var r=yg(ga)[0],i=Ls().memoizedState;return[typeof r=="boolean"?r:Yu(r),i]},useSyncExternalStore:I1,useId:ox,useHostTransitionStatus:kg,useFormState:G1,useActionState:G1,useOptimistic:function(r,i){var l=Ls();return Xn!==null?O1(l,Xn,r,i):(l.baseState=r,[r,l.queue.dispatch])},useMemoCache:pg,useCacheRefresh:lx};fx.useEffectEvent=Y1;function jg(r,i,l,d){i=r.memoizedState,l=l(d,i),l=l==null?i:x({},i,l),r.memoizedState=l,r.lanes===0&&(r.updateQueue.baseState=l)}var Ng={enqueueSetState:function(r,i,l){r=r._reactInternals;var d=ti(),p=Za(d);p.payload=i,l!=null&&(p.callback=l),i=eo(r,p,d),i!==null&&(zr(i,r,d),Wu(i,r,d))},enqueueReplaceState:function(r,i,l){r=r._reactInternals;var d=ti(),p=Za(d);p.tag=1,p.payload=i,l!=null&&(p.callback=l),i=eo(r,p,d),i!==null&&(zr(i,r,d),Wu(i,r,d))},enqueueForceUpdate:function(r,i){r=r._reactInternals;var l=ti(),d=Za(l);d.tag=2,i!=null&&(d.callback=i),i=eo(r,d,l),i!==null&&(zr(i,r,l),Wu(i,r,l))}};function mx(r,i,l,d,p,y,w){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(d,y,w):i.prototype&&i.prototype.isPureReactComponent?!Ou(l,d)||!Ou(p,y):!0}function px(r,i,l,d){r=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(l,d),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(l,d),i.state!==r&&Ng.enqueueReplaceState(i,i.state,null)}function fl(r,i){var l=i;if("ref"in i){l={};for(var d in i)d!=="ref"&&(l[d]=i[d])}if(r=r.defaultProps){l===i&&(l=x({},l));for(var p in r)l[p]===void 0&&(l[p]=r[p])}return l}function gx(r){Fh(r)}function yx(r){console.error(r)}function bx(r){Fh(r)}function df(r,i){try{var l=r.onUncaughtError;l(i.value,{componentStack:i.stack})}catch(d){setTimeout(function(){throw d})}}function vx(r,i,l){try{var d=r.onCaughtError;d(l.value,{componentStack:l.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function Cg(r,i,l){return l=Za(l),l.tag=3,l.payload={element:null},l.callback=function(){df(r,i)},l}function xx(r){return r=Za(r),r.tag=3,r}function _x(r,i,l,d){var p=l.type.getDerivedStateFromError;if(typeof p=="function"){var y=d.value;r.payload=function(){return p(y)},r.callback=function(){vx(i,l,d)}}var w=l.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(r.callback=function(){vx(i,l,d),typeof p!="function"&&(ao===null?ao=new Set([this]):ao.add(this));var j=d.stack;this.componentDidCatch(d.value,{componentStack:j!==null?j:""})})}function ON(r,i,l,d,p){if(l.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(i=l.alternate,i!==null&&dc(i,l,p,!0),l=Xr.current,l!==null){switch(l.tag){case 31:case 13:return gi===null?Tf():l.alternate===null&&Cs===0&&(Cs=3),l.flags&=-257,l.flags|=65536,l.lanes=p,d===Xh?l.flags|=16384:(i=l.updateQueue,i===null?l.updateQueue=new Set([d]):i.add(d),ey(r,d,p)),!1;case 22:return l.flags|=65536,d===Xh?l.flags|=16384:(i=l.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([d])},l.updateQueue=i):(l=i.retryQueue,l===null?i.retryQueue=new Set([d]):l.add(d)),ey(r,d,p)),!1}throw Error(s(435,l.tag))}return ey(r,d,p),Tf(),!1}if(En)return i=Xr.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=p,d!==Kp&&(r=Error(s(422),{cause:d}),Fu(hi(r,l)))):(d!==Kp&&(i=Error(s(423),{cause:d}),Fu(hi(i,l))),r=r.current.alternate,r.flags|=65536,p&=-p,r.lanes|=p,d=hi(d,l),p=Cg(r.stateNode,d,p),ig(r,p),Cs!==4&&(Cs=2)),!1;var y=Error(s(520),{cause:d});if(y=hi(y,l),ad===null?ad=[y]:ad.push(y),Cs!==4&&(Cs=2),i===null)return!0;d=hi(d,l),l=i;do{switch(l.tag){case 3:return l.flags|=65536,r=p&-p,l.lanes|=r,r=Cg(l.stateNode,d,r),ig(l,r),!1;case 1:if(i=l.type,y=l.stateNode,(l.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(ao===null||!ao.has(y))))return l.flags|=65536,p&=-p,l.lanes|=p,p=xx(p),_x(p,r,l,d),ig(l,p),!1}l=l.return}while(l!==null);return!1}var Ag=Error(s(461)),qs=!1;function mr(r,i,l,d){i.child=r===null?E1(i,null,l,d):dl(i,r.child,l,d)}function wx(r,i,l,d,p){l=l.render;var y=i.ref;if("ref"in d){var w={};for(var j in d)j!=="ref"&&(w[j]=d[j])}else w=d;return ol(i),d=dg(r,i,l,w,y,p),j=hg(),r!==null&&!qs?(fg(r,i,p),ya(r,i,p)):(En&&j&&Wp(i),i.flags|=1,mr(r,i,d,p),i.child)}function Tx(r,i,l,d,p){if(r===null){var y=l.type;return typeof y=="function"&&!qp(y)&&y.defaultProps===void 0&&l.compare===null?(i.tag=15,i.type=y,kx(r,i,y,d,p)):(r=$h(l.type,null,d,i,i.mode,p),r.ref=i.ref,r.return=i,i.child=r)}if(y=r.child,!Og(r,p)){var w=y.memoizedProps;if(l=l.compare,l=l!==null?l:Ou,l(w,d)&&r.ref===i.ref)return ya(r,i,p)}return i.flags|=1,r=da(y,d),r.ref=i.ref,r.return=i,i.child=r}function kx(r,i,l,d,p){if(r!==null){var y=r.memoizedProps;if(Ou(y,d)&&r.ref===i.ref)if(qs=!1,i.pendingProps=d=y,Og(r,p))(r.flags&131072)!==0&&(qs=!0);else return i.lanes=r.lanes,ya(r,i,p)}return Rg(r,i,l,d,p)}function Ex(r,i,l,d){var p=d.children,y=r!==null?r.memoizedState:null;if(r===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),d.mode==="hidden"){if((i.flags&128)!==0){if(y=y!==null?y.baseLanes|l:l,r!==null){for(d=i.child=r.child,p=0;d!==null;)p=p|d.lanes|d.childLanes,d=d.sibling;d=p&~y}else d=0,i.child=null;return Sx(r,i,y,l,d)}if((l&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},r!==null&&Qh(i,y!==null?y.cachePool:null),y!==null?N1(i,y):og(),C1(i);else return d=i.lanes=536870912,Sx(r,i,y!==null?y.baseLanes|l:l,l,d)}else y!==null?(Qh(i,y.cachePool),N1(i,y),no(),i.memoizedState=null):(r!==null&&Qh(i,null),og(),no());return mr(r,i,p,l),i.child}function Zu(r,i){return r!==null&&r.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function Sx(r,i,l,d,p){var y=tg();return y=y===null?null:{parent:Fs._currentValue,pool:y},i.memoizedState={baseLanes:l,cachePool:y},r!==null&&Qh(i,null),og(),C1(i),r!==null&&dc(r,i,d,!0),i.childLanes=p,null}function hf(r,i){return i=mf({mode:i.mode,children:i.children},r.mode),i.ref=r.ref,r.child=i,i.return=r,i}function jx(r,i,l){return dl(i,r.child,null,l),r=hf(i,i.pendingProps),r.flags|=2,Jr(i),i.memoizedState=null,r}function BN(r,i,l){var d=i.pendingProps,p=(i.flags&128)!==0;if(i.flags&=-129,r===null){if(En){if(d.mode==="hidden")return r=hf(i,d),i.lanes=536870912,Zu(null,r);if(cg(i),(r=us)?(r=B_(r,pi),r=r!==null&&r.data==="&"?r:null,r!==null&&(i.memoizedState={dehydrated:r,treeContext:Ka!==null?{id:Hi,overflow:$i}:null,retryLane:536870912,hydrationErrors:null},l=u1(r),l.return=i,i.child=l,hr=i,us=null)):r=null,r===null)throw Ya(i);return i.lanes=536870912,null}return hf(i,d)}var y=r.memoizedState;if(y!==null){var w=y.dehydrated;if(cg(i),p)if(i.flags&256)i.flags&=-257,i=jx(r,i,l);else if(i.memoizedState!==null)i.child=r.child,i.flags|=128,i=null;else throw Error(s(558));else if(qs||dc(r,i,l,!1),p=(l&r.childLanes)!==0,qs||p){if(d=ss,d!==null&&(w=Bn(d,l),w!==0&&w!==y.retryLane))throw y.retryLane=w,sl(r,w),zr(d,r,w),Ag;Tf(),i=jx(r,i,l)}else r=y.treeContext,us=yi(w.nextSibling),hr=i,En=!0,Qa=null,pi=!1,r!==null&&f1(i,r),i=hf(i,d),i.flags|=4096;return i}return r=da(r.child,{mode:d.mode,children:d.children}),r.ref=i.ref,i.child=r,r.return=i,r}function ff(r,i){var l=i.ref;if(l===null)r!==null&&r.ref!==null&&(i.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(s(284));(r===null||r.ref!==l)&&(i.flags|=4194816)}}function Rg(r,i,l,d,p){return ol(i),l=dg(r,i,l,d,void 0,p),d=hg(),r!==null&&!qs?(fg(r,i,p),ya(r,i,p)):(En&&d&&Wp(i),i.flags|=1,mr(r,i,l,p),i.child)}function Nx(r,i,l,d,p,y){return ol(i),i.updateQueue=null,l=R1(i,d,l,p),A1(r),d=hg(),r!==null&&!qs?(fg(r,i,y),ya(r,i,y)):(En&&d&&Wp(i),i.flags|=1,mr(r,i,l,y),i.child)}function Cx(r,i,l,d,p){if(ol(i),i.stateNode===null){var y=oc,w=l.contextType;typeof w=="object"&&w!==null&&(y=fr(w)),y=new l(d,y),i.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=Ng,i.stateNode=y,y._reactInternals=i,y=i.stateNode,y.props=d,y.state=i.memoizedState,y.refs={},sg(i),w=l.contextType,y.context=typeof w=="object"&&w!==null?fr(w):oc,y.state=i.memoizedState,w=l.getDerivedStateFromProps,typeof w=="function"&&(jg(i,l,w,d),y.state=i.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(w=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),w!==y.state&&Ng.enqueueReplaceState(y,y.state,null),Ku(i,d,y,p),Gu(),y.state=i.memoizedState),typeof y.componentDidMount=="function"&&(i.flags|=4194308),d=!0}else if(r===null){y=i.stateNode;var j=i.memoizedProps,F=fl(l,j);y.props=F;var ce=y.context,Se=l.contextType;w=oc,typeof Se=="object"&&Se!==null&&(w=fr(Se));var Pe=l.getDerivedStateFromProps;Se=typeof Pe=="function"||typeof y.getSnapshotBeforeUpdate=="function",j=i.pendingProps!==j,Se||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(j||ce!==w)&&px(i,y,d,w),Ja=!1;var de=i.memoizedState;y.state=de,Ku(i,d,y,p),Gu(),ce=i.memoizedState,j||de!==ce||Ja?(typeof Pe=="function"&&(jg(i,l,Pe,d),ce=i.memoizedState),(F=Ja||mx(i,l,F,d,de,ce,w))?(Se||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(i.flags|=4194308)):(typeof y.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=d,i.memoizedState=ce),y.props=d,y.state=ce,y.context=w,d=F):(typeof y.componentDidMount=="function"&&(i.flags|=4194308),d=!1)}else{y=i.stateNode,rg(r,i),w=i.memoizedProps,Se=fl(l,w),y.props=Se,Pe=i.pendingProps,de=y.context,ce=l.contextType,F=oc,typeof ce=="object"&&ce!==null&&(F=fr(ce)),j=l.getDerivedStateFromProps,(ce=typeof j=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(w!==Pe||de!==F)&&px(i,y,d,F),Ja=!1,de=i.memoizedState,y.state=de,Ku(i,d,y,p),Gu();var ye=i.memoizedState;w!==Pe||de!==ye||Ja||r!==null&&r.dependencies!==null&&Gh(r.dependencies)?(typeof j=="function"&&(jg(i,l,j,d),ye=i.memoizedState),(Se=Ja||mx(i,l,Se,d,de,ye,F)||r!==null&&r.dependencies!==null&&Gh(r.dependencies))?(ce||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(d,ye,F),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(d,ye,F)),typeof y.componentDidUpdate=="function"&&(i.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof y.componentDidUpdate!="function"||w===r.memoizedProps&&de===r.memoizedState||(i.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||w===r.memoizedProps&&de===r.memoizedState||(i.flags|=1024),i.memoizedProps=d,i.memoizedState=ye),y.props=d,y.state=ye,y.context=F,d=Se):(typeof y.componentDidUpdate!="function"||w===r.memoizedProps&&de===r.memoizedState||(i.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||w===r.memoizedProps&&de===r.memoizedState||(i.flags|=1024),d=!1)}return y=d,ff(r,i),d=(i.flags&128)!==0,y||d?(y=i.stateNode,l=d&&typeof l.getDerivedStateFromError!="function"?null:y.render(),i.flags|=1,r!==null&&d?(i.child=dl(i,r.child,null,p),i.child=dl(i,null,l,p)):mr(r,i,l,p),i.memoizedState=y.state,r=i.child):r=ya(r,i,p),r}function Ax(r,i,l,d){return il(),i.flags|=256,mr(r,i,l,d),i.child}var Ig={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Dg(r){return{baseLanes:r,cachePool:v1()}}function Pg(r,i,l){return r=r!==null?r.childLanes&~l:0,i&&(r|=ei),r}function Rx(r,i,l){var d=i.pendingProps,p=!1,y=(i.flags&128)!==0,w;if((w=y)||(w=r!==null&&r.memoizedState===null?!1:(Ms.current&2)!==0),w&&(p=!0,i.flags&=-129),w=(i.flags&32)!==0,i.flags&=-33,r===null){if(En){if(p?to(i):no(),(r=us)?(r=B_(r,pi),r=r!==null&&r.data!=="&"?r:null,r!==null&&(i.memoizedState={dehydrated:r,treeContext:Ka!==null?{id:Hi,overflow:$i}:null,retryLane:536870912,hydrationErrors:null},l=u1(r),l.return=i,i.child=l,hr=i,us=null)):r=null,r===null)throw Ya(i);return gy(r)?i.lanes=32:i.lanes=536870912,null}var j=d.children;return d=d.fallback,p?(no(),p=i.mode,j=mf({mode:"hidden",children:j},p),d=rl(d,p,l,null),j.return=i,d.return=i,j.sibling=d,i.child=j,d=i.child,d.memoizedState=Dg(l),d.childLanes=Pg(r,w,l),i.memoizedState=Ig,Zu(null,d)):(to(i),Mg(i,j))}var F=r.memoizedState;if(F!==null&&(j=F.dehydrated,j!==null)){if(y)i.flags&256?(to(i),i.flags&=-257,i=Lg(r,i,l)):i.memoizedState!==null?(no(),i.child=r.child,i.flags|=128,i=null):(no(),j=d.fallback,p=i.mode,d=mf({mode:"visible",children:d.children},p),j=rl(j,p,l,null),j.flags|=2,d.return=i,j.return=i,d.sibling=j,i.child=d,dl(i,r.child,null,l),d=i.child,d.memoizedState=Dg(l),d.childLanes=Pg(r,w,l),i.memoizedState=Ig,i=Zu(null,d));else if(to(i),gy(j)){if(w=j.nextSibling&&j.nextSibling.dataset,w)var ce=w.dgst;w=ce,d=Error(s(419)),d.stack="",d.digest=w,Fu({value:d,source:null,stack:null}),i=Lg(r,i,l)}else if(qs||dc(r,i,l,!1),w=(l&r.childLanes)!==0,qs||w){if(w=ss,w!==null&&(d=Bn(w,l),d!==0&&d!==F.retryLane))throw F.retryLane=d,sl(r,d),zr(w,r,d),Ag;py(j)||Tf(),i=Lg(r,i,l)}else py(j)?(i.flags|=192,i.child=r.child,i=null):(r=F.treeContext,us=yi(j.nextSibling),hr=i,En=!0,Qa=null,pi=!1,r!==null&&f1(i,r),i=Mg(i,d.children),i.flags|=4096);return i}return p?(no(),j=d.fallback,p=i.mode,F=r.child,ce=F.sibling,d=da(F,{mode:"hidden",children:d.children}),d.subtreeFlags=F.subtreeFlags&65011712,ce!==null?j=da(ce,j):(j=rl(j,p,l,null),j.flags|=2),j.return=i,d.return=i,d.sibling=j,i.child=d,Zu(null,d),d=i.child,j=r.child.memoizedState,j===null?j=Dg(l):(p=j.cachePool,p!==null?(F=Fs._currentValue,p=p.parent!==F?{parent:F,pool:F}:p):p=v1(),j={baseLanes:j.baseLanes|l,cachePool:p}),d.memoizedState=j,d.childLanes=Pg(r,w,l),i.memoizedState=Ig,Zu(r.child,d)):(to(i),l=r.child,r=l.sibling,l=da(l,{mode:"visible",children:d.children}),l.return=i,l.sibling=null,r!==null&&(w=i.deletions,w===null?(i.deletions=[r],i.flags|=16):w.push(r)),i.child=l,i.memoizedState=null,l)}function Mg(r,i){return i=mf({mode:"visible",children:i},r.mode),i.return=r,r.child=i}function mf(r,i){return r=Yr(22,r,null,i),r.lanes=0,r}function Lg(r,i,l){return dl(i,r.child,null,l),r=Mg(i,i.pendingProps.children),r.flags|=2,i.memoizedState=null,r}function Ix(r,i,l){r.lanes|=i;var d=r.alternate;d!==null&&(d.lanes|=i),Xp(r.return,i,l)}function Vg(r,i,l,d,p,y){var w=r.memoizedState;w===null?r.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:d,tail:l,tailMode:p,treeForkCount:y}:(w.isBackwards=i,w.rendering=null,w.renderingStartTime=0,w.last=d,w.tail=l,w.tailMode=p,w.treeForkCount=y)}function Dx(r,i,l){var d=i.pendingProps,p=d.revealOrder,y=d.tail;d=d.children;var w=Ms.current,j=(w&2)!==0;if(j?(w=w&1|2,i.flags|=128):w&=1,Ie(Ms,w),mr(r,i,d,l),d=En?Uu:0,!j&&r!==null&&(r.flags&128)!==0)e:for(r=i.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&Ix(r,l,i);else if(r.tag===19)Ix(r,l,i);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===i)break e;for(;r.sibling===null;){if(r.return===null||r.return===i)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(p){case"forwards":for(l=i.child,p=null;l!==null;)r=l.alternate,r!==null&&tf(r)===null&&(p=l),l=l.sibling;l=p,l===null?(p=i.child,i.child=null):(p=l.sibling,l.sibling=null),Vg(i,!1,p,l,y,d);break;case"backwards":case"unstable_legacy-backwards":for(l=null,p=i.child,i.child=null;p!==null;){if(r=p.alternate,r!==null&&tf(r)===null){i.child=p;break}r=p.sibling,p.sibling=l,l=p,p=r}Vg(i,!0,l,null,y,d);break;case"together":Vg(i,!1,null,null,void 0,d);break;default:i.memoizedState=null}return i.child}function ya(r,i,l){if(r!==null&&(i.dependencies=r.dependencies),io|=i.lanes,(l&i.childLanes)===0)if(r!==null){if(dc(r,i,l,!1),(l&i.childLanes)===0)return null}else return null;if(r!==null&&i.child!==r.child)throw Error(s(153));if(i.child!==null){for(r=i.child,l=da(r,r.pendingProps),i.child=l,l.return=i;r.sibling!==null;)r=r.sibling,l=l.sibling=da(r,r.pendingProps),l.return=i;l.sibling=null}return i.child}function Og(r,i){return(r.lanes&i)!==0?!0:(r=r.dependencies,!!(r!==null&&Gh(r)))}function UN(r,i,l){switch(i.tag){case 3:Nt(i,i.stateNode.containerInfo),Xa(i,Fs,r.memoizedState.cache),il();break;case 27:case 5:Xt(i);break;case 4:Nt(i,i.stateNode.containerInfo);break;case 10:Xa(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,cg(i),null;break;case 13:var d=i.memoizedState;if(d!==null)return d.dehydrated!==null?(to(i),i.flags|=128,null):(l&i.child.childLanes)!==0?Rx(r,i,l):(to(i),r=ya(r,i,l),r!==null?r.sibling:null);to(i);break;case 19:var p=(r.flags&128)!==0;if(d=(l&i.childLanes)!==0,d||(dc(r,i,l,!1),d=(l&i.childLanes)!==0),p){if(d)return Dx(r,i,l);i.flags|=128}if(p=i.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),Ie(Ms,Ms.current),d)break;return null;case 22:return i.lanes=0,Ex(r,i,l,i.pendingProps);case 24:Xa(i,Fs,r.memoizedState.cache)}return ya(r,i,l)}function Px(r,i,l){if(r!==null)if(r.memoizedProps!==i.pendingProps)qs=!0;else{if(!Og(r,l)&&(i.flags&128)===0)return qs=!1,UN(r,i,l);qs=(r.flags&131072)!==0}else qs=!1,En&&(i.flags&1048576)!==0&&h1(i,Uu,i.index);switch(i.lanes=0,i.tag){case 16:e:{var d=i.pendingProps;if(r=cl(i.elementType),i.type=r,typeof r=="function")qp(r)?(d=fl(r,d),i.tag=1,i=Cx(null,i,r,d,l)):(i.tag=0,i=Rg(null,i,r,d,l));else{if(r!=null){var p=r.$$typeof;if(p===fe){i.tag=11,i=wx(null,i,r,d,l);break e}else if(p===C){i.tag=14,i=Tx(null,i,r,d,l);break e}}throw i=Ke(r)||r,Error(s(306,i,""))}}return i;case 0:return Rg(r,i,i.type,i.pendingProps,l);case 1:return d=i.type,p=fl(d,i.pendingProps),Cx(r,i,d,p,l);case 3:e:{if(Nt(i,i.stateNode.containerInfo),r===null)throw Error(s(387));d=i.pendingProps;var y=i.memoizedState;p=y.element,rg(r,i),Ku(i,d,null,l);var w=i.memoizedState;if(d=w.cache,Xa(i,Fs,d),d!==y.cache&&Jp(i,[Fs],l,!0),Gu(),d=w.element,y.isDehydrated)if(y={element:d,isDehydrated:!1,cache:w.cache},i.updateQueue.baseState=y,i.memoizedState=y,i.flags&256){i=Ax(r,i,d,l);break e}else if(d!==p){p=hi(Error(s(424)),i),Fu(p),i=Ax(r,i,d,l);break e}else for(r=i.stateNode.containerInfo,r.nodeType===9?r=r.body:r=r.nodeName==="HTML"?r.ownerDocument.body:r,us=yi(r.firstChild),hr=i,En=!0,Qa=null,pi=!0,l=E1(i,null,d,l),i.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(il(),d===p){i=ya(r,i,l);break e}mr(r,i,d,l)}i=i.child}return i;case 26:return ff(r,i),r===null?(l=$_(i.type,null,i.pendingProps,null))?i.memoizedState=l:En||(l=i.type,r=i.pendingProps,d=Af(ze.current).createElement(l),d[lt]=i,d[It]=r,pr(d,l,r),A(d),i.stateNode=d):i.memoizedState=$_(i.type,r.memoizedProps,i.pendingProps,r.memoizedState),null;case 27:return Xt(i),r===null&&En&&(d=i.stateNode=z_(i.type,i.pendingProps,ze.current),hr=i,pi=!0,p=us,uo(i.type)?(yy=p,us=yi(d.firstChild)):us=p),mr(r,i,i.pendingProps.children,l),ff(r,i),r===null&&(i.flags|=4194304),i.child;case 5:return r===null&&En&&((p=d=us)&&(d=gC(d,i.type,i.pendingProps,pi),d!==null?(i.stateNode=d,hr=i,us=yi(d.firstChild),pi=!1,p=!0):p=!1),p||Ya(i)),Xt(i),p=i.type,y=i.pendingProps,w=r!==null?r.memoizedProps:null,d=y.children,hy(p,y)?d=null:w!==null&&hy(p,w)&&(i.flags|=32),i.memoizedState!==null&&(p=dg(r,i,RN,null,null,l),md._currentValue=p),ff(r,i),mr(r,i,d,l),i.child;case 6:return r===null&&En&&((r=l=us)&&(l=yC(l,i.pendingProps,pi),l!==null?(i.stateNode=l,hr=i,us=null,r=!0):r=!1),r||Ya(i)),null;case 13:return Rx(r,i,l);case 4:return Nt(i,i.stateNode.containerInfo),d=i.pendingProps,r===null?i.child=dl(i,null,d,l):mr(r,i,d,l),i.child;case 11:return wx(r,i,i.type,i.pendingProps,l);case 7:return mr(r,i,i.pendingProps,l),i.child;case 8:return mr(r,i,i.pendingProps.children,l),i.child;case 12:return mr(r,i,i.pendingProps.children,l),i.child;case 10:return d=i.pendingProps,Xa(i,i.type,d.value),mr(r,i,d.children,l),i.child;case 9:return p=i.type._context,d=i.pendingProps.children,ol(i),p=fr(p),d=d(p),i.flags|=1,mr(r,i,d,l),i.child;case 14:return Tx(r,i,i.type,i.pendingProps,l);case 15:return kx(r,i,i.type,i.pendingProps,l);case 19:return Dx(r,i,l);case 31:return BN(r,i,l);case 22:return Ex(r,i,l,i.pendingProps);case 24:return ol(i),d=fr(Fs),r===null?(p=tg(),p===null&&(p=ss,y=Zp(),p.pooledCache=y,y.refCount++,y!==null&&(p.pooledCacheLanes|=l),p=y),i.memoizedState={parent:d,cache:p},sg(i),Xa(i,Fs,p)):((r.lanes&l)!==0&&(rg(r,i),Ku(i,null,null,l),Gu()),p=r.memoizedState,y=i.memoizedState,p.parent!==d?(p={parent:d,cache:d},i.memoizedState=p,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=p),Xa(i,Fs,d)):(d=y.cache,Xa(i,Fs,d),d!==p.cache&&Jp(i,[Fs],l,!0))),mr(r,i,i.pendingProps.children,l),i.child;case 29:throw i.pendingProps}throw Error(s(156,i.tag))}function ba(r){r.flags|=4}function Bg(r,i,l,d,p){if((i=(r.mode&32)!==0)&&(i=!1),i){if(r.flags|=16777216,(p&335544128)===p)if(r.stateNode.complete)r.flags|=8192;else if(o_())r.flags|=8192;else throw ul=Xh,ng}else r.flags&=-16777217}function Mx(r,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!Y_(i))if(o_())r.flags|=8192;else throw ul=Xh,ng}function pf(r,i){i!==null&&(r.flags|=4),r.flags&16384&&(i=r.tag!==22?Zt():536870912,r.lanes|=i,Tc|=i)}function ed(r,i){if(!En)switch(r.tailMode){case"hidden":i=r.tail;for(var l=null;i!==null;)i.alternate!==null&&(l=i),i=i.sibling;l===null?r.tail=null:l.sibling=null;break;case"collapsed":l=r.tail;for(var d=null;l!==null;)l.alternate!==null&&(d=l),l=l.sibling;d===null?i||r.tail===null?r.tail=null:r.tail.sibling=null:d.sibling=null}}function ds(r){var i=r.alternate!==null&&r.alternate.child===r.child,l=0,d=0;if(i)for(var p=r.child;p!==null;)l|=p.lanes|p.childLanes,d|=p.subtreeFlags&65011712,d|=p.flags&65011712,p.return=r,p=p.sibling;else for(p=r.child;p!==null;)l|=p.lanes|p.childLanes,d|=p.subtreeFlags,d|=p.flags,p.return=r,p=p.sibling;return r.subtreeFlags|=d,r.childLanes=l,i}function FN(r,i,l){var d=i.pendingProps;switch(Gp(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ds(i),null;case 1:return ds(i),null;case 3:return l=i.stateNode,d=null,r!==null&&(d=r.memoizedState.cache),i.memoizedState.cache!==d&&(i.flags|=2048),ma(Fs),at(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(r===null||r.child===null)&&(uc(i)?ba(i):r===null||r.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Qp())),ds(i),null;case 26:var p=i.type,y=i.memoizedState;return r===null?(ba(i),y!==null?(ds(i),Mx(i,y)):(ds(i),Bg(i,p,null,d,l))):y?y!==r.memoizedState?(ba(i),ds(i),Mx(i,y)):(ds(i),i.flags&=-16777217):(r=r.memoizedProps,r!==d&&ba(i),ds(i),Bg(i,p,r,d,l)),null;case 27:if(An(i),l=ze.current,p=i.type,r!==null&&i.stateNode!=null)r.memoizedProps!==d&&ba(i);else{if(!d){if(i.stateNode===null)throw Error(s(166));return ds(i),null}r=Oe.current,uc(i)?m1(i):(r=z_(p,d,l),i.stateNode=r,ba(i))}return ds(i),null;case 5:if(An(i),p=i.type,r!==null&&i.stateNode!=null)r.memoizedProps!==d&&ba(i);else{if(!d){if(i.stateNode===null)throw Error(s(166));return ds(i),null}if(y=Oe.current,uc(i))m1(i);else{var w=Af(ze.current);switch(y){case 1:y=w.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:y=w.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":y=w.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":y=w.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":y=w.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof d.is=="string"?w.createElement("select",{is:d.is}):w.createElement("select"),d.multiple?y.multiple=!0:d.size&&(y.size=d.size);break;default:y=typeof d.is=="string"?w.createElement(p,{is:d.is}):w.createElement(p)}}y[lt]=i,y[It]=d;e:for(w=i.child;w!==null;){if(w.tag===5||w.tag===6)y.appendChild(w.stateNode);else if(w.tag!==4&&w.tag!==27&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===i)break e;for(;w.sibling===null;){if(w.return===null||w.return===i)break e;w=w.return}w.sibling.return=w.return,w=w.sibling}i.stateNode=y;e:switch(pr(y,p,d),p){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break e;case"img":d=!0;break e;default:d=!1}d&&ba(i)}}return ds(i),Bg(i,i.type,r===null?null:r.memoizedProps,i.pendingProps,l),null;case 6:if(r&&i.stateNode!=null)r.memoizedProps!==d&&ba(i);else{if(typeof d!="string"&&i.stateNode===null)throw Error(s(166));if(r=ze.current,uc(i)){if(r=i.stateNode,l=i.memoizedProps,d=null,p=hr,p!==null)switch(p.tag){case 27:case 5:d=p.memoizedProps}r[lt]=i,r=!!(r.nodeValue===l||d!==null&&d.suppressHydrationWarning===!0||R_(r.nodeValue,l)),r||Ya(i,!0)}else r=Af(r).createTextNode(d),r[lt]=i,i.stateNode=r}return ds(i),null;case 31:if(l=i.memoizedState,r===null||r.memoizedState!==null){if(d=uc(i),l!==null){if(r===null){if(!d)throw Error(s(318));if(r=i.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(s(557));r[lt]=i}else il(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;ds(i),r=!1}else l=Qp(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=l),r=!0;if(!r)return i.flags&256?(Jr(i),i):(Jr(i),null);if((i.flags&128)!==0)throw Error(s(558))}return ds(i),null;case 13:if(d=i.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(p=uc(i),d!==null&&d.dehydrated!==null){if(r===null){if(!p)throw Error(s(318));if(p=i.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(s(317));p[lt]=i}else il(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;ds(i),p=!1}else p=Qp(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=p),p=!0;if(!p)return i.flags&256?(Jr(i),i):(Jr(i),null)}return Jr(i),(i.flags&128)!==0?(i.lanes=l,i):(l=d!==null,r=r!==null&&r.memoizedState!==null,l&&(d=i.child,p=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(p=d.alternate.memoizedState.cachePool.pool),y=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(y=d.memoizedState.cachePool.pool),y!==p&&(d.flags|=2048)),l!==r&&l&&(i.child.flags|=8192),pf(i,i.updateQueue),ds(i),null);case 4:return at(),r===null&&oy(i.stateNode.containerInfo),ds(i),null;case 10:return ma(i.type),ds(i),null;case 19:if(ie(Ms),d=i.memoizedState,d===null)return ds(i),null;if(p=(i.flags&128)!==0,y=d.rendering,y===null)if(p)ed(d,!1);else{if(Cs!==0||r!==null&&(r.flags&128)!==0)for(r=i.child;r!==null;){if(y=tf(r),y!==null){for(i.flags|=128,ed(d,!1),r=y.updateQueue,i.updateQueue=r,pf(i,r),i.subtreeFlags=0,r=l,l=i.child;l!==null;)c1(l,r),l=l.sibling;return Ie(Ms,Ms.current&1|2),En&&ha(i,d.treeForkCount),i.child}r=r.sibling}d.tail!==null&&un()>xf&&(i.flags|=128,p=!0,ed(d,!1),i.lanes=4194304)}else{if(!p)if(r=tf(y),r!==null){if(i.flags|=128,p=!0,r=r.updateQueue,i.updateQueue=r,pf(i,r),ed(d,!0),d.tail===null&&d.tailMode==="hidden"&&!y.alternate&&!En)return ds(i),null}else 2*un()-d.renderingStartTime>xf&&l!==536870912&&(i.flags|=128,p=!0,ed(d,!1),i.lanes=4194304);d.isBackwards?(y.sibling=i.child,i.child=y):(r=d.last,r!==null?r.sibling=y:i.child=y,d.last=y)}return d.tail!==null?(r=d.tail,d.rendering=r,d.tail=r.sibling,d.renderingStartTime=un(),r.sibling=null,l=Ms.current,Ie(Ms,p?l&1|2:l&1),En&&ha(i,d.treeForkCount),r):(ds(i),null);case 22:case 23:return Jr(i),lg(),d=i.memoizedState!==null,r!==null?r.memoizedState!==null!==d&&(i.flags|=8192):d&&(i.flags|=8192),d?(l&536870912)!==0&&(i.flags&128)===0&&(ds(i),i.subtreeFlags&6&&(i.flags|=8192)):ds(i),l=i.updateQueue,l!==null&&pf(i,l.retryQueue),l=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(l=r.memoizedState.cachePool.pool),d=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(d=i.memoizedState.cachePool.pool),d!==l&&(i.flags|=2048),r!==null&&ie(ll),null;case 24:return l=null,r!==null&&(l=r.memoizedState.cache),i.memoizedState.cache!==l&&(i.flags|=2048),ma(Fs),ds(i),null;case 25:return null;case 30:return null}throw Error(s(156,i.tag))}function zN(r,i){switch(Gp(i),i.tag){case 1:return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 3:return ma(Fs),at(),r=i.flags,(r&65536)!==0&&(r&128)===0?(i.flags=r&-65537|128,i):null;case 26:case 27:case 5:return An(i),null;case 31:if(i.memoizedState!==null){if(Jr(i),i.alternate===null)throw Error(s(340));il()}return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 13:if(Jr(i),r=i.memoizedState,r!==null&&r.dehydrated!==null){if(i.alternate===null)throw Error(s(340));il()}return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 19:return ie(Ms),null;case 4:return at(),null;case 10:return ma(i.type),null;case 22:case 23:return Jr(i),lg(),r!==null&&ie(ll),r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 24:return ma(Fs),null;case 25:return null;default:return null}}function Lx(r,i){switch(Gp(i),i.tag){case 3:ma(Fs),at();break;case 26:case 27:case 5:An(i);break;case 4:at();break;case 31:i.memoizedState!==null&&Jr(i);break;case 13:Jr(i);break;case 19:ie(Ms);break;case 10:ma(i.type);break;case 22:case 23:Jr(i),lg(),r!==null&&ie(ll);break;case 24:ma(Fs)}}function td(r,i){try{var l=i.updateQueue,d=l!==null?l.lastEffect:null;if(d!==null){var p=d.next;l=p;do{if((l.tag&r)===r){d=void 0;var y=l.create,w=l.inst;d=y(),w.destroy=d}l=l.next}while(l!==p)}}catch(j){Gn(i,i.return,j)}}function so(r,i,l){try{var d=i.updateQueue,p=d!==null?d.lastEffect:null;if(p!==null){var y=p.next;d=y;do{if((d.tag&r)===r){var w=d.inst,j=w.destroy;if(j!==void 0){w.destroy=void 0,p=i;var F=l,ce=j;try{ce()}catch(Se){Gn(p,F,Se)}}}d=d.next}while(d!==y)}}catch(Se){Gn(i,i.return,Se)}}function Vx(r){var i=r.updateQueue;if(i!==null){var l=r.stateNode;try{j1(i,l)}catch(d){Gn(r,r.return,d)}}}function Ox(r,i,l){l.props=fl(r.type,r.memoizedProps),l.state=r.memoizedState;try{l.componentWillUnmount()}catch(d){Gn(r,i,d)}}function nd(r,i){try{var l=r.ref;if(l!==null){switch(r.tag){case 26:case 27:case 5:var d=r.stateNode;break;case 30:d=r.stateNode;break;default:d=r.stateNode}typeof l=="function"?r.refCleanup=l(d):l.current=d}}catch(p){Gn(r,i,p)}}function Wi(r,i){var l=r.ref,d=r.refCleanup;if(l!==null)if(typeof d=="function")try{d()}catch(p){Gn(r,i,p)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(p){Gn(r,i,p)}else l.current=null}function Bx(r){var i=r.type,l=r.memoizedProps,d=r.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":l.autoFocus&&d.focus();break e;case"img":l.src?d.src=l.src:l.srcSet&&(d.srcset=l.srcSet)}}catch(p){Gn(r,r.return,p)}}function Ug(r,i,l){try{var d=r.stateNode;uC(d,r.type,l,i),d[It]=i}catch(p){Gn(r,r.return,p)}}function Ux(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&uo(r.type)||r.tag===4}function Fg(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||Ux(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&uo(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function zg(r,i,l){var d=r.tag;if(d===5||d===6)r=r.stateNode,i?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(r,i):(i=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,i.appendChild(r),l=l._reactRootContainer,l!=null||i.onclick!==null||(i.onclick=ls));else if(d!==4&&(d===27&&uo(r.type)&&(l=r.stateNode,i=null),r=r.child,r!==null))for(zg(r,i,l),r=r.sibling;r!==null;)zg(r,i,l),r=r.sibling}function gf(r,i,l){var d=r.tag;if(d===5||d===6)r=r.stateNode,i?l.insertBefore(r,i):l.appendChild(r);else if(d!==4&&(d===27&&uo(r.type)&&(l=r.stateNode),r=r.child,r!==null))for(gf(r,i,l),r=r.sibling;r!==null;)gf(r,i,l),r=r.sibling}function Fx(r){var i=r.stateNode,l=r.memoizedProps;try{for(var d=r.type,p=i.attributes;p.length;)i.removeAttributeNode(p[0]);pr(i,d,l),i[lt]=r,i[It]=l}catch(y){Gn(r,r.return,y)}}var va=!1,Hs=!1,qg=!1,zx=typeof WeakSet=="function"?WeakSet:Set,nr=null;function qN(r,i){if(r=r.containerInfo,uy=Vf,r=e1(r),Lp(r)){if("selectionStart"in r)var l={start:r.selectionStart,end:r.selectionEnd};else e:{l=(l=r.ownerDocument)&&l.defaultView||window;var d=l.getSelection&&l.getSelection();if(d&&d.rangeCount!==0){l=d.anchorNode;var p=d.anchorOffset,y=d.focusNode;d=d.focusOffset;try{l.nodeType,y.nodeType}catch{l=null;break e}var w=0,j=-1,F=-1,ce=0,Se=0,Pe=r,de=null;t:for(;;){for(var ye;Pe!==l||p!==0&&Pe.nodeType!==3||(j=w+p),Pe!==y||d!==0&&Pe.nodeType!==3||(F=w+d),Pe.nodeType===3&&(w+=Pe.nodeValue.length),(ye=Pe.firstChild)!==null;)de=Pe,Pe=ye;for(;;){if(Pe===r)break t;if(de===l&&++ce===p&&(j=w),de===y&&++Se===d&&(F=w),(ye=Pe.nextSibling)!==null)break;Pe=de,de=Pe.parentNode}Pe=ye}l=j===-1||F===-1?null:{start:j,end:F}}else l=null}l=l||{start:0,end:0}}else l=null;for(dy={focusedElem:r,selectionRange:l},Vf=!1,nr=i;nr!==null;)if(i=nr,r=i.child,(i.subtreeFlags&1028)!==0&&r!==null)r.return=i,nr=r;else for(;nr!==null;){switch(i=nr,y=i.alternate,r=i.flags,i.tag){case 0:if((r&4)!==0&&(r=i.updateQueue,r=r!==null?r.events:null,r!==null))for(l=0;l<r.length;l++)p=r[l],p.ref.impl=p.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&y!==null){r=void 0,l=i,p=y.memoizedProps,y=y.memoizedState,d=l.stateNode;try{var mt=fl(l.type,p);r=d.getSnapshotBeforeUpdate(mt,y),d.__reactInternalSnapshotBeforeUpdate=r}catch(Vt){Gn(l,l.return,Vt)}}break;case 3:if((r&1024)!==0){if(r=i.stateNode.containerInfo,l=r.nodeType,l===9)my(r);else if(l===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":my(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(s(163))}if(r=i.sibling,r!==null){r.return=i.return,nr=r;break}nr=i.return}}function qx(r,i,l){var d=l.flags;switch(l.tag){case 0:case 11:case 15:_a(r,l),d&4&&td(5,l);break;case 1:if(_a(r,l),d&4)if(r=l.stateNode,i===null)try{r.componentDidMount()}catch(w){Gn(l,l.return,w)}else{var p=fl(l.type,i.memoizedProps);i=i.memoizedState;try{r.componentDidUpdate(p,i,r.__reactInternalSnapshotBeforeUpdate)}catch(w){Gn(l,l.return,w)}}d&64&&Vx(l),d&512&&nd(l,l.return);break;case 3:if(_a(r,l),d&64&&(r=l.updateQueue,r!==null)){if(i=null,l.child!==null)switch(l.child.tag){case 27:case 5:i=l.child.stateNode;break;case 1:i=l.child.stateNode}try{j1(r,i)}catch(w){Gn(l,l.return,w)}}break;case 27:i===null&&d&4&&Fx(l);case 26:case 5:_a(r,l),i===null&&d&4&&Bx(l),d&512&&nd(l,l.return);break;case 12:_a(r,l);break;case 31:_a(r,l),d&4&&Wx(r,l);break;case 13:_a(r,l),d&4&&Gx(r,l),d&64&&(r=l.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(l=JN.bind(null,l),bC(r,l))));break;case 22:if(d=l.memoizedState!==null||va,!d){i=i!==null&&i.memoizedState!==null||Hs,p=va;var y=Hs;va=d,(Hs=i)&&!y?wa(r,l,(l.subtreeFlags&8772)!==0):_a(r,l),va=p,Hs=y}break;case 30:break;default:_a(r,l)}}function Hx(r){var i=r.alternate;i!==null&&(r.alternate=null,Hx(i)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(i=r.stateNode,i!==null&&Ds(i)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var gs=null,Or=!1;function xa(r,i,l){for(l=l.child;l!==null;)$x(r,i,l),l=l.sibling}function $x(r,i,l){if(Fe&&typeof Fe.onCommitFiberUnmount=="function")try{Fe.onCommitFiberUnmount(nt,l)}catch{}switch(l.tag){case 26:Hs||Wi(l,i),xa(r,i,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Hs||Wi(l,i);var d=gs,p=Or;uo(l.type)&&(gs=l.stateNode,Or=!1),xa(r,i,l),dd(l.stateNode),gs=d,Or=p;break;case 5:Hs||Wi(l,i);case 6:if(d=gs,p=Or,gs=null,xa(r,i,l),gs=d,Or=p,gs!==null)if(Or)try{(gs.nodeType===9?gs.body:gs.nodeName==="HTML"?gs.ownerDocument.body:gs).removeChild(l.stateNode)}catch(y){Gn(l,i,y)}else try{gs.removeChild(l.stateNode)}catch(y){Gn(l,i,y)}break;case 18:gs!==null&&(Or?(r=gs,V_(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,l.stateNode),Rc(r)):V_(gs,l.stateNode));break;case 4:d=gs,p=Or,gs=l.stateNode.containerInfo,Or=!0,xa(r,i,l),gs=d,Or=p;break;case 0:case 11:case 14:case 15:so(2,l,i),Hs||so(4,l,i),xa(r,i,l);break;case 1:Hs||(Wi(l,i),d=l.stateNode,typeof d.componentWillUnmount=="function"&&Ox(l,i,d)),xa(r,i,l);break;case 21:xa(r,i,l);break;case 22:Hs=(d=Hs)||l.memoizedState!==null,xa(r,i,l),Hs=d;break;default:xa(r,i,l)}}function Wx(r,i){if(i.memoizedState===null&&(r=i.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{Rc(r)}catch(l){Gn(i,i.return,l)}}}function Gx(r,i){if(i.memoizedState===null&&(r=i.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Rc(r)}catch(l){Gn(i,i.return,l)}}function HN(r){switch(r.tag){case 31:case 13:case 19:var i=r.stateNode;return i===null&&(i=r.stateNode=new zx),i;case 22:return r=r.stateNode,i=r._retryCache,i===null&&(i=r._retryCache=new zx),i;default:throw Error(s(435,r.tag))}}function yf(r,i){var l=HN(r);i.forEach(function(d){if(!l.has(d)){l.add(d);var p=ZN.bind(null,r,d);d.then(p,p)}})}function Br(r,i){var l=i.deletions;if(l!==null)for(var d=0;d<l.length;d++){var p=l[d],y=r,w=i,j=w;e:for(;j!==null;){switch(j.tag){case 27:if(uo(j.type)){gs=j.stateNode,Or=!1;break e}break;case 5:gs=j.stateNode,Or=!1;break e;case 3:case 4:gs=j.stateNode.containerInfo,Or=!0;break e}j=j.return}if(gs===null)throw Error(s(160));$x(y,w,p),gs=null,Or=!1,y=p.alternate,y!==null&&(y.return=null),p.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)Kx(i,r),i=i.sibling}var Ci=null;function Kx(r,i){var l=r.alternate,d=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Br(i,r),Ur(r),d&4&&(so(3,r,r.return),td(3,r),so(5,r,r.return));break;case 1:Br(i,r),Ur(r),d&512&&(Hs||l===null||Wi(l,l.return)),d&64&&va&&(r=r.updateQueue,r!==null&&(d=r.callbacks,d!==null&&(l=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=l===null?d:l.concat(d))));break;case 26:var p=Ci;if(Br(i,r),Ur(r),d&512&&(Hs||l===null||Wi(l,l.return)),d&4){var y=l!==null?l.memoizedState:null;if(d=r.memoizedState,l===null)if(d===null)if(r.stateNode===null){e:{d=r.type,l=r.memoizedProps,p=p.ownerDocument||p;t:switch(d){case"title":y=p.getElementsByTagName("title")[0],(!y||y[ks]||y[lt]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=p.createElement(d),p.head.insertBefore(y,p.querySelector("head > title"))),pr(y,d,l),y[lt]=r,A(y),d=y;break e;case"link":var w=K_("link","href",p).get(d+(l.href||""));if(w){for(var j=0;j<w.length;j++)if(y=w[j],y.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&y.getAttribute("rel")===(l.rel==null?null:l.rel)&&y.getAttribute("title")===(l.title==null?null:l.title)&&y.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){w.splice(j,1);break t}}y=p.createElement(d),pr(y,d,l),p.head.appendChild(y);break;case"meta":if(w=K_("meta","content",p).get(d+(l.content||""))){for(j=0;j<w.length;j++)if(y=w[j],y.getAttribute("content")===(l.content==null?null:""+l.content)&&y.getAttribute("name")===(l.name==null?null:l.name)&&y.getAttribute("property")===(l.property==null?null:l.property)&&y.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&y.getAttribute("charset")===(l.charSet==null?null:l.charSet)){w.splice(j,1);break t}}y=p.createElement(d),pr(y,d,l),p.head.appendChild(y);break;default:throw Error(s(468,d))}y[lt]=r,A(y),d=y}r.stateNode=d}else Q_(p,r.type,r.stateNode);else r.stateNode=G_(p,d,r.memoizedProps);else y!==d?(y===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):y.count--,d===null?Q_(p,r.type,r.stateNode):G_(p,d,r.memoizedProps)):d===null&&r.stateNode!==null&&Ug(r,r.memoizedProps,l.memoizedProps)}break;case 27:Br(i,r),Ur(r),d&512&&(Hs||l===null||Wi(l,l.return)),l!==null&&d&4&&Ug(r,r.memoizedProps,l.memoizedProps);break;case 5:if(Br(i,r),Ur(r),d&512&&(Hs||l===null||Wi(l,l.return)),r.flags&32){p=r.stateNode;try{Es(p,"")}catch(mt){Gn(r,r.return,mt)}}d&4&&r.stateNode!=null&&(p=r.memoizedProps,Ug(r,p,l!==null?l.memoizedProps:p)),d&1024&&(qg=!0);break;case 6:if(Br(i,r),Ur(r),d&4){if(r.stateNode===null)throw Error(s(162));d=r.memoizedProps,l=r.stateNode;try{l.nodeValue=d}catch(mt){Gn(r,r.return,mt)}}break;case 3:if(Df=null,p=Ci,Ci=Rf(i.containerInfo),Br(i,r),Ci=p,Ur(r),d&4&&l!==null&&l.memoizedState.isDehydrated)try{Rc(i.containerInfo)}catch(mt){Gn(r,r.return,mt)}qg&&(qg=!1,Qx(r));break;case 4:d=Ci,Ci=Rf(r.stateNode.containerInfo),Br(i,r),Ur(r),Ci=d;break;case 12:Br(i,r),Ur(r);break;case 31:Br(i,r),Ur(r),d&4&&(d=r.updateQueue,d!==null&&(r.updateQueue=null,yf(r,d)));break;case 13:Br(i,r),Ur(r),r.child.flags&8192&&r.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(vf=un()),d&4&&(d=r.updateQueue,d!==null&&(r.updateQueue=null,yf(r,d)));break;case 22:p=r.memoizedState!==null;var F=l!==null&&l.memoizedState!==null,ce=va,Se=Hs;if(va=ce||p,Hs=Se||F,Br(i,r),Hs=Se,va=ce,Ur(r),d&8192)e:for(i=r.stateNode,i._visibility=p?i._visibility&-2:i._visibility|1,p&&(l===null||F||va||Hs||ml(r)),l=null,i=r;;){if(i.tag===5||i.tag===26){if(l===null){F=l=i;try{if(y=F.stateNode,p)w=y.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{j=F.stateNode;var Pe=F.memoizedProps.style,de=Pe!=null&&Pe.hasOwnProperty("display")?Pe.display:null;j.style.display=de==null||typeof de=="boolean"?"":(""+de).trim()}}catch(mt){Gn(F,F.return,mt)}}}else if(i.tag===6){if(l===null){F=i;try{F.stateNode.nodeValue=p?"":F.memoizedProps}catch(mt){Gn(F,F.return,mt)}}}else if(i.tag===18){if(l===null){F=i;try{var ye=F.stateNode;p?O_(ye,!0):O_(F.stateNode,!1)}catch(mt){Gn(F,F.return,mt)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===r)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break e;for(;i.sibling===null;){if(i.return===null||i.return===r)break e;l===i&&(l=null),i=i.return}l===i&&(l=null),i.sibling.return=i.return,i=i.sibling}d&4&&(d=r.updateQueue,d!==null&&(l=d.retryQueue,l!==null&&(d.retryQueue=null,yf(r,l))));break;case 19:Br(i,r),Ur(r),d&4&&(d=r.updateQueue,d!==null&&(r.updateQueue=null,yf(r,d)));break;case 30:break;case 21:break;default:Br(i,r),Ur(r)}}function Ur(r){var i=r.flags;if(i&2){try{for(var l,d=r.return;d!==null;){if(Ux(d)){l=d;break}d=d.return}if(l==null)throw Error(s(160));switch(l.tag){case 27:var p=l.stateNode,y=Fg(r);gf(r,y,p);break;case 5:var w=l.stateNode;l.flags&32&&(Es(w,""),l.flags&=-33);var j=Fg(r);gf(r,j,w);break;case 3:case 4:var F=l.stateNode.containerInfo,ce=Fg(r);zg(r,ce,F);break;default:throw Error(s(161))}}catch(Se){Gn(r,r.return,Se)}r.flags&=-3}i&4096&&(r.flags&=-4097)}function Qx(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var i=r;Qx(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),r=r.sibling}}function _a(r,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)qx(r,i.alternate,i),i=i.sibling}function ml(r){for(r=r.child;r!==null;){var i=r;switch(i.tag){case 0:case 11:case 14:case 15:so(4,i,i.return),ml(i);break;case 1:Wi(i,i.return);var l=i.stateNode;typeof l.componentWillUnmount=="function"&&Ox(i,i.return,l),ml(i);break;case 27:dd(i.stateNode);case 26:case 5:Wi(i,i.return),ml(i);break;case 22:i.memoizedState===null&&ml(i);break;case 30:ml(i);break;default:ml(i)}r=r.sibling}}function wa(r,i,l){for(l=l&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var d=i.alternate,p=r,y=i,w=y.flags;switch(y.tag){case 0:case 11:case 15:wa(p,y,l),td(4,y);break;case 1:if(wa(p,y,l),d=y,p=d.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(ce){Gn(d,d.return,ce)}if(d=y,p=d.updateQueue,p!==null){var j=d.stateNode;try{var F=p.shared.hiddenCallbacks;if(F!==null)for(p.shared.hiddenCallbacks=null,p=0;p<F.length;p++)S1(F[p],j)}catch(ce){Gn(d,d.return,ce)}}l&&w&64&&Vx(y),nd(y,y.return);break;case 27:Fx(y);case 26:case 5:wa(p,y,l),l&&d===null&&w&4&&Bx(y),nd(y,y.return);break;case 12:wa(p,y,l);break;case 31:wa(p,y,l),l&&w&4&&Wx(p,y);break;case 13:wa(p,y,l),l&&w&4&&Gx(p,y);break;case 22:y.memoizedState===null&&wa(p,y,l),nd(y,y.return);break;case 30:break;default:wa(p,y,l)}i=i.sibling}}function Hg(r,i){var l=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(l=r.memoizedState.cachePool.pool),r=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(r=i.memoizedState.cachePool.pool),r!==l&&(r!=null&&r.refCount++,l!=null&&zu(l))}function $g(r,i){r=null,i.alternate!==null&&(r=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==r&&(i.refCount++,r!=null&&zu(r))}function Ai(r,i,l,d){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Yx(r,i,l,d),i=i.sibling}function Yx(r,i,l,d){var p=i.flags;switch(i.tag){case 0:case 11:case 15:Ai(r,i,l,d),p&2048&&td(9,i);break;case 1:Ai(r,i,l,d);break;case 3:Ai(r,i,l,d),p&2048&&(r=null,i.alternate!==null&&(r=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==r&&(i.refCount++,r!=null&&zu(r)));break;case 12:if(p&2048){Ai(r,i,l,d),r=i.stateNode;try{var y=i.memoizedProps,w=y.id,j=y.onPostCommit;typeof j=="function"&&j(w,i.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(F){Gn(i,i.return,F)}}else Ai(r,i,l,d);break;case 31:Ai(r,i,l,d);break;case 13:Ai(r,i,l,d);break;case 23:break;case 22:y=i.stateNode,w=i.alternate,i.memoizedState!==null?y._visibility&2?Ai(r,i,l,d):sd(r,i):y._visibility&2?Ai(r,i,l,d):(y._visibility|=2,xc(r,i,l,d,(i.subtreeFlags&10256)!==0||!1)),p&2048&&Hg(w,i);break;case 24:Ai(r,i,l,d),p&2048&&$g(i.alternate,i);break;default:Ai(r,i,l,d)}}function xc(r,i,l,d,p){for(p=p&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var y=r,w=i,j=l,F=d,ce=w.flags;switch(w.tag){case 0:case 11:case 15:xc(y,w,j,F,p),td(8,w);break;case 23:break;case 22:var Se=w.stateNode;w.memoizedState!==null?Se._visibility&2?xc(y,w,j,F,p):sd(y,w):(Se._visibility|=2,xc(y,w,j,F,p)),p&&ce&2048&&Hg(w.alternate,w);break;case 24:xc(y,w,j,F,p),p&&ce&2048&&$g(w.alternate,w);break;default:xc(y,w,j,F,p)}i=i.sibling}}function sd(r,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var l=r,d=i,p=d.flags;switch(d.tag){case 22:sd(l,d),p&2048&&Hg(d.alternate,d);break;case 24:sd(l,d),p&2048&&$g(d.alternate,d);break;default:sd(l,d)}i=i.sibling}}var rd=8192;function _c(r,i,l){if(r.subtreeFlags&rd)for(r=r.child;r!==null;)Xx(r,i,l),r=r.sibling}function Xx(r,i,l){switch(r.tag){case 26:_c(r,i,l),r.flags&rd&&r.memoizedState!==null&&AC(l,Ci,r.memoizedState,r.memoizedProps);break;case 5:_c(r,i,l);break;case 3:case 4:var d=Ci;Ci=Rf(r.stateNode.containerInfo),_c(r,i,l),Ci=d;break;case 22:r.memoizedState===null&&(d=r.alternate,d!==null&&d.memoizedState!==null?(d=rd,rd=16777216,_c(r,i,l),rd=d):_c(r,i,l));break;default:_c(r,i,l)}}function Jx(r){var i=r.alternate;if(i!==null&&(r=i.child,r!==null)){i.child=null;do i=r.sibling,r.sibling=null,r=i;while(r!==null)}}function id(r){var i=r.deletions;if((r.flags&16)!==0){if(i!==null)for(var l=0;l<i.length;l++){var d=i[l];nr=d,e_(d,r)}Jx(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Zx(r),r=r.sibling}function Zx(r){switch(r.tag){case 0:case 11:case 15:id(r),r.flags&2048&&so(9,r,r.return);break;case 3:id(r);break;case 12:id(r);break;case 22:var i=r.stateNode;r.memoizedState!==null&&i._visibility&2&&(r.return===null||r.return.tag!==13)?(i._visibility&=-3,bf(r)):id(r);break;default:id(r)}}function bf(r){var i=r.deletions;if((r.flags&16)!==0){if(i!==null)for(var l=0;l<i.length;l++){var d=i[l];nr=d,e_(d,r)}Jx(r)}for(r=r.child;r!==null;){switch(i=r,i.tag){case 0:case 11:case 15:so(8,i,i.return),bf(i);break;case 22:l=i.stateNode,l._visibility&2&&(l._visibility&=-3,bf(i));break;default:bf(i)}r=r.sibling}}function e_(r,i){for(;nr!==null;){var l=nr;switch(l.tag){case 0:case 11:case 15:so(8,l,i);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var d=l.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:zu(l.memoizedState.cache)}if(d=l.child,d!==null)d.return=l,nr=d;else e:for(l=r;nr!==null;){d=nr;var p=d.sibling,y=d.return;if(Hx(d),d===l){nr=null;break e}if(p!==null){p.return=y,nr=p;break e}nr=y}}}var $N={getCacheForType:function(r){var i=fr(Fs),l=i.data.get(r);return l===void 0&&(l=r(),i.data.set(r,l)),l},cacheSignal:function(){return fr(Fs).controller.signal}},WN=typeof WeakMap=="function"?WeakMap:Map,Fn=0,ss=null,pn=null,xn=0,Wn=0,Zr=null,ro=!1,wc=!1,Wg=!1,Ta=0,Cs=0,io=0,pl=0,Gg=0,ei=0,Tc=0,ad=null,Fr=null,Kg=!1,vf=0,t_=0,xf=1/0,_f=null,ao=null,Xs=0,oo=null,kc=null,ka=0,Qg=0,Yg=null,n_=null,od=0,Xg=null;function ti(){return(Fn&2)!==0&&xn!==0?xn&-xn:$.T!==null?sy():ke()}function s_(){if(ei===0)if((xn&536870912)===0||En){var r=Z;Z<<=1,(Z&3932160)===0&&(Z=262144),ei=r}else ei=536870912;return r=Xr.current,r!==null&&(r.flags|=32),ei}function zr(r,i,l){(r===ss&&(Wn===2||Wn===9)||r.cancelPendingCommit!==null)&&(Ec(r,0),lo(r,xn,ei,!1)),Ln(r,l),((Fn&2)===0||r!==ss)&&(r===ss&&((Fn&2)===0&&(pl|=l),Cs===4&&lo(r,xn,ei,!1)),Gi(r))}function r_(r,i,l){if((Fn&6)!==0)throw Error(s(327));var d=!l&&(i&127)===0&&(i&r.expiredLanes)===0||Ct(r,i),p=d?QN(r,i):Zg(r,i,!0),y=d;do{if(p===0){wc&&!d&&lo(r,i,0,!1);break}else{if(l=r.current.alternate,y&&!GN(l)){p=Zg(r,i,!1),y=!1;continue}if(p===2){if(y=i,r.errorRecoveryDisabledLanes&y)var w=0;else w=r.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){i=w;e:{var j=r;p=ad;var F=j.current.memoizedState.isDehydrated;if(F&&(Ec(j,w).flags|=256),w=Zg(j,w,!1),w!==2){if(Wg&&!F){j.errorRecoveryDisabledLanes|=y,pl|=y,p=4;break e}y=Fr,Fr=p,y!==null&&(Fr===null?Fr=y:Fr.push.apply(Fr,y))}p=w}if(y=!1,p!==2)continue}}if(p===1){Ec(r,0),lo(r,i,0,!0);break}e:{switch(d=r,y=p,y){case 0:case 1:throw Error(s(345));case 4:if((i&4194048)!==i)break;case 6:lo(d,i,ei,!ro);break e;case 2:Fr=null;break;case 3:case 5:break;default:throw Error(s(329))}if((i&62914560)===i&&(p=vf+300-un(),10<p)){if(lo(d,i,ei,!ro),Lt(d,0,!0)!==0)break e;ka=i,d.timeoutHandle=M_(i_.bind(null,d,l,Fr,_f,Kg,i,ei,pl,Tc,ro,y,"Throttled",-0,0),p);break e}i_(d,l,Fr,_f,Kg,i,ei,pl,Tc,ro,y,null,-0,0)}}break}while(!0);Gi(r)}function i_(r,i,l,d,p,y,w,j,F,ce,Se,Pe,de,ye){if(r.timeoutHandle=-1,Pe=i.subtreeFlags,Pe&8192||(Pe&16785408)===16785408){Pe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ls},Xx(i,y,Pe);var mt=(y&62914560)===y?vf-un():(y&4194048)===y?t_-un():0;if(mt=RC(Pe,mt),mt!==null){ka=y,r.cancelPendingCommit=mt(f_.bind(null,r,i,y,l,d,p,w,j,F,Se,Pe,null,de,ye)),lo(r,y,w,!ce);return}}f_(r,i,y,l,d,p,w,j,F)}function GN(r){for(var i=r;;){var l=i.tag;if((l===0||l===11||l===15)&&i.flags&16384&&(l=i.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var d=0;d<l.length;d++){var p=l[d],y=p.getSnapshot;p=p.value;try{if(!Qr(y(),p))return!1}catch{return!1}}if(l=i.child,i.subtreeFlags&16384&&l!==null)l.return=i,i=l;else{if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function lo(r,i,l,d){i&=~Gg,i&=~pl,r.suspendedLanes|=i,r.pingedLanes&=~i,d&&(r.warmLanes|=i),d=r.expirationTimes;for(var p=i;0<p;){var y=31-qe(p),w=1<<y;d[y]=-1,p&=~w}l!==0&&bn(r,l,i)}function wf(){return(Fn&6)===0?(ld(0),!1):!0}function Jg(){if(pn!==null){if(Wn===0)var r=pn.return;else r=pn,fa=al=null,mg(r),pc=null,Hu=0,r=pn;for(;r!==null;)Lx(r.alternate,r),r=r.return;pn=null}}function Ec(r,i){var l=r.timeoutHandle;l!==-1&&(r.timeoutHandle=-1,fC(l)),l=r.cancelPendingCommit,l!==null&&(r.cancelPendingCommit=null,l()),ka=0,Jg(),ss=r,pn=l=da(r.current,null),xn=i,Wn=0,Zr=null,ro=!1,wc=Ct(r,i),Wg=!1,Tc=ei=Gg=pl=io=Cs=0,Fr=ad=null,Kg=!1,(i&8)!==0&&(i|=i&32);var d=r.entangledLanes;if(d!==0)for(r=r.entanglements,d&=i;0<d;){var p=31-qe(d),y=1<<p;i|=r[p],d&=~y}return Ta=i,zh(),l}function a_(r,i){rn=null,$.H=Ju,i===mc||i===Yh?(i=w1(),Wn=3):i===ng?(i=w1(),Wn=4):Wn=i===Ag?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,Zr=i,pn===null&&(Cs=1,df(r,hi(i,r.current)))}function o_(){var r=Xr.current;return r===null?!0:(xn&4194048)===xn?gi===null:(xn&62914560)===xn||(xn&536870912)!==0?r===gi:!1}function l_(){var r=$.H;return $.H=Ju,r===null?Ju:r}function c_(){var r=$.A;return $.A=$N,r}function Tf(){Cs=4,ro||(xn&4194048)!==xn&&Xr.current!==null||(wc=!0),(io&134217727)===0&&(pl&134217727)===0||ss===null||lo(ss,xn,ei,!1)}function Zg(r,i,l){var d=Fn;Fn|=2;var p=l_(),y=c_();(ss!==r||xn!==i)&&(_f=null,Ec(r,i)),i=!1;var w=Cs;e:do try{if(Wn!==0&&pn!==null){var j=pn,F=Zr;switch(Wn){case 8:Jg(),w=6;break e;case 3:case 2:case 9:case 6:Xr.current===null&&(i=!0);var ce=Wn;if(Wn=0,Zr=null,Sc(r,j,F,ce),l&&wc){w=0;break e}break;default:ce=Wn,Wn=0,Zr=null,Sc(r,j,F,ce)}}KN(),w=Cs;break}catch(Se){a_(r,Se)}while(!0);return i&&r.shellSuspendCounter++,fa=al=null,Fn=d,$.H=p,$.A=y,pn===null&&(ss=null,xn=0,zh()),w}function KN(){for(;pn!==null;)u_(pn)}function QN(r,i){var l=Fn;Fn|=2;var d=l_(),p=c_();ss!==r||xn!==i?(_f=null,xf=un()+500,Ec(r,i)):wc=Ct(r,i);e:do try{if(Wn!==0&&pn!==null){i=pn;var y=Zr;t:switch(Wn){case 1:Wn=0,Zr=null,Sc(r,i,y,1);break;case 2:case 9:if(x1(y)){Wn=0,Zr=null,d_(i);break}i=function(){Wn!==2&&Wn!==9||ss!==r||(Wn=7),Gi(r)},y.then(i,i);break e;case 3:Wn=7;break e;case 4:Wn=5;break e;case 7:x1(y)?(Wn=0,Zr=null,d_(i)):(Wn=0,Zr=null,Sc(r,i,y,7));break;case 5:var w=null;switch(pn.tag){case 26:w=pn.memoizedState;case 5:case 27:var j=pn;if(w?Y_(w):j.stateNode.complete){Wn=0,Zr=null;var F=j.sibling;if(F!==null)pn=F;else{var ce=j.return;ce!==null?(pn=ce,kf(ce)):pn=null}break t}}Wn=0,Zr=null,Sc(r,i,y,5);break;case 6:Wn=0,Zr=null,Sc(r,i,y,6);break;case 8:Jg(),Cs=6;break e;default:throw Error(s(462))}}YN();break}catch(Se){a_(r,Se)}while(!0);return fa=al=null,$.H=d,$.A=p,Fn=l,pn!==null?0:(ss=null,xn=0,zh(),Cs)}function YN(){for(;pn!==null&&!ts();)u_(pn)}function u_(r){var i=Px(r.alternate,r,Ta);r.memoizedProps=r.pendingProps,i===null?kf(r):pn=i}function d_(r){var i=r,l=i.alternate;switch(i.tag){case 15:case 0:i=Nx(l,i,i.pendingProps,i.type,void 0,xn);break;case 11:i=Nx(l,i,i.pendingProps,i.type.render,i.ref,xn);break;case 5:mg(i);default:Lx(l,i),i=pn=c1(i,Ta),i=Px(l,i,Ta)}r.memoizedProps=r.pendingProps,i===null?kf(r):pn=i}function Sc(r,i,l,d){fa=al=null,mg(i),pc=null,Hu=0;var p=i.return;try{if(ON(r,p,i,l,xn)){Cs=1,df(r,hi(l,r.current)),pn=null;return}}catch(y){if(p!==null)throw pn=p,y;Cs=1,df(r,hi(l,r.current)),pn=null;return}i.flags&32768?(En||d===1?r=!0:wc||(xn&536870912)!==0?r=!1:(ro=r=!0,(d===2||d===9||d===3||d===6)&&(d=Xr.current,d!==null&&d.tag===13&&(d.flags|=16384))),h_(i,r)):kf(i)}function kf(r){var i=r;do{if((i.flags&32768)!==0){h_(i,ro);return}r=i.return;var l=FN(i.alternate,i,Ta);if(l!==null){pn=l;return}if(i=i.sibling,i!==null){pn=i;return}pn=i=r}while(i!==null);Cs===0&&(Cs=5)}function h_(r,i){do{var l=zN(r.alternate,r);if(l!==null){l.flags&=32767,pn=l;return}if(l=r.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!i&&(r=r.sibling,r!==null)){pn=r;return}pn=r=l}while(r!==null);Cs=6,pn=null}function f_(r,i,l,d,p,y,w,j,F){r.cancelPendingCommit=null;do Ef();while(Xs!==0);if((Fn&6)!==0)throw Error(s(327));if(i!==null){if(i===r.current)throw Error(s(177));if(y=i.lanes|i.childLanes,y|=Fp,as(r,l,y,w,j,F),r===ss&&(pn=ss=null,xn=0),kc=i,oo=r,ka=l,Qg=y,Yg=p,n_=d,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,eC(dn,function(){return b_(),null})):(r.callbackNode=null,r.callbackPriority=0),d=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||d){d=$.T,$.T=null,p=ge.p,ge.p=2,w=Fn,Fn|=4;try{qN(r,i,l)}finally{Fn=w,ge.p=p,$.T=d}}Xs=1,m_(),p_(),g_()}}function m_(){if(Xs===1){Xs=0;var r=oo,i=kc,l=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||l){l=$.T,$.T=null;var d=ge.p;ge.p=2;var p=Fn;Fn|=4;try{Kx(i,r);var y=dy,w=e1(r.containerInfo),j=y.focusedElem,F=y.selectionRange;if(w!==j&&j&&j.ownerDocument&&Z0(j.ownerDocument.documentElement,j)){if(F!==null&&Lp(j)){var ce=F.start,Se=F.end;if(Se===void 0&&(Se=ce),"selectionStart"in j)j.selectionStart=ce,j.selectionEnd=Math.min(Se,j.value.length);else{var Pe=j.ownerDocument||document,de=Pe&&Pe.defaultView||window;if(de.getSelection){var ye=de.getSelection(),mt=j.textContent.length,Vt=Math.min(F.start,mt),Zn=F.end===void 0?Vt:Math.min(F.end,mt);!ye.extend&&Vt>Zn&&(w=Zn,Zn=Vt,Vt=w);var J=J0(j,Vt),G=J0(j,Zn);if(J&&G&&(ye.rangeCount!==1||ye.anchorNode!==J.node||ye.anchorOffset!==J.offset||ye.focusNode!==G.node||ye.focusOffset!==G.offset)){var le=Pe.createRange();le.setStart(J.node,J.offset),ye.removeAllRanges(),Vt>Zn?(ye.addRange(le),ye.extend(G.node,G.offset)):(le.setEnd(G.node,G.offset),ye.addRange(le))}}}}for(Pe=[],ye=j;ye=ye.parentNode;)ye.nodeType===1&&Pe.push({element:ye,left:ye.scrollLeft,top:ye.scrollTop});for(typeof j.focus=="function"&&j.focus(),j=0;j<Pe.length;j++){var Ae=Pe[j];Ae.element.scrollLeft=Ae.left,Ae.element.scrollTop=Ae.top}}Vf=!!uy,dy=uy=null}finally{Fn=p,ge.p=d,$.T=l}}r.current=i,Xs=2}}function p_(){if(Xs===2){Xs=0;var r=oo,i=kc,l=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||l){l=$.T,$.T=null;var d=ge.p;ge.p=2;var p=Fn;Fn|=4;try{qx(r,i.alternate,i)}finally{Fn=p,ge.p=d,$.T=l}}Xs=3}}function g_(){if(Xs===4||Xs===3){Xs=0,Dt();var r=oo,i=kc,l=ka,d=n_;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?Xs=5:(Xs=0,kc=oo=null,y_(r,r.pendingLanes));var p=r.pendingLanes;if(p===0&&(ao=null),_e(l),i=i.stateNode,Fe&&typeof Fe.onCommitFiberRoot=="function")try{Fe.onCommitFiberRoot(nt,i,void 0,(i.current.flags&128)===128)}catch{}if(d!==null){i=$.T,p=ge.p,ge.p=2,$.T=null;try{for(var y=r.onRecoverableError,w=0;w<d.length;w++){var j=d[w];y(j.value,{componentStack:j.stack})}}finally{$.T=i,ge.p=p}}(ka&3)!==0&&Ef(),Gi(r),p=r.pendingLanes,(l&261930)!==0&&(p&42)!==0?r===Xg?od++:(od=0,Xg=r):od=0,ld(0)}}function y_(r,i){(r.pooledCacheLanes&=i)===0&&(i=r.pooledCache,i!=null&&(r.pooledCache=null,zu(i)))}function Ef(){return m_(),p_(),g_(),b_()}function b_(){if(Xs!==5)return!1;var r=oo,i=Qg;Qg=0;var l=_e(ka),d=$.T,p=ge.p;try{ge.p=32>l?32:l,$.T=null,l=Yg,Yg=null;var y=oo,w=ka;if(Xs=0,kc=oo=null,ka=0,(Fn&6)!==0)throw Error(s(331));var j=Fn;if(Fn|=4,Zx(y.current),Yx(y,y.current,w,l),Fn=j,ld(0,!1),Fe&&typeof Fe.onPostCommitFiberRoot=="function")try{Fe.onPostCommitFiberRoot(nt,y)}catch{}return!0}finally{ge.p=p,$.T=d,y_(r,i)}}function v_(r,i,l){i=hi(l,i),i=Cg(r.stateNode,i,2),r=eo(r,i,2),r!==null&&(Ln(r,2),Gi(r))}function Gn(r,i,l){if(r.tag===3)v_(r,r,l);else for(;i!==null;){if(i.tag===3){v_(i,r,l);break}else if(i.tag===1){var d=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(ao===null||!ao.has(d))){r=hi(l,r),l=xx(2),d=eo(i,l,2),d!==null&&(_x(l,d,i,r),Ln(d,2),Gi(d));break}}i=i.return}}function ey(r,i,l){var d=r.pingCache;if(d===null){d=r.pingCache=new WN;var p=new Set;d.set(i,p)}else p=d.get(i),p===void 0&&(p=new Set,d.set(i,p));p.has(l)||(Wg=!0,p.add(l),r=XN.bind(null,r,i,l),i.then(r,r))}function XN(r,i,l){var d=r.pingCache;d!==null&&d.delete(i),r.pingedLanes|=r.suspendedLanes&l,r.warmLanes&=~l,ss===r&&(xn&l)===l&&(Cs===4||Cs===3&&(xn&62914560)===xn&&300>un()-vf?(Fn&2)===0&&Ec(r,0):Gg|=l,Tc===xn&&(Tc=0)),Gi(r)}function x_(r,i){i===0&&(i=Zt()),r=sl(r,i),r!==null&&(Ln(r,i),Gi(r))}function JN(r){var i=r.memoizedState,l=0;i!==null&&(l=i.retryLane),x_(r,l)}function ZN(r,i){var l=0;switch(r.tag){case 31:case 13:var d=r.stateNode,p=r.memoizedState;p!==null&&(l=p.retryLane);break;case 19:d=r.stateNode;break;case 22:d=r.stateNode._retryCache;break;default:throw Error(s(314))}d!==null&&d.delete(i),x_(r,l)}function eC(r,i){return tt(r,i)}var Sf=null,jc=null,ty=!1,jf=!1,ny=!1,co=0;function Gi(r){r!==jc&&r.next===null&&(jc===null?Sf=jc=r:jc=jc.next=r),jf=!0,ty||(ty=!0,nC())}function ld(r,i){if(!ny&&jf){ny=!0;do for(var l=!1,d=Sf;d!==null;){if(r!==0){var p=d.pendingLanes;if(p===0)var y=0;else{var w=d.suspendedLanes,j=d.pingedLanes;y=(1<<31-qe(42|r)+1)-1,y&=p&~(w&~j),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(l=!0,k_(d,y))}else y=xn,y=Lt(d,d===ss?y:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(y&3)===0||Ct(d,y)||(l=!0,k_(d,y));d=d.next}while(l);ny=!1}}function tC(){__()}function __(){jf=ty=!1;var r=0;co!==0&&hC()&&(r=co);for(var i=un(),l=null,d=Sf;d!==null;){var p=d.next,y=w_(d,i);y===0?(d.next=null,l===null?Sf=p:l.next=p,p===null&&(jc=l)):(l=d,(r!==0||(y&3)!==0)&&(jf=!0)),d=p}Xs!==0&&Xs!==5||ld(r),co!==0&&(co=0)}function w_(r,i){for(var l=r.suspendedLanes,d=r.pingedLanes,p=r.expirationTimes,y=r.pendingLanes&-62914561;0<y;){var w=31-qe(y),j=1<<w,F=p[w];F===-1?((j&l)===0||(j&d)!==0)&&(p[w]=an(j,i)):F<=i&&(r.expiredLanes|=j),y&=~j}if(i=ss,l=xn,l=Lt(r,r===i?l:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),d=r.callbackNode,l===0||r===i&&(Wn===2||Wn===9)||r.cancelPendingCommit!==null)return d!==null&&d!==null&&Ft(d),r.callbackNode=null,r.callbackPriority=0;if((l&3)===0||Ct(r,l)){if(i=l&-l,i===r.callbackPriority)return i;switch(d!==null&&Ft(d),_e(l)){case 2:case 8:l=Mn;break;case 32:l=dn;break;case 268435456:l=he;break;default:l=dn}return d=T_.bind(null,r),l=tt(l,d),r.callbackPriority=i,r.callbackNode=l,i}return d!==null&&d!==null&&Ft(d),r.callbackPriority=2,r.callbackNode=null,2}function T_(r,i){if(Xs!==0&&Xs!==5)return r.callbackNode=null,r.callbackPriority=0,null;var l=r.callbackNode;if(Ef()&&r.callbackNode!==l)return null;var d=xn;return d=Lt(r,r===ss?d:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),d===0?null:(r_(r,d,i),w_(r,un()),r.callbackNode!=null&&r.callbackNode===l?T_.bind(null,r):null)}function k_(r,i){if(Ef())return null;r_(r,i,!0)}function nC(){mC(function(){(Fn&6)!==0?tt(Yt,tC):__()})}function sy(){if(co===0){var r=hc;r===0&&(r=Jt,Jt<<=1,(Jt&261888)===0&&(Jt=256)),co=r}return co}function E_(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:Pr(""+r)}function S_(r,i){var l=i.ownerDocument.createElement("input");return l.name=i.name,l.value=i.value,r.id&&l.setAttribute("form",r.id),i.parentNode.insertBefore(l,i),r=new FormData(r),l.parentNode.removeChild(l),r}function sC(r,i,l,d,p){if(i==="submit"&&l&&l.stateNode===p){var y=E_((p[It]||null).action),w=d.submitter;w&&(i=(i=w[It]||null)?E_(i.formAction):w.getAttribute("formAction"),i!==null&&(y=i,w=null));var j=new Ss("action","action",null,d,p);r.push({event:j,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(co!==0){var F=w?S_(p,w):new FormData(p);Tg(l,{pending:!0,data:F,method:p.method,action:y},null,F)}}else typeof y=="function"&&(j.preventDefault(),F=w?S_(p,w):new FormData(p),Tg(l,{pending:!0,data:F,method:p.method,action:y},y,F))},currentTarget:p}]})}}for(var ry=0;ry<Up.length;ry++){var iy=Up[ry],rC=iy.toLowerCase(),iC=iy[0].toUpperCase()+iy.slice(1);Ni(rC,"on"+iC)}Ni(s1,"onAnimationEnd"),Ni(r1,"onAnimationIteration"),Ni(i1,"onAnimationStart"),Ni("dblclick","onDoubleClick"),Ni("focusin","onFocus"),Ni("focusout","onBlur"),Ni(_N,"onTransitionRun"),Ni(wN,"onTransitionStart"),Ni(TN,"onTransitionCancel"),Ni(a1,"onTransitionEnd"),$e("onMouseEnter",["mouseout","mouseover"]),$e("onMouseLeave",["mouseout","mouseover"]),$e("onPointerEnter",["pointerout","pointerover"]),$e("onPointerLeave",["pointerout","pointerover"]),Ye("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ye("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ye("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ye("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ye("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ye("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var cd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),aC=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(cd));function j_(r,i){i=(i&4)!==0;for(var l=0;l<r.length;l++){var d=r[l],p=d.event;d=d.listeners;e:{var y=void 0;if(i)for(var w=d.length-1;0<=w;w--){var j=d[w],F=j.instance,ce=j.currentTarget;if(j=j.listener,F!==y&&p.isPropagationStopped())break e;y=j,p.currentTarget=ce;try{y(p)}catch(Se){Fh(Se)}p.currentTarget=null,y=F}else for(w=0;w<d.length;w++){if(j=d[w],F=j.instance,ce=j.currentTarget,j=j.listener,F!==y&&p.isPropagationStopped())break e;y=j,p.currentTarget=ce;try{y(p)}catch(Se){Fh(Se)}p.currentTarget=null,y=F}}}}function gn(r,i){var l=i[Tt];l===void 0&&(l=i[Tt]=new Set);var d=r+"__bubble";l.has(d)||(N_(i,r,2,!1),l.add(d))}function ay(r,i,l){var d=0;i&&(d|=4),N_(l,r,d,i)}var Nf="_reactListening"+Math.random().toString(36).slice(2);function oy(r){if(!r[Nf]){r[Nf]=!0,K.forEach(function(l){l!=="selectionchange"&&(aC.has(l)||ay(l,!1,r),ay(l,!0,r))});var i=r.nodeType===9?r:r.ownerDocument;i===null||i[Nf]||(i[Nf]=!0,ay("selectionchange",!1,i))}}function N_(r,i,l,d){switch(sw(i)){case 2:var p=PC;break;case 8:p=MC;break;default:p=wy}l=p.bind(null,i,l,r),p=void 0,!te||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(p=!0),d?p!==void 0?r.addEventListener(i,l,{capture:!0,passive:p}):r.addEventListener(i,l,!0):p!==void 0?r.addEventListener(i,l,{passive:p}):r.addEventListener(i,l,!1)}function ly(r,i,l,d,p){var y=d;if((i&1)===0&&(i&2)===0&&d!==null)e:for(;;){if(d===null)return;var w=d.tag;if(w===3||w===4){var j=d.stateNode.containerInfo;if(j===p)break;if(w===4)for(w=d.return;w!==null;){var F=w.tag;if((F===3||F===4)&&w.stateNode.containerInfo===p)return;w=w.return}for(;j!==null;){if(w=ns(j),w===null)return;if(F=w.tag,F===5||F===6||F===26||F===27){d=y=w;continue e}j=j.parentNode}}d=d.return}zi(function(){var ce=y,Se=Us(l),Pe=[];e:{var de=o1.get(r);if(de!==void 0){var ye=Ss,mt=r;switch(r){case"keypress":if(Gt(l)===0)break e;case"keydown":case"keyup":ye=Oh;break;case"focusin":mt="focus",ye=js;break;case"focusout":mt="blur",ye=js;break;case"beforeblur":case"afterblur":ye=js;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ye=br;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ye=Er;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ye=v;break;case s1:case r1:case i1:ye=Vr;break;case a1:ye=R;break;case"scroll":case"scrollend":ye=qn;break;case"wheel":ye=pe;break;case"copy":case"cut":case"paste":ye=ec;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ye=ua;break;case"toggle":case"beforetoggle":ye=sn}var Vt=(i&4)!==0,Zn=!Vt&&(r==="scroll"||r==="scrollend"),J=Vt?de!==null?de+"Capture":null:de;Vt=[];for(var G=ce,le;G!==null;){var Ae=G;if(le=Ae.stateNode,Ae=Ae.tag,Ae!==5&&Ae!==26&&Ae!==27||le===null||J===null||(Ae=Kr(G,J),Ae!=null&&Vt.push(ud(G,Ae,le))),Zn)break;G=G.return}0<Vt.length&&(de=new ye(de,mt,null,l,Se),Pe.push({event:de,listeners:Vt}))}}if((i&7)===0){e:{if(de=r==="mouseover"||r==="pointerover",ye=r==="mouseout"||r==="pointerout",de&&l!==Ks&&(mt=l.relatedTarget||l.fromElement)&&(ns(mt)||mt[ut]))break e;if((ye||de)&&(de=Se.window===Se?Se:(de=Se.ownerDocument)?de.defaultView||de.parentWindow:window,ye?(mt=l.relatedTarget||l.toElement,ye=ce,mt=mt?ns(mt):null,mt!==null&&(Zn=c(mt),Vt=mt.tag,mt!==Zn||Vt!==5&&Vt!==27&&Vt!==6)&&(mt=null)):(ye=null,mt=ce),ye!==mt)){if(Vt=br,Ae="onMouseLeave",J="onMouseEnter",G="mouse",(r==="pointerout"||r==="pointerover")&&(Vt=ua,Ae="onPointerLeave",J="onPointerEnter",G="pointer"),Zn=ye==null?de:me(ye),le=mt==null?de:me(mt),de=new Vt(Ae,G+"leave",ye,l,Se),de.target=Zn,de.relatedTarget=le,Ae=null,ns(Se)===ce&&(Vt=new Vt(J,G+"enter",mt,l,Se),Vt.target=le,Vt.relatedTarget=Zn,Ae=Vt),Zn=Ae,ye&&mt)t:{for(Vt=oC,J=ye,G=mt,le=0,Ae=J;Ae;Ae=Vt(Ae))le++;Ae=0;for(var Rt=G;Rt;Rt=Vt(Rt))Ae++;for(;0<le-Ae;)J=Vt(J),le--;for(;0<Ae-le;)G=Vt(G),Ae--;for(;le--;){if(J===G||G!==null&&J===G.alternate){Vt=J;break t}J=Vt(J),G=Vt(G)}Vt=null}else Vt=null;ye!==null&&C_(Pe,de,ye,Vt,!1),mt!==null&&Zn!==null&&C_(Pe,Zn,mt,Vt,!0)}}e:{if(de=ce?me(ce):window,ye=de.nodeName&&de.nodeName.toLowerCase(),ye==="select"||ye==="input"&&de.type==="file")var Vn=W0;else if(H0(de))if(G0)Vn=bN;else{Vn=gN;var xt=pN}else ye=de.nodeName,!ye||ye.toLowerCase()!=="input"||de.type!=="checkbox"&&de.type!=="radio"?ce&&ws(ce.elementType)&&(Vn=W0):Vn=yN;if(Vn&&(Vn=Vn(r,ce))){$0(Pe,Vn,l,Se);break e}xt&&xt(r,de,ce),r==="focusout"&&ce&&de.type==="number"&&ce.memoizedProps.value!=null&&_s(de,"number",de.value)}switch(xt=ce?me(ce):window,r){case"focusin":(H0(xt)||xt.contentEditable==="true")&&(rc=xt,Vp=ce,Bu=null);break;case"focusout":Bu=Vp=rc=null;break;case"mousedown":Op=!0;break;case"contextmenu":case"mouseup":case"dragend":Op=!1,t1(Pe,l,Se);break;case"selectionchange":if(xN)break;case"keydown":case"keyup":t1(Pe,l,Se)}var ln;if(Un)e:{switch(r){case"compositionstart":var _n="onCompositionStart";break e;case"compositionend":_n="onCompositionEnd";break e;case"compositionupdate":_n="onCompositionUpdate";break e}_n=void 0}else sc?el(r,l)&&(_n="onCompositionEnd"):r==="keydown"&&l.keyCode===229&&(_n="onCompositionStart");_n&&(qi&&l.locale!=="ko"&&(sc||_n!=="onCompositionStart"?_n==="onCompositionEnd"&&sc&&(ln=ot()):(st=Se,jt="value"in st?st.value:st.textContent,sc=!0)),xt=Cf(ce,_n),0<xt.length&&(_n=new jr(_n,r,null,l,Se),Pe.push({event:_n,listeners:xt}),ln?_n.data=ln:(ln=nc(l),ln!==null&&(_n.data=ln)))),(ln=ui?dN(r,l):hN(r,l))&&(_n=Cf(ce,"onBeforeInput"),0<_n.length&&(xt=new jr("onBeforeInput","beforeinput",null,l,Se),Pe.push({event:xt,listeners:_n}),xt.data=ln)),sC(Pe,r,ce,l,Se)}j_(Pe,i)})}function ud(r,i,l){return{instance:r,listener:i,currentTarget:l}}function Cf(r,i){for(var l=i+"Capture",d=[];r!==null;){var p=r,y=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||y===null||(p=Kr(r,l),p!=null&&d.unshift(ud(r,p,y)),p=Kr(r,i),p!=null&&d.push(ud(r,p,y))),r.tag===3)return d;r=r.return}return[]}function oC(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function C_(r,i,l,d,p){for(var y=i._reactName,w=[];l!==null&&l!==d;){var j=l,F=j.alternate,ce=j.stateNode;if(j=j.tag,F!==null&&F===d)break;j!==5&&j!==26&&j!==27||ce===null||(F=ce,p?(ce=Kr(l,y),ce!=null&&w.unshift(ud(l,ce,F))):p||(ce=Kr(l,y),ce!=null&&w.push(ud(l,ce,F)))),l=l.return}w.length!==0&&r.push({event:i,listeners:w})}var lC=/\r\n?/g,cC=/\u0000|\uFFFD/g;function A_(r){return(typeof r=="string"?r:""+r).replace(lC,`
`).replace(cC,"")}function R_(r,i){return i=A_(i),A_(r)===i}function Jn(r,i,l,d,p,y){switch(l){case"children":typeof d=="string"?i==="body"||i==="textarea"&&d===""||Es(r,d):(typeof d=="number"||typeof d=="bigint")&&i!=="body"&&Es(r,""+d);break;case"className":Bs(r,"class",d);break;case"tabIndex":Bs(r,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":Bs(r,l,d);break;case"style":cn(r,d,y);break;case"data":if(i!=="object"){Bs(r,"data",d);break}case"src":case"href":if(d===""&&(i!=="a"||l!=="href")){r.removeAttribute(l);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){r.removeAttribute(l);break}d=Pr(""+d),r.setAttribute(l,d);break;case"action":case"formAction":if(typeof d=="function"){r.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(l==="formAction"?(i!=="input"&&Jn(r,i,"name",p.name,p,null),Jn(r,i,"formEncType",p.formEncType,p,null),Jn(r,i,"formMethod",p.formMethod,p,null),Jn(r,i,"formTarget",p.formTarget,p,null)):(Jn(r,i,"encType",p.encType,p,null),Jn(r,i,"method",p.method,p,null),Jn(r,i,"target",p.target,p,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){r.removeAttribute(l);break}d=Pr(""+d),r.setAttribute(l,d);break;case"onClick":d!=null&&(r.onclick=ls);break;case"onScroll":d!=null&&gn("scroll",r);break;case"onScrollEnd":d!=null&&gn("scrollend",r);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(s(61));if(l=d.__html,l!=null){if(p.children!=null)throw Error(s(60));r.innerHTML=l}}break;case"multiple":r.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":r.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){r.removeAttribute("xlink:href");break}l=Pr(""+d),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(l,""+d):r.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(l,""):r.removeAttribute(l);break;case"capture":case"download":d===!0?r.setAttribute(l,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(l,d):r.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?r.setAttribute(l,d):r.removeAttribute(l);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?r.removeAttribute(l):r.setAttribute(l,d);break;case"popover":gn("beforetoggle",r),gn("toggle",r),Gs(r,"popover",d);break;case"xlinkActuate":Hn(r,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":Hn(r,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":Hn(r,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":Hn(r,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":Hn(r,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":Hn(r,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":Hn(r,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":Hn(r,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":Hn(r,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":Gs(r,"is",d);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=yr.get(l)||l,Gs(r,l,d))}}function cy(r,i,l,d,p,y){switch(l){case"style":cn(r,d,y);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(s(61));if(l=d.__html,l!=null){if(p.children!=null)throw Error(s(60));r.innerHTML=l}}break;case"children":typeof d=="string"?Es(r,d):(typeof d=="number"||typeof d=="bigint")&&Es(r,""+d);break;case"onScroll":d!=null&&gn("scroll",r);break;case"onScrollEnd":d!=null&&gn("scrollend",r);break;case"onClick":d!=null&&(r.onclick=ls);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!oe.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(p=l.endsWith("Capture"),i=l.slice(2,p?l.length-7:void 0),y=r[It]||null,y=y!=null?y[l]:null,typeof y=="function"&&r.removeEventListener(i,y,p),typeof d=="function")){typeof y!="function"&&y!==null&&(l in r?r[l]=null:r.hasAttribute(l)&&r.removeAttribute(l)),r.addEventListener(i,d,p);break e}l in r?r[l]=d:d===!0?r.setAttribute(l,""):Gs(r,l,d)}}}function pr(r,i,l){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":gn("error",r),gn("load",r);var d=!1,p=!1,y;for(y in l)if(l.hasOwnProperty(y)){var w=l[y];if(w!=null)switch(y){case"src":d=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,i));default:Jn(r,i,y,w,l,null)}}p&&Jn(r,i,"srcSet",l.srcSet,l,null),d&&Jn(r,i,"src",l.src,l,null);return;case"input":gn("invalid",r);var j=y=w=p=null,F=null,ce=null;for(d in l)if(l.hasOwnProperty(d)){var Se=l[d];if(Se!=null)switch(d){case"name":p=Se;break;case"type":w=Se;break;case"checked":F=Se;break;case"defaultChecked":ce=Se;break;case"value":y=Se;break;case"defaultValue":j=Se;break;case"children":case"dangerouslySetInnerHTML":if(Se!=null)throw Error(s(137,i));break;default:Jn(r,i,d,Se,l,null)}}kn(r,y,j,F,ce,w,p,!1);return;case"select":gn("invalid",r),d=w=y=null;for(p in l)if(l.hasOwnProperty(p)&&(j=l[p],j!=null))switch(p){case"value":y=j;break;case"defaultValue":w=j;break;case"multiple":d=j;default:Jn(r,i,p,j,l,null)}i=y,l=w,r.multiple=!!d,i!=null?vn(r,!!d,i,!1):l!=null&&vn(r,!!d,l,!0);return;case"textarea":gn("invalid",r),y=p=d=null;for(w in l)if(l.hasOwnProperty(w)&&(j=l[w],j!=null))switch(w){case"value":d=j;break;case"defaultValue":p=j;break;case"children":y=j;break;case"dangerouslySetInnerHTML":if(j!=null)throw Error(s(91));break;default:Jn(r,i,w,j,l,null)}ci(r,d,p,y);return;case"option":for(F in l)l.hasOwnProperty(F)&&(d=l[F],d!=null)&&(F==="selected"?r.selected=d&&typeof d!="function"&&typeof d!="symbol":Jn(r,i,F,d,l,null));return;case"dialog":gn("beforetoggle",r),gn("toggle",r),gn("cancel",r),gn("close",r);break;case"iframe":case"object":gn("load",r);break;case"video":case"audio":for(d=0;d<cd.length;d++)gn(cd[d],r);break;case"image":gn("error",r),gn("load",r);break;case"details":gn("toggle",r);break;case"embed":case"source":case"link":gn("error",r),gn("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ce in l)if(l.hasOwnProperty(ce)&&(d=l[ce],d!=null))switch(ce){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,i));default:Jn(r,i,ce,d,l,null)}return;default:if(ws(i)){for(Se in l)l.hasOwnProperty(Se)&&(d=l[Se],d!==void 0&&cy(r,i,Se,d,l,void 0));return}}for(j in l)l.hasOwnProperty(j)&&(d=l[j],d!=null&&Jn(r,i,j,d,l,null))}function uC(r,i,l,d){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,y=null,w=null,j=null,F=null,ce=null,Se=null;for(ye in l){var Pe=l[ye];if(l.hasOwnProperty(ye)&&Pe!=null)switch(ye){case"checked":break;case"value":break;case"defaultValue":F=Pe;default:d.hasOwnProperty(ye)||Jn(r,i,ye,null,d,Pe)}}for(var de in d){var ye=d[de];if(Pe=l[de],d.hasOwnProperty(de)&&(ye!=null||Pe!=null))switch(de){case"type":y=ye;break;case"name":p=ye;break;case"checked":ce=ye;break;case"defaultChecked":Se=ye;break;case"value":w=ye;break;case"defaultValue":j=ye;break;case"children":case"dangerouslySetInnerHTML":if(ye!=null)throw Error(s(137,i));break;default:ye!==Pe&&Jn(r,i,de,ye,d,Pe)}}Bt(r,w,j,F,ce,Se,y,p);return;case"select":ye=w=j=de=null;for(y in l)if(F=l[y],l.hasOwnProperty(y)&&F!=null)switch(y){case"value":break;case"multiple":ye=F;default:d.hasOwnProperty(y)||Jn(r,i,y,null,d,F)}for(p in d)if(y=d[p],F=l[p],d.hasOwnProperty(p)&&(y!=null||F!=null))switch(p){case"value":de=y;break;case"defaultValue":j=y;break;case"multiple":w=y;default:y!==F&&Jn(r,i,p,y,d,F)}i=j,l=w,d=ye,de!=null?vn(r,!!l,de,!1):!!d!=!!l&&(i!=null?vn(r,!!l,i,!0):vn(r,!!l,l?[]:"",!1));return;case"textarea":ye=de=null;for(j in l)if(p=l[j],l.hasOwnProperty(j)&&p!=null&&!d.hasOwnProperty(j))switch(j){case"value":break;case"children":break;default:Jn(r,i,j,null,d,p)}for(w in d)if(p=d[w],y=l[w],d.hasOwnProperty(w)&&(p!=null||y!=null))switch(w){case"value":de=p;break;case"defaultValue":ye=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(s(91));break;default:p!==y&&Jn(r,i,w,p,d,y)}cr(r,de,ye);return;case"option":for(var mt in l)de=l[mt],l.hasOwnProperty(mt)&&de!=null&&!d.hasOwnProperty(mt)&&(mt==="selected"?r.selected=!1:Jn(r,i,mt,null,d,de));for(F in d)de=d[F],ye=l[F],d.hasOwnProperty(F)&&de!==ye&&(de!=null||ye!=null)&&(F==="selected"?r.selected=de&&typeof de!="function"&&typeof de!="symbol":Jn(r,i,F,de,d,ye));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Vt in l)de=l[Vt],l.hasOwnProperty(Vt)&&de!=null&&!d.hasOwnProperty(Vt)&&Jn(r,i,Vt,null,d,de);for(ce in d)if(de=d[ce],ye=l[ce],d.hasOwnProperty(ce)&&de!==ye&&(de!=null||ye!=null))switch(ce){case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(s(137,i));break;default:Jn(r,i,ce,de,d,ye)}return;default:if(ws(i)){for(var Zn in l)de=l[Zn],l.hasOwnProperty(Zn)&&de!==void 0&&!d.hasOwnProperty(Zn)&&cy(r,i,Zn,void 0,d,de);for(Se in d)de=d[Se],ye=l[Se],!d.hasOwnProperty(Se)||de===ye||de===void 0&&ye===void 0||cy(r,i,Se,de,d,ye);return}}for(var J in l)de=l[J],l.hasOwnProperty(J)&&de!=null&&!d.hasOwnProperty(J)&&Jn(r,i,J,null,d,de);for(Pe in d)de=d[Pe],ye=l[Pe],!d.hasOwnProperty(Pe)||de===ye||de==null&&ye==null||Jn(r,i,Pe,de,d,ye)}function I_(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function dC(){if(typeof performance.getEntriesByType=="function"){for(var r=0,i=0,l=performance.getEntriesByType("resource"),d=0;d<l.length;d++){var p=l[d],y=p.transferSize,w=p.initiatorType,j=p.duration;if(y&&j&&I_(w)){for(w=0,j=p.responseEnd,d+=1;d<l.length;d++){var F=l[d],ce=F.startTime;if(ce>j)break;var Se=F.transferSize,Pe=F.initiatorType;Se&&I_(Pe)&&(F=F.responseEnd,w+=Se*(F<j?1:(j-ce)/(F-ce)))}if(--d,i+=8*(y+w)/(p.duration/1e3),r++,10<r)break}}if(0<r)return i/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var uy=null,dy=null;function Af(r){return r.nodeType===9?r:r.ownerDocument}function D_(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function P_(r,i){if(r===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&i==="foreignObject"?0:r}function hy(r,i){return r==="textarea"||r==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var fy=null;function hC(){var r=window.event;return r&&r.type==="popstate"?r===fy?!1:(fy=r,!0):(fy=null,!1)}var M_=typeof setTimeout=="function"?setTimeout:void 0,fC=typeof clearTimeout=="function"?clearTimeout:void 0,L_=typeof Promise=="function"?Promise:void 0,mC=typeof queueMicrotask=="function"?queueMicrotask:typeof L_<"u"?function(r){return L_.resolve(null).then(r).catch(pC)}:M_;function pC(r){setTimeout(function(){throw r})}function uo(r){return r==="head"}function V_(r,i){var l=i,d=0;do{var p=l.nextSibling;if(r.removeChild(l),p&&p.nodeType===8)if(l=p.data,l==="/$"||l==="/&"){if(d===0){r.removeChild(p),Rc(i);return}d--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")d++;else if(l==="html")dd(r.ownerDocument.documentElement);else if(l==="head"){l=r.ownerDocument.head,dd(l);for(var y=l.firstChild;y;){var w=y.nextSibling,j=y.nodeName;y[ks]||j==="SCRIPT"||j==="STYLE"||j==="LINK"&&y.rel.toLowerCase()==="stylesheet"||l.removeChild(y),y=w}}else l==="body"&&dd(r.ownerDocument.body);l=p}while(l);Rc(i)}function O_(r,i){var l=r;r=0;do{var d=l.nextSibling;if(l.nodeType===1?i?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(i?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),d&&d.nodeType===8)if(l=d.data,l==="/$"){if(r===0)break;r--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||r++;l=d}while(l)}function my(r){var i=r.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var l=i;switch(i=i.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":my(l),Ds(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}r.removeChild(l)}}function gC(r,i,l,d){for(;r.nodeType===1;){var p=l;if(r.nodeName.toLowerCase()!==i.toLowerCase()){if(!d&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(d){if(!r[ks])switch(i){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(y=r.getAttribute("rel"),y==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(y!==p.rel||r.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||r.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||r.getAttribute("title")!==(p.title==null?null:p.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(y=r.getAttribute("src"),(y!==(p.src==null?null:p.src)||r.getAttribute("type")!==(p.type==null?null:p.type)||r.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&y&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(i==="input"&&r.type==="hidden"){var y=p.name==null?null:""+p.name;if(p.type==="hidden"&&r.getAttribute("name")===y)return r}else return r;if(r=yi(r.nextSibling),r===null)break}return null}function yC(r,i,l){if(i==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!l||(r=yi(r.nextSibling),r===null))return null;return r}function B_(r,i){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!i||(r=yi(r.nextSibling),r===null))return null;return r}function py(r){return r.data==="$?"||r.data==="$~"}function gy(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function bC(r,i){var l=r.ownerDocument;if(r.data==="$~")r._reactRetry=i;else if(r.data!=="$?"||l.readyState!=="loading")i();else{var d=function(){i(),l.removeEventListener("DOMContentLoaded",d)};l.addEventListener("DOMContentLoaded",d),r._reactRetry=d}}function yi(r){for(;r!=null;r=r.nextSibling){var i=r.nodeType;if(i===1||i===3)break;if(i===8){if(i=r.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return r}var yy=null;function U_(r){r=r.nextSibling;for(var i=0;r;){if(r.nodeType===8){var l=r.data;if(l==="/$"||l==="/&"){if(i===0)return yi(r.nextSibling);i--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||i++}r=r.nextSibling}return null}function F_(r){r=r.previousSibling;for(var i=0;r;){if(r.nodeType===8){var l=r.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(i===0)return r;i--}else l!=="/$"&&l!=="/&"||i++}r=r.previousSibling}return null}function z_(r,i,l){switch(i=Af(l),r){case"html":if(r=i.documentElement,!r)throw Error(s(452));return r;case"head":if(r=i.head,!r)throw Error(s(453));return r;case"body":if(r=i.body,!r)throw Error(s(454));return r;default:throw Error(s(451))}}function dd(r){for(var i=r.attributes;i.length;)r.removeAttributeNode(i[0]);Ds(r)}var bi=new Map,q_=new Set;function Rf(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Ea=ge.d;ge.d={f:vC,r:xC,D:_C,C:wC,L:TC,m:kC,X:SC,S:EC,M:jC};function vC(){var r=Ea.f(),i=wf();return r||i}function xC(r){var i=W(r);i!==null&&i.tag===5&&i.type==="form"?ax(i):Ea.r(r)}var Nc=typeof document>"u"?null:document;function H_(r,i,l){var d=Nc;if(d&&typeof i=="string"&&i){var p=kt(i);p='link[rel="'+r+'"][href="'+p+'"]',typeof l=="string"&&(p+='[crossorigin="'+l+'"]'),q_.has(p)||(q_.add(p),r={rel:r,crossOrigin:l,href:i},d.querySelector(p)===null&&(i=d.createElement("link"),pr(i,"link",r),A(i),d.head.appendChild(i)))}}function _C(r){Ea.D(r),H_("dns-prefetch",r,null)}function wC(r,i){Ea.C(r,i),H_("preconnect",r,i)}function TC(r,i,l){Ea.L(r,i,l);var d=Nc;if(d&&r&&i){var p='link[rel="preload"][as="'+kt(i)+'"]';i==="image"&&l&&l.imageSrcSet?(p+='[imagesrcset="'+kt(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(p+='[imagesizes="'+kt(l.imageSizes)+'"]')):p+='[href="'+kt(r)+'"]';var y=p;switch(i){case"style":y=Cc(r);break;case"script":y=Ac(r)}bi.has(y)||(r=x({rel:"preload",href:i==="image"&&l&&l.imageSrcSet?void 0:r,as:i},l),bi.set(y,r),d.querySelector(p)!==null||i==="style"&&d.querySelector(hd(y))||i==="script"&&d.querySelector(fd(y))||(i=d.createElement("link"),pr(i,"link",r),A(i),d.head.appendChild(i)))}}function kC(r,i){Ea.m(r,i);var l=Nc;if(l&&r){var d=i&&typeof i.as=="string"?i.as:"script",p='link[rel="modulepreload"][as="'+kt(d)+'"][href="'+kt(r)+'"]',y=p;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=Ac(r)}if(!bi.has(y)&&(r=x({rel:"modulepreload",href:r},i),bi.set(y,r),l.querySelector(p)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(fd(y)))return}d=l.createElement("link"),pr(d,"link",r),A(d),l.head.appendChild(d)}}}function EC(r,i,l){Ea.S(r,i,l);var d=Nc;if(d&&r){var p=E(d).hoistableStyles,y=Cc(r);i=i||"default";var w=p.get(y);if(!w){var j={loading:0,preload:null};if(w=d.querySelector(hd(y)))j.loading=5;else{r=x({rel:"stylesheet",href:r,"data-precedence":i},l),(l=bi.get(y))&&by(r,l);var F=w=d.createElement("link");A(F),pr(F,"link",r),F._p=new Promise(function(ce,Se){F.onload=ce,F.onerror=Se}),F.addEventListener("load",function(){j.loading|=1}),F.addEventListener("error",function(){j.loading|=2}),j.loading|=4,If(w,i,d)}w={type:"stylesheet",instance:w,count:1,state:j},p.set(y,w)}}}function SC(r,i){Ea.X(r,i);var l=Nc;if(l&&r){var d=E(l).hoistableScripts,p=Ac(r),y=d.get(p);y||(y=l.querySelector(fd(p)),y||(r=x({src:r,async:!0},i),(i=bi.get(p))&&vy(r,i),y=l.createElement("script"),A(y),pr(y,"link",r),l.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},d.set(p,y))}}function jC(r,i){Ea.M(r,i);var l=Nc;if(l&&r){var d=E(l).hoistableScripts,p=Ac(r),y=d.get(p);y||(y=l.querySelector(fd(p)),y||(r=x({src:r,async:!0,type:"module"},i),(i=bi.get(p))&&vy(r,i),y=l.createElement("script"),A(y),pr(y,"link",r),l.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},d.set(p,y))}}function $_(r,i,l,d){var p=(p=ze.current)?Rf(p):null;if(!p)throw Error(s(446));switch(r){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(i=Cc(l.href),l=E(p).hoistableStyles,d=l.get(i),d||(d={type:"style",instance:null,count:0,state:null},l.set(i,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){r=Cc(l.href);var y=E(p).hoistableStyles,w=y.get(r);if(w||(p=p.ownerDocument||p,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(r,w),(y=p.querySelector(hd(r)))&&!y._p&&(w.instance=y,w.state.loading=5),bi.has(r)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},bi.set(r,l),y||NC(p,r,l,w.state))),i&&d===null)throw Error(s(528,""));return w}if(i&&d!==null)throw Error(s(529,""));return null;case"script":return i=l.async,l=l.src,typeof l=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Ac(l),l=E(p).hoistableScripts,d=l.get(i),d||(d={type:"script",instance:null,count:0,state:null},l.set(i,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,r))}}function Cc(r){return'href="'+kt(r)+'"'}function hd(r){return'link[rel="stylesheet"]['+r+"]"}function W_(r){return x({},r,{"data-precedence":r.precedence,precedence:null})}function NC(r,i,l,d){r.querySelector('link[rel="preload"][as="style"]['+i+"]")?d.loading=1:(i=r.createElement("link"),d.preload=i,i.addEventListener("load",function(){return d.loading|=1}),i.addEventListener("error",function(){return d.loading|=2}),pr(i,"link",l),A(i),r.head.appendChild(i))}function Ac(r){return'[src="'+kt(r)+'"]'}function fd(r){return"script[async]"+r}function G_(r,i,l){if(i.count++,i.instance===null)switch(i.type){case"style":var d=r.querySelector('style[data-href~="'+kt(l.href)+'"]');if(d)return i.instance=d,A(d),d;var p=x({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return d=(r.ownerDocument||r).createElement("style"),A(d),pr(d,"style",p),If(d,l.precedence,r),i.instance=d;case"stylesheet":p=Cc(l.href);var y=r.querySelector(hd(p));if(y)return i.state.loading|=4,i.instance=y,A(y),y;d=W_(l),(p=bi.get(p))&&by(d,p),y=(r.ownerDocument||r).createElement("link"),A(y);var w=y;return w._p=new Promise(function(j,F){w.onload=j,w.onerror=F}),pr(y,"link",d),i.state.loading|=4,If(y,l.precedence,r),i.instance=y;case"script":return y=Ac(l.src),(p=r.querySelector(fd(y)))?(i.instance=p,A(p),p):(d=l,(p=bi.get(y))&&(d=x({},l),vy(d,p)),r=r.ownerDocument||r,p=r.createElement("script"),A(p),pr(p,"link",d),r.head.appendChild(p),i.instance=p);case"void":return null;default:throw Error(s(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(d=i.instance,i.state.loading|=4,If(d,l.precedence,r));return i.instance}function If(r,i,l){for(var d=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=d.length?d[d.length-1]:null,y=p,w=0;w<d.length;w++){var j=d[w];if(j.dataset.precedence===i)y=j;else if(y!==p)break}y?y.parentNode.insertBefore(r,y.nextSibling):(i=l.nodeType===9?l.head:l,i.insertBefore(r,i.firstChild))}function by(r,i){r.crossOrigin==null&&(r.crossOrigin=i.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=i.referrerPolicy),r.title==null&&(r.title=i.title)}function vy(r,i){r.crossOrigin==null&&(r.crossOrigin=i.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=i.referrerPolicy),r.integrity==null&&(r.integrity=i.integrity)}var Df=null;function K_(r,i,l){if(Df===null){var d=new Map,p=Df=new Map;p.set(l,d)}else p=Df,d=p.get(l),d||(d=new Map,p.set(l,d));if(d.has(r))return d;for(d.set(r,null),l=l.getElementsByTagName(r),p=0;p<l.length;p++){var y=l[p];if(!(y[ks]||y[lt]||r==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var w=y.getAttribute(i)||"";w=r+w;var j=d.get(w);j?j.push(y):d.set(w,[y])}}return d}function Q_(r,i,l){r=r.ownerDocument||r,r.head.insertBefore(l,i==="title"?r.querySelector("head > title"):null)}function CC(r,i,l){if(l===1||i.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;return i.rel==="stylesheet"?(r=i.disabled,typeof i.precedence=="string"&&r==null):!0;case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function Y_(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function AC(r,i,l,d){if(l.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var p=Cc(d.href),y=i.querySelector(hd(p));if(y){i=y._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(r.count++,r=Pf.bind(r),i.then(r,r)),l.state.loading|=4,l.instance=y,A(y);return}y=i.ownerDocument||i,d=W_(d),(p=bi.get(p))&&by(d,p),y=y.createElement("link"),A(y);var w=y;w._p=new Promise(function(j,F){w.onload=j,w.onerror=F}),pr(y,"link",d),l.instance=y}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(l,i),(i=l.state.preload)&&(l.state.loading&3)===0&&(r.count++,l=Pf.bind(r),i.addEventListener("load",l),i.addEventListener("error",l))}}var xy=0;function RC(r,i){return r.stylesheets&&r.count===0&&Lf(r,r.stylesheets),0<r.count||0<r.imgCount?function(l){var d=setTimeout(function(){if(r.stylesheets&&Lf(r,r.stylesheets),r.unsuspend){var y=r.unsuspend;r.unsuspend=null,y()}},6e4+i);0<r.imgBytes&&xy===0&&(xy=62500*dC());var p=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&Lf(r,r.stylesheets),r.unsuspend)){var y=r.unsuspend;r.unsuspend=null,y()}},(r.imgBytes>xy?50:800)+i);return r.unsuspend=l,function(){r.unsuspend=null,clearTimeout(d),clearTimeout(p)}}:null}function Pf(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Lf(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var Mf=null;function Lf(r,i){r.stylesheets=null,r.unsuspend!==null&&(r.count++,Mf=new Map,i.forEach(IC,r),Mf=null,Pf.call(r))}function IC(r,i){if(!(i.state.loading&4)){var l=Mf.get(r);if(l)var d=l.get(null);else{l=new Map,Mf.set(r,l);for(var p=r.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<p.length;y++){var w=p[y];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(l.set(w.dataset.precedence,w),d=w)}d&&l.set(null,d)}p=i.instance,w=p.getAttribute("data-precedence"),y=l.get(w)||d,y===d&&l.set(null,p),l.set(w,p),this.count++,d=Pf.bind(this),p.addEventListener("load",d),p.addEventListener("error",d),y?y.parentNode.insertBefore(p,y.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(p,r.firstChild)),i.state.loading|=4}}var md={$$typeof:X,Provider:null,Consumer:null,_currentValue:Le,_currentValue2:Le,_threadCount:0};function DC(r,i,l,d,p,y,w,j,F){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Wt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Wt(0),this.hiddenUpdates=Wt(null),this.identifierPrefix=d,this.onUncaughtError=p,this.onCaughtError=y,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=F,this.incompleteTransitions=new Map}function X_(r,i,l,d,p,y,w,j,F,ce,Se,Pe){return r=new DC(r,i,l,w,F,ce,Se,Pe,j),i=1,y===!0&&(i|=24),y=Yr(3,null,null,i),r.current=y,y.stateNode=r,i=Zp(),i.refCount++,r.pooledCache=i,i.refCount++,y.memoizedState={element:d,isDehydrated:l,cache:i},sg(y),r}function J_(r){return r?(r=oc,r):oc}function Z_(r,i,l,d,p,y){p=J_(p),d.context===null?d.context=p:d.pendingContext=p,d=Za(i),d.payload={element:l},y=y===void 0?null:y,y!==null&&(d.callback=y),l=eo(r,d,i),l!==null&&(zr(l,r,i),Wu(l,r,i))}function ew(r,i){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var l=r.retryLane;r.retryLane=l!==0&&l<i?l:i}}function _y(r,i){ew(r,i),(r=r.alternate)&&ew(r,i)}function tw(r){if(r.tag===13||r.tag===31){var i=sl(r,67108864);i!==null&&zr(i,r,67108864),_y(r,67108864)}}function nw(r){if(r.tag===13||r.tag===31){var i=ti();i=z(i);var l=sl(r,i);l!==null&&zr(l,r,i),_y(r,i)}}var Vf=!0;function PC(r,i,l,d){var p=$.T;$.T=null;var y=ge.p;try{ge.p=2,wy(r,i,l,d)}finally{ge.p=y,$.T=p}}function MC(r,i,l,d){var p=$.T;$.T=null;var y=ge.p;try{ge.p=8,wy(r,i,l,d)}finally{ge.p=y,$.T=p}}function wy(r,i,l,d){if(Vf){var p=Ty(d);if(p===null)ly(r,i,d,Of,l),rw(r,d);else if(VC(p,r,i,l,d))d.stopPropagation();else if(rw(r,d),i&4&&-1<LC.indexOf(r)){for(;p!==null;){var y=W(p);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var w=ct(y.pendingLanes);if(w!==0){var j=y;for(j.pendingLanes|=2,j.entangledLanes|=2;w;){var F=1<<31-qe(w);j.entanglements[1]|=F,w&=~F}Gi(y),(Fn&6)===0&&(xf=un()+500,ld(0))}}break;case 31:case 13:j=sl(y,2),j!==null&&zr(j,y,2),wf(),_y(y,2)}if(y=Ty(d),y===null&&ly(r,i,d,Of,l),y===p)break;p=y}p!==null&&d.stopPropagation()}else ly(r,i,d,null,l)}}function Ty(r){return r=Us(r),ky(r)}var Of=null;function ky(r){if(Of=null,r=ns(r),r!==null){var i=c(r);if(i===null)r=null;else{var l=i.tag;if(l===13){if(r=u(i),r!==null)return r;r=null}else if(l===31){if(r=h(i),r!==null)return r;r=null}else if(l===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;r=null}else i!==r&&(r=null)}}return Of=r,null}function sw(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(fs()){case Yt:return 2;case Mn:return 8;case dn:case Rn:return 32;case he:return 268435456;default:return 32}default:return 32}}var Ey=!1,ho=null,fo=null,mo=null,pd=new Map,gd=new Map,po=[],LC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function rw(r,i){switch(r){case"focusin":case"focusout":ho=null;break;case"dragenter":case"dragleave":fo=null;break;case"mouseover":case"mouseout":mo=null;break;case"pointerover":case"pointerout":pd.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":gd.delete(i.pointerId)}}function yd(r,i,l,d,p,y){return r===null||r.nativeEvent!==y?(r={blockedOn:i,domEventName:l,eventSystemFlags:d,nativeEvent:y,targetContainers:[p]},i!==null&&(i=W(i),i!==null&&tw(i)),r):(r.eventSystemFlags|=d,i=r.targetContainers,p!==null&&i.indexOf(p)===-1&&i.push(p),r)}function VC(r,i,l,d,p){switch(i){case"focusin":return ho=yd(ho,r,i,l,d,p),!0;case"dragenter":return fo=yd(fo,r,i,l,d,p),!0;case"mouseover":return mo=yd(mo,r,i,l,d,p),!0;case"pointerover":var y=p.pointerId;return pd.set(y,yd(pd.get(y)||null,r,i,l,d,p)),!0;case"gotpointercapture":return y=p.pointerId,gd.set(y,yd(gd.get(y)||null,r,i,l,d,p)),!0}return!1}function iw(r){var i=ns(r.target);if(i!==null){var l=c(i);if(l!==null){if(i=l.tag,i===13){if(i=u(l),i!==null){r.blockedOn=i,Ee(r.priority,function(){nw(l)});return}}else if(i===31){if(i=h(l),i!==null){r.blockedOn=i,Ee(r.priority,function(){nw(l)});return}}else if(i===3&&l.stateNode.current.memoizedState.isDehydrated){r.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Bf(r){if(r.blockedOn!==null)return!1;for(var i=r.targetContainers;0<i.length;){var l=Ty(r.nativeEvent);if(l===null){l=r.nativeEvent;var d=new l.constructor(l.type,l);Ks=d,l.target.dispatchEvent(d),Ks=null}else return i=W(l),i!==null&&tw(i),r.blockedOn=l,!1;i.shift()}return!0}function aw(r,i,l){Bf(r)&&l.delete(i)}function OC(){Ey=!1,ho!==null&&Bf(ho)&&(ho=null),fo!==null&&Bf(fo)&&(fo=null),mo!==null&&Bf(mo)&&(mo=null),pd.forEach(aw),gd.forEach(aw)}function Uf(r,i){r.blockedOn===i&&(r.blockedOn=null,Ey||(Ey=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,OC)))}var Ff=null;function ow(r){Ff!==r&&(Ff=r,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Ff===r&&(Ff=null);for(var i=0;i<r.length;i+=3){var l=r[i],d=r[i+1],p=r[i+2];if(typeof d!="function"){if(ky(d||l)===null)continue;break}var y=W(l);y!==null&&(r.splice(i,3),i-=3,Tg(y,{pending:!0,data:p,method:l.method,action:d},d,p))}}))}function Rc(r){function i(F){return Uf(F,r)}ho!==null&&Uf(ho,r),fo!==null&&Uf(fo,r),mo!==null&&Uf(mo,r),pd.forEach(i),gd.forEach(i);for(var l=0;l<po.length;l++){var d=po[l];d.blockedOn===r&&(d.blockedOn=null)}for(;0<po.length&&(l=po[0],l.blockedOn===null);)iw(l),l.blockedOn===null&&po.shift();if(l=(r.ownerDocument||r).$$reactFormReplay,l!=null)for(d=0;d<l.length;d+=3){var p=l[d],y=l[d+1],w=p[It]||null;if(typeof y=="function")w||ow(l);else if(w){var j=null;if(y&&y.hasAttribute("formAction")){if(p=y,w=y[It]||null)j=w.formAction;else if(ky(p)!==null)continue}else j=w.action;typeof j=="function"?l[d+1]=j:(l.splice(d,3),d-=3),ow(l)}}}function lw(){function r(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(w){return p=w})},focusReset:"manual",scroll:"manual"})}function i(){p!==null&&(p(),p=null),d||setTimeout(l,20)}function l(){if(!d&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var d=!1,p=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(l,100),function(){d=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),p!==null&&(p(),p=null)}}}function Sy(r){this._internalRoot=r}zf.prototype.render=Sy.prototype.render=function(r){var i=this._internalRoot;if(i===null)throw Error(s(409));var l=i.current,d=ti();Z_(l,d,r,i,null,null)},zf.prototype.unmount=Sy.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var i=r.containerInfo;Z_(r.current,2,null,r,null,null),wf(),i[ut]=null}};function zf(r){this._internalRoot=r}zf.prototype.unstable_scheduleHydration=function(r){if(r){var i=ke();r={blockedOn:null,target:r,priority:i};for(var l=0;l<po.length&&i!==0&&i<po[l].priority;l++);po.splice(l,0,r),l===0&&iw(r)}};var cw=e.version;if(cw!=="19.2.4")throw Error(s(527,cw,"19.2.4"));ge.findDOMNode=function(r){var i=r._reactInternals;if(i===void 0)throw typeof r.render=="function"?Error(s(188)):(r=Object.keys(r).join(","),Error(s(268,r)));return r=g(i),r=r!==null?b(r):null,r=r===null?null:r.stateNode,r};var BC={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:$,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var qf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!qf.isDisabled&&qf.supportsFiber)try{nt=qf.inject(BC),Fe=qf}catch{}}return vd.createRoot=function(r,i){if(!o(r))throw Error(s(299));var l=!1,d="",p=gx,y=yx,w=bx;return i!=null&&(i.unstable_strictMode===!0&&(l=!0),i.identifierPrefix!==void 0&&(d=i.identifierPrefix),i.onUncaughtError!==void 0&&(p=i.onUncaughtError),i.onCaughtError!==void 0&&(y=i.onCaughtError),i.onRecoverableError!==void 0&&(w=i.onRecoverableError)),i=X_(r,1,!1,null,null,l,d,null,p,y,w,lw),r[ut]=i.current,oy(r),new Sy(i)},vd.hydrateRoot=function(r,i,l){if(!o(r))throw Error(s(299));var d=!1,p="",y=gx,w=yx,j=bx,F=null;return l!=null&&(l.unstable_strictMode===!0&&(d=!0),l.identifierPrefix!==void 0&&(p=l.identifierPrefix),l.onUncaughtError!==void 0&&(y=l.onUncaughtError),l.onCaughtError!==void 0&&(w=l.onCaughtError),l.onRecoverableError!==void 0&&(j=l.onRecoverableError),l.formState!==void 0&&(F=l.formState)),i=X_(r,1,!0,i,l??null,d,p,F,y,w,j,lw),i.context=J_(null),l=i.current,d=ti(),d=z(d),p=Za(d),p.callback=null,eo(l,p,d),l=d,i.current.lanes=l,Ln(i,l),Gi(i),r[ut]=i.current,oy(r),new zf(i)},vd.version="19.2.4",vd}var vw;function QC(){if(vw)return Cy.exports;vw=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Cy.exports=KC(),Cy.exports}var YC=QC();const XC="modulepreload",JC=function(n){return"/login/"+n},xw={},Dr=function(e,t,s){let o=Promise.resolve();if(t&&t.length>0){let m=function(g){return Promise.all(g.map(b=>Promise.resolve(b).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),h=u?.nonce||u?.getAttribute("nonce");o=m(t.map(g=>{if(g=JC(g),g in xw)return;xw[g]=!0;const b=g.endsWith(".css"),x=b?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${x}`))return;const T=document.createElement("link");if(T.rel=b?"stylesheet":XC,b||(T.as="script"),T.crossOrigin="",T.href=g,h&&T.setAttribute("nonce",h),document.head.appendChild(T),b)return new Promise((N,B)=>{T.addEventListener("load",N),T.addEventListener("error",()=>B(new Error(`Unable to preload CSS for ${g}`)))})}))}function c(u){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=u,window.dispatchEvent(h),!h.defaultPrevented)throw u}return o.then(u=>{for(const h of u||[])h.status==="rejected"&&c(h.reason);return e().catch(c)})};var _w="popstate";function ZC(n={}){function e(s,o){let{pathname:c,search:u,hash:h}=s.location;return gb("",{pathname:c,search:u,hash:h},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function t(s,o){return typeof o=="string"?o:Yd(o)}return tA(e,t,null,n)}function xs(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function _i(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function eA(){return Math.random().toString(36).substring(2,10)}function ww(n,e){return{usr:n.state,key:n.key,idx:e}}function gb(n,e,t=null,s){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?vu(e):e,state:t,key:e&&e.key||s||eA()}}function Yd({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function vu(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let s=n.indexOf("?");s>=0&&(e.search=n.substring(s),n=n.substring(0,s)),n&&(e.pathname=n)}return e}function tA(n,e,t,s={}){let{window:o=document.defaultView,v5Compat:c=!1}=s,u=o.history,h="POP",m=null,g=b();g==null&&(g=0,u.replaceState({...u.state,idx:g},""));function b(){return(u.state||{idx:null}).idx}function x(){h="POP";let M=b(),Y=M==null?null:M-g;g=M,m&&m({action:h,location:P.location,delta:Y})}function T(M,Y){h="PUSH";let H=gb(P.location,M,Y);g=b()+1;let X=ww(H,g),fe=P.createHref(H);try{u.pushState(X,"",fe)}catch(je){if(je instanceof DOMException&&je.name==="DataCloneError")throw je;o.location.assign(fe)}c&&m&&m({action:h,location:P.location,delta:1})}function N(M,Y){h="REPLACE";let H=gb(P.location,M,Y);g=b();let X=ww(H,g),fe=P.createHref(H);u.replaceState(X,"",fe),c&&m&&m({action:h,location:P.location,delta:0})}function B(M){return nA(M)}let P={get action(){return h},get location(){return n(o,u)},listen(M){if(m)throw new Error("A history only accepts one active listener");return o.addEventListener(_w,x),m=M,()=>{o.removeEventListener(_w,x),m=null}},createHref(M){return e(o,M)},createURL:B,encodeLocation(M){let Y=B(M);return{pathname:Y.pathname,search:Y.search,hash:Y.hash}},push:T,replace:N,go(M){return u.go(M)}};return P}function nA(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),xs(t,"No window.location.(origin|href) available to create URL");let s=typeof n=="string"?n:Yd(n);return s=s.replace(/ $/,"%20"),!e&&s.startsWith("//")&&(s=t+s),new URL(s,t)}function $T(n,e,t="/"){return sA(n,e,t,!1)}function sA(n,e,t,s){let o=typeof e=="string"?vu(e):e,c=Da(o.pathname||"/",t);if(c==null)return null;let u=WT(n);rA(u);let h=null;for(let m=0;h==null&&m<u.length;++m){let g=pA(c);h=fA(u[m],g,s)}return h}function WT(n,e=[],t=[],s="",o=!1){let c=(u,h,m=o,g)=>{let b={relativePath:g===void 0?u.path||"":g,caseSensitive:u.caseSensitive===!0,childrenIndex:h,route:u};if(b.relativePath.startsWith("/")){if(!b.relativePath.startsWith(s)&&m)return;xs(b.relativePath.startsWith(s),`Absolute route path "${b.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),b.relativePath=b.relativePath.slice(s.length)}let x=Aa([s,b.relativePath]),T=t.concat(b);u.children&&u.children.length>0&&(xs(u.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${x}".`),WT(u.children,e,T,x,m)),!(u.path==null&&!u.index)&&e.push({path:x,score:dA(x,u.index),routesMeta:T})};return n.forEach((u,h)=>{if(u.path===""||!u.path?.includes("?"))c(u,h);else for(let m of GT(u.path))c(u,h,!0,m)}),e}function GT(n){let e=n.split("/");if(e.length===0)return[];let[t,...s]=e,o=t.endsWith("?"),c=t.replace(/\?$/,"");if(s.length===0)return o?[c,""]:[c];let u=GT(s.join("/")),h=[];return h.push(...u.map(m=>m===""?c:[c,m].join("/"))),o&&h.push(...u),h.map(m=>n.startsWith("/")&&m===""?"/":m)}function rA(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:hA(e.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}var iA=/^:[\w-]+$/,aA=3,oA=2,lA=1,cA=10,uA=-2,Tw=n=>n==="*";function dA(n,e){let t=n.split("/"),s=t.length;return t.some(Tw)&&(s+=uA),e&&(s+=oA),t.filter(o=>!Tw(o)).reduce((o,c)=>o+(iA.test(c)?aA:c===""?lA:cA),s)}function hA(n,e){return n.length===e.length&&n.slice(0,-1).every((s,o)=>s===e[o])?n[n.length-1]-e[e.length-1]:0}function fA(n,e,t=!1){let{routesMeta:s}=n,o={},c="/",u=[];for(let h=0;h<s.length;++h){let m=s[h],g=h===s.length-1,b=c==="/"?e:e.slice(c.length)||"/",x=km({path:m.relativePath,caseSensitive:m.caseSensitive,end:g},b),T=m.route;if(!x&&g&&t&&!s[s.length-1].route.index&&(x=km({path:m.relativePath,caseSensitive:m.caseSensitive,end:!1},b)),!x)return null;Object.assign(o,x.params),u.push({params:o,pathname:Aa([c,x.pathname]),pathnameBase:vA(Aa([c,x.pathnameBase])),route:T}),x.pathnameBase!=="/"&&(c=Aa([c,x.pathnameBase]))}return u}function km(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,s]=mA(n.path,n.caseSensitive,n.end),o=e.match(t);if(!o)return null;let c=o[0],u=c.replace(/(.)\/+$/,"$1"),h=o.slice(1);return{params:s.reduce((g,{paramName:b,isOptional:x},T)=>{if(b==="*"){let B=h[T]||"";u=c.slice(0,c.length-B.length).replace(/(.)\/+$/,"$1")}const N=h[T];return x&&!N?g[b]=void 0:g[b]=(N||"").replace(/%2F/g,"/"),g},{}),pathname:c,pathnameBase:u,pattern:n}}function mA(n,e=!1,t=!0){_i(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let s=[],o="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(u,h,m)=>(s.push({paramName:h,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(s.push({paramName:"*"}),o+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?o+="\\/*$":n!==""&&n!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),s]}function pA(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return _i(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function Da(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,s=n.charAt(t);return s&&s!=="/"?null:n.slice(t)||"/"}var gA=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function yA(n,e="/"){let{pathname:t,search:s="",hash:o=""}=typeof n=="string"?vu(n):n,c;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?c=kw(t.substring(1),"/"):c=kw(t,e)):c=e,{pathname:c,search:xA(s),hash:_A(o)}}function kw(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(o=>{o===".."?t.length>1&&t.pop():o!=="."&&t.push(o)}),t.length>1?t.join("/"):"/"}function Dy(n,e,t,s){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function bA(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function rv(n){let e=bA(n);return e.map((t,s)=>s===e.length-1?t.pathname:t.pathnameBase)}function iv(n,e,t,s=!1){let o;typeof n=="string"?o=vu(n):(o={...n},xs(!o.pathname||!o.pathname.includes("?"),Dy("?","pathname","search",o)),xs(!o.pathname||!o.pathname.includes("#"),Dy("#","pathname","hash",o)),xs(!o.search||!o.search.includes("#"),Dy("#","search","hash",o)));let c=n===""||o.pathname==="",u=c?"/":o.pathname,h;if(u==null)h=t;else{let x=e.length-1;if(!s&&u.startsWith("..")){let T=u.split("/");for(;T[0]==="..";)T.shift(),x-=1;o.pathname=T.join("/")}h=x>=0?e[x]:"/"}let m=yA(o,h),g=u&&u!=="/"&&u.endsWith("/"),b=(c||u===".")&&t.endsWith("/");return!m.pathname.endsWith("/")&&(g||b)&&(m.pathname+="/"),m}var Aa=n=>n.join("/").replace(/\/\/+/g,"/"),vA=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),xA=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,_A=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,wA=class{constructor(n,e,t,s=!1){this.status=n,this.statusText=e||"",this.internal=s,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function TA(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function kA(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var KT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function QT(n,e){let t=n;if(typeof t!="string"||!gA.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let s=t,o=!1;if(KT)try{let c=new URL(window.location.href),u=t.startsWith("//")?new URL(c.protocol+t):new URL(t),h=Da(u.pathname,e);u.origin===c.origin&&h!=null?t=h+u.search+u.hash:o=!0}catch{_i(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:s,isExternal:o,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var YT=["POST","PUT","PATCH","DELETE"];new Set(YT);var EA=["GET",...YT];new Set(EA);var xu=_.createContext(null);xu.displayName="DataRouter";var Zm=_.createContext(null);Zm.displayName="DataRouterState";var SA=_.createContext(!1),XT=_.createContext({isTransitioning:!1});XT.displayName="ViewTransition";var jA=_.createContext(new Map);jA.displayName="Fetchers";var NA=_.createContext(null);NA.displayName="Await";var li=_.createContext(null);li.displayName="Navigation";var fh=_.createContext(null);fh.displayName="Location";var Oi=_.createContext({outlet:null,matches:[],isDataRoute:!1});Oi.displayName="Route";var av=_.createContext(null);av.displayName="RouteError";var JT="REACT_ROUTER_ERROR",CA="REDIRECT",AA="ROUTE_ERROR_RESPONSE";function RA(n){if(n.startsWith(`${JT}:${CA}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function IA(n){if(n.startsWith(`${JT}:${AA}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new wA(e.status,e.statusText,e.data)}catch{}}function DA(n,{relative:e}={}){xs(_u(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:s}=_.useContext(li),{hash:o,pathname:c,search:u}=mh(n,{relative:e}),h=c;return t!=="/"&&(h=c==="/"?t:Aa([t,c])),s.createHref({pathname:h,search:u,hash:o})}function _u(){return _.useContext(fh)!=null}function Bi(){return xs(_u(),"useLocation() may be used only in the context of a <Router> component."),_.useContext(fh).location}var ZT="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function ek(n){_.useContext(li).static||_.useLayoutEffect(n)}function lr(){let{isDataRoute:n}=_.useContext(Oi);return n?GA():PA()}function PA(){xs(_u(),"useNavigate() may be used only in the context of a <Router> component.");let n=_.useContext(xu),{basename:e,navigator:t}=_.useContext(li),{matches:s}=_.useContext(Oi),{pathname:o}=Bi(),c=JSON.stringify(rv(s)),u=_.useRef(!1);return ek(()=>{u.current=!0}),_.useCallback((m,g={})=>{if(_i(u.current,ZT),!u.current)return;if(typeof m=="number"){t.go(m);return}let b=iv(m,JSON.parse(c),o,g.relative==="path");n==null&&e!=="/"&&(b.pathname=b.pathname==="/"?e:Aa([e,b.pathname])),(g.replace?t.replace:t.push)(b,g.state,g)},[e,t,c,o,n])}_.createContext(null);function MA(){let{matches:n}=_.useContext(Oi),e=n[n.length-1];return e?e.params:{}}function mh(n,{relative:e}={}){let{matches:t}=_.useContext(Oi),{pathname:s}=Bi(),o=JSON.stringify(rv(t));return _.useMemo(()=>iv(n,JSON.parse(o),s,e==="path"),[n,o,s,e])}function LA(n,e){return tk(n,e)}function tk(n,e,t,s,o){xs(_u(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:c}=_.useContext(li),{matches:u}=_.useContext(Oi),h=u[u.length-1],m=h?h.params:{},g=h?h.pathname:"/",b=h?h.pathnameBase:"/",x=h&&h.route;{let H=x&&x.path||"";sk(g,!x||H.endsWith("*")||H.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${g}" (under <Route path="${H}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${H}"> to <Route path="${H==="/"?"*":`${H}/*`}">.`)}let T=Bi(),N;if(e){let H=typeof e=="string"?vu(e):e;xs(b==="/"||H.pathname?.startsWith(b),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${b}" but pathname "${H.pathname}" was given in the \`location\` prop.`),N=H}else N=T;let B=N.pathname||"/",P=B;if(b!=="/"){let H=b.replace(/^\//,"").split("/");P="/"+B.replace(/^\//,"").split("/").slice(H.length).join("/")}let M=$T(n,{pathname:P});_i(x||M!=null,`No routes matched location "${N.pathname}${N.search}${N.hash}" `),_i(M==null||M[M.length-1].route.element!==void 0||M[M.length-1].route.Component!==void 0||M[M.length-1].route.lazy!==void 0,`Matched leaf route at location "${N.pathname}${N.search}${N.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let Y=FA(M&&M.map(H=>Object.assign({},H,{params:Object.assign({},m,H.params),pathname:Aa([b,c.encodeLocation?c.encodeLocation(H.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:H.pathname]),pathnameBase:H.pathnameBase==="/"?b:Aa([b,c.encodeLocation?c.encodeLocation(H.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:H.pathnameBase])})),u,t,s,o);return e&&Y?_.createElement(fh.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...N},navigationType:"POP"}},Y):Y}function VA(){let n=WA(),e=TA(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,s="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:s},c={padding:"2px 4px",backgroundColor:s},u=null;return console.error("Error handled by React Router default ErrorBoundary:",n),u=_.createElement(_.Fragment,null,_.createElement("p",null," Hey developer "),_.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",_.createElement("code",{style:c},"ErrorBoundary")," or"," ",_.createElement("code",{style:c},"errorElement")," prop on your route.")),_.createElement(_.Fragment,null,_.createElement("h2",null,"Unexpected Application Error!"),_.createElement("h3",{style:{fontStyle:"italic"}},e),t?_.createElement("pre",{style:o},t):null,u)}var OA=_.createElement(VA,null),nk=class extends _.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=IA(n.digest);t&&(n=t)}let e=n!==void 0?_.createElement(Oi.Provider,{value:this.props.routeContext},_.createElement(av.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?_.createElement(BA,{error:n},e):e}};nk.contextType=SA;var Py=new WeakMap;function BA({children:n,error:e}){let{basename:t}=_.useContext(li);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let s=RA(e.digest);if(s){let o=Py.get(e);if(o)throw o;let c=QT(s.location,t);if(KT&&!Py.get(e))if(c.isExternal||s.reloadDocument)window.location.href=c.absoluteURL||c.to;else{const u=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(c.to,{replace:s.replace}));throw Py.set(e,u),u}return _.createElement("meta",{httpEquiv:"refresh",content:`0;url=${c.absoluteURL||c.to}`})}}return n}function UA({routeContext:n,match:e,children:t}){let s=_.useContext(xu);return s&&s.static&&s.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=e.route.id),_.createElement(Oi.Provider,{value:n},t)}function FA(n,e=[],t=null,s=null,o=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let c=n,u=t?.errors;if(u!=null){let b=c.findIndex(x=>x.route.id&&u?.[x.route.id]!==void 0);xs(b>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(u).join(",")}`),c=c.slice(0,Math.min(c.length,b+1))}let h=!1,m=-1;if(t)for(let b=0;b<c.length;b++){let x=c[b];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(m=b),x.route.id){let{loaderData:T,errors:N}=t,B=x.route.loader&&!T.hasOwnProperty(x.route.id)&&(!N||N[x.route.id]===void 0);if(x.route.lazy||B){h=!0,m>=0?c=c.slice(0,m+1):c=[c[0]];break}}}let g=t&&s?(b,x)=>{s(b,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:kA(t.matches),errorInfo:x})}:void 0;return c.reduceRight((b,x,T)=>{let N,B=!1,P=null,M=null;t&&(N=u&&x.route.id?u[x.route.id]:void 0,P=x.route.errorElement||OA,h&&(m<0&&T===0?(sk("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),B=!0,M=null):m===T&&(B=!0,M=x.route.hydrateFallbackElement||null)));let Y=e.concat(c.slice(0,T+1)),H=()=>{let X;return N?X=P:B?X=M:x.route.Component?X=_.createElement(x.route.Component,null):x.route.element?X=x.route.element:X=b,_.createElement(UA,{match:x,routeContext:{outlet:b,matches:Y,isDataRoute:t!=null},children:X})};return t&&(x.route.ErrorBoundary||x.route.errorElement||T===0)?_.createElement(nk,{location:t.location,revalidation:t.revalidation,component:P,error:N,children:H(),routeContext:{outlet:null,matches:Y,isDataRoute:!0},onError:g}):H()},null)}function ov(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function zA(n){let e=_.useContext(xu);return xs(e,ov(n)),e}function qA(n){let e=_.useContext(Zm);return xs(e,ov(n)),e}function HA(n){let e=_.useContext(Oi);return xs(e,ov(n)),e}function lv(n){let e=HA(n),t=e.matches[e.matches.length-1];return xs(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function $A(){return lv("useRouteId")}function WA(){let n=_.useContext(av),e=qA("useRouteError"),t=lv("useRouteError");return n!==void 0?n:e.errors?.[t]}function GA(){let{router:n}=zA("useNavigate"),e=lv("useNavigate"),t=_.useRef(!1);return ek(()=>{t.current=!0}),_.useCallback(async(o,c={})=>{_i(t.current,ZT),t.current&&(typeof o=="number"?await n.navigate(o):await n.navigate(o,{fromRouteId:e,...c}))},[n,e])}var Ew={};function sk(n,e,t){!e&&!Ew[n]&&(Ew[n]=!0,_i(!1,t))}_.memo(KA);function KA({routes:n,future:e,state:t,onError:s}){return tk(n,void 0,t,s,e)}function QA({to:n,replace:e,state:t,relative:s}){xs(_u(),"<Navigate> may be used only in the context of a <Router> component.");let{static:o}=_.useContext(li);_i(!o,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:c}=_.useContext(Oi),{pathname:u}=Bi(),h=lr(),m=iv(n,rv(c),u,s==="path"),g=JSON.stringify(m);return _.useEffect(()=>{h(JSON.parse(g),{replace:e,state:t,relative:s})},[h,g,s,e,t]),null}function rs(n){xs(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function YA({basename:n="/",children:e=null,location:t,navigationType:s="POP",navigator:o,static:c=!1,unstable_useTransitions:u}){xs(!_u(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let h=n.replace(/^\/*/,"/"),m=_.useMemo(()=>({basename:h,navigator:o,static:c,unstable_useTransitions:u,future:{}}),[h,o,c,u]);typeof t=="string"&&(t=vu(t));let{pathname:g="/",search:b="",hash:x="",state:T=null,key:N="default"}=t,B=_.useMemo(()=>{let P=Da(g,h);return P==null?null:{location:{pathname:P,search:b,hash:x,state:T,key:N},navigationType:s}},[h,g,b,x,T,N,s]);return _i(B!=null,`<Router basename="${h}"> is not able to match the URL "${g}${b}${x}" because it does not start with the basename, so the <Router> won't render anything.`),B==null?null:_.createElement(li.Provider,{value:m},_.createElement(fh.Provider,{children:e,value:B}))}function XA({children:n,location:e}){return LA(yb(n),e)}function yb(n,e=[]){let t=[];return _.Children.forEach(n,(s,o)=>{if(!_.isValidElement(s))return;let c=[...e,o];if(s.type===_.Fragment){t.push.apply(t,yb(s.props.children,c));return}xs(s.type===rs,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),xs(!s.props.index||!s.props.children,"An index route cannot have child routes.");let u={id:s.props.id||c.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,middleware:s.props.middleware,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(u.children=yb(s.props.children,c)),t.push(u)}),t}var om="get",lm="application/x-www-form-urlencoded";function ep(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function JA(n){return ep(n)&&n.tagName.toLowerCase()==="button"}function ZA(n){return ep(n)&&n.tagName.toLowerCase()==="form"}function eR(n){return ep(n)&&n.tagName.toLowerCase()==="input"}function tR(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function nR(n,e){return n.button===0&&(!e||e==="_self")&&!tR(n)}function bb(n=""){return new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let s=n[t];return e.concat(Array.isArray(s)?s.map(o=>[t,o]):[[t,s]])},[]))}function sR(n,e){let t=bb(n);return e&&e.forEach((s,o)=>{t.has(o)||e.getAll(o).forEach(c=>{t.append(o,c)})}),t}var Hf=null;function rR(){if(Hf===null)try{new FormData(document.createElement("form"),0),Hf=!1}catch{Hf=!0}return Hf}var iR=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function My(n){return n!=null&&!iR.has(n)?(_i(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${lm}"`),null):n}function aR(n,e){let t,s,o,c,u;if(ZA(n)){let h=n.getAttribute("action");s=h?Da(h,e):null,t=n.getAttribute("method")||om,o=My(n.getAttribute("enctype"))||lm,c=new FormData(n)}else if(JA(n)||eR(n)&&(n.type==="submit"||n.type==="image")){let h=n.form;if(h==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let m=n.getAttribute("formaction")||h.getAttribute("action");if(s=m?Da(m,e):null,t=n.getAttribute("formmethod")||h.getAttribute("method")||om,o=My(n.getAttribute("formenctype"))||My(h.getAttribute("enctype"))||lm,c=new FormData(h,n),!rR()){let{name:g,type:b,value:x}=n;if(b==="image"){let T=g?`${g}.`:"";c.append(`${T}x`,"0"),c.append(`${T}y`,"0")}else g&&c.append(g,x)}}else{if(ep(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=om,s=null,o=lm,u=n}return c&&o==="text/plain"&&(u=c,c=void 0),{action:s,method:t.toLowerCase(),encType:o,formData:c,body:u}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function cv(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function oR(n,e,t,s){let o=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t?o.pathname.endsWith("/")?o.pathname=`${o.pathname}_.${s}`:o.pathname=`${o.pathname}.${s}`:o.pathname==="/"?o.pathname=`_root.${s}`:e&&Da(o.pathname,e)==="/"?o.pathname=`${e.replace(/\/$/,"")}/_root.${s}`:o.pathname=`${o.pathname.replace(/\/$/,"")}.${s}`,o}async function lR(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function cR(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function uR(n,e,t){let s=await Promise.all(n.map(async o=>{let c=e.routes[o.route.id];if(c){let u=await lR(c,t);return u.links?u.links():[]}return[]}));return mR(s.flat(1).filter(cR).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function Sw(n,e,t,s,o,c){let u=(m,g)=>t[g]?m.route.id!==t[g].route.id:!0,h=(m,g)=>t[g].pathname!==m.pathname||t[g].route.path?.endsWith("*")&&t[g].params["*"]!==m.params["*"];return c==="assets"?e.filter((m,g)=>u(m,g)||h(m,g)):c==="data"?e.filter((m,g)=>{let b=s.routes[m.route.id];if(!b||!b.hasLoader)return!1;if(u(m,g)||h(m,g))return!0;if(m.route.shouldRevalidate){let x=m.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:m.params,defaultShouldRevalidate:!0});if(typeof x=="boolean")return x}return!0}):[]}function dR(n,e,{includeHydrateFallback:t}={}){return hR(n.map(s=>{let o=e.routes[s.route.id];if(!o)return[];let c=[o.module];return o.clientActionModule&&(c=c.concat(o.clientActionModule)),o.clientLoaderModule&&(c=c.concat(o.clientLoaderModule)),t&&o.hydrateFallbackModule&&(c=c.concat(o.hydrateFallbackModule)),o.imports&&(c=c.concat(o.imports)),c}).flat(1))}function hR(n){return[...new Set(n)]}function fR(n){let e={},t=Object.keys(n).sort();for(let s of t)e[s]=n[s];return e}function mR(n,e){let t=new Set;return new Set(e),n.reduce((s,o)=>{let c=JSON.stringify(fR(o));return t.has(c)||(t.add(c),s.push({key:c,link:o})),s},[])}function rk(){let n=_.useContext(xu);return cv(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function pR(){let n=_.useContext(Zm);return cv(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var uv=_.createContext(void 0);uv.displayName="FrameworkContext";function ik(){let n=_.useContext(uv);return cv(n,"You must render this element inside a <HydratedRouter> element"),n}function gR(n,e){let t=_.useContext(uv),[s,o]=_.useState(!1),[c,u]=_.useState(!1),{onFocus:h,onBlur:m,onMouseEnter:g,onMouseLeave:b,onTouchStart:x}=e,T=_.useRef(null);_.useEffect(()=>{if(n==="render"&&u(!0),n==="viewport"){let P=Y=>{Y.forEach(H=>{u(H.isIntersecting)})},M=new IntersectionObserver(P,{threshold:.5});return T.current&&M.observe(T.current),()=>{M.disconnect()}}},[n]),_.useEffect(()=>{if(s){let P=setTimeout(()=>{u(!0)},100);return()=>{clearTimeout(P)}}},[s]);let N=()=>{o(!0)},B=()=>{o(!1),u(!1)};return t?n!=="intent"?[c,T,{}]:[c,T,{onFocus:xd(h,N),onBlur:xd(m,B),onMouseEnter:xd(g,N),onMouseLeave:xd(b,B),onTouchStart:xd(x,N)}]:[!1,T,{}]}function xd(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function yR({page:n,...e}){let{router:t}=rk(),s=_.useMemo(()=>$T(t.routes,n,t.basename),[t.routes,n,t.basename]);return s?_.createElement(vR,{page:n,matches:s,...e}):null}function bR(n){let{manifest:e,routeModules:t}=ik(),[s,o]=_.useState([]);return _.useEffect(()=>{let c=!1;return uR(n,e,t).then(u=>{c||o(u)}),()=>{c=!0}},[n,e,t]),s}function vR({page:n,matches:e,...t}){let s=Bi(),{future:o,manifest:c,routeModules:u}=ik(),{basename:h}=rk(),{loaderData:m,matches:g}=pR(),b=_.useMemo(()=>Sw(n,e,g,c,s,"data"),[n,e,g,c,s]),x=_.useMemo(()=>Sw(n,e,g,c,s,"assets"),[n,e,g,c,s]),T=_.useMemo(()=>{if(n===s.pathname+s.search+s.hash)return[];let P=new Set,M=!1;if(e.forEach(H=>{let X=c.routes[H.route.id];!X||!X.hasLoader||(!b.some(fe=>fe.route.id===H.route.id)&&H.route.id in m&&u[H.route.id]?.shouldRevalidate||X.hasClientLoader?M=!0:P.add(H.route.id))}),P.size===0)return[];let Y=oR(n,h,o.unstable_trailingSlashAwareDataRequests,"data");return M&&P.size>0&&Y.searchParams.set("_routes",e.filter(H=>P.has(H.route.id)).map(H=>H.route.id).join(",")),[Y.pathname+Y.search]},[h,o.unstable_trailingSlashAwareDataRequests,m,s,c,b,e,n,u]),N=_.useMemo(()=>dR(x,c),[x,c]),B=bR(x);return _.createElement(_.Fragment,null,T.map(P=>_.createElement("link",{key:P,rel:"prefetch",as:"fetch",href:P,...t})),N.map(P=>_.createElement("link",{key:P,rel:"modulepreload",href:P,...t})),B.map(({key:P,link:M})=>_.createElement("link",{key:P,nonce:t.nonce,...M,crossOrigin:M.crossOrigin??t.crossOrigin})))}function xR(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var _R=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{_R&&(window.__reactRouterVersion="7.13.0")}catch{}function wR({basename:n,children:e,unstable_useTransitions:t,window:s}){let o=_.useRef();o.current==null&&(o.current=ZC({window:s,v5Compat:!0}));let c=o.current,[u,h]=_.useState({action:c.action,location:c.location}),m=_.useCallback(g=>{t===!1?h(g):_.startTransition(()=>h(g))},[t]);return _.useLayoutEffect(()=>c.listen(m),[c,m]),_.createElement(YA,{basename:n,children:e,location:u.location,navigationType:u.action,navigator:c,unstable_useTransitions:t})}var ak=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ok=_.forwardRef(function({onClick:e,discover:t="render",prefetch:s="none",relative:o,reloadDocument:c,replace:u,state:h,target:m,to:g,preventScrollReset:b,viewTransition:x,unstable_defaultShouldRevalidate:T,...N},B){let{basename:P,unstable_useTransitions:M}=_.useContext(li),Y=typeof g=="string"&&ak.test(g),H=QT(g,P);g=H.to;let X=DA(g,{relative:o}),[fe,je,Te]=gR(s,N),C=SR(g,{replace:u,state:h,target:m,preventScrollReset:b,relative:o,viewTransition:x,unstable_defaultShouldRevalidate:T,unstable_useTransitions:M});function S(U){e&&e(U),U.defaultPrevented||C(U)}let D=_.createElement("a",{...N,...Te,href:H.absoluteURL||X,onClick:H.isExternal||c?e:S,ref:xR(B,je),target:m,"data-discover":!Y&&t==="render"?"true":void 0});return fe&&!Y?_.createElement(_.Fragment,null,D,_.createElement(yR,{page:X})):D});ok.displayName="Link";var TR=_.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:s="",end:o=!1,style:c,to:u,viewTransition:h,children:m,...g},b){let x=mh(u,{relative:g.relative}),T=Bi(),N=_.useContext(Zm),{navigator:B,basename:P}=_.useContext(li),M=N!=null&&IR(x)&&h===!0,Y=B.encodeLocation?B.encodeLocation(x).pathname:x.pathname,H=T.pathname,X=N&&N.navigation&&N.navigation.location?N.navigation.location.pathname:null;t||(H=H.toLowerCase(),X=X?X.toLowerCase():null,Y=Y.toLowerCase()),X&&P&&(X=Da(X,P)||X);const fe=Y!=="/"&&Y.endsWith("/")?Y.length-1:Y.length;let je=H===Y||!o&&H.startsWith(Y)&&H.charAt(fe)==="/",Te=X!=null&&(X===Y||!o&&X.startsWith(Y)&&X.charAt(Y.length)==="/"),C={isActive:je,isPending:Te,isTransitioning:M},S=je?e:void 0,D;typeof s=="function"?D=s(C):D=[s,je?"active":null,Te?"pending":null,M?"transitioning":null].filter(Boolean).join(" ");let U=typeof c=="function"?c(C):c;return _.createElement(ok,{...g,"aria-current":S,className:D,ref:b,style:U,to:u,viewTransition:h},typeof m=="function"?m(C):m)});TR.displayName="NavLink";var kR=_.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:s,replace:o,state:c,method:u=om,action:h,onSubmit:m,relative:g,preventScrollReset:b,viewTransition:x,unstable_defaultShouldRevalidate:T,...N},B)=>{let{unstable_useTransitions:P}=_.useContext(li),M=AR(),Y=RR(h,{relative:g}),H=u.toLowerCase()==="get"?"get":"post",X=typeof h=="string"&&ak.test(h),fe=je=>{if(m&&m(je),je.defaultPrevented)return;je.preventDefault();let Te=je.nativeEvent.submitter,C=Te?.getAttribute("formmethod")||u,S=()=>M(Te||je.currentTarget,{fetcherKey:e,method:C,navigate:t,replace:o,state:c,relative:g,preventScrollReset:b,viewTransition:x,unstable_defaultShouldRevalidate:T});P&&t!==!1?_.startTransition(()=>S()):S()};return _.createElement("form",{ref:B,method:H,action:Y,onSubmit:s?m:fe,...N,"data-discover":!X&&n==="render"?"true":void 0})});kR.displayName="Form";function ER(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function lk(n){let e=_.useContext(xu);return xs(e,ER(n)),e}function SR(n,{target:e,replace:t,state:s,preventScrollReset:o,relative:c,viewTransition:u,unstable_defaultShouldRevalidate:h,unstable_useTransitions:m}={}){let g=lr(),b=Bi(),x=mh(n,{relative:c});return _.useCallback(T=>{if(nR(T,e)){T.preventDefault();let N=t!==void 0?t:Yd(b)===Yd(x),B=()=>g(n,{replace:N,state:s,preventScrollReset:o,relative:c,viewTransition:u,unstable_defaultShouldRevalidate:h});m?_.startTransition(()=>B()):B()}},[b,g,x,t,s,e,n,o,c,u,h,m])}function jR(n){_i(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=_.useRef(bb(n)),t=_.useRef(!1),s=Bi(),o=_.useMemo(()=>sR(s.search,t.current?null:e.current),[s.search]),c=lr(),u=_.useCallback((h,m)=>{const g=bb(typeof h=="function"?h(new URLSearchParams(o)):h);t.current=!0,c("?"+g,m)},[c,o]);return[o,u]}var NR=0,CR=()=>`__${String(++NR)}__`;function AR(){let{router:n}=lk("useSubmit"),{basename:e}=_.useContext(li),t=$A(),s=n.fetch,o=n.navigate;return _.useCallback(async(c,u={})=>{let{action:h,method:m,encType:g,formData:b,body:x}=aR(c,e);if(u.navigate===!1){let T=u.fetcherKey||CR();await s(T,t,u.action||h,{unstable_defaultShouldRevalidate:u.unstable_defaultShouldRevalidate,preventScrollReset:u.preventScrollReset,formData:b,body:x,formMethod:u.method||m,formEncType:u.encType||g,flushSync:u.flushSync})}else await o(u.action||h,{unstable_defaultShouldRevalidate:u.unstable_defaultShouldRevalidate,preventScrollReset:u.preventScrollReset,formData:b,body:x,formMethod:u.method||m,formEncType:u.encType||g,replace:u.replace,state:u.state,fromRouteId:t,flushSync:u.flushSync,viewTransition:u.viewTransition})},[s,o,e,t])}function RR(n,{relative:e}={}){let{basename:t}=_.useContext(li),s=_.useContext(Oi);xs(s,"useFormAction must be used inside a RouteContext");let[o]=s.matches.slice(-1),c={...mh(n||".",{relative:e})},u=Bi();if(n==null){c.search=u.search;let h=new URLSearchParams(c.search),m=h.getAll("index");if(m.some(b=>b==="")){h.delete("index"),m.filter(x=>x).forEach(x=>h.append("index",x));let b=h.toString();c.search=b?`?${b}`:""}}return(!n||n===".")&&o.route.index&&(c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(c.pathname=c.pathname==="/"?t:Aa([t,c.pathname])),Yd(c)}function IR(n,{relative:e}={}){let t=_.useContext(XT);xs(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=lk("useViewTransitionState"),o=mh(n,{relative:e});if(!t.isTransitioning)return!1;let c=Da(t.currentLocation.pathname,s)||t.currentLocation.pathname,u=Da(t.nextLocation.pathname,s)||t.nextLocation.pathname;return km(o.pathname,u)!=null||km(o.pathname,c)!=null}const DR=()=>{};var jw={};const ck=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let o=n.charCodeAt(s);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(o=65536+((o&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},PR=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const o=n[t++];if(o<128)e[s++]=String.fromCharCode(o);else if(o>191&&o<224){const c=n[t++];e[s++]=String.fromCharCode((o&31)<<6|c&63)}else if(o>239&&o<365){const c=n[t++],u=n[t++],h=n[t++],m=((o&7)<<18|(c&63)<<12|(u&63)<<6|h&63)-65536;e[s++]=String.fromCharCode(55296+(m>>10)),e[s++]=String.fromCharCode(56320+(m&1023))}else{const c=n[t++],u=n[t++];e[s++]=String.fromCharCode((o&15)<<12|(c&63)<<6|u&63)}}return e.join("")},uk={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let o=0;o<n.length;o+=3){const c=n[o],u=o+1<n.length,h=u?n[o+1]:0,m=o+2<n.length,g=m?n[o+2]:0,b=c>>2,x=(c&3)<<4|h>>4;let T=(h&15)<<2|g>>6,N=g&63;m||(N=64,u||(T=64)),s.push(t[b],t[x],t[T],t[N])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(ck(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):PR(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let o=0;o<n.length;){const c=t[n.charAt(o++)],h=o<n.length?t[n.charAt(o)]:0;++o;const g=o<n.length?t[n.charAt(o)]:64;++o;const x=o<n.length?t[n.charAt(o)]:64;if(++o,c==null||h==null||g==null||x==null)throw new MR;const T=c<<2|h>>4;if(s.push(T),g!==64){const N=h<<4&240|g>>2;if(s.push(N),x!==64){const B=g<<6&192|x;s.push(B)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class MR extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const LR=function(n){const e=ck(n);return uk.encodeByteArray(e,!0)},Em=function(n){return LR(n).replace(/\./g,"")},dk=function(n){try{return uk.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function hk(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const VR=()=>hk().__FIREBASE_DEFAULTS__,OR=()=>{if(typeof process>"u"||typeof jw>"u")return;const n=jw.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},BR=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&dk(n[1]);return e&&JSON.parse(e)},tp=()=>{try{return DR()||VR()||OR()||BR()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},fk=n=>tp()?.emulatorHosts?.[n],mk=n=>{const e=fk(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),s]:[e.substring(0,t),s]},pk=()=>tp()?.config,gk=n=>tp()?.[`_${n}`];class UR{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}function Ba(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function np(n){return(await fetch(n,{credentials:"include"})).ok}function yk(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",o=n.iat||0,c=n.sub||n.user_id;if(!c)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u={iss:`https://securetoken.google.com/${s}`,aud:s,iat:o,exp:o+3600,auth_time:o,sub:c,user_id:c,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Em(JSON.stringify(t)),Em(JSON.stringify(u)),""].join(".")}const Vd={};function FR(){const n={prod:[],emulator:[]};for(const e of Object.keys(Vd))Vd[e]?n.emulator.push(e):n.prod.push(e);return n}function zR(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Nw=!1;function dv(n,e){if(typeof window>"u"||typeof document>"u"||!Ba(window.location.host)||Vd[n]===e||Vd[n]||Nw)return;Vd[n]=e;function t(T){return`__firebase__banner__${T}`}const s="__firebase__banner",c=FR().prod.length>0;function u(){const T=document.getElementById(s);T&&T.remove()}function h(T){T.style.display="flex",T.style.background="#7faaf0",T.style.position="fixed",T.style.bottom="5px",T.style.left="5px",T.style.padding=".5em",T.style.borderRadius="5px",T.style.alignItems="center"}function m(T,N){T.setAttribute("width","24"),T.setAttribute("id",N),T.setAttribute("height","24"),T.setAttribute("viewBox","0 0 24 24"),T.setAttribute("fill","none"),T.style.marginLeft="-6px"}function g(){const T=document.createElement("span");return T.style.cursor="pointer",T.style.marginLeft="16px",T.style.fontSize="24px",T.innerHTML=" &times;",T.onclick=()=>{Nw=!0,u()},T}function b(T,N){T.setAttribute("id",N),T.innerText="Learn more",T.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",T.setAttribute("target","__blank"),T.style.paddingLeft="5px",T.style.textDecoration="underline"}function x(){const T=zR(s),N=t("text"),B=document.getElementById(N)||document.createElement("span"),P=t("learnmore"),M=document.getElementById(P)||document.createElement("a"),Y=t("preprendIcon"),H=document.getElementById(Y)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(T.created){const X=T.element;h(X),b(M,P);const fe=g();m(H,Y),X.append(H,B,M,fe),document.body.appendChild(X)}c?(B.innerText="Preview backend disconnected.",H.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(H.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,B.innerText="Preview backend running in this workspace."),B.setAttribute("id",N)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",x):x()}function Js(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function qR(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Js())}function bk(){const n=tp()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function HR(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function $R(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function WR(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function GR(){const n=Js();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function vk(){return!bk()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function xk(){return!bk()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function _k(){try{return typeof indexedDB=="object"}catch{return!1}}function KR(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(s);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{e(o.error?.message||"")}}catch(t){e(t)}})}const QR="FirebaseError";class la extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=QR,Object.setPrototypeOf(this,la.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ph.prototype.create)}}class ph{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},o=`${this.service}/${e}`,c=this.errors[e],u=c?YR(c,s):"Error",h=`${this.serviceName}: ${u} (${o}).`;return new la(o,h,s)}}function YR(n,e){return n.replace(XR,(t,s)=>{const o=e[s];return o!=null?String(o):`<${s}?>`})}const XR=/\{\$([^}]+)}/g;function JR(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Li(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const o of t){if(!s.includes(o))return!1;const c=n[o],u=e[o];if(Cw(c)&&Cw(u)){if(!Li(c,u))return!1}else if(c!==u)return!1}for(const o of s)if(!t.includes(o))return!1;return!0}function Cw(n){return n!==null&&typeof n=="object"}function gh(n){const e=[];for(const[t,s]of Object.entries(n))Array.isArray(s)?s.forEach(o=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function Rd(n){const e={};return n.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[o,c]=s.split("=");e[decodeURIComponent(o)]=decodeURIComponent(c)}}),e}function Id(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function ZR(n,e){const t=new eI(n,e);return t.subscribe.bind(t)}class eI{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,s){let o;if(e===void 0&&t===void 0&&s===void 0)throw new Error("Missing Observer.");tI(e,["next","error","complete"])?o=e:o={next:e,error:t,complete:s},o.next===void 0&&(o.next=Ly),o.error===void 0&&(o.error=Ly),o.complete===void 0&&(o.complete=Ly);const c=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),c}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function tI(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Ly(){}function jn(n){return n&&n._delegate?n._delegate:n}class Bo{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const xl="[DEFAULT]";class nI{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new UR;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&s.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),s=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(o){if(s)return null;throw o}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(rI(e))try{this.getOrInitializeService({instanceIdentifier:xl})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const c=this.getOrInitializeService({instanceIdentifier:o});s.resolve(c)}catch{}}}}clearInstance(e=xl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=xl){return this.instances.has(e)}getOptions(e=xl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[c,u]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(c);s===h&&u.resolve(o)}return o}onInit(e,t){const s=this.normalizeInstanceIdentifier(t),o=this.onInitCallbacks.get(s)??new Set;o.add(e),this.onInitCallbacks.set(s,o);const c=this.instances.get(s);return c&&e(c,s),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const o of s)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:sI(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=xl){return this.component?this.component.multipleInstances?e:xl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function sI(n){return n===xl?void 0:n}function rI(n){return n.instantiationMode==="EAGER"}class iI{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new nI(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var wn;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(wn||(wn={}));const aI={debug:wn.DEBUG,verbose:wn.VERBOSE,info:wn.INFO,warn:wn.WARN,error:wn.ERROR,silent:wn.SILENT},oI=wn.INFO,lI={[wn.DEBUG]:"log",[wn.VERBOSE]:"log",[wn.INFO]:"info",[wn.WARN]:"warn",[wn.ERROR]:"error"},cI=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),o=lI[e];if(o)console[o](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class hv{constructor(e){this.name=e,this._logLevel=oI,this._logHandler=cI,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in wn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?aI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,wn.DEBUG,...e),this._logHandler(this,wn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,wn.VERBOSE,...e),this._logHandler(this,wn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,wn.INFO,...e),this._logHandler(this,wn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,wn.WARN,...e),this._logHandler(this,wn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,wn.ERROR,...e),this._logHandler(this,wn.ERROR,...e)}}const uI=(n,e)=>e.some(t=>n instanceof t);let Aw,Rw;function dI(){return Aw||(Aw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function hI(){return Rw||(Rw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const wk=new WeakMap,vb=new WeakMap,Tk=new WeakMap,Vy=new WeakMap,fv=new WeakMap;function fI(n){const e=new Promise((t,s)=>{const o=()=>{n.removeEventListener("success",c),n.removeEventListener("error",u)},c=()=>{t(Mo(n.result)),o()},u=()=>{s(n.error),o()};n.addEventListener("success",c),n.addEventListener("error",u)});return e.then(t=>{t instanceof IDBCursor&&wk.set(t,n)}).catch(()=>{}),fv.set(e,n),e}function mI(n){if(vb.has(n))return;const e=new Promise((t,s)=>{const o=()=>{n.removeEventListener("complete",c),n.removeEventListener("error",u),n.removeEventListener("abort",u)},c=()=>{t(),o()},u=()=>{s(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",c),n.addEventListener("error",u),n.addEventListener("abort",u)});vb.set(n,e)}let xb={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return vb.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Tk.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Mo(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function pI(n){xb=n(xb)}function gI(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(Oy(this),e,...t);return Tk.set(s,e.sort?e.sort():[e]),Mo(s)}:hI().includes(n)?function(...e){return n.apply(Oy(this),e),Mo(wk.get(this))}:function(...e){return Mo(n.apply(Oy(this),e))}}function yI(n){return typeof n=="function"?gI(n):(n instanceof IDBTransaction&&mI(n),uI(n,dI())?new Proxy(n,xb):n)}function Mo(n){if(n instanceof IDBRequest)return fI(n);if(Vy.has(n))return Vy.get(n);const e=yI(n);return e!==n&&(Vy.set(n,e),fv.set(e,n)),e}const Oy=n=>fv.get(n);function bI(n,e,{blocked:t,upgrade:s,blocking:o,terminated:c}={}){const u=indexedDB.open(n,e),h=Mo(u);return s&&u.addEventListener("upgradeneeded",m=>{s(Mo(u.result),m.oldVersion,m.newVersion,Mo(u.transaction),m)}),t&&u.addEventListener("blocked",m=>t(m.oldVersion,m.newVersion,m)),h.then(m=>{c&&m.addEventListener("close",()=>c()),o&&m.addEventListener("versionchange",g=>o(g.oldVersion,g.newVersion,g))}).catch(()=>{}),h}const vI=["get","getKey","getAll","getAllKeys","count"],xI=["put","add","delete","clear"],By=new Map;function Iw(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(By.get(e))return By.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,o=xI.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(o||vI.includes(t)))return;const c=async function(u,...h){const m=this.transaction(u,o?"readwrite":"readonly");let g=m.store;return s&&(g=g.index(h.shift())),(await Promise.all([g[t](...h),o&&m.done]))[0]};return By.set(e,c),c}pI(n=>({...n,get:(e,t,s)=>Iw(e,t)||n.get(e,t,s),has:(e,t)=>!!Iw(e,t)||n.has(e,t)}));class _I{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(wI(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function wI(n){return n.getComponent()?.type==="VERSION"}const _b="@firebase/app",Dw="0.14.7";const Pa=new hv("@firebase/app"),TI="@firebase/app-compat",kI="@firebase/analytics-compat",EI="@firebase/analytics",SI="@firebase/app-check-compat",jI="@firebase/app-check",NI="@firebase/auth",CI="@firebase/auth-compat",AI="@firebase/database",RI="@firebase/data-connect",II="@firebase/database-compat",DI="@firebase/functions",PI="@firebase/functions-compat",MI="@firebase/installations",LI="@firebase/installations-compat",VI="@firebase/messaging",OI="@firebase/messaging-compat",BI="@firebase/performance",UI="@firebase/performance-compat",FI="@firebase/remote-config",zI="@firebase/remote-config-compat",qI="@firebase/storage",HI="@firebase/storage-compat",$I="@firebase/firestore",WI="@firebase/ai",GI="@firebase/firestore-compat",KI="firebase",QI="12.8.0";const Sm="[DEFAULT]",YI={[_b]:"fire-core",[TI]:"fire-core-compat",[EI]:"fire-analytics",[kI]:"fire-analytics-compat",[jI]:"fire-app-check",[SI]:"fire-app-check-compat",[NI]:"fire-auth",[CI]:"fire-auth-compat",[AI]:"fire-rtdb",[RI]:"fire-data-connect",[II]:"fire-rtdb-compat",[DI]:"fire-fn",[PI]:"fire-fn-compat",[MI]:"fire-iid",[LI]:"fire-iid-compat",[VI]:"fire-fcm",[OI]:"fire-fcm-compat",[BI]:"fire-perf",[UI]:"fire-perf-compat",[FI]:"fire-rc",[zI]:"fire-rc-compat",[qI]:"fire-gcs",[HI]:"fire-gcs-compat",[$I]:"fire-fst",[GI]:"fire-fst-compat",[WI]:"fire-vertex","fire-js":"fire-js",[KI]:"fire-js-all"};const jm=new Map,XI=new Map,wb=new Map;function Pw(n,e){try{n.container.addComponent(e)}catch(t){Pa.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Pl(n){const e=n.name;if(wb.has(e))return Pa.debug(`There were multiple attempts to register component ${e}.`),!1;wb.set(e,n);for(const t of jm.values())Pw(t,n);for(const t of XI.values())Pw(t,n);return!0}function wu(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function JI(n,e,t=Sm){wu(n,e).clearInstance(t)}function si(n){return n==null?!1:n.settings!==void 0}const ZI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Lo=new ph("app","Firebase",ZI);class e4{constructor(e,t,s){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Bo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Lo.create("app-deleted",{appName:this._name})}}const Kl=QI;function mv(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s={name:Sm,automaticDataCollectionEnabled:!0,...e},o=s.name;if(typeof o!="string"||!o)throw Lo.create("bad-app-name",{appName:String(o)});if(t||(t=pk()),!t)throw Lo.create("no-options");const c=jm.get(o);if(c){if(Li(t,c.options)&&Li(s,c.config))return c;throw Lo.create("duplicate-app",{appName:o})}const u=new iI(o);for(const m of wb.values())u.addComponent(m);const h=new e4(t,s,u);return jm.set(o,h),h}function pv(n=Sm){const e=jm.get(n);if(!e&&n===Sm&&pk())return mv();if(!e)throw Lo.create("no-app",{appName:n});return e}function ea(n,e,t){let s=YI[n]??n;t&&(s+=`-${t}`);const o=s.match(/\s|\//),c=e.match(/\s|\//);if(o||c){const u=[`Unable to register library "${s}" with version "${e}":`];o&&u.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&c&&u.push("and"),c&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Pa.warn(u.join(" "));return}Pl(new Bo(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}const t4="firebase-heartbeat-database",n4=1,Xd="firebase-heartbeat-store";let Uy=null;function kk(){return Uy||(Uy=bI(t4,n4,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Xd)}catch(t){console.warn(t)}}}}).catch(n=>{throw Lo.create("idb-open",{originalErrorMessage:n.message})})),Uy}async function s4(n){try{const t=(await kk()).transaction(Xd),s=await t.objectStore(Xd).get(Ek(n));return await t.done,s}catch(e){if(e instanceof la)Pa.warn(e.message);else{const t=Lo.create("idb-get",{originalErrorMessage:e?.message});Pa.warn(t.message)}}}async function Mw(n,e){try{const s=(await kk()).transaction(Xd,"readwrite");await s.objectStore(Xd).put(e,Ek(n)),await s.done}catch(t){if(t instanceof la)Pa.warn(t.message);else{const s=Lo.create("idb-set",{originalErrorMessage:t?.message});Pa.warn(s.message)}}}function Ek(n){return`${n.name}!${n.options.appId}`}const r4=1024,i4=30;class a4{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new l4(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Lw();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:t}),this._heartbeatsCache.heartbeats.length>i4){const o=c4(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Pa.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Lw(),{heartbeatsToSend:t,unsentEntries:s}=o4(this._heartbeatsCache.heartbeats),o=Em(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(e){return Pa.warn(e),""}}}function Lw(){return new Date().toISOString().substring(0,10)}function o4(n,e=r4){const t=[];let s=n.slice();for(const o of n){const c=t.find(u=>u.agent===o.agent);if(c){if(c.dates.push(o.date),Vw(t)>e){c.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),Vw(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class l4{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return _k()?KR().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await s4(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Mw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Mw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Vw(n){return Em(JSON.stringify({version:2,heartbeats:n})).length}function c4(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let s=1;s<n.length;s++)n[s].date<t&&(t=n[s].date,e=s);return e}function u4(n){Pl(new Bo("platform-logger",e=>new _I(e),"PRIVATE")),Pl(new Bo("heartbeat",e=>new a4(e),"PRIVATE")),ea(_b,Dw,n),ea(_b,Dw,"esm2020"),ea("fire-js","")}u4("");function Sk(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const d4=Sk,jk=new ph("auth","Firebase",Sk());const Nm=new hv("@firebase/auth");function h4(n,...e){Nm.logLevel<=wn.WARN&&Nm.warn(`Auth (${Kl}): ${n}`,...e)}function cm(n,...e){Nm.logLevel<=wn.ERROR&&Nm.error(`Auth (${Kl}): ${n}`,...e)}function Vi(n,...e){throw gv(n,...e)}function ta(n,...e){return gv(n,...e)}function Nk(n,e,t){const s={...d4(),[e]:t};return new ph("auth","Firebase",s).create(e,{appName:n.name})}function Ra(n){return Nk(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function gv(n,...e){if(typeof n!="string"){const t=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=n.name),n._errorFactory.create(t,...s)}return jk.create(n,...e)}function qt(n,e,...t){if(!n)throw gv(e,...t)}function ja(n){const e="INTERNAL ASSERTION FAILED: "+n;throw cm(e),new Error(e)}function Ma(n,e){n||ja(e)}function Tb(){return typeof self<"u"&&self.location?.href||""}function f4(){return Ow()==="http:"||Ow()==="https:"}function Ow(){return typeof self<"u"&&self.location?.protocol||null}function m4(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(f4()||$R()||"connection"in navigator)?navigator.onLine:!0}function p4(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class yh{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ma(t>e,"Short delay should be less than long delay!"),this.isMobile=qR()||WR()}get(){return m4()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function yv(n,e){Ma(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class Ck{static initialize(e,t,s){this.fetchImpl=e,t&&(this.headersImpl=t),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ja("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ja("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ja("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const g4={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const y4=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],b4=new yh(3e4,6e4);function Ua(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Fa(n,e,t,s,o={}){return Ak(n,o,async()=>{let c={},u={};s&&(e==="GET"?u=s:c={body:JSON.stringify(s)});const h=gh({key:n.config.apiKey,...u}).slice(1),m=await n._getAdditionalHeaders();m["Content-Type"]="application/json",n.languageCode&&(m["X-Firebase-Locale"]=n.languageCode);const g={method:e,headers:m,...c};return HR()||(g.referrerPolicy="no-referrer"),n.emulatorConfig&&Ba(n.emulatorConfig.host)&&(g.credentials="include"),Ck.fetch()(await Rk(n,n.config.apiHost,t,h),g)})}async function Ak(n,e,t){n._canInitEmulator=!1;const s={...g4,...e};try{const o=new x4(n),c=await Promise.race([t(),o.promise]);o.clearNetworkTimeout();const u=await c.json();if("needConfirmation"in u)throw $f(n,"account-exists-with-different-credential",u);if(c.ok&&!("errorMessage"in u))return u;{const h=c.ok?u.errorMessage:u.error.message,[m,g]=h.split(" : ");if(m==="FEDERATED_USER_ID_ALREADY_LINKED")throw $f(n,"credential-already-in-use",u);if(m==="EMAIL_EXISTS")throw $f(n,"email-already-in-use",u);if(m==="USER_DISABLED")throw $f(n,"user-disabled",u);const b=s[m]||m.toLowerCase().replace(/[_\s]+/g,"-");if(g)throw Nk(n,b,g);Vi(n,b)}}catch(o){if(o instanceof la)throw o;Vi(n,"network-request-failed",{message:String(o)})}}async function bh(n,e,t,s,o={}){const c=await Fa(n,e,t,s,o);return"mfaPendingCredential"in c&&Vi(n,"multi-factor-auth-required",{_serverResponse:c}),c}async function Rk(n,e,t,s){const o=`${e}${t}?${s}`,c=n,u=c.config.emulator?yv(n.config,o):`${n.config.apiScheme}://${o}`;return y4.includes(t)&&(await c._persistenceManagerAvailable,c._getPersistenceType()==="COOKIE")?c._getPersistence()._getFinalTarget(u).toString():u}function v4(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class x4{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,s)=>{this.timer=setTimeout(()=>s(ta(this.auth,"network-request-failed")),b4.get())})}}function $f(n,e,t){const s={appName:n.name};t.email&&(s.email=t.email),t.phoneNumber&&(s.phoneNumber=t.phoneNumber);const o=ta(n,e,s);return o.customData._tokenResponse=t,o}function Bw(n){return n!==void 0&&n.enterprise!==void 0}class _4{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return v4(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function w4(n,e){return Fa(n,"GET","/v2/recaptchaConfig",Ua(n,e))}async function T4(n,e){return Fa(n,"POST","/v1/accounts:delete",e)}async function Cm(n,e){return Fa(n,"POST","/v1/accounts:lookup",e)}function Od(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function k4(n,e=!1){const t=jn(n),s=await t.getIdToken(e),o=bv(s);qt(o&&o.exp&&o.auth_time&&o.iat,t.auth,"internal-error");const c=typeof o.firebase=="object"?o.firebase:void 0,u=c?.sign_in_provider;return{claims:o,token:s,authTime:Od(Fy(o.auth_time)),issuedAtTime:Od(Fy(o.iat)),expirationTime:Od(Fy(o.exp)),signInProvider:u||null,signInSecondFactor:c?.sign_in_second_factor||null}}function Fy(n){return Number(n)*1e3}function bv(n){const[e,t,s]=n.split(".");if(e===void 0||t===void 0||s===void 0)return cm("JWT malformed, contained fewer than 3 sections"),null;try{const o=dk(t);return o?JSON.parse(o):(cm("Failed to decode base64 JWT payload"),null)}catch(o){return cm("Caught error parsing JWT payload as JSON",o?.toString()),null}}function Uw(n){const e=bv(n);return qt(e,"internal-error"),qt(typeof e.exp<"u","internal-error"),qt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Jd(n,e,t=!1){if(t)return e;try{return await e}catch(s){throw s instanceof la&&E4(s)&&n.auth.currentUser===n&&await n.auth.signOut(),s}}function E4({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class S4{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const s=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class kb{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Od(this.lastLoginAt),this.creationTime=Od(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Am(n){const e=n.auth,t=await n.getIdToken(),s=await Jd(n,Cm(e,{idToken:t}));qt(s?.users.length,e,"internal-error");const o=s.users[0];n._notifyReloadListener(o);const c=o.providerUserInfo?.length?Ik(o.providerUserInfo):[],u=N4(n.providerData,c),h=n.isAnonymous,m=!(n.email&&o.passwordHash)&&!u?.length,g=h?m:!1,b={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new kb(o.createdAt,o.lastLoginAt),isAnonymous:g};Object.assign(n,b)}async function j4(n){const e=jn(n);await Am(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function N4(n,e){return[...n.filter(s=>!e.some(o=>o.providerId===s.providerId)),...e]}function Ik(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function C4(n,e){const t=await Ak(n,{},async()=>{const s=gh({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:c}=n.config,u=await Rk(n,o,"/v1/token",`key=${c}`),h=await n._getAdditionalHeaders();h["Content-Type"]="application/x-www-form-urlencoded";const m={method:"POST",headers:h,body:s};return n.emulatorConfig&&Ba(n.emulatorConfig.host)&&(m.credentials="include"),Ck.fetch()(u,m)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function A4(n,e){return Fa(n,"POST","/v2/accounts:revokeToken",Ua(n,e))}class Gc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){qt(e.idToken,"internal-error"),qt(typeof e.idToken<"u","internal-error"),qt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Uw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){qt(e.length!==0,"internal-error");const t=Uw(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(qt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:s,refreshToken:o,expiresIn:c}=await C4(e,t);this.updateTokensAndExpiration(s,o,Number(c))}updateTokensAndExpiration(e,t,s){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,t){const{refreshToken:s,accessToken:o,expirationTime:c}=t,u=new Gc;return s&&(qt(typeof s=="string","internal-error",{appName:e}),u.refreshToken=s),o&&(qt(typeof o=="string","internal-error",{appName:e}),u.accessToken=o),c&&(qt(typeof c=="number","internal-error",{appName:e}),u.expirationTime=c),u}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Gc,this.toJSON())}_performRefresh(){return ja("not implemented")}}function yo(n,e){qt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Mi{constructor({uid:e,auth:t,stsTokenManager:s,...o}){this.providerId="firebase",this.proactiveRefresh=new S4(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new kb(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const t=await Jd(this,this.stsTokenManager.getToken(this.auth,e));return qt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return k4(this,e)}reload(){return j4(this)}_assign(e){this!==e&&(qt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Mi({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){qt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),t&&await Am(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(si(this.auth.app))return Promise.reject(Ra(this.auth));const e=await this.getIdToken();return await Jd(this,T4(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const s=t.displayName??void 0,o=t.email??void 0,c=t.phoneNumber??void 0,u=t.photoURL??void 0,h=t.tenantId??void 0,m=t._redirectEventId??void 0,g=t.createdAt??void 0,b=t.lastLoginAt??void 0,{uid:x,emailVerified:T,isAnonymous:N,providerData:B,stsTokenManager:P}=t;qt(x&&P,e,"internal-error");const M=Gc.fromJSON(this.name,P);qt(typeof x=="string",e,"internal-error"),yo(s,e.name),yo(o,e.name),qt(typeof T=="boolean",e,"internal-error"),qt(typeof N=="boolean",e,"internal-error"),yo(c,e.name),yo(u,e.name),yo(h,e.name),yo(m,e.name),yo(g,e.name),yo(b,e.name);const Y=new Mi({uid:x,auth:e,email:o,emailVerified:T,displayName:s,isAnonymous:N,photoURL:u,phoneNumber:c,tenantId:h,stsTokenManager:M,createdAt:g,lastLoginAt:b});return B&&Array.isArray(B)&&(Y.providerData=B.map(H=>({...H}))),m&&(Y._redirectEventId=m),Y}static async _fromIdTokenResponse(e,t,s=!1){const o=new Gc;o.updateFromServerResponse(t);const c=new Mi({uid:t.localId,auth:e,stsTokenManager:o,isAnonymous:s});return await Am(c),c}static async _fromGetAccountInfoResponse(e,t,s){const o=t.users[0];qt(o.localId!==void 0,"internal-error");const c=o.providerUserInfo!==void 0?Ik(o.providerUserInfo):[],u=!(o.email&&o.passwordHash)&&!c?.length,h=new Gc;h.updateFromIdToken(s);const m=new Mi({uid:o.localId,auth:e,stsTokenManager:h,isAnonymous:u}),g={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:c,metadata:new kb(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!c?.length};return Object.assign(m,g),m}}const Fw=new Map;function Na(n){Ma(n instanceof Function,"Expected a class definition");let e=Fw.get(n);return e?(Ma(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Fw.set(n,e),e)}class Dk{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Dk.type="NONE";const zw=Dk;function um(n,e,t){return`firebase:${n}:${e}:${t}`}class Kc{constructor(e,t,s){this.persistence=e,this.auth=t,this.userKey=s;const{config:o,name:c}=this.auth;this.fullUserKey=um(this.userKey,o.apiKey,c),this.fullPersistenceKey=um("persistence",o.apiKey,c),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Cm(this.auth,{idToken:e}).catch(()=>{});return t?Mi._fromGetAccountInfoResponse(this.auth,t,e):null}return Mi._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,s="authUser"){if(!t.length)return new Kc(Na(zw),e,s);const o=(await Promise.all(t.map(async g=>{if(await g._isAvailable())return g}))).filter(g=>g);let c=o[0]||Na(zw);const u=um(s,e.config.apiKey,e.name);let h=null;for(const g of t)try{const b=await g._get(u);if(b){let x;if(typeof b=="string"){const T=await Cm(e,{idToken:b}).catch(()=>{});if(!T)break;x=await Mi._fromGetAccountInfoResponse(e,T,b)}else x=Mi._fromJSON(e,b);g!==c&&(h=x),c=g;break}}catch{}const m=o.filter(g=>g._shouldAllowMigration);return!c._shouldAllowMigration||!m.length?new Kc(c,e,s):(c=m[0],h&&await c._set(u,h.toJSON()),await Promise.all(t.map(async g=>{if(g!==c)try{await g._remove(u)}catch{}})),new Kc(c,e,s))}}function qw(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Vk(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Pk(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Bk(e))return"Blackberry";if(Uk(e))return"Webos";if(Mk(e))return"Safari";if((e.includes("chrome/")||Lk(e))&&!e.includes("edge/"))return"Chrome";if(Ok(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=n.match(t);if(s?.length===2)return s[1]}return"Other"}function Pk(n=Js()){return/firefox\//i.test(n)}function Mk(n=Js()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Lk(n=Js()){return/crios\//i.test(n)}function Vk(n=Js()){return/iemobile/i.test(n)}function Ok(n=Js()){return/android/i.test(n)}function Bk(n=Js()){return/blackberry/i.test(n)}function Uk(n=Js()){return/webos/i.test(n)}function vv(n=Js()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function R4(n=Js()){return vv(n)&&!!window.navigator?.standalone}function I4(){return GR()&&document.documentMode===10}function Fk(n=Js()){return vv(n)||Ok(n)||Uk(n)||Bk(n)||/windows phone/i.test(n)||Vk(n)}function zk(n,e=[]){let t;switch(n){case"Browser":t=qw(Js());break;case"Worker":t=`${qw(Js())}-${n}`;break;default:t=n}const s=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Kl}/${s}`}class D4{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const s=c=>new Promise((u,h)=>{try{const m=e(c);u(m)}catch(m){h(m)}});s.onAbort=t,this.queue.push(s);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const s of this.queue)await s(e),s.onAbort&&t.push(s.onAbort)}catch(s){t.reverse();for(const o of t)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s?.message})}}}async function P4(n,e={}){return Fa(n,"GET","/v2/passwordPolicy",Ua(n,e))}const M4=6;class L4{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??M4,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const s=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;s&&(t.meetsMinPasswordLength=e.length>=s),o&&(t.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let s;for(let o=0;o<e.length;o++)s=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(t,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,t,s,o,c){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=c))}}class V4{constructor(e,t,s,o){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=s,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Hw(this),this.idTokenSubscription=new Hw(this),this.beforeStateQueue=new D4(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=jk,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(c=>this._resolvePersistenceManagerAvailable=c)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Na(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Kc.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Cm(this,{idToken:e}),s=await Mi._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(s)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(si(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(u,u))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let s=t,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=this.redirectUser?._redirectEventId,u=s?._redirectEventId,h=await this.tryRedirectSignIn(e);(!c||c===u)&&h?.user&&(s=h.user,o=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(s)}catch(c){s=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return qt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Am(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=p4()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(si(this.app))return Promise.reject(Ra(this));const t=e?jn(e):null;return t&&qt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&qt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return si(this.app)?Promise.reject(Ra(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return si(this.app)?Promise.reject(Ra(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Na(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await P4(this),t=new L4(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ph("auth","Firebase",e())}onAuthStateChanged(e,t,s){return this.registerStateListener(this.authStateSubscription,e,t,s)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,s){return this.registerStateListener(this.idTokenSubscription,e,t,s)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(s.tenantId=this.tenantId),await A4(this,s)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const s=await this.getOrInitRedirectPersistenceManager(t);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Na(e)||this._popupRedirectResolver;qt(t,this,"argument-error"),this.redirectPersistenceManager=await Kc.create(this,[Na(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,s,o){if(this._deleted)return()=>{};const c=typeof t=="function"?t:t.next.bind(t);let u=!1;const h=this._isInitialized?Promise.resolve():this._initializationPromise;if(qt(h,this,"internal-error"),h.then(()=>{u||c(this.currentUser)}),typeof t=="function"){const m=e.addObserver(t,s,o);return()=>{u=!0,m()}}else{const m=e.addObserver(t);return()=>{u=!0,m()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return qt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=zk(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const s=await this._getAppCheckToken();return s&&(e["X-Firebase-AppCheck"]=s),e}async _getAppCheckToken(){if(si(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&h4(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Go(n){return jn(n)}class Hw{constructor(e){this.auth=e,this.observer=null,this.addObserver=ZR(t=>this.observer=t)}get next(){return qt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let sp={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function O4(n){sp=n}function qk(n){return sp.loadJS(n)}function B4(){return sp.recaptchaEnterpriseScript}function U4(){return sp.gapiScript}function F4(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class z4{constructor(){this.enterprise=new q4}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class q4{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const H4="recaptcha-enterprise",Hk="NO_RECAPTCHA";class $4{constructor(e){this.type=H4,this.auth=Go(e)}async verify(e="verify",t=!1){async function s(c){if(!t){if(c.tenantId==null&&c._agentRecaptchaConfig!=null)return c._agentRecaptchaConfig.siteKey;if(c.tenantId!=null&&c._tenantRecaptchaConfigs[c.tenantId]!==void 0)return c._tenantRecaptchaConfigs[c.tenantId].siteKey}return new Promise(async(u,h)=>{w4(c,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(m=>{if(m.recaptchaKey===void 0)h(new Error("recaptcha Enterprise site key undefined"));else{const g=new _4(m);return c.tenantId==null?c._agentRecaptchaConfig=g:c._tenantRecaptchaConfigs[c.tenantId]=g,u(g.siteKey)}}).catch(m=>{h(m)})})}function o(c,u,h){const m=window.grecaptcha;Bw(m)?m.enterprise.ready(()=>{m.enterprise.execute(c,{action:e}).then(g=>{u(g)}).catch(()=>{u(Hk)})}):h(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new z4().execute("siteKey",{action:"verify"}):new Promise((c,u)=>{s(this.auth).then(h=>{if(!t&&Bw(window.grecaptcha))o(h,c,u);else{if(typeof window>"u"){u(new Error("RecaptchaVerifier is only supported in browser"));return}let m=B4();m.length!==0&&(m+=h),qk(m).then(()=>{o(h,c,u)}).catch(g=>{u(g)})}}).catch(h=>{u(h)})})}}async function $w(n,e,t,s=!1,o=!1){const c=new $4(n);let u;if(o)u=Hk;else try{u=await c.verify(t)}catch{u=await c.verify(t,!0)}const h={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in h){const m=h.phoneEnrollmentInfo.phoneNumber,g=h.phoneEnrollmentInfo.recaptchaToken;Object.assign(h,{phoneEnrollmentInfo:{phoneNumber:m,recaptchaToken:g,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in h){const m=h.phoneSignInInfo.recaptchaToken;Object.assign(h,{phoneSignInInfo:{recaptchaToken:m,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return h}return s?Object.assign(h,{captchaResp:u}):Object.assign(h,{captchaResponse:u}),Object.assign(h,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(h,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),h}async function Rm(n,e,t,s,o){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const c=await $w(n,e,t,t==="getOobCode");return s(n,c)}else return s(n,e).catch(async c=>{if(c.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const u=await $w(n,e,t,t==="getOobCode");return s(n,u)}else return Promise.reject(c)})}function W4(n,e){const t=wu(n,"auth");if(t.isInitialized()){const o=t.getImmediate(),c=t.getOptions();if(Li(c,e??{}))return o;Vi(o,"already-initialized")}return t.initialize({options:e})}function G4(n,e){const t=e?.persistence||[],s=(Array.isArray(t)?t:[t]).map(Na);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(s,e?.popupRedirectResolver)}function K4(n,e,t){const s=Go(n);qt(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const o=!1,c=$k(e),{host:u,port:h}=Q4(e),m=h===null?"":`:${h}`,g={url:`${c}//${u}${m}/`},b=Object.freeze({host:u,port:h,protocol:c.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!s._canInitEmulator){qt(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),qt(Li(g,s.config.emulator)&&Li(b,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=g,s.emulatorConfig=b,s.settings.appVerificationDisabledForTesting=!0,Ba(u)?(np(`${c}//${u}${m}`),dv("Auth",!0)):Y4()}function $k(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function Q4(n){const e=$k(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const s=t[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(s);if(o){const c=o[1];return{host:c,port:Ww(s.substr(c.length+1))}}else{const[c,u]=s.split(":");return{host:c,port:Ww(u)}}}function Ww(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function Y4(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class xv{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ja("not implemented")}_getIdTokenResponse(e){return ja("not implemented")}_linkToIdToken(e,t){return ja("not implemented")}_getReauthenticationResolver(e){return ja("not implemented")}}async function X4(n,e){return Fa(n,"POST","/v1/accounts:signUp",e)}async function J4(n,e){return bh(n,"POST","/v1/accounts:signInWithPassword",Ua(n,e))}async function Wk(n,e){return Fa(n,"POST","/v1/accounts:sendOobCode",Ua(n,e))}async function Z4(n,e){return Wk(n,e)}async function eD(n,e){return Wk(n,e)}async function tD(n,e){return bh(n,"POST","/v1/accounts:signInWithEmailLink",Ua(n,e))}async function nD(n,e){return bh(n,"POST","/v1/accounts:signInWithEmailLink",Ua(n,e))}class Zd extends xv{constructor(e,t,s,o=null){super("password",s),this._email=e,this._password=t,this._tenantId=o}static _fromEmailAndPassword(e,t){return new Zd(e,t,"password")}static _fromEmailAndCode(e,t,s=null){return new Zd(e,t,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Rm(e,t,"signInWithPassword",J4);case"emailLink":return tD(e,{email:this._email,oobCode:this._password});default:Vi(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const s={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Rm(e,s,"signUpPassword",X4);case"emailLink":return nD(e,{idToken:t,email:this._email,oobCode:this._password});default:Vi(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Qc(n,e){return bh(n,"POST","/v1/accounts:signInWithIdp",Ua(n,e))}const sD="http://localhost";class Ml extends xv{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Ml(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Vi("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:o,...c}=t;if(!s||!o)return null;const u=new Ml(s,o);return u.idToken=c.idToken||void 0,u.accessToken=c.accessToken||void 0,u.secret=c.secret,u.nonce=c.nonce,u.pendingToken=c.pendingToken||null,u}_getIdTokenResponse(e){const t=this.buildRequest();return Qc(e,t)}_linkToIdToken(e,t){const s=this.buildRequest();return s.idToken=t,Qc(e,s)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Qc(e,t)}buildRequest(){const e={requestUri:sD,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=gh(t)}return e}}function rD(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function iD(n){const e=Rd(Id(n)).link,t=e?Rd(Id(e)).deep_link_id:null,s=Rd(Id(n)).deep_link_id;return(s?Rd(Id(s)).link:null)||s||t||e||n}class _v{constructor(e){const t=Rd(Id(e)),s=t.apiKey??null,o=t.oobCode??null,c=rD(t.mode??null);qt(s&&o&&c,"argument-error"),this.apiKey=s,this.operation=c,this.code=o,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=iD(e);try{return new _v(t)}catch{return null}}}class Tu{constructor(){this.providerId=Tu.PROVIDER_ID}static credential(e,t){return Zd._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const s=_v.parseLink(t);return qt(s,"argument-error"),Zd._fromEmailAndCode(e,s.code,s.tenantId)}}Tu.PROVIDER_ID="password";Tu.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Tu.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Gk{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class vh extends Gk{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class To extends vh{constructor(){super("facebook.com")}static credential(e){return Ml._fromParams({providerId:To.PROVIDER_ID,signInMethod:To.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return To.credentialFromTaggedObject(e)}static credentialFromError(e){return To.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return To.credential(e.oauthAccessToken)}catch{return null}}}To.FACEBOOK_SIGN_IN_METHOD="facebook.com";To.PROVIDER_ID="facebook.com";class ko extends vh{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Ml._fromParams({providerId:ko.PROVIDER_ID,signInMethod:ko.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ko.credentialFromTaggedObject(e)}static credentialFromError(e){return ko.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s}=e;if(!t&&!s)return null;try{return ko.credential(t,s)}catch{return null}}}ko.GOOGLE_SIGN_IN_METHOD="google.com";ko.PROVIDER_ID="google.com";class Eo extends vh{constructor(){super("github.com")}static credential(e){return Ml._fromParams({providerId:Eo.PROVIDER_ID,signInMethod:Eo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Eo.credentialFromTaggedObject(e)}static credentialFromError(e){return Eo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Eo.credential(e.oauthAccessToken)}catch{return null}}}Eo.GITHUB_SIGN_IN_METHOD="github.com";Eo.PROVIDER_ID="github.com";class So extends vh{constructor(){super("twitter.com")}static credential(e,t){return Ml._fromParams({providerId:So.PROVIDER_ID,signInMethod:So.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return So.credentialFromTaggedObject(e)}static credentialFromError(e){return So.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:s}=e;if(!t||!s)return null;try{return So.credential(t,s)}catch{return null}}}So.TWITTER_SIGN_IN_METHOD="twitter.com";So.PROVIDER_ID="twitter.com";async function aD(n,e){return bh(n,"POST","/v1/accounts:signUp",Ua(n,e))}class Ll{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,s,o=!1){const c=await Mi._fromIdTokenResponse(e,s,o),u=Gw(s);return new Ll({user:c,providerId:u,_tokenResponse:s,operationType:t})}static async _forOperation(e,t,s){await e._updateTokensIfNecessary(s,!0);const o=Gw(s);return new Ll({user:e,providerId:o,_tokenResponse:s,operationType:t})}}function Gw(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Im extends la{constructor(e,t,s,o){super(t.code,t.message),this.operationType=s,this.user=o,Object.setPrototypeOf(this,Im.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,t,s,o){return new Im(e,t,s,o)}}function Kk(n,e,t,s){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(c=>{throw c.code==="auth/multi-factor-auth-required"?Im._fromErrorAndOperation(n,c,e,s):c})}async function oD(n,e,t=!1){const s=await Jd(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Ll._forOperation(n,"link",s)}async function lD(n,e,t=!1){const{auth:s}=n;if(si(s.app))return Promise.reject(Ra(s));const o="reauthenticate";try{const c=await Jd(n,Kk(s,o,e,n),t);qt(c.idToken,s,"internal-error");const u=bv(c.idToken);qt(u,s,"internal-error");const{sub:h}=u;return qt(n.uid===h,s,"user-mismatch"),Ll._forOperation(n,o,c)}catch(c){throw c?.code==="auth/user-not-found"&&Vi(s,"user-mismatch"),c}}async function Qk(n,e,t=!1){if(si(n.app))return Promise.reject(Ra(n));const s="signIn",o=await Kk(n,s,e),c=await Ll._fromIdTokenResponse(n,s,o);return t||await n._updateCurrentUser(c.user),c}async function cD(n,e){return Qk(Go(n),e)}async function Yk(n){const e=Go(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function uD(n,e,t){const s=Go(n);await Rm(s,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",eD)}async function dD(n,e,t){if(si(n.app))return Promise.reject(Ra(n));const s=Go(n),u=await Rm(s,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",aD).catch(m=>{throw m.code==="auth/password-does-not-meet-requirements"&&Yk(n),m}),h=await Ll._fromIdTokenResponse(s,"signIn",u);return await s._updateCurrentUser(h.user),h}function hD(n,e,t){return si(n.app)?Promise.reject(Ra(n)):cD(jn(n),Tu.credential(e,t)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&Yk(n),s})}async function LO(n,e){const t=jn(n),o={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()},{email:c}=await Z4(t.auth,o);c!==n.email&&await n.reload()}function Kw(n,e){return jn(n).setPersistence(e)}function fD(n,e,t,s){return jn(n).onIdTokenChanged(e,t,s)}function mD(n,e,t){return jn(n).beforeAuthStateChanged(e,t)}function pD(n,e,t,s){return jn(n).onAuthStateChanged(e,t,s)}function gD(n){return jn(n).signOut()}const Dm="__sak";class Xk{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Dm,"1"),this.storage.removeItem(Dm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const yD=1e3,bD=10;class Jk extends Xk{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Fk(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const s=this.storage.getItem(t),o=this.localCache[t];s!==o&&e(t,o,s)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((u,h,m)=>{this.notifyListeners(u,m)});return}const s=e.key;t?this.detachListener():this.stopPolling();const o=()=>{const u=this.storage.getItem(s);!t&&this.localCache[s]===u||this.notifyListeners(s,u)},c=this.storage.getItem(s);I4()&&c!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,bD):o()}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const o of Array.from(s))o(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:s}),!0)})},yD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Jk.type="LOCAL";const Eb=Jk;class Zk extends Xk{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Zk.type="SESSION";const wv=Zk;function vD(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class rp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(o=>o.isListeningto(e));if(t)return t;const s=new rp(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:s,eventType:o,data:c}=t.data,u=this.handlersMap[o];if(!u?.size)return;t.ports[0].postMessage({status:"ack",eventId:s,eventType:o});const h=Array.from(u).map(async g=>g(t.origin,c)),m=await vD(h);t.ports[0].postMessage({status:"done",eventId:s,eventType:o,response:m})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}rp.receivers=[];function Tv(n="",e=10){let t="";for(let s=0;s<e;s++)t+=Math.floor(Math.random()*10);return n+t}class xD{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,s=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let c,u;return new Promise((h,m)=>{const g=Tv("",20);o.port1.start();const b=setTimeout(()=>{m(new Error("unsupported_event"))},s);u={messageChannel:o,onMessage(x){const T=x;if(T.data.eventId===g)switch(T.data.status){case"ack":clearTimeout(b),c=setTimeout(()=>{m(new Error("timeout"))},3e3);break;case"done":clearTimeout(c),h(T.data.response);break;default:clearTimeout(b),clearTimeout(c),m(new Error("invalid_response"));break}}},this.handlers.add(u),o.port1.addEventListener("message",u.onMessage),this.target.postMessage({eventType:e,eventId:g,data:t},[o.port2])}).finally(()=>{u&&this.removeMessageHandler(u)})}}function na(){return window}function _D(n){na().location.href=n}function eE(){return typeof na().WorkerGlobalScope<"u"&&typeof na().importScripts=="function"}async function wD(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function TD(){return navigator?.serviceWorker?.controller||null}function kD(){return eE()?self:null}const tE="firebaseLocalStorageDb",ED=1,Pm="firebaseLocalStorage",nE="fbase_key";class xh{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function ip(n,e){return n.transaction([Pm],e?"readwrite":"readonly").objectStore(Pm)}function SD(){const n=indexedDB.deleteDatabase(tE);return new xh(n).toPromise()}function Sb(){const n=indexedDB.open(tE,ED);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const s=n.result;try{s.createObjectStore(Pm,{keyPath:nE})}catch(o){t(o)}}),n.addEventListener("success",async()=>{const s=n.result;s.objectStoreNames.contains(Pm)?e(s):(s.close(),await SD(),e(await Sb()))})})}async function Qw(n,e,t){const s=ip(n,!0).put({[nE]:e,value:t});return new xh(s).toPromise()}async function jD(n,e){const t=ip(n,!1).get(e),s=await new xh(t).toPromise();return s===void 0?null:s.value}function Yw(n,e){const t=ip(n,!0).delete(e);return new xh(t).toPromise()}const ND=800,CD=3;class sE{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Sb(),this.db)}async _withRetries(e){let t=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(t++>CD)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return eE()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=rp._getInstance(kD()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await wD(),!this.activeServiceWorker)return;this.sender=new xD(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||TD()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Sb();return await Qw(e,Dm,"1"),await Yw(e,Dm),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(s=>Qw(s,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(s=>jD(s,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Yw(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const c=ip(o,!1).getAll();return new xh(c).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],s=new Set;if(e.length!==0)for(const{fbase_key:o,value:c}of e)s.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(c)&&(this.notifyListeners(o,c),t.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!s.has(o)&&(this.notifyListeners(o,null),t.push(o));return t}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const o of Array.from(s))o(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),ND)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}sE.type="LOCAL";const AD=sE;new yh(3e4,6e4);function RD(n,e){return e?Na(e):(qt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class kv extends xv{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Qc(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Qc(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Qc(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function ID(n){return Qk(n.auth,new kv(n),n.bypassAuthState)}function DD(n){const{auth:e,user:t}=n;return qt(t,e,"internal-error"),lD(t,new kv(n),n.bypassAuthState)}async function PD(n){const{auth:e,user:t}=n;return qt(t,e,"internal-error"),oD(t,new kv(n),n.bypassAuthState)}class rE{constructor(e,t,s,o,c=!1){this.auth=e,this.resolver=s,this.user=o,this.bypassAuthState=c,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:s,postBody:o,tenantId:c,error:u,type:h}=e;if(u){this.reject(u);return}const m={auth:this.auth,requestUri:t,sessionId:s,tenantId:c||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(h)(m))}catch(g){this.reject(g)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return ID;case"linkViaPopup":case"linkViaRedirect":return PD;case"reauthViaPopup":case"reauthViaRedirect":return DD;default:Vi(this.auth,"internal-error")}}resolve(e){Ma(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ma(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const MD=new yh(2e3,1e4);class Wc extends rE{constructor(e,t,s,o,c){super(e,t,o,c),this.provider=s,this.authWindow=null,this.pollId=null,Wc.currentPopupAction&&Wc.currentPopupAction.cancel(),Wc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return qt(e,this.auth,"internal-error"),e}async onExecution(){Ma(this.filter.length===1,"Popup operations only handle one event");const e=Tv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(ta(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(ta(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Wc.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ta(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,MD.get())};e()}}Wc.currentPopupAction=null;const LD="pendingRedirect",dm=new Map;class VD extends rE{constructor(e,t,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,s),this.eventId=null}async execute(){let e=dm.get(this.auth._key());if(!e){try{const s=await OD(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(t){e=()=>Promise.reject(t)}dm.set(this.auth._key(),e)}return this.bypassAuthState||dm.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function OD(n,e){const t=FD(e),s=UD(n);if(!await s._isAvailable())return!1;const o=await s._get(t)==="true";return await s._remove(t),o}function BD(n,e){dm.set(n._key(),e)}function UD(n){return Na(n._redirectPersistence)}function FD(n){return um(LD,n.config.apiKey,n.name)}async function zD(n,e,t=!1){if(si(n.app))return Promise.reject(Ra(n));const s=Go(n),o=RD(s,e),u=await new VD(s,o,t).execute();return u&&!t&&(delete u.user._redirectEventId,await s._persistUserIfCurrent(u.user),await s._setRedirectUser(null,e)),u}const qD=600*1e3;class HD{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(t=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!$D(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!iE(e)){const s=e.error.code?.split("auth/")[1]||"internal-error";t.onError(ta(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const s=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=qD&&this.cachedEventUids.clear(),this.cachedEventUids.has(Xw(e))}saveEventToCache(e){this.cachedEventUids.add(Xw(e)),this.lastProcessedEventTime=Date.now()}}function Xw(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function iE({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function $D(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return iE(n);default:return!1}}async function WD(n,e={}){return Fa(n,"GET","/v1/projects",e)}const GD=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,KD=/^https?/;async function QD(n){if(n.config.emulator)return;const{authorizedDomains:e}=await WD(n);for(const t of e)try{if(YD(t))return}catch{}Vi(n,"unauthorized-domain")}function YD(n){const e=Tb(),{protocol:t,hostname:s}=new URL(e);if(n.startsWith("chrome-extension://")){const u=new URL(n);return u.hostname===""&&s===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&u.hostname===s}if(!KD.test(t))return!1;if(GD.test(n))return s===n;const o=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(s)}const XD=new yh(3e4,6e4);function Jw(){const n=na().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function JD(n){return new Promise((e,t)=>{function s(){Jw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Jw(),t(ta(n,"network-request-failed"))},timeout:XD.get()})}if(na().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(na().gapi?.load)s();else{const o=F4("iframefcb");return na()[o]=()=>{gapi.load?s():t(ta(n,"network-request-failed"))},qk(`${U4()}?onload=${o}`).catch(c=>t(c))}}).catch(e=>{throw hm=null,e})}let hm=null;function ZD(n){return hm=hm||JD(n),hm}const eP=new yh(5e3,15e3),tP="__/auth/iframe",nP="emulator/auth/iframe",sP={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},rP=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function iP(n){const e=n.config;qt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?yv(e,nP):`https://${n.config.authDomain}/${tP}`,s={apiKey:e.apiKey,appName:n.name,v:Kl},o=rP.get(n.config.apiHost);o&&(s.eid=o);const c=n._getFrameworks();return c.length&&(s.fw=c.join(",")),`${t}?${gh(s).slice(1)}`}async function aP(n){const e=await ZD(n),t=na().gapi;return qt(t,n,"internal-error"),e.open({where:document.body,url:iP(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:sP,dontclear:!0},s=>new Promise(async(o,c)=>{await s.restyle({setHideOnLeave:!1});const u=ta(n,"network-request-failed"),h=na().setTimeout(()=>{c(u)},eP.get());function m(){na().clearTimeout(h),o(s)}s.ping(m).then(m,()=>{c(u)})}))}const oP={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},lP=500,cP=600,uP="_blank",dP="http://localhost";class Zw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function hP(n,e,t,s=lP,o=cP){const c=Math.max((window.screen.availHeight-o)/2,0).toString(),u=Math.max((window.screen.availWidth-s)/2,0).toString();let h="";const m={...oP,width:s.toString(),height:o.toString(),top:c,left:u},g=Js().toLowerCase();t&&(h=Lk(g)?uP:t),Pk(g)&&(e=e||dP,m.scrollbars="yes");const b=Object.entries(m).reduce((T,[N,B])=>`${T}${N}=${B},`,"");if(R4(g)&&h!=="_self")return fP(e||"",h),new Zw(null);const x=window.open(e||"",h,b);qt(x,n,"popup-blocked");try{x.focus()}catch{}return new Zw(x)}function fP(n,e){const t=document.createElement("a");t.href=n,t.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(s)}const mP="__/auth/handler",pP="emulator/auth/handler",gP=encodeURIComponent("fac");async function e2(n,e,t,s,o,c){qt(n.config.authDomain,n,"auth-domain-config-required"),qt(n.config.apiKey,n,"invalid-api-key");const u={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:s,v:Kl,eventId:o};if(e instanceof Gk){e.setDefaultLanguage(n.languageCode),u.providerId=e.providerId||"",JR(e.getCustomParameters())||(u.customParameters=JSON.stringify(e.getCustomParameters()));for(const[b,x]of Object.entries({}))u[b]=x}if(e instanceof vh){const b=e.getScopes().filter(x=>x!=="");b.length>0&&(u.scopes=b.join(","))}n.tenantId&&(u.tid=n.tenantId);const h=u;for(const b of Object.keys(h))h[b]===void 0&&delete h[b];const m=await n._getAppCheckToken(),g=m?`#${gP}=${encodeURIComponent(m)}`:"";return`${yP(n)}?${gh(h).slice(1)}${g}`}function yP({config:n}){return n.emulator?yv(n,pP):`https://${n.authDomain}/${mP}`}const zy="webStorageSupport";class bP{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=wv,this._completeRedirectFn=zD,this._overrideRedirectResult=BD}async _openPopup(e,t,s,o){Ma(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const c=await e2(e,t,s,Tb(),o);return hP(e,c,Tv())}async _openRedirect(e,t,s,o){await this._originValidation(e);const c=await e2(e,t,s,Tb(),o);return _D(c),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:o,promise:c}=this.eventManagers[t];return o?Promise.resolve(o):(Ma(c,"If manager is not set, promise should be"),c)}const s=this.initAndGetManager(e);return this.eventManagers[t]={promise:s},s.catch(()=>{delete this.eventManagers[t]}),s}async initAndGetManager(e){const t=await aP(e),s=new HD(e);return t.register("authEvent",o=>(qt(o?.authEvent,e,"invalid-auth-event"),{status:s.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=t,s}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(zy,{type:zy},o=>{const c=o?.[0]?.[zy];c!==void 0&&t(!!c),Vi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=QD(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Fk()||Mk()||vv()}}const vP=bP;var t2="@firebase/auth",n2="1.12.0";class xP{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(s=>{e(s?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){qt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function _P(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function wP(n){Pl(new Bo("auth",(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),c=e.getProvider("app-check-internal"),{apiKey:u,authDomain:h}=s.options;qt(u&&!u.includes(":"),"invalid-api-key",{appName:s.name});const m={apiKey:u,authDomain:h,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:zk(n)},g=new V4(s,o,c,m);return G4(g,t),g},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,s)=>{e.getProvider("auth-internal").initialize()})),Pl(new Bo("auth-internal",e=>{const t=Go(e.getProvider("auth").getImmediate());return(s=>new xP(s))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ea(t2,n2,_P(n)),ea(t2,n2,"esm2020")}const TP=300,kP=gk("authIdTokenMaxAge")||TP;let s2=null;const EP=n=>async e=>{const t=e&&await e.getIdTokenResult(),s=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(s&&s>kP)return;const o=t?.token;s2!==o&&(s2=o,await fetch(n,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function aE(n=pv()){const e=wu(n,"auth");if(e.isInitialized())return e.getImmediate();const t=W4(n,{popupRedirectResolver:vP,persistence:[AD,Eb,wv]}),s=gk("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const c=new URL(s,location.origin);if(location.origin===c.origin){const u=EP(c.toString());mD(t,u,()=>u(t.currentUser)),fD(t,h=>u(h))}}const o=fk("auth");return o&&K4(t,`http://${o}`),t}function SP(){return document.getElementsByTagName("head")?.[0]??document}O4({loadJS(n){return new Promise((e,t)=>{const s=document.createElement("script");s.setAttribute("src",n),s.onload=e,s.onerror=o=>{const c=ta("internal-error");c.customData=o,t(c)},s.type="text/javascript",s.charset="UTF-8",SP().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});wP("Browser");var r2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Vo,oE;(function(){var n;function e(C,S){function D(){}D.prototype=S.prototype,C.F=S.prototype,C.prototype=new D,C.prototype.constructor=C,C.D=function(U,V,q){for(var L=Array(arguments.length-2),Ke=2;Ke<arguments.length;Ke++)L[Ke-2]=arguments[Ke];return S.prototype[V].apply(U,L)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(s,t),s.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(C,S,D){D||(D=0);const U=Array(16);if(typeof S=="string")for(var V=0;V<16;++V)U[V]=S.charCodeAt(D++)|S.charCodeAt(D++)<<8|S.charCodeAt(D++)<<16|S.charCodeAt(D++)<<24;else for(V=0;V<16;++V)U[V]=S[D++]|S[D++]<<8|S[D++]<<16|S[D++]<<24;S=C.g[0],D=C.g[1],V=C.g[2];let q=C.g[3],L;L=S+(q^D&(V^q))+U[0]+3614090360&4294967295,S=D+(L<<7&4294967295|L>>>25),L=q+(V^S&(D^V))+U[1]+3905402710&4294967295,q=S+(L<<12&4294967295|L>>>20),L=V+(D^q&(S^D))+U[2]+606105819&4294967295,V=q+(L<<17&4294967295|L>>>15),L=D+(S^V&(q^S))+U[3]+3250441966&4294967295,D=V+(L<<22&4294967295|L>>>10),L=S+(q^D&(V^q))+U[4]+4118548399&4294967295,S=D+(L<<7&4294967295|L>>>25),L=q+(V^S&(D^V))+U[5]+1200080426&4294967295,q=S+(L<<12&4294967295|L>>>20),L=V+(D^q&(S^D))+U[6]+2821735955&4294967295,V=q+(L<<17&4294967295|L>>>15),L=D+(S^V&(q^S))+U[7]+4249261313&4294967295,D=V+(L<<22&4294967295|L>>>10),L=S+(q^D&(V^q))+U[8]+1770035416&4294967295,S=D+(L<<7&4294967295|L>>>25),L=q+(V^S&(D^V))+U[9]+2336552879&4294967295,q=S+(L<<12&4294967295|L>>>20),L=V+(D^q&(S^D))+U[10]+4294925233&4294967295,V=q+(L<<17&4294967295|L>>>15),L=D+(S^V&(q^S))+U[11]+2304563134&4294967295,D=V+(L<<22&4294967295|L>>>10),L=S+(q^D&(V^q))+U[12]+1804603682&4294967295,S=D+(L<<7&4294967295|L>>>25),L=q+(V^S&(D^V))+U[13]+4254626195&4294967295,q=S+(L<<12&4294967295|L>>>20),L=V+(D^q&(S^D))+U[14]+2792965006&4294967295,V=q+(L<<17&4294967295|L>>>15),L=D+(S^V&(q^S))+U[15]+1236535329&4294967295,D=V+(L<<22&4294967295|L>>>10),L=S+(V^q&(D^V))+U[1]+4129170786&4294967295,S=D+(L<<5&4294967295|L>>>27),L=q+(D^V&(S^D))+U[6]+3225465664&4294967295,q=S+(L<<9&4294967295|L>>>23),L=V+(S^D&(q^S))+U[11]+643717713&4294967295,V=q+(L<<14&4294967295|L>>>18),L=D+(q^S&(V^q))+U[0]+3921069994&4294967295,D=V+(L<<20&4294967295|L>>>12),L=S+(V^q&(D^V))+U[5]+3593408605&4294967295,S=D+(L<<5&4294967295|L>>>27),L=q+(D^V&(S^D))+U[10]+38016083&4294967295,q=S+(L<<9&4294967295|L>>>23),L=V+(S^D&(q^S))+U[15]+3634488961&4294967295,V=q+(L<<14&4294967295|L>>>18),L=D+(q^S&(V^q))+U[4]+3889429448&4294967295,D=V+(L<<20&4294967295|L>>>12),L=S+(V^q&(D^V))+U[9]+568446438&4294967295,S=D+(L<<5&4294967295|L>>>27),L=q+(D^V&(S^D))+U[14]+3275163606&4294967295,q=S+(L<<9&4294967295|L>>>23),L=V+(S^D&(q^S))+U[3]+4107603335&4294967295,V=q+(L<<14&4294967295|L>>>18),L=D+(q^S&(V^q))+U[8]+1163531501&4294967295,D=V+(L<<20&4294967295|L>>>12),L=S+(V^q&(D^V))+U[13]+2850285829&4294967295,S=D+(L<<5&4294967295|L>>>27),L=q+(D^V&(S^D))+U[2]+4243563512&4294967295,q=S+(L<<9&4294967295|L>>>23),L=V+(S^D&(q^S))+U[7]+1735328473&4294967295,V=q+(L<<14&4294967295|L>>>18),L=D+(q^S&(V^q))+U[12]+2368359562&4294967295,D=V+(L<<20&4294967295|L>>>12),L=S+(D^V^q)+U[5]+4294588738&4294967295,S=D+(L<<4&4294967295|L>>>28),L=q+(S^D^V)+U[8]+2272392833&4294967295,q=S+(L<<11&4294967295|L>>>21),L=V+(q^S^D)+U[11]+1839030562&4294967295,V=q+(L<<16&4294967295|L>>>16),L=D+(V^q^S)+U[14]+4259657740&4294967295,D=V+(L<<23&4294967295|L>>>9),L=S+(D^V^q)+U[1]+2763975236&4294967295,S=D+(L<<4&4294967295|L>>>28),L=q+(S^D^V)+U[4]+1272893353&4294967295,q=S+(L<<11&4294967295|L>>>21),L=V+(q^S^D)+U[7]+4139469664&4294967295,V=q+(L<<16&4294967295|L>>>16),L=D+(V^q^S)+U[10]+3200236656&4294967295,D=V+(L<<23&4294967295|L>>>9),L=S+(D^V^q)+U[13]+681279174&4294967295,S=D+(L<<4&4294967295|L>>>28),L=q+(S^D^V)+U[0]+3936430074&4294967295,q=S+(L<<11&4294967295|L>>>21),L=V+(q^S^D)+U[3]+3572445317&4294967295,V=q+(L<<16&4294967295|L>>>16),L=D+(V^q^S)+U[6]+76029189&4294967295,D=V+(L<<23&4294967295|L>>>9),L=S+(D^V^q)+U[9]+3654602809&4294967295,S=D+(L<<4&4294967295|L>>>28),L=q+(S^D^V)+U[12]+3873151461&4294967295,q=S+(L<<11&4294967295|L>>>21),L=V+(q^S^D)+U[15]+530742520&4294967295,V=q+(L<<16&4294967295|L>>>16),L=D+(V^q^S)+U[2]+3299628645&4294967295,D=V+(L<<23&4294967295|L>>>9),L=S+(V^(D|~q))+U[0]+4096336452&4294967295,S=D+(L<<6&4294967295|L>>>26),L=q+(D^(S|~V))+U[7]+1126891415&4294967295,q=S+(L<<10&4294967295|L>>>22),L=V+(S^(q|~D))+U[14]+2878612391&4294967295,V=q+(L<<15&4294967295|L>>>17),L=D+(q^(V|~S))+U[5]+4237533241&4294967295,D=V+(L<<21&4294967295|L>>>11),L=S+(V^(D|~q))+U[12]+1700485571&4294967295,S=D+(L<<6&4294967295|L>>>26),L=q+(D^(S|~V))+U[3]+2399980690&4294967295,q=S+(L<<10&4294967295|L>>>22),L=V+(S^(q|~D))+U[10]+4293915773&4294967295,V=q+(L<<15&4294967295|L>>>17),L=D+(q^(V|~S))+U[1]+2240044497&4294967295,D=V+(L<<21&4294967295|L>>>11),L=S+(V^(D|~q))+U[8]+1873313359&4294967295,S=D+(L<<6&4294967295|L>>>26),L=q+(D^(S|~V))+U[15]+4264355552&4294967295,q=S+(L<<10&4294967295|L>>>22),L=V+(S^(q|~D))+U[6]+2734768916&4294967295,V=q+(L<<15&4294967295|L>>>17),L=D+(q^(V|~S))+U[13]+1309151649&4294967295,D=V+(L<<21&4294967295|L>>>11),L=S+(V^(D|~q))+U[4]+4149444226&4294967295,S=D+(L<<6&4294967295|L>>>26),L=q+(D^(S|~V))+U[11]+3174756917&4294967295,q=S+(L<<10&4294967295|L>>>22),L=V+(S^(q|~D))+U[2]+718787259&4294967295,V=q+(L<<15&4294967295|L>>>17),L=D+(q^(V|~S))+U[9]+3951481745&4294967295,C.g[0]=C.g[0]+S&4294967295,C.g[1]=C.g[1]+(V+(L<<21&4294967295|L>>>11))&4294967295,C.g[2]=C.g[2]+V&4294967295,C.g[3]=C.g[3]+q&4294967295}s.prototype.v=function(C,S){S===void 0&&(S=C.length);const D=S-this.blockSize,U=this.C;let V=this.h,q=0;for(;q<S;){if(V==0)for(;q<=D;)o(this,C,q),q+=this.blockSize;if(typeof C=="string"){for(;q<S;)if(U[V++]=C.charCodeAt(q++),V==this.blockSize){o(this,U),V=0;break}}else for(;q<S;)if(U[V++]=C[q++],V==this.blockSize){o(this,U),V=0;break}}this.h=V,this.o+=S},s.prototype.A=function(){var C=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);C[0]=128;for(var S=1;S<C.length-8;++S)C[S]=0;S=this.o*8;for(var D=C.length-8;D<C.length;++D)C[D]=S&255,S/=256;for(this.v(C),C=Array(16),S=0,D=0;D<4;++D)for(let U=0;U<32;U+=8)C[S++]=this.g[D]>>>U&255;return C};function c(C,S){var D=h;return Object.prototype.hasOwnProperty.call(D,C)?D[C]:D[C]=S(C)}function u(C,S){this.h=S;const D=[];let U=!0;for(let V=C.length-1;V>=0;V--){const q=C[V]|0;U&&q==S||(D[V]=q,U=!1)}this.g=D}var h={};function m(C){return-128<=C&&C<128?c(C,function(S){return new u([S|0],S<0?-1:0)}):new u([C|0],C<0?-1:0)}function g(C){if(isNaN(C)||!isFinite(C))return x;if(C<0)return M(g(-C));const S=[];let D=1;for(let U=0;C>=D;U++)S[U]=C/D|0,D*=4294967296;return new u(S,0)}function b(C,S){if(C.length==0)throw Error("number format error: empty string");if(S=S||10,S<2||36<S)throw Error("radix out of range: "+S);if(C.charAt(0)=="-")return M(b(C.substring(1),S));if(C.indexOf("-")>=0)throw Error('number format error: interior "-" character');const D=g(Math.pow(S,8));let U=x;for(let q=0;q<C.length;q+=8){var V=Math.min(8,C.length-q);const L=parseInt(C.substring(q,q+V),S);V<8?(V=g(Math.pow(S,V)),U=U.j(V).add(g(L))):(U=U.j(D),U=U.add(g(L)))}return U}var x=m(0),T=m(1),N=m(16777216);n=u.prototype,n.m=function(){if(P(this))return-M(this).m();let C=0,S=1;for(let D=0;D<this.g.length;D++){const U=this.i(D);C+=(U>=0?U:4294967296+U)*S,S*=4294967296}return C},n.toString=function(C){if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(B(this))return"0";if(P(this))return"-"+M(this).toString(C);const S=g(Math.pow(C,6));var D=this;let U="";for(;;){const V=fe(D,S).g;D=Y(D,V.j(S));let q=((D.g.length>0?D.g[0]:D.h)>>>0).toString(C);if(D=V,B(D))return q+U;for(;q.length<6;)q="0"+q;U=q+U}},n.i=function(C){return C<0?0:C<this.g.length?this.g[C]:this.h};function B(C){if(C.h!=0)return!1;for(let S=0;S<C.g.length;S++)if(C.g[S]!=0)return!1;return!0}function P(C){return C.h==-1}n.l=function(C){return C=Y(this,C),P(C)?-1:B(C)?0:1};function M(C){const S=C.g.length,D=[];for(let U=0;U<S;U++)D[U]=~C.g[U];return new u(D,~C.h).add(T)}n.abs=function(){return P(this)?M(this):this},n.add=function(C){const S=Math.max(this.g.length,C.g.length),D=[];let U=0;for(let V=0;V<=S;V++){let q=U+(this.i(V)&65535)+(C.i(V)&65535),L=(q>>>16)+(this.i(V)>>>16)+(C.i(V)>>>16);U=L>>>16,q&=65535,L&=65535,D[V]=L<<16|q}return new u(D,D[D.length-1]&-2147483648?-1:0)};function Y(C,S){return C.add(M(S))}n.j=function(C){if(B(this)||B(C))return x;if(P(this))return P(C)?M(this).j(M(C)):M(M(this).j(C));if(P(C))return M(this.j(M(C)));if(this.l(N)<0&&C.l(N)<0)return g(this.m()*C.m());const S=this.g.length+C.g.length,D=[];for(var U=0;U<2*S;U++)D[U]=0;for(U=0;U<this.g.length;U++)for(let V=0;V<C.g.length;V++){const q=this.i(U)>>>16,L=this.i(U)&65535,Ke=C.i(V)>>>16,_t=C.i(V)&65535;D[2*U+2*V]+=L*_t,H(D,2*U+2*V),D[2*U+2*V+1]+=q*_t,H(D,2*U+2*V+1),D[2*U+2*V+1]+=L*Ke,H(D,2*U+2*V+1),D[2*U+2*V+2]+=q*Ke,H(D,2*U+2*V+2)}for(C=0;C<S;C++)D[C]=D[2*C+1]<<16|D[2*C];for(C=S;C<2*S;C++)D[C]=0;return new u(D,0)};function H(C,S){for(;(C[S]&65535)!=C[S];)C[S+1]+=C[S]>>>16,C[S]&=65535,S++}function X(C,S){this.g=C,this.h=S}function fe(C,S){if(B(S))throw Error("division by zero");if(B(C))return new X(x,x);if(P(C))return S=fe(M(C),S),new X(M(S.g),M(S.h));if(P(S))return S=fe(C,M(S)),new X(M(S.g),S.h);if(C.g.length>30){if(P(C)||P(S))throw Error("slowDivide_ only works with positive integers.");for(var D=T,U=S;U.l(C)<=0;)D=je(D),U=je(U);var V=Te(D,1),q=Te(U,1);for(U=Te(U,2),D=Te(D,2);!B(U);){var L=q.add(U);L.l(C)<=0&&(V=V.add(D),q=L),U=Te(U,1),D=Te(D,1)}return S=Y(C,V.j(S)),new X(V,S)}for(V=x;C.l(S)>=0;){for(D=Math.max(1,Math.floor(C.m()/S.m())),U=Math.ceil(Math.log(D)/Math.LN2),U=U<=48?1:Math.pow(2,U-48),q=g(D),L=q.j(S);P(L)||L.l(C)>0;)D-=U,q=g(D),L=q.j(S);B(q)&&(q=T),V=V.add(q),C=Y(C,L)}return new X(V,C)}n.B=function(C){return fe(this,C).h},n.and=function(C){const S=Math.max(this.g.length,C.g.length),D=[];for(let U=0;U<S;U++)D[U]=this.i(U)&C.i(U);return new u(D,this.h&C.h)},n.or=function(C){const S=Math.max(this.g.length,C.g.length),D=[];for(let U=0;U<S;U++)D[U]=this.i(U)|C.i(U);return new u(D,this.h|C.h)},n.xor=function(C){const S=Math.max(this.g.length,C.g.length),D=[];for(let U=0;U<S;U++)D[U]=this.i(U)^C.i(U);return new u(D,this.h^C.h)};function je(C){const S=C.g.length+1,D=[];for(let U=0;U<S;U++)D[U]=C.i(U)<<1|C.i(U-1)>>>31;return new u(D,C.h)}function Te(C,S){const D=S>>5;S%=32;const U=C.g.length-D,V=[];for(let q=0;q<U;q++)V[q]=S>0?C.i(q+D)>>>S|C.i(q+D+1)<<32-S:C.i(q+D);return new u(V,C.h)}s.prototype.digest=s.prototype.A,s.prototype.reset=s.prototype.u,s.prototype.update=s.prototype.v,oE=s,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.B,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=g,u.fromString=b,Vo=u}).apply(typeof r2<"u"?r2:typeof self<"u"?self:typeof window<"u"?window:{});var Wf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var lE,Dd,cE,fm,jb,uE,dE,hE;(function(){var n,e=Object.defineProperty;function t(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof Wf=="object"&&Wf];for(var v=0;v<f.length;++v){var k=f[v];if(k&&k.Math==Math)return k}throw Error("Cannot find global object")}var s=t(this);function o(f,v){if(v)e:{var k=s;f=f.split(".");for(var R=0;R<f.length-1;R++){var ae=f[R];if(!(ae in k))break e;k=k[ae]}f=f[f.length-1],R=k[f],v=v(R),v!=R&&v!=null&&e(k,f,{configurable:!0,writable:!0,value:v})}}o("Symbol.dispose",function(f){return f||Symbol("Symbol.dispose")}),o("Array.prototype.values",function(f){return f||function(){return this[Symbol.iterator]()}}),o("Object.entries",function(f){return f||function(v){var k=[],R;for(R in v)Object.prototype.hasOwnProperty.call(v,R)&&k.push([R,v[R]]);return k}});var c=c||{},u=this||self;function h(f){var v=typeof f;return v=="object"&&f!=null||v=="function"}function m(f,v,k){return f.call.apply(f.bind,arguments)}function g(f,v,k){return g=m,g.apply(null,arguments)}function b(f,v){var k=Array.prototype.slice.call(arguments,1);return function(){var R=k.slice();return R.push.apply(R,arguments),f.apply(this,R)}}function x(f,v){function k(){}k.prototype=v.prototype,f.Z=v.prototype,f.prototype=new k,f.prototype.constructor=f,f.Ob=function(R,ae,pe){for(var Xe=Array(arguments.length-2),sn=2;sn<arguments.length;sn++)Xe[sn-2]=arguments[sn];return v.prototype[ae].apply(R,Xe)}}var T=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?f=>f&&AsyncContext.Snapshot.wrap(f):f=>f;function N(f){const v=f.length;if(v>0){const k=Array(v);for(let R=0;R<v;R++)k[R]=f[R];return k}return[]}function B(f,v){for(let R=1;R<arguments.length;R++){const ae=arguments[R];var k=typeof ae;if(k=k!="object"?k:ae?Array.isArray(ae)?"array":k:"null",k=="array"||k=="object"&&typeof ae.length=="number"){k=f.length||0;const pe=ae.length||0;f.length=k+pe;for(let Xe=0;Xe<pe;Xe++)f[k+Xe]=ae[Xe]}else f.push(ae)}}class P{constructor(v,k){this.i=v,this.j=k,this.h=0,this.g=null}get(){let v;return this.h>0?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function M(f){u.setTimeout(()=>{throw f},0)}function Y(){var f=C;let v=null;return f.g&&(v=f.g,f.g=f.g.next,f.g||(f.h=null),v.next=null),v}class H{constructor(){this.h=this.g=null}add(v,k){const R=X.get();R.set(v,k),this.h?this.h.next=R:this.g=R,this.h=R}}var X=new P(()=>new fe,f=>f.reset());class fe{constructor(){this.next=this.g=this.h=null}set(v,k){this.h=v,this.g=k,this.next=null}reset(){this.next=this.g=this.h=null}}let je,Te=!1,C=new H,S=()=>{const f=Promise.resolve(void 0);je=()=>{f.then(D)}};function D(){for(var f;f=Y();){try{f.h.call(f.g)}catch(k){M(k)}var v=X;v.j(f),v.h<100&&(v.h++,f.next=v.g,v.g=f)}Te=!1}function U(){this.u=this.u,this.C=this.C}U.prototype.u=!1,U.prototype.dispose=function(){this.u||(this.u=!0,this.N())},U.prototype[Symbol.dispose]=function(){this.dispose()},U.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function V(f,v){this.type=f,this.g=this.target=v,this.defaultPrevented=!1}V.prototype.h=function(){this.defaultPrevented=!0};var q=(function(){if(!u.addEventListener||!Object.defineProperty)return!1;var f=!1,v=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const k=()=>{};u.addEventListener("test",k,v),u.removeEventListener("test",k,v)}catch{}return f})();function L(f){return/^[\s\xa0]*$/.test(f)}function Ke(f,v){V.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f&&this.init(f,v)}x(Ke,V),Ke.prototype.init=function(f,v){const k=this.type=f.type,R=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;this.target=f.target||f.srcElement,this.g=v,v=f.relatedTarget,v||(k=="mouseover"?v=f.fromElement:k=="mouseout"&&(v=f.toElement)),this.relatedTarget=v,R?(this.clientX=R.clientX!==void 0?R.clientX:R.pageX,this.clientY=R.clientY!==void 0?R.clientY:R.pageY,this.screenX=R.screenX||0,this.screenY=R.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=f.pointerType,this.state=f.state,this.i=f,f.defaultPrevented&&Ke.Z.h.call(this)},Ke.prototype.h=function(){Ke.Z.h.call(this);const f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var _t="closure_listenable_"+(Math.random()*1e6|0),$=0;function ge(f,v,k,R,ae){this.listener=f,this.proxy=null,this.src=v,this.type=k,this.capture=!!R,this.ha=ae,this.key=++$,this.da=this.fa=!1}function Le(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function Qe(f,v,k){for(const R in f)v.call(k,f[R],R,f)}function ne(f,v){for(const k in f)v.call(void 0,f[k],k,f)}function O(f){const v={};for(const k in f)v[k]=f[k];return v}const ie="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ie(f,v){let k,R;for(let ae=1;ae<arguments.length;ae++){R=arguments[ae];for(k in R)f[k]=R[k];for(let pe=0;pe<ie.length;pe++)k=ie[pe],Object.prototype.hasOwnProperty.call(R,k)&&(f[k]=R[k])}}function Oe(f){this.src=f,this.g={},this.h=0}Oe.prototype.add=function(f,v,k,R,ae){const pe=f.toString();f=this.g[pe],f||(f=this.g[pe]=[],this.h++);const Xe=ze(f,v,R,ae);return Xe>-1?(v=f[Xe],k||(v.fa=!1)):(v=new ge(v,this.src,pe,!!R,ae),v.fa=k,f.push(v)),v};function it(f,v){const k=v.type;if(k in f.g){var R=f.g[k],ae=Array.prototype.indexOf.call(R,v,void 0),pe;(pe=ae>=0)&&Array.prototype.splice.call(R,ae,1),pe&&(Le(v),f.g[k].length==0&&(delete f.g[k],f.h--))}}function ze(f,v,k,R){for(let ae=0;ae<f.length;++ae){const pe=f[ae];if(!pe.da&&pe.listener==v&&pe.capture==!!k&&pe.ha==R)return ae}return-1}var vt="closure_lm_"+(Math.random()*1e6|0),Nt={};function at(f,v,k,R,ae){if(Array.isArray(v)){for(let pe=0;pe<v.length;pe++)at(f,v[pe],k,R,ae);return null}return k=ft(k),f&&f[_t]?f.J(v,k,h(R)?!!R.capture:!1,ae):Xt(f,v,k,!1,R,ae)}function Xt(f,v,k,R,ae,pe){if(!v)throw Error("Invalid event type");const Xe=h(ae)?!!ae.capture:!!ae;let sn=bt(f);if(sn||(f[vt]=sn=new Oe(f)),k=sn.add(v,k,R,Xe,pe),k.proxy)return k;if(R=An(),k.proxy=R,R.src=f,R.listener=k,f.addEventListener)q||(ae=Xe),ae===void 0&&(ae=!1),f.addEventListener(v.toString(),R,ae);else if(f.attachEvent)f.attachEvent(ee(v.toString()),R);else if(f.addListener&&f.removeListener)f.addListener(R);else throw Error("addEventListener and attachEvent are unavailable.");return k}function An(){function f(k){return v.call(f.src,f.listener,k)}const v=yt;return f}function Pt(f,v,k,R,ae){if(Array.isArray(v))for(var pe=0;pe<v.length;pe++)Pt(f,v[pe],k,R,ae);else R=h(R)?!!R.capture:!!R,k=ft(k),f&&f[_t]?(f=f.i,pe=String(v).toString(),pe in f.g&&(v=f.g[pe],k=ze(v,k,R,ae),k>-1&&(Le(v[k]),Array.prototype.splice.call(v,k,1),v.length==0&&(delete f.g[pe],f.h--)))):f&&(f=bt(f))&&(v=f.g[v.toString()],f=-1,v&&(f=ze(v,k,R,ae)),(k=f>-1?v[f]:null)&&Ce(k))}function Ce(f){if(typeof f!="number"&&f&&!f.da){var v=f.src;if(v&&v[_t])it(v.i,f);else{var k=f.type,R=f.proxy;v.removeEventListener?v.removeEventListener(k,R,f.capture):v.detachEvent?v.detachEvent(ee(k),R):v.addListener&&v.removeListener&&v.removeListener(R),(k=bt(v))?(it(k,f),k.h==0&&(k.src=null,v[vt]=null)):Le(f)}}}function ee(f){return f in Nt?Nt[f]:Nt[f]="on"+f}function yt(f,v){if(f.da)f=!0;else{v=new Ke(v,this);const k=f.listener,R=f.ha||f.src;f.fa&&Ce(f),f=k.call(R,v)}return f}function bt(f){return f=f[vt],f instanceof Oe?f:null}var et="__closure_events_fn_"+(Math.random()*1e9>>>0);function ft(f){return typeof f=="function"?f:(f[et]||(f[et]=function(v){return f.handleEvent(v)}),f[et])}function rt(){U.call(this),this.i=new Oe(this),this.M=this,this.G=null}x(rt,U),rt.prototype[_t]=!0,rt.prototype.removeEventListener=function(f,v,k,R){Pt(this,f,v,k,R)};function tt(f,v){var k,R=f.G;if(R)for(k=[];R;R=R.G)k.push(R);if(f=f.M,R=v.type||v,typeof v=="string")v=new V(v,f);else if(v instanceof V)v.target=v.target||f;else{var ae=v;v=new V(R,f),Ie(v,ae)}ae=!0;let pe,Xe;if(k)for(Xe=k.length-1;Xe>=0;Xe--)pe=v.g=k[Xe],ae=Ft(pe,R,!0,v)&&ae;if(pe=v.g=f,ae=Ft(pe,R,!0,v)&&ae,ae=Ft(pe,R,!1,v)&&ae,k)for(Xe=0;Xe<k.length;Xe++)pe=v.g=k[Xe],ae=Ft(pe,R,!1,v)&&ae}rt.prototype.N=function(){if(rt.Z.N.call(this),this.i){var f=this.i;for(const v in f.g){const k=f.g[v];for(let R=0;R<k.length;R++)Le(k[R]);delete f.g[v],f.h--}}this.G=null},rt.prototype.J=function(f,v,k,R){return this.i.add(String(f),v,!1,k,R)},rt.prototype.K=function(f,v,k,R){return this.i.add(String(f),v,!0,k,R)};function Ft(f,v,k,R){if(v=f.i.g[String(v)],!v)return!0;v=v.concat();let ae=!0;for(let pe=0;pe<v.length;++pe){const Xe=v[pe];if(Xe&&!Xe.da&&Xe.capture==k){const sn=Xe.listener,Ps=Xe.ha||Xe.src;Xe.fa&&it(f.i,Xe),ae=sn.call(Ps,R)!==!1&&ae}}return ae&&!R.defaultPrevented}function ts(f,v){if(typeof f!="function")if(f&&typeof f.handleEvent=="function")f=g(f.handleEvent,f);else throw Error("Invalid listener argument");return Number(v)>2147483647?-1:u.setTimeout(f,v||0)}function Dt(f){f.g=ts(()=>{f.g=null,f.i&&(f.i=!1,Dt(f))},f.l);const v=f.h;f.h=null,f.m.apply(null,v)}class un extends U{constructor(v,k){super(),this.m=v,this.l=k,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:Dt(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function fs(f){U.call(this),this.h=f,this.g={}}x(fs,U);var Yt=[];function Mn(f){Qe(f.g,function(v,k){this.g.hasOwnProperty(k)&&Ce(v)},f),f.g={}}fs.prototype.N=function(){fs.Z.N.call(this),Mn(this)},fs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var dn=u.JSON.stringify,Rn=u.JSON.parse,he=class{stringify(f){return u.JSON.stringify(f,void 0)}parse(f){return u.JSON.parse(f,void 0)}};function De(){}function Be(){}var nt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Fe(){V.call(this,"d")}x(Fe,V);function Me(){V.call(this,"c")}x(Me,V);var qe={},St=null;function wt(){return St=St||new rt}qe.Ia="serverreachability";function Mt(f){V.call(this,qe.Ia,f)}x(Mt,V);function Jt(f){const v=wt();tt(v,new Mt(v))}qe.STAT_EVENT="statevent";function Z(f,v){V.call(this,qe.STAT_EVENT,f),this.stat=v}x(Z,V);function xe(f){const v=wt();tt(v,new Z(v,f))}qe.Ja="timingevent";function ct(f,v){V.call(this,qe.Ja,f),this.size=v}x(ct,V);function Lt(f,v){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){f()},v)}function Ct(){this.g=!0}Ct.prototype.ua=function(){this.g=!1};function an(f,v,k,R,ae,pe){f.info(function(){if(f.g)if(pe){var Xe="",sn=pe.split("&");for(let Un=0;Un<sn.length;Un++){var Ps=sn[Un].split("=");if(Ps.length>1){const ps=Ps[0];Ps=Ps[1];const ui=ps.split("_");Xe=ui.length>=2&&ui[1]=="type"?Xe+(ps+"="+Ps+"&"):Xe+(ps+"=redacted&")}}}else Xe=null;else Xe=pe;return"XMLHTTP REQ ("+R+") [attempt "+ae+"]: "+v+`
`+k+`
`+Xe})}function Zt(f,v,k,R,ae,pe,Xe){f.info(function(){return"XMLHTTP RESP ("+R+") [ attempt "+ae+"]: "+v+`
`+k+`
`+pe+" "+Xe})}function Wt(f,v,k,R){f.info(function(){return"XMLHTTP TEXT ("+v+"): "+as(f,k)+(R?" "+R:"")})}function Ln(f,v){f.info(function(){return"TIMEOUT: "+v})}Ct.prototype.info=function(){};function as(f,v){if(!f.g)return v;if(!v)return null;try{const pe=JSON.parse(v);if(pe){for(f=0;f<pe.length;f++)if(Array.isArray(pe[f])){var k=pe[f];if(!(k.length<2)){var R=k[1];if(Array.isArray(R)&&!(R.length<1)){var ae=R[0];if(ae!="noop"&&ae!="stop"&&ae!="close")for(let Xe=1;Xe<R.length;Xe++)R[Xe]=""}}}}return dn(pe)}catch{return v}}var bn={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},In={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Bn;function z(){}x(z,De),z.prototype.g=function(){return new XMLHttpRequest},Bn=new z;function _e(f){return encodeURIComponent(String(f))}function ke(f){var v=1;f=f.split(":");const k=[];for(;v>0&&f.length;)k.push(f.shift()),v--;return f.length&&k.push(f.join(":")),k}function Ee(f,v,k,R){this.j=f,this.i=v,this.l=k,this.S=R||1,this.V=new fs(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new be}function be(){this.i=null,this.g="",this.h=!1}var lt={},It={};function ut(f,v,k){f.M=1,f.A=Ue(Hn(v)),f.u=k,f.R=!0,Tt(f,null)}function Tt(f,v){f.F=Date.now(),ks(f),f.B=Hn(f.A);var k=f.B,R=f.S;Array.isArray(R)||(R=[String(R)]),ws(k.i,"t",R),f.C=0,k=f.j.L,f.h=new be,f.g=Lh(f.j,k?v:null,!f.u),f.P>0&&(f.O=new un(g(f.Y,f,f.g),f.P)),v=f.V,k=f.g,R=f.ba;var ae="readystatechange";Array.isArray(ae)||(ae&&(Yt[0]=ae.toString()),ae=Yt);for(let pe=0;pe<ae.length;pe++){const Xe=at(k,ae[pe],R||v.handleEvent,!1,v.h||v);if(!Xe)break;v.g[Xe.key]=Xe}v=f.J?O(f.J):{},f.u?(f.v||(f.v="POST"),v["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.B,f.v,f.u,v)):(f.v="GET",f.g.ea(f.B,f.v,null,v)),Jt(),an(f.i,f.v,f.B,f.l,f.S,f.u)}Ee.prototype.ba=function(f){f=f.target;const v=this.O;v&&nn(f)==3?v.j():this.Y(f)},Ee.prototype.Y=function(f){try{if(f==this.g)e:{const sn=nn(this.g),Ps=this.g.ya(),Un=this.g.ca();if(!(sn<3)&&(sn!=3||this.g&&(this.h.h||this.g.la()||zt(this.g)))){this.K||sn!=4||Ps==7||(Ps==8||Un<=0?Jt(3):Jt(2)),ns(this);var v=this.g.ca();this.X=v;var k=At(this);if(this.o=v==200,Zt(this.i,this.v,this.B,this.l,this.S,sn,v),this.o){if(this.U&&!this.L){t:{if(this.g){var R,ae=this.g;if((R=ae.g?ae.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!L(R)){var pe=R;break t}}pe=null}if(f=pe)Wt(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,E(this,f);else{this.o=!1,this.m=3,xe(12),me(this),W(this);break e}}if(this.R){f=!0;let ps;for(;!this.K&&this.C<k.length;)if(ps=er(this,k),ps==It){sn==4&&(this.m=4,xe(14),f=!1),Wt(this.i,this.l,null,"[Incomplete Response]");break}else if(ps==lt){this.m=4,xe(15),Wt(this.i,this.l,k,"[Invalid Chunk]"),f=!1;break}else Wt(this.i,this.l,ps,null),E(this,ps);if(mn(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),sn!=4||k.length!=0||this.h.h||(this.m=1,xe(16),f=!1),this.o=this.o&&f,!f)Wt(this.i,this.l,k,"[Invalid Chunked Response]"),me(this),W(this);else if(k.length>0&&!this.W){this.W=!0;var Xe=this.j;Xe.g==this&&Xe.aa&&!Xe.P&&(Xe.j.info("Great, no buffering proxy detected. Bytes received: "+k.length),Sr(Xe),Xe.P=!0,xe(11))}}else Wt(this.i,this.l,k,null),E(this,k);sn==4&&me(this),this.o&&!this.K&&(sn==4?ec(this.j,this):(this.o=!1,ks(this)))}else on(this.g),v==400&&k.indexOf("Unknown SID")>0?(this.m=3,xe(12)):(this.m=0,xe(13)),me(this),W(this)}}}catch{}};function At(f){if(!mn(f))return f.g.la();const v=zt(f.g);if(v==="")return"";let k="";const R=v.length,ae=nn(f.g)==4;if(!f.h.i){if(typeof TextDecoder>"u")return me(f),W(f),"";f.h.i=new u.TextDecoder}for(let pe=0;pe<R;pe++)f.h.h=!0,k+=f.h.i.decode(v[pe],{stream:!(ae&&pe==R-1)});return v.length=0,f.h.g+=k,f.C=0,f.h.g}function mn(f){return f.g?f.v=="GET"&&f.M!=2&&f.j.Aa:!1}function er(f,v){var k=f.C,R=v.indexOf(`
`,k);return R==-1?It:(k=Number(v.substring(k,R)),isNaN(k)?lt:(R+=1,R+k>v.length?It:(v=v.slice(R,R+k),f.C=R+k,v)))}Ee.prototype.cancel=function(){this.K=!0,me(this)};function ks(f){f.T=Date.now()+f.H,Ds(f,f.H)}function Ds(f,v){if(f.D!=null)throw Error("WatchDog timer not null");f.D=Lt(g(f.aa,f),v)}function ns(f){f.D&&(u.clearTimeout(f.D),f.D=null)}Ee.prototype.aa=function(){this.D=null;const f=Date.now();f-this.T>=0?(Ln(this.i,this.B),this.M!=2&&(Jt(),xe(17)),me(this),this.m=2,W(this)):Ds(this,this.T-f)};function W(f){f.j.I==0||f.K||ec(f.j,f)}function me(f){ns(f);var v=f.O;v&&typeof v.dispose=="function"&&v.dispose(),f.O=null,Mn(f.V),f.g&&(v=f.g,f.g=null,v.abort(),v.dispose())}function E(f,v){try{var k=f.j;if(k.I!=0&&(k.g==f||$e(k.h,f))){if(!f.L&&$e(k.h,f)&&k.I==3){try{var R=k.Ba.g.parse(v)}catch{R=null}if(Array.isArray(R)&&R.length==3){var ae=R;if(ae[0]==0){e:if(!k.v){if(k.g)if(k.g.F+3e3<f.F)ca(k),Nn(k);else break e;js(k),xe(18)}}else k.xa=ae[1],0<k.xa-k.K&&ae[2]<37500&&k.F&&k.A==0&&!k.C&&(k.C=Lt(g(k.Va,k),6e3));Ye(k.h)<=1&&k.ta&&(k.ta=void 0)}else jr(k,11)}else if((f.L||k.g==f)&&ca(k),!L(v))for(ae=k.Ba.g.parse(v),v=0;v<ae.length;v++){let Un=ae[v];const ps=Un[0];if(!(ps<=k.K))if(k.K=ps,Un=Un[1],k.I==2)if(Un[0]=="c"){k.M=Un[1],k.ba=Un[2];const ui=Un[3];ui!=null&&(k.ka=ui,k.j.info("VER="+k.ka));const qi=Un[4];qi!=null&&(k.za=qi,k.j.info("SVER="+k.za));const Si=Un[5];Si!=null&&typeof Si=="number"&&Si>0&&(R=1.5*Si,k.O=R,k.j.info("backChannelRequestTimeoutMs_="+R)),R=k;const ji=f.g;if(ji){const el=ji.g?ji.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(el){var pe=R.h;pe.g||el.indexOf("spdy")==-1&&el.indexOf("quic")==-1&&el.indexOf("h2")==-1||(pe.j=pe.l,pe.g=new Set,pe.h&&(He(pe,pe.h),pe.h=null))}if(R.G){const nc=ji.g?ji.g.getResponseHeader("X-HTTP-Session-Id"):null;nc&&(R.wa=nc,se(R.J,R.G,nc))}}k.I=3,k.l&&k.l.ra(),k.aa&&(k.T=Date.now()-f.F,k.j.info("Handshake RTT: "+k.T+"ms")),R=k;var Xe=f;if(R.na=Ei(R,R.L?R.ba:null,R.W),Xe.L){Qt(R.h,Xe);var sn=Xe,Ps=R.O;Ps&&(sn.H=Ps),sn.D&&(ns(sn),ks(sn)),R.g=Xe}else vr(R);k.i.length>0&&cs(k)}else Un[0]!="stop"&&Un[0]!="close"||jr(k,7);else k.I==3&&(Un[0]=="stop"||Un[0]=="close"?Un[0]=="stop"?jr(k,7):qn(k):Un[0]!="noop"&&k.l&&k.l.qa(Un),k.A=0)}}Jt(4)}catch{}}var A=class{constructor(f,v){this.g=f,this.map=v}};function K(f){this.l=f||10,u.PerformanceNavigationTiming?(f=u.performance.getEntriesByType("navigation"),f=f.length>0&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function oe(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function Ye(f){return f.h?1:f.g?f.g.size:0}function $e(f,v){return f.h?f.h==v:f.g?f.g.has(v):!1}function He(f,v){f.g?f.g.add(v):f.h=v}function Qt(f,v){f.h&&f.h==v?f.h=null:f.g&&f.g.has(v)&&f.g.delete(v)}K.prototype.cancel=function(){if(this.i=Ot(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function Ot(f){if(f.h!=null)return f.i.concat(f.h.G);if(f.g!=null&&f.g.size!==0){let v=f.i;for(const k of f.g.values())v=v.concat(k.G);return v}return N(f.i)}var Yn=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Gs(f,v){if(f){f=f.split("&");for(let k=0;k<f.length;k++){const R=f[k].indexOf("=");let ae,pe=null;R>=0?(ae=f[k].substring(0,R),pe=f[k].substring(R+1)):ae=f[k],v(ae,pe?decodeURIComponent(pe.replace(/\+/g," ")):"")}}}function Bs(f){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let v;f instanceof Bs?(this.l=f.l,$n(this,f.j),this.o=f.o,this.g=f.g,Q(this,f.u),this.h=f.h,we(this,yr(f.i)),this.m=f.m):f&&(v=String(f).match(Yn))?(this.l=!1,$n(this,v[1]||"",!0),this.o=We(v[2]||""),this.g=We(v[3]||"",!0),Q(this,v[4]),this.h=We(v[5]||"",!0),we(this,v[6]||"",!0),this.m=We(v[7]||"")):(this.l=!1,this.i=new ci(null,this.l))}Bs.prototype.toString=function(){const f=[];var v=this.j;v&&f.push(ht(v,Bt,!0),":");var k=this.g;return(k||v=="file")&&(f.push("//"),(v=this.o)&&f.push(ht(v,Bt,!0),"@"),f.push(_e(k).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),k=this.u,k!=null&&f.push(":",String(k))),(k=this.h)&&(this.g&&k.charAt(0)!="/"&&f.push("/"),f.push(ht(k,k.charAt(0)=="/"?_s:kn,!0))),(k=this.i.toString())&&f.push("?",k),(k=this.m)&&f.push("#",ht(k,cr)),f.join("")},Bs.prototype.resolve=function(f){const v=Hn(this);let k=!!f.j;k?$n(v,f.j):k=!!f.o,k?v.o=f.o:k=!!f.g,k?v.g=f.g:k=f.u!=null;var R=f.h;if(k)Q(v,f.u);else if(k=!!f.h){if(R.charAt(0)!="/")if(this.g&&!this.h)R="/"+R;else{var ae=v.h.lastIndexOf("/");ae!=-1&&(R=v.h.slice(0,ae+1)+R)}if(ae=R,ae==".."||ae==".")R="";else if(ae.indexOf("./")!=-1||ae.indexOf("/.")!=-1){R=ae.lastIndexOf("/",0)==0,ae=ae.split("/");const pe=[];for(let Xe=0;Xe<ae.length;){const sn=ae[Xe++];sn=="."?R&&Xe==ae.length&&pe.push(""):sn==".."?((pe.length>1||pe.length==1&&pe[0]!="")&&pe.pop(),R&&Xe==ae.length&&pe.push("")):(pe.push(sn),R=!0)}R=pe.join("/")}else R=ae}return k?v.h=R:k=f.i.toString()!=="",k?we(v,yr(f.i)):k=!!f.m,k&&(v.m=f.m),v};function Hn(f){return new Bs(f)}function $n(f,v,k){f.j=k?We(v,!0):v,f.j&&(f.j=f.j.replace(/:$/,""))}function Q(f,v){if(v){if(v=Number(v),isNaN(v)||v<0)throw Error("Bad port number "+v);f.u=v}else f.u=null}function we(f,v,k){v instanceof ci?(f.i=v,Pr(f.i,f.l)):(k||(v=ht(v,vn)),f.i=new ci(v,f.l))}function se(f,v,k){f.i.set(v,k)}function Ue(f){return se(f,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),f}function We(f,v){return f?v?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function ht(f,v,k){return typeof f=="string"?(f=encodeURI(f).replace(v,kt),k&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function kt(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var Bt=/[#\/\?@]/g,kn=/[#\?:]/g,_s=/[#\?]/g,vn=/[#\?@]/g,cr=/#/g;function ci(f,v){this.h=this.g=null,this.i=f||null,this.j=!!v}function Es(f){f.g||(f.g=new Map,f.h=0,f.i&&Gs(f.i,function(v,k){f.add(decodeURIComponent(v.replace(/\+/g," ")),k)}))}n=ci.prototype,n.add=function(f,v){Es(this),this.i=null,f=ur(this,f);let k=this.g.get(f);return k||this.g.set(f,k=[]),k.push(v),this.h+=1,this};function Fi(f,v){Es(f),v=ur(f,v),f.g.has(v)&&(f.i=null,f.h-=f.g.get(v).length,f.g.delete(v))}function tr(f,v){return Es(f),v=ur(f,v),f.g.has(v)}n.forEach=function(f,v){Es(this),this.g.forEach(function(k,R){k.forEach(function(ae){f.call(v,ae,R,this)},this)},this)};function cn(f,v){Es(f);let k=[];if(typeof v=="string")tr(f,v)&&(k=k.concat(f.g.get(ur(f,v))));else for(f=Array.from(f.g.values()),v=0;v<f.length;v++)k=k.concat(f[v]);return k}n.set=function(f,v){return Es(this),this.i=null,f=ur(this,f),tr(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[v]),this.h+=1,this},n.get=function(f,v){return f?(f=cn(this,f),f.length>0?String(f[0]):v):v};function ws(f,v,k){Fi(f,v),k.length>0&&(f.i=null,f.g.set(ur(f,v),N(k)),f.h+=k.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],v=Array.from(this.g.keys());for(let R=0;R<v.length;R++){var k=v[R];const ae=_e(k);k=cn(this,k);for(let pe=0;pe<k.length;pe++){let Xe=ae;k[pe]!==""&&(Xe+="="+_e(k[pe])),f.push(Xe)}}return this.i=f.join("&")};function yr(f){const v=new ci;return v.i=f.i,f.g&&(v.g=new Map(f.g),v.h=f.h),v}function ur(f,v){return v=String(v),f.j&&(v=v.toLowerCase()),v}function Pr(f,v){v&&!f.j&&(Es(f),f.i=null,f.g.forEach(function(k,R){const ae=R.toLowerCase();R!=ae&&(Fi(this,R),ws(this,ae,k))},f)),f.j=v}function ls(f,v){const k=new Ct;if(u.Image){const R=new Image;R.onload=b(Us,k,"TestLoadImage: loaded",!0,v,R),R.onerror=b(Us,k,"TestLoadImage: error",!1,v,R),R.onabort=b(Us,k,"TestLoadImage: abort",!1,v,R),R.ontimeout=b(Us,k,"TestLoadImage: timeout",!1,v,R),u.setTimeout(function(){R.ontimeout&&R.ontimeout()},1e4),R.src=f}else v(!1)}function Ks(f,v){const k=new Ct,R=new AbortController,ae=setTimeout(()=>{R.abort(),Us(k,"TestPingServer: timeout",!1,v)},1e4);fetch(f,{signal:R.signal}).then(pe=>{clearTimeout(ae),pe.ok?Us(k,"TestPingServer: ok",!0,v):Us(k,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(ae),Us(k,"TestPingServer: error",!1,v)})}function Us(f,v,k,R,ae){try{ae&&(ae.onload=null,ae.onerror=null,ae.onabort=null,ae.ontimeout=null),R(k)}catch{}}function Mr(){this.g=new he}function Lr(f){this.i=f.Sb||null,this.h=f.ab||!1}x(Lr,De),Lr.prototype.g=function(){return new Gr(this.i,this.h)};function Gr(f,v){rt.call(this),this.H=f,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}x(Gr,rt),n=Gr.prototype,n.open=function(f,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=f,this.D=v,this.readyState=1,Kr(this)},n.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const v={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};f&&(v.body=f),(this.H||u).fetch(new Request(this.D,v)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,zi(this)),this.readyState=0},n.Pa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,Kr(this)),this.g&&(this.readyState=3,Kr(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Wa(this)}else f.text().then(this.Oa.bind(this),this.ga.bind(this))};function Wa(f){f.j.read().then(f.Ma.bind(f)).catch(f.ga.bind(f))}n.Ma=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var v=f.value?f.value:new Uint8Array(0);(v=this.B.decode(v,{stream:!f.done}))&&(this.response=this.responseText+=v)}f.done?zi(this):Kr(this),this.readyState==3&&Wa(this)}},n.Oa=function(f){this.g&&(this.response=this.responseText=f,zi(this))},n.Na=function(f){this.g&&(this.response=f,zi(this))},n.ga=function(){this.g&&zi(this)};function zi(f){f.readyState=4,f.l=null,f.j=null,f.B=null,Kr(f)}n.setRequestHeader=function(f,v){this.A.append(f,v)},n.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],v=this.h.entries();for(var k=v.next();!k.done;)k=k.value,f.push(k[0]+": "+k[1]),k=v.next();return f.join(`\r
`)};function Kr(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(Gr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function I(f){let v="";return Qe(f,function(k,R){v+=R,v+=":",v+=k,v+=`\r
`}),v}function te(f,v,k){e:{for(R in k){var R=!1;break e}R=!0}R||(k=I(k),typeof f=="string"?k!=null&&_e(k):se(f,v,k))}function Ne(f){rt.call(this),this.headers=new Map,this.L=f||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}x(Ne,rt);var st=/^https?$/i,jt=["POST","PUT"];n=Ne.prototype,n.Fa=function(f){this.H=f},n.ea=function(f,v,k,R){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);v=v?v.toUpperCase():"GET",this.D=f,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Bn.g(),this.g.onreadystatechange=T(g(this.Ca,this));try{this.B=!0,this.g.open(v,String(f),!0),this.B=!1}catch(pe){Ut(this,pe);return}if(f=k||"",k=new Map(this.headers),R)if(Object.getPrototypeOf(R)===Object.prototype)for(var ae in R)k.set(ae,R[ae]);else if(typeof R.keys=="function"&&typeof R.get=="function")for(const pe of R.keys())k.set(pe,R.get(pe));else throw Error("Unknown input type for opt_headers: "+String(R));R=Array.from(k.keys()).find(pe=>pe.toLowerCase()=="content-type"),ae=u.FormData&&f instanceof u.FormData,!(Array.prototype.indexOf.call(jt,v,void 0)>=0)||R||ae||k.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[pe,Xe]of k)this.g.setRequestHeader(pe,Xe);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(f),this.v=!1}catch(pe){Ut(this,pe)}};function Ut(f,v){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=v,f.o=5,ot(f),$t(f)}function ot(f){f.A||(f.A=!0,tt(f,"complete"),tt(f,"error"))}n.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=f||7,tt(this,"complete"),tt(this,"abort"),$t(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),$t(this,!0)),Ne.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Gt(this):this.Xa())},n.Xa=function(){Gt(this)};function Gt(f){if(f.h&&typeof c<"u"){if(f.v&&nn(f)==4)setTimeout(f.Ca.bind(f),0);else if(tt(f,"readystatechange"),nn(f)==4){f.h=!1;try{const pe=f.ca();e:switch(pe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var k;if(!(k=v)){var R;if(R=pe===0){let Xe=String(f.D).match(Yn)[1]||null;!Xe&&u.self&&u.self.location&&(Xe=u.self.location.protocol.slice(0,-1)),R=!st.test(Xe?Xe.toLowerCase():"")}k=R}if(k)tt(f,"complete"),tt(f,"success");else{f.o=6;try{var ae=nn(f)>2?f.g.statusText:""}catch{ae=""}f.l=ae+" ["+f.ca()+"]",ot(f)}}finally{$t(f)}}}}function $t(f,v){if(f.g){f.m&&(clearTimeout(f.m),f.m=null);const k=f.g;f.g=null,v||tt(f,"ready");try{k.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function nn(f){return f.g?f.g.readyState:0}n.ca=function(){try{return nn(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(f){if(this.g){var v=this.g.responseText;return f&&v.indexOf(f)==0&&(v=v.substring(f.length)),Rn(v)}};function zt(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.F){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function on(f){const v={};f=(f.g&&nn(f)>=2&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let R=0;R<f.length;R++){if(L(f[R]))continue;var k=ke(f[R]);const ae=k[0];if(k=k[1],typeof k!="string")continue;k=k.trim();const pe=v[ae]||[];v[ae]=pe,pe.push(k)}ne(v,function(R){return R.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ss(f,v,k){return k&&k.internalChannelParams&&k.internalChannelParams[f]||v}function Qs(f){this.za=0,this.i=[],this.j=new Ct,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ss("failFast",!1,f),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ss("baseRetryDelayMs",5e3,f),this.Za=Ss("retryDelaySeedMs",1e4,f),this.Ta=Ss("forwardChannelMaxRetries",2,f),this.va=Ss("forwardChannelRequestTimeoutMs",2e4,f),this.ma=f&&f.xmlHttpFactory||void 0,this.Ua=f&&f.Rb||void 0,this.Aa=f&&f.useFetchStreams||!1,this.O=void 0,this.L=f&&f.supportsCrossDomainXhr||!1,this.M="",this.h=new K(f&&f.concurrentRequestLimit),this.Ba=new Mr,this.S=f&&f.fastHandshake||!1,this.R=f&&f.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=f&&f.Pb||!1,f&&f.ua&&this.j.ua(),f&&f.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&f&&f.detectBufferingProxy||!1,this.ia=void 0,f&&f.longPollingTimeout&&f.longPollingTimeout>0&&(this.ia=f.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Qs.prototype,n.ka=8,n.I=1,n.connect=function(f,v,k,R){xe(0),this.W=f,this.H=v||{},k&&R!==void 0&&(this.H.OSID=k,this.H.OAID=R),this.F=this.X,this.J=Ei(this,null,this.W),cs(this)};function qn(f){if(ms(f),f.I==3){var v=f.V++,k=Hn(f.J);if(se(k,"SID",f.M),se(k,"RID",v),se(k,"TYPE","terminate"),dr(f,k),v=new Ee(f,f.j,v),v.M=2,v.A=Ue(Hn(k)),k=!1,u.navigator&&u.navigator.sendBeacon)try{k=u.navigator.sendBeacon(v.A.toString(),"")}catch{}!k&&u.Image&&(new Image().src=v.A,k=!0),k||(v.g=Lh(v.j,null),v.g.ea(v.A)),v.F=Date.now(),ks(v)}ki(f)}function Nn(f){f.g&&(Sr(f),f.g.cancel(),f.g=null)}function ms(f){Nn(f),f.v&&(u.clearTimeout(f.v),f.v=null),ca(f),f.h.cancel(),f.m&&(typeof f.m=="number"&&u.clearTimeout(f.m),f.m=null)}function cs(f){if(!oe(f.h)&&!f.m){f.m=!0;var v=f.Ea;je||S(),Te||(je(),Te=!0),C.add(v,f),f.D=0}}function Ys(f,v){return Ye(f.h)>=f.h.j-(f.m?1:0)?!1:f.m?(f.i=v.G.concat(f.i),!0):f.I==1||f.I==2||f.D>=(f.Sa?0:f.Ta)?!1:(f.m=Lt(g(f.Ea,f,v),tc(f,f.D)),f.D++,!0)}n.Ea=function(f){if(this.m)if(this.m=null,this.I==1){if(!f){this.V=Math.floor(Math.random()*1e5),f=this.V++;const ae=new Ee(this,this.j,f);let pe=this.o;if(this.U&&(pe?(pe=O(pe),Ie(pe,this.U)):pe=this.U),this.u!==null||this.R||(ae.J=pe,pe=null),this.S)e:{for(var v=0,k=0;k<this.i.length;k++){t:{var R=this.i[k];if("__data__"in R.map&&(R=R.map.__data__,typeof R=="string")){R=R.length;break t}R=void 0}if(R===void 0)break;if(v+=R,v>4096){v=k;break e}if(v===4096||k===this.i.length-1){v=k+1;break e}}v=1e3}else v=1e3;v=Er(this,ae,v),k=Hn(this.J),se(k,"RID",f),se(k,"CVER",22),this.G&&se(k,"X-HTTP-Session-Id",this.G),dr(this,k),pe&&(this.R?v="headers="+_e(I(pe))+"&"+v:this.u&&te(k,this.u,pe)),He(this.h,ae),this.Ra&&se(k,"TYPE","init"),this.S?(se(k,"$req",v),se(k,"SID","null"),ae.U=!0,ut(ae,k,null)):ut(ae,k,v),this.I=2}}else this.I==3&&(f?br(this,f):this.i.length==0||oe(this.h)||br(this))};function br(f,v){var k;v?k=v.l:k=f.V++;const R=Hn(f.J);se(R,"SID",f.M),se(R,"RID",k),se(R,"AID",f.K),dr(f,R),f.u&&f.o&&te(R,f.u,f.o),k=new Ee(f,f.j,k,f.D+1),f.u===null&&(k.J=f.o),v&&(f.i=v.G.concat(f.i)),v=Er(f,k,1e3),k.H=Math.round(f.va*.5)+Math.round(f.va*.5*Math.random()),He(f.h,k),ut(k,R,v)}function dr(f,v){f.H&&Qe(f.H,function(k,R){se(v,R,k)}),f.l&&Qe({},function(k,R){se(v,R,k)})}function Er(f,v,k){k=Math.min(f.i.length,k);const R=f.l?g(f.l.Ka,f.l,f):null;e:{var ae=f.i;let sn=-1;for(;;){const Ps=["count="+k];sn==-1?k>0?(sn=ae[0].g,Ps.push("ofs="+sn)):sn=0:Ps.push("ofs="+sn);let Un=!0;for(let ps=0;ps<k;ps++){var pe=ae[ps].g;const ui=ae[ps].map;if(pe-=sn,pe<0)sn=Math.max(0,ae[ps].g-100),Un=!1;else try{pe="req"+pe+"_"||"";try{var Xe=ui instanceof Map?ui:Object.entries(ui);for(const[qi,Si]of Xe){let ji=Si;h(Si)&&(ji=dn(Si)),Ps.push(pe+qi+"="+encodeURIComponent(ji))}}catch(qi){throw Ps.push(pe+"type="+encodeURIComponent("_badmap")),qi}}catch{R&&R(ui)}}if(Un){Xe=Ps.join("&");break e}}Xe=void 0}return f=f.i.splice(0,k),v.G=f,Xe}function vr(f){if(!f.g&&!f.v){f.Y=1;var v=f.Da;je||S(),Te||(je(),Te=!0),C.add(v,f),f.A=0}}function js(f){return f.g||f.v||f.A>=3?!1:(f.Y++,f.v=Lt(g(f.Da,f),tc(f,f.A)),f.A++,!0)}n.Da=function(){if(this.v=null,Vr(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var f=4*this.T;this.j.info("BP detection timer enabled: "+f),this.B=Lt(g(this.Wa,this),f)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,xe(10),Nn(this),Vr(this))};function Sr(f){f.B!=null&&(u.clearTimeout(f.B),f.B=null)}function Vr(f){f.g=new Ee(f,f.j,"rpc",f.Y),f.u===null&&(f.g.J=f.o),f.g.P=0;var v=Hn(f.na);se(v,"RID","rpc"),se(v,"SID",f.M),se(v,"AID",f.K),se(v,"CI",f.F?"0":"1"),!f.F&&f.ia&&se(v,"TO",f.ia),se(v,"TYPE","xmlhttp"),dr(f,v),f.u&&f.o&&te(v,f.u,f.o),f.O&&(f.g.H=f.O);var k=f.g;f=f.ba,k.M=1,k.A=Ue(Hn(v)),k.u=null,k.R=!0,Tt(k,f)}n.Va=function(){this.C!=null&&(this.C=null,Nn(this),js(this),xe(19))};function ca(f){f.C!=null&&(u.clearTimeout(f.C),f.C=null)}function ec(f,v){var k=null;if(f.g==v){ca(f),Sr(f),f.g=null;var R=2}else if($e(f.h,v))k=v.G,Qt(f.h,v),R=1;else return;if(f.I!=0){if(v.o)if(R==1){k=v.u?v.u.length:0,v=Date.now()-v.F;var ae=f.D;R=wt(),tt(R,new ct(R,k)),cs(f)}else vr(f);else if(ae=v.m,ae==3||ae==0&&v.X>0||!(R==1&&Ys(f,v)||R==2&&js(f)))switch(k&&k.length>0&&(v=f.h,v.i=v.i.concat(k)),ae){case 1:jr(f,5);break;case 4:jr(f,10);break;case 3:jr(f,6);break;default:jr(f,2)}}}function tc(f,v){let k=f.Qa+Math.floor(Math.random()*f.Za);return f.isActive()||(k*=2),k*v}function jr(f,v){if(f.j.info("Error code "+v),v==2){var k=g(f.bb,f),R=f.Ua;const ae=!R;R=new Bs(R||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||$n(R,"https"),Ue(R),ae?ls(R.toString(),k):Ks(R.toString(),k)}else xe(2);f.I=0,f.l&&f.l.pa(v),ki(f),ms(f)}n.bb=function(f){f?(this.j.info("Successfully pinged google.com"),xe(2)):(this.j.info("Failed to ping google.com"),xe(1))};function ki(f){if(f.I=0,f.ja=[],f.l){const v=Ot(f.h);(v.length!=0||f.i.length!=0)&&(B(f.ja,v),B(f.ja,f.i),f.h.i.length=0,N(f.i),f.i.length=0),f.l.oa()}}function Ei(f,v,k){var R=k instanceof Bs?Hn(k):new Bs(k);if(R.g!="")v&&(R.g=v+"."+R.g),Q(R,R.u);else{var ae=u.location;R=ae.protocol,v=v?v+"."+ae.hostname:ae.hostname,ae=+ae.port;const pe=new Bs(null);R&&$n(pe,R),v&&(pe.g=v),ae&&Q(pe,ae),k&&(pe.h=k),R=pe}return k=f.G,v=f.wa,k&&v&&se(R,k,v),se(R,"VER",f.ka),dr(f,R),R}function Lh(f,v,k){if(v&&!f.L)throw Error("Can't create secondary domain capable XhrIo object.");return v=f.Aa&&!f.ma?new Ne(new Lr({ab:k})):new Ne(f.ma),v.Fa(f.L),v}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Vh(){}n=Vh.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Ga(){}Ga.prototype.g=function(f,v){return new Nr(f,v)};function Nr(f,v){rt.call(this),this.g=new Qs(v),this.l=f,this.h=v&&v.messageUrlParams||null,f=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(f?f["X-WebChannel-Content-Type"]=v.messageContentType:f={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.sa&&(f?f["X-WebChannel-Client-Profile"]=v.sa:f={"X-WebChannel-Client-Profile":v.sa}),this.g.U=f,(f=v&&v.Qb)&&!L(f)&&(this.g.u=f),this.A=v&&v.supportsCrossDomainXhr||!1,this.v=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!L(v)&&(this.g.G=v,f=this.h,f!==null&&v in f&&(f=this.h,v in f&&delete f[v])),this.j=new ua(this)}x(Nr,rt),Nr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Nr.prototype.close=function(){qn(this.g)},Nr.prototype.o=function(f){var v=this.g;if(typeof f=="string"){var k={};k.__data__=f,f=k}else this.v&&(k={},k.__data__=dn(f),f=k);v.i.push(new A(v.Ya++,f)),v.I==3&&cs(v)},Nr.prototype.N=function(){this.g.l=null,delete this.j,qn(this.g),delete this.g,Nr.Z.N.call(this)};function Oh(f){Fe.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var v=f.__sm__;if(v){e:{for(const k in v){f=k;break e}f=void 0}(this.i=f)&&(f=this.i,v=v!==null&&f in v?v[f]:void 0),this.data=v}else this.data=f}x(Oh,Fe);function Bh(){Me.call(this),this.status=1}x(Bh,Me);function ua(f){this.g=f}x(ua,Vh),ua.prototype.ra=function(){tt(this.g,"a")},ua.prototype.qa=function(f){tt(this.g,new Oh(f))},ua.prototype.pa=function(f){tt(this.g,new Bh)},ua.prototype.oa=function(){tt(this.g,"b")},Ga.prototype.createWebChannel=Ga.prototype.g,Nr.prototype.send=Nr.prototype.o,Nr.prototype.open=Nr.prototype.m,Nr.prototype.close=Nr.prototype.close,hE=function(){return new Ga},dE=function(){return wt()},uE=qe,jb={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},bn.NO_ERROR=0,bn.TIMEOUT=8,bn.HTTP_ERROR=6,fm=bn,In.COMPLETE="complete",cE=In,Be.EventType=nt,nt.OPEN="a",nt.CLOSE="b",nt.ERROR="c",nt.MESSAGE="d",rt.prototype.listen=rt.prototype.J,Dd=Be,Ne.prototype.listenOnce=Ne.prototype.K,Ne.prototype.getLastError=Ne.prototype.Ha,Ne.prototype.getLastErrorCode=Ne.prototype.ya,Ne.prototype.getStatus=Ne.prototype.ca,Ne.prototype.getResponseJson=Ne.prototype.La,Ne.prototype.getResponseText=Ne.prototype.la,Ne.prototype.send=Ne.prototype.ea,Ne.prototype.setWithCredentials=Ne.prototype.Fa,lE=Ne}).apply(typeof Wf<"u"?Wf:typeof self<"u"?self:typeof window<"u"?window:{});class rr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}rr.UNAUTHENTICATED=new rr(null),rr.GOOGLE_CREDENTIALS=new rr("google-credentials-uid"),rr.FIRST_PARTY=new rr("first-party-uid"),rr.MOCK_USER=new rr("mock-user");let ku="12.8.0";function jP(n){ku=n}const Uo=new hv("@firebase/firestore");function zc(){return Uo.logLevel}function VO(n){Uo.setLogLevel(n)}function Ve(n,...e){if(Uo.logLevel<=wn.DEBUG){const t=e.map(Ev);Uo.debug(`Firestore (${ku}): ${n}`,...t)}}function Vs(n,...e){if(Uo.logLevel<=wn.ERROR){const t=e.map(Ev);Uo.error(`Firestore (${ku}): ${n}`,...t)}}function wi(n,...e){if(Uo.logLevel<=wn.WARN){const t=e.map(Ev);Uo.warn(`Firestore (${ku}): ${n}`,...t)}}function Ev(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function dt(n,e,t){let s="Unexpected state";typeof e=="string"?s=e:t=e,fE(n,s,t)}function fE(n,e,t){let s=`FIRESTORE (${ku}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{s+=" CONTEXT: "+JSON.stringify(t)}catch{s+=" CONTEXT: "+t}throw Vs(s),new Error(s)}function gt(n,e,t,s){let o="Unexpected state";typeof t=="string"?o=t:s=t,n||fE(e,o,s)}function OO(n,e){n||dt(57014,e)}function Ze(n,e){return n}const ue={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Re extends la{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ar{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class mE{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class NP{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(rr.UNAUTHENTICATED)))}shutdown(){}}class CP{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class AP{constructor(e){this.t=e,this.currentUser=rr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){gt(this.o===void 0,42304);let s=this.i;const o=m=>this.i!==s?(s=this.i,t(m)):Promise.resolve();let c=new ar;this.o=()=>{this.i++,this.currentUser=this.u(),c.resolve(),c=new ar,e.enqueueRetryable((()=>o(this.currentUser)))};const u=()=>{const m=c;e.enqueueRetryable((async()=>{await m.promise,await o(this.currentUser)}))},h=m=>{Ve("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit((m=>h(m))),setTimeout((()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?h(m):(Ve("FirebaseAuthCredentialsProvider","Auth not yet detected"),c.resolve(),c=new ar)}}),0),u()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((s=>this.i!==e?(Ve("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(gt(typeof s.accessToken=="string",31837,{l:s}),new mE(s.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return gt(e===null||typeof e=="string",2055,{h:e}),new rr(e)}}class RP{constructor(e,t,s){this.P=e,this.T=t,this.I=s,this.type="FirstParty",this.user=rr.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class IP{constructor(e,t,s){this.P=e,this.T=t,this.I=s}getToken(){return Promise.resolve(new RP(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(rr.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Nb{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class DP{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,si(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){gt(this.o===void 0,3512);const s=c=>{c.error!=null&&Ve("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${c.error.message}`);const u=c.token!==this.m;return this.m=c.token,Ve("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?t(c.token):Promise.resolve()};this.o=c=>{e.enqueueRetryable((()=>s(c)))};const o=c=>{Ve("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=c,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((c=>o(c))),setTimeout((()=>{if(!this.appCheck){const c=this.V.getImmediate({optional:!0});c?o(c):Ve("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Nb(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(gt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Nb(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}class BO{getToken(){return Promise.resolve(new Nb(""))}invalidateToken(){}start(e,t){}shutdown(){}}function PP(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}class Sv{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const o=PP(40);for(let c=0;c<o.length;++c)s.length<20&&o[c]<t&&(s+=e.charAt(o[c]%62))}return s}}function Ht(n,e){return n<e?-1:n>e?1:0}function Cb(n,e){const t=Math.min(n.length,e.length);for(let s=0;s<t;s++){const o=n.charAt(s),c=e.charAt(s);if(o!==c)return qy(o)===qy(c)?Ht(o,c):qy(o)?1:-1}return Ht(n.length,e.length)}const MP=55296,LP=57343;function qy(n){const e=n.charCodeAt(0);return e>=MP&&e<=LP}function Zc(n,e,t){return n.length===e.length&&n.every(((s,o)=>t(s,e[o])))}function pE(n){return n+"\0"}const Ab="__name__";class Qi{constructor(e,t,s){t===void 0?t=0:t>e.length&&dt(637,{offset:t,range:e.length}),s===void 0?s=e.length-t:s>e.length-t&&dt(1746,{length:s,range:e.length-t}),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return Qi.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Qi?e.forEach((s=>{t.push(s)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let o=0;o<s;o++){const c=Qi.compareSegments(e.get(o),t.get(o));if(c!==0)return c}return Ht(e.length,t.length)}static compareSegments(e,t){const s=Qi.isNumericId(e),o=Qi.isNumericId(t);return s&&!o?-1:!s&&o?1:s&&o?Qi.extractNumericId(e).compare(Qi.extractNumericId(t)):Cb(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Vo.fromString(e.substring(4,e.length-2))}}class fn extends Qi{construct(e,t,s){return new fn(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new Re(ue.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter((o=>o.length>0)))}return new fn(t)}static emptyPath(){return new fn([])}}const VP=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class bs extends Qi{construct(e,t,s){return new bs(e,t,s)}static isValidIdentifier(e){return VP.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),bs.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Ab}static keyField(){return new bs([Ab])}static fromServerFormat(e){const t=[];let s="",o=0;const c=()=>{if(s.length===0)throw new Re(ue.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let u=!1;for(;o<e.length;){const h=e[o];if(h==="\\"){if(o+1===e.length)throw new Re(ue.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const m=e[o+1];if(m!=="\\"&&m!=="."&&m!=="`")throw new Re(ue.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=m,o+=2}else h==="`"?(u=!u,o++):h!=="."||u?(s+=h,o++):(c(),o++)}if(c(),u)throw new Re(ue.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new bs(t)}static emptyPath(){return new bs([])}}class Je{constructor(e){this.path=e}static fromPath(e){return new Je(fn.fromString(e))}static fromName(e){return new Je(fn.fromString(e).popFirst(5))}static empty(){return new Je(fn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&fn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return fn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Je(new fn(e.slice()))}}function jv(n,e,t){if(!t)throw new Re(ue.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function OP(n,e,t,s){if(e===!0&&s===!0)throw new Re(ue.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function i2(n){if(!Je.isDocumentKey(n))throw new Re(ue.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function a2(n){if(Je.isDocumentKey(n))throw new Re(ue.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function gE(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function ap(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(s){return s.constructor?s.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":dt(12329,{type:typeof n})}function yn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Re(ue.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=ap(n);throw new Re(ue.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function yE(n,e){if(e<=0)throw new Re(ue.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function Ws(n,e){const t={typeString:n};return e&&(t.value=e),t}function Ql(n,e){if(!gE(n))throw new Re(ue.INVALID_ARGUMENT,"JSON must be an object");let t;for(const s in e)if(e[s]){const o=e[s].typeString,c="value"in e[s]?{value:e[s].value}:void 0;if(!(s in n)){t=`JSON missing required field: '${s}'`;break}const u=n[s];if(o&&typeof u!==o){t=`JSON field '${s}' must be a ${o}.`;break}if(c!==void 0&&u!==c.value){t=`Expected '${s}' field to equal '${c.value}'`;break}}if(t)throw new Re(ue.INVALID_ARGUMENT,t);return!0}const o2=-62135596800,l2=1e6;class pt{static now(){return pt.fromMillis(Date.now())}static fromDate(e){return pt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor((e-1e3*t)*l2);return new pt(t,s)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Re(ue.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Re(ue.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<o2)throw new Re(ue.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Re(ue.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/l2}_compareTo(e){return this.seconds===e.seconds?Ht(this.nanoseconds,e.nanoseconds):Ht(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:pt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ql(e,pt._jsonSchema))return new pt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-o2;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}pt._jsonSchemaVersion="firestore/timestamp/1.0",pt._jsonSchema={type:Ws("string",pt._jsonSchemaVersion),seconds:Ws("number"),nanoseconds:Ws("number")};class Et{static fromTimestamp(e){return new Et(e)}static min(){return new Et(new pt(0,0))}static max(){return new Et(new pt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const eu=-1;class tu{constructor(e,t,s,o){this.indexId=e,this.collectionGroup=t,this.fields=s,this.indexState=o}}function Rb(n){return n.fields.find((e=>e.kind===2))}function _l(n){return n.fields.filter((e=>e.kind!==2))}function BP(n,e){let t=Ht(n.collectionGroup,e.collectionGroup);if(t!==0)return t;for(let s=0;s<Math.min(n.fields.length,e.fields.length);++s)if(t=UP(n.fields[s],e.fields[s]),t!==0)return t;return Ht(n.fields.length,e.fields.length)}tu.UNKNOWN_ID=-1;class Cl{constructor(e,t){this.fieldPath=e,this.kind=t}}function UP(n,e){const t=bs.comparator(n.fieldPath,e.fieldPath);return t!==0?t:Ht(n.kind,e.kind)}class nu{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new nu(0,oi.min())}}function bE(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,o=Et.fromTimestamp(s===1e9?new pt(t+1,0):new pt(t,s));return new oi(o,Je.empty(),e)}function vE(n){return new oi(n.readTime,n.key,eu)}class oi{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new oi(Et.min(),Je.empty(),eu)}static max(){return new oi(Et.max(),Je.empty(),eu)}}function Nv(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Je.comparator(n.documentKey,e.documentKey),t!==0?t:Ht(n.largestBatchId,e.largestBatchId))}const xE="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class _E{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Ko(n){if(n.code!==ue.FAILED_PRECONDITION||n.message!==xE)throw n;Ve("LocalStore","Unexpectedly lost primary lease")}class re{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&dt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new re(((s,o)=>{this.nextCallback=c=>{this.wrapSuccess(e,c).next(s,o)},this.catchCallback=c=>{this.wrapFailure(t,c).next(s,o)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof re?t:re.resolve(t)}catch(t){return re.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):re.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):re.reject(t)}static resolve(e){return new re(((t,s)=>{t(e)}))}static reject(e){return new re(((t,s)=>{s(e)}))}static waitFor(e){return new re(((t,s)=>{let o=0,c=0,u=!1;e.forEach((h=>{++o,h.next((()=>{++c,u&&c===o&&t()}),(m=>s(m)))})),u=!0,c===o&&t()}))}static or(e){let t=re.resolve(!1);for(const s of e)t=t.next((o=>o?re.resolve(o):s()));return t}static forEach(e,t){const s=[];return e.forEach(((o,c)=>{s.push(t.call(this,o,c))})),this.waitFor(s)}static mapArray(e,t){return new re(((s,o)=>{const c=e.length,u=new Array(c);let h=0;for(let m=0;m<c;m++){const g=m;t(e[g]).next((b=>{u[g]=b,++h,h===c&&s(u)}),(b=>o(b)))}}))}static doWhile(e,t){return new re(((s,o)=>{const c=()=>{e()===!0?t().next((()=>{c()}),o):s()};c()}))}}const ni="SimpleDb";class op{static open(e,t,s,o){try{return new op(t,e.transaction(o,s))}catch(c){throw new Bd(t,c)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new ar,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Bd(e,t.error)):this.S.resolve()},this.transaction.onerror=s=>{const o=Cv(s.target.error);this.S.reject(new Bd(e,o))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Ve(ni,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new zP(t)}}class sa{static delete(e){return Ve(ni,"Removing database:",e),Tl(hk().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!_k())return!1;if(sa.F())return!0;const e=Js(),t=sa.M(e),s=0<t&&t<10,o=wE(e),c=0<o&&o<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||s||c)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),s=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(s)}constructor(e,t,s){this.name=e,this.version=t,this.N=s,this.B=null,sa.M(Js())===12.2&&Vs("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Ve(ni,"Opening database:",this.name),this.db=await new Promise(((t,s)=>{const o=indexedDB.open(this.name,this.version);o.onsuccess=c=>{const u=c.target.result;t(u)},o.onblocked=()=>{s(new Bd(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},o.onerror=c=>{const u=c.target.error;u.name==="VersionError"?s(new Re(ue.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):u.name==="InvalidStateError"?s(new Re(ue.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+u)):s(new Bd(e,u))},o.onupgradeneeded=c=>{Ve(ni,'Database "'+this.name+'" requires upgrade from version:',c.oldVersion);const u=c.target.result;this.N.k(u,o.transaction,c.oldVersion,this.version).next((()=>{Ve(ni,"Database upgrade to version "+this.version+" complete")}))}}))),this.K&&(this.db.onversionchange=t=>this.K(t)),this.db}q(e){this.K=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,s,o){const c=t==="readonly";let u=0;for(;;){++u;try{this.db=await this.L(e);const h=op.open(this.db,e,c?"readonly":"readwrite",s),m=o(h).next((g=>(h.C(),g))).catch((g=>(h.abort(g),re.reject(g)))).toPromise();return m.catch((()=>{})),await h.D,m}catch(h){const m=h,g=m.name!=="FirebaseError"&&u<3;if(Ve(ni,"Transaction failed with error:",m.message,"Retrying:",g),this.close(),!g)return Promise.reject(m)}}}close(){this.db&&this.db.close(),this.db=void 0}}function wE(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class FP{constructor(e){this.U=e,this.$=!1,this.W=null}get isDone(){return this.$}get G(){return this.W}set cursor(e){this.U=e}done(){this.$=!0}j(e){this.W=e}delete(){return Tl(this.U.delete())}}class Bd extends Re{constructor(e,t){super(ue.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Qo(n){return n.name==="IndexedDbTransactionError"}class zP{constructor(e){this.store=e}put(e,t){let s;return t!==void 0?(Ve(ni,"PUT",this.store.name,e,t),s=this.store.put(t,e)):(Ve(ni,"PUT",this.store.name,"<auto-key>",e),s=this.store.put(e)),Tl(s)}add(e){return Ve(ni,"ADD",this.store.name,e,e),Tl(this.store.add(e))}get(e){return Tl(this.store.get(e)).next((t=>(t===void 0&&(t=null),Ve(ni,"GET",this.store.name,e,t),t)))}delete(e){return Ve(ni,"DELETE",this.store.name,e),Tl(this.store.delete(e))}count(){return Ve(ni,"COUNT",this.store.name),Tl(this.store.count())}H(e,t){const s=this.options(e,t),o=s.index?this.store.index(s.index):this.store;if(typeof o.getAll=="function"){const c=o.getAll(s.range);return new re(((u,h)=>{c.onerror=m=>{h(m.target.error)},c.onsuccess=m=>{u(m.target.result)}}))}{const c=this.cursor(s),u=[];return this.J(c,((h,m)=>{u.push(m)})).next((()=>u))}}Z(e,t){const s=this.store.getAll(e,t===null?void 0:t);return new re(((o,c)=>{s.onerror=u=>{c(u.target.error)},s.onsuccess=u=>{o(u.target.result)}}))}X(e,t){Ve(ni,"DELETE ALL",this.store.name);const s=this.options(e,t);s.Y=!1;const o=this.cursor(s);return this.J(o,((c,u,h)=>h.delete()))}ee(e,t){let s;t?s=e:(s={},t=e);const o=this.cursor(s);return this.J(o,t)}te(e){const t=this.cursor({});return new re(((s,o)=>{t.onerror=c=>{const u=Cv(c.target.error);o(u)},t.onsuccess=c=>{const u=c.target.result;u?e(u.primaryKey,u.value).next((h=>{h?u.continue():s()})):s()}}))}J(e,t){const s=[];return new re(((o,c)=>{e.onerror=u=>{c(u.target.error)},e.onsuccess=u=>{const h=u.target.result;if(!h)return void o();const m=new FP(h),g=t(h.primaryKey,h.value,m);if(g instanceof re){const b=g.catch((x=>(m.done(),re.reject(x))));s.push(b)}m.isDone?o():m.G===null?h.continue():h.continue(m.G)}})).next((()=>re.waitFor(s)))}options(e,t){let s;return e!==void 0&&(typeof e=="string"?s=e:t=e),{index:s,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const s=this.store.index(e.index);return e.Y?s.openKeyCursor(e.range,t):s.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Tl(n){return new re(((e,t)=>{n.onsuccess=s=>{const o=s.target.result;e(o)},n.onerror=s=>{const o=Cv(s.target.error);t(o)}}))}let c2=!1;function Cv(n){const e=sa.M(Js());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const s=new Re("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return c2||(c2=!0,setTimeout((()=>{throw s}),0)),s}}return n}const Ud="IndexBackfiller";class qP{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Ve(Ud,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();Ve(Ud,`Documents written: ${t}`)}catch(t){Qo(t)?Ve(Ud,"Ignoring IndexedDB error during index backfill: ",t):await Ko(t)}await this.re(6e4)}))}}class HP{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const s=new Set;let o=t,c=!0;return re.doWhile((()=>c===!0&&o>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((u=>{if(u!==null&&!s.has(u))return Ve(Ud,`Processing collection: ${u}`),this.oe(e,u,o).next((h=>{o-=h,s.add(u)}));c=!1})))).next((()=>t-o))}oe(e,t,s){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((o=>this.localStore.localDocuments.getNextDocuments(e,t,o,s).next((c=>{const u=c.changes;return this.localStore.indexManager.updateIndexEntries(e,u).next((()=>this._e(o,c))).next((h=>(Ve(Ud,`Updating offset: ${h}`),this.localStore.indexManager.updateCollectionGroup(e,t,h)))).next((()=>u.size))}))))}_e(e,t){let s=e;return t.changes.forEach(((o,c)=>{const u=vE(c);Nv(u,s)>0&&(s=u)})),new oi(s.readTime,s.documentKey,Math.max(t.batchId,e.largestBatchId))}}class qr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this.ae(s),this.ue=s=>t.writeSequenceNumber(s))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}qr.ce=-1;const Oo=-1;function _h(n){return n==null}function eh(n){return n===0&&1/n==-1/0}function TE(n){return typeof n=="number"&&Number.isInteger(n)&&!eh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const Mm="";function Tr(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=u2(e)),e=$P(n.get(t),e);return u2(e)}function $P(n,e){let t=e;const s=n.length;for(let o=0;o<s;o++){const c=n.charAt(o);switch(c){case"\0":t+="";break;case Mm:t+="";break;default:t+=c}}return t}function u2(n){return n+Mm+""}function Xi(n){const e=n.length;if(gt(e>=2,64408,{path:n}),e===2)return gt(n.charAt(0)===Mm&&n.charAt(1)==="",56145,{path:n}),fn.emptyPath();const t=e-2,s=[];let o="";for(let c=0;c<e;){const u=n.indexOf(Mm,c);switch((u<0||u>t)&&dt(50515,{path:n}),n.charAt(u+1)){case"":const h=n.substring(c,u);let m;o.length===0?m=h:(o+=h,m=o,o=""),s.push(m);break;case"":o+=n.substring(c,u),o+="\0";break;case"":o+=n.substring(c,u+1);break;default:dt(61167,{path:n})}c=u+2}return new fn(s)}const wl="remoteDocuments",wh="owner",Ic="owner",th="mutationQueues",WP="userId",Pi="mutations",d2="batchId",jl="userMutationsIndex",h2=["userId","batchId"];function mm(n,e){return[n,Tr(e)]}function kE(n,e,t){return[n,Tr(e),t]}const GP={},su="documentMutations",Lm="remoteDocumentsV14",KP=["prefixPath","collectionGroup","readTime","documentId"],pm="documentKeyIndex",QP=["prefixPath","collectionGroup","documentId"],EE="collectionGroupIndex",YP=["collectionGroup","readTime","prefixPath","documentId"],nh="remoteDocumentGlobal",Ib="remoteDocumentGlobalKey",ru="targets",SE="queryTargetsIndex",XP=["canonicalId","targetId"],iu="targetDocuments",JP=["targetId","path"],Av="documentTargetsIndex",ZP=["path","targetId"],Vm="targetGlobalKey",Al="targetGlobal",sh="collectionParents",eM=["collectionId","parent"],au="clientMetadata",tM="clientId",lp="bundles",nM="bundleId",cp="namedQueries",sM="name",Rv="indexConfiguration",rM="indexId",Db="collectionGroupIndex",iM="collectionGroup",Fd="indexState",aM=["indexId","uid"],jE="sequenceNumberIndex",oM=["uid","sequenceNumber"],zd="indexEntries",lM=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],NE="documentKeyIndex",cM=["indexId","uid","orderedDocumentKey"],up="documentOverlays",uM=["userId","collectionPath","documentId"],Pb="collectionPathOverlayIndex",dM=["userId","collectionPath","largestBatchId"],CE="collectionGroupOverlayIndex",hM=["userId","collectionGroup","largestBatchId"],Iv="globals",fM="name",AE=[th,Pi,su,wl,ru,wh,Al,iu,au,nh,sh,lp,cp],mM=[...AE,up],RE=[th,Pi,su,Lm,ru,wh,Al,iu,au,nh,sh,lp,cp,up],IE=RE,Dv=[...IE,Rv,Fd,zd],pM=Dv,DE=[...Dv,Iv],gM=DE;class Mb extends _E{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function Zs(n,e){const t=Ze(n);return sa.O(t.le,e)}function f2(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Yo(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function PE(n,e){const t=[];for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&t.push(e(n[s],s,n));return t}function ME(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class os{constructor(e,t){this.comparator=e,this.root=t||gr.EMPTY}insert(e,t){return new os(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,gr.BLACK,null,null))}remove(e){return new os(this.comparator,this.root.remove(e,this.comparator).copy(null,null,gr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const o=this.comparator(e,s.key);if(o===0)return t+s.left.size;o<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,s)=>(e(t,s),!1)))}toString(){const e=[];return this.inorderTraversal(((t,s)=>(e.push(`${t}:${s}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Gf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Gf(this.root,e,this.comparator,!1)}getReverseIterator(){return new Gf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Gf(this.root,e,this.comparator,!0)}}class Gf{constructor(e,t,s,o){this.isReverse=o,this.nodeStack=[];let c=1;for(;!e.isEmpty();)if(c=t?s(e.key,t):1,t&&o&&(c*=-1),c<0)e=this.isReverse?e.left:e.right;else{if(c===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class gr{constructor(e,t,s,o,c){this.key=e,this.value=t,this.color=s??gr.RED,this.left=o??gr.EMPTY,this.right=c??gr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,o,c){return new gr(e??this.key,t??this.value,s??this.color,o??this.left,c??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let o=this;const c=s(e,o.key);return o=c<0?o.copy(null,null,null,o.left.insert(e,t,s),null):c===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,s)),o.fixUp()}removeMin(){if(this.left.isEmpty())return gr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return gr.EMPTY;s=o.right.min(),o=o.copy(s.key,s.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,gr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,gr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw dt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw dt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw dt(27949);return e+(this.isRed()?0:1)}}gr.EMPTY=null,gr.RED=!0,gr.BLACK=!1;gr.EMPTY=new class{constructor(){this.size=0}get key(){throw dt(57766)}get value(){throw dt(16141)}get color(){throw dt(16727)}get left(){throw dt(29726)}get right(){throw dt(36894)}copy(e,t,s,o,c){return this}insert(e,t,s){return new gr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Qn{constructor(e){this.comparator=e,this.data=new os(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,s)=>(e(t),!1)))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const o=s.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new m2(this.data.getIterator())}getIteratorFrom(e){return new m2(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((s=>{t=t.add(s)})),t}isEqual(e){if(!(e instanceof Qn)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=s.getNext().key;if(this.comparator(o,c)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Qn(this.comparator);return t.data=e,t}}class m2{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Dc(n){return n.hasNext()?n.getNext():void 0}class Hr{constructor(e){this.fields=e,e.sort(bs.comparator)}static empty(){return new Hr([])}unionWith(e){let t=new Qn(bs.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new Hr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Zc(this.fields,e.fields,((t,s)=>t.isEqual(s)))}}class LE extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}function FO(){return typeof atob<"u"}class As{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(o){try{return atob(o)}catch(c){throw typeof DOMException<"u"&&c instanceof DOMException?new LE("Invalid base64 string: "+c):c}})(e);return new As(t)}static fromUint8Array(e){const t=(function(o){let c="";for(let u=0;u<o.length;++u)c+=String.fromCharCode(o[u]);return c})(e);return new As(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const s=new Uint8Array(t.length);for(let o=0;o<t.length;o++)s[o]=t.charCodeAt(o);return s})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ht(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}As.EMPTY_BYTE_STRING=new As("");const yM=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function La(n){if(gt(!!n,39018),typeof n=="string"){let e=0;const t=yM.exec(n);if(gt(!!t,46558,{timestamp:n}),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:ys(n.seconds),nanos:ys(n.nanos)}}function ys(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Va(n){return typeof n=="string"?As.fromBase64String(n):As.fromUint8Array(n)}const VE="server_timestamp",OE="__type__",BE="__previous_value__",UE="__local_write_time__";function dp(n){return(n?.mapValue?.fields||{})[OE]?.stringValue===VE}function hp(n){const e=n.mapValue.fields[BE];return dp(e)?hp(e):e}function rh(n){const e=La(n.mapValue.fields[UE].timestampValue);return new pt(e.seconds,e.nanos)}class bM{constructor(e,t,s,o,c,u,h,m,g,b,x){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=o,this.ssl=c,this.forceLongPolling=u,this.autoDetectLongPolling=h,this.longPollingOptions=m,this.useFetchStreams=g,this.isUsingEmulator=b,this.apiKey=x}}const ih="(default)";class Vl{constructor(e,t){this.projectId=e,this.database=t||ih}static empty(){return new Vl("","")}get isDefaultDatabase(){return this.database===ih}isEqual(e){return e instanceof Vl&&e.projectId===this.projectId&&e.database===this.database}}function vM(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new Re(ue.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Vl(n.options.projectId,e)}const Pv="__type__",FE="__max__",Ao={mapValue:{fields:{__type__:{stringValue:FE}}}},Mv="__vector__",ou="value",gm={nullValue:"NULL_VALUE"};function Fo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?dp(n)?4:zE(n)?9007199254740991:fp(n)?10:11:dt(28295,{value:n})}function oa(n,e){if(n===e)return!0;const t=Fo(n);if(t!==Fo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return rh(n).isEqual(rh(e));case 3:return(function(o,c){if(typeof o.timestampValue=="string"&&typeof c.timestampValue=="string"&&o.timestampValue.length===c.timestampValue.length)return o.timestampValue===c.timestampValue;const u=La(o.timestampValue),h=La(c.timestampValue);return u.seconds===h.seconds&&u.nanos===h.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(o,c){return Va(o.bytesValue).isEqual(Va(c.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(o,c){return ys(o.geoPointValue.latitude)===ys(c.geoPointValue.latitude)&&ys(o.geoPointValue.longitude)===ys(c.geoPointValue.longitude)})(n,e);case 2:return(function(o,c){if("integerValue"in o&&"integerValue"in c)return ys(o.integerValue)===ys(c.integerValue);if("doubleValue"in o&&"doubleValue"in c){const u=ys(o.doubleValue),h=ys(c.doubleValue);return u===h?eh(u)===eh(h):isNaN(u)&&isNaN(h)}return!1})(n,e);case 9:return Zc(n.arrayValue.values||[],e.arrayValue.values||[],oa);case 10:case 11:return(function(o,c){const u=o.mapValue.fields||{},h=c.mapValue.fields||{};if(f2(u)!==f2(h))return!1;for(const m in u)if(u.hasOwnProperty(m)&&(h[m]===void 0||!oa(u[m],h[m])))return!1;return!0})(n,e);default:return dt(52216,{left:n})}}function ah(n,e){return(n.values||[]).find((t=>oa(t,e)))!==void 0}function zo(n,e){if(n===e)return 0;const t=Fo(n),s=Fo(e);if(t!==s)return Ht(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ht(n.booleanValue,e.booleanValue);case 2:return(function(c,u){const h=ys(c.integerValue||c.doubleValue),m=ys(u.integerValue||u.doubleValue);return h<m?-1:h>m?1:h===m?0:isNaN(h)?isNaN(m)?0:-1:1})(n,e);case 3:return p2(n.timestampValue,e.timestampValue);case 4:return p2(rh(n),rh(e));case 5:return Cb(n.stringValue,e.stringValue);case 6:return(function(c,u){const h=Va(c),m=Va(u);return h.compareTo(m)})(n.bytesValue,e.bytesValue);case 7:return(function(c,u){const h=c.split("/"),m=u.split("/");for(let g=0;g<h.length&&g<m.length;g++){const b=Ht(h[g],m[g]);if(b!==0)return b}return Ht(h.length,m.length)})(n.referenceValue,e.referenceValue);case 8:return(function(c,u){const h=Ht(ys(c.latitude),ys(u.latitude));return h!==0?h:Ht(ys(c.longitude),ys(u.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return g2(n.arrayValue,e.arrayValue);case 10:return(function(c,u){const h=c.fields||{},m=u.fields||{},g=h[ou]?.arrayValue,b=m[ou]?.arrayValue,x=Ht(g?.values?.length||0,b?.values?.length||0);return x!==0?x:g2(g,b)})(n.mapValue,e.mapValue);case 11:return(function(c,u){if(c===Ao.mapValue&&u===Ao.mapValue)return 0;if(c===Ao.mapValue)return 1;if(u===Ao.mapValue)return-1;const h=c.fields||{},m=Object.keys(h),g=u.fields||{},b=Object.keys(g);m.sort(),b.sort();for(let x=0;x<m.length&&x<b.length;++x){const T=Cb(m[x],b[x]);if(T!==0)return T;const N=zo(h[m[x]],g[b[x]]);if(N!==0)return N}return Ht(m.length,b.length)})(n.mapValue,e.mapValue);default:throw dt(23264,{he:t})}}function p2(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Ht(n,e);const t=La(n),s=La(e),o=Ht(t.seconds,s.seconds);return o!==0?o:Ht(t.nanos,s.nanos)}function g2(n,e){const t=n.values||[],s=e.values||[];for(let o=0;o<t.length&&o<s.length;++o){const c=zo(t[o],s[o]);if(c)return c}return Ht(t.length,s.length)}function lu(n){return Lb(n)}function Lb(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const s=La(t);return`time(${s.seconds},${s.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Va(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Je.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let s="[",o=!0;for(const c of t.values||[])o?o=!1:s+=",",s+=Lb(c);return s+"]"})(n.arrayValue):"mapValue"in n?(function(t){const s=Object.keys(t.fields||{}).sort();let o="{",c=!0;for(const u of s)c?c=!1:o+=",",o+=`${u}:${Lb(t.fields[u])}`;return o+"}"})(n.mapValue):dt(61005,{value:n})}function ym(n){switch(Fo(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=hp(n);return e?16+ym(e):16;case 5:return 2*n.stringValue.length;case 6:return Va(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(s){return(s.values||[]).reduce(((o,c)=>o+ym(c)),0)})(n.arrayValue);case 10:case 11:return(function(s){let o=0;return Yo(s.fields,((c,u)=>{o+=c.length+ym(u)})),o})(n.mapValue);default:throw dt(13486,{value:n})}}function Ol(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Vb(n){return!!n&&"integerValue"in n}function oh(n){return!!n&&"arrayValue"in n}function y2(n){return!!n&&"nullValue"in n}function b2(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function bm(n){return!!n&&"mapValue"in n}function fp(n){return(n?.mapValue?.fields||{})[Pv]?.stringValue===Mv}function qd(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Yo(n.mapValue.fields,((t,s)=>e.mapValue.fields[t]=qd(s))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=qd(n.arrayValue.values[t]);return e}return{...n}}function zE(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===FE}const qE={mapValue:{fields:{[Pv]:{stringValue:Mv},[ou]:{arrayValue:{}}}}};function xM(n){return"nullValue"in n?gm:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Ol(Vl.empty(),Je.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?fp(n)?qE:{mapValue:{}}:dt(35942,{value:n})}function _M(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Ol(Vl.empty(),Je.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?qE:"mapValue"in n?fp(n)?{mapValue:{}}:Ao:dt(61959,{value:n})}function v2(n,e){const t=zo(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function x2(n,e){const t=zo(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class ir{constructor(e){this.value=e}static empty(){return new ir({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!bm(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=qd(t)}setAll(e){let t=bs.emptyPath(),s={},o=[];e.forEach(((u,h)=>{if(!t.isImmediateParentOf(h)){const m=this.getFieldsMap(t);this.applyChanges(m,s,o),s={},o=[],t=h.popLast()}u?s[h.lastSegment()]=qd(u):o.push(h.lastSegment())}));const c=this.getFieldsMap(t);this.applyChanges(c,s,o)}delete(e){const t=this.field(e.popLast());bm(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return oa(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let o=t.mapValue.fields[e.get(s)];bm(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,s){Yo(t,((o,c)=>e[o]=c));for(const o of s)delete e[o]}clone(){return new ir(qd(this.value))}}function HE(n){const e=[];return Yo(n.fields,((t,s)=>{const o=new bs([t]);if(bm(s)){const c=HE(s.mapValue).fields;if(c.length===0)e.push(o);else for(const u of c)e.push(o.child(u))}else e.push(o)})),new Hr(e)}class hs{constructor(e,t,s,o,c,u,h){this.key=e,this.documentType=t,this.version=s,this.readTime=o,this.createTime=c,this.data=u,this.documentState=h}static newInvalidDocument(e){return new hs(e,0,Et.min(),Et.min(),Et.min(),ir.empty(),0)}static newFoundDocument(e,t,s,o){return new hs(e,1,t,Et.min(),s,o,0)}static newNoDocument(e,t){return new hs(e,2,t,Et.min(),Et.min(),ir.empty(),0)}static newUnknownDocument(e,t){return new hs(e,3,t,Et.min(),Et.min(),ir.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Et.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ir.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ir.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Et.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof hs&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new hs(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class qo{constructor(e,t){this.position=e,this.inclusive=t}}function _2(n,e,t){let s=0;for(let o=0;o<n.position.length;o++){const c=e[o],u=n.position[o];if(c.field.isKeyField()?s=Je.comparator(Je.fromName(u.referenceValue),t.key):s=zo(u,t.data.field(c.field)),c.dir==="desc"&&(s*=-1),s!==0)break}return s}function w2(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!oa(n.position[t],e.position[t]))return!1;return!0}class lh{constructor(e,t="asc"){this.field=e,this.dir=t}}function wM(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class $E{}class Tn extends $E{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new TM(e,t,s):t==="array-contains"?new SM(e,s):t==="in"?new XE(e,s):t==="not-in"?new jM(e,s):t==="array-contains-any"?new NM(e,s):new Tn(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new kM(e,s):new EM(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(zo(t,this.value)):t!==null&&Fo(this.value)===Fo(t)&&this.matchesComparison(zo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return dt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Kn extends $E{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Kn(e,t)}matches(e){return cu(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function cu(n){return n.op==="and"}function Ob(n){return n.op==="or"}function Lv(n){return WE(n)&&cu(n)}function WE(n){for(const e of n.filters)if(e instanceof Kn)return!1;return!0}function Bb(n){if(n instanceof Tn)return n.field.canonicalString()+n.op.toString()+lu(n.value);if(Lv(n))return n.filters.map((e=>Bb(e))).join(",");{const e=n.filters.map((t=>Bb(t))).join(",");return`${n.op}(${e})`}}function GE(n,e){return n instanceof Tn?(function(s,o){return o instanceof Tn&&s.op===o.op&&s.field.isEqual(o.field)&&oa(s.value,o.value)})(n,e):n instanceof Kn?(function(s,o){return o instanceof Kn&&s.op===o.op&&s.filters.length===o.filters.length?s.filters.reduce(((c,u,h)=>c&&GE(u,o.filters[h])),!0):!1})(n,e):void dt(19439)}function KE(n,e){const t=n.filters.concat(e);return Kn.create(t,n.op)}function QE(n){return n instanceof Tn?(function(t){return`${t.field.canonicalString()} ${t.op} ${lu(t.value)}`})(n):n instanceof Kn?(function(t){return t.op.toString()+" {"+t.getFilters().map(QE).join(" ,")+"}"})(n):"Filter"}class TM extends Tn{constructor(e,t,s){super(e,t,s),this.key=Je.fromName(s.referenceValue)}matches(e){const t=Je.comparator(e.key,this.key);return this.matchesComparison(t)}}class kM extends Tn{constructor(e,t){super(e,"in",t),this.keys=YE("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class EM extends Tn{constructor(e,t){super(e,"not-in",t),this.keys=YE("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function YE(n,e){return(e.arrayValue?.values||[]).map((t=>Je.fromName(t.referenceValue)))}class SM extends Tn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return oh(t)&&ah(t.arrayValue,this.value)}}class XE extends Tn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&ah(this.value.arrayValue,t)}}class jM extends Tn{constructor(e,t){super(e,"not-in",t)}matches(e){if(ah(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!ah(this.value.arrayValue,t)}}class NM extends Tn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!oh(t)||!t.arrayValue.values)&&t.arrayValue.values.some((s=>ah(this.value.arrayValue,s)))}}class CM{constructor(e,t=null,s=[],o=[],c=null,u=null,h=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=o,this.limit=c,this.startAt=u,this.endAt=h,this.Te=null}}function Ub(n,e=null,t=[],s=[],o=null,c=null,u=null){return new CM(n,e,t,s,o,c,u)}function Bl(n){const e=Ze(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((s=>Bb(s))).join(","),t+="|ob:",t+=e.orderBy.map((s=>(function(c){return c.field.canonicalString()+c.dir})(s))).join(","),_h(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((s=>lu(s))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((s=>lu(s))).join(",")),e.Te=t}return e.Te}function Th(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!wM(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!GE(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!w2(n.startAt,e.startAt)&&w2(n.endAt,e.endAt)}function Om(n){return Je.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Bm(n,e){return n.filters.filter((t=>t instanceof Tn&&t.field.isEqual(e)))}function T2(n,e,t){let s=gm,o=!0;for(const c of Bm(n,e)){let u=gm,h=!0;switch(c.op){case"<":case"<=":u=xM(c.value);break;case"==":case"in":case">=":u=c.value;break;case">":u=c.value,h=!1;break;case"!=":case"not-in":u=gm}v2({value:s,inclusive:o},{value:u,inclusive:h})<0&&(s=u,o=h)}if(t!==null){for(let c=0;c<n.orderBy.length;++c)if(n.orderBy[c].field.isEqual(e)){const u=t.position[c];v2({value:s,inclusive:o},{value:u,inclusive:t.inclusive})<0&&(s=u,o=t.inclusive);break}}return{value:s,inclusive:o}}function k2(n,e,t){let s=Ao,o=!0;for(const c of Bm(n,e)){let u=Ao,h=!0;switch(c.op){case">=":case">":u=_M(c.value),h=!1;break;case"==":case"in":case"<=":u=c.value;break;case"<":u=c.value,h=!1;break;case"!=":case"not-in":u=Ao}x2({value:s,inclusive:o},{value:u,inclusive:h})>0&&(s=u,o=h)}if(t!==null){for(let c=0;c<n.orderBy.length;++c)if(n.orderBy[c].field.isEqual(e)){const u=t.position[c];x2({value:s,inclusive:o},{value:u,inclusive:t.inclusive})>0&&(s=u,o=t.inclusive);break}}return{value:s,inclusive:o}}class za{constructor(e,t=null,s=[],o=[],c=null,u="F",h=null,m=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=o,this.limit=c,this.limitType=u,this.startAt=h,this.endAt=m,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function JE(n,e,t,s,o,c,u,h){return new za(n,e,t,s,o,c,u,h)}function Eu(n){return new za(n)}function E2(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function AM(n){return Je.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Vv(n){return n.collectionGroup!==null}function Yc(n){const e=Ze(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const c of e.explicitOrderBy)e.Ie.push(c),t.add(c.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let h=new Qn(bs.comparator);return u.filters.forEach((m=>{m.getFlattenedFilters().forEach((g=>{g.isInequality()&&(h=h.add(g.field))}))})),h})(e).forEach((c=>{t.has(c.canonicalString())||c.isKeyField()||e.Ie.push(new lh(c,s))})),t.has(bs.keyField().canonicalString())||e.Ie.push(new lh(bs.keyField(),s))}return e.Ie}function kr(n){const e=Ze(n);return e.Ee||(e.Ee=eS(e,Yc(n))),e.Ee}function ZE(n){const e=Ze(n);return e.Re||(e.Re=eS(e,n.explicitOrderBy)),e.Re}function eS(n,e){if(n.limitType==="F")return Ub(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((o=>{const c=o.dir==="desc"?"asc":"desc";return new lh(o.field,c)}));const t=n.endAt?new qo(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new qo(n.startAt.position,n.startAt.inclusive):null;return Ub(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function Fb(n,e){const t=n.filters.concat([e]);return new za(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function RM(n,e){const t=n.explicitOrderBy.concat([e]);return new za(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function Um(n,e,t){return new za(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function IM(n,e){return new za(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,e,n.endAt)}function DM(n,e){return new za(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,n.startAt,e)}function kh(n,e){return Th(kr(n),kr(e))&&n.limitType===e.limitType}function tS(n){return`${Bl(kr(n))}|lt:${n.limitType}`}function qc(n){return`Query(target=${(function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map((o=>QE(o))).join(", ")}]`),_h(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map((o=>(function(u){return`${u.field.canonicalString()} (${u.dir})`})(o))).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map((o=>lu(o))).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map((o=>lu(o))).join(",")),`Target(${s})`})(kr(n))}; limitType=${n.limitType})`}function Eh(n,e){return e.isFoundDocument()&&(function(s,o){const c=o.key.path;return s.collectionGroup!==null?o.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(c):Je.isDocumentKey(s.path)?s.path.isEqual(c):s.path.isImmediateParentOf(c)})(n,e)&&(function(s,o){for(const c of Yc(s))if(!c.field.isKeyField()&&o.data.field(c.field)===null)return!1;return!0})(n,e)&&(function(s,o){for(const c of s.filters)if(!c.matches(o))return!1;return!0})(n,e)&&(function(s,o){return!(s.startAt&&!(function(u,h,m){const g=_2(u,h,m);return u.inclusive?g<=0:g<0})(s.startAt,Yc(s),o)||s.endAt&&!(function(u,h,m){const g=_2(u,h,m);return u.inclusive?g>=0:g>0})(s.endAt,Yc(s),o))})(n,e)}function nS(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function sS(n){return(e,t)=>{let s=!1;for(const o of Yc(n)){const c=PM(o,e,t);if(c!==0)return c;s=s||o.field.isKeyField()}return 0}}function PM(n,e,t){const s=n.field.isKeyField()?Je.comparator(e.key,t.key):(function(c,u,h){const m=u.data.field(c),g=h.data.field(c);return m!==null&&g!==null?zo(m,g):dt(42886)})(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return dt(19790,{direction:n.dir})}}class qa{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[o,c]of s)if(this.equalsFn(o,e))return c}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),o=this.inner[s];if(o===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let c=0;c<o.length;c++)if(this.equalsFn(o[c][0],e))return void(o[c]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let o=0;o<s.length;o++)if(this.equalsFn(s[o][0],e))return s.length===1?delete this.inner[t]:s.splice(o,1),this.innerSize--,!0;return!1}forEach(e){Yo(this.inner,((t,s)=>{for(const[o,c]of s)e(o,c)}))}isEmpty(){return ME(this.inner)}size(){return this.innerSize}}const MM=new os(Je.comparator);function $r(){return MM}const rS=new os(Je.comparator);function Pd(...n){let e=rS;for(const t of n)e=e.insert(t.key,t);return e}function iS(n){let e=rS;return n.forEach(((t,s)=>e=e.insert(t,s.overlayedDocument))),e}function Ji(){return Hd()}function aS(){return Hd()}function Hd(){return new qa((n=>n.toString()),((n,e)=>n.isEqual(e)))}const LM=new os(Je.comparator),VM=new Qn(Je.comparator);function tn(...n){let e=VM;for(const t of n)e=e.add(t);return e}const OM=new Qn(Ht);function Ov(){return OM}function Bv(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:eh(e)?"-0":e}}function oS(n){return{integerValue:""+n}}function lS(n,e){return TE(e)?oS(e):Bv(n,e)}class mp{constructor(){this._=void 0}}function BM(n,e,t){return n instanceof uu?(function(o,c){const u={fields:{[OE]:{stringValue:VE},[UE]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return c&&dp(c)&&(c=hp(c)),c&&(u.fields[BE]=c),{mapValue:u}})(t,e):n instanceof Ul?uS(n,e):n instanceof Fl?dS(n,e):(function(o,c){const u=cS(o,c),h=S2(u)+S2(o.Ae);return Vb(u)&&Vb(o.Ae)?oS(h):Bv(o.serializer,h)})(n,e)}function UM(n,e,t){return n instanceof Ul?uS(n,e):n instanceof Fl?dS(n,e):t}function cS(n,e){return n instanceof du?(function(s){return Vb(s)||(function(c){return!!c&&"doubleValue"in c})(s)})(e)?e:{integerValue:0}:null}class uu extends mp{}class Ul extends mp{constructor(e){super(),this.elements=e}}function uS(n,e){const t=hS(e);for(const s of n.elements)t.some((o=>oa(o,s)))||t.push(s);return{arrayValue:{values:t}}}class Fl extends mp{constructor(e){super(),this.elements=e}}function dS(n,e){let t=hS(e);for(const s of n.elements)t=t.filter((o=>!oa(o,s)));return{arrayValue:{values:t}}}class du extends mp{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function S2(n){return ys(n.integerValue||n.doubleValue)}function hS(n){return oh(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class Sh{constructor(e,t){this.field=e,this.transform=t}}function FM(n,e){return n.field.isEqual(e.field)&&(function(s,o){return s instanceof Ul&&o instanceof Ul||s instanceof Fl&&o instanceof Fl?Zc(s.elements,o.elements,oa):s instanceof du&&o instanceof du?oa(s.Ae,o.Ae):s instanceof uu&&o instanceof uu})(n.transform,e.transform)}class zM{constructor(e,t){this.version=e,this.transformResults=t}}class vs{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new vs}static exists(e){return new vs(void 0,e)}static updateTime(e){return new vs(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function vm(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class pp{}function fS(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new ju(n.key,vs.none()):new Su(n.key,n.data,vs.none());{const t=n.data,s=ir.empty();let o=new Qn(bs.comparator);for(let c of e.fields)if(!o.has(c)){let u=t.field(c);u===null&&c.length>1&&(c=c.popLast(),u=t.field(c)),u===null?s.delete(c):s.set(c,u),o=o.add(c)}return new Ha(n.key,s,new Hr(o.toArray()),vs.none())}}function qM(n,e,t){n instanceof Su?(function(o,c,u){const h=o.value.clone(),m=N2(o.fieldTransforms,c,u.transformResults);h.setAll(m),c.convertToFoundDocument(u.version,h).setHasCommittedMutations()})(n,e,t):n instanceof Ha?(function(o,c,u){if(!vm(o.precondition,c))return void c.convertToUnknownDocument(u.version);const h=N2(o.fieldTransforms,c,u.transformResults),m=c.data;m.setAll(mS(o)),m.setAll(h),c.convertToFoundDocument(u.version,m).setHasCommittedMutations()})(n,e,t):(function(o,c,u){c.convertToNoDocument(u.version).setHasCommittedMutations()})(0,e,t)}function $d(n,e,t,s){return n instanceof Su?(function(c,u,h,m){if(!vm(c.precondition,u))return h;const g=c.value.clone(),b=C2(c.fieldTransforms,m,u);return g.setAll(b),u.convertToFoundDocument(u.version,g).setHasLocalMutations(),null})(n,e,t,s):n instanceof Ha?(function(c,u,h,m){if(!vm(c.precondition,u))return h;const g=C2(c.fieldTransforms,m,u),b=u.data;return b.setAll(mS(c)),b.setAll(g),u.convertToFoundDocument(u.version,b).setHasLocalMutations(),h===null?null:h.unionWith(c.fieldMask.fields).unionWith(c.fieldTransforms.map((x=>x.field)))})(n,e,t,s):(function(c,u,h){return vm(c.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):h})(n,e,t)}function HM(n,e){let t=null;for(const s of n.fieldTransforms){const o=e.data.field(s.field),c=cS(s.transform,o||null);c!=null&&(t===null&&(t=ir.empty()),t.set(s.field,c))}return t||null}function j2(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(s,o){return s===void 0&&o===void 0||!(!s||!o)&&Zc(s,o,((c,u)=>FM(c,u)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Su extends pp{constructor(e,t,s,o=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class Ha extends pp{constructor(e,t,s,o,c=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=o,this.fieldTransforms=c,this.type=1}getFieldMask(){return this.fieldMask}}function mS(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}})),e}function N2(n,e,t){const s=new Map;gt(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let o=0;o<t.length;o++){const c=n[o],u=c.transform,h=e.data.field(c.field);s.set(c.field,UM(u,h,t[o]))}return s}function C2(n,e,t){const s=new Map;for(const o of n){const c=o.transform,u=t.data.field(o.field);s.set(o.field,BM(c,u,e))}return s}class ju extends pp{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Uv extends pp{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Fv{constructor(e,t,s,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=o}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const c=this.mutations[o];c.key.isEqual(e.key)&&qM(c,e,s[o])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=$d(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=$d(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=aS();return this.mutations.forEach((o=>{const c=e.get(o.key),u=c.overlayedDocument;let h=this.applyToLocalView(u,c.mutatedFields);h=t.has(o.key)?null:h;const m=fS(u,h);m!==null&&s.set(o.key,m),u.isValidDocument()||u.convertToNoDocument(Et.min())})),s}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),tn())}isEqual(e){return this.batchId===e.batchId&&Zc(this.mutations,e.mutations,((t,s)=>j2(t,s)))&&Zc(this.baseMutations,e.baseMutations,((t,s)=>j2(t,s)))}}class zv{constructor(e,t,s,o){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=o}static from(e,t,s){gt(e.mutations.length===s.length,58842,{me:e.mutations.length,fe:s.length});let o=(function(){return LM})();const c=e.mutations;for(let u=0;u<c.length;u++)o=o.insert(c[u].key,s[u].version);return new zv(e,t,s,o)}}class qv{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class pS{constructor(e,t,s){this.alias=e,this.aggregateType=t,this.fieldPath=s}}class $M{constructor(e,t){this.count=e,this.unchangedNames=t}}var $s,Cn;function gS(n){switch(n){case ue.OK:return dt(64938);case ue.CANCELLED:case ue.UNKNOWN:case ue.DEADLINE_EXCEEDED:case ue.RESOURCE_EXHAUSTED:case ue.INTERNAL:case ue.UNAVAILABLE:case ue.UNAUTHENTICATED:return!1;case ue.INVALID_ARGUMENT:case ue.NOT_FOUND:case ue.ALREADY_EXISTS:case ue.PERMISSION_DENIED:case ue.FAILED_PRECONDITION:case ue.ABORTED:case ue.OUT_OF_RANGE:case ue.UNIMPLEMENTED:case ue.DATA_LOSS:return!0;default:return dt(15467,{code:n})}}function yS(n){if(n===void 0)return Vs("GRPC error has no .code"),ue.UNKNOWN;switch(n){case $s.OK:return ue.OK;case $s.CANCELLED:return ue.CANCELLED;case $s.UNKNOWN:return ue.UNKNOWN;case $s.DEADLINE_EXCEEDED:return ue.DEADLINE_EXCEEDED;case $s.RESOURCE_EXHAUSTED:return ue.RESOURCE_EXHAUSTED;case $s.INTERNAL:return ue.INTERNAL;case $s.UNAVAILABLE:return ue.UNAVAILABLE;case $s.UNAUTHENTICATED:return ue.UNAUTHENTICATED;case $s.INVALID_ARGUMENT:return ue.INVALID_ARGUMENT;case $s.NOT_FOUND:return ue.NOT_FOUND;case $s.ALREADY_EXISTS:return ue.ALREADY_EXISTS;case $s.PERMISSION_DENIED:return ue.PERMISSION_DENIED;case $s.FAILED_PRECONDITION:return ue.FAILED_PRECONDITION;case $s.ABORTED:return ue.ABORTED;case $s.OUT_OF_RANGE:return ue.OUT_OF_RANGE;case $s.UNIMPLEMENTED:return ue.UNIMPLEMENTED;case $s.DATA_LOSS:return ue.DATA_LOSS;default:return dt(39323,{code:n})}}(Cn=$s||($s={}))[Cn.OK=0]="OK",Cn[Cn.CANCELLED=1]="CANCELLED",Cn[Cn.UNKNOWN=2]="UNKNOWN",Cn[Cn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Cn[Cn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Cn[Cn.NOT_FOUND=5]="NOT_FOUND",Cn[Cn.ALREADY_EXISTS=6]="ALREADY_EXISTS",Cn[Cn.PERMISSION_DENIED=7]="PERMISSION_DENIED",Cn[Cn.UNAUTHENTICATED=16]="UNAUTHENTICATED",Cn[Cn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Cn[Cn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Cn[Cn.ABORTED=10]="ABORTED",Cn[Cn.OUT_OF_RANGE=11]="OUT_OF_RANGE",Cn[Cn.UNIMPLEMENTED=12]="UNIMPLEMENTED",Cn[Cn.INTERNAL=13]="INTERNAL",Cn[Cn.UNAVAILABLE=14]="UNAVAILABLE",Cn[Cn.DATA_LOSS=15]="DATA_LOSS";let zb=null;function WM(n){if(zb)throw new Error("a TestingHooksSpi instance is already set");zb=n}function bS(){return new TextEncoder}const GM=new Vo([4294967295,4294967295],0);function A2(n){const e=bS().encode(n),t=new oE;return t.update(e),new Uint8Array(t.digest())}function R2(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),o=e.getUint32(8,!0),c=e.getUint32(12,!0);return[new Vo([t,s],0),new Vo([o,c],0)]}class Hv{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new Md(`Invalid padding: ${t}`);if(s<0)throw new Md(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new Md(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new Md(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Vo.fromNumber(this.ge)}ye(e,t,s){let o=e.add(t.multiply(Vo.fromNumber(s)));return o.compare(GM)===1&&(o=new Vo([o.getBits(0),o.getBits(1)],0)),o.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=A2(e),[s,o]=R2(t);for(let c=0;c<this.hashCount;c++){const u=this.ye(s,o,c);if(!this.we(u))return!1}return!0}static create(e,t,s){const o=e%8==0?0:8-e%8,c=new Uint8Array(Math.ceil(e/8)),u=new Hv(c,o,t);return s.forEach((h=>u.insert(h))),u}insert(e){if(this.ge===0)return;const t=A2(e),[s,o]=R2(t);for(let c=0;c<this.hashCount;c++){const u=this.ye(s,o,c);this.be(u)}}be(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class Md extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class jh{constructor(e,t,s,o,c){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=o,this.resolvedLimboDocuments=c}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const o=new Map;return o.set(e,Nh.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new jh(Et.min(),o,new os(Ht),$r(),tn())}}class Nh{constructor(e,t,s,o,c){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=o,this.removedDocuments=c}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new Nh(s,t,tn(),tn(),tn())}}class xm{constructor(e,t,s,o){this.Se=e,this.removedTargetIds=t,this.key=s,this.De=o}}class vS{constructor(e,t){this.targetId=e,this.Ce=t}}class xS{constructor(e,t,s=As.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=o}}class I2{constructor(){this.ve=0,this.Fe=D2(),this.Me=As.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=tn(),t=tn(),s=tn();return this.Fe.forEach(((o,c)=>{switch(c){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:s=s.add(o);break;default:dt(38017,{changeType:c})}})),new Nh(this.Me,this.xe,e,t,s)}Ke(){this.Oe=!1,this.Fe=D2()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,gt(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class KM{constructor(e){this.Ge=e,this.ze=new Map,this.je=$r(),this.He=Kf(),this.Je=Kf(),this.Ze=new os(Ht)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const s=this.nt(t);switch(e.state){case 0:this.rt(t)&&s.Le(e.resumeToken);break;case 1:s.We(),s.Ne||s.Ke(),s.Le(e.resumeToken);break;case 2:s.We(),s.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(s.Qe(),s.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),s.Le(e.resumeToken));break;default:dt(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((s,o)=>{this.rt(o)&&t(o)}))}st(e){const t=e.targetId,s=e.Ce.count,o=this.ot(t);if(o){const c=o.target;if(Om(c))if(s===0){const u=new Je(c.path);this.et(t,u,hs.newNoDocument(u,Et.min()))}else gt(s===1,20013,{expectedCount:s});else{const u=this._t(t);if(u!==s){const h=this.ut(e),m=h?this.ct(h,e,u):1;if(m!==0){this.it(t);const g=m===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,g)}zb?.lt((function(b,x,T,N,B){const P={localCacheCount:b,existenceFilterCount:x.count,databaseId:T.database,projectId:T.projectId},M=x.unchangedNames;return M&&(P.bloomFilter={applied:B===0,hashCount:M?.hashCount??0,bitmapLength:M?.bits?.bitmap?.length??0,padding:M?.bits?.padding??0,mightContain:Y=>N?.mightContain(Y)??!1}),P})(u,e.Ce,this.Ge.ht(),h,m))}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:o=0},hashCount:c=0}=t;let u,h;try{u=Va(s).toUint8Array()}catch(m){if(m instanceof LE)return wi("Decoding the base64 bloom filter in existence filter failed ("+m.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw m}try{h=new Hv(u,o,c)}catch(m){return wi(m instanceof Md?"BloomFilter error: ":"Applying bloom filter failed: ",m),null}return h.ge===0?null:h}ct(e,t,s){return t.Ce.count===s-this.Pt(e,t.targetId)?0:2}Pt(e,t){const s=this.Ge.getRemoteKeysForTarget(t);let o=0;return s.forEach((c=>{const u=this.Ge.ht(),h=`projects/${u.projectId}/databases/${u.database}/documents/${c.path.canonicalString()}`;e.mightContain(h)||(this.et(t,c,null),o++)})),o}Tt(e){const t=new Map;this.ze.forEach(((c,u)=>{const h=this.ot(u);if(h){if(c.current&&Om(h.target)){const m=new Je(h.target.path);this.It(m).has(u)||this.Et(u,m)||this.et(u,m,hs.newNoDocument(m,e))}c.Be&&(t.set(u,c.ke()),c.Ke())}}));let s=tn();this.Je.forEach(((c,u)=>{let h=!0;u.forEachWhile((m=>{const g=this.ot(m);return!g||g.purpose==="TargetPurposeLimboResolution"||(h=!1,!1)})),h&&(s=s.add(c))})),this.je.forEach(((c,u)=>u.setReadTime(e)));const o=new jh(e,t,this.Ze,this.je,s);return this.je=$r(),this.He=Kf(),this.Je=Kf(),this.Ze=new os(Ht),o}Ye(e,t){if(!this.rt(e))return;const s=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,s),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,s){if(!this.rt(e))return;const o=this.nt(e);this.Et(e,t)?o.qe(t,1):o.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),s&&(this.je=this.je.insert(t,s))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new I2,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Qn(Ht),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Qn(Ht),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Ve("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new I2),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Kf(){return new os(Je.comparator)}function D2(){return new os(Je.comparator)}const QM={asc:"ASCENDING",desc:"DESCENDING"},YM={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},XM={and:"AND",or:"OR"};class JM{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function qb(n,e){return n.useProto3Json||_h(e)?e:{value:e}}function hu(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function _S(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function ZM(n,e){return hu(n,e.toTimestamp())}function Os(n){return gt(!!n,49232),Et.fromTimestamp((function(t){const s=La(t);return new pt(s.seconds,s.nanos)})(n))}function $v(n,e){return Hb(n,e).canonicalString()}function Hb(n,e){const t=(function(o){return new fn(["projects",o.projectId,"databases",o.database])})(n).child("documents");return e===void 0?t:t.child(e)}function wS(n){const e=fn.fromString(n);return gt(RS(e),10190,{key:e.toString()}),e}function ch(n,e){return $v(n.databaseId,e.path)}function ra(n,e){const t=wS(e);if(t.get(1)!==n.databaseId.projectId)throw new Re(ue.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Re(ue.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Je(ES(t))}function TS(n,e){return $v(n.databaseId,e)}function kS(n){const e=wS(n);return e.length===4?fn.emptyPath():ES(e)}function $b(n){return new fn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function ES(n){return gt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function P2(n,e,t){return{name:ch(n,e),fields:t.value.mapValue.fields}}function gp(n,e,t){const s=ra(n,e.name),o=Os(e.updateTime),c=e.createTime?Os(e.createTime):Et.min(),u=new ir({mapValue:{fields:e.fields}}),h=hs.newFoundDocument(s,o,c,u);return t&&h.setHasCommittedMutations(),t?h.setHasCommittedMutations():h}function e3(n,e){return"found"in e?(function(s,o){gt(!!o.found,43571),o.found.name,o.found.updateTime;const c=ra(s,o.found.name),u=Os(o.found.updateTime),h=o.found.createTime?Os(o.found.createTime):Et.min(),m=new ir({mapValue:{fields:o.found.fields}});return hs.newFoundDocument(c,u,h,m)})(n,e):"missing"in e?(function(s,o){gt(!!o.missing,3894),gt(!!o.readTime,22933);const c=ra(s,o.missing),u=Os(o.readTime);return hs.newNoDocument(c,u)})(n,e):dt(7234,{result:e})}function t3(n,e){let t;if("targetChange"in e){e.targetChange;const s=(function(g){return g==="NO_CHANGE"?0:g==="ADD"?1:g==="REMOVE"?2:g==="CURRENT"?3:g==="RESET"?4:dt(39313,{state:g})})(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],c=(function(g,b){return g.useProto3Json?(gt(b===void 0||typeof b=="string",58123),As.fromBase64String(b||"")):(gt(b===void 0||b instanceof Buffer||b instanceof Uint8Array,16193),As.fromUint8Array(b||new Uint8Array))})(n,e.targetChange.resumeToken),u=e.targetChange.cause,h=u&&(function(g){const b=g.code===void 0?ue.UNKNOWN:yS(g.code);return new Re(b,g.message||"")})(u);t=new xS(s,o,c,h||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const o=ra(n,s.document.name),c=Os(s.document.updateTime),u=s.document.createTime?Os(s.document.createTime):Et.min(),h=new ir({mapValue:{fields:s.document.fields}}),m=hs.newFoundDocument(o,c,u,h),g=s.targetIds||[],b=s.removedTargetIds||[];t=new xm(g,b,m.key,m)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const o=ra(n,s.document),c=s.readTime?Os(s.readTime):Et.min(),u=hs.newNoDocument(o,c),h=s.removedTargetIds||[];t=new xm([],h,u.key,u)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const o=ra(n,s.document),c=s.removedTargetIds||[];t=new xm([],c,o,null)}else{if(!("filter"in e))return dt(11601,{Vt:e});{e.filter;const s=e.filter;s.targetId;const{count:o=0,unchangedNames:c}=s,u=new $M(o,c),h=s.targetId;t=new vS(h,u)}}return t}function uh(n,e){let t;if(e instanceof Su)t={update:P2(n,e.key,e.value)};else if(e instanceof ju)t={delete:ch(n,e.key)};else if(e instanceof Ha)t={update:P2(n,e.key,e.data),updateMask:o3(e.fieldMask)};else{if(!(e instanceof Uv))return dt(16599,{dt:e.type});t={verify:ch(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((s=>(function(c,u){const h=u.transform;if(h instanceof uu)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof Ul)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof Fl)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof du)return{fieldPath:u.field.canonicalString(),increment:h.Ae};throw dt(20930,{transform:u.transform})})(0,s)))),e.precondition.isNone||(t.currentDocument=(function(o,c){return c.updateTime!==void 0?{updateTime:ZM(o,c.updateTime)}:c.exists!==void 0?{exists:c.exists}:dt(27497)})(n,e.precondition)),t}function Wb(n,e){const t=e.currentDocument?(function(c){return c.updateTime!==void 0?vs.updateTime(Os(c.updateTime)):c.exists!==void 0?vs.exists(c.exists):vs.none()})(e.currentDocument):vs.none(),s=e.updateTransforms?e.updateTransforms.map((o=>(function(u,h){let m=null;if("setToServerValue"in h)gt(h.setToServerValue==="REQUEST_TIME",16630,{proto:h}),m=new uu;else if("appendMissingElements"in h){const b=h.appendMissingElements.values||[];m=new Ul(b)}else if("removeAllFromArray"in h){const b=h.removeAllFromArray.values||[];m=new Fl(b)}else"increment"in h?m=new du(u,h.increment):dt(16584,{proto:h});const g=bs.fromServerFormat(h.fieldPath);return new Sh(g,m)})(n,o))):[];if(e.update){e.update.name;const o=ra(n,e.update.name),c=new ir({mapValue:{fields:e.update.fields}});if(e.updateMask){const u=(function(m){const g=m.fieldPaths||[];return new Hr(g.map((b=>bs.fromServerFormat(b))))})(e.updateMask);return new Ha(o,c,u,t,s)}return new Su(o,c,t,s)}if(e.delete){const o=ra(n,e.delete);return new ju(o,t)}if(e.verify){const o=ra(n,e.verify);return new Uv(o,t)}return dt(1463,{proto:e})}function n3(n,e){return n&&n.length>0?(gt(e!==void 0,14353),n.map((t=>(function(o,c){let u=o.updateTime?Os(o.updateTime):Os(c);return u.isEqual(Et.min())&&(u=Os(c)),new zM(u,o.transformResults||[])})(t,e)))):[]}function SS(n,e){return{documents:[TS(n,e.path)]}}function yp(n,e){const t={structuredQuery:{}},s=e.path;let o;e.collectionGroup!==null?(o=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=TS(n,o);const c=(function(g){if(g.length!==0)return AS(Kn.create(g,"and"))})(e.filters);c&&(t.structuredQuery.where=c);const u=(function(g){if(g.length!==0)return g.map((b=>(function(T){return{field:jo(T.field),direction:r3(T.dir)}})(b)))})(e.orderBy);u&&(t.structuredQuery.orderBy=u);const h=qb(n,e.limit);return h!==null&&(t.structuredQuery.limit=h),e.startAt&&(t.structuredQuery.startAt=(function(g){return{before:g.inclusive,values:g.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(g){return{before:!g.inclusive,values:g.position}})(e.endAt)),{ft:t,parent:o}}function jS(n,e,t,s){const{ft:o,parent:c}=yp(n,e),u={},h=[];let m=0;return t.forEach((g=>{const b=s?g.alias:"aggregate_"+m++;u[b]=g.alias,g.aggregateType==="count"?h.push({alias:b,count:{}}):g.aggregateType==="avg"?h.push({alias:b,avg:{field:jo(g.fieldPath)}}):g.aggregateType==="sum"&&h.push({alias:b,sum:{field:jo(g.fieldPath)}})})),{request:{structuredAggregationQuery:{aggregations:h,structuredQuery:o.structuredQuery},parent:o.parent},gt:u,parent:c}}function NS(n){let e=kS(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let o=null;if(s>0){gt(s===1,65062);const b=t.from[0];b.allDescendants?o=b.collectionId:e=e.child(b.collectionId)}let c=[];t.where&&(c=(function(x){const T=CS(x);return T instanceof Kn&&Lv(T)?T.getFilters():[T]})(t.where));let u=[];t.orderBy&&(u=(function(x){return x.map((T=>(function(B){return new lh(Hc(B.field),(function(M){switch(M){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(B.direction))})(T)))})(t.orderBy));let h=null;t.limit&&(h=(function(x){let T;return T=typeof x=="object"?x.value:x,_h(T)?null:T})(t.limit));let m=null;t.startAt&&(m=(function(x){const T=!!x.before,N=x.values||[];return new qo(N,T)})(t.startAt));let g=null;return t.endAt&&(g=(function(x){const T=!x.before,N=x.values||[];return new qo(N,T)})(t.endAt)),JE(e,o,u,c,h,"F",m,g)}function s3(n,e){const t=(function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return dt(28987,{purpose:o})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function CS(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=Hc(t.unaryFilter.field);return Tn.create(s,"==",{doubleValue:NaN});case"IS_NULL":const o=Hc(t.unaryFilter.field);return Tn.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const c=Hc(t.unaryFilter.field);return Tn.create(c,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=Hc(t.unaryFilter.field);return Tn.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return dt(61313);default:return dt(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Tn.create(Hc(t.fieldFilter.field),(function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return dt(58110);default:return dt(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Kn.create(t.compositeFilter.filters.map((s=>CS(s))),(function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return dt(1026)}})(t.compositeFilter.op))})(n):dt(30097,{filter:n})}function r3(n){return QM[n]}function i3(n){return YM[n]}function a3(n){return XM[n]}function jo(n){return{fieldPath:n.canonicalString()}}function Hc(n){return bs.fromServerFormat(n.fieldPath)}function AS(n){return n instanceof Tn?(function(t){if(t.op==="=="){if(b2(t.value))return{unaryFilter:{field:jo(t.field),op:"IS_NAN"}};if(y2(t.value))return{unaryFilter:{field:jo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(b2(t.value))return{unaryFilter:{field:jo(t.field),op:"IS_NOT_NAN"}};if(y2(t.value))return{unaryFilter:{field:jo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:jo(t.field),op:i3(t.op),value:t.value}}})(n):n instanceof Kn?(function(t){const s=t.getFilters().map((o=>AS(o)));return s.length===1?s[0]:{compositeFilter:{op:a3(t.op),filters:s}}})(n):dt(54877,{filter:n})}function o3(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function RS(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function IS(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}class Ca{constructor(e,t,s,o,c=Et.min(),u=Et.min(),h=As.EMPTY_BYTE_STRING,m=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=o,this.snapshotVersion=c,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=h,this.expectedCount=m}withSequenceNumber(e){return new Ca(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ca(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ca(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ca(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class DS{constructor(e){this.yt=e}}function l3(n,e){let t;if(e.document)t=gp(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const s=Je.fromSegments(e.noDocument.path),o=ql(e.noDocument.readTime);t=hs.newNoDocument(s,o),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return dt(56709);{const s=Je.fromSegments(e.unknownDocument.path),o=ql(e.unknownDocument.version);t=hs.newUnknownDocument(s,o)}}return e.readTime&&t.setReadTime((function(o){const c=new pt(o[0],o[1]);return Et.fromTimestamp(c)})(e.readTime)),t}function M2(n,e){const t=e.key,s={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Fm(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())s.document=(function(c,u){return{name:ch(c,u.key),fields:u.data.value.mapValue.fields,updateTime:hu(c,u.version.toTimestamp()),createTime:hu(c,u.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())s.noDocument={path:t.path.toArray(),readTime:zl(e.version)};else{if(!e.isUnknownDocument())return dt(57904,{document:e});s.unknownDocument={path:t.path.toArray(),version:zl(e.version)}}return s}function Fm(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function zl(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ql(n){const e=new pt(n.seconds,n.nanoseconds);return Et.fromTimestamp(e)}function kl(n,e){const t=(e.baseMutations||[]).map((c=>Wb(n.yt,c)));for(let c=0;c<e.mutations.length-1;++c){const u=e.mutations[c];if(c+1<e.mutations.length&&e.mutations[c+1].transform!==void 0){const h=e.mutations[c+1];u.updateTransforms=h.transform.fieldTransforms,e.mutations.splice(c+1,1),++c}}const s=e.mutations.map((c=>Wb(n.yt,c))),o=pt.fromMillis(e.localWriteTimeMs);return new Fv(e.batchId,o,t,s)}function Ld(n){const e=ql(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?ql(n.lastLimboFreeSnapshotVersion):Et.min();let s;return s=(function(c){return c.documents!==void 0})(n.query)?(function(c){const u=c.documents.length;return gt(u===1,1966,{count:u}),kr(Eu(kS(c.documents[0])))})(n.query):(function(c){return kr(NS(c))})(n.query),new Ca(s,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,As.fromBase64String(n.resumeToken))}function PS(n,e){const t=zl(e.snapshotVersion),s=zl(e.lastLimboFreeSnapshotVersion);let o;o=Om(e.target)?SS(n.yt,e.target):yp(n.yt,e.target).ft;const c=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Bl(e.target),readTime:t,resumeToken:c,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:s,query:o}}function bp(n){const e=NS({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Um(e,e.limit,"L"):e}function Hy(n,e){return new qv(e.largestBatchId,Wb(n.yt,e.overlayMutation))}function L2(n,e){const t=e.path.lastSegment();return[n,Tr(e.path.popLast()),t]}function V2(n,e,t,s){return{indexId:n,uid:e,sequenceNumber:t,readTime:zl(s.readTime),documentKey:Tr(s.documentKey.path),largestBatchId:s.largestBatchId}}class c3{getBundleMetadata(e,t){return O2(e).get(t).next((s=>{if(s)return(function(c){return{id:c.bundleId,createTime:ql(c.createTime),version:c.version}})(s)}))}saveBundleMetadata(e,t){return O2(e).put((function(o){return{bundleId:o.id,createTime:zl(Os(o.createTime)),version:o.version}})(t))}getNamedQuery(e,t){return B2(e).get(t).next((s=>{if(s)return(function(c){return{name:c.name,query:bp(c.bundledQuery),readTime:ql(c.readTime)}})(s)}))}saveNamedQuery(e,t){return B2(e).put((function(o){return{name:o.name,readTime:zl(Os(o.readTime)),bundledQuery:o.bundledQuery}})(t))}}function O2(n){return Zs(n,lp)}function B2(n){return Zs(n,cp)}class vp{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const s=t.uid||"";return new vp(e,s)}getOverlay(e,t){return _d(e).get(L2(this.userId,t)).next((s=>s?Hy(this.serializer,s):null))}getOverlays(e,t){const s=Ji();return re.forEach(t,(o=>this.getOverlay(e,o).next((c=>{c!==null&&s.set(o,c)})))).next((()=>s))}saveOverlays(e,t,s){const o=[];return s.forEach(((c,u)=>{const h=new qv(t,u);o.push(this.bt(e,h))})),re.waitFor(o)}removeOverlaysForBatchId(e,t,s){const o=new Set;t.forEach((u=>o.add(Tr(u.getCollectionPath()))));const c=[];return o.forEach((u=>{const h=IDBKeyRange.bound([this.userId,u,s],[this.userId,u,s+1],!1,!0);c.push(_d(e).X(Pb,h))})),re.waitFor(c)}getOverlaysForCollection(e,t,s){const o=Ji(),c=Tr(t),u=IDBKeyRange.bound([this.userId,c,s],[this.userId,c,Number.POSITIVE_INFINITY],!0);return _d(e).H(Pb,u).next((h=>{for(const m of h){const g=Hy(this.serializer,m);o.set(g.getKey(),g)}return o}))}getOverlaysForCollectionGroup(e,t,s,o){const c=Ji();let u;const h=IDBKeyRange.bound([this.userId,t,s],[this.userId,t,Number.POSITIVE_INFINITY],!0);return _d(e).ee({index:CE,range:h},((m,g,b)=>{const x=Hy(this.serializer,g);c.size()<o||x.largestBatchId===u?(c.set(x.getKey(),x),u=x.largestBatchId):b.done()})).next((()=>c))}bt(e,t){return _d(e).put((function(o,c,u){const[h,m,g]=L2(c,u.mutation.key);return{userId:c,collectionPath:m,documentId:g,collectionGroup:u.mutation.key.getCollectionGroup(),largestBatchId:u.largestBatchId,overlayMutation:uh(o.yt,u.mutation)}})(this.serializer,this.userId,t))}}function _d(n){return Zs(n,up)}class u3{St(e){return Zs(e,Iv)}getSessionToken(e){return this.St(e).get("sessionToken").next((t=>{const s=t?.value;return s?As.fromUint8Array(s):As.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.St(e).put({name:"sessionToken",value:t.toUint8Array()})}}class El{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(ys(e.integerValue));else if("doubleValue"in e){const s=ys(e.doubleValue);isNaN(s)?this.Ft(t,13):(this.Ft(t,15),eh(s)?t.Mt(0):t.Mt(s))}else if("timestampValue"in e){let s=e.timestampValue;this.Ft(t,20),typeof s=="string"&&(s=La(s)),t.xt(`${s.seconds||""}`),t.Mt(s.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Va(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const s=e.geoPointValue;this.Ft(t,45),t.Mt(s.latitude||0),t.Mt(s.longitude||0)}else"mapValue"in e?zE(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):fp(e)?this.kt(e.mapValue,t):(this.Kt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Nt(t)):dt(19022,{Ut:e})}Ot(e,t){this.Ft(t,25),this.$t(e,t)}$t(e,t){t.xt(e)}Kt(e,t){const s=e.fields||{};this.Ft(t,55);for(const o of Object.keys(s))this.Ot(o,t),this.Ct(s[o],t)}kt(e,t){const s=e.fields||{};this.Ft(t,53);const o=ou,c=s[o].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(ys(c)),this.Ot(o,t),this.Ct(s[o],t)}qt(e,t){const s=e.values||[];this.Ft(t,50);for(const o of s)this.Ct(o,t)}Lt(e,t){this.Ft(t,37),Je.fromName(e).path.forEach((s=>{this.Ft(t,60),this.$t(s,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}El.Wt=new El;const Pc=255;function d3(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function U2(n){const e=64-(function(s){let o=0;for(let c=0;c<8;++c){const u=d3(255&s[c]);if(o+=u,u!==8)break}return o})(n);return Math.ceil(e/8)}class h3{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Qt(e){const t=e[Symbol.iterator]();let s=t.next();for(;!s.done;)this.Gt(s.value),s=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let s=t.next();for(;!s.done;)this.Ht(s.value),s=t.next();this.Jt()}Zt(e){for(const t of e){const s=t.charCodeAt(0);if(s<128)this.Gt(s);else if(s<2048)this.Gt(960|s>>>6),this.Gt(128|63&s);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s);else{const o=t.codePointAt(0);this.Gt(240|o>>>18),this.Gt(128|63&o>>>12),this.Gt(128|63&o>>>6),this.Gt(128|63&o)}}this.zt()}Xt(e){for(const t of e){const s=t.charCodeAt(0);if(s<128)this.Ht(s);else if(s<2048)this.Ht(960|s>>>6),this.Ht(128|63&s);else if(t<"\uD800"||"\uDBFF"<t)this.Ht(480|s>>>12),this.Ht(128|63&s>>>6),this.Ht(128|63&s);else{const o=t.codePointAt(0);this.Ht(240|o>>>18),this.Ht(128|63&o>>>12),this.Ht(128|63&o>>>6),this.Ht(128|63&o)}}this.Jt()}Yt(e){const t=this.en(e),s=U2(t);this.tn(1+s),this.buffer[this.position++]=255&s;for(let o=t.length-s;o<t.length;++o)this.buffer[this.position++]=255&t[o]}nn(e){const t=this.en(e),s=U2(t);this.tn(1+s),this.buffer[this.position++]=~(255&s);for(let o=t.length-s;o<t.length;++o)this.buffer[this.position++]=~(255&t[o])}rn(){this.sn(Pc),this.sn(255)}_n(){this.an(Pc),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(c){const u=new DataView(new ArrayBuffer(8));return u.setFloat64(0,c,!1),new Uint8Array(u.buffer)})(e),s=!!(128&t[0]);t[0]^=s?255:128;for(let o=1;o<t.length;++o)t[o]^=s?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Pc?(this.sn(Pc),this.sn(0)):this.sn(t)}Ht(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Pc?(this.an(Pc),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Jt(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let s=2*this.buffer.length;s<t&&(s=t);const o=new Uint8Array(s);o.set(this.buffer),this.buffer=o}}class f3{constructor(e){this.cn=e}Bt(e){this.cn.Qt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.Yt(e)}vt(){this.cn.rn()}}class m3{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Xt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class wd{constructor(){this.cn=new h3,this.ascending=new f3(this.cn),this.descending=new m3(this.cn)}seed(e){this.cn.seed(e)}ln(e){return e===0?this.ascending:this.descending}un(){return this.cn.un()}reset(){this.cn.reset()}}class Sl{constructor(e,t,s,o){this.hn=e,this.Pn=t,this.Tn=s,this.In=o}En(){const e=this.In.length,t=e===0||this.In[e-1]===255?e+1:e,s=new Uint8Array(t);return s.set(this.In,0),t!==e?s.set([0],this.In.length):++s[s.length-1],new Sl(this.hn,this.Pn,this.Tn,s)}Rn(e,t,s){return{indexId:this.hn,uid:e,arrayValue:_m(this.Tn),directionalValue:_m(this.In),orderedDocumentKey:_m(t),documentKey:s.path.toArray()}}An(e,t,s){const o=this.Rn(e,t,s);return[o.indexId,o.uid,o.arrayValue,o.directionalValue,o.orderedDocumentKey,o.documentKey]}}function bo(n,e){let t=n.hn-e.hn;return t!==0?t:(t=F2(n.Tn,e.Tn),t!==0?t:(t=F2(n.In,e.In),t!==0?t:Je.comparator(n.Pn,e.Pn)))}function F2(n,e){for(let t=0;t<n.length&&t<e.length;++t){const s=n[t]-e[t];if(s!==0)return s}return n.length-e.length}function _m(n){return xk()?(function(t){let s="";for(let o=0;o<t.length;o++)s+=String.fromCharCode(t[o]);return s})(n):n}function z2(n){return typeof n!="string"?n:(function(t){const s=new Uint8Array(t.length);for(let o=0;o<t.length;o++)s[o]=t.charCodeAt(o);return s})(n)}class q2{constructor(e){this.Vn=new Qn(((t,s)=>bs.comparator(t.field,s.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.dn=e.orderBy,this.mn=[];for(const t of e.filters){const s=t;s.isInequality()?this.Vn=this.Vn.add(s):this.mn.push(s)}}get fn(){return this.Vn.size>1}gn(e){if(gt(e.collectionGroup===this.collectionId,49279),this.fn)return!1;const t=Rb(e);if(t!==void 0&&!this.pn(t))return!1;const s=_l(e);let o=new Set,c=0,u=0;for(;c<s.length&&this.pn(s[c]);++c)o=o.add(s[c].fieldPath.canonicalString());if(c===s.length)return!0;if(this.Vn.size>0){const h=this.Vn.getIterator().getNext();if(!o.has(h.field.canonicalString())){const m=s[c];if(!this.yn(h,m)||!this.wn(this.dn[u++],m))return!1}++c}for(;c<s.length;++c){const h=s[c];if(u>=this.dn.length||!this.wn(this.dn[u++],h))return!1}return!0}bn(){if(this.fn)return null;let e=new Qn(bs.comparator);const t=[];for(const s of this.mn)if(!s.field.isKeyField())if(s.op==="array-contains"||s.op==="array-contains-any")t.push(new Cl(s.field,2));else{if(e.has(s.field))continue;e=e.add(s.field),t.push(new Cl(s.field,0))}for(const s of this.dn)s.field.isKeyField()||e.has(s.field)||(e=e.add(s.field),t.push(new Cl(s.field,s.dir==="asc"?0:1)));return new tu(tu.UNKNOWN_ID,this.collectionId,t,nu.empty())}pn(e){for(const t of this.mn)if(this.yn(t,e))return!0;return!1}yn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const s=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===s}wn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function MS(n){if(gt(n instanceof Tn||n instanceof Kn,20012),n instanceof Tn){if(n instanceof XE){const t=n.value.arrayValue?.values?.map((s=>Tn.create(n.field,"==",s)))||[];return Kn.create(t,"or")}return n}const e=n.filters.map((t=>MS(t)));return Kn.create(e,n.op)}function p3(n){if(n.getFilters().length===0)return[];const e=Qb(MS(n));return gt(LS(e),7391),Gb(e)||Kb(e)?[e]:e.getFilters()}function Gb(n){return n instanceof Tn}function Kb(n){return n instanceof Kn&&Lv(n)}function LS(n){return Gb(n)||Kb(n)||(function(t){if(t instanceof Kn&&Ob(t)){for(const s of t.getFilters())if(!Gb(s)&&!Kb(s))return!1;return!0}return!1})(n)}function Qb(n){if(gt(n instanceof Tn||n instanceof Kn,34018),n instanceof Tn)return n;if(n.filters.length===1)return Qb(n.filters[0]);const e=n.filters.map((s=>Qb(s)));let t=Kn.create(e,n.op);return t=zm(t),LS(t)?t:(gt(t instanceof Kn,64498),gt(cu(t),40251),gt(t.filters.length>1,57927),t.filters.reduce(((s,o)=>Wv(s,o))))}function Wv(n,e){let t;return gt(n instanceof Tn||n instanceof Kn,38388),gt(e instanceof Tn||e instanceof Kn,25473),t=n instanceof Tn?e instanceof Tn?(function(o,c){return Kn.create([o,c],"and")})(n,e):H2(n,e):e instanceof Tn?H2(e,n):(function(o,c){if(gt(o.filters.length>0&&c.filters.length>0,48005),cu(o)&&cu(c))return KE(o,c.getFilters());const u=Ob(o)?o:c,h=Ob(o)?c:o,m=u.filters.map((g=>Wv(g,h)));return Kn.create(m,"or")})(n,e),zm(t)}function H2(n,e){if(cu(e))return KE(e,n.getFilters());{const t=e.filters.map((s=>Wv(n,s)));return Kn.create(t,"or")}}function zm(n){if(gt(n instanceof Tn||n instanceof Kn,11850),n instanceof Tn)return n;const e=n.getFilters();if(e.length===1)return zm(e[0]);if(WE(n))return n;const t=e.map((o=>zm(o))),s=[];return t.forEach((o=>{o instanceof Tn?s.push(o):o instanceof Kn&&(o.op===n.op?s.push(...o.filters):s.push(o))})),s.length===1?s[0]:Kn.create(s,n.op)}class g3{constructor(){this.Sn=new Gv}addToCollectionParentIndex(e,t){return this.Sn.add(t),re.resolve()}getCollectionParents(e,t){return re.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return re.resolve()}deleteFieldIndex(e,t){return re.resolve()}deleteAllFieldIndexes(e){return re.resolve()}createTargetIndexes(e,t){return re.resolve()}getDocumentsMatchingTarget(e,t){return re.resolve(null)}getIndexType(e,t){return re.resolve(0)}getFieldIndexes(e,t){return re.resolve([])}getNextCollectionGroupToUpdate(e){return re.resolve(null)}getMinOffset(e,t){return re.resolve(oi.min())}getMinOffsetFromCollectionGroup(e,t){return re.resolve(oi.min())}updateCollectionGroup(e,t,s){return re.resolve()}updateIndexEntries(e,t){return re.resolve()}}class Gv{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),o=this.index[t]||new Qn(fn.comparator),c=!o.has(s);return this.index[t]=o.add(s),c}has(e){const t=e.lastSegment(),s=e.popLast(),o=this.index[t];return o&&o.has(s)}getEntries(e){return(this.index[e]||new Qn(fn.comparator)).toArray()}}const $2="IndexedDbIndexManager",Qf=new Uint8Array(0);class y3{constructor(e,t){this.databaseId=t,this.Dn=new Gv,this.Cn=new qa((s=>Bl(s)),((s,o)=>Th(s,o))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Dn.has(t)){const s=t.lastSegment(),o=t.popLast();e.addOnCommittedListener((()=>{this.Dn.add(t)}));const c={collectionId:s,parent:Tr(o)};return W2(e).put(c)}return re.resolve()}getCollectionParents(e,t){const s=[],o=IDBKeyRange.bound([t,""],[pE(t),""],!1,!0);return W2(e).H(o).next((c=>{for(const u of c){if(u.collectionId!==t)break;s.push(Xi(u.parent))}return s}))}addFieldIndex(e,t){const s=Td(e),o=(function(h){return{indexId:h.indexId,collectionGroup:h.collectionGroup,fields:h.fields.map((m=>[m.fieldPath.canonicalString(),m.kind]))}})(t);delete o.indexId;const c=s.add(o);if(t.indexState){const u=Lc(e);return c.next((h=>{u.put(V2(h,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return c.next()}deleteFieldIndex(e,t){const s=Td(e),o=Lc(e),c=Mc(e);return s.delete(t.indexId).next((()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>c.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Td(e),s=Mc(e),o=Lc(e);return t.X().next((()=>s.X())).next((()=>o.X()))}createTargetIndexes(e,t){return re.forEach(this.vn(t),(s=>this.getIndexType(e,s).next((o=>{if(o===0||o===1){const c=new q2(s).bn();if(c!=null)return this.addFieldIndex(e,c)}}))))}getDocumentsMatchingTarget(e,t){const s=Mc(e);let o=!0;const c=new Map;return re.forEach(this.vn(t),(u=>this.Fn(e,u).next((h=>{o&&(o=!!h),c.set(u,h)})))).next((()=>{if(o){let u=tn();const h=[];return re.forEach(c,((m,g)=>{Ve($2,`Using index ${(function(X){return`id=${X.indexId}|cg=${X.collectionGroup}|f=${X.fields.map((fe=>`${fe.fieldPath}:${fe.kind}`)).join(",")}`})(m)} to execute ${Bl(t)}`);const b=(function(X,fe){const je=Rb(fe);if(je===void 0)return null;for(const Te of Bm(X,je.fieldPath))switch(Te.op){case"array-contains-any":return Te.value.arrayValue.values||[];case"array-contains":return[Te.value]}return null})(g,m),x=(function(X,fe){const je=new Map;for(const Te of _l(fe))for(const C of Bm(X,Te.fieldPath))switch(C.op){case"==":case"in":je.set(Te.fieldPath.canonicalString(),C.value);break;case"not-in":case"!=":return je.set(Te.fieldPath.canonicalString(),C.value),Array.from(je.values())}return null})(g,m),T=(function(X,fe){const je=[];let Te=!0;for(const C of _l(fe)){const S=C.kind===0?T2(X,C.fieldPath,X.startAt):k2(X,C.fieldPath,X.startAt);je.push(S.value),Te&&(Te=S.inclusive)}return new qo(je,Te)})(g,m),N=(function(X,fe){const je=[];let Te=!0;for(const C of _l(fe)){const S=C.kind===0?k2(X,C.fieldPath,X.endAt):T2(X,C.fieldPath,X.endAt);je.push(S.value),Te&&(Te=S.inclusive)}return new qo(je,Te)})(g,m),B=this.Mn(m,g,T),P=this.Mn(m,g,N),M=this.xn(m,g,x),Y=this.On(m.indexId,b,B,T.inclusive,P,N.inclusive,M);return re.forEach(Y,(H=>s.Z(H,t.limit).next((X=>{X.forEach((fe=>{const je=Je.fromSegments(fe.documentKey);u.has(je)||(u=u.add(je),h.push(je))}))}))))})).next((()=>h))}return re.resolve(null)}))}vn(e){let t=this.Cn.get(e);return t||(e.filters.length===0?t=[e]:t=p3(Kn.create(e.filters,"and")).map((s=>Ub(e.path,e.collectionGroup,e.orderBy,s.getFilters(),e.limit,e.startAt,e.endAt))),this.Cn.set(e,t),t)}On(e,t,s,o,c,u,h){const m=(t!=null?t.length:1)*Math.max(s.length,c.length),g=m/(t!=null?t.length:1),b=[];for(let x=0;x<m;++x){const T=t?this.Nn(t[x/g]):Qf,N=this.Bn(e,T,s[x%g],o),B=this.Ln(e,T,c[x%g],u),P=h.map((M=>this.Bn(e,T,M,!0)));b.push(...this.createRange(N,B,P))}return b}Bn(e,t,s,o){const c=new Sl(e,Je.empty(),t,s);return o?c:c.En()}Ln(e,t,s,o){const c=new Sl(e,Je.empty(),t,s);return o?c.En():c}Fn(e,t){const s=new q2(t),o=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,o).next((c=>{let u=null;for(const h of c)s.gn(h)&&(!u||h.fields.length>u.fields.length)&&(u=h);return u}))}getIndexType(e,t){let s=2;const o=this.vn(t);return re.forEach(o,(c=>this.Fn(e,c).next((u=>{u?s!==0&&u.fields.length<(function(m){let g=new Qn(bs.comparator),b=!1;for(const x of m.filters)for(const T of x.getFlattenedFilters())T.field.isKeyField()||(T.op==="array-contains"||T.op==="array-contains-any"?b=!0:g=g.add(T.field));for(const x of m.orderBy)x.field.isKeyField()||(g=g.add(x.field));return g.size+(b?1:0)})(c)&&(s=1):s=0})))).next((()=>(function(u){return u.limit!==null})(t)&&o.length>1&&s===2?1:s))}kn(e,t){const s=new wd;for(const o of _l(e)){const c=t.data.field(o.fieldPath);if(c==null)return null;const u=s.ln(o.kind);El.Wt.Dt(c,u)}return s.un()}Nn(e){const t=new wd;return El.Wt.Dt(e,t.ln(0)),t.un()}Kn(e,t){const s=new wd;return El.Wt.Dt(Ol(this.databaseId,t),s.ln((function(c){const u=_l(c);return u.length===0?0:u[u.length-1].kind})(e))),s.un()}xn(e,t,s){if(s===null)return[];let o=[];o.push(new wd);let c=0;for(const u of _l(e)){const h=s[c++];for(const m of o)if(this.qn(t,u.fieldPath)&&oh(h))o=this.Un(o,u,h);else{const g=m.ln(u.kind);El.Wt.Dt(h,g)}}return this.$n(o)}Mn(e,t,s){return this.xn(e,t,s.position)}$n(e){const t=[];for(let s=0;s<e.length;++s)t[s]=e[s].un();return t}Un(e,t,s){const o=[...e],c=[];for(const u of s.arrayValue.values||[])for(const h of o){const m=new wd;m.seed(h.un()),El.Wt.Dt(u,m.ln(t.kind)),c.push(m)}return c}qn(e,t){return!!e.filters.find((s=>s instanceof Tn&&s.field.isEqual(t)&&(s.op==="in"||s.op==="not-in")))}getFieldIndexes(e,t){const s=Td(e),o=Lc(e);return(t?s.H(Db,IDBKeyRange.bound(t,t)):s.H()).next((c=>{const u=[];return re.forEach(c,(h=>o.get([h.indexId,this.uid]).next((m=>{u.push((function(b,x){const T=x?new nu(x.sequenceNumber,new oi(ql(x.readTime),new Je(Xi(x.documentKey)),x.largestBatchId)):nu.empty(),N=b.fields.map((([B,P])=>new Cl(bs.fromServerFormat(B),P)));return new tu(b.indexId,b.collectionGroup,N,T)})(h,m))})))).next((()=>u))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((s,o)=>{const c=s.indexState.sequenceNumber-o.indexState.sequenceNumber;return c!==0?c:Ht(s.collectionGroup,o.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,s){const o=Td(e),c=Lc(e);return this.Wn(e).next((u=>o.H(Db,IDBKeyRange.bound(t,t)).next((h=>re.forEach(h,(m=>c.put(V2(m.indexId,this.uid,u,s))))))))}updateIndexEntries(e,t){const s=new Map;return re.forEach(t,((o,c)=>{const u=s.get(o.collectionGroup);return(u?re.resolve(u):this.getFieldIndexes(e,o.collectionGroup)).next((h=>(s.set(o.collectionGroup,h),re.forEach(h,(m=>this.Qn(e,o,m).next((g=>{const b=this.Gn(c,m);return g.isEqual(b)?re.resolve():this.zn(e,c,m,g,b)})))))))}))}jn(e,t,s,o){return Mc(e).put(o.Rn(this.uid,this.Kn(s,t.key),t.key))}Hn(e,t,s,o){return Mc(e).delete(o.An(this.uid,this.Kn(s,t.key),t.key))}Qn(e,t,s){const o=Mc(e);let c=new Qn(bo);return o.ee({index:NE,range:IDBKeyRange.only([s.indexId,this.uid,_m(this.Kn(s,t))])},((u,h)=>{c=c.add(new Sl(s.indexId,t,z2(h.arrayValue),z2(h.directionalValue)))})).next((()=>c))}Gn(e,t){let s=new Qn(bo);const o=this.kn(t,e);if(o==null)return s;const c=Rb(t);if(c!=null){const u=e.data.field(c.fieldPath);if(oh(u))for(const h of u.arrayValue.values||[])s=s.add(new Sl(t.indexId,e.key,this.Nn(h),o))}else s=s.add(new Sl(t.indexId,e.key,Qf,o));return s}zn(e,t,s,o,c){Ve($2,"Updating index entries for document '%s'",t.key);const u=[];return(function(m,g,b,x,T){const N=m.getIterator(),B=g.getIterator();let P=Dc(N),M=Dc(B);for(;P||M;){let Y=!1,H=!1;if(P&&M){const X=b(P,M);X<0?H=!0:X>0&&(Y=!0)}else P!=null?H=!0:Y=!0;Y?(x(M),M=Dc(B)):H?(T(P),P=Dc(N)):(P=Dc(N),M=Dc(B))}})(o,c,bo,(h=>{u.push(this.jn(e,t,s,h))}),(h=>{u.push(this.Hn(e,t,s,h))})),re.waitFor(u)}Wn(e){let t=1;return Lc(e).ee({index:jE,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((s,o,c)=>{c.done(),t=o.sequenceNumber+1})).next((()=>t))}createRange(e,t,s){s=s.sort(((u,h)=>bo(u,h))).filter(((u,h,m)=>!h||bo(u,m[h-1])!==0));const o=[];o.push(e);for(const u of s){const h=bo(u,e),m=bo(u,t);if(h===0)o[0]=e.En();else if(h>0&&m<0)o.push(u),o.push(u.En());else if(m>0)break}o.push(t);const c=[];for(let u=0;u<o.length;u+=2){if(this.Jn(o[u],o[u+1]))return[];const h=o[u].An(this.uid,Qf,Je.empty()),m=o[u+1].An(this.uid,Qf,Je.empty());c.push(IDBKeyRange.bound(h,m))}return c}Jn(e,t){return bo(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(G2)}getMinOffset(e,t){return re.mapArray(this.vn(t),(s=>this.Fn(e,s).next((o=>o||dt(44426))))).next(G2)}}function W2(n){return Zs(n,sh)}function Mc(n){return Zs(n,zd)}function Td(n){return Zs(n,Rv)}function Lc(n){return Zs(n,Fd)}function G2(n){gt(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let s=1;s<n.length;s++){const o=n[s].indexState.offset;Nv(o,e)<0&&(e=o),t<o.largestBatchId&&(t=o.largestBatchId)}return new oi(e.readTime,e.documentKey,t)}const K2={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},VS=41943040;class wr{static withCacheSize(e){return new wr(e,wr.DEFAULT_COLLECTION_PERCENTILE,wr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}}function OS(n,e,t){const s=n.store(Pi),o=n.store(su),c=[],u=IDBKeyRange.only(t.batchId);let h=0;const m=s.ee({range:u},((b,x,T)=>(h++,T.delete())));c.push(m.next((()=>{gt(h===1,47070,{batchId:t.batchId})})));const g=[];for(const b of t.mutations){const x=kE(e,b.key.path,t.batchId);c.push(o.delete(x)),g.push(b.key)}return re.waitFor(c).next((()=>g))}function qm(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw dt(14731);e=n.noDocument}return JSON.stringify(e).length}wr.DEFAULT_COLLECTION_PERCENTILE=10,wr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,wr.DEFAULT=new wr(VS,wr.DEFAULT_COLLECTION_PERCENTILE,wr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),wr.DISABLED=new wr(-1,0,0);class xp{constructor(e,t,s,o){this.userId=e,this.serializer=t,this.indexManager=s,this.referenceDelegate=o,this.Zn={}}static wt(e,t,s,o){gt(e.uid!=="",64387);const c=e.isAuthenticated()?e.uid:"";return new xp(c,t,s,o)}checkEmpty(e){let t=!0;const s=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return vo(e).ee({index:jl,range:s},((o,c,u)=>{t=!1,u.done()})).next((()=>t))}addMutationBatch(e,t,s,o){const c=$c(e),u=vo(e);return u.add({}).next((h=>{gt(typeof h=="number",49019);const m=new Fv(h,t,s,o),g=(function(N,B,P){const M=P.baseMutations.map((H=>uh(N.yt,H))),Y=P.mutations.map((H=>uh(N.yt,H)));return{userId:B,batchId:P.batchId,localWriteTimeMs:P.localWriteTime.toMillis(),baseMutations:M,mutations:Y}})(this.serializer,this.userId,m),b=[];let x=new Qn(((T,N)=>Ht(T.canonicalString(),N.canonicalString())));for(const T of o){const N=kE(this.userId,T.key.path,h);x=x.add(T.key.path.popLast()),b.push(u.put(g)),b.push(c.put(N,GP))}return x.forEach((T=>{b.push(this.indexManager.addToCollectionParentIndex(e,T))})),e.addOnCommittedListener((()=>{this.Zn[h]=m.keys()})),re.waitFor(b).next((()=>m))}))}lookupMutationBatch(e,t){return vo(e).get(t).next((s=>s?(gt(s.userId===this.userId,48,"Unexpected user for mutation batch",{userId:s.userId,batchId:t}),kl(this.serializer,s)):null))}Xn(e,t){return this.Zn[t]?re.resolve(this.Zn[t]):this.lookupMutationBatch(e,t).next((s=>{if(s){const o=s.keys();return this.Zn[t]=o,o}return null}))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,o=IDBKeyRange.lowerBound([this.userId,s]);let c=null;return vo(e).ee({index:jl,range:o},((u,h,m)=>{h.userId===this.userId&&(gt(h.batchId>=s,47524,{Yn:s}),c=kl(this.serializer,h)),m.done()})).next((()=>c))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let s=Oo;return vo(e).ee({index:jl,range:t,reverse:!0},((o,c,u)=>{s=c.batchId,u.done()})).next((()=>s))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Oo],[this.userId,Number.POSITIVE_INFINITY]);return vo(e).H(jl,t).next((s=>s.map((o=>kl(this.serializer,o)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const s=mm(this.userId,t.path),o=IDBKeyRange.lowerBound(s),c=[];return $c(e).ee({range:o},((u,h,m)=>{const[g,b,x]=u,T=Xi(b);if(g===this.userId&&t.path.isEqual(T))return vo(e).get(x).next((N=>{if(!N)throw dt(61480,{er:u,batchId:x});gt(N.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:N.userId,batchId:x}),c.push(kl(this.serializer,N))}));m.done()})).next((()=>c))}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new Qn(Ht);const o=[];return t.forEach((c=>{const u=mm(this.userId,c.path),h=IDBKeyRange.lowerBound(u),m=$c(e).ee({range:h},((g,b,x)=>{const[T,N,B]=g,P=Xi(N);T===this.userId&&c.path.isEqual(P)?s=s.add(B):x.done()}));o.push(m)})),re.waitFor(o).next((()=>this.tr(e,s)))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,o=s.length+1,c=mm(this.userId,s),u=IDBKeyRange.lowerBound(c);let h=new Qn(Ht);return $c(e).ee({range:u},((m,g,b)=>{const[x,T,N]=m,B=Xi(T);x===this.userId&&s.isPrefixOf(B)?B.length===o&&(h=h.add(N)):b.done()})).next((()=>this.tr(e,h)))}tr(e,t){const s=[],o=[];return t.forEach((c=>{o.push(vo(e).get(c).next((u=>{if(u===null)throw dt(35274,{batchId:c});gt(u.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:u.userId,batchId:c}),s.push(kl(this.serializer,u))})))})),re.waitFor(o).next((()=>s))}removeMutationBatch(e,t){return OS(e.le,this.userId,t).next((s=>(e.addOnCommittedListener((()=>{this.nr(t.batchId)})),re.forEach(s,(o=>this.referenceDelegate.markPotentiallyOrphaned(e,o))))))}nr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return re.resolve();const s=IDBKeyRange.lowerBound((function(u){return[u]})(this.userId)),o=[];return $c(e).ee({range:s},((c,u,h)=>{if(c[0]===this.userId){const m=Xi(c[1]);o.push(m)}else h.done()})).next((()=>{gt(o.length===0,56720,{rr:o.map((c=>c.canonicalString()))})}))}))}containsKey(e,t){return BS(e,this.userId,t)}ir(e){return US(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Oo,lastStreamToken:""}))}}function BS(n,e,t){const s=mm(e,t.path),o=s[1],c=IDBKeyRange.lowerBound(s);let u=!1;return $c(n).ee({range:c,Y:!0},((h,m,g)=>{const[b,x,T]=h;b===e&&x===o&&(u=!0),g.done()})).next((()=>u))}function vo(n){return Zs(n,Pi)}function $c(n){return Zs(n,su)}function US(n){return Zs(n,th)}class Hl{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Hl(0)}static ar(){return new Hl(-1)}}class b3{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.ur(e).next((t=>{const s=new Hl(t.highestTargetId);return t.highestTargetId=s.next(),this.cr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.ur(e).next((t=>Et.fromTimestamp(new pt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.ur(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,s){return this.ur(e).next((o=>(o.highestListenSequenceNumber=t,s&&(o.lastRemoteSnapshotVersion=s.toTimestamp()),t>o.highestListenSequenceNumber&&(o.highestListenSequenceNumber=t),this.cr(e,o))))}addTargetData(e,t){return this.lr(e,t).next((()=>this.ur(e).next((s=>(s.targetCount+=1,this.hr(t,s),this.cr(e,s))))))}updateTargetData(e,t){return this.lr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Vc(e).delete(t.targetId))).next((()=>this.ur(e))).next((s=>(gt(s.targetCount>0,8065),s.targetCount-=1,this.cr(e,s))))}removeTargets(e,t,s){let o=0;const c=[];return Vc(e).ee(((u,h)=>{const m=Ld(h);m.sequenceNumber<=t&&s.get(m.targetId)===null&&(o++,c.push(this.removeTargetData(e,m)))})).next((()=>re.waitFor(c))).next((()=>o))}forEachTarget(e,t){return Vc(e).ee(((s,o)=>{const c=Ld(o);t(c)}))}ur(e){return Q2(e).get(Vm).next((t=>(gt(t!==null,2888),t)))}cr(e,t){return Q2(e).put(Vm,t)}lr(e,t){return Vc(e).put(PS(this.serializer,t))}hr(e,t){let s=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,s=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,s=!0),s}getTargetCount(e){return this.ur(e).next((t=>t.targetCount))}getTargetData(e,t){const s=Bl(t),o=IDBKeyRange.bound([s,Number.NEGATIVE_INFINITY],[s,Number.POSITIVE_INFINITY]);let c=null;return Vc(e).ee({range:o,index:SE},((u,h,m)=>{const g=Ld(h);Th(t,g.target)&&(c=g,m.done())})).next((()=>c))}addMatchingKeys(e,t,s){const o=[],c=No(e);return t.forEach((u=>{const h=Tr(u.path);o.push(c.put({targetId:s,path:h})),o.push(this.referenceDelegate.addReference(e,s,u))})),re.waitFor(o)}removeMatchingKeys(e,t,s){const o=No(e);return re.forEach(t,(c=>{const u=Tr(c.path);return re.waitFor([o.delete([s,u]),this.referenceDelegate.removeReference(e,s,c)])}))}removeMatchingKeysForTargetId(e,t){const s=No(e),o=IDBKeyRange.bound([t],[t+1],!1,!0);return s.delete(o)}getMatchingKeysForTargetId(e,t){const s=IDBKeyRange.bound([t],[t+1],!1,!0),o=No(e);let c=tn();return o.ee({range:s,Y:!0},((u,h,m)=>{const g=Xi(u[1]),b=new Je(g);c=c.add(b)})).next((()=>c))}containsKey(e,t){const s=Tr(t.path),o=IDBKeyRange.bound([s],[pE(s)],!1,!0);let c=0;return No(e).ee({index:Av,Y:!0,range:o},(([u,h],m,g)=>{u!==0&&(c++,g.done())})).next((()=>c>0))}At(e,t){return Vc(e).get(t).next((s=>s?Ld(s):null))}}function Vc(n){return Zs(n,ru)}function Q2(n){return Zs(n,Al)}function No(n){return Zs(n,iu)}const Y2="LruGarbageCollector",FS=1048576;function X2([n,e],[t,s]){const o=Ht(n,t);return o===0?Ht(e,s):o}class v3{constructor(e){this.Pr=e,this.buffer=new Qn(X2),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();X2(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class zS{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){Ve(Y2,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Qo(t)?Ve(Y2,"Ignoring IndexedDB error during garbage collection: ",t):await Ko(t)}await this.Ar(3e5)}))}}class x3{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((s=>Math.floor(t/100*s)))}nthSequenceNumber(e,t){if(t===0)return re.resolve(qr.ce);const s=new v3(t);return this.Vr.forEachTarget(e,(o=>s.Er(o.sequenceNumber))).next((()=>this.Vr.mr(e,(o=>s.Er(o))))).next((()=>s.maxValue))}removeTargets(e,t,s){return this.Vr.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Ve("LruGarbageCollector","Garbage collection skipped; disabled"),re.resolve(K2)):this.getCacheSize(e).next((s=>s<this.params.cacheSizeCollectionThreshold?(Ve("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),K2):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let s,o,c,u,h,m,g;const b=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((x=>(x>this.params.maximumSequenceNumbersToCollect?(Ve("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${x}`),o=this.params.maximumSequenceNumbersToCollect):o=x,u=Date.now(),this.nthSequenceNumber(e,o)))).next((x=>(s=x,h=Date.now(),this.removeTargets(e,s,t)))).next((x=>(c=x,m=Date.now(),this.removeOrphanedDocuments(e,s)))).next((x=>(g=Date.now(),zc()<=wn.DEBUG&&Ve("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-b}ms
	Determined least recently used ${o} in `+(h-u)+`ms
	Removed ${c} targets in `+(m-h)+`ms
	Removed ${x} documents in `+(g-m)+`ms
Total Duration: ${g-b}ms`),re.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:c,documentsRemoved:x}))))}}function qS(n,e){return new x3(n,e)}class _3{constructor(e,t){this.db=e,this.garbageCollector=qS(this,t)}dr(e){const t=this.pr(e);return this.db.getTargetCache().getTargetCount(e).next((s=>t.next((o=>s+o))))}pr(e){let t=0;return this.mr(e,(s=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}mr(e,t){return this.yr(e,((s,o)=>t(o)))}addReference(e,t,s){return Yf(e,s)}removeReference(e,t,s){return Yf(e,s)}removeTargets(e,t,s){return this.db.getTargetCache().removeTargets(e,t,s)}markPotentiallyOrphaned(e,t){return Yf(e,t)}wr(e,t){return(function(o,c){let u=!1;return US(o).te((h=>BS(o,h,c).next((m=>(m&&(u=!0),re.resolve(!m)))))).next((()=>u))})(e,t)}removeOrphanedDocuments(e,t){const s=this.db.getRemoteDocumentCache().newChangeBuffer(),o=[];let c=0;return this.yr(e,((u,h)=>{if(h<=t){const m=this.wr(e,u).next((g=>{if(!g)return c++,s.getEntry(e,u).next((()=>(s.removeEntry(u,Et.min()),No(e).delete((function(x){return[0,Tr(x.path)]})(u)))))}));o.push(m)}})).next((()=>re.waitFor(o))).next((()=>s.apply(e))).next((()=>c))}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,s)}updateLimboDocument(e,t){return Yf(e,t)}yr(e,t){const s=No(e);let o,c=qr.ce;return s.ee({index:Av},(([u,h],{path:m,sequenceNumber:g})=>{u===0?(c!==qr.ce&&t(new Je(Xi(o)),c),c=g,o=m):c=qr.ce})).next((()=>{c!==qr.ce&&t(new Je(Xi(o)),c)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Yf(n,e){return No(n).put((function(s,o){return{targetId:0,path:Tr(s.path),sequenceNumber:o}})(e,n.currentSequenceNumber))}class HS{constructor(){this.changes=new qa((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,hs.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?re.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class w3{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,s){return gl(e).put(s)}removeEntry(e,t,s){return gl(e).delete((function(c,u){const h=c.path.toArray();return[h.slice(0,h.length-2),h[h.length-2],Fm(u),h[h.length-1]]})(t,s))}updateMetadata(e,t){return this.getMetadata(e).next((s=>(s.byteSize+=t,this.br(e,s))))}getEntry(e,t){let s=hs.newInvalidDocument(t);return gl(e).ee({index:pm,range:IDBKeyRange.only(kd(t))},((o,c)=>{s=this.Sr(t,c)})).next((()=>s))}Dr(e,t){let s={size:0,document:hs.newInvalidDocument(t)};return gl(e).ee({index:pm,range:IDBKeyRange.only(kd(t))},((o,c)=>{s={document:this.Sr(t,c),size:qm(c)}})).next((()=>s))}getEntries(e,t){let s=$r();return this.Cr(e,t,((o,c)=>{const u=this.Sr(o,c);s=s.insert(o,u)})).next((()=>s))}vr(e,t){let s=$r(),o=new os(Je.comparator);return this.Cr(e,t,((c,u)=>{const h=this.Sr(c,u);s=s.insert(c,h),o=o.insert(c,qm(u))})).next((()=>({documents:s,Fr:o})))}Cr(e,t,s){if(t.isEmpty())return re.resolve();let o=new Qn(eT);t.forEach((m=>o=o.add(m)));const c=IDBKeyRange.bound(kd(o.first()),kd(o.last())),u=o.getIterator();let h=u.getNext();return gl(e).ee({index:pm,range:c},((m,g,b)=>{const x=Je.fromSegments([...g.prefixPath,g.collectionGroup,g.documentId]);for(;h&&eT(h,x)<0;)s(h,null),h=u.getNext();h&&h.isEqual(x)&&(s(h,g),h=u.hasNext()?u.getNext():null),h?b.j(kd(h)):b.done()})).next((()=>{for(;h;)s(h,null),h=u.hasNext()?u.getNext():null}))}getDocumentsMatchingQuery(e,t,s,o,c){const u=t.path,h=[u.popLast().toArray(),u.lastSegment(),Fm(s.readTime),s.documentKey.path.isEmpty()?"":s.documentKey.path.lastSegment()],m=[u.popLast().toArray(),u.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return gl(e).H(IDBKeyRange.bound(h,m,!0)).next((g=>{c?.incrementDocumentReadCount(g.length);let b=$r();for(const x of g){const T=this.Sr(Je.fromSegments(x.prefixPath.concat(x.collectionGroup,x.documentId)),x);T.isFoundDocument()&&(Eh(t,T)||o.has(T.key))&&(b=b.insert(T.key,T))}return b}))}getAllFromCollectionGroup(e,t,s,o){let c=$r();const u=Z2(t,s),h=Z2(t,oi.max());return gl(e).ee({index:EE,range:IDBKeyRange.bound(u,h,!0)},((m,g,b)=>{const x=this.Sr(Je.fromSegments(g.prefixPath.concat(g.collectionGroup,g.documentId)),g);c=c.insert(x.key,x),c.size===o&&b.done()})).next((()=>c))}newChangeBuffer(e){return new T3(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return J2(e).get(Ib).next((t=>(gt(!!t,20021),t)))}br(e,t){return J2(e).put(Ib,t)}Sr(e,t){if(t){const s=l3(this.serializer,t);if(!(s.isNoDocument()&&s.version.isEqual(Et.min())))return s}return hs.newInvalidDocument(e)}}function $S(n){return new w3(n)}class T3 extends HS{constructor(e,t){super(),this.Mr=e,this.trackRemovals=t,this.Or=new qa((s=>s.toString()),((s,o)=>s.isEqual(o)))}applyChanges(e){const t=[];let s=0,o=new Qn(((c,u)=>Ht(c.canonicalString(),u.canonicalString())));return this.changes.forEach(((c,u)=>{const h=this.Or.get(c);if(t.push(this.Mr.removeEntry(e,c,h.readTime)),u.isValidDocument()){const m=M2(this.Mr.serializer,u);o=o.add(c.path.popLast());const g=qm(m);s+=g-h.size,t.push(this.Mr.addEntry(e,c,m))}else if(s-=h.size,this.trackRemovals){const m=M2(this.Mr.serializer,u.convertToNoDocument(Et.min()));t.push(this.Mr.addEntry(e,c,m))}})),o.forEach((c=>{t.push(this.Mr.indexManager.addToCollectionParentIndex(e,c))})),t.push(this.Mr.updateMetadata(e,s)),re.waitFor(t)}getFromCache(e,t){return this.Mr.Dr(e,t).next((s=>(this.Or.set(t,{size:s.size,readTime:s.document.readTime}),s.document)))}getAllFromCache(e,t){return this.Mr.vr(e,t).next((({documents:s,Fr:o})=>(o.forEach(((c,u)=>{this.Or.set(c,{size:u,readTime:s.get(c).readTime})})),s)))}}function J2(n){return Zs(n,nh)}function gl(n){return Zs(n,Lm)}function kd(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Z2(n,e){const t=e.documentKey.path.toArray();return[n,Fm(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function eT(n,e){const t=n.path.toArray(),s=e.path.toArray();let o=0;for(let c=0;c<t.length-2&&c<s.length-2;++c)if(o=Ht(t[c],s[c]),o)return o;return o=Ht(t.length,s.length),o||(o=Ht(t[t.length-2],s[s.length-2]),o||Ht(t[t.length-1],s[s.length-1]))}class k3{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class WS{constructor(e,t,s,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=o}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next((o=>(s=o,this.remoteDocumentCache.getEntry(e,t)))).next((o=>(s!==null&&$d(s.mutation,o,Hr.empty(),pt.now()),o)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.getLocalViewOfDocuments(e,s,tn()).next((()=>s))))}getLocalViewOfDocuments(e,t,s=tn()){const o=Ji();return this.populateOverlays(e,o,t).next((()=>this.computeViews(e,t,o,s).next((c=>{let u=Pd();return c.forEach(((h,m)=>{u=u.insert(h,m.overlayedDocument)})),u}))))}getOverlayedDocuments(e,t){const s=Ji();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,tn())))}populateOverlays(e,t,s){const o=[];return s.forEach((c=>{t.has(c)||o.push(c)})),this.documentOverlayCache.getOverlays(e,o).next((c=>{c.forEach(((u,h)=>{t.set(u,h)}))}))}computeViews(e,t,s,o){let c=$r();const u=Hd(),h=(function(){return Hd()})();return t.forEach(((m,g)=>{const b=s.get(g.key);o.has(g.key)&&(b===void 0||b.mutation instanceof Ha)?c=c.insert(g.key,g):b!==void 0?(u.set(g.key,b.mutation.getFieldMask()),$d(b.mutation,g,b.mutation.getFieldMask(),pt.now())):u.set(g.key,Hr.empty())})),this.recalculateAndSaveOverlays(e,c).next((m=>(m.forEach(((g,b)=>u.set(g,b))),t.forEach(((g,b)=>h.set(g,new k3(b,u.get(g)??null)))),h)))}recalculateAndSaveOverlays(e,t){const s=Hd();let o=new os(((u,h)=>u-h)),c=tn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((u=>{for(const h of u)h.keys().forEach((m=>{const g=t.get(m);if(g===null)return;let b=s.get(m)||Hr.empty();b=h.applyToLocalView(g,b),s.set(m,b);const x=(o.get(h.batchId)||tn()).add(m);o=o.insert(h.batchId,x)}))})).next((()=>{const u=[],h=o.getReverseIterator();for(;h.hasNext();){const m=h.getNext(),g=m.key,b=m.value,x=aS();b.forEach((T=>{if(!c.has(T)){const N=fS(t.get(T),s.get(T));N!==null&&x.set(T,N),c=c.add(T)}})),u.push(this.documentOverlayCache.saveOverlays(e,g,x))}return re.waitFor(u)})).next((()=>s))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.recalculateAndSaveOverlays(e,s)))}getDocumentsMatchingQuery(e,t,s,o){return AM(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Vv(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,o):this.getDocumentsMatchingCollectionQuery(e,t,s,o)}getNextDocuments(e,t,s,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,o).next((c=>{const u=o-c.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,o-c.size):re.resolve(Ji());let h=eu,m=c;return u.next((g=>re.forEach(g,((b,x)=>(h<x.largestBatchId&&(h=x.largestBatchId),c.get(b)?re.resolve():this.remoteDocumentCache.getEntry(e,b).next((T=>{m=m.insert(b,T)}))))).next((()=>this.populateOverlays(e,g,c))).next((()=>this.computeViews(e,m,g,tn()))).next((b=>({batchId:h,changes:iS(b)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Je(t)).next((s=>{let o=Pd();return s.isFoundDocument()&&(o=o.insert(s.key,s)),o}))}getDocumentsMatchingCollectionGroupQuery(e,t,s,o){const c=t.collectionGroup;let u=Pd();return this.indexManager.getCollectionParents(e,c).next((h=>re.forEach(h,(m=>{const g=(function(x,T){return new za(T,null,x.explicitOrderBy.slice(),x.filters.slice(),x.limit,x.limitType,x.startAt,x.endAt)})(t,m.child(c));return this.getDocumentsMatchingCollectionQuery(e,g,s,o).next((b=>{b.forEach(((x,T)=>{u=u.insert(x,T)}))}))})).next((()=>u))))}getDocumentsMatchingCollectionQuery(e,t,s,o){let c;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next((u=>(c=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,c,o)))).next((u=>{c.forEach(((m,g)=>{const b=g.getKey();u.get(b)===null&&(u=u.insert(b,hs.newInvalidDocument(b)))}));let h=Pd();return u.forEach(((m,g)=>{const b=c.get(m);b!==void 0&&$d(b.mutation,g,Hr.empty(),pt.now()),Eh(t,g)&&(h=h.insert(m,g))})),h}))}}class E3{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return re.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(o){return{id:o.id,version:o.version,createTime:Os(o.createTime)}})(t)),re.resolve()}getNamedQuery(e,t){return re.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(o){return{name:o.name,query:bp(o.bundledQuery),readTime:Os(o.readTime)}})(t)),re.resolve()}}class S3{constructor(){this.overlays=new os(Je.comparator),this.Lr=new Map}getOverlay(e,t){return re.resolve(this.overlays.get(t))}getOverlays(e,t){const s=Ji();return re.forEach(t,(o=>this.getOverlay(e,o).next((c=>{c!==null&&s.set(o,c)})))).next((()=>s))}saveOverlays(e,t,s){return s.forEach(((o,c)=>{this.bt(e,t,c)})),re.resolve()}removeOverlaysForBatchId(e,t,s){const o=this.Lr.get(s);return o!==void 0&&(o.forEach((c=>this.overlays=this.overlays.remove(c))),this.Lr.delete(s)),re.resolve()}getOverlaysForCollection(e,t,s){const o=Ji(),c=t.length+1,u=new Je(t.child("")),h=this.overlays.getIteratorFrom(u);for(;h.hasNext();){const m=h.getNext().value,g=m.getKey();if(!t.isPrefixOf(g.path))break;g.path.length===c&&m.largestBatchId>s&&o.set(m.getKey(),m)}return re.resolve(o)}getOverlaysForCollectionGroup(e,t,s,o){let c=new os(((g,b)=>g-b));const u=this.overlays.getIterator();for(;u.hasNext();){const g=u.getNext().value;if(g.getKey().getCollectionGroup()===t&&g.largestBatchId>s){let b=c.get(g.largestBatchId);b===null&&(b=Ji(),c=c.insert(g.largestBatchId,b)),b.set(g.getKey(),g)}}const h=Ji(),m=c.getIterator();for(;m.hasNext()&&(m.getNext().value.forEach(((g,b)=>h.set(g,b))),!(h.size()>=o)););return re.resolve(h)}bt(e,t,s){const o=this.overlays.get(s.key);if(o!==null){const u=this.Lr.get(o.largestBatchId).delete(s.key);this.Lr.set(o.largestBatchId,u)}this.overlays=this.overlays.insert(s.key,new qv(t,s));let c=this.Lr.get(t);c===void 0&&(c=tn(),this.Lr.set(t,c)),this.Lr.set(t,c.add(s.key))}}class j3{constructor(){this.sessionToken=As.EMPTY_BYTE_STRING}getSessionToken(e){return re.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,re.resolve()}}class Kv{constructor(){this.kr=new Qn(sr.Kr),this.qr=new Qn(sr.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const s=new sr(e,t);this.kr=this.kr.add(s),this.qr=this.qr.add(s)}$r(e,t){e.forEach((s=>this.addReference(s,t)))}removeReference(e,t){this.Wr(new sr(e,t))}Qr(e,t){e.forEach((s=>this.removeReference(s,t)))}Gr(e){const t=new Je(new fn([])),s=new sr(t,e),o=new sr(t,e+1),c=[];return this.qr.forEachInRange([s,o],(u=>{this.Wr(u),c.push(u.key)})),c}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new Je(new fn([])),s=new sr(t,e),o=new sr(t,e+1);let c=tn();return this.qr.forEachInRange([s,o],(u=>{c=c.add(u.key)})),c}containsKey(e){const t=new sr(e,0),s=this.kr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class sr{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return Je.comparator(e.key,t.key)||Ht(e.Hr,t.Hr)}static Ur(e,t){return Ht(e.Hr,t.Hr)||Je.comparator(e.key,t.key)}}class N3{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Qn(sr.Kr)}checkEmpty(e){return re.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,o){const c=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new Fv(c,t,s,o);this.mutationQueue.push(u);for(const h of o)this.Jr=this.Jr.add(new sr(h.key,c)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return re.resolve(u)}lookupMutationBatch(e,t){return re.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,o=this.Xr(s),c=o<0?0:o;return re.resolve(this.mutationQueue.length>c?this.mutationQueue[c]:null)}getHighestUnacknowledgedBatchId(){return re.resolve(this.mutationQueue.length===0?Oo:this.Yn-1)}getAllMutationBatches(e){return re.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new sr(t,0),o=new sr(t,Number.POSITIVE_INFINITY),c=[];return this.Jr.forEachInRange([s,o],(u=>{const h=this.Zr(u.Hr);c.push(h)})),re.resolve(c)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new Qn(Ht);return t.forEach((o=>{const c=new sr(o,0),u=new sr(o,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([c,u],(h=>{s=s.add(h.Hr)}))})),re.resolve(this.Yr(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,o=s.length+1;let c=s;Je.isDocumentKey(c)||(c=c.child(""));const u=new sr(new Je(c),0);let h=new Qn(Ht);return this.Jr.forEachWhile((m=>{const g=m.key.path;return!!s.isPrefixOf(g)&&(g.length===o&&(h=h.add(m.Hr)),!0)}),u),re.resolve(this.Yr(h))}Yr(e){const t=[];return e.forEach((s=>{const o=this.Zr(s);o!==null&&t.push(o)})),t}removeMutationBatch(e,t){gt(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Jr;return re.forEach(t.mutations,(o=>{const c=new sr(o.key,t.batchId);return s=s.delete(c),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)})).next((()=>{this.Jr=s}))}nr(e){}containsKey(e,t){const s=new sr(t,0),o=this.Jr.firstAfterOrEqual(s);return re.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,re.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class C3{constructor(e){this.ti=e,this.docs=(function(){return new os(Je.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,o=this.docs.get(s),c=o?o.size:0,u=this.ti(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:u}),this.size+=u-c,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return re.resolve(s?s.document.mutableCopy():hs.newInvalidDocument(t))}getEntries(e,t){let s=$r();return t.forEach((o=>{const c=this.docs.get(o);s=s.insert(o,c?c.document.mutableCopy():hs.newInvalidDocument(o))})),re.resolve(s)}getDocumentsMatchingQuery(e,t,s,o){let c=$r();const u=t.path,h=new Je(u.child("__id-9223372036854775808__")),m=this.docs.getIteratorFrom(h);for(;m.hasNext();){const{key:g,value:{document:b}}=m.getNext();if(!u.isPrefixOf(g.path))break;g.path.length>u.length+1||Nv(vE(b),s)<=0||(o.has(b.key)||Eh(t,b))&&(c=c.insert(b.key,b.mutableCopy()))}return re.resolve(c)}getAllFromCollectionGroup(e,t,s,o){dt(9500)}ni(e,t){return re.forEach(this.docs,(s=>t(s)))}newChangeBuffer(e){return new A3(this)}getSize(e){return re.resolve(this.size)}}class A3 extends HS{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((s,o)=>{o.isValidDocument()?t.push(this.Mr.addEntry(e,o)):this.Mr.removeEntry(s)})),re.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class R3{constructor(e){this.persistence=e,this.ri=new qa((t=>Bl(t)),Th),this.lastRemoteSnapshotVersion=Et.min(),this.highestTargetId=0,this.ii=0,this.si=new Kv,this.targetCount=0,this.oi=Hl._r()}forEachTarget(e,t){return this.ri.forEach(((s,o)=>t(o))),re.resolve()}getLastRemoteSnapshotVersion(e){return re.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return re.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),re.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.ii&&(this.ii=t),re.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new Hl(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,re.resolve()}updateTargetData(e,t){return this.lr(t),re.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,re.resolve()}removeTargets(e,t,s){let o=0;const c=[];return this.ri.forEach(((u,h)=>{h.sequenceNumber<=t&&s.get(h.targetId)===null&&(this.ri.delete(u),c.push(this.removeMatchingKeysForTargetId(e,h.targetId)),o++)})),re.waitFor(c).next((()=>o))}getTargetCount(e){return re.resolve(this.targetCount)}getTargetData(e,t){const s=this.ri.get(t)||null;return re.resolve(s)}addMatchingKeys(e,t,s){return this.si.$r(t,s),re.resolve()}removeMatchingKeys(e,t,s){this.si.Qr(t,s);const o=this.persistence.referenceDelegate,c=[];return o&&t.forEach((u=>{c.push(o.markPotentiallyOrphaned(e,u))})),re.waitFor(c)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),re.resolve()}getMatchingKeysForTargetId(e,t){const s=this.si.jr(t);return re.resolve(s)}containsKey(e,t){return re.resolve(this.si.containsKey(t))}}class Qv{constructor(e,t){this._i={},this.overlays={},this.ai=new qr(0),this.ui=!1,this.ui=!0,this.ci=new j3,this.referenceDelegate=e(this),this.li=new R3(this),this.indexManager=new g3,this.remoteDocumentCache=(function(o){return new C3(o)})((s=>this.referenceDelegate.hi(s))),this.serializer=new DS(t),this.Pi=new E3(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new S3,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this._i[e.toKey()];return s||(s=new N3(t,this.referenceDelegate),this._i[e.toKey()]=s),s}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,s){Ve("MemoryPersistence","Starting transaction:",e);const o=new I3(this.ai.next());return this.referenceDelegate.Ti(),s(o).next((c=>this.referenceDelegate.Ii(o).next((()=>c)))).toPromise().then((c=>(o.raiseOnCommittedEvent(),c)))}Ei(e,t){return re.or(Object.values(this._i).map((s=>()=>s.containsKey(e,t))))}}class I3 extends _E{constructor(e){super(),this.currentSequenceNumber=e}}class _p{constructor(e){this.persistence=e,this.Ri=new Kv,this.Ai=null}static Vi(e){return new _p(e)}get di(){if(this.Ai)return this.Ai;throw dt(60996)}addReference(e,t,s){return this.Ri.addReference(s,t),this.di.delete(s.toString()),re.resolve()}removeReference(e,t,s){return this.Ri.removeReference(s,t),this.di.add(s.toString()),re.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),re.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((o=>this.di.add(o.toString())));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next((o=>{o.forEach((c=>this.di.add(c.toString())))})).next((()=>s.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return re.forEach(this.di,(s=>{const o=Je.fromPath(s);return this.mi(e,o).next((c=>{c||t.removeEntry(o,Et.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((s=>{s?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return re.or([()=>re.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Hm{constructor(e,t){this.persistence=e,this.fi=new qa((s=>Tr(s.path)),((s,o)=>s.isEqual(o))),this.garbageCollector=qS(this,t)}static Vi(e,t){return new Hm(e,t)}Ti(){}Ii(e){return re.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((s=>t.next((o=>s+o))))}pr(e){let t=0;return this.mr(e,(s=>{t++})).next((()=>t))}mr(e,t){return re.forEach(this.fi,((s,o)=>this.wr(e,s,o).next((c=>c?re.resolve():t(o)))))}removeTargets(e,t,s){return this.persistence.getTargetCache().removeTargets(e,t,s)}removeOrphanedDocuments(e,t){let s=0;const o=this.persistence.getRemoteDocumentCache(),c=o.newChangeBuffer();return o.ni(e,(u=>this.wr(e,u,t).next((h=>{h||(s++,c.removeEntry(u,Et.min()))})))).next((()=>c.apply(e))).next((()=>s))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),re.resolve()}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,t,s){return this.fi.set(s,e.currentSequenceNumber),re.resolve()}removeReference(e,t,s){return this.fi.set(s,e.currentSequenceNumber),re.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),re.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=ym(e.data.value)),t}wr(e,t,s){return re.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.fi.get(t);return re.resolve(o!==void 0&&o>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class D3{constructor(e){this.serializer=e}k(e,t,s,o){const c=new op("createOrUpgrade",t);s<1&&o>=1&&((function(m){m.createObjectStore(wh)})(e),(function(m){m.createObjectStore(th,{keyPath:WP}),m.createObjectStore(Pi,{keyPath:d2,autoIncrement:!0}).createIndex(jl,h2,{unique:!0}),m.createObjectStore(su)})(e),tT(e),(function(m){m.createObjectStore(wl)})(e));let u=re.resolve();return s<3&&o>=3&&(s!==0&&((function(m){m.deleteObjectStore(iu),m.deleteObjectStore(ru),m.deleteObjectStore(Al)})(e),tT(e)),u=u.next((()=>(function(m){const g=m.store(Al),b={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Et.min().toTimestamp(),targetCount:0};return g.put(Vm,b)})(c)))),s<4&&o>=4&&(s!==0&&(u=u.next((()=>(function(m,g){return g.store(Pi).H().next((x=>{m.deleteObjectStore(Pi),m.createObjectStore(Pi,{keyPath:d2,autoIncrement:!0}).createIndex(jl,h2,{unique:!0});const T=g.store(Pi),N=x.map((B=>T.put(B)));return re.waitFor(N)}))})(e,c)))),u=u.next((()=>{(function(m){m.createObjectStore(au,{keyPath:tM})})(e)}))),s<5&&o>=5&&(u=u.next((()=>this.gi(c)))),s<6&&o>=6&&(u=u.next((()=>((function(m){m.createObjectStore(nh)})(e),this.pi(c))))),s<7&&o>=7&&(u=u.next((()=>this.yi(c)))),s<8&&o>=8&&(u=u.next((()=>this.wi(e,c)))),s<9&&o>=9&&(u=u.next((()=>{(function(m){m.objectStoreNames.contains("remoteDocumentChanges")&&m.deleteObjectStore("remoteDocumentChanges")})(e)}))),s<10&&o>=10&&(u=u.next((()=>this.bi(c)))),s<11&&o>=11&&(u=u.next((()=>{(function(m){m.createObjectStore(lp,{keyPath:nM})})(e),(function(m){m.createObjectStore(cp,{keyPath:sM})})(e)}))),s<12&&o>=12&&(u=u.next((()=>{(function(m){const g=m.createObjectStore(up,{keyPath:uM});g.createIndex(Pb,dM,{unique:!1}),g.createIndex(CE,hM,{unique:!1})})(e)}))),s<13&&o>=13&&(u=u.next((()=>(function(m){const g=m.createObjectStore(Lm,{keyPath:KP});g.createIndex(pm,QP),g.createIndex(EE,YP)})(e))).next((()=>this.Si(e,c))).next((()=>e.deleteObjectStore(wl)))),s<14&&o>=14&&(u=u.next((()=>this.Di(e,c)))),s<15&&o>=15&&(u=u.next((()=>(function(m){m.createObjectStore(Rv,{keyPath:rM,autoIncrement:!0}).createIndex(Db,iM,{unique:!1}),m.createObjectStore(Fd,{keyPath:aM}).createIndex(jE,oM,{unique:!1}),m.createObjectStore(zd,{keyPath:lM}).createIndex(NE,cM,{unique:!1})})(e)))),s<16&&o>=16&&(u=u.next((()=>{t.objectStore(Fd).clear()})).next((()=>{t.objectStore(zd).clear()}))),s<17&&o>=17&&(u=u.next((()=>{(function(m){m.createObjectStore(Iv,{keyPath:fM})})(e)}))),s<18&&o>=18&&xk()&&(u=u.next((()=>{t.objectStore(Fd).clear()})).next((()=>{t.objectStore(zd).clear()}))),u}pi(e){let t=0;return e.store(wl).ee(((s,o)=>{t+=qm(o)})).next((()=>{const s={byteSize:t};return e.store(nh).put(Ib,s)}))}gi(e){const t=e.store(th),s=e.store(Pi);return t.H().next((o=>re.forEach(o,(c=>{const u=IDBKeyRange.bound([c.userId,Oo],[c.userId,c.lastAcknowledgedBatchId]);return s.H(jl,u).next((h=>re.forEach(h,(m=>{gt(m.userId===c.userId,18650,"Cannot process batch from unexpected user",{batchId:m.batchId});const g=kl(this.serializer,m);return OS(e,c.userId,g).next((()=>{}))}))))}))))}yi(e){const t=e.store(iu),s=e.store(wl);return e.store(Al).get(Vm).next((o=>{const c=[];return s.ee(((u,h)=>{const m=new fn(u),g=(function(x){return[0,Tr(x)]})(m);c.push(t.get(g).next((b=>b?re.resolve():(x=>t.put({targetId:0,path:Tr(x),sequenceNumber:o.highestListenSequenceNumber}))(m))))})).next((()=>re.waitFor(c)))}))}wi(e,t){e.createObjectStore(sh,{keyPath:eM});const s=t.store(sh),o=new Gv,c=u=>{if(o.add(u)){const h=u.lastSegment(),m=u.popLast();return s.put({collectionId:h,parent:Tr(m)})}};return t.store(wl).ee({Y:!0},((u,h)=>{const m=new fn(u);return c(m.popLast())})).next((()=>t.store(su).ee({Y:!0},(([u,h,m],g)=>{const b=Xi(h);return c(b.popLast())}))))}bi(e){const t=e.store(ru);return t.ee(((s,o)=>{const c=Ld(o),u=PS(this.serializer,c);return t.put(u)}))}Si(e,t){const s=t.store(wl),o=[];return s.ee(((c,u)=>{const h=t.store(Lm),m=(function(x){return x.document?new Je(fn.fromString(x.document.name).popFirst(5)):x.noDocument?Je.fromSegments(x.noDocument.path):x.unknownDocument?Je.fromSegments(x.unknownDocument.path):dt(36783)})(u).path.toArray(),g={prefixPath:m.slice(0,m.length-2),collectionGroup:m[m.length-2],documentId:m[m.length-1],readTime:u.readTime||[0,0],unknownDocument:u.unknownDocument,noDocument:u.noDocument,document:u.document,hasCommittedMutations:!!u.hasCommittedMutations};o.push(h.put(g))})).next((()=>re.waitFor(o)))}Di(e,t){const s=t.store(Pi),o=$S(this.serializer),c=new Qv(_p.Vi,this.serializer.yt);return s.H().next((u=>{const h=new Map;return u.forEach((m=>{let g=h.get(m.userId)??tn();kl(this.serializer,m).keys().forEach((b=>g=g.add(b))),h.set(m.userId,g)})),re.forEach(h,((m,g)=>{const b=new rr(g),x=vp.wt(this.serializer,b),T=c.getIndexManager(b),N=xp.wt(b,this.serializer,T,c.referenceDelegate);return new WS(o,N,x,T).recalculateAndSaveOverlaysForDocumentKeys(new Mb(t,qr.ce),m).next()}))}))}}function tT(n){n.createObjectStore(iu,{keyPath:JP}).createIndex(Av,ZP,{unique:!0}),n.createObjectStore(ru,{keyPath:"targetId"}).createIndex(SE,XP,{unique:!0}),n.createObjectStore(Al)}const xo="IndexedDbPersistence",$y=18e5,Wy=5e3,Gy="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",GS="main";class Yv{constructor(e,t,s,o,c,u,h,m,g,b,x=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=s,this.Ci=c,this.window=u,this.document=h,this.Fi=g,this.Mi=b,this.xi=x,this.ai=null,this.ui=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Oi=null,this.inForeground=!1,this.Ni=null,this.Bi=null,this.Li=Number.NEGATIVE_INFINITY,this.ki=T=>Promise.resolve(),!Yv.v())throw new Re(ue.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new _3(this,o),this.Ki=t+GS,this.serializer=new DS(m),this.qi=new sa(this.Ki,this.xi,new D3(this.serializer)),this.ci=new u3,this.li=new b3(this.referenceDelegate,this.serializer),this.remoteDocumentCache=$S(this.serializer),this.Pi=new c3,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,b===!1&&Vs(xo,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.$i().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Re(ue.FAILED_PRECONDITION,Gy);return this.Wi(),this.Qi(),this.Gi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.li.getHighestSequenceNumber(e)))})).then((e=>{this.ai=new qr(e,this.Fi)})).then((()=>{this.ui=!0})).catch((e=>(this.qi&&this.qi.close(),Promise.reject(e))))}zi(e){return this.ki=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.qi.q((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ci.enqueueAndForget((async()=>{this.started&&await this.$i()})))}$i(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Xf(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.ji(e).next((t=>{t||(this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))))}))})).next((()=>this.Hi(e))).next((t=>this.isPrimary&&!t?this.Ji(e).next((()=>!1)):!!t&&this.Zi(e).next((()=>!0)))))).catch((e=>{if(Qo(e))return Ve(xo,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Ve(xo,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Ci.enqueueRetryable((()=>this.ki(e))),this.isPrimary=e}))}ji(e){return Ed(e).get(Ic).next((t=>re.resolve(this.Xi(t))))}Yi(e){return Xf(e).delete(this.clientId)}async es(){if(this.isPrimary&&!this.ts(this.Li,$y)){this.Li=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const s=Zs(t,au);return s.H().next((o=>{const c=this.ns(o,$y),u=o.filter((h=>c.indexOf(h)===-1));return re.forEach(u,(h=>s.delete(h.clientId))).next((()=>u))}))})).catch((()=>[]));if(this.Ui)for(const t of e)this.Ui.removeItem(this.rs(t.clientId))}}Gi(){this.Bi=this.Ci.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.$i().then((()=>this.es())).then((()=>this.Gi()))))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.Mi?re.resolve(!0):Ed(e).get(Ic).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,Wy)&&!this.ss(t.ownerId)){if(this.Xi(t)&&this.networkEnabled)return!0;if(!this.Xi(t)){if(!t.allowTabSynchronization)throw new Re(ue.FAILED_PRECONDITION,Gy);return!1}}return!(!this.networkEnabled||!this.inForeground)||Xf(e).H().next((s=>this.ns(s,Wy).find((o=>{if(this.clientId!==o.clientId){const c=!this.networkEnabled&&o.networkEnabled,u=!this.inForeground&&o.inForeground,h=this.networkEnabled===o.networkEnabled;if(c||u&&h)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&Ve(xo,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.ui=!1,this._s(),this.Bi&&(this.Bi.cancel(),this.Bi=null),this.us(),this.cs(),await this.qi.runTransaction("shutdown","readwrite",[wh,au],(e=>{const t=new Mb(e,qr.ce);return this.Ji(t).next((()=>this.Yi(t)))})),this.qi.close(),this.ls()}ns(e,t){return e.filter((s=>this.ts(s.updateTimeMs,t)&&!this.ss(s.clientId)))}hs(){return this.runTransaction("getActiveClients","readonly",(e=>Xf(e).H().next((t=>this.ns(t,$y).map((s=>s.clientId))))))}get started(){return this.ui}getGlobalsCache(){return this.ci}getMutationQueue(e,t){return xp.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new y3(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return vp.wt(this.serializer,e)}getBundleCache(){return this.Pi}runTransaction(e,t,s){Ve(xo,"Starting transaction:",e);const o=t==="readonly"?"readonly":"readwrite",c=(function(m){return m===18?gM:m===17?DE:m===16?pM:m===15?Dv:m===14?IE:m===13?RE:m===12?mM:m===11?AE:void dt(60245)})(this.xi);let u;return this.qi.runTransaction(e,o,c,(h=>(u=new Mb(h,this.ai?this.ai.next():qr.ce),t==="readwrite-primary"?this.ji(u).next((m=>!!m||this.Hi(u))).next((m=>{if(!m)throw Vs(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))),new Re(ue.FAILED_PRECONDITION,xE);return s(u)})).next((m=>this.Zi(u).next((()=>m)))):this.Ps(u).next((()=>s(u)))))).then((h=>(u.raiseOnCommittedEvent(),h)))}Ps(e){return Ed(e).get(Ic).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,Wy)&&!this.ss(t.ownerId)&&!this.Xi(t)&&!(this.Mi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Re(ue.FAILED_PRECONDITION,Gy)}))}Zi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ed(e).put(Ic,t)}static v(){return sa.v()}Ji(e){const t=Ed(e);return t.get(Ic).next((s=>this.Xi(s)?(Ve(xo,"Releasing primary lease."),t.delete(Ic)):re.resolve()))}ts(e,t){const s=Date.now();return!(e<s-t)&&(!(e>s)||(Vs(`Detected an update time that is in the future: ${e} > ${s}`),!1))}Wi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ni=()=>{this.Ci.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.$i())))},this.document.addEventListener("visibilitychange",this.Ni),this.inForeground=this.document.visibilityState==="visible")}us(){this.Ni&&(this.document.removeEventListener("visibilitychange",this.Ni),this.Ni=null)}Qi(){typeof this.window?.addEventListener=="function"&&(this.Oi=()=>{this._s();const e=/(?:Version|Mobile)\/1[456]/;vk()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Ci.enterRestrictedMode(!0),this.Ci.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Oi))}cs(){this.Oi&&(this.window.removeEventListener("pagehide",this.Oi),this.Oi=null)}ss(e){try{const t=this.Ui?.getItem(this.rs(e))!==null;return Ve(xo,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return Vs(xo,"Failed to get zombied client id.",t),!1}}_s(){if(this.Ui)try{this.Ui.setItem(this.rs(this.clientId),String(Date.now()))}catch(e){Vs("Failed to set zombie client id.",e)}}ls(){if(this.Ui)try{this.Ui.removeItem(this.rs(this.clientId))}catch{}}rs(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Ed(n){return Zs(n,wh)}function Xf(n){return Zs(n,au)}function Xv(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class Jv{constructor(e,t,s,o){this.targetId=e,this.fromCache=t,this.Ts=s,this.Is=o}static Es(e,t){let s=tn(),o=tn();for(const c of t.docChanges)switch(c.type){case 0:s=s.add(c.doc.key);break;case 1:o=o.add(c.doc.key)}return new Jv(e,t.fromCache,s,o)}}class P3{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class KS{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return vk()?8:wE(Js())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,s,o){const c={result:null};return this.gs(e,t).next((u=>{c.result=u})).next((()=>{if(!c.result)return this.ps(e,t,o,s).next((u=>{c.result=u}))})).next((()=>{if(c.result)return;const u=new P3;return this.ys(e,t,u).next((h=>{if(c.result=h,this.As)return this.ws(e,t,u,h.size)}))})).next((()=>c.result))}ws(e,t,s,o){return s.documentReadCount<this.Vs?(zc()<=wn.DEBUG&&Ve("QueryEngine","SDK will not create cache indexes for query:",qc(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),re.resolve()):(zc()<=wn.DEBUG&&Ve("QueryEngine","Query:",qc(t),"scans",s.documentReadCount,"local documents and returns",o,"documents as results."),s.documentReadCount>this.ds*o?(zc()<=wn.DEBUG&&Ve("QueryEngine","The SDK decides to create cache indexes for query:",qc(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,kr(t))):re.resolve())}gs(e,t){if(E2(t))return re.resolve(null);let s=kr(t);return this.indexManager.getIndexType(e,s).next((o=>o===0?null:(t.limit!==null&&o===1&&(t=Um(t,null,"F"),s=kr(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next((c=>{const u=tn(...c);return this.fs.getDocuments(e,u).next((h=>this.indexManager.getMinOffset(e,s).next((m=>{const g=this.bs(t,h);return this.Ss(t,g,u,m.readTime)?this.gs(e,Um(t,null,"F")):this.Ds(e,g,t,m)}))))})))))}ps(e,t,s,o){return E2(t)||o.isEqual(Et.min())?re.resolve(null):this.fs.getDocuments(e,s).next((c=>{const u=this.bs(t,c);return this.Ss(t,u,s,o)?re.resolve(null):(zc()<=wn.DEBUG&&Ve("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),qc(t)),this.Ds(e,u,t,bE(o,eu)).next((h=>h)))}))}bs(e,t){let s=new Qn(sS(e));return t.forEach(((o,c)=>{Eh(e,c)&&(s=s.add(c))})),s}Ss(e,t,s,o){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const c=e.limitType==="F"?t.last():t.first();return!!c&&(c.hasPendingWrites||c.version.compareTo(o)>0)}ys(e,t,s){return zc()<=wn.DEBUG&&Ve("QueryEngine","Using full collection scan to execute query:",qc(t)),this.fs.getDocumentsMatchingQuery(e,t,oi.min(),s)}Ds(e,t,s,o){return this.fs.getDocumentsMatchingQuery(e,s,o).next((c=>(t.forEach((u=>{c=c.insert(u.key,u)})),c)))}}const Zv="LocalStore",M3=3e8;class L3{constructor(e,t,s,o){this.persistence=e,this.Cs=t,this.serializer=o,this.vs=new os(Ht),this.Fs=new qa((c=>Bl(c)),Th),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(s)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new WS(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function QS(n,e,t,s){return new L3(n,e,t,s)}async function YS(n,e){const t=Ze(n);return await t.persistence.runTransaction("Handle user change","readonly",(s=>{let o;return t.mutationQueue.getAllMutationBatches(s).next((c=>(o=c,t.Os(e),t.mutationQueue.getAllMutationBatches(s)))).next((c=>{const u=[],h=[];let m=tn();for(const g of o){u.push(g.batchId);for(const b of g.mutations)m=m.add(b.key)}for(const g of c){h.push(g.batchId);for(const b of g.mutations)m=m.add(b.key)}return t.localDocuments.getDocuments(s,m).next((g=>({Ns:g,removedBatchIds:u,addedBatchIds:h})))}))}))}function V3(n,e){const t=Ze(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(s=>{const o=e.batch.keys(),c=t.xs.newChangeBuffer({trackRemovals:!0});return(function(h,m,g,b){const x=g.batch,T=x.keys();let N=re.resolve();return T.forEach((B=>{N=N.next((()=>b.getEntry(m,B))).next((P=>{const M=g.docVersions.get(B);gt(M!==null,48541),P.version.compareTo(M)<0&&(x.applyToRemoteDocument(P,g),P.isValidDocument()&&(P.setReadTime(g.commitVersion),b.addEntry(P)))}))})),N.next((()=>h.mutationQueue.removeMutationBatch(m,x)))})(t,s,e,c).next((()=>c.apply(s))).next((()=>t.mutationQueue.performConsistencyCheck(s))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(s,o,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,(function(h){let m=tn();for(let g=0;g<h.mutationResults.length;++g)h.mutationResults[g].transformResults.length>0&&(m=m.add(h.batch.mutations[g].key));return m})(e)))).next((()=>t.localDocuments.getDocuments(s,o)))}))}function XS(n){const e=Ze(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function O3(n,e){const t=Ze(n),s=e.snapshotVersion;let o=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(c=>{const u=t.xs.newChangeBuffer({trackRemovals:!0});o=t.vs;const h=[];e.targetChanges.forEach(((b,x)=>{const T=o.get(x);if(!T)return;h.push(t.li.removeMatchingKeys(c,b.removedDocuments,x).next((()=>t.li.addMatchingKeys(c,b.addedDocuments,x))));let N=T.withSequenceNumber(c.currentSequenceNumber);e.targetMismatches.get(x)!==null?N=N.withResumeToken(As.EMPTY_BYTE_STRING,Et.min()).withLastLimboFreeSnapshotVersion(Et.min()):b.resumeToken.approximateByteSize()>0&&(N=N.withResumeToken(b.resumeToken,s)),o=o.insert(x,N),(function(P,M,Y){return P.resumeToken.approximateByteSize()===0||M.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=M3?!0:Y.addedDocuments.size+Y.modifiedDocuments.size+Y.removedDocuments.size>0})(T,N,b)&&h.push(t.li.updateTargetData(c,N))}));let m=$r(),g=tn();if(e.documentUpdates.forEach((b=>{e.resolvedLimboDocuments.has(b)&&h.push(t.persistence.referenceDelegate.updateLimboDocument(c,b))})),h.push(JS(c,u,e.documentUpdates).next((b=>{m=b.Bs,g=b.Ls}))),!s.isEqual(Et.min())){const b=t.li.getLastRemoteSnapshotVersion(c).next((x=>t.li.setTargetsMetadata(c,c.currentSequenceNumber,s)));h.push(b)}return re.waitFor(h).next((()=>u.apply(c))).next((()=>t.localDocuments.getLocalViewOfDocuments(c,m,g))).next((()=>m))})).then((c=>(t.vs=o,c)))}function JS(n,e,t){let s=tn(),o=tn();return t.forEach((c=>s=s.add(c))),e.getEntries(n,s).next((c=>{let u=$r();return t.forEach(((h,m)=>{const g=c.get(h);m.isFoundDocument()!==g.isFoundDocument()&&(o=o.add(h)),m.isNoDocument()&&m.version.isEqual(Et.min())?(e.removeEntry(h,m.readTime),u=u.insert(h,m)):!g.isValidDocument()||m.version.compareTo(g.version)>0||m.version.compareTo(g.version)===0&&g.hasPendingWrites?(e.addEntry(m),u=u.insert(h,m)):Ve(Zv,"Ignoring outdated watch update for ",h,". Current version:",g.version," Watch version:",m.version)})),{Bs:u,Ls:o}}))}function B3(n,e){const t=Ze(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(s=>(e===void 0&&(e=Oo),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e))))}function fu(n,e){const t=Ze(n);return t.persistence.runTransaction("Allocate target","readwrite",(s=>{let o;return t.li.getTargetData(s,e).next((c=>c?(o=c,re.resolve(o)):t.li.allocateTargetId(s).next((u=>(o=new Ca(e,u,"TargetPurposeListen",s.currentSequenceNumber),t.li.addTargetData(s,o).next((()=>o)))))))})).then((s=>{const o=t.vs.get(s.targetId);return(o===null||s.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.vs=t.vs.insert(s.targetId,s),t.Fs.set(e,s.targetId)),s}))}async function mu(n,e,t){const s=Ze(n),o=s.vs.get(e),c=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",c,(u=>s.persistence.referenceDelegate.removeTarget(u,o)))}catch(u){if(!Qo(u))throw u;Ve(Zv,`Failed to update sequence numbers for target ${e}: ${u}`)}s.vs=s.vs.remove(e),s.Fs.delete(o.target)}function $m(n,e,t){const s=Ze(n);let o=Et.min(),c=tn();return s.persistence.runTransaction("Execute query","readwrite",(u=>(function(m,g,b){const x=Ze(m),T=x.Fs.get(b);return T!==void 0?re.resolve(x.vs.get(T)):x.li.getTargetData(g,b)})(s,u,kr(e)).next((h=>{if(h)return o=h.lastLimboFreeSnapshotVersion,s.li.getMatchingKeysForTargetId(u,h.targetId).next((m=>{c=m}))})).next((()=>s.Cs.getDocumentsMatchingQuery(u,e,t?o:Et.min(),t?c:tn()))).next((h=>(tj(s,nS(e),h),{documents:h,ks:c})))))}function ZS(n,e){const t=Ze(n),s=Ze(t.li),o=t.vs.get(e);return o?Promise.resolve(o.target):t.persistence.runTransaction("Get target data","readonly",(c=>s.At(c,e).next((u=>u?u.target:null))))}function ej(n,e){const t=Ze(n),s=t.Ms.get(e)||Et.min();return t.persistence.runTransaction("Get new document changes","readonly",(o=>t.xs.getAllFromCollectionGroup(o,e,bE(s,eu),Number.MAX_SAFE_INTEGER))).then((o=>(tj(t,e,o),o)))}function tj(n,e,t){let s=n.Ms.get(e)||Et.min();t.forEach(((o,c)=>{c.readTime.compareTo(s)>0&&(s=c.readTime)})),n.Ms.set(e,s)}async function U3(n,e,t,s){const o=Ze(n);let c=tn(),u=$r();for(const g of t){const b=e.Ks(g.metadata.name);g.document&&(c=c.add(b));const x=e.qs(g);x.setReadTime(e.Us(g.metadata.readTime)),u=u.insert(b,x)}const h=o.xs.newChangeBuffer({trackRemovals:!0}),m=await fu(o,(function(b){return kr(Eu(fn.fromString(`__bundle__/docs/${b}`)))})(s));return o.persistence.runTransaction("Apply bundle documents","readwrite",(g=>JS(g,h,u).next((b=>(h.apply(g),b))).next((b=>o.li.removeMatchingKeysForTargetId(g,m.targetId).next((()=>o.li.addMatchingKeys(g,c,m.targetId))).next((()=>o.localDocuments.getLocalViewOfDocuments(g,b.Bs,b.Ls))).next((()=>b.Bs))))))}async function F3(n,e,t=tn()){const s=await fu(n,kr(bp(e.bundledQuery))),o=Ze(n);return o.persistence.runTransaction("Save named query","readwrite",(c=>{const u=Os(e.readTime);if(s.snapshotVersion.compareTo(u)>=0)return o.Pi.saveNamedQuery(c,e);const h=s.withResumeToken(As.EMPTY_BYTE_STRING,u);return o.vs=o.vs.insert(h.targetId,h),o.li.updateTargetData(c,h).next((()=>o.li.removeMatchingKeysForTargetId(c,s.targetId))).next((()=>o.li.addMatchingKeys(c,t,s.targetId))).next((()=>o.Pi.saveNamedQuery(c,e)))}))}const nj="firestore_clients";function nT(n,e){return`${nj}_${n}_${e}`}const sj="firestore_mutations";function sT(n,e,t){let s=`${sj}_${n}_${t}`;return e.isAuthenticated()&&(s+=`_${e.uid}`),s}const rj="firestore_targets";function Ky(n,e){return`${rj}_${n}_${e}`}const Yi="SharedClientState";class Wm{constructor(e,t,s,o){this.user=e,this.batchId=t,this.state=s,this.error=o}static $s(e,t,s){const o=JSON.parse(s);let c,u=typeof o=="object"&&["pending","acknowledged","rejected"].indexOf(o.state)!==-1&&(o.error===void 0||typeof o.error=="object");return u&&o.error&&(u=typeof o.error.message=="string"&&typeof o.error.code=="string",u&&(c=new Re(o.error.code,o.error.message))),u?new Wm(e,t,o.state,c):(Vs(Yi,`Failed to parse mutation state for ID '${t}': ${s}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Wd{constructor(e,t,s){this.targetId=e,this.state=t,this.error=s}static $s(e,t){const s=JSON.parse(t);let o,c=typeof s=="object"&&["not-current","current","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return c&&s.error&&(c=typeof s.error.message=="string"&&typeof s.error.code=="string",c&&(o=new Re(s.error.code,s.error.message))),c?new Wd(e,s.state,o):(Vs(Yi,`Failed to parse target state for ID '${e}': ${t}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Gm{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static $s(e,t){const s=JSON.parse(t);let o=typeof s=="object"&&s.activeTargetIds instanceof Array,c=Ov();for(let u=0;o&&u<s.activeTargetIds.length;++u)o=TE(s.activeTargetIds[u]),c=c.add(s.activeTargetIds[u]);return o?new Gm(e,c):(Vs(Yi,`Failed to parse client data for instance '${e}': ${t}`),null)}}class e0{constructor(e,t){this.clientId=e,this.onlineState=t}static $s(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new e0(t.clientId,t.onlineState):(Vs(Yi,`Failed to parse online state: ${e}`),null)}}class Yb{constructor(){this.activeTargetIds=Ov()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Qy{constructor(e,t,s,o,c){this.window=e,this.Ci=t,this.persistenceKey=s,this.zs=o,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.js=this.Hs.bind(this),this.Js=new os(Ht),this.started=!1,this.Zs=[];const u=s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=c,this.Xs=nT(this.persistenceKey,this.zs),this.Ys=(function(m){return`firestore_sequence_number_${m}`})(this.persistenceKey),this.Js=this.Js.insert(this.zs,new Yb),this.eo=new RegExp(`^${nj}_${u}_([^_]*)$`),this.no=new RegExp(`^${sj}_${u}_(\\d+)(?:_(.*))?$`),this.ro=new RegExp(`^${rj}_${u}_(\\d+)$`),this.io=(function(m){return`firestore_online_state_${m}`})(this.persistenceKey),this.so=(function(m){return`firestore_bundle_loaded_v2_${m}`})(this.persistenceKey),this.window.addEventListener("storage",this.js)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.hs();for(const s of e){if(s===this.zs)continue;const o=this.getItem(nT(this.persistenceKey,s));if(o){const c=Gm.$s(s,o);c&&(this.Js=this.Js.insert(c.clientId,c))}}this.oo();const t=this.storage.getItem(this.io);if(t){const s=this._o(t);s&&this.ao(s)}for(const s of this.Zs)this.Hs(s);this.Zs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ys,JSON.stringify(e))}getAllActiveQueryTargets(){return this.uo(this.Js)}isActiveQueryTarget(e){let t=!1;return this.Js.forEach(((s,o)=>{o.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.co(e,"pending")}updateMutationState(e,t,s){this.co(e,t,s),this.lo(e)}addLocalQueryTarget(e,t=!0){let s="not-current";if(this.isActiveQueryTarget(e)){const o=this.storage.getItem(Ky(this.persistenceKey,e));if(o){const c=Wd.$s(e,o);c&&(s=c.state)}}return t&&this.ho.Qs(e),this.oo(),s}removeLocalQueryTarget(e){this.ho.Gs(e),this.oo()}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Ky(this.persistenceKey,e))}updateQueryState(e,t,s){this.Po(e,t,s)}handleUserChange(e,t,s){t.forEach((o=>{this.lo(o)})),this.currentUser=e,s.forEach((o=>{this.addPendingMutation(o)}))}setOnlineState(e){this.To(e)}notifyBundleLoaded(e){this.Io(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.js),this.removeItem(this.Xs),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Ve(Yi,"READ",e,t),t}setItem(e,t){Ve(Yi,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){Ve(Yi,"REMOVE",e),this.storage.removeItem(e)}Hs(e){const t=e;if(t.storageArea===this.storage){if(Ve(Yi,"EVENT",t.key,t.newValue),t.key===this.Xs)return void Vs("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ci.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.eo.test(t.key)){if(t.newValue==null){const s=this.Eo(t.key);return this.Ro(s,null)}{const s=this.Ao(t.key,t.newValue);if(s)return this.Ro(s.clientId,s)}}else if(this.no.test(t.key)){if(t.newValue!==null){const s=this.Vo(t.key,t.newValue);if(s)return this.mo(s)}}else if(this.ro.test(t.key)){if(t.newValue!==null){const s=this.fo(t.key,t.newValue);if(s)return this.po(s)}}else if(t.key===this.io){if(t.newValue!==null){const s=this._o(t.newValue);if(s)return this.ao(s)}}else if(t.key===this.Ys){const s=(function(c){let u=qr.ce;if(c!=null)try{const h=JSON.parse(c);gt(typeof h=="number",30636,{yo:c}),u=h}catch(h){Vs(Yi,"Failed to read sequence number from WebStorage",h)}return u})(t.newValue);s!==qr.ce&&this.sequenceNumberHandler(s)}else if(t.key===this.so){const s=this.wo(t.newValue);await Promise.all(s.map((o=>this.syncEngine.bo(o))))}}}else this.Zs.push(t)}))}}get ho(){return this.Js.get(this.zs)}oo(){this.setItem(this.Xs,this.ho.Ws())}co(e,t,s){const o=new Wm(this.currentUser,e,t,s),c=sT(this.persistenceKey,this.currentUser,e);this.setItem(c,o.Ws())}lo(e){const t=sT(this.persistenceKey,this.currentUser,e);this.removeItem(t)}To(e){const t={clientId:this.zs,onlineState:e};this.storage.setItem(this.io,JSON.stringify(t))}Po(e,t,s){const o=Ky(this.persistenceKey,e),c=new Wd(e,t,s);this.setItem(o,c.Ws())}Io(e){const t=JSON.stringify(Array.from(e));this.setItem(this.so,t)}Eo(e){const t=this.eo.exec(e);return t?t[1]:null}Ao(e,t){const s=this.Eo(e);return Gm.$s(s,t)}Vo(e,t){const s=this.no.exec(e),o=Number(s[1]),c=s[2]!==void 0?s[2]:null;return Wm.$s(new rr(c),o,t)}fo(e,t){const s=this.ro.exec(e),o=Number(s[1]);return Wd.$s(o,t)}_o(e){return e0.$s(e)}wo(e){return JSON.parse(e)}async mo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.So(e.batchId,e.state,e.error);Ve(Yi,`Ignoring mutation for non-active user ${e.user.uid}`)}po(e){return this.syncEngine.Do(e.targetId,e.state,e.error)}Ro(e,t){const s=t?this.Js.insert(e,t):this.Js.remove(e),o=this.uo(this.Js),c=this.uo(s),u=[],h=[];return c.forEach((m=>{o.has(m)||u.push(m)})),o.forEach((m=>{c.has(m)||h.push(m)})),this.syncEngine.Co(u,h).then((()=>{this.Js=s}))}ao(e){this.Js.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}uo(e){let t=Ov();return e.forEach(((s,o)=>{t=t.unionWith(o.activeTargetIds)})),t}}class ij{constructor(){this.vo=new Yb,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,s){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new Yb,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class z3{Mo(e){}shutdown(){}}const rT="ConnectivityMonitor";class iT{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){Ve(rT,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){Ve(rT,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Jf=null;function Xb(){return Jf===null?Jf=(function(){return 268435456+Math.round(2147483648*Math.random())})():Jf++,"0x"+Jf.toString(16)}const Yy="RestConnection",q3={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class H3{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${s}/databases/${o}`,this.$o=this.databaseId.database===ih?`project_id=${s}`:`project_id=${s}&database_id=${o}`}Wo(e,t,s,o,c){const u=Xb(),h=this.Qo(e,t.toUriEncodedString());Ve(Yy,`Sending RPC '${e}' ${u}:`,h,s);const m={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(m,o,c);const{host:g}=new URL(h),b=Ba(g);return this.zo(e,h,m,s,b).then((x=>(Ve(Yy,`Received RPC '${e}' ${u}: `,x),x)),(x=>{throw wi(Yy,`RPC '${e}' ${u} failed with error: `,x,"url: ",h,"request:",s),x}))}jo(e,t,s,o,c,u){return this.Wo(e,t,s,o,c)}Go(e,t,s){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+ku})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((o,c)=>e[c]=o)),s&&s.headers.forEach(((o,c)=>e[c]=o))}Qo(e,t){const s=q3[e];let o=`${this.qo}/v1/${t}:${s}`;return this.databaseInfo.apiKey&&(o=`${o}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),o}terminate(){}}class $3{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const _r="WebChannelConnection",Sd=(n,e,t)=>{n.listen(e,(s=>{try{t(s)}catch(o){setTimeout((()=>{throw o}),0)}}))};class Xc extends H3{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Xc.c_){const e=dE();Sd(e,uE.STAT_EVENT,(t=>{t.stat===jb.PROXY?Ve(_r,"STAT_EVENT: detected buffering proxy"):t.stat===jb.NOPROXY&&Ve(_r,"STAT_EVENT: detected no buffering proxy")})),Xc.c_=!0}}zo(e,t,s,o,c){const u=Xb();return new Promise(((h,m)=>{const g=new lE;g.setWithCredentials(!0),g.listenOnce(cE.COMPLETE,(()=>{try{switch(g.getLastErrorCode()){case fm.NO_ERROR:const x=g.getResponseJson();Ve(_r,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(x)),h(x);break;case fm.TIMEOUT:Ve(_r,`RPC '${e}' ${u} timed out`),m(new Re(ue.DEADLINE_EXCEEDED,"Request time out"));break;case fm.HTTP_ERROR:const T=g.getStatus();if(Ve(_r,`RPC '${e}' ${u} failed with status:`,T,"response text:",g.getResponseText()),T>0){let N=g.getResponseJson();Array.isArray(N)&&(N=N[0]);const B=N?.error;if(B&&B.status&&B.message){const P=(function(Y){const H=Y.toLowerCase().replace(/_/g,"-");return Object.values(ue).indexOf(H)>=0?H:ue.UNKNOWN})(B.status);m(new Re(P,B.message))}else m(new Re(ue.UNKNOWN,"Server responded with status "+g.getStatus()))}else m(new Re(ue.UNAVAILABLE,"Connection failed."));break;default:dt(9055,{l_:e,streamId:u,h_:g.getLastErrorCode(),P_:g.getLastError()})}}finally{Ve(_r,`RPC '${e}' ${u} completed.`)}}));const b=JSON.stringify(o);Ve(_r,`RPC '${e}' ${u} sending request:`,o),g.send(t,"POST",b,s,15)}))}T_(e,t,s){const o=Xb(),c=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=this.createWebChannelTransport(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(h.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(h.useFetchStreams=!0),this.Go(h.initMessageHeaders,t,s),h.encodeInitMessageHeaders=!0;const g=c.join("");Ve(_r,`Creating RPC '${e}' stream ${o}: ${g}`,h);const b=u.createWebChannel(g,h);this.I_(b);let x=!1,T=!1;const N=new $3({Ho:B=>{T?Ve(_r,`Not sending because RPC '${e}' stream ${o} is closed:`,B):(x||(Ve(_r,`Opening RPC '${e}' stream ${o} transport.`),b.open(),x=!0),Ve(_r,`RPC '${e}' stream ${o} sending:`,B),b.send(B))},Jo:()=>b.close()});return Sd(b,Dd.EventType.OPEN,(()=>{T||(Ve(_r,`RPC '${e}' stream ${o} transport opened.`),N.i_())})),Sd(b,Dd.EventType.CLOSE,(()=>{T||(T=!0,Ve(_r,`RPC '${e}' stream ${o} transport closed`),N.o_(),this.E_(b))})),Sd(b,Dd.EventType.ERROR,(B=>{T||(T=!0,wi(_r,`RPC '${e}' stream ${o} transport errored. Name:`,B.name,"Message:",B.message),N.o_(new Re(ue.UNAVAILABLE,"The operation could not be completed")))})),Sd(b,Dd.EventType.MESSAGE,(B=>{if(!T){const P=B.data[0];gt(!!P,16349);const M=P,Y=M?.error||M[0]?.error;if(Y){Ve(_r,`RPC '${e}' stream ${o} received error:`,Y);const H=Y.status;let X=(function(Te){const C=$s[Te];if(C!==void 0)return yS(C)})(H),fe=Y.message;X===void 0&&(X=ue.INTERNAL,fe="Unknown error status: "+H+" with message "+Y.message),T=!0,N.o_(new Re(X,fe)),b.close()}else Ve(_r,`RPC '${e}' stream ${o} received:`,P),N.__(P)}})),Xc.u_(),setTimeout((()=>{N.s_()}),0),N}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,s){super.Go(e,t,s),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return hE()}}function W3(n){return new Xc(n)}function aj(){return typeof window<"u"?window:null}function wm(){return typeof document<"u"?document:null}function Yl(n){return new JM(n,!0)}Xc.c_=!1;class t0{constructor(e,t,s=1e3,o=1.5,c=6e4){this.Ci=e,this.timerId=t,this.R_=s,this.A_=o,this.V_=c,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),s=Math.max(0,Date.now()-this.f_),o=Math.max(0,t-s);o>0&&Ve("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,o,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const aT="PersistentStream";class oj{constructor(e,t,s,o,c,u,h,m){this.Ci=e,this.b_=s,this.S_=o,this.connection=c,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=h,this.listener=m,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new t0(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ue.RESOURCE_EXHAUSTED?(Vs(t.toString()),Vs("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ue.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([s,o])=>{this.D_===t&&this.G_(s,o)}),(s=>{e((()=>{const o=new Re(ue.UNKNOWN,"Fetching auth token failed: "+s.message);return this.z_(o)}))}))}G_(e,t){const s=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{s((()=>this.listener.Zo()))})),this.stream.Yo((()=>{s((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((o=>{s((()=>this.z_(o)))})),this.stream.onMessage((o=>{s((()=>++this.F_==1?this.H_(o):this.onNext(o)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ve(aT,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(Ve(aT,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class G3 extends oj{constructor(e,t,s,o,c,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,o,u),this.serializer=c}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=t3(this.serializer,e),s=(function(c){if(!("targetChange"in c))return Et.min();const u=c.targetChange;return u.targetIds&&u.targetIds.length?Et.min():u.readTime?Os(u.readTime):Et.min()})(e);return this.listener.J_(t,s)}Z_(e){const t={};t.database=$b(this.serializer),t.addTarget=(function(c,u){let h;const m=u.target;if(h=Om(m)?{documents:SS(c,m)}:{query:yp(c,m).ft},h.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){h.resumeToken=_S(c,u.resumeToken);const g=qb(c,u.expectedCount);g!==null&&(h.expectedCount=g)}else if(u.snapshotVersion.compareTo(Et.min())>0){h.readTime=hu(c,u.snapshotVersion.toTimestamp());const g=qb(c,u.expectedCount);g!==null&&(h.expectedCount=g)}return h})(this.serializer,e);const s=s3(this.serializer,e);s&&(t.labels=s),this.K_(t)}X_(e){const t={};t.database=$b(this.serializer),t.removeTarget=e,this.K_(t)}}class K3 extends oj{constructor(e,t,s,o,c,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,o,u),this.serializer=c}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return gt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,gt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){gt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=n3(e.writeResults,e.commitTime),s=Os(e.commitTime);return this.listener.na(s,t)}ra(){const e={};e.database=$b(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((s=>uh(this.serializer,s)))};this.K_(t)}}class Q3{}class Y3 extends Q3{constructor(e,t,s,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new Re(ue.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,s,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,u])=>this.connection.Wo(e,Hb(t,s),o,c,u))).catch((c=>{throw c.name==="FirebaseError"?(c.code===ue.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new Re(ue.UNKNOWN,c.toString())}))}jo(e,t,s,o,c){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,h])=>this.connection.jo(e,Hb(t,s),o,u,h,c))).catch((u=>{throw u.name==="FirebaseError"?(u.code===ue.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new Re(ue.UNKNOWN,u.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function X3(n,e,t,s){return new Y3(n,e,t,s)}class J3{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Vs(t),this.aa=!1):Ve("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const $l="RemoteStore";class Z3{constructor(e,t,s,o,c){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=c,this.Aa.Mo((u=>{s.enqueueAndForget((async()=>{Xo(this)&&(Ve($l,"Restarting streams for network reachability change."),await(async function(m){const g=Ze(m);g.Ea.add(4),await Nu(g),g.Va.set("Unknown"),g.Ea.delete(4),await Ch(g)})(this))}))})),this.Va=new J3(s,o)}}async function Ch(n){if(Xo(n))for(const e of n.Ra)await e(!0)}async function Nu(n){for(const e of n.Ra)await e(!1)}function wp(n,e){const t=Ze(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),r0(t)?s0(t):Au(t).O_()&&n0(t,e))}function pu(n,e){const t=Ze(n),s=Au(t);t.Ia.delete(e),s.O_()&&lj(t,e),t.Ia.size===0&&(s.O_()?s.L_():Xo(t)&&t.Va.set("Unknown"))}function n0(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Et.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Au(n).Z_(e)}function lj(n,e){n.da.$e(e),Au(n).X_(e)}function s0(n){n.da=new KM({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Au(n).start(),n.Va.ua()}function r0(n){return Xo(n)&&!Au(n).x_()&&n.Ia.size>0}function Xo(n){return Ze(n).Ea.size===0}function cj(n){n.da=void 0}async function e6(n){n.Va.set("Online")}async function t6(n){n.Ia.forEach(((e,t)=>{n0(n,e)}))}async function n6(n,e){cj(n),r0(n)?(n.Va.ha(e),s0(n)):n.Va.set("Unknown")}async function s6(n,e,t){if(n.Va.set("Online"),e instanceof xS&&e.state===2&&e.cause)try{await(async function(o,c){const u=c.cause;for(const h of c.targetIds)o.Ia.has(h)&&(await o.remoteSyncer.rejectListen(h,u),o.Ia.delete(h),o.da.removeTarget(h))})(n,e)}catch(s){Ve($l,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await Km(n,s)}else if(e instanceof xm?n.da.Xe(e):e instanceof vS?n.da.st(e):n.da.tt(e),!t.isEqual(Et.min()))try{const s=await XS(n.localStore);t.compareTo(s)>=0&&await(function(c,u){const h=c.da.Tt(u);return h.targetChanges.forEach(((m,g)=>{if(m.resumeToken.approximateByteSize()>0){const b=c.Ia.get(g);b&&c.Ia.set(g,b.withResumeToken(m.resumeToken,u))}})),h.targetMismatches.forEach(((m,g)=>{const b=c.Ia.get(m);if(!b)return;c.Ia.set(m,b.withResumeToken(As.EMPTY_BYTE_STRING,b.snapshotVersion)),lj(c,m);const x=new Ca(b.target,m,g,b.sequenceNumber);n0(c,x)})),c.remoteSyncer.applyRemoteEvent(h)})(n,t)}catch(s){Ve($l,"Failed to raise snapshot:",s),await Km(n,s)}}async function Km(n,e,t){if(!Qo(e))throw e;n.Ea.add(1),await Nu(n),n.Va.set("Offline"),t||(t=()=>XS(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Ve($l,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Ch(n)}))}function uj(n,e){return e().catch((t=>Km(n,t,e)))}async function Cu(n){const e=Ze(n),t=Ho(e);let s=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Oo;for(;r6(e);)try{const o=await B3(e.localStore,s);if(o===null){e.Ta.length===0&&t.L_();break}s=o.batchId,i6(e,o)}catch(o){await Km(e,o)}dj(e)&&hj(e)}function r6(n){return Xo(n)&&n.Ta.length<10}function i6(n,e){n.Ta.push(e);const t=Ho(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function dj(n){return Xo(n)&&!Ho(n).x_()&&n.Ta.length>0}function hj(n){Ho(n).start()}async function a6(n){Ho(n).ra()}async function o6(n){const e=Ho(n);for(const t of n.Ta)e.ea(t.mutations)}async function l6(n,e,t){const s=n.Ta.shift(),o=zv.from(s,e,t);await uj(n,(()=>n.remoteSyncer.applySuccessfulWrite(o))),await Cu(n)}async function c6(n,e){e&&Ho(n).Y_&&await(async function(s,o){if((function(u){return gS(u)&&u!==ue.ABORTED})(o.code)){const c=s.Ta.shift();Ho(s).B_(),await uj(s,(()=>s.remoteSyncer.rejectFailedWrite(c.batchId,o))),await Cu(s)}})(n,e),dj(n)&&hj(n)}async function oT(n,e){const t=Ze(n);t.asyncQueue.verifyOperationInProgress(),Ve($l,"RemoteStore received new credentials");const s=Xo(t);t.Ea.add(3),await Nu(t),s&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Ch(t)}async function Jb(n,e){const t=Ze(n);e?(t.Ea.delete(2),await Ch(t)):e||(t.Ea.add(2),await Nu(t),t.Va.set("Unknown"))}function Au(n){return n.ma||(n.ma=(function(t,s,o){const c=Ze(t);return c.sa(),new G3(s,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)})(n.datastore,n.asyncQueue,{Zo:e6.bind(null,n),Yo:t6.bind(null,n),t_:n6.bind(null,n),J_:s6.bind(null,n)}),n.Ra.push((async e=>{e?(n.ma.B_(),r0(n)?s0(n):n.Va.set("Unknown")):(await n.ma.stop(),cj(n))}))),n.ma}function Ho(n){return n.fa||(n.fa=(function(t,s,o){const c=Ze(t);return c.sa(),new K3(s,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:a6.bind(null,n),t_:c6.bind(null,n),ta:o6.bind(null,n),na:l6.bind(null,n)}),n.Ra.push((async e=>{e?(n.fa.B_(),await Cu(n)):(await n.fa.stop(),n.Ta.length>0&&(Ve($l,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class i0{constructor(e,t,s,o,c){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=o,this.removalCallback=c,this.deferred=new ar,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((u=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,o,c){const u=Date.now()+s,h=new i0(e,t,u,o,c);return h.start(s),h}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Re(ue.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ru(n,e){if(Vs("AsyncQueue",`${e}: ${n}`),Qo(n))return new Re(ue.UNAVAILABLE,`${e}: ${n}`);throw n}class Rl{static emptySet(e){return new Rl(e.comparator)}constructor(e){this.comparator=e?(t,s)=>e(t,s)||Je.comparator(t.key,s.key):(t,s)=>Je.comparator(t.key,s.key),this.keyedMap=Pd(),this.sortedSet=new os(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,s)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Rl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=s.getNext().key;if(!o.isEqual(c))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new Rl;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}class lT{constructor(){this.ga=new os(Je.comparator)}track(e){const t=e.doc.key,s=this.ga.get(t);s?e.type!==0&&s.type===3?this.ga=this.ga.insert(t,e):e.type===3&&s.type!==1?this.ga=this.ga.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.ga=this.ga.remove(t):e.type===1&&s.type===2?this.ga=this.ga.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):dt(63341,{Vt:e,pa:s}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,s)=>{e.push(s)})),e}}class Wl{constructor(e,t,s,o,c,u,h,m,g){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=o,this.mutatedKeys=c,this.fromCache=u,this.syncStateChanged=h,this.excludesMetadataChanges=m,this.hasCachedResults=g}static fromInitialDocuments(e,t,s,o,c){const u=[];return t.forEach((h=>{u.push({type:0,doc:h})})),new Wl(e,t,Rl.emptySet(t),u,s,o,!0,!1,c)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&kh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==s[o].type||!t[o].doc.isEqual(s[o].doc))return!1;return!0}}class u6{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class d6{constructor(){this.queries=cT(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,s){const o=Ze(t),c=o.queries;o.queries=cT(),c.forEach(((u,h)=>{for(const m of h.ba)m.onError(s)}))})(this,new Re(ue.ABORTED,"Firestore shutting down"))}}function cT(){return new qa((n=>tS(n)),kh)}async function a0(n,e){const t=Ze(n);let s=3;const o=e.query;let c=t.queries.get(o);c?!c.Sa()&&e.Da()&&(s=2):(c=new u6,s=e.Da()?0:1);try{switch(s){case 0:c.wa=await t.onListen(o,!0);break;case 1:c.wa=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(u){const h=Ru(u,`Initialization of query '${qc(e.query)}' failed`);return void e.onError(h)}t.queries.set(o,c),c.ba.push(e),e.va(t.onlineState),c.wa&&e.Fa(c.wa)&&l0(t)}async function o0(n,e){const t=Ze(n),s=e.query;let o=3;const c=t.queries.get(s);if(c){const u=c.ba.indexOf(e);u>=0&&(c.ba.splice(u,1),c.ba.length===0?o=e.Da()?0:1:!c.Sa()&&e.Da()&&(o=2))}switch(o){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function h6(n,e){const t=Ze(n);let s=!1;for(const o of e){const c=o.query,u=t.queries.get(c);if(u){for(const h of u.ba)h.Fa(o)&&(s=!0);u.wa=o}}s&&l0(t)}function f6(n,e,t){const s=Ze(n),o=s.queries.get(e);if(o)for(const c of o.ba)c.onError(t);s.queries.delete(e)}function l0(n){n.Ca.forEach((e=>{e.next()}))}var Zb,uT;(uT=Zb||(Zb={})).Ma="default",uT.Cache="cache";class c0{constructor(e,t,s){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=s||{}}Fa(e){if(!this.options.includeMetadataChanges){const s=[];for(const o of e.docChanges)o.type!==3&&s.push(o);e=new Wl(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const s=t!=="Offline";return(!this.options.Ka||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Wl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Zb.Cache}}class fj{constructor(e,t){this.qa=e,this.byteLength=t}Ua(){return"metadata"in this.qa}}class dT{constructor(e){this.serializer=e}Ks(e){return ra(this.serializer,e)}qs(e){return e.metadata.exists?gp(this.serializer,e.document,!1):hs.newNoDocument(this.Ks(e.metadata.name),this.Us(e.metadata.readTime))}Us(e){return Os(e)}}class u0{constructor(e,t){this.$a=e,this.serializer=t,this.Wa=[],this.Qa=[],this.collectionGroups=new Set,this.progress=mj(e)}get queries(){return this.Wa}get documents(){return this.Qa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.qa.namedQuery)this.Wa.push(e.qa.namedQuery);else if(e.qa.documentMetadata){this.Qa.push({metadata:e.qa.documentMetadata}),e.qa.documentMetadata.exists||++t;const s=fn.fromString(e.qa.documentMetadata.name);this.collectionGroups.add(s.get(s.length-2))}else e.qa.document&&(this.Qa[this.Qa.length-1].document=e.qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,{...this.progress}):null}za(e){const t=new Map,s=new dT(this.serializer);for(const o of e)if(o.metadata.queries){const c=s.Ks(o.metadata.name);for(const u of o.metadata.queries){const h=(t.get(u)||tn()).add(c);t.set(u,h)}}return t}async ja(e){const t=await U3(e,new dT(this.serializer),this.Qa,this.$a.id),s=this.za(this.documents);for(const o of this.Wa)await F3(e,o,s.get(o.name));return this.progress.taskState="Success",{progress:this.progress,Ha:this.collectionGroups,Ja:t}}}function mj(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class pj{constructor(e){this.key=e}}class gj{constructor(e){this.key=e}}class yj{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=tn(),this.mutatedKeys=tn(),this.eu=sS(e),this.tu=new Rl(this.eu)}get nu(){return this.Za}ru(e,t){const s=t?t.iu:new lT,o=t?t.tu:this.tu;let c=t?t.mutatedKeys:this.mutatedKeys,u=o,h=!1;const m=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,g=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal(((b,x)=>{const T=o.get(b),N=Eh(this.query,x)?x:null,B=!!T&&this.mutatedKeys.has(T.key),P=!!N&&(N.hasLocalMutations||this.mutatedKeys.has(N.key)&&N.hasCommittedMutations);let M=!1;T&&N?T.data.isEqual(N.data)?B!==P&&(s.track({type:3,doc:N}),M=!0):this.su(T,N)||(s.track({type:2,doc:N}),M=!0,(m&&this.eu(N,m)>0||g&&this.eu(N,g)<0)&&(h=!0)):!T&&N?(s.track({type:0,doc:N}),M=!0):T&&!N&&(s.track({type:1,doc:T}),M=!0,(m||g)&&(h=!0)),M&&(N?(u=u.add(N),c=P?c.add(b):c.delete(b)):(u=u.delete(b),c=c.delete(b)))})),this.query.limit!==null)for(;u.size>this.query.limit;){const b=this.query.limitType==="F"?u.last():u.first();u=u.delete(b.key),c=c.delete(b.key),s.track({type:1,doc:b})}return{tu:u,iu:s,Ss:h,mutatedKeys:c}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,o){const c=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const u=e.iu.ya();u.sort(((b,x)=>(function(N,B){const P=M=>{switch(M){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return dt(20277,{Vt:M})}};return P(N)-P(B)})(b.type,x.type)||this.eu(b.doc,x.doc))),this.ou(s),o=o??!1;const h=t&&!o?this._u():[],m=this.Ya.size===0&&this.current&&!o?1:0,g=m!==this.Xa;return this.Xa=m,u.length!==0||g?{snapshot:new Wl(this.query,e.tu,c,u,e.mutatedKeys,m===0,g,!1,!!s&&s.resumeToken.approximateByteSize()>0),au:h}:{au:h}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new lT,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=tn(),this.tu.forEach((s=>{this.uu(s.key)&&(this.Ya=this.Ya.add(s.key))}));const t=[];return e.forEach((s=>{this.Ya.has(s)||t.push(new gj(s))})),this.Ya.forEach((s=>{e.has(s)||t.push(new pj(s))})),t}cu(e){this.Za=e.ks,this.Ya=tn();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Wl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const Jo="SyncEngine";class m6{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class p6{constructor(e){this.key=e,this.hu=!1}}class g6{constructor(e,t,s,o,c,u){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=o,this.currentUser=c,this.maxConcurrentLimboResolutions=u,this.Pu={},this.Tu=new qa((h=>tS(h)),kh),this.Iu=new Map,this.Eu=new Set,this.Ru=new os(Je.comparator),this.Au=new Map,this.Vu=new Kv,this.du={},this.mu=new Map,this.fu=Hl.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function y6(n,e,t=!0){const s=Tp(n);let o;const c=s.Tu.get(e);return c?(s.sharedClientState.addLocalQueryTarget(c.targetId),o=c.view.lu()):o=await bj(s,e,t,!0),o}async function b6(n,e){const t=Tp(n);await bj(t,e,!0,!1)}async function bj(n,e,t,s){const o=await fu(n.localStore,kr(e)),c=o.targetId,u=n.sharedClientState.addLocalQueryTarget(c,t);let h;return s&&(h=await d0(n,e,c,u==="current",o.resumeToken)),n.isPrimaryClient&&t&&wp(n.remoteStore,o),h}async function d0(n,e,t,s,o){n.pu=(x,T,N)=>(async function(P,M,Y,H){let X=M.view.ru(Y);X.Ss&&(X=await $m(P.localStore,M.query,!1).then((({documents:C})=>M.view.ru(C,X))));const fe=H&&H.targetChanges.get(M.targetId),je=H&&H.targetMismatches.get(M.targetId)!=null,Te=M.view.applyChanges(X,P.isPrimaryClient,fe,je);return ev(P,M.targetId,Te.au),Te.snapshot})(n,x,T,N);const c=await $m(n.localStore,e,!0),u=new yj(e,c.ks),h=u.ru(c.documents),m=Nh.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",o),g=u.applyChanges(h,n.isPrimaryClient,m);ev(n,t,g.au);const b=new m6(e,t,u);return n.Tu.set(e,b),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),g.snapshot}async function v6(n,e,t){const s=Ze(n),o=s.Tu.get(e),c=s.Iu.get(o.targetId);if(c.length>1)return s.Iu.set(o.targetId,c.filter((u=>!kh(u,e)))),void s.Tu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(o.targetId),s.sharedClientState.isActiveQueryTarget(o.targetId)||await mu(s.localStore,o.targetId,!1).then((()=>{s.sharedClientState.clearQueryState(o.targetId),t&&pu(s.remoteStore,o.targetId),gu(s,o.targetId)})).catch(Ko)):(gu(s,o.targetId),await mu(s.localStore,o.targetId,!0))}async function x6(n,e){const t=Ze(n),s=t.Tu.get(e),o=t.Iu.get(s.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),pu(t.remoteStore,s.targetId))}async function _6(n,e,t){const s=p0(n);try{const o=await(function(u,h){const m=Ze(u),g=pt.now(),b=h.reduce(((N,B)=>N.add(B.key)),tn());let x,T;return m.persistence.runTransaction("Locally write mutations","readwrite",(N=>{let B=$r(),P=tn();return m.xs.getEntries(N,b).next((M=>{B=M,B.forEach(((Y,H)=>{H.isValidDocument()||(P=P.add(Y))}))})).next((()=>m.localDocuments.getOverlayedDocuments(N,B))).next((M=>{x=M;const Y=[];for(const H of h){const X=HM(H,x.get(H.key).overlayedDocument);X!=null&&Y.push(new Ha(H.key,X,HE(X.value.mapValue),vs.exists(!0)))}return m.mutationQueue.addMutationBatch(N,g,Y,h)})).next((M=>{T=M;const Y=M.applyToLocalDocumentSet(x,P);return m.documentOverlayCache.saveOverlays(N,M.batchId,Y)}))})).then((()=>({batchId:T.batchId,changes:iS(x)})))})(s.localStore,e);s.sharedClientState.addPendingMutation(o.batchId),(function(u,h,m){let g=u.du[u.currentUser.toKey()];g||(g=new os(Ht)),g=g.insert(h,m),u.du[u.currentUser.toKey()]=g})(s,o.batchId,t),await $a(s,o.changes),await Cu(s.remoteStore)}catch(o){const c=Ru(o,"Failed to persist write");t.reject(c)}}async function vj(n,e){const t=Ze(n);try{const s=await O3(t.localStore,e);e.targetChanges.forEach(((o,c)=>{const u=t.Au.get(c);u&&(gt(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?u.hu=!0:o.modifiedDocuments.size>0?gt(u.hu,14607):o.removedDocuments.size>0&&(gt(u.hu,42227),u.hu=!1))})),await $a(t,s,e)}catch(s){await Ko(s)}}function hT(n,e,t){const s=Ze(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const o=[];s.Tu.forEach(((c,u)=>{const h=u.view.va(e);h.snapshot&&o.push(h.snapshot)})),(function(u,h){const m=Ze(u);m.onlineState=h;let g=!1;m.queries.forEach(((b,x)=>{for(const T of x.ba)T.va(h)&&(g=!0)})),g&&l0(m)})(s.eventManager,e),o.length&&s.Pu.J_(o),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function w6(n,e,t){const s=Ze(n);s.sharedClientState.updateQueryState(e,"rejected",t);const o=s.Au.get(e),c=o&&o.key;if(c){let u=new os(Je.comparator);u=u.insert(c,hs.newNoDocument(c,Et.min()));const h=tn().add(c),m=new jh(Et.min(),new Map,new os(Ht),u,h);await vj(s,m),s.Ru=s.Ru.remove(c),s.Au.delete(e),m0(s)}else await mu(s.localStore,e,!1).then((()=>gu(s,e,t))).catch(Ko)}async function T6(n,e){const t=Ze(n),s=e.batch.batchId;try{const o=await V3(t.localStore,e);f0(t,s,null),h0(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await $a(t,o)}catch(o){await Ko(o)}}async function k6(n,e,t){const s=Ze(n);try{const o=await(function(u,h){const m=Ze(u);return m.persistence.runTransaction("Reject batch","readwrite-primary",(g=>{let b;return m.mutationQueue.lookupMutationBatch(g,h).next((x=>(gt(x!==null,37113),b=x.keys(),m.mutationQueue.removeMutationBatch(g,x)))).next((()=>m.mutationQueue.performConsistencyCheck(g))).next((()=>m.documentOverlayCache.removeOverlaysForBatchId(g,b,h))).next((()=>m.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(g,b))).next((()=>m.localDocuments.getDocuments(g,b)))}))})(s.localStore,e);f0(s,e,t),h0(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await $a(s,o)}catch(o){await Ko(o)}}async function E6(n,e){const t=Ze(n);Xo(t.remoteStore)||Ve(Jo,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const s=await(function(u){const h=Ze(u);return h.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(m=>h.mutationQueue.getHighestUnacknowledgedBatchId(m)))})(t.localStore);if(s===Oo)return void e.resolve();const o=t.mu.get(s)||[];o.push(e),t.mu.set(s,o)}catch(s){const o=Ru(s,"Initialization of waitForPendingWrites() operation failed");e.reject(o)}}function h0(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function f0(n,e,t){const s=Ze(n);let o=s.du[s.currentUser.toKey()];if(o){const c=o.get(e);c&&(t?c.reject(t):c.resolve(),o=o.remove(e)),s.du[s.currentUser.toKey()]=o}}function gu(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.Iu.get(e))n.Tu.delete(s),t&&n.Pu.yu(s,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach((s=>{n.Vu.containsKey(s)||xj(n,s)}))}function xj(n,e){n.Eu.delete(e.path.canonicalString());const t=n.Ru.get(e);t!==null&&(pu(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),m0(n))}function ev(n,e,t){for(const s of t)s instanceof pj?(n.Vu.addReference(s.key,e),S6(n,s)):s instanceof gj?(Ve(Jo,"Document no longer in limbo: "+s.key),n.Vu.removeReference(s.key,e),n.Vu.containsKey(s.key)||xj(n,s.key)):dt(19791,{wu:s})}function S6(n,e){const t=e.key,s=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(s)||(Ve(Jo,"New document in limbo: "+t),n.Eu.add(s),m0(n))}function m0(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Je(fn.fromString(e)),s=n.fu.next();n.Au.set(s,new p6(t)),n.Ru=n.Ru.insert(t,s),wp(n.remoteStore,new Ca(kr(Eu(t.path)),s,"TargetPurposeLimboResolution",qr.ce))}}async function $a(n,e,t){const s=Ze(n),o=[],c=[],u=[];s.Tu.isEmpty()||(s.Tu.forEach(((h,m)=>{u.push(s.pu(m,e,t).then((g=>{if((g||t)&&s.isPrimaryClient){const b=g?!g.fromCache:t?.targetChanges.get(m.targetId)?.current;s.sharedClientState.updateQueryState(m.targetId,b?"current":"not-current")}if(g){o.push(g);const b=Jv.Es(m.targetId,g);c.push(b)}})))})),await Promise.all(u),s.Pu.J_(o),await(async function(m,g){const b=Ze(m);try{await b.persistence.runTransaction("notifyLocalViewChanges","readwrite",(x=>re.forEach(g,(T=>re.forEach(T.Ts,(N=>b.persistence.referenceDelegate.addReference(x,T.targetId,N))).next((()=>re.forEach(T.Is,(N=>b.persistence.referenceDelegate.removeReference(x,T.targetId,N)))))))))}catch(x){if(!Qo(x))throw x;Ve(Zv,"Failed to update sequence numbers: "+x)}for(const x of g){const T=x.targetId;if(!x.fromCache){const N=b.vs.get(T),B=N.snapshotVersion,P=N.withLastLimboFreeSnapshotVersion(B);b.vs=b.vs.insert(T,P)}}})(s.localStore,c))}async function j6(n,e){const t=Ze(n);if(!t.currentUser.isEqual(e)){Ve(Jo,"User change. New user:",e.toKey());const s=await YS(t.localStore,e);t.currentUser=e,(function(c,u){c.mu.forEach((h=>{h.forEach((m=>{m.reject(new Re(ue.CANCELLED,u))}))})),c.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await $a(t,s.Ns)}}function N6(n,e){const t=Ze(n),s=t.Au.get(e);if(s&&s.hu)return tn().add(s.key);{let o=tn();const c=t.Iu.get(e);if(!c)return o;for(const u of c){const h=t.Tu.get(u);o=o.unionWith(h.view.nu)}return o}}async function C6(n,e){const t=Ze(n),s=await $m(t.localStore,e.query,!0),o=e.view.cu(s);return t.isPrimaryClient&&ev(t,e.targetId,o.au),o}async function A6(n,e){const t=Ze(n);return ej(t.localStore,e).then((s=>$a(t,s)))}async function R6(n,e,t,s){const o=Ze(n),c=await(function(h,m){const g=Ze(h),b=Ze(g.mutationQueue);return g.persistence.runTransaction("Lookup mutation documents","readonly",(x=>b.Xn(x,m).next((T=>T?g.localDocuments.getDocuments(x,T):re.resolve(null)))))})(o.localStore,e);c!==null?(t==="pending"?await Cu(o.remoteStore):t==="acknowledged"||t==="rejected"?(f0(o,e,s||null),h0(o,e),(function(h,m){Ze(Ze(h).mutationQueue).nr(m)})(o.localStore,e)):dt(6720,"Unknown batchState",{bu:t}),await $a(o,c)):Ve(Jo,"Cannot apply mutation batch with id: "+e)}async function I6(n,e){const t=Ze(n);if(Tp(t),p0(t),e===!0&&t.gu!==!0){const s=t.sharedClientState.getAllActiveQueryTargets(),o=await fT(t,s.toArray());t.gu=!0,await Jb(t.remoteStore,!0);for(const c of o)wp(t.remoteStore,c)}else if(e===!1&&t.gu!==!1){const s=[];let o=Promise.resolve();t.Iu.forEach(((c,u)=>{t.sharedClientState.isLocalQueryTarget(u)?s.push(u):o=o.then((()=>(gu(t,u),mu(t.localStore,u,!0)))),pu(t.remoteStore,u)})),await o,await fT(t,s),(function(u){const h=Ze(u);h.Au.forEach(((m,g)=>{pu(h.remoteStore,g)})),h.Vu.zr(),h.Au=new Map,h.Ru=new os(Je.comparator)})(t),t.gu=!1,await Jb(t.remoteStore,!1)}}async function fT(n,e,t){const s=Ze(n),o=[],c=[];for(const u of e){let h;const m=s.Iu.get(u);if(m&&m.length!==0){h=await fu(s.localStore,kr(m[0]));for(const g of m){const b=s.Tu.get(g),x=await C6(s,b);x.snapshot&&c.push(x.snapshot)}}else{const g=await ZS(s.localStore,u);h=await fu(s.localStore,g),await d0(s,_j(g),u,!1,h.resumeToken)}o.push(h)}return s.Pu.J_(c),o}function _j(n){return JE(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function D6(n){return(function(t){return Ze(Ze(t).persistence).hs()})(Ze(n).localStore)}async function P6(n,e,t,s){const o=Ze(n);if(o.gu)return void Ve(Jo,"Ignoring unexpected query state notification.");const c=o.Iu.get(e);if(c&&c.length>0)switch(t){case"current":case"not-current":{const u=await ej(o.localStore,nS(c[0])),h=jh.createSynthesizedRemoteEventForCurrentChange(e,t==="current",As.EMPTY_BYTE_STRING);await $a(o,u,h);break}case"rejected":await mu(o.localStore,e,!0),gu(o,e,s);break;default:dt(64155,t)}}async function M6(n,e,t){const s=Tp(n);if(s.gu){for(const o of e){if(s.Iu.has(o)&&s.sharedClientState.isActiveQueryTarget(o)){Ve(Jo,"Adding an already active target "+o);continue}const c=await ZS(s.localStore,o),u=await fu(s.localStore,c);await d0(s,_j(c),u.targetId,!1,u.resumeToken),wp(s.remoteStore,u)}for(const o of t)s.Iu.has(o)&&await mu(s.localStore,o,!1).then((()=>{pu(s.remoteStore,o),gu(s,o)})).catch(Ko)}}function Tp(n){const e=Ze(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=vj.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=N6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=w6.bind(null,e),e.Pu.J_=h6.bind(null,e.eventManager),e.Pu.yu=f6.bind(null,e.eventManager),e}function p0(n){const e=Ze(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=T6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=k6.bind(null,e),e}function L6(n,e,t){const s=Ze(n);(async function(c,u,h){try{const m=await u.getMetadata();if(await(function(N,B){const P=Ze(N),M=Os(B.createTime);return P.persistence.runTransaction("hasNewerBundle","readonly",(Y=>P.Pi.getBundleMetadata(Y,B.id))).then((Y=>!!Y&&Y.createTime.compareTo(M)>=0))})(c.localStore,m))return await u.close(),h._completeWith((function(N){return{taskState:"Success",documentsLoaded:N.totalDocuments,bytesLoaded:N.totalBytes,totalDocuments:N.totalDocuments,totalBytes:N.totalBytes}})(m)),Promise.resolve(new Set);h._updateProgress(mj(m));const g=new u0(m,u.serializer);let b=await u.Su();for(;b;){const T=await g.Ga(b);T&&h._updateProgress(T),b=await u.Su()}const x=await g.ja(c.localStore);return await $a(c,x.Ja,void 0),await(function(N,B){const P=Ze(N);return P.persistence.runTransaction("Save bundle","readwrite",(M=>P.Pi.saveBundleMetadata(M,B)))})(c.localStore,m),h._completeWith(x.progress),Promise.resolve(x.Ha)}catch(m){return wi(Jo,`Loading bundle failed with ${m}`),h._failWith(m),Promise.resolve(new Set)}})(s,e,t).then((o=>{s.sharedClientState.notifyBundleLoaded(o)}))}class yu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Yl(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return QS(this.persistence,new KS,e.initialUser,this.serializer)}Cu(e){return new Qv(_p.Vi,this.serializer)}Du(e){return new ij}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}yu.provider={build:()=>new yu};class g0 extends yu{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){gt(this.persistence.referenceDelegate instanceof Hm,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new zS(s,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?wr.withCacheSize(this.cacheSizeBytes):wr.DEFAULT;return new Qv((s=>Hm.Vi(s,t)),this.serializer)}}class y0 extends yu{constructor(e,t,s){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=s,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await p0(this.xu.syncEngine),await Cu(this.xu.remoteStore),await this.persistence.zi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return QS(this.persistence,new KS,e.initialUser,this.serializer)}Fu(e,t){const s=this.persistence.referenceDelegate.garbageCollector;return new zS(s,e.asyncQueue,t)}Mu(e,t){const s=new HP(t,this.persistence);return new qP(e.asyncQueue,s)}Cu(e){const t=Xv(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),s=this.cacheSizeBytes!==void 0?wr.withCacheSize(this.cacheSizeBytes):wr.DEFAULT;return new Yv(this.synchronizeTabs,t,e.clientId,s,e.asyncQueue,aj(),wm(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new ij}}class wj extends y0{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof Qy&&(this.sharedClientState.syncEngine={So:R6.bind(null,t),Do:P6.bind(null,t),Co:M6.bind(null,t),hs:D6.bind(null,t),bo:A6.bind(null,t)},await this.sharedClientState.start()),await this.persistence.zi((async s=>{await I6(this.xu.syncEngine,s),this.gcScheduler&&(s&&!this.gcScheduler.started?this.gcScheduler.start():s||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(s&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():s||this.indexBackfillerScheduler.stop())}))}Du(e){const t=aj();if(!Qy.v(t))throw new Re(ue.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const s=Xv(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Qy(t,e.asyncQueue,s,e.clientId,e.initialUser)}}class $o{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>hT(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=j6.bind(null,this.syncEngine),await Jb(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new d6})()}createDatastore(e){const t=Yl(e.databaseInfo.databaseId),s=W3(e.databaseInfo);return X3(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return(function(s,o,c,u,h){return new Z3(s,o,c,u,h)})(this.localStore,this.datastore,e.asyncQueue,(t=>hT(this.syncEngine,t,0)),(function(){return iT.v()?new iT:new z3})())}createSyncEngine(e,t){return(function(o,c,u,h,m,g,b){const x=new g6(o,c,u,h,m,g);return b&&(x.gu=!0),x})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const s=Ze(t);Ve($l,"RemoteStore shutting down."),s.Ea.add(5),await Nu(s),s.Aa.shutdown(),s.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}$o.provider={build:()=>new $o};function mT(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const s={value:n.slice(t,t+e),done:!1};return t+=e,s}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}class kp{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Vs("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}class V6{constructor(e,t){this.Bu=e,this.serializer=t,this.metadata=new ar,this.buffer=new Uint8Array,this.Lu=(function(){return new TextDecoder("utf-8")})(),this.ku().then((s=>{s&&s.Ua()?this.metadata.resolve(s.qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(s?.qa)}`))}),(s=>this.metadata.reject(s)))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async Su(){return await this.getMetadata(),this.ku()}async ku(){const e=await this.Ku();if(e===null)return null;const t=this.Lu.decode(e),s=Number(t);isNaN(s)&&this.qu(`length string (${t}) is not valid number`);const o=await this.Uu(s);return new fj(JSON.parse(o),e.length+s)}$u(){return this.buffer.findIndex((e=>e===123))}async Ku(){for(;this.$u()<0&&!await this.Wu(););if(this.buffer.length===0)return null;const e=this.$u();e<0&&this.qu("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Uu(e){for(;this.buffer.length<e;)await this.Wu()&&this.qu("Reached the end of bundle when more is expected.");const t=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}qu(e){throw this.Bu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Wu(){const e=await this.Bu.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}class O6{constructor(e,t){this.bundleData=e,this.serializer=t,this.cursor=0,this.elements=[];let s=this.Su();if(!s||!s.Ua())throw new Error(`The first element of the bundle is not a metadata object, it is
         ${JSON.stringify(s?.qa)}`);this.metadata=s;do s=this.Su(),s!==null&&this.elements.push(s);while(s!==null)}getMetadata(){return this.metadata}Qu(){return this.elements}Su(){if(this.cursor===this.bundleData.length)return null;const e=this.Ku(),t=this.Uu(e);return new fj(JSON.parse(t),e)}Uu(e){if(this.cursor+e>this.bundleData.length)throw new Re(ue.INTERNAL,"Reached the end of bundle when more is expected.");return this.bundleData.slice(this.cursor,this.cursor+=e)}Ku(){const e=this.cursor;let t=this.cursor;for(;t<this.bundleData.length;){if(this.bundleData[t]==="{"){if(t===e)throw new Error("First character is a bracket and not a number");return this.cursor=t,Number(this.bundleData.slice(e,t))}t++}throw new Error("Reached the end of bundle when more is expected.")}}let B6=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new Re(ue.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await(async function(o,c){const u=Ze(o),h={documents:c.map((x=>ch(u.serializer,x)))},m=await u.jo("BatchGetDocuments",u.serializer.databaseId,fn.emptyPath(),h,c.length),g=new Map;m.forEach((x=>{const T=e3(u.serializer,x);g.set(T.key.toString(),T)}));const b=[];return c.forEach((x=>{const T=g.get(x.toString());gt(!!T,55234,{key:x}),b.push(T)})),b})(this.datastore,e);return t.forEach((s=>this.recordVersion(s))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(s){this.lastTransactionError=s}this.writtenDocs.add(e.toString())}delete(e){this.write(new ju(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,s)=>{const o=Je.fromPath(s);this.mutations.push(new Uv(o,this.precondition(o)))})),await(async function(s,o){const c=Ze(s),u={writes:o.map((h=>uh(c.serializer,h)))};await c.Wo("Commit",c.serializer.databaseId,fn.emptyPath(),u)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw dt(50498,{Gu:e.constructor.name});t=Et.min()}const s=this.readVersions.get(e.key.toString());if(s){if(!t.isEqual(s))throw new Re(ue.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Et.min())?vs.exists(!1):vs.updateTime(t):vs.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Et.min()))throw new Re(ue.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return vs.updateTime(t)}return vs.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};class U6{constructor(e,t,s,o,c){this.asyncQueue=e,this.datastore=t,this.options=s,this.updateFunction=o,this.deferred=c,this.zu=s.maxAttempts,this.M_=new t0(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Hu()}Hu(){this.M_.p_((async()=>{const e=new B6(this.datastore),t=this.Ju(e);t&&t.then((s=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(s)})).catch((o=>{this.Zu(o)}))))})).catch((s=>{this.Zu(s)}))}))}Ju(e){try{const t=this.updateFunction(e);return!_h(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Zu(e){this.zu>0&&this.Xu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget((()=>(this.Hu(),Promise.resolve())))):this.deferred.reject(e)}Xu(e){if(e?.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!gS(t)}return!1}}const Wo="FirestoreClient";class F6{constructor(e,t,s,o,c){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this._databaseInfo=o,this.user=rr.UNAUTHENTICATED,this.clientId=Sv.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=c,this.authCredentials.start(s,(async u=>{Ve(Wo,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u})),this.appCheckCredentials.start(s,(u=>(Ve(Wo,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ar;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=Ru(t,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}async function Xy(n,e){n.asyncQueue.verifyOperationInProgress(),Ve(Wo,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener((async o=>{s.isEqual(o)||(await YS(e.localStore,o),s=o)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function pT(n,e){n.asyncQueue.verifyOperationInProgress();const t=await b0(n);Ve(Wo,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((s=>oT(e.remoteStore,s))),n.setAppCheckTokenChangeListener(((s,o)=>oT(e.remoteStore,o))),n._onlineComponents=e}async function b0(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Ve(Wo,"Using user provided OfflineComponentProvider");try{await Xy(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(o){return o.name==="FirebaseError"?o.code===ue.FAILED_PRECONDITION||o.code===ue.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11})(t))throw t;wi("Error using user provided cache. Falling back to memory cache: "+t),await Xy(n,new yu)}}else Ve(Wo,"Using default OfflineComponentProvider"),await Xy(n,new g0(void 0));return n._offlineComponents}async function Ep(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Ve(Wo,"Using user provided OnlineComponentProvider"),await pT(n,n._uninitializedComponentsProvider._online)):(Ve(Wo,"Using default OnlineComponentProvider"),await pT(n,new $o))),n._onlineComponents}function Tj(n){return b0(n).then((e=>e.persistence))}function Iu(n){return b0(n).then((e=>e.localStore))}function kj(n){return Ep(n).then((e=>e.remoteStore))}function v0(n){return Ep(n).then((e=>e.syncEngine))}function Ej(n){return Ep(n).then((e=>e.datastore))}async function bu(n){const e=await Ep(n),t=e.eventManager;return t.onListen=y6.bind(null,e.syncEngine),t.onUnlisten=v6.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=b6.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=x6.bind(null,e.syncEngine),t}function z6(n){return n.asyncQueue.enqueue((async()=>{const e=await Tj(n),t=await kj(n);return e.setNetworkEnabled(!0),(function(o){const c=Ze(o);return c.Ea.delete(0),Ch(c)})(t)}))}function q6(n){return n.asyncQueue.enqueue((async()=>{const e=await Tj(n),t=await kj(n);return e.setNetworkEnabled(!1),(async function(o){const c=Ze(o);c.Ea.add(0),await Nu(c),c.Va.set("Offline")})(t)}))}function H6(n,e,t,s){const o=new kp(s),c=new c0(e,o,t);return n.asyncQueue.enqueueAndForget((async()=>a0(await bu(n),c))),()=>{o.Nu(),n.asyncQueue.enqueueAndForget((async()=>o0(await bu(n),c)))}}function $6(n,e){const t=new ar;return n.asyncQueue.enqueueAndForget((async()=>(async function(o,c,u){try{const h=await(function(g,b){const x=Ze(g);return x.persistence.runTransaction("read document","readonly",(T=>x.localDocuments.getDocument(T,b)))})(o,c);h.isFoundDocument()?u.resolve(h):h.isNoDocument()?u.resolve(null):u.reject(new Re(ue.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(h){const m=Ru(h,`Failed to get document '${c} from cache`);u.reject(m)}})(await Iu(n),e,t))),t.promise}function Sj(n,e,t={}){const s=new ar;return n.asyncQueue.enqueueAndForget((async()=>(function(c,u,h,m,g){const b=new kp({next:T=>{b.Nu(),u.enqueueAndForget((()=>o0(c,x)));const N=T.docs.has(h);!N&&T.fromCache?g.reject(new Re(ue.UNAVAILABLE,"Failed to get document because the client is offline.")):N&&T.fromCache&&m&&m.source==="server"?g.reject(new Re(ue.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):g.resolve(T)},error:T=>g.reject(T)}),x=new c0(Eu(h.path),b,{includeMetadataChanges:!0,Ka:!0});return a0(c,x)})(await bu(n),n.asyncQueue,e,t,s))),s.promise}function W6(n,e){const t=new ar;return n.asyncQueue.enqueueAndForget((async()=>(async function(o,c,u){try{const h=await $m(o,c,!0),m=new yj(c,h.ks),g=m.ru(h.documents),b=m.applyChanges(g,!1);u.resolve(b.snapshot)}catch(h){const m=Ru(h,`Failed to execute query '${c} against cache`);u.reject(m)}})(await Iu(n),e,t))),t.promise}function jj(n,e,t={}){const s=new ar;return n.asyncQueue.enqueueAndForget((async()=>(function(c,u,h,m,g){const b=new kp({next:T=>{b.Nu(),u.enqueueAndForget((()=>o0(c,x))),T.fromCache&&m.source==="server"?g.reject(new Re(ue.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):g.resolve(T)},error:T=>g.reject(T)}),x=new c0(h,b,{includeMetadataChanges:!0,Ka:!0});return a0(c,x)})(await bu(n),n.asyncQueue,e,t,s))),s.promise}function G6(n,e,t){const s=new ar;return n.asyncQueue.enqueueAndForget((async()=>{try{const o=await Ej(n);s.resolve((async function(u,h,m){const g=Ze(u),{request:b,gt:x,parent:T}=jS(g.serializer,ZE(h),m);g.connection.Ko||delete b.parent;const N=(await g.jo("RunAggregationQuery",g.serializer.databaseId,T,b,1)).filter((P=>!!P.result));gt(N.length===1,64727);const B=N[0].result?.aggregateFields;return Object.keys(B).reduce(((P,M)=>(P[x[M]]=B[M],P)),{})})(o,e,t))}catch(o){s.reject(o)}})),s.promise}function K6(n,e){const t=new ar;return n.asyncQueue.enqueueAndForget((async()=>_6(await v0(n),e,t))),t.promise}function Q6(n,e){const t=new kp(e);return n.asyncQueue.enqueueAndForget((async()=>(function(o,c){Ze(o).Ca.add(c),c.next()})(await bu(n),t))),()=>{t.Nu(),n.asyncQueue.enqueueAndForget((async()=>(function(o,c){Ze(o).Ca.delete(c)})(await bu(n),t)))}}function Y6(n,e,t){const s=new ar;return n.asyncQueue.enqueueAndForget((async()=>{const o=await Ej(n);new U6(n.asyncQueue,o,t,e,s).ju()})),s.promise}function X6(n,e,t,s){const o=(function(u,h){let m;return m=typeof u=="string"?bS().encode(u):u,(function(b,x){return new V6(b,x)})((function(b,x){if(b instanceof Uint8Array)return mT(b,x);if(b instanceof ArrayBuffer)return mT(new Uint8Array(b),x);if(b instanceof ReadableStream)return b.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")})(m),h)})(t,Yl(e));n.asyncQueue.enqueueAndForget((async()=>{L6(await v0(n),o,s)}))}function J6(n,e){return n.asyncQueue.enqueue((async()=>(function(s,o){const c=Ze(s);return c.persistence.runTransaction("Get named query","readonly",(u=>c.Pi.getNamedQuery(u,o)))})(await Iu(n),e)))}function Nj(n,e){return(function(s,o){return new O6(s,o)})(n,e)}function Z6(n,e){return n.asyncQueue.enqueue((async()=>(async function(s,o){const c=Ze(s),u=c.indexManager,h=[];return c.persistence.runTransaction("Configure indexes","readwrite",(m=>u.getFieldIndexes(m).next((g=>(function(x,T,N,B,P){x=[...x],T=[...T],x.sort(N),T.sort(N);const M=x.length,Y=T.length;let H=0,X=0;for(;H<Y&&X<M;){const fe=N(x[X],T[H]);fe<0?P(x[X++]):fe>0?B(T[H++]):(H++,X++)}for(;H<Y;)B(T[H++]);for(;X<M;)P(x[X++])})(g,o,BP,(b=>{h.push(u.addFieldIndex(m,b))}),(b=>{h.push(u.deleteFieldIndex(m,b))})))).next((()=>re.waitFor(h)))))})(await Iu(n),e)))}function eL(n,e){return n.asyncQueue.enqueue((async()=>(function(s,o){Ze(s).Cs.As=o})(await Iu(n),e)))}function tL(n){return n.asyncQueue.enqueue((async()=>(function(t){const s=Ze(t),o=s.indexManager;return s.persistence.runTransaction("Delete All Indexes","readwrite",(c=>o.deleteAllFieldIndexes(c)))})(await Iu(n))))}function Cj(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const nL="ComponentProvider",gT=new Map;function sL(n,e,t,s,o){return new bM(n,e,t,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,Cj(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator,s)}const Aj="firestore.googleapis.com",yT=!0;class bT{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Re(ue.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Aj,this.ssl=yT}else this.host=e.host,this.ssl=e.ssl??yT;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=VS;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<FS)throw new Re(ue.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}OP("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Cj(e.experimentalLongPollingOptions??{}),(function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Re(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Re(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Re(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(s,o){return s.timeoutSeconds===o.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ah{constructor(e,t,s,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new bT({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Re(ue.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Re(ue.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new bT(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(s){if(!s)return new NP;switch(s.type){case"firstParty":return new IP(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new Re(ue.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const s=gT.get(t);s&&(Ve(nL,"Removing Datastore"),gT.delete(t),s.terminate())})(this),Promise.resolve()}}function rL(n,e,t,s={}){n=yn(n,Ah);const o=Ba(e),c=n._getSettings(),u={...c,emulatorOptions:n._getEmulatorOptions()},h=`${e}:${t}`;o&&(np(`https://${h}`),dv("Firestore",!0)),c.host!==Aj&&c.host!==h&&wi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const m={...c,host:h,ssl:o,emulatorOptions:s};if(!Li(m,u)&&(n._setSettings(m),s.mockUserToken)){let g,b;if(typeof s.mockUserToken=="string")g=s.mockUserToken,b=rr.MOCK_USER;else{g=yk(s.mockUserToken,n._app?.options.projectId);const x=s.mockUserToken.sub||s.mockUserToken.user_id;if(!x)throw new Re(ue.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");b=new rr(x)}n._authCredentials=new CP(new mE(g,b))}}class or{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new or(this.firestore,e,this._query)}}class es{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ia(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new es(this.firestore,e,this._key)}toJSON(){return{type:es._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,s){if(Ql(t,es._jsonSchema))return new es(e,s||null,new Je(fn.fromString(t.referencePath)))}}es._jsonSchemaVersion="firestore/documentReference/1.0",es._jsonSchema={type:Ws("string",es._jsonSchemaVersion),referencePath:Ws("string")};class ia extends or{constructor(e,t,s){super(e,t,Eu(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new es(this.firestore,null,new Je(e))}withConverter(e){return new ia(this.firestore,e,this._path)}}function Kt(n,e,...t){if(n=jn(n),jv("collection","path",e),n instanceof Ah){const s=fn.fromString(e,...t);return a2(s),new ia(n,null,s)}{if(!(n instanceof es||n instanceof ia))throw new Re(ue.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(fn.fromString(e,...t));return a2(s),new ia(n.firestore,null,s)}}function qO(n,e){if(n=yn(n,Ah),jv("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Re(ue.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new or(n,null,(function(s){return new za(fn.emptyPath(),s)})(e))}function Ge(n,e,...t){if(n=jn(n),arguments.length===1&&(e=Sv.newId()),jv("doc","path",e),n instanceof Ah){const s=fn.fromString(e,...t);return i2(s),new es(n,null,new Je(s))}{if(!(n instanceof es||n instanceof ia))throw new Re(ue.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(fn.fromString(e,...t));return i2(s),new es(n.firestore,n instanceof ia?n.converter:null,new Je(s))}}function HO(n,e){return n=jn(n),e=jn(e),(n instanceof es||n instanceof ia)&&(e instanceof es||e instanceof ia)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function Rj(n,e){return n=jn(n),e=jn(e),n instanceof or&&e instanceof or&&n.firestore===e.firestore&&kh(n._query,e._query)&&n.converter===e.converter}const vT="AsyncQueue";class xT{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new t0(this,"async_queue_retry"),this._c=()=>{const s=wm();s&&Ve(vT,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=e;const t=wm();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=wm();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new ar;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Qo(e))throw e;Ve(vT,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((s=>{throw this.nc=s,this.rc=!1,Vs("INTERNAL UNHANDLED ERROR: ",_T(s)),s})).then((s=>(this.rc=!1,s))))));return this.ac=t,t}enqueueAfterDelay(e,t,s){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const o=i0.createAndSchedule(this,e,t,s,(c=>this.hc(c)));return this.tc.push(o),o}uc(){this.nc&&dt(47125,{Pc:_T(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,s)=>t.targetTimeMs-s.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function _T(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class iL{constructor(){this._progressObserver={},this._taskCompletionResolver=new ar,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,s){this._progressObserver={next:e,error:t,complete:s}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}const $O=-1;class is extends Ah{constructor(e,t,s,o){super(e,t,s,o),this.type="firestore",this._queue=new xT,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new xT(e),this._firestoreClient=void 0,await e}}}function WO(n,e,t){t||(t=ih);const s=wu(n,"firestore");if(s.isInitialized(t)){const o=s.getImmediate({identifier:t}),c=s.getOptions(t);if(Li(c,e))return o;throw new Re(ue.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new Re(ue.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<FS)throw new Re(ue.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&Ba(e.host)&&np(e.host),s.initialize({options:e,instanceIdentifier:t})}function aL(n,e){const t=typeof n=="object"?n:pv(),s=typeof n=="string"?n:e||ih,o=wu(t,"firestore").getImmediate({identifier:s});if(!o._initialized){const c=mk("firestore");c&&rL(o,...c)}return o}function Ts(n){if(n._terminated)throw new Re(ue.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||Ij(n),n._firestoreClient}function Ij(n){const e=n._freezeSettings(),t=sL(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new F6(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(o){const c=o?._online.build();return{_offline:o?._offline.build(c),_online:c}})(n._componentsProvider))}function GO(n,e){wi("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return Dj(n,$o.provider,{build:s=>new y0(s,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}async function KO(n){wi("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();Dj(n,$o.provider,{build:t=>new wj(t,e.cacheSizeBytes)})}function Dj(n,e,t){if((n=yn(n,is))._firestoreClient||n._terminated)throw new Re(ue.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new Re(ue.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},Ij(n)}function QO(n){if(n._initialized&&!n._terminated)throw new Re(ue.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new ar;return n._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await(async function(s){if(!sa.v())return Promise.resolve();const o=s+GS;await sa.delete(o)})(Xv(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function YO(n){return(function(t){const s=new ar;return t.asyncQueue.enqueueAndForget((async()=>E6(await v0(t),s))),s.promise})(Ts(n=yn(n,is)))}function XO(n){return z6(Ts(n=yn(n,is)))}function JO(n){return q6(Ts(n=yn(n,is)))}function ZO(n){return JI(n.app,"firestore",n._databaseId.database),n._delete()}function wT(n,e){const t=Ts(n=yn(n,is)),s=new iL;return X6(t,n._databaseId,e,s),s}function oL(n,e){return J6(Ts(n=yn(n,is)),e).then((t=>t?new or(n,null,t.query):null))}class ri{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ri(As.fromBase64String(e))}catch(t){throw new Re(ue.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ri(As.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ri._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ql(e,ri._jsonSchema))return ri.fromBase64String(e.bytes)}}ri._jsonSchemaVersion="firestore/bytes/1.0",ri._jsonSchema={type:Ws("string",ri._jsonSchemaVersion),bytes:Ws("string")};class Du{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Re(ue.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new bs(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function eB(){return new Du(Ab)}class Xl{constructor(e){this._methodName=e}}class aa{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Re(ue.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Re(ue.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ht(this._lat,e._lat)||Ht(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:aa._jsonSchemaVersion}}static fromJSON(e){if(Ql(e,aa._jsonSchema))return new aa(e.latitude,e.longitude)}}aa._jsonSchemaVersion="firestore/geoPoint/1.0",aa._jsonSchema={type:Ws("string",aa._jsonSchemaVersion),latitude:Ws("number"),longitude:Ws("number")};class xi{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(s,o){if(s.length!==o.length)return!1;for(let c=0;c<s.length;++c)if(s[c]!==o[c])return!1;return!0})(this._values,e._values)}toJSON(){return{type:xi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ql(e,xi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new xi(e.vectorValues);throw new Re(ue.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}xi._jsonSchemaVersion="firestore/vectorValue/1.0",xi._jsonSchema={type:Ws("string",xi._jsonSchemaVersion),vectorValues:Ws("object")};const lL=/^__.*__$/;class cL{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new Ha(e,this.data,this.fieldMask,t,this.fieldTransforms):new Su(e,this.data,t,this.fieldTransforms)}}class Pj{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return new Ha(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Mj(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw dt(40011,{dataSource:n})}}class Sp{constructor(e,t,s,o,c,u){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=o,c===void 0&&this.validatePath(),this.fieldTransforms=c||[],this.fieldMask=u||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Sp({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),s=this.contextWith({path:t,arrayElement:!1});return s.validatePathSegment(e),s}childContextForFieldPath(e){const t=this.path?.child(e),s=this.contextWith({path:t,arrayElement:!1});return s.validatePath(),s}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Qm(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(Mj(this.dataSource)&&lL.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class uL{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||Yl(e)}createContext(e,t,s,o=!1){return new Sp({dataSource:e,methodName:t,targetDoc:s,path:bs.emptyPath(),arrayElement:!1,hasConverter:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Jl(n){const e=n._freezeSettings(),t=Yl(n._databaseId);return new uL(n._databaseId,!!e.ignoreUndefinedProperties,t)}function jp(n,e,t,s,o,c={}){const u=n.createContext(c.merge||c.mergeFields?2:0,e,t,o);S0("Data must be an object, but it was:",u,s);const h=Oj(s,u);let m,g;if(c.merge)m=new Hr(u.fieldMask),g=u.fieldTransforms;else if(c.mergeFields){const b=[];for(const x of c.mergeFields){const T=Oa(e,x,t);if(!u.contains(T))throw new Re(ue.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);Uj(b,T)||b.push(T)}m=new Hr(b),g=u.fieldTransforms.filter((x=>m.covers(x.field)))}else m=null,g=u.fieldTransforms;return new cL(new ir(h),m,g)}class Rh extends Xl{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Rh}}function Lj(n,e,t){return new Sp({dataSource:3,targetDoc:e.settings.targetDoc,methodName:n._methodName,arrayElement:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class x0 extends Xl{_toFieldTransform(e){return new Sh(e.path,new uu)}isEqual(e){return e instanceof x0}}class _0 extends Xl{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=Lj(this,e,!0),s=this.Ac.map((c=>Zl(c,t))),o=new Ul(s);return new Sh(e.path,o)}isEqual(e){return e instanceof _0&&Li(this.Ac,e.Ac)}}class w0 extends Xl{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=Lj(this,e,!0),s=this.Ac.map((c=>Zl(c,t))),o=new Fl(s);return new Sh(e.path,o)}isEqual(e){return e instanceof w0&&Li(this.Ac,e.Ac)}}class T0 extends Xl{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new du(e.serializer,lS(e.serializer,this.Vc));return new Sh(e.path,t)}isEqual(e){return e instanceof T0&&this.Vc===e.Vc}}function k0(n,e,t,s){const o=n.createContext(1,e,t);S0("Data must be an object, but it was:",o,s);const c=[],u=ir.empty();Yo(s,((m,g)=>{const b=j0(e,m,t);g=jn(g);const x=o.childContextForFieldPath(b);if(g instanceof Rh)c.push(b);else{const T=Zl(g,x);T!=null&&(c.push(b),u.set(b,T))}}));const h=new Hr(c);return new Pj(u,h,o.fieldTransforms)}function E0(n,e,t,s,o,c){const u=n.createContext(1,e,t),h=[Oa(e,s,t)],m=[o];if(c.length%2!=0)throw new Re(ue.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<c.length;T+=2)h.push(Oa(e,c[T])),m.push(c[T+1]);const g=[],b=ir.empty();for(let T=h.length-1;T>=0;--T)if(!Uj(g,h[T])){const N=h[T];let B=m[T];B=jn(B);const P=u.childContextForFieldPath(N);if(B instanceof Rh)g.push(N);else{const M=Zl(B,P);M!=null&&(g.push(N),b.set(N,M))}}const x=new Hr(g);return new Pj(b,x,u.fieldTransforms)}function Vj(n,e,t,s=!1){return Zl(t,n.createContext(s?4:3,e))}function Zl(n,e){if(Bj(n=jn(n)))return S0("Unsupported field value:",e,n),Oj(n,e);if(n instanceof Xl)return(function(s,o){if(!Mj(o.dataSource))throw o.createError(`${s._methodName}() can only be used with update() and set()`);if(!o.path)throw o.createError(`${s._methodName}() is not currently supported inside arrays`);const c=s._toFieldTransform(o);c&&o.fieldTransforms.push(c)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(s,o){const c=[];let u=0;for(const h of s){let m=Zl(h,o.childContextForArray(u));m==null&&(m={nullValue:"NULL_VALUE"}),c.push(m),u++}return{arrayValue:{values:c}}})(n,e)}return(function(s,o){if((s=jn(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return lS(o.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const c=pt.fromDate(s);return{timestampValue:hu(o.serializer,c)}}if(s instanceof pt){const c=new pt(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:hu(o.serializer,c)}}if(s instanceof aa)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof ri)return{bytesValue:_S(o.serializer,s._byteString)};if(s instanceof es){const c=o.databaseId,u=s.firestore._databaseId;if(!u.isEqual(c))throw o.createError(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${c.projectId}/${c.database}`);return{referenceValue:$v(s.firestore._databaseId||o.databaseId,s._key.path)}}if(s instanceof xi)return(function(u,h){const m=u instanceof xi?u.toArray():u;return{mapValue:{fields:{[Pv]:{stringValue:Mv},[ou]:{arrayValue:{values:m.map((b=>{if(typeof b!="number")throw h.createError("VectorValues must only contain numeric values.");return Bv(h.serializer,b)}))}}}}}})(s,o);if(IS(s))return s._toProto(o.serializer);throw o.createError(`Unsupported field value: ${ap(s)}`)})(n,e)}function Oj(n,e){const t={};return ME(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Yo(n,((s,o)=>{const c=Zl(o,e.childContextForField(s));c!=null&&(t[s]=c)})),{mapValue:{fields:t}}}function Bj(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof pt||n instanceof aa||n instanceof ri||n instanceof es||n instanceof Xl||n instanceof xi||IS(n))}function S0(n,e,t){if(!Bj(t)||!gE(t)){const s=ap(t);throw s==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+s)}}function Oa(n,e,t){if((e=jn(e))instanceof Du)return e._internalPath;if(typeof e=="string")return j0(n,e);throw Qm("Field path arguments must be of type string or ",n,!1,void 0,t)}const dL=new RegExp("[~\\*/\\[\\]]");function j0(n,e,t){if(e.search(dL)>=0)throw Qm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Du(...e.split("."))._internalPath}catch{throw Qm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Qm(n,e,t,s,o){const c=s&&!s.isEmpty(),u=o!==void 0;let h=`Function ${e}() called with invalid data`;t&&(h+=" (via `toFirestore()`)"),h+=". ";let m="";return(c||u)&&(m+=" (found",c&&(m+=` in field ${s}`),u&&(m+=` in document ${o}`),m+=")"),new Re(ue.INVALID_ARGUMENT,h+n+m)}function Uj(n,e){return n.some((t=>t.isEqual(e)))}class Fj{convertValue(e,t="none"){switch(Fo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ys(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Va(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw dt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return Yo(e,((o,c)=>{s[o]=this.convertValue(c,t)})),s}convertVectorValue(e){const t=e.fields?.[ou].arrayValue?.values?.map((s=>ys(s.doubleValue)));return new xi(t)}convertGeoPoint(e){return new aa(ys(e.latitude),ys(e.longitude))}convertArray(e,t){return(e.values||[]).map((s=>this.convertValue(s,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const s=hp(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(rh(e));default:return null}}convertTimestamp(e){const t=La(e);return new pt(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=fn.fromString(e);gt(RS(s),9688,{name:e});const o=new Vl(s.get(1),s.get(3)),c=new Je(s.popFirst(5));return o.isEqual(t)||Vs(`Document ${c} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),c}}class Zo extends Fj{constructor(e){super(),this.firestore=e}convertBytes(e){return new ri(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new es(this.firestore,null,t)}}function tB(){return new Rh("deleteField")}function vi(){return new x0("serverTimestamp")}function nB(...n){return new _0("arrayUnion",n)}function sB(...n){return new w0("arrayRemove",n)}function Nl(n){return new T0("increment",n)}function rB(n){return new xi(n)}function iB(n){const e=Ts(yn(n.firestore,is)),t=e._onlineComponents?.datastore.serializer;return t===void 0?null:yp(t,kr(n._query)).ft}function aB(n,e){const t=PE(e,((c,u)=>new pS(u,c.aggregateType,c._internalFieldPath))),s=Ts(yn(n.firestore,is)),o=s._onlineComponents?.datastore.serializer;return o===void 0?null:jS(o,ZE(n._query),t,!0).request}const TT="@firebase/firestore",kT="4.10.0";function Jc(n){return(function(t,s){if(typeof t!="object"||t===null)return!1;const o=t;for(const c of s)if(c in o&&typeof o[c]=="function")return!0;return!1})(n,["next","error","complete"])}class dh{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class hL{constructor(e,t,s){this._userDataWriter=t,this._data=s,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}_fieldsProto(){return new ir({mapValue:{fields:this._data}}).clone().value.mapValue.fields}}class hh{constructor(e,t,s,o,c){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=o,this._converter=c}get id(){return this._key.path.lastSegment()}get ref(){return new es(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new fL(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(Oa("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class fL extends hh{data(){return super.data()}}function zj(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Re(ue.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class N0{}class Ih extends N0{}function Dn(n,e,...t){let s=[];e instanceof N0&&s.push(e),s=s.concat(t),(function(c){const u=c.filter((m=>m instanceof Pu)).length,h=c.filter((m=>m instanceof Dh)).length;if(u>1||u>0&&h>0)throw new Re(ue.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(s);for(const o of s)n=o._apply(n);return n}class Dh extends Ih{constructor(e,t,s){super(),this._field=e,this._op=t,this._value=s,this.type="where"}static _create(e,t,s){return new Dh(e,t,s)}_apply(e){const t=this._parse(e);return Hj(e._query,t),new or(e.firestore,e.converter,Fb(e._query,t))}_parse(e){const t=Jl(e.firestore);return(function(c,u,h,m,g,b,x){let T;if(g.isKeyField()){if(b==="array-contains"||b==="array-contains-any")throw new Re(ue.INVALID_ARGUMENT,`Invalid Query. You can't perform '${b}' queries on documentId().`);if(b==="in"||b==="not-in"){ST(x,b);const B=[];for(const P of x)B.push(ET(m,c,P));T={arrayValue:{values:B}}}else T=ET(m,c,x)}else b!=="in"&&b!=="not-in"&&b!=="array-contains-any"||ST(x,b),T=Vj(h,u,x,b==="in"||b==="not-in");return Tn.create(g,b,T)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function hn(n,e,t){const s=e,o=Oa("where",n);return Dh._create(o,s,t)}class Pu extends N0{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Pu(e,t)}_parse(e){const t=this._queryConstraints.map((s=>s._parse(e))).filter((s=>s.getFilters().length>0));return t.length===1?t[0]:Kn.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(o,c){let u=o;const h=c.getFlattenedFilters();for(const m of h)Hj(u,m),u=Fb(u,m)})(e._query,t),new or(e.firestore,e.converter,Fb(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function oB(...n){return n.forEach((e=>$j("or",e))),Pu._create("or",n)}function lB(...n){return n.forEach((e=>$j("and",e))),Pu._create("and",n)}class C0 extends Ih{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new C0(e,t)}_apply(e){const t=(function(o,c,u){if(o.startAt!==null)throw new Re(ue.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(o.endAt!==null)throw new Re(ue.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new lh(c,u)})(e._query,this._field,this._direction);return new or(e.firestore,e.converter,RM(e._query,t))}}function Ym(n,e="asc"){const t=e,s=Oa("orderBy",n);return C0._create(s,t)}class Np extends Ih{constructor(e,t,s){super(),this.type=e,this._limit=t,this._limitType=s}static _create(e,t,s){return new Np(e,t,s)}_apply(e){return new or(e.firestore,e.converter,Um(e._query,this._limit,this._limitType))}}function Xm(n){return yE("limit",n),Np._create("limit",n,"F")}function cB(n){return yE("limitToLast",n),Np._create("limitToLast",n,"L")}class Cp extends Ih{constructor(e,t,s){super(),this.type=e,this._docOrFields=t,this._inclusive=s}static _create(e,t,s){return new Cp(e,t,s)}_apply(e){const t=qj(e,this.type,this._docOrFields,this._inclusive);return new or(e.firestore,e.converter,IM(e._query,t))}}function uB(...n){return Cp._create("startAt",n,!0)}function dB(...n){return Cp._create("startAfter",n,!1)}class Ap extends Ih{constructor(e,t,s){super(),this.type=e,this._docOrFields=t,this._inclusive=s}static _create(e,t,s){return new Ap(e,t,s)}_apply(e){const t=qj(e,this.type,this._docOrFields,this._inclusive);return new or(e.firestore,e.converter,DM(e._query,t))}}function hB(...n){return Ap._create("endBefore",n,!1)}function fB(...n){return Ap._create("endAt",n,!0)}function qj(n,e,t,s){if(t[0]=jn(t[0]),t[0]instanceof hh)return(function(c,u,h,m,g){if(!m)throw new Re(ue.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${h}().`);const b=[];for(const x of Yc(c))if(x.field.isKeyField())b.push(Ol(u,m.key));else{const T=m.data.field(x.field);if(dp(T))throw new Re(ue.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+x.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(T===null){const N=x.field.canonicalString();throw new Re(ue.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${N}' (used as the orderBy) does not exist.`)}b.push(T)}return new qo(b,g)})(n._query,n.firestore._databaseId,e,t[0]._document,s);{const o=Jl(n.firestore);return(function(u,h,m,g,b,x){const T=u.explicitOrderBy;if(b.length>T.length)throw new Re(ue.INVALID_ARGUMENT,`Too many arguments provided to ${g}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const N=[];for(let B=0;B<b.length;B++){const P=b[B];if(T[B].field.isKeyField()){if(typeof P!="string")throw new Re(ue.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${g}(), but got a ${typeof P}`);if(!Vv(u)&&P.indexOf("/")!==-1)throw new Re(ue.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${g}() must be a plain document ID, but '${P}' contains a slash.`);const M=u.path.child(fn.fromString(P));if(!Je.isDocumentKey(M))throw new Re(ue.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${g}() must result in a valid document path, but '${M}' is not because it contains an odd number of segments.`);const Y=new Je(M);N.push(Ol(h,Y))}else{const M=Vj(m,g,P);N.push(M)}}return new qo(N,x)})(n._query,n.firestore._databaseId,o,e,t,s)}}function ET(n,e,t){if(typeof(t=jn(t))=="string"){if(t==="")throw new Re(ue.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Vv(e)&&t.indexOf("/")!==-1)throw new Re(ue.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const s=e.path.child(fn.fromString(t));if(!Je.isDocumentKey(s))throw new Re(ue.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return Ol(n,new Je(s))}if(t instanceof es)return Ol(n,t._key);throw new Re(ue.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ap(t)}.`)}function ST(n,e){if(!Array.isArray(n)||n.length===0)throw new Re(ue.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Hj(n,e){const t=(function(o,c){for(const u of o)for(const h of u.getFlattenedFilters())if(c.indexOf(h.op)>=0)return h.op;return null})(n.filters,(function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Re(ue.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Re(ue.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function $j(n,e){if(!(e instanceof Dh||e instanceof Pu))throw new Re(ue.INVALID_ARGUMENT,`Function ${n}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}function Rp(n,e,t){let s;return s=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,s}class A0 extends Fj{constructor(e){super(),this.firestore=e}convertBytes(e){return new ri(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new es(this.firestore,null,t)}}function mB(n){return new dh("sum",Oa("sum",n))}function pB(n){return new dh("avg",Oa("average",n))}function mL(){return new dh("count")}function gB(n,e){return n instanceof dh&&e instanceof dh&&n.aggregateType===e.aggregateType&&n._internalFieldPath?.canonicalString()===e._internalFieldPath?.canonicalString()}function yB(n,e){return Rj(n.query,e.query)&&Li(n.data(),e.data())}function bB(n){return pL(n,{count:mL()})}function pL(n,e){const t=yn(n.firestore,is),s=Ts(t),o=PE(e,((c,u)=>new pS(u,c.aggregateType,c._internalFieldPath)));return G6(s,n._query,o).then((c=>(function(h,m,g){const b=new Zo(h);return new hL(m,b,g)})(t,n,c)))}class gL{constructor(e){this.kind="memory",this._onlineComponentProvider=$o.provider,this._offlineComponentProvider=e?.garbageCollector?e.garbageCollector._offlineComponentProvider:{build:()=>new g0(void 0)}}toJSON(){return{kind:this.kind}}}class yL{constructor(e){let t;this.kind="persistent",e?.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=wL(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class bL{constructor(){this.kind="memoryEager",this._offlineComponentProvider=yu.provider}toJSON(){return{kind:this.kind}}}class vL{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new g0(e)}}toJSON(){return{kind:this.kind}}}function vB(){return new bL}function xB(n){return new vL(n?.cacheSizeBytes)}function _B(n){return new gL(n)}function wB(n){return new yL(n)}class xL{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=$o.provider,this._offlineComponentProvider={build:t=>new y0(t,e?.cacheSizeBytes,this.forceOwnership)}}}class _L{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=$o.provider,this._offlineComponentProvider={build:t=>new wj(t,e?.cacheSizeBytes)}}}function wL(n){return new xL(n?.forceOwnership)}function TB(){return new _L}const Wj="NOT SUPPORTED";class Ro{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ii extends hh{constructor(e,t,s,o,c,u){super(e,t,s,o,u),this._firestore=e,this._firestoreImpl=e,this.metadata=c}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Tm(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(Oa("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Re(ue.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=ii._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}function kB(n,e,t){if(Ql(e,ii._jsonSchema)){if(e.bundle===Wj)throw new Re(ue.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");const s=Yl(n._databaseId),o=Nj(e.bundle,s),c=o.t(),u=new u0(o.getMetadata(),s);for(const b of c)u.o(b);const h=u.documents;if(h.length!==1)throw new Re(ue.INVALID_ARGUMENT,`Expected bundle data to contain 1 document, but it contains ${h.length} documents.`);const m=gp(s,h[0].document),g=new Je(fn.fromString(e.bundleName));return new ii(n,new A0(n),g,m,new Ro(!1,!1),t||null)}}ii._jsonSchemaVersion="firestore/documentSnapshot/1.0",ii._jsonSchema={type:Ws("string",ii._jsonSchemaVersion),bundleSource:Ws("string","DocumentSnapshot"),bundleName:Ws("string"),bundle:Ws("string")};class Tm extends ii{data(e={}){return super.data(e)}}class ai{constructor(e,t,s,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new Ro(o.hasPendingWrites,o.fromCache),this.query=s}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((s=>{e.call(t,new Tm(this._firestore,this._userDataWriter,s.key,s,new Ro(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Re(ue.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(o,c){if(o._snapshot.oldDocs.isEmpty()){let u=0;return o._snapshot.docChanges.map((h=>{const m=new Tm(o._firestore,o._userDataWriter,h.doc.key,h.doc,new Ro(o._snapshot.mutatedKeys.has(h.doc.key),o._snapshot.fromCache),o.query.converter);return h.doc,{type:"added",doc:m,oldIndex:-1,newIndex:u++}}))}{let u=o._snapshot.oldDocs;return o._snapshot.docChanges.filter((h=>c||h.type!==3)).map((h=>{const m=new Tm(o._firestore,o._userDataWriter,h.doc.key,h.doc,new Ro(o._snapshot.mutatedKeys.has(h.doc.key),o._snapshot.fromCache),o.query.converter);let g=-1,b=-1;return h.type!==0&&(g=u.indexOf(h.doc.key),u=u.delete(h.doc.key)),h.type!==1&&(u=u.add(h.doc),b=u.indexOf(h.doc.key)),{type:TL(h.type),doc:m,oldIndex:g,newIndex:b}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Re(ue.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ai._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Sv.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],s=[],o=[];return this.docs.forEach((c=>{c._document!==null&&(t.push(c._document),s.push(this._userDataWriter.convertObjectMap(c._document.data.value.mapValue.fields,"previous")),o.push(c.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function EB(n,e,t){if(Ql(e,ai._jsonSchema)){if(e.bundle===Wj)throw new Re(ue.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");const s=Yl(n._databaseId),o=Nj(e.bundle,s),c=o.t(),u=new u0(o.getMetadata(),s);for(const T of c)u.o(T);if(u.queries.length!==1)throw new Re(ue.INVALID_ARGUMENT,`Snapshot data expected 1 query but found ${u.queries.length} queries.`);const h=bp(u.queries[0].bundledQuery),m=u.documents;let g=new Rl;m.map((T=>{const N=gp(s,T.document);g=g.add(N)}));const b=Wl.fromInitialDocuments(h,g,tn(),!1,!1),x=new or(n,t||null,h);return new ai(n,new A0(n),x,b)}}function TL(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return dt(61501,{type:n})}}function SB(n,e){return n instanceof ii&&e instanceof ii?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof ai&&e instanceof ai&&n._firestore===e._firestore&&Rj(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}ai._jsonSchemaVersion="firestore/querySnapshot/1.0",ai._jsonSchema={type:Ws("string",ai._jsonSchemaVersion),bundleSource:Ws("string","QuerySnapshot"),bundleName:Ws("string"),bundle:Ws("string")};const kL={maxAttempts:5};class EL{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Jl(e)}set(e,t,s){this._verifyNotCommitted();const o=Io(e,this._firestore),c=Rp(o.converter,t,s),u=jp(this._dataReader,"WriteBatch.set",o._key,c,o.converter!==null,s);return this._mutations.push(u.toMutation(o._key,vs.none())),this}update(e,t,s,...o){this._verifyNotCommitted();const c=Io(e,this._firestore);let u;return u=typeof(t=jn(t))=="string"||t instanceof Du?E0(this._dataReader,"WriteBatch.update",c._key,t,s,o):k0(this._dataReader,"WriteBatch.update",c._key,t),this._mutations.push(u.toMutation(c._key,vs.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Io(e,this._firestore);return this._mutations=this._mutations.concat(new ju(t._key,vs.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Re(ue.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Io(n,e){if((n=jn(n)).firestore!==e)throw new Re(ue.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class SL{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Jl(e)}get(e){const t=Io(e,this._firestore),s=new A0(this._firestore);return this._transaction.lookup([t._key]).then((o=>{if(!o||o.length!==1)return dt(24041);const c=o[0];if(c.isFoundDocument())return new hh(this._firestore,s,c.key,c,t.converter);if(c.isNoDocument())return new hh(this._firestore,s,t._key,null,t.converter);throw dt(18433,{doc:c})}))}set(e,t,s){const o=Io(e,this._firestore),c=Rp(o.converter,t,s),u=jp(this._dataReader,"Transaction.set",o._key,c,o.converter!==null,s);return this._transaction.set(o._key,u),this}update(e,t,s,...o){const c=Io(e,this._firestore);let u;return u=typeof(t=jn(t))=="string"||t instanceof Du?E0(this._dataReader,"Transaction.update",c._key,t,s,o):k0(this._dataReader,"Transaction.update",c._key,t),this._transaction.update(c._key,u),this}delete(e){const t=Io(e,this._firestore);return this._transaction.delete(t._key),this}}class jL extends SL{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Io(e,this._firestore),s=new Zo(this._firestore);return super.get(e).then((o=>new ii(this._firestore,s,t._key,o._document,new Ro(!1,!1),t.converter)))}}function jB(n,e,t){n=yn(n,is);const s={...kL,...t};(function(u){if(u.maxAttempts<1)throw new Re(ue.INVALID_ARGUMENT,"Max attempts must be at least 1")})(s);const o=Ts(n);return Y6(o,(c=>e(new jL(n,c))),s)}function Pn(n){n=yn(n,es);const e=yn(n.firestore,is),t=Ts(e);return Sj(t,n._key).then((s=>R0(e,n,s)))}function NB(n){n=yn(n,es);const e=yn(n.firestore,is),t=Ts(e),s=new Zo(e);return $6(t,n._key).then((o=>new ii(e,s,n._key,o,new Ro(o!==null&&o.hasLocalMutations,!0),n.converter)))}function CB(n){n=yn(n,es);const e=yn(n.firestore,is),t=Ts(e);return Sj(t,n._key,{source:"server"}).then((s=>R0(e,n,s)))}function Sn(n){n=yn(n,or);const e=yn(n.firestore,is),t=Ts(e),s=new Zo(e);return zj(n._query),jj(t,n._query).then((o=>new ai(e,s,n,o)))}function AB(n){n=yn(n,or);const e=yn(n.firestore,is),t=Ts(e),s=new Zo(e);return W6(t,n._query).then((o=>new ai(e,s,n,o)))}function RB(n){n=yn(n,or);const e=yn(n.firestore,is),t=Ts(e),s=new Zo(e);return jj(t,n._query,{source:"server"}).then((o=>new ai(e,s,n,o)))}function zn(n,e,t){n=yn(n,es);const s=yn(n.firestore,is),o=Rp(n.converter,e,t),c=Jl(s);return Ph(s,[jp(c,"setDoc",n._key,o,n.converter!==null,t).toMutation(n._key,vs.none())])}function Sa(n,e,t,...s){n=yn(n,es);const o=yn(n.firestore,is),c=Jl(o);let u;return u=typeof(e=jn(e))=="string"||e instanceof Du?E0(c,"updateDoc",n._key,e,t,s):k0(c,"updateDoc",n._key,e),Ph(o,[u.toMutation(n._key,vs.exists(!0))])}function Rr(n){return Ph(yn(n.firestore,is),[new ju(n._key,vs.none())])}function Ia(n,e){const t=yn(n.firestore,is),s=Ge(n),o=Rp(n.converter,e),c=Jl(n.firestore);return Ph(t,[jp(c,"addDoc",s._key,o,n.converter!==null,{}).toMutation(s._key,vs.exists(!1))]).then((()=>s))}function Jm(n,...e){n=jn(n);let t={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||Jc(e[s])||(t=e[s++]);const o={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Jc(e[s])){const g=e[s];e[s]=g.next?.bind(g),e[s+1]=g.error?.bind(g),e[s+2]=g.complete?.bind(g)}let c,u,h;if(n instanceof es)u=yn(n.firestore,is),h=Eu(n._key.path),c={next:g=>{e[s]&&e[s](R0(u,n,g))},error:e[s+1],complete:e[s+2]};else{const g=yn(n,or);u=yn(g.firestore,is),h=g._query;const b=new Zo(u);c={next:x=>{e[s]&&e[s](new ai(u,b,g,x))},error:e[s+1],complete:e[s+2]},zj(n._query)}const m=Ts(u);return H6(m,h,o,c)}function IB(n,e,...t){const s=jn(n),o=(function(m){const g={bundle:"",bundleName:"",bundleSource:""},b=["bundle","bundleName","bundleSource"];for(const x of b){if(!(x in m)){g.error=`snapshotJson missing required field: ${x}`;break}const T=m[x];if(typeof T!="string"){g.error=`snapshotJson field '${x}' must be a string.`;break}if(T.length===0){g.error=`snapshotJson field '${x}' cannot be an empty string.`;break}x==="bundle"?g.bundle=T:x==="bundleName"?g.bundleName=T:x==="bundleSource"&&(g.bundleSource=T)}return g})(e);if(o.error)throw new Re(ue.INVALID_ARGUMENT,o.error);let c,u=0;if(typeof t[u]!="object"||Jc(t[u])||(c=t[u++]),o.bundleSource==="QuerySnapshot"){let h=null;if(typeof t[u]=="object"&&Jc(t[u])){const m=t[u++];h={next:m.next,error:m.error,complete:m.complete}}else h={next:t[u++],error:t[u++],complete:t[u++]};return(function(g,b,x,T,N){let B,P=!1;return wT(g,b.bundle).then((()=>oL(g,b.bundleName))).then((Y=>{Y&&!P&&(N&&Y.withConverter(N),B=Jm(Y,x||{},T))})).catch((Y=>(T.error&&T.error(Y),()=>{}))),()=>{P||(P=!0,B&&B())}})(s,o,c,h,t[u])}if(o.bundleSource==="DocumentSnapshot"){let h=null;if(typeof t[u]=="object"&&Jc(t[u])){const m=t[u++];h={next:m.next,error:m.error,complete:m.complete}}else h={next:t[u++],error:t[u++],complete:t[u++]};return(function(g,b,x,T,N){let B,P=!1;return wT(g,b.bundle).then((()=>{if(!P){const Y=new es(g,N||null,Je.fromPath(b.bundleName));B=Jm(Y,x||{},T)}})).catch((Y=>(T.error&&T.error(Y),()=>{}))),()=>{P||(P=!0,B&&B())}})(s,o,c,h,t[u])}throw new Re(ue.INVALID_ARGUMENT,`unsupported bundle source: ${o.bundleSource}`)}function DB(n,e){n=yn(n,is);const t=Ts(n),s=Jc(e)?e:{next:e};return Q6(t,s)}function Ph(n,e){const t=Ts(n);return K6(t,e)}function R0(n,e,t){const s=t.docs.get(e._key),o=new Zo(n);return new ii(n,o,e._key,s,new Ro(t.hasPendingWrites,t.fromCache),e.converter)}function jT(n){return n=yn(n,is),Ts(n),new EL(n,(e=>Ph(n,e)))}function PB(n,e){n=yn(n,is);const t=Ts(n);if(!t._uninitializedComponentsProvider||t._uninitializedComponentsProvider._offline.kind==="memory")return wi("Cannot enable indexes when persistence is disabled"),Promise.resolve();const s=(function(c){const u=typeof c=="string"?(function(g){try{return JSON.parse(g)}catch(b){throw new Re(ue.INVALID_ARGUMENT,"Failed to parse JSON: "+b?.message)}})(c):c,h=[];if(Array.isArray(u.indexes))for(const m of u.indexes){const g=NT(m,"collectionGroup"),b=[];if(Array.isArray(m.fields))for(const x of m.fields){const T=NT(x,"fieldPath"),N=j0("setIndexConfiguration",T);x.arrayConfig==="CONTAINS"?b.push(new Cl(N,2)):x.order==="ASCENDING"?b.push(new Cl(N,0)):x.order==="DESCENDING"&&b.push(new Cl(N,1))}h.push(new tu(tu.UNKNOWN_ID,g,b,nu.empty()))}return h})(e);return Z6(t,s)}function NT(n,e){if(typeof n[e]!="string")throw new Re(ue.INVALID_ARGUMENT,"Missing string value for: "+e);return n[e]}class NL{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}}function MB(n){n=yn(n,is);const e=CT.get(n);if(e)return e;if(Ts(n)._uninitializedComponentsProvider?._offline.kind!=="persistent")return null;const s=new NL(n);return CT.set(n,s),s}function LB(n){Gj(n,!0)}function VB(n){Gj(n,!1)}function OB(n){const e=Ts(n._firestore);tL(e).then((t=>Ve("deleting all persistent cache indexes succeeded"))).catch((t=>wi("deleting all persistent cache indexes failed",t)))}function Gj(n,e){const t=Ts(n._firestore);eL(t,e).then((s=>Ve(`setting persistent cache index auto creation isEnabled=${e} succeeded`))).catch((s=>wi(`setting persistent cache index auto creation isEnabled=${e} failed`,s)))}const CT=new WeakMap;class BB{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return I0.instance.onExistenceFilterMismatch(e)}}class I0{constructor(){this.i=new Map}static get instance(){return Zf||(Zf=new I0,WM(Zf)),Zf}u(e){this.i.forEach((t=>t(e)))}onExistenceFilterMismatch(e){const t=Symbol(),s=this.i;return s.set(t,e),()=>s.delete(t)}}let Zf=null;(function(e,t=!0){jP(Kl),Pl(new Bo("firestore",((s,{instanceIdentifier:o,options:c})=>{const u=s.getProvider("app").getImmediate(),h=new is(new AP(s.getProvider("auth-internal")),new DP(u,s.getProvider("app-check-internal")),vM(u,o),u);return c={useFetchStreams:t,...c},h._setSettings(c),h}),"PUBLIC").setMultipleInstances(!0)),ea(TT,kT,e),ea(TT,kT,"esm2020")})();var CL="firebase",AL="12.8.0";ea(CL,AL,"app");const Kj="firebasestorage.googleapis.com",Qj="storageBucket",RL=120*1e3,IL=600*1e3;class Is extends la{constructor(e,t,s=0){super(Jy(e),`Firebase Storage: ${t} (${Jy(e)})`),this.status_=s,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Is.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Jy(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Rs;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Rs||(Rs={}));function Jy(n){return"storage/"+n}function D0(){const n="An unknown error occurred, please check the error payload for server response.";return new Is(Rs.UNKNOWN,n)}function DL(n){return new Is(Rs.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function PL(n){return new Is(Rs.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function ML(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Is(Rs.UNAUTHENTICATED,n)}function LL(){return new Is(Rs.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function VL(n){return new Is(Rs.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function OL(){return new Is(Rs.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function BL(){return new Is(Rs.CANCELED,"User canceled the upload/download.")}function UL(n){return new Is(Rs.INVALID_URL,"Invalid URL '"+n+"'.")}function FL(n){return new Is(Rs.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function zL(){return new Is(Rs.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Qj+"' property when initializing the app?")}function qL(){return new Is(Rs.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function HL(){return new Is(Rs.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function $L(n){return new Is(Rs.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function tv(n){return new Is(Rs.INVALID_ARGUMENT,n)}function Yj(){return new Is(Rs.APP_DELETED,"The Firebase app was deleted.")}function WL(n){return new Is(Rs.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Gd(n,e){return new Is(Rs.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function jd(n){throw new Is(Rs.INTERNAL_ERROR,"Internal error: "+n)}class Ir{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let s;try{s=Ir.makeFromUrl(e,t)}catch{return new Ir(e,"")}if(s.path==="")return s;throw FL(e)}static makeFromUrl(e,t){let s=null;const o="([A-Za-z0-9.\\-_]+)";function c(fe){fe.path.charAt(fe.path.length-1)==="/"&&(fe.path_=fe.path_.slice(0,-1))}const u="(/(.*))?$",h=new RegExp("^gs://"+o+u,"i"),m={bucket:1,path:3};function g(fe){fe.path_=decodeURIComponent(fe.path)}const b="v[A-Za-z0-9_]+",x=t.replace(/[.]/g,"\\."),T="(/([^?#]*).*)?$",N=new RegExp(`^https?://${x}/${b}/b/${o}/o${T}`,"i"),B={bucket:1,path:3},P=t===Kj?"(?:storage.googleapis.com|storage.cloud.google.com)":t,M="([^?#]*)",Y=new RegExp(`^https?://${P}/${o}/${M}`,"i"),X=[{regex:h,indices:m,postModify:c},{regex:N,indices:B,postModify:g},{regex:Y,indices:{bucket:1,path:2},postModify:g}];for(let fe=0;fe<X.length;fe++){const je=X[fe],Te=je.regex.exec(e);if(Te){const C=Te[je.indices.bucket];let S=Te[je.indices.path];S||(S=""),s=new Ir(C,S),je.postModify(s);break}}if(s==null)throw UL(e);return s}}class GL{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function KL(n,e,t){let s=1,o=null,c=null,u=!1,h=0;function m(){return h===2}let g=!1;function b(...M){g||(g=!0,e.apply(null,M))}function x(M){o=setTimeout(()=>{o=null,n(N,m())},M)}function T(){c&&clearTimeout(c)}function N(M,...Y){if(g){T();return}if(M){T(),b.call(null,M,...Y);return}if(m()||u){T(),b.call(null,M,...Y);return}s<64&&(s*=2);let X;h===1?(h=2,X=0):X=(s+Math.random())*1e3,x(X)}let B=!1;function P(M){B||(B=!0,T(),!g&&(o!==null?(M||(h=2),clearTimeout(o),x(0)):M||(h=1)))}return x(0),c=setTimeout(()=>{u=!0,P(!0)},t),P}function QL(n){n(!1)}function YL(n){return n!==void 0}function XL(n){return typeof n=="object"&&!Array.isArray(n)}function P0(n){return typeof n=="string"||n instanceof String}function AT(n){return M0()&&n instanceof Blob}function M0(){return typeof Blob<"u"}function nv(n,e,t,s){if(s<e)throw tv(`Invalid value for '${n}'. Expected ${e} or greater.`);if(s>t)throw tv(`Invalid value for '${n}'. Expected ${t} or less.`)}function Ip(n,e,t){let s=e;return t==null&&(s=`https://${e}`),`${t}://${s}/v0${n}`}function Xj(n){const e=encodeURIComponent;let t="?";for(const s in n)if(n.hasOwnProperty(s)){const o=e(s)+"="+e(n[s]);t=t+o+"&"}return t=t.slice(0,-1),t}var Il;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Il||(Il={}));function JL(n,e){const t=n>=500&&n<600,o=[408,429].indexOf(n)!==-1,c=e.indexOf(n)!==-1;return t||o||c}class ZL{constructor(e,t,s,o,c,u,h,m,g,b,x,T=!0,N=!1){this.url_=e,this.method_=t,this.headers_=s,this.body_=o,this.successCodes_=c,this.additionalRetryCodes_=u,this.callback_=h,this.errorCallback_=m,this.timeout_=g,this.progressCallback_=b,this.connectionFactory_=x,this.retry=T,this.isUsingEmulator=N,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((B,P)=>{this.resolve_=B,this.reject_=P,this.start_()})}start_(){const e=(s,o)=>{if(o){s(!1,new em(!1,null,!0));return}const c=this.connectionFactory_();this.pendingConnection_=c;const u=h=>{const m=h.loaded,g=h.lengthComputable?h.total:-1;this.progressCallback_!==null&&this.progressCallback_(m,g)};this.progressCallback_!==null&&c.addUploadProgressListener(u),c.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&c.removeUploadProgressListener(u),this.pendingConnection_=null;const h=c.getErrorCode()===Il.NO_ERROR,m=c.getStatus();if(!h||JL(m,this.additionalRetryCodes_)&&this.retry){const b=c.getErrorCode()===Il.ABORT;s(!1,new em(!1,null,b));return}const g=this.successCodes_.indexOf(m)!==-1;s(!0,new em(g,c))})},t=(s,o)=>{const c=this.resolve_,u=this.reject_,h=o.connection;if(o.wasSuccessCode)try{const m=this.callback_(h,h.getResponse());YL(m)?c(m):c()}catch(m){u(m)}else if(h!==null){const m=D0();m.serverResponse=h.getErrorText(),this.errorCallback_?u(this.errorCallback_(h,m)):u(m)}else if(o.canceled){const m=this.appDelete_?Yj():BL();u(m)}else{const m=OL();u(m)}};this.canceled_?t(!1,new em(!1,null,!0)):this.backoffId_=KL(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&QL(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class em{constructor(e,t,s){this.wasSuccessCode=e,this.connection=t,this.canceled=!!s}}function e5(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function t5(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function n5(n,e){e&&(n["X-Firebase-GMPID"]=e)}function s5(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function r5(n,e,t,s,o,c,u=!0,h=!1){const m=Xj(n.urlParams),g=n.url+m,b=Object.assign({},n.headers);return n5(b,e),e5(b,t),t5(b,c),s5(b,s),new ZL(g,n.method,b,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,o,u,h)}function i5(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function a5(...n){const e=i5();if(e!==void 0){const t=new e;for(let s=0;s<n.length;s++)t.append(n[s]);return t.getBlob()}else{if(M0())return new Blob(n);throw new Is(Rs.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function o5(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function l5(n){if(typeof atob>"u")throw $L("base-64");return atob(n)}const Zi={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Zy{constructor(e,t){this.data=e,this.contentType=t||null}}function c5(n,e){switch(n){case Zi.RAW:return new Zy(Jj(e));case Zi.BASE64:case Zi.BASE64URL:return new Zy(Zj(n,e));case Zi.DATA_URL:return new Zy(d5(e),h5(e))}throw D0()}function Jj(n){const e=[];for(let t=0;t<n.length;t++){let s=n.charCodeAt(t);if(s<=127)e.push(s);else if(s<=2047)e.push(192|s>>6,128|s&63);else if((s&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const c=s,u=n.charCodeAt(++t);s=65536|(c&1023)<<10|u&1023,e.push(240|s>>18,128|s>>12&63,128|s>>6&63,128|s&63)}else(s&64512)===56320?e.push(239,191,189):e.push(224|s>>12,128|s>>6&63,128|s&63)}return new Uint8Array(e)}function u5(n){let e;try{e=decodeURIComponent(n)}catch{throw Gd(Zi.DATA_URL,"Malformed data URL.")}return Jj(e)}function Zj(n,e){switch(n){case Zi.BASE64:{const o=e.indexOf("-")!==-1,c=e.indexOf("_")!==-1;if(o||c)throw Gd(n,"Invalid character '"+(o?"-":"_")+"' found: is it base64url encoded?");break}case Zi.BASE64URL:{const o=e.indexOf("+")!==-1,c=e.indexOf("/")!==-1;if(o||c)throw Gd(n,"Invalid character '"+(o?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=l5(e)}catch(o){throw o.message.includes("polyfill")?o:Gd(n,"Invalid character found")}const s=new Uint8Array(t.length);for(let o=0;o<t.length;o++)s[o]=t.charCodeAt(o);return s}class eN{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw Gd(Zi.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const s=t[1]||null;s!=null&&(this.base64=f5(s,";base64"),this.contentType=this.base64?s.substring(0,s.length-7):s),this.rest=e.substring(e.indexOf(",")+1)}}function d5(n){const e=new eN(n);return e.base64?Zj(Zi.BASE64,e.rest):u5(e.rest)}function h5(n){return new eN(n).contentType}function f5(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}class Co{constructor(e,t){let s=0,o="";AT(e)?(this.data_=e,s=e.size,o=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),s=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),s=e.length),this.size_=s,this.type_=o}size(){return this.size_}type(){return this.type_}slice(e,t){if(AT(this.data_)){const s=this.data_,o=o5(s,e,t);return o===null?null:new Co(o)}else{const s=new Uint8Array(this.data_.buffer,e,t-e);return new Co(s,!0)}}static getBlob(...e){if(M0()){const t=e.map(s=>s instanceof Co?s.data_:s);return new Co(a5.apply(null,t))}else{const t=e.map(u=>P0(u)?c5(Zi.RAW,u).data:u.data_);let s=0;t.forEach(u=>{s+=u.byteLength});const o=new Uint8Array(s);let c=0;return t.forEach(u=>{for(let h=0;h<u.length;h++)o[c++]=u[h]}),new Co(o,!0)}}uploadData(){return this.data_}}function L0(n){let e;try{e=JSON.parse(n)}catch{return null}return XL(e)?e:null}function m5(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function p5(n,e){const t=e.split("/").filter(s=>s.length>0).join("/");return n.length===0?t:n+"/"+t}function tN(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function g5(n,e){return e}class Ar{constructor(e,t,s,o){this.server=e,this.local=t||e,this.writable=!!s,this.xform=o||g5}}let tm=null;function y5(n){return!P0(n)||n.length<2?n:tN(n)}function nN(){if(tm)return tm;const n=[];n.push(new Ar("bucket")),n.push(new Ar("generation")),n.push(new Ar("metageneration")),n.push(new Ar("name","fullPath",!0));function e(c,u){return y5(u)}const t=new Ar("name");t.xform=e,n.push(t);function s(c,u){return u!==void 0?Number(u):u}const o=new Ar("size");return o.xform=s,n.push(o),n.push(new Ar("timeCreated")),n.push(new Ar("updated")),n.push(new Ar("md5Hash",null,!0)),n.push(new Ar("cacheControl",null,!0)),n.push(new Ar("contentDisposition",null,!0)),n.push(new Ar("contentEncoding",null,!0)),n.push(new Ar("contentLanguage",null,!0)),n.push(new Ar("contentType",null,!0)),n.push(new Ar("metadata","customMetadata",!0)),tm=n,tm}function b5(n,e){function t(){const s=n.bucket,o=n.fullPath,c=new Ir(s,o);return e._makeStorageReference(c)}Object.defineProperty(n,"ref",{get:t})}function v5(n,e,t){const s={};s.type="file";const o=t.length;for(let c=0;c<o;c++){const u=t[c];s[u.local]=u.xform(s,e[u.server])}return b5(s,n),s}function sN(n,e,t){const s=L0(e);return s===null?null:v5(n,s,t)}function x5(n,e,t,s){const o=L0(e);if(o===null||!P0(o.downloadTokens))return null;const c=o.downloadTokens;if(c.length===0)return null;const u=encodeURIComponent;return c.split(",").map(g=>{const b=n.bucket,x=n.fullPath,T="/b/"+u(b)+"/o/"+u(x),N=Ip(T,t,s),B=Xj({alt:"media",token:g});return N+B})[0]}function _5(n,e){const t={},s=e.length;for(let o=0;o<s;o++){const c=e[o];c.writable&&(t[c.server]=n[c.local])}return JSON.stringify(t)}const RT="prefixes",IT="items";function w5(n,e,t){const s={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[RT])for(const o of t[RT]){const c=o.replace(/\/$/,""),u=n._makeStorageReference(new Ir(e,c));s.prefixes.push(u)}if(t[IT])for(const o of t[IT]){const c=n._makeStorageReference(new Ir(e,o.name));s.items.push(c)}return s}function T5(n,e,t){const s=L0(t);return s===null?null:w5(n,e,s)}class V0{constructor(e,t,s,o){this.url=e,this.method=t,this.handler=s,this.timeout=o,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function O0(n){if(!n)throw D0()}function k5(n,e){function t(s,o){const c=sN(n,o,e);return O0(c!==null),c}return t}function E5(n,e){function t(s,o){const c=T5(n,e,o);return O0(c!==null),c}return t}function S5(n,e){function t(s,o){const c=sN(n,o,e);return O0(c!==null),x5(c,o,n.host,n._protocol)}return t}function B0(n){function e(t,s){let o;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?o=LL():o=ML():t.getStatus()===402?o=PL(n.bucket):t.getStatus()===403?o=VL(n.path):o=s,o.status=t.getStatus(),o.serverResponse=s.serverResponse,o}return e}function j5(n){const e=B0(n);function t(s,o){let c=e(s,o);return s.getStatus()===404&&(c=DL(n.path)),c.serverResponse=o.serverResponse,c}return t}function N5(n,e,t,s,o){const c={};e.isRoot?c.prefix="":c.prefix=e.path+"/",t.length>0&&(c.delimiter=t),s&&(c.pageToken=s),o&&(c.maxResults=o);const u=e.bucketOnlyServerUrl(),h=Ip(u,n.host,n._protocol),m="GET",g=n.maxOperationRetryTime,b=new V0(h,m,E5(n,e.bucket),g);return b.urlParams=c,b.errorHandler=B0(e),b}function C5(n,e,t){const s=e.fullServerUrl(),o=Ip(s,n.host,n._protocol),c="GET",u=n.maxOperationRetryTime,h=new V0(o,c,S5(n,t),u);return h.errorHandler=j5(e),h}function A5(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function R5(n,e,t){const s=Object.assign({},t);return s.fullPath=n.path,s.size=e.size(),s.contentType||(s.contentType=A5(null,e)),s}function I5(n,e,t,s,o){const c=e.bucketOnlyServerUrl(),u={"X-Goog-Upload-Protocol":"multipart"};function h(){let X="";for(let fe=0;fe<2;fe++)X=X+Math.random().toString().slice(2);return X}const m=h();u["Content-Type"]="multipart/related; boundary="+m;const g=R5(e,s,o),b=_5(g,t),x="--"+m+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+b+`\r
--`+m+`\r
Content-Type: `+g.contentType+`\r
\r
`,T=`\r
--`+m+"--",N=Co.getBlob(x,s,T);if(N===null)throw qL();const B={name:g.fullPath},P=Ip(c,n.host,n._protocol),M="POST",Y=n.maxUploadRetryTime,H=new V0(P,M,k5(n,t),Y);return H.urlParams=B,H.headers=u,H.body=N.uploadData(),H.errorHandler=B0(e),H}class D5{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Il.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Il.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Il.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,s,o,c){if(this.sent_)throw jd("cannot .send() more than once");if(Ba(e)&&s&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),c!==void 0)for(const u in c)c.hasOwnProperty(u)&&this.xhr_.setRequestHeader(u,c[u].toString());return o!==void 0?this.xhr_.send(o):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw jd("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw jd("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw jd("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw jd("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class P5 extends D5{initXhr(){this.xhr_.responseType="text"}}function U0(){return new P5}class Gl{constructor(e,t){this._service=e,t instanceof Ir?this._location=t:this._location=Ir.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Gl(e,t)}get root(){const e=new Ir(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return tN(this._location.path)}get storage(){return this._service}get parent(){const e=m5(this._location.path);if(e===null)return null;const t=new Ir(this._location.bucket,e);return new Gl(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw WL(e)}}function M5(n,e,t){n._throwIfRoot("uploadBytes");const s=I5(n.storage,n._location,nN(),new Co(e,!0),t);return n.storage.makeRequestWithTokens(s,U0).then(o=>({metadata:o,ref:n}))}function L5(n){const e={prefixes:[],items:[]};return rN(n,e).then(()=>e)}async function rN(n,e,t){const o=await V5(n,{pageToken:t});e.prefixes.push(...o.prefixes),e.items.push(...o.items),o.nextPageToken!=null&&await rN(n,e,o.nextPageToken)}function V5(n,e){e!=null&&typeof e.maxResults=="number"&&nv("options.maxResults",1,1e3,e.maxResults);const t=e||{},s=N5(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(s,U0)}function O5(n){n._throwIfRoot("getDownloadURL");const e=C5(n.storage,n._location,nN());return n.storage.makeRequestWithTokens(e,U0).then(t=>{if(t===null)throw HL();return t})}function B5(n,e){const t=p5(n._location.path,e),s=new Ir(n._location.bucket,t);return new Gl(n.storage,s)}function U5(n){return/^[A-Za-z]+:\/\//.test(n)}function F5(n,e){return new Gl(n,e)}function iN(n,e){if(n instanceof F0){const t=n;if(t._bucket==null)throw zL();const s=new Gl(t,t._bucket);return e!=null?iN(s,e):s}else return e!==void 0?B5(n,e):n}function z5(n,e){if(e&&U5(e)){if(n instanceof F0)return F5(n,e);throw tv("To use ref(service, url), the first argument must be a Storage instance.")}else return iN(n,e)}function DT(n,e){const t=e?.[Qj];return t==null?null:Ir.makeFromBucketSpec(t,n)}function q5(n,e,t,s={}){n.host=`${e}:${t}`;const o=Ba(e);o&&(np(`https://${n.host}/b`),dv("Storage",!0)),n._isUsingEmulator=!0,n._protocol=o?"https":"http";const{mockUserToken:c}=s;c&&(n._overrideAuthToken=typeof c=="string"?c:yk(c,n.app.options.projectId))}class F0{constructor(e,t,s,o,c,u=!1){this.app=e,this._authProvider=t,this._appCheckProvider=s,this._url=o,this._firebaseVersion=c,this._isUsingEmulator=u,this._bucket=null,this._host=Kj,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=RL,this._maxUploadRetryTime=IL,this._requests=new Set,o!=null?this._bucket=Ir.makeFromBucketSpec(o,this._host):this._bucket=DT(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ir.makeFromBucketSpec(this._url,e):this._bucket=DT(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){nv("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){nv("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(si(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Gl(this,e)}_makeRequest(e,t,s,o,c=!0){if(this._deleted)return new GL(Yj());{const u=r5(e,this._appId,s,o,t,this._firebaseVersion,c,this._isUsingEmulator);return this._requests.add(u),u.getPromise().then(()=>this._requests.delete(u),()=>this._requests.delete(u)),u}}async makeRequestWithTokens(e,t){const[s,o]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,s,o).getPromise()}}const PT="@firebase/storage",MT="0.14.0";const aN="storage";function eb(n,e,t){return n=jn(n),M5(n,e,t)}function LT(n){return n=jn(n),L5(n)}function Dl(n){return n=jn(n),O5(n)}function Do(n,e){return n=jn(n),z5(n,e)}function H5(n=pv(),e){n=jn(n);const s=wu(n,aN).getImmediate({identifier:e}),o=mk("storage");return o&&$5(s,...o),s}function $5(n,e,t,s={}){q5(n,e,t,s)}function W5(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),s=n.getProvider("auth-internal"),o=n.getProvider("app-check-internal");return new F0(t,s,o,e,Kl)}function G5(){Pl(new Bo(aN,W5,"PUBLIC").setMultipleInstances(!0)),ea(PT,MT,""),ea(PT,MT,"esm2020")}G5();const oN={apiKey:"AIzaSyBCIgMJd3By7qkWH27YiW9VooIBGE3bFLs",authDomain:"mind-core-fitness-client.firebaseapp.com",projectId:"mind-core-fitness-client",storageBucket:"mind-core-fitness-client.firebasestorage.app",messagingSenderId:"669343392406",appId:"1:669343392406:web:f5a35ee062387e7d6f58b7"},z0=mv(oN),yl=aE(z0),ve=aL(z0),Po=H5(z0),K5=mv(oN,"secondary"),UB=aE(K5),Q5="EYdciKDOi3UYBLk1u8hHams5tmO2",lN=_.createContext();function Wr(){return _.useContext(lN)}function Y5({children:n}){const[e,t]=_.useState(null),[s,o]=_.useState(!1),[c,u]=_.useState(!1),[h,m]=_.useState(null),[g,b]=_.useState(!0);_.useEffect(()=>{let H=null;const X=pD(yl,fe=>{if(t(fe),H&&(H(),H=null),fe)if(fe.uid===Q5)o(!0),u(!1),m(null),b(!1);else{o(!1);const je=Dn(Kt(ve,"clients"),hn("uid","==",fe.uid)),Te=async()=>{const C=localStorage.getItem("mcf_clientId");if(C)try{const S=await Pn(Ge(ve,"clients",C));S.exists()&&(u(!0),m({id:S.id,...S.data()}))}catch(S){console.error("Direct client read failed:",S)}};H=Jm(je,async C=>{if(C.empty)await Te();else{const S=C.docs[0];u(!0),m({id:S.id,...S.data()});try{localStorage.setItem("mcf_clientId",S.id)}catch{}}b(!1)},async C=>{console.error("Error listening to client data:",C),await Te(),b(!1)})}else o(!1),u(!1),m(null),b(!1)});return()=>{X(),H&&H()}},[]);const Y={currentUser:e,isAdmin:s,isClient:c,clientData:h,updateClientData:H=>{m(X=>X?{...X,...H}:H)},resolveClient:async()=>{if(h)return h;const H=localStorage.getItem("mcf_clientId");if(H)try{const X=await Pn(Ge(ve,"clients",H));if(X.exists()){const fe={id:X.id,...X.data()};return u(!0),m(fe),fe}}catch(X){console.error("resolveClient direct read failed:",X)}if(e){const X=Dn(Kt(ve,"clients"),hn("uid","==",e.uid)),fe=await Sn(X);if(!fe.empty){const je={id:fe.docs[0].id,...fe.docs[0].data()};return u(!0),m(je),je}}return null},login:async(H,X,fe=!0)=>(await Kw(yl,fe?Eb:wv),await hD(yl,H,X)),signup:async(H,X,fe)=>{await Kw(yl,Eb);const je=await dD(yl,X.trim().toLowerCase(),fe),Te=je.user,C=Ge(Kt(ve,"clients")),S={uid:Te.uid,name:H.trim(),email:X.trim().toLowerCase(),clientType:"core_buddy",coreBuddyAccess:!0,status:"active",tier:"free",subscriptionStatus:null,signupSource:"self_signup",createdAt:pt.now()};await zn(C,S),u(!0),m({id:C.id,...S});try{localStorage.setItem("mcf_clientId",C.id)}catch{}return je},logout:()=>{try{localStorage.removeItem("mcf_clientId")}catch{}return gD(yl)},resetPassword:H=>uD(yl,H),loading:g};return a.jsx(lN.Provider,{value:Y,children:n})}const cN=_.createContext();function Ui(){return _.useContext(cN)}function X5({children:n}){const[e,t]=_.useState(()=>{const m=localStorage.getItem("theme");return m?m==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches}),[s,o]=_.useState(()=>localStorage.getItem("accent")||"red");_.useEffect(()=>{document.documentElement.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("theme",e?"dark":"light")},[e]),_.useEffect(()=>{localStorage.setItem("accent",s)},[s]);const h={isDark:e,toggleTheme:()=>{document.documentElement.setAttribute("data-theme-transitioning",""),t(!e),setTimeout(()=>{document.documentElement.removeAttribute("data-theme-transitioning")},350)},accent:s,setAccent:m=>o(m)};return a.jsx(cN.Provider,{value:h,children:n})}const uN=_.createContext();function Dp(){return _.useContext(uN)}const J5=["nutrition","consistency","personalBests","achievements","buddies","programmes","leaderboard"],Z5=[5,10],eV=1;function tV({children:n}){const{clientData:e}=Wr(),t=_.useMemo(()=>{const s=e?.tier||"free",o=e?.subscriptionStatus||null,c=e&&e.signupSource!=="self_signup",u=s==="premium"||!!c;function h(m){return u?!0:!J5.includes(m)}return{tier:s,subscriptionStatus:o,isPremium:u,canAccess:h,FREE_RANDOMISER_DURATIONS:Z5,FREE_RANDOMISER_WEEKLY_LIMIT:eV}},[e?.tier,e?.subscriptionStatus,e?.signupSource]);return a.jsx(uN.Provider,{value:t,children:n})}function nV(n){if(n?.signupSource==="self_signup"&&!n?.onboardingComplete)return"/onboarding";const e=n?.clientType;return e==="core_buddy"?"/client/core-buddy":e==="circuit_vip"||e==="circuit_dropin"?"/client/circuit":"/client"}function sV({className:n=""}){const{isDark:e,toggleTheme:t}=Ui();return a.jsx("button",{className:n||"theme-toggle",onClick:t,"aria-label":e?"Switch to light mode":"Switch to dark mode",children:e?a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})})}function rV(){const[n,e]=_.useState(""),[t,s]=_.useState(""),[o,c]=_.useState(!0),[u,h]=_.useState(""),[m,g]=_.useState(!1),[b,x]=_.useState(!1),[T,N]=_.useState(!1),{login:B,resetPassword:P,currentUser:M,isAdmin:Y,isClient:H,clientData:X,loading:fe}=Wr(),je=lr();if(_.useEffect(()=>{!fe&&M&&(Y?je("/dashboard"):H?je(nV(X)):(g(!1),h("No account found. Please sign up or contact your trainer.")))},[fe,M,Y,H,X,je]),fe||M)return null;const Te=async S=>{S.preventDefault(),h(""),g(!0);try{await B(n,t,o)}catch(D){h(D.message||"Failed to log in"),g(!1)}},C=async S=>{if(S.preventDefault(),h(""),!n.trim()){h("Please enter your email address");return}g(!0);try{await P(n.trim()),N(!0)}catch(D){D.code==="auth/user-not-found"?h("No account found with this email"):h(D.message||"Failed to send reset email")}g(!1)};return a.jsxs("div",{className:"login-container",children:[a.jsx(sV,{className:"login-theme-toggle"}),a.jsxs("div",{className:"login-card",children:[a.jsxs("div",{className:"login-header",children:[a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"login-logo"}),a.jsx("p",{children:a.jsx("strong",{children:b?"Reset Password":"Sign in as 1-2-1 or a Core Buddy"})})]}),u&&a.jsx("div",{className:"error-message",children:u}),T?a.jsxs("div",{className:"reset-sent",children:[a.jsx("div",{className:"reset-sent-icon",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M22 2L11 13",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("path",{d:"M22 2L15 22L11 13L2 9L22 2Z",strokeLinecap:"round",strokeLinejoin:"round"})]})}),a.jsx("p",{children:"Reset email sent!"}),a.jsx("span",{children:"Check your inbox for a password reset link"}),a.jsx("button",{className:"login-btn",style:{marginTop:"20px"},onClick:()=>{x(!1),N(!1),h("")},children:"Back to Log In"})]}):b?a.jsxs("form",{onSubmit:C,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:n,onChange:S=>e(S.target.value),placeholder:"Enter your email",required:!0})]}),a.jsx("button",{type:"submit",className:"login-btn",disabled:m,children:m?"Sending...":"Send Reset Link"}),a.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{x(!1),h("")},children:"Back to Log In"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("form",{onSubmit:Te,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:n,onChange:S=>e(S.target.value),required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"password",children:"Password"}),a.jsx("input",{type:"password",id:"password",value:t,onChange:S=>s(S.target.value),required:!0})]}),a.jsx("div",{className:"remember-me",children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:o,onChange:S=>c(S.target.checked)}),a.jsx("span",{children:"Remember me"})]})}),a.jsx("button",{type:"submit",className:"login-btn",disabled:m,children:m?"Logging in...":"Log In"})]}),a.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{x(!0),h("")},children:"Forgot password?"})]}),a.jsx("a",{href:"/",className:"back-link",children:"Back to website"})]})]})}function Oc({feature:n,children:e}){const{canAccess:t}=Dp(),s=lr();return t(n)?e:a.jsxs("div",{className:"locked-feature-wrap",children:[a.jsx("div",{className:"locked-feature-bg","aria-hidden":"true",children:e}),a.jsx("div",{className:"locked-feature-overlay",children:a.jsxs("div",{className:"locked-feature-card",children:[a.jsx("div",{className:"locked-icon",children:a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),a.jsx("h2",{children:"Premium Feature"}),a.jsx("p",{children:"Upgrade to Core Buddy Premium to unlock this feature and get full access to everything."}),a.jsx("button",{className:"locked-upgrade-btn",onClick:()=>s("/upgrade"),children:"Upgrade Now"})]})})]})}function Mu({children:n,onRefresh:e}){const[t,s]=_.useState(0),[o,c]=_.useState(!1),u=_.useRef(null),h=_.useRef(0),m=_.useRef(!1),g=_.useCallback(T=>{window.scrollY<=0&&(h.current=T.touches[0].clientY,m.current=!0)},[]),b=_.useCallback(T=>{if(!m.current||o)return;const N=T.touches[0].clientY-h.current;N>20&&window.scrollY<=0&&(T.preventDefault(),s(Math.min((N-20)*.35,80)))},[o]),x=_.useCallback(async()=>{t>55&&!o&&(c(!0),e?await e():window.location.reload(),c(!1)),s(0),m.current=!1},[t,o,e]);return a.jsxs("div",{ref:u,onTouchStart:g,onTouchMove:b,onTouchEnd:x,children:[a.jsxs("div",{className:`pull-refresh-indicator ${t>0?"visible":""} ${o?"refreshing":""}`,style:{height:t},children:[a.jsx("div",{className:`refresh-spinner ${o?"spinning":""}`,children:a.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:a.jsx("path",{fill:"currentColor",d:"M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"})})}),a.jsx("span",{className:"refresh-text",children:o?"Refreshing...":"Pull to refresh"})]}),n]})}function Ti({active:n}){const e=lr(),{clientData:t}=Wr(),{isPremium:s}=Dp(),o=t?.clientType==="block"&&t?.coreBuddyAccess;return a.jsxs("nav",{className:"block-bottom-nav",children:[a.jsxs("button",{className:`block-nav-tab${n==="home"?" active":""}`,onClick:()=>e("/client/core-buddy"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),a.jsx("span",{children:"Profile"})]}),a.jsxs("button",{className:`block-nav-tab${n==="workouts"?" active":""}`,onClick:()=>e("/client/core-buddy/workouts"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:a.jsx("path",{d:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"})}),a.jsx("span",{children:"Workouts"})]}),a.jsxs("button",{className:`block-nav-tab${n==="nutrition"?" active":""}`,onClick:()=>e(s?"/client/core-buddy/nutrition":"/upgrade"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"})}),a.jsx("span",{children:"Nutrition"})]}),a.jsxs("button",{className:`block-nav-tab${n==="buddies"?" active":""}`,onClick:()=>e(s?"/client/core-buddy/buddies":"/upgrade"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("span",{children:"Buddies"})]}),o&&a.jsxs("button",{className:"block-nav-tab",onClick:()=>e("/client"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),a.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),a.jsx("span",{children:"Block"})]})]})}function Mh(n,e,t,s,o){const c=[];for(let u=0;u<n;u++){const h=(u*(360/n)-90)*(Math.PI/180);c.push({x1:e+s*Math.cos(h),y1:t+s*Math.sin(h),x2:e+o*Math.cos(h),y2:t+o*Math.sin(h),thick:u%5===0})}return c}const q0=Mh(60,100,100,85,96),Kd=Mh(60,100,100,78,94),iV=Mh(60,100,100,82,94);Mh(60,50,50,38,46);const aV=Mh(60,40,40,30,37),oV="/login/assets/first_workout-B8SFkzJX.PNG",lV="/login/assets/workouts_10-Z5R3u0xH.PNG",cV="/login/assets/workouts_25-CzxSlcAj.PNG",uV="/login/assets/workouts_50-BpzWup3V.PNG",dV="/login/assets/workouts_100-D7_r6tn1.PNG",hV="/login/assets/streak_2-CsRr-XA9.PNG",fV="/login/assets/streak_4-BHO09tbw.PNG",mV="/login/assets/streak_8-DX2UWMko.PNG",pV="/login/assets/first_pb-aVf_CNWy.PNG",gV="/login/assets/pbs_5-Cippawgg.PNG",yV="/login/assets/pbs_10-CZgGh9Kv.PNG",bV="/login/assets/pbs_100-C67b1wfS.PNG",vV="/login/assets/nutrition_7-CHVV11fj.PNG",xV="/login/assets/leaderboard_join-BLoId4Hz.PNG",_V="/login/assets/habits_7-Dvki70KO.PNG",Qd=[{id:"first_workout",img:oV,name:"First Rep",desc:"Complete your first workout",category:"workouts",threshold:1},{id:"workouts_10",img:lV,name:"On Fire",desc:"Complete 10 workouts",category:"workouts",threshold:10},{id:"workouts_25",img:cV,name:"Dedicated",desc:"Complete 25 workouts",category:"workouts",threshold:25},{id:"workouts_50",img:uV,name:"Unstoppable",desc:"Complete 50 workouts",category:"workouts",threshold:50},{id:"workouts_100",img:dV,name:"Century",desc:"Complete 100 workouts",category:"workouts",threshold:100},{id:"streak_2",img:hV,name:"2 Week Streak",desc:"Work out for 2 weeks in a row",category:"streaks",threshold:2},{id:"streak_4",img:fV,name:"Month Strong",desc:"Work out for 4 weeks in a row",category:"streaks",threshold:4},{id:"streak_8",img:mV,name:"Iron Will",desc:"Work out for 8 weeks in a row",category:"streaks",threshold:8},{id:"first_pb",img:pV,name:"First PB",desc:"Set your first personal best",category:"pbs",threshold:1},{id:"pbs_5",img:gV,name:"PB Hunter",desc:"Set 5 personal bests",category:"pbs",threshold:5},{id:"pbs_10",img:yV,name:"PB Machine",desc:"Set 10 personal bests",category:"pbs",threshold:10},{id:"pbs_100",img:bV,name:"PB Legend",desc:"Set 100 personal bests",category:"pbs",threshold:100},{id:"nutrition_7",img:vV,name:"Macro Master",desc:"Hit your macro targets 7 days in a row",category:"nutrition",threshold:7},{id:"leaderboard_join",img:xV,name:"Competitor",desc:"Join the leaderboard",category:"leaderboard",threshold:1},{id:"habits_7",img:_V,name:"Habit Streak",desc:"Complete your daily habits 7 days in a row",category:"habits",threshold:7}];function wV({steps:n,onFinish:e,active:t}){const[s,o]=_.useState(0),[c,u]=_.useState(null),[h,m]=_.useState("below"),[g,b]=_.useState(!1),x=_.useRef(null),T=_.useRef(t);T.current=t,_.useEffect(()=>{t||o(0)},[t]),_.useEffect(()=>{if(!t)return;const je=Te=>Te.preventDefault();return document.addEventListener("touchmove",je,{passive:!1}),document.addEventListener("wheel",je,{passive:!1}),document.body.style.overflow="hidden",()=>{document.removeEventListener("touchmove",je),document.removeEventListener("wheel",je),document.body.style.overflow=""}},[t]);const N=_.useMemo(()=>t?n.filter(je=>document.querySelector(je.selector)):[],[t]),B=N[s],P=s===N.length-1,M=B?.selector,Y=_.useCallback(()=>{if(!M)return;const je=document.querySelector(M);if(!je){u(null);return}const Te=je.getBoundingClientRect(),C=8;u({top:Te.top-C,left:Te.left-C,width:Te.width+C*2,height:Te.height+C*2});const S=window.innerHeight-Te.bottom;m(S<260?"above":"below")},[M]);if(_.useEffect(()=>{if(!t||!M)return;b(!0);const je=document.querySelector(M);if(je){document.body.style.overflow="",je.scrollIntoView({behavior:"smooth",block:"center"});let Te=null,C=0,S=0;const D=60,U=()=>{S++;const L=je.getBoundingClientRect(),Ke=Math.round(L.top);if(Te!==null&&Ke===Te?C++:C=0,Te=Ke,C>=3||S>=D){T.current&&(document.body.style.overflow="hidden"),Y(),b(!1);return}V=requestAnimationFrame(U)};let V;const q=setTimeout(()=>{V=requestAnimationFrame(U)},120);return()=>{clearTimeout(q),V&&cancelAnimationFrame(V),T.current&&(document.body.style.overflow="hidden")}}},[t,s,M,Y]),_.useEffect(()=>{if(!t)return;const je=()=>{x.current&&cancelAnimationFrame(x.current),x.current=requestAnimationFrame(Y)};return window.addEventListener("scroll",je,!0),window.addEventListener("resize",je),()=>{window.removeEventListener("scroll",je,!0),window.removeEventListener("resize",je),x.current&&cancelAnimationFrame(x.current)}},[t,Y]),!t||!B||N.length===0)return null;const H=()=>{P?e():o(s+1)},X=()=>{s>0&&o(s-1)},fe=()=>e();return a.jsxs("div",{className:"st-overlay",onClick:je=>{je.stopPropagation()},children:[a.jsx("div",{className:"st-backdrop",onClick:H}),c&&a.jsx("div",{className:`st-spotlight${g?" st-transitioning":""}`,style:{top:c.top,left:c.left,width:c.width,height:c.height}}),c&&a.jsxs("div",{className:`st-tooltip st-tooltip-${h}${g?" st-transitioning":""}`,style:{top:h==="below"?Math.min(Math.max(c.top+c.height+16,16),window.innerHeight-200):void 0,bottom:h==="above"?Math.min(Math.max(window.innerHeight-c.top+16,16),window.innerHeight-60):void 0,left:Math.max(16,Math.min(c.left,window.innerWidth-320))},children:[a.jsx("div",{className:"st-dots",children:N.map((je,Te)=>a.jsx("span",{className:`st-dot${Te===s?" active":""}${Te<s?" done":""}`},Te))}),a.jsx("h3",{className:"st-title",children:B.title}),a.jsx("p",{className:"st-body",children:B.body}),a.jsxs("div",{className:"st-actions",children:[s>0&&a.jsx("button",{className:"st-btn st-btn-back",onClick:X,children:"Back"}),a.jsx("button",{className:"st-btn st-btn-next",onClick:H,children:B.cta||(P?"Let's Go!":"Next")})]}),a.jsx("button",{className:"st-skip",onClick:fe,children:"Skip tour"})]})]})}const tb=[10,25,50,100,200,500,1e3],_o=5;function Nd(n){return n.toISOString().split("T")[0]}function TV(n){let e=0;for(const t of tb){if(n<t)return{prev:e,next:t};e=t}return{prev:tb[tb.length-1],next:n+100}}const kV={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},EV={fullbody_4wk:["Push Focus","Pull Focus","Legs & Core"],fullbody_8wk:["Strength","Power","Endurance"],fullbody_12wk:["Upper Push","Lower Body","Upper Pull"],core_4wk:["Abs","Stability","Power Core"],core_8wk:["Anti-Extension","Rotation","Power"],core_12wk:["Strength","Endurance","Power"],upper_4wk:["Push","Pull","Mixed"],lower_4wk:["Quad Dominant","Hamstring & Glute","Power & Stability"]},nb=[{text:"You have 24 hours a day...",bold:"make it count"},{text:"Discipline beats motivation...",bold:"every single time"},{text:"Rest when you're done,",bold:"not when you're tired"},{text:"Small daily gains...",bold:"create massive results"},{text:"Your body keeps score,",bold:"train it well"},{text:"Consistency over intensity...",bold:"always wins"},{text:"The only bad workout...",bold:"is the one you skipped"}];function sb(n){if(!n)return"";const e=n instanceof Date?n:n.toDate?n.toDate():new Date(n),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function Cd(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function SV(n,e=800){return new Promise(t=>{const s=new Image;s.onload=()=>{const o=document.createElement("canvas");let c=s.width,u=s.height;c>u?c>e&&(u=Math.round(u*e/c),c=e):u>e&&(c=Math.round(c*e/u),u=e),o.width=c,o.height=u,o.getContext("2d").drawImage(s,0,0,c,u),o.toBlob(h=>t(h),"image/jpeg",.8)},s.src=URL.createObjectURL(n)})}function jV(){const{currentUser:n,isClient:e,clientData:t,logout:s,updateClientData:o,loading:c}=Wr(),{isDark:u,toggleTheme:h}=Ui(),{isPremium:m}=Dp(),g=lr(),[b,x]=_.useState({hours:0,minutes:0,seconds:0}),[T,N]=_.useState(0),[B,P]=_.useState(0),[M,Y]=_.useState(""),[H,X]=_.useState(0),[fe,je]=_.useState(0),[Te,C]=_.useState(!1),[S,D]=_.useState({protein:0,carbs:0,fats:0,calories:0}),[U,V]=_.useState(null),[q,L]=_.useState(0),[Ke,_t]=_.useState(null),[$,ge]=_.useState(!1),[Le,Qe]=_.useState(!1),[ne,O]=_.useState(0),[ie,Ie]=_.useState(0),[Oe,it]=_.useState([]),[ze,vt]=_.useState([]),[Nt,at]=_.useState(null),[Xt,An]=_.useState(!1),Pt=_.useRef(null),[Ce,ee]=_.useState([]),[yt,bt]=_.useState(null),[et,ft]=_.useState(null),rt=_.useRef(null),[tt,Ft]=_.useState(0),[ts,Dt]=_.useState(0),[un,fs]=_.useState(0),[Yt,Mn]=_.useState(0),[dn,Rn]=_.useState(null),he=_.useCallback((I,te="info")=>{Rn({message:I,type:te}),setTimeout(()=>Rn(null),4e3)},[]),[De,Be]=_.useState([]),[nt,Fe]=_.useState(!1),[Me,qe]=_.useState(""),[St,wt]=_.useState(null),[Mt,Jt]=_.useState(null),[Z,xe]=_.useState(!1),[ct,Lt]=_.useState(new Set),[Ct,an]=_.useState(new Set),[Zt,Wt]=_.useState({}),[Ln,as]=_.useState({}),[bn,In]=_.useState({}),[Bn,z]=_.useState({}),[_e,ke]=_.useState({}),[Ee,be]=_.useState({}),lt=_.useRef(null),It=_.useRef(null),ut=_.useRef({}),[Tt,At]=_.useState([]),[mn,er]=_.useState(!1),ks=_.useRef(null),[Ds,ns]=_.useState([]),[W,me]=_.useState(""),[E,A]=_.useState(!1),[K,oe]=_.useState(null),[Ye,$e]=_.useState([]),[He,Qt]=_.useState(null),[Ot,Yn]=_.useState(!1),Gs=_.useRef(!1),Bs=(()=>{const I=[{selector:".cb-ring-container",title:"Your 24-Hour Countdown",body:"Every day resets. This ring tracks the time you have left  tap your photo to personalise your profile.",cta:"Next"},{selector:".cb-stats-row",title:"Progress at a Glance",body:"Programme completion, workouts this week, and daily habits  all in one row. These fill up as you go."},{selector:".cb-nudge-card",title:"Smart Suggestions",body:"We'll highlight what needs your attention  your next session, unfinished habits, or a meal to log."},{selector:".cb-card-workouts-hero",title:"Workouts",body:"Quick randomiser sessions or structured programmes  pick your focus, level and time.",cta:"Next"}];return m&&I.push({selector:".cb-card-nutrition",title:"Nutrition Tracking",body:"Set your macro targets, scan barcodes, and log meals to hit your daily goals."},{selector:".cb-card-consistency",title:"Daily Habits",body:"5 simple habits each day  train, hit protein, 10k steps, sleep, and hydrate. Build your streak."},{selector:".cb-card-buddies",title:"Buddies & Social",body:"Connect with other members, share your journey, and keep each other accountable."},{selector:".cb-journey-section",title:"Share Your Journey",body:"Post photos, updates, and milestones  your fitness journey in one place. Like and comment on each other's posts."},{selector:".cb-achievements-section",title:"Achievements",body:"Every rep counts towards badges  volume milestones, workout streaks, and more to unlock."}),I.push({selector:".block-bottom-nav",title:"You're All Set!",body:"Use the nav bar to jump between your profile, workouts, nutrition, and buddies. Time to get after it.",cta:"Let's Go!"}),I})();_.useEffect(()=>{!c&&!n&&g("/")},[c,n,g]),_.useEffect(()=>{!c&&t&&t.signupSource==="self_signup"&&!t.onboardingComplete&&g("/onboarding")},[c,t,g]),_.useEffect(()=>{let I=t?.tourComplete||Gs.current;if(!I&&t?.id)try{I=!!localStorage.getItem(`tourDone_${t.id}`)}catch{}if(Te&&t&&!I){const te=setTimeout(()=>Yn(!0),600);return()=>clearTimeout(te)}},[Te,t]),_.useEffect(()=>{if(t)try{const I=sessionStorage.getItem(`cbDash_${t.id}`);if(I){const te=JSON.parse(I);P(te.programmePct??0),Y(te.programmeName??""),X(te.totalWorkouts??0),je(te.habitWeekPct??0),D(te.nutritionTotals??{protein:0,carbs:0,fats:0,calories:0}),V(te.nutritionTargetData??null),L(te.todayHabitsCount??0),_t(te.nextSession??null),ge(te.hasProgramme??!1),Qe(te.programmeComplete??!1),O(te.weeklyWorkouts??0),Ie(te.pbCount??0),it(te.topPBs??[]),vt(te.leaderboardTop3??[]),ee(te.unlockedBadges??[]),rt.current=te.unlockedBadges??[],Ft(te.streakWeeks??0),C(!0)}}catch{}},[t]),_.useEffect(()=>{t?.photoURL&&at(t.photoURL)},[t]),_.useEffect(()=>{if(!t)return;const I=Dn(Kt(ve,"notifications"),hn("toId","==",t.id)),te=Jm(I,Ne=>{const st=Ne.docs.map(jt=>({id:jt.id,...jt.data()}));st.sort((jt,Ut)=>{const ot=jt.createdAt?.toMillis?.()||0;return(Ut.createdAt?.toMillis?.()||0)-ot}),At(st.slice(0,50))},Ne=>{console.error("Notification listener error:",Ne),Ne.code==="permission-denied"&&console.warn("Firestore rules may be missing for the notifications collection. Please update your Firestore rules in the Firebase Console.")});return()=>te()},[t]),_.useEffect(()=>{const I=te=>{ks.current&&!ks.current.contains(te.target)&&er(!1)};return document.addEventListener("mousedown",I),()=>document.removeEventListener("mousedown",I)},[]),_.useEffect(()=>{if(!t)return;const I=t.id;(async()=>{try{const[te,Ne,st]=await Promise.all([Sn(Dn(Kt(ve,"buddies"),hn("user1","==",I))),Sn(Dn(Kt(ve,"buddies"),hn("user2","==",I))),Sn(Kt(ve,"clients"))]),jt=new Set;[...te.docs,...Ne.docs].forEach(ot=>{const Gt=ot.data();jt.add(Gt.user1===I?Gt.user2:Gt.user1)});const Ut={};st.docs.forEach(ot=>{Ut[ot.id]=ot.data()}),ns(Array.from(jt).filter(ot=>Ut[ot]).map(ot=>({id:ot,name:Ut[ot].name,photoURL:Ut[ot].photoURL||null})))}catch(te){console.error("Error loading buddies for mentions:",te)}})()},[t]);const Hn=Tt.filter(I=>!I.read).length,$n=async()=>{const I=Tt.filter(Ne=>!Ne.read);if(!I.length)return;const te=jT(ve);I.forEach(Ne=>te.update(Ge(ve,"notifications",Ne.id),{read:!0})),await te.commit()},Q=async()=>{if(!Tt.length)return;const I=jT(ve);Tt.forEach(te=>I.delete(Ge(ve,"notifications",te.id))),await I.commit()},we=async(I,te,Ne={})=>{if(!(!t||I===t.id))try{await Ia(Kt(ve,"notifications"),{toId:I,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:te,read:!1,createdAt:vi(),...Ne})}catch(st){console.error("Notification create error:",st),st.code==="permission-denied"&&he("Notifications blocked  check Firestore rules","error")}},se=(I,te)=>{const Ne=te==="compose"?lt.current?.selectionStart:null,jt=(Ne!=null?I.slice(0,Ne):I).match(/@(\w*)$/);if(jt){A(!0),oe(te),me(jt[1].toLowerCase());const Ut=Ds.filter(ot=>ot.name&&ot.name.toLowerCase().includes(jt[1].toLowerCase())).slice(0,5);$e(Ut)}else A(!1),$e([])},Ue=(I,te)=>{if(te==="compose"){const Ne=lt.current,st=Me,jt=Ne?.selectionStart??st.length,Ut=st.slice(0,jt),ot=st.slice(jt),Gt=Ut.replace(/@\w*$/,`@${I.name} `);qe(Gt+ot),setTimeout(()=>{Ne?.focus(),Ne.selectionStart=Ne.selectionEnd=Gt.length},0)}else{const st=(Ln[te]||"").replace(/@\w*$/,`@${I.name} `);as(jt=>({...jt,[te]:st}))}A(!1),$e([])},We=I=>I&&I.split(/(@\w[\w\s]*?\s)/g).map((Ne,st)=>Ne.startsWith("@")&&Ds.some(jt=>Ne.trim()===`@${jt.name}`)?a.jsx("span",{className:"mention-highlight",children:Ne.trim()},st):Ne),ht=async I=>{const te=I.target.files?.[0];if(!(!te||!t)){if(!te.type.startsWith("image/")){he("Please select an image file","error");return}if(te.size>5*1024*1024){he("Image must be under 5MB","error");return}An(!0);try{const Ne=await new Promise(Ut=>{const ot=new Image;ot.onload=()=>{const Gt=document.createElement("canvas"),$t=400;let nn=ot.width,zt=ot.height;nn>zt?(zt=zt/nn*$t,nn=$t):(nn=nn/zt*$t,zt=$t),Gt.width=nn,Gt.height=zt,Gt.getContext("2d").drawImage(ot,0,0,nn,zt),Gt.toBlob(on=>Ut(on),"image/jpeg",.75)},ot.src=URL.createObjectURL(te)}),st=Do(Po,`profilePhotos/${t.id}`);await eb(st,Ne);const jt=await Dl(st);await Sa(Ge(ve,"clients",t.id),{photoURL:jt}),at(jt),o({photoURL:jt}),he("Profile photo updated!","success")}catch(Ne){console.error("Photo upload error:",Ne),he("Failed to upload photo","error")}An(!1),Pt.current&&(Pt.current.value="")}};_.useEffect(()=>{const I=()=>{const Ne=new Date,st=new Date(Ne);st.setHours(23,59,59,999);const jt=st-Ne,Ut=Math.floor(jt/(1e3*60*60)),ot=Math.floor(jt%(1e3*60*60)/(1e3*60)),Gt=Math.floor(jt%(1e3*60)/1e3);x({hours:Ut,minutes:ot,seconds:Gt}),N(60-Gt)};I();const te=setInterval(I,1e3);return()=>clearInterval(te)},[]),_.useEffect(()=>{const I=setInterval(()=>{Mn(te=>(te+1)%nb.length)},8e3);return()=>clearInterval(I)},[]),_.useEffect(()=>{if(!n||!t)return;(async()=>{let te=null,Ne=0,st=[],jt=!1,Ut=null;try{const ot=Nd(new Date),Gt=await Pn(Ge(ve,"clientProgrammes",t.id));if(Gt.exists()){const vr=Gt.data(),js=kV[vr.templateId];if(ge(!0),js){const Sr=vr.completedSessions||{},Vr=Object.keys(Sr).length,ca=js.duration*js.daysPerWeek;P(ca>0?Math.round(Vr/ca*100):0);const ec=vr.templateId.replace(/_/g," ").replace(/\b\w/g,ki=>ki.toUpperCase());Y(ec);const tc=EV[vr.templateId];let jr=!1;for(let ki=1;ki<=js.duration&&!jr;ki++)for(let Ei=0;Ei<js.daysPerWeek&&!jr;Ei++)Sr[`w${ki}d${Ei}`]||(_t({week:ki,dayIdx:Ei,label:tc?.[Ei]||`Day ${Ei+1}`}),jr=!0);jr||(Qe(!0),jt=!0)}}const $t=Kt(ve,"workoutLogs"),nn=Dn($t,hn("clientId","==",t.id));te=await Sn(nn),X(te.docs.length);const zt=new Date,on=zt.getDay(),Ss=on===0?6:on-1,Qs=new Date(zt);Qs.setDate(zt.getDate()-Ss),Qs.setHours(0,0,0,0);const qn=Qs.getTime(),Nn=te.docs.filter(vr=>{const js=vr.data().completedAt;return js?(js.toDate?js.toDate().getTime():new Date(js).getTime())>=qn:!1}).length;O(Nn);const ms=Kt(ve,"habitLogs"),cs=Dn(ms,hn("clientId","==",t.id),hn("date","==",ot)),Ys=await Sn(cs);let br=0;if(!Ys.empty){const vr=Ys.docs[0].data().habits||{};br=Object.values(vr).filter(Boolean).length}je(Math.round(br/_o*100)),L(br);const dr=await Pn(Ge(ve,"nutritionTargets",t.id));dr.exists()&&(V(dr.data()),Ut=dr.data());const Er=await Pn(Ge(ve,"nutritionLogs",`${t.id}_${ot}`));if(Er.exists()){const js=(Er.data().entries||[]).reduce((Sr,Vr)=>({protein:Sr.protein+(Vr.protein||0),carbs:Sr.carbs+(Vr.carbs||0),fats:Sr.fats+(Vr.fats||0),calories:Sr.calories+(Vr.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});D(js)}}catch(ot){console.error("Error loading dashboard stats:",ot)}try{let ot=[];const Gt=await Pn(Ge(ve,"coreBuddyPBs",t.id));if(Gt.exists()){const $t=Gt.data().exercises||{};Ie(Object.keys($t).length),Ne=Object.keys($t).length,ot=Object.entries($t).sort(([,nn],[,zt])=>(zt.weight||0)-(nn.weight||0)).slice(0,3).map(([nn,zt])=>({name:nn,weight:zt.weight,reps:zt.reps}))}if(ot.length===0){const $t={chestPress:"Chest Press",shoulderPress:"Shoulder Press",seatedRow:"Seated Row",latPulldown:"Lat Pulldown",squat:"Squat",deadlift:"Deadlift"},nn=Dn(Kt(ve,"personalBests"),hn("clientId","==",t.id)),zt=await Sn(nn);if(!zt.empty){const on={};zt.docs.forEach(Qs=>{const qn=Qs.data().benchmarks||{};Object.entries(qn).forEach(([Nn,ms])=>{if(!ms.weight||!$t[Nn])return;const cs=(ms.weight||0)*(ms.reps||1);(!on[Nn]||cs>(on[Nn].weight||0)*(on[Nn].reps||1))&&(on[Nn]={name:$t[Nn],weight:ms.weight,reps:ms.reps})})});const Ss=Object.values(on);Ie(Ss.length),Ne=Ss.length,ot=Ss.sort((Qs,qn)=>(qn.weight||0)-(Qs.weight||0)).slice(0,3)}}st=ot,it(ot)}catch(ot){console.error("PB fetch error:",ot)}try{const ot=Kt(ve,"clients"),Gt=Dn(ot,hn("leaderboardOptIn","==",!0)),nn=(await Sn(Gt)).docs.map(zt=>({id:zt.id,name:zt.data().name,photoURL:zt.data().photoURL||null}));vt(nn.slice(0,3))}catch(ot){console.error("Leaderboard preview error:",ot)}try{let ot=0;if(te){const qn=te.docs.map(Nn=>Nn.data().date).filter(Boolean).sort().reverse();if(qn.length>0){const Nn=new Date;let ms=new Date(Nn);e:for(let cs=0;cs<52;cs++){const Ys=new Date(ms),br=Ys.getDay(),dr=br===0?6:br-1;Ys.setDate(Ys.getDate()-dr),Ys.setHours(0,0,0,0);const Er=new Date(Ys);Er.setDate(Er.getDate()+7);const vr=Nd(Ys),js=Nd(Er);if(qn.some(Vr=>Vr>=vr&&Vr<js))ot++;else{if(cs>0)break e;break}ms.setDate(ms.getDate()-7)}}}Ft(ot);let Gt=0;for(let qn=0;qn<30;qn++){const Nn=new Date;Nn.setDate(Nn.getDate()-qn);const ms=Nd(Nn);try{const cs=await Sn(Dn(Kt(ve,"habitLogs"),hn("clientId","==",t.id),hn("date","==",ms)));if(cs.empty)break;{const Ys=cs.docs[0].data().habits||{};if(Object.values(Ys).filter(Boolean).length>=_o)Gt++;else break}}catch{break}}Dt(Gt);let $t=0;for(let qn=0;qn<30;qn++){const Nn=new Date;Nn.setDate(Nn.getDate()-qn);const ms=Nd(Nn);try{const cs=await Pn(Ge(ve,"nutritionLogs",`${t.id}_${ms}`));if(cs.exists()&&(cs.data().entries||[]).length>0)if(Ut){const br=(cs.data().entries||[]).reduce((dr,Er)=>({protein:dr.protein+(Er.protein||0),carbs:dr.carbs+(Er.carbs||0),fats:dr.fats+(Er.fats||0)}),{protein:0,carbs:0,fats:0});if(br.protein>=(Ut.protein||0)&&br.carbs>=(Ut.carbs||0)&&br.fats>=(Ut.fats||0))$t++;else break}else $t++;else break}catch{break}}fs($t);const nn=te?te.docs.length:0,zt=[],on=qn=>zt.push(qn);nn>=1&&on("first_workout"),nn>=10&&on("workouts_10"),nn>=25&&on("workouts_25"),nn>=50&&on("workouts_50"),nn>=100&&on("workouts_100"),ot>=2&&on("streak_2"),ot>=4&&on("streak_4"),ot>=8&&on("streak_8"),Ne>=1&&on("first_pb"),Ne>=5&&on("pbs_5"),Ne>=10&&on("pbs_10"),Ne>=100&&on("pbs_100"),$t>=7&&on("nutrition_7"),t.leaderboardOptIn&&on("leaderboard_join"),Gt>=7&&on("habits_7"),ee(zt);const Ss=rt.current;if(Ss!==null){const qn=zt.filter(Nn=>!Ss.includes(Nn));if(qn.length>0){const Nn=Qd.find(ms=>ms.id===qn[qn.length-1]);Nn&&setTimeout(()=>ft(Nn),600)}}rt.current=zt;const Qs={};zt.forEach(qn=>{Qs[qn]={unlockedAt:new Date().toISOString()}}),zn(Ge(ve,"achievements",t.id),{badges:Qs,progress:{streakWeeks:ot,pbCount:Ne,nutritionStreak:$t,habitStreak:Gt},updatedAt:new Date().toISOString()},{merge:!0}).catch(()=>{})}catch(ot){console.error("Achievement computation error:",ot)}C(!0)})()},[n,t]),_.useEffect(()=>{if(!(!Te||!t))try{sessionStorage.setItem(`cbDash_${t.id}`,JSON.stringify({programmePct:B,programmeName:M,totalWorkouts:H,habitWeekPct:fe,nutritionTotals:S,nutritionTargetData:U,todayHabitsCount:q,nextSession:Ke,hasProgramme:$,programmeComplete:Le,weeklyWorkouts:ne,pbCount:ie,topPBs:Oe,leaderboardTop3:ze,unlockedBadges:Ce,streakWeeks:tt}))}catch{}},[Te,B,M,H,fe,S,U,q,Ke,$,Le,ne,ie,Oe,ze,Ce,tt,t]);const kt=_.useCallback(async()=>{if(Gs.current=!0,Yn(!1),o({tourComplete:!0}),t?.id){try{localStorage.setItem(`tourDone_${t.id}`,"1")}catch{}try{await Sa(Ge(ve,"clients",t.id),{tourComplete:!0})}catch(I){console.error("Failed to save tour completion:",I)}}},[t,o]),Bt=I=>{const te=I.currentTarget,Ne=te.querySelector(".ripple");Ne&&Ne.remove();const st=te.getBoundingClientRect(),jt=Math.max(st.width,st.height),Ut=I.clientX-st.left-jt/2,ot=I.clientY-st.top-jt/2,Gt=document.createElement("span");Gt.className="ripple",Gt.style.cssText=`width:${jt}px;height:${jt}px;left:${Ut}px;top:${ot}px;`,te.appendChild(Gt),setTimeout(()=>Gt.remove(),600)},kn=t?.name?.split(" ")[0]||"there",{prev:_s,next:vn}=TV(H),cr=vn>_s?Math.round((H-_s)/(vn-_s)*100):100,ci=[{label:"Programme",value:`${B}%`,pct:B,color:"#14b8a6",size:"normal"},{label:"Workouts",value:`${H}`,pct:cr,color:"var(--color-primary)",size:"large"},{label:"Habits Today",value:`${fe}%`,pct:fe,color:"#38B6FF",size:"normal"}],Es=I=>!U||!U[I]?0:Math.min(Math.round(S[I]/U[I]*100),100),Fi=(()=>{const I=new Date().getHours();return Te&&q>=_o&&S.calories>0?{main:"Smashed it today,",sub:"Rest up and go again tomorrow."}:I>=5&&I<12?{main:"Rise and grind,",sub:"let's get after it!"}:I>=12&&I<17?{main:"Oye",sub:"crack on and make it count!"}:I>=17&&I<21?{main:"Evening session?",sub:"Let's finish strong!"}:{main:"Burning the midnight oil,",sub:"Respect the hustle!"}})(),tr=Te?$&&Ke&&!Le?{label:"NEXT SESSION",message:`Week ${Ke.week}, Day ${Ke.dayIdx+1}  ${Ke.label}`,cta:"Continue",action:()=>g("/client/core-buddy/programmes"),pct:B,ringLabel:`${B}%`}:q<_o?{label:"DAILY HABITS",message:`${q}/${_o} completed`,cta:"Open Habits",action:()=>g("/client/core-buddy/consistency"),pct:fe,ringLabel:`${q}/${_o}`}:S.calories===0?{label:"NUTRITION",message:"No meals logged today",cta:"Log Meal",action:()=>g("/client/core-buddy/nutrition"),pct:0,ringLabel:"0"}:$?Le?{label:"COMPLETE",message:"Programme finished!",cta:"New Programme",action:()=>g("/client/core-buddy/workouts"),pct:100,ringLabel:"100%"}:{label:"TODAY",message:"You're crushing it!",cta:null,action:null,pct:100,ringLabel:""}:{label:"PROGRAMMES",message:"Start a programme to level up",cta:"Browse",action:()=>g("/client/core-buddy/workouts"),pct:0,ringLabel:""}:null,cn=_.useCallback(async()=>{if(t){Fe(!0);try{const I=await Sn(Dn(Kt(ve,"posts"),hn("authorId","==",t.id),Ym("createdAt","desc"),Xm(30)));Be(I.docs.map(Ne=>({id:Ne.id,...Ne.data()})));const te=await Sn(Dn(Kt(ve,"postLikes"),hn("userId","==",t.id)));Lt(new Set(te.docs.map(Ne=>Ne.data().postId)))}catch(I){console.error("Error loading journey:",I)}finally{Fe(!1)}}},[t]);_.useEffect(()=>{Te&&t&&cn()},[Te,t,cn]);const ws=I=>{const te=I.target.files?.[0];if(te){if(!te.type.startsWith("image/")){he("Please select an image file","error");return}if(te.size>10*1024*1024){he("Image must be under 10MB","error");return}wt(te),Jt(URL.createObjectURL(te))}},yr=()=>{wt(null),Mt&&URL.revokeObjectURL(Mt),Jt(null),It.current&&(It.current.value="")},ur=async()=>{if(!(!Me.trim()&&!St||Z||!t)){xe(!0);try{let I=null;if(St){const st=await SV(St),jt=`${Date.now()}_${Math.random().toString(36).slice(2,8)}`,Ut=Do(Po,`postImages/${t.id}/${jt}`);await eb(Ut,st),I=await Dl(Ut)}await Ia(Kt(ve,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Me.trim(),type:I?"image":"text",imageURL:I||null,createdAt:vi(),likeCount:0,commentCount:0});const Ne=Me.trim().match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Ne){const st=new Set;Ne.forEach(jt=>{const Ut=jt.slice(1).trim(),ot=Ds.find(Gt=>Gt.name&&Gt.name.toLowerCase()===Ut.toLowerCase());ot&&!st.has(ot.id)&&(st.add(ot.id),we(ot.id,"mention",{}))})}qe(""),yr(),lt.current&&(lt.current.style.height="auto"),await cn(),he("Posted!","success")}catch(I){console.error("Error posting:",I),he(I?.message||"Failed to post","error")}finally{xe(!1)}}},Pr=async I=>{if(window.confirm("Delete this post?"))try{await Rr(Ge(ve,"posts",I)),Be(te=>te.filter(Ne=>Ne.id!==I)),he("Post deleted","info")}catch(te){console.error("Delete error:",te),he("Failed to delete","error")}},ls=async I=>{if(!t)return;const te=t.id,Ne=`${I}_${te}`,st=ct.has(I),jt=new Set(ct);st?jt.delete(I):jt.add(I),Lt(jt),Be(Ut=>Ut.map(ot=>ot.id===I?{...ot,likeCount:Math.max(0,(ot.likeCount||0)+(st?-1:1))}:ot));try{if(st)await Rr(Ge(ve,"postLikes",Ne)),await Sa(Ge(ve,"posts",I),{likeCount:Nl(-1)});else{await zn(Ge(ve,"postLikes",Ne),{postId:I,userId:te,createdAt:vi()}),await Sa(Ge(ve,"posts",I),{likeCount:Nl(1)});const Ut=De.find(ot=>ot.id===I);Ut&&we(Ut.authorId,"like",{postId:I})}}catch(Ut){console.error("Like error:",Ut),cn()}},Ks=async I=>{try{const te=await Sn(Dn(Kt(ve,"postComments"),hn("postId","==",I),Ym("createdAt","asc"),Xm(50)));Wt(Ne=>({...Ne,[I]:te.docs.map(st=>({id:st.id,...st.data()}))}))}catch(te){console.error("Error loading comments:",te)}},Us=I=>{const te=new Set(Ct);te.has(I)?te.delete(I):(te.add(I),Zt[I]||Ks(I)),an(te)},Mr=async I=>{const te=(Ln[I]||"").trim(),Ne=_e[I];if(!(!te&&!Ne||!t)){In(st=>({...st,[I]:!0}));try{let st=null;if(Ne){const $t=Do(Po,`comment-images/${Date.now()}_${Ne.name}`);await eb($t,Ne),st=await Dl($t)}const jt={postId:I,authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:te||"",createdAt:vi()};st&&(jt.imageURL=st);const Ut=Bn[I];Ut&&(jt.replyToId=Ut.id,jt.replyToName=Ut.authorName),await Ia(Kt(ve,"postComments"),jt),await Sa(Ge(ve,"posts",I),{commentCount:Nl(1)});const ot=De.find($t=>$t.id===I);ot&&we(ot.authorId,"comment",{postId:I});const Gt=te.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Gt){const $t=new Set;Gt.forEach(nn=>{const zt=nn.slice(1).trim(),on=Ds.find(Ss=>Ss.name&&Ss.name.toLowerCase()===zt.toLowerCase());on&&!$t.has(on.id)&&($t.add(on.id),we(on.id,"mention",{postId:I}))})}as($t=>({...$t,[I]:""})),ke($t=>({...$t,[I]:null})),be($t=>({...$t,[I]:null})),z($t=>({...$t,[I]:null})),ut.current[I]&&(ut.current[I].value=""),Be($t=>$t.map(nn=>nn.id===I?{...nn,commentCount:(nn.commentCount||0)+1}:nn)),await Ks(I)}catch(st){console.error("Comment error:",st),he("Failed to comment","error")}finally{In(st=>({...st,[I]:!1}))}}},Lr=async(I,te)=>{try{await Rr(Ge(ve,"postComments",te)),await Sa(Ge(ve,"posts",I),{commentCount:Nl(-1)}),Wt(Ne=>({...Ne,[I]:(Ne[I]||[]).filter(st=>st.id!==te)})),Be(Ne=>Ne.map(st=>st.id===I?{...st,commentCount:Math.max((st.commentCount||1)-1,0)}:st))}catch(Ne){console.error("Delete comment error:",Ne),he("Failed to delete comment","error")}},Gr=(I,te)=>{const Ne=te.target.files?.[0];if(!Ne)return;if(Ne.size>5*1024*1024){he("Image must be under 5MB","error");return}ke(jt=>({...jt,[I]:Ne}));const st=new FileReader;st.onload=jt=>be(Ut=>({...Ut,[I]:jt.target.result})),st.readAsDataURL(Ne)},Wa=I=>{ke(te=>({...te,[I]:null})),be(te=>({...te,[I]:null})),ut.current[I]&&(ut.current[I].value="")},zi=I=>{qe(I.target.value),I.target.style.height="auto",I.target.style.height=Math.min(I.target.scrollHeight,120)+"px",se(I.target.value,"compose")},Kr=(I,te)=>{as(Ne=>({...Ne,[I]:te})),se(te,I)};return a.jsx(Mu,{children:a.jsxs("div",{className:"cb-dashboard","data-theme":u?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsxs("div",{className:"header-notif-wrap",ref:ks,children:[a.jsxs("button",{className:"header-notif-btn",onClick:()=>{er(!mn),mn||$n()},"aria-label":"Notifications",children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),a.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),Hn>0&&a.jsx("span",{className:"header-notif-badge",children:Hn>9?"9+":Hn})]}),mn&&a.jsxs("div",{className:"notif-panel",children:[a.jsxs("div",{className:"notif-panel-header",children:[a.jsx("span",{className:"notif-panel-title",children:"Notifications"}),Tt.length>0&&a.jsx("button",{className:"notif-clear-btn",onClick:Q,children:"Clear all"})]}),a.jsx("div",{className:"notif-panel-list",children:Tt.length===0?a.jsx("div",{className:"notif-empty",children:"No notifications yet"}):Tt.map(I=>a.jsxs("div",{className:`notif-item${I.read?"":" unread"}`,onClick:()=>{if(er(!1),I.type==="buddy_request"||I.type==="buddy_accept")g("/client/core-buddy/buddies");else if((I.type==="like"||I.type==="comment")&&I.postId){if(!Ct.has(I.postId)){const te=new Set(Ct);te.add(I.postId),an(te),Zt[I.postId]||Ks(I.postId)}setTimeout(()=>{const te=document.getElementById(`post-${I.postId}`);te&&te.scrollIntoView({behavior:"smooth",block:"center"})},150)}else I.type==="like"||I.type==="comment"?document.querySelector(".cb-journey-section")?.scrollIntoView({behavior:"smooth"}):I.type==="mention"&&g(`/client/core-buddy/profile/${I.fromId}`)},children:[a.jsx("div",{className:"notif-item-avatar",children:I.fromPhotoURL?a.jsx("img",{src:I.fromPhotoURL,alt:""}):a.jsx("span",{children:(I.fromName||"?")[0]})}),a.jsxs("div",{className:"notif-item-body",children:[a.jsxs("p",{className:"notif-item-text",children:[a.jsx("strong",{children:I.fromName})," ",I.type==="buddy_request"&&"sent you a buddy request",I.type==="buddy_accept"&&"accepted your buddy request",I.type==="like"&&"liked your post",I.type==="comment"&&"commented on your post",I.type==="mention"&&"mentioned you"]}),a.jsx("span",{className:"notif-item-time",children:sb(I.createdAt)})]})]},I.id))})]})]}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:h,"aria-label":"Toggle theme",children:u?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})}),a.jsx("button",{onClick:s,"aria-label":"Log out",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),a.jsxs("main",{className:"cb-main",children:[a.jsxs("div",{className:"cb-ring-container",children:[a.jsxs("div",{className:"cb-ring",children:[a.jsx("svg",{className:"cb-ring-svg",viewBox:"0 0 200 200",children:q0.map((I,te)=>{const Ne=te<T;return a.jsx("line",{x1:I.x1,y1:I.y1,x2:I.x2,y2:I.y2,className:`ring-tick ${Ne?"elapsed":"remaining"}`,strokeWidth:I.thick?"3":"2"},te)})}),a.jsxs("div",{className:"cb-ring-center",children:[a.jsxs("div",{className:"cb-ring-logo",onClick:()=>Pt.current?.click(),role:"button",tabIndex:0,"aria-label":"Change profile photo",children:[a.jsx("img",{src:Nt||"/Logo.webp",alt:Nt?"Profile":"Mind Core Fitness"}),a.jsx("div",{className:`cb-photo-overlay${Xt?" uploading":""}`,children:Xt?a.jsx("div",{className:"cb-photo-spinner"}):a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),a.jsx("input",{ref:Pt,type:"file",accept:"image/*",onChange:ht,style:{display:"none"}})]}),!Nt&&!Xt&&a.jsx("div",{className:"cb-photo-badge",onClick:()=>Pt.current?.click(),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),a.jsxs("div",{className:"cb-ring-countdown",children:[a.jsx("span",{className:"cb-timer-digit",children:String(b.hours).padStart(2,"0")}),a.jsx("span",{className:"cb-timer-colon",children:":"}),a.jsx("span",{className:"cb-timer-digit",children:String(b.minutes).padStart(2,"0")}),a.jsx("span",{className:"cb-timer-colon",children:":"}),a.jsx("span",{className:"cb-timer-digit cb-timer-seconds",children:String(b.seconds).padStart(2,"0")})]}),a.jsx("span",{className:"cb-ring-label",children:"remaining today"}),a.jsxs("p",{className:"cb-ring-tagline",children:[nb[Yt].text," ",a.jsx("strong",{children:nb[Yt].bold})]},Yt)]}),a.jsx("div",{className:"cb-stats-row",children:ci.map(I=>{const te=(I.size==="large",38),Ne=2*Math.PI*te,st=Ne-I.pct/100*Ne;return a.jsxs("div",{className:`cb-stat-item${I.size==="large"?" cb-stat-large":""}`,children:[a.jsxs("div",{className:"cb-stat-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-stat-track",cx:"50",cy:"50",r:te}),a.jsx("circle",{className:"cb-stat-fill",cx:"50",cy:"50",r:te,style:{stroke:I.color},strokeDasharray:Ne,strokeDashoffset:st})]}),a.jsx("span",{className:"cb-stat-value",style:{color:I.color},children:I.value})]}),a.jsx("span",{className:"cb-stat-label",children:I.label})]},I.label)})}),a.jsxs("p",{className:"cb-coach-msg",children:[Fi.main," ",a.jsx("strong",{children:kn}),"  ",Fi.sub]}),tr&&a.jsxs("button",{className:"cb-nudge-card",onClick:tr.action||void 0,style:tr.action?void 0:{cursor:"default"},children:[a.jsxs("div",{className:"cb-nudge-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-nudge-ring-track",cx:"50",cy:"50",r:"38"}),a.jsx("circle",{className:"cb-nudge-ring-fill",cx:"50",cy:"50",r:"38",strokeDasharray:2*Math.PI*38,strokeDashoffset:2*Math.PI*38-tr.pct/100*2*Math.PI*38})]}),a.jsx("span",{className:"cb-nudge-ring-val",children:tr.ringLabel})]}),a.jsxs("div",{className:"cb-nudge-info",children:[a.jsx("span",{className:"cb-nudge-label",children:tr.label}),a.jsx("span",{className:"cb-nudge-title",children:tr.message}),tr.cta&&a.jsxs("span",{className:"cb-nudge-cta",children:[tr.cta," "]})]})]}),a.jsxs("div",{className:"cb-features",children:[t?.buddyEnabled&&a.jsxs("button",{className:"cb-feature-card cb-card-buddy ripple-btn",onClick:I=>{Bt(I),g("/client/core-buddy/buddy")},children:[a.jsx("div",{className:"cb-buddy-icon",children:a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 2a4 4 0 0 1 4 4v2a4 4 0 0 1-8 0V6a4 4 0 0 1 4-4z"}),a.jsx("path",{d:"M18 14c2 1 3 3 3 5v2H3v-2c0-2 1-4 3-5"}),a.jsx("circle",{cx:"9",cy:"7",r:"0.5",fill:"currentColor"}),a.jsx("circle",{cx:"15",cy:"7",r:"0.5",fill:"currentColor"}),a.jsx("path",{d:"M9.5 10a2.5 2.5 0 0 0 5 0"}),a.jsx("path",{d:"M7 13c1.5 1 3.5 1.5 5 1.5s3.5-.5 5-1.5"})]})}),a.jsxs("div",{className:"cb-card-content",children:[a.jsxs("h3",{children:["Buddy ",a.jsx("span",{className:"cb-buddy-badge",children:"AI"})]}),a.jsx("p",{className:"cb-card-desc",children:"Your AI training partner"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:`cb-feature-card cb-card-nutrition cb-card-has-preview ripple-btn${m?"":" cb-card-locked"}`,onClick:I=>{Bt(I),g(m?"/client/core-buddy/nutrition":"/upgrade")},children:[a.jsxs("div",{className:"cb-card-top-row",children:[a.jsx("div",{className:"cb-card-content",children:a.jsxs("h3",{children:["Today's Nutrition ",!m&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]})}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsx("div",{className:"cb-card-preview-row",children:a.jsx("div",{className:"cb-mini-rings",children:[{label:"P",pct:Es("protein"),color:"#14b8a6"},{label:"C",pct:Es("carbs"),color:"var(--color-primary)"},{label:"F",pct:Es("fats"),color:"#eab308"},{label:"Cal",pct:Es("calories"),color:"#38B6FF"}].map(I=>{const Ne=2*Math.PI*38,st=Ne-I.pct/100*Ne;return a.jsxs("div",{className:"cb-mini-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-mini-track",cx:"50",cy:"50",r:38}),a.jsx("circle",{className:"cb-mini-fill",cx:"50",cy:"50",r:38,style:{stroke:I.color},strokeDasharray:Ne,strokeDashoffset:st})]}),a.jsx("span",{style:{color:I.color},children:I.label})]},I.label)})})}),a.jsx("p",{className:"cb-card-desc",children:"Track macros, scan barcodes, log water"})]}),a.jsxs("button",{className:"cb-feature-card cb-card-workouts-hero ripple-btn",onClick:I=>{Bt(I),g("/client/core-buddy/workouts")},children:[a.jsx("h3",{className:"cb-hero-title",children:"Workouts"}),a.jsxs("div",{className:"cb-hero-stats",children:[a.jsxs("span",{children:[ne," this week"]}),a.jsx("span",{className:"cb-hero-dot",children:""}),a.jsxs("span",{children:[H," total"]})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"cb-grid-row",children:[a.jsxs("button",{className:`cb-feature-card cb-grid-card cb-card-consistency ripple-btn${m?"":" cb-card-locked"}`,onClick:I=>{Bt(I),g(m?"/client/core-buddy/consistency":"/upgrade")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsxs("h3",{children:["Habits ",!m&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),a.jsx("div",{className:"cb-habit-dots",children:Array.from({length:_o},(I,te)=>a.jsx("span",{className:`cb-habit-dot${te<q?" done":""}`},te))}),a.jsxs("span",{className:"cb-habit-dots-label",children:[q,"/",_o," today"]})]}),a.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:`cb-feature-card cb-grid-card cb-card-progress ripple-btn${m?"":" cb-card-locked"}`,onClick:I=>{Bt(I),g(m?"/client/personal-bests?mode=corebuddy":"/upgrade")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsxs("h3",{children:["PBs ",!m&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),Oe.length>0?a.jsx("div",{className:"cb-pb-preview",children:Oe.slice(0,2).map(I=>a.jsxs("div",{className:"cb-pb-entry",children:[a.jsx("span",{className:"cb-pb-name",children:I.name}),a.jsxs("span",{className:"cb-pb-value",children:[I.weight,"kg"]})]},I.name))}):a.jsxs("div",{className:"cb-progress-preview",children:[a.jsx("svg",{className:"cb-progress-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),a.jsx("span",{children:"Start lifting!"})]})]}),a.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]})]}),a.jsxs("button",{className:`cb-feature-card cb-card-leaderboard ripple-btn${m?"":" cb-card-locked"}`,onClick:I=>{Bt(I),g(m?"/client/leaderboard":"/upgrade")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsxs("h3",{children:["Leaderboard ",!m&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),ze.length>0?a.jsx("div",{className:"cb-lb-preview",children:ze.map((I,te)=>{const Ne=["#FFD700","#A8B4C0","#CD7F32"][te],st=I.name?I.name.split(" ").map(Ut=>Ut[0]).join("").slice(0,2).toUpperCase():"?",jt=I.id===t?.id;return a.jsxs("div",{className:`cb-lb-entry${jt?" cb-lb-me":""}`,children:[a.jsx("div",{className:"cb-lb-avatar",style:{borderColor:Ne},children:I.photoURL?a.jsx("img",{src:I.photoURL,alt:"",className:"cb-lb-avatar-img"}):a.jsx("span",{children:st})}),a.jsxs("span",{className:"cb-lb-rank",style:{color:Ne},children:["#",te+1]})]},I.id)})}):a.jsx("p",{children:"Opt in to compete with your Core Buddies"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:`cb-feature-card cb-card-buddies ripple-btn${m?"":" cb-card-locked"}`,onClick:I=>{Bt(I),g(m?"/client/core-buddy/buddies":"/upgrade")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsxs("h3",{children:["Buddies ",!m&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),a.jsx("p",{children:"Connect with other members and track each other's progress"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:`cb-achievements-section${m?"":" cb-card-locked"}`,children:[a.jsxs("h3",{className:"cb-achievements-title",children:["Achievements ",!m&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),m?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"cb-badges-scroll",children:Qd.map(I=>{const te=Ce.includes(I.id);return a.jsx("button",{className:`cb-badge${te?" unlocked":" locked"}`,onClick:()=>bt(I),children:a.jsx("img",{src:I.img,alt:I.name,className:"cb-badge-img"})},I.id)})}),a.jsxs("p",{className:"cb-badges-count",children:[Ce.length,"/",Qd.length," unlocked"]})]}):a.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>g("/upgrade"),children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{children:"Upgrade to unlock achievements"})]})]}),a.jsxs("div",{className:"cb-journey-section",children:[a.jsxs("h3",{className:"cb-journey-title",children:["My Journey ",!m&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),m?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"journey-compose",children:[a.jsx("div",{className:"journey-compose-avatar",children:Nt?a.jsx("img",{src:Nt,alt:""}):a.jsx("span",{children:Cd(t?.name)})}),a.jsxs("div",{className:"journey-compose-body",style:{position:"relative"},children:[a.jsx("textarea",{ref:lt,placeholder:"Share your progress... (use @ to mention)",value:Me,onChange:zi,rows:1,maxLength:500}),E&&K==="compose"&&Ye.length>0&&a.jsx("div",{className:"mention-dropdown",children:Ye.map(I=>a.jsxs("button",{className:"mention-option",onClick:()=>Ue(I,"compose"),children:[a.jsx("div",{className:"mention-option-avatar",children:I.photoURL?a.jsx("img",{src:I.photoURL,alt:""}):a.jsx("span",{children:Cd(I.name)})}),a.jsx("span",{children:I.name})]},I.id))}),Mt&&a.jsxs("div",{className:"journey-image-preview",children:[a.jsx("img",{src:Mt,alt:"Preview"}),a.jsx("button",{className:"journey-image-remove",onClick:yr,"aria-label":"Remove image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"journey-compose-actions",children:[a.jsx("button",{className:"journey-image-btn",onClick:()=>It.current?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:It,type:"file",accept:"image/*",onChange:ws,hidden:!0}),(Me.trim()||St)&&a.jsx("button",{className:"journey-post-btn",onClick:ur,disabled:Z,children:Z?a.jsx("div",{className:"journey-btn-spinner"}):"Post"})]})]})]}),nt?a.jsx("div",{className:"journey-loading",children:a.jsx("div",{className:"cb-spinner"})}):De.length===0?a.jsxs("div",{className:"journey-empty",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("p",{children:"Start sharing your fitness journey!"})]}):a.jsx("div",{className:"journey-list",children:De.map(I=>a.jsxs("div",{id:`post-${I.id}`,className:"journey-post",children:[a.jsxs("div",{className:"journey-post-header",children:[a.jsx("div",{className:"journey-post-avatar",children:I.authorPhotoURL?a.jsx("img",{src:I.authorPhotoURL,alt:""}):a.jsx("span",{children:Cd(I.authorName)})}),a.jsxs("div",{className:"journey-post-meta",children:[a.jsx("span",{className:"journey-post-name",children:I.authorName}),a.jsx("span",{className:"journey-post-time",children:sb(I.createdAt)})]}),a.jsx("button",{className:"journey-delete-btn",onClick:()=>Pr(I.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),I.content&&a.jsx("p",{className:"journey-post-content",children:We(I.content)}),I.imageURL&&a.jsx("div",{className:"journey-post-image",children:a.jsx("img",{src:I.imageURL,alt:"Post",loading:"lazy"})}),a.jsxs("div",{className:"journey-post-actions",children:[a.jsxs("button",{className:`journey-action-btn${ct.has(I.id)?" liked":""}`,onClick:()=>ls(I.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:ct.has(I.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:I.likeCount||0})]}),a.jsxs("button",{className:`journey-action-btn${Ct.has(I.id)?" active":""}`,onClick:()=>Us(I.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:I.commentCount||0})]})]}),Ct.has(I.id)&&a.jsxs("div",{className:"journey-comments",children:[Zt[I.id]?.length>0?Zt[I.id].map(te=>a.jsxs("div",{className:"journey-comment",children:[a.jsx("div",{className:"journey-comment-avatar",children:te.authorPhotoURL?a.jsx("img",{src:te.authorPhotoURL,alt:""}):a.jsx("span",{children:Cd(te.authorName)})}),a.jsxs("div",{className:"journey-comment-body",children:[a.jsxs("div",{className:"journey-comment-bubble",children:[a.jsx("span",{className:"journey-comment-name",children:te.authorName}),te.replyToName&&a.jsxs("span",{className:"journey-comment-reply-tag",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"9 14 4 9 9 4"}),a.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),te.replyToName]}),te.content&&a.jsx("span",{className:"journey-comment-text",children:We(te.content)}),te.imageURL&&a.jsx("img",{className:"journey-comment-image",src:te.imageURL,alt:"Comment",loading:"lazy"})]}),a.jsxs("div",{className:"journey-comment-actions-row",children:[a.jsx("span",{className:"journey-comment-time",children:sb(te.createdAt)}),a.jsx("button",{className:"journey-comment-reply-btn",onClick:()=>z(Ne=>({...Ne,[I.id]:{id:te.id,authorName:te.authorName}})),children:"Reply"}),a.jsx("button",{className:"journey-comment-delete-btn",onClick:()=>Lr(I.id,te.id),"aria-label":"Delete comment",children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]})]},te.id)):a.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),Bn[I.id]&&a.jsxs("div",{className:"journey-comment-replying",children:[a.jsxs("span",{children:["Replying to ",a.jsx("strong",{children:Bn[I.id].authorName})]}),a.jsx("button",{onClick:()=>z(te=>({...te,[I.id]:null})),"aria-label":"Cancel reply",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),Ee[I.id]&&a.jsxs("div",{className:"journey-comment-img-preview",children:[a.jsx("img",{src:Ee[I.id],alt:"Preview"}),a.jsx("button",{onClick:()=>Wa(I.id),"aria-label":"Remove image",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[a.jsx("button",{className:"journey-comment-img-btn",onClick:()=>ut.current[I.id]?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:te=>{ut.current[I.id]=te},type:"file",accept:"image/*",onChange:te=>Gr(I.id,te),hidden:!0}),a.jsx("input",{type:"text",placeholder:"Comment",value:Ln[I.id]||"",onChange:te=>Kr(I.id,te.target.value),onKeyDown:te=>{te.key==="Enter"&&Mr(I.id)},maxLength:300}),E&&K===I.id&&Ye.length>0&&a.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:Ye.map(te=>a.jsxs("button",{className:"mention-option",onClick:()=>Ue(te,I.id),children:[a.jsx("div",{className:"mention-option-avatar",children:te.photoURL?a.jsx("img",{src:te.photoURL,alt:""}):a.jsx("span",{children:Cd(te.name)})}),a.jsx("span",{children:te.name})]},te.id))}),a.jsx("button",{onClick:()=>Mr(I.id),disabled:!(Ln[I.id]||"").trim()&&!_e[I.id]||bn[I.id],children:bn[I.id]?a.jsx("div",{className:"journey-btn-spinner-sm"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),a.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},I.id))})]}):a.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>g("/upgrade"),children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{children:"Upgrade to share your journey"})]})]})]})]}),yt&&a.jsx("div",{className:"cb-badge-overlay",onClick:()=>bt(null),children:a.jsxs("div",{className:"cb-badge-overlay-content",onClick:I=>I.stopPropagation(),children:[a.jsx("img",{src:yt.img,alt:yt.name,className:`cb-badge-overlay-img${Ce.includes(yt.id)?"":" cb-badge-overlay-img-locked"}`}),Ce.includes(yt.id)?a.jsx("span",{className:"cb-badge-status unlocked",children:"Unlocked"}):a.jsx("span",{className:"cb-badge-status locked",children:"Locked"}),a.jsx("button",{className:"cb-badge-overlay-close",onClick:()=>bt(null),children:"Tap to close"})]})}),a.jsx(Ti,{active:"home"}),dn&&a.jsxs("div",{className:`toast-notification ${dn.type}`,children:[dn.type==="info"&&a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),a.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),dn.message]}),a.jsx(wV,{steps:Bs,active:Ot,onFinish:kt}),et&&a.jsxs("div",{className:"cb-celebration-overlay",onClick:()=>ft(null),children:[a.jsx("div",{className:"cb-confetti-container",children:Array.from({length:30},(I,te)=>a.jsx("span",{className:"cb-confetti-piece",style:{"--angle":`${Math.random()*360}deg`,"--distance":`${80+Math.random()*120}px`,"--delay":`${Math.random()*.3}s`,"--color":["#FFD700","#FF6B6B","#4ECDC4","#45B7D1","#F7DC6F","#BB8FCE","#FF8C42","#38B6FF"][te%8],"--size":`${6+Math.random()*6}px`,"--drift":`${(Math.random()-.5)*60}px`}},te))}),a.jsxs("div",{className:"cb-celebration-content",onClick:I=>I.stopPropagation(),children:[a.jsx("div",{className:"cb-celebration-glow"}),a.jsx("img",{src:et.img,alt:et.name,className:"cb-celebration-badge-img"}),a.jsx("h2",{className:"cb-celebration-title",children:"Badge Unlocked!"}),a.jsx("p",{className:"cb-celebration-name",children:et.name}),a.jsx("button",{className:"cb-celebration-dismiss",onClick:()=>ft(null),children:"Tap to continue"})]})]})]})})}const rb=new Map;function wo(){return new Date().toISOString().split("T")[0]}const VT=[{key:"breakfast",label:"Breakfast"},{key:"lunch",label:"Lunch"},{key:"dinner",label:"Dinner"},{key:"snacks",label:"Snacks"}],NV={breakfast:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1"}),a.jsx("path",{d:"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"}),a.jsx("line",{x1:"6",y1:"1",x2:"6",y2:"4"}),a.jsx("line",{x1:"10",y1:"1",x2:"10",y2:"4"}),a.jsx("line",{x1:"14",y1:"1",x2:"14",y2:"4"})]}),lunch:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}),dinner:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),snacks:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})};function CV(){const n=new Date().getHours();return n<11?"breakfast":n<14?"lunch":n<17?"snacks":"dinner"}function AV(){const{currentUser:n,isClient:e,clientData:t,loading:s}=Wr(),{isDark:o,toggleTheme:c,accent:u}=Ui(),h=lr(),[m,g]=_.useState("loading"),[b,x]=_.useState(null),[T,N]=_.useState({gender:"male",age:"",weight:"",weightUnit:"kg",height:"",heightUnit:"cm",heightFeet:"",heightInches:"",dailyActivity:"sedentary",trainingFrequency:"moderate",goal:"maintain",deficitLevel:"moderate"}),[B,P]=_.useState(null),[M,Y]=_.useState(wo()),[H,X]=_.useState({entries:[],water:0}),[fe,je]=_.useState({protein:0,carbs:0,fats:0,calories:0}),[Te,C]=_.useState(!1),[S,D]=_.useState(!1),[U,V]=_.useState(()=>{const E=new Date;return{year:E.getFullYear(),month:E.getMonth()}}),[q,L]=_.useState(CV),[Ke,_t]=_.useState(null),[$,ge]=_.useState(null),[Le,Qe]=_.useState(!1),[ne,O]=_.useState(null),[ie,Ie]=_.useState(""),[Oe,it]=_.useState(!1),[ze,vt]=_.useState(""),[Nt,at]=_.useState([]),[Xt,An]=_.useState(!1),[Pt,Ce]=_.useState({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),[ee,yt]=_.useState(null),[bt,et]=_.useState("100"),[ft,rt]=_.useState(0),[tt,Ft]=_.useState("weight"),[ts,Dt]=_.useState(0),[un,fs]=_.useState(null);_.useRef(null);const Yt=_.useRef(!1),Mn=_.useRef(null),dn=_.useRef(null),Rn=_.useRef(null),he=_.useCallback((E,A="info")=>{fs({message:E,type:A}),setTimeout(()=>fs(null),3e3)},[]);_.useEffect(()=>{!s&&(!n||!e)&&h("/")},[n,e,s,h]),_.useEffect(()=>{if(!t?.id)return;(async()=>{try{const A=await Pn(Ge(ve,"nutritionTargets",t.id));A.exists()?(x(A.data()),g("dashboard")):g("setup")}catch(A){console.error("Error loading nutrition data:",A),g("setup")}})()},[t?.id]),_.useEffect(()=>{if(!t?.id)return;(async()=>{try{const A=await Pn(Ge(ve,"nutritionLogs",`${t.id}_${M}`));if(A.exists()){const K=A.data();X({entries:K.entries||[],water:K.water||0})}else X({entries:[],water:0})}catch(A){console.error("Error loading log:",A),X({entries:[],water:0})}})()},[t?.id,M]),_.useEffect(()=>{const E=H.entries.reduce((A,K)=>({protein:A.protein+(K.protein||0),carbs:A.carbs+(K.carbs||0),fats:A.fats+(K.fats||0),calories:A.calories+(K.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});je(E)},[H.entries]);const De=async E=>{try{await zn(Ge(ve,"nutritionLogs",`${t.id}_${M}`),{clientId:t.id,date:M,entries:E.entries,water:E.water,updatedAt:pt.now()})}catch(A){console.error("Error saving nutrition log:",A)}},Be=M===wo(),nt=(E,A)=>new Date(E,A+1,0).getDate(),Fe=(E,A)=>new Date(E,A,1).getDay(),Me=["January","February","March","April","May","June","July","August","September","October","November","December"],qe=["Su","Mo","Tu","We","Th","Fr","Sa"],St=()=>{let E=parseFloat(T.weight);T.weightUnit==="lbs"&&(E*=.453592);let A;T.heightUnit==="cm"?A=parseFloat(T.height):A=(parseFloat(T.heightFeet)||0)*30.48+(parseFloat(T.heightInches)||0)*2.54;const K=parseInt(T.age);let oe=T.gender==="male"?10*E+6.25*A-5*K+5:10*E+6.25*A-5*K-161;const $e=oe*{sedentary:1.2,light:1.3,moderate:1.4,active:1.5}[T.dailyActivity],He={low:100,moderate:200,high:300,daily:400},Qt=Math.round($e+He[T.trainingFrequency]);let Ot=Qt,Yn,Gs;switch(T.goal){case"lose":Ot=Qt*(1-{light:.15,moderate:.2,harsh:.25}[T.deficitLevel]),Yn=2.2,Gs=.3;break;case"build":Ot=Qt*1.1,Yn=2,Gs=.22;break;default:Yn=1.8,Gs=.25}Ot=Math.max(Ot,T.gender==="male"?1400:1100);const Bs=Math.round(E*Yn),Hn=Math.round(Ot*Gs/9),$n=Math.max(0,Math.round((Ot-Bs*4-Hn*9)/4));P({calories:Math.round(Ot),protein:Bs,carbs:$n,fats:Hn,bmr:Math.round(oe),neat:Math.round($e),exerciseAdd:He[T.trainingFrequency],tdee:Math.round(Qt)})},wt=async()=>{if(B)try{const E={clientId:t.id,calories:B.calories,protein:B.protein,carbs:B.carbs,fats:B.fats,waterGoal:8,goal:T.goal,updatedAt:pt.now()};await zn(Ge(ve,"nutritionTargets",t.id),E),x(E),g("dashboard"),he("Macro targets saved!","success")}catch(E){console.error("Error saving targets:",E),he("Failed to save targets. Please try again.","error")}},Mt=()=>{const E=T.weight&&parseFloat(T.weight)>0,A=T.age&&parseInt(T.age)>0,K=T.heightUnit==="cm"?T.height&&parseFloat(T.height)>0:T.heightFeet&&parseFloat(T.heightFeet)>0||T.heightInches&&parseFloat(T.heightInches)>0;return E&&A&&K},Jt="nut_favourite_foods",Z=()=>{try{return JSON.parse(localStorage.getItem(Jt)||"[]")}catch{return[]}},xe=E=>Z().some(A=>A.name.toLowerCase()===(E||"").toLowerCase()),ct=E=>{const A=Z(),K=A.findIndex(oe=>oe.name.toLowerCase()===E.name.toLowerCase());K>=0?A.splice(K,1):A.unshift({name:E.name,protein:E.protein,carbs:E.carbs,fats:E.fats,calories:E.calories,serving:E.serving,per100g:E.per100g||null,servingUnit:E.servingUnit||"g",portion:E.portion||null}),localStorage.setItem(Jt,JSON.stringify(A)),Dt(oe=>oe+1)},Lt=E=>{const A=[...H.entries,{...E,meal:q,id:Date.now(),addedAt:new Date().toISOString()}],K={...H,entries:A};X(K),De(K),ge(null),yt(null),et("100"),rt(0),Ft("weight"),Ce({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),he("Food added!","success")},Ct=E=>{const A=H.entries.filter(oe=>oe.id!==E),K={...H,entries:A};X(K),De(K)},an=_.useRef(null),Zt=async()=>{Qe(!0);const E=document.querySelector("#barcode-reader");if(!E){Qe(!1),he("Scanner container not found.","error");return}if(!an.current)try{const K=await Dr(()=>import("./quagga.min-BbicSfvA.js").then(oe=>oe.q),[]);an.current=K.default}catch(K){console.error("Failed to load barcode scanner:",K),Qe(!1),he("Could not load scanner.","error");return}const A=an.current;A.init({inputStream:{type:"LiveStream",target:E,constraints:{facingMode:"environment",width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080}}},locator:{patchSize:"medium",halfSample:!0},numOfWorkers:navigator.hardwareConcurrency||2,decoder:{readers:["ean_reader","ean_8_reader","upc_reader","upc_e_reader","code_128_reader","code_39_reader"]},locate:!0},K=>{if(K){console.error("Quagga init error:",K),Qe(!1),he("Could not access camera. Check permissions.","error");return}A.start(),Yt.current=!0}),A.onDetected(K=>{const oe=K.codeResult.decodedCodes?.filter($e=>$e.error!==void 0)?.map($e=>$e.error)||[];if((oe.length>0?oe.reduce(($e,He)=>$e+He,0)/oe.length:1)<.15){const $e=K.codeResult.code;A.offDetected(),O($e)}})},Wt=()=>{const E=an.current;Yt.current&&E&&(E.stop(),E.offDetected(),Yt.current=!1),Qe(!1)},Ln=/\b(milk|semi.skimmed|skimmed|whole milk|oat milk|almond milk|soy milk|juice|smoothie|water|squash|cordial|cola|pepsi|fanta|lemonade|soda|beer|wine|cider|lager|spirit|whisky|vodka|rum|gin|brandy|cream|yoghurt drink|milkshake|coffee|tea|broth|stock|soup|sauce|ketchup|vinegar|oil|syrup|honey|custard|coconut water|kombucha|energy drink|protein shake)\b/i,as=E=>/ml|cl|\dl(?!b)|litre|liter|fl\s?oz/i.test((E||"").replace(/\s/g,"")),bn=E=>{if(!E)return{value:100,unit:"g"};const A=E.toLowerCase().replace(/\s/g,""),K=A.match(/([\d.]+)/),oe=K?parseFloat(K[1]):100;return as(E)?/cl/.test(A)?{value:oe*10,unit:"ml"}:/(?:^|\d)l(?!i)/.test(A)&&!/ml/.test(A)?{value:oe*1e3,unit:"ml"}:{value:oe,unit:"ml"}:{value:oe,unit:"g"}},In=E=>{if(as(E.serving_size)||as(E.quantity))return"ml";const A=E.product_name||E.product_name_en||"";return Ln.test(A)?"ml":"g"},Bn=[{pattern:/\b(toast|bread|loaf|brioche|bagel|pitta|wrap|tortilla|crumpet|muffin|waffle|pancake)\b/i,label:"slice",weight:36},{pattern:/\begg\b/i,label:"egg",weight:60},{pattern:/\b(biscuit|cookie|digestive|hobnob|rich tea|oreo)\b/i,label:"biscuit",weight:13},{pattern:/\b(sausage|banger)\b/i,label:"sausage",weight:57},{pattern:/\b(rasher|bacon)\b/i,label:"rasher",weight:25},{pattern:/\b(rice cake)\b/i,label:"cake",weight:9},{pattern:/\b(cracker|ryvita)\b/i,label:"cracker",weight:10}],z=(E,A)=>{const K=E||"",oe=K.match(/\((\d+\.?\d*)\s*g\)/i),Ye=K.match(/(?:^|per\s+)(\d*\s*[a-z][a-z\s]*?)(?:\s*\(|\s*-\s*|\s*$)/i);if(oe&&Ye){const Qt=parseFloat(oe[1]);let Ot=Ye[1].replace(/^\d+\s*/,"").trim();if(Ot&&Qt>0)return{label:Ot,weight:Qt}}const $e=K.match(/(\d+\.?\d*)\s*g\s*[\/=]\s*(\d*\s*[a-z][a-z\s]*)/i);if($e){const Qt=parseFloat($e[1]);let Ot=$e[2].replace(/^\d+\s*/,"").trim();if(Ot&&Qt>0)return{label:Ot,weight:Qt}}const He=A||"";for(const{pattern:Qt,label:Ot,weight:Yn}of Bn)if(Qt.test(He))return{label:Ot,weight:Yn};return null},_e=E=>{const A=E.nutriments||{},K=In(E),oe=bn(E.serving_size),Ye=K==="ml"?oe.unit==="ml"?oe.value:100:oe.value,$e=E.product_name||E.product_name_en||"Unknown Product",He=z(E.serving_size,$e);return{name:$e,brand:E.brands||"",image:E.image_small_url||E.image_url||null,servingSize:E.serving_size||"100g",servingValue:Ye,servingUnit:K,portion:He,protein:Math.round(A.proteins_100g||A.proteins||0),carbs:Math.round(A.carbohydrates_100g||A.carbohydrates||0),fats:Math.round(A.fat_100g||A.fat||0),calories:Math.round(A["energy-kcal_100g"]||A["energy-kcal"]||(A.energy_100g?A.energy_100g/4.184:0)),per100g:!0}},ke=async E=>{it(!0);try{const A=`https://world.openfoodfacts.org/api/v2/product/${E}?fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,K=await fetch(A);if(!K.ok)throw new Error(`HTTP ${K.status}`);const oe=await K.json();if(oe.status==="success"||oe.status===1||oe.product){const Ye=_e(oe.product);Ye.calories===0&&Ye.protein===0&&Ye.carbs===0?he("Product found but no nutrition data available.","error"):(yt(Ye),Ye.portion?(rt(1),et(String(Ye.portion.weight)),Ft("portion")):(rt(0),et(String(Ye.servingValue||100)),Ft("weight")),Ie(""))}else he("Product not found. Try search or manual entry.","error")}catch(A){console.error("Barcode lookup error:",A),he("Failed to look up product. Check your connection.","error")}it(!1)},Ee=(E,A,K)=>{const oe=E.toLowerCase().trim(),Ye=A.toLowerCase().trim(),$e=K.toLowerCase().trim();let He=0;return(oe===$e||oe===$e+"s"||oe+"s"===$e)&&(He+=100),(oe.endsWith(" "+$e)||oe.endsWith(" "+$e+"s"))&&(He+=40),(oe.startsWith($e+" ")||oe.startsWith($e+"s "))&&(He+=15),$e.split(/\s+/).some(Ot=>Ye===Ot||Ye.startsWith(Ot))&&(He+=30),He+=Math.max(0,30-oe.length),He},be=async()=>{if(!ze.trim())return;Mn.current&&Mn.current.abort();const E=new AbortController;Mn.current=E;const A=ze.trim().toLowerCase(),K=A.split(/\s+/).filter(Boolean);if(rb.has(A)){at(rb.get(A));return}An(!0);try{const Ye=`https://world.openfoodfacts.org/cgi/search.pl?search_terms=${encodeURIComponent(ze.trim())}&search_simple=1&action=process&json=1&page_size=10&lc=en&sort_by=unique_scans_n&fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,$e=await fetch(Ye,{signal:E.signal});if(!$e.ok)throw new Error(`HTTP ${$e.status}`);const Qt=((await $e.json()).products||[]).map(Ot=>_e(Ot)).filter(Ot=>Ot.name!=="Unknown Product"&&(Ot.calories>0||Ot.protein>0)).filter(Ot=>{const Yn=(Ot.name+" "+Ot.brand).toLowerCase();return K.every(Gs=>Yn.includes(Gs))}).sort((Ot,Yn)=>Ee(Yn.name,Yn.brand,A)-Ee(Ot.name,Ot.brand,A)).slice(0,10);rb.set(A,Qt),at(Qt),Qt.length===0&&he("No results found. Try a different search.","info")}catch(oe){if(oe.name==="AbortError")return;console.error("Search error:",oe),he("Search failed. Check your connection.","error")}An(!1)};_.useEffect(()=>{if(dn.current&&clearTimeout(dn.current),!(!ze.trim()||$!=="search"||ee))return dn.current=setTimeout(()=>{be()},700),()=>clearTimeout(dn.current)},[ze]);const lt=()=>{const E={...H,water:H.water+1};X(E),De(E)},It=()=>{if(H.water<=0)return;const E={...H,water:H.water-1};X(E),De(E)},ut={"ring-protein":"#14b8a6","ring-carbs":"var(--color-primary)","ring-fats":"#eab308","ring-cals":"rgba(150,150,150,0.55)"},Tt=80,At=2*Math.PI*Tt,mn=(E,A,K,oe,Ye)=>{const $e=oe>0?Math.min(100,Math.round(K/oe*100)):0,He=At-$e/100*At,Qt=ut[Ye]||"#14b8a6";return a.jsxs("div",{className:"nut-ring-wrap",children:[a.jsxs("svg",{className:"nut-ring-svg",viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"nut-arc-track",cx:"100",cy:"100",r:Tt}),a.jsx("circle",{className:"nut-arc-fill",cx:"100",cy:"100",r:Tt,style:{stroke:Qt},strokeDasharray:At,strokeDashoffset:He})]}),a.jsxs("div",{className:"nut-ring-center",children:[a.jsx("span",{className:"nut-ring-value",style:{color:Qt},children:Math.round(K)}),a.jsxs("span",{className:"nut-ring-target",children:["/ ",oe,E==="Calories"?"":"g"]}),a.jsx("span",{className:"nut-ring-label",style:{color:Qt},children:A})]}),a.jsxs("span",{className:"nut-ring-pct",style:{color:Qt},children:[$e,"%"]})]})};if(_.useEffect(()=>{if(!ne)return;const E=setTimeout(()=>{const A=ne;Wt(),O(null),ke(A)},1500);return()=>clearTimeout(E)},[ne]),_.useEffect(()=>()=>{const E=an.current;if(Yt.current&&E){try{E.stop(),E.offDetected()}catch{}Yt.current=!1}},[]),s||m==="loading")return a.jsxs("div",{className:"nut-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>h("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsx("div",{className:"nut-loading-inline",children:a.jsx("div",{className:"cb-loading-spinner"})})]});if(m==="setup")return a.jsxs("div",{className:"nut-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>h("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:o?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"nut-main",children:[a.jsxs("div",{className:"nut-setup-intro",children:[a.jsx("h2",{children:"Set Your Daily Targets"}),a.jsx("p",{children:"Calculate your personalised macros based on your body and goals."})]}),a.jsxs("div",{className:"nut-calc-form",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Gender"}),a.jsxs("div",{className:"nut-toggle-group",children:[a.jsx("button",{className:T.gender==="male"?"active":"",onClick:()=>{N(E=>({...E,gender:"male"})),P(null)},children:"Male"}),a.jsx("button",{className:T.gender==="female"?"active":"",onClick:()=>{N(E=>({...E,gender:"female"})),P(null)},children:"Female"})]})]}),a.jsxs("div",{className:"nut-form-row",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Age"}),a.jsx("input",{type:"number",value:T.age,onChange:E=>{N(A=>({...A,age:E.target.value})),P(null)},placeholder:"Years",min:"15",max:"100"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Weight"}),a.jsxs("div",{className:"nut-input-unit",children:[a.jsx("input",{type:"number",value:T.weight,onChange:E=>{N(A=>({...A,weight:E.target.value})),P(null)},placeholder:T.weightUnit,min:"30",max:"300"}),a.jsxs("div",{className:"nut-unit-toggle",children:[a.jsx("button",{className:T.weightUnit==="kg"?"active":"",onClick:()=>{N(E=>({...E,weightUnit:"kg"})),P(null)},children:"kg"}),a.jsx("button",{className:T.weightUnit==="lbs"?"active":"",onClick:()=>{N(E=>({...E,weightUnit:"lbs"})),P(null)},children:"lbs"})]})]})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Height"}),a.jsxs("div",{className:"nut-input-unit",children:[T.heightUnit==="cm"?a.jsx("input",{type:"number",value:T.height,onChange:E=>{N(A=>({...A,height:E.target.value})),P(null)},placeholder:"cm",min:"100",max:"250"}):a.jsxs("div",{className:"nut-height-imperial",children:[a.jsx("input",{type:"number",value:T.heightFeet,onChange:E=>{N(A=>({...A,heightFeet:E.target.value})),P(null)},placeholder:"ft",min:"4",max:"7"}),a.jsx("input",{type:"number",value:T.heightInches,onChange:E=>{N(A=>({...A,heightInches:E.target.value})),P(null)},placeholder:"in",min:"0",max:"11"})]}),a.jsxs("div",{className:"nut-unit-toggle",children:[a.jsx("button",{className:T.heightUnit==="cm"?"active":"",onClick:()=>{N(E=>({...E,heightUnit:"cm"})),P(null)},children:"cm"}),a.jsx("button",{className:T.heightUnit==="ft"?"active":"",onClick:()=>{N(E=>({...E,heightUnit:"ft"})),P(null)},children:"ft/in"})]})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Daily Activity (outside of training)"}),a.jsxs("select",{value:T.dailyActivity,onChange:E=>{N(A=>({...A,dailyActivity:E.target.value})),P(null)},children:[a.jsx("option",{value:"sedentary",children:"Sedentary  desk job, under 5k steps"}),a.jsx("option",{value:"light",children:"Lightly Active  office + walking, 5-8k steps"}),a.jsx("option",{value:"moderate",children:"Moderately Active  on feet often, 8-12k steps"}),a.jsx("option",{value:"active",children:"Very Active  physical job, 12k+ steps"})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Training Sessions per Week"}),a.jsxs("select",{value:T.trainingFrequency,onChange:E=>{N(A=>({...A,trainingFrequency:E.target.value})),P(null)},children:[a.jsx("option",{value:"low",children:"1-2 sessions"}),a.jsx("option",{value:"moderate",children:"3-4 sessions"}),a.jsx("option",{value:"high",children:"5-6 sessions"}),a.jsx("option",{value:"daily",children:"7+ sessions"})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Fitness Goal"}),a.jsxs("div",{className:"nut-goal-options",children:[a.jsxs("button",{className:T.goal==="lose"?"active":"",onClick:()=>{N(E=>({...E,goal:"lose"})),P(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"-"}),a.jsx("span",{children:"Lose Weight"})]}),a.jsxs("button",{className:T.goal==="maintain"?"active":"",onClick:()=>{N(E=>({...E,goal:"maintain"})),P(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"="}),a.jsx("span",{children:"Maintain"})]}),a.jsxs("button",{className:T.goal==="build"?"active":"",onClick:()=>{N(E=>({...E,goal:"build"})),P(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"+"}),a.jsx("span",{children:"Build Muscle"})]})]})]}),T.goal==="lose"&&a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Deficit Level"}),a.jsxs("div",{className:"nut-deficit-options",children:[a.jsxs("button",{className:T.deficitLevel==="light"?"active":"",onClick:()=>{N(E=>({...E,deficitLevel:"light"})),P(null)},children:[a.jsx("strong",{children:"Mild"}),a.jsx("span",{children:"15% below TDEE"})]}),a.jsxs("button",{className:T.deficitLevel==="moderate"?"active":"",onClick:()=>{N(E=>({...E,deficitLevel:"moderate"})),P(null)},children:[a.jsx("strong",{children:"Moderate"}),a.jsx("span",{children:"20% below TDEE"})]}),a.jsxs("button",{className:T.deficitLevel==="harsh"?"active":"",onClick:()=>{N(E=>({...E,deficitLevel:"harsh"})),P(null)},children:[a.jsx("strong",{children:"Aggressive"}),a.jsx("span",{children:"25% below TDEE"})]})]})]}),a.jsx("button",{className:"nut-calc-btn",onClick:St,disabled:!Mt(),children:"Calculate Macros"})]}),B&&a.jsxs("div",{className:"nut-calc-results",children:[a.jsx("h3",{children:"Your Daily Targets"}),a.jsxs("div",{className:"nut-calc-rings",children:[mn("Protein","Protein",B.protein,B.protein,"ring-protein"),mn("Carbs","Carbs",B.carbs,B.carbs,"ring-carbs"),mn("Fats","Fats",B.fats,B.fats,"ring-fats"),mn("Calories","Calories",B.calories,B.calories,"ring-cals")]}),a.jsxs("div",{className:"nut-calc-info",children:[a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"BMR (body at rest)"}),a.jsxs("span",{children:[B.bmr," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"+ Daily activity (NEAT)"}),a.jsxs("span",{children:[B.neat," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"+ Training sessions"}),a.jsxs("span",{children:["+",B.exerciseAdd," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",style:{fontWeight:600},children:[a.jsx("span",{children:"TDEE (total burn)"}),a.jsxs("span",{children:[B.tdee," cal"]})]})]}),a.jsx("button",{className:"nut-save-targets-btn",onClick:wt,children:"Set as My Daily Targets"})]})]}),un&&a.jsx("div",{className:`toast-notification ${un.type}`,children:un.message})]});const er=E=>{const A=new Date(E+"T12:00:00"),K=A.getDay(),oe=new Date(A);oe.setDate(A.getDate()-(K+6)%7);const Ye=[];for(let $e=0;$e<7;$e++){const He=new Date(oe);He.setDate(oe.getDate()+$e),Ye.push(He.toISOString().split("T")[0])}return Ye},ks=["M","T","W","T","F","S","S"],Ds=(E,A="search")=>{L(E),A==="scan"?(ge("scan"),yt(null)):A==="manual"?(ge("manual"),Ce({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""})):A==="favourites"?ge("favourites"):(ge("search"),at([]),vt(""))},ns=er(M),W=new Date(M+"T12:00:00"),me=`${Me[W.getMonth()]} ${W.getFullYear()}`;return a.jsx(Mu,{children:a.jsxs("div",{className:"nut-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsxs("div",{className:"nut-dark-zone",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>h("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:()=>{g("setup"),P(null)},"aria-label":"Recalculate macros",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:o?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]})]})}),a.jsxs("div",{className:"nut-dark-content",children:[a.jsxs("div",{className:"nut-week-strip",children:[a.jsxs("div",{className:"nut-week-header",children:[a.jsx("button",{className:"nut-week-arrow",onClick:()=>{const E=new Date(M+"T12:00:00");E.setDate(E.getDate()-7);const A=E.toISOString().split("T")[0];Y(A)},"aria-label":"Previous week",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsx("button",{className:"nut-week-month-label",onClick:()=>{C(!Te),V({year:W.getFullYear(),month:W.getMonth()})},children:me}),a.jsx("button",{className:"nut-week-arrow",onClick:()=>{const E=new Date(M+"T12:00:00");E.setDate(E.getDate()+7);const A=E.toISOString().split("T")[0];A<=wo()&&Y(A)},"aria-label":"Next week",disabled:ns[6]>=wo(),children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-week-days",children:ns.map((E,A)=>{const K=new Date(E+"T12:00:00").getDate(),oe=E===M,Ye=E>wo(),$e=E===wo();return a.jsxs("button",{className:`nut-week-day${oe?" selected":""}${$e?" today":""}${Ye?" future":""}`,disabled:Ye,onClick:()=>Y(E),children:[a.jsx("span",{className:"nut-week-day-letter",children:ks[A]}),a.jsx("span",{className:"nut-week-day-num",children:K})]},E)})})]}),Te&&a.jsxs("div",{className:"nut-calendar nut-calendar-dark",children:[a.jsxs("div",{className:"nut-cal-header",children:[a.jsx("button",{onClick:()=>V(E=>{let A=E.month-1,K=E.year;return A<0&&(A=11,K--),{year:K,month:A}}),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsxs("span",{children:[Me[U.month]," ",U.year]}),a.jsx("button",{onClick:()=>V(E=>{let A=E.month+1,K=E.year;return A>11&&(A=0,K++),{year:K,month:A}}),disabled:U.year===new Date().getFullYear()&&U.month>=new Date().getMonth(),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-cal-days-header",children:qe.map(E=>a.jsx("span",{children:E},E))}),a.jsxs("div",{className:"nut-cal-grid",children:[[...Array(Fe(U.year,U.month))].map((E,A)=>a.jsx("span",{},`e${A}`)),[...Array(nt(U.year,U.month))].map((E,A)=>{const K=A+1,oe=`${U.year}-${String(U.month+1).padStart(2,"0")}-${String(K).padStart(2,"0")}`,Ye=oe>wo(),$e=oe===M,He=oe===wo();return a.jsx("button",{className:`nut-cal-day${$e?" selected":""}${He?" today":""}${Ye?" future":""}`,disabled:Ye,onClick:()=>{Y(oe),C(!1)},children:K},K)})]})]}),a.jsxs("div",{className:"nut-rings-row",children:[mn("Protein","Protein",fe.protein,b.protein,"ring-protein"),mn("Carbs","Carbs",fe.carbs,b.carbs,"ring-carbs"),mn("Fats","Fats",fe.fats,b.fats,"ring-fats"),mn("Calories","kCal",fe.calories,b.calories,"ring-cals")]})]})]}),a.jsx("div",{className:"nut-light-zone",children:a.jsxs("div",{className:"nut-light-content",children:[Be&&a.jsxs("button",{className:"nut-water-quick",onClick:()=>D(!0),children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"18",height:"18",children:a.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),a.jsxs("span",{className:"nut-water-quick-count",children:[H.water," / ",b?.waterGoal||8]}),a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",width:"14",height:"14",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})]}),a.jsx("div",{className:"nut-log-section",children:a.jsx("div",{className:"nut-meals-list",children:VT.map(E=>{const A=H.entries.filter(oe=>(oe.meal||"snacks")===E.key),K=A.reduce((oe,Ye)=>({protein:oe.protein+(Ye.protein||0),carbs:oe.carbs+(Ye.carbs||0),fats:oe.fats+(Ye.fats||0),calories:oe.calories+(Ye.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});return a.jsxs("div",{className:"nut-meal-card",children:[a.jsxs("div",{className:"nut-meal-card-header",children:[a.jsx("span",{className:`nut-meal-card-icon nut-meal-icon-${E.key}`,children:NV[E.key]}),a.jsx("span",{className:"nut-meal-card-title",children:E.label}),A.length>0&&a.jsxs("span",{className:"nut-meal-card-cal",children:[K.calories," cal"]}),Be&&a.jsx("button",{className:"nut-meal-add-btn",onClick:()=>_t(Ke===E.key?null:E.key),"aria-label":`Add to ${E.label}`,children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]}),A.length>0&&a.jsxs("div",{className:"nut-meal-bars",children:[a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-p",children:"P"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-protein",style:{width:`${Math.min(100,b.protein>0?K.protein/b.protein*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[K.protein,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-c",children:"C"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-carbs",style:{width:`${Math.min(100,b.carbs>0?K.carbs/b.carbs*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[K.carbs,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-f",children:"F"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-fats",style:{width:`${Math.min(100,b.fats>0?K.fats/b.fats*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[K.fats,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-cal",children:"K"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-cals",style:{width:`${Math.min(100,b.calories>0?K.calories/b.calories*100:0)}%`}})}),a.jsx("span",{className:"nut-meal-bar-val",children:K.calories})]})]}),A.length>0&&a.jsx("div",{className:"nut-log-list",children:A.map(oe=>a.jsxs("div",{className:"nut-log-item",children:[a.jsxs("div",{className:"nut-log-item-info",children:[a.jsx("span",{className:"nut-log-item-name",children:oe.name}),oe.serving&&a.jsx("span",{className:"nut-log-item-serving",children:oe.serving})]}),a.jsxs("div",{className:"nut-log-item-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[oe.protein,"p"]}),a.jsxs("span",{className:"nut-macro-c",children:[oe.carbs,"c"]}),a.jsxs("span",{className:"nut-macro-f",children:[oe.fats,"f"]}),a.jsx("span",{className:"nut-macro-cal",children:oe.calories})]}),Be&&a.jsx("button",{className:"nut-log-delete",onClick:()=>Ct(oe.id),"aria-label":"Remove",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},oe.id))}),A.length===0&&a.jsx("div",{className:"nut-meal-empty",children:a.jsx("p",{children:Be?"Tap + to add food":"No entries"})})]},E.key)})})})]})}),Ke&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"nut-add-picker-backdrop",onClick:()=>_t(null)}),a.jsxs("div",{className:"nut-add-picker",children:[a.jsx("div",{className:"nut-add-picker-handle"}),a.jsxs("h3",{className:"nut-add-picker-title",children:["Add to ",VT.find(E=>E.key===Ke)?.label]}),a.jsxs("div",{className:"nut-add-picker-options",children:[a.jsxs("button",{onClick:()=>{const E=Ke;_t(null),Ds(E,"scan")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),a.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),a.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),a.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),a.jsx("span",{children:"Scan Barcode"})]}),a.jsxs("button",{onClick:()=>{const E=Ke;_t(null),Ds(E,"search")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("span",{children:"Search Food"})]}),a.jsxs("button",{onClick:()=>{const E=Ke;_t(null),Ds(E,"manual")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),a.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),a.jsx("span",{children:"Manual Entry"})]}),a.jsxs("button",{onClick:()=>{const E=Ke;_t(null),Ds(E,"favourites")},children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),a.jsx("span",{children:"Favourites"})]})]})]})]}),S&&a.jsx("div",{className:"nut-modal-overlay",onClick:()=>D(!1),children:a.jsxs("div",{className:"nut-water-popup",onClick:E=>E.stopPropagation(),children:[a.jsxs("div",{className:"nut-water-popup-header",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"20",height:"20",style:{color:"#2196f3"},children:a.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),a.jsx("span",{children:"Water Intake"}),a.jsx("button",{className:"nut-modal-close",onClick:()=>D(!1),children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),a.jsxs("div",{className:"nut-water-popup-body",children:[a.jsx("div",{className:"nut-water-glasses",children:[...Array(b?.waterGoal||8)].map((E,A)=>a.jsx("div",{className:`nut-water-glass ${A<H.water?"filled":""}`,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:A<H.water?"currentColor":"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})})},A))}),a.jsxs("div",{className:"nut-water-popup-count",children:[H.water," / ",b?.waterGoal||8," glasses"]}),a.jsxs("div",{className:"nut-water-btns",children:[a.jsx("button",{onClick:It,disabled:H.water<=0,children:"-"}),a.jsx("button",{onClick:lt,children:"+"})]})]})]})}),$&&a.jsx("div",{className:"nut-modal-overlay",onClick:()=>{Wt(),O(null),ge(null),yt(null)},children:a.jsxs("div",{className:"nut-modal",onClick:E=>E.stopPropagation(),children:[a.jsxs("div",{className:"nut-modal-header",children:[a.jsx("h3",{children:$==="scan"?"Scan Barcode":$==="search"?"Search Food":$==="favourites"?"Favourites":"Manual Entry"}),a.jsx("button",{className:"nut-modal-close",onClick:()=>{Wt(),O(null),ge(null),yt(null)},children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),$==="scan"&&!ee&&a.jsxs("div",{className:"nut-scan-area",children:[a.jsxs("div",{className:"nut-scanner-wrapper",children:[a.jsx("div",{id:"barcode-reader",className:"nut-scanner-view"}),Le&&!ne&&a.jsx("div",{className:"nut-scan-line"}),ne&&a.jsxs("div",{className:"nut-scan-detected-overlay",children:[a.jsx("svg",{className:"nut-scan-detected-tick",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),a.jsx("p",{className:"nut-scan-detected-label",children:"Barcode found!"}),a.jsx("p",{className:"nut-scan-detected-code",children:ne})]})]}),!Le&&a.jsxs("button",{className:"nut-scan-start-btn",onClick:Zt,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),a.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),a.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),a.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),"Open Camera"]}),Le&&!ne&&a.jsx("p",{className:"nut-scan-hint",children:"Align barcode within the frame"}),a.jsx("div",{className:"nut-barcode-divider",children:a.jsx("span",{children:"or enter barcode manually"})}),a.jsxs("div",{className:"nut-barcode-manual",children:[a.jsx("input",{type:"text",inputMode:"numeric",value:ie,onChange:E=>Ie(E.target.value),onKeyDown:E=>E.key==="Enter"&&ie.trim()&&ke(ie.trim()),placeholder:"Enter barcode number"}),a.jsx("button",{onClick:()=>ie.trim()&&ke(ie.trim()),disabled:!ie.trim()||Oe,children:Oe?"...":"Look Up"})]})]}),$==="scan"&&ee&&(()=>{const E=ee.servingUnit||"g",A=ee.portion,K=tt==="portion"&&A?ft*A.weight:parseFloat(bt)||0,oe=K/100,Ye=E==="ml"?[100,200,250,500]:[50,100,150,200],$e=tt==="portion"&&A?`${ft} ${A.label}${ft!==1?"s":""} (${Math.round(K)}${E})`:`${Math.round(K)}${E}`;return a.jsxs("div",{className:"nut-product-result",children:[ee.image&&a.jsx("img",{src:ee.image,alt:ee.name||"Product",className:"nut-product-img",loading:"lazy"}),a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:ee.name}),a.jsx("button",{className:`nut-fav-star confirm${xe(ee.name)?" active":""}`,onClick:()=>ct({name:ee.name,protein:ee.protein,carbs:ee.carbs,fats:ee.fats,calories:ee.calories,serving:ee.servingSize,per100g:{protein:ee.protein,carbs:ee.carbs,fats:ee.fats,calories:ee.calories},servingUnit:ee.servingUnit||"g",portion:ee.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:xe(ee.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),ee.brand&&a.jsx("p",{className:"nut-product-brand",children:ee.brand}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",E,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[ee.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[ee.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[ee.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[ee.calories," cal"]})]}),A&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:tt==="portion"?"active":"",onClick:()=>{Ft("portion"),ft<1&&rt(1)},children:"Portions"}),a.jsxs("button",{className:tt==="weight"?"active":"",onClick:()=>{Ft("weight"),et(String(Math.round(K)||100))},children:["Custom (",E,")"]})]}),tt==="portion"&&A?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>rt(Math.max(1,ft-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:ft}),a.jsxs("span",{className:"nut-stepper-label",children:[A.label,ft!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(K),E]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>rt(ft+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",E,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:bt,onChange:He=>et(He.target.value),onFocus:He=>He.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Ye.map(He=>a.jsxs("button",{className:`nut-quick-btn${bt===String(He)?" active":""}`,onClick:()=>et(String(He)),children:[He,E]},He))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(ee.protein*oe),"p / ",Math.round(ee.carbs*oe),"c / ",Math.round(ee.fats*oe),"f / ",Math.round(ee.calories*oe)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>{yt(null),ge("scan")},children:"Scan Again"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>Lt({name:ee.name,protein:Math.round(ee.protein*oe),carbs:Math.round(ee.carbs*oe),fats:Math.round(ee.fats*oe),calories:Math.round(ee.calories*oe),serving:$e}),children:"Add"})]})]})})(),$==="search"&&!ee&&a.jsxs("div",{className:"nut-search-area",children:[a.jsxs("div",{className:"nut-search-bar",children:[a.jsx("input",{type:"text",ref:Rn,value:ze,onChange:E=>vt(E.target.value),onKeyDown:E=>{E.key==="Enter"&&(clearTimeout(dn.current),be())},onFocus:()=>setTimeout(()=>Rn.current?.scrollIntoView({behavior:"smooth",block:"center"}),350),placeholder:"Search food or product...",autoFocus:!0}),a.jsx("button",{onClick:be,disabled:Xt,children:Xt?"...":"Search"})]}),a.jsxs("div",{className:"nut-search-results",children:[Nt.map((E,A)=>a.jsxs("button",{className:"nut-search-item",onClick:()=>{yt(E),E.portion?(rt(1),et(String(E.portion.weight)),Ft("portion")):(rt(0),et(String(E.servingValue||100)),Ft("weight"))},children:[E.image&&a.jsx("img",{src:E.image,alt:E.name||"Product",loading:"lazy"}),a.jsxs("div",{className:"nut-search-item-info",children:[a.jsx("span",{className:"nut-search-item-name",children:E.name}),E.brand&&a.jsx("span",{className:"nut-search-item-brand",children:E.brand}),a.jsxs("span",{className:"nut-search-item-macros",children:[E.calories," cal  ",E.protein,"p  ",E.carbs,"c  ",E.fats,"f per 100",E.servingUnit||"g"]})]})]},A)),Nt.length===0&&ze&&!Xt&&a.jsx("p",{className:"nut-search-empty",children:"No results found. Try a different search or use manual entry."})]})]}),$==="search"&&ee&&(()=>{const E=ee.servingUnit||"g",A=ee.portion,K=tt==="portion"&&A?ft*A.weight:parseFloat(bt)||0,oe=K/100,Ye=E==="ml"?[100,200,250,500]:[50,100,150,200],$e=tt==="portion"&&A?`${ft} ${A.label}${ft!==1?"s":""} (${Math.round(K)}${E})`:`${Math.round(K)}${E}`;return a.jsxs("div",{className:"nut-product-result",children:[ee.image&&a.jsx("img",{src:ee.image,alt:ee.name||"Product",className:"nut-product-img",loading:"lazy"}),a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:ee.name}),a.jsx("button",{className:`nut-fav-star confirm${xe(ee.name)?" active":""}`,onClick:()=>ct({name:ee.name,protein:ee.protein,carbs:ee.carbs,fats:ee.fats,calories:ee.calories,serving:ee.servingSize,per100g:{protein:ee.protein,carbs:ee.carbs,fats:ee.fats,calories:ee.calories},servingUnit:ee.servingUnit||"g",portion:ee.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:xe(ee.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),ee.brand&&a.jsx("p",{className:"nut-product-brand",children:ee.brand}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",E,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[ee.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[ee.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[ee.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[ee.calories," cal"]})]}),A&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:tt==="portion"?"active":"",onClick:()=>{Ft("portion"),ft<1&&rt(1)},children:"Portions"}),a.jsxs("button",{className:tt==="weight"?"active":"",onClick:()=>{Ft("weight"),et(String(Math.round(K)||100))},children:["Custom (",E,")"]})]}),tt==="portion"&&A?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>rt(Math.max(1,ft-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:ft}),a.jsxs("span",{className:"nut-stepper-label",children:[A.label,ft!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(K),E]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>rt(ft+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",E,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:bt,onChange:He=>et(He.target.value),onFocus:He=>He.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Ye.map(He=>a.jsxs("button",{className:`nut-quick-btn${bt===String(He)?" active":""}`,onClick:()=>et(String(He)),children:[He,E]},He))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(ee.protein*oe),"p / ",Math.round(ee.carbs*oe),"c / ",Math.round(ee.fats*oe),"f / ",Math.round(ee.calories*oe)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>yt(null),children:"Back to Search"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>Lt({name:ee.name,protein:Math.round(ee.protein*oe),carbs:Math.round(ee.carbs*oe),fats:Math.round(ee.fats*oe),calories:Math.round(ee.calories*oe),serving:$e}),children:"Add"})]})]})})(),$==="manual"&&a.jsxs("div",{className:"nut-manual-form",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Food Name"}),a.jsx("input",{type:"text",value:Pt.name,onChange:E=>Ce(A=>({...A,name:E.target.value})),placeholder:"e.g. Chicken Breast",autoFocus:!0})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Serving Size (optional)"}),a.jsx("input",{type:"text",value:Pt.serving,onChange:E=>Ce(A=>({...A,serving:E.target.value})),placeholder:"e.g. 150g, 1 cup"})]}),a.jsxs("div",{className:"nut-manual-macros",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Protein (g)"}),a.jsx("input",{type:"number",value:Pt.protein,onChange:E=>Ce(A=>({...A,protein:E.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Carbs (g)"}),a.jsx("input",{type:"number",value:Pt.carbs,onChange:E=>Ce(A=>({...A,carbs:E.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Fats (g)"}),a.jsx("input",{type:"number",value:Pt.fats,onChange:E=>Ce(A=>({...A,fats:E.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Calories"}),a.jsx("input",{type:"number",value:Pt.calories,onChange:E=>Ce(A=>({...A,calories:E.target.value})),min:"0"})]})]}),a.jsx("button",{className:"nut-btn-primary",disabled:!Pt.name.trim(),onClick:()=>Lt({name:Pt.name,protein:parseFloat(Pt.protein)||0,carbs:parseFloat(Pt.carbs)||0,fats:parseFloat(Pt.fats)||0,calories:parseFloat(Pt.calories)||0,serving:Pt.serving||""}),children:"Add Food"})]}),$==="favourites"&&!ee&&(()=>{const E=Z(),A=K=>{if(K.per100g){const oe=K.per100g;yt({name:K.name,brand:"",image:null,servingSize:K.serving||"100g",servingValue:100,servingUnit:K.servingUnit||"g",portion:K.portion||null,protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories,per100g:!0}),K.portion?(rt(1),et(String(K.portion.weight)),Ft("portion")):(rt(0),et("100"),Ft("weight"))}else Lt({name:K.name,protein:K.protein,carbs:K.carbs,fats:K.fats,calories:K.calories,serving:K.serving||""})};return a.jsx("div",{className:"nut-recent-area",children:E.length===0?a.jsx("p",{className:"nut-search-empty",children:"No favourites yet. Tap the star on any food to save it here."}):a.jsx("div",{className:"nut-recent-list",children:E.map((K,oe)=>a.jsxs("div",{className:"nut-recent-item-row",children:[a.jsx("button",{className:"nut-fav-star active",onClick:Ye=>{Ye.stopPropagation(),ct(K)},children:a.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("button",{className:"nut-recent-item",onClick:()=>A(K),children:[a.jsxs("div",{className:"nut-recent-item-info",children:[a.jsx("span",{className:"nut-recent-item-name",children:K.name}),a.jsx("span",{className:"nut-recent-item-serving",children:K.serving||""})]}),a.jsxs("span",{className:"nut-recent-item-macros",children:[K.calories," cal"]})]})]},oe))})})})(),$==="favourites"&&ee&&(()=>{const E=ee.servingUnit||"g",A=ee.portion,K=tt==="portion"&&A?ft*A.weight:parseFloat(bt)||0,oe=K/100,Ye=E==="ml"?[100,200,250,500]:[50,100,150,200],$e=tt==="portion"&&A?`${ft} ${A.label}${ft!==1?"s":""} (${Math.round(K)}${E})`:`${Math.round(K)}${E}`;return a.jsxs("div",{className:"nut-product-result",children:[a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:ee.name}),a.jsx("button",{className:`nut-fav-star confirm${xe(ee.name)?" active":""}`,onClick:()=>ct({name:ee.name,protein:ee.protein,carbs:ee.carbs,fats:ee.fats,calories:ee.calories,serving:ee.servingSize,per100g:{protein:ee.protein,carbs:ee.carbs,fats:ee.fats,calories:ee.calories},servingUnit:ee.servingUnit||"g",portion:ee.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:xe(ee.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",E,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[ee.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[ee.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[ee.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[ee.calories," cal"]})]}),A&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:tt==="portion"?"active":"",onClick:()=>{Ft("portion"),ft<1&&rt(1)},children:"Portions"}),a.jsxs("button",{className:tt==="weight"?"active":"",onClick:()=>{Ft("weight"),et(String(Math.round(K)||100))},children:["Custom (",E,")"]})]}),tt==="portion"&&A?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>rt(Math.max(1,ft-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:ft}),a.jsxs("span",{className:"nut-stepper-label",children:[A.label,ft!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(K),E]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>rt(ft+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",E,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:bt,onChange:He=>et(He.target.value),onFocus:He=>He.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Ye.map(He=>a.jsxs("button",{className:`nut-quick-btn${bt===String(He)?" active":""}`,onClick:()=>et(String(He)),children:[He,E]},He))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(ee.protein*oe),"p / ",Math.round(ee.carbs*oe),"c / ",Math.round(ee.fats*oe),"f / ",Math.round(ee.calories*oe)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>yt(null),children:"Back to Favourites"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>Lt({name:ee.name,protein:Math.round(ee.protein*oe),carbs:Math.round(ee.carbs*oe),fats:Math.round(ee.fats*oe),calories:Math.round(ee.calories*oe),serving:$e}),children:"Add"})]})]})})()]})}),a.jsx(Ti,{active:"nutrition"}),un&&a.jsx("div",{className:`toast-notification ${un.type}`,children:un.message})]})})}const OT="/login/assets/randomiser-glq9YJkL.jpg",RV="/login/assets/programme-card-workout-CnNzTYkz.webp",IV="/login/assets/prog-fullbody-4wk-r6m9HJys.jpg",DV="/login/assets/mg-arms-BeOQU3wx.jpg",PV=60,ib=5,MV=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],LV={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Squeeze Press":"push","Incline Dumbbell Press":"push","Dumbbell Fly":"push","Dumbbell Pullover":"push","Tricep Kickback":"push","Dumbbell Shrug":"push","Dumbbell Y-Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Wide Dumbbell Bent Over Row":"pull","Reverse Fly":"pull","Concentration Curl":"pull","Wide Grip Bicep Curl":"pull","Wrist Curl":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core","Kettlebell Bird Dog Drag":"core"},VV={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},OV={fullbody:"linear-gradient(160deg, rgba(153,49,60,0.15) 0%, rgba(153,49,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",upper:"linear-gradient(160deg, rgba(100,60,140,0.2) 0%, rgba(100,60,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",lower:"linear-gradient(160deg, rgba(40,120,80,0.2) 0%, rgba(40,120,80,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)"},ab={arms:"linear-gradient(160deg, rgba(180,60,60,0.2) 0%, rgba(180,60,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",chest:"linear-gradient(160deg, rgba(50,100,160,0.2) 0%, rgba(50,100,160,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",back:"linear-gradient(160deg, rgba(80,130,60,0.2) 0%, rgba(80,130,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",shoulders:"linear-gradient(160deg, rgba(160,100,40,0.2) 0%, rgba(160,100,40,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",legs:"linear-gradient(160deg, rgba(100,50,140,0.2) 0%, rgba(100,50,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)"},ob=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,level:"All Levels",daysPerWeek:3,image:IV},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,level:"Intermediate",daysPerWeek:3},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,level:"Advanced",daysPerWeek:3},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,level:"Beginner",daysPerWeek:3},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,level:"Intermediate",daysPerWeek:3},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,level:"Advanced",daysPerWeek:3},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,level:"Intermediate",daysPerWeek:3},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,level:"Intermediate",daysPerWeek:3}],Ad=[{key:"arms",label:"Arms",icon:"M7 5h2v14H7V5zm8 0h2v14h-2V5zm-5 4h4v6h-4V9z",image:DV},{key:"chest",label:"Chest",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15H9v-2h2v2zm4 0h-2v-2h2v2zm3-6c0 1.1-.36 2.12-.97 2.95l-.87-.87C16.7 12.53 17 11.8 17 11c0-2.76-2.24-5-5-5S7 8.24 7 11c0 .8.3 1.53.84 2.08l-.87.87A4.977 4.977 0 0 1 6 11c0-3.31 2.69-6 6-6s6 2.69 6 6z"},{key:"back",label:"Back",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm4 18H8v-6l-4-4 1.41-1.41L8 11.17V8h8v3.17l2.59-2.58L20 10l-4 4v6z"},{key:"shoulders",label:"Shoulders",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"legs",label:"Legs",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"}],BT={chest:[{id:"chest_strength",name:"Chest Strength",desc:"Heavy pressing for max strength",level:"Intermediate",overview:"A heavy pressing session designed to build raw chest strength. Focus on controlled negatives and powerful pressing movements.",tips:["Go heavy  pick a weight where the last 2 reps are a real challenge","Control the negative (lowering phase) for 2-3 seconds","Keep your shoulder blades squeezed together throughout all pressing movements","Rest 90-120 seconds between sets to allow full recovery"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Squeeze Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"chest_hypertrophy",name:"Chest Hypertrophy",desc:"Volume training for muscle growth",level:"Intermediate",overview:"A high-volume chest session focused on time under tension and muscle growth. Lighter weights, more reps, and slow controlled movements.",tips:["Use moderate weight  you should feel the burn by rep 10","Squeeze your chest at the top of every rep for 1 second","Keep rest periods short at 60-90 seconds to keep the pump going","On press ups, go to failure on the final set"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Press Up",type:"reps",sets:3,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"}]},{id:"chest_endurance",name:"Chest Endurance",desc:"Bodyweight pushing to failure",level:"All Levels",overview:"No weights needed. This bodyweight-only session builds chest endurance and muscular stamina through high-rep push up variations.",tips:["Focus on full range of motion  chest to floor on every rep","Keep your core tight and body in a straight line throughout","Scale down to knee press ups if you can't maintain form","Push through the burn  the last 5 reps are where the growth happens"],exercises:[{name:"Press Up",type:"reps",sets:4,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null},{name:"Decline Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Press Up Hold",type:"timed",sets:3,time:30,storagePath:null}]}],back:[{id:"back_strength",name:"Back Strength",desc:"Heavy rows for a thick back",level:"Intermediate",overview:"Build a thick, powerful back with heavy rowing movements. This session targets your lats, rhomboids, and traps for overall back development.",tips:["Go heavy on rows  use a weight that challenges you by rep 6-8","Drive your elbows back and squeeze your shoulder blades together at the top","Keep a slight bend in your knees and hinge at the hips for bent over movements","Rest 90-120 seconds between sets for full recovery"],exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"back_hypertrophy",name:"Back Hypertrophy",desc:"Width and thickness volume work",level:"Intermediate",overview:"A volume-focused back session combining rows and isolation moves to build width and thickness. Focus on the mind-muscle connection.",tips:["Use moderate weight  feel the stretch and squeeze on every rep","On renegade rows, keep your hips square to the floor and avoid rotating","For reverse flys, use lighter weight and focus on squeezing your rear delts","Keep rest to 60-90 seconds to maintain intensity"],exercises:[{name:"Renegade Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Reverse Fly",type:"weighted",sets:3,reps:15,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null}]},{id:"back_endurance",name:"Back Endurance",desc:"Bodyweight back conditioning",level:"All Levels",overview:"A bodyweight session to strengthen your posterior chain and improve posture. Great for back health, mobility, and muscular endurance.",tips:["On superman holds, lift your arms and legs simultaneously and hold tight","Focus on slow, controlled movements  quality over speed","Breathe steadily throughout timed holds  don't hold your breath","Engage your glutes and lower back together on every movement"],exercises:[{name:"Superman Hold",type:"timed",sets:4,time:30,storagePath:"exercises/bodyweight/upper/Superman Hold.mp4"},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:12,storagePath:null},{name:"Reverse Snow Angel",type:"reps",sets:3,reps:12,storagePath:null},{name:"Bird Dog",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Back Extension Hold",type:"timed",sets:3,time:30,storagePath:null}]}],shoulders:[{id:"shoulders_strength",name:"Shoulder Strength",desc:"Heavy pressing for boulder shoulders",level:"Intermediate",overview:"A heavy overhead pressing session to build strong, powerful shoulders. Compound movements first, followed by isolation work for all three delt heads.",tips:["Go heavy on presses  pick a weight where you struggle on the last 2 reps","Brace your core and avoid arching your back during overhead movements","Press straight up and control the weight down slowly","Rest 90-120 seconds between pressing sets, 60 seconds for isolation moves"],exercises:[{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"shoulders_hypertrophy",name:"Shoulder Hypertrophy",desc:"Volume and isolation for 3D delts",level:"Intermediate",overview:"A high-volume session targeting all three heads of the deltoid for that 3D capped shoulder look. Moderate weight, high reps, constant tension.",tips:["Use lighter weight than you think  shoulders respond best to high reps","On lateral raises, lead with your elbows and don't swing the weight","Pause at the top of each raise for a 1-second squeeze","Keep rest periods at 60 seconds to maximise the pump"],exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Y-Raise",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"shoulders_endurance",name:"Shoulder Endurance",desc:"Bodyweight and high-rep work",level:"All Levels",overview:"A shoulder endurance session combining bodyweight movements with high-rep dumbbell work. Builds stamina, stability, and shoulder resilience.",tips:["On pike push ups, walk your feet close to your hands to increase the angle","For high-rep lateral raises, use a very light weight and focus on form","Wall walks are advanced  scale to pike push ups if needed","Keep your core braced throughout to protect your lower back"],exercises:[{name:"Pike Push Ups",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/upper/pike push ups.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,reps:20,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Wall Walks",type:"reps",sets:3,reps:6,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null},{name:"Shoulder Tap Hold",type:"timed",sets:3,time:30,storagePath:null}]}],arms:[{id:"arms_bicep",name:"Bicep Focus",desc:"Curl variations for peak biceps",level:"All Levels",overview:"An arm session dedicated entirely to biceps. Multiple curl variations target different parts of the bicep for maximum peak and thickness.",tips:["Keep your elbows pinned to your sides  no swinging","Control the negative (lowering) for 2-3 seconds on every rep","Start with your heaviest weight and decrease as you fatigue","Squeeze hard at the top of each curl for a full contraction"],exercises:[{name:"Bicep Curl",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Concentration Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Isometric Bicep Hold",type:"timed",sets:3,time:20,storagePath:null}]},{id:"arms_tricep",name:"Tricep Focus",desc:"Extensions and dips for horseshoe triceps",level:"All Levels",overview:"All-out tricep training with extensions, dips, and pressing movements. The triceps make up two-thirds of your arm  this session builds serious size.",tips:["On overhead extensions, keep your elbows close to your head","For skullcrushers, lower the weight slowly to just above your forehead","On dips, lean slightly forward to reduce shoulder strain","Full lockout at the top of every extension for maximum tricep contraction"],exercises:[{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Tricep Dips",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null}]},{id:"arms_full",name:"Full Arms",desc:"Superset biceps and triceps",level:"All Levels",overview:"A balanced arm session alternating between biceps and triceps. Superset style keeps the intensity high and maximises the pump.",tips:["Superset each pair  do biceps then immediately hit triceps","Use moderate weight that lets you maintain strict form for all reps","Rest 60 seconds after each superset pair","Focus on the squeeze at the peak contraction of every rep"],exercises:[{name:"Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Wrist Curl",type:"weighted",sets:3,reps:15,storagePath:null}]}],legs:[{id:"legs_quad",name:"Quad Dominant",desc:"Squats and lunges for quad power",level:"All Levels",overview:"A quad-focused leg session built around squats and lunges. Heavy compound movements to build strong, powerful quads and overall leg strength.",tips:["On goblet squats, hold the dumbbell close to your chest and sit deep","Keep your knees tracking over your toes  don't let them cave inward","Drive through your heels on all squatting movements","Rest 90-120 seconds between heavy sets, 60 seconds on bodyweight moves"],exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/lower/bulgarian split squats.mp4"},{name:"Squat And Hold",type:"timed",sets:3,time:30,storagePath:"exercises/bodyweight/lower/squat and hold.mp4"}]},{id:"legs_ham_glute",name:"Hamstring & Glute",desc:"Posterior chain focus",level:"Intermediate",overview:"Target the back of your legs with deadlift and hip hinge variations. This session builds a strong posterior chain  hamstrings, glutes, and lower back.",tips:["On RDLs, push your hips back and feel the stretch in your hamstrings","Keep a slight bend in your knees throughout hip hinge movements","Squeeze your glutes hard at the top of every rep","For single leg work, start with your weaker side first"],exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/romanian deadlifts.mp4"},{name:"1 Legged RDL",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.mp4"},{name:"Hip Thrusts",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/hip thrusts.mp4"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.mp4"},{name:"Donkey Kicks",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.mp4"}]},{id:"legs_power",name:"Power & Plyo",desc:"Explosive leg training",level:"Intermediate",overview:"An explosive leg session combining plyometrics with weighted movements. Build power, speed, and athletic performance.",tips:["On jump squats, land softly with bent knees to absorb the impact","Explode up on every rep  power comes from speed, not just weight","Keep rest periods at 60-90 seconds to maintain intensity","Focus on landing mechanics  knees out, chest up, soft landing"],exercises:[{name:"Jump Squats",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/lower/jump squats.mp4"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Skater Jumps",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/skater jumps.mp4"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.mp4"}]}],core:[{id:"core_lower_abs",name:"Lower Abs Blast",desc:"40s work / 20s rest  3 rounds",level:"Intermediate",overview:"An interval-based core burner targeting the lower abdominals. 40 seconds of work followed by 20 seconds of rest  keep the intensity high and your lower back pressed into the floor throughout.",tips:["Press your lower back firmly into the floor on every rep","Exhale hard as you contract your abs  don't hold your breath","If your lower back lifts off the ground, reduce the range of motion","Focus on slow, controlled movements rather than speed"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Leg Raises",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Reverse Crunch To Leg Raise",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Flutter Kicks",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Dead Bug Single Leg Drop",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Hollow Hold Flutter Kicks",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"}]},{id:"core_obliques",name:"Obliques & Rotation",desc:"35s work / 25s rest  3 rounds",level:"Intermediate",overview:"Target the obliques and rotational core muscles with this interval session. 35 seconds of work with 25 seconds rest  every exercise involves twisting, rotating, or side-bracing movements.",tips:["Rotate from your ribcage, not just your arms","Keep your hips as still as possible during twisting exercises","Brace your core before each movement  think about squeezing a belt","On side planks, stack your hips and push the floor away"],interval:!0,rounds:3,work:35,rest:25,exercises:[{name:"Russian Twist",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank Rotation",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Cross Body Mountain Climbers",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Hip Dips Plank",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Bicycle Crunch",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank",storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{id:"core_weighted",name:"Weighted Core",desc:"40s work / 20s rest  3 rounds",level:"Advanced",overview:"Add resistance to your core training with dumbbells and kettlebells. 40 seconds of weighted work followed by 20 seconds rest  this session builds serious core strength and stability.",tips:["Start with a moderate weight  form is more important than load","Brace your entire core before picking up the weight each round","Keep movements controlled  no swinging or using momentum","If grip fails before core does, go slightly lighter next time"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Russian Twists Dumbbell",storagePath:"exercises/dumbbells/core/russian twists dumbbell.mp4"},{name:"Kettlebell Russian Twist",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Dumbbell Plank Pull Through",storagePath:null}]}]},UT=[{key:"bodyweight",label:"Bodyweight",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"},{key:"dumbbells",label:"Dumbbells",icon:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"},{key:"kettlebells",label:"Kettlebells",icon:"M12 2C9.24 2 7 4.24 7 7c0 1.1.36 2.12.97 2.95C6.76 11.08 6 12.96 6 15c0 3.87 2.69 7 6 7s6-3.13 6-7c0-2.04-.76-3.92-1.97-5.05.61-.83.97-1.85.97-2.95 0-2.76-2.24-5-5-5zm0 2c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"}],lb=[{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"},{key:"upper",label:"Upper",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"lower",label:"Lower",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"fullbody",label:"Full Body",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z"},{key:"mix",label:"Mix It Up",icon:"M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm-.83 9.41l-1.42 1.42L17.96 20.54l1.42-1.42-5.71-5.71z"}],Bc=[{key:"beginner",label:"Beginner",work:30,rest:30,desc:"30s work / 30s rest"},{key:"intermediate",label:"Intermediate",work:40,rest:20,desc:"40s work / 20s rest"},{key:"advanced",label:"Advanced",work:40,rest:15,desc:"40s work / 15s rest"}],cb=[5,10,15,20,30];function BV(n){return n.replace(/\b\w/g,e=>e.toUpperCase())}function UV(n){const e=[...n];for(let t=e.length-1;t>0;t--){const s=Math.floor(Math.random()*(t+1));[e[t],e[s]]=[e[s],e[t]]}return e}function FV(){const{currentUser:n,isClient:e,clientData:t,loading:s}=Wr(),{isDark:o,toggleTheme:c,accent:u}=Ui(),{isPremium:h,FREE_RANDOMISER_DURATIONS:m,FREE_RANDOMISER_WEEKLY_LIMIT:g}=Dp(),b=lr(),[x,T]=_.useState("menu"),[N,B]=_.useState(["bodyweight"]),[P,M]=_.useState("core"),[Y,H]=_.useState("intermediate"),[X,fe]=_.useState(h?15:5),[je,Te]=_.useState([]),[C,S]=_.useState(!1),D=_.useRef(!1),U=_.useRef([]),[V,q]=_.useState([]),[L,Ke]=_.useState(2),[_t,$]=_.useState(Bc[1]),[ge,Le]=_.useState(1),[Qe,ne]=_.useState(0),[O,ie]=_.useState("work"),[Ie,Oe]=_.useState(0),[it,ze]=_.useState(!1),[vt,Nt]=_.useState(0),[at,Xt]=_.useState(null),An=_.useRef(null);_.useRef(null),_.useRef(null);const[Pt,Ce]=_.useState(null),ee=_.useCallback((Q,we="info")=>{Ce({message:Q,type:we}),setTimeout(()=>Ce(null),3e3)},[]),[yt,bt]=_.useState(null),[et,ft]=_.useState(null),[rt,tt]=_.useState(0),[Ft,ts]=_.useState(0),[Dt,un]=_.useState([]),[fs,Yt]=_.useState(""),[Mn,dn]=_.useState(""),[Rn,he]=_.useState(!1),[De,Be]=_.useState(0),[nt,Fe]=_.useState(!1),[Me,qe]=_.useState({}),St=_.useRef(null),wt=_.useRef(null),[Mt,Jt]=_.useState([]),[Z,xe]=_.useState(null),[ct,Lt]=_.useState(0),[Ct,an]=_.useState(0),[Zt,Wt]=_.useState(0),[Ln,as]=_.useState(0),[bn,In]=_.useState(0),[Bn,z]=_.useState(0),[_e,ke]=_.useState({beginner:0,intermediate:0,advanced:0}),Ee=h?cb:cb.filter(Q=>m.includes(Q)),be=!h&&ct>=g,[lt,It]=_.useState(null),[ut,Tt]=_.useState(""),[At,mn]=_.useState(!1);_.useEffect(()=>{!s&&(!n||!e)&&b("/")},[n,e,s,b]),_.useEffect(()=>{if(!n||!t)return;(async()=>{try{const we=Kt(ve,"workoutLogs"),se=Dn(we,hn("clientId","==",t.id)),We=(await Sn(se)).docs.map(cn=>cn.data()),ht=We.filter(cn=>cn.type!=="programme");as(ht.length);const kt=ht.reduce((cn,ws)=>cn+(ws.duration||0),0);In(kt);const Bt={beginner:0,intermediate:0,advanced:0};ht.forEach(cn=>{cn.level&&Bt[cn.level]!==void 0&&Bt[cn.level]++}),ke(Bt);const kn=new Date,_s=kn.getDay(),vn=_s===0?-6:1-_s,cr=new Date(kn);cr.setDate(kn.getDate()+vn),cr.setHours(0,0,0,0);const ci=cr.getTime(),Es=We.filter(cn=>{const ws=cn.completedAt;return ws?(ws.toDate?ws.toDate().getTime():new Date(ws).getTime())>=ci:!1});Lt(Es.filter(cn=>cn.type!=="programme").length);let Fi=0;if(t)try{const cn=await Pn(Ge(ve,"clientProgrammes",t.id));if(cn.exists()){const ws=cn.data(),yr=ws.templateId;Fi=Es.filter(ls=>ls.type==="programme"&&ls.programmeId===yr).length,It(yr);const ur=ob.find(ls=>ls.id===yr);ur&&Tt(ur.name);const Pr=VV[yr];if(Pr){const ls=Object.keys(ws.completedSessions||{}).length,Ks=Pr.duration*Pr.daysPerWeek;Wt(Ks>0?Math.round(ls/Ks*100):0)}}else It(null),Tt(""),Wt(0)}catch{}an(Fi);const tr=ht.map(cn=>cn.completedAt).filter(Boolean).map(cn=>cn.toDate?cn.toDate().getTime():new Date(cn).getTime()).sort((cn,ws)=>ws-cn);if(tr.length===0)z(0);else{const cn=new Set;tr.forEach(Ks=>{const Us=new Date(Ks),Mr=Us.getDay(),Lr=Mr===0?-6:1-Mr,Gr=new Date(Us);Gr.setDate(Us.getDate()+Lr),Gr.setHours(0,0,0,0),cn.add(Gr.getTime())});const ws=[...cn].sort((Ks,Us)=>Us-Ks);let yr=0;const ur=new Date(kn),Pr=kn.getDay()===0?-6:1-kn.getDay();ur.setDate(kn.getDate()+Pr),ur.setHours(0,0,0,0);let ls=ur.getTime();ws.includes(ls)||(ls-=10080*60*1e3);for(let Ks=0;Ks<200&&ws.includes(ls);Ks++)yr++,ls-=10080*60*1e3;z(yr)}}catch(we){console.error("Error loading workout stats:",we)}finally{mn(!0)}})()},[n,t,x]);const er=()=>{const Q=[];let we;P==="mix"?we=["core","upper","lower"]:P==="fullbody"?we=["upper","lower"]:we=[P];for(const se of N)for(const Ue of we)Q.push(`exercises/${se}/${Ue}`);return Q},ks=async()=>{if(D.current){for(;D.current;)await new Promise(Q=>setTimeout(Q,200));return U.current}D.current=!0,S(!0);try{const Q=er(),we=[];for(const ht of Q)try{const kt=Do(Po,ht),Bt=await LT(kt);we.push(...Bt.items)}catch{console.warn(`Folder ${ht} not found, skipping.`)}if(we.length===0&&N.includes("bodyweight")&&P==="core")try{const ht=Do(Po,"core"),kt=await LT(ht);we.push(...kt.items)}catch{console.warn("Legacy core/ folder not found either.")}if(we.length===0){const ht=N.map(Bt=>UT.find(kn=>kn.key===Bt)?.label).join(" + "),kt=lb.find(Bt=>Bt.key===P)?.label;return ee(`No exercises found for ${ht} / ${kt}. Upload videos to Firebase Storage.`,"error"),D.current=!1,S(!1),[]}const se=new Set,Ue=we.filter(ht=>{const kt=ht.name.replace(/\.(mp4|gif)$/i,"");return se.has(kt)?!1:(se.add(kt),!0)}),We=await Promise.all(Ue.map(async ht=>{const kt=await Dl(ht),Bt=BV(ht.name.replace(/\.(mp4|gif)$/i,"")),kn=/\.gif$/i.test(ht.name);return{name:Bt,videoUrl:kt,isGif:kn}}));return U.current=We,Te(We),D.current=!1,S(!1),We}catch(Q){console.error("Error loading exercises:",Q);const we=Q.code==="storage/unauthorized"?"Storage access denied. Check Firebase Storage rules allow read access.":`Failed to load exercises: ${Q.message||Q.code||"Unknown error"}`;return ee(we,"error"),D.current=!1,S(!1),[]}},Ds=async()=>{if(be)return;T("spinning"),U.current=[];const Q=await ks();if(Q.length===0){T("setup");return}const we=Bc.find(_s=>_s.key===Y);$(we);const se=we.work+we.rest,Ue=X*60,We=Math.floor(Ue/se);let ht,kt;We<=6?(ht=Math.max(3,Math.floor(We/2)),kt=Math.floor(We/ht)):We<=12?(ht=Math.min(6,Math.floor(We/2)),kt=Math.floor(We/ht)):(ht=Math.min(10,Math.floor(We/2)),kt=Math.floor(We/ht)),kt=Math.max(2,kt);const Bt=UV(Q),kn=Bt.slice(0,Math.min(ht,Bt.length));q(kn),Ke(kt),setTimeout(()=>T("preview"),2e3)},ns=()=>{T("countdown"),Nt(3)};_.useEffect(()=>{if(x!=="countdown")return;if(vt<=0){T("workout"),Le(1),ne(0),ie("work"),Oe(_t.work),ze(!1),Gs();return}Yn();const Q=setTimeout(()=>Nt(we=>we-1),1e3);return()=>clearTimeout(Q)},[vt,x]),_.useEffect(()=>{if(x!=="workout"||it)return;if(Ie<=0){W();return}Ie<=3&&Yn();const Q=setTimeout(()=>Oe(we=>we-1),1e3);return()=>clearTimeout(Q)},[Ie,x,it]);const W=()=>{if(O==="work")ie("rest"),Oe(_t.rest);else{const Q=Qe+1;if(Q>=V.length){const we=ge+1;if(we>L){T("complete"),me();return}Le(we),ne(0)}else ne(Q);ie("work"),Oe(_t.work),Gs()}},me=async()=>{if(n)try{await Ia(Kt(ve,"workoutLogs"),{clientId:t.id,level:Y,duration:X,equipment:N,focus:P,exerciseCount:V.length,rounds:L,exercises:V.map(Q=>Q.name),completedAt:pt.now()}),Lt(Q=>Q+1),as(Q=>Q+1),In(Q=>Q+X),ke(Q=>({...Q,[Y]:(Q[Y]||0)+1}))}catch(Q){console.error("Error saving workout log:",Q)}},E=async(Q,we,se)=>{if(!(!t||!we))try{const Ue=t.id,We=await Pn(Ge(ve,"coreBuddyPBs",Ue)),kt=(We.exists()?We.data():null)?.exercises||{},Bt=kt[Q];let kn=!1;if(Bt?(we>(Bt.weight||0)||we===(Bt.weight||0)&&se>(Bt.reps||0))&&(kn=!0):kn=!0,kn){const _s={...kt,[Q]:{weight:we,reps:se,achievedAt:pt.now()}};await zn(Ge(ve,"coreBuddyPBs",Ue),{clientId:t.id,exercises:_s,updatedAt:pt.now()}),ee(`New PB! ${we}kg  ${se} reps`,"success"),Yn(),await A(Q,we)}}catch(Ue){console.error("Error checking PB:",Ue)}},A=async(Q,we)=>{if(t)try{const se=await Pn(Ge(ve,"coreBuddyTargets",t.id));if(!se.exists())return;const We=(se.data().targets||{})[Q];if(!We||we<We.targetWeight)return;const ht=await Pn(Ge(ve,"coreBuddyAchievements",t.id)),kt=ht.exists()?ht.data():{clientId:t.id,badges:[],totalVolume:0};if(kt.badges.some(vn=>vn.type==="pb_target"&&vn.exercise===Q&&vn.targetWeight===We.targetWeight))return;const kn={type:"pb_target",exercise:Q,group:LV[Q]||"push",targetWeight:We.targetWeight,achievedAt:pt.now()},_s=[...kt.badges,kn];await zn(Ge(ve,"coreBuddyAchievements",t.id),{...kt,badges:_s,updatedAt:pt.now()}),Jt(vn=>[...vn,kn])}catch(se){console.error("Error checking target badge:",se)}},K=async Q=>{if(!(!t||Q<=0))try{const we=await Pn(Ge(ve,"coreBuddyAchievements",t.id)),se=we.exists()?we.data():{clientId:t.id,badges:[],totalVolume:0},Ue=se.totalVolume||0,We=Ue+Q,ht=[];MV.forEach(Bt=>{We>=Bt.threshold&&Ue<Bt.threshold&&(se.badges.some(_s=>_s.type==="volume_milestone"&&_s.milestone===Bt.threshold)||ht.push({type:"volume_milestone",milestone:Bt.threshold,label:Bt.label,achievedAt:pt.now()}))});const kt=[...se.badges,...ht];await zn(Ge(ve,"coreBuddyAchievements",t.id),{clientId:t.id,badges:kt,totalVolume:Math.round(We),updatedAt:pt.now()}),ht.length>0&&Jt(Bt=>[...Bt,...ht])}catch(we){console.error("Error updating volume:",we)}},oe=async Q=>{if(ft(Q),Q.interval){const Ue=[];for(const We of Q.exercises){let ht=null,kt=!1;if(We.storagePath)try{const Bt=Do(Po,We.storagePath);ht=await Dl(Bt),kt=/\.gif$/i.test(We.storagePath)}catch{}Ue.push({name:We.name,videoUrl:ht,isGif:kt})}q(Ue),Ke(Q.rounds),$({work:Q.work,rest:Q.rest}),T("preview");return}const we={};for(const Ue of Q.exercises)if(Ue.storagePath)try{const We=Do(Po,Ue.storagePath);we[Ue.name]={url:await Dl(We),isGif:/\.gif$/i.test(Ue.storagePath)}}catch{}qe(we);const se=Q.exercises.map(Ue=>({name:Ue.name,type:Ue.type,targetSets:Ue.sets,targetReps:Ue.reps||0,targetTime:Ue.time||0,sets:[]}));un(se),tt(0),ts(0),Yt(""),dn(""),Fe(!1),he(!1),Be(0),Jt([]),xe(null),T("muscle_workout")},Ye=()=>{const Q=St.current;Q&&(Q.paused?(Q.play(),Fe(!0)):(Q.pause(),Fe(!1)))};_.useEffect(()=>{if(x!=="muscle_workout"||!Rn||De<=0){x==="muscle_workout"&&Rn&&De<=0&&(he(!1),Yn());return}return wt.current=setTimeout(()=>Be(Q=>Q-1),1e3),()=>clearTimeout(wt.current)},[x,Rn,De]);const $e=async()=>{const Q=Dt[rt];let we={};if(Q.type==="weighted"){const We=parseFloat(fs)||0,ht=parseInt(Mn)||0;if(ht===0){ee("Enter your reps","error");return}we={weight:We,reps:ht}}else if(Q.type==="reps"){const We=parseInt(Mn)||0;if(We===0){ee("Enter your reps","error");return}we={reps:We}}else if(Q.type==="timed"){const We=Q.targetTime-De;we={time:Math.max(We,1)}}const se=[...Dt];se[rt]={...Q,sets:[...Q.sets,we]},un(se),Q.type==="weighted"&&we.weight>0&&await E(Q.name,we.weight,we.reps);const Ue=Q.sets.length+1;if(Ue<Q.targetSets)ts(Ue),dn(""),he(!1),Be(0);else if(rt+1<Dt.length){const We=rt+1;tt(We),ts(0),Yt(""),dn(""),Fe(!1),he(!1),Be(0)}else await He(se),T("muscle_complete")},He=async Q=>{if(!(!n||!t))try{const we=Q.reduce((Ue,We)=>Ue+We.sets.reduce((ht,kt)=>ht+(kt.weight||0)*(kt.reps||0),0),0),se=Q.reduce((Ue,We)=>Ue+We.sets.length,0);await Ia(Kt(ve,"workoutLogs"),{clientId:t.id,type:"muscle_group",muscleGroup:yt,sessionId:et?.id,sessionName:et?.name,exerciseCount:Q.length,totalSets:se,duration:Math.round(se*1.5),volume:Math.round(we),exercises:Q.map(Ue=>({name:Ue.name,type:Ue.type,sets:Ue.sets})),completedAt:pt.now()}),we>0&&await K(we),Mt.length>0&&xe({badges:[...Mt]})}catch(we){console.error("Error saving muscle group workout log:",we)}},Qt=_.useRef(null),Ot=()=>(Qt.current||(Qt.current=new(window.AudioContext||window.webkitAudioContext)),Qt.current),Yn=()=>{try{const Q=Ot(),we=Q.createOscillator(),se=Q.createGain();we.connect(se),se.connect(Q.destination),we.frequency.value=880,se.gain.value=.3,we.start(Q.currentTime),we.stop(Q.currentTime+.15)}catch{}},Gs=()=>{try{const Q=Ot(),we=Q.createOscillator(),se=Q.createGain();we.connect(se),se.connect(Q.destination),we.frequency.value=1200,se.gain.value=.4,we.start(Q.currentTime),we.stop(Q.currentTime+.3)}catch{}};_.useEffect(()=>{if(x!=="workout"||O!=="work"||!V[Qe]?.isGif)return;const we=setInterval(()=>{const se=An.current;if(!se)return;const Ue=se.getAttribute("src");se.removeAttribute("src"),setTimeout(()=>{An.current&&An.current.setAttribute("src",Ue)},0)},4e3);return()=>clearInterval(we)},[x,O,Qe,ge,V]);const Bs=(Q,we,se)=>{const Ue=Math.round(Q/we*PV);return a.jsx("svg",{className:"wk-ring-svg",viewBox:"0 0 200 200",children:iV.map((We,ht)=>a.jsx("line",{x1:We.x1,y1:We.y1,x2:We.x2,y2:We.y2,className:ht<Ue?`wk-tick-filled ${se}`:"wk-tick-empty",strokeWidth:We.thick?"3":"2"},ht))})},Hn=()=>{const Q=V.length*L;return((ge-1)*V.length+Qe+(O==="rest"?.5:0))/Q},$n=Pt&&a.jsx("div",{className:`toast-notification ${Pt.type}`,children:Pt.message});if(s)return a.jsxs("div",{className:"wk-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>b("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsx("div",{className:"wk-loading-inline",children:a.jsx("div",{className:"wk-loading-spinner"})})]});if(x==="menu")return a.jsx(Mu,{children:a.jsxs("div",{className:"wk-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>b("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:o?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"wk-menu-heading",children:[a.jsx("h2",{children:"Choose Your Workout"}),a.jsx("p",{children:"No excuses. Just results."})]}),a.jsx("button",{className:"wk-hero-card",onClick:()=>T("setup"),children:a.jsx("img",{src:OT,alt:"Randomise Workout",className:"wk-hero-bg"})}),a.jsxs("div",{className:"wk-section-header",children:[a.jsxs("h2",{children:["Programmes ",!h&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),a.jsxs("span",{className:"wk-section-count",children:[ob.length," available"]})]}),h?a.jsx("div",{className:"wk-prog-scroll-wrap",children:a.jsx("div",{className:"wk-prog-scroll",children:ob.map((Q,we)=>Q.image?a.jsxs("button",{className:"wk-prog-img-card",onClick:()=>b("/client/core-buddy/programmes",{state:{templateId:Q.id}}),style:{animationDelay:`${we*.06}s`},children:[a.jsx("img",{src:Q.image,alt:Q.name,className:"wk-prog-img"}),we===0&&a.jsx("div",{className:"wk-swipe-arrow",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},Q.id):a.jsxs("button",{className:"wk-prog-hero-card",onClick:()=>b("/client/core-buddy/programmes",{state:{templateId:Q.id}}),style:{animationDelay:`${we*.06}s`},children:[a.jsx("img",{src:RV,alt:"Programme",className:"wk-prog-hero-bg",loading:"lazy"}),a.jsx("div",{className:"wk-prog-hero-overlay",style:{background:OV[Q.focus]}}),a.jsxs("div",{className:"wk-prog-hero-content",children:[a.jsxs("div",{className:"wk-prog-hero-top",children:[a.jsxs("span",{className:"wk-prog-hero-badge",children:[Q.duration," WEEKS"]}),a.jsx("span",{className:"wk-prog-hero-level",children:Q.level})]}),a.jsxs("div",{className:"wk-prog-hero-bottom",children:[a.jsx("h3",{children:Q.name.toUpperCase()}),a.jsxs("p",{children:[Q.daysPerWeek,"x per week  ",Q.focus==="fullbody"?"Full Body":Q.focus.charAt(0).toUpperCase()+Q.focus.slice(1)," Focus"]}),a.jsx("span",{className:"wk-prog-hero-go",children:"VIEW PROGRAMME "})]})]}),we===0&&a.jsx("div",{className:"wk-swipe-arrow",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},Q.id))})}):a.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>b("/upgrade"),children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{children:"Upgrade to unlock programmes"})]}),a.jsxs("div",{className:"wk-section-header",children:[a.jsxs("h2",{children:["Muscle Groups ",!h&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),a.jsxs("span",{className:"wk-section-count",children:[Ad.length," groups"]})]}),h?a.jsx("div",{className:"wk-muscle-grid",children:Ad.map((Q,we)=>a.jsx("button",{className:`wk-muscle-hero-card${Q.image?" wk-muscle-thumb":""}`,onClick:()=>{bt(Q.key),T("muscle_sessions")},style:{animationDelay:`${we*.05}s`},children:Q.image?a.jsx("img",{src:Q.image,alt:Q.label,className:"wk-muscle-thumb-img"}):a.jsxs(a.Fragment,{children:[a.jsx("img",{src:OT,alt:"Muscle group",className:"wk-muscle-hero-bg",loading:"lazy"}),a.jsx("div",{className:"wk-muscle-hero-overlay",style:{background:ab[Q.key]}}),a.jsxs("div",{className:"wk-muscle-hero-content",children:[a.jsx("div",{className:"wk-muscle-hero-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:Q.icon})})}),a.jsxs("div",{className:"wk-muscle-hero-text",children:[a.jsx("span",{className:"wk-muscle-hero-name",children:Q.label}),a.jsxs("span",{className:"wk-muscle-hero-count",children:[BT[Q.key]?.length||0," sessions"]})]})]})]})},Q.key))}):a.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>b("/upgrade"),children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{children:"Upgrade to unlock muscle group workouts"})]})]}),a.jsx(Ti,{active:"workouts"}),$n]})});if(x==="setup"){const Q=lb.find(se=>se.key===P)?.label||P,we=Bc.find(se=>se.key===Y)?.label||Y;return a.jsxs("div",{className:"wk-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>T("menu"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:o?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main wk-setup-main",children:[a.jsx("div",{className:"wk-stats-row",children:[{label:"Total",value:`${Ln}`,pct:Ln>0?Math.min(Math.round(Ln/100*100),100):0,color:"#14b8a6",size:"normal"},{label:"This Week",value:`${ct}/${ib}`,pct:Math.round(Math.min(ct,ib)/ib*100),color:"var(--color-primary)",size:"large"},{label:"Wk Streak",value:`${Bn}`,pct:Bn>0?Math.min(Math.round(Bn/12*100),100):0,color:"#38B6FF",size:"normal"}].map(se=>{const We=2*Math.PI*38,ht=We-se.pct/100*We;return a.jsxs("div",{className:`wk-stat-item${se.size==="large"?" wk-stat-large":""}`,children:[a.jsxs("div",{className:"wk-stat-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"wk-stat-track",cx:"50",cy:"50",r:38}),a.jsx("circle",{className:"wk-stat-fill",cx:"50",cy:"50",r:38,style:{stroke:se.color},strokeDasharray:We,strokeDashoffset:ht})]}),a.jsx("span",{className:"wk-stat-value",style:{color:se.color},children:se.value})]}),a.jsx("span",{className:"wk-stat-label",children:se.label})]},se.label)})}),a.jsxs("div",{className:"wk-setup-flow",children:[a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Focus Area"}),a.jsx("div",{className:"wk-focus-grid",children:lb.map(se=>a.jsxs("button",{className:`wk-equip-btn${P===se.key?" active":""}${se.key==="mix"?" wk-mix-btn":""}`,onClick:()=>M(se.key),children:[a.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:se.icon})}),a.jsx("span",{children:se.label})]},se.key))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Level"}),a.jsx("div",{className:"wk-level-cards",children:Bc.map(se=>a.jsxs("button",{className:`wk-level-card wk-level-${se.key}${Y===se.key?" active":""}`,onClick:()=>H(se.key),children:[a.jsx("span",{className:"wk-level-name",children:se.label}),a.jsx("span",{className:"wk-level-desc",children:se.desc})]},se.key))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Time"}),a.jsx("div",{className:"wk-time-options",children:cb.map(se=>{const Ue=!Ee.includes(se);return a.jsxs("button",{className:`wk-time-btn${X===se?" active":""}${Ue?" locked":""}`,onClick:()=>!Ue&&fe(se),disabled:Ue,children:[a.jsx("span",{className:"wk-time-num",children:se}),a.jsx("span",{className:"wk-time-unit",children:Ue?a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}):"min"})]},se)})})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Equipment"}),a.jsx("div",{className:"wk-equip-options",children:UT.map(se=>{const Ue=N.includes(se.key);return a.jsxs("button",{className:`wk-equip-btn${Ue?" active":""}`,onClick:()=>{B(We=>Ue&&We.length===1?We:Ue?We.filter(ht=>ht!==se.key):[...We,se.key])},children:[a.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:se.icon})}),a.jsx("span",{children:se.label})]},se.key)})})]}),a.jsx("div",{className:"wk-setup-summary",children:a.jsxs("span",{children:[Q,"  ",we,"  ",X," min"]})})]})]}),a.jsxs("div",{className:"wk-go-sticky",children:[be&&a.jsx("p",{className:"wk-free-limit-msg",children:"You've used your free workout this week. Upgrade for unlimited access."}),a.jsx("button",{className:"wk-randomise-btn",onClick:Ds,disabled:C||be,children:C?"Loading exercises...":be?"Limit Reached":"Randomise Workout"})]}),$n]})}if(x==="spinning")return a.jsxs("div",{className:"wk-page wk-page-center","data-theme":o?"dark":"light","data-accent":u,children:[a.jsxs("div",{className:"wk-spin-container",children:[a.jsxs("div",{className:"wk-spin-ring",children:[a.jsx("svg",{className:"wk-spin-svg",viewBox:"0 0 200 200",children:Kd.map((Q,we)=>a.jsx("line",{x1:Q.x1,y1:Q.y1,x2:Q.x2,y2:Q.y2,className:"wk-spin-tick",strokeWidth:Q.thick?"3.5":"2",style:{animationDelay:`${we*.03}s`}},we))}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-spin-logo",width:"50",height:"50"})]}),a.jsx("p",{className:"wk-spin-text",children:"Generating workout..."})]}),$n]});if(x==="preview"){const Q=et?.interval?{work:et.work,rest:et.rest}:Bc.find(se=>se.key===Y),we=V.length*L*(Q.work+Q.rest);return a.jsxs("div",{className:"wk-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>T(et?.interval?"muscle_sessions":"setup"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:o?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[et?.interval&&a.jsx("h2",{className:"mg-preview-title",children:et.name}),a.jsxs("div",{className:"wk-preview-stats",children:[a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:V.length}),a.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:L}),a.jsx("span",{className:"wk-stat-label",children:"Rounds"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Math.ceil(we/60)}),a.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsxs("span",{className:"wk-stat-val",children:[Q.work,"/",Q.rest]}),a.jsx("span",{className:"wk-stat-label",children:"Work/Rest"})]})]}),a.jsx("div",{className:"wk-preview-list",children:V.map((se,Ue)=>a.jsxs("div",{className:"wk-preview-item",style:{animationDelay:`${Ue*.06}s`},onClick:()=>Xt(se),children:[a.jsx("span",{className:"wk-preview-num",children:Ue+1}),a.jsx("div",{className:"wk-preview-thumb",children:se.isGif?a.jsx("img",{src:se.videoUrl,alt:se.name,loading:"lazy"}):a.jsx("video",{src:`${se.videoUrl}#t=0.1`,muted:!0,playsInline:!0,preload:"auto"})}),a.jsx("span",{className:"wk-preview-name",children:se.name}),a.jsx("svg",{className:"wk-preview-play",width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]},Ue))}),at&&a.jsx("div",{className:"wk-preview-modal-backdrop",onClick:()=>Xt(null),children:a.jsxs("div",{className:"wk-preview-modal",onClick:se=>se.stopPropagation(),children:[a.jsx("button",{className:"wk-preview-modal-close",onClick:()=>Xt(null),"aria-label":"Close preview",children:a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),a.jsx("div",{className:"wk-preview-modal-video",children:at.isGif?a.jsx("img",{src:at.videoUrl,alt:at.name}):a.jsx("video",{src:at.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0})}),a.jsx("h3",{className:"wk-preview-modal-title",children:at.name})]})}),a.jsxs("div",{className:"wk-preview-actions",children:[!et?.interval&&a.jsxs("button",{className:"wk-btn-secondary",onClick:()=>Ds(),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"1 4 1 10 7 10"}),a.jsx("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})]}),"Reshuffle"]}),a.jsx("button",{className:"wk-btn-primary",onClick:ns,children:"Start Workout"})]})]})]})}if(x==="countdown")return a.jsx("div",{className:"wk-page wk-page-center wk-page-dark","data-theme":o?"dark":"light","data-accent":u,children:a.jsxs("div",{className:"wk-countdown-big",children:[a.jsx("span",{className:"wk-countdown-num",children:vt}),a.jsx("span",{className:"wk-countdown-label",children:"GET READY"})]})});if(x==="workout"){const Q=V[Qe],we=O==="work"?_t.work:_t.rest,se=O==="rest"?Qe+1<V.length?V[Qe+1]:ge<L?V[0]:null:null;return a.jsxs("div",{className:"wk-page wk-page-workout","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("div",{className:"wk-video-container",children:O==="work"?Q.isGif?a.jsx("img",{ref:An,className:"wk-video",src:Q.videoUrl,alt:Q.name},Q.videoUrl):a.jsx("video",{className:"wk-video",src:Q.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0},Q.videoUrl):a.jsxs("div",{className:"wk-rest-screen",children:[a.jsx("span",{className:"wk-rest-label",children:"REST"}),se&&a.jsxs("span",{className:"wk-next-label",children:["Next: ",se.name]})]})}),a.jsx("div",{className:"wk-back-row",children:a.jsxs("button",{className:"wk-back-btn",onClick:()=>{confirm("Leave workout?")&&T("menu")},children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]})}),a.jsx("div",{className:"wk-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"wk-exercise-info",children:[a.jsxs("span",{className:"wk-exercise-counter",children:[Qe+1," / ",V.length]}),a.jsx("h2",{className:"wk-exercise-name",children:Q.name}),a.jsxs("span",{className:"wk-round-label",children:["Round ",ge," of ",L]})]}),a.jsx("div",{className:"wk-timer-section",children:a.jsxs("div",{className:"wk-timer-ring-wrap",children:[Bs(Ie,we,O==="work"?"wk-tick-work":"wk-tick-rest"),a.jsxs("div",{className:"wk-timer-center",children:[a.jsx("span",{className:"wk-timer-time",children:Ie}),a.jsx("span",{className:`wk-timer-phase ${O}`,children:O==="work"?"WORK":"REST"})]})]})}),a.jsxs("div",{className:"wk-controls",children:[a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-stop",onClick:()=>{confirm("End workout early?")&&T("menu")},children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})})}),a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-pause",onClick:()=>ze(!it),children:it?a.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}):a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),a.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]})}),a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-skip",onClick:()=>{Oe(0)},children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("polygon",{points:"5 4 15 12 5 20 5 4"}),a.jsx("rect",{x:"15",y:"4",width:"4",height:"16"})]})})]}),a.jsx("div",{className:"wk-progress-bar",children:a.jsx("div",{className:"wk-progress-fill",style:{width:`${Hn()*100}%`}})})]})}if(x==="complete"){const Q=Bc.find(se=>se.key===Y),we=V.length*L*(Q.work+Q.rest);return a.jsx("div",{className:"wk-page wk-page-center","data-theme":o?"dark":"light","data-accent":u,children:a.jsxs("div",{className:"wk-complete",children:[a.jsxs("div",{className:"wk-complete-ring",children:[a.jsx("svg",{className:"wk-complete-svg",viewBox:"0 0 200 200",children:Kd.map((se,Ue)=>a.jsx("line",{x1:se.x1,y1:se.y1,x2:se.x2,y2:se.y2,className:"wk-tick-complete",strokeWidth:se.thick?"3.5":"2",style:{animationDelay:`${Ue*.02}s`}},Ue))}),a.jsx("div",{className:"wk-complete-center",children:a.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})})})]}),a.jsx("h2",{className:"wk-complete-title",children:"Workout Complete!"}),a.jsxs("div",{className:"wk-complete-stats",children:[a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Math.ceil(we/60)}),a.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:V.length*L}),a.jsx("span",{className:"wk-stat-label",children:"Intervals"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:L}),a.jsx("span",{className:"wk-stat-label",children:"Rounds"})]})]}),a.jsx("div",{className:"wk-complete-actions",children:a.jsx("button",{className:"wk-btn-primary",onClick:()=>{ft(null),bt(null),T("menu")},children:"Done"})})]})})}if(x==="muscle_sessions"){const Q=Ad.find(se=>se.key===yt),we=BT[yt]||[];return a.jsxs("div",{className:"wk-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>T("menu"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:o?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"mg-sessions-header",children:[a.jsx("div",{className:"mg-sessions-icon",style:{background:ab[yt]},children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:Q?.icon})})}),a.jsxs("h2",{children:[Q?.label," Workouts"]}),a.jsxs("p",{children:[we.length," sessions available"]})]}),a.jsx("div",{className:"mg-sessions-list",children:we.map((se,Ue)=>a.jsxs("button",{className:"mg-session-card",onClick:()=>{ft(se),T("muscle_overview")},style:{animationDelay:`${Ue*.08}s`},children:[a.jsxs("div",{className:"mg-session-info",children:[a.jsx("h3",{children:se.name}),a.jsx("p",{children:se.desc}),a.jsx("div",{className:"mg-session-meta",children:se.interval?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mg-session-tag mg-tag-interval",children:"Interval"}),a.jsxs("span",{className:"mg-session-tag",children:[se.exercises.length," exercises"]}),a.jsxs("span",{className:"mg-session-tag",children:[se.rounds," rounds"]})]}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mg-session-tag mg-tag-strength",children:"Strength"}),a.jsxs("span",{className:"mg-session-tag",children:[se.exercises.length," exercises"]}),a.jsx("span",{className:"mg-session-tag",children:(()=>{const We=se.exercises.map(Bt=>Bt.sets||0),ht=Math.min(...We),kt=Math.max(...We);return ht===kt?`${ht} sets each`:`${ht}-${kt} sets each`})()})]})})]}),a.jsx("div",{className:"mg-session-arrow",children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},se.id))})]}),$n]})}if(x==="muscle_overview"){const Q=et;if(!Q)return null;const we=Ad.find(se=>se.key===yt);return a.jsxs("div",{className:"wk-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>T("muscle_sessions"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:o?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main mg-overview-main",children:[a.jsx("div",{className:"mg-overview-hero",style:{background:ab[yt]},children:a.jsx("div",{className:"mg-overview-hero-content",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"mg-overview-hero-icon",children:a.jsx("path",{d:we?.icon})})})}),a.jsxs("div",{className:"mg-overview-header",children:[a.jsxs("div",{className:"mg-overview-title-row",children:[a.jsx("h2",{children:Q.name}),Q.level&&a.jsx("span",{className:"mg-overview-level",children:Q.level})]}),a.jsx("p",{className:"mg-overview-desc",children:Q.desc})]}),Q.overview&&a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 16v-4M12 8h.01"})]}),"About This Workout"]}),a.jsx("p",{children:Q.overview})]}),Q.tips&&Q.tips.length>0&&a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Tips & Form"]}),a.jsx("ul",{className:"mg-overview-tips",children:Q.tips.map((se,Ue)=>a.jsx("li",{children:se},Ue))})]}),a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"}),a.jsx("rect",{x:"9",y:"3",width:"6",height:"4",rx:"1"}),a.jsx("path",{d:"M9 14l2 2 4-4"})]}),"Exercises (",Q.exercises.length,")"]}),a.jsx("div",{className:"mg-overview-exercises",children:Q.exercises.map((se,Ue)=>a.jsxs("div",{className:"mg-overview-exercise",children:[a.jsx("span",{className:"mg-overview-ex-num",children:Ue+1}),a.jsxs("div",{className:"mg-overview-ex-info",children:[a.jsx("span",{className:"mg-overview-ex-name",children:se.name}),Q.interval?a.jsxs("span",{className:"mg-overview-ex-detail",children:[Q.work,"s work / ",Q.rest,"s rest"]}):a.jsxs("span",{className:"mg-overview-ex-detail",children:[se.sets," sets  ",se.reps?`${se.reps} reps`:`${se.time}s`,se.type==="weighted"&&"  weighted"]})]})]},Ue))})]}),a.jsxs("button",{className:"mg-overview-start-btn",onClick:()=>oe(Q),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Workout"]})]}),$n]})}if(x==="muscle_workout"){const Q=et;if(!Q)return null;const we=Q.exercises[rt],se=Dt[rt];if(!we||!se)return null;const Ue=se.sets.length,We=Q.exercises.length,ht=Q.exercises.reduce((vn,cr)=>vn+(cr.sets||0),0),Bt=Dt.reduce((vn,cr)=>vn+cr.sets.length,0)/ht*100,kn=Me[we.name];we.type==="timed"&&De===0&&!Rn&&Ue===Ft&&setTimeout(()=>Be(we.time),0);const _s=Ue+1<we.sets?"Log Set":rt+1<We?"Log Set  Next Exercise":"Log Set  Complete";return a.jsxs("div",{className:"wk-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("div",{className:"mg-session-progress",children:a.jsx("div",{className:"mg-session-progress-fill",style:{width:`${Bt}%`}})}),a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>{confirm("End workout early?")&&T("muscle_overview")},"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsxs("span",{className:"mg-header-info",children:["Exercise ",rt+1,"/",We]}),a.jsx("div",{style:{width:22}})]})}),a.jsxs("main",{className:"wk-main",children:[kn?a.jsxs("div",{className:"mg-video-container",onClick:Ye,children:[kn.isGif?a.jsx("img",{className:"mg-video",src:kn.url,alt:we.name}):a.jsx("video",{ref:St,className:"mg-video",src:kn.url,loop:!0,muted:!0,playsInline:!0},we.name),!nt&&!kn.isGif&&a.jsxs("div",{className:"mg-video-overlay",children:[a.jsx("svg",{className:"mg-play-icon",width:"48",height:"48",viewBox:"0 0 24 24",fill:"rgba(255,255,255,0.9)",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),a.jsx("span",{className:"mg-video-hint",children:"Tap for demo"})]})]}):a.jsxs("div",{className:"mg-video-placeholder",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.4",children:[a.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),a.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),a.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),a.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),a.jsx("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),a.jsx("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),a.jsx("line",{x1:"17",y1:"7",x2:"22",y2:"7"}),a.jsx("line",{x1:"17",y1:"17",x2:"22",y2:"17"})]}),a.jsx("span",{children:"Video coming soon"})]}),a.jsx("div",{className:"wk-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"mg-exercise-card",children:[a.jsx("h2",{className:"mg-ex-name",children:we.name}),a.jsx("span",{className:`mg-ex-type-badge ${we.type}`,children:we.type==="weighted"?"Weight + Reps":we.type==="reps"?"Reps Only":"Timed"}),a.jsxs("div",{className:"mg-ex-set-info",children:[a.jsxs("span",{className:"mg-ex-set-num",children:["Set ",Ue+1," of ",we.sets]}),we.type!=="timed"&&a.jsxs("span",{className:"mg-ex-target",children:["Target: ",we.reps," reps"]}),we.type==="timed"&&a.jsxs("span",{className:"mg-ex-target",children:["Target: ",we.time,"s"]})]}),we.type==="weighted"&&a.jsxs("div",{className:"mg-input-area",children:[a.jsxs("div",{className:"mg-input-group",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",inputMode:"decimal",className:"mg-input",value:fs,onChange:vn=>Yt(vn.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"mg-input-group",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:Mn,onChange:vn=>dn(vn.target.value),placeholder:"0"})]})]}),we.type==="reps"&&a.jsx("div",{className:"mg-input-area",children:a.jsxs("div",{className:"mg-input-group mg-input-single",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:Mn,onChange:vn=>dn(vn.target.value),placeholder:"0"})]})}),we.type==="timed"&&a.jsxs("div",{className:"mg-timer-area",children:[a.jsx("div",{className:"mg-timer-display",children:a.jsxs("span",{className:"mg-timer-value",children:[De,"s"]})}),Rn?a.jsx("button",{className:"mg-timer-btn mg-timer-stop",onClick:()=>he(!1),children:"Stop"}):a.jsx("button",{className:"mg-timer-btn",onClick:()=>{De===0&&Be(we.time),he(!0)},children:De<we.time&&De>0?"Resume":"Start Timer"})]}),a.jsx("button",{className:"mg-log-set-btn",onClick:$e,children:_s}),se.sets.length>0&&a.jsx("div",{className:"mg-completed-sets",children:se.sets.map((vn,cr)=>a.jsxs("div",{className:"mg-completed-set",children:[a.jsx("span",{className:"mg-completed-set-check",children:""}),a.jsxs("span",{children:["Set ",cr+1,": ",vn.weight!=null?`${vn.weight}kg  ${vn.reps}`:vn.reps!=null?`${vn.reps} reps`:`${vn.time}s`]})]},cr))})]})]}),$n]})}if(x==="muscle_complete"){const Q=Dt.reduce((Ue,We)=>Ue+We.sets.length,0),we=Dt.reduce((Ue,We)=>Ue+We.sets.reduce((ht,kt)=>ht+(kt.weight||0)*(kt.reps||0),0),0),se=Ad.find(Ue=>Ue.key===yt)?.label||"";return a.jsxs("div",{className:"wk-page wk-page-center","data-theme":o?"dark":"light","data-accent":u,children:[a.jsxs("div",{className:"wk-complete",children:[a.jsxs("div",{className:"wk-complete-ring",children:[a.jsx("svg",{className:"wk-complete-svg",viewBox:"0 0 200 200",children:Kd.map((Ue,We)=>a.jsx("line",{x1:Ue.x1,y1:Ue.y1,x2:Ue.x2,y2:Ue.y2,className:"wk-tick-complete",strokeWidth:Ue.thick?"3.5":"2",style:{animationDelay:`${We*.02}s`}},We))}),a.jsx("div",{className:"wk-complete-center",children:a.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})})})]}),a.jsxs("h2",{className:"wk-complete-title",children:[se," Complete!"]}),a.jsx("p",{className:"mg-complete-session-name",children:et?.name}),a.jsxs("div",{className:"wk-complete-stats",children:[a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Dt.length}),a.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Q}),a.jsx("span",{className:"wk-stat-label",children:"Sets"})]}),we>0&&a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Math.round(we).toLocaleString()}),a.jsx("span",{className:"wk-stat-label",children:"Volume (kg)"})]})]}),a.jsx("div",{className:"wk-complete-actions",children:a.jsx("button",{className:"wk-btn-primary",onClick:()=>{ft(null),bt(null),xe(null),T("menu")},children:"Done"})})]}),Z&&a.jsx("div",{className:"mg-badge-celebration",onClick:()=>xe(null),children:a.jsxs("div",{className:"mg-badge-celebration-card",children:[a.jsx("div",{className:"mg-badge-celebration-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",width:"48",height:"48",fill:"#ffc107",children:a.jsx("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})})}),a.jsx("h3",{className:"mg-badge-celebration-title",children:Z.badges.length===1?"Badge Earned!":`${Z.badges.length} Badges Earned!`}),a.jsx("div",{className:"mg-badge-celebration-list",children:Z.badges.map((Ue,We)=>a.jsx("div",{className:"mg-badge-celebration-item",children:Ue.type==="pb_target"?`${Ue.exercise}  ${Ue.targetWeight}kg`:Ue.label},We))}),a.jsx("button",{className:"mg-badge-celebration-dismiss",children:"Tap to dismiss"})]})})]})}return null}const zV=60,qV={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},HV=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],FT=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,daysPerWeek:3,level:"All Levels",description:"Build total body strength with compound dumbbell movements and bodyweight finishers",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push Focus",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Goblet Squats",type:"weighted",sets:3,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull Focus",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:3,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:3,baseReps:10,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Reverse Lunge",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/reverse lunge.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Legs & Core",exercises:[{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Box Step Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/box step ups.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,daysPerWeek:3,level:"Intermediate",description:"Two-phase programme building strength and endurance across your full body",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Power",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"}]},{name:"Day 3",label:"Endurance",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,daysPerWeek:3,level:"Advanced",description:"Complete transformation programme: push, pull, and legs over three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Upper Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Lower Body",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 3",label:"Upper Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,daysPerWeek:3,level:"Beginner",description:"Build a solid core foundation with targeted ab and stability work",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Abs",exercises:[{name:"Crunch",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Stability",exercises:[{name:"Dead Bug",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Bird Dog",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:20,storagePath:"exercises/bodyweight/core/Side Plank.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"}]},{name:"Day 3",label:"Power Core",exercises:[{name:"Single Leg V-Up",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Single Leg V-Up.mp4"},{name:"Toe Reaches",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/toe reaches.GIF"},{name:"Russian Twists Dumbbell",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/core/russian twists dumbbell.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Fast Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Fast Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,daysPerWeek:3,level:"Intermediate",description:"Develop deep core strength and rotational power over two phases",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Anti-Extension",exercises:[{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Dead Bug",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Plank Walkout",type:"reps",sets:3,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"}]},{name:"Day 2",label:"Rotation",exercises:[{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank Rotation",type:"reps",sets:2,baseReps:10,storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"},{name:"Hollow Hold To V-Sit",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Kettlebell Bird Dog Drag",type:"reps",sets:3,baseReps:10,storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,daysPerWeek:3,level:"Advanced",description:"Ultimate core transformation: stability, strength, and power across three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Forearm Plank",type:"timed",sets:4,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Plank Walkout",type:"reps",sets:4,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Leg Raises",type:"reps",sets:4,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Kettlebell Side Bends",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Dead Bug Single Leg Drop",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 2",label:"Endurance",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:4,baseReps:15,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Hollow Hold Flutter Kicks",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"},{name:"Cross Body Mountain Climbers",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Hollow Hold To V-Sit",type:"reps",sets:4,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Hip Dips Plank",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Kneeling Kettlebell Halo",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,daysPerWeek:3,level:"Intermediate",description:"Sculpt and strengthen your chest, back, shoulders, and arms",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Tricep Dips",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Pike Push Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/upper/pike push ups.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Reverse Plank",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/upper/reverse plank.GIF"}]},{name:"Day 3",label:"Mixed",exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Renegade Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Superman Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Superman Hold.mp4"}]}]},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,daysPerWeek:3,level:"Intermediate",description:"Build powerful legs and glutes with squats, deadlifts, and plyometrics",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Quad Dominant",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Squat And Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/lower/squat and hold.GIF"}]},{name:"Day 2",label:"Hamstring & Glute",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"1 Legged RDL",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.GIF"},{name:"Hip Thrusts",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/hip thrusts.GIF"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.GIF"},{name:"Donkey Kicks",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 3",label:"Power & Stability",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Kettlebell Romanian Deadlift",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/kettlebells/lower/kettlebell romanian deadlift.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Skater Jumps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/skater jumps.GIF"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]}];function nm(n,e,t){const s=n.baseReps?n.baseReps+(e-1)*(t.repProg||0):void 0,o=n.baseTime?n.baseTime+(e-1)*(t.timeProg||0):void 0;return{sets:n.sets,reps:s,time:o}}const $V={fullbody:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z",core:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z",upper:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z",lower:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"};function WV(){const{currentUser:n,isClient:e,clientData:t,loading:s}=Wr(),{isDark:o,toggleTheme:c,accent:u}=Ui(),h=lr(),m=Bi(),[g,b]=_.useState("loading"),[x,T]=_.useState(null),N=_.useRef(!1),[B,P]=_.useState(null),[M,Y]=_.useState(1),[H,X]=_.useState(0),[fe,je]=_.useState(0),[Te,C]=_.useState(0),[S,D]=_.useState([]),[U,V]=_.useState(""),[q,L]=_.useState(""),[Ke,_t]=_.useState(!1),[$,ge]=_.useState(0),Le=_.useRef(null),[Qe,ne]=_.useState({}),[O,ie]=_.useState(!1),Ie=_.useRef(null),[Oe,it]=_.useState(null),[ze,vt]=_.useState([]);_.useEffect(()=>{window.scrollTo(0,0)},[g]);const[Nt,at]=_.useState(null),Xt=_.useCallback((he,De="info")=>{at({message:he,type:De}),setTimeout(()=>at(null),4e3)},[]),An=_.useRef(null),Pt=()=>(An.current||(An.current=new(window.AudioContext||window.webkitAudioContext)),An.current),Ce=()=>{try{const he=Pt(),De=he.createOscillator(),Be=he.createGain();De.connect(Be),Be.connect(he.destination),De.frequency.value=1200,Be.gain.value=.4,De.start(he.currentTime),De.stop(he.currentTime+.3)}catch{}};_.useEffect(()=>{!s&&(!n||!e)&&h("/")},[n,e,s,h]),_.useEffect(()=>{if(!t)return;(async()=>{try{const De=Ge(ve,"clientProgrammes",t.id),Be=await Pn(De);Be.exists()&&P(Be.data());const nt=m.state?.templateId;if(nt&&!N.current){const Fe=FT.find(Me=>Me.id===nt);if(Fe){N.current=!0,T(Fe),b("overview");return}}Be.exists()?b("dashboard"):h("/client/core-buddy/workouts",{replace:!0})}catch(De){console.error("Error loading programme:",De),h("/client/core-buddy/workouts",{replace:!0})}})()},[t]),_.useEffect(()=>{if(!Ke||$<=0){Ke&&$<=0&&(_t(!1),Ce());return}return Le.current=setTimeout(()=>ge(he=>he-1),1e3),()=>clearTimeout(Le.current)},[Ke,$]);const ee=async he=>{if(t)try{await zn(Ge(ve,"clientProgrammes",t.id),he),P(he)}catch(De){console.error("Error saving programme:",De),Xt("Failed to save. Check Firestore rules for clientProgrammes.","error")}},yt=async he=>{const De={templateId:he.id,startDate:pt.now(),completedSessions:{}};await ee(De),b("dashboard")},bt=async()=>{if(t)try{await Rr(Ge(ve,"clientProgrammes",t.id)),P(null),b("browse")}catch(he){console.error("Error quitting programme:",he)}},et=()=>B?FT.find(he=>he.id===B.templateId):null,ft=()=>{if(!B?.startDate)return 1;const he=B.startDate.toDate?B.startDate.toDate():new Date(B.startDate),Be=new Date-he,nt=Math.floor(Be/(1e3*60*60*24));return Math.floor(nt/7)+1},rt=()=>{if(!B)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const he=B.completedSessions||{},De=Object.keys(he).length,Be=et();if(!Be)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const nt=Be.duration*Be.daysPerWeek,Fe=ft(),Me=Math.min(Fe,Be.duration);let qe=0;for(let wt=0;wt<Be.daysPerWeek;wt++)he[`w${Me}d${wt}`]&&qe++;if(De>=nt)return{currentWeek:Be.duration,completedThisWeek:Be.daysPerWeek,nextDay:-1,totalCompleted:De,totalSessions:nt,complete:!0};if(Fe>Be.duration)return{currentWeek:Be.duration,completedThisWeek:qe,nextDay:-1,totalCompleted:De,totalSessions:nt,complete:!0};let St=-1;for(let wt=0;wt<Be.daysPerWeek;wt++)if(!he[`w${Me}d${wt}`]){St=wt;break}return{currentWeek:Me,completedThisWeek:qe,nextDay:St,nextWeek:Me,totalCompleted:De,totalSessions:nt}},tt=he=>{const De=ft();return he<De},Ft=(he,De,Be)=>{if(!B||he<=1)return null;const nt=`w${he-1}d${De}`,Fe=B.completedSessions?.[nt];if(!Fe)return null;const Me=Fe.exercises?.find(qe=>qe.name===Be);return Me?.sets?.length?Me.sets[Me.sets.length-1]:null},ts=(he,De)=>{const Be=et();if(!Be)return;Y(he),X(De),je(0),C(0),D([]),L(""),_t(!1),ge(0),ie(!1),ne({});const nt=Be.days[De],Fe=nt.exercises.map(wt=>{const Mt=nm(wt,he,Be);return{name:wt.name,type:wt.type,pbKey:wt.pbKey,targetSets:Mt.sets,targetReps:Mt.reps,targetTime:Mt.time,sets:[]}});D(Fe);const Me=nt.exercises[0],qe=Ft(he,De,Me.name);qe?.weight&&Me.type==="weighted"?V(String(qe.weight)):V(""),(async()=>{const wt={};for(const Mt of nt.exercises)if(Mt.storagePath)try{const Jt=Do(Po,Mt.storagePath),Z=await Dl(Jt);wt[Mt.name]={url:Z,isGif:/\.gif$/i.test(Mt.storagePath)}}catch(Jt){console.warn(`Video not found for ${Mt.name}:`,Jt)}ne(wt)})(),b("session")},Dt=async()=>{et();const he=S[fe];if(!he)return;let De={};if(he.type==="weighted"){const Fe=parseFloat(U)||0,Me=parseInt(q)||0;if(Me===0){Xt("Enter your reps","error");return}De={weight:Fe,reps:Me}}else if(he.type==="reps"){const Fe=parseInt(q)||0;if(Fe===0){Xt("Enter your reps","error");return}De={reps:Fe}}else if(he.type==="timed"){const Fe=he.targetTime-$;De={time:Math.max(Fe,1)}}const Be=[...S];Be[fe]={...he,sets:[...he.sets,De]},D(Be),he.type==="weighted"&&De.weight>0&&await Yt(he.name,De.weight,De.reps);const nt=he.sets.length+1;if(nt<he.targetSets)C(nt),V(De.weight?String(De.weight):""),L(""),_t(!1),ge(0);else if(fe+1<S.length){const Fe=fe+1;je(Fe),C(0),ie(!1);const qe=et()?.days[H]?.exercises[Fe],St=Ft(M,H,qe?.name);St?.weight&&qe?.type==="weighted"?V(String(St.weight)):V(""),L(""),_t(!1),ge(0)}else await un(Be)},un=async he=>{if(!B||!t)return;const De=`w${M}d${H}`,Be={...B.completedSessions,[De]:{completedAt:new Date().toISOString(),exercises:he.map(Me=>({name:Me.name,type:Me.type,sets:Me.sets}))}},nt={...B,completedSessions:Be};await ee(nt);const Fe=he.reduce((Me,qe)=>Me+qe.sets.reduce((St,wt)=>St+(wt.weight||0)*(wt.reps||0),0),0);Fe>0&&await fs(Fe);try{const Me=et();await Ia(Kt(ve,"workoutLogs"),{clientId:t.id,type:"programme",programmeId:Me?.id,programmeName:Me?.name,week:M,day:H+1,exerciseCount:he.length,duration:Math.round(he.reduce((qe,St)=>qe+St.sets.length*1.5,0)),volume:Math.round(Fe),completedAt:pt.now()})}catch(Me){console.error("Error saving workout log:",Me)}ze.length>0&&(it({badges:[...ze]}),vt([])),b("sessionComplete")},fs=async he=>{if(t)try{const De=await Pn(Ge(ve,"coreBuddyAchievements",t.id)),Be=De.exists()?De.data():{clientId:t.id,badges:[],totalVolume:0},nt=Be.totalVolume||0,Fe=nt+he,Me=[];HV.forEach(St=>{Fe>=St.threshold&&nt<St.threshold&&(Be.badges.some(Mt=>Mt.type==="volume_milestone"&&Mt.milestone===St.threshold)||Me.push({type:"volume_milestone",milestone:St.threshold,label:St.label,achievedAt:pt.now()}))});const qe=[...Be.badges,...Me];await zn(Ge(ve,"coreBuddyAchievements",t.id),{clientId:t.id,badges:qe,totalVolume:Math.round(Fe),updatedAt:pt.now()}),Me.length>0&&vt(St=>[...St,...Me])}catch(De){console.error("Error updating volume:",De)}},Yt=async(he,De,Be)=>{if(t)try{const nt=t.id,Fe=await Pn(Ge(ve,"coreBuddyPBs",nt)),qe=(Fe.exists()?Fe.data():null)?.exercises||{},St=qe[he];let wt=!1;if(St?(De>(St.weight||0)||De===(St.weight||0)&&Be>(St.reps||0))&&(wt=!0):wt=!0,wt){const Mt={...qe,[he]:{weight:De,reps:Be,achievedAt:pt.now()}};await zn(Ge(ve,"coreBuddyPBs",nt),{clientId:t.id,exercises:Mt,updatedAt:pt.now()}),Xt(`New PB! ${De}kg  ${Be} reps`,"success"),Ce(),await Mn(he,De)}}catch(nt){console.error("Error checking PB:",nt)}},Mn=async(he,De)=>{if(t)try{const Be=await Pn(Ge(ve,"coreBuddyTargets",t.id));if(!Be.exists())return;const Fe=(Be.data().targets||{})[he];if(!Fe||De<Fe.targetWeight)return;const Me=await Pn(Ge(ve,"coreBuddyAchievements",t.id)),qe=Me.exists()?Me.data():{clientId:t.id,badges:[],totalVolume:0};if(qe.badges.some(Jt=>Jt.type==="pb_target"&&Jt.exercise===he&&Jt.targetWeight===Fe.targetWeight))return;const wt={type:"pb_target",exercise:he,group:qV[he]||"push",targetWeight:Fe.targetWeight,achievedAt:pt.now()},Mt=[...qe.badges,wt];await zn(Ge(ve,"coreBuddyAchievements",t.id),{...qe,badges:Mt,updatedAt:pt.now()}),vt(Jt=>[...Jt,wt])}catch(Be){console.error("Error checking target badge:",Be)}},dn=Nt&&a.jsxs("div",{className:`toast-notification ${Nt.type}`,children:[Nt.type==="success"&&a.jsx("span",{children:" "}),Nt.message]}),Rn=(he,De)=>a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:De,"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:o?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})});if(s||g==="loading")return a.jsx("div",{className:"cb-loading",children:a.jsx("div",{className:"cb-loading-spinner"})});if(g==="browse")return h("/client/core-buddy/workouts",{replace:!0}),null;if(g==="overview"&&x){const he=x;return a.jsxs("div",{className:"pg-page","data-theme":o?"dark":"light","data-accent":u,children:[Rn(he.name,()=>h("/client/core-buddy/workouts")),a.jsxs("main",{className:"pg-main",children:[a.jsxs("div",{className:"pg-overview-hero",children:[a.jsx("svg",{className:"pg-overview-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:$V[he.focus]})}),a.jsx("h2",{className:"pg-overview-name",children:he.name}),a.jsx("p",{className:"pg-overview-desc",children:he.description}),a.jsxs("div",{className:"pg-overview-stats",children:[a.jsxs("div",{className:"pg-ov-stat",children:[a.jsx("span",{className:"pg-ov-stat-num",children:he.duration}),a.jsx("span",{className:"pg-ov-stat-label",children:"Weeks"})]}),a.jsxs("div",{className:"pg-ov-stat",children:[a.jsx("span",{className:"pg-ov-stat-num",children:he.daysPerWeek}),a.jsx("span",{className:"pg-ov-stat-label",children:"Days/Week"})]}),a.jsxs("div",{className:"pg-ov-stat",children:[a.jsx("span",{className:"pg-ov-stat-num",children:he.duration*he.daysPerWeek}),a.jsx("span",{className:"pg-ov-stat-label",children:"Sessions"})]})]})]}),a.jsx("div",{className:"pg-overview-days",children:he.days.map((De,Be)=>a.jsxs("div",{className:"pg-day-card",children:[a.jsxs("div",{className:"pg-day-header",children:[a.jsx("span",{className:"pg-day-name",children:De.name}),a.jsx("span",{className:"pg-day-label",children:De.label})]}),a.jsx("div",{className:"pg-day-exercises",children:De.exercises.map((nt,Fe)=>{const Me=nm(nt,1,he);return a.jsxs("div",{className:"pg-day-ex",children:[a.jsx("span",{className:"pg-day-ex-name",children:nt.name}),a.jsx("span",{className:"pg-day-ex-target",children:nt.type==="timed"?`${Me.sets}${Me.time}s`:`${Me.sets}${Me.reps}`}),a.jsx("span",{className:`pg-day-ex-badge pg-badge-${nt.type}`,children:nt.type==="weighted"?"WT":nt.type==="timed"?"TMR":"BW"})]},Fe)})})]},Be))}),a.jsxs("div",{className:"pg-overview-note",children:[a.jsx("strong",{children:"Progressive Overload:"})," +",he.repProg," reps/week",he.timeProg?`, +${he.timeProg}s/week for timed`:""]}),a.jsx("button",{className:"pg-start-btn",onClick:()=>yt(he),children:"Start Programme"})]}),dn]})}if(g==="dashboard"){const he=et();if(!he)return b("browse"),null;const De=rt(),Be=B?.completedSessions||{},nt=De.totalSessions?Math.round(De.totalCompleted/De.totalSessions*100):0;return Math.round(De.totalCompleted/(De.totalSessions||1)*zV),a.jsxs("div",{className:"pg-page","data-theme":o?"dark":"light","data-accent":u,children:[Rn("Programme",()=>h("/client/core-buddy/workouts")),a.jsxs("main",{className:"pg-main",children:[a.jsxs("div",{className:"pg-dash-hero",children:[a.jsxs("div",{className:"pg-dash-ring-wrap",children:[a.jsxs("svg",{viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"pg-arc-track",cx:"100",cy:"100",r:"80"}),a.jsx("circle",{className:"pg-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-nt/100*2*Math.PI*80})]}),a.jsxs("div",{className:"pg-ring-center",children:[a.jsxs("span",{className:"pg-ring-pct",children:[nt,"%"]}),a.jsx("span",{className:"pg-ring-label",children:"complete"})]})]}),a.jsx("h2",{className:"pg-dash-name",children:he.name}),a.jsxs("div",{className:"pg-dash-progress-text",children:[a.jsxs("span",{className:"pg-dash-pct",children:[nt,"%"]}),a.jsxs("span",{className:"pg-dash-week",children:["Week ",De.currentWeek," of ",he.duration]})]})]}),a.jsx("div",{className:"pg-weeks",children:Array.from({length:he.duration},(Fe,Me)=>{const qe=Me+1,St=tt(qe);return a.jsxs("div",{className:`pg-week-row${qe===De.currentWeek?" pg-week-current":""}`,children:[a.jsxs("span",{className:"pg-week-label",children:["W",qe]}),a.jsx("div",{className:"pg-week-days",children:he.days.map((wt,Mt)=>{const Jt=`w${qe}d${Mt}`,Z=!!Be[Jt],xe=!Z&&St,ct=!Z&&!xe&&qe===De.currentWeek&&!De.complete;return a.jsx("button",{className:`pg-day-dot${Z?" done":""}${xe?" missed":""}${ct?" next":""}`,disabled:!ct,onClick:()=>{ct&&ts(qe,Mt)},children:Z?a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}):xe?a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsx("span",{children:wt.name.replace("Day ","")})},Mt)})})]},Me)})}),!De.complete&&(()=>{const Fe=he.days.map((Me,qe)=>({day:Me,d:qe})).filter(({d:Me})=>!Be[`w${De.currentWeek}d${Me}`]);return Fe.length===0?null:a.jsxs("div",{className:"pg-next-session",children:[a.jsx("h3",{children:Fe.length===he.daysPerWeek?"Choose a Session":"Remaining Sessions"}),a.jsxs("p",{className:"pg-next-info",children:["Week ",De.currentWeek,"  ",Fe.length," session",Fe.length!==1?"s":""," left this week"]}),Fe.map(({day:Me,d:qe})=>a.jsxs("div",{className:"pg-available-session",children:[a.jsxs("div",{className:"pg-next-exercises",children:[a.jsxs("span",{className:"pg-avail-day-label",children:[Me.name,": ",Me.label]}),Me.exercises.map((St,wt)=>{const Mt=nm(St,De.currentWeek,he);return a.jsxs("div",{className:"pg-next-ex",children:[a.jsx("span",{className:"pg-next-ex-name",children:St.name}),a.jsx("span",{className:"pg-next-ex-target",children:St.type==="timed"?`${Mt.sets}${Mt.time}s`:`${Mt.sets}${Mt.reps}`})]},wt)})]}),a.jsxs("button",{className:"pg-start-btn",onClick:()=>ts(De.currentWeek,qe),children:["Start ",Me.name]})]},qe))]})})(),De.complete&&a.jsxs("div",{className:"pg-complete-msg",children:[a.jsx("h3",{children:"Programme Complete! "}),a.jsxs("p",{children:["You finished all ",De.totalSessions," sessions."]}),a.jsx("button",{className:"pg-start-btn",onClick:bt,children:"Choose New Programme"})]}),a.jsx("button",{className:"pg-quit-btn",onClick:()=>{confirm("Quit this programme? Progress will be lost.")&&bt()},children:"Quit Programme"})]}),a.jsx(Ti,{active:"workouts"}),dn]})}if(g==="session"){const he=et();if(!he)return null;const De=he.days[H],Be=De.exercises[fe],nt=nm(Be,M,he),Fe=S[fe],Me=Fe?.sets?.length||0,qe=De.exercises.length,St=(fe+Me/nt.sets)/qe,wt=Qe[Be.name],Mt=Ft(M,H,Be.name);Be.type==="timed"&&$===0&&!Ke&&Me===Te&&setTimeout(()=>ge(nt.time),0);const Jt=()=>{wt?.isGif?ie(!O):Ie.current&&(O?Ie.current.pause():Ie.current.play(),ie(!O))};return a.jsxs("div",{className:"pg-page pg-page-session","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("div",{className:"pg-session-progress",children:a.jsx("div",{className:"pg-session-progress-fill",style:{width:`${St*100}%`}})}),a.jsxs("div",{className:"pg-session-header",children:[a.jsx("button",{className:"pg-session-back",onClick:()=>{confirm("Leave session? Progress will be lost.")&&b("dashboard")},children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M19 12H5M12 5l-7 7 7 7"})})}),a.jsxs("div",{className:"pg-session-title",children:[a.jsxs("span",{className:"pg-session-counter",children:[fe+1," / ",qe]}),a.jsxs("span",{className:"pg-session-week",children:["Week ",M,"  ",De.name]})]})]}),wt&&a.jsxs("div",{className:"pg-video-container",onClick:Jt,children:[wt.isGif?a.jsx("img",{className:"pg-video",src:wt.url,alt:Be.name}):a.jsx("video",{ref:Ie,className:"pg-video",src:wt.url,loop:!0,muted:!0,playsInline:!0},Be.name),!O&&a.jsxs("div",{className:"pg-video-overlay",children:[a.jsx("svg",{className:"pg-play-icon",viewBox:"0 0 24 24",fill:"white",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),a.jsx("span",{className:"pg-video-hint",children:"Tap for demo"})]})]}),a.jsx("div",{className:"pg-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"pg-exercise-card",children:[a.jsx("h2",{className:"pg-ex-name",children:Be.name}),a.jsx("span",{className:`pg-ex-type-badge pg-badge-${Be.type}`,children:Be.type==="weighted"?"Weight + Reps":Be.type==="timed"?"Timed":"Reps Only"}),Be.type==="weighted"&&Mt&&a.jsxs("div",{className:"pg-last-week",children:[a.jsx("span",{className:"pg-last-week-label",children:"Last week:"}),a.jsxs("span",{className:"pg-last-week-value",children:[Mt.weight,"kg x ",Mt.reps," reps"]})]}),a.jsxs("div",{className:"pg-ex-set-info",children:[a.jsxs("span",{className:"pg-ex-set-num",children:["Set ",Me+1," of ",nt.sets]}),a.jsxs("span",{className:"pg-ex-target",children:["Target: ",Be.type==="timed"?`${nt.time}s hold`:`${nt.reps} reps`]})]}),Be.type==="weighted"&&a.jsxs("div",{className:"pg-input-area",children:[a.jsxs("div",{className:"pg-input-group",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",inputMode:"decimal",value:U,onChange:Z=>V(Z.target.value),placeholder:"0",className:"pg-input"})]}),a.jsxs("div",{className:"pg-input-group",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",value:q,onChange:Z=>L(Z.target.value),placeholder:String(nt.reps),className:"pg-input"})]})]}),Be.type==="reps"&&a.jsx("div",{className:"pg-input-area",children:a.jsxs("div",{className:"pg-input-group pg-input-single",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",value:q,onChange:Z=>L(Z.target.value),placeholder:String(nt.reps),className:"pg-input"})]})}),Be.type==="timed"&&a.jsxs("div",{className:"pg-timer-area",children:[a.jsx("div",{className:"pg-timer-display",children:a.jsxs("span",{className:"pg-timer-value",children:[$,"s"]})}),Ke?a.jsx("button",{className:"pg-timer-btn pg-timer-stop",onClick:()=>_t(!1),children:"Stop"}):a.jsx("button",{className:"pg-timer-btn",onClick:()=>{$===0&&ge(nt.time),_t(!0)},children:$<nt.time&&$>0?"Resume":"Start Timer"})]}),a.jsx("button",{className:"pg-log-set-btn",onClick:Dt,disabled:Be.type==="timed"&&Ke,children:Me+1<nt.sets?"Log Set":fe+1<qe?"Log Set  Next Exercise":"Log Set  Complete"}),Fe?.sets?.length>0&&a.jsx("div",{className:"pg-completed-sets",children:Fe.sets.map((Z,xe)=>a.jsxs("div",{className:"pg-completed-set",children:[a.jsx("span",{className:"pg-completed-set-check",children:""}),a.jsxs("span",{children:["Set ",xe+1,": ",Z.weight!==void 0?`${Z.weight}kg  ${Z.reps}`:Z.time!==void 0?`${Z.time}s`:`${Z.reps} reps`]})]},xe))})]}),dn]})}if(g==="sessionComplete"){const De=et()?.days[H],Be=S.reduce((Fe,Me)=>Fe+Me.sets.length,0),nt=S.reduce((Fe,Me)=>Fe+Me.sets.reduce((qe,St)=>qe+(St.weight||0)*(St.reps||0),0),0);return a.jsxs("div",{className:"pg-page pg-page-center","data-theme":o?"dark":"light","data-accent":u,children:[a.jsxs("div",{className:"pg-session-done",children:[a.jsxs("div",{className:"pg-done-ring",children:[a.jsx("svg",{className:"pg-done-ring-svg",viewBox:"0 0 200 200",children:Kd.map((Fe,Me)=>a.jsx("line",{x1:Fe.x1,y1:Fe.y1,x2:Fe.x2,y2:Fe.y2,className:"pg-tick-complete",strokeWidth:Fe.thick?"3.5":"2",style:{animationDelay:`${Me*.02}s`}},Me))}),a.jsx("div",{className:"pg-done-center",children:a.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})})})]}),a.jsx("h2",{className:"pg-done-title",children:"Session Complete!"}),a.jsxs("p",{className:"pg-done-subtitle",children:["Week ",M,"  ",De?.name,": ",De?.label]}),a.jsxs("div",{className:"pg-done-stats",children:[a.jsxs("div",{className:"pg-done-stat",children:[a.jsx("span",{className:"pg-done-stat-num",children:S.length}),a.jsx("span",{className:"pg-done-stat-label",children:"Exercises"})]}),a.jsxs("div",{className:"pg-done-stat",children:[a.jsx("span",{className:"pg-done-stat-num",children:Be}),a.jsx("span",{className:"pg-done-stat-label",children:"Sets"})]}),nt>0&&a.jsxs("div",{className:"pg-done-stat",children:[a.jsx("span",{className:"pg-done-stat-num",children:Math.round(nt).toLocaleString()}),a.jsx("span",{className:"pg-done-stat-label",children:"Volume (kg)"})]})]}),a.jsx("button",{className:"pg-start-btn",onClick:()=>b("dashboard"),children:"Back to Programme"})]}),Oe&&a.jsx("div",{className:"pg-badge-celebration",onClick:()=>it(null),children:a.jsxs("div",{className:"pg-badge-celebration-card",onClick:Fe=>Fe.stopPropagation(),children:[a.jsx("div",{className:"pg-badge-celebration-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsx("h3",{className:"pg-badge-celebration-title",children:Oe.badges.length===1?"Badge Earned!":`${Oe.badges.length} Badges Earned!`}),a.jsx("div",{className:"pg-badge-celebration-list",children:Oe.badges.map((Fe,Me)=>a.jsx("div",{className:"pg-badge-celebration-item",children:Fe.type==="pb_target"?`${Fe.exercise}  ${Fe.targetWeight}kg`:Fe.label},Me))}),a.jsx("button",{className:"pg-badge-celebration-dismiss",onClick:()=>it(null),children:"Tap to dismiss"})]})}),dn]})}return null}const GV={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},KV={push:{label:"Push",color:"#c75f6b",icon:"M4 12h3l3-9 4 18 3-9h3"},pull:{label:"Pull",color:"#5f8ac7",icon:"M12 2v10m0 0l-4-4m4 4l4-4M4 20h16"},lower:{label:"Lower",color:"#5fc77a",icon:"M12 2v8m-4 4l4 8 4-8m-8 0h8"},core:{label:"Core",color:"#c7a45f",icon:"M12 2a4 4 0 014 4v1h-2V6a2 2 0 10-4 0v1H8V6a4 4 0 014-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"}},ub=[{threshold:1e3,label:"1 Tonne",icon:"1T"},{threshold:5e3,label:"5 Tonne",icon:"5T"},{threshold:1e4,label:"10 Tonne",icon:"10T"},{threshold:25e3,label:"25 Tonne",icon:"25T"},{threshold:5e4,label:"50 Tonne",icon:"50T"},{threshold:1e5,label:"100 Tonne",icon:"100T"},{threshold:25e4,label:"250 Tonne",icon:"250T"},{threshold:5e5,label:"500 Tonne",icon:"500T"},{threshold:1e6,label:"1 Million kg",icon:"1M"}];function QV(n){return GV[n]||"push"}function YV(n){return n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}T`:`${Math.round(n)}`}function XV(n){return n>=1e6?"million kg":n>=1e3?"tonnes":"kg"}function JV(){const{currentUser:n,isClient:e,clientData:t,loading:s}=Wr(),{isDark:o,toggleTheme:c,accent:u}=Ui(),h=lr(),[m,g]=_.useState(!0),[b,x]=_.useState(null),[T,N]=_.useState({}),[B,P]=_.useState([]),[M,Y]=_.useState(null),[H,X]=_.useState(0),[fe,je]=_.useState({});_.useRef(null),_.useEffect(()=>{!s&&(!n||!e)&&h("/")},[n,e,s,h]),_.useEffect(()=>{if(!t)return;(async()=>{try{const[ge,Le,Qe,ne]=await Promise.all([Pn(Ge(ve,"coreBuddyAchievements",t.id)),Pn(Ge(ve,"coreBuddyPBs",t.id)),Pn(Ge(ve,"achievements",t.id)),Sn(Dn(Kt(ve,"workoutLogs"),hn("clientId","==",t.id)))]);ge.exists()&&x(ge.data()),Le.exists()&&N(Le.data().exercises||{}),Qe.exists()&&(P(Object.keys(Qe.data().badges||{})),je(Qe.data().progress||{})),X(ne.docs.length)}catch(ge){console.error("Error loading achievements:",ge)}g(!1)})()},[t]);const Te=b?.badges||[],C=b?.totalVolume||0,S=Te.filter($=>$.type==="pb_target"),D=Te.filter($=>$.type==="volume_milestone"),U={push:[],pull:[],lower:[],core:[]};S.forEach($=>{const ge=$.group||QV($.exercise);U[ge]&&U[ge].push($)});const V=ub.find($=>C<$.threshold),q=ub.filter($=>C>=$.threshold).pop()?.threshold||0,L=V?(C-q)/(V.threshold-q):1;if(s||m)return a.jsxs("div",{className:"ach-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("header",{className:"client-header",children:a.jsx("div",{className:"header-content",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),a.jsx("div",{className:"ach-loading-inline",children:a.jsx("div",{className:"cb-loading-spinner"})})]});const Ke=Te.length+B.length,_t=Ke>0||C>0||H>0;return a.jsxs("div",{className:"ach-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:o?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"ach-main",children:[a.jsx("button",{className:"nut-back-btn",onClick:()=>h("/client/personal-bests?mode=corebuddy"),children:" Back"}),a.jsxs("div",{className:"ach-stats-banner",children:[a.jsxs("div",{className:"ach-stat-item",children:[a.jsx("span",{className:"ach-stat-num",children:Ke}),a.jsx("span",{className:"ach-stat-label",children:Ke===1?"Badge":"Badges"})]}),a.jsx("div",{className:"ach-stat-divider"}),a.jsxs("div",{className:"ach-stat-item",children:[a.jsx("span",{className:"ach-stat-num",children:YV(C)}),a.jsxs("span",{className:"ach-stat-label",children:[XV(C)," lifted"]})]}),a.jsx("div",{className:"ach-stat-divider"}),a.jsxs("div",{className:"ach-stat-item",children:[a.jsx("span",{className:"ach-stat-num",children:Object.keys(T).length}),a.jsx("span",{className:"ach-stat-label",children:"PBs"})]})]}),!_t&&a.jsxs("div",{className:"ach-empty",children:[a.jsx("div",{className:"ach-empty-icon",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M12 15l-3-3h6l-3 3z"}),a.jsx("path",{d:"M5 7h14l-1.5 9h-11L5 7z"}),a.jsx("path",{d:"M8.5 7V5a3.5 3.5 0 017 0v2"})]})}),a.jsx("h4",{children:"No achievements yet"}),a.jsx("p",{children:"Complete workouts to track volume and set PB targets to start earning badges."})]}),[{key:"workouts",title:"Workout Badges",iconPath:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"},{key:"streaks",title:"Streak Badges",iconPath:"M13.5.67s.74 2.65.74 4.8c0 2.06-1.35 3.73-3.41 3.73-2.07 0-3.63-1.67-3.63-3.73l.03-.36C5.21 7.51 4 10.62 4 14c0 4.42 3.58 8 8 8s8-3.58 8-8C20 8.61 17.41 3.8 13.5.67z"},{key:"pbs",title:"Personal Best Badges",iconPath:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"},{key:"nutrition",title:"Nutrition Badges",iconPath:"M18.06 23h1.66c.84 0 1.53-.65 1.63-1.47L23 5.05h-5V1h-2v4.05h-5l.3 2.34c1.71.47 3.31 1.32 4.27 2.26 1.44 1.42 2.43 2.89 2.43 5.29V23zM1 22v-1h15.03v1c0 .55-.45 1-1.01 1H2.01c-.56 0-1.01-.45-1.01-1zm15.03-7c0-4.87-4.66-5.84-8.03-5.97l.72 5.52L1 15.05v5.95h15.03V15z"},{key:"habits",title:"Habit Badges",iconPath:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"},{key:"leaderboard",title:"Leaderboard Badges",iconPath:"M7.5 21H2V9h5.5v12zm7.25-18h-5.5v18h5.5V3zM22 11h-5.5v10H22V11z"}].map($=>{const ge=Qd.filter(ne=>ne.category===$.key);if(ge.length===0)return null;const Le=(()=>{switch($.key){case"workouts":return H;case"streaks":return fe.streakWeeks||0;case"pbs":return Object.keys(T).length;case"nutrition":return fe.nutritionStreak||0;case"leaderboard":return t?.leaderboardOptIn?1:0;case"habits":return fe.habitStreak||0;default:return 0}})(),Qe=ge.filter(ne=>B.includes(ne.id)).length;return a.jsxs("div",{className:"ach-section",children:[a.jsxs("h3",{className:"ach-section-title",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:$.iconPath})}),$.title]}),a.jsx("div",{className:"ach-workout-carousel",children:ge.map(ne=>{const O=B.includes(ne.id);return a.jsxs("button",{className:`ach-workout-badge${O?" unlocked":" locked"}`,onClick:()=>Y(ne),children:[a.jsx("img",{src:ne.img,alt:ne.name,className:"ach-workout-badge-img"}),!O&&ne.threshold&&a.jsx("div",{className:"ach-workout-badge-progress",children:a.jsx("div",{className:"ach-workout-badge-progress-fill",style:{width:`${Math.min(Le/ne.threshold*100,100)}%`}})})]},ne.id)})}),a.jsxs("p",{className:"ach-workout-badges-count",children:[Qe,"/",ge.length," unlocked"]})]},$.key)}),M&&a.jsx("div",{className:"ach-badge-overlay",onClick:()=>Y(null),children:a.jsxs("div",{className:"ach-badge-overlay-content",onClick:$=>$.stopPropagation(),children:[a.jsx("img",{src:M.img,alt:M.name,className:`ach-badge-overlay-img${B.includes(M.id)?"":" ach-badge-overlay-img-locked"}`}),a.jsx("p",{className:"ach-badge-overlay-desc",children:M.desc}),B.includes(M.id)?a.jsx("span",{className:"ach-badge-overlay-status unlocked",children:"Unlocked"}):a.jsx("span",{className:"ach-badge-overlay-status locked",children:"Locked"}),a.jsx("button",{className:"ach-badge-overlay-close",onClick:()=>Y(null),children:"Tap to close"})]})}),a.jsxs("div",{className:"ach-section",children:[a.jsxs("h3",{className:"ach-section-title",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})}),"Volume Milestones"]}),a.jsxs("div",{className:"ach-volume-hero",children:[a.jsxs("div",{className:"ach-volume-ring",children:[a.jsx("svg",{className:"ach-volume-ring-svg",viewBox:"0 0 200 200",children:Kd.map(($,ge)=>{const Le=ge<Math.round(L*60);return a.jsx("line",{x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,className:Le?"ach-tick-filled":"ach-tick-empty",strokeWidth:$.thick?"3":"2"},ge)})}),a.jsxs("div",{className:"ach-volume-center",children:[a.jsx("span",{className:"ach-volume-number",children:Math.round(C).toLocaleString()}),a.jsx("span",{className:"ach-volume-unit",children:"kg lifted"})]})]}),V&&a.jsxs("div",{className:"ach-volume-next",children:["Next: ",a.jsx("strong",{children:V.label})," (",(V.threshold-C).toLocaleString(),"kg to go)"]})]}),a.jsx("div",{className:"ach-milestone-shelf",children:ub.map(($,ge)=>{const Le=C>=$.threshold,Qe=D.find(ne=>ne.milestone===$.threshold);return a.jsxs("div",{className:`ach-milestone ${Le?"unlocked":"locked"}`,children:[a.jsx("div",{className:"ach-milestone-hex",children:a.jsx("span",{className:"ach-milestone-icon",children:$.icon})}),a.jsx("span",{className:"ach-milestone-label",children:$.label}),Qe?.achievedAt&&a.jsx("span",{className:"ach-milestone-date",children:(Qe.achievedAt.toDate?Qe.achievedAt.toDate():new Date(Qe.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short"})})]},ge)})})]}),a.jsxs("div",{className:"ach-section",children:[a.jsxs("h3",{className:"ach-section-title",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"PB Target Badges"]}),S.length===0?a.jsx("div",{className:"ach-pb-empty",children:a.jsxs("p",{children:["Set targets on your personal bests to start earning badges. Go to ",a.jsx("strong",{children:"My Progress"}),' and tap "Set Target" on any PB.']})}):Object.entries(U).map(([$,ge])=>{if(ge.length===0)return null;const Le=KV[$];return a.jsxs("div",{className:"ach-group",children:[a.jsxs("div",{className:"ach-group-header",style:{borderLeftColor:Le.color},children:[a.jsx("span",{className:"ach-group-label",style:{color:Le.color},children:Le.label}),a.jsx("span",{className:"ach-group-count",children:ge.length})]}),a.jsx("div",{className:"ach-badge-grid",children:ge.map((Qe,ne)=>a.jsxs("div",{className:"ach-badge-card",style:{animationDelay:`${ne*.06}s`,"--group-color":Le.color},children:[a.jsx("div",{className:"ach-badge-hex",style:{borderColor:Le.color,boxShadow:`0 0 12px ${Le.color}33`},children:a.jsx("svg",{className:"ach-badge-hex-icon",viewBox:"0 0 24 24",fill:"none",stroke:Le.color,strokeWidth:"2",strokeLinecap:"round",children:a.jsx("path",{d:Le.icon})})}),a.jsxs("div",{className:"ach-badge-info",children:[a.jsx("span",{className:"ach-badge-exercise",children:Qe.exercise}),a.jsxs("span",{className:"ach-badge-value",style:{color:Le.color},children:[Qe.targetWeight,"kg"]}),Qe.achievedAt&&a.jsx("span",{className:"ach-badge-date",children:(Qe.achievedAt.toDate?Qe.achievedAt.toDate():new Date(Qe.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})})]})]},ne))})]},$)})]})]}),a.jsx(Ti,{active:"home"})]})}const ZV=[{key:"trained",label:"Trained",icon:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2.71 7 4.14 8.43 7.71 4.86 16.29 13.43 12.71 17 14.14 18.43 15.57 17 17 18.43 14.14 21.29l1.43 1.43 1.43-1.43 1.43 1.43 2.14-2.14 1.43 1.43L22 20.57z",color:"#A12F3A"},{key:"protein",label:"Hit Protein",icon:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z",color:"#4caf50"},{key:"steps",label:"10k Steps",icon:"M13.5 5.5c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zM9.8 8.9L7 23h2.1l1.8-8 2.1 2v6h2v-7.5l-2.1-2 .6-3C14.8 12 16.8 13 19 13v-2c-1.9 0-3.5-1-4.3-2.4l-1-1.6c-.4-.6-1-1-1.7-1-.3 0-.5.1-.8.1L6 8.3V13h2V9.6l1.8-.7",color:"#ff9800"},{key:"sleep",label:"8hrs Sleep",icon:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z",color:"#7c3aed"},{key:"water",label:"2L Water",icon:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z",color:"#2196f3"}],eO="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z",tO="#e91e63";function nO(n){const e=new Date(n),t=e.getDay(),s=t===0?-6:1-t;return e.setDate(e.getDate()+s),e.setHours(0,0,0,0),e}function db(n){return n.toISOString().split("T")[0]}function sO(n){return Array.from({length:7},(e,t)=>{const s=new Date(n);return s.setDate(n.getDate()+t),s})}function rO(){const{currentUser:n,isClient:e,clientData:t,loading:s}=Wr(),{isDark:o,toggleTheme:c,accent:u}=Ui(),h=lr(),[m,g]=_.useState({}),[b,x]=_.useState([]),[T,N]=_.useState(!0),[B,P]=_.useState(!1),[M,Y]=_.useState(0),[H,X]=_.useState(null),[fe,je]=_.useState(null),[Te,C]=_.useState(!1),[S,D]=_.useState(!1),[U,V]=_.useState(""),[q,L]=_.useState(null),Ke=_.useRef([]),_t=_.useRef([]),$=_.useCallback((Ce,ee="info")=>{X({message:Ce,type:ee}),setTimeout(()=>X(null),3e3)},[]),ge=new Date,Le=db(ge),Qe=nO(ge),ne=sO(Qe),O=["M","T","W","T","F","S","S"],ie=[...ZV,...b.map(Ce=>({key:`custom_${Ce.id}`,label:Ce.label,icon:eO,color:tO,isCustom:!0,id:Ce.id}))];_.useEffect(()=>{!s&&(!n||!e)&&h("/")},[n,e,s,h]),_.useEffect(()=>{if(!n||!t)return;(async()=>{try{const ee=Kt(ve,"habitLogs"),yt=Dn(ee,hn("clientId","==",t.id)),bt=await Sn(yt),et={};bt.docs.forEach(Ft=>{const ts=Ft.data();et[ts.date]={...ts,_id:Ft.id}}),g(et);const ft=await Pn(Ge(ve,"customHabits",t.id));ft.exists()&&x(ft.data().habits||[]);let rt=0;const tt=new Date(ge);for(;;){const Ft=db(tt),ts=et[Ft];if(ts)if(Object.values(ts.habits||{}).filter(Boolean).length>=3)rt++,tt.setDate(tt.getDate()-1);else break;else if(Ft===Le)tt.setDate(tt.getDate()-1);else break}Y(rt)}catch(ee){console.error("Error loading habit logs:",ee)}finally{N(!1)}})()},[n,t]);const Ie=m[Le]||{habits:{}},Oe=async Ce=>{if(!n||B)return;const ee=Ie.habits?.[Ce]||!1;ee||(Ke.current=[...Array(10)].map((yt,bt)=>{const et=bt/10*2*Math.PI,ft=18+Math.random()*20;return{tx:Math.cos(et)*ft,ty:Math.sin(et)*ft,size:3+Math.random()*4,duration:.4+Math.random()*.3}}),je(Ce),setTimeout(()=>je(null),700)),P(!0);try{const yt=Ie.habits||{},bt={...yt,[Ce]:!yt[Ce]},et=Ie._id||`${t.id}_${Le}`;await zn(Ge(ve,"habitLogs",et),{clientId:t.id,date:Le,habits:bt}),g(rt=>({...rt,[Le]:{clientId:t.id,date:Le,habits:bt,_id:et}})),Object.values(bt).filter(Boolean).length===ie.length&&!ee&&(_t.current=[...Array(50)].map((rt,tt)=>({x:5+Math.random()*90,delay:Math.random()*.6,color:["#4caf50","#ff9800","#2196f3","#e91e63","#ffeb3b","#9c27b0"][tt%6],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.5+Math.random()*1.5,width:4+Math.random()*8,height:4+Math.random()*10})),setTimeout(()=>{C(!0),setTimeout(()=>C(!1),3500)},500))}catch(yt){console.error("Error saving habit:",yt),$("Failed to save. Try again.","error")}finally{P(!1)}},it=async()=>{const Ce=U.trim();if(!Ce||!t)return;const ee=Date.now().toString(36),yt=[...b,{id:ee,label:Ce}];try{await zn(Ge(ve,"customHabits",t.id),{clientId:t.id,habits:yt}),x(yt),V(""),D(!1),$(`Added "${Ce}"`,"success")}catch(bt){console.error("Error adding custom habit:",bt),$("Failed to add habit","error")}},ze=async Ce=>{if(!t)return;const ee=b.filter(yt=>yt.id!==Ce);try{await zn(Ge(ve,"customHabits",t.id),{clientId:t.id,habits:ee}),x(ee),L(null),$("Habit removed","success")}catch(yt){console.error("Error deleting habit:",yt),$("Failed to remove","error")}},vt=ne.map(Ce=>{const ee=db(Ce),yt=m[ee],bt=yt?Object.values(yt.habits||{}).filter(Boolean).length:0;return{date:Ce,dateStr:ee,completed:bt,total:ie.length}}),Nt=vt.reduce((Ce,ee)=>Ce+ee.completed,0),at=vt.reduce((Ce,ee)=>Ce+ee.total,0),Xt=at>0?Math.round(Nt/at*100):0,An=Object.values(Ie.habits||{}).filter(Boolean).length,Pt=ie.length>0?Math.round(An/ie.length*100):0;return a.jsx(Mu,{children:a.jsxs("div",{className:"cbc-page","data-theme":o?"dark":"light","data-accent":u,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>h("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:o?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),s||T?a.jsx("div",{className:"cbc-loading-inline",children:a.jsx("div",{className:"cbc-loading-spinner"})}):a.jsxs("main",{className:"cbc-main",children:[a.jsxs("div",{className:"cbc-ring-section",children:[a.jsxs("div",{className:"cbc-progress-ring",children:[a.jsxs("svg",{viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"cbc-arc-track",cx:"100",cy:"100",r:"80"}),a.jsx("circle",{className:"cbc-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-Pt/100*2*Math.PI*80})]}),a.jsxs("div",{className:"cbc-ring-center",children:[a.jsxs("span",{className:"cbc-ring-pct",children:[Pt,"%"]}),a.jsx("span",{className:"cbc-ring-label",children:"today"})]})]}),a.jsxs("div",{className:"cbc-streak",children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-primary)",strokeWidth:"2",children:a.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),a.jsx("span",{className:"cbc-streak-count",children:M}),a.jsx("span",{className:"cbc-streak-label",children:"day streak"})]})]}),a.jsxs("div",{className:"cbc-section",children:[a.jsx("h2",{className:"cbc-section-title",children:"Today's Habits"}),a.jsxs("div",{className:"cbc-habits",children:[ie.map(Ce=>{const ee=Ie.habits?.[Ce.key]||!1,yt=fe===Ce.key;return a.jsxs("button",{className:`cbc-habit-btn ${ee?"cbc-habit-done":""} ${yt?"cbc-habit-just-checked":""}`,onClick:()=>Oe(Ce.key),disabled:B,style:ee?{"--habit-color":Ce.color}:void 0,children:[a.jsxs("div",{className:"cbc-habit-icon-wrap",style:{"--habit-color":Ce.color},children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:Ce.icon})}),ee&&a.jsx("div",{className:"cbc-habit-done-badge",children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"3",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})})})]}),yt&&a.jsx("div",{className:"cbc-particles",children:Ke.current.map((bt,et)=>a.jsx("span",{className:"cbc-particle",style:{"--tx":`${bt.tx}px`,"--ty":`${bt.ty}px`,"--size":`${bt.size}px`,"--particle-color":Ce.color,animationDuration:`${bt.duration}s`}},et))}),a.jsxs("div",{className:"cbc-habit-text",children:[a.jsx("span",{className:"cbc-habit-label",children:Ce.label}),ee&&a.jsx("span",{className:"cbc-habit-done-tag",children:"Done"})]}),Ce.isCustom&&a.jsx("button",{className:"cbc-habit-delete",onClick:bt=>{bt.stopPropagation(),L(Ce.id)},"aria-label":`Remove ${Ce.label}`,children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},Ce.key)}),a.jsxs("button",{className:"cbc-add-habit-btn",onClick:()=>D(!0),children:[a.jsx("div",{className:"cbc-add-habit-icon",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})}),a.jsx("span",{children:"Add your own habit"})]})]})]}),a.jsxs("div",{className:"cbc-section",children:[a.jsx("h2",{className:"cbc-section-title",children:"This Week"}),a.jsx("div",{className:"cbc-week-grid",children:vt.map((Ce,ee)=>{const yt=Ce.dateStr===Le,bt=Ce.total>0?Ce.completed/Ce.total:0,et=38,ft=2*Math.PI*et,rt=ft-bt*ft;return a.jsxs("div",{className:`cbc-day-ring ${yt?"cbc-day-today":""} ${Ce.completed>0?"cbc-day-active":""}`,children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cbc-day-track",cx:"50",cy:"50",r:et}),a.jsx("circle",{className:"cbc-day-fill",cx:"50",cy:"50",r:et,strokeDasharray:ft,strokeDashoffset:rt})]}),a.jsx("span",{className:"cbc-day-label",children:O[ee]}),a.jsxs("span",{className:"cbc-day-count",children:[Ce.completed,"/",Ce.total]})]},ee)})}),a.jsxs("div",{className:"cbc-week-summary",children:[a.jsx("div",{className:"cbc-week-summary-bar",children:a.jsx("div",{className:"cbc-week-summary-fill",style:{width:`${Xt}%`}})}),a.jsxs("span",{className:"cbc-week-summary-text",children:[Nt," / ",at," habits this week (",Xt,"%)"]})]})]})]}),a.jsx(Ti,{active:"home"}),S&&a.jsx("div",{className:"cbc-modal-overlay",onClick:()=>D(!1),children:a.jsxs("div",{className:"cbc-modal",onClick:Ce=>Ce.stopPropagation(),children:[a.jsx("h3",{className:"cbc-modal-title",children:"Add Habit"}),a.jsx("p",{className:"cbc-modal-desc",children:"Track something personal to your routine."}),a.jsx("input",{className:"cbc-modal-input",type:"text",placeholder:"e.g. Meditate, Stretch, Read...",value:U,onChange:Ce=>V(Ce.target.value),maxLength:30,autoFocus:!0,onKeyDown:Ce=>Ce.key==="Enter"&&it()}),a.jsxs("div",{className:"cbc-modal-actions",children:[a.jsx("button",{className:"cbc-modal-cancel",onClick:()=>{D(!1),V("")},children:"Cancel"}),a.jsx("button",{className:"cbc-modal-save",onClick:it,disabled:!U.trim(),children:"Add"})]})]})}),q&&a.jsx("div",{className:"cbc-modal-overlay",onClick:()=>L(null),children:a.jsxs("div",{className:"cbc-modal",onClick:Ce=>Ce.stopPropagation(),children:[a.jsx("h3",{className:"cbc-modal-title",children:"Remove Habit?"}),a.jsx("p",{className:"cbc-modal-desc",children:"This will remove the habit from your daily tracker. Past logs won't be affected."}),a.jsxs("div",{className:"cbc-modal-actions",children:[a.jsx("button",{className:"cbc-modal-cancel",onClick:()=>L(null),children:"Keep"}),a.jsx("button",{className:"cbc-modal-delete",onClick:()=>ze(q),children:"Remove"})]})]})}),Te&&a.jsxs("div",{className:"cbc-celebration",onClick:()=>C(!1),children:[a.jsx("div",{className:"cbc-confetti-container",children:_t.current.map((Ce,ee)=>a.jsx("span",{className:"cbc-confetti-piece",style:{"--x":`${Ce.x}%`,"--delay":`${Ce.delay}s`,"--color":Ce.color,"--drift":`${Ce.drift}px`,"--spin":`${Ce.spin}deg`,"--duration":`${Ce.duration}s`,width:`${Ce.width}px`,height:`${Ce.height}px`}},ee))}),a.jsxs("div",{className:"cbc-celebration-card",children:[a.jsxs("svg",{className:"cbc-celebration-icon",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-primary)",strokeWidth:"2",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),a.jsx("h2",{className:"cbc-celebration-title",children:"Crushed it!"}),a.jsx("p",{className:"cbc-celebration-sub",children:"All habits complete today"})]})]}),H&&a.jsx("div",{className:`toast-notification ${H.type}`,children:H.message})]})})}function sm(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function zT(n,e){return[n,e].sort().join("_")}function iO(){const{currentUser:n,isClient:e,clientData:t,loading:s}=Wr(),{isDark:o,toggleTheme:c}=Ui(),u=lr(),[h,m]=_.useState("buddies"),[g,b]=_.useState([]),[x,T]=_.useState([]),[N,B]=_.useState([]),[P,M]=_.useState(""),[Y,H]=_.useState([]),[X,fe]=_.useState([]),[je,Te]=_.useState(!0),[C,S]=_.useState(null),[D,U]=_.useState(null),V=_.useCallback((ne,O="info")=>{U({message:ne,type:O}),setTimeout(()=>U(null),3500)},[]);_.useEffect(()=>{!s&&(!n||!e)&&u("/")},[n,e,s,u]);const q=_.useCallback(async()=>{if(t){Te(!0);try{const ne=t.id,ie=(await Sn(Kt(ve,"clients"))).docs.map(at=>({id:at.id,...at.data()}));fe(ie);const Ie=Object.fromEntries(ie.map(at=>[at.id,at])),Oe=await Sn(Dn(Kt(ve,"buddies"),hn("user1","==",ne))),it=await Sn(Dn(Kt(ve,"buddies"),hn("user2","==",ne))),ze=new Set;[...Oe.docs,...it.docs].forEach(at=>{const Xt=at.data(),An=Xt.user1===ne?Xt.user2:Xt.user1;ze.add(An)}),b(Array.from(ze).map(at=>Ie[at]).filter(Boolean));const vt=await Sn(Dn(Kt(ve,"buddyRequests"),hn("toId","==",ne),hn("status","==","pending")));T(vt.docs.map(at=>({reqId:at.id,...at.data(),fromClient:Ie[at.data().fromId]})).filter(at=>at.fromClient));const Nt=await Sn(Dn(Kt(ve,"buddyRequests"),hn("fromId","==",ne),hn("status","==","pending")));B(Nt.docs.map(at=>({reqId:at.id,...at.data(),toClient:Ie[at.data().toId]})).filter(at=>at.toClient))}catch(ne){console.error("Error fetching buddy data:",ne),V("Failed to load buddies","error")}finally{Te(!1)}}},[t,V]);_.useEffect(()=>{q()},[q]),_.useEffect(()=>{if(!P.trim()||!t){H([]);return}const ne=P.toLowerCase(),O=t.id,ie=new Set(g.map(ze=>ze.id)),Ie=new Set(N.map(ze=>ze.toId)),Oe=new Set(x.map(ze=>ze.fromId)),it=X.filter(ze=>ze.id===O||!ze.name||!ze.coreBuddyAccess&&ze.clientType!=="core_buddy"?!1:ze.name.toLowerCase().includes(ne)).map(ze=>({...ze,isBuddy:ie.has(ze.id),isPendingOut:Ie.has(ze.id),isPendingIn:Oe.has(ze.id)})).slice(0,20);H(it)},[P,X,g,N,x,t]);const L=async(ne,O)=>{if(!(!t||ne===t.id))try{await Ia(Kt(ve,"notifications"),{toId:ne,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:O,read:!1,createdAt:vi()})}catch(ie){console.error("Notification error:",ie),ie.code==="permission-denied"&&V("Notifications blocked  check Firestore rules","error")}},Ke=async ne=>{S(ne);try{const O=`${t.id}_${ne}`;await zn(Ge(ve,"buddyRequests",O),{fromId:t.id,toId:ne,status:"pending",createdAt:vi()}),await L(ne,"buddy_request"),V("Buddy request sent!","success"),await q()}catch(O){console.error("Error sending request:",O),V("Failed to send request","error")}finally{S(null)}},_t=async ne=>{S(ne.reqId);try{const O=zT(ne.fromId,t.id);await zn(Ge(ve,"buddies",O),{user1:[ne.fromId,t.id].sort()[0],user2:[ne.fromId,t.id].sort()[1],connectedAt:vi()}),await Rr(Ge(ve,"buddyRequests",ne.reqId)),await L(ne.fromId,"buddy_accept"),V("Buddy added!","success"),await q()}catch(O){console.error("Error accepting request:",O),V("Failed to accept","error")}finally{S(null)}},$=async ne=>{S(ne.reqId);try{await Rr(Ge(ve,"buddyRequests",ne.reqId)),V("Request declined","info"),await q()}catch(O){console.error("Error declining:",O),V("Failed to decline","error")}finally{S(null)}},ge=async ne=>{S(ne.reqId);try{await Rr(Ge(ve,"buddyRequests",ne.reqId)),V("Request cancelled","info"),await q()}catch(O){console.error("Error cancelling:",O),V("Failed to cancel","error")}finally{S(null)}},Le=async ne=>{S(ne);try{const O=zT(t.id,ne);await Rr(Ge(ve,"buddies",O)),V("Buddy removed","info"),await q()}catch(O){console.error("Error removing buddy:",O),V("Failed to remove buddy","error")}finally{S(null)}},Qe=x.length;return s?a.jsx("div",{className:"bdy-loading",children:a.jsx("div",{className:"bdy-spinner"})}):!n||!e||!t?null:a.jsxs("div",{className:"bdy-page","data-theme":o?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>u("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:o?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"bdy-main",children:[a.jsx("h1",{className:"bdy-title",children:"Buddies"}),a.jsxs("button",{className:"bdy-leaderboard-link",onClick:()=>u("/client/leaderboard"),children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C7 4 7 7 7 7"}),a.jsx("path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5C17 4 17 7 17 7"}),a.jsx("rect",{x:"6",y:"9",width:"12",height:"13",rx:"2"}),a.jsx("path",{d:"M12 9v13"}),a.jsx("path",{d:"M2 22h20"})]}),a.jsx("span",{children:"Leaderboard"}),a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"bdy-tabs",children:[a.jsxs("button",{className:`bdy-tab${h==="buddies"?" active":""}`,onClick:()=>m("buddies"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("span",{children:"My Buddies"})]}),a.jsxs("button",{className:`bdy-tab${h==="requests"?" active":""}`,onClick:()=>m("requests"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("line",{x1:"19",y1:"8",x2:"19",y2:"14"}),a.jsx("line",{x1:"22",y1:"11",x2:"16",y2:"11"})]}),a.jsx("span",{children:"Requests"}),Qe>0&&a.jsx("span",{className:"bdy-tab-badge",children:Qe})]}),a.jsxs("button",{className:`bdy-tab${h==="search"?" active":""}`,onClick:()=>m("search"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("span",{children:"Find"})]})]}),je?a.jsx("div",{className:"bdy-content-loading",children:a.jsx("div",{className:"bdy-spinner"})}):a.jsxs(a.Fragment,{children:[h==="buddies"&&a.jsx("div",{className:"bdy-section",children:g.length===0?a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("h3",{children:"No buddies yet"}),a.jsx("p",{children:"Find members and send buddy requests to connect!"}),a.jsx("button",{className:"bdy-empty-btn",onClick:()=>m("search"),children:"Find Buddies"})]}):a.jsx("div",{className:"bdy-list",children:g.map(ne=>a.jsxs("div",{className:"bdy-card",onClick:()=>u(`/client/core-buddy/profile/${ne.id}`),children:[a.jsx("div",{className:"bdy-avatar",children:ne.photoURL?a.jsx("img",{src:ne.photoURL,alt:ne.name}):a.jsx("span",{children:sm(ne.name)})}),a.jsx("div",{className:"bdy-card-info",children:a.jsx("span",{className:"bdy-card-name",children:ne.name})}),a.jsx("button",{className:"bdy-remove-btn",onClick:O=>{O.stopPropagation(),Le(ne.id)},disabled:C===ne.id,"aria-label":"Remove buddy",children:C===ne.id?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},ne.id))})}),h==="requests"&&a.jsxs("div",{className:"bdy-section",children:[x.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"bdy-section-title",children:"Incoming"}),a.jsx("div",{className:"bdy-list",children:x.map(ne=>a.jsxs("div",{className:"bdy-card",children:[a.jsx("div",{className:"bdy-avatar",children:ne.fromClient.photoURL?a.jsx("img",{src:ne.fromClient.photoURL,alt:ne.fromClient.name}):a.jsx("span",{children:sm(ne.fromClient.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:ne.fromClient.name}),a.jsx("span",{className:"bdy-card-sub",children:"wants to be your buddy"})]}),a.jsxs("div",{className:"bdy-action-pair",children:[a.jsx("button",{className:"bdy-accept-btn",onClick:()=>_t(ne),disabled:C===ne.reqId,children:C===ne.reqId?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}),a.jsx("button",{className:"bdy-decline-btn",onClick:()=>$(ne),disabled:C===ne.reqId,children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]},ne.reqId))})]}),N.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"bdy-section-title",children:"Sent"}),a.jsx("div",{className:"bdy-list",children:N.map(ne=>a.jsxs("div",{className:"bdy-card",children:[a.jsx("div",{className:"bdy-avatar",children:ne.toClient?.photoURL?a.jsx("img",{src:ne.toClient.photoURL,alt:ne.toClient.name}):a.jsx("span",{children:sm(ne.toClient?.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:ne.toClient?.name}),a.jsx("span",{className:"bdy-card-sub",children:"pending"})]}),a.jsx("button",{className:"bdy-cancel-btn",onClick:()=>ge(ne),disabled:C===ne.reqId,children:C===ne.reqId?a.jsx("div",{className:"bdy-btn-spinner"}):"Cancel"})]},ne.reqId))})]}),x.length===0&&N.length===0&&a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),a.jsx("h3",{children:"No pending requests"}),a.jsx("p",{children:"All caught up!"})]})]}),h==="search"&&a.jsxs("div",{className:"bdy-section",children:[a.jsxs("div",{className:"bdy-search-bar",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("input",{type:"text",placeholder:"Search by name...",value:P,onChange:ne=>M(ne.target.value),autoFocus:!0}),P&&a.jsx("button",{className:"bdy-search-clear",onClick:()=>M(""),children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),P.trim()&&Y.length===0&&a.jsx("div",{className:"bdy-empty bdy-empty-sm",children:a.jsxs("p",{children:['No members found for "',P,'"']})}),Y.length>0&&a.jsx("div",{className:"bdy-list",children:Y.map(ne=>a.jsxs("div",{className:"bdy-card",onClick:()=>u(`/client/core-buddy/profile/${ne.id}`),children:[a.jsx("div",{className:"bdy-avatar",children:ne.photoURL?a.jsx("img",{src:ne.photoURL,alt:ne.name}):a.jsx("span",{children:sm(ne.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:ne.name}),ne.isBuddy&&a.jsx("span",{className:"bdy-card-badge",children:"Buddy"})]}),ne.isBuddy?a.jsx("span",{className:"bdy-status-icon",children:a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-success)",strokeWidth:"2.5",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}):ne.isPendingOut?a.jsx("span",{className:"bdy-pending-label",children:"Pending"}):ne.isPendingIn?a.jsx("button",{className:"bdy-accept-btn",onClick:O=>{O.stopPropagation();const ie=x.find(Ie=>Ie.fromId===ne.id);ie&&_t(ie)},disabled:!!C,children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}):a.jsx("button",{className:"bdy-add-btn",onClick:O=>{O.stopPropagation(),Ke(ne.id)},disabled:C===ne.id,children:C===ne.id?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]},ne.id))})]})]})]}),a.jsx(Ti,{}),D&&a.jsxs("div",{className:`toast-notification ${D.type}`,children:[a.jsx("span",{className:"toast-icon",children:D.type==="success"?a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M5 13 L9 17 L19 7"})}):D.type==="error"?a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),a.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),a.jsx("span",{className:"toast-message",children:D.message})]})]})}function rm(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function hb(n,e){return[n,e].sort().join("_")}const aO=5;function fb(n){return n.toISOString().split("T")[0]}function oO(n){return n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}T`:`${Math.round(n)}`}const lO={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}};function qT(n){if(!n)return"";const e=n instanceof Date?n:n.toDate?n.toDate():new Date(n),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function cO(){const{userId:n}=MA(),{currentUser:e,isClient:t,clientData:s,loading:o}=Wr(),{isDark:c,toggleTheme:u}=Ui(),h=lr(),[m,g]=_.useState(null),[b,x]=_.useState("none"),[T,N]=_.useState(null),[B,P]=_.useState(!0),[M,Y]=_.useState(!1),[H,X]=_.useState(null),[fe,je]=_.useState([]),[Te,C]=_.useState(!1),[S,D]=_.useState(new Set),[U,V]=_.useState(new Set),[q,L]=_.useState({}),[Ke,_t]=_.useState({}),[$,ge]=_.useState({}),[Le,Qe]=_.useState(!0),[ne,O]=_.useState(0),[ie,Ie]=_.useState(0),[Oe,it]=_.useState(0),[ze,vt]=_.useState(0),[Nt,at]=_.useState([]),[Xt,An]=_.useState([]),[Pt,Ce]=_.useState(null),[ee,yt]=_.useState(null),[bt,et]=_.useState(0),[ft,rt]=_.useState([]),[tt,Ft]=_.useState(!1),[ts,Dt]=_.useState(null),[un,fs]=_.useState([]),Yt=_.useCallback((Z,xe="info")=>{X({message:Z,type:xe}),setTimeout(()=>X(null),3500)},[]);_.useEffect(()=>{!o&&(!e||!t)&&h("/")},[e,t,o,h]),_.useEffect(()=>{s&&n&&s.id===n&&h("/client/core-buddy",{replace:!0})},[s,n,h]),_.useEffect(()=>{if(!s||!n||s.id===n)return;let Z=!1;return(async()=>{P(!0);try{const Lt=(await Sn(Kt(ve,"clients"))).docs.map(Wt=>({id:Wt.id,...Wt.data()})).find(Wt=>Wt.id===n);if(!Lt){Z||P(!1);return}Z||g(Lt);const Ct=s.id,an=hb(Ct,n);if((await Pn(Ge(ve,"buddies",an))).exists())Z||x("buddy");else{const Wt=`${Ct}_${n}`,Ln=await Pn(Ge(ve,"buddyRequests",Wt));if(Ln.exists()&&Ln.data().status==="pending")Z||(x("pending_out"),N(Wt));else{const as=`${n}_${Ct}`,bn=await Pn(Ge(ve,"buddyRequests",as));bn.exists()&&bn.data().status==="pending"?Z||(x("pending_in"),N(as)):Z||x("none")}}}catch(xe){console.error("Error loading profile:",xe)}finally{Z||P(!1)}})(),()=>{Z=!0}},[s,n]),_.useEffect(()=>{if(!n||!m)return;let Z=!1;return(async()=>{Qe(!0);try{const[xe,ct,Lt,Ct]=await Promise.all([Sn(Dn(Kt(ve,"workoutLogs"),hn("clientId","==",n))),Pn(Ge(ve,"coreBuddyAchievements",n)),Pn(Ge(ve,"coreBuddyPBs",n)),Pn(Ge(ve,"clientProgrammes",n))]);if(Z)return;const an=xe.docs.length;O(an),ct.exists()&&Ie(ct.data().totalVolume||0);let Zt=0;const Wt=xe.docs.map(bn=>bn.data().date).filter(Boolean).sort().reverse();if(Wt.length>0){const bn=new Date;let In=new Date(bn);for(let Bn=0;Bn<52;Bn++){const z=new Date(In),_e=z.getDay(),ke=_e===0?6:_e-1;z.setDate(z.getDate()-ke),z.setHours(0,0,0,0);const Ee=new Date(z);Ee.setDate(Ee.getDate()+7);const be=fb(z),lt=fb(Ee);if(Wt.some(ut=>ut>=be&&ut<lt))Zt++;else{if(Bn>0)break;break}In.setDate(In.getDate()-7)}}if(Z||it(Zt),Lt.exists()){const bn=Lt.data().exercises||{},In=Object.entries(bn).sort(([,Bn],[,z])=>(z.weight||0)-(Bn.weight||0)).slice(0,3).map(([Bn,z])=>({name:Bn,weight:z.weight,reps:z.reps}));Z||at(In)}if(Ct.exists()){const bn=Ct.data(),In=lO[bn.templateId];if(In){const Bn=Object.keys(bn.completedSessions||{}).length,z=In.duration*In.daysPerWeek;Z||(yt(bn.templateId.replace(/_/g," ").replace(/\b\w/g,_e=>_e.toUpperCase())),et(z>0?Math.round(Bn/z*100):0))}}const Ln=await Pn(Ge(ve,"achievements",n));if(!Z&&Ln.exists()){const bn=Ln.data().badges||{};An(Object.keys(bn))}let as=0;for(let bn=0;bn<30;bn++){const In=new Date;In.setDate(In.getDate()-bn);const Bn=fb(In);try{const z=await Sn(Dn(Kt(ve,"habitLogs"),hn("clientId","==",n),hn("date","==",Bn)));if(z.empty)break;{const _e=z.docs[0].data().habits||{};if(Object.values(_e).filter(Boolean).length>=aO)as++;else break}}catch{break}}Z||vt(as)}catch(xe){console.error("Error loading buddy stats:",xe)}finally{Z||Qe(!1)}})(),()=>{Z=!0}},[n,m]),_.useEffect(()=>{if(!s)return;const Z=s.id;(async()=>{try{const[xe,ct,Lt]=await Promise.all([Sn(Dn(Kt(ve,"buddies"),hn("user1","==",Z))),Sn(Dn(Kt(ve,"buddies"),hn("user2","==",Z))),Sn(Kt(ve,"clients"))]),Ct=new Set;[...xe.docs,...ct.docs].forEach(Zt=>{const Wt=Zt.data();Ct.add(Wt.user1===Z?Wt.user2:Wt.user1)});const an={};Lt.docs.forEach(Zt=>{an[Zt.id]=Zt.data()}),rt(Array.from(Ct).filter(Zt=>an[Zt]).map(Zt=>({id:Zt,name:an[Zt].name,photoURL:an[Zt].photoURL||null})))}catch(xe){console.error("Error loading buddies for mentions:",xe)}})()},[s]);const Mn=async(Z,xe,ct={})=>{if(!(!s||Z===s.id))try{await Ia(Kt(ve,"notifications"),{toId:Z,fromId:s.id,fromName:s.name||"Someone",fromPhotoURL:s.photoURL||null,type:xe,read:!1,createdAt:vi(),...ct})}catch(Lt){console.error("Notification error:",Lt),Lt.code==="permission-denied"&&Yt("Notifications blocked  check Firestore rules","error")}},dn=async()=>{Y(!0);try{const Z=`${s.id}_${n}`;await zn(Ge(ve,"buddyRequests",Z),{fromId:s.id,toId:n,status:"pending",createdAt:vi()}),await Mn(n,"buddy_request"),x("pending_out"),N(Z),Yt("Buddy request sent!","success")}catch(Z){console.error(Z),Yt("Failed to send request","error")}finally{Y(!1)}},Rn=async()=>{if(T){Y(!0);try{const Z=hb(s.id,n);await zn(Ge(ve,"buddies",Z),{user1:[s.id,n].sort()[0],user2:[s.id,n].sort()[1],connectedAt:vi()}),await Rr(Ge(ve,"buddyRequests",T)),await Mn(n,"buddy_accept"),x("buddy"),Yt("Buddy added!","success")}catch(Z){console.error(Z),Yt("Failed to accept","error")}finally{Y(!1)}}},he=async()=>{if(T){Y(!0);try{await Rr(Ge(ve,"buddyRequests",T)),x("none"),Yt(b==="pending_out"?"Request cancelled":"Request declined","info")}catch(Z){console.error(Z),Yt("Failed","error")}finally{Y(!1)}}},De=async()=>{Y(!0);try{const Z=hb(s.id,n);await Rr(Ge(ve,"buddies",Z)),x("none"),Yt("Buddy removed","info")}catch(Z){console.error(Z),Yt("Failed to remove","error")}finally{Y(!1)}},Be=_.useCallback(async()=>{if(n){C(!0);try{const Z=await Sn(Dn(Kt(ve,"posts"),hn("authorId","==",n),Ym("createdAt","desc"),Xm(30)));if(je(Z.docs.map(xe=>({id:xe.id,...xe.data()}))),s){const xe=await Sn(Dn(Kt(ve,"postLikes"),hn("userId","==",s.id)));D(new Set(xe.docs.map(ct=>ct.data().postId)))}}catch(Z){console.error("Error loading journey:",Z)}finally{C(!1)}}},[n,s]);_.useEffect(()=>{!B&&m&&Be()},[B,m,Be]);const nt=async Z=>{if(window.confirm("Delete this post?"))try{await Rr(Ge(ve,"posts",Z)),je(xe=>xe.filter(ct=>ct.id!==Z)),Yt("Post deleted","info")}catch(xe){console.error("Delete error:",xe),Yt("Failed to delete","error")}},Fe=async Z=>{if(!s)return;const xe=s.id,ct=`${Z}_${xe}`,Lt=S.has(Z),Ct=new Set(S);Lt?Ct.delete(Z):Ct.add(Z),D(Ct),je(an=>an.map(Zt=>Zt.id===Z?{...Zt,likeCount:Math.max(0,(Zt.likeCount||0)+(Lt?-1:1))}:Zt));try{if(Lt)await Rr(Ge(ve,"postLikes",ct)),await Sa(Ge(ve,"posts",Z),{likeCount:Nl(-1)});else{await zn(Ge(ve,"postLikes",ct),{postId:Z,userId:xe,createdAt:vi()}),await Sa(Ge(ve,"posts",Z),{likeCount:Nl(1)});const an=fe.find(Zt=>Zt.id===Z);an&&Mn(an.authorId,"like",{postId:Z})}}catch(an){console.error("Like error:",an),Be()}},Me=async Z=>{try{const xe=await Sn(Dn(Kt(ve,"postComments"),hn("postId","==",Z),Ym("createdAt","asc"),Xm(50)));L(ct=>({...ct,[Z]:xe.docs.map(Lt=>({id:Lt.id,...Lt.data()}))}))}catch(xe){console.error("Error loading comments:",xe)}},qe=Z=>{const xe=new Set(U);xe.has(Z)?xe.delete(Z):(xe.add(Z),q[Z]||Me(Z)),V(xe)},St=(Z,xe)=>{const ct=Z.match(/@(\w*)$/);if(ct){Ft(!0),Dt(xe);const Lt=ft.filter(Ct=>Ct.name&&Ct.name.toLowerCase().includes(ct[1].toLowerCase())).slice(0,5);fs(Lt)}else Ft(!1),fs([])},wt=(Z,xe)=>{const Lt=(Ke[xe]||"").replace(/@\w*$/,`@${Z.name} `);_t(Ct=>({...Ct,[xe]:Lt})),Ft(!1),fs([])},Mt=(Z,xe)=>{_t(ct=>({...ct,[Z]:xe})),St(xe,Z)},Jt=async Z=>{const xe=(Ke[Z]||"").trim();if(!(!xe||!s)){ge(ct=>({...ct,[Z]:!0}));try{await Ia(Kt(ve,"postComments"),{postId:Z,authorId:s.id,authorName:s.name||"Unknown",authorPhotoURL:s.photoURL||null,content:xe,createdAt:vi()}),await Sa(Ge(ve,"posts",Z),{commentCount:Nl(1)});const ct=fe.find(Ct=>Ct.id===Z);ct&&Mn(ct.authorId,"comment",{postId:Z});const Lt=xe.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Lt){const Ct=new Set;Lt.forEach(an=>{const Zt=an.slice(1).trim(),Wt=ft.find(Ln=>Ln.name&&Ln.name.toLowerCase()===Zt.toLowerCase());Wt&&!Ct.has(Wt.id)&&(Ct.add(Wt.id),Mn(Wt.id,"mention",{postId:Z}))})}_t(Ct=>({...Ct,[Z]:""})),je(Ct=>Ct.map(an=>an.id===Z?{...an,commentCount:(an.commentCount||0)+1}:an)),await Me(Z)}catch(ct){console.error("Comment error:",ct),Yt("Failed to comment","error")}finally{ge(ct=>({...ct,[Z]:!1}))}}};return o||B||!s?a.jsx("div",{className:"prf-loading","data-theme":c?"dark":"light",children:a.jsx("div",{className:"prf-spinner"})}):!e||!t?null:m?a.jsx(Mu,{children:a.jsxs("div",{className:"prf-page","data-theme":c?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>h(-1),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:c?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"prf-main",children:[a.jsxs("div",{className:"prf-hero",children:[a.jsx("div",{className:"prf-avatar-lg",children:m.photoURL?a.jsx("img",{src:m.photoURL,alt:m.name}):a.jsx("span",{children:rm(m.name)})}),a.jsx("h1",{className:"prf-name",children:m.name}),a.jsxs("div",{className:"prf-buddy-action",children:[b==="none"&&a.jsx("button",{className:"prf-btn prf-btn-primary",onClick:dn,disabled:M,children:M?a.jsx("div",{className:"prf-btn-spinner"}):a.jsxs(a.Fragment,{children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Buddy"]})}),b==="pending_out"&&a.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:he,disabled:M,children:M?a.jsx("div",{className:"prf-btn-spinner dark"}):"Cancel Request"}),b==="pending_in"&&a.jsxs("div",{className:"prf-btn-pair",children:[a.jsx("button",{className:"prf-btn prf-btn-success",onClick:Rn,disabled:M,children:M?a.jsx("div",{className:"prf-btn-spinner"}):"Accept"}),a.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:he,disabled:M,children:"Decline"})]}),b==="buddy"&&a.jsx("button",{className:"prf-btn prf-btn-danger",onClick:De,disabled:M,children:M?a.jsx("div",{className:"prf-btn-spinner"}):"Remove Buddy"})]})]}),Le?a.jsx("div",{className:"prf-stats-loading",children:a.jsx("div",{className:"prf-spinner"})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"prf-stats",children:[a.jsxs("div",{className:"prf-stat",children:[a.jsx("span",{className:"prf-stat-value",children:ne}),a.jsx("span",{className:"prf-stat-label",children:"Workouts"})]}),a.jsxs("div",{className:"prf-stat",children:[a.jsxs("span",{className:"prf-stat-value",children:[oO(ie),a.jsx("span",{className:"prf-stat-unit",children:ie>=1e3?"":"kg"})]}),a.jsxs("span",{className:"prf-stat-label",children:[ie>=1e6?"Million kg":ie>=1e3?"Tonnes":"Volume"," Lifted"]})]}),a.jsxs("div",{className:"prf-stat",children:[a.jsxs("span",{className:"prf-stat-value",children:[Oe,a.jsx("span",{className:"prf-stat-unit",children:"wk"})]}),a.jsx("span",{className:"prf-stat-label",children:"Streak"})]})]}),(ee||ze>0)&&a.jsxs("div",{className:"prf-info-row",children:[ee&&a.jsxs("div",{className:"prf-info-card info-programme",children:[a.jsx("div",{className:"prf-info-icon",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"}),a.jsx("path",{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"})]})}),a.jsxs("div",{className:"prf-info-text",children:[a.jsx("span",{className:"prf-info-label",children:ee}),a.jsx("div",{className:"prf-info-progress-bar",children:a.jsx("div",{className:"prf-info-progress-fill",style:{width:`${Math.min(bt,100)}%`}})}),a.jsxs("span",{className:"prf-info-sub",children:[bt,"% complete"]})]})]}),ze>0&&a.jsxs("div",{className:"prf-info-card info-habit",children:[a.jsx("div",{className:"prf-info-icon",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]})}),a.jsxs("div",{className:"prf-info-text",children:[a.jsxs("span",{className:"prf-info-value",children:[ze," day",ze!==1?"s":""]}),a.jsx("span",{className:"prf-info-sub",children:"Habit Streak"})]})]})]}),Nt.length>0&&a.jsxs("div",{className:"prf-section",children:[a.jsx("h2",{className:"prf-section-title",children:"Top Lifts"}),a.jsx("div",{className:"prf-pb-list",children:Nt.map((Z,xe)=>a.jsxs("div",{className:"prf-pb-item",children:[a.jsx("div",{className:"prf-pb-rank",children:xe===0?a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:a.jsx("path",{d:"M12 2l2.4 7.4H22l-6 4.4 2.3 7.2L12 16.6 5.7 21l2.3-7.2-6-4.4h7.6z"})}):`#${xe+1}`}),a.jsx("span",{className:"prf-pb-name",children:Z.name}),a.jsxs("span",{className:"prf-pb-weight",children:[Z.weight,a.jsx("span",{className:"prf-pb-unit",children:"kg"})," x",Z.reps]})]},xe))})]}),Xt.length>0&&a.jsxs("div",{className:"prf-section",children:[a.jsxs("h2",{className:"prf-section-title",children:["Badges Earned (",Xt.length,")"]}),a.jsx("div",{className:"prf-badge-row",children:Xt.map(Z=>{const xe=Qd.find(ct=>ct.id===Z);return xe?a.jsx("button",{className:"prf-badge-chip",onClick:()=>Ce(xe),children:a.jsx("img",{src:xe.img,alt:xe.name,className:"prf-badge-chip-img"})},Z):null})})]}),Pt&&a.jsx("div",{className:"prf-badge-overlay",onClick:()=>Ce(null),children:a.jsxs("div",{className:"prf-badge-overlay-content",onClick:Z=>Z.stopPropagation(),children:[a.jsx("img",{src:Pt.img,alt:Pt.name,className:"prf-badge-overlay-img"}),a.jsx("p",{className:"prf-badge-overlay-desc",children:Pt.desc}),a.jsx("button",{className:"prf-badge-overlay-close",onClick:()=>Ce(null),children:"Tap to close"})]})})]}),a.jsxs("div",{className:"prf-section",children:[a.jsx("h2",{className:"prf-section-title",children:`${m.name?.split(" ")[0]}'s Journey`}),Te?a.jsx("div",{className:"journey-loading",children:a.jsx("div",{className:"prf-spinner"})}):fe.length===0?a.jsxs("div",{className:"journey-empty",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("p",{children:"No posts yet"})]}):a.jsx("div",{className:"journey-list",children:fe.map(Z=>a.jsxs("div",{className:"journey-post",children:[a.jsxs("div",{className:"journey-post-header",children:[a.jsx("div",{className:"journey-post-avatar",children:Z.authorPhotoURL?a.jsx("img",{src:Z.authorPhotoURL,alt:""}):a.jsx("span",{children:rm(Z.authorName)})}),a.jsxs("div",{className:"journey-post-meta",children:[a.jsx("span",{className:"journey-post-name",children:Z.authorName}),a.jsx("span",{className:"journey-post-time",children:qT(Z.createdAt)})]}),Z.authorId===s.id&&a.jsx("button",{className:"journey-delete-btn",onClick:()=>nt(Z.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),Z.content&&a.jsx("p",{className:"journey-post-content",children:Z.content}),Z.imageURL&&a.jsx("div",{className:"journey-post-image",children:a.jsx("img",{src:Z.imageURL,alt:"Post",loading:"lazy"})}),a.jsxs("div",{className:"journey-post-actions",children:[a.jsxs("button",{className:`journey-action-btn${S.has(Z.id)?" liked":""}`,onClick:()=>Fe(Z.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:S.has(Z.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:Z.likeCount||0})]}),a.jsxs("button",{className:`journey-action-btn${U.has(Z.id)?" active":""}`,onClick:()=>qe(Z.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:Z.commentCount||0})]})]}),U.has(Z.id)&&a.jsxs("div",{className:"journey-comments",children:[q[Z.id]?.length>0?q[Z.id].map(xe=>a.jsxs("div",{className:"journey-comment",children:[a.jsx("div",{className:"journey-comment-avatar",onClick:()=>h(`/client/core-buddy/profile/${xe.authorId}`),children:xe.authorPhotoURL?a.jsx("img",{src:xe.authorPhotoURL,alt:""}):a.jsx("span",{children:rm(xe.authorName)})}),a.jsxs("div",{className:"journey-comment-body",children:[a.jsxs("div",{className:"journey-comment-bubble",children:[a.jsx("span",{className:"journey-comment-name",children:xe.authorName}),a.jsx("span",{className:"journey-comment-text",children:xe.content})]}),a.jsx("span",{className:"journey-comment-time",children:qT(xe.createdAt)})]})]},xe.id)):a.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),a.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[a.jsx("input",{type:"text",placeholder:"Comment... (@ to mention)",value:Ke[Z.id]||"",onChange:xe=>Mt(Z.id,xe.target.value),onKeyDown:xe=>{xe.key==="Enter"&&Jt(Z.id)},maxLength:300}),tt&&ts===Z.id&&un.length>0&&a.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:un.map(xe=>a.jsxs("button",{className:"mention-option",onClick:()=>wt(xe,Z.id),children:[a.jsx("div",{className:"mention-option-avatar",children:xe.photoURL?a.jsx("img",{src:xe.photoURL,alt:""}):a.jsx("span",{children:rm(xe.name)})}),a.jsx("span",{children:xe.name})]},xe.id))}),a.jsx("button",{onClick:()=>Jt(Z.id),disabled:!(Ke[Z.id]||"").trim()||$[Z.id],children:$[Z.id]?a.jsx("div",{className:"journey-btn-spinner-sm"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),a.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},Z.id))})]})]}),a.jsx(Ti,{}),H&&a.jsxs("div",{className:`toast-notification ${H.type}`,children:[a.jsx("span",{className:"toast-icon",children:H.type==="success"?a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M5 13 L9 17 L19 7"})}):H.type==="error"?a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),a.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),a.jsx("span",{className:"toast-message",children:H.message})]})]})}):a.jsxs("div",{className:"prf-page","data-theme":c?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>h(-1),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions"})]})}),a.jsx("main",{className:"prf-main",children:a.jsx("p",{style:{textAlign:"center",color:"var(--text-tertiary)",padding:"40px 0"},children:"User not found"})}),a.jsx(Ti,{})]})}function uO(){const n=lr(),{clientData:e}=Wr();return e?.buddyEnabled?a.jsxs("div",{className:"buddy-page",children:[a.jsxs("div",{className:"buddy-container",children:[a.jsx("button",{className:"buddy-back",onClick:()=>n("/client/core-buddy"),children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsxs("div",{className:"buddy-header",children:[a.jsx("div",{className:"buddy-avatar",children:a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 2a4 4 0 0 1 4 4v2a4 4 0 0 1-8 0V6a4 4 0 0 1 4-4z"}),a.jsx("path",{d:"M18 14c2 1 3 3 3 5v2H3v-2c0-2 1-4 3-5"}),a.jsx("circle",{cx:"9",cy:"7",r:"0.5",fill:"currentColor"}),a.jsx("circle",{cx:"15",cy:"7",r:"0.5",fill:"currentColor"}),a.jsx("path",{d:"M9.5 10a2.5 2.5 0 0 0 5 0"}),a.jsx("path",{d:"M7 13c1.5 1 3.5 1.5 5 1.5s3.5-.5 5-1.5"})]})}),a.jsx("h1",{children:"Buddy"}),a.jsx("span",{className:"buddy-subtitle",children:"Your AI Training Partner"})]}),a.jsxs("div",{className:"buddy-placeholder",children:[a.jsx("p",{children:"Buddy is getting ready..."}),a.jsx("span",{children:"This is where your AI coach will live. Check-ins, programmes, and chat  all coming soon."})]})]}),a.jsx(Ti,{active:"home"})]}):a.jsxs("div",{className:"buddy-page",children:[a.jsxs("div",{className:"buddy-container",children:[a.jsx("p",{children:"Buddy is not enabled on your account."}),a.jsx("button",{onClick:()=>n("/client/core-buddy"),children:"Back to Dashboard"})]}),a.jsx(Ti,{active:"home"})]})}const Ri=[{key:"pressUps",name:"Press-Ups",category:"Upper Body",unit:"reps"},{key:"squats",name:"Squats",category:"Lower Body",unit:"reps"},{key:"longJump",name:"Standing Long Jump",category:"Power",unit:"distance"},{key:"deadHang",name:"Dead Hang",category:"Upper Body",unit:"time"},{key:"plank",name:"Plank",category:"Core",unit:"time"},{key:"wallSit",name:"Wall Sit",category:"Lower Body",unit:"time"},{key:"chestPress",name:"Chest Press",category:"Upper Body",unit:"weight"}],bl=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function dO(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}function Ii(n){const[e,t]=n.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function hO(n){if(!n&&n!==0)return"-";const e=Math.floor(n/60),t=(n%60).toFixed(2);return e>0?`${e}m ${parseFloat(t).toFixed(0)}s`:`${parseFloat(t).toFixed(2)}s`}function fO(n,e){return!n&&n!==0?"-":!e&&e!==0?`${n}kg`:`${n}kg x ${e}`}function im(n,e){if(!e)return"-";switch(n.unit){case"weight":return fO(e.weight,e.reps);case"time":return hO(e.time);case"reps":return e.reps?`${e.reps} reps`:"-";case"distance":return e.distance?`${e.distance} cm`:"-";default:return"-"}}function Uc(n,e){if(!e)return 0;switch(n.unit){case"weight":return(e.weight||0)*(e.reps||0);case"time":return e.time||0;case"reps":return e.reps||0;case"distance":return e.distance||0;default:return 0}}function mb(n,e){return!e||e===0?null:(n-e)/e*100}function mO({data:n,exerciseKey:e,unit:t}){if(!n||n.length<2)return a.jsx("div",{className:"pb-trend-empty",children:a.jsx("p",{children:"Not enough data for trend line yet"})});const s=n.map(P=>{const M=P.benchmarks?.[e];if(!M)return 0;switch(t){case"weight":return(M.weight||0)*(M.reps||0);case"time":return M.time||0;case"reps":return M.reps||0;case"distance":return M.distance||0;default:return 0}}),o=Math.max(...s),c=Math.min(...s),u=o-c||1,h=300,m=100,g=20,b=h-g*2,x=m-g*2,T=s.map((P,M)=>{const Y=g+M/(s.length-1)*b,H=g+x-(P-c)/u*x;return{x:Y,y:H,value:P}}),N=T.map((P,M)=>`${M===0?"M":"L"} ${P.x} ${P.y}`).join(" "),B=N+` L ${T[T.length-1].x} ${g+x} L ${T[0].x} ${g+x} Z`;return a.jsxs("div",{className:"pb-trend-chart",children:[a.jsxs("svg",{viewBox:`0 0 ${h} ${m}`,preserveAspectRatio:"xMidYMid meet",children:[a.jsx("defs",{children:a.jsxs("linearGradient",{id:"trendGradientJr",x1:"0",y1:"0",x2:"0",y2:"1",children:[a.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),a.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),a.jsx("path",{d:B,fill:"url(#trendGradientJr)"}),a.jsx("path",{d:N,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),T.map((P,M)=>a.jsx("circle",{cx:P.x,cy:P.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},M))]}),a.jsx("div",{className:"pb-trend-labels",children:n.map((P,M)=>a.jsxs("span",{className:"pb-trend-label",children:[P.month.split("-")[1],"/",P.month.split("-")[0].slice(2)]},M))})]})}function pO(){const[n,e]=_.useState("bests"),[t,s]=_.useState([]),[o,c]=_.useState(!0),[u,h]=_.useState(!1),[m,g]=_.useState(0),[b,x]=_.useState(!1),[T,N]=_.useState(!1),[B,P]=_.useState(!1),[M,Y]=_.useState({}),[H,X]=_.useState({}),[fe,je]=_.useState({}),[Te,C]=_.useState({}),[S,D]=_.useState({}),[U,V]=_.useState(!1),[q,L]=_.useState({}),[Ke,_t]=_.useState([]),[$,ge]=_.useState(null),[Le,Qe]=_.useState(null),[ne,O]=_.useState(!1),[ie,Ie]=_.useState(""),[Oe,it]=_.useState(""),ze=_.useRef(null),vt=_.useRef(0),Nt=_.useRef(0),at=_.useRef("right"),Xt=_.useCallback(z=>{g(_e=>{const ke=Math.max(0,Math.min(Ri.length-1,z));return ke===_e?_e:(at.current=ke>_e?"right":"left",ke)})},[]),{currentUser:An,isClient:Pt,clientData:Ce,loading:ee}=Wr(),{isDark:yt}=Ui(),bt=lr(),et=_.useCallback((z,_e="info")=>{Qe({message:z,type:_e}),setTimeout(()=>Qe(null),4e3)},[]);_.useEffect(()=>{!ee&&(!An||!Pt)&&bt("/")},[An,Pt,ee,bt]),_.useEffect(()=>{Ce&&ft()},[Ce]);const ft=async()=>{try{const z=Dn(Kt(ve,"juniorPBs"),hn("clientId","==",Ce.id)),ke=(await Sn(z)).docs.map(ut=>({id:ut.id,...ut.data()}));ke.sort((ut,Tt)=>ut.month.localeCompare(Tt.month)),s(ke);const Ee=Dn(Kt(ve,"juniorPBTargets"),hn("clientId","==",Ce.id)),be=await Sn(Ee);if(!be.empty){const ut=be.docs[0].data();je(ut.targets||{}),C(ut.metricTargets||{}),D(ut.targets||{}),L(ut.metricTargets||{})}const lt=Dn(Kt(ve,"juniorAchievements"),hn("clientId","==",Ce.id)),It=await Sn(lt);It.empty||_t(It.docs[0].data().badges||[])}catch(z){console.error("Error fetching junior personal bests:",z)}c(!1)},rt=dO(),tt=t.find(z=>z.month===rt),Ft=t.filter(z=>z.month<rt),ts=Ft.length>0?Ft[Ft.length-1]:null;_.useEffect(()=>{tt?(Y(tt.benchmarks||{}),X(tt.bodyMetrics||{})):(Y({}),X({}))},[tt?.id]);const Dt=async(z,_e)=>{const ke=[];if(z==="strength"?Ri.forEach(Ee=>{const be=fe[Ee.key];if(!be)return;const lt=_e[Ee.key];if(!lt)return;let It;if(be.targetType==="time"){if(!be.targetValue)return;const ut=be.startValue||0,Tt=lt.time||0,At=be.targetValue-ut;It=At===0?Tt>=be.targetValue?1:0:Math.max(0,(Tt-ut)/At)}else if(be.targetType==="reps"){if(!be.targetReps)return;const ut=be.startReps||0,Tt=lt.reps||0,At=be.targetReps-ut;It=At===0?Tt>=be.targetReps?1:0:Math.max(0,(Tt-ut)/At)}else if(be.targetType==="distance"){if(!be.targetDistance)return;const ut=be.startDistance||0,Tt=lt.distance||0,At=be.targetDistance-ut;It=At===0?Tt>=be.targetDistance?1:0:Math.max(0,(Tt-ut)/At)}else{if(!be.targetWeight&&!be.targetReps)return;const ut=(be.startWeight||0)*(be.startReps||0),Tt=(be.targetWeight||0)*(be.targetReps||0),At=(lt.weight||0)*(lt.reps||0),mn=Tt-ut;It=mn===0?At>=Tt?1:0:Math.max(0,(At-ut)/mn)}if(It>=1){let ut,Tt;be.targetType==="time"?(ut=Ke.some(At=>At.type==="strength"&&At.key===Ee.key&&At.targetValue===be.targetValue),Tt=`${Ee.name} ${be.targetValue}s`):be.targetType==="reps"?(ut=Ke.some(At=>At.type==="strength"&&At.key===Ee.key&&At.targetReps===be.targetReps),Tt=`${Ee.name} ${be.targetReps} reps`):be.targetType==="distance"?(ut=Ke.some(At=>At.type==="strength"&&At.key===Ee.key&&At.targetDistance===be.targetDistance),Tt=`${Ee.name} ${be.targetDistance}cm`):(ut=Ke.some(At=>At.type==="strength"&&At.key===Ee.key&&At.targetWeight===be.targetWeight&&At.targetReps===be.targetReps),Tt=`${Ee.name} ${be.targetWeight}kg  ${be.targetReps}`),ut||ke.push({type:"strength",key:Ee.key,...be.targetType==="time"?{targetType:"time",targetValue:be.targetValue}:be.targetType==="reps"?{targetType:"reps",targetReps:be.targetReps}:be.targetType==="distance"?{targetType:"distance",targetDistance:be.targetDistance}:{targetWeight:be.targetWeight,targetReps:be.targetReps},achievedMonth:rt,label:Tt})}}):bl.forEach(Ee=>{const be=Te[Ee.key];if(!be||!be.targetValue)return;const lt=_e[Ee.key];if(lt==null)return;const It=be.startValue||0,ut=be.targetValue,Tt=ut-It;(Tt===0?lt===ut?1:0:Math.max(0,(lt-It)/Tt))>=1&&(Ke.some(er=>er.type==="metric"&&er.key===Ee.key&&er.targetValue===ut)||ke.push({type:"metric",key:Ee.key,targetValue:ut,achievedMonth:rt,label:`${Ee.name} ${ut}${Ee.suffix}`}))}),ke.length>0){const Ee=[...Ke,...ke];await zn(Ge(ve,"juniorAchievements",Ce.id),{clientId:Ce.id,badges:Ee,updatedAt:pt.now()}),_t(Ee),ge(ke),setTimeout(()=>ge(null),5e3)}},un=(z,_e)=>{if(z==="strength"){const ke=fe[_e];if(!ke)return!1;switch(Ri.find(be=>be.key===_e)?.unit){case"time":return Ke.some(be=>be.type==="strength"&&be.key===_e&&be.targetValue===ke.targetValue);case"reps":return Ke.some(be=>be.type==="strength"&&be.key===_e&&be.targetReps===ke.targetReps);case"distance":return Ke.some(be=>be.type==="strength"&&be.key===_e&&be.targetDistance===ke.targetDistance);default:return!ke.targetWeight&&!ke.targetReps?!1:Ke.some(be=>be.type==="strength"&&be.key===_e&&be.targetWeight===ke.targetWeight&&be.targetReps===ke.targetReps)}}else{const ke=Te[_e];return!ke||!ke.targetValue?!1:Ke.some(Ee=>Ee.type==="metric"&&Ee.key===_e&&Ee.targetValue===ke.targetValue)}},fs=async()=>{h(!0);try{const z=`${Ce.id}_${rt}`,_e=tt||{};await zn(Ge(ve,"juniorPBs",z),{clientId:Ce.id,month:rt,benchmarks:M,bodyMetrics:_e.bodyMetrics||H||{},createdAt:_e.createdAt||pt.now(),updatedAt:pt.now()}),await Dt("strength",M),et("Benchmarks saved!","success"),x(!1),await ft()}catch(z){console.error("Error saving benchmarks:",z),et("Failed to save. Please try again.","error")}h(!1)},Yt=async()=>{h(!0);try{const z=`${Ce.id}_${rt}`,_e=tt||{};await zn(Ge(ve,"juniorPBs",z),{clientId:Ce.id,month:rt,benchmarks:_e.benchmarks||M||{},bodyMetrics:H,createdAt:_e.createdAt||pt.now(),updatedAt:pt.now()}),await Dt("metric",H),et("Body metrics saved!","success"),N(!1),await ft()}catch(z){console.error("Error saving metrics:",z),et("Failed to save. Please try again.","error")}h(!1)},Mn=(z,_e,ke)=>{Y(Ee=>({...Ee,[z]:{...Ee[z],[_e]:ke===""?"":parseFloat(ke)}}))},dn=(z,_e)=>{X(ke=>({...ke,[z]:_e===""?"":parseFloat(_e)}))},Rn=(z,_e,ke)=>{D(Ee=>({...Ee,[z]:{...Ee[z],[_e]:ke===""?"":parseFloat(ke)}}))},he=async()=>{h(!0);try{const z=`targets_${Ce.id}`,_e=tt?.benchmarks||{},ke={};Ri.forEach(Ee=>{const be=_e[Ee.key];switch(Ee.unit){case"time":S[Ee.key]?.targetValue&&(ke[Ee.key]={targetType:"time",targetValue:S[Ee.key].targetValue,startValue:be?.time||0});break;case"reps":S[Ee.key]?.targetReps&&(ke[Ee.key]={targetType:"reps",targetReps:S[Ee.key].targetReps,startReps:be?.reps||0});break;case"distance":S[Ee.key]?.targetDistance&&(ke[Ee.key]={targetType:"distance",targetDistance:S[Ee.key].targetDistance,startDistance:be?.distance||0});break;default:(S[Ee.key]?.targetWeight||S[Ee.key]?.targetReps)&&(ke[Ee.key]={targetWeight:S[Ee.key].targetWeight||0,targetReps:S[Ee.key].targetReps||0,startWeight:be?.weight||0,startReps:be?.reps||0})}}),await zn(Ge(ve,"juniorPBTargets",z),{clientId:Ce.id,targets:ke,metricTargets:Te,updatedAt:pt.now()}),je(ke),D(ke),et("Targets saved!","success"),P(!1)}catch(z){console.error("Error saving targets:",z),et("Failed to save targets.","error")}h(!1)},De=(z,_e)=>{L(ke=>({...ke,[z]:{...ke[z],targetValue:_e===""?"":parseFloat(_e)}}))},Be=async()=>{h(!0);try{const z=`targets_${Ce.id}`,_e={};bl.forEach(ke=>{if(q[ke.key]?.targetValue){const Ee=tt?.bodyMetrics?.[ke.key]||0;_e[ke.key]={targetValue:q[ke.key].targetValue,startValue:Ee}}}),await zn(Ge(ve,"juniorPBTargets",z),{clientId:Ce.id,targets:fe,metricTargets:_e,updatedAt:pt.now()}),C(_e),L(_e),et("Metric targets saved!","success"),V(!1)}catch(z){console.error("Error saving metric targets:",z),et("Failed to save targets.","error")}h(!1)},nt=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){h(!0);try{const z=Ge(ve,"juniorPBTargets",`targets_${Ce.id}`);await Rr(z),je({}),C({}),D({}),L({}),et("All goals have been reset","success")}catch(z){console.error("Error resetting targets:",z),et("Failed to reset goals","error")}h(!1)}},Fe=(z,_e)=>{const ke=fe[z];if(!ke||!_e)return null;if(ke.targetType==="time"){if(!ke.targetValue)return null;const ut=ke.startValue||0,Tt=ke.targetValue,At=_e.time||0,mn=Tt-ut;return mn<=0?At>=Tt?1:0:Math.max(0,Math.min((At-ut)/mn,1))}if(ke.targetType==="reps"){if(!ke.targetReps)return null;const ut=ke.startReps||0,Tt=ke.targetReps,At=_e.reps||0,mn=Tt-ut;return mn<=0?At>=Tt?1:0:Math.max(0,Math.min((At-ut)/mn,1))}if(ke.targetType==="distance"){if(!ke.targetDistance)return null;const ut=ke.startDistance||0,Tt=ke.targetDistance,At=_e.distance||0,mn=Tt-ut;return mn<=0?At>=Tt?1:0:Math.max(0,Math.min((At-ut)/mn,1))}if(!ke.targetWeight&&!ke.targetReps)return null;const Ee=(ke.startWeight||0)*(ke.startReps||0),be=(ke.targetWeight||0)*(ke.targetReps||0),lt=(_e.weight||0)*(_e.reps||0),It=be-Ee;return It<=0?lt>=be?1:0:Math.max(0,Math.min((lt-Ee)/It,1))},Me=z=>{const _e=Te[z];if(!_e||!_e.targetValue)return null;const ke=tt?.bodyMetrics?.[z];if(ke==null)return null;const Ee=_e.startValue||0,be=_e.targetValue,lt=be-Ee;return lt===0?ke===be?1:0:Math.max(0,Math.min((ke-Ee)/lt,1))},qe=z=>{vt.current=z.touches[0].clientX,Nt.current=0},St=z=>{Nt.current=z.touches[0].clientX-vt.current},wt=()=>{Nt.current<-50?Xt(m+1):Nt.current>50&&Xt(m-1),Nt.current=0},Mt=z=>{const _e=tt?.bodyMetrics?.[z],ke=ts?.bodyMetrics?.[z];return _e==null||ke==null?null:parseFloat((_e-ke).toFixed(2))},Jt=t.find(z=>z.month===ie),Z=t.find(z=>z.month===Oe);if(ee||o)return a.jsxs("div",{className:"pb-page",children:[a.jsx("header",{className:"client-header",children:a.jsx("div",{className:"header-content",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),a.jsxs("main",{className:"pb-main",children:[a.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),a.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!An||!Pt||!Ce)return null;const xe=Ri[m],ct=tt?.benchmarks?.[xe.key],Lt=ts?.benchmarks?.[xe.key],Ct=Uc(xe,ct),an=Uc(xe,Lt),Zt=mb(Ct,an),Wt=Fe(xe.key,ct),Ln=Wt!==null,as=Wt!==null&&Wt>=1,bn=Ln?Math.round(Wt*60):Ct>0?15:0,In=fe[xe.key],Bn=z=>z?z.targetType==="time"?`${z.startValue||0}s  ${z.targetValue}s`:z.targetType==="reps"?`${z.startReps||0}  ${z.targetReps} reps`:z.targetType==="distance"?`${z.startDistance||0}  ${z.targetDistance}cm`:`${z.startWeight||0}kg${z.startReps||0}  ${z.targetWeight}kg${z.targetReps}`:null;return a.jsxs("div",{className:"pb-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>bt("/client"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsxs("main",{className:"pb-main page-transition-enter",children:[a.jsxs("div",{className:"pb-intro",children:[a.jsx("h2",{children:"Junior Strength Tests"}),a.jsx("p",{children:"Track your strength test results and body measurements each month."})]}),a.jsxs("div",{className:"pb-tabs",children:[a.jsx("button",{className:`pb-tab ${n==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),a.jsx("button",{className:`pb-tab ${n==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),a.jsx("button",{className:`pb-tab ${n==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),n==="bests"&&a.jsxs("div",{className:"pb-strength-section",children:[!b&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"pb-carousel",ref:ze,onTouchStart:qe,onTouchMove:St,onTouchEnd:wt,children:[a.jsx("div",{className:`pb-ring-container slide-from-${at.current}`,children:a.jsxs("div",{className:"pb-ring",children:[a.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:q0.map((z,_e)=>{const ke=_e<Math.round(bn);return a.jsx("line",{x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,className:`pb-ring-tick ${ke?as?"hit":"filled":"empty"}`,strokeWidth:z.thick?"3":"2"},_e)})}),a.jsxs("div",{className:"pb-ring-center",children:[a.jsx("div",{className:"pb-ring-category",children:xe.category}),a.jsxs("div",{className:"pb-ring-exercise",children:[xe.name,un("strength",xe.key)&&a.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),a.jsx("div",{className:"pb-ring-value",children:ct?im(xe,ct):"-"}),Zt!==null&&a.jsxs("div",{className:`pb-ring-change ${Zt>=0?"positive":"negative"}`,children:[Zt>=0?"+":"",Zt.toFixed(1),"%"]}),Zt===null&&ct&&a.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),In&&a.jsx("div",{className:`pb-ring-target ${as?"hit":""}`,children:as?"Target hit!":Bn(In)}),!In&&a.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},m),a.jsx("div",{className:"pb-carousel-dots",children:Ri.map((z,_e)=>a.jsx("button",{className:`pb-dot ${_e===m?"active":""}`,onClick:()=>Xt(_e)},_e))}),a.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>Xt(m-1),disabled:m===0,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),a.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>Xt(m+1),disabled:m===Ri.length-1,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),a.jsxs("div",{className:"pb-trend-section",children:[a.jsx("h4",{children:"Trend"}),a.jsx(mO,{data:t,exerciseKey:xe.key,unit:xe.unit})]})]}),!b&&!B&&a.jsxs("div",{className:"pb-action-buttons",children:[a.jsx("button",{className:"pb-edit-btn",onClick:()=>x(!0),children:tt?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),a.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>P(!0),children:Object.keys(fe).length>0?"Edit Targets":"Set Targets"}),(Object.keys(fe).length>0||Object.keys(Te).length>0)&&a.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:nt,disabled:u,children:"Reset All Goals"})]}),b&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsxs("h3",{children:["Benchmarks - ",Ii(rt)]}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{x(!1),Y(tt?.benchmarks||{})},children:""})]}),a.jsx("div",{className:"pb-edit-body",children:Ri.map(z=>a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:z.name}),z.unit==="weight"?a.jsxs("div",{className:"pb-edit-row",children:[a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",step:"0.5",value:M[z.key]?.weight??"",onChange:_e=>Mn(z.key,"weight",_e.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",value:M[z.key]?.reps??"",onChange:_e=>Mn(z.key,"reps",_e.target.value),placeholder:"0"})]})]}):z.unit==="reps"?a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Reps (max in 1 min)"}),a.jsx("input",{type:"number",value:M[z.key]?.reps??"",onChange:_e=>Mn(z.key,"reps",_e.target.value),placeholder:"0"})]})}):z.unit==="distance"?a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Distance (cm)"}),a.jsx("input",{type:"number",step:"0.5",value:M[z.key]?.distance??"",onChange:_e=>Mn(z.key,"distance",_e.target.value),placeholder:"0"})]})}):a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Time (seconds)"}),a.jsx("input",{type:"number",step:"0.01",value:M[z.key]?.time??"",onChange:_e=>Mn(z.key,"time",_e.target.value),placeholder:"0"})]})})]},z.key))}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{x(!1),Y(tt?.benchmarks||{})},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:fs,disabled:u,children:u?"Saving...":"Save"})]})]}),B&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsx("h3",{children:"Set Your Targets"}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{P(!1),D(fe)},children:""})]}),a.jsxs("div",{className:"pb-edit-body",children:[a.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),Ri.map(z=>{const _e=tt?.benchmarks?.[z.key];let ke="-";if(_e)switch(z.unit){case"weight":(_e.weight||_e.reps)&&(ke=`${_e.weight||0}kg  ${_e.reps||0}`);break;case"time":_e.time&&(ke=`${_e.time}s`);break;case"reps":_e.reps&&(ke=`${_e.reps} reps`);break;case"distance":_e.distance&&(ke=`${_e.distance} cm`);break}return a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsxs("div",{className:"pb-edit-exercise-header",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:z.name}),a.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",ke]})]}),z.unit==="weight"?a.jsxs("div",{className:"pb-edit-row",children:[a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Target Weight (kg)"}),a.jsx("input",{type:"number",step:"0.5",value:S[z.key]?.targetWeight??"",onChange:Ee=>Rn(z.key,"targetWeight",Ee.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Target Reps"}),a.jsx("input",{type:"number",value:S[z.key]?.targetReps??"",onChange:Ee=>Rn(z.key,"targetReps",Ee.target.value),placeholder:"0"})]})]}):z.unit==="reps"?a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Target Reps (in 1 min)"}),a.jsx("input",{type:"number",value:S[z.key]?.targetReps??"",onChange:Ee=>Rn(z.key,"targetReps",Ee.target.value),placeholder:"0"})]})}):z.unit==="distance"?a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Target Distance (cm)"}),a.jsx("input",{type:"number",step:"0.5",value:S[z.key]?.targetDistance??"",onChange:Ee=>Rn(z.key,"targetDistance",Ee.target.value),placeholder:"0"})]})}):a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Target (seconds)"}),a.jsx("input",{type:"number",step:"1",value:S[z.key]?.targetValue??"",onChange:Ee=>Rn(z.key,"targetValue",Ee.target.value),placeholder:"0"})]})})]},z.key)})]}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{P(!1),D(fe)},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:he,disabled:u,children:u?"Saving...":"Save Targets"})]})]})]}),n==="metrics"&&a.jsxs("div",{className:"pb-metrics-section",children:[!T&&!U&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"pb-metrics-card",children:[a.jsx("h3",{children:"Body Measurements"}),a.jsx("p",{className:"pb-metrics-month",children:Ii(rt)}),a.jsx("div",{className:"pb-metrics-list",children:bl.map(z=>{const _e=tt?.bodyMetrics?.[z.key],ke=Mt(z.key),Ee=Te[z.key],be=Me(z.key),lt=be!==null&&be>=1;return a.jsxs("div",{className:"pb-metric-row",children:[a.jsxs("div",{className:"pb-metric-top",children:[a.jsxs("div",{className:"pb-metric-left",children:[a.jsxs("span",{className:"pb-metric-name",children:[z.name,un("metric",z.key)&&a.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),Ee&&a.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",Ee.targetValue," ",z.suffix]})]}),a.jsxs("div",{className:"pb-metric-values",children:[a.jsx("span",{className:"pb-metric-current",children:_e!=null?`${_e} ${z.suffix}`:"-"}),ke!==null&&a.jsxs("span",{className:`pb-metric-change ${ke>0?"up":ke<0?"down":"same"}`,children:[ke>0?"+":"",ke," ",z.suffix]})]})]}),be!==null&&a.jsxs("div",{className:"pb-metric-progress",children:[a.jsx("div",{className:"pb-metric-bar",children:a.jsx("div",{className:`pb-metric-bar-fill ${lt?"hit":""}`,style:{width:`${Math.round(be*100)}%`}})}),a.jsx("span",{className:`pb-metric-percent ${lt?"hit":""}`,children:lt?"Hit!":`${Math.round(be*100)}%`})]})]},z.key)})})]}),a.jsxs("div",{className:"pb-action-buttons",children:[a.jsx("button",{className:"pb-edit-btn",onClick:()=>N(!0),children:tt?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),a.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>V(!0),children:Object.keys(Te).length>0?"Edit Targets":"Set Targets"}),(Object.keys(fe).length>0||Object.keys(Te).length>0)&&a.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:nt,disabled:u,children:"Reset All Goals"})]})]}),T&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsxs("h3",{children:["Measurements - ",Ii(rt)]}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{N(!1),X(tt?.bodyMetrics||{})},children:""})]}),a.jsx("div",{className:"pb-edit-body",children:bl.map(z=>a.jsx("div",{className:"pb-edit-metric",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsxs("label",{children:[z.name," (",z.suffix,")"]}),a.jsx("input",{type:"number",step:"0.1",value:H[z.key]??"",onChange:_e=>dn(z.key,_e.target.value),placeholder:"0"})]})},z.key))}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{N(!1),X(tt?.bodyMetrics||{})},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:Yt,disabled:u,children:u?"Saving...":"Save"})]})]}),U&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsx("h3",{children:"Body Metric Targets"}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{V(!1),L(Te)},children:""})]}),a.jsxs("div",{className:"pb-edit-body",children:[a.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),bl.map(z=>{const _e=tt?.bodyMetrics?.[z.key];return a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsxs("div",{className:"pb-edit-exercise-header",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:z.name}),a.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",_e!=null?`${_e} ${z.suffix}`:"-"]})]}),a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsxs("label",{children:["Target (",z.suffix,")"]}),a.jsx("input",{type:"number",step:"0.1",value:q[z.key]?.targetValue??"",onChange:ke=>De(z.key,ke.target.value),placeholder:"0"})]})})]},z.key)})]}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{V(!1),L(Te)},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:Be,disabled:u,children:u?"Saving...":"Save Targets"})]})]})]}),n==="history"&&a.jsx("div",{className:"pb-history-section",children:t.length===0?a.jsxs("div",{className:"pb-empty",children:[a.jsx("h4",{children:"No records yet"}),a.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):a.jsxs(a.Fragment,{children:[Ke.length>0&&a.jsxs("div",{className:"pb-achievements-wall",children:[a.jsxs("h4",{className:"pb-achievements-wall-title",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),a.jsx("div",{className:"pb-achievements-list",children:[...Ke].reverse().map((z,_e)=>a.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${_e*.05}s`},children:[a.jsx("div",{className:"pb-achievement-star",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("div",{className:"pb-achievement-info",children:[a.jsx("span",{className:"pb-achievement-label",children:z.label}),a.jsx("span",{className:"pb-achievement-date",children:Ii(z.achievedMonth)})]})]},_e))})]}),a.jsx("div",{className:"pb-history-controls",children:a.jsx("button",{className:`pb-compare-toggle ${ne?"active":""}`,onClick:()=>{O(!ne),!ne&&t.length>=2&&(Ie(t[0].month),it(t[t.length-1].month))},children:ne?"Back to Timeline":"Compare Months"})}),ne?a.jsxs("div",{className:"pb-compare",children:[a.jsxs("div",{className:"pb-compare-selectors",children:[a.jsxs("div",{className:"pb-compare-select",children:[a.jsx("label",{children:"From"}),a.jsx("select",{value:ie,onChange:z=>Ie(z.target.value),children:t.map(z=>a.jsx("option",{value:z.month,children:Ii(z.month)},z.month))})]}),a.jsx("div",{className:"pb-compare-vs",children:"vs"}),a.jsxs("div",{className:"pb-compare-select",children:[a.jsx("label",{children:"To"}),a.jsx("select",{value:Oe,onChange:z=>it(z.target.value),children:t.map(z=>a.jsx("option",{value:z.month,children:Ii(z.month)},z.month))})]})]}),Jt&&Z&&a.jsxs("div",{className:"pb-compare-results",children:[a.jsxs("div",{className:"pb-compare-group",children:[a.jsx("h4",{children:"Strength Tests"}),a.jsxs("div",{className:"pb-compare-table",children:[a.jsxs("div",{className:"pb-compare-header-row",children:[a.jsx("span",{children:"Exercise"}),a.jsx("span",{children:Ii(ie).split(" ")[0]}),a.jsx("span",{children:Ii(Oe).split(" ")[0]}),a.jsx("span",{children:"Change"})]}),Ri.map(z=>{const _e=Jt.benchmarks?.[z.key],ke=Z.benchmarks?.[z.key],Ee=Uc(z,_e),be=Uc(z,ke),lt=mb(be,Ee);return a.jsxs("div",{className:"pb-compare-row",children:[a.jsx("span",{className:"pb-compare-name",children:z.name}),a.jsx("span",{className:"pb-compare-val",children:_e?im(z,_e):"-"}),a.jsx("span",{className:"pb-compare-val",children:ke?im(z,ke):"-"}),a.jsx("span",{className:`pb-compare-change ${lt!==null?lt>=0?"positive":"negative":""}`,children:lt!==null?`${lt>=0?"+":""}${lt.toFixed(1)}%`:"-"})]},z.key)})]})]}),a.jsxs("div",{className:"pb-compare-group",children:[a.jsx("h4",{children:"Body Measurements"}),a.jsxs("div",{className:"pb-compare-table",children:[a.jsxs("div",{className:"pb-compare-header-row",children:[a.jsx("span",{children:"Measurement"}),a.jsx("span",{children:Ii(ie).split(" ")[0]}),a.jsx("span",{children:Ii(Oe).split(" ")[0]}),a.jsx("span",{children:"Change"})]}),bl.map(z=>{const _e=Jt.bodyMetrics?.[z.key],ke=Z.bodyMetrics?.[z.key],Ee=_e!=null&&ke!=null?parseFloat((ke-_e).toFixed(2)):null;return a.jsxs("div",{className:"pb-compare-row",children:[a.jsx("span",{className:"pb-compare-name",children:z.name}),a.jsx("span",{className:"pb-compare-val",children:_e!=null?`${_e}`:"-"}),a.jsx("span",{className:"pb-compare-val",children:ke!=null?`${ke}`:"-"}),a.jsx("span",{className:`pb-compare-change ${Ee!==null?Ee>0?"positive":Ee<0?"negative":"neutral":""}`,children:Ee!==null?`${Ee>0?"+":""}${Ee} ${z.suffix}`:"-"})]},z.key)})]})]})]})]}):a.jsx("div",{className:"pb-timeline",children:[...t].reverse().map((z,_e)=>{const ke=t.filter(Ee=>Ee.month<z.month).pop();return a.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${_e*.05}s`},children:[a.jsx("div",{className:"pb-timeline-dot"}),a.jsxs("div",{className:"pb-timeline-card",children:[a.jsx("h4",{children:Ii(z.month)}),z.benchmarks&&Object.keys(z.benchmarks).length>0&&a.jsxs("div",{className:"pb-timeline-group",children:[a.jsx("h5",{children:"Strength Tests"}),Ri.map(Ee=>{const be=z.benchmarks[Ee.key];if(!be)return null;const lt=ke?.benchmarks?.[Ee.key],It=Uc(Ee,be),ut=Uc(Ee,lt),Tt=mb(It,ut);return a.jsxs("div",{className:"pb-timeline-row",children:[a.jsx("span",{className:"pb-timeline-label",children:Ee.name}),a.jsxs("div",{className:"pb-timeline-values",children:[a.jsx("span",{className:"pb-timeline-value",children:im(Ee,be)}),Tt!==null&&a.jsxs("span",{className:`pb-timeline-change ${Tt>=0?"positive":"negative"}`,children:[Tt>=0?"+":"",Tt.toFixed(1),"%"]})]})]},Ee.key)})]}),z.bodyMetrics&&Object.keys(z.bodyMetrics).length>0&&a.jsxs("div",{className:"pb-timeline-group",children:[a.jsx("h5",{children:"Body Measurements"}),bl.map(Ee=>{const be=z.bodyMetrics[Ee.key];if(be==null)return null;const lt=ke?.bodyMetrics?.[Ee.key],It=lt!=null?parseFloat((be-lt).toFixed(2)):null;return a.jsxs("div",{className:"pb-timeline-row",children:[a.jsx("span",{className:"pb-timeline-label",children:Ee.name}),a.jsxs("div",{className:"pb-timeline-values",children:[a.jsxs("span",{className:"pb-timeline-value",children:[be," ",Ee.suffix]}),It!==null&&a.jsxs("span",{className:`pb-timeline-change ${It>0?"positive":It<0?"negative":"neutral"}`,children:[It>0?"+":"",It," ",Ee.suffix]})]})]},Ee.key)})]})]})]},z.id)})})]})})]}),$&&a.jsx("div",{className:"pb-celebration-overlay",onClick:()=>ge(null),children:a.jsxs("div",{className:"pb-celebration-card",children:[a.jsx("div",{className:"pb-celebration-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsx("h3",{className:"pb-celebration-title",children:$.length===1?"Target Achieved!":`${$.length} Targets Achieved!`}),a.jsx("div",{className:"pb-celebration-badges",children:$.map((z,_e)=>a.jsx("div",{className:"pb-celebration-badge",children:z.label},_e))}),a.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),Le&&a.jsxs("div",{className:`toast-notification ${Le.type}`,children:[a.jsx("span",{className:"toast-icon",children:Le.type==="success"?a.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),a.jsx("span",{className:"toast-message",children:Le.message}),a.jsx("button",{className:"toast-close",onClick:()=>Qe(null),children:""})]}),a.jsxs("nav",{className:"block-bottom-nav",children:[a.jsxs("button",{className:"block-nav-tab",onClick:()=>bt("/client"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),a.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),a.jsx("span",{children:"Home"})]}),a.jsxs("button",{className:"block-nav-tab",onClick:()=>bt("/client/forms"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),a.jsx("span",{children:"Forms"})]}),a.jsxs("button",{className:"block-nav-tab",onClick:()=>bt("/client/tools"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),a.jsx("span",{children:"Tools"})]}),a.jsxs("button",{className:"block-nav-tab active",children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 20V10"}),a.jsx("path",{d:"M18 20V4"}),a.jsx("path",{d:"M6 20v-4"})]}),a.jsx("span",{children:"PBs"})]}),Ce?.circuitAccess&&a.jsxs("button",{className:"block-nav-tab",onClick:()=>bt("/client/circuit"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 6v6l4 2"})]}),a.jsx("span",{children:"Circuit"})]})]})]})}const Ki=[{key:"chestPress",name:"Chest Press",category:"Upper Body - Push",unit:"weight"},{key:"shoulderPress",name:"Shoulder Press",category:"Upper Body - Push",unit:"weight"},{key:"seatedRow",name:"Seated Row",category:"Upper Body - Pull",unit:"weight"},{key:"latPulldown",name:"Lat Pulldown",category:"Upper Body - Pull",unit:"weight"},{key:"squat",name:"Squat",category:"Lower Body",unit:"weight"},{key:"deadlift",name:"Deadlift",category:"Lower Body",unit:"weight"},{key:"plank",name:"Plank",category:"Core",unit:"time"}],vl=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function gO(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}function Di(n){const[e,t]=n.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function am(n){if(!n&&n!==0)return"-";const e=Math.floor(n/60),t=(n%60).toFixed(2);return e>0?`${e}m ${parseFloat(t).toFixed(0)}s`:`${parseFloat(t).toFixed(2)}s`}function HT(n,e){return!n&&n!==0?"-":!e&&e!==0?`${n}kg`:`${n}kg x ${e}`}function Fc(n,e){return e?n.unit==="time"?e.time||0:(e.weight||0)*(e.reps||0):0}function pb(n,e){return!e||e===0?null:(n-e)/e*100}function yO({data:n,exerciseKey:e,unit:t}){if(!n||n.length<2)return a.jsx("div",{className:"pb-trend-empty",children:a.jsx("p",{children:"Not enough data for trend line yet"})});const s=n.map(P=>{const M=P.benchmarks?.[e];return M?t==="time"?M.time||0:(M.weight||0)*(M.reps||0):0}),o=Math.max(...s),c=Math.min(...s),u=o-c||1,h=300,m=100,g=20,b=h-g*2,x=m-g*2,T=s.map((P,M)=>{const Y=g+M/(s.length-1)*b,H=g+x-(P-c)/u*x;return{x:Y,y:H,value:P}}),N=T.map((P,M)=>`${M===0?"M":"L"} ${P.x} ${P.y}`).join(" "),B=N+` L ${T[T.length-1].x} ${g+x} L ${T[0].x} ${g+x} Z`;return a.jsxs("div",{className:"pb-trend-chart",children:[a.jsxs("svg",{viewBox:`0 0 ${h} ${m}`,preserveAspectRatio:"xMidYMid meet",children:[a.jsx("defs",{children:a.jsxs("linearGradient",{id:"trendGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[a.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),a.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),a.jsx("path",{d:B,fill:"url(#trendGradient)"}),a.jsx("path",{d:N,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),T.map((P,M)=>a.jsx("circle",{cx:P.x,cy:P.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},M))]}),a.jsx("div",{className:"pb-trend-labels",children:n.map((P,M)=>a.jsxs("span",{className:"pb-trend-label",children:[P.month.split("-")[1],"/",P.month.split("-")[0].slice(2)]},M))})]})}function bO(){const[n,e]=_.useState("bests"),[t,s]=_.useState([]),[o,c]=_.useState(!0),[u,h]=_.useState(!1),[m,g]=_.useState(0),[b,x]=_.useState(!1),[T,N]=_.useState(!1),[B,P]=_.useState(!1),[M,Y]=_.useState({}),[H,X]=_.useState({}),[fe,je]=_.useState({}),[Te,C]=_.useState({}),[S,D]=_.useState({}),[U,V]=_.useState(!1),[q,L]=_.useState({}),[Ke,_t]=_.useState([]),[$,ge]=_.useState(null),[Le,Qe]=_.useState(null),[ne,O]=_.useState(!1),[ie,Ie]=_.useState(""),[Oe,it]=_.useState(""),[ze,vt]=_.useState({}),[Nt,at]=_.useState({}),[Xt,An]=_.useState(null),[Pt,Ce]=_.useState(null),[ee,yt]=_.useState(""),bt=_.useRef(null),et=_.useRef(0),ft=_.useRef(0),rt=_.useRef("right"),tt=_.useCallback(W=>{g(me=>{const E=Math.max(0,Math.min(Ki.length-1,W));return E===me?me:(rt.current=E>me?"right":"left",E)})},[]),{currentUser:Ft,isClient:ts,clientData:Dt,loading:un}=Wr(),{isDark:fs}=Ui(),Yt=lr(),[Mn]=jR(),dn=Mn.get("mode")==="corebuddy",Rn=!dn&&(!Dt?.clientType||Dt.clientType==="block"),he=_.useCallback((W,me="info")=>{Qe({message:W,type:me}),setTimeout(()=>Qe(null),4e3)},[]);_.useEffect(()=>{!un&&(!Ft||!ts)&&Yt("/")},[Ft,ts,un,Yt]),_.useEffect(()=>{Dt&&(Rn?De():(async()=>{try{const[me,E,A]=await Promise.all([Pn(Ge(ve,"coreBuddyPBs",Dt.id)),Pn(Ge(ve,"coreBuddyTargets",Dt.id)),Pn(Ge(ve,"coreBuddyAchievements",Dt.id))]);me.exists()&&vt(me.data().exercises||{}),E.exists()&&at(E.data().targets||{}),A.exists()&&An(A.data())}catch(me){console.error("Error loading Core Buddy PBs:",me)}c(!1)})())},[Dt]);const De=async()=>{try{const W=Dn(Kt(ve,"personalBests"),hn("clientId","==",Dt.id)),E=(await Sn(W)).docs.map($e=>({id:$e.id,...$e.data()}));E.sort(($e,He)=>$e.month.localeCompare(He.month)),s(E);const A=Dn(Kt(ve,"personalBestTargets"),hn("clientId","==",Dt.id)),K=await Sn(A);if(!K.empty){const $e=K.docs[0].data();je($e.targets||{}),C($e.metricTargets||{}),D($e.targets||{}),L($e.metricTargets||{})}const oe=Dn(Kt(ve,"achievements"),hn("clientId","==",Dt.id)),Ye=await Sn(oe);Ye.empty||_t(Ye.docs[0].data().badges||[])}catch(W){console.error("Error fetching personal bests:",W)}c(!1)},Be=async()=>{if(!Pt||!ee||!Dt)return;const W=parseFloat(ee),me=ze[Pt];if(!me||W<=me.weight){he("Target must be higher than current PB","error");return}h(!0);try{const E={...Nt,[Pt]:{targetWeight:W,setAt:pt.now(),currentPBWhenSet:me.weight}};await zn(Ge(ve,"coreBuddyTargets",Dt.id),{clientId:Dt.id,targets:E,updatedAt:pt.now()}),at(E),Ce(null),yt(""),he("Target set!","success")}catch(E){console.error("Error saving target:",E),he("Failed to save target","error")}h(!1)},nt=W=>{if(!Xt?.badges)return!1;const me=Nt[W];return me?Xt.badges.some(E=>E.type==="pb_target"&&E.exercise===W&&E.targetWeight===me.targetWeight):!1},Fe=W=>{const me=Nt[W];if(!me)return null;const E=ze[W];if(!E)return 0;const A=me.currentPBWhenSet||0,K=me.targetWeight,oe=K-A;return oe<=0?E.weight>=K?1:0:Math.max(0,Math.min((E.weight-A)/oe,1))},Me=gO(),qe=t.find(W=>W.month===Me),St=t.filter(W=>W.month<Me),wt=St.length>0?St[St.length-1]:null;_.useEffect(()=>{qe?(Y(qe.benchmarks||{}),X(qe.bodyMetrics||{})):(Y({}),X({}))},[qe?.id]);const Mt=async(W,me)=>{const E=[];if(W==="strength"?Ki.forEach(A=>{const K=fe[A.key];if(!K)return;const oe=me[A.key];if(!oe)return;let Ye;if(K.targetType==="time"){if(!K.targetValue)return;const $e=K.startValue||0,He=oe.time||0,Qt=K.targetValue-$e;Ye=Qt===0?He>=K.targetValue?1:0:Math.max(0,(He-$e)/Qt)}else{if(!K.targetWeight&&!K.targetReps)return;const $e=(K.startWeight||0)*(K.startReps||0),He=(K.targetWeight||0)*(K.targetReps||0),Qt=(oe.weight||0)*(oe.reps||0),Ot=He-$e;Ye=Ot===0?Qt>=He?1:0:Math.max(0,(Qt-$e)/Ot)}if(Ye>=1&&!(K.targetType==="time"?Ke.some(He=>He.type==="strength"&&He.key===A.key&&He.targetValue===K.targetValue):Ke.some(He=>He.type==="strength"&&He.key===A.key&&He.targetWeight===K.targetWeight&&He.targetReps===K.targetReps))){const He=K.targetType==="time"?`${A.name} ${K.targetValue}s`:`${A.name} ${K.targetWeight}kg  ${K.targetReps}`;E.push({type:"strength",key:A.key,...K.targetType==="time"?{targetType:"time",targetValue:K.targetValue}:{targetWeight:K.targetWeight,targetReps:K.targetReps},achievedMonth:Me,label:He})}}):vl.forEach(A=>{const K=Te[A.key];if(!K||!K.targetValue)return;const oe=me[A.key];if(oe==null)return;const Ye=K.startValue||0,$e=K.targetValue,He=$e-Ye;(He===0?oe===$e?1:0:Math.max(0,(oe-Ye)/He))>=1&&(Ke.some(Yn=>Yn.type==="metric"&&Yn.key===A.key&&Yn.targetValue===$e)||E.push({type:"metric",key:A.key,targetValue:$e,achievedMonth:Me,label:`${A.name} ${$e}${A.suffix}`}))}),E.length>0){const A=[...Ke,...E];await zn(Ge(ve,"achievements",Dt.id),{clientId:Dt.id,badges:A,updatedAt:pt.now()}),_t(A),ge(E),setTimeout(()=>ge(null),5e3)}},Jt=(W,me)=>{if(W==="strength"){const E=fe[me];return E?E.targetType==="time"?Ke.some(A=>A.type==="strength"&&A.key===me&&A.targetValue===E.targetValue):!E.targetWeight&&!E.targetReps?!1:Ke.some(A=>A.type==="strength"&&A.key===me&&A.targetWeight===E.targetWeight&&A.targetReps===E.targetReps):!1}else{const E=Te[me];return!E||!E.targetValue?!1:Ke.some(A=>A.type==="metric"&&A.key===me&&A.targetValue===E.targetValue)}},Z=async()=>{h(!0);try{const W=`${Dt.id}_${Me}`,me=qe||{};await zn(Ge(ve,"personalBests",W),{clientId:Dt.id,month:Me,benchmarks:M,bodyMetrics:me.bodyMetrics||H||{},createdAt:me.createdAt||pt.now(),updatedAt:pt.now()}),await Mt("strength",M),he("Benchmarks saved!","success"),x(!1),await De()}catch(W){console.error("Error saving benchmarks:",W),he("Failed to save. Please try again.","error")}h(!1)},xe=async()=>{h(!0);try{const W=`${Dt.id}_${Me}`,me=qe||{};await zn(Ge(ve,"personalBests",W),{clientId:Dt.id,month:Me,benchmarks:me.benchmarks||M||{},bodyMetrics:H,createdAt:me.createdAt||pt.now(),updatedAt:pt.now()}),await Mt("metric",H),he("Body metrics saved!","success"),N(!1),await De()}catch(W){console.error("Error saving metrics:",W),he("Failed to save. Please try again.","error")}h(!1)},ct=(W,me,E)=>{Y(A=>({...A,[W]:{...A[W],[me]:E===""?"":parseFloat(E)}}))},Lt=(W,me)=>{X(E=>({...E,[W]:me===""?"":parseFloat(me)}))},Ct=(W,me,E)=>{D(A=>({...A,[W]:{...A[W],[me]:E===""?"":parseFloat(E)}}))},an=async()=>{h(!0);try{const W=`targets_${Dt.id}`,me=qe?.benchmarks||{},E={};Ki.forEach(A=>{const K=me[A.key];A.unit==="time"?S[A.key]?.targetValue&&(E[A.key]={targetType:"time",targetValue:S[A.key].targetValue,startValue:K?.time||0}):(S[A.key]?.targetWeight||S[A.key]?.targetReps)&&(E[A.key]={targetWeight:S[A.key].targetWeight||0,targetReps:S[A.key].targetReps||0,startWeight:K?.weight||0,startReps:K?.reps||0})}),await zn(Ge(ve,"personalBestTargets",W),{clientId:Dt.id,targets:E,metricTargets:Te,updatedAt:pt.now()}),je(E),D(E),he("Targets saved!","success"),P(!1)}catch(W){console.error("Error saving targets:",W),he("Failed to save targets.","error")}h(!1)},Zt=(W,me)=>{L(E=>({...E,[W]:{...E[W],targetValue:me===""?"":parseFloat(me)}}))},Wt=async()=>{h(!0);try{const W=`targets_${Dt.id}`,me={};vl.forEach(E=>{if(q[E.key]?.targetValue){const A=qe?.bodyMetrics?.[E.key]||0;me[E.key]={targetValue:q[E.key].targetValue,startValue:A}}}),await zn(Ge(ve,"personalBestTargets",W),{clientId:Dt.id,targets:fe,metricTargets:me,updatedAt:pt.now()}),C(me),L(me),he("Metric targets saved!","success"),V(!1)}catch(W){console.error("Error saving metric targets:",W),he("Failed to save targets.","error")}h(!1)},Ln=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){h(!0);try{const W=Ge(ve,"personalBestTargets",`targets_${Dt.id}`);await Rr(W),je({}),C({}),D({}),L({}),he("All goals have been reset","success")}catch(W){console.error("Error resetting targets:",W),he("Failed to reset goals","error")}h(!1)}},as=(W,me)=>{const E=fe[W];if(!E||!me)return null;if(E.targetType==="time"){if(!E.targetValue)return null;const $e=E.startValue||0,He=E.targetValue,Qt=me.time||0,Ot=He-$e;return Ot<=0?Qt>=He?1:0:Math.max(0,Math.min((Qt-$e)/Ot,1))}if(!E.targetWeight&&!E.targetReps)return null;const A=(E.startWeight||0)*(E.startReps||0),K=(E.targetWeight||0)*(E.targetReps||0),oe=(me.weight||0)*(me.reps||0),Ye=K-A;return Ye<=0?oe>=K?1:0:Math.max(0,Math.min((oe-A)/Ye,1))},bn=W=>{const me=Te[W];if(!me||!me.targetValue)return null;const E=qe?.bodyMetrics?.[W];if(E==null)return null;const A=me.startValue||0,K=me.targetValue,oe=K-A;return oe===0?E===K?1:0:Math.max(0,Math.min((E-A)/oe,1))},In=W=>{et.current=W.touches[0].clientX,ft.current=0},Bn=W=>{ft.current=W.touches[0].clientX-et.current},z=()=>{ft.current<-50?tt(m+1):ft.current>50&&tt(m-1),ft.current=0},_e=W=>{const me=qe?.bodyMetrics?.[W],E=wt?.bodyMetrics?.[W];return me==null||E==null?null:parseFloat((me-E).toFixed(2))},ke=t.find(W=>W.month===ie),Ee=t.find(W=>W.month===Oe);if(un||o)return a.jsxs("div",{className:"pb-page",children:[a.jsx("header",{className:"client-header",children:a.jsx("div",{className:"header-content",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),a.jsxs("main",{className:"pb-main",children:[a.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),a.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!Ft||!ts||!Dt)return null;if(Rn&&Dt?.isJunior)return a.jsx(pO,{});const be=Ki[m],lt=qe?.benchmarks?.[be.key],It=wt?.benchmarks?.[be.key],ut=Fc(be,lt),Tt=Fc(be,It),At=pb(ut,Tt),mn=as(be.key,lt),er=mn!==null,ks=mn!==null&&mn>=1,Ds=er?Math.round(mn*60):ut>0?15:0,ns=fe[be.key];return a.jsx(Mu,{children:a.jsxs("div",{className:"pb-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>Yt(dn?"/client/core-buddy":"/client"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsxs("main",{className:"pb-main page-transition-enter",children:[a.jsxs("div",{className:"pb-intro",children:[a.jsx("h2",{children:"Personal Bests"}),a.jsx("p",{children:Rn?"Track your strength benchmarks and body measurements each month.":"Your all-time best lifts from programme workouts."})]}),!Rn&&a.jsxs("div",{className:"pb-cb-section",children:[Object.keys(ze).length===0?a.jsxs("div",{className:"pb-empty",children:[a.jsx("div",{className:"pb-cb-empty-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})}),a.jsx("h4",{children:"No personal bests yet"}),a.jsx("p",{children:"Complete weight-based workouts to start tracking your personal bests."})]}):a.jsx("div",{className:"pb-cb-grid",children:Object.entries(ze).sort(([W],[me])=>W.localeCompare(me)).map(([W,me],E)=>{const A=Nt[W],K=Fe(W),oe=K!==null&&K>=1,Ye=nt(W),$e=K!==null?Math.round(K*60):60;return a.jsxs("div",{className:"pb-cb-card",style:{animationDelay:`${E*.05}s`},children:[a.jsxs("div",{className:"pb-cb-card-top",children:[a.jsxs("div",{className:"pb-cb-card-ring",children:[a.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:aV.map((He,Qt)=>{const Ot=Qt<$e;return a.jsx("line",{x1:He.x1,y1:He.y1,x2:He.x2,y2:He.y2,className:`pb-ring-tick ${Ot?oe?"hit":"filled":"empty"}`,strokeWidth:He.thick?"2":"1.5"},Qt)})}),a.jsx("div",{className:"pb-cb-ring-icon",children:Ye?a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"pb-cb-badge-earned",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}):a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})})]}),a.jsxs("div",{className:"pb-cb-card-info",children:[a.jsx("h4",{className:"pb-cb-card-name",children:W}),a.jsxs("div",{className:"pb-cb-card-value",children:[me.weight,"kg  ",me.reps]}),me.achievedAt&&a.jsx("div",{className:"pb-cb-card-date",children:(me.achievedAt.toDate?me.achievedAt.toDate():new Date(me.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),A&&oe&&!Ye&&a.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"}),Ye&&a.jsx("div",{className:"pb-cb-target-info earned",children:"Badge earned!"})]}),a.jsx("div",{className:"pb-cb-card-action",children:a.jsx("button",{className:"pb-cb-target-btn",onClick:()=>{Ce(W),yt("")},children:A?oe&&Ye?a.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 5v14M5 12h14"})}):a.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),a.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("circle",{cx:"12",cy:"12",r:"6"}),a.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]}),A&&!oe&&a.jsxs("div",{className:"pb-cb-card-progress",children:[a.jsxs("div",{className:"pb-cb-progress-labels",children:[a.jsxs("span",{className:"pb-cb-progress-current",children:[me.weight,"kg"]}),a.jsxs("span",{className:"pb-cb-progress-target",children:["Target: ",A.targetWeight,"kg"]})]}),a.jsx("div",{className:"pb-cb-progress-bar",children:a.jsx("div",{className:"pb-cb-progress-bar-fill",style:{width:`${Math.round((K||0)*100)}%`}})}),a.jsxs("div",{className:"pb-cb-progress-pct",children:[Math.round((K||0)*100),"%"]})]}),A&&oe&&a.jsx("div",{className:"pb-cb-card-progress",children:a.jsx("div",{className:"pb-cb-progress-bar",children:a.jsx("div",{className:"pb-cb-progress-bar-fill hit",style:{width:"100%"}})})})]},W)})}),Object.keys(ze).length>0&&a.jsxs("button",{className:"pb-cb-achievements-link",onClick:()=>Yt("/client/core-buddy/achievements"),children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"View Achievements",a.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),Pt&&a.jsx("div",{className:"pb-cb-target-modal-overlay",onClick:()=>Ce(null),children:a.jsxs("div",{className:"pb-cb-target-modal",onClick:W=>W.stopPropagation(),children:[a.jsx("h3",{children:"Set Target"}),a.jsx("p",{className:"pb-cb-target-exercise-name",children:Pt}),a.jsxs("div",{className:"pb-cb-target-current",children:["Current PB: ",a.jsxs("strong",{children:[ze[Pt]?.weight,"kg"]})]}),a.jsxs("div",{className:"pb-cb-target-input-wrap",children:[a.jsx("label",{children:"Your target (kg)"}),a.jsx("input",{type:"number",inputMode:"decimal",step:"0.5",value:ee,onChange:W=>yt(W.target.value),placeholder:String((ze[Pt]?.weight||0)+5),className:"pb-cb-target-input",autoFocus:!0})]}),a.jsxs("div",{className:"pb-cb-target-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>Ce(null),children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:Be,disabled:u,children:u?"Saving...":"Set Target"})]})]})})]}),Rn&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"pb-tabs",children:[a.jsx("button",{className:`pb-tab ${n==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),a.jsx("button",{className:`pb-tab ${n==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),a.jsx("button",{className:`pb-tab ${n==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),n==="bests"&&a.jsxs("div",{className:"pb-strength-section",children:[!b&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"pb-carousel",ref:bt,onTouchStart:In,onTouchMove:Bn,onTouchEnd:z,children:[a.jsx("div",{className:`pb-ring-container slide-from-${rt.current}`,children:a.jsxs("div",{className:"pb-ring",children:[a.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:q0.map((W,me)=>{const E=me<Math.round(Ds);return a.jsx("line",{x1:W.x1,y1:W.y1,x2:W.x2,y2:W.y2,className:`pb-ring-tick ${E?ks?"hit":"filled":"empty"}`,strokeWidth:W.thick?"3":"2"},me)})}),a.jsxs("div",{className:"pb-ring-center",children:[a.jsx("div",{className:"pb-ring-category",children:be.category}),a.jsxs("div",{className:"pb-ring-exercise",children:[be.name,Jt("strength",be.key)&&a.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),a.jsx("div",{className:"pb-ring-value",children:lt?be.unit==="time"?am(lt.time):HT(lt.weight,lt.reps):"-"}),At!==null&&a.jsxs("div",{className:`pb-ring-change ${At>=0?"positive":"negative"}`,children:[At>=0?"+":"",At.toFixed(1),"%"]}),At===null&&lt&&a.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),ns&&a.jsx("div",{className:`pb-ring-target ${ks?"hit":""}`,children:ks?"Target hit!":ns.targetType==="time"?`${ns.startValue||0}s  ${ns.targetValue}s`:`${ns.startWeight||0}kg${ns.startReps||0}  ${ns.targetWeight}kg${ns.targetReps}`}),!ns&&a.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},m),a.jsx("div",{className:"pb-carousel-dots",children:Ki.map((W,me)=>a.jsx("button",{className:`pb-dot ${me===m?"active":""}`,onClick:()=>tt(me)},me))}),a.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>tt(m-1),disabled:m===0,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),a.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>tt(m+1),disabled:m===Ki.length-1,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),a.jsxs("div",{className:"pb-trend-section",children:[a.jsx("h4",{children:"Trend"}),a.jsx(yO,{data:t,exerciseKey:be.key,unit:be.unit})]})]}),!b&&!B&&a.jsxs("div",{className:"pb-action-buttons",children:[a.jsx("button",{className:"pb-edit-btn",onClick:()=>x(!0),children:qe?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),a.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>P(!0),children:Object.keys(fe).length>0?"Edit Targets":"Set Targets"}),(Object.keys(fe).length>0||Object.keys(Te).length>0)&&a.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:Ln,disabled:u,children:"Reset All Goals"})]}),b&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsxs("h3",{children:["Benchmarks - ",Di(Me)]}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{x(!1),Y(qe?.benchmarks||{})},children:""})]}),a.jsx("div",{className:"pb-edit-body",children:Ki.map(W=>a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:W.name}),W.unit==="weight"?a.jsxs("div",{className:"pb-edit-row",children:[a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",step:"0.5",value:M[W.key]?.weight??"",onChange:me=>ct(W.key,"weight",me.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",value:M[W.key]?.reps??"",onChange:me=>ct(W.key,"reps",me.target.value),placeholder:"0"})]})]}):a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Time (seconds)"}),a.jsx("input",{type:"number",step:"0.01",value:M[W.key]?.time??"",onChange:me=>ct(W.key,"time",me.target.value),placeholder:"0"})]})})]},W.key))}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{x(!1),Y(qe?.benchmarks||{})},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:Z,disabled:u,children:u?"Saving...":"Save"})]})]}),B&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsx("h3",{children:"Set Your Targets"}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{P(!1),D(fe)},children:""})]}),a.jsxs("div",{className:"pb-edit-body",children:[a.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),Ki.map(W=>{const me=qe?.benchmarks?.[W.key];let E="-";return me&&(W.unit==="time"&&me.time?E=`${me.time}s`:(me.weight||me.reps)&&(E=`${me.weight||0}kg  ${me.reps||0}`)),a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsxs("div",{className:"pb-edit-exercise-header",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:W.name}),a.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",E]})]}),W.unit==="weight"?a.jsxs("div",{className:"pb-edit-row",children:[a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Target Weight (kg)"}),a.jsx("input",{type:"number",step:"0.5",value:S[W.key]?.targetWeight??"",onChange:A=>Ct(W.key,"targetWeight",A.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Target Reps"}),a.jsx("input",{type:"number",value:S[W.key]?.targetReps??"",onChange:A=>Ct(W.key,"targetReps",A.target.value),placeholder:"0"})]})]}):a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Target (seconds)"}),a.jsx("input",{type:"number",step:"1",value:S[W.key]?.targetValue??"",onChange:A=>Ct(W.key,"targetValue",A.target.value),placeholder:"0"})]})})]},W.key)})]}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{P(!1),D(fe)},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:an,disabled:u,children:u?"Saving...":"Save Targets"})]})]})]}),n==="metrics"&&a.jsxs("div",{className:"pb-metrics-section",children:[!T&&!U&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"pb-metrics-card",children:[a.jsx("h3",{children:"Body Measurements"}),a.jsx("p",{className:"pb-metrics-month",children:Di(Me)}),a.jsx("div",{className:"pb-metrics-list",children:vl.map(W=>{const me=qe?.bodyMetrics?.[W.key],E=_e(W.key),A=Te[W.key],K=bn(W.key),oe=K!==null&&K>=1;return a.jsxs("div",{className:"pb-metric-row",children:[a.jsxs("div",{className:"pb-metric-top",children:[a.jsxs("div",{className:"pb-metric-left",children:[a.jsxs("span",{className:"pb-metric-name",children:[W.name,Jt("metric",W.key)&&a.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),A&&a.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",A.targetValue," ",W.suffix]})]}),a.jsxs("div",{className:"pb-metric-values",children:[a.jsx("span",{className:"pb-metric-current",children:me!=null?`${me} ${W.suffix}`:"-"}),E!==null&&a.jsxs("span",{className:`pb-metric-change ${E>0?"up":E<0?"down":"same"}`,children:[E>0?"+":"",E," ",W.suffix]})]})]}),K!==null&&a.jsxs("div",{className:"pb-metric-progress",children:[a.jsx("div",{className:"pb-metric-bar",children:a.jsx("div",{className:`pb-metric-bar-fill ${oe?"hit":""}`,style:{width:`${Math.round(K*100)}%`}})}),a.jsx("span",{className:`pb-metric-percent ${oe?"hit":""}`,children:oe?"Hit!":`${Math.round(K*100)}%`})]})]},W.key)})})]}),a.jsxs("div",{className:"pb-action-buttons",children:[a.jsx("button",{className:"pb-edit-btn",onClick:()=>N(!0),children:qe?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),a.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>V(!0),children:Object.keys(Te).length>0?"Edit Targets":"Set Targets"}),(Object.keys(fe).length>0||Object.keys(Te).length>0)&&a.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:Ln,disabled:u,children:"Reset All Goals"})]})]}),T&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsxs("h3",{children:["Measurements - ",Di(Me)]}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{N(!1),X(qe?.bodyMetrics||{})},children:""})]}),a.jsx("div",{className:"pb-edit-body",children:vl.map(W=>a.jsx("div",{className:"pb-edit-metric",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsxs("label",{children:[W.name," (",W.suffix,")"]}),a.jsx("input",{type:"number",step:"0.1",value:H[W.key]??"",onChange:me=>Lt(W.key,me.target.value),placeholder:"0"})]})},W.key))}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{N(!1),X(qe?.bodyMetrics||{})},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:xe,disabled:u,children:u?"Saving...":"Save"})]})]}),U&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsx("h3",{children:"Body Metric Targets"}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{V(!1),L(Te)},children:""})]}),a.jsxs("div",{className:"pb-edit-body",children:[a.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),vl.map(W=>{const me=qe?.bodyMetrics?.[W.key];return a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsxs("div",{className:"pb-edit-exercise-header",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:W.name}),a.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",me!=null?`${me} ${W.suffix}`:"-"]})]}),a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsxs("label",{children:["Target (",W.suffix,")"]}),a.jsx("input",{type:"number",step:"0.1",value:q[W.key]?.targetValue??"",onChange:E=>Zt(W.key,E.target.value),placeholder:"0"})]})})]},W.key)})]}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{V(!1),L(Te)},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:Wt,disabled:u,children:u?"Saving...":"Save Targets"})]})]})]}),n==="history"&&a.jsx("div",{className:"pb-history-section",children:t.length===0?a.jsxs("div",{className:"pb-empty",children:[a.jsx("h4",{children:"No records yet"}),a.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):a.jsxs(a.Fragment,{children:[Ke.length>0&&a.jsxs("div",{className:"pb-achievements-wall",children:[a.jsxs("h4",{className:"pb-achievements-wall-title",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),a.jsx("div",{className:"pb-achievements-list",children:[...Ke].reverse().map((W,me)=>a.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${me*.05}s`},children:[a.jsx("div",{className:"pb-achievement-star",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("div",{className:"pb-achievement-info",children:[a.jsx("span",{className:"pb-achievement-label",children:W.label}),a.jsx("span",{className:"pb-achievement-date",children:Di(W.achievedMonth)})]})]},me))})]}),a.jsx("div",{className:"pb-history-controls",children:a.jsx("button",{className:`pb-compare-toggle ${ne?"active":""}`,onClick:()=>{O(!ne),!ne&&t.length>=2&&(Ie(t[0].month),it(t[t.length-1].month))},children:ne?"Back to Timeline":"Compare Months"})}),ne?a.jsxs("div",{className:"pb-compare",children:[a.jsxs("div",{className:"pb-compare-selectors",children:[a.jsxs("div",{className:"pb-compare-select",children:[a.jsx("label",{children:"From"}),a.jsx("select",{value:ie,onChange:W=>Ie(W.target.value),children:t.map(W=>a.jsx("option",{value:W.month,children:Di(W.month)},W.month))})]}),a.jsx("div",{className:"pb-compare-vs",children:"vs"}),a.jsxs("div",{className:"pb-compare-select",children:[a.jsx("label",{children:"To"}),a.jsx("select",{value:Oe,onChange:W=>it(W.target.value),children:t.map(W=>a.jsx("option",{value:W.month,children:Di(W.month)},W.month))})]})]}),ke&&Ee&&a.jsxs("div",{className:"pb-compare-results",children:[a.jsxs("div",{className:"pb-compare-group",children:[a.jsx("h4",{children:"Strength Benchmarks"}),a.jsxs("div",{className:"pb-compare-table",children:[a.jsxs("div",{className:"pb-compare-header-row",children:[a.jsx("span",{children:"Exercise"}),a.jsx("span",{children:Di(ie).split(" ")[0]}),a.jsx("span",{children:Di(Oe).split(" ")[0]}),a.jsx("span",{children:"Change"})]}),Ki.map(W=>{const me=ke.benchmarks?.[W.key],E=Ee.benchmarks?.[W.key],A=Fc(W,me),K=Fc(W,E),oe=pb(K,A);return a.jsxs("div",{className:"pb-compare-row",children:[a.jsx("span",{className:"pb-compare-name",children:W.name}),a.jsx("span",{className:"pb-compare-val",children:me?W.unit==="time"?am(me.time):`${me.weight}x${me.reps}`:"-"}),a.jsx("span",{className:"pb-compare-val",children:E?W.unit==="time"?am(E.time):`${E.weight}x${E.reps}`:"-"}),a.jsx("span",{className:`pb-compare-change ${oe!==null?oe>=0?"positive":"negative":""}`,children:oe!==null?`${oe>=0?"+":""}${oe.toFixed(1)}%`:"-"})]},W.key)})]})]}),a.jsxs("div",{className:"pb-compare-group",children:[a.jsx("h4",{children:"Body Measurements"}),a.jsxs("div",{className:"pb-compare-table",children:[a.jsxs("div",{className:"pb-compare-header-row",children:[a.jsx("span",{children:"Measurement"}),a.jsx("span",{children:Di(ie).split(" ")[0]}),a.jsx("span",{children:Di(Oe).split(" ")[0]}),a.jsx("span",{children:"Change"})]}),vl.map(W=>{const me=ke.bodyMetrics?.[W.key],E=Ee.bodyMetrics?.[W.key],A=me!=null&&E!=null?parseFloat((E-me).toFixed(2)):null;return a.jsxs("div",{className:"pb-compare-row",children:[a.jsx("span",{className:"pb-compare-name",children:W.name}),a.jsx("span",{className:"pb-compare-val",children:me!=null?`${me}`:"-"}),a.jsx("span",{className:"pb-compare-val",children:E!=null?`${E}`:"-"}),a.jsx("span",{className:`pb-compare-change ${A!==null?A>0?"positive":A<0?"negative":"neutral":""}`,children:A!==null?`${A>0?"+":""}${A} ${W.suffix}`:"-"})]},W.key)})]})]})]})]}):a.jsx("div",{className:"pb-timeline",children:[...t].reverse().map((W,me)=>{const E=t.find(A=>A.month<W.month&&t.indexOf(A)===t.indexOf(W)-1)||t.filter(A=>A.month<W.month).pop();return a.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${me*.05}s`},children:[a.jsx("div",{className:"pb-timeline-dot"}),a.jsxs("div",{className:"pb-timeline-card",children:[a.jsx("h4",{children:Di(W.month)}),W.benchmarks&&Object.keys(W.benchmarks).length>0&&a.jsxs("div",{className:"pb-timeline-group",children:[a.jsx("h5",{children:"Strength Benchmarks"}),Ki.map(A=>{const K=W.benchmarks[A.key];if(!K)return null;const oe=E?.benchmarks?.[A.key],Ye=Fc(A,K),$e=Fc(A,oe),He=pb(Ye,$e);return a.jsxs("div",{className:"pb-timeline-row",children:[a.jsx("span",{className:"pb-timeline-label",children:A.name}),a.jsxs("div",{className:"pb-timeline-values",children:[a.jsx("span",{className:"pb-timeline-value",children:A.unit==="time"?am(K.time):HT(K.weight,K.reps)}),He!==null&&a.jsxs("span",{className:`pb-timeline-change ${He>=0?"positive":"negative"}`,children:[He>=0?"+":"",He.toFixed(1),"%"]})]})]},A.key)})]}),W.bodyMetrics&&Object.keys(W.bodyMetrics).length>0&&a.jsxs("div",{className:"pb-timeline-group",children:[a.jsx("h5",{children:"Body Measurements"}),vl.map(A=>{const K=W.bodyMetrics[A.key];if(K==null)return null;const oe=E?.bodyMetrics?.[A.key],Ye=oe!=null?parseFloat((K-oe).toFixed(2)):null;return a.jsxs("div",{className:"pb-timeline-row",children:[a.jsx("span",{className:"pb-timeline-label",children:A.name}),a.jsxs("div",{className:"pb-timeline-values",children:[a.jsxs("span",{className:"pb-timeline-value",children:[K," ",A.suffix]}),Ye!==null&&a.jsxs("span",{className:`pb-timeline-change ${Ye>0?"positive":Ye<0?"negative":"neutral"}`,children:[Ye>0?"+":"",Ye," ",A.suffix]})]})]},A.key)})]})]})]},W.id)})})]})})]})]}),$&&a.jsx("div",{className:"pb-celebration-overlay",onClick:()=>ge(null),children:a.jsxs("div",{className:"pb-celebration-card",children:[a.jsx("div",{className:"pb-celebration-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsx("h3",{className:"pb-celebration-title",children:$.length===1?"Target Achieved!":`${$.length} Targets Achieved!`}),a.jsx("div",{className:"pb-celebration-badges",children:$.map((W,me)=>a.jsx("div",{className:"pb-celebration-badge",children:W.label},me))}),a.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),Le&&a.jsxs("div",{className:`toast-notification ${Le.type}`,children:[a.jsx("span",{className:"toast-icon",children:Le.type==="success"?a.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),a.jsx("span",{className:"toast-message",children:Le.message}),a.jsx("button",{className:"toast-close",onClick:()=>Qe(null),children:""})]}),Rn&&a.jsxs("nav",{className:"block-bottom-nav",children:[a.jsxs("button",{className:"block-nav-tab",onClick:()=>Yt("/client"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),a.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),a.jsx("span",{children:"Home"})]}),a.jsxs("button",{className:"block-nav-tab",onClick:()=>Yt("/client/forms"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),a.jsx("span",{children:"Forms"})]}),a.jsxs("button",{className:"block-nav-tab",onClick:()=>Yt("/client/tools"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),a.jsx("span",{children:"Tools"})]}),a.jsxs("button",{className:"block-nav-tab active",children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 20V10"}),a.jsx("path",{d:"M18 20V4"}),a.jsx("path",{d:"M6 20v-4"})]}),a.jsx("span",{children:"PBs"})]}),Dt?.circuitAccess&&a.jsxs("button",{className:"block-nav-tab",onClick:()=>Yt("/client/circuit"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 6v6l4 2"})]}),a.jsx("span",{children:"Circuit"})]})]}),dn&&a.jsx(Ti,{active:"progress"})]})})}const vO=_.lazy(()=>Dr(()=>import("./Dashboard-CSYunldb.js"),__vite__mapDeps([0,1]))),xO=_.lazy(()=>Dr(()=>import("./AddClient-C7WJf7G-.js"),__vite__mapDeps([2,3]))),_O=_.lazy(()=>Dr(()=>import("./ClientDashboard-Wrp0KdjD.js"),[])),wO=_.lazy(()=>Dr(()=>import("./ClientForms-DxfFB1P1.js"),__vite__mapDeps([4,5]))),TO=_.lazy(()=>Dr(()=>import("./ClientTools-2HXjZQot.js"),__vite__mapDeps([6,7]))),kO=_.lazy(()=>Dr(()=>import("./MacroCalculator-DFlNDg3y.js"),__vite__mapDeps([8,7]))),EO=_.lazy(()=>Dr(()=>import("./ProteinSnacks-D4kxzXNz.js"),__vite__mapDeps([9,7]))),SO=_.lazy(()=>Dr(()=>import("./DailyMotivation-D5_xO2yY.js"),__vite__mapDeps([10,7]))),jO=_.lazy(()=>Dr(()=>import("./CircuitDashboard-cjTMET2Y.js"),__vite__mapDeps([11,12]))),NO=_.lazy(()=>Dr(()=>import("./CircuitBooking-DCGVfQYM.js"),__vite__mapDeps([13,14,12]))),CO=_.lazy(()=>Dr(()=>import("./Leaderboard-Cv2KisP8.js"),__vite__mapDeps([15,16]))),AO=_.lazy(()=>Dr(()=>import("./UpgradePage-Dy70SnrW.js"),__vite__mapDeps([17,18,19]))),RO=_.lazy(()=>Dr(()=>import("./SignUp-BvFPhSIT.js"),[])),IO=_.lazy(()=>Dr(()=>import("./Onboarding-DHxhQOhf.js"),__vite__mapDeps([20,18,21])));function DO({children:n}){const{pathname:e}=Bi();return _.useEffect(()=>{"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")},[]),_.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"})},[e]),n}function PO(){const n=lr();return _.useEffect(()=>{const e=sessionStorage.getItem("redirect");if(e){sessionStorage.removeItem("redirect");const t=e.replace("/login","")||"/";n(t,{replace:!0})}},[n]),null}function MO(){return a.jsx(X5,{children:a.jsx(Y5,{children:a.jsx(tV,{children:a.jsxs(wR,{basename:"/login",children:[a.jsx(PO,{}),a.jsx(DO,{children:a.jsx(_.Suspense,{fallback:null,children:a.jsxs(XA,{children:[a.jsx(rs,{path:"/",element:a.jsx(rV,{})}),a.jsx(rs,{path:"/dashboard",element:a.jsx(vO,{})}),a.jsx(rs,{path:"/add-client",element:a.jsx(xO,{})}),a.jsx(rs,{path:"/client",element:a.jsx(_O,{})}),a.jsx(rs,{path:"/client/forms",element:a.jsx(wO,{})}),a.jsx(rs,{path:"/client/tools",element:a.jsx(TO,{})}),a.jsx(rs,{path:"/client/tools/macros",element:a.jsx(kO,{})}),a.jsx(rs,{path:"/client/tools/snacks",element:a.jsx(EO,{})}),a.jsx(rs,{path:"/client/tools/motivation",element:a.jsx(SO,{})}),a.jsx(rs,{path:"/client/personal-bests",element:a.jsx(bO,{})}),a.jsx(rs,{path:"/client/circuit",element:a.jsx(jO,{})}),a.jsx(rs,{path:"/client/circuit/booking",element:a.jsx(NO,{})}),a.jsx(rs,{path:"/client/core-buddy",element:a.jsx(jV,{})}),a.jsx(rs,{path:"/client/core-buddy/nutrition",element:a.jsx(Oc,{feature:"nutrition",children:a.jsx(AV,{})})}),a.jsx(rs,{path:"/client/core-buddy/workouts",element:a.jsx(FV,{})}),a.jsx(rs,{path:"/client/core-buddy/programmes",element:a.jsx(Oc,{feature:"programmes",children:a.jsx(WV,{})})}),a.jsx(rs,{path:"/client/core-buddy/achievements",element:a.jsx(Oc,{feature:"achievements",children:a.jsx(JV,{})})}),a.jsx(rs,{path:"/client/core-buddy/consistency",element:a.jsx(Oc,{feature:"consistency",children:a.jsx(rO,{})})}),a.jsx(rs,{path:"/client/core-buddy/buddies",element:a.jsx(Oc,{feature:"buddies",children:a.jsx(iO,{})})}),a.jsx(rs,{path:"/client/core-buddy/buddy",element:a.jsx(uO,{})}),a.jsx(rs,{path:"/client/core-buddy/profile/:userId",element:a.jsx(cO,{})}),a.jsx(rs,{path:"/client/leaderboard",element:a.jsx(Oc,{feature:"leaderboard",children:a.jsx(CO,{})})}),a.jsx(rs,{path:"/signup",element:a.jsx(RO,{})}),a.jsx(rs,{path:"/onboarding",element:a.jsx(IO,{})}),a.jsx(rs,{path:"/upgrade",element:a.jsx(AO,{})}),a.jsx(rs,{path:"*",element:a.jsx(QA,{to:"/",replace:!0})})]})})})]})})})})}YC.createRoot(document.getElementById("root")).render(a.jsx(_.StrictMode,{children:a.jsx(MO,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/login/sw.js").catch(()=>{})});export{ai as $,Ym as A,Fj as B,Ti as C,dh as D,hL as E,ri as F,$O as G,ia as H,es as I,ii as J,Du as K,Xl as L,is as M,Re as N,aa as O,iL as P,NL as Q,or as R,Pu as S,pt as T,Ih as U,Tm as V,Ap as W,Dh as X,Np as Y,C0 as Z,Dr as _,lr as a,DB as a$,Cp as a0,Ro as a1,jL as a2,xi as a3,EL as a4,Sv as a5,As as a6,Vl as a7,Je as a8,BO as a9,GO as aA,KO as aB,XO as aC,LB as aD,fB as aE,hB as aF,Ts as aG,Ph as aH,pL as aI,bB as aJ,NB as aK,CB as aL,AB as aM,RB as aN,aL as aO,MB as aP,Nl as aQ,WO as aR,Xm as aS,cB as aT,wT as aU,vB as aV,_B as aW,xB as aX,oL as aY,Jm as aZ,IB as a_,NP as aa,bs as ab,BB as ac,yn as ad,OO as ae,aB as af,iB as ag,FO as ah,wi as ai,OP as aj,gB as ak,yB as al,lB as am,sB as an,nB as ao,pB as ap,QO as aq,qO as ar,rL as as,mL as at,OB as au,tB as av,JO as aw,VB as ax,eB as ay,kB as az,ve as b,oB as b0,wB as b1,TB as b2,wL as b3,Rj as b4,EB as b5,HO as b6,jB as b7,PB as b8,VO as b9,SB as ba,dB as bb,uB as bc,mB as bd,ZO as be,rB as bf,YO as bg,jT as bh,Sa as c,Ge as d,Ui as e,Kt as f,Pn as g,Sn as h,q0 as i,a as j,nV as k,sV as l,LO as m,dD as n,UB as o,gD as p,Dn as q,_ as r,zn as s,Ia as t,Wr as u,Rr as v,hn as w,Dp as x,jR as y,vi as z};
