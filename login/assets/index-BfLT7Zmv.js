const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-DOdjz6TP.js","assets/Dashboard-BMt294uM.css","assets/AddClient-C7nRFkhm.js","assets/AddClient-DH1OFzHo.css","assets/ClientForms-BQFgoRcW.js","assets/ClientForms-GDNtnrAx.css","assets/ClientTools-qYOEtZaz.js","assets/ClientTools-DQRPoST3.css","assets/MacroCalculator-B9aBhxRf.js","assets/ProteinSnacks-DCVAhvUM.js","assets/DailyMotivation-BOSlxzOx.js","assets/CircuitDashboard-Dm1KIeyC.js","assets/CircuitDashboard-Cf3zLXQy.css","assets/CircuitBooking-DA1lB3py.js","assets/CircuitBooking-ruk9Q4Wj.css","assets/Leaderboard-C-LxIf3m.js","assets/Leaderboard-Dq-r5svP.css","assets/UpgradePage-CL6S0PGp.js","assets/stripe-7qEIN5w7.js","assets/UpgradePage-Blt11CID.css","assets/Onboarding-bqFhbj4b.js","assets/Onboarding-Bku4iVdQ.css"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function t(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(l){if(l.ep)return;l.ep=!0;const u=t(l);fetch(l.href,u)}})();var mp={exports:{}},Gc={};var g1;function uT(){if(g1)return Gc;g1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,l,u){var d=null;if(u!==void 0&&(d=""+u),l.key!==void 0&&(d=""+l.key),"key"in l){u={};for(var p in l)p!=="key"&&(u[p]=l[p])}else u=l;return l=u.ref,{$$typeof:n,type:i,key:d,ref:l!==void 0?l:null,props:u}}return Gc.Fragment=e,Gc.jsx=t,Gc.jsxs=t,Gc}var y1;function dT(){return y1||(y1=1,mp.exports=uT()),mp.exports}var a=dT(),pp={exports:{}},Yt={};var b1;function hT(){if(b1)return Yt;b1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),d=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),j=Symbol.iterator;function O(P){return P===null||typeof P!="object"?null:(P=j&&P[j]||P["@@iterator"],typeof P=="function"?P:null)}var q={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},B=Object.assign,V={};function ne(P,se,Se){this.props=P,this.context=se,this.refs=V,this.updater=Se||q}ne.prototype.isReactComponent={},ne.prototype.setState=function(P,se){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,se,"setState")},ne.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function K(){}K.prototype=ne.prototype;function le(P,se,Se){this.props=P,this.context=se,this.refs=V,this.updater=Se||q}var ge=le.prototype=new K;ge.constructor=le,B(ge,ne.prototype),ge.isPureReactComponent=!0;var Ie=Array.isArray;function Te(){}var R={H:null,A:null,T:null,S:null},T=Object.prototype.hasOwnProperty;function A(P,se,Se){var Oe=Se.ref;return{$$typeof:n,type:P,key:se,ref:Oe!==void 0?Oe:null,props:Se}}function L(P,se){return A(P.type,se,P.props)}function D(P){return typeof P=="object"&&P!==null&&P.$$typeof===n}function F(P){var se={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(Se){return se[Se]})}var M=/\/+/g;function $e(P,se){return typeof P=="object"&&P!==null&&P.key!=null?F(""+P.key):se.toString(36)}function bt(P){switch(P.status){case"fulfilled":return P.value;case"rejected":throw P.reason;default:switch(typeof P.status=="string"?P.then(Te,Te):(P.status="pending",P.then(function(se){P.status==="pending"&&(P.status="fulfilled",P.value=se)},function(se){P.status==="pending"&&(P.status="rejected",P.reason=se)})),P.status){case"fulfilled":return P.value;case"rejected":throw P.reason}}throw P}function H(P,se,Se,Oe,st){var Ue=typeof P;(Ue==="undefined"||Ue==="boolean")&&(P=null);var gt=!1;if(P===null)gt=!0;else switch(Ue){case"bigint":case"string":case"number":gt=!0;break;case"object":switch(P.$$typeof){case n:case e:gt=!0;break;case w:return gt=P._init,H(gt(P._payload),se,Se,Oe,st)}}if(gt)return st=st(P),gt=Oe===""?"."+$e(P,0):Oe,Ie(st)?(Se="",gt!=null&&(Se=gt.replace(M,"$&/")+"/"),H(st,se,Se,"",function(Wt){return Wt})):st!=null&&(D(st)&&(st=L(st,Se+(st.key==null||P&&P.key===st.key?"":(""+st.key).replace(M,"$&/")+"/")+gt)),se.push(st)),1;gt=0;var Tt=Oe===""?".":Oe+":";if(Ie(P))for(var rt=0;rt<P.length;rt++)Oe=P[rt],Ue=Tt+$e(Oe,rt),gt+=H(Oe,se,Se,Ue,st);else if(rt=O(P),typeof rt=="function")for(P=rt.call(P),rt=0;!(Oe=P.next()).done;)Oe=Oe.value,Ue=Tt+$e(Oe,rt++),gt+=H(Oe,se,Se,Ue,st);else if(Ue==="object"){if(typeof P.then=="function")return H(bt(P),se,Se,Oe,st);throw se=String(P),Error("Objects are not valid as a React child (found: "+(se==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":se)+"). If you meant to render a collection of children, use an array instead.")}return gt}function fe(P,se,Se){if(P==null)return P;var Oe=[],st=0;return H(P,Oe,"","",function(Ue){return se.call(Se,Ue,st++)}),Oe}function Me(P){if(P._status===-1){var se=P._result;se=se(),se.then(function(Se){(P._status===0||P._status===-1)&&(P._status=1,P._result=Se)},function(Se){(P._status===0||P._status===-1)&&(P._status=2,P._result=Se)}),P._status===-1&&(P._status=0,P._result=se)}if(P._status===1)return P._result.default;throw P._result}var Ke=typeof reportError=="function"?reportError:function(P){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var se=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof P=="object"&&P!==null&&typeof P.message=="string"?String(P.message):String(P),error:P});if(!window.dispatchEvent(se))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",P);return}console.error(P)},ee={map:fe,forEach:function(P,se,Se){fe(P,function(){se.apply(this,arguments)},Se)},count:function(P){var se=0;return fe(P,function(){se++}),se},toArray:function(P){return fe(P,function(se){return se})||[]},only:function(P){if(!D(P))throw Error("React.Children.only expected to receive a single React element child.");return P}};return Yt.Activity=k,Yt.Children=ee,Yt.Component=ne,Yt.Fragment=t,Yt.Profiler=l,Yt.PureComponent=le,Yt.StrictMode=i,Yt.Suspense=g,Yt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,Yt.__COMPILER_RUNTIME={__proto__:null,c:function(P){return R.H.useMemoCache(P)}},Yt.cache=function(P){return function(){return P.apply(null,arguments)}},Yt.cacheSignal=function(){return null},Yt.cloneElement=function(P,se,Se){if(P==null)throw Error("The argument must be a React element, but you passed "+P+".");var Oe=B({},P.props),st=P.key;if(se!=null)for(Ue in se.key!==void 0&&(st=""+se.key),se)!T.call(se,Ue)||Ue==="key"||Ue==="__self"||Ue==="__source"||Ue==="ref"&&se.ref===void 0||(Oe[Ue]=se[Ue]);var Ue=arguments.length-2;if(Ue===1)Oe.children=Se;else if(1<Ue){for(var gt=Array(Ue),Tt=0;Tt<Ue;Tt++)gt[Tt]=arguments[Tt+2];Oe.children=gt}return A(P.type,st,Oe)},Yt.createContext=function(P){return P={$$typeof:d,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null},P.Provider=P,P.Consumer={$$typeof:u,_context:P},P},Yt.createElement=function(P,se,Se){var Oe,st={},Ue=null;if(se!=null)for(Oe in se.key!==void 0&&(Ue=""+se.key),se)T.call(se,Oe)&&Oe!=="key"&&Oe!=="__self"&&Oe!=="__source"&&(st[Oe]=se[Oe]);var gt=arguments.length-2;if(gt===1)st.children=Se;else if(1<gt){for(var Tt=Array(gt),rt=0;rt<gt;rt++)Tt[rt]=arguments[rt+2];st.children=Tt}if(P&&P.defaultProps)for(Oe in gt=P.defaultProps,gt)st[Oe]===void 0&&(st[Oe]=gt[Oe]);return A(P,Ue,st)},Yt.createRef=function(){return{current:null}},Yt.forwardRef=function(P){return{$$typeof:p,render:P}},Yt.isValidElement=D,Yt.lazy=function(P){return{$$typeof:w,_payload:{_status:-1,_result:P},_init:Me}},Yt.memo=function(P,se){return{$$typeof:y,type:P,compare:se===void 0?null:se}},Yt.startTransition=function(P){var se=R.T,Se={};R.T=Se;try{var Oe=P(),st=R.S;st!==null&&st(Se,Oe),typeof Oe=="object"&&Oe!==null&&typeof Oe.then=="function"&&Oe.then(Te,Ke)}catch(Ue){Ke(Ue)}finally{se!==null&&Se.types!==null&&(se.types=Se.types),R.T=se}},Yt.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},Yt.use=function(P){return R.H.use(P)},Yt.useActionState=function(P,se,Se){return R.H.useActionState(P,se,Se)},Yt.useCallback=function(P,se){return R.H.useCallback(P,se)},Yt.useContext=function(P){return R.H.useContext(P)},Yt.useDebugValue=function(){},Yt.useDeferredValue=function(P,se){return R.H.useDeferredValue(P,se)},Yt.useEffect=function(P,se){return R.H.useEffect(P,se)},Yt.useEffectEvent=function(P){return R.H.useEffectEvent(P)},Yt.useId=function(){return R.H.useId()},Yt.useImperativeHandle=function(P,se,Se){return R.H.useImperativeHandle(P,se,Se)},Yt.useInsertionEffect=function(P,se){return R.H.useInsertionEffect(P,se)},Yt.useLayoutEffect=function(P,se){return R.H.useLayoutEffect(P,se)},Yt.useMemo=function(P,se){return R.H.useMemo(P,se)},Yt.useOptimistic=function(P,se){return R.H.useOptimistic(P,se)},Yt.useReducer=function(P,se,Se){return R.H.useReducer(P,se,Se)},Yt.useRef=function(P){return R.H.useRef(P)},Yt.useState=function(P){return R.H.useState(P)},Yt.useSyncExternalStore=function(P,se,Se){return R.H.useSyncExternalStore(P,se,Se)},Yt.useTransition=function(){return R.H.useTransition()},Yt.version="19.2.4",Yt}var v1;function Rg(){return v1||(v1=1,pp.exports=hT()),pp.exports}var v=Rg(),gp={exports:{}},Kc={},yp={exports:{}},bp={};var x1;function fT(){return x1||(x1=1,(function(n){function e(H,fe){var Me=H.length;H.push(fe);e:for(;0<Me;){var Ke=Me-1>>>1,ee=H[Ke];if(0<l(ee,fe))H[Ke]=fe,H[Me]=ee,Me=Ke;else break e}}function t(H){return H.length===0?null:H[0]}function i(H){if(H.length===0)return null;var fe=H[0],Me=H.pop();if(Me!==fe){H[0]=Me;e:for(var Ke=0,ee=H.length,P=ee>>>1;Ke<P;){var se=2*(Ke+1)-1,Se=H[se],Oe=se+1,st=H[Oe];if(0>l(Se,Me))Oe<ee&&0>l(st,Se)?(H[Ke]=st,H[Oe]=Me,Ke=Oe):(H[Ke]=Se,H[se]=Me,Ke=se);else if(Oe<ee&&0>l(st,Me))H[Ke]=st,H[Oe]=Me,Ke=Oe;else break e}}return fe}function l(H,fe){var Me=H.sortIndex-fe.sortIndex;return Me!==0?Me:H.id-fe.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;n.unstable_now=function(){return u.now()}}else{var d=Date,p=d.now();n.unstable_now=function(){return d.now()-p}}var g=[],y=[],w=1,k=null,j=3,O=!1,q=!1,B=!1,V=!1,ne=typeof setTimeout=="function"?setTimeout:null,K=typeof clearTimeout=="function"?clearTimeout:null,le=typeof setImmediate<"u"?setImmediate:null;function ge(H){for(var fe=t(y);fe!==null;){if(fe.callback===null)i(y);else if(fe.startTime<=H)i(y),fe.sortIndex=fe.expirationTime,e(g,fe);else break;fe=t(y)}}function Ie(H){if(B=!1,ge(H),!q)if(t(g)!==null)q=!0,Te||(Te=!0,F());else{var fe=t(y);fe!==null&&bt(Ie,fe.startTime-H)}}var Te=!1,R=-1,T=5,A=-1;function L(){return V?!0:!(n.unstable_now()-A<T)}function D(){if(V=!1,Te){var H=n.unstable_now();A=H;var fe=!0;try{e:{q=!1,B&&(B=!1,K(R),R=-1),O=!0;var Me=j;try{t:{for(ge(H),k=t(g);k!==null&&!(k.expirationTime>H&&L());){var Ke=k.callback;if(typeof Ke=="function"){k.callback=null,j=k.priorityLevel;var ee=Ke(k.expirationTime<=H);if(H=n.unstable_now(),typeof ee=="function"){k.callback=ee,ge(H),fe=!0;break t}k===t(g)&&i(g),ge(H)}else i(g);k=t(g)}if(k!==null)fe=!0;else{var P=t(y);P!==null&&bt(Ie,P.startTime-H),fe=!1}}break e}finally{k=null,j=Me,O=!1}fe=void 0}}finally{fe?F():Te=!1}}}var F;if(typeof le=="function")F=function(){le(D)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,$e=M.port2;M.port1.onmessage=D,F=function(){$e.postMessage(null)}}else F=function(){ne(D,0)};function bt(H,fe){R=ne(function(){H(n.unstable_now())},fe)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(H){H.callback=null},n.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<H?Math.floor(1e3/H):5},n.unstable_getCurrentPriorityLevel=function(){return j},n.unstable_next=function(H){switch(j){case 1:case 2:case 3:var fe=3;break;default:fe=j}var Me=j;j=fe;try{return H()}finally{j=Me}},n.unstable_requestPaint=function(){V=!0},n.unstable_runWithPriority=function(H,fe){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var Me=j;j=H;try{return fe()}finally{j=Me}},n.unstable_scheduleCallback=function(H,fe,Me){var Ke=n.unstable_now();switch(typeof Me=="object"&&Me!==null?(Me=Me.delay,Me=typeof Me=="number"&&0<Me?Ke+Me:Ke):Me=Ke,H){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=Me+ee,H={id:w++,callback:fe,priorityLevel:H,startTime:Me,expirationTime:ee,sortIndex:-1},Me>Ke?(H.sortIndex=Me,e(y,H),t(g)===null&&H===t(y)&&(B?(K(R),R=-1):B=!0,bt(Ie,Me-Ke))):(H.sortIndex=ee,e(g,H),q||O||(q=!0,Te||(Te=!0,F()))),H},n.unstable_shouldYield=L,n.unstable_wrapCallback=function(H){var fe=j;return function(){var Me=j;j=fe;try{return H.apply(this,arguments)}finally{j=Me}}}})(bp)),bp}var w1;function mT(){return w1||(w1=1,yp.exports=fT()),yp.exports}var vp={exports:{}},or={};var _1;function pT(){if(_1)return or;_1=1;var n=Rg();function e(g){var y="https://react.dev/errors/"+g;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var w=2;w<arguments.length;w++)y+="&args[]="+encodeURIComponent(arguments[w])}return"Minified React error #"+g+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},l=Symbol.for("react.portal");function u(g,y,w){var k=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:k==null?null:""+k,children:g,containerInfo:y,implementation:w}}var d=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(g,y){if(g==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return or.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,or.createPortal=function(g,y){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(e(299));return u(g,y,null,w)},or.flushSync=function(g){var y=d.T,w=i.p;try{if(d.T=null,i.p=2,g)return g()}finally{d.T=y,i.p=w,i.d.f()}},or.preconnect=function(g,y){typeof g=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,i.d.C(g,y))},or.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},or.preinit=function(g,y){if(typeof g=="string"&&y&&typeof y.as=="string"){var w=y.as,k=p(w,y.crossOrigin),j=typeof y.integrity=="string"?y.integrity:void 0,O=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;w==="style"?i.d.S(g,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:k,integrity:j,fetchPriority:O}):w==="script"&&i.d.X(g,{crossOrigin:k,integrity:j,fetchPriority:O,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},or.preinitModule=function(g,y){if(typeof g=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var w=p(y.as,y.crossOrigin);i.d.M(g,{crossOrigin:w,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&i.d.M(g)},or.preload=function(g,y){if(typeof g=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var w=y.as,k=p(w,y.crossOrigin);i.d.L(g,w,{crossOrigin:k,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},or.preloadModule=function(g,y){if(typeof g=="string")if(y){var w=p(y.as,y.crossOrigin);i.d.m(g,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:w,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else i.d.m(g)},or.requestFormReset=function(g){i.d.r(g)},or.unstable_batchedUpdates=function(g,y){return g(y)},or.useFormState=function(g,y,w){return d.H.useFormState(g,y,w)},or.useFormStatus=function(){return d.H.useHostTransitionStatus()},or.version="19.2.4",or}var k1;function gT(){if(k1)return vp.exports;k1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),vp.exports=pT(),vp.exports}var j1;function yT(){if(j1)return Kc;j1=1;var n=mT(),e=Rg(),t=gT();function i(s){var r="https://react.dev/errors/"+s;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)r+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+s+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function u(s){var r=s,o=s;if(s.alternate)for(;r.return;)r=r.return;else{s=r;do r=s,(r.flags&4098)!==0&&(o=r.return),s=r.return;while(s)}return r.tag===3?o:null}function d(s){if(s.tag===13){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function p(s){if(s.tag===31){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function g(s){if(u(s)!==s)throw Error(i(188))}function y(s){var r=s.alternate;if(!r){if(r=u(s),r===null)throw Error(i(188));return r!==s?null:s}for(var o=s,c=r;;){var f=o.return;if(f===null)break;var m=f.alternate;if(m===null){if(c=f.return,c!==null){o=c;continue}break}if(f.child===m.child){for(m=f.child;m;){if(m===o)return g(f),s;if(m===c)return g(f),r;m=m.sibling}throw Error(i(188))}if(o.return!==c.return)o=f,c=m;else{for(var x=!1,N=f.child;N;){if(N===o){x=!0,o=f,c=m;break}if(N===c){x=!0,c=f,o=m;break}N=N.sibling}if(!x){for(N=m.child;N;){if(N===o){x=!0,o=m,c=f;break}if(N===c){x=!0,c=m,o=f;break}N=N.sibling}if(!x)throw Error(i(189))}}if(o.alternate!==c)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?s:r}function w(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s;for(s=s.child;s!==null;){if(r=w(s),r!==null)return r;s=s.sibling}return null}var k=Object.assign,j=Symbol.for("react.element"),O=Symbol.for("react.transitional.element"),q=Symbol.for("react.portal"),B=Symbol.for("react.fragment"),V=Symbol.for("react.strict_mode"),ne=Symbol.for("react.profiler"),K=Symbol.for("react.consumer"),le=Symbol.for("react.context"),ge=Symbol.for("react.forward_ref"),Ie=Symbol.for("react.suspense"),Te=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),A=Symbol.for("react.activity"),L=Symbol.for("react.memo_cache_sentinel"),D=Symbol.iterator;function F(s){return s===null||typeof s!="object"?null:(s=D&&s[D]||s["@@iterator"],typeof s=="function"?s:null)}var M=Symbol.for("react.client.reference");function $e(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===M?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case B:return"Fragment";case ne:return"Profiler";case V:return"StrictMode";case Ie:return"Suspense";case Te:return"SuspenseList";case A:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case q:return"Portal";case le:return s.displayName||"Context";case K:return(s._context.displayName||"Context")+".Consumer";case ge:var r=s.render;return s=s.displayName,s||(s=r.displayName||r.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case R:return r=s.displayName||null,r!==null?r:$e(s.type)||"Memo";case T:r=s._payload,s=s._init;try{return $e(s(r))}catch{}}return null}var bt=Array.isArray,H=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,fe=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Me={pending:!1,data:null,method:null,action:null},Ke=[],ee=-1;function P(s){return{current:s}}function se(s){0>ee||(s.current=Ke[ee],Ke[ee]=null,ee--)}function Se(s,r){ee++,Ke[ee]=s.current,s.current=r}var Oe=P(null),st=P(null),Ue=P(null),gt=P(null);function Tt(s,r){switch(Se(Ue,r),Se(st,s),Se(Oe,null),r.nodeType){case 9:case 11:s=(s=r.documentElement)&&(s=s.namespaceURI)?B0(s):0;break;default:if(s=r.tagName,r=r.namespaceURI)r=B0(r),s=U0(r,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}se(Oe),Se(Oe,s)}function rt(){se(Oe),se(st),se(Ue)}function Wt(s){s.memoizedState!==null&&Se(gt,s);var r=Oe.current,o=U0(r,s.type);r!==o&&(Se(st,s),Se(Oe,o))}function js(s){st.current===s&&(se(Oe),se(st)),gt.current===s&&(se(gt),Hc._currentValue=Me)}var At,Ee;function Z(s){if(At===void 0)try{throw Error()}catch(o){var r=o.stack.trim().match(/\n( *(at )?)/);At=r&&r[1]||"",Ee=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+At+s+Ee}var mt=!1;function pt(s,r){if(!s||mt)return"";mt=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(r){var Ce=function(){throw Error()};if(Object.defineProperty(Ce.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ce,[])}catch(me){var ce=me}Reflect.construct(s,[],Ce)}else{try{Ce.call()}catch(me){ce=me}s.call(Ce.prototype)}}else{try{throw Error()}catch(me){ce=me}(Ce=s())&&typeof Ce.catch=="function"&&Ce.catch(function(){})}}catch(me){if(me&&ce&&typeof me.stack=="string")return[me.stack,ce.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=c.DetermineComponentFrameRoot(),x=m[0],N=m[1];if(x&&N){var U=x.split(`
`),oe=N.split(`
`);for(f=c=0;c<U.length&&!U[c].includes("DetermineComponentFrameRoot");)c++;for(;f<oe.length&&!oe[f].includes("DetermineComponentFrameRoot");)f++;if(c===U.length||f===oe.length)for(c=U.length-1,f=oe.length-1;1<=c&&0<=f&&U[c]!==oe[f];)f--;for(;1<=c&&0<=f;c--,f--)if(U[c]!==oe[f]){if(c!==1||f!==1)do if(c--,f--,0>f||U[c]!==oe[f]){var ke=`
`+U[c].replace(" at new "," at ");return s.displayName&&ke.includes("<anonymous>")&&(ke=ke.replace("<anonymous>",s.displayName)),ke}while(1<=c&&0<=f);break}}}finally{mt=!1,Error.prepareStackTrace=o}return(o=s?s.displayName||s.name:"")?Z(o):""}function Je(s,r){switch(s.tag){case 26:case 27:case 5:return Z(s.type);case 16:return Z("Lazy");case 13:return s.child!==r&&r!==null?Z("Suspense Fallback"):Z("Suspense");case 19:return Z("SuspenseList");case 0:case 15:return pt(s.type,!1);case 11:return pt(s.type.render,!1);case 1:return pt(s.type,!0);case 31:return Z("Activity");default:return""}}function ut(s){try{var r="",o=null;do r+=Je(s,o),o=s,s=s.return;while(s);return r}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var tt=Object.prototype.hasOwnProperty,Ze=n.unstable_scheduleCallback,Pt=n.unstable_cancelCallback,Ks=n.unstable_shouldYield,Ct=n.unstable_requestPaint,as=n.unstable_now,on=n.unstable_getCurrentPriorityLevel,qt=n.unstable_ImmediatePriority,Cs=n.unstable_UserBlockingPriority,ns=n.unstable_NormalPriority,_s=n.unstable_LowPriority,he=n.unstable_IdlePriority,Re=n.log,ze=n.unstable_setDisableYieldValue,Ye=null,Ve=null;function Le(s){if(typeof Re=="function"&&ze(s),Ve&&typeof Ve.setStrictMode=="function")try{Ve.setStrictMode(Ye,s)}catch{}}var De=Math.clz32?Math.clz32:Ut,wt=Math.log,ft=Math.LN2;function Ut(s){return s>>>=0,s===0?32:31-(wt(s)/ft|0)|0}var Gt=256,Q=262144,ve=4194304;function at(s){var r=s&42;if(r!==0)return r;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function It(s,r,o){var c=s.pendingLanes;if(c===0)return 0;var f=0,m=s.suspendedLanes,x=s.pingedLanes;s=s.warmLanes;var N=c&134217727;return N!==0?(c=N&~m,c!==0?f=at(c):(x&=N,x!==0?f=at(x):o||(o=N&~s,o!==0&&(f=at(o))))):(N=c&~m,N!==0?f=at(N):x!==0?f=at(x):o||(o=c&~s,o!==0&&(f=at(o)))),f===0?0:r!==0&&r!==f&&(r&m)===0&&(m=f&-f,o=r&-r,m>=o||m===32&&(o&4194048)!==0)?r:f}function St(s,r){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&r)===0}function ts(s,r){switch(s){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Xt(){var s=ve;return ve<<=1,(ve&62914560)===0&&(ve=4194304),s}function zt(s){for(var r=[],o=0;31>o;o++)r.push(s);return r}function Rs(s,r){s.pendingLanes|=r,r!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function tn(s,r,o,c,f,m){var x=s.pendingLanes;s.pendingLanes=o,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=o,s.entangledLanes&=o,s.errorRecoveryDisabledLanes&=o,s.shellSuspendCounter=0;var N=s.entanglements,U=s.expirationTimes,oe=s.hiddenUpdates;for(o=x&~o;0<o;){var ke=31-De(o),Ce=1<<ke;N[ke]=0,U[ke]=-1;var ce=oe[ke];if(ce!==null)for(oe[ke]=null,ke=0;ke<ce.length;ke++){var me=ce[ke];me!==null&&(me.lane&=-536870913)}o&=~Ce}c!==0&&rs(s,c,0),m!==0&&f===0&&s.tag!==0&&(s.suspendedLanes|=m&~(x&~r))}function rs(s,r,o){s.pendingLanes|=r,s.suspendedLanes&=~r;var c=31-De(r);s.entangledLanes|=r,s.entanglements[c]=s.entanglements[c]|1073741824|o&261930}function Ts(s,r){var o=s.entangledLanes|=r;for(s=s.entanglements;o;){var c=31-De(o),f=1<<c;f&r|s[c]&r&&(s[c]|=r),o&=~f}}function As(s,r){var o=r&-r;return o=(o&42)!==0?1:z(o),(o&(s.suspendedLanes|r))!==0?0:o}function z(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function ye(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function we(){var s=fe.p;return s!==0?s:(s=window.event,s===void 0?32:c1(s.type))}function _e(s,r){var o=fe.p;try{return fe.p=s,r()}finally{fe.p=o}}var be=Math.random().toString(36).slice(2),it="__reactFiber$"+be,Rt="__reactProps$"+be,ct="__reactContainer$"+be,_t="__reactEvents$"+be,kt="__reactListeners$"+be,us="__reactHandles$"+be,Cn="__reactResources$"+be,hn="__reactMarker$"+be;function fn(s){delete s[it],delete s[Rt],delete s[_t],delete s[kt],delete s[us]}function Es(s){var r=s[it];if(r)return r;for(var o=s.parentNode;o;){if(r=o[ct]||o[it]){if(o=r.alternate,r.child!==null||o!==null&&o.child!==null)for(s=G0(s);s!==null;){if(o=s[it])return o;s=G0(s)}return r}s=o,o=s.parentNode}return null}function $(s){if(s=s[it]||s[ct]){var r=s.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return s}return null}function ue(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s.stateNode;throw Error(i(33))}function E(s){var r=s[Cn];return r||(r=s[Cn]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function S(s){s[hn]=!0}var G=new Set,ae={};function Qe(s,r){qe(s,r),qe(s+"Capture",r)}function qe(s,r){for(ae[s]=r,s=0;s<r.length;s++)G.add(r[s])}var Fe=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Lt={},Mt={};function Ys(s){return tt.call(Mt,s)?!0:tt.call(Lt,s)?!1:Fe.test(s)?Mt[s]=!0:(Lt[s]=!0,!1)}function jn(s,r,o){if(Ys(r))if(o===null)s.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":s.removeAttribute(r);return;case"boolean":var c=r.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){s.removeAttribute(r);return}}s.setAttribute(r,""+o)}}function gn(s,r,o){if(o===null)s.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(r);return}s.setAttribute(r,""+o)}}function Js(s,r,o,c){if(c===null)s.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttributeNS(r,o,""+c)}}function Hs(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Y(s){var r=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function xe(s,r,o){var c=Object.getOwnPropertyDescriptor(s.constructor.prototype,r);if(!s.hasOwnProperty(r)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var f=c.get,m=c.set;return Object.defineProperty(s,r,{configurable:!0,get:function(){return f.call(this)},set:function(x){o=""+x,m.call(this,x)}}),Object.defineProperty(s,r,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(x){o=""+x},stopTracking:function(){s._valueTracker=null,delete s[r]}}}}function te(s){if(!s._valueTracker){var r=Y(s)?"checked":"value";s._valueTracker=xe(s,r,""+s[r])}}function Be(s){if(!s)return!1;var r=s._valueTracker;if(!r)return!0;var o=r.getValue(),c="";return s&&(c=Y(s)?s.checked?"true":"false":s.value),s=c,s!==o?(r.setValue(s),!0):!1}function We(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var ot=/[\n"\\]/g;function xt(s){return s.replace(ot,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function Kt(s,r,o,c,f,m,x,N){s.name="",x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?s.type=x:s.removeAttribute("type"),r!=null?x==="number"?(r===0&&s.value===""||s.value!=r)&&(s.value=""+Hs(r)):s.value!==""+Hs(r)&&(s.value=""+Hs(r)):x!=="submit"&&x!=="reset"||s.removeAttribute("value"),r!=null?yn(s,x,Hs(r)):o!=null?yn(s,x,Hs(o)):c!=null&&s.removeAttribute("value"),f==null&&m!=null&&(s.defaultChecked=!!m),f!=null&&(s.checked=f&&typeof f!="function"&&typeof f!="symbol"),N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?s.name=""+Hs(N):s.removeAttribute("name")}function is(s,r,o,c,f,m,x,N){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(s.type=m),r!=null||o!=null){if(!(m!=="submit"&&m!=="reset"||r!=null)){te(s);return}o=o!=null?""+Hs(o):"",r=r!=null?""+Hs(r):o,N||r===s.value||(s.value=r),s.defaultValue=r}c=c??f,c=typeof c!="function"&&typeof c!="symbol"&&!!c,s.checked=N?s.checked:!!c,s.defaultChecked=!!c,x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(s.name=x),te(s)}function yn(s,r,o){r==="number"&&We(s.ownerDocument)===s||s.defaultValue===""+o||(s.defaultValue=""+o)}function ms(s,r,o,c){if(s=s.options,r){r={};for(var f=0;f<o.length;f++)r["$"+o[f]]=!0;for(o=0;o<s.length;o++)f=r.hasOwnProperty("$"+s[o].value),s[o].selected!==f&&(s[o].selected=f),f&&c&&(s[o].defaultSelected=!0)}else{for(o=""+Hs(o),r=null,f=0;f<s.length;f++){if(s[f].value===o){s[f].selected=!0,c&&(s[f].defaultSelected=!0);return}r!==null||s[f].disabled||(r=s[f])}r!==null&&(r.selected=!0)}}function Fn(s,r,o){if(r!=null&&(r=""+Hs(r),r!==s.value&&(s.value=r),o==null)){s.defaultValue!==r&&(s.defaultValue=r);return}s.defaultValue=o!=null?""+Hs(o):""}function Yr(s,r,o,c){if(r==null){if(c!=null){if(o!=null)throw Error(i(92));if(bt(c)){if(1<c.length)throw Error(i(93));c=c[0]}o=c}o==null&&(o=""),r=o}o=Hs(r),s.defaultValue=o,c=s.textContent,c===o&&c!==""&&c!==null&&(s.value=c),te(s)}function Vn(s,r){if(r){var o=s.firstChild;if(o&&o===s.lastChild&&o.nodeType===3){o.nodeValue=r;return}}s.textContent=r}var hr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ta(s,r,o){var c=r.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?s.setProperty(r,""):r==="float"?s.cssFloat="":s[r]="":c?s.setProperty(r,o):typeof o!="number"||o===0||hr.has(r)?r==="float"?s.cssFloat=o:s[r]=(""+o).trim():s[r]=o+"px"}function os(s,r,o){if(r!=null&&typeof r!="object")throw Error(i(62));if(s=s.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||r!=null&&r.hasOwnProperty(c)||(c.indexOf("--")===0?s.setProperty(c,""):c==="float"?s.cssFloat="":s[c]="");for(var f in r)c=r[f],r.hasOwnProperty(f)&&o[f]!==c&&Ta(s,f,c)}else for(var m in r)r.hasOwnProperty(m)&&Ta(s,m,r[m])}function ln(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var fr=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Gn=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Kn(s){return Gn.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Zs(){}var sn=null;function mn(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Lr=null,mr=null;function Or(s){var r=$(s);if(r&&(s=r.stateNode)){var o=s[Rt]||null;e:switch(s=r.stateNode,r.type){case"input":if(Kt(s,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),r=o.name,o.type==="radio"&&r!=null){for(o=s;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+xt(""+r)+'"][type="radio"]'),r=0;r<o.length;r++){var c=o[r];if(c!==s&&c.form===s.form){var f=c[Rt]||null;if(!f)throw Error(i(90));Kt(c,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(r=0;r<o.length;r++)c=o[r],c.form===s.form&&Be(c)}break e;case"textarea":Fn(s,o.value,o.defaultValue);break e;case"select":r=o.value,r!=null&&ms(s,!!o.multiple,r,!1)}}}var ji=!1;function Ea(s,r,o){if(ji)return s(r,o);ji=!0;try{var c=s(r);return c}finally{if(ji=!1,(Lr!==null||mr!==null)&&(Rd(),Lr&&(r=Lr,s=mr,mr=Lr=null,Or(r),s)))for(r=0;r<s.length;r++)Or(s[r])}}function pr(s,r){var o=s.stateNode;if(o===null)return null;var c=o[Rt]||null;if(c===null)return null;o=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(s=s.type,c=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!c;break e;default:s=!1}if(s)return null;if(o&&typeof o!="function")throw Error(i(231,r,typeof o));return o}var jr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Na=!1;if(jr)try{var Os={};Object.defineProperty(Os,"passive",{get:function(){Na=!0}}),window.addEventListener("test",Os,Os),window.removeEventListener("test",Os,Os)}catch{Na=!1}var Qr=null,xo=null,Ga=null;function wo(){if(Ga)return Ga;var s,r=xo,o=r.length,c,f="value"in Qr?Qr.value:Qr.textContent,m=f.length;for(s=0;s<o&&r[s]===f[s];s++);var x=o-s;for(c=1;c<=x&&r[o-c]===f[m-c];c++);return Ga=f.slice(s,1<c?1-c:void 0)}function I(s){var r=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&r===13&&(s=13)):s=r,s===10&&(s=13),32<=s||s===13?s:0}function X(){return!0}function Pe(){return!1}function Ge(s){function r(o,c,f,m,x){this._reactName=o,this._targetInst=f,this.type=c,this.nativeEvent=m,this.target=x,this.currentTarget=null;for(var N in s)s.hasOwnProperty(N)&&(o=s[N],this[N]=o?o(m):m[N]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?X:Pe,this.isPropagationStopped=Pe,this}return k(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=X)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=X)},persist:function(){},isPersistent:X}),r}var dt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},jt=Ge(dt),et=k({},dt,{view:0,detail:0}),Ot=Ge(et),Ft,ds,Jt,ls=k({},et,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sa,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Jt&&(Jt&&s.type==="mousemove"?(Ft=s.screenX-Jt.screenX,ds=s.screenY-Jt.screenY):ds=Ft=0,Jt=s),Ft)},movementY:function(s){return"movementY"in s?s.movementY:ds}}),Yn=Ge(ls),Hn=k({},ls,{dataTransfer:0}),Us=Ge(Hn),Vs=k({},et,{relatedTarget:0}),nn=Ge(Vs),Rn=k({},dt,{animationName:0,elapsedTime:0,pseudoElement:0}),Qn=Ge(Rn),Xn=k({},dt,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Tr=Ge(Xn),gr=k({},dt,{data:0}),bn=Ge(gr),Bn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Er={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _o(s){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(s):(s=Nr[s])?!!r[s]:!1}function Sa(){return _o}var Jn=k({},et,{key:function(s){if(s.key){var r=Bn[s.key]||s.key;if(r!=="Unidentified")return r}return s.type==="keypress"?(s=I(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Er[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sa,charCode:function(s){return s.type==="keypress"?I(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?I(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Ka=Ge(Jn),ca=k({},ls,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ir=Ge(ca),h=k({},et,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sa}),b=Ge(h),_=k({},dt,{propertyName:0,elapsedTime:0,pseudoElement:0}),C=Ge(_),re=k({},ls,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),de=Ge(re),Xe=k({},dt,{newState:0,oldState:0}),Zt=Ge(Xe),Tn=[9,13,27,32],Ps=jr&&"CompositionEvent"in window,cn=null;jr&&"documentMode"in document&&(cn=document.documentMode);var Xr=jr&&"TextEvent"in window&&!cn,Ca=jr&&(!Ps||cn&&8<cn&&11>=cn),ua=" ",da=!1;function ko(s,r){switch(s){case"keyup":return Tn.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function il(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var ol=!1;function Dk(s,r){switch(s){case"compositionend":return il(r);case"keypress":return r.which!==32?null:(da=!0,ua);case"textInput":return s=r.data,s===ua&&da?null:s;default:return null}}function Pk(s,r){if(ol)return s==="compositionend"||!Ps&&ko(s,r)?(s=wo(),Ga=xo=Qr=null,ol=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return Ca&&r.locale!=="ko"?null:r.data;default:return null}}var Lk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Qy(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r==="input"?!!Lk[s.type]:r==="textarea"}function Xy(s,r,o,c){Lr?mr?mr.push(c):mr=[c]:Lr=c,r=Od(r,"onChange"),0<r.length&&(o=new jt("onChange","change",null,o,c),s.push({event:o,listeners:r}))}var dc=null,hc=null;function Ok(s){M0(s,0)}function Yu(s){var r=ue(s);if(Be(r))return s}function Jy(s,r){if(s==="change")return r}var Zy=!1;if(jr){var wf;if(jr){var _f="oninput"in document;if(!_f){var eb=document.createElement("div");eb.setAttribute("oninput","return;"),_f=typeof eb.oninput=="function"}wf=_f}else wf=!1;Zy=wf&&(!document.documentMode||9<document.documentMode)}function tb(){dc&&(dc.detachEvent("onpropertychange",sb),hc=dc=null)}function sb(s){if(s.propertyName==="value"&&Yu(hc)){var r=[];Xy(r,hc,s,mn(s)),Ea(Ok,r)}}function Vk(s,r,o){s==="focusin"?(tb(),dc=r,hc=o,dc.attachEvent("onpropertychange",sb)):s==="focusout"&&tb()}function Bk(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Yu(hc)}function Uk(s,r){if(s==="click")return Yu(r)}function zk(s,r){if(s==="input"||s==="change")return Yu(r)}function Fk(s,r){return s===r&&(s!==0||1/s===1/r)||s!==s&&r!==r}var Vr=typeof Object.is=="function"?Object.is:Fk;function fc(s,r){if(Vr(s,r))return!0;if(typeof s!="object"||s===null||typeof r!="object"||r===null)return!1;var o=Object.keys(s),c=Object.keys(r);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var f=o[c];if(!tt.call(r,f)||!Vr(s[f],r[f]))return!1}return!0}function nb(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function rb(s,r){var o=nb(s);s=0;for(var c;o;){if(o.nodeType===3){if(c=s+o.textContent.length,s<=r&&c>=r)return{node:o,offset:r-s};s=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=nb(o)}}function ab(s,r){return s&&r?s===r?!0:s&&s.nodeType===3?!1:r&&r.nodeType===3?ab(s,r.parentNode):"contains"in s?s.contains(r):s.compareDocumentPosition?!!(s.compareDocumentPosition(r)&16):!1:!1}function ib(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var r=We(s.document);r instanceof s.HTMLIFrameElement;){try{var o=typeof r.contentWindow.location.href=="string"}catch{o=!1}if(o)s=r.contentWindow;else break;r=We(s.document)}return r}function kf(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r&&(r==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||r==="textarea"||s.contentEditable==="true")}var Hk=jr&&"documentMode"in document&&11>=document.documentMode,ll=null,jf=null,mc=null,Tf=!1;function ob(s,r,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Tf||ll==null||ll!==We(c)||(c=ll,"selectionStart"in c&&kf(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),mc&&fc(mc,c)||(mc=c,c=Od(jf,"onSelect"),0<c.length&&(r=new jt("onSelect","select",null,r,o),s.push({event:r,listeners:c}),r.target=ll)))}function jo(s,r){var o={};return o[s.toLowerCase()]=r.toLowerCase(),o["Webkit"+s]="webkit"+r,o["Moz"+s]="moz"+r,o}var cl={animationend:jo("Animation","AnimationEnd"),animationiteration:jo("Animation","AnimationIteration"),animationstart:jo("Animation","AnimationStart"),transitionrun:jo("Transition","TransitionRun"),transitionstart:jo("Transition","TransitionStart"),transitioncancel:jo("Transition","TransitionCancel"),transitionend:jo("Transition","TransitionEnd")},Ef={},lb={};jr&&(lb=document.createElement("div").style,"AnimationEvent"in window||(delete cl.animationend.animation,delete cl.animationiteration.animation,delete cl.animationstart.animation),"TransitionEvent"in window||delete cl.transitionend.transition);function To(s){if(Ef[s])return Ef[s];if(!cl[s])return s;var r=cl[s],o;for(o in r)if(r.hasOwnProperty(o)&&o in lb)return Ef[s]=r[o];return s}var cb=To("animationend"),ub=To("animationiteration"),db=To("animationstart"),qk=To("transitionrun"),$k=To("transitionstart"),Wk=To("transitioncancel"),hb=To("transitionend"),fb=new Map,Nf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Nf.push("scrollEnd");function ha(s,r){fb.set(s,r),Qe(r,[s])}var Qu=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Jr=[],ul=0,Sf=0;function Xu(){for(var s=ul,r=Sf=ul=0;r<s;){var o=Jr[r];Jr[r++]=null;var c=Jr[r];Jr[r++]=null;var f=Jr[r];Jr[r++]=null;var m=Jr[r];if(Jr[r++]=null,c!==null&&f!==null){var x=c.pending;x===null?f.next=f:(f.next=x.next,x.next=f),c.pending=f}m!==0&&mb(o,f,m)}}function Ju(s,r,o,c){Jr[ul++]=s,Jr[ul++]=r,Jr[ul++]=o,Jr[ul++]=c,Sf|=c,s.lanes|=c,s=s.alternate,s!==null&&(s.lanes|=c)}function Cf(s,r,o,c){return Ju(s,r,o,c),Zu(s)}function Eo(s,r){return Ju(s,null,null,r),Zu(s)}function mb(s,r,o){s.lanes|=o;var c=s.alternate;c!==null&&(c.lanes|=o);for(var f=!1,m=s.return;m!==null;)m.childLanes|=o,c=m.alternate,c!==null&&(c.childLanes|=o),m.tag===22&&(s=m.stateNode,s===null||s._visibility&1||(f=!0)),s=m,m=m.return;return s.tag===3?(m=s.stateNode,f&&r!==null&&(f=31-De(o),s=m.hiddenUpdates,c=s[f],c===null?s[f]=[r]:c.push(r),r.lane=o|536870912),m):null}function Zu(s){if(50<Lc)throw Lc=0,Vm=null,Error(i(185));for(var r=s.return;r!==null;)s=r,r=s.return;return s.tag===3?s.stateNode:null}var dl={};function Gk(s,r,o,c){this.tag=s,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Br(s,r,o,c){return new Gk(s,r,o,c)}function Rf(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Ya(s,r){var o=s.alternate;return o===null?(o=Br(s.tag,r,s.key,s.mode),o.elementType=s.elementType,o.type=s.type,o.stateNode=s.stateNode,o.alternate=s,s.alternate=o):(o.pendingProps=r,o.type=s.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=s.flags&65011712,o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,r=s.dependencies,o.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},o.sibling=s.sibling,o.index=s.index,o.ref=s.ref,o.refCleanup=s.refCleanup,o}function pb(s,r){s.flags&=65011714;var o=s.alternate;return o===null?(s.childLanes=0,s.lanes=r,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,r=o.dependencies,s.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),s}function ed(s,r,o,c,f,m){var x=0;if(c=s,typeof s=="function")Rf(s)&&(x=1);else if(typeof s=="string")x=Jj(s,o,Oe.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case A:return s=Br(31,o,r,f),s.elementType=A,s.lanes=m,s;case B:return No(o.children,f,m,r);case V:x=8,f|=24;break;case ne:return s=Br(12,o,r,f|2),s.elementType=ne,s.lanes=m,s;case Ie:return s=Br(13,o,r,f),s.elementType=Ie,s.lanes=m,s;case Te:return s=Br(19,o,r,f),s.elementType=Te,s.lanes=m,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case le:x=10;break e;case K:x=9;break e;case ge:x=11;break e;case R:x=14;break e;case T:x=16,c=null;break e}x=29,o=Error(i(130,s===null?"null":typeof s,"")),c=null}return r=Br(x,o,r,f),r.elementType=s,r.type=c,r.lanes=m,r}function No(s,r,o,c){return s=Br(7,s,c,r),s.lanes=o,s}function Af(s,r,o){return s=Br(6,s,null,r),s.lanes=o,s}function gb(s){var r=Br(18,null,null,0);return r.stateNode=s,r}function If(s,r,o){return r=Br(4,s.children!==null?s.children:[],s.key,r),r.lanes=o,r.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},r}var yb=new WeakMap;function Zr(s,r){if(typeof s=="object"&&s!==null){var o=yb.get(s);return o!==void 0?o:(r={value:s,source:r,stack:ut(r)},yb.set(s,r),r)}return{value:s,source:r,stack:ut(r)}}var hl=[],fl=0,td=null,pc=0,ea=[],ta=0,Ti=null,Ra=1,Aa="";function Qa(s,r){hl[fl++]=pc,hl[fl++]=td,td=s,pc=r}function bb(s,r,o){ea[ta++]=Ra,ea[ta++]=Aa,ea[ta++]=Ti,Ti=s;var c=Ra;s=Aa;var f=32-De(c)-1;c&=~(1<<f),o+=1;var m=32-De(r)+f;if(30<m){var x=f-f%5;m=(c&(1<<x)-1).toString(32),c>>=x,f-=x,Ra=1<<32-De(r)+f|o<<f|c,Aa=m+s}else Ra=1<<m|o<<f|c,Aa=s}function Mf(s){s.return!==null&&(Qa(s,1),bb(s,1,0))}function Df(s){for(;s===td;)td=hl[--fl],hl[fl]=null,pc=hl[--fl],hl[fl]=null;for(;s===Ti;)Ti=ea[--ta],ea[ta]=null,Aa=ea[--ta],ea[ta]=null,Ra=ea[--ta],ea[ta]=null}function vb(s,r){ea[ta++]=Ra,ea[ta++]=Aa,ea[ta++]=Ti,Ra=r.id,Aa=r.overflow,Ti=s}var Zn=null,rn=null,xs=!1,Ei=null,sa=!1,Pf=Error(i(519));function Ni(s){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw gc(Zr(r,s)),Pf}function xb(s){var r=s.stateNode,o=s.type,c=s.memoizedProps;switch(r[it]=s,r[Rt]=c,o){case"dialog":fs("cancel",r),fs("close",r);break;case"iframe":case"object":case"embed":fs("load",r);break;case"video":case"audio":for(o=0;o<Vc.length;o++)fs(Vc[o],r);break;case"source":fs("error",r);break;case"img":case"image":case"link":fs("error",r),fs("load",r);break;case"details":fs("toggle",r);break;case"input":fs("invalid",r),is(r,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":fs("invalid",r);break;case"textarea":fs("invalid",r),Yr(r,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||r.textContent===""+o||c.suppressHydrationWarning===!0||O0(r.textContent,o)?(c.popover!=null&&(fs("beforetoggle",r),fs("toggle",r)),c.onScroll!=null&&fs("scroll",r),c.onScrollEnd!=null&&fs("scrollend",r),c.onClick!=null&&(r.onclick=Zs),r=!0):r=!1,r||Ni(s,!0)}function wb(s){for(Zn=s.return;Zn;)switch(Zn.tag){case 5:case 31:case 13:sa=!1;return;case 27:case 3:sa=!0;return;default:Zn=Zn.return}}function ml(s){if(s!==Zn)return!1;if(!xs)return wb(s),xs=!0,!1;var r=s.tag,o;if((o=r!==3&&r!==27)&&((o=r===5)&&(o=s.type,o=!(o!=="form"&&o!=="button")||Zm(s.type,s.memoizedProps)),o=!o),o&&rn&&Ni(s),wb(s),r===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));rn=W0(s)}else if(r===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));rn=W0(s)}else r===27?(r=rn,zi(s.type)?(s=rp,rp=null,rn=s):rn=r):rn=Zn?ra(s.stateNode.nextSibling):null;return!0}function So(){rn=Zn=null,xs=!1}function Lf(){var s=Ei;return s!==null&&(Ar===null?Ar=s:Ar.push.apply(Ar,s),Ei=null),s}function gc(s){Ei===null?Ei=[s]:Ei.push(s)}var Of=P(null),Co=null,Xa=null;function Si(s,r,o){Se(Of,r._currentValue),r._currentValue=o}function Ja(s){s._currentValue=Of.current,se(Of)}function Vf(s,r,o){for(;s!==null;){var c=s.alternate;if((s.childLanes&r)!==r?(s.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),s===o)break;s=s.return}}function Bf(s,r,o,c){var f=s.child;for(f!==null&&(f.return=s);f!==null;){var m=f.dependencies;if(m!==null){var x=f.child;m=m.firstContext;e:for(;m!==null;){var N=m;m=f;for(var U=0;U<r.length;U++)if(N.context===r[U]){m.lanes|=o,N=m.alternate,N!==null&&(N.lanes|=o),Vf(m.return,o,s),c||(x=null);break e}m=N.next}}else if(f.tag===18){if(x=f.return,x===null)throw Error(i(341));x.lanes|=o,m=x.alternate,m!==null&&(m.lanes|=o),Vf(x,o,s),x=null}else x=f.child;if(x!==null)x.return=f;else for(x=f;x!==null;){if(x===s){x=null;break}if(f=x.sibling,f!==null){f.return=x.return,x=f;break}x=x.return}f=x}}function pl(s,r,o,c){s=null;for(var f=r,m=!1;f!==null;){if(!m){if((f.flags&524288)!==0)m=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var x=f.alternate;if(x===null)throw Error(i(387));if(x=x.memoizedProps,x!==null){var N=f.type;Vr(f.pendingProps.value,x.value)||(s!==null?s.push(N):s=[N])}}else if(f===gt.current){if(x=f.alternate,x===null)throw Error(i(387));x.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(s!==null?s.push(Hc):s=[Hc])}f=f.return}s!==null&&Bf(r,s,o,c),r.flags|=262144}function sd(s){for(s=s.firstContext;s!==null;){if(!Vr(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Ro(s){Co=s,Xa=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function er(s){return _b(Co,s)}function nd(s,r){return Co===null&&Ro(s),_b(s,r)}function _b(s,r){var o=r._currentValue;if(r={context:r,memoizedValue:o,next:null},Xa===null){if(s===null)throw Error(i(308));Xa=r,s.dependencies={lanes:0,firstContext:r},s.flags|=524288}else Xa=Xa.next=r;return o}var Kk=typeof AbortController<"u"?AbortController:function(){var s=[],r=this.signal={aborted:!1,addEventListener:function(o,c){s.push(c)}};this.abort=function(){r.aborted=!0,s.forEach(function(o){return o()})}},Yk=n.unstable_scheduleCallback,Qk=n.unstable_NormalPriority,An={$$typeof:le,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Uf(){return{controller:new Kk,data:new Map,refCount:0}}function yc(s){s.refCount--,s.refCount===0&&Yk(Qk,function(){s.controller.abort()})}var bc=null,zf=0,gl=0,yl=null;function Xk(s,r){if(bc===null){var o=bc=[];zf=0,gl=qm(),yl={status:"pending",value:void 0,then:function(c){o.push(c)}}}return zf++,r.then(kb,kb),r}function kb(){if(--zf===0&&bc!==null){yl!==null&&(yl.status="fulfilled");var s=bc;bc=null,gl=0,yl=null;for(var r=0;r<s.length;r++)(0,s[r])()}}function Jk(s,r){var o=[],c={status:"pending",value:null,reason:null,then:function(f){o.push(f)}};return s.then(function(){c.status="fulfilled",c.value=r;for(var f=0;f<o.length;f++)(0,o[f])(r)},function(f){for(c.status="rejected",c.reason=f,f=0;f<o.length;f++)(0,o[f])(void 0)}),c}var jb=H.S;H.S=function(s,r){o0=as(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&Xk(s,r),jb!==null&&jb(s,r)};var Ao=P(null);function Ff(){var s=Ao.current;return s!==null?s:Qs.pooledCache}function rd(s,r){r===null?Se(Ao,Ao.current):Se(Ao,r.pool)}function Tb(){var s=Ff();return s===null?null:{parent:An._currentValue,pool:s}}var bl=Error(i(460)),Hf=Error(i(474)),ad=Error(i(542)),id={then:function(){}};function Eb(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Nb(s,r,o){switch(o=s[o],o===void 0?s.push(r):o!==r&&(r.then(Zs,Zs),r=o),r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,Cb(s),s;default:if(typeof r.status=="string")r.then(Zs,Zs);else{if(s=Qs,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=r,s.status="pending",s.then(function(c){if(r.status==="pending"){var f=r;f.status="fulfilled",f.value=c}},function(c){if(r.status==="pending"){var f=r;f.status="rejected",f.reason=c}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,Cb(s),s}throw Mo=r,bl}}function Io(s){try{var r=s._init;return r(s._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(Mo=o,bl):o}}var Mo=null;function Sb(){if(Mo===null)throw Error(i(459));var s=Mo;return Mo=null,s}function Cb(s){if(s===bl||s===ad)throw Error(i(483))}var vl=null,vc=0;function od(s){var r=vc;return vc+=1,vl===null&&(vl=[]),Nb(vl,s,r)}function xc(s,r){r=r.props.ref,s.ref=r!==void 0?r:null}function ld(s,r){throw r.$$typeof===j?Error(i(525)):(s=Object.prototype.toString.call(r),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":s)))}function Rb(s){function r(J,W){if(s){var ie=J.deletions;ie===null?(J.deletions=[W],J.flags|=16):ie.push(W)}}function o(J,W){if(!s)return null;for(;W!==null;)r(J,W),W=W.sibling;return null}function c(J){for(var W=new Map;J!==null;)J.key!==null?W.set(J.key,J):W.set(J.index,J),J=J.sibling;return W}function f(J,W){return J=Ya(J,W),J.index=0,J.sibling=null,J}function m(J,W,ie){return J.index=ie,s?(ie=J.alternate,ie!==null?(ie=ie.index,ie<W?(J.flags|=67108866,W):ie):(J.flags|=67108866,W)):(J.flags|=1048576,W)}function x(J){return s&&J.alternate===null&&(J.flags|=67108866),J}function N(J,W,ie,Ne){return W===null||W.tag!==6?(W=Af(ie,J.mode,Ne),W.return=J,W):(W=f(W,ie),W.return=J,W)}function U(J,W,ie,Ne){var Et=ie.type;return Et===B?ke(J,W,ie.props.children,Ne,ie.key):W!==null&&(W.elementType===Et||typeof Et=="object"&&Et!==null&&Et.$$typeof===T&&Io(Et)===W.type)?(W=f(W,ie.props),xc(W,ie),W.return=J,W):(W=ed(ie.type,ie.key,ie.props,null,J.mode,Ne),xc(W,ie),W.return=J,W)}function oe(J,W,ie,Ne){return W===null||W.tag!==4||W.stateNode.containerInfo!==ie.containerInfo||W.stateNode.implementation!==ie.implementation?(W=If(ie,J.mode,Ne),W.return=J,W):(W=f(W,ie.children||[]),W.return=J,W)}function ke(J,W,ie,Ne,Et){return W===null||W.tag!==7?(W=No(ie,J.mode,Ne,Et),W.return=J,W):(W=f(W,ie),W.return=J,W)}function Ce(J,W,ie){if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return W=Af(""+W,J.mode,ie),W.return=J,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case O:return ie=ed(W.type,W.key,W.props,null,J.mode,ie),xc(ie,W),ie.return=J,ie;case q:return W=If(W,J.mode,ie),W.return=J,W;case T:return W=Io(W),Ce(J,W,ie)}if(bt(W)||F(W))return W=No(W,J.mode,ie,null),W.return=J,W;if(typeof W.then=="function")return Ce(J,od(W),ie);if(W.$$typeof===le)return Ce(J,nd(J,W),ie);ld(J,W)}return null}function ce(J,W,ie,Ne){var Et=W!==null?W.key:null;if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return Et!==null?null:N(J,W,""+ie,Ne);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case O:return ie.key===Et?U(J,W,ie,Ne):null;case q:return ie.key===Et?oe(J,W,ie,Ne):null;case T:return ie=Io(ie),ce(J,W,ie,Ne)}if(bt(ie)||F(ie))return Et!==null?null:ke(J,W,ie,Ne,null);if(typeof ie.then=="function")return ce(J,W,od(ie),Ne);if(ie.$$typeof===le)return ce(J,W,nd(J,ie),Ne);ld(J,ie)}return null}function me(J,W,ie,Ne,Et){if(typeof Ne=="string"&&Ne!==""||typeof Ne=="number"||typeof Ne=="bigint")return J=J.get(ie)||null,N(W,J,""+Ne,Et);if(typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case O:return J=J.get(Ne.key===null?ie:Ne.key)||null,U(W,J,Ne,Et);case q:return J=J.get(Ne.key===null?ie:Ne.key)||null,oe(W,J,Ne,Et);case T:return Ne=Io(Ne),me(J,W,ie,Ne,Et)}if(bt(Ne)||F(Ne))return J=J.get(ie)||null,ke(W,J,Ne,Et,null);if(typeof Ne.then=="function")return me(J,W,ie,od(Ne),Et);if(Ne.$$typeof===le)return me(J,W,ie,nd(W,Ne),Et);ld(W,Ne)}return null}function ht(J,W,ie,Ne){for(var Et=null,Is=null,yt=W,ss=W=0,gs=null;yt!==null&&ss<ie.length;ss++){yt.index>ss?(gs=yt,yt=null):gs=yt.sibling;var Ms=ce(J,yt,ie[ss],Ne);if(Ms===null){yt===null&&(yt=gs);break}s&&yt&&Ms.alternate===null&&r(J,yt),W=m(Ms,W,ss),Is===null?Et=Ms:Is.sibling=Ms,Is=Ms,yt=gs}if(ss===ie.length)return o(J,yt),xs&&Qa(J,ss),Et;if(yt===null){for(;ss<ie.length;ss++)yt=Ce(J,ie[ss],Ne),yt!==null&&(W=m(yt,W,ss),Is===null?Et=yt:Is.sibling=yt,Is=yt);return xs&&Qa(J,ss),Et}for(yt=c(yt);ss<ie.length;ss++)gs=me(yt,J,ss,ie[ss],Ne),gs!==null&&(s&&gs.alternate!==null&&yt.delete(gs.key===null?ss:gs.key),W=m(gs,W,ss),Is===null?Et=gs:Is.sibling=gs,Is=gs);return s&&yt.forEach(function(Wi){return r(J,Wi)}),xs&&Qa(J,ss),Et}function Dt(J,W,ie,Ne){if(ie==null)throw Error(i(151));for(var Et=null,Is=null,yt=W,ss=W=0,gs=null,Ms=ie.next();yt!==null&&!Ms.done;ss++,Ms=ie.next()){yt.index>ss?(gs=yt,yt=null):gs=yt.sibling;var Wi=ce(J,yt,Ms.value,Ne);if(Wi===null){yt===null&&(yt=gs);break}s&&yt&&Wi.alternate===null&&r(J,yt),W=m(Wi,W,ss),Is===null?Et=Wi:Is.sibling=Wi,Is=Wi,yt=gs}if(Ms.done)return o(J,yt),xs&&Qa(J,ss),Et;if(yt===null){for(;!Ms.done;ss++,Ms=ie.next())Ms=Ce(J,Ms.value,Ne),Ms!==null&&(W=m(Ms,W,ss),Is===null?Et=Ms:Is.sibling=Ms,Is=Ms);return xs&&Qa(J,ss),Et}for(yt=c(yt);!Ms.done;ss++,Ms=ie.next())Ms=me(yt,J,ss,Ms.value,Ne),Ms!==null&&(s&&Ms.alternate!==null&&yt.delete(Ms.key===null?ss:Ms.key),W=m(Ms,W,ss),Is===null?Et=Ms:Is.sibling=Ms,Is=Ms);return s&&yt.forEach(function(cT){return r(J,cT)}),xs&&Qa(J,ss),Et}function Ws(J,W,ie,Ne){if(typeof ie=="object"&&ie!==null&&ie.type===B&&ie.key===null&&(ie=ie.props.children),typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case O:e:{for(var Et=ie.key;W!==null;){if(W.key===Et){if(Et=ie.type,Et===B){if(W.tag===7){o(J,W.sibling),Ne=f(W,ie.props.children),Ne.return=J,J=Ne;break e}}else if(W.elementType===Et||typeof Et=="object"&&Et!==null&&Et.$$typeof===T&&Io(Et)===W.type){o(J,W.sibling),Ne=f(W,ie.props),xc(Ne,ie),Ne.return=J,J=Ne;break e}o(J,W);break}else r(J,W);W=W.sibling}ie.type===B?(Ne=No(ie.props.children,J.mode,Ne,ie.key),Ne.return=J,J=Ne):(Ne=ed(ie.type,ie.key,ie.props,null,J.mode,Ne),xc(Ne,ie),Ne.return=J,J=Ne)}return x(J);case q:e:{for(Et=ie.key;W!==null;){if(W.key===Et)if(W.tag===4&&W.stateNode.containerInfo===ie.containerInfo&&W.stateNode.implementation===ie.implementation){o(J,W.sibling),Ne=f(W,ie.children||[]),Ne.return=J,J=Ne;break e}else{o(J,W);break}else r(J,W);W=W.sibling}Ne=If(ie,J.mode,Ne),Ne.return=J,J=Ne}return x(J);case T:return ie=Io(ie),Ws(J,W,ie,Ne)}if(bt(ie))return ht(J,W,ie,Ne);if(F(ie)){if(Et=F(ie),typeof Et!="function")throw Error(i(150));return ie=Et.call(ie),Dt(J,W,ie,Ne)}if(typeof ie.then=="function")return Ws(J,W,od(ie),Ne);if(ie.$$typeof===le)return Ws(J,W,nd(J,ie),Ne);ld(J,ie)}return typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint"?(ie=""+ie,W!==null&&W.tag===6?(o(J,W.sibling),Ne=f(W,ie),Ne.return=J,J=Ne):(o(J,W),Ne=Af(ie,J.mode,Ne),Ne.return=J,J=Ne),x(J)):o(J,W)}return function(J,W,ie,Ne){try{vc=0;var Et=Ws(J,W,ie,Ne);return vl=null,Et}catch(yt){if(yt===bl||yt===ad)throw yt;var Is=Br(29,yt,null,J.mode);return Is.lanes=Ne,Is.return=J,Is}}}var Do=Rb(!0),Ab=Rb(!1),Ci=!1;function qf(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function $f(s,r){s=s.updateQueue,r.updateQueue===s&&(r.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Ri(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Ai(s,r,o){var c=s.updateQueue;if(c===null)return null;if(c=c.shared,(Ls&2)!==0){var f=c.pending;return f===null?r.next=r:(r.next=f.next,f.next=r),c.pending=r,r=Zu(s),mb(s,null,o),r}return Ju(s,c,r,o),Zu(s)}function wc(s,r,o){if(r=r.updateQueue,r!==null&&(r=r.shared,(o&4194048)!==0)){var c=r.lanes;c&=s.pendingLanes,o|=c,r.lanes=o,Ts(s,o)}}function Wf(s,r){var o=s.updateQueue,c=s.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var f=null,m=null;if(o=o.firstBaseUpdate,o!==null){do{var x={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};m===null?f=m=x:m=m.next=x,o=o.next}while(o!==null);m===null?f=m=r:m=m.next=r}else f=m=r;o={baseState:c.baseState,firstBaseUpdate:f,lastBaseUpdate:m,shared:c.shared,callbacks:c.callbacks},s.updateQueue=o;return}s=o.lastBaseUpdate,s===null?o.firstBaseUpdate=r:s.next=r,o.lastBaseUpdate=r}var Gf=!1;function _c(){if(Gf){var s=yl;if(s!==null)throw s}}function kc(s,r,o,c){Gf=!1;var f=s.updateQueue;Ci=!1;var m=f.firstBaseUpdate,x=f.lastBaseUpdate,N=f.shared.pending;if(N!==null){f.shared.pending=null;var U=N,oe=U.next;U.next=null,x===null?m=oe:x.next=oe,x=U;var ke=s.alternate;ke!==null&&(ke=ke.updateQueue,N=ke.lastBaseUpdate,N!==x&&(N===null?ke.firstBaseUpdate=oe:N.next=oe,ke.lastBaseUpdate=U))}if(m!==null){var Ce=f.baseState;x=0,ke=oe=U=null,N=m;do{var ce=N.lane&-536870913,me=ce!==N.lane;if(me?(ps&ce)===ce:(c&ce)===ce){ce!==0&&ce===gl&&(Gf=!0),ke!==null&&(ke=ke.next={lane:0,tag:N.tag,payload:N.payload,callback:null,next:null});e:{var ht=s,Dt=N;ce=r;var Ws=o;switch(Dt.tag){case 1:if(ht=Dt.payload,typeof ht=="function"){Ce=ht.call(Ws,Ce,ce);break e}Ce=ht;break e;case 3:ht.flags=ht.flags&-65537|128;case 0:if(ht=Dt.payload,ce=typeof ht=="function"?ht.call(Ws,Ce,ce):ht,ce==null)break e;Ce=k({},Ce,ce);break e;case 2:Ci=!0}}ce=N.callback,ce!==null&&(s.flags|=64,me&&(s.flags|=8192),me=f.callbacks,me===null?f.callbacks=[ce]:me.push(ce))}else me={lane:ce,tag:N.tag,payload:N.payload,callback:N.callback,next:null},ke===null?(oe=ke=me,U=Ce):ke=ke.next=me,x|=ce;if(N=N.next,N===null){if(N=f.shared.pending,N===null)break;me=N,N=me.next,me.next=null,f.lastBaseUpdate=me,f.shared.pending=null}}while(!0);ke===null&&(U=Ce),f.baseState=U,f.firstBaseUpdate=oe,f.lastBaseUpdate=ke,m===null&&(f.shared.lanes=0),Li|=x,s.lanes=x,s.memoizedState=Ce}}function Ib(s,r){if(typeof s!="function")throw Error(i(191,s));s.call(r)}function Mb(s,r){var o=s.callbacks;if(o!==null)for(s.callbacks=null,s=0;s<o.length;s++)Ib(o[s],r)}var xl=P(null),cd=P(0);function Db(s,r){s=oi,Se(cd,s),Se(xl,r),oi=s|r.baseLanes}function Kf(){Se(cd,oi),Se(xl,xl.current)}function Yf(){oi=cd.current,se(xl),se(cd)}var Ur=P(null),na=null;function Ii(s){var r=s.alternate;Se(En,En.current&1),Se(Ur,s),na===null&&(r===null||xl.current!==null||r.memoizedState!==null)&&(na=s)}function Qf(s){Se(En,En.current),Se(Ur,s),na===null&&(na=s)}function Pb(s){s.tag===22?(Se(En,En.current),Se(Ur,s),na===null&&(na=s)):Mi()}function Mi(){Se(En,En.current),Se(Ur,Ur.current)}function zr(s){se(Ur),na===s&&(na=null),se(En)}var En=P(0);function ud(s){for(var r=s;r!==null;){if(r.tag===13){var o=r.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||sp(o)||np(o)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Za=0,es=null,qs=null,In=null,dd=!1,wl=!1,Po=!1,hd=0,jc=0,_l=null,Zk=0;function vn(){throw Error(i(321))}function Xf(s,r){if(r===null)return!1;for(var o=0;o<r.length&&o<s.length;o++)if(!Vr(s[o],r[o]))return!1;return!0}function Jf(s,r,o,c,f,m){return Za=m,es=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,H.H=s===null||s.memoizedState===null?bv:fm,Po=!1,m=o(c,f),Po=!1,wl&&(m=Ob(r,o,c,f)),Lb(s),m}function Lb(s){H.H=Nc;var r=qs!==null&&qs.next!==null;if(Za=0,In=qs=es=null,dd=!1,jc=0,_l=null,r)throw Error(i(300));s===null||Mn||(s=s.dependencies,s!==null&&sd(s)&&(Mn=!0))}function Ob(s,r,o,c){es=s;var f=0;do{if(wl&&(_l=null),jc=0,wl=!1,25<=f)throw Error(i(301));if(f+=1,In=qs=null,s.updateQueue!=null){var m=s.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}H.H=vv,m=r(o,c)}while(wl);return m}function ej(){var s=H.H,r=s.useState()[0];return r=typeof r.then=="function"?Tc(r):r,s=s.useState()[0],(qs!==null?qs.memoizedState:null)!==s&&(es.flags|=1024),r}function Zf(){var s=hd!==0;return hd=0,s}function em(s,r,o){r.updateQueue=s.updateQueue,r.flags&=-2053,s.lanes&=~o}function tm(s){if(dd){for(s=s.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}dd=!1}Za=0,In=qs=es=null,wl=!1,jc=hd=0,_l=null}function yr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return In===null?es.memoizedState=In=s:In=In.next=s,In}function Nn(){if(qs===null){var s=es.alternate;s=s!==null?s.memoizedState:null}else s=qs.next;var r=In===null?es.memoizedState:In.next;if(r!==null)In=r,qs=s;else{if(s===null)throw es.alternate===null?Error(i(467)):Error(i(310));qs=s,s={memoizedState:qs.memoizedState,baseState:qs.baseState,baseQueue:qs.baseQueue,queue:qs.queue,next:null},In===null?es.memoizedState=In=s:In=In.next=s}return In}function fd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Tc(s){var r=jc;return jc+=1,_l===null&&(_l=[]),s=Nb(_l,s,r),r=es,(In===null?r.memoizedState:In.next)===null&&(r=r.alternate,H.H=r===null||r.memoizedState===null?bv:fm),s}function md(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Tc(s);if(s.$$typeof===le)return er(s)}throw Error(i(438,String(s)))}function sm(s){var r=null,o=es.updateQueue;if(o!==null&&(r=o.memoCache),r==null){var c=es.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(r={data:c.data.map(function(f){return f.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),o===null&&(o=fd(),es.updateQueue=o),o.memoCache=r,o=r.data[r.index],o===void 0)for(o=r.data[r.index]=Array(s),c=0;c<s;c++)o[c]=L;return r.index++,o}function ei(s,r){return typeof r=="function"?r(s):r}function pd(s){var r=Nn();return nm(r,qs,s)}function nm(s,r,o){var c=s.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=o;var f=s.baseQueue,m=c.pending;if(m!==null){if(f!==null){var x=f.next;f.next=m.next,m.next=x}r.baseQueue=f=m,c.pending=null}if(m=s.baseState,f===null)s.memoizedState=m;else{r=f.next;var N=x=null,U=null,oe=r,ke=!1;do{var Ce=oe.lane&-536870913;if(Ce!==oe.lane?(ps&Ce)===Ce:(Za&Ce)===Ce){var ce=oe.revertLane;if(ce===0)U!==null&&(U=U.next={lane:0,revertLane:0,gesture:null,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null}),Ce===gl&&(ke=!0);else if((Za&ce)===ce){oe=oe.next,ce===gl&&(ke=!0);continue}else Ce={lane:0,revertLane:oe.revertLane,gesture:null,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null},U===null?(N=U=Ce,x=m):U=U.next=Ce,es.lanes|=ce,Li|=ce;Ce=oe.action,Po&&o(m,Ce),m=oe.hasEagerState?oe.eagerState:o(m,Ce)}else ce={lane:Ce,revertLane:oe.revertLane,gesture:oe.gesture,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null},U===null?(N=U=ce,x=m):U=U.next=ce,es.lanes|=Ce,Li|=Ce;oe=oe.next}while(oe!==null&&oe!==r);if(U===null?x=m:U.next=N,!Vr(m,s.memoizedState)&&(Mn=!0,ke&&(o=yl,o!==null)))throw o;s.memoizedState=m,s.baseState=x,s.baseQueue=U,c.lastRenderedState=m}return f===null&&(c.lanes=0),[s.memoizedState,c.dispatch]}function rm(s){var r=Nn(),o=r.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=s;var c=o.dispatch,f=o.pending,m=r.memoizedState;if(f!==null){o.pending=null;var x=f=f.next;do m=s(m,x.action),x=x.next;while(x!==f);Vr(m,r.memoizedState)||(Mn=!0),r.memoizedState=m,r.baseQueue===null&&(r.baseState=m),o.lastRenderedState=m}return[m,c]}function Vb(s,r,o){var c=es,f=Nn(),m=xs;if(m){if(o===void 0)throw Error(i(407));o=o()}else o=r();var x=!Vr((qs||f).memoizedState,o);if(x&&(f.memoizedState=o,Mn=!0),f=f.queue,om(zb.bind(null,c,f,s),[s]),f.getSnapshot!==r||x||In!==null&&In.memoizedState.tag&1){if(c.flags|=2048,kl(9,{destroy:void 0},Ub.bind(null,c,f,o,r),null),Qs===null)throw Error(i(349));m||(Za&127)!==0||Bb(c,r,o)}return o}function Bb(s,r,o){s.flags|=16384,s={getSnapshot:r,value:o},r=es.updateQueue,r===null?(r=fd(),es.updateQueue=r,r.stores=[s]):(o=r.stores,o===null?r.stores=[s]:o.push(s))}function Ub(s,r,o,c){r.value=o,r.getSnapshot=c,Fb(r)&&Hb(s)}function zb(s,r,o){return o(function(){Fb(r)&&Hb(s)})}function Fb(s){var r=s.getSnapshot;s=s.value;try{var o=r();return!Vr(s,o)}catch{return!0}}function Hb(s){var r=Eo(s,2);r!==null&&Ir(r,s,2)}function am(s){var r=yr();if(typeof s=="function"){var o=s;if(s=o(),Po){Le(!0);try{o()}finally{Le(!1)}}}return r.memoizedState=r.baseState=s,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ei,lastRenderedState:s},r}function qb(s,r,o,c){return s.baseState=o,nm(s,qs,typeof c=="function"?c:ei)}function tj(s,r,o,c,f){if(bd(s))throw Error(i(485));if(s=r.action,s!==null){var m={payload:f,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(x){m.listeners.push(x)}};H.T!==null?o(!0):m.isTransition=!1,c(m),o=r.pending,o===null?(m.next=r.pending=m,$b(r,m)):(m.next=o.next,r.pending=o.next=m)}}function $b(s,r){var o=r.action,c=r.payload,f=s.state;if(r.isTransition){var m=H.T,x={};H.T=x;try{var N=o(f,c),U=H.S;U!==null&&U(x,N),Wb(s,r,N)}catch(oe){im(s,r,oe)}finally{m!==null&&x.types!==null&&(m.types=x.types),H.T=m}}else try{m=o(f,c),Wb(s,r,m)}catch(oe){im(s,r,oe)}}function Wb(s,r,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){Gb(s,r,c)},function(c){return im(s,r,c)}):Gb(s,r,o)}function Gb(s,r,o){r.status="fulfilled",r.value=o,Kb(r),s.state=o,r=s.pending,r!==null&&(o=r.next,o===r?s.pending=null:(o=o.next,r.next=o,$b(s,o)))}function im(s,r,o){var c=s.pending;if(s.pending=null,c!==null){c=c.next;do r.status="rejected",r.reason=o,Kb(r),r=r.next;while(r!==c)}s.action=null}function Kb(s){s=s.listeners;for(var r=0;r<s.length;r++)(0,s[r])()}function Yb(s,r){return r}function Qb(s,r){if(xs){var o=Qs.formState;if(o!==null){e:{var c=es;if(xs){if(rn){t:{for(var f=rn,m=sa;f.nodeType!==8;){if(!m){f=null;break t}if(f=ra(f.nextSibling),f===null){f=null;break t}}m=f.data,f=m==="F!"||m==="F"?f:null}if(f){rn=ra(f.nextSibling),c=f.data==="F!";break e}}Ni(c)}c=!1}c&&(r=o[0])}}return o=yr(),o.memoizedState=o.baseState=r,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yb,lastRenderedState:r},o.queue=c,o=pv.bind(null,es,c),c.dispatch=o,c=am(!1),m=hm.bind(null,es,!1,c.queue),c=yr(),f={state:r,dispatch:null,action:s,pending:null},c.queue=f,o=tj.bind(null,es,f,m,o),f.dispatch=o,c.memoizedState=s,[r,o,!1]}function Xb(s){var r=Nn();return Jb(r,qs,s)}function Jb(s,r,o){if(r=nm(s,r,Yb)[0],s=pd(ei)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var c=Tc(r)}catch(x){throw x===bl?ad:x}else c=r;r=Nn();var f=r.queue,m=f.dispatch;return o!==r.memoizedState&&(es.flags|=2048,kl(9,{destroy:void 0},sj.bind(null,f,o),null)),[c,m,s]}function sj(s,r){s.action=r}function Zb(s){var r=Nn(),o=qs;if(o!==null)return Jb(r,o,s);Nn(),r=r.memoizedState,o=Nn();var c=o.queue.dispatch;return o.memoizedState=s,[r,c,!1]}function kl(s,r,o,c){return s={tag:s,create:o,deps:c,inst:r,next:null},r=es.updateQueue,r===null&&(r=fd(),es.updateQueue=r),o=r.lastEffect,o===null?r.lastEffect=s.next=s:(c=o.next,o.next=s,s.next=c,r.lastEffect=s),s}function ev(){return Nn().memoizedState}function gd(s,r,o,c){var f=yr();es.flags|=s,f.memoizedState=kl(1|r,{destroy:void 0},o,c===void 0?null:c)}function yd(s,r,o,c){var f=Nn();c=c===void 0?null:c;var m=f.memoizedState.inst;qs!==null&&c!==null&&Xf(c,qs.memoizedState.deps)?f.memoizedState=kl(r,m,o,c):(es.flags|=s,f.memoizedState=kl(1|r,m,o,c))}function tv(s,r){gd(8390656,8,s,r)}function om(s,r){yd(2048,8,s,r)}function nj(s){es.flags|=4;var r=es.updateQueue;if(r===null)r=fd(),es.updateQueue=r,r.events=[s];else{var o=r.events;o===null?r.events=[s]:o.push(s)}}function sv(s){var r=Nn().memoizedState;return nj({ref:r,nextImpl:s}),function(){if((Ls&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function nv(s,r){return yd(4,2,s,r)}function rv(s,r){return yd(4,4,s,r)}function av(s,r){if(typeof r=="function"){s=s();var o=r(s);return function(){typeof o=="function"?o():r(null)}}if(r!=null)return s=s(),r.current=s,function(){r.current=null}}function iv(s,r,o){o=o!=null?o.concat([s]):null,yd(4,4,av.bind(null,r,s),o)}function lm(){}function ov(s,r){var o=Nn();r=r===void 0?null:r;var c=o.memoizedState;return r!==null&&Xf(r,c[1])?c[0]:(o.memoizedState=[s,r],s)}function lv(s,r){var o=Nn();r=r===void 0?null:r;var c=o.memoizedState;if(r!==null&&Xf(r,c[1]))return c[0];if(c=s(),Po){Le(!0);try{s()}finally{Le(!1)}}return o.memoizedState=[c,r],c}function cm(s,r,o){return o===void 0||(Za&1073741824)!==0&&(ps&261930)===0?s.memoizedState=r:(s.memoizedState=o,s=c0(),es.lanes|=s,Li|=s,o)}function cv(s,r,o,c){return Vr(o,r)?o:xl.current!==null?(s=cm(s,o,c),Vr(s,r)||(Mn=!0),s):(Za&42)===0||(Za&1073741824)!==0&&(ps&261930)===0?(Mn=!0,s.memoizedState=o):(s=c0(),es.lanes|=s,Li|=s,r)}function uv(s,r,o,c,f){var m=fe.p;fe.p=m!==0&&8>m?m:8;var x=H.T,N={};H.T=N,hm(s,!1,r,o);try{var U=f(),oe=H.S;if(oe!==null&&oe(N,U),U!==null&&typeof U=="object"&&typeof U.then=="function"){var ke=Jk(U,c);Ec(s,r,ke,qr(s))}else Ec(s,r,c,qr(s))}catch(Ce){Ec(s,r,{then:function(){},status:"rejected",reason:Ce},qr())}finally{fe.p=m,x!==null&&N.types!==null&&(x.types=N.types),H.T=x}}function rj(){}function um(s,r,o,c){if(s.tag!==5)throw Error(i(476));var f=dv(s).queue;uv(s,f,r,Me,o===null?rj:function(){return hv(s),o(c)})}function dv(s){var r=s.memoizedState;if(r!==null)return r;r={memoizedState:Me,baseState:Me,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ei,lastRenderedState:Me},next:null};var o={};return r.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ei,lastRenderedState:o},next:null},s.memoizedState=r,s=s.alternate,s!==null&&(s.memoizedState=r),r}function hv(s){var r=dv(s);r.next===null&&(r=s.alternate.memoizedState),Ec(s,r.next.queue,{},qr())}function dm(){return er(Hc)}function fv(){return Nn().memoizedState}function mv(){return Nn().memoizedState}function aj(s){for(var r=s.return;r!==null;){switch(r.tag){case 24:case 3:var o=qr();s=Ri(o);var c=Ai(r,s,o);c!==null&&(Ir(c,r,o),wc(c,r,o)),r={cache:Uf()},s.payload=r;return}r=r.return}}function ij(s,r,o){var c=qr();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},bd(s)?gv(r,o):(o=Cf(s,r,o,c),o!==null&&(Ir(o,s,c),yv(o,r,c)))}function pv(s,r,o){var c=qr();Ec(s,r,o,c)}function Ec(s,r,o,c){var f={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(bd(s))gv(r,f);else{var m=s.alternate;if(s.lanes===0&&(m===null||m.lanes===0)&&(m=r.lastRenderedReducer,m!==null))try{var x=r.lastRenderedState,N=m(x,o);if(f.hasEagerState=!0,f.eagerState=N,Vr(N,x))return Ju(s,r,f,0),Qs===null&&Xu(),!1}catch{}if(o=Cf(s,r,f,c),o!==null)return Ir(o,s,c),yv(o,r,c),!0}return!1}function hm(s,r,o,c){if(c={lane:2,revertLane:qm(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},bd(s)){if(r)throw Error(i(479))}else r=Cf(s,o,c,2),r!==null&&Ir(r,s,2)}function bd(s){var r=s.alternate;return s===es||r!==null&&r===es}function gv(s,r){wl=dd=!0;var o=s.pending;o===null?r.next=r:(r.next=o.next,o.next=r),s.pending=r}function yv(s,r,o){if((o&4194048)!==0){var c=r.lanes;c&=s.pendingLanes,o|=c,r.lanes=o,Ts(s,o)}}var Nc={readContext:er,use:md,useCallback:vn,useContext:vn,useEffect:vn,useImperativeHandle:vn,useLayoutEffect:vn,useInsertionEffect:vn,useMemo:vn,useReducer:vn,useRef:vn,useState:vn,useDebugValue:vn,useDeferredValue:vn,useTransition:vn,useSyncExternalStore:vn,useId:vn,useHostTransitionStatus:vn,useFormState:vn,useActionState:vn,useOptimistic:vn,useMemoCache:vn,useCacheRefresh:vn};Nc.useEffectEvent=vn;var bv={readContext:er,use:md,useCallback:function(s,r){return yr().memoizedState=[s,r===void 0?null:r],s},useContext:er,useEffect:tv,useImperativeHandle:function(s,r,o){o=o!=null?o.concat([s]):null,gd(4194308,4,av.bind(null,r,s),o)},useLayoutEffect:function(s,r){return gd(4194308,4,s,r)},useInsertionEffect:function(s,r){gd(4,2,s,r)},useMemo:function(s,r){var o=yr();r=r===void 0?null:r;var c=s();if(Po){Le(!0);try{s()}finally{Le(!1)}}return o.memoizedState=[c,r],c},useReducer:function(s,r,o){var c=yr();if(o!==void 0){var f=o(r);if(Po){Le(!0);try{o(r)}finally{Le(!1)}}}else f=r;return c.memoizedState=c.baseState=f,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:f},c.queue=s,s=s.dispatch=ij.bind(null,es,s),[c.memoizedState,s]},useRef:function(s){var r=yr();return s={current:s},r.memoizedState=s},useState:function(s){s=am(s);var r=s.queue,o=pv.bind(null,es,r);return r.dispatch=o,[s.memoizedState,o]},useDebugValue:lm,useDeferredValue:function(s,r){var o=yr();return cm(o,s,r)},useTransition:function(){var s=am(!1);return s=uv.bind(null,es,s.queue,!0,!1),yr().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,r,o){var c=es,f=yr();if(xs){if(o===void 0)throw Error(i(407));o=o()}else{if(o=r(),Qs===null)throw Error(i(349));(ps&127)!==0||Bb(c,r,o)}f.memoizedState=o;var m={value:o,getSnapshot:r};return f.queue=m,tv(zb.bind(null,c,m,s),[s]),c.flags|=2048,kl(9,{destroy:void 0},Ub.bind(null,c,m,o,r),null),o},useId:function(){var s=yr(),r=Qs.identifierPrefix;if(xs){var o=Aa,c=Ra;o=(c&~(1<<32-De(c)-1)).toString(32)+o,r="_"+r+"R_"+o,o=hd++,0<o&&(r+="H"+o.toString(32)),r+="_"}else o=Zk++,r="_"+r+"r_"+o.toString(32)+"_";return s.memoizedState=r},useHostTransitionStatus:dm,useFormState:Qb,useActionState:Qb,useOptimistic:function(s){var r=yr();r.memoizedState=r.baseState=s;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=o,r=hm.bind(null,es,!0,o),o.dispatch=r,[s,r]},useMemoCache:sm,useCacheRefresh:function(){return yr().memoizedState=aj.bind(null,es)},useEffectEvent:function(s){var r=yr(),o={impl:s};return r.memoizedState=o,function(){if((Ls&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},fm={readContext:er,use:md,useCallback:ov,useContext:er,useEffect:om,useImperativeHandle:iv,useInsertionEffect:nv,useLayoutEffect:rv,useMemo:lv,useReducer:pd,useRef:ev,useState:function(){return pd(ei)},useDebugValue:lm,useDeferredValue:function(s,r){var o=Nn();return cv(o,qs.memoizedState,s,r)},useTransition:function(){var s=pd(ei)[0],r=Nn().memoizedState;return[typeof s=="boolean"?s:Tc(s),r]},useSyncExternalStore:Vb,useId:fv,useHostTransitionStatus:dm,useFormState:Xb,useActionState:Xb,useOptimistic:function(s,r){var o=Nn();return qb(o,qs,s,r)},useMemoCache:sm,useCacheRefresh:mv};fm.useEffectEvent=sv;var vv={readContext:er,use:md,useCallback:ov,useContext:er,useEffect:om,useImperativeHandle:iv,useInsertionEffect:nv,useLayoutEffect:rv,useMemo:lv,useReducer:rm,useRef:ev,useState:function(){return rm(ei)},useDebugValue:lm,useDeferredValue:function(s,r){var o=Nn();return qs===null?cm(o,s,r):cv(o,qs.memoizedState,s,r)},useTransition:function(){var s=rm(ei)[0],r=Nn().memoizedState;return[typeof s=="boolean"?s:Tc(s),r]},useSyncExternalStore:Vb,useId:fv,useHostTransitionStatus:dm,useFormState:Zb,useActionState:Zb,useOptimistic:function(s,r){var o=Nn();return qs!==null?qb(o,qs,s,r):(o.baseState=s,[s,o.queue.dispatch])},useMemoCache:sm,useCacheRefresh:mv};vv.useEffectEvent=sv;function mm(s,r,o,c){r=s.memoizedState,o=o(c,r),o=o==null?r:k({},r,o),s.memoizedState=o,s.lanes===0&&(s.updateQueue.baseState=o)}var pm={enqueueSetState:function(s,r,o){s=s._reactInternals;var c=qr(),f=Ri(c);f.payload=r,o!=null&&(f.callback=o),r=Ai(s,f,c),r!==null&&(Ir(r,s,c),wc(r,s,c))},enqueueReplaceState:function(s,r,o){s=s._reactInternals;var c=qr(),f=Ri(c);f.tag=1,f.payload=r,o!=null&&(f.callback=o),r=Ai(s,f,c),r!==null&&(Ir(r,s,c),wc(r,s,c))},enqueueForceUpdate:function(s,r){s=s._reactInternals;var o=qr(),c=Ri(o);c.tag=2,r!=null&&(c.callback=r),r=Ai(s,c,o),r!==null&&(Ir(r,s,o),wc(r,s,o))}};function xv(s,r,o,c,f,m,x){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(c,m,x):r.prototype&&r.prototype.isPureReactComponent?!fc(o,c)||!fc(f,m):!0}function wv(s,r,o,c){s=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(o,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(o,c),r.state!==s&&pm.enqueueReplaceState(r,r.state,null)}function Lo(s,r){var o=r;if("ref"in r){o={};for(var c in r)c!=="ref"&&(o[c]=r[c])}if(s=s.defaultProps){o===r&&(o=k({},o));for(var f in s)o[f]===void 0&&(o[f]=s[f])}return o}function _v(s){Qu(s)}function kv(s){console.error(s)}function jv(s){Qu(s)}function vd(s,r){try{var o=s.onUncaughtError;o(r.value,{componentStack:r.stack})}catch(c){setTimeout(function(){throw c})}}function Tv(s,r,o){try{var c=s.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function gm(s,r,o){return o=Ri(o),o.tag=3,o.payload={element:null},o.callback=function(){vd(s,r)},o}function Ev(s){return s=Ri(s),s.tag=3,s}function Nv(s,r,o,c){var f=o.type.getDerivedStateFromError;if(typeof f=="function"){var m=c.value;s.payload=function(){return f(m)},s.callback=function(){Tv(r,o,c)}}var x=o.stateNode;x!==null&&typeof x.componentDidCatch=="function"&&(s.callback=function(){Tv(r,o,c),typeof f!="function"&&(Oi===null?Oi=new Set([this]):Oi.add(this));var N=c.stack;this.componentDidCatch(c.value,{componentStack:N!==null?N:""})})}function oj(s,r,o,c,f){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(r=o.alternate,r!==null&&pl(r,o,f,!0),o=Ur.current,o!==null){switch(o.tag){case 31:case 13:return na===null?Ad():o.alternate===null&&xn===0&&(xn=3),o.flags&=-257,o.flags|=65536,o.lanes=f,c===id?o.flags|=16384:(r=o.updateQueue,r===null?o.updateQueue=new Set([c]):r.add(c),zm(s,c,f)),!1;case 22:return o.flags|=65536,c===id?o.flags|=16384:(r=o.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=r):(o=r.retryQueue,o===null?r.retryQueue=new Set([c]):o.add(c)),zm(s,c,f)),!1}throw Error(i(435,o.tag))}return zm(s,c,f),Ad(),!1}if(xs)return r=Ur.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=f,c!==Pf&&(s=Error(i(422),{cause:c}),gc(Zr(s,o)))):(c!==Pf&&(r=Error(i(423),{cause:c}),gc(Zr(r,o))),s=s.current.alternate,s.flags|=65536,f&=-f,s.lanes|=f,c=Zr(c,o),f=gm(s.stateNode,c,f),Wf(s,f),xn!==4&&(xn=2)),!1;var m=Error(i(520),{cause:c});if(m=Zr(m,o),Pc===null?Pc=[m]:Pc.push(m),xn!==4&&(xn=2),r===null)return!0;c=Zr(c,o),o=r;do{switch(o.tag){case 3:return o.flags|=65536,s=f&-f,o.lanes|=s,s=gm(o.stateNode,c,s),Wf(o,s),!1;case 1:if(r=o.type,m=o.stateNode,(o.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Oi===null||!Oi.has(m))))return o.flags|=65536,f&=-f,o.lanes|=f,f=Ev(f),Nv(f,s,o,c),Wf(o,f),!1}o=o.return}while(o!==null);return!1}var ym=Error(i(461)),Mn=!1;function tr(s,r,o,c){r.child=s===null?Ab(r,null,o,c):Do(r,s.child,o,c)}function Sv(s,r,o,c,f){o=o.render;var m=r.ref;if("ref"in c){var x={};for(var N in c)N!=="ref"&&(x[N]=c[N])}else x=c;return Ro(r),c=Jf(s,r,o,x,m,f),N=Zf(),s!==null&&!Mn?(em(s,r,f),ti(s,r,f)):(xs&&N&&Mf(r),r.flags|=1,tr(s,r,c,f),r.child)}function Cv(s,r,o,c,f){if(s===null){var m=o.type;return typeof m=="function"&&!Rf(m)&&m.defaultProps===void 0&&o.compare===null?(r.tag=15,r.type=m,Rv(s,r,m,c,f)):(s=ed(o.type,null,c,r,r.mode,f),s.ref=r.ref,s.return=r,r.child=s)}if(m=s.child,!Tm(s,f)){var x=m.memoizedProps;if(o=o.compare,o=o!==null?o:fc,o(x,c)&&s.ref===r.ref)return ti(s,r,f)}return r.flags|=1,s=Ya(m,c),s.ref=r.ref,s.return=r,r.child=s}function Rv(s,r,o,c,f){if(s!==null){var m=s.memoizedProps;if(fc(m,c)&&s.ref===r.ref)if(Mn=!1,r.pendingProps=c=m,Tm(s,f))(s.flags&131072)!==0&&(Mn=!0);else return r.lanes=s.lanes,ti(s,r,f)}return bm(s,r,o,c,f)}function Av(s,r,o,c){var f=c.children,m=s!==null?s.memoizedState:null;if(s===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((r.flags&128)!==0){if(m=m!==null?m.baseLanes|o:o,s!==null){for(c=r.child=s.child,f=0;c!==null;)f=f|c.lanes|c.childLanes,c=c.sibling;c=f&~m}else c=0,r.child=null;return Iv(s,r,m,o,c)}if((o&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},s!==null&&rd(r,m!==null?m.cachePool:null),m!==null?Db(r,m):Kf(),Pb(r);else return c=r.lanes=536870912,Iv(s,r,m!==null?m.baseLanes|o:o,o,c)}else m!==null?(rd(r,m.cachePool),Db(r,m),Mi(),r.memoizedState=null):(s!==null&&rd(r,null),Kf(),Mi());return tr(s,r,f,o),r.child}function Sc(s,r){return s!==null&&s.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function Iv(s,r,o,c,f){var m=Ff();return m=m===null?null:{parent:An._currentValue,pool:m},r.memoizedState={baseLanes:o,cachePool:m},s!==null&&rd(r,null),Kf(),Pb(r),s!==null&&pl(s,r,c,!0),r.childLanes=f,null}function xd(s,r){return r=_d({mode:r.mode,children:r.children},s.mode),r.ref=s.ref,s.child=r,r.return=s,r}function Mv(s,r,o){return Do(r,s.child,null,o),s=xd(r,r.pendingProps),s.flags|=2,zr(r),r.memoizedState=null,s}function lj(s,r,o){var c=r.pendingProps,f=(r.flags&128)!==0;if(r.flags&=-129,s===null){if(xs){if(c.mode==="hidden")return s=xd(r,c),r.lanes=536870912,Sc(null,s);if(Qf(r),(s=rn)?(s=$0(s,sa),s=s!==null&&s.data==="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:Ti!==null?{id:Ra,overflow:Aa}:null,retryLane:536870912,hydrationErrors:null},o=gb(s),o.return=r,r.child=o,Zn=r,rn=null)):s=null,s===null)throw Ni(r);return r.lanes=536870912,null}return xd(r,c)}var m=s.memoizedState;if(m!==null){var x=m.dehydrated;if(Qf(r),f)if(r.flags&256)r.flags&=-257,r=Mv(s,r,o);else if(r.memoizedState!==null)r.child=s.child,r.flags|=128,r=null;else throw Error(i(558));else if(Mn||pl(s,r,o,!1),f=(o&s.childLanes)!==0,Mn||f){if(c=Qs,c!==null&&(x=As(c,o),x!==0&&x!==m.retryLane))throw m.retryLane=x,Eo(s,x),Ir(c,s,x),ym;Ad(),r=Mv(s,r,o)}else s=m.treeContext,rn=ra(x.nextSibling),Zn=r,xs=!0,Ei=null,sa=!1,s!==null&&vb(r,s),r=xd(r,c),r.flags|=4096;return r}return s=Ya(s.child,{mode:c.mode,children:c.children}),s.ref=r.ref,r.child=s,s.return=r,s}function wd(s,r){var o=r.ref;if(o===null)s!==null&&s.ref!==null&&(r.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(s===null||s.ref!==o)&&(r.flags|=4194816)}}function bm(s,r,o,c,f){return Ro(r),o=Jf(s,r,o,c,void 0,f),c=Zf(),s!==null&&!Mn?(em(s,r,f),ti(s,r,f)):(xs&&c&&Mf(r),r.flags|=1,tr(s,r,o,f),r.child)}function Dv(s,r,o,c,f,m){return Ro(r),r.updateQueue=null,o=Ob(r,c,o,f),Lb(s),c=Zf(),s!==null&&!Mn?(em(s,r,m),ti(s,r,m)):(xs&&c&&Mf(r),r.flags|=1,tr(s,r,o,m),r.child)}function Pv(s,r,o,c,f){if(Ro(r),r.stateNode===null){var m=dl,x=o.contextType;typeof x=="object"&&x!==null&&(m=er(x)),m=new o(c,m),r.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=pm,r.stateNode=m,m._reactInternals=r,m=r.stateNode,m.props=c,m.state=r.memoizedState,m.refs={},qf(r),x=o.contextType,m.context=typeof x=="object"&&x!==null?er(x):dl,m.state=r.memoizedState,x=o.getDerivedStateFromProps,typeof x=="function"&&(mm(r,o,x,c),m.state=r.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(x=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),x!==m.state&&pm.enqueueReplaceState(m,m.state,null),kc(r,c,m,f),_c(),m.state=r.memoizedState),typeof m.componentDidMount=="function"&&(r.flags|=4194308),c=!0}else if(s===null){m=r.stateNode;var N=r.memoizedProps,U=Lo(o,N);m.props=U;var oe=m.context,ke=o.contextType;x=dl,typeof ke=="object"&&ke!==null&&(x=er(ke));var Ce=o.getDerivedStateFromProps;ke=typeof Ce=="function"||typeof m.getSnapshotBeforeUpdate=="function",N=r.pendingProps!==N,ke||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(N||oe!==x)&&wv(r,m,c,x),Ci=!1;var ce=r.memoizedState;m.state=ce,kc(r,c,m,f),_c(),oe=r.memoizedState,N||ce!==oe||Ci?(typeof Ce=="function"&&(mm(r,o,Ce,c),oe=r.memoizedState),(U=Ci||xv(r,o,U,c,ce,oe,x))?(ke||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(r.flags|=4194308)):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=oe),m.props=c,m.state=oe,m.context=x,c=U):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{m=r.stateNode,$f(s,r),x=r.memoizedProps,ke=Lo(o,x),m.props=ke,Ce=r.pendingProps,ce=m.context,oe=o.contextType,U=dl,typeof oe=="object"&&oe!==null&&(U=er(oe)),N=o.getDerivedStateFromProps,(oe=typeof N=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(x!==Ce||ce!==U)&&wv(r,m,c,U),Ci=!1,ce=r.memoizedState,m.state=ce,kc(r,c,m,f),_c();var me=r.memoizedState;x!==Ce||ce!==me||Ci||s!==null&&s.dependencies!==null&&sd(s.dependencies)?(typeof N=="function"&&(mm(r,o,N,c),me=r.memoizedState),(ke=Ci||xv(r,o,ke,c,ce,me,U)||s!==null&&s.dependencies!==null&&sd(s.dependencies))?(oe||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(c,me,U),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(c,me,U)),typeof m.componentDidUpdate=="function"&&(r.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof m.componentDidUpdate!="function"||x===s.memoizedProps&&ce===s.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||x===s.memoizedProps&&ce===s.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=me),m.props=c,m.state=me,m.context=U,c=ke):(typeof m.componentDidUpdate!="function"||x===s.memoizedProps&&ce===s.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||x===s.memoizedProps&&ce===s.memoizedState||(r.flags|=1024),c=!1)}return m=c,wd(s,r),c=(r.flags&128)!==0,m||c?(m=r.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:m.render(),r.flags|=1,s!==null&&c?(r.child=Do(r,s.child,null,f),r.child=Do(r,null,o,f)):tr(s,r,o,f),r.memoizedState=m.state,s=r.child):s=ti(s,r,f),s}function Lv(s,r,o,c){return So(),r.flags|=256,tr(s,r,o,c),r.child}var vm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function xm(s){return{baseLanes:s,cachePool:Tb()}}function wm(s,r,o){return s=s!==null?s.childLanes&~o:0,r&&(s|=Hr),s}function Ov(s,r,o){var c=r.pendingProps,f=!1,m=(r.flags&128)!==0,x;if((x=m)||(x=s!==null&&s.memoizedState===null?!1:(En.current&2)!==0),x&&(f=!0,r.flags&=-129),x=(r.flags&32)!==0,r.flags&=-33,s===null){if(xs){if(f?Ii(r):Mi(),(s=rn)?(s=$0(s,sa),s=s!==null&&s.data!=="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:Ti!==null?{id:Ra,overflow:Aa}:null,retryLane:536870912,hydrationErrors:null},o=gb(s),o.return=r,r.child=o,Zn=r,rn=null)):s=null,s===null)throw Ni(r);return np(s)?r.lanes=32:r.lanes=536870912,null}var N=c.children;return c=c.fallback,f?(Mi(),f=r.mode,N=_d({mode:"hidden",children:N},f),c=No(c,f,o,null),N.return=r,c.return=r,N.sibling=c,r.child=N,c=r.child,c.memoizedState=xm(o),c.childLanes=wm(s,x,o),r.memoizedState=vm,Sc(null,c)):(Ii(r),_m(r,N))}var U=s.memoizedState;if(U!==null&&(N=U.dehydrated,N!==null)){if(m)r.flags&256?(Ii(r),r.flags&=-257,r=km(s,r,o)):r.memoizedState!==null?(Mi(),r.child=s.child,r.flags|=128,r=null):(Mi(),N=c.fallback,f=r.mode,c=_d({mode:"visible",children:c.children},f),N=No(N,f,o,null),N.flags|=2,c.return=r,N.return=r,c.sibling=N,r.child=c,Do(r,s.child,null,o),c=r.child,c.memoizedState=xm(o),c.childLanes=wm(s,x,o),r.memoizedState=vm,r=Sc(null,c));else if(Ii(r),np(N)){if(x=N.nextSibling&&N.nextSibling.dataset,x)var oe=x.dgst;x=oe,c=Error(i(419)),c.stack="",c.digest=x,gc({value:c,source:null,stack:null}),r=km(s,r,o)}else if(Mn||pl(s,r,o,!1),x=(o&s.childLanes)!==0,Mn||x){if(x=Qs,x!==null&&(c=As(x,o),c!==0&&c!==U.retryLane))throw U.retryLane=c,Eo(s,c),Ir(x,s,c),ym;sp(N)||Ad(),r=km(s,r,o)}else sp(N)?(r.flags|=192,r.child=s.child,r=null):(s=U.treeContext,rn=ra(N.nextSibling),Zn=r,xs=!0,Ei=null,sa=!1,s!==null&&vb(r,s),r=_m(r,c.children),r.flags|=4096);return r}return f?(Mi(),N=c.fallback,f=r.mode,U=s.child,oe=U.sibling,c=Ya(U,{mode:"hidden",children:c.children}),c.subtreeFlags=U.subtreeFlags&65011712,oe!==null?N=Ya(oe,N):(N=No(N,f,o,null),N.flags|=2),N.return=r,c.return=r,c.sibling=N,r.child=c,Sc(null,c),c=r.child,N=s.child.memoizedState,N===null?N=xm(o):(f=N.cachePool,f!==null?(U=An._currentValue,f=f.parent!==U?{parent:U,pool:U}:f):f=Tb(),N={baseLanes:N.baseLanes|o,cachePool:f}),c.memoizedState=N,c.childLanes=wm(s,x,o),r.memoizedState=vm,Sc(s.child,c)):(Ii(r),o=s.child,s=o.sibling,o=Ya(o,{mode:"visible",children:c.children}),o.return=r,o.sibling=null,s!==null&&(x=r.deletions,x===null?(r.deletions=[s],r.flags|=16):x.push(s)),r.child=o,r.memoizedState=null,o)}function _m(s,r){return r=_d({mode:"visible",children:r},s.mode),r.return=s,s.child=r}function _d(s,r){return s=Br(22,s,null,r),s.lanes=0,s}function km(s,r,o){return Do(r,s.child,null,o),s=_m(r,r.pendingProps.children),s.flags|=2,r.memoizedState=null,s}function Vv(s,r,o){s.lanes|=r;var c=s.alternate;c!==null&&(c.lanes|=r),Vf(s.return,r,o)}function jm(s,r,o,c,f,m){var x=s.memoizedState;x===null?s.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:f,treeForkCount:m}:(x.isBackwards=r,x.rendering=null,x.renderingStartTime=0,x.last=c,x.tail=o,x.tailMode=f,x.treeForkCount=m)}function Bv(s,r,o){var c=r.pendingProps,f=c.revealOrder,m=c.tail;c=c.children;var x=En.current,N=(x&2)!==0;if(N?(x=x&1|2,r.flags|=128):x&=1,Se(En,x),tr(s,r,c,o),c=xs?pc:0,!N&&s!==null&&(s.flags&128)!==0)e:for(s=r.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Vv(s,o,r);else if(s.tag===19)Vv(s,o,r);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(f){case"forwards":for(o=r.child,f=null;o!==null;)s=o.alternate,s!==null&&ud(s)===null&&(f=o),o=o.sibling;o=f,o===null?(f=r.child,r.child=null):(f=o.sibling,o.sibling=null),jm(r,!1,f,o,m,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,f=r.child,r.child=null;f!==null;){if(s=f.alternate,s!==null&&ud(s)===null){r.child=f;break}s=f.sibling,f.sibling=o,o=f,f=s}jm(r,!0,o,null,m,c);break;case"together":jm(r,!1,null,null,void 0,c);break;default:r.memoizedState=null}return r.child}function ti(s,r,o){if(s!==null&&(r.dependencies=s.dependencies),Li|=r.lanes,(o&r.childLanes)===0)if(s!==null){if(pl(s,r,o,!1),(o&r.childLanes)===0)return null}else return null;if(s!==null&&r.child!==s.child)throw Error(i(153));if(r.child!==null){for(s=r.child,o=Ya(s,s.pendingProps),r.child=o,o.return=r;s.sibling!==null;)s=s.sibling,o=o.sibling=Ya(s,s.pendingProps),o.return=r;o.sibling=null}return r.child}function Tm(s,r){return(s.lanes&r)!==0?!0:(s=s.dependencies,!!(s!==null&&sd(s)))}function cj(s,r,o){switch(r.tag){case 3:Tt(r,r.stateNode.containerInfo),Si(r,An,s.memoizedState.cache),So();break;case 27:case 5:Wt(r);break;case 4:Tt(r,r.stateNode.containerInfo);break;case 10:Si(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,Qf(r),null;break;case 13:var c=r.memoizedState;if(c!==null)return c.dehydrated!==null?(Ii(r),r.flags|=128,null):(o&r.child.childLanes)!==0?Ov(s,r,o):(Ii(r),s=ti(s,r,o),s!==null?s.sibling:null);Ii(r);break;case 19:var f=(s.flags&128)!==0;if(c=(o&r.childLanes)!==0,c||(pl(s,r,o,!1),c=(o&r.childLanes)!==0),f){if(c)return Bv(s,r,o);r.flags|=128}if(f=r.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),Se(En,En.current),c)break;return null;case 22:return r.lanes=0,Av(s,r,o,r.pendingProps);case 24:Si(r,An,s.memoizedState.cache)}return ti(s,r,o)}function Uv(s,r,o){if(s!==null)if(s.memoizedProps!==r.pendingProps)Mn=!0;else{if(!Tm(s,o)&&(r.flags&128)===0)return Mn=!1,cj(s,r,o);Mn=(s.flags&131072)!==0}else Mn=!1,xs&&(r.flags&1048576)!==0&&bb(r,pc,r.index);switch(r.lanes=0,r.tag){case 16:e:{var c=r.pendingProps;if(s=Io(r.elementType),r.type=s,typeof s=="function")Rf(s)?(c=Lo(s,c),r.tag=1,r=Pv(null,r,s,c,o)):(r.tag=0,r=bm(null,r,s,c,o));else{if(s!=null){var f=s.$$typeof;if(f===ge){r.tag=11,r=Sv(null,r,s,c,o);break e}else if(f===R){r.tag=14,r=Cv(null,r,s,c,o);break e}}throw r=$e(s)||s,Error(i(306,r,""))}}return r;case 0:return bm(s,r,r.type,r.pendingProps,o);case 1:return c=r.type,f=Lo(c,r.pendingProps),Pv(s,r,c,f,o);case 3:e:{if(Tt(r,r.stateNode.containerInfo),s===null)throw Error(i(387));c=r.pendingProps;var m=r.memoizedState;f=m.element,$f(s,r),kc(r,c,null,o);var x=r.memoizedState;if(c=x.cache,Si(r,An,c),c!==m.cache&&Bf(r,[An],o,!0),_c(),c=x.element,m.isDehydrated)if(m={element:c,isDehydrated:!1,cache:x.cache},r.updateQueue.baseState=m,r.memoizedState=m,r.flags&256){r=Lv(s,r,c,o);break e}else if(c!==f){f=Zr(Error(i(424)),r),gc(f),r=Lv(s,r,c,o);break e}else for(s=r.stateNode.containerInfo,s.nodeType===9?s=s.body:s=s.nodeName==="HTML"?s.ownerDocument.body:s,rn=ra(s.firstChild),Zn=r,xs=!0,Ei=null,sa=!0,o=Ab(r,null,c,o),r.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(So(),c===f){r=ti(s,r,o);break e}tr(s,r,c,o)}r=r.child}return r;case 26:return wd(s,r),s===null?(o=X0(r.type,null,r.pendingProps,null))?r.memoizedState=o:xs||(o=r.type,s=r.pendingProps,c=Vd(Ue.current).createElement(o),c[it]=r,c[Rt]=s,sr(c,o,s),S(c),r.stateNode=c):r.memoizedState=X0(r.type,s.memoizedProps,r.pendingProps,s.memoizedState),null;case 27:return Wt(r),s===null&&xs&&(c=r.stateNode=K0(r.type,r.pendingProps,Ue.current),Zn=r,sa=!0,f=rn,zi(r.type)?(rp=f,rn=ra(c.firstChild)):rn=f),tr(s,r,r.pendingProps.children,o),wd(s,r),s===null&&(r.flags|=4194304),r.child;case 5:return s===null&&xs&&((f=c=rn)&&(c=Bj(c,r.type,r.pendingProps,sa),c!==null?(r.stateNode=c,Zn=r,rn=ra(c.firstChild),sa=!1,f=!0):f=!1),f||Ni(r)),Wt(r),f=r.type,m=r.pendingProps,x=s!==null?s.memoizedProps:null,c=m.children,Zm(f,m)?c=null:x!==null&&Zm(f,x)&&(r.flags|=32),r.memoizedState!==null&&(f=Jf(s,r,ej,null,null,o),Hc._currentValue=f),wd(s,r),tr(s,r,c,o),r.child;case 6:return s===null&&xs&&((s=o=rn)&&(o=Uj(o,r.pendingProps,sa),o!==null?(r.stateNode=o,Zn=r,rn=null,s=!0):s=!1),s||Ni(r)),null;case 13:return Ov(s,r,o);case 4:return Tt(r,r.stateNode.containerInfo),c=r.pendingProps,s===null?r.child=Do(r,null,c,o):tr(s,r,c,o),r.child;case 11:return Sv(s,r,r.type,r.pendingProps,o);case 7:return tr(s,r,r.pendingProps,o),r.child;case 8:return tr(s,r,r.pendingProps.children,o),r.child;case 12:return tr(s,r,r.pendingProps.children,o),r.child;case 10:return c=r.pendingProps,Si(r,r.type,c.value),tr(s,r,c.children,o),r.child;case 9:return f=r.type._context,c=r.pendingProps.children,Ro(r),f=er(f),c=c(f),r.flags|=1,tr(s,r,c,o),r.child;case 14:return Cv(s,r,r.type,r.pendingProps,o);case 15:return Rv(s,r,r.type,r.pendingProps,o);case 19:return Bv(s,r,o);case 31:return lj(s,r,o);case 22:return Av(s,r,o,r.pendingProps);case 24:return Ro(r),c=er(An),s===null?(f=Ff(),f===null&&(f=Qs,m=Uf(),f.pooledCache=m,m.refCount++,m!==null&&(f.pooledCacheLanes|=o),f=m),r.memoizedState={parent:c,cache:f},qf(r),Si(r,An,f)):((s.lanes&o)!==0&&($f(s,r),kc(r,null,null,o),_c()),f=s.memoizedState,m=r.memoizedState,f.parent!==c?(f={parent:c,cache:c},r.memoizedState=f,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=f),Si(r,An,c)):(c=m.cache,Si(r,An,c),c!==f.cache&&Bf(r,[An],o,!0))),tr(s,r,r.pendingProps.children,o),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function si(s){s.flags|=4}function Em(s,r,o,c,f){if((r=(s.mode&32)!==0)&&(r=!1),r){if(s.flags|=16777216,(f&335544128)===f)if(s.stateNode.complete)s.flags|=8192;else if(f0())s.flags|=8192;else throw Mo=id,Hf}else s.flags&=-16777217}function zv(s,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!s1(r))if(f0())s.flags|=8192;else throw Mo=id,Hf}function kd(s,r){r!==null&&(s.flags|=4),s.flags&16384&&(r=s.tag!==22?Xt():536870912,s.lanes|=r,Nl|=r)}function Cc(s,r){if(!xs)switch(s.tailMode){case"hidden":r=s.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?s.tail=null:o.sibling=null;break;case"collapsed":o=s.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?r||s.tail===null?s.tail=null:s.tail.sibling=null:c.sibling=null}}function an(s){var r=s.alternate!==null&&s.alternate.child===s.child,o=0,c=0;if(r)for(var f=s.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags&65011712,c|=f.flags&65011712,f.return=s,f=f.sibling;else for(f=s.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags,c|=f.flags,f.return=s,f=f.sibling;return s.subtreeFlags|=c,s.childLanes=o,r}function uj(s,r,o){var c=r.pendingProps;switch(Df(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return an(r),null;case 1:return an(r),null;case 3:return o=r.stateNode,c=null,s!==null&&(c=s.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),Ja(An),rt(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(s===null||s.child===null)&&(ml(r)?si(r):s===null||s.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Lf())),an(r),null;case 26:var f=r.type,m=r.memoizedState;return s===null?(si(r),m!==null?(an(r),zv(r,m)):(an(r),Em(r,f,null,c,o))):m?m!==s.memoizedState?(si(r),an(r),zv(r,m)):(an(r),r.flags&=-16777217):(s=s.memoizedProps,s!==c&&si(r),an(r),Em(r,f,s,c,o)),null;case 27:if(js(r),o=Ue.current,f=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==c&&si(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return an(r),null}s=Oe.current,ml(r)?xb(r):(s=K0(f,c,o),r.stateNode=s,si(r))}return an(r),null;case 5:if(js(r),f=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==c&&si(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return an(r),null}if(m=Oe.current,ml(r))xb(r);else{var x=Vd(Ue.current);switch(m){case 1:m=x.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:m=x.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":m=x.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":m=x.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":m=x.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild);break;case"select":m=typeof c.is=="string"?x.createElement("select",{is:c.is}):x.createElement("select"),c.multiple?m.multiple=!0:c.size&&(m.size=c.size);break;default:m=typeof c.is=="string"?x.createElement(f,{is:c.is}):x.createElement(f)}}m[it]=r,m[Rt]=c;e:for(x=r.child;x!==null;){if(x.tag===5||x.tag===6)m.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===r)break e;for(;x.sibling===null;){if(x.return===null||x.return===r)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}r.stateNode=m;e:switch(sr(m,f,c),f){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&si(r)}}return an(r),Em(r,r.type,s===null?null:s.memoizedProps,r.pendingProps,o),null;case 6:if(s&&r.stateNode!=null)s.memoizedProps!==c&&si(r);else{if(typeof c!="string"&&r.stateNode===null)throw Error(i(166));if(s=Ue.current,ml(r)){if(s=r.stateNode,o=r.memoizedProps,c=null,f=Zn,f!==null)switch(f.tag){case 27:case 5:c=f.memoizedProps}s[it]=r,s=!!(s.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||O0(s.nodeValue,o)),s||Ni(r,!0)}else s=Vd(s).createTextNode(c),s[it]=r,r.stateNode=s}return an(r),null;case 31:if(o=r.memoizedState,s===null||s.memoizedState!==null){if(c=ml(r),o!==null){if(s===null){if(!c)throw Error(i(318));if(s=r.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[it]=r}else So(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;an(r),s=!1}else o=Lf(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=o),s=!0;if(!s)return r.flags&256?(zr(r),r):(zr(r),null);if((r.flags&128)!==0)throw Error(i(558))}return an(r),null;case 13:if(c=r.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(f=ml(r),c!==null&&c.dehydrated!==null){if(s===null){if(!f)throw Error(i(318));if(f=r.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(i(317));f[it]=r}else So(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;an(r),f=!1}else f=Lf(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=f),f=!0;if(!f)return r.flags&256?(zr(r),r):(zr(r),null)}return zr(r),(r.flags&128)!==0?(r.lanes=o,r):(o=c!==null,s=s!==null&&s.memoizedState!==null,o&&(c=r.child,f=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(f=c.alternate.memoizedState.cachePool.pool),m=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(m=c.memoizedState.cachePool.pool),m!==f&&(c.flags|=2048)),o!==s&&o&&(r.child.flags|=8192),kd(r,r.updateQueue),an(r),null);case 4:return rt(),s===null&&Km(r.stateNode.containerInfo),an(r),null;case 10:return Ja(r.type),an(r),null;case 19:if(se(En),c=r.memoizedState,c===null)return an(r),null;if(f=(r.flags&128)!==0,m=c.rendering,m===null)if(f)Cc(c,!1);else{if(xn!==0||s!==null&&(s.flags&128)!==0)for(s=r.child;s!==null;){if(m=ud(s),m!==null){for(r.flags|=128,Cc(c,!1),s=m.updateQueue,r.updateQueue=s,kd(r,s),r.subtreeFlags=0,s=o,o=r.child;o!==null;)pb(o,s),o=o.sibling;return Se(En,En.current&1|2),xs&&Qa(r,c.treeForkCount),r.child}s=s.sibling}c.tail!==null&&as()>Sd&&(r.flags|=128,f=!0,Cc(c,!1),r.lanes=4194304)}else{if(!f)if(s=ud(m),s!==null){if(r.flags|=128,f=!0,s=s.updateQueue,r.updateQueue=s,kd(r,s),Cc(c,!0),c.tail===null&&c.tailMode==="hidden"&&!m.alternate&&!xs)return an(r),null}else 2*as()-c.renderingStartTime>Sd&&o!==536870912&&(r.flags|=128,f=!0,Cc(c,!1),r.lanes=4194304);c.isBackwards?(m.sibling=r.child,r.child=m):(s=c.last,s!==null?s.sibling=m:r.child=m,c.last=m)}return c.tail!==null?(s=c.tail,c.rendering=s,c.tail=s.sibling,c.renderingStartTime=as(),s.sibling=null,o=En.current,Se(En,f?o&1|2:o&1),xs&&Qa(r,c.treeForkCount),s):(an(r),null);case 22:case 23:return zr(r),Yf(),c=r.memoizedState!==null,s!==null?s.memoizedState!==null!==c&&(r.flags|=8192):c&&(r.flags|=8192),c?(o&536870912)!==0&&(r.flags&128)===0&&(an(r),r.subtreeFlags&6&&(r.flags|=8192)):an(r),o=r.updateQueue,o!==null&&kd(r,o.retryQueue),o=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),c=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),c!==o&&(r.flags|=2048),s!==null&&se(Ao),null;case 24:return o=null,s!==null&&(o=s.memoizedState.cache),r.memoizedState.cache!==o&&(r.flags|=2048),Ja(An),an(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function dj(s,r){switch(Df(r),r.tag){case 1:return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 3:return Ja(An),rt(),s=r.flags,(s&65536)!==0&&(s&128)===0?(r.flags=s&-65537|128,r):null;case 26:case 27:case 5:return js(r),null;case 31:if(r.memoizedState!==null){if(zr(r),r.alternate===null)throw Error(i(340));So()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 13:if(zr(r),s=r.memoizedState,s!==null&&s.dehydrated!==null){if(r.alternate===null)throw Error(i(340));So()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 19:return se(En),null;case 4:return rt(),null;case 10:return Ja(r.type),null;case 22:case 23:return zr(r),Yf(),s!==null&&se(Ao),s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 24:return Ja(An),null;case 25:return null;default:return null}}function Fv(s,r){switch(Df(r),r.tag){case 3:Ja(An),rt();break;case 26:case 27:case 5:js(r);break;case 4:rt();break;case 31:r.memoizedState!==null&&zr(r);break;case 13:zr(r);break;case 19:se(En);break;case 10:Ja(r.type);break;case 22:case 23:zr(r),Yf(),s!==null&&se(Ao);break;case 24:Ja(An)}}function Rc(s,r){try{var o=r.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var f=c.next;o=f;do{if((o.tag&s)===s){c=void 0;var m=o.create,x=o.inst;c=m(),x.destroy=c}o=o.next}while(o!==f)}}catch(N){Fs(r,r.return,N)}}function Di(s,r,o){try{var c=r.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var m=f.next;c=m;do{if((c.tag&s)===s){var x=c.inst,N=x.destroy;if(N!==void 0){x.destroy=void 0,f=r;var U=o,oe=N;try{oe()}catch(ke){Fs(f,U,ke)}}}c=c.next}while(c!==m)}}catch(ke){Fs(r,r.return,ke)}}function Hv(s){var r=s.updateQueue;if(r!==null){var o=s.stateNode;try{Mb(r,o)}catch(c){Fs(s,s.return,c)}}}function qv(s,r,o){o.props=Lo(s.type,s.memoizedProps),o.state=s.memoizedState;try{o.componentWillUnmount()}catch(c){Fs(s,r,c)}}function Ac(s,r){try{var o=s.ref;if(o!==null){switch(s.tag){case 26:case 27:case 5:var c=s.stateNode;break;case 30:c=s.stateNode;break;default:c=s.stateNode}typeof o=="function"?s.refCleanup=o(c):o.current=c}}catch(f){Fs(s,r,f)}}function Ia(s,r){var o=s.ref,c=s.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(f){Fs(s,r,f)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(f){Fs(s,r,f)}else o.current=null}function $v(s){var r=s.type,o=s.memoizedProps,c=s.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(f){Fs(s,s.return,f)}}function Nm(s,r,o){try{var c=s.stateNode;Mj(c,s.type,o,r),c[Rt]=r}catch(f){Fs(s,s.return,f)}}function Wv(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&zi(s.type)||s.tag===4}function Sm(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Wv(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&zi(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Cm(s,r,o){var c=s.tag;if(c===5||c===6)s=s.stateNode,r?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(s,r):(r=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,r.appendChild(s),o=o._reactRootContainer,o!=null||r.onclick!==null||(r.onclick=Zs));else if(c!==4&&(c===27&&zi(s.type)&&(o=s.stateNode,r=null),s=s.child,s!==null))for(Cm(s,r,o),s=s.sibling;s!==null;)Cm(s,r,o),s=s.sibling}function jd(s,r,o){var c=s.tag;if(c===5||c===6)s=s.stateNode,r?o.insertBefore(s,r):o.appendChild(s);else if(c!==4&&(c===27&&zi(s.type)&&(o=s.stateNode),s=s.child,s!==null))for(jd(s,r,o),s=s.sibling;s!==null;)jd(s,r,o),s=s.sibling}function Gv(s){var r=s.stateNode,o=s.memoizedProps;try{for(var c=s.type,f=r.attributes;f.length;)r.removeAttributeNode(f[0]);sr(r,c,o),r[it]=s,r[Rt]=o}catch(m){Fs(s,s.return,m)}}var ni=!1,Dn=!1,Rm=!1,Kv=typeof WeakSet=="function"?WeakSet:Set,qn=null;function hj(s,r){if(s=s.containerInfo,Xm=$d,s=ib(s),kf(s)){if("selectionStart"in s)var o={start:s.selectionStart,end:s.selectionEnd};else e:{o=(o=s.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var f=c.anchorOffset,m=c.focusNode;c=c.focusOffset;try{o.nodeType,m.nodeType}catch{o=null;break e}var x=0,N=-1,U=-1,oe=0,ke=0,Ce=s,ce=null;t:for(;;){for(var me;Ce!==o||f!==0&&Ce.nodeType!==3||(N=x+f),Ce!==m||c!==0&&Ce.nodeType!==3||(U=x+c),Ce.nodeType===3&&(x+=Ce.nodeValue.length),(me=Ce.firstChild)!==null;)ce=Ce,Ce=me;for(;;){if(Ce===s)break t;if(ce===o&&++oe===f&&(N=x),ce===m&&++ke===c&&(U=x),(me=Ce.nextSibling)!==null)break;Ce=ce,ce=Ce.parentNode}Ce=me}o=N===-1||U===-1?null:{start:N,end:U}}else o=null}o=o||{start:0,end:0}}else o=null;for(Jm={focusedElem:s,selectionRange:o},$d=!1,qn=r;qn!==null;)if(r=qn,s=r.child,(r.subtreeFlags&1028)!==0&&s!==null)s.return=r,qn=s;else for(;qn!==null;){switch(r=qn,m=r.alternate,s=r.flags,r.tag){case 0:if((s&4)!==0&&(s=r.updateQueue,s=s!==null?s.events:null,s!==null))for(o=0;o<s.length;o++)f=s[o],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&m!==null){s=void 0,o=r,f=m.memoizedProps,m=m.memoizedState,c=o.stateNode;try{var ht=Lo(o.type,f);s=c.getSnapshotBeforeUpdate(ht,m),c.__reactInternalSnapshotBeforeUpdate=s}catch(Dt){Fs(o,o.return,Dt)}}break;case 3:if((s&1024)!==0){if(s=r.stateNode.containerInfo,o=s.nodeType,o===9)tp(s);else if(o===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":tp(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=r.sibling,s!==null){s.return=r.return,qn=s;break}qn=r.return}}function Yv(s,r,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:ai(s,o),c&4&&Rc(5,o);break;case 1:if(ai(s,o),c&4)if(s=o.stateNode,r===null)try{s.componentDidMount()}catch(x){Fs(o,o.return,x)}else{var f=Lo(o.type,r.memoizedProps);r=r.memoizedState;try{s.componentDidUpdate(f,r,s.__reactInternalSnapshotBeforeUpdate)}catch(x){Fs(o,o.return,x)}}c&64&&Hv(o),c&512&&Ac(o,o.return);break;case 3:if(ai(s,o),c&64&&(s=o.updateQueue,s!==null)){if(r=null,o.child!==null)switch(o.child.tag){case 27:case 5:r=o.child.stateNode;break;case 1:r=o.child.stateNode}try{Mb(s,r)}catch(x){Fs(o,o.return,x)}}break;case 27:r===null&&c&4&&Gv(o);case 26:case 5:ai(s,o),r===null&&c&4&&$v(o),c&512&&Ac(o,o.return);break;case 12:ai(s,o);break;case 31:ai(s,o),c&4&&Jv(s,o);break;case 13:ai(s,o),c&4&&Zv(s,o),c&64&&(s=o.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(o=wj.bind(null,o),zj(s,o))));break;case 22:if(c=o.memoizedState!==null||ni,!c){r=r!==null&&r.memoizedState!==null||Dn,f=ni;var m=Dn;ni=c,(Dn=r)&&!m?ii(s,o,(o.subtreeFlags&8772)!==0):ai(s,o),ni=f,Dn=m}break;case 30:break;default:ai(s,o)}}function Qv(s){var r=s.alternate;r!==null&&(s.alternate=null,Qv(r)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(r=s.stateNode,r!==null&&fn(r)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var un=null,Sr=!1;function ri(s,r,o){for(o=o.child;o!==null;)Xv(s,r,o),o=o.sibling}function Xv(s,r,o){if(Ve&&typeof Ve.onCommitFiberUnmount=="function")try{Ve.onCommitFiberUnmount(Ye,o)}catch{}switch(o.tag){case 26:Dn||Ia(o,r),ri(s,r,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Dn||Ia(o,r);var c=un,f=Sr;zi(o.type)&&(un=o.stateNode,Sr=!1),ri(s,r,o),Uc(o.stateNode),un=c,Sr=f;break;case 5:Dn||Ia(o,r);case 6:if(c=un,f=Sr,un=null,ri(s,r,o),un=c,Sr=f,un!==null)if(Sr)try{(un.nodeType===9?un.body:un.nodeName==="HTML"?un.ownerDocument.body:un).removeChild(o.stateNode)}catch(m){Fs(o,r,m)}else try{un.removeChild(o.stateNode)}catch(m){Fs(o,r,m)}break;case 18:un!==null&&(Sr?(s=un,H0(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,o.stateNode),Pl(s)):H0(un,o.stateNode));break;case 4:c=un,f=Sr,un=o.stateNode.containerInfo,Sr=!0,ri(s,r,o),un=c,Sr=f;break;case 0:case 11:case 14:case 15:Di(2,o,r),Dn||Di(4,o,r),ri(s,r,o);break;case 1:Dn||(Ia(o,r),c=o.stateNode,typeof c.componentWillUnmount=="function"&&qv(o,r,c)),ri(s,r,o);break;case 21:ri(s,r,o);break;case 22:Dn=(c=Dn)||o.memoizedState!==null,ri(s,r,o),Dn=c;break;default:ri(s,r,o)}}function Jv(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Pl(s)}catch(o){Fs(r,r.return,o)}}}function Zv(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Pl(s)}catch(o){Fs(r,r.return,o)}}function fj(s){switch(s.tag){case 31:case 13:case 19:var r=s.stateNode;return r===null&&(r=s.stateNode=new Kv),r;case 22:return s=s.stateNode,r=s._retryCache,r===null&&(r=s._retryCache=new Kv),r;default:throw Error(i(435,s.tag))}}function Td(s,r){var o=fj(s);r.forEach(function(c){if(!o.has(c)){o.add(c);var f=_j.bind(null,s,c);c.then(f,f)}})}function Cr(s,r){var o=r.deletions;if(o!==null)for(var c=0;c<o.length;c++){var f=o[c],m=s,x=r,N=x;e:for(;N!==null;){switch(N.tag){case 27:if(zi(N.type)){un=N.stateNode,Sr=!1;break e}break;case 5:un=N.stateNode,Sr=!1;break e;case 3:case 4:un=N.stateNode.containerInfo,Sr=!0;break e}N=N.return}if(un===null)throw Error(i(160));Xv(m,x,f),un=null,Sr=!1,m=f.alternate,m!==null&&(m.return=null),f.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)e0(r,s),r=r.sibling}var fa=null;function e0(s,r){var o=s.alternate,c=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Cr(r,s),Rr(s),c&4&&(Di(3,s,s.return),Rc(3,s),Di(5,s,s.return));break;case 1:Cr(r,s),Rr(s),c&512&&(Dn||o===null||Ia(o,o.return)),c&64&&ni&&(s=s.updateQueue,s!==null&&(c=s.callbacks,c!==null&&(o=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var f=fa;if(Cr(r,s),Rr(s),c&512&&(Dn||o===null||Ia(o,o.return)),c&4){var m=o!==null?o.memoizedState:null;if(c=s.memoizedState,o===null)if(c===null)if(s.stateNode===null){e:{c=s.type,o=s.memoizedProps,f=f.ownerDocument||f;t:switch(c){case"title":m=f.getElementsByTagName("title")[0],(!m||m[hn]||m[it]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=f.createElement(c),f.head.insertBefore(m,f.querySelector("head > title"))),sr(m,c,o),m[it]=s,S(m),c=m;break e;case"link":var x=e1("link","href",f).get(c+(o.href||""));if(x){for(var N=0;N<x.length;N++)if(m=x[N],m.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&m.getAttribute("rel")===(o.rel==null?null:o.rel)&&m.getAttribute("title")===(o.title==null?null:o.title)&&m.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){x.splice(N,1);break t}}m=f.createElement(c),sr(m,c,o),f.head.appendChild(m);break;case"meta":if(x=e1("meta","content",f).get(c+(o.content||""))){for(N=0;N<x.length;N++)if(m=x[N],m.getAttribute("content")===(o.content==null?null:""+o.content)&&m.getAttribute("name")===(o.name==null?null:o.name)&&m.getAttribute("property")===(o.property==null?null:o.property)&&m.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&m.getAttribute("charset")===(o.charSet==null?null:o.charSet)){x.splice(N,1);break t}}m=f.createElement(c),sr(m,c,o),f.head.appendChild(m);break;default:throw Error(i(468,c))}m[it]=s,S(m),c=m}s.stateNode=c}else t1(f,s.type,s.stateNode);else s.stateNode=Z0(f,c,s.memoizedProps);else m!==c?(m===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):m.count--,c===null?t1(f,s.type,s.stateNode):Z0(f,c,s.memoizedProps)):c===null&&s.stateNode!==null&&Nm(s,s.memoizedProps,o.memoizedProps)}break;case 27:Cr(r,s),Rr(s),c&512&&(Dn||o===null||Ia(o,o.return)),o!==null&&c&4&&Nm(s,s.memoizedProps,o.memoizedProps);break;case 5:if(Cr(r,s),Rr(s),c&512&&(Dn||o===null||Ia(o,o.return)),s.flags&32){f=s.stateNode;try{Vn(f,"")}catch(ht){Fs(s,s.return,ht)}}c&4&&s.stateNode!=null&&(f=s.memoizedProps,Nm(s,f,o!==null?o.memoizedProps:f)),c&1024&&(Rm=!0);break;case 6:if(Cr(r,s),Rr(s),c&4){if(s.stateNode===null)throw Error(i(162));c=s.memoizedProps,o=s.stateNode;try{o.nodeValue=c}catch(ht){Fs(s,s.return,ht)}}break;case 3:if(zd=null,f=fa,fa=Bd(r.containerInfo),Cr(r,s),fa=f,Rr(s),c&4&&o!==null&&o.memoizedState.isDehydrated)try{Pl(r.containerInfo)}catch(ht){Fs(s,s.return,ht)}Rm&&(Rm=!1,t0(s));break;case 4:c=fa,fa=Bd(s.stateNode.containerInfo),Cr(r,s),Rr(s),fa=c;break;case 12:Cr(r,s),Rr(s);break;case 31:Cr(r,s),Rr(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Td(s,c)));break;case 13:Cr(r,s),Rr(s),s.child.flags&8192&&s.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Nd=as()),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Td(s,c)));break;case 22:f=s.memoizedState!==null;var U=o!==null&&o.memoizedState!==null,oe=ni,ke=Dn;if(ni=oe||f,Dn=ke||U,Cr(r,s),Dn=ke,ni=oe,Rr(s),c&8192)e:for(r=s.stateNode,r._visibility=f?r._visibility&-2:r._visibility|1,f&&(o===null||U||ni||Dn||Oo(s)),o=null,r=s;;){if(r.tag===5||r.tag===26){if(o===null){U=o=r;try{if(m=U.stateNode,f)x=m.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none";else{N=U.stateNode;var Ce=U.memoizedProps.style,ce=Ce!=null&&Ce.hasOwnProperty("display")?Ce.display:null;N.style.display=ce==null||typeof ce=="boolean"?"":(""+ce).trim()}}catch(ht){Fs(U,U.return,ht)}}}else if(r.tag===6){if(o===null){U=r;try{U.stateNode.nodeValue=f?"":U.memoizedProps}catch(ht){Fs(U,U.return,ht)}}}else if(r.tag===18){if(o===null){U=r;try{var me=U.stateNode;f?q0(me,!0):q0(U.stateNode,!1)}catch(ht){Fs(U,U.return,ht)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===s)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;o===r&&(o=null),r=r.return}o===r&&(o=null),r.sibling.return=r.return,r=r.sibling}c&4&&(c=s.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,Td(s,o))));break;case 19:Cr(r,s),Rr(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Td(s,c)));break;case 30:break;case 21:break;default:Cr(r,s),Rr(s)}}function Rr(s){var r=s.flags;if(r&2){try{for(var o,c=s.return;c!==null;){if(Wv(c)){o=c;break}c=c.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var f=o.stateNode,m=Sm(s);jd(s,m,f);break;case 5:var x=o.stateNode;o.flags&32&&(Vn(x,""),o.flags&=-33);var N=Sm(s);jd(s,N,x);break;case 3:case 4:var U=o.stateNode.containerInfo,oe=Sm(s);Cm(s,oe,U);break;default:throw Error(i(161))}}catch(ke){Fs(s,s.return,ke)}s.flags&=-3}r&4096&&(s.flags&=-4097)}function t0(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var r=s;t0(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),s=s.sibling}}function ai(s,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)Yv(s,r.alternate,r),r=r.sibling}function Oo(s){for(s=s.child;s!==null;){var r=s;switch(r.tag){case 0:case 11:case 14:case 15:Di(4,r,r.return),Oo(r);break;case 1:Ia(r,r.return);var o=r.stateNode;typeof o.componentWillUnmount=="function"&&qv(r,r.return,o),Oo(r);break;case 27:Uc(r.stateNode);case 26:case 5:Ia(r,r.return),Oo(r);break;case 22:r.memoizedState===null&&Oo(r);break;case 30:Oo(r);break;default:Oo(r)}s=s.sibling}}function ii(s,r,o){for(o=o&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var c=r.alternate,f=s,m=r,x=m.flags;switch(m.tag){case 0:case 11:case 15:ii(f,m,o),Rc(4,m);break;case 1:if(ii(f,m,o),c=m,f=c.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(oe){Fs(c,c.return,oe)}if(c=m,f=c.updateQueue,f!==null){var N=c.stateNode;try{var U=f.shared.hiddenCallbacks;if(U!==null)for(f.shared.hiddenCallbacks=null,f=0;f<U.length;f++)Ib(U[f],N)}catch(oe){Fs(c,c.return,oe)}}o&&x&64&&Hv(m),Ac(m,m.return);break;case 27:Gv(m);case 26:case 5:ii(f,m,o),o&&c===null&&x&4&&$v(m),Ac(m,m.return);break;case 12:ii(f,m,o);break;case 31:ii(f,m,o),o&&x&4&&Jv(f,m);break;case 13:ii(f,m,o),o&&x&4&&Zv(f,m);break;case 22:m.memoizedState===null&&ii(f,m,o),Ac(m,m.return);break;case 30:break;default:ii(f,m,o)}r=r.sibling}}function Am(s,r){var o=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),s=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(s=r.memoizedState.cachePool.pool),s!==o&&(s!=null&&s.refCount++,o!=null&&yc(o))}function Im(s,r){s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&yc(s))}function ma(s,r,o,c){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)s0(s,r,o,c),r=r.sibling}function s0(s,r,o,c){var f=r.flags;switch(r.tag){case 0:case 11:case 15:ma(s,r,o,c),f&2048&&Rc(9,r);break;case 1:ma(s,r,o,c);break;case 3:ma(s,r,o,c),f&2048&&(s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&yc(s)));break;case 12:if(f&2048){ma(s,r,o,c),s=r.stateNode;try{var m=r.memoizedProps,x=m.id,N=m.onPostCommit;typeof N=="function"&&N(x,r.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(U){Fs(r,r.return,U)}}else ma(s,r,o,c);break;case 31:ma(s,r,o,c);break;case 13:ma(s,r,o,c);break;case 23:break;case 22:m=r.stateNode,x=r.alternate,r.memoizedState!==null?m._visibility&2?ma(s,r,o,c):Ic(s,r):m._visibility&2?ma(s,r,o,c):(m._visibility|=2,jl(s,r,o,c,(r.subtreeFlags&10256)!==0||!1)),f&2048&&Am(x,r);break;case 24:ma(s,r,o,c),f&2048&&Im(r.alternate,r);break;default:ma(s,r,o,c)}}function jl(s,r,o,c,f){for(f=f&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var m=s,x=r,N=o,U=c,oe=x.flags;switch(x.tag){case 0:case 11:case 15:jl(m,x,N,U,f),Rc(8,x);break;case 23:break;case 22:var ke=x.stateNode;x.memoizedState!==null?ke._visibility&2?jl(m,x,N,U,f):Ic(m,x):(ke._visibility|=2,jl(m,x,N,U,f)),f&&oe&2048&&Am(x.alternate,x);break;case 24:jl(m,x,N,U,f),f&&oe&2048&&Im(x.alternate,x);break;default:jl(m,x,N,U,f)}r=r.sibling}}function Ic(s,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var o=s,c=r,f=c.flags;switch(c.tag){case 22:Ic(o,c),f&2048&&Am(c.alternate,c);break;case 24:Ic(o,c),f&2048&&Im(c.alternate,c);break;default:Ic(o,c)}r=r.sibling}}var Mc=8192;function Tl(s,r,o){if(s.subtreeFlags&Mc)for(s=s.child;s!==null;)n0(s,r,o),s=s.sibling}function n0(s,r,o){switch(s.tag){case 26:Tl(s,r,o),s.flags&Mc&&s.memoizedState!==null&&Zj(o,fa,s.memoizedState,s.memoizedProps);break;case 5:Tl(s,r,o);break;case 3:case 4:var c=fa;fa=Bd(s.stateNode.containerInfo),Tl(s,r,o),fa=c;break;case 22:s.memoizedState===null&&(c=s.alternate,c!==null&&c.memoizedState!==null?(c=Mc,Mc=16777216,Tl(s,r,o),Mc=c):Tl(s,r,o));break;default:Tl(s,r,o)}}function r0(s){var r=s.alternate;if(r!==null&&(s=r.child,s!==null)){r.child=null;do r=s.sibling,s.sibling=null,s=r;while(s!==null)}}function Dc(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];qn=c,i0(c,s)}r0(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)a0(s),s=s.sibling}function a0(s){switch(s.tag){case 0:case 11:case 15:Dc(s),s.flags&2048&&Di(9,s,s.return);break;case 3:Dc(s);break;case 12:Dc(s);break;case 22:var r=s.stateNode;s.memoizedState!==null&&r._visibility&2&&(s.return===null||s.return.tag!==13)?(r._visibility&=-3,Ed(s)):Dc(s);break;default:Dc(s)}}function Ed(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];qn=c,i0(c,s)}r0(s)}for(s=s.child;s!==null;){switch(r=s,r.tag){case 0:case 11:case 15:Di(8,r,r.return),Ed(r);break;case 22:o=r.stateNode,o._visibility&2&&(o._visibility&=-3,Ed(r));break;default:Ed(r)}s=s.sibling}}function i0(s,r){for(;qn!==null;){var o=qn;switch(o.tag){case 0:case 11:case 15:Di(8,o,r);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:yc(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,qn=c;else e:for(o=s;qn!==null;){c=qn;var f=c.sibling,m=c.return;if(Qv(c),c===o){qn=null;break e}if(f!==null){f.return=m,qn=f;break e}qn=m}}}var mj={getCacheForType:function(s){var r=er(An),o=r.data.get(s);return o===void 0&&(o=s(),r.data.set(s,o)),o},cacheSignal:function(){return er(An).controller.signal}},pj=typeof WeakMap=="function"?WeakMap:Map,Ls=0,Qs=null,hs=null,ps=0,zs=0,Fr=null,Pi=!1,El=!1,Mm=!1,oi=0,xn=0,Li=0,Vo=0,Dm=0,Hr=0,Nl=0,Pc=null,Ar=null,Pm=!1,Nd=0,o0=0,Sd=1/0,Cd=null,Oi=null,Un=0,Vi=null,Sl=null,li=0,Lm=0,Om=null,l0=null,Lc=0,Vm=null;function qr(){return(Ls&2)!==0&&ps!==0?ps&-ps:H.T!==null?qm():we()}function c0(){if(Hr===0)if((ps&536870912)===0||xs){var s=Q;Q<<=1,(Q&3932160)===0&&(Q=262144),Hr=s}else Hr=536870912;return s=Ur.current,s!==null&&(s.flags|=32),Hr}function Ir(s,r,o){(s===Qs&&(zs===2||zs===9)||s.cancelPendingCommit!==null)&&(Cl(s,0),Bi(s,ps,Hr,!1)),Rs(s,o),((Ls&2)===0||s!==Qs)&&(s===Qs&&((Ls&2)===0&&(Vo|=o),xn===4&&Bi(s,ps,Hr,!1)),Ma(s))}function u0(s,r,o){if((Ls&6)!==0)throw Error(i(327));var c=!o&&(r&127)===0&&(r&s.expiredLanes)===0||St(s,r),f=c?bj(s,r):Um(s,r,!0),m=c;do{if(f===0){El&&!c&&Bi(s,r,0,!1);break}else{if(o=s.current.alternate,m&&!gj(o)){f=Um(s,r,!1),m=!1;continue}if(f===2){if(m=r,s.errorRecoveryDisabledLanes&m)var x=0;else x=s.pendingLanes&-536870913,x=x!==0?x:x&536870912?536870912:0;if(x!==0){r=x;e:{var N=s;f=Pc;var U=N.current.memoizedState.isDehydrated;if(U&&(Cl(N,x).flags|=256),x=Um(N,x,!1),x!==2){if(Mm&&!U){N.errorRecoveryDisabledLanes|=m,Vo|=m,f=4;break e}m=Ar,Ar=f,m!==null&&(Ar===null?Ar=m:Ar.push.apply(Ar,m))}f=x}if(m=!1,f!==2)continue}}if(f===1){Cl(s,0),Bi(s,r,0,!0);break}e:{switch(c=s,m=f,m){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:Bi(c,r,Hr,!Pi);break e;case 2:Ar=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(f=Nd+300-as(),10<f)){if(Bi(c,r,Hr,!Pi),It(c,0,!0)!==0)break e;li=r,c.timeoutHandle=z0(d0.bind(null,c,o,Ar,Cd,Pm,r,Hr,Vo,Nl,Pi,m,"Throttled",-0,0),f);break e}d0(c,o,Ar,Cd,Pm,r,Hr,Vo,Nl,Pi,m,null,-0,0)}}break}while(!0);Ma(s)}function d0(s,r,o,c,f,m,x,N,U,oe,ke,Ce,ce,me){if(s.timeoutHandle=-1,Ce=r.subtreeFlags,Ce&8192||(Ce&16785408)===16785408){Ce={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Zs},n0(r,m,Ce);var ht=(m&62914560)===m?Nd-as():(m&4194048)===m?o0-as():0;if(ht=eT(Ce,ht),ht!==null){li=m,s.cancelPendingCommit=ht(v0.bind(null,s,r,m,o,c,f,x,N,U,ke,Ce,null,ce,me)),Bi(s,m,x,!oe);return}}v0(s,r,m,o,c,f,x,N,U)}function gj(s){for(var r=s;;){var o=r.tag;if((o===0||o===11||o===15)&&r.flags&16384&&(o=r.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var f=o[c],m=f.getSnapshot;f=f.value;try{if(!Vr(m(),f))return!1}catch{return!1}}if(o=r.child,r.subtreeFlags&16384&&o!==null)o.return=r,r=o;else{if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Bi(s,r,o,c){r&=~Dm,r&=~Vo,s.suspendedLanes|=r,s.pingedLanes&=~r,c&&(s.warmLanes|=r),c=s.expirationTimes;for(var f=r;0<f;){var m=31-De(f),x=1<<m;c[m]=-1,f&=~x}o!==0&&rs(s,o,r)}function Rd(){return(Ls&6)===0?(Oc(0),!1):!0}function Bm(){if(hs!==null){if(zs===0)var s=hs.return;else s=hs,Xa=Co=null,tm(s),vl=null,vc=0,s=hs;for(;s!==null;)Fv(s.alternate,s),s=s.return;hs=null}}function Cl(s,r){var o=s.timeoutHandle;o!==-1&&(s.timeoutHandle=-1,Lj(o)),o=s.cancelPendingCommit,o!==null&&(s.cancelPendingCommit=null,o()),li=0,Bm(),Qs=s,hs=o=Ya(s.current,null),ps=r,zs=0,Fr=null,Pi=!1,El=St(s,r),Mm=!1,Nl=Hr=Dm=Vo=Li=xn=0,Ar=Pc=null,Pm=!1,(r&8)!==0&&(r|=r&32);var c=s.entangledLanes;if(c!==0)for(s=s.entanglements,c&=r;0<c;){var f=31-De(c),m=1<<f;r|=s[f],c&=~m}return oi=r,Xu(),o}function h0(s,r){es=null,H.H=Nc,r===bl||r===ad?(r=Sb(),zs=3):r===Hf?(r=Sb(),zs=4):zs=r===ym?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Fr=r,hs===null&&(xn=1,vd(s,Zr(r,s.current)))}function f0(){var s=Ur.current;return s===null?!0:(ps&4194048)===ps?na===null:(ps&62914560)===ps||(ps&536870912)!==0?s===na:!1}function m0(){var s=H.H;return H.H=Nc,s===null?Nc:s}function p0(){var s=H.A;return H.A=mj,s}function Ad(){xn=4,Pi||(ps&4194048)!==ps&&Ur.current!==null||(El=!0),(Li&134217727)===0&&(Vo&134217727)===0||Qs===null||Bi(Qs,ps,Hr,!1)}function Um(s,r,o){var c=Ls;Ls|=2;var f=m0(),m=p0();(Qs!==s||ps!==r)&&(Cd=null,Cl(s,r)),r=!1;var x=xn;e:do try{if(zs!==0&&hs!==null){var N=hs,U=Fr;switch(zs){case 8:Bm(),x=6;break e;case 3:case 2:case 9:case 6:Ur.current===null&&(r=!0);var oe=zs;if(zs=0,Fr=null,Rl(s,N,U,oe),o&&El){x=0;break e}break;default:oe=zs,zs=0,Fr=null,Rl(s,N,U,oe)}}yj(),x=xn;break}catch(ke){h0(s,ke)}while(!0);return r&&s.shellSuspendCounter++,Xa=Co=null,Ls=c,H.H=f,H.A=m,hs===null&&(Qs=null,ps=0,Xu()),x}function yj(){for(;hs!==null;)g0(hs)}function bj(s,r){var o=Ls;Ls|=2;var c=m0(),f=p0();Qs!==s||ps!==r?(Cd=null,Sd=as()+500,Cl(s,r)):El=St(s,r);e:do try{if(zs!==0&&hs!==null){r=hs;var m=Fr;t:switch(zs){case 1:zs=0,Fr=null,Rl(s,r,m,1);break;case 2:case 9:if(Eb(m)){zs=0,Fr=null,y0(r);break}r=function(){zs!==2&&zs!==9||Qs!==s||(zs=7),Ma(s)},m.then(r,r);break e;case 3:zs=7;break e;case 4:zs=5;break e;case 7:Eb(m)?(zs=0,Fr=null,y0(r)):(zs=0,Fr=null,Rl(s,r,m,7));break;case 5:var x=null;switch(hs.tag){case 26:x=hs.memoizedState;case 5:case 27:var N=hs;if(x?s1(x):N.stateNode.complete){zs=0,Fr=null;var U=N.sibling;if(U!==null)hs=U;else{var oe=N.return;oe!==null?(hs=oe,Id(oe)):hs=null}break t}}zs=0,Fr=null,Rl(s,r,m,5);break;case 6:zs=0,Fr=null,Rl(s,r,m,6);break;case 8:Bm(),xn=6;break e;default:throw Error(i(462))}}vj();break}catch(ke){h0(s,ke)}while(!0);return Xa=Co=null,H.H=c,H.A=f,Ls=o,hs!==null?0:(Qs=null,ps=0,Xu(),xn)}function vj(){for(;hs!==null&&!Ks();)g0(hs)}function g0(s){var r=Uv(s.alternate,s,oi);s.memoizedProps=s.pendingProps,r===null?Id(s):hs=r}function y0(s){var r=s,o=r.alternate;switch(r.tag){case 15:case 0:r=Dv(o,r,r.pendingProps,r.type,void 0,ps);break;case 11:r=Dv(o,r,r.pendingProps,r.type.render,r.ref,ps);break;case 5:tm(r);default:Fv(o,r),r=hs=pb(r,oi),r=Uv(o,r,oi)}s.memoizedProps=s.pendingProps,r===null?Id(s):hs=r}function Rl(s,r,o,c){Xa=Co=null,tm(r),vl=null,vc=0;var f=r.return;try{if(oj(s,f,r,o,ps)){xn=1,vd(s,Zr(o,s.current)),hs=null;return}}catch(m){if(f!==null)throw hs=f,m;xn=1,vd(s,Zr(o,s.current)),hs=null;return}r.flags&32768?(xs||c===1?s=!0:El||(ps&536870912)!==0?s=!1:(Pi=s=!0,(c===2||c===9||c===3||c===6)&&(c=Ur.current,c!==null&&c.tag===13&&(c.flags|=16384))),b0(r,s)):Id(r)}function Id(s){var r=s;do{if((r.flags&32768)!==0){b0(r,Pi);return}s=r.return;var o=uj(r.alternate,r,oi);if(o!==null){hs=o;return}if(r=r.sibling,r!==null){hs=r;return}hs=r=s}while(r!==null);xn===0&&(xn=5)}function b0(s,r){do{var o=dj(s.alternate,s);if(o!==null){o.flags&=32767,hs=o;return}if(o=s.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!r&&(s=s.sibling,s!==null)){hs=s;return}hs=s=o}while(s!==null);xn=6,hs=null}function v0(s,r,o,c,f,m,x,N,U){s.cancelPendingCommit=null;do Md();while(Un!==0);if((Ls&6)!==0)throw Error(i(327));if(r!==null){if(r===s.current)throw Error(i(177));if(m=r.lanes|r.childLanes,m|=Sf,tn(s,o,m,x,N,U),s===Qs&&(hs=Qs=null,ps=0),Sl=r,Vi=s,li=o,Lm=m,Om=f,l0=c,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,kj(ns,function(){return j0(),null})):(s.callbackNode=null,s.callbackPriority=0),c=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||c){c=H.T,H.T=null,f=fe.p,fe.p=2,x=Ls,Ls|=4;try{hj(s,r,o)}finally{Ls=x,fe.p=f,H.T=c}}Un=1,x0(),w0(),_0()}}function x0(){if(Un===1){Un=0;var s=Vi,r=Sl,o=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||o){o=H.T,H.T=null;var c=fe.p;fe.p=2;var f=Ls;Ls|=4;try{e0(r,s);var m=Jm,x=ib(s.containerInfo),N=m.focusedElem,U=m.selectionRange;if(x!==N&&N&&N.ownerDocument&&ab(N.ownerDocument.documentElement,N)){if(U!==null&&kf(N)){var oe=U.start,ke=U.end;if(ke===void 0&&(ke=oe),"selectionStart"in N)N.selectionStart=oe,N.selectionEnd=Math.min(ke,N.value.length);else{var Ce=N.ownerDocument||document,ce=Ce&&Ce.defaultView||window;if(ce.getSelection){var me=ce.getSelection(),ht=N.textContent.length,Dt=Math.min(U.start,ht),Ws=U.end===void 0?Dt:Math.min(U.end,ht);!me.extend&&Dt>Ws&&(x=Ws,Ws=Dt,Dt=x);var J=rb(N,Dt),W=rb(N,Ws);if(J&&W&&(me.rangeCount!==1||me.anchorNode!==J.node||me.anchorOffset!==J.offset||me.focusNode!==W.node||me.focusOffset!==W.offset)){var ie=Ce.createRange();ie.setStart(J.node,J.offset),me.removeAllRanges(),Dt>Ws?(me.addRange(ie),me.extend(W.node,W.offset)):(ie.setEnd(W.node,W.offset),me.addRange(ie))}}}}for(Ce=[],me=N;me=me.parentNode;)me.nodeType===1&&Ce.push({element:me,left:me.scrollLeft,top:me.scrollTop});for(typeof N.focus=="function"&&N.focus(),N=0;N<Ce.length;N++){var Ne=Ce[N];Ne.element.scrollLeft=Ne.left,Ne.element.scrollTop=Ne.top}}$d=!!Xm,Jm=Xm=null}finally{Ls=f,fe.p=c,H.T=o}}s.current=r,Un=2}}function w0(){if(Un===2){Un=0;var s=Vi,r=Sl,o=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||o){o=H.T,H.T=null;var c=fe.p;fe.p=2;var f=Ls;Ls|=4;try{Yv(s,r.alternate,r)}finally{Ls=f,fe.p=c,H.T=o}}Un=3}}function _0(){if(Un===4||Un===3){Un=0,Ct();var s=Vi,r=Sl,o=li,c=l0;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Un=5:(Un=0,Sl=Vi=null,k0(s,s.pendingLanes));var f=s.pendingLanes;if(f===0&&(Oi=null),ye(o),r=r.stateNode,Ve&&typeof Ve.onCommitFiberRoot=="function")try{Ve.onCommitFiberRoot(Ye,r,void 0,(r.current.flags&128)===128)}catch{}if(c!==null){r=H.T,f=fe.p,fe.p=2,H.T=null;try{for(var m=s.onRecoverableError,x=0;x<c.length;x++){var N=c[x];m(N.value,{componentStack:N.stack})}}finally{H.T=r,fe.p=f}}(li&3)!==0&&Md(),Ma(s),f=s.pendingLanes,(o&261930)!==0&&(f&42)!==0?s===Vm?Lc++:(Lc=0,Vm=s):Lc=0,Oc(0)}}function k0(s,r){(s.pooledCacheLanes&=r)===0&&(r=s.pooledCache,r!=null&&(s.pooledCache=null,yc(r)))}function Md(){return x0(),w0(),_0(),j0()}function j0(){if(Un!==5)return!1;var s=Vi,r=Lm;Lm=0;var o=ye(li),c=H.T,f=fe.p;try{fe.p=32>o?32:o,H.T=null,o=Om,Om=null;var m=Vi,x=li;if(Un=0,Sl=Vi=null,li=0,(Ls&6)!==0)throw Error(i(331));var N=Ls;if(Ls|=4,a0(m.current),s0(m,m.current,x,o),Ls=N,Oc(0,!1),Ve&&typeof Ve.onPostCommitFiberRoot=="function")try{Ve.onPostCommitFiberRoot(Ye,m)}catch{}return!0}finally{fe.p=f,H.T=c,k0(s,r)}}function T0(s,r,o){r=Zr(o,r),r=gm(s.stateNode,r,2),s=Ai(s,r,2),s!==null&&(Rs(s,2),Ma(s))}function Fs(s,r,o){if(s.tag===3)T0(s,s,o);else for(;r!==null;){if(r.tag===3){T0(r,s,o);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Oi===null||!Oi.has(c))){s=Zr(o,s),o=Ev(2),c=Ai(r,o,2),c!==null&&(Nv(o,c,r,s),Rs(c,2),Ma(c));break}}r=r.return}}function zm(s,r,o){var c=s.pingCache;if(c===null){c=s.pingCache=new pj;var f=new Set;c.set(r,f)}else f=c.get(r),f===void 0&&(f=new Set,c.set(r,f));f.has(o)||(Mm=!0,f.add(o),s=xj.bind(null,s,r,o),r.then(s,s))}function xj(s,r,o){var c=s.pingCache;c!==null&&c.delete(r),s.pingedLanes|=s.suspendedLanes&o,s.warmLanes&=~o,Qs===s&&(ps&o)===o&&(xn===4||xn===3&&(ps&62914560)===ps&&300>as()-Nd?(Ls&2)===0&&Cl(s,0):Dm|=o,Nl===ps&&(Nl=0)),Ma(s)}function E0(s,r){r===0&&(r=Xt()),s=Eo(s,r),s!==null&&(Rs(s,r),Ma(s))}function wj(s){var r=s.memoizedState,o=0;r!==null&&(o=r.retryLane),E0(s,o)}function _j(s,r){var o=0;switch(s.tag){case 31:case 13:var c=s.stateNode,f=s.memoizedState;f!==null&&(o=f.retryLane);break;case 19:c=s.stateNode;break;case 22:c=s.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(r),E0(s,o)}function kj(s,r){return Ze(s,r)}var Dd=null,Al=null,Fm=!1,Pd=!1,Hm=!1,Ui=0;function Ma(s){s!==Al&&s.next===null&&(Al===null?Dd=Al=s:Al=Al.next=s),Pd=!0,Fm||(Fm=!0,Tj())}function Oc(s,r){if(!Hm&&Pd){Hm=!0;do for(var o=!1,c=Dd;c!==null;){if(s!==0){var f=c.pendingLanes;if(f===0)var m=0;else{var x=c.suspendedLanes,N=c.pingedLanes;m=(1<<31-De(42|s)+1)-1,m&=f&~(x&~N),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(o=!0,R0(c,m))}else m=ps,m=It(c,c===Qs?m:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(m&3)===0||St(c,m)||(o=!0,R0(c,m));c=c.next}while(o);Hm=!1}}function jj(){N0()}function N0(){Pd=Fm=!1;var s=0;Ui!==0&&Pj()&&(s=Ui);for(var r=as(),o=null,c=Dd;c!==null;){var f=c.next,m=S0(c,r);m===0?(c.next=null,o===null?Dd=f:o.next=f,f===null&&(Al=o)):(o=c,(s!==0||(m&3)!==0)&&(Pd=!0)),c=f}Un!==0&&Un!==5||Oc(s),Ui!==0&&(Ui=0)}function S0(s,r){for(var o=s.suspendedLanes,c=s.pingedLanes,f=s.expirationTimes,m=s.pendingLanes&-62914561;0<m;){var x=31-De(m),N=1<<x,U=f[x];U===-1?((N&o)===0||(N&c)!==0)&&(f[x]=ts(N,r)):U<=r&&(s.expiredLanes|=N),m&=~N}if(r=Qs,o=ps,o=It(s,s===r?o:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c=s.callbackNode,o===0||s===r&&(zs===2||zs===9)||s.cancelPendingCommit!==null)return c!==null&&c!==null&&Pt(c),s.callbackNode=null,s.callbackPriority=0;if((o&3)===0||St(s,o)){if(r=o&-o,r===s.callbackPriority)return r;switch(c!==null&&Pt(c),ye(o)){case 2:case 8:o=Cs;break;case 32:o=ns;break;case 268435456:o=he;break;default:o=ns}return c=C0.bind(null,s),o=Ze(o,c),s.callbackPriority=r,s.callbackNode=o,r}return c!==null&&c!==null&&Pt(c),s.callbackPriority=2,s.callbackNode=null,2}function C0(s,r){if(Un!==0&&Un!==5)return s.callbackNode=null,s.callbackPriority=0,null;var o=s.callbackNode;if(Md()&&s.callbackNode!==o)return null;var c=ps;return c=It(s,s===Qs?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c===0?null:(u0(s,c,r),S0(s,as()),s.callbackNode!=null&&s.callbackNode===o?C0.bind(null,s):null)}function R0(s,r){if(Md())return null;u0(s,r,!0)}function Tj(){Oj(function(){(Ls&6)!==0?Ze(qt,jj):N0()})}function qm(){if(Ui===0){var s=gl;s===0&&(s=Gt,Gt<<=1,(Gt&261888)===0&&(Gt=256)),Ui=s}return Ui}function A0(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Kn(""+s)}function I0(s,r){var o=r.ownerDocument.createElement("input");return o.name=r.name,o.value=r.value,s.id&&o.setAttribute("form",s.id),r.parentNode.insertBefore(o,r),s=new FormData(s),o.parentNode.removeChild(o),s}function Ej(s,r,o,c,f){if(r==="submit"&&o&&o.stateNode===f){var m=A0((f[Rt]||null).action),x=c.submitter;x&&(r=(r=x[Rt]||null)?A0(r.formAction):x.getAttribute("formAction"),r!==null&&(m=r,x=null));var N=new jt("action","action",null,c,f);s.push({event:N,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Ui!==0){var U=x?I0(f,x):new FormData(f);um(o,{pending:!0,data:U,method:f.method,action:m},null,U)}}else typeof m=="function"&&(N.preventDefault(),U=x?I0(f,x):new FormData(f),um(o,{pending:!0,data:U,method:f.method,action:m},m,U))},currentTarget:f}]})}}for(var $m=0;$m<Nf.length;$m++){var Wm=Nf[$m],Nj=Wm.toLowerCase(),Sj=Wm[0].toUpperCase()+Wm.slice(1);ha(Nj,"on"+Sj)}ha(cb,"onAnimationEnd"),ha(ub,"onAnimationIteration"),ha(db,"onAnimationStart"),ha("dblclick","onDoubleClick"),ha("focusin","onFocus"),ha("focusout","onBlur"),ha(qk,"onTransitionRun"),ha($k,"onTransitionStart"),ha(Wk,"onTransitionCancel"),ha(hb,"onTransitionEnd"),qe("onMouseEnter",["mouseout","mouseover"]),qe("onMouseLeave",["mouseout","mouseover"]),qe("onPointerEnter",["pointerout","pointerover"]),qe("onPointerLeave",["pointerout","pointerover"]),Qe("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Qe("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Qe("onBeforeInput",["compositionend","keypress","textInput","paste"]),Qe("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Qe("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Qe("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Cj=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Vc));function M0(s,r){r=(r&4)!==0;for(var o=0;o<s.length;o++){var c=s[o],f=c.event;c=c.listeners;e:{var m=void 0;if(r)for(var x=c.length-1;0<=x;x--){var N=c[x],U=N.instance,oe=N.currentTarget;if(N=N.listener,U!==m&&f.isPropagationStopped())break e;m=N,f.currentTarget=oe;try{m(f)}catch(ke){Qu(ke)}f.currentTarget=null,m=U}else for(x=0;x<c.length;x++){if(N=c[x],U=N.instance,oe=N.currentTarget,N=N.listener,U!==m&&f.isPropagationStopped())break e;m=N,f.currentTarget=oe;try{m(f)}catch(ke){Qu(ke)}f.currentTarget=null,m=U}}}}function fs(s,r){var o=r[_t];o===void 0&&(o=r[_t]=new Set);var c=s+"__bubble";o.has(c)||(D0(r,s,2,!1),o.add(c))}function Gm(s,r,o){var c=0;r&&(c|=4),D0(o,s,c,r)}var Ld="_reactListening"+Math.random().toString(36).slice(2);function Km(s){if(!s[Ld]){s[Ld]=!0,G.forEach(function(o){o!=="selectionchange"&&(Cj.has(o)||Gm(o,!1,s),Gm(o,!0,s))});var r=s.nodeType===9?s:s.ownerDocument;r===null||r[Ld]||(r[Ld]=!0,Gm("selectionchange",!1,r))}}function D0(s,r,o,c){switch(c1(r)){case 2:var f=nT;break;case 8:f=rT;break;default:f=cp}o=f.bind(null,r,o,s),f=void 0,!Na||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(f=!0),c?f!==void 0?s.addEventListener(r,o,{capture:!0,passive:f}):s.addEventListener(r,o,!0):f!==void 0?s.addEventListener(r,o,{passive:f}):s.addEventListener(r,o,!1)}function Ym(s,r,o,c,f){var m=c;if((r&1)===0&&(r&2)===0&&c!==null)e:for(;;){if(c===null)return;var x=c.tag;if(x===3||x===4){var N=c.stateNode.containerInfo;if(N===f)break;if(x===4)for(x=c.return;x!==null;){var U=x.tag;if((U===3||U===4)&&x.stateNode.containerInfo===f)return;x=x.return}for(;N!==null;){if(x=Es(N),x===null)return;if(U=x.tag,U===5||U===6||U===26||U===27){c=m=x;continue e}N=N.parentNode}}c=c.return}Ea(function(){var oe=m,ke=mn(o),Ce=[];e:{var ce=fb.get(s);if(ce!==void 0){var me=jt,ht=s;switch(s){case"keypress":if(I(o)===0)break e;case"keydown":case"keyup":me=Ka;break;case"focusin":ht="focus",me=nn;break;case"focusout":ht="blur",me=nn;break;case"beforeblur":case"afterblur":me=nn;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":me=Yn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":me=Us;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":me=b;break;case cb:case ub:case db:me=Qn;break;case hb:me=C;break;case"scroll":case"scrollend":me=Ot;break;case"wheel":me=de;break;case"copy":case"cut":case"paste":me=Tr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":me=ir;break;case"toggle":case"beforetoggle":me=Zt}var Dt=(r&4)!==0,Ws=!Dt&&(s==="scroll"||s==="scrollend"),J=Dt?ce!==null?ce+"Capture":null:ce;Dt=[];for(var W=oe,ie;W!==null;){var Ne=W;if(ie=Ne.stateNode,Ne=Ne.tag,Ne!==5&&Ne!==26&&Ne!==27||ie===null||J===null||(Ne=pr(W,J),Ne!=null&&Dt.push(Bc(W,Ne,ie))),Ws)break;W=W.return}0<Dt.length&&(ce=new me(ce,ht,null,o,ke),Ce.push({event:ce,listeners:Dt}))}}if((r&7)===0){e:{if(ce=s==="mouseover"||s==="pointerover",me=s==="mouseout"||s==="pointerout",ce&&o!==sn&&(ht=o.relatedTarget||o.fromElement)&&(Es(ht)||ht[ct]))break e;if((me||ce)&&(ce=ke.window===ke?ke:(ce=ke.ownerDocument)?ce.defaultView||ce.parentWindow:window,me?(ht=o.relatedTarget||o.toElement,me=oe,ht=ht?Es(ht):null,ht!==null&&(Ws=u(ht),Dt=ht.tag,ht!==Ws||Dt!==5&&Dt!==27&&Dt!==6)&&(ht=null)):(me=null,ht=oe),me!==ht)){if(Dt=Yn,Ne="onMouseLeave",J="onMouseEnter",W="mouse",(s==="pointerout"||s==="pointerover")&&(Dt=ir,Ne="onPointerLeave",J="onPointerEnter",W="pointer"),Ws=me==null?ce:ue(me),ie=ht==null?ce:ue(ht),ce=new Dt(Ne,W+"leave",me,o,ke),ce.target=Ws,ce.relatedTarget=ie,Ne=null,Es(ke)===oe&&(Dt=new Dt(J,W+"enter",ht,o,ke),Dt.target=ie,Dt.relatedTarget=Ws,Ne=Dt),Ws=Ne,me&&ht)t:{for(Dt=Rj,J=me,W=ht,ie=0,Ne=J;Ne;Ne=Dt(Ne))ie++;Ne=0;for(var Et=W;Et;Et=Dt(Et))Ne++;for(;0<ie-Ne;)J=Dt(J),ie--;for(;0<Ne-ie;)W=Dt(W),Ne--;for(;ie--;){if(J===W||W!==null&&J===W.alternate){Dt=J;break t}J=Dt(J),W=Dt(W)}Dt=null}else Dt=null;me!==null&&P0(Ce,ce,me,Dt,!1),ht!==null&&Ws!==null&&P0(Ce,Ws,ht,Dt,!0)}}e:{if(ce=oe?ue(oe):window,me=ce.nodeName&&ce.nodeName.toLowerCase(),me==="select"||me==="input"&&ce.type==="file")var Is=Jy;else if(Qy(ce))if(Zy)Is=zk;else{Is=Bk;var yt=Vk}else me=ce.nodeName,!me||me.toLowerCase()!=="input"||ce.type!=="checkbox"&&ce.type!=="radio"?oe&&ln(oe.elementType)&&(Is=Jy):Is=Uk;if(Is&&(Is=Is(s,oe))){Xy(Ce,Is,o,ke);break e}yt&&yt(s,ce,oe),s==="focusout"&&oe&&ce.type==="number"&&oe.memoizedProps.value!=null&&yn(ce,"number",ce.value)}switch(yt=oe?ue(oe):window,s){case"focusin":(Qy(yt)||yt.contentEditable==="true")&&(ll=yt,jf=oe,mc=null);break;case"focusout":mc=jf=ll=null;break;case"mousedown":Tf=!0;break;case"contextmenu":case"mouseup":case"dragend":Tf=!1,ob(Ce,o,ke);break;case"selectionchange":if(Hk)break;case"keydown":case"keyup":ob(Ce,o,ke)}var ss;if(Ps)e:{switch(s){case"compositionstart":var gs="onCompositionStart";break e;case"compositionend":gs="onCompositionEnd";break e;case"compositionupdate":gs="onCompositionUpdate";break e}gs=void 0}else ol?ko(s,o)&&(gs="onCompositionEnd"):s==="keydown"&&o.keyCode===229&&(gs="onCompositionStart");gs&&(Ca&&o.locale!=="ko"&&(ol||gs!=="onCompositionStart"?gs==="onCompositionEnd"&&ol&&(ss=wo()):(Qr=ke,xo="value"in Qr?Qr.value:Qr.textContent,ol=!0)),yt=Od(oe,gs),0<yt.length&&(gs=new bn(gs,s,null,o,ke),Ce.push({event:gs,listeners:yt}),ss?gs.data=ss:(ss=il(o),ss!==null&&(gs.data=ss)))),(ss=Xr?Dk(s,o):Pk(s,o))&&(gs=Od(oe,"onBeforeInput"),0<gs.length&&(yt=new bn("onBeforeInput","beforeinput",null,o,ke),Ce.push({event:yt,listeners:gs}),yt.data=ss)),Ej(Ce,s,oe,o,ke)}M0(Ce,r)})}function Bc(s,r,o){return{instance:s,listener:r,currentTarget:o}}function Od(s,r){for(var o=r+"Capture",c=[];s!==null;){var f=s,m=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||m===null||(f=pr(s,o),f!=null&&c.unshift(Bc(s,f,m)),f=pr(s,r),f!=null&&c.push(Bc(s,f,m))),s.tag===3)return c;s=s.return}return[]}function Rj(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function P0(s,r,o,c,f){for(var m=r._reactName,x=[];o!==null&&o!==c;){var N=o,U=N.alternate,oe=N.stateNode;if(N=N.tag,U!==null&&U===c)break;N!==5&&N!==26&&N!==27||oe===null||(U=oe,f?(oe=pr(o,m),oe!=null&&x.unshift(Bc(o,oe,U))):f||(oe=pr(o,m),oe!=null&&x.push(Bc(o,oe,U)))),o=o.return}x.length!==0&&s.push({event:r,listeners:x})}var Aj=/\r\n?/g,Ij=/\u0000|\uFFFD/g;function L0(s){return(typeof s=="string"?s:""+s).replace(Aj,`
`).replace(Ij,"")}function O0(s,r){return r=L0(r),L0(s)===r}function $s(s,r,o,c,f,m){switch(o){case"children":typeof c=="string"?r==="body"||r==="textarea"&&c===""||Vn(s,c):(typeof c=="number"||typeof c=="bigint")&&r!=="body"&&Vn(s,""+c);break;case"className":gn(s,"class",c);break;case"tabIndex":gn(s,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":gn(s,o,c);break;case"style":os(s,c,m);break;case"data":if(r!=="object"){gn(s,"data",c);break}case"src":case"href":if(c===""&&(r!=="a"||o!=="href")){s.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(o);break}c=Kn(""+c),s.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){s.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(o==="formAction"?(r!=="input"&&$s(s,r,"name",f.name,f,null),$s(s,r,"formEncType",f.formEncType,f,null),$s(s,r,"formMethod",f.formMethod,f,null),$s(s,r,"formTarget",f.formTarget,f,null)):($s(s,r,"encType",f.encType,f,null),$s(s,r,"method",f.method,f,null),$s(s,r,"target",f.target,f,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(o);break}c=Kn(""+c),s.setAttribute(o,c);break;case"onClick":c!=null&&(s.onclick=Zs);break;case"onScroll":c!=null&&fs("scroll",s);break;case"onScrollEnd":c!=null&&fs("scrollend",s);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"multiple":s.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":s.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){s.removeAttribute("xlink:href");break}o=Kn(""+c),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,""+c):s.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,""):s.removeAttribute(o);break;case"capture":case"download":c===!0?s.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,c):s.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?s.setAttribute(o,c):s.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?s.removeAttribute(o):s.setAttribute(o,c);break;case"popover":fs("beforetoggle",s),fs("toggle",s),jn(s,"popover",c);break;case"xlinkActuate":Js(s,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Js(s,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Js(s,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Js(s,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Js(s,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Js(s,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Js(s,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Js(s,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Js(s,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":jn(s,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=fr.get(o)||o,jn(s,o,c))}}function Qm(s,r,o,c,f,m){switch(o){case"style":os(s,c,m);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"children":typeof c=="string"?Vn(s,c):(typeof c=="number"||typeof c=="bigint")&&Vn(s,""+c);break;case"onScroll":c!=null&&fs("scroll",s);break;case"onScrollEnd":c!=null&&fs("scrollend",s);break;case"onClick":c!=null&&(s.onclick=Zs);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ae.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(f=o.endsWith("Capture"),r=o.slice(2,f?o.length-7:void 0),m=s[Rt]||null,m=m!=null?m[o]:null,typeof m=="function"&&s.removeEventListener(r,m,f),typeof c=="function")){typeof m!="function"&&m!==null&&(o in s?s[o]=null:s.hasAttribute(o)&&s.removeAttribute(o)),s.addEventListener(r,c,f);break e}o in s?s[o]=c:c===!0?s.setAttribute(o,""):jn(s,o,c)}}}function sr(s,r,o){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":fs("error",s),fs("load",s);var c=!1,f=!1,m;for(m in o)if(o.hasOwnProperty(m)){var x=o[m];if(x!=null)switch(m){case"src":c=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:$s(s,r,m,x,o,null)}}f&&$s(s,r,"srcSet",o.srcSet,o,null),c&&$s(s,r,"src",o.src,o,null);return;case"input":fs("invalid",s);var N=m=x=f=null,U=null,oe=null;for(c in o)if(o.hasOwnProperty(c)){var ke=o[c];if(ke!=null)switch(c){case"name":f=ke;break;case"type":x=ke;break;case"checked":U=ke;break;case"defaultChecked":oe=ke;break;case"value":m=ke;break;case"defaultValue":N=ke;break;case"children":case"dangerouslySetInnerHTML":if(ke!=null)throw Error(i(137,r));break;default:$s(s,r,c,ke,o,null)}}is(s,m,N,U,oe,x,f,!1);return;case"select":fs("invalid",s),c=x=m=null;for(f in o)if(o.hasOwnProperty(f)&&(N=o[f],N!=null))switch(f){case"value":m=N;break;case"defaultValue":x=N;break;case"multiple":c=N;default:$s(s,r,f,N,o,null)}r=m,o=x,s.multiple=!!c,r!=null?ms(s,!!c,r,!1):o!=null&&ms(s,!!c,o,!0);return;case"textarea":fs("invalid",s),m=f=c=null;for(x in o)if(o.hasOwnProperty(x)&&(N=o[x],N!=null))switch(x){case"value":c=N;break;case"defaultValue":f=N;break;case"children":m=N;break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(i(91));break;default:$s(s,r,x,N,o,null)}Yr(s,c,f,m);return;case"option":for(U in o)o.hasOwnProperty(U)&&(c=o[U],c!=null)&&(U==="selected"?s.selected=c&&typeof c!="function"&&typeof c!="symbol":$s(s,r,U,c,o,null));return;case"dialog":fs("beforetoggle",s),fs("toggle",s),fs("cancel",s),fs("close",s);break;case"iframe":case"object":fs("load",s);break;case"video":case"audio":for(c=0;c<Vc.length;c++)fs(Vc[c],s);break;case"image":fs("error",s),fs("load",s);break;case"details":fs("toggle",s);break;case"embed":case"source":case"link":fs("error",s),fs("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(oe in o)if(o.hasOwnProperty(oe)&&(c=o[oe],c!=null))switch(oe){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:$s(s,r,oe,c,o,null)}return;default:if(ln(r)){for(ke in o)o.hasOwnProperty(ke)&&(c=o[ke],c!==void 0&&Qm(s,r,ke,c,o,void 0));return}}for(N in o)o.hasOwnProperty(N)&&(c=o[N],c!=null&&$s(s,r,N,c,o,null))}function Mj(s,r,o,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,m=null,x=null,N=null,U=null,oe=null,ke=null;for(me in o){var Ce=o[me];if(o.hasOwnProperty(me)&&Ce!=null)switch(me){case"checked":break;case"value":break;case"defaultValue":U=Ce;default:c.hasOwnProperty(me)||$s(s,r,me,null,c,Ce)}}for(var ce in c){var me=c[ce];if(Ce=o[ce],c.hasOwnProperty(ce)&&(me!=null||Ce!=null))switch(ce){case"type":m=me;break;case"name":f=me;break;case"checked":oe=me;break;case"defaultChecked":ke=me;break;case"value":x=me;break;case"defaultValue":N=me;break;case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(i(137,r));break;default:me!==Ce&&$s(s,r,ce,me,c,Ce)}}Kt(s,x,N,U,oe,ke,m,f);return;case"select":me=x=N=ce=null;for(m in o)if(U=o[m],o.hasOwnProperty(m)&&U!=null)switch(m){case"value":break;case"multiple":me=U;default:c.hasOwnProperty(m)||$s(s,r,m,null,c,U)}for(f in c)if(m=c[f],U=o[f],c.hasOwnProperty(f)&&(m!=null||U!=null))switch(f){case"value":ce=m;break;case"defaultValue":N=m;break;case"multiple":x=m;default:m!==U&&$s(s,r,f,m,c,U)}r=N,o=x,c=me,ce!=null?ms(s,!!o,ce,!1):!!c!=!!o&&(r!=null?ms(s,!!o,r,!0):ms(s,!!o,o?[]:"",!1));return;case"textarea":me=ce=null;for(N in o)if(f=o[N],o.hasOwnProperty(N)&&f!=null&&!c.hasOwnProperty(N))switch(N){case"value":break;case"children":break;default:$s(s,r,N,null,c,f)}for(x in c)if(f=c[x],m=o[x],c.hasOwnProperty(x)&&(f!=null||m!=null))switch(x){case"value":ce=f;break;case"defaultValue":me=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(i(91));break;default:f!==m&&$s(s,r,x,f,c,m)}Fn(s,ce,me);return;case"option":for(var ht in o)ce=o[ht],o.hasOwnProperty(ht)&&ce!=null&&!c.hasOwnProperty(ht)&&(ht==="selected"?s.selected=!1:$s(s,r,ht,null,c,ce));for(U in c)ce=c[U],me=o[U],c.hasOwnProperty(U)&&ce!==me&&(ce!=null||me!=null)&&(U==="selected"?s.selected=ce&&typeof ce!="function"&&typeof ce!="symbol":$s(s,r,U,ce,c,me));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Dt in o)ce=o[Dt],o.hasOwnProperty(Dt)&&ce!=null&&!c.hasOwnProperty(Dt)&&$s(s,r,Dt,null,c,ce);for(oe in c)if(ce=c[oe],me=o[oe],c.hasOwnProperty(oe)&&ce!==me&&(ce!=null||me!=null))switch(oe){case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(i(137,r));break;default:$s(s,r,oe,ce,c,me)}return;default:if(ln(r)){for(var Ws in o)ce=o[Ws],o.hasOwnProperty(Ws)&&ce!==void 0&&!c.hasOwnProperty(Ws)&&Qm(s,r,Ws,void 0,c,ce);for(ke in c)ce=c[ke],me=o[ke],!c.hasOwnProperty(ke)||ce===me||ce===void 0&&me===void 0||Qm(s,r,ke,ce,c,me);return}}for(var J in o)ce=o[J],o.hasOwnProperty(J)&&ce!=null&&!c.hasOwnProperty(J)&&$s(s,r,J,null,c,ce);for(Ce in c)ce=c[Ce],me=o[Ce],!c.hasOwnProperty(Ce)||ce===me||ce==null&&me==null||$s(s,r,Ce,ce,c,me)}function V0(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Dj(){if(typeof performance.getEntriesByType=="function"){for(var s=0,r=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var f=o[c],m=f.transferSize,x=f.initiatorType,N=f.duration;if(m&&N&&V0(x)){for(x=0,N=f.responseEnd,c+=1;c<o.length;c++){var U=o[c],oe=U.startTime;if(oe>N)break;var ke=U.transferSize,Ce=U.initiatorType;ke&&V0(Ce)&&(U=U.responseEnd,x+=ke*(U<N?1:(N-oe)/(U-oe)))}if(--c,r+=8*(m+x)/(f.duration/1e3),s++,10<s)break}}if(0<s)return r/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var Xm=null,Jm=null;function Vd(s){return s.nodeType===9?s:s.ownerDocument}function B0(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function U0(s,r){if(s===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&r==="foreignObject"?0:s}function Zm(s,r){return s==="textarea"||s==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var ep=null;function Pj(){var s=window.event;return s&&s.type==="popstate"?s===ep?!1:(ep=s,!0):(ep=null,!1)}var z0=typeof setTimeout=="function"?setTimeout:void 0,Lj=typeof clearTimeout=="function"?clearTimeout:void 0,F0=typeof Promise=="function"?Promise:void 0,Oj=typeof queueMicrotask=="function"?queueMicrotask:typeof F0<"u"?function(s){return F0.resolve(null).then(s).catch(Vj)}:z0;function Vj(s){setTimeout(function(){throw s})}function zi(s){return s==="head"}function H0(s,r){var o=r,c=0;do{var f=o.nextSibling;if(s.removeChild(o),f&&f.nodeType===8)if(o=f.data,o==="/$"||o==="/&"){if(c===0){s.removeChild(f),Pl(r);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")Uc(s.ownerDocument.documentElement);else if(o==="head"){o=s.ownerDocument.head,Uc(o);for(var m=o.firstChild;m;){var x=m.nextSibling,N=m.nodeName;m[hn]||N==="SCRIPT"||N==="STYLE"||N==="LINK"&&m.rel.toLowerCase()==="stylesheet"||o.removeChild(m),m=x}}else o==="body"&&Uc(s.ownerDocument.body);o=f}while(o);Pl(r)}function q0(s,r){var o=s;s=0;do{var c=o.nextSibling;if(o.nodeType===1?r?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(r?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(s===0)break;s--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||s++;o=c}while(o)}function tp(s){var r=s.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var o=r;switch(r=r.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":tp(o),fn(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}s.removeChild(o)}}function Bj(s,r,o,c){for(;s.nodeType===1;){var f=o;if(s.nodeName.toLowerCase()!==r.toLowerCase()){if(!c&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(c){if(!s[hn])switch(r){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(m=s.getAttribute("rel"),m==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(m!==f.rel||s.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||s.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||s.getAttribute("title")!==(f.title==null?null:f.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(m=s.getAttribute("src"),(m!==(f.src==null?null:f.src)||s.getAttribute("type")!==(f.type==null?null:f.type)||s.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&m&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(r==="input"&&s.type==="hidden"){var m=f.name==null?null:""+f.name;if(f.type==="hidden"&&s.getAttribute("name")===m)return s}else return s;if(s=ra(s.nextSibling),s===null)break}return null}function Uj(s,r,o){if(r==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!o||(s=ra(s.nextSibling),s===null))return null;return s}function $0(s,r){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!r||(s=ra(s.nextSibling),s===null))return null;return s}function sp(s){return s.data==="$?"||s.data==="$~"}function np(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function zj(s,r){var o=s.ownerDocument;if(s.data==="$~")s._reactRetry=r;else if(s.data!=="$?"||o.readyState!=="loading")r();else{var c=function(){r(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),s._reactRetry=c}}function ra(s){for(;s!=null;s=s.nextSibling){var r=s.nodeType;if(r===1||r===3)break;if(r===8){if(r=s.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return s}var rp=null;function W0(s){s=s.nextSibling;for(var r=0;s;){if(s.nodeType===8){var o=s.data;if(o==="/$"||o==="/&"){if(r===0)return ra(s.nextSibling);r--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||r++}s=s.nextSibling}return null}function G0(s){s=s.previousSibling;for(var r=0;s;){if(s.nodeType===8){var o=s.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(r===0)return s;r--}else o!=="/$"&&o!=="/&"||r++}s=s.previousSibling}return null}function K0(s,r,o){switch(r=Vd(o),s){case"html":if(s=r.documentElement,!s)throw Error(i(452));return s;case"head":if(s=r.head,!s)throw Error(i(453));return s;case"body":if(s=r.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function Uc(s){for(var r=s.attributes;r.length;)s.removeAttributeNode(r[0]);fn(s)}var aa=new Map,Y0=new Set;function Bd(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var ci=fe.d;fe.d={f:Fj,r:Hj,D:qj,C:$j,L:Wj,m:Gj,X:Yj,S:Kj,M:Qj};function Fj(){var s=ci.f(),r=Rd();return s||r}function Hj(s){var r=$(s);r!==null&&r.tag===5&&r.type==="form"?hv(r):ci.r(s)}var Il=typeof document>"u"?null:document;function Q0(s,r,o){var c=Il;if(c&&typeof r=="string"&&r){var f=xt(r);f='link[rel="'+s+'"][href="'+f+'"]',typeof o=="string"&&(f+='[crossorigin="'+o+'"]'),Y0.has(f)||(Y0.add(f),s={rel:s,crossOrigin:o,href:r},c.querySelector(f)===null&&(r=c.createElement("link"),sr(r,"link",s),S(r),c.head.appendChild(r)))}}function qj(s){ci.D(s),Q0("dns-prefetch",s,null)}function $j(s,r){ci.C(s,r),Q0("preconnect",s,r)}function Wj(s,r,o){ci.L(s,r,o);var c=Il;if(c&&s&&r){var f='link[rel="preload"][as="'+xt(r)+'"]';r==="image"&&o&&o.imageSrcSet?(f+='[imagesrcset="'+xt(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(f+='[imagesizes="'+xt(o.imageSizes)+'"]')):f+='[href="'+xt(s)+'"]';var m=f;switch(r){case"style":m=Ml(s);break;case"script":m=Dl(s)}aa.has(m)||(s=k({rel:"preload",href:r==="image"&&o&&o.imageSrcSet?void 0:s,as:r},o),aa.set(m,s),c.querySelector(f)!==null||r==="style"&&c.querySelector(zc(m))||r==="script"&&c.querySelector(Fc(m))||(r=c.createElement("link"),sr(r,"link",s),S(r),c.head.appendChild(r)))}}function Gj(s,r){ci.m(s,r);var o=Il;if(o&&s){var c=r&&typeof r.as=="string"?r.as:"script",f='link[rel="modulepreload"][as="'+xt(c)+'"][href="'+xt(s)+'"]',m=f;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=Dl(s)}if(!aa.has(m)&&(s=k({rel:"modulepreload",href:s},r),aa.set(m,s),o.querySelector(f)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Fc(m)))return}c=o.createElement("link"),sr(c,"link",s),S(c),o.head.appendChild(c)}}}function Kj(s,r,o){ci.S(s,r,o);var c=Il;if(c&&s){var f=E(c).hoistableStyles,m=Ml(s);r=r||"default";var x=f.get(m);if(!x){var N={loading:0,preload:null};if(x=c.querySelector(zc(m)))N.loading=5;else{s=k({rel:"stylesheet",href:s,"data-precedence":r},o),(o=aa.get(m))&&ap(s,o);var U=x=c.createElement("link");S(U),sr(U,"link",s),U._p=new Promise(function(oe,ke){U.onload=oe,U.onerror=ke}),U.addEventListener("load",function(){N.loading|=1}),U.addEventListener("error",function(){N.loading|=2}),N.loading|=4,Ud(x,r,c)}x={type:"stylesheet",instance:x,count:1,state:N},f.set(m,x)}}}function Yj(s,r){ci.X(s,r);var o=Il;if(o&&s){var c=E(o).hoistableScripts,f=Dl(s),m=c.get(f);m||(m=o.querySelector(Fc(f)),m||(s=k({src:s,async:!0},r),(r=aa.get(f))&&ip(s,r),m=o.createElement("script"),S(m),sr(m,"link",s),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function Qj(s,r){ci.M(s,r);var o=Il;if(o&&s){var c=E(o).hoistableScripts,f=Dl(s),m=c.get(f);m||(m=o.querySelector(Fc(f)),m||(s=k({src:s,async:!0,type:"module"},r),(r=aa.get(f))&&ip(s,r),m=o.createElement("script"),S(m),sr(m,"link",s),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function X0(s,r,o,c){var f=(f=Ue.current)?Bd(f):null;if(!f)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(r=Ml(o.href),o=E(f).hoistableStyles,c=o.get(r),c||(c={type:"style",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){s=Ml(o.href);var m=E(f).hoistableStyles,x=m.get(s);if(x||(f=f.ownerDocument||f,x={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(s,x),(m=f.querySelector(zc(s)))&&!m._p&&(x.instance=m,x.state.loading=5),aa.has(s)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},aa.set(s,o),m||Xj(f,s,o,x.state))),r&&c===null)throw Error(i(528,""));return x}if(r&&c!==null)throw Error(i(529,""));return null;case"script":return r=o.async,o=o.src,typeof o=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=Dl(o),o=E(f).hoistableScripts,c=o.get(r),c||(c={type:"script",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function Ml(s){return'href="'+xt(s)+'"'}function zc(s){return'link[rel="stylesheet"]['+s+"]"}function J0(s){return k({},s,{"data-precedence":s.precedence,precedence:null})}function Xj(s,r,o,c){s.querySelector('link[rel="preload"][as="style"]['+r+"]")?c.loading=1:(r=s.createElement("link"),c.preload=r,r.addEventListener("load",function(){return c.loading|=1}),r.addEventListener("error",function(){return c.loading|=2}),sr(r,"link",o),S(r),s.head.appendChild(r))}function Dl(s){return'[src="'+xt(s)+'"]'}function Fc(s){return"script[async]"+s}function Z0(s,r,o){if(r.count++,r.instance===null)switch(r.type){case"style":var c=s.querySelector('style[data-href~="'+xt(o.href)+'"]');if(c)return r.instance=c,S(c),c;var f=k({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(s.ownerDocument||s).createElement("style"),S(c),sr(c,"style",f),Ud(c,o.precedence,s),r.instance=c;case"stylesheet":f=Ml(o.href);var m=s.querySelector(zc(f));if(m)return r.state.loading|=4,r.instance=m,S(m),m;c=J0(o),(f=aa.get(f))&&ap(c,f),m=(s.ownerDocument||s).createElement("link"),S(m);var x=m;return x._p=new Promise(function(N,U){x.onload=N,x.onerror=U}),sr(m,"link",c),r.state.loading|=4,Ud(m,o.precedence,s),r.instance=m;case"script":return m=Dl(o.src),(f=s.querySelector(Fc(m)))?(r.instance=f,S(f),f):(c=o,(f=aa.get(m))&&(c=k({},o),ip(c,f)),s=s.ownerDocument||s,f=s.createElement("script"),S(f),sr(f,"link",c),s.head.appendChild(f),r.instance=f);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(c=r.instance,r.state.loading|=4,Ud(c,o.precedence,s));return r.instance}function Ud(s,r,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=c.length?c[c.length-1]:null,m=f,x=0;x<c.length;x++){var N=c[x];if(N.dataset.precedence===r)m=N;else if(m!==f)break}m?m.parentNode.insertBefore(s,m.nextSibling):(r=o.nodeType===9?o.head:o,r.insertBefore(s,r.firstChild))}function ap(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.title==null&&(s.title=r.title)}function ip(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.integrity==null&&(s.integrity=r.integrity)}var zd=null;function e1(s,r,o){if(zd===null){var c=new Map,f=zd=new Map;f.set(o,c)}else f=zd,c=f.get(o),c||(c=new Map,f.set(o,c));if(c.has(s))return c;for(c.set(s,null),o=o.getElementsByTagName(s),f=0;f<o.length;f++){var m=o[f];if(!(m[hn]||m[it]||s==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var x=m.getAttribute(r)||"";x=s+x;var N=c.get(x);N?N.push(m):c.set(x,[m])}}return c}function t1(s,r,o){s=s.ownerDocument||s,s.head.insertBefore(o,r==="title"?s.querySelector("head > title"):null)}function Jj(s,r,o){if(o===1||r.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;return r.rel==="stylesheet"?(s=r.disabled,typeof r.precedence=="string"&&s==null):!0;case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function s1(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function Zj(s,r,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var f=Ml(c.href),m=r.querySelector(zc(f));if(m){r=m._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(s.count++,s=Fd.bind(s),r.then(s,s)),o.state.loading|=4,o.instance=m,S(m);return}m=r.ownerDocument||r,c=J0(c),(f=aa.get(f))&&ap(c,f),m=m.createElement("link"),S(m);var x=m;x._p=new Promise(function(N,U){x.onload=N,x.onerror=U}),sr(m,"link",c),o.instance=m}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(o,r),(r=o.state.preload)&&(o.state.loading&3)===0&&(s.count++,o=Fd.bind(s),r.addEventListener("load",o),r.addEventListener("error",o))}}var op=0;function eT(s,r){return s.stylesheets&&s.count===0&&qd(s,s.stylesheets),0<s.count||0<s.imgCount?function(o){var c=setTimeout(function(){if(s.stylesheets&&qd(s,s.stylesheets),s.unsuspend){var m=s.unsuspend;s.unsuspend=null,m()}},6e4+r);0<s.imgBytes&&op===0&&(op=62500*Dj());var f=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&qd(s,s.stylesheets),s.unsuspend)){var m=s.unsuspend;s.unsuspend=null,m()}},(s.imgBytes>op?50:800)+r);return s.unsuspend=o,function(){s.unsuspend=null,clearTimeout(c),clearTimeout(f)}}:null}function Fd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)qd(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Hd=null;function qd(s,r){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Hd=new Map,r.forEach(tT,s),Hd=null,Fd.call(s))}function tT(s,r){if(!(r.state.loading&4)){var o=Hd.get(s);if(o)var c=o.get(null);else{o=new Map,Hd.set(s,o);for(var f=s.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<f.length;m++){var x=f[m];(x.nodeName==="LINK"||x.getAttribute("media")!=="not all")&&(o.set(x.dataset.precedence,x),c=x)}c&&o.set(null,c)}f=r.instance,x=f.getAttribute("data-precedence"),m=o.get(x)||c,m===c&&o.set(null,f),o.set(x,f),this.count++,c=Fd.bind(this),f.addEventListener("load",c),f.addEventListener("error",c),m?m.parentNode.insertBefore(f,m.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(f,s.firstChild)),r.state.loading|=4}}var Hc={$$typeof:le,Provider:null,Consumer:null,_currentValue:Me,_currentValue2:Me,_threadCount:0};function sT(s,r,o,c,f,m,x,N,U){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=zt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zt(0),this.hiddenUpdates=zt(null),this.identifierPrefix=c,this.onUncaughtError=f,this.onCaughtError=m,this.onRecoverableError=x,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=U,this.incompleteTransitions=new Map}function n1(s,r,o,c,f,m,x,N,U,oe,ke,Ce){return s=new sT(s,r,o,x,U,oe,ke,Ce,N),r=1,m===!0&&(r|=24),m=Br(3,null,null,r),s.current=m,m.stateNode=s,r=Uf(),r.refCount++,s.pooledCache=r,r.refCount++,m.memoizedState={element:c,isDehydrated:o,cache:r},qf(m),s}function r1(s){return s?(s=dl,s):dl}function a1(s,r,o,c,f,m){f=r1(f),c.context===null?c.context=f:c.pendingContext=f,c=Ri(r),c.payload={element:o},m=m===void 0?null:m,m!==null&&(c.callback=m),o=Ai(s,c,r),o!==null&&(Ir(o,s,r),wc(o,s,r))}function i1(s,r){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var o=s.retryLane;s.retryLane=o!==0&&o<r?o:r}}function lp(s,r){i1(s,r),(s=s.alternate)&&i1(s,r)}function o1(s){if(s.tag===13||s.tag===31){var r=Eo(s,67108864);r!==null&&Ir(r,s,67108864),lp(s,67108864)}}function l1(s){if(s.tag===13||s.tag===31){var r=qr();r=z(r);var o=Eo(s,r);o!==null&&Ir(o,s,r),lp(s,r)}}var $d=!0;function nT(s,r,o,c){var f=H.T;H.T=null;var m=fe.p;try{fe.p=2,cp(s,r,o,c)}finally{fe.p=m,H.T=f}}function rT(s,r,o,c){var f=H.T;H.T=null;var m=fe.p;try{fe.p=8,cp(s,r,o,c)}finally{fe.p=m,H.T=f}}function cp(s,r,o,c){if($d){var f=up(c);if(f===null)Ym(s,r,c,Wd,o),u1(s,c);else if(iT(f,s,r,o,c))c.stopPropagation();else if(u1(s,c),r&4&&-1<aT.indexOf(s)){for(;f!==null;){var m=$(f);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var x=at(m.pendingLanes);if(x!==0){var N=m;for(N.pendingLanes|=2,N.entangledLanes|=2;x;){var U=1<<31-De(x);N.entanglements[1]|=U,x&=~U}Ma(m),(Ls&6)===0&&(Sd=as()+500,Oc(0))}}break;case 31:case 13:N=Eo(m,2),N!==null&&Ir(N,m,2),Rd(),lp(m,2)}if(m=up(c),m===null&&Ym(s,r,c,Wd,o),m===f)break;f=m}f!==null&&c.stopPropagation()}else Ym(s,r,c,null,o)}}function up(s){return s=mn(s),dp(s)}var Wd=null;function dp(s){if(Wd=null,s=Es(s),s!==null){var r=u(s);if(r===null)s=null;else{var o=r.tag;if(o===13){if(s=d(r),s!==null)return s;s=null}else if(o===31){if(s=p(r),s!==null)return s;s=null}else if(o===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;s=null}else r!==s&&(s=null)}}return Wd=s,null}function c1(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(on()){case qt:return 2;case Cs:return 8;case ns:case _s:return 32;case he:return 268435456;default:return 32}default:return 32}}var hp=!1,Fi=null,Hi=null,qi=null,qc=new Map,$c=new Map,$i=[],aT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function u1(s,r){switch(s){case"focusin":case"focusout":Fi=null;break;case"dragenter":case"dragleave":Hi=null;break;case"mouseover":case"mouseout":qi=null;break;case"pointerover":case"pointerout":qc.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":$c.delete(r.pointerId)}}function Wc(s,r,o,c,f,m){return s===null||s.nativeEvent!==m?(s={blockedOn:r,domEventName:o,eventSystemFlags:c,nativeEvent:m,targetContainers:[f]},r!==null&&(r=$(r),r!==null&&o1(r)),s):(s.eventSystemFlags|=c,r=s.targetContainers,f!==null&&r.indexOf(f)===-1&&r.push(f),s)}function iT(s,r,o,c,f){switch(r){case"focusin":return Fi=Wc(Fi,s,r,o,c,f),!0;case"dragenter":return Hi=Wc(Hi,s,r,o,c,f),!0;case"mouseover":return qi=Wc(qi,s,r,o,c,f),!0;case"pointerover":var m=f.pointerId;return qc.set(m,Wc(qc.get(m)||null,s,r,o,c,f)),!0;case"gotpointercapture":return m=f.pointerId,$c.set(m,Wc($c.get(m)||null,s,r,o,c,f)),!0}return!1}function d1(s){var r=Es(s.target);if(r!==null){var o=u(r);if(o!==null){if(r=o.tag,r===13){if(r=d(o),r!==null){s.blockedOn=r,_e(s.priority,function(){l1(o)});return}}else if(r===31){if(r=p(o),r!==null){s.blockedOn=r,_e(s.priority,function(){l1(o)});return}}else if(r===3&&o.stateNode.current.memoizedState.isDehydrated){s.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Gd(s){if(s.blockedOn!==null)return!1;for(var r=s.targetContainers;0<r.length;){var o=up(s.nativeEvent);if(o===null){o=s.nativeEvent;var c=new o.constructor(o.type,o);sn=c,o.target.dispatchEvent(c),sn=null}else return r=$(o),r!==null&&o1(r),s.blockedOn=o,!1;r.shift()}return!0}function h1(s,r,o){Gd(s)&&o.delete(r)}function oT(){hp=!1,Fi!==null&&Gd(Fi)&&(Fi=null),Hi!==null&&Gd(Hi)&&(Hi=null),qi!==null&&Gd(qi)&&(qi=null),qc.forEach(h1),$c.forEach(h1)}function Kd(s,r){s.blockedOn===r&&(s.blockedOn=null,hp||(hp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,oT)))}var Yd=null;function f1(s){Yd!==s&&(Yd=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Yd===s&&(Yd=null);for(var r=0;r<s.length;r+=3){var o=s[r],c=s[r+1],f=s[r+2];if(typeof c!="function"){if(dp(c||o)===null)continue;break}var m=$(o);m!==null&&(s.splice(r,3),r-=3,um(m,{pending:!0,data:f,method:o.method,action:c},c,f))}}))}function Pl(s){function r(U){return Kd(U,s)}Fi!==null&&Kd(Fi,s),Hi!==null&&Kd(Hi,s),qi!==null&&Kd(qi,s),qc.forEach(r),$c.forEach(r);for(var o=0;o<$i.length;o++){var c=$i[o];c.blockedOn===s&&(c.blockedOn=null)}for(;0<$i.length&&(o=$i[0],o.blockedOn===null);)d1(o),o.blockedOn===null&&$i.shift();if(o=(s.ownerDocument||s).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var f=o[c],m=o[c+1],x=f[Rt]||null;if(typeof m=="function")x||f1(o);else if(x){var N=null;if(m&&m.hasAttribute("formAction")){if(f=m,x=m[Rt]||null)N=x.formAction;else if(dp(f)!==null)continue}else N=x.action;typeof N=="function"?o[c+1]=N:(o.splice(c,3),c-=3),f1(o)}}}function m1(){function s(m){m.canIntercept&&m.info==="react-transition"&&m.intercept({handler:function(){return new Promise(function(x){return f=x})},focusReset:"manual",scroll:"manual"})}function r(){f!==null&&(f(),f=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var m=navigation.currentEntry;m&&m.url!=null&&navigation.navigate(m.url,{state:m.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,f=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),f!==null&&(f(),f=null)}}}function fp(s){this._internalRoot=s}Qd.prototype.render=fp.prototype.render=function(s){var r=this._internalRoot;if(r===null)throw Error(i(409));var o=r.current,c=qr();a1(o,c,s,r,null,null)},Qd.prototype.unmount=fp.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var r=s.containerInfo;a1(s.current,2,null,s,null,null),Rd(),r[ct]=null}};function Qd(s){this._internalRoot=s}Qd.prototype.unstable_scheduleHydration=function(s){if(s){var r=we();s={blockedOn:null,target:s,priority:r};for(var o=0;o<$i.length&&r!==0&&r<$i[o].priority;o++);$i.splice(o,0,s),o===0&&d1(s)}};var p1=e.version;if(p1!=="19.2.4")throw Error(i(527,p1,"19.2.4"));fe.findDOMNode=function(s){var r=s._reactInternals;if(r===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=y(r),s=s!==null?w(s):null,s=s===null?null:s.stateNode,s};var lT={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:H,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xd.isDisabled&&Xd.supportsFiber)try{Ye=Xd.inject(lT),Ve=Xd}catch{}}return Kc.createRoot=function(s,r){if(!l(s))throw Error(i(299));var o=!1,c="",f=_v,m=kv,x=jv;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onUncaughtError!==void 0&&(f=r.onUncaughtError),r.onCaughtError!==void 0&&(m=r.onCaughtError),r.onRecoverableError!==void 0&&(x=r.onRecoverableError)),r=n1(s,1,!1,null,null,o,c,null,f,m,x,m1),s[ct]=r.current,Km(s),new fp(r)},Kc.hydrateRoot=function(s,r,o){if(!l(s))throw Error(i(299));var c=!1,f="",m=_v,x=kv,N=jv,U=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(m=o.onUncaughtError),o.onCaughtError!==void 0&&(x=o.onCaughtError),o.onRecoverableError!==void 0&&(N=o.onRecoverableError),o.formState!==void 0&&(U=o.formState)),r=n1(s,1,!0,r,o??null,c,f,U,m,x,N,m1),r.context=r1(null),o=r.current,c=qr(),c=z(c),f=Ri(c),f.callback=null,Ai(o,f,c),o=c,r.current.lanes=o,Rs(r,o),Ma(r),s[ct]=r.current,Km(s),new Qd(r)},Kc.version="19.2.4",Kc}var T1;function bT(){if(T1)return gp.exports;T1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),gp.exports=yT(),gp.exports}var vT=bT();const xT="modulepreload",wT=function(n){return"/login/"+n},E1={},kr=function(e,t,i){let l=Promise.resolve();if(t&&t.length>0){let g=function(y){return Promise.all(y.map(w=>Promise.resolve(w).then(k=>({status:"fulfilled",value:k}),k=>({status:"rejected",reason:k}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),p=d?.nonce||d?.getAttribute("nonce");l=g(t.map(y=>{if(y=wT(y),y in E1)return;E1[y]=!0;const w=y.endsWith(".css"),k=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${k}`))return;const j=document.createElement("link");if(j.rel=w?"stylesheet":xT,w||(j.as="script"),j.crossOrigin="",j.href=y,p&&j.setAttribute("nonce",p),document.head.appendChild(j),w)return new Promise((O,q)=>{j.addEventListener("load",O),j.addEventListener("error",()=>q(new Error(`Unable to preload CSS for ${y}`)))})}))}function u(d){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=d,window.dispatchEvent(p),!p.defaultPrevented)throw d}return l.then(d=>{for(const p of d||[])p.status==="rejected"&&u(p.reason);return e().catch(u)})};var N1="popstate";function _T(n={}){function e(i,l){let{pathname:u,search:d,hash:p}=i.location;return eg("",{pathname:u,search:d,hash:p},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function t(i,l){return typeof l=="string"?l:gu(l)}return jT(e,t,null,n)}function dn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function oa(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function kT(){return Math.random().toString(36).substring(2,10)}function S1(n,e){return{usr:n.state,key:n.key,idx:e}}function eg(n,e,t=null,i){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?sc(e):e,state:t,key:e&&e.key||i||kT()}}function gu({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function sc(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substring(i),n=n.substring(0,i)),n&&(e.pathname=n)}return e}function jT(n,e,t,i={}){let{window:l=document.defaultView,v5Compat:u=!1}=i,d=l.history,p="POP",g=null,y=w();y==null&&(y=0,d.replaceState({...d.state,idx:y},""));function w(){return(d.state||{idx:null}).idx}function k(){p="POP";let V=w(),ne=V==null?null:V-y;y=V,g&&g({action:p,location:B.location,delta:ne})}function j(V,ne){p="PUSH";let K=eg(B.location,V,ne);y=w()+1;let le=S1(K,y),ge=B.createHref(K);try{d.pushState(le,"",ge)}catch(Ie){if(Ie instanceof DOMException&&Ie.name==="DataCloneError")throw Ie;l.location.assign(ge)}u&&g&&g({action:p,location:B.location,delta:1})}function O(V,ne){p="REPLACE";let K=eg(B.location,V,ne);y=w();let le=S1(K,y),ge=B.createHref(K);d.replaceState(le,"",ge),u&&g&&g({action:p,location:B.location,delta:0})}function q(V){return TT(V)}let B={get action(){return p},get location(){return n(l,d)},listen(V){if(g)throw new Error("A history only accepts one active listener");return l.addEventListener(N1,k),g=V,()=>{l.removeEventListener(N1,k),g=null}},createHref(V){return e(l,V)},createURL:q,encodeLocation(V){let ne=q(V);return{pathname:ne.pathname,search:ne.search,hash:ne.hash}},push:j,replace:O,go(V){return d.go(V)}};return B}function TT(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),dn(t,"No window.location.(origin|href) available to create URL");let i=typeof n=="string"?n:gu(n);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function E2(n,e,t="/"){return ET(n,e,t,!1)}function ET(n,e,t,i){let l=typeof e=="string"?sc(e):e,u=gi(l.pathname||"/",t);if(u==null)return null;let d=N2(n);NT(d);let p=null;for(let g=0;p==null&&g<d.length;++g){let y=VT(u);p=LT(d[g],y,i)}return p}function N2(n,e=[],t=[],i="",l=!1){let u=(d,p,g=l,y)=>{let w={relativePath:y===void 0?d.path||"":y,caseSensitive:d.caseSensitive===!0,childrenIndex:p,route:d};if(w.relativePath.startsWith("/")){if(!w.relativePath.startsWith(i)&&g)return;dn(w.relativePath.startsWith(i),`Absolute route path "${w.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),w.relativePath=w.relativePath.slice(i.length)}let k=hi([i,w.relativePath]),j=t.concat(w);d.children&&d.children.length>0&&(dn(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${k}".`),N2(d.children,e,j,k,g)),!(d.path==null&&!d.index)&&e.push({path:k,score:DT(k,d.index),routesMeta:j})};return n.forEach((d,p)=>{if(d.path===""||!d.path?.includes("?"))u(d,p);else for(let g of S2(d.path))u(d,p,!0,g)}),e}function S2(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,l=t.endsWith("?"),u=t.replace(/\?$/,"");if(i.length===0)return l?[u,""]:[u];let d=S2(i.join("/")),p=[];return p.push(...d.map(g=>g===""?u:[u,g].join("/"))),l&&p.push(...d),p.map(g=>n.startsWith("/")&&g===""?"/":g)}function NT(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:PT(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var ST=/^:[\w-]+$/,CT=3,RT=2,AT=1,IT=10,MT=-2,C1=n=>n==="*";function DT(n,e){let t=n.split("/"),i=t.length;return t.some(C1)&&(i+=MT),e&&(i+=RT),t.filter(l=>!C1(l)).reduce((l,u)=>l+(ST.test(u)?CT:u===""?AT:IT),i)}function PT(n,e){return n.length===e.length&&n.slice(0,-1).every((i,l)=>i===e[l])?n[n.length-1]-e[e.length-1]:0}function LT(n,e,t=!1){let{routesMeta:i}=n,l={},u="/",d=[];for(let p=0;p<i.length;++p){let g=i[p],y=p===i.length-1,w=u==="/"?e:e.slice(u.length)||"/",k=jh({path:g.relativePath,caseSensitive:g.caseSensitive,end:y},w),j=g.route;if(!k&&y&&t&&!i[i.length-1].route.index&&(k=jh({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},w)),!k)return null;Object.assign(l,k.params),d.push({params:l,pathname:hi([u,k.pathname]),pathnameBase:FT(hi([u,k.pathnameBase])),route:j}),k.pathnameBase!=="/"&&(u=hi([u,k.pathnameBase]))}return d}function jh(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=OT(n.path,n.caseSensitive,n.end),l=e.match(t);if(!l)return null;let u=l[0],d=u.replace(/(.)\/+$/,"$1"),p=l.slice(1);return{params:i.reduce((y,{paramName:w,isOptional:k},j)=>{if(w==="*"){let q=p[j]||"";d=u.slice(0,u.length-q.length).replace(/(.)\/+$/,"$1")}const O=p[j];return k&&!O?y[w]=void 0:y[w]=(O||"").replace(/%2F/g,"/"),y},{}),pathname:u,pathnameBase:d,pattern:n}}function OT(n,e=!1,t=!0){oa(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let i=[],l="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,p,g)=>(i.push({paramName:p,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(i.push({paramName:"*"}),l+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?l+="\\/*$":n!==""&&n!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,e?void 0:"i"),i]}function VT(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return oa(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function gi(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}var BT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function UT(n,e="/"){let{pathname:t,search:i="",hash:l=""}=typeof n=="string"?sc(n):n,u;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?u=R1(t.substring(1),"/"):u=R1(t,e)):u=e,{pathname:u,search:HT(i),hash:qT(l)}}function R1(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(l=>{l===".."?t.length>1&&t.pop():l!=="."&&t.push(l)}),t.length>1?t.join("/"):"/"}function xp(n,e,t,i){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function zT(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Ag(n){let e=zT(n);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function Ig(n,e,t,i=!1){let l;typeof n=="string"?l=sc(n):(l={...n},dn(!l.pathname||!l.pathname.includes("?"),xp("?","pathname","search",l)),dn(!l.pathname||!l.pathname.includes("#"),xp("#","pathname","hash",l)),dn(!l.search||!l.search.includes("#"),xp("#","search","hash",l)));let u=n===""||l.pathname==="",d=u?"/":l.pathname,p;if(d==null)p=t;else{let k=e.length-1;if(!i&&d.startsWith("..")){let j=d.split("/");for(;j[0]==="..";)j.shift(),k-=1;l.pathname=j.join("/")}p=k>=0?e[k]:"/"}let g=UT(l,p),y=d&&d!=="/"&&d.endsWith("/"),w=(u||d===".")&&t.endsWith("/");return!g.pathname.endsWith("/")&&(y||w)&&(g.pathname+="/"),g}var hi=n=>n.join("/").replace(/\/\/+/g,"/"),FT=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),HT=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,qT=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,$T=class{constructor(n,e,t,i=!1){this.status=n,this.statusText=e||"",this.internal=i,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function WT(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function GT(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var C2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function R2(n,e){let t=n;if(typeof t!="string"||!BT.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let i=t,l=!1;if(C2)try{let u=new URL(window.location.href),d=t.startsWith("//")?new URL(u.protocol+t):new URL(t),p=gi(d.pathname,e);d.origin===u.origin&&p!=null?t=p+d.search+d.hash:l=!0}catch{oa(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:l,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var A2=["POST","PUT","PATCH","DELETE"];new Set(A2);var KT=["GET",...A2];new Set(KT);var nc=v.createContext(null);nc.displayName="DataRouter";var Gh=v.createContext(null);Gh.displayName="DataRouterState";var YT=v.createContext(!1),I2=v.createContext({isTransitioning:!1});I2.displayName="ViewTransition";var QT=v.createContext(new Map);QT.displayName="Fetchers";var XT=v.createContext(null);XT.displayName="Await";var Kr=v.createContext(null);Kr.displayName="Navigation";var Cu=v.createContext(null);Cu.displayName="Location";var _a=v.createContext({outlet:null,matches:[],isDataRoute:!1});_a.displayName="Route";var Mg=v.createContext(null);Mg.displayName="RouteError";var M2="REACT_ROUTER_ERROR",JT="REDIRECT",ZT="ROUTE_ERROR_RESPONSE";function eE(n){if(n.startsWith(`${M2}:${JT}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function tE(n){if(n.startsWith(`${M2}:${ZT}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new $T(e.status,e.statusText,e.data)}catch{}}function sE(n,{relative:e}={}){dn(rc(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=v.useContext(Kr),{hash:l,pathname:u,search:d}=Ru(n,{relative:e}),p=u;return t!=="/"&&(p=u==="/"?t:hi([t,u])),i.createHref({pathname:p,search:d,hash:l})}function rc(){return v.useContext(Cu)!=null}function ka(){return dn(rc(),"useLocation() may be used only in the context of a <Router> component."),v.useContext(Cu).location}var D2="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function P2(n){v.useContext(Kr).static||v.useLayoutEffect(n)}function Wn(){let{isDataRoute:n}=v.useContext(_a);return n?gE():nE()}function nE(){dn(rc(),"useNavigate() may be used only in the context of a <Router> component.");let n=v.useContext(nc),{basename:e,navigator:t}=v.useContext(Kr),{matches:i}=v.useContext(_a),{pathname:l}=ka(),u=JSON.stringify(Ag(i)),d=v.useRef(!1);return P2(()=>{d.current=!0}),v.useCallback((g,y={})=>{if(oa(d.current,D2),!d.current)return;if(typeof g=="number"){t.go(g);return}let w=Ig(g,JSON.parse(u),l,y.relative==="path");n==null&&e!=="/"&&(w.pathname=w.pathname==="/"?e:hi([e,w.pathname])),(y.replace?t.replace:t.push)(w,y.state,y)},[e,t,u,l,n])}v.createContext(null);function rE(){let{matches:n}=v.useContext(_a),e=n[n.length-1];return e?e.params:{}}function Ru(n,{relative:e}={}){let{matches:t}=v.useContext(_a),{pathname:i}=ka(),l=JSON.stringify(Ag(t));return v.useMemo(()=>Ig(n,JSON.parse(l),i,e==="path"),[n,l,i,e])}function aE(n,e){return L2(n,e)}function L2(n,e,t,i,l){dn(rc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=v.useContext(Kr),{matches:d}=v.useContext(_a),p=d[d.length-1],g=p?p.params:{},y=p?p.pathname:"/",w=p?p.pathnameBase:"/",k=p&&p.route;{let K=k&&k.path||"";V2(y,!k||K.endsWith("*")||K.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${y}" (under <Route path="${K}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${K}"> to <Route path="${K==="/"?"*":`${K}/*`}">.`)}let j=ka(),O;if(e){let K=typeof e=="string"?sc(e):e;dn(w==="/"||K.pathname?.startsWith(w),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${w}" but pathname "${K.pathname}" was given in the \`location\` prop.`),O=K}else O=j;let q=O.pathname||"/",B=q;if(w!=="/"){let K=w.replace(/^\//,"").split("/");B="/"+q.replace(/^\//,"").split("/").slice(K.length).join("/")}let V=E2(n,{pathname:B});oa(k||V!=null,`No routes matched location "${O.pathname}${O.search}${O.hash}" `),oa(V==null||V[V.length-1].route.element!==void 0||V[V.length-1].route.Component!==void 0||V[V.length-1].route.lazy!==void 0,`Matched leaf route at location "${O.pathname}${O.search}${O.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let ne=uE(V&&V.map(K=>Object.assign({},K,{params:Object.assign({},g,K.params),pathname:hi([w,u.encodeLocation?u.encodeLocation(K.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:K.pathname]),pathnameBase:K.pathnameBase==="/"?w:hi([w,u.encodeLocation?u.encodeLocation(K.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:K.pathnameBase])})),d,t,i,l);return e&&ne?v.createElement(Cu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...O},navigationType:"POP"}},ne):ne}function iE(){let n=pE(),e=WT(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:i},u={padding:"2px 4px",backgroundColor:i},d=null;return console.error("Error handled by React Router default ErrorBoundary:",n),d=v.createElement(v.Fragment,null,v.createElement("p",null," Hey developer "),v.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",v.createElement("code",{style:u},"ErrorBoundary")," or"," ",v.createElement("code",{style:u},"errorElement")," prop on your route.")),v.createElement(v.Fragment,null,v.createElement("h2",null,"Unexpected Application Error!"),v.createElement("h3",{style:{fontStyle:"italic"}},e),t?v.createElement("pre",{style:l},t):null,d)}var oE=v.createElement(iE,null),O2=class extends v.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=tE(n.digest);t&&(n=t)}let e=n!==void 0?v.createElement(_a.Provider,{value:this.props.routeContext},v.createElement(Mg.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?v.createElement(lE,{error:n},e):e}};O2.contextType=YT;var wp=new WeakMap;function lE({children:n,error:e}){let{basename:t}=v.useContext(Kr);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=eE(e.digest);if(i){let l=wp.get(e);if(l)throw l;let u=R2(i.location,t);if(C2&&!wp.get(e))if(u.isExternal||i.reloadDocument)window.location.href=u.absoluteURL||u.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(u.to,{replace:i.replace}));throw wp.set(e,d),d}return v.createElement("meta",{httpEquiv:"refresh",content:`0;url=${u.absoluteURL||u.to}`})}}return n}function cE({routeContext:n,match:e,children:t}){let i=v.useContext(nc);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),v.createElement(_a.Provider,{value:n},t)}function uE(n,e=[],t=null,i=null,l=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let u=n,d=t?.errors;if(d!=null){let w=u.findIndex(k=>k.route.id&&d?.[k.route.id]!==void 0);dn(w>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),u=u.slice(0,Math.min(u.length,w+1))}let p=!1,g=-1;if(t)for(let w=0;w<u.length;w++){let k=u[w];if((k.route.HydrateFallback||k.route.hydrateFallbackElement)&&(g=w),k.route.id){let{loaderData:j,errors:O}=t,q=k.route.loader&&!j.hasOwnProperty(k.route.id)&&(!O||O[k.route.id]===void 0);if(k.route.lazy||q){p=!0,g>=0?u=u.slice(0,g+1):u=[u[0]];break}}}let y=t&&i?(w,k)=>{i(w,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:GT(t.matches),errorInfo:k})}:void 0;return u.reduceRight((w,k,j)=>{let O,q=!1,B=null,V=null;t&&(O=d&&k.route.id?d[k.route.id]:void 0,B=k.route.errorElement||oE,p&&(g<0&&j===0?(V2("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),q=!0,V=null):g===j&&(q=!0,V=k.route.hydrateFallbackElement||null)));let ne=e.concat(u.slice(0,j+1)),K=()=>{let le;return O?le=B:q?le=V:k.route.Component?le=v.createElement(k.route.Component,null):k.route.element?le=k.route.element:le=w,v.createElement(cE,{match:k,routeContext:{outlet:w,matches:ne,isDataRoute:t!=null},children:le})};return t&&(k.route.ErrorBoundary||k.route.errorElement||j===0)?v.createElement(O2,{location:t.location,revalidation:t.revalidation,component:B,error:O,children:K(),routeContext:{outlet:null,matches:ne,isDataRoute:!0},onError:y}):K()},null)}function Dg(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function dE(n){let e=v.useContext(nc);return dn(e,Dg(n)),e}function hE(n){let e=v.useContext(Gh);return dn(e,Dg(n)),e}function fE(n){let e=v.useContext(_a);return dn(e,Dg(n)),e}function Pg(n){let e=fE(n),t=e.matches[e.matches.length-1];return dn(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function mE(){return Pg("useRouteId")}function pE(){let n=v.useContext(Mg),e=hE("useRouteError"),t=Pg("useRouteError");return n!==void 0?n:e.errors?.[t]}function gE(){let{router:n}=dE("useNavigate"),e=Pg("useNavigate"),t=v.useRef(!1);return P2(()=>{t.current=!0}),v.useCallback(async(l,u={})=>{oa(t.current,D2),t.current&&(typeof l=="number"?await n.navigate(l):await n.navigate(l,{fromRouteId:e,...u}))},[n,e])}var A1={};function V2(n,e,t){!e&&!A1[n]&&(A1[n]=!0,oa(!1,t))}v.memo(yE);function yE({routes:n,future:e,state:t,onError:i}){return L2(n,void 0,t,i,e)}function bE({to:n,replace:e,state:t,relative:i}){dn(rc(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=v.useContext(Kr);oa(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=v.useContext(_a),{pathname:d}=ka(),p=Wn(),g=Ig(n,Ag(u),d,i==="path"),y=JSON.stringify(g);return v.useEffect(()=>{p(JSON.parse(y),{replace:e,state:t,relative:i})},[p,y,i,e,t]),null}function Xs(n){dn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function vE({basename:n="/",children:e=null,location:t,navigationType:i="POP",navigator:l,static:u=!1,unstable_useTransitions:d}){dn(!rc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let p=n.replace(/^\/*/,"/"),g=v.useMemo(()=>({basename:p,navigator:l,static:u,unstable_useTransitions:d,future:{}}),[p,l,u,d]);typeof t=="string"&&(t=sc(t));let{pathname:y="/",search:w="",hash:k="",state:j=null,key:O="default"}=t,q=v.useMemo(()=>{let B=gi(y,p);return B==null?null:{location:{pathname:B,search:w,hash:k,state:j,key:O},navigationType:i}},[p,y,w,k,j,O,i]);return oa(q!=null,`<Router basename="${p}"> is not able to match the URL "${y}${w}${k}" because it does not start with the basename, so the <Router> won't render anything.`),q==null?null:v.createElement(Kr.Provider,{value:g},v.createElement(Cu.Provider,{children:e,value:q}))}function xE({children:n,location:e}){return aE(tg(n),e)}function tg(n,e=[]){let t=[];return v.Children.forEach(n,(i,l)=>{if(!v.isValidElement(i))return;let u=[...e,l];if(i.type===v.Fragment){t.push.apply(t,tg(i.props.children,u));return}dn(i.type===Xs,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),dn(!i.props.index||!i.props.children,"An index route cannot have child routes.");let d={id:i.props.id||u.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(d.children=tg(i.props.children,u)),t.push(d)}),t}var hh="get",fh="application/x-www-form-urlencoded";function Kh(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function wE(n){return Kh(n)&&n.tagName.toLowerCase()==="button"}function _E(n){return Kh(n)&&n.tagName.toLowerCase()==="form"}function kE(n){return Kh(n)&&n.tagName.toLowerCase()==="input"}function jE(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function TE(n,e){return n.button===0&&(!e||e==="_self")&&!jE(n)}function sg(n=""){return new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let i=n[t];return e.concat(Array.isArray(i)?i.map(l=>[t,l]):[[t,i]])},[]))}function EE(n,e){let t=sg(n);return e&&e.forEach((i,l)=>{t.has(l)||e.getAll(l).forEach(u=>{t.append(l,u)})}),t}var Jd=null;function NE(){if(Jd===null)try{new FormData(document.createElement("form"),0),Jd=!1}catch{Jd=!0}return Jd}var SE=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function _p(n){return n!=null&&!SE.has(n)?(oa(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${fh}"`),null):n}function CE(n,e){let t,i,l,u,d;if(_E(n)){let p=n.getAttribute("action");i=p?gi(p,e):null,t=n.getAttribute("method")||hh,l=_p(n.getAttribute("enctype"))||fh,u=new FormData(n)}else if(wE(n)||kE(n)&&(n.type==="submit"||n.type==="image")){let p=n.form;if(p==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let g=n.getAttribute("formaction")||p.getAttribute("action");if(i=g?gi(g,e):null,t=n.getAttribute("formmethod")||p.getAttribute("method")||hh,l=_p(n.getAttribute("formenctype"))||_p(p.getAttribute("enctype"))||fh,u=new FormData(p,n),!NE()){let{name:y,type:w,value:k}=n;if(w==="image"){let j=y?`${y}.`:"";u.append(`${j}x`,"0"),u.append(`${j}y`,"0")}else y&&u.append(y,k)}}else{if(Kh(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=hh,i=null,l=fh,d=n}return u&&l==="text/plain"&&(d=u,u=void 0),{action:i,method:t.toLowerCase(),encType:l,formData:u,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Lg(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function RE(n,e,t,i){let l=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t?l.pathname.endsWith("/")?l.pathname=`${l.pathname}_.${i}`:l.pathname=`${l.pathname}.${i}`:l.pathname==="/"?l.pathname=`_root.${i}`:e&&gi(l.pathname,e)==="/"?l.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:l.pathname=`${l.pathname.replace(/\/$/,"")}.${i}`,l}async function AE(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function IE(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function ME(n,e,t){let i=await Promise.all(n.map(async l=>{let u=e.routes[l.route.id];if(u){let d=await AE(u,t);return d.links?d.links():[]}return[]}));return OE(i.flat(1).filter(IE).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function I1(n,e,t,i,l,u){let d=(g,y)=>t[y]?g.route.id!==t[y].route.id:!0,p=(g,y)=>t[y].pathname!==g.pathname||t[y].route.path?.endsWith("*")&&t[y].params["*"]!==g.params["*"];return u==="assets"?e.filter((g,y)=>d(g,y)||p(g,y)):u==="data"?e.filter((g,y)=>{let w=i.routes[g.route.id];if(!w||!w.hasLoader)return!1;if(d(g,y)||p(g,y))return!0;if(g.route.shouldRevalidate){let k=g.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:g.params,defaultShouldRevalidate:!0});if(typeof k=="boolean")return k}return!0}):[]}function DE(n,e,{includeHydrateFallback:t}={}){return PE(n.map(i=>{let l=e.routes[i.route.id];if(!l)return[];let u=[l.module];return l.clientActionModule&&(u=u.concat(l.clientActionModule)),l.clientLoaderModule&&(u=u.concat(l.clientLoaderModule)),t&&l.hydrateFallbackModule&&(u=u.concat(l.hydrateFallbackModule)),l.imports&&(u=u.concat(l.imports)),u}).flat(1))}function PE(n){return[...new Set(n)]}function LE(n){let e={},t=Object.keys(n).sort();for(let i of t)e[i]=n[i];return e}function OE(n,e){let t=new Set;return new Set(e),n.reduce((i,l)=>{let u=JSON.stringify(LE(l));return t.has(u)||(t.add(u),i.push({key:u,link:l})),i},[])}function B2(){let n=v.useContext(nc);return Lg(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function VE(){let n=v.useContext(Gh);return Lg(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var Og=v.createContext(void 0);Og.displayName="FrameworkContext";function U2(){let n=v.useContext(Og);return Lg(n,"You must render this element inside a <HydratedRouter> element"),n}function BE(n,e){let t=v.useContext(Og),[i,l]=v.useState(!1),[u,d]=v.useState(!1),{onFocus:p,onBlur:g,onMouseEnter:y,onMouseLeave:w,onTouchStart:k}=e,j=v.useRef(null);v.useEffect(()=>{if(n==="render"&&d(!0),n==="viewport"){let B=ne=>{ne.forEach(K=>{d(K.isIntersecting)})},V=new IntersectionObserver(B,{threshold:.5});return j.current&&V.observe(j.current),()=>{V.disconnect()}}},[n]),v.useEffect(()=>{if(i){let B=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(B)}}},[i]);let O=()=>{l(!0)},q=()=>{l(!1),d(!1)};return t?n!=="intent"?[u,j,{}]:[u,j,{onFocus:Yc(p,O),onBlur:Yc(g,q),onMouseEnter:Yc(y,O),onMouseLeave:Yc(w,q),onTouchStart:Yc(k,O)}]:[!1,j,{}]}function Yc(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function UE({page:n,...e}){let{router:t}=B2(),i=v.useMemo(()=>E2(t.routes,n,t.basename),[t.routes,n,t.basename]);return i?v.createElement(FE,{page:n,matches:i,...e}):null}function zE(n){let{manifest:e,routeModules:t}=U2(),[i,l]=v.useState([]);return v.useEffect(()=>{let u=!1;return ME(n,e,t).then(d=>{u||l(d)}),()=>{u=!0}},[n,e,t]),i}function FE({page:n,matches:e,...t}){let i=ka(),{future:l,manifest:u,routeModules:d}=U2(),{basename:p}=B2(),{loaderData:g,matches:y}=VE(),w=v.useMemo(()=>I1(n,e,y,u,i,"data"),[n,e,y,u,i]),k=v.useMemo(()=>I1(n,e,y,u,i,"assets"),[n,e,y,u,i]),j=v.useMemo(()=>{if(n===i.pathname+i.search+i.hash)return[];let B=new Set,V=!1;if(e.forEach(K=>{let le=u.routes[K.route.id];!le||!le.hasLoader||(!w.some(ge=>ge.route.id===K.route.id)&&K.route.id in g&&d[K.route.id]?.shouldRevalidate||le.hasClientLoader?V=!0:B.add(K.route.id))}),B.size===0)return[];let ne=RE(n,p,l.unstable_trailingSlashAwareDataRequests,"data");return V&&B.size>0&&ne.searchParams.set("_routes",e.filter(K=>B.has(K.route.id)).map(K=>K.route.id).join(",")),[ne.pathname+ne.search]},[p,l.unstable_trailingSlashAwareDataRequests,g,i,u,w,e,n,d]),O=v.useMemo(()=>DE(k,u),[k,u]),q=zE(k);return v.createElement(v.Fragment,null,j.map(B=>v.createElement("link",{key:B,rel:"prefetch",as:"fetch",href:B,...t})),O.map(B=>v.createElement("link",{key:B,rel:"modulepreload",href:B,...t})),q.map(({key:B,link:V})=>v.createElement("link",{key:B,nonce:t.nonce,...V,crossOrigin:V.crossOrigin??t.crossOrigin})))}function HE(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var qE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{qE&&(window.__reactRouterVersion="7.13.0")}catch{}function $E({basename:n,children:e,unstable_useTransitions:t,window:i}){let l=v.useRef();l.current==null&&(l.current=_T({window:i,v5Compat:!0}));let u=l.current,[d,p]=v.useState({action:u.action,location:u.location}),g=v.useCallback(y=>{t===!1?p(y):v.startTransition(()=>p(y))},[t]);return v.useLayoutEffect(()=>u.listen(g),[u,g]),v.createElement(vE,{basename:n,children:e,location:d.location,navigationType:d.action,navigator:u,unstable_useTransitions:t})}var z2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,F2=v.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:l,reloadDocument:u,replace:d,state:p,target:g,to:y,preventScrollReset:w,viewTransition:k,unstable_defaultShouldRevalidate:j,...O},q){let{basename:B,unstable_useTransitions:V}=v.useContext(Kr),ne=typeof y=="string"&&z2.test(y),K=R2(y,B);y=K.to;let le=sE(y,{relative:l}),[ge,Ie,Te]=BE(i,O),R=YE(y,{replace:d,state:p,target:g,preventScrollReset:w,relative:l,viewTransition:k,unstable_defaultShouldRevalidate:j,unstable_useTransitions:V});function T(L){e&&e(L),L.defaultPrevented||R(L)}let A=v.createElement("a",{...O,...Te,href:K.absoluteURL||le,onClick:K.isExternal||u?e:T,ref:HE(q,Ie),target:g,"data-discover":!ne&&t==="render"?"true":void 0});return ge&&!ne?v.createElement(v.Fragment,null,A,v.createElement(UE,{page:le})):A});F2.displayName="Link";var WE=v.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:l=!1,style:u,to:d,viewTransition:p,children:g,...y},w){let k=Ru(d,{relative:y.relative}),j=ka(),O=v.useContext(Gh),{navigator:q,basename:B}=v.useContext(Kr),V=O!=null&&tN(k)&&p===!0,ne=q.encodeLocation?q.encodeLocation(k).pathname:k.pathname,K=j.pathname,le=O&&O.navigation&&O.navigation.location?O.navigation.location.pathname:null;t||(K=K.toLowerCase(),le=le?le.toLowerCase():null,ne=ne.toLowerCase()),le&&B&&(le=gi(le,B)||le);const ge=ne!=="/"&&ne.endsWith("/")?ne.length-1:ne.length;let Ie=K===ne||!l&&K.startsWith(ne)&&K.charAt(ge)==="/",Te=le!=null&&(le===ne||!l&&le.startsWith(ne)&&le.charAt(ne.length)==="/"),R={isActive:Ie,isPending:Te,isTransitioning:V},T=Ie?e:void 0,A;typeof i=="function"?A=i(R):A=[i,Ie?"active":null,Te?"pending":null,V?"transitioning":null].filter(Boolean).join(" ");let L=typeof u=="function"?u(R):u;return v.createElement(F2,{...y,"aria-current":T,className:A,ref:w,style:L,to:d,viewTransition:p},typeof g=="function"?g(R):g)});WE.displayName="NavLink";var GE=v.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:l,state:u,method:d=hh,action:p,onSubmit:g,relative:y,preventScrollReset:w,viewTransition:k,unstable_defaultShouldRevalidate:j,...O},q)=>{let{unstable_useTransitions:B}=v.useContext(Kr),V=ZE(),ne=eN(p,{relative:y}),K=d.toLowerCase()==="get"?"get":"post",le=typeof p=="string"&&z2.test(p),ge=Ie=>{if(g&&g(Ie),Ie.defaultPrevented)return;Ie.preventDefault();let Te=Ie.nativeEvent.submitter,R=Te?.getAttribute("formmethod")||d,T=()=>V(Te||Ie.currentTarget,{fetcherKey:e,method:R,navigate:t,replace:l,state:u,relative:y,preventScrollReset:w,viewTransition:k,unstable_defaultShouldRevalidate:j});B&&t!==!1?v.startTransition(()=>T()):T()};return v.createElement("form",{ref:q,method:K,action:ne,onSubmit:i?g:ge,...O,"data-discover":!le&&n==="render"?"true":void 0})});GE.displayName="Form";function KE(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function H2(n){let e=v.useContext(nc);return dn(e,KE(n)),e}function YE(n,{target:e,replace:t,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p,unstable_useTransitions:g}={}){let y=Wn(),w=ka(),k=Ru(n,{relative:u});return v.useCallback(j=>{if(TE(j,e)){j.preventDefault();let O=t!==void 0?t:gu(w)===gu(k),q=()=>y(n,{replace:O,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p});g?v.startTransition(()=>q()):q()}},[w,y,k,t,i,e,n,l,u,d,p,g])}function QE(n){oa(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=v.useRef(sg(n)),t=v.useRef(!1),i=ka(),l=v.useMemo(()=>EE(i.search,t.current?null:e.current),[i.search]),u=Wn(),d=v.useCallback((p,g)=>{const y=sg(typeof p=="function"?p(new URLSearchParams(l)):p);t.current=!0,u("?"+y,g)},[u,l]);return[l,d]}var XE=0,JE=()=>`__${String(++XE)}__`;function ZE(){let{router:n}=H2("useSubmit"),{basename:e}=v.useContext(Kr),t=mE(),i=n.fetch,l=n.navigate;return v.useCallback(async(u,d={})=>{let{action:p,method:g,encType:y,formData:w,body:k}=CE(u,e);if(d.navigate===!1){let j=d.fetcherKey||JE();await i(j,t,d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:w,body:k,formMethod:d.method||g,formEncType:d.encType||y,flushSync:d.flushSync})}else await l(d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:w,body:k,formMethod:d.method||g,formEncType:d.encType||y,replace:d.replace,state:d.state,fromRouteId:t,flushSync:d.flushSync,viewTransition:d.viewTransition})},[i,l,e,t])}function eN(n,{relative:e}={}){let{basename:t}=v.useContext(Kr),i=v.useContext(_a);dn(i,"useFormAction must be used inside a RouteContext");let[l]=i.matches.slice(-1),u={...Ru(n||".",{relative:e})},d=ka();if(n==null){u.search=d.search;let p=new URLSearchParams(u.search),g=p.getAll("index");if(g.some(w=>w==="")){p.delete("index"),g.filter(k=>k).forEach(k=>p.append("index",k));let w=p.toString();u.search=w?`?${w}`:""}}return(!n||n===".")&&l.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(u.pathname=u.pathname==="/"?t:hi([t,u.pathname])),gu(u)}function tN(n,{relative:e}={}){let t=v.useContext(I2);dn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=H2("useViewTransitionState"),l=Ru(n,{relative:e});if(!t.isTransitioning)return!1;let u=gi(t.currentLocation.pathname,i)||t.currentLocation.pathname,d=gi(t.nextLocation.pathname,i)||t.nextLocation.pathname;return jh(l.pathname,d)!=null||jh(l.pathname,u)!=null}const sN=()=>{};var M1={};const q2=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let l=n.charCodeAt(i);l<128?e[t++]=l:l<2048?(e[t++]=l>>6|192,e[t++]=l&63|128):(l&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(l=65536+((l&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=l>>18|240,e[t++]=l>>12&63|128,e[t++]=l>>6&63|128,e[t++]=l&63|128):(e[t++]=l>>12|224,e[t++]=l>>6&63|128,e[t++]=l&63|128)}return e},nN=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const l=n[t++];if(l<128)e[i++]=String.fromCharCode(l);else if(l>191&&l<224){const u=n[t++];e[i++]=String.fromCharCode((l&31)<<6|u&63)}else if(l>239&&l<365){const u=n[t++],d=n[t++],p=n[t++],g=((l&7)<<18|(u&63)<<12|(d&63)<<6|p&63)-65536;e[i++]=String.fromCharCode(55296+(g>>10)),e[i++]=String.fromCharCode(56320+(g&1023))}else{const u=n[t++],d=n[t++];e[i++]=String.fromCharCode((l&15)<<12|(u&63)<<6|d&63)}}return e.join("")},$2={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let l=0;l<n.length;l+=3){const u=n[l],d=l+1<n.length,p=d?n[l+1]:0,g=l+2<n.length,y=g?n[l+2]:0,w=u>>2,k=(u&3)<<4|p>>4;let j=(p&15)<<2|y>>6,O=y&63;g||(O=64,d||(j=64)),i.push(t[w],t[k],t[j],t[O])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(q2(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):nN(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let l=0;l<n.length;){const u=t[n.charAt(l++)],p=l<n.length?t[n.charAt(l)]:0;++l;const y=l<n.length?t[n.charAt(l)]:64;++l;const k=l<n.length?t[n.charAt(l)]:64;if(++l,u==null||p==null||y==null||k==null)throw new rN;const j=u<<2|p>>4;if(i.push(j),y!==64){const O=p<<4&240|y>>2;if(i.push(O),k!==64){const q=y<<6&192|k;i.push(q)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class rN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const aN=function(n){const e=q2(n);return $2.encodeByteArray(e,!0)},Th=function(n){return aN(n).replace(/\./g,"")},W2=function(n){try{return $2.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function iN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const oN=()=>iN().__FIREBASE_DEFAULTS__,lN=()=>{if(typeof process>"u"||typeof M1>"u")return;const n=M1.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},cN=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&W2(n[1]);return e&&JSON.parse(e)},Yh=()=>{try{return sN()||oN()||lN()||cN()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},G2=n=>Yh()?.emulatorHosts?.[n],K2=n=>{const e=G2(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},Y2=()=>Yh()?.config,Q2=n=>Yh()?.[`_${n}`];class uN{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function go(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Vg(n){return(await fetch(n,{credentials:"include"})).ok}function X2(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",l=n.iat||0,u=n.sub||n.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d={iss:`https://securetoken.google.com/${i}`,aud:i,iat:l,exp:l+3600,auth_time:l,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Th(JSON.stringify(t)),Th(JSON.stringify(d)),""].join(".")}const ou={};function dN(){const n={prod:[],emulator:[]};for(const e of Object.keys(ou))ou[e]?n.emulator.push(e):n.prod.push(e);return n}function hN(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let D1=!1;function Bg(n,e){if(typeof window>"u"||typeof document>"u"||!go(window.location.host)||ou[n]===e||ou[n]||D1)return;ou[n]=e;function t(j){return`__firebase__banner__${j}`}const i="__firebase__banner",u=dN().prod.length>0;function d(){const j=document.getElementById(i);j&&j.remove()}function p(j){j.style.display="flex",j.style.background="#7faaf0",j.style.position="fixed",j.style.bottom="5px",j.style.left="5px",j.style.padding=".5em",j.style.borderRadius="5px",j.style.alignItems="center"}function g(j,O){j.setAttribute("width","24"),j.setAttribute("id",O),j.setAttribute("height","24"),j.setAttribute("viewBox","0 0 24 24"),j.setAttribute("fill","none"),j.style.marginLeft="-6px"}function y(){const j=document.createElement("span");return j.style.cursor="pointer",j.style.marginLeft="16px",j.style.fontSize="24px",j.innerHTML=" &times;",j.onclick=()=>{D1=!0,d()},j}function w(j,O){j.setAttribute("id",O),j.innerText="Learn more",j.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",j.setAttribute("target","__blank"),j.style.paddingLeft="5px",j.style.textDecoration="underline"}function k(){const j=hN(i),O=t("text"),q=document.getElementById(O)||document.createElement("span"),B=t("learnmore"),V=document.getElementById(B)||document.createElement("a"),ne=t("preprendIcon"),K=document.getElementById(ne)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(j.created){const le=j.element;p(le),w(V,B);const ge=y();g(K,ne),le.append(K,q,V,ge),document.body.appendChild(le)}u?(q.innerText="Preview backend disconnected.",K.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(K.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,q.innerText="Preview backend running in this workspace."),q.setAttribute("id",O)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",k):k()}function dr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function fN(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(dr())}function mN(){const n=Yh()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function pN(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function gN(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function yN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function bN(){const n=dr();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function vN(){return!mN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function xN(){try{return typeof indexedDB=="object"}catch{return!1}}function wN(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",l=self.indexedDB.open(i);l.onsuccess=()=>{l.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},l.onupgradeneeded=()=>{t=!1},l.onerror=()=>{e(l.error?.message||"")}}catch(t){e(t)}})}const _N="FirebaseError";class Wa extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=_N,Object.setPrototypeOf(this,Wa.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Au.prototype.create)}}class Au{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},l=`${this.service}/${e}`,u=this.errors[e],d=u?kN(u,i):"Error",p=`${this.serviceName}: ${d} (${l}).`;return new Wa(l,p,i)}}function kN(n,e){return n.replace(jN,(t,i)=>{const l=e[i];return l!=null?String(l):`<${i}?>`})}const jN=/\{\$([^}]+)}/g;function TN(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Yo(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const l of t){if(!i.includes(l))return!1;const u=n[l],d=e[l];if(P1(u)&&P1(d)){if(!Yo(u,d))return!1}else if(u!==d)return!1}for(const l of i)if(!t.includes(l))return!1;return!0}function P1(n){return n!==null&&typeof n=="object"}function Iu(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(l=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(l))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function tu(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[l,u]=i.split("=");e[decodeURIComponent(l)]=decodeURIComponent(u)}}),e}function su(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function EN(n,e){const t=new NN(n,e);return t.subscribe.bind(t)}class NN{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let l;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");SN(e,["next","error","complete"])?l=e:l={next:e,error:t,complete:i},l.next===void 0&&(l.next=kp),l.error===void 0&&(l.error=kp),l.complete===void 0&&(l.complete=kp);const u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?l.error(this.finalError):l.complete()}catch{}}),this.observers.push(l),u}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function SN(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function kp(){}function Gs(n){return n&&n._delegate?n._delegate:n}class lo{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Fo="[DEFAULT]";class CN{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new uN;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const l=this.getOrInitializeService({instanceIdentifier:t});l&&i.resolve(l)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(l){if(i)return null;throw l}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(AN(e))try{this.getOrInitializeService({instanceIdentifier:Fo})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(t);try{const u=this.getOrInitializeService({instanceIdentifier:l});i.resolve(u)}catch{}}}}clearInstance(e=Fo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Fo){return this.instances.has(e)}getOptions(e=Fo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const l=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[u,d]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(u);i===p&&d.resolve(l)}return l}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),l=this.onInitCallbacks.get(i)??new Set;l.add(e),this.onInitCallbacks.set(i,l);const u=this.instances.get(i);return u&&e(u,i),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const l of i)try{l(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:RN(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Fo){return this.component?this.component.multipleInstances?e:Fo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function RN(n){return n===Fo?void 0:n}function AN(n){return n.instantiationMode==="EAGER"}class IN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new CN(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var ys;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(ys||(ys={}));const MN={debug:ys.DEBUG,verbose:ys.VERBOSE,info:ys.INFO,warn:ys.WARN,error:ys.ERROR,silent:ys.SILENT},DN=ys.INFO,PN={[ys.DEBUG]:"log",[ys.VERBOSE]:"log",[ys.INFO]:"info",[ys.WARN]:"warn",[ys.ERROR]:"error"},LN=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),l=PN[e];if(l)console[l](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ug{constructor(e){this.name=e,this._logLevel=DN,this._logHandler=LN,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ys))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?MN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ys.DEBUG,...e),this._logHandler(this,ys.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ys.VERBOSE,...e),this._logHandler(this,ys.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ys.INFO,...e),this._logHandler(this,ys.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ys.WARN,...e),this._logHandler(this,ys.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ys.ERROR,...e),this._logHandler(this,ys.ERROR,...e)}}const ON=(n,e)=>e.some(t=>n instanceof t);let L1,O1;function VN(){return L1||(L1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function BN(){return O1||(O1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const J2=new WeakMap,ng=new WeakMap,Z2=new WeakMap,jp=new WeakMap,zg=new WeakMap;function UN(n){const e=new Promise((t,i)=>{const l=()=>{n.removeEventListener("success",u),n.removeEventListener("error",d)},u=()=>{t(ro(n.result)),l()},d=()=>{i(n.error),l()};n.addEventListener("success",u),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&J2.set(t,n)}).catch(()=>{}),zg.set(e,n),e}function zN(n){if(ng.has(n))return;const e=new Promise((t,i)=>{const l=()=>{n.removeEventListener("complete",u),n.removeEventListener("error",d),n.removeEventListener("abort",d)},u=()=>{t(),l()},d=()=>{i(n.error||new DOMException("AbortError","AbortError")),l()};n.addEventListener("complete",u),n.addEventListener("error",d),n.addEventListener("abort",d)});ng.set(n,e)}let rg={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return ng.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Z2.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ro(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function FN(n){rg=n(rg)}function HN(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Tp(this),e,...t);return Z2.set(i,e.sort?e.sort():[e]),ro(i)}:BN().includes(n)?function(...e){return n.apply(Tp(this),e),ro(J2.get(this))}:function(...e){return ro(n.apply(Tp(this),e))}}function qN(n){return typeof n=="function"?HN(n):(n instanceof IDBTransaction&&zN(n),ON(n,VN())?new Proxy(n,rg):n)}function ro(n){if(n instanceof IDBRequest)return UN(n);if(jp.has(n))return jp.get(n);const e=qN(n);return e!==n&&(jp.set(n,e),zg.set(e,n)),e}const Tp=n=>zg.get(n);function $N(n,e,{blocked:t,upgrade:i,blocking:l,terminated:u}={}){const d=indexedDB.open(n,e),p=ro(d);return i&&d.addEventListener("upgradeneeded",g=>{i(ro(d.result),g.oldVersion,g.newVersion,ro(d.transaction),g)}),t&&d.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),p.then(g=>{u&&g.addEventListener("close",()=>u()),l&&g.addEventListener("versionchange",y=>l(y.oldVersion,y.newVersion,y))}).catch(()=>{}),p}const WN=["get","getKey","getAll","getAllKeys","count"],GN=["put","add","delete","clear"],Ep=new Map;function V1(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Ep.get(e))return Ep.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,l=GN.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(l||WN.includes(t)))return;const u=async function(d,...p){const g=this.transaction(d,l?"readwrite":"readonly");let y=g.store;return i&&(y=y.index(p.shift())),(await Promise.all([y[t](...p),l&&g.done]))[0]};return Ep.set(e,u),u}FN(n=>({...n,get:(e,t,i)=>V1(e,t)||n.get(e,t,i),has:(e,t)=>!!V1(e,t)||n.has(e,t)}));class KN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(YN(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function YN(n){return n.getComponent()?.type==="VERSION"}const ag="@firebase/app",B1="0.14.7";const yi=new Ug("@firebase/app"),QN="@firebase/app-compat",XN="@firebase/analytics-compat",JN="@firebase/analytics",ZN="@firebase/app-check-compat",eS="@firebase/app-check",tS="@firebase/auth",sS="@firebase/auth-compat",nS="@firebase/database",rS="@firebase/data-connect",aS="@firebase/database-compat",iS="@firebase/functions",oS="@firebase/functions-compat",lS="@firebase/installations",cS="@firebase/installations-compat",uS="@firebase/messaging",dS="@firebase/messaging-compat",hS="@firebase/performance",fS="@firebase/performance-compat",mS="@firebase/remote-config",pS="@firebase/remote-config-compat",gS="@firebase/storage",yS="@firebase/storage-compat",bS="@firebase/firestore",vS="@firebase/ai",xS="@firebase/firestore-compat",wS="firebase",_S="12.8.0";const ig="[DEFAULT]",kS={[ag]:"fire-core",[QN]:"fire-core-compat",[JN]:"fire-analytics",[XN]:"fire-analytics-compat",[eS]:"fire-app-check",[ZN]:"fire-app-check-compat",[tS]:"fire-auth",[sS]:"fire-auth-compat",[nS]:"fire-rtdb",[rS]:"fire-data-connect",[aS]:"fire-rtdb-compat",[iS]:"fire-fn",[oS]:"fire-fn-compat",[lS]:"fire-iid",[cS]:"fire-iid-compat",[uS]:"fire-fcm",[dS]:"fire-fcm-compat",[hS]:"fire-perf",[fS]:"fire-perf-compat",[mS]:"fire-rc",[pS]:"fire-rc-compat",[gS]:"fire-gcs",[yS]:"fire-gcs-compat",[bS]:"fire-fst",[xS]:"fire-fst-compat",[vS]:"fire-vertex","fire-js":"fire-js",[wS]:"fire-js-all"};const Eh=new Map,jS=new Map,og=new Map;function U1(n,e){try{n.container.addComponent(e)}catch(t){yi.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Qo(n){const e=n.name;if(og.has(e))return yi.debug(`There were multiple attempts to register component ${e}.`),!1;og.set(e,n);for(const t of Eh.values())U1(t,n);for(const t of jS.values())U1(t,n);return!0}function Qh(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function $r(n){return n==null?!1:n.settings!==void 0}const TS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ao=new Au("app","Firebase",TS);class ES{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new lo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ao.create("app-deleted",{appName:this._name})}}const nl=_S;function Fg(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:ig,automaticDataCollectionEnabled:!0,...e},l=i.name;if(typeof l!="string"||!l)throw ao.create("bad-app-name",{appName:String(l)});if(t||(t=Y2()),!t)throw ao.create("no-options");const u=Eh.get(l);if(u){if(Yo(t,u.options)&&Yo(i,u.config))return u;throw ao.create("duplicate-app",{appName:l})}const d=new IN(l);for(const g of og.values())d.addComponent(g);const p=new ES(t,i,d);return Eh.set(l,p),p}function Hg(n=ig){const e=Eh.get(n);if(!e&&n===ig&&Y2())return Fg();if(!e)throw ao.create("no-app",{appName:n});return e}function Va(n,e,t){let i=kS[n]??n;t&&(i+=`-${t}`);const l=i.match(/\s|\//),u=e.match(/\s|\//);if(l||u){const d=[`Unable to register library "${i}" with version "${e}":`];l&&d.push(`library name "${i}" contains illegal characters (whitespace or "/")`),l&&u&&d.push("and"),u&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),yi.warn(d.join(" "));return}Qo(new lo(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const NS="firebase-heartbeat-database",SS=1,yu="firebase-heartbeat-store";let Np=null;function ew(){return Np||(Np=$N(NS,SS,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(yu)}catch(t){console.warn(t)}}}}).catch(n=>{throw ao.create("idb-open",{originalErrorMessage:n.message})})),Np}async function CS(n){try{const t=(await ew()).transaction(yu),i=await t.objectStore(yu).get(tw(n));return await t.done,i}catch(e){if(e instanceof Wa)yi.warn(e.message);else{const t=ao.create("idb-get",{originalErrorMessage:e?.message});yi.warn(t.message)}}}async function z1(n,e){try{const i=(await ew()).transaction(yu,"readwrite");await i.objectStore(yu).put(e,tw(n)),await i.done}catch(t){if(t instanceof Wa)yi.warn(t.message);else{const i=ao.create("idb-set",{originalErrorMessage:t?.message});yi.warn(i.message)}}}function tw(n){return`${n.name}!${n.options.appId}`}const RS=1024,AS=30;class IS{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new DS(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=F1();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(l=>l.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>AS){const l=PS(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){yi.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=F1(),{heartbeatsToSend:t,unsentEntries:i}=MS(this._heartbeatsCache.heartbeats),l=Th(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(e){return yi.warn(e),""}}}function F1(){return new Date().toISOString().substring(0,10)}function MS(n,e=RS){const t=[];let i=n.slice();for(const l of n){const u=t.find(d=>d.agent===l.agent);if(u){if(u.dates.push(l.date),H1(t)>e){u.dates.pop();break}}else if(t.push({agent:l.agent,dates:[l.date]}),H1(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class DS{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return xN()?wN().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await CS(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return z1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return z1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function H1(n){return Th(JSON.stringify({version:2,heartbeats:n})).length}function PS(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function LS(n){Qo(new lo("platform-logger",e=>new KN(e),"PRIVATE")),Qo(new lo("heartbeat",e=>new IS(e),"PRIVATE")),Va(ag,B1,n),Va(ag,B1,"esm2020"),Va("fire-js","")}LS("");function sw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const OS=sw,nw=new Au("auth","Firebase",sw());const Nh=new Ug("@firebase/auth");function VS(n,...e){Nh.logLevel<=ys.WARN&&Nh.warn(`Auth (${nl}): ${n}`,...e)}function mh(n,...e){Nh.logLevel<=ys.ERROR&&Nh.error(`Auth (${nl}): ${n}`,...e)}function xa(n,...e){throw qg(n,...e)}function Ba(n,...e){return qg(n,...e)}function rw(n,e,t){const i={...OS(),[e]:t};return new Au("auth","Firebase",i).create(e,{appName:n.name})}function fi(n){return rw(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function qg(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return nw.create(n,...e)}function Vt(n,e,...t){if(!n)throw qg(e,...t)}function ui(n){const e="INTERNAL ASSERTION FAILED: "+n;throw mh(e),new Error(e)}function bi(n,e){n||ui(e)}function lg(){return typeof self<"u"&&self.location?.href||""}function BS(){return q1()==="http:"||q1()==="https:"}function q1(){return typeof self<"u"&&self.location?.protocol||null}function US(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(BS()||gN()||"connection"in navigator)?navigator.onLine:!0}function zS(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Mu{constructor(e,t){this.shortDelay=e,this.longDelay=t,bi(t>e,"Short delay should be less than long delay!"),this.isMobile=fN()||yN()}get(){return US()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function $g(n,e){bi(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class aw{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ui("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ui("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ui("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const FS={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const HS=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],qS=new Mu(3e4,6e4);function wi(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function _i(n,e,t,i,l={}){return iw(n,l,async()=>{let u={},d={};i&&(e==="GET"?d=i:u={body:JSON.stringify(i)});const p=Iu({key:n.config.apiKey,...d}).slice(1),g=await n._getAdditionalHeaders();g["Content-Type"]="application/json",n.languageCode&&(g["X-Firebase-Locale"]=n.languageCode);const y={method:e,headers:g,...u};return pN()||(y.referrerPolicy="no-referrer"),n.emulatorConfig&&go(n.emulatorConfig.host)&&(y.credentials="include"),aw.fetch()(await ow(n,n.config.apiHost,t,p),y)})}async function iw(n,e,t){n._canInitEmulator=!1;const i={...FS,...e};try{const l=new WS(n),u=await Promise.race([t(),l.promise]);l.clearNetworkTimeout();const d=await u.json();if("needConfirmation"in d)throw Zd(n,"account-exists-with-different-credential",d);if(u.ok&&!("errorMessage"in d))return d;{const p=u.ok?d.errorMessage:d.error.message,[g,y]=p.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw Zd(n,"credential-already-in-use",d);if(g==="EMAIL_EXISTS")throw Zd(n,"email-already-in-use",d);if(g==="USER_DISABLED")throw Zd(n,"user-disabled",d);const w=i[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw rw(n,w,y);xa(n,w)}}catch(l){if(l instanceof Wa)throw l;xa(n,"network-request-failed",{message:String(l)})}}async function Du(n,e,t,i,l={}){const u=await _i(n,e,t,i,l);return"mfaPendingCredential"in u&&xa(n,"multi-factor-auth-required",{_serverResponse:u}),u}async function ow(n,e,t,i){const l=`${e}${t}?${i}`,u=n,d=u.config.emulator?$g(n.config,l):`${n.config.apiScheme}://${l}`;return HS.includes(t)&&(await u._persistenceManagerAvailable,u._getPersistenceType()==="COOKIE")?u._getPersistence()._getFinalTarget(d).toString():d}function $S(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class WS{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Ba(this.auth,"network-request-failed")),qS.get())})}}function Zd(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const l=Ba(n,e,i);return l.customData._tokenResponse=t,l}function $1(n){return n!==void 0&&n.enterprise!==void 0}class GS{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return $S(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function KS(n,e){return _i(n,"GET","/v2/recaptchaConfig",wi(n,e))}async function YS(n,e){return _i(n,"POST","/v1/accounts:delete",e)}async function Sh(n,e){return _i(n,"POST","/v1/accounts:lookup",e)}function lu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function QS(n,e=!1){const t=Gs(n),i=await t.getIdToken(e),l=Wg(i);Vt(l&&l.exp&&l.auth_time&&l.iat,t.auth,"internal-error");const u=typeof l.firebase=="object"?l.firebase:void 0,d=u?.sign_in_provider;return{claims:l,token:i,authTime:lu(Sp(l.auth_time)),issuedAtTime:lu(Sp(l.iat)),expirationTime:lu(Sp(l.exp)),signInProvider:d||null,signInSecondFactor:u?.sign_in_second_factor||null}}function Sp(n){return Number(n)*1e3}function Wg(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return mh("JWT malformed, contained fewer than 3 sections"),null;try{const l=W2(t);return l?JSON.parse(l):(mh("Failed to decode base64 JWT payload"),null)}catch(l){return mh("Caught error parsing JWT payload as JSON",l?.toString()),null}}function W1(n){const e=Wg(n);return Vt(e,"internal-error"),Vt(typeof e.exp<"u","internal-error"),Vt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function bu(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Wa&&XS(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function XS({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class JS{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class cg{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=lu(this.lastLoginAt),this.creationTime=lu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Ch(n){const e=n.auth,t=await n.getIdToken(),i=await bu(n,Sh(e,{idToken:t}));Vt(i?.users.length,e,"internal-error");const l=i.users[0];n._notifyReloadListener(l);const u=l.providerUserInfo?.length?lw(l.providerUserInfo):[],d=eC(n.providerData,u),p=n.isAnonymous,g=!(n.email&&l.passwordHash)&&!d?.length,y=p?g:!1,w={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:d,metadata:new cg(l.createdAt,l.lastLoginAt),isAnonymous:y};Object.assign(n,w)}async function ZS(n){const e=Gs(n);await Ch(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function eC(n,e){return[...n.filter(i=>!e.some(l=>l.providerId===i.providerId)),...e]}function lw(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function tC(n,e){const t=await iw(n,{},async()=>{const i=Iu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:l,apiKey:u}=n.config,d=await ow(n,l,"/v1/token",`key=${u}`),p=await n._getAdditionalHeaders();p["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:p,body:i};return n.emulatorConfig&&go(n.emulatorConfig.host)&&(g.credentials="include"),aw.fetch()(d,g)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function sC(n,e){return _i(n,"POST","/v2/accounts:revokeToken",wi(n,e))}class $l{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Vt(e.idToken,"internal-error"),Vt(typeof e.idToken<"u","internal-error"),Vt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):W1(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Vt(e.length!==0,"internal-error");const t=W1(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Vt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:l,expiresIn:u}=await tC(e,t);this.updateTokensAndExpiration(i,l,Number(u))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:l,expirationTime:u}=t,d=new $l;return i&&(Vt(typeof i=="string","internal-error",{appName:e}),d.refreshToken=i),l&&(Vt(typeof l=="string","internal-error",{appName:e}),d.accessToken=l),u&&(Vt(typeof u=="number","internal-error",{appName:e}),d.expirationTime=u),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new $l,this.toJSON())}_performRefresh(){return ui("not implemented")}}function Gi(n,e){Vt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class ba{constructor({uid:e,auth:t,stsTokenManager:i,...l}){this.providerId="firebase",this.proactiveRefresh=new JS(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new cg(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await bu(this,this.stsTokenManager.getToken(this.auth,e));return Vt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return QS(this,e)}reload(){return ZS(this)}_assign(e){this!==e&&(Vt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ba({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Vt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Ch(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if($r(this.auth.app))return Promise.reject(fi(this.auth));const e=await this.getIdToken();return await bu(this,YS(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,l=t.email??void 0,u=t.phoneNumber??void 0,d=t.photoURL??void 0,p=t.tenantId??void 0,g=t._redirectEventId??void 0,y=t.createdAt??void 0,w=t.lastLoginAt??void 0,{uid:k,emailVerified:j,isAnonymous:O,providerData:q,stsTokenManager:B}=t;Vt(k&&B,e,"internal-error");const V=$l.fromJSON(this.name,B);Vt(typeof k=="string",e,"internal-error"),Gi(i,e.name),Gi(l,e.name),Vt(typeof j=="boolean",e,"internal-error"),Vt(typeof O=="boolean",e,"internal-error"),Gi(u,e.name),Gi(d,e.name),Gi(p,e.name),Gi(g,e.name),Gi(y,e.name),Gi(w,e.name);const ne=new ba({uid:k,auth:e,email:l,emailVerified:j,displayName:i,isAnonymous:O,photoURL:d,phoneNumber:u,tenantId:p,stsTokenManager:V,createdAt:y,lastLoginAt:w});return q&&Array.isArray(q)&&(ne.providerData=q.map(K=>({...K}))),g&&(ne._redirectEventId=g),ne}static async _fromIdTokenResponse(e,t,i=!1){const l=new $l;l.updateFromServerResponse(t);const u=new ba({uid:t.localId,auth:e,stsTokenManager:l,isAnonymous:i});return await Ch(u),u}static async _fromGetAccountInfoResponse(e,t,i){const l=t.users[0];Vt(l.localId!==void 0,"internal-error");const u=l.providerUserInfo!==void 0?lw(l.providerUserInfo):[],d=!(l.email&&l.passwordHash)&&!u?.length,p=new $l;p.updateFromIdToken(i);const g=new ba({uid:l.localId,auth:e,stsTokenManager:p,isAnonymous:d}),y={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:u,metadata:new cg(l.createdAt,l.lastLoginAt),isAnonymous:!(l.email&&l.passwordHash)&&!u?.length};return Object.assign(g,y),g}}const G1=new Map;function di(n){bi(n instanceof Function,"Expected a class definition");let e=G1.get(n);return e?(bi(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,G1.set(n,e),e)}class cw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}cw.type="NONE";const K1=cw;function ph(n,e,t){return`firebase:${n}:${e}:${t}`}class Wl{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:l,name:u}=this.auth;this.fullUserKey=ph(this.userKey,l.apiKey,u),this.fullPersistenceKey=ph("persistence",l.apiKey,u),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Sh(this.auth,{idToken:e}).catch(()=>{});return t?ba._fromGetAccountInfoResponse(this.auth,t,e):null}return ba._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Wl(di(K1),e,i);const l=(await Promise.all(t.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let u=l[0]||di(K1);const d=ph(i,e.config.apiKey,e.name);let p=null;for(const y of t)try{const w=await y._get(d);if(w){let k;if(typeof w=="string"){const j=await Sh(e,{idToken:w}).catch(()=>{});if(!j)break;k=await ba._fromGetAccountInfoResponse(e,j,w)}else k=ba._fromJSON(e,w);y!==u&&(p=k),u=y;break}}catch{}const g=l.filter(y=>y._shouldAllowMigration);return!u._shouldAllowMigration||!g.length?new Wl(u,e,i):(u=g[0],p&&await u._set(d,p.toJSON()),await Promise.all(t.map(async y=>{if(y!==u)try{await y._remove(d)}catch{}})),new Wl(u,e,i))}}function Y1(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(fw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(uw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(pw(e))return"Blackberry";if(gw(e))return"Webos";if(dw(e))return"Safari";if((e.includes("chrome/")||hw(e))&&!e.includes("edge/"))return"Chrome";if(mw(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function uw(n=dr()){return/firefox\//i.test(n)}function dw(n=dr()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function hw(n=dr()){return/crios\//i.test(n)}function fw(n=dr()){return/iemobile/i.test(n)}function mw(n=dr()){return/android/i.test(n)}function pw(n=dr()){return/blackberry/i.test(n)}function gw(n=dr()){return/webos/i.test(n)}function Gg(n=dr()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function nC(n=dr()){return Gg(n)&&!!window.navigator?.standalone}function rC(){return bN()&&document.documentMode===10}function yw(n=dr()){return Gg(n)||mw(n)||gw(n)||pw(n)||/windows phone/i.test(n)||fw(n)}function bw(n,e=[]){let t;switch(n){case"Browser":t=Y1(dr());break;case"Worker":t=`${Y1(dr())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${nl}/${i}`}class aC{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=u=>new Promise((d,p)=>{try{const g=e(u);d(g)}catch(g){p(g)}});i.onAbort=t,this.queue.push(i);const l=this.queue.length-1;return()=>{this.queue[l]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const l of t)try{l()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function iC(n,e={}){return _i(n,"GET","/v2/passwordPolicy",wi(n,e))}const oC=6;class lC{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??oC,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,l=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),l&&(t.meetsMaxPasswordLength=e.length<=l)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let l=0;l<e.length;l++)i=e.charAt(l),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,l,u){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=l)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=u))}}class cC{constructor(e,t,i,l){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=l,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Q1(this),this.idTokenSubscription=new Q1(this),this.beforeStateQueue=new aC(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=nw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=l.sdkClientVersion,this._persistenceManagerAvailable=new Promise(u=>this._resolvePersistenceManagerAvailable=u)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=di(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Wl.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Sh(this,{idToken:e}),i=await ba._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if($r(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=this.redirectUser?._redirectEventId,d=i?._redirectEventId,p=await this.tryRedirectSignIn(e);(!u||u===d)&&p?.user&&(i=p.user,l=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Vt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Ch(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=zS()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if($r(this.app))return Promise.reject(fi(this));const t=e?Gs(e):null;return t&&Vt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Vt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return $r(this.app)?Promise.reject(fi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return $r(this.app)?Promise.reject(fi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(di(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await iC(this),t=new lC(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Au("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await sC(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&di(e)||this._popupRedirectResolver;Vt(t,this,"argument-error"),this.redirectPersistenceManager=await Wl.create(this,[di(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,l){if(this._deleted)return()=>{};const u=typeof t=="function"?t:t.next.bind(t);let d=!1;const p=this._isInitialized?Promise.resolve():this._initializationPromise;if(Vt(p,this,"internal-error"),p.then(()=>{d||u(this.currentUser)}),typeof t=="function"){const g=e.addObserver(t,i,l);return()=>{d=!0,g()}}else{const g=e.addObserver(t);return()=>{d=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Vt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=bw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if($r(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&VS(`Error while retrieving App Check token: ${e.error}`),e?.token}}function yo(n){return Gs(n)}class Q1{constructor(e){this.auth=e,this.observer=null,this.addObserver=EN(t=>this.observer=t)}get next(){return Vt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Xh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function uC(n){Xh=n}function vw(n){return Xh.loadJS(n)}function dC(){return Xh.recaptchaEnterpriseScript}function hC(){return Xh.gapiScript}function fC(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class mC{constructor(){this.enterprise=new pC}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class pC{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const gC="recaptcha-enterprise",xw="NO_RECAPTCHA";class yC{constructor(e){this.type=gC,this.auth=yo(e)}async verify(e="verify",t=!1){async function i(u){if(!t){if(u.tenantId==null&&u._agentRecaptchaConfig!=null)return u._agentRecaptchaConfig.siteKey;if(u.tenantId!=null&&u._tenantRecaptchaConfigs[u.tenantId]!==void 0)return u._tenantRecaptchaConfigs[u.tenantId].siteKey}return new Promise(async(d,p)=>{KS(u,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)p(new Error("recaptcha Enterprise site key undefined"));else{const y=new GS(g);return u.tenantId==null?u._agentRecaptchaConfig=y:u._tenantRecaptchaConfigs[u.tenantId]=y,d(y.siteKey)}}).catch(g=>{p(g)})})}function l(u,d,p){const g=window.grecaptcha;$1(g)?g.enterprise.ready(()=>{g.enterprise.execute(u,{action:e}).then(y=>{d(y)}).catch(()=>{d(xw)})}):p(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new mC().execute("siteKey",{action:"verify"}):new Promise((u,d)=>{i(this.auth).then(p=>{if(!t&&$1(window.grecaptcha))l(p,u,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let g=dC();g.length!==0&&(g+=p),vw(g).then(()=>{l(p,u,d)}).catch(y=>{d(y)})}}).catch(p=>{d(p)})})}}async function X1(n,e,t,i=!1,l=!1){const u=new yC(n);let d;if(l)d=xw;else try{d=await u.verify(t)}catch{d=await u.verify(t,!0)}const p={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in p){const g=p.phoneEnrollmentInfo.phoneNumber,y=p.phoneEnrollmentInfo.recaptchaToken;Object.assign(p,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:y,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in p){const g=p.phoneSignInInfo.recaptchaToken;Object.assign(p,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return p}return i?Object.assign(p,{captchaResp:d}):Object.assign(p,{captchaResponse:d}),Object.assign(p,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(p,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),p}async function Rh(n,e,t,i,l){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await X1(n,e,t,t==="getOobCode");return i(n,u)}else return i(n,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await X1(n,e,t,t==="getOobCode");return i(n,d)}else return Promise.reject(u)})}function bC(n,e){const t=Qh(n,"auth");if(t.isInitialized()){const l=t.getImmediate(),u=t.getOptions();if(Yo(u,e??{}))return l;xa(l,"already-initialized")}return t.initialize({options:e})}function vC(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(di);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function xC(n,e,t){const i=yo(n);Vt(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const l=!1,u=ww(e),{host:d,port:p}=wC(e),g=p===null?"":`:${p}`,y={url:`${u}//${d}${g}/`},w=Object.freeze({host:d,port:p,protocol:u.replace(":",""),options:Object.freeze({disableWarnings:l})});if(!i._canInitEmulator){Vt(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Vt(Yo(y,i.config.emulator)&&Yo(w,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=y,i.emulatorConfig=w,i.settings.appVerificationDisabledForTesting=!0,go(d)?(Vg(`${u}//${d}${g}`),Bg("Auth",!0)):_C()}function ww(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function wC(n){const e=ww(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",l=/^(\[[^\]]+\])(:|$)/.exec(i);if(l){const u=l[1];return{host:u,port:J1(i.substr(u.length+1))}}else{const[u,d]=i.split(":");return{host:u,port:J1(d)}}}function J1(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function _C(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Kg{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ui("not implemented")}_getIdTokenResponse(e){return ui("not implemented")}_linkToIdToken(e,t){return ui("not implemented")}_getReauthenticationResolver(e){return ui("not implemented")}}async function kC(n,e){return _i(n,"POST","/v1/accounts:signUp",e)}async function jC(n,e){return Du(n,"POST","/v1/accounts:signInWithPassword",wi(n,e))}async function _w(n,e){return _i(n,"POST","/v1/accounts:sendOobCode",wi(n,e))}async function TC(n,e){return _w(n,e)}async function EC(n,e){return _w(n,e)}async function NC(n,e){return Du(n,"POST","/v1/accounts:signInWithEmailLink",wi(n,e))}async function SC(n,e){return Du(n,"POST","/v1/accounts:signInWithEmailLink",wi(n,e))}class vu extends Kg{constructor(e,t,i,l=null){super("password",i),this._email=e,this._password=t,this._tenantId=l}static _fromEmailAndPassword(e,t){return new vu(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new vu(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Rh(e,t,"signInWithPassword",jC);case"emailLink":return NC(e,{email:this._email,oobCode:this._password});default:xa(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Rh(e,i,"signUpPassword",kC);case"emailLink":return SC(e,{idToken:t,email:this._email,oobCode:this._password});default:xa(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Gl(n,e){return Du(n,"POST","/v1/accounts:signInWithIdp",wi(n,e))}const CC="http://localhost";class Xo extends Kg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Xo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):xa("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:l,...u}=t;if(!i||!l)return null;const d=new Xo(i,l);return d.idToken=u.idToken||void 0,d.accessToken=u.accessToken||void 0,d.secret=u.secret,d.nonce=u.nonce,d.pendingToken=u.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Gl(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Gl(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Gl(e,t)}buildRequest(){const e={requestUri:CC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Iu(t)}return e}}function RC(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function AC(n){const e=tu(su(n)).link,t=e?tu(su(e)).deep_link_id:null,i=tu(su(n)).deep_link_id;return(i?tu(su(i)).link:null)||i||t||e||n}class Yg{constructor(e){const t=tu(su(e)),i=t.apiKey??null,l=t.oobCode??null,u=RC(t.mode??null);Vt(i&&l&&u,"argument-error"),this.apiKey=i,this.operation=u,this.code=l,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=AC(e);try{return new Yg(t)}catch{return null}}}class ac{constructor(){this.providerId=ac.PROVIDER_ID}static credential(e,t){return vu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=Yg.parseLink(t);return Vt(i,"argument-error"),vu._fromEmailAndCode(e,i.code,i.tenantId)}}ac.PROVIDER_ID="password";ac.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ac.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class kw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Pu extends kw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Qi extends Pu{constructor(){super("facebook.com")}static credential(e){return Xo._fromParams({providerId:Qi.PROVIDER_ID,signInMethod:Qi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Qi.credentialFromTaggedObject(e)}static credentialFromError(e){return Qi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Qi.credential(e.oauthAccessToken)}catch{return null}}}Qi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Qi.PROVIDER_ID="facebook.com";class Xi extends Pu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Xo._fromParams({providerId:Xi.PROVIDER_ID,signInMethod:Xi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Xi.credentialFromTaggedObject(e)}static credentialFromError(e){return Xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Xi.credential(t,i)}catch{return null}}}Xi.GOOGLE_SIGN_IN_METHOD="google.com";Xi.PROVIDER_ID="google.com";class Ji extends Pu{constructor(){super("github.com")}static credential(e){return Xo._fromParams({providerId:Ji.PROVIDER_ID,signInMethod:Ji.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ji.credentialFromTaggedObject(e)}static credentialFromError(e){return Ji.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ji.credential(e.oauthAccessToken)}catch{return null}}}Ji.GITHUB_SIGN_IN_METHOD="github.com";Ji.PROVIDER_ID="github.com";class Zi extends Pu{constructor(){super("twitter.com")}static credential(e,t){return Xo._fromParams({providerId:Zi.PROVIDER_ID,signInMethod:Zi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Zi.credentialFromTaggedObject(e)}static credentialFromError(e){return Zi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Zi.credential(t,i)}catch{return null}}}Zi.TWITTER_SIGN_IN_METHOD="twitter.com";Zi.PROVIDER_ID="twitter.com";async function IC(n,e){return Du(n,"POST","/v1/accounts:signUp",wi(n,e))}class Jo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,l=!1){const u=await ba._fromIdTokenResponse(e,i,l),d=Z1(i);return new Jo({user:u,providerId:d,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const l=Z1(i);return new Jo({user:e,providerId:l,_tokenResponse:i,operationType:t})}}function Z1(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Ah extends Wa{constructor(e,t,i,l){super(t.code,t.message),this.operationType=i,this.user=l,Object.setPrototypeOf(this,Ah.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,l){return new Ah(e,t,i,l)}}function jw(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(u=>{throw u.code==="auth/multi-factor-auth-required"?Ah._fromErrorAndOperation(n,u,e,i):u})}async function MC(n,e,t=!1){const i=await bu(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Jo._forOperation(n,"link",i)}async function DC(n,e,t=!1){const{auth:i}=n;if($r(i.app))return Promise.reject(fi(i));const l="reauthenticate";try{const u=await bu(n,jw(i,l,e,n),t);Vt(u.idToken,i,"internal-error");const d=Wg(u.idToken);Vt(d,i,"internal-error");const{sub:p}=d;return Vt(n.uid===p,i,"user-mismatch"),Jo._forOperation(n,l,u)}catch(u){throw u?.code==="auth/user-not-found"&&xa(i,"user-mismatch"),u}}async function Tw(n,e,t=!1){if($r(n.app))return Promise.reject(fi(n));const i="signIn",l=await jw(n,i,e),u=await Jo._fromIdTokenResponse(n,i,l);return t||await n._updateCurrentUser(u.user),u}async function PC(n,e){return Tw(yo(n),e)}async function Ew(n){const e=yo(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function LC(n,e,t){const i=yo(n);await Rh(i,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",EC)}async function OC(n,e,t){if($r(n.app))return Promise.reject(fi(n));const i=yo(n),d=await Rh(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",IC).catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&Ew(n),g}),p=await Jo._fromIdTokenResponse(i,"signIn",d);return await i._updateCurrentUser(p.user),p}function VC(n,e,t){return $r(n.app)?Promise.reject(fi(n)):PC(Gs(n),ac.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&Ew(n),i})}async function _6(n,e){const t=Gs(n),l={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()},{email:u}=await TC(t.auth,l);u!==n.email&&await n.reload()}function ex(n,e){return Gs(n).setPersistence(e)}function BC(n,e,t,i){return Gs(n).onIdTokenChanged(e,t,i)}function UC(n,e,t){return Gs(n).beforeAuthStateChanged(e,t)}function zC(n,e,t,i){return Gs(n).onAuthStateChanged(e,t,i)}function FC(n){return Gs(n).signOut()}const Ih="__sak";class Nw{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ih,"1"),this.storage.removeItem(Ih),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const HC=1e3,qC=10;class Sw extends Nw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=yw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),l=this.localCache[t];i!==l&&e(t,l,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,p,g)=>{this.notifyListeners(d,g)});return}const i=e.key;t?this.detachListener():this.stopPolling();const l=()=>{const d=this.storage.getItem(i);!t&&this.localCache[i]===d||this.notifyListeners(i,d)},u=this.storage.getItem(i);rC()&&u!==e.newValue&&e.newValue!==e.oldValue?setTimeout(l,qC):l()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},HC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Sw.type="LOCAL";const ug=Sw;class Cw extends Nw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Cw.type="SESSION";const Qg=Cw;function $C(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Jh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(l=>l.isListeningto(e));if(t)return t;const i=new Jh(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:l,data:u}=t.data,d=this.handlersMap[l];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:l});const p=Array.from(d).map(async y=>y(t.origin,u)),g=await $C(p);t.ports[0].postMessage({status:"done",eventId:i,eventType:l,response:g})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Jh.receivers=[];function Xg(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class WC{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const l=typeof MessageChannel<"u"?new MessageChannel:null;if(!l)throw new Error("connection_unavailable");let u,d;return new Promise((p,g)=>{const y=Xg("",20);l.port1.start();const w=setTimeout(()=>{g(new Error("unsupported_event"))},i);d={messageChannel:l,onMessage(k){const j=k;if(j.data.eventId===y)switch(j.data.status){case"ack":clearTimeout(w),u=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),p(j.data.response);break;default:clearTimeout(w),clearTimeout(u),g(new Error("invalid_response"));break}}},this.handlers.add(d),l.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:y,data:t},[l.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}function Ua(){return window}function GC(n){Ua().location.href=n}function Rw(){return typeof Ua().WorkerGlobalScope<"u"&&typeof Ua().importScripts=="function"}async function KC(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function YC(){return navigator?.serviceWorker?.controller||null}function QC(){return Rw()?self:null}const Aw="firebaseLocalStorageDb",XC=1,Mh="firebaseLocalStorage",Iw="fbase_key";class Lu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Zh(n,e){return n.transaction([Mh],e?"readwrite":"readonly").objectStore(Mh)}function JC(){const n=indexedDB.deleteDatabase(Aw);return new Lu(n).toPromise()}function dg(){const n=indexedDB.open(Aw,XC);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Mh,{keyPath:Iw})}catch(l){t(l)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Mh)?e(i):(i.close(),await JC(),e(await dg()))})})}async function tx(n,e,t){const i=Zh(n,!0).put({[Iw]:e,value:t});return new Lu(i).toPromise()}async function ZC(n,e){const t=Zh(n,!1).get(e),i=await new Lu(t).toPromise();return i===void 0?null:i.value}function sx(n,e){const t=Zh(n,!0).delete(e);return new Lu(t).toPromise()}const e4=800,t4=3;class Mw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await dg(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>t4)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Rw()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Jh._getInstance(QC()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await KC(),!this.activeServiceWorker)return;this.sender=new WC(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||YC()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await dg();return await tx(e,Ih,"1"),await sx(e,Ih),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>tx(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>ZC(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>sx(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(l=>{const u=Zh(l,!1).getAll();return new Lu(u).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:l,value:u}of e)i.add(l),JSON.stringify(this.localCache[l])!==JSON.stringify(u)&&(this.notifyListeners(l,u),t.push(l));for(const l of Object.keys(this.localCache))this.localCache[l]&&!i.has(l)&&(this.notifyListeners(l,null),t.push(l));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),e4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Mw.type="LOCAL";const s4=Mw;new Mu(3e4,6e4);function n4(n,e){return e?di(e):(Vt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class Jg extends Kg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Gl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Gl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Gl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function r4(n){return Tw(n.auth,new Jg(n),n.bypassAuthState)}function a4(n){const{auth:e,user:t}=n;return Vt(t,e,"internal-error"),DC(t,new Jg(n),n.bypassAuthState)}async function i4(n){const{auth:e,user:t}=n;return Vt(t,e,"internal-error"),MC(t,new Jg(n),n.bypassAuthState)}class Dw{constructor(e,t,i,l,u=!1){this.auth=e,this.resolver=i,this.user=l,this.bypassAuthState=u,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:l,tenantId:u,error:d,type:p}=e;if(d){this.reject(d);return}const g={auth:this.auth,requestUri:t,sessionId:i,tenantId:u||void 0,postBody:l||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(p)(g))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return r4;case"linkViaPopup":case"linkViaRedirect":return i4;case"reauthViaPopup":case"reauthViaRedirect":return a4;default:xa(this.auth,"internal-error")}}resolve(e){bi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){bi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const o4=new Mu(2e3,1e4);class ql extends Dw{constructor(e,t,i,l,u){super(e,t,l,u),this.provider=i,this.authWindow=null,this.pollId=null,ql.currentPopupAction&&ql.currentPopupAction.cancel(),ql.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Vt(e,this.auth,"internal-error"),e}async onExecution(){bi(this.filter.length===1,"Popup operations only handle one event");const e=Xg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ba(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Ba(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ql.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ba(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,o4.get())};e()}}ql.currentPopupAction=null;const l4="pendingRedirect",gh=new Map;class c4 extends Dw{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=gh.get(this.auth._key());if(!e){try{const i=await u4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}gh.set(this.auth._key(),e)}return this.bypassAuthState||gh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function u4(n,e){const t=f4(e),i=h4(n);if(!await i._isAvailable())return!1;const l=await i._get(t)==="true";return await i._remove(t),l}function d4(n,e){gh.set(n._key(),e)}function h4(n){return di(n._redirectPersistence)}function f4(n){return ph(l4,n.config.apiKey,n.name)}async function m4(n,e,t=!1){if($r(n.app))return Promise.reject(fi(n));const i=yo(n),l=n4(i,e),d=await new c4(i,l,t).execute();return d&&!t&&(delete d.user._redirectEventId,await i._persistUserIfCurrent(d.user),await i._setRedirectUser(null,e)),d}const p4=600*1e3;class g4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!y4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Pw(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Ba(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=p4&&this.cachedEventUids.clear(),this.cachedEventUids.has(nx(e))}saveEventToCache(e){this.cachedEventUids.add(nx(e)),this.lastProcessedEventTime=Date.now()}}function nx(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Pw({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function y4(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Pw(n);default:return!1}}async function b4(n,e={}){return _i(n,"GET","/v1/projects",e)}const v4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,x4=/^https?/;async function w4(n){if(n.config.emulator)return;const{authorizedDomains:e}=await b4(n);for(const t of e)try{if(_4(t))return}catch{}xa(n,"unauthorized-domain")}function _4(n){const e=lg(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===i}if(!x4.test(t))return!1;if(v4.test(n))return i===n;const l=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+l+"|"+l+")$","i").test(i)}const k4=new Mu(3e4,6e4);function rx(){const n=Ua().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function j4(n){return new Promise((e,t)=>{function i(){rx(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{rx(),t(Ba(n,"network-request-failed"))},timeout:k4.get()})}if(Ua().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ua().gapi?.load)i();else{const l=fC("iframefcb");return Ua()[l]=()=>{gapi.load?i():t(Ba(n,"network-request-failed"))},vw(`${hC()}?onload=${l}`).catch(u=>t(u))}}).catch(e=>{throw yh=null,e})}let yh=null;function T4(n){return yh=yh||j4(n),yh}const E4=new Mu(5e3,15e3),N4="__/auth/iframe",S4="emulator/auth/iframe",C4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},R4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function A4(n){const e=n.config;Vt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?$g(e,S4):`https://${n.config.authDomain}/${N4}`,i={apiKey:e.apiKey,appName:n.name,v:nl},l=R4.get(n.config.apiHost);l&&(i.eid=l);const u=n._getFrameworks();return u.length&&(i.fw=u.join(",")),`${t}?${Iu(i).slice(1)}`}async function I4(n){const e=await T4(n),t=Ua().gapi;return Vt(t,n,"internal-error"),e.open({where:document.body,url:A4(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:C4,dontclear:!0},i=>new Promise(async(l,u)=>{await i.restyle({setHideOnLeave:!1});const d=Ba(n,"network-request-failed"),p=Ua().setTimeout(()=>{u(d)},E4.get());function g(){Ua().clearTimeout(p),l(i)}i.ping(g).then(g,()=>{u(d)})}))}const M4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},D4=500,P4=600,L4="_blank",O4="http://localhost";class ax{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function V4(n,e,t,i=D4,l=P4){const u=Math.max((window.screen.availHeight-l)/2,0).toString(),d=Math.max((window.screen.availWidth-i)/2,0).toString();let p="";const g={...M4,width:i.toString(),height:l.toString(),top:u,left:d},y=dr().toLowerCase();t&&(p=hw(y)?L4:t),uw(y)&&(e=e||O4,g.scrollbars="yes");const w=Object.entries(g).reduce((j,[O,q])=>`${j}${O}=${q},`,"");if(nC(y)&&p!=="_self")return B4(e||"",p),new ax(null);const k=window.open(e||"",p,w);Vt(k,n,"popup-blocked");try{k.focus()}catch{}return new ax(k)}function B4(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const U4="__/auth/handler",z4="emulator/auth/handler",F4=encodeURIComponent("fac");async function ix(n,e,t,i,l,u){Vt(n.config.authDomain,n,"auth-domain-config-required"),Vt(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:nl,eventId:l};if(e instanceof kw){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",TN(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[w,k]of Object.entries({}))d[w]=k}if(e instanceof Pu){const w=e.getScopes().filter(k=>k!=="");w.length>0&&(d.scopes=w.join(","))}n.tenantId&&(d.tid=n.tenantId);const p=d;for(const w of Object.keys(p))p[w]===void 0&&delete p[w];const g=await n._getAppCheckToken(),y=g?`#${F4}=${encodeURIComponent(g)}`:"";return`${H4(n)}?${Iu(p).slice(1)}${y}`}function H4({config:n}){return n.emulator?$g(n,z4):`https://${n.authDomain}/${U4}`}const Cp="webStorageSupport";class q4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Qg,this._completeRedirectFn=m4,this._overrideRedirectResult=d4}async _openPopup(e,t,i,l){bi(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const u=await ix(e,t,i,lg(),l);return V4(e,u,Xg())}async _openRedirect(e,t,i,l){await this._originValidation(e);const u=await ix(e,t,i,lg(),l);return GC(u),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:l,promise:u}=this.eventManagers[t];return l?Promise.resolve(l):(bi(u,"If manager is not set, promise should be"),u)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await I4(e),i=new g4(e);return t.register("authEvent",l=>(Vt(l?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(l.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Cp,{type:Cp},l=>{const u=l?.[0]?.[Cp];u!==void 0&&t(!!u),xa(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=w4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return yw()||dw()||Gg()}}const $4=q4;var ox="@firebase/auth",lx="1.12.0";class W4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Vt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function G4(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function K4(n){Qo(new lo("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),l=e.getProvider("heartbeat"),u=e.getProvider("app-check-internal"),{apiKey:d,authDomain:p}=i.options;Vt(d&&!d.includes(":"),"invalid-api-key",{appName:i.name});const g={apiKey:d,authDomain:p,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:bw(n)},y=new cC(i,l,u,g);return vC(y,t),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),Qo(new lo("auth-internal",e=>{const t=yo(e.getProvider("auth").getImmediate());return(i=>new W4(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Va(ox,lx,G4(n)),Va(ox,lx,"esm2020")}const Y4=300,Q4=Q2("authIdTokenMaxAge")||Y4;let cx=null;const X4=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>Q4)return;const l=t?.token;cx!==l&&(cx=l,await fetch(n,{method:l?"POST":"DELETE",headers:l?{Authorization:`Bearer ${l}`}:{}}))};function Lw(n=Hg()){const e=Qh(n,"auth");if(e.isInitialized())return e.getImmediate();const t=bC(n,{popupRedirectResolver:$4,persistence:[s4,ug,Qg]}),i=Q2("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const u=new URL(i,location.origin);if(location.origin===u.origin){const d=X4(u.toString());UC(t,d,()=>d(t.currentUser)),BC(t,p=>d(p))}}const l=G2("auth");return l&&xC(t,`http://${l}`),t}function J4(){return document.getElementsByTagName("head")?.[0]??document}uC({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=l=>{const u=Ba("internal-error");u.customData=l,t(u)},i.type="text/javascript",i.charset="UTF-8",J4().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});K4("Browser");var ux=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var io,Ow;(function(){var n;function e(R,T){function A(){}A.prototype=T.prototype,R.F=T.prototype,R.prototype=new A,R.prototype.constructor=R,R.D=function(L,D,F){for(var M=Array(arguments.length-2),$e=2;$e<arguments.length;$e++)M[$e-2]=arguments[$e];return T.prototype[D].apply(L,M)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function l(R,T,A){A||(A=0);const L=Array(16);if(typeof T=="string")for(var D=0;D<16;++D)L[D]=T.charCodeAt(A++)|T.charCodeAt(A++)<<8|T.charCodeAt(A++)<<16|T.charCodeAt(A++)<<24;else for(D=0;D<16;++D)L[D]=T[A++]|T[A++]<<8|T[A++]<<16|T[A++]<<24;T=R.g[0],A=R.g[1],D=R.g[2];let F=R.g[3],M;M=T+(F^A&(D^F))+L[0]+3614090360&4294967295,T=A+(M<<7&4294967295|M>>>25),M=F+(D^T&(A^D))+L[1]+3905402710&4294967295,F=T+(M<<12&4294967295|M>>>20),M=D+(A^F&(T^A))+L[2]+606105819&4294967295,D=F+(M<<17&4294967295|M>>>15),M=A+(T^D&(F^T))+L[3]+3250441966&4294967295,A=D+(M<<22&4294967295|M>>>10),M=T+(F^A&(D^F))+L[4]+4118548399&4294967295,T=A+(M<<7&4294967295|M>>>25),M=F+(D^T&(A^D))+L[5]+1200080426&4294967295,F=T+(M<<12&4294967295|M>>>20),M=D+(A^F&(T^A))+L[6]+2821735955&4294967295,D=F+(M<<17&4294967295|M>>>15),M=A+(T^D&(F^T))+L[7]+4249261313&4294967295,A=D+(M<<22&4294967295|M>>>10),M=T+(F^A&(D^F))+L[8]+1770035416&4294967295,T=A+(M<<7&4294967295|M>>>25),M=F+(D^T&(A^D))+L[9]+2336552879&4294967295,F=T+(M<<12&4294967295|M>>>20),M=D+(A^F&(T^A))+L[10]+4294925233&4294967295,D=F+(M<<17&4294967295|M>>>15),M=A+(T^D&(F^T))+L[11]+2304563134&4294967295,A=D+(M<<22&4294967295|M>>>10),M=T+(F^A&(D^F))+L[12]+1804603682&4294967295,T=A+(M<<7&4294967295|M>>>25),M=F+(D^T&(A^D))+L[13]+4254626195&4294967295,F=T+(M<<12&4294967295|M>>>20),M=D+(A^F&(T^A))+L[14]+2792965006&4294967295,D=F+(M<<17&4294967295|M>>>15),M=A+(T^D&(F^T))+L[15]+1236535329&4294967295,A=D+(M<<22&4294967295|M>>>10),M=T+(D^F&(A^D))+L[1]+4129170786&4294967295,T=A+(M<<5&4294967295|M>>>27),M=F+(A^D&(T^A))+L[6]+3225465664&4294967295,F=T+(M<<9&4294967295|M>>>23),M=D+(T^A&(F^T))+L[11]+643717713&4294967295,D=F+(M<<14&4294967295|M>>>18),M=A+(F^T&(D^F))+L[0]+3921069994&4294967295,A=D+(M<<20&4294967295|M>>>12),M=T+(D^F&(A^D))+L[5]+3593408605&4294967295,T=A+(M<<5&4294967295|M>>>27),M=F+(A^D&(T^A))+L[10]+38016083&4294967295,F=T+(M<<9&4294967295|M>>>23),M=D+(T^A&(F^T))+L[15]+3634488961&4294967295,D=F+(M<<14&4294967295|M>>>18),M=A+(F^T&(D^F))+L[4]+3889429448&4294967295,A=D+(M<<20&4294967295|M>>>12),M=T+(D^F&(A^D))+L[9]+568446438&4294967295,T=A+(M<<5&4294967295|M>>>27),M=F+(A^D&(T^A))+L[14]+3275163606&4294967295,F=T+(M<<9&4294967295|M>>>23),M=D+(T^A&(F^T))+L[3]+4107603335&4294967295,D=F+(M<<14&4294967295|M>>>18),M=A+(F^T&(D^F))+L[8]+1163531501&4294967295,A=D+(M<<20&4294967295|M>>>12),M=T+(D^F&(A^D))+L[13]+2850285829&4294967295,T=A+(M<<5&4294967295|M>>>27),M=F+(A^D&(T^A))+L[2]+4243563512&4294967295,F=T+(M<<9&4294967295|M>>>23),M=D+(T^A&(F^T))+L[7]+1735328473&4294967295,D=F+(M<<14&4294967295|M>>>18),M=A+(F^T&(D^F))+L[12]+2368359562&4294967295,A=D+(M<<20&4294967295|M>>>12),M=T+(A^D^F)+L[5]+4294588738&4294967295,T=A+(M<<4&4294967295|M>>>28),M=F+(T^A^D)+L[8]+2272392833&4294967295,F=T+(M<<11&4294967295|M>>>21),M=D+(F^T^A)+L[11]+1839030562&4294967295,D=F+(M<<16&4294967295|M>>>16),M=A+(D^F^T)+L[14]+4259657740&4294967295,A=D+(M<<23&4294967295|M>>>9),M=T+(A^D^F)+L[1]+2763975236&4294967295,T=A+(M<<4&4294967295|M>>>28),M=F+(T^A^D)+L[4]+1272893353&4294967295,F=T+(M<<11&4294967295|M>>>21),M=D+(F^T^A)+L[7]+4139469664&4294967295,D=F+(M<<16&4294967295|M>>>16),M=A+(D^F^T)+L[10]+3200236656&4294967295,A=D+(M<<23&4294967295|M>>>9),M=T+(A^D^F)+L[13]+681279174&4294967295,T=A+(M<<4&4294967295|M>>>28),M=F+(T^A^D)+L[0]+3936430074&4294967295,F=T+(M<<11&4294967295|M>>>21),M=D+(F^T^A)+L[3]+3572445317&4294967295,D=F+(M<<16&4294967295|M>>>16),M=A+(D^F^T)+L[6]+76029189&4294967295,A=D+(M<<23&4294967295|M>>>9),M=T+(A^D^F)+L[9]+3654602809&4294967295,T=A+(M<<4&4294967295|M>>>28),M=F+(T^A^D)+L[12]+3873151461&4294967295,F=T+(M<<11&4294967295|M>>>21),M=D+(F^T^A)+L[15]+530742520&4294967295,D=F+(M<<16&4294967295|M>>>16),M=A+(D^F^T)+L[2]+3299628645&4294967295,A=D+(M<<23&4294967295|M>>>9),M=T+(D^(A|~F))+L[0]+4096336452&4294967295,T=A+(M<<6&4294967295|M>>>26),M=F+(A^(T|~D))+L[7]+1126891415&4294967295,F=T+(M<<10&4294967295|M>>>22),M=D+(T^(F|~A))+L[14]+2878612391&4294967295,D=F+(M<<15&4294967295|M>>>17),M=A+(F^(D|~T))+L[5]+4237533241&4294967295,A=D+(M<<21&4294967295|M>>>11),M=T+(D^(A|~F))+L[12]+1700485571&4294967295,T=A+(M<<6&4294967295|M>>>26),M=F+(A^(T|~D))+L[3]+2399980690&4294967295,F=T+(M<<10&4294967295|M>>>22),M=D+(T^(F|~A))+L[10]+4293915773&4294967295,D=F+(M<<15&4294967295|M>>>17),M=A+(F^(D|~T))+L[1]+2240044497&4294967295,A=D+(M<<21&4294967295|M>>>11),M=T+(D^(A|~F))+L[8]+1873313359&4294967295,T=A+(M<<6&4294967295|M>>>26),M=F+(A^(T|~D))+L[15]+4264355552&4294967295,F=T+(M<<10&4294967295|M>>>22),M=D+(T^(F|~A))+L[6]+2734768916&4294967295,D=F+(M<<15&4294967295|M>>>17),M=A+(F^(D|~T))+L[13]+1309151649&4294967295,A=D+(M<<21&4294967295|M>>>11),M=T+(D^(A|~F))+L[4]+4149444226&4294967295,T=A+(M<<6&4294967295|M>>>26),M=F+(A^(T|~D))+L[11]+3174756917&4294967295,F=T+(M<<10&4294967295|M>>>22),M=D+(T^(F|~A))+L[2]+718787259&4294967295,D=F+(M<<15&4294967295|M>>>17),M=A+(F^(D|~T))+L[9]+3951481745&4294967295,R.g[0]=R.g[0]+T&4294967295,R.g[1]=R.g[1]+(D+(M<<21&4294967295|M>>>11))&4294967295,R.g[2]=R.g[2]+D&4294967295,R.g[3]=R.g[3]+F&4294967295}i.prototype.v=function(R,T){T===void 0&&(T=R.length);const A=T-this.blockSize,L=this.C;let D=this.h,F=0;for(;F<T;){if(D==0)for(;F<=A;)l(this,R,F),F+=this.blockSize;if(typeof R=="string"){for(;F<T;)if(L[D++]=R.charCodeAt(F++),D==this.blockSize){l(this,L),D=0;break}}else for(;F<T;)if(L[D++]=R[F++],D==this.blockSize){l(this,L),D=0;break}}this.h=D,this.o+=T},i.prototype.A=function(){var R=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);R[0]=128;for(var T=1;T<R.length-8;++T)R[T]=0;T=this.o*8;for(var A=R.length-8;A<R.length;++A)R[A]=T&255,T/=256;for(this.v(R),R=Array(16),T=0,A=0;A<4;++A)for(let L=0;L<32;L+=8)R[T++]=this.g[A]>>>L&255;return R};function u(R,T){var A=p;return Object.prototype.hasOwnProperty.call(A,R)?A[R]:A[R]=T(R)}function d(R,T){this.h=T;const A=[];let L=!0;for(let D=R.length-1;D>=0;D--){const F=R[D]|0;L&&F==T||(A[D]=F,L=!1)}this.g=A}var p={};function g(R){return-128<=R&&R<128?u(R,function(T){return new d([T|0],T<0?-1:0)}):new d([R|0],R<0?-1:0)}function y(R){if(isNaN(R)||!isFinite(R))return k;if(R<0)return V(y(-R));const T=[];let A=1;for(let L=0;R>=A;L++)T[L]=R/A|0,A*=4294967296;return new d(T,0)}function w(R,T){if(R.length==0)throw Error("number format error: empty string");if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(R.charAt(0)=="-")return V(w(R.substring(1),T));if(R.indexOf("-")>=0)throw Error('number format error: interior "-" character');const A=y(Math.pow(T,8));let L=k;for(let F=0;F<R.length;F+=8){var D=Math.min(8,R.length-F);const M=parseInt(R.substring(F,F+D),T);D<8?(D=y(Math.pow(T,D)),L=L.j(D).add(y(M))):(L=L.j(A),L=L.add(y(M)))}return L}var k=g(0),j=g(1),O=g(16777216);n=d.prototype,n.m=function(){if(B(this))return-V(this).m();let R=0,T=1;for(let A=0;A<this.g.length;A++){const L=this.i(A);R+=(L>=0?L:4294967296+L)*T,T*=4294967296}return R},n.toString=function(R){if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(q(this))return"0";if(B(this))return"-"+V(this).toString(R);const T=y(Math.pow(R,6));var A=this;let L="";for(;;){const D=ge(A,T).g;A=ne(A,D.j(T));let F=((A.g.length>0?A.g[0]:A.h)>>>0).toString(R);if(A=D,q(A))return F+L;for(;F.length<6;)F="0"+F;L=F+L}},n.i=function(R){return R<0?0:R<this.g.length?this.g[R]:this.h};function q(R){if(R.h!=0)return!1;for(let T=0;T<R.g.length;T++)if(R.g[T]!=0)return!1;return!0}function B(R){return R.h==-1}n.l=function(R){return R=ne(this,R),B(R)?-1:q(R)?0:1};function V(R){const T=R.g.length,A=[];for(let L=0;L<T;L++)A[L]=~R.g[L];return new d(A,~R.h).add(j)}n.abs=function(){return B(this)?V(this):this},n.add=function(R){const T=Math.max(this.g.length,R.g.length),A=[];let L=0;for(let D=0;D<=T;D++){let F=L+(this.i(D)&65535)+(R.i(D)&65535),M=(F>>>16)+(this.i(D)>>>16)+(R.i(D)>>>16);L=M>>>16,F&=65535,M&=65535,A[D]=M<<16|F}return new d(A,A[A.length-1]&-2147483648?-1:0)};function ne(R,T){return R.add(V(T))}n.j=function(R){if(q(this)||q(R))return k;if(B(this))return B(R)?V(this).j(V(R)):V(V(this).j(R));if(B(R))return V(this.j(V(R)));if(this.l(O)<0&&R.l(O)<0)return y(this.m()*R.m());const T=this.g.length+R.g.length,A=[];for(var L=0;L<2*T;L++)A[L]=0;for(L=0;L<this.g.length;L++)for(let D=0;D<R.g.length;D++){const F=this.i(L)>>>16,M=this.i(L)&65535,$e=R.i(D)>>>16,bt=R.i(D)&65535;A[2*L+2*D]+=M*bt,K(A,2*L+2*D),A[2*L+2*D+1]+=F*bt,K(A,2*L+2*D+1),A[2*L+2*D+1]+=M*$e,K(A,2*L+2*D+1),A[2*L+2*D+2]+=F*$e,K(A,2*L+2*D+2)}for(R=0;R<T;R++)A[R]=A[2*R+1]<<16|A[2*R];for(R=T;R<2*T;R++)A[R]=0;return new d(A,0)};function K(R,T){for(;(R[T]&65535)!=R[T];)R[T+1]+=R[T]>>>16,R[T]&=65535,T++}function le(R,T){this.g=R,this.h=T}function ge(R,T){if(q(T))throw Error("division by zero");if(q(R))return new le(k,k);if(B(R))return T=ge(V(R),T),new le(V(T.g),V(T.h));if(B(T))return T=ge(R,V(T)),new le(V(T.g),T.h);if(R.g.length>30){if(B(R)||B(T))throw Error("slowDivide_ only works with positive integers.");for(var A=j,L=T;L.l(R)<=0;)A=Ie(A),L=Ie(L);var D=Te(A,1),F=Te(L,1);for(L=Te(L,2),A=Te(A,2);!q(L);){var M=F.add(L);M.l(R)<=0&&(D=D.add(A),F=M),L=Te(L,1),A=Te(A,1)}return T=ne(R,D.j(T)),new le(D,T)}for(D=k;R.l(T)>=0;){for(A=Math.max(1,Math.floor(R.m()/T.m())),L=Math.ceil(Math.log(A)/Math.LN2),L=L<=48?1:Math.pow(2,L-48),F=y(A),M=F.j(T);B(M)||M.l(R)>0;)A-=L,F=y(A),M=F.j(T);q(F)&&(F=j),D=D.add(F),R=ne(R,M)}return new le(D,R)}n.B=function(R){return ge(this,R).h},n.and=function(R){const T=Math.max(this.g.length,R.g.length),A=[];for(let L=0;L<T;L++)A[L]=this.i(L)&R.i(L);return new d(A,this.h&R.h)},n.or=function(R){const T=Math.max(this.g.length,R.g.length),A=[];for(let L=0;L<T;L++)A[L]=this.i(L)|R.i(L);return new d(A,this.h|R.h)},n.xor=function(R){const T=Math.max(this.g.length,R.g.length),A=[];for(let L=0;L<T;L++)A[L]=this.i(L)^R.i(L);return new d(A,this.h^R.h)};function Ie(R){const T=R.g.length+1,A=[];for(let L=0;L<T;L++)A[L]=R.i(L)<<1|R.i(L-1)>>>31;return new d(A,R.h)}function Te(R,T){const A=T>>5;T%=32;const L=R.g.length-A,D=[];for(let F=0;F<L;F++)D[F]=T>0?R.i(F+A)>>>T|R.i(F+A+1)<<32-T:R.i(F+A);return new d(D,R.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,Ow=i,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.B,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=y,d.fromString=w,io=d}).apply(typeof ux<"u"?ux:typeof self<"u"?self:typeof window<"u"?window:{});var eh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Vw,nu,Bw,bh,hg,Uw,zw,Fw;(function(){var n,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof eh=="object"&&eh];for(var b=0;b<h.length;++b){var _=h[b];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var i=t(this);function l(h,b){if(b)e:{var _=i;h=h.split(".");for(var C=0;C<h.length-1;C++){var re=h[C];if(!(re in _))break e;_=_[re]}h=h[h.length-1],C=_[h],b=b(C),b!=C&&b!=null&&e(_,h,{configurable:!0,writable:!0,value:b})}}l("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),l("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),l("Object.entries",function(h){return h||function(b){var _=[],C;for(C in b)Object.prototype.hasOwnProperty.call(b,C)&&_.push([C,b[C]]);return _}});var u=u||{},d=this||self;function p(h){var b=typeof h;return b=="object"&&h!=null||b=="function"}function g(h,b,_){return h.call.apply(h.bind,arguments)}function y(h,b,_){return y=g,y.apply(null,arguments)}function w(h,b){var _=Array.prototype.slice.call(arguments,1);return function(){var C=_.slice();return C.push.apply(C,arguments),h.apply(this,C)}}function k(h,b){function _(){}_.prototype=b.prototype,h.Z=b.prototype,h.prototype=new _,h.prototype.constructor=h,h.Ob=function(C,re,de){for(var Xe=Array(arguments.length-2),Zt=2;Zt<arguments.length;Zt++)Xe[Zt-2]=arguments[Zt];return b.prototype[re].apply(C,Xe)}}var j=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function O(h){const b=h.length;if(b>0){const _=Array(b);for(let C=0;C<b;C++)_[C]=h[C];return _}return[]}function q(h,b){for(let C=1;C<arguments.length;C++){const re=arguments[C];var _=typeof re;if(_=_!="object"?_:re?Array.isArray(re)?"array":_:"null",_=="array"||_=="object"&&typeof re.length=="number"){_=h.length||0;const de=re.length||0;h.length=_+de;for(let Xe=0;Xe<de;Xe++)h[_+Xe]=re[Xe]}else h.push(re)}}class B{constructor(b,_){this.i=b,this.j=_,this.h=0,this.g=null}get(){let b;return this.h>0?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function V(h){d.setTimeout(()=>{throw h},0)}function ne(){var h=R;let b=null;return h.g&&(b=h.g,h.g=h.g.next,h.g||(h.h=null),b.next=null),b}class K{constructor(){this.h=this.g=null}add(b,_){const C=le.get();C.set(b,_),this.h?this.h.next=C:this.g=C,this.h=C}}var le=new B(()=>new ge,h=>h.reset());class ge{constructor(){this.next=this.g=this.h=null}set(b,_){this.h=b,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let Ie,Te=!1,R=new K,T=()=>{const h=Promise.resolve(void 0);Ie=()=>{h.then(A)}};function A(){for(var h;h=ne();){try{h.h.call(h.g)}catch(_){V(_)}var b=le;b.j(h),b.h<100&&(b.h++,h.next=b.g,b.g=h)}Te=!1}function L(){this.u=this.u,this.C=this.C}L.prototype.u=!1,L.prototype.dispose=function(){this.u||(this.u=!0,this.N())},L.prototype[Symbol.dispose]=function(){this.dispose()},L.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(h,b){this.type=h,this.g=this.target=b,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var F=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var h=!1,b=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const _=()=>{};d.addEventListener("test",_,b),d.removeEventListener("test",_,b)}catch{}return h})();function M(h){return/^[\s\xa0]*$/.test(h)}function $e(h,b){D.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,b)}k($e,D),$e.prototype.init=function(h,b){const _=this.type=h.type,C=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=b,b=h.relatedTarget,b||(_=="mouseover"?b=h.fromElement:_=="mouseout"&&(b=h.toElement)),this.relatedTarget=b,C?(this.clientX=C.clientX!==void 0?C.clientX:C.pageX,this.clientY=C.clientY!==void 0?C.clientY:C.pageY,this.screenX=C.screenX||0,this.screenY=C.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&$e.Z.h.call(this)},$e.prototype.h=function(){$e.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var bt="closure_listenable_"+(Math.random()*1e6|0),H=0;function fe(h,b,_,C,re){this.listener=h,this.proxy=null,this.src=b,this.type=_,this.capture=!!C,this.ha=re,this.key=++H,this.da=this.fa=!1}function Me(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Ke(h,b,_){for(const C in h)b.call(_,h[C],C,h)}function ee(h,b){for(const _ in h)b.call(void 0,h[_],_,h)}function P(h){const b={};for(const _ in h)b[_]=h[_];return b}const se="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Se(h,b){let _,C;for(let re=1;re<arguments.length;re++){C=arguments[re];for(_ in C)h[_]=C[_];for(let de=0;de<se.length;de++)_=se[de],Object.prototype.hasOwnProperty.call(C,_)&&(h[_]=C[_])}}function Oe(h){this.src=h,this.g={},this.h=0}Oe.prototype.add=function(h,b,_,C,re){const de=h.toString();h=this.g[de],h||(h=this.g[de]=[],this.h++);const Xe=Ue(h,b,C,re);return Xe>-1?(b=h[Xe],_||(b.fa=!1)):(b=new fe(b,this.src,de,!!C,re),b.fa=_,h.push(b)),b};function st(h,b){const _=b.type;if(_ in h.g){var C=h.g[_],re=Array.prototype.indexOf.call(C,b,void 0),de;(de=re>=0)&&Array.prototype.splice.call(C,re,1),de&&(Me(b),h.g[_].length==0&&(delete h.g[_],h.h--))}}function Ue(h,b,_,C){for(let re=0;re<h.length;++re){const de=h[re];if(!de.da&&de.listener==b&&de.capture==!!_&&de.ha==C)return re}return-1}var gt="closure_lm_"+(Math.random()*1e6|0),Tt={};function rt(h,b,_,C,re){if(Array.isArray(b)){for(let de=0;de<b.length;de++)rt(h,b[de],_,C,re);return null}return _=ut(_),h&&h[bt]?h.J(b,_,p(C)?!!C.capture:!1,re):Wt(h,b,_,!1,C,re)}function Wt(h,b,_,C,re,de){if(!b)throw Error("Invalid event type");const Xe=p(re)?!!re.capture:!!re;let Zt=pt(h);if(Zt||(h[gt]=Zt=new Oe(h)),_=Zt.add(b,_,C,Xe,de),_.proxy)return _;if(C=js(),_.proxy=C,C.src=h,C.listener=_,h.addEventListener)F||(re=Xe),re===void 0&&(re=!1),h.addEventListener(b.toString(),C,re);else if(h.attachEvent)h.attachEvent(Z(b.toString()),C);else if(h.addListener&&h.removeListener)h.addListener(C);else throw Error("addEventListener and attachEvent are unavailable.");return _}function js(){function h(_){return b.call(h.src,h.listener,_)}const b=mt;return h}function At(h,b,_,C,re){if(Array.isArray(b))for(var de=0;de<b.length;de++)At(h,b[de],_,C,re);else C=p(C)?!!C.capture:!!C,_=ut(_),h&&h[bt]?(h=h.i,de=String(b).toString(),de in h.g&&(b=h.g[de],_=Ue(b,_,C,re),_>-1&&(Me(b[_]),Array.prototype.splice.call(b,_,1),b.length==0&&(delete h.g[de],h.h--)))):h&&(h=pt(h))&&(b=h.g[b.toString()],h=-1,b&&(h=Ue(b,_,C,re)),(_=h>-1?b[h]:null)&&Ee(_))}function Ee(h){if(typeof h!="number"&&h&&!h.da){var b=h.src;if(b&&b[bt])st(b.i,h);else{var _=h.type,C=h.proxy;b.removeEventListener?b.removeEventListener(_,C,h.capture):b.detachEvent?b.detachEvent(Z(_),C):b.addListener&&b.removeListener&&b.removeListener(C),(_=pt(b))?(st(_,h),_.h==0&&(_.src=null,b[gt]=null)):Me(h)}}}function Z(h){return h in Tt?Tt[h]:Tt[h]="on"+h}function mt(h,b){if(h.da)h=!0;else{b=new $e(b,this);const _=h.listener,C=h.ha||h.src;h.fa&&Ee(h),h=_.call(C,b)}return h}function pt(h){return h=h[gt],h instanceof Oe?h:null}var Je="__closure_events_fn_"+(Math.random()*1e9>>>0);function ut(h){return typeof h=="function"?h:(h[Je]||(h[Je]=function(b){return h.handleEvent(b)}),h[Je])}function tt(){L.call(this),this.i=new Oe(this),this.M=this,this.G=null}k(tt,L),tt.prototype[bt]=!0,tt.prototype.removeEventListener=function(h,b,_,C){At(this,h,b,_,C)};function Ze(h,b){var _,C=h.G;if(C)for(_=[];C;C=C.G)_.push(C);if(h=h.M,C=b.type||b,typeof b=="string")b=new D(b,h);else if(b instanceof D)b.target=b.target||h;else{var re=b;b=new D(C,h),Se(b,re)}re=!0;let de,Xe;if(_)for(Xe=_.length-1;Xe>=0;Xe--)de=b.g=_[Xe],re=Pt(de,C,!0,b)&&re;if(de=b.g=h,re=Pt(de,C,!0,b)&&re,re=Pt(de,C,!1,b)&&re,_)for(Xe=0;Xe<_.length;Xe++)de=b.g=_[Xe],re=Pt(de,C,!1,b)&&re}tt.prototype.N=function(){if(tt.Z.N.call(this),this.i){var h=this.i;for(const b in h.g){const _=h.g[b];for(let C=0;C<_.length;C++)Me(_[C]);delete h.g[b],h.h--}}this.G=null},tt.prototype.J=function(h,b,_,C){return this.i.add(String(h),b,!1,_,C)},tt.prototype.K=function(h,b,_,C){return this.i.add(String(h),b,!0,_,C)};function Pt(h,b,_,C){if(b=h.i.g[String(b)],!b)return!0;b=b.concat();let re=!0;for(let de=0;de<b.length;++de){const Xe=b[de];if(Xe&&!Xe.da&&Xe.capture==_){const Zt=Xe.listener,Tn=Xe.ha||Xe.src;Xe.fa&&st(h.i,Xe),re=Zt.call(Tn,C)!==!1&&re}}return re&&!C.defaultPrevented}function Ks(h,b){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=y(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(b)>2147483647?-1:d.setTimeout(h,b||0)}function Ct(h){h.g=Ks(()=>{h.g=null,h.i&&(h.i=!1,Ct(h))},h.l);const b=h.h;h.h=null,h.m.apply(null,b)}class as extends L{constructor(b,_){super(),this.m=b,this.l=_,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:Ct(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function on(h){L.call(this),this.h=h,this.g={}}k(on,L);var qt=[];function Cs(h){Ke(h.g,function(b,_){this.g.hasOwnProperty(_)&&Ee(b)},h),h.g={}}on.prototype.N=function(){on.Z.N.call(this),Cs(this)},on.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ns=d.JSON.stringify,_s=d.JSON.parse,he=class{stringify(h){return d.JSON.stringify(h,void 0)}parse(h){return d.JSON.parse(h,void 0)}};function Re(){}function ze(){}var Ye={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Ve(){D.call(this,"d")}k(Ve,D);function Le(){D.call(this,"c")}k(Le,D);var De={},wt=null;function ft(){return wt=wt||new tt}De.Ia="serverreachability";function Ut(h){D.call(this,De.Ia,h)}k(Ut,D);function Gt(h){const b=ft();Ze(b,new Ut(b))}De.STAT_EVENT="statevent";function Q(h,b){D.call(this,De.STAT_EVENT,h),this.stat=b}k(Q,D);function ve(h){const b=ft();Ze(b,new Q(b,h))}De.Ja="timingevent";function at(h,b){D.call(this,De.Ja,h),this.size=b}k(at,D);function It(h,b){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){h()},b)}function St(){this.g=!0}St.prototype.ua=function(){this.g=!1};function ts(h,b,_,C,re,de){h.info(function(){if(h.g)if(de){var Xe="",Zt=de.split("&");for(let Ps=0;Ps<Zt.length;Ps++){var Tn=Zt[Ps].split("=");if(Tn.length>1){const cn=Tn[0];Tn=Tn[1];const Xr=cn.split("_");Xe=Xr.length>=2&&Xr[1]=="type"?Xe+(cn+"="+Tn+"&"):Xe+(cn+"=redacted&")}}}else Xe=null;else Xe=de;return"XMLHTTP REQ ("+C+") [attempt "+re+"]: "+b+`
`+_+`
`+Xe})}function Xt(h,b,_,C,re,de,Xe){h.info(function(){return"XMLHTTP RESP ("+C+") [ attempt "+re+"]: "+b+`
`+_+`
`+de+" "+Xe})}function zt(h,b,_,C){h.info(function(){return"XMLHTTP TEXT ("+b+"): "+tn(h,_)+(C?" "+C:"")})}function Rs(h,b){h.info(function(){return"TIMEOUT: "+b})}St.prototype.info=function(){};function tn(h,b){if(!h.g)return b;if(!b)return null;try{const de=JSON.parse(b);if(de){for(h=0;h<de.length;h++)if(Array.isArray(de[h])){var _=de[h];if(!(_.length<2)){var C=_[1];if(Array.isArray(C)&&!(C.length<1)){var re=C[0];if(re!="noop"&&re!="stop"&&re!="close")for(let Xe=1;Xe<C.length;Xe++)C[Xe]=""}}}}return ns(de)}catch{return b}}var rs={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Ts={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},As;function z(){}k(z,Re),z.prototype.g=function(){return new XMLHttpRequest},As=new z;function ye(h){return encodeURIComponent(String(h))}function we(h){var b=1;h=h.split(":");const _=[];for(;b>0&&h.length;)_.push(h.shift()),b--;return h.length&&_.push(h.join(":")),_}function _e(h,b,_,C){this.j=h,this.i=b,this.l=_,this.S=C||1,this.V=new on(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new be}function be(){this.i=null,this.g="",this.h=!1}var it={},Rt={};function ct(h,b,_){h.M=1,h.A=Be(Js(b)),h.u=_,h.R=!0,_t(h,null)}function _t(h,b){h.F=Date.now(),hn(h),h.B=Js(h.A);var _=h.B,C=h.S;Array.isArray(C)||(C=[String(C)]),ln(_.i,"t",C),h.C=0,_=h.j.L,h.h=new be,h.g=Nr(h.j,_?b:null,!h.u),h.P>0&&(h.O=new as(y(h.Y,h,h.g),h.P)),b=h.V,_=h.g,C=h.ba;var re="readystatechange";Array.isArray(re)||(re&&(qt[0]=re.toString()),re=qt);for(let de=0;de<re.length;de++){const Xe=rt(_,re[de],C||b.handleEvent,!1,b.h||b);if(!Xe)break;b.g[Xe.key]=Xe}b=h.J?P(h.J):{},h.u?(h.v||(h.v="POST"),b["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,b)):(h.v="GET",h.g.ea(h.B,h.v,null,b)),Gt(),ts(h.i,h.v,h.B,h.l,h.S,h.u)}_e.prototype.ba=function(h){h=h.target;const b=this.O;b&&Pe(h)==3?b.j():this.Y(h)},_e.prototype.Y=function(h){try{if(h==this.g)e:{const Zt=Pe(this.g),Tn=this.g.ya(),Ps=this.g.ca();if(!(Zt<3)&&(Zt!=3||this.g&&(this.h.h||this.g.la()||Ge(this.g)))){this.K||Zt!=4||Tn==7||(Tn==8||Ps<=0?Gt(3):Gt(2)),Es(this);var b=this.g.ca();this.X=b;var _=kt(this);if(this.o=b==200,Xt(this.i,this.v,this.B,this.l,this.S,Zt,b),this.o){if(this.U&&!this.L){t:{if(this.g){var C,re=this.g;if((C=re.g?re.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(C)){var de=C;break t}}de=null}if(h=de)zt(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,E(this,h);else{this.o=!1,this.m=3,ve(12),ue(this),$(this);break e}}if(this.R){h=!0;let cn;for(;!this.K&&this.C<_.length;)if(cn=Cn(this,_),cn==Rt){Zt==4&&(this.m=4,ve(14),h=!1),zt(this.i,this.l,null,"[Incomplete Response]");break}else if(cn==it){this.m=4,ve(15),zt(this.i,this.l,_,"[Invalid Chunk]"),h=!1;break}else zt(this.i,this.l,cn,null),E(this,cn);if(us(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Zt!=4||_.length!=0||this.h.h||(this.m=1,ve(16),h=!1),this.o=this.o&&h,!h)zt(this.i,this.l,_,"[Invalid Chunked Response]"),ue(this),$(this);else if(_.length>0&&!this.W){this.W=!0;var Xe=this.j;Xe.g==this&&Xe.aa&&!Xe.P&&(Xe.j.info("Great, no buffering proxy detected. Bytes received: "+_.length),Rn(Xe),Xe.P=!0,ve(11))}}else zt(this.i,this.l,_,null),E(this,_);Zt==4&&ue(this),this.o&&!this.K&&(Zt==4?Tr(this.j,this):(this.o=!1,hn(this)))}else dt(this.g),b==400&&_.indexOf("Unknown SID")>0?(this.m=3,ve(12)):(this.m=0,ve(13)),ue(this),$(this)}}}catch{}};function kt(h){if(!us(h))return h.g.la();const b=Ge(h.g);if(b==="")return"";let _="";const C=b.length,re=Pe(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return ue(h),$(h),"";h.h.i=new d.TextDecoder}for(let de=0;de<C;de++)h.h.h=!0,_+=h.h.i.decode(b[de],{stream:!(re&&de==C-1)});return b.length=0,h.h.g+=_,h.C=0,h.h.g}function us(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function Cn(h,b){var _=h.C,C=b.indexOf(`
`,_);return C==-1?Rt:(_=Number(b.substring(_,C)),isNaN(_)?it:(C+=1,C+_>b.length?Rt:(b=b.slice(C,C+_),h.C=C+_,b)))}_e.prototype.cancel=function(){this.K=!0,ue(this)};function hn(h){h.T=Date.now()+h.H,fn(h,h.H)}function fn(h,b){if(h.D!=null)throw Error("WatchDog timer not null");h.D=It(y(h.aa,h),b)}function Es(h){h.D&&(d.clearTimeout(h.D),h.D=null)}_e.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(Rs(this.i,this.B),this.M!=2&&(Gt(),ve(17)),ue(this),this.m=2,$(this)):fn(this,this.T-h)};function $(h){h.j.I==0||h.K||Tr(h.j,h)}function ue(h){Es(h);var b=h.O;b&&typeof b.dispose=="function"&&b.dispose(),h.O=null,Cs(h.V),h.g&&(b=h.g,h.g=null,b.abort(),b.dispose())}function E(h,b){try{var _=h.j;if(_.I!=0&&(_.g==h||qe(_.h,h))){if(!h.L&&qe(_.h,h)&&_.I==3){try{var C=_.Ba.g.parse(b)}catch{C=null}if(Array.isArray(C)&&C.length==3){var re=C;if(re[0]==0){e:if(!_.v){if(_.g)if(_.g.F+3e3<h.F)Xn(_),Ft(_);else break e;nn(_),ve(18)}}else _.xa=re[1],0<_.xa-_.K&&re[2]<37500&&_.F&&_.A==0&&!_.C&&(_.C=It(y(_.Va,_),6e3));Qe(_.h)<=1&&_.ta&&(_.ta=void 0)}else bn(_,11)}else if((h.L||_.g==h)&&Xn(_),!M(b))for(re=_.Ba.g.parse(b),b=0;b<re.length;b++){let Ps=re[b];const cn=Ps[0];if(!(cn<=_.K))if(_.K=cn,Ps=Ps[1],_.I==2)if(Ps[0]=="c"){_.M=Ps[1],_.ba=Ps[2];const Xr=Ps[3];Xr!=null&&(_.ka=Xr,_.j.info("VER="+_.ka));const Ca=Ps[4];Ca!=null&&(_.za=Ca,_.j.info("SVER="+_.za));const ua=Ps[5];ua!=null&&typeof ua=="number"&&ua>0&&(C=1.5*ua,_.O=C,_.j.info("backChannelRequestTimeoutMs_="+C)),C=_;const da=h.g;if(da){const ko=da.g?da.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ko){var de=C.h;de.g||ko.indexOf("spdy")==-1&&ko.indexOf("quic")==-1&&ko.indexOf("h2")==-1||(de.j=de.l,de.g=new Set,de.h&&(Fe(de,de.h),de.h=null))}if(C.G){const il=da.g?da.g.getResponseHeader("X-HTTP-Session-Id"):null;il&&(C.wa=il,te(C.J,C.G,il))}}_.I=3,_.l&&_.l.ra(),_.aa&&(_.T=Date.now()-h.F,_.j.info("Handshake RTT: "+_.T+"ms")),C=_;var Xe=h;if(C.na=Er(C,C.L?C.ba:null,C.W),Xe.L){Lt(C.h,Xe);var Zt=Xe,Tn=C.O;Tn&&(Zt.H=Tn),Zt.D&&(Es(Zt),hn(Zt)),C.g=Xe}else Vs(C);_.i.length>0&&Jt(_)}else Ps[0]!="stop"&&Ps[0]!="close"||bn(_,7);else _.I==3&&(Ps[0]=="stop"||Ps[0]=="close"?Ps[0]=="stop"?bn(_,7):Ot(_):Ps[0]!="noop"&&_.l&&_.l.qa(Ps),_.A=0)}}Gt(4)}catch{}}var S=class{constructor(h,b){this.g=h,this.map=b}};function G(h){this.l=h||10,d.PerformanceNavigationTiming?(h=d.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function ae(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Qe(h){return h.h?1:h.g?h.g.size:0}function qe(h,b){return h.h?h.h==b:h.g?h.g.has(b):!1}function Fe(h,b){h.g?h.g.add(b):h.h=b}function Lt(h,b){h.h&&h.h==b?h.h=null:h.g&&h.g.has(b)&&h.g.delete(b)}G.prototype.cancel=function(){if(this.i=Mt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Mt(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let b=h.i;for(const _ of h.g.values())b=b.concat(_.G);return b}return O(h.i)}var Ys=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function jn(h,b){if(h){h=h.split("&");for(let _=0;_<h.length;_++){const C=h[_].indexOf("=");let re,de=null;C>=0?(re=h[_].substring(0,C),de=h[_].substring(C+1)):re=h[_],b(re,de?decodeURIComponent(de.replace(/\+/g," ")):"")}}}function gn(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let b;h instanceof gn?(this.l=h.l,Hs(this,h.j),this.o=h.o,this.g=h.g,Y(this,h.u),this.h=h.h,xe(this,fr(h.i)),this.m=h.m):h&&(b=String(h).match(Ys))?(this.l=!1,Hs(this,b[1]||"",!0),this.o=We(b[2]||""),this.g=We(b[3]||"",!0),Y(this,b[4]),this.h=We(b[5]||"",!0),xe(this,b[6]||"",!0),this.m=We(b[7]||"")):(this.l=!1,this.i=new Yr(null,this.l))}gn.prototype.toString=function(){const h=[];var b=this.j;b&&h.push(ot(b,Kt,!0),":");var _=this.g;return(_||b=="file")&&(h.push("//"),(b=this.o)&&h.push(ot(b,Kt,!0),"@"),h.push(ye(_).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.u,_!=null&&h.push(":",String(_))),(_=this.h)&&(this.g&&_.charAt(0)!="/"&&h.push("/"),h.push(ot(_,_.charAt(0)=="/"?yn:is,!0))),(_=this.i.toString())&&h.push("?",_),(_=this.m)&&h.push("#",ot(_,Fn)),h.join("")},gn.prototype.resolve=function(h){const b=Js(this);let _=!!h.j;_?Hs(b,h.j):_=!!h.o,_?b.o=h.o:_=!!h.g,_?b.g=h.g:_=h.u!=null;var C=h.h;if(_)Y(b,h.u);else if(_=!!h.h){if(C.charAt(0)!="/")if(this.g&&!this.h)C="/"+C;else{var re=b.h.lastIndexOf("/");re!=-1&&(C=b.h.slice(0,re+1)+C)}if(re=C,re==".."||re==".")C="";else if(re.indexOf("./")!=-1||re.indexOf("/.")!=-1){C=re.lastIndexOf("/",0)==0,re=re.split("/");const de=[];for(let Xe=0;Xe<re.length;){const Zt=re[Xe++];Zt=="."?C&&Xe==re.length&&de.push(""):Zt==".."?((de.length>1||de.length==1&&de[0]!="")&&de.pop(),C&&Xe==re.length&&de.push("")):(de.push(Zt),C=!0)}C=de.join("/")}else C=re}return _?b.h=C:_=h.i.toString()!=="",_?xe(b,fr(h.i)):_=!!h.m,_&&(b.m=h.m),b};function Js(h){return new gn(h)}function Hs(h,b,_){h.j=_?We(b,!0):b,h.j&&(h.j=h.j.replace(/:$/,""))}function Y(h,b){if(b){if(b=Number(b),isNaN(b)||b<0)throw Error("Bad port number "+b);h.u=b}else h.u=null}function xe(h,b,_){b instanceof Yr?(h.i=b,Kn(h.i,h.l)):(_||(b=ot(b,ms)),h.i=new Yr(b,h.l))}function te(h,b,_){h.i.set(b,_)}function Be(h){return te(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function We(h,b){return h?b?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function ot(h,b,_){return typeof h=="string"?(h=encodeURI(h).replace(b,xt),_&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function xt(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Kt=/[#\/\?@]/g,is=/[#\?:]/g,yn=/[#\?]/g,ms=/[#\?@]/g,Fn=/#/g;function Yr(h,b){this.h=this.g=null,this.i=h||null,this.j=!!b}function Vn(h){h.g||(h.g=new Map,h.h=0,h.i&&jn(h.i,function(b,_){h.add(decodeURIComponent(b.replace(/\+/g," ")),_)}))}n=Yr.prototype,n.add=function(h,b){Vn(this),this.i=null,h=Gn(this,h);let _=this.g.get(h);return _||this.g.set(h,_=[]),_.push(b),this.h+=1,this};function hr(h,b){Vn(h),b=Gn(h,b),h.g.has(b)&&(h.i=null,h.h-=h.g.get(b).length,h.g.delete(b))}function Ta(h,b){return Vn(h),b=Gn(h,b),h.g.has(b)}n.forEach=function(h,b){Vn(this),this.g.forEach(function(_,C){_.forEach(function(re){h.call(b,re,C,this)},this)},this)};function os(h,b){Vn(h);let _=[];if(typeof b=="string")Ta(h,b)&&(_=_.concat(h.g.get(Gn(h,b))));else for(h=Array.from(h.g.values()),b=0;b<h.length;b++)_=_.concat(h[b]);return _}n.set=function(h,b){return Vn(this),this.i=null,h=Gn(this,h),Ta(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[b]),this.h+=1,this},n.get=function(h,b){return h?(h=os(this,h),h.length>0?String(h[0]):b):b};function ln(h,b,_){hr(h,b),_.length>0&&(h.i=null,h.g.set(Gn(h,b),O(_)),h.h+=_.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],b=Array.from(this.g.keys());for(let C=0;C<b.length;C++){var _=b[C];const re=ye(_);_=os(this,_);for(let de=0;de<_.length;de++){let Xe=re;_[de]!==""&&(Xe+="="+ye(_[de])),h.push(Xe)}}return this.i=h.join("&")};function fr(h){const b=new Yr;return b.i=h.i,h.g&&(b.g=new Map(h.g),b.h=h.h),b}function Gn(h,b){return b=String(b),h.j&&(b=b.toLowerCase()),b}function Kn(h,b){b&&!h.j&&(Vn(h),h.i=null,h.g.forEach(function(_,C){const re=C.toLowerCase();C!=re&&(hr(this,C),ln(this,re,_))},h)),h.j=b}function Zs(h,b){const _=new St;if(d.Image){const C=new Image;C.onload=w(mn,_,"TestLoadImage: loaded",!0,b,C),C.onerror=w(mn,_,"TestLoadImage: error",!1,b,C),C.onabort=w(mn,_,"TestLoadImage: abort",!1,b,C),C.ontimeout=w(mn,_,"TestLoadImage: timeout",!1,b,C),d.setTimeout(function(){C.ontimeout&&C.ontimeout()},1e4),C.src=h}else b(!1)}function sn(h,b){const _=new St,C=new AbortController,re=setTimeout(()=>{C.abort(),mn(_,"TestPingServer: timeout",!1,b)},1e4);fetch(h,{signal:C.signal}).then(de=>{clearTimeout(re),de.ok?mn(_,"TestPingServer: ok",!0,b):mn(_,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(re),mn(_,"TestPingServer: error",!1,b)})}function mn(h,b,_,C,re){try{re&&(re.onload=null,re.onerror=null,re.onabort=null,re.ontimeout=null),C(_)}catch{}}function Lr(){this.g=new he}function mr(h){this.i=h.Sb||null,this.h=h.ab||!1}k(mr,Re),mr.prototype.g=function(){return new Or(this.i,this.h)};function Or(h,b){tt.call(this),this.H=h,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}k(Or,tt),n=Or.prototype,n.open=function(h,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=b,this.readyState=1,pr(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const b={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(b.body=h),(this.H||d).fetch(new Request(this.D,b)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ea(this)),this.readyState=0},n.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,pr(this)),this.g&&(this.readyState=3,pr(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;ji(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function ji(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}n.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var b=h.value?h.value:new Uint8Array(0);(b=this.B.decode(b,{stream:!h.done}))&&(this.response=this.responseText+=b)}h.done?Ea(this):pr(this),this.readyState==3&&ji(this)}},n.Oa=function(h){this.g&&(this.response=this.responseText=h,Ea(this))},n.Na=function(h){this.g&&(this.response=h,Ea(this))},n.ga=function(){this.g&&Ea(this)};function Ea(h){h.readyState=4,h.l=null,h.j=null,h.B=null,pr(h)}n.setRequestHeader=function(h,b){this.A.append(h,b)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],b=this.h.entries();for(var _=b.next();!_.done;)_=_.value,h.push(_[0]+": "+_[1]),_=b.next();return h.join(`\r
`)};function pr(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Or.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function jr(h){let b="";return Ke(h,function(_,C){b+=C,b+=":",b+=_,b+=`\r
`}),b}function Na(h,b,_){e:{for(C in _){var C=!1;break e}C=!0}C||(_=jr(_),typeof h=="string"?_!=null&&ye(_):te(h,b,_))}function Os(h){tt.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}k(Os,tt);var Qr=/^https?$/i,xo=["POST","PUT"];n=Os.prototype,n.Fa=function(h){this.H=h},n.ea=function(h,b,_,C){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);b=b?b.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():As.g(),this.g.onreadystatechange=j(y(this.Ca,this));try{this.B=!0,this.g.open(b,String(h),!0),this.B=!1}catch(de){Ga(this,de);return}if(h=_||"",_=new Map(this.headers),C)if(Object.getPrototypeOf(C)===Object.prototype)for(var re in C)_.set(re,C[re]);else if(typeof C.keys=="function"&&typeof C.get=="function")for(const de of C.keys())_.set(de,C.get(de));else throw Error("Unknown input type for opt_headers: "+String(C));C=Array.from(_.keys()).find(de=>de.toLowerCase()=="content-type"),re=d.FormData&&h instanceof d.FormData,!(Array.prototype.indexOf.call(xo,b,void 0)>=0)||C||re||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[de,Xe]of _)this.g.setRequestHeader(de,Xe);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(de){Ga(this,de)}};function Ga(h,b){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=b,h.o=5,wo(h),X(h)}function wo(h){h.A||(h.A=!0,Ze(h,"complete"),Ze(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,Ze(this,"complete"),Ze(this,"abort"),X(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),X(this,!0)),Os.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?I(this):this.Xa())},n.Xa=function(){I(this)};function I(h){if(h.h&&typeof u<"u"){if(h.v&&Pe(h)==4)setTimeout(h.Ca.bind(h),0);else if(Ze(h,"readystatechange"),Pe(h)==4){h.h=!1;try{const de=h.ca();e:switch(de){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var _;if(!(_=b)){var C;if(C=de===0){let Xe=String(h.D).match(Ys)[1]||null;!Xe&&d.self&&d.self.location&&(Xe=d.self.location.protocol.slice(0,-1)),C=!Qr.test(Xe?Xe.toLowerCase():"")}_=C}if(_)Ze(h,"complete"),Ze(h,"success");else{h.o=6;try{var re=Pe(h)>2?h.g.statusText:""}catch{re=""}h.l=re+" ["+h.ca()+"]",wo(h)}}finally{X(h)}}}}function X(h,b){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const _=h.g;h.g=null,b||Ze(h,"ready");try{_.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Pe(h){return h.g?h.g.readyState:0}n.ca=function(){try{return Pe(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(h){if(this.g){var b=this.g.responseText;return h&&b.indexOf(h)==0&&(b=b.substring(h.length)),_s(b)}};function Ge(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function dt(h){const b={};h=(h.g&&Pe(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let C=0;C<h.length;C++){if(M(h[C]))continue;var _=we(h[C]);const re=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const de=b[re]||[];b[re]=de,de.push(_)}ee(b,function(C){return C.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function jt(h,b,_){return _&&_.internalChannelParams&&_.internalChannelParams[h]||b}function et(h){this.za=0,this.i=[],this.j=new St,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=jt("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=jt("baseRetryDelayMs",5e3,h),this.Za=jt("retryDelaySeedMs",1e4,h),this.Ta=jt("forwardChannelMaxRetries",2,h),this.va=jt("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new G(h&&h.concurrentRequestLimit),this.Ba=new Lr,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=et.prototype,n.ka=8,n.I=1,n.connect=function(h,b,_,C){ve(0),this.W=h,this.H=b||{},_&&C!==void 0&&(this.H.OSID=_,this.H.OAID=C),this.F=this.X,this.J=Er(this,null,this.W),Jt(this)};function Ot(h){if(ds(h),h.I==3){var b=h.V++,_=Js(h.J);if(te(_,"SID",h.M),te(_,"RID",b),te(_,"TYPE","terminate"),Hn(h,_),b=new _e(h,h.j,b),b.M=2,b.A=Be(Js(_)),_=!1,d.navigator&&d.navigator.sendBeacon)try{_=d.navigator.sendBeacon(b.A.toString(),"")}catch{}!_&&d.Image&&(new Image().src=b.A,_=!0),_||(b.g=Nr(b.j,null),b.g.ea(b.A)),b.F=Date.now(),hn(b)}Bn(h)}function Ft(h){h.g&&(Rn(h),h.g.cancel(),h.g=null)}function ds(h){Ft(h),h.v&&(d.clearTimeout(h.v),h.v=null),Xn(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&d.clearTimeout(h.m),h.m=null)}function Jt(h){if(!ae(h.h)&&!h.m){h.m=!0;var b=h.Ea;Ie||T(),Te||(Ie(),Te=!0),R.add(b,h),h.D=0}}function ls(h,b){return Qe(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=b.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=It(y(h.Ea,h,b),gr(h,h.D)),h.D++,!0)}n.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const re=new _e(this,this.j,h);let de=this.o;if(this.U&&(de?(de=P(de),Se(de,this.U)):de=this.U),this.u!==null||this.R||(re.J=de,de=null),this.S)e:{for(var b=0,_=0;_<this.i.length;_++){t:{var C=this.i[_];if("__data__"in C.map&&(C=C.map.__data__,typeof C=="string")){C=C.length;break t}C=void 0}if(C===void 0)break;if(b+=C,b>4096){b=_;break e}if(b===4096||_===this.i.length-1){b=_+1;break e}}b=1e3}else b=1e3;b=Us(this,re,b),_=Js(this.J),te(_,"RID",h),te(_,"CVER",22),this.G&&te(_,"X-HTTP-Session-Id",this.G),Hn(this,_),de&&(this.R?b="headers="+ye(jr(de))+"&"+b:this.u&&Na(_,this.u,de)),Fe(this.h,re),this.Ra&&te(_,"TYPE","init"),this.S?(te(_,"$req",b),te(_,"SID","null"),re.U=!0,ct(re,_,null)):ct(re,_,b),this.I=2}}else this.I==3&&(h?Yn(this,h):this.i.length==0||ae(this.h)||Yn(this))};function Yn(h,b){var _;b?_=b.l:_=h.V++;const C=Js(h.J);te(C,"SID",h.M),te(C,"RID",_),te(C,"AID",h.K),Hn(h,C),h.u&&h.o&&Na(C,h.u,h.o),_=new _e(h,h.j,_,h.D+1),h.u===null&&(_.J=h.o),b&&(h.i=b.G.concat(h.i)),b=Us(h,_,1e3),_.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),Fe(h.h,_),ct(_,C,b)}function Hn(h,b){h.H&&Ke(h.H,function(_,C){te(b,C,_)}),h.l&&Ke({},function(_,C){te(b,C,_)})}function Us(h,b,_){_=Math.min(h.i.length,_);const C=h.l?y(h.l.Ka,h.l,h):null;e:{var re=h.i;let Zt=-1;for(;;){const Tn=["count="+_];Zt==-1?_>0?(Zt=re[0].g,Tn.push("ofs="+Zt)):Zt=0:Tn.push("ofs="+Zt);let Ps=!0;for(let cn=0;cn<_;cn++){var de=re[cn].g;const Xr=re[cn].map;if(de-=Zt,de<0)Zt=Math.max(0,re[cn].g-100),Ps=!1;else try{de="req"+de+"_"||"";try{var Xe=Xr instanceof Map?Xr:Object.entries(Xr);for(const[Ca,ua]of Xe){let da=ua;p(ua)&&(da=ns(ua)),Tn.push(de+Ca+"="+encodeURIComponent(da))}}catch(Ca){throw Tn.push(de+"type="+encodeURIComponent("_badmap")),Ca}}catch{C&&C(Xr)}}if(Ps){Xe=Tn.join("&");break e}}Xe=void 0}return h=h.i.splice(0,_),b.G=h,Xe}function Vs(h){if(!h.g&&!h.v){h.Y=1;var b=h.Da;Ie||T(),Te||(Ie(),Te=!0),R.add(b,h),h.A=0}}function nn(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=It(y(h.Da,h),gr(h,h.A)),h.A++,!0)}n.Da=function(){if(this.v=null,Qn(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=It(y(this.Wa,this),h)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ve(10),Ft(this),Qn(this))};function Rn(h){h.B!=null&&(d.clearTimeout(h.B),h.B=null)}function Qn(h){h.g=new _e(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var b=Js(h.na);te(b,"RID","rpc"),te(b,"SID",h.M),te(b,"AID",h.K),te(b,"CI",h.F?"0":"1"),!h.F&&h.ia&&te(b,"TO",h.ia),te(b,"TYPE","xmlhttp"),Hn(h,b),h.u&&h.o&&Na(b,h.u,h.o),h.O&&(h.g.H=h.O);var _=h.g;h=h.ba,_.M=1,_.A=Be(Js(b)),_.u=null,_.R=!0,_t(_,h)}n.Va=function(){this.C!=null&&(this.C=null,Ft(this),nn(this),ve(19))};function Xn(h){h.C!=null&&(d.clearTimeout(h.C),h.C=null)}function Tr(h,b){var _=null;if(h.g==b){Xn(h),Rn(h),h.g=null;var C=2}else if(qe(h.h,b))_=b.G,Lt(h.h,b),C=1;else return;if(h.I!=0){if(b.o)if(C==1){_=b.u?b.u.length:0,b=Date.now()-b.F;var re=h.D;C=ft(),Ze(C,new at(C,_)),Jt(h)}else Vs(h);else if(re=b.m,re==3||re==0&&b.X>0||!(C==1&&ls(h,b)||C==2&&nn(h)))switch(_&&_.length>0&&(b=h.h,b.i=b.i.concat(_)),re){case 1:bn(h,5);break;case 4:bn(h,10);break;case 3:bn(h,6);break;default:bn(h,2)}}}function gr(h,b){let _=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(_*=2),_*b}function bn(h,b){if(h.j.info("Error code "+b),b==2){var _=y(h.bb,h),C=h.Ua;const re=!C;C=new gn(C||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||Hs(C,"https"),Be(C),re?Zs(C.toString(),_):sn(C.toString(),_)}else ve(2);h.I=0,h.l&&h.l.pa(b),Bn(h),ds(h)}n.bb=function(h){h?(this.j.info("Successfully pinged google.com"),ve(2)):(this.j.info("Failed to ping google.com"),ve(1))};function Bn(h){if(h.I=0,h.ja=[],h.l){const b=Mt(h.h);(b.length!=0||h.i.length!=0)&&(q(h.ja,b),q(h.ja,h.i),h.h.i.length=0,O(h.i),h.i.length=0),h.l.oa()}}function Er(h,b,_){var C=_ instanceof gn?Js(_):new gn(_);if(C.g!="")b&&(C.g=b+"."+C.g),Y(C,C.u);else{var re=d.location;C=re.protocol,b=b?b+"."+re.hostname:re.hostname,re=+re.port;const de=new gn(null);C&&Hs(de,C),b&&(de.g=b),re&&Y(de,re),_&&(de.h=_),C=de}return _=h.G,b=h.wa,_&&b&&te(C,_,b),te(C,"VER",h.ka),Hn(h,C),C}function Nr(h,b,_){if(b&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return b=h.Aa&&!h.ma?new Os(new mr({ab:_})):new Os(h.ma),b.Fa(h.L),b}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function _o(){}n=_o.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Sa(){}Sa.prototype.g=function(h,b){return new Jn(h,b)};function Jn(h,b){tt.call(this),this.g=new et(b),this.l=h,this.h=b&&b.messageUrlParams||null,h=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(h?h["X-WebChannel-Content-Type"]=b.messageContentType:h={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.sa&&(h?h["X-WebChannel-Client-Profile"]=b.sa:h={"X-WebChannel-Client-Profile":b.sa}),this.g.U=h,(h=b&&b.Qb)&&!M(h)&&(this.g.u=h),this.A=b&&b.supportsCrossDomainXhr||!1,this.v=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!M(b)&&(this.g.G=b,h=this.h,h!==null&&b in h&&(h=this.h,b in h&&delete h[b])),this.j=new ir(this)}k(Jn,tt),Jn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Jn.prototype.close=function(){Ot(this.g)},Jn.prototype.o=function(h){var b=this.g;if(typeof h=="string"){var _={};_.__data__=h,h=_}else this.v&&(_={},_.__data__=ns(h),h=_);b.i.push(new S(b.Ya++,h)),b.I==3&&Jt(b)},Jn.prototype.N=function(){this.g.l=null,delete this.j,Ot(this.g),delete this.g,Jn.Z.N.call(this)};function Ka(h){Ve.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var b=h.__sm__;if(b){e:{for(const _ in b){h=_;break e}h=void 0}(this.i=h)&&(h=this.i,b=b!==null&&h in b?b[h]:void 0),this.data=b}else this.data=h}k(Ka,Ve);function ca(){Le.call(this),this.status=1}k(ca,Le);function ir(h){this.g=h}k(ir,_o),ir.prototype.ra=function(){Ze(this.g,"a")},ir.prototype.qa=function(h){Ze(this.g,new Ka(h))},ir.prototype.pa=function(h){Ze(this.g,new ca)},ir.prototype.oa=function(){Ze(this.g,"b")},Sa.prototype.createWebChannel=Sa.prototype.g,Jn.prototype.send=Jn.prototype.o,Jn.prototype.open=Jn.prototype.m,Jn.prototype.close=Jn.prototype.close,Fw=function(){return new Sa},zw=function(){return ft()},Uw=De,hg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},rs.NO_ERROR=0,rs.TIMEOUT=8,rs.HTTP_ERROR=6,bh=rs,Ts.COMPLETE="complete",Bw=Ts,ze.EventType=Ye,Ye.OPEN="a",Ye.CLOSE="b",Ye.ERROR="c",Ye.MESSAGE="d",tt.prototype.listen=tt.prototype.J,nu=ze,Os.prototype.listenOnce=Os.prototype.K,Os.prototype.getLastError=Os.prototype.Ha,Os.prototype.getLastErrorCode=Os.prototype.ya,Os.prototype.getStatus=Os.prototype.ca,Os.prototype.getResponseJson=Os.prototype.La,Os.prototype.getResponseText=Os.prototype.la,Os.prototype.send=Os.prototype.ea,Os.prototype.setWithCredentials=Os.prototype.Fa,Vw=Os}).apply(typeof eh<"u"?eh:typeof self<"u"?self:typeof window<"u"?window:{});class cr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}cr.UNAUTHENTICATED=new cr(null),cr.GOOGLE_CREDENTIALS=new cr("google-credentials-uid"),cr.FIRST_PARTY=new cr("first-party-uid"),cr.MOCK_USER=new cr("mock-user");let ic="12.8.0";function Z4(n){ic=n}const Zo=new Ug("@firebase/firestore");function Ul(){return Zo.logLevel}function lt(n,...e){if(Zo.logLevel<=ys.DEBUG){const t=e.map(Zg);Zo.debug(`Firestore (${ic}): ${n}`,...t)}}function vi(n,...e){if(Zo.logLevel<=ys.ERROR){const t=e.map(Zg);Zo.error(`Firestore (${ic}): ${n}`,...t)}}function Ql(n,...e){if(Zo.logLevel<=ys.WARN){const t=e.map(Zg);Zo.warn(`Firestore (${ic}): ${n}`,...t)}}function Zg(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Bt(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,Hw(n,i,t)}function Hw(n,e,t){let i=`FIRESTORE (${ic}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw vi(i),new Error(i)}function Bs(n,e,t,i){let l="Unexpected state";typeof t=="string"?l=t:i=t,n||Hw(e,l,i)}function Qt(n,e){return n}const je={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class nt extends Wa{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class mi{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class qw{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class eR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(cr.UNAUTHENTICATED)))}shutdown(){}}class tR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class sR{constructor(e){this.t=e,this.currentUser=cr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Bs(this.o===void 0,42304);let i=this.i;const l=g=>this.i!==i?(i=this.i,t(g)):Promise.resolve();let u=new mi;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new mi,e.enqueueRetryable((()=>l(this.currentUser)))};const d=()=>{const g=u;e.enqueueRetryable((async()=>{await g.promise,await l(this.currentUser)}))},p=g=>{lt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((g=>p(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?p(g):(lt("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new mi)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(lt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Bs(typeof i.accessToken=="string",31837,{l:i}),new qw(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Bs(e===null||typeof e=="string",2055,{h:e}),new cr(e)}}class nR{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=cr.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class rR{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new nR(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(cr.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class dx{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class aR{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,$r(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Bs(this.o===void 0,3512);const i=u=>{u.error!=null&&lt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const d=u.token!==this.m;return this.m=u.token,lt("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable((()=>i(u)))};const l=u=>{lt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>l(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?l(u):lt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new dx(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Bs(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new dx(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function iR(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class ey{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const l=iR(40);for(let u=0;u<l.length;++u)i.length<20&&l[u]<t&&(i+=e.charAt(l[u]%62))}return i}}function bs(n,e){return n<e?-1:n>e?1:0}function fg(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const l=n.charAt(i),u=e.charAt(i);if(l!==u)return Rp(l)===Rp(u)?bs(l,u):Rp(l)?1:-1}return bs(n.length,e.length)}const oR=55296,lR=57343;function Rp(n){const e=n.charCodeAt(0);return e>=oR&&e<=lR}function Xl(n,e,t){return n.length===e.length&&n.every(((i,l)=>t(i,e[l])))}const hx="__name__";class Pa{constructor(e,t,i){t===void 0?t=0:t>e.length&&Bt(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Bt(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Pa.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Pa?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let l=0;l<i;l++){const u=Pa.compareSegments(e.get(l),t.get(l));if(u!==0)return u}return bs(e.length,t.length)}static compareSegments(e,t){const i=Pa.isNumericId(e),l=Pa.isNumericId(t);return i&&!l?-1:!i&&l?1:i&&l?Pa.extractNumericId(e).compare(Pa.extractNumericId(t)):fg(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return io.fromString(e.substring(4,e.length-2))}}class en extends Pa{construct(e,t,i){return new en(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new nt(je.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((l=>l.length>0)))}return new en(t)}static emptyPath(){return new en([])}}const cR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class rr extends Pa{construct(e,t,i){return new rr(e,t,i)}static isValidIdentifier(e){return cR.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),rr.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===hx}static keyField(){return new rr([hx])}static fromServerFormat(e){const t=[];let i="",l=0;const u=()=>{if(i.length===0)throw new nt(je.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let d=!1;for(;l<e.length;){const p=e[l];if(p==="\\"){if(l+1===e.length)throw new nt(je.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[l+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new nt(je.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=g,l+=2}else p==="`"?(d=!d,l++):p!=="."||d?(i+=p,l++):(u(),l++)}if(u(),d)throw new nt(je.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new rr(t)}static emptyPath(){return new rr([])}}class Nt{constructor(e){this.path=e}static fromPath(e){return new Nt(en.fromString(e))}static fromName(e){return new Nt(en.fromString(e).popFirst(5))}static empty(){return new Nt(en.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&en.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return en.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Nt(new en(e.slice()))}}function $w(n,e,t){if(!t)throw new nt(je.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function uR(n,e,t,i){if(e===!0&&i===!0)throw new nt(je.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function fx(n){if(!Nt.isDocumentKey(n))throw new nt(je.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function mx(n){if(Nt.isDocumentKey(n))throw new nt(je.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Ww(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function ef(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Bt(12329,{type:typeof n})}function wr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new nt(je.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=ef(n);throw new nt(je.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function dR(n,e){if(e<=0)throw new nt(je.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function On(n,e){const t={typeString:n};return e&&(t.value=e),t}function Ou(n,e){if(!Ww(n))throw new nt(je.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const l=e[i].typeString,u="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const d=n[i];if(l&&typeof d!==l){t=`JSON field '${i}' must be a ${l}.`;break}if(u!==void 0&&d!==u.value){t=`Expected '${i}' field to equal '${u.value}'`;break}}if(t)throw new nt(je.INVALID_ARGUMENT,t);return!0}const px=-62135596800,gx=1e6;class vt{static now(){return vt.fromMillis(Date.now())}static fromDate(e){return vt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*gx);return new vt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new nt(je.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new nt(je.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<px)throw new nt(je.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new nt(je.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/gx}_compareTo(e){return this.seconds===e.seconds?bs(this.nanoseconds,e.nanoseconds):bs(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:vt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ou(e,vt._jsonSchema))return new vt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-px;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}vt._jsonSchemaVersion="firestore/timestamp/1.0",vt._jsonSchema={type:On("string",vt._jsonSchemaVersion),seconds:On("number"),nanoseconds:On("number")};class $t{static fromTimestamp(e){return new $t(e)}static min(){return new $t(new vt(0,0))}static max(){return new $t(new vt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const xu=-1;function hR(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,l=$t.fromTimestamp(i===1e9?new vt(t+1,0):new vt(t,i));return new co(l,Nt.empty(),e)}function fR(n){return new co(n.readTime,n.key,xu)}class co{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new co($t.min(),Nt.empty(),xu)}static max(){return new co($t.max(),Nt.empty(),xu)}}function mR(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Nt.comparator(n.documentKey,e.documentKey),t!==0?t:bs(n.largestBatchId,e.largestBatchId))}const pR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class gR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function oc(n){if(n.code!==je.FAILED_PRECONDITION||n.message!==pR)throw n;lt("LocalStore","Unexpectedly lost primary lease")}class Ae{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Bt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Ae(((i,l)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(i,l)},this.catchCallback=u=>{this.wrapFailure(t,u).next(i,l)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Ae?t:Ae.resolve(t)}catch(t){return Ae.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Ae.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Ae.reject(t)}static resolve(e){return new Ae(((t,i)=>{t(e)}))}static reject(e){return new Ae(((t,i)=>{i(e)}))}static waitFor(e){return new Ae(((t,i)=>{let l=0,u=0,d=!1;e.forEach((p=>{++l,p.next((()=>{++u,d&&u===l&&t()}),(g=>i(g)))})),d=!0,u===l&&t()}))}static or(e){let t=Ae.resolve(!1);for(const i of e)t=t.next((l=>l?Ae.resolve(l):i()));return t}static forEach(e,t){const i=[];return e.forEach(((l,u)=>{i.push(t.call(this,l,u))})),this.waitFor(i)}static mapArray(e,t){return new Ae(((i,l)=>{const u=e.length,d=new Array(u);let p=0;for(let g=0;g<u;g++){const y=g;t(e[y]).next((w=>{d[y]=w,++p,p===u&&i(d)}),(w=>l(w)))}}))}static doWhile(e,t){return new Ae(((i,l)=>{const u=()=>{e()===!0?t().next((()=>{u()}),l):i()};u()}))}}function yR(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function lc(n){return n.name==="IndexedDbTransactionError"}class tf{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}tf.ce=-1;const ty=-1;function sf(n){return n==null}function Dh(n){return n===0&&1/n==-1/0}function bR(n){return typeof n=="number"&&Number.isInteger(n)&&!Dh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const Gw="";function vR(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=yx(e)),e=xR(n.get(t),e);return yx(e)}function xR(n,e){let t=e;const i=n.length;for(let l=0;l<i;l++){const u=n.charAt(l);switch(u){case"\0":t+="";break;case Gw:t+="";break;default:t+=u}}return t}function yx(n){return n+Gw+""}function bx(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function bo(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Kw(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class pn{constructor(e,t){this.comparator=e,this.root=t||nr.EMPTY}insert(e,t){return new pn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,nr.BLACK,null,null))}remove(e){return new pn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,nr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const l=this.comparator(e,i.key);if(l===0)return t+i.left.size;l<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new th(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new th(this.root,e,this.comparator,!1)}getReverseIterator(){return new th(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new th(this.root,e,this.comparator,!0)}}class th{constructor(e,t,i,l){this.isReverse=l,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=t?i(e.key,t):1,t&&l&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class nr{constructor(e,t,i,l,u){this.key=e,this.value=t,this.color=i??nr.RED,this.left=l??nr.EMPTY,this.right=u??nr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,l,u){return new nr(e??this.key,t??this.value,i??this.color,l??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let l=this;const u=i(e,l.key);return l=u<0?l.copy(null,null,null,l.left.insert(e,t,i),null):u===0?l.copy(null,t,null,null,null):l.copy(null,null,null,null,l.right.insert(e,t,i)),l.fixUp()}removeMin(){if(this.left.isEmpty())return nr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,l=this;if(t(e,l.key)<0)l.left.isEmpty()||l.left.isRed()||l.left.left.isRed()||(l=l.moveRedLeft()),l=l.copy(null,null,null,l.left.remove(e,t),null);else{if(l.left.isRed()&&(l=l.rotateRight()),l.right.isEmpty()||l.right.isRed()||l.right.left.isRed()||(l=l.moveRedRight()),t(e,l.key)===0){if(l.right.isEmpty())return nr.EMPTY;i=l.right.min(),l=l.copy(i.key,i.value,null,null,l.right.removeMin())}l=l.copy(null,null,null,null,l.right.remove(e,t))}return l.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,nr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,nr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Bt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Bt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Bt(27949);return e+(this.isRed()?0:1)}}nr.EMPTY=null,nr.RED=!0,nr.BLACK=!1;nr.EMPTY=new class{constructor(){this.size=0}get key(){throw Bt(57766)}get value(){throw Bt(16141)}get color(){throw Bt(16727)}get left(){throw Bt(29726)}get right(){throw Bt(36894)}copy(e,t,i,l,u){return this}insert(e,t,i){return new nr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class zn{constructor(e){this.comparator=e,this.data=new pn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const l=i.getNext();if(this.comparator(l.key,e[1])>=0)return;t(l.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new vx(this.data.getIterator())}getIteratorFrom(e){return new vx(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof zn)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(this.comparator(l,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new zn(this.comparator);return t.data=e,t}}class vx{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Gr{constructor(e){this.fields=e,e.sort(rr.comparator)}static empty(){return new Gr([])}unionWith(e){let t=new zn(rr.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Gr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Xl(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class Yw extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ar{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(l){try{return atob(l)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new Yw("Invalid base64 string: "+u):u}})(e);return new ar(t)}static fromUint8Array(e){const t=(function(l){let u="";for(let d=0;d<l.length;++d)u+=String.fromCharCode(l[d]);return u})(e);return new ar(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return bs(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ar.EMPTY_BYTE_STRING=new ar("");const wR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function uo(n){if(Bs(!!n,39018),typeof n=="string"){let e=0;const t=wR.exec(n);if(Bs(!!t,46558,{timestamp:n}),t[1]){let l=t[1];l=(l+"000000000").substr(0,9),e=Number(l)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Sn(n.seconds),nanos:Sn(n.nanos)}}function Sn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ho(n){return typeof n=="string"?ar.fromBase64String(n):ar.fromUint8Array(n)}const Qw="server_timestamp",Xw="__type__",Jw="__previous_value__",Zw="__local_write_time__";function sy(n){return(n?.mapValue?.fields||{})[Xw]?.stringValue===Qw}function nf(n){const e=n.mapValue.fields[Jw];return sy(e)?nf(e):e}function wu(n){const e=uo(n.mapValue.fields[Zw].timestampValue);return new vt(e.seconds,e.nanos)}class _R{constructor(e,t,i,l,u,d,p,g,y,w,k){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=l,this.ssl=u,this.forceLongPolling=d,this.autoDetectLongPolling=p,this.longPollingOptions=g,this.useFetchStreams=y,this.isUsingEmulator=w,this.apiKey=k}}const Ph="(default)";class _u{constructor(e,t){this.projectId=e,this.database=t||Ph}static empty(){return new _u("","")}get isDefaultDatabase(){return this.database===Ph}isEqual(e){return e instanceof _u&&e.projectId===this.projectId&&e.database===this.database}}function kR(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new nt(je.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new _u(n.options.projectId,e)}const e_="__type__",jR="__max__",sh={mapValue:{}},t_="__vector__",Lh="value";function fo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?sy(n)?4:ER(n)?9007199254740991:TR(n)?10:11:Bt(28295,{value:n})}function qa(n,e){if(n===e)return!0;const t=fo(n);if(t!==fo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return wu(n).isEqual(wu(e));case 3:return(function(l,u){if(typeof l.timestampValue=="string"&&typeof u.timestampValue=="string"&&l.timestampValue.length===u.timestampValue.length)return l.timestampValue===u.timestampValue;const d=uo(l.timestampValue),p=uo(u.timestampValue);return d.seconds===p.seconds&&d.nanos===p.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(l,u){return ho(l.bytesValue).isEqual(ho(u.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(l,u){return Sn(l.geoPointValue.latitude)===Sn(u.geoPointValue.latitude)&&Sn(l.geoPointValue.longitude)===Sn(u.geoPointValue.longitude)})(n,e);case 2:return(function(l,u){if("integerValue"in l&&"integerValue"in u)return Sn(l.integerValue)===Sn(u.integerValue);if("doubleValue"in l&&"doubleValue"in u){const d=Sn(l.doubleValue),p=Sn(u.doubleValue);return d===p?Dh(d)===Dh(p):isNaN(d)&&isNaN(p)}return!1})(n,e);case 9:return Xl(n.arrayValue.values||[],e.arrayValue.values||[],qa);case 10:case 11:return(function(l,u){const d=l.mapValue.fields||{},p=u.mapValue.fields||{};if(bx(d)!==bx(p))return!1;for(const g in d)if(d.hasOwnProperty(g)&&(p[g]===void 0||!qa(d[g],p[g])))return!1;return!0})(n,e);default:return Bt(52216,{left:n})}}function ku(n,e){return(n.values||[]).find((t=>qa(t,e)))!==void 0}function Jl(n,e){if(n===e)return 0;const t=fo(n),i=fo(e);if(t!==i)return bs(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return bs(n.booleanValue,e.booleanValue);case 2:return(function(u,d){const p=Sn(u.integerValue||u.doubleValue),g=Sn(d.integerValue||d.doubleValue);return p<g?-1:p>g?1:p===g?0:isNaN(p)?isNaN(g)?0:-1:1})(n,e);case 3:return xx(n.timestampValue,e.timestampValue);case 4:return xx(wu(n),wu(e));case 5:return fg(n.stringValue,e.stringValue);case 6:return(function(u,d){const p=ho(u),g=ho(d);return p.compareTo(g)})(n.bytesValue,e.bytesValue);case 7:return(function(u,d){const p=u.split("/"),g=d.split("/");for(let y=0;y<p.length&&y<g.length;y++){const w=bs(p[y],g[y]);if(w!==0)return w}return bs(p.length,g.length)})(n.referenceValue,e.referenceValue);case 8:return(function(u,d){const p=bs(Sn(u.latitude),Sn(d.latitude));return p!==0?p:bs(Sn(u.longitude),Sn(d.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return wx(n.arrayValue,e.arrayValue);case 10:return(function(u,d){const p=u.fields||{},g=d.fields||{},y=p[Lh]?.arrayValue,w=g[Lh]?.arrayValue,k=bs(y?.values?.length||0,w?.values?.length||0);return k!==0?k:wx(y,w)})(n.mapValue,e.mapValue);case 11:return(function(u,d){if(u===sh.mapValue&&d===sh.mapValue)return 0;if(u===sh.mapValue)return 1;if(d===sh.mapValue)return-1;const p=u.fields||{},g=Object.keys(p),y=d.fields||{},w=Object.keys(y);g.sort(),w.sort();for(let k=0;k<g.length&&k<w.length;++k){const j=fg(g[k],w[k]);if(j!==0)return j;const O=Jl(p[g[k]],y[w[k]]);if(O!==0)return O}return bs(g.length,w.length)})(n.mapValue,e.mapValue);default:throw Bt(23264,{he:t})}}function xx(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return bs(n,e);const t=uo(n),i=uo(e),l=bs(t.seconds,i.seconds);return l!==0?l:bs(t.nanos,i.nanos)}function wx(n,e){const t=n.values||[],i=e.values||[];for(let l=0;l<t.length&&l<i.length;++l){const u=Jl(t[l],i[l]);if(u)return u}return bs(t.length,i.length)}function Zl(n){return mg(n)}function mg(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=uo(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return ho(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Nt.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",l=!0;for(const u of t.values||[])l?l=!1:i+=",",i+=mg(u);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let l="{",u=!0;for(const d of i)u?u=!1:l+=",",l+=`${d}:${mg(t.fields[d])}`;return l+"}"})(n.mapValue):Bt(61005,{value:n})}function vh(n){switch(fo(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=nf(n);return e?16+vh(e):16;case 5:return 2*n.stringValue.length;case 6:return ho(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((l,u)=>l+vh(u)),0)})(n.arrayValue);case 10:case 11:return(function(i){let l=0;return bo(i.fields,((u,d)=>{l+=u.length+vh(d)})),l})(n.mapValue);default:throw Bt(13486,{value:n})}}function _x(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function pg(n){return!!n&&"integerValue"in n}function ny(n){return!!n&&"arrayValue"in n}function kx(n){return!!n&&"nullValue"in n}function jx(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function xh(n){return!!n&&"mapValue"in n}function TR(n){return(n?.mapValue?.fields||{})[e_]?.stringValue===t_}function cu(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return bo(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=cu(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=cu(n.arrayValue.values[t]);return e}return{...n}}function ER(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===jR}class Dr{constructor(e){this.value=e}static empty(){return new Dr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!xh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=cu(t)}setAll(e){let t=rr.emptyPath(),i={},l=[];e.forEach(((d,p)=>{if(!t.isImmediateParentOf(p)){const g=this.getFieldsMap(t);this.applyChanges(g,i,l),i={},l=[],t=p.popLast()}d?i[p.lastSegment()]=cu(d):l.push(p.lastSegment())}));const u=this.getFieldsMap(t);this.applyChanges(u,i,l)}delete(e){const t=this.field(e.popLast());xh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return qa(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let l=t.mapValue.fields[e.get(i)];xh(l)&&l.mapValue.fields||(l={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=l),t=l}return t.mapValue.fields}applyChanges(e,t,i){bo(t,((l,u)=>e[l]=u));for(const l of i)delete e[l]}clone(){return new Dr(cu(this.value))}}function s_(n){const e=[];return bo(n.fields,((t,i)=>{const l=new rr([t]);if(xh(i)){const u=s_(i.mapValue).fields;if(u.length===0)e.push(l);else for(const d of u)e.push(l.child(d))}else e.push(l)})),new Gr(e)}class ur{constructor(e,t,i,l,u,d,p){this.key=e,this.documentType=t,this.version=i,this.readTime=l,this.createTime=u,this.data=d,this.documentState=p}static newInvalidDocument(e){return new ur(e,0,$t.min(),$t.min(),$t.min(),Dr.empty(),0)}static newFoundDocument(e,t,i,l){return new ur(e,1,t,$t.min(),i,l,0)}static newNoDocument(e,t){return new ur(e,2,t,$t.min(),$t.min(),Dr.empty(),0)}static newUnknownDocument(e,t){return new ur(e,3,t,$t.min(),$t.min(),Dr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual($t.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Dr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Dr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=$t.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ur&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ur(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Oh{constructor(e,t){this.position=e,this.inclusive=t}}function Tx(n,e,t){let i=0;for(let l=0;l<n.position.length;l++){const u=e[l],d=n.position[l];if(u.field.isKeyField()?i=Nt.comparator(Nt.fromName(d.referenceValue),t.key):i=Jl(d,t.data.field(u.field)),u.dir==="desc"&&(i*=-1),i!==0)break}return i}function Ex(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!qa(n.position[t],e.position[t]))return!1;return!0}class ju{constructor(e,t="asc"){this.field=e,this.dir=t}}function NR(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class n_{}class Ln extends n_{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new CR(e,t,i):t==="array-contains"?new IR(e,i):t==="in"?new MR(e,i):t==="not-in"?new DR(e,i):t==="array-contains-any"?new PR(e,i):new Ln(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new RR(e,i):new AR(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Jl(t,this.value)):t!==null&&fo(this.value)===fo(t)&&this.matchesComparison(Jl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Bt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class wa extends n_{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new wa(e,t)}matches(e){return r_(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function r_(n){return n.op==="and"}function a_(n){return SR(n)&&r_(n)}function SR(n){for(const e of n.filters)if(e instanceof wa)return!1;return!0}function gg(n){if(n instanceof Ln)return n.field.canonicalString()+n.op.toString()+Zl(n.value);if(a_(n))return n.filters.map((e=>gg(e))).join(",");{const e=n.filters.map((t=>gg(t))).join(",");return`${n.op}(${e})`}}function i_(n,e){return n instanceof Ln?(function(i,l){return l instanceof Ln&&i.op===l.op&&i.field.isEqual(l.field)&&qa(i.value,l.value)})(n,e):n instanceof wa?(function(i,l){return l instanceof wa&&i.op===l.op&&i.filters.length===l.filters.length?i.filters.reduce(((u,d,p)=>u&&i_(d,l.filters[p])),!0):!1})(n,e):void Bt(19439)}function o_(n){return n instanceof Ln?(function(t){return`${t.field.canonicalString()} ${t.op} ${Zl(t.value)}`})(n):n instanceof wa?(function(t){return t.op.toString()+" {"+t.getFilters().map(o_).join(" ,")+"}"})(n):"Filter"}class CR extends Ln{constructor(e,t,i){super(e,t,i),this.key=Nt.fromName(i.referenceValue)}matches(e){const t=Nt.comparator(e.key,this.key);return this.matchesComparison(t)}}class RR extends Ln{constructor(e,t){super(e,"in",t),this.keys=l_("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class AR extends Ln{constructor(e,t){super(e,"not-in",t),this.keys=l_("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function l_(n,e){return(e.arrayValue?.values||[]).map((t=>Nt.fromName(t.referenceValue)))}class IR extends Ln{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return ny(t)&&ku(t.arrayValue,this.value)}}class MR extends Ln{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&ku(this.value.arrayValue,t)}}class DR extends Ln{constructor(e,t){super(e,"not-in",t)}matches(e){if(ku(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!ku(this.value.arrayValue,t)}}class PR extends Ln{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!ny(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>ku(this.value.arrayValue,i)))}}class LR{constructor(e,t=null,i=[],l=[],u=null,d=null,p=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=l,this.limit=u,this.startAt=d,this.endAt=p,this.Te=null}}function Nx(n,e=null,t=[],i=[],l=null,u=null,d=null){return new LR(n,e,t,i,l,u,d)}function ry(n){const e=Qt(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>gg(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(u){return u.field.canonicalString()+u.dir})(i))).join(","),sf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Zl(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Zl(i))).join(",")),e.Te=t}return e.Te}function ay(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!NR(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!i_(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Ex(n.startAt,e.startAt)&&Ex(n.endAt,e.endAt)}function yg(n){return Nt.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class cc{constructor(e,t=null,i=[],l=[],u=null,d="F",p=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=l,this.limit=u,this.limitType=d,this.startAt=p,this.endAt=g,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function OR(n,e,t,i,l,u,d,p){return new cc(n,e,t,i,l,u,d,p)}function rf(n){return new cc(n)}function Sx(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function VR(n){return Nt.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function c_(n){return n.collectionGroup!==null}function uu(n){const e=Qt(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const u of e.explicitOrderBy)e.Ie.push(u),t.add(u.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let p=new zn(rr.comparator);return d.filters.forEach((g=>{g.getFlattenedFilters().forEach((y=>{y.isInequality()&&(p=p.add(y.field))}))})),p})(e).forEach((u=>{t.has(u.canonicalString())||u.isKeyField()||e.Ie.push(new ju(u,i))})),t.has(rr.keyField().canonicalString())||e.Ie.push(new ju(rr.keyField(),i))}return e.Ie}function za(n){const e=Qt(n);return e.Ee||(e.Ee=BR(e,uu(n))),e.Ee}function BR(n,e){if(n.limitType==="F")return Nx(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((l=>{const u=l.dir==="desc"?"asc":"desc";return new ju(l.field,u)}));const t=n.endAt?new Oh(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Oh(n.startAt.position,n.startAt.inclusive):null;return Nx(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function bg(n,e){const t=n.filters.concat([e]);return new cc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function UR(n,e){const t=n.explicitOrderBy.concat([e]);return new cc(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function Vh(n,e,t){return new cc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function af(n,e){return ay(za(n),za(e))&&n.limitType===e.limitType}function u_(n){return`${ry(za(n))}|lt:${n.limitType}`}function zl(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((l=>o_(l))).join(", ")}]`),sf(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((l=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(l))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((l=>Zl(l))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((l=>Zl(l))).join(",")),`Target(${i})`})(za(n))}; limitType=${n.limitType})`}function of(n,e){return e.isFoundDocument()&&(function(i,l){const u=l.key.path;return i.collectionGroup!==null?l.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(u):Nt.isDocumentKey(i.path)?i.path.isEqual(u):i.path.isImmediateParentOf(u)})(n,e)&&(function(i,l){for(const u of uu(i))if(!u.field.isKeyField()&&l.data.field(u.field)===null)return!1;return!0})(n,e)&&(function(i,l){for(const u of i.filters)if(!u.matches(l))return!1;return!0})(n,e)&&(function(i,l){return!(i.startAt&&!(function(d,p,g){const y=Tx(d,p,g);return d.inclusive?y<=0:y<0})(i.startAt,uu(i),l)||i.endAt&&!(function(d,p,g){const y=Tx(d,p,g);return d.inclusive?y>=0:y>0})(i.endAt,uu(i),l))})(n,e)}function zR(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function d_(n){return(e,t)=>{let i=!1;for(const l of uu(n)){const u=FR(l,e,t);if(u!==0)return u;i=i||l.field.isKeyField()}return 0}}function FR(n,e,t){const i=n.field.isKeyField()?Nt.comparator(e.key,t.key):(function(u,d,p){const g=d.data.field(u),y=p.data.field(u);return g!==null&&y!==null?Jl(g,y):Bt(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Bt(19790,{direction:n.dir})}}class rl{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[l,u]of i)if(this.equalsFn(l,e))return u}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),l=this.inner[i];if(l===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let u=0;u<l.length;u++)if(this.equalsFn(l[u][0],e))return void(l[u]=[e,t]);l.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let l=0;l<i.length;l++)if(this.equalsFn(i[l][0],e))return i.length===1?delete this.inner[t]:i.splice(l,1),this.innerSize--,!0;return!1}forEach(e){bo(this.inner,((t,i)=>{for(const[l,u]of i)e(l,u)}))}isEmpty(){return Kw(this.inner)}size(){return this.innerSize}}const HR=new pn(Nt.comparator);function xi(){return HR}const h_=new pn(Nt.comparator);function ru(...n){let e=h_;for(const t of n)e=e.insert(t.key,t);return e}function f_(n){let e=h_;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Ho(){return du()}function m_(){return du()}function du(){return new rl((n=>n.toString()),((n,e)=>n.isEqual(e)))}const qR=new pn(Nt.comparator),$R=new zn(Nt.comparator);function vs(...n){let e=$R;for(const t of n)e=e.add(t);return e}const WR=new zn(bs);function GR(){return WR}function iy(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Dh(e)?"-0":e}}function p_(n){return{integerValue:""+n}}function g_(n,e){return bR(e)?p_(e):iy(n,e)}class lf{constructor(){this._=void 0}}function KR(n,e,t){return n instanceof Tu?(function(l,u){const d={fields:{[Xw]:{stringValue:Qw},[Zw]:{timestampValue:{seconds:l.seconds,nanos:l.nanoseconds}}}};return u&&sy(u)&&(u=nf(u)),u&&(d.fields[Jw]=u),{mapValue:d}})(t,e):n instanceof Eu?b_(n,e):n instanceof Nu?v_(n,e):(function(l,u){const d=y_(l,u),p=Cx(d)+Cx(l.Ae);return pg(d)&&pg(l.Ae)?p_(p):iy(l.serializer,p)})(n,e)}function YR(n,e,t){return n instanceof Eu?b_(n,e):n instanceof Nu?v_(n,e):t}function y_(n,e){return n instanceof Su?(function(i){return pg(i)||(function(u){return!!u&&"doubleValue"in u})(i)})(e)?e:{integerValue:0}:null}class Tu extends lf{}class Eu extends lf{constructor(e){super(),this.elements=e}}function b_(n,e){const t=x_(e);for(const i of n.elements)t.some((l=>qa(l,i)))||t.push(i);return{arrayValue:{values:t}}}class Nu extends lf{constructor(e){super(),this.elements=e}}function v_(n,e){let t=x_(e);for(const i of n.elements)t=t.filter((l=>!qa(l,i)));return{arrayValue:{values:t}}}class Su extends lf{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Cx(n){return Sn(n.integerValue||n.doubleValue)}function x_(n){return ny(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class w_{constructor(e,t){this.field=e,this.transform=t}}function QR(n,e){return n.field.isEqual(e.field)&&(function(i,l){return i instanceof Eu&&l instanceof Eu||i instanceof Nu&&l instanceof Nu?Xl(i.elements,l.elements,qa):i instanceof Su&&l instanceof Su?qa(i.Ae,l.Ae):i instanceof Tu&&l instanceof Tu})(n.transform,e.transform)}class XR{constructor(e,t){this.version=e,this.transformResults=t}}class _r{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new _r}static exists(e){return new _r(void 0,e)}static updateTime(e){return new _r(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function wh(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class cf{}function __(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new uf(n.key,_r.none()):new Vu(n.key,n.data,_r.none());{const t=n.data,i=Dr.empty();let l=new zn(rr.comparator);for(let u of e.fields)if(!l.has(u)){let d=t.field(u);d===null&&u.length>1&&(u=u.popLast(),d=t.field(u)),d===null?i.delete(u):i.set(u,d),l=l.add(u)}return new vo(n.key,i,new Gr(l.toArray()),_r.none())}}function JR(n,e,t){n instanceof Vu?(function(l,u,d){const p=l.value.clone(),g=Ax(l.fieldTransforms,u,d.transformResults);p.setAll(g),u.convertToFoundDocument(d.version,p).setHasCommittedMutations()})(n,e,t):n instanceof vo?(function(l,u,d){if(!wh(l.precondition,u))return void u.convertToUnknownDocument(d.version);const p=Ax(l.fieldTransforms,u,d.transformResults),g=u.data;g.setAll(k_(l)),g.setAll(p),u.convertToFoundDocument(d.version,g).setHasCommittedMutations()})(n,e,t):(function(l,u,d){u.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function hu(n,e,t,i){return n instanceof Vu?(function(u,d,p,g){if(!wh(u.precondition,d))return p;const y=u.value.clone(),w=Ix(u.fieldTransforms,g,d);return y.setAll(w),d.convertToFoundDocument(d.version,y).setHasLocalMutations(),null})(n,e,t,i):n instanceof vo?(function(u,d,p,g){if(!wh(u.precondition,d))return p;const y=Ix(u.fieldTransforms,g,d),w=d.data;return w.setAll(k_(u)),w.setAll(y),d.convertToFoundDocument(d.version,w).setHasLocalMutations(),p===null?null:p.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((k=>k.field)))})(n,e,t,i):(function(u,d,p){return wh(u.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):p})(n,e,t)}function ZR(n,e){let t=null;for(const i of n.fieldTransforms){const l=e.data.field(i.field),u=y_(i.transform,l||null);u!=null&&(t===null&&(t=Dr.empty()),t.set(i.field,u))}return t||null}function Rx(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,l){return i===void 0&&l===void 0||!(!i||!l)&&Xl(i,l,((u,d)=>QR(u,d)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Vu extends cf{constructor(e,t,i,l=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=l,this.type=0}getFieldMask(){return null}}class vo extends cf{constructor(e,t,i,l,u=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=l,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function k_(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function Ax(n,e,t){const i=new Map;Bs(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let l=0;l<t.length;l++){const u=n[l],d=u.transform,p=e.data.field(u.field);i.set(u.field,YR(d,p,t[l]))}return i}function Ix(n,e,t){const i=new Map;for(const l of n){const u=l.transform,d=t.data.field(l.field);i.set(l.field,KR(u,d,e))}return i}class uf extends cf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class eA extends cf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class tA{constructor(e,t,i,l){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=l}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let l=0;l<this.mutations.length;l++){const u=this.mutations[l];u.key.isEqual(e.key)&&JR(u,e,i[l])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=hu(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=hu(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=m_();return this.mutations.forEach((l=>{const u=e.get(l.key),d=u.overlayedDocument;let p=this.applyToLocalView(d,u.mutatedFields);p=t.has(l.key)?null:p;const g=__(d,p);g!==null&&i.set(l.key,g),d.isValidDocument()||d.convertToNoDocument($t.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),vs())}isEqual(e){return this.batchId===e.batchId&&Xl(this.mutations,e.mutations,((t,i)=>Rx(t,i)))&&Xl(this.baseMutations,e.baseMutations,((t,i)=>Rx(t,i)))}}class oy{constructor(e,t,i,l){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=l}static from(e,t,i){Bs(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let l=(function(){return qR})();const u=e.mutations;for(let d=0;d<u.length;d++)l=l.insert(u[d].key,i[d].version);return new oy(e,t,i,l)}}class sA{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class nA{constructor(e,t){this.count=e,this.unchangedNames=t}}var Pn,ks;function rA(n){switch(n){case je.OK:return Bt(64938);case je.CANCELLED:case je.UNKNOWN:case je.DEADLINE_EXCEEDED:case je.RESOURCE_EXHAUSTED:case je.INTERNAL:case je.UNAVAILABLE:case je.UNAUTHENTICATED:return!1;case je.INVALID_ARGUMENT:case je.NOT_FOUND:case je.ALREADY_EXISTS:case je.PERMISSION_DENIED:case je.FAILED_PRECONDITION:case je.ABORTED:case je.OUT_OF_RANGE:case je.UNIMPLEMENTED:case je.DATA_LOSS:return!0;default:return Bt(15467,{code:n})}}function j_(n){if(n===void 0)return vi("GRPC error has no .code"),je.UNKNOWN;switch(n){case Pn.OK:return je.OK;case Pn.CANCELLED:return je.CANCELLED;case Pn.UNKNOWN:return je.UNKNOWN;case Pn.DEADLINE_EXCEEDED:return je.DEADLINE_EXCEEDED;case Pn.RESOURCE_EXHAUSTED:return je.RESOURCE_EXHAUSTED;case Pn.INTERNAL:return je.INTERNAL;case Pn.UNAVAILABLE:return je.UNAVAILABLE;case Pn.UNAUTHENTICATED:return je.UNAUTHENTICATED;case Pn.INVALID_ARGUMENT:return je.INVALID_ARGUMENT;case Pn.NOT_FOUND:return je.NOT_FOUND;case Pn.ALREADY_EXISTS:return je.ALREADY_EXISTS;case Pn.PERMISSION_DENIED:return je.PERMISSION_DENIED;case Pn.FAILED_PRECONDITION:return je.FAILED_PRECONDITION;case Pn.ABORTED:return je.ABORTED;case Pn.OUT_OF_RANGE:return je.OUT_OF_RANGE;case Pn.UNIMPLEMENTED:return je.UNIMPLEMENTED;case Pn.DATA_LOSS:return je.DATA_LOSS;default:return Bt(39323,{code:n})}}(ks=Pn||(Pn={}))[ks.OK=0]="OK",ks[ks.CANCELLED=1]="CANCELLED",ks[ks.UNKNOWN=2]="UNKNOWN",ks[ks.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ks[ks.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ks[ks.NOT_FOUND=5]="NOT_FOUND",ks[ks.ALREADY_EXISTS=6]="ALREADY_EXISTS",ks[ks.PERMISSION_DENIED=7]="PERMISSION_DENIED",ks[ks.UNAUTHENTICATED=16]="UNAUTHENTICATED",ks[ks.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ks[ks.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ks[ks.ABORTED=10]="ABORTED",ks[ks.OUT_OF_RANGE=11]="OUT_OF_RANGE",ks[ks.UNIMPLEMENTED=12]="UNIMPLEMENTED",ks[ks.INTERNAL=13]="INTERNAL",ks[ks.UNAVAILABLE=14]="UNAVAILABLE",ks[ks.DATA_LOSS=15]="DATA_LOSS";function aA(){return new TextEncoder}const iA=new io([4294967295,4294967295],0);function Mx(n){const e=aA().encode(n),t=new Ow;return t.update(e),new Uint8Array(t.digest())}function Dx(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),l=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new io([t,i],0),new io([l,u],0)]}class ly{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new au(`Invalid padding: ${t}`);if(i<0)throw new au(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new au(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new au(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=io.fromNumber(this.ge)}ye(e,t,i){let l=e.add(t.multiply(io.fromNumber(i)));return l.compare(iA)===1&&(l=new io([l.getBits(0),l.getBits(1)],0)),l.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Mx(e),[i,l]=Dx(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);if(!this.we(d))return!1}return!0}static create(e,t,i){const l=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),d=new ly(u,l,t);return i.forEach((p=>d.insert(p))),d}insert(e){if(this.ge===0)return;const t=Mx(e),[i,l]=Dx(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);this.be(d)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class au extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class df{constructor(e,t,i,l,u){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=l,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const l=new Map;return l.set(e,Bu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new df($t.min(),l,new pn(bs),xi(),vs())}}class Bu{constructor(e,t,i,l,u){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=l,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Bu(i,t,vs(),vs(),vs())}}class _h{constructor(e,t,i,l){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=l}}class T_{constructor(e,t){this.targetId=e,this.Ce=t}}class E_{constructor(e,t,i=ar.EMPTY_BYTE_STRING,l=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=l}}class Px{constructor(){this.ve=0,this.Fe=Lx(),this.Me=ar.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=vs(),t=vs(),i=vs();return this.Fe.forEach(((l,u)=>{switch(u){case 0:e=e.add(l);break;case 2:t=t.add(l);break;case 1:i=i.add(l);break;default:Bt(38017,{changeType:u})}})),new Bu(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=Lx()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Bs(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class oA{constructor(e){this.Ge=e,this.ze=new Map,this.je=xi(),this.He=nh(),this.Je=nh(),this.Ze=new pn(bs)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:Bt(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,l)=>{this.rt(l)&&t(l)}))}st(e){const t=e.targetId,i=e.Ce.count,l=this.ot(t);if(l){const u=l.target;if(yg(u))if(i===0){const d=new Nt(u.path);this.et(t,d,ur.newNoDocument(d,$t.min()))}else Bs(i===1,20013,{expectedCount:i});else{const d=this._t(t);if(d!==i){const p=this.ut(e),g=p?this.ct(p,e,d):1;if(g!==0){this.it(t);const y=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,y)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:l=0},hashCount:u=0}=t;let d,p;try{d=ho(i).toUint8Array()}catch(g){if(g instanceof Yw)return Ql("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{p=new ly(d,l,u)}catch(g){return Ql(g instanceof au?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return p.ge===0?null:p}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let l=0;return i.forEach((u=>{const d=this.Ge.ht(),p=`projects/${d.projectId}/databases/${d.database}/documents/${u.path.canonicalString()}`;e.mightContain(p)||(this.et(t,u,null),l++)})),l}Tt(e){const t=new Map;this.ze.forEach(((u,d)=>{const p=this.ot(d);if(p){if(u.current&&yg(p.target)){const g=new Nt(p.target.path);this.It(g).has(d)||this.Et(d,g)||this.et(d,g,ur.newNoDocument(g,e))}u.Be&&(t.set(d,u.ke()),u.Ke())}}));let i=vs();this.Je.forEach(((u,d)=>{let p=!0;d.forEachWhile((g=>{const y=this.ot(g);return!y||y.purpose==="TargetPurposeLimboResolution"||(p=!1,!1)})),p&&(i=i.add(u))})),this.je.forEach(((u,d)=>d.setReadTime(e)));const l=new df(e,t,this.Ze,this.je,i);return this.je=xi(),this.He=nh(),this.Je=nh(),this.Ze=new pn(bs),l}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const l=this.nt(e);this.Et(e,t)?l.qe(t,1):l.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new Px,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new zn(bs),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new zn(bs),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||lt("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Px),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function nh(){return new pn(Nt.comparator)}function Lx(){return new pn(Nt.comparator)}const lA={asc:"ASCENDING",desc:"DESCENDING"},cA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},uA={and:"AND",or:"OR"};class dA{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function vg(n,e){return n.useProto3Json||sf(e)?e:{value:e}}function Bh(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function N_(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function hA(n,e){return Bh(n,e.toTimestamp())}function Fa(n){return Bs(!!n,49232),$t.fromTimestamp((function(t){const i=uo(t);return new vt(i.seconds,i.nanos)})(n))}function cy(n,e){return xg(n,e).canonicalString()}function xg(n,e){const t=(function(l){return new en(["projects",l.projectId,"databases",l.database])})(n).child("documents");return e===void 0?t:t.child(e)}function S_(n){const e=en.fromString(n);return Bs(M_(e),10190,{key:e.toString()}),e}function wg(n,e){return cy(n.databaseId,e.path)}function Ap(n,e){const t=S_(e);if(t.get(1)!==n.databaseId.projectId)throw new nt(je.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new nt(je.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Nt(R_(t))}function C_(n,e){return cy(n.databaseId,e)}function fA(n){const e=S_(n);return e.length===4?en.emptyPath():R_(e)}function _g(n){return new en(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function R_(n){return Bs(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Ox(n,e,t){return{name:wg(n,e),fields:t.value.mapValue.fields}}function mA(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:Bt(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),l=e.targetChange.targetIds||[],u=(function(y,w){return y.useProto3Json?(Bs(w===void 0||typeof w=="string",58123),ar.fromBase64String(w||"")):(Bs(w===void 0||w instanceof Buffer||w instanceof Uint8Array,16193),ar.fromUint8Array(w||new Uint8Array))})(n,e.targetChange.resumeToken),d=e.targetChange.cause,p=d&&(function(y){const w=y.code===void 0?je.UNKNOWN:j_(y.code);return new nt(w,y.message||"")})(d);t=new E_(i,l,u,p||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const l=Ap(n,i.document.name),u=Fa(i.document.updateTime),d=i.document.createTime?Fa(i.document.createTime):$t.min(),p=new Dr({mapValue:{fields:i.document.fields}}),g=ur.newFoundDocument(l,u,d,p),y=i.targetIds||[],w=i.removedTargetIds||[];t=new _h(y,w,g.key,g)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const l=Ap(n,i.document),u=i.readTime?Fa(i.readTime):$t.min(),d=ur.newNoDocument(l,u),p=i.removedTargetIds||[];t=new _h([],p,d.key,d)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const l=Ap(n,i.document),u=i.removedTargetIds||[];t=new _h([],u,l,null)}else{if(!("filter"in e))return Bt(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:l=0,unchangedNames:u}=i,d=new nA(l,u),p=i.targetId;t=new T_(p,d)}}return t}function pA(n,e){let t;if(e instanceof Vu)t={update:Ox(n,e.key,e.value)};else if(e instanceof uf)t={delete:wg(n,e.key)};else if(e instanceof vo)t={update:Ox(n,e.key,e.data),updateMask:jA(e.fieldMask)};else{if(!(e instanceof eA))return Bt(16599,{dt:e.type});t={verify:wg(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(u,d){const p=d.transform;if(p instanceof Tu)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(p instanceof Eu)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:p.elements}};if(p instanceof Nu)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:p.elements}};if(p instanceof Su)return{fieldPath:d.field.canonicalString(),increment:p.Ae};throw Bt(20930,{transform:d.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(l,u){return u.updateTime!==void 0?{updateTime:hA(l,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:Bt(27497)})(n,e.precondition)),t}function gA(n,e){return n&&n.length>0?(Bs(e!==void 0,14353),n.map((t=>(function(l,u){let d=l.updateTime?Fa(l.updateTime):Fa(u);return d.isEqual($t.min())&&(d=Fa(u)),new XR(d,l.transformResults||[])})(t,e)))):[]}function yA(n,e){return{documents:[C_(n,e.path)]}}function bA(n,e){const t={structuredQuery:{}},i=e.path;let l;e.collectionGroup!==null?(l=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(l=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=C_(n,l);const u=(function(y){if(y.length!==0)return I_(wa.create(y,"and"))})(e.filters);u&&(t.structuredQuery.where=u);const d=(function(y){if(y.length!==0)return y.map((w=>(function(j){return{field:Fl(j.field),direction:wA(j.dir)}})(w)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const p=vg(n,e.limit);return p!==null&&(t.structuredQuery.limit=p),e.startAt&&(t.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{ft:t,parent:l}}function vA(n){let e=fA(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let l=null;if(i>0){Bs(i===1,65062);const w=t.from[0];w.allDescendants?l=w.collectionId:e=e.child(w.collectionId)}let u=[];t.where&&(u=(function(k){const j=A_(k);return j instanceof wa&&a_(j)?j.getFilters():[j]})(t.where));let d=[];t.orderBy&&(d=(function(k){return k.map((j=>(function(q){return new ju(Hl(q.field),(function(V){switch(V){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(q.direction))})(j)))})(t.orderBy));let p=null;t.limit&&(p=(function(k){let j;return j=typeof k=="object"?k.value:k,sf(j)?null:j})(t.limit));let g=null;t.startAt&&(g=(function(k){const j=!!k.before,O=k.values||[];return new Oh(O,j)})(t.startAt));let y=null;return t.endAt&&(y=(function(k){const j=!k.before,O=k.values||[];return new Oh(O,j)})(t.endAt)),OR(e,l,d,u,p,"F",g,y)}function xA(n,e){const t=(function(l){switch(l){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Bt(28987,{purpose:l})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function A_(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Hl(t.unaryFilter.field);return Ln.create(i,"==",{doubleValue:NaN});case"IS_NULL":const l=Hl(t.unaryFilter.field);return Ln.create(l,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=Hl(t.unaryFilter.field);return Ln.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=Hl(t.unaryFilter.field);return Ln.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Bt(61313);default:return Bt(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Ln.create(Hl(t.fieldFilter.field),(function(l){switch(l){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Bt(58110);default:return Bt(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return wa.create(t.compositeFilter.filters.map((i=>A_(i))),(function(l){switch(l){case"AND":return"and";case"OR":return"or";default:return Bt(1026)}})(t.compositeFilter.op))})(n):Bt(30097,{filter:n})}function wA(n){return lA[n]}function _A(n){return cA[n]}function kA(n){return uA[n]}function Fl(n){return{fieldPath:n.canonicalString()}}function Hl(n){return rr.fromServerFormat(n.fieldPath)}function I_(n){return n instanceof Ln?(function(t){if(t.op==="=="){if(jx(t.value))return{unaryFilter:{field:Fl(t.field),op:"IS_NAN"}};if(kx(t.value))return{unaryFilter:{field:Fl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(jx(t.value))return{unaryFilter:{field:Fl(t.field),op:"IS_NOT_NAN"}};if(kx(t.value))return{unaryFilter:{field:Fl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Fl(t.field),op:_A(t.op),value:t.value}}})(n):n instanceof wa?(function(t){const i=t.getFilters().map((l=>I_(l)));return i.length===1?i[0]:{compositeFilter:{op:kA(t.op),filters:i}}})(n):Bt(54877,{filter:n})}function jA(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function M_(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function D_(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}class to{constructor(e,t,i,l,u=$t.min(),d=$t.min(),p=ar.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=l,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=p,this.expectedCount=g}withSequenceNumber(e){return new to(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new to(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new to(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new to(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class TA{constructor(e){this.yt=e}}function EA(n){const e=vA({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Vh(e,e.limit,"L"):e}class NA{constructor(){this.Sn=new SA}addToCollectionParentIndex(e,t){return this.Sn.add(t),Ae.resolve()}getCollectionParents(e,t){return Ae.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return Ae.resolve()}deleteFieldIndex(e,t){return Ae.resolve()}deleteAllFieldIndexes(e){return Ae.resolve()}createTargetIndexes(e,t){return Ae.resolve()}getDocumentsMatchingTarget(e,t){return Ae.resolve(null)}getIndexType(e,t){return Ae.resolve(0)}getFieldIndexes(e,t){return Ae.resolve([])}getNextCollectionGroupToUpdate(e){return Ae.resolve(null)}getMinOffset(e,t){return Ae.resolve(co.min())}getMinOffsetFromCollectionGroup(e,t){return Ae.resolve(co.min())}updateCollectionGroup(e,t,i){return Ae.resolve()}updateIndexEntries(e,t){return Ae.resolve()}}class SA{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t]||new zn(en.comparator),u=!l.has(i);return this.index[t]=l.add(i),u}has(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t];return l&&l.has(i)}getEntries(e){return(this.index[e]||new zn(en.comparator)).toArray()}}const Vx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},P_=41943040;class Mr{static withCacheSize(e){return new Mr(e,Mr.DEFAULT_COLLECTION_PERCENTILE,Mr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}Mr.DEFAULT_COLLECTION_PERCENTILE=10,Mr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Mr.DEFAULT=new Mr(P_,Mr.DEFAULT_COLLECTION_PERCENTILE,Mr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Mr.DISABLED=new Mr(-1,0,0);class ec{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new ec(0)}static ar(){return new ec(-1)}}const Bx="LruGarbageCollector",CA=1048576;function Ux([n,e],[t,i]){const l=bs(n,t);return l===0?bs(e,i):l}class RA{constructor(e){this.Pr=e,this.buffer=new zn(Ux),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();Ux(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class AA{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){lt(Bx,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){lc(t)?lt(Bx,"Ignoring IndexedDB error during garbage collection: ",t):await oc(t)}await this.Ar(3e5)}))}}class IA{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Ae.resolve(tf.ce);const i=new RA(t);return this.Vr.forEachTarget(e,(l=>i.Er(l.sequenceNumber))).next((()=>this.Vr.mr(e,(l=>i.Er(l))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(lt("LruGarbageCollector","Garbage collection skipped; disabled"),Ae.resolve(Vx)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(lt("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Vx):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,l,u,d,p,g,y;const w=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((k=>(k>this.params.maximumSequenceNumbersToCollect?(lt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${k}`),l=this.params.maximumSequenceNumbersToCollect):l=k,d=Date.now(),this.nthSequenceNumber(e,l)))).next((k=>(i=k,p=Date.now(),this.removeTargets(e,i,t)))).next((k=>(u=k,g=Date.now(),this.removeOrphanedDocuments(e,i)))).next((k=>(y=Date.now(),Ul()<=ys.DEBUG&&lt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-w}ms
	Determined least recently used ${l} in `+(p-d)+`ms
	Removed ${u} targets in `+(g-p)+`ms
	Removed ${k} documents in `+(y-g)+`ms
Total Duration: ${y-w}ms`),Ae.resolve({didRun:!0,sequenceNumbersCollected:l,targetsRemoved:u,documentsRemoved:k}))))}}function MA(n,e){return new IA(n,e)}class DA{constructor(){this.changes=new rl((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ur.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Ae.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class PA{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class LA{constructor(e,t,i,l){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=l}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((l=>(i=l,this.remoteDocumentCache.getEntry(e,t)))).next((l=>(i!==null&&hu(i.mutation,l,Gr.empty(),vt.now()),l)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,vs()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=vs()){const l=Ho();return this.populateOverlays(e,l,t).next((()=>this.computeViews(e,t,l,i).next((u=>{let d=ru();return u.forEach(((p,g)=>{d=d.insert(p,g.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const i=Ho();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,vs())))}populateOverlays(e,t,i){const l=[];return i.forEach((u=>{t.has(u)||l.push(u)})),this.documentOverlayCache.getOverlays(e,l).next((u=>{u.forEach(((d,p)=>{t.set(d,p)}))}))}computeViews(e,t,i,l){let u=xi();const d=du(),p=(function(){return du()})();return t.forEach(((g,y)=>{const w=i.get(y.key);l.has(y.key)&&(w===void 0||w.mutation instanceof vo)?u=u.insert(y.key,y):w!==void 0?(d.set(y.key,w.mutation.getFieldMask()),hu(w.mutation,y,w.mutation.getFieldMask(),vt.now())):d.set(y.key,Gr.empty())})),this.recalculateAndSaveOverlays(e,u).next((g=>(g.forEach(((y,w)=>d.set(y,w))),t.forEach(((y,w)=>p.set(y,new PA(w,d.get(y)??null)))),p)))}recalculateAndSaveOverlays(e,t){const i=du();let l=new pn(((d,p)=>d-p)),u=vs();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const p of d)p.keys().forEach((g=>{const y=t.get(g);if(y===null)return;let w=i.get(g)||Gr.empty();w=p.applyToLocalView(y,w),i.set(g,w);const k=(l.get(p.batchId)||vs()).add(g);l=l.insert(p.batchId,k)}))})).next((()=>{const d=[],p=l.getReverseIterator();for(;p.hasNext();){const g=p.getNext(),y=g.key,w=g.value,k=m_();w.forEach((j=>{if(!u.has(j)){const O=__(t.get(j),i.get(j));O!==null&&k.set(j,O),u=u.add(j)}})),d.push(this.documentOverlayCache.saveOverlays(e,y,k))}return Ae.waitFor(d)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,l){return VR(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):c_(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,l):this.getDocumentsMatchingCollectionQuery(e,t,i,l)}getNextDocuments(e,t,i,l){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,l).next((u=>{const d=l-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,l-u.size):Ae.resolve(Ho());let p=xu,g=u;return d.next((y=>Ae.forEach(y,((w,k)=>(p<k.largestBatchId&&(p=k.largestBatchId),u.get(w)?Ae.resolve():this.remoteDocumentCache.getEntry(e,w).next((j=>{g=g.insert(w,j)}))))).next((()=>this.populateOverlays(e,y,u))).next((()=>this.computeViews(e,g,y,vs()))).next((w=>({batchId:p,changes:f_(w)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Nt(t)).next((i=>{let l=ru();return i.isFoundDocument()&&(l=l.insert(i.key,i)),l}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,l){const u=t.collectionGroup;let d=ru();return this.indexManager.getCollectionParents(e,u).next((p=>Ae.forEach(p,(g=>{const y=(function(k,j){return new cc(j,null,k.explicitOrderBy.slice(),k.filters.slice(),k.limit,k.limitType,k.startAt,k.endAt)})(t,g.child(u));return this.getDocumentsMatchingCollectionQuery(e,y,i,l).next((w=>{w.forEach(((k,j)=>{d=d.insert(k,j)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,i,l){let u;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((d=>(u=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,u,l)))).next((d=>{u.forEach(((g,y)=>{const w=y.getKey();d.get(w)===null&&(d=d.insert(w,ur.newInvalidDocument(w)))}));let p=ru();return d.forEach(((g,y)=>{const w=u.get(g);w!==void 0&&hu(w.mutation,y,Gr.empty(),vt.now()),of(t,y)&&(p=p.insert(g,y))})),p}))}}class OA{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return Ae.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(l){return{id:l.id,version:l.version,createTime:Fa(l.createTime)}})(t)),Ae.resolve()}getNamedQuery(e,t){return Ae.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(l){return{name:l.name,query:EA(l.bundledQuery),readTime:Fa(l.readTime)}})(t)),Ae.resolve()}}class VA{constructor(){this.overlays=new pn(Nt.comparator),this.Lr=new Map}getOverlay(e,t){return Ae.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Ho();return Ae.forEach(t,(l=>this.getOverlay(e,l).next((u=>{u!==null&&i.set(l,u)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((l,u)=>{this.bt(e,t,u)})),Ae.resolve()}removeOverlaysForBatchId(e,t,i){const l=this.Lr.get(i);return l!==void 0&&(l.forEach((u=>this.overlays=this.overlays.remove(u))),this.Lr.delete(i)),Ae.resolve()}getOverlaysForCollection(e,t,i){const l=Ho(),u=t.length+1,d=new Nt(t.child("")),p=this.overlays.getIteratorFrom(d);for(;p.hasNext();){const g=p.getNext().value,y=g.getKey();if(!t.isPrefixOf(y.path))break;y.path.length===u&&g.largestBatchId>i&&l.set(g.getKey(),g)}return Ae.resolve(l)}getOverlaysForCollectionGroup(e,t,i,l){let u=new pn(((y,w)=>y-w));const d=this.overlays.getIterator();for(;d.hasNext();){const y=d.getNext().value;if(y.getKey().getCollectionGroup()===t&&y.largestBatchId>i){let w=u.get(y.largestBatchId);w===null&&(w=Ho(),u=u.insert(y.largestBatchId,w)),w.set(y.getKey(),y)}}const p=Ho(),g=u.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((y,w)=>p.set(y,w))),!(p.size()>=l)););return Ae.resolve(p)}bt(e,t,i){const l=this.overlays.get(i.key);if(l!==null){const d=this.Lr.get(l.largestBatchId).delete(i.key);this.Lr.set(l.largestBatchId,d)}this.overlays=this.overlays.insert(i.key,new sA(t,i));let u=this.Lr.get(t);u===void 0&&(u=vs(),this.Lr.set(t,u)),this.Lr.set(t,u.add(i.key))}}class BA{constructor(){this.sessionToken=ar.EMPTY_BYTE_STRING}getSessionToken(e){return Ae.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Ae.resolve()}}class uy{constructor(){this.kr=new zn($n.Kr),this.qr=new zn($n.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new $n(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new $n(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new Nt(new en([])),i=new $n(t,e),l=new $n(t,e+1),u=[];return this.qr.forEachInRange([i,l],(d=>{this.Wr(d),u.push(d.key)})),u}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new Nt(new en([])),i=new $n(t,e),l=new $n(t,e+1);let u=vs();return this.qr.forEachInRange([i,l],(d=>{u=u.add(d.key)})),u}containsKey(e){const t=new $n(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class $n{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return Nt.comparator(e.key,t.key)||bs(e.Hr,t.Hr)}static Ur(e,t){return bs(e.Hr,t.Hr)||Nt.comparator(e.key,t.key)}}class UA{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new zn($n.Kr)}checkEmpty(e){return Ae.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,l){const u=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new tA(u,t,i,l);this.mutationQueue.push(d);for(const p of l)this.Jr=this.Jr.add(new $n(p.key,u)),this.indexManager.addToCollectionParentIndex(e,p.key.path.popLast());return Ae.resolve(d)}lookupMutationBatch(e,t){return Ae.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,l=this.Xr(i),u=l<0?0:l;return Ae.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return Ae.resolve(this.mutationQueue.length===0?ty:this.Yn-1)}getAllMutationBatches(e){return Ae.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new $n(t,0),l=new $n(t,Number.POSITIVE_INFINITY),u=[];return this.Jr.forEachInRange([i,l],(d=>{const p=this.Zr(d.Hr);u.push(p)})),Ae.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new zn(bs);return t.forEach((l=>{const u=new $n(l,0),d=new $n(l,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([u,d],(p=>{i=i.add(p.Hr)}))})),Ae.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,l=i.length+1;let u=i;Nt.isDocumentKey(u)||(u=u.child(""));const d=new $n(new Nt(u),0);let p=new zn(bs);return this.Jr.forEachWhile((g=>{const y=g.key.path;return!!i.isPrefixOf(y)&&(y.length===l&&(p=p.add(g.Hr)),!0)}),d),Ae.resolve(this.Yr(p))}Yr(e){const t=[];return e.forEach((i=>{const l=this.Zr(i);l!==null&&t.push(l)})),t}removeMutationBatch(e,t){Bs(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return Ae.forEach(t.mutations,(l=>{const u=new $n(l.key,t.batchId);return i=i.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,l.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new $n(t,0),l=this.Jr.firstAfterOrEqual(i);return Ae.resolve(t.isEqual(l&&l.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ae.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class zA{constructor(e){this.ti=e,this.docs=(function(){return new pn(Nt.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,l=this.docs.get(i),u=l?l.size:0,d=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:d}),this.size+=d-u,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Ae.resolve(i?i.document.mutableCopy():ur.newInvalidDocument(t))}getEntries(e,t){let i=xi();return t.forEach((l=>{const u=this.docs.get(l);i=i.insert(l,u?u.document.mutableCopy():ur.newInvalidDocument(l))})),Ae.resolve(i)}getDocumentsMatchingQuery(e,t,i,l){let u=xi();const d=t.path,p=new Nt(d.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(p);for(;g.hasNext();){const{key:y,value:{document:w}}=g.getNext();if(!d.isPrefixOf(y.path))break;y.path.length>d.length+1||mR(fR(w),i)<=0||(l.has(w.key)||of(t,w))&&(u=u.insert(w.key,w.mutableCopy()))}return Ae.resolve(u)}getAllFromCollectionGroup(e,t,i,l){Bt(9500)}ni(e,t){return Ae.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new FA(this)}getSize(e){return Ae.resolve(this.size)}}class FA extends DA{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,l)=>{l.isValidDocument()?t.push(this.Mr.addEntry(e,l)):this.Mr.removeEntry(i)})),Ae.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class HA{constructor(e){this.persistence=e,this.ri=new rl((t=>ry(t)),ay),this.lastRemoteSnapshotVersion=$t.min(),this.highestTargetId=0,this.ii=0,this.si=new uy,this.targetCount=0,this.oi=ec._r()}forEachTarget(e,t){return this.ri.forEach(((i,l)=>t(l))),Ae.resolve()}getLastRemoteSnapshotVersion(e){return Ae.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ae.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),Ae.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),Ae.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new ec(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,Ae.resolve()}updateTargetData(e,t){return this.lr(t),Ae.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,Ae.resolve()}removeTargets(e,t,i){let l=0;const u=[];return this.ri.forEach(((d,p)=>{p.sequenceNumber<=t&&i.get(p.targetId)===null&&(this.ri.delete(d),u.push(this.removeMatchingKeysForTargetId(e,p.targetId)),l++)})),Ae.waitFor(u).next((()=>l))}getTargetCount(e){return Ae.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return Ae.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),Ae.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const l=this.persistence.referenceDelegate,u=[];return l&&t.forEach((d=>{u.push(l.markPotentiallyOrphaned(e,d))})),Ae.waitFor(u)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),Ae.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return Ae.resolve(i)}containsKey(e,t){return Ae.resolve(this.si.containsKey(t))}}class L_{constructor(e,t){this._i={},this.overlays={},this.ai=new tf(0),this.ui=!1,this.ui=!0,this.ci=new BA,this.referenceDelegate=e(this),this.li=new HA(this),this.indexManager=new NA,this.remoteDocumentCache=(function(l){return new zA(l)})((i=>this.referenceDelegate.hi(i))),this.serializer=new TA(t),this.Pi=new OA(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new VA,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new UA(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){lt("MemoryPersistence","Starting transaction:",e);const l=new qA(this.ai.next());return this.referenceDelegate.Ti(),i(l).next((u=>this.referenceDelegate.Ii(l).next((()=>u)))).toPromise().then((u=>(l.raiseOnCommittedEvent(),u)))}Ei(e,t){return Ae.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class qA extends gR{constructor(e){super(),this.currentSequenceNumber=e}}class dy{constructor(e){this.persistence=e,this.Ri=new uy,this.Ai=null}static Vi(e){return new dy(e)}get di(){if(this.Ai)return this.Ai;throw Bt(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),Ae.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),Ae.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),Ae.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((l=>this.di.add(l.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((l=>{l.forEach((u=>this.di.add(u.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ae.forEach(this.di,(i=>{const l=Nt.fromPath(i);return this.mi(e,l).next((u=>{u||t.removeEntry(l,$t.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return Ae.or([()=>Ae.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Uh{constructor(e,t){this.persistence=e,this.fi=new rl((i=>vR(i.path)),((i,l)=>i.isEqual(l))),this.garbageCollector=MA(this,t)}static Vi(e,t){return new Uh(e,t)}Ti(){}Ii(e){return Ae.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((l=>i+l))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return Ae.forEach(this.fi,((i,l)=>this.wr(e,i,l).next((u=>u?Ae.resolve():t(l)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const l=this.persistence.getRemoteDocumentCache(),u=l.newChangeBuffer();return l.ni(e,(d=>this.wr(e,d,t).next((p=>{p||(i++,u.removeEntry(d,$t.min()))})))).next((()=>u.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),Ae.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Ae.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Ae.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),Ae.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=vh(e.data.value)),t}wr(e,t,i){return Ae.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const l=this.fi.get(t);return Ae.resolve(l!==void 0&&l>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class hy{constructor(e,t,i,l){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=l}static Es(e,t){let i=vs(),l=vs();for(const u of t.docChanges)switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:l=l.add(u.doc.key)}return new hy(e,t.fromCache,i,l)}}class $A{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class WA{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return vN()?8:yR(dr())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,l){const u={result:null};return this.gs(e,t).next((d=>{u.result=d})).next((()=>{if(!u.result)return this.ps(e,t,l,i).next((d=>{u.result=d}))})).next((()=>{if(u.result)return;const d=new $A;return this.ys(e,t,d).next((p=>{if(u.result=p,this.As)return this.ws(e,t,d,p.size)}))})).next((()=>u.result))}ws(e,t,i,l){return i.documentReadCount<this.Vs?(Ul()<=ys.DEBUG&&lt("QueryEngine","SDK will not create cache indexes for query:",zl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Ae.resolve()):(Ul()<=ys.DEBUG&&lt("QueryEngine","Query:",zl(t),"scans",i.documentReadCount,"local documents and returns",l,"documents as results."),i.documentReadCount>this.ds*l?(Ul()<=ys.DEBUG&&lt("QueryEngine","The SDK decides to create cache indexes for query:",zl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,za(t))):Ae.resolve())}gs(e,t){if(Sx(t))return Ae.resolve(null);let i=za(t);return this.indexManager.getIndexType(e,i).next((l=>l===0?null:(t.limit!==null&&l===1&&(t=Vh(t,null,"F"),i=za(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((u=>{const d=vs(...u);return this.fs.getDocuments(e,d).next((p=>this.indexManager.getMinOffset(e,i).next((g=>{const y=this.bs(t,p);return this.Ss(t,y,d,g.readTime)?this.gs(e,Vh(t,null,"F")):this.Ds(e,y,t,g)}))))})))))}ps(e,t,i,l){return Sx(t)||l.isEqual($t.min())?Ae.resolve(null):this.fs.getDocuments(e,i).next((u=>{const d=this.bs(t,u);return this.Ss(t,d,i,l)?Ae.resolve(null):(Ul()<=ys.DEBUG&&lt("QueryEngine","Re-using previous result from %s to execute query: %s",l.toString(),zl(t)),this.Ds(e,d,t,hR(l,xu)).next((p=>p)))}))}bs(e,t){let i=new zn(d_(e));return t.forEach(((l,u)=>{of(e,u)&&(i=i.add(u))})),i}Ss(e,t,i,l){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const u=e.limitType==="F"?t.last():t.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(l)>0)}ys(e,t,i){return Ul()<=ys.DEBUG&&lt("QueryEngine","Using full collection scan to execute query:",zl(t)),this.fs.getDocumentsMatchingQuery(e,t,co.min(),i)}Ds(e,t,i,l){return this.fs.getDocumentsMatchingQuery(e,i,l).next((u=>(t.forEach((d=>{u=u.insert(d.key,d)})),u)))}}const fy="LocalStore",GA=3e8;class KA{constructor(e,t,i,l){this.persistence=e,this.Cs=t,this.serializer=l,this.vs=new pn(bs),this.Fs=new rl((u=>ry(u)),ay),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new LA(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function YA(n,e,t,i){return new KA(n,e,t,i)}async function O_(n,e){const t=Qt(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let l;return t.mutationQueue.getAllMutationBatches(i).next((u=>(l=u,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((u=>{const d=[],p=[];let g=vs();for(const y of l){d.push(y.batchId);for(const w of y.mutations)g=g.add(w.key)}for(const y of u){p.push(y.batchId);for(const w of y.mutations)g=g.add(w.key)}return t.localDocuments.getDocuments(i,g).next((y=>({Ns:y,removedBatchIds:d,addedBatchIds:p})))}))}))}function QA(n,e){const t=Qt(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const l=e.batch.keys(),u=t.xs.newChangeBuffer({trackRemovals:!0});return(function(p,g,y,w){const k=y.batch,j=k.keys();let O=Ae.resolve();return j.forEach((q=>{O=O.next((()=>w.getEntry(g,q))).next((B=>{const V=y.docVersions.get(q);Bs(V!==null,48541),B.version.compareTo(V)<0&&(k.applyToRemoteDocument(B,y),B.isValidDocument()&&(B.setReadTime(y.commitVersion),w.addEntry(B)))}))})),O.next((()=>p.mutationQueue.removeMutationBatch(g,k)))})(t,i,e,u).next((()=>u.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,l,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(p){let g=vs();for(let y=0;y<p.mutationResults.length;++y)p.mutationResults[y].transformResults.length>0&&(g=g.add(p.batch.mutations[y].key));return g})(e)))).next((()=>t.localDocuments.getDocuments(i,l)))}))}function V_(n){const e=Qt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function XA(n,e){const t=Qt(n),i=e.snapshotVersion;let l=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const d=t.xs.newChangeBuffer({trackRemovals:!0});l=t.vs;const p=[];e.targetChanges.forEach(((w,k)=>{const j=l.get(k);if(!j)return;p.push(t.li.removeMatchingKeys(u,w.removedDocuments,k).next((()=>t.li.addMatchingKeys(u,w.addedDocuments,k))));let O=j.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(k)!==null?O=O.withResumeToken(ar.EMPTY_BYTE_STRING,$t.min()).withLastLimboFreeSnapshotVersion($t.min()):w.resumeToken.approximateByteSize()>0&&(O=O.withResumeToken(w.resumeToken,i)),l=l.insert(k,O),(function(B,V,ne){return B.resumeToken.approximateByteSize()===0||V.snapshotVersion.toMicroseconds()-B.snapshotVersion.toMicroseconds()>=GA?!0:ne.addedDocuments.size+ne.modifiedDocuments.size+ne.removedDocuments.size>0})(j,O,w)&&p.push(t.li.updateTargetData(u,O))}));let g=xi(),y=vs();if(e.documentUpdates.forEach((w=>{e.resolvedLimboDocuments.has(w)&&p.push(t.persistence.referenceDelegate.updateLimboDocument(u,w))})),p.push(JA(u,d,e.documentUpdates).next((w=>{g=w.Bs,y=w.Ls}))),!i.isEqual($t.min())){const w=t.li.getLastRemoteSnapshotVersion(u).next((k=>t.li.setTargetsMetadata(u,u.currentSequenceNumber,i)));p.push(w)}return Ae.waitFor(p).next((()=>d.apply(u))).next((()=>t.localDocuments.getLocalViewOfDocuments(u,g,y))).next((()=>g))})).then((u=>(t.vs=l,u)))}function JA(n,e,t){let i=vs(),l=vs();return t.forEach((u=>i=i.add(u))),e.getEntries(n,i).next((u=>{let d=xi();return t.forEach(((p,g)=>{const y=u.get(p);g.isFoundDocument()!==y.isFoundDocument()&&(l=l.add(p)),g.isNoDocument()&&g.version.isEqual($t.min())?(e.removeEntry(p,g.readTime),d=d.insert(p,g)):!y.isValidDocument()||g.version.compareTo(y.version)>0||g.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(g),d=d.insert(p,g)):lt(fy,"Ignoring outdated watch update for ",p,". Current version:",y.version," Watch version:",g.version)})),{Bs:d,Ls:l}}))}function ZA(n,e){const t=Qt(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=ty),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function eI(n,e){const t=Qt(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let l;return t.li.getTargetData(i,e).next((u=>u?(l=u,Ae.resolve(l)):t.li.allocateTargetId(i).next((d=>(l=new to(e,d,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,l).next((()=>l)))))))})).then((i=>{const l=t.vs.get(i.targetId);return(l===null||i.snapshotVersion.compareTo(l.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function kg(n,e,t){const i=Qt(n),l=i.vs.get(e),u=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",u,(d=>i.persistence.referenceDelegate.removeTarget(d,l)))}catch(d){if(!lc(d))throw d;lt(fy,`Failed to update sequence numbers for target ${e}: ${d}`)}i.vs=i.vs.remove(e),i.Fs.delete(l.target)}function zx(n,e,t){const i=Qt(n);let l=$t.min(),u=vs();return i.persistence.runTransaction("Execute query","readwrite",(d=>(function(g,y,w){const k=Qt(g),j=k.Fs.get(w);return j!==void 0?Ae.resolve(k.vs.get(j)):k.li.getTargetData(y,w)})(i,d,za(e)).next((p=>{if(p)return l=p.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(d,p.targetId).next((g=>{u=g}))})).next((()=>i.Cs.getDocumentsMatchingQuery(d,e,t?l:$t.min(),t?u:vs()))).next((p=>(tI(i,zR(e),p),{documents:p,ks:u})))))}function tI(n,e,t){let i=n.Ms.get(e)||$t.min();t.forEach(((l,u)=>{u.readTime.compareTo(i)>0&&(i=u.readTime)})),n.Ms.set(e,i)}class Fx{constructor(){this.activeTargetIds=GR()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class sI{constructor(){this.vo=new Fx,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new Fx,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class nI{Mo(e){}shutdown(){}}const Hx="ConnectivityMonitor";class qx{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){lt(Hx,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){lt(Hx,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let rh=null;function jg(){return rh===null?rh=(function(){return 268435456+Math.round(2147483648*Math.random())})():rh++,"0x"+rh.toString(16)}const Ip="RestConnection",rI={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class aI{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),l=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${l}`,this.$o=this.databaseId.database===Ph?`project_id=${i}`:`project_id=${i}&database_id=${l}`}Wo(e,t,i,l,u){const d=jg(),p=this.Qo(e,t.toUriEncodedString());lt(Ip,`Sending RPC '${e}' ${d}:`,p,i);const g={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(g,l,u);const{host:y}=new URL(p),w=go(y);return this.zo(e,p,g,i,w).then((k=>(lt(Ip,`Received RPC '${e}' ${d}: `,k),k)),(k=>{throw Ql(Ip,`RPC '${e}' ${d} failed with error: `,k,"url: ",p,"request:",i),k}))}jo(e,t,i,l,u,d){return this.Wo(e,t,i,l,u)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+ic})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((l,u)=>e[u]=l)),i&&i.headers.forEach(((l,u)=>e[u]=l))}Qo(e,t){const i=rI[e];let l=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(l=`${l}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),l}terminate(){}}class iI{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const lr="WebChannelConnection",Qc=(n,e,t)=>{n.listen(e,(i=>{try{t(i)}catch(l){setTimeout((()=>{throw l}),0)}}))};class Kl extends aI{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Kl.c_){const e=zw();Qc(e,Uw.STAT_EVENT,(t=>{t.stat===hg.PROXY?lt(lr,"STAT_EVENT: detected buffering proxy"):t.stat===hg.NOPROXY&&lt(lr,"STAT_EVENT: detected no buffering proxy")})),Kl.c_=!0}}zo(e,t,i,l,u){const d=jg();return new Promise(((p,g)=>{const y=new Vw;y.setWithCredentials(!0),y.listenOnce(Bw.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case bh.NO_ERROR:const k=y.getResponseJson();lt(lr,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(k)),p(k);break;case bh.TIMEOUT:lt(lr,`RPC '${e}' ${d} timed out`),g(new nt(je.DEADLINE_EXCEEDED,"Request time out"));break;case bh.HTTP_ERROR:const j=y.getStatus();if(lt(lr,`RPC '${e}' ${d} failed with status:`,j,"response text:",y.getResponseText()),j>0){let O=y.getResponseJson();Array.isArray(O)&&(O=O[0]);const q=O?.error;if(q&&q.status&&q.message){const B=(function(ne){const K=ne.toLowerCase().replace(/_/g,"-");return Object.values(je).indexOf(K)>=0?K:je.UNKNOWN})(q.status);g(new nt(B,q.message))}else g(new nt(je.UNKNOWN,"Server responded with status "+y.getStatus()))}else g(new nt(je.UNAVAILABLE,"Connection failed."));break;default:Bt(9055,{l_:e,streamId:d,h_:y.getLastErrorCode(),P_:y.getLastError()})}}finally{lt(lr,`RPC '${e}' ${d} completed.`)}}));const w=JSON.stringify(l);lt(lr,`RPC '${e}' ${d} sending request:`,l),y.send(t,"POST",w,i,15)}))}T_(e,t,i){const l=jg(),u=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=this.createWebChannelTransport(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(p.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Go(p.initMessageHeaders,t,i),p.encodeInitMessageHeaders=!0;const y=u.join("");lt(lr,`Creating RPC '${e}' stream ${l}: ${y}`,p);const w=d.createWebChannel(y,p);this.I_(w);let k=!1,j=!1;const O=new iI({Ho:q=>{j?lt(lr,`Not sending because RPC '${e}' stream ${l} is closed:`,q):(k||(lt(lr,`Opening RPC '${e}' stream ${l} transport.`),w.open(),k=!0),lt(lr,`RPC '${e}' stream ${l} sending:`,q),w.send(q))},Jo:()=>w.close()});return Qc(w,nu.EventType.OPEN,(()=>{j||(lt(lr,`RPC '${e}' stream ${l} transport opened.`),O.i_())})),Qc(w,nu.EventType.CLOSE,(()=>{j||(j=!0,lt(lr,`RPC '${e}' stream ${l} transport closed`),O.o_(),this.E_(w))})),Qc(w,nu.EventType.ERROR,(q=>{j||(j=!0,Ql(lr,`RPC '${e}' stream ${l} transport errored. Name:`,q.name,"Message:",q.message),O.o_(new nt(je.UNAVAILABLE,"The operation could not be completed")))})),Qc(w,nu.EventType.MESSAGE,(q=>{if(!j){const B=q.data[0];Bs(!!B,16349);const V=B,ne=V?.error||V[0]?.error;if(ne){lt(lr,`RPC '${e}' stream ${l} received error:`,ne);const K=ne.status;let le=(function(Te){const R=Pn[Te];if(R!==void 0)return j_(R)})(K),ge=ne.message;le===void 0&&(le=je.INTERNAL,ge="Unknown error status: "+K+" with message "+ne.message),j=!0,O.o_(new nt(le,ge)),w.close()}else lt(lr,`RPC '${e}' stream ${l} received:`,B),O.__(B)}})),Kl.u_(),setTimeout((()=>{O.s_()}),0),O}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return Fw()}}function oI(n){return new Kl(n)}function Mp(){return typeof document<"u"?document:null}function hf(n){return new dA(n,!0)}Kl.c_=!1;class B_{constructor(e,t,i=1e3,l=1.5,u=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=l,this.V_=u,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),l=Math.max(0,t-i);l>0&&lt("ExponentialBackoff",`Backing off for ${l} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,l,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const $x="PersistentStream";class U_{constructor(e,t,i,l,u,d,p,g){this.Ci=e,this.b_=i,this.S_=l,this.connection=u,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=p,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new B_(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===je.RESOURCE_EXHAUSTED?(vi(t.toString()),vi("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===je.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,l])=>{this.D_===t&&this.G_(i,l)}),(i=>{e((()=>{const l=new nt(je.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(l)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((l=>{i((()=>this.z_(l)))})),this.stream.onMessage((l=>{i((()=>++this.F_==1?this.H_(l):this.onNext(l)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return lt($x,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(lt($x,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class lI extends U_{constructor(e,t,i,l,u,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=mA(this.serializer,e),i=(function(u){if(!("targetChange"in u))return $t.min();const d=u.targetChange;return d.targetIds&&d.targetIds.length?$t.min():d.readTime?Fa(d.readTime):$t.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=_g(this.serializer),t.addTarget=(function(u,d){let p;const g=d.target;if(p=yg(g)?{documents:yA(u,g)}:{query:bA(u,g).ft},p.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){p.resumeToken=N_(u,d.resumeToken);const y=vg(u,d.expectedCount);y!==null&&(p.expectedCount=y)}else if(d.snapshotVersion.compareTo($t.min())>0){p.readTime=Bh(u,d.snapshotVersion.toTimestamp());const y=vg(u,d.expectedCount);y!==null&&(p.expectedCount=y)}return p})(this.serializer,e);const i=xA(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=_g(this.serializer),t.removeTarget=e,this.K_(t)}}class cI extends U_{constructor(e,t,i,l,u,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return Bs(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Bs(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Bs(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=gA(e.writeResults,e.commitTime),i=Fa(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=_g(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>pA(this.serializer,i)))};this.K_(t)}}class uI{}class dI extends uI{constructor(e,t,i,l){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=l,this.ia=!1}sa(){if(this.ia)throw new nt(je.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,d])=>this.connection.Wo(e,xg(t,i),l,u,d))).catch((u=>{throw u.name==="FirebaseError"?(u.code===je.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new nt(je.UNKNOWN,u.toString())}))}jo(e,t,i,l,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,p])=>this.connection.jo(e,xg(t,i),l,d,p,u))).catch((d=>{throw d.name==="FirebaseError"?(d.code===je.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new nt(je.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function hI(n,e,t,i){return new dI(n,e,t,i)}class fI{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(vi(t),this.aa=!1):lt("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const el="RemoteStore";class mI{constructor(e,t,i,l,u){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=u,this.Aa.Mo((d=>{i.enqueueAndForget((async()=>{al(this)&&(lt(el,"Restarting streams for network reachability change."),await(async function(g){const y=Qt(g);y.Ea.add(4),await Uu(y),y.Va.set("Unknown"),y.Ea.delete(4),await ff(y)})(this))}))})),this.Va=new fI(i,l)}}async function ff(n){if(al(n))for(const e of n.Ra)await e(!0)}async function Uu(n){for(const e of n.Ra)await e(!1)}function z_(n,e){const t=Qt(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),yy(t)?gy(t):uc(t).O_()&&py(t,e))}function my(n,e){const t=Qt(n),i=uc(t);t.Ia.delete(e),i.O_()&&F_(t,e),t.Ia.size===0&&(i.O_()?i.L_():al(t)&&t.Va.set("Unknown"))}function py(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo($t.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}uc(n).Z_(e)}function F_(n,e){n.da.$e(e),uc(n).X_(e)}function gy(n){n.da=new oA({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),uc(n).start(),n.Va.ua()}function yy(n){return al(n)&&!uc(n).x_()&&n.Ia.size>0}function al(n){return Qt(n).Ea.size===0}function H_(n){n.da=void 0}async function pI(n){n.Va.set("Online")}async function gI(n){n.Ia.forEach(((e,t)=>{py(n,e)}))}async function yI(n,e){H_(n),yy(n)?(n.Va.ha(e),gy(n)):n.Va.set("Unknown")}async function bI(n,e,t){if(n.Va.set("Online"),e instanceof E_&&e.state===2&&e.cause)try{await(async function(l,u){const d=u.cause;for(const p of u.targetIds)l.Ia.has(p)&&(await l.remoteSyncer.rejectListen(p,d),l.Ia.delete(p),l.da.removeTarget(p))})(n,e)}catch(i){lt(el,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await zh(n,i)}else if(e instanceof _h?n.da.Xe(e):e instanceof T_?n.da.st(e):n.da.tt(e),!t.isEqual($t.min()))try{const i=await V_(n.localStore);t.compareTo(i)>=0&&await(function(u,d){const p=u.da.Tt(d);return p.targetChanges.forEach(((g,y)=>{if(g.resumeToken.approximateByteSize()>0){const w=u.Ia.get(y);w&&u.Ia.set(y,w.withResumeToken(g.resumeToken,d))}})),p.targetMismatches.forEach(((g,y)=>{const w=u.Ia.get(g);if(!w)return;u.Ia.set(g,w.withResumeToken(ar.EMPTY_BYTE_STRING,w.snapshotVersion)),F_(u,g);const k=new to(w.target,g,y,w.sequenceNumber);py(u,k)})),u.remoteSyncer.applyRemoteEvent(p)})(n,t)}catch(i){lt(el,"Failed to raise snapshot:",i),await zh(n,i)}}async function zh(n,e,t){if(!lc(e))throw e;n.Ea.add(1),await Uu(n),n.Va.set("Offline"),t||(t=()=>V_(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{lt(el,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await ff(n)}))}function q_(n,e){return e().catch((t=>zh(n,t,e)))}async function mf(n){const e=Qt(n),t=mo(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:ty;for(;vI(e);)try{const l=await ZA(e.localStore,i);if(l===null){e.Ta.length===0&&t.L_();break}i=l.batchId,xI(e,l)}catch(l){await zh(e,l)}$_(e)&&W_(e)}function vI(n){return al(n)&&n.Ta.length<10}function xI(n,e){n.Ta.push(e);const t=mo(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function $_(n){return al(n)&&!mo(n).x_()&&n.Ta.length>0}function W_(n){mo(n).start()}async function wI(n){mo(n).ra()}async function _I(n){const e=mo(n);for(const t of n.Ta)e.ea(t.mutations)}async function kI(n,e,t){const i=n.Ta.shift(),l=oy.from(i,e,t);await q_(n,(()=>n.remoteSyncer.applySuccessfulWrite(l))),await mf(n)}async function jI(n,e){e&&mo(n).Y_&&await(async function(i,l){if((function(d){return rA(d)&&d!==je.ABORTED})(l.code)){const u=i.Ta.shift();mo(i).B_(),await q_(i,(()=>i.remoteSyncer.rejectFailedWrite(u.batchId,l))),await mf(i)}})(n,e),$_(n)&&W_(n)}async function Wx(n,e){const t=Qt(n);t.asyncQueue.verifyOperationInProgress(),lt(el,"RemoteStore received new credentials");const i=al(t);t.Ea.add(3),await Uu(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await ff(t)}async function TI(n,e){const t=Qt(n);e?(t.Ea.delete(2),await ff(t)):e||(t.Ea.add(2),await Uu(t),t.Va.set("Unknown"))}function uc(n){return n.ma||(n.ma=(function(t,i,l){const u=Qt(t);return u.sa(),new lI(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(n.datastore,n.asyncQueue,{Zo:pI.bind(null,n),Yo:gI.bind(null,n),t_:yI.bind(null,n),J_:bI.bind(null,n)}),n.Ra.push((async e=>{e?(n.ma.B_(),yy(n)?gy(n):n.Va.set("Unknown")):(await n.ma.stop(),H_(n))}))),n.ma}function mo(n){return n.fa||(n.fa=(function(t,i,l){const u=Qt(t);return u.sa(),new cI(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:wI.bind(null,n),t_:jI.bind(null,n),ta:_I.bind(null,n),na:kI.bind(null,n)}),n.Ra.push((async e=>{e?(n.fa.B_(),await mf(n)):(await n.fa.stop(),n.Ta.length>0&&(lt(el,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class by{constructor(e,t,i,l,u){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=l,this.removalCallback=u,this.deferred=new mi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,l,u){const d=Date.now()+i,p=new by(e,t,d,l,u);return p.start(i),p}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new nt(je.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function vy(n,e){if(vi("AsyncQueue",`${e}: ${n}`),lc(n))return new nt(je.UNAVAILABLE,`${e}: ${n}`);throw n}class Yl{static emptySet(e){return new Yl(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Nt.comparator(t.key,i.key):(t,i)=>Nt.comparator(t.key,i.key),this.keyedMap=ru(),this.sortedSet=new pn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Yl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(!l.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Yl;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class Gx{constructor(){this.ga=new pn(Nt.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Bt(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class tc{constructor(e,t,i,l,u,d,p,g,y){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=l,this.mutatedKeys=u,this.fromCache=d,this.syncStateChanged=p,this.excludesMetadataChanges=g,this.hasCachedResults=y}static fromInitialDocuments(e,t,i,l,u){const d=[];return t.forEach((p=>{d.push({type:0,doc:p})})),new tc(e,t,Yl.emptySet(t),d,i,l,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&af(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let l=0;l<t.length;l++)if(t[l].type!==i[l].type||!t[l].doc.isEqual(i[l].doc))return!1;return!0}}class EI{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class NI{constructor(){this.queries=Kx(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const l=Qt(t),u=l.queries;l.queries=Kx(),u.forEach(((d,p)=>{for(const g of p.ba)g.onError(i)}))})(this,new nt(je.ABORTED,"Firestore shutting down"))}}function Kx(){return new rl((n=>u_(n)),af)}async function xy(n,e){const t=Qt(n);let i=3;const l=e.query;let u=t.queries.get(l);u?!u.Sa()&&e.Da()&&(i=2):(u=new EI,i=e.Da()?0:1);try{switch(i){case 0:u.wa=await t.onListen(l,!0);break;case 1:u.wa=await t.onListen(l,!1);break;case 2:await t.onFirstRemoteStoreListen(l)}}catch(d){const p=vy(d,`Initialization of query '${zl(e.query)}' failed`);return void e.onError(p)}t.queries.set(l,u),u.ba.push(e),e.va(t.onlineState),u.wa&&e.Fa(u.wa)&&_y(t)}async function wy(n,e){const t=Qt(n),i=e.query;let l=3;const u=t.queries.get(i);if(u){const d=u.ba.indexOf(e);d>=0&&(u.ba.splice(d,1),u.ba.length===0?l=e.Da()?0:1:!u.Sa()&&e.Da()&&(l=2))}switch(l){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function SI(n,e){const t=Qt(n);let i=!1;for(const l of e){const u=l.query,d=t.queries.get(u);if(d){for(const p of d.ba)p.Fa(l)&&(i=!0);d.wa=l}}i&&_y(t)}function CI(n,e,t){const i=Qt(n),l=i.queries.get(e);if(l)for(const u of l.ba)u.onError(t);i.queries.delete(e)}function _y(n){n.Ca.forEach((e=>{e.next()}))}var Tg,Yx;(Yx=Tg||(Tg={})).Ma="default",Yx.Cache="cache";class ky{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const l of e.docChanges)l.type!==3&&i.push(l);e=new tc(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=tc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Tg.Cache}}class G_{constructor(e){this.key=e}}class K_{constructor(e){this.key=e}}class RI{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=vs(),this.mutatedKeys=vs(),this.eu=d_(e),this.tu=new Yl(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new Gx,l=t?t.tu:this.tu;let u=t?t.mutatedKeys:this.mutatedKeys,d=l,p=!1;const g=this.query.limitType==="F"&&l.size===this.query.limit?l.last():null,y=this.query.limitType==="L"&&l.size===this.query.limit?l.first():null;if(e.inorderTraversal(((w,k)=>{const j=l.get(w),O=of(this.query,k)?k:null,q=!!j&&this.mutatedKeys.has(j.key),B=!!O&&(O.hasLocalMutations||this.mutatedKeys.has(O.key)&&O.hasCommittedMutations);let V=!1;j&&O?j.data.isEqual(O.data)?q!==B&&(i.track({type:3,doc:O}),V=!0):this.su(j,O)||(i.track({type:2,doc:O}),V=!0,(g&&this.eu(O,g)>0||y&&this.eu(O,y)<0)&&(p=!0)):!j&&O?(i.track({type:0,doc:O}),V=!0):j&&!O&&(i.track({type:1,doc:j}),V=!0,(g||y)&&(p=!0)),V&&(O?(d=d.add(O),u=B?u.add(w):u.delete(w)):(d=d.delete(w),u=u.delete(w)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const w=this.query.limitType==="F"?d.last():d.first();d=d.delete(w.key),u=u.delete(w.key),i.track({type:1,doc:w})}return{tu:d,iu:i,Ss:p,mutatedKeys:u}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,l){const u=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((w,k)=>(function(O,q){const B=V=>{switch(V){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Bt(20277,{Vt:V})}};return B(O)-B(q)})(w.type,k.type)||this.eu(w.doc,k.doc))),this.ou(i),l=l??!1;const p=t&&!l?this._u():[],g=this.Ya.size===0&&this.current&&!l?1:0,y=g!==this.Xa;return this.Xa=g,d.length!==0||y?{snapshot:new tc(this.query,e.tu,u,d,e.mutatedKeys,g===0,y,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:p}:{au:p}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Gx,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=vs(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new K_(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new G_(i))})),t}cu(e){this.Za=e.ks,this.Ya=vs();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return tc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const jy="SyncEngine";class AI{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class II{constructor(e){this.key=e,this.hu=!1}}class MI{constructor(e,t,i,l,u,d){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=l,this.currentUser=u,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new rl((p=>u_(p)),af),this.Iu=new Map,this.Eu=new Set,this.Ru=new pn(Nt.comparator),this.Au=new Map,this.Vu=new uy,this.du={},this.mu=new Map,this.fu=ec.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function DI(n,e,t=!0){const i=ek(n);let l;const u=i.Tu.get(e);return u?(i.sharedClientState.addLocalQueryTarget(u.targetId),l=u.view.lu()):l=await Y_(i,e,t,!0),l}async function PI(n,e){const t=ek(n);await Y_(t,e,!0,!1)}async function Y_(n,e,t,i){const l=await eI(n.localStore,za(e)),u=l.targetId,d=n.sharedClientState.addLocalQueryTarget(u,t);let p;return i&&(p=await LI(n,e,u,d==="current",l.resumeToken)),n.isPrimaryClient&&t&&z_(n.remoteStore,l),p}async function LI(n,e,t,i,l){n.pu=(k,j,O)=>(async function(B,V,ne,K){let le=V.view.ru(ne);le.Ss&&(le=await zx(B.localStore,V.query,!1).then((({documents:R})=>V.view.ru(R,le))));const ge=K&&K.targetChanges.get(V.targetId),Ie=K&&K.targetMismatches.get(V.targetId)!=null,Te=V.view.applyChanges(le,B.isPrimaryClient,ge,Ie);return Xx(B,V.targetId,Te.au),Te.snapshot})(n,k,j,O);const u=await zx(n.localStore,e,!0),d=new RI(e,u.ks),p=d.ru(u.documents),g=Bu.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",l),y=d.applyChanges(p,n.isPrimaryClient,g);Xx(n,t,y.au);const w=new AI(e,t,d);return n.Tu.set(e,w),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),y.snapshot}async function OI(n,e,t){const i=Qt(n),l=i.Tu.get(e),u=i.Iu.get(l.targetId);if(u.length>1)return i.Iu.set(l.targetId,u.filter((d=>!af(d,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(l.targetId),i.sharedClientState.isActiveQueryTarget(l.targetId)||await kg(i.localStore,l.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(l.targetId),t&&my(i.remoteStore,l.targetId),Eg(i,l.targetId)})).catch(oc)):(Eg(i,l.targetId),await kg(i.localStore,l.targetId,!0))}async function VI(n,e){const t=Qt(n),i=t.Tu.get(e),l=t.Iu.get(i.targetId);t.isPrimaryClient&&l.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),my(t.remoteStore,i.targetId))}async function BI(n,e,t){const i=WI(n);try{const l=await(function(d,p){const g=Qt(d),y=vt.now(),w=p.reduce(((O,q)=>O.add(q.key)),vs());let k,j;return g.persistence.runTransaction("Locally write mutations","readwrite",(O=>{let q=xi(),B=vs();return g.xs.getEntries(O,w).next((V=>{q=V,q.forEach(((ne,K)=>{K.isValidDocument()||(B=B.add(ne))}))})).next((()=>g.localDocuments.getOverlayedDocuments(O,q))).next((V=>{k=V;const ne=[];for(const K of p){const le=ZR(K,k.get(K.key).overlayedDocument);le!=null&&ne.push(new vo(K.key,le,s_(le.value.mapValue),_r.exists(!0)))}return g.mutationQueue.addMutationBatch(O,y,ne,p)})).next((V=>{j=V;const ne=V.applyToLocalDocumentSet(k,B);return g.documentOverlayCache.saveOverlays(O,V.batchId,ne)}))})).then((()=>({batchId:j.batchId,changes:f_(k)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(l.batchId),(function(d,p,g){let y=d.du[d.currentUser.toKey()];y||(y=new pn(bs)),y=y.insert(p,g),d.du[d.currentUser.toKey()]=y})(i,l.batchId,t),await zu(i,l.changes),await mf(i.remoteStore)}catch(l){const u=vy(l,"Failed to persist write");t.reject(u)}}async function Q_(n,e){const t=Qt(n);try{const i=await XA(t.localStore,e);e.targetChanges.forEach(((l,u)=>{const d=t.Au.get(u);d&&(Bs(l.addedDocuments.size+l.modifiedDocuments.size+l.removedDocuments.size<=1,22616),l.addedDocuments.size>0?d.hu=!0:l.modifiedDocuments.size>0?Bs(d.hu,14607):l.removedDocuments.size>0&&(Bs(d.hu,42227),d.hu=!1))})),await zu(t,i,e)}catch(i){await oc(i)}}function Qx(n,e,t){const i=Qt(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const l=[];i.Tu.forEach(((u,d)=>{const p=d.view.va(e);p.snapshot&&l.push(p.snapshot)})),(function(d,p){const g=Qt(d);g.onlineState=p;let y=!1;g.queries.forEach(((w,k)=>{for(const j of k.ba)j.va(p)&&(y=!0)})),y&&_y(g)})(i.eventManager,e),l.length&&i.Pu.J_(l),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function UI(n,e,t){const i=Qt(n);i.sharedClientState.updateQueryState(e,"rejected",t);const l=i.Au.get(e),u=l&&l.key;if(u){let d=new pn(Nt.comparator);d=d.insert(u,ur.newNoDocument(u,$t.min()));const p=vs().add(u),g=new df($t.min(),new Map,new pn(bs),d,p);await Q_(i,g),i.Ru=i.Ru.remove(u),i.Au.delete(e),Ty(i)}else await kg(i.localStore,e,!1).then((()=>Eg(i,e,t))).catch(oc)}async function zI(n,e){const t=Qt(n),i=e.batch.batchId;try{const l=await QA(t.localStore,e);J_(t,i,null),X_(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await zu(t,l)}catch(l){await oc(l)}}async function FI(n,e,t){const i=Qt(n);try{const l=await(function(d,p){const g=Qt(d);return g.persistence.runTransaction("Reject batch","readwrite-primary",(y=>{let w;return g.mutationQueue.lookupMutationBatch(y,p).next((k=>(Bs(k!==null,37113),w=k.keys(),g.mutationQueue.removeMutationBatch(y,k)))).next((()=>g.mutationQueue.performConsistencyCheck(y))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(y,w,p))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,w))).next((()=>g.localDocuments.getDocuments(y,w)))}))})(i.localStore,e);J_(i,e,t),X_(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await zu(i,l)}catch(l){await oc(l)}}function X_(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function J_(n,e,t){const i=Qt(n);let l=i.du[i.currentUser.toKey()];if(l){const u=l.get(e);u&&(t?u.reject(t):u.resolve(),l=l.remove(e)),i.du[i.currentUser.toKey()]=l}}function Eg(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach((i=>{n.Vu.containsKey(i)||Z_(n,i)}))}function Z_(n,e){n.Eu.delete(e.path.canonicalString());const t=n.Ru.get(e);t!==null&&(my(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),Ty(n))}function Xx(n,e,t){for(const i of t)i instanceof G_?(n.Vu.addReference(i.key,e),HI(n,i)):i instanceof K_?(lt(jy,"Document no longer in limbo: "+i.key),n.Vu.removeReference(i.key,e),n.Vu.containsKey(i.key)||Z_(n,i.key)):Bt(19791,{wu:i})}function HI(n,e){const t=e.key,i=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(i)||(lt(jy,"New document in limbo: "+t),n.Eu.add(i),Ty(n))}function Ty(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Nt(en.fromString(e)),i=n.fu.next();n.Au.set(i,new II(t)),n.Ru=n.Ru.insert(t,i),z_(n.remoteStore,new to(za(rf(t.path)),i,"TargetPurposeLimboResolution",tf.ce))}}async function zu(n,e,t){const i=Qt(n),l=[],u=[],d=[];i.Tu.isEmpty()||(i.Tu.forEach(((p,g)=>{d.push(i.pu(g,e,t).then((y=>{if((y||t)&&i.isPrimaryClient){const w=y?!y.fromCache:t?.targetChanges.get(g.targetId)?.current;i.sharedClientState.updateQueryState(g.targetId,w?"current":"not-current")}if(y){l.push(y);const w=hy.Es(g.targetId,y);u.push(w)}})))})),await Promise.all(d),i.Pu.J_(l),await(async function(g,y){const w=Qt(g);try{await w.persistence.runTransaction("notifyLocalViewChanges","readwrite",(k=>Ae.forEach(y,(j=>Ae.forEach(j.Ts,(O=>w.persistence.referenceDelegate.addReference(k,j.targetId,O))).next((()=>Ae.forEach(j.Is,(O=>w.persistence.referenceDelegate.removeReference(k,j.targetId,O)))))))))}catch(k){if(!lc(k))throw k;lt(fy,"Failed to update sequence numbers: "+k)}for(const k of y){const j=k.targetId;if(!k.fromCache){const O=w.vs.get(j),q=O.snapshotVersion,B=O.withLastLimboFreeSnapshotVersion(q);w.vs=w.vs.insert(j,B)}}})(i.localStore,u))}async function qI(n,e){const t=Qt(n);if(!t.currentUser.isEqual(e)){lt(jy,"User change. New user:",e.toKey());const i=await O_(t.localStore,e);t.currentUser=e,(function(u,d){u.mu.forEach((p=>{p.forEach((g=>{g.reject(new nt(je.CANCELLED,d))}))})),u.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await zu(t,i.Ns)}}function $I(n,e){const t=Qt(n),i=t.Au.get(e);if(i&&i.hu)return vs().add(i.key);{let l=vs();const u=t.Iu.get(e);if(!u)return l;for(const d of u){const p=t.Tu.get(d);l=l.unionWith(p.view.nu)}return l}}function ek(n){const e=Qt(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Q_.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=$I.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=UI.bind(null,e),e.Pu.J_=SI.bind(null,e.eventManager),e.Pu.yu=CI.bind(null,e.eventManager),e}function WI(n){const e=Qt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=zI.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=FI.bind(null,e),e}class Fh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=hf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return YA(this.persistence,new WA,e.initialUser,this.serializer)}Cu(e){return new L_(dy.Vi,this.serializer)}Du(e){return new sI}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Fh.provider={build:()=>new Fh};class GI extends Fh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Bs(this.persistence.referenceDelegate instanceof Uh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new AA(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Mr.withCacheSize(this.cacheSizeBytes):Mr.DEFAULT;return new L_((i=>Uh.Vi(i,t)),this.serializer)}}class Ng{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Qx(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=qI.bind(null,this.syncEngine),await TI(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new NI})()}createDatastore(e){const t=hf(e.databaseInfo.databaseId),i=oI(e.databaseInfo);return hI(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,l,u,d,p){return new mI(i,l,u,d,p)})(this.localStore,this.datastore,e.asyncQueue,(t=>Qx(this.syncEngine,t,0)),(function(){return qx.v()?new qx:new nI})())}createSyncEngine(e,t){return(function(l,u,d,p,g,y,w){const k=new MI(l,u,d,p,g,y);return w&&(k.gu=!0),k})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=Qt(t);lt(el,"RemoteStore shutting down."),i.Ea.add(5),await Uu(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Ng.provider={build:()=>new Ng};class Ey{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):vi("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const po="FirestoreClient";class KI{constructor(e,t,i,l,u){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=l,this.user=cr.UNAUTHENTICATED,this.clientId=ey.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(i,(async d=>{lt(po,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(i,(d=>(lt(po,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new mi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=vy(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Dp(n,e){n.asyncQueue.verifyOperationInProgress(),lt(po,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async l=>{i.isEqual(l)||(await O_(e.localStore,l),i=l)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function Jx(n,e){n.asyncQueue.verifyOperationInProgress();const t=await YI(n);lt(po,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>Wx(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,l)=>Wx(e.remoteStore,l))),n._onlineComponents=e}async function YI(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){lt(po,"Using user provided OfflineComponentProvider");try{await Dp(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(l){return l.name==="FirebaseError"?l.code===je.FAILED_PRECONDITION||l.code===je.UNIMPLEMENTED:!(typeof DOMException<"u"&&l instanceof DOMException)||l.code===22||l.code===20||l.code===11})(t))throw t;Ql("Error using user provided cache. Falling back to memory cache: "+t),await Dp(n,new Fh)}}else lt(po,"Using default OfflineComponentProvider"),await Dp(n,new GI(void 0));return n._offlineComponents}async function tk(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(lt(po,"Using user provided OnlineComponentProvider"),await Jx(n,n._uninitializedComponentsProvider._online)):(lt(po,"Using default OnlineComponentProvider"),await Jx(n,new Ng))),n._onlineComponents}function QI(n){return tk(n).then((e=>e.syncEngine))}async function Hh(n){const e=await tk(n),t=e.eventManager;return t.onListen=DI.bind(null,e.syncEngine),t.onUnlisten=OI.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=PI.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=VI.bind(null,e.syncEngine),t}function XI(n,e,t,i){const l=new Ey(i),u=new ky(e,l,t);return n.asyncQueue.enqueueAndForget((async()=>xy(await Hh(n),u))),()=>{l.Nu(),n.asyncQueue.enqueueAndForget((async()=>wy(await Hh(n),u)))}}function JI(n,e,t={}){const i=new mi;return n.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,y){const w=new Ey({next:j=>{w.Nu(),d.enqueueAndForget((()=>wy(u,k)));const O=j.docs.has(p);!O&&j.fromCache?y.reject(new nt(je.UNAVAILABLE,"Failed to get document because the client is offline.")):O&&j.fromCache&&g&&g.source==="server"?y.reject(new nt(je.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(j)},error:j=>y.reject(j)}),k=new ky(rf(p.path),w,{includeMetadataChanges:!0,Ka:!0});return xy(u,k)})(await Hh(n),n.asyncQueue,e,t,i))),i.promise}function ZI(n,e,t={}){const i=new mi;return n.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,y){const w=new Ey({next:j=>{w.Nu(),d.enqueueAndForget((()=>wy(u,k))),j.fromCache&&g.source==="server"?y.reject(new nt(je.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(j)},error:j=>y.reject(j)}),k=new ky(p,w,{includeMetadataChanges:!0,Ka:!0});return xy(u,k)})(await Hh(n),n.asyncQueue,e,t,i))),i.promise}function e3(n,e){const t=new mi;return n.asyncQueue.enqueueAndForget((async()=>BI(await QI(n),e,t))),t.promise}function sk(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const t3="ComponentProvider",Zx=new Map;function s3(n,e,t,i,l){return new _R(n,e,t,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,sk(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator,i)}const nk="firestore.googleapis.com",e2=!0;class t2{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new nt(je.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=nk,this.ssl=e2}else this.host=e.host,this.ssl=e.ssl??e2;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=P_;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<CA)throw new nt(je.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}uR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=sk(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new nt(je.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new nt(je.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new nt(je.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,l){return i.timeoutSeconds===l.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class pf{constructor(e,t,i,l){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=l,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new t2({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new nt(je.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new nt(je.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new t2(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new eR;switch(i.type){case"firstParty":return new rR(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new nt(je.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=Zx.get(t);i&&(lt(t3,"Removing Datastore"),Zx.delete(t),i.terminate())})(this),Promise.resolve()}}function n3(n,e,t,i={}){n=wr(n,pf);const l=go(e),u=n._getSettings(),d={...u,emulatorOptions:n._getEmulatorOptions()},p=`${e}:${t}`;l&&(Vg(`https://${p}`),Bg("Firestore",!0)),u.host!==nk&&u.host!==p&&Ql("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...u,host:p,ssl:l,emulatorOptions:i};if(!Yo(g,d)&&(n._setSettings(g),i.mockUserToken)){let y,w;if(typeof i.mockUserToken=="string")y=i.mockUserToken,w=cr.MOCK_USER;else{y=X2(i.mockUserToken,n._app?.options.projectId);const k=i.mockUserToken.sub||i.mockUserToken.user_id;if(!k)throw new nt(je.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");w=new cr(k)}n._authCredentials=new tR(new qw(y,w))}}class ki{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new ki(this.firestore,e,this._query)}}class wn{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new oo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new wn(this.firestore,e,this._key)}toJSON(){return{type:wn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Ou(t,wn._jsonSchema))return new wn(e,i||null,new Nt(en.fromString(t.referencePath)))}}wn._jsonSchemaVersion="firestore/documentReference/1.0",wn._jsonSchema={type:On("string",wn._jsonSchemaVersion),referencePath:On("string")};class oo extends ki{constructor(e,t,i){super(e,t,rf(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new wn(this.firestore,null,new Nt(e))}withConverter(e){return new oo(this.firestore,e,this._path)}}function Ht(n,e,...t){if(n=Gs(n),$w("collection","path",e),n instanceof pf){const i=en.fromString(e,...t);return mx(i),new oo(n,null,i)}{if(!(n instanceof wn||n instanceof oo))throw new nt(je.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(en.fromString(e,...t));return mx(i),new oo(n.firestore,null,i)}}function He(n,e,...t){if(n=Gs(n),arguments.length===1&&(e=ey.newId()),$w("doc","path",e),n instanceof pf){const i=en.fromString(e,...t);return fx(i),new wn(n,null,new Nt(i))}{if(!(n instanceof wn||n instanceof oo))throw new nt(je.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(en.fromString(e,...t));return fx(i),new wn(n.firestore,n instanceof oo?n.converter:null,new Nt(i))}}const s2="AsyncQueue";class n2{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new B_(this,"async_queue_retry"),this._c=()=>{const i=Mp();i&&lt(s2,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Mp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Mp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new mi;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!lc(e))throw e;lt(s2,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,vi("INTERNAL UNHANDLED ERROR: ",r2(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const l=by.createAndSchedule(this,e,t,i,(u=>this.hc(u)));return this.tc.push(l),l}uc(){this.nc&&Bt(47125,{Pc:r2(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function r2(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class $a extends pf{constructor(e,t,i,l){super(e,t,i,l),this.type="firestore",this._queue=new n2,this._persistenceKey=l?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new n2(e),this._firestoreClient=void 0,await e}}}function r3(n,e){const t=typeof n=="object"?n:Hg(),i=typeof n=="string"?n:Ph,l=Qh(t,"firestore").getImmediate({identifier:i});if(!l._initialized){const u=K2("firestore");u&&n3(l,...u)}return l}function Fu(n){if(n._terminated)throw new nt(je.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||a3(n),n._firestoreClient}function a3(n){const e=n._freezeSettings(),t=s3(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new KI(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(l){const u=l?._online.build();return{_offline:l?._offline.build(u),_online:u}})(n._componentsProvider))}class ia{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ia(ar.fromBase64String(e))}catch(t){throw new nt(je.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ia(ar.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ia._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ou(e,ia._jsonSchema))return ia.fromBase64String(e.bytes)}}ia._jsonSchemaVersion="firestore/bytes/1.0",ia._jsonSchema={type:On("string",ia._jsonSchemaVersion),bytes:On("string")};class gf{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new nt(je.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new rr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Hu{constructor(e){this._methodName=e}}class Ha{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new nt(je.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new nt(je.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return bs(this._lat,e._lat)||bs(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ha._jsonSchemaVersion}}static fromJSON(e){if(Ou(e,Ha._jsonSchema))return new Ha(e.latitude,e.longitude)}}Ha._jsonSchemaVersion="firestore/geoPoint/1.0",Ha._jsonSchema={type:On("string",Ha._jsonSchemaVersion),latitude:On("number"),longitude:On("number")};class va{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,l){if(i.length!==l.length)return!1;for(let u=0;u<i.length;++u)if(i[u]!==l[u])return!1;return!0})(this._values,e._values)}toJSON(){return{type:va._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ou(e,va._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new va(e.vectorValues);throw new nt(je.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}va._jsonSchemaVersion="firestore/vectorValue/1.0",va._jsonSchema={type:On("string",va._jsonSchemaVersion),vectorValues:On("object")};const i3=/^__.*__$/;class o3{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new vo(e,this.data,this.fieldMask,t,this.fieldTransforms):new Vu(e,this.data,t,this.fieldTransforms)}}class rk{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new vo(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function ak(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Bt(40011,{dataSource:n})}}class Ny{constructor(e,t,i,l,u,d){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=l,u===void 0&&this.validatePath(),this.fieldTransforms=u||[],this.fieldMask=d||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Ny({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return qh(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(ak(this.dataSource)&&i3.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class l3{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||hf(e)}createContext(e,t,i,l=!1){return new Ny({dataSource:e,methodName:t,targetDoc:i,path:rr.emptyPath(),arrayElement:!1,hasConverter:l},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function qu(n){const e=n._freezeSettings(),t=hf(n._databaseId);return new l3(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Sy(n,e,t,i,l,u={}){const d=n.createContext(u.merge||u.mergeFields?2:0,e,t,l);Ay("Data must be an object, but it was:",d,i);const p=lk(i,d);let g,y;if(u.merge)g=new Gr(d.fieldMask),y=d.fieldTransforms;else if(u.mergeFields){const w=[];for(const k of u.mergeFields){const j=tl(e,k,t);if(!d.contains(j))throw new nt(je.INVALID_ARGUMENT,`Field '${j}' is specified in your field mask but missing from your input data.`);dk(w,j)||w.push(j)}g=new Gr(w),y=d.fieldTransforms.filter((k=>g.covers(k.field)))}else g=null,y=d.fieldTransforms;return new o3(new Dr(p),g,y)}class yf extends Hu{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof yf}}class Cy extends Hu{_toFieldTransform(e){return new w_(e.path,new Tu)}isEqual(e){return e instanceof Cy}}class Ry extends Hu{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new Su(e.serializer,g_(e.serializer,this.Vc));return new w_(e.path,t)}isEqual(e){return e instanceof Ry&&this.Vc===e.Vc}}function ik(n,e,t,i){const l=n.createContext(1,e,t);Ay("Data must be an object, but it was:",l,i);const u=[],d=Dr.empty();bo(i,((g,y)=>{const w=uk(e,g,t);y=Gs(y);const k=l.childContextForFieldPath(w);if(y instanceof yf)u.push(w);else{const j=$u(y,k);j!=null&&(u.push(w),d.set(w,j))}}));const p=new Gr(u);return new rk(d,p,l.fieldTransforms)}function ok(n,e,t,i,l,u){const d=n.createContext(1,e,t),p=[tl(e,i,t)],g=[l];if(u.length%2!=0)throw new nt(je.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let j=0;j<u.length;j+=2)p.push(tl(e,u[j])),g.push(u[j+1]);const y=[],w=Dr.empty();for(let j=p.length-1;j>=0;--j)if(!dk(y,p[j])){const O=p[j];let q=g[j];q=Gs(q);const B=d.childContextForFieldPath(O);if(q instanceof yf)y.push(O);else{const V=$u(q,B);V!=null&&(y.push(O),w.set(O,V))}}const k=new Gr(y);return new rk(w,k,d.fieldTransforms)}function c3(n,e,t,i=!1){return $u(t,n.createContext(i?4:3,e))}function $u(n,e){if(ck(n=Gs(n)))return Ay("Unsupported field value:",e,n),lk(n,e);if(n instanceof Hu)return(function(i,l){if(!ak(l.dataSource))throw l.createError(`${i._methodName}() can only be used with update() and set()`);if(!l.path)throw l.createError(`${i._methodName}() is not currently supported inside arrays`);const u=i._toFieldTransform(l);u&&l.fieldTransforms.push(u)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,l){const u=[];let d=0;for(const p of i){let g=$u(p,l.childContextForArray(d));g==null&&(g={nullValue:"NULL_VALUE"}),u.push(g),d++}return{arrayValue:{values:u}}})(n,e)}return(function(i,l){if((i=Gs(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return g_(l.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const u=vt.fromDate(i);return{timestampValue:Bh(l.serializer,u)}}if(i instanceof vt){const u=new vt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Bh(l.serializer,u)}}if(i instanceof Ha)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof ia)return{bytesValue:N_(l.serializer,i._byteString)};if(i instanceof wn){const u=l.databaseId,d=i.firestore._databaseId;if(!d.isEqual(u))throw l.createError(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:cy(i.firestore._databaseId||l.databaseId,i._key.path)}}if(i instanceof va)return(function(d,p){const g=d instanceof va?d.toArray():d;return{mapValue:{fields:{[e_]:{stringValue:t_},[Lh]:{arrayValue:{values:g.map((w=>{if(typeof w!="number")throw p.createError("VectorValues must only contain numeric values.");return iy(p.serializer,w)}))}}}}}})(i,l);if(D_(i))return i._toProto(l.serializer);throw l.createError(`Unsupported field value: ${ef(i)}`)})(n,e)}function lk(n,e){const t={};return Kw(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):bo(n,((i,l)=>{const u=$u(l,e.childContextForField(i));u!=null&&(t[i]=u)})),{mapValue:{fields:t}}}function ck(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof vt||n instanceof Ha||n instanceof ia||n instanceof wn||n instanceof Hu||n instanceof va||D_(n))}function Ay(n,e,t){if(!ck(t)||!Ww(t)){const i=ef(t);throw i==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+i)}}function tl(n,e,t){if((e=Gs(e))instanceof gf)return e._internalPath;if(typeof e=="string")return uk(n,e);throw qh("Field path arguments must be of type string or ",n,!1,void 0,t)}const u3=new RegExp("[~\\*/\\[\\]]");function uk(n,e,t){if(e.search(u3)>=0)throw qh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new gf(...e.split("."))._internalPath}catch{throw qh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function qh(n,e,t,i,l){const u=i&&!i.isEmpty(),d=l!==void 0;let p=`Function ${e}() called with invalid data`;t&&(p+=" (via `toFirestore()`)"),p+=". ";let g="";return(u||d)&&(g+=" (found",u&&(g+=` in field ${i}`),d&&(g+=` in document ${l}`),g+=")"),new nt(je.INVALID_ARGUMENT,p+n+g)}function dk(n,e){return n.some((t=>t.isEqual(e)))}class d3{convertValue(e,t="none"){switch(fo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Sn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ho(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Bt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return bo(e,((l,u)=>{i[l]=this.convertValue(u,t)})),i}convertVectorValue(e){const t=e.fields?.[Lh].arrayValue?.values?.map((i=>Sn(i.doubleValue)));return new va(t)}convertGeoPoint(e){return new Ha(Sn(e.latitude),Sn(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=nf(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(wu(e));default:return null}}convertTimestamp(e){const t=uo(e);return new vt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=en.fromString(e);Bs(M_(i),9688,{name:e});const l=new _u(i.get(1),i.get(3)),u=new Nt(i.popFirst(5));return l.isEqual(t)||vi(`Document ${u} contains a document reference within a different database (${l.projectId}/${l.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),u}}class Iy extends d3{constructor(e){super(),this.firestore=e}convertBytes(e){return new ia(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new wn(this.firestore,null,t)}}function Wr(){return new Cy("serverTimestamp")}function qo(n){return new Ry("increment",n)}const a2="@firebase/firestore",i2="4.10.0";function o2(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;const l=t;for(const u of i)if(u in l&&typeof l[u]=="function")return!0;return!1})(n,["next","error","complete"])}class hk{constructor(e,t,i,l,u){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=l,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new wn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new h3(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(tl("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class h3 extends hk{data(){return super.data()}}function fk(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new nt(je.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class My{}class Dy extends My{}function Ns(n,e,...t){let i=[];e instanceof My&&i.push(e),i=i.concat(t),(function(u){const d=u.filter((g=>g instanceof Py)).length,p=u.filter((g=>g instanceof bf)).length;if(d>1||d>0&&p>0)throw new nt(je.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const l of i)n=l._apply(n);return n}class bf extends Dy{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new bf(e,t,i)}_apply(e){const t=this._parse(e);return mk(e._query,t),new ki(e.firestore,e.converter,bg(e._query,t))}_parse(e){const t=qu(e.firestore);return(function(u,d,p,g,y,w,k){let j;if(y.isKeyField()){if(w==="array-contains"||w==="array-contains-any")throw new nt(je.INVALID_ARGUMENT,`Invalid Query. You can't perform '${w}' queries on documentId().`);if(w==="in"||w==="not-in"){c2(k,w);const q=[];for(const B of k)q.push(l2(g,u,B));j={arrayValue:{values:q}}}else j=l2(g,u,k)}else w!=="in"&&w!=="not-in"&&w!=="array-contains-any"||c2(k,w),j=c3(p,d,k,w==="in"||w==="not-in");return Ln.create(y,w,j)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function cs(n,e,t){const i=e,l=tl("where",n);return bf._create(l,i,t)}class Py extends My{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Py(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:wa.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(l,u){let d=l;const p=u.getFlattenedFilters();for(const g of p)mk(d,g),d=bg(d,g)})(e._query,t),new ki(e.firestore,e.converter,bg(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Ly extends Dy{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Ly(e,t)}_apply(e){const t=(function(l,u,d){if(l.startAt!==null)throw new nt(je.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(l.endAt!==null)throw new nt(je.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ju(u,d)})(e._query,this._field,this._direction);return new ki(e.firestore,e.converter,UR(e._query,t))}}function $h(n,e="asc"){const t=e,i=tl("orderBy",n);return Ly._create(i,t)}class Oy extends Dy{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new Oy(e,t,i)}_apply(e){return new ki(e.firestore,e.converter,Vh(e._query,this._limit,this._limitType))}}function Wh(n){return dR("limit",n),Oy._create("limit",n,"F")}function l2(n,e,t){if(typeof(t=Gs(t))=="string"){if(t==="")throw new nt(je.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!c_(e)&&t.indexOf("/")!==-1)throw new nt(je.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(en.fromString(t));if(!Nt.isDocumentKey(i))throw new nt(je.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return _x(n,new Nt(i))}if(t instanceof wn)return _x(n,t._key);throw new nt(je.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ef(t)}.`)}function c2(n,e){if(!Array.isArray(n)||n.length===0)throw new nt(je.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function mk(n,e){const t=(function(l,u){for(const d of l)for(const p of d.getFlattenedFilters())if(u.indexOf(p.op)>=0)return p.op;return null})(n.filters,(function(l){switch(l){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new nt(je.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new nt(je.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function Vy(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class iu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class $o extends hk{constructor(e,t,i,l,u,d){super(e,t,i,l,d),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new kh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(tl("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new nt(je.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=$o._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}$o._jsonSchemaVersion="firestore/documentSnapshot/1.0",$o._jsonSchema={type:On("string",$o._jsonSchemaVersion),bundleSource:On("string","DocumentSnapshot"),bundleName:On("string"),bundle:On("string")};class kh extends $o{data(e={}){return super.data(e)}}class Wo{constructor(e,t,i,l){this._firestore=e,this._userDataWriter=t,this._snapshot=l,this.metadata=new iu(l.hasPendingWrites,l.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new kh(this._firestore,this._userDataWriter,i.key,i,new iu(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new nt(je.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(l,u){if(l._snapshot.oldDocs.isEmpty()){let d=0;return l._snapshot.docChanges.map((p=>{const g=new kh(l._firestore,l._userDataWriter,p.doc.key,p.doc,new iu(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);return p.doc,{type:"added",doc:g,oldIndex:-1,newIndex:d++}}))}{let d=l._snapshot.oldDocs;return l._snapshot.docChanges.filter((p=>u||p.type!==3)).map((p=>{const g=new kh(l._firestore,l._userDataWriter,p.doc.key,p.doc,new iu(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);let y=-1,w=-1;return p.type!==0&&(y=d.indexOf(p.doc.key),d=d.delete(p.doc.key)),p.type!==1&&(d=d.add(p.doc),w=d.indexOf(p.doc.key)),{type:f3(p.type),doc:g,oldIndex:y,newIndex:w}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new nt(je.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Wo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ey.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],l=[];return this.docs.forEach((u=>{u._document!==null&&(t.push(u._document),i.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),l.push(u.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function f3(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Bt(61501,{type:n})}}Wo._jsonSchemaVersion="firestore/querySnapshot/1.0",Wo._jsonSchema={type:On("string",Wo._jsonSchemaVersion),bundleSource:On("string","QuerySnapshot"),bundleName:On("string"),bundle:On("string")};class m3{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=qu(e)}set(e,t,i){this._verifyNotCommitted();const l=Pp(e,this._firestore),u=Vy(l.converter,t,i),d=Sy(this._dataReader,"WriteBatch.set",l._key,u,l.converter!==null,i);return this._mutations.push(d.toMutation(l._key,_r.none())),this}update(e,t,i,...l){this._verifyNotCommitted();const u=Pp(e,this._firestore);let d;return d=typeof(t=Gs(t))=="string"||t instanceof gf?ok(this._dataReader,"WriteBatch.update",u._key,t,i,l):ik(this._dataReader,"WriteBatch.update",u._key,t),this._mutations.push(d.toMutation(u._key,_r.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Pp(e,this._firestore);return this._mutations=this._mutations.concat(new uf(t._key,_r.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new nt(je.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Pp(n,e){if((n=Gs(n)).firestore!==e)throw new nt(je.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}function Ss(n){n=wr(n,wn);const e=wr(n.firestore,$a),t=Fu(e);return JI(t,n._key).then((i=>gk(e,n,i)))}function ws(n){n=wr(n,ki);const e=wr(n.firestore,$a),t=Fu(e),i=new Iy(e);return fk(n._query),ZI(t,n._query).then((l=>new Wo(e,i,n,l)))}function Ds(n,e,t){n=wr(n,wn);const i=wr(n.firestore,$a),l=Vy(n.converter,e,t),u=qu(i);return Wu(i,[Sy(u,"setDoc",n._key,l,n.converter!==null,t).toMutation(n._key,_r.none())])}function La(n,e,t,...i){n=wr(n,wn);const l=wr(n.firestore,$a),u=qu(l);let d;return d=typeof(e=Gs(e))=="string"||e instanceof gf?ok(u,"updateDoc",n._key,e,t,i):ik(u,"updateDoc",n._key,e),Wu(l,[d.toMutation(n._key,_r.exists(!0))])}function vr(n){return Wu(wr(n.firestore,$a),[new uf(n._key,_r.none())])}function pi(n,e){const t=wr(n.firestore,$a),i=He(n),l=Vy(n.converter,e),u=qu(n.firestore);return Wu(t,[Sy(u,"addDoc",i._key,l,n.converter!==null,{}).toMutation(i._key,_r.exists(!1))]).then((()=>i))}function pk(n,...e){n=Gs(n);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||o2(e[i])||(t=e[i++]);const l={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(o2(e[i])){const y=e[i];e[i]=y.next?.bind(y),e[i+1]=y.error?.bind(y),e[i+2]=y.complete?.bind(y)}let u,d,p;if(n instanceof wn)d=wr(n.firestore,$a),p=rf(n._key.path),u={next:y=>{e[i]&&e[i](gk(d,n,y))},error:e[i+1],complete:e[i+2]};else{const y=wr(n,ki);d=wr(y.firestore,$a),p=y._query;const w=new Iy(d);u={next:k=>{e[i]&&e[i](new Wo(d,w,y,k))},error:e[i+1],complete:e[i+2]},fk(n._query)}const g=Fu(d);return XI(g,p,l,u)}function Wu(n,e){const t=Fu(n);return e3(t,e)}function gk(n,e,t){const i=t.docs.get(e._key),l=new Iy(n);return new $o(n,l,e._key,i,new iu(t.hasPendingWrites,t.fromCache),e.converter)}function u2(n){return n=wr(n,$a),Fu(n),new m3(n,(e=>Wu(n,e)))}(function(e,t=!0){Z4(nl),Qo(new lo("firestore",((i,{instanceIdentifier:l,options:u})=>{const d=i.getProvider("app").getImmediate(),p=new $a(new sR(i.getProvider("auth-internal")),new aR(d,i.getProvider("app-check-internal")),kR(d,l),d);return u={useFetchStreams:t,...u},p._setSettings(u),p}),"PUBLIC").setMultipleInstances(!0)),Va(a2,i2,e),Va(a2,i2,"esm2020")})();var p3="firebase",g3="12.8.0";Va(p3,g3,"app");const yk="firebasestorage.googleapis.com",bk="storageBucket",y3=120*1e3,b3=600*1e3;class kn extends Wa{constructor(e,t,i=0){super(Lp(e),`Firebase Storage: ${t} (${Lp(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,kn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Lp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var _n;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(_n||(_n={}));function Lp(n){return"storage/"+n}function By(){const n="An unknown error occurred, please check the error payload for server response.";return new kn(_n.UNKNOWN,n)}function v3(n){return new kn(_n.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function x3(n){return new kn(_n.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function w3(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new kn(_n.UNAUTHENTICATED,n)}function _3(){return new kn(_n.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function k3(n){return new kn(_n.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function j3(){return new kn(_n.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function T3(){return new kn(_n.CANCELED,"User canceled the upload/download.")}function E3(n){return new kn(_n.INVALID_URL,"Invalid URL '"+n+"'.")}function N3(n){return new kn(_n.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function S3(){return new kn(_n.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+bk+"' property when initializing the app?")}function C3(){return new kn(_n.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function R3(){return new kn(_n.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function A3(n){return new kn(_n.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Sg(n){return new kn(_n.INVALID_ARGUMENT,n)}function vk(){return new kn(_n.APP_DELETED,"The Firebase app was deleted.")}function I3(n){return new kn(_n.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function fu(n,e){return new kn(_n.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Xc(n){throw new kn(_n.INTERNAL_ERROR,"Internal error: "+n)}class xr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=xr.makeFromUrl(e,t)}catch{return new xr(e,"")}if(i.path==="")return i;throw N3(e)}static makeFromUrl(e,t){let i=null;const l="([A-Za-z0-9.\\-_]+)";function u(ge){ge.path.charAt(ge.path.length-1)==="/"&&(ge.path_=ge.path_.slice(0,-1))}const d="(/(.*))?$",p=new RegExp("^gs://"+l+d,"i"),g={bucket:1,path:3};function y(ge){ge.path_=decodeURIComponent(ge.path)}const w="v[A-Za-z0-9_]+",k=t.replace(/[.]/g,"\\."),j="(/([^?#]*).*)?$",O=new RegExp(`^https?://${k}/${w}/b/${l}/o${j}`,"i"),q={bucket:1,path:3},B=t===yk?"(?:storage.googleapis.com|storage.cloud.google.com)":t,V="([^?#]*)",ne=new RegExp(`^https?://${B}/${l}/${V}`,"i"),le=[{regex:p,indices:g,postModify:u},{regex:O,indices:q,postModify:y},{regex:ne,indices:{bucket:1,path:2},postModify:y}];for(let ge=0;ge<le.length;ge++){const Ie=le[ge],Te=Ie.regex.exec(e);if(Te){const R=Te[Ie.indices.bucket];let T=Te[Ie.indices.path];T||(T=""),i=new xr(R,T),Ie.postModify(i);break}}if(i==null)throw E3(e);return i}}class M3{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function D3(n,e,t){let i=1,l=null,u=null,d=!1,p=0;function g(){return p===2}let y=!1;function w(...V){y||(y=!0,e.apply(null,V))}function k(V){l=setTimeout(()=>{l=null,n(O,g())},V)}function j(){u&&clearTimeout(u)}function O(V,...ne){if(y){j();return}if(V){j(),w.call(null,V,...ne);return}if(g()||d){j(),w.call(null,V,...ne);return}i<64&&(i*=2);let le;p===1?(p=2,le=0):le=(i+Math.random())*1e3,k(le)}let q=!1;function B(V){q||(q=!0,j(),!y&&(l!==null?(V||(p=2),clearTimeout(l),k(0)):V||(p=1)))}return k(0),u=setTimeout(()=>{d=!0,B(!0)},t),B}function P3(n){n(!1)}function L3(n){return n!==void 0}function O3(n){return typeof n=="object"&&!Array.isArray(n)}function Uy(n){return typeof n=="string"||n instanceof String}function d2(n){return zy()&&n instanceof Blob}function zy(){return typeof Blob<"u"}function Cg(n,e,t,i){if(i<e)throw Sg(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw Sg(`Invalid value for '${n}'. Expected ${t} or less.`)}function vf(n,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${n}`}function xk(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const l=e(i)+"="+e(n[i]);t=t+l+"&"}return t=t.slice(0,-1),t}var Go;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Go||(Go={}));function V3(n,e){const t=n>=500&&n<600,l=[408,429].indexOf(n)!==-1,u=e.indexOf(n)!==-1;return t||l||u}class B3{constructor(e,t,i,l,u,d,p,g,y,w,k,j=!0,O=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=l,this.successCodes_=u,this.additionalRetryCodes_=d,this.callback_=p,this.errorCallback_=g,this.timeout_=y,this.progressCallback_=w,this.connectionFactory_=k,this.retry=j,this.isUsingEmulator=O,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((q,B)=>{this.resolve_=q,this.reject_=B,this.start_()})}start_(){const e=(i,l)=>{if(l){i(!1,new ah(!1,null,!0));return}const u=this.connectionFactory_();this.pendingConnection_=u;const d=p=>{const g=p.loaded,y=p.lengthComputable?p.total:-1;this.progressCallback_!==null&&this.progressCallback_(g,y)};this.progressCallback_!==null&&u.addUploadProgressListener(d),u.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&u.removeUploadProgressListener(d),this.pendingConnection_=null;const p=u.getErrorCode()===Go.NO_ERROR,g=u.getStatus();if(!p||V3(g,this.additionalRetryCodes_)&&this.retry){const w=u.getErrorCode()===Go.ABORT;i(!1,new ah(!1,null,w));return}const y=this.successCodes_.indexOf(g)!==-1;i(!0,new ah(y,u))})},t=(i,l)=>{const u=this.resolve_,d=this.reject_,p=l.connection;if(l.wasSuccessCode)try{const g=this.callback_(p,p.getResponse());L3(g)?u(g):u()}catch(g){d(g)}else if(p!==null){const g=By();g.serverResponse=p.getErrorText(),this.errorCallback_?d(this.errorCallback_(p,g)):d(g)}else if(l.canceled){const g=this.appDelete_?vk():T3();d(g)}else{const g=j3();d(g)}};this.canceled_?t(!1,new ah(!1,null,!0)):this.backoffId_=D3(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&P3(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class ah{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function U3(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function z3(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function F3(n,e){e&&(n["X-Firebase-GMPID"]=e)}function H3(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function q3(n,e,t,i,l,u,d=!0,p=!1){const g=xk(n.urlParams),y=n.url+g,w=Object.assign({},n.headers);return F3(w,e),U3(w,t),z3(w,u),H3(w,i),new B3(y,n.method,w,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,l,d,p)}function $3(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function W3(...n){const e=$3();if(e!==void 0){const t=new e;for(let i=0;i<n.length;i++)t.append(n[i]);return t.getBlob()}else{if(zy())return new Blob(n);throw new kn(_n.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function G3(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function K3(n){if(typeof atob>"u")throw A3("base-64");return atob(n)}const Oa={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Op{constructor(e,t){this.data=e,this.contentType=t||null}}function Y3(n,e){switch(n){case Oa.RAW:return new Op(wk(e));case Oa.BASE64:case Oa.BASE64URL:return new Op(_k(n,e));case Oa.DATA_URL:return new Op(X3(e),J3(e))}throw By()}function wk(n){const e=[];for(let t=0;t<n.length;t++){let i=n.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const u=i,d=n.charCodeAt(++t);i=65536|(u&1023)<<10|d&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function Q3(n){let e;try{e=decodeURIComponent(n)}catch{throw fu(Oa.DATA_URL,"Malformed data URL.")}return wk(e)}function _k(n,e){switch(n){case Oa.BASE64:{const l=e.indexOf("-")!==-1,u=e.indexOf("_")!==-1;if(l||u)throw fu(n,"Invalid character '"+(l?"-":"_")+"' found: is it base64url encoded?");break}case Oa.BASE64URL:{const l=e.indexOf("+")!==-1,u=e.indexOf("/")!==-1;if(l||u)throw fu(n,"Invalid character '"+(l?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=K3(e)}catch(l){throw l.message.includes("polyfill")?l:fu(n,"Invalid character found")}const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i}class kk{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw fu(Oa.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=Z3(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function X3(n){const e=new kk(n);return e.base64?_k(Oa.BASE64,e.rest):Q3(e.rest)}function J3(n){return new kk(n).contentType}function Z3(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}class eo{constructor(e,t){let i=0,l="";d2(e)?(this.data_=e,i=e.size,l=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=l}size(){return this.size_}type(){return this.type_}slice(e,t){if(d2(this.data_)){const i=this.data_,l=G3(i,e,t);return l===null?null:new eo(l)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new eo(i,!0)}}static getBlob(...e){if(zy()){const t=e.map(i=>i instanceof eo?i.data_:i);return new eo(W3.apply(null,t))}else{const t=e.map(d=>Uy(d)?Y3(Oa.RAW,d).data:d.data_);let i=0;t.forEach(d=>{i+=d.byteLength});const l=new Uint8Array(i);let u=0;return t.forEach(d=>{for(let p=0;p<d.length;p++)l[u++]=d[p]}),new eo(l,!0)}}uploadData(){return this.data_}}function Fy(n){let e;try{e=JSON.parse(n)}catch{return null}return O3(e)?e:null}function eM(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function tM(n,e){const t=e.split("/").filter(i=>i.length>0).join("/");return n.length===0?t:n+"/"+t}function jk(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function sM(n,e){return e}class br{constructor(e,t,i,l){this.server=e,this.local=t||e,this.writable=!!i,this.xform=l||sM}}let ih=null;function nM(n){return!Uy(n)||n.length<2?n:jk(n)}function Tk(){if(ih)return ih;const n=[];n.push(new br("bucket")),n.push(new br("generation")),n.push(new br("metageneration")),n.push(new br("name","fullPath",!0));function e(u,d){return nM(d)}const t=new br("name");t.xform=e,n.push(t);function i(u,d){return d!==void 0?Number(d):d}const l=new br("size");return l.xform=i,n.push(l),n.push(new br("timeCreated")),n.push(new br("updated")),n.push(new br("md5Hash",null,!0)),n.push(new br("cacheControl",null,!0)),n.push(new br("contentDisposition",null,!0)),n.push(new br("contentEncoding",null,!0)),n.push(new br("contentLanguage",null,!0)),n.push(new br("contentType",null,!0)),n.push(new br("metadata","customMetadata",!0)),ih=n,ih}function rM(n,e){function t(){const i=n.bucket,l=n.fullPath,u=new xr(i,l);return e._makeStorageReference(u)}Object.defineProperty(n,"ref",{get:t})}function aM(n,e,t){const i={};i.type="file";const l=t.length;for(let u=0;u<l;u++){const d=t[u];i[d.local]=d.xform(i,e[d.server])}return rM(i,n),i}function Ek(n,e,t){const i=Fy(e);return i===null?null:aM(n,i,t)}function iM(n,e,t,i){const l=Fy(e);if(l===null||!Uy(l.downloadTokens))return null;const u=l.downloadTokens;if(u.length===0)return null;const d=encodeURIComponent;return u.split(",").map(y=>{const w=n.bucket,k=n.fullPath,j="/b/"+d(w)+"/o/"+d(k),O=vf(j,t,i),q=xk({alt:"media",token:y});return O+q})[0]}function oM(n,e){const t={},i=e.length;for(let l=0;l<i;l++){const u=e[l];u.writable&&(t[u.server]=n[u.local])}return JSON.stringify(t)}const h2="prefixes",f2="items";function lM(n,e,t){const i={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[h2])for(const l of t[h2]){const u=l.replace(/\/$/,""),d=n._makeStorageReference(new xr(e,u));i.prefixes.push(d)}if(t[f2])for(const l of t[f2]){const u=n._makeStorageReference(new xr(e,l.name));i.items.push(u)}return i}function cM(n,e,t){const i=Fy(t);return i===null?null:lM(n,e,i)}class Hy{constructor(e,t,i,l){this.url=e,this.method=t,this.handler=i,this.timeout=l,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function qy(n){if(!n)throw By()}function uM(n,e){function t(i,l){const u=Ek(n,l,e);return qy(u!==null),u}return t}function dM(n,e){function t(i,l){const u=cM(n,e,l);return qy(u!==null),u}return t}function hM(n,e){function t(i,l){const u=Ek(n,l,e);return qy(u!==null),iM(u,l,n.host,n._protocol)}return t}function $y(n){function e(t,i){let l;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?l=_3():l=w3():t.getStatus()===402?l=x3(n.bucket):t.getStatus()===403?l=k3(n.path):l=i,l.status=t.getStatus(),l.serverResponse=i.serverResponse,l}return e}function fM(n){const e=$y(n);function t(i,l){let u=e(i,l);return i.getStatus()===404&&(u=v3(n.path)),u.serverResponse=l.serverResponse,u}return t}function mM(n,e,t,i,l){const u={};e.isRoot?u.prefix="":u.prefix=e.path+"/",t.length>0&&(u.delimiter=t),i&&(u.pageToken=i),l&&(u.maxResults=l);const d=e.bucketOnlyServerUrl(),p=vf(d,n.host,n._protocol),g="GET",y=n.maxOperationRetryTime,w=new Hy(p,g,dM(n,e.bucket),y);return w.urlParams=u,w.errorHandler=$y(e),w}function pM(n,e,t){const i=e.fullServerUrl(),l=vf(i,n.host,n._protocol),u="GET",d=n.maxOperationRetryTime,p=new Hy(l,u,hM(n,t),d);return p.errorHandler=fM(e),p}function gM(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function yM(n,e,t){const i=Object.assign({},t);return i.fullPath=n.path,i.size=e.size(),i.contentType||(i.contentType=gM(null,e)),i}function bM(n,e,t,i,l){const u=e.bucketOnlyServerUrl(),d={"X-Goog-Upload-Protocol":"multipart"};function p(){let le="";for(let ge=0;ge<2;ge++)le=le+Math.random().toString().slice(2);return le}const g=p();d["Content-Type"]="multipart/related; boundary="+g;const y=yM(e,i,l),w=oM(y,t),k="--"+g+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+w+`\r
--`+g+`\r
Content-Type: `+y.contentType+`\r
\r
`,j=`\r
--`+g+"--",O=eo.getBlob(k,i,j);if(O===null)throw C3();const q={name:y.fullPath},B=vf(u,n.host,n._protocol),V="POST",ne=n.maxUploadRetryTime,K=new Hy(B,V,uM(n,t),ne);return K.urlParams=q,K.headers=d,K.body=O.uploadData(),K.errorHandler=$y(e),K}class vM{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Go.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Go.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Go.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,l,u){if(this.sent_)throw Xc("cannot .send() more than once");if(go(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),u!==void 0)for(const d in u)u.hasOwnProperty(d)&&this.xhr_.setRequestHeader(d,u[d].toString());return l!==void 0?this.xhr_.send(l):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Xc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Xc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Xc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Xc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class xM extends vM{initXhr(){this.xhr_.responseType="text"}}function Wy(){return new xM}class sl{constructor(e,t){this._service=e,t instanceof xr?this._location=t:this._location=xr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new sl(e,t)}get root(){const e=new xr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return jk(this._location.path)}get storage(){return this._service}get parent(){const e=eM(this._location.path);if(e===null)return null;const t=new xr(this._location.bucket,e);return new sl(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw I3(e)}}function wM(n,e,t){n._throwIfRoot("uploadBytes");const i=bM(n.storage,n._location,Tk(),new eo(e,!0),t);return n.storage.makeRequestWithTokens(i,Wy).then(l=>({metadata:l,ref:n}))}function _M(n){const e={prefixes:[],items:[]};return Nk(n,e).then(()=>e)}async function Nk(n,e,t){const l=await kM(n,{pageToken:t});e.prefixes.push(...l.prefixes),e.items.push(...l.items),l.nextPageToken!=null&&await Nk(n,e,l.nextPageToken)}function kM(n,e){e!=null&&typeof e.maxResults=="number"&&Cg("options.maxResults",1,1e3,e.maxResults);const t=e||{},i=mM(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(i,Wy)}function jM(n){n._throwIfRoot("getDownloadURL");const e=pM(n.storage,n._location,Tk());return n.storage.makeRequestWithTokens(e,Wy).then(t=>{if(t===null)throw R3();return t})}function TM(n,e){const t=tM(n._location.path,e),i=new xr(n._location.bucket,t);return new sl(n.storage,i)}function EM(n){return/^[A-Za-z]+:\/\//.test(n)}function NM(n,e){return new sl(n,e)}function Sk(n,e){if(n instanceof Gy){const t=n;if(t._bucket==null)throw S3();const i=new sl(t,t._bucket);return e!=null?Sk(i,e):i}else return e!==void 0?TM(n,e):n}function SM(n,e){if(e&&EM(e)){if(n instanceof Gy)return NM(n,e);throw Sg("To use ref(service, url), the first argument must be a Storage instance.")}else return Sk(n,e)}function m2(n,e){const t=e?.[bk];return t==null?null:xr.makeFromBucketSpec(t,n)}function CM(n,e,t,i={}){n.host=`${e}:${t}`;const l=go(e);l&&(Vg(`https://${n.host}/b`),Bg("Storage",!0)),n._isUsingEmulator=!0,n._protocol=l?"https":"http";const{mockUserToken:u}=i;u&&(n._overrideAuthToken=typeof u=="string"?u:X2(u,n.app.options.projectId))}class Gy{constructor(e,t,i,l,u,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=l,this._firebaseVersion=u,this._isUsingEmulator=d,this._bucket=null,this._host=yk,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=y3,this._maxUploadRetryTime=b3,this._requests=new Set,l!=null?this._bucket=xr.makeFromBucketSpec(l,this._host):this._bucket=m2(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=xr.makeFromBucketSpec(this._url,e):this._bucket=m2(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Cg("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Cg("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if($r(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new sl(this,e)}_makeRequest(e,t,i,l,u=!0){if(this._deleted)return new M3(vk());{const d=q3(e,this._appId,i,l,t,this._firebaseVersion,u,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[i,l]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,l).getPromise()}}const p2="@firebase/storage",g2="0.14.0";const Ck="storage";function Vp(n,e,t){return n=Gs(n),wM(n,e,t)}function y2(n){return n=Gs(n),_M(n)}function Ko(n){return n=Gs(n),jM(n)}function so(n,e){return n=Gs(n),SM(n,e)}function RM(n=Hg(),e){n=Gs(n);const i=Qh(n,Ck).getImmediate({identifier:e}),l=K2("storage");return l&&AM(i,...l),i}function AM(n,e,t,i={}){CM(n,e,t,i)}function IM(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),l=n.getProvider("app-check-internal");return new Gy(t,i,l,e,nl)}function MM(){Qo(new lo(Ck,IM,"PUBLIC").setMultipleInstances(!0)),Va(p2,g2,""),Va(p2,g2,"esm2020")}MM();const Rk={apiKey:"AIzaSyBCIgMJd3By7qkWH27YiW9VooIBGE3bFLs",authDomain:"mind-core-fitness-client.firebaseapp.com",projectId:"mind-core-fitness-client",storageBucket:"mind-core-fitness-client.firebasestorage.app",messagingSenderId:"669343392406",appId:"1:669343392406:web:f5a35ee062387e7d6f58b7"},Ky=Fg(Rk),Bo=Lw(Ky),pe=r3(Ky),no=RM(Ky),DM=Fg(Rk,"secondary"),j6=Lw(DM),PM="EYdciKDOi3UYBLk1u8hHams5tmO2",Ak=v.createContext();function Pr(){return v.useContext(Ak)}function LM({children:n}){const[e,t]=v.useState(null),[i,l]=v.useState(!1),[u,d]=v.useState(!1),[p,g]=v.useState(null),[y,w]=v.useState(!0);v.useEffect(()=>{let K=null;const le=zC(Bo,ge=>{if(t(ge),K&&(K(),K=null),ge)if(ge.uid===PM)l(!0),d(!1),g(null),w(!1);else{l(!1);const Ie=Ns(Ht(pe,"clients"),cs("uid","==",ge.uid)),Te=async()=>{const R=localStorage.getItem("mcf_clientId");if(R)try{const T=await Ss(He(pe,"clients",R));T.exists()&&(d(!0),g({id:T.id,...T.data()}))}catch(T){console.error("Direct client read failed:",T)}};K=pk(Ie,async R=>{if(R.empty)await Te();else{const T=R.docs[0];d(!0),g({id:T.id,...T.data()});try{localStorage.setItem("mcf_clientId",T.id)}catch{}}w(!1)},async R=>{console.error("Error listening to client data:",R),await Te(),w(!1)})}else l(!1),d(!1),g(null),w(!1)});return()=>{le(),K&&K()}},[]);const ne={currentUser:e,isAdmin:i,isClient:u,clientData:p,updateClientData:K=>{g(le=>le?{...le,...K}:K)},resolveClient:async()=>{if(p)return p;const K=localStorage.getItem("mcf_clientId");if(K)try{const le=await Ss(He(pe,"clients",K));if(le.exists()){const ge={id:le.id,...le.data()};return d(!0),g(ge),ge}}catch(le){console.error("resolveClient direct read failed:",le)}if(e){const le=Ns(Ht(pe,"clients"),cs("uid","==",e.uid)),ge=await ws(le);if(!ge.empty){const Ie={id:ge.docs[0].id,...ge.docs[0].data()};return d(!0),g(Ie),Ie}}return null},login:async(K,le,ge=!0)=>(await ex(Bo,ge?ug:Qg),await VC(Bo,K,le)),signup:async(K,le,ge)=>{await ex(Bo,ug);const Ie=await OC(Bo,le.trim().toLowerCase(),ge),Te=Ie.user,R=He(Ht(pe,"clients")),T={uid:Te.uid,name:K.trim(),email:le.trim().toLowerCase(),clientType:"core_buddy",coreBuddyAccess:!0,status:"active",tier:"free",subscriptionStatus:null,signupSource:"self_signup",createdAt:vt.now()};await Ds(R,T),d(!0),g({id:R.id,...T});try{localStorage.setItem("mcf_clientId",R.id)}catch{}return Ie},logout:()=>{try{localStorage.removeItem("mcf_clientId")}catch{}return FC(Bo)},resetPassword:K=>LC(Bo,K),loading:y};return a.jsx(Ak.Provider,{value:ne,children:n})}const Ik=v.createContext();function ja(){return v.useContext(Ik)}function OM({children:n}){const[e,t]=v.useState(()=>{const g=localStorage.getItem("theme");return g?g==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches}),[i,l]=v.useState(()=>localStorage.getItem("accent")||"red");v.useEffect(()=>{document.documentElement.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("theme",e?"dark":"light")},[e]),v.useEffect(()=>{localStorage.setItem("accent",i)},[i]);const p={isDark:e,toggleTheme:()=>{document.documentElement.setAttribute("data-theme-transitioning",""),t(!e),setTimeout(()=>{document.documentElement.removeAttribute("data-theme-transitioning")},350)},accent:i,setAccent:g=>l(g)};return a.jsx(Ik.Provider,{value:p,children:n})}const Mk=v.createContext();function xf(){return v.useContext(Mk)}const VM=["nutrition","consistency","personalBests","achievements","buddies","programmes","leaderboard"],BM=[5,10],UM=1;function zM({children:n}){const{clientData:e}=Pr(),t=v.useMemo(()=>{const i=e?.tier||"free",l=e?.subscriptionStatus||null,u=e&&e.signupSource!=="self_signup",d=i==="premium"||!!u;function p(g){return d?!0:!VM.includes(g)}return{tier:i,subscriptionStatus:l,isPremium:d,canAccess:p,FREE_RANDOMISER_DURATIONS:BM,FREE_RANDOMISER_WEEKLY_LIMIT:UM}},[e?.tier,e?.subscriptionStatus,e?.signupSource]);return a.jsx(Mk.Provider,{value:t,children:n})}function FM(n){if(n?.signupSource==="self_signup"&&!n?.onboardingComplete)return"/onboarding";const e=n?.clientType;return e==="core_buddy"?"/client/core-buddy":e==="circuit_vip"||e==="circuit_dropin"?"/client/circuit":"/client"}function HM({className:n=""}){const{isDark:e,toggleTheme:t}=ja();return a.jsx("button",{className:n||"theme-toggle",onClick:t,"aria-label":e?"Switch to light mode":"Switch to dark mode",children:e?a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})})}function qM(){const[n,e]=v.useState(""),[t,i]=v.useState(""),[l,u]=v.useState(!0),[d,p]=v.useState(""),[g,y]=v.useState(!1),[w,k]=v.useState(!1),[j,O]=v.useState(!1),{login:q,resetPassword:B,currentUser:V,isAdmin:ne,isClient:K,clientData:le,loading:ge}=Pr(),Ie=Wn();if(v.useEffect(()=>{!ge&&V&&(ne?Ie("/dashboard"):K?Ie(FM(le)):(y(!1),p("No account found. Please sign up or contact your trainer.")))},[ge,V,ne,K,le,Ie]),ge||V)return null;const Te=async T=>{T.preventDefault(),p(""),y(!0);try{await q(n,t,l)}catch(A){p(A.message||"Failed to log in"),y(!1)}},R=async T=>{if(T.preventDefault(),p(""),!n.trim()){p("Please enter your email address");return}y(!0);try{await B(n.trim()),O(!0)}catch(A){A.code==="auth/user-not-found"?p("No account found with this email"):p(A.message||"Failed to send reset email")}y(!1)};return a.jsxs("div",{className:"login-container",children:[a.jsx(HM,{className:"login-theme-toggle"}),a.jsxs("div",{className:"login-card",children:[a.jsxs("div",{className:"login-header",children:[a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"login-logo"}),a.jsx("p",{children:a.jsx("strong",{children:w?"Reset Password":"Sign in as 1-2-1 or a Core Buddy"})})]}),d&&a.jsx("div",{className:"error-message",children:d}),j?a.jsxs("div",{className:"reset-sent",children:[a.jsx("div",{className:"reset-sent-icon",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M22 2L11 13",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("path",{d:"M22 2L15 22L11 13L2 9L22 2Z",strokeLinecap:"round",strokeLinejoin:"round"})]})}),a.jsx("p",{children:"Reset email sent!"}),a.jsx("span",{children:"Check your inbox for a password reset link"}),a.jsx("button",{className:"login-btn",style:{marginTop:"20px"},onClick:()=>{k(!1),O(!1),p("")},children:"Back to Log In"})]}):w?a.jsxs("form",{onSubmit:R,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:n,onChange:T=>e(T.target.value),placeholder:"Enter your email",required:!0})]}),a.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Sending...":"Send Reset Link"}),a.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{k(!1),p("")},children:"Back to Log In"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("form",{onSubmit:Te,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:n,onChange:T=>e(T.target.value),required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"password",children:"Password"}),a.jsx("input",{type:"password",id:"password",value:t,onChange:T=>i(T.target.value),required:!0})]}),a.jsx("div",{className:"remember-me",children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:l,onChange:T=>u(T.target.checked)}),a.jsx("span",{children:"Remember me"})]})}),a.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Logging in...":"Log In"})]}),a.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{k(!0),p("")},children:"Forgot password?"})]}),a.jsx("a",{href:"/",className:"back-link",children:"Back to website"})]})]})}function Ll({feature:n,children:e}){const{canAccess:t}=xf(),i=Wn();return t(n)?e:a.jsxs("div",{className:"locked-feature-wrap",children:[a.jsx("div",{className:"locked-feature-bg","aria-hidden":"true",children:e}),a.jsx("div",{className:"locked-feature-overlay",children:a.jsxs("div",{className:"locked-feature-card",children:[a.jsx("div",{className:"locked-icon",children:a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),a.jsx("h2",{children:"Premium Feature"}),a.jsx("p",{children:"Upgrade to Core Buddy Premium to unlock this feature and get full access to everything."}),a.jsx("button",{className:"locked-upgrade-btn",onClick:()=>i("/upgrade"),children:"Upgrade Now"})]})})]})}function la({active:n}){const e=Wn(),{clientData:t}=Pr(),{isPremium:i}=xf(),l=t?.clientType==="block"&&t?.coreBuddyAccess;return a.jsxs("nav",{className:"block-bottom-nav",children:[a.jsxs("button",{className:`block-nav-tab${n==="home"?" active":""}`,onClick:()=>e("/client/core-buddy"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),a.jsx("span",{children:"Profile"})]}),a.jsxs("button",{className:`block-nav-tab${n==="workouts"?" active":""}`,onClick:()=>e("/client/core-buddy/workouts"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:a.jsx("path",{d:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"})}),a.jsx("span",{children:"Workouts"})]}),a.jsxs("button",{className:`block-nav-tab${n==="nutrition"?" active":""}`,onClick:()=>e(i?"/client/core-buddy/nutrition":"/upgrade"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"})}),a.jsx("span",{children:"Nutrition"})]}),a.jsxs("button",{className:`block-nav-tab${n==="buddies"?" active":""}`,onClick:()=>e(i?"/client/core-buddy/buddies":"/upgrade"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("span",{children:"Buddies"})]}),l&&a.jsxs("button",{className:"block-nav-tab",onClick:()=>e("/client"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),a.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),a.jsx("span",{children:"Block"})]})]})}function Gu(n,e,t,i,l){const u=[];for(let d=0;d<n;d++){const p=(d*(360/n)-90)*(Math.PI/180);u.push({x1:e+i*Math.cos(p),y1:t+i*Math.sin(p),x2:e+l*Math.cos(p),y2:t+l*Math.sin(p),thick:d%5===0})}return u}const Yy=Gu(60,100,100,85,96),mu=Gu(60,100,100,78,94),$M=Gu(60,100,100,82,94);Gu(60,50,50,38,46);const WM=Gu(60,40,40,30,37),GM="/login/assets/first_workout-B8SFkzJX.PNG",KM="/login/assets/workouts_10-Z5R3u0xH.PNG",YM="/login/assets/workouts_25-CzxSlcAj.PNG",QM="/login/assets/workouts_50-BpzWup3V.PNG",XM="/login/assets/workouts_100-D7_r6tn1.PNG",JM="/login/assets/streak_2-CsRr-XA9.PNG",ZM="/login/assets/streak_4-BHO09tbw.PNG",eD="/login/assets/streak_8-DX2UWMko.PNG",tD="/login/assets/first_pb-aVf_CNWy.PNG",sD="/login/assets/pbs_5-Cippawgg.PNG",nD="/login/assets/pbs_10-CZgGh9Kv.PNG",rD="/login/assets/pbs_100-C67b1wfS.PNG",aD="/login/assets/nutrition_7-CHVV11fj.PNG",iD="/login/assets/leaderboard_join-BLoId4Hz.PNG",oD="/login/assets/habits_7-Dvki70KO.PNG",pu=[{id:"first_workout",img:GM,name:"First Rep",desc:"Complete your first workout",category:"workouts",threshold:1},{id:"workouts_10",img:KM,name:"On Fire",desc:"Complete 10 workouts",category:"workouts",threshold:10},{id:"workouts_25",img:YM,name:"Dedicated",desc:"Complete 25 workouts",category:"workouts",threshold:25},{id:"workouts_50",img:QM,name:"Unstoppable",desc:"Complete 50 workouts",category:"workouts",threshold:50},{id:"workouts_100",img:XM,name:"Century",desc:"Complete 100 workouts",category:"workouts",threshold:100},{id:"streak_2",img:JM,name:"2 Week Streak",desc:"Work out for 2 weeks in a row",category:"streaks",threshold:2},{id:"streak_4",img:ZM,name:"Month Strong",desc:"Work out for 4 weeks in a row",category:"streaks",threshold:4},{id:"streak_8",img:eD,name:"Iron Will",desc:"Work out for 8 weeks in a row",category:"streaks",threshold:8},{id:"first_pb",img:tD,name:"First PB",desc:"Set your first personal best",category:"pbs",threshold:1},{id:"pbs_5",img:sD,name:"PB Hunter",desc:"Set 5 personal bests",category:"pbs",threshold:5},{id:"pbs_10",img:nD,name:"PB Machine",desc:"Set 10 personal bests",category:"pbs",threshold:10},{id:"pbs_100",img:rD,name:"PB Legend",desc:"Set 100 personal bests",category:"pbs",threshold:100},{id:"nutrition_7",img:aD,name:"Macro Master",desc:"Hit your macro targets 7 days in a row",category:"nutrition",threshold:7},{id:"leaderboard_join",img:iD,name:"Competitor",desc:"Join the leaderboard",category:"leaderboard",threshold:1},{id:"habits_7",img:oD,name:"Habit Streak",desc:"Complete your daily habits 7 days in a row",category:"habits",threshold:7}];function lD({steps:n,onFinish:e,active:t}){const[i,l]=v.useState(0),[u,d]=v.useState(null),[p,g]=v.useState("below"),[y,w]=v.useState(!1),k=v.useRef(null),j=v.useRef(t);j.current=t,v.useEffect(()=>{t||l(0)},[t]),v.useEffect(()=>{if(!t)return;const Ie=Te=>Te.preventDefault();return document.addEventListener("touchmove",Ie,{passive:!1}),document.addEventListener("wheel",Ie,{passive:!1}),document.body.style.overflow="hidden",()=>{document.removeEventListener("touchmove",Ie),document.removeEventListener("wheel",Ie),document.body.style.overflow=""}},[t]);const O=v.useMemo(()=>t?n.filter(Ie=>document.querySelector(Ie.selector)):[],[t]),q=O[i],B=i===O.length-1,V=q?.selector,ne=v.useCallback(()=>{if(!V)return;const Ie=document.querySelector(V);if(!Ie){d(null);return}const Te=Ie.getBoundingClientRect(),R=8;d({top:Te.top-R,left:Te.left-R,width:Te.width+R*2,height:Te.height+R*2});const T=window.innerHeight-Te.bottom;g(T<260?"above":"below")},[V]);if(v.useEffect(()=>{if(!t||!V)return;w(!0);const Ie=document.querySelector(V);if(Ie){document.body.style.overflow="",Ie.scrollIntoView({behavior:"smooth",block:"center"});let Te=null,R=0,T=0;const A=60,L=()=>{T++;const M=Ie.getBoundingClientRect(),$e=Math.round(M.top);if(Te!==null&&$e===Te?R++:R=0,Te=$e,R>=3||T>=A){j.current&&(document.body.style.overflow="hidden"),ne(),w(!1);return}D=requestAnimationFrame(L)};let D;const F=setTimeout(()=>{D=requestAnimationFrame(L)},120);return()=>{clearTimeout(F),D&&cancelAnimationFrame(D),j.current&&(document.body.style.overflow="hidden")}}},[t,i,V,ne]),v.useEffect(()=>{if(!t)return;const Ie=()=>{k.current&&cancelAnimationFrame(k.current),k.current=requestAnimationFrame(ne)};return window.addEventListener("scroll",Ie,!0),window.addEventListener("resize",Ie),()=>{window.removeEventListener("scroll",Ie,!0),window.removeEventListener("resize",Ie),k.current&&cancelAnimationFrame(k.current)}},[t,ne]),!t||!q||O.length===0)return null;const K=()=>{B?e():l(i+1)},le=()=>{i>0&&l(i-1)},ge=()=>e();return a.jsxs("div",{className:"st-overlay",onClick:Ie=>{Ie.stopPropagation()},children:[a.jsx("div",{className:"st-backdrop",onClick:K}),u&&a.jsx("div",{className:`st-spotlight${y?" st-transitioning":""}`,style:{top:u.top,left:u.left,width:u.width,height:u.height}}),u&&a.jsxs("div",{className:`st-tooltip st-tooltip-${p}${y?" st-transitioning":""}`,style:{top:p==="below"?Math.min(Math.max(u.top+u.height+16,16),window.innerHeight-200):void 0,bottom:p==="above"?Math.min(Math.max(window.innerHeight-u.top+16,16),window.innerHeight-60):void 0,left:Math.max(16,Math.min(u.left,window.innerWidth-320))},children:[a.jsx("div",{className:"st-dots",children:O.map((Ie,Te)=>a.jsx("span",{className:`st-dot${Te===i?" active":""}${Te<i?" done":""}`},Te))}),a.jsx("h3",{className:"st-title",children:q.title}),a.jsx("p",{className:"st-body",children:q.body}),a.jsxs("div",{className:"st-actions",children:[i>0&&a.jsx("button",{className:"st-btn st-btn-back",onClick:le,children:"Back"}),a.jsx("button",{className:"st-btn st-btn-next",onClick:K,children:q.cta||(B?"Let's Go!":"Next")})]}),a.jsx("button",{className:"st-skip",onClick:ge,children:"Skip tour"})]})]})}const Bp=[10,25,50,100,200,500,1e3],Ki=5;function Jc(n){return n.toISOString().split("T")[0]}function cD(n){let e=0;for(const t of Bp){if(n<t)return{prev:e,next:t};e=t}return{prev:Bp[Bp.length-1],next:n+100}}const uD={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},dD={fullbody_4wk:["Push Focus","Pull Focus","Legs & Core"],fullbody_8wk:["Strength","Power","Endurance"],fullbody_12wk:["Upper Push","Lower Body","Upper Pull"],core_4wk:["Abs","Stability","Power Core"],core_8wk:["Anti-Extension","Rotation","Power"],core_12wk:["Strength","Endurance","Power"],upper_4wk:["Push","Pull","Mixed"],lower_4wk:["Quad Dominant","Hamstring & Glute","Power & Stability"]},Up=[{text:"You have 24 hours a day...",bold:"make it count"},{text:"Discipline beats motivation...",bold:"every single time"},{text:"Rest when you're done,",bold:"not when you're tired"},{text:"Small daily gains...",bold:"create massive results"},{text:"Your body keeps score,",bold:"train it well"},{text:"Consistency over intensity...",bold:"always wins"},{text:"The only bad workout...",bold:"is the one you skipped"}];function zp(n){if(!n)return"";const e=n instanceof Date?n:n.toDate?n.toDate():new Date(n),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function Zc(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function hD(n,e=800){return new Promise(t=>{const i=new Image;i.onload=()=>{const l=document.createElement("canvas");let u=i.width,d=i.height;u>d?u>e&&(d=Math.round(d*e/u),u=e):d>e&&(u=Math.round(u*e/d),d=e),l.width=u,l.height=d,l.getContext("2d").drawImage(i,0,0,u,d),l.toBlob(p=>t(p),"image/jpeg",.8)},i.src=URL.createObjectURL(n)})}function fD(){const{currentUser:n,isClient:e,clientData:t,logout:i,updateClientData:l,loading:u}=Pr(),{isDark:d,toggleTheme:p}=ja(),{isPremium:g}=xf(),y=Wn(),[w,k]=v.useState({hours:0,minutes:0,seconds:0}),[j,O]=v.useState(0),[q,B]=v.useState(0),[V,ne]=v.useState(""),[K,le]=v.useState(0),[ge,Ie]=v.useState(0),[Te,R]=v.useState(!1),[T,A]=v.useState({protein:0,carbs:0,fats:0,calories:0}),[L,D]=v.useState(null),[F,M]=v.useState(0),[$e,bt]=v.useState(null),[H,fe]=v.useState(!1),[Me,Ke]=v.useState(!1),[ee,P]=v.useState(0),[se,Se]=v.useState(0),[Oe,st]=v.useState([]),[Ue,gt]=v.useState([]),[Tt,rt]=v.useState(null),[Wt,js]=v.useState(!1),At=v.useRef(null),[Ee,Z]=v.useState([]),[mt,pt]=v.useState(null),[Je,ut]=v.useState(null),tt=v.useRef(null),[Ze,Pt]=v.useState(0),[Ks,Ct]=v.useState(0),[as,on]=v.useState(0),[qt,Cs]=v.useState(0),[ns,_s]=v.useState(0),[he,Re]=v.useState(!1),ze=v.useRef(0),Ye=v.useRef(!1),[Ve,Le]=v.useState(null),De=v.useCallback((I,X="info")=>{Le({message:I,type:X}),setTimeout(()=>Le(null),4e3)},[]),[wt,ft]=v.useState([]),[Ut,Gt]=v.useState(!1),[Q,ve]=v.useState(""),[at,It]=v.useState(null),[St,ts]=v.useState(null),[Xt,zt]=v.useState(!1),[Rs,tn]=v.useState(new Set),[rs,Ts]=v.useState(new Set),[As,z]=v.useState({}),[ye,we]=v.useState({}),[_e,be]=v.useState({}),[it,Rt]=v.useState({}),[ct,_t]=v.useState({}),[kt,us]=v.useState({}),Cn=v.useRef(null),hn=v.useRef(null),fn=v.useRef({}),[Es,$]=v.useState([]),[ue,E]=v.useState(!1),S=v.useRef(null),[G,ae]=v.useState([]),[Qe,qe]=v.useState(""),[Fe,Lt]=v.useState(!1),[Mt,Ys]=v.useState(null),[jn,gn]=v.useState([]),[Js,Hs]=v.useState(null),[Y,xe]=v.useState(!1),te=v.useRef(!1),Be=(()=>{const I=[{selector:".cb-ring-container",title:"Your 24-Hour Countdown",body:"Every day resets. This ring tracks the time you have left  tap your photo to personalise your profile.",cta:"Next"},{selector:".cb-stats-row",title:"Progress at a Glance",body:"Programme completion, workouts this week, and daily habits  all in one row. These fill up as you go."},{selector:".cb-nudge-card",title:"Smart Suggestions",body:"We'll highlight what needs your attention  your next session, unfinished habits, or a meal to log."},{selector:".cb-card-workouts-hero",title:"Workouts",body:"Quick randomiser sessions or structured programmes  pick your focus, level and time.",cta:"Next"}];return g&&I.push({selector:".cb-card-nutrition",title:"Nutrition Tracking",body:"Set your macro targets, scan barcodes, and log meals to hit your daily goals."},{selector:".cb-card-consistency",title:"Daily Habits",body:"5 simple habits each day  train, hit protein, 10k steps, sleep, and hydrate. Build your streak."},{selector:".cb-card-buddies",title:"Buddies & Social",body:"Connect with other members, share your journey, and keep each other accountable."},{selector:".cb-journey-section",title:"Share Your Journey",body:"Post photos, updates, and milestones  your fitness journey in one place. Like and comment on each other's posts."},{selector:".cb-achievements-section",title:"Achievements",body:"Every rep counts towards badges  volume milestones, workout streaks, and more to unlock."}),I.push({selector:".block-bottom-nav",title:"You're All Set!",body:"Use the nav bar to jump between your profile, workouts, nutrition, and buddies. Time to get after it.",cta:"Let's Go!"}),I})();v.useEffect(()=>{!u&&!n&&y("/")},[u,n,y]),v.useEffect(()=>{const I=()=>window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,X=dt=>{I()<=0&&(ze.current=dt.touches[0].clientY,Ye.current=!1)},Pe=dt=>{const jt=I(),Ot=dt.touches[0].clientY-ze.current;if(jt>5||Ot<=0){Ye.current=!1,_s(0);return}Ot>20&&jt<=0&&(Ye.current=!0,_s(Math.min((Ot-20)*.4,80)))},Ge=()=>{Ye.current&&ns>60?(Re(!0),setTimeout(()=>{window.location.reload()},300)):_s(0),Ye.current=!1};return document.addEventListener("touchstart",X,{passive:!0}),document.addEventListener("touchmove",Pe,{passive:!0}),document.addEventListener("touchend",Ge),()=>{document.removeEventListener("touchstart",X),document.removeEventListener("touchmove",Pe),document.removeEventListener("touchend",Ge)}},[ns]);const We=()=>{Re(!0),setTimeout(()=>{window.location.reload()},300)};v.useEffect(()=>{!u&&t&&t.signupSource==="self_signup"&&!t.onboardingComplete&&y("/onboarding")},[u,t,y]),v.useEffect(()=>{let I=t?.tourComplete||te.current;if(!I&&t?.id)try{I=!!localStorage.getItem(`tourDone_${t.id}`)}catch{}if(Te&&t&&!I){const X=setTimeout(()=>xe(!0),600);return()=>clearTimeout(X)}},[Te,t]),v.useEffect(()=>{if(t)try{const I=sessionStorage.getItem(`cbDash_${t.id}`);if(I){const X=JSON.parse(I);B(X.programmePct??0),ne(X.programmeName??""),le(X.totalWorkouts??0),Ie(X.habitWeekPct??0),A(X.nutritionTotals??{protein:0,carbs:0,fats:0,calories:0}),D(X.nutritionTargetData??null),M(X.todayHabitsCount??0),bt(X.nextSession??null),fe(X.hasProgramme??!1),Ke(X.programmeComplete??!1),P(X.weeklyWorkouts??0),Se(X.pbCount??0),st(X.topPBs??[]),gt(X.leaderboardTop3??[]),Z(X.unlockedBadges??[]),tt.current=X.unlockedBadges??[],Pt(X.streakWeeks??0),R(!0)}}catch{}},[t]),v.useEffect(()=>{t?.photoURL&&rt(t.photoURL)},[t]),v.useEffect(()=>{if(!t)return;const I=Ns(Ht(pe,"notifications"),cs("toId","==",t.id)),X=pk(I,Pe=>{const Ge=Pe.docs.map(dt=>({id:dt.id,...dt.data()}));Ge.sort((dt,jt)=>{const et=dt.createdAt?.toMillis?.()||0;return(jt.createdAt?.toMillis?.()||0)-et}),$(Ge.slice(0,50))},Pe=>{console.error("Notification listener error:",Pe),Pe.code==="permission-denied"&&console.warn("Firestore rules may be missing for the notifications collection. Please update your Firestore rules in the Firebase Console.")});return()=>X()},[t]),v.useEffect(()=>{const I=X=>{S.current&&!S.current.contains(X.target)&&E(!1)};return document.addEventListener("mousedown",I),()=>document.removeEventListener("mousedown",I)},[]),v.useEffect(()=>{if(!t)return;const I=t.id;(async()=>{try{const[X,Pe,Ge]=await Promise.all([ws(Ns(Ht(pe,"buddies"),cs("user1","==",I))),ws(Ns(Ht(pe,"buddies"),cs("user2","==",I))),ws(Ht(pe,"clients"))]),dt=new Set;[...X.docs,...Pe.docs].forEach(et=>{const Ot=et.data();dt.add(Ot.user1===I?Ot.user2:Ot.user1)});const jt={};Ge.docs.forEach(et=>{jt[et.id]=et.data()}),ae(Array.from(dt).filter(et=>jt[et]).map(et=>({id:et,name:jt[et].name,photoURL:jt[et].photoURL||null})))}catch(X){console.error("Error loading buddies for mentions:",X)}})()},[t]);const ot=Es.filter(I=>!I.read).length,xt=async()=>{const I=Es.filter(Pe=>!Pe.read);if(!I.length)return;const X=u2(pe);I.forEach(Pe=>X.update(He(pe,"notifications",Pe.id),{read:!0})),await X.commit()},Kt=async()=>{if(!Es.length)return;const I=u2(pe);Es.forEach(X=>I.delete(He(pe,"notifications",X.id))),await I.commit()},is=async(I,X,Pe={})=>{if(!(!t||I===t.id))try{await pi(Ht(pe,"notifications"),{toId:I,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:X,read:!1,createdAt:Wr(),...Pe})}catch(Ge){console.error("Notification create error:",Ge),Ge.code==="permission-denied"&&De("Notifications blocked  check Firestore rules","error")}},yn=(I,X)=>{const Pe=X==="compose"?Cn.current?.selectionStart:null,dt=(Pe!=null?I.slice(0,Pe):I).match(/@(\w*)$/);if(dt){Lt(!0),Ys(X),qe(dt[1].toLowerCase());const jt=G.filter(et=>et.name&&et.name.toLowerCase().includes(dt[1].toLowerCase())).slice(0,5);gn(jt)}else Lt(!1),gn([])},ms=(I,X)=>{if(X==="compose"){const Pe=Cn.current,Ge=Q,dt=Pe?.selectionStart??Ge.length,jt=Ge.slice(0,dt),et=Ge.slice(dt),Ot=jt.replace(/@\w*$/,`@${I.name} `);ve(Ot+et),setTimeout(()=>{Pe?.focus(),Pe.selectionStart=Pe.selectionEnd=Ot.length},0)}else{const Ge=(ye[X]||"").replace(/@\w*$/,`@${I.name} `);we(dt=>({...dt,[X]:Ge}))}Lt(!1),gn([])},Fn=I=>I&&I.split(/(@\w[\w\s]*?\s)/g).map((Pe,Ge)=>Pe.startsWith("@")&&G.some(dt=>Pe.trim()===`@${dt.name}`)?a.jsx("span",{className:"mention-highlight",children:Pe.trim()},Ge):Pe),Yr=async I=>{const X=I.target.files?.[0];if(!(!X||!t)){if(!X.type.startsWith("image/")){De("Please select an image file","error");return}if(X.size>5*1024*1024){De("Image must be under 5MB","error");return}js(!0);try{const Pe=await new Promise(jt=>{const et=new Image;et.onload=()=>{const Ot=document.createElement("canvas"),Ft=400;let ds=et.width,Jt=et.height;ds>Jt?(Jt=Jt/ds*Ft,ds=Ft):(ds=ds/Jt*Ft,Jt=Ft),Ot.width=ds,Ot.height=Jt,Ot.getContext("2d").drawImage(et,0,0,ds,Jt),Ot.toBlob(ls=>jt(ls),"image/jpeg",.75)},et.src=URL.createObjectURL(X)}),Ge=so(no,`profilePhotos/${t.id}`);await Vp(Ge,Pe);const dt=await Ko(Ge);await La(He(pe,"clients",t.id),{photoURL:dt}),rt(dt),l({photoURL:dt}),De("Profile photo updated!","success")}catch(Pe){console.error("Photo upload error:",Pe),De("Failed to upload photo","error")}js(!1),At.current&&(At.current.value="")}};v.useEffect(()=>{const I=()=>{const Pe=new Date,Ge=new Date(Pe);Ge.setHours(23,59,59,999);const dt=Ge-Pe,jt=Math.floor(dt/(1e3*60*60)),et=Math.floor(dt%(1e3*60*60)/(1e3*60)),Ot=Math.floor(dt%(1e3*60)/1e3);k({hours:jt,minutes:et,seconds:Ot}),O(60-Ot)};I();const X=setInterval(I,1e3);return()=>clearInterval(X)},[]),v.useEffect(()=>{const I=setInterval(()=>{Cs(X=>(X+1)%Up.length)},8e3);return()=>clearInterval(I)},[]),v.useEffect(()=>{if(!n||!t)return;(async()=>{let X=null,Pe=0,Ge=[],dt=!1,jt=null;try{const et=Jc(new Date),Ot=await Ss(He(pe,"clientProgrammes",t.id));if(Ot.exists()){const bn=Ot.data(),Bn=uD[bn.templateId];if(fe(!0),Bn){const Er=bn.completedSessions||{},Nr=Object.keys(Er).length,_o=Bn.duration*Bn.daysPerWeek;B(_o>0?Math.round(Nr/_o*100):0);const Sa=bn.templateId.replace(/_/g," ").replace(/\b\w/g,ca=>ca.toUpperCase());ne(Sa);const Jn=dD[bn.templateId];let Ka=!1;for(let ca=1;ca<=Bn.duration&&!Ka;ca++)for(let ir=0;ir<Bn.daysPerWeek&&!Ka;ir++)Er[`w${ca}d${ir}`]||(bt({week:ca,dayIdx:ir,label:Jn?.[ir]||`Day ${ir+1}`}),Ka=!0);Ka||(Ke(!0),dt=!0)}}const Ft=Ht(pe,"workoutLogs"),ds=Ns(Ft,cs("clientId","==",t.id));X=await ws(ds),le(X.docs.length);const Jt=new Date,ls=Jt.getDay(),Yn=ls===0?6:ls-1,Hn=new Date(Jt);Hn.setDate(Jt.getDate()-Yn),Hn.setHours(0,0,0,0);const Us=Hn.getTime(),Vs=X.docs.filter(bn=>{const Bn=bn.data().completedAt;return Bn?(Bn.toDate?Bn.toDate().getTime():new Date(Bn).getTime())>=Us:!1}).length;P(Vs);const nn=Ht(pe,"habitLogs"),Rn=Ns(nn,cs("clientId","==",t.id),cs("date","==",et)),Qn=await ws(Rn);let Xn=0;if(!Qn.empty){const bn=Qn.docs[0].data().habits||{};Xn=Object.values(bn).filter(Boolean).length}Ie(Math.round(Xn/Ki*100)),M(Xn);const Tr=await Ss(He(pe,"nutritionTargets",t.id));Tr.exists()&&(D(Tr.data()),jt=Tr.data());const gr=await Ss(He(pe,"nutritionLogs",`${t.id}_${et}`));if(gr.exists()){const Bn=(gr.data().entries||[]).reduce((Er,Nr)=>({protein:Er.protein+(Nr.protein||0),carbs:Er.carbs+(Nr.carbs||0),fats:Er.fats+(Nr.fats||0),calories:Er.calories+(Nr.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});A(Bn)}}catch(et){console.error("Error loading dashboard stats:",et)}try{let et=[];const Ot=await Ss(He(pe,"coreBuddyPBs",t.id));if(Ot.exists()){const Ft=Ot.data().exercises||{};Se(Object.keys(Ft).length),Pe=Object.keys(Ft).length,et=Object.entries(Ft).sort(([,ds],[,Jt])=>(Jt.weight||0)-(ds.weight||0)).slice(0,3).map(([ds,Jt])=>({name:ds,weight:Jt.weight,reps:Jt.reps}))}if(et.length===0){const Ft={chestPress:"Chest Press",shoulderPress:"Shoulder Press",seatedRow:"Seated Row",latPulldown:"Lat Pulldown",squat:"Squat",deadlift:"Deadlift"},ds=Ns(Ht(pe,"personalBests"),cs("clientId","==",t.id)),Jt=await ws(ds);if(!Jt.empty){const ls={};Jt.docs.forEach(Hn=>{const Us=Hn.data().benchmarks||{};Object.entries(Us).forEach(([Vs,nn])=>{if(!nn.weight||!Ft[Vs])return;const Rn=(nn.weight||0)*(nn.reps||1);(!ls[Vs]||Rn>(ls[Vs].weight||0)*(ls[Vs].reps||1))&&(ls[Vs]={name:Ft[Vs],weight:nn.weight,reps:nn.reps})})});const Yn=Object.values(ls);Se(Yn.length),Pe=Yn.length,et=Yn.sort((Hn,Us)=>(Us.weight||0)-(Hn.weight||0)).slice(0,3)}}Ge=et,st(et)}catch(et){console.error("PB fetch error:",et)}try{const et=Ht(pe,"clients"),Ot=Ns(et,cs("leaderboardOptIn","==",!0)),ds=(await ws(Ot)).docs.map(Jt=>({id:Jt.id,name:Jt.data().name,photoURL:Jt.data().photoURL||null}));gt(ds.slice(0,3))}catch(et){console.error("Leaderboard preview error:",et)}try{let et=0;if(X){const Us=X.docs.map(Vs=>Vs.data().date).filter(Boolean).sort().reverse();if(Us.length>0){const Vs=new Date;let nn=new Date(Vs);e:for(let Rn=0;Rn<52;Rn++){const Qn=new Date(nn),Xn=Qn.getDay(),Tr=Xn===0?6:Xn-1;Qn.setDate(Qn.getDate()-Tr),Qn.setHours(0,0,0,0);const gr=new Date(Qn);gr.setDate(gr.getDate()+7);const bn=Jc(Qn),Bn=Jc(gr);if(Us.some(Nr=>Nr>=bn&&Nr<Bn))et++;else{if(Rn>0)break e;break}nn.setDate(nn.getDate()-7)}}}Pt(et);let Ot=0;for(let Us=0;Us<30;Us++){const Vs=new Date;Vs.setDate(Vs.getDate()-Us);const nn=Jc(Vs);try{const Rn=await ws(Ns(Ht(pe,"habitLogs"),cs("clientId","==",t.id),cs("date","==",nn)));if(Rn.empty)break;{const Qn=Rn.docs[0].data().habits||{};if(Object.values(Qn).filter(Boolean).length>=Ki)Ot++;else break}}catch{break}}Ct(Ot);let Ft=0;for(let Us=0;Us<30;Us++){const Vs=new Date;Vs.setDate(Vs.getDate()-Us);const nn=Jc(Vs);try{const Rn=await Ss(He(pe,"nutritionLogs",`${t.id}_${nn}`));if(Rn.exists()&&(Rn.data().entries||[]).length>0)if(jt){const Xn=(Rn.data().entries||[]).reduce((Tr,gr)=>({protein:Tr.protein+(gr.protein||0),carbs:Tr.carbs+(gr.carbs||0),fats:Tr.fats+(gr.fats||0)}),{protein:0,carbs:0,fats:0});if(Xn.protein>=(jt.protein||0)&&Xn.carbs>=(jt.carbs||0)&&Xn.fats>=(jt.fats||0))Ft++;else break}else Ft++;else break}catch{break}}on(Ft);const ds=X?X.docs.length:0,Jt=[],ls=Us=>Jt.push(Us);ds>=1&&ls("first_workout"),ds>=10&&ls("workouts_10"),ds>=25&&ls("workouts_25"),ds>=50&&ls("workouts_50"),ds>=100&&ls("workouts_100"),et>=2&&ls("streak_2"),et>=4&&ls("streak_4"),et>=8&&ls("streak_8"),Pe>=1&&ls("first_pb"),Pe>=5&&ls("pbs_5"),Pe>=10&&ls("pbs_10"),Pe>=100&&ls("pbs_100"),Ft>=7&&ls("nutrition_7"),t.leaderboardOptIn&&ls("leaderboard_join"),Ot>=7&&ls("habits_7"),Z(Jt);const Yn=tt.current;if(Yn!==null){const Us=Jt.filter(Vs=>!Yn.includes(Vs));if(Us.length>0){const Vs=pu.find(nn=>nn.id===Us[Us.length-1]);Vs&&setTimeout(()=>ut(Vs),600)}}tt.current=Jt;const Hn={};Jt.forEach(Us=>{Hn[Us]={unlockedAt:new Date().toISOString()}}),Ds(He(pe,"achievements",t.id),{badges:Hn,progress:{streakWeeks:et,pbCount:Pe,nutritionStreak:Ft,habitStreak:Ot},updatedAt:new Date().toISOString()},{merge:!0}).catch(()=>{})}catch(et){console.error("Achievement computation error:",et)}R(!0)})()},[n,t]),v.useEffect(()=>{if(!(!Te||!t))try{sessionStorage.setItem(`cbDash_${t.id}`,JSON.stringify({programmePct:q,programmeName:V,totalWorkouts:K,habitWeekPct:ge,nutritionTotals:T,nutritionTargetData:L,todayHabitsCount:F,nextSession:$e,hasProgramme:H,programmeComplete:Me,weeklyWorkouts:ee,pbCount:se,topPBs:Oe,leaderboardTop3:Ue,unlockedBadges:Ee,streakWeeks:Ze}))}catch{}},[Te,q,V,K,ge,T,L,F,$e,H,Me,ee,se,Oe,Ue,Ee,Ze,t]);const Vn=v.useCallback(async()=>{if(te.current=!0,xe(!1),l({tourComplete:!0}),t?.id){try{localStorage.setItem(`tourDone_${t.id}`,"1")}catch{}try{await La(He(pe,"clients",t.id),{tourComplete:!0})}catch(I){console.error("Failed to save tour completion:",I)}}},[t,l]),hr=I=>{const X=I.currentTarget,Pe=X.querySelector(".ripple");Pe&&Pe.remove();const Ge=X.getBoundingClientRect(),dt=Math.max(Ge.width,Ge.height),jt=I.clientX-Ge.left-dt/2,et=I.clientY-Ge.top-dt/2,Ot=document.createElement("span");Ot.className="ripple",Ot.style.cssText=`width:${dt}px;height:${dt}px;left:${jt}px;top:${et}px;`,X.appendChild(Ot),setTimeout(()=>Ot.remove(),600)},Ta=t?.name?.split(" ")[0]||"there",{prev:os,next:ln}=cD(K),fr=ln>os?Math.round((K-os)/(ln-os)*100):100,Gn=[{label:"Programme",value:`${q}%`,pct:q,color:"#14b8a6",size:"normal"},{label:"Workouts",value:`${K}`,pct:fr,color:"var(--color-primary)",size:"large"},{label:"Habits Today",value:`${ge}%`,pct:ge,color:"#38B6FF",size:"normal"}],Kn=I=>!L||!L[I]?0:Math.min(Math.round(T[I]/L[I]*100),100),Zs=(()=>{const I=new Date().getHours();return Te&&F>=Ki&&T.calories>0?{main:"Smashed it today,",sub:"Rest up and go again tomorrow."}:I>=5&&I<12?{main:"Rise and grind,",sub:"let's get after it!"}:I>=12&&I<17?{main:"Oye",sub:"crack on and make it count!"}:I>=17&&I<21?{main:"Evening session?",sub:"Let's finish strong!"}:{main:"Burning the midnight oil,",sub:"Respect the hustle!"}})(),sn=Te?H&&$e&&!Me?{label:"NEXT SESSION",message:`Week ${$e.week}, Day ${$e.dayIdx+1}  ${$e.label}`,cta:"Continue",action:()=>y("/client/core-buddy/programmes"),pct:q,ringLabel:`${q}%`}:F<Ki?{label:"DAILY HABITS",message:`${F}/${Ki} completed`,cta:"Open Habits",action:()=>y("/client/core-buddy/consistency"),pct:ge,ringLabel:`${F}/${Ki}`}:T.calories===0?{label:"NUTRITION",message:"No meals logged today",cta:"Log Meal",action:()=>y("/client/core-buddy/nutrition"),pct:0,ringLabel:"0"}:H?Me?{label:"COMPLETE",message:"Programme finished!",cta:"New Programme",action:()=>y("/client/core-buddy/workouts"),pct:100,ringLabel:"100%"}:{label:"TODAY",message:"You're crushing it!",cta:null,action:null,pct:100,ringLabel:""}:{label:"PROGRAMMES",message:"Start a programme to level up",cta:"Browse",action:()=>y("/client/core-buddy/workouts"),pct:0,ringLabel:""}:null,mn=v.useCallback(async()=>{if(t){Gt(!0);try{const I=await ws(Ns(Ht(pe,"posts"),cs("authorId","==",t.id),$h("createdAt","desc"),Wh(30)));ft(I.docs.map(Pe=>({id:Pe.id,...Pe.data()})));const X=await ws(Ns(Ht(pe,"postLikes"),cs("userId","==",t.id)));tn(new Set(X.docs.map(Pe=>Pe.data().postId)))}catch(I){console.error("Error loading journey:",I)}finally{Gt(!1)}}},[t]);v.useEffect(()=>{Te&&t&&mn()},[Te,t,mn]);const Lr=I=>{const X=I.target.files?.[0];if(X){if(!X.type.startsWith("image/")){De("Please select an image file","error");return}if(X.size>10*1024*1024){De("Image must be under 10MB","error");return}It(X),ts(URL.createObjectURL(X))}},mr=()=>{It(null),St&&URL.revokeObjectURL(St),ts(null),hn.current&&(hn.current.value="")},Or=async()=>{if(!(!Q.trim()&&!at||Xt||!t)){zt(!0);try{let I=null;if(at){const Ge=await hD(at),dt=`${Date.now()}_${Math.random().toString(36).slice(2,8)}`,jt=so(no,`postImages/${t.id}/${dt}`);await Vp(jt,Ge),I=await Ko(jt)}await pi(Ht(pe,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Q.trim(),type:I?"image":"text",imageURL:I||null,createdAt:Wr(),likeCount:0,commentCount:0});const Pe=Q.trim().match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Pe){const Ge=new Set;Pe.forEach(dt=>{const jt=dt.slice(1).trim(),et=G.find(Ot=>Ot.name&&Ot.name.toLowerCase()===jt.toLowerCase());et&&!Ge.has(et.id)&&(Ge.add(et.id),is(et.id,"mention",{}))})}ve(""),mr(),Cn.current&&(Cn.current.style.height="auto"),await mn(),De("Posted!","success")}catch(I){console.error("Error posting:",I),De(I?.message||"Failed to post","error")}finally{zt(!1)}}},ji=async I=>{if(window.confirm("Delete this post?"))try{await vr(He(pe,"posts",I)),ft(X=>X.filter(Pe=>Pe.id!==I)),De("Post deleted","info")}catch(X){console.error("Delete error:",X),De("Failed to delete","error")}},Ea=async I=>{if(!t)return;const X=t.id,Pe=`${I}_${X}`,Ge=Rs.has(I),dt=new Set(Rs);Ge?dt.delete(I):dt.add(I),tn(dt),ft(jt=>jt.map(et=>et.id===I?{...et,likeCount:Math.max(0,(et.likeCount||0)+(Ge?-1:1))}:et));try{if(Ge)await vr(He(pe,"postLikes",Pe)),await La(He(pe,"posts",I),{likeCount:qo(-1)});else{await Ds(He(pe,"postLikes",Pe),{postId:I,userId:X,createdAt:Wr()}),await La(He(pe,"posts",I),{likeCount:qo(1)});const jt=wt.find(et=>et.id===I);jt&&is(jt.authorId,"like",{postId:I})}}catch(jt){console.error("Like error:",jt),mn()}},pr=async I=>{try{const X=await ws(Ns(Ht(pe,"postComments"),cs("postId","==",I),$h("createdAt","asc"),Wh(50)));z(Pe=>({...Pe,[I]:X.docs.map(Ge=>({id:Ge.id,...Ge.data()}))}))}catch(X){console.error("Error loading comments:",X)}},jr=I=>{const X=new Set(rs);X.has(I)?X.delete(I):(X.add(I),As[I]||pr(I)),Ts(X)},Na=async I=>{const X=(ye[I]||"").trim(),Pe=ct[I];if(!(!X&&!Pe||!t)){be(Ge=>({...Ge,[I]:!0}));try{let Ge=null;if(Pe){const Ft=so(no,`comment-images/${Date.now()}_${Pe.name}`);await Vp(Ft,Pe),Ge=await Ko(Ft)}const dt={postId:I,authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:X||"",createdAt:Wr()};Ge&&(dt.imageURL=Ge);const jt=it[I];jt&&(dt.replyToId=jt.id,dt.replyToName=jt.authorName),await pi(Ht(pe,"postComments"),dt),await La(He(pe,"posts",I),{commentCount:qo(1)});const et=wt.find(Ft=>Ft.id===I);et&&is(et.authorId,"comment",{postId:I});const Ot=X.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Ot){const Ft=new Set;Ot.forEach(ds=>{const Jt=ds.slice(1).trim(),ls=G.find(Yn=>Yn.name&&Yn.name.toLowerCase()===Jt.toLowerCase());ls&&!Ft.has(ls.id)&&(Ft.add(ls.id),is(ls.id,"mention",{postId:I}))})}we(Ft=>({...Ft,[I]:""})),_t(Ft=>({...Ft,[I]:null})),us(Ft=>({...Ft,[I]:null})),Rt(Ft=>({...Ft,[I]:null})),fn.current[I]&&(fn.current[I].value=""),ft(Ft=>Ft.map(ds=>ds.id===I?{...ds,commentCount:(ds.commentCount||0)+1}:ds)),await pr(I)}catch(Ge){console.error("Comment error:",Ge),De("Failed to comment","error")}finally{be(Ge=>({...Ge,[I]:!1}))}}},Os=async(I,X)=>{try{await vr(He(pe,"postComments",X)),await La(He(pe,"posts",I),{commentCount:qo(-1)}),z(Pe=>({...Pe,[I]:(Pe[I]||[]).filter(Ge=>Ge.id!==X)})),ft(Pe=>Pe.map(Ge=>Ge.id===I?{...Ge,commentCount:Math.max((Ge.commentCount||1)-1,0)}:Ge))}catch(Pe){console.error("Delete comment error:",Pe),De("Failed to delete comment","error")}},Qr=(I,X)=>{const Pe=X.target.files?.[0];if(!Pe)return;if(Pe.size>5*1024*1024){De("Image must be under 5MB","error");return}_t(dt=>({...dt,[I]:Pe}));const Ge=new FileReader;Ge.onload=dt=>us(jt=>({...jt,[I]:dt.target.result})),Ge.readAsDataURL(Pe)},xo=I=>{_t(X=>({...X,[I]:null})),us(X=>({...X,[I]:null})),fn.current[I]&&(fn.current[I].value="")},Ga=I=>{ve(I.target.value),I.target.style.height="auto",I.target.style.height=Math.min(I.target.scrollHeight,120)+"px",yn(I.target.value,"compose")},wo=(I,X)=>{we(Pe=>({...Pe,[I]:X})),yn(X,I)};return a.jsxs("div",{className:"cb-dashboard","data-theme":d?"dark":"light",children:[ns>0&&a.jsxs("div",{className:"pull-indicator",style:{height:ns},children:[a.jsx("div",{className:`pull-spinner ${he?"spinning":""}`,children:he?"":""}),a.jsx("span",{children:he?"Refreshing...":ns>60?"Release to refresh":"Pull to refresh"})]}),a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsxs("div",{className:"header-notif-wrap",ref:S,children:[a.jsxs("button",{className:"header-notif-btn",onClick:()=>{E(!ue),ue||xt()},"aria-label":"Notifications",children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),a.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),ot>0&&a.jsx("span",{className:"header-notif-badge",children:ot>9?"9+":ot})]}),ue&&a.jsxs("div",{className:"notif-panel",children:[a.jsxs("div",{className:"notif-panel-header",children:[a.jsx("span",{className:"notif-panel-title",children:"Notifications"}),Es.length>0&&a.jsx("button",{className:"notif-clear-btn",onClick:Kt,children:"Clear all"})]}),a.jsx("div",{className:"notif-panel-list",children:Es.length===0?a.jsx("div",{className:"notif-empty",children:"No notifications yet"}):Es.map(I=>a.jsxs("div",{className:`notif-item${I.read?"":" unread"}`,onClick:()=>{if(E(!1),I.type==="buddy_request"||I.type==="buddy_accept")y("/client/core-buddy/buddies");else if((I.type==="like"||I.type==="comment")&&I.postId){if(!rs.has(I.postId)){const X=new Set(rs);X.add(I.postId),Ts(X),As[I.postId]||pr(I.postId)}setTimeout(()=>{const X=document.getElementById(`post-${I.postId}`);X&&X.scrollIntoView({behavior:"smooth",block:"center"})},150)}else I.type==="like"||I.type==="comment"?document.querySelector(".cb-journey-section")?.scrollIntoView({behavior:"smooth"}):I.type==="mention"&&y(`/client/core-buddy/profile/${I.fromId}`)},children:[a.jsx("div",{className:"notif-item-avatar",children:I.fromPhotoURL?a.jsx("img",{src:I.fromPhotoURL,alt:""}):a.jsx("span",{children:(I.fromName||"?")[0]})}),a.jsxs("div",{className:"notif-item-body",children:[a.jsxs("p",{className:"notif-item-text",children:[a.jsx("strong",{children:I.fromName})," ",I.type==="buddy_request"&&"sent you a buddy request",I.type==="buddy_accept"&&"accepted your buddy request",I.type==="like"&&"liked your post",I.type==="comment"&&"commented on your post",I.type==="mention"&&"mentioned you"]}),a.jsx("span",{className:"notif-item-time",children:zp(I.createdAt)})]})]},I.id))})]})]}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{className:"refresh-btn",onClick:We,disabled:he,"aria-label":"Refresh",children:he?"":""}),a.jsx("button",{onClick:p,"aria-label":"Toggle theme",children:d?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})}),a.jsx("button",{onClick:i,"aria-label":"Log out",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),a.jsxs("main",{className:"cb-main",children:[a.jsxs("div",{className:"cb-ring-container",children:[a.jsxs("div",{className:"cb-ring",children:[a.jsx("svg",{className:"cb-ring-svg",viewBox:"0 0 200 200",children:Yy.map((I,X)=>{const Pe=X<j;return a.jsx("line",{x1:I.x1,y1:I.y1,x2:I.x2,y2:I.y2,className:`ring-tick ${Pe?"elapsed":"remaining"}`,strokeWidth:I.thick?"3":"2"},X)})}),a.jsxs("div",{className:"cb-ring-center",children:[a.jsxs("div",{className:"cb-ring-logo",onClick:()=>At.current?.click(),role:"button",tabIndex:0,"aria-label":"Change profile photo",children:[a.jsx("img",{src:Tt||"/Logo.webp",alt:Tt?"Profile":"Mind Core Fitness"}),a.jsx("div",{className:`cb-photo-overlay${Wt?" uploading":""}`,children:Wt?a.jsx("div",{className:"cb-photo-spinner"}):a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),a.jsx("input",{ref:At,type:"file",accept:"image/*",onChange:Yr,style:{display:"none"}})]}),!Tt&&!Wt&&a.jsx("div",{className:"cb-photo-badge",onClick:()=>At.current?.click(),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),a.jsxs("div",{className:"cb-ring-countdown",children:[a.jsx("span",{className:"cb-timer-digit",children:String(w.hours).padStart(2,"0")}),a.jsx("span",{className:"cb-timer-colon",children:":"}),a.jsx("span",{className:"cb-timer-digit",children:String(w.minutes).padStart(2,"0")}),a.jsx("span",{className:"cb-timer-colon",children:":"}),a.jsx("span",{className:"cb-timer-digit cb-timer-seconds",children:String(w.seconds).padStart(2,"0")})]}),a.jsx("span",{className:"cb-ring-label",children:"remaining today"}),a.jsxs("p",{className:"cb-ring-tagline",children:[Up[qt].text," ",a.jsx("strong",{children:Up[qt].bold})]},qt)]}),a.jsx("div",{className:"cb-stats-row",children:Gn.map(I=>{const X=(I.size==="large",38),Pe=2*Math.PI*X,Ge=Pe-I.pct/100*Pe;return a.jsxs("div",{className:`cb-stat-item${I.size==="large"?" cb-stat-large":""}`,children:[a.jsxs("div",{className:"cb-stat-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-stat-track",cx:"50",cy:"50",r:X}),a.jsx("circle",{className:"cb-stat-fill",cx:"50",cy:"50",r:X,style:{stroke:I.color},strokeDasharray:Pe,strokeDashoffset:Ge})]}),a.jsx("span",{className:"cb-stat-value",style:{color:I.color},children:I.value})]}),a.jsx("span",{className:"cb-stat-label",children:I.label})]},I.label)})}),a.jsxs("p",{className:"cb-coach-msg",children:[Zs.main," ",a.jsx("strong",{children:Ta}),"  ",Zs.sub]}),sn&&a.jsxs("button",{className:"cb-nudge-card",onClick:sn.action||void 0,style:sn.action?void 0:{cursor:"default"},children:[a.jsxs("div",{className:"cb-nudge-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-nudge-ring-track",cx:"50",cy:"50",r:"38"}),a.jsx("circle",{className:"cb-nudge-ring-fill",cx:"50",cy:"50",r:"38",strokeDasharray:2*Math.PI*38,strokeDashoffset:2*Math.PI*38-sn.pct/100*2*Math.PI*38})]}),a.jsx("span",{className:"cb-nudge-ring-val",children:sn.ringLabel})]}),a.jsxs("div",{className:"cb-nudge-info",children:[a.jsx("span",{className:"cb-nudge-label",children:sn.label}),a.jsx("span",{className:"cb-nudge-title",children:sn.message}),sn.cta&&a.jsxs("span",{className:"cb-nudge-cta",children:[sn.cta," "]})]})]}),a.jsxs("div",{className:"cb-features",children:[t?.buddyEnabled&&a.jsxs("button",{className:"cb-feature-card cb-card-buddy ripple-btn",onClick:I=>{hr(I),y("/client/core-buddy/buddy")},children:[a.jsx("div",{className:"cb-buddy-icon",children:a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 2a4 4 0 0 1 4 4v2a4 4 0 0 1-8 0V6a4 4 0 0 1 4-4z"}),a.jsx("path",{d:"M18 14c2 1 3 3 3 5v2H3v-2c0-2 1-4 3-5"}),a.jsx("circle",{cx:"9",cy:"7",r:"0.5",fill:"currentColor"}),a.jsx("circle",{cx:"15",cy:"7",r:"0.5",fill:"currentColor"}),a.jsx("path",{d:"M9.5 10a2.5 2.5 0 0 0 5 0"}),a.jsx("path",{d:"M7 13c1.5 1 3.5 1.5 5 1.5s3.5-.5 5-1.5"})]})}),a.jsxs("div",{className:"cb-card-content",children:[a.jsxs("h3",{children:["Buddy ",a.jsx("span",{className:"cb-buddy-badge",children:"AI"})]}),a.jsx("p",{className:"cb-card-desc",children:"Your AI training partner"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:`cb-feature-card cb-card-nutrition cb-card-has-preview ripple-btn${g?"":" cb-card-locked"}`,onClick:I=>{hr(I),y(g?"/client/core-buddy/nutrition":"/upgrade")},children:[a.jsxs("div",{className:"cb-card-top-row",children:[a.jsx("div",{className:"cb-card-content",children:a.jsxs("h3",{children:["Today's Nutrition ",!g&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]})}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsx("div",{className:"cb-card-preview-row",children:a.jsx("div",{className:"cb-mini-rings",children:[{label:"P",pct:Kn("protein"),color:"#14b8a6"},{label:"C",pct:Kn("carbs"),color:"var(--color-primary)"},{label:"F",pct:Kn("fats"),color:"#eab308"},{label:"Cal",pct:Kn("calories"),color:"#38B6FF"}].map(I=>{const Pe=2*Math.PI*38,Ge=Pe-I.pct/100*Pe;return a.jsxs("div",{className:"cb-mini-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-mini-track",cx:"50",cy:"50",r:38}),a.jsx("circle",{className:"cb-mini-fill",cx:"50",cy:"50",r:38,style:{stroke:I.color},strokeDasharray:Pe,strokeDashoffset:Ge})]}),a.jsx("span",{style:{color:I.color},children:I.label})]},I.label)})})}),a.jsx("p",{className:"cb-card-desc",children:"Track macros, scan barcodes, log water"})]}),a.jsxs("button",{className:"cb-feature-card cb-card-workouts-hero ripple-btn",onClick:I=>{hr(I),y("/client/core-buddy/workouts")},children:[a.jsx("h3",{className:"cb-hero-title",children:"Workouts"}),a.jsxs("div",{className:"cb-hero-stats",children:[a.jsxs("span",{children:[ee," this week"]}),a.jsx("span",{className:"cb-hero-dot",children:""}),a.jsxs("span",{children:[K," total"]})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"cb-grid-row",children:[a.jsxs("button",{className:`cb-feature-card cb-grid-card cb-card-consistency ripple-btn${g?"":" cb-card-locked"}`,onClick:I=>{hr(I),y(g?"/client/core-buddy/consistency":"/upgrade")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsxs("h3",{children:["Habits ",!g&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),a.jsx("div",{className:"cb-habit-dots",children:Array.from({length:Ki},(I,X)=>a.jsx("span",{className:`cb-habit-dot${X<F?" done":""}`},X))}),a.jsxs("span",{className:"cb-habit-dots-label",children:[F,"/",Ki," today"]})]}),a.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:`cb-feature-card cb-grid-card cb-card-progress ripple-btn${g?"":" cb-card-locked"}`,onClick:I=>{hr(I),y(g?"/client/personal-bests?mode=corebuddy":"/upgrade")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsxs("h3",{children:["PBs ",!g&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),Oe.length>0?a.jsx("div",{className:"cb-pb-preview",children:Oe.slice(0,2).map(I=>a.jsxs("div",{className:"cb-pb-entry",children:[a.jsx("span",{className:"cb-pb-name",children:I.name}),a.jsxs("span",{className:"cb-pb-value",children:[I.weight,"kg"]})]},I.name))}):a.jsxs("div",{className:"cb-progress-preview",children:[a.jsx("svg",{className:"cb-progress-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),a.jsx("span",{children:"Start lifting!"})]})]}),a.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]})]}),a.jsxs("button",{className:`cb-feature-card cb-card-leaderboard ripple-btn${g?"":" cb-card-locked"}`,onClick:I=>{hr(I),y(g?"/client/leaderboard":"/upgrade")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsxs("h3",{children:["Leaderboard ",!g&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),Ue.length>0?a.jsx("div",{className:"cb-lb-preview",children:Ue.map((I,X)=>{const Pe=["#FFD700","#A8B4C0","#CD7F32"][X],Ge=I.name?I.name.split(" ").map(jt=>jt[0]).join("").slice(0,2).toUpperCase():"?",dt=I.id===t?.id;return a.jsxs("div",{className:`cb-lb-entry${dt?" cb-lb-me":""}`,children:[a.jsx("div",{className:"cb-lb-avatar",style:{borderColor:Pe},children:I.photoURL?a.jsx("img",{src:I.photoURL,alt:"",className:"cb-lb-avatar-img"}):a.jsx("span",{children:Ge})}),a.jsxs("span",{className:"cb-lb-rank",style:{color:Pe},children:["#",X+1]})]},I.id)})}):a.jsx("p",{children:"Opt in to compete with your Core Buddies"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:`cb-feature-card cb-card-buddies ripple-btn${g?"":" cb-card-locked"}`,onClick:I=>{hr(I),y(g?"/client/core-buddy/buddies":"/upgrade")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsxs("h3",{children:["Buddies ",!g&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),a.jsx("p",{children:"Connect with other members and track each other's progress"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:`cb-achievements-section${g?"":" cb-card-locked"}`,children:[a.jsxs("h3",{className:"cb-achievements-title",children:["Achievements ",!g&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),g?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"cb-badges-scroll",children:pu.map(I=>{const X=Ee.includes(I.id);return a.jsx("button",{className:`cb-badge${X?" unlocked":" locked"}`,onClick:()=>pt(I),children:a.jsx("img",{src:I.img,alt:I.name,className:"cb-badge-img"})},I.id)})}),a.jsxs("p",{className:"cb-badges-count",children:[Ee.length,"/",pu.length," unlocked"]})]}):a.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>y("/upgrade"),children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{children:"Upgrade to unlock achievements"})]})]}),a.jsxs("div",{className:"cb-journey-section",children:[a.jsxs("h3",{className:"cb-journey-title",children:["My Journey ",!g&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),g?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"journey-compose",children:[a.jsx("div",{className:"journey-compose-avatar",children:Tt?a.jsx("img",{src:Tt,alt:""}):a.jsx("span",{children:Zc(t?.name)})}),a.jsxs("div",{className:"journey-compose-body",style:{position:"relative"},children:[a.jsx("textarea",{ref:Cn,placeholder:"Share your progress... (use @ to mention)",value:Q,onChange:Ga,rows:1,maxLength:500}),Fe&&Mt==="compose"&&jn.length>0&&a.jsx("div",{className:"mention-dropdown",children:jn.map(I=>a.jsxs("button",{className:"mention-option",onClick:()=>ms(I,"compose"),children:[a.jsx("div",{className:"mention-option-avatar",children:I.photoURL?a.jsx("img",{src:I.photoURL,alt:""}):a.jsx("span",{children:Zc(I.name)})}),a.jsx("span",{children:I.name})]},I.id))}),St&&a.jsxs("div",{className:"journey-image-preview",children:[a.jsx("img",{src:St,alt:"Preview"}),a.jsx("button",{className:"journey-image-remove",onClick:mr,"aria-label":"Remove image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"journey-compose-actions",children:[a.jsx("button",{className:"journey-image-btn",onClick:()=>hn.current?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:hn,type:"file",accept:"image/*",onChange:Lr,hidden:!0}),(Q.trim()||at)&&a.jsx("button",{className:"journey-post-btn",onClick:Or,disabled:Xt,children:Xt?a.jsx("div",{className:"journey-btn-spinner"}):"Post"})]})]})]}),Ut?a.jsx("div",{className:"journey-loading",children:a.jsx("div",{className:"cb-spinner"})}):wt.length===0?a.jsxs("div",{className:"journey-empty",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("p",{children:"Start sharing your fitness journey!"})]}):a.jsx("div",{className:"journey-list",children:wt.map(I=>a.jsxs("div",{id:`post-${I.id}`,className:"journey-post",children:[a.jsxs("div",{className:"journey-post-header",children:[a.jsx("div",{className:"journey-post-avatar",children:I.authorPhotoURL?a.jsx("img",{src:I.authorPhotoURL,alt:""}):a.jsx("span",{children:Zc(I.authorName)})}),a.jsxs("div",{className:"journey-post-meta",children:[a.jsx("span",{className:"journey-post-name",children:I.authorName}),a.jsx("span",{className:"journey-post-time",children:zp(I.createdAt)})]}),a.jsx("button",{className:"journey-delete-btn",onClick:()=>ji(I.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),I.content&&a.jsx("p",{className:"journey-post-content",children:Fn(I.content)}),I.imageURL&&a.jsx("div",{className:"journey-post-image",children:a.jsx("img",{src:I.imageURL,alt:"Post",loading:"lazy"})}),a.jsxs("div",{className:"journey-post-actions",children:[a.jsxs("button",{className:`journey-action-btn${Rs.has(I.id)?" liked":""}`,onClick:()=>Ea(I.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:Rs.has(I.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:I.likeCount||0})]}),a.jsxs("button",{className:`journey-action-btn${rs.has(I.id)?" active":""}`,onClick:()=>jr(I.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:I.commentCount||0})]})]}),rs.has(I.id)&&a.jsxs("div",{className:"journey-comments",children:[As[I.id]?.length>0?As[I.id].map(X=>a.jsxs("div",{className:"journey-comment",children:[a.jsx("div",{className:"journey-comment-avatar",children:X.authorPhotoURL?a.jsx("img",{src:X.authorPhotoURL,alt:""}):a.jsx("span",{children:Zc(X.authorName)})}),a.jsxs("div",{className:"journey-comment-body",children:[a.jsxs("div",{className:"journey-comment-bubble",children:[a.jsx("span",{className:"journey-comment-name",children:X.authorName}),X.replyToName&&a.jsxs("span",{className:"journey-comment-reply-tag",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"9 14 4 9 9 4"}),a.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),X.replyToName]}),X.content&&a.jsx("span",{className:"journey-comment-text",children:Fn(X.content)}),X.imageURL&&a.jsx("img",{className:"journey-comment-image",src:X.imageURL,alt:"Comment",loading:"lazy"})]}),a.jsxs("div",{className:"journey-comment-actions-row",children:[a.jsx("span",{className:"journey-comment-time",children:zp(X.createdAt)}),a.jsx("button",{className:"journey-comment-reply-btn",onClick:()=>Rt(Pe=>({...Pe,[I.id]:{id:X.id,authorName:X.authorName}})),children:"Reply"}),a.jsx("button",{className:"journey-comment-delete-btn",onClick:()=>Os(I.id,X.id),"aria-label":"Delete comment",children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]})]},X.id)):a.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),it[I.id]&&a.jsxs("div",{className:"journey-comment-replying",children:[a.jsxs("span",{children:["Replying to ",a.jsx("strong",{children:it[I.id].authorName})]}),a.jsx("button",{onClick:()=>Rt(X=>({...X,[I.id]:null})),"aria-label":"Cancel reply",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),kt[I.id]&&a.jsxs("div",{className:"journey-comment-img-preview",children:[a.jsx("img",{src:kt[I.id],alt:"Preview"}),a.jsx("button",{onClick:()=>xo(I.id),"aria-label":"Remove image",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[a.jsx("button",{className:"journey-comment-img-btn",onClick:()=>fn.current[I.id]?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:X=>{fn.current[I.id]=X},type:"file",accept:"image/*",onChange:X=>Qr(I.id,X),hidden:!0}),a.jsx("input",{type:"text",placeholder:"Comment",value:ye[I.id]||"",onChange:X=>wo(I.id,X.target.value),onKeyDown:X=>{X.key==="Enter"&&Na(I.id)},maxLength:300}),Fe&&Mt===I.id&&jn.length>0&&a.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:jn.map(X=>a.jsxs("button",{className:"mention-option",onClick:()=>ms(X,I.id),children:[a.jsx("div",{className:"mention-option-avatar",children:X.photoURL?a.jsx("img",{src:X.photoURL,alt:""}):a.jsx("span",{children:Zc(X.name)})}),a.jsx("span",{children:X.name})]},X.id))}),a.jsx("button",{onClick:()=>Na(I.id),disabled:!(ye[I.id]||"").trim()&&!ct[I.id]||_e[I.id],children:_e[I.id]?a.jsx("div",{className:"journey-btn-spinner-sm"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),a.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},I.id))})]}):a.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>y("/upgrade"),children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{children:"Upgrade to share your journey"})]})]})]})]}),mt&&a.jsx("div",{className:"cb-badge-overlay",onClick:()=>pt(null),children:a.jsxs("div",{className:"cb-badge-overlay-content",onClick:I=>I.stopPropagation(),children:[a.jsx("img",{src:mt.img,alt:mt.name,className:`cb-badge-overlay-img${Ee.includes(mt.id)?"":" cb-badge-overlay-img-locked"}`}),Ee.includes(mt.id)?a.jsx("span",{className:"cb-badge-status unlocked",children:"Unlocked"}):a.jsx("span",{className:"cb-badge-status locked",children:"Locked"}),a.jsx("button",{className:"cb-badge-overlay-close",onClick:()=>pt(null),children:"Tap to close"})]})}),a.jsx(la,{active:"home"}),Ve&&a.jsxs("div",{className:`toast-notification ${Ve.type}`,children:[Ve.type==="info"&&a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),a.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),Ve.message]}),a.jsx(lD,{steps:Be,active:Y,onFinish:Vn}),Je&&a.jsxs("div",{className:"cb-celebration-overlay",onClick:()=>ut(null),children:[a.jsx("div",{className:"cb-confetti-container",children:Array.from({length:30},(I,X)=>a.jsx("span",{className:"cb-confetti-piece",style:{"--angle":`${Math.random()*360}deg`,"--distance":`${80+Math.random()*120}px`,"--delay":`${Math.random()*.3}s`,"--color":["#FFD700","#FF6B6B","#4ECDC4","#45B7D1","#F7DC6F","#BB8FCE","#FF8C42","#38B6FF"][X%8],"--size":`${6+Math.random()*6}px`,"--drift":`${(Math.random()-.5)*60}px`}},X))}),a.jsxs("div",{className:"cb-celebration-content",onClick:I=>I.stopPropagation(),children:[a.jsx("div",{className:"cb-celebration-glow"}),a.jsx("img",{src:Je.img,alt:Je.name,className:"cb-celebration-badge-img"}),a.jsx("h2",{className:"cb-celebration-title",children:"Badge Unlocked!"}),a.jsx("p",{className:"cb-celebration-name",children:Je.name}),a.jsx("button",{className:"cb-celebration-dismiss",onClick:()=>ut(null),children:"Tap to continue"})]})]})]})}function Ku({children:n,onRefresh:e}){const[t,i]=v.useState(0),[l,u]=v.useState(!1),d=v.useRef(null),p=v.useRef(0),g=v.useRef(!1),y=v.useCallback(j=>{window.scrollY<=0&&(p.current=j.touches[0].clientY,g.current=!0)},[]),w=v.useCallback(j=>{if(!g.current||l)return;const O=j.touches[0].clientY-p.current;O>20&&window.scrollY<=0&&(j.preventDefault(),i(Math.min((O-20)*.35,80)))},[l]),k=v.useCallback(async()=>{t>55&&!l&&(u(!0),e?await e():window.location.reload(),u(!1)),i(0),g.current=!1},[t,l,e]);return a.jsxs("div",{ref:d,onTouchStart:y,onTouchMove:w,onTouchEnd:k,children:[a.jsxs("div",{className:`pull-refresh-indicator ${t>0?"visible":""} ${l?"refreshing":""}`,style:{height:t},children:[a.jsx("div",{className:`refresh-spinner ${l?"spinning":""}`,children:a.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:a.jsx("path",{fill:"currentColor",d:"M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"})})}),a.jsx("span",{className:"refresh-text",children:l?"Refreshing...":"Pull to refresh"})]}),n]})}const Fp=new Map;function Yi(){return new Date().toISOString().split("T")[0]}const b2=[{key:"breakfast",label:"Breakfast"},{key:"lunch",label:"Lunch"},{key:"dinner",label:"Dinner"},{key:"snacks",label:"Snacks"}],mD={breakfast:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1"}),a.jsx("path",{d:"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"}),a.jsx("line",{x1:"6",y1:"1",x2:"6",y2:"4"}),a.jsx("line",{x1:"10",y1:"1",x2:"10",y2:"4"}),a.jsx("line",{x1:"14",y1:"1",x2:"14",y2:"4"})]}),lunch:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}),dinner:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),snacks:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})};function pD(){const n=new Date().getHours();return n<11?"breakfast":n<14?"lunch":n<17?"snacks":"dinner"}function gD(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Pr(),{isDark:l,toggleTheme:u,accent:d}=ja(),p=Wn(),[g,y]=v.useState("loading"),[w,k]=v.useState(null),[j,O]=v.useState({gender:"male",age:"",weight:"",weightUnit:"kg",height:"",heightUnit:"cm",heightFeet:"",heightInches:"",dailyActivity:"sedentary",trainingFrequency:"moderate",goal:"maintain",deficitLevel:"moderate"}),[q,B]=v.useState(null),[V,ne]=v.useState(Yi()),[K,le]=v.useState({entries:[],water:0}),[ge,Ie]=v.useState({protein:0,carbs:0,fats:0,calories:0}),[Te,R]=v.useState(!1),[T,A]=v.useState(!1),[L,D]=v.useState(()=>{const E=new Date;return{year:E.getFullYear(),month:E.getMonth()}}),[F,M]=v.useState(pD),[$e,bt]=v.useState(null),[H,fe]=v.useState(null),[Me,Ke]=v.useState(!1),[ee,P]=v.useState(null),[se,Se]=v.useState(""),[Oe,st]=v.useState(!1),[Ue,gt]=v.useState(""),[Tt,rt]=v.useState([]),[Wt,js]=v.useState(!1),[At,Ee]=v.useState({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),[Z,mt]=v.useState(null),[pt,Je]=v.useState("100"),[ut,tt]=v.useState(0),[Ze,Pt]=v.useState("weight"),[Ks,Ct]=v.useState(0),[as,on]=v.useState(null);v.useRef(null);const qt=v.useRef(!1),Cs=v.useRef(null),ns=v.useRef(null),_s=v.useRef(null),he=v.useCallback((E,S="info")=>{on({message:E,type:S}),setTimeout(()=>on(null),3e3)},[]);v.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),v.useEffect(()=>{if(!t?.id)return;(async()=>{try{const S=await Ss(He(pe,"nutritionTargets",t.id));S.exists()?(k(S.data()),y("dashboard")):y("setup")}catch(S){console.error("Error loading nutrition data:",S),y("setup")}})()},[t?.id]),v.useEffect(()=>{if(!t?.id)return;(async()=>{try{const S=await Ss(He(pe,"nutritionLogs",`${t.id}_${V}`));if(S.exists()){const G=S.data();le({entries:G.entries||[],water:G.water||0})}else le({entries:[],water:0})}catch(S){console.error("Error loading log:",S),le({entries:[],water:0})}})()},[t?.id,V]),v.useEffect(()=>{const E=K.entries.reduce((S,G)=>({protein:S.protein+(G.protein||0),carbs:S.carbs+(G.carbs||0),fats:S.fats+(G.fats||0),calories:S.calories+(G.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});Ie(E)},[K.entries]);const Re=async E=>{try{await Ds(He(pe,"nutritionLogs",`${t.id}_${V}`),{clientId:t.id,date:V,entries:E.entries,water:E.water,updatedAt:vt.now()})}catch(S){console.error("Error saving nutrition log:",S)}},ze=V===Yi(),Ye=(E,S)=>new Date(E,S+1,0).getDate(),Ve=(E,S)=>new Date(E,S,1).getDay(),Le=["January","February","March","April","May","June","July","August","September","October","November","December"],De=["Su","Mo","Tu","We","Th","Fr","Sa"],wt=()=>{let E=parseFloat(j.weight);j.weightUnit==="lbs"&&(E*=.453592);let S;j.heightUnit==="cm"?S=parseFloat(j.height):S=(parseFloat(j.heightFeet)||0)*30.48+(parseFloat(j.heightInches)||0)*2.54;const G=parseInt(j.age);let ae=j.gender==="male"?10*E+6.25*S-5*G+5:10*E+6.25*S-5*G-161;const qe=ae*{sedentary:1.2,light:1.3,moderate:1.4,active:1.5}[j.dailyActivity],Fe={low:100,moderate:200,high:300,daily:400},Lt=Math.round(qe+Fe[j.trainingFrequency]);let Mt=Lt,Ys,jn;switch(j.goal){case"lose":Mt=Lt*(1-{light:.15,moderate:.2,harsh:.25}[j.deficitLevel]),Ys=2.2,jn=.3;break;case"build":Mt=Lt*1.1,Ys=2,jn=.22;break;default:Ys=1.8,jn=.25}Mt=Math.max(Mt,j.gender==="male"?1400:1100);const gn=Math.round(E*Ys),Js=Math.round(Mt*jn/9),Hs=Math.max(0,Math.round((Mt-gn*4-Js*9)/4));B({calories:Math.round(Mt),protein:gn,carbs:Hs,fats:Js,bmr:Math.round(ae),neat:Math.round(qe),exerciseAdd:Fe[j.trainingFrequency],tdee:Math.round(Lt)})},ft=async()=>{if(q)try{const E={clientId:t.id,calories:q.calories,protein:q.protein,carbs:q.carbs,fats:q.fats,waterGoal:8,goal:j.goal,updatedAt:vt.now()};await Ds(He(pe,"nutritionTargets",t.id),E),k(E),y("dashboard"),he("Macro targets saved!","success")}catch(E){console.error("Error saving targets:",E),he("Failed to save targets. Please try again.","error")}},Ut=()=>{const E=j.weight&&parseFloat(j.weight)>0,S=j.age&&parseInt(j.age)>0,G=j.heightUnit==="cm"?j.height&&parseFloat(j.height)>0:j.heightFeet&&parseFloat(j.heightFeet)>0||j.heightInches&&parseFloat(j.heightInches)>0;return E&&S&&G},Gt="nut_favourite_foods",Q=()=>{try{return JSON.parse(localStorage.getItem(Gt)||"[]")}catch{return[]}},ve=E=>Q().some(S=>S.name.toLowerCase()===(E||"").toLowerCase()),at=E=>{const S=Q(),G=S.findIndex(ae=>ae.name.toLowerCase()===E.name.toLowerCase());G>=0?S.splice(G,1):S.unshift({name:E.name,protein:E.protein,carbs:E.carbs,fats:E.fats,calories:E.calories,serving:E.serving,per100g:E.per100g||null,servingUnit:E.servingUnit||"g",portion:E.portion||null}),localStorage.setItem(Gt,JSON.stringify(S)),Ct(ae=>ae+1)},It=E=>{const S=[...K.entries,{...E,meal:F,id:Date.now(),addedAt:new Date().toISOString()}],G={...K,entries:S};le(G),Re(G),fe(null),mt(null),Je("100"),tt(0),Pt("weight"),Ee({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),he("Food added!","success")},St=E=>{const S=K.entries.filter(ae=>ae.id!==E),G={...K,entries:S};le(G),Re(G)},ts=v.useRef(null),Xt=async()=>{Ke(!0);const E=document.querySelector("#barcode-reader");if(!E){Ke(!1),he("Scanner container not found.","error");return}if(!ts.current)try{const G=await kr(()=>import("./quagga.min-BbicSfvA.js").then(ae=>ae.q),[]);ts.current=G.default}catch(G){console.error("Failed to load barcode scanner:",G),Ke(!1),he("Could not load scanner.","error");return}const S=ts.current;S.init({inputStream:{type:"LiveStream",target:E,constraints:{facingMode:"environment",width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080}}},locator:{patchSize:"medium",halfSample:!0},numOfWorkers:navigator.hardwareConcurrency||2,decoder:{readers:["ean_reader","ean_8_reader","upc_reader","upc_e_reader","code_128_reader","code_39_reader"]},locate:!0},G=>{if(G){console.error("Quagga init error:",G),Ke(!1),he("Could not access camera. Check permissions.","error");return}S.start(),qt.current=!0}),S.onDetected(G=>{const ae=G.codeResult.decodedCodes?.filter(qe=>qe.error!==void 0)?.map(qe=>qe.error)||[];if((ae.length>0?ae.reduce((qe,Fe)=>qe+Fe,0)/ae.length:1)<.15){const qe=G.codeResult.code;S.offDetected(),P(qe)}})},zt=()=>{const E=ts.current;qt.current&&E&&(E.stop(),E.offDetected(),qt.current=!1),Ke(!1)},Rs=/\b(milk|semi.skimmed|skimmed|whole milk|oat milk|almond milk|soy milk|juice|smoothie|water|squash|cordial|cola|pepsi|fanta|lemonade|soda|beer|wine|cider|lager|spirit|whisky|vodka|rum|gin|brandy|cream|yoghurt drink|milkshake|coffee|tea|broth|stock|soup|sauce|ketchup|vinegar|oil|syrup|honey|custard|coconut water|kombucha|energy drink|protein shake)\b/i,tn=E=>/ml|cl|\dl(?!b)|litre|liter|fl\s?oz/i.test((E||"").replace(/\s/g,"")),rs=E=>{if(!E)return{value:100,unit:"g"};const S=E.toLowerCase().replace(/\s/g,""),G=S.match(/([\d.]+)/),ae=G?parseFloat(G[1]):100;return tn(E)?/cl/.test(S)?{value:ae*10,unit:"ml"}:/(?:^|\d)l(?!i)/.test(S)&&!/ml/.test(S)?{value:ae*1e3,unit:"ml"}:{value:ae,unit:"ml"}:{value:ae,unit:"g"}},Ts=E=>{if(tn(E.serving_size)||tn(E.quantity))return"ml";const S=E.product_name||E.product_name_en||"";return Rs.test(S)?"ml":"g"},As=[{pattern:/\b(toast|bread|loaf|brioche|bagel|pitta|wrap|tortilla|crumpet|muffin|waffle|pancake)\b/i,label:"slice",weight:36},{pattern:/\begg\b/i,label:"egg",weight:60},{pattern:/\b(biscuit|cookie|digestive|hobnob|rich tea|oreo)\b/i,label:"biscuit",weight:13},{pattern:/\b(sausage|banger)\b/i,label:"sausage",weight:57},{pattern:/\b(rasher|bacon)\b/i,label:"rasher",weight:25},{pattern:/\b(rice cake)\b/i,label:"cake",weight:9},{pattern:/\b(cracker|ryvita)\b/i,label:"cracker",weight:10}],z=(E,S)=>{const G=E||"",ae=G.match(/\((\d+\.?\d*)\s*g\)/i),Qe=G.match(/(?:^|per\s+)(\d*\s*[a-z][a-z\s]*?)(?:\s*\(|\s*-\s*|\s*$)/i);if(ae&&Qe){const Lt=parseFloat(ae[1]);let Mt=Qe[1].replace(/^\d+\s*/,"").trim();if(Mt&&Lt>0)return{label:Mt,weight:Lt}}const qe=G.match(/(\d+\.?\d*)\s*g\s*[\/=]\s*(\d*\s*[a-z][a-z\s]*)/i);if(qe){const Lt=parseFloat(qe[1]);let Mt=qe[2].replace(/^\d+\s*/,"").trim();if(Mt&&Lt>0)return{label:Mt,weight:Lt}}const Fe=S||"";for(const{pattern:Lt,label:Mt,weight:Ys}of As)if(Lt.test(Fe))return{label:Mt,weight:Ys};return null},ye=E=>{const S=E.nutriments||{},G=Ts(E),ae=rs(E.serving_size),Qe=G==="ml"?ae.unit==="ml"?ae.value:100:ae.value,qe=E.product_name||E.product_name_en||"Unknown Product",Fe=z(E.serving_size,qe);return{name:qe,brand:E.brands||"",image:E.image_small_url||E.image_url||null,servingSize:E.serving_size||"100g",servingValue:Qe,servingUnit:G,portion:Fe,protein:Math.round(S.proteins_100g||S.proteins||0),carbs:Math.round(S.carbohydrates_100g||S.carbohydrates||0),fats:Math.round(S.fat_100g||S.fat||0),calories:Math.round(S["energy-kcal_100g"]||S["energy-kcal"]||(S.energy_100g?S.energy_100g/4.184:0)),per100g:!0}},we=async E=>{st(!0);try{const S=`https://world.openfoodfacts.org/api/v2/product/${E}?fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,G=await fetch(S);if(!G.ok)throw new Error(`HTTP ${G.status}`);const ae=await G.json();if(ae.status==="success"||ae.status===1||ae.product){const Qe=ye(ae.product);Qe.calories===0&&Qe.protein===0&&Qe.carbs===0?he("Product found but no nutrition data available.","error"):(mt(Qe),Qe.portion?(tt(1),Je(String(Qe.portion.weight)),Pt("portion")):(tt(0),Je(String(Qe.servingValue||100)),Pt("weight")),Se(""))}else he("Product not found. Try search or manual entry.","error")}catch(S){console.error("Barcode lookup error:",S),he("Failed to look up product. Check your connection.","error")}st(!1)},_e=(E,S,G)=>{const ae=E.toLowerCase().trim(),Qe=S.toLowerCase().trim(),qe=G.toLowerCase().trim();let Fe=0;return(ae===qe||ae===qe+"s"||ae+"s"===qe)&&(Fe+=100),(ae.endsWith(" "+qe)||ae.endsWith(" "+qe+"s"))&&(Fe+=40),(ae.startsWith(qe+" ")||ae.startsWith(qe+"s "))&&(Fe+=15),qe.split(/\s+/).some(Mt=>Qe===Mt||Qe.startsWith(Mt))&&(Fe+=30),Fe+=Math.max(0,30-ae.length),Fe},be=async()=>{if(!Ue.trim())return;Cs.current&&Cs.current.abort();const E=new AbortController;Cs.current=E;const S=Ue.trim().toLowerCase(),G=S.split(/\s+/).filter(Boolean);if(Fp.has(S)){rt(Fp.get(S));return}js(!0);try{const Qe=`https://world.openfoodfacts.org/cgi/search.pl?search_terms=${encodeURIComponent(Ue.trim())}&search_simple=1&action=process&json=1&page_size=10&lc=en&sort_by=unique_scans_n&fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,qe=await fetch(Qe,{signal:E.signal});if(!qe.ok)throw new Error(`HTTP ${qe.status}`);const Lt=((await qe.json()).products||[]).map(Mt=>ye(Mt)).filter(Mt=>Mt.name!=="Unknown Product"&&(Mt.calories>0||Mt.protein>0)).filter(Mt=>{const Ys=(Mt.name+" "+Mt.brand).toLowerCase();return G.every(jn=>Ys.includes(jn))}).sort((Mt,Ys)=>_e(Ys.name,Ys.brand,S)-_e(Mt.name,Mt.brand,S)).slice(0,10);Fp.set(S,Lt),rt(Lt),Lt.length===0&&he("No results found. Try a different search.","info")}catch(ae){if(ae.name==="AbortError")return;console.error("Search error:",ae),he("Search failed. Check your connection.","error")}js(!1)};v.useEffect(()=>{if(ns.current&&clearTimeout(ns.current),!(!Ue.trim()||H!=="search"||Z))return ns.current=setTimeout(()=>{be()},700),()=>clearTimeout(ns.current)},[Ue]);const it=()=>{const E={...K,water:K.water+1};le(E),Re(E)},Rt=()=>{if(K.water<=0)return;const E={...K,water:K.water-1};le(E),Re(E)},ct={"ring-protein":"#14b8a6","ring-carbs":"var(--color-primary)","ring-fats":"#eab308","ring-cals":"rgba(150,150,150,0.55)"},_t=80,kt=2*Math.PI*_t,us=(E,S,G,ae,Qe)=>{const qe=ae>0?Math.min(100,Math.round(G/ae*100)):0,Fe=kt-qe/100*kt,Lt=ct[Qe]||"#14b8a6";return a.jsxs("div",{className:"nut-ring-wrap",children:[a.jsxs("svg",{className:"nut-ring-svg",viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"nut-arc-track",cx:"100",cy:"100",r:_t}),a.jsx("circle",{className:"nut-arc-fill",cx:"100",cy:"100",r:_t,style:{stroke:Lt},strokeDasharray:kt,strokeDashoffset:Fe})]}),a.jsxs("div",{className:"nut-ring-center",children:[a.jsx("span",{className:"nut-ring-value",style:{color:Lt},children:Math.round(G)}),a.jsxs("span",{className:"nut-ring-target",children:["/ ",ae,E==="Calories"?"":"g"]}),a.jsx("span",{className:"nut-ring-label",style:{color:Lt},children:S})]}),a.jsxs("span",{className:"nut-ring-pct",style:{color:Lt},children:[qe,"%"]})]})};if(v.useEffect(()=>{if(!ee)return;const E=setTimeout(()=>{const S=ee;zt(),P(null),we(S)},1500);return()=>clearTimeout(E)},[ee]),v.useEffect(()=>()=>{const E=ts.current;if(qt.current&&E){try{E.stop(),E.offDetected()}catch{}qt.current=!1}},[]),i||g==="loading")return a.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsx("div",{className:"nut-loading-inline",children:a.jsx("div",{className:"cb-loading-spinner"})})]});if(g==="setup")return a.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"nut-main",children:[a.jsxs("div",{className:"nut-setup-intro",children:[a.jsx("h2",{children:"Set Your Daily Targets"}),a.jsx("p",{children:"Calculate your personalised macros based on your body and goals."})]}),a.jsxs("div",{className:"nut-calc-form",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Gender"}),a.jsxs("div",{className:"nut-toggle-group",children:[a.jsx("button",{className:j.gender==="male"?"active":"",onClick:()=>{O(E=>({...E,gender:"male"})),B(null)},children:"Male"}),a.jsx("button",{className:j.gender==="female"?"active":"",onClick:()=>{O(E=>({...E,gender:"female"})),B(null)},children:"Female"})]})]}),a.jsxs("div",{className:"nut-form-row",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Age"}),a.jsx("input",{type:"number",value:j.age,onChange:E=>{O(S=>({...S,age:E.target.value})),B(null)},placeholder:"Years",min:"15",max:"100"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Weight"}),a.jsxs("div",{className:"nut-input-unit",children:[a.jsx("input",{type:"number",value:j.weight,onChange:E=>{O(S=>({...S,weight:E.target.value})),B(null)},placeholder:j.weightUnit,min:"30",max:"300"}),a.jsxs("div",{className:"nut-unit-toggle",children:[a.jsx("button",{className:j.weightUnit==="kg"?"active":"",onClick:()=>{O(E=>({...E,weightUnit:"kg"})),B(null)},children:"kg"}),a.jsx("button",{className:j.weightUnit==="lbs"?"active":"",onClick:()=>{O(E=>({...E,weightUnit:"lbs"})),B(null)},children:"lbs"})]})]})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Height"}),a.jsxs("div",{className:"nut-input-unit",children:[j.heightUnit==="cm"?a.jsx("input",{type:"number",value:j.height,onChange:E=>{O(S=>({...S,height:E.target.value})),B(null)},placeholder:"cm",min:"100",max:"250"}):a.jsxs("div",{className:"nut-height-imperial",children:[a.jsx("input",{type:"number",value:j.heightFeet,onChange:E=>{O(S=>({...S,heightFeet:E.target.value})),B(null)},placeholder:"ft",min:"4",max:"7"}),a.jsx("input",{type:"number",value:j.heightInches,onChange:E=>{O(S=>({...S,heightInches:E.target.value})),B(null)},placeholder:"in",min:"0",max:"11"})]}),a.jsxs("div",{className:"nut-unit-toggle",children:[a.jsx("button",{className:j.heightUnit==="cm"?"active":"",onClick:()=>{O(E=>({...E,heightUnit:"cm"})),B(null)},children:"cm"}),a.jsx("button",{className:j.heightUnit==="ft"?"active":"",onClick:()=>{O(E=>({...E,heightUnit:"ft"})),B(null)},children:"ft/in"})]})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Daily Activity (outside of training)"}),a.jsxs("select",{value:j.dailyActivity,onChange:E=>{O(S=>({...S,dailyActivity:E.target.value})),B(null)},children:[a.jsx("option",{value:"sedentary",children:"Sedentary  desk job, under 5k steps"}),a.jsx("option",{value:"light",children:"Lightly Active  office + walking, 5-8k steps"}),a.jsx("option",{value:"moderate",children:"Moderately Active  on feet often, 8-12k steps"}),a.jsx("option",{value:"active",children:"Very Active  physical job, 12k+ steps"})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Training Sessions per Week"}),a.jsxs("select",{value:j.trainingFrequency,onChange:E=>{O(S=>({...S,trainingFrequency:E.target.value})),B(null)},children:[a.jsx("option",{value:"low",children:"1-2 sessions"}),a.jsx("option",{value:"moderate",children:"3-4 sessions"}),a.jsx("option",{value:"high",children:"5-6 sessions"}),a.jsx("option",{value:"daily",children:"7+ sessions"})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Fitness Goal"}),a.jsxs("div",{className:"nut-goal-options",children:[a.jsxs("button",{className:j.goal==="lose"?"active":"",onClick:()=>{O(E=>({...E,goal:"lose"})),B(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"-"}),a.jsx("span",{children:"Lose Weight"})]}),a.jsxs("button",{className:j.goal==="maintain"?"active":"",onClick:()=>{O(E=>({...E,goal:"maintain"})),B(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"="}),a.jsx("span",{children:"Maintain"})]}),a.jsxs("button",{className:j.goal==="build"?"active":"",onClick:()=>{O(E=>({...E,goal:"build"})),B(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"+"}),a.jsx("span",{children:"Build Muscle"})]})]})]}),j.goal==="lose"&&a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Deficit Level"}),a.jsxs("div",{className:"nut-deficit-options",children:[a.jsxs("button",{className:j.deficitLevel==="light"?"active":"",onClick:()=>{O(E=>({...E,deficitLevel:"light"})),B(null)},children:[a.jsx("strong",{children:"Mild"}),a.jsx("span",{children:"15% below TDEE"})]}),a.jsxs("button",{className:j.deficitLevel==="moderate"?"active":"",onClick:()=>{O(E=>({...E,deficitLevel:"moderate"})),B(null)},children:[a.jsx("strong",{children:"Moderate"}),a.jsx("span",{children:"20% below TDEE"})]}),a.jsxs("button",{className:j.deficitLevel==="harsh"?"active":"",onClick:()=>{O(E=>({...E,deficitLevel:"harsh"})),B(null)},children:[a.jsx("strong",{children:"Aggressive"}),a.jsx("span",{children:"25% below TDEE"})]})]})]}),a.jsx("button",{className:"nut-calc-btn",onClick:wt,disabled:!Ut(),children:"Calculate Macros"})]}),q&&a.jsxs("div",{className:"nut-calc-results",children:[a.jsx("h3",{children:"Your Daily Targets"}),a.jsxs("div",{className:"nut-calc-rings",children:[us("Protein","Protein",q.protein,q.protein,"ring-protein"),us("Carbs","Carbs",q.carbs,q.carbs,"ring-carbs"),us("Fats","Fats",q.fats,q.fats,"ring-fats"),us("Calories","Calories",q.calories,q.calories,"ring-cals")]}),a.jsxs("div",{className:"nut-calc-info",children:[a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"BMR (body at rest)"}),a.jsxs("span",{children:[q.bmr," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"+ Daily activity (NEAT)"}),a.jsxs("span",{children:[q.neat," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"+ Training sessions"}),a.jsxs("span",{children:["+",q.exerciseAdd," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",style:{fontWeight:600},children:[a.jsx("span",{children:"TDEE (total burn)"}),a.jsxs("span",{children:[q.tdee," cal"]})]})]}),a.jsx("button",{className:"nut-save-targets-btn",onClick:ft,children:"Set as My Daily Targets"})]})]}),as&&a.jsx("div",{className:`toast-notification ${as.type}`,children:as.message})]});const Cn=E=>{const S=new Date(E+"T12:00:00"),G=S.getDay(),ae=new Date(S);ae.setDate(S.getDate()-(G+6)%7);const Qe=[];for(let qe=0;qe<7;qe++){const Fe=new Date(ae);Fe.setDate(ae.getDate()+qe),Qe.push(Fe.toISOString().split("T")[0])}return Qe},hn=["M","T","W","T","F","S","S"],fn=(E,S="search")=>{M(E),S==="scan"?(fe("scan"),mt(null)):S==="manual"?(fe("manual"),Ee({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""})):S==="favourites"?fe("favourites"):(fe("search"),rt([]),gt(""))},Es=Cn(V),$=new Date(V+"T12:00:00"),ue=`${Le[$.getMonth()]} ${$.getFullYear()}`;return a.jsx(Ku,{children:a.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsxs("div",{className:"nut-dark-zone",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:()=>{y("setup"),B(null)},"aria-label":"Recalculate macros",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]})]})}),a.jsxs("div",{className:"nut-dark-content",children:[a.jsxs("div",{className:"nut-week-strip",children:[a.jsxs("div",{className:"nut-week-header",children:[a.jsx("button",{className:"nut-week-arrow",onClick:()=>{const E=new Date(V+"T12:00:00");E.setDate(E.getDate()-7);const S=E.toISOString().split("T")[0];ne(S)},"aria-label":"Previous week",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsx("button",{className:"nut-week-month-label",onClick:()=>{R(!Te),D({year:$.getFullYear(),month:$.getMonth()})},children:ue}),a.jsx("button",{className:"nut-week-arrow",onClick:()=>{const E=new Date(V+"T12:00:00");E.setDate(E.getDate()+7);const S=E.toISOString().split("T")[0];S<=Yi()&&ne(S)},"aria-label":"Next week",disabled:Es[6]>=Yi(),children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-week-days",children:Es.map((E,S)=>{const G=new Date(E+"T12:00:00").getDate(),ae=E===V,Qe=E>Yi(),qe=E===Yi();return a.jsxs("button",{className:`nut-week-day${ae?" selected":""}${qe?" today":""}${Qe?" future":""}`,disabled:Qe,onClick:()=>ne(E),children:[a.jsx("span",{className:"nut-week-day-letter",children:hn[S]}),a.jsx("span",{className:"nut-week-day-num",children:G})]},E)})})]}),Te&&a.jsxs("div",{className:"nut-calendar nut-calendar-dark",children:[a.jsxs("div",{className:"nut-cal-header",children:[a.jsx("button",{onClick:()=>D(E=>{let S=E.month-1,G=E.year;return S<0&&(S=11,G--),{year:G,month:S}}),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsxs("span",{children:[Le[L.month]," ",L.year]}),a.jsx("button",{onClick:()=>D(E=>{let S=E.month+1,G=E.year;return S>11&&(S=0,G++),{year:G,month:S}}),disabled:L.year===new Date().getFullYear()&&L.month>=new Date().getMonth(),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-cal-days-header",children:De.map(E=>a.jsx("span",{children:E},E))}),a.jsxs("div",{className:"nut-cal-grid",children:[[...Array(Ve(L.year,L.month))].map((E,S)=>a.jsx("span",{},`e${S}`)),[...Array(Ye(L.year,L.month))].map((E,S)=>{const G=S+1,ae=`${L.year}-${String(L.month+1).padStart(2,"0")}-${String(G).padStart(2,"0")}`,Qe=ae>Yi(),qe=ae===V,Fe=ae===Yi();return a.jsx("button",{className:`nut-cal-day${qe?" selected":""}${Fe?" today":""}${Qe?" future":""}`,disabled:Qe,onClick:()=>{ne(ae),R(!1)},children:G},G)})]})]}),a.jsxs("div",{className:"nut-rings-row",children:[us("Protein","Protein",ge.protein,w.protein,"ring-protein"),us("Carbs","Carbs",ge.carbs,w.carbs,"ring-carbs"),us("Fats","Fats",ge.fats,w.fats,"ring-fats"),us("Calories","kCal",ge.calories,w.calories,"ring-cals")]})]})]}),a.jsx("div",{className:"nut-light-zone",children:a.jsxs("div",{className:"nut-light-content",children:[ze&&a.jsxs("button",{className:"nut-water-quick",onClick:()=>A(!0),children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"18",height:"18",children:a.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),a.jsxs("span",{className:"nut-water-quick-count",children:[K.water," / ",w?.waterGoal||8]}),a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",width:"14",height:"14",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})]}),a.jsx("div",{className:"nut-log-section",children:a.jsx("div",{className:"nut-meals-list",children:b2.map(E=>{const S=K.entries.filter(ae=>(ae.meal||"snacks")===E.key),G=S.reduce((ae,Qe)=>({protein:ae.protein+(Qe.protein||0),carbs:ae.carbs+(Qe.carbs||0),fats:ae.fats+(Qe.fats||0),calories:ae.calories+(Qe.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});return a.jsxs("div",{className:"nut-meal-card",children:[a.jsxs("div",{className:"nut-meal-card-header",children:[a.jsx("span",{className:`nut-meal-card-icon nut-meal-icon-${E.key}`,children:mD[E.key]}),a.jsx("span",{className:"nut-meal-card-title",children:E.label}),S.length>0&&a.jsxs("span",{className:"nut-meal-card-cal",children:[G.calories," cal"]}),ze&&a.jsx("button",{className:"nut-meal-add-btn",onClick:()=>bt($e===E.key?null:E.key),"aria-label":`Add to ${E.label}`,children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]}),S.length>0&&a.jsxs("div",{className:"nut-meal-bars",children:[a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-p",children:"P"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-protein",style:{width:`${Math.min(100,w.protein>0?G.protein/w.protein*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[G.protein,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-c",children:"C"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-carbs",style:{width:`${Math.min(100,w.carbs>0?G.carbs/w.carbs*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[G.carbs,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-f",children:"F"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-fats",style:{width:`${Math.min(100,w.fats>0?G.fats/w.fats*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[G.fats,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-cal",children:"K"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-cals",style:{width:`${Math.min(100,w.calories>0?G.calories/w.calories*100:0)}%`}})}),a.jsx("span",{className:"nut-meal-bar-val",children:G.calories})]})]}),S.length>0&&a.jsx("div",{className:"nut-log-list",children:S.map(ae=>a.jsxs("div",{className:"nut-log-item",children:[a.jsxs("div",{className:"nut-log-item-info",children:[a.jsx("span",{className:"nut-log-item-name",children:ae.name}),ae.serving&&a.jsx("span",{className:"nut-log-item-serving",children:ae.serving})]}),a.jsxs("div",{className:"nut-log-item-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[ae.protein,"p"]}),a.jsxs("span",{className:"nut-macro-c",children:[ae.carbs,"c"]}),a.jsxs("span",{className:"nut-macro-f",children:[ae.fats,"f"]}),a.jsx("span",{className:"nut-macro-cal",children:ae.calories})]}),ze&&a.jsx("button",{className:"nut-log-delete",onClick:()=>St(ae.id),"aria-label":"Remove",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},ae.id))}),S.length===0&&a.jsx("div",{className:"nut-meal-empty",children:a.jsx("p",{children:ze?"Tap + to add food":"No entries"})})]},E.key)})})})]})}),$e&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"nut-add-picker-backdrop",onClick:()=>bt(null)}),a.jsxs("div",{className:"nut-add-picker",children:[a.jsx("div",{className:"nut-add-picker-handle"}),a.jsxs("h3",{className:"nut-add-picker-title",children:["Add to ",b2.find(E=>E.key===$e)?.label]}),a.jsxs("div",{className:"nut-add-picker-options",children:[a.jsxs("button",{onClick:()=>{const E=$e;bt(null),fn(E,"scan")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),a.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),a.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),a.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),a.jsx("span",{children:"Scan Barcode"})]}),a.jsxs("button",{onClick:()=>{const E=$e;bt(null),fn(E,"search")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("span",{children:"Search Food"})]}),a.jsxs("button",{onClick:()=>{const E=$e;bt(null),fn(E,"manual")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),a.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),a.jsx("span",{children:"Manual Entry"})]}),a.jsxs("button",{onClick:()=>{const E=$e;bt(null),fn(E,"favourites")},children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),a.jsx("span",{children:"Favourites"})]})]})]})]}),T&&a.jsx("div",{className:"nut-modal-overlay",onClick:()=>A(!1),children:a.jsxs("div",{className:"nut-water-popup",onClick:E=>E.stopPropagation(),children:[a.jsxs("div",{className:"nut-water-popup-header",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"20",height:"20",style:{color:"#2196f3"},children:a.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),a.jsx("span",{children:"Water Intake"}),a.jsx("button",{className:"nut-modal-close",onClick:()=>A(!1),children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),a.jsxs("div",{className:"nut-water-popup-body",children:[a.jsx("div",{className:"nut-water-glasses",children:[...Array(w?.waterGoal||8)].map((E,S)=>a.jsx("div",{className:`nut-water-glass ${S<K.water?"filled":""}`,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:S<K.water?"currentColor":"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})})},S))}),a.jsxs("div",{className:"nut-water-popup-count",children:[K.water," / ",w?.waterGoal||8," glasses"]}),a.jsxs("div",{className:"nut-water-btns",children:[a.jsx("button",{onClick:Rt,disabled:K.water<=0,children:"-"}),a.jsx("button",{onClick:it,children:"+"})]})]})]})}),H&&a.jsx("div",{className:"nut-modal-overlay",onClick:()=>{zt(),P(null),fe(null),mt(null)},children:a.jsxs("div",{className:"nut-modal",onClick:E=>E.stopPropagation(),children:[a.jsxs("div",{className:"nut-modal-header",children:[a.jsx("h3",{children:H==="scan"?"Scan Barcode":H==="search"?"Search Food":H==="favourites"?"Favourites":"Manual Entry"}),a.jsx("button",{className:"nut-modal-close",onClick:()=>{zt(),P(null),fe(null),mt(null)},children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),H==="scan"&&!Z&&a.jsxs("div",{className:"nut-scan-area",children:[a.jsxs("div",{className:"nut-scanner-wrapper",children:[a.jsx("div",{id:"barcode-reader",className:"nut-scanner-view"}),Me&&!ee&&a.jsx("div",{className:"nut-scan-line"}),ee&&a.jsxs("div",{className:"nut-scan-detected-overlay",children:[a.jsx("svg",{className:"nut-scan-detected-tick",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),a.jsx("p",{className:"nut-scan-detected-label",children:"Barcode found!"}),a.jsx("p",{className:"nut-scan-detected-code",children:ee})]})]}),!Me&&a.jsxs("button",{className:"nut-scan-start-btn",onClick:Xt,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),a.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),a.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),a.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),"Open Camera"]}),Me&&!ee&&a.jsx("p",{className:"nut-scan-hint",children:"Align barcode within the frame"}),a.jsx("div",{className:"nut-barcode-divider",children:a.jsx("span",{children:"or enter barcode manually"})}),a.jsxs("div",{className:"nut-barcode-manual",children:[a.jsx("input",{type:"text",inputMode:"numeric",value:se,onChange:E=>Se(E.target.value),onKeyDown:E=>E.key==="Enter"&&se.trim()&&we(se.trim()),placeholder:"Enter barcode number"}),a.jsx("button",{onClick:()=>se.trim()&&we(se.trim()),disabled:!se.trim()||Oe,children:Oe?"...":"Look Up"})]})]}),H==="scan"&&Z&&(()=>{const E=Z.servingUnit||"g",S=Z.portion,G=Ze==="portion"&&S?ut*S.weight:parseFloat(pt)||0,ae=G/100,Qe=E==="ml"?[100,200,250,500]:[50,100,150,200],qe=Ze==="portion"&&S?`${ut} ${S.label}${ut!==1?"s":""} (${Math.round(G)}${E})`:`${Math.round(G)}${E}`;return a.jsxs("div",{className:"nut-product-result",children:[Z.image&&a.jsx("img",{src:Z.image,alt:Z.name||"Product",className:"nut-product-img",loading:"lazy"}),a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:Z.name}),a.jsx("button",{className:`nut-fav-star confirm${ve(Z.name)?" active":""}`,onClick:()=>at({name:Z.name,protein:Z.protein,carbs:Z.carbs,fats:Z.fats,calories:Z.calories,serving:Z.servingSize,per100g:{protein:Z.protein,carbs:Z.carbs,fats:Z.fats,calories:Z.calories},servingUnit:Z.servingUnit||"g",portion:Z.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:ve(Z.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),Z.brand&&a.jsx("p",{className:"nut-product-brand",children:Z.brand}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",E,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[Z.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[Z.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[Z.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[Z.calories," cal"]})]}),S&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:Ze==="portion"?"active":"",onClick:()=>{Pt("portion"),ut<1&&tt(1)},children:"Portions"}),a.jsxs("button",{className:Ze==="weight"?"active":"",onClick:()=>{Pt("weight"),Je(String(Math.round(G)||100))},children:["Custom (",E,")"]})]}),Ze==="portion"&&S?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>tt(Math.max(1,ut-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:ut}),a.jsxs("span",{className:"nut-stepper-label",children:[S.label,ut!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(G),E]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>tt(ut+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",E,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:pt,onChange:Fe=>Je(Fe.target.value),onFocus:Fe=>Fe.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Qe.map(Fe=>a.jsxs("button",{className:`nut-quick-btn${pt===String(Fe)?" active":""}`,onClick:()=>Je(String(Fe)),children:[Fe,E]},Fe))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(Z.protein*ae),"p / ",Math.round(Z.carbs*ae),"c / ",Math.round(Z.fats*ae),"f / ",Math.round(Z.calories*ae)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>{mt(null),fe("scan")},children:"Scan Again"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>It({name:Z.name,protein:Math.round(Z.protein*ae),carbs:Math.round(Z.carbs*ae),fats:Math.round(Z.fats*ae),calories:Math.round(Z.calories*ae),serving:qe}),children:"Add"})]})]})})(),H==="search"&&!Z&&a.jsxs("div",{className:"nut-search-area",children:[a.jsxs("div",{className:"nut-search-bar",children:[a.jsx("input",{type:"text",ref:_s,value:Ue,onChange:E=>gt(E.target.value),onKeyDown:E=>{E.key==="Enter"&&(clearTimeout(ns.current),be())},onFocus:()=>setTimeout(()=>_s.current?.scrollIntoView({behavior:"smooth",block:"center"}),350),placeholder:"Search food or product...",autoFocus:!0}),a.jsx("button",{onClick:be,disabled:Wt,children:Wt?"...":"Search"})]}),a.jsxs("div",{className:"nut-search-results",children:[Tt.map((E,S)=>a.jsxs("button",{className:"nut-search-item",onClick:()=>{mt(E),E.portion?(tt(1),Je(String(E.portion.weight)),Pt("portion")):(tt(0),Je(String(E.servingValue||100)),Pt("weight"))},children:[E.image&&a.jsx("img",{src:E.image,alt:E.name||"Product",loading:"lazy"}),a.jsxs("div",{className:"nut-search-item-info",children:[a.jsx("span",{className:"nut-search-item-name",children:E.name}),E.brand&&a.jsx("span",{className:"nut-search-item-brand",children:E.brand}),a.jsxs("span",{className:"nut-search-item-macros",children:[E.calories," cal  ",E.protein,"p  ",E.carbs,"c  ",E.fats,"f per 100",E.servingUnit||"g"]})]})]},S)),Tt.length===0&&Ue&&!Wt&&a.jsx("p",{className:"nut-search-empty",children:"No results found. Try a different search or use manual entry."})]})]}),H==="search"&&Z&&(()=>{const E=Z.servingUnit||"g",S=Z.portion,G=Ze==="portion"&&S?ut*S.weight:parseFloat(pt)||0,ae=G/100,Qe=E==="ml"?[100,200,250,500]:[50,100,150,200],qe=Ze==="portion"&&S?`${ut} ${S.label}${ut!==1?"s":""} (${Math.round(G)}${E})`:`${Math.round(G)}${E}`;return a.jsxs("div",{className:"nut-product-result",children:[Z.image&&a.jsx("img",{src:Z.image,alt:Z.name||"Product",className:"nut-product-img",loading:"lazy"}),a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:Z.name}),a.jsx("button",{className:`nut-fav-star confirm${ve(Z.name)?" active":""}`,onClick:()=>at({name:Z.name,protein:Z.protein,carbs:Z.carbs,fats:Z.fats,calories:Z.calories,serving:Z.servingSize,per100g:{protein:Z.protein,carbs:Z.carbs,fats:Z.fats,calories:Z.calories},servingUnit:Z.servingUnit||"g",portion:Z.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:ve(Z.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),Z.brand&&a.jsx("p",{className:"nut-product-brand",children:Z.brand}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",E,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[Z.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[Z.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[Z.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[Z.calories," cal"]})]}),S&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:Ze==="portion"?"active":"",onClick:()=>{Pt("portion"),ut<1&&tt(1)},children:"Portions"}),a.jsxs("button",{className:Ze==="weight"?"active":"",onClick:()=>{Pt("weight"),Je(String(Math.round(G)||100))},children:["Custom (",E,")"]})]}),Ze==="portion"&&S?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>tt(Math.max(1,ut-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:ut}),a.jsxs("span",{className:"nut-stepper-label",children:[S.label,ut!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(G),E]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>tt(ut+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",E,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:pt,onChange:Fe=>Je(Fe.target.value),onFocus:Fe=>Fe.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Qe.map(Fe=>a.jsxs("button",{className:`nut-quick-btn${pt===String(Fe)?" active":""}`,onClick:()=>Je(String(Fe)),children:[Fe,E]},Fe))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(Z.protein*ae),"p / ",Math.round(Z.carbs*ae),"c / ",Math.round(Z.fats*ae),"f / ",Math.round(Z.calories*ae)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>mt(null),children:"Back to Search"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>It({name:Z.name,protein:Math.round(Z.protein*ae),carbs:Math.round(Z.carbs*ae),fats:Math.round(Z.fats*ae),calories:Math.round(Z.calories*ae),serving:qe}),children:"Add"})]})]})})(),H==="manual"&&a.jsxs("div",{className:"nut-manual-form",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Food Name"}),a.jsx("input",{type:"text",value:At.name,onChange:E=>Ee(S=>({...S,name:E.target.value})),placeholder:"e.g. Chicken Breast",autoFocus:!0})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Serving Size (optional)"}),a.jsx("input",{type:"text",value:At.serving,onChange:E=>Ee(S=>({...S,serving:E.target.value})),placeholder:"e.g. 150g, 1 cup"})]}),a.jsxs("div",{className:"nut-manual-macros",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Protein (g)"}),a.jsx("input",{type:"number",value:At.protein,onChange:E=>Ee(S=>({...S,protein:E.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Carbs (g)"}),a.jsx("input",{type:"number",value:At.carbs,onChange:E=>Ee(S=>({...S,carbs:E.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Fats (g)"}),a.jsx("input",{type:"number",value:At.fats,onChange:E=>Ee(S=>({...S,fats:E.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Calories"}),a.jsx("input",{type:"number",value:At.calories,onChange:E=>Ee(S=>({...S,calories:E.target.value})),min:"0"})]})]}),a.jsx("button",{className:"nut-btn-primary",disabled:!At.name.trim(),onClick:()=>It({name:At.name,protein:parseFloat(At.protein)||0,carbs:parseFloat(At.carbs)||0,fats:parseFloat(At.fats)||0,calories:parseFloat(At.calories)||0,serving:At.serving||""}),children:"Add Food"})]}),H==="favourites"&&!Z&&(()=>{const E=Q(),S=G=>{if(G.per100g){const ae=G.per100g;mt({name:G.name,brand:"",image:null,servingSize:G.serving||"100g",servingValue:100,servingUnit:G.servingUnit||"g",portion:G.portion||null,protein:ae.protein,carbs:ae.carbs,fats:ae.fats,calories:ae.calories,per100g:!0}),G.portion?(tt(1),Je(String(G.portion.weight)),Pt("portion")):(tt(0),Je("100"),Pt("weight"))}else It({name:G.name,protein:G.protein,carbs:G.carbs,fats:G.fats,calories:G.calories,serving:G.serving||""})};return a.jsx("div",{className:"nut-recent-area",children:E.length===0?a.jsx("p",{className:"nut-search-empty",children:"No favourites yet. Tap the star on any food to save it here."}):a.jsx("div",{className:"nut-recent-list",children:E.map((G,ae)=>a.jsxs("div",{className:"nut-recent-item-row",children:[a.jsx("button",{className:"nut-fav-star active",onClick:Qe=>{Qe.stopPropagation(),at(G)},children:a.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("button",{className:"nut-recent-item",onClick:()=>S(G),children:[a.jsxs("div",{className:"nut-recent-item-info",children:[a.jsx("span",{className:"nut-recent-item-name",children:G.name}),a.jsx("span",{className:"nut-recent-item-serving",children:G.serving||""})]}),a.jsxs("span",{className:"nut-recent-item-macros",children:[G.calories," cal"]})]})]},ae))})})})(),H==="favourites"&&Z&&(()=>{const E=Z.servingUnit||"g",S=Z.portion,G=Ze==="portion"&&S?ut*S.weight:parseFloat(pt)||0,ae=G/100,Qe=E==="ml"?[100,200,250,500]:[50,100,150,200],qe=Ze==="portion"&&S?`${ut} ${S.label}${ut!==1?"s":""} (${Math.round(G)}${E})`:`${Math.round(G)}${E}`;return a.jsxs("div",{className:"nut-product-result",children:[a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:Z.name}),a.jsx("button",{className:`nut-fav-star confirm${ve(Z.name)?" active":""}`,onClick:()=>at({name:Z.name,protein:Z.protein,carbs:Z.carbs,fats:Z.fats,calories:Z.calories,serving:Z.servingSize,per100g:{protein:Z.protein,carbs:Z.carbs,fats:Z.fats,calories:Z.calories},servingUnit:Z.servingUnit||"g",portion:Z.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:ve(Z.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",E,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[Z.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[Z.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[Z.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[Z.calories," cal"]})]}),S&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:Ze==="portion"?"active":"",onClick:()=>{Pt("portion"),ut<1&&tt(1)},children:"Portions"}),a.jsxs("button",{className:Ze==="weight"?"active":"",onClick:()=>{Pt("weight"),Je(String(Math.round(G)||100))},children:["Custom (",E,")"]})]}),Ze==="portion"&&S?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>tt(Math.max(1,ut-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:ut}),a.jsxs("span",{className:"nut-stepper-label",children:[S.label,ut!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(G),E]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>tt(ut+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",E,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:pt,onChange:Fe=>Je(Fe.target.value),onFocus:Fe=>Fe.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Qe.map(Fe=>a.jsxs("button",{className:`nut-quick-btn${pt===String(Fe)?" active":""}`,onClick:()=>Je(String(Fe)),children:[Fe,E]},Fe))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(Z.protein*ae),"p / ",Math.round(Z.carbs*ae),"c / ",Math.round(Z.fats*ae),"f / ",Math.round(Z.calories*ae)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>mt(null),children:"Back to Favourites"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>It({name:Z.name,protein:Math.round(Z.protein*ae),carbs:Math.round(Z.carbs*ae),fats:Math.round(Z.fats*ae),calories:Math.round(Z.calories*ae),serving:qe}),children:"Add"})]})]})})()]})}),a.jsx(la,{active:"nutrition"}),as&&a.jsx("div",{className:`toast-notification ${as.type}`,children:as.message})]})})}const v2="/login/assets/randomiser-glq9YJkL.jpg",yD="/login/assets/programme-card-workout-CnNzTYkz.webp",bD="/login/assets/prog-fullbody-4wk-r6m9HJys.jpg",vD="/login/assets/mg-arms-BeOQU3wx.jpg",xD=60,Hp=5,wD=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],_D={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Squeeze Press":"push","Incline Dumbbell Press":"push","Dumbbell Fly":"push","Dumbbell Pullover":"push","Tricep Kickback":"push","Dumbbell Shrug":"push","Dumbbell Y-Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Wide Dumbbell Bent Over Row":"pull","Reverse Fly":"pull","Concentration Curl":"pull","Wide Grip Bicep Curl":"pull","Wrist Curl":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core","Kettlebell Bird Dog Drag":"core"},kD={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},jD={fullbody:"linear-gradient(160deg, rgba(153,49,60,0.15) 0%, rgba(153,49,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",upper:"linear-gradient(160deg, rgba(100,60,140,0.2) 0%, rgba(100,60,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",lower:"linear-gradient(160deg, rgba(40,120,80,0.2) 0%, rgba(40,120,80,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)"},qp={arms:"linear-gradient(160deg, rgba(180,60,60,0.2) 0%, rgba(180,60,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",chest:"linear-gradient(160deg, rgba(50,100,160,0.2) 0%, rgba(50,100,160,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",back:"linear-gradient(160deg, rgba(80,130,60,0.2) 0%, rgba(80,130,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",shoulders:"linear-gradient(160deg, rgba(160,100,40,0.2) 0%, rgba(160,100,40,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",legs:"linear-gradient(160deg, rgba(100,50,140,0.2) 0%, rgba(100,50,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)"},$p=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,level:"All Levels",daysPerWeek:3,image:bD},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,level:"Intermediate",daysPerWeek:3},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,level:"Advanced",daysPerWeek:3},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,level:"Beginner",daysPerWeek:3},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,level:"Intermediate",daysPerWeek:3},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,level:"Advanced",daysPerWeek:3},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,level:"Intermediate",daysPerWeek:3},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,level:"Intermediate",daysPerWeek:3}],eu=[{key:"arms",label:"Arms",icon:"M7 5h2v14H7V5zm8 0h2v14h-2V5zm-5 4h4v6h-4V9z",image:vD},{key:"chest",label:"Chest",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15H9v-2h2v2zm4 0h-2v-2h2v2zm3-6c0 1.1-.36 2.12-.97 2.95l-.87-.87C16.7 12.53 17 11.8 17 11c0-2.76-2.24-5-5-5S7 8.24 7 11c0 .8.3 1.53.84 2.08l-.87.87A4.977 4.977 0 0 1 6 11c0-3.31 2.69-6 6-6s6 2.69 6 6z"},{key:"back",label:"Back",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm4 18H8v-6l-4-4 1.41-1.41L8 11.17V8h8v3.17l2.59-2.58L20 10l-4 4v6z"},{key:"shoulders",label:"Shoulders",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"legs",label:"Legs",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"}],x2={chest:[{id:"chest_strength",name:"Chest Strength",desc:"Heavy pressing for max strength",level:"Intermediate",overview:"A heavy pressing session designed to build raw chest strength. Focus on controlled negatives and powerful pressing movements.",tips:["Go heavy  pick a weight where the last 2 reps are a real challenge","Control the negative (lowering phase) for 2-3 seconds","Keep your shoulder blades squeezed together throughout all pressing movements","Rest 90-120 seconds between sets to allow full recovery"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Squeeze Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"chest_hypertrophy",name:"Chest Hypertrophy",desc:"Volume training for muscle growth",level:"Intermediate",overview:"A high-volume chest session focused on time under tension and muscle growth. Lighter weights, more reps, and slow controlled movements.",tips:["Use moderate weight  you should feel the burn by rep 10","Squeeze your chest at the top of every rep for 1 second","Keep rest periods short at 60-90 seconds to keep the pump going","On press ups, go to failure on the final set"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Press Up",type:"reps",sets:3,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"}]},{id:"chest_endurance",name:"Chest Endurance",desc:"Bodyweight pushing to failure",level:"All Levels",overview:"No weights needed. This bodyweight-only session builds chest endurance and muscular stamina through high-rep push up variations.",tips:["Focus on full range of motion  chest to floor on every rep","Keep your core tight and body in a straight line throughout","Scale down to knee press ups if you can't maintain form","Push through the burn  the last 5 reps are where the growth happens"],exercises:[{name:"Press Up",type:"reps",sets:4,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null},{name:"Decline Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Press Up Hold",type:"timed",sets:3,time:30,storagePath:null}]}],back:[{id:"back_strength",name:"Back Strength",desc:"Heavy rows for a thick back",level:"Intermediate",overview:"Build a thick, powerful back with heavy rowing movements. This session targets your lats, rhomboids, and traps for overall back development.",tips:["Go heavy on rows  use a weight that challenges you by rep 6-8","Drive your elbows back and squeeze your shoulder blades together at the top","Keep a slight bend in your knees and hinge at the hips for bent over movements","Rest 90-120 seconds between sets for full recovery"],exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"back_hypertrophy",name:"Back Hypertrophy",desc:"Width and thickness volume work",level:"Intermediate",overview:"A volume-focused back session combining rows and isolation moves to build width and thickness. Focus on the mind-muscle connection.",tips:["Use moderate weight  feel the stretch and squeeze on every rep","On renegade rows, keep your hips square to the floor and avoid rotating","For reverse flys, use lighter weight and focus on squeezing your rear delts","Keep rest to 60-90 seconds to maintain intensity"],exercises:[{name:"Renegade Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Reverse Fly",type:"weighted",sets:3,reps:15,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null}]},{id:"back_endurance",name:"Back Endurance",desc:"Bodyweight back conditioning",level:"All Levels",overview:"A bodyweight session to strengthen your posterior chain and improve posture. Great for back health, mobility, and muscular endurance.",tips:["On superman holds, lift your arms and legs simultaneously and hold tight","Focus on slow, controlled movements  quality over speed","Breathe steadily throughout timed holds  don't hold your breath","Engage your glutes and lower back together on every movement"],exercises:[{name:"Superman Hold",type:"timed",sets:4,time:30,storagePath:"exercises/bodyweight/upper/Superman Hold.mp4"},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:12,storagePath:null},{name:"Reverse Snow Angel",type:"reps",sets:3,reps:12,storagePath:null},{name:"Bird Dog",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Back Extension Hold",type:"timed",sets:3,time:30,storagePath:null}]}],shoulders:[{id:"shoulders_strength",name:"Shoulder Strength",desc:"Heavy pressing for boulder shoulders",level:"Intermediate",overview:"A heavy overhead pressing session to build strong, powerful shoulders. Compound movements first, followed by isolation work for all three delt heads.",tips:["Go heavy on presses  pick a weight where you struggle on the last 2 reps","Brace your core and avoid arching your back during overhead movements","Press straight up and control the weight down slowly","Rest 90-120 seconds between pressing sets, 60 seconds for isolation moves"],exercises:[{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"shoulders_hypertrophy",name:"Shoulder Hypertrophy",desc:"Volume and isolation for 3D delts",level:"Intermediate",overview:"A high-volume session targeting all three heads of the deltoid for that 3D capped shoulder look. Moderate weight, high reps, constant tension.",tips:["Use lighter weight than you think  shoulders respond best to high reps","On lateral raises, lead with your elbows and don't swing the weight","Pause at the top of each raise for a 1-second squeeze","Keep rest periods at 60 seconds to maximise the pump"],exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Y-Raise",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"shoulders_endurance",name:"Shoulder Endurance",desc:"Bodyweight and high-rep work",level:"All Levels",overview:"A shoulder endurance session combining bodyweight movements with high-rep dumbbell work. Builds stamina, stability, and shoulder resilience.",tips:["On pike push ups, walk your feet close to your hands to increase the angle","For high-rep lateral raises, use a very light weight and focus on form","Wall walks are advanced  scale to pike push ups if needed","Keep your core braced throughout to protect your lower back"],exercises:[{name:"Pike Push Ups",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/upper/pike push ups.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,reps:20,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Wall Walks",type:"reps",sets:3,reps:6,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null},{name:"Shoulder Tap Hold",type:"timed",sets:3,time:30,storagePath:null}]}],arms:[{id:"arms_bicep",name:"Bicep Focus",desc:"Curl variations for peak biceps",level:"All Levels",overview:"An arm session dedicated entirely to biceps. Multiple curl variations target different parts of the bicep for maximum peak and thickness.",tips:["Keep your elbows pinned to your sides  no swinging","Control the negative (lowering) for 2-3 seconds on every rep","Start with your heaviest weight and decrease as you fatigue","Squeeze hard at the top of each curl for a full contraction"],exercises:[{name:"Bicep Curl",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Concentration Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Isometric Bicep Hold",type:"timed",sets:3,time:20,storagePath:null}]},{id:"arms_tricep",name:"Tricep Focus",desc:"Extensions and dips for horseshoe triceps",level:"All Levels",overview:"All-out tricep training with extensions, dips, and pressing movements. The triceps make up two-thirds of your arm  this session builds serious size.",tips:["On overhead extensions, keep your elbows close to your head","For skullcrushers, lower the weight slowly to just above your forehead","On dips, lean slightly forward to reduce shoulder strain","Full lockout at the top of every extension for maximum tricep contraction"],exercises:[{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Tricep Dips",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null}]},{id:"arms_full",name:"Full Arms",desc:"Superset biceps and triceps",level:"All Levels",overview:"A balanced arm session alternating between biceps and triceps. Superset style keeps the intensity high and maximises the pump.",tips:["Superset each pair  do biceps then immediately hit triceps","Use moderate weight that lets you maintain strict form for all reps","Rest 60 seconds after each superset pair","Focus on the squeeze at the peak contraction of every rep"],exercises:[{name:"Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Wrist Curl",type:"weighted",sets:3,reps:15,storagePath:null}]}],legs:[{id:"legs_quad",name:"Quad Dominant",desc:"Squats and lunges for quad power",level:"All Levels",overview:"A quad-focused leg session built around squats and lunges. Heavy compound movements to build strong, powerful quads and overall leg strength.",tips:["On goblet squats, hold the dumbbell close to your chest and sit deep","Keep your knees tracking over your toes  don't let them cave inward","Drive through your heels on all squatting movements","Rest 90-120 seconds between heavy sets, 60 seconds on bodyweight moves"],exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/lower/bulgarian split squats.mp4"},{name:"Squat And Hold",type:"timed",sets:3,time:30,storagePath:"exercises/bodyweight/lower/squat and hold.mp4"}]},{id:"legs_ham_glute",name:"Hamstring & Glute",desc:"Posterior chain focus",level:"Intermediate",overview:"Target the back of your legs with deadlift and hip hinge variations. This session builds a strong posterior chain  hamstrings, glutes, and lower back.",tips:["On RDLs, push your hips back and feel the stretch in your hamstrings","Keep a slight bend in your knees throughout hip hinge movements","Squeeze your glutes hard at the top of every rep","For single leg work, start with your weaker side first"],exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/romanian deadlifts.mp4"},{name:"1 Legged RDL",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.mp4"},{name:"Hip Thrusts",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/hip thrusts.mp4"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.mp4"},{name:"Donkey Kicks",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.mp4"}]},{id:"legs_power",name:"Power & Plyo",desc:"Explosive leg training",level:"Intermediate",overview:"An explosive leg session combining plyometrics with weighted movements. Build power, speed, and athletic performance.",tips:["On jump squats, land softly with bent knees to absorb the impact","Explode up on every rep  power comes from speed, not just weight","Keep rest periods at 60-90 seconds to maintain intensity","Focus on landing mechanics  knees out, chest up, soft landing"],exercises:[{name:"Jump Squats",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/lower/jump squats.mp4"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Skater Jumps",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/skater jumps.mp4"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.mp4"}]}],core:[{id:"core_lower_abs",name:"Lower Abs Blast",desc:"40s work / 20s rest  3 rounds",level:"Intermediate",overview:"An interval-based core burner targeting the lower abdominals. 40 seconds of work followed by 20 seconds of rest  keep the intensity high and your lower back pressed into the floor throughout.",tips:["Press your lower back firmly into the floor on every rep","Exhale hard as you contract your abs  don't hold your breath","If your lower back lifts off the ground, reduce the range of motion","Focus on slow, controlled movements rather than speed"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Leg Raises",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Reverse Crunch To Leg Raise",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Flutter Kicks",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Dead Bug Single Leg Drop",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Hollow Hold Flutter Kicks",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"}]},{id:"core_obliques",name:"Obliques & Rotation",desc:"35s work / 25s rest  3 rounds",level:"Intermediate",overview:"Target the obliques and rotational core muscles with this interval session. 35 seconds of work with 25 seconds rest  every exercise involves twisting, rotating, or side-bracing movements.",tips:["Rotate from your ribcage, not just your arms","Keep your hips as still as possible during twisting exercises","Brace your core before each movement  think about squeezing a belt","On side planks, stack your hips and push the floor away"],interval:!0,rounds:3,work:35,rest:25,exercises:[{name:"Russian Twist",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank Rotation",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Cross Body Mountain Climbers",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Hip Dips Plank",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Bicycle Crunch",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank",storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{id:"core_weighted",name:"Weighted Core",desc:"40s work / 20s rest  3 rounds",level:"Advanced",overview:"Add resistance to your core training with dumbbells and kettlebells. 40 seconds of weighted work followed by 20 seconds rest  this session builds serious core strength and stability.",tips:["Start with a moderate weight  form is more important than load","Brace your entire core before picking up the weight each round","Keep movements controlled  no swinging or using momentum","If grip fails before core does, go slightly lighter next time"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Russian Twists Dumbbell",storagePath:"exercises/dumbbells/core/russian twists dumbbell.mp4"},{name:"Kettlebell Russian Twist",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Dumbbell Plank Pull Through",storagePath:null}]}]},w2=[{key:"bodyweight",label:"Bodyweight",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"},{key:"dumbbells",label:"Dumbbells",icon:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"},{key:"kettlebells",label:"Kettlebells",icon:"M12 2C9.24 2 7 4.24 7 7c0 1.1.36 2.12.97 2.95C6.76 11.08 6 12.96 6 15c0 3.87 2.69 7 6 7s6-3.13 6-7c0-2.04-.76-3.92-1.97-5.05.61-.83.97-1.85.97-2.95 0-2.76-2.24-5-5-5zm0 2c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"}],Wp=[{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"},{key:"upper",label:"Upper",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"lower",label:"Lower",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"fullbody",label:"Full Body",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z"},{key:"mix",label:"Mix It Up",icon:"M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm-.83 9.41l-1.42 1.42L17.96 20.54l1.42-1.42-5.71-5.71z"}],Ol=[{key:"beginner",label:"Beginner",work:30,rest:30,desc:"30s work / 30s rest"},{key:"intermediate",label:"Intermediate",work:40,rest:20,desc:"40s work / 20s rest"},{key:"advanced",label:"Advanced",work:40,rest:15,desc:"40s work / 15s rest"}],Gp=[5,10,15,20,30];function TD(n){return n.replace(/\b\w/g,e=>e.toUpperCase())}function ED(n){const e=[...n];for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return e}function ND(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Pr(),{isDark:l,toggleTheme:u,accent:d}=ja(),{isPremium:p,FREE_RANDOMISER_DURATIONS:g,FREE_RANDOMISER_WEEKLY_LIMIT:y}=xf(),w=Wn(),[k,j]=v.useState("menu"),[O,q]=v.useState(["bodyweight"]),[B,V]=v.useState("core"),[ne,K]=v.useState("intermediate"),[le,ge]=v.useState(p?15:5),[Ie,Te]=v.useState([]),[R,T]=v.useState(!1),A=v.useRef(!1),L=v.useRef([]),[D,F]=v.useState([]),[M,$e]=v.useState(2),[bt,H]=v.useState(Ol[1]),[fe,Me]=v.useState(1),[Ke,ee]=v.useState(0),[P,se]=v.useState("work"),[Se,Oe]=v.useState(0),[st,Ue]=v.useState(!1),[gt,Tt]=v.useState(0),[rt,Wt]=v.useState(null),js=v.useRef(null);v.useRef(null),v.useRef(null);const[At,Ee]=v.useState(null),Z=v.useCallback((Y,xe="info")=>{Ee({message:Y,type:xe}),setTimeout(()=>Ee(null),3e3)},[]),[mt,pt]=v.useState(null),[Je,ut]=v.useState(null),[tt,Ze]=v.useState(0),[Pt,Ks]=v.useState(0),[Ct,as]=v.useState([]),[on,qt]=v.useState(""),[Cs,ns]=v.useState(""),[_s,he]=v.useState(!1),[Re,ze]=v.useState(0),[Ye,Ve]=v.useState(!1),[Le,De]=v.useState({}),wt=v.useRef(null),ft=v.useRef(null),[Ut,Gt]=v.useState([]),[Q,ve]=v.useState(null),[at,It]=v.useState(0),[St,ts]=v.useState(0),[Xt,zt]=v.useState(0),[Rs,tn]=v.useState(0),[rs,Ts]=v.useState(0),[As,z]=v.useState(0),[ye,we]=v.useState({beginner:0,intermediate:0,advanced:0}),_e=p?Gp:Gp.filter(Y=>g.includes(Y)),be=!p&&at>=y,[it,Rt]=v.useState(null),[ct,_t]=v.useState(""),[kt,us]=v.useState(!1);v.useEffect(()=>{!i&&(!n||!e)&&w("/")},[n,e,i,w]),v.useEffect(()=>{if(!n||!t)return;(async()=>{try{const xe=Ht(pe,"workoutLogs"),te=Ns(xe,cs("clientId","==",t.id)),We=(await ws(te)).docs.map(os=>os.data()),ot=We.filter(os=>os.type!=="programme");tn(ot.length);const xt=ot.reduce((os,ln)=>os+(ln.duration||0),0);Ts(xt);const Kt={beginner:0,intermediate:0,advanced:0};ot.forEach(os=>{os.level&&Kt[os.level]!==void 0&&Kt[os.level]++}),we(Kt);const is=new Date,yn=is.getDay(),ms=yn===0?-6:1-yn,Fn=new Date(is);Fn.setDate(is.getDate()+ms),Fn.setHours(0,0,0,0);const Yr=Fn.getTime(),Vn=We.filter(os=>{const ln=os.completedAt;return ln?(ln.toDate?ln.toDate().getTime():new Date(ln).getTime())>=Yr:!1});It(Vn.filter(os=>os.type!=="programme").length);let hr=0;if(t)try{const os=await Ss(He(pe,"clientProgrammes",t.id));if(os.exists()){const ln=os.data(),fr=ln.templateId;hr=Vn.filter(Zs=>Zs.type==="programme"&&Zs.programmeId===fr).length,Rt(fr);const Gn=$p.find(Zs=>Zs.id===fr);Gn&&_t(Gn.name);const Kn=kD[fr];if(Kn){const Zs=Object.keys(ln.completedSessions||{}).length,sn=Kn.duration*Kn.daysPerWeek;zt(sn>0?Math.round(Zs/sn*100):0)}}else Rt(null),_t(""),zt(0)}catch{}ts(hr);const Ta=ot.map(os=>os.completedAt).filter(Boolean).map(os=>os.toDate?os.toDate().getTime():new Date(os).getTime()).sort((os,ln)=>ln-os);if(Ta.length===0)z(0);else{const os=new Set;Ta.forEach(sn=>{const mn=new Date(sn),Lr=mn.getDay(),mr=Lr===0?-6:1-Lr,Or=new Date(mn);Or.setDate(mn.getDate()+mr),Or.setHours(0,0,0,0),os.add(Or.getTime())});const ln=[...os].sort((sn,mn)=>mn-sn);let fr=0;const Gn=new Date(is),Kn=is.getDay()===0?-6:1-is.getDay();Gn.setDate(is.getDate()+Kn),Gn.setHours(0,0,0,0);let Zs=Gn.getTime();ln.includes(Zs)||(Zs-=10080*60*1e3);for(let sn=0;sn<200&&ln.includes(Zs);sn++)fr++,Zs-=10080*60*1e3;z(fr)}}catch(xe){console.error("Error loading workout stats:",xe)}finally{us(!0)}})()},[n,t,k]);const Cn=()=>{const Y=[];let xe;B==="mix"?xe=["core","upper","lower"]:B==="fullbody"?xe=["upper","lower"]:xe=[B];for(const te of O)for(const Be of xe)Y.push(`exercises/${te}/${Be}`);return Y},hn=async()=>{if(A.current){for(;A.current;)await new Promise(Y=>setTimeout(Y,200));return L.current}A.current=!0,T(!0);try{const Y=Cn(),xe=[];for(const ot of Y)try{const xt=so(no,ot),Kt=await y2(xt);xe.push(...Kt.items)}catch{console.warn(`Folder ${ot} not found, skipping.`)}if(xe.length===0&&O.includes("bodyweight")&&B==="core")try{const ot=so(no,"core"),xt=await y2(ot);xe.push(...xt.items)}catch{console.warn("Legacy core/ folder not found either.")}if(xe.length===0){const ot=O.map(Kt=>w2.find(is=>is.key===Kt)?.label).join(" + "),xt=Wp.find(Kt=>Kt.key===B)?.label;return Z(`No exercises found for ${ot} / ${xt}. Upload videos to Firebase Storage.`,"error"),A.current=!1,T(!1),[]}const te=new Set,Be=xe.filter(ot=>{const xt=ot.name.replace(/\.(mp4|gif)$/i,"");return te.has(xt)?!1:(te.add(xt),!0)}),We=await Promise.all(Be.map(async ot=>{const xt=await Ko(ot),Kt=TD(ot.name.replace(/\.(mp4|gif)$/i,"")),is=/\.gif$/i.test(ot.name);return{name:Kt,videoUrl:xt,isGif:is}}));return L.current=We,Te(We),A.current=!1,T(!1),We}catch(Y){console.error("Error loading exercises:",Y);const xe=Y.code==="storage/unauthorized"?"Storage access denied. Check Firebase Storage rules allow read access.":`Failed to load exercises: ${Y.message||Y.code||"Unknown error"}`;return Z(xe,"error"),A.current=!1,T(!1),[]}},fn=async()=>{if(be)return;j("spinning"),L.current=[];const Y=await hn();if(Y.length===0){j("setup");return}const xe=Ol.find(yn=>yn.key===ne);H(xe);const te=xe.work+xe.rest,Be=le*60,We=Math.floor(Be/te);let ot,xt;We<=6?(ot=Math.max(3,Math.floor(We/2)),xt=Math.floor(We/ot)):We<=12?(ot=Math.min(6,Math.floor(We/2)),xt=Math.floor(We/ot)):(ot=Math.min(10,Math.floor(We/2)),xt=Math.floor(We/ot)),xt=Math.max(2,xt);const Kt=ED(Y),is=Kt.slice(0,Math.min(ot,Kt.length));F(is),$e(xt),setTimeout(()=>j("preview"),2e3)},Es=()=>{j("countdown"),Tt(3)};v.useEffect(()=>{if(k!=="countdown")return;if(gt<=0){j("workout"),Me(1),ee(0),se("work"),Oe(bt.work),Ue(!1),jn();return}Ys();const Y=setTimeout(()=>Tt(xe=>xe-1),1e3);return()=>clearTimeout(Y)},[gt,k]),v.useEffect(()=>{if(k!=="workout"||st)return;if(Se<=0){$();return}Se<=3&&Ys();const Y=setTimeout(()=>Oe(xe=>xe-1),1e3);return()=>clearTimeout(Y)},[Se,k,st]);const $=()=>{if(P==="work")se("rest"),Oe(bt.rest);else{const Y=Ke+1;if(Y>=D.length){const xe=fe+1;if(xe>M){j("complete"),ue();return}Me(xe),ee(0)}else ee(Y);se("work"),Oe(bt.work),jn()}},ue=async()=>{if(n)try{await pi(Ht(pe,"workoutLogs"),{clientId:t.id,level:ne,duration:le,equipment:O,focus:B,exerciseCount:D.length,rounds:M,exercises:D.map(Y=>Y.name),completedAt:vt.now()}),It(Y=>Y+1),tn(Y=>Y+1),Ts(Y=>Y+le),we(Y=>({...Y,[ne]:(Y[ne]||0)+1}))}catch(Y){console.error("Error saving workout log:",Y)}},E=async(Y,xe,te)=>{if(!(!t||!xe))try{const Be=t.id,We=await Ss(He(pe,"coreBuddyPBs",Be)),xt=(We.exists()?We.data():null)?.exercises||{},Kt=xt[Y];let is=!1;if(Kt?(xe>(Kt.weight||0)||xe===(Kt.weight||0)&&te>(Kt.reps||0))&&(is=!0):is=!0,is){const yn={...xt,[Y]:{weight:xe,reps:te,achievedAt:vt.now()}};await Ds(He(pe,"coreBuddyPBs",Be),{clientId:t.id,exercises:yn,updatedAt:vt.now()}),Z(`New PB! ${xe}kg  ${te} reps`,"success"),Ys(),await S(Y,xe)}}catch(Be){console.error("Error checking PB:",Be)}},S=async(Y,xe)=>{if(t)try{const te=await Ss(He(pe,"coreBuddyTargets",t.id));if(!te.exists())return;const We=(te.data().targets||{})[Y];if(!We||xe<We.targetWeight)return;const ot=await Ss(He(pe,"coreBuddyAchievements",t.id)),xt=ot.exists()?ot.data():{clientId:t.id,badges:[],totalVolume:0};if(xt.badges.some(ms=>ms.type==="pb_target"&&ms.exercise===Y&&ms.targetWeight===We.targetWeight))return;const is={type:"pb_target",exercise:Y,group:_D[Y]||"push",targetWeight:We.targetWeight,achievedAt:vt.now()},yn=[...xt.badges,is];await Ds(He(pe,"coreBuddyAchievements",t.id),{...xt,badges:yn,updatedAt:vt.now()}),Gt(ms=>[...ms,is])}catch(te){console.error("Error checking target badge:",te)}},G=async Y=>{if(!(!t||Y<=0))try{const xe=await Ss(He(pe,"coreBuddyAchievements",t.id)),te=xe.exists()?xe.data():{clientId:t.id,badges:[],totalVolume:0},Be=te.totalVolume||0,We=Be+Y,ot=[];wD.forEach(Kt=>{We>=Kt.threshold&&Be<Kt.threshold&&(te.badges.some(yn=>yn.type==="volume_milestone"&&yn.milestone===Kt.threshold)||ot.push({type:"volume_milestone",milestone:Kt.threshold,label:Kt.label,achievedAt:vt.now()}))});const xt=[...te.badges,...ot];await Ds(He(pe,"coreBuddyAchievements",t.id),{clientId:t.id,badges:xt,totalVolume:Math.round(We),updatedAt:vt.now()}),ot.length>0&&Gt(Kt=>[...Kt,...ot])}catch(xe){console.error("Error updating volume:",xe)}},ae=async Y=>{if(ut(Y),Y.interval){const Be=[];for(const We of Y.exercises){let ot=null,xt=!1;if(We.storagePath)try{const Kt=so(no,We.storagePath);ot=await Ko(Kt),xt=/\.gif$/i.test(We.storagePath)}catch{}Be.push({name:We.name,videoUrl:ot,isGif:xt})}F(Be),$e(Y.rounds),H({work:Y.work,rest:Y.rest}),j("preview");return}const xe={};for(const Be of Y.exercises)if(Be.storagePath)try{const We=so(no,Be.storagePath);xe[Be.name]={url:await Ko(We),isGif:/\.gif$/i.test(Be.storagePath)}}catch{}De(xe);const te=Y.exercises.map(Be=>({name:Be.name,type:Be.type,targetSets:Be.sets,targetReps:Be.reps||0,targetTime:Be.time||0,sets:[]}));as(te),Ze(0),Ks(0),qt(""),ns(""),Ve(!1),he(!1),ze(0),Gt([]),ve(null),j("muscle_workout")},Qe=()=>{const Y=wt.current;Y&&(Y.paused?(Y.play(),Ve(!0)):(Y.pause(),Ve(!1)))};v.useEffect(()=>{if(k!=="muscle_workout"||!_s||Re<=0){k==="muscle_workout"&&_s&&Re<=0&&(he(!1),Ys());return}return ft.current=setTimeout(()=>ze(Y=>Y-1),1e3),()=>clearTimeout(ft.current)},[k,_s,Re]);const qe=async()=>{const Y=Ct[tt];let xe={};if(Y.type==="weighted"){const We=parseFloat(on)||0,ot=parseInt(Cs)||0;if(ot===0){Z("Enter your reps","error");return}xe={weight:We,reps:ot}}else if(Y.type==="reps"){const We=parseInt(Cs)||0;if(We===0){Z("Enter your reps","error");return}xe={reps:We}}else if(Y.type==="timed"){const We=Y.targetTime-Re;xe={time:Math.max(We,1)}}const te=[...Ct];te[tt]={...Y,sets:[...Y.sets,xe]},as(te),Y.type==="weighted"&&xe.weight>0&&await E(Y.name,xe.weight,xe.reps);const Be=Y.sets.length+1;if(Be<Y.targetSets)Ks(Be),ns(""),he(!1),ze(0);else if(tt+1<Ct.length){const We=tt+1;Ze(We),Ks(0),qt(""),ns(""),Ve(!1),he(!1),ze(0)}else await Fe(te),j("muscle_complete")},Fe=async Y=>{if(!(!n||!t))try{const xe=Y.reduce((Be,We)=>Be+We.sets.reduce((ot,xt)=>ot+(xt.weight||0)*(xt.reps||0),0),0),te=Y.reduce((Be,We)=>Be+We.sets.length,0);await pi(Ht(pe,"workoutLogs"),{clientId:t.id,type:"muscle_group",muscleGroup:mt,sessionId:Je?.id,sessionName:Je?.name,exerciseCount:Y.length,totalSets:te,duration:Math.round(te*1.5),volume:Math.round(xe),exercises:Y.map(Be=>({name:Be.name,type:Be.type,sets:Be.sets})),completedAt:vt.now()}),xe>0&&await G(xe),Ut.length>0&&ve({badges:[...Ut]})}catch(xe){console.error("Error saving muscle group workout log:",xe)}},Lt=v.useRef(null),Mt=()=>(Lt.current||(Lt.current=new(window.AudioContext||window.webkitAudioContext)),Lt.current),Ys=()=>{try{const Y=Mt(),xe=Y.createOscillator(),te=Y.createGain();xe.connect(te),te.connect(Y.destination),xe.frequency.value=880,te.gain.value=.3,xe.start(Y.currentTime),xe.stop(Y.currentTime+.15)}catch{}},jn=()=>{try{const Y=Mt(),xe=Y.createOscillator(),te=Y.createGain();xe.connect(te),te.connect(Y.destination),xe.frequency.value=1200,te.gain.value=.4,xe.start(Y.currentTime),xe.stop(Y.currentTime+.3)}catch{}};v.useEffect(()=>{if(k!=="workout"||P!=="work"||!D[Ke]?.isGif)return;const xe=setInterval(()=>{const te=js.current;if(!te)return;const Be=te.getAttribute("src");te.removeAttribute("src"),setTimeout(()=>{js.current&&js.current.setAttribute("src",Be)},0)},4e3);return()=>clearInterval(xe)},[k,P,Ke,fe,D]);const gn=(Y,xe,te)=>{const Be=Math.round(Y/xe*xD);return a.jsx("svg",{className:"wk-ring-svg",viewBox:"0 0 200 200",children:$M.map((We,ot)=>a.jsx("line",{x1:We.x1,y1:We.y1,x2:We.x2,y2:We.y2,className:ot<Be?`wk-tick-filled ${te}`:"wk-tick-empty",strokeWidth:We.thick?"3":"2"},ot))})},Js=()=>{const Y=D.length*M;return((fe-1)*D.length+Ke+(P==="rest"?.5:0))/Y},Hs=At&&a.jsx("div",{className:`toast-notification ${At.type}`,children:At.message});if(i)return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>w("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsx("div",{className:"wk-loading-inline",children:a.jsx("div",{className:"wk-loading-spinner"})})]});if(k==="menu")return a.jsx(Ku,{children:a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>w("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"wk-menu-heading",children:[a.jsx("h2",{children:"Choose Your Workout"}),a.jsx("p",{children:"No excuses. Just results."})]}),a.jsx("button",{className:"wk-hero-card",onClick:()=>j("setup"),children:a.jsx("img",{src:v2,alt:"Randomise Workout",className:"wk-hero-bg"})}),a.jsxs("div",{className:"wk-section-header",children:[a.jsxs("h2",{children:["Programmes ",!p&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),a.jsxs("span",{className:"wk-section-count",children:[$p.length," available"]})]}),p?a.jsx("div",{className:"wk-prog-scroll-wrap",children:a.jsx("div",{className:"wk-prog-scroll",children:$p.map((Y,xe)=>Y.image?a.jsxs("button",{className:"wk-prog-img-card",onClick:()=>w("/client/core-buddy/programmes",{state:{templateId:Y.id}}),style:{animationDelay:`${xe*.06}s`},children:[a.jsx("img",{src:Y.image,alt:Y.name,className:"wk-prog-img"}),xe===0&&a.jsx("div",{className:"wk-swipe-arrow",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},Y.id):a.jsxs("button",{className:"wk-prog-hero-card",onClick:()=>w("/client/core-buddy/programmes",{state:{templateId:Y.id}}),style:{animationDelay:`${xe*.06}s`},children:[a.jsx("img",{src:yD,alt:"Programme",className:"wk-prog-hero-bg",loading:"lazy"}),a.jsx("div",{className:"wk-prog-hero-overlay",style:{background:jD[Y.focus]}}),a.jsxs("div",{className:"wk-prog-hero-content",children:[a.jsxs("div",{className:"wk-prog-hero-top",children:[a.jsxs("span",{className:"wk-prog-hero-badge",children:[Y.duration," WEEKS"]}),a.jsx("span",{className:"wk-prog-hero-level",children:Y.level})]}),a.jsxs("div",{className:"wk-prog-hero-bottom",children:[a.jsx("h3",{children:Y.name.toUpperCase()}),a.jsxs("p",{children:[Y.daysPerWeek,"x per week  ",Y.focus==="fullbody"?"Full Body":Y.focus.charAt(0).toUpperCase()+Y.focus.slice(1)," Focus"]}),a.jsx("span",{className:"wk-prog-hero-go",children:"VIEW PROGRAMME "})]})]}),xe===0&&a.jsx("div",{className:"wk-swipe-arrow",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},Y.id))})}):a.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>w("/upgrade"),children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{children:"Upgrade to unlock programmes"})]}),a.jsxs("div",{className:"wk-section-header",children:[a.jsxs("h2",{children:["Muscle Groups ",!p&&a.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),a.jsxs("span",{className:"wk-section-count",children:[eu.length," groups"]})]}),p?a.jsx("div",{className:"wk-muscle-grid",children:eu.map((Y,xe)=>a.jsx("button",{className:`wk-muscle-hero-card${Y.image?" wk-muscle-thumb":""}`,onClick:()=>{pt(Y.key),j("muscle_sessions")},style:{animationDelay:`${xe*.05}s`},children:Y.image?a.jsx("img",{src:Y.image,alt:Y.label,className:"wk-muscle-thumb-img"}):a.jsxs(a.Fragment,{children:[a.jsx("img",{src:v2,alt:"Muscle group",className:"wk-muscle-hero-bg",loading:"lazy"}),a.jsx("div",{className:"wk-muscle-hero-overlay",style:{background:qp[Y.key]}}),a.jsxs("div",{className:"wk-muscle-hero-content",children:[a.jsx("div",{className:"wk-muscle-hero-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:Y.icon})})}),a.jsxs("div",{className:"wk-muscle-hero-text",children:[a.jsx("span",{className:"wk-muscle-hero-name",children:Y.label}),a.jsxs("span",{className:"wk-muscle-hero-count",children:[x2[Y.key]?.length||0," sessions"]})]})]})]})},Y.key))}):a.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>w("/upgrade"),children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{children:"Upgrade to unlock muscle group workouts"})]})]}),a.jsx(la,{active:"workouts"}),Hs]})});if(k==="setup"){const Y=Wp.find(te=>te.key===B)?.label||B,xe=Ol.find(te=>te.key===ne)?.label||ne;return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>j("menu"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main wk-setup-main",children:[a.jsx("div",{className:"wk-stats-row",children:[{label:"Total",value:`${Rs}`,pct:Rs>0?Math.min(Math.round(Rs/100*100),100):0,color:"#14b8a6",size:"normal"},{label:"This Week",value:`${at}/${Hp}`,pct:Math.round(Math.min(at,Hp)/Hp*100),color:"var(--color-primary)",size:"large"},{label:"Wk Streak",value:`${As}`,pct:As>0?Math.min(Math.round(As/12*100),100):0,color:"#38B6FF",size:"normal"}].map(te=>{const We=2*Math.PI*38,ot=We-te.pct/100*We;return a.jsxs("div",{className:`wk-stat-item${te.size==="large"?" wk-stat-large":""}`,children:[a.jsxs("div",{className:"wk-stat-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"wk-stat-track",cx:"50",cy:"50",r:38}),a.jsx("circle",{className:"wk-stat-fill",cx:"50",cy:"50",r:38,style:{stroke:te.color},strokeDasharray:We,strokeDashoffset:ot})]}),a.jsx("span",{className:"wk-stat-value",style:{color:te.color},children:te.value})]}),a.jsx("span",{className:"wk-stat-label",children:te.label})]},te.label)})}),a.jsxs("div",{className:"wk-setup-flow",children:[a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Focus Area"}),a.jsx("div",{className:"wk-focus-grid",children:Wp.map(te=>a.jsxs("button",{className:`wk-equip-btn${B===te.key?" active":""}${te.key==="mix"?" wk-mix-btn":""}`,onClick:()=>V(te.key),children:[a.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:te.icon})}),a.jsx("span",{children:te.label})]},te.key))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Level"}),a.jsx("div",{className:"wk-level-cards",children:Ol.map(te=>a.jsxs("button",{className:`wk-level-card wk-level-${te.key}${ne===te.key?" active":""}`,onClick:()=>K(te.key),children:[a.jsx("span",{className:"wk-level-name",children:te.label}),a.jsx("span",{className:"wk-level-desc",children:te.desc})]},te.key))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Time"}),a.jsx("div",{className:"wk-time-options",children:Gp.map(te=>{const Be=!_e.includes(te);return a.jsxs("button",{className:`wk-time-btn${le===te?" active":""}${Be?" locked":""}`,onClick:()=>!Be&&ge(te),disabled:Be,children:[a.jsx("span",{className:"wk-time-num",children:te}),a.jsx("span",{className:"wk-time-unit",children:Be?a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}):"min"})]},te)})})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Equipment"}),a.jsx("div",{className:"wk-equip-options",children:w2.map(te=>{const Be=O.includes(te.key);return a.jsxs("button",{className:`wk-equip-btn${Be?" active":""}`,onClick:()=>{q(We=>Be&&We.length===1?We:Be?We.filter(ot=>ot!==te.key):[...We,te.key])},children:[a.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:te.icon})}),a.jsx("span",{children:te.label})]},te.key)})})]}),a.jsx("div",{className:"wk-setup-summary",children:a.jsxs("span",{children:[Y,"  ",xe,"  ",le," min"]})})]})]}),a.jsxs("div",{className:"wk-go-sticky",children:[be&&a.jsx("p",{className:"wk-free-limit-msg",children:"You've used your free workout this week. Upgrade for unlimited access."}),a.jsx("button",{className:"wk-randomise-btn",onClick:fn,disabled:R||be,children:R?"Loading exercises...":be?"Limit Reached":"Randomise Workout"})]}),Hs]})}if(k==="spinning")return a.jsxs("div",{className:"wk-page wk-page-center","data-theme":l?"dark":"light","data-accent":d,children:[a.jsxs("div",{className:"wk-spin-container",children:[a.jsxs("div",{className:"wk-spin-ring",children:[a.jsx("svg",{className:"wk-spin-svg",viewBox:"0 0 200 200",children:mu.map((Y,xe)=>a.jsx("line",{x1:Y.x1,y1:Y.y1,x2:Y.x2,y2:Y.y2,className:"wk-spin-tick",strokeWidth:Y.thick?"3.5":"2",style:{animationDelay:`${xe*.03}s`}},xe))}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-spin-logo",width:"50",height:"50"})]}),a.jsx("p",{className:"wk-spin-text",children:"Generating workout..."})]}),Hs]});if(k==="preview"){const Y=Je?.interval?{work:Je.work,rest:Je.rest}:Ol.find(te=>te.key===ne),xe=D.length*M*(Y.work+Y.rest);return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>j(Je?.interval?"muscle_sessions":"setup"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[Je?.interval&&a.jsx("h2",{className:"mg-preview-title",children:Je.name}),a.jsxs("div",{className:"wk-preview-stats",children:[a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:D.length}),a.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:M}),a.jsx("span",{className:"wk-stat-label",children:"Rounds"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Math.ceil(xe/60)}),a.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsxs("span",{className:"wk-stat-val",children:[Y.work,"/",Y.rest]}),a.jsx("span",{className:"wk-stat-label",children:"Work/Rest"})]})]}),a.jsx("div",{className:"wk-preview-list",children:D.map((te,Be)=>a.jsxs("div",{className:"wk-preview-item",style:{animationDelay:`${Be*.06}s`},onClick:()=>Wt(te),children:[a.jsx("span",{className:"wk-preview-num",children:Be+1}),a.jsx("div",{className:"wk-preview-thumb",children:te.isGif?a.jsx("img",{src:te.videoUrl,alt:te.name,loading:"lazy"}):a.jsx("video",{src:`${te.videoUrl}#t=0.1`,muted:!0,playsInline:!0,preload:"auto"})}),a.jsx("span",{className:"wk-preview-name",children:te.name}),a.jsx("svg",{className:"wk-preview-play",width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]},Be))}),rt&&a.jsx("div",{className:"wk-preview-modal-backdrop",onClick:()=>Wt(null),children:a.jsxs("div",{className:"wk-preview-modal",onClick:te=>te.stopPropagation(),children:[a.jsx("button",{className:"wk-preview-modal-close",onClick:()=>Wt(null),"aria-label":"Close preview",children:a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),a.jsx("div",{className:"wk-preview-modal-video",children:rt.isGif?a.jsx("img",{src:rt.videoUrl,alt:rt.name}):a.jsx("video",{src:rt.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0})}),a.jsx("h3",{className:"wk-preview-modal-title",children:rt.name})]})}),a.jsxs("div",{className:"wk-preview-actions",children:[!Je?.interval&&a.jsxs("button",{className:"wk-btn-secondary",onClick:()=>fn(),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"1 4 1 10 7 10"}),a.jsx("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})]}),"Reshuffle"]}),a.jsx("button",{className:"wk-btn-primary",onClick:Es,children:"Start Workout"})]})]})]})}if(k==="countdown")return a.jsx("div",{className:"wk-page wk-page-center wk-page-dark","data-theme":l?"dark":"light","data-accent":d,children:a.jsxs("div",{className:"wk-countdown-big",children:[a.jsx("span",{className:"wk-countdown-num",children:gt}),a.jsx("span",{className:"wk-countdown-label",children:"GET READY"})]})});if(k==="workout"){const Y=D[Ke],xe=P==="work"?bt.work:bt.rest,te=P==="rest"?Ke+1<D.length?D[Ke+1]:fe<M?D[0]:null:null;return a.jsxs("div",{className:"wk-page wk-page-workout","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("div",{className:"wk-video-container",children:P==="work"?Y.isGif?a.jsx("img",{ref:js,className:"wk-video",src:Y.videoUrl,alt:Y.name},Y.videoUrl):a.jsx("video",{className:"wk-video",src:Y.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0},Y.videoUrl):a.jsxs("div",{className:"wk-rest-screen",children:[a.jsx("span",{className:"wk-rest-label",children:"REST"}),te&&a.jsxs("span",{className:"wk-next-label",children:["Next: ",te.name]})]})}),a.jsx("div",{className:"wk-back-row",children:a.jsxs("button",{className:"wk-back-btn",onClick:()=>{confirm("Leave workout?")&&j("menu")},children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]})}),a.jsx("div",{className:"wk-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"wk-exercise-info",children:[a.jsxs("span",{className:"wk-exercise-counter",children:[Ke+1," / ",D.length]}),a.jsx("h2",{className:"wk-exercise-name",children:Y.name}),a.jsxs("span",{className:"wk-round-label",children:["Round ",fe," of ",M]})]}),a.jsx("div",{className:"wk-timer-section",children:a.jsxs("div",{className:"wk-timer-ring-wrap",children:[gn(Se,xe,P==="work"?"wk-tick-work":"wk-tick-rest"),a.jsxs("div",{className:"wk-timer-center",children:[a.jsx("span",{className:"wk-timer-time",children:Se}),a.jsx("span",{className:`wk-timer-phase ${P}`,children:P==="work"?"WORK":"REST"})]})]})}),a.jsxs("div",{className:"wk-controls",children:[a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-stop",onClick:()=>{confirm("End workout early?")&&j("menu")},children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})})}),a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-pause",onClick:()=>Ue(!st),children:st?a.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}):a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),a.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]})}),a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-skip",onClick:()=>{Oe(0)},children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("polygon",{points:"5 4 15 12 5 20 5 4"}),a.jsx("rect",{x:"15",y:"4",width:"4",height:"16"})]})})]}),a.jsx("div",{className:"wk-progress-bar",children:a.jsx("div",{className:"wk-progress-fill",style:{width:`${Js()*100}%`}})})]})}if(k==="complete"){const Y=Ol.find(te=>te.key===ne),xe=D.length*M*(Y.work+Y.rest);return a.jsx("div",{className:"wk-page wk-page-center","data-theme":l?"dark":"light","data-accent":d,children:a.jsxs("div",{className:"wk-complete",children:[a.jsxs("div",{className:"wk-complete-ring",children:[a.jsx("svg",{className:"wk-complete-svg",viewBox:"0 0 200 200",children:mu.map((te,Be)=>a.jsx("line",{x1:te.x1,y1:te.y1,x2:te.x2,y2:te.y2,className:"wk-tick-complete",strokeWidth:te.thick?"3.5":"2",style:{animationDelay:`${Be*.02}s`}},Be))}),a.jsx("div",{className:"wk-complete-center",children:a.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})})})]}),a.jsx("h2",{className:"wk-complete-title",children:"Workout Complete!"}),a.jsxs("div",{className:"wk-complete-stats",children:[a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Math.ceil(xe/60)}),a.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:D.length*M}),a.jsx("span",{className:"wk-stat-label",children:"Intervals"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:M}),a.jsx("span",{className:"wk-stat-label",children:"Rounds"})]})]}),a.jsx("div",{className:"wk-complete-actions",children:a.jsx("button",{className:"wk-btn-primary",onClick:()=>{ut(null),pt(null),j("menu")},children:"Done"})})]})})}if(k==="muscle_sessions"){const Y=eu.find(te=>te.key===mt),xe=x2[mt]||[];return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>j("menu"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"mg-sessions-header",children:[a.jsx("div",{className:"mg-sessions-icon",style:{background:qp[mt]},children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:Y?.icon})})}),a.jsxs("h2",{children:[Y?.label," Workouts"]}),a.jsxs("p",{children:[xe.length," sessions available"]})]}),a.jsx("div",{className:"mg-sessions-list",children:xe.map((te,Be)=>a.jsxs("button",{className:"mg-session-card",onClick:()=>{ut(te),j("muscle_overview")},style:{animationDelay:`${Be*.08}s`},children:[a.jsxs("div",{className:"mg-session-info",children:[a.jsx("h3",{children:te.name}),a.jsx("p",{children:te.desc}),a.jsx("div",{className:"mg-session-meta",children:te.interval?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mg-session-tag mg-tag-interval",children:"Interval"}),a.jsxs("span",{className:"mg-session-tag",children:[te.exercises.length," exercises"]}),a.jsxs("span",{className:"mg-session-tag",children:[te.rounds," rounds"]})]}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mg-session-tag mg-tag-strength",children:"Strength"}),a.jsxs("span",{className:"mg-session-tag",children:[te.exercises.length," exercises"]}),a.jsx("span",{className:"mg-session-tag",children:(()=>{const We=te.exercises.map(Kt=>Kt.sets||0),ot=Math.min(...We),xt=Math.max(...We);return ot===xt?`${ot} sets each`:`${ot}-${xt} sets each`})()})]})})]}),a.jsx("div",{className:"mg-session-arrow",children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},te.id))})]}),Hs]})}if(k==="muscle_overview"){const Y=Je;if(!Y)return null;const xe=eu.find(te=>te.key===mt);return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>j("muscle_sessions"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main mg-overview-main",children:[a.jsx("div",{className:"mg-overview-hero",style:{background:qp[mt]},children:a.jsx("div",{className:"mg-overview-hero-content",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"mg-overview-hero-icon",children:a.jsx("path",{d:xe?.icon})})})}),a.jsxs("div",{className:"mg-overview-header",children:[a.jsxs("div",{className:"mg-overview-title-row",children:[a.jsx("h2",{children:Y.name}),Y.level&&a.jsx("span",{className:"mg-overview-level",children:Y.level})]}),a.jsx("p",{className:"mg-overview-desc",children:Y.desc})]}),Y.overview&&a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 16v-4M12 8h.01"})]}),"About This Workout"]}),a.jsx("p",{children:Y.overview})]}),Y.tips&&Y.tips.length>0&&a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Tips & Form"]}),a.jsx("ul",{className:"mg-overview-tips",children:Y.tips.map((te,Be)=>a.jsx("li",{children:te},Be))})]}),a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"}),a.jsx("rect",{x:"9",y:"3",width:"6",height:"4",rx:"1"}),a.jsx("path",{d:"M9 14l2 2 4-4"})]}),"Exercises (",Y.exercises.length,")"]}),a.jsx("div",{className:"mg-overview-exercises",children:Y.exercises.map((te,Be)=>a.jsxs("div",{className:"mg-overview-exercise",children:[a.jsx("span",{className:"mg-overview-ex-num",children:Be+1}),a.jsxs("div",{className:"mg-overview-ex-info",children:[a.jsx("span",{className:"mg-overview-ex-name",children:te.name}),Y.interval?a.jsxs("span",{className:"mg-overview-ex-detail",children:[Y.work,"s work / ",Y.rest,"s rest"]}):a.jsxs("span",{className:"mg-overview-ex-detail",children:[te.sets," sets  ",te.reps?`${te.reps} reps`:`${te.time}s`,te.type==="weighted"&&"  weighted"]})]})]},Be))})]}),a.jsxs("button",{className:"mg-overview-start-btn",onClick:()=>ae(Y),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Workout"]})]}),Hs]})}if(k==="muscle_workout"){const Y=Je;if(!Y)return null;const xe=Y.exercises[tt],te=Ct[tt];if(!xe||!te)return null;const Be=te.sets.length,We=Y.exercises.length,ot=Y.exercises.reduce((ms,Fn)=>ms+(Fn.sets||0),0),Kt=Ct.reduce((ms,Fn)=>ms+Fn.sets.length,0)/ot*100,is=Le[xe.name];xe.type==="timed"&&Re===0&&!_s&&Be===Pt&&setTimeout(()=>ze(xe.time),0);const yn=Be+1<xe.sets?"Log Set":tt+1<We?"Log Set  Next Exercise":"Log Set  Complete";return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("div",{className:"mg-session-progress",children:a.jsx("div",{className:"mg-session-progress-fill",style:{width:`${Kt}%`}})}),a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>{confirm("End workout early?")&&j("muscle_overview")},"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsxs("span",{className:"mg-header-info",children:["Exercise ",tt+1,"/",We]}),a.jsx("div",{style:{width:22}})]})}),a.jsxs("main",{className:"wk-main",children:[is?a.jsxs("div",{className:"mg-video-container",onClick:Qe,children:[is.isGif?a.jsx("img",{className:"mg-video",src:is.url,alt:xe.name}):a.jsx("video",{ref:wt,className:"mg-video",src:is.url,loop:!0,muted:!0,playsInline:!0},xe.name),!Ye&&!is.isGif&&a.jsxs("div",{className:"mg-video-overlay",children:[a.jsx("svg",{className:"mg-play-icon",width:"48",height:"48",viewBox:"0 0 24 24",fill:"rgba(255,255,255,0.9)",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),a.jsx("span",{className:"mg-video-hint",children:"Tap for demo"})]})]}):a.jsxs("div",{className:"mg-video-placeholder",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.4",children:[a.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),a.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),a.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),a.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),a.jsx("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),a.jsx("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),a.jsx("line",{x1:"17",y1:"7",x2:"22",y2:"7"}),a.jsx("line",{x1:"17",y1:"17",x2:"22",y2:"17"})]}),a.jsx("span",{children:"Video coming soon"})]}),a.jsx("div",{className:"wk-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"mg-exercise-card",children:[a.jsx("h2",{className:"mg-ex-name",children:xe.name}),a.jsx("span",{className:`mg-ex-type-badge ${xe.type}`,children:xe.type==="weighted"?"Weight + Reps":xe.type==="reps"?"Reps Only":"Timed"}),a.jsxs("div",{className:"mg-ex-set-info",children:[a.jsxs("span",{className:"mg-ex-set-num",children:["Set ",Be+1," of ",xe.sets]}),xe.type!=="timed"&&a.jsxs("span",{className:"mg-ex-target",children:["Target: ",xe.reps," reps"]}),xe.type==="timed"&&a.jsxs("span",{className:"mg-ex-target",children:["Target: ",xe.time,"s"]})]}),xe.type==="weighted"&&a.jsxs("div",{className:"mg-input-area",children:[a.jsxs("div",{className:"mg-input-group",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",inputMode:"decimal",className:"mg-input",value:on,onChange:ms=>qt(ms.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"mg-input-group",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:Cs,onChange:ms=>ns(ms.target.value),placeholder:"0"})]})]}),xe.type==="reps"&&a.jsx("div",{className:"mg-input-area",children:a.jsxs("div",{className:"mg-input-group mg-input-single",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:Cs,onChange:ms=>ns(ms.target.value),placeholder:"0"})]})}),xe.type==="timed"&&a.jsxs("div",{className:"mg-timer-area",children:[a.jsx("div",{className:"mg-timer-display",children:a.jsxs("span",{className:"mg-timer-value",children:[Re,"s"]})}),_s?a.jsx("button",{className:"mg-timer-btn mg-timer-stop",onClick:()=>he(!1),children:"Stop"}):a.jsx("button",{className:"mg-timer-btn",onClick:()=>{Re===0&&ze(xe.time),he(!0)},children:Re<xe.time&&Re>0?"Resume":"Start Timer"})]}),a.jsx("button",{className:"mg-log-set-btn",onClick:qe,children:yn}),te.sets.length>0&&a.jsx("div",{className:"mg-completed-sets",children:te.sets.map((ms,Fn)=>a.jsxs("div",{className:"mg-completed-set",children:[a.jsx("span",{className:"mg-completed-set-check",children:""}),a.jsxs("span",{children:["Set ",Fn+1,": ",ms.weight!=null?`${ms.weight}kg  ${ms.reps}`:ms.reps!=null?`${ms.reps} reps`:`${ms.time}s`]})]},Fn))})]})]}),Hs]})}if(k==="muscle_complete"){const Y=Ct.reduce((Be,We)=>Be+We.sets.length,0),xe=Ct.reduce((Be,We)=>Be+We.sets.reduce((ot,xt)=>ot+(xt.weight||0)*(xt.reps||0),0),0),te=eu.find(Be=>Be.key===mt)?.label||"";return a.jsxs("div",{className:"wk-page wk-page-center","data-theme":l?"dark":"light","data-accent":d,children:[a.jsxs("div",{className:"wk-complete",children:[a.jsxs("div",{className:"wk-complete-ring",children:[a.jsx("svg",{className:"wk-complete-svg",viewBox:"0 0 200 200",children:mu.map((Be,We)=>a.jsx("line",{x1:Be.x1,y1:Be.y1,x2:Be.x2,y2:Be.y2,className:"wk-tick-complete",strokeWidth:Be.thick?"3.5":"2",style:{animationDelay:`${We*.02}s`}},We))}),a.jsx("div",{className:"wk-complete-center",children:a.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})})})]}),a.jsxs("h2",{className:"wk-complete-title",children:[te," Complete!"]}),a.jsx("p",{className:"mg-complete-session-name",children:Je?.name}),a.jsxs("div",{className:"wk-complete-stats",children:[a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Ct.length}),a.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Y}),a.jsx("span",{className:"wk-stat-label",children:"Sets"})]}),xe>0&&a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Math.round(xe).toLocaleString()}),a.jsx("span",{className:"wk-stat-label",children:"Volume (kg)"})]})]}),a.jsx("div",{className:"wk-complete-actions",children:a.jsx("button",{className:"wk-btn-primary",onClick:()=>{ut(null),pt(null),ve(null),j("menu")},children:"Done"})})]}),Q&&a.jsx("div",{className:"mg-badge-celebration",onClick:()=>ve(null),children:a.jsxs("div",{className:"mg-badge-celebration-card",children:[a.jsx("div",{className:"mg-badge-celebration-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",width:"48",height:"48",fill:"#ffc107",children:a.jsx("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})})}),a.jsx("h3",{className:"mg-badge-celebration-title",children:Q.badges.length===1?"Badge Earned!":`${Q.badges.length} Badges Earned!`}),a.jsx("div",{className:"mg-badge-celebration-list",children:Q.badges.map((Be,We)=>a.jsx("div",{className:"mg-badge-celebration-item",children:Be.type==="pb_target"?`${Be.exercise}  ${Be.targetWeight}kg`:Be.label},We))}),a.jsx("button",{className:"mg-badge-celebration-dismiss",children:"Tap to dismiss"})]})})]})}return null}const SD=60,CD={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},RD=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],_2=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,daysPerWeek:3,level:"All Levels",description:"Build total body strength with compound dumbbell movements and bodyweight finishers",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push Focus",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Goblet Squats",type:"weighted",sets:3,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull Focus",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:3,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:3,baseReps:10,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Reverse Lunge",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/reverse lunge.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Legs & Core",exercises:[{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Box Step Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/box step ups.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,daysPerWeek:3,level:"Intermediate",description:"Two-phase programme building strength and endurance across your full body",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Power",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"}]},{name:"Day 3",label:"Endurance",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,daysPerWeek:3,level:"Advanced",description:"Complete transformation programme: push, pull, and legs over three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Upper Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Lower Body",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 3",label:"Upper Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,daysPerWeek:3,level:"Beginner",description:"Build a solid core foundation with targeted ab and stability work",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Abs",exercises:[{name:"Crunch",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Stability",exercises:[{name:"Dead Bug",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Bird Dog",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:20,storagePath:"exercises/bodyweight/core/Side Plank.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"}]},{name:"Day 3",label:"Power Core",exercises:[{name:"Single Leg V-Up",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Single Leg V-Up.mp4"},{name:"Toe Reaches",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/toe reaches.GIF"},{name:"Russian Twists Dumbbell",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/core/russian twists dumbbell.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Fast Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Fast Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,daysPerWeek:3,level:"Intermediate",description:"Develop deep core strength and rotational power over two phases",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Anti-Extension",exercises:[{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Dead Bug",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Plank Walkout",type:"reps",sets:3,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"}]},{name:"Day 2",label:"Rotation",exercises:[{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank Rotation",type:"reps",sets:2,baseReps:10,storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"},{name:"Hollow Hold To V-Sit",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Kettlebell Bird Dog Drag",type:"reps",sets:3,baseReps:10,storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,daysPerWeek:3,level:"Advanced",description:"Ultimate core transformation: stability, strength, and power across three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Forearm Plank",type:"timed",sets:4,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Plank Walkout",type:"reps",sets:4,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Leg Raises",type:"reps",sets:4,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Kettlebell Side Bends",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Dead Bug Single Leg Drop",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 2",label:"Endurance",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:4,baseReps:15,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Hollow Hold Flutter Kicks",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"},{name:"Cross Body Mountain Climbers",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Hollow Hold To V-Sit",type:"reps",sets:4,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Hip Dips Plank",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Kneeling Kettlebell Halo",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,daysPerWeek:3,level:"Intermediate",description:"Sculpt and strengthen your chest, back, shoulders, and arms",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Tricep Dips",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Pike Push Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/upper/pike push ups.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Reverse Plank",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/upper/reverse plank.GIF"}]},{name:"Day 3",label:"Mixed",exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Renegade Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Superman Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Superman Hold.mp4"}]}]},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,daysPerWeek:3,level:"Intermediate",description:"Build powerful legs and glutes with squats, deadlifts, and plyometrics",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Quad Dominant",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Squat And Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/lower/squat and hold.GIF"}]},{name:"Day 2",label:"Hamstring & Glute",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"1 Legged RDL",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.GIF"},{name:"Hip Thrusts",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/hip thrusts.GIF"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.GIF"},{name:"Donkey Kicks",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 3",label:"Power & Stability",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Kettlebell Romanian Deadlift",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/kettlebells/lower/kettlebell romanian deadlift.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Skater Jumps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/skater jumps.GIF"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]}];function oh(n,e,t){const i=n.baseReps?n.baseReps+(e-1)*(t.repProg||0):void 0,l=n.baseTime?n.baseTime+(e-1)*(t.timeProg||0):void 0;return{sets:n.sets,reps:i,time:l}}const AD={fullbody:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z",core:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z",upper:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z",lower:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"};function ID(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Pr(),{isDark:l,toggleTheme:u,accent:d}=ja(),p=Wn(),g=ka(),[y,w]=v.useState("loading"),[k,j]=v.useState(null),O=v.useRef(!1),[q,B]=v.useState(null),[V,ne]=v.useState(1),[K,le]=v.useState(0),[ge,Ie]=v.useState(0),[Te,R]=v.useState(0),[T,A]=v.useState([]),[L,D]=v.useState(""),[F,M]=v.useState(""),[$e,bt]=v.useState(!1),[H,fe]=v.useState(0),Me=v.useRef(null),[Ke,ee]=v.useState({}),[P,se]=v.useState(!1),Se=v.useRef(null),[Oe,st]=v.useState(null),[Ue,gt]=v.useState([]);v.useEffect(()=>{window.scrollTo(0,0)},[y]);const[Tt,rt]=v.useState(null),Wt=v.useCallback((he,Re="info")=>{rt({message:he,type:Re}),setTimeout(()=>rt(null),4e3)},[]),js=v.useRef(null),At=()=>(js.current||(js.current=new(window.AudioContext||window.webkitAudioContext)),js.current),Ee=()=>{try{const he=At(),Re=he.createOscillator(),ze=he.createGain();Re.connect(ze),ze.connect(he.destination),Re.frequency.value=1200,ze.gain.value=.4,Re.start(he.currentTime),Re.stop(he.currentTime+.3)}catch{}};v.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),v.useEffect(()=>{if(!t)return;(async()=>{try{const Re=He(pe,"clientProgrammes",t.id),ze=await Ss(Re);ze.exists()&&B(ze.data());const Ye=g.state?.templateId;if(Ye&&!O.current){const Ve=_2.find(Le=>Le.id===Ye);if(Ve){O.current=!0,j(Ve),w("overview");return}}ze.exists()?w("dashboard"):p("/client/core-buddy/workouts",{replace:!0})}catch(Re){console.error("Error loading programme:",Re),p("/client/core-buddy/workouts",{replace:!0})}})()},[t]),v.useEffect(()=>{if(!$e||H<=0){$e&&H<=0&&(bt(!1),Ee());return}return Me.current=setTimeout(()=>fe(he=>he-1),1e3),()=>clearTimeout(Me.current)},[$e,H]);const Z=async he=>{if(t)try{await Ds(He(pe,"clientProgrammes",t.id),he),B(he)}catch(Re){console.error("Error saving programme:",Re),Wt("Failed to save. Check Firestore rules for clientProgrammes.","error")}},mt=async he=>{const Re={templateId:he.id,startDate:vt.now(),completedSessions:{}};await Z(Re),w("dashboard")},pt=async()=>{if(t)try{await vr(He(pe,"clientProgrammes",t.id)),B(null),w("browse")}catch(he){console.error("Error quitting programme:",he)}},Je=()=>q?_2.find(he=>he.id===q.templateId):null,ut=()=>{if(!q?.startDate)return 1;const he=q.startDate.toDate?q.startDate.toDate():new Date(q.startDate),ze=new Date-he,Ye=Math.floor(ze/(1e3*60*60*24));return Math.floor(Ye/7)+1},tt=()=>{if(!q)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const he=q.completedSessions||{},Re=Object.keys(he).length,ze=Je();if(!ze)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const Ye=ze.duration*ze.daysPerWeek,Ve=ut(),Le=Math.min(Ve,ze.duration);let De=0;for(let ft=0;ft<ze.daysPerWeek;ft++)he[`w${Le}d${ft}`]&&De++;if(Re>=Ye)return{currentWeek:ze.duration,completedThisWeek:ze.daysPerWeek,nextDay:-1,totalCompleted:Re,totalSessions:Ye,complete:!0};if(Ve>ze.duration)return{currentWeek:ze.duration,completedThisWeek:De,nextDay:-1,totalCompleted:Re,totalSessions:Ye,complete:!0};let wt=-1;for(let ft=0;ft<ze.daysPerWeek;ft++)if(!he[`w${Le}d${ft}`]){wt=ft;break}return{currentWeek:Le,completedThisWeek:De,nextDay:wt,nextWeek:Le,totalCompleted:Re,totalSessions:Ye}},Ze=he=>{const Re=ut();return he<Re},Pt=(he,Re,ze)=>{if(!q||he<=1)return null;const Ye=`w${he-1}d${Re}`,Ve=q.completedSessions?.[Ye];if(!Ve)return null;const Le=Ve.exercises?.find(De=>De.name===ze);return Le?.sets?.length?Le.sets[Le.sets.length-1]:null},Ks=(he,Re)=>{const ze=Je();if(!ze)return;ne(he),le(Re),Ie(0),R(0),A([]),M(""),bt(!1),fe(0),se(!1),ee({});const Ye=ze.days[Re],Ve=Ye.exercises.map(ft=>{const Ut=oh(ft,he,ze);return{name:ft.name,type:ft.type,pbKey:ft.pbKey,targetSets:Ut.sets,targetReps:Ut.reps,targetTime:Ut.time,sets:[]}});A(Ve);const Le=Ye.exercises[0],De=Pt(he,Re,Le.name);De?.weight&&Le.type==="weighted"?D(String(De.weight)):D(""),(async()=>{const ft={};for(const Ut of Ye.exercises)if(Ut.storagePath)try{const Gt=so(no,Ut.storagePath),Q=await Ko(Gt);ft[Ut.name]={url:Q,isGif:/\.gif$/i.test(Ut.storagePath)}}catch(Gt){console.warn(`Video not found for ${Ut.name}:`,Gt)}ee(ft)})(),w("session")},Ct=async()=>{Je();const he=T[ge];if(!he)return;let Re={};if(he.type==="weighted"){const Ve=parseFloat(L)||0,Le=parseInt(F)||0;if(Le===0){Wt("Enter your reps","error");return}Re={weight:Ve,reps:Le}}else if(he.type==="reps"){const Ve=parseInt(F)||0;if(Ve===0){Wt("Enter your reps","error");return}Re={reps:Ve}}else if(he.type==="timed"){const Ve=he.targetTime-H;Re={time:Math.max(Ve,1)}}const ze=[...T];ze[ge]={...he,sets:[...he.sets,Re]},A(ze),he.type==="weighted"&&Re.weight>0&&await qt(he.name,Re.weight,Re.reps);const Ye=he.sets.length+1;if(Ye<he.targetSets)R(Ye),D(Re.weight?String(Re.weight):""),M(""),bt(!1),fe(0);else if(ge+1<T.length){const Ve=ge+1;Ie(Ve),R(0),se(!1);const De=Je()?.days[K]?.exercises[Ve],wt=Pt(V,K,De?.name);wt?.weight&&De?.type==="weighted"?D(String(wt.weight)):D(""),M(""),bt(!1),fe(0)}else await as(ze)},as=async he=>{if(!q||!t)return;const Re=`w${V}d${K}`,ze={...q.completedSessions,[Re]:{completedAt:new Date().toISOString(),exercises:he.map(Le=>({name:Le.name,type:Le.type,sets:Le.sets}))}},Ye={...q,completedSessions:ze};await Z(Ye);const Ve=he.reduce((Le,De)=>Le+De.sets.reduce((wt,ft)=>wt+(ft.weight||0)*(ft.reps||0),0),0);Ve>0&&await on(Ve);try{const Le=Je();await pi(Ht(pe,"workoutLogs"),{clientId:t.id,type:"programme",programmeId:Le?.id,programmeName:Le?.name,week:V,day:K+1,exerciseCount:he.length,duration:Math.round(he.reduce((De,wt)=>De+wt.sets.length*1.5,0)),volume:Math.round(Ve),completedAt:vt.now()})}catch(Le){console.error("Error saving workout log:",Le)}Ue.length>0&&(st({badges:[...Ue]}),gt([])),w("sessionComplete")},on=async he=>{if(t)try{const Re=await Ss(He(pe,"coreBuddyAchievements",t.id)),ze=Re.exists()?Re.data():{clientId:t.id,badges:[],totalVolume:0},Ye=ze.totalVolume||0,Ve=Ye+he,Le=[];RD.forEach(wt=>{Ve>=wt.threshold&&Ye<wt.threshold&&(ze.badges.some(Ut=>Ut.type==="volume_milestone"&&Ut.milestone===wt.threshold)||Le.push({type:"volume_milestone",milestone:wt.threshold,label:wt.label,achievedAt:vt.now()}))});const De=[...ze.badges,...Le];await Ds(He(pe,"coreBuddyAchievements",t.id),{clientId:t.id,badges:De,totalVolume:Math.round(Ve),updatedAt:vt.now()}),Le.length>0&&gt(wt=>[...wt,...Le])}catch(Re){console.error("Error updating volume:",Re)}},qt=async(he,Re,ze)=>{if(t)try{const Ye=t.id,Ve=await Ss(He(pe,"coreBuddyPBs",Ye)),De=(Ve.exists()?Ve.data():null)?.exercises||{},wt=De[he];let ft=!1;if(wt?(Re>(wt.weight||0)||Re===(wt.weight||0)&&ze>(wt.reps||0))&&(ft=!0):ft=!0,ft){const Ut={...De,[he]:{weight:Re,reps:ze,achievedAt:vt.now()}};await Ds(He(pe,"coreBuddyPBs",Ye),{clientId:t.id,exercises:Ut,updatedAt:vt.now()}),Wt(`New PB! ${Re}kg  ${ze} reps`,"success"),Ee(),await Cs(he,Re)}}catch(Ye){console.error("Error checking PB:",Ye)}},Cs=async(he,Re)=>{if(t)try{const ze=await Ss(He(pe,"coreBuddyTargets",t.id));if(!ze.exists())return;const Ve=(ze.data().targets||{})[he];if(!Ve||Re<Ve.targetWeight)return;const Le=await Ss(He(pe,"coreBuddyAchievements",t.id)),De=Le.exists()?Le.data():{clientId:t.id,badges:[],totalVolume:0};if(De.badges.some(Gt=>Gt.type==="pb_target"&&Gt.exercise===he&&Gt.targetWeight===Ve.targetWeight))return;const ft={type:"pb_target",exercise:he,group:CD[he]||"push",targetWeight:Ve.targetWeight,achievedAt:vt.now()},Ut=[...De.badges,ft];await Ds(He(pe,"coreBuddyAchievements",t.id),{...De,badges:Ut,updatedAt:vt.now()}),gt(Gt=>[...Gt,ft])}catch(ze){console.error("Error checking target badge:",ze)}},ns=Tt&&a.jsxs("div",{className:`toast-notification ${Tt.type}`,children:[Tt.type==="success"&&a.jsx("span",{children:" "}),Tt.message]}),_s=(he,Re)=>a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:Re,"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})});if(i||y==="loading")return a.jsx("div",{className:"cb-loading",children:a.jsx("div",{className:"cb-loading-spinner"})});if(y==="browse")return p("/client/core-buddy/workouts",{replace:!0}),null;if(y==="overview"&&k){const he=k;return a.jsxs("div",{className:"pg-page","data-theme":l?"dark":"light","data-accent":d,children:[_s(he.name,()=>p("/client/core-buddy/workouts")),a.jsxs("main",{className:"pg-main",children:[a.jsxs("div",{className:"pg-overview-hero",children:[a.jsx("svg",{className:"pg-overview-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:AD[he.focus]})}),a.jsx("h2",{className:"pg-overview-name",children:he.name}),a.jsx("p",{className:"pg-overview-desc",children:he.description}),a.jsxs("div",{className:"pg-overview-stats",children:[a.jsxs("div",{className:"pg-ov-stat",children:[a.jsx("span",{className:"pg-ov-stat-num",children:he.duration}),a.jsx("span",{className:"pg-ov-stat-label",children:"Weeks"})]}),a.jsxs("div",{className:"pg-ov-stat",children:[a.jsx("span",{className:"pg-ov-stat-num",children:he.daysPerWeek}),a.jsx("span",{className:"pg-ov-stat-label",children:"Days/Week"})]}),a.jsxs("div",{className:"pg-ov-stat",children:[a.jsx("span",{className:"pg-ov-stat-num",children:he.duration*he.daysPerWeek}),a.jsx("span",{className:"pg-ov-stat-label",children:"Sessions"})]})]})]}),a.jsx("div",{className:"pg-overview-days",children:he.days.map((Re,ze)=>a.jsxs("div",{className:"pg-day-card",children:[a.jsxs("div",{className:"pg-day-header",children:[a.jsx("span",{className:"pg-day-name",children:Re.name}),a.jsx("span",{className:"pg-day-label",children:Re.label})]}),a.jsx("div",{className:"pg-day-exercises",children:Re.exercises.map((Ye,Ve)=>{const Le=oh(Ye,1,he);return a.jsxs("div",{className:"pg-day-ex",children:[a.jsx("span",{className:"pg-day-ex-name",children:Ye.name}),a.jsx("span",{className:"pg-day-ex-target",children:Ye.type==="timed"?`${Le.sets}${Le.time}s`:`${Le.sets}${Le.reps}`}),a.jsx("span",{className:`pg-day-ex-badge pg-badge-${Ye.type}`,children:Ye.type==="weighted"?"WT":Ye.type==="timed"?"TMR":"BW"})]},Ve)})})]},ze))}),a.jsxs("div",{className:"pg-overview-note",children:[a.jsx("strong",{children:"Progressive Overload:"})," +",he.repProg," reps/week",he.timeProg?`, +${he.timeProg}s/week for timed`:""]}),a.jsx("button",{className:"pg-start-btn",onClick:()=>mt(he),children:"Start Programme"})]}),ns]})}if(y==="dashboard"){const he=Je();if(!he)return w("browse"),null;const Re=tt(),ze=q?.completedSessions||{},Ye=Re.totalSessions?Math.round(Re.totalCompleted/Re.totalSessions*100):0;return Math.round(Re.totalCompleted/(Re.totalSessions||1)*SD),a.jsxs("div",{className:"pg-page","data-theme":l?"dark":"light","data-accent":d,children:[_s("Programme",()=>p("/client/core-buddy/workouts")),a.jsxs("main",{className:"pg-main",children:[a.jsxs("div",{className:"pg-dash-hero",children:[a.jsxs("div",{className:"pg-dash-ring-wrap",children:[a.jsxs("svg",{viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"pg-arc-track",cx:"100",cy:"100",r:"80"}),a.jsx("circle",{className:"pg-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-Ye/100*2*Math.PI*80})]}),a.jsxs("div",{className:"pg-ring-center",children:[a.jsxs("span",{className:"pg-ring-pct",children:[Ye,"%"]}),a.jsx("span",{className:"pg-ring-label",children:"complete"})]})]}),a.jsx("h2",{className:"pg-dash-name",children:he.name}),a.jsxs("div",{className:"pg-dash-progress-text",children:[a.jsxs("span",{className:"pg-dash-pct",children:[Ye,"%"]}),a.jsxs("span",{className:"pg-dash-week",children:["Week ",Re.currentWeek," of ",he.duration]})]})]}),a.jsx("div",{className:"pg-weeks",children:Array.from({length:he.duration},(Ve,Le)=>{const De=Le+1,wt=Ze(De);return a.jsxs("div",{className:`pg-week-row${De===Re.currentWeek?" pg-week-current":""}`,children:[a.jsxs("span",{className:"pg-week-label",children:["W",De]}),a.jsx("div",{className:"pg-week-days",children:he.days.map((ft,Ut)=>{const Gt=`w${De}d${Ut}`,Q=!!ze[Gt],ve=!Q&&wt,at=!Q&&!ve&&De===Re.currentWeek&&!Re.complete;return a.jsx("button",{className:`pg-day-dot${Q?" done":""}${ve?" missed":""}${at?" next":""}`,disabled:!at,onClick:()=>{at&&Ks(De,Ut)},children:Q?a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}):ve?a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsx("span",{children:ft.name.replace("Day ","")})},Ut)})})]},Le)})}),!Re.complete&&(()=>{const Ve=he.days.map((Le,De)=>({day:Le,d:De})).filter(({d:Le})=>!ze[`w${Re.currentWeek}d${Le}`]);return Ve.length===0?null:a.jsxs("div",{className:"pg-next-session",children:[a.jsx("h3",{children:Ve.length===he.daysPerWeek?"Choose a Session":"Remaining Sessions"}),a.jsxs("p",{className:"pg-next-info",children:["Week ",Re.currentWeek,"  ",Ve.length," session",Ve.length!==1?"s":""," left this week"]}),Ve.map(({day:Le,d:De})=>a.jsxs("div",{className:"pg-available-session",children:[a.jsxs("div",{className:"pg-next-exercises",children:[a.jsxs("span",{className:"pg-avail-day-label",children:[Le.name,": ",Le.label]}),Le.exercises.map((wt,ft)=>{const Ut=oh(wt,Re.currentWeek,he);return a.jsxs("div",{className:"pg-next-ex",children:[a.jsx("span",{className:"pg-next-ex-name",children:wt.name}),a.jsx("span",{className:"pg-next-ex-target",children:wt.type==="timed"?`${Ut.sets}${Ut.time}s`:`${Ut.sets}${Ut.reps}`})]},ft)})]}),a.jsxs("button",{className:"pg-start-btn",onClick:()=>Ks(Re.currentWeek,De),children:["Start ",Le.name]})]},De))]})})(),Re.complete&&a.jsxs("div",{className:"pg-complete-msg",children:[a.jsx("h3",{children:"Programme Complete! "}),a.jsxs("p",{children:["You finished all ",Re.totalSessions," sessions."]}),a.jsx("button",{className:"pg-start-btn",onClick:pt,children:"Choose New Programme"})]}),a.jsx("button",{className:"pg-quit-btn",onClick:()=>{confirm("Quit this programme? Progress will be lost.")&&pt()},children:"Quit Programme"})]}),a.jsx(la,{active:"workouts"}),ns]})}if(y==="session"){const he=Je();if(!he)return null;const Re=he.days[K],ze=Re.exercises[ge],Ye=oh(ze,V,he),Ve=T[ge],Le=Ve?.sets?.length||0,De=Re.exercises.length,wt=(ge+Le/Ye.sets)/De,ft=Ke[ze.name],Ut=Pt(V,K,ze.name);ze.type==="timed"&&H===0&&!$e&&Le===Te&&setTimeout(()=>fe(Ye.time),0);const Gt=()=>{ft?.isGif?se(!P):Se.current&&(P?Se.current.pause():Se.current.play(),se(!P))};return a.jsxs("div",{className:"pg-page pg-page-session","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("div",{className:"pg-session-progress",children:a.jsx("div",{className:"pg-session-progress-fill",style:{width:`${wt*100}%`}})}),a.jsxs("div",{className:"pg-session-header",children:[a.jsx("button",{className:"pg-session-back",onClick:()=>{confirm("Leave session? Progress will be lost.")&&w("dashboard")},children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M19 12H5M12 5l-7 7 7 7"})})}),a.jsxs("div",{className:"pg-session-title",children:[a.jsxs("span",{className:"pg-session-counter",children:[ge+1," / ",De]}),a.jsxs("span",{className:"pg-session-week",children:["Week ",V,"  ",Re.name]})]})]}),ft&&a.jsxs("div",{className:"pg-video-container",onClick:Gt,children:[ft.isGif?a.jsx("img",{className:"pg-video",src:ft.url,alt:ze.name}):a.jsx("video",{ref:Se,className:"pg-video",src:ft.url,loop:!0,muted:!0,playsInline:!0},ze.name),!P&&a.jsxs("div",{className:"pg-video-overlay",children:[a.jsx("svg",{className:"pg-play-icon",viewBox:"0 0 24 24",fill:"white",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),a.jsx("span",{className:"pg-video-hint",children:"Tap for demo"})]})]}),a.jsx("div",{className:"pg-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"pg-exercise-card",children:[a.jsx("h2",{className:"pg-ex-name",children:ze.name}),a.jsx("span",{className:`pg-ex-type-badge pg-badge-${ze.type}`,children:ze.type==="weighted"?"Weight + Reps":ze.type==="timed"?"Timed":"Reps Only"}),ze.type==="weighted"&&Ut&&a.jsxs("div",{className:"pg-last-week",children:[a.jsx("span",{className:"pg-last-week-label",children:"Last week:"}),a.jsxs("span",{className:"pg-last-week-value",children:[Ut.weight,"kg x ",Ut.reps," reps"]})]}),a.jsxs("div",{className:"pg-ex-set-info",children:[a.jsxs("span",{className:"pg-ex-set-num",children:["Set ",Le+1," of ",Ye.sets]}),a.jsxs("span",{className:"pg-ex-target",children:["Target: ",ze.type==="timed"?`${Ye.time}s hold`:`${Ye.reps} reps`]})]}),ze.type==="weighted"&&a.jsxs("div",{className:"pg-input-area",children:[a.jsxs("div",{className:"pg-input-group",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",inputMode:"decimal",value:L,onChange:Q=>D(Q.target.value),placeholder:"0",className:"pg-input"})]}),a.jsxs("div",{className:"pg-input-group",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",value:F,onChange:Q=>M(Q.target.value),placeholder:String(Ye.reps),className:"pg-input"})]})]}),ze.type==="reps"&&a.jsx("div",{className:"pg-input-area",children:a.jsxs("div",{className:"pg-input-group pg-input-single",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",value:F,onChange:Q=>M(Q.target.value),placeholder:String(Ye.reps),className:"pg-input"})]})}),ze.type==="timed"&&a.jsxs("div",{className:"pg-timer-area",children:[a.jsx("div",{className:"pg-timer-display",children:a.jsxs("span",{className:"pg-timer-value",children:[H,"s"]})}),$e?a.jsx("button",{className:"pg-timer-btn pg-timer-stop",onClick:()=>bt(!1),children:"Stop"}):a.jsx("button",{className:"pg-timer-btn",onClick:()=>{H===0&&fe(Ye.time),bt(!0)},children:H<Ye.time&&H>0?"Resume":"Start Timer"})]}),a.jsx("button",{className:"pg-log-set-btn",onClick:Ct,disabled:ze.type==="timed"&&$e,children:Le+1<Ye.sets?"Log Set":ge+1<De?"Log Set  Next Exercise":"Log Set  Complete"}),Ve?.sets?.length>0&&a.jsx("div",{className:"pg-completed-sets",children:Ve.sets.map((Q,ve)=>a.jsxs("div",{className:"pg-completed-set",children:[a.jsx("span",{className:"pg-completed-set-check",children:""}),a.jsxs("span",{children:["Set ",ve+1,": ",Q.weight!==void 0?`${Q.weight}kg  ${Q.reps}`:Q.time!==void 0?`${Q.time}s`:`${Q.reps} reps`]})]},ve))})]}),ns]})}if(y==="sessionComplete"){const Re=Je()?.days[K],ze=T.reduce((Ve,Le)=>Ve+Le.sets.length,0),Ye=T.reduce((Ve,Le)=>Ve+Le.sets.reduce((De,wt)=>De+(wt.weight||0)*(wt.reps||0),0),0);return a.jsxs("div",{className:"pg-page pg-page-center","data-theme":l?"dark":"light","data-accent":d,children:[a.jsxs("div",{className:"pg-session-done",children:[a.jsxs("div",{className:"pg-done-ring",children:[a.jsx("svg",{className:"pg-done-ring-svg",viewBox:"0 0 200 200",children:mu.map((Ve,Le)=>a.jsx("line",{x1:Ve.x1,y1:Ve.y1,x2:Ve.x2,y2:Ve.y2,className:"pg-tick-complete",strokeWidth:Ve.thick?"3.5":"2",style:{animationDelay:`${Le*.02}s`}},Le))}),a.jsx("div",{className:"pg-done-center",children:a.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})})})]}),a.jsx("h2",{className:"pg-done-title",children:"Session Complete!"}),a.jsxs("p",{className:"pg-done-subtitle",children:["Week ",V,"  ",Re?.name,": ",Re?.label]}),a.jsxs("div",{className:"pg-done-stats",children:[a.jsxs("div",{className:"pg-done-stat",children:[a.jsx("span",{className:"pg-done-stat-num",children:T.length}),a.jsx("span",{className:"pg-done-stat-label",children:"Exercises"})]}),a.jsxs("div",{className:"pg-done-stat",children:[a.jsx("span",{className:"pg-done-stat-num",children:ze}),a.jsx("span",{className:"pg-done-stat-label",children:"Sets"})]}),Ye>0&&a.jsxs("div",{className:"pg-done-stat",children:[a.jsx("span",{className:"pg-done-stat-num",children:Math.round(Ye).toLocaleString()}),a.jsx("span",{className:"pg-done-stat-label",children:"Volume (kg)"})]})]}),a.jsx("button",{className:"pg-start-btn",onClick:()=>w("dashboard"),children:"Back to Programme"})]}),Oe&&a.jsx("div",{className:"pg-badge-celebration",onClick:()=>st(null),children:a.jsxs("div",{className:"pg-badge-celebration-card",onClick:Ve=>Ve.stopPropagation(),children:[a.jsx("div",{className:"pg-badge-celebration-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsx("h3",{className:"pg-badge-celebration-title",children:Oe.badges.length===1?"Badge Earned!":`${Oe.badges.length} Badges Earned!`}),a.jsx("div",{className:"pg-badge-celebration-list",children:Oe.badges.map((Ve,Le)=>a.jsx("div",{className:"pg-badge-celebration-item",children:Ve.type==="pb_target"?`${Ve.exercise}  ${Ve.targetWeight}kg`:Ve.label},Le))}),a.jsx("button",{className:"pg-badge-celebration-dismiss",onClick:()=>st(null),children:"Tap to dismiss"})]})}),ns]})}return null}const MD={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},DD={push:{label:"Push",color:"#c75f6b",icon:"M4 12h3l3-9 4 18 3-9h3"},pull:{label:"Pull",color:"#5f8ac7",icon:"M12 2v10m0 0l-4-4m4 4l4-4M4 20h16"},lower:{label:"Lower",color:"#5fc77a",icon:"M12 2v8m-4 4l4 8 4-8m-8 0h8"},core:{label:"Core",color:"#c7a45f",icon:"M12 2a4 4 0 014 4v1h-2V6a2 2 0 10-4 0v1H8V6a4 4 0 014-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"}},Kp=[{threshold:1e3,label:"1 Tonne",icon:"1T"},{threshold:5e3,label:"5 Tonne",icon:"5T"},{threshold:1e4,label:"10 Tonne",icon:"10T"},{threshold:25e3,label:"25 Tonne",icon:"25T"},{threshold:5e4,label:"50 Tonne",icon:"50T"},{threshold:1e5,label:"100 Tonne",icon:"100T"},{threshold:25e4,label:"250 Tonne",icon:"250T"},{threshold:5e5,label:"500 Tonne",icon:"500T"},{threshold:1e6,label:"1 Million kg",icon:"1M"}];function PD(n){return MD[n]||"push"}function LD(n){return n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}T`:`${Math.round(n)}`}function OD(n){return n>=1e6?"million kg":n>=1e3?"tonnes":"kg"}function VD(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Pr(),{isDark:l,toggleTheme:u,accent:d}=ja(),p=Wn(),[g,y]=v.useState(!0),[w,k]=v.useState(null),[j,O]=v.useState({}),[q,B]=v.useState([]),[V,ne]=v.useState(null),[K,le]=v.useState(0),[ge,Ie]=v.useState({});v.useRef(null),v.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),v.useEffect(()=>{if(!t)return;(async()=>{try{const[fe,Me,Ke,ee]=await Promise.all([Ss(He(pe,"coreBuddyAchievements",t.id)),Ss(He(pe,"coreBuddyPBs",t.id)),Ss(He(pe,"achievements",t.id)),ws(Ns(Ht(pe,"workoutLogs"),cs("clientId","==",t.id)))]);fe.exists()&&k(fe.data()),Me.exists()&&O(Me.data().exercises||{}),Ke.exists()&&(B(Object.keys(Ke.data().badges||{})),Ie(Ke.data().progress||{})),le(ee.docs.length)}catch(fe){console.error("Error loading achievements:",fe)}y(!1)})()},[t]);const Te=w?.badges||[],R=w?.totalVolume||0,T=Te.filter(H=>H.type==="pb_target"),A=Te.filter(H=>H.type==="volume_milestone"),L={push:[],pull:[],lower:[],core:[]};T.forEach(H=>{const fe=H.group||PD(H.exercise);L[fe]&&L[fe].push(H)});const D=Kp.find(H=>R<H.threshold),F=Kp.filter(H=>R>=H.threshold).pop()?.threshold||0,M=D?(R-F)/(D.threshold-F):1;if(i||g)return a.jsxs("div",{className:"ach-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("header",{className:"client-header",children:a.jsx("div",{className:"header-content",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),a.jsx("div",{className:"ach-loading-inline",children:a.jsx("div",{className:"cb-loading-spinner"})})]});const $e=Te.length+q.length,bt=$e>0||R>0||K>0;return a.jsxs("div",{className:"ach-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"ach-main",children:[a.jsx("button",{className:"nut-back-btn",onClick:()=>p("/client/personal-bests?mode=corebuddy"),children:" Back"}),a.jsxs("div",{className:"ach-stats-banner",children:[a.jsxs("div",{className:"ach-stat-item",children:[a.jsx("span",{className:"ach-stat-num",children:$e}),a.jsx("span",{className:"ach-stat-label",children:$e===1?"Badge":"Badges"})]}),a.jsx("div",{className:"ach-stat-divider"}),a.jsxs("div",{className:"ach-stat-item",children:[a.jsx("span",{className:"ach-stat-num",children:LD(R)}),a.jsxs("span",{className:"ach-stat-label",children:[OD(R)," lifted"]})]}),a.jsx("div",{className:"ach-stat-divider"}),a.jsxs("div",{className:"ach-stat-item",children:[a.jsx("span",{className:"ach-stat-num",children:Object.keys(j).length}),a.jsx("span",{className:"ach-stat-label",children:"PBs"})]})]}),!bt&&a.jsxs("div",{className:"ach-empty",children:[a.jsx("div",{className:"ach-empty-icon",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M12 15l-3-3h6l-3 3z"}),a.jsx("path",{d:"M5 7h14l-1.5 9h-11L5 7z"}),a.jsx("path",{d:"M8.5 7V5a3.5 3.5 0 017 0v2"})]})}),a.jsx("h4",{children:"No achievements yet"}),a.jsx("p",{children:"Complete workouts to track volume and set PB targets to start earning badges."})]}),[{key:"workouts",title:"Workout Badges",iconPath:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"},{key:"streaks",title:"Streak Badges",iconPath:"M13.5.67s.74 2.65.74 4.8c0 2.06-1.35 3.73-3.41 3.73-2.07 0-3.63-1.67-3.63-3.73l.03-.36C5.21 7.51 4 10.62 4 14c0 4.42 3.58 8 8 8s8-3.58 8-8C20 8.61 17.41 3.8 13.5.67z"},{key:"pbs",title:"Personal Best Badges",iconPath:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"},{key:"nutrition",title:"Nutrition Badges",iconPath:"M18.06 23h1.66c.84 0 1.53-.65 1.63-1.47L23 5.05h-5V1h-2v4.05h-5l.3 2.34c1.71.47 3.31 1.32 4.27 2.26 1.44 1.42 2.43 2.89 2.43 5.29V23zM1 22v-1h15.03v1c0 .55-.45 1-1.01 1H2.01c-.56 0-1.01-.45-1.01-1zm15.03-7c0-4.87-4.66-5.84-8.03-5.97l.72 5.52L1 15.05v5.95h15.03V15z"},{key:"habits",title:"Habit Badges",iconPath:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"},{key:"leaderboard",title:"Leaderboard Badges",iconPath:"M7.5 21H2V9h5.5v12zm7.25-18h-5.5v18h5.5V3zM22 11h-5.5v10H22V11z"}].map(H=>{const fe=pu.filter(ee=>ee.category===H.key);if(fe.length===0)return null;const Me=(()=>{switch(H.key){case"workouts":return K;case"streaks":return ge.streakWeeks||0;case"pbs":return Object.keys(j).length;case"nutrition":return ge.nutritionStreak||0;case"leaderboard":return t?.leaderboardOptIn?1:0;case"habits":return ge.habitStreak||0;default:return 0}})(),Ke=fe.filter(ee=>q.includes(ee.id)).length;return a.jsxs("div",{className:"ach-section",children:[a.jsxs("h3",{className:"ach-section-title",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:H.iconPath})}),H.title]}),a.jsx("div",{className:"ach-workout-carousel",children:fe.map(ee=>{const P=q.includes(ee.id);return a.jsxs("button",{className:`ach-workout-badge${P?" unlocked":" locked"}`,onClick:()=>ne(ee),children:[a.jsx("img",{src:ee.img,alt:ee.name,className:"ach-workout-badge-img"}),!P&&ee.threshold&&a.jsx("div",{className:"ach-workout-badge-progress",children:a.jsx("div",{className:"ach-workout-badge-progress-fill",style:{width:`${Math.min(Me/ee.threshold*100,100)}%`}})})]},ee.id)})}),a.jsxs("p",{className:"ach-workout-badges-count",children:[Ke,"/",fe.length," unlocked"]})]},H.key)}),V&&a.jsx("div",{className:"ach-badge-overlay",onClick:()=>ne(null),children:a.jsxs("div",{className:"ach-badge-overlay-content",onClick:H=>H.stopPropagation(),children:[a.jsx("img",{src:V.img,alt:V.name,className:`ach-badge-overlay-img${q.includes(V.id)?"":" ach-badge-overlay-img-locked"}`}),a.jsx("p",{className:"ach-badge-overlay-desc",children:V.desc}),q.includes(V.id)?a.jsx("span",{className:"ach-badge-overlay-status unlocked",children:"Unlocked"}):a.jsx("span",{className:"ach-badge-overlay-status locked",children:"Locked"}),a.jsx("button",{className:"ach-badge-overlay-close",onClick:()=>ne(null),children:"Tap to close"})]})}),a.jsxs("div",{className:"ach-section",children:[a.jsxs("h3",{className:"ach-section-title",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})}),"Volume Milestones"]}),a.jsxs("div",{className:"ach-volume-hero",children:[a.jsxs("div",{className:"ach-volume-ring",children:[a.jsx("svg",{className:"ach-volume-ring-svg",viewBox:"0 0 200 200",children:mu.map((H,fe)=>{const Me=fe<Math.round(M*60);return a.jsx("line",{x1:H.x1,y1:H.y1,x2:H.x2,y2:H.y2,className:Me?"ach-tick-filled":"ach-tick-empty",strokeWidth:H.thick?"3":"2"},fe)})}),a.jsxs("div",{className:"ach-volume-center",children:[a.jsx("span",{className:"ach-volume-number",children:Math.round(R).toLocaleString()}),a.jsx("span",{className:"ach-volume-unit",children:"kg lifted"})]})]}),D&&a.jsxs("div",{className:"ach-volume-next",children:["Next: ",a.jsx("strong",{children:D.label})," (",(D.threshold-R).toLocaleString(),"kg to go)"]})]}),a.jsx("div",{className:"ach-milestone-shelf",children:Kp.map((H,fe)=>{const Me=R>=H.threshold,Ke=A.find(ee=>ee.milestone===H.threshold);return a.jsxs("div",{className:`ach-milestone ${Me?"unlocked":"locked"}`,children:[a.jsx("div",{className:"ach-milestone-hex",children:a.jsx("span",{className:"ach-milestone-icon",children:H.icon})}),a.jsx("span",{className:"ach-milestone-label",children:H.label}),Ke?.achievedAt&&a.jsx("span",{className:"ach-milestone-date",children:(Ke.achievedAt.toDate?Ke.achievedAt.toDate():new Date(Ke.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short"})})]},fe)})})]}),a.jsxs("div",{className:"ach-section",children:[a.jsxs("h3",{className:"ach-section-title",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"PB Target Badges"]}),T.length===0?a.jsx("div",{className:"ach-pb-empty",children:a.jsxs("p",{children:["Set targets on your personal bests to start earning badges. Go to ",a.jsx("strong",{children:"My Progress"}),' and tap "Set Target" on any PB.']})}):Object.entries(L).map(([H,fe])=>{if(fe.length===0)return null;const Me=DD[H];return a.jsxs("div",{className:"ach-group",children:[a.jsxs("div",{className:"ach-group-header",style:{borderLeftColor:Me.color},children:[a.jsx("span",{className:"ach-group-label",style:{color:Me.color},children:Me.label}),a.jsx("span",{className:"ach-group-count",children:fe.length})]}),a.jsx("div",{className:"ach-badge-grid",children:fe.map((Ke,ee)=>a.jsxs("div",{className:"ach-badge-card",style:{animationDelay:`${ee*.06}s`,"--group-color":Me.color},children:[a.jsx("div",{className:"ach-badge-hex",style:{borderColor:Me.color,boxShadow:`0 0 12px ${Me.color}33`},children:a.jsx("svg",{className:"ach-badge-hex-icon",viewBox:"0 0 24 24",fill:"none",stroke:Me.color,strokeWidth:"2",strokeLinecap:"round",children:a.jsx("path",{d:Me.icon})})}),a.jsxs("div",{className:"ach-badge-info",children:[a.jsx("span",{className:"ach-badge-exercise",children:Ke.exercise}),a.jsxs("span",{className:"ach-badge-value",style:{color:Me.color},children:[Ke.targetWeight,"kg"]}),Ke.achievedAt&&a.jsx("span",{className:"ach-badge-date",children:(Ke.achievedAt.toDate?Ke.achievedAt.toDate():new Date(Ke.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})})]})]},ee))})]},H)})]})]}),a.jsx(la,{active:"home"})]})}const BD=[{key:"trained",label:"Trained",icon:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2.71 7 4.14 8.43 7.71 4.86 16.29 13.43 12.71 17 14.14 18.43 15.57 17 17 18.43 14.14 21.29l1.43 1.43 1.43-1.43 1.43 1.43 2.14-2.14 1.43 1.43L22 20.57z",color:"#A12F3A"},{key:"protein",label:"Hit Protein",icon:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z",color:"#4caf50"},{key:"steps",label:"10k Steps",icon:"M13.5 5.5c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zM9.8 8.9L7 23h2.1l1.8-8 2.1 2v6h2v-7.5l-2.1-2 .6-3C14.8 12 16.8 13 19 13v-2c-1.9 0-3.5-1-4.3-2.4l-1-1.6c-.4-.6-1-1-1.7-1-.3 0-.5.1-.8.1L6 8.3V13h2V9.6l1.8-.7",color:"#ff9800"},{key:"sleep",label:"8hrs Sleep",icon:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z",color:"#7c3aed"},{key:"water",label:"2L Water",icon:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z",color:"#2196f3"}],UD="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z",zD="#e91e63";function FD(n){const e=new Date(n),t=e.getDay(),i=t===0?-6:1-t;return e.setDate(e.getDate()+i),e.setHours(0,0,0,0),e}function Yp(n){return n.toISOString().split("T")[0]}function HD(n){return Array.from({length:7},(e,t)=>{const i=new Date(n);return i.setDate(n.getDate()+t),i})}function qD(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Pr(),{isDark:l,toggleTheme:u,accent:d}=ja(),p=Wn(),[g,y]=v.useState({}),[w,k]=v.useState([]),[j,O]=v.useState(!0),[q,B]=v.useState(!1),[V,ne]=v.useState(0),[K,le]=v.useState(null),[ge,Ie]=v.useState(null),[Te,R]=v.useState(!1),[T,A]=v.useState(!1),[L,D]=v.useState(""),[F,M]=v.useState(null),$e=v.useRef([]),bt=v.useRef([]),H=v.useCallback((Ee,Z="info")=>{le({message:Ee,type:Z}),setTimeout(()=>le(null),3e3)},[]),fe=new Date,Me=Yp(fe),Ke=FD(fe),ee=HD(Ke),P=["M","T","W","T","F","S","S"],se=[...BD,...w.map(Ee=>({key:`custom_${Ee.id}`,label:Ee.label,icon:UD,color:zD,isCustom:!0,id:Ee.id}))];v.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),v.useEffect(()=>{if(!n||!t)return;(async()=>{try{const Z=Ht(pe,"habitLogs"),mt=Ns(Z,cs("clientId","==",t.id)),pt=await ws(mt),Je={};pt.docs.forEach(Pt=>{const Ks=Pt.data();Je[Ks.date]={...Ks,_id:Pt.id}}),y(Je);const ut=await Ss(He(pe,"customHabits",t.id));ut.exists()&&k(ut.data().habits||[]);let tt=0;const Ze=new Date(fe);for(;;){const Pt=Yp(Ze),Ks=Je[Pt];if(Ks)if(Object.values(Ks.habits||{}).filter(Boolean).length>=3)tt++,Ze.setDate(Ze.getDate()-1);else break;else if(Pt===Me)Ze.setDate(Ze.getDate()-1);else break}ne(tt)}catch(Z){console.error("Error loading habit logs:",Z)}finally{O(!1)}})()},[n,t]);const Se=g[Me]||{habits:{}},Oe=async Ee=>{if(!n||q)return;const Z=Se.habits?.[Ee]||!1;Z||($e.current=[...Array(10)].map((mt,pt)=>{const Je=pt/10*2*Math.PI,ut=18+Math.random()*20;return{tx:Math.cos(Je)*ut,ty:Math.sin(Je)*ut,size:3+Math.random()*4,duration:.4+Math.random()*.3}}),Ie(Ee),setTimeout(()=>Ie(null),700)),B(!0);try{const mt=Se.habits||{},pt={...mt,[Ee]:!mt[Ee]},Je=Se._id||`${t.id}_${Me}`;await Ds(He(pe,"habitLogs",Je),{clientId:t.id,date:Me,habits:pt}),y(tt=>({...tt,[Me]:{clientId:t.id,date:Me,habits:pt,_id:Je}})),Object.values(pt).filter(Boolean).length===se.length&&!Z&&(bt.current=[...Array(50)].map((tt,Ze)=>({x:5+Math.random()*90,delay:Math.random()*.6,color:["#4caf50","#ff9800","#2196f3","#e91e63","#ffeb3b","#9c27b0"][Ze%6],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.5+Math.random()*1.5,width:4+Math.random()*8,height:4+Math.random()*10})),setTimeout(()=>{R(!0),setTimeout(()=>R(!1),3500)},500))}catch(mt){console.error("Error saving habit:",mt),H("Failed to save. Try again.","error")}finally{B(!1)}},st=async()=>{const Ee=L.trim();if(!Ee||!t)return;const Z=Date.now().toString(36),mt=[...w,{id:Z,label:Ee}];try{await Ds(He(pe,"customHabits",t.id),{clientId:t.id,habits:mt}),k(mt),D(""),A(!1),H(`Added "${Ee}"`,"success")}catch(pt){console.error("Error adding custom habit:",pt),H("Failed to add habit","error")}},Ue=async Ee=>{if(!t)return;const Z=w.filter(mt=>mt.id!==Ee);try{await Ds(He(pe,"customHabits",t.id),{clientId:t.id,habits:Z}),k(Z),M(null),H("Habit removed","success")}catch(mt){console.error("Error deleting habit:",mt),H("Failed to remove","error")}},gt=ee.map(Ee=>{const Z=Yp(Ee),mt=g[Z],pt=mt?Object.values(mt.habits||{}).filter(Boolean).length:0;return{date:Ee,dateStr:Z,completed:pt,total:se.length}}),Tt=gt.reduce((Ee,Z)=>Ee+Z.completed,0),rt=gt.reduce((Ee,Z)=>Ee+Z.total,0),Wt=rt>0?Math.round(Tt/rt*100):0,js=Object.values(Se.habits||{}).filter(Boolean).length,At=se.length>0?Math.round(js/se.length*100):0;return a.jsx(Ku,{children:a.jsxs("div",{className:"cbc-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),i||j?a.jsx("div",{className:"cbc-loading-inline",children:a.jsx("div",{className:"cbc-loading-spinner"})}):a.jsxs("main",{className:"cbc-main",children:[a.jsxs("div",{className:"cbc-ring-section",children:[a.jsxs("div",{className:"cbc-progress-ring",children:[a.jsxs("svg",{viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"cbc-arc-track",cx:"100",cy:"100",r:"80"}),a.jsx("circle",{className:"cbc-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-At/100*2*Math.PI*80})]}),a.jsxs("div",{className:"cbc-ring-center",children:[a.jsxs("span",{className:"cbc-ring-pct",children:[At,"%"]}),a.jsx("span",{className:"cbc-ring-label",children:"today"})]})]}),a.jsxs("div",{className:"cbc-streak",children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-primary)",strokeWidth:"2",children:a.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),a.jsx("span",{className:"cbc-streak-count",children:V}),a.jsx("span",{className:"cbc-streak-label",children:"day streak"})]})]}),a.jsxs("div",{className:"cbc-section",children:[a.jsx("h2",{className:"cbc-section-title",children:"Today's Habits"}),a.jsxs("div",{className:"cbc-habits",children:[se.map(Ee=>{const Z=Se.habits?.[Ee.key]||!1,mt=ge===Ee.key;return a.jsxs("button",{className:`cbc-habit-btn ${Z?"cbc-habit-done":""} ${mt?"cbc-habit-just-checked":""}`,onClick:()=>Oe(Ee.key),disabled:q,style:Z?{"--habit-color":Ee.color}:void 0,children:[a.jsxs("div",{className:"cbc-habit-icon-wrap",style:{"--habit-color":Ee.color},children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:Ee.icon})}),Z&&a.jsx("div",{className:"cbc-habit-done-badge",children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"3",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})})})]}),mt&&a.jsx("div",{className:"cbc-particles",children:$e.current.map((pt,Je)=>a.jsx("span",{className:"cbc-particle",style:{"--tx":`${pt.tx}px`,"--ty":`${pt.ty}px`,"--size":`${pt.size}px`,"--particle-color":Ee.color,animationDuration:`${pt.duration}s`}},Je))}),a.jsxs("div",{className:"cbc-habit-text",children:[a.jsx("span",{className:"cbc-habit-label",children:Ee.label}),Z&&a.jsx("span",{className:"cbc-habit-done-tag",children:"Done"})]}),Ee.isCustom&&a.jsx("button",{className:"cbc-habit-delete",onClick:pt=>{pt.stopPropagation(),M(Ee.id)},"aria-label":`Remove ${Ee.label}`,children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},Ee.key)}),a.jsxs("button",{className:"cbc-add-habit-btn",onClick:()=>A(!0),children:[a.jsx("div",{className:"cbc-add-habit-icon",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})}),a.jsx("span",{children:"Add your own habit"})]})]})]}),a.jsxs("div",{className:"cbc-section",children:[a.jsx("h2",{className:"cbc-section-title",children:"This Week"}),a.jsx("div",{className:"cbc-week-grid",children:gt.map((Ee,Z)=>{const mt=Ee.dateStr===Me,pt=Ee.total>0?Ee.completed/Ee.total:0,Je=38,ut=2*Math.PI*Je,tt=ut-pt*ut;return a.jsxs("div",{className:`cbc-day-ring ${mt?"cbc-day-today":""} ${Ee.completed>0?"cbc-day-active":""}`,children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cbc-day-track",cx:"50",cy:"50",r:Je}),a.jsx("circle",{className:"cbc-day-fill",cx:"50",cy:"50",r:Je,strokeDasharray:ut,strokeDashoffset:tt})]}),a.jsx("span",{className:"cbc-day-label",children:P[Z]}),a.jsxs("span",{className:"cbc-day-count",children:[Ee.completed,"/",Ee.total]})]},Z)})}),a.jsxs("div",{className:"cbc-week-summary",children:[a.jsx("div",{className:"cbc-week-summary-bar",children:a.jsx("div",{className:"cbc-week-summary-fill",style:{width:`${Wt}%`}})}),a.jsxs("span",{className:"cbc-week-summary-text",children:[Tt," / ",rt," habits this week (",Wt,"%)"]})]})]})]}),a.jsx(la,{active:"home"}),T&&a.jsx("div",{className:"cbc-modal-overlay",onClick:()=>A(!1),children:a.jsxs("div",{className:"cbc-modal",onClick:Ee=>Ee.stopPropagation(),children:[a.jsx("h3",{className:"cbc-modal-title",children:"Add Habit"}),a.jsx("p",{className:"cbc-modal-desc",children:"Track something personal to your routine."}),a.jsx("input",{className:"cbc-modal-input",type:"text",placeholder:"e.g. Meditate, Stretch, Read...",value:L,onChange:Ee=>D(Ee.target.value),maxLength:30,autoFocus:!0,onKeyDown:Ee=>Ee.key==="Enter"&&st()}),a.jsxs("div",{className:"cbc-modal-actions",children:[a.jsx("button",{className:"cbc-modal-cancel",onClick:()=>{A(!1),D("")},children:"Cancel"}),a.jsx("button",{className:"cbc-modal-save",onClick:st,disabled:!L.trim(),children:"Add"})]})]})}),F&&a.jsx("div",{className:"cbc-modal-overlay",onClick:()=>M(null),children:a.jsxs("div",{className:"cbc-modal",onClick:Ee=>Ee.stopPropagation(),children:[a.jsx("h3",{className:"cbc-modal-title",children:"Remove Habit?"}),a.jsx("p",{className:"cbc-modal-desc",children:"This will remove the habit from your daily tracker. Past logs won't be affected."}),a.jsxs("div",{className:"cbc-modal-actions",children:[a.jsx("button",{className:"cbc-modal-cancel",onClick:()=>M(null),children:"Keep"}),a.jsx("button",{className:"cbc-modal-delete",onClick:()=>Ue(F),children:"Remove"})]})]})}),Te&&a.jsxs("div",{className:"cbc-celebration",onClick:()=>R(!1),children:[a.jsx("div",{className:"cbc-confetti-container",children:bt.current.map((Ee,Z)=>a.jsx("span",{className:"cbc-confetti-piece",style:{"--x":`${Ee.x}%`,"--delay":`${Ee.delay}s`,"--color":Ee.color,"--drift":`${Ee.drift}px`,"--spin":`${Ee.spin}deg`,"--duration":`${Ee.duration}s`,width:`${Ee.width}px`,height:`${Ee.height}px`}},Z))}),a.jsxs("div",{className:"cbc-celebration-card",children:[a.jsxs("svg",{className:"cbc-celebration-icon",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-primary)",strokeWidth:"2",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),a.jsx("h2",{className:"cbc-celebration-title",children:"Crushed it!"}),a.jsx("p",{className:"cbc-celebration-sub",children:"All habits complete today"})]})]}),K&&a.jsx("div",{className:`toast-notification ${K.type}`,children:K.message})]})})}function lh(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function k2(n,e){return[n,e].sort().join("_")}function $D(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Pr(),{isDark:l,toggleTheme:u}=ja(),d=Wn(),[p,g]=v.useState("buddies"),[y,w]=v.useState([]),[k,j]=v.useState([]),[O,q]=v.useState([]),[B,V]=v.useState(""),[ne,K]=v.useState([]),[le,ge]=v.useState([]),[Ie,Te]=v.useState(!0),[R,T]=v.useState(null),[A,L]=v.useState(null),D=v.useCallback((ee,P="info")=>{L({message:ee,type:P}),setTimeout(()=>L(null),3500)},[]);v.useEffect(()=>{!i&&(!n||!e)&&d("/")},[n,e,i,d]);const F=v.useCallback(async()=>{if(t){Te(!0);try{const ee=t.id,se=(await ws(Ht(pe,"clients"))).docs.map(rt=>({id:rt.id,...rt.data()}));ge(se);const Se=Object.fromEntries(se.map(rt=>[rt.id,rt])),Oe=await ws(Ns(Ht(pe,"buddies"),cs("user1","==",ee))),st=await ws(Ns(Ht(pe,"buddies"),cs("user2","==",ee))),Ue=new Set;[...Oe.docs,...st.docs].forEach(rt=>{const Wt=rt.data(),js=Wt.user1===ee?Wt.user2:Wt.user1;Ue.add(js)}),w(Array.from(Ue).map(rt=>Se[rt]).filter(Boolean));const gt=await ws(Ns(Ht(pe,"buddyRequests"),cs("toId","==",ee),cs("status","==","pending")));j(gt.docs.map(rt=>({reqId:rt.id,...rt.data(),fromClient:Se[rt.data().fromId]})).filter(rt=>rt.fromClient));const Tt=await ws(Ns(Ht(pe,"buddyRequests"),cs("fromId","==",ee),cs("status","==","pending")));q(Tt.docs.map(rt=>({reqId:rt.id,...rt.data(),toClient:Se[rt.data().toId]})).filter(rt=>rt.toClient))}catch(ee){console.error("Error fetching buddy data:",ee),D("Failed to load buddies","error")}finally{Te(!1)}}},[t,D]);v.useEffect(()=>{F()},[F]),v.useEffect(()=>{if(!B.trim()||!t){K([]);return}const ee=B.toLowerCase(),P=t.id,se=new Set(y.map(Ue=>Ue.id)),Se=new Set(O.map(Ue=>Ue.toId)),Oe=new Set(k.map(Ue=>Ue.fromId)),st=le.filter(Ue=>Ue.id===P||!Ue.name||!Ue.coreBuddyAccess&&Ue.clientType!=="core_buddy"?!1:Ue.name.toLowerCase().includes(ee)).map(Ue=>({...Ue,isBuddy:se.has(Ue.id),isPendingOut:Se.has(Ue.id),isPendingIn:Oe.has(Ue.id)})).slice(0,20);K(st)},[B,le,y,O,k,t]);const M=async(ee,P)=>{if(!(!t||ee===t.id))try{await pi(Ht(pe,"notifications"),{toId:ee,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:P,read:!1,createdAt:Wr()})}catch(se){console.error("Notification error:",se),se.code==="permission-denied"&&D("Notifications blocked  check Firestore rules","error")}},$e=async ee=>{T(ee);try{const P=`${t.id}_${ee}`;await Ds(He(pe,"buddyRequests",P),{fromId:t.id,toId:ee,status:"pending",createdAt:Wr()}),await M(ee,"buddy_request"),D("Buddy request sent!","success"),await F()}catch(P){console.error("Error sending request:",P),D("Failed to send request","error")}finally{T(null)}},bt=async ee=>{T(ee.reqId);try{const P=k2(ee.fromId,t.id);await Ds(He(pe,"buddies",P),{user1:[ee.fromId,t.id].sort()[0],user2:[ee.fromId,t.id].sort()[1],connectedAt:Wr()}),await vr(He(pe,"buddyRequests",ee.reqId)),await M(ee.fromId,"buddy_accept"),D("Buddy added!","success"),await F()}catch(P){console.error("Error accepting request:",P),D("Failed to accept","error")}finally{T(null)}},H=async ee=>{T(ee.reqId);try{await vr(He(pe,"buddyRequests",ee.reqId)),D("Request declined","info"),await F()}catch(P){console.error("Error declining:",P),D("Failed to decline","error")}finally{T(null)}},fe=async ee=>{T(ee.reqId);try{await vr(He(pe,"buddyRequests",ee.reqId)),D("Request cancelled","info"),await F()}catch(P){console.error("Error cancelling:",P),D("Failed to cancel","error")}finally{T(null)}},Me=async ee=>{T(ee);try{const P=k2(t.id,ee);await vr(He(pe,"buddies",P)),D("Buddy removed","info"),await F()}catch(P){console.error("Error removing buddy:",P),D("Failed to remove buddy","error")}finally{T(null)}},Ke=k.length;return i?a.jsx("div",{className:"bdy-loading",children:a.jsx("div",{className:"bdy-spinner"})}):!n||!e||!t?null:a.jsxs("div",{className:"bdy-page","data-theme":l?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"bdy-main",children:[a.jsx("h1",{className:"bdy-title",children:"Buddies"}),a.jsxs("button",{className:"bdy-leaderboard-link",onClick:()=>d("/client/leaderboard"),children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C7 4 7 7 7 7"}),a.jsx("path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5C17 4 17 7 17 7"}),a.jsx("rect",{x:"6",y:"9",width:"12",height:"13",rx:"2"}),a.jsx("path",{d:"M12 9v13"}),a.jsx("path",{d:"M2 22h20"})]}),a.jsx("span",{children:"Leaderboard"}),a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"bdy-tabs",children:[a.jsxs("button",{className:`bdy-tab${p==="buddies"?" active":""}`,onClick:()=>g("buddies"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("span",{children:"My Buddies"})]}),a.jsxs("button",{className:`bdy-tab${p==="requests"?" active":""}`,onClick:()=>g("requests"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("line",{x1:"19",y1:"8",x2:"19",y2:"14"}),a.jsx("line",{x1:"22",y1:"11",x2:"16",y2:"11"})]}),a.jsx("span",{children:"Requests"}),Ke>0&&a.jsx("span",{className:"bdy-tab-badge",children:Ke})]}),a.jsxs("button",{className:`bdy-tab${p==="search"?" active":""}`,onClick:()=>g("search"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("span",{children:"Find"})]})]}),Ie?a.jsx("div",{className:"bdy-content-loading",children:a.jsx("div",{className:"bdy-spinner"})}):a.jsxs(a.Fragment,{children:[p==="buddies"&&a.jsx("div",{className:"bdy-section",children:y.length===0?a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("h3",{children:"No buddies yet"}),a.jsx("p",{children:"Find members and send buddy requests to connect!"}),a.jsx("button",{className:"bdy-empty-btn",onClick:()=>g("search"),children:"Find Buddies"})]}):a.jsx("div",{className:"bdy-list",children:y.map(ee=>a.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${ee.id}`),children:[a.jsx("div",{className:"bdy-avatar",children:ee.photoURL?a.jsx("img",{src:ee.photoURL,alt:ee.name}):a.jsx("span",{children:lh(ee.name)})}),a.jsx("div",{className:"bdy-card-info",children:a.jsx("span",{className:"bdy-card-name",children:ee.name})}),a.jsx("button",{className:"bdy-remove-btn",onClick:P=>{P.stopPropagation(),Me(ee.id)},disabled:R===ee.id,"aria-label":"Remove buddy",children:R===ee.id?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},ee.id))})}),p==="requests"&&a.jsxs("div",{className:"bdy-section",children:[k.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"bdy-section-title",children:"Incoming"}),a.jsx("div",{className:"bdy-list",children:k.map(ee=>a.jsxs("div",{className:"bdy-card",children:[a.jsx("div",{className:"bdy-avatar",children:ee.fromClient.photoURL?a.jsx("img",{src:ee.fromClient.photoURL,alt:ee.fromClient.name}):a.jsx("span",{children:lh(ee.fromClient.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:ee.fromClient.name}),a.jsx("span",{className:"bdy-card-sub",children:"wants to be your buddy"})]}),a.jsxs("div",{className:"bdy-action-pair",children:[a.jsx("button",{className:"bdy-accept-btn",onClick:()=>bt(ee),disabled:R===ee.reqId,children:R===ee.reqId?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}),a.jsx("button",{className:"bdy-decline-btn",onClick:()=>H(ee),disabled:R===ee.reqId,children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]},ee.reqId))})]}),O.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"bdy-section-title",children:"Sent"}),a.jsx("div",{className:"bdy-list",children:O.map(ee=>a.jsxs("div",{className:"bdy-card",children:[a.jsx("div",{className:"bdy-avatar",children:ee.toClient?.photoURL?a.jsx("img",{src:ee.toClient.photoURL,alt:ee.toClient.name}):a.jsx("span",{children:lh(ee.toClient?.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:ee.toClient?.name}),a.jsx("span",{className:"bdy-card-sub",children:"pending"})]}),a.jsx("button",{className:"bdy-cancel-btn",onClick:()=>fe(ee),disabled:R===ee.reqId,children:R===ee.reqId?a.jsx("div",{className:"bdy-btn-spinner"}):"Cancel"})]},ee.reqId))})]}),k.length===0&&O.length===0&&a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),a.jsx("h3",{children:"No pending requests"}),a.jsx("p",{children:"All caught up!"})]})]}),p==="search"&&a.jsxs("div",{className:"bdy-section",children:[a.jsxs("div",{className:"bdy-search-bar",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("input",{type:"text",placeholder:"Search by name...",value:B,onChange:ee=>V(ee.target.value),autoFocus:!0}),B&&a.jsx("button",{className:"bdy-search-clear",onClick:()=>V(""),children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),B.trim()&&ne.length===0&&a.jsx("div",{className:"bdy-empty bdy-empty-sm",children:a.jsxs("p",{children:['No members found for "',B,'"']})}),ne.length>0&&a.jsx("div",{className:"bdy-list",children:ne.map(ee=>a.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${ee.id}`),children:[a.jsx("div",{className:"bdy-avatar",children:ee.photoURL?a.jsx("img",{src:ee.photoURL,alt:ee.name}):a.jsx("span",{children:lh(ee.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:ee.name}),ee.isBuddy&&a.jsx("span",{className:"bdy-card-badge",children:"Buddy"})]}),ee.isBuddy?a.jsx("span",{className:"bdy-status-icon",children:a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-success)",strokeWidth:"2.5",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}):ee.isPendingOut?a.jsx("span",{className:"bdy-pending-label",children:"Pending"}):ee.isPendingIn?a.jsx("button",{className:"bdy-accept-btn",onClick:P=>{P.stopPropagation();const se=k.find(Se=>Se.fromId===ee.id);se&&bt(se)},disabled:!!R,children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}):a.jsx("button",{className:"bdy-add-btn",onClick:P=>{P.stopPropagation(),$e(ee.id)},disabled:R===ee.id,children:R===ee.id?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]},ee.id))})]})]})]}),a.jsx(la,{}),A&&a.jsxs("div",{className:`toast-notification ${A.type}`,children:[a.jsx("span",{className:"toast-icon",children:A.type==="success"?a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M5 13 L9 17 L19 7"})}):A.type==="error"?a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),a.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),a.jsx("span",{className:"toast-message",children:A.message})]})]})}function ch(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function Qp(n,e){return[n,e].sort().join("_")}const WD=5;function Xp(n){return n.toISOString().split("T")[0]}function GD(n){return n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}T`:`${Math.round(n)}`}const KD={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}};function j2(n){if(!n)return"";const e=n instanceof Date?n:n.toDate?n.toDate():new Date(n),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function YD(){const{userId:n}=rE(),{currentUser:e,isClient:t,clientData:i,loading:l}=Pr(),{isDark:u,toggleTheme:d}=ja(),p=Wn(),[g,y]=v.useState(null),[w,k]=v.useState("none"),[j,O]=v.useState(null),[q,B]=v.useState(!0),[V,ne]=v.useState(!1),[K,le]=v.useState(null),[ge,Ie]=v.useState([]),[Te,R]=v.useState(!1),[T,A]=v.useState(new Set),[L,D]=v.useState(new Set),[F,M]=v.useState({}),[$e,bt]=v.useState({}),[H,fe]=v.useState({}),[Me,Ke]=v.useState(!0),[ee,P]=v.useState(0),[se,Se]=v.useState(0),[Oe,st]=v.useState(0),[Ue,gt]=v.useState(0),[Tt,rt]=v.useState([]),[Wt,js]=v.useState([]),[At,Ee]=v.useState(null),[Z,mt]=v.useState(null),[pt,Je]=v.useState(0),[ut,tt]=v.useState([]),[Ze,Pt]=v.useState(!1),[Ks,Ct]=v.useState(null),[as,on]=v.useState([]),qt=v.useCallback((Q,ve="info")=>{le({message:Q,type:ve}),setTimeout(()=>le(null),3500)},[]);v.useEffect(()=>{!l&&(!e||!t)&&p("/")},[e,t,l,p]),v.useEffect(()=>{i&&n&&i.id===n&&p("/client/core-buddy",{replace:!0})},[i,n,p]),v.useEffect(()=>{if(!i||!n||i.id===n)return;let Q=!1;return(async()=>{B(!0);try{const It=(await ws(Ht(pe,"clients"))).docs.map(zt=>({id:zt.id,...zt.data()})).find(zt=>zt.id===n);if(!It){Q||B(!1);return}Q||y(It);const St=i.id,ts=Qp(St,n);if((await Ss(He(pe,"buddies",ts))).exists())Q||k("buddy");else{const zt=`${St}_${n}`,Rs=await Ss(He(pe,"buddyRequests",zt));if(Rs.exists()&&Rs.data().status==="pending")Q||(k("pending_out"),O(zt));else{const tn=`${n}_${St}`,rs=await Ss(He(pe,"buddyRequests",tn));rs.exists()&&rs.data().status==="pending"?Q||(k("pending_in"),O(tn)):Q||k("none")}}}catch(ve){console.error("Error loading profile:",ve)}finally{Q||B(!1)}})(),()=>{Q=!0}},[i,n]),v.useEffect(()=>{if(!n||!g)return;let Q=!1;return(async()=>{Ke(!0);try{const[ve,at,It,St]=await Promise.all([ws(Ns(Ht(pe,"workoutLogs"),cs("clientId","==",n))),Ss(He(pe,"coreBuddyAchievements",n)),Ss(He(pe,"coreBuddyPBs",n)),Ss(He(pe,"clientProgrammes",n))]);if(Q)return;const ts=ve.docs.length;P(ts),at.exists()&&Se(at.data().totalVolume||0);let Xt=0;const zt=ve.docs.map(rs=>rs.data().date).filter(Boolean).sort().reverse();if(zt.length>0){const rs=new Date;let Ts=new Date(rs);for(let As=0;As<52;As++){const z=new Date(Ts),ye=z.getDay(),we=ye===0?6:ye-1;z.setDate(z.getDate()-we),z.setHours(0,0,0,0);const _e=new Date(z);_e.setDate(_e.getDate()+7);const be=Xp(z),it=Xp(_e);if(zt.some(ct=>ct>=be&&ct<it))Xt++;else{if(As>0)break;break}Ts.setDate(Ts.getDate()-7)}}if(Q||st(Xt),It.exists()){const rs=It.data().exercises||{},Ts=Object.entries(rs).sort(([,As],[,z])=>(z.weight||0)-(As.weight||0)).slice(0,3).map(([As,z])=>({name:As,weight:z.weight,reps:z.reps}));Q||rt(Ts)}if(St.exists()){const rs=St.data(),Ts=KD[rs.templateId];if(Ts){const As=Object.keys(rs.completedSessions||{}).length,z=Ts.duration*Ts.daysPerWeek;Q||(mt(rs.templateId.replace(/_/g," ").replace(/\b\w/g,ye=>ye.toUpperCase())),Je(z>0?Math.round(As/z*100):0))}}const Rs=await Ss(He(pe,"achievements",n));if(!Q&&Rs.exists()){const rs=Rs.data().badges||{};js(Object.keys(rs))}let tn=0;for(let rs=0;rs<30;rs++){const Ts=new Date;Ts.setDate(Ts.getDate()-rs);const As=Xp(Ts);try{const z=await ws(Ns(Ht(pe,"habitLogs"),cs("clientId","==",n),cs("date","==",As)));if(z.empty)break;{const ye=z.docs[0].data().habits||{};if(Object.values(ye).filter(Boolean).length>=WD)tn++;else break}}catch{break}}Q||gt(tn)}catch(ve){console.error("Error loading buddy stats:",ve)}finally{Q||Ke(!1)}})(),()=>{Q=!0}},[n,g]),v.useEffect(()=>{if(!i)return;const Q=i.id;(async()=>{try{const[ve,at,It]=await Promise.all([ws(Ns(Ht(pe,"buddies"),cs("user1","==",Q))),ws(Ns(Ht(pe,"buddies"),cs("user2","==",Q))),ws(Ht(pe,"clients"))]),St=new Set;[...ve.docs,...at.docs].forEach(Xt=>{const zt=Xt.data();St.add(zt.user1===Q?zt.user2:zt.user1)});const ts={};It.docs.forEach(Xt=>{ts[Xt.id]=Xt.data()}),tt(Array.from(St).filter(Xt=>ts[Xt]).map(Xt=>({id:Xt,name:ts[Xt].name,photoURL:ts[Xt].photoURL||null})))}catch(ve){console.error("Error loading buddies for mentions:",ve)}})()},[i]);const Cs=async(Q,ve,at={})=>{if(!(!i||Q===i.id))try{await pi(Ht(pe,"notifications"),{toId:Q,fromId:i.id,fromName:i.name||"Someone",fromPhotoURL:i.photoURL||null,type:ve,read:!1,createdAt:Wr(),...at})}catch(It){console.error("Notification error:",It),It.code==="permission-denied"&&qt("Notifications blocked  check Firestore rules","error")}},ns=async()=>{ne(!0);try{const Q=`${i.id}_${n}`;await Ds(He(pe,"buddyRequests",Q),{fromId:i.id,toId:n,status:"pending",createdAt:Wr()}),await Cs(n,"buddy_request"),k("pending_out"),O(Q),qt("Buddy request sent!","success")}catch(Q){console.error(Q),qt("Failed to send request","error")}finally{ne(!1)}},_s=async()=>{if(j){ne(!0);try{const Q=Qp(i.id,n);await Ds(He(pe,"buddies",Q),{user1:[i.id,n].sort()[0],user2:[i.id,n].sort()[1],connectedAt:Wr()}),await vr(He(pe,"buddyRequests",j)),await Cs(n,"buddy_accept"),k("buddy"),qt("Buddy added!","success")}catch(Q){console.error(Q),qt("Failed to accept","error")}finally{ne(!1)}}},he=async()=>{if(j){ne(!0);try{await vr(He(pe,"buddyRequests",j)),k("none"),qt(w==="pending_out"?"Request cancelled":"Request declined","info")}catch(Q){console.error(Q),qt("Failed","error")}finally{ne(!1)}}},Re=async()=>{ne(!0);try{const Q=Qp(i.id,n);await vr(He(pe,"buddies",Q)),k("none"),qt("Buddy removed","info")}catch(Q){console.error(Q),qt("Failed to remove","error")}finally{ne(!1)}},ze=v.useCallback(async()=>{if(n){R(!0);try{const Q=await ws(Ns(Ht(pe,"posts"),cs("authorId","==",n),$h("createdAt","desc"),Wh(30)));if(Ie(Q.docs.map(ve=>({id:ve.id,...ve.data()}))),i){const ve=await ws(Ns(Ht(pe,"postLikes"),cs("userId","==",i.id)));A(new Set(ve.docs.map(at=>at.data().postId)))}}catch(Q){console.error("Error loading journey:",Q)}finally{R(!1)}}},[n,i]);v.useEffect(()=>{!q&&g&&ze()},[q,g,ze]);const Ye=async Q=>{if(window.confirm("Delete this post?"))try{await vr(He(pe,"posts",Q)),Ie(ve=>ve.filter(at=>at.id!==Q)),qt("Post deleted","info")}catch(ve){console.error("Delete error:",ve),qt("Failed to delete","error")}},Ve=async Q=>{if(!i)return;const ve=i.id,at=`${Q}_${ve}`,It=T.has(Q),St=new Set(T);It?St.delete(Q):St.add(Q),A(St),Ie(ts=>ts.map(Xt=>Xt.id===Q?{...Xt,likeCount:Math.max(0,(Xt.likeCount||0)+(It?-1:1))}:Xt));try{if(It)await vr(He(pe,"postLikes",at)),await La(He(pe,"posts",Q),{likeCount:qo(-1)});else{await Ds(He(pe,"postLikes",at),{postId:Q,userId:ve,createdAt:Wr()}),await La(He(pe,"posts",Q),{likeCount:qo(1)});const ts=ge.find(Xt=>Xt.id===Q);ts&&Cs(ts.authorId,"like",{postId:Q})}}catch(ts){console.error("Like error:",ts),ze()}},Le=async Q=>{try{const ve=await ws(Ns(Ht(pe,"postComments"),cs("postId","==",Q),$h("createdAt","asc"),Wh(50)));M(at=>({...at,[Q]:ve.docs.map(It=>({id:It.id,...It.data()}))}))}catch(ve){console.error("Error loading comments:",ve)}},De=Q=>{const ve=new Set(L);ve.has(Q)?ve.delete(Q):(ve.add(Q),F[Q]||Le(Q)),D(ve)},wt=(Q,ve)=>{const at=Q.match(/@(\w*)$/);if(at){Pt(!0),Ct(ve);const It=ut.filter(St=>St.name&&St.name.toLowerCase().includes(at[1].toLowerCase())).slice(0,5);on(It)}else Pt(!1),on([])},ft=(Q,ve)=>{const It=($e[ve]||"").replace(/@\w*$/,`@${Q.name} `);bt(St=>({...St,[ve]:It})),Pt(!1),on([])},Ut=(Q,ve)=>{bt(at=>({...at,[Q]:ve})),wt(ve,Q)},Gt=async Q=>{const ve=($e[Q]||"").trim();if(!(!ve||!i)){fe(at=>({...at,[Q]:!0}));try{await pi(Ht(pe,"postComments"),{postId:Q,authorId:i.id,authorName:i.name||"Unknown",authorPhotoURL:i.photoURL||null,content:ve,createdAt:Wr()}),await La(He(pe,"posts",Q),{commentCount:qo(1)});const at=ge.find(St=>St.id===Q);at&&Cs(at.authorId,"comment",{postId:Q});const It=ve.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(It){const St=new Set;It.forEach(ts=>{const Xt=ts.slice(1).trim(),zt=ut.find(Rs=>Rs.name&&Rs.name.toLowerCase()===Xt.toLowerCase());zt&&!St.has(zt.id)&&(St.add(zt.id),Cs(zt.id,"mention",{postId:Q}))})}bt(St=>({...St,[Q]:""})),Ie(St=>St.map(ts=>ts.id===Q?{...ts,commentCount:(ts.commentCount||0)+1}:ts)),await Le(Q)}catch(at){console.error("Comment error:",at),qt("Failed to comment","error")}finally{fe(at=>({...at,[Q]:!1}))}}};return l||q||!i?a.jsx("div",{className:"prf-loading","data-theme":u?"dark":"light",children:a.jsx("div",{className:"prf-spinner"})}):!e||!t?null:g?a.jsx(Ku,{children:a.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:u?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"prf-main",children:[a.jsxs("div",{className:"prf-hero",children:[a.jsx("div",{className:"prf-avatar-lg",children:g.photoURL?a.jsx("img",{src:g.photoURL,alt:g.name}):a.jsx("span",{children:ch(g.name)})}),a.jsx("h1",{className:"prf-name",children:g.name}),a.jsxs("div",{className:"prf-buddy-action",children:[w==="none"&&a.jsx("button",{className:"prf-btn prf-btn-primary",onClick:ns,disabled:V,children:V?a.jsx("div",{className:"prf-btn-spinner"}):a.jsxs(a.Fragment,{children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Buddy"]})}),w==="pending_out"&&a.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:he,disabled:V,children:V?a.jsx("div",{className:"prf-btn-spinner dark"}):"Cancel Request"}),w==="pending_in"&&a.jsxs("div",{className:"prf-btn-pair",children:[a.jsx("button",{className:"prf-btn prf-btn-success",onClick:_s,disabled:V,children:V?a.jsx("div",{className:"prf-btn-spinner"}):"Accept"}),a.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:he,disabled:V,children:"Decline"})]}),w==="buddy"&&a.jsx("button",{className:"prf-btn prf-btn-danger",onClick:Re,disabled:V,children:V?a.jsx("div",{className:"prf-btn-spinner"}):"Remove Buddy"})]})]}),Me?a.jsx("div",{className:"prf-stats-loading",children:a.jsx("div",{className:"prf-spinner"})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"prf-stats",children:[a.jsxs("div",{className:"prf-stat",children:[a.jsx("span",{className:"prf-stat-value",children:ee}),a.jsx("span",{className:"prf-stat-label",children:"Workouts"})]}),a.jsxs("div",{className:"prf-stat",children:[a.jsxs("span",{className:"prf-stat-value",children:[GD(se),a.jsx("span",{className:"prf-stat-unit",children:se>=1e3?"":"kg"})]}),a.jsxs("span",{className:"prf-stat-label",children:[se>=1e6?"Million kg":se>=1e3?"Tonnes":"Volume"," Lifted"]})]}),a.jsxs("div",{className:"prf-stat",children:[a.jsxs("span",{className:"prf-stat-value",children:[Oe,a.jsx("span",{className:"prf-stat-unit",children:"wk"})]}),a.jsx("span",{className:"prf-stat-label",children:"Streak"})]})]}),(Z||Ue>0)&&a.jsxs("div",{className:"prf-info-row",children:[Z&&a.jsxs("div",{className:"prf-info-card info-programme",children:[a.jsx("div",{className:"prf-info-icon",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"}),a.jsx("path",{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"})]})}),a.jsxs("div",{className:"prf-info-text",children:[a.jsx("span",{className:"prf-info-label",children:Z}),a.jsx("div",{className:"prf-info-progress-bar",children:a.jsx("div",{className:"prf-info-progress-fill",style:{width:`${Math.min(pt,100)}%`}})}),a.jsxs("span",{className:"prf-info-sub",children:[pt,"% complete"]})]})]}),Ue>0&&a.jsxs("div",{className:"prf-info-card info-habit",children:[a.jsx("div",{className:"prf-info-icon",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]})}),a.jsxs("div",{className:"prf-info-text",children:[a.jsxs("span",{className:"prf-info-value",children:[Ue," day",Ue!==1?"s":""]}),a.jsx("span",{className:"prf-info-sub",children:"Habit Streak"})]})]})]}),Tt.length>0&&a.jsxs("div",{className:"prf-section",children:[a.jsx("h2",{className:"prf-section-title",children:"Top Lifts"}),a.jsx("div",{className:"prf-pb-list",children:Tt.map((Q,ve)=>a.jsxs("div",{className:"prf-pb-item",children:[a.jsx("div",{className:"prf-pb-rank",children:ve===0?a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:a.jsx("path",{d:"M12 2l2.4 7.4H22l-6 4.4 2.3 7.2L12 16.6 5.7 21l2.3-7.2-6-4.4h7.6z"})}):`#${ve+1}`}),a.jsx("span",{className:"prf-pb-name",children:Q.name}),a.jsxs("span",{className:"prf-pb-weight",children:[Q.weight,a.jsx("span",{className:"prf-pb-unit",children:"kg"})," x",Q.reps]})]},ve))})]}),Wt.length>0&&a.jsxs("div",{className:"prf-section",children:[a.jsxs("h2",{className:"prf-section-title",children:["Badges Earned (",Wt.length,")"]}),a.jsx("div",{className:"prf-badge-row",children:Wt.map(Q=>{const ve=pu.find(at=>at.id===Q);return ve?a.jsx("button",{className:"prf-badge-chip",onClick:()=>Ee(ve),children:a.jsx("img",{src:ve.img,alt:ve.name,className:"prf-badge-chip-img"})},Q):null})})]}),At&&a.jsx("div",{className:"prf-badge-overlay",onClick:()=>Ee(null),children:a.jsxs("div",{className:"prf-badge-overlay-content",onClick:Q=>Q.stopPropagation(),children:[a.jsx("img",{src:At.img,alt:At.name,className:"prf-badge-overlay-img"}),a.jsx("p",{className:"prf-badge-overlay-desc",children:At.desc}),a.jsx("button",{className:"prf-badge-overlay-close",onClick:()=>Ee(null),children:"Tap to close"})]})})]}),a.jsxs("div",{className:"prf-section",children:[a.jsx("h2",{className:"prf-section-title",children:`${g.name?.split(" ")[0]}'s Journey`}),Te?a.jsx("div",{className:"journey-loading",children:a.jsx("div",{className:"prf-spinner"})}):ge.length===0?a.jsxs("div",{className:"journey-empty",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("p",{children:"No posts yet"})]}):a.jsx("div",{className:"journey-list",children:ge.map(Q=>a.jsxs("div",{className:"journey-post",children:[a.jsxs("div",{className:"journey-post-header",children:[a.jsx("div",{className:"journey-post-avatar",children:Q.authorPhotoURL?a.jsx("img",{src:Q.authorPhotoURL,alt:""}):a.jsx("span",{children:ch(Q.authorName)})}),a.jsxs("div",{className:"journey-post-meta",children:[a.jsx("span",{className:"journey-post-name",children:Q.authorName}),a.jsx("span",{className:"journey-post-time",children:j2(Q.createdAt)})]}),Q.authorId===i.id&&a.jsx("button",{className:"journey-delete-btn",onClick:()=>Ye(Q.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),Q.content&&a.jsx("p",{className:"journey-post-content",children:Q.content}),Q.imageURL&&a.jsx("div",{className:"journey-post-image",children:a.jsx("img",{src:Q.imageURL,alt:"Post",loading:"lazy"})}),a.jsxs("div",{className:"journey-post-actions",children:[a.jsxs("button",{className:`journey-action-btn${T.has(Q.id)?" liked":""}`,onClick:()=>Ve(Q.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:T.has(Q.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:Q.likeCount||0})]}),a.jsxs("button",{className:`journey-action-btn${L.has(Q.id)?" active":""}`,onClick:()=>De(Q.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:Q.commentCount||0})]})]}),L.has(Q.id)&&a.jsxs("div",{className:"journey-comments",children:[F[Q.id]?.length>0?F[Q.id].map(ve=>a.jsxs("div",{className:"journey-comment",children:[a.jsx("div",{className:"journey-comment-avatar",onClick:()=>p(`/client/core-buddy/profile/${ve.authorId}`),children:ve.authorPhotoURL?a.jsx("img",{src:ve.authorPhotoURL,alt:""}):a.jsx("span",{children:ch(ve.authorName)})}),a.jsxs("div",{className:"journey-comment-body",children:[a.jsxs("div",{className:"journey-comment-bubble",children:[a.jsx("span",{className:"journey-comment-name",children:ve.authorName}),a.jsx("span",{className:"journey-comment-text",children:ve.content})]}),a.jsx("span",{className:"journey-comment-time",children:j2(ve.createdAt)})]})]},ve.id)):a.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),a.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[a.jsx("input",{type:"text",placeholder:"Comment... (@ to mention)",value:$e[Q.id]||"",onChange:ve=>Ut(Q.id,ve.target.value),onKeyDown:ve=>{ve.key==="Enter"&&Gt(Q.id)},maxLength:300}),Ze&&Ks===Q.id&&as.length>0&&a.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:as.map(ve=>a.jsxs("button",{className:"mention-option",onClick:()=>ft(ve,Q.id),children:[a.jsx("div",{className:"mention-option-avatar",children:ve.photoURL?a.jsx("img",{src:ve.photoURL,alt:""}):a.jsx("span",{children:ch(ve.name)})}),a.jsx("span",{children:ve.name})]},ve.id))}),a.jsx("button",{onClick:()=>Gt(Q.id),disabled:!($e[Q.id]||"").trim()||H[Q.id],children:H[Q.id]?a.jsx("div",{className:"journey-btn-spinner-sm"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),a.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},Q.id))})]})]}),a.jsx(la,{}),K&&a.jsxs("div",{className:`toast-notification ${K.type}`,children:[a.jsx("span",{className:"toast-icon",children:K.type==="success"?a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M5 13 L9 17 L19 7"})}):K.type==="error"?a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),a.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),a.jsx("span",{className:"toast-message",children:K.message})]})]})}):a.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions"})]})}),a.jsx("main",{className:"prf-main",children:a.jsx("p",{style:{textAlign:"center",color:"var(--text-tertiary)",padding:"40px 0"},children:"User not found"})}),a.jsx(la,{})]})}function QD(){const n=Wn(),{clientData:e,currentUser:t,resolveClient:i,updateClientData:l}=Pr(),[u,d]=v.useState([]),[p,g]=v.useState(""),[y,w]=v.useState(!1),[k,j]=v.useState(null),[O,q]=v.useState(!1),[B,V]=v.useState(null),ne=v.useRef(null),K=v.useRef(null);if(!e?.buddyEnabled)return a.jsxs("div",{className:"buddy-page",children:[a.jsxs("div",{className:"buddy-container",children:[a.jsx("p",{children:"Buddy is not enabled on your account."}),a.jsx("button",{onClick:()=>n("/client/core-buddy"),children:"Back to Dashboard"})]}),a.jsx(la,{active:"home"})]});v.useEffect(()=>{ne.current&&ne.current.scrollIntoView({behavior:"smooth"})},[u,y]),v.useEffect(()=>{u.length===0&&!y&&le([])},[]);const le=async T=>{w(!0),j(null);try{const L=await(await fetch("/api/buddy-onboarding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:T,clientName:e?.name||t?.displayName||"there"})})).json();if(L.error){j(L.error);return}const D={role:"assistant",content:L.reply};d(F=>[...F,D]),L.profileData&&(await R(L.profileData),V(L.profileData),q(!0))}catch(A){console.error("Buddy chat error:",A),j("Something went wrong  try sending again.")}finally{w(!1)}},ge=()=>{const T=p.trim();if(!T||y)return;const A={role:"user",content:T},L=[...u,A];d(L),g(""),K.current&&K.current.focus(),le(L)},Ie=T=>{T.key==="Enter"&&!T.shiftKey&&(T.preventDefault(),ge())},Te=T=>{const A=T?.experience||"beginner";return A==="advanced"?{id:"fullbody_12wk",name:"12-Week Full Body",duration:12,level:"Advanced",daysPerWeek:3,description:"Complete transformation programme  push, pull, and legs over three phases."}:A==="intermediate"?{id:"fullbody_8wk",name:"8-Week Full Body",duration:8,level:"Intermediate",daysPerWeek:3,description:"Two-phase programme building strength and endurance across your full body."}:{id:"fullbody_4wk",name:"4-Week Full Body",duration:4,level:"All Levels",daysPerWeek:3,description:"Build total body strength with compound dumbbell movements and bodyweight finishers."}},R=async T=>{try{const A=await i();if(!A)return;await Ds(He(pe,"onboardingSubmissions",A.id),{clientId:A.id,clientName:A.name,email:A.email,source:"buddy_chat",welcome:{dob:T.dob||null,gender:T.gender||null,goals:T.goals||[],experience:T.experience||null,injuries:T.injuries||null,activityLevel:T.activityLevel||null,exerciseHistory:T.exerciseHistory||null,sleepHours:T.sleepHours||null,stressLevel:T.stressLevel||null,dietaryInfo:T.dietaryInfo||null,availability:T.availability||null,additionalInfo:T.additionalInfo||null},submittedAt:Wr()});const L=T.goals||[];await La(He(pe,"clients",A.id),{fitnessGoal:L[0]||null,fitnessGoals:L,experienceLevel:T.experience||null,dob:T.dob||null,injuries:T.injuries||null}),l({fitnessGoal:L[0]||null,fitnessGoals:L,experienceLevel:T.experience,dob:T.dob})}catch(A){console.error("Save profile error:",A)}};return a.jsxs("div",{className:"buddy-page buddy-page--chat",children:[a.jsxs("div",{className:"buddy-chat-container",children:[a.jsxs("div",{className:"buddy-chat-top",children:[a.jsx("button",{className:"buddy-back",onClick:()=>n("/client/core-buddy"),children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsxs("div",{className:"buddy-chat-header",children:[a.jsx("div",{className:"buddy-chat-avatar",children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 2a4 4 0 0 1 4 4v2a4 4 0 0 1-8 0V6a4 4 0 0 1 4-4z"}),a.jsx("path",{d:"M18 14c2 1 3 3 3 5v2H3v-2c0-2 1-4 3-5"}),a.jsx("circle",{cx:"9",cy:"7",r:"0.5",fill:"currentColor"}),a.jsx("circle",{cx:"15",cy:"7",r:"0.5",fill:"currentColor"}),a.jsx("path",{d:"M9.5 10a2.5 2.5 0 0 0 5 0"})]})}),a.jsxs("div",{children:[a.jsx("h2",{className:"buddy-chat-name",children:"Buddy"}),a.jsx("span",{className:"buddy-chat-status",children:y?"typing...":"Your AI Coach"})]})]})]}),a.jsxs("div",{className:"buddy-chat-messages",children:[u.map((T,A)=>a.jsxs("div",{className:`buddy-chat-bubble buddy-chat-${T.role}`,children:[T.role==="assistant"&&a.jsx("div",{className:"buddy-chat-bubble-avatar",children:"B"}),a.jsx("div",{className:"buddy-chat-bubble-content",children:T.content})]},A)),y&&a.jsxs("div",{className:"buddy-chat-bubble buddy-chat-assistant",children:[a.jsx("div",{className:"buddy-chat-bubble-avatar",children:"B"}),a.jsxs("div",{className:"buddy-chat-bubble-content buddy-chat-typing",children:[a.jsx("span",{}),a.jsx("span",{}),a.jsx("span",{})]})]}),k&&a.jsxs("div",{className:"buddy-chat-error",children:[k,a.jsx("button",{onClick:()=>le(u),children:"Retry"})]}),a.jsx("div",{ref:ne})]}),O?a.jsx("div",{className:"buddy-chat-done",children:B?(()=>{const T=Te(B);return a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"buddy-chat-done-text",children:"Profile saved! Here's my pick for you:"}),a.jsxs("div",{className:"buddy-rec-card",onClick:()=>n("/client/core-buddy/programmes",{state:{templateId:T.id}}),children:[a.jsx("div",{className:"buddy-rec-name",children:T.name}),a.jsxs("div",{className:"buddy-rec-meta",children:[T.duration," weeks  ",T.daysPerWeek," days/week  ",T.level]}),a.jsx("div",{className:"buddy-rec-desc",children:T.description}),a.jsx("div",{className:"buddy-rec-cta",children:"View Programme"})]}),a.jsx("button",{className:"buddy-chat-skip-btn",onClick:()=>n("/client/core-buddy"),children:"Maybe later"})]})})():a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"buddy-chat-done-text",children:"Profile saved  you're all set."}),a.jsx("button",{className:"buddy-chat-done-btn",onClick:()=>n("/client/core-buddy"),children:"Back to Dashboard"})]})}):a.jsxs("div",{className:"buddy-chat-input-wrap",children:[a.jsx("textarea",{ref:K,className:"buddy-chat-input",placeholder:"Type your message...",value:p,onChange:T=>g(T.target.value),onKeyDown:Ie,rows:1,disabled:y}),a.jsx("button",{className:"buddy-chat-send",onClick:ge,disabled:!p.trim()||y,"aria-label":"Send message",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),a.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]}),a.jsx(la,{active:"home"})]})}const pa=[{key:"pressUps",name:"Press-Ups",category:"Upper Body",unit:"reps"},{key:"squats",name:"Squats",category:"Lower Body",unit:"reps"},{key:"longJump",name:"Standing Long Jump",category:"Power",unit:"distance"},{key:"deadHang",name:"Dead Hang",category:"Upper Body",unit:"time"},{key:"plank",name:"Plank",category:"Core",unit:"time"},{key:"wallSit",name:"Wall Sit",category:"Lower Body",unit:"time"},{key:"chestPress",name:"Chest Press",category:"Upper Body",unit:"weight"}],Uo=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function XD(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}function ga(n){const[e,t]=n.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function JD(n){if(!n&&n!==0)return"-";const e=Math.floor(n/60),t=(n%60).toFixed(2);return e>0?`${e}m ${parseFloat(t).toFixed(0)}s`:`${parseFloat(t).toFixed(2)}s`}function ZD(n,e){return!n&&n!==0?"-":!e&&e!==0?`${n}kg`:`${n}kg x ${e}`}function uh(n,e){if(!e)return"-";switch(n.unit){case"weight":return ZD(e.weight,e.reps);case"time":return JD(e.time);case"reps":return e.reps?`${e.reps} reps`:"-";case"distance":return e.distance?`${e.distance} cm`:"-";default:return"-"}}function Vl(n,e){if(!e)return 0;switch(n.unit){case"weight":return(e.weight||0)*(e.reps||0);case"time":return e.time||0;case"reps":return e.reps||0;case"distance":return e.distance||0;default:return 0}}function Jp(n,e){return!e||e===0?null:(n-e)/e*100}function e6({data:n,exerciseKey:e,unit:t}){if(!n||n.length<2)return a.jsx("div",{className:"pb-trend-empty",children:a.jsx("p",{children:"Not enough data for trend line yet"})});const i=n.map(B=>{const V=B.benchmarks?.[e];if(!V)return 0;switch(t){case"weight":return(V.weight||0)*(V.reps||0);case"time":return V.time||0;case"reps":return V.reps||0;case"distance":return V.distance||0;default:return 0}}),l=Math.max(...i),u=Math.min(...i),d=l-u||1,p=300,g=100,y=20,w=p-y*2,k=g-y*2,j=i.map((B,V)=>{const ne=y+V/(i.length-1)*w,K=y+k-(B-u)/d*k;return{x:ne,y:K,value:B}}),O=j.map((B,V)=>`${V===0?"M":"L"} ${B.x} ${B.y}`).join(" "),q=O+` L ${j[j.length-1].x} ${y+k} L ${j[0].x} ${y+k} Z`;return a.jsxs("div",{className:"pb-trend-chart",children:[a.jsxs("svg",{viewBox:`0 0 ${p} ${g}`,preserveAspectRatio:"xMidYMid meet",children:[a.jsx("defs",{children:a.jsxs("linearGradient",{id:"trendGradientJr",x1:"0",y1:"0",x2:"0",y2:"1",children:[a.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),a.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),a.jsx("path",{d:q,fill:"url(#trendGradientJr)"}),a.jsx("path",{d:O,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),j.map((B,V)=>a.jsx("circle",{cx:B.x,cy:B.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},V))]}),a.jsx("div",{className:"pb-trend-labels",children:n.map((B,V)=>a.jsxs("span",{className:"pb-trend-label",children:[B.month.split("-")[1],"/",B.month.split("-")[0].slice(2)]},V))})]})}function t6(){const[n,e]=v.useState("bests"),[t,i]=v.useState([]),[l,u]=v.useState(!0),[d,p]=v.useState(!1),[g,y]=v.useState(0),[w,k]=v.useState(!1),[j,O]=v.useState(!1),[q,B]=v.useState(!1),[V,ne]=v.useState({}),[K,le]=v.useState({}),[ge,Ie]=v.useState({}),[Te,R]=v.useState({}),[T,A]=v.useState({}),[L,D]=v.useState(!1),[F,M]=v.useState({}),[$e,bt]=v.useState([]),[H,fe]=v.useState(null),[Me,Ke]=v.useState(null),[ee,P]=v.useState(!1),[se,Se]=v.useState(""),[Oe,st]=v.useState(""),Ue=v.useRef(null),gt=v.useRef(0),Tt=v.useRef(0),rt=v.useRef("right"),Wt=v.useCallback(z=>{y(ye=>{const we=Math.max(0,Math.min(pa.length-1,z));return we===ye?ye:(rt.current=we>ye?"right":"left",we)})},[]),{currentUser:js,isClient:At,clientData:Ee,loading:Z}=Pr(),{isDark:mt}=ja(),pt=Wn(),Je=v.useCallback((z,ye="info")=>{Ke({message:z,type:ye}),setTimeout(()=>Ke(null),4e3)},[]);v.useEffect(()=>{!Z&&(!js||!At)&&pt("/")},[js,At,Z,pt]),v.useEffect(()=>{Ee&&ut()},[Ee]);const ut=async()=>{try{const z=Ns(Ht(pe,"juniorPBs"),cs("clientId","==",Ee.id)),we=(await ws(z)).docs.map(ct=>({id:ct.id,...ct.data()}));we.sort((ct,_t)=>ct.month.localeCompare(_t.month)),i(we);const _e=Ns(Ht(pe,"juniorPBTargets"),cs("clientId","==",Ee.id)),be=await ws(_e);if(!be.empty){const ct=be.docs[0].data();Ie(ct.targets||{}),R(ct.metricTargets||{}),A(ct.targets||{}),M(ct.metricTargets||{})}const it=Ns(Ht(pe,"juniorAchievements"),cs("clientId","==",Ee.id)),Rt=await ws(it);Rt.empty||bt(Rt.docs[0].data().badges||[])}catch(z){console.error("Error fetching junior personal bests:",z)}u(!1)},tt=XD(),Ze=t.find(z=>z.month===tt),Pt=t.filter(z=>z.month<tt),Ks=Pt.length>0?Pt[Pt.length-1]:null;v.useEffect(()=>{Ze?(ne(Ze.benchmarks||{}),le(Ze.bodyMetrics||{})):(ne({}),le({}))},[Ze?.id]);const Ct=async(z,ye)=>{const we=[];if(z==="strength"?pa.forEach(_e=>{const be=ge[_e.key];if(!be)return;const it=ye[_e.key];if(!it)return;let Rt;if(be.targetType==="time"){if(!be.targetValue)return;const ct=be.startValue||0,_t=it.time||0,kt=be.targetValue-ct;Rt=kt===0?_t>=be.targetValue?1:0:Math.max(0,(_t-ct)/kt)}else if(be.targetType==="reps"){if(!be.targetReps)return;const ct=be.startReps||0,_t=it.reps||0,kt=be.targetReps-ct;Rt=kt===0?_t>=be.targetReps?1:0:Math.max(0,(_t-ct)/kt)}else if(be.targetType==="distance"){if(!be.targetDistance)return;const ct=be.startDistance||0,_t=it.distance||0,kt=be.targetDistance-ct;Rt=kt===0?_t>=be.targetDistance?1:0:Math.max(0,(_t-ct)/kt)}else{if(!be.targetWeight&&!be.targetReps)return;const ct=(be.startWeight||0)*(be.startReps||0),_t=(be.targetWeight||0)*(be.targetReps||0),kt=(it.weight||0)*(it.reps||0),us=_t-ct;Rt=us===0?kt>=_t?1:0:Math.max(0,(kt-ct)/us)}if(Rt>=1){let ct,_t;be.targetType==="time"?(ct=$e.some(kt=>kt.type==="strength"&&kt.key===_e.key&&kt.targetValue===be.targetValue),_t=`${_e.name} ${be.targetValue}s`):be.targetType==="reps"?(ct=$e.some(kt=>kt.type==="strength"&&kt.key===_e.key&&kt.targetReps===be.targetReps),_t=`${_e.name} ${be.targetReps} reps`):be.targetType==="distance"?(ct=$e.some(kt=>kt.type==="strength"&&kt.key===_e.key&&kt.targetDistance===be.targetDistance),_t=`${_e.name} ${be.targetDistance}cm`):(ct=$e.some(kt=>kt.type==="strength"&&kt.key===_e.key&&kt.targetWeight===be.targetWeight&&kt.targetReps===be.targetReps),_t=`${_e.name} ${be.targetWeight}kg  ${be.targetReps}`),ct||we.push({type:"strength",key:_e.key,...be.targetType==="time"?{targetType:"time",targetValue:be.targetValue}:be.targetType==="reps"?{targetType:"reps",targetReps:be.targetReps}:be.targetType==="distance"?{targetType:"distance",targetDistance:be.targetDistance}:{targetWeight:be.targetWeight,targetReps:be.targetReps},achievedMonth:tt,label:_t})}}):Uo.forEach(_e=>{const be=Te[_e.key];if(!be||!be.targetValue)return;const it=ye[_e.key];if(it==null)return;const Rt=be.startValue||0,ct=be.targetValue,_t=ct-Rt;(_t===0?it===ct?1:0:Math.max(0,(it-Rt)/_t))>=1&&($e.some(Cn=>Cn.type==="metric"&&Cn.key===_e.key&&Cn.targetValue===ct)||we.push({type:"metric",key:_e.key,targetValue:ct,achievedMonth:tt,label:`${_e.name} ${ct}${_e.suffix}`}))}),we.length>0){const _e=[...$e,...we];await Ds(He(pe,"juniorAchievements",Ee.id),{clientId:Ee.id,badges:_e,updatedAt:vt.now()}),bt(_e),fe(we),setTimeout(()=>fe(null),5e3)}},as=(z,ye)=>{if(z==="strength"){const we=ge[ye];if(!we)return!1;switch(pa.find(be=>be.key===ye)?.unit){case"time":return $e.some(be=>be.type==="strength"&&be.key===ye&&be.targetValue===we.targetValue);case"reps":return $e.some(be=>be.type==="strength"&&be.key===ye&&be.targetReps===we.targetReps);case"distance":return $e.some(be=>be.type==="strength"&&be.key===ye&&be.targetDistance===we.targetDistance);default:return!we.targetWeight&&!we.targetReps?!1:$e.some(be=>be.type==="strength"&&be.key===ye&&be.targetWeight===we.targetWeight&&be.targetReps===we.targetReps)}}else{const we=Te[ye];return!we||!we.targetValue?!1:$e.some(_e=>_e.type==="metric"&&_e.key===ye&&_e.targetValue===we.targetValue)}},on=async()=>{p(!0);try{const z=`${Ee.id}_${tt}`,ye=Ze||{};await Ds(He(pe,"juniorPBs",z),{clientId:Ee.id,month:tt,benchmarks:V,bodyMetrics:ye.bodyMetrics||K||{},createdAt:ye.createdAt||vt.now(),updatedAt:vt.now()}),await Ct("strength",V),Je("Benchmarks saved!","success"),k(!1),await ut()}catch(z){console.error("Error saving benchmarks:",z),Je("Failed to save. Please try again.","error")}p(!1)},qt=async()=>{p(!0);try{const z=`${Ee.id}_${tt}`,ye=Ze||{};await Ds(He(pe,"juniorPBs",z),{clientId:Ee.id,month:tt,benchmarks:ye.benchmarks||V||{},bodyMetrics:K,createdAt:ye.createdAt||vt.now(),updatedAt:vt.now()}),await Ct("metric",K),Je("Body metrics saved!","success"),O(!1),await ut()}catch(z){console.error("Error saving metrics:",z),Je("Failed to save. Please try again.","error")}p(!1)},Cs=(z,ye,we)=>{ne(_e=>({..._e,[z]:{..._e[z],[ye]:we===""?"":parseFloat(we)}}))},ns=(z,ye)=>{le(we=>({...we,[z]:ye===""?"":parseFloat(ye)}))},_s=(z,ye,we)=>{A(_e=>({..._e,[z]:{..._e[z],[ye]:we===""?"":parseFloat(we)}}))},he=async()=>{p(!0);try{const z=`targets_${Ee.id}`,ye=Ze?.benchmarks||{},we={};pa.forEach(_e=>{const be=ye[_e.key];switch(_e.unit){case"time":T[_e.key]?.targetValue&&(we[_e.key]={targetType:"time",targetValue:T[_e.key].targetValue,startValue:be?.time||0});break;case"reps":T[_e.key]?.targetReps&&(we[_e.key]={targetType:"reps",targetReps:T[_e.key].targetReps,startReps:be?.reps||0});break;case"distance":T[_e.key]?.targetDistance&&(we[_e.key]={targetType:"distance",targetDistance:T[_e.key].targetDistance,startDistance:be?.distance||0});break;default:(T[_e.key]?.targetWeight||T[_e.key]?.targetReps)&&(we[_e.key]={targetWeight:T[_e.key].targetWeight||0,targetReps:T[_e.key].targetReps||0,startWeight:be?.weight||0,startReps:be?.reps||0})}}),await Ds(He(pe,"juniorPBTargets",z),{clientId:Ee.id,targets:we,metricTargets:Te,updatedAt:vt.now()}),Ie(we),A(we),Je("Targets saved!","success"),B(!1)}catch(z){console.error("Error saving targets:",z),Je("Failed to save targets.","error")}p(!1)},Re=(z,ye)=>{M(we=>({...we,[z]:{...we[z],targetValue:ye===""?"":parseFloat(ye)}}))},ze=async()=>{p(!0);try{const z=`targets_${Ee.id}`,ye={};Uo.forEach(we=>{if(F[we.key]?.targetValue){const _e=Ze?.bodyMetrics?.[we.key]||0;ye[we.key]={targetValue:F[we.key].targetValue,startValue:_e}}}),await Ds(He(pe,"juniorPBTargets",z),{clientId:Ee.id,targets:ge,metricTargets:ye,updatedAt:vt.now()}),R(ye),M(ye),Je("Metric targets saved!","success"),D(!1)}catch(z){console.error("Error saving metric targets:",z),Je("Failed to save targets.","error")}p(!1)},Ye=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){p(!0);try{const z=He(pe,"juniorPBTargets",`targets_${Ee.id}`);await vr(z),Ie({}),R({}),A({}),M({}),Je("All goals have been reset","success")}catch(z){console.error("Error resetting targets:",z),Je("Failed to reset goals","error")}p(!1)}},Ve=(z,ye)=>{const we=ge[z];if(!we||!ye)return null;if(we.targetType==="time"){if(!we.targetValue)return null;const ct=we.startValue||0,_t=we.targetValue,kt=ye.time||0,us=_t-ct;return us<=0?kt>=_t?1:0:Math.max(0,Math.min((kt-ct)/us,1))}if(we.targetType==="reps"){if(!we.targetReps)return null;const ct=we.startReps||0,_t=we.targetReps,kt=ye.reps||0,us=_t-ct;return us<=0?kt>=_t?1:0:Math.max(0,Math.min((kt-ct)/us,1))}if(we.targetType==="distance"){if(!we.targetDistance)return null;const ct=we.startDistance||0,_t=we.targetDistance,kt=ye.distance||0,us=_t-ct;return us<=0?kt>=_t?1:0:Math.max(0,Math.min((kt-ct)/us,1))}if(!we.targetWeight&&!we.targetReps)return null;const _e=(we.startWeight||0)*(we.startReps||0),be=(we.targetWeight||0)*(we.targetReps||0),it=(ye.weight||0)*(ye.reps||0),Rt=be-_e;return Rt<=0?it>=be?1:0:Math.max(0,Math.min((it-_e)/Rt,1))},Le=z=>{const ye=Te[z];if(!ye||!ye.targetValue)return null;const we=Ze?.bodyMetrics?.[z];if(we==null)return null;const _e=ye.startValue||0,be=ye.targetValue,it=be-_e;return it===0?we===be?1:0:Math.max(0,Math.min((we-_e)/it,1))},De=z=>{gt.current=z.touches[0].clientX,Tt.current=0},wt=z=>{Tt.current=z.touches[0].clientX-gt.current},ft=()=>{Tt.current<-50?Wt(g+1):Tt.current>50&&Wt(g-1),Tt.current=0},Ut=z=>{const ye=Ze?.bodyMetrics?.[z],we=Ks?.bodyMetrics?.[z];return ye==null||we==null?null:parseFloat((ye-we).toFixed(2))},Gt=t.find(z=>z.month===se),Q=t.find(z=>z.month===Oe);if(Z||l)return a.jsxs("div",{className:"pb-page",children:[a.jsx("header",{className:"client-header",children:a.jsx("div",{className:"header-content",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),a.jsxs("main",{className:"pb-main",children:[a.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),a.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!js||!At||!Ee)return null;const ve=pa[g],at=Ze?.benchmarks?.[ve.key],It=Ks?.benchmarks?.[ve.key],St=Vl(ve,at),ts=Vl(ve,It),Xt=Jp(St,ts),zt=Ve(ve.key,at),Rs=zt!==null,tn=zt!==null&&zt>=1,rs=Rs?Math.round(zt*60):St>0?15:0,Ts=ge[ve.key],As=z=>z?z.targetType==="time"?`${z.startValue||0}s  ${z.targetValue}s`:z.targetType==="reps"?`${z.startReps||0}  ${z.targetReps} reps`:z.targetType==="distance"?`${z.startDistance||0}  ${z.targetDistance}cm`:`${z.startWeight||0}kg${z.startReps||0}  ${z.targetWeight}kg${z.targetReps}`:null;return a.jsxs("div",{className:"pb-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>pt("/client"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsxs("main",{className:"pb-main page-transition-enter",children:[a.jsxs("div",{className:"pb-intro",children:[a.jsx("h2",{children:"Junior Strength Tests"}),a.jsx("p",{children:"Track your strength test results and body measurements each month."})]}),a.jsxs("div",{className:"pb-tabs",children:[a.jsx("button",{className:`pb-tab ${n==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),a.jsx("button",{className:`pb-tab ${n==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),a.jsx("button",{className:`pb-tab ${n==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),n==="bests"&&a.jsxs("div",{className:"pb-strength-section",children:[!w&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"pb-carousel",ref:Ue,onTouchStart:De,onTouchMove:wt,onTouchEnd:ft,children:[a.jsx("div",{className:`pb-ring-container slide-from-${rt.current}`,children:a.jsxs("div",{className:"pb-ring",children:[a.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:Yy.map((z,ye)=>{const we=ye<Math.round(rs);return a.jsx("line",{x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,className:`pb-ring-tick ${we?tn?"hit":"filled":"empty"}`,strokeWidth:z.thick?"3":"2"},ye)})}),a.jsxs("div",{className:"pb-ring-center",children:[a.jsx("div",{className:"pb-ring-category",children:ve.category}),a.jsxs("div",{className:"pb-ring-exercise",children:[ve.name,as("strength",ve.key)&&a.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),a.jsx("div",{className:"pb-ring-value",children:at?uh(ve,at):"-"}),Xt!==null&&a.jsxs("div",{className:`pb-ring-change ${Xt>=0?"positive":"negative"}`,children:[Xt>=0?"+":"",Xt.toFixed(1),"%"]}),Xt===null&&at&&a.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),Ts&&a.jsx("div",{className:`pb-ring-target ${tn?"hit":""}`,children:tn?"Target hit!":As(Ts)}),!Ts&&a.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},g),a.jsx("div",{className:"pb-carousel-dots",children:pa.map((z,ye)=>a.jsx("button",{className:`pb-dot ${ye===g?"active":""}`,onClick:()=>Wt(ye)},ye))}),a.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>Wt(g-1),disabled:g===0,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),a.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>Wt(g+1),disabled:g===pa.length-1,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),a.jsxs("div",{className:"pb-trend-section",children:[a.jsx("h4",{children:"Trend"}),a.jsx(e6,{data:t,exerciseKey:ve.key,unit:ve.unit})]})]}),!w&&!q&&a.jsxs("div",{className:"pb-action-buttons",children:[a.jsx("button",{className:"pb-edit-btn",onClick:()=>k(!0),children:Ze?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),a.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>B(!0),children:Object.keys(ge).length>0?"Edit Targets":"Set Targets"}),(Object.keys(ge).length>0||Object.keys(Te).length>0)&&a.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:Ye,disabled:d,children:"Reset All Goals"})]}),w&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsxs("h3",{children:["Benchmarks - ",ga(tt)]}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{k(!1),ne(Ze?.benchmarks||{})},children:""})]}),a.jsx("div",{className:"pb-edit-body",children:pa.map(z=>a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:z.name}),z.unit==="weight"?a.jsxs("div",{className:"pb-edit-row",children:[a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",step:"0.5",value:V[z.key]?.weight??"",onChange:ye=>Cs(z.key,"weight",ye.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",value:V[z.key]?.reps??"",onChange:ye=>Cs(z.key,"reps",ye.target.value),placeholder:"0"})]})]}):z.unit==="reps"?a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Reps (max in 1 min)"}),a.jsx("input",{type:"number",value:V[z.key]?.reps??"",onChange:ye=>Cs(z.key,"reps",ye.target.value),placeholder:"0"})]})}):z.unit==="distance"?a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Distance (cm)"}),a.jsx("input",{type:"number",step:"0.5",value:V[z.key]?.distance??"",onChange:ye=>Cs(z.key,"distance",ye.target.value),placeholder:"0"})]})}):a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Time (seconds)"}),a.jsx("input",{type:"number",step:"0.01",value:V[z.key]?.time??"",onChange:ye=>Cs(z.key,"time",ye.target.value),placeholder:"0"})]})})]},z.key))}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{k(!1),ne(Ze?.benchmarks||{})},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:on,disabled:d,children:d?"Saving...":"Save"})]})]}),q&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsx("h3",{children:"Set Your Targets"}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{B(!1),A(ge)},children:""})]}),a.jsxs("div",{className:"pb-edit-body",children:[a.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),pa.map(z=>{const ye=Ze?.benchmarks?.[z.key];let we="-";if(ye)switch(z.unit){case"weight":(ye.weight||ye.reps)&&(we=`${ye.weight||0}kg  ${ye.reps||0}`);break;case"time":ye.time&&(we=`${ye.time}s`);break;case"reps":ye.reps&&(we=`${ye.reps} reps`);break;case"distance":ye.distance&&(we=`${ye.distance} cm`);break}return a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsxs("div",{className:"pb-edit-exercise-header",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:z.name}),a.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",we]})]}),z.unit==="weight"?a.jsxs("div",{className:"pb-edit-row",children:[a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Target Weight (kg)"}),a.jsx("input",{type:"number",step:"0.5",value:T[z.key]?.targetWeight??"",onChange:_e=>_s(z.key,"targetWeight",_e.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Target Reps"}),a.jsx("input",{type:"number",value:T[z.key]?.targetReps??"",onChange:_e=>_s(z.key,"targetReps",_e.target.value),placeholder:"0"})]})]}):z.unit==="reps"?a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Target Reps (in 1 min)"}),a.jsx("input",{type:"number",value:T[z.key]?.targetReps??"",onChange:_e=>_s(z.key,"targetReps",_e.target.value),placeholder:"0"})]})}):z.unit==="distance"?a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Target Distance (cm)"}),a.jsx("input",{type:"number",step:"0.5",value:T[z.key]?.targetDistance??"",onChange:_e=>_s(z.key,"targetDistance",_e.target.value),placeholder:"0"})]})}):a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Target (seconds)"}),a.jsx("input",{type:"number",step:"1",value:T[z.key]?.targetValue??"",onChange:_e=>_s(z.key,"targetValue",_e.target.value),placeholder:"0"})]})})]},z.key)})]}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{B(!1),A(ge)},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:he,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="metrics"&&a.jsxs("div",{className:"pb-metrics-section",children:[!j&&!L&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"pb-metrics-card",children:[a.jsx("h3",{children:"Body Measurements"}),a.jsx("p",{className:"pb-metrics-month",children:ga(tt)}),a.jsx("div",{className:"pb-metrics-list",children:Uo.map(z=>{const ye=Ze?.bodyMetrics?.[z.key],we=Ut(z.key),_e=Te[z.key],be=Le(z.key),it=be!==null&&be>=1;return a.jsxs("div",{className:"pb-metric-row",children:[a.jsxs("div",{className:"pb-metric-top",children:[a.jsxs("div",{className:"pb-metric-left",children:[a.jsxs("span",{className:"pb-metric-name",children:[z.name,as("metric",z.key)&&a.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),_e&&a.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",_e.targetValue," ",z.suffix]})]}),a.jsxs("div",{className:"pb-metric-values",children:[a.jsx("span",{className:"pb-metric-current",children:ye!=null?`${ye} ${z.suffix}`:"-"}),we!==null&&a.jsxs("span",{className:`pb-metric-change ${we>0?"up":we<0?"down":"same"}`,children:[we>0?"+":"",we," ",z.suffix]})]})]}),be!==null&&a.jsxs("div",{className:"pb-metric-progress",children:[a.jsx("div",{className:"pb-metric-bar",children:a.jsx("div",{className:`pb-metric-bar-fill ${it?"hit":""}`,style:{width:`${Math.round(be*100)}%`}})}),a.jsx("span",{className:`pb-metric-percent ${it?"hit":""}`,children:it?"Hit!":`${Math.round(be*100)}%`})]})]},z.key)})})]}),a.jsxs("div",{className:"pb-action-buttons",children:[a.jsx("button",{className:"pb-edit-btn",onClick:()=>O(!0),children:Ze?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),a.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>D(!0),children:Object.keys(Te).length>0?"Edit Targets":"Set Targets"}),(Object.keys(ge).length>0||Object.keys(Te).length>0)&&a.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:Ye,disabled:d,children:"Reset All Goals"})]})]}),j&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsxs("h3",{children:["Measurements - ",ga(tt)]}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{O(!1),le(Ze?.bodyMetrics||{})},children:""})]}),a.jsx("div",{className:"pb-edit-body",children:Uo.map(z=>a.jsx("div",{className:"pb-edit-metric",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsxs("label",{children:[z.name," (",z.suffix,")"]}),a.jsx("input",{type:"number",step:"0.1",value:K[z.key]??"",onChange:ye=>ns(z.key,ye.target.value),placeholder:"0"})]})},z.key))}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{O(!1),le(Ze?.bodyMetrics||{})},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:qt,disabled:d,children:d?"Saving...":"Save"})]})]}),L&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsx("h3",{children:"Body Metric Targets"}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{D(!1),M(Te)},children:""})]}),a.jsxs("div",{className:"pb-edit-body",children:[a.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),Uo.map(z=>{const ye=Ze?.bodyMetrics?.[z.key];return a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsxs("div",{className:"pb-edit-exercise-header",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:z.name}),a.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",ye!=null?`${ye} ${z.suffix}`:"-"]})]}),a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsxs("label",{children:["Target (",z.suffix,")"]}),a.jsx("input",{type:"number",step:"0.1",value:F[z.key]?.targetValue??"",onChange:we=>Re(z.key,we.target.value),placeholder:"0"})]})})]},z.key)})]}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{D(!1),M(Te)},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:ze,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="history"&&a.jsx("div",{className:"pb-history-section",children:t.length===0?a.jsxs("div",{className:"pb-empty",children:[a.jsx("h4",{children:"No records yet"}),a.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):a.jsxs(a.Fragment,{children:[$e.length>0&&a.jsxs("div",{className:"pb-achievements-wall",children:[a.jsxs("h4",{className:"pb-achievements-wall-title",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),a.jsx("div",{className:"pb-achievements-list",children:[...$e].reverse().map((z,ye)=>a.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${ye*.05}s`},children:[a.jsx("div",{className:"pb-achievement-star",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("div",{className:"pb-achievement-info",children:[a.jsx("span",{className:"pb-achievement-label",children:z.label}),a.jsx("span",{className:"pb-achievement-date",children:ga(z.achievedMonth)})]})]},ye))})]}),a.jsx("div",{className:"pb-history-controls",children:a.jsx("button",{className:`pb-compare-toggle ${ee?"active":""}`,onClick:()=>{P(!ee),!ee&&t.length>=2&&(Se(t[0].month),st(t[t.length-1].month))},children:ee?"Back to Timeline":"Compare Months"})}),ee?a.jsxs("div",{className:"pb-compare",children:[a.jsxs("div",{className:"pb-compare-selectors",children:[a.jsxs("div",{className:"pb-compare-select",children:[a.jsx("label",{children:"From"}),a.jsx("select",{value:se,onChange:z=>Se(z.target.value),children:t.map(z=>a.jsx("option",{value:z.month,children:ga(z.month)},z.month))})]}),a.jsx("div",{className:"pb-compare-vs",children:"vs"}),a.jsxs("div",{className:"pb-compare-select",children:[a.jsx("label",{children:"To"}),a.jsx("select",{value:Oe,onChange:z=>st(z.target.value),children:t.map(z=>a.jsx("option",{value:z.month,children:ga(z.month)},z.month))})]})]}),Gt&&Q&&a.jsxs("div",{className:"pb-compare-results",children:[a.jsxs("div",{className:"pb-compare-group",children:[a.jsx("h4",{children:"Strength Tests"}),a.jsxs("div",{className:"pb-compare-table",children:[a.jsxs("div",{className:"pb-compare-header-row",children:[a.jsx("span",{children:"Exercise"}),a.jsx("span",{children:ga(se).split(" ")[0]}),a.jsx("span",{children:ga(Oe).split(" ")[0]}),a.jsx("span",{children:"Change"})]}),pa.map(z=>{const ye=Gt.benchmarks?.[z.key],we=Q.benchmarks?.[z.key],_e=Vl(z,ye),be=Vl(z,we),it=Jp(be,_e);return a.jsxs("div",{className:"pb-compare-row",children:[a.jsx("span",{className:"pb-compare-name",children:z.name}),a.jsx("span",{className:"pb-compare-val",children:ye?uh(z,ye):"-"}),a.jsx("span",{className:"pb-compare-val",children:we?uh(z,we):"-"}),a.jsx("span",{className:`pb-compare-change ${it!==null?it>=0?"positive":"negative":""}`,children:it!==null?`${it>=0?"+":""}${it.toFixed(1)}%`:"-"})]},z.key)})]})]}),a.jsxs("div",{className:"pb-compare-group",children:[a.jsx("h4",{children:"Body Measurements"}),a.jsxs("div",{className:"pb-compare-table",children:[a.jsxs("div",{className:"pb-compare-header-row",children:[a.jsx("span",{children:"Measurement"}),a.jsx("span",{children:ga(se).split(" ")[0]}),a.jsx("span",{children:ga(Oe).split(" ")[0]}),a.jsx("span",{children:"Change"})]}),Uo.map(z=>{const ye=Gt.bodyMetrics?.[z.key],we=Q.bodyMetrics?.[z.key],_e=ye!=null&&we!=null?parseFloat((we-ye).toFixed(2)):null;return a.jsxs("div",{className:"pb-compare-row",children:[a.jsx("span",{className:"pb-compare-name",children:z.name}),a.jsx("span",{className:"pb-compare-val",children:ye!=null?`${ye}`:"-"}),a.jsx("span",{className:"pb-compare-val",children:we!=null?`${we}`:"-"}),a.jsx("span",{className:`pb-compare-change ${_e!==null?_e>0?"positive":_e<0?"negative":"neutral":""}`,children:_e!==null?`${_e>0?"+":""}${_e} ${z.suffix}`:"-"})]},z.key)})]})]})]})]}):a.jsx("div",{className:"pb-timeline",children:[...t].reverse().map((z,ye)=>{const we=t.filter(_e=>_e.month<z.month).pop();return a.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${ye*.05}s`},children:[a.jsx("div",{className:"pb-timeline-dot"}),a.jsxs("div",{className:"pb-timeline-card",children:[a.jsx("h4",{children:ga(z.month)}),z.benchmarks&&Object.keys(z.benchmarks).length>0&&a.jsxs("div",{className:"pb-timeline-group",children:[a.jsx("h5",{children:"Strength Tests"}),pa.map(_e=>{const be=z.benchmarks[_e.key];if(!be)return null;const it=we?.benchmarks?.[_e.key],Rt=Vl(_e,be),ct=Vl(_e,it),_t=Jp(Rt,ct);return a.jsxs("div",{className:"pb-timeline-row",children:[a.jsx("span",{className:"pb-timeline-label",children:_e.name}),a.jsxs("div",{className:"pb-timeline-values",children:[a.jsx("span",{className:"pb-timeline-value",children:uh(_e,be)}),_t!==null&&a.jsxs("span",{className:`pb-timeline-change ${_t>=0?"positive":"negative"}`,children:[_t>=0?"+":"",_t.toFixed(1),"%"]})]})]},_e.key)})]}),z.bodyMetrics&&Object.keys(z.bodyMetrics).length>0&&a.jsxs("div",{className:"pb-timeline-group",children:[a.jsx("h5",{children:"Body Measurements"}),Uo.map(_e=>{const be=z.bodyMetrics[_e.key];if(be==null)return null;const it=we?.bodyMetrics?.[_e.key],Rt=it!=null?parseFloat((be-it).toFixed(2)):null;return a.jsxs("div",{className:"pb-timeline-row",children:[a.jsx("span",{className:"pb-timeline-label",children:_e.name}),a.jsxs("div",{className:"pb-timeline-values",children:[a.jsxs("span",{className:"pb-timeline-value",children:[be," ",_e.suffix]}),Rt!==null&&a.jsxs("span",{className:`pb-timeline-change ${Rt>0?"positive":Rt<0?"negative":"neutral"}`,children:[Rt>0?"+":"",Rt," ",_e.suffix]})]})]},_e.key)})]})]})]},z.id)})})]})})]}),H&&a.jsx("div",{className:"pb-celebration-overlay",onClick:()=>fe(null),children:a.jsxs("div",{className:"pb-celebration-card",children:[a.jsx("div",{className:"pb-celebration-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsx("h3",{className:"pb-celebration-title",children:H.length===1?"Target Achieved!":`${H.length} Targets Achieved!`}),a.jsx("div",{className:"pb-celebration-badges",children:H.map((z,ye)=>a.jsx("div",{className:"pb-celebration-badge",children:z.label},ye))}),a.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),Me&&a.jsxs("div",{className:`toast-notification ${Me.type}`,children:[a.jsx("span",{className:"toast-icon",children:Me.type==="success"?a.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),a.jsx("span",{className:"toast-message",children:Me.message}),a.jsx("button",{className:"toast-close",onClick:()=>Ke(null),children:""})]}),a.jsxs("nav",{className:"block-bottom-nav",children:[a.jsxs("button",{className:"block-nav-tab",onClick:()=>pt("/client"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),a.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),a.jsx("span",{children:"Home"})]}),a.jsxs("button",{className:"block-nav-tab",onClick:()=>pt("/client/forms"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),a.jsx("span",{children:"Forms"})]}),a.jsxs("button",{className:"block-nav-tab",onClick:()=>pt("/client/tools"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),a.jsx("span",{children:"Tools"})]}),a.jsxs("button",{className:"block-nav-tab active",children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 20V10"}),a.jsx("path",{d:"M18 20V4"}),a.jsx("path",{d:"M6 20v-4"})]}),a.jsx("span",{children:"PBs"})]}),Ee?.circuitAccess&&a.jsxs("button",{className:"block-nav-tab",onClick:()=>pt("/client/circuit"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 6v6l4 2"})]}),a.jsx("span",{children:"Circuit"})]})]})]})}const Da=[{key:"chestPress",name:"Chest Press",category:"Upper Body - Push",unit:"weight"},{key:"shoulderPress",name:"Shoulder Press",category:"Upper Body - Push",unit:"weight"},{key:"seatedRow",name:"Seated Row",category:"Upper Body - Pull",unit:"weight"},{key:"latPulldown",name:"Lat Pulldown",category:"Upper Body - Pull",unit:"weight"},{key:"squat",name:"Squat",category:"Lower Body",unit:"weight"},{key:"deadlift",name:"Deadlift",category:"Lower Body",unit:"weight"},{key:"plank",name:"Plank",category:"Core",unit:"time"}],zo=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function s6(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}function ya(n){const[e,t]=n.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function dh(n){if(!n&&n!==0)return"-";const e=Math.floor(n/60),t=(n%60).toFixed(2);return e>0?`${e}m ${parseFloat(t).toFixed(0)}s`:`${parseFloat(t).toFixed(2)}s`}function T2(n,e){return!n&&n!==0?"-":!e&&e!==0?`${n}kg`:`${n}kg x ${e}`}function Bl(n,e){return e?n.unit==="time"?e.time||0:(e.weight||0)*(e.reps||0):0}function Zp(n,e){return!e||e===0?null:(n-e)/e*100}function n6({data:n,exerciseKey:e,unit:t}){if(!n||n.length<2)return a.jsx("div",{className:"pb-trend-empty",children:a.jsx("p",{children:"Not enough data for trend line yet"})});const i=n.map(B=>{const V=B.benchmarks?.[e];return V?t==="time"?V.time||0:(V.weight||0)*(V.reps||0):0}),l=Math.max(...i),u=Math.min(...i),d=l-u||1,p=300,g=100,y=20,w=p-y*2,k=g-y*2,j=i.map((B,V)=>{const ne=y+V/(i.length-1)*w,K=y+k-(B-u)/d*k;return{x:ne,y:K,value:B}}),O=j.map((B,V)=>`${V===0?"M":"L"} ${B.x} ${B.y}`).join(" "),q=O+` L ${j[j.length-1].x} ${y+k} L ${j[0].x} ${y+k} Z`;return a.jsxs("div",{className:"pb-trend-chart",children:[a.jsxs("svg",{viewBox:`0 0 ${p} ${g}`,preserveAspectRatio:"xMidYMid meet",children:[a.jsx("defs",{children:a.jsxs("linearGradient",{id:"trendGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[a.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),a.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),a.jsx("path",{d:q,fill:"url(#trendGradient)"}),a.jsx("path",{d:O,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),j.map((B,V)=>a.jsx("circle",{cx:B.x,cy:B.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},V))]}),a.jsx("div",{className:"pb-trend-labels",children:n.map((B,V)=>a.jsxs("span",{className:"pb-trend-label",children:[B.month.split("-")[1],"/",B.month.split("-")[0].slice(2)]},V))})]})}function r6(){const[n,e]=v.useState("bests"),[t,i]=v.useState([]),[l,u]=v.useState(!0),[d,p]=v.useState(!1),[g,y]=v.useState(0),[w,k]=v.useState(!1),[j,O]=v.useState(!1),[q,B]=v.useState(!1),[V,ne]=v.useState({}),[K,le]=v.useState({}),[ge,Ie]=v.useState({}),[Te,R]=v.useState({}),[T,A]=v.useState({}),[L,D]=v.useState(!1),[F,M]=v.useState({}),[$e,bt]=v.useState([]),[H,fe]=v.useState(null),[Me,Ke]=v.useState(null),[ee,P]=v.useState(!1),[se,Se]=v.useState(""),[Oe,st]=v.useState(""),[Ue,gt]=v.useState({}),[Tt,rt]=v.useState({}),[Wt,js]=v.useState(null),[At,Ee]=v.useState(null),[Z,mt]=v.useState(""),pt=v.useRef(null),Je=v.useRef(0),ut=v.useRef(0),tt=v.useRef("right"),Ze=v.useCallback($=>{y(ue=>{const E=Math.max(0,Math.min(Da.length-1,$));return E===ue?ue:(tt.current=E>ue?"right":"left",E)})},[]),{currentUser:Pt,isClient:Ks,clientData:Ct,loading:as}=Pr(),{isDark:on}=ja(),qt=Wn(),[Cs]=QE(),ns=Cs.get("mode")==="corebuddy",_s=!ns&&(!Ct?.clientType||Ct.clientType==="block"),he=v.useCallback(($,ue="info")=>{Ke({message:$,type:ue}),setTimeout(()=>Ke(null),4e3)},[]);v.useEffect(()=>{!as&&(!Pt||!Ks)&&qt("/")},[Pt,Ks,as,qt]),v.useEffect(()=>{Ct&&(_s?Re():(async()=>{try{const[ue,E,S]=await Promise.all([Ss(He(pe,"coreBuddyPBs",Ct.id)),Ss(He(pe,"coreBuddyTargets",Ct.id)),Ss(He(pe,"coreBuddyAchievements",Ct.id))]);ue.exists()&&gt(ue.data().exercises||{}),E.exists()&&rt(E.data().targets||{}),S.exists()&&js(S.data())}catch(ue){console.error("Error loading Core Buddy PBs:",ue)}u(!1)})())},[Ct]);const Re=async()=>{try{const $=Ns(Ht(pe,"personalBests"),cs("clientId","==",Ct.id)),E=(await ws($)).docs.map(qe=>({id:qe.id,...qe.data()}));E.sort((qe,Fe)=>qe.month.localeCompare(Fe.month)),i(E);const S=Ns(Ht(pe,"personalBestTargets"),cs("clientId","==",Ct.id)),G=await ws(S);if(!G.empty){const qe=G.docs[0].data();Ie(qe.targets||{}),R(qe.metricTargets||{}),A(qe.targets||{}),M(qe.metricTargets||{})}const ae=Ns(Ht(pe,"achievements"),cs("clientId","==",Ct.id)),Qe=await ws(ae);Qe.empty||bt(Qe.docs[0].data().badges||[])}catch($){console.error("Error fetching personal bests:",$)}u(!1)},ze=async()=>{if(!At||!Z||!Ct)return;const $=parseFloat(Z),ue=Ue[At];if(!ue||$<=ue.weight){he("Target must be higher than current PB","error");return}p(!0);try{const E={...Tt,[At]:{targetWeight:$,setAt:vt.now(),currentPBWhenSet:ue.weight}};await Ds(He(pe,"coreBuddyTargets",Ct.id),{clientId:Ct.id,targets:E,updatedAt:vt.now()}),rt(E),Ee(null),mt(""),he("Target set!","success")}catch(E){console.error("Error saving target:",E),he("Failed to save target","error")}p(!1)},Ye=$=>{if(!Wt?.badges)return!1;const ue=Tt[$];return ue?Wt.badges.some(E=>E.type==="pb_target"&&E.exercise===$&&E.targetWeight===ue.targetWeight):!1},Ve=$=>{const ue=Tt[$];if(!ue)return null;const E=Ue[$];if(!E)return 0;const S=ue.currentPBWhenSet||0,G=ue.targetWeight,ae=G-S;return ae<=0?E.weight>=G?1:0:Math.max(0,Math.min((E.weight-S)/ae,1))},Le=s6(),De=t.find($=>$.month===Le),wt=t.filter($=>$.month<Le),ft=wt.length>0?wt[wt.length-1]:null;v.useEffect(()=>{De?(ne(De.benchmarks||{}),le(De.bodyMetrics||{})):(ne({}),le({}))},[De?.id]);const Ut=async($,ue)=>{const E=[];if($==="strength"?Da.forEach(S=>{const G=ge[S.key];if(!G)return;const ae=ue[S.key];if(!ae)return;let Qe;if(G.targetType==="time"){if(!G.targetValue)return;const qe=G.startValue||0,Fe=ae.time||0,Lt=G.targetValue-qe;Qe=Lt===0?Fe>=G.targetValue?1:0:Math.max(0,(Fe-qe)/Lt)}else{if(!G.targetWeight&&!G.targetReps)return;const qe=(G.startWeight||0)*(G.startReps||0),Fe=(G.targetWeight||0)*(G.targetReps||0),Lt=(ae.weight||0)*(ae.reps||0),Mt=Fe-qe;Qe=Mt===0?Lt>=Fe?1:0:Math.max(0,(Lt-qe)/Mt)}if(Qe>=1&&!(G.targetType==="time"?$e.some(Fe=>Fe.type==="strength"&&Fe.key===S.key&&Fe.targetValue===G.targetValue):$e.some(Fe=>Fe.type==="strength"&&Fe.key===S.key&&Fe.targetWeight===G.targetWeight&&Fe.targetReps===G.targetReps))){const Fe=G.targetType==="time"?`${S.name} ${G.targetValue}s`:`${S.name} ${G.targetWeight}kg  ${G.targetReps}`;E.push({type:"strength",key:S.key,...G.targetType==="time"?{targetType:"time",targetValue:G.targetValue}:{targetWeight:G.targetWeight,targetReps:G.targetReps},achievedMonth:Le,label:Fe})}}):zo.forEach(S=>{const G=Te[S.key];if(!G||!G.targetValue)return;const ae=ue[S.key];if(ae==null)return;const Qe=G.startValue||0,qe=G.targetValue,Fe=qe-Qe;(Fe===0?ae===qe?1:0:Math.max(0,(ae-Qe)/Fe))>=1&&($e.some(Ys=>Ys.type==="metric"&&Ys.key===S.key&&Ys.targetValue===qe)||E.push({type:"metric",key:S.key,targetValue:qe,achievedMonth:Le,label:`${S.name} ${qe}${S.suffix}`}))}),E.length>0){const S=[...$e,...E];await Ds(He(pe,"achievements",Ct.id),{clientId:Ct.id,badges:S,updatedAt:vt.now()}),bt(S),fe(E),setTimeout(()=>fe(null),5e3)}},Gt=($,ue)=>{if($==="strength"){const E=ge[ue];return E?E.targetType==="time"?$e.some(S=>S.type==="strength"&&S.key===ue&&S.targetValue===E.targetValue):!E.targetWeight&&!E.targetReps?!1:$e.some(S=>S.type==="strength"&&S.key===ue&&S.targetWeight===E.targetWeight&&S.targetReps===E.targetReps):!1}else{const E=Te[ue];return!E||!E.targetValue?!1:$e.some(S=>S.type==="metric"&&S.key===ue&&S.targetValue===E.targetValue)}},Q=async()=>{p(!0);try{const $=`${Ct.id}_${Le}`,ue=De||{};await Ds(He(pe,"personalBests",$),{clientId:Ct.id,month:Le,benchmarks:V,bodyMetrics:ue.bodyMetrics||K||{},createdAt:ue.createdAt||vt.now(),updatedAt:vt.now()}),await Ut("strength",V),he("Benchmarks saved!","success"),k(!1),await Re()}catch($){console.error("Error saving benchmarks:",$),he("Failed to save. Please try again.","error")}p(!1)},ve=async()=>{p(!0);try{const $=`${Ct.id}_${Le}`,ue=De||{};await Ds(He(pe,"personalBests",$),{clientId:Ct.id,month:Le,benchmarks:ue.benchmarks||V||{},bodyMetrics:K,createdAt:ue.createdAt||vt.now(),updatedAt:vt.now()}),await Ut("metric",K),he("Body metrics saved!","success"),O(!1),await Re()}catch($){console.error("Error saving metrics:",$),he("Failed to save. Please try again.","error")}p(!1)},at=($,ue,E)=>{ne(S=>({...S,[$]:{...S[$],[ue]:E===""?"":parseFloat(E)}}))},It=($,ue)=>{le(E=>({...E,[$]:ue===""?"":parseFloat(ue)}))},St=($,ue,E)=>{A(S=>({...S,[$]:{...S[$],[ue]:E===""?"":parseFloat(E)}}))},ts=async()=>{p(!0);try{const $=`targets_${Ct.id}`,ue=De?.benchmarks||{},E={};Da.forEach(S=>{const G=ue[S.key];S.unit==="time"?T[S.key]?.targetValue&&(E[S.key]={targetType:"time",targetValue:T[S.key].targetValue,startValue:G?.time||0}):(T[S.key]?.targetWeight||T[S.key]?.targetReps)&&(E[S.key]={targetWeight:T[S.key].targetWeight||0,targetReps:T[S.key].targetReps||0,startWeight:G?.weight||0,startReps:G?.reps||0})}),await Ds(He(pe,"personalBestTargets",$),{clientId:Ct.id,targets:E,metricTargets:Te,updatedAt:vt.now()}),Ie(E),A(E),he("Targets saved!","success"),B(!1)}catch($){console.error("Error saving targets:",$),he("Failed to save targets.","error")}p(!1)},Xt=($,ue)=>{M(E=>({...E,[$]:{...E[$],targetValue:ue===""?"":parseFloat(ue)}}))},zt=async()=>{p(!0);try{const $=`targets_${Ct.id}`,ue={};zo.forEach(E=>{if(F[E.key]?.targetValue){const S=De?.bodyMetrics?.[E.key]||0;ue[E.key]={targetValue:F[E.key].targetValue,startValue:S}}}),await Ds(He(pe,"personalBestTargets",$),{clientId:Ct.id,targets:ge,metricTargets:ue,updatedAt:vt.now()}),R(ue),M(ue),he("Metric targets saved!","success"),D(!1)}catch($){console.error("Error saving metric targets:",$),he("Failed to save targets.","error")}p(!1)},Rs=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){p(!0);try{const $=He(pe,"personalBestTargets",`targets_${Ct.id}`);await vr($),Ie({}),R({}),A({}),M({}),he("All goals have been reset","success")}catch($){console.error("Error resetting targets:",$),he("Failed to reset goals","error")}p(!1)}},tn=($,ue)=>{const E=ge[$];if(!E||!ue)return null;if(E.targetType==="time"){if(!E.targetValue)return null;const qe=E.startValue||0,Fe=E.targetValue,Lt=ue.time||0,Mt=Fe-qe;return Mt<=0?Lt>=Fe?1:0:Math.max(0,Math.min((Lt-qe)/Mt,1))}if(!E.targetWeight&&!E.targetReps)return null;const S=(E.startWeight||0)*(E.startReps||0),G=(E.targetWeight||0)*(E.targetReps||0),ae=(ue.weight||0)*(ue.reps||0),Qe=G-S;return Qe<=0?ae>=G?1:0:Math.max(0,Math.min((ae-S)/Qe,1))},rs=$=>{const ue=Te[$];if(!ue||!ue.targetValue)return null;const E=De?.bodyMetrics?.[$];if(E==null)return null;const S=ue.startValue||0,G=ue.targetValue,ae=G-S;return ae===0?E===G?1:0:Math.max(0,Math.min((E-S)/ae,1))},Ts=$=>{Je.current=$.touches[0].clientX,ut.current=0},As=$=>{ut.current=$.touches[0].clientX-Je.current},z=()=>{ut.current<-50?Ze(g+1):ut.current>50&&Ze(g-1),ut.current=0},ye=$=>{const ue=De?.bodyMetrics?.[$],E=ft?.bodyMetrics?.[$];return ue==null||E==null?null:parseFloat((ue-E).toFixed(2))},we=t.find($=>$.month===se),_e=t.find($=>$.month===Oe);if(as||l)return a.jsxs("div",{className:"pb-page",children:[a.jsx("header",{className:"client-header",children:a.jsx("div",{className:"header-content",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),a.jsxs("main",{className:"pb-main",children:[a.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),a.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!Pt||!Ks||!Ct)return null;if(_s&&Ct?.isJunior)return a.jsx(t6,{});const be=Da[g],it=De?.benchmarks?.[be.key],Rt=ft?.benchmarks?.[be.key],ct=Bl(be,it),_t=Bl(be,Rt),kt=Zp(ct,_t),us=tn(be.key,it),Cn=us!==null,hn=us!==null&&us>=1,fn=Cn?Math.round(us*60):ct>0?15:0,Es=ge[be.key];return a.jsx(Ku,{children:a.jsxs("div",{className:"pb-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>qt(ns?"/client/core-buddy":"/client"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsxs("main",{className:"pb-main page-transition-enter",children:[a.jsxs("div",{className:"pb-intro",children:[a.jsx("h2",{children:"Personal Bests"}),a.jsx("p",{children:_s?"Track your strength benchmarks and body measurements each month.":"Your all-time best lifts from programme workouts."})]}),!_s&&a.jsxs("div",{className:"pb-cb-section",children:[Object.keys(Ue).length===0?a.jsxs("div",{className:"pb-empty",children:[a.jsx("div",{className:"pb-cb-empty-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})}),a.jsx("h4",{children:"No personal bests yet"}),a.jsx("p",{children:"Complete weight-based workouts to start tracking your personal bests."})]}):a.jsx("div",{className:"pb-cb-grid",children:Object.entries(Ue).sort(([$],[ue])=>$.localeCompare(ue)).map(([$,ue],E)=>{const S=Tt[$],G=Ve($),ae=G!==null&&G>=1,Qe=Ye($),qe=G!==null?Math.round(G*60):60;return a.jsxs("div",{className:"pb-cb-card",style:{animationDelay:`${E*.05}s`},children:[a.jsxs("div",{className:"pb-cb-card-top",children:[a.jsxs("div",{className:"pb-cb-card-ring",children:[a.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:WM.map((Fe,Lt)=>{const Mt=Lt<qe;return a.jsx("line",{x1:Fe.x1,y1:Fe.y1,x2:Fe.x2,y2:Fe.y2,className:`pb-ring-tick ${Mt?ae?"hit":"filled":"empty"}`,strokeWidth:Fe.thick?"2":"1.5"},Lt)})}),a.jsx("div",{className:"pb-cb-ring-icon",children:Qe?a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"pb-cb-badge-earned",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}):a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})})]}),a.jsxs("div",{className:"pb-cb-card-info",children:[a.jsx("h4",{className:"pb-cb-card-name",children:$}),a.jsxs("div",{className:"pb-cb-card-value",children:[ue.weight,"kg  ",ue.reps]}),ue.achievedAt&&a.jsx("div",{className:"pb-cb-card-date",children:(ue.achievedAt.toDate?ue.achievedAt.toDate():new Date(ue.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),S&&ae&&!Qe&&a.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"}),Qe&&a.jsx("div",{className:"pb-cb-target-info earned",children:"Badge earned!"})]}),a.jsx("div",{className:"pb-cb-card-action",children:a.jsx("button",{className:"pb-cb-target-btn",onClick:()=>{Ee($),mt("")},children:S?ae&&Qe?a.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 5v14M5 12h14"})}):a.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),a.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("circle",{cx:"12",cy:"12",r:"6"}),a.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]}),S&&!ae&&a.jsxs("div",{className:"pb-cb-card-progress",children:[a.jsxs("div",{className:"pb-cb-progress-labels",children:[a.jsxs("span",{className:"pb-cb-progress-current",children:[ue.weight,"kg"]}),a.jsxs("span",{className:"pb-cb-progress-target",children:["Target: ",S.targetWeight,"kg"]})]}),a.jsx("div",{className:"pb-cb-progress-bar",children:a.jsx("div",{className:"pb-cb-progress-bar-fill",style:{width:`${Math.round((G||0)*100)}%`}})}),a.jsxs("div",{className:"pb-cb-progress-pct",children:[Math.round((G||0)*100),"%"]})]}),S&&ae&&a.jsx("div",{className:"pb-cb-card-progress",children:a.jsx("div",{className:"pb-cb-progress-bar",children:a.jsx("div",{className:"pb-cb-progress-bar-fill hit",style:{width:"100%"}})})})]},$)})}),Object.keys(Ue).length>0&&a.jsxs("button",{className:"pb-cb-achievements-link",onClick:()=>qt("/client/core-buddy/achievements"),children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"View Achievements",a.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),At&&a.jsx("div",{className:"pb-cb-target-modal-overlay",onClick:()=>Ee(null),children:a.jsxs("div",{className:"pb-cb-target-modal",onClick:$=>$.stopPropagation(),children:[a.jsx("h3",{children:"Set Target"}),a.jsx("p",{className:"pb-cb-target-exercise-name",children:At}),a.jsxs("div",{className:"pb-cb-target-current",children:["Current PB: ",a.jsxs("strong",{children:[Ue[At]?.weight,"kg"]})]}),a.jsxs("div",{className:"pb-cb-target-input-wrap",children:[a.jsx("label",{children:"Your target (kg)"}),a.jsx("input",{type:"number",inputMode:"decimal",step:"0.5",value:Z,onChange:$=>mt($.target.value),placeholder:String((Ue[At]?.weight||0)+5),className:"pb-cb-target-input",autoFocus:!0})]}),a.jsxs("div",{className:"pb-cb-target-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>Ee(null),children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:ze,disabled:d,children:d?"Saving...":"Set Target"})]})]})})]}),_s&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"pb-tabs",children:[a.jsx("button",{className:`pb-tab ${n==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),a.jsx("button",{className:`pb-tab ${n==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),a.jsx("button",{className:`pb-tab ${n==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),n==="bests"&&a.jsxs("div",{className:"pb-strength-section",children:[!w&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"pb-carousel",ref:pt,onTouchStart:Ts,onTouchMove:As,onTouchEnd:z,children:[a.jsx("div",{className:`pb-ring-container slide-from-${tt.current}`,children:a.jsxs("div",{className:"pb-ring",children:[a.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:Yy.map(($,ue)=>{const E=ue<Math.round(fn);return a.jsx("line",{x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,className:`pb-ring-tick ${E?hn?"hit":"filled":"empty"}`,strokeWidth:$.thick?"3":"2"},ue)})}),a.jsxs("div",{className:"pb-ring-center",children:[a.jsx("div",{className:"pb-ring-category",children:be.category}),a.jsxs("div",{className:"pb-ring-exercise",children:[be.name,Gt("strength",be.key)&&a.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),a.jsx("div",{className:"pb-ring-value",children:it?be.unit==="time"?dh(it.time):T2(it.weight,it.reps):"-"}),kt!==null&&a.jsxs("div",{className:`pb-ring-change ${kt>=0?"positive":"negative"}`,children:[kt>=0?"+":"",kt.toFixed(1),"%"]}),kt===null&&it&&a.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),Es&&a.jsx("div",{className:`pb-ring-target ${hn?"hit":""}`,children:hn?"Target hit!":Es.targetType==="time"?`${Es.startValue||0}s  ${Es.targetValue}s`:`${Es.startWeight||0}kg${Es.startReps||0}  ${Es.targetWeight}kg${Es.targetReps}`}),!Es&&a.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},g),a.jsx("div",{className:"pb-carousel-dots",children:Da.map(($,ue)=>a.jsx("button",{className:`pb-dot ${ue===g?"active":""}`,onClick:()=>Ze(ue)},ue))}),a.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>Ze(g-1),disabled:g===0,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),a.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>Ze(g+1),disabled:g===Da.length-1,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),a.jsxs("div",{className:"pb-trend-section",children:[a.jsx("h4",{children:"Trend"}),a.jsx(n6,{data:t,exerciseKey:be.key,unit:be.unit})]})]}),!w&&!q&&a.jsxs("div",{className:"pb-action-buttons",children:[a.jsx("button",{className:"pb-edit-btn",onClick:()=>k(!0),children:De?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),a.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>B(!0),children:Object.keys(ge).length>0?"Edit Targets":"Set Targets"}),(Object.keys(ge).length>0||Object.keys(Te).length>0)&&a.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:Rs,disabled:d,children:"Reset All Goals"})]}),w&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsxs("h3",{children:["Benchmarks - ",ya(Le)]}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{k(!1),ne(De?.benchmarks||{})},children:""})]}),a.jsx("div",{className:"pb-edit-body",children:Da.map($=>a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:$.name}),$.unit==="weight"?a.jsxs("div",{className:"pb-edit-row",children:[a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",step:"0.5",value:V[$.key]?.weight??"",onChange:ue=>at($.key,"weight",ue.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",value:V[$.key]?.reps??"",onChange:ue=>at($.key,"reps",ue.target.value),placeholder:"0"})]})]}):a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Time (seconds)"}),a.jsx("input",{type:"number",step:"0.01",value:V[$.key]?.time??"",onChange:ue=>at($.key,"time",ue.target.value),placeholder:"0"})]})})]},$.key))}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{k(!1),ne(De?.benchmarks||{})},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:Q,disabled:d,children:d?"Saving...":"Save"})]})]}),q&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsx("h3",{children:"Set Your Targets"}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{B(!1),A(ge)},children:""})]}),a.jsxs("div",{className:"pb-edit-body",children:[a.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),Da.map($=>{const ue=De?.benchmarks?.[$.key];let E="-";return ue&&($.unit==="time"&&ue.time?E=`${ue.time}s`:(ue.weight||ue.reps)&&(E=`${ue.weight||0}kg  ${ue.reps||0}`)),a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsxs("div",{className:"pb-edit-exercise-header",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:$.name}),a.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",E]})]}),$.unit==="weight"?a.jsxs("div",{className:"pb-edit-row",children:[a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Target Weight (kg)"}),a.jsx("input",{type:"number",step:"0.5",value:T[$.key]?.targetWeight??"",onChange:S=>St($.key,"targetWeight",S.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Target Reps"}),a.jsx("input",{type:"number",value:T[$.key]?.targetReps??"",onChange:S=>St($.key,"targetReps",S.target.value),placeholder:"0"})]})]}):a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Target (seconds)"}),a.jsx("input",{type:"number",step:"1",value:T[$.key]?.targetValue??"",onChange:S=>St($.key,"targetValue",S.target.value),placeholder:"0"})]})})]},$.key)})]}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{B(!1),A(ge)},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:ts,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="metrics"&&a.jsxs("div",{className:"pb-metrics-section",children:[!j&&!L&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"pb-metrics-card",children:[a.jsx("h3",{children:"Body Measurements"}),a.jsx("p",{className:"pb-metrics-month",children:ya(Le)}),a.jsx("div",{className:"pb-metrics-list",children:zo.map($=>{const ue=De?.bodyMetrics?.[$.key],E=ye($.key),S=Te[$.key],G=rs($.key),ae=G!==null&&G>=1;return a.jsxs("div",{className:"pb-metric-row",children:[a.jsxs("div",{className:"pb-metric-top",children:[a.jsxs("div",{className:"pb-metric-left",children:[a.jsxs("span",{className:"pb-metric-name",children:[$.name,Gt("metric",$.key)&&a.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),S&&a.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",S.targetValue," ",$.suffix]})]}),a.jsxs("div",{className:"pb-metric-values",children:[a.jsx("span",{className:"pb-metric-current",children:ue!=null?`${ue} ${$.suffix}`:"-"}),E!==null&&a.jsxs("span",{className:`pb-metric-change ${E>0?"up":E<0?"down":"same"}`,children:[E>0?"+":"",E," ",$.suffix]})]})]}),G!==null&&a.jsxs("div",{className:"pb-metric-progress",children:[a.jsx("div",{className:"pb-metric-bar",children:a.jsx("div",{className:`pb-metric-bar-fill ${ae?"hit":""}`,style:{width:`${Math.round(G*100)}%`}})}),a.jsx("span",{className:`pb-metric-percent ${ae?"hit":""}`,children:ae?"Hit!":`${Math.round(G*100)}%`})]})]},$.key)})})]}),a.jsxs("div",{className:"pb-action-buttons",children:[a.jsx("button",{className:"pb-edit-btn",onClick:()=>O(!0),children:De?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),a.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>D(!0),children:Object.keys(Te).length>0?"Edit Targets":"Set Targets"}),(Object.keys(ge).length>0||Object.keys(Te).length>0)&&a.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:Rs,disabled:d,children:"Reset All Goals"})]})]}),j&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsxs("h3",{children:["Measurements - ",ya(Le)]}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{O(!1),le(De?.bodyMetrics||{})},children:""})]}),a.jsx("div",{className:"pb-edit-body",children:zo.map($=>a.jsx("div",{className:"pb-edit-metric",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsxs("label",{children:[$.name," (",$.suffix,")"]}),a.jsx("input",{type:"number",step:"0.1",value:K[$.key]??"",onChange:ue=>It($.key,ue.target.value),placeholder:"0"})]})},$.key))}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{O(!1),le(De?.bodyMetrics||{})},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:ve,disabled:d,children:d?"Saving...":"Save"})]})]}),L&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsx("h3",{children:"Body Metric Targets"}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{D(!1),M(Te)},children:""})]}),a.jsxs("div",{className:"pb-edit-body",children:[a.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),zo.map($=>{const ue=De?.bodyMetrics?.[$.key];return a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsxs("div",{className:"pb-edit-exercise-header",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:$.name}),a.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",ue!=null?`${ue} ${$.suffix}`:"-"]})]}),a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsxs("label",{children:["Target (",$.suffix,")"]}),a.jsx("input",{type:"number",step:"0.1",value:F[$.key]?.targetValue??"",onChange:E=>Xt($.key,E.target.value),placeholder:"0"})]})})]},$.key)})]}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{D(!1),M(Te)},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:zt,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="history"&&a.jsx("div",{className:"pb-history-section",children:t.length===0?a.jsxs("div",{className:"pb-empty",children:[a.jsx("h4",{children:"No records yet"}),a.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):a.jsxs(a.Fragment,{children:[$e.length>0&&a.jsxs("div",{className:"pb-achievements-wall",children:[a.jsxs("h4",{className:"pb-achievements-wall-title",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),a.jsx("div",{className:"pb-achievements-list",children:[...$e].reverse().map(($,ue)=>a.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${ue*.05}s`},children:[a.jsx("div",{className:"pb-achievement-star",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("div",{className:"pb-achievement-info",children:[a.jsx("span",{className:"pb-achievement-label",children:$.label}),a.jsx("span",{className:"pb-achievement-date",children:ya($.achievedMonth)})]})]},ue))})]}),a.jsx("div",{className:"pb-history-controls",children:a.jsx("button",{className:`pb-compare-toggle ${ee?"active":""}`,onClick:()=>{P(!ee),!ee&&t.length>=2&&(Se(t[0].month),st(t[t.length-1].month))},children:ee?"Back to Timeline":"Compare Months"})}),ee?a.jsxs("div",{className:"pb-compare",children:[a.jsxs("div",{className:"pb-compare-selectors",children:[a.jsxs("div",{className:"pb-compare-select",children:[a.jsx("label",{children:"From"}),a.jsx("select",{value:se,onChange:$=>Se($.target.value),children:t.map($=>a.jsx("option",{value:$.month,children:ya($.month)},$.month))})]}),a.jsx("div",{className:"pb-compare-vs",children:"vs"}),a.jsxs("div",{className:"pb-compare-select",children:[a.jsx("label",{children:"To"}),a.jsx("select",{value:Oe,onChange:$=>st($.target.value),children:t.map($=>a.jsx("option",{value:$.month,children:ya($.month)},$.month))})]})]}),we&&_e&&a.jsxs("div",{className:"pb-compare-results",children:[a.jsxs("div",{className:"pb-compare-group",children:[a.jsx("h4",{children:"Strength Benchmarks"}),a.jsxs("div",{className:"pb-compare-table",children:[a.jsxs("div",{className:"pb-compare-header-row",children:[a.jsx("span",{children:"Exercise"}),a.jsx("span",{children:ya(se).split(" ")[0]}),a.jsx("span",{children:ya(Oe).split(" ")[0]}),a.jsx("span",{children:"Change"})]}),Da.map($=>{const ue=we.benchmarks?.[$.key],E=_e.benchmarks?.[$.key],S=Bl($,ue),G=Bl($,E),ae=Zp(G,S);return a.jsxs("div",{className:"pb-compare-row",children:[a.jsx("span",{className:"pb-compare-name",children:$.name}),a.jsx("span",{className:"pb-compare-val",children:ue?$.unit==="time"?dh(ue.time):`${ue.weight}x${ue.reps}`:"-"}),a.jsx("span",{className:"pb-compare-val",children:E?$.unit==="time"?dh(E.time):`${E.weight}x${E.reps}`:"-"}),a.jsx("span",{className:`pb-compare-change ${ae!==null?ae>=0?"positive":"negative":""}`,children:ae!==null?`${ae>=0?"+":""}${ae.toFixed(1)}%`:"-"})]},$.key)})]})]}),a.jsxs("div",{className:"pb-compare-group",children:[a.jsx("h4",{children:"Body Measurements"}),a.jsxs("div",{className:"pb-compare-table",children:[a.jsxs("div",{className:"pb-compare-header-row",children:[a.jsx("span",{children:"Measurement"}),a.jsx("span",{children:ya(se).split(" ")[0]}),a.jsx("span",{children:ya(Oe).split(" ")[0]}),a.jsx("span",{children:"Change"})]}),zo.map($=>{const ue=we.bodyMetrics?.[$.key],E=_e.bodyMetrics?.[$.key],S=ue!=null&&E!=null?parseFloat((E-ue).toFixed(2)):null;return a.jsxs("div",{className:"pb-compare-row",children:[a.jsx("span",{className:"pb-compare-name",children:$.name}),a.jsx("span",{className:"pb-compare-val",children:ue!=null?`${ue}`:"-"}),a.jsx("span",{className:"pb-compare-val",children:E!=null?`${E}`:"-"}),a.jsx("span",{className:`pb-compare-change ${S!==null?S>0?"positive":S<0?"negative":"neutral":""}`,children:S!==null?`${S>0?"+":""}${S} ${$.suffix}`:"-"})]},$.key)})]})]})]})]}):a.jsx("div",{className:"pb-timeline",children:[...t].reverse().map(($,ue)=>{const E=t.find(S=>S.month<$.month&&t.indexOf(S)===t.indexOf($)-1)||t.filter(S=>S.month<$.month).pop();return a.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${ue*.05}s`},children:[a.jsx("div",{className:"pb-timeline-dot"}),a.jsxs("div",{className:"pb-timeline-card",children:[a.jsx("h4",{children:ya($.month)}),$.benchmarks&&Object.keys($.benchmarks).length>0&&a.jsxs("div",{className:"pb-timeline-group",children:[a.jsx("h5",{children:"Strength Benchmarks"}),Da.map(S=>{const G=$.benchmarks[S.key];if(!G)return null;const ae=E?.benchmarks?.[S.key],Qe=Bl(S,G),qe=Bl(S,ae),Fe=Zp(Qe,qe);return a.jsxs("div",{className:"pb-timeline-row",children:[a.jsx("span",{className:"pb-timeline-label",children:S.name}),a.jsxs("div",{className:"pb-timeline-values",children:[a.jsx("span",{className:"pb-timeline-value",children:S.unit==="time"?dh(G.time):T2(G.weight,G.reps)}),Fe!==null&&a.jsxs("span",{className:`pb-timeline-change ${Fe>=0?"positive":"negative"}`,children:[Fe>=0?"+":"",Fe.toFixed(1),"%"]})]})]},S.key)})]}),$.bodyMetrics&&Object.keys($.bodyMetrics).length>0&&a.jsxs("div",{className:"pb-timeline-group",children:[a.jsx("h5",{children:"Body Measurements"}),zo.map(S=>{const G=$.bodyMetrics[S.key];if(G==null)return null;const ae=E?.bodyMetrics?.[S.key],Qe=ae!=null?parseFloat((G-ae).toFixed(2)):null;return a.jsxs("div",{className:"pb-timeline-row",children:[a.jsx("span",{className:"pb-timeline-label",children:S.name}),a.jsxs("div",{className:"pb-timeline-values",children:[a.jsxs("span",{className:"pb-timeline-value",children:[G," ",S.suffix]}),Qe!==null&&a.jsxs("span",{className:`pb-timeline-change ${Qe>0?"positive":Qe<0?"negative":"neutral"}`,children:[Qe>0?"+":"",Qe," ",S.suffix]})]})]},S.key)})]})]})]},$.id)})})]})})]})]}),H&&a.jsx("div",{className:"pb-celebration-overlay",onClick:()=>fe(null),children:a.jsxs("div",{className:"pb-celebration-card",children:[a.jsx("div",{className:"pb-celebration-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsx("h3",{className:"pb-celebration-title",children:H.length===1?"Target Achieved!":`${H.length} Targets Achieved!`}),a.jsx("div",{className:"pb-celebration-badges",children:H.map(($,ue)=>a.jsx("div",{className:"pb-celebration-badge",children:$.label},ue))}),a.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),Me&&a.jsxs("div",{className:`toast-notification ${Me.type}`,children:[a.jsx("span",{className:"toast-icon",children:Me.type==="success"?a.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),a.jsx("span",{className:"toast-message",children:Me.message}),a.jsx("button",{className:"toast-close",onClick:()=>Ke(null),children:""})]}),_s&&a.jsxs("nav",{className:"block-bottom-nav",children:[a.jsxs("button",{className:"block-nav-tab",onClick:()=>qt("/client"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),a.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),a.jsx("span",{children:"Home"})]}),a.jsxs("button",{className:"block-nav-tab",onClick:()=>qt("/client/forms"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),a.jsx("span",{children:"Forms"})]}),a.jsxs("button",{className:"block-nav-tab",onClick:()=>qt("/client/tools"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),a.jsx("span",{children:"Tools"})]}),a.jsxs("button",{className:"block-nav-tab active",children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 20V10"}),a.jsx("path",{d:"M18 20V4"}),a.jsx("path",{d:"M6 20v-4"})]}),a.jsx("span",{children:"PBs"})]}),Ct?.circuitAccess&&a.jsxs("button",{className:"block-nav-tab",onClick:()=>qt("/client/circuit"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 6v6l4 2"})]}),a.jsx("span",{children:"Circuit"})]})]}),ns&&a.jsx(la,{active:"progress"})]})})}const a6=v.lazy(()=>kr(()=>import("./Dashboard-DOdjz6TP.js"),__vite__mapDeps([0,1]))),i6=v.lazy(()=>kr(()=>import("./AddClient-C7nRFkhm.js"),__vite__mapDeps([2,3]))),o6=v.lazy(()=>kr(()=>import("./ClientDashboard-D_ShbKQI.js"),[])),l6=v.lazy(()=>kr(()=>import("./ClientForms-BQFgoRcW.js"),__vite__mapDeps([4,5]))),c6=v.lazy(()=>kr(()=>import("./ClientTools-qYOEtZaz.js"),__vite__mapDeps([6,7]))),u6=v.lazy(()=>kr(()=>import("./MacroCalculator-B9aBhxRf.js"),__vite__mapDeps([8,7]))),d6=v.lazy(()=>kr(()=>import("./ProteinSnacks-DCVAhvUM.js"),__vite__mapDeps([9,7]))),h6=v.lazy(()=>kr(()=>import("./DailyMotivation-BOSlxzOx.js"),__vite__mapDeps([10,7]))),f6=v.lazy(()=>kr(()=>import("./CircuitDashboard-Dm1KIeyC.js"),__vite__mapDeps([11,12]))),m6=v.lazy(()=>kr(()=>import("./CircuitBooking-DA1lB3py.js"),__vite__mapDeps([13,14,12]))),p6=v.lazy(()=>kr(()=>import("./Leaderboard-C-LxIf3m.js"),__vite__mapDeps([15,16]))),g6=v.lazy(()=>kr(()=>import("./UpgradePage-CL6S0PGp.js"),__vite__mapDeps([17,18,19]))),y6=v.lazy(()=>kr(()=>import("./SignUp-cEvzLnwj.js"),[])),b6=v.lazy(()=>kr(()=>import("./Onboarding-bqFhbj4b.js"),__vite__mapDeps([20,18,21])));function v6({children:n}){const{pathname:e}=ka();return v.useEffect(()=>{"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")},[]),v.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"})},[e]),n}function x6(){const n=Wn();return v.useEffect(()=>{const e=sessionStorage.getItem("redirect");if(e){sessionStorage.removeItem("redirect");const t=e.replace("/login","")||"/";n(t,{replace:!0})}},[n]),null}function w6(){return a.jsx(OM,{children:a.jsx(LM,{children:a.jsx(zM,{children:a.jsxs($E,{basename:"/login",children:[a.jsx(x6,{}),a.jsx(v6,{children:a.jsx(v.Suspense,{fallback:null,children:a.jsxs(xE,{children:[a.jsx(Xs,{path:"/",element:a.jsx(qM,{})}),a.jsx(Xs,{path:"/dashboard",element:a.jsx(a6,{})}),a.jsx(Xs,{path:"/add-client",element:a.jsx(i6,{})}),a.jsx(Xs,{path:"/client",element:a.jsx(o6,{})}),a.jsx(Xs,{path:"/client/forms",element:a.jsx(l6,{})}),a.jsx(Xs,{path:"/client/tools",element:a.jsx(c6,{})}),a.jsx(Xs,{path:"/client/tools/macros",element:a.jsx(u6,{})}),a.jsx(Xs,{path:"/client/tools/snacks",element:a.jsx(d6,{})}),a.jsx(Xs,{path:"/client/tools/motivation",element:a.jsx(h6,{})}),a.jsx(Xs,{path:"/client/personal-bests",element:a.jsx(r6,{})}),a.jsx(Xs,{path:"/client/circuit",element:a.jsx(f6,{})}),a.jsx(Xs,{path:"/client/circuit/booking",element:a.jsx(m6,{})}),a.jsx(Xs,{path:"/client/core-buddy",element:a.jsx(fD,{})}),a.jsx(Xs,{path:"/client/core-buddy/nutrition",element:a.jsx(Ll,{feature:"nutrition",children:a.jsx(gD,{})})}),a.jsx(Xs,{path:"/client/core-buddy/workouts",element:a.jsx(ND,{})}),a.jsx(Xs,{path:"/client/core-buddy/programmes",element:a.jsx(Ll,{feature:"programmes",children:a.jsx(ID,{})})}),a.jsx(Xs,{path:"/client/core-buddy/achievements",element:a.jsx(Ll,{feature:"achievements",children:a.jsx(VD,{})})}),a.jsx(Xs,{path:"/client/core-buddy/consistency",element:a.jsx(Ll,{feature:"consistency",children:a.jsx(qD,{})})}),a.jsx(Xs,{path:"/client/core-buddy/buddies",element:a.jsx(Ll,{feature:"buddies",children:a.jsx($D,{})})}),a.jsx(Xs,{path:"/client/core-buddy/buddy",element:a.jsx(QD,{})}),a.jsx(Xs,{path:"/client/core-buddy/profile/:userId",element:a.jsx(YD,{})}),a.jsx(Xs,{path:"/client/leaderboard",element:a.jsx(Ll,{feature:"leaderboard",children:a.jsx(p6,{})})}),a.jsx(Xs,{path:"/signup",element:a.jsx(y6,{})}),a.jsx(Xs,{path:"/onboarding",element:a.jsx(b6,{})}),a.jsx(Xs,{path:"/upgrade",element:a.jsx(g6,{})}),a.jsx(Xs,{path:"*",element:a.jsx(bE,{to:"/",replace:!0})})]})})})]})})})})}vT.createRoot(document.getElementById("root")).render(a.jsx(v.StrictMode,{children:a.jsx(w6,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/login/sw.js").catch(()=>{})});export{Wr as A,la as C,vt as T,pi as a,vr as b,Ht as c,pe as d,He as e,OC as f,ws as g,FC as h,Ds as i,a as j,Ss as k,Pr as l,ja as m,Wn as n,$h as o,Yy as p,Ns as q,v as r,j6 as s,xf as t,La as u,HM as v,cs as w,FM as x,_6 as y,QE as z};
