const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-BcyPkD5j.js","assets/scheduleUtils-a2tn0x12.js","assets/Dashboard-BvdLF0uv.css","assets/AddClient-bv1kC2DJ.js","assets/AddClient-DH1OFzHo.css","assets/ClientDashboard-CxIswdTG.js","assets/ClientForms-DRnUPDwG.js","assets/ClientForms-GDNtnrAx.css","assets/ClientTools-BqG4G-4j.js","assets/ClientTools-DQRPoST3.css","assets/MacroCalculator-hc9-yJAk.js","assets/ProteinSnacks-Cm3sGb72.js","assets/DailyMotivation-CjqOo3_G.js","assets/CircuitDashboard-Bws9KKXh.js","assets/CircuitDashboard-C8T0uect.css","assets/CircuitBooking-DgLLKTXH.js","assets/CircuitBooking-ruk9Q4Wj.css","assets/Leaderboard-BK7rOap9.js","assets/Leaderboard-Dq-r5svP.css","assets/UpgradePage-DJEAW5XC.js","assets/UpgradePage-Blt11CID.css","assets/Onboarding-D7euGoS2.js","assets/Onboarding-Bku4iVdQ.css"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function t(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(l){if(l.ep)return;l.ep=!0;const u=t(l);fetch(l.href,u)}})();var xp={exports:{}},Jc={};var _1;function NT(){if(_1)return Jc;_1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,l,u){var d=null;if(u!==void 0&&(d=""+u),l.key!==void 0&&(d=""+l.key),"key"in l){u={};for(var p in l)p!=="key"&&(u[p]=l[p])}else u=l;return l=u.ref,{$$typeof:n,type:i,key:d,ref:l!==void 0?l:null,props:u}}return Jc.Fragment=e,Jc.jsx=t,Jc.jsxs=t,Jc}var k1;function ST(){return k1||(k1=1,xp.exports=NT()),xp.exports}var r=ST(),wp={exports:{}},ns={};var j1;function CT(){if(j1)return ns;j1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),d=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),_=Symbol.for("react.activity"),j=Symbol.iterator;function O(P){return P===null||typeof P!="object"?null:(P=j&&P[j]||P["@@iterator"],typeof P=="function"?P:null)}var $={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},V=Object.assign,L={};function ee(P,ae,Be){this.props=P,this.context=ae,this.refs=L,this.updater=Be||$}ee.prototype.isReactComponent={},ee.prototype.setState=function(P,ae){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,ae,"setState")},ee.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function Y(){}Y.prototype=ee.prototype;function te(P,ae,Be){this.props=P,this.context=ae,this.refs=L,this.updater=Be||$}var ke=te.prototype=new Y;ke.constructor=te,V(ke,ee.prototype),ke.isPureReactComponent=!0;var Te=Array.isArray;function xe(){}var R={H:null,A:null,T:null,S:null},T=Object.prototype.hasOwnProperty;function S(P,ae,Be){var Ue=Be.ref;return{$$typeof:n,type:P,key:ae,ref:Ue!==void 0?Ue:null,props:Be}}function D(P,ae){return S(P.type,ae,P.props)}function I(P){return typeof P=="object"&&P!==null&&P.$$typeof===n}function U(P){var ae={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(Be){return ae[Be]})}var M=/\/+/g;function ze(P,ae){return typeof P=="object"&&P!==null&&P.key!=null?U(""+P.key):ae.toString(36)}function gt(P){switch(P.status){case"fulfilled":return P.value;case"rejected":throw P.reason;default:switch(typeof P.status=="string"?P.then(xe,xe):(P.status="pending",P.then(function(ae){P.status==="pending"&&(P.status="fulfilled",P.value=ae)},function(ae){P.status==="pending"&&(P.status="rejected",P.reason=ae)})),P.status){case"fulfilled":return P.value;case"rejected":throw P.reason}}throw P}function B(P,ae,Be,Ue,Oe){var Ie=typeof P;(Ie==="undefined"||Ie==="boolean")&&(P=null);var ot=!1;if(P===null)ot=!0;else switch(Ie){case"bigint":case"string":case"number":ot=!0;break;case"object":switch(P.$$typeof){case n:case e:ot=!0;break;case x:return ot=P._init,B(ot(P._payload),ae,Be,Ue,Oe)}}if(ot)return Oe=Oe(P),ot=Ue===""?"."+ze(P,0):Ue,Te(Oe)?(Be="",ot!=null&&(Be=ot.replace(M,"$&/")+"/"),B(Oe,ae,Be,"",function(Xt){return Xt})):Oe!=null&&(I(Oe)&&(Oe=D(Oe,Be+(Oe.key==null||P&&P.key===Oe.key?"":(""+Oe.key).replace(M,"$&/")+"/")+ot)),ae.push(Oe)),1;ot=0;var yt=Ue===""?".":Ue+":";if(Te(P))for(var et=0;et<P.length;et++)Ue=P[et],Ie=yt+ze(Ue,et),ot+=B(Ue,ae,Be,Ie,Oe);else if(et=O(P),typeof et=="function")for(P=et.call(P),et=0;!(Ue=P.next()).done;)Ue=Ue.value,Ie=yt+ze(Ue,et++),ot+=B(Ue,ae,Be,Ie,Oe);else if(Ie==="object"){if(typeof P.then=="function")return B(gt(P),ae,Be,Ue,Oe);throw ae=String(P),Error("Objects are not valid as a React child (found: "+(ae==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":ae)+"). If you meant to render a collection of children, use an array instead.")}return ot}function se(P,ae,Be){if(P==null)return P;var Ue=[],Oe=0;return B(P,Ue,"","",function(Ie){return ae.call(Be,Ie,Oe++)}),Ue}function ge(P){if(P._status===-1){var ae=P._result;ae=ae(),ae.then(function(Be){(P._status===0||P._status===-1)&&(P._status=1,P._result=Be)},function(Be){(P._status===0||P._status===-1)&&(P._status=2,P._result=Be)}),P._status===-1&&(P._status=0,P._result=ae)}if(P._status===1)return P._result.default;throw P._result}var Re=typeof reportError=="function"?reportError:function(P){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ae=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof P=="object"&&P!==null&&typeof P.message=="string"?String(P.message):String(P),error:P});if(!window.dispatchEvent(ae))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",P);return}console.error(P)},Q={map:se,forEach:function(P,ae,Be){se(P,function(){ae.apply(this,arguments)},Be)},count:function(P){var ae=0;return se(P,function(){ae++}),ae},toArray:function(P){return se(P,function(ae){return ae})||[]},only:function(P){if(!I(P))throw Error("React.Children.only expected to receive a single React element child.");return P}};return ns.Activity=_,ns.Children=Q,ns.Component=ee,ns.Fragment=t,ns.Profiler=l,ns.PureComponent=te,ns.StrictMode=i,ns.Suspense=g,ns.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,ns.__COMPILER_RUNTIME={__proto__:null,c:function(P){return R.H.useMemoCache(P)}},ns.cache=function(P){return function(){return P.apply(null,arguments)}},ns.cacheSignal=function(){return null},ns.cloneElement=function(P,ae,Be){if(P==null)throw Error("The argument must be a React element, but you passed "+P+".");var Ue=V({},P.props),Oe=P.key;if(ae!=null)for(Ie in ae.key!==void 0&&(Oe=""+ae.key),ae)!T.call(ae,Ie)||Ie==="key"||Ie==="__self"||Ie==="__source"||Ie==="ref"&&ae.ref===void 0||(Ue[Ie]=ae[Ie]);var Ie=arguments.length-2;if(Ie===1)Ue.children=Be;else if(1<Ie){for(var ot=Array(Ie),yt=0;yt<Ie;yt++)ot[yt]=arguments[yt+2];Ue.children=ot}return S(P.type,Oe,Ue)},ns.createContext=function(P){return P={$$typeof:d,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null},P.Provider=P,P.Consumer={$$typeof:u,_context:P},P},ns.createElement=function(P,ae,Be){var Ue,Oe={},Ie=null;if(ae!=null)for(Ue in ae.key!==void 0&&(Ie=""+ae.key),ae)T.call(ae,Ue)&&Ue!=="key"&&Ue!=="__self"&&Ue!=="__source"&&(Oe[Ue]=ae[Ue]);var ot=arguments.length-2;if(ot===1)Oe.children=Be;else if(1<ot){for(var yt=Array(ot),et=0;et<ot;et++)yt[et]=arguments[et+2];Oe.children=yt}if(P&&P.defaultProps)for(Ue in ot=P.defaultProps,ot)Oe[Ue]===void 0&&(Oe[Ue]=ot[Ue]);return S(P,Ie,Oe)},ns.createRef=function(){return{current:null}},ns.forwardRef=function(P){return{$$typeof:p,render:P}},ns.isValidElement=I,ns.lazy=function(P){return{$$typeof:x,_payload:{_status:-1,_result:P},_init:ge}},ns.memo=function(P,ae){return{$$typeof:y,type:P,compare:ae===void 0?null:ae}},ns.startTransition=function(P){var ae=R.T,Be={};R.T=Be;try{var Ue=P(),Oe=R.S;Oe!==null&&Oe(Be,Ue),typeof Ue=="object"&&Ue!==null&&typeof Ue.then=="function"&&Ue.then(xe,Re)}catch(Ie){Re(Ie)}finally{ae!==null&&Be.types!==null&&(ae.types=Be.types),R.T=ae}},ns.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},ns.use=function(P){return R.H.use(P)},ns.useActionState=function(P,ae,Be){return R.H.useActionState(P,ae,Be)},ns.useCallback=function(P,ae){return R.H.useCallback(P,ae)},ns.useContext=function(P){return R.H.useContext(P)},ns.useDebugValue=function(){},ns.useDeferredValue=function(P,ae){return R.H.useDeferredValue(P,ae)},ns.useEffect=function(P,ae){return R.H.useEffect(P,ae)},ns.useEffectEvent=function(P){return R.H.useEffectEvent(P)},ns.useId=function(){return R.H.useId()},ns.useImperativeHandle=function(P,ae,Be){return R.H.useImperativeHandle(P,ae,Be)},ns.useInsertionEffect=function(P,ae){return R.H.useInsertionEffect(P,ae)},ns.useLayoutEffect=function(P,ae){return R.H.useLayoutEffect(P,ae)},ns.useMemo=function(P,ae){return R.H.useMemo(P,ae)},ns.useOptimistic=function(P,ae){return R.H.useOptimistic(P,ae)},ns.useReducer=function(P,ae,Be){return R.H.useReducer(P,ae,Be)},ns.useRef=function(P){return R.H.useRef(P)},ns.useState=function(P){return R.H.useState(P)},ns.useSyncExternalStore=function(P,ae,Be){return R.H.useSyncExternalStore(P,ae,Be)},ns.useTransition=function(){return R.H.useTransition()},ns.version="19.2.4",ns}var T1;function Lg(){return T1||(T1=1,wp.exports=CT()),wp.exports}var b=Lg(),_p={exports:{}},Zc={},kp={exports:{}},jp={};var E1;function RT(){return E1||(E1=1,(function(n){function e(B,se){var ge=B.length;B.push(se);e:for(;0<ge;){var Re=ge-1>>>1,Q=B[Re];if(0<l(Q,se))B[Re]=se,B[ge]=Q,ge=Re;else break e}}function t(B){return B.length===0?null:B[0]}function i(B){if(B.length===0)return null;var se=B[0],ge=B.pop();if(ge!==se){B[0]=ge;e:for(var Re=0,Q=B.length,P=Q>>>1;Re<P;){var ae=2*(Re+1)-1,Be=B[ae],Ue=ae+1,Oe=B[Ue];if(0>l(Be,ge))Ue<Q&&0>l(Oe,Be)?(B[Re]=Oe,B[Ue]=ge,Re=Ue):(B[Re]=Be,B[ae]=ge,Re=ae);else if(Ue<Q&&0>l(Oe,ge))B[Re]=Oe,B[Ue]=ge,Re=Ue;else break e}}return se}function l(B,se){var ge=B.sortIndex-se.sortIndex;return ge!==0?ge:B.id-se.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;n.unstable_now=function(){return u.now()}}else{var d=Date,p=d.now();n.unstable_now=function(){return d.now()-p}}var g=[],y=[],x=1,_=null,j=3,O=!1,$=!1,V=!1,L=!1,ee=typeof setTimeout=="function"?setTimeout:null,Y=typeof clearTimeout=="function"?clearTimeout:null,te=typeof setImmediate<"u"?setImmediate:null;function ke(B){for(var se=t(y);se!==null;){if(se.callback===null)i(y);else if(se.startTime<=B)i(y),se.sortIndex=se.expirationTime,e(g,se);else break;se=t(y)}}function Te(B){if(V=!1,ke(B),!$)if(t(g)!==null)$=!0,xe||(xe=!0,U());else{var se=t(y);se!==null&&gt(Te,se.startTime-B)}}var xe=!1,R=-1,T=5,S=-1;function D(){return L?!0:!(n.unstable_now()-S<T)}function I(){if(L=!1,xe){var B=n.unstable_now();S=B;var se=!0;try{e:{$=!1,V&&(V=!1,Y(R),R=-1),O=!0;var ge=j;try{t:{for(ke(B),_=t(g);_!==null&&!(_.expirationTime>B&&D());){var Re=_.callback;if(typeof Re=="function"){_.callback=null,j=_.priorityLevel;var Q=Re(_.expirationTime<=B);if(B=n.unstable_now(),typeof Q=="function"){_.callback=Q,ke(B),se=!0;break t}_===t(g)&&i(g),ke(B)}else i(g);_=t(g)}if(_!==null)se=!0;else{var P=t(y);P!==null&&gt(Te,P.startTime-B),se=!1}}break e}finally{_=null,j=ge,O=!1}se=void 0}}finally{se?U():xe=!1}}}var U;if(typeof te=="function")U=function(){te(I)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,ze=M.port2;M.port1.onmessage=I,U=function(){ze.postMessage(null)}}else U=function(){ee(I,0)};function gt(B,se){R=ee(function(){B(n.unstable_now())},se)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(B){B.callback=null},n.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<B?Math.floor(1e3/B):5},n.unstable_getCurrentPriorityLevel=function(){return j},n.unstable_next=function(B){switch(j){case 1:case 2:case 3:var se=3;break;default:se=j}var ge=j;j=se;try{return B()}finally{j=ge}},n.unstable_requestPaint=function(){L=!0},n.unstable_runWithPriority=function(B,se){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var ge=j;j=B;try{return se()}finally{j=ge}},n.unstable_scheduleCallback=function(B,se,ge){var Re=n.unstable_now();switch(typeof ge=="object"&&ge!==null?(ge=ge.delay,ge=typeof ge=="number"&&0<ge?Re+ge:Re):ge=Re,B){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=ge+Q,B={id:x++,callback:se,priorityLevel:B,startTime:ge,expirationTime:Q,sortIndex:-1},ge>Re?(B.sortIndex=ge,e(y,B),t(g)===null&&B===t(y)&&(V?(Y(R),R=-1):V=!0,gt(Te,ge-Re))):(B.sortIndex=Q,e(g,B),$||O||($=!0,xe||(xe=!0,U()))),B},n.unstable_shouldYield=D,n.unstable_wrapCallback=function(B){var se=j;return function(){var ge=j;j=se;try{return B.apply(this,arguments)}finally{j=ge}}}})(jp)),jp}var N1;function AT(){return N1||(N1=1,kp.exports=RT()),kp.exports}var Tp={exports:{}},pr={};var S1;function IT(){if(S1)return pr;S1=1;var n=Lg();function e(g){var y="https://react.dev/errors/"+g;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)y+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+g+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},l=Symbol.for("react.portal");function u(g,y,x){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:_==null?null:""+_,children:g,containerInfo:y,implementation:x}}var d=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(g,y){if(g==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return pr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,pr.createPortal=function(g,y){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(e(299));return u(g,y,null,x)},pr.flushSync=function(g){var y=d.T,x=i.p;try{if(d.T=null,i.p=2,g)return g()}finally{d.T=y,i.p=x,i.d.f()}},pr.preconnect=function(g,y){typeof g=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,i.d.C(g,y))},pr.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},pr.preinit=function(g,y){if(typeof g=="string"&&y&&typeof y.as=="string"){var x=y.as,_=p(x,y.crossOrigin),j=typeof y.integrity=="string"?y.integrity:void 0,O=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;x==="style"?i.d.S(g,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:_,integrity:j,fetchPriority:O}):x==="script"&&i.d.X(g,{crossOrigin:_,integrity:j,fetchPriority:O,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},pr.preinitModule=function(g,y){if(typeof g=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var x=p(y.as,y.crossOrigin);i.d.M(g,{crossOrigin:x,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&i.d.M(g)},pr.preload=function(g,y){if(typeof g=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var x=y.as,_=p(x,y.crossOrigin);i.d.L(g,x,{crossOrigin:_,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},pr.preloadModule=function(g,y){if(typeof g=="string")if(y){var x=p(y.as,y.crossOrigin);i.d.m(g,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:x,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else i.d.m(g)},pr.requestFormReset=function(g){i.d.r(g)},pr.unstable_batchedUpdates=function(g,y){return g(y)},pr.useFormState=function(g,y,x){return d.H.useFormState(g,y,x)},pr.useFormStatus=function(){return d.H.useHostTransitionStatus()},pr.version="19.2.4",pr}var C1;function MT(){if(C1)return Tp.exports;C1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Tp.exports=IT(),Tp.exports}var R1;function DT(){if(R1)return Zc;R1=1;var n=AT(),e=Lg(),t=MT();function i(s){var a="https://react.dev/errors/"+s;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)a+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+s+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function u(s){var a=s,o=s;if(s.alternate)for(;a.return;)a=a.return;else{s=a;do a=s,(a.flags&4098)!==0&&(o=a.return),s=a.return;while(s)}return a.tag===3?o:null}function d(s){if(s.tag===13){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function p(s){if(s.tag===31){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function g(s){if(u(s)!==s)throw Error(i(188))}function y(s){var a=s.alternate;if(!a){if(a=u(s),a===null)throw Error(i(188));return a!==s?null:s}for(var o=s,c=a;;){var m=o.return;if(m===null)break;var f=m.alternate;if(f===null){if(c=m.return,c!==null){o=c;continue}break}if(m.child===f.child){for(f=m.child;f;){if(f===o)return g(m),s;if(f===c)return g(m),a;f=f.sibling}throw Error(i(188))}if(o.return!==c.return)o=m,c=f;else{for(var w=!1,N=m.child;N;){if(N===o){w=!0,o=m,c=f;break}if(N===c){w=!0,c=m,o=f;break}N=N.sibling}if(!w){for(N=f.child;N;){if(N===o){w=!0,o=f,c=m;break}if(N===c){w=!0,c=f,o=m;break}N=N.sibling}if(!w)throw Error(i(189))}}if(o.alternate!==c)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?s:a}function x(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s;for(s=s.child;s!==null;){if(a=x(s),a!==null)return a;s=s.sibling}return null}var _=Object.assign,j=Symbol.for("react.element"),O=Symbol.for("react.transitional.element"),$=Symbol.for("react.portal"),V=Symbol.for("react.fragment"),L=Symbol.for("react.strict_mode"),ee=Symbol.for("react.profiler"),Y=Symbol.for("react.consumer"),te=Symbol.for("react.context"),ke=Symbol.for("react.forward_ref"),Te=Symbol.for("react.suspense"),xe=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),S=Symbol.for("react.activity"),D=Symbol.for("react.memo_cache_sentinel"),I=Symbol.iterator;function U(s){return s===null||typeof s!="object"?null:(s=I&&s[I]||s["@@iterator"],typeof s=="function"?s:null)}var M=Symbol.for("react.client.reference");function ze(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===M?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case V:return"Fragment";case ee:return"Profiler";case L:return"StrictMode";case Te:return"Suspense";case xe:return"SuspenseList";case S:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case $:return"Portal";case te:return s.displayName||"Context";case Y:return(s._context.displayName||"Context")+".Consumer";case ke:var a=s.render;return s=s.displayName,s||(s=a.displayName||a.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case R:return a=s.displayName||null,a!==null?a:ze(s.type)||"Memo";case T:a=s._payload,s=s._init;try{return ze(s(a))}catch{}}return null}var gt=Array.isArray,B=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,se=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ge={pending:!1,data:null,method:null,action:null},Re=[],Q=-1;function P(s){return{current:s}}function ae(s){0>Q||(s.current=Re[Q],Re[Q]=null,Q--)}function Be(s,a){Q++,Re[Q]=s.current,s.current=a}var Ue=P(null),Oe=P(null),Ie=P(null),ot=P(null);function yt(s,a){switch(Be(Ie,a),Be(Oe,s),Be(Ue,null),a.nodeType){case 9:case 11:s=(s=a.documentElement)&&(s=s.namespaceURI)?$0(s):0;break;default:if(s=a.tagName,a=a.namespaceURI)a=$0(a),s=W0(a,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}ae(Ue),Be(Ue,s)}function et(){ae(Ue),ae(Oe),ae(Ie)}function Xt(s){s.memoizedState!==null&&Be(ot,s);var a=Ue.current,o=W0(a,s.type);a!==o&&(Be(Oe,s),Be(Ue,o))}function Es(s){Oe.current===s&&(ae(Ue),ae(Oe)),ot.current===s&&(ae(ot),Kc._currentValue=ge)}var Ot,wt;function oe(s){if(Ot===void 0)try{throw Error()}catch(o){var a=o.stack.trim().match(/\n( *(at )?)/);Ot=a&&a[1]||"",wt=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ot+s+wt}var Ct=!1;function kt(s,a){if(!s||Ct)return"";Ct=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(a){var Ve=function(){throw Error()};if(Object.defineProperty(Ve.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ve,[])}catch(we){var me=we}Reflect.construct(s,[],Ve)}else{try{Ve.call()}catch(we){me=we}s.call(Ve.prototype)}}else{try{throw Error()}catch(we){me=we}(Ve=s())&&typeof Ve.catch=="function"&&Ve.catch(function(){})}}catch(we){if(we&&me&&typeof we.stack=="string")return[we.stack,me.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var f=c.DetermineComponentFrameRoot(),w=f[0],N=f[1];if(w&&N){var q=w.split(`
`),de=N.split(`
`);for(m=c=0;c<q.length&&!q[c].includes("DetermineComponentFrameRoot");)c++;for(;m<de.length&&!de[m].includes("DetermineComponentFrameRoot");)m++;if(c===q.length||m===de.length)for(c=q.length-1,m=de.length-1;1<=c&&0<=m&&q[c]!==de[m];)m--;for(;1<=c&&0<=m;c--,m--)if(q[c]!==de[m]){if(c!==1||m!==1)do if(c--,m--,0>m||q[c]!==de[m]){var Ce=`
`+q[c].replace(" at new "," at ");return s.displayName&&Ce.includes("<anonymous>")&&(Ce=Ce.replace("<anonymous>",s.displayName)),Ce}while(1<=c&&0<=m);break}}}finally{Ct=!1,Error.prepareStackTrace=o}return(o=s?s.displayName||s.name:"")?oe(o):""}function zt(s,a){switch(s.tag){case 26:case 27:case 5:return oe(s.type);case 16:return oe("Lazy");case 13:return s.child!==a&&a!==null?oe("Suspense Fallback"):oe("Suspense");case 19:return oe("SuspenseList");case 0:case 15:return kt(s.type,!1);case 11:return kt(s.type.render,!1);case 1:return kt(s.type,!0);case 31:return oe("Activity");default:return""}}function Et(s){try{var a="",o=null;do a+=zt(s,o),o=s,s=s.return;while(s);return a}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var jt=Object.prototype.hasOwnProperty,tt=n.unstable_scheduleCallback,Mt=n.unstable_cancelCallback,qt=n.unstable_shouldYield,ms=n.unstable_requestPaint,Ft=n.unstable_now,At=n.unstable_getCurrentPriorityLevel,us=n.unstable_ImmediatePriority,vs=n.unstable_UserBlockingPriority,as=n.unstable_NormalPriority,nn=n.unstable_LowPriority,Ds=n.unstable_IdlePriority,Hs=n.log,is=n.unstable_setDisableYieldValue,xs=null,ye=null;function Me(s){if(typeof Hs=="function"&&is(s),ye&&typeof ye.setStrictMode=="function")try{ye.setStrictMode(xs,s)}catch{}}var De=Math.clz32?Math.clz32:Xe,Qe=Math.log,He=Math.LN2;function Xe(s){return s>>>=0,s===0?32:31-(Qe(s)/He|0)|0}var ut=256,J=262144,ne=4194304;function $e(s){var a=s&42;if(a!==0)return a;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function bt(s,a,o){var c=s.pendingLanes;if(c===0)return 0;var m=0,f=s.suspendedLanes,w=s.pingedLanes;s=s.warmLanes;var N=c&134217727;return N!==0?(c=N&~f,c!==0?m=$e(c):(w&=N,w!==0?m=$e(w):o||(o=N&~s,o!==0&&(m=$e(o))))):(N=c&~f,N!==0?m=$e(N):w!==0?m=$e(w):o||(o=c&~s,o!==0&&(m=$e(o)))),m===0?0:a!==0&&a!==m&&(a&f)===0&&(f=m&-m,o=a&-a,f>=o||f===32&&(o&4194048)!==0)?a:m}function Ye(s,a){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&a)===0}function vt(s,a){switch(s){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function X(){var s=ne;return ne<<=1,(ne&62914560)===0&&(ne=4194304),s}function Ae(s){for(var a=[],o=0;31>o;o++)a.push(s);return a}function Ge(s,a){s.pendingLanes|=a,a!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function ht(s,a,o,c,m,f){var w=s.pendingLanes;s.pendingLanes=o,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=o,s.entangledLanes&=o,s.errorRecoveryDisabledLanes&=o,s.shellSuspendCounter=0;var N=s.entanglements,q=s.expirationTimes,de=s.hiddenUpdates;for(o=w&~o;0<o;){var Ce=31-De(o),Ve=1<<Ce;N[Ce]=0,q[Ce]=-1;var me=de[Ce];if(me!==null)for(de[Ce]=null,Ce=0;Ce<me.length;Ce++){var we=me[Ce];we!==null&&(we.lane&=-536870913)}o&=~Ve}c!==0&&Je(s,c,0),f!==0&&m===0&&s.tag!==0&&(s.suspendedLanes|=f&~(w&~a))}function Je(s,a,o){s.pendingLanes|=a,s.suspendedLanes&=~a;var c=31-De(a);s.entangledLanes|=a,s.entanglements[c]=s.entanglements[c]|1073741824|o&261930}function Kt(s,a){var o=s.entangledLanes|=a;for(s=s.entanglements;o;){var c=31-De(o),m=1<<c;m&a|s[c]&a&&(s[c]|=a),o&=~m}}function Ht(s,a){var o=a&-a;return o=(o&42)!==0?1:F(o),(o&(s.suspendedLanes|a))!==0?0:o}function F(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function fe(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Se(){var s=se.p;return s!==0?s:(s=window.event,s===void 0?32:p1(s.type))}function Ee(s,a){var o=se.p;try{return se.p=s,a()}finally{se.p=o}}var Ne=Math.random().toString(36).slice(2),mt="__reactFiber$"+Ne,Nt="__reactProps$"+Ne,lt="__reactContainer$"+Ne,Bt="__reactEvents$"+Ne,Dt="__reactListeners$"+Ne,Xs="__reactHandles$"+Ne,vn="__reactResources$"+Ne,mn="__reactMarker$"+Ne;function Nn(s){delete s[mt],delete s[Nt],delete s[Bt],delete s[Dt],delete s[Xs]}function Ks(s){var a=s[mt];if(a)return a;for(var o=s.parentNode;o;){if(a=o[lt]||o[mt]){if(o=a.alternate,a.child!==null||o!==null&&o.child!==null)for(s=Z0(s);s!==null;){if(o=s[mt])return o;s=Z0(s)}return a}s=o,o=s.parentNode}return null}function cn(s){if(s=s[mt]||s[lt]){var a=s.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return s}return null}function Ns(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s.stateNode;throw Error(i(33))}function W(s){var a=s[vn];return a||(a=s[vn]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function he(s){s[mn]=!0}var ce=new Set,_e={};function E(s,a){z(s,a),z(s+"Capture",a)}function z(s,a){for(_e[s]=a,s=0;s<a.length;s++)ce.add(a[s])}var ie=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),re={},Ke={};function rt(s){return jt.call(Ke,s)?!0:jt.call(re,s)?!1:ie.test(s)?Ke[s]=!0:(re[s]=!0,!1)}function st(s,a,o){if(rt(a))if(o===null)s.removeAttribute(a);else{switch(typeof o){case"undefined":case"function":case"symbol":s.removeAttribute(a);return;case"boolean":var c=a.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){s.removeAttribute(a);return}}s.setAttribute(a,""+o)}}function It(s,a,o){if(o===null)s.removeAttribute(a);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(a);return}s.setAttribute(a,""+o)}}function ft(s,a,o,c){if(c===null)s.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttributeNS(a,o,""+c)}}function ds(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function rn(s){var a=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function wr(s,a,o){var c=Object.getOwnPropertyDescriptor(s.constructor.prototype,a);if(!s.hasOwnProperty(a)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var m=c.get,f=c.set;return Object.defineProperty(s,a,{configurable:!0,get:function(){return m.call(this)},set:function(w){o=""+w,f.call(this,w)}}),Object.defineProperty(s,a,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(w){o=""+w},stopTracking:function(){s._valueTracker=null,delete s[a]}}}}function fs(s){if(!s._valueTracker){var a=rn(s)?"checked":"value";s._valueTracker=wr(s,a,""+s[a])}}function Ar(s){if(!s)return!1;var a=s._valueTracker;if(!a)return!0;var o=a.getValue(),c="";return s&&(c=rn(s)?s.checked?"true":"false":s.value),s=c,s!==o?(a.setValue(s),!0):!1}function Mn(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var G=/[\n"\\]/g;function ve(s){return s.replace(G,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function je(s,a,o,c,m,f,w,N){s.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?s.type=w:s.removeAttribute("type"),a!=null?w==="number"?(a===0&&s.value===""||s.value!=a)&&(s.value=""+ds(a)):s.value!==""+ds(a)&&(s.value=""+ds(a)):w!=="submit"&&w!=="reset"||s.removeAttribute("value"),a!=null?at(s,w,ds(a)):o!=null?at(s,w,ds(o)):c!=null&&s.removeAttribute("value"),m==null&&f!=null&&(s.defaultChecked=!!f),m!=null&&(s.checked=m&&typeof m!="function"&&typeof m!="symbol"),N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?s.name=""+ds(N):s.removeAttribute("name")}function it(s,a,o,c,m,f,w,N){if(f!=null&&typeof f!="function"&&typeof f!="symbol"&&typeof f!="boolean"&&(s.type=f),a!=null||o!=null){if(!(f!=="submit"&&f!=="reset"||a!=null)){fs(s);return}o=o!=null?""+ds(o):"",a=a!=null?""+ds(a):o,N||a===s.value||(s.value=a),s.defaultValue=a}c=c??m,c=typeof c!="function"&&typeof c!="symbol"&&!!c,s.checked=N?s.checked:!!c,s.defaultChecked=!!c,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(s.name=w),fs(s)}function at(s,a,o){a==="number"&&Mn(s.ownerDocument)===s||s.defaultValue===""+o||(s.defaultValue=""+o)}function pt(s,a,o,c){if(s=s.options,a){a={};for(var m=0;m<o.length;m++)a["$"+o[m]]=!0;for(o=0;o<s.length;o++)m=a.hasOwnProperty("$"+s[o].value),s[o].selected!==m&&(s[o].selected=m),m&&c&&(s[o].defaultSelected=!0)}else{for(o=""+ds(o),a=null,m=0;m<s.length;m++){if(s[m].value===o){s[m].selected=!0,c&&(s[m].defaultSelected=!0);return}a!==null||s[m].disabled||(a=s[m])}a!==null&&(a.selected=!0)}}function Yt(s,a,o){if(a!=null&&(a=""+ds(a),a!==s.value&&(s.value=a),o==null)){s.defaultValue!==a&&(s.defaultValue=a);return}s.defaultValue=o!=null?""+ds(o):""}function Qt(s,a,o,c){if(a==null){if(c!=null){if(o!=null)throw Error(i(92));if(gt(c)){if(1<c.length)throw Error(i(93));c=c[0]}o=c}o==null&&(o=""),a=o}o=ds(a),s.defaultValue=o,c=s.textContent,c===o&&c!==""&&c!==null&&(s.value=c),fs(s)}function Jt(s,a){if(a){var o=s.firstChild;if(o&&o===s.lastChild&&o.nodeType===3){o.nodeValue=a;return}}s.textContent=a}var Dn=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function os(s,a,o){var c=a.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?s.setProperty(a,""):a==="float"?s.cssFloat="":s[a]="":c?s.setProperty(a,o):typeof o!="number"||o===0||Dn.has(a)?a==="float"?s.cssFloat=o:s[a]=(""+o).trim():s[a]=o+"px"}function Ss(s,a,o){if(a!=null&&typeof a!="object")throw Error(i(62));if(s=s.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||a!=null&&a.hasOwnProperty(c)||(c.indexOf("--")===0?s.setProperty(c,""):c==="float"?s.cssFloat="":s[c]="");for(var m in a)c=a[m],a.hasOwnProperty(m)&&o[m]!==c&&os(s,m,c)}else for(var f in a)a.hasOwnProperty(f)&&os(s,f,a[f])}function xn(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var er=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ps=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function $s(s){return Ps.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Zt(){}var Ls=null;function on(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var tr=null,zn=null;function Sn(s){var a=cn(s);if(a&&(s=a.stateNode)){var o=s[Nt]||null;e:switch(s=a.stateNode,a.type){case"input":if(je(s,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),a=o.name,o.type==="radio"&&a!=null){for(o=s;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+ve(""+a)+'"][type="radio"]'),a=0;a<o.length;a++){var c=o[a];if(c!==s&&c.form===s.form){var m=c[Nt]||null;if(!m)throw Error(i(90));je(c,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(a=0;a<o.length;a++)c=o[a],c.form===s.form&&Ar(c)}break e;case"textarea":Yt(s,o.value,o.defaultValue);break e;case"select":a=o.value,a!=null&&pt(s,!!o.multiple,a,!1)}}}var Kn=!1;function hr(s,a,o){if(Kn)return s(a,o);Kn=!0;try{var c=s(a);return c}finally{if(Kn=!1,(tr!==null||zn!==null)&&(Md(),tr&&(a=tr,s=zn,zn=tr=null,Sn(a),s)))for(a=0;a<s.length;a++)Sn(s[a])}}function Yn(s,a){var o=s.stateNode;if(o===null)return null;var c=o[Nt]||null;if(c===null)return null;o=c[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(s=s.type,c=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!c;break e;default:s=!1}if(s)return null;if(o&&typeof o!="function")throw Error(i(231,a,typeof o));return o}var mr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ir=!1;if(mr)try{var Ws={};Object.defineProperty(Ws,"passive",{get:function(){Ir=!0}}),window.addEventListener("test",Ws,Ws),window.removeEventListener("test",Ws,Ws)}catch{Ir=!1}var na=null,_o=null,Xa=null;function ko(){if(Xa)return Xa;var s,a=_o,o=a.length,c,m="value"in na?na.value:na.textContent,f=m.length;for(s=0;s<o&&a[s]===m[s];s++);var w=o-s;for(c=1;c<=w&&a[o-c]===m[f-c];c++);return Xa=m.slice(s,1<c?1-c:void 0)}function C(s){var a=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&a===13&&(s=13)):s=a,s===10&&(s=13),32<=s||s===13?s:0}function K(){return!0}function qe(){return!1}function Ze(s){function a(o,c,m,f,w){this._reactName=o,this._targetInst=m,this.type=c,this.nativeEvent=f,this.target=w,this.currentTarget=null;for(var N in s)s.hasOwnProperty(N)&&(o=s[N],this[N]=o?o(f):f[N]);return this.isDefaultPrevented=(f.defaultPrevented!=null?f.defaultPrevented:f.returnValue===!1)?K:qe,this.isPropagationStopped=qe,this}return _(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=K)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=K)},persist:function(){},isPersistent:K}),a}var _t={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Vt=Ze(_t),dt=_({},_t,{view:0,detail:0}),es=Ze(dt),ss,Cs,ps,Bs=_({},dt,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ma,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==ps&&(ps&&s.type==="mousemove"?(ss=s.screenX-ps.screenX,Cs=s.screenY-ps.screenY):Cs=ss=0,ps=s),ss)},movementY:function(s){return"movementY"in s?s.movementY:Cs}}),Hr=Ze(Bs),Mr=_({},Bs,{dataTransfer:0}),un=Ze(Mr),yn=_({},dt,{relatedTarget:0}),qn=Ze(yn),Qn=_({},_t,{animationName:0,elapsedTime:0,pseudoElement:0}),sr=Ze(Qn),nr=_({},_t,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Dr=Ze(nr),_r=_({},_t,{data:0}),wn=Ze(_r),Hn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Pr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Lr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jo(s){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(s):(s=Lr[s])?!!a[s]:!1}function Ma(){return jo}var rr=_({},dt,{key:function(s){if(s.key){var a=Hn[s.key]||s.key;if(a!=="Unidentified")return a}return s.type==="keypress"?(s=C(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Pr[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ma,charCode:function(s){return s.type==="keypress"?C(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?C(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Ja=Ze(rr),ya=_({},Bs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),fr=Ze(ya),h=_({},dt,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ma}),v=Ze(h),k=_({},_t,{propertyName:0,elapsedTime:0,pseudoElement:0}),A=Ze(k),le=_({},Bs,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),be=Ze(le),nt=_({},_t,{newState:0,oldState:0}),ls=Ze(nt),Cn=[9,13,27,32],zs=mr&&"CompositionEvent"in window,fn=null;mr&&"documentMode"in document&&(fn=document.documentMode);var ra=mr&&"TextEvent"in window&&!fn,Da=mr&&(!zs||fn&&8<fn&&11>=fn),ba=" ",va=!1;function To(s,a){switch(s){case"keyup":return Cn.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ll(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var cl=!1;function Xk(s,a){switch(s){case"compositionend":return ll(a);case"keypress":return a.which!==32?null:(va=!0,ba);case"textInput":return s=a.data,s===ba&&va?null:s;default:return null}}function Jk(s,a){if(cl)return s==="compositionend"||!zs&&To(s,a)?(s=ko(),Xa=_o=na=null,cl=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Da&&a.locale!=="ko"?null:a.data;default:return null}}var Zk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sb(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a==="input"?!!Zk[s.type]:a==="textarea"}function nb(s,a,o,c){tr?zn?zn.push(c):zn=[c]:tr=c,a=Ud(a,"onChange"),0<a.length&&(o=new Vt("onChange","change",null,o,c),s.push({event:o,listeners:a}))}var gc=null,yc=null;function ej(s){V0(s,0)}function Ju(s){var a=Ns(s);if(Ar(a))return s}function rb(s,a){if(s==="change")return a}var ab=!1;if(mr){var Em;if(mr){var Nm="oninput"in document;if(!Nm){var ib=document.createElement("div");ib.setAttribute("oninput","return;"),Nm=typeof ib.oninput=="function"}Em=Nm}else Em=!1;ab=Em&&(!document.documentMode||9<document.documentMode)}function ob(){gc&&(gc.detachEvent("onpropertychange",lb),yc=gc=null)}function lb(s){if(s.propertyName==="value"&&Ju(yc)){var a=[];nb(a,yc,s,on(s)),hr(ej,a)}}function tj(s,a,o){s==="focusin"?(ob(),gc=a,yc=o,gc.attachEvent("onpropertychange",lb)):s==="focusout"&&ob()}function sj(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Ju(yc)}function nj(s,a){if(s==="click")return Ju(a)}function rj(s,a){if(s==="input"||s==="change")return Ju(a)}function aj(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var $r=typeof Object.is=="function"?Object.is:aj;function bc(s,a){if($r(s,a))return!0;if(typeof s!="object"||s===null||typeof a!="object"||a===null)return!1;var o=Object.keys(s),c=Object.keys(a);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var m=o[c];if(!jt.call(a,m)||!$r(s[m],a[m]))return!1}return!0}function cb(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function ub(s,a){var o=cb(s);s=0;for(var c;o;){if(o.nodeType===3){if(c=s+o.textContent.length,s<=a&&c>=a)return{node:o,offset:a-s};s=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=cb(o)}}function db(s,a){return s&&a?s===a?!0:s&&s.nodeType===3?!1:a&&a.nodeType===3?db(s,a.parentNode):"contains"in s?s.contains(a):s.compareDocumentPosition?!!(s.compareDocumentPosition(a)&16):!1:!1}function hb(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var a=Mn(s.document);a instanceof s.HTMLIFrameElement;){try{var o=typeof a.contentWindow.location.href=="string"}catch{o=!1}if(o)s=a.contentWindow;else break;a=Mn(s.document)}return a}function Sm(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a&&(a==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||a==="textarea"||s.contentEditable==="true")}var ij=mr&&"documentMode"in document&&11>=document.documentMode,ul=null,Cm=null,vc=null,Rm=!1;function mb(s,a,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Rm||ul==null||ul!==Mn(c)||(c=ul,"selectionStart"in c&&Sm(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),vc&&bc(vc,c)||(vc=c,c=Ud(Cm,"onSelect"),0<c.length&&(a=new Vt("onSelect","select",null,a,o),s.push({event:a,listeners:c}),a.target=ul)))}function Eo(s,a){var o={};return o[s.toLowerCase()]=a.toLowerCase(),o["Webkit"+s]="webkit"+a,o["Moz"+s]="moz"+a,o}var dl={animationend:Eo("Animation","AnimationEnd"),animationiteration:Eo("Animation","AnimationIteration"),animationstart:Eo("Animation","AnimationStart"),transitionrun:Eo("Transition","TransitionRun"),transitionstart:Eo("Transition","TransitionStart"),transitioncancel:Eo("Transition","TransitionCancel"),transitionend:Eo("Transition","TransitionEnd")},Am={},fb={};mr&&(fb=document.createElement("div").style,"AnimationEvent"in window||(delete dl.animationend.animation,delete dl.animationiteration.animation,delete dl.animationstart.animation),"TransitionEvent"in window||delete dl.transitionend.transition);function No(s){if(Am[s])return Am[s];if(!dl[s])return s;var a=dl[s],o;for(o in a)if(a.hasOwnProperty(o)&&o in fb)return Am[s]=a[o];return s}var pb=No("animationend"),gb=No("animationiteration"),yb=No("animationstart"),oj=No("transitionrun"),lj=No("transitionstart"),cj=No("transitioncancel"),bb=No("transitionend"),vb=new Map,Im="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Im.push("scrollEnd");function xa(s,a){vb.set(s,a),E(a,[s])}var Zu=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},aa=[],hl=0,Mm=0;function ed(){for(var s=hl,a=Mm=hl=0;a<s;){var o=aa[a];aa[a++]=null;var c=aa[a];aa[a++]=null;var m=aa[a];aa[a++]=null;var f=aa[a];if(aa[a++]=null,c!==null&&m!==null){var w=c.pending;w===null?m.next=m:(m.next=w.next,w.next=m),c.pending=m}f!==0&&xb(o,m,f)}}function td(s,a,o,c){aa[hl++]=s,aa[hl++]=a,aa[hl++]=o,aa[hl++]=c,Mm|=c,s.lanes|=c,s=s.alternate,s!==null&&(s.lanes|=c)}function Dm(s,a,o,c){return td(s,a,o,c),sd(s)}function So(s,a){return td(s,null,null,a),sd(s)}function xb(s,a,o){s.lanes|=o;var c=s.alternate;c!==null&&(c.lanes|=o);for(var m=!1,f=s.return;f!==null;)f.childLanes|=o,c=f.alternate,c!==null&&(c.childLanes|=o),f.tag===22&&(s=f.stateNode,s===null||s._visibility&1||(m=!0)),s=f,f=f.return;return s.tag===3?(f=s.stateNode,m&&a!==null&&(m=31-De(o),s=f.hiddenUpdates,c=s[m],c===null?s[m]=[a]:c.push(a),a.lane=o|536870912),f):null}function sd(s){if(50<Fc)throw Fc=0,Hf=null,Error(i(185));for(var a=s.return;a!==null;)s=a,a=s.return;return s.tag===3?s.stateNode:null}var ml={};function uj(s,a,o,c){this.tag=s,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Wr(s,a,o,c){return new uj(s,a,o,c)}function Pm(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Za(s,a){var o=s.alternate;return o===null?(o=Wr(s.tag,a,s.key,s.mode),o.elementType=s.elementType,o.type=s.type,o.stateNode=s.stateNode,o.alternate=s,s.alternate=o):(o.pendingProps=a,o.type=s.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=s.flags&65011712,o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,a=s.dependencies,o.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},o.sibling=s.sibling,o.index=s.index,o.ref=s.ref,o.refCleanup=s.refCleanup,o}function wb(s,a){s.flags&=65011714;var o=s.alternate;return o===null?(s.childLanes=0,s.lanes=a,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,a=o.dependencies,s.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),s}function nd(s,a,o,c,m,f){var w=0;if(c=s,typeof s=="function")Pm(s)&&(w=1);else if(typeof s=="string")w=pT(s,o,Ue.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case S:return s=Wr(31,o,a,m),s.elementType=S,s.lanes=f,s;case V:return Co(o.children,m,f,a);case L:w=8,m|=24;break;case ee:return s=Wr(12,o,a,m|2),s.elementType=ee,s.lanes=f,s;case Te:return s=Wr(13,o,a,m),s.elementType=Te,s.lanes=f,s;case xe:return s=Wr(19,o,a,m),s.elementType=xe,s.lanes=f,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case te:w=10;break e;case Y:w=9;break e;case ke:w=11;break e;case R:w=14;break e;case T:w=16,c=null;break e}w=29,o=Error(i(130,s===null?"null":typeof s,"")),c=null}return a=Wr(w,o,a,m),a.elementType=s,a.type=c,a.lanes=f,a}function Co(s,a,o,c){return s=Wr(7,s,c,a),s.lanes=o,s}function Lm(s,a,o){return s=Wr(6,s,null,a),s.lanes=o,s}function _b(s){var a=Wr(18,null,null,0);return a.stateNode=s,a}function Om(s,a,o){return a=Wr(4,s.children!==null?s.children:[],s.key,a),a.lanes=o,a.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},a}var kb=new WeakMap;function ia(s,a){if(typeof s=="object"&&s!==null){var o=kb.get(s);return o!==void 0?o:(a={value:s,source:a,stack:Et(a)},kb.set(s,a),a)}return{value:s,source:a,stack:Et(a)}}var fl=[],pl=0,rd=null,xc=0,oa=[],la=0,Ci=null,Pa=1,La="";function ei(s,a){fl[pl++]=xc,fl[pl++]=rd,rd=s,xc=a}function jb(s,a,o){oa[la++]=Pa,oa[la++]=La,oa[la++]=Ci,Ci=s;var c=Pa;s=La;var m=32-De(c)-1;c&=~(1<<m),o+=1;var f=32-De(a)+m;if(30<f){var w=m-m%5;f=(c&(1<<w)-1).toString(32),c>>=w,m-=w,Pa=1<<32-De(a)+m|o<<m|c,La=f+s}else Pa=1<<f|o<<m|c,La=s}function Bm(s){s.return!==null&&(ei(s,1),jb(s,1,0))}function Vm(s){for(;s===rd;)rd=fl[--pl],fl[pl]=null,xc=fl[--pl],fl[pl]=null;for(;s===Ci;)Ci=oa[--la],oa[la]=null,La=oa[--la],oa[la]=null,Pa=oa[--la],oa[la]=null}function Tb(s,a){oa[la++]=Pa,oa[la++]=La,oa[la++]=Ci,Pa=a.id,La=a.overflow,Ci=s}var ar=null,dn=null,Rs=!1,Ri=null,ca=!1,Um=Error(i(519));function Ai(s){var a=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw wc(ia(a,s)),Um}function Eb(s){var a=s.stateNode,o=s.type,c=s.memoizedProps;switch(a[mt]=s,a[Nt]=c,o){case"dialog":ys("cancel",a),ys("close",a);break;case"iframe":case"object":case"embed":ys("load",a);break;case"video":case"audio":for(o=0;o<qc.length;o++)ys(qc[o],a);break;case"source":ys("error",a);break;case"img":case"image":case"link":ys("error",a),ys("load",a);break;case"details":ys("toggle",a);break;case"input":ys("invalid",a),it(a,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":ys("invalid",a);break;case"textarea":ys("invalid",a),Qt(a,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||a.textContent===""+o||c.suppressHydrationWarning===!0||q0(a.textContent,o)?(c.popover!=null&&(ys("beforetoggle",a),ys("toggle",a)),c.onScroll!=null&&ys("scroll",a),c.onScrollEnd!=null&&ys("scrollend",a),c.onClick!=null&&(a.onclick=Zt),a=!0):a=!1,a||Ai(s,!0)}function Nb(s){for(ar=s.return;ar;)switch(ar.tag){case 5:case 31:case 13:ca=!1;return;case 27:case 3:ca=!0;return;default:ar=ar.return}}function gl(s){if(s!==ar)return!1;if(!Rs)return Nb(s),Rs=!0,!1;var a=s.tag,o;if((o=a!==3&&a!==27)&&((o=a===5)&&(o=s.type,o=!(o!=="form"&&o!=="button")||ap(s.type,s.memoizedProps)),o=!o),o&&dn&&Ai(s),Nb(s),a===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));dn=J0(s)}else if(a===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));dn=J0(s)}else a===27?(a=dn,$i(s.type)?(s=up,up=null,dn=s):dn=a):dn=ar?da(s.stateNode.nextSibling):null;return!0}function Ro(){dn=ar=null,Rs=!1}function Fm(){var s=Ri;return s!==null&&(Ur===null?Ur=s:Ur.push.apply(Ur,s),Ri=null),s}function wc(s){Ri===null?Ri=[s]:Ri.push(s)}var zm=P(null),Ao=null,ti=null;function Ii(s,a,o){Be(zm,a._currentValue),a._currentValue=o}function si(s){s._currentValue=zm.current,ae(zm)}function qm(s,a,o){for(;s!==null;){var c=s.alternate;if((s.childLanes&a)!==a?(s.childLanes|=a,c!==null&&(c.childLanes|=a)):c!==null&&(c.childLanes&a)!==a&&(c.childLanes|=a),s===o)break;s=s.return}}function Hm(s,a,o,c){var m=s.child;for(m!==null&&(m.return=s);m!==null;){var f=m.dependencies;if(f!==null){var w=m.child;f=f.firstContext;e:for(;f!==null;){var N=f;f=m;for(var q=0;q<a.length;q++)if(N.context===a[q]){f.lanes|=o,N=f.alternate,N!==null&&(N.lanes|=o),qm(f.return,o,s),c||(w=null);break e}f=N.next}}else if(m.tag===18){if(w=m.return,w===null)throw Error(i(341));w.lanes|=o,f=w.alternate,f!==null&&(f.lanes|=o),qm(w,o,s),w=null}else w=m.child;if(w!==null)w.return=m;else for(w=m;w!==null;){if(w===s){w=null;break}if(m=w.sibling,m!==null){m.return=w.return,w=m;break}w=w.return}m=w}}function yl(s,a,o,c){s=null;for(var m=a,f=!1;m!==null;){if(!f){if((m.flags&524288)!==0)f=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var w=m.alternate;if(w===null)throw Error(i(387));if(w=w.memoizedProps,w!==null){var N=m.type;$r(m.pendingProps.value,w.value)||(s!==null?s.push(N):s=[N])}}else if(m===ot.current){if(w=m.alternate,w===null)throw Error(i(387));w.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(s!==null?s.push(Kc):s=[Kc])}m=m.return}s!==null&&Hm(a,s,o,c),a.flags|=262144}function ad(s){for(s=s.firstContext;s!==null;){if(!$r(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Io(s){Ao=s,ti=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function ir(s){return Sb(Ao,s)}function id(s,a){return Ao===null&&Io(s),Sb(s,a)}function Sb(s,a){var o=a._currentValue;if(a={context:a,memoizedValue:o,next:null},ti===null){if(s===null)throw Error(i(308));ti=a,s.dependencies={lanes:0,firstContext:a},s.flags|=524288}else ti=ti.next=a;return o}var dj=typeof AbortController<"u"?AbortController:function(){var s=[],a=this.signal={aborted:!1,addEventListener:function(o,c){s.push(c)}};this.abort=function(){a.aborted=!0,s.forEach(function(o){return o()})}},hj=n.unstable_scheduleCallback,mj=n.unstable_NormalPriority,Pn={$$typeof:te,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function $m(){return{controller:new dj,data:new Map,refCount:0}}function _c(s){s.refCount--,s.refCount===0&&hj(mj,function(){s.controller.abort()})}var kc=null,Wm=0,bl=0,vl=null;function fj(s,a){if(kc===null){var o=kc=[];Wm=0,bl=Qf(),vl={status:"pending",value:void 0,then:function(c){o.push(c)}}}return Wm++,a.then(Cb,Cb),a}function Cb(){if(--Wm===0&&kc!==null){vl!==null&&(vl.status="fulfilled");var s=kc;kc=null,bl=0,vl=null;for(var a=0;a<s.length;a++)(0,s[a])()}}function pj(s,a){var o=[],c={status:"pending",value:null,reason:null,then:function(m){o.push(m)}};return s.then(function(){c.status="fulfilled",c.value=a;for(var m=0;m<o.length;m++)(0,o[m])(a)},function(m){for(c.status="rejected",c.reason=m,m=0;m<o.length;m++)(0,o[m])(void 0)}),c}var Rb=B.S;B.S=function(s,a){m0=Ft(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&fj(s,a),Rb!==null&&Rb(s,a)};var Mo=P(null);function Gm(){var s=Mo.current;return s!==null?s:an.pooledCache}function od(s,a){a===null?Be(Mo,Mo.current):Be(Mo,a.pool)}function Ab(){var s=Gm();return s===null?null:{parent:Pn._currentValue,pool:s}}var xl=Error(i(460)),Km=Error(i(474)),ld=Error(i(542)),cd={then:function(){}};function Ib(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Mb(s,a,o){switch(o=s[o],o===void 0?s.push(a):o!==a&&(a.then(Zt,Zt),a=o),a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,Pb(s),s;default:if(typeof a.status=="string")a.then(Zt,Zt);else{if(s=an,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=a,s.status="pending",s.then(function(c){if(a.status==="pending"){var m=a;m.status="fulfilled",m.value=c}},function(c){if(a.status==="pending"){var m=a;m.status="rejected",m.reason=c}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,Pb(s),s}throw Po=a,xl}}function Do(s){try{var a=s._init;return a(s._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(Po=o,xl):o}}var Po=null;function Db(){if(Po===null)throw Error(i(459));var s=Po;return Po=null,s}function Pb(s){if(s===xl||s===ld)throw Error(i(483))}var wl=null,jc=0;function ud(s){var a=jc;return jc+=1,wl===null&&(wl=[]),Mb(wl,s,a)}function Tc(s,a){a=a.props.ref,s.ref=a!==void 0?a:null}function dd(s,a){throw a.$$typeof===j?Error(i(525)):(s=Object.prototype.toString.call(a),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":s)))}function Lb(s){function a(Z,H){if(s){var ue=Z.deletions;ue===null?(Z.deletions=[H],Z.flags|=16):ue.push(H)}}function o(Z,H){if(!s)return null;for(;H!==null;)a(Z,H),H=H.sibling;return null}function c(Z){for(var H=new Map;Z!==null;)Z.key!==null?H.set(Z.key,Z):H.set(Z.index,Z),Z=Z.sibling;return H}function m(Z,H){return Z=Za(Z,H),Z.index=0,Z.sibling=null,Z}function f(Z,H,ue){return Z.index=ue,s?(ue=Z.alternate,ue!==null?(ue=ue.index,ue<H?(Z.flags|=67108866,H):ue):(Z.flags|=67108866,H)):(Z.flags|=1048576,H)}function w(Z){return s&&Z.alternate===null&&(Z.flags|=67108866),Z}function N(Z,H,ue,Le){return H===null||H.tag!==6?(H=Lm(ue,Z.mode,Le),H.return=Z,H):(H=m(H,ue),H.return=Z,H)}function q(Z,H,ue,Le){var Pt=ue.type;return Pt===V?Ce(Z,H,ue.props.children,Le,ue.key):H!==null&&(H.elementType===Pt||typeof Pt=="object"&&Pt!==null&&Pt.$$typeof===T&&Do(Pt)===H.type)?(H=m(H,ue.props),Tc(H,ue),H.return=Z,H):(H=nd(ue.type,ue.key,ue.props,null,Z.mode,Le),Tc(H,ue),H.return=Z,H)}function de(Z,H,ue,Le){return H===null||H.tag!==4||H.stateNode.containerInfo!==ue.containerInfo||H.stateNode.implementation!==ue.implementation?(H=Om(ue,Z.mode,Le),H.return=Z,H):(H=m(H,ue.children||[]),H.return=Z,H)}function Ce(Z,H,ue,Le,Pt){return H===null||H.tag!==7?(H=Co(ue,Z.mode,Le,Pt),H.return=Z,H):(H=m(H,ue),H.return=Z,H)}function Ve(Z,H,ue){if(typeof H=="string"&&H!==""||typeof H=="number"||typeof H=="bigint")return H=Lm(""+H,Z.mode,ue),H.return=Z,H;if(typeof H=="object"&&H!==null){switch(H.$$typeof){case O:return ue=nd(H.type,H.key,H.props,null,Z.mode,ue),Tc(ue,H),ue.return=Z,ue;case $:return H=Om(H,Z.mode,ue),H.return=Z,H;case T:return H=Do(H),Ve(Z,H,ue)}if(gt(H)||U(H))return H=Co(H,Z.mode,ue,null),H.return=Z,H;if(typeof H.then=="function")return Ve(Z,ud(H),ue);if(H.$$typeof===te)return Ve(Z,id(Z,H),ue);dd(Z,H)}return null}function me(Z,H,ue,Le){var Pt=H!==null?H.key:null;if(typeof ue=="string"&&ue!==""||typeof ue=="number"||typeof ue=="bigint")return Pt!==null?null:N(Z,H,""+ue,Le);if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case O:return ue.key===Pt?q(Z,H,ue,Le):null;case $:return ue.key===Pt?de(Z,H,ue,Le):null;case T:return ue=Do(ue),me(Z,H,ue,Le)}if(gt(ue)||U(ue))return Pt!==null?null:Ce(Z,H,ue,Le,null);if(typeof ue.then=="function")return me(Z,H,ud(ue),Le);if(ue.$$typeof===te)return me(Z,H,id(Z,ue),Le);dd(Z,ue)}return null}function we(Z,H,ue,Le,Pt){if(typeof Le=="string"&&Le!==""||typeof Le=="number"||typeof Le=="bigint")return Z=Z.get(ue)||null,N(H,Z,""+Le,Pt);if(typeof Le=="object"&&Le!==null){switch(Le.$$typeof){case O:return Z=Z.get(Le.key===null?ue:Le.key)||null,q(H,Z,Le,Pt);case $:return Z=Z.get(Le.key===null?ue:Le.key)||null,de(H,Z,Le,Pt);case T:return Le=Do(Le),we(Z,H,ue,Le,Pt)}if(gt(Le)||U(Le))return Z=Z.get(ue)||null,Ce(H,Z,Le,Pt,null);if(typeof Le.then=="function")return we(Z,H,ue,ud(Le),Pt);if(Le.$$typeof===te)return we(Z,H,ue,id(H,Le),Pt);dd(H,Le)}return null}function Tt(Z,H,ue,Le){for(var Pt=null,Vs=null,St=H,hs=H=0,_s=null;St!==null&&hs<ue.length;hs++){St.index>hs?(_s=St,St=null):_s=St.sibling;var Us=me(Z,St,ue[hs],Le);if(Us===null){St===null&&(St=_s);break}s&&St&&Us.alternate===null&&a(Z,St),H=f(Us,H,hs),Vs===null?Pt=Us:Vs.sibling=Us,Vs=Us,St=_s}if(hs===ue.length)return o(Z,St),Rs&&ei(Z,hs),Pt;if(St===null){for(;hs<ue.length;hs++)St=Ve(Z,ue[hs],Le),St!==null&&(H=f(St,H,hs),Vs===null?Pt=St:Vs.sibling=St,Vs=St);return Rs&&ei(Z,hs),Pt}for(St=c(St);hs<ue.length;hs++)_s=we(St,Z,hs,ue[hs],Le),_s!==null&&(s&&_s.alternate!==null&&St.delete(_s.key===null?hs:_s.key),H=f(_s,H,hs),Vs===null?Pt=_s:Vs.sibling=_s,Vs=_s);return s&&St.forEach(function(Qi){return a(Z,Qi)}),Rs&&ei(Z,hs),Pt}function Ut(Z,H,ue,Le){if(ue==null)throw Error(i(151));for(var Pt=null,Vs=null,St=H,hs=H=0,_s=null,Us=ue.next();St!==null&&!Us.done;hs++,Us=ue.next()){St.index>hs?(_s=St,St=null):_s=St.sibling;var Qi=me(Z,St,Us.value,Le);if(Qi===null){St===null&&(St=_s);break}s&&St&&Qi.alternate===null&&a(Z,St),H=f(Qi,H,hs),Vs===null?Pt=Qi:Vs.sibling=Qi,Vs=Qi,St=_s}if(Us.done)return o(Z,St),Rs&&ei(Z,hs),Pt;if(St===null){for(;!Us.done;hs++,Us=ue.next())Us=Ve(Z,Us.value,Le),Us!==null&&(H=f(Us,H,hs),Vs===null?Pt=Us:Vs.sibling=Us,Vs=Us);return Rs&&ei(Z,hs),Pt}for(St=c(St);!Us.done;hs++,Us=ue.next())Us=we(St,Z,hs,Us.value,Le),Us!==null&&(s&&Us.alternate!==null&&St.delete(Us.key===null?hs:Us.key),H=f(Us,H,hs),Vs===null?Pt=Us:Vs.sibling=Us,Vs=Us);return s&&St.forEach(function(ET){return a(Z,ET)}),Rs&&ei(Z,hs),Pt}function en(Z,H,ue,Le){if(typeof ue=="object"&&ue!==null&&ue.type===V&&ue.key===null&&(ue=ue.props.children),typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case O:e:{for(var Pt=ue.key;H!==null;){if(H.key===Pt){if(Pt=ue.type,Pt===V){if(H.tag===7){o(Z,H.sibling),Le=m(H,ue.props.children),Le.return=Z,Z=Le;break e}}else if(H.elementType===Pt||typeof Pt=="object"&&Pt!==null&&Pt.$$typeof===T&&Do(Pt)===H.type){o(Z,H.sibling),Le=m(H,ue.props),Tc(Le,ue),Le.return=Z,Z=Le;break e}o(Z,H);break}else a(Z,H);H=H.sibling}ue.type===V?(Le=Co(ue.props.children,Z.mode,Le,ue.key),Le.return=Z,Z=Le):(Le=nd(ue.type,ue.key,ue.props,null,Z.mode,Le),Tc(Le,ue),Le.return=Z,Z=Le)}return w(Z);case $:e:{for(Pt=ue.key;H!==null;){if(H.key===Pt)if(H.tag===4&&H.stateNode.containerInfo===ue.containerInfo&&H.stateNode.implementation===ue.implementation){o(Z,H.sibling),Le=m(H,ue.children||[]),Le.return=Z,Z=Le;break e}else{o(Z,H);break}else a(Z,H);H=H.sibling}Le=Om(ue,Z.mode,Le),Le.return=Z,Z=Le}return w(Z);case T:return ue=Do(ue),en(Z,H,ue,Le)}if(gt(ue))return Tt(Z,H,ue,Le);if(U(ue)){if(Pt=U(ue),typeof Pt!="function")throw Error(i(150));return ue=Pt.call(ue),Ut(Z,H,ue,Le)}if(typeof ue.then=="function")return en(Z,H,ud(ue),Le);if(ue.$$typeof===te)return en(Z,H,id(Z,ue),Le);dd(Z,ue)}return typeof ue=="string"&&ue!==""||typeof ue=="number"||typeof ue=="bigint"?(ue=""+ue,H!==null&&H.tag===6?(o(Z,H.sibling),Le=m(H,ue),Le.return=Z,Z=Le):(o(Z,H),Le=Lm(ue,Z.mode,Le),Le.return=Z,Z=Le),w(Z)):o(Z,H)}return function(Z,H,ue,Le){try{jc=0;var Pt=en(Z,H,ue,Le);return wl=null,Pt}catch(St){if(St===xl||St===ld)throw St;var Vs=Wr(29,St,null,Z.mode);return Vs.lanes=Le,Vs.return=Z,Vs}}}var Lo=Lb(!0),Ob=Lb(!1),Mi=!1;function Ym(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Qm(s,a){s=s.updateQueue,a.updateQueue===s&&(a.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Di(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Pi(s,a,o){var c=s.updateQueue;if(c===null)return null;if(c=c.shared,(qs&2)!==0){var m=c.pending;return m===null?a.next=a:(a.next=m.next,m.next=a),c.pending=a,a=sd(s),xb(s,null,o),a}return td(s,c,a,o),sd(s)}function Ec(s,a,o){if(a=a.updateQueue,a!==null&&(a=a.shared,(o&4194048)!==0)){var c=a.lanes;c&=s.pendingLanes,o|=c,a.lanes=o,Kt(s,o)}}function Xm(s,a){var o=s.updateQueue,c=s.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var m=null,f=null;if(o=o.firstBaseUpdate,o!==null){do{var w={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};f===null?m=f=w:f=f.next=w,o=o.next}while(o!==null);f===null?m=f=a:f=f.next=a}else m=f=a;o={baseState:c.baseState,firstBaseUpdate:m,lastBaseUpdate:f,shared:c.shared,callbacks:c.callbacks},s.updateQueue=o;return}s=o.lastBaseUpdate,s===null?o.firstBaseUpdate=a:s.next=a,o.lastBaseUpdate=a}var Jm=!1;function Nc(){if(Jm){var s=vl;if(s!==null)throw s}}function Sc(s,a,o,c){Jm=!1;var m=s.updateQueue;Mi=!1;var f=m.firstBaseUpdate,w=m.lastBaseUpdate,N=m.shared.pending;if(N!==null){m.shared.pending=null;var q=N,de=q.next;q.next=null,w===null?f=de:w.next=de,w=q;var Ce=s.alternate;Ce!==null&&(Ce=Ce.updateQueue,N=Ce.lastBaseUpdate,N!==w&&(N===null?Ce.firstBaseUpdate=de:N.next=de,Ce.lastBaseUpdate=q))}if(f!==null){var Ve=m.baseState;w=0,Ce=de=q=null,N=f;do{var me=N.lane&-536870913,we=me!==N.lane;if(we?(ws&me)===me:(c&me)===me){me!==0&&me===bl&&(Jm=!0),Ce!==null&&(Ce=Ce.next={lane:0,tag:N.tag,payload:N.payload,callback:null,next:null});e:{var Tt=s,Ut=N;me=a;var en=o;switch(Ut.tag){case 1:if(Tt=Ut.payload,typeof Tt=="function"){Ve=Tt.call(en,Ve,me);break e}Ve=Tt;break e;case 3:Tt.flags=Tt.flags&-65537|128;case 0:if(Tt=Ut.payload,me=typeof Tt=="function"?Tt.call(en,Ve,me):Tt,me==null)break e;Ve=_({},Ve,me);break e;case 2:Mi=!0}}me=N.callback,me!==null&&(s.flags|=64,we&&(s.flags|=8192),we=m.callbacks,we===null?m.callbacks=[me]:we.push(me))}else we={lane:me,tag:N.tag,payload:N.payload,callback:N.callback,next:null},Ce===null?(de=Ce=we,q=Ve):Ce=Ce.next=we,w|=me;if(N=N.next,N===null){if(N=m.shared.pending,N===null)break;we=N,N=we.next,we.next=null,m.lastBaseUpdate=we,m.shared.pending=null}}while(!0);Ce===null&&(q=Ve),m.baseState=q,m.firstBaseUpdate=de,m.lastBaseUpdate=Ce,f===null&&(m.shared.lanes=0),Ui|=w,s.lanes=w,s.memoizedState=Ve}}function Bb(s,a){if(typeof s!="function")throw Error(i(191,s));s.call(a)}function Vb(s,a){var o=s.callbacks;if(o!==null)for(s.callbacks=null,s=0;s<o.length;s++)Bb(o[s],a)}var _l=P(null),hd=P(0);function Ub(s,a){s=di,Be(hd,s),Be(_l,a),di=s|a.baseLanes}function Zm(){Be(hd,di),Be(_l,_l.current)}function ef(){di=hd.current,ae(_l),ae(hd)}var Gr=P(null),ua=null;function Li(s){var a=s.alternate;Be(Rn,Rn.current&1),Be(Gr,s),ua===null&&(a===null||_l.current!==null||a.memoizedState!==null)&&(ua=s)}function tf(s){Be(Rn,Rn.current),Be(Gr,s),ua===null&&(ua=s)}function Fb(s){s.tag===22?(Be(Rn,Rn.current),Be(Gr,s),ua===null&&(ua=s)):Oi()}function Oi(){Be(Rn,Rn.current),Be(Gr,Gr.current)}function Kr(s){ae(Gr),ua===s&&(ua=null),ae(Rn)}var Rn=P(0);function md(s){for(var a=s;a!==null;){if(a.tag===13){var o=a.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||lp(o)||cp(o)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var ni=0,cs=null,Js=null,Ln=null,fd=!1,kl=!1,Oo=!1,pd=0,Cc=0,jl=null,gj=0;function _n(){throw Error(i(321))}function sf(s,a){if(a===null)return!1;for(var o=0;o<a.length&&o<s.length;o++)if(!$r(s[o],a[o]))return!1;return!0}function nf(s,a,o,c,m,f){return ni=f,cs=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,B.H=s===null||s.memoizedState===null?jv:vf,Oo=!1,f=o(c,m),Oo=!1,kl&&(f=qb(a,o,c,m)),zb(s),f}function zb(s){B.H=Ic;var a=Js!==null&&Js.next!==null;if(ni=0,Ln=Js=cs=null,fd=!1,Cc=0,jl=null,a)throw Error(i(300));s===null||On||(s=s.dependencies,s!==null&&ad(s)&&(On=!0))}function qb(s,a,o,c){cs=s;var m=0;do{if(kl&&(jl=null),Cc=0,kl=!1,25<=m)throw Error(i(301));if(m+=1,Ln=Js=null,s.updateQueue!=null){var f=s.updateQueue;f.lastEffect=null,f.events=null,f.stores=null,f.memoCache!=null&&(f.memoCache.index=0)}B.H=Tv,f=a(o,c)}while(kl);return f}function yj(){var s=B.H,a=s.useState()[0];return a=typeof a.then=="function"?Rc(a):a,s=s.useState()[0],(Js!==null?Js.memoizedState:null)!==s&&(cs.flags|=1024),a}function rf(){var s=pd!==0;return pd=0,s}function af(s,a,o){a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~o}function of(s){if(fd){for(s=s.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}fd=!1}ni=0,Ln=Js=cs=null,kl=!1,Cc=pd=0,jl=null}function kr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ln===null?cs.memoizedState=Ln=s:Ln=Ln.next=s,Ln}function An(){if(Js===null){var s=cs.alternate;s=s!==null?s.memoizedState:null}else s=Js.next;var a=Ln===null?cs.memoizedState:Ln.next;if(a!==null)Ln=a,Js=s;else{if(s===null)throw cs.alternate===null?Error(i(467)):Error(i(310));Js=s,s={memoizedState:Js.memoizedState,baseState:Js.baseState,baseQueue:Js.baseQueue,queue:Js.queue,next:null},Ln===null?cs.memoizedState=Ln=s:Ln=Ln.next=s}return Ln}function gd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Rc(s){var a=Cc;return Cc+=1,jl===null&&(jl=[]),s=Mb(jl,s,a),a=cs,(Ln===null?a.memoizedState:Ln.next)===null&&(a=a.alternate,B.H=a===null||a.memoizedState===null?jv:vf),s}function yd(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Rc(s);if(s.$$typeof===te)return ir(s)}throw Error(i(438,String(s)))}function lf(s){var a=null,o=cs.updateQueue;if(o!==null&&(a=o.memoCache),a==null){var c=cs.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(a={data:c.data.map(function(m){return m.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),o===null&&(o=gd(),cs.updateQueue=o),o.memoCache=a,o=a.data[a.index],o===void 0)for(o=a.data[a.index]=Array(s),c=0;c<s;c++)o[c]=D;return a.index++,o}function ri(s,a){return typeof a=="function"?a(s):a}function bd(s){var a=An();return cf(a,Js,s)}function cf(s,a,o){var c=s.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=o;var m=s.baseQueue,f=c.pending;if(f!==null){if(m!==null){var w=m.next;m.next=f.next,f.next=w}a.baseQueue=m=f,c.pending=null}if(f=s.baseState,m===null)s.memoizedState=f;else{a=m.next;var N=w=null,q=null,de=a,Ce=!1;do{var Ve=de.lane&-536870913;if(Ve!==de.lane?(ws&Ve)===Ve:(ni&Ve)===Ve){var me=de.revertLane;if(me===0)q!==null&&(q=q.next={lane:0,revertLane:0,gesture:null,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null}),Ve===bl&&(Ce=!0);else if((ni&me)===me){de=de.next,me===bl&&(Ce=!0);continue}else Ve={lane:0,revertLane:de.revertLane,gesture:null,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null},q===null?(N=q=Ve,w=f):q=q.next=Ve,cs.lanes|=me,Ui|=me;Ve=de.action,Oo&&o(f,Ve),f=de.hasEagerState?de.eagerState:o(f,Ve)}else me={lane:Ve,revertLane:de.revertLane,gesture:de.gesture,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null},q===null?(N=q=me,w=f):q=q.next=me,cs.lanes|=Ve,Ui|=Ve;de=de.next}while(de!==null&&de!==a);if(q===null?w=f:q.next=N,!$r(f,s.memoizedState)&&(On=!0,Ce&&(o=vl,o!==null)))throw o;s.memoizedState=f,s.baseState=w,s.baseQueue=q,c.lastRenderedState=f}return m===null&&(c.lanes=0),[s.memoizedState,c.dispatch]}function uf(s){var a=An(),o=a.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=s;var c=o.dispatch,m=o.pending,f=a.memoizedState;if(m!==null){o.pending=null;var w=m=m.next;do f=s(f,w.action),w=w.next;while(w!==m);$r(f,a.memoizedState)||(On=!0),a.memoizedState=f,a.baseQueue===null&&(a.baseState=f),o.lastRenderedState=f}return[f,c]}function Hb(s,a,o){var c=cs,m=An(),f=Rs;if(f){if(o===void 0)throw Error(i(407));o=o()}else o=a();var w=!$r((Js||m).memoizedState,o);if(w&&(m.memoizedState=o,On=!0),m=m.queue,mf(Gb.bind(null,c,m,s),[s]),m.getSnapshot!==a||w||Ln!==null&&Ln.memoizedState.tag&1){if(c.flags|=2048,Tl(9,{destroy:void 0},Wb.bind(null,c,m,o,a),null),an===null)throw Error(i(349));f||(ni&127)!==0||$b(c,a,o)}return o}function $b(s,a,o){s.flags|=16384,s={getSnapshot:a,value:o},a=cs.updateQueue,a===null?(a=gd(),cs.updateQueue=a,a.stores=[s]):(o=a.stores,o===null?a.stores=[s]:o.push(s))}function Wb(s,a,o,c){a.value=o,a.getSnapshot=c,Kb(a)&&Yb(s)}function Gb(s,a,o){return o(function(){Kb(a)&&Yb(s)})}function Kb(s){var a=s.getSnapshot;s=s.value;try{var o=a();return!$r(s,o)}catch{return!0}}function Yb(s){var a=So(s,2);a!==null&&Fr(a,s,2)}function df(s){var a=kr();if(typeof s=="function"){var o=s;if(s=o(),Oo){Me(!0);try{o()}finally{Me(!1)}}}return a.memoizedState=a.baseState=s,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ri,lastRenderedState:s},a}function Qb(s,a,o,c){return s.baseState=o,cf(s,Js,typeof c=="function"?c:ri)}function bj(s,a,o,c,m){if(wd(s))throw Error(i(485));if(s=a.action,s!==null){var f={payload:m,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){f.listeners.push(w)}};B.T!==null?o(!0):f.isTransition=!1,c(f),o=a.pending,o===null?(f.next=a.pending=f,Xb(a,f)):(f.next=o.next,a.pending=o.next=f)}}function Xb(s,a){var o=a.action,c=a.payload,m=s.state;if(a.isTransition){var f=B.T,w={};B.T=w;try{var N=o(m,c),q=B.S;q!==null&&q(w,N),Jb(s,a,N)}catch(de){hf(s,a,de)}finally{f!==null&&w.types!==null&&(f.types=w.types),B.T=f}}else try{f=o(m,c),Jb(s,a,f)}catch(de){hf(s,a,de)}}function Jb(s,a,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){Zb(s,a,c)},function(c){return hf(s,a,c)}):Zb(s,a,o)}function Zb(s,a,o){a.status="fulfilled",a.value=o,ev(a),s.state=o,a=s.pending,a!==null&&(o=a.next,o===a?s.pending=null:(o=o.next,a.next=o,Xb(s,o)))}function hf(s,a,o){var c=s.pending;if(s.pending=null,c!==null){c=c.next;do a.status="rejected",a.reason=o,ev(a),a=a.next;while(a!==c)}s.action=null}function ev(s){s=s.listeners;for(var a=0;a<s.length;a++)(0,s[a])()}function tv(s,a){return a}function sv(s,a){if(Rs){var o=an.formState;if(o!==null){e:{var c=cs;if(Rs){if(dn){t:{for(var m=dn,f=ca;m.nodeType!==8;){if(!f){m=null;break t}if(m=da(m.nextSibling),m===null){m=null;break t}}f=m.data,m=f==="F!"||f==="F"?m:null}if(m){dn=da(m.nextSibling),c=m.data==="F!";break e}}Ai(c)}c=!1}c&&(a=o[0])}}return o=kr(),o.memoizedState=o.baseState=a,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:tv,lastRenderedState:a},o.queue=c,o=wv.bind(null,cs,c),c.dispatch=o,c=df(!1),f=bf.bind(null,cs,!1,c.queue),c=kr(),m={state:a,dispatch:null,action:s,pending:null},c.queue=m,o=bj.bind(null,cs,m,f,o),m.dispatch=o,c.memoizedState=s,[a,o,!1]}function nv(s){var a=An();return rv(a,Js,s)}function rv(s,a,o){if(a=cf(s,a,tv)[0],s=bd(ri)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var c=Rc(a)}catch(w){throw w===xl?ld:w}else c=a;a=An();var m=a.queue,f=m.dispatch;return o!==a.memoizedState&&(cs.flags|=2048,Tl(9,{destroy:void 0},vj.bind(null,m,o),null)),[c,f,s]}function vj(s,a){s.action=a}function av(s){var a=An(),o=Js;if(o!==null)return rv(a,o,s);An(),a=a.memoizedState,o=An();var c=o.queue.dispatch;return o.memoizedState=s,[a,c,!1]}function Tl(s,a,o,c){return s={tag:s,create:o,deps:c,inst:a,next:null},a=cs.updateQueue,a===null&&(a=gd(),cs.updateQueue=a),o=a.lastEffect,o===null?a.lastEffect=s.next=s:(c=o.next,o.next=s,s.next=c,a.lastEffect=s),s}function iv(){return An().memoizedState}function vd(s,a,o,c){var m=kr();cs.flags|=s,m.memoizedState=Tl(1|a,{destroy:void 0},o,c===void 0?null:c)}function xd(s,a,o,c){var m=An();c=c===void 0?null:c;var f=m.memoizedState.inst;Js!==null&&c!==null&&sf(c,Js.memoizedState.deps)?m.memoizedState=Tl(a,f,o,c):(cs.flags|=s,m.memoizedState=Tl(1|a,f,o,c))}function ov(s,a){vd(8390656,8,s,a)}function mf(s,a){xd(2048,8,s,a)}function xj(s){cs.flags|=4;var a=cs.updateQueue;if(a===null)a=gd(),cs.updateQueue=a,a.events=[s];else{var o=a.events;o===null?a.events=[s]:o.push(s)}}function lv(s){var a=An().memoizedState;return xj({ref:a,nextImpl:s}),function(){if((qs&2)!==0)throw Error(i(440));return a.impl.apply(void 0,arguments)}}function cv(s,a){return xd(4,2,s,a)}function uv(s,a){return xd(4,4,s,a)}function dv(s,a){if(typeof a=="function"){s=s();var o=a(s);return function(){typeof o=="function"?o():a(null)}}if(a!=null)return s=s(),a.current=s,function(){a.current=null}}function hv(s,a,o){o=o!=null?o.concat([s]):null,xd(4,4,dv.bind(null,a,s),o)}function ff(){}function mv(s,a){var o=An();a=a===void 0?null:a;var c=o.memoizedState;return a!==null&&sf(a,c[1])?c[0]:(o.memoizedState=[s,a],s)}function fv(s,a){var o=An();a=a===void 0?null:a;var c=o.memoizedState;if(a!==null&&sf(a,c[1]))return c[0];if(c=s(),Oo){Me(!0);try{s()}finally{Me(!1)}}return o.memoizedState=[c,a],c}function pf(s,a,o){return o===void 0||(ni&1073741824)!==0&&(ws&261930)===0?s.memoizedState=a:(s.memoizedState=o,s=p0(),cs.lanes|=s,Ui|=s,o)}function pv(s,a,o,c){return $r(o,a)?o:_l.current!==null?(s=pf(s,o,c),$r(s,a)||(On=!0),s):(ni&42)===0||(ni&1073741824)!==0&&(ws&261930)===0?(On=!0,s.memoizedState=o):(s=p0(),cs.lanes|=s,Ui|=s,a)}function gv(s,a,o,c,m){var f=se.p;se.p=f!==0&&8>f?f:8;var w=B.T,N={};B.T=N,bf(s,!1,a,o);try{var q=m(),de=B.S;if(de!==null&&de(N,q),q!==null&&typeof q=="object"&&typeof q.then=="function"){var Ce=pj(q,c);Ac(s,a,Ce,Xr(s))}else Ac(s,a,c,Xr(s))}catch(Ve){Ac(s,a,{then:function(){},status:"rejected",reason:Ve},Xr())}finally{se.p=f,w!==null&&N.types!==null&&(w.types=N.types),B.T=w}}function wj(){}function gf(s,a,o,c){if(s.tag!==5)throw Error(i(476));var m=yv(s).queue;gv(s,m,a,ge,o===null?wj:function(){return bv(s),o(c)})}function yv(s){var a=s.memoizedState;if(a!==null)return a;a={memoizedState:ge,baseState:ge,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ri,lastRenderedState:ge},next:null};var o={};return a.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ri,lastRenderedState:o},next:null},s.memoizedState=a,s=s.alternate,s!==null&&(s.memoizedState=a),a}function bv(s){var a=yv(s);a.next===null&&(a=s.alternate.memoizedState),Ac(s,a.next.queue,{},Xr())}function yf(){return ir(Kc)}function vv(){return An().memoizedState}function xv(){return An().memoizedState}function _j(s){for(var a=s.return;a!==null;){switch(a.tag){case 24:case 3:var o=Xr();s=Di(o);var c=Pi(a,s,o);c!==null&&(Fr(c,a,o),Ec(c,a,o)),a={cache:$m()},s.payload=a;return}a=a.return}}function kj(s,a,o){var c=Xr();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},wd(s)?_v(a,o):(o=Dm(s,a,o,c),o!==null&&(Fr(o,s,c),kv(o,a,c)))}function wv(s,a,o){var c=Xr();Ac(s,a,o,c)}function Ac(s,a,o,c){var m={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(wd(s))_v(a,m);else{var f=s.alternate;if(s.lanes===0&&(f===null||f.lanes===0)&&(f=a.lastRenderedReducer,f!==null))try{var w=a.lastRenderedState,N=f(w,o);if(m.hasEagerState=!0,m.eagerState=N,$r(N,w))return td(s,a,m,0),an===null&&ed(),!1}catch{}if(o=Dm(s,a,m,c),o!==null)return Fr(o,s,c),kv(o,a,c),!0}return!1}function bf(s,a,o,c){if(c={lane:2,revertLane:Qf(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},wd(s)){if(a)throw Error(i(479))}else a=Dm(s,o,c,2),a!==null&&Fr(a,s,2)}function wd(s){var a=s.alternate;return s===cs||a!==null&&a===cs}function _v(s,a){kl=fd=!0;var o=s.pending;o===null?a.next=a:(a.next=o.next,o.next=a),s.pending=a}function kv(s,a,o){if((o&4194048)!==0){var c=a.lanes;c&=s.pendingLanes,o|=c,a.lanes=o,Kt(s,o)}}var Ic={readContext:ir,use:yd,useCallback:_n,useContext:_n,useEffect:_n,useImperativeHandle:_n,useLayoutEffect:_n,useInsertionEffect:_n,useMemo:_n,useReducer:_n,useRef:_n,useState:_n,useDebugValue:_n,useDeferredValue:_n,useTransition:_n,useSyncExternalStore:_n,useId:_n,useHostTransitionStatus:_n,useFormState:_n,useActionState:_n,useOptimistic:_n,useMemoCache:_n,useCacheRefresh:_n};Ic.useEffectEvent=_n;var jv={readContext:ir,use:yd,useCallback:function(s,a){return kr().memoizedState=[s,a===void 0?null:a],s},useContext:ir,useEffect:ov,useImperativeHandle:function(s,a,o){o=o!=null?o.concat([s]):null,vd(4194308,4,dv.bind(null,a,s),o)},useLayoutEffect:function(s,a){return vd(4194308,4,s,a)},useInsertionEffect:function(s,a){vd(4,2,s,a)},useMemo:function(s,a){var o=kr();a=a===void 0?null:a;var c=s();if(Oo){Me(!0);try{s()}finally{Me(!1)}}return o.memoizedState=[c,a],c},useReducer:function(s,a,o){var c=kr();if(o!==void 0){var m=o(a);if(Oo){Me(!0);try{o(a)}finally{Me(!1)}}}else m=a;return c.memoizedState=c.baseState=m,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:m},c.queue=s,s=s.dispatch=kj.bind(null,cs,s),[c.memoizedState,s]},useRef:function(s){var a=kr();return s={current:s},a.memoizedState=s},useState:function(s){s=df(s);var a=s.queue,o=wv.bind(null,cs,a);return a.dispatch=o,[s.memoizedState,o]},useDebugValue:ff,useDeferredValue:function(s,a){var o=kr();return pf(o,s,a)},useTransition:function(){var s=df(!1);return s=gv.bind(null,cs,s.queue,!0,!1),kr().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,a,o){var c=cs,m=kr();if(Rs){if(o===void 0)throw Error(i(407));o=o()}else{if(o=a(),an===null)throw Error(i(349));(ws&127)!==0||$b(c,a,o)}m.memoizedState=o;var f={value:o,getSnapshot:a};return m.queue=f,ov(Gb.bind(null,c,f,s),[s]),c.flags|=2048,Tl(9,{destroy:void 0},Wb.bind(null,c,f,o,a),null),o},useId:function(){var s=kr(),a=an.identifierPrefix;if(Rs){var o=La,c=Pa;o=(c&~(1<<32-De(c)-1)).toString(32)+o,a="_"+a+"R_"+o,o=pd++,0<o&&(a+="H"+o.toString(32)),a+="_"}else o=gj++,a="_"+a+"r_"+o.toString(32)+"_";return s.memoizedState=a},useHostTransitionStatus:yf,useFormState:sv,useActionState:sv,useOptimistic:function(s){var a=kr();a.memoizedState=a.baseState=s;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=o,a=bf.bind(null,cs,!0,o),o.dispatch=a,[s,a]},useMemoCache:lf,useCacheRefresh:function(){return kr().memoizedState=_j.bind(null,cs)},useEffectEvent:function(s){var a=kr(),o={impl:s};return a.memoizedState=o,function(){if((qs&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},vf={readContext:ir,use:yd,useCallback:mv,useContext:ir,useEffect:mf,useImperativeHandle:hv,useInsertionEffect:cv,useLayoutEffect:uv,useMemo:fv,useReducer:bd,useRef:iv,useState:function(){return bd(ri)},useDebugValue:ff,useDeferredValue:function(s,a){var o=An();return pv(o,Js.memoizedState,s,a)},useTransition:function(){var s=bd(ri)[0],a=An().memoizedState;return[typeof s=="boolean"?s:Rc(s),a]},useSyncExternalStore:Hb,useId:vv,useHostTransitionStatus:yf,useFormState:nv,useActionState:nv,useOptimistic:function(s,a){var o=An();return Qb(o,Js,s,a)},useMemoCache:lf,useCacheRefresh:xv};vf.useEffectEvent=lv;var Tv={readContext:ir,use:yd,useCallback:mv,useContext:ir,useEffect:mf,useImperativeHandle:hv,useInsertionEffect:cv,useLayoutEffect:uv,useMemo:fv,useReducer:uf,useRef:iv,useState:function(){return uf(ri)},useDebugValue:ff,useDeferredValue:function(s,a){var o=An();return Js===null?pf(o,s,a):pv(o,Js.memoizedState,s,a)},useTransition:function(){var s=uf(ri)[0],a=An().memoizedState;return[typeof s=="boolean"?s:Rc(s),a]},useSyncExternalStore:Hb,useId:vv,useHostTransitionStatus:yf,useFormState:av,useActionState:av,useOptimistic:function(s,a){var o=An();return Js!==null?Qb(o,Js,s,a):(o.baseState=s,[s,o.queue.dispatch])},useMemoCache:lf,useCacheRefresh:xv};Tv.useEffectEvent=lv;function xf(s,a,o,c){a=s.memoizedState,o=o(c,a),o=o==null?a:_({},a,o),s.memoizedState=o,s.lanes===0&&(s.updateQueue.baseState=o)}var wf={enqueueSetState:function(s,a,o){s=s._reactInternals;var c=Xr(),m=Di(c);m.payload=a,o!=null&&(m.callback=o),a=Pi(s,m,c),a!==null&&(Fr(a,s,c),Ec(a,s,c))},enqueueReplaceState:function(s,a,o){s=s._reactInternals;var c=Xr(),m=Di(c);m.tag=1,m.payload=a,o!=null&&(m.callback=o),a=Pi(s,m,c),a!==null&&(Fr(a,s,c),Ec(a,s,c))},enqueueForceUpdate:function(s,a){s=s._reactInternals;var o=Xr(),c=Di(o);c.tag=2,a!=null&&(c.callback=a),a=Pi(s,c,o),a!==null&&(Fr(a,s,o),Ec(a,s,o))}};function Ev(s,a,o,c,m,f,w){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(c,f,w):a.prototype&&a.prototype.isPureReactComponent?!bc(o,c)||!bc(m,f):!0}function Nv(s,a,o,c){s=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(o,c),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(o,c),a.state!==s&&wf.enqueueReplaceState(a,a.state,null)}function Bo(s,a){var o=a;if("ref"in a){o={};for(var c in a)c!=="ref"&&(o[c]=a[c])}if(s=s.defaultProps){o===a&&(o=_({},o));for(var m in s)o[m]===void 0&&(o[m]=s[m])}return o}function Sv(s){Zu(s)}function Cv(s){console.error(s)}function Rv(s){Zu(s)}function _d(s,a){try{var o=s.onUncaughtError;o(a.value,{componentStack:a.stack})}catch(c){setTimeout(function(){throw c})}}function Av(s,a,o){try{var c=s.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function _f(s,a,o){return o=Di(o),o.tag=3,o.payload={element:null},o.callback=function(){_d(s,a)},o}function Iv(s){return s=Di(s),s.tag=3,s}function Mv(s,a,o,c){var m=o.type.getDerivedStateFromError;if(typeof m=="function"){var f=c.value;s.payload=function(){return m(f)},s.callback=function(){Av(a,o,c)}}var w=o.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(s.callback=function(){Av(a,o,c),typeof m!="function"&&(Fi===null?Fi=new Set([this]):Fi.add(this));var N=c.stack;this.componentDidCatch(c.value,{componentStack:N!==null?N:""})})}function jj(s,a,o,c,m){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(a=o.alternate,a!==null&&yl(a,o,m,!0),o=Gr.current,o!==null){switch(o.tag){case 31:case 13:return ua===null?Dd():o.alternate===null&&kn===0&&(kn=3),o.flags&=-257,o.flags|=65536,o.lanes=m,c===cd?o.flags|=16384:(a=o.updateQueue,a===null?o.updateQueue=new Set([c]):a.add(c),Gf(s,c,m)),!1;case 22:return o.flags|=65536,c===cd?o.flags|=16384:(a=o.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=a):(o=a.retryQueue,o===null?a.retryQueue=new Set([c]):o.add(c)),Gf(s,c,m)),!1}throw Error(i(435,o.tag))}return Gf(s,c,m),Dd(),!1}if(Rs)return a=Gr.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=m,c!==Um&&(s=Error(i(422),{cause:c}),wc(ia(s,o)))):(c!==Um&&(a=Error(i(423),{cause:c}),wc(ia(a,o))),s=s.current.alternate,s.flags|=65536,m&=-m,s.lanes|=m,c=ia(c,o),m=_f(s.stateNode,c,m),Xm(s,m),kn!==4&&(kn=2)),!1;var f=Error(i(520),{cause:c});if(f=ia(f,o),Uc===null?Uc=[f]:Uc.push(f),kn!==4&&(kn=2),a===null)return!0;c=ia(c,o),o=a;do{switch(o.tag){case 3:return o.flags|=65536,s=m&-m,o.lanes|=s,s=_f(o.stateNode,c,s),Xm(o,s),!1;case 1:if(a=o.type,f=o.stateNode,(o.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||f!==null&&typeof f.componentDidCatch=="function"&&(Fi===null||!Fi.has(f))))return o.flags|=65536,m&=-m,o.lanes|=m,m=Iv(m),Mv(m,s,o,c),Xm(o,m),!1}o=o.return}while(o!==null);return!1}var kf=Error(i(461)),On=!1;function or(s,a,o,c){a.child=s===null?Ob(a,null,o,c):Lo(a,s.child,o,c)}function Dv(s,a,o,c,m){o=o.render;var f=a.ref;if("ref"in c){var w={};for(var N in c)N!=="ref"&&(w[N]=c[N])}else w=c;return Io(a),c=nf(s,a,o,w,f,m),N=rf(),s!==null&&!On?(af(s,a,m),ai(s,a,m)):(Rs&&N&&Bm(a),a.flags|=1,or(s,a,c,m),a.child)}function Pv(s,a,o,c,m){if(s===null){var f=o.type;return typeof f=="function"&&!Pm(f)&&f.defaultProps===void 0&&o.compare===null?(a.tag=15,a.type=f,Lv(s,a,f,c,m)):(s=nd(o.type,null,c,a,a.mode,m),s.ref=a.ref,s.return=a,a.child=s)}if(f=s.child,!Af(s,m)){var w=f.memoizedProps;if(o=o.compare,o=o!==null?o:bc,o(w,c)&&s.ref===a.ref)return ai(s,a,m)}return a.flags|=1,s=Za(f,c),s.ref=a.ref,s.return=a,a.child=s}function Lv(s,a,o,c,m){if(s!==null){var f=s.memoizedProps;if(bc(f,c)&&s.ref===a.ref)if(On=!1,a.pendingProps=c=f,Af(s,m))(s.flags&131072)!==0&&(On=!0);else return a.lanes=s.lanes,ai(s,a,m)}return jf(s,a,o,c,m)}function Ov(s,a,o,c){var m=c.children,f=s!==null?s.memoizedState:null;if(s===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((a.flags&128)!==0){if(f=f!==null?f.baseLanes|o:o,s!==null){for(c=a.child=s.child,m=0;c!==null;)m=m|c.lanes|c.childLanes,c=c.sibling;c=m&~f}else c=0,a.child=null;return Bv(s,a,f,o,c)}if((o&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},s!==null&&od(a,f!==null?f.cachePool:null),f!==null?Ub(a,f):Zm(),Fb(a);else return c=a.lanes=536870912,Bv(s,a,f!==null?f.baseLanes|o:o,o,c)}else f!==null?(od(a,f.cachePool),Ub(a,f),Oi(),a.memoizedState=null):(s!==null&&od(a,null),Zm(),Oi());return or(s,a,m,o),a.child}function Mc(s,a){return s!==null&&s.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function Bv(s,a,o,c,m){var f=Gm();return f=f===null?null:{parent:Pn._currentValue,pool:f},a.memoizedState={baseLanes:o,cachePool:f},s!==null&&od(a,null),Zm(),Fb(a),s!==null&&yl(s,a,c,!0),a.childLanes=m,null}function kd(s,a){return a=Td({mode:a.mode,children:a.children},s.mode),a.ref=s.ref,s.child=a,a.return=s,a}function Vv(s,a,o){return Lo(a,s.child,null,o),s=kd(a,a.pendingProps),s.flags|=2,Kr(a),a.memoizedState=null,s}function Tj(s,a,o){var c=a.pendingProps,m=(a.flags&128)!==0;if(a.flags&=-129,s===null){if(Rs){if(c.mode==="hidden")return s=kd(a,c),a.lanes=536870912,Mc(null,s);if(tf(a),(s=dn)?(s=X0(s,ca),s=s!==null&&s.data==="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:Ci!==null?{id:Pa,overflow:La}:null,retryLane:536870912,hydrationErrors:null},o=_b(s),o.return=a,a.child=o,ar=a,dn=null)):s=null,s===null)throw Ai(a);return a.lanes=536870912,null}return kd(a,c)}var f=s.memoizedState;if(f!==null){var w=f.dehydrated;if(tf(a),m)if(a.flags&256)a.flags&=-257,a=Vv(s,a,o);else if(a.memoizedState!==null)a.child=s.child,a.flags|=128,a=null;else throw Error(i(558));else if(On||yl(s,a,o,!1),m=(o&s.childLanes)!==0,On||m){if(c=an,c!==null&&(w=Ht(c,o),w!==0&&w!==f.retryLane))throw f.retryLane=w,So(s,w),Fr(c,s,w),kf;Dd(),a=Vv(s,a,o)}else s=f.treeContext,dn=da(w.nextSibling),ar=a,Rs=!0,Ri=null,ca=!1,s!==null&&Tb(a,s),a=kd(a,c),a.flags|=4096;return a}return s=Za(s.child,{mode:c.mode,children:c.children}),s.ref=a.ref,a.child=s,s.return=a,s}function jd(s,a){var o=a.ref;if(o===null)s!==null&&s.ref!==null&&(a.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(s===null||s.ref!==o)&&(a.flags|=4194816)}}function jf(s,a,o,c,m){return Io(a),o=nf(s,a,o,c,void 0,m),c=rf(),s!==null&&!On?(af(s,a,m),ai(s,a,m)):(Rs&&c&&Bm(a),a.flags|=1,or(s,a,o,m),a.child)}function Uv(s,a,o,c,m,f){return Io(a),a.updateQueue=null,o=qb(a,c,o,m),zb(s),c=rf(),s!==null&&!On?(af(s,a,f),ai(s,a,f)):(Rs&&c&&Bm(a),a.flags|=1,or(s,a,o,f),a.child)}function Fv(s,a,o,c,m){if(Io(a),a.stateNode===null){var f=ml,w=o.contextType;typeof w=="object"&&w!==null&&(f=ir(w)),f=new o(c,f),a.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,f.updater=wf,a.stateNode=f,f._reactInternals=a,f=a.stateNode,f.props=c,f.state=a.memoizedState,f.refs={},Ym(a),w=o.contextType,f.context=typeof w=="object"&&w!==null?ir(w):ml,f.state=a.memoizedState,w=o.getDerivedStateFromProps,typeof w=="function"&&(xf(a,o,w,c),f.state=a.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(w=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),w!==f.state&&wf.enqueueReplaceState(f,f.state,null),Sc(a,c,f,m),Nc(),f.state=a.memoizedState),typeof f.componentDidMount=="function"&&(a.flags|=4194308),c=!0}else if(s===null){f=a.stateNode;var N=a.memoizedProps,q=Bo(o,N);f.props=q;var de=f.context,Ce=o.contextType;w=ml,typeof Ce=="object"&&Ce!==null&&(w=ir(Ce));var Ve=o.getDerivedStateFromProps;Ce=typeof Ve=="function"||typeof f.getSnapshotBeforeUpdate=="function",N=a.pendingProps!==N,Ce||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(N||de!==w)&&Nv(a,f,c,w),Mi=!1;var me=a.memoizedState;f.state=me,Sc(a,c,f,m),Nc(),de=a.memoizedState,N||me!==de||Mi?(typeof Ve=="function"&&(xf(a,o,Ve,c),de=a.memoizedState),(q=Mi||Ev(a,o,q,c,me,de,w))?(Ce||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(a.flags|=4194308)):(typeof f.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=c,a.memoizedState=de),f.props=c,f.state=de,f.context=w,c=q):(typeof f.componentDidMount=="function"&&(a.flags|=4194308),c=!1)}else{f=a.stateNode,Qm(s,a),w=a.memoizedProps,Ce=Bo(o,w),f.props=Ce,Ve=a.pendingProps,me=f.context,de=o.contextType,q=ml,typeof de=="object"&&de!==null&&(q=ir(de)),N=o.getDerivedStateFromProps,(de=typeof N=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(w!==Ve||me!==q)&&Nv(a,f,c,q),Mi=!1,me=a.memoizedState,f.state=me,Sc(a,c,f,m),Nc();var we=a.memoizedState;w!==Ve||me!==we||Mi||s!==null&&s.dependencies!==null&&ad(s.dependencies)?(typeof N=="function"&&(xf(a,o,N,c),we=a.memoizedState),(Ce=Mi||Ev(a,o,Ce,c,me,we,q)||s!==null&&s.dependencies!==null&&ad(s.dependencies))?(de||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(c,we,q),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(c,we,q)),typeof f.componentDidUpdate=="function"&&(a.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof f.componentDidUpdate!="function"||w===s.memoizedProps&&me===s.memoizedState||(a.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||w===s.memoizedProps&&me===s.memoizedState||(a.flags|=1024),a.memoizedProps=c,a.memoizedState=we),f.props=c,f.state=we,f.context=q,c=Ce):(typeof f.componentDidUpdate!="function"||w===s.memoizedProps&&me===s.memoizedState||(a.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||w===s.memoizedProps&&me===s.memoizedState||(a.flags|=1024),c=!1)}return f=c,jd(s,a),c=(a.flags&128)!==0,f||c?(f=a.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:f.render(),a.flags|=1,s!==null&&c?(a.child=Lo(a,s.child,null,m),a.child=Lo(a,null,o,m)):or(s,a,o,m),a.memoizedState=f.state,s=a.child):s=ai(s,a,m),s}function zv(s,a,o,c){return Ro(),a.flags|=256,or(s,a,o,c),a.child}var Tf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ef(s){return{baseLanes:s,cachePool:Ab()}}function Nf(s,a,o){return s=s!==null?s.childLanes&~o:0,a&&(s|=Qr),s}function qv(s,a,o){var c=a.pendingProps,m=!1,f=(a.flags&128)!==0,w;if((w=f)||(w=s!==null&&s.memoizedState===null?!1:(Rn.current&2)!==0),w&&(m=!0,a.flags&=-129),w=(a.flags&32)!==0,a.flags&=-33,s===null){if(Rs){if(m?Li(a):Oi(),(s=dn)?(s=X0(s,ca),s=s!==null&&s.data!=="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:Ci!==null?{id:Pa,overflow:La}:null,retryLane:536870912,hydrationErrors:null},o=_b(s),o.return=a,a.child=o,ar=a,dn=null)):s=null,s===null)throw Ai(a);return cp(s)?a.lanes=32:a.lanes=536870912,null}var N=c.children;return c=c.fallback,m?(Oi(),m=a.mode,N=Td({mode:"hidden",children:N},m),c=Co(c,m,o,null),N.return=a,c.return=a,N.sibling=c,a.child=N,c=a.child,c.memoizedState=Ef(o),c.childLanes=Nf(s,w,o),a.memoizedState=Tf,Mc(null,c)):(Li(a),Sf(a,N))}var q=s.memoizedState;if(q!==null&&(N=q.dehydrated,N!==null)){if(f)a.flags&256?(Li(a),a.flags&=-257,a=Cf(s,a,o)):a.memoizedState!==null?(Oi(),a.child=s.child,a.flags|=128,a=null):(Oi(),N=c.fallback,m=a.mode,c=Td({mode:"visible",children:c.children},m),N=Co(N,m,o,null),N.flags|=2,c.return=a,N.return=a,c.sibling=N,a.child=c,Lo(a,s.child,null,o),c=a.child,c.memoizedState=Ef(o),c.childLanes=Nf(s,w,o),a.memoizedState=Tf,a=Mc(null,c));else if(Li(a),cp(N)){if(w=N.nextSibling&&N.nextSibling.dataset,w)var de=w.dgst;w=de,c=Error(i(419)),c.stack="",c.digest=w,wc({value:c,source:null,stack:null}),a=Cf(s,a,o)}else if(On||yl(s,a,o,!1),w=(o&s.childLanes)!==0,On||w){if(w=an,w!==null&&(c=Ht(w,o),c!==0&&c!==q.retryLane))throw q.retryLane=c,So(s,c),Fr(w,s,c),kf;lp(N)||Dd(),a=Cf(s,a,o)}else lp(N)?(a.flags|=192,a.child=s.child,a=null):(s=q.treeContext,dn=da(N.nextSibling),ar=a,Rs=!0,Ri=null,ca=!1,s!==null&&Tb(a,s),a=Sf(a,c.children),a.flags|=4096);return a}return m?(Oi(),N=c.fallback,m=a.mode,q=s.child,de=q.sibling,c=Za(q,{mode:"hidden",children:c.children}),c.subtreeFlags=q.subtreeFlags&65011712,de!==null?N=Za(de,N):(N=Co(N,m,o,null),N.flags|=2),N.return=a,c.return=a,c.sibling=N,a.child=c,Mc(null,c),c=a.child,N=s.child.memoizedState,N===null?N=Ef(o):(m=N.cachePool,m!==null?(q=Pn._currentValue,m=m.parent!==q?{parent:q,pool:q}:m):m=Ab(),N={baseLanes:N.baseLanes|o,cachePool:m}),c.memoizedState=N,c.childLanes=Nf(s,w,o),a.memoizedState=Tf,Mc(s.child,c)):(Li(a),o=s.child,s=o.sibling,o=Za(o,{mode:"visible",children:c.children}),o.return=a,o.sibling=null,s!==null&&(w=a.deletions,w===null?(a.deletions=[s],a.flags|=16):w.push(s)),a.child=o,a.memoizedState=null,o)}function Sf(s,a){return a=Td({mode:"visible",children:a},s.mode),a.return=s,s.child=a}function Td(s,a){return s=Wr(22,s,null,a),s.lanes=0,s}function Cf(s,a,o){return Lo(a,s.child,null,o),s=Sf(a,a.pendingProps.children),s.flags|=2,a.memoizedState=null,s}function Hv(s,a,o){s.lanes|=a;var c=s.alternate;c!==null&&(c.lanes|=a),qm(s.return,a,o)}function Rf(s,a,o,c,m,f){var w=s.memoizedState;w===null?s.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:m,treeForkCount:f}:(w.isBackwards=a,w.rendering=null,w.renderingStartTime=0,w.last=c,w.tail=o,w.tailMode=m,w.treeForkCount=f)}function $v(s,a,o){var c=a.pendingProps,m=c.revealOrder,f=c.tail;c=c.children;var w=Rn.current,N=(w&2)!==0;if(N?(w=w&1|2,a.flags|=128):w&=1,Be(Rn,w),or(s,a,c,o),c=Rs?xc:0,!N&&s!==null&&(s.flags&128)!==0)e:for(s=a.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Hv(s,o,a);else if(s.tag===19)Hv(s,o,a);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(m){case"forwards":for(o=a.child,m=null;o!==null;)s=o.alternate,s!==null&&md(s)===null&&(m=o),o=o.sibling;o=m,o===null?(m=a.child,a.child=null):(m=o.sibling,o.sibling=null),Rf(a,!1,m,o,f,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,m=a.child,a.child=null;m!==null;){if(s=m.alternate,s!==null&&md(s)===null){a.child=m;break}s=m.sibling,m.sibling=o,o=m,m=s}Rf(a,!0,o,null,f,c);break;case"together":Rf(a,!1,null,null,void 0,c);break;default:a.memoizedState=null}return a.child}function ai(s,a,o){if(s!==null&&(a.dependencies=s.dependencies),Ui|=a.lanes,(o&a.childLanes)===0)if(s!==null){if(yl(s,a,o,!1),(o&a.childLanes)===0)return null}else return null;if(s!==null&&a.child!==s.child)throw Error(i(153));if(a.child!==null){for(s=a.child,o=Za(s,s.pendingProps),a.child=o,o.return=a;s.sibling!==null;)s=s.sibling,o=o.sibling=Za(s,s.pendingProps),o.return=a;o.sibling=null}return a.child}function Af(s,a){return(s.lanes&a)!==0?!0:(s=s.dependencies,!!(s!==null&&ad(s)))}function Ej(s,a,o){switch(a.tag){case 3:yt(a,a.stateNode.containerInfo),Ii(a,Pn,s.memoizedState.cache),Ro();break;case 27:case 5:Xt(a);break;case 4:yt(a,a.stateNode.containerInfo);break;case 10:Ii(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,tf(a),null;break;case 13:var c=a.memoizedState;if(c!==null)return c.dehydrated!==null?(Li(a),a.flags|=128,null):(o&a.child.childLanes)!==0?qv(s,a,o):(Li(a),s=ai(s,a,o),s!==null?s.sibling:null);Li(a);break;case 19:var m=(s.flags&128)!==0;if(c=(o&a.childLanes)!==0,c||(yl(s,a,o,!1),c=(o&a.childLanes)!==0),m){if(c)return $v(s,a,o);a.flags|=128}if(m=a.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),Be(Rn,Rn.current),c)break;return null;case 22:return a.lanes=0,Ov(s,a,o,a.pendingProps);case 24:Ii(a,Pn,s.memoizedState.cache)}return ai(s,a,o)}function Wv(s,a,o){if(s!==null)if(s.memoizedProps!==a.pendingProps)On=!0;else{if(!Af(s,o)&&(a.flags&128)===0)return On=!1,Ej(s,a,o);On=(s.flags&131072)!==0}else On=!1,Rs&&(a.flags&1048576)!==0&&jb(a,xc,a.index);switch(a.lanes=0,a.tag){case 16:e:{var c=a.pendingProps;if(s=Do(a.elementType),a.type=s,typeof s=="function")Pm(s)?(c=Bo(s,c),a.tag=1,a=Fv(null,a,s,c,o)):(a.tag=0,a=jf(null,a,s,c,o));else{if(s!=null){var m=s.$$typeof;if(m===ke){a.tag=11,a=Dv(null,a,s,c,o);break e}else if(m===R){a.tag=14,a=Pv(null,a,s,c,o);break e}}throw a=ze(s)||s,Error(i(306,a,""))}}return a;case 0:return jf(s,a,a.type,a.pendingProps,o);case 1:return c=a.type,m=Bo(c,a.pendingProps),Fv(s,a,c,m,o);case 3:e:{if(yt(a,a.stateNode.containerInfo),s===null)throw Error(i(387));c=a.pendingProps;var f=a.memoizedState;m=f.element,Qm(s,a),Sc(a,c,null,o);var w=a.memoizedState;if(c=w.cache,Ii(a,Pn,c),c!==f.cache&&Hm(a,[Pn],o,!0),Nc(),c=w.element,f.isDehydrated)if(f={element:c,isDehydrated:!1,cache:w.cache},a.updateQueue.baseState=f,a.memoizedState=f,a.flags&256){a=zv(s,a,c,o);break e}else if(c!==m){m=ia(Error(i(424)),a),wc(m),a=zv(s,a,c,o);break e}else for(s=a.stateNode.containerInfo,s.nodeType===9?s=s.body:s=s.nodeName==="HTML"?s.ownerDocument.body:s,dn=da(s.firstChild),ar=a,Rs=!0,Ri=null,ca=!0,o=Ob(a,null,c,o),a.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Ro(),c===m){a=ai(s,a,o);break e}or(s,a,c,o)}a=a.child}return a;case 26:return jd(s,a),s===null?(o=n1(a.type,null,a.pendingProps,null))?a.memoizedState=o:Rs||(o=a.type,s=a.pendingProps,c=Fd(Ie.current).createElement(o),c[mt]=a,c[Nt]=s,lr(c,o,s),he(c),a.stateNode=c):a.memoizedState=n1(a.type,s.memoizedProps,a.pendingProps,s.memoizedState),null;case 27:return Xt(a),s===null&&Rs&&(c=a.stateNode=e1(a.type,a.pendingProps,Ie.current),ar=a,ca=!0,m=dn,$i(a.type)?(up=m,dn=da(c.firstChild)):dn=m),or(s,a,a.pendingProps.children,o),jd(s,a),s===null&&(a.flags|=4194304),a.child;case 5:return s===null&&Rs&&((m=c=dn)&&(c=sT(c,a.type,a.pendingProps,ca),c!==null?(a.stateNode=c,ar=a,dn=da(c.firstChild),ca=!1,m=!0):m=!1),m||Ai(a)),Xt(a),m=a.type,f=a.pendingProps,w=s!==null?s.memoizedProps:null,c=f.children,ap(m,f)?c=null:w!==null&&ap(m,w)&&(a.flags|=32),a.memoizedState!==null&&(m=nf(s,a,yj,null,null,o),Kc._currentValue=m),jd(s,a),or(s,a,c,o),a.child;case 6:return s===null&&Rs&&((s=o=dn)&&(o=nT(o,a.pendingProps,ca),o!==null?(a.stateNode=o,ar=a,dn=null,s=!0):s=!1),s||Ai(a)),null;case 13:return qv(s,a,o);case 4:return yt(a,a.stateNode.containerInfo),c=a.pendingProps,s===null?a.child=Lo(a,null,c,o):or(s,a,c,o),a.child;case 11:return Dv(s,a,a.type,a.pendingProps,o);case 7:return or(s,a,a.pendingProps,o),a.child;case 8:return or(s,a,a.pendingProps.children,o),a.child;case 12:return or(s,a,a.pendingProps.children,o),a.child;case 10:return c=a.pendingProps,Ii(a,a.type,c.value),or(s,a,c.children,o),a.child;case 9:return m=a.type._context,c=a.pendingProps.children,Io(a),m=ir(m),c=c(m),a.flags|=1,or(s,a,c,o),a.child;case 14:return Pv(s,a,a.type,a.pendingProps,o);case 15:return Lv(s,a,a.type,a.pendingProps,o);case 19:return $v(s,a,o);case 31:return Tj(s,a,o);case 22:return Ov(s,a,o,a.pendingProps);case 24:return Io(a),c=ir(Pn),s===null?(m=Gm(),m===null&&(m=an,f=$m(),m.pooledCache=f,f.refCount++,f!==null&&(m.pooledCacheLanes|=o),m=f),a.memoizedState={parent:c,cache:m},Ym(a),Ii(a,Pn,m)):((s.lanes&o)!==0&&(Qm(s,a),Sc(a,null,null,o),Nc()),m=s.memoizedState,f=a.memoizedState,m.parent!==c?(m={parent:c,cache:c},a.memoizedState=m,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=m),Ii(a,Pn,c)):(c=f.cache,Ii(a,Pn,c),c!==m.cache&&Hm(a,[Pn],o,!0))),or(s,a,a.pendingProps.children,o),a.child;case 29:throw a.pendingProps}throw Error(i(156,a.tag))}function ii(s){s.flags|=4}function If(s,a,o,c,m){if((a=(s.mode&32)!==0)&&(a=!1),a){if(s.flags|=16777216,(m&335544128)===m)if(s.stateNode.complete)s.flags|=8192;else if(v0())s.flags|=8192;else throw Po=cd,Km}else s.flags&=-16777217}function Gv(s,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!l1(a))if(v0())s.flags|=8192;else throw Po=cd,Km}function Ed(s,a){a!==null&&(s.flags|=4),s.flags&16384&&(a=s.tag!==22?X():536870912,s.lanes|=a,Cl|=a)}function Dc(s,a){if(!Rs)switch(s.tailMode){case"hidden":a=s.tail;for(var o=null;a!==null;)a.alternate!==null&&(o=a),a=a.sibling;o===null?s.tail=null:o.sibling=null;break;case"collapsed":o=s.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?a||s.tail===null?s.tail=null:s.tail.sibling=null:c.sibling=null}}function hn(s){var a=s.alternate!==null&&s.alternate.child===s.child,o=0,c=0;if(a)for(var m=s.child;m!==null;)o|=m.lanes|m.childLanes,c|=m.subtreeFlags&65011712,c|=m.flags&65011712,m.return=s,m=m.sibling;else for(m=s.child;m!==null;)o|=m.lanes|m.childLanes,c|=m.subtreeFlags,c|=m.flags,m.return=s,m=m.sibling;return s.subtreeFlags|=c,s.childLanes=o,a}function Nj(s,a,o){var c=a.pendingProps;switch(Vm(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return hn(a),null;case 1:return hn(a),null;case 3:return o=a.stateNode,c=null,s!==null&&(c=s.memoizedState.cache),a.memoizedState.cache!==c&&(a.flags|=2048),si(Pn),et(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(s===null||s.child===null)&&(gl(a)?ii(a):s===null||s.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Fm())),hn(a),null;case 26:var m=a.type,f=a.memoizedState;return s===null?(ii(a),f!==null?(hn(a),Gv(a,f)):(hn(a),If(a,m,null,c,o))):f?f!==s.memoizedState?(ii(a),hn(a),Gv(a,f)):(hn(a),a.flags&=-16777217):(s=s.memoizedProps,s!==c&&ii(a),hn(a),If(a,m,s,c,o)),null;case 27:if(Es(a),o=Ie.current,m=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==c&&ii(a);else{if(!c){if(a.stateNode===null)throw Error(i(166));return hn(a),null}s=Ue.current,gl(a)?Eb(a):(s=e1(m,c,o),a.stateNode=s,ii(a))}return hn(a),null;case 5:if(Es(a),m=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==c&&ii(a);else{if(!c){if(a.stateNode===null)throw Error(i(166));return hn(a),null}if(f=Ue.current,gl(a))Eb(a);else{var w=Fd(Ie.current);switch(f){case 1:f=w.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:f=w.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":f=w.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":f=w.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":f=w.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild);break;case"select":f=typeof c.is=="string"?w.createElement("select",{is:c.is}):w.createElement("select"),c.multiple?f.multiple=!0:c.size&&(f.size=c.size);break;default:f=typeof c.is=="string"?w.createElement(m,{is:c.is}):w.createElement(m)}}f[mt]=a,f[Nt]=c;e:for(w=a.child;w!==null;){if(w.tag===5||w.tag===6)f.appendChild(w.stateNode);else if(w.tag!==4&&w.tag!==27&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===a)break e;for(;w.sibling===null;){if(w.return===null||w.return===a)break e;w=w.return}w.sibling.return=w.return,w=w.sibling}a.stateNode=f;e:switch(lr(f,m,c),m){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&ii(a)}}return hn(a),If(a,a.type,s===null?null:s.memoizedProps,a.pendingProps,o),null;case 6:if(s&&a.stateNode!=null)s.memoizedProps!==c&&ii(a);else{if(typeof c!="string"&&a.stateNode===null)throw Error(i(166));if(s=Ie.current,gl(a)){if(s=a.stateNode,o=a.memoizedProps,c=null,m=ar,m!==null)switch(m.tag){case 27:case 5:c=m.memoizedProps}s[mt]=a,s=!!(s.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||q0(s.nodeValue,o)),s||Ai(a,!0)}else s=Fd(s).createTextNode(c),s[mt]=a,a.stateNode=s}return hn(a),null;case 31:if(o=a.memoizedState,s===null||s.memoizedState!==null){if(c=gl(a),o!==null){if(s===null){if(!c)throw Error(i(318));if(s=a.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[mt]=a}else Ro(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;hn(a),s=!1}else o=Fm(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=o),s=!0;if(!s)return a.flags&256?(Kr(a),a):(Kr(a),null);if((a.flags&128)!==0)throw Error(i(558))}return hn(a),null;case 13:if(c=a.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(m=gl(a),c!==null&&c.dehydrated!==null){if(s===null){if(!m)throw Error(i(318));if(m=a.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(i(317));m[mt]=a}else Ro(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;hn(a),m=!1}else m=Fm(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=m),m=!0;if(!m)return a.flags&256?(Kr(a),a):(Kr(a),null)}return Kr(a),(a.flags&128)!==0?(a.lanes=o,a):(o=c!==null,s=s!==null&&s.memoizedState!==null,o&&(c=a.child,m=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(m=c.alternate.memoizedState.cachePool.pool),f=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(f=c.memoizedState.cachePool.pool),f!==m&&(c.flags|=2048)),o!==s&&o&&(a.child.flags|=8192),Ed(a,a.updateQueue),hn(a),null);case 4:return et(),s===null&&ep(a.stateNode.containerInfo),hn(a),null;case 10:return si(a.type),hn(a),null;case 19:if(ae(Rn),c=a.memoizedState,c===null)return hn(a),null;if(m=(a.flags&128)!==0,f=c.rendering,f===null)if(m)Dc(c,!1);else{if(kn!==0||s!==null&&(s.flags&128)!==0)for(s=a.child;s!==null;){if(f=md(s),f!==null){for(a.flags|=128,Dc(c,!1),s=f.updateQueue,a.updateQueue=s,Ed(a,s),a.subtreeFlags=0,s=o,o=a.child;o!==null;)wb(o,s),o=o.sibling;return Be(Rn,Rn.current&1|2),Rs&&ei(a,c.treeForkCount),a.child}s=s.sibling}c.tail!==null&&Ft()>Ad&&(a.flags|=128,m=!0,Dc(c,!1),a.lanes=4194304)}else{if(!m)if(s=md(f),s!==null){if(a.flags|=128,m=!0,s=s.updateQueue,a.updateQueue=s,Ed(a,s),Dc(c,!0),c.tail===null&&c.tailMode==="hidden"&&!f.alternate&&!Rs)return hn(a),null}else 2*Ft()-c.renderingStartTime>Ad&&o!==536870912&&(a.flags|=128,m=!0,Dc(c,!1),a.lanes=4194304);c.isBackwards?(f.sibling=a.child,a.child=f):(s=c.last,s!==null?s.sibling=f:a.child=f,c.last=f)}return c.tail!==null?(s=c.tail,c.rendering=s,c.tail=s.sibling,c.renderingStartTime=Ft(),s.sibling=null,o=Rn.current,Be(Rn,m?o&1|2:o&1),Rs&&ei(a,c.treeForkCount),s):(hn(a),null);case 22:case 23:return Kr(a),ef(),c=a.memoizedState!==null,s!==null?s.memoizedState!==null!==c&&(a.flags|=8192):c&&(a.flags|=8192),c?(o&536870912)!==0&&(a.flags&128)===0&&(hn(a),a.subtreeFlags&6&&(a.flags|=8192)):hn(a),o=a.updateQueue,o!==null&&Ed(a,o.retryQueue),o=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),c=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),c!==o&&(a.flags|=2048),s!==null&&ae(Mo),null;case 24:return o=null,s!==null&&(o=s.memoizedState.cache),a.memoizedState.cache!==o&&(a.flags|=2048),si(Pn),hn(a),null;case 25:return null;case 30:return null}throw Error(i(156,a.tag))}function Sj(s,a){switch(Vm(a),a.tag){case 1:return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 3:return si(Pn),et(),s=a.flags,(s&65536)!==0&&(s&128)===0?(a.flags=s&-65537|128,a):null;case 26:case 27:case 5:return Es(a),null;case 31:if(a.memoizedState!==null){if(Kr(a),a.alternate===null)throw Error(i(340));Ro()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 13:if(Kr(a),s=a.memoizedState,s!==null&&s.dehydrated!==null){if(a.alternate===null)throw Error(i(340));Ro()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 19:return ae(Rn),null;case 4:return et(),null;case 10:return si(a.type),null;case 22:case 23:return Kr(a),ef(),s!==null&&ae(Mo),s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 24:return si(Pn),null;case 25:return null;default:return null}}function Kv(s,a){switch(Vm(a),a.tag){case 3:si(Pn),et();break;case 26:case 27:case 5:Es(a);break;case 4:et();break;case 31:a.memoizedState!==null&&Kr(a);break;case 13:Kr(a);break;case 19:ae(Rn);break;case 10:si(a.type);break;case 22:case 23:Kr(a),ef(),s!==null&&ae(Mo);break;case 24:si(Pn)}}function Pc(s,a){try{var o=a.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var m=c.next;o=m;do{if((o.tag&s)===s){c=void 0;var f=o.create,w=o.inst;c=f(),w.destroy=c}o=o.next}while(o!==m)}}catch(N){Qs(a,a.return,N)}}function Bi(s,a,o){try{var c=a.updateQueue,m=c!==null?c.lastEffect:null;if(m!==null){var f=m.next;c=f;do{if((c.tag&s)===s){var w=c.inst,N=w.destroy;if(N!==void 0){w.destroy=void 0,m=a;var q=o,de=N;try{de()}catch(Ce){Qs(m,q,Ce)}}}c=c.next}while(c!==f)}}catch(Ce){Qs(a,a.return,Ce)}}function Yv(s){var a=s.updateQueue;if(a!==null){var o=s.stateNode;try{Vb(a,o)}catch(c){Qs(s,s.return,c)}}}function Qv(s,a,o){o.props=Bo(s.type,s.memoizedProps),o.state=s.memoizedState;try{o.componentWillUnmount()}catch(c){Qs(s,a,c)}}function Lc(s,a){try{var o=s.ref;if(o!==null){switch(s.tag){case 26:case 27:case 5:var c=s.stateNode;break;case 30:c=s.stateNode;break;default:c=s.stateNode}typeof o=="function"?s.refCleanup=o(c):o.current=c}}catch(m){Qs(s,a,m)}}function Oa(s,a){var o=s.ref,c=s.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(m){Qs(s,a,m)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(m){Qs(s,a,m)}else o.current=null}function Xv(s){var a=s.type,o=s.memoizedProps,c=s.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(m){Qs(s,s.return,m)}}function Mf(s,a,o){try{var c=s.stateNode;Qj(c,s.type,o,a),c[Nt]=a}catch(m){Qs(s,s.return,m)}}function Jv(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&$i(s.type)||s.tag===4}function Df(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Jv(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&$i(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Pf(s,a,o){var c=s.tag;if(c===5||c===6)s=s.stateNode,a?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(s,a):(a=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,a.appendChild(s),o=o._reactRootContainer,o!=null||a.onclick!==null||(a.onclick=Zt));else if(c!==4&&(c===27&&$i(s.type)&&(o=s.stateNode,a=null),s=s.child,s!==null))for(Pf(s,a,o),s=s.sibling;s!==null;)Pf(s,a,o),s=s.sibling}function Nd(s,a,o){var c=s.tag;if(c===5||c===6)s=s.stateNode,a?o.insertBefore(s,a):o.appendChild(s);else if(c!==4&&(c===27&&$i(s.type)&&(o=s.stateNode),s=s.child,s!==null))for(Nd(s,a,o),s=s.sibling;s!==null;)Nd(s,a,o),s=s.sibling}function Zv(s){var a=s.stateNode,o=s.memoizedProps;try{for(var c=s.type,m=a.attributes;m.length;)a.removeAttributeNode(m[0]);lr(a,c,o),a[mt]=s,a[Nt]=o}catch(f){Qs(s,s.return,f)}}var oi=!1,Bn=!1,Lf=!1,e0=typeof WeakSet=="function"?WeakSet:Set,Xn=null;function Cj(s,a){if(s=s.containerInfo,np=Kd,s=hb(s),Sm(s)){if("selectionStart"in s)var o={start:s.selectionStart,end:s.selectionEnd};else e:{o=(o=s.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var m=c.anchorOffset,f=c.focusNode;c=c.focusOffset;try{o.nodeType,f.nodeType}catch{o=null;break e}var w=0,N=-1,q=-1,de=0,Ce=0,Ve=s,me=null;t:for(;;){for(var we;Ve!==o||m!==0&&Ve.nodeType!==3||(N=w+m),Ve!==f||c!==0&&Ve.nodeType!==3||(q=w+c),Ve.nodeType===3&&(w+=Ve.nodeValue.length),(we=Ve.firstChild)!==null;)me=Ve,Ve=we;for(;;){if(Ve===s)break t;if(me===o&&++de===m&&(N=w),me===f&&++Ce===c&&(q=w),(we=Ve.nextSibling)!==null)break;Ve=me,me=Ve.parentNode}Ve=we}o=N===-1||q===-1?null:{start:N,end:q}}else o=null}o=o||{start:0,end:0}}else o=null;for(rp={focusedElem:s,selectionRange:o},Kd=!1,Xn=a;Xn!==null;)if(a=Xn,s=a.child,(a.subtreeFlags&1028)!==0&&s!==null)s.return=a,Xn=s;else for(;Xn!==null;){switch(a=Xn,f=a.alternate,s=a.flags,a.tag){case 0:if((s&4)!==0&&(s=a.updateQueue,s=s!==null?s.events:null,s!==null))for(o=0;o<s.length;o++)m=s[o],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&f!==null){s=void 0,o=a,m=f.memoizedProps,f=f.memoizedState,c=o.stateNode;try{var Tt=Bo(o.type,m);s=c.getSnapshotBeforeUpdate(Tt,f),c.__reactInternalSnapshotBeforeUpdate=s}catch(Ut){Qs(o,o.return,Ut)}}break;case 3:if((s&1024)!==0){if(s=a.stateNode.containerInfo,o=s.nodeType,o===9)op(s);else if(o===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":op(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=a.sibling,s!==null){s.return=a.return,Xn=s;break}Xn=a.return}}function t0(s,a,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:ci(s,o),c&4&&Pc(5,o);break;case 1:if(ci(s,o),c&4)if(s=o.stateNode,a===null)try{s.componentDidMount()}catch(w){Qs(o,o.return,w)}else{var m=Bo(o.type,a.memoizedProps);a=a.memoizedState;try{s.componentDidUpdate(m,a,s.__reactInternalSnapshotBeforeUpdate)}catch(w){Qs(o,o.return,w)}}c&64&&Yv(o),c&512&&Lc(o,o.return);break;case 3:if(ci(s,o),c&64&&(s=o.updateQueue,s!==null)){if(a=null,o.child!==null)switch(o.child.tag){case 27:case 5:a=o.child.stateNode;break;case 1:a=o.child.stateNode}try{Vb(s,a)}catch(w){Qs(o,o.return,w)}}break;case 27:a===null&&c&4&&Zv(o);case 26:case 5:ci(s,o),a===null&&c&4&&Xv(o),c&512&&Lc(o,o.return);break;case 12:ci(s,o);break;case 31:ci(s,o),c&4&&r0(s,o);break;case 13:ci(s,o),c&4&&a0(s,o),c&64&&(s=o.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(o=Bj.bind(null,o),rT(s,o))));break;case 22:if(c=o.memoizedState!==null||oi,!c){a=a!==null&&a.memoizedState!==null||Bn,m=oi;var f=Bn;oi=c,(Bn=a)&&!f?ui(s,o,(o.subtreeFlags&8772)!==0):ci(s,o),oi=m,Bn=f}break;case 30:break;default:ci(s,o)}}function s0(s){var a=s.alternate;a!==null&&(s.alternate=null,s0(a)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(a=s.stateNode,a!==null&&Nn(a)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var pn=null,Or=!1;function li(s,a,o){for(o=o.child;o!==null;)n0(s,a,o),o=o.sibling}function n0(s,a,o){if(ye&&typeof ye.onCommitFiberUnmount=="function")try{ye.onCommitFiberUnmount(xs,o)}catch{}switch(o.tag){case 26:Bn||Oa(o,a),li(s,a,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Bn||Oa(o,a);var c=pn,m=Or;$i(o.type)&&(pn=o.stateNode,Or=!1),li(s,a,o),$c(o.stateNode),pn=c,Or=m;break;case 5:Bn||Oa(o,a);case 6:if(c=pn,m=Or,pn=null,li(s,a,o),pn=c,Or=m,pn!==null)if(Or)try{(pn.nodeType===9?pn.body:pn.nodeName==="HTML"?pn.ownerDocument.body:pn).removeChild(o.stateNode)}catch(f){Qs(o,a,f)}else try{pn.removeChild(o.stateNode)}catch(f){Qs(o,a,f)}break;case 18:pn!==null&&(Or?(s=pn,Y0(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,o.stateNode),Ol(s)):Y0(pn,o.stateNode));break;case 4:c=pn,m=Or,pn=o.stateNode.containerInfo,Or=!0,li(s,a,o),pn=c,Or=m;break;case 0:case 11:case 14:case 15:Bi(2,o,a),Bn||Bi(4,o,a),li(s,a,o);break;case 1:Bn||(Oa(o,a),c=o.stateNode,typeof c.componentWillUnmount=="function"&&Qv(o,a,c)),li(s,a,o);break;case 21:li(s,a,o);break;case 22:Bn=(c=Bn)||o.memoizedState!==null,li(s,a,o),Bn=c;break;default:li(s,a,o)}}function r0(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Ol(s)}catch(o){Qs(a,a.return,o)}}}function a0(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Ol(s)}catch(o){Qs(a,a.return,o)}}function Rj(s){switch(s.tag){case 31:case 13:case 19:var a=s.stateNode;return a===null&&(a=s.stateNode=new e0),a;case 22:return s=s.stateNode,a=s._retryCache,a===null&&(a=s._retryCache=new e0),a;default:throw Error(i(435,s.tag))}}function Sd(s,a){var o=Rj(s);a.forEach(function(c){if(!o.has(c)){o.add(c);var m=Vj.bind(null,s,c);c.then(m,m)}})}function Br(s,a){var o=a.deletions;if(o!==null)for(var c=0;c<o.length;c++){var m=o[c],f=s,w=a,N=w;e:for(;N!==null;){switch(N.tag){case 27:if($i(N.type)){pn=N.stateNode,Or=!1;break e}break;case 5:pn=N.stateNode,Or=!1;break e;case 3:case 4:pn=N.stateNode.containerInfo,Or=!0;break e}N=N.return}if(pn===null)throw Error(i(160));n0(f,w,m),pn=null,Or=!1,f=m.alternate,f!==null&&(f.return=null),m.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)i0(a,s),a=a.sibling}var wa=null;function i0(s,a){var o=s.alternate,c=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Br(a,s),Vr(s),c&4&&(Bi(3,s,s.return),Pc(3,s),Bi(5,s,s.return));break;case 1:Br(a,s),Vr(s),c&512&&(Bn||o===null||Oa(o,o.return)),c&64&&oi&&(s=s.updateQueue,s!==null&&(c=s.callbacks,c!==null&&(o=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var m=wa;if(Br(a,s),Vr(s),c&512&&(Bn||o===null||Oa(o,o.return)),c&4){var f=o!==null?o.memoizedState:null;if(c=s.memoizedState,o===null)if(c===null)if(s.stateNode===null){e:{c=s.type,o=s.memoizedProps,m=m.ownerDocument||m;t:switch(c){case"title":f=m.getElementsByTagName("title")[0],(!f||f[mn]||f[mt]||f.namespaceURI==="http://www.w3.org/2000/svg"||f.hasAttribute("itemprop"))&&(f=m.createElement(c),m.head.insertBefore(f,m.querySelector("head > title"))),lr(f,c,o),f[mt]=s,he(f),c=f;break e;case"link":var w=i1("link","href",m).get(c+(o.href||""));if(w){for(var N=0;N<w.length;N++)if(f=w[N],f.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&f.getAttribute("rel")===(o.rel==null?null:o.rel)&&f.getAttribute("title")===(o.title==null?null:o.title)&&f.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){w.splice(N,1);break t}}f=m.createElement(c),lr(f,c,o),m.head.appendChild(f);break;case"meta":if(w=i1("meta","content",m).get(c+(o.content||""))){for(N=0;N<w.length;N++)if(f=w[N],f.getAttribute("content")===(o.content==null?null:""+o.content)&&f.getAttribute("name")===(o.name==null?null:o.name)&&f.getAttribute("property")===(o.property==null?null:o.property)&&f.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&f.getAttribute("charset")===(o.charSet==null?null:o.charSet)){w.splice(N,1);break t}}f=m.createElement(c),lr(f,c,o),m.head.appendChild(f);break;default:throw Error(i(468,c))}f[mt]=s,he(f),c=f}s.stateNode=c}else o1(m,s.type,s.stateNode);else s.stateNode=a1(m,c,s.memoizedProps);else f!==c?(f===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):f.count--,c===null?o1(m,s.type,s.stateNode):a1(m,c,s.memoizedProps)):c===null&&s.stateNode!==null&&Mf(s,s.memoizedProps,o.memoizedProps)}break;case 27:Br(a,s),Vr(s),c&512&&(Bn||o===null||Oa(o,o.return)),o!==null&&c&4&&Mf(s,s.memoizedProps,o.memoizedProps);break;case 5:if(Br(a,s),Vr(s),c&512&&(Bn||o===null||Oa(o,o.return)),s.flags&32){m=s.stateNode;try{Jt(m,"")}catch(Tt){Qs(s,s.return,Tt)}}c&4&&s.stateNode!=null&&(m=s.memoizedProps,Mf(s,m,o!==null?o.memoizedProps:m)),c&1024&&(Lf=!0);break;case 6:if(Br(a,s),Vr(s),c&4){if(s.stateNode===null)throw Error(i(162));c=s.memoizedProps,o=s.stateNode;try{o.nodeValue=c}catch(Tt){Qs(s,s.return,Tt)}}break;case 3:if(Hd=null,m=wa,wa=zd(a.containerInfo),Br(a,s),wa=m,Vr(s),c&4&&o!==null&&o.memoizedState.isDehydrated)try{Ol(a.containerInfo)}catch(Tt){Qs(s,s.return,Tt)}Lf&&(Lf=!1,o0(s));break;case 4:c=wa,wa=zd(s.stateNode.containerInfo),Br(a,s),Vr(s),wa=c;break;case 12:Br(a,s),Vr(s);break;case 31:Br(a,s),Vr(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Sd(s,c)));break;case 13:Br(a,s),Vr(s),s.child.flags&8192&&s.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Rd=Ft()),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Sd(s,c)));break;case 22:m=s.memoizedState!==null;var q=o!==null&&o.memoizedState!==null,de=oi,Ce=Bn;if(oi=de||m,Bn=Ce||q,Br(a,s),Bn=Ce,oi=de,Vr(s),c&8192)e:for(a=s.stateNode,a._visibility=m?a._visibility&-2:a._visibility|1,m&&(o===null||q||oi||Bn||Vo(s)),o=null,a=s;;){if(a.tag===5||a.tag===26){if(o===null){q=o=a;try{if(f=q.stateNode,m)w=f.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{N=q.stateNode;var Ve=q.memoizedProps.style,me=Ve!=null&&Ve.hasOwnProperty("display")?Ve.display:null;N.style.display=me==null||typeof me=="boolean"?"":(""+me).trim()}}catch(Tt){Qs(q,q.return,Tt)}}}else if(a.tag===6){if(o===null){q=a;try{q.stateNode.nodeValue=m?"":q.memoizedProps}catch(Tt){Qs(q,q.return,Tt)}}}else if(a.tag===18){if(o===null){q=a;try{var we=q.stateNode;m?Q0(we,!0):Q0(q.stateNode,!1)}catch(Tt){Qs(q,q.return,Tt)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===s)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;o===a&&(o=null),a=a.return}o===a&&(o=null),a.sibling.return=a.return,a=a.sibling}c&4&&(c=s.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,Sd(s,o))));break;case 19:Br(a,s),Vr(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Sd(s,c)));break;case 30:break;case 21:break;default:Br(a,s),Vr(s)}}function Vr(s){var a=s.flags;if(a&2){try{for(var o,c=s.return;c!==null;){if(Jv(c)){o=c;break}c=c.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var m=o.stateNode,f=Df(s);Nd(s,f,m);break;case 5:var w=o.stateNode;o.flags&32&&(Jt(w,""),o.flags&=-33);var N=Df(s);Nd(s,N,w);break;case 3:case 4:var q=o.stateNode.containerInfo,de=Df(s);Pf(s,de,q);break;default:throw Error(i(161))}}catch(Ce){Qs(s,s.return,Ce)}s.flags&=-3}a&4096&&(s.flags&=-4097)}function o0(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var a=s;o0(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),s=s.sibling}}function ci(s,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)t0(s,a.alternate,a),a=a.sibling}function Vo(s){for(s=s.child;s!==null;){var a=s;switch(a.tag){case 0:case 11:case 14:case 15:Bi(4,a,a.return),Vo(a);break;case 1:Oa(a,a.return);var o=a.stateNode;typeof o.componentWillUnmount=="function"&&Qv(a,a.return,o),Vo(a);break;case 27:$c(a.stateNode);case 26:case 5:Oa(a,a.return),Vo(a);break;case 22:a.memoizedState===null&&Vo(a);break;case 30:Vo(a);break;default:Vo(a)}s=s.sibling}}function ui(s,a,o){for(o=o&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var c=a.alternate,m=s,f=a,w=f.flags;switch(f.tag){case 0:case 11:case 15:ui(m,f,o),Pc(4,f);break;case 1:if(ui(m,f,o),c=f,m=c.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(de){Qs(c,c.return,de)}if(c=f,m=c.updateQueue,m!==null){var N=c.stateNode;try{var q=m.shared.hiddenCallbacks;if(q!==null)for(m.shared.hiddenCallbacks=null,m=0;m<q.length;m++)Bb(q[m],N)}catch(de){Qs(c,c.return,de)}}o&&w&64&&Yv(f),Lc(f,f.return);break;case 27:Zv(f);case 26:case 5:ui(m,f,o),o&&c===null&&w&4&&Xv(f),Lc(f,f.return);break;case 12:ui(m,f,o);break;case 31:ui(m,f,o),o&&w&4&&r0(m,f);break;case 13:ui(m,f,o),o&&w&4&&a0(m,f);break;case 22:f.memoizedState===null&&ui(m,f,o),Lc(f,f.return);break;case 30:break;default:ui(m,f,o)}a=a.sibling}}function Of(s,a){var o=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),s=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(s=a.memoizedState.cachePool.pool),s!==o&&(s!=null&&s.refCount++,o!=null&&_c(o))}function Bf(s,a){s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&_c(s))}function _a(s,a,o,c){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)l0(s,a,o,c),a=a.sibling}function l0(s,a,o,c){var m=a.flags;switch(a.tag){case 0:case 11:case 15:_a(s,a,o,c),m&2048&&Pc(9,a);break;case 1:_a(s,a,o,c);break;case 3:_a(s,a,o,c),m&2048&&(s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&_c(s)));break;case 12:if(m&2048){_a(s,a,o,c),s=a.stateNode;try{var f=a.memoizedProps,w=f.id,N=f.onPostCommit;typeof N=="function"&&N(w,a.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(q){Qs(a,a.return,q)}}else _a(s,a,o,c);break;case 31:_a(s,a,o,c);break;case 13:_a(s,a,o,c);break;case 23:break;case 22:f=a.stateNode,w=a.alternate,a.memoizedState!==null?f._visibility&2?_a(s,a,o,c):Oc(s,a):f._visibility&2?_a(s,a,o,c):(f._visibility|=2,El(s,a,o,c,(a.subtreeFlags&10256)!==0||!1)),m&2048&&Of(w,a);break;case 24:_a(s,a,o,c),m&2048&&Bf(a.alternate,a);break;default:_a(s,a,o,c)}}function El(s,a,o,c,m){for(m=m&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var f=s,w=a,N=o,q=c,de=w.flags;switch(w.tag){case 0:case 11:case 15:El(f,w,N,q,m),Pc(8,w);break;case 23:break;case 22:var Ce=w.stateNode;w.memoizedState!==null?Ce._visibility&2?El(f,w,N,q,m):Oc(f,w):(Ce._visibility|=2,El(f,w,N,q,m)),m&&de&2048&&Of(w.alternate,w);break;case 24:El(f,w,N,q,m),m&&de&2048&&Bf(w.alternate,w);break;default:El(f,w,N,q,m)}a=a.sibling}}function Oc(s,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var o=s,c=a,m=c.flags;switch(c.tag){case 22:Oc(o,c),m&2048&&Of(c.alternate,c);break;case 24:Oc(o,c),m&2048&&Bf(c.alternate,c);break;default:Oc(o,c)}a=a.sibling}}var Bc=8192;function Nl(s,a,o){if(s.subtreeFlags&Bc)for(s=s.child;s!==null;)c0(s,a,o),s=s.sibling}function c0(s,a,o){switch(s.tag){case 26:Nl(s,a,o),s.flags&Bc&&s.memoizedState!==null&&gT(o,wa,s.memoizedState,s.memoizedProps);break;case 5:Nl(s,a,o);break;case 3:case 4:var c=wa;wa=zd(s.stateNode.containerInfo),Nl(s,a,o),wa=c;break;case 22:s.memoizedState===null&&(c=s.alternate,c!==null&&c.memoizedState!==null?(c=Bc,Bc=16777216,Nl(s,a,o),Bc=c):Nl(s,a,o));break;default:Nl(s,a,o)}}function u0(s){var a=s.alternate;if(a!==null&&(s=a.child,s!==null)){a.child=null;do a=s.sibling,s.sibling=null,s=a;while(s!==null)}}function Vc(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var o=0;o<a.length;o++){var c=a[o];Xn=c,h0(c,s)}u0(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)d0(s),s=s.sibling}function d0(s){switch(s.tag){case 0:case 11:case 15:Vc(s),s.flags&2048&&Bi(9,s,s.return);break;case 3:Vc(s);break;case 12:Vc(s);break;case 22:var a=s.stateNode;s.memoizedState!==null&&a._visibility&2&&(s.return===null||s.return.tag!==13)?(a._visibility&=-3,Cd(s)):Vc(s);break;default:Vc(s)}}function Cd(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var o=0;o<a.length;o++){var c=a[o];Xn=c,h0(c,s)}u0(s)}for(s=s.child;s!==null;){switch(a=s,a.tag){case 0:case 11:case 15:Bi(8,a,a.return),Cd(a);break;case 22:o=a.stateNode,o._visibility&2&&(o._visibility&=-3,Cd(a));break;default:Cd(a)}s=s.sibling}}function h0(s,a){for(;Xn!==null;){var o=Xn;switch(o.tag){case 0:case 11:case 15:Bi(8,o,a);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:_c(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,Xn=c;else e:for(o=s;Xn!==null;){c=Xn;var m=c.sibling,f=c.return;if(s0(c),c===o){Xn=null;break e}if(m!==null){m.return=f,Xn=m;break e}Xn=f}}}var Aj={getCacheForType:function(s){var a=ir(Pn),o=a.data.get(s);return o===void 0&&(o=s(),a.data.set(s,o)),o},cacheSignal:function(){return ir(Pn).controller.signal}},Ij=typeof WeakMap=="function"?WeakMap:Map,qs=0,an=null,gs=null,ws=0,Ys=0,Yr=null,Vi=!1,Sl=!1,Vf=!1,di=0,kn=0,Ui=0,Uo=0,Uf=0,Qr=0,Cl=0,Uc=null,Ur=null,Ff=!1,Rd=0,m0=0,Ad=1/0,Id=null,Fi=null,$n=0,zi=null,Rl=null,hi=0,zf=0,qf=null,f0=null,Fc=0,Hf=null;function Xr(){return(qs&2)!==0&&ws!==0?ws&-ws:B.T!==null?Qf():Se()}function p0(){if(Qr===0)if((ws&536870912)===0||Rs){var s=J;J<<=1,(J&3932160)===0&&(J=262144),Qr=s}else Qr=536870912;return s=Gr.current,s!==null&&(s.flags|=32),Qr}function Fr(s,a,o){(s===an&&(Ys===2||Ys===9)||s.cancelPendingCommit!==null)&&(Al(s,0),qi(s,ws,Qr,!1)),Ge(s,o),((qs&2)===0||s!==an)&&(s===an&&((qs&2)===0&&(Uo|=o),kn===4&&qi(s,ws,Qr,!1)),Ba(s))}function g0(s,a,o){if((qs&6)!==0)throw Error(i(327));var c=!o&&(a&127)===0&&(a&s.expiredLanes)===0||Ye(s,a),m=c?Pj(s,a):Wf(s,a,!0),f=c;do{if(m===0){Sl&&!c&&qi(s,a,0,!1);break}else{if(o=s.current.alternate,f&&!Mj(o)){m=Wf(s,a,!1),f=!1;continue}if(m===2){if(f=a,s.errorRecoveryDisabledLanes&f)var w=0;else w=s.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){a=w;e:{var N=s;m=Uc;var q=N.current.memoizedState.isDehydrated;if(q&&(Al(N,w).flags|=256),w=Wf(N,w,!1),w!==2){if(Vf&&!q){N.errorRecoveryDisabledLanes|=f,Uo|=f,m=4;break e}f=Ur,Ur=m,f!==null&&(Ur===null?Ur=f:Ur.push.apply(Ur,f))}m=w}if(f=!1,m!==2)continue}}if(m===1){Al(s,0),qi(s,a,0,!0);break}e:{switch(c=s,f=m,f){case 0:case 1:throw Error(i(345));case 4:if((a&4194048)!==a)break;case 6:qi(c,a,Qr,!Vi);break e;case 2:Ur=null;break;case 3:case 5:break;default:throw Error(i(329))}if((a&62914560)===a&&(m=Rd+300-Ft(),10<m)){if(qi(c,a,Qr,!Vi),bt(c,0,!0)!==0)break e;hi=a,c.timeoutHandle=G0(y0.bind(null,c,o,Ur,Id,Ff,a,Qr,Uo,Cl,Vi,f,"Throttled",-0,0),m);break e}y0(c,o,Ur,Id,Ff,a,Qr,Uo,Cl,Vi,f,null,-0,0)}}break}while(!0);Ba(s)}function y0(s,a,o,c,m,f,w,N,q,de,Ce,Ve,me,we){if(s.timeoutHandle=-1,Ve=a.subtreeFlags,Ve&8192||(Ve&16785408)===16785408){Ve={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Zt},c0(a,f,Ve);var Tt=(f&62914560)===f?Rd-Ft():(f&4194048)===f?m0-Ft():0;if(Tt=yT(Ve,Tt),Tt!==null){hi=f,s.cancelPendingCommit=Tt(T0.bind(null,s,a,f,o,c,m,w,N,q,Ce,Ve,null,me,we)),qi(s,f,w,!de);return}}T0(s,a,f,o,c,m,w,N,q)}function Mj(s){for(var a=s;;){var o=a.tag;if((o===0||o===11||o===15)&&a.flags&16384&&(o=a.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var m=o[c],f=m.getSnapshot;m=m.value;try{if(!$r(f(),m))return!1}catch{return!1}}if(o=a.child,a.subtreeFlags&16384&&o!==null)o.return=a,a=o;else{if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function qi(s,a,o,c){a&=~Uf,a&=~Uo,s.suspendedLanes|=a,s.pingedLanes&=~a,c&&(s.warmLanes|=a),c=s.expirationTimes;for(var m=a;0<m;){var f=31-De(m),w=1<<f;c[f]=-1,m&=~w}o!==0&&Je(s,o,a)}function Md(){return(qs&6)===0?(zc(0),!1):!0}function $f(){if(gs!==null){if(Ys===0)var s=gs.return;else s=gs,ti=Ao=null,of(s),wl=null,jc=0,s=gs;for(;s!==null;)Kv(s.alternate,s),s=s.return;gs=null}}function Al(s,a){var o=s.timeoutHandle;o!==-1&&(s.timeoutHandle=-1,Zj(o)),o=s.cancelPendingCommit,o!==null&&(s.cancelPendingCommit=null,o()),hi=0,$f(),an=s,gs=o=Za(s.current,null),ws=a,Ys=0,Yr=null,Vi=!1,Sl=Ye(s,a),Vf=!1,Cl=Qr=Uf=Uo=Ui=kn=0,Ur=Uc=null,Ff=!1,(a&8)!==0&&(a|=a&32);var c=s.entangledLanes;if(c!==0)for(s=s.entanglements,c&=a;0<c;){var m=31-De(c),f=1<<m;a|=s[m],c&=~f}return di=a,ed(),o}function b0(s,a){cs=null,B.H=Ic,a===xl||a===ld?(a=Db(),Ys=3):a===Km?(a=Db(),Ys=4):Ys=a===kf?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Yr=a,gs===null&&(kn=1,_d(s,ia(a,s.current)))}function v0(){var s=Gr.current;return s===null?!0:(ws&4194048)===ws?ua===null:(ws&62914560)===ws||(ws&536870912)!==0?s===ua:!1}function x0(){var s=B.H;return B.H=Ic,s===null?Ic:s}function w0(){var s=B.A;return B.A=Aj,s}function Dd(){kn=4,Vi||(ws&4194048)!==ws&&Gr.current!==null||(Sl=!0),(Ui&134217727)===0&&(Uo&134217727)===0||an===null||qi(an,ws,Qr,!1)}function Wf(s,a,o){var c=qs;qs|=2;var m=x0(),f=w0();(an!==s||ws!==a)&&(Id=null,Al(s,a)),a=!1;var w=kn;e:do try{if(Ys!==0&&gs!==null){var N=gs,q=Yr;switch(Ys){case 8:$f(),w=6;break e;case 3:case 2:case 9:case 6:Gr.current===null&&(a=!0);var de=Ys;if(Ys=0,Yr=null,Il(s,N,q,de),o&&Sl){w=0;break e}break;default:de=Ys,Ys=0,Yr=null,Il(s,N,q,de)}}Dj(),w=kn;break}catch(Ce){b0(s,Ce)}while(!0);return a&&s.shellSuspendCounter++,ti=Ao=null,qs=c,B.H=m,B.A=f,gs===null&&(an=null,ws=0,ed()),w}function Dj(){for(;gs!==null;)_0(gs)}function Pj(s,a){var o=qs;qs|=2;var c=x0(),m=w0();an!==s||ws!==a?(Id=null,Ad=Ft()+500,Al(s,a)):Sl=Ye(s,a);e:do try{if(Ys!==0&&gs!==null){a=gs;var f=Yr;t:switch(Ys){case 1:Ys=0,Yr=null,Il(s,a,f,1);break;case 2:case 9:if(Ib(f)){Ys=0,Yr=null,k0(a);break}a=function(){Ys!==2&&Ys!==9||an!==s||(Ys=7),Ba(s)},f.then(a,a);break e;case 3:Ys=7;break e;case 4:Ys=5;break e;case 7:Ib(f)?(Ys=0,Yr=null,k0(a)):(Ys=0,Yr=null,Il(s,a,f,7));break;case 5:var w=null;switch(gs.tag){case 26:w=gs.memoizedState;case 5:case 27:var N=gs;if(w?l1(w):N.stateNode.complete){Ys=0,Yr=null;var q=N.sibling;if(q!==null)gs=q;else{var de=N.return;de!==null?(gs=de,Pd(de)):gs=null}break t}}Ys=0,Yr=null,Il(s,a,f,5);break;case 6:Ys=0,Yr=null,Il(s,a,f,6);break;case 8:$f(),kn=6;break e;default:throw Error(i(462))}}Lj();break}catch(Ce){b0(s,Ce)}while(!0);return ti=Ao=null,B.H=c,B.A=m,qs=o,gs!==null?0:(an=null,ws=0,ed(),kn)}function Lj(){for(;gs!==null&&!qt();)_0(gs)}function _0(s){var a=Wv(s.alternate,s,di);s.memoizedProps=s.pendingProps,a===null?Pd(s):gs=a}function k0(s){var a=s,o=a.alternate;switch(a.tag){case 15:case 0:a=Uv(o,a,a.pendingProps,a.type,void 0,ws);break;case 11:a=Uv(o,a,a.pendingProps,a.type.render,a.ref,ws);break;case 5:of(a);default:Kv(o,a),a=gs=wb(a,di),a=Wv(o,a,di)}s.memoizedProps=s.pendingProps,a===null?Pd(s):gs=a}function Il(s,a,o,c){ti=Ao=null,of(a),wl=null,jc=0;var m=a.return;try{if(jj(s,m,a,o,ws)){kn=1,_d(s,ia(o,s.current)),gs=null;return}}catch(f){if(m!==null)throw gs=m,f;kn=1,_d(s,ia(o,s.current)),gs=null;return}a.flags&32768?(Rs||c===1?s=!0:Sl||(ws&536870912)!==0?s=!1:(Vi=s=!0,(c===2||c===9||c===3||c===6)&&(c=Gr.current,c!==null&&c.tag===13&&(c.flags|=16384))),j0(a,s)):Pd(a)}function Pd(s){var a=s;do{if((a.flags&32768)!==0){j0(a,Vi);return}s=a.return;var o=Nj(a.alternate,a,di);if(o!==null){gs=o;return}if(a=a.sibling,a!==null){gs=a;return}gs=a=s}while(a!==null);kn===0&&(kn=5)}function j0(s,a){do{var o=Sj(s.alternate,s);if(o!==null){o.flags&=32767,gs=o;return}if(o=s.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!a&&(s=s.sibling,s!==null)){gs=s;return}gs=s=o}while(s!==null);kn=6,gs=null}function T0(s,a,o,c,m,f,w,N,q){s.cancelPendingCommit=null;do Ld();while($n!==0);if((qs&6)!==0)throw Error(i(327));if(a!==null){if(a===s.current)throw Error(i(177));if(f=a.lanes|a.childLanes,f|=Mm,ht(s,o,f,w,N,q),s===an&&(gs=an=null,ws=0),Rl=a,zi=s,hi=o,zf=f,qf=m,f0=c,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Uj(as,function(){return R0(),null})):(s.callbackNode=null,s.callbackPriority=0),c=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||c){c=B.T,B.T=null,m=se.p,se.p=2,w=qs,qs|=4;try{Cj(s,a,o)}finally{qs=w,se.p=m,B.T=c}}$n=1,E0(),N0(),S0()}}function E0(){if($n===1){$n=0;var s=zi,a=Rl,o=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||o){o=B.T,B.T=null;var c=se.p;se.p=2;var m=qs;qs|=4;try{i0(a,s);var f=rp,w=hb(s.containerInfo),N=f.focusedElem,q=f.selectionRange;if(w!==N&&N&&N.ownerDocument&&db(N.ownerDocument.documentElement,N)){if(q!==null&&Sm(N)){var de=q.start,Ce=q.end;if(Ce===void 0&&(Ce=de),"selectionStart"in N)N.selectionStart=de,N.selectionEnd=Math.min(Ce,N.value.length);else{var Ve=N.ownerDocument||document,me=Ve&&Ve.defaultView||window;if(me.getSelection){var we=me.getSelection(),Tt=N.textContent.length,Ut=Math.min(q.start,Tt),en=q.end===void 0?Ut:Math.min(q.end,Tt);!we.extend&&Ut>en&&(w=en,en=Ut,Ut=w);var Z=ub(N,Ut),H=ub(N,en);if(Z&&H&&(we.rangeCount!==1||we.anchorNode!==Z.node||we.anchorOffset!==Z.offset||we.focusNode!==H.node||we.focusOffset!==H.offset)){var ue=Ve.createRange();ue.setStart(Z.node,Z.offset),we.removeAllRanges(),Ut>en?(we.addRange(ue),we.extend(H.node,H.offset)):(ue.setEnd(H.node,H.offset),we.addRange(ue))}}}}for(Ve=[],we=N;we=we.parentNode;)we.nodeType===1&&Ve.push({element:we,left:we.scrollLeft,top:we.scrollTop});for(typeof N.focus=="function"&&N.focus(),N=0;N<Ve.length;N++){var Le=Ve[N];Le.element.scrollLeft=Le.left,Le.element.scrollTop=Le.top}}Kd=!!np,rp=np=null}finally{qs=m,se.p=c,B.T=o}}s.current=a,$n=2}}function N0(){if($n===2){$n=0;var s=zi,a=Rl,o=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||o){o=B.T,B.T=null;var c=se.p;se.p=2;var m=qs;qs|=4;try{t0(s,a.alternate,a)}finally{qs=m,se.p=c,B.T=o}}$n=3}}function S0(){if($n===4||$n===3){$n=0,ms();var s=zi,a=Rl,o=hi,c=f0;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?$n=5:($n=0,Rl=zi=null,C0(s,s.pendingLanes));var m=s.pendingLanes;if(m===0&&(Fi=null),fe(o),a=a.stateNode,ye&&typeof ye.onCommitFiberRoot=="function")try{ye.onCommitFiberRoot(xs,a,void 0,(a.current.flags&128)===128)}catch{}if(c!==null){a=B.T,m=se.p,se.p=2,B.T=null;try{for(var f=s.onRecoverableError,w=0;w<c.length;w++){var N=c[w];f(N.value,{componentStack:N.stack})}}finally{B.T=a,se.p=m}}(hi&3)!==0&&Ld(),Ba(s),m=s.pendingLanes,(o&261930)!==0&&(m&42)!==0?s===Hf?Fc++:(Fc=0,Hf=s):Fc=0,zc(0)}}function C0(s,a){(s.pooledCacheLanes&=a)===0&&(a=s.pooledCache,a!=null&&(s.pooledCache=null,_c(a)))}function Ld(){return E0(),N0(),S0(),R0()}function R0(){if($n!==5)return!1;var s=zi,a=zf;zf=0;var o=fe(hi),c=B.T,m=se.p;try{se.p=32>o?32:o,B.T=null,o=qf,qf=null;var f=zi,w=hi;if($n=0,Rl=zi=null,hi=0,(qs&6)!==0)throw Error(i(331));var N=qs;if(qs|=4,d0(f.current),l0(f,f.current,w,o),qs=N,zc(0,!1),ye&&typeof ye.onPostCommitFiberRoot=="function")try{ye.onPostCommitFiberRoot(xs,f)}catch{}return!0}finally{se.p=m,B.T=c,C0(s,a)}}function A0(s,a,o){a=ia(o,a),a=_f(s.stateNode,a,2),s=Pi(s,a,2),s!==null&&(Ge(s,2),Ba(s))}function Qs(s,a,o){if(s.tag===3)A0(s,s,o);else for(;a!==null;){if(a.tag===3){A0(a,s,o);break}else if(a.tag===1){var c=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Fi===null||!Fi.has(c))){s=ia(o,s),o=Iv(2),c=Pi(a,o,2),c!==null&&(Mv(o,c,a,s),Ge(c,2),Ba(c));break}}a=a.return}}function Gf(s,a,o){var c=s.pingCache;if(c===null){c=s.pingCache=new Ij;var m=new Set;c.set(a,m)}else m=c.get(a),m===void 0&&(m=new Set,c.set(a,m));m.has(o)||(Vf=!0,m.add(o),s=Oj.bind(null,s,a,o),a.then(s,s))}function Oj(s,a,o){var c=s.pingCache;c!==null&&c.delete(a),s.pingedLanes|=s.suspendedLanes&o,s.warmLanes&=~o,an===s&&(ws&o)===o&&(kn===4||kn===3&&(ws&62914560)===ws&&300>Ft()-Rd?(qs&2)===0&&Al(s,0):Uf|=o,Cl===ws&&(Cl=0)),Ba(s)}function I0(s,a){a===0&&(a=X()),s=So(s,a),s!==null&&(Ge(s,a),Ba(s))}function Bj(s){var a=s.memoizedState,o=0;a!==null&&(o=a.retryLane),I0(s,o)}function Vj(s,a){var o=0;switch(s.tag){case 31:case 13:var c=s.stateNode,m=s.memoizedState;m!==null&&(o=m.retryLane);break;case 19:c=s.stateNode;break;case 22:c=s.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(a),I0(s,o)}function Uj(s,a){return tt(s,a)}var Od=null,Ml=null,Kf=!1,Bd=!1,Yf=!1,Hi=0;function Ba(s){s!==Ml&&s.next===null&&(Ml===null?Od=Ml=s:Ml=Ml.next=s),Bd=!0,Kf||(Kf=!0,zj())}function zc(s,a){if(!Yf&&Bd){Yf=!0;do for(var o=!1,c=Od;c!==null;){if(s!==0){var m=c.pendingLanes;if(m===0)var f=0;else{var w=c.suspendedLanes,N=c.pingedLanes;f=(1<<31-De(42|s)+1)-1,f&=m&~(w&~N),f=f&201326741?f&201326741|1:f?f|2:0}f!==0&&(o=!0,L0(c,f))}else f=ws,f=bt(c,c===an?f:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(f&3)===0||Ye(c,f)||(o=!0,L0(c,f));c=c.next}while(o);Yf=!1}}function Fj(){M0()}function M0(){Bd=Kf=!1;var s=0;Hi!==0&&Jj()&&(s=Hi);for(var a=Ft(),o=null,c=Od;c!==null;){var m=c.next,f=D0(c,a);f===0?(c.next=null,o===null?Od=m:o.next=m,m===null&&(Ml=o)):(o=c,(s!==0||(f&3)!==0)&&(Bd=!0)),c=m}$n!==0&&$n!==5||zc(s),Hi!==0&&(Hi=0)}function D0(s,a){for(var o=s.suspendedLanes,c=s.pingedLanes,m=s.expirationTimes,f=s.pendingLanes&-62914561;0<f;){var w=31-De(f),N=1<<w,q=m[w];q===-1?((N&o)===0||(N&c)!==0)&&(m[w]=vt(N,a)):q<=a&&(s.expiredLanes|=N),f&=~N}if(a=an,o=ws,o=bt(s,s===a?o:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c=s.callbackNode,o===0||s===a&&(Ys===2||Ys===9)||s.cancelPendingCommit!==null)return c!==null&&c!==null&&Mt(c),s.callbackNode=null,s.callbackPriority=0;if((o&3)===0||Ye(s,o)){if(a=o&-o,a===s.callbackPriority)return a;switch(c!==null&&Mt(c),fe(o)){case 2:case 8:o=vs;break;case 32:o=as;break;case 268435456:o=Ds;break;default:o=as}return c=P0.bind(null,s),o=tt(o,c),s.callbackPriority=a,s.callbackNode=o,a}return c!==null&&c!==null&&Mt(c),s.callbackPriority=2,s.callbackNode=null,2}function P0(s,a){if($n!==0&&$n!==5)return s.callbackNode=null,s.callbackPriority=0,null;var o=s.callbackNode;if(Ld()&&s.callbackNode!==o)return null;var c=ws;return c=bt(s,s===an?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c===0?null:(g0(s,c,a),D0(s,Ft()),s.callbackNode!=null&&s.callbackNode===o?P0.bind(null,s):null)}function L0(s,a){if(Ld())return null;g0(s,a,!0)}function zj(){eT(function(){(qs&6)!==0?tt(us,Fj):M0()})}function Qf(){if(Hi===0){var s=bl;s===0&&(s=ut,ut<<=1,(ut&261888)===0&&(ut=256)),Hi=s}return Hi}function O0(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:$s(""+s)}function B0(s,a){var o=a.ownerDocument.createElement("input");return o.name=a.name,o.value=a.value,s.id&&o.setAttribute("form",s.id),a.parentNode.insertBefore(o,a),s=new FormData(s),o.parentNode.removeChild(o),s}function qj(s,a,o,c,m){if(a==="submit"&&o&&o.stateNode===m){var f=O0((m[Nt]||null).action),w=c.submitter;w&&(a=(a=w[Nt]||null)?O0(a.formAction):w.getAttribute("formAction"),a!==null&&(f=a,w=null));var N=new Vt("action","action",null,c,m);s.push({event:N,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Hi!==0){var q=w?B0(m,w):new FormData(m);gf(o,{pending:!0,data:q,method:m.method,action:f},null,q)}}else typeof f=="function"&&(N.preventDefault(),q=w?B0(m,w):new FormData(m),gf(o,{pending:!0,data:q,method:m.method,action:f},f,q))},currentTarget:m}]})}}for(var Xf=0;Xf<Im.length;Xf++){var Jf=Im[Xf],Hj=Jf.toLowerCase(),$j=Jf[0].toUpperCase()+Jf.slice(1);xa(Hj,"on"+$j)}xa(pb,"onAnimationEnd"),xa(gb,"onAnimationIteration"),xa(yb,"onAnimationStart"),xa("dblclick","onDoubleClick"),xa("focusin","onFocus"),xa("focusout","onBlur"),xa(oj,"onTransitionRun"),xa(lj,"onTransitionStart"),xa(cj,"onTransitionCancel"),xa(bb,"onTransitionEnd"),z("onMouseEnter",["mouseout","mouseover"]),z("onMouseLeave",["mouseout","mouseover"]),z("onPointerEnter",["pointerout","pointerover"]),z("onPointerLeave",["pointerout","pointerover"]),E("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),E("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),E("onBeforeInput",["compositionend","keypress","textInput","paste"]),E("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),E("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),E("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var qc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Wj=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(qc));function V0(s,a){a=(a&4)!==0;for(var o=0;o<s.length;o++){var c=s[o],m=c.event;c=c.listeners;e:{var f=void 0;if(a)for(var w=c.length-1;0<=w;w--){var N=c[w],q=N.instance,de=N.currentTarget;if(N=N.listener,q!==f&&m.isPropagationStopped())break e;f=N,m.currentTarget=de;try{f(m)}catch(Ce){Zu(Ce)}m.currentTarget=null,f=q}else for(w=0;w<c.length;w++){if(N=c[w],q=N.instance,de=N.currentTarget,N=N.listener,q!==f&&m.isPropagationStopped())break e;f=N,m.currentTarget=de;try{f(m)}catch(Ce){Zu(Ce)}m.currentTarget=null,f=q}}}}function ys(s,a){var o=a[Bt];o===void 0&&(o=a[Bt]=new Set);var c=s+"__bubble";o.has(c)||(U0(a,s,2,!1),o.add(c))}function Zf(s,a,o){var c=0;a&&(c|=4),U0(o,s,c,a)}var Vd="_reactListening"+Math.random().toString(36).slice(2);function ep(s){if(!s[Vd]){s[Vd]=!0,ce.forEach(function(o){o!=="selectionchange"&&(Wj.has(o)||Zf(o,!1,s),Zf(o,!0,s))});var a=s.nodeType===9?s:s.ownerDocument;a===null||a[Vd]||(a[Vd]=!0,Zf("selectionchange",!1,a))}}function U0(s,a,o,c){switch(p1(a)){case 2:var m=xT;break;case 8:m=wT;break;default:m=pp}o=m.bind(null,a,o,s),m=void 0,!Ir||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(m=!0),c?m!==void 0?s.addEventListener(a,o,{capture:!0,passive:m}):s.addEventListener(a,o,!0):m!==void 0?s.addEventListener(a,o,{passive:m}):s.addEventListener(a,o,!1)}function tp(s,a,o,c,m){var f=c;if((a&1)===0&&(a&2)===0&&c!==null)e:for(;;){if(c===null)return;var w=c.tag;if(w===3||w===4){var N=c.stateNode.containerInfo;if(N===m)break;if(w===4)for(w=c.return;w!==null;){var q=w.tag;if((q===3||q===4)&&w.stateNode.containerInfo===m)return;w=w.return}for(;N!==null;){if(w=Ks(N),w===null)return;if(q=w.tag,q===5||q===6||q===26||q===27){c=f=w;continue e}N=N.parentNode}}c=c.return}hr(function(){var de=f,Ce=on(o),Ve=[];e:{var me=vb.get(s);if(me!==void 0){var we=Vt,Tt=s;switch(s){case"keypress":if(C(o)===0)break e;case"keydown":case"keyup":we=Ja;break;case"focusin":Tt="focus",we=qn;break;case"focusout":Tt="blur",we=qn;break;case"beforeblur":case"afterblur":we=qn;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":we=Hr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":we=un;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":we=v;break;case pb:case gb:case yb:we=sr;break;case bb:we=A;break;case"scroll":case"scrollend":we=es;break;case"wheel":we=be;break;case"copy":case"cut":case"paste":we=Dr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":we=fr;break;case"toggle":case"beforetoggle":we=ls}var Ut=(a&4)!==0,en=!Ut&&(s==="scroll"||s==="scrollend"),Z=Ut?me!==null?me+"Capture":null:me;Ut=[];for(var H=de,ue;H!==null;){var Le=H;if(ue=Le.stateNode,Le=Le.tag,Le!==5&&Le!==26&&Le!==27||ue===null||Z===null||(Le=Yn(H,Z),Le!=null&&Ut.push(Hc(H,Le,ue))),en)break;H=H.return}0<Ut.length&&(me=new we(me,Tt,null,o,Ce),Ve.push({event:me,listeners:Ut}))}}if((a&7)===0){e:{if(me=s==="mouseover"||s==="pointerover",we=s==="mouseout"||s==="pointerout",me&&o!==Ls&&(Tt=o.relatedTarget||o.fromElement)&&(Ks(Tt)||Tt[lt]))break e;if((we||me)&&(me=Ce.window===Ce?Ce:(me=Ce.ownerDocument)?me.defaultView||me.parentWindow:window,we?(Tt=o.relatedTarget||o.toElement,we=de,Tt=Tt?Ks(Tt):null,Tt!==null&&(en=u(Tt),Ut=Tt.tag,Tt!==en||Ut!==5&&Ut!==27&&Ut!==6)&&(Tt=null)):(we=null,Tt=de),we!==Tt)){if(Ut=Hr,Le="onMouseLeave",Z="onMouseEnter",H="mouse",(s==="pointerout"||s==="pointerover")&&(Ut=fr,Le="onPointerLeave",Z="onPointerEnter",H="pointer"),en=we==null?me:Ns(we),ue=Tt==null?me:Ns(Tt),me=new Ut(Le,H+"leave",we,o,Ce),me.target=en,me.relatedTarget=ue,Le=null,Ks(Ce)===de&&(Ut=new Ut(Z,H+"enter",Tt,o,Ce),Ut.target=ue,Ut.relatedTarget=en,Le=Ut),en=Le,we&&Tt)t:{for(Ut=Gj,Z=we,H=Tt,ue=0,Le=Z;Le;Le=Ut(Le))ue++;Le=0;for(var Pt=H;Pt;Pt=Ut(Pt))Le++;for(;0<ue-Le;)Z=Ut(Z),ue--;for(;0<Le-ue;)H=Ut(H),Le--;for(;ue--;){if(Z===H||H!==null&&Z===H.alternate){Ut=Z;break t}Z=Ut(Z),H=Ut(H)}Ut=null}else Ut=null;we!==null&&F0(Ve,me,we,Ut,!1),Tt!==null&&en!==null&&F0(Ve,en,Tt,Ut,!0)}}e:{if(me=de?Ns(de):window,we=me.nodeName&&me.nodeName.toLowerCase(),we==="select"||we==="input"&&me.type==="file")var Vs=rb;else if(sb(me))if(ab)Vs=rj;else{Vs=sj;var St=tj}else we=me.nodeName,!we||we.toLowerCase()!=="input"||me.type!=="checkbox"&&me.type!=="radio"?de&&xn(de.elementType)&&(Vs=rb):Vs=nj;if(Vs&&(Vs=Vs(s,de))){nb(Ve,Vs,o,Ce);break e}St&&St(s,me,de),s==="focusout"&&de&&me.type==="number"&&de.memoizedProps.value!=null&&at(me,"number",me.value)}switch(St=de?Ns(de):window,s){case"focusin":(sb(St)||St.contentEditable==="true")&&(ul=St,Cm=de,vc=null);break;case"focusout":vc=Cm=ul=null;break;case"mousedown":Rm=!0;break;case"contextmenu":case"mouseup":case"dragend":Rm=!1,mb(Ve,o,Ce);break;case"selectionchange":if(ij)break;case"keydown":case"keyup":mb(Ve,o,Ce)}var hs;if(zs)e:{switch(s){case"compositionstart":var _s="onCompositionStart";break e;case"compositionend":_s="onCompositionEnd";break e;case"compositionupdate":_s="onCompositionUpdate";break e}_s=void 0}else cl?To(s,o)&&(_s="onCompositionEnd"):s==="keydown"&&o.keyCode===229&&(_s="onCompositionStart");_s&&(Da&&o.locale!=="ko"&&(cl||_s!=="onCompositionStart"?_s==="onCompositionEnd"&&cl&&(hs=ko()):(na=Ce,_o="value"in na?na.value:na.textContent,cl=!0)),St=Ud(de,_s),0<St.length&&(_s=new wn(_s,s,null,o,Ce),Ve.push({event:_s,listeners:St}),hs?_s.data=hs:(hs=ll(o),hs!==null&&(_s.data=hs)))),(hs=ra?Xk(s,o):Jk(s,o))&&(_s=Ud(de,"onBeforeInput"),0<_s.length&&(St=new wn("onBeforeInput","beforeinput",null,o,Ce),Ve.push({event:St,listeners:_s}),St.data=hs)),qj(Ve,s,de,o,Ce)}V0(Ve,a)})}function Hc(s,a,o){return{instance:s,listener:a,currentTarget:o}}function Ud(s,a){for(var o=a+"Capture",c=[];s!==null;){var m=s,f=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||f===null||(m=Yn(s,o),m!=null&&c.unshift(Hc(s,m,f)),m=Yn(s,a),m!=null&&c.push(Hc(s,m,f))),s.tag===3)return c;s=s.return}return[]}function Gj(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function F0(s,a,o,c,m){for(var f=a._reactName,w=[];o!==null&&o!==c;){var N=o,q=N.alternate,de=N.stateNode;if(N=N.tag,q!==null&&q===c)break;N!==5&&N!==26&&N!==27||de===null||(q=de,m?(de=Yn(o,f),de!=null&&w.unshift(Hc(o,de,q))):m||(de=Yn(o,f),de!=null&&w.push(Hc(o,de,q)))),o=o.return}w.length!==0&&s.push({event:a,listeners:w})}var Kj=/\r\n?/g,Yj=/\u0000|\uFFFD/g;function z0(s){return(typeof s=="string"?s:""+s).replace(Kj,`
`).replace(Yj,"")}function q0(s,a){return a=z0(a),z0(s)===a}function Zs(s,a,o,c,m,f){switch(o){case"children":typeof c=="string"?a==="body"||a==="textarea"&&c===""||Jt(s,c):(typeof c=="number"||typeof c=="bigint")&&a!=="body"&&Jt(s,""+c);break;case"className":It(s,"class",c);break;case"tabIndex":It(s,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":It(s,o,c);break;case"style":Ss(s,c,f);break;case"data":if(a!=="object"){It(s,"data",c);break}case"src":case"href":if(c===""&&(a!=="a"||o!=="href")){s.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(o);break}c=$s(""+c),s.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){s.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof f=="function"&&(o==="formAction"?(a!=="input"&&Zs(s,a,"name",m.name,m,null),Zs(s,a,"formEncType",m.formEncType,m,null),Zs(s,a,"formMethod",m.formMethod,m,null),Zs(s,a,"formTarget",m.formTarget,m,null)):(Zs(s,a,"encType",m.encType,m,null),Zs(s,a,"method",m.method,m,null),Zs(s,a,"target",m.target,m,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(o);break}c=$s(""+c),s.setAttribute(o,c);break;case"onClick":c!=null&&(s.onclick=Zt);break;case"onScroll":c!=null&&ys("scroll",s);break;case"onScrollEnd":c!=null&&ys("scrollend",s);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(m.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"multiple":s.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":s.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){s.removeAttribute("xlink:href");break}o=$s(""+c),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,""+c):s.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,""):s.removeAttribute(o);break;case"capture":case"download":c===!0?s.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,c):s.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?s.setAttribute(o,c):s.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?s.removeAttribute(o):s.setAttribute(o,c);break;case"popover":ys("beforetoggle",s),ys("toggle",s),st(s,"popover",c);break;case"xlinkActuate":ft(s,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":ft(s,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":ft(s,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":ft(s,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":ft(s,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":ft(s,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":ft(s,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":ft(s,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":ft(s,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":st(s,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=er.get(o)||o,st(s,o,c))}}function sp(s,a,o,c,m,f){switch(o){case"style":Ss(s,c,f);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(m.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"children":typeof c=="string"?Jt(s,c):(typeof c=="number"||typeof c=="bigint")&&Jt(s,""+c);break;case"onScroll":c!=null&&ys("scroll",s);break;case"onScrollEnd":c!=null&&ys("scrollend",s);break;case"onClick":c!=null&&(s.onclick=Zt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!_e.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(m=o.endsWith("Capture"),a=o.slice(2,m?o.length-7:void 0),f=s[Nt]||null,f=f!=null?f[o]:null,typeof f=="function"&&s.removeEventListener(a,f,m),typeof c=="function")){typeof f!="function"&&f!==null&&(o in s?s[o]=null:s.hasAttribute(o)&&s.removeAttribute(o)),s.addEventListener(a,c,m);break e}o in s?s[o]=c:c===!0?s.setAttribute(o,""):st(s,o,c)}}}function lr(s,a,o){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ys("error",s),ys("load",s);var c=!1,m=!1,f;for(f in o)if(o.hasOwnProperty(f)){var w=o[f];if(w!=null)switch(f){case"src":c=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Zs(s,a,f,w,o,null)}}m&&Zs(s,a,"srcSet",o.srcSet,o,null),c&&Zs(s,a,"src",o.src,o,null);return;case"input":ys("invalid",s);var N=f=w=m=null,q=null,de=null;for(c in o)if(o.hasOwnProperty(c)){var Ce=o[c];if(Ce!=null)switch(c){case"name":m=Ce;break;case"type":w=Ce;break;case"checked":q=Ce;break;case"defaultChecked":de=Ce;break;case"value":f=Ce;break;case"defaultValue":N=Ce;break;case"children":case"dangerouslySetInnerHTML":if(Ce!=null)throw Error(i(137,a));break;default:Zs(s,a,c,Ce,o,null)}}it(s,f,N,q,de,w,m,!1);return;case"select":ys("invalid",s),c=w=f=null;for(m in o)if(o.hasOwnProperty(m)&&(N=o[m],N!=null))switch(m){case"value":f=N;break;case"defaultValue":w=N;break;case"multiple":c=N;default:Zs(s,a,m,N,o,null)}a=f,o=w,s.multiple=!!c,a!=null?pt(s,!!c,a,!1):o!=null&&pt(s,!!c,o,!0);return;case"textarea":ys("invalid",s),f=m=c=null;for(w in o)if(o.hasOwnProperty(w)&&(N=o[w],N!=null))switch(w){case"value":c=N;break;case"defaultValue":m=N;break;case"children":f=N;break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(i(91));break;default:Zs(s,a,w,N,o,null)}Qt(s,c,m,f);return;case"option":for(q in o)o.hasOwnProperty(q)&&(c=o[q],c!=null)&&(q==="selected"?s.selected=c&&typeof c!="function"&&typeof c!="symbol":Zs(s,a,q,c,o,null));return;case"dialog":ys("beforetoggle",s),ys("toggle",s),ys("cancel",s),ys("close",s);break;case"iframe":case"object":ys("load",s);break;case"video":case"audio":for(c=0;c<qc.length;c++)ys(qc[c],s);break;case"image":ys("error",s),ys("load",s);break;case"details":ys("toggle",s);break;case"embed":case"source":case"link":ys("error",s),ys("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(de in o)if(o.hasOwnProperty(de)&&(c=o[de],c!=null))switch(de){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Zs(s,a,de,c,o,null)}return;default:if(xn(a)){for(Ce in o)o.hasOwnProperty(Ce)&&(c=o[Ce],c!==void 0&&sp(s,a,Ce,c,o,void 0));return}}for(N in o)o.hasOwnProperty(N)&&(c=o[N],c!=null&&Zs(s,a,N,c,o,null))}function Qj(s,a,o,c){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,f=null,w=null,N=null,q=null,de=null,Ce=null;for(we in o){var Ve=o[we];if(o.hasOwnProperty(we)&&Ve!=null)switch(we){case"checked":break;case"value":break;case"defaultValue":q=Ve;default:c.hasOwnProperty(we)||Zs(s,a,we,null,c,Ve)}}for(var me in c){var we=c[me];if(Ve=o[me],c.hasOwnProperty(me)&&(we!=null||Ve!=null))switch(me){case"type":f=we;break;case"name":m=we;break;case"checked":de=we;break;case"defaultChecked":Ce=we;break;case"value":w=we;break;case"defaultValue":N=we;break;case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(i(137,a));break;default:we!==Ve&&Zs(s,a,me,we,c,Ve)}}je(s,w,N,q,de,Ce,f,m);return;case"select":we=w=N=me=null;for(f in o)if(q=o[f],o.hasOwnProperty(f)&&q!=null)switch(f){case"value":break;case"multiple":we=q;default:c.hasOwnProperty(f)||Zs(s,a,f,null,c,q)}for(m in c)if(f=c[m],q=o[m],c.hasOwnProperty(m)&&(f!=null||q!=null))switch(m){case"value":me=f;break;case"defaultValue":N=f;break;case"multiple":w=f;default:f!==q&&Zs(s,a,m,f,c,q)}a=N,o=w,c=we,me!=null?pt(s,!!o,me,!1):!!c!=!!o&&(a!=null?pt(s,!!o,a,!0):pt(s,!!o,o?[]:"",!1));return;case"textarea":we=me=null;for(N in o)if(m=o[N],o.hasOwnProperty(N)&&m!=null&&!c.hasOwnProperty(N))switch(N){case"value":break;case"children":break;default:Zs(s,a,N,null,c,m)}for(w in c)if(m=c[w],f=o[w],c.hasOwnProperty(w)&&(m!=null||f!=null))switch(w){case"value":me=m;break;case"defaultValue":we=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(i(91));break;default:m!==f&&Zs(s,a,w,m,c,f)}Yt(s,me,we);return;case"option":for(var Tt in o)me=o[Tt],o.hasOwnProperty(Tt)&&me!=null&&!c.hasOwnProperty(Tt)&&(Tt==="selected"?s.selected=!1:Zs(s,a,Tt,null,c,me));for(q in c)me=c[q],we=o[q],c.hasOwnProperty(q)&&me!==we&&(me!=null||we!=null)&&(q==="selected"?s.selected=me&&typeof me!="function"&&typeof me!="symbol":Zs(s,a,q,me,c,we));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ut in o)me=o[Ut],o.hasOwnProperty(Ut)&&me!=null&&!c.hasOwnProperty(Ut)&&Zs(s,a,Ut,null,c,me);for(de in c)if(me=c[de],we=o[de],c.hasOwnProperty(de)&&me!==we&&(me!=null||we!=null))switch(de){case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(i(137,a));break;default:Zs(s,a,de,me,c,we)}return;default:if(xn(a)){for(var en in o)me=o[en],o.hasOwnProperty(en)&&me!==void 0&&!c.hasOwnProperty(en)&&sp(s,a,en,void 0,c,me);for(Ce in c)me=c[Ce],we=o[Ce],!c.hasOwnProperty(Ce)||me===we||me===void 0&&we===void 0||sp(s,a,Ce,me,c,we);return}}for(var Z in o)me=o[Z],o.hasOwnProperty(Z)&&me!=null&&!c.hasOwnProperty(Z)&&Zs(s,a,Z,null,c,me);for(Ve in c)me=c[Ve],we=o[Ve],!c.hasOwnProperty(Ve)||me===we||me==null&&we==null||Zs(s,a,Ve,me,c,we)}function H0(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Xj(){if(typeof performance.getEntriesByType=="function"){for(var s=0,a=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var m=o[c],f=m.transferSize,w=m.initiatorType,N=m.duration;if(f&&N&&H0(w)){for(w=0,N=m.responseEnd,c+=1;c<o.length;c++){var q=o[c],de=q.startTime;if(de>N)break;var Ce=q.transferSize,Ve=q.initiatorType;Ce&&H0(Ve)&&(q=q.responseEnd,w+=Ce*(q<N?1:(N-de)/(q-de)))}if(--c,a+=8*(f+w)/(m.duration/1e3),s++,10<s)break}}if(0<s)return a/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var np=null,rp=null;function Fd(s){return s.nodeType===9?s:s.ownerDocument}function $0(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function W0(s,a){if(s===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&a==="foreignObject"?0:s}function ap(s,a){return s==="textarea"||s==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var ip=null;function Jj(){var s=window.event;return s&&s.type==="popstate"?s===ip?!1:(ip=s,!0):(ip=null,!1)}var G0=typeof setTimeout=="function"?setTimeout:void 0,Zj=typeof clearTimeout=="function"?clearTimeout:void 0,K0=typeof Promise=="function"?Promise:void 0,eT=typeof queueMicrotask=="function"?queueMicrotask:typeof K0<"u"?function(s){return K0.resolve(null).then(s).catch(tT)}:G0;function tT(s){setTimeout(function(){throw s})}function $i(s){return s==="head"}function Y0(s,a){var o=a,c=0;do{var m=o.nextSibling;if(s.removeChild(o),m&&m.nodeType===8)if(o=m.data,o==="/$"||o==="/&"){if(c===0){s.removeChild(m),Ol(a);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")$c(s.ownerDocument.documentElement);else if(o==="head"){o=s.ownerDocument.head,$c(o);for(var f=o.firstChild;f;){var w=f.nextSibling,N=f.nodeName;f[mn]||N==="SCRIPT"||N==="STYLE"||N==="LINK"&&f.rel.toLowerCase()==="stylesheet"||o.removeChild(f),f=w}}else o==="body"&&$c(s.ownerDocument.body);o=m}while(o);Ol(a)}function Q0(s,a){var o=s;s=0;do{var c=o.nextSibling;if(o.nodeType===1?a?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(a?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(s===0)break;s--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||s++;o=c}while(o)}function op(s){var a=s.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var o=a;switch(a=a.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":op(o),Nn(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}s.removeChild(o)}}function sT(s,a,o,c){for(;s.nodeType===1;){var m=o;if(s.nodeName.toLowerCase()!==a.toLowerCase()){if(!c&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(c){if(!s[mn])switch(a){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(f=s.getAttribute("rel"),f==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(f!==m.rel||s.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||s.getAttribute("title")!==(m.title==null?null:m.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(f=s.getAttribute("src"),(f!==(m.src==null?null:m.src)||s.getAttribute("type")!==(m.type==null?null:m.type)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&f&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(a==="input"&&s.type==="hidden"){var f=m.name==null?null:""+m.name;if(m.type==="hidden"&&s.getAttribute("name")===f)return s}else return s;if(s=da(s.nextSibling),s===null)break}return null}function nT(s,a,o){if(a==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!o||(s=da(s.nextSibling),s===null))return null;return s}function X0(s,a){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!a||(s=da(s.nextSibling),s===null))return null;return s}function lp(s){return s.data==="$?"||s.data==="$~"}function cp(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function rT(s,a){var o=s.ownerDocument;if(s.data==="$~")s._reactRetry=a;else if(s.data!=="$?"||o.readyState!=="loading")a();else{var c=function(){a(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),s._reactRetry=c}}function da(s){for(;s!=null;s=s.nextSibling){var a=s.nodeType;if(a===1||a===3)break;if(a===8){if(a=s.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return s}var up=null;function J0(s){s=s.nextSibling;for(var a=0;s;){if(s.nodeType===8){var o=s.data;if(o==="/$"||o==="/&"){if(a===0)return da(s.nextSibling);a--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||a++}s=s.nextSibling}return null}function Z0(s){s=s.previousSibling;for(var a=0;s;){if(s.nodeType===8){var o=s.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(a===0)return s;a--}else o!=="/$"&&o!=="/&"||a++}s=s.previousSibling}return null}function e1(s,a,o){switch(a=Fd(o),s){case"html":if(s=a.documentElement,!s)throw Error(i(452));return s;case"head":if(s=a.head,!s)throw Error(i(453));return s;case"body":if(s=a.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function $c(s){for(var a=s.attributes;a.length;)s.removeAttributeNode(a[0]);Nn(s)}var ha=new Map,t1=new Set;function zd(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var mi=se.d;se.d={f:aT,r:iT,D:oT,C:lT,L:cT,m:uT,X:hT,S:dT,M:mT};function aT(){var s=mi.f(),a=Md();return s||a}function iT(s){var a=cn(s);a!==null&&a.tag===5&&a.type==="form"?bv(a):mi.r(s)}var Dl=typeof document>"u"?null:document;function s1(s,a,o){var c=Dl;if(c&&typeof a=="string"&&a){var m=ve(a);m='link[rel="'+s+'"][href="'+m+'"]',typeof o=="string"&&(m+='[crossorigin="'+o+'"]'),t1.has(m)||(t1.add(m),s={rel:s,crossOrigin:o,href:a},c.querySelector(m)===null&&(a=c.createElement("link"),lr(a,"link",s),he(a),c.head.appendChild(a)))}}function oT(s){mi.D(s),s1("dns-prefetch",s,null)}function lT(s,a){mi.C(s,a),s1("preconnect",s,a)}function cT(s,a,o){mi.L(s,a,o);var c=Dl;if(c&&s&&a){var m='link[rel="preload"][as="'+ve(a)+'"]';a==="image"&&o&&o.imageSrcSet?(m+='[imagesrcset="'+ve(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(m+='[imagesizes="'+ve(o.imageSizes)+'"]')):m+='[href="'+ve(s)+'"]';var f=m;switch(a){case"style":f=Pl(s);break;case"script":f=Ll(s)}ha.has(f)||(s=_({rel:"preload",href:a==="image"&&o&&o.imageSrcSet?void 0:s,as:a},o),ha.set(f,s),c.querySelector(m)!==null||a==="style"&&c.querySelector(Wc(f))||a==="script"&&c.querySelector(Gc(f))||(a=c.createElement("link"),lr(a,"link",s),he(a),c.head.appendChild(a)))}}function uT(s,a){mi.m(s,a);var o=Dl;if(o&&s){var c=a&&typeof a.as=="string"?a.as:"script",m='link[rel="modulepreload"][as="'+ve(c)+'"][href="'+ve(s)+'"]',f=m;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":f=Ll(s)}if(!ha.has(f)&&(s=_({rel:"modulepreload",href:s},a),ha.set(f,s),o.querySelector(m)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Gc(f)))return}c=o.createElement("link"),lr(c,"link",s),he(c),o.head.appendChild(c)}}}function dT(s,a,o){mi.S(s,a,o);var c=Dl;if(c&&s){var m=W(c).hoistableStyles,f=Pl(s);a=a||"default";var w=m.get(f);if(!w){var N={loading:0,preload:null};if(w=c.querySelector(Wc(f)))N.loading=5;else{s=_({rel:"stylesheet",href:s,"data-precedence":a},o),(o=ha.get(f))&&dp(s,o);var q=w=c.createElement("link");he(q),lr(q,"link",s),q._p=new Promise(function(de,Ce){q.onload=de,q.onerror=Ce}),q.addEventListener("load",function(){N.loading|=1}),q.addEventListener("error",function(){N.loading|=2}),N.loading|=4,qd(w,a,c)}w={type:"stylesheet",instance:w,count:1,state:N},m.set(f,w)}}}function hT(s,a){mi.X(s,a);var o=Dl;if(o&&s){var c=W(o).hoistableScripts,m=Ll(s),f=c.get(m);f||(f=o.querySelector(Gc(m)),f||(s=_({src:s,async:!0},a),(a=ha.get(m))&&hp(s,a),f=o.createElement("script"),he(f),lr(f,"link",s),o.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},c.set(m,f))}}function mT(s,a){mi.M(s,a);var o=Dl;if(o&&s){var c=W(o).hoistableScripts,m=Ll(s),f=c.get(m);f||(f=o.querySelector(Gc(m)),f||(s=_({src:s,async:!0,type:"module"},a),(a=ha.get(m))&&hp(s,a),f=o.createElement("script"),he(f),lr(f,"link",s),o.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},c.set(m,f))}}function n1(s,a,o,c){var m=(m=Ie.current)?zd(m):null;if(!m)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(a=Pl(o.href),o=W(m).hoistableStyles,c=o.get(a),c||(c={type:"style",instance:null,count:0,state:null},o.set(a,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){s=Pl(o.href);var f=W(m).hoistableStyles,w=f.get(s);if(w||(m=m.ownerDocument||m,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},f.set(s,w),(f=m.querySelector(Wc(s)))&&!f._p&&(w.instance=f,w.state.loading=5),ha.has(s)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},ha.set(s,o),f||fT(m,s,o,w.state))),a&&c===null)throw Error(i(528,""));return w}if(a&&c!==null)throw Error(i(529,""));return null;case"script":return a=o.async,o=o.src,typeof o=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Ll(o),o=W(m).hoistableScripts,c=o.get(a),c||(c={type:"script",instance:null,count:0,state:null},o.set(a,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function Pl(s){return'href="'+ve(s)+'"'}function Wc(s){return'link[rel="stylesheet"]['+s+"]"}function r1(s){return _({},s,{"data-precedence":s.precedence,precedence:null})}function fT(s,a,o,c){s.querySelector('link[rel="preload"][as="style"]['+a+"]")?c.loading=1:(a=s.createElement("link"),c.preload=a,a.addEventListener("load",function(){return c.loading|=1}),a.addEventListener("error",function(){return c.loading|=2}),lr(a,"link",o),he(a),s.head.appendChild(a))}function Ll(s){return'[src="'+ve(s)+'"]'}function Gc(s){return"script[async]"+s}function a1(s,a,o){if(a.count++,a.instance===null)switch(a.type){case"style":var c=s.querySelector('style[data-href~="'+ve(o.href)+'"]');if(c)return a.instance=c,he(c),c;var m=_({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(s.ownerDocument||s).createElement("style"),he(c),lr(c,"style",m),qd(c,o.precedence,s),a.instance=c;case"stylesheet":m=Pl(o.href);var f=s.querySelector(Wc(m));if(f)return a.state.loading|=4,a.instance=f,he(f),f;c=r1(o),(m=ha.get(m))&&dp(c,m),f=(s.ownerDocument||s).createElement("link"),he(f);var w=f;return w._p=new Promise(function(N,q){w.onload=N,w.onerror=q}),lr(f,"link",c),a.state.loading|=4,qd(f,o.precedence,s),a.instance=f;case"script":return f=Ll(o.src),(m=s.querySelector(Gc(f)))?(a.instance=m,he(m),m):(c=o,(m=ha.get(f))&&(c=_({},o),hp(c,m)),s=s.ownerDocument||s,m=s.createElement("script"),he(m),lr(m,"link",c),s.head.appendChild(m),a.instance=m);case"void":return null;default:throw Error(i(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(c=a.instance,a.state.loading|=4,qd(c,o.precedence,s));return a.instance}function qd(s,a,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=c.length?c[c.length-1]:null,f=m,w=0;w<c.length;w++){var N=c[w];if(N.dataset.precedence===a)f=N;else if(f!==m)break}f?f.parentNode.insertBefore(s,f.nextSibling):(a=o.nodeType===9?o.head:o,a.insertBefore(s,a.firstChild))}function dp(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.title==null&&(s.title=a.title)}function hp(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.integrity==null&&(s.integrity=a.integrity)}var Hd=null;function i1(s,a,o){if(Hd===null){var c=new Map,m=Hd=new Map;m.set(o,c)}else m=Hd,c=m.get(o),c||(c=new Map,m.set(o,c));if(c.has(s))return c;for(c.set(s,null),o=o.getElementsByTagName(s),m=0;m<o.length;m++){var f=o[m];if(!(f[mn]||f[mt]||s==="link"&&f.getAttribute("rel")==="stylesheet")&&f.namespaceURI!=="http://www.w3.org/2000/svg"){var w=f.getAttribute(a)||"";w=s+w;var N=c.get(w);N?N.push(f):c.set(w,[f])}}return c}function o1(s,a,o){s=s.ownerDocument||s,s.head.insertBefore(o,a==="title"?s.querySelector("head > title"):null)}function pT(s,a,o){if(o===1||a.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;return a.rel==="stylesheet"?(s=a.disabled,typeof a.precedence=="string"&&s==null):!0;case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function l1(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function gT(s,a,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var m=Pl(c.href),f=a.querySelector(Wc(m));if(f){a=f._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(s.count++,s=$d.bind(s),a.then(s,s)),o.state.loading|=4,o.instance=f,he(f);return}f=a.ownerDocument||a,c=r1(c),(m=ha.get(m))&&dp(c,m),f=f.createElement("link"),he(f);var w=f;w._p=new Promise(function(N,q){w.onload=N,w.onerror=q}),lr(f,"link",c),o.instance=f}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(o,a),(a=o.state.preload)&&(o.state.loading&3)===0&&(s.count++,o=$d.bind(s),a.addEventListener("load",o),a.addEventListener("error",o))}}var mp=0;function yT(s,a){return s.stylesheets&&s.count===0&&Gd(s,s.stylesheets),0<s.count||0<s.imgCount?function(o){var c=setTimeout(function(){if(s.stylesheets&&Gd(s,s.stylesheets),s.unsuspend){var f=s.unsuspend;s.unsuspend=null,f()}},6e4+a);0<s.imgBytes&&mp===0&&(mp=62500*Xj());var m=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&Gd(s,s.stylesheets),s.unsuspend)){var f=s.unsuspend;s.unsuspend=null,f()}},(s.imgBytes>mp?50:800)+a);return s.unsuspend=o,function(){s.unsuspend=null,clearTimeout(c),clearTimeout(m)}}:null}function $d(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Gd(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Wd=null;function Gd(s,a){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Wd=new Map,a.forEach(bT,s),Wd=null,$d.call(s))}function bT(s,a){if(!(a.state.loading&4)){var o=Wd.get(s);if(o)var c=o.get(null);else{o=new Map,Wd.set(s,o);for(var m=s.querySelectorAll("link[data-precedence],style[data-precedence]"),f=0;f<m.length;f++){var w=m[f];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(o.set(w.dataset.precedence,w),c=w)}c&&o.set(null,c)}m=a.instance,w=m.getAttribute("data-precedence"),f=o.get(w)||c,f===c&&o.set(null,m),o.set(w,m),this.count++,c=$d.bind(this),m.addEventListener("load",c),m.addEventListener("error",c),f?f.parentNode.insertBefore(m,f.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(m,s.firstChild)),a.state.loading|=4}}var Kc={$$typeof:te,Provider:null,Consumer:null,_currentValue:ge,_currentValue2:ge,_threadCount:0};function vT(s,a,o,c,m,f,w,N,q){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ae(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ae(0),this.hiddenUpdates=Ae(null),this.identifierPrefix=c,this.onUncaughtError=m,this.onCaughtError=f,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=q,this.incompleteTransitions=new Map}function c1(s,a,o,c,m,f,w,N,q,de,Ce,Ve){return s=new vT(s,a,o,w,q,de,Ce,Ve,N),a=1,f===!0&&(a|=24),f=Wr(3,null,null,a),s.current=f,f.stateNode=s,a=$m(),a.refCount++,s.pooledCache=a,a.refCount++,f.memoizedState={element:c,isDehydrated:o,cache:a},Ym(f),s}function u1(s){return s?(s=ml,s):ml}function d1(s,a,o,c,m,f){m=u1(m),c.context===null?c.context=m:c.pendingContext=m,c=Di(a),c.payload={element:o},f=f===void 0?null:f,f!==null&&(c.callback=f),o=Pi(s,c,a),o!==null&&(Fr(o,s,a),Ec(o,s,a))}function h1(s,a){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var o=s.retryLane;s.retryLane=o!==0&&o<a?o:a}}function fp(s,a){h1(s,a),(s=s.alternate)&&h1(s,a)}function m1(s){if(s.tag===13||s.tag===31){var a=So(s,67108864);a!==null&&Fr(a,s,67108864),fp(s,67108864)}}function f1(s){if(s.tag===13||s.tag===31){var a=Xr();a=F(a);var o=So(s,a);o!==null&&Fr(o,s,a),fp(s,a)}}var Kd=!0;function xT(s,a,o,c){var m=B.T;B.T=null;var f=se.p;try{se.p=2,pp(s,a,o,c)}finally{se.p=f,B.T=m}}function wT(s,a,o,c){var m=B.T;B.T=null;var f=se.p;try{se.p=8,pp(s,a,o,c)}finally{se.p=f,B.T=m}}function pp(s,a,o,c){if(Kd){var m=gp(c);if(m===null)tp(s,a,c,Yd,o),g1(s,c);else if(kT(m,s,a,o,c))c.stopPropagation();else if(g1(s,c),a&4&&-1<_T.indexOf(s)){for(;m!==null;){var f=cn(m);if(f!==null)switch(f.tag){case 3:if(f=f.stateNode,f.current.memoizedState.isDehydrated){var w=$e(f.pendingLanes);if(w!==0){var N=f;for(N.pendingLanes|=2,N.entangledLanes|=2;w;){var q=1<<31-De(w);N.entanglements[1]|=q,w&=~q}Ba(f),(qs&6)===0&&(Ad=Ft()+500,zc(0))}}break;case 31:case 13:N=So(f,2),N!==null&&Fr(N,f,2),Md(),fp(f,2)}if(f=gp(c),f===null&&tp(s,a,c,Yd,o),f===m)break;m=f}m!==null&&c.stopPropagation()}else tp(s,a,c,null,o)}}function gp(s){return s=on(s),yp(s)}var Yd=null;function yp(s){if(Yd=null,s=Ks(s),s!==null){var a=u(s);if(a===null)s=null;else{var o=a.tag;if(o===13){if(s=d(a),s!==null)return s;s=null}else if(o===31){if(s=p(a),s!==null)return s;s=null}else if(o===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;s=null}else a!==s&&(s=null)}}return Yd=s,null}function p1(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(At()){case us:return 2;case vs:return 8;case as:case nn:return 32;case Ds:return 268435456;default:return 32}default:return 32}}var bp=!1,Wi=null,Gi=null,Ki=null,Yc=new Map,Qc=new Map,Yi=[],_T="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function g1(s,a){switch(s){case"focusin":case"focusout":Wi=null;break;case"dragenter":case"dragleave":Gi=null;break;case"mouseover":case"mouseout":Ki=null;break;case"pointerover":case"pointerout":Yc.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Qc.delete(a.pointerId)}}function Xc(s,a,o,c,m,f){return s===null||s.nativeEvent!==f?(s={blockedOn:a,domEventName:o,eventSystemFlags:c,nativeEvent:f,targetContainers:[m]},a!==null&&(a=cn(a),a!==null&&m1(a)),s):(s.eventSystemFlags|=c,a=s.targetContainers,m!==null&&a.indexOf(m)===-1&&a.push(m),s)}function kT(s,a,o,c,m){switch(a){case"focusin":return Wi=Xc(Wi,s,a,o,c,m),!0;case"dragenter":return Gi=Xc(Gi,s,a,o,c,m),!0;case"mouseover":return Ki=Xc(Ki,s,a,o,c,m),!0;case"pointerover":var f=m.pointerId;return Yc.set(f,Xc(Yc.get(f)||null,s,a,o,c,m)),!0;case"gotpointercapture":return f=m.pointerId,Qc.set(f,Xc(Qc.get(f)||null,s,a,o,c,m)),!0}return!1}function y1(s){var a=Ks(s.target);if(a!==null){var o=u(a);if(o!==null){if(a=o.tag,a===13){if(a=d(o),a!==null){s.blockedOn=a,Ee(s.priority,function(){f1(o)});return}}else if(a===31){if(a=p(o),a!==null){s.blockedOn=a,Ee(s.priority,function(){f1(o)});return}}else if(a===3&&o.stateNode.current.memoizedState.isDehydrated){s.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Qd(s){if(s.blockedOn!==null)return!1;for(var a=s.targetContainers;0<a.length;){var o=gp(s.nativeEvent);if(o===null){o=s.nativeEvent;var c=new o.constructor(o.type,o);Ls=c,o.target.dispatchEvent(c),Ls=null}else return a=cn(o),a!==null&&m1(a),s.blockedOn=o,!1;a.shift()}return!0}function b1(s,a,o){Qd(s)&&o.delete(a)}function jT(){bp=!1,Wi!==null&&Qd(Wi)&&(Wi=null),Gi!==null&&Qd(Gi)&&(Gi=null),Ki!==null&&Qd(Ki)&&(Ki=null),Yc.forEach(b1),Qc.forEach(b1)}function Xd(s,a){s.blockedOn===a&&(s.blockedOn=null,bp||(bp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,jT)))}var Jd=null;function v1(s){Jd!==s&&(Jd=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Jd===s&&(Jd=null);for(var a=0;a<s.length;a+=3){var o=s[a],c=s[a+1],m=s[a+2];if(typeof c!="function"){if(yp(c||o)===null)continue;break}var f=cn(o);f!==null&&(s.splice(a,3),a-=3,gf(f,{pending:!0,data:m,method:o.method,action:c},c,m))}}))}function Ol(s){function a(q){return Xd(q,s)}Wi!==null&&Xd(Wi,s),Gi!==null&&Xd(Gi,s),Ki!==null&&Xd(Ki,s),Yc.forEach(a),Qc.forEach(a);for(var o=0;o<Yi.length;o++){var c=Yi[o];c.blockedOn===s&&(c.blockedOn=null)}for(;0<Yi.length&&(o=Yi[0],o.blockedOn===null);)y1(o),o.blockedOn===null&&Yi.shift();if(o=(s.ownerDocument||s).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var m=o[c],f=o[c+1],w=m[Nt]||null;if(typeof f=="function")w||v1(o);else if(w){var N=null;if(f&&f.hasAttribute("formAction")){if(m=f,w=f[Nt]||null)N=w.formAction;else if(yp(m)!==null)continue}else N=w.action;typeof N=="function"?o[c+1]=N:(o.splice(c,3),c-=3),v1(o)}}}function x1(){function s(f){f.canIntercept&&f.info==="react-transition"&&f.intercept({handler:function(){return new Promise(function(w){return m=w})},focusReset:"manual",scroll:"manual"})}function a(){m!==null&&(m(),m=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var f=navigation.currentEntry;f&&f.url!=null&&navigation.navigate(f.url,{state:f.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,m=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),m!==null&&(m(),m=null)}}}function vp(s){this._internalRoot=s}Zd.prototype.render=vp.prototype.render=function(s){var a=this._internalRoot;if(a===null)throw Error(i(409));var o=a.current,c=Xr();d1(o,c,s,a,null,null)},Zd.prototype.unmount=vp.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var a=s.containerInfo;d1(s.current,2,null,s,null,null),Md(),a[lt]=null}};function Zd(s){this._internalRoot=s}Zd.prototype.unstable_scheduleHydration=function(s){if(s){var a=Se();s={blockedOn:null,target:s,priority:a};for(var o=0;o<Yi.length&&a!==0&&a<Yi[o].priority;o++);Yi.splice(o,0,s),o===0&&y1(s)}};var w1=e.version;if(w1!=="19.2.4")throw Error(i(527,w1,"19.2.4"));se.findDOMNode=function(s){var a=s._reactInternals;if(a===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=y(a),s=s!==null?x(s):null,s=s===null?null:s.stateNode,s};var TT={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:B,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var eh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!eh.isDisabled&&eh.supportsFiber)try{xs=eh.inject(TT),ye=eh}catch{}}return Zc.createRoot=function(s,a){if(!l(s))throw Error(i(299));var o=!1,c="",m=Sv,f=Cv,w=Rv;return a!=null&&(a.unstable_strictMode===!0&&(o=!0),a.identifierPrefix!==void 0&&(c=a.identifierPrefix),a.onUncaughtError!==void 0&&(m=a.onUncaughtError),a.onCaughtError!==void 0&&(f=a.onCaughtError),a.onRecoverableError!==void 0&&(w=a.onRecoverableError)),a=c1(s,1,!1,null,null,o,c,null,m,f,w,x1),s[lt]=a.current,ep(s),new vp(a)},Zc.hydrateRoot=function(s,a,o){if(!l(s))throw Error(i(299));var c=!1,m="",f=Sv,w=Cv,N=Rv,q=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(m=o.identifierPrefix),o.onUncaughtError!==void 0&&(f=o.onUncaughtError),o.onCaughtError!==void 0&&(w=o.onCaughtError),o.onRecoverableError!==void 0&&(N=o.onRecoverableError),o.formState!==void 0&&(q=o.formState)),a=c1(s,1,!0,a,o??null,c,m,q,f,w,N,x1),a.context=u1(null),o=a.current,c=Xr(),c=F(c),m=Di(c),m.callback=null,Pi(o,m,c),o=c,a.current.lanes=o,Ge(a,o),Ba(a),s[lt]=a.current,ep(s),new Zd(a)},Zc.version="19.2.4",Zc}var A1;function PT(){if(A1)return _p.exports;A1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),_p.exports=DT(),_p.exports}var LT=PT();const OT="modulepreload",BT=function(n){return"/login/"+n},I1={},Cr=function(e,t,i){let l=Promise.resolve();if(t&&t.length>0){let g=function(y){return Promise.all(y.map(x=>Promise.resolve(x).then(_=>({status:"fulfilled",value:_}),_=>({status:"rejected",reason:_}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),p=d?.nonce||d?.getAttribute("nonce");l=g(t.map(y=>{if(y=BT(y),y in I1)return;I1[y]=!0;const x=y.endsWith(".css"),_=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${_}`))return;const j=document.createElement("link");if(j.rel=x?"stylesheet":OT,x||(j.as="script"),j.crossOrigin="",j.href=y,p&&j.setAttribute("nonce",p),document.head.appendChild(j),x)return new Promise((O,$)=>{j.addEventListener("load",O),j.addEventListener("error",()=>$(new Error(`Unable to preload CSS for ${y}`)))})}))}function u(d){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=d,window.dispatchEvent(p),!p.defaultPrevented)throw d}return l.then(d=>{for(const p of d||[])p.status==="rejected"&&u(p.reason);return e().catch(u)})};var M1="popstate";function VT(n={}){function e(i,l){let{pathname:u,search:d,hash:p}=i.location;return rg("",{pathname:u,search:d,hash:p},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function t(i,l){return typeof l=="string"?l:xu(l)}return FT(e,t,null,n)}function gn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function pa(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function UT(){return Math.random().toString(36).substring(2,10)}function D1(n,e){return{usr:n.state,key:n.key,idx:e}}function rg(n,e,t=null,i){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?ic(e):e,state:t,key:e&&e.key||i||UT()}}function xu({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function ic(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substring(i),n=n.substring(0,i)),n&&(e.pathname=n)}return e}function FT(n,e,t,i={}){let{window:l=document.defaultView,v5Compat:u=!1}=i,d=l.history,p="POP",g=null,y=x();y==null&&(y=0,d.replaceState({...d.state,idx:y},""));function x(){return(d.state||{idx:null}).idx}function _(){p="POP";let L=x(),ee=L==null?null:L-y;y=L,g&&g({action:p,location:V.location,delta:ee})}function j(L,ee){p="PUSH";let Y=rg(V.location,L,ee);y=x()+1;let te=D1(Y,y),ke=V.createHref(Y);try{d.pushState(te,"",ke)}catch(Te){if(Te instanceof DOMException&&Te.name==="DataCloneError")throw Te;l.location.assign(ke)}u&&g&&g({action:p,location:V.location,delta:1})}function O(L,ee){p="REPLACE";let Y=rg(V.location,L,ee);y=x();let te=D1(Y,y),ke=V.createHref(Y);d.replaceState(te,"",ke),u&&g&&g({action:p,location:V.location,delta:0})}function $(L){return zT(L)}let V={get action(){return p},get location(){return n(l,d)},listen(L){if(g)throw new Error("A history only accepts one active listener");return l.addEventListener(M1,_),g=L,()=>{l.removeEventListener(M1,_),g=null}},createHref(L){return e(l,L)},createURL:$,encodeLocation(L){let ee=$(L);return{pathname:ee.pathname,search:ee.search,hash:ee.hash}},push:j,replace:O,go(L){return d.go(L)}};return V}function zT(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),gn(t,"No window.location.(origin|href) available to create URL");let i=typeof n=="string"?n:xu(n);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function V2(n,e,t="/"){return qT(n,e,t,!1)}function qT(n,e,t,i){let l=typeof e=="string"?ic(e):e,u=wi(l.pathname||"/",t);if(u==null)return null;let d=U2(n);HT(d);let p=null;for(let g=0;p==null&&g<d.length;++g){let y=tE(u);p=ZT(d[g],y,i)}return p}function U2(n,e=[],t=[],i="",l=!1){let u=(d,p,g=l,y)=>{let x={relativePath:y===void 0?d.path||"":y,caseSensitive:d.caseSensitive===!0,childrenIndex:p,route:d};if(x.relativePath.startsWith("/")){if(!x.relativePath.startsWith(i)&&g)return;gn(x.relativePath.startsWith(i),`Absolute route path "${x.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),x.relativePath=x.relativePath.slice(i.length)}let _=bi([i,x.relativePath]),j=t.concat(x);d.children&&d.children.length>0&&(gn(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${_}".`),U2(d.children,e,j,_,g)),!(d.path==null&&!d.index)&&e.push({path:_,score:XT(_,d.index),routesMeta:j})};return n.forEach((d,p)=>{if(d.path===""||!d.path?.includes("?"))u(d,p);else for(let g of F2(d.path))u(d,p,!0,g)}),e}function F2(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,l=t.endsWith("?"),u=t.replace(/\?$/,"");if(i.length===0)return l?[u,""]:[u];let d=F2(i.join("/")),p=[];return p.push(...d.map(g=>g===""?u:[u,g].join("/"))),l&&p.push(...d),p.map(g=>n.startsWith("/")&&g===""?"/":g)}function HT(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:JT(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var $T=/^:[\w-]+$/,WT=3,GT=2,KT=1,YT=10,QT=-2,P1=n=>n==="*";function XT(n,e){let t=n.split("/"),i=t.length;return t.some(P1)&&(i+=QT),e&&(i+=GT),t.filter(l=>!P1(l)).reduce((l,u)=>l+($T.test(u)?WT:u===""?KT:YT),i)}function JT(n,e){return n.length===e.length&&n.slice(0,-1).every((i,l)=>i===e[l])?n[n.length-1]-e[e.length-1]:0}function ZT(n,e,t=!1){let{routesMeta:i}=n,l={},u="/",d=[];for(let p=0;p<i.length;++p){let g=i[p],y=p===i.length-1,x=u==="/"?e:e.slice(u.length)||"/",_=Ch({path:g.relativePath,caseSensitive:g.caseSensitive,end:y},x),j=g.route;if(!_&&y&&t&&!i[i.length-1].route.index&&(_=Ch({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},x)),!_)return null;Object.assign(l,_.params),d.push({params:l,pathname:bi([u,_.pathname]),pathnameBase:aE(bi([u,_.pathnameBase])),route:j}),_.pathnameBase!=="/"&&(u=bi([u,_.pathnameBase]))}return d}function Ch(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=eE(n.path,n.caseSensitive,n.end),l=e.match(t);if(!l)return null;let u=l[0],d=u.replace(/(.)\/+$/,"$1"),p=l.slice(1);return{params:i.reduce((y,{paramName:x,isOptional:_},j)=>{if(x==="*"){let $=p[j]||"";d=u.slice(0,u.length-$.length).replace(/(.)\/+$/,"$1")}const O=p[j];return _&&!O?y[x]=void 0:y[x]=(O||"").replace(/%2F/g,"/"),y},{}),pathname:u,pathnameBase:d,pattern:n}}function eE(n,e=!1,t=!0){pa(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let i=[],l="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,p,g)=>(i.push({paramName:p,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(i.push({paramName:"*"}),l+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?l+="\\/*$":n!==""&&n!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,e?void 0:"i"),i]}function tE(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return pa(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function wi(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}var sE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function nE(n,e="/"){let{pathname:t,search:i="",hash:l=""}=typeof n=="string"?ic(n):n,u;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?u=L1(t.substring(1),"/"):u=L1(t,e)):u=e,{pathname:u,search:iE(i),hash:oE(l)}}function L1(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(l=>{l===".."?t.length>1&&t.pop():l!=="."&&t.push(l)}),t.length>1?t.join("/"):"/"}function Ep(n,e,t,i){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function rE(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Og(n){let e=rE(n);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function Bg(n,e,t,i=!1){let l;typeof n=="string"?l=ic(n):(l={...n},gn(!l.pathname||!l.pathname.includes("?"),Ep("?","pathname","search",l)),gn(!l.pathname||!l.pathname.includes("#"),Ep("#","pathname","hash",l)),gn(!l.search||!l.search.includes("#"),Ep("#","search","hash",l)));let u=n===""||l.pathname==="",d=u?"/":l.pathname,p;if(d==null)p=t;else{let _=e.length-1;if(!i&&d.startsWith("..")){let j=d.split("/");for(;j[0]==="..";)j.shift(),_-=1;l.pathname=j.join("/")}p=_>=0?e[_]:"/"}let g=nE(l,p),y=d&&d!=="/"&&d.endsWith("/"),x=(u||d===".")&&t.endsWith("/");return!g.pathname.endsWith("/")&&(y||x)&&(g.pathname+="/"),g}var bi=n=>n.join("/").replace(/\/\/+/g,"/"),aE=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),iE=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,oE=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,lE=class{constructor(n,e,t,i=!1){this.status=n,this.statusText=e||"",this.internal=i,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function cE(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function uE(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var z2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function q2(n,e){let t=n;if(typeof t!="string"||!sE.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let i=t,l=!1;if(z2)try{let u=new URL(window.location.href),d=t.startsWith("//")?new URL(u.protocol+t):new URL(t),p=wi(d.pathname,e);d.origin===u.origin&&p!=null?t=p+d.search+d.hash:l=!0}catch{pa(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:l,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var H2=["POST","PUT","PATCH","DELETE"];new Set(H2);var dE=["GET",...H2];new Set(dE);var oc=b.createContext(null);oc.displayName="DataRouter";var Zh=b.createContext(null);Zh.displayName="DataRouterState";var hE=b.createContext(!1),$2=b.createContext({isTransitioning:!1});$2.displayName="ViewTransition";var mE=b.createContext(new Map);mE.displayName="Fetchers";var fE=b.createContext(null);fE.displayName="Await";var sa=b.createContext(null);sa.displayName="Navigation";var Mu=b.createContext(null);Mu.displayName="Location";var Ra=b.createContext({outlet:null,matches:[],isDataRoute:!1});Ra.displayName="Route";var Vg=b.createContext(null);Vg.displayName="RouteError";var W2="REACT_ROUTER_ERROR",pE="REDIRECT",gE="ROUTE_ERROR_RESPONSE";function yE(n){if(n.startsWith(`${W2}:${pE}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function bE(n){if(n.startsWith(`${W2}:${gE}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new lE(e.status,e.statusText,e.data)}catch{}}function vE(n,{relative:e}={}){gn(lc(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=b.useContext(sa),{hash:l,pathname:u,search:d}=Du(n,{relative:e}),p=u;return t!=="/"&&(p=u==="/"?t:bi([t,u])),i.createHref({pathname:p,search:d,hash:l})}function lc(){return b.useContext(Mu)!=null}function Aa(){return gn(lc(),"useLocation() may be used only in the context of a <Router> component."),b.useContext(Mu).location}var G2="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function K2(n){b.useContext(sa).static||b.useLayoutEffect(n)}function Zn(){let{isDataRoute:n}=b.useContext(Ra);return n?ME():xE()}function xE(){gn(lc(),"useNavigate() may be used only in the context of a <Router> component.");let n=b.useContext(oc),{basename:e,navigator:t}=b.useContext(sa),{matches:i}=b.useContext(Ra),{pathname:l}=Aa(),u=JSON.stringify(Og(i)),d=b.useRef(!1);return K2(()=>{d.current=!0}),b.useCallback((g,y={})=>{if(pa(d.current,G2),!d.current)return;if(typeof g=="number"){t.go(g);return}let x=Bg(g,JSON.parse(u),l,y.relative==="path");n==null&&e!=="/"&&(x.pathname=x.pathname==="/"?e:bi([e,x.pathname])),(y.replace?t.replace:t.push)(x,y.state,y)},[e,t,u,l,n])}b.createContext(null);function wE(){let{matches:n}=b.useContext(Ra),e=n[n.length-1];return e?e.params:{}}function Du(n,{relative:e}={}){let{matches:t}=b.useContext(Ra),{pathname:i}=Aa(),l=JSON.stringify(Og(t));return b.useMemo(()=>Bg(n,JSON.parse(l),i,e==="path"),[n,l,i,e])}function _E(n,e){return Y2(n,e)}function Y2(n,e,t,i,l){gn(lc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=b.useContext(sa),{matches:d}=b.useContext(Ra),p=d[d.length-1],g=p?p.params:{},y=p?p.pathname:"/",x=p?p.pathnameBase:"/",_=p&&p.route;{let Y=_&&_.path||"";X2(y,!_||Y.endsWith("*")||Y.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${y}" (under <Route path="${Y}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${Y}"> to <Route path="${Y==="/"?"*":`${Y}/*`}">.`)}let j=Aa(),O;if(e){let Y=typeof e=="string"?ic(e):e;gn(x==="/"||Y.pathname?.startsWith(x),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${x}" but pathname "${Y.pathname}" was given in the \`location\` prop.`),O=Y}else O=j;let $=O.pathname||"/",V=$;if(x!=="/"){let Y=x.replace(/^\//,"").split("/");V="/"+$.replace(/^\//,"").split("/").slice(Y.length).join("/")}let L=V2(n,{pathname:V});pa(_||L!=null,`No routes matched location "${O.pathname}${O.search}${O.hash}" `),pa(L==null||L[L.length-1].route.element!==void 0||L[L.length-1].route.Component!==void 0||L[L.length-1].route.lazy!==void 0,`Matched leaf route at location "${O.pathname}${O.search}${O.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let ee=NE(L&&L.map(Y=>Object.assign({},Y,{params:Object.assign({},g,Y.params),pathname:bi([x,u.encodeLocation?u.encodeLocation(Y.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Y.pathname]),pathnameBase:Y.pathnameBase==="/"?x:bi([x,u.encodeLocation?u.encodeLocation(Y.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Y.pathnameBase])})),d,t,i,l);return e&&ee?b.createElement(Mu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...O},navigationType:"POP"}},ee):ee}function kE(){let n=IE(),e=cE(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:i},u={padding:"2px 4px",backgroundColor:i},d=null;return console.error("Error handled by React Router default ErrorBoundary:",n),d=b.createElement(b.Fragment,null,b.createElement("p",null," Hey developer "),b.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",b.createElement("code",{style:u},"ErrorBoundary")," or"," ",b.createElement("code",{style:u},"errorElement")," prop on your route.")),b.createElement(b.Fragment,null,b.createElement("h2",null,"Unexpected Application Error!"),b.createElement("h3",{style:{fontStyle:"italic"}},e),t?b.createElement("pre",{style:l},t):null,d)}var jE=b.createElement(kE,null),Q2=class extends b.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=bE(n.digest);t&&(n=t)}let e=n!==void 0?b.createElement(Ra.Provider,{value:this.props.routeContext},b.createElement(Vg.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?b.createElement(TE,{error:n},e):e}};Q2.contextType=hE;var Np=new WeakMap;function TE({children:n,error:e}){let{basename:t}=b.useContext(sa);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=yE(e.digest);if(i){let l=Np.get(e);if(l)throw l;let u=q2(i.location,t);if(z2&&!Np.get(e))if(u.isExternal||i.reloadDocument)window.location.href=u.absoluteURL||u.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(u.to,{replace:i.replace}));throw Np.set(e,d),d}return b.createElement("meta",{httpEquiv:"refresh",content:`0;url=${u.absoluteURL||u.to}`})}}return n}function EE({routeContext:n,match:e,children:t}){let i=b.useContext(oc);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),b.createElement(Ra.Provider,{value:n},t)}function NE(n,e=[],t=null,i=null,l=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let u=n,d=t?.errors;if(d!=null){let x=u.findIndex(_=>_.route.id&&d?.[_.route.id]!==void 0);gn(x>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),u=u.slice(0,Math.min(u.length,x+1))}let p=!1,g=-1;if(t)for(let x=0;x<u.length;x++){let _=u[x];if((_.route.HydrateFallback||_.route.hydrateFallbackElement)&&(g=x),_.route.id){let{loaderData:j,errors:O}=t,$=_.route.loader&&!j.hasOwnProperty(_.route.id)&&(!O||O[_.route.id]===void 0);if(_.route.lazy||$){p=!0,g>=0?u=u.slice(0,g+1):u=[u[0]];break}}}let y=t&&i?(x,_)=>{i(x,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:uE(t.matches),errorInfo:_})}:void 0;return u.reduceRight((x,_,j)=>{let O,$=!1,V=null,L=null;t&&(O=d&&_.route.id?d[_.route.id]:void 0,V=_.route.errorElement||jE,p&&(g<0&&j===0?(X2("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),$=!0,L=null):g===j&&($=!0,L=_.route.hydrateFallbackElement||null)));let ee=e.concat(u.slice(0,j+1)),Y=()=>{let te;return O?te=V:$?te=L:_.route.Component?te=b.createElement(_.route.Component,null):_.route.element?te=_.route.element:te=x,b.createElement(EE,{match:_,routeContext:{outlet:x,matches:ee,isDataRoute:t!=null},children:te})};return t&&(_.route.ErrorBoundary||_.route.errorElement||j===0)?b.createElement(Q2,{location:t.location,revalidation:t.revalidation,component:V,error:O,children:Y(),routeContext:{outlet:null,matches:ee,isDataRoute:!0},onError:y}):Y()},null)}function Ug(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function SE(n){let e=b.useContext(oc);return gn(e,Ug(n)),e}function CE(n){let e=b.useContext(Zh);return gn(e,Ug(n)),e}function RE(n){let e=b.useContext(Ra);return gn(e,Ug(n)),e}function Fg(n){let e=RE(n),t=e.matches[e.matches.length-1];return gn(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function AE(){return Fg("useRouteId")}function IE(){let n=b.useContext(Vg),e=CE("useRouteError"),t=Fg("useRouteError");return n!==void 0?n:e.errors?.[t]}function ME(){let{router:n}=SE("useNavigate"),e=Fg("useNavigate"),t=b.useRef(!1);return K2(()=>{t.current=!0}),b.useCallback(async(l,u={})=>{pa(t.current,G2),t.current&&(typeof l=="number"?await n.navigate(l):await n.navigate(l,{fromRouteId:e,...u}))},[n,e])}var O1={};function X2(n,e,t){!e&&!O1[n]&&(O1[n]=!0,pa(!1,t))}b.memo(DE);function DE({routes:n,future:e,state:t,onError:i}){return Y2(n,void 0,t,i,e)}function J2({to:n,replace:e,state:t,relative:i}){gn(lc(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=b.useContext(sa);pa(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=b.useContext(Ra),{pathname:d}=Aa(),p=Zn(),g=Bg(n,Og(u),d,i==="path"),y=JSON.stringify(g);return b.useEffect(()=>{p(JSON.parse(y),{replace:e,state:t,relative:i})},[p,y,i,e,t]),null}function tn(n){gn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function PE({basename:n="/",children:e=null,location:t,navigationType:i="POP",navigator:l,static:u=!1,unstable_useTransitions:d}){gn(!lc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let p=n.replace(/^\/*/,"/"),g=b.useMemo(()=>({basename:p,navigator:l,static:u,unstable_useTransitions:d,future:{}}),[p,l,u,d]);typeof t=="string"&&(t=ic(t));let{pathname:y="/",search:x="",hash:_="",state:j=null,key:O="default"}=t,$=b.useMemo(()=>{let V=wi(y,p);return V==null?null:{location:{pathname:V,search:x,hash:_,state:j,key:O},navigationType:i}},[p,y,x,_,j,O,i]);return pa($!=null,`<Router basename="${p}"> is not able to match the URL "${y}${x}${_}" because it does not start with the basename, so the <Router> won't render anything.`),$==null?null:b.createElement(sa.Provider,{value:g},b.createElement(Mu.Provider,{children:e,value:$}))}function LE({children:n,location:e}){return _E(ag(n),e)}function ag(n,e=[]){let t=[];return b.Children.forEach(n,(i,l)=>{if(!b.isValidElement(i))return;let u=[...e,l];if(i.type===b.Fragment){t.push.apply(t,ag(i.props.children,u));return}gn(i.type===tn,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),gn(!i.props.index||!i.props.children,"An index route cannot have child routes.");let d={id:i.props.id||u.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(d.children=ag(i.props.children,u)),t.push(d)}),t}var gh="get",yh="application/x-www-form-urlencoded";function em(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function OE(n){return em(n)&&n.tagName.toLowerCase()==="button"}function BE(n){return em(n)&&n.tagName.toLowerCase()==="form"}function VE(n){return em(n)&&n.tagName.toLowerCase()==="input"}function UE(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function FE(n,e){return n.button===0&&(!e||e==="_self")&&!UE(n)}function ig(n=""){return new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let i=n[t];return e.concat(Array.isArray(i)?i.map(l=>[t,l]):[[t,i]])},[]))}function zE(n,e){let t=ig(n);return e&&e.forEach((i,l)=>{t.has(l)||e.getAll(l).forEach(u=>{t.append(l,u)})}),t}var th=null;function qE(){if(th===null)try{new FormData(document.createElement("form"),0),th=!1}catch{th=!0}return th}var HE=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Sp(n){return n!=null&&!HE.has(n)?(pa(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${yh}"`),null):n}function $E(n,e){let t,i,l,u,d;if(BE(n)){let p=n.getAttribute("action");i=p?wi(p,e):null,t=n.getAttribute("method")||gh,l=Sp(n.getAttribute("enctype"))||yh,u=new FormData(n)}else if(OE(n)||VE(n)&&(n.type==="submit"||n.type==="image")){let p=n.form;if(p==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let g=n.getAttribute("formaction")||p.getAttribute("action");if(i=g?wi(g,e):null,t=n.getAttribute("formmethod")||p.getAttribute("method")||gh,l=Sp(n.getAttribute("formenctype"))||Sp(p.getAttribute("enctype"))||yh,u=new FormData(p,n),!qE()){let{name:y,type:x,value:_}=n;if(x==="image"){let j=y?`${y}.`:"";u.append(`${j}x`,"0"),u.append(`${j}y`,"0")}else y&&u.append(y,_)}}else{if(em(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=gh,i=null,l=yh,d=n}return u&&l==="text/plain"&&(d=u,u=void 0),{action:i,method:t.toLowerCase(),encType:l,formData:u,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function zg(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function WE(n,e,t,i){let l=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t?l.pathname.endsWith("/")?l.pathname=`${l.pathname}_.${i}`:l.pathname=`${l.pathname}.${i}`:l.pathname==="/"?l.pathname=`_root.${i}`:e&&wi(l.pathname,e)==="/"?l.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:l.pathname=`${l.pathname.replace(/\/$/,"")}.${i}`,l}async function GE(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function KE(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function YE(n,e,t){let i=await Promise.all(n.map(async l=>{let u=e.routes[l.route.id];if(u){let d=await GE(u,t);return d.links?d.links():[]}return[]}));return ZE(i.flat(1).filter(KE).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function B1(n,e,t,i,l,u){let d=(g,y)=>t[y]?g.route.id!==t[y].route.id:!0,p=(g,y)=>t[y].pathname!==g.pathname||t[y].route.path?.endsWith("*")&&t[y].params["*"]!==g.params["*"];return u==="assets"?e.filter((g,y)=>d(g,y)||p(g,y)):u==="data"?e.filter((g,y)=>{let x=i.routes[g.route.id];if(!x||!x.hasLoader)return!1;if(d(g,y)||p(g,y))return!0;if(g.route.shouldRevalidate){let _=g.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:g.params,defaultShouldRevalidate:!0});if(typeof _=="boolean")return _}return!0}):[]}function QE(n,e,{includeHydrateFallback:t}={}){return XE(n.map(i=>{let l=e.routes[i.route.id];if(!l)return[];let u=[l.module];return l.clientActionModule&&(u=u.concat(l.clientActionModule)),l.clientLoaderModule&&(u=u.concat(l.clientLoaderModule)),t&&l.hydrateFallbackModule&&(u=u.concat(l.hydrateFallbackModule)),l.imports&&(u=u.concat(l.imports)),u}).flat(1))}function XE(n){return[...new Set(n)]}function JE(n){let e={},t=Object.keys(n).sort();for(let i of t)e[i]=n[i];return e}function ZE(n,e){let t=new Set;return new Set(e),n.reduce((i,l)=>{let u=JSON.stringify(JE(l));return t.has(u)||(t.add(u),i.push({key:u,link:l})),i},[])}function Z2(){let n=b.useContext(oc);return zg(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function eN(){let n=b.useContext(Zh);return zg(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var qg=b.createContext(void 0);qg.displayName="FrameworkContext";function ew(){let n=b.useContext(qg);return zg(n,"You must render this element inside a <HydratedRouter> element"),n}function tN(n,e){let t=b.useContext(qg),[i,l]=b.useState(!1),[u,d]=b.useState(!1),{onFocus:p,onBlur:g,onMouseEnter:y,onMouseLeave:x,onTouchStart:_}=e,j=b.useRef(null);b.useEffect(()=>{if(n==="render"&&d(!0),n==="viewport"){let V=ee=>{ee.forEach(Y=>{d(Y.isIntersecting)})},L=new IntersectionObserver(V,{threshold:.5});return j.current&&L.observe(j.current),()=>{L.disconnect()}}},[n]),b.useEffect(()=>{if(i){let V=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(V)}}},[i]);let O=()=>{l(!0)},$=()=>{l(!1),d(!1)};return t?n!=="intent"?[u,j,{}]:[u,j,{onFocus:eu(p,O),onBlur:eu(g,$),onMouseEnter:eu(y,O),onMouseLeave:eu(x,$),onTouchStart:eu(_,O)}]:[!1,j,{}]}function eu(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function sN({page:n,...e}){let{router:t}=Z2(),i=b.useMemo(()=>V2(t.routes,n,t.basename),[t.routes,n,t.basename]);return i?b.createElement(rN,{page:n,matches:i,...e}):null}function nN(n){let{manifest:e,routeModules:t}=ew(),[i,l]=b.useState([]);return b.useEffect(()=>{let u=!1;return YE(n,e,t).then(d=>{u||l(d)}),()=>{u=!0}},[n,e,t]),i}function rN({page:n,matches:e,...t}){let i=Aa(),{future:l,manifest:u,routeModules:d}=ew(),{basename:p}=Z2(),{loaderData:g,matches:y}=eN(),x=b.useMemo(()=>B1(n,e,y,u,i,"data"),[n,e,y,u,i]),_=b.useMemo(()=>B1(n,e,y,u,i,"assets"),[n,e,y,u,i]),j=b.useMemo(()=>{if(n===i.pathname+i.search+i.hash)return[];let V=new Set,L=!1;if(e.forEach(Y=>{let te=u.routes[Y.route.id];!te||!te.hasLoader||(!x.some(ke=>ke.route.id===Y.route.id)&&Y.route.id in g&&d[Y.route.id]?.shouldRevalidate||te.hasClientLoader?L=!0:V.add(Y.route.id))}),V.size===0)return[];let ee=WE(n,p,l.unstable_trailingSlashAwareDataRequests,"data");return L&&V.size>0&&ee.searchParams.set("_routes",e.filter(Y=>V.has(Y.route.id)).map(Y=>Y.route.id).join(",")),[ee.pathname+ee.search]},[p,l.unstable_trailingSlashAwareDataRequests,g,i,u,x,e,n,d]),O=b.useMemo(()=>QE(_,u),[_,u]),$=nN(_);return b.createElement(b.Fragment,null,j.map(V=>b.createElement("link",{key:V,rel:"prefetch",as:"fetch",href:V,...t})),O.map(V=>b.createElement("link",{key:V,rel:"modulepreload",href:V,...t})),$.map(({key:V,link:L})=>b.createElement("link",{key:V,nonce:t.nonce,...L,crossOrigin:L.crossOrigin??t.crossOrigin})))}function aN(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var iN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{iN&&(window.__reactRouterVersion="7.13.0")}catch{}function oN({basename:n,children:e,unstable_useTransitions:t,window:i}){let l=b.useRef();l.current==null&&(l.current=VT({window:i,v5Compat:!0}));let u=l.current,[d,p]=b.useState({action:u.action,location:u.location}),g=b.useCallback(y=>{t===!1?p(y):b.startTransition(()=>p(y))},[t]);return b.useLayoutEffect(()=>u.listen(g),[u,g]),b.createElement(PE,{basename:n,children:e,location:d.location,navigationType:d.action,navigator:u,unstable_useTransitions:t})}var tw=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,sw=b.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:l,reloadDocument:u,replace:d,state:p,target:g,to:y,preventScrollReset:x,viewTransition:_,unstable_defaultShouldRevalidate:j,...O},$){let{basename:V,unstable_useTransitions:L}=b.useContext(sa),ee=typeof y=="string"&&tw.test(y),Y=q2(y,V);y=Y.to;let te=vE(y,{relative:l}),[ke,Te,xe]=tN(i,O),R=dN(y,{replace:d,state:p,target:g,preventScrollReset:x,relative:l,viewTransition:_,unstable_defaultShouldRevalidate:j,unstable_useTransitions:L});function T(D){e&&e(D),D.defaultPrevented||R(D)}let S=b.createElement("a",{...O,...xe,href:Y.absoluteURL||te,onClick:Y.isExternal||u?e:T,ref:aN($,Te),target:g,"data-discover":!ee&&t==="render"?"true":void 0});return ke&&!ee?b.createElement(b.Fragment,null,S,b.createElement(sN,{page:te})):S});sw.displayName="Link";var lN=b.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:l=!1,style:u,to:d,viewTransition:p,children:g,...y},x){let _=Du(d,{relative:y.relative}),j=Aa(),O=b.useContext(Zh),{navigator:$,basename:V}=b.useContext(sa),L=O!=null&&yN(_)&&p===!0,ee=$.encodeLocation?$.encodeLocation(_).pathname:_.pathname,Y=j.pathname,te=O&&O.navigation&&O.navigation.location?O.navigation.location.pathname:null;t||(Y=Y.toLowerCase(),te=te?te.toLowerCase():null,ee=ee.toLowerCase()),te&&V&&(te=wi(te,V)||te);const ke=ee!=="/"&&ee.endsWith("/")?ee.length-1:ee.length;let Te=Y===ee||!l&&Y.startsWith(ee)&&Y.charAt(ke)==="/",xe=te!=null&&(te===ee||!l&&te.startsWith(ee)&&te.charAt(ee.length)==="/"),R={isActive:Te,isPending:xe,isTransitioning:L},T=Te?e:void 0,S;typeof i=="function"?S=i(R):S=[i,Te?"active":null,xe?"pending":null,L?"transitioning":null].filter(Boolean).join(" ");let D=typeof u=="function"?u(R):u;return b.createElement(sw,{...y,"aria-current":T,className:S,ref:x,style:D,to:d,viewTransition:p},typeof g=="function"?g(R):g)});lN.displayName="NavLink";var cN=b.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:l,state:u,method:d=gh,action:p,onSubmit:g,relative:y,preventScrollReset:x,viewTransition:_,unstable_defaultShouldRevalidate:j,...O},$)=>{let{unstable_useTransitions:V}=b.useContext(sa),L=pN(),ee=gN(p,{relative:y}),Y=d.toLowerCase()==="get"?"get":"post",te=typeof p=="string"&&tw.test(p),ke=Te=>{if(g&&g(Te),Te.defaultPrevented)return;Te.preventDefault();let xe=Te.nativeEvent.submitter,R=xe?.getAttribute("formmethod")||d,T=()=>L(xe||Te.currentTarget,{fetcherKey:e,method:R,navigate:t,replace:l,state:u,relative:y,preventScrollReset:x,viewTransition:_,unstable_defaultShouldRevalidate:j});V&&t!==!1?b.startTransition(()=>T()):T()};return b.createElement("form",{ref:$,method:Y,action:ee,onSubmit:i?g:ke,...O,"data-discover":!te&&n==="render"?"true":void 0})});cN.displayName="Form";function uN(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function nw(n){let e=b.useContext(oc);return gn(e,uN(n)),e}function dN(n,{target:e,replace:t,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p,unstable_useTransitions:g}={}){let y=Zn(),x=Aa(),_=Du(n,{relative:u});return b.useCallback(j=>{if(FE(j,e)){j.preventDefault();let O=t!==void 0?t:xu(x)===xu(_),$=()=>y(n,{replace:O,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p});g?b.startTransition(()=>$()):$()}},[x,y,_,t,i,e,n,l,u,d,p,g])}function hN(n){pa(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=b.useRef(ig(n)),t=b.useRef(!1),i=Aa(),l=b.useMemo(()=>zE(i.search,t.current?null:e.current),[i.search]),u=Zn(),d=b.useCallback((p,g)=>{const y=ig(typeof p=="function"?p(new URLSearchParams(l)):p);t.current=!0,u("?"+y,g)},[u,l]);return[l,d]}var mN=0,fN=()=>`__${String(++mN)}__`;function pN(){let{router:n}=nw("useSubmit"),{basename:e}=b.useContext(sa),t=AE(),i=n.fetch,l=n.navigate;return b.useCallback(async(u,d={})=>{let{action:p,method:g,encType:y,formData:x,body:_}=$E(u,e);if(d.navigate===!1){let j=d.fetcherKey||fN();await i(j,t,d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:x,body:_,formMethod:d.method||g,formEncType:d.encType||y,flushSync:d.flushSync})}else await l(d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:x,body:_,formMethod:d.method||g,formEncType:d.encType||y,replace:d.replace,state:d.state,fromRouteId:t,flushSync:d.flushSync,viewTransition:d.viewTransition})},[i,l,e,t])}function gN(n,{relative:e}={}){let{basename:t}=b.useContext(sa),i=b.useContext(Ra);gn(i,"useFormAction must be used inside a RouteContext");let[l]=i.matches.slice(-1),u={...Du(n||".",{relative:e})},d=Aa();if(n==null){u.search=d.search;let p=new URLSearchParams(u.search),g=p.getAll("index");if(g.some(x=>x==="")){p.delete("index"),g.filter(_=>_).forEach(_=>p.append("index",_));let x=p.toString();u.search=x?`?${x}`:""}}return(!n||n===".")&&l.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(u.pathname=u.pathname==="/"?t:bi([t,u.pathname])),xu(u)}function yN(n,{relative:e}={}){let t=b.useContext($2);gn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=nw("useViewTransitionState"),l=Du(n,{relative:e});if(!t.isTransitioning)return!1;let u=wi(t.currentLocation.pathname,i)||t.currentLocation.pathname,d=wi(t.nextLocation.pathname,i)||t.nextLocation.pathname;return Ch(l.pathname,d)!=null||Ch(l.pathname,u)!=null}const bN=()=>{};var V1={};const rw=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let l=n.charCodeAt(i);l<128?e[t++]=l:l<2048?(e[t++]=l>>6|192,e[t++]=l&63|128):(l&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(l=65536+((l&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=l>>18|240,e[t++]=l>>12&63|128,e[t++]=l>>6&63|128,e[t++]=l&63|128):(e[t++]=l>>12|224,e[t++]=l>>6&63|128,e[t++]=l&63|128)}return e},vN=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const l=n[t++];if(l<128)e[i++]=String.fromCharCode(l);else if(l>191&&l<224){const u=n[t++];e[i++]=String.fromCharCode((l&31)<<6|u&63)}else if(l>239&&l<365){const u=n[t++],d=n[t++],p=n[t++],g=((l&7)<<18|(u&63)<<12|(d&63)<<6|p&63)-65536;e[i++]=String.fromCharCode(55296+(g>>10)),e[i++]=String.fromCharCode(56320+(g&1023))}else{const u=n[t++],d=n[t++];e[i++]=String.fromCharCode((l&15)<<12|(u&63)<<6|d&63)}}return e.join("")},aw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let l=0;l<n.length;l+=3){const u=n[l],d=l+1<n.length,p=d?n[l+1]:0,g=l+2<n.length,y=g?n[l+2]:0,x=u>>2,_=(u&3)<<4|p>>4;let j=(p&15)<<2|y>>6,O=y&63;g||(O=64,d||(j=64)),i.push(t[x],t[_],t[j],t[O])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(rw(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):vN(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let l=0;l<n.length;){const u=t[n.charAt(l++)],p=l<n.length?t[n.charAt(l)]:0;++l;const y=l<n.length?t[n.charAt(l)]:64;++l;const _=l<n.length?t[n.charAt(l)]:64;if(++l,u==null||p==null||y==null||_==null)throw new xN;const j=u<<2|p>>4;if(i.push(j),y!==64){const O=p<<4&240|y>>2;if(i.push(O),_!==64){const $=y<<6&192|_;i.push($)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class xN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const wN=function(n){const e=rw(n);return aw.encodeByteArray(e,!0)},Rh=function(n){return wN(n).replace(/\./g,"")},iw=function(n){try{return aw.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function _N(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const kN=()=>_N().__FIREBASE_DEFAULTS__,jN=()=>{if(typeof process>"u"||typeof V1>"u")return;const n=V1.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},TN=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&iw(n[1]);return e&&JSON.parse(e)},tm=()=>{try{return bN()||kN()||jN()||TN()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},ow=n=>tm()?.emulatorHosts?.[n],lw=n=>{const e=ow(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},cw=()=>tm()?.config,uw=n=>tm()?.[`_${n}`];class EN{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function bo(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Hg(n){return(await fetch(n,{credentials:"include"})).ok}function dw(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",l=n.iat||0,u=n.sub||n.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d={iss:`https://securetoken.google.com/${i}`,aud:i,iat:l,exp:l+3600,auth_time:l,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Rh(JSON.stringify(t)),Rh(JSON.stringify(d)),""].join(".")}const mu={};function NN(){const n={prod:[],emulator:[]};for(const e of Object.keys(mu))mu[e]?n.emulator.push(e):n.prod.push(e);return n}function SN(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let U1=!1;function $g(n,e){if(typeof window>"u"||typeof document>"u"||!bo(window.location.host)||mu[n]===e||mu[n]||U1)return;mu[n]=e;function t(j){return`__firebase__banner__${j}`}const i="__firebase__banner",u=NN().prod.length>0;function d(){const j=document.getElementById(i);j&&j.remove()}function p(j){j.style.display="flex",j.style.background="#7faaf0",j.style.position="fixed",j.style.bottom="5px",j.style.left="5px",j.style.padding=".5em",j.style.borderRadius="5px",j.style.alignItems="center"}function g(j,O){j.setAttribute("width","24"),j.setAttribute("id",O),j.setAttribute("height","24"),j.setAttribute("viewBox","0 0 24 24"),j.setAttribute("fill","none"),j.style.marginLeft="-6px"}function y(){const j=document.createElement("span");return j.style.cursor="pointer",j.style.marginLeft="16px",j.style.fontSize="24px",j.innerHTML=" &times;",j.onclick=()=>{U1=!0,d()},j}function x(j,O){j.setAttribute("id",O),j.innerText="Learn more",j.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",j.setAttribute("target","__blank"),j.style.paddingLeft="5px",j.style.textDecoration="underline"}function _(){const j=SN(i),O=t("text"),$=document.getElementById(O)||document.createElement("span"),V=t("learnmore"),L=document.getElementById(V)||document.createElement("a"),ee=t("preprendIcon"),Y=document.getElementById(ee)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(j.created){const te=j.element;p(te),x(L,V);const ke=y();g(Y,ee),te.append(Y,$,L,ke),document.body.appendChild(te)}u?($.innerText="Preview backend disconnected.",Y.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(Y.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,$.innerText="Preview backend running in this workspace."),$.setAttribute("id",O)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",_):_()}function xr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function CN(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(xr())}function RN(){const n=tm()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function AN(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function IN(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function MN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function DN(){const n=xr();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function PN(){return!RN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function LN(){try{return typeof indexedDB=="object"}catch{return!1}}function ON(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",l=self.indexedDB.open(i);l.onsuccess=()=>{l.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},l.onupgradeneeded=()=>{t=!1},l.onerror=()=>{e(l.error?.message||"")}}catch(t){e(t)}})}const BN="FirebaseError";class Qa extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=BN,Object.setPrototypeOf(this,Qa.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Pu.prototype.create)}}class Pu{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},l=`${this.service}/${e}`,u=this.errors[e],d=u?VN(u,i):"Error",p=`${this.serviceName}: ${d} (${l}).`;return new Qa(l,p,i)}}function VN(n,e){return n.replace(UN,(t,i)=>{const l=e[i];return l!=null?String(l):`<${i}?>`})}const UN=/\{\$([^}]+)}/g;function FN(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Xo(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const l of t){if(!i.includes(l))return!1;const u=n[l],d=e[l];if(F1(u)&&F1(d)){if(!Xo(u,d))return!1}else if(u!==d)return!1}for(const l of i)if(!t.includes(l))return!1;return!0}function F1(n){return n!==null&&typeof n=="object"}function Lu(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(l=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(l))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function ou(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[l,u]=i.split("=");e[decodeURIComponent(l)]=decodeURIComponent(u)}}),e}function lu(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function zN(n,e){const t=new qN(n,e);return t.subscribe.bind(t)}class qN{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let l;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");HN(e,["next","error","complete"])?l=e:l={next:e,error:t,complete:i},l.next===void 0&&(l.next=Cp),l.error===void 0&&(l.error=Cp),l.complete===void 0&&(l.complete=Cp);const u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?l.error(this.finalError):l.complete()}catch{}}),this.observers.push(l),u}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function HN(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Cp(){}function sn(n){return n&&n._delegate?n._delegate:n}class uo{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const $o="[DEFAULT]";class $N{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new EN;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const l=this.getOrInitializeService({instanceIdentifier:t});l&&i.resolve(l)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(l){if(i)return null;throw l}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(GN(e))try{this.getOrInitializeService({instanceIdentifier:$o})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(t);try{const u=this.getOrInitializeService({instanceIdentifier:l});i.resolve(u)}catch{}}}}clearInstance(e=$o){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=$o){return this.instances.has(e)}getOptions(e=$o){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const l=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[u,d]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(u);i===p&&d.resolve(l)}return l}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),l=this.onInitCallbacks.get(i)??new Set;l.add(e),this.onInitCallbacks.set(i,l);const u=this.instances.get(i);return u&&e(u,i),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const l of i)try{l(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:WN(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=$o){return this.component?this.component.multipleInstances?e:$o:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function WN(n){return n===$o?void 0:n}function GN(n){return n.instantiationMode==="EAGER"}class KN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new $N(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var ks;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(ks||(ks={}));const YN={debug:ks.DEBUG,verbose:ks.VERBOSE,info:ks.INFO,warn:ks.WARN,error:ks.ERROR,silent:ks.SILENT},QN=ks.INFO,XN={[ks.DEBUG]:"log",[ks.VERBOSE]:"log",[ks.INFO]:"info",[ks.WARN]:"warn",[ks.ERROR]:"error"},JN=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),l=XN[e];if(l)console[l](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Wg{constructor(e){this.name=e,this._logLevel=QN,this._logHandler=JN,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ks))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?YN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ks.DEBUG,...e),this._logHandler(this,ks.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ks.VERBOSE,...e),this._logHandler(this,ks.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ks.INFO,...e),this._logHandler(this,ks.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ks.WARN,...e),this._logHandler(this,ks.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ks.ERROR,...e),this._logHandler(this,ks.ERROR,...e)}}const ZN=(n,e)=>e.some(t=>n instanceof t);let z1,q1;function eS(){return z1||(z1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function tS(){return q1||(q1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const hw=new WeakMap,og=new WeakMap,mw=new WeakMap,Rp=new WeakMap,Gg=new WeakMap;function sS(n){const e=new Promise((t,i)=>{const l=()=>{n.removeEventListener("success",u),n.removeEventListener("error",d)},u=()=>{t(ao(n.result)),l()},d=()=>{i(n.error),l()};n.addEventListener("success",u),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&hw.set(t,n)}).catch(()=>{}),Gg.set(e,n),e}function nS(n){if(og.has(n))return;const e=new Promise((t,i)=>{const l=()=>{n.removeEventListener("complete",u),n.removeEventListener("error",d),n.removeEventListener("abort",d)},u=()=>{t(),l()},d=()=>{i(n.error||new DOMException("AbortError","AbortError")),l()};n.addEventListener("complete",u),n.addEventListener("error",d),n.addEventListener("abort",d)});og.set(n,e)}let lg={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return og.get(n);if(e==="objectStoreNames")return n.objectStoreNames||mw.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ao(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function rS(n){lg=n(lg)}function aS(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Ap(this),e,...t);return mw.set(i,e.sort?e.sort():[e]),ao(i)}:tS().includes(n)?function(...e){return n.apply(Ap(this),e),ao(hw.get(this))}:function(...e){return ao(n.apply(Ap(this),e))}}function iS(n){return typeof n=="function"?aS(n):(n instanceof IDBTransaction&&nS(n),ZN(n,eS())?new Proxy(n,lg):n)}function ao(n){if(n instanceof IDBRequest)return sS(n);if(Rp.has(n))return Rp.get(n);const e=iS(n);return e!==n&&(Rp.set(n,e),Gg.set(e,n)),e}const Ap=n=>Gg.get(n);function oS(n,e,{blocked:t,upgrade:i,blocking:l,terminated:u}={}){const d=indexedDB.open(n,e),p=ao(d);return i&&d.addEventListener("upgradeneeded",g=>{i(ao(d.result),g.oldVersion,g.newVersion,ao(d.transaction),g)}),t&&d.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),p.then(g=>{u&&g.addEventListener("close",()=>u()),l&&g.addEventListener("versionchange",y=>l(y.oldVersion,y.newVersion,y))}).catch(()=>{}),p}const lS=["get","getKey","getAll","getAllKeys","count"],cS=["put","add","delete","clear"],Ip=new Map;function H1(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Ip.get(e))return Ip.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,l=cS.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(l||lS.includes(t)))return;const u=async function(d,...p){const g=this.transaction(d,l?"readwrite":"readonly");let y=g.store;return i&&(y=y.index(p.shift())),(await Promise.all([y[t](...p),l&&g.done]))[0]};return Ip.set(e,u),u}rS(n=>({...n,get:(e,t,i)=>H1(e,t)||n.get(e,t,i),has:(e,t)=>!!H1(e,t)||n.has(e,t)}));class uS{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(dS(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function dS(n){return n.getComponent()?.type==="VERSION"}const cg="@firebase/app",$1="0.14.7";const _i=new Wg("@firebase/app"),hS="@firebase/app-compat",mS="@firebase/analytics-compat",fS="@firebase/analytics",pS="@firebase/app-check-compat",gS="@firebase/app-check",yS="@firebase/auth",bS="@firebase/auth-compat",vS="@firebase/database",xS="@firebase/data-connect",wS="@firebase/database-compat",_S="@firebase/functions",kS="@firebase/functions-compat",jS="@firebase/installations",TS="@firebase/installations-compat",ES="@firebase/messaging",NS="@firebase/messaging-compat",SS="@firebase/performance",CS="@firebase/performance-compat",RS="@firebase/remote-config",AS="@firebase/remote-config-compat",IS="@firebase/storage",MS="@firebase/storage-compat",DS="@firebase/firestore",PS="@firebase/ai",LS="@firebase/firestore-compat",OS="firebase",BS="12.8.0";const ug="[DEFAULT]",VS={[cg]:"fire-core",[hS]:"fire-core-compat",[fS]:"fire-analytics",[mS]:"fire-analytics-compat",[gS]:"fire-app-check",[pS]:"fire-app-check-compat",[yS]:"fire-auth",[bS]:"fire-auth-compat",[vS]:"fire-rtdb",[xS]:"fire-data-connect",[wS]:"fire-rtdb-compat",[_S]:"fire-fn",[kS]:"fire-fn-compat",[jS]:"fire-iid",[TS]:"fire-iid-compat",[ES]:"fire-fcm",[NS]:"fire-fcm-compat",[SS]:"fire-perf",[CS]:"fire-perf-compat",[RS]:"fire-rc",[AS]:"fire-rc-compat",[IS]:"fire-gcs",[MS]:"fire-gcs-compat",[DS]:"fire-fst",[LS]:"fire-fst-compat",[PS]:"fire-vertex","fire-js":"fire-js",[OS]:"fire-js-all"};const Ah=new Map,US=new Map,dg=new Map;function W1(n,e){try{n.container.addComponent(e)}catch(t){_i.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Jo(n){const e=n.name;if(dg.has(e))return _i.debug(`There were multiple attempts to register component ${e}.`),!1;dg.set(e,n);for(const t of Ah.values())W1(t,n);for(const t of US.values())W1(t,n);return!0}function sm(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Zr(n){return n==null?!1:n.settings!==void 0}const FS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},io=new Pu("app","Firebase",FS);class zS{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new uo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw io.create("app-deleted",{appName:this._name})}}const al=BS;function Kg(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:ug,automaticDataCollectionEnabled:!0,...e},l=i.name;if(typeof l!="string"||!l)throw io.create("bad-app-name",{appName:String(l)});if(t||(t=cw()),!t)throw io.create("no-options");const u=Ah.get(l);if(u){if(Xo(t,u.options)&&Xo(i,u.config))return u;throw io.create("duplicate-app",{appName:l})}const d=new KN(l);for(const g of dg.values())d.addComponent(g);const p=new zS(t,i,d);return Ah.set(l,p),p}function Yg(n=ug){const e=Ah.get(n);if(!e&&n===ug&&cw())return Kg();if(!e)throw io.create("no-app",{appName:n});return e}function za(n,e,t){let i=VS[n]??n;t&&(i+=`-${t}`);const l=i.match(/\s|\//),u=e.match(/\s|\//);if(l||u){const d=[`Unable to register library "${i}" with version "${e}":`];l&&d.push(`library name "${i}" contains illegal characters (whitespace or "/")`),l&&u&&d.push("and"),u&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),_i.warn(d.join(" "));return}Jo(new uo(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const qS="firebase-heartbeat-database",HS=1,wu="firebase-heartbeat-store";let Mp=null;function fw(){return Mp||(Mp=oS(qS,HS,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(wu)}catch(t){console.warn(t)}}}}).catch(n=>{throw io.create("idb-open",{originalErrorMessage:n.message})})),Mp}async function $S(n){try{const t=(await fw()).transaction(wu),i=await t.objectStore(wu).get(pw(n));return await t.done,i}catch(e){if(e instanceof Qa)_i.warn(e.message);else{const t=io.create("idb-get",{originalErrorMessage:e?.message});_i.warn(t.message)}}}async function G1(n,e){try{const i=(await fw()).transaction(wu,"readwrite");await i.objectStore(wu).put(e,pw(n)),await i.done}catch(t){if(t instanceof Qa)_i.warn(t.message);else{const i=io.create("idb-set",{originalErrorMessage:t?.message});_i.warn(i.message)}}}function pw(n){return`${n.name}!${n.options.appId}`}const WS=1024,GS=30;class KS{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new QS(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=K1();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(l=>l.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>GS){const l=XS(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){_i.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=K1(),{heartbeatsToSend:t,unsentEntries:i}=YS(this._heartbeatsCache.heartbeats),l=Rh(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(e){return _i.warn(e),""}}}function K1(){return new Date().toISOString().substring(0,10)}function YS(n,e=WS){const t=[];let i=n.slice();for(const l of n){const u=t.find(d=>d.agent===l.agent);if(u){if(u.dates.push(l.date),Y1(t)>e){u.dates.pop();break}}else if(t.push({agent:l.agent,dates:[l.date]}),Y1(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class QS{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return LN()?ON().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await $S(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return G1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return G1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Y1(n){return Rh(JSON.stringify({version:2,heartbeats:n})).length}function XS(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function JS(n){Jo(new uo("platform-logger",e=>new uS(e),"PRIVATE")),Jo(new uo("heartbeat",e=>new KS(e),"PRIVATE")),za(cg,$1,n),za(cg,$1,"esm2020"),za("fire-js","")}JS("");function gw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ZS=gw,yw=new Pu("auth","Firebase",gw());const Ih=new Wg("@firebase/auth");function eC(n,...e){Ih.logLevel<=ks.WARN&&Ih.warn(`Auth (${al}): ${n}`,...e)}function bh(n,...e){Ih.logLevel<=ks.ERROR&&Ih.error(`Auth (${al}): ${n}`,...e)}function Sa(n,...e){throw Qg(n,...e)}function qa(n,...e){return Qg(n,...e)}function bw(n,e,t){const i={...ZS(),[e]:t};return new Pu("auth","Firebase",i).create(e,{appName:n.name})}function vi(n){return bw(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Qg(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return yw.create(n,...e)}function Wt(n,e,...t){if(!n)throw Qg(e,...t)}function fi(n){const e="INTERNAL ASSERTION FAILED: "+n;throw bh(e),new Error(e)}function ki(n,e){n||fi(e)}function hg(){return typeof self<"u"&&self.location?.href||""}function tC(){return Q1()==="http:"||Q1()==="https:"}function Q1(){return typeof self<"u"&&self.location?.protocol||null}function sC(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(tC()||IN()||"connection"in navigator)?navigator.onLine:!0}function nC(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Ou{constructor(e,t){this.shortDelay=e,this.longDelay=t,ki(t>e,"Short delay should be less than long delay!"),this.isMobile=CN()||MN()}get(){return sC()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Xg(n,e){ki(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class vw{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;fi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;fi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;fi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const rC={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const aC=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],iC=new Ou(3e4,6e4);function Ei(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Ni(n,e,t,i,l={}){return xw(n,l,async()=>{let u={},d={};i&&(e==="GET"?d=i:u={body:JSON.stringify(i)});const p=Lu({key:n.config.apiKey,...d}).slice(1),g=await n._getAdditionalHeaders();g["Content-Type"]="application/json",n.languageCode&&(g["X-Firebase-Locale"]=n.languageCode);const y={method:e,headers:g,...u};return AN()||(y.referrerPolicy="no-referrer"),n.emulatorConfig&&bo(n.emulatorConfig.host)&&(y.credentials="include"),vw.fetch()(await ww(n,n.config.apiHost,t,p),y)})}async function xw(n,e,t){n._canInitEmulator=!1;const i={...rC,...e};try{const l=new lC(n),u=await Promise.race([t(),l.promise]);l.clearNetworkTimeout();const d=await u.json();if("needConfirmation"in d)throw sh(n,"account-exists-with-different-credential",d);if(u.ok&&!("errorMessage"in d))return d;{const p=u.ok?d.errorMessage:d.error.message,[g,y]=p.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw sh(n,"credential-already-in-use",d);if(g==="EMAIL_EXISTS")throw sh(n,"email-already-in-use",d);if(g==="USER_DISABLED")throw sh(n,"user-disabled",d);const x=i[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw bw(n,x,y);Sa(n,x)}}catch(l){if(l instanceof Qa)throw l;Sa(n,"network-request-failed",{message:String(l)})}}async function Bu(n,e,t,i,l={}){const u=await Ni(n,e,t,i,l);return"mfaPendingCredential"in u&&Sa(n,"multi-factor-auth-required",{_serverResponse:u}),u}async function ww(n,e,t,i){const l=`${e}${t}?${i}`,u=n,d=u.config.emulator?Xg(n.config,l):`${n.config.apiScheme}://${l}`;return aC.includes(t)&&(await u._persistenceManagerAvailable,u._getPersistenceType()==="COOKIE")?u._getPersistence()._getFinalTarget(d).toString():d}function oC(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class lC{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(qa(this.auth,"network-request-failed")),iC.get())})}}function sh(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const l=qa(n,e,i);return l.customData._tokenResponse=t,l}function X1(n){return n!==void 0&&n.enterprise!==void 0}class cC{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return oC(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function uC(n,e){return Ni(n,"GET","/v2/recaptchaConfig",Ei(n,e))}async function dC(n,e){return Ni(n,"POST","/v1/accounts:delete",e)}async function Mh(n,e){return Ni(n,"POST","/v1/accounts:lookup",e)}function fu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function hC(n,e=!1){const t=sn(n),i=await t.getIdToken(e),l=Jg(i);Wt(l&&l.exp&&l.auth_time&&l.iat,t.auth,"internal-error");const u=typeof l.firebase=="object"?l.firebase:void 0,d=u?.sign_in_provider;return{claims:l,token:i,authTime:fu(Dp(l.auth_time)),issuedAtTime:fu(Dp(l.iat)),expirationTime:fu(Dp(l.exp)),signInProvider:d||null,signInSecondFactor:u?.sign_in_second_factor||null}}function Dp(n){return Number(n)*1e3}function Jg(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return bh("JWT malformed, contained fewer than 3 sections"),null;try{const l=iw(t);return l?JSON.parse(l):(bh("Failed to decode base64 JWT payload"),null)}catch(l){return bh("Caught error parsing JWT payload as JSON",l?.toString()),null}}function J1(n){const e=Jg(n);return Wt(e,"internal-error"),Wt(typeof e.exp<"u","internal-error"),Wt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function _u(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Qa&&mC(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function mC({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class fC{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class mg{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=fu(this.lastLoginAt),this.creationTime=fu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Dh(n){const e=n.auth,t=await n.getIdToken(),i=await _u(n,Mh(e,{idToken:t}));Wt(i?.users.length,e,"internal-error");const l=i.users[0];n._notifyReloadListener(l);const u=l.providerUserInfo?.length?_w(l.providerUserInfo):[],d=gC(n.providerData,u),p=n.isAnonymous,g=!(n.email&&l.passwordHash)&&!d?.length,y=p?g:!1,x={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:d,metadata:new mg(l.createdAt,l.lastLoginAt),isAnonymous:y};Object.assign(n,x)}async function pC(n){const e=sn(n);await Dh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function gC(n,e){return[...n.filter(i=>!e.some(l=>l.providerId===i.providerId)),...e]}function _w(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function yC(n,e){const t=await xw(n,{},async()=>{const i=Lu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:l,apiKey:u}=n.config,d=await ww(n,l,"/v1/token",`key=${u}`),p=await n._getAdditionalHeaders();p["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:p,body:i};return n.emulatorConfig&&bo(n.emulatorConfig.host)&&(g.credentials="include"),vw.fetch()(d,g)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function bC(n,e){return Ni(n,"POST","/v2/accounts:revokeToken",Ei(n,e))}class Yl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Wt(e.idToken,"internal-error"),Wt(typeof e.idToken<"u","internal-error"),Wt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):J1(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Wt(e.length!==0,"internal-error");const t=J1(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Wt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:l,expiresIn:u}=await yC(e,t);this.updateTokensAndExpiration(i,l,Number(u))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:l,expirationTime:u}=t,d=new Yl;return i&&(Wt(typeof i=="string","internal-error",{appName:e}),d.refreshToken=i),l&&(Wt(typeof l=="string","internal-error",{appName:e}),d.accessToken=l),u&&(Wt(typeof u=="number","internal-error",{appName:e}),d.expirationTime=u),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Yl,this.toJSON())}_performRefresh(){return fi("not implemented")}}function Xi(n,e){Wt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Ea{constructor({uid:e,auth:t,stsTokenManager:i,...l}){this.providerId="firebase",this.proactiveRefresh=new fC(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new mg(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await _u(this,this.stsTokenManager.getToken(this.auth,e));return Wt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return hC(this,e)}reload(){return pC(this)}_assign(e){this!==e&&(Wt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ea({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Wt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Dh(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Zr(this.auth.app))return Promise.reject(vi(this.auth));const e=await this.getIdToken();return await _u(this,dC(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,l=t.email??void 0,u=t.phoneNumber??void 0,d=t.photoURL??void 0,p=t.tenantId??void 0,g=t._redirectEventId??void 0,y=t.createdAt??void 0,x=t.lastLoginAt??void 0,{uid:_,emailVerified:j,isAnonymous:O,providerData:$,stsTokenManager:V}=t;Wt(_&&V,e,"internal-error");const L=Yl.fromJSON(this.name,V);Wt(typeof _=="string",e,"internal-error"),Xi(i,e.name),Xi(l,e.name),Wt(typeof j=="boolean",e,"internal-error"),Wt(typeof O=="boolean",e,"internal-error"),Xi(u,e.name),Xi(d,e.name),Xi(p,e.name),Xi(g,e.name),Xi(y,e.name),Xi(x,e.name);const ee=new Ea({uid:_,auth:e,email:l,emailVerified:j,displayName:i,isAnonymous:O,photoURL:d,phoneNumber:u,tenantId:p,stsTokenManager:L,createdAt:y,lastLoginAt:x});return $&&Array.isArray($)&&(ee.providerData=$.map(Y=>({...Y}))),g&&(ee._redirectEventId=g),ee}static async _fromIdTokenResponse(e,t,i=!1){const l=new Yl;l.updateFromServerResponse(t);const u=new Ea({uid:t.localId,auth:e,stsTokenManager:l,isAnonymous:i});return await Dh(u),u}static async _fromGetAccountInfoResponse(e,t,i){const l=t.users[0];Wt(l.localId!==void 0,"internal-error");const u=l.providerUserInfo!==void 0?_w(l.providerUserInfo):[],d=!(l.email&&l.passwordHash)&&!u?.length,p=new Yl;p.updateFromIdToken(i);const g=new Ea({uid:l.localId,auth:e,stsTokenManager:p,isAnonymous:d}),y={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:u,metadata:new mg(l.createdAt,l.lastLoginAt),isAnonymous:!(l.email&&l.passwordHash)&&!u?.length};return Object.assign(g,y),g}}const Z1=new Map;function pi(n){ki(n instanceof Function,"Expected a class definition");let e=Z1.get(n);return e?(ki(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Z1.set(n,e),e)}class kw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}kw.type="NONE";const ex=kw;function vh(n,e,t){return`firebase:${n}:${e}:${t}`}class Ql{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:l,name:u}=this.auth;this.fullUserKey=vh(this.userKey,l.apiKey,u),this.fullPersistenceKey=vh("persistence",l.apiKey,u),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Mh(this.auth,{idToken:e}).catch(()=>{});return t?Ea._fromGetAccountInfoResponse(this.auth,t,e):null}return Ea._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Ql(pi(ex),e,i);const l=(await Promise.all(t.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let u=l[0]||pi(ex);const d=vh(i,e.config.apiKey,e.name);let p=null;for(const y of t)try{const x=await y._get(d);if(x){let _;if(typeof x=="string"){const j=await Mh(e,{idToken:x}).catch(()=>{});if(!j)break;_=await Ea._fromGetAccountInfoResponse(e,j,x)}else _=Ea._fromJSON(e,x);y!==u&&(p=_),u=y;break}}catch{}const g=l.filter(y=>y._shouldAllowMigration);return!u._shouldAllowMigration||!g.length?new Ql(u,e,i):(u=g[0],p&&await u._set(d,p.toJSON()),await Promise.all(t.map(async y=>{if(y!==u)try{await y._remove(d)}catch{}})),new Ql(u,e,i))}}function tx(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Nw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(jw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Cw(e))return"Blackberry";if(Rw(e))return"Webos";if(Tw(e))return"Safari";if((e.includes("chrome/")||Ew(e))&&!e.includes("edge/"))return"Chrome";if(Sw(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function jw(n=xr()){return/firefox\//i.test(n)}function Tw(n=xr()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Ew(n=xr()){return/crios\//i.test(n)}function Nw(n=xr()){return/iemobile/i.test(n)}function Sw(n=xr()){return/android/i.test(n)}function Cw(n=xr()){return/blackberry/i.test(n)}function Rw(n=xr()){return/webos/i.test(n)}function Zg(n=xr()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function vC(n=xr()){return Zg(n)&&!!window.navigator?.standalone}function xC(){return DN()&&document.documentMode===10}function Aw(n=xr()){return Zg(n)||Sw(n)||Rw(n)||Cw(n)||/windows phone/i.test(n)||Nw(n)}function Iw(n,e=[]){let t;switch(n){case"Browser":t=tx(xr());break;case"Worker":t=`${tx(xr())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${al}/${i}`}class wC{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=u=>new Promise((d,p)=>{try{const g=e(u);d(g)}catch(g){p(g)}});i.onAbort=t,this.queue.push(i);const l=this.queue.length-1;return()=>{this.queue[l]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const l of t)try{l()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function _C(n,e={}){return Ni(n,"GET","/v2/passwordPolicy",Ei(n,e))}const kC=6;class jC{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??kC,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,l=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),l&&(t.meetsMaxPasswordLength=e.length<=l)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let l=0;l<e.length;l++)i=e.charAt(l),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,l,u){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=l)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=u))}}class TC{constructor(e,t,i,l){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=l,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new sx(this),this.idTokenSubscription=new sx(this),this.beforeStateQueue=new wC(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=yw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=l.sdkClientVersion,this._persistenceManagerAvailable=new Promise(u=>this._resolvePersistenceManagerAvailable=u)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=pi(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Ql.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Mh(this,{idToken:e}),i=await Ea._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Zr(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=this.redirectUser?._redirectEventId,d=i?._redirectEventId,p=await this.tryRedirectSignIn(e);(!u||u===d)&&p?.user&&(i=p.user,l=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Wt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Dh(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=nC()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Zr(this.app))return Promise.reject(vi(this));const t=e?sn(e):null;return t&&Wt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Wt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Zr(this.app)?Promise.reject(vi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Zr(this.app)?Promise.reject(vi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(pi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await _C(this),t=new jC(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Pu("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await bC(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&pi(e)||this._popupRedirectResolver;Wt(t,this,"argument-error"),this.redirectPersistenceManager=await Ql.create(this,[pi(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,l){if(this._deleted)return()=>{};const u=typeof t=="function"?t:t.next.bind(t);let d=!1;const p=this._isInitialized?Promise.resolve():this._initializationPromise;if(Wt(p,this,"internal-error"),p.then(()=>{d||u(this.currentUser)}),typeof t=="function"){const g=e.addObserver(t,i,l);return()=>{d=!0,g()}}else{const g=e.addObserver(t);return()=>{d=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Wt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Iw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Zr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&eC(`Error while retrieving App Check token: ${e.error}`),e?.token}}function vo(n){return sn(n)}class sx{constructor(e){this.auth=e,this.observer=null,this.addObserver=zN(t=>this.observer=t)}get next(){return Wt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let nm={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function EC(n){nm=n}function Mw(n){return nm.loadJS(n)}function NC(){return nm.recaptchaEnterpriseScript}function SC(){return nm.gapiScript}function CC(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class RC{constructor(){this.enterprise=new AC}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class AC{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const IC="recaptcha-enterprise",Dw="NO_RECAPTCHA";class MC{constructor(e){this.type=IC,this.auth=vo(e)}async verify(e="verify",t=!1){async function i(u){if(!t){if(u.tenantId==null&&u._agentRecaptchaConfig!=null)return u._agentRecaptchaConfig.siteKey;if(u.tenantId!=null&&u._tenantRecaptchaConfigs[u.tenantId]!==void 0)return u._tenantRecaptchaConfigs[u.tenantId].siteKey}return new Promise(async(d,p)=>{uC(u,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)p(new Error("recaptcha Enterprise site key undefined"));else{const y=new cC(g);return u.tenantId==null?u._agentRecaptchaConfig=y:u._tenantRecaptchaConfigs[u.tenantId]=y,d(y.siteKey)}}).catch(g=>{p(g)})})}function l(u,d,p){const g=window.grecaptcha;X1(g)?g.enterprise.ready(()=>{g.enterprise.execute(u,{action:e}).then(y=>{d(y)}).catch(()=>{d(Dw)})}):p(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new RC().execute("siteKey",{action:"verify"}):new Promise((u,d)=>{i(this.auth).then(p=>{if(!t&&X1(window.grecaptcha))l(p,u,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let g=NC();g.length!==0&&(g+=p),Mw(g).then(()=>{l(p,u,d)}).catch(y=>{d(y)})}}).catch(p=>{d(p)})})}}async function nx(n,e,t,i=!1,l=!1){const u=new MC(n);let d;if(l)d=Dw;else try{d=await u.verify(t)}catch{d=await u.verify(t,!0)}const p={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in p){const g=p.phoneEnrollmentInfo.phoneNumber,y=p.phoneEnrollmentInfo.recaptchaToken;Object.assign(p,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:y,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in p){const g=p.phoneSignInInfo.recaptchaToken;Object.assign(p,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return p}return i?Object.assign(p,{captchaResp:d}):Object.assign(p,{captchaResponse:d}),Object.assign(p,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(p,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),p}async function Ph(n,e,t,i,l){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await nx(n,e,t,t==="getOobCode");return i(n,u)}else return i(n,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await nx(n,e,t,t==="getOobCode");return i(n,d)}else return Promise.reject(u)})}function DC(n,e){const t=sm(n,"auth");if(t.isInitialized()){const l=t.getImmediate(),u=t.getOptions();if(Xo(u,e??{}))return l;Sa(l,"already-initialized")}return t.initialize({options:e})}function PC(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(pi);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function LC(n,e,t){const i=vo(n);Wt(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const l=!1,u=Pw(e),{host:d,port:p}=OC(e),g=p===null?"":`:${p}`,y={url:`${u}//${d}${g}/`},x=Object.freeze({host:d,port:p,protocol:u.replace(":",""),options:Object.freeze({disableWarnings:l})});if(!i._canInitEmulator){Wt(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Wt(Xo(y,i.config.emulator)&&Xo(x,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=y,i.emulatorConfig=x,i.settings.appVerificationDisabledForTesting=!0,bo(d)?(Hg(`${u}//${d}${g}`),$g("Auth",!0)):BC()}function Pw(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function OC(n){const e=Pw(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",l=/^(\[[^\]]+\])(:|$)/.exec(i);if(l){const u=l[1];return{host:u,port:rx(i.substr(u.length+1))}}else{const[u,d]=i.split(":");return{host:u,port:rx(d)}}}function rx(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function BC(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class ey{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return fi("not implemented")}_getIdTokenResponse(e){return fi("not implemented")}_linkToIdToken(e,t){return fi("not implemented")}_getReauthenticationResolver(e){return fi("not implemented")}}async function VC(n,e){return Ni(n,"POST","/v1/accounts:signUp",e)}async function UC(n,e){return Bu(n,"POST","/v1/accounts:signInWithPassword",Ei(n,e))}async function Lw(n,e){return Ni(n,"POST","/v1/accounts:sendOobCode",Ei(n,e))}async function FC(n,e){return Lw(n,e)}async function zC(n,e){return Lw(n,e)}async function qC(n,e){return Bu(n,"POST","/v1/accounts:signInWithEmailLink",Ei(n,e))}async function HC(n,e){return Bu(n,"POST","/v1/accounts:signInWithEmailLink",Ei(n,e))}class ku extends ey{constructor(e,t,i,l=null){super("password",i),this._email=e,this._password=t,this._tenantId=l}static _fromEmailAndPassword(e,t){return new ku(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new ku(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ph(e,t,"signInWithPassword",UC);case"emailLink":return qC(e,{email:this._email,oobCode:this._password});default:Sa(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ph(e,i,"signUpPassword",VC);case"emailLink":return HC(e,{idToken:t,email:this._email,oobCode:this._password});default:Sa(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Xl(n,e){return Bu(n,"POST","/v1/accounts:signInWithIdp",Ei(n,e))}const $C="http://localhost";class Zo extends ey{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Zo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Sa("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:l,...u}=t;if(!i||!l)return null;const d=new Zo(i,l);return d.idToken=u.idToken||void 0,d.accessToken=u.accessToken||void 0,d.secret=u.secret,d.nonce=u.nonce,d.pendingToken=u.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Xl(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Xl(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Xl(e,t)}buildRequest(){const e={requestUri:$C,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Lu(t)}return e}}function WC(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function GC(n){const e=ou(lu(n)).link,t=e?ou(lu(e)).deep_link_id:null,i=ou(lu(n)).deep_link_id;return(i?ou(lu(i)).link:null)||i||t||e||n}class ty{constructor(e){const t=ou(lu(e)),i=t.apiKey??null,l=t.oobCode??null,u=WC(t.mode??null);Wt(i&&l&&u,"argument-error"),this.apiKey=i,this.operation=u,this.code=l,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=GC(e);try{return new ty(t)}catch{return null}}}class cc{constructor(){this.providerId=cc.PROVIDER_ID}static credential(e,t){return ku._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=ty.parseLink(t);return Wt(i,"argument-error"),ku._fromEmailAndCode(e,i.code,i.tenantId)}}cc.PROVIDER_ID="password";cc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";cc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Ow{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Vu extends Ow{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Zi extends Vu{constructor(){super("facebook.com")}static credential(e){return Zo._fromParams({providerId:Zi.PROVIDER_ID,signInMethod:Zi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Zi.credentialFromTaggedObject(e)}static credentialFromError(e){return Zi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Zi.credential(e.oauthAccessToken)}catch{return null}}}Zi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Zi.PROVIDER_ID="facebook.com";class eo extends Vu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Zo._fromParams({providerId:eo.PROVIDER_ID,signInMethod:eo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return eo.credentialFromTaggedObject(e)}static credentialFromError(e){return eo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return eo.credential(t,i)}catch{return null}}}eo.GOOGLE_SIGN_IN_METHOD="google.com";eo.PROVIDER_ID="google.com";class to extends Vu{constructor(){super("github.com")}static credential(e){return Zo._fromParams({providerId:to.PROVIDER_ID,signInMethod:to.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return to.credentialFromTaggedObject(e)}static credentialFromError(e){return to.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return to.credential(e.oauthAccessToken)}catch{return null}}}to.GITHUB_SIGN_IN_METHOD="github.com";to.PROVIDER_ID="github.com";class so extends Vu{constructor(){super("twitter.com")}static credential(e,t){return Zo._fromParams({providerId:so.PROVIDER_ID,signInMethod:so.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return so.credentialFromTaggedObject(e)}static credentialFromError(e){return so.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return so.credential(t,i)}catch{return null}}}so.TWITTER_SIGN_IN_METHOD="twitter.com";so.PROVIDER_ID="twitter.com";async function KC(n,e){return Bu(n,"POST","/v1/accounts:signUp",Ei(n,e))}class el{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,l=!1){const u=await Ea._fromIdTokenResponse(e,i,l),d=ax(i);return new el({user:u,providerId:d,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const l=ax(i);return new el({user:e,providerId:l,_tokenResponse:i,operationType:t})}}function ax(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Lh extends Qa{constructor(e,t,i,l){super(t.code,t.message),this.operationType=i,this.user=l,Object.setPrototypeOf(this,Lh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,l){return new Lh(e,t,i,l)}}function Bw(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(u=>{throw u.code==="auth/multi-factor-auth-required"?Lh._fromErrorAndOperation(n,u,e,i):u})}async function YC(n,e,t=!1){const i=await _u(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return el._forOperation(n,"link",i)}async function QC(n,e,t=!1){const{auth:i}=n;if(Zr(i.app))return Promise.reject(vi(i));const l="reauthenticate";try{const u=await _u(n,Bw(i,l,e,n),t);Wt(u.idToken,i,"internal-error");const d=Jg(u.idToken);Wt(d,i,"internal-error");const{sub:p}=d;return Wt(n.uid===p,i,"user-mismatch"),el._forOperation(n,l,u)}catch(u){throw u?.code==="auth/user-not-found"&&Sa(i,"user-mismatch"),u}}async function Vw(n,e,t=!1){if(Zr(n.app))return Promise.reject(vi(n));const i="signIn",l=await Bw(n,i,e),u=await el._fromIdTokenResponse(n,i,l);return t||await n._updateCurrentUser(u.user),u}async function XC(n,e){return Vw(vo(n),e)}async function Uw(n){const e=vo(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function JC(n,e,t){const i=vo(n);await Ph(i,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",zC)}async function ZC(n,e,t){if(Zr(n.app))return Promise.reject(vi(n));const i=vo(n),d=await Ph(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",KC).catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&Uw(n),g}),p=await el._fromIdTokenResponse(i,"signIn",d);return await i._updateCurrentUser(p.user),p}function e4(n,e,t){return Zr(n.app)?Promise.reject(vi(n)):XC(sn(n),cc.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&Uw(n),i})}async function yP(n,e){const t=sn(n),l={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()},{email:u}=await FC(t.auth,l);u!==n.email&&await n.reload()}function ix(n,e){return sn(n).setPersistence(e)}function t4(n,e,t,i){return sn(n).onIdTokenChanged(e,t,i)}function s4(n,e,t){return sn(n).beforeAuthStateChanged(e,t)}function n4(n,e,t,i){return sn(n).onAuthStateChanged(e,t,i)}function r4(n){return sn(n).signOut()}const Oh="__sak";class Fw{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Oh,"1"),this.storage.removeItem(Oh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const a4=1e3,i4=10;class zw extends Fw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Aw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),l=this.localCache[t];i!==l&&e(t,l,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,p,g)=>{this.notifyListeners(d,g)});return}const i=e.key;t?this.detachListener():this.stopPolling();const l=()=>{const d=this.storage.getItem(i);!t&&this.localCache[i]===d||this.notifyListeners(i,d)},u=this.storage.getItem(i);xC()&&u!==e.newValue&&e.newValue!==e.oldValue?setTimeout(l,i4):l()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},a4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}zw.type="LOCAL";const fg=zw;class qw extends Fw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}qw.type="SESSION";const sy=qw;function o4(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class rm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(l=>l.isListeningto(e));if(t)return t;const i=new rm(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:l,data:u}=t.data,d=this.handlersMap[l];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:l});const p=Array.from(d).map(async y=>y(t.origin,u)),g=await o4(p);t.ports[0].postMessage({status:"done",eventId:i,eventType:l,response:g})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}rm.receivers=[];function ny(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class l4{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const l=typeof MessageChannel<"u"?new MessageChannel:null;if(!l)throw new Error("connection_unavailable");let u,d;return new Promise((p,g)=>{const y=ny("",20);l.port1.start();const x=setTimeout(()=>{g(new Error("unsupported_event"))},i);d={messageChannel:l,onMessage(_){const j=_;if(j.data.eventId===y)switch(j.data.status){case"ack":clearTimeout(x),u=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),p(j.data.response);break;default:clearTimeout(x),clearTimeout(u),g(new Error("invalid_response"));break}}},this.handlers.add(d),l.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:y,data:t},[l.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}function Ha(){return window}function c4(n){Ha().location.href=n}function Hw(){return typeof Ha().WorkerGlobalScope<"u"&&typeof Ha().importScripts=="function"}async function u4(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function d4(){return navigator?.serviceWorker?.controller||null}function h4(){return Hw()?self:null}const $w="firebaseLocalStorageDb",m4=1,Bh="firebaseLocalStorage",Ww="fbase_key";class Uu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function am(n,e){return n.transaction([Bh],e?"readwrite":"readonly").objectStore(Bh)}function f4(){const n=indexedDB.deleteDatabase($w);return new Uu(n).toPromise()}function pg(){const n=indexedDB.open($w,m4);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Bh,{keyPath:Ww})}catch(l){t(l)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Bh)?e(i):(i.close(),await f4(),e(await pg()))})})}async function ox(n,e,t){const i=am(n,!0).put({[Ww]:e,value:t});return new Uu(i).toPromise()}async function p4(n,e){const t=am(n,!1).get(e),i=await new Uu(t).toPromise();return i===void 0?null:i.value}function lx(n,e){const t=am(n,!0).delete(e);return new Uu(t).toPromise()}const g4=800,y4=3;class Gw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await pg(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>y4)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Hw()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=rm._getInstance(h4()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await u4(),!this.activeServiceWorker)return;this.sender=new l4(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||d4()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await pg();return await ox(e,Oh,"1"),await lx(e,Oh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>ox(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>p4(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>lx(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(l=>{const u=am(l,!1).getAll();return new Uu(u).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:l,value:u}of e)i.add(l),JSON.stringify(this.localCache[l])!==JSON.stringify(u)&&(this.notifyListeners(l,u),t.push(l));for(const l of Object.keys(this.localCache))this.localCache[l]&&!i.has(l)&&(this.notifyListeners(l,null),t.push(l));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),g4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Gw.type="LOCAL";const b4=Gw;new Ou(3e4,6e4);function v4(n,e){return e?pi(e):(Wt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class ry extends ey{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Xl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Xl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Xl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function x4(n){return Vw(n.auth,new ry(n),n.bypassAuthState)}function w4(n){const{auth:e,user:t}=n;return Wt(t,e,"internal-error"),QC(t,new ry(n),n.bypassAuthState)}async function _4(n){const{auth:e,user:t}=n;return Wt(t,e,"internal-error"),YC(t,new ry(n),n.bypassAuthState)}class Kw{constructor(e,t,i,l,u=!1){this.auth=e,this.resolver=i,this.user=l,this.bypassAuthState=u,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:l,tenantId:u,error:d,type:p}=e;if(d){this.reject(d);return}const g={auth:this.auth,requestUri:t,sessionId:i,tenantId:u||void 0,postBody:l||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(p)(g))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return x4;case"linkViaPopup":case"linkViaRedirect":return _4;case"reauthViaPopup":case"reauthViaRedirect":return w4;default:Sa(this.auth,"internal-error")}}resolve(e){ki(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ki(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const k4=new Ou(2e3,1e4);class Kl extends Kw{constructor(e,t,i,l,u){super(e,t,l,u),this.provider=i,this.authWindow=null,this.pollId=null,Kl.currentPopupAction&&Kl.currentPopupAction.cancel(),Kl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Wt(e,this.auth,"internal-error"),e}async onExecution(){ki(this.filter.length===1,"Popup operations only handle one event");const e=ny();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(qa(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(qa(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Kl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(qa(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,k4.get())};e()}}Kl.currentPopupAction=null;const j4="pendingRedirect",xh=new Map;class T4 extends Kw{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=xh.get(this.auth._key());if(!e){try{const i=await E4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}xh.set(this.auth._key(),e)}return this.bypassAuthState||xh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function E4(n,e){const t=C4(e),i=S4(n);if(!await i._isAvailable())return!1;const l=await i._get(t)==="true";return await i._remove(t),l}function N4(n,e){xh.set(n._key(),e)}function S4(n){return pi(n._redirectPersistence)}function C4(n){return vh(j4,n.config.apiKey,n.name)}async function R4(n,e,t=!1){if(Zr(n.app))return Promise.reject(vi(n));const i=vo(n),l=v4(i,e),d=await new T4(i,l,t).execute();return d&&!t&&(delete d.user._redirectEventId,await i._persistUserIfCurrent(d.user),await i._setRedirectUser(null,e)),d}const A4=600*1e3;class I4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!M4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Yw(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(qa(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=A4&&this.cachedEventUids.clear(),this.cachedEventUids.has(cx(e))}saveEventToCache(e){this.cachedEventUids.add(cx(e)),this.lastProcessedEventTime=Date.now()}}function cx(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Yw({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function M4(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Yw(n);default:return!1}}async function D4(n,e={}){return Ni(n,"GET","/v1/projects",e)}const P4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,L4=/^https?/;async function O4(n){if(n.config.emulator)return;const{authorizedDomains:e}=await D4(n);for(const t of e)try{if(B4(t))return}catch{}Sa(n,"unauthorized-domain")}function B4(n){const e=hg(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===i}if(!L4.test(t))return!1;if(P4.test(n))return i===n;const l=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+l+"|"+l+")$","i").test(i)}const V4=new Ou(3e4,6e4);function ux(){const n=Ha().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function U4(n){return new Promise((e,t)=>{function i(){ux(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ux(),t(qa(n,"network-request-failed"))},timeout:V4.get()})}if(Ha().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ha().gapi?.load)i();else{const l=CC("iframefcb");return Ha()[l]=()=>{gapi.load?i():t(qa(n,"network-request-failed"))},Mw(`${SC()}?onload=${l}`).catch(u=>t(u))}}).catch(e=>{throw wh=null,e})}let wh=null;function F4(n){return wh=wh||U4(n),wh}const z4=new Ou(5e3,15e3),q4="__/auth/iframe",H4="emulator/auth/iframe",$4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},W4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function G4(n){const e=n.config;Wt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Xg(e,H4):`https://${n.config.authDomain}/${q4}`,i={apiKey:e.apiKey,appName:n.name,v:al},l=W4.get(n.config.apiHost);l&&(i.eid=l);const u=n._getFrameworks();return u.length&&(i.fw=u.join(",")),`${t}?${Lu(i).slice(1)}`}async function K4(n){const e=await F4(n),t=Ha().gapi;return Wt(t,n,"internal-error"),e.open({where:document.body,url:G4(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:$4,dontclear:!0},i=>new Promise(async(l,u)=>{await i.restyle({setHideOnLeave:!1});const d=qa(n,"network-request-failed"),p=Ha().setTimeout(()=>{u(d)},z4.get());function g(){Ha().clearTimeout(p),l(i)}i.ping(g).then(g,()=>{u(d)})}))}const Y4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Q4=500,X4=600,J4="_blank",Z4="http://localhost";class dx{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function eR(n,e,t,i=Q4,l=X4){const u=Math.max((window.screen.availHeight-l)/2,0).toString(),d=Math.max((window.screen.availWidth-i)/2,0).toString();let p="";const g={...Y4,width:i.toString(),height:l.toString(),top:u,left:d},y=xr().toLowerCase();t&&(p=Ew(y)?J4:t),jw(y)&&(e=e||Z4,g.scrollbars="yes");const x=Object.entries(g).reduce((j,[O,$])=>`${j}${O}=${$},`,"");if(vC(y)&&p!=="_self")return tR(e||"",p),new dx(null);const _=window.open(e||"",p,x);Wt(_,n,"popup-blocked");try{_.focus()}catch{}return new dx(_)}function tR(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const sR="__/auth/handler",nR="emulator/auth/handler",rR=encodeURIComponent("fac");async function hx(n,e,t,i,l,u){Wt(n.config.authDomain,n,"auth-domain-config-required"),Wt(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:al,eventId:l};if(e instanceof Ow){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",FN(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[x,_]of Object.entries({}))d[x]=_}if(e instanceof Vu){const x=e.getScopes().filter(_=>_!=="");x.length>0&&(d.scopes=x.join(","))}n.tenantId&&(d.tid=n.tenantId);const p=d;for(const x of Object.keys(p))p[x]===void 0&&delete p[x];const g=await n._getAppCheckToken(),y=g?`#${rR}=${encodeURIComponent(g)}`:"";return`${aR(n)}?${Lu(p).slice(1)}${y}`}function aR({config:n}){return n.emulator?Xg(n,nR):`https://${n.authDomain}/${sR}`}const Pp="webStorageSupport";class iR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=sy,this._completeRedirectFn=R4,this._overrideRedirectResult=N4}async _openPopup(e,t,i,l){ki(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const u=await hx(e,t,i,hg(),l);return eR(e,u,ny())}async _openRedirect(e,t,i,l){await this._originValidation(e);const u=await hx(e,t,i,hg(),l);return c4(u),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:l,promise:u}=this.eventManagers[t];return l?Promise.resolve(l):(ki(u,"If manager is not set, promise should be"),u)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await K4(e),i=new I4(e);return t.register("authEvent",l=>(Wt(l?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(l.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Pp,{type:Pp},l=>{const u=l?.[0]?.[Pp];u!==void 0&&t(!!u),Sa(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=O4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Aw()||Tw()||Zg()}}const oR=iR;var mx="@firebase/auth",fx="1.12.0";class lR{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Wt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function cR(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function uR(n){Jo(new uo("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),l=e.getProvider("heartbeat"),u=e.getProvider("app-check-internal"),{apiKey:d,authDomain:p}=i.options;Wt(d&&!d.includes(":"),"invalid-api-key",{appName:i.name});const g={apiKey:d,authDomain:p,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Iw(n)},y=new TC(i,l,u,g);return PC(y,t),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),Jo(new uo("auth-internal",e=>{const t=vo(e.getProvider("auth").getImmediate());return(i=>new lR(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),za(mx,fx,cR(n)),za(mx,fx,"esm2020")}const dR=300,hR=uw("authIdTokenMaxAge")||dR;let px=null;const mR=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>hR)return;const l=t?.token;px!==l&&(px=l,await fetch(n,{method:l?"POST":"DELETE",headers:l?{Authorization:`Bearer ${l}`}:{}}))};function Qw(n=Yg()){const e=sm(n,"auth");if(e.isInitialized())return e.getImmediate();const t=DC(n,{popupRedirectResolver:oR,persistence:[b4,fg,sy]}),i=uw("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const u=new URL(i,location.origin);if(location.origin===u.origin){const d=mR(u.toString());s4(t,d,()=>d(t.currentUser)),t4(t,p=>d(p))}}const l=ow("auth");return l&&LC(t,`http://${l}`),t}function fR(){return document.getElementsByTagName("head")?.[0]??document}EC({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=l=>{const u=qa("internal-error");u.customData=l,t(u)},i.type="text/javascript",i.charset="UTF-8",fR().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});uR("Browser");var gx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var oo,Xw;(function(){var n;function e(R,T){function S(){}S.prototype=T.prototype,R.F=T.prototype,R.prototype=new S,R.prototype.constructor=R,R.D=function(D,I,U){for(var M=Array(arguments.length-2),ze=2;ze<arguments.length;ze++)M[ze-2]=arguments[ze];return T.prototype[I].apply(D,M)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function l(R,T,S){S||(S=0);const D=Array(16);if(typeof T=="string")for(var I=0;I<16;++I)D[I]=T.charCodeAt(S++)|T.charCodeAt(S++)<<8|T.charCodeAt(S++)<<16|T.charCodeAt(S++)<<24;else for(I=0;I<16;++I)D[I]=T[S++]|T[S++]<<8|T[S++]<<16|T[S++]<<24;T=R.g[0],S=R.g[1],I=R.g[2];let U=R.g[3],M;M=T+(U^S&(I^U))+D[0]+3614090360&4294967295,T=S+(M<<7&4294967295|M>>>25),M=U+(I^T&(S^I))+D[1]+3905402710&4294967295,U=T+(M<<12&4294967295|M>>>20),M=I+(S^U&(T^S))+D[2]+606105819&4294967295,I=U+(M<<17&4294967295|M>>>15),M=S+(T^I&(U^T))+D[3]+3250441966&4294967295,S=I+(M<<22&4294967295|M>>>10),M=T+(U^S&(I^U))+D[4]+4118548399&4294967295,T=S+(M<<7&4294967295|M>>>25),M=U+(I^T&(S^I))+D[5]+1200080426&4294967295,U=T+(M<<12&4294967295|M>>>20),M=I+(S^U&(T^S))+D[6]+2821735955&4294967295,I=U+(M<<17&4294967295|M>>>15),M=S+(T^I&(U^T))+D[7]+4249261313&4294967295,S=I+(M<<22&4294967295|M>>>10),M=T+(U^S&(I^U))+D[8]+1770035416&4294967295,T=S+(M<<7&4294967295|M>>>25),M=U+(I^T&(S^I))+D[9]+2336552879&4294967295,U=T+(M<<12&4294967295|M>>>20),M=I+(S^U&(T^S))+D[10]+4294925233&4294967295,I=U+(M<<17&4294967295|M>>>15),M=S+(T^I&(U^T))+D[11]+2304563134&4294967295,S=I+(M<<22&4294967295|M>>>10),M=T+(U^S&(I^U))+D[12]+1804603682&4294967295,T=S+(M<<7&4294967295|M>>>25),M=U+(I^T&(S^I))+D[13]+4254626195&4294967295,U=T+(M<<12&4294967295|M>>>20),M=I+(S^U&(T^S))+D[14]+2792965006&4294967295,I=U+(M<<17&4294967295|M>>>15),M=S+(T^I&(U^T))+D[15]+1236535329&4294967295,S=I+(M<<22&4294967295|M>>>10),M=T+(I^U&(S^I))+D[1]+4129170786&4294967295,T=S+(M<<5&4294967295|M>>>27),M=U+(S^I&(T^S))+D[6]+3225465664&4294967295,U=T+(M<<9&4294967295|M>>>23),M=I+(T^S&(U^T))+D[11]+643717713&4294967295,I=U+(M<<14&4294967295|M>>>18),M=S+(U^T&(I^U))+D[0]+3921069994&4294967295,S=I+(M<<20&4294967295|M>>>12),M=T+(I^U&(S^I))+D[5]+3593408605&4294967295,T=S+(M<<5&4294967295|M>>>27),M=U+(S^I&(T^S))+D[10]+38016083&4294967295,U=T+(M<<9&4294967295|M>>>23),M=I+(T^S&(U^T))+D[15]+3634488961&4294967295,I=U+(M<<14&4294967295|M>>>18),M=S+(U^T&(I^U))+D[4]+3889429448&4294967295,S=I+(M<<20&4294967295|M>>>12),M=T+(I^U&(S^I))+D[9]+568446438&4294967295,T=S+(M<<5&4294967295|M>>>27),M=U+(S^I&(T^S))+D[14]+3275163606&4294967295,U=T+(M<<9&4294967295|M>>>23),M=I+(T^S&(U^T))+D[3]+4107603335&4294967295,I=U+(M<<14&4294967295|M>>>18),M=S+(U^T&(I^U))+D[8]+1163531501&4294967295,S=I+(M<<20&4294967295|M>>>12),M=T+(I^U&(S^I))+D[13]+2850285829&4294967295,T=S+(M<<5&4294967295|M>>>27),M=U+(S^I&(T^S))+D[2]+4243563512&4294967295,U=T+(M<<9&4294967295|M>>>23),M=I+(T^S&(U^T))+D[7]+1735328473&4294967295,I=U+(M<<14&4294967295|M>>>18),M=S+(U^T&(I^U))+D[12]+2368359562&4294967295,S=I+(M<<20&4294967295|M>>>12),M=T+(S^I^U)+D[5]+4294588738&4294967295,T=S+(M<<4&4294967295|M>>>28),M=U+(T^S^I)+D[8]+2272392833&4294967295,U=T+(M<<11&4294967295|M>>>21),M=I+(U^T^S)+D[11]+1839030562&4294967295,I=U+(M<<16&4294967295|M>>>16),M=S+(I^U^T)+D[14]+4259657740&4294967295,S=I+(M<<23&4294967295|M>>>9),M=T+(S^I^U)+D[1]+2763975236&4294967295,T=S+(M<<4&4294967295|M>>>28),M=U+(T^S^I)+D[4]+1272893353&4294967295,U=T+(M<<11&4294967295|M>>>21),M=I+(U^T^S)+D[7]+4139469664&4294967295,I=U+(M<<16&4294967295|M>>>16),M=S+(I^U^T)+D[10]+3200236656&4294967295,S=I+(M<<23&4294967295|M>>>9),M=T+(S^I^U)+D[13]+681279174&4294967295,T=S+(M<<4&4294967295|M>>>28),M=U+(T^S^I)+D[0]+3936430074&4294967295,U=T+(M<<11&4294967295|M>>>21),M=I+(U^T^S)+D[3]+3572445317&4294967295,I=U+(M<<16&4294967295|M>>>16),M=S+(I^U^T)+D[6]+76029189&4294967295,S=I+(M<<23&4294967295|M>>>9),M=T+(S^I^U)+D[9]+3654602809&4294967295,T=S+(M<<4&4294967295|M>>>28),M=U+(T^S^I)+D[12]+3873151461&4294967295,U=T+(M<<11&4294967295|M>>>21),M=I+(U^T^S)+D[15]+530742520&4294967295,I=U+(M<<16&4294967295|M>>>16),M=S+(I^U^T)+D[2]+3299628645&4294967295,S=I+(M<<23&4294967295|M>>>9),M=T+(I^(S|~U))+D[0]+4096336452&4294967295,T=S+(M<<6&4294967295|M>>>26),M=U+(S^(T|~I))+D[7]+1126891415&4294967295,U=T+(M<<10&4294967295|M>>>22),M=I+(T^(U|~S))+D[14]+2878612391&4294967295,I=U+(M<<15&4294967295|M>>>17),M=S+(U^(I|~T))+D[5]+4237533241&4294967295,S=I+(M<<21&4294967295|M>>>11),M=T+(I^(S|~U))+D[12]+1700485571&4294967295,T=S+(M<<6&4294967295|M>>>26),M=U+(S^(T|~I))+D[3]+2399980690&4294967295,U=T+(M<<10&4294967295|M>>>22),M=I+(T^(U|~S))+D[10]+4293915773&4294967295,I=U+(M<<15&4294967295|M>>>17),M=S+(U^(I|~T))+D[1]+2240044497&4294967295,S=I+(M<<21&4294967295|M>>>11),M=T+(I^(S|~U))+D[8]+1873313359&4294967295,T=S+(M<<6&4294967295|M>>>26),M=U+(S^(T|~I))+D[15]+4264355552&4294967295,U=T+(M<<10&4294967295|M>>>22),M=I+(T^(U|~S))+D[6]+2734768916&4294967295,I=U+(M<<15&4294967295|M>>>17),M=S+(U^(I|~T))+D[13]+1309151649&4294967295,S=I+(M<<21&4294967295|M>>>11),M=T+(I^(S|~U))+D[4]+4149444226&4294967295,T=S+(M<<6&4294967295|M>>>26),M=U+(S^(T|~I))+D[11]+3174756917&4294967295,U=T+(M<<10&4294967295|M>>>22),M=I+(T^(U|~S))+D[2]+718787259&4294967295,I=U+(M<<15&4294967295|M>>>17),M=S+(U^(I|~T))+D[9]+3951481745&4294967295,R.g[0]=R.g[0]+T&4294967295,R.g[1]=R.g[1]+(I+(M<<21&4294967295|M>>>11))&4294967295,R.g[2]=R.g[2]+I&4294967295,R.g[3]=R.g[3]+U&4294967295}i.prototype.v=function(R,T){T===void 0&&(T=R.length);const S=T-this.blockSize,D=this.C;let I=this.h,U=0;for(;U<T;){if(I==0)for(;U<=S;)l(this,R,U),U+=this.blockSize;if(typeof R=="string"){for(;U<T;)if(D[I++]=R.charCodeAt(U++),I==this.blockSize){l(this,D),I=0;break}}else for(;U<T;)if(D[I++]=R[U++],I==this.blockSize){l(this,D),I=0;break}}this.h=I,this.o+=T},i.prototype.A=function(){var R=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);R[0]=128;for(var T=1;T<R.length-8;++T)R[T]=0;T=this.o*8;for(var S=R.length-8;S<R.length;++S)R[S]=T&255,T/=256;for(this.v(R),R=Array(16),T=0,S=0;S<4;++S)for(let D=0;D<32;D+=8)R[T++]=this.g[S]>>>D&255;return R};function u(R,T){var S=p;return Object.prototype.hasOwnProperty.call(S,R)?S[R]:S[R]=T(R)}function d(R,T){this.h=T;const S=[];let D=!0;for(let I=R.length-1;I>=0;I--){const U=R[I]|0;D&&U==T||(S[I]=U,D=!1)}this.g=S}var p={};function g(R){return-128<=R&&R<128?u(R,function(T){return new d([T|0],T<0?-1:0)}):new d([R|0],R<0?-1:0)}function y(R){if(isNaN(R)||!isFinite(R))return _;if(R<0)return L(y(-R));const T=[];let S=1;for(let D=0;R>=S;D++)T[D]=R/S|0,S*=4294967296;return new d(T,0)}function x(R,T){if(R.length==0)throw Error("number format error: empty string");if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(R.charAt(0)=="-")return L(x(R.substring(1),T));if(R.indexOf("-")>=0)throw Error('number format error: interior "-" character');const S=y(Math.pow(T,8));let D=_;for(let U=0;U<R.length;U+=8){var I=Math.min(8,R.length-U);const M=parseInt(R.substring(U,U+I),T);I<8?(I=y(Math.pow(T,I)),D=D.j(I).add(y(M))):(D=D.j(S),D=D.add(y(M)))}return D}var _=g(0),j=g(1),O=g(16777216);n=d.prototype,n.m=function(){if(V(this))return-L(this).m();let R=0,T=1;for(let S=0;S<this.g.length;S++){const D=this.i(S);R+=(D>=0?D:4294967296+D)*T,T*=4294967296}return R},n.toString=function(R){if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if($(this))return"0";if(V(this))return"-"+L(this).toString(R);const T=y(Math.pow(R,6));var S=this;let D="";for(;;){const I=ke(S,T).g;S=ee(S,I.j(T));let U=((S.g.length>0?S.g[0]:S.h)>>>0).toString(R);if(S=I,$(S))return U+D;for(;U.length<6;)U="0"+U;D=U+D}},n.i=function(R){return R<0?0:R<this.g.length?this.g[R]:this.h};function $(R){if(R.h!=0)return!1;for(let T=0;T<R.g.length;T++)if(R.g[T]!=0)return!1;return!0}function V(R){return R.h==-1}n.l=function(R){return R=ee(this,R),V(R)?-1:$(R)?0:1};function L(R){const T=R.g.length,S=[];for(let D=0;D<T;D++)S[D]=~R.g[D];return new d(S,~R.h).add(j)}n.abs=function(){return V(this)?L(this):this},n.add=function(R){const T=Math.max(this.g.length,R.g.length),S=[];let D=0;for(let I=0;I<=T;I++){let U=D+(this.i(I)&65535)+(R.i(I)&65535),M=(U>>>16)+(this.i(I)>>>16)+(R.i(I)>>>16);D=M>>>16,U&=65535,M&=65535,S[I]=M<<16|U}return new d(S,S[S.length-1]&-2147483648?-1:0)};function ee(R,T){return R.add(L(T))}n.j=function(R){if($(this)||$(R))return _;if(V(this))return V(R)?L(this).j(L(R)):L(L(this).j(R));if(V(R))return L(this.j(L(R)));if(this.l(O)<0&&R.l(O)<0)return y(this.m()*R.m());const T=this.g.length+R.g.length,S=[];for(var D=0;D<2*T;D++)S[D]=0;for(D=0;D<this.g.length;D++)for(let I=0;I<R.g.length;I++){const U=this.i(D)>>>16,M=this.i(D)&65535,ze=R.i(I)>>>16,gt=R.i(I)&65535;S[2*D+2*I]+=M*gt,Y(S,2*D+2*I),S[2*D+2*I+1]+=U*gt,Y(S,2*D+2*I+1),S[2*D+2*I+1]+=M*ze,Y(S,2*D+2*I+1),S[2*D+2*I+2]+=U*ze,Y(S,2*D+2*I+2)}for(R=0;R<T;R++)S[R]=S[2*R+1]<<16|S[2*R];for(R=T;R<2*T;R++)S[R]=0;return new d(S,0)};function Y(R,T){for(;(R[T]&65535)!=R[T];)R[T+1]+=R[T]>>>16,R[T]&=65535,T++}function te(R,T){this.g=R,this.h=T}function ke(R,T){if($(T))throw Error("division by zero");if($(R))return new te(_,_);if(V(R))return T=ke(L(R),T),new te(L(T.g),L(T.h));if(V(T))return T=ke(R,L(T)),new te(L(T.g),T.h);if(R.g.length>30){if(V(R)||V(T))throw Error("slowDivide_ only works with positive integers.");for(var S=j,D=T;D.l(R)<=0;)S=Te(S),D=Te(D);var I=xe(S,1),U=xe(D,1);for(D=xe(D,2),S=xe(S,2);!$(D);){var M=U.add(D);M.l(R)<=0&&(I=I.add(S),U=M),D=xe(D,1),S=xe(S,1)}return T=ee(R,I.j(T)),new te(I,T)}for(I=_;R.l(T)>=0;){for(S=Math.max(1,Math.floor(R.m()/T.m())),D=Math.ceil(Math.log(S)/Math.LN2),D=D<=48?1:Math.pow(2,D-48),U=y(S),M=U.j(T);V(M)||M.l(R)>0;)S-=D,U=y(S),M=U.j(T);$(U)&&(U=j),I=I.add(U),R=ee(R,M)}return new te(I,R)}n.B=function(R){return ke(this,R).h},n.and=function(R){const T=Math.max(this.g.length,R.g.length),S=[];for(let D=0;D<T;D++)S[D]=this.i(D)&R.i(D);return new d(S,this.h&R.h)},n.or=function(R){const T=Math.max(this.g.length,R.g.length),S=[];for(let D=0;D<T;D++)S[D]=this.i(D)|R.i(D);return new d(S,this.h|R.h)},n.xor=function(R){const T=Math.max(this.g.length,R.g.length),S=[];for(let D=0;D<T;D++)S[D]=this.i(D)^R.i(D);return new d(S,this.h^R.h)};function Te(R){const T=R.g.length+1,S=[];for(let D=0;D<T;D++)S[D]=R.i(D)<<1|R.i(D-1)>>>31;return new d(S,R.h)}function xe(R,T){const S=T>>5;T%=32;const D=R.g.length-S,I=[];for(let U=0;U<D;U++)I[U]=T>0?R.i(U+S)>>>T|R.i(U+S+1)<<32-T:R.i(U+S);return new d(I,R.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,Xw=i,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.B,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=y,d.fromString=x,oo=d}).apply(typeof gx<"u"?gx:typeof self<"u"?self:typeof window<"u"?window:{});var nh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Jw,cu,Zw,_h,gg,e_,t_,s_;(function(){var n,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof nh=="object"&&nh];for(var v=0;v<h.length;++v){var k=h[v];if(k&&k.Math==Math)return k}throw Error("Cannot find global object")}var i=t(this);function l(h,v){if(v)e:{var k=i;h=h.split(".");for(var A=0;A<h.length-1;A++){var le=h[A];if(!(le in k))break e;k=k[le]}h=h[h.length-1],A=k[h],v=v(A),v!=A&&v!=null&&e(k,h,{configurable:!0,writable:!0,value:v})}}l("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),l("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),l("Object.entries",function(h){return h||function(v){var k=[],A;for(A in v)Object.prototype.hasOwnProperty.call(v,A)&&k.push([A,v[A]]);return k}});var u=u||{},d=this||self;function p(h){var v=typeof h;return v=="object"&&h!=null||v=="function"}function g(h,v,k){return h.call.apply(h.bind,arguments)}function y(h,v,k){return y=g,y.apply(null,arguments)}function x(h,v){var k=Array.prototype.slice.call(arguments,1);return function(){var A=k.slice();return A.push.apply(A,arguments),h.apply(this,A)}}function _(h,v){function k(){}k.prototype=v.prototype,h.Z=v.prototype,h.prototype=new k,h.prototype.constructor=h,h.Ob=function(A,le,be){for(var nt=Array(arguments.length-2),ls=2;ls<arguments.length;ls++)nt[ls-2]=arguments[ls];return v.prototype[le].apply(A,nt)}}var j=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function O(h){const v=h.length;if(v>0){const k=Array(v);for(let A=0;A<v;A++)k[A]=h[A];return k}return[]}function $(h,v){for(let A=1;A<arguments.length;A++){const le=arguments[A];var k=typeof le;if(k=k!="object"?k:le?Array.isArray(le)?"array":k:"null",k=="array"||k=="object"&&typeof le.length=="number"){k=h.length||0;const be=le.length||0;h.length=k+be;for(let nt=0;nt<be;nt++)h[k+nt]=le[nt]}else h.push(le)}}class V{constructor(v,k){this.i=v,this.j=k,this.h=0,this.g=null}get(){let v;return this.h>0?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function L(h){d.setTimeout(()=>{throw h},0)}function ee(){var h=R;let v=null;return h.g&&(v=h.g,h.g=h.g.next,h.g||(h.h=null),v.next=null),v}class Y{constructor(){this.h=this.g=null}add(v,k){const A=te.get();A.set(v,k),this.h?this.h.next=A:this.g=A,this.h=A}}var te=new V(()=>new ke,h=>h.reset());class ke{constructor(){this.next=this.g=this.h=null}set(v,k){this.h=v,this.g=k,this.next=null}reset(){this.next=this.g=this.h=null}}let Te,xe=!1,R=new Y,T=()=>{const h=Promise.resolve(void 0);Te=()=>{h.then(S)}};function S(){for(var h;h=ee();){try{h.h.call(h.g)}catch(k){L(k)}var v=te;v.j(h),v.h<100&&(v.h++,h.next=v.g,v.g=h)}xe=!1}function D(){this.u=this.u,this.C=this.C}D.prototype.u=!1,D.prototype.dispose=function(){this.u||(this.u=!0,this.N())},D.prototype[Symbol.dispose]=function(){this.dispose()},D.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function I(h,v){this.type=h,this.g=this.target=v,this.defaultPrevented=!1}I.prototype.h=function(){this.defaultPrevented=!0};var U=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var h=!1,v=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const k=()=>{};d.addEventListener("test",k,v),d.removeEventListener("test",k,v)}catch{}return h})();function M(h){return/^[\s\xa0]*$/.test(h)}function ze(h,v){I.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,v)}_(ze,I),ze.prototype.init=function(h,v){const k=this.type=h.type,A=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=v,v=h.relatedTarget,v||(k=="mouseover"?v=h.fromElement:k=="mouseout"&&(v=h.toElement)),this.relatedTarget=v,A?(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&ze.Z.h.call(this)},ze.prototype.h=function(){ze.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var gt="closure_listenable_"+(Math.random()*1e6|0),B=0;function se(h,v,k,A,le){this.listener=h,this.proxy=null,this.src=v,this.type=k,this.capture=!!A,this.ha=le,this.key=++B,this.da=this.fa=!1}function ge(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Re(h,v,k){for(const A in h)v.call(k,h[A],A,h)}function Q(h,v){for(const k in h)v.call(void 0,h[k],k,h)}function P(h){const v={};for(const k in h)v[k]=h[k];return v}const ae="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Be(h,v){let k,A;for(let le=1;le<arguments.length;le++){A=arguments[le];for(k in A)h[k]=A[k];for(let be=0;be<ae.length;be++)k=ae[be],Object.prototype.hasOwnProperty.call(A,k)&&(h[k]=A[k])}}function Ue(h){this.src=h,this.g={},this.h=0}Ue.prototype.add=function(h,v,k,A,le){const be=h.toString();h=this.g[be],h||(h=this.g[be]=[],this.h++);const nt=Ie(h,v,A,le);return nt>-1?(v=h[nt],k||(v.fa=!1)):(v=new se(v,this.src,be,!!A,le),v.fa=k,h.push(v)),v};function Oe(h,v){const k=v.type;if(k in h.g){var A=h.g[k],le=Array.prototype.indexOf.call(A,v,void 0),be;(be=le>=0)&&Array.prototype.splice.call(A,le,1),be&&(ge(v),h.g[k].length==0&&(delete h.g[k],h.h--))}}function Ie(h,v,k,A){for(let le=0;le<h.length;++le){const be=h[le];if(!be.da&&be.listener==v&&be.capture==!!k&&be.ha==A)return le}return-1}var ot="closure_lm_"+(Math.random()*1e6|0),yt={};function et(h,v,k,A,le){if(Array.isArray(v)){for(let be=0;be<v.length;be++)et(h,v[be],k,A,le);return null}return k=Et(k),h&&h[gt]?h.J(v,k,p(A)?!!A.capture:!1,le):Xt(h,v,k,!1,A,le)}function Xt(h,v,k,A,le,be){if(!v)throw Error("Invalid event type");const nt=p(le)?!!le.capture:!!le;let ls=kt(h);if(ls||(h[ot]=ls=new Ue(h)),k=ls.add(v,k,A,nt,be),k.proxy)return k;if(A=Es(),k.proxy=A,A.src=h,A.listener=k,h.addEventListener)U||(le=nt),le===void 0&&(le=!1),h.addEventListener(v.toString(),A,le);else if(h.attachEvent)h.attachEvent(oe(v.toString()),A);else if(h.addListener&&h.removeListener)h.addListener(A);else throw Error("addEventListener and attachEvent are unavailable.");return k}function Es(){function h(k){return v.call(h.src,h.listener,k)}const v=Ct;return h}function Ot(h,v,k,A,le){if(Array.isArray(v))for(var be=0;be<v.length;be++)Ot(h,v[be],k,A,le);else A=p(A)?!!A.capture:!!A,k=Et(k),h&&h[gt]?(h=h.i,be=String(v).toString(),be in h.g&&(v=h.g[be],k=Ie(v,k,A,le),k>-1&&(ge(v[k]),Array.prototype.splice.call(v,k,1),v.length==0&&(delete h.g[be],h.h--)))):h&&(h=kt(h))&&(v=h.g[v.toString()],h=-1,v&&(h=Ie(v,k,A,le)),(k=h>-1?v[h]:null)&&wt(k))}function wt(h){if(typeof h!="number"&&h&&!h.da){var v=h.src;if(v&&v[gt])Oe(v.i,h);else{var k=h.type,A=h.proxy;v.removeEventListener?v.removeEventListener(k,A,h.capture):v.detachEvent?v.detachEvent(oe(k),A):v.addListener&&v.removeListener&&v.removeListener(A),(k=kt(v))?(Oe(k,h),k.h==0&&(k.src=null,v[ot]=null)):ge(h)}}}function oe(h){return h in yt?yt[h]:yt[h]="on"+h}function Ct(h,v){if(h.da)h=!0;else{v=new ze(v,this);const k=h.listener,A=h.ha||h.src;h.fa&&wt(h),h=k.call(A,v)}return h}function kt(h){return h=h[ot],h instanceof Ue?h:null}var zt="__closure_events_fn_"+(Math.random()*1e9>>>0);function Et(h){return typeof h=="function"?h:(h[zt]||(h[zt]=function(v){return h.handleEvent(v)}),h[zt])}function jt(){D.call(this),this.i=new Ue(this),this.M=this,this.G=null}_(jt,D),jt.prototype[gt]=!0,jt.prototype.removeEventListener=function(h,v,k,A){Ot(this,h,v,k,A)};function tt(h,v){var k,A=h.G;if(A)for(k=[];A;A=A.G)k.push(A);if(h=h.M,A=v.type||v,typeof v=="string")v=new I(v,h);else if(v instanceof I)v.target=v.target||h;else{var le=v;v=new I(A,h),Be(v,le)}le=!0;let be,nt;if(k)for(nt=k.length-1;nt>=0;nt--)be=v.g=k[nt],le=Mt(be,A,!0,v)&&le;if(be=v.g=h,le=Mt(be,A,!0,v)&&le,le=Mt(be,A,!1,v)&&le,k)for(nt=0;nt<k.length;nt++)be=v.g=k[nt],le=Mt(be,A,!1,v)&&le}jt.prototype.N=function(){if(jt.Z.N.call(this),this.i){var h=this.i;for(const v in h.g){const k=h.g[v];for(let A=0;A<k.length;A++)ge(k[A]);delete h.g[v],h.h--}}this.G=null},jt.prototype.J=function(h,v,k,A){return this.i.add(String(h),v,!1,k,A)},jt.prototype.K=function(h,v,k,A){return this.i.add(String(h),v,!0,k,A)};function Mt(h,v,k,A){if(v=h.i.g[String(v)],!v)return!0;v=v.concat();let le=!0;for(let be=0;be<v.length;++be){const nt=v[be];if(nt&&!nt.da&&nt.capture==k){const ls=nt.listener,Cn=nt.ha||nt.src;nt.fa&&Oe(h.i,nt),le=ls.call(Cn,A)!==!1&&le}}return le&&!A.defaultPrevented}function qt(h,v){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=y(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(v)>2147483647?-1:d.setTimeout(h,v||0)}function ms(h){h.g=qt(()=>{h.g=null,h.i&&(h.i=!1,ms(h))},h.l);const v=h.h;h.h=null,h.m.apply(null,v)}class Ft extends D{constructor(v,k){super(),this.m=v,this.l=k,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:ms(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function At(h){D.call(this),this.h=h,this.g={}}_(At,D);var us=[];function vs(h){Re(h.g,function(v,k){this.g.hasOwnProperty(k)&&wt(v)},h),h.g={}}At.prototype.N=function(){At.Z.N.call(this),vs(this)},At.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var as=d.JSON.stringify,nn=d.JSON.parse,Ds=class{stringify(h){return d.JSON.stringify(h,void 0)}parse(h){return d.JSON.parse(h,void 0)}};function Hs(){}function is(){}var xs={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ye(){I.call(this,"d")}_(ye,I);function Me(){I.call(this,"c")}_(Me,I);var De={},Qe=null;function He(){return Qe=Qe||new jt}De.Ia="serverreachability";function Xe(h){I.call(this,De.Ia,h)}_(Xe,I);function ut(h){const v=He();tt(v,new Xe(v))}De.STAT_EVENT="statevent";function J(h,v){I.call(this,De.STAT_EVENT,h),this.stat=v}_(J,I);function ne(h){const v=He();tt(v,new J(v,h))}De.Ja="timingevent";function $e(h,v){I.call(this,De.Ja,h),this.size=v}_($e,I);function bt(h,v){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){h()},v)}function Ye(){this.g=!0}Ye.prototype.ua=function(){this.g=!1};function vt(h,v,k,A,le,be){h.info(function(){if(h.g)if(be){var nt="",ls=be.split("&");for(let zs=0;zs<ls.length;zs++){var Cn=ls[zs].split("=");if(Cn.length>1){const fn=Cn[0];Cn=Cn[1];const ra=fn.split("_");nt=ra.length>=2&&ra[1]=="type"?nt+(fn+"="+Cn+"&"):nt+(fn+"=redacted&")}}}else nt=null;else nt=be;return"XMLHTTP REQ ("+A+") [attempt "+le+"]: "+v+`
`+k+`
`+nt})}function X(h,v,k,A,le,be,nt){h.info(function(){return"XMLHTTP RESP ("+A+") [ attempt "+le+"]: "+v+`
`+k+`
`+be+" "+nt})}function Ae(h,v,k,A){h.info(function(){return"XMLHTTP TEXT ("+v+"): "+ht(h,k)+(A?" "+A:"")})}function Ge(h,v){h.info(function(){return"TIMEOUT: "+v})}Ye.prototype.info=function(){};function ht(h,v){if(!h.g)return v;if(!v)return null;try{const be=JSON.parse(v);if(be){for(h=0;h<be.length;h++)if(Array.isArray(be[h])){var k=be[h];if(!(k.length<2)){var A=k[1];if(Array.isArray(A)&&!(A.length<1)){var le=A[0];if(le!="noop"&&le!="stop"&&le!="close")for(let nt=1;nt<A.length;nt++)A[nt]=""}}}}return as(be)}catch{return v}}var Je={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Kt={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Ht;function F(){}_(F,Hs),F.prototype.g=function(){return new XMLHttpRequest},Ht=new F;function fe(h){return encodeURIComponent(String(h))}function Se(h){var v=1;h=h.split(":");const k=[];for(;v>0&&h.length;)k.push(h.shift()),v--;return h.length&&k.push(h.join(":")),k}function Ee(h,v,k,A){this.j=h,this.i=v,this.l=k,this.S=A||1,this.V=new At(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ne}function Ne(){this.i=null,this.g="",this.h=!1}var mt={},Nt={};function lt(h,v,k){h.M=1,h.A=Ar(ft(v)),h.u=k,h.R=!0,Bt(h,null)}function Bt(h,v){h.F=Date.now(),mn(h),h.B=ft(h.A);var k=h.B,A=h.S;Array.isArray(A)||(A=[String(A)]),xn(k.i,"t",A),h.C=0,k=h.j.L,h.h=new Ne,h.g=Lr(h.j,k?v:null,!h.u),h.P>0&&(h.O=new Ft(y(h.Y,h,h.g),h.P)),v=h.V,k=h.g,A=h.ba;var le="readystatechange";Array.isArray(le)||(le&&(us[0]=le.toString()),le=us);for(let be=0;be<le.length;be++){const nt=et(k,le[be],A||v.handleEvent,!1,v.h||v);if(!nt)break;v.g[nt.key]=nt}v=h.J?P(h.J):{},h.u?(h.v||(h.v="POST"),v["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,v)):(h.v="GET",h.g.ea(h.B,h.v,null,v)),ut(),vt(h.i,h.v,h.B,h.l,h.S,h.u)}Ee.prototype.ba=function(h){h=h.target;const v=this.O;v&&qe(h)==3?v.j():this.Y(h)},Ee.prototype.Y=function(h){try{if(h==this.g)e:{const ls=qe(this.g),Cn=this.g.ya(),zs=this.g.ca();if(!(ls<3)&&(ls!=3||this.g&&(this.h.h||this.g.la()||Ze(this.g)))){this.K||ls!=4||Cn==7||(Cn==8||zs<=0?ut(3):ut(2)),Ks(this);var v=this.g.ca();this.X=v;var k=Dt(this);if(this.o=v==200,X(this.i,this.v,this.B,this.l,this.S,ls,v),this.o){if(this.U&&!this.L){t:{if(this.g){var A,le=this.g;if((A=le.g?le.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(A)){var be=A;break t}}be=null}if(h=be)Ae(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,W(this,h);else{this.o=!1,this.m=3,ne(12),Ns(this),cn(this);break e}}if(this.R){h=!0;let fn;for(;!this.K&&this.C<k.length;)if(fn=vn(this,k),fn==Nt){ls==4&&(this.m=4,ne(14),h=!1),Ae(this.i,this.l,null,"[Incomplete Response]");break}else if(fn==mt){this.m=4,ne(15),Ae(this.i,this.l,k,"[Invalid Chunk]"),h=!1;break}else Ae(this.i,this.l,fn,null),W(this,fn);if(Xs(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ls!=4||k.length!=0||this.h.h||(this.m=1,ne(16),h=!1),this.o=this.o&&h,!h)Ae(this.i,this.l,k,"[Invalid Chunked Response]"),Ns(this),cn(this);else if(k.length>0&&!this.W){this.W=!0;var nt=this.j;nt.g==this&&nt.aa&&!nt.P&&(nt.j.info("Great, no buffering proxy detected. Bytes received: "+k.length),Qn(nt),nt.P=!0,ne(11))}}else Ae(this.i,this.l,k,null),W(this,k);ls==4&&Ns(this),this.o&&!this.K&&(ls==4?Dr(this.j,this):(this.o=!1,mn(this)))}else _t(this.g),v==400&&k.indexOf("Unknown SID")>0?(this.m=3,ne(12)):(this.m=0,ne(13)),Ns(this),cn(this)}}}catch{}};function Dt(h){if(!Xs(h))return h.g.la();const v=Ze(h.g);if(v==="")return"";let k="";const A=v.length,le=qe(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return Ns(h),cn(h),"";h.h.i=new d.TextDecoder}for(let be=0;be<A;be++)h.h.h=!0,k+=h.h.i.decode(v[be],{stream:!(le&&be==A-1)});return v.length=0,h.h.g+=k,h.C=0,h.h.g}function Xs(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function vn(h,v){var k=h.C,A=v.indexOf(`
`,k);return A==-1?Nt:(k=Number(v.substring(k,A)),isNaN(k)?mt:(A+=1,A+k>v.length?Nt:(v=v.slice(A,A+k),h.C=A+k,v)))}Ee.prototype.cancel=function(){this.K=!0,Ns(this)};function mn(h){h.T=Date.now()+h.H,Nn(h,h.H)}function Nn(h,v){if(h.D!=null)throw Error("WatchDog timer not null");h.D=bt(y(h.aa,h),v)}function Ks(h){h.D&&(d.clearTimeout(h.D),h.D=null)}Ee.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(Ge(this.i,this.B),this.M!=2&&(ut(),ne(17)),Ns(this),this.m=2,cn(this)):Nn(this,this.T-h)};function cn(h){h.j.I==0||h.K||Dr(h.j,h)}function Ns(h){Ks(h);var v=h.O;v&&typeof v.dispose=="function"&&v.dispose(),h.O=null,vs(h.V),h.g&&(v=h.g,h.g=null,v.abort(),v.dispose())}function W(h,v){try{var k=h.j;if(k.I!=0&&(k.g==h||z(k.h,h))){if(!h.L&&z(k.h,h)&&k.I==3){try{var A=k.Ba.g.parse(v)}catch{A=null}if(Array.isArray(A)&&A.length==3){var le=A;if(le[0]==0){e:if(!k.v){if(k.g)if(k.g.F+3e3<h.F)nr(k),ss(k);else break e;qn(k),ne(18)}}else k.xa=le[1],0<k.xa-k.K&&le[2]<37500&&k.F&&k.A==0&&!k.C&&(k.C=bt(y(k.Va,k),6e3));E(k.h)<=1&&k.ta&&(k.ta=void 0)}else wn(k,11)}else if((h.L||k.g==h)&&nr(k),!M(v))for(le=k.Ba.g.parse(v),v=0;v<le.length;v++){let zs=le[v];const fn=zs[0];if(!(fn<=k.K))if(k.K=fn,zs=zs[1],k.I==2)if(zs[0]=="c"){k.M=zs[1],k.ba=zs[2];const ra=zs[3];ra!=null&&(k.ka=ra,k.j.info("VER="+k.ka));const Da=zs[4];Da!=null&&(k.za=Da,k.j.info("SVER="+k.za));const ba=zs[5];ba!=null&&typeof ba=="number"&&ba>0&&(A=1.5*ba,k.O=A,k.j.info("backChannelRequestTimeoutMs_="+A)),A=k;const va=h.g;if(va){const To=va.g?va.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(To){var be=A.h;be.g||To.indexOf("spdy")==-1&&To.indexOf("quic")==-1&&To.indexOf("h2")==-1||(be.j=be.l,be.g=new Set,be.h&&(ie(be,be.h),be.h=null))}if(A.G){const ll=va.g?va.g.getResponseHeader("X-HTTP-Session-Id"):null;ll&&(A.wa=ll,fs(A.J,A.G,ll))}}k.I=3,k.l&&k.l.ra(),k.aa&&(k.T=Date.now()-h.F,k.j.info("Handshake RTT: "+k.T+"ms")),A=k;var nt=h;if(A.na=Pr(A,A.L?A.ba:null,A.W),nt.L){re(A.h,nt);var ls=nt,Cn=A.O;Cn&&(ls.H=Cn),ls.D&&(Ks(ls),mn(ls)),A.g=nt}else yn(A);k.i.length>0&&ps(k)}else zs[0]!="stop"&&zs[0]!="close"||wn(k,7);else k.I==3&&(zs[0]=="stop"||zs[0]=="close"?zs[0]=="stop"?wn(k,7):es(k):zs[0]!="noop"&&k.l&&k.l.qa(zs),k.A=0)}}ut(4)}catch{}}var he=class{constructor(h,v){this.g=h,this.map=v}};function ce(h){this.l=h||10,d.PerformanceNavigationTiming?(h=d.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function _e(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function E(h){return h.h?1:h.g?h.g.size:0}function z(h,v){return h.h?h.h==v:h.g?h.g.has(v):!1}function ie(h,v){h.g?h.g.add(v):h.h=v}function re(h,v){h.h&&h.h==v?h.h=null:h.g&&h.g.has(v)&&h.g.delete(v)}ce.prototype.cancel=function(){if(this.i=Ke(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Ke(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let v=h.i;for(const k of h.g.values())v=v.concat(k.G);return v}return O(h.i)}var rt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function st(h,v){if(h){h=h.split("&");for(let k=0;k<h.length;k++){const A=h[k].indexOf("=");let le,be=null;A>=0?(le=h[k].substring(0,A),be=h[k].substring(A+1)):le=h[k],v(le,be?decodeURIComponent(be.replace(/\+/g," ")):"")}}}function It(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let v;h instanceof It?(this.l=h.l,ds(this,h.j),this.o=h.o,this.g=h.g,rn(this,h.u),this.h=h.h,wr(this,er(h.i)),this.m=h.m):h&&(v=String(h).match(rt))?(this.l=!1,ds(this,v[1]||"",!0),this.o=Mn(v[2]||""),this.g=Mn(v[3]||"",!0),rn(this,v[4]),this.h=Mn(v[5]||"",!0),wr(this,v[6]||"",!0),this.m=Mn(v[7]||"")):(this.l=!1,this.i=new Qt(null,this.l))}It.prototype.toString=function(){const h=[];var v=this.j;v&&h.push(G(v,je,!0),":");var k=this.g;return(k||v=="file")&&(h.push("//"),(v=this.o)&&h.push(G(v,je,!0),"@"),h.push(fe(k).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),k=this.u,k!=null&&h.push(":",String(k))),(k=this.h)&&(this.g&&k.charAt(0)!="/"&&h.push("/"),h.push(G(k,k.charAt(0)=="/"?at:it,!0))),(k=this.i.toString())&&h.push("?",k),(k=this.m)&&h.push("#",G(k,Yt)),h.join("")},It.prototype.resolve=function(h){const v=ft(this);let k=!!h.j;k?ds(v,h.j):k=!!h.o,k?v.o=h.o:k=!!h.g,k?v.g=h.g:k=h.u!=null;var A=h.h;if(k)rn(v,h.u);else if(k=!!h.h){if(A.charAt(0)!="/")if(this.g&&!this.h)A="/"+A;else{var le=v.h.lastIndexOf("/");le!=-1&&(A=v.h.slice(0,le+1)+A)}if(le=A,le==".."||le==".")A="";else if(le.indexOf("./")!=-1||le.indexOf("/.")!=-1){A=le.lastIndexOf("/",0)==0,le=le.split("/");const be=[];for(let nt=0;nt<le.length;){const ls=le[nt++];ls=="."?A&&nt==le.length&&be.push(""):ls==".."?((be.length>1||be.length==1&&be[0]!="")&&be.pop(),A&&nt==le.length&&be.push("")):(be.push(ls),A=!0)}A=be.join("/")}else A=le}return k?v.h=A:k=h.i.toString()!=="",k?wr(v,er(h.i)):k=!!h.m,k&&(v.m=h.m),v};function ft(h){return new It(h)}function ds(h,v,k){h.j=k?Mn(v,!0):v,h.j&&(h.j=h.j.replace(/:$/,""))}function rn(h,v){if(v){if(v=Number(v),isNaN(v)||v<0)throw Error("Bad port number "+v);h.u=v}else h.u=null}function wr(h,v,k){v instanceof Qt?(h.i=v,$s(h.i,h.l)):(k||(v=G(v,pt)),h.i=new Qt(v,h.l))}function fs(h,v,k){h.i.set(v,k)}function Ar(h){return fs(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function Mn(h,v){return h?v?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function G(h,v,k){return typeof h=="string"?(h=encodeURI(h).replace(v,ve),k&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function ve(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var je=/[#\/\?@]/g,it=/[#\?:]/g,at=/[#\?]/g,pt=/[#\?@]/g,Yt=/#/g;function Qt(h,v){this.h=this.g=null,this.i=h||null,this.j=!!v}function Jt(h){h.g||(h.g=new Map,h.h=0,h.i&&st(h.i,function(v,k){h.add(decodeURIComponent(v.replace(/\+/g," ")),k)}))}n=Qt.prototype,n.add=function(h,v){Jt(this),this.i=null,h=Ps(this,h);let k=this.g.get(h);return k||this.g.set(h,k=[]),k.push(v),this.h+=1,this};function Dn(h,v){Jt(h),v=Ps(h,v),h.g.has(v)&&(h.i=null,h.h-=h.g.get(v).length,h.g.delete(v))}function os(h,v){return Jt(h),v=Ps(h,v),h.g.has(v)}n.forEach=function(h,v){Jt(this),this.g.forEach(function(k,A){k.forEach(function(le){h.call(v,le,A,this)},this)},this)};function Ss(h,v){Jt(h);let k=[];if(typeof v=="string")os(h,v)&&(k=k.concat(h.g.get(Ps(h,v))));else for(h=Array.from(h.g.values()),v=0;v<h.length;v++)k=k.concat(h[v]);return k}n.set=function(h,v){return Jt(this),this.i=null,h=Ps(this,h),os(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[v]),this.h+=1,this},n.get=function(h,v){return h?(h=Ss(this,h),h.length>0?String(h[0]):v):v};function xn(h,v,k){Dn(h,v),k.length>0&&(h.i=null,h.g.set(Ps(h,v),O(k)),h.h+=k.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],v=Array.from(this.g.keys());for(let A=0;A<v.length;A++){var k=v[A];const le=fe(k);k=Ss(this,k);for(let be=0;be<k.length;be++){let nt=le;k[be]!==""&&(nt+="="+fe(k[be])),h.push(nt)}}return this.i=h.join("&")};function er(h){const v=new Qt;return v.i=h.i,h.g&&(v.g=new Map(h.g),v.h=h.h),v}function Ps(h,v){return v=String(v),h.j&&(v=v.toLowerCase()),v}function $s(h,v){v&&!h.j&&(Jt(h),h.i=null,h.g.forEach(function(k,A){const le=A.toLowerCase();A!=le&&(Dn(this,A),xn(this,le,k))},h)),h.j=v}function Zt(h,v){const k=new Ye;if(d.Image){const A=new Image;A.onload=x(on,k,"TestLoadImage: loaded",!0,v,A),A.onerror=x(on,k,"TestLoadImage: error",!1,v,A),A.onabort=x(on,k,"TestLoadImage: abort",!1,v,A),A.ontimeout=x(on,k,"TestLoadImage: timeout",!1,v,A),d.setTimeout(function(){A.ontimeout&&A.ontimeout()},1e4),A.src=h}else v(!1)}function Ls(h,v){const k=new Ye,A=new AbortController,le=setTimeout(()=>{A.abort(),on(k,"TestPingServer: timeout",!1,v)},1e4);fetch(h,{signal:A.signal}).then(be=>{clearTimeout(le),be.ok?on(k,"TestPingServer: ok",!0,v):on(k,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(le),on(k,"TestPingServer: error",!1,v)})}function on(h,v,k,A,le){try{le&&(le.onload=null,le.onerror=null,le.onabort=null,le.ontimeout=null),A(k)}catch{}}function tr(){this.g=new Ds}function zn(h){this.i=h.Sb||null,this.h=h.ab||!1}_(zn,Hs),zn.prototype.g=function(){return new Sn(this.i,this.h)};function Sn(h,v){jt.call(this),this.H=h,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}_(Sn,jt),n=Sn.prototype,n.open=function(h,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=v,this.readyState=1,Yn(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const v={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(v.body=h),(this.H||d).fetch(new Request(this.D,v)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,hr(this)),this.readyState=0},n.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Yn(this)),this.g&&(this.readyState=3,Yn(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Kn(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function Kn(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}n.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var v=h.value?h.value:new Uint8Array(0);(v=this.B.decode(v,{stream:!h.done}))&&(this.response=this.responseText+=v)}h.done?hr(this):Yn(this),this.readyState==3&&Kn(this)}},n.Oa=function(h){this.g&&(this.response=this.responseText=h,hr(this))},n.Na=function(h){this.g&&(this.response=h,hr(this))},n.ga=function(){this.g&&hr(this)};function hr(h){h.readyState=4,h.l=null,h.j=null,h.B=null,Yn(h)}n.setRequestHeader=function(h,v){this.A.append(h,v)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],v=this.h.entries();for(var k=v.next();!k.done;)k=k.value,h.push(k[0]+": "+k[1]),k=v.next();return h.join(`\r
`)};function Yn(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Sn.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function mr(h){let v="";return Re(h,function(k,A){v+=A,v+=":",v+=k,v+=`\r
`}),v}function Ir(h,v,k){e:{for(A in k){var A=!1;break e}A=!0}A||(k=mr(k),typeof h=="string"?k!=null&&fe(k):fs(h,v,k))}function Ws(h){jt.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}_(Ws,jt);var na=/^https?$/i,_o=["POST","PUT"];n=Ws.prototype,n.Fa=function(h){this.H=h},n.ea=function(h,v,k,A){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);v=v?v.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Ht.g(),this.g.onreadystatechange=j(y(this.Ca,this));try{this.B=!0,this.g.open(v,String(h),!0),this.B=!1}catch(be){Xa(this,be);return}if(h=k||"",k=new Map(this.headers),A)if(Object.getPrototypeOf(A)===Object.prototype)for(var le in A)k.set(le,A[le]);else if(typeof A.keys=="function"&&typeof A.get=="function")for(const be of A.keys())k.set(be,A.get(be));else throw Error("Unknown input type for opt_headers: "+String(A));A=Array.from(k.keys()).find(be=>be.toLowerCase()=="content-type"),le=d.FormData&&h instanceof d.FormData,!(Array.prototype.indexOf.call(_o,v,void 0)>=0)||A||le||k.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[be,nt]of k)this.g.setRequestHeader(be,nt);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(be){Xa(this,be)}};function Xa(h,v){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=v,h.o=5,ko(h),K(h)}function ko(h){h.A||(h.A=!0,tt(h,"complete"),tt(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,tt(this,"complete"),tt(this,"abort"),K(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),K(this,!0)),Ws.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?C(this):this.Xa())},n.Xa=function(){C(this)};function C(h){if(h.h&&typeof u<"u"){if(h.v&&qe(h)==4)setTimeout(h.Ca.bind(h),0);else if(tt(h,"readystatechange"),qe(h)==4){h.h=!1;try{const be=h.ca();e:switch(be){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var k;if(!(k=v)){var A;if(A=be===0){let nt=String(h.D).match(rt)[1]||null;!nt&&d.self&&d.self.location&&(nt=d.self.location.protocol.slice(0,-1)),A=!na.test(nt?nt.toLowerCase():"")}k=A}if(k)tt(h,"complete"),tt(h,"success");else{h.o=6;try{var le=qe(h)>2?h.g.statusText:""}catch{le=""}h.l=le+" ["+h.ca()+"]",ko(h)}}finally{K(h)}}}}function K(h,v){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const k=h.g;h.g=null,v||tt(h,"ready");try{k.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function qe(h){return h.g?h.g.readyState:0}n.ca=function(){try{return qe(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(h){if(this.g){var v=this.g.responseText;return h&&v.indexOf(h)==0&&(v=v.substring(h.length)),nn(v)}};function Ze(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function _t(h){const v={};h=(h.g&&qe(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let A=0;A<h.length;A++){if(M(h[A]))continue;var k=Se(h[A]);const le=k[0];if(k=k[1],typeof k!="string")continue;k=k.trim();const be=v[le]||[];v[le]=be,be.push(k)}Q(v,function(A){return A.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Vt(h,v,k){return k&&k.internalChannelParams&&k.internalChannelParams[h]||v}function dt(h){this.za=0,this.i=[],this.j=new Ye,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Vt("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Vt("baseRetryDelayMs",5e3,h),this.Za=Vt("retryDelaySeedMs",1e4,h),this.Ta=Vt("forwardChannelMaxRetries",2,h),this.va=Vt("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new ce(h&&h.concurrentRequestLimit),this.Ba=new tr,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=dt.prototype,n.ka=8,n.I=1,n.connect=function(h,v,k,A){ne(0),this.W=h,this.H=v||{},k&&A!==void 0&&(this.H.OSID=k,this.H.OAID=A),this.F=this.X,this.J=Pr(this,null,this.W),ps(this)};function es(h){if(Cs(h),h.I==3){var v=h.V++,k=ft(h.J);if(fs(k,"SID",h.M),fs(k,"RID",v),fs(k,"TYPE","terminate"),Mr(h,k),v=new Ee(h,h.j,v),v.M=2,v.A=Ar(ft(k)),k=!1,d.navigator&&d.navigator.sendBeacon)try{k=d.navigator.sendBeacon(v.A.toString(),"")}catch{}!k&&d.Image&&(new Image().src=v.A,k=!0),k||(v.g=Lr(v.j,null),v.g.ea(v.A)),v.F=Date.now(),mn(v)}Hn(h)}function ss(h){h.g&&(Qn(h),h.g.cancel(),h.g=null)}function Cs(h){ss(h),h.v&&(d.clearTimeout(h.v),h.v=null),nr(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&d.clearTimeout(h.m),h.m=null)}function ps(h){if(!_e(h.h)&&!h.m){h.m=!0;var v=h.Ea;Te||T(),xe||(Te(),xe=!0),R.add(v,h),h.D=0}}function Bs(h,v){return E(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=v.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=bt(y(h.Ea,h,v),_r(h,h.D)),h.D++,!0)}n.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const le=new Ee(this,this.j,h);let be=this.o;if(this.U&&(be?(be=P(be),Be(be,this.U)):be=this.U),this.u!==null||this.R||(le.J=be,be=null),this.S)e:{for(var v=0,k=0;k<this.i.length;k++){t:{var A=this.i[k];if("__data__"in A.map&&(A=A.map.__data__,typeof A=="string")){A=A.length;break t}A=void 0}if(A===void 0)break;if(v+=A,v>4096){v=k;break e}if(v===4096||k===this.i.length-1){v=k+1;break e}}v=1e3}else v=1e3;v=un(this,le,v),k=ft(this.J),fs(k,"RID",h),fs(k,"CVER",22),this.G&&fs(k,"X-HTTP-Session-Id",this.G),Mr(this,k),be&&(this.R?v="headers="+fe(mr(be))+"&"+v:this.u&&Ir(k,this.u,be)),ie(this.h,le),this.Ra&&fs(k,"TYPE","init"),this.S?(fs(k,"$req",v),fs(k,"SID","null"),le.U=!0,lt(le,k,null)):lt(le,k,v),this.I=2}}else this.I==3&&(h?Hr(this,h):this.i.length==0||_e(this.h)||Hr(this))};function Hr(h,v){var k;v?k=v.l:k=h.V++;const A=ft(h.J);fs(A,"SID",h.M),fs(A,"RID",k),fs(A,"AID",h.K),Mr(h,A),h.u&&h.o&&Ir(A,h.u,h.o),k=new Ee(h,h.j,k,h.D+1),h.u===null&&(k.J=h.o),v&&(h.i=v.G.concat(h.i)),v=un(h,k,1e3),k.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),ie(h.h,k),lt(k,A,v)}function Mr(h,v){h.H&&Re(h.H,function(k,A){fs(v,A,k)}),h.l&&Re({},function(k,A){fs(v,A,k)})}function un(h,v,k){k=Math.min(h.i.length,k);const A=h.l?y(h.l.Ka,h.l,h):null;e:{var le=h.i;let ls=-1;for(;;){const Cn=["count="+k];ls==-1?k>0?(ls=le[0].g,Cn.push("ofs="+ls)):ls=0:Cn.push("ofs="+ls);let zs=!0;for(let fn=0;fn<k;fn++){var be=le[fn].g;const ra=le[fn].map;if(be-=ls,be<0)ls=Math.max(0,le[fn].g-100),zs=!1;else try{be="req"+be+"_"||"";try{var nt=ra instanceof Map?ra:Object.entries(ra);for(const[Da,ba]of nt){let va=ba;p(ba)&&(va=as(ba)),Cn.push(be+Da+"="+encodeURIComponent(va))}}catch(Da){throw Cn.push(be+"type="+encodeURIComponent("_badmap")),Da}}catch{A&&A(ra)}}if(zs){nt=Cn.join("&");break e}}nt=void 0}return h=h.i.splice(0,k),v.G=h,nt}function yn(h){if(!h.g&&!h.v){h.Y=1;var v=h.Da;Te||T(),xe||(Te(),xe=!0),R.add(v,h),h.A=0}}function qn(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=bt(y(h.Da,h),_r(h,h.A)),h.A++,!0)}n.Da=function(){if(this.v=null,sr(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=bt(y(this.Wa,this),h)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ne(10),ss(this),sr(this))};function Qn(h){h.B!=null&&(d.clearTimeout(h.B),h.B=null)}function sr(h){h.g=new Ee(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var v=ft(h.na);fs(v,"RID","rpc"),fs(v,"SID",h.M),fs(v,"AID",h.K),fs(v,"CI",h.F?"0":"1"),!h.F&&h.ia&&fs(v,"TO",h.ia),fs(v,"TYPE","xmlhttp"),Mr(h,v),h.u&&h.o&&Ir(v,h.u,h.o),h.O&&(h.g.H=h.O);var k=h.g;h=h.ba,k.M=1,k.A=Ar(ft(v)),k.u=null,k.R=!0,Bt(k,h)}n.Va=function(){this.C!=null&&(this.C=null,ss(this),qn(this),ne(19))};function nr(h){h.C!=null&&(d.clearTimeout(h.C),h.C=null)}function Dr(h,v){var k=null;if(h.g==v){nr(h),Qn(h),h.g=null;var A=2}else if(z(h.h,v))k=v.G,re(h.h,v),A=1;else return;if(h.I!=0){if(v.o)if(A==1){k=v.u?v.u.length:0,v=Date.now()-v.F;var le=h.D;A=He(),tt(A,new $e(A,k)),ps(h)}else yn(h);else if(le=v.m,le==3||le==0&&v.X>0||!(A==1&&Bs(h,v)||A==2&&qn(h)))switch(k&&k.length>0&&(v=h.h,v.i=v.i.concat(k)),le){case 1:wn(h,5);break;case 4:wn(h,10);break;case 3:wn(h,6);break;default:wn(h,2)}}}function _r(h,v){let k=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(k*=2),k*v}function wn(h,v){if(h.j.info("Error code "+v),v==2){var k=y(h.bb,h),A=h.Ua;const le=!A;A=new It(A||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||ds(A,"https"),Ar(A),le?Zt(A.toString(),k):Ls(A.toString(),k)}else ne(2);h.I=0,h.l&&h.l.pa(v),Hn(h),Cs(h)}n.bb=function(h){h?(this.j.info("Successfully pinged google.com"),ne(2)):(this.j.info("Failed to ping google.com"),ne(1))};function Hn(h){if(h.I=0,h.ja=[],h.l){const v=Ke(h.h);(v.length!=0||h.i.length!=0)&&($(h.ja,v),$(h.ja,h.i),h.h.i.length=0,O(h.i),h.i.length=0),h.l.oa()}}function Pr(h,v,k){var A=k instanceof It?ft(k):new It(k);if(A.g!="")v&&(A.g=v+"."+A.g),rn(A,A.u);else{var le=d.location;A=le.protocol,v=v?v+"."+le.hostname:le.hostname,le=+le.port;const be=new It(null);A&&ds(be,A),v&&(be.g=v),le&&rn(be,le),k&&(be.h=k),A=be}return k=h.G,v=h.wa,k&&v&&fs(A,k,v),fs(A,"VER",h.ka),Mr(h,A),A}function Lr(h,v,k){if(v&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return v=h.Aa&&!h.ma?new Ws(new zn({ab:k})):new Ws(h.ma),v.Fa(h.L),v}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function jo(){}n=jo.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Ma(){}Ma.prototype.g=function(h,v){return new rr(h,v)};function rr(h,v){jt.call(this),this.g=new dt(v),this.l=h,this.h=v&&v.messageUrlParams||null,h=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(h?h["X-WebChannel-Content-Type"]=v.messageContentType:h={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.sa&&(h?h["X-WebChannel-Client-Profile"]=v.sa:h={"X-WebChannel-Client-Profile":v.sa}),this.g.U=h,(h=v&&v.Qb)&&!M(h)&&(this.g.u=h),this.A=v&&v.supportsCrossDomainXhr||!1,this.v=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!M(v)&&(this.g.G=v,h=this.h,h!==null&&v in h&&(h=this.h,v in h&&delete h[v])),this.j=new fr(this)}_(rr,jt),rr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},rr.prototype.close=function(){es(this.g)},rr.prototype.o=function(h){var v=this.g;if(typeof h=="string"){var k={};k.__data__=h,h=k}else this.v&&(k={},k.__data__=as(h),h=k);v.i.push(new he(v.Ya++,h)),v.I==3&&ps(v)},rr.prototype.N=function(){this.g.l=null,delete this.j,es(this.g),delete this.g,rr.Z.N.call(this)};function Ja(h){ye.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var v=h.__sm__;if(v){e:{for(const k in v){h=k;break e}h=void 0}(this.i=h)&&(h=this.i,v=v!==null&&h in v?v[h]:void 0),this.data=v}else this.data=h}_(Ja,ye);function ya(){Me.call(this),this.status=1}_(ya,Me);function fr(h){this.g=h}_(fr,jo),fr.prototype.ra=function(){tt(this.g,"a")},fr.prototype.qa=function(h){tt(this.g,new Ja(h))},fr.prototype.pa=function(h){tt(this.g,new ya)},fr.prototype.oa=function(){tt(this.g,"b")},Ma.prototype.createWebChannel=Ma.prototype.g,rr.prototype.send=rr.prototype.o,rr.prototype.open=rr.prototype.m,rr.prototype.close=rr.prototype.close,s_=function(){return new Ma},t_=function(){return He()},e_=De,gg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Je.NO_ERROR=0,Je.TIMEOUT=8,Je.HTTP_ERROR=6,_h=Je,Kt.COMPLETE="complete",Zw=Kt,is.EventType=xs,xs.OPEN="a",xs.CLOSE="b",xs.ERROR="c",xs.MESSAGE="d",jt.prototype.listen=jt.prototype.J,cu=is,Ws.prototype.listenOnce=Ws.prototype.K,Ws.prototype.getLastError=Ws.prototype.Ha,Ws.prototype.getLastErrorCode=Ws.prototype.ya,Ws.prototype.getStatus=Ws.prototype.ca,Ws.prototype.getResponseJson=Ws.prototype.La,Ws.prototype.getResponseText=Ws.prototype.la,Ws.prototype.send=Ws.prototype.ea,Ws.prototype.setWithCredentials=Ws.prototype.Fa,Jw=Ws}).apply(typeof nh<"u"?nh:typeof self<"u"?self:typeof window<"u"?window:{});class yr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}yr.UNAUTHENTICATED=new yr(null),yr.GOOGLE_CREDENTIALS=new yr("google-credentials-uid"),yr.FIRST_PARTY=new yr("first-party-uid"),yr.MOCK_USER=new yr("mock-user");let uc="12.8.0";function pR(n){uc=n}const tl=new Wg("@firebase/firestore");function Hl(){return tl.logLevel}function xt(n,...e){if(tl.logLevel<=ks.DEBUG){const t=e.map(ay);tl.debug(`Firestore (${uc}): ${n}`,...t)}}function ji(n,...e){if(tl.logLevel<=ks.ERROR){const t=e.map(ay);tl.error(`Firestore (${uc}): ${n}`,...t)}}function ec(n,...e){if(tl.logLevel<=ks.WARN){const t=e.map(ay);tl.warn(`Firestore (${uc}): ${n}`,...t)}}function ay(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Gt(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,n_(n,i,t)}function n_(n,e,t){let i=`FIRESTORE (${uc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw ji(i),new Error(i)}function Gs(n,e,t,i){let l="Unexpected state";typeof t=="string"?l=t:i=t,n||n_(e,l,i)}function rs(n,e){return n}const Pe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ct extends Qa{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class xi{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class r_{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class gR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(yr.UNAUTHENTICATED)))}shutdown(){}}class yR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class bR{constructor(e){this.t=e,this.currentUser=yr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Gs(this.o===void 0,42304);let i=this.i;const l=g=>this.i!==i?(i=this.i,t(g)):Promise.resolve();let u=new xi;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new xi,e.enqueueRetryable((()=>l(this.currentUser)))};const d=()=>{const g=u;e.enqueueRetryable((async()=>{await g.promise,await l(this.currentUser)}))},p=g=>{xt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((g=>p(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?p(g):(xt("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new xi)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(xt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Gs(typeof i.accessToken=="string",31837,{l:i}),new r_(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Gs(e===null||typeof e=="string",2055,{h:e}),new yr(e)}}class vR{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=yr.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class xR{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new vR(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(yr.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class yx{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class wR{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Zr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Gs(this.o===void 0,3512);const i=u=>{u.error!=null&&xt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const d=u.token!==this.m;return this.m=u.token,xt("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable((()=>i(u)))};const l=u=>{xt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>l(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?l(u):xt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new yx(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Gs(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new yx(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function _R(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class iy{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const l=_R(40);for(let u=0;u<l.length;++u)i.length<20&&l[u]<t&&(i+=e.charAt(l[u]%62))}return i}}function js(n,e){return n<e?-1:n>e?1:0}function yg(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const l=n.charAt(i),u=e.charAt(i);if(l!==u)return Lp(l)===Lp(u)?js(l,u):Lp(l)?1:-1}return js(n.length,e.length)}const kR=55296,jR=57343;function Lp(n){const e=n.charCodeAt(0);return e>=kR&&e<=jR}function tc(n,e,t){return n.length===e.length&&n.every(((i,l)=>t(i,e[l])))}const bx="__name__";class Ua{constructor(e,t,i){t===void 0?t=0:t>e.length&&Gt(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Gt(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Ua.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ua?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let l=0;l<i;l++){const u=Ua.compareSegments(e.get(l),t.get(l));if(u!==0)return u}return js(e.length,t.length)}static compareSegments(e,t){const i=Ua.isNumericId(e),l=Ua.isNumericId(t);return i&&!l?-1:!i&&l?1:i&&l?Ua.extractNumericId(e).compare(Ua.extractNumericId(t)):yg(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return oo.fromString(e.substring(4,e.length-2))}}class ln extends Ua{construct(e,t,i){return new ln(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new ct(Pe.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((l=>l.length>0)))}return new ln(t)}static emptyPath(){return new ln([])}}const TR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ur extends Ua{construct(e,t,i){return new ur(e,t,i)}static isValidIdentifier(e){return TR.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ur.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===bx}static keyField(){return new ur([bx])}static fromServerFormat(e){const t=[];let i="",l=0;const u=()=>{if(i.length===0)throw new ct(Pe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let d=!1;for(;l<e.length;){const p=e[l];if(p==="\\"){if(l+1===e.length)throw new ct(Pe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[l+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new ct(Pe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=g,l+=2}else p==="`"?(d=!d,l++):p!=="."||d?(i+=p,l++):(u(),l++)}if(u(),d)throw new ct(Pe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ur(t)}static emptyPath(){return new ur([])}}class Lt{constructor(e){this.path=e}static fromPath(e){return new Lt(ln.fromString(e))}static fromName(e){return new Lt(ln.fromString(e).popFirst(5))}static empty(){return new Lt(ln.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ln.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ln.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Lt(new ln(e.slice()))}}function a_(n,e,t){if(!t)throw new ct(Pe.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function ER(n,e,t,i){if(e===!0&&i===!0)throw new ct(Pe.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function vx(n){if(!Lt.isDocumentKey(n))throw new ct(Pe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function xx(n){if(Lt.isDocumentKey(n))throw new ct(Pe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function i_(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function im(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Gt(12329,{type:typeof n})}function Nr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ct(Pe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=im(n);throw new ct(Pe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function NR(n,e){if(e<=0)throw new ct(Pe.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function Fn(n,e){const t={typeString:n};return e&&(t.value=e),t}function Fu(n,e){if(!i_(n))throw new ct(Pe.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const l=e[i].typeString,u="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const d=n[i];if(l&&typeof d!==l){t=`JSON field '${i}' must be a ${l}.`;break}if(u!==void 0&&d!==u.value){t=`Expected '${i}' field to equal '${u.value}'`;break}}if(t)throw new ct(Pe.INVALID_ARGUMENT,t);return!0}const wx=-62135596800,_x=1e6;class Rt{static now(){return Rt.fromMillis(Date.now())}static fromDate(e){return Rt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*_x);return new Rt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ct(Pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ct(Pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<wx)throw new ct(Pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ct(Pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/_x}_compareTo(e){return this.seconds===e.seconds?js(this.nanoseconds,e.nanoseconds):js(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Rt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Fu(e,Rt._jsonSchema))return new Rt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-wx;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Rt._jsonSchemaVersion="firestore/timestamp/1.0",Rt._jsonSchema={type:Fn("string",Rt._jsonSchemaVersion),seconds:Fn("number"),nanoseconds:Fn("number")};class ts{static fromTimestamp(e){return new ts(e)}static min(){return new ts(new Rt(0,0))}static max(){return new ts(new Rt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const ju=-1;function SR(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,l=ts.fromTimestamp(i===1e9?new Rt(t+1,0):new Rt(t,i));return new ho(l,Lt.empty(),e)}function CR(n){return new ho(n.readTime,n.key,ju)}class ho{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new ho(ts.min(),Lt.empty(),ju)}static max(){return new ho(ts.max(),Lt.empty(),ju)}}function RR(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Lt.comparator(n.documentKey,e.documentKey),t!==0?t:js(n.largestBatchId,e.largestBatchId))}const AR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class IR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function dc(n){if(n.code!==Pe.FAILED_PRECONDITION||n.message!==AR)throw n;xt("LocalStore","Unexpectedly lost primary lease")}class Fe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Gt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Fe(((i,l)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(i,l)},this.catchCallback=u=>{this.wrapFailure(t,u).next(i,l)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Fe?t:Fe.resolve(t)}catch(t){return Fe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Fe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Fe.reject(t)}static resolve(e){return new Fe(((t,i)=>{t(e)}))}static reject(e){return new Fe(((t,i)=>{i(e)}))}static waitFor(e){return new Fe(((t,i)=>{let l=0,u=0,d=!1;e.forEach((p=>{++l,p.next((()=>{++u,d&&u===l&&t()}),(g=>i(g)))})),d=!0,u===l&&t()}))}static or(e){let t=Fe.resolve(!1);for(const i of e)t=t.next((l=>l?Fe.resolve(l):i()));return t}static forEach(e,t){const i=[];return e.forEach(((l,u)=>{i.push(t.call(this,l,u))})),this.waitFor(i)}static mapArray(e,t){return new Fe(((i,l)=>{const u=e.length,d=new Array(u);let p=0;for(let g=0;g<u;g++){const y=g;t(e[y]).next((x=>{d[y]=x,++p,p===u&&i(d)}),(x=>l(x)))}}))}static doWhile(e,t){return new Fe(((i,l)=>{const u=()=>{e()===!0?t().next((()=>{u()}),l):i()};u()}))}}function MR(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function hc(n){return n.name==="IndexedDbTransactionError"}class om{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}om.ce=-1;const oy=-1;function lm(n){return n==null}function Vh(n){return n===0&&1/n==-1/0}function DR(n){return typeof n=="number"&&Number.isInteger(n)&&!Vh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const o_="";function PR(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=kx(e)),e=LR(n.get(t),e);return kx(e)}function LR(n,e){let t=e;const i=n.length;for(let l=0;l<i;l++){const u=n.charAt(l);switch(u){case"\0":t+="";break;case o_:t+="";break;default:t+=u}}return t}function kx(n){return n+o_+""}function jx(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function xo(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function l_(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class bn{constructor(e,t){this.comparator=e,this.root=t||cr.EMPTY}insert(e,t){return new bn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,cr.BLACK,null,null))}remove(e){return new bn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,cr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const l=this.comparator(e,i.key);if(l===0)return t+i.left.size;l<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new rh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new rh(this.root,e,this.comparator,!1)}getReverseIterator(){return new rh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new rh(this.root,e,this.comparator,!0)}}class rh{constructor(e,t,i,l){this.isReverse=l,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=t?i(e.key,t):1,t&&l&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class cr{constructor(e,t,i,l,u){this.key=e,this.value=t,this.color=i??cr.RED,this.left=l??cr.EMPTY,this.right=u??cr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,l,u){return new cr(e??this.key,t??this.value,i??this.color,l??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let l=this;const u=i(e,l.key);return l=u<0?l.copy(null,null,null,l.left.insert(e,t,i),null):u===0?l.copy(null,t,null,null,null):l.copy(null,null,null,null,l.right.insert(e,t,i)),l.fixUp()}removeMin(){if(this.left.isEmpty())return cr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,l=this;if(t(e,l.key)<0)l.left.isEmpty()||l.left.isRed()||l.left.left.isRed()||(l=l.moveRedLeft()),l=l.copy(null,null,null,l.left.remove(e,t),null);else{if(l.left.isRed()&&(l=l.rotateRight()),l.right.isEmpty()||l.right.isRed()||l.right.left.isRed()||(l=l.moveRedRight()),t(e,l.key)===0){if(l.right.isEmpty())return cr.EMPTY;i=l.right.min(),l=l.copy(i.key,i.value,null,null,l.right.removeMin())}l=l.copy(null,null,null,null,l.right.remove(e,t))}return l.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,cr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,cr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Gt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Gt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Gt(27949);return e+(this.isRed()?0:1)}}cr.EMPTY=null,cr.RED=!0,cr.BLACK=!1;cr.EMPTY=new class{constructor(){this.size=0}get key(){throw Gt(57766)}get value(){throw Gt(16141)}get color(){throw Gt(16727)}get left(){throw Gt(29726)}get right(){throw Gt(36894)}copy(e,t,i,l,u){return this}insert(e,t,i){return new cr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Gn{constructor(e){this.comparator=e,this.data=new bn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const l=i.getNext();if(this.comparator(l.key,e[1])>=0)return;t(l.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Tx(this.data.getIterator())}getIteratorFrom(e){return new Tx(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Gn)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(this.comparator(l,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Gn(this.comparator);return t.data=e,t}}class Tx{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class ea{constructor(e){this.fields=e,e.sort(ur.comparator)}static empty(){return new ea([])}unionWith(e){let t=new Gn(ur.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new ea(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return tc(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class c_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class dr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(l){try{return atob(l)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new c_("Invalid base64 string: "+u):u}})(e);return new dr(t)}static fromUint8Array(e){const t=(function(l){let u="";for(let d=0;d<l.length;++d)u+=String.fromCharCode(l[d]);return u})(e);return new dr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return js(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}dr.EMPTY_BYTE_STRING=new dr("");const OR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function mo(n){if(Gs(!!n,39018),typeof n=="string"){let e=0;const t=OR.exec(n);if(Gs(!!t,46558,{timestamp:n}),t[1]){let l=t[1];l=(l+"000000000").substr(0,9),e=Number(l)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:In(n.seconds),nanos:In(n.nanos)}}function In(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function fo(n){return typeof n=="string"?dr.fromBase64String(n):dr.fromUint8Array(n)}const u_="server_timestamp",d_="__type__",h_="__previous_value__",m_="__local_write_time__";function ly(n){return(n?.mapValue?.fields||{})[d_]?.stringValue===u_}function cm(n){const e=n.mapValue.fields[h_];return ly(e)?cm(e):e}function Tu(n){const e=mo(n.mapValue.fields[m_].timestampValue);return new Rt(e.seconds,e.nanos)}class BR{constructor(e,t,i,l,u,d,p,g,y,x,_){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=l,this.ssl=u,this.forceLongPolling=d,this.autoDetectLongPolling=p,this.longPollingOptions=g,this.useFetchStreams=y,this.isUsingEmulator=x,this.apiKey=_}}const Uh="(default)";class Eu{constructor(e,t){this.projectId=e,this.database=t||Uh}static empty(){return new Eu("","")}get isDefaultDatabase(){return this.database===Uh}isEqual(e){return e instanceof Eu&&e.projectId===this.projectId&&e.database===this.database}}function VR(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new ct(Pe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Eu(n.options.projectId,e)}const f_="__type__",UR="__max__",ah={mapValue:{}},p_="__vector__",Fh="value";function po(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?ly(n)?4:zR(n)?9007199254740991:FR(n)?10:11:Gt(28295,{value:n})}function Ka(n,e){if(n===e)return!0;const t=po(n);if(t!==po(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Tu(n).isEqual(Tu(e));case 3:return(function(l,u){if(typeof l.timestampValue=="string"&&typeof u.timestampValue=="string"&&l.timestampValue.length===u.timestampValue.length)return l.timestampValue===u.timestampValue;const d=mo(l.timestampValue),p=mo(u.timestampValue);return d.seconds===p.seconds&&d.nanos===p.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(l,u){return fo(l.bytesValue).isEqual(fo(u.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(l,u){return In(l.geoPointValue.latitude)===In(u.geoPointValue.latitude)&&In(l.geoPointValue.longitude)===In(u.geoPointValue.longitude)})(n,e);case 2:return(function(l,u){if("integerValue"in l&&"integerValue"in u)return In(l.integerValue)===In(u.integerValue);if("doubleValue"in l&&"doubleValue"in u){const d=In(l.doubleValue),p=In(u.doubleValue);return d===p?Vh(d)===Vh(p):isNaN(d)&&isNaN(p)}return!1})(n,e);case 9:return tc(n.arrayValue.values||[],e.arrayValue.values||[],Ka);case 10:case 11:return(function(l,u){const d=l.mapValue.fields||{},p=u.mapValue.fields||{};if(jx(d)!==jx(p))return!1;for(const g in d)if(d.hasOwnProperty(g)&&(p[g]===void 0||!Ka(d[g],p[g])))return!1;return!0})(n,e);default:return Gt(52216,{left:n})}}function Nu(n,e){return(n.values||[]).find((t=>Ka(t,e)))!==void 0}function sc(n,e){if(n===e)return 0;const t=po(n),i=po(e);if(t!==i)return js(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return js(n.booleanValue,e.booleanValue);case 2:return(function(u,d){const p=In(u.integerValue||u.doubleValue),g=In(d.integerValue||d.doubleValue);return p<g?-1:p>g?1:p===g?0:isNaN(p)?isNaN(g)?0:-1:1})(n,e);case 3:return Ex(n.timestampValue,e.timestampValue);case 4:return Ex(Tu(n),Tu(e));case 5:return yg(n.stringValue,e.stringValue);case 6:return(function(u,d){const p=fo(u),g=fo(d);return p.compareTo(g)})(n.bytesValue,e.bytesValue);case 7:return(function(u,d){const p=u.split("/"),g=d.split("/");for(let y=0;y<p.length&&y<g.length;y++){const x=js(p[y],g[y]);if(x!==0)return x}return js(p.length,g.length)})(n.referenceValue,e.referenceValue);case 8:return(function(u,d){const p=js(In(u.latitude),In(d.latitude));return p!==0?p:js(In(u.longitude),In(d.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Nx(n.arrayValue,e.arrayValue);case 10:return(function(u,d){const p=u.fields||{},g=d.fields||{},y=p[Fh]?.arrayValue,x=g[Fh]?.arrayValue,_=js(y?.values?.length||0,x?.values?.length||0);return _!==0?_:Nx(y,x)})(n.mapValue,e.mapValue);case 11:return(function(u,d){if(u===ah.mapValue&&d===ah.mapValue)return 0;if(u===ah.mapValue)return 1;if(d===ah.mapValue)return-1;const p=u.fields||{},g=Object.keys(p),y=d.fields||{},x=Object.keys(y);g.sort(),x.sort();for(let _=0;_<g.length&&_<x.length;++_){const j=yg(g[_],x[_]);if(j!==0)return j;const O=sc(p[g[_]],y[x[_]]);if(O!==0)return O}return js(g.length,x.length)})(n.mapValue,e.mapValue);default:throw Gt(23264,{he:t})}}function Ex(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return js(n,e);const t=mo(n),i=mo(e),l=js(t.seconds,i.seconds);return l!==0?l:js(t.nanos,i.nanos)}function Nx(n,e){const t=n.values||[],i=e.values||[];for(let l=0;l<t.length&&l<i.length;++l){const u=sc(t[l],i[l]);if(u)return u}return js(t.length,i.length)}function nc(n){return bg(n)}function bg(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=mo(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return fo(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Lt.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",l=!0;for(const u of t.values||[])l?l=!1:i+=",",i+=bg(u);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let l="{",u=!0;for(const d of i)u?u=!1:l+=",",l+=`${d}:${bg(t.fields[d])}`;return l+"}"})(n.mapValue):Gt(61005,{value:n})}function kh(n){switch(po(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=cm(n);return e?16+kh(e):16;case 5:return 2*n.stringValue.length;case 6:return fo(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((l,u)=>l+kh(u)),0)})(n.arrayValue);case 10:case 11:return(function(i){let l=0;return xo(i.fields,((u,d)=>{l+=u.length+kh(d)})),l})(n.mapValue);default:throw Gt(13486,{value:n})}}function Sx(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function vg(n){return!!n&&"integerValue"in n}function cy(n){return!!n&&"arrayValue"in n}function Cx(n){return!!n&&"nullValue"in n}function Rx(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function jh(n){return!!n&&"mapValue"in n}function FR(n){return(n?.mapValue?.fields||{})[f_]?.stringValue===p_}function pu(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return xo(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=pu(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=pu(n.arrayValue.values[t]);return e}return{...n}}function zR(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===UR}class qr{constructor(e){this.value=e}static empty(){return new qr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!jh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=pu(t)}setAll(e){let t=ur.emptyPath(),i={},l=[];e.forEach(((d,p)=>{if(!t.isImmediateParentOf(p)){const g=this.getFieldsMap(t);this.applyChanges(g,i,l),i={},l=[],t=p.popLast()}d?i[p.lastSegment()]=pu(d):l.push(p.lastSegment())}));const u=this.getFieldsMap(t);this.applyChanges(u,i,l)}delete(e){const t=this.field(e.popLast());jh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ka(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let l=t.mapValue.fields[e.get(i)];jh(l)&&l.mapValue.fields||(l={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=l),t=l}return t.mapValue.fields}applyChanges(e,t,i){xo(t,((l,u)=>e[l]=u));for(const l of i)delete e[l]}clone(){return new qr(pu(this.value))}}function g_(n){const e=[];return xo(n.fields,((t,i)=>{const l=new ur([t]);if(jh(i)){const u=g_(i.mapValue).fields;if(u.length===0)e.push(l);else for(const d of u)e.push(l.child(d))}else e.push(l)})),new ea(e)}class br{constructor(e,t,i,l,u,d,p){this.key=e,this.documentType=t,this.version=i,this.readTime=l,this.createTime=u,this.data=d,this.documentState=p}static newInvalidDocument(e){return new br(e,0,ts.min(),ts.min(),ts.min(),qr.empty(),0)}static newFoundDocument(e,t,i,l){return new br(e,1,t,ts.min(),i,l,0)}static newNoDocument(e,t){return new br(e,2,t,ts.min(),ts.min(),qr.empty(),0)}static newUnknownDocument(e,t){return new br(e,3,t,ts.min(),ts.min(),qr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ts.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=qr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=qr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ts.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof br&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new br(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class zh{constructor(e,t){this.position=e,this.inclusive=t}}function Ax(n,e,t){let i=0;for(let l=0;l<n.position.length;l++){const u=e[l],d=n.position[l];if(u.field.isKeyField()?i=Lt.comparator(Lt.fromName(d.referenceValue),t.key):i=sc(d,t.data.field(u.field)),u.dir==="desc"&&(i*=-1),i!==0)break}return i}function Ix(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ka(n.position[t],e.position[t]))return!1;return!0}class Su{constructor(e,t="asc"){this.field=e,this.dir=t}}function qR(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class y_{}class Un extends y_{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new $R(e,t,i):t==="array-contains"?new KR(e,i):t==="in"?new YR(e,i):t==="not-in"?new QR(e,i):t==="array-contains-any"?new XR(e,i):new Un(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new WR(e,i):new GR(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(sc(t,this.value)):t!==null&&po(this.value)===po(t)&&this.matchesComparison(sc(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Gt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ca extends y_{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Ca(e,t)}matches(e){return b_(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function b_(n){return n.op==="and"}function v_(n){return HR(n)&&b_(n)}function HR(n){for(const e of n.filters)if(e instanceof Ca)return!1;return!0}function xg(n){if(n instanceof Un)return n.field.canonicalString()+n.op.toString()+nc(n.value);if(v_(n))return n.filters.map((e=>xg(e))).join(",");{const e=n.filters.map((t=>xg(t))).join(",");return`${n.op}(${e})`}}function x_(n,e){return n instanceof Un?(function(i,l){return l instanceof Un&&i.op===l.op&&i.field.isEqual(l.field)&&Ka(i.value,l.value)})(n,e):n instanceof Ca?(function(i,l){return l instanceof Ca&&i.op===l.op&&i.filters.length===l.filters.length?i.filters.reduce(((u,d,p)=>u&&x_(d,l.filters[p])),!0):!1})(n,e):void Gt(19439)}function w_(n){return n instanceof Un?(function(t){return`${t.field.canonicalString()} ${t.op} ${nc(t.value)}`})(n):n instanceof Ca?(function(t){return t.op.toString()+" {"+t.getFilters().map(w_).join(" ,")+"}"})(n):"Filter"}class $R extends Un{constructor(e,t,i){super(e,t,i),this.key=Lt.fromName(i.referenceValue)}matches(e){const t=Lt.comparator(e.key,this.key);return this.matchesComparison(t)}}class WR extends Un{constructor(e,t){super(e,"in",t),this.keys=__("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class GR extends Un{constructor(e,t){super(e,"not-in",t),this.keys=__("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function __(n,e){return(e.arrayValue?.values||[]).map((t=>Lt.fromName(t.referenceValue)))}class KR extends Un{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return cy(t)&&Nu(t.arrayValue,this.value)}}class YR extends Un{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Nu(this.value.arrayValue,t)}}class QR extends Un{constructor(e,t){super(e,"not-in",t)}matches(e){if(Nu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Nu(this.value.arrayValue,t)}}class XR extends Un{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!cy(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Nu(this.value.arrayValue,i)))}}class JR{constructor(e,t=null,i=[],l=[],u=null,d=null,p=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=l,this.limit=u,this.startAt=d,this.endAt=p,this.Te=null}}function Mx(n,e=null,t=[],i=[],l=null,u=null,d=null){return new JR(n,e,t,i,l,u,d)}function uy(n){const e=rs(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>xg(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(u){return u.field.canonicalString()+u.dir})(i))).join(","),lm(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>nc(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>nc(i))).join(",")),e.Te=t}return e.Te}function dy(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!qR(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!x_(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Ix(n.startAt,e.startAt)&&Ix(n.endAt,e.endAt)}function wg(n){return Lt.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class mc{constructor(e,t=null,i=[],l=[],u=null,d="F",p=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=l,this.limit=u,this.limitType=d,this.startAt=p,this.endAt=g,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function ZR(n,e,t,i,l,u,d,p){return new mc(n,e,t,i,l,u,d,p)}function um(n){return new mc(n)}function Dx(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function eA(n){return Lt.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function k_(n){return n.collectionGroup!==null}function gu(n){const e=rs(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const u of e.explicitOrderBy)e.Ie.push(u),t.add(u.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let p=new Gn(ur.comparator);return d.filters.forEach((g=>{g.getFlattenedFilters().forEach((y=>{y.isInequality()&&(p=p.add(y.field))}))})),p})(e).forEach((u=>{t.has(u.canonicalString())||u.isKeyField()||e.Ie.push(new Su(u,i))})),t.has(ur.keyField().canonicalString())||e.Ie.push(new Su(ur.keyField(),i))}return e.Ie}function $a(n){const e=rs(n);return e.Ee||(e.Ee=tA(e,gu(n))),e.Ee}function tA(n,e){if(n.limitType==="F")return Mx(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((l=>{const u=l.dir==="desc"?"asc":"desc";return new Su(l.field,u)}));const t=n.endAt?new zh(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new zh(n.startAt.position,n.startAt.inclusive):null;return Mx(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function _g(n,e){const t=n.filters.concat([e]);return new mc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function sA(n,e){const t=n.explicitOrderBy.concat([e]);return new mc(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function qh(n,e,t){return new mc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function dm(n,e){return dy($a(n),$a(e))&&n.limitType===e.limitType}function j_(n){return`${uy($a(n))}|lt:${n.limitType}`}function $l(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((l=>w_(l))).join(", ")}]`),lm(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((l=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(l))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((l=>nc(l))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((l=>nc(l))).join(",")),`Target(${i})`})($a(n))}; limitType=${n.limitType})`}function hm(n,e){return e.isFoundDocument()&&(function(i,l){const u=l.key.path;return i.collectionGroup!==null?l.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(u):Lt.isDocumentKey(i.path)?i.path.isEqual(u):i.path.isImmediateParentOf(u)})(n,e)&&(function(i,l){for(const u of gu(i))if(!u.field.isKeyField()&&l.data.field(u.field)===null)return!1;return!0})(n,e)&&(function(i,l){for(const u of i.filters)if(!u.matches(l))return!1;return!0})(n,e)&&(function(i,l){return!(i.startAt&&!(function(d,p,g){const y=Ax(d,p,g);return d.inclusive?y<=0:y<0})(i.startAt,gu(i),l)||i.endAt&&!(function(d,p,g){const y=Ax(d,p,g);return d.inclusive?y>=0:y>0})(i.endAt,gu(i),l))})(n,e)}function nA(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function T_(n){return(e,t)=>{let i=!1;for(const l of gu(n)){const u=rA(l,e,t);if(u!==0)return u;i=i||l.field.isKeyField()}return 0}}function rA(n,e,t){const i=n.field.isKeyField()?Lt.comparator(e.key,t.key):(function(u,d,p){const g=d.data.field(u),y=p.data.field(u);return g!==null&&y!==null?sc(g,y):Gt(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Gt(19790,{direction:n.dir})}}class il{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[l,u]of i)if(this.equalsFn(l,e))return u}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),l=this.inner[i];if(l===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let u=0;u<l.length;u++)if(this.equalsFn(l[u][0],e))return void(l[u]=[e,t]);l.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let l=0;l<i.length;l++)if(this.equalsFn(i[l][0],e))return i.length===1?delete this.inner[t]:i.splice(l,1),this.innerSize--,!0;return!1}forEach(e){xo(this.inner,((t,i)=>{for(const[l,u]of i)e(l,u)}))}isEmpty(){return l_(this.inner)}size(){return this.innerSize}}const aA=new bn(Lt.comparator);function Ti(){return aA}const E_=new bn(Lt.comparator);function uu(...n){let e=E_;for(const t of n)e=e.insert(t.key,t);return e}function N_(n){let e=E_;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Wo(){return yu()}function S_(){return yu()}function yu(){return new il((n=>n.toString()),((n,e)=>n.isEqual(e)))}const iA=new bn(Lt.comparator),oA=new Gn(Lt.comparator);function Ts(...n){let e=oA;for(const t of n)e=e.add(t);return e}const lA=new Gn(js);function cA(){return lA}function hy(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Vh(e)?"-0":e}}function C_(n){return{integerValue:""+n}}function R_(n,e){return DR(e)?C_(e):hy(n,e)}class mm{constructor(){this._=void 0}}function uA(n,e,t){return n instanceof Cu?(function(l,u){const d={fields:{[d_]:{stringValue:u_},[m_]:{timestampValue:{seconds:l.seconds,nanos:l.nanoseconds}}}};return u&&ly(u)&&(u=cm(u)),u&&(d.fields[h_]=u),{mapValue:d}})(t,e):n instanceof Ru?I_(n,e):n instanceof Au?M_(n,e):(function(l,u){const d=A_(l,u),p=Px(d)+Px(l.Ae);return vg(d)&&vg(l.Ae)?C_(p):hy(l.serializer,p)})(n,e)}function dA(n,e,t){return n instanceof Ru?I_(n,e):n instanceof Au?M_(n,e):t}function A_(n,e){return n instanceof Iu?(function(i){return vg(i)||(function(u){return!!u&&"doubleValue"in u})(i)})(e)?e:{integerValue:0}:null}class Cu extends mm{}class Ru extends mm{constructor(e){super(),this.elements=e}}function I_(n,e){const t=D_(e);for(const i of n.elements)t.some((l=>Ka(l,i)))||t.push(i);return{arrayValue:{values:t}}}class Au extends mm{constructor(e){super(),this.elements=e}}function M_(n,e){let t=D_(e);for(const i of n.elements)t=t.filter((l=>!Ka(l,i)));return{arrayValue:{values:t}}}class Iu extends mm{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Px(n){return In(n.integerValue||n.doubleValue)}function D_(n){return cy(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class P_{constructor(e,t){this.field=e,this.transform=t}}function hA(n,e){return n.field.isEqual(e.field)&&(function(i,l){return i instanceof Ru&&l instanceof Ru||i instanceof Au&&l instanceof Au?tc(i.elements,l.elements,Ka):i instanceof Iu&&l instanceof Iu?Ka(i.Ae,l.Ae):i instanceof Cu&&l instanceof Cu})(n.transform,e.transform)}class mA{constructor(e,t){this.version=e,this.transformResults=t}}class Sr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Sr}static exists(e){return new Sr(void 0,e)}static updateTime(e){return new Sr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Th(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class fm{}function L_(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new pm(n.key,Sr.none()):new zu(n.key,n.data,Sr.none());{const t=n.data,i=qr.empty();let l=new Gn(ur.comparator);for(let u of e.fields)if(!l.has(u)){let d=t.field(u);d===null&&u.length>1&&(u=u.popLast(),d=t.field(u)),d===null?i.delete(u):i.set(u,d),l=l.add(u)}return new wo(n.key,i,new ea(l.toArray()),Sr.none())}}function fA(n,e,t){n instanceof zu?(function(l,u,d){const p=l.value.clone(),g=Ox(l.fieldTransforms,u,d.transformResults);p.setAll(g),u.convertToFoundDocument(d.version,p).setHasCommittedMutations()})(n,e,t):n instanceof wo?(function(l,u,d){if(!Th(l.precondition,u))return void u.convertToUnknownDocument(d.version);const p=Ox(l.fieldTransforms,u,d.transformResults),g=u.data;g.setAll(O_(l)),g.setAll(p),u.convertToFoundDocument(d.version,g).setHasCommittedMutations()})(n,e,t):(function(l,u,d){u.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function bu(n,e,t,i){return n instanceof zu?(function(u,d,p,g){if(!Th(u.precondition,d))return p;const y=u.value.clone(),x=Bx(u.fieldTransforms,g,d);return y.setAll(x),d.convertToFoundDocument(d.version,y).setHasLocalMutations(),null})(n,e,t,i):n instanceof wo?(function(u,d,p,g){if(!Th(u.precondition,d))return p;const y=Bx(u.fieldTransforms,g,d),x=d.data;return x.setAll(O_(u)),x.setAll(y),d.convertToFoundDocument(d.version,x).setHasLocalMutations(),p===null?null:p.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((_=>_.field)))})(n,e,t,i):(function(u,d,p){return Th(u.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):p})(n,e,t)}function pA(n,e){let t=null;for(const i of n.fieldTransforms){const l=e.data.field(i.field),u=A_(i.transform,l||null);u!=null&&(t===null&&(t=qr.empty()),t.set(i.field,u))}return t||null}function Lx(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,l){return i===void 0&&l===void 0||!(!i||!l)&&tc(i,l,((u,d)=>hA(u,d)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class zu extends fm{constructor(e,t,i,l=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=l,this.type=0}getFieldMask(){return null}}class wo extends fm{constructor(e,t,i,l,u=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=l,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function O_(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function Ox(n,e,t){const i=new Map;Gs(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let l=0;l<t.length;l++){const u=n[l],d=u.transform,p=e.data.field(u.field);i.set(u.field,dA(d,p,t[l]))}return i}function Bx(n,e,t){const i=new Map;for(const l of n){const u=l.transform,d=t.data.field(l.field);i.set(l.field,uA(u,d,e))}return i}class pm extends fm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class gA extends fm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class yA{constructor(e,t,i,l){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=l}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let l=0;l<this.mutations.length;l++){const u=this.mutations[l];u.key.isEqual(e.key)&&fA(u,e,i[l])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=bu(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=bu(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=S_();return this.mutations.forEach((l=>{const u=e.get(l.key),d=u.overlayedDocument;let p=this.applyToLocalView(d,u.mutatedFields);p=t.has(l.key)?null:p;const g=L_(d,p);g!==null&&i.set(l.key,g),d.isValidDocument()||d.convertToNoDocument(ts.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Ts())}isEqual(e){return this.batchId===e.batchId&&tc(this.mutations,e.mutations,((t,i)=>Lx(t,i)))&&tc(this.baseMutations,e.baseMutations,((t,i)=>Lx(t,i)))}}class my{constructor(e,t,i,l){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=l}static from(e,t,i){Gs(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let l=(function(){return iA})();const u=e.mutations;for(let d=0;d<u.length;d++)l=l.insert(u[d].key,i[d].version);return new my(e,t,i,l)}}class bA{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class vA{constructor(e,t){this.count=e,this.unchangedNames=t}}var Vn,As;function xA(n){switch(n){case Pe.OK:return Gt(64938);case Pe.CANCELLED:case Pe.UNKNOWN:case Pe.DEADLINE_EXCEEDED:case Pe.RESOURCE_EXHAUSTED:case Pe.INTERNAL:case Pe.UNAVAILABLE:case Pe.UNAUTHENTICATED:return!1;case Pe.INVALID_ARGUMENT:case Pe.NOT_FOUND:case Pe.ALREADY_EXISTS:case Pe.PERMISSION_DENIED:case Pe.FAILED_PRECONDITION:case Pe.ABORTED:case Pe.OUT_OF_RANGE:case Pe.UNIMPLEMENTED:case Pe.DATA_LOSS:return!0;default:return Gt(15467,{code:n})}}function B_(n){if(n===void 0)return ji("GRPC error has no .code"),Pe.UNKNOWN;switch(n){case Vn.OK:return Pe.OK;case Vn.CANCELLED:return Pe.CANCELLED;case Vn.UNKNOWN:return Pe.UNKNOWN;case Vn.DEADLINE_EXCEEDED:return Pe.DEADLINE_EXCEEDED;case Vn.RESOURCE_EXHAUSTED:return Pe.RESOURCE_EXHAUSTED;case Vn.INTERNAL:return Pe.INTERNAL;case Vn.UNAVAILABLE:return Pe.UNAVAILABLE;case Vn.UNAUTHENTICATED:return Pe.UNAUTHENTICATED;case Vn.INVALID_ARGUMENT:return Pe.INVALID_ARGUMENT;case Vn.NOT_FOUND:return Pe.NOT_FOUND;case Vn.ALREADY_EXISTS:return Pe.ALREADY_EXISTS;case Vn.PERMISSION_DENIED:return Pe.PERMISSION_DENIED;case Vn.FAILED_PRECONDITION:return Pe.FAILED_PRECONDITION;case Vn.ABORTED:return Pe.ABORTED;case Vn.OUT_OF_RANGE:return Pe.OUT_OF_RANGE;case Vn.UNIMPLEMENTED:return Pe.UNIMPLEMENTED;case Vn.DATA_LOSS:return Pe.DATA_LOSS;default:return Gt(39323,{code:n})}}(As=Vn||(Vn={}))[As.OK=0]="OK",As[As.CANCELLED=1]="CANCELLED",As[As.UNKNOWN=2]="UNKNOWN",As[As.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",As[As.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",As[As.NOT_FOUND=5]="NOT_FOUND",As[As.ALREADY_EXISTS=6]="ALREADY_EXISTS",As[As.PERMISSION_DENIED=7]="PERMISSION_DENIED",As[As.UNAUTHENTICATED=16]="UNAUTHENTICATED",As[As.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",As[As.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",As[As.ABORTED=10]="ABORTED",As[As.OUT_OF_RANGE=11]="OUT_OF_RANGE",As[As.UNIMPLEMENTED=12]="UNIMPLEMENTED",As[As.INTERNAL=13]="INTERNAL",As[As.UNAVAILABLE=14]="UNAVAILABLE",As[As.DATA_LOSS=15]="DATA_LOSS";function wA(){return new TextEncoder}const _A=new oo([4294967295,4294967295],0);function Vx(n){const e=wA().encode(n),t=new Xw;return t.update(e),new Uint8Array(t.digest())}function Ux(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),l=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new oo([t,i],0),new oo([l,u],0)]}class fy{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new du(`Invalid padding: ${t}`);if(i<0)throw new du(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new du(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new du(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=oo.fromNumber(this.ge)}ye(e,t,i){let l=e.add(t.multiply(oo.fromNumber(i)));return l.compare(_A)===1&&(l=new oo([l.getBits(0),l.getBits(1)],0)),l.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Vx(e),[i,l]=Ux(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);if(!this.we(d))return!1}return!0}static create(e,t,i){const l=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),d=new fy(u,l,t);return i.forEach((p=>d.insert(p))),d}insert(e){if(this.ge===0)return;const t=Vx(e),[i,l]=Ux(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);this.be(d)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class du extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class gm{constructor(e,t,i,l,u){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=l,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const l=new Map;return l.set(e,qu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new gm(ts.min(),l,new bn(js),Ti(),Ts())}}class qu{constructor(e,t,i,l,u){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=l,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new qu(i,t,Ts(),Ts(),Ts())}}class Eh{constructor(e,t,i,l){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=l}}class V_{constructor(e,t){this.targetId=e,this.Ce=t}}class U_{constructor(e,t,i=dr.EMPTY_BYTE_STRING,l=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=l}}class Fx{constructor(){this.ve=0,this.Fe=zx(),this.Me=dr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ts(),t=Ts(),i=Ts();return this.Fe.forEach(((l,u)=>{switch(u){case 0:e=e.add(l);break;case 2:t=t.add(l);break;case 1:i=i.add(l);break;default:Gt(38017,{changeType:u})}})),new qu(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=zx()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Gs(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class kA{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ti(),this.He=ih(),this.Je=ih(),this.Ze=new bn(js)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:Gt(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,l)=>{this.rt(l)&&t(l)}))}st(e){const t=e.targetId,i=e.Ce.count,l=this.ot(t);if(l){const u=l.target;if(wg(u))if(i===0){const d=new Lt(u.path);this.et(t,d,br.newNoDocument(d,ts.min()))}else Gs(i===1,20013,{expectedCount:i});else{const d=this._t(t);if(d!==i){const p=this.ut(e),g=p?this.ct(p,e,d):1;if(g!==0){this.it(t);const y=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,y)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:l=0},hashCount:u=0}=t;let d,p;try{d=fo(i).toUint8Array()}catch(g){if(g instanceof c_)return ec("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{p=new fy(d,l,u)}catch(g){return ec(g instanceof du?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return p.ge===0?null:p}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let l=0;return i.forEach((u=>{const d=this.Ge.ht(),p=`projects/${d.projectId}/databases/${d.database}/documents/${u.path.canonicalString()}`;e.mightContain(p)||(this.et(t,u,null),l++)})),l}Tt(e){const t=new Map;this.ze.forEach(((u,d)=>{const p=this.ot(d);if(p){if(u.current&&wg(p.target)){const g=new Lt(p.target.path);this.It(g).has(d)||this.Et(d,g)||this.et(d,g,br.newNoDocument(g,e))}u.Be&&(t.set(d,u.ke()),u.Ke())}}));let i=Ts();this.Je.forEach(((u,d)=>{let p=!0;d.forEachWhile((g=>{const y=this.ot(g);return!y||y.purpose==="TargetPurposeLimboResolution"||(p=!1,!1)})),p&&(i=i.add(u))})),this.je.forEach(((u,d)=>d.setReadTime(e)));const l=new gm(e,t,this.Ze,this.je,i);return this.je=Ti(),this.He=ih(),this.Je=ih(),this.Ze=new bn(js),l}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const l=this.nt(e);this.Et(e,t)?l.qe(t,1):l.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new Fx,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Gn(js),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Gn(js),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||xt("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Fx),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function ih(){return new bn(Lt.comparator)}function zx(){return new bn(Lt.comparator)}const jA={asc:"ASCENDING",desc:"DESCENDING"},TA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},EA={and:"AND",or:"OR"};class NA{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function kg(n,e){return n.useProto3Json||lm(e)?e:{value:e}}function Hh(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function F_(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function SA(n,e){return Hh(n,e.toTimestamp())}function Wa(n){return Gs(!!n,49232),ts.fromTimestamp((function(t){const i=mo(t);return new Rt(i.seconds,i.nanos)})(n))}function py(n,e){return jg(n,e).canonicalString()}function jg(n,e){const t=(function(l){return new ln(["projects",l.projectId,"databases",l.database])})(n).child("documents");return e===void 0?t:t.child(e)}function z_(n){const e=ln.fromString(n);return Gs(G_(e),10190,{key:e.toString()}),e}function Tg(n,e){return py(n.databaseId,e.path)}function Op(n,e){const t=z_(e);if(t.get(1)!==n.databaseId.projectId)throw new ct(Pe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ct(Pe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Lt(H_(t))}function q_(n,e){return py(n.databaseId,e)}function CA(n){const e=z_(n);return e.length===4?ln.emptyPath():H_(e)}function Eg(n){return new ln(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function H_(n){return Gs(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function qx(n,e,t){return{name:Tg(n,e),fields:t.value.mapValue.fields}}function RA(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:Gt(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),l=e.targetChange.targetIds||[],u=(function(y,x){return y.useProto3Json?(Gs(x===void 0||typeof x=="string",58123),dr.fromBase64String(x||"")):(Gs(x===void 0||x instanceof Buffer||x instanceof Uint8Array,16193),dr.fromUint8Array(x||new Uint8Array))})(n,e.targetChange.resumeToken),d=e.targetChange.cause,p=d&&(function(y){const x=y.code===void 0?Pe.UNKNOWN:B_(y.code);return new ct(x,y.message||"")})(d);t=new U_(i,l,u,p||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const l=Op(n,i.document.name),u=Wa(i.document.updateTime),d=i.document.createTime?Wa(i.document.createTime):ts.min(),p=new qr({mapValue:{fields:i.document.fields}}),g=br.newFoundDocument(l,u,d,p),y=i.targetIds||[],x=i.removedTargetIds||[];t=new Eh(y,x,g.key,g)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const l=Op(n,i.document),u=i.readTime?Wa(i.readTime):ts.min(),d=br.newNoDocument(l,u),p=i.removedTargetIds||[];t=new Eh([],p,d.key,d)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const l=Op(n,i.document),u=i.removedTargetIds||[];t=new Eh([],u,l,null)}else{if(!("filter"in e))return Gt(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:l=0,unchangedNames:u}=i,d=new vA(l,u),p=i.targetId;t=new V_(p,d)}}return t}function AA(n,e){let t;if(e instanceof zu)t={update:qx(n,e.key,e.value)};else if(e instanceof pm)t={delete:Tg(n,e.key)};else if(e instanceof wo)t={update:qx(n,e.key,e.data),updateMask:UA(e.fieldMask)};else{if(!(e instanceof gA))return Gt(16599,{dt:e.type});t={verify:Tg(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(u,d){const p=d.transform;if(p instanceof Cu)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(p instanceof Ru)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:p.elements}};if(p instanceof Au)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:p.elements}};if(p instanceof Iu)return{fieldPath:d.field.canonicalString(),increment:p.Ae};throw Gt(20930,{transform:d.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(l,u){return u.updateTime!==void 0?{updateTime:SA(l,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:Gt(27497)})(n,e.precondition)),t}function IA(n,e){return n&&n.length>0?(Gs(e!==void 0,14353),n.map((t=>(function(l,u){let d=l.updateTime?Wa(l.updateTime):Wa(u);return d.isEqual(ts.min())&&(d=Wa(u)),new mA(d,l.transformResults||[])})(t,e)))):[]}function MA(n,e){return{documents:[q_(n,e.path)]}}function DA(n,e){const t={structuredQuery:{}},i=e.path;let l;e.collectionGroup!==null?(l=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(l=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=q_(n,l);const u=(function(y){if(y.length!==0)return W_(Ca.create(y,"and"))})(e.filters);u&&(t.structuredQuery.where=u);const d=(function(y){if(y.length!==0)return y.map((x=>(function(j){return{field:Wl(j.field),direction:OA(j.dir)}})(x)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const p=kg(n,e.limit);return p!==null&&(t.structuredQuery.limit=p),e.startAt&&(t.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{ft:t,parent:l}}function PA(n){let e=CA(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let l=null;if(i>0){Gs(i===1,65062);const x=t.from[0];x.allDescendants?l=x.collectionId:e=e.child(x.collectionId)}let u=[];t.where&&(u=(function(_){const j=$_(_);return j instanceof Ca&&v_(j)?j.getFilters():[j]})(t.where));let d=[];t.orderBy&&(d=(function(_){return _.map((j=>(function($){return new Su(Gl($.field),(function(L){switch(L){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})($.direction))})(j)))})(t.orderBy));let p=null;t.limit&&(p=(function(_){let j;return j=typeof _=="object"?_.value:_,lm(j)?null:j})(t.limit));let g=null;t.startAt&&(g=(function(_){const j=!!_.before,O=_.values||[];return new zh(O,j)})(t.startAt));let y=null;return t.endAt&&(y=(function(_){const j=!_.before,O=_.values||[];return new zh(O,j)})(t.endAt)),ZR(e,l,d,u,p,"F",g,y)}function LA(n,e){const t=(function(l){switch(l){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Gt(28987,{purpose:l})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function $_(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Gl(t.unaryFilter.field);return Un.create(i,"==",{doubleValue:NaN});case"IS_NULL":const l=Gl(t.unaryFilter.field);return Un.create(l,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=Gl(t.unaryFilter.field);return Un.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=Gl(t.unaryFilter.field);return Un.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Gt(61313);default:return Gt(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Un.create(Gl(t.fieldFilter.field),(function(l){switch(l){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Gt(58110);default:return Gt(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Ca.create(t.compositeFilter.filters.map((i=>$_(i))),(function(l){switch(l){case"AND":return"and";case"OR":return"or";default:return Gt(1026)}})(t.compositeFilter.op))})(n):Gt(30097,{filter:n})}function OA(n){return jA[n]}function BA(n){return TA[n]}function VA(n){return EA[n]}function Wl(n){return{fieldPath:n.canonicalString()}}function Gl(n){return ur.fromServerFormat(n.fieldPath)}function W_(n){return n instanceof Un?(function(t){if(t.op==="=="){if(Rx(t.value))return{unaryFilter:{field:Wl(t.field),op:"IS_NAN"}};if(Cx(t.value))return{unaryFilter:{field:Wl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Rx(t.value))return{unaryFilter:{field:Wl(t.field),op:"IS_NOT_NAN"}};if(Cx(t.value))return{unaryFilter:{field:Wl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Wl(t.field),op:BA(t.op),value:t.value}}})(n):n instanceof Ca?(function(t){const i=t.getFilters().map((l=>W_(l)));return i.length===1?i[0]:{compositeFilter:{op:VA(t.op),filters:i}}})(n):Gt(54877,{filter:n})}function UA(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function G_(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function K_(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}class ro{constructor(e,t,i,l,u=ts.min(),d=ts.min(),p=dr.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=l,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=p,this.expectedCount=g}withSequenceNumber(e){return new ro(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ro(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ro(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ro(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class FA{constructor(e){this.yt=e}}function zA(n){const e=PA({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?qh(e,e.limit,"L"):e}class qA{constructor(){this.Sn=new HA}addToCollectionParentIndex(e,t){return this.Sn.add(t),Fe.resolve()}getCollectionParents(e,t){return Fe.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return Fe.resolve()}deleteFieldIndex(e,t){return Fe.resolve()}deleteAllFieldIndexes(e){return Fe.resolve()}createTargetIndexes(e,t){return Fe.resolve()}getDocumentsMatchingTarget(e,t){return Fe.resolve(null)}getIndexType(e,t){return Fe.resolve(0)}getFieldIndexes(e,t){return Fe.resolve([])}getNextCollectionGroupToUpdate(e){return Fe.resolve(null)}getMinOffset(e,t){return Fe.resolve(ho.min())}getMinOffsetFromCollectionGroup(e,t){return Fe.resolve(ho.min())}updateCollectionGroup(e,t,i){return Fe.resolve()}updateIndexEntries(e,t){return Fe.resolve()}}class HA{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t]||new Gn(ln.comparator),u=!l.has(i);return this.index[t]=l.add(i),u}has(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t];return l&&l.has(i)}getEntries(e){return(this.index[e]||new Gn(ln.comparator)).toArray()}}const Hx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Y_=41943040;class zr{static withCacheSize(e){return new zr(e,zr.DEFAULT_COLLECTION_PERCENTILE,zr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}zr.DEFAULT_COLLECTION_PERCENTILE=10,zr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,zr.DEFAULT=new zr(Y_,zr.DEFAULT_COLLECTION_PERCENTILE,zr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),zr.DISABLED=new zr(-1,0,0);class rc{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new rc(0)}static ar(){return new rc(-1)}}const $x="LruGarbageCollector",$A=1048576;function Wx([n,e],[t,i]){const l=js(n,t);return l===0?js(e,i):l}class WA{constructor(e){this.Pr=e,this.buffer=new Gn(Wx),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();Wx(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class GA{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){xt($x,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){hc(t)?xt($x,"Ignoring IndexedDB error during garbage collection: ",t):await dc(t)}await this.Ar(3e5)}))}}class KA{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Fe.resolve(om.ce);const i=new WA(t);return this.Vr.forEachTarget(e,(l=>i.Er(l.sequenceNumber))).next((()=>this.Vr.mr(e,(l=>i.Er(l))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(xt("LruGarbageCollector","Garbage collection skipped; disabled"),Fe.resolve(Hx)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(xt("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Hx):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,l,u,d,p,g,y;const x=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((_=>(_>this.params.maximumSequenceNumbersToCollect?(xt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${_}`),l=this.params.maximumSequenceNumbersToCollect):l=_,d=Date.now(),this.nthSequenceNumber(e,l)))).next((_=>(i=_,p=Date.now(),this.removeTargets(e,i,t)))).next((_=>(u=_,g=Date.now(),this.removeOrphanedDocuments(e,i)))).next((_=>(y=Date.now(),Hl()<=ks.DEBUG&&xt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-x}ms
	Determined least recently used ${l} in `+(p-d)+`ms
	Removed ${u} targets in `+(g-p)+`ms
	Removed ${_} documents in `+(y-g)+`ms
Total Duration: ${y-x}ms`),Fe.resolve({didRun:!0,sequenceNumbersCollected:l,targetsRemoved:u,documentsRemoved:_}))))}}function YA(n,e){return new KA(n,e)}class QA{constructor(){this.changes=new il((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,br.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Fe.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class XA{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class JA{constructor(e,t,i,l){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=l}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((l=>(i=l,this.remoteDocumentCache.getEntry(e,t)))).next((l=>(i!==null&&bu(i.mutation,l,ea.empty(),Rt.now()),l)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Ts()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Ts()){const l=Wo();return this.populateOverlays(e,l,t).next((()=>this.computeViews(e,t,l,i).next((u=>{let d=uu();return u.forEach(((p,g)=>{d=d.insert(p,g.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const i=Wo();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Ts())))}populateOverlays(e,t,i){const l=[];return i.forEach((u=>{t.has(u)||l.push(u)})),this.documentOverlayCache.getOverlays(e,l).next((u=>{u.forEach(((d,p)=>{t.set(d,p)}))}))}computeViews(e,t,i,l){let u=Ti();const d=yu(),p=(function(){return yu()})();return t.forEach(((g,y)=>{const x=i.get(y.key);l.has(y.key)&&(x===void 0||x.mutation instanceof wo)?u=u.insert(y.key,y):x!==void 0?(d.set(y.key,x.mutation.getFieldMask()),bu(x.mutation,y,x.mutation.getFieldMask(),Rt.now())):d.set(y.key,ea.empty())})),this.recalculateAndSaveOverlays(e,u).next((g=>(g.forEach(((y,x)=>d.set(y,x))),t.forEach(((y,x)=>p.set(y,new XA(x,d.get(y)??null)))),p)))}recalculateAndSaveOverlays(e,t){const i=yu();let l=new bn(((d,p)=>d-p)),u=Ts();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const p of d)p.keys().forEach((g=>{const y=t.get(g);if(y===null)return;let x=i.get(g)||ea.empty();x=p.applyToLocalView(y,x),i.set(g,x);const _=(l.get(p.batchId)||Ts()).add(g);l=l.insert(p.batchId,_)}))})).next((()=>{const d=[],p=l.getReverseIterator();for(;p.hasNext();){const g=p.getNext(),y=g.key,x=g.value,_=S_();x.forEach((j=>{if(!u.has(j)){const O=L_(t.get(j),i.get(j));O!==null&&_.set(j,O),u=u.add(j)}})),d.push(this.documentOverlayCache.saveOverlays(e,y,_))}return Fe.waitFor(d)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,l){return eA(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):k_(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,l):this.getDocumentsMatchingCollectionQuery(e,t,i,l)}getNextDocuments(e,t,i,l){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,l).next((u=>{const d=l-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,l-u.size):Fe.resolve(Wo());let p=ju,g=u;return d.next((y=>Fe.forEach(y,((x,_)=>(p<_.largestBatchId&&(p=_.largestBatchId),u.get(x)?Fe.resolve():this.remoteDocumentCache.getEntry(e,x).next((j=>{g=g.insert(x,j)}))))).next((()=>this.populateOverlays(e,y,u))).next((()=>this.computeViews(e,g,y,Ts()))).next((x=>({batchId:p,changes:N_(x)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Lt(t)).next((i=>{let l=uu();return i.isFoundDocument()&&(l=l.insert(i.key,i)),l}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,l){const u=t.collectionGroup;let d=uu();return this.indexManager.getCollectionParents(e,u).next((p=>Fe.forEach(p,(g=>{const y=(function(_,j){return new mc(j,null,_.explicitOrderBy.slice(),_.filters.slice(),_.limit,_.limitType,_.startAt,_.endAt)})(t,g.child(u));return this.getDocumentsMatchingCollectionQuery(e,y,i,l).next((x=>{x.forEach(((_,j)=>{d=d.insert(_,j)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,i,l){let u;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((d=>(u=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,u,l)))).next((d=>{u.forEach(((g,y)=>{const x=y.getKey();d.get(x)===null&&(d=d.insert(x,br.newInvalidDocument(x)))}));let p=uu();return d.forEach(((g,y)=>{const x=u.get(g);x!==void 0&&bu(x.mutation,y,ea.empty(),Rt.now()),hm(t,y)&&(p=p.insert(g,y))})),p}))}}class ZA{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return Fe.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(l){return{id:l.id,version:l.version,createTime:Wa(l.createTime)}})(t)),Fe.resolve()}getNamedQuery(e,t){return Fe.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(l){return{name:l.name,query:zA(l.bundledQuery),readTime:Wa(l.readTime)}})(t)),Fe.resolve()}}class eI{constructor(){this.overlays=new bn(Lt.comparator),this.Lr=new Map}getOverlay(e,t){return Fe.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Wo();return Fe.forEach(t,(l=>this.getOverlay(e,l).next((u=>{u!==null&&i.set(l,u)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((l,u)=>{this.bt(e,t,u)})),Fe.resolve()}removeOverlaysForBatchId(e,t,i){const l=this.Lr.get(i);return l!==void 0&&(l.forEach((u=>this.overlays=this.overlays.remove(u))),this.Lr.delete(i)),Fe.resolve()}getOverlaysForCollection(e,t,i){const l=Wo(),u=t.length+1,d=new Lt(t.child("")),p=this.overlays.getIteratorFrom(d);for(;p.hasNext();){const g=p.getNext().value,y=g.getKey();if(!t.isPrefixOf(y.path))break;y.path.length===u&&g.largestBatchId>i&&l.set(g.getKey(),g)}return Fe.resolve(l)}getOverlaysForCollectionGroup(e,t,i,l){let u=new bn(((y,x)=>y-x));const d=this.overlays.getIterator();for(;d.hasNext();){const y=d.getNext().value;if(y.getKey().getCollectionGroup()===t&&y.largestBatchId>i){let x=u.get(y.largestBatchId);x===null&&(x=Wo(),u=u.insert(y.largestBatchId,x)),x.set(y.getKey(),y)}}const p=Wo(),g=u.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((y,x)=>p.set(y,x))),!(p.size()>=l)););return Fe.resolve(p)}bt(e,t,i){const l=this.overlays.get(i.key);if(l!==null){const d=this.Lr.get(l.largestBatchId).delete(i.key);this.Lr.set(l.largestBatchId,d)}this.overlays=this.overlays.insert(i.key,new bA(t,i));let u=this.Lr.get(t);u===void 0&&(u=Ts(),this.Lr.set(t,u)),this.Lr.set(t,u.add(i.key))}}class tI{constructor(){this.sessionToken=dr.EMPTY_BYTE_STRING}getSessionToken(e){return Fe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Fe.resolve()}}class gy{constructor(){this.kr=new Gn(Jn.Kr),this.qr=new Gn(Jn.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new Jn(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new Jn(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new Lt(new ln([])),i=new Jn(t,e),l=new Jn(t,e+1),u=[];return this.qr.forEachInRange([i,l],(d=>{this.Wr(d),u.push(d.key)})),u}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new Lt(new ln([])),i=new Jn(t,e),l=new Jn(t,e+1);let u=Ts();return this.qr.forEachInRange([i,l],(d=>{u=u.add(d.key)})),u}containsKey(e){const t=new Jn(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Jn{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return Lt.comparator(e.key,t.key)||js(e.Hr,t.Hr)}static Ur(e,t){return js(e.Hr,t.Hr)||Lt.comparator(e.key,t.key)}}class sI{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Gn(Jn.Kr)}checkEmpty(e){return Fe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,l){const u=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new yA(u,t,i,l);this.mutationQueue.push(d);for(const p of l)this.Jr=this.Jr.add(new Jn(p.key,u)),this.indexManager.addToCollectionParentIndex(e,p.key.path.popLast());return Fe.resolve(d)}lookupMutationBatch(e,t){return Fe.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,l=this.Xr(i),u=l<0?0:l;return Fe.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return Fe.resolve(this.mutationQueue.length===0?oy:this.Yn-1)}getAllMutationBatches(e){return Fe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Jn(t,0),l=new Jn(t,Number.POSITIVE_INFINITY),u=[];return this.Jr.forEachInRange([i,l],(d=>{const p=this.Zr(d.Hr);u.push(p)})),Fe.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Gn(js);return t.forEach((l=>{const u=new Jn(l,0),d=new Jn(l,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([u,d],(p=>{i=i.add(p.Hr)}))})),Fe.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,l=i.length+1;let u=i;Lt.isDocumentKey(u)||(u=u.child(""));const d=new Jn(new Lt(u),0);let p=new Gn(js);return this.Jr.forEachWhile((g=>{const y=g.key.path;return!!i.isPrefixOf(y)&&(y.length===l&&(p=p.add(g.Hr)),!0)}),d),Fe.resolve(this.Yr(p))}Yr(e){const t=[];return e.forEach((i=>{const l=this.Zr(i);l!==null&&t.push(l)})),t}removeMutationBatch(e,t){Gs(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return Fe.forEach(t.mutations,(l=>{const u=new Jn(l.key,t.batchId);return i=i.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,l.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new Jn(t,0),l=this.Jr.firstAfterOrEqual(i);return Fe.resolve(t.isEqual(l&&l.key))}performConsistencyCheck(e){return this.mutationQueue.length,Fe.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class nI{constructor(e){this.ti=e,this.docs=(function(){return new bn(Lt.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,l=this.docs.get(i),u=l?l.size:0,d=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:d}),this.size+=d-u,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Fe.resolve(i?i.document.mutableCopy():br.newInvalidDocument(t))}getEntries(e,t){let i=Ti();return t.forEach((l=>{const u=this.docs.get(l);i=i.insert(l,u?u.document.mutableCopy():br.newInvalidDocument(l))})),Fe.resolve(i)}getDocumentsMatchingQuery(e,t,i,l){let u=Ti();const d=t.path,p=new Lt(d.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(p);for(;g.hasNext();){const{key:y,value:{document:x}}=g.getNext();if(!d.isPrefixOf(y.path))break;y.path.length>d.length+1||RR(CR(x),i)<=0||(l.has(x.key)||hm(t,x))&&(u=u.insert(x.key,x.mutableCopy()))}return Fe.resolve(u)}getAllFromCollectionGroup(e,t,i,l){Gt(9500)}ni(e,t){return Fe.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new rI(this)}getSize(e){return Fe.resolve(this.size)}}class rI extends QA{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,l)=>{l.isValidDocument()?t.push(this.Mr.addEntry(e,l)):this.Mr.removeEntry(i)})),Fe.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class aI{constructor(e){this.persistence=e,this.ri=new il((t=>uy(t)),dy),this.lastRemoteSnapshotVersion=ts.min(),this.highestTargetId=0,this.ii=0,this.si=new gy,this.targetCount=0,this.oi=rc._r()}forEachTarget(e,t){return this.ri.forEach(((i,l)=>t(l))),Fe.resolve()}getLastRemoteSnapshotVersion(e){return Fe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Fe.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),Fe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),Fe.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new rc(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,Fe.resolve()}updateTargetData(e,t){return this.lr(t),Fe.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,Fe.resolve()}removeTargets(e,t,i){let l=0;const u=[];return this.ri.forEach(((d,p)=>{p.sequenceNumber<=t&&i.get(p.targetId)===null&&(this.ri.delete(d),u.push(this.removeMatchingKeysForTargetId(e,p.targetId)),l++)})),Fe.waitFor(u).next((()=>l))}getTargetCount(e){return Fe.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return Fe.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),Fe.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const l=this.persistence.referenceDelegate,u=[];return l&&t.forEach((d=>{u.push(l.markPotentiallyOrphaned(e,d))})),Fe.waitFor(u)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),Fe.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return Fe.resolve(i)}containsKey(e,t){return Fe.resolve(this.si.containsKey(t))}}class Q_{constructor(e,t){this._i={},this.overlays={},this.ai=new om(0),this.ui=!1,this.ui=!0,this.ci=new tI,this.referenceDelegate=e(this),this.li=new aI(this),this.indexManager=new qA,this.remoteDocumentCache=(function(l){return new nI(l)})((i=>this.referenceDelegate.hi(i))),this.serializer=new FA(t),this.Pi=new ZA(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new eI,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new sI(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){xt("MemoryPersistence","Starting transaction:",e);const l=new iI(this.ai.next());return this.referenceDelegate.Ti(),i(l).next((u=>this.referenceDelegate.Ii(l).next((()=>u)))).toPromise().then((u=>(l.raiseOnCommittedEvent(),u)))}Ei(e,t){return Fe.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class iI extends IR{constructor(e){super(),this.currentSequenceNumber=e}}class yy{constructor(e){this.persistence=e,this.Ri=new gy,this.Ai=null}static Vi(e){return new yy(e)}get di(){if(this.Ai)return this.Ai;throw Gt(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),Fe.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),Fe.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),Fe.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((l=>this.di.add(l.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((l=>{l.forEach((u=>this.di.add(u.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Fe.forEach(this.di,(i=>{const l=Lt.fromPath(i);return this.mi(e,l).next((u=>{u||t.removeEntry(l,ts.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return Fe.or([()=>Fe.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class $h{constructor(e,t){this.persistence=e,this.fi=new il((i=>PR(i.path)),((i,l)=>i.isEqual(l))),this.garbageCollector=YA(this,t)}static Vi(e,t){return new $h(e,t)}Ti(){}Ii(e){return Fe.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((l=>i+l))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return Fe.forEach(this.fi,((i,l)=>this.wr(e,i,l).next((u=>u?Fe.resolve():t(l)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const l=this.persistence.getRemoteDocumentCache(),u=l.newChangeBuffer();return l.ni(e,(d=>this.wr(e,d,t).next((p=>{p||(i++,u.removeEntry(d,ts.min()))})))).next((()=>u.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),Fe.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Fe.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Fe.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),Fe.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=kh(e.data.value)),t}wr(e,t,i){return Fe.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const l=this.fi.get(t);return Fe.resolve(l!==void 0&&l>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class by{constructor(e,t,i,l){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=l}static Es(e,t){let i=Ts(),l=Ts();for(const u of t.docChanges)switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:l=l.add(u.doc.key)}return new by(e,t.fromCache,i,l)}}class oI{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class lI{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return PN()?8:MR(xr())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,l){const u={result:null};return this.gs(e,t).next((d=>{u.result=d})).next((()=>{if(!u.result)return this.ps(e,t,l,i).next((d=>{u.result=d}))})).next((()=>{if(u.result)return;const d=new oI;return this.ys(e,t,d).next((p=>{if(u.result=p,this.As)return this.ws(e,t,d,p.size)}))})).next((()=>u.result))}ws(e,t,i,l){return i.documentReadCount<this.Vs?(Hl()<=ks.DEBUG&&xt("QueryEngine","SDK will not create cache indexes for query:",$l(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Fe.resolve()):(Hl()<=ks.DEBUG&&xt("QueryEngine","Query:",$l(t),"scans",i.documentReadCount,"local documents and returns",l,"documents as results."),i.documentReadCount>this.ds*l?(Hl()<=ks.DEBUG&&xt("QueryEngine","The SDK decides to create cache indexes for query:",$l(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,$a(t))):Fe.resolve())}gs(e,t){if(Dx(t))return Fe.resolve(null);let i=$a(t);return this.indexManager.getIndexType(e,i).next((l=>l===0?null:(t.limit!==null&&l===1&&(t=qh(t,null,"F"),i=$a(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((u=>{const d=Ts(...u);return this.fs.getDocuments(e,d).next((p=>this.indexManager.getMinOffset(e,i).next((g=>{const y=this.bs(t,p);return this.Ss(t,y,d,g.readTime)?this.gs(e,qh(t,null,"F")):this.Ds(e,y,t,g)}))))})))))}ps(e,t,i,l){return Dx(t)||l.isEqual(ts.min())?Fe.resolve(null):this.fs.getDocuments(e,i).next((u=>{const d=this.bs(t,u);return this.Ss(t,d,i,l)?Fe.resolve(null):(Hl()<=ks.DEBUG&&xt("QueryEngine","Re-using previous result from %s to execute query: %s",l.toString(),$l(t)),this.Ds(e,d,t,SR(l,ju)).next((p=>p)))}))}bs(e,t){let i=new Gn(T_(e));return t.forEach(((l,u)=>{hm(e,u)&&(i=i.add(u))})),i}Ss(e,t,i,l){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const u=e.limitType==="F"?t.last():t.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(l)>0)}ys(e,t,i){return Hl()<=ks.DEBUG&&xt("QueryEngine","Using full collection scan to execute query:",$l(t)),this.fs.getDocumentsMatchingQuery(e,t,ho.min(),i)}Ds(e,t,i,l){return this.fs.getDocumentsMatchingQuery(e,i,l).next((u=>(t.forEach((d=>{u=u.insert(d.key,d)})),u)))}}const vy="LocalStore",cI=3e8;class uI{constructor(e,t,i,l){this.persistence=e,this.Cs=t,this.serializer=l,this.vs=new bn(js),this.Fs=new il((u=>uy(u)),dy),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new JA(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function dI(n,e,t,i){return new uI(n,e,t,i)}async function X_(n,e){const t=rs(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let l;return t.mutationQueue.getAllMutationBatches(i).next((u=>(l=u,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((u=>{const d=[],p=[];let g=Ts();for(const y of l){d.push(y.batchId);for(const x of y.mutations)g=g.add(x.key)}for(const y of u){p.push(y.batchId);for(const x of y.mutations)g=g.add(x.key)}return t.localDocuments.getDocuments(i,g).next((y=>({Ns:y,removedBatchIds:d,addedBatchIds:p})))}))}))}function hI(n,e){const t=rs(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const l=e.batch.keys(),u=t.xs.newChangeBuffer({trackRemovals:!0});return(function(p,g,y,x){const _=y.batch,j=_.keys();let O=Fe.resolve();return j.forEach(($=>{O=O.next((()=>x.getEntry(g,$))).next((V=>{const L=y.docVersions.get($);Gs(L!==null,48541),V.version.compareTo(L)<0&&(_.applyToRemoteDocument(V,y),V.isValidDocument()&&(V.setReadTime(y.commitVersion),x.addEntry(V)))}))})),O.next((()=>p.mutationQueue.removeMutationBatch(g,_)))})(t,i,e,u).next((()=>u.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,l,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(p){let g=Ts();for(let y=0;y<p.mutationResults.length;++y)p.mutationResults[y].transformResults.length>0&&(g=g.add(p.batch.mutations[y].key));return g})(e)))).next((()=>t.localDocuments.getDocuments(i,l)))}))}function J_(n){const e=rs(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function mI(n,e){const t=rs(n),i=e.snapshotVersion;let l=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const d=t.xs.newChangeBuffer({trackRemovals:!0});l=t.vs;const p=[];e.targetChanges.forEach(((x,_)=>{const j=l.get(_);if(!j)return;p.push(t.li.removeMatchingKeys(u,x.removedDocuments,_).next((()=>t.li.addMatchingKeys(u,x.addedDocuments,_))));let O=j.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(_)!==null?O=O.withResumeToken(dr.EMPTY_BYTE_STRING,ts.min()).withLastLimboFreeSnapshotVersion(ts.min()):x.resumeToken.approximateByteSize()>0&&(O=O.withResumeToken(x.resumeToken,i)),l=l.insert(_,O),(function(V,L,ee){return V.resumeToken.approximateByteSize()===0||L.snapshotVersion.toMicroseconds()-V.snapshotVersion.toMicroseconds()>=cI?!0:ee.addedDocuments.size+ee.modifiedDocuments.size+ee.removedDocuments.size>0})(j,O,x)&&p.push(t.li.updateTargetData(u,O))}));let g=Ti(),y=Ts();if(e.documentUpdates.forEach((x=>{e.resolvedLimboDocuments.has(x)&&p.push(t.persistence.referenceDelegate.updateLimboDocument(u,x))})),p.push(fI(u,d,e.documentUpdates).next((x=>{g=x.Bs,y=x.Ls}))),!i.isEqual(ts.min())){const x=t.li.getLastRemoteSnapshotVersion(u).next((_=>t.li.setTargetsMetadata(u,u.currentSequenceNumber,i)));p.push(x)}return Fe.waitFor(p).next((()=>d.apply(u))).next((()=>t.localDocuments.getLocalViewOfDocuments(u,g,y))).next((()=>g))})).then((u=>(t.vs=l,u)))}function fI(n,e,t){let i=Ts(),l=Ts();return t.forEach((u=>i=i.add(u))),e.getEntries(n,i).next((u=>{let d=Ti();return t.forEach(((p,g)=>{const y=u.get(p);g.isFoundDocument()!==y.isFoundDocument()&&(l=l.add(p)),g.isNoDocument()&&g.version.isEqual(ts.min())?(e.removeEntry(p,g.readTime),d=d.insert(p,g)):!y.isValidDocument()||g.version.compareTo(y.version)>0||g.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(g),d=d.insert(p,g)):xt(vy,"Ignoring outdated watch update for ",p,". Current version:",y.version," Watch version:",g.version)})),{Bs:d,Ls:l}}))}function pI(n,e){const t=rs(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=oy),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function gI(n,e){const t=rs(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let l;return t.li.getTargetData(i,e).next((u=>u?(l=u,Fe.resolve(l)):t.li.allocateTargetId(i).next((d=>(l=new ro(e,d,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,l).next((()=>l)))))))})).then((i=>{const l=t.vs.get(i.targetId);return(l===null||i.snapshotVersion.compareTo(l.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function Ng(n,e,t){const i=rs(n),l=i.vs.get(e),u=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",u,(d=>i.persistence.referenceDelegate.removeTarget(d,l)))}catch(d){if(!hc(d))throw d;xt(vy,`Failed to update sequence numbers for target ${e}: ${d}`)}i.vs=i.vs.remove(e),i.Fs.delete(l.target)}function Gx(n,e,t){const i=rs(n);let l=ts.min(),u=Ts();return i.persistence.runTransaction("Execute query","readwrite",(d=>(function(g,y,x){const _=rs(g),j=_.Fs.get(x);return j!==void 0?Fe.resolve(_.vs.get(j)):_.li.getTargetData(y,x)})(i,d,$a(e)).next((p=>{if(p)return l=p.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(d,p.targetId).next((g=>{u=g}))})).next((()=>i.Cs.getDocumentsMatchingQuery(d,e,t?l:ts.min(),t?u:Ts()))).next((p=>(yI(i,nA(e),p),{documents:p,ks:u})))))}function yI(n,e,t){let i=n.Ms.get(e)||ts.min();t.forEach(((l,u)=>{u.readTime.compareTo(i)>0&&(i=u.readTime)})),n.Ms.set(e,i)}class Kx{constructor(){this.activeTargetIds=cA()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class bI{constructor(){this.vo=new Kx,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new Kx,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class vI{Mo(e){}shutdown(){}}const Yx="ConnectivityMonitor";class Qx{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){xt(Yx,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){xt(Yx,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let oh=null;function Sg(){return oh===null?oh=(function(){return 268435456+Math.round(2147483648*Math.random())})():oh++,"0x"+oh.toString(16)}const Bp="RestConnection",xI={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class wI{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),l=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${l}`,this.$o=this.databaseId.database===Uh?`project_id=${i}`:`project_id=${i}&database_id=${l}`}Wo(e,t,i,l,u){const d=Sg(),p=this.Qo(e,t.toUriEncodedString());xt(Bp,`Sending RPC '${e}' ${d}:`,p,i);const g={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(g,l,u);const{host:y}=new URL(p),x=bo(y);return this.zo(e,p,g,i,x).then((_=>(xt(Bp,`Received RPC '${e}' ${d}: `,_),_)),(_=>{throw ec(Bp,`RPC '${e}' ${d} failed with error: `,_,"url: ",p,"request:",i),_}))}jo(e,t,i,l,u,d){return this.Wo(e,t,i,l,u)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+uc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((l,u)=>e[u]=l)),i&&i.headers.forEach(((l,u)=>e[u]=l))}Qo(e,t){const i=xI[e];let l=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(l=`${l}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),l}terminate(){}}class _I{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const gr="WebChannelConnection",tu=(n,e,t)=>{n.listen(e,(i=>{try{t(i)}catch(l){setTimeout((()=>{throw l}),0)}}))};class Jl extends wI{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Jl.c_){const e=t_();tu(e,e_.STAT_EVENT,(t=>{t.stat===gg.PROXY?xt(gr,"STAT_EVENT: detected buffering proxy"):t.stat===gg.NOPROXY&&xt(gr,"STAT_EVENT: detected no buffering proxy")})),Jl.c_=!0}}zo(e,t,i,l,u){const d=Sg();return new Promise(((p,g)=>{const y=new Jw;y.setWithCredentials(!0),y.listenOnce(Zw.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case _h.NO_ERROR:const _=y.getResponseJson();xt(gr,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(_)),p(_);break;case _h.TIMEOUT:xt(gr,`RPC '${e}' ${d} timed out`),g(new ct(Pe.DEADLINE_EXCEEDED,"Request time out"));break;case _h.HTTP_ERROR:const j=y.getStatus();if(xt(gr,`RPC '${e}' ${d} failed with status:`,j,"response text:",y.getResponseText()),j>0){let O=y.getResponseJson();Array.isArray(O)&&(O=O[0]);const $=O?.error;if($&&$.status&&$.message){const V=(function(ee){const Y=ee.toLowerCase().replace(/_/g,"-");return Object.values(Pe).indexOf(Y)>=0?Y:Pe.UNKNOWN})($.status);g(new ct(V,$.message))}else g(new ct(Pe.UNKNOWN,"Server responded with status "+y.getStatus()))}else g(new ct(Pe.UNAVAILABLE,"Connection failed."));break;default:Gt(9055,{l_:e,streamId:d,h_:y.getLastErrorCode(),P_:y.getLastError()})}}finally{xt(gr,`RPC '${e}' ${d} completed.`)}}));const x=JSON.stringify(l);xt(gr,`RPC '${e}' ${d} sending request:`,l),y.send(t,"POST",x,i,15)}))}T_(e,t,i){const l=Sg(),u=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=this.createWebChannelTransport(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(p.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Go(p.initMessageHeaders,t,i),p.encodeInitMessageHeaders=!0;const y=u.join("");xt(gr,`Creating RPC '${e}' stream ${l}: ${y}`,p);const x=d.createWebChannel(y,p);this.I_(x);let _=!1,j=!1;const O=new _I({Ho:$=>{j?xt(gr,`Not sending because RPC '${e}' stream ${l} is closed:`,$):(_||(xt(gr,`Opening RPC '${e}' stream ${l} transport.`),x.open(),_=!0),xt(gr,`RPC '${e}' stream ${l} sending:`,$),x.send($))},Jo:()=>x.close()});return tu(x,cu.EventType.OPEN,(()=>{j||(xt(gr,`RPC '${e}' stream ${l} transport opened.`),O.i_())})),tu(x,cu.EventType.CLOSE,(()=>{j||(j=!0,xt(gr,`RPC '${e}' stream ${l} transport closed`),O.o_(),this.E_(x))})),tu(x,cu.EventType.ERROR,($=>{j||(j=!0,ec(gr,`RPC '${e}' stream ${l} transport errored. Name:`,$.name,"Message:",$.message),O.o_(new ct(Pe.UNAVAILABLE,"The operation could not be completed")))})),tu(x,cu.EventType.MESSAGE,($=>{if(!j){const V=$.data[0];Gs(!!V,16349);const L=V,ee=L?.error||L[0]?.error;if(ee){xt(gr,`RPC '${e}' stream ${l} received error:`,ee);const Y=ee.status;let te=(function(xe){const R=Vn[xe];if(R!==void 0)return B_(R)})(Y),ke=ee.message;te===void 0&&(te=Pe.INTERNAL,ke="Unknown error status: "+Y+" with message "+ee.message),j=!0,O.o_(new ct(te,ke)),x.close()}else xt(gr,`RPC '${e}' stream ${l} received:`,V),O.__(V)}})),Jl.u_(),setTimeout((()=>{O.s_()}),0),O}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return s_()}}function kI(n){return new Jl(n)}function Vp(){return typeof document<"u"?document:null}function ym(n){return new NA(n,!0)}Jl.c_=!1;class Z_{constructor(e,t,i=1e3,l=1.5,u=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=l,this.V_=u,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),l=Math.max(0,t-i);l>0&&xt("ExponentialBackoff",`Backing off for ${l} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,l,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const Xx="PersistentStream";class ek{constructor(e,t,i,l,u,d,p,g){this.Ci=e,this.b_=i,this.S_=l,this.connection=u,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=p,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Z_(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Pe.RESOURCE_EXHAUSTED?(ji(t.toString()),ji("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Pe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,l])=>{this.D_===t&&this.G_(i,l)}),(i=>{e((()=>{const l=new ct(Pe.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(l)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((l=>{i((()=>this.z_(l)))})),this.stream.onMessage((l=>{i((()=>++this.F_==1?this.H_(l):this.onNext(l)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return xt(Xx,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(xt(Xx,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class jI extends ek{constructor(e,t,i,l,u,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=RA(this.serializer,e),i=(function(u){if(!("targetChange"in u))return ts.min();const d=u.targetChange;return d.targetIds&&d.targetIds.length?ts.min():d.readTime?Wa(d.readTime):ts.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=Eg(this.serializer),t.addTarget=(function(u,d){let p;const g=d.target;if(p=wg(g)?{documents:MA(u,g)}:{query:DA(u,g).ft},p.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){p.resumeToken=F_(u,d.resumeToken);const y=kg(u,d.expectedCount);y!==null&&(p.expectedCount=y)}else if(d.snapshotVersion.compareTo(ts.min())>0){p.readTime=Hh(u,d.snapshotVersion.toTimestamp());const y=kg(u,d.expectedCount);y!==null&&(p.expectedCount=y)}return p})(this.serializer,e);const i=LA(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=Eg(this.serializer),t.removeTarget=e,this.K_(t)}}class TI extends ek{constructor(e,t,i,l,u,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return Gs(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Gs(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Gs(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=IA(e.writeResults,e.commitTime),i=Wa(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=Eg(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>AA(this.serializer,i)))};this.K_(t)}}class EI{}class NI extends EI{constructor(e,t,i,l){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=l,this.ia=!1}sa(){if(this.ia)throw new ct(Pe.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,d])=>this.connection.Wo(e,jg(t,i),l,u,d))).catch((u=>{throw u.name==="FirebaseError"?(u.code===Pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new ct(Pe.UNKNOWN,u.toString())}))}jo(e,t,i,l,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,p])=>this.connection.jo(e,jg(t,i),l,d,p,u))).catch((d=>{throw d.name==="FirebaseError"?(d.code===Pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new ct(Pe.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function SI(n,e,t,i){return new NI(n,e,t,i)}class CI{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ji(t),this.aa=!1):xt("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const sl="RemoteStore";class RI{constructor(e,t,i,l,u){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=u,this.Aa.Mo((d=>{i.enqueueAndForget((async()=>{ol(this)&&(xt(sl,"Restarting streams for network reachability change."),await(async function(g){const y=rs(g);y.Ea.add(4),await Hu(y),y.Va.set("Unknown"),y.Ea.delete(4),await bm(y)})(this))}))})),this.Va=new CI(i,l)}}async function bm(n){if(ol(n))for(const e of n.Ra)await e(!0)}async function Hu(n){for(const e of n.Ra)await e(!1)}function tk(n,e){const t=rs(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),ky(t)?_y(t):fc(t).O_()&&wy(t,e))}function xy(n,e){const t=rs(n),i=fc(t);t.Ia.delete(e),i.O_()&&sk(t,e),t.Ia.size===0&&(i.O_()?i.L_():ol(t)&&t.Va.set("Unknown"))}function wy(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ts.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}fc(n).Z_(e)}function sk(n,e){n.da.$e(e),fc(n).X_(e)}function _y(n){n.da=new kA({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),fc(n).start(),n.Va.ua()}function ky(n){return ol(n)&&!fc(n).x_()&&n.Ia.size>0}function ol(n){return rs(n).Ea.size===0}function nk(n){n.da=void 0}async function AI(n){n.Va.set("Online")}async function II(n){n.Ia.forEach(((e,t)=>{wy(n,e)}))}async function MI(n,e){nk(n),ky(n)?(n.Va.ha(e),_y(n)):n.Va.set("Unknown")}async function DI(n,e,t){if(n.Va.set("Online"),e instanceof U_&&e.state===2&&e.cause)try{await(async function(l,u){const d=u.cause;for(const p of u.targetIds)l.Ia.has(p)&&(await l.remoteSyncer.rejectListen(p,d),l.Ia.delete(p),l.da.removeTarget(p))})(n,e)}catch(i){xt(sl,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Wh(n,i)}else if(e instanceof Eh?n.da.Xe(e):e instanceof V_?n.da.st(e):n.da.tt(e),!t.isEqual(ts.min()))try{const i=await J_(n.localStore);t.compareTo(i)>=0&&await(function(u,d){const p=u.da.Tt(d);return p.targetChanges.forEach(((g,y)=>{if(g.resumeToken.approximateByteSize()>0){const x=u.Ia.get(y);x&&u.Ia.set(y,x.withResumeToken(g.resumeToken,d))}})),p.targetMismatches.forEach(((g,y)=>{const x=u.Ia.get(g);if(!x)return;u.Ia.set(g,x.withResumeToken(dr.EMPTY_BYTE_STRING,x.snapshotVersion)),sk(u,g);const _=new ro(x.target,g,y,x.sequenceNumber);wy(u,_)})),u.remoteSyncer.applyRemoteEvent(p)})(n,t)}catch(i){xt(sl,"Failed to raise snapshot:",i),await Wh(n,i)}}async function Wh(n,e,t){if(!hc(e))throw e;n.Ea.add(1),await Hu(n),n.Va.set("Offline"),t||(t=()=>J_(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{xt(sl,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await bm(n)}))}function rk(n,e){return e().catch((t=>Wh(n,t,e)))}async function vm(n){const e=rs(n),t=go(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:oy;for(;PI(e);)try{const l=await pI(e.localStore,i);if(l===null){e.Ta.length===0&&t.L_();break}i=l.batchId,LI(e,l)}catch(l){await Wh(e,l)}ak(e)&&ik(e)}function PI(n){return ol(n)&&n.Ta.length<10}function LI(n,e){n.Ta.push(e);const t=go(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function ak(n){return ol(n)&&!go(n).x_()&&n.Ta.length>0}function ik(n){go(n).start()}async function OI(n){go(n).ra()}async function BI(n){const e=go(n);for(const t of n.Ta)e.ea(t.mutations)}async function VI(n,e,t){const i=n.Ta.shift(),l=my.from(i,e,t);await rk(n,(()=>n.remoteSyncer.applySuccessfulWrite(l))),await vm(n)}async function UI(n,e){e&&go(n).Y_&&await(async function(i,l){if((function(d){return xA(d)&&d!==Pe.ABORTED})(l.code)){const u=i.Ta.shift();go(i).B_(),await rk(i,(()=>i.remoteSyncer.rejectFailedWrite(u.batchId,l))),await vm(i)}})(n,e),ak(n)&&ik(n)}async function Jx(n,e){const t=rs(n);t.asyncQueue.verifyOperationInProgress(),xt(sl,"RemoteStore received new credentials");const i=ol(t);t.Ea.add(3),await Hu(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await bm(t)}async function FI(n,e){const t=rs(n);e?(t.Ea.delete(2),await bm(t)):e||(t.Ea.add(2),await Hu(t),t.Va.set("Unknown"))}function fc(n){return n.ma||(n.ma=(function(t,i,l){const u=rs(t);return u.sa(),new jI(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(n.datastore,n.asyncQueue,{Zo:AI.bind(null,n),Yo:II.bind(null,n),t_:MI.bind(null,n),J_:DI.bind(null,n)}),n.Ra.push((async e=>{e?(n.ma.B_(),ky(n)?_y(n):n.Va.set("Unknown")):(await n.ma.stop(),nk(n))}))),n.ma}function go(n){return n.fa||(n.fa=(function(t,i,l){const u=rs(t);return u.sa(),new TI(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:OI.bind(null,n),t_:UI.bind(null,n),ta:BI.bind(null,n),na:VI.bind(null,n)}),n.Ra.push((async e=>{e?(n.fa.B_(),await vm(n)):(await n.fa.stop(),n.Ta.length>0&&(xt(sl,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class jy{constructor(e,t,i,l,u){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=l,this.removalCallback=u,this.deferred=new xi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,l,u){const d=Date.now()+i,p=new jy(e,t,d,l,u);return p.start(i),p}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ct(Pe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ty(n,e){if(ji("AsyncQueue",`${e}: ${n}`),hc(n))return new ct(Pe.UNAVAILABLE,`${e}: ${n}`);throw n}class Zl{static emptySet(e){return new Zl(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Lt.comparator(t.key,i.key):(t,i)=>Lt.comparator(t.key,i.key),this.keyedMap=uu(),this.sortedSet=new bn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Zl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(!l.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Zl;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class Zx{constructor(){this.ga=new bn(Lt.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Gt(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class ac{constructor(e,t,i,l,u,d,p,g,y){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=l,this.mutatedKeys=u,this.fromCache=d,this.syncStateChanged=p,this.excludesMetadataChanges=g,this.hasCachedResults=y}static fromInitialDocuments(e,t,i,l,u){const d=[];return t.forEach((p=>{d.push({type:0,doc:p})})),new ac(e,t,Zl.emptySet(t),d,i,l,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&dm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let l=0;l<t.length;l++)if(t[l].type!==i[l].type||!t[l].doc.isEqual(i[l].doc))return!1;return!0}}class zI{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class qI{constructor(){this.queries=e2(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const l=rs(t),u=l.queries;l.queries=e2(),u.forEach(((d,p)=>{for(const g of p.ba)g.onError(i)}))})(this,new ct(Pe.ABORTED,"Firestore shutting down"))}}function e2(){return new il((n=>j_(n)),dm)}async function Ey(n,e){const t=rs(n);let i=3;const l=e.query;let u=t.queries.get(l);u?!u.Sa()&&e.Da()&&(i=2):(u=new zI,i=e.Da()?0:1);try{switch(i){case 0:u.wa=await t.onListen(l,!0);break;case 1:u.wa=await t.onListen(l,!1);break;case 2:await t.onFirstRemoteStoreListen(l)}}catch(d){const p=Ty(d,`Initialization of query '${$l(e.query)}' failed`);return void e.onError(p)}t.queries.set(l,u),u.ba.push(e),e.va(t.onlineState),u.wa&&e.Fa(u.wa)&&Sy(t)}async function Ny(n,e){const t=rs(n),i=e.query;let l=3;const u=t.queries.get(i);if(u){const d=u.ba.indexOf(e);d>=0&&(u.ba.splice(d,1),u.ba.length===0?l=e.Da()?0:1:!u.Sa()&&e.Da()&&(l=2))}switch(l){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function HI(n,e){const t=rs(n);let i=!1;for(const l of e){const u=l.query,d=t.queries.get(u);if(d){for(const p of d.ba)p.Fa(l)&&(i=!0);d.wa=l}}i&&Sy(t)}function $I(n,e,t){const i=rs(n),l=i.queries.get(e);if(l)for(const u of l.ba)u.onError(t);i.queries.delete(e)}function Sy(n){n.Ca.forEach((e=>{e.next()}))}var Cg,t2;(t2=Cg||(Cg={})).Ma="default",t2.Cache="cache";class Cy{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const l of e.docChanges)l.type!==3&&i.push(l);e=new ac(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=ac.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Cg.Cache}}class ok{constructor(e){this.key=e}}class lk{constructor(e){this.key=e}}class WI{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Ts(),this.mutatedKeys=Ts(),this.eu=T_(e),this.tu=new Zl(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new Zx,l=t?t.tu:this.tu;let u=t?t.mutatedKeys:this.mutatedKeys,d=l,p=!1;const g=this.query.limitType==="F"&&l.size===this.query.limit?l.last():null,y=this.query.limitType==="L"&&l.size===this.query.limit?l.first():null;if(e.inorderTraversal(((x,_)=>{const j=l.get(x),O=hm(this.query,_)?_:null,$=!!j&&this.mutatedKeys.has(j.key),V=!!O&&(O.hasLocalMutations||this.mutatedKeys.has(O.key)&&O.hasCommittedMutations);let L=!1;j&&O?j.data.isEqual(O.data)?$!==V&&(i.track({type:3,doc:O}),L=!0):this.su(j,O)||(i.track({type:2,doc:O}),L=!0,(g&&this.eu(O,g)>0||y&&this.eu(O,y)<0)&&(p=!0)):!j&&O?(i.track({type:0,doc:O}),L=!0):j&&!O&&(i.track({type:1,doc:j}),L=!0,(g||y)&&(p=!0)),L&&(O?(d=d.add(O),u=V?u.add(x):u.delete(x)):(d=d.delete(x),u=u.delete(x)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const x=this.query.limitType==="F"?d.last():d.first();d=d.delete(x.key),u=u.delete(x.key),i.track({type:1,doc:x})}return{tu:d,iu:i,Ss:p,mutatedKeys:u}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,l){const u=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((x,_)=>(function(O,$){const V=L=>{switch(L){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Gt(20277,{Vt:L})}};return V(O)-V($)})(x.type,_.type)||this.eu(x.doc,_.doc))),this.ou(i),l=l??!1;const p=t&&!l?this._u():[],g=this.Ya.size===0&&this.current&&!l?1:0,y=g!==this.Xa;return this.Xa=g,d.length!==0||y?{snapshot:new ac(this.query,e.tu,u,d,e.mutatedKeys,g===0,y,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:p}:{au:p}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Zx,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=Ts(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new lk(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new ok(i))})),t}cu(e){this.Za=e.ks,this.Ya=Ts();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return ac.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const Ry="SyncEngine";class GI{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class KI{constructor(e){this.key=e,this.hu=!1}}class YI{constructor(e,t,i,l,u,d){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=l,this.currentUser=u,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new il((p=>j_(p)),dm),this.Iu=new Map,this.Eu=new Set,this.Ru=new bn(Lt.comparator),this.Au=new Map,this.Vu=new gy,this.du={},this.mu=new Map,this.fu=rc.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function QI(n,e,t=!0){const i=fk(n);let l;const u=i.Tu.get(e);return u?(i.sharedClientState.addLocalQueryTarget(u.targetId),l=u.view.lu()):l=await ck(i,e,t,!0),l}async function XI(n,e){const t=fk(n);await ck(t,e,!0,!1)}async function ck(n,e,t,i){const l=await gI(n.localStore,$a(e)),u=l.targetId,d=n.sharedClientState.addLocalQueryTarget(u,t);let p;return i&&(p=await JI(n,e,u,d==="current",l.resumeToken)),n.isPrimaryClient&&t&&tk(n.remoteStore,l),p}async function JI(n,e,t,i,l){n.pu=(_,j,O)=>(async function(V,L,ee,Y){let te=L.view.ru(ee);te.Ss&&(te=await Gx(V.localStore,L.query,!1).then((({documents:R})=>L.view.ru(R,te))));const ke=Y&&Y.targetChanges.get(L.targetId),Te=Y&&Y.targetMismatches.get(L.targetId)!=null,xe=L.view.applyChanges(te,V.isPrimaryClient,ke,Te);return n2(V,L.targetId,xe.au),xe.snapshot})(n,_,j,O);const u=await Gx(n.localStore,e,!0),d=new WI(e,u.ks),p=d.ru(u.documents),g=qu.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",l),y=d.applyChanges(p,n.isPrimaryClient,g);n2(n,t,y.au);const x=new GI(e,t,d);return n.Tu.set(e,x),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),y.snapshot}async function ZI(n,e,t){const i=rs(n),l=i.Tu.get(e),u=i.Iu.get(l.targetId);if(u.length>1)return i.Iu.set(l.targetId,u.filter((d=>!dm(d,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(l.targetId),i.sharedClientState.isActiveQueryTarget(l.targetId)||await Ng(i.localStore,l.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(l.targetId),t&&xy(i.remoteStore,l.targetId),Rg(i,l.targetId)})).catch(dc)):(Rg(i,l.targetId),await Ng(i.localStore,l.targetId,!0))}async function eM(n,e){const t=rs(n),i=t.Tu.get(e),l=t.Iu.get(i.targetId);t.isPrimaryClient&&l.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),xy(t.remoteStore,i.targetId))}async function tM(n,e,t){const i=lM(n);try{const l=await(function(d,p){const g=rs(d),y=Rt.now(),x=p.reduce(((O,$)=>O.add($.key)),Ts());let _,j;return g.persistence.runTransaction("Locally write mutations","readwrite",(O=>{let $=Ti(),V=Ts();return g.xs.getEntries(O,x).next((L=>{$=L,$.forEach(((ee,Y)=>{Y.isValidDocument()||(V=V.add(ee))}))})).next((()=>g.localDocuments.getOverlayedDocuments(O,$))).next((L=>{_=L;const ee=[];for(const Y of p){const te=pA(Y,_.get(Y.key).overlayedDocument);te!=null&&ee.push(new wo(Y.key,te,g_(te.value.mapValue),Sr.exists(!0)))}return g.mutationQueue.addMutationBatch(O,y,ee,p)})).next((L=>{j=L;const ee=L.applyToLocalDocumentSet(_,V);return g.documentOverlayCache.saveOverlays(O,L.batchId,ee)}))})).then((()=>({batchId:j.batchId,changes:N_(_)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(l.batchId),(function(d,p,g){let y=d.du[d.currentUser.toKey()];y||(y=new bn(js)),y=y.insert(p,g),d.du[d.currentUser.toKey()]=y})(i,l.batchId,t),await $u(i,l.changes),await vm(i.remoteStore)}catch(l){const u=Ty(l,"Failed to persist write");t.reject(u)}}async function uk(n,e){const t=rs(n);try{const i=await mI(t.localStore,e);e.targetChanges.forEach(((l,u)=>{const d=t.Au.get(u);d&&(Gs(l.addedDocuments.size+l.modifiedDocuments.size+l.removedDocuments.size<=1,22616),l.addedDocuments.size>0?d.hu=!0:l.modifiedDocuments.size>0?Gs(d.hu,14607):l.removedDocuments.size>0&&(Gs(d.hu,42227),d.hu=!1))})),await $u(t,i,e)}catch(i){await dc(i)}}function s2(n,e,t){const i=rs(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const l=[];i.Tu.forEach(((u,d)=>{const p=d.view.va(e);p.snapshot&&l.push(p.snapshot)})),(function(d,p){const g=rs(d);g.onlineState=p;let y=!1;g.queries.forEach(((x,_)=>{for(const j of _.ba)j.va(p)&&(y=!0)})),y&&Sy(g)})(i.eventManager,e),l.length&&i.Pu.J_(l),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function sM(n,e,t){const i=rs(n);i.sharedClientState.updateQueryState(e,"rejected",t);const l=i.Au.get(e),u=l&&l.key;if(u){let d=new bn(Lt.comparator);d=d.insert(u,br.newNoDocument(u,ts.min()));const p=Ts().add(u),g=new gm(ts.min(),new Map,new bn(js),d,p);await uk(i,g),i.Ru=i.Ru.remove(u),i.Au.delete(e),Ay(i)}else await Ng(i.localStore,e,!1).then((()=>Rg(i,e,t))).catch(dc)}async function nM(n,e){const t=rs(n),i=e.batch.batchId;try{const l=await hI(t.localStore,e);hk(t,i,null),dk(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await $u(t,l)}catch(l){await dc(l)}}async function rM(n,e,t){const i=rs(n);try{const l=await(function(d,p){const g=rs(d);return g.persistence.runTransaction("Reject batch","readwrite-primary",(y=>{let x;return g.mutationQueue.lookupMutationBatch(y,p).next((_=>(Gs(_!==null,37113),x=_.keys(),g.mutationQueue.removeMutationBatch(y,_)))).next((()=>g.mutationQueue.performConsistencyCheck(y))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(y,x,p))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,x))).next((()=>g.localDocuments.getDocuments(y,x)))}))})(i.localStore,e);hk(i,e,t),dk(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await $u(i,l)}catch(l){await dc(l)}}function dk(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function hk(n,e,t){const i=rs(n);let l=i.du[i.currentUser.toKey()];if(l){const u=l.get(e);u&&(t?u.reject(t):u.resolve(),l=l.remove(e)),i.du[i.currentUser.toKey()]=l}}function Rg(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach((i=>{n.Vu.containsKey(i)||mk(n,i)}))}function mk(n,e){n.Eu.delete(e.path.canonicalString());const t=n.Ru.get(e);t!==null&&(xy(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),Ay(n))}function n2(n,e,t){for(const i of t)i instanceof ok?(n.Vu.addReference(i.key,e),aM(n,i)):i instanceof lk?(xt(Ry,"Document no longer in limbo: "+i.key),n.Vu.removeReference(i.key,e),n.Vu.containsKey(i.key)||mk(n,i.key)):Gt(19791,{wu:i})}function aM(n,e){const t=e.key,i=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(i)||(xt(Ry,"New document in limbo: "+t),n.Eu.add(i),Ay(n))}function Ay(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Lt(ln.fromString(e)),i=n.fu.next();n.Au.set(i,new KI(t)),n.Ru=n.Ru.insert(t,i),tk(n.remoteStore,new ro($a(um(t.path)),i,"TargetPurposeLimboResolution",om.ce))}}async function $u(n,e,t){const i=rs(n),l=[],u=[],d=[];i.Tu.isEmpty()||(i.Tu.forEach(((p,g)=>{d.push(i.pu(g,e,t).then((y=>{if((y||t)&&i.isPrimaryClient){const x=y?!y.fromCache:t?.targetChanges.get(g.targetId)?.current;i.sharedClientState.updateQueryState(g.targetId,x?"current":"not-current")}if(y){l.push(y);const x=by.Es(g.targetId,y);u.push(x)}})))})),await Promise.all(d),i.Pu.J_(l),await(async function(g,y){const x=rs(g);try{await x.persistence.runTransaction("notifyLocalViewChanges","readwrite",(_=>Fe.forEach(y,(j=>Fe.forEach(j.Ts,(O=>x.persistence.referenceDelegate.addReference(_,j.targetId,O))).next((()=>Fe.forEach(j.Is,(O=>x.persistence.referenceDelegate.removeReference(_,j.targetId,O)))))))))}catch(_){if(!hc(_))throw _;xt(vy,"Failed to update sequence numbers: "+_)}for(const _ of y){const j=_.targetId;if(!_.fromCache){const O=x.vs.get(j),$=O.snapshotVersion,V=O.withLastLimboFreeSnapshotVersion($);x.vs=x.vs.insert(j,V)}}})(i.localStore,u))}async function iM(n,e){const t=rs(n);if(!t.currentUser.isEqual(e)){xt(Ry,"User change. New user:",e.toKey());const i=await X_(t.localStore,e);t.currentUser=e,(function(u,d){u.mu.forEach((p=>{p.forEach((g=>{g.reject(new ct(Pe.CANCELLED,d))}))})),u.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await $u(t,i.Ns)}}function oM(n,e){const t=rs(n),i=t.Au.get(e);if(i&&i.hu)return Ts().add(i.key);{let l=Ts();const u=t.Iu.get(e);if(!u)return l;for(const d of u){const p=t.Tu.get(d);l=l.unionWith(p.view.nu)}return l}}function fk(n){const e=rs(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=uk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=oM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=sM.bind(null,e),e.Pu.J_=HI.bind(null,e.eventManager),e.Pu.yu=$I.bind(null,e.eventManager),e}function lM(n){const e=rs(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=nM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=rM.bind(null,e),e}class Gh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ym(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return dI(this.persistence,new lI,e.initialUser,this.serializer)}Cu(e){return new Q_(yy.Vi,this.serializer)}Du(e){return new bI}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Gh.provider={build:()=>new Gh};class cM extends Gh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Gs(this.persistence.referenceDelegate instanceof $h,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new GA(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?zr.withCacheSize(this.cacheSizeBytes):zr.DEFAULT;return new Q_((i=>$h.Vi(i,t)),this.serializer)}}class Ag{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>s2(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=iM.bind(null,this.syncEngine),await FI(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new qI})()}createDatastore(e){const t=ym(e.databaseInfo.databaseId),i=kI(e.databaseInfo);return SI(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,l,u,d,p){return new RI(i,l,u,d,p)})(this.localStore,this.datastore,e.asyncQueue,(t=>s2(this.syncEngine,t,0)),(function(){return Qx.v()?new Qx:new vI})())}createSyncEngine(e,t){return(function(l,u,d,p,g,y,x){const _=new YI(l,u,d,p,g,y);return x&&(_.gu=!0),_})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=rs(t);xt(sl,"RemoteStore shutting down."),i.Ea.add(5),await Hu(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Ag.provider={build:()=>new Ag};class Iy{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ji("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const yo="FirestoreClient";class uM{constructor(e,t,i,l,u){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=l,this.user=yr.UNAUTHENTICATED,this.clientId=iy.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(i,(async d=>{xt(yo,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(i,(d=>(xt(yo,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new xi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=Ty(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Up(n,e){n.asyncQueue.verifyOperationInProgress(),xt(yo,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async l=>{i.isEqual(l)||(await X_(e.localStore,l),i=l)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function r2(n,e){n.asyncQueue.verifyOperationInProgress();const t=await dM(n);xt(yo,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>Jx(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,l)=>Jx(e.remoteStore,l))),n._onlineComponents=e}async function dM(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){xt(yo,"Using user provided OfflineComponentProvider");try{await Up(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(l){return l.name==="FirebaseError"?l.code===Pe.FAILED_PRECONDITION||l.code===Pe.UNIMPLEMENTED:!(typeof DOMException<"u"&&l instanceof DOMException)||l.code===22||l.code===20||l.code===11})(t))throw t;ec("Error using user provided cache. Falling back to memory cache: "+t),await Up(n,new Gh)}}else xt(yo,"Using default OfflineComponentProvider"),await Up(n,new cM(void 0));return n._offlineComponents}async function pk(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(xt(yo,"Using user provided OnlineComponentProvider"),await r2(n,n._uninitializedComponentsProvider._online)):(xt(yo,"Using default OnlineComponentProvider"),await r2(n,new Ag))),n._onlineComponents}function hM(n){return pk(n).then((e=>e.syncEngine))}async function Kh(n){const e=await pk(n),t=e.eventManager;return t.onListen=QI.bind(null,e.syncEngine),t.onUnlisten=ZI.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=XI.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=eM.bind(null,e.syncEngine),t}function mM(n,e,t,i){const l=new Iy(i),u=new Cy(e,l,t);return n.asyncQueue.enqueueAndForget((async()=>Ey(await Kh(n),u))),()=>{l.Nu(),n.asyncQueue.enqueueAndForget((async()=>Ny(await Kh(n),u)))}}function fM(n,e,t={}){const i=new xi;return n.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,y){const x=new Iy({next:j=>{x.Nu(),d.enqueueAndForget((()=>Ny(u,_)));const O=j.docs.has(p);!O&&j.fromCache?y.reject(new ct(Pe.UNAVAILABLE,"Failed to get document because the client is offline.")):O&&j.fromCache&&g&&g.source==="server"?y.reject(new ct(Pe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(j)},error:j=>y.reject(j)}),_=new Cy(um(p.path),x,{includeMetadataChanges:!0,Ka:!0});return Ey(u,_)})(await Kh(n),n.asyncQueue,e,t,i))),i.promise}function pM(n,e,t={}){const i=new xi;return n.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,y){const x=new Iy({next:j=>{x.Nu(),d.enqueueAndForget((()=>Ny(u,_))),j.fromCache&&g.source==="server"?y.reject(new ct(Pe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(j)},error:j=>y.reject(j)}),_=new Cy(p,x,{includeMetadataChanges:!0,Ka:!0});return Ey(u,_)})(await Kh(n),n.asyncQueue,e,t,i))),i.promise}function gM(n,e){const t=new xi;return n.asyncQueue.enqueueAndForget((async()=>tM(await hM(n),e,t))),t.promise}function gk(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const yM="ComponentProvider",a2=new Map;function bM(n,e,t,i,l){return new BR(n,e,t,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,gk(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator,i)}const yk="firestore.googleapis.com",i2=!0;class o2{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ct(Pe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=yk,this.ssl=i2}else this.host=e.host,this.ssl=e.ssl??i2;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Y_;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<$A)throw new ct(Pe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}ER("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=gk(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new ct(Pe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new ct(Pe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new ct(Pe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,l){return i.timeoutSeconds===l.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class xm{constructor(e,t,i,l){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=l,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new o2({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ct(Pe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ct(Pe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new o2(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new gR;switch(i.type){case"firstParty":return new xR(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new ct(Pe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=a2.get(t);i&&(xt(yM,"Removing Datastore"),a2.delete(t),i.terminate())})(this),Promise.resolve()}}function vM(n,e,t,i={}){n=Nr(n,xm);const l=bo(e),u=n._getSettings(),d={...u,emulatorOptions:n._getEmulatorOptions()},p=`${e}:${t}`;l&&(Hg(`https://${p}`),$g("Firestore",!0)),u.host!==yk&&u.host!==p&&ec("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...u,host:p,ssl:l,emulatorOptions:i};if(!Xo(g,d)&&(n._setSettings(g),i.mockUserToken)){let y,x;if(typeof i.mockUserToken=="string")y=i.mockUserToken,x=yr.MOCK_USER;else{y=dw(i.mockUserToken,n._app?.options.projectId);const _=i.mockUserToken.sub||i.mockUserToken.user_id;if(!_)throw new ct(Pe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");x=new yr(_)}n._authCredentials=new yR(new r_(y,x))}}class Si{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Si(this.firestore,e,this._query)}}class jn{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new lo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new jn(this.firestore,e,this._key)}toJSON(){return{type:jn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Fu(t,jn._jsonSchema))return new jn(e,i||null,new Lt(ln.fromString(t.referencePath)))}}jn._jsonSchemaVersion="firestore/documentReference/1.0",jn._jsonSchema={type:Fn("string",jn._jsonSchemaVersion),referencePath:Fn("string")};class lo extends Si{constructor(e,t,i){super(e,t,um(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new jn(this.firestore,null,new Lt(e))}withConverter(e){return new lo(this.firestore,e,this._path)}}function $t(n,e,...t){if(n=sn(n),a_("collection","path",e),n instanceof xm){const i=ln.fromString(e,...t);return xx(i),new lo(n,null,i)}{if(!(n instanceof jn||n instanceof lo))throw new ct(Pe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(ln.fromString(e,...t));return xx(i),new lo(n.firestore,null,i)}}function We(n,e,...t){if(n=sn(n),arguments.length===1&&(e=iy.newId()),a_("doc","path",e),n instanceof xm){const i=ln.fromString(e,...t);return vx(i),new jn(n,null,new Lt(i))}{if(!(n instanceof jn||n instanceof lo))throw new ct(Pe.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(ln.fromString(e,...t));return vx(i),new jn(n.firestore,n instanceof lo?n.converter:null,new Lt(i))}}const l2="AsyncQueue";class c2{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Z_(this,"async_queue_retry"),this._c=()=>{const i=Vp();i&&xt(l2,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Vp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Vp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new xi;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!hc(e))throw e;xt(l2,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,ji("INTERNAL UNHANDLED ERROR: ",u2(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const l=jy.createAndSchedule(this,e,t,i,(u=>this.hc(u)));return this.tc.push(l),l}uc(){this.nc&&Gt(47125,{Pc:u2(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function u2(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Ya extends xm{constructor(e,t,i,l){super(e,t,i,l),this.type="firestore",this._queue=new c2,this._persistenceKey=l?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new c2(e),this._firestoreClient=void 0,await e}}}function xM(n,e){const t=typeof n=="object"?n:Yg(),i=typeof n=="string"?n:Uh,l=sm(t,"firestore").getImmediate({identifier:i});if(!l._initialized){const u=lw("firestore");u&&vM(l,...u)}return l}function Wu(n){if(n._terminated)throw new ct(Pe.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||wM(n),n._firestoreClient}function wM(n){const e=n._freezeSettings(),t=bM(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new uM(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(l){const u=l?._online.build();return{_offline:l?._offline.build(u),_online:u}})(n._componentsProvider))}class ma{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ma(dr.fromBase64String(e))}catch(t){throw new ct(Pe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ma(dr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ma._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Fu(e,ma._jsonSchema))return ma.fromBase64String(e.bytes)}}ma._jsonSchemaVersion="firestore/bytes/1.0",ma._jsonSchema={type:Fn("string",ma._jsonSchemaVersion),bytes:Fn("string")};class wm{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ct(Pe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ur(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Gu{constructor(e){this._methodName=e}}class Ga{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ct(Pe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ct(Pe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return js(this._lat,e._lat)||js(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ga._jsonSchemaVersion}}static fromJSON(e){if(Fu(e,Ga._jsonSchema))return new Ga(e.latitude,e.longitude)}}Ga._jsonSchemaVersion="firestore/geoPoint/1.0",Ga._jsonSchema={type:Fn("string",Ga._jsonSchemaVersion),latitude:Fn("number"),longitude:Fn("number")};class Na{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,l){if(i.length!==l.length)return!1;for(let u=0;u<i.length;++u)if(i[u]!==l[u])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Na._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Fu(e,Na._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Na(e.vectorValues);throw new ct(Pe.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Na._jsonSchemaVersion="firestore/vectorValue/1.0",Na._jsonSchema={type:Fn("string",Na._jsonSchemaVersion),vectorValues:Fn("object")};const _M=/^__.*__$/;class kM{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new wo(e,this.data,this.fieldMask,t,this.fieldTransforms):new zu(e,this.data,t,this.fieldTransforms)}}class bk{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new wo(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function vk(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Gt(40011,{dataSource:n})}}class My{constructor(e,t,i,l,u,d){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=l,u===void 0&&this.validatePath(),this.fieldTransforms=u||[],this.fieldMask=d||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new My({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Yh(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(vk(this.dataSource)&&_M.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class jM{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||ym(e)}createContext(e,t,i,l=!1){return new My({dataSource:e,methodName:t,targetDoc:i,path:ur.emptyPath(),arrayElement:!1,hasConverter:l},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ku(n){const e=n._freezeSettings(),t=ym(n._databaseId);return new jM(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Dy(n,e,t,i,l,u={}){const d=n.createContext(u.merge||u.mergeFields?2:0,e,t,l);Oy("Data must be an object, but it was:",d,i);const p=_k(i,d);let g,y;if(u.merge)g=new ea(d.fieldMask),y=d.fieldTransforms;else if(u.mergeFields){const x=[];for(const _ of u.mergeFields){const j=nl(e,_,t);if(!d.contains(j))throw new ct(Pe.INVALID_ARGUMENT,`Field '${j}' is specified in your field mask but missing from your input data.`);Tk(x,j)||x.push(j)}g=new ea(x),y=d.fieldTransforms.filter((_=>g.covers(_.field)))}else g=null,y=d.fieldTransforms;return new kM(new qr(p),g,y)}class _m extends Gu{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof _m}}class Py extends Gu{_toFieldTransform(e){return new P_(e.path,new Cu)}isEqual(e){return e instanceof Py}}class Ly extends Gu{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new Iu(e.serializer,R_(e.serializer,this.Vc));return new P_(e.path,t)}isEqual(e){return e instanceof Ly&&this.Vc===e.Vc}}function xk(n,e,t,i){const l=n.createContext(1,e,t);Oy("Data must be an object, but it was:",l,i);const u=[],d=qr.empty();xo(i,((g,y)=>{const x=jk(e,g,t);y=sn(y);const _=l.childContextForFieldPath(x);if(y instanceof _m)u.push(x);else{const j=Yu(y,_);j!=null&&(u.push(x),d.set(x,j))}}));const p=new ea(u);return new bk(d,p,l.fieldTransforms)}function wk(n,e,t,i,l,u){const d=n.createContext(1,e,t),p=[nl(e,i,t)],g=[l];if(u.length%2!=0)throw new ct(Pe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let j=0;j<u.length;j+=2)p.push(nl(e,u[j])),g.push(u[j+1]);const y=[],x=qr.empty();for(let j=p.length-1;j>=0;--j)if(!Tk(y,p[j])){const O=p[j];let $=g[j];$=sn($);const V=d.childContextForFieldPath(O);if($ instanceof _m)y.push(O);else{const L=Yu($,V);L!=null&&(y.push(O),x.set(O,L))}}const _=new ea(y);return new bk(x,_,d.fieldTransforms)}function TM(n,e,t,i=!1){return Yu(t,n.createContext(i?4:3,e))}function Yu(n,e){if(kk(n=sn(n)))return Oy("Unsupported field value:",e,n),_k(n,e);if(n instanceof Gu)return(function(i,l){if(!vk(l.dataSource))throw l.createError(`${i._methodName}() can only be used with update() and set()`);if(!l.path)throw l.createError(`${i._methodName}() is not currently supported inside arrays`);const u=i._toFieldTransform(l);u&&l.fieldTransforms.push(u)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,l){const u=[];let d=0;for(const p of i){let g=Yu(p,l.childContextForArray(d));g==null&&(g={nullValue:"NULL_VALUE"}),u.push(g),d++}return{arrayValue:{values:u}}})(n,e)}return(function(i,l){if((i=sn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return R_(l.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const u=Rt.fromDate(i);return{timestampValue:Hh(l.serializer,u)}}if(i instanceof Rt){const u=new Rt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Hh(l.serializer,u)}}if(i instanceof Ga)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof ma)return{bytesValue:F_(l.serializer,i._byteString)};if(i instanceof jn){const u=l.databaseId,d=i.firestore._databaseId;if(!d.isEqual(u))throw l.createError(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:py(i.firestore._databaseId||l.databaseId,i._key.path)}}if(i instanceof Na)return(function(d,p){const g=d instanceof Na?d.toArray():d;return{mapValue:{fields:{[f_]:{stringValue:p_},[Fh]:{arrayValue:{values:g.map((x=>{if(typeof x!="number")throw p.createError("VectorValues must only contain numeric values.");return hy(p.serializer,x)}))}}}}}})(i,l);if(K_(i))return i._toProto(l.serializer);throw l.createError(`Unsupported field value: ${im(i)}`)})(n,e)}function _k(n,e){const t={};return l_(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):xo(n,((i,l)=>{const u=Yu(l,e.childContextForField(i));u!=null&&(t[i]=u)})),{mapValue:{fields:t}}}function kk(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Rt||n instanceof Ga||n instanceof ma||n instanceof jn||n instanceof Gu||n instanceof Na||K_(n))}function Oy(n,e,t){if(!kk(t)||!i_(t)){const i=im(t);throw i==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+i)}}function nl(n,e,t){if((e=sn(e))instanceof wm)return e._internalPath;if(typeof e=="string")return jk(n,e);throw Yh("Field path arguments must be of type string or ",n,!1,void 0,t)}const EM=new RegExp("[~\\*/\\[\\]]");function jk(n,e,t){if(e.search(EM)>=0)throw Yh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new wm(...e.split("."))._internalPath}catch{throw Yh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Yh(n,e,t,i,l){const u=i&&!i.isEmpty(),d=l!==void 0;let p=`Function ${e}() called with invalid data`;t&&(p+=" (via `toFirestore()`)"),p+=". ";let g="";return(u||d)&&(g+=" (found",u&&(g+=` in field ${i}`),d&&(g+=` in document ${l}`),g+=")"),new ct(Pe.INVALID_ARGUMENT,p+n+g)}function Tk(n,e){return n.some((t=>t.isEqual(e)))}class NM{convertValue(e,t="none"){switch(po(e)){case 0:return null;case 1:return e.booleanValue;case 2:return In(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(fo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Gt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return xo(e,((l,u)=>{i[l]=this.convertValue(u,t)})),i}convertVectorValue(e){const t=e.fields?.[Fh].arrayValue?.values?.map((i=>In(i.doubleValue)));return new Na(t)}convertGeoPoint(e){return new Ga(In(e.latitude),In(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=cm(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Tu(e));default:return null}}convertTimestamp(e){const t=mo(e);return new Rt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=ln.fromString(e);Gs(G_(i),9688,{name:e});const l=new Eu(i.get(1),i.get(3)),u=new Lt(i.popFirst(5));return l.isEqual(t)||ji(`Document ${u} contains a document reference within a different database (${l.projectId}/${l.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),u}}class By extends NM{constructor(e){super(),this.firestore=e}convertBytes(e){return new ma(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new jn(this.firestore,null,t)}}function vr(){return new Py("serverTimestamp")}function Go(n){return new Ly("increment",n)}const d2="@firebase/firestore",h2="4.10.0";function m2(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;const l=t;for(const u of i)if(u in l&&typeof l[u]=="function")return!0;return!1})(n,["next","error","complete"])}class Ek{constructor(e,t,i,l,u){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=l,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new jn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new SM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(nl("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class SM extends Ek{data(){return super.data()}}function Nk(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ct(Pe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Vy{}class Uy extends Vy{}function Fs(n,e,...t){let i=[];e instanceof Vy&&i.push(e),i=i.concat(t),(function(u){const d=u.filter((g=>g instanceof Fy)).length,p=u.filter((g=>g instanceof km)).length;if(d>1||d>0&&p>0)throw new ct(Pe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const l of i)n=l._apply(n);return n}class km extends Uy{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new km(e,t,i)}_apply(e){const t=this._parse(e);return Sk(e._query,t),new Si(e.firestore,e.converter,_g(e._query,t))}_parse(e){const t=Ku(e.firestore);return(function(u,d,p,g,y,x,_){let j;if(y.isKeyField()){if(x==="array-contains"||x==="array-contains-any")throw new ct(Pe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${x}' queries on documentId().`);if(x==="in"||x==="not-in"){p2(_,x);const $=[];for(const V of _)$.push(f2(g,u,V));j={arrayValue:{values:$}}}else j=f2(g,u,_)}else x!=="in"&&x!=="not-in"&&x!=="array-contains-any"||p2(_,x),j=TM(p,d,_,x==="in"||x==="not-in");return Un.create(y,x,j)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function bs(n,e,t){const i=e,l=nl("where",n);return km._create(l,i,t)}class Fy extends Vy{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Fy(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:Ca.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(l,u){let d=l;const p=u.getFlattenedFilters();for(const g of p)Sk(d,g),d=_g(d,g)})(e._query,t),new Si(e.firestore,e.converter,_g(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class zy extends Uy{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new zy(e,t)}_apply(e){const t=(function(l,u,d){if(l.startAt!==null)throw new ct(Pe.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(l.endAt!==null)throw new ct(Pe.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Su(u,d)})(e._query,this._field,this._direction);return new Si(e.firestore,e.converter,sA(e._query,t))}}function Qh(n,e="asc"){const t=e,i=nl("orderBy",n);return zy._create(i,t)}class qy extends Uy{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new qy(e,t,i)}_apply(e){return new Si(e.firestore,e.converter,qh(e._query,this._limit,this._limitType))}}function Xh(n){return NR("limit",n),qy._create("limit",n,"F")}function f2(n,e,t){if(typeof(t=sn(t))=="string"){if(t==="")throw new ct(Pe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!k_(e)&&t.indexOf("/")!==-1)throw new ct(Pe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(ln.fromString(t));if(!Lt.isDocumentKey(i))throw new ct(Pe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Sx(n,new Lt(i))}if(t instanceof jn)return Sx(n,t._key);throw new ct(Pe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${im(t)}.`)}function p2(n,e){if(!Array.isArray(n)||n.length===0)throw new ct(Pe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Sk(n,e){const t=(function(l,u){for(const d of l)for(const p of d.getFlattenedFilters())if(u.indexOf(p.op)>=0)return p.op;return null})(n.filters,(function(l){switch(l){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new ct(Pe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ct(Pe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function Hy(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class hu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ko extends Ek{constructor(e,t,i,l,u,d){super(e,t,i,l,d),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Nh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(nl("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ct(Pe.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Ko._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Ko._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ko._jsonSchema={type:Fn("string",Ko._jsonSchemaVersion),bundleSource:Fn("string","DocumentSnapshot"),bundleName:Fn("string"),bundle:Fn("string")};class Nh extends Ko{data(e={}){return super.data(e)}}class Yo{constructor(e,t,i,l){this._firestore=e,this._userDataWriter=t,this._snapshot=l,this.metadata=new hu(l.hasPendingWrites,l.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Nh(this._firestore,this._userDataWriter,i.key,i,new hu(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ct(Pe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(l,u){if(l._snapshot.oldDocs.isEmpty()){let d=0;return l._snapshot.docChanges.map((p=>{const g=new Nh(l._firestore,l._userDataWriter,p.doc.key,p.doc,new hu(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);return p.doc,{type:"added",doc:g,oldIndex:-1,newIndex:d++}}))}{let d=l._snapshot.oldDocs;return l._snapshot.docChanges.filter((p=>u||p.type!==3)).map((p=>{const g=new Nh(l._firestore,l._userDataWriter,p.doc.key,p.doc,new hu(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);let y=-1,x=-1;return p.type!==0&&(y=d.indexOf(p.doc.key),d=d.delete(p.doc.key)),p.type!==1&&(d=d.add(p.doc),x=d.indexOf(p.doc.key)),{type:CM(p.type),doc:g,oldIndex:y,newIndex:x}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ct(Pe.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Yo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=iy.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],l=[];return this.docs.forEach((u=>{u._document!==null&&(t.push(u._document),i.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),l.push(u.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function CM(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Gt(61501,{type:n})}}Yo._jsonSchemaVersion="firestore/querySnapshot/1.0",Yo._jsonSchema={type:Fn("string",Yo._jsonSchemaVersion),bundleSource:Fn("string","QuerySnapshot"),bundleName:Fn("string"),bundle:Fn("string")};class RM{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Ku(e)}set(e,t,i){this._verifyNotCommitted();const l=Fp(e,this._firestore),u=Hy(l.converter,t,i),d=Dy(this._dataReader,"WriteBatch.set",l._key,u,l.converter!==null,i);return this._mutations.push(d.toMutation(l._key,Sr.none())),this}update(e,t,i,...l){this._verifyNotCommitted();const u=Fp(e,this._firestore);let d;return d=typeof(t=sn(t))=="string"||t instanceof wm?wk(this._dataReader,"WriteBatch.update",u._key,t,i,l):xk(this._dataReader,"WriteBatch.update",u._key,t),this._mutations.push(d.toMutation(u._key,Sr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Fp(e,this._firestore);return this._mutations=this._mutations.concat(new pm(t._key,Sr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ct(Pe.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Fp(n,e){if((n=sn(n)).firestore!==e)throw new ct(Pe.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}function Os(n){n=Nr(n,jn);const e=Nr(n.firestore,Ya),t=Wu(e);return fM(t,n._key).then((i=>Rk(e,n,i)))}function Is(n){n=Nr(n,Si);const e=Nr(n.firestore,Ya),t=Wu(e),i=new By(e);return Nk(n._query),pM(t,n._query).then((l=>new Yo(e,i,n,l)))}function Ms(n,e,t){n=Nr(n,jn);const i=Nr(n.firestore,Ya),l=Hy(n.converter,e,t),u=Ku(i);return Qu(i,[Dy(u,"setDoc",n._key,l,n.converter!==null,t).toMutation(n._key,Sr.none())])}function Jr(n,e,t,...i){n=Nr(n,jn);const l=Nr(n.firestore,Ya),u=Ku(l);let d;return d=typeof(e=sn(e))=="string"||e instanceof wm?wk(u,"updateDoc",n._key,e,t,i):xk(u,"updateDoc",n._key,e),Qu(l,[d.toMutation(n._key,Sr.exists(!0))])}function Tr(n){return Qu(Nr(n.firestore,Ya),[new pm(n._key,Sr.none())])}function fa(n,e){const t=Nr(n.firestore,Ya),i=We(n),l=Hy(n.converter,e),u=Ku(n.firestore);return Qu(t,[Dy(u,"addDoc",i._key,l,n.converter!==null,{}).toMutation(i._key,Sr.exists(!1))]).then((()=>i))}function Ck(n,...e){n=sn(n);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||m2(e[i])||(t=e[i++]);const l={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(m2(e[i])){const y=e[i];e[i]=y.next?.bind(y),e[i+1]=y.error?.bind(y),e[i+2]=y.complete?.bind(y)}let u,d,p;if(n instanceof jn)d=Nr(n.firestore,Ya),p=um(n._key.path),u={next:y=>{e[i]&&e[i](Rk(d,n,y))},error:e[i+1],complete:e[i+2]};else{const y=Nr(n,Si);d=Nr(y.firestore,Ya),p=y._query;const x=new By(d);u={next:_=>{e[i]&&e[i](new Yo(d,x,y,_))},error:e[i+1],complete:e[i+2]},Nk(n._query)}const g=Wu(d);return mM(g,p,l,u)}function Qu(n,e){const t=Wu(n);return gM(t,e)}function Rk(n,e,t){const i=t.docs.get(e._key),l=new By(n);return new Ko(n,l,e._key,i,new hu(t.hasPendingWrites,t.fromCache),e.converter)}function g2(n){return n=Nr(n,Ya),Wu(n),new RM(n,(e=>Qu(n,e)))}(function(e,t=!0){pR(al),Jo(new uo("firestore",((i,{instanceIdentifier:l,options:u})=>{const d=i.getProvider("app").getImmediate(),p=new Ya(new bR(i.getProvider("auth-internal")),new wR(d,i.getProvider("app-check-internal")),VR(d,l),d);return u={useFetchStreams:t,...u},p._setSettings(u),p}),"PUBLIC").setMultipleInstances(!0)),za(d2,h2,e),za(d2,h2,"esm2020")})();var AM="firebase",IM="12.8.0";za(AM,IM,"app");const Ak="firebasestorage.googleapis.com",Ik="storageBucket",MM=120*1e3,DM=600*1e3;class En extends Qa{constructor(e,t,i=0){super(zp(e),`Firebase Storage: ${t} (${zp(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,En.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return zp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Tn;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Tn||(Tn={}));function zp(n){return"storage/"+n}function $y(){const n="An unknown error occurred, please check the error payload for server response.";return new En(Tn.UNKNOWN,n)}function PM(n){return new En(Tn.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function LM(n){return new En(Tn.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function OM(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new En(Tn.UNAUTHENTICATED,n)}function BM(){return new En(Tn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function VM(n){return new En(Tn.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function UM(){return new En(Tn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function FM(){return new En(Tn.CANCELED,"User canceled the upload/download.")}function zM(n){return new En(Tn.INVALID_URL,"Invalid URL '"+n+"'.")}function qM(n){return new En(Tn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function HM(){return new En(Tn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Ik+"' property when initializing the app?")}function $M(){return new En(Tn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function WM(){return new En(Tn.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function GM(n){return new En(Tn.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Ig(n){return new En(Tn.INVALID_ARGUMENT,n)}function Mk(){return new En(Tn.APP_DELETED,"The Firebase app was deleted.")}function KM(n){return new En(Tn.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function vu(n,e){return new En(Tn.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function su(n){throw new En(Tn.INTERNAL_ERROR,"Internal error: "+n)}class Er{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=Er.makeFromUrl(e,t)}catch{return new Er(e,"")}if(i.path==="")return i;throw qM(e)}static makeFromUrl(e,t){let i=null;const l="([A-Za-z0-9.\\-_]+)";function u(ke){ke.path.charAt(ke.path.length-1)==="/"&&(ke.path_=ke.path_.slice(0,-1))}const d="(/(.*))?$",p=new RegExp("^gs://"+l+d,"i"),g={bucket:1,path:3};function y(ke){ke.path_=decodeURIComponent(ke.path)}const x="v[A-Za-z0-9_]+",_=t.replace(/[.]/g,"\\."),j="(/([^?#]*).*)?$",O=new RegExp(`^https?://${_}/${x}/b/${l}/o${j}`,"i"),$={bucket:1,path:3},V=t===Ak?"(?:storage.googleapis.com|storage.cloud.google.com)":t,L="([^?#]*)",ee=new RegExp(`^https?://${V}/${l}/${L}`,"i"),te=[{regex:p,indices:g,postModify:u},{regex:O,indices:$,postModify:y},{regex:ee,indices:{bucket:1,path:2},postModify:y}];for(let ke=0;ke<te.length;ke++){const Te=te[ke],xe=Te.regex.exec(e);if(xe){const R=xe[Te.indices.bucket];let T=xe[Te.indices.path];T||(T=""),i=new Er(R,T),Te.postModify(i);break}}if(i==null)throw zM(e);return i}}class YM{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function QM(n,e,t){let i=1,l=null,u=null,d=!1,p=0;function g(){return p===2}let y=!1;function x(...L){y||(y=!0,e.apply(null,L))}function _(L){l=setTimeout(()=>{l=null,n(O,g())},L)}function j(){u&&clearTimeout(u)}function O(L,...ee){if(y){j();return}if(L){j(),x.call(null,L,...ee);return}if(g()||d){j(),x.call(null,L,...ee);return}i<64&&(i*=2);let te;p===1?(p=2,te=0):te=(i+Math.random())*1e3,_(te)}let $=!1;function V(L){$||($=!0,j(),!y&&(l!==null?(L||(p=2),clearTimeout(l),_(0)):L||(p=1)))}return _(0),u=setTimeout(()=>{d=!0,V(!0)},t),V}function XM(n){n(!1)}function JM(n){return n!==void 0}function ZM(n){return typeof n=="object"&&!Array.isArray(n)}function Wy(n){return typeof n=="string"||n instanceof String}function y2(n){return Gy()&&n instanceof Blob}function Gy(){return typeof Blob<"u"}function Mg(n,e,t,i){if(i<e)throw Ig(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw Ig(`Invalid value for '${n}'. Expected ${t} or less.`)}function jm(n,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${n}`}function Dk(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const l=e(i)+"="+e(n[i]);t=t+l+"&"}return t=t.slice(0,-1),t}var Qo;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Qo||(Qo={}));function e3(n,e){const t=n>=500&&n<600,l=[408,429].indexOf(n)!==-1,u=e.indexOf(n)!==-1;return t||l||u}class t3{constructor(e,t,i,l,u,d,p,g,y,x,_,j=!0,O=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=l,this.successCodes_=u,this.additionalRetryCodes_=d,this.callback_=p,this.errorCallback_=g,this.timeout_=y,this.progressCallback_=x,this.connectionFactory_=_,this.retry=j,this.isUsingEmulator=O,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise(($,V)=>{this.resolve_=$,this.reject_=V,this.start_()})}start_(){const e=(i,l)=>{if(l){i(!1,new lh(!1,null,!0));return}const u=this.connectionFactory_();this.pendingConnection_=u;const d=p=>{const g=p.loaded,y=p.lengthComputable?p.total:-1;this.progressCallback_!==null&&this.progressCallback_(g,y)};this.progressCallback_!==null&&u.addUploadProgressListener(d),u.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&u.removeUploadProgressListener(d),this.pendingConnection_=null;const p=u.getErrorCode()===Qo.NO_ERROR,g=u.getStatus();if(!p||e3(g,this.additionalRetryCodes_)&&this.retry){const x=u.getErrorCode()===Qo.ABORT;i(!1,new lh(!1,null,x));return}const y=this.successCodes_.indexOf(g)!==-1;i(!0,new lh(y,u))})},t=(i,l)=>{const u=this.resolve_,d=this.reject_,p=l.connection;if(l.wasSuccessCode)try{const g=this.callback_(p,p.getResponse());JM(g)?u(g):u()}catch(g){d(g)}else if(p!==null){const g=$y();g.serverResponse=p.getErrorText(),this.errorCallback_?d(this.errorCallback_(p,g)):d(g)}else if(l.canceled){const g=this.appDelete_?Mk():FM();d(g)}else{const g=UM();d(g)}};this.canceled_?t(!1,new lh(!1,null,!0)):this.backoffId_=QM(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&XM(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class lh{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function s3(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function n3(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function r3(n,e){e&&(n["X-Firebase-GMPID"]=e)}function a3(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function i3(n,e,t,i,l,u,d=!0,p=!1){const g=Dk(n.urlParams),y=n.url+g,x=Object.assign({},n.headers);return r3(x,e),s3(x,t),n3(x,u),a3(x,i),new t3(y,n.method,x,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,l,d,p)}function o3(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function l3(...n){const e=o3();if(e!==void 0){const t=new e;for(let i=0;i<n.length;i++)t.append(n[i]);return t.getBlob()}else{if(Gy())return new Blob(n);throw new En(Tn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function c3(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function u3(n){if(typeof atob>"u")throw GM("base-64");return atob(n)}const Fa={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class qp{constructor(e,t){this.data=e,this.contentType=t||null}}function d3(n,e){switch(n){case Fa.RAW:return new qp(Pk(e));case Fa.BASE64:case Fa.BASE64URL:return new qp(Lk(n,e));case Fa.DATA_URL:return new qp(m3(e),f3(e))}throw $y()}function Pk(n){const e=[];for(let t=0;t<n.length;t++){let i=n.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const u=i,d=n.charCodeAt(++t);i=65536|(u&1023)<<10|d&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function h3(n){let e;try{e=decodeURIComponent(n)}catch{throw vu(Fa.DATA_URL,"Malformed data URL.")}return Pk(e)}function Lk(n,e){switch(n){case Fa.BASE64:{const l=e.indexOf("-")!==-1,u=e.indexOf("_")!==-1;if(l||u)throw vu(n,"Invalid character '"+(l?"-":"_")+"' found: is it base64url encoded?");break}case Fa.BASE64URL:{const l=e.indexOf("+")!==-1,u=e.indexOf("/")!==-1;if(l||u)throw vu(n,"Invalid character '"+(l?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=u3(e)}catch(l){throw l.message.includes("polyfill")?l:vu(n,"Invalid character found")}const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i}class Ok{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw vu(Fa.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=p3(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function m3(n){const e=new Ok(n);return e.base64?Lk(Fa.BASE64,e.rest):h3(e.rest)}function f3(n){return new Ok(n).contentType}function p3(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}class no{constructor(e,t){let i=0,l="";y2(e)?(this.data_=e,i=e.size,l=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=l}size(){return this.size_}type(){return this.type_}slice(e,t){if(y2(this.data_)){const i=this.data_,l=c3(i,e,t);return l===null?null:new no(l)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new no(i,!0)}}static getBlob(...e){if(Gy()){const t=e.map(i=>i instanceof no?i.data_:i);return new no(l3.apply(null,t))}else{const t=e.map(d=>Wy(d)?d3(Fa.RAW,d).data:d.data_);let i=0;t.forEach(d=>{i+=d.byteLength});const l=new Uint8Array(i);let u=0;return t.forEach(d=>{for(let p=0;p<d.length;p++)l[u++]=d[p]}),new no(l,!0)}}uploadData(){return this.data_}}function Ky(n){let e;try{e=JSON.parse(n)}catch{return null}return ZM(e)?e:null}function g3(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function y3(n,e){const t=e.split("/").filter(i=>i.length>0).join("/");return n.length===0?t:n+"/"+t}function Bk(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function b3(n,e){return e}class jr{constructor(e,t,i,l){this.server=e,this.local=t||e,this.writable=!!i,this.xform=l||b3}}let ch=null;function v3(n){return!Wy(n)||n.length<2?n:Bk(n)}function Vk(){if(ch)return ch;const n=[];n.push(new jr("bucket")),n.push(new jr("generation")),n.push(new jr("metageneration")),n.push(new jr("name","fullPath",!0));function e(u,d){return v3(d)}const t=new jr("name");t.xform=e,n.push(t);function i(u,d){return d!==void 0?Number(d):d}const l=new jr("size");return l.xform=i,n.push(l),n.push(new jr("timeCreated")),n.push(new jr("updated")),n.push(new jr("md5Hash",null,!0)),n.push(new jr("cacheControl",null,!0)),n.push(new jr("contentDisposition",null,!0)),n.push(new jr("contentEncoding",null,!0)),n.push(new jr("contentLanguage",null,!0)),n.push(new jr("contentType",null,!0)),n.push(new jr("metadata","customMetadata",!0)),ch=n,ch}function x3(n,e){function t(){const i=n.bucket,l=n.fullPath,u=new Er(i,l);return e._makeStorageReference(u)}Object.defineProperty(n,"ref",{get:t})}function w3(n,e,t){const i={};i.type="file";const l=t.length;for(let u=0;u<l;u++){const d=t[u];i[d.local]=d.xform(i,e[d.server])}return x3(i,n),i}function Uk(n,e,t){const i=Ky(e);return i===null?null:w3(n,i,t)}function _3(n,e,t,i){const l=Ky(e);if(l===null||!Wy(l.downloadTokens))return null;const u=l.downloadTokens;if(u.length===0)return null;const d=encodeURIComponent;return u.split(",").map(y=>{const x=n.bucket,_=n.fullPath,j="/b/"+d(x)+"/o/"+d(_),O=jm(j,t,i),$=Dk({alt:"media",token:y});return O+$})[0]}function k3(n,e){const t={},i=e.length;for(let l=0;l<i;l++){const u=e[l];u.writable&&(t[u.server]=n[u.local])}return JSON.stringify(t)}const b2="prefixes",v2="items";function j3(n,e,t){const i={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[b2])for(const l of t[b2]){const u=l.replace(/\/$/,""),d=n._makeStorageReference(new Er(e,u));i.prefixes.push(d)}if(t[v2])for(const l of t[v2]){const u=n._makeStorageReference(new Er(e,l.name));i.items.push(u)}return i}function T3(n,e,t){const i=Ky(t);return i===null?null:j3(n,e,i)}class Yy{constructor(e,t,i,l){this.url=e,this.method=t,this.handler=i,this.timeout=l,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Qy(n){if(!n)throw $y()}function E3(n,e){function t(i,l){const u=Uk(n,l,e);return Qy(u!==null),u}return t}function N3(n,e){function t(i,l){const u=T3(n,e,l);return Qy(u!==null),u}return t}function S3(n,e){function t(i,l){const u=Uk(n,l,e);return Qy(u!==null),_3(u,l,n.host,n._protocol)}return t}function Xy(n){function e(t,i){let l;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?l=BM():l=OM():t.getStatus()===402?l=LM(n.bucket):t.getStatus()===403?l=VM(n.path):l=i,l.status=t.getStatus(),l.serverResponse=i.serverResponse,l}return e}function C3(n){const e=Xy(n);function t(i,l){let u=e(i,l);return i.getStatus()===404&&(u=PM(n.path)),u.serverResponse=l.serverResponse,u}return t}function R3(n,e,t,i,l){const u={};e.isRoot?u.prefix="":u.prefix=e.path+"/",t.length>0&&(u.delimiter=t),i&&(u.pageToken=i),l&&(u.maxResults=l);const d=e.bucketOnlyServerUrl(),p=jm(d,n.host,n._protocol),g="GET",y=n.maxOperationRetryTime,x=new Yy(p,g,N3(n,e.bucket),y);return x.urlParams=u,x.errorHandler=Xy(e),x}function A3(n,e,t){const i=e.fullServerUrl(),l=jm(i,n.host,n._protocol),u="GET",d=n.maxOperationRetryTime,p=new Yy(l,u,S3(n,t),d);return p.errorHandler=C3(e),p}function I3(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function M3(n,e,t){const i=Object.assign({},t);return i.fullPath=n.path,i.size=e.size(),i.contentType||(i.contentType=I3(null,e)),i}function D3(n,e,t,i,l){const u=e.bucketOnlyServerUrl(),d={"X-Goog-Upload-Protocol":"multipart"};function p(){let te="";for(let ke=0;ke<2;ke++)te=te+Math.random().toString().slice(2);return te}const g=p();d["Content-Type"]="multipart/related; boundary="+g;const y=M3(e,i,l),x=k3(y,t),_="--"+g+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+x+`\r
--`+g+`\r
Content-Type: `+y.contentType+`\r
\r
`,j=`\r
--`+g+"--",O=no.getBlob(_,i,j);if(O===null)throw $M();const $={name:y.fullPath},V=jm(u,n.host,n._protocol),L="POST",ee=n.maxUploadRetryTime,Y=new Yy(V,L,E3(n,t),ee);return Y.urlParams=$,Y.headers=d,Y.body=O.uploadData(),Y.errorHandler=Xy(e),Y}class P3{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Qo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Qo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Qo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,l,u){if(this.sent_)throw su("cannot .send() more than once");if(bo(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),u!==void 0)for(const d in u)u.hasOwnProperty(d)&&this.xhr_.setRequestHeader(d,u[d].toString());return l!==void 0?this.xhr_.send(l):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw su("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw su("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw su("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw su("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class L3 extends P3{initXhr(){this.xhr_.responseType="text"}}function Jy(){return new L3}class rl{constructor(e,t){this._service=e,t instanceof Er?this._location=t:this._location=Er.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new rl(e,t)}get root(){const e=new Er(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Bk(this._location.path)}get storage(){return this._service}get parent(){const e=g3(this._location.path);if(e===null)return null;const t=new Er(this._location.bucket,e);return new rl(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw KM(e)}}function O3(n,e,t){n._throwIfRoot("uploadBytes");const i=D3(n.storage,n._location,Vk(),new no(e,!0),t);return n.storage.makeRequestWithTokens(i,Jy).then(l=>({metadata:l,ref:n}))}function B3(n){const e={prefixes:[],items:[]};return Fk(n,e).then(()=>e)}async function Fk(n,e,t){const l=await V3(n,{pageToken:t});e.prefixes.push(...l.prefixes),e.items.push(...l.items),l.nextPageToken!=null&&await Fk(n,e,l.nextPageToken)}function V3(n,e){e!=null&&typeof e.maxResults=="number"&&Mg("options.maxResults",1,1e3,e.maxResults);const t=e||{},i=R3(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(i,Jy)}function U3(n){n._throwIfRoot("getDownloadURL");const e=A3(n.storage,n._location,Vk());return n.storage.makeRequestWithTokens(e,Jy).then(t=>{if(t===null)throw WM();return t})}function F3(n,e){const t=y3(n._location.path,e),i=new Er(n._location.bucket,t);return new rl(n.storage,i)}function z3(n){return/^[A-Za-z]+:\/\//.test(n)}function q3(n,e){return new rl(n,e)}function zk(n,e){if(n instanceof Zy){const t=n;if(t._bucket==null)throw HM();const i=new rl(t,t._bucket);return e!=null?zk(i,e):i}else return e!==void 0?F3(n,e):n}function H3(n,e){if(e&&z3(e)){if(n instanceof Zy)return q3(n,e);throw Ig("To use ref(service, url), the first argument must be a Storage instance.")}else return zk(n,e)}function x2(n,e){const t=e?.[Ik];return t==null?null:Er.makeFromBucketSpec(t,n)}function $3(n,e,t,i={}){n.host=`${e}:${t}`;const l=bo(e);l&&(Hg(`https://${n.host}/b`),$g("Storage",!0)),n._isUsingEmulator=!0,n._protocol=l?"https":"http";const{mockUserToken:u}=i;u&&(n._overrideAuthToken=typeof u=="string"?u:dw(u,n.app.options.projectId))}class Zy{constructor(e,t,i,l,u,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=l,this._firebaseVersion=u,this._isUsingEmulator=d,this._bucket=null,this._host=Ak,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=MM,this._maxUploadRetryTime=DM,this._requests=new Set,l!=null?this._bucket=Er.makeFromBucketSpec(l,this._host):this._bucket=x2(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Er.makeFromBucketSpec(this._url,e):this._bucket=x2(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Mg("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Mg("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Zr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new rl(this,e)}_makeRequest(e,t,i,l,u=!0){if(this._deleted)return new YM(Mk());{const d=i3(e,this._appId,i,l,t,this._firebaseVersion,u,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[i,l]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,l).getPromise()}}const w2="@firebase/storage",_2="0.14.0";const qk="storage";function Sh(n,e,t){return n=sn(n),O3(n,e,t)}function k2(n){return n=sn(n),B3(n)}function co(n){return n=sn(n),U3(n)}function gi(n,e){return n=sn(n),H3(n,e)}function W3(n=Yg(),e){n=sn(n);const i=sm(n,qk).getImmediate({identifier:e}),l=lw("storage");return l&&G3(i,...l),i}function G3(n,e,t,i={}){$3(n,e,t,i)}function K3(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),l=n.getProvider("app-check-internal");return new Zy(t,i,l,e,al)}function Y3(){Jo(new uo(qk,K3,"PUBLIC").setMultipleInstances(!0)),za(w2,_2,""),za(w2,_2,"esm2020")}Y3();const Hk={apiKey:"AIzaSyBCIgMJd3By7qkWH27YiW9VooIBGE3bFLs",authDomain:"mind-core-fitness-client.firebaseapp.com",projectId:"mind-core-fitness-client",storageBucket:"mind-core-fitness-client.firebasestorage.app",messagingSenderId:"669343392406",appId:"1:669343392406:web:f5a35ee062387e7d6f58b7"},eb=Kg(Hk),Fo=Qw(eb),pe=xM(eb),yi=W3(eb),Q3=Kg(Hk,"secondary"),vP=Qw(Q3),X3="EYdciKDOi3UYBLk1u8hHams5tmO2",$k=b.createContext();function Rr(){return b.useContext($k)}function J3({children:n}){const[e,t]=b.useState(null),[i,l]=b.useState(!1),[u,d]=b.useState(!1),[p,g]=b.useState(null),[y,x]=b.useState(!0);b.useEffect(()=>{let Y=null;const te=n4(Fo,ke=>{if(t(ke),Y&&(Y(),Y=null),ke)if(ke.uid===X3)l(!0),d(!1),g(null),x(!1);else{l(!1);const Te=Fs($t(pe,"clients"),bs("uid","==",ke.uid)),xe=async()=>{const R=localStorage.getItem("mcf_clientId");if(R)try{const T=await Os(We(pe,"clients",R));T.exists()&&(d(!0),g({id:T.id,...T.data()}))}catch(T){console.error("Direct client read failed:",T)}};Y=Ck(Te,async R=>{if(R.empty)await xe();else{const T=R.docs[0];d(!0),g({id:T.id,...T.data()});try{localStorage.setItem("mcf_clientId",T.id)}catch{}}x(!1)},async R=>{console.error("Error listening to client data:",R),await xe(),x(!1)})}else l(!1),d(!1),g(null),x(!1)});return()=>{te(),Y&&Y()}},[]);const ee={currentUser:e,isAdmin:i,isClient:u,clientData:p,updateClientData:Y=>{g(te=>te?{...te,...Y}:Y)},resolveClient:async()=>{if(p)return p;const Y=localStorage.getItem("mcf_clientId");if(Y)try{const te=await Os(We(pe,"clients",Y));if(te.exists()){const ke={id:te.id,...te.data()};return d(!0),g(ke),ke}}catch(te){console.error("resolveClient direct read failed:",te)}if(e){const te=Fs($t(pe,"clients"),bs("uid","==",e.uid)),ke=await Is(te);if(!ke.empty){const Te={id:ke.docs[0].id,...ke.docs[0].data()};return d(!0),g(Te),Te}}return null},login:async(Y,te,ke=!0)=>(await ix(Fo,ke?fg:sy),await e4(Fo,Y,te)),signup:async(Y,te,ke)=>{await ix(Fo,fg);const Te=await ZC(Fo,te.trim().toLowerCase(),ke),xe=Te.user,R=We($t(pe,"clients")),T={uid:xe.uid,name:Y.trim(),email:te.trim().toLowerCase(),clientType:"core_buddy",coreBuddyAccess:!0,status:"active",tier:"free",subscriptionStatus:null,signupSource:"self_signup",createdAt:Rt.now()};await Ms(R,T),d(!0),g({id:R.id,...T});try{localStorage.setItem("mcf_clientId",R.id)}catch{}return Te},logout:()=>{try{localStorage.removeItem("mcf_clientId")}catch{}return r4(Fo)},resetPassword:Y=>JC(Fo,Y),loading:y};return r.jsx($k.Provider,{value:ee,children:n})}const Wk=b.createContext();function Ia(){return b.useContext(Wk)}function Z3({children:n}){const[e,t]=b.useState(()=>{const g=localStorage.getItem("theme");return g?g==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches}),[i,l]=b.useState(()=>localStorage.getItem("accent")||"red");b.useEffect(()=>{document.documentElement.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("theme",e?"dark":"light")},[e]),b.useEffect(()=>{localStorage.setItem("accent",i)},[i]);const p={isDark:e,toggleTheme:()=>{document.documentElement.setAttribute("data-theme-transitioning",""),t(!e),setTimeout(()=>{document.documentElement.removeAttribute("data-theme-transitioning")},350)},accent:i,setAccent:g=>l(g)};return r.jsx(Wk.Provider,{value:p,children:n})}const Gk=b.createContext();function pc(){return b.useContext(Gk)}const eD=["nutrition","personalBests","achievements","buddies","programmes"],tD=[5,10],sD=3,nD=1;function rD({children:n}){const{clientData:e,loading:t}=Rr(),i=b.useMemo(()=>{const l=e?.tier||"free",u=e?.subscriptionStatus||null,d=e&&e.signupSource!=="self_signup",p=l==="premium"||!!d;function g(y){return p?!0:!eD.includes(y)}return{tier:l,subscriptionStatus:u,isPremium:p,canAccess:g,loading:t,FREE_RANDOMISER_DURATIONS:tD,FREE_RANDOMISER_WEEKLY_LIMIT:sD,FREE_HABIT_LIMIT:nD}},[e?.tier,e?.subscriptionStatus,e?.signupSource,t]);return r.jsx(Gk.Provider,{value:i,children:n})}function aD(n){if(n?.signupSource==="self_signup"&&!n?.onboardingComplete)return"/onboarding";const e=n?.clientType;return e==="core_buddy"?"/client/core-buddy":e==="circuit_vip"||e==="circuit_dropin"?"/client/circuit":"/client"}function iD({className:n=""}){const{isDark:e,toggleTheme:t}=Ia();return r.jsx("button",{className:n||"theme-toggle",onClick:t,"aria-label":e?"Switch to light mode":"Switch to dark mode",children:e?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})})}function oD(){const[n,e]=b.useState(""),[t,i]=b.useState(""),[l,u]=b.useState(!0),[d,p]=b.useState(""),[g,y]=b.useState(!1),[x,_]=b.useState(!1),[j,O]=b.useState(!1),{login:$,resetPassword:V,currentUser:L,isAdmin:ee,isClient:Y,clientData:te,loading:ke}=Rr(),Te=Zn();if(b.useEffect(()=>{!ke&&L&&(ee?Te("/dashboard"):Y?Te(aD(te)):(y(!1),p("No account found. Please sign up or contact your trainer.")))},[ke,L,ee,Y,te,Te]),ke||L)return r.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh",background:"var(--bg-body)"},children:r.jsx("div",{style:{width:36,height:36,border:"3px solid var(--color-primary-light)",borderTopColor:"var(--color-primary)",borderRadius:"50%",animation:"app-spin .7s linear infinite"}})});const xe=async T=>{T.preventDefault(),p(""),y(!0);try{await $(n,t,l)}catch(S){p(S.message||"Failed to log in"),y(!1)}},R=async T=>{if(T.preventDefault(),p(""),!n.trim()){p("Please enter your email address");return}y(!0);try{await V(n.trim()),O(!0)}catch(S){S.code==="auth/user-not-found"?p("No account found with this email"):p(S.message||"Failed to send reset email")}y(!1)};return r.jsxs("div",{className:"login-container",children:[r.jsx(iD,{className:"login-theme-toggle"}),r.jsxs("div",{className:"login-card",children:[r.jsxs("div",{className:"login-header",children:[r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"login-logo"}),r.jsx("p",{children:r.jsx("strong",{children:x?"Reset Password":"Sign in as 1-2-1 or a Core Buddy"})})]}),d&&r.jsx("div",{className:"error-message",children:d}),j?r.jsxs("div",{className:"reset-sent",children:[r.jsx("div",{className:"reset-sent-icon",children:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M22 2L11 13",strokeLinecap:"round",strokeLinejoin:"round"}),r.jsx("path",{d:"M22 2L15 22L11 13L2 9L22 2Z",strokeLinecap:"round",strokeLinejoin:"round"})]})}),r.jsx("p",{children:"Reset email sent!"}),r.jsx("span",{children:"Check your inbox for a password reset link"}),r.jsx("button",{className:"login-btn",style:{marginTop:"20px"},onClick:()=>{_(!1),O(!1),p("")},children:"Back to Log In"})]}):x?r.jsxs("form",{onSubmit:R,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email"}),r.jsx("input",{type:"email",id:"email",value:n,onChange:T=>e(T.target.value),placeholder:"Enter your email",required:!0})]}),r.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Sending...":"Send Reset Link"}),r.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{_(!1),p("")},children:"Back to Log In"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("form",{onSubmit:xe,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email"}),r.jsx("input",{type:"email",id:"email",value:n,onChange:T=>e(T.target.value),required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"password",children:"Password"}),r.jsx("input",{type:"password",id:"password",value:t,onChange:T=>i(T.target.value),required:!0})]}),r.jsx("div",{className:"remember-me",children:r.jsxs("label",{children:[r.jsx("input",{type:"checkbox",checked:l,onChange:T=>u(T.target.checked)}),r.jsx("span",{children:"Remember me"})]})}),r.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Logging in...":"Log In"})]}),r.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{_(!0),p("")},children:"Forgot password?"}),r.jsx("button",{type:"button",className:"login-btn login-btn-outline",onClick:()=>Te("/signup"),children:"Don't have an account? Create one free"})]}),r.jsx("a",{href:"/",className:"back-link",children:"Back to website"})]})]})}function Bl({feature:n,children:e}){const{canAccess:t,loading:i}=pc();return i||t(n)?e:r.jsx(J2,{to:"/upgrade",replace:!0})}function ta({active:n}){const e=Zn(),{clientData:t}=Rr(),{isPremium:i}=pc(),l=t?.clientType==="block"&&t?.coreBuddyAccess;return r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:`block-nav-tab${n==="home"?" active":""}`,onClick:()=>e("/client/core-buddy"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),r.jsx("span",{children:"Profile"})]}),r.jsxs("button",{className:`block-nav-tab${n==="workouts"?" active":""}`,onClick:()=>e("/client/core-buddy/workouts"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:r.jsx("path",{d:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"})}),r.jsx("span",{children:"Workouts"})]}),i&&r.jsxs("button",{className:`block-nav-tab${n==="nutrition"?" active":""}`,onClick:()=>e("/client/core-buddy/nutrition"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"})}),r.jsx("span",{children:"Nutrition"})]}),i&&r.jsxs("button",{className:`block-nav-tab${n==="buddies"?" active":""}`,onClick:()=>e("/client/core-buddy/buddies"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("span",{children:"Buddies"})]}),l&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>e("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),r.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),r.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),r.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),r.jsx("span",{children:"Block"})]})]})}function ga({children:n,onRefresh:e}){const[t,i]=b.useState(0),[l,u]=b.useState(!1),d=b.useRef(null),p=b.useRef(0),g=b.useRef(!1),y=b.useCallback(j=>{window.scrollY<=0&&(p.current=j.touches[0].clientY,g.current=!0)},[]),x=b.useCallback(j=>{if(!g.current||l)return;const O=j.touches[0].clientY-p.current;O>20&&window.scrollY<=0&&(j.preventDefault(),i(Math.min((O-20)*.35,80)))},[l]),_=b.useCallback(async()=>{t>55&&!l&&(u(!0),e?await e():window.location.reload(),u(!1)),i(0),g.current=!1},[t,l,e]);return r.jsxs("div",{ref:d,onTouchStart:y,onTouchMove:x,onTouchEnd:_,children:[r.jsxs("div",{className:`pull-refresh-indicator ${t>0?"visible":""} ${l?"refreshing":""}`,style:{height:t},children:[r.jsx("div",{className:`refresh-spinner ${l?"spinning":""}`,children:r.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:r.jsx("path",{fill:"currentColor",d:"M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"})})}),r.jsx("span",{className:"refresh-text",children:l?"Refreshing...":"Pull to refresh"})]}),n]})}function Xu(n,e,t,i,l){const u=[];for(let d=0;d<n;d++){const p=(d*(360/n)-90)*(Math.PI/180);u.push({x1:e+i*Math.cos(p),y1:t+i*Math.sin(p),x2:e+l*Math.cos(p),y2:t+l*Math.sin(p),thick:d%5===0})}return u}const Tm=Xu(60,100,100,85,96),Kk=Xu(60,100,100,78,94),lD=Xu(60,100,100,82,94);Xu(60,50,50,38,46);const j2=Xu(60,40,40,30,37),cD="/login/assets/first_workout-B8SFkzJX.PNG",uD="/login/assets/workouts_10-Z5R3u0xH.PNG",dD="/login/assets/workouts_25-CzxSlcAj.PNG",hD="/login/assets/workouts_50-BpzWup3V.PNG",mD="/login/assets/workouts_100-D7_r6tn1.PNG",fD="/login/assets/streak_2-CsRr-XA9.PNG",pD="/login/assets/streak_4-BHO09tbw.PNG",gD="/login/assets/streak_8-DX2UWMko.PNG",yD="/login/assets/first_pb-aVf_CNWy.PNG",bD="/login/assets/pbs_5-Cippawgg.PNG",vD="/login/assets/pbs_10-CZgGh9Kv.PNG",xD="/login/assets/pbs_100-C67b1wfS.PNG",wD="/login/assets/nutrition_7-CHVV11fj.PNG",_D="/login/assets/leaderboard_join-BLoId4Hz.PNG",kD="/login/assets/habits_7-Dvki70KO.PNG",Wn=[{id:"first_workout",img:cD,name:"First Rep",desc:"Complete your first workout",category:"workouts",threshold:1},{id:"workouts_10",img:uD,name:"On Fire",desc:"Complete 10 workouts",category:"workouts",threshold:10},{id:"workouts_25",img:dD,name:"Dedicated",desc:"Complete 25 workouts",category:"workouts",threshold:25},{id:"workouts_50",img:hD,name:"Unstoppable",desc:"Complete 50 workouts",category:"workouts",threshold:50},{id:"workouts_100",img:mD,name:"Century",desc:"Complete 100 workouts",category:"workouts",threshold:100},{id:"streak_2",img:fD,name:"2 Week Streak",desc:"Work out for 2 weeks in a row",category:"streaks",threshold:2},{id:"streak_4",img:pD,name:"Month Strong",desc:"Work out for 4 weeks in a row",category:"streaks",threshold:4},{id:"streak_8",img:gD,name:"Iron Will",desc:"Work out for 8 weeks in a row",category:"streaks",threshold:8},{id:"first_pb",img:yD,name:"First PB",desc:"Set your first personal best",category:"pbs",threshold:1},{id:"pbs_5",img:bD,name:"PB Hunter",desc:"Set 5 personal bests",category:"pbs",threshold:5},{id:"pbs_10",img:vD,name:"PB Machine",desc:"Set 10 personal bests",category:"pbs",threshold:10},{id:"pbs_100",img:xD,name:"PB Legend",desc:"Set 100 personal bests",category:"pbs",threshold:100},{id:"nutrition_7",img:wD,name:"Macro Master",desc:"Hit your macro targets 7 days in a row",category:"nutrition",threshold:7},{id:"leaderboard_join",img:_D,name:"Competitor",desc:"Join the leaderboard",category:"leaderboard",threshold:1},{id:"habits_7",img:kD,name:"Habit Streak",desc:"Complete your daily habits 7 days in a row",category:"habits",threshold:7}];function jD({steps:n,onFinish:e,active:t}){const[i,l]=b.useState(0),[u,d]=b.useState(null),[p,g]=b.useState("below"),[y,x]=b.useState(!1),_=b.useRef(null),j=b.useRef(t);j.current=t,b.useEffect(()=>{t||l(0)},[t]),b.useEffect(()=>{if(!t)return;const Te=xe=>xe.preventDefault();return document.addEventListener("touchmove",Te,{passive:!1}),document.addEventListener("wheel",Te,{passive:!1}),document.body.style.overflow="hidden",()=>{document.removeEventListener("touchmove",Te),document.removeEventListener("wheel",Te),document.body.style.overflow=""}},[t]);const O=b.useMemo(()=>t?n.filter(Te=>document.querySelector(Te.selector)):[],[t]),$=O[i],V=i===O.length-1,L=$?.selector,ee=b.useCallback(()=>{if(!L)return;const Te=document.querySelector(L);if(!Te){d(null);return}const xe=Te.getBoundingClientRect(),R=8;d({top:xe.top-R,left:xe.left-R,width:xe.width+R*2,height:xe.height+R*2});const T=window.innerHeight-xe.bottom;g(T<260?"above":"below")},[L]);if(b.useEffect(()=>{if(!t||!L)return;x(!0);const Te=document.querySelector(L);if(Te){document.body.style.overflow="",Te.scrollIntoView({behavior:"smooth",block:"center"});let xe=null,R=0,T=0;const S=60,D=()=>{T++;const M=Te.getBoundingClientRect(),ze=Math.round(M.top);if(xe!==null&&ze===xe?R++:R=0,xe=ze,R>=3||T>=S){j.current&&(document.body.style.overflow="hidden"),ee(),x(!1);return}I=requestAnimationFrame(D)};let I;const U=setTimeout(()=>{I=requestAnimationFrame(D)},120);return()=>{clearTimeout(U),I&&cancelAnimationFrame(I),j.current&&(document.body.style.overflow="hidden")}}},[t,i,L,ee]),b.useEffect(()=>{if(!t)return;const Te=()=>{_.current&&cancelAnimationFrame(_.current),_.current=requestAnimationFrame(ee)};return window.addEventListener("scroll",Te,!0),window.addEventListener("resize",Te),()=>{window.removeEventListener("scroll",Te,!0),window.removeEventListener("resize",Te),_.current&&cancelAnimationFrame(_.current)}},[t,ee]),!t||!$||O.length===0)return null;const Y=()=>{V?e():l(i+1)},te=()=>{i>0&&l(i-1)},ke=()=>e();return r.jsxs("div",{className:"st-overlay",onClick:Te=>{Te.stopPropagation()},children:[r.jsx("div",{className:"st-backdrop",onClick:Y}),u&&r.jsx("div",{className:`st-spotlight${y?" st-transitioning":""}`,style:{top:u.top,left:u.left,width:u.width,height:u.height}}),u&&r.jsxs("div",{className:`st-tooltip st-tooltip-${p}${y?" st-transitioning":""}`,style:{top:p==="below"?Math.min(Math.max(u.top+u.height+16,16),window.innerHeight-200):void 0,bottom:p==="above"?Math.min(Math.max(window.innerHeight-u.top+16,16),window.innerHeight-60):void 0,left:Math.max(16,Math.min(u.left,window.innerWidth-320))},children:[r.jsx("div",{className:"st-dots",children:O.map((Te,xe)=>r.jsx("span",{className:`st-dot${xe===i?" active":""}${xe<i?" done":""}`},xe))}),r.jsx("h3",{className:"st-title",children:$.title}),r.jsx("p",{className:"st-body",children:$.body}),r.jsxs("div",{className:"st-actions",children:[i>0&&r.jsx("button",{className:"st-btn st-btn-back",onClick:te,children:"Back"}),r.jsx("button",{className:"st-btn st-btn-next",onClick:Y,children:$.cta||(V?"Let's Go!":"Next")})]}),r.jsx("button",{className:"st-skip",onClick:ke,children:"Skip tour"})]})]})}const T2=3,TD=5;function nu(n){return n.toISOString().split("T")[0]}const ED={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},ND={fullbody_4wk:["Push Focus","Pull Focus","Legs & Core"],fullbody_8wk:["Strength","Power","Endurance"],fullbody_12wk:["Upper Push","Lower Body","Upper Pull"],core_4wk:["Abs","Stability","Power Core"],core_8wk:["Anti-Extension","Rotation","Power"],core_12wk:["Strength","Endurance","Power"],upper_4wk:["Push","Pull","Mixed"],lower_4wk:["Quad Dominant","Hamstring & Glute","Power & Stability"]},Hp=[{text:"You have 24 hours a day...",bold:"make it count"},{text:"Discipline beats motivation...",bold:"every single time"},{text:"Rest when you're done,",bold:"not when you're tired"},{text:"Small daily gains...",bold:"create massive results"},{text:"Your body keeps score,",bold:"train it well"},{text:"Consistency over intensity...",bold:"always wins"},{text:"The only bad workout...",bold:"is the one you skipped"}];function $p(n){if(!n)return"";const e=n instanceof Date?n:n.toDate?n.toDate():new Date(n),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function ru(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function SD(n,e=800){return new Promise(t=>{const i=new Image;i.onload=()=>{const l=document.createElement("canvas");let u=i.width,d=i.height;u>d?u>e&&(d=Math.round(d*e/u),u=e):d>e&&(u=Math.round(u*e/d),d=e),l.width=u,l.height=d,l.getContext("2d").drawImage(i,0,0,u,d),l.toBlob(p=>t(p),"image/jpeg",.8)},i.src=URL.createObjectURL(n)})}function CD(){const{currentUser:n,isClient:e,clientData:t,logout:i,updateClientData:l,loading:u}=Rr(),{isDark:d,toggleTheme:p}=Ia(),{isPremium:g,FREE_HABIT_LIMIT:y}=pc(),x=Zn(),_=g?TD:y,[j,O]=b.useState({hours:0,minutes:0,seconds:0}),[$,V]=b.useState(0),[L,ee]=b.useState(0),[Y,te]=b.useState(""),[ke,Te]=b.useState(0),[xe,R]=b.useState(0),[T,S]=b.useState(!1),[D,I]=b.useState({protein:0,carbs:0,fats:0,calories:0}),[U,M]=b.useState(null),[ze,gt]=b.useState(0),[B,se]=b.useState(null),[ge,Re]=b.useState(!1),[Q,P]=b.useState(!1),[ae,Be]=b.useState(0),[Ue,Oe]=b.useState(T2),[Ie,ot]=b.useState(!1),[yt,et]=b.useState(!1),[Xt,Es]=b.useState(0),[Ot,wt]=b.useState([]),[oe,Ct]=b.useState([]),[kt,zt]=b.useState(null),[Et,jt]=b.useState(!1),tt=b.useRef(null),[Mt,qt]=b.useState([]),[ms,Ft]=b.useState(null),[At,us]=b.useState(null),vs=b.useRef(null),[as,nn]=b.useState(0),[Ds,Hs]=b.useState(0),[is,xs]=b.useState(0),[ye,Me]=b.useState(0),[De,Qe]=b.useState(null),He=b.useCallback((C,K="info")=>{Qe({message:C,type:K}),setTimeout(()=>Qe(null),4e3)},[]),[Xe,ut]=b.useState([]),[J,ne]=b.useState(!1),[$e,bt]=b.useState(""),[Ye,vt]=b.useState(null),[X,Ae]=b.useState(null),[Ge,ht]=b.useState(!1),[Je,Kt]=b.useState(new Set),[Ht,F]=b.useState(new Set),[fe,Se]=b.useState({}),[Ee,Ne]=b.useState({}),[mt,Nt]=b.useState({}),[lt,Bt]=b.useState({}),[Dt,Xs]=b.useState({}),[vn,mn]=b.useState({}),Nn=b.useRef(null),Ks=b.useRef(null),cn=b.useRef({}),[Ns,W]=b.useState([]),[he,ce]=b.useState(!1),_e=b.useRef(null),[E,z]=b.useState([]),[ie,re]=b.useState(""),[Ke,rt]=b.useState(!1),[st,It]=b.useState(null),[ft,ds]=b.useState([]),[rn,wr]=b.useState(null),[fs,Ar]=b.useState(!1),Mn=b.useRef(!1),G=(()=>{const C=[{selector:".cb-ring-container",title:"Your 24-Hour Countdown",body:"Every day resets. This ring tracks the time you have left  tap your photo to personalise your profile.",cta:"Next"},{selector:".cb-stats-row",title:"Progress at a Glance",body:"Programme completion, workouts this week, and daily habits  all in one row. These fill up as you go."},{selector:".cb-nudge-card",title:"Smart Suggestions",body:"We'll highlight what needs your attention  your next session, unfinished habits, or a meal to log."},{selector:".cb-card-workouts-hero",title:"Workouts",body:"Quick randomiser sessions or structured programmes  pick your focus, level and time.",cta:"Next"}];return g&&C.push({selector:".cb-card-nutrition",title:"Nutrition Tracking",body:"Set your macro targets, scan barcodes, and log meals to hit your daily goals."},{selector:".cb-card-consistency",title:"Daily Habits",body:"5 simple habits each day  train, hit protein, 10k steps, sleep, and hydrate. Build your streak."},{selector:".cb-card-buddies",title:"Buddies & Social",body:"Connect with other members, share your journey, and keep each other accountable."},{selector:".cb-journey-section",title:"Share Your Journey",body:"Post photos, updates, and milestones  your fitness journey in one place. Like and comment on each other's posts."},{selector:".cb-achievements-section",title:"Achievements",body:"Every rep counts towards badges  volume milestones, workout streaks, and more to unlock."}),C.push({selector:".block-bottom-nav",title:"You're All Set!",body:"Use the nav bar to jump between your profile, workouts, nutrition, and buddies. Time to get after it.",cta:"Let's Go!"}),C})();b.useEffect(()=>{!u&&!n&&x("/")},[u,n,x]),b.useEffect(()=>{!u&&t&&t.signupSource==="self_signup"&&!t.onboardingComplete&&x("/onboarding")},[u,t,x]),b.useEffect(()=>{let C=t?.tourComplete||Mn.current;if(!C&&t?.id)try{C=!!localStorage.getItem(`tourDone_${t.id}`)}catch{}if(T&&t&&!C){const K=setTimeout(()=>Ar(!0),600);return()=>clearTimeout(K)}},[T,t]),b.useEffect(()=>{if(!(!T||!t?.id)){try{if(localStorage.getItem(`targetHint_${t.id}`))return}catch{}if(!t?.weeklyWorkoutTarget){const C=setTimeout(()=>et(!0),1500);return()=>clearTimeout(C)}}},[T,t]),b.useEffect(()=>{if(t)try{const C=sessionStorage.getItem(`cbDash_${t.id}`);if(C){const K=JSON.parse(C);ee(K.programmePct??0),te(K.programmeName??""),Te(K.totalWorkouts??0),R(K.habitWeekPct??0),I(K.nutritionTotals??{protein:0,carbs:0,fats:0,calories:0}),M(K.nutritionTargetData??null),gt(K.todayHabitsCount??0),se(K.nextSession??null),Re(K.hasProgramme??!1),P(K.programmeComplete??!1),Be(K.weeklyWorkouts??0),Oe(K.weeklyWorkoutTarget??T2),Es(K.pbCount??0),wt(K.topPBs??[]),Ct(K.leaderboardTop3??[]),qt(K.unlockedBadges??[]),vs.current=K.unlockedBadges??[],nn(K.streakWeeks??0),S(!0)}}catch{}},[t]),b.useEffect(()=>{t?.photoURL&&zt(t.photoURL),t?.weeklyWorkoutTarget&&Oe(t.weeklyWorkoutTarget)},[t]),b.useEffect(()=>{if(!t)return;const C=Fs($t(pe,"notifications"),bs("toId","==",t.id)),K=Ck(C,qe=>{const Ze=qe.docs.map(_t=>({id:_t.id,..._t.data()}));Ze.sort((_t,Vt)=>{const dt=_t.createdAt?.toMillis?.()||0;return(Vt.createdAt?.toMillis?.()||0)-dt}),W(Ze.slice(0,50))},qe=>{console.error("Notification listener error:",qe),qe.code==="permission-denied"&&console.warn("Firestore rules may be missing for the notifications collection. Please update your Firestore rules in the Firebase Console.")});return()=>K()},[t]),b.useEffect(()=>{const C=K=>{_e.current&&!_e.current.contains(K.target)&&ce(!1)};return document.addEventListener("mousedown",C),()=>document.removeEventListener("mousedown",C)},[]),b.useEffect(()=>{if(!t)return;const C=t.id;(async()=>{try{const[K,qe,Ze]=await Promise.all([Is(Fs($t(pe,"buddies"),bs("user1","==",C))),Is(Fs($t(pe,"buddies"),bs("user2","==",C))),Is($t(pe,"clients"))]),_t=new Set;[...K.docs,...qe.docs].forEach(dt=>{const es=dt.data();_t.add(es.user1===C?es.user2:es.user1)});const Vt={};Ze.docs.forEach(dt=>{Vt[dt.id]=dt.data()}),z(Array.from(_t).filter(dt=>Vt[dt]).map(dt=>({id:dt,name:Vt[dt].name,photoURL:Vt[dt].photoURL||null})))}catch(K){console.error("Error loading buddies for mentions:",K)}})()},[t]);const ve=Ns.filter(C=>!C.read).length,je=async()=>{const C=Ns.filter(qe=>!qe.read);if(!C.length)return;const K=g2(pe);C.forEach(qe=>K.update(We(pe,"notifications",qe.id),{read:!0})),await K.commit()},it=async()=>{if(!Ns.length)return;const C=g2(pe);Ns.forEach(K=>C.delete(We(pe,"notifications",K.id))),await C.commit()},at=async(C,K,qe={})=>{if(!(!t||C===t.id))try{await fa($t(pe,"notifications"),{toId:C,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:K,read:!1,createdAt:vr(),...qe})}catch(Ze){console.error("Notification create error:",Ze),Ze.code==="permission-denied"&&He("Notifications blocked  check Firestore rules","error")}},pt=(C,K)=>{const qe=K==="compose"?Nn.current?.selectionStart:null,_t=(qe!=null?C.slice(0,qe):C).match(/@(\w*)$/);if(_t){rt(!0),It(K),re(_t[1].toLowerCase());const Vt=E.filter(dt=>dt.name&&dt.name.toLowerCase().includes(_t[1].toLowerCase())).slice(0,5);ds(Vt)}else rt(!1),ds([])},Yt=(C,K)=>{if(K==="compose"){const qe=Nn.current,Ze=$e,_t=qe?.selectionStart??Ze.length,Vt=Ze.slice(0,_t),dt=Ze.slice(_t),es=Vt.replace(/@\w*$/,`@${C.name} `);bt(es+dt),setTimeout(()=>{qe?.focus(),qe.selectionStart=qe.selectionEnd=es.length},0)}else{const Ze=(Ee[K]||"").replace(/@\w*$/,`@${C.name} `);Ne(_t=>({..._t,[K]:Ze}))}rt(!1),ds([])},Qt=C=>C&&C.split(/(@\w[\w\s]*?\s)/g).map((qe,Ze)=>qe.startsWith("@")&&E.some(_t=>qe.trim()===`@${_t.name}`)?r.jsx("span",{className:"mention-highlight",children:qe.trim()},Ze):qe),Jt=async C=>{const K=C.target.files?.[0];if(!(!K||!t)){if(!K.type.startsWith("image/")){He("Please select an image file","error");return}if(K.size>5*1024*1024){He("Image must be under 5MB","error");return}jt(!0);try{const qe=await new Promise(Vt=>{const dt=new Image;dt.onload=()=>{const es=document.createElement("canvas"),ss=400;let Cs=dt.width,ps=dt.height;Cs>ps?(ps=ps/Cs*ss,Cs=ss):(Cs=Cs/ps*ss,ps=ss),es.width=Cs,es.height=ps,es.getContext("2d").drawImage(dt,0,0,Cs,ps),es.toBlob(Bs=>Vt(Bs),"image/jpeg",.75)},dt.src=URL.createObjectURL(K)}),Ze=gi(yi,`profilePhotos/${t.id}`);await Sh(Ze,qe);const _t=await co(Ze);await Jr(We(pe,"clients",t.id),{photoURL:_t}),zt(_t),l({photoURL:_t}),He("Profile photo updated!","success")}catch(qe){console.error("Photo upload error:",qe),He("Failed to upload photo","error")}jt(!1),tt.current&&(tt.current.value="")}};b.useEffect(()=>{const C=()=>{const qe=new Date,Ze=new Date(qe);Ze.setHours(23,59,59,999);const _t=Ze-qe,Vt=Math.floor(_t/(1e3*60*60)),dt=Math.floor(_t%(1e3*60*60)/(1e3*60)),es=Math.floor(_t%(1e3*60)/1e3);O({hours:Vt,minutes:dt,seconds:es}),V(60-es)};C();const K=setInterval(C,1e3);return()=>clearInterval(K)},[]),b.useEffect(()=>{const C=setInterval(()=>{Me(K=>(K+1)%Hp.length)},8e3);return()=>clearInterval(C)},[]),b.useEffect(()=>{if(!n||!t)return;(async()=>{let K=null,qe=0,Ze=[],_t=!1,Vt=null;try{const dt=nu(new Date),es=await Os(We(pe,"clientProgrammes",t.id));if(es.exists()){const wn=es.data(),Hn=ED[wn.templateId];if(Re(!0),Hn){const Pr=wn.completedSessions||{},Lr=Object.keys(Pr).length,jo=Hn.duration*Hn.daysPerWeek;ee(jo>0?Math.round(Lr/jo*100):0);const Ma=wn.templateId.replace(/_/g," ").replace(/\b\w/g,ya=>ya.toUpperCase());te(Ma);const rr=ND[wn.templateId];let Ja=!1;for(let ya=1;ya<=Hn.duration&&!Ja;ya++)for(let fr=0;fr<Hn.daysPerWeek&&!Ja;fr++)Pr[`w${ya}d${fr}`]||(se({week:ya,dayIdx:fr,label:rr?.[fr]||`Day ${fr+1}`}),Ja=!0);Ja||(P(!0),_t=!0)}}const ss=$t(pe,"workoutLogs"),Cs=Fs(ss,bs("clientId","==",t.id));K=await Is(Cs),Te(K.docs.length);const ps=new Date,Bs=ps.getDay(),Hr=Bs===0?6:Bs-1,Mr=new Date(ps);Mr.setDate(ps.getDate()-Hr),Mr.setHours(0,0,0,0);const un=Mr.getTime(),yn=K.docs.filter(wn=>{const Hn=wn.data().completedAt;return Hn?(Hn.toDate?Hn.toDate().getTime():new Date(Hn).getTime())>=un:!1}).length;Be(yn);const qn=$t(pe,"habitLogs"),Qn=Fs(qn,bs("clientId","==",t.id),bs("date","==",dt)),sr=await Is(Qn);let nr=0;if(!sr.empty){const wn=sr.docs[0].data().habits||{};nr=Math.min(Object.values(wn).filter(Boolean).length,_)}R(Math.round(nr/_*100)),gt(nr);const Dr=await Os(We(pe,"nutritionTargets",t.id));Dr.exists()&&(M(Dr.data()),Vt=Dr.data());const _r=await Os(We(pe,"nutritionLogs",`${t.id}_${dt}`));if(_r.exists()){const Hn=(_r.data().entries||[]).reduce((Pr,Lr)=>({protein:Pr.protein+(Lr.protein||0),carbs:Pr.carbs+(Lr.carbs||0),fats:Pr.fats+(Lr.fats||0),calories:Pr.calories+(Lr.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});I(Hn)}}catch(dt){console.error("Error loading dashboard stats:",dt)}try{let dt=[];const es=await Os(We(pe,"coreBuddyPBs",t.id));if(es.exists()){const ss=es.data().exercises||{};Es(Object.keys(ss).length),qe=Object.keys(ss).length,dt=Object.entries(ss).sort(([,Cs],[,ps])=>(ps.weight||0)-(Cs.weight||0)).slice(0,3).map(([Cs,ps])=>({name:Cs,weight:ps.weight,reps:ps.reps}))}Ze=dt,wt(dt)}catch(dt){console.error("PB fetch error:",dt)}try{const dt=$t(pe,"clients"),es=Fs(dt,bs("leaderboardOptIn","==",!0)),Cs=(await Is(es)).docs.map(ps=>({id:ps.id,name:ps.data().name,photoURL:ps.data().photoURL||null}));Ct(Cs.slice(0,3))}catch(dt){console.error("Leaderboard preview error:",dt)}try{let dt=0;if(K){const un=K.docs.map(yn=>yn.data().date).filter(Boolean).sort().reverse();if(un.length>0){const yn=new Date;let qn=new Date(yn);e:for(let Qn=0;Qn<52;Qn++){const sr=new Date(qn),nr=sr.getDay(),Dr=nr===0?6:nr-1;sr.setDate(sr.getDate()-Dr),sr.setHours(0,0,0,0);const _r=new Date(sr);_r.setDate(_r.getDate()+7);const wn=nu(sr),Hn=nu(_r);if(un.some(Lr=>Lr>=wn&&Lr<Hn))dt++;else{if(Qn>0)break e;break}qn.setDate(qn.getDate()-7)}}}nn(dt);let es=0;for(let un=0;un<30;un++){const yn=new Date;yn.setDate(yn.getDate()-un);const qn=nu(yn);try{const Qn=await Is(Fs($t(pe,"habitLogs"),bs("clientId","==",t.id),bs("date","==",qn)));if(Qn.empty)break;{const sr=Qn.docs[0].data().habits||{};if(Object.values(sr).filter(Boolean).length>=_)es++;else break}}catch{break}}Hs(es);let ss=0;for(let un=0;un<30;un++){const yn=new Date;yn.setDate(yn.getDate()-un);const qn=nu(yn);try{const Qn=await Os(We(pe,"nutritionLogs",`${t.id}_${qn}`));if(Qn.exists()&&(Qn.data().entries||[]).length>0)if(Vt){const nr=(Qn.data().entries||[]).reduce((Dr,_r)=>({protein:Dr.protein+(_r.protein||0),carbs:Dr.carbs+(_r.carbs||0),fats:Dr.fats+(_r.fats||0)}),{protein:0,carbs:0,fats:0});if(nr.protein>=(Vt.protein||0)&&nr.carbs>=(Vt.carbs||0)&&nr.fats>=(Vt.fats||0))ss++;else break}else ss++;else break}catch{break}}xs(ss);const Cs=K?K.docs.length:0,ps=[],Bs=un=>ps.push(un);Cs>=1&&Bs("first_workout"),Cs>=10&&Bs("workouts_10"),Cs>=25&&Bs("workouts_25"),Cs>=50&&Bs("workouts_50"),Cs>=100&&Bs("workouts_100"),dt>=2&&Bs("streak_2"),dt>=4&&Bs("streak_4"),dt>=8&&Bs("streak_8"),qe>=1&&Bs("first_pb"),qe>=5&&Bs("pbs_5"),qe>=10&&Bs("pbs_10"),qe>=100&&Bs("pbs_100"),ss>=7&&Bs("nutrition_7"),t.leaderboardOptIn&&Bs("leaderboard_join"),es>=7&&Bs("habits_7"),qt(ps);const Hr=vs.current;if(Hr!==null){const un=ps.filter(yn=>!Hr.includes(yn));if(un.length>0){const yn=Wn.find(qn=>qn.id===un[un.length-1]);yn&&setTimeout(()=>us(yn),600)}}vs.current=ps;const Mr={};ps.forEach(un=>{Mr[un]={unlockedAt:new Date().toISOString()}}),Ms(We(pe,"achievements",t.id),{badges:Mr,progress:{streakWeeks:dt,pbCount:qe,nutritionStreak:ss,habitStreak:es},updatedAt:new Date().toISOString()},{merge:!0}).catch(()=>{})}catch(dt){console.error("Achievement computation error:",dt)}S(!0)})()},[n,t,_]),b.useEffect(()=>{if(!(!T||!t))try{sessionStorage.setItem(`cbDash_${t.id}`,JSON.stringify({programmePct:L,programmeName:Y,totalWorkouts:ke,habitWeekPct:xe,nutritionTotals:D,nutritionTargetData:U,todayHabitsCount:ze,nextSession:B,hasProgramme:ge,programmeComplete:Q,weeklyWorkouts:ae,weeklyWorkoutTarget:Ue,pbCount:Xt,topPBs:Ot,leaderboardTop3:oe,unlockedBadges:Mt,streakWeeks:as}))}catch{}},[T,L,Y,ke,xe,D,U,ze,B,ge,Q,ae,Ue,Xt,Ot,oe,Mt,as,t]);const Dn=b.useCallback(async()=>{if(Mn.current=!0,Ar(!1),l({tourComplete:!0}),t?.id){try{localStorage.setItem(`tourDone_${t.id}`,"1")}catch{}try{await Jr(We(pe,"clients",t.id),{tourComplete:!0})}catch(C){console.error("Failed to save tour completion:",C)}}},[t,l]),os=b.useCallback(async C=>{if(Oe(C),ot(!1),et(!1),t?.id){try{localStorage.setItem(`targetHint_${t.id}`,"1")}catch{}try{await Jr(We(pe,"clients",t.id),{weeklyWorkoutTarget:C})}catch(K){console.error("Failed to save weekly target:",K)}}},[t]),Ss=C=>{const K=C.currentTarget,qe=K.querySelector(".ripple");qe&&qe.remove();const Ze=K.getBoundingClientRect(),_t=Math.max(Ze.width,Ze.height),Vt=C.clientX-Ze.left-_t/2,dt=C.clientY-Ze.top-_t/2,es=document.createElement("span");es.className="ripple",es.style.cssText=`width:${_t}px;height:${_t}px;left:${Vt}px;top:${dt}px;`,K.appendChild(es),setTimeout(()=>es.remove(),600)},xn=t?.name?.split(" ")[0]||"there",er=Math.min(Math.round(ae/Ue*100),100),Ps=[{label:"Programme",value:`${L}%`,pct:L,color:"var(--color-primary)",size:"normal"},{label:"Workouts",value:`${ae}/${Ue}`,pct:er,color:"var(--color-primary)",size:"large",editable:!0},{label:"Habits Today",value:`${xe}%`,pct:xe,color:"var(--color-primary)",size:"normal"}],$s=C=>!U||!U[C]?0:Math.min(Math.round(D[C]/U[C]*100),100),Zt=(()=>{const C=new Date().getHours();return T&&ze>=_&&D.calories>0?{main:"Smashed it today,",sub:"Rest up and go again tomorrow."}:C>=5&&C<12?{main:"Rise and grind,",sub:"let's get after it!"}:C>=12&&C<17?{main:"Oye",sub:"crack on and make it count!"}:C>=17&&C<21?{main:"Evening session?",sub:"Let's finish strong!"}:{main:"Burning the midnight oil,",sub:"Respect the hustle!"}})(),Ls=T?g&&ge&&B&&!Q?{label:"NEXT SESSION",message:`Week ${B.week}, Day ${B.dayIdx+1}  ${B.label}`,cta:"Continue",action:()=>x("/client/core-buddy/programmes"),pct:L,ringLabel:`${L}%`}:ze<_?{label:"DAILY HABITS",message:`${ze}/${_} completed`,cta:"Open Habits",action:()=>x("/client/core-buddy/consistency"),pct:xe,ringLabel:`${ze}/${_}`}:g&&D.calories===0?{label:"NUTRITION",message:"No meals logged today",cta:"Log Meal",action:()=>x("/client/core-buddy/nutrition"),pct:0,ringLabel:"0"}:g&&!ge?{label:"PROGRAMMES",message:"Start a programme to level up",cta:"Browse",action:()=>x("/client/core-buddy/workouts"),pct:0,ringLabel:""}:g&&Q?{label:"COMPLETE",message:"Programme finished!",cta:"New Programme",action:()=>x("/client/core-buddy/workouts"),pct:100,ringLabel:"100%"}:{label:"TODAY",message:"You're crushing it!",cta:null,action:null,pct:100,ringLabel:""}:null,on=b.useCallback(async()=>{if(t){ne(!0);try{const C=await Is(Fs($t(pe,"posts"),bs("authorId","==",t.id),Qh("createdAt","desc"),Xh(30)));ut(C.docs.map(qe=>({id:qe.id,...qe.data()})));const K=await Is(Fs($t(pe,"postLikes"),bs("userId","==",t.id)));Kt(new Set(K.docs.map(qe=>qe.data().postId)))}catch(C){console.error("Error loading journey:",C)}finally{ne(!1)}}},[t]);b.useEffect(()=>{T&&t&&on()},[T,t,on]);const tr=C=>{const K=C.target.files?.[0];if(K){if(!K.type.startsWith("image/")){He("Please select an image file","error");return}if(K.size>10*1024*1024){He("Image must be under 10MB","error");return}vt(K),Ae(URL.createObjectURL(K))}},zn=()=>{vt(null),X&&URL.revokeObjectURL(X),Ae(null),Ks.current&&(Ks.current.value="")},Sn=async()=>{if(!(!$e.trim()&&!Ye||Ge||!t)){ht(!0);try{let C=null;if(Ye){const Ze=await SD(Ye),_t=`${Date.now()}_${Math.random().toString(36).slice(2,8)}`,Vt=gi(yi,`postImages/${t.id}/${_t}`);await Sh(Vt,Ze),C=await co(Vt)}await fa($t(pe,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:$e.trim(),type:C?"image":"text",imageURL:C||null,createdAt:vr(),likeCount:0,commentCount:0});const qe=$e.trim().match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(qe){const Ze=new Set;qe.forEach(_t=>{const Vt=_t.slice(1).trim(),dt=E.find(es=>es.name&&es.name.toLowerCase()===Vt.toLowerCase());dt&&!Ze.has(dt.id)&&(Ze.add(dt.id),at(dt.id,"mention",{}))})}bt(""),zn(),Nn.current&&(Nn.current.style.height="auto"),await on(),He("Posted!","success")}catch(C){console.error("Error posting:",C),He(C?.message||"Failed to post","error")}finally{ht(!1)}}},Kn=async C=>{if(window.confirm("Delete this post?"))try{await Tr(We(pe,"posts",C)),ut(K=>K.filter(qe=>qe.id!==C)),He("Post deleted","info")}catch(K){console.error("Delete error:",K),He("Failed to delete","error")}},hr=async C=>{if(!t)return;const K=t.id,qe=`${C}_${K}`,Ze=Je.has(C),_t=new Set(Je);Ze?_t.delete(C):_t.add(C),Kt(_t),ut(Vt=>Vt.map(dt=>dt.id===C?{...dt,likeCount:Math.max(0,(dt.likeCount||0)+(Ze?-1:1))}:dt));try{if(Ze)await Tr(We(pe,"postLikes",qe)),await Jr(We(pe,"posts",C),{likeCount:Go(-1)});else{await Ms(We(pe,"postLikes",qe),{postId:C,userId:K,createdAt:vr()}),await Jr(We(pe,"posts",C),{likeCount:Go(1)});const Vt=Xe.find(dt=>dt.id===C);Vt&&at(Vt.authorId,"like",{postId:C})}}catch(Vt){console.error("Like error:",Vt),on()}},Yn=async C=>{try{const K=await Is(Fs($t(pe,"postComments"),bs("postId","==",C),Qh("createdAt","asc"),Xh(50)));Se(qe=>({...qe,[C]:K.docs.map(Ze=>({id:Ze.id,...Ze.data()}))}))}catch(K){console.error("Error loading comments:",K)}},mr=C=>{const K=new Set(Ht);K.has(C)?K.delete(C):(K.add(C),fe[C]||Yn(C)),F(K)},Ir=async C=>{const K=(Ee[C]||"").trim(),qe=Dt[C];if(!(!K&&!qe||!t)){Nt(Ze=>({...Ze,[C]:!0}));try{let Ze=null;if(qe){const ss=gi(yi,`comment-images/${Date.now()}_${qe.name}`);await Sh(ss,qe),Ze=await co(ss)}const _t={postId:C,authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:K||"",createdAt:vr()};Ze&&(_t.imageURL=Ze);const Vt=lt[C];Vt&&(_t.replyToId=Vt.id,_t.replyToName=Vt.authorName),await fa($t(pe,"postComments"),_t),await Jr(We(pe,"posts",C),{commentCount:Go(1)});const dt=Xe.find(ss=>ss.id===C);dt&&at(dt.authorId,"comment",{postId:C});const es=K.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(es){const ss=new Set;es.forEach(Cs=>{const ps=Cs.slice(1).trim(),Bs=E.find(Hr=>Hr.name&&Hr.name.toLowerCase()===ps.toLowerCase());Bs&&!ss.has(Bs.id)&&(ss.add(Bs.id),at(Bs.id,"mention",{postId:C}))})}Ne(ss=>({...ss,[C]:""})),Xs(ss=>({...ss,[C]:null})),mn(ss=>({...ss,[C]:null})),Bt(ss=>({...ss,[C]:null})),cn.current[C]&&(cn.current[C].value=""),ut(ss=>ss.map(Cs=>Cs.id===C?{...Cs,commentCount:(Cs.commentCount||0)+1}:Cs)),await Yn(C)}catch(Ze){console.error("Comment error:",Ze),He("Failed to comment","error")}finally{Nt(Ze=>({...Ze,[C]:!1}))}}},Ws=async(C,K)=>{try{await Tr(We(pe,"postComments",K)),await Jr(We(pe,"posts",C),{commentCount:Go(-1)}),Se(qe=>({...qe,[C]:(qe[C]||[]).filter(Ze=>Ze.id!==K)})),ut(qe=>qe.map(Ze=>Ze.id===C?{...Ze,commentCount:Math.max((Ze.commentCount||1)-1,0)}:Ze))}catch(qe){console.error("Delete comment error:",qe),He("Failed to delete comment","error")}},na=(C,K)=>{const qe=K.target.files?.[0];if(!qe)return;if(qe.size>5*1024*1024){He("Image must be under 5MB","error");return}Xs(_t=>({..._t,[C]:qe}));const Ze=new FileReader;Ze.onload=_t=>mn(Vt=>({...Vt,[C]:_t.target.result})),Ze.readAsDataURL(qe)},_o=C=>{Xs(K=>({...K,[C]:null})),mn(K=>({...K,[C]:null})),cn.current[C]&&(cn.current[C].value="")},Xa=C=>{bt(C.target.value),C.target.style.height="auto",C.target.style.height=Math.min(C.target.scrollHeight,120)+"px",pt(C.target.value,"compose")},ko=(C,K)=>{Ne(qe=>({...qe,[C]:K})),pt(K,C)};return r.jsx(ga,{children:r.jsxs("div",{className:"cb-dashboard","data-theme":d?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsxs("div",{className:"header-notif-wrap",ref:_e,children:[r.jsxs("button",{className:"header-notif-btn",onClick:()=>{ce(!he),he||je()},"aria-label":"Notifications",children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),r.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),ve>0&&r.jsx("span",{className:"header-notif-badge",children:ve>9?"9+":ve})]}),he&&r.jsxs("div",{className:"notif-panel",children:[r.jsxs("div",{className:"notif-panel-header",children:[r.jsx("span",{className:"notif-panel-title",children:"Notifications"}),Ns.length>0&&r.jsx("button",{className:"notif-clear-btn",onClick:it,children:"Clear all"})]}),r.jsx("div",{className:"notif-panel-list",children:Ns.length===0?r.jsx("div",{className:"notif-empty",children:"No notifications yet"}):Ns.map(C=>r.jsxs("div",{className:`notif-item${C.read?"":" unread"}`,onClick:()=>{if(ce(!1),C.type==="buddy_request"||C.type==="buddy_accept")x(g?"/client/core-buddy/buddies":"/upgrade");else if((C.type==="like"||C.type==="comment")&&C.postId){if(!Ht.has(C.postId)){const K=new Set(Ht);K.add(C.postId),F(K),fe[C.postId]||Yn(C.postId)}setTimeout(()=>{const K=document.getElementById(`post-${C.postId}`);K&&K.scrollIntoView({behavior:"smooth",block:"center"})},150)}else C.type==="like"||C.type==="comment"?document.querySelector(".cb-journey-section")?.scrollIntoView({behavior:"smooth"}):C.type==="mention"&&x(`/client/core-buddy/profile/${C.fromId}`)},children:[r.jsx("div",{className:"notif-item-avatar",children:C.fromPhotoURL?r.jsx("img",{src:C.fromPhotoURL,alt:""}):r.jsx("span",{children:(C.fromName||"?")[0]})}),r.jsxs("div",{className:"notif-item-body",children:[r.jsxs("p",{className:"notif-item-text",children:[r.jsx("strong",{children:C.fromName})," ",C.type==="buddy_request"&&"sent you a buddy request",C.type==="buddy_accept"&&"accepted your buddy request",C.type==="like"&&"liked your post",C.type==="comment"&&"commented on your post",C.type==="mention"&&"mentioned you"]}),r.jsx("span",{className:"notif-item-time",children:$p(C.createdAt)})]})]},C.id))})]})]}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsxs("div",{className:"header-actions",children:[r.jsx("button",{onClick:p,"aria-label":"Toggle theme",children:d?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})}),r.jsx("button",{onClick:i,"aria-label":"Log out",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),r.jsx("polyline",{points:"16 17 21 12 16 7"}),r.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),r.jsxs("main",{className:"cb-main",children:[r.jsxs("div",{className:"cb-ring-container",children:[r.jsxs("div",{className:"cb-ring",children:[r.jsx("svg",{className:"cb-ring-svg",viewBox:"0 0 200 200",children:Tm.map((C,K)=>{const qe=K<$;return r.jsx("line",{x1:C.x1,y1:C.y1,x2:C.x2,y2:C.y2,className:`ring-tick ${qe?"elapsed":"remaining"}`,strokeWidth:C.thick?"3":"2"},K)})}),r.jsxs("div",{className:"cb-ring-center",children:[r.jsxs("div",{className:"cb-ring-logo",onClick:()=>tt.current?.click(),role:"button",tabIndex:0,"aria-label":"Change profile photo",children:[r.jsx("img",{src:kt||"/Logo.webp",alt:kt?"Profile":"Mind Core Fitness"}),r.jsx("div",{className:`cb-photo-overlay${Et?" uploading":""}`,children:Et?r.jsx("div",{className:"cb-photo-spinner"}):r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[r.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),r.jsx("input",{ref:tt,type:"file",accept:"image/*",onChange:Jt,style:{display:"none"}})]}),!kt&&!Et&&r.jsx("div",{className:"cb-photo-badge",onClick:()=>tt.current?.click(),children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[r.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),r.jsxs("div",{className:"cb-ring-countdown",children:[r.jsx("span",{className:"cb-timer-digit",children:String(j.hours).padStart(2,"0")}),r.jsx("span",{className:"cb-timer-colon",children:":"}),r.jsx("span",{className:"cb-timer-digit",children:String(j.minutes).padStart(2,"0")}),r.jsx("span",{className:"cb-timer-colon",children:":"}),r.jsx("span",{className:"cb-timer-digit cb-timer-seconds",children:String(j.seconds).padStart(2,"0")})]}),r.jsx("span",{className:"cb-ring-label",children:"remaining today"}),r.jsxs("p",{className:"cb-ring-tagline",children:[Hp[ye].text," ",r.jsx("strong",{children:Hp[ye].bold})]},ye)]}),r.jsx("div",{className:"cb-stats-row",children:Ps.map(C=>{const K=(C.size==="large",38),qe=2*Math.PI*K,Ze=qe-C.pct/100*qe,_t=C.editable;return r.jsxs("div",{className:`cb-stat-item${C.size==="large"?" cb-stat-large":""}`,children:[r.jsxs("div",{className:`cb-stat-ring${_t?" cb-stat-tappable":""}${_t&&yt?" cb-stat-hint":""}`,onClick:_t?()=>{ot(!0),et(!1)}:void 0,children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-stat-track",cx:"50",cy:"50",r:K}),r.jsx("circle",{className:"cb-stat-fill",cx:"50",cy:"50",r:K,style:{stroke:C.color},strokeDasharray:qe,strokeDashoffset:Ze})]}),r.jsx("span",{className:"cb-stat-value",style:{color:C.color},children:C.value})]}),r.jsx("span",{className:"cb-stat-label",children:C.label})]},C.label)})}),Ie&&r.jsx("div",{className:"cb-target-overlay",onClick:()=>ot(!1),children:r.jsxs("div",{className:"cb-target-picker",onClick:C=>C.stopPropagation(),children:[r.jsx("h4",{children:"Weekly workout goal"}),r.jsx("p",{children:"How many sessions per week?"}),r.jsx("div",{className:"cb-target-options",children:[1,2,3,4,5,6,7].map(C=>r.jsx("button",{className:`cb-target-option${C===Ue?" active":""}`,onClick:()=>os(C),children:C},C))})]})}),r.jsxs("p",{className:"cb-coach-msg",children:[Zt.main," ",r.jsx("strong",{children:xn}),"  ",Zt.sub]}),Ls&&r.jsxs("button",{className:"cb-nudge-card",onClick:Ls.action||void 0,style:Ls.action?void 0:{cursor:"default"},children:[r.jsxs("div",{className:"cb-nudge-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-nudge-ring-track",cx:"50",cy:"50",r:"38"}),r.jsx("circle",{className:"cb-nudge-ring-fill",cx:"50",cy:"50",r:"38",strokeDasharray:2*Math.PI*38,strokeDashoffset:2*Math.PI*38-Ls.pct/100*2*Math.PI*38})]}),r.jsx("span",{className:"cb-nudge-ring-val",children:Ls.ringLabel})]}),r.jsxs("div",{className:"cb-nudge-info",children:[r.jsx("span",{className:"cb-nudge-label",children:Ls.label}),r.jsx("span",{className:"cb-nudge-title",children:Ls.message}),Ls.cta&&r.jsxs("span",{className:"cb-nudge-cta",children:[Ls.cta," "]})]})]}),r.jsxs("div",{className:"cb-features",children:[t?.buddyEnabled&&r.jsxs("button",{className:"cb-feature-card cb-card-buddy ripple-btn",onClick:C=>{Ss(C),x("/client/core-buddy/buddy")},children:[r.jsx("div",{className:"cb-buddy-icon",children:r.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 2a4 4 0 0 1 4 4v2a4 4 0 0 1-8 0V6a4 4 0 0 1 4-4z"}),r.jsx("path",{d:"M18 14c2 1 3 3 3 5v2H3v-2c0-2 1-4 3-5"}),r.jsx("circle",{cx:"9",cy:"7",r:"0.5",fill:"currentColor"}),r.jsx("circle",{cx:"15",cy:"7",r:"0.5",fill:"currentColor"}),r.jsx("path",{d:"M9.5 10a2.5 2.5 0 0 0 5 0"}),r.jsx("path",{d:"M7 13c1.5 1 3.5 1.5 5 1.5s3.5-.5 5-1.5"})]})}),r.jsxs("div",{className:"cb-card-content",children:[r.jsxs("h3",{children:["Buddy ",r.jsx("span",{className:"cb-buddy-badge",children:"AI"})]}),r.jsx("p",{className:"cb-card-desc",children:"Your AI training partner"})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),g&&r.jsxs("button",{className:"cb-feature-card cb-card-nutrition cb-card-has-preview ripple-btn",onClick:C=>{Ss(C),x("/client/core-buddy/nutrition")},children:[r.jsxs("div",{className:"cb-card-top-row",children:[r.jsx("div",{className:"cb-card-content",children:r.jsx("h3",{children:"Today's Nutrition"})}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsx("div",{className:"cb-card-preview-row",children:r.jsx("div",{className:"cb-mini-rings",children:[{label:"P",pct:$s("protein"),color:"var(--color-primary)"},{label:"C",pct:$s("carbs"),color:"var(--color-primary)"},{label:"F",pct:$s("fats"),color:"var(--color-primary)"},{label:"Cal",pct:$s("calories"),color:"var(--color-primary)"}].map(C=>{const qe=2*Math.PI*38,Ze=qe-C.pct/100*qe;return r.jsxs("div",{className:"cb-mini-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-mini-track",cx:"50",cy:"50",r:38}),r.jsx("circle",{className:"cb-mini-fill",cx:"50",cy:"50",r:38,style:{stroke:C.color},strokeDasharray:qe,strokeDashoffset:Ze})]}),r.jsx("span",{style:{color:C.color},children:C.label})]},C.label)})})}),r.jsx("p",{className:"cb-card-desc",children:"Track macros, scan barcodes, log water"})]}),r.jsxs("button",{className:"cb-feature-card cb-card-workouts-hero ripple-btn",onClick:C=>{Ss(C),x("/client/core-buddy/workouts")},children:[r.jsx("h3",{className:"cb-hero-title",children:"Workouts"}),r.jsxs("div",{className:"cb-hero-stats",children:[r.jsxs("span",{children:[ae," this week"]}),r.jsx("span",{className:"cb-hero-dot",children:""}),r.jsxs("span",{children:[ke," total"]})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("div",{className:`cb-grid-row${g?"":" cb-grid-single"}`,children:[r.jsxs("button",{className:"cb-feature-card cb-grid-card cb-card-consistency ripple-btn",onClick:C=>{Ss(C),x("/client/core-buddy/consistency")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsx("h3",{children:"Habits"}),r.jsx("div",{className:"cb-habit-dots",children:Array.from({length:_},(C,K)=>r.jsx("span",{className:`cb-habit-dot${K<ze?" done":""}`},K))}),r.jsxs("span",{className:"cb-habit-dots-label",children:[ze,"/",_," today"]})]}),r.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),g&&r.jsxs("button",{className:"cb-feature-card cb-grid-card cb-card-progress ripple-btn",onClick:C=>{Ss(C),x("/client/personal-bests?mode=corebuddy")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsx("h3",{children:"PBs"}),Ot.length>0?r.jsx("div",{className:"cb-pb-preview",children:Ot.slice(0,2).map(C=>r.jsxs("div",{className:"cb-pb-entry",children:[r.jsx("span",{className:"cb-pb-name",children:C.name}),r.jsxs("span",{className:"cb-pb-value",children:[C.weight,"kg"]})]},C.name))}):r.jsxs("div",{className:"cb-progress-preview",children:[r.jsx("svg",{className:"cb-progress-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),r.jsx("span",{children:"Start lifting!"})]})]}),r.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]})]}),r.jsxs("button",{className:"cb-feature-card cb-card-leaderboard ripple-btn",onClick:C=>{Ss(C),x("/client/leaderboard")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsx("h3",{children:"Leaderboard"}),oe.length>0?r.jsx("div",{className:"cb-lb-preview",children:oe.map((C,K)=>{const qe=["#FFD700","#A8B4C0","#CD7F32"][K],Ze=C.name?C.name.split(" ").map(Vt=>Vt[0]).join("").slice(0,2).toUpperCase():"?",_t=C.id===t?.id;return r.jsxs("div",{className:`cb-lb-entry${_t?" cb-lb-me":""}`,children:[r.jsx("div",{className:"cb-lb-avatar",style:{borderColor:qe},children:C.photoURL?r.jsx("img",{src:C.photoURL,alt:"",className:"cb-lb-avatar-img"}):r.jsx("span",{children:Ze})}),r.jsxs("span",{className:"cb-lb-rank",style:{color:qe},children:["#",K+1]})]},C.id)})}):r.jsx("p",{children:"Opt in to compete with your Core Buddies"})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),g&&r.jsxs("button",{className:"cb-feature-card cb-card-buddies ripple-btn",onClick:C=>{Ss(C),x("/client/core-buddy/buddies")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsx("h3",{children:"Buddies"}),r.jsx("p",{children:"Connect with other members and track each other's progress"})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),g&&r.jsxs("div",{className:"cb-achievements-section",children:[r.jsx("h3",{className:"cb-achievements-title",children:"Achievements"}),r.jsx("div",{className:"cb-badges-scroll",children:Wn.map(C=>{const K=Mt.includes(C.id);return r.jsx("button",{className:`cb-badge${K?" unlocked":" locked"}`,onClick:()=>Ft(C),children:r.jsx("img",{src:C.img,alt:C.name,className:"cb-badge-img"})},C.id)})}),r.jsxs("p",{className:"cb-badges-count",children:[Mt.length,"/",Wn.length," unlocked"]})]}),g&&r.jsxs("div",{className:"cb-journey-section",children:[r.jsx("h3",{className:"cb-journey-title",children:"My Journey"}),r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"journey-compose",children:[r.jsx("div",{className:"journey-compose-avatar",children:kt?r.jsx("img",{src:kt,alt:""}):r.jsx("span",{children:ru(t?.name)})}),r.jsxs("div",{className:"journey-compose-body",style:{position:"relative"},children:[r.jsx("textarea",{ref:Nn,placeholder:"Share your progress... (use @ to mention)",value:$e,onChange:Xa,rows:1,maxLength:500}),Ke&&st==="compose"&&ft.length>0&&r.jsx("div",{className:"mention-dropdown",children:ft.map(C=>r.jsxs("button",{className:"mention-option",onClick:()=>Yt(C,"compose"),children:[r.jsx("div",{className:"mention-option-avatar",children:C.photoURL?r.jsx("img",{src:C.photoURL,alt:""}):r.jsx("span",{children:ru(C.name)})}),r.jsx("span",{children:C.name})]},C.id))}),X&&r.jsxs("div",{className:"journey-image-preview",children:[r.jsx("img",{src:X,alt:"Preview"}),r.jsx("button",{className:"journey-image-remove",onClick:zn,"aria-label":"Remove image",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),r.jsxs("div",{className:"journey-compose-actions",children:[r.jsx("button",{className:"journey-image-btn",onClick:()=>Ks.current?.click(),"aria-label":"Add image",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),r.jsx("input",{ref:Ks,type:"file",accept:"image/*",onChange:tr,hidden:!0}),($e.trim()||Ye)&&r.jsx("button",{className:"journey-post-btn",onClick:Sn,disabled:Ge,children:Ge?r.jsx("div",{className:"journey-btn-spinner"}):"Post"})]})]})]}),J?r.jsx("div",{className:"journey-loading",children:r.jsx("div",{className:"cb-spinner"})}):Xe.length===0?r.jsxs("div",{className:"journey-empty",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]}),r.jsx("p",{children:"Start sharing your fitness journey!"})]}):r.jsx("div",{className:"journey-list",children:Xe.map(C=>r.jsxs("div",{id:`post-${C.id}`,className:"journey-post",children:[r.jsxs("div",{className:"journey-post-header",children:[r.jsx("div",{className:"journey-post-avatar",children:C.authorPhotoURL?r.jsx("img",{src:C.authorPhotoURL,alt:""}):r.jsx("span",{children:ru(C.authorName)})}),r.jsxs("div",{className:"journey-post-meta",children:[r.jsx("span",{className:"journey-post-name",children:C.authorName}),r.jsx("span",{className:"journey-post-time",children:$p(C.createdAt)})]}),r.jsx("button",{className:"journey-delete-btn",onClick:()=>Kn(C.id),"aria-label":"Delete post",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),C.type==="workout_summary"&&C.metadata?r.jsxs("div",{className:"journey-card",children:[r.jsx("div",{className:"journey-card-logo-frame",children:r.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),r.jsx("h3",{className:"journey-card-title",children:C.metadata.title}),C.metadata.stats?.length>0&&r.jsx("p",{className:"journey-card-stats-line",children:C.metadata.stats.map(K=>`${K.value} ${K.label}`).join("    ")}),!C.metadata.stats?.length&&C.metadata.subtitle&&r.jsx("p",{className:"journey-card-stats-line",children:C.metadata.subtitle}),r.jsx("p",{className:"journey-card-cta",children:"I just completed a workout using Core Buddy "}),r.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):C.type==="badge_earned"&&C.metadata?r.jsxs("div",{className:"journey-card",children:[r.jsx("div",{className:"journey-card-logo-frame journey-card-logo-badge",children:r.jsx("img",{src:(Wn.find(K=>K.name===C.metadata.title)||Wn.find(K=>C.metadata.badges?.includes(K.name)))?.img||"/Logo.webp",alt:C.metadata.title,className:"journey-card-logo-img"})}),r.jsx("h3",{className:"journey-card-title",children:C.metadata.title}),(C.metadata.badgeDesc||(Wn.find(K=>K.name===C.metadata.title)||Wn.find(K=>C.metadata.badges?.includes(K.name)))?.desc)&&r.jsx("p",{className:"journey-card-stats-line",children:C.metadata.badgeDesc||(Wn.find(K=>K.name===C.metadata.title)||Wn.find(K=>C.metadata.badges?.includes(K.name)))?.desc}),r.jsx("p",{className:"journey-card-cta",children:"I just earned a badge on Core Buddy "}),r.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):C.type==="habits_summary"&&C.metadata?r.jsxs("div",{className:"journey-card",children:[r.jsx("div",{className:"journey-card-logo-frame",children:r.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),r.jsx("h3",{className:"journey-card-title",children:C.metadata.title}),C.metadata.stats?.length>0&&r.jsx("p",{className:"journey-card-stats-line",children:C.metadata.stats.map(K=>`${K.value} ${K.label}`).join("    ")}),C.metadata.subtitle&&r.jsx("p",{className:"journey-card-stats-line",children:C.metadata.subtitle}),r.jsx("p",{className:"journey-card-cta",children:"I just completed my daily habits with Core Buddy "}),r.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):r.jsxs(r.Fragment,{children:[C.content&&r.jsx("p",{className:"journey-post-content",children:Qt(C.content)}),C.imageURL&&r.jsx("div",{className:"journey-post-image",children:r.jsx("img",{src:C.imageURL,alt:"Post",loading:"lazy"})})]}),r.jsxs("div",{className:"journey-post-actions",children:[r.jsxs("button",{className:`journey-action-btn${Je.has(C.id)?" liked":""}`,onClick:()=>hr(C.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:Je.has(C.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),r.jsx("span",{children:C.likeCount||0})]}),r.jsxs("button",{className:`journey-action-btn${Ht.has(C.id)?" active":""}`,onClick:()=>mr(C.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),r.jsx("span",{children:C.commentCount||0})]})]}),Ht.has(C.id)&&r.jsxs("div",{className:"journey-comments",children:[fe[C.id]?.length>0?fe[C.id].map(K=>r.jsxs("div",{className:"journey-comment",children:[r.jsx("div",{className:"journey-comment-avatar",children:K.authorPhotoURL?r.jsx("img",{src:K.authorPhotoURL,alt:""}):r.jsx("span",{children:ru(K.authorName)})}),r.jsxs("div",{className:"journey-comment-body",children:[r.jsxs("div",{className:"journey-comment-bubble",children:[r.jsx("span",{className:"journey-comment-name",children:K.authorName}),K.replyToName&&r.jsxs("span",{className:"journey-comment-reply-tag",children:[r.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("polyline",{points:"9 14 4 9 9 4"}),r.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),K.replyToName]}),K.content&&r.jsx("span",{className:"journey-comment-text",children:Qt(K.content)}),K.imageURL&&r.jsx("img",{className:"journey-comment-image",src:K.imageURL,alt:"Comment",loading:"lazy"})]}),r.jsxs("div",{className:"journey-comment-actions-row",children:[r.jsx("span",{className:"journey-comment-time",children:$p(K.createdAt)}),r.jsx("button",{className:"journey-comment-reply-btn",onClick:()=>Bt(qe=>({...qe,[C.id]:{id:K.id,authorName:K.authorName}})),children:"Reply"}),r.jsx("button",{className:"journey-comment-delete-btn",onClick:()=>Ws(C.id,K.id),"aria-label":"Delete comment",children:r.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]})]},K.id)):r.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),lt[C.id]&&r.jsxs("div",{className:"journey-comment-replying",children:[r.jsxs("span",{children:["Replying to ",r.jsx("strong",{children:lt[C.id].authorName})]}),r.jsx("button",{onClick:()=>Bt(K=>({...K,[C.id]:null})),"aria-label":"Cancel reply",children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),vn[C.id]&&r.jsxs("div",{className:"journey-comment-img-preview",children:[r.jsx("img",{src:vn[C.id],alt:"Preview"}),r.jsx("button",{onClick:()=>_o(C.id),"aria-label":"Remove image",children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),r.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[r.jsx("button",{className:"journey-comment-img-btn",onClick:()=>cn.current[C.id]?.click(),"aria-label":"Add image",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),r.jsx("input",{ref:K=>{cn.current[C.id]=K},type:"file",accept:"image/*",onChange:K=>na(C.id,K),hidden:!0}),r.jsx("input",{type:"text",placeholder:"Comment",value:Ee[C.id]||"",onChange:K=>ko(C.id,K.target.value),onKeyDown:K=>{K.key==="Enter"&&Ir(C.id)},maxLength:300}),Ke&&st===C.id&&ft.length>0&&r.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:ft.map(K=>r.jsxs("button",{className:"mention-option",onClick:()=>Yt(K,C.id),children:[r.jsx("div",{className:"mention-option-avatar",children:K.photoURL?r.jsx("img",{src:K.photoURL,alt:""}):r.jsx("span",{children:ru(K.name)})}),r.jsx("span",{children:K.name})]},K.id))}),r.jsx("button",{onClick:()=>Ir(C.id),disabled:!(Ee[C.id]||"").trim()&&!Dt[C.id]||mt[C.id],children:mt[C.id]?r.jsx("div",{className:"journey-btn-spinner-sm"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),r.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},C.id))})]})]}),!g&&r.jsxs("button",{className:"cb-upgrade-cta",onClick:()=>x("/upgrade"),children:[r.jsx("span",{className:"cb-upgrade-cta-text",children:"Unlock the full experience"}),r.jsx("span",{className:"cb-upgrade-cta-sub",children:"Nutrition, buddies, achievements & more"}),r.jsxs("svg",{className:"cb-upgrade-cta-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M5 12h14"}),r.jsx("path",{d:"M12 5l7 7-7 7"})]})]})]})]}),ms&&r.jsx("div",{className:"cb-badge-overlay",onClick:()=>Ft(null),children:r.jsxs("div",{className:"cb-badge-overlay-content",onClick:C=>C.stopPropagation(),children:[r.jsx("img",{src:ms.img,alt:ms.name,className:`cb-badge-overlay-img${Mt.includes(ms.id)?"":" cb-badge-overlay-img-locked"}`}),Mt.includes(ms.id)?r.jsx("span",{className:"cb-badge-status unlocked",children:"Unlocked"}):r.jsx("span",{className:"cb-badge-status locked",children:"Locked"}),r.jsx("button",{className:"cb-badge-overlay-close",onClick:()=>Ft(null),children:"Tap to close"})]})}),r.jsx(ta,{active:"home"}),De&&r.jsxs("div",{className:`toast-notification ${De.type}`,children:[De.type==="info"&&r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),r.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),De.message]}),r.jsx(jD,{steps:G,active:fs,onFinish:Dn}),At&&r.jsxs("div",{className:"cb-celebration-overlay",onClick:()=>us(null),children:[r.jsx("div",{className:"cb-confetti-container",children:Array.from({length:30},(C,K)=>r.jsx("span",{className:"cb-confetti-piece",style:{"--angle":`${Math.random()*360}deg`,"--distance":`${80+Math.random()*120}px`,"--delay":`${Math.random()*.3}s`,"--color":["#FFD700","#FF6B6B","#4ECDC4","#45B7D1","#F7DC6F","#BB8FCE","#FF8C42","#38B6FF"][K%8],"--size":`${6+Math.random()*6}px`,"--drift":`${(Math.random()-.5)*60}px`}},K))}),r.jsxs("div",{className:"cb-celebration-content",onClick:C=>C.stopPropagation(),children:[r.jsx("div",{className:"cb-celebration-glow"}),r.jsx("img",{src:At.img,alt:At.name,className:"cb-celebration-badge-img"}),r.jsx("h2",{className:"cb-celebration-title",children:"Badge Unlocked!"}),r.jsx("p",{className:"cb-celebration-name",children:At.name}),r.jsx("button",{className:"cb-celebration-dismiss",onClick:()=>us(null),children:"Tap to continue"})]})]})]})})}const Wp=new Map;function Ji(){return new Date().toISOString().split("T")[0]}const E2=[{key:"breakfast",label:"Breakfast"},{key:"lunch",label:"Lunch"},{key:"dinner",label:"Dinner"},{key:"snacks",label:"Snacks"}],RD={breakfast:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1"}),r.jsx("path",{d:"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"}),r.jsx("line",{x1:"6",y1:"1",x2:"6",y2:"4"}),r.jsx("line",{x1:"10",y1:"1",x2:"10",y2:"4"}),r.jsx("line",{x1:"14",y1:"1",x2:"14",y2:"4"})]}),lunch:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}),dinner:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),snacks:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})};function AD(){const n=new Date().getHours();return n<11?"breakfast":n<14?"lunch":n<17?"snacks":"dinner"}function ID(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Rr(),{isDark:l,toggleTheme:u,accent:d}=Ia(),p=Zn(),[g,y]=b.useState("loading"),[x,_]=b.useState(null),[j,O]=b.useState({gender:"male",age:"",weight:"",weightUnit:"kg",height:"",heightUnit:"cm",heightFeet:"",heightInches:"",dailyActivity:"sedentary",trainingFrequency:"moderate",goal:"maintain",deficitLevel:"moderate"}),[$,V]=b.useState(null),[L,ee]=b.useState(Ji()),[Y,te]=b.useState({entries:[],water:0}),[ke,Te]=b.useState({protein:0,carbs:0,fats:0,calories:0}),[xe,R]=b.useState(!1),[T,S]=b.useState(!1),[D,I]=b.useState(()=>{const E=new Date;return{year:E.getFullYear(),month:E.getMonth()}}),[U,M]=b.useState(AD),[ze,gt]=b.useState(null),[B,se]=b.useState(null),[ge,Re]=b.useState(!1),[Q,P]=b.useState(null),[ae,Be]=b.useState(""),[Ue,Oe]=b.useState(!1),[Ie,ot]=b.useState(""),[yt,et]=b.useState([]),[Xt,Es]=b.useState(!1),[Ot,wt]=b.useState({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),[oe,Ct]=b.useState(null),[kt,zt]=b.useState("100"),[Et,jt]=b.useState(0),[tt,Mt]=b.useState("weight"),[qt,ms]=b.useState(0),[Ft,At]=b.useState(null);b.useRef(null);const us=b.useRef(!1),vs=b.useRef(null),as=b.useRef(null),nn=b.useRef(null),Ds=b.useCallback((E,z="info")=>{At({message:E,type:z}),setTimeout(()=>At(null),3e3)},[]);b.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),b.useEffect(()=>{if(!t?.id)return;(async()=>{try{const z=await Os(We(pe,"nutritionTargets",t.id));z.exists()?(_(z.data()),y("dashboard")):y("setup")}catch(z){console.error("Error loading nutrition data:",z),y("setup")}})()},[t?.id]),b.useEffect(()=>{if(!t?.id)return;(async()=>{try{const z=await Os(We(pe,"nutritionLogs",`${t.id}_${L}`));if(z.exists()){const ie=z.data();te({entries:ie.entries||[],water:ie.water||0})}else te({entries:[],water:0})}catch(z){console.error("Error loading log:",z),te({entries:[],water:0})}})()},[t?.id,L]),b.useEffect(()=>{const E=Y.entries.reduce((z,ie)=>({protein:z.protein+(ie.protein||0),carbs:z.carbs+(ie.carbs||0),fats:z.fats+(ie.fats||0),calories:z.calories+(ie.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});Te(E)},[Y.entries]);const Hs=async E=>{try{await Ms(We(pe,"nutritionLogs",`${t.id}_${L}`),{clientId:t.id,date:L,entries:E.entries,water:E.water,updatedAt:Rt.now()})}catch(z){console.error("Error saving nutrition log:",z)}},is=L===Ji(),xs=(E,z)=>new Date(E,z+1,0).getDate(),ye=(E,z)=>new Date(E,z,1).getDay(),Me=["January","February","March","April","May","June","July","August","September","October","November","December"],De=["Su","Mo","Tu","We","Th","Fr","Sa"],Qe=()=>{let E=parseFloat(j.weight);j.weightUnit==="lbs"&&(E*=.453592);let z;j.heightUnit==="cm"?z=parseFloat(j.height):z=(parseFloat(j.heightFeet)||0)*30.48+(parseFloat(j.heightInches)||0)*2.54;const ie=parseInt(j.age);let re=j.gender==="male"?10*E+6.25*z-5*ie+5:10*E+6.25*z-5*ie-161;const rt=re*{sedentary:1.2,light:1.3,moderate:1.4,active:1.5}[j.dailyActivity],st={low:100,moderate:200,high:300,daily:400},It=Math.round(rt+st[j.trainingFrequency]);let ft=It,ds,rn;switch(j.goal){case"lose":ft=It*(1-{light:.15,moderate:.2,harsh:.25}[j.deficitLevel]),ds=2.2,rn=.3;break;case"build":ft=It*1.1,ds=2,rn=.22;break;default:ds=1.8,rn=.25}ft=Math.max(ft,j.gender==="male"?1400:1100);const wr=Math.round(E*ds),fs=Math.round(ft*rn/9),Ar=Math.max(0,Math.round((ft-wr*4-fs*9)/4));V({calories:Math.round(ft),protein:wr,carbs:Ar,fats:fs,bmr:Math.round(re),neat:Math.round(rt),exerciseAdd:st[j.trainingFrequency],tdee:Math.round(It)})},He=async()=>{if($)try{const E={clientId:t.id,calories:$.calories,protein:$.protein,carbs:$.carbs,fats:$.fats,waterGoal:8,goal:j.goal,updatedAt:Rt.now()};await Ms(We(pe,"nutritionTargets",t.id),E),_(E),y("dashboard"),Ds("Macro targets saved!","success")}catch(E){console.error("Error saving targets:",E),Ds("Failed to save targets. Please try again.","error")}},Xe=()=>{const E=j.weight&&parseFloat(j.weight)>0,z=j.age&&parseInt(j.age)>0,ie=j.heightUnit==="cm"?j.height&&parseFloat(j.height)>0:j.heightFeet&&parseFloat(j.heightFeet)>0||j.heightInches&&parseFloat(j.heightInches)>0;return E&&z&&ie},ut="nut_favourite_foods",J=()=>{try{return JSON.parse(localStorage.getItem(ut)||"[]")}catch{return[]}},ne=E=>J().some(z=>z.name.toLowerCase()===(E||"").toLowerCase()),$e=E=>{const z=J(),ie=z.findIndex(re=>re.name.toLowerCase()===E.name.toLowerCase());ie>=0?z.splice(ie,1):z.unshift({name:E.name,protein:E.protein,carbs:E.carbs,fats:E.fats,calories:E.calories,serving:E.serving,per100g:E.per100g||null,servingUnit:E.servingUnit||"g",portion:E.portion||null}),localStorage.setItem(ut,JSON.stringify(z)),ms(re=>re+1)},bt=E=>{const z=[...Y.entries,{...E,meal:U,id:Date.now(),addedAt:new Date().toISOString()}],ie={...Y,entries:z};te(ie),Hs(ie),se(null),Ct(null),zt("100"),jt(0),Mt("weight"),wt({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),Ds("Food added!","success")},Ye=E=>{const z=Y.entries.filter(re=>re.id!==E),ie={...Y,entries:z};te(ie),Hs(ie)},vt=b.useRef(null),X=b.useRef([]),Ae=3,Ge=5,ht=async()=>{Re(!0);const E=document.querySelector("#barcode-reader");if(!E){Re(!1),Ds("Scanner container not found.","error");return}if(!vt.current)try{const ie=await Cr(()=>import("./quagga.min-BbicSfvA.js").then(re=>re.q),[]);vt.current=ie.default}catch(ie){console.error("Failed to load barcode scanner:",ie),Re(!1),Ds("Could not load scanner.","error");return}const z=vt.current;z.init({inputStream:{type:"LiveStream",target:E,constraints:{facingMode:"environment",width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080}}},locator:{patchSize:"medium",halfSample:!0},numOfWorkers:navigator.hardwareConcurrency||2,decoder:{readers:["ean_reader","ean_8_reader","upc_reader","upc_e_reader","code_128_reader","code_39_reader"]},locate:!0},ie=>{if(ie){console.error("Quagga init error:",ie),Re(!1),Ds("Could not access camera. Check permissions.","error");return}z.start(),us.current=!0}),X.current=[],z.onDetected(ie=>{const re=ie.codeResult.decodedCodes?.filter(rt=>rt.error!==void 0)?.map(rt=>rt.error)||[];if((re.length>0?re.reduce((rt,st)=>rt+st,0)/re.length:1)<.15){const rt=ie.codeResult.code,st=X.current;st.push(rt),st.length>Ge&&st.shift(),st.filter(ft=>ft===rt).length>=Ae&&(z.offDetected(),X.current=[],P(rt))}})},Je=()=>{const E=vt.current;us.current&&E&&(E.stop(),E.offDetected(),us.current=!1),Re(!1)},Kt=/\b(milk|semi.skimmed|skimmed|whole milk|oat milk|almond milk|soy milk|juice|smoothie|water|squash|cordial|cola|pepsi|fanta|lemonade|soda|beer|wine|cider|lager|spirit|whisky|vodka|rum|gin|brandy|cream|yoghurt drink|milkshake|coffee|tea|broth|stock|soup|sauce|ketchup|vinegar|oil|syrup|honey|custard|coconut water|kombucha|energy drink|protein shake)\b/i,Ht=E=>/ml|cl|\dl(?!b)|litre|liter|fl\s?oz/i.test((E||"").replace(/\s/g,"")),F=E=>{if(!E)return{value:100,unit:"g"};const z=E.toLowerCase().replace(/\s/g,""),ie=z.match(/([\d.]+)/),re=ie?parseFloat(ie[1]):100;return Ht(E)?/cl/.test(z)?{value:re*10,unit:"ml"}:/(?:^|\d)l(?!i)/.test(z)&&!/ml/.test(z)?{value:re*1e3,unit:"ml"}:{value:re,unit:"ml"}:{value:re,unit:"g"}},fe=E=>{if(Ht(E.serving_size)||Ht(E.quantity))return"ml";const z=E.product_name||E.product_name_en||"";return Kt.test(z)?"ml":"g"},Se=[{pattern:/\b(toast|bread|loaf|brioche|bagel|pitta|wrap|tortilla|crumpet|muffin|waffle|pancake)\b/i,label:"slice",weight:36},{pattern:/\begg\b/i,label:"egg",weight:60},{pattern:/\b(biscuit|cookie|digestive|hobnob|rich tea|oreo)\b/i,label:"biscuit",weight:13},{pattern:/\b(sausage|banger)\b/i,label:"sausage",weight:57},{pattern:/\b(rasher|bacon)\b/i,label:"rasher",weight:25},{pattern:/\b(rice cake)\b/i,label:"cake",weight:9},{pattern:/\b(cracker|ryvita)\b/i,label:"cracker",weight:10}],Ee=(E,z)=>{const ie=E||"",re=ie.match(/\((\d+\.?\d*)\s*g\)/i),Ke=ie.match(/(?:^|per\s+)(\d*\s*[a-z][a-z\s]*?)(?:\s*\(|\s*-\s*|\s*$)/i);if(re&&Ke){const It=parseFloat(re[1]);let ft=Ke[1].replace(/^\d+\s*/,"").trim();if(ft&&It>0)return{label:ft,weight:It}}const rt=ie.match(/(\d+\.?\d*)\s*g\s*[\/=]\s*(\d*\s*[a-z][a-z\s]*)/i);if(rt){const It=parseFloat(rt[1]);let ft=rt[2].replace(/^\d+\s*/,"").trim();if(ft&&It>0)return{label:ft,weight:It}}const st=z||"";for(const{pattern:It,label:ft,weight:ds}of Se)if(It.test(st))return{label:ft,weight:ds};return null},Ne=E=>{const z=E.nutriments||{},ie=fe(E),re=F(E.serving_size),Ke=ie==="ml"?re.unit==="ml"?re.value:100:re.value,rt=E.product_name||E.product_name_en||"Unknown Product",st=Ee(E.serving_size,rt);return{name:rt,brand:E.brands||"",image:E.image_small_url||E.image_url||null,servingSize:E.serving_size||"100g",servingValue:Ke,servingUnit:ie,portion:st,protein:Math.round(z.proteins_100g||z.proteins||0),carbs:Math.round(z.carbohydrates_100g||z.carbohydrates||0),fats:Math.round(z.fat_100g||z.fat||0),calories:Math.round(z["energy-kcal_100g"]||z["energy-kcal"]||(z.energy_100g?z.energy_100g/4.184:0)),per100g:!0}},mt=async E=>{Oe(!0);try{const z=`https://world.openfoodfacts.org/api/v2/product/${E}?fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,ie=await fetch(z);if(!ie.ok)throw new Error(`HTTP ${ie.status}`);const re=await ie.json();if(re.status==="success"||re.status===1||re.product){const Ke=Ne(re.product);Ke.calories===0&&Ke.protein===0&&Ke.carbs===0?Ds("Product found but no nutrition data available.","error"):(Ct(Ke),Ke.portion?(jt(1),zt(String(Ke.portion.weight)),Mt("portion")):(jt(0),zt(String(Ke.servingValue||100)),Mt("weight")),Be(""))}else Ds("Product not found. Try search or manual entry.","error")}catch(z){console.error("Barcode lookup error:",z),Ds("Failed to look up product. Check your connection.","error")}Oe(!1)},Nt=(E,z,ie)=>{const re=E.toLowerCase().trim(),Ke=z.toLowerCase().trim(),rt=ie.toLowerCase().trim();let st=0;return(re===rt||re===rt+"s"||re+"s"===rt)&&(st+=100),(re.endsWith(" "+rt)||re.endsWith(" "+rt+"s"))&&(st+=40),(re.startsWith(rt+" ")||re.startsWith(rt+"s "))&&(st+=15),rt.split(/\s+/).some(ft=>Ke===ft||Ke.startsWith(ft))&&(st+=30),st+=Math.max(0,30-re.length),st},lt=async()=>{if(!Ie.trim())return;vs.current&&vs.current.abort();const E=new AbortController;vs.current=E;const z=Ie.trim().toLowerCase(),ie=z.split(/\s+/).filter(Boolean);if(Wp.has(z)){et(Wp.get(z));return}Es(!0);try{const Ke=`https://world.openfoodfacts.org/cgi/search.pl?search_terms=${encodeURIComponent(Ie.trim())}&search_simple=1&action=process&json=1&page_size=10&lc=en&sort_by=unique_scans_n&fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,rt=await fetch(Ke,{signal:E.signal});if(!rt.ok)throw new Error(`HTTP ${rt.status}`);const It=((await rt.json()).products||[]).map(ft=>Ne(ft)).filter(ft=>ft.name!=="Unknown Product"&&(ft.calories>0||ft.protein>0)).filter(ft=>{const ds=(ft.name+" "+ft.brand).toLowerCase();return ie.every(rn=>ds.includes(rn))}).sort((ft,ds)=>Nt(ds.name,ds.brand,z)-Nt(ft.name,ft.brand,z)).slice(0,10);Wp.set(z,It),et(It),It.length===0&&Ds("No results found. Try a different search.","info")}catch(re){if(re.name==="AbortError")return;console.error("Search error:",re),Ds("Search failed. Check your connection.","error")}Es(!1)};b.useEffect(()=>{if(as.current&&clearTimeout(as.current),!(!Ie.trim()||B!=="search"||oe))return as.current=setTimeout(()=>{lt()},700),()=>clearTimeout(as.current)},[Ie]);const Bt=()=>{const E={...Y,water:Y.water+1};te(E),Hs(E)},Dt=()=>{if(Y.water<=0)return;const E={...Y,water:Y.water-1};te(E),Hs(E)},Xs=l,vn={"ring-protein":Xs?"#2dd4bf":"#14b8a6","ring-carbs":Xs?"#fbbf24":"#f59e0b","ring-fats":Xs?"#a78bfa":"#8b5cf6","ring-cals":"var(--color-primary)"},mn=80,Nn=2*Math.PI*mn,Ks=(E,z,ie,re,Ke)=>{const rt=re>0?Math.min(100,Math.round(ie/re*100)):0,st=Nn-rt/100*Nn,It=vn[Ke]||"#14b8a6";return r.jsxs("div",{className:"nut-ring-wrap",children:[r.jsxs("svg",{className:"nut-ring-svg",viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"nut-arc-track",cx:"100",cy:"100",r:mn}),r.jsx("circle",{className:"nut-arc-fill",cx:"100",cy:"100",r:mn,style:{stroke:It},strokeDasharray:Nn,strokeDashoffset:st})]}),r.jsxs("div",{className:"nut-ring-center",children:[r.jsx("span",{className:"nut-ring-value",style:{color:It},children:Math.round(ie)}),r.jsxs("span",{className:"nut-ring-target",children:["/ ",re,E==="Calories"?"":"g"]}),r.jsx("span",{className:"nut-ring-label",style:{color:It},children:z})]}),r.jsxs("span",{className:"nut-ring-pct",style:{color:It},children:[rt,"%"]})]})};if(b.useEffect(()=>{if(!Q)return;const E=setTimeout(()=>{const z=Q;Je(),P(null),mt(z)},1500);return()=>clearTimeout(E)},[Q]),b.useEffect(()=>()=>{const E=vt.current;if(us.current&&E){try{E.stop(),E.offDetected()}catch{}us.current=!1}},[]),i||g==="loading")return r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsx("div",{className:"nut-loading-inline",children:r.jsx("div",{className:"cb-loading-spinner"})})]});if(g==="setup")return r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"nut-main",children:[r.jsxs("div",{className:"nut-setup-intro",children:[r.jsx("h2",{children:"Set Your Daily Targets"}),r.jsx("p",{children:"Calculate your personalised macros based on your body and goals."})]}),r.jsxs("div",{className:"nut-calc-form",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Gender"}),r.jsxs("div",{className:"nut-toggle-group",children:[r.jsx("button",{className:j.gender==="male"?"active":"",onClick:()=>{O(E=>({...E,gender:"male"})),V(null)},children:"Male"}),r.jsx("button",{className:j.gender==="female"?"active":"",onClick:()=>{O(E=>({...E,gender:"female"})),V(null)},children:"Female"})]})]}),r.jsxs("div",{className:"nut-form-row",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Age"}),r.jsx("input",{type:"number",value:j.age,onChange:E=>{O(z=>({...z,age:E.target.value})),V(null)},placeholder:"Years",min:"15",max:"100"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Weight"}),r.jsxs("div",{className:"nut-input-unit",children:[r.jsx("input",{type:"number",value:j.weight,onChange:E=>{O(z=>({...z,weight:E.target.value})),V(null)},placeholder:j.weightUnit,min:"30",max:"300"}),r.jsxs("div",{className:"nut-unit-toggle",children:[r.jsx("button",{className:j.weightUnit==="kg"?"active":"",onClick:()=>{O(E=>({...E,weightUnit:"kg"})),V(null)},children:"kg"}),r.jsx("button",{className:j.weightUnit==="lbs"?"active":"",onClick:()=>{O(E=>({...E,weightUnit:"lbs"})),V(null)},children:"lbs"})]})]})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Height"}),r.jsxs("div",{className:"nut-input-unit",children:[j.heightUnit==="cm"?r.jsx("input",{type:"number",value:j.height,onChange:E=>{O(z=>({...z,height:E.target.value})),V(null)},placeholder:"cm",min:"100",max:"250"}):r.jsxs("div",{className:"nut-height-imperial",children:[r.jsx("input",{type:"number",value:j.heightFeet,onChange:E=>{O(z=>({...z,heightFeet:E.target.value})),V(null)},placeholder:"ft",min:"4",max:"7"}),r.jsx("input",{type:"number",value:j.heightInches,onChange:E=>{O(z=>({...z,heightInches:E.target.value})),V(null)},placeholder:"in",min:"0",max:"11"})]}),r.jsxs("div",{className:"nut-unit-toggle",children:[r.jsx("button",{className:j.heightUnit==="cm"?"active":"",onClick:()=>{O(E=>({...E,heightUnit:"cm"})),V(null)},children:"cm"}),r.jsx("button",{className:j.heightUnit==="ft"?"active":"",onClick:()=>{O(E=>({...E,heightUnit:"ft"})),V(null)},children:"ft/in"})]})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Daily Activity (outside of training)"}),r.jsxs("select",{value:j.dailyActivity,onChange:E=>{O(z=>({...z,dailyActivity:E.target.value})),V(null)},children:[r.jsx("option",{value:"sedentary",children:"Sedentary  desk job, under 5k steps"}),r.jsx("option",{value:"light",children:"Lightly Active  office + walking, 5-8k steps"}),r.jsx("option",{value:"moderate",children:"Moderately Active  on feet often, 8-12k steps"}),r.jsx("option",{value:"active",children:"Very Active  physical job, 12k+ steps"})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Training Sessions per Week"}),r.jsxs("select",{value:j.trainingFrequency,onChange:E=>{O(z=>({...z,trainingFrequency:E.target.value})),V(null)},children:[r.jsx("option",{value:"low",children:"1-2 sessions"}),r.jsx("option",{value:"moderate",children:"3-4 sessions"}),r.jsx("option",{value:"high",children:"5-6 sessions"}),r.jsx("option",{value:"daily",children:"7+ sessions"})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Fitness Goal"}),r.jsxs("div",{className:"nut-goal-options",children:[r.jsxs("button",{className:j.goal==="lose"?"active":"",onClick:()=>{O(E=>({...E,goal:"lose"})),V(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"-"}),r.jsx("span",{children:"Lose Weight"})]}),r.jsxs("button",{className:j.goal==="maintain"?"active":"",onClick:()=>{O(E=>({...E,goal:"maintain"})),V(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"="}),r.jsx("span",{children:"Maintain"})]}),r.jsxs("button",{className:j.goal==="build"?"active":"",onClick:()=>{O(E=>({...E,goal:"build"})),V(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"+"}),r.jsx("span",{children:"Build Muscle"})]})]})]}),j.goal==="lose"&&r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Deficit Level"}),r.jsxs("div",{className:"nut-deficit-options",children:[r.jsxs("button",{className:j.deficitLevel==="light"?"active":"",onClick:()=>{O(E=>({...E,deficitLevel:"light"})),V(null)},children:[r.jsx("strong",{children:"Mild"}),r.jsx("span",{children:"15% below TDEE"})]}),r.jsxs("button",{className:j.deficitLevel==="moderate"?"active":"",onClick:()=>{O(E=>({...E,deficitLevel:"moderate"})),V(null)},children:[r.jsx("strong",{children:"Moderate"}),r.jsx("span",{children:"20% below TDEE"})]}),r.jsxs("button",{className:j.deficitLevel==="harsh"?"active":"",onClick:()=>{O(E=>({...E,deficitLevel:"harsh"})),V(null)},children:[r.jsx("strong",{children:"Aggressive"}),r.jsx("span",{children:"25% below TDEE"})]})]})]}),r.jsx("button",{className:"nut-calc-btn",onClick:Qe,disabled:!Xe(),children:"Calculate Macros"})]}),$&&r.jsxs("div",{className:"nut-calc-results",children:[r.jsx("h3",{children:"Your Daily Targets"}),r.jsxs("div",{className:"nut-calc-rings",children:[Ks("Protein","Protein",$.protein,$.protein,"ring-protein"),Ks("Carbs","Carbs",$.carbs,$.carbs,"ring-carbs"),Ks("Fats","Fats",$.fats,$.fats,"ring-fats"),Ks("Calories","Calories",$.calories,$.calories,"ring-cals")]}),r.jsxs("div",{className:"nut-calc-info",children:[r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"BMR (body at rest)"}),r.jsxs("span",{children:[$.bmr," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"+ Daily activity (NEAT)"}),r.jsxs("span",{children:[$.neat," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"+ Training sessions"}),r.jsxs("span",{children:["+",$.exerciseAdd," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",style:{fontWeight:600},children:[r.jsx("span",{children:"TDEE (total burn)"}),r.jsxs("span",{children:[$.tdee," cal"]})]})]}),r.jsx("button",{className:"nut-save-targets-btn",onClick:He,children:"Set as My Daily Targets"})]})]}),Ft&&r.jsx("div",{className:`toast-notification ${Ft.type}`,children:Ft.message})]});const cn=E=>{const z=new Date(E+"T12:00:00"),ie=z.getDay(),re=new Date(z);re.setDate(z.getDate()-(ie+6)%7);const Ke=[];for(let rt=0;rt<7;rt++){const st=new Date(re);st.setDate(re.getDate()+rt),Ke.push(st.toISOString().split("T")[0])}return Ke},Ns=["M","T","W","T","F","S","S"],W=(E,z="search")=>{M(E),z==="scan"?(se("scan"),Ct(null)):z==="manual"?(se("manual"),wt({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""})):z==="favourites"?se("favourites"):(se("search"),et([]),ot(""))},he=cn(L),ce=new Date(L+"T12:00:00"),_e=`${Me[ce.getMonth()]} ${ce.getFullYear()}`;return r.jsx(ga,{children:r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsxs("div",{className:"nut-dark-zone",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsxs("div",{className:"header-actions",children:[r.jsx("button",{onClick:()=>{y("setup"),V(null)},"aria-label":"Recalculate macros",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"3"}),r.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]})]})}),r.jsxs("div",{className:"nut-dark-content",children:[r.jsxs("div",{className:"nut-week-strip anim-fade-up",children:[r.jsxs("div",{className:"nut-week-header",children:[r.jsx("button",{className:"nut-week-arrow",onClick:()=>{const E=new Date(L+"T12:00:00");E.setDate(E.getDate()-7);const z=E.toISOString().split("T")[0];ee(z)},"aria-label":"Previous week",children:r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:r.jsx("polyline",{points:"15 18 9 12 15 6"})})}),r.jsx("button",{className:"nut-week-month-label",onClick:()=>{R(!xe),I({year:ce.getFullYear(),month:ce.getMonth()})},children:_e}),r.jsx("button",{className:"nut-week-arrow",onClick:()=>{const E=new Date(L+"T12:00:00");E.setDate(E.getDate()+7);const z=E.toISOString().split("T")[0];z<=Ji()&&ee(z)},"aria-label":"Next week",disabled:he[6]>=Ji(),children:r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:r.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),r.jsx("div",{className:"nut-week-days",children:he.map((E,z)=>{const ie=new Date(E+"T12:00:00").getDate(),re=E===L,Ke=E>Ji(),rt=E===Ji();return r.jsxs("button",{className:`nut-week-day${re?" selected":""}${rt?" today":""}${Ke?" future":""}`,disabled:Ke,onClick:()=>ee(E),children:[r.jsx("span",{className:"nut-week-day-letter",children:Ns[z]}),r.jsx("span",{className:"nut-week-day-num",children:ie})]},E)})})]}),xe&&r.jsxs("div",{className:"nut-calendar nut-calendar-dark",children:[r.jsxs("div",{className:"nut-cal-header",children:[r.jsx("button",{onClick:()=>I(E=>{let z=E.month-1,ie=E.year;return z<0&&(z=11,ie--),{year:ie,month:z}}),children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("polyline",{points:"15 18 9 12 15 6"})})}),r.jsxs("span",{children:[Me[D.month]," ",D.year]}),r.jsx("button",{onClick:()=>I(E=>{let z=E.month+1,ie=E.year;return z>11&&(z=0,ie++),{year:ie,month:z}}),disabled:D.year===new Date().getFullYear()&&D.month>=new Date().getMonth(),children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),r.jsx("div",{className:"nut-cal-days-header",children:De.map(E=>r.jsx("span",{children:E},E))}),r.jsxs("div",{className:"nut-cal-grid",children:[[...Array(ye(D.year,D.month))].map((E,z)=>r.jsx("span",{},`e${z}`)),[...Array(xs(D.year,D.month))].map((E,z)=>{const ie=z+1,re=`${D.year}-${String(D.month+1).padStart(2,"0")}-${String(ie).padStart(2,"0")}`,Ke=re>Ji(),rt=re===L,st=re===Ji();return r.jsx("button",{className:`nut-cal-day${rt?" selected":""}${st?" today":""}${Ke?" future":""}`,disabled:Ke,onClick:()=>{ee(re),R(!1)},children:ie},ie)})]})]}),r.jsxs("div",{className:"nut-rings-row anim-fade-up-d2",children:[Ks("Protein","Protein",ke.protein,x.protein,"ring-protein"),Ks("Carbs","Carbs",ke.carbs,x.carbs,"ring-carbs"),Ks("Fats","Fats",ke.fats,x.fats,"ring-fats"),Ks("Calories","kCal",ke.calories,x.calories,"ring-cals")]})]})]}),r.jsx("div",{className:"nut-light-zone anim-fade-up-d4",children:r.jsxs("div",{className:"nut-light-content",children:[is&&r.jsxs("button",{className:"nut-water-quick",onClick:()=>S(!0),children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"18",height:"18",children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),r.jsxs("span",{className:"nut-water-quick-count",children:[Y.water," / ",x?.waterGoal||8]}),r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",width:"14",height:"14",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})]}),r.jsx("div",{className:"nut-log-section",children:r.jsx("div",{className:"nut-meals-list",children:E2.map(E=>{const z=Y.entries.filter(re=>(re.meal||"snacks")===E.key),ie=z.reduce((re,Ke)=>({protein:re.protein+(Ke.protein||0),carbs:re.carbs+(Ke.carbs||0),fats:re.fats+(Ke.fats||0),calories:re.calories+(Ke.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});return r.jsxs("div",{className:"nut-meal-card",children:[r.jsxs("div",{className:"nut-meal-card-header",children:[r.jsx("span",{className:`nut-meal-card-icon nut-meal-icon-${E.key}`,children:RD[E.key]}),r.jsx("span",{className:"nut-meal-card-title",children:E.label}),z.length>0&&r.jsxs("span",{className:"nut-meal-card-cal",children:[ie.calories," cal"]}),is&&r.jsx("button",{className:"nut-meal-add-btn",onClick:()=>gt(ze===E.key?null:E.key),"aria-label":`Add to ${E.label}`,children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]}),z.length>0&&r.jsxs("div",{className:"nut-meal-bars",children:[r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-p",children:"P"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-protein",style:{width:`${Math.min(100,x.protein>0?ie.protein/x.protein*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[ie.protein,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-c",children:"C"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-carbs",style:{width:`${Math.min(100,x.carbs>0?ie.carbs/x.carbs*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[ie.carbs,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-f",children:"F"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-fats",style:{width:`${Math.min(100,x.fats>0?ie.fats/x.fats*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[ie.fats,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-cal",children:"K"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-cals",style:{width:`${Math.min(100,x.calories>0?ie.calories/x.calories*100:0)}%`}})}),r.jsx("span",{className:"nut-meal-bar-val",children:ie.calories})]})]}),z.length>0&&r.jsx("div",{className:"nut-log-list",children:z.map(re=>r.jsxs("div",{className:"nut-log-item",children:[r.jsx("button",{className:`nut-fav-star log${ne(re.name)?" active":""}`,onClick:()=>$e(re),"aria-label":ne(re.name)?"Remove from favourites":"Add to favourites",children:r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:ne(re.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("div",{className:"nut-log-item-info",children:[r.jsx("span",{className:"nut-log-item-name",children:re.name}),re.serving&&r.jsx("span",{className:"nut-log-item-serving",children:re.serving})]}),r.jsxs("div",{className:"nut-log-item-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[re.protein,"p"]}),r.jsxs("span",{className:"nut-macro-c",children:[re.carbs,"c"]}),r.jsxs("span",{className:"nut-macro-f",children:[re.fats,"f"]}),r.jsx("span",{className:"nut-macro-cal",children:re.calories})]}),is&&r.jsx("button",{className:"nut-log-delete",onClick:()=>Ye(re.id),"aria-label":"Remove",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},re.id))}),z.length===0&&r.jsx("div",{className:"nut-meal-empty",children:r.jsx("p",{children:is?"Tap + to add food":"No entries"})})]},E.key)})})})]})}),ze&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"nut-add-picker-backdrop",onClick:()=>gt(null)}),r.jsxs("div",{className:"nut-add-picker",children:[r.jsx("div",{className:"nut-add-picker-handle"}),r.jsxs("h3",{className:"nut-add-picker-title",children:["Add to ",E2.find(E=>E.key===ze)?.label]}),r.jsxs("div",{className:"nut-add-picker-options",children:[r.jsxs("button",{onClick:()=>{const E=ze;gt(null),W(E,"scan")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),r.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),r.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),r.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),r.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),r.jsx("span",{children:"Scan Barcode"})]}),r.jsxs("button",{onClick:()=>{const E=ze;gt(null),W(E,"search")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("span",{children:"Search Food"})]}),r.jsxs("button",{onClick:()=>{const E=ze;gt(null),W(E,"manual")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),r.jsx("span",{children:"Manual Entry"})]}),r.jsxs("button",{onClick:()=>{const E=ze;gt(null),W(E,"favourites")},children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),r.jsx("span",{children:"Favourites"})]})]})]})]}),T&&r.jsx("div",{className:"nut-modal-overlay",onClick:()=>S(!1),children:r.jsxs("div",{className:"nut-water-popup",onClick:E=>E.stopPropagation(),children:[r.jsxs("div",{className:"nut-water-popup-header",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"20",height:"20",style:{color:"#2196f3"},children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),r.jsx("span",{children:"Water Intake"}),r.jsx("button",{className:"nut-modal-close",onClick:()=>S(!1),children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),r.jsxs("div",{className:"nut-water-popup-body",children:[r.jsx("div",{className:"nut-water-glasses",children:[...Array(x?.waterGoal||8)].map((E,z)=>r.jsx("div",{className:`nut-water-glass ${z<Y.water?"filled":""}`,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:z<Y.water?"currentColor":"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})})},z))}),r.jsxs("div",{className:"nut-water-popup-count",children:[Y.water," / ",x?.waterGoal||8," glasses"]}),r.jsxs("div",{className:"nut-water-btns",children:[r.jsx("button",{onClick:Dt,disabled:Y.water<=0,children:"-"}),r.jsx("button",{onClick:Bt,children:"+"})]})]})]})}),B&&r.jsx("div",{className:"nut-modal-overlay",onClick:()=>{Je(),P(null),se(null),Ct(null)},children:r.jsxs("div",{className:"nut-modal",onClick:E=>E.stopPropagation(),children:[r.jsxs("div",{className:"nut-modal-header",children:[r.jsx("h3",{children:B==="scan"?"Scan Barcode":B==="search"?"Search Food":B==="favourites"?"Favourites":"Manual Entry"}),r.jsx("button",{className:"nut-modal-close",onClick:()=>{Je(),P(null),se(null),Ct(null)},children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),B==="scan"&&!oe&&r.jsxs("div",{className:"nut-scan-area",children:[r.jsxs("div",{className:"nut-scanner-wrapper",children:[r.jsx("div",{id:"barcode-reader",className:"nut-scanner-view"}),ge&&!Q&&r.jsx("div",{className:"nut-scan-line"}),Q&&r.jsxs("div",{className:"nut-scan-detected-overlay",children:[r.jsx("svg",{className:"nut-scan-detected-tick",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20 6L9 17l-5-5"})}),r.jsx("p",{className:"nut-scan-detected-label",children:"Barcode found!"}),r.jsx("p",{className:"nut-scan-detected-code",children:Q})]})]}),!ge&&r.jsxs("button",{className:"nut-scan-start-btn",onClick:ht,children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),r.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),r.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),r.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),r.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),"Open Camera"]}),ge&&!Q&&r.jsx("p",{className:"nut-scan-hint",children:"Align barcode within the frame"}),r.jsx("div",{className:"nut-barcode-divider",children:r.jsx("span",{children:"or enter barcode manually"})}),r.jsxs("div",{className:"nut-barcode-manual",children:[r.jsx("input",{type:"text",inputMode:"numeric",value:ae,onChange:E=>Be(E.target.value),onKeyDown:E=>E.key==="Enter"&&ae.trim()&&mt(ae.trim()),placeholder:"Enter barcode number"}),r.jsx("button",{onClick:()=>ae.trim()&&mt(ae.trim()),disabled:!ae.trim()||Ue,children:Ue?"...":"Look Up"})]})]}),B==="scan"&&oe&&(()=>{const E=oe.servingUnit||"g",z=oe.portion,ie=tt==="portion"&&z?Et*z.weight:parseFloat(kt)||0,re=ie/100,Ke=E==="ml"?[100,200,250,500]:[50,100,150,200],rt=tt==="portion"&&z?`${Et} ${z.label}${Et!==1?"s":""} (${Math.round(ie)}${E})`:`${Math.round(ie)}${E}`;return r.jsxs("div",{className:"nut-product-result",children:[oe.image&&r.jsx("img",{src:oe.image,alt:oe.name||"Product",className:"nut-product-img",loading:"lazy"}),r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:oe.name}),r.jsx("button",{className:`nut-fav-star confirm${ne(oe.name)?" active":""}`,onClick:()=>$e({name:oe.name,protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories,serving:oe.servingSize,per100g:{protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories},servingUnit:oe.servingUnit||"g",portion:oe.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:ne(oe.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),oe.brand&&r.jsx("p",{className:"nut-product-brand",children:oe.brand}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",E,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[oe.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[oe.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[oe.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[oe.calories," cal"]})]}),z&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:tt==="portion"?"active":"",onClick:()=>{Mt("portion"),Et<1&&jt(1)},children:"Portions"}),r.jsxs("button",{className:tt==="weight"?"active":"",onClick:()=>{Mt("weight"),zt(String(Math.round(ie)||100))},children:["Custom (",E,")"]})]}),tt==="portion"&&z?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>jt(Math.max(1,Et-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:Et}),r.jsxs("span",{className:"nut-stepper-label",children:[z.label,Et!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(ie),E]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>jt(Et+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",E,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:kt,onChange:st=>zt(st.target.value),onFocus:st=>st.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:Ke.map(st=>r.jsxs("button",{className:`nut-quick-btn${kt===String(st)?" active":""}`,onClick:()=>zt(String(st)),children:[st,E]},st))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(oe.protein*re),"p / ",Math.round(oe.carbs*re),"c / ",Math.round(oe.fats*re),"f / ",Math.round(oe.calories*re)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>{Ct(null),se("scan")},children:"Scan Again"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>bt({name:oe.name,protein:Math.round(oe.protein*re),carbs:Math.round(oe.carbs*re),fats:Math.round(oe.fats*re),calories:Math.round(oe.calories*re),serving:rt}),children:"Add"})]})]})})(),B==="search"&&!oe&&r.jsxs("div",{className:"nut-search-area",children:[r.jsxs("div",{className:"nut-search-bar",children:[r.jsx("input",{type:"text",ref:nn,value:Ie,onChange:E=>ot(E.target.value),onKeyDown:E=>{E.key==="Enter"&&(clearTimeout(as.current),lt())},onFocus:()=>setTimeout(()=>nn.current?.scrollIntoView({behavior:"smooth",block:"center"}),350),placeholder:"Search food or product...",autoFocus:!0}),r.jsx("button",{onClick:lt,disabled:Xt,children:Xt?"...":"Search"})]}),r.jsxs("div",{className:"nut-search-results",children:[yt.map((E,z)=>r.jsxs("button",{className:"nut-search-item",onClick:()=>{Ct(E),E.portion?(jt(1),zt(String(E.portion.weight)),Mt("portion")):(jt(0),zt(String(E.servingValue||100)),Mt("weight"))},children:[E.image&&r.jsx("img",{src:E.image,alt:E.name||"Product",loading:"lazy"}),r.jsxs("div",{className:"nut-search-item-info",children:[r.jsx("span",{className:"nut-search-item-name",children:E.name}),E.brand&&r.jsx("span",{className:"nut-search-item-brand",children:E.brand}),r.jsxs("span",{className:"nut-search-item-macros",children:[E.calories," cal  ",E.protein,"p  ",E.carbs,"c  ",E.fats,"f per 100",E.servingUnit||"g"]})]})]},z)),yt.length===0&&Ie&&!Xt&&r.jsx("p",{className:"nut-search-empty",children:"No results found. Try a different search or use manual entry."})]})]}),B==="search"&&oe&&(()=>{const E=oe.servingUnit||"g",z=oe.portion,ie=tt==="portion"&&z?Et*z.weight:parseFloat(kt)||0,re=ie/100,Ke=E==="ml"?[100,200,250,500]:[50,100,150,200],rt=tt==="portion"&&z?`${Et} ${z.label}${Et!==1?"s":""} (${Math.round(ie)}${E})`:`${Math.round(ie)}${E}`;return r.jsxs("div",{className:"nut-product-result",children:[oe.image&&r.jsx("img",{src:oe.image,alt:oe.name||"Product",className:"nut-product-img",loading:"lazy"}),r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:oe.name}),r.jsx("button",{className:`nut-fav-star confirm${ne(oe.name)?" active":""}`,onClick:()=>$e({name:oe.name,protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories,serving:oe.servingSize,per100g:{protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories},servingUnit:oe.servingUnit||"g",portion:oe.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:ne(oe.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),oe.brand&&r.jsx("p",{className:"nut-product-brand",children:oe.brand}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",E,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[oe.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[oe.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[oe.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[oe.calories," cal"]})]}),z&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:tt==="portion"?"active":"",onClick:()=>{Mt("portion"),Et<1&&jt(1)},children:"Portions"}),r.jsxs("button",{className:tt==="weight"?"active":"",onClick:()=>{Mt("weight"),zt(String(Math.round(ie)||100))},children:["Custom (",E,")"]})]}),tt==="portion"&&z?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>jt(Math.max(1,Et-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:Et}),r.jsxs("span",{className:"nut-stepper-label",children:[z.label,Et!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(ie),E]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>jt(Et+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",E,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:kt,onChange:st=>zt(st.target.value),onFocus:st=>st.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:Ke.map(st=>r.jsxs("button",{className:`nut-quick-btn${kt===String(st)?" active":""}`,onClick:()=>zt(String(st)),children:[st,E]},st))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(oe.protein*re),"p / ",Math.round(oe.carbs*re),"c / ",Math.round(oe.fats*re),"f / ",Math.round(oe.calories*re)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>Ct(null),children:"Back to Search"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>bt({name:oe.name,protein:Math.round(oe.protein*re),carbs:Math.round(oe.carbs*re),fats:Math.round(oe.fats*re),calories:Math.round(oe.calories*re),serving:rt}),children:"Add"})]})]})})(),B==="manual"&&r.jsxs("div",{className:"nut-manual-form",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Food Name"}),r.jsx("input",{type:"text",value:Ot.name,onChange:E=>wt(z=>({...z,name:E.target.value})),placeholder:"e.g. Chicken Breast",autoFocus:!0})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Serving Size (optional)"}),r.jsx("input",{type:"text",value:Ot.serving,onChange:E=>wt(z=>({...z,serving:E.target.value})),placeholder:"e.g. 150g, 1 cup"})]}),r.jsxs("div",{className:"nut-manual-macros",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Protein (g)"}),r.jsx("input",{type:"number",value:Ot.protein,onChange:E=>wt(z=>({...z,protein:E.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Carbs (g)"}),r.jsx("input",{type:"number",value:Ot.carbs,onChange:E=>wt(z=>({...z,carbs:E.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Fats (g)"}),r.jsx("input",{type:"number",value:Ot.fats,onChange:E=>wt(z=>({...z,fats:E.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Calories"}),r.jsx("input",{type:"number",value:Ot.calories,onChange:E=>wt(z=>({...z,calories:E.target.value})),min:"0"})]})]}),r.jsx("button",{className:"nut-btn-primary",disabled:!Ot.name.trim(),onClick:()=>bt({name:Ot.name,protein:parseFloat(Ot.protein)||0,carbs:parseFloat(Ot.carbs)||0,fats:parseFloat(Ot.fats)||0,calories:parseFloat(Ot.calories)||0,serving:Ot.serving||""}),children:"Add Food"})]}),B==="favourites"&&!oe&&(()=>{const E=J(),z=ie=>{if(ie.per100g){const re=ie.per100g;Ct({name:ie.name,brand:"",image:null,servingSize:ie.serving||"100g",servingValue:100,servingUnit:ie.servingUnit||"g",portion:ie.portion||null,protein:re.protein,carbs:re.carbs,fats:re.fats,calories:re.calories,per100g:!0}),ie.portion?(jt(1),zt(String(ie.portion.weight)),Mt("portion")):(jt(0),zt("100"),Mt("weight"))}else bt({name:ie.name,protein:ie.protein,carbs:ie.carbs,fats:ie.fats,calories:ie.calories,serving:ie.serving||""})};return r.jsx("div",{className:"nut-recent-area",children:E.length===0?r.jsx("p",{className:"nut-search-empty",children:"No favourites yet. Tap the star on any food to save it here."}):r.jsx("div",{className:"nut-recent-list",children:E.map((ie,re)=>r.jsxs("div",{className:"nut-recent-item-row",children:[r.jsx("button",{className:"nut-fav-star active",onClick:Ke=>{Ke.stopPropagation(),$e(ie)},children:r.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("button",{className:"nut-recent-item",onClick:()=>z(ie),children:[r.jsxs("div",{className:"nut-recent-item-info",children:[r.jsx("span",{className:"nut-recent-item-name",children:ie.name}),r.jsx("span",{className:"nut-recent-item-serving",children:ie.serving||""})]}),r.jsxs("span",{className:"nut-recent-item-macros",children:[ie.calories," cal"]})]})]},re))})})})(),B==="favourites"&&oe&&(()=>{const E=oe.servingUnit||"g",z=oe.portion,ie=tt==="portion"&&z?Et*z.weight:parseFloat(kt)||0,re=ie/100,Ke=E==="ml"?[100,200,250,500]:[50,100,150,200],rt=tt==="portion"&&z?`${Et} ${z.label}${Et!==1?"s":""} (${Math.round(ie)}${E})`:`${Math.round(ie)}${E}`;return r.jsxs("div",{className:"nut-product-result",children:[r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:oe.name}),r.jsx("button",{className:`nut-fav-star confirm${ne(oe.name)?" active":""}`,onClick:()=>$e({name:oe.name,protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories,serving:oe.servingSize,per100g:{protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories},servingUnit:oe.servingUnit||"g",portion:oe.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:ne(oe.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",E,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[oe.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[oe.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[oe.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[oe.calories," cal"]})]}),z&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:tt==="portion"?"active":"",onClick:()=>{Mt("portion"),Et<1&&jt(1)},children:"Portions"}),r.jsxs("button",{className:tt==="weight"?"active":"",onClick:()=>{Mt("weight"),zt(String(Math.round(ie)||100))},children:["Custom (",E,")"]})]}),tt==="portion"&&z?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>jt(Math.max(1,Et-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:Et}),r.jsxs("span",{className:"nut-stepper-label",children:[z.label,Et!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(ie),E]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>jt(Et+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",E,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:kt,onChange:st=>zt(st.target.value),onFocus:st=>st.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:Ke.map(st=>r.jsxs("button",{className:`nut-quick-btn${kt===String(st)?" active":""}`,onClick:()=>zt(String(st)),children:[st,E]},st))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(oe.protein*re),"p / ",Math.round(oe.carbs*re),"c / ",Math.round(oe.fats*re),"f / ",Math.round(oe.calories*re)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>Ct(null),children:"Back to Favourites"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>bt({name:oe.name,protein:Math.round(oe.protein*re),carbs:Math.round(oe.carbs*re),fats:Math.round(oe.fats*re),calories:Math.round(oe.calories*re),serving:rt}),children:"Add"})]})]})})()]})}),r.jsx(ta,{active:"nutrition"}),Ft&&r.jsx("div",{className:`toast-notification ${Ft.type}`,children:Ft.message})]})})}async function tb(n){const{type:e="workout",title:t="Workout Complete!",stats:i=[],badges:l=[],badgeImage:u,badgeDesc:d}=n,p=1080,g=1920,y=document.createElement("canvas");y.width=p,y.height=g;const x=y.getContext("2d"),_="#2a2a28",j="#ffffff",O="#A12F3A",$="#1a1a1a",V="#555555";x.fillStyle=_,x.fillRect(0,0,p,g);const L=Math.round(p*.82),ee=Math.round(g*.75),Y=Math.round((p-L)/2),te=Math.round((g-ee)/2),ke=28,Te=5;x.save(),x.shadowColor="rgba(0, 0, 0, 0.45)",x.shadowBlur=40,x.shadowOffsetY=10,N2(x,Y,te,L,ee,ke),x.fillStyle=j,x.fill(),x.restore(),x.save(),N2(x,Y,te,L,ee,ke),x.strokeStyle=O,x.lineWidth=Te,x.stroke(),x.restore();const xe=220,R=50,T=52,S=68,D=10,I=36,U=48,M=30,ze=34,gt=46,B=30,se=28;x.font=`bold ${T}px 'Orbitron', sans-serif`;const ge=au(x,t.toUpperCase(),L-100);x.font=`500 ${I}px 'Montserrat', sans-serif`;let Re=[];e==="badge"&&d?Re=au(x,d,L-120):e==="badge"&&l.length>0?Re=au(x,l.join("    "),L-120):i.length>0&&(Re=au(x,i.map(Ct=>`${Ct.value} ${Ct.label}`).join("    "),L-120));const Q=e==="badge"?"I just earned a badge on Core Buddy ":e==="habits"?"I just completed my daily habits with Core Buddy ":"I just completed a workout using Core Buddy ";x.font=`bold ${ze}px 'Montserrat', sans-serif`;const P=au(x,Q,L-80);let ae=ge.length*S;Re.length>0&&(ae+=D+Re.length*U),ae+=M+P.length*gt,ae+=B+se;const Ue=te+ee-60-ae,Ie=te+40,ot=Ue-R,yt=p/2,et=(Ie+ot)/2,Xt=e==="badge"&&u?u:"/Logo.webp";x.save();const Es=e==="badge"?"rgba(255, 193, 7, 0.15)":"rgba(161, 47, 58, 0.12)",Ot=x.createRadialGradient(yt,et,xe*.6,yt,et,xe*1.5);Ot.addColorStop(0,Es),Ot.addColorStop(1,"rgba(0, 0, 0, 0)"),x.fillStyle=Ot,x.fillRect(yt-xe*1.5,et-xe*1.5,xe*3,xe*3),x.restore(),x.beginPath(),x.arc(yt,et,xe+6,0,Math.PI*2),x.fillStyle=j,x.fill();const wt=e==="badge"?"#ffc107":O;x.beginPath(),x.arc(yt,et,xe,0,Math.PI*2),x.strokeStyle=wt,x.lineWidth=5,x.stroke();try{const Ct=await MD(Xt);x.save(),x.beginPath(),x.arc(yt,et,xe-6,0,Math.PI*2),x.clip();const kt=(xe-6)*2;x.drawImage(Ct,yt-xe+6,et-xe+6,kt,kt),x.restore()}catch{x.textAlign="center",x.textBaseline="middle",x.fillStyle=O,x.font="bold 80px 'Orbitron', sans-serif",x.fillText(e==="badge"?"":"MCF",yt,et)}let oe=Ue;x.textAlign="center",x.textBaseline="alphabetic",x.fillStyle=$,x.font=`bold ${T}px 'Orbitron', sans-serif`;for(const Ct of ge)x.fillText(Ct,p/2,oe),oe+=S;if(Re.length>0){oe+=D,x.fillStyle=V,x.font=`500 ${I}px 'Montserrat', sans-serif`;for(const Ct of Re)x.fillText(Ct,p/2,oe),oe+=U}oe+=M,x.fillStyle=$,x.font=`bold ${ze}px 'Montserrat', sans-serif`;for(const Ct of P)x.fillText(Ct,p/2,oe),oe+=gt;return oe+=B,x.fillStyle=O,x.font=`600 ${se}px 'Montserrat', sans-serif`,x.fillText("Make It Count with Core Buddy",p/2,oe),new Promise(Ct=>{y.toBlob(kt=>Ct(kt),"image/png")})}function N2(n,e,t,i,l,u){n.beginPath(),n.moveTo(e+u,t),n.lineTo(e+i-u,t),n.quadraticCurveTo(e+i,t,e+i,t+u),n.lineTo(e+i,t+l-u),n.quadraticCurveTo(e+i,t+l,e+i-u,t+l),n.lineTo(e+u,t+l),n.quadraticCurveTo(e,t+l,e,t+l-u),n.lineTo(e,t+u),n.quadraticCurveTo(e,t,e+u,t),n.closePath()}function MD(n){return new Promise((e,t)=>{const i=new Image;i.crossOrigin="anonymous",i.onload=()=>e(i),i.onerror=t,i.src=n})}function au(n,e,t){if(n.measureText(e).width<=t)return[e];const i=e.split(" "),l=[];let u="";for(const d of i){const p=u?`${u} ${d}`:d;n.measureText(p).width>t&&u?(l.push(u),u=d):u=p}return u&&l.push(u),l}function DD(){const n=b.useRef(null),e=b.useCallback(()=>{if(!n.current)try{n.current=new(window.AudioContext||window.webkitAudioContext)}catch{}const u=n.current;return u?.state==="suspended"&&u.resume(),u},[]),t=b.useCallback(()=>{navigator.vibrate&&navigator.vibrate([40,60,30]);const u=e();if(!u)return;const d=u.currentTime,p=u.createBiquadFilter();p.type="lowpass",p.frequency.value=500,p.Q.value=.7,p.connect(u.destination);const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=50,y.gain.value=.3,y.gain.setTargetAtTime(0,d+.08,.04),g.connect(y).connect(p),g.start(d),g.stop(d+.2);const x=u.createOscillator(),_=u.createGain();x.type="sine",x.frequency.value=70,_.gain.value=.2,_.gain.setTargetAtTime(0,d+.22,.04),x.connect(_).connect(p),x.start(d+.15),x.stop(d+.35)},[e]),i=b.useCallback(()=>{navigator.vibrate&&navigator.vibrate(30);const u=e();if(!u)return;const d=u.currentTime,p=u.createBiquadFilter();p.type="lowpass",p.frequency.value=500,p.Q.value=.7,p.connect(u.destination);const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=55,y.gain.value=.35,y.gain.setTargetAtTime(0,d+.08,.04),g.connect(y).connect(p),g.start(d),g.stop(d+.2)},[e]),l=b.useCallback(()=>{navigator.vibrate&&navigator.vibrate([50,80,100]);const u=e();u&&[0,.12].forEach((d,p)=>{const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=p===0?523:784,y.gain.value=.12,y.gain.setTargetAtTime(0,u.currentTime+d+.15,.02),g.connect(y).connect(u.destination),g.start(u.currentTime+d),g.stop(u.currentTime+d+.2)})},[e]);return b.useEffect(()=>()=>{n.current?.close()},[]),{tap:i,tick:t,complete:l}}const PD=2e3,Dg=42,Vl=2*Math.PI*Dg,LD=1200,S2=["Another one in the bank!","Consistency beats everything.","You showed up  that's what counts.","Stronger every session."];function Jh({title:n,subtitle:e,stats:t,onDone:i,onDismissStart:l,onShareJourney:u,userName:d,buttonLabel:p="Done",holdLabel:g="Hold To Complete Session",shareType:y="workout",hideShare:x=!1}){const[_,j]=b.useState("hold"),[O,$]=b.useState(!1),[V,L]=b.useState(0),[ee,Y]=b.useState(!1),[te,ke]=b.useState(!1),[Te,xe]=b.useState(null),R=DD(),T=b.useRef(null),S=b.useRef(null),D=b.useRef(null),I=b.useRef(null),U=b.useRef(!1),M=b.useRef(!1),ze=b.useRef(0),gt=b.useRef(S2[Math.floor(Math.random()*S2.length)]),B=b.useRef([...Array(80)].map((Oe,Ie)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#ffffff","#000000"][Ie%3],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:Ie%3}))),se=b.useCallback(()=>{if(U.current)return;U.current=!0,M.current=!1,ze.current=0,$(!0),L(0),I.current=performance.now(),R.tap(),T.current&&(T.current.style.strokeDashoffset=Vl);const Oe=Ie=>{const ot=Ie-I.current,yt=Math.min(ot/PD,1);if(T.current&&(T.current.style.strokeDashoffset=Vl-yt*Vl),S.current){const et=8*(1-yt),Xt=1-yt,Es=1+yt*.15;S.current.style.filter=`blur(${et}px) grayscale(${Xt})`,S.current.style.transform=`scale(${Es})`}L(yt),ot-ze.current>=LD&&(ze.current=ot,R.tick()),yt<1?D.current=requestAnimationFrame(Oe):(U.current=!1,M.current=!0,D.current=null,$(!1),L(1),R.complete(),j("celebrate"))};D.current=requestAnimationFrame(Oe)},[R]),ge=b.useCallback(()=>{U.current&&(U.current=!1,D.current&&(cancelAnimationFrame(D.current),D.current=null),T.current&&(T.current.style.strokeDashoffset=Vl),S.current&&(S.current.style.filter="",S.current.style.transform=""),$(!1),L(0))},[]),Re=b.useCallback(()=>{Y(!0),l?.(),setTimeout(()=>{i?.()},300)},[i,l]),Q=b.useCallback(()=>{const Oe=[n||"Workout Complete!"];return e&&Oe.push(e),t?.length&&Oe.push(t.map(Ie=>`${Ie.value} ${Ie.label}`).join(" | ")),Oe.push("#MindCoreFitness"),Oe.join(`
`)},[n,e,t]),P=b.useCallback(async()=>{if(!(te||!u))try{await u({type:y==="habits"?"habits_summary":"workout_summary",title:n||"Workout Complete!",subtitle:e,stats:t||[],quote:gt.current}),ke(!0),xe("Posted to Journey!"),setTimeout(()=>xe(null),2500)}catch(Oe){console.error("Journey post failed:",Oe),xe(Oe?.message||"Failed to post"),setTimeout(()=>xe(null),3500)}},[te,u,n,e,t]),[ae,Be]=b.useState(!1),Ue=b.useCallback(async()=>{Be(!0);try{const Oe=await tb({type:y||"workout",title:n||"Workout Complete!",subtitle:e,stats:t||[],quote:gt.current,userName:d}),Ie=Q();if(navigator.share&&navigator.canShare?.({files:[new File([Oe],"workout.png",{type:"image/png"})]})){const ot=new File([Oe],"workout.png",{type:"image/png"});await navigator.share({title:"Mind Core Fitness",text:Ie,files:[ot]})}else navigator.share?await navigator.share({title:"Mind Core Fitness",text:Ie}):(await navigator.clipboard.writeText(Ie),xe("Copied to clipboard!"),setTimeout(()=>xe(null),2500))}catch{try{await navigator.clipboard.writeText(Q()),xe("Copied to clipboard!"),setTimeout(()=>xe(null),2500)}catch{}}finally{Be(!1)}},[n,e,t,d,Q]);return _==="hold"?r.jsxs("div",{className:"wc-hold-page",children:[r.jsx("div",{className:"wc-hold-glow","aria-hidden":"true"}),r.jsx("p",{className:"wc-hold-label",children:g}),r.jsxs("div",{className:`wc-hold-ring-touch ${O?"wc-holding":""}`,onPointerDown:Oe=>{Oe.preventDefault(),se()},onPointerUp:ge,onPointerLeave:ge,onPointerCancel:ge,onClick:Oe=>{Oe.stopPropagation(),M.current&&(M.current=!1)},role:"button",tabIndex:0,"aria-label":"Press and hold to finish workout",onKeyDown:Oe=>{(Oe.key==="Enter"||Oe.key===" ")&&(Oe.preventDefault(),R.complete(),j("celebrate"))},children:[r.jsx("div",{className:"wc-hold-ring-glow","aria-hidden":"true"}),r.jsxs("svg",{className:"wc-hold-ring-svg",viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"wc-hold-ring-track",cx:"50",cy:"50",r:Dg}),r.jsx("circle",{className:"wc-hold-ring-fill",ref:T,cx:"50",cy:"50",r:Dg,style:{strokeDasharray:Vl,strokeDashoffset:Vl}})]}),r.jsx("img",{ref:S,src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-hold-logo",draggable:!1})]})]}):r.jsxs("div",{className:`wc-celeb-overlay ${ee?"wc-celeb-dismissing":""}`,children:[r.jsx("div",{className:"wc-celeb-confetti","aria-hidden":"true",children:B.current.map((Oe,Ie)=>r.jsx("span",{className:`wc-celeb-confetti-piece wc-confetti-shape-${Oe.shape}`,style:{"--x":`${Oe.x}%`,"--delay":`${Oe.delay}s`,"--color":Oe.color,"--drift":`${Oe.drift}px`,"--spin":`${Oe.spin}deg`,"--duration":`${Oe.duration}s`,width:`${Oe.width}px`,height:`${Oe.height}px`}},Ie))}),r.jsxs("div",{className:"wc-celeb-content",children:[r.jsx("div",{className:"wc-celeb-logo-frame",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-celeb-logo-img"})}),r.jsx("h2",{className:"wc-celeb-heading",children:n||"Congratulations!"}),e&&r.jsx("p",{className:"wc-celeb-subtext",children:e}),r.jsx("p",{className:"wc-celeb-quote",children:gt.current}),t&&t.length>0&&r.jsx("div",{className:"wc-celeb-stats-row",children:t.map((Oe,Ie)=>r.jsxs("div",{className:"wc-celeb-stat",children:[r.jsx("span",{className:"wc-celeb-stat-val",children:Oe.value}),r.jsx("span",{className:"wc-celeb-stat-label",children:Oe.label})]},Ie))}),!x&&r.jsxs("div",{className:"wc-share-row",children:[u&&r.jsxs("button",{className:`wc-share-btn wc-share-journey ${te?"wc-share-done":""}`,onClick:P,disabled:te,children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20h9"}),r.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4Z"})]}),te?"Posted!":"Post to Journey"]}),r.jsxs("button",{className:"wc-share-btn wc-share-external",onClick:Ue,disabled:ae,children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"18",cy:"5",r:"3"}),r.jsx("circle",{cx:"6",cy:"12",r:"3"}),r.jsx("circle",{cx:"18",cy:"19",r:"3"}),r.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),r.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),ae?"Generating...":"Share"]})]}),r.jsx("button",{className:"wc-celeb-btn",onClick:Re,children:p}),Te&&r.jsx("div",{className:"wc-share-toast",children:Te})]})]})}const C2="/login/assets/randomiser-glq9YJkL.jpg",R2="/login/assets/programme-card-workout-CnNzTYkz.webp",OD="/login/assets/prog-fullbody-4wk-r6m9HJys.jpg",BD="/login/assets/muscle-group-arms-C9AdZL4-.png",VD="/login/assets/arms-bicep-BUrmT1o-.png",UD="/login/assets/arms-tricep-D9tAnFnS.png",FD="/login/assets/arms-full-arms-BY3TvpJm.png",zD="/login/assets/muscle-group-chest-Cxfuc7XI.png",qD="/login/assets/chest-strength-BR4BAFTH.png",HD="/login/assets/chest-hypertrophy-B8yNrvjB.png",$D="/login/assets/chest-endurance-e-OSWtWO.png",WD="/login/assets/muscle-group-shoulders-DibNtCLF.png",GD="/login/assets/shoulders-strength-CKlZBF5A.png",KD="/login/assets/shoulders-hypertrophy-BUd76jiS.png",YD="/login/assets/shoulders-endurance-HuqNG5rD.png",QD="/login/assets/muscle-group-core-CPR-bdRg.png",XD="/login/assets/core-lower-abs-TVcqGMFJ.png",JD="/login/assets/core-obliques-rotation-Djb7Qlbk.png",ZD="/login/assets/core-weighted-core-4Kwh9mTv.png",e6="/login/assets/muscle-group-back-8JPV-YUo.png",t6="/login/assets/back-strength-BmSRxnwo.png",s6="/login/assets/back-hypertrophy-CXHmsnCz.png",n6="/login/assets/back-endurance-C8qJ8l5I.png",r6="/login/assets/muscle-group-legs-B8jcbdov.png",a6="/login/assets/legs-quads-DbnfsebI.png",i6="/login/assets/legs-hamstrings-glutes-BrfsvvzX.png",o6="/login/assets/legs-power-plyo-D2qBXeUR.png",l6=60,Gp=5,c6=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],u6={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Squeeze Press":"push","Incline Dumbbell Press":"push","Dumbbell Fly":"push","Dumbbell Pullover":"push","Tricep Kickback":"push","Dumbbell Shrug":"push","Dumbbell Y-Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Wide Dumbbell Bent Over Row":"pull","Reverse Fly":"pull","Concentration Curl":"pull","Wide Grip Bicep Curl":"pull","Wrist Curl":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core","Kettlebell Bird Dog Drag":"core"},d6={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},h6={fullbody:"linear-gradient(160deg, rgba(153,49,60,0.15) 0%, rgba(153,49,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",upper:"linear-gradient(160deg, rgba(100,60,140,0.2) 0%, rgba(100,60,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",lower:"linear-gradient(160deg, rgba(40,120,80,0.2) 0%, rgba(40,120,80,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)"},Kp={arms:"linear-gradient(160deg, rgba(180,60,60,0.2) 0%, rgba(180,60,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",chest:"linear-gradient(160deg, rgba(50,100,160,0.2) 0%, rgba(50,100,160,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",back:"linear-gradient(160deg, rgba(80,130,60,0.2) 0%, rgba(80,130,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",shoulders:"linear-gradient(160deg, rgba(160,100,40,0.2) 0%, rgba(160,100,40,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",legs:"linear-gradient(160deg, rgba(100,50,140,0.2) 0%, rgba(100,50,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)"},Yp=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,level:"All Levels",daysPerWeek:3,image:OD},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,level:"Intermediate",daysPerWeek:3},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,level:"Advanced",daysPerWeek:3},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,level:"Beginner",daysPerWeek:3},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,level:"Intermediate",daysPerWeek:3},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,level:"Advanced",daysPerWeek:3},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,level:"Intermediate",daysPerWeek:3},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,level:"Intermediate",daysPerWeek:3}],iu=[{key:"arms",label:"Arms",icon:"M7 5h2v14H7V5zm8 0h2v14h-2V5zm-5 4h4v6h-4V9z",image:BD},{key:"chest",label:"Chest",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15H9v-2h2v2zm4 0h-2v-2h2v2zm3-6c0 1.1-.36 2.12-.97 2.95l-.87-.87C16.7 12.53 17 11.8 17 11c0-2.76-2.24-5-5-5S7 8.24 7 11c0 .8.3 1.53.84 2.08l-.87.87A4.977 4.977 0 0 1 6 11c0-3.31 2.69-6 6-6s6 2.69 6 6z",image:zD},{key:"back",label:"Back",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm4 18H8v-6l-4-4 1.41-1.41L8 11.17V8h8v3.17l2.59-2.58L20 10l-4 4v6z",image:e6},{key:"shoulders",label:"Shoulders",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z",image:WD},{key:"legs",label:"Legs",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z",image:r6},{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z",image:QD}],A2={chest:[{id:"chest_strength",name:"Chest Strength",desc:"Heavy pressing for max strength",image:qD,level:"Intermediate",overview:"A heavy pressing session designed to build raw chest strength. Focus on controlled negatives and powerful pressing movements.",tips:["Go heavy  pick a weight where the last 2 reps are a real challenge","Control the negative (lowering phase) for 2-3 seconds","Keep your shoulder blades squeezed together throughout all pressing movements","Rest 90-120 seconds between sets to allow full recovery"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Squeeze Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"chest_hypertrophy",name:"Chest Hypertrophy",desc:"Volume training for muscle growth",image:HD,level:"Intermediate",overview:"A high-volume chest session focused on time under tension and muscle growth. Lighter weights, more reps, and slow controlled movements.",tips:["Use moderate weight  you should feel the burn by rep 10","Squeeze your chest at the top of every rep for 1 second","Keep rest periods short at 60-90 seconds to keep the pump going","On press ups, go to failure on the final set"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Press Up",type:"reps",sets:3,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"}]},{id:"chest_endurance",name:"Chest Endurance",desc:"Bodyweight pushing to failure",image:$D,level:"All Levels",overview:"No weights needed. This bodyweight-only session builds chest endurance and muscular stamina through high-rep push up variations.",tips:["Focus on full range of motion  chest to floor on every rep","Keep your core tight and body in a straight line throughout","Scale down to knee press ups if you can't maintain form","Push through the burn  the last 5 reps are where the growth happens"],exercises:[{name:"Press Up",type:"reps",sets:4,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null},{name:"Decline Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Press Up Hold",type:"timed",sets:3,time:30,storagePath:null}]}],back:[{id:"back_strength",name:"Back Strength",desc:"Heavy rows for a thick back",image:t6,level:"Intermediate",overview:"Build a thick, powerful back with heavy rowing movements. This session targets your lats, rhomboids, and traps for overall back development.",tips:["Go heavy on rows  use a weight that challenges you by rep 6-8","Drive your elbows back and squeeze your shoulder blades together at the top","Keep a slight bend in your knees and hinge at the hips for bent over movements","Rest 90-120 seconds between sets for full recovery"],exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"back_hypertrophy",name:"Back Hypertrophy",desc:"Width and thickness volume work",image:s6,level:"Intermediate",overview:"A volume-focused back session combining rows and isolation moves to build width and thickness. Focus on the mind-muscle connection.",tips:["Use moderate weight  feel the stretch and squeeze on every rep","On renegade rows, keep your hips square to the floor and avoid rotating","For reverse flys, use lighter weight and focus on squeezing your rear delts","Keep rest to 60-90 seconds to maintain intensity"],exercises:[{name:"Renegade Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Reverse Fly",type:"weighted",sets:3,reps:15,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null}]},{id:"back_endurance",name:"Back Endurance",desc:"Bodyweight back conditioning",image:n6,level:"All Levels",overview:"A bodyweight session to strengthen your posterior chain and improve posture. Great for back health, mobility, and muscular endurance.",tips:["On superman holds, lift your arms and legs simultaneously and hold tight","Focus on slow, controlled movements  quality over speed","Breathe steadily throughout timed holds  don't hold your breath","Engage your glutes and lower back together on every movement"],exercises:[{name:"Superman Hold",type:"timed",sets:4,time:30,storagePath:"exercises/bodyweight/upper/Superman Hold.mp4"},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:12,storagePath:null},{name:"Reverse Snow Angel",type:"reps",sets:3,reps:12,storagePath:null},{name:"Bird Dog",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Back Extension Hold",type:"timed",sets:3,time:30,storagePath:null}]}],shoulders:[{id:"shoulders_strength",name:"Shoulder Strength",desc:"Heavy pressing for boulder shoulders",image:GD,level:"Intermediate",overview:"A heavy overhead pressing session to build strong, powerful shoulders. Compound movements first, followed by isolation work for all three delt heads.",tips:["Go heavy on presses  pick a weight where you struggle on the last 2 reps","Brace your core and avoid arching your back during overhead movements","Press straight up and control the weight down slowly","Rest 90-120 seconds between pressing sets, 60 seconds for isolation moves"],exercises:[{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"shoulders_hypertrophy",name:"Shoulder Hypertrophy",desc:"Volume and isolation for 3D delts",image:KD,level:"Intermediate",overview:"A high-volume session targeting all three heads of the deltoid for that 3D capped shoulder look. Moderate weight, high reps, constant tension.",tips:["Use lighter weight than you think  shoulders respond best to high reps","On lateral raises, lead with your elbows and don't swing the weight","Pause at the top of each raise for a 1-second squeeze","Keep rest periods at 60 seconds to maximise the pump"],exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Y-Raise",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"shoulders_endurance",name:"Shoulder Endurance",desc:"Bodyweight and high-rep work",image:YD,level:"All Levels",overview:"A shoulder endurance session combining bodyweight movements with high-rep dumbbell work. Builds stamina, stability, and shoulder resilience.",tips:["On pike push ups, walk your feet close to your hands to increase the angle","For high-rep lateral raises, use a very light weight and focus on form","Wall walks are advanced  scale to pike push ups if needed","Keep your core braced throughout to protect your lower back"],exercises:[{name:"Pike Push Ups",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/upper/pike push ups.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,reps:20,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Wall Walks",type:"reps",sets:3,reps:6,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null},{name:"Shoulder Tap Hold",type:"timed",sets:3,time:30,storagePath:null}]}],arms:[{id:"arms_bicep",name:"Bicep Focus",desc:"Curl variations for peak biceps",image:VD,level:"All Levels",overview:"An arm session dedicated entirely to biceps. Multiple curl variations target different parts of the bicep for maximum peak and thickness.",tips:["Keep your elbows pinned to your sides  no swinging","Control the negative (lowering) for 2-3 seconds on every rep","Start with your heaviest weight and decrease as you fatigue","Squeeze hard at the top of each curl for a full contraction"],exercises:[{name:"Bicep Curl",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Concentration Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Isometric Bicep Hold",type:"timed",sets:3,time:20,storagePath:null}]},{id:"arms_tricep",name:"Tricep Focus",desc:"Extensions and dips for horseshoe triceps",image:UD,level:"All Levels",overview:"All-out tricep training with extensions, dips, and pressing movements. The triceps make up two-thirds of your arm  this session builds serious size.",tips:["On overhead extensions, keep your elbows close to your head","For skullcrushers, lower the weight slowly to just above your forehead","On dips, lean slightly forward to reduce shoulder strain","Full lockout at the top of every extension for maximum tricep contraction"],exercises:[{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Tricep Dips",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null}]},{id:"arms_full",name:"Full Arms",desc:"Superset biceps and triceps",image:FD,level:"All Levels",overview:"A balanced arm session alternating between biceps and triceps. Superset style keeps the intensity high and maximises the pump.",tips:["Superset each pair  do biceps then immediately hit triceps","Use moderate weight that lets you maintain strict form for all reps","Rest 60 seconds after each superset pair","Focus on the squeeze at the peak contraction of every rep"],exercises:[{name:"Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Wrist Curl",type:"weighted",sets:3,reps:15,storagePath:null}]}],legs:[{id:"legs_quad",name:"Quad Dominant",desc:"Squats and lunges for quad power",image:a6,level:"All Levels",overview:"A quad-focused leg session built around squats and lunges. Heavy compound movements to build strong, powerful quads and overall leg strength.",tips:["On goblet squats, hold the dumbbell close to your chest and sit deep","Keep your knees tracking over your toes  don't let them cave inward","Drive through your heels on all squatting movements","Rest 90-120 seconds between heavy sets, 60 seconds on bodyweight moves"],exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/lower/bulgarian split squats.mp4"},{name:"Squat And Hold",type:"timed",sets:3,time:30,storagePath:"exercises/bodyweight/lower/squat and hold.mp4"}]},{id:"legs_ham_glute",name:"Hamstring & Glute",desc:"Posterior chain focus",image:i6,level:"Intermediate",overview:"Target the back of your legs with deadlift and hip hinge variations. This session builds a strong posterior chain  hamstrings, glutes, and lower back.",tips:["On RDLs, push your hips back and feel the stretch in your hamstrings","Keep a slight bend in your knees throughout hip hinge movements","Squeeze your glutes hard at the top of every rep","For single leg work, start with your weaker side first"],exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/romanian deadlifts.mp4"},{name:"1 Legged RDL",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.mp4"},{name:"Hip Thrusts",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/hip thrusts.mp4"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.mp4"},{name:"Donkey Kicks",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.mp4"}]},{id:"legs_power",name:"Power & Plyo",desc:"Explosive leg training",image:o6,level:"Intermediate",overview:"An explosive leg session combining plyometrics with weighted movements. Build power, speed, and athletic performance.",tips:["On jump squats, land softly with bent knees to absorb the impact","Explode up on every rep  power comes from speed, not just weight","Keep rest periods at 60-90 seconds to maintain intensity","Focus on landing mechanics  knees out, chest up, soft landing"],exercises:[{name:"Jump Squats",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/lower/jump squats.mp4"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Skater Jumps",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/skater jumps.mp4"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.mp4"}]}],core:[{id:"core_lower_abs",name:"Lower Abs Blast",desc:"40s work / 20s rest  3 rounds",image:XD,level:"Intermediate",overview:"An interval-based core burner targeting the lower abdominals. 40 seconds of work followed by 20 seconds of rest  keep the intensity high and your lower back pressed into the floor throughout.",tips:["Press your lower back firmly into the floor on every rep","Exhale hard as you contract your abs  don't hold your breath","If your lower back lifts off the ground, reduce the range of motion","Focus on slow, controlled movements rather than speed"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Leg Raises",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Reverse Crunch To Leg Raise",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Flutter Kicks",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Dead Bug Single Leg Drop",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Hollow Hold Flutter Kicks",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"}]},{id:"core_obliques",name:"Obliques & Rotation",desc:"35s work / 25s rest  3 rounds",image:JD,level:"Intermediate",overview:"Target the obliques and rotational core muscles with this interval session. 35 seconds of work with 25 seconds rest  every exercise involves twisting, rotating, or side-bracing movements.",tips:["Rotate from your ribcage, not just your arms","Keep your hips as still as possible during twisting exercises","Brace your core before each movement  think about squeezing a belt","On side planks, stack your hips and push the floor away"],interval:!0,rounds:3,work:35,rest:25,exercises:[{name:"Russian Twist",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank Rotation",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Cross Body Mountain Climbers",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Hip Dips Plank",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Bicycle Crunch",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank",storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{id:"core_weighted",name:"Weighted Core",desc:"40s work / 20s rest  3 rounds",image:ZD,level:"Advanced",overview:"Add resistance to your core training with dumbbells and kettlebells. 40 seconds of weighted work followed by 20 seconds rest  this session builds serious core strength and stability.",tips:["Start with a moderate weight  form is more important than load","Brace your entire core before picking up the weight each round","Keep movements controlled  no swinging or using momentum","If grip fails before core does, go slightly lighter next time"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Russian Twists Dumbbell",storagePath:"exercises/dumbbells/core/russian twists dumbbell.mp4"},{name:"Kettlebell Russian Twist",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Dumbbell Plank Pull Through",storagePath:null}]}]},I2=[{key:"bodyweight",label:"Bodyweight",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"},{key:"dumbbells",label:"Dumbbells",icon:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"},{key:"kettlebells",label:"Kettlebells",icon:"M12 2C9.24 2 7 4.24 7 7c0 1.1.36 2.12.97 2.95C6.76 11.08 6 12.96 6 15c0 3.87 2.69 7 6 7s6-3.13 6-7c0-2.04-.76-3.92-1.97-5.05.61-.83.97-1.85.97-2.95 0-2.76-2.24-5-5-5zm0 2c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"}],Qp=[{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"},{key:"upper",label:"Upper",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"lower",label:"Lower",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"fullbody",label:"Full Body",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z"},{key:"mix",label:"Mix It Up",icon:"M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm-.83 9.41l-1.42 1.42L17.96 20.54l1.42-1.42-5.71-5.71z"}],Ul=[{key:"beginner",label:"Beginner",work:30,rest:30,desc:"30s work / 30s rest"},{key:"intermediate",label:"Intermediate",work:40,rest:20,desc:"40s work / 20s rest"},{key:"advanced",label:"Advanced",work:40,rest:15,desc:"40s work / 15s rest"}],Xp=[5,10,15,20,30];function m6(n){return n.replace(/\b\w/g,e=>e.toUpperCase())}function f6(n){const e=[...n];for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return e}function p6(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Rr(),{isDark:l,toggleTheme:u,accent:d}=Ia(),{isPremium:p,FREE_RANDOMISER_DURATIONS:g,FREE_RANDOMISER_WEEKLY_LIMIT:y}=pc(),x=Zn(),[_,j]=b.useState("menu"),[O,$]=b.useState(["bodyweight"]),[V,L]=b.useState("core"),[ee,Y]=b.useState("intermediate"),[te,ke]=b.useState(p?15:5),[Te,xe]=b.useState([]),[R,T]=b.useState(!1),S=b.useRef(!1),D=b.useRef([]),[I,U]=b.useState([]),[M,ze]=b.useState(2),[gt,B]=b.useState(Ul[1]),[se,ge]=b.useState(1),[Re,Q]=b.useState(0),[P,ae]=b.useState("work"),[Be,Ue]=b.useState(0),[Oe,Ie]=b.useState(!1),[ot,yt]=b.useState(0),[et,Xt]=b.useState(!1),[Es,Ot]=b.useState(!1),[wt,oe]=b.useState(null),Ct=b.useRef(null);b.useRef(null),b.useRef(null);const[kt,zt]=b.useState(null),Et=b.useCallback((G,ve="info")=>{zt({message:G,type:ve}),setTimeout(()=>zt(null),3e3)},[]),jt=b.useCallback(async G=>{if(!t)throw new Error("Not signed in");const ve=G&&typeof G=="object"&&G.type;await fa($t(pe,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:ve?"":G,type:ve?G.type:"text",imageURL:null,createdAt:vr(),likeCount:0,commentCount:0,...ve?{metadata:{title:G.title||"",subtitle:G.subtitle||"",stats:G.stats||[],quote:G.quote||"",badges:G.badges||[]}}:{}})},[t]),[tt,Mt]=b.useState(null),[qt,ms]=b.useState(null),[Ft,At]=b.useState(0),[us,vs]=b.useState(0),[as,nn]=b.useState([]),[Ds,Hs]=b.useState(""),[is,xs]=b.useState(""),[ye,Me]=b.useState(!1),[De,Qe]=b.useState(0),[He,Xe]=b.useState(!1),[ut,J]=b.useState({}),ne=b.useRef(null),$e=b.useRef(null),[bt,Ye]=b.useState([]),[vt,X]=b.useState(null),[Ae,Ge]=b.useState(0),[ht,Je]=b.useState(0),[Kt,Ht]=b.useState(0),[F,fe]=b.useState(0),[Se,Ee]=b.useState(0),[Ne,mt]=b.useState(0),[Nt,lt]=b.useState({beginner:0,intermediate:0,advanced:0}),Bt=p?Xp:Xp.filter(G=>g.includes(G)),Dt=!p&&Ae>=y,[Xs,vn]=b.useState(null),[mn,Nn]=b.useState(""),[Ks,cn]=b.useState(!1);b.useEffect(()=>{!i&&(!n||!e)&&x("/")},[n,e,i,x]),b.useEffect(()=>{if(!n||!t)return;(async()=>{try{const ve=$t(pe,"workoutLogs"),je=Fs(ve,bs("clientId","==",t.id)),at=(await Is(je)).docs.map(Zt=>Zt.data()),pt=at.filter(Zt=>Zt.type!=="programme");fe(pt.length);const Yt=pt.reduce((Zt,Ls)=>Zt+(Ls.duration||0),0);Ee(Yt);const Qt={beginner:0,intermediate:0,advanced:0};pt.forEach(Zt=>{Zt.level&&Qt[Zt.level]!==void 0&&Qt[Zt.level]++}),lt(Qt);const Jt=new Date,Dn=Jt.getDay(),os=Dn===0?-6:1-Dn,Ss=new Date(Jt);Ss.setDate(Jt.getDate()+os),Ss.setHours(0,0,0,0);const xn=Ss.getTime(),er=at.filter(Zt=>{const Ls=Zt.completedAt;return Ls?(Ls.toDate?Ls.toDate().getTime():new Date(Ls).getTime())>=xn:!1});Ge(er.filter(Zt=>Zt.type!=="programme").length);let Ps=0;if(t)try{const Zt=await Os(We(pe,"clientProgrammes",t.id));if(Zt.exists()){const Ls=Zt.data(),on=Ls.templateId;Ps=er.filter(Sn=>Sn.type==="programme"&&Sn.programmeId===on).length,vn(on);const tr=Yp.find(Sn=>Sn.id===on);tr&&Nn(tr.name);const zn=d6[on];if(zn){const Sn=Object.keys(Ls.completedSessions||{}).length,Kn=zn.duration*zn.daysPerWeek;Ht(Kn>0?Math.round(Sn/Kn*100):0)}}else vn(null),Nn(""),Ht(0)}catch{}Je(Ps);const $s=pt.map(Zt=>Zt.completedAt).filter(Boolean).map(Zt=>Zt.toDate?Zt.toDate().getTime():new Date(Zt).getTime()).sort((Zt,Ls)=>Ls-Zt);if($s.length===0)mt(0);else{const Zt=new Set;$s.forEach(Kn=>{const hr=new Date(Kn),Yn=hr.getDay(),mr=Yn===0?-6:1-Yn,Ir=new Date(hr);Ir.setDate(hr.getDate()+mr),Ir.setHours(0,0,0,0),Zt.add(Ir.getTime())});const Ls=[...Zt].sort((Kn,hr)=>hr-Kn);let on=0;const tr=new Date(Jt),zn=Jt.getDay()===0?-6:1-Jt.getDay();tr.setDate(Jt.getDate()+zn),tr.setHours(0,0,0,0);let Sn=tr.getTime();Ls.includes(Sn)||(Sn-=10080*60*1e3);for(let Kn=0;Kn<200&&Ls.includes(Sn);Kn++)on++,Sn-=10080*60*1e3;mt(on)}}catch(ve){console.error("Error loading workout stats:",ve)}finally{cn(!0)}})()},[n,t,_]);const Ns=()=>{const G=[];let ve;V==="mix"?ve=["core","upper","lower"]:V==="fullbody"?ve=["upper","lower"]:ve=[V];for(const je of O)for(const it of ve)G.push(`exercises/${je}/${it}`);return G},W=async()=>{if(S.current){for(;S.current;)await new Promise(G=>setTimeout(G,200));return D.current}S.current=!0,T(!0);try{const G=Ns(),ve=[];for(const pt of G)try{const Yt=gi(yi,pt),Qt=await k2(Yt);ve.push(...Qt.items)}catch{console.warn(`Folder ${pt} not found, skipping.`)}if(ve.length===0&&O.includes("bodyweight")&&V==="core")try{const pt=gi(yi,"core"),Yt=await k2(pt);ve.push(...Yt.items)}catch{console.warn("Legacy core/ folder not found either.")}if(ve.length===0){const pt=O.map(Qt=>I2.find(Jt=>Jt.key===Qt)?.label).join(" + "),Yt=Qp.find(Qt=>Qt.key===V)?.label;return Et(`No exercises found for ${pt} / ${Yt}. Upload videos to Firebase Storage.`,"error"),S.current=!1,T(!1),[]}const je=new Set,it=ve.filter(pt=>{const Yt=pt.name.replace(/\.(mp4|gif)$/i,"");return je.has(Yt)?!1:(je.add(Yt),!0)}),at=await Promise.all(it.map(async pt=>{const Yt=await co(pt),Qt=m6(pt.name.replace(/\.(mp4|gif)$/i,"")),Jt=/\.gif$/i.test(pt.name);return{name:Qt,videoUrl:Yt,isGif:Jt}}));return D.current=at,xe(at),S.current=!1,T(!1),at}catch(G){console.error("Error loading exercises:",G);const ve=G.code==="storage/unauthorized"?"Storage access denied. Check Firebase Storage rules allow read access.":`Failed to load exercises: ${G.message||G.code||"Unknown error"}`;return Et(ve,"error"),S.current=!1,T(!1),[]}},he=async()=>{if(Dt)return;j("spinning"),D.current=[];const G=await W();if(G.length===0){j("setup");return}const ve=Ul.find(Dn=>Dn.key===ee);B(ve);const je=ve.work+ve.rest,it=te*60,at=Math.floor(it/je);let pt,Yt;at<=6?(pt=Math.max(3,Math.floor(at/2)),Yt=Math.floor(at/pt)):at<=12?(pt=Math.min(6,Math.floor(at/2)),Yt=Math.floor(at/pt)):(pt=Math.min(10,Math.floor(at/2)),Yt=Math.floor(at/pt)),Yt=Math.max(2,Yt);const Qt=f6(G),Jt=Qt.slice(0,Math.min(pt,Qt.length));U(Jt),ze(Yt),setTimeout(()=>j("preview"),2e3)},ce=()=>{j("countdown"),yt(3)};b.useEffect(()=>{if(_!=="countdown")return;if(ot<=0){j("workout"),ge(1),Q(0),ae("work"),Ue(gt.work),Ie(!1),wr();return}rn();const G=setTimeout(()=>yt(ve=>ve-1),1e3);return()=>clearTimeout(G)},[ot,_]),b.useEffect(()=>{if(_!=="workout"||Oe)return;if(Be<=0){_e();return}Be<=3&&rn();const G=setTimeout(()=>Ue(ve=>ve-1),1e3);return()=>clearTimeout(G)},[Be,_,Oe]);const _e=()=>{if(P==="work")ae("rest"),Ue(gt.rest);else{const G=Re+1;if(G>=I.length){const ve=se+1;if(ve>M){Xt(!0),E();return}ge(ve),Q(0)}else Q(G);ae("work"),Ue(gt.work),wr()}},E=async()=>{if(n)try{await fa($t(pe,"workoutLogs"),{clientId:t.id,level:ee,duration:te,equipment:O,focus:V,exerciseCount:I.length,rounds:M,exercises:I.map(G=>G.name),completedAt:Rt.now()}),Ge(G=>G+1),fe(G=>G+1),Ee(G=>G+te),lt(G=>({...G,[ee]:(G[ee]||0)+1}))}catch(G){console.error("Error saving workout log:",G)}},z=async(G,ve,je)=>{if(!(!t||!ve))try{const it=t.id,at=await Os(We(pe,"coreBuddyPBs",it)),Yt=(at.exists()?at.data():null)?.exercises||{},Qt=Yt[G];let Jt=!1;if(Qt?(ve>(Qt.weight||0)||ve===(Qt.weight||0)&&je>(Qt.reps||0))&&(Jt=!0):Jt=!0,Jt){const Dn={...Yt,[G]:{weight:ve,reps:je,achievedAt:Rt.now()}};await Ms(We(pe,"coreBuddyPBs",it),{clientId:t.id,exercises:Dn,updatedAt:Rt.now()}),Et(`New PB! ${ve}kg  ${je} reps`,"success"),rn(),await ie(G,ve)}}catch(it){console.error("Error checking PB:",it)}},ie=async(G,ve)=>{if(t)try{const je=await Os(We(pe,"coreBuddyTargets",t.id));if(!je.exists())return;const at=(je.data().targets||{})[G];if(!at||ve<at.targetWeight)return;const pt=await Os(We(pe,"coreBuddyAchievements",t.id)),Yt=pt.exists()?pt.data():{clientId:t.id,badges:[],totalVolume:0};if(Yt.badges.some(os=>os.type==="pb_target"&&os.exercise===G&&os.targetWeight===at.targetWeight))return;const Jt={type:"pb_target",exercise:G,group:u6[G]||"push",targetWeight:at.targetWeight,achievedAt:Rt.now()},Dn=[...Yt.badges,Jt];await Ms(We(pe,"coreBuddyAchievements",t.id),{...Yt,badges:Dn,updatedAt:Rt.now()}),Ye(os=>[...os,Jt])}catch(je){console.error("Error checking target badge:",je)}},re=async G=>{if(!(!t||G<=0))try{const ve=await Os(We(pe,"coreBuddyAchievements",t.id)),je=ve.exists()?ve.data():{clientId:t.id,badges:[],totalVolume:0},it=je.totalVolume||0,at=it+G,pt=[];c6.forEach(Qt=>{at>=Qt.threshold&&it<Qt.threshold&&(je.badges.some(Dn=>Dn.type==="volume_milestone"&&Dn.milestone===Qt.threshold)||pt.push({type:"volume_milestone",milestone:Qt.threshold,label:Qt.label,achievedAt:Rt.now()}))});const Yt=[...je.badges,...pt];await Ms(We(pe,"coreBuddyAchievements",t.id),{clientId:t.id,badges:Yt,totalVolume:Math.round(at),updatedAt:Rt.now()}),pt.length>0&&Ye(Qt=>[...Qt,...pt])}catch(ve){console.error("Error updating volume:",ve)}},Ke=async G=>{if(ms(G),G.interval){const it=[];for(const at of G.exercises){let pt=null,Yt=!1;if(at.storagePath)try{const Qt=gi(yi,at.storagePath);pt=await co(Qt),Yt=/\.gif$/i.test(at.storagePath)}catch{}it.push({name:at.name,videoUrl:pt,isGif:Yt})}U(it),ze(G.rounds),B({work:G.work,rest:G.rest}),j("preview");return}const ve={};for(const it of G.exercises)if(it.storagePath)try{const at=gi(yi,it.storagePath);ve[it.name]={url:await co(at),isGif:/\.gif$/i.test(it.storagePath)}}catch{}J(ve);const je=G.exercises.map(it=>({name:it.name,type:it.type,targetSets:it.sets,targetReps:it.reps||0,targetTime:it.time||0,sets:[]}));nn(je),At(0),vs(0),Hs(""),xs(""),Xe(!1),Me(!1),Qe(0),Ye([]),X(null),j("muscle_workout")},rt=()=>{const G=ne.current;G&&(G.paused?(G.play(),Xe(!0)):(G.pause(),Xe(!1)))};b.useEffect(()=>{if(_!=="muscle_workout"||!ye||De<=0){_==="muscle_workout"&&ye&&De<=0&&(Me(!1),rn());return}return $e.current=setTimeout(()=>Qe(G=>G-1),1e3),()=>clearTimeout($e.current)},[_,ye,De]);const st=async()=>{const G=as[Ft];let ve={};if(G.type==="weighted"){const at=parseFloat(Ds)||0,pt=parseInt(is)||0;if(pt===0){Et("Enter your reps","error");return}ve={weight:at,reps:pt}}else if(G.type==="reps"){const at=parseInt(is)||0;if(at===0){Et("Enter your reps","error");return}ve={reps:at}}else if(G.type==="timed"){const at=G.targetTime-De;ve={time:Math.max(at,1)}}const je=[...as];je[Ft]={...G,sets:[...G.sets,ve]},nn(je),G.type==="weighted"&&ve.weight>0&&await z(G.name,ve.weight,ve.reps);const it=G.sets.length+1;if(it<G.targetSets)vs(it),xs(""),Me(!1),Qe(0);else if(Ft+1<as.length){const at=Ft+1;At(at),vs(0),Hs(""),xs(""),Xe(!1),Me(!1),Qe(0)}else await It(je),Ot(!0)},It=async G=>{if(!(!n||!t))try{const ve=G.reduce((it,at)=>it+at.sets.reduce((pt,Yt)=>pt+(Yt.weight||0)*(Yt.reps||0),0),0),je=G.reduce((it,at)=>it+at.sets.length,0);await fa($t(pe,"workoutLogs"),{clientId:t.id,type:"muscle_group",muscleGroup:tt,sessionId:qt?.id,sessionName:qt?.name,exerciseCount:G.length,totalSets:je,duration:Math.round(je*1.5),volume:Math.round(ve),exercises:G.map(it=>({name:it.name,type:it.type,sets:it.sets})),completedAt:Rt.now()}),ve>0&&await re(ve),bt.length>0&&X({badges:[...bt]})}catch(ve){console.error("Error saving muscle group workout log:",ve)}},ft=b.useRef(null),ds=()=>(ft.current||(ft.current=new(window.AudioContext||window.webkitAudioContext)),ft.current),rn=()=>{try{const G=ds(),ve=G.createOscillator(),je=G.createGain();ve.connect(je),je.connect(G.destination),ve.frequency.value=880,je.gain.value=.3,ve.start(G.currentTime),ve.stop(G.currentTime+.15)}catch{}},wr=()=>{try{const G=ds(),ve=G.createOscillator(),je=G.createGain();ve.connect(je),je.connect(G.destination),ve.frequency.value=1200,je.gain.value=.4,ve.start(G.currentTime),ve.stop(G.currentTime+.3)}catch{}};b.useEffect(()=>{if(_!=="workout"||P!=="work"||!I[Re]?.isGif)return;const ve=setInterval(()=>{const je=Ct.current;if(!je)return;const it=je.getAttribute("src");je.removeAttribute("src"),setTimeout(()=>{Ct.current&&Ct.current.setAttribute("src",it)},0)},4e3);return()=>clearInterval(ve)},[_,P,Re,se,I]);const fs=(G,ve,je)=>{const it=Math.round(G/ve*l6);return r.jsx("svg",{className:"wk-ring-svg",viewBox:"0 0 200 200",children:lD.map((at,pt)=>r.jsx("line",{x1:at.x1,y1:at.y1,x2:at.x2,y2:at.y2,className:pt<it?`wk-tick-filled ${je}`:"wk-tick-empty",strokeWidth:at.thick?"3":"2"},pt))})},Ar=()=>{const G=I.length*M;return((se-1)*I.length+Re+(P==="rest"?.5:0))/G},Mn=kt&&r.jsx("div",{className:`toast-notification ${kt.type}`,children:kt.message});if(i)return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>x("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsx("div",{className:"wk-loading-inline",children:r.jsx("div",{className:"wk-loading-spinner"})})]});if(_==="menu")return r.jsx(ga,{children:r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>x("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[r.jsxs("div",{className:"wk-menu-heading",children:[r.jsx("h2",{children:"Choose Your Workout"}),r.jsx("p",{children:"No excuses. Just results."})]}),r.jsx("button",{className:"wk-hero-card",onClick:()=>j("setup"),children:r.jsx("img",{src:C2,alt:"Randomise Workout",className:"wk-hero-bg"})}),!p&&r.jsxs("button",{className:"wk-hero-card wk-free-card-premium",onClick:()=>x("/upgrade"),children:[r.jsx("img",{src:R2,alt:"Programmes",className:"wk-hero-bg"}),r.jsx("div",{className:"wk-free-card-overlay"}),r.jsxs("div",{className:"wk-free-card-content",children:[r.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),r.jsx("span",{className:"wk-free-card-label",children:"Unlock Full Access"})]})]}),p&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"wk-section-header",children:[r.jsx("h2",{children:"Programmes"}),r.jsxs("span",{className:"wk-section-count",children:[Yp.length," available"]})]}),r.jsx("div",{className:"wk-prog-scroll-wrap",children:r.jsx("div",{className:"wk-prog-scroll",children:Yp.map((G,ve)=>G.image?r.jsxs("button",{className:"wk-prog-img-card",onClick:()=>x("/client/core-buddy/programmes",{state:{templateId:G.id}}),style:{animationDelay:`${ve*.06}s`},children:[r.jsx("img",{src:G.image,alt:G.name,className:"wk-prog-img"}),ve===0&&r.jsx("div",{className:"wk-swipe-arrow",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},G.id):r.jsxs("button",{className:"wk-prog-hero-card",onClick:()=>x("/client/core-buddy/programmes",{state:{templateId:G.id}}),style:{animationDelay:`${ve*.06}s`},children:[r.jsx("img",{src:R2,alt:"Programme",className:"wk-prog-hero-bg",loading:"lazy"}),r.jsx("div",{className:"wk-prog-hero-overlay",style:{background:h6[G.focus]}}),r.jsxs("div",{className:"wk-prog-hero-content",children:[r.jsxs("div",{className:"wk-prog-hero-top",children:[r.jsxs("span",{className:"wk-prog-hero-badge",children:[G.duration," WEEKS"]}),r.jsx("span",{className:"wk-prog-hero-level",children:G.level})]}),r.jsxs("div",{className:"wk-prog-hero-bottom",children:[r.jsx("h3",{children:G.name.toUpperCase()}),r.jsxs("p",{children:[G.daysPerWeek,"x per week  ",G.focus==="fullbody"?"Full Body":G.focus.charAt(0).toUpperCase()+G.focus.slice(1)," Focus"]}),r.jsx("span",{className:"wk-prog-hero-go",children:"VIEW PROGRAMME "})]})]}),ve===0&&r.jsx("div",{className:"wk-swipe-arrow",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},G.id))})})]}),p&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"wk-section-header",children:[r.jsx("h2",{children:"Muscle Groups"}),r.jsxs("span",{className:"wk-section-count",children:[iu.length," groups"]})]}),r.jsx("div",{className:"wk-muscle-grid",children:iu.map((G,ve)=>r.jsx("button",{className:`wk-muscle-hero-card${G.image?" wk-muscle-thumb":""}`,onClick:()=>{Mt(G.key),j("muscle_sessions")},style:{animationDelay:`${ve*.05}s`},children:G.image?r.jsx("img",{src:G.image,alt:G.label,className:"wk-muscle-thumb-img"}):r.jsxs(r.Fragment,{children:[r.jsx("img",{src:C2,alt:"Muscle group",className:"wk-muscle-hero-bg",loading:"lazy"}),r.jsx("div",{className:"wk-muscle-hero-overlay",style:{background:Kp[G.key]}}),r.jsxs("div",{className:"wk-muscle-hero-content",children:[r.jsx("div",{className:"wk-muscle-hero-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:G.icon})})}),r.jsxs("div",{className:"wk-muscle-hero-text",children:[r.jsx("span",{className:"wk-muscle-hero-name",children:G.label}),r.jsxs("span",{className:"wk-muscle-hero-count",children:[A2[G.key]?.length||0," sessions"]})]})]})]})},G.key))})]})]}),r.jsx(ta,{active:"workouts"}),Mn]})});if(_==="setup"){const G=Qp.find(je=>je.key===V)?.label||V,ve=Ul.find(je=>je.key===ee)?.label||ee;return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>j("menu"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main wk-setup-main",children:[r.jsx("div",{className:"wk-stats-row",children:[{label:"Total",value:`${F}`,pct:F>0?Math.min(Math.round(F/100*100),100):0,color:"#14b8a6",size:"normal"},{label:"This Week",value:`${Ae}/${Gp}`,pct:Math.round(Math.min(Ae,Gp)/Gp*100),color:"var(--color-primary)",size:"large"},{label:"Wk Streak",value:`${Ne}`,pct:Ne>0?Math.min(Math.round(Ne/12*100),100):0,color:"#38B6FF",size:"normal"}].map(je=>{const at=2*Math.PI*38,pt=at-je.pct/100*at;return r.jsxs("div",{className:`wk-stat-item${je.size==="large"?" wk-stat-large":""}`,children:[r.jsxs("div",{className:"wk-stat-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"wk-stat-track",cx:"50",cy:"50",r:38}),r.jsx("circle",{className:"wk-stat-fill",cx:"50",cy:"50",r:38,style:{stroke:je.color},strokeDasharray:at,strokeDashoffset:pt})]}),r.jsx("span",{className:"wk-stat-value",style:{color:je.color},children:je.value})]}),r.jsx("span",{className:"wk-stat-label",children:je.label})]},je.label)})}),r.jsxs("div",{className:"wk-setup-flow",children:[r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Focus Area"}),r.jsx("div",{className:"wk-focus-grid",children:Qp.map(je=>r.jsxs("button",{className:`wk-equip-btn${V===je.key?" active":""}${je.key==="mix"?" wk-mix-btn":""}`,onClick:()=>L(je.key),children:[r.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:je.icon})}),r.jsx("span",{children:je.label})]},je.key))})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Level"}),r.jsx("div",{className:"wk-level-cards",children:Ul.map(je=>r.jsxs("button",{className:`wk-level-card wk-level-${je.key}${ee===je.key?" active":""}`,onClick:()=>Y(je.key),children:[r.jsx("span",{className:"wk-level-name",children:je.label}),r.jsx("span",{className:"wk-level-desc",children:je.desc})]},je.key))})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Time"}),r.jsx("div",{className:"wk-time-options",children:Xp.map(je=>{const it=!Bt.includes(je);return r.jsxs("button",{className:`wk-time-btn${te===je?" active":""}${it?" locked":""}`,onClick:()=>!it&&ke(je),disabled:it,children:[r.jsx("span",{className:"wk-time-num",children:je}),r.jsx("span",{className:"wk-time-unit",children:it?r.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}):"min"})]},je)})})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Equipment"}),r.jsx("div",{className:"wk-equip-options",children:I2.map(je=>{const it=O.includes(je.key);return r.jsxs("button",{className:`wk-equip-btn${it?" active":""}`,onClick:()=>{$(at=>it&&at.length===1?at:it?at.filter(pt=>pt!==je.key):[...at,je.key])},children:[r.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:je.icon})}),r.jsx("span",{children:je.label})]},je.key)})})]}),r.jsx("div",{className:"wk-setup-summary",children:r.jsxs("span",{children:[G,"  ",ve,"  ",te," min"]})})]})]}),r.jsxs("div",{className:"wk-go-sticky",children:[Dt&&r.jsx("p",{className:"wk-free-limit-msg",children:"You've used your free workout this week. Upgrade for unlimited access."}),r.jsx("button",{className:"wk-randomise-btn",onClick:he,disabled:R||Dt,children:R?"Loading exercises...":Dt?"Limit Reached":"Randomise Workout"})]}),Mn]})}if(_==="spinning")return r.jsxs("div",{className:"wk-page wk-page-center","data-theme":l?"dark":"light","data-accent":d,children:[r.jsxs("div",{className:"wk-spin-container",children:[r.jsxs("div",{className:"wk-spin-ring",children:[r.jsx("svg",{className:"wk-spin-svg",viewBox:"0 0 200 200",children:Kk.map((G,ve)=>r.jsx("line",{x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,className:"wk-spin-tick",strokeWidth:G.thick?"3.5":"2",style:{animationDelay:`${ve*.03}s`}},ve))}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-spin-logo",width:"50",height:"50"})]}),r.jsx("p",{className:"wk-spin-text",children:"Generating workout..."})]}),Mn]});if(_==="preview"){const G=qt?.interval?{work:qt.work,rest:qt.rest}:Ul.find(je=>je.key===ee),ve=I.length*M*(G.work+G.rest);return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>j(qt?.interval?"muscle_sessions":"setup"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[qt?.interval&&r.jsx("h2",{className:"mg-preview-title",children:qt.name}),r.jsxs("div",{className:"wk-preview-stats",children:[r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:I.length}),r.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:M}),r.jsx("span",{className:"wk-stat-label",children:"Rounds"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:Math.ceil(ve/60)}),r.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsxs("span",{className:"wk-stat-val",children:[G.work,"/",G.rest]}),r.jsx("span",{className:"wk-stat-label",children:"Work/Rest"})]})]}),r.jsx("div",{className:"wk-preview-list",children:I.map((je,it)=>r.jsxs("div",{className:"wk-preview-item",style:{animationDelay:`${it*.06}s`},onClick:()=>oe(je),children:[r.jsx("span",{className:"wk-preview-num",children:it+1}),r.jsx("div",{className:"wk-preview-thumb",children:je.isGif?r.jsx("img",{src:je.videoUrl,alt:je.name,loading:"lazy"}):r.jsx("video",{src:`${je.videoUrl}#t=0.1`,muted:!0,playsInline:!0,preload:"auto"})}),r.jsx("span",{className:"wk-preview-name",children:je.name}),r.jsx("svg",{className:"wk-preview-play",width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]},it))}),wt&&r.jsx("div",{className:"wk-preview-modal-backdrop",onClick:()=>oe(null),children:r.jsxs("div",{className:"wk-preview-modal",onClick:je=>je.stopPropagation(),children:[r.jsx("button",{className:"wk-preview-modal-close",onClick:()=>oe(null),"aria-label":"Close preview",children:r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),r.jsx("div",{className:"wk-preview-modal-video",children:wt.isGif?r.jsx("img",{src:wt.videoUrl,alt:wt.name}):r.jsx("video",{src:wt.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0})}),r.jsx("h3",{className:"wk-preview-modal-title",children:wt.name})]})}),r.jsxs("div",{className:"wk-preview-actions",children:[!qt?.interval&&r.jsxs("button",{className:"wk-btn-secondary",onClick:()=>he(),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("polyline",{points:"1 4 1 10 7 10"}),r.jsx("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})]}),"Reshuffle"]}),r.jsx("button",{className:"wk-btn-primary",onClick:ce,children:"Start Workout"})]})]})]})}if(_==="countdown")return r.jsx("div",{className:"wk-page wk-page-center wk-page-dark","data-theme":l?"dark":"light","data-accent":d,children:r.jsxs("div",{className:"wk-countdown-big",children:[r.jsx("span",{className:"wk-countdown-num",children:ot}),r.jsx("span",{className:"wk-countdown-label",children:"GET READY"})]})});if(_==="workout"){const G=I[Re],ve=P==="work"?gt.work:gt.rest,je=P==="rest"?Re+1<I.length?I[Re+1]:se<M?I[0]:null:null;return r.jsxs("div",{className:"wk-page wk-page-workout","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("div",{className:"wk-video-container",children:P==="work"?G.isGif?r.jsx("img",{ref:Ct,className:"wk-video",src:G.videoUrl,alt:G.name},G.videoUrl):r.jsx("video",{className:"wk-video",src:G.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0},G.videoUrl):r.jsxs("div",{className:"wk-rest-screen",children:[r.jsx("span",{className:"wk-rest-label",children:"REST"}),je&&r.jsxs("span",{className:"wk-next-label",children:["Next: ",je.name]})]})}),r.jsx("div",{className:"wk-back-row",children:r.jsxs("button",{className:"wk-back-btn",onClick:()=>{confirm("Leave workout?")&&j("menu")},children:[r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]})}),r.jsx("div",{className:"wk-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"wk-exercise-info",children:[r.jsxs("span",{className:"wk-exercise-counter",children:[Re+1," / ",I.length]}),r.jsx("h2",{className:"wk-exercise-name",children:G.name}),r.jsxs("span",{className:"wk-round-label",children:["Round ",se," of ",M]})]}),r.jsx("div",{className:"wk-timer-section",children:r.jsxs("div",{className:"wk-timer-ring-wrap",children:[fs(Be,ve,P==="work"?"wk-tick-work":"wk-tick-rest"),r.jsxs("div",{className:"wk-timer-center",children:[r.jsx("span",{className:"wk-timer-time",children:Be}),r.jsx("span",{className:`wk-timer-phase ${P}`,children:P==="work"?"WORK":"REST"})]})]})}),r.jsxs("div",{className:"wk-controls",children:[r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-stop",onClick:()=>{confirm("End workout early?")&&j("menu")},children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})})}),r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-pause",onClick:()=>Ie(!Oe),children:Oe?r.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}):r.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:[r.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),r.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]})}),r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-skip",onClick:()=>{Ue(0)},children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:[r.jsx("polygon",{points:"5 4 15 12 5 20 5 4"}),r.jsx("rect",{x:"15",y:"4",width:"4",height:"16"})]})})]}),r.jsx("div",{className:"wk-progress-bar",children:r.jsx("div",{className:"wk-progress-fill",style:{width:`${Ar()*100}%`}})}),et&&(()=>{const it=Ul.find(pt=>pt.key===ee),at=I.length*M*(it.work+it.rest);return r.jsx(Jh,{title:"Workout Complete!",stats:[{value:Math.ceil(at/60),label:"Minutes"},{value:I.length*M,label:"Intervals"},{value:M,label:"Rounds"}],hideShare:!p,onShareJourney:t?jt:null,userName:t?.name,onDismissStart:()=>j("menu"),onDone:()=>{Xt(!1),ms(null),Mt(null)}})})()]})}if(_==="muscle_sessions"){const G=iu.find(je=>je.key===tt),ve=A2[tt]||[];return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>j("menu"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[r.jsxs("div",{className:"mg-sessions-header",children:[r.jsx("div",{className:"mg-sessions-icon",style:{background:Kp[tt]},children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:G?.icon})})}),r.jsxs("h2",{children:[G?.label," Workouts"]}),r.jsxs("p",{children:[ve.length," sessions available"]})]}),r.jsx("div",{className:"mg-sessions-list",children:ve.map((je,it)=>r.jsxs("button",{className:"mg-session-card",onClick:()=>{ms(je),j("muscle_overview")},style:{animationDelay:`${it*.08}s`},children:[r.jsxs("div",{className:"mg-session-info",children:[r.jsx("h3",{children:je.name}),r.jsx("p",{children:je.desc}),r.jsx("div",{className:"mg-session-meta",children:je.interval?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"mg-session-tag mg-tag-interval",children:"Interval"}),r.jsxs("span",{className:"mg-session-tag",children:[je.exercises.length," exercises"]}),r.jsxs("span",{className:"mg-session-tag",children:[je.rounds," rounds"]})]}):r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"mg-session-tag mg-tag-strength",children:"Strength"}),r.jsxs("span",{className:"mg-session-tag",children:[je.exercises.length," exercises"]}),r.jsx("span",{className:"mg-session-tag",children:(()=>{const at=je.exercises.map(Qt=>Qt.sets||0),pt=Math.min(...at),Yt=Math.max(...at);return pt===Yt?`${pt} sets each`:`${pt}-${Yt} sets each`})()})]})})]}),r.jsx("div",{className:"mg-session-arrow",children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},je.id))})]}),Mn]})}if(_==="muscle_overview"){const G=qt;if(!G)return null;const ve=iu.find(je=>je.key===tt);return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>j("muscle_sessions"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main mg-overview-main",children:[r.jsx("div",{className:"mg-overview-hero",style:G.image?void 0:{background:Kp[tt]},children:G.image?r.jsx("img",{src:G.image,alt:G.name,className:"mg-overview-hero-img"}):r.jsx("div",{className:"mg-overview-hero-content",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"mg-overview-hero-icon",children:r.jsx("path",{d:ve?.icon})})})}),r.jsxs("div",{className:"mg-overview-header",children:[r.jsxs("div",{className:"mg-overview-title-row",children:[r.jsx("h2",{children:G.name}),G.level&&r.jsx("span",{className:"mg-overview-level",children:G.level})]}),r.jsx("p",{className:"mg-overview-desc",children:G.desc})]}),G.overview&&r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 16v-4M12 8h.01"})]}),"About This Workout"]}),r.jsx("p",{children:G.overview})]}),G.tips&&G.tips.length>0&&r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Tips & Form"]}),r.jsx("ul",{className:"mg-overview-tips",children:G.tips.map((je,it)=>r.jsx("li",{children:je},it))})]}),r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"}),r.jsx("rect",{x:"9",y:"3",width:"6",height:"4",rx:"1"}),r.jsx("path",{d:"M9 14l2 2 4-4"})]}),"Exercises (",G.exercises.length,")"]}),r.jsx("div",{className:"mg-overview-exercises",children:G.exercises.map((je,it)=>r.jsxs("div",{className:"mg-overview-exercise",children:[r.jsx("span",{className:"mg-overview-ex-num",children:it+1}),r.jsxs("div",{className:"mg-overview-ex-info",children:[r.jsx("span",{className:"mg-overview-ex-name",children:je.name}),G.interval?r.jsxs("span",{className:"mg-overview-ex-detail",children:[G.work,"s work / ",G.rest,"s rest"]}):r.jsxs("span",{className:"mg-overview-ex-detail",children:[je.sets," sets  ",je.reps?`${je.reps} reps`:`${je.time}s`,je.type==="weighted"&&"  weighted"]})]})]},it))})]}),r.jsxs("button",{className:"mg-overview-start-btn",onClick:()=>Ke(G),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Workout"]})]}),Mn]})}if(_==="muscle_workout"){const G=qt;if(!G)return null;const ve=G.exercises[Ft],je=as[Ft];if(!ve||!je)return null;const it=je.sets.length,at=G.exercises.length,pt=G.exercises.reduce((os,Ss)=>os+(Ss.sets||0),0),Qt=as.reduce((os,Ss)=>os+Ss.sets.length,0)/pt*100,Jt=ut[ve.name];ve.type==="timed"&&De===0&&!ye&&it===us&&setTimeout(()=>Qe(ve.time),0);const Dn=it+1<ve.sets?"Log Set":Ft+1<at?"Log Set  Next Exercise":"Log Set  Complete";return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("div",{className:"mg-session-progress",children:r.jsx("div",{className:"mg-session-progress-fill",style:{width:`${Qt}%`}})}),r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>{confirm("End workout early?")&&j("muscle_overview")},"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsxs("span",{className:"mg-header-info",children:["Exercise ",Ft+1,"/",at]}),r.jsx("div",{style:{width:22}})]})}),r.jsxs("main",{className:"wk-main",children:[Jt?r.jsxs("div",{className:"mg-video-container",onClick:rt,children:[Jt.isGif?r.jsx("img",{className:"mg-video",src:Jt.url,alt:ve.name}):r.jsx("video",{ref:ne,className:"mg-video",src:Jt.url,loop:!0,muted:!0,playsInline:!0},ve.name),!He&&!Jt.isGif&&r.jsxs("div",{className:"mg-video-overlay",children:[r.jsx("svg",{className:"mg-play-icon",width:"48",height:"48",viewBox:"0 0 24 24",fill:"rgba(255,255,255,0.9)",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),r.jsx("span",{className:"mg-video-hint",children:"Tap for demo"})]})]}):r.jsxs("div",{className:"mg-video-placeholder",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.4",children:[r.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),r.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),r.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),r.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),r.jsx("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),r.jsx("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),r.jsx("line",{x1:"17",y1:"7",x2:"22",y2:"7"}),r.jsx("line",{x1:"17",y1:"17",x2:"22",y2:"17"})]}),r.jsx("span",{children:"Video coming soon"})]}),r.jsx("div",{className:"wk-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"mg-exercise-card",children:[r.jsx("h2",{className:"mg-ex-name",children:ve.name}),r.jsx("span",{className:`mg-ex-type-badge ${ve.type}`,children:ve.type==="weighted"?"Weight + Reps":ve.type==="reps"?"Reps Only":"Timed"}),r.jsxs("div",{className:"mg-ex-set-info",children:[r.jsxs("span",{className:"mg-ex-set-num",children:["Set ",it+1," of ",ve.sets]}),ve.type!=="timed"&&r.jsxs("span",{className:"mg-ex-target",children:["Target: ",ve.reps," reps"]}),ve.type==="timed"&&r.jsxs("span",{className:"mg-ex-target",children:["Target: ",ve.time,"s"]})]}),ve.type==="weighted"&&r.jsxs("div",{className:"mg-input-area",children:[r.jsxs("div",{className:"mg-input-group",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",className:"mg-input",value:Ds,onChange:os=>Hs(os.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"mg-input-group",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:is,onChange:os=>xs(os.target.value),placeholder:"0"})]})]}),ve.type==="reps"&&r.jsx("div",{className:"mg-input-area",children:r.jsxs("div",{className:"mg-input-group mg-input-single",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:is,onChange:os=>xs(os.target.value),placeholder:"0"})]})}),ve.type==="timed"&&r.jsxs("div",{className:"mg-timer-area",children:[r.jsx("div",{className:"mg-timer-display",children:r.jsxs("span",{className:"mg-timer-value",children:[De,"s"]})}),ye?r.jsx("button",{className:"mg-timer-btn mg-timer-stop",onClick:()=>Me(!1),children:"Stop"}):r.jsx("button",{className:"mg-timer-btn",onClick:()=>{De===0&&Qe(ve.time),Me(!0)},children:De<ve.time&&De>0?"Resume":"Start Timer"})]}),r.jsx("button",{className:"mg-log-set-btn",onClick:st,children:Dn}),je.sets.length>0&&r.jsx("div",{className:"mg-completed-sets",children:je.sets.map((os,Ss)=>r.jsxs("div",{className:"mg-completed-set",children:[r.jsx("span",{className:"mg-completed-set-check",children:""}),r.jsxs("span",{children:["Set ",Ss+1,": ",os.weight!=null?`${os.weight}kg  ${os.reps}`:os.reps!=null?`${os.reps} reps`:`${os.time}s`]})]},Ss))})]})]}),Mn,Es&&(()=>{const os=as.reduce((Ps,$s)=>Ps+$s.sets.length,0),Ss=as.reduce((Ps,$s)=>Ps+$s.sets.reduce((Zt,Ls)=>Zt+(Ls.weight||0)*(Ls.reps||0),0),0),xn=iu.find(Ps=>Ps.key===tt)?.label||"",er=[{value:as.length,label:"Exercises"},{value:os,label:"Sets"}];return Ss>0&&er.push({value:Math.round(Ss).toLocaleString(),label:"Volume (kg)"}),r.jsx(Jh,{title:`${xn} Complete!`,subtitle:qt?.name,stats:er,hideShare:!p,onShareJourney:t?jt:null,userName:t?.name,onDismissStart:()=>j("menu"),onDone:()=>{Ot(!1),ms(null),Mt(null),X(null)}})})(),vt&&r.jsx("div",{className:"mg-badge-celebration",onClick:()=>X(null),children:r.jsxs("div",{className:"mg-badge-celebration-card",children:[r.jsx("div",{className:"mg-badge-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",width:"48",height:"48",fill:"#ffc107",children:r.jsx("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})})}),r.jsx("h3",{className:"mg-badge-celebration-title",children:vt.badges.length===1?"Badge Earned!":`${vt.badges.length} Badges Earned!`}),r.jsx("div",{className:"mg-badge-celebration-list",children:vt.badges.map((os,Ss)=>r.jsx("div",{className:"mg-badge-celebration-item",children:os.type==="pb_target"?`${os.exercise}  ${os.targetWeight}kg`:os.label},Ss))}),r.jsxs("div",{className:"mg-badge-share-row",children:[r.jsxs("button",{className:"mg-badge-share-btn",onClick:async os=>{os.stopPropagation();const Ss=vt.badges[0],xn=vt.badges.map(Ps=>Ps.type==="pb_target"?`PB Target Hit: ${Ps.exercise}  ${Ps.targetWeight}kg`:Ps.label),er=Wn.find(Ps=>Ps.id===Ss?.id)||Wn.find(Ps=>Ps.name===Ss?.label);await jt({type:"badge_earned",title:xn.length===1?xn[0]:`${xn.length} Badges Earned!`,badges:xn,badgeDesc:er?.desc}),Et("Posted to Journey!","success")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20h9"}),r.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4Z"})]}),"Journey"]}),r.jsxs("button",{className:"mg-badge-share-btn",onClick:async os=>{os.stopPropagation();const Ss=vt.badges[0],xn=vt.badges.map($s=>$s.type==="pb_target"?`PB Target Hit: ${$s.exercise}  ${$s.targetWeight}kg`:$s.label),er=Wn.find($s=>$s.id===Ss?.id)||Wn.find($s=>$s.name===Ss?.label),Ps=`Badge Earned! ${xn.join(", ")}
#MindCoreFitness`;try{const $s=await tb({type:"badge",title:xn.length===1?xn[0]:"Badges Earned!",badges:xn,badgeImage:er?.img,badgeDesc:er?.desc});navigator.share&&navigator.canShare?.({files:[new File([$s],"badge.png",{type:"image/png"})]})?await navigator.share({title:"Mind Core Fitness",text:Ps,files:[new File([$s],"badge.png",{type:"image/png"})]}):navigator.share?await navigator.share({title:"Mind Core Fitness",text:Ps}):(await navigator.clipboard.writeText(Ps),Et("Copied!","success"))}catch{try{await navigator.clipboard.writeText(Ps),Et("Copied!","success")}catch{}}},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"18",cy:"5",r:"3"}),r.jsx("circle",{cx:"6",cy:"12",r:"3"}),r.jsx("circle",{cx:"18",cy:"19",r:"3"}),r.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),r.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),"Share"]})]}),r.jsx("button",{className:"mg-badge-celebration-dismiss",children:"Tap to dismiss"})]})})]})}return null}const g6=60,y6={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},b6=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],M2=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,daysPerWeek:3,level:"All Levels",description:"Build total body strength with compound dumbbell movements and bodyweight finishers",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push Focus",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Goblet Squats",type:"weighted",sets:3,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull Focus",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:3,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:3,baseReps:10,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Reverse Lunge",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/reverse lunge.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Legs & Core",exercises:[{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Box Step Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/box step ups.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,daysPerWeek:3,level:"Intermediate",description:"Two-phase programme building strength and endurance across your full body",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Power",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"}]},{name:"Day 3",label:"Endurance",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,daysPerWeek:3,level:"Advanced",description:"Complete transformation programme: push, pull, and legs over three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Upper Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Lower Body",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 3",label:"Upper Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,daysPerWeek:3,level:"Beginner",description:"Build a solid core foundation with targeted ab and stability work",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Abs",exercises:[{name:"Crunch",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Stability",exercises:[{name:"Dead Bug",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Bird Dog",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:20,storagePath:"exercises/bodyweight/core/Side Plank.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"}]},{name:"Day 3",label:"Power Core",exercises:[{name:"Single Leg V-Up",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Single Leg V-Up.mp4"},{name:"Toe Reaches",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/toe reaches.GIF"},{name:"Russian Twists Dumbbell",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/core/russian twists dumbbell.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Fast Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Fast Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,daysPerWeek:3,level:"Intermediate",description:"Develop deep core strength and rotational power over two phases",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Anti-Extension",exercises:[{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Dead Bug",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Plank Walkout",type:"reps",sets:3,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"}]},{name:"Day 2",label:"Rotation",exercises:[{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank Rotation",type:"reps",sets:2,baseReps:10,storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"},{name:"Hollow Hold To V-Sit",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Kettlebell Bird Dog Drag",type:"reps",sets:3,baseReps:10,storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,daysPerWeek:3,level:"Advanced",description:"Ultimate core transformation: stability, strength, and power across three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Forearm Plank",type:"timed",sets:4,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Plank Walkout",type:"reps",sets:4,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Leg Raises",type:"reps",sets:4,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Kettlebell Side Bends",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Dead Bug Single Leg Drop",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 2",label:"Endurance",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:4,baseReps:15,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Hollow Hold Flutter Kicks",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"},{name:"Cross Body Mountain Climbers",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Hollow Hold To V-Sit",type:"reps",sets:4,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Hip Dips Plank",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Kneeling Kettlebell Halo",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,daysPerWeek:3,level:"Intermediate",description:"Sculpt and strengthen your chest, back, shoulders, and arms",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Tricep Dips",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Pike Push Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/upper/pike push ups.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Reverse Plank",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/upper/reverse plank.GIF"}]},{name:"Day 3",label:"Mixed",exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Renegade Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Superman Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Superman Hold.mp4"}]}]},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,daysPerWeek:3,level:"Intermediate",description:"Build powerful legs and glutes with squats, deadlifts, and plyometrics",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Quad Dominant",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Squat And Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/lower/squat and hold.GIF"}]},{name:"Day 2",label:"Hamstring & Glute",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"1 Legged RDL",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.GIF"},{name:"Hip Thrusts",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/hip thrusts.GIF"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.GIF"},{name:"Donkey Kicks",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 3",label:"Power & Stability",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Kettlebell Romanian Deadlift",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/kettlebells/lower/kettlebell romanian deadlift.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Skater Jumps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/skater jumps.GIF"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]}];function uh(n,e,t){const i=n.baseReps?n.baseReps+(e-1)*(t.repProg||0):void 0,l=n.baseTime?n.baseTime+(e-1)*(t.timeProg||0):void 0;return{sets:n.sets,reps:i,time:l}}const v6={fullbody:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z",core:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z",upper:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z",lower:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"};function x6(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Rr(),{isPremium:l}=pc(),{isDark:u,toggleTheme:d,accent:p}=Ia(),g=Zn(),y=Aa(),[x,_]=b.useState("loading"),[j,O]=b.useState(null),$=b.useRef(!1),[V,L]=b.useState(null),[ee,Y]=b.useState(!1),[te,ke]=b.useState(1),[Te,xe]=b.useState(0),[R,T]=b.useState(0),[S,D]=b.useState(0),[I,U]=b.useState([]),[M,ze]=b.useState(""),[gt,B]=b.useState(""),[se,ge]=b.useState(!1),[Re,Q]=b.useState(0),P=b.useRef(null),[ae,Be]=b.useState({}),[Ue,Oe]=b.useState(!1),Ie=b.useRef(null),[ot,yt]=b.useState(null),[et,Xt]=b.useState([]);b.useEffect(()=>{window.scrollTo(0,0)},[x]);const[Es,Ot]=b.useState(null),wt=b.useCallback((ye,Me="info")=>{Ot({message:ye,type:Me}),setTimeout(()=>Ot(null),4e3)},[]),oe=b.useCallback(async ye=>{if(!t)throw new Error("Not signed in");const Me=ye&&typeof ye=="object"&&ye.type;await fa($t(pe,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Me?"":ye,type:Me?ye.type:"text",imageURL:null,createdAt:vr(),likeCount:0,commentCount:0,...Me?{metadata:{title:ye.title||"",subtitle:ye.subtitle||"",stats:ye.stats||[],quote:ye.quote||"",badges:ye.badges||[]}}:{}})},[t]),Ct=b.useRef(null),kt=()=>(Ct.current||(Ct.current=new(window.AudioContext||window.webkitAudioContext)),Ct.current),zt=()=>{try{const ye=kt(),Me=ye.createOscillator(),De=ye.createGain();Me.connect(De),De.connect(ye.destination),Me.frequency.value=1200,De.gain.value=.4,Me.start(ye.currentTime),Me.stop(ye.currentTime+.3)}catch{}};b.useEffect(()=>{!i&&(!n||!e)&&g("/")},[n,e,i,g]),b.useEffect(()=>{if(!t)return;(async()=>{try{const Me=We(pe,"clientProgrammes",t.id),De=await Os(Me);De.exists()&&L(De.data());const Qe=y.state?.templateId;if(Qe&&!$.current){const He=M2.find(Xe=>Xe.id===Qe);if(He){$.current=!0,O(He),_("overview");return}}De.exists()?_("dashboard"):g("/client/core-buddy/workouts",{replace:!0})}catch(Me){console.error("Error loading programme:",Me),g("/client/core-buddy/workouts",{replace:!0})}})()},[t]),b.useEffect(()=>{if(!se||Re<=0){se&&Re<=0&&(ge(!1),zt());return}return P.current=setTimeout(()=>Q(ye=>ye-1),1e3),()=>clearTimeout(P.current)},[se,Re]);const Et=async ye=>{if(t)try{await Ms(We(pe,"clientProgrammes",t.id),ye),L(ye)}catch(Me){console.error("Error saving programme:",Me),wt("Failed to save. Check Firestore rules for clientProgrammes.","error")}},jt=async ye=>{const Me={templateId:ye.id,startDate:Rt.now(),completedSessions:{}};await Et(Me),_("dashboard")},tt=async()=>{if(t)try{await Tr(We(pe,"clientProgrammes",t.id)),L(null),_("browse")}catch(ye){console.error("Error quitting programme:",ye)}},Mt=()=>V?M2.find(ye=>ye.id===V.templateId):null,qt=()=>{if(!V?.startDate)return 1;const ye=V.startDate.toDate?V.startDate.toDate():new Date(V.startDate),De=new Date-ye,Qe=Math.floor(De/(1e3*60*60*24));return Math.floor(Qe/7)+1},ms=()=>{if(!V)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const ye=V.completedSessions||{},Me=Object.keys(ye).length,De=Mt();if(!De)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const Qe=De.duration*De.daysPerWeek,He=qt(),Xe=Math.min(He,De.duration);let ut=0;for(let ne=0;ne<De.daysPerWeek;ne++)ye[`w${Xe}d${ne}`]&&ut++;if(Me>=Qe)return{currentWeek:De.duration,completedThisWeek:De.daysPerWeek,nextDay:-1,totalCompleted:Me,totalSessions:Qe,complete:!0};if(He>De.duration)return{currentWeek:De.duration,completedThisWeek:ut,nextDay:-1,totalCompleted:Me,totalSessions:Qe,complete:!0};let J=-1;for(let ne=0;ne<De.daysPerWeek;ne++)if(!ye[`w${Xe}d${ne}`]){J=ne;break}return{currentWeek:Xe,completedThisWeek:ut,nextDay:J,nextWeek:Xe,totalCompleted:Me,totalSessions:Qe}},Ft=ye=>{const Me=qt();return ye<Me},At=(ye,Me,De)=>{if(!V||ye<=1)return null;const Qe=`w${ye-1}d${Me}`,He=V.completedSessions?.[Qe];if(!He)return null;const Xe=He.exercises?.find(ut=>ut.name===De);return Xe?.sets?.length?Xe.sets[Xe.sets.length-1]:null},us=(ye,Me)=>{const De=Mt();if(!De)return;ke(ye),xe(Me),T(0),D(0),U([]),B(""),ge(!1),Q(0),Oe(!1),Be({});const Qe=De.days[Me],He=Qe.exercises.map(ne=>{const $e=uh(ne,ye,De);return{name:ne.name,type:ne.type,pbKey:ne.pbKey,targetSets:$e.sets,targetReps:$e.reps,targetTime:$e.time,sets:[]}});U(He);const Xe=Qe.exercises[0],ut=At(ye,Me,Xe.name);ut?.weight&&Xe.type==="weighted"?ze(String(ut.weight)):ze(""),(async()=>{const ne={};for(const $e of Qe.exercises)if($e.storagePath)try{const bt=gi(yi,$e.storagePath),Ye=await co(bt);ne[$e.name]={url:Ye,isGif:/\.gif$/i.test($e.storagePath)}}catch(bt){console.warn(`Video not found for ${$e.name}:`,bt)}Be(ne)})(),_("session")},vs=async()=>{Mt();const ye=I[R];if(!ye)return;let Me={};if(ye.type==="weighted"){const He=parseFloat(M)||0,Xe=parseInt(gt)||0;if(Xe===0){wt("Enter your reps","error");return}Me={weight:He,reps:Xe}}else if(ye.type==="reps"){const He=parseInt(gt)||0;if(He===0){wt("Enter your reps","error");return}Me={reps:He}}else if(ye.type==="timed"){const He=ye.targetTime-Re;Me={time:Math.max(He,1)}}const De=[...I];De[R]={...ye,sets:[...ye.sets,Me]},U(De),ye.type==="weighted"&&Me.weight>0&&await Ds(ye.name,Me.weight,Me.reps);const Qe=ye.sets.length+1;if(Qe<ye.targetSets)D(Qe),ze(Me.weight?String(Me.weight):""),B(""),ge(!1),Q(0);else if(R+1<I.length){const He=R+1;T(He),D(0),Oe(!1);const ut=Mt()?.days[Te]?.exercises[He],J=At(te,Te,ut?.name);J?.weight&&ut?.type==="weighted"?ze(String(J.weight)):ze(""),B(""),ge(!1),Q(0)}else await as(De)},as=async ye=>{if(!V||!t)return;const Me=`w${te}d${Te}`,De={...V.completedSessions,[Me]:{completedAt:new Date().toISOString(),exercises:ye.map(Xe=>({name:Xe.name,type:Xe.type,sets:Xe.sets}))}},Qe={...V,completedSessions:De};await Et(Qe);const He=ye.reduce((Xe,ut)=>Xe+ut.sets.reduce((J,ne)=>J+(ne.weight||0)*(ne.reps||0),0),0);He>0&&await nn(He);try{const Xe=Mt();await fa($t(pe,"workoutLogs"),{clientId:t.id,type:"programme",programmeId:Xe?.id,programmeName:Xe?.name,week:te,day:Te+1,exerciseCount:ye.length,duration:Math.round(ye.reduce((ut,J)=>ut+J.sets.length*1.5,0)),volume:Math.round(He),completedAt:Rt.now()})}catch(Xe){console.error("Error saving workout log:",Xe)}et.length>0&&(yt({badges:[...et]}),Xt([])),Y(!0)},nn=async ye=>{if(t)try{const Me=await Os(We(pe,"coreBuddyAchievements",t.id)),De=Me.exists()?Me.data():{clientId:t.id,badges:[],totalVolume:0},Qe=De.totalVolume||0,He=Qe+ye,Xe=[];b6.forEach(J=>{He>=J.threshold&&Qe<J.threshold&&(De.badges.some($e=>$e.type==="volume_milestone"&&$e.milestone===J.threshold)||Xe.push({type:"volume_milestone",milestone:J.threshold,label:J.label,achievedAt:Rt.now()}))});const ut=[...De.badges,...Xe];await Ms(We(pe,"coreBuddyAchievements",t.id),{clientId:t.id,badges:ut,totalVolume:Math.round(He),updatedAt:Rt.now()}),Xe.length>0&&Xt(J=>[...J,...Xe])}catch(Me){console.error("Error updating volume:",Me)}},Ds=async(ye,Me,De)=>{if(t)try{const Qe=t.id,He=await Os(We(pe,"coreBuddyPBs",Qe)),ut=(He.exists()?He.data():null)?.exercises||{},J=ut[ye];let ne=!1;if(J?(Me>(J.weight||0)||Me===(J.weight||0)&&De>(J.reps||0))&&(ne=!0):ne=!0,ne){const $e={...ut,[ye]:{weight:Me,reps:De,achievedAt:Rt.now()}};await Ms(We(pe,"coreBuddyPBs",Qe),{clientId:t.id,exercises:$e,updatedAt:Rt.now()}),wt(`New PB! ${Me}kg  ${De} reps`,"success"),zt(),await Hs(ye,Me)}}catch(Qe){console.error("Error checking PB:",Qe)}},Hs=async(ye,Me)=>{if(t)try{const De=await Os(We(pe,"coreBuddyTargets",t.id));if(!De.exists())return;const He=(De.data().targets||{})[ye];if(!He||Me<He.targetWeight)return;const Xe=await Os(We(pe,"coreBuddyAchievements",t.id)),ut=Xe.exists()?Xe.data():{clientId:t.id,badges:[],totalVolume:0};if(ut.badges.some(bt=>bt.type==="pb_target"&&bt.exercise===ye&&bt.targetWeight===He.targetWeight))return;const ne={type:"pb_target",exercise:ye,group:y6[ye]||"push",targetWeight:He.targetWeight,achievedAt:Rt.now()},$e=[...ut.badges,ne];await Ms(We(pe,"coreBuddyAchievements",t.id),{...ut,badges:$e,updatedAt:Rt.now()}),Xt(bt=>[...bt,ne])}catch(De){console.error("Error checking target badge:",De)}},is=Es&&r.jsxs("div",{className:`toast-notification ${Es.type}`,children:[Es.type==="success"&&r.jsx("span",{children:" "}),Es.message]}),xs=(ye,Me)=>r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:Me,"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:u?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})});if(i||x==="loading")return r.jsx("div",{className:"cb-loading",children:r.jsx("div",{className:"cb-loading-spinner"})});if(x==="browse")return g("/client/core-buddy/workouts",{replace:!0}),null;if(x==="overview"&&j){const ye=j;return r.jsx(ga,{children:r.jsxs("div",{className:"pg-page","data-theme":u?"dark":"light","data-accent":p,children:[xs(ye.name,()=>g("/client/core-buddy/workouts")),r.jsxs("main",{className:"pg-main",children:[r.jsxs("div",{className:"pg-overview-hero",children:[r.jsx("svg",{className:"pg-overview-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:v6[ye.focus]})}),r.jsx("h2",{className:"pg-overview-name",children:ye.name}),r.jsx("p",{className:"pg-overview-desc",children:ye.description}),r.jsxs("div",{className:"pg-overview-stats",children:[r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:ye.duration}),r.jsx("span",{className:"pg-ov-stat-label",children:"Weeks"})]}),r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:ye.daysPerWeek}),r.jsx("span",{className:"pg-ov-stat-label",children:"Days/Week"})]}),r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:ye.duration*ye.daysPerWeek}),r.jsx("span",{className:"pg-ov-stat-label",children:"Sessions"})]})]})]}),r.jsx("div",{className:"pg-overview-days",children:ye.days.map((Me,De)=>r.jsxs("div",{className:"pg-day-card",children:[r.jsxs("div",{className:"pg-day-header",children:[r.jsx("span",{className:"pg-day-name",children:Me.name}),r.jsx("span",{className:"pg-day-label",children:Me.label})]}),r.jsx("div",{className:"pg-day-exercises",children:Me.exercises.map((Qe,He)=>{const Xe=uh(Qe,1,ye);return r.jsxs("div",{className:"pg-day-ex",children:[r.jsx("span",{className:"pg-day-ex-name",children:Qe.name}),r.jsx("span",{className:"pg-day-ex-target",children:Qe.type==="timed"?`${Xe.sets}${Xe.time}s`:`${Xe.sets}${Xe.reps}`}),r.jsx("span",{className:`pg-day-ex-badge pg-badge-${Qe.type}`,children:Qe.type==="weighted"?"WT":Qe.type==="timed"?"TMR":"BW"})]},He)})})]},De))}),r.jsxs("div",{className:"pg-overview-note",children:[r.jsx("strong",{children:"Progressive Overload:"})," +",ye.repProg," reps/week",ye.timeProg?`, +${ye.timeProg}s/week for timed`:""]}),r.jsx("button",{className:"pg-start-btn",onClick:()=>jt(ye),children:"Start Programme"})]}),is]})})}if(x==="dashboard"){const ye=Mt();if(!ye)return _("browse"),null;const Me=ms(),De=V?.completedSessions||{},Qe=Me.totalSessions?Math.round(Me.totalCompleted/Me.totalSessions*100):0;return Math.round(Me.totalCompleted/(Me.totalSessions||1)*g6),r.jsx(ga,{children:r.jsxs("div",{className:"pg-page","data-theme":u?"dark":"light","data-accent":p,children:[xs("Programme",()=>g("/client/core-buddy/workouts")),r.jsxs("main",{className:"pg-main",children:[r.jsxs("div",{className:"pg-dash-hero",children:[r.jsxs("div",{className:"pg-dash-ring-wrap",children:[r.jsxs("svg",{viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"pg-arc-track",cx:"100",cy:"100",r:"80"}),r.jsx("circle",{className:"pg-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-Qe/100*2*Math.PI*80})]}),r.jsxs("div",{className:"pg-ring-center",children:[r.jsxs("span",{className:"pg-ring-pct",children:[Qe,"%"]}),r.jsx("span",{className:"pg-ring-label",children:"complete"})]})]}),r.jsx("h2",{className:"pg-dash-name",children:ye.name}),r.jsxs("div",{className:"pg-dash-progress-text",children:[r.jsxs("span",{className:"pg-dash-pct",children:[Qe,"%"]}),r.jsxs("span",{className:"pg-dash-week",children:["Week ",Me.currentWeek," of ",ye.duration]})]})]}),r.jsx("div",{className:"pg-weeks",children:Array.from({length:ye.duration},(He,Xe)=>{const ut=Xe+1,J=Ft(ut);return r.jsxs("div",{className:`pg-week-row${ut===Me.currentWeek?" pg-week-current":""}`,children:[r.jsxs("span",{className:"pg-week-label",children:["W",ut]}),r.jsx("div",{className:"pg-week-days",children:ye.days.map((ne,$e)=>{const bt=`w${ut}d${$e}`,Ye=!!De[bt],vt=!Ye&&J,X=!Ye&&!vt&&ut===Me.currentWeek&&!Me.complete;return r.jsx("button",{className:`pg-day-dot${Ye?" done":""}${vt?" missed":""}${X?" next":""}`,disabled:!X,onClick:()=>{X&&us(ut,$e)},children:Ye?r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M20 6L9 17l-5-5"})}):vt?r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsx("span",{children:ne.name.replace("Day ","")})},$e)})})]},Xe)})}),!Me.complete&&(()=>{const He=ye.days.map((Xe,ut)=>({day:Xe,d:ut})).filter(({d:Xe})=>!De[`w${Me.currentWeek}d${Xe}`]);return He.length===0?null:r.jsxs("div",{className:"pg-next-session",children:[r.jsx("h3",{children:He.length===ye.daysPerWeek?"Choose a Session":"Remaining Sessions"}),r.jsxs("p",{className:"pg-next-info",children:["Week ",Me.currentWeek,"  ",He.length," session",He.length!==1?"s":""," left this week"]}),He.map(({day:Xe,d:ut})=>r.jsxs("div",{className:"pg-available-session",children:[r.jsxs("div",{className:"pg-next-exercises",children:[r.jsxs("span",{className:"pg-avail-day-label",children:[Xe.name,": ",Xe.label]}),Xe.exercises.map((J,ne)=>{const $e=uh(J,Me.currentWeek,ye);return r.jsxs("div",{className:"pg-next-ex",children:[r.jsx("span",{className:"pg-next-ex-name",children:J.name}),r.jsx("span",{className:"pg-next-ex-target",children:J.type==="timed"?`${$e.sets}${$e.time}s`:`${$e.sets}${$e.reps}`})]},ne)})]}),r.jsxs("button",{className:"pg-start-btn",onClick:()=>us(Me.currentWeek,ut),children:["Start ",Xe.name]})]},ut))]})})(),Me.complete&&r.jsxs("div",{className:"pg-complete-msg",children:[r.jsx("h3",{children:"Programme Complete! "}),r.jsxs("p",{children:["You finished all ",Me.totalSessions," sessions."]}),r.jsx("button",{className:"pg-start-btn",onClick:tt,children:"Choose New Programme"})]}),r.jsx("button",{className:"pg-quit-btn",onClick:()=>{confirm("Quit this programme? Progress will be lost.")&&tt()},children:"Quit Programme"})]}),r.jsx(ta,{active:"workouts"}),is]})})}if(x==="session"){const ye=Mt();if(!ye)return null;const Me=ye.days[Te],De=Me.exercises[R],Qe=uh(De,te,ye),He=I[R],Xe=He?.sets?.length||0,ut=Me.exercises.length,J=(R+Xe/Qe.sets)/ut,ne=ae[De.name],$e=At(te,Te,De.name);De.type==="timed"&&Re===0&&!se&&Xe===S&&setTimeout(()=>Q(Qe.time),0);const bt=()=>{ne?.isGif?Oe(!Ue):Ie.current&&(Ue?Ie.current.pause():Ie.current.play(),Oe(!Ue))};return r.jsxs("div",{className:"pg-page pg-page-session","data-theme":u?"dark":"light","data-accent":p,children:[r.jsx("div",{className:"pg-session-progress",children:r.jsx("div",{className:"pg-session-progress-fill",style:{width:`${J*100}%`}})}),r.jsxs("div",{className:"pg-session-header",children:[r.jsx("button",{className:"pg-session-back",onClick:()=>{confirm("Leave session? Progress will be lost.")&&_("dashboard")},children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M19 12H5M12 5l-7 7 7 7"})})}),r.jsxs("div",{className:"pg-session-title",children:[r.jsxs("span",{className:"pg-session-counter",children:[R+1," / ",ut]}),r.jsxs("span",{className:"pg-session-week",children:["Week ",te,"  ",Me.name]})]})]}),ne&&r.jsxs("div",{className:"pg-video-container",onClick:bt,children:[ne.isGif?r.jsx("img",{className:"pg-video",src:ne.url,alt:De.name}):r.jsx("video",{ref:Ie,className:"pg-video",src:ne.url,loop:!0,muted:!0,playsInline:!0},De.name),!Ue&&r.jsxs("div",{className:"pg-video-overlay",children:[r.jsx("svg",{className:"pg-play-icon",viewBox:"0 0 24 24",fill:"white",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),r.jsx("span",{className:"pg-video-hint",children:"Tap for demo"})]})]}),r.jsx("div",{className:"pg-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"pg-exercise-card",children:[r.jsx("h2",{className:"pg-ex-name",children:De.name}),r.jsx("span",{className:`pg-ex-type-badge pg-badge-${De.type}`,children:De.type==="weighted"?"Weight + Reps":De.type==="timed"?"Timed":"Reps Only"}),De.type==="weighted"&&$e&&r.jsxs("div",{className:"pg-last-week",children:[r.jsx("span",{className:"pg-last-week-label",children:"Last week:"}),r.jsxs("span",{className:"pg-last-week-value",children:[$e.weight,"kg x ",$e.reps," reps"]})]}),r.jsxs("div",{className:"pg-ex-set-info",children:[r.jsxs("span",{className:"pg-ex-set-num",children:["Set ",Xe+1," of ",Qe.sets]}),r.jsxs("span",{className:"pg-ex-target",children:["Target: ",De.type==="timed"?`${Qe.time}s hold`:`${Qe.reps} reps`]})]}),De.type==="weighted"&&r.jsxs("div",{className:"pg-input-area",children:[r.jsxs("div",{className:"pg-input-group",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",value:M,onChange:Ye=>ze(Ye.target.value),placeholder:"0",className:"pg-input"})]}),r.jsxs("div",{className:"pg-input-group",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",value:gt,onChange:Ye=>B(Ye.target.value),placeholder:String(Qe.reps),className:"pg-input"})]})]}),De.type==="reps"&&r.jsx("div",{className:"pg-input-area",children:r.jsxs("div",{className:"pg-input-group pg-input-single",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",value:gt,onChange:Ye=>B(Ye.target.value),placeholder:String(Qe.reps),className:"pg-input"})]})}),De.type==="timed"&&r.jsxs("div",{className:"pg-timer-area",children:[r.jsx("div",{className:"pg-timer-display",children:r.jsxs("span",{className:"pg-timer-value",children:[Re,"s"]})}),se?r.jsx("button",{className:"pg-timer-btn pg-timer-stop",onClick:()=>ge(!1),children:"Stop"}):r.jsx("button",{className:"pg-timer-btn",onClick:()=>{Re===0&&Q(Qe.time),ge(!0)},children:Re<Qe.time&&Re>0?"Resume":"Start Timer"})]}),r.jsx("button",{className:"pg-log-set-btn",onClick:vs,disabled:De.type==="timed"&&se,children:Xe+1<Qe.sets?"Log Set":R+1<ut?"Log Set  Next Exercise":"Log Set  Complete"}),He?.sets?.length>0&&r.jsx("div",{className:"pg-completed-sets",children:He.sets.map((Ye,vt)=>r.jsxs("div",{className:"pg-completed-set",children:[r.jsx("span",{className:"pg-completed-set-check",children:""}),r.jsxs("span",{children:["Set ",vt+1,": ",Ye.weight!==void 0?`${Ye.weight}kg  ${Ye.reps}`:Ye.time!==void 0?`${Ye.time}s`:`${Ye.reps} reps`]})]},vt))})]}),ee&&(()=>{const vt=Mt()?.days[Te],X=I.reduce((ht,Je)=>ht+Je.sets.length,0),Ae=I.reduce((ht,Je)=>ht+Je.sets.reduce((Kt,Ht)=>Kt+(Ht.weight||0)*(Ht.reps||0),0),0),Ge=[{value:I.length,label:"Exercises"},{value:X,label:"Sets"}];return Ae>0&&Ge.push({value:Math.round(Ae).toLocaleString(),label:"Volume (kg)"}),r.jsx(Jh,{title:"Session Complete!",subtitle:`Week ${te}  ${vt?.name}: ${vt?.label}`,stats:Ge,buttonLabel:"Back to Programme",hideShare:!l,onShareJourney:t?oe:null,userName:t?.name,onDismissStart:()=>_("dashboard"),onDone:()=>{Y(!1)}})})(),ot&&r.jsx("div",{className:"pg-badge-celebration",onClick:()=>yt(null),children:r.jsxs("div",{className:"pg-badge-celebration-card",onClick:Ye=>Ye.stopPropagation(),children:[r.jsx("div",{className:"pg-badge-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pg-badge-celebration-title",children:ot.badges.length===1?"Badge Earned!":`${ot.badges.length} Badges Earned!`}),r.jsx("div",{className:"pg-badge-celebration-list",children:ot.badges.map((Ye,vt)=>r.jsx("div",{className:"pg-badge-celebration-item",children:Ye.type==="pb_target"?`${Ye.exercise}  ${Ye.targetWeight}kg`:Ye.label},vt))}),r.jsxs("div",{className:"pg-badge-share-row",children:[r.jsxs("button",{className:"pg-badge-share-btn",onClick:async Ye=>{Ye.stopPropagation();const vt=ot.badges[0],X=ot.badges.map(Ge=>Ge.type==="pb_target"?`PB Target Hit: ${Ge.exercise}  ${Ge.targetWeight}kg`:Ge.label),Ae=Wn.find(Ge=>Ge.id===vt?.id)||Wn.find(Ge=>Ge.name===vt?.label);await oe({type:"badge_earned",title:X.length===1?X[0]:`${X.length} Badges Earned!`,badges:X,badgeDesc:Ae?.desc}),wt("Posted to Journey!","success")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20h9"}),r.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4Z"})]}),"Journey"]}),r.jsxs("button",{className:"pg-badge-share-btn",onClick:async Ye=>{Ye.stopPropagation();const vt=ot.badges[0],X=ot.badges.map(ht=>ht.type==="pb_target"?`PB Target Hit: ${ht.exercise}  ${ht.targetWeight}kg`:ht.label),Ae=Wn.find(ht=>ht.id===vt?.id)||Wn.find(ht=>ht.name===vt?.label),Ge=`Badge Earned! ${X.join(", ")}
#MindCoreFitness`;try{const ht=await tb({type:"badge",title:X.length===1?X[0]:"Badges Earned!",badges:X,badgeImage:Ae?.img,badgeDesc:Ae?.desc});navigator.share&&navigator.canShare?.({files:[new File([ht],"badge.png",{type:"image/png"})]})?await navigator.share({title:"Mind Core Fitness",text:Ge,files:[new File([ht],"badge.png",{type:"image/png"})]}):navigator.share?await navigator.share({title:"Mind Core Fitness",text:Ge}):(await navigator.clipboard.writeText(Ge),wt("Copied!","success"))}catch{try{await navigator.clipboard.writeText(Ge),wt("Copied!","success")}catch{}}},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"18",cy:"5",r:"3"}),r.jsx("circle",{cx:"6",cy:"12",r:"3"}),r.jsx("circle",{cx:"18",cy:"19",r:"3"}),r.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),r.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),"Share"]})]}),r.jsx("button",{className:"pg-badge-celebration-dismiss",onClick:()=>yt(null),children:"Tap to dismiss"})]})}),is]})}return null}const w6={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},_6={push:{label:"Push",color:"#c75f6b",icon:"M4 12h3l3-9 4 18 3-9h3"},pull:{label:"Pull",color:"#5f8ac7",icon:"M12 2v10m0 0l-4-4m4 4l4-4M4 20h16"},lower:{label:"Lower",color:"#5fc77a",icon:"M12 2v8m-4 4l4 8 4-8m-8 0h8"},core:{label:"Core",color:"#c7a45f",icon:"M12 2a4 4 0 014 4v1h-2V6a2 2 0 10-4 0v1H8V6a4 4 0 014-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"}},Jp=[{threshold:1e3,label:"1 Tonne",icon:"1T"},{threshold:5e3,label:"5 Tonne",icon:"5T"},{threshold:1e4,label:"10 Tonne",icon:"10T"},{threshold:25e3,label:"25 Tonne",icon:"25T"},{threshold:5e4,label:"50 Tonne",icon:"50T"},{threshold:1e5,label:"100 Tonne",icon:"100T"},{threshold:25e4,label:"250 Tonne",icon:"250T"},{threshold:5e5,label:"500 Tonne",icon:"500T"},{threshold:1e6,label:"1 Million kg",icon:"1M"}];function k6(n){return w6[n]||"push"}function j6(n){return n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}T`:`${Math.round(n)}`}function T6(n){return n>=1e6?"million kg":n>=1e3?"tonnes":"kg"}function E6(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Rr(),{isDark:l,toggleTheme:u,accent:d}=Ia(),p=Zn(),[g,y]=b.useState(!0),[x,_]=b.useState(null),[j,O]=b.useState({}),[$,V]=b.useState([]),[L,ee]=b.useState(null),[Y,te]=b.useState(0),[ke,Te]=b.useState({});b.useRef(null),b.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),b.useEffect(()=>{if(!t)return;(async()=>{try{const[se,ge,Re,Q]=await Promise.all([Os(We(pe,"coreBuddyAchievements",t.id)),Os(We(pe,"coreBuddyPBs",t.id)),Os(We(pe,"achievements",t.id)),Is(Fs($t(pe,"workoutLogs"),bs("clientId","==",t.id)))]);se.exists()&&_(se.data()),ge.exists()&&O(ge.data().exercises||{}),Re.exists()&&(V(Object.keys(Re.data().badges||{})),Te(Re.data().progress||{})),te(Q.docs.length)}catch(se){console.error("Error loading achievements:",se)}y(!1)})()},[t]);const xe=x?.badges||[],R=x?.totalVolume||0,T=xe.filter(B=>B.type==="pb_target"),S=xe.filter(B=>B.type==="volume_milestone"),D={push:[],pull:[],lower:[],core:[]};T.forEach(B=>{const se=B.group||k6(B.exercise);D[se]&&D[se].push(B)});const I=Jp.find(B=>R<B.threshold),U=Jp.filter(B=>R>=B.threshold).pop()?.threshold||0,M=I?(R-U)/(I.threshold-U):1;if(i||g)return r.jsxs("div",{className:"ach-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsx("div",{className:"ach-loading-inline",children:r.jsx("div",{className:"cb-loading-spinner"})})]});const ze=xe.length+$.length,gt=ze>0||R>0||Y>0;return r.jsx(ga,{children:r.jsxs("div",{className:"ach-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"ach-main",children:[r.jsx("button",{className:"nut-back-btn",onClick:()=>p("/client/personal-bests?mode=corebuddy"),children:" Back"}),r.jsxs("div",{className:"ach-stats-banner",children:[r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:ze}),r.jsx("span",{className:"ach-stat-label",children:ze===1?"Badge":"Badges"})]}),r.jsx("div",{className:"ach-stat-divider"}),r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:j6(R)}),r.jsxs("span",{className:"ach-stat-label",children:[T6(R)," lifted"]})]}),r.jsx("div",{className:"ach-stat-divider"}),r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:Object.keys(j).length}),r.jsx("span",{className:"ach-stat-label",children:"PBs"})]})]}),!gt&&r.jsxs("div",{className:"ach-empty",children:[r.jsx("div",{className:"ach-empty-icon",children:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[r.jsx("path",{d:"M12 15l-3-3h6l-3 3z"}),r.jsx("path",{d:"M5 7h14l-1.5 9h-11L5 7z"}),r.jsx("path",{d:"M8.5 7V5a3.5 3.5 0 017 0v2"})]})}),r.jsx("h4",{children:"No achievements yet"}),r.jsx("p",{children:"Complete workouts to track volume and set PB targets to start earning badges."})]}),[{key:"workouts",title:"Workout Badges",iconPath:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"},{key:"streaks",title:"Streak Badges",iconPath:"M13.5.67s.74 2.65.74 4.8c0 2.06-1.35 3.73-3.41 3.73-2.07 0-3.63-1.67-3.63-3.73l.03-.36C5.21 7.51 4 10.62 4 14c0 4.42 3.58 8 8 8s8-3.58 8-8C20 8.61 17.41 3.8 13.5.67z"},{key:"pbs",title:"Personal Best Badges",iconPath:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"},{key:"nutrition",title:"Nutrition Badges",iconPath:"M18.06 23h1.66c.84 0 1.53-.65 1.63-1.47L23 5.05h-5V1h-2v4.05h-5l.3 2.34c1.71.47 3.31 1.32 4.27 2.26 1.44 1.42 2.43 2.89 2.43 5.29V23zM1 22v-1h15.03v1c0 .55-.45 1-1.01 1H2.01c-.56 0-1.01-.45-1.01-1zm15.03-7c0-4.87-4.66-5.84-8.03-5.97l.72 5.52L1 15.05v5.95h15.03V15z"},{key:"habits",title:"Habit Badges",iconPath:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"},{key:"leaderboard",title:"Leaderboard Badges",iconPath:"M7.5 21H2V9h5.5v12zm7.25-18h-5.5v18h5.5V3zM22 11h-5.5v10H22V11z"}].map(B=>{const se=Wn.filter(Q=>Q.category===B.key);if(se.length===0)return null;const ge=(()=>{switch(B.key){case"workouts":return Y;case"streaks":return ke.streakWeeks||0;case"pbs":return Object.keys(j).length;case"nutrition":return ke.nutritionStreak||0;case"leaderboard":return t?.leaderboardOptIn?1:0;case"habits":return ke.habitStreak||0;default:return 0}})(),Re=se.filter(Q=>$.includes(Q.id)).length;return r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:B.iconPath})}),B.title]}),r.jsx("div",{className:"ach-workout-carousel",children:se.map(Q=>{const P=$.includes(Q.id);return r.jsxs("button",{className:`ach-workout-badge${P?" unlocked":" locked"}`,onClick:()=>ee(Q),children:[r.jsx("img",{src:Q.img,alt:Q.name,className:"ach-workout-badge-img"}),!P&&Q.threshold&&r.jsx("div",{className:"ach-workout-badge-progress",children:r.jsx("div",{className:"ach-workout-badge-progress-fill",style:{width:`${Math.min(ge/Q.threshold*100,100)}%`}})})]},Q.id)})}),r.jsxs("p",{className:"ach-workout-badges-count",children:[Re,"/",se.length," unlocked"]})]},B.key)}),L&&r.jsx("div",{className:"ach-badge-overlay",onClick:()=>ee(null),children:r.jsxs("div",{className:"ach-badge-overlay-content",onClick:B=>B.stopPropagation(),children:[r.jsx("img",{src:L.img,alt:L.name,className:`ach-badge-overlay-img${$.includes(L.id)?"":" ach-badge-overlay-img-locked"}`}),r.jsx("p",{className:"ach-badge-overlay-desc",children:L.desc}),$.includes(L.id)?r.jsx("span",{className:"ach-badge-overlay-status unlocked",children:"Unlocked"}):r.jsx("span",{className:"ach-badge-overlay-status locked",children:"Locked"}),r.jsx("button",{className:"ach-badge-overlay-close",onClick:()=>ee(null),children:"Tap to close"})]})}),r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})}),"Volume Milestones"]}),r.jsxs("div",{className:"ach-volume-hero",children:[r.jsxs("div",{className:"ach-volume-ring",children:[r.jsx("svg",{className:"ach-volume-ring-svg",viewBox:"0 0 200 200",children:Kk.map((B,se)=>{const ge=se<Math.round(M*60);return r.jsx("line",{x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,className:ge?"ach-tick-filled":"ach-tick-empty",strokeWidth:B.thick?"3":"2"},se)})}),r.jsxs("div",{className:"ach-volume-center",children:[r.jsx("span",{className:"ach-volume-number",children:Math.round(R).toLocaleString()}),r.jsx("span",{className:"ach-volume-unit",children:"kg lifted"})]})]}),I&&r.jsxs("div",{className:"ach-volume-next",children:["Next: ",r.jsx("strong",{children:I.label})," (",(I.threshold-R).toLocaleString(),"kg to go)"]})]}),r.jsx("div",{className:"ach-milestone-shelf",children:Jp.map((B,se)=>{const ge=R>=B.threshold,Re=S.find(Q=>Q.milestone===B.threshold);return r.jsxs("div",{className:`ach-milestone ${ge?"unlocked":"locked"}`,children:[r.jsx("div",{className:"ach-milestone-hex",children:r.jsx("span",{className:"ach-milestone-icon",children:B.icon})}),r.jsx("span",{className:"ach-milestone-label",children:B.label}),Re?.achievedAt&&r.jsx("span",{className:"ach-milestone-date",children:(Re.achievedAt.toDate?Re.achievedAt.toDate():new Date(Re.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short"})})]},se)})})]}),r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"PB Target Badges"]}),T.length===0?r.jsx("div",{className:"ach-pb-empty",children:r.jsxs("p",{children:["Set targets on your personal bests to start earning badges. Go to ",r.jsx("strong",{children:"My Progress"}),' and tap "Set Target" on any PB.']})}):Object.entries(D).map(([B,se])=>{if(se.length===0)return null;const ge=_6[B];return r.jsxs("div",{className:"ach-group",children:[r.jsxs("div",{className:"ach-group-header",style:{borderLeftColor:ge.color},children:[r.jsx("span",{className:"ach-group-label",style:{color:ge.color},children:ge.label}),r.jsx("span",{className:"ach-group-count",children:se.length})]}),r.jsx("div",{className:"ach-badge-grid",children:se.map((Re,Q)=>r.jsxs("div",{className:"ach-badge-card",style:{animationDelay:`${Q*.06}s`,"--group-color":ge.color},children:[r.jsx("div",{className:"ach-badge-hex",style:{borderColor:ge.color,boxShadow:`0 0 12px ${ge.color}33`},children:r.jsx("svg",{className:"ach-badge-hex-icon",viewBox:"0 0 24 24",fill:"none",stroke:ge.color,strokeWidth:"2",strokeLinecap:"round",children:r.jsx("path",{d:ge.icon})})}),r.jsxs("div",{className:"ach-badge-info",children:[r.jsx("span",{className:"ach-badge-exercise",children:Re.exercise}),r.jsxs("span",{className:"ach-badge-value",style:{color:ge.color},children:[Re.targetWeight,"kg"]}),Re.achievedAt&&r.jsx("span",{className:"ach-badge-date",children:(Re.achievedAt.toDate?Re.achievedAt.toDate():new Date(Re.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})})]})]},Q))})]},B)})]})]}),r.jsx(ta,{active:"home"})]})})}const N6=[{key:"trained",label:"Trained",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4",color:"#A12F3A",darkColor:"#E8475A"},{key:"protein",label:"Hit Protein",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z",color:"#4caf50",darkColor:"#5CDB61"},{key:"steps",label:"10k Steps",icon:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20M4 12.5A2.5 2.5 0 0 1 6.5 10H20M4 5.5A2.5 2.5 0 0 1 6.5 3H20",color:"#ff9800",darkColor:"#FFB020"},{key:"sleep",label:"8hrs Sleep",icon:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z",color:"#7c3aed",darkColor:"#9B5AF2"},{key:"water",label:"2L Water",icon:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z",color:"#2196f3",darkColor:"#42A5F5"}],S6="M12 2l2.4 7.2L22 12l-7.6 2.8L12 22l-2.4-7.2L2 12l7.6-2.8z",C6="#e91e63",R6="#FF4D88",A6=700,Pg=42,Fl=2*Math.PI*Pg,dh=["Every day counts. See you tomorrow!","Consistency is your superpower.","Perfect day  keep the streak alive!","You showed up for yourself today."];function I6(n){const e=new Date(n),t=e.getDay(),i=t===0?-6:1-t;return e.setDate(e.getDate()+i),e.setHours(0,0,0,0),e}function zo(n){return n.toISOString().split("T")[0]}function M6(n){return Array.from({length:7},(e,t)=>{const i=new Date(n);return i.setDate(n.getDate()+t),i})}function D6(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Rr(),{isDark:l,toggleTheme:u,accent:d}=Ia(),{isPremium:p,FREE_HABIT_LIMIT:g}=pc(),y=Zn(),[x,_]=b.useState({}),[j,O]=b.useState([]),[$,V]=b.useState(!0),[L,ee]=b.useState(!1),[Y,te]=b.useState(0),[ke,Te]=b.useState(null),[xe,R]=b.useState(null),[T,S]=b.useState(!1),[D,I]=b.useState(!1),[U,M]=b.useState(!1),[ze,gt]=b.useState(!1),[B,se]=b.useState(""),[ge,Re]=b.useState(null),[Q,P]=b.useState([]),[ae,Be]=b.useState(null),Ue=b.useRef(null),Oe=b.useRef(null),Ie=b.useRef(null),ot=b.useRef(null),yt=b.useRef(!1),et=b.useRef({}),Xt=b.useRef([]),Es=b.useRef([]),Ot=b.useRef(null),wt=b.useRef(dh[Math.floor(Math.random()*dh.length)]),oe=b.useCallback((X,Ae="info")=>{Te({message:X,type:Ae}),setTimeout(()=>Te(null),3e3)},[]),Ct=new Date,kt=zo(Ct),zt=I6(Ct),Et=M6(zt),jt=["M","T","W","T","F","S","S"],tt=(X,Ae)=>l&&Ae?Ae:X,Mt=[...N6.filter(X=>!Q.includes(X.key)).map(X=>({...X,color:tt(X.color,X.darkColor)})),...j.map(X=>({key:`custom_${X.id}`,label:X.label,icon:S6,color:tt(C6,R6),isCustom:!0,id:X.id}))],qt=p?Mt:Mt.slice(0,g);b.useEffect(()=>{!i&&(!n||!e)&&y("/")},[n,e,i,y]),b.useEffect(()=>{if(!n||!t)return;(async()=>{try{const Ae=$t(pe,"habitLogs"),Ge=Fs(Ae,bs("clientId","==",t.id)),ht=await Is(Ge),Je={};ht.docs.forEach(fe=>{const Se=fe.data();Je[Se.date]={...Se,_id:fe.id}}),_(Je);const Kt=await Os(We(pe,"customHabits",t.id));if(Kt.exists()){const fe=Kt.data();O(fe.habits||[]),P(fe.hiddenDefaults||[])}let Ht=0;const F=new Date(Ct);for(;;){const fe=zo(F),Se=Je[fe];if(Se)if(Object.values(Se.habits||{}).filter(Boolean).length>=3)Ht++,F.setDate(F.getDate()-1);else break;else if(fe===kt)F.setDate(F.getDate()-1);else break}te(Ht)}catch(Ae){console.error("Error loading habit logs:",Ae)}finally{V(!1)}})()},[n,t]);const ms=x[kt]||{habits:{}};b.useEffect(()=>{Object.values(ms.habits||{}).filter(Boolean).length<qt.length&&U&&M(!1)},[qt.length,ms.habits]);const Ft=async X=>{if(!(!n||L||ms.habits?.[X])){Xt.current=[...Array(10)].map((Ge,ht)=>{const Je=ht/10*2*Math.PI,Kt=18+Math.random()*20;return{tx:Math.cos(Je)*Kt,ty:Math.sin(Je)*Kt,size:3+Math.random()*4,duration:.4+Math.random()*.3}}),R(X),setTimeout(()=>R(null),700),navigator.vibrate&&navigator.vibrate(50),ee(!0);try{const ht={...ms.habits||{},[X]:!0},Je=ms._id||`${t.id}_${kt}`;_(Ht=>({...Ht,[kt]:{clientId:t.id,date:kt,habits:ht,_id:Je}})),await Ms(We(pe,"habitLogs",Je),{clientId:t.id,date:kt,habits:ht}),Object.values(ht).filter(Boolean).length===qt.length&&!U&&(wt.current=dh[Math.floor(Math.random()*dh.length)],Es.current=[...Array(80)].map((Ht,F)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#4caf50","#ff9800","#2196f3","#e91e63","#ffeb3b","#FFD700","#ffffff","#9c27b0"][F%9],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:F%3})),setTimeout(()=>{S(!0),M(!0),setTimeout(()=>Ot.current?.focus(),1100)},400))}catch(Ge){console.error("Error saving habit:",Ge),oe("Failed to save. Try again.","error"),_(ht=>({...ht,[kt]:{...ht[kt],habits:{...ht[kt]?.habits||{},[X]:!1}}}))}finally{ee(!1)}}},At=async X=>{if(!(!n||L)){ee(!0);try{const Ge={...ms.habits||{},[X]:!1},ht=ms._id||`${t.id}_${kt}`;await Ms(We(pe,"habitLogs",ht),{clientId:t.id,date:kt,habits:Ge}),_(Je=>({...Je,[kt]:{clientId:t.id,date:kt,habits:Ge,_id:ht}}))}catch(Ae){console.error("Error undoing habit:",Ae),oe("Failed to undo. Try again.","error")}finally{ee(!1)}}},us=X=>{if(ms.habits?.[X]||!1||L||ot.current)return;ot.current=X,Be(X),Oe.current=performance.now();const Ge=et.current[X];Ge&&(Ge.style.strokeDashoffset=Fl);const ht=Je=>{const Kt=Je-Oe.current,Ht=Math.min(Kt/A6,1),F=et.current[X];F&&(F.style.strokeDashoffset=Fl-Ht*Fl),Ht<1?Ie.current=requestAnimationFrame(ht):(ot.current=null,yt.current=!0,Ie.current=null,Be(null),Ft(X))};Ie.current=requestAnimationFrame(ht)},vs=()=>{if(!ot.current)return;const X=ot.current;ot.current=null,Ie.current&&(cancelAnimationFrame(Ie.current),Ie.current=null),Ue.current&&(clearTimeout(Ue.current),Ue.current=null),et.current[X]&&(et.current[X].style.strokeDashoffset=Fl),Be(null),Oe.current=null};b.useEffect(()=>()=>{Ie.current&&cancelAnimationFrame(Ie.current),Ue.current&&clearTimeout(Ue.current)},[]);const as=b.useCallback(async X=>{if(!t)throw new Error("Not signed in");const Ae=X&&typeof X=="object"&&X.type;await fa($t(pe,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Ae?"":X,type:Ae?X.type:"text",imageURL:null,createdAt:vr(),likeCount:0,commentCount:0,...Ae?{metadata:{title:X.title||"",subtitle:X.subtitle||"",stats:X.stats||[],quote:X.quote||"",badges:X.badges||[]}}:{}})},[t]),nn=async()=>{const X=B.trim();if(!X)return;if(!t?.id){oe("Still loading, try again","error");return}const Ae=Date.now().toString(36),Ge=[...j,{id:Ae,label:X}];try{await Ms(We(pe,"customHabits",t.id),{clientId:t.id,habits:Ge,hiddenDefaults:Q},{merge:!0}),O(Ge),se(""),gt(!1),oe(`Added "${X}"`,"success")}catch(ht){console.error("Error adding custom habit:",ht),oe(ht?.code==="permission-denied"?"Permission denied  check Firestore rules for customHabits":`Failed to add habit: ${ht?.message||"Unknown error"}`,"error")}},Ds=async X=>{if(!t?.id)return;const Ae=j.filter(Ge=>Ge.id!==X);try{await Ms(We(pe,"customHabits",t.id),{clientId:t.id,habits:Ae,hiddenDefaults:Q},{merge:!0}),O(Ae),Re(null),oe("Habit removed","success")}catch(Ge){console.error("Error deleting habit:",Ge),oe("Failed to remove","error")}},Hs=async X=>{if(!t?.id)return;const Ae=[...Q,X];try{await Ms(We(pe,"customHabits",t.id),{clientId:t.id,habits:j,hiddenDefaults:Ae},{merge:!0}),P(Ae),Re(null),oe("Habit removed","success")}catch(Ge){console.error("Error hiding default habit:",Ge),oe("Failed to remove","error")}},is=Et.map(X=>{const Ae=zo(X),Ge=x[Ae],ht=Ge?Object.values(Ge.habits||{}).filter(Boolean).length:0;return{date:X,dateStr:Ae,completed:ht,total:qt.length}}),xs=is.reduce((X,Ae)=>X+Ae.completed,0),ye=is.reduce((X,Ae)=>X+Ae.total,0),Me=ye>0?Math.round(xs/ye*100):0,De=Object.values(ms.habits||{}).filter(Boolean).length,Qe=qt.length>0?Math.round(De/qt.length*100):0,He=De===qt.length&&qt.length>0,Xe=(()=>{const X=Object.keys(x).sort();let Ae=0,Ge=0,ht=null;for(const Je of X){const Kt=x[Je];if(Object.values(Kt.habits||{}).filter(Boolean).length>=3){if(ht){const F=new Date(ht);Ge=(new Date(Je)-F)/(1e3*60*60*24)===1?Ge+1:1}else Ge=1;Ge>Ae&&(Ae=Ge),ht=Je}else Ge=0,ht=null}return Math.max(Ae,Y)})(),ut=new Date(Ct.getFullYear(),Ct.getMonth(),1),J=ut.toLocaleString("default",{month:"long"}),ne=new Date(Ct.getFullYear(),Ct.getMonth()+1,0).getDate(),$e=(ut.getDay()+6)%7,bt=Array.from({length:ne},(X,Ae)=>{const Ge=new Date(Ct.getFullYear(),Ct.getMonth(),Ae+1),ht=zo(Ge),Je=x[ht],Kt=Je?Object.values(Je.habits||{}).filter(Boolean).length:0,Ht=Ge>Ct;return{day:Ae+1,dateStr:ht,completed:Kt,total:qt.length,isFuture:Ht,isToday:ht===kt}}),Ye=qt.map(X=>({...X,days:Et.map(Ae=>{const Ge=zo(Ae);return x[Ge]?.habits?.[X.key]||!1})})),vt=is.filter(X=>X.completed===X.total&&X.total>0).length;return r.jsx(ga,{children:r.jsxs("div",{className:"cbc-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>y("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),i||$?r.jsx("div",{className:"cbc-loading-inline",children:r.jsx("div",{className:"cbc-loading-spinner"})}):r.jsxs("main",{className:"cbc-main",children:[r.jsxs("div",{className:"cbc-hero anim-fade-up",children:[r.jsxs("div",{className:`cbc-progress-ring${He?" cbc-ring-complete":""}`,children:[r.jsxs("svg",{viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"cbc-arc-track",cx:"100",cy:"100",r:"80"}),r.jsx("circle",{className:"cbc-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-Qe/100*2*Math.PI*80})]}),r.jsxs("div",{className:"cbc-ring-center",children:[r.jsxs("span",{className:"cbc-ring-count",children:[De,r.jsx("span",{className:"cbc-ring-divider",children:"/"}),qt.length]}),r.jsx("span",{className:"cbc-ring-label",children:He?"complete":"today"})]})]}),r.jsx("p",{className:"cbc-hero-tagline",children:He?"You showed up for yourself today.":De===0?"Start your day strong.":`${qt.length-De} to go  keep pushing.`})]}),r.jsxs("div",{className:"cbc-streak-card anim-fade-up-d1",children:[r.jsx("div",{className:"cbc-streak-icon",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})})}),r.jsxs("div",{className:"cbc-streak-info",children:[r.jsx("span",{className:"cbc-streak-count",children:Y}),r.jsx("span",{className:"cbc-streak-label",children:"day streak"})]}),r.jsxs("div",{className:"cbc-streak-best",children:[r.jsx("span",{className:"cbc-streak-best-val",children:Xe}),r.jsx("span",{className:"cbc-streak-best-label",children:"best"})]})]}),r.jsxs("div",{className:"cbc-section anim-fade-up-d2",children:[r.jsx("h2",{className:"cbc-section-title",children:"Today's Habits"}),r.jsxs("div",{className:"cbc-habits-grid",children:[qt.map(X=>{const Ae=ms.habits?.[X.key]||!1,Ge=xe===X.key,ht=ae===X.key;return r.jsxs("div",{className:`cbc-habit-tile ${Ae?"cbc-habit-done":""} ${Ge?"cbc-habit-just-checked":""}`,style:{"--habit-color":X.color},children:[p&&r.jsx("button",{className:"cbc-habit-delete",onClick:Je=>{Je.stopPropagation(),Re(X.isCustom?{type:"custom",id:X.id,label:X.label}:{type:"default",key:X.key,label:X.label})},"aria-label":`Remove ${X.label}`,children:r.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),r.jsxs("div",{className:`cbc-habit-ring-touch ${ht?"cbc-holding":""} ${Ae?"cbc-ring-completed":""}`,onPointerDown:Je=>{Ae||(Je.preventDefault(),us(X.key))},onPointerUp:vs,onPointerLeave:vs,onPointerCancel:vs,onClick:Je=>{if(Je.stopPropagation(),yt.current){yt.current=!1;return}Ae&&At(X.key)},role:"button",tabIndex:0,"aria-label":Ae?`Undo ${X.label}`:`Press and hold to complete ${X.label}`,onKeyDown:Je=>{(Je.key==="Enter"||Je.key===" ")&&(Je.preventDefault(),Ae?At(X.key):Ft(X.key))},children:[r.jsxs("svg",{className:"cbc-habit-ring-svg",viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cbc-habit-ring-track",cx:"50",cy:"50",r:Pg}),r.jsx("circle",{className:"cbc-habit-ring-fill",ref:Je=>{Je&&(et.current[X.key]=Je)},cx:"50",cy:"50",r:Pg,style:{stroke:X.color,strokeDasharray:Fl,strokeDashoffset:Ae?0:Fl}})]}),Ae&&r.jsx("div",{className:"cbc-habit-glow-orb",style:{"--habit-color":X.color}}),r.jsx("div",{className:"cbc-habit-ring-icon",style:{color:X.color},children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:X.icon})})}),Ge&&r.jsx("div",{className:"cbc-particles",children:Xt.current.map((Je,Kt)=>r.jsx("span",{className:"cbc-particle",style:{"--tx":`${Je.tx}px`,"--ty":`${Je.ty}px`,"--size":`${Je.size}px`,"--particle-color":X.color,animationDuration:`${Je.duration}s`}},Kt))})]}),r.jsx("span",{className:"cbc-habit-label",children:X.label}),Ae?r.jsx("span",{className:"cbc-habit-done-tag",children:"Done"}):r.jsx("span",{className:"cbc-habit-hold-hint",children:"Hold to complete"})]},X.key)}),p?r.jsxs("div",{className:"cbc-habit-tile cbc-add-tile",onClick:()=>gt(!0),role:"button",tabIndex:0,children:[r.jsx("div",{className:"cbc-add-ring",children:r.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})}),r.jsx("span",{className:"cbc-habit-label",children:"Add Habit"}),r.jsx("span",{className:"cbc-habit-hold-hint",children:"Your own"})]}):r.jsxs("div",{className:"cbc-habit-tile cbc-unlock-tile",onClick:()=>y("/upgrade"),role:"button",tabIndex:0,children:[r.jsx("div",{className:"cbc-unlock-ring",children:r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),r.jsx("span",{className:"cbc-habit-label",children:"More Habits"}),r.jsx("span",{className:"cbc-habit-hold-hint",children:"Custom & editable"})]})]})]}),r.jsxs("div",{className:"cbc-section anim-fade-up-d3",children:[r.jsxs("div",{className:"cbc-section-header",children:[r.jsx("h2",{className:"cbc-section-title",children:"This Week"}),r.jsxs("span",{className:"cbc-section-badge",children:[vt,"/7 perfect"]})]}),r.jsxs("div",{className:"cbc-weekly-card",children:[r.jsxs("div",{className:"cbc-weekly-header",children:[r.jsx("span",{className:"cbc-weekly-habit-name"}),jt.map((X,Ae)=>r.jsx("span",{className:`cbc-weekly-day-label${Et[Ae]&&zo(Et[Ae])===kt?" cbc-today-label":""}`,children:X},Ae))]}),Ye.map(X=>(X.days.filter(Boolean).length,r.jsxs("div",{className:"cbc-weekly-row",children:[r.jsx("span",{className:"cbc-weekly-habit-name",style:{color:X.color},children:X.label}),X.days.map((Ae,Ge)=>r.jsx("span",{className:`cbc-weekly-dot${Ae?" cbc-dot-done":""}${Et[Ge]&&zo(Et[Ge])===kt?" cbc-dot-today":""}`,style:Ae?{background:X.color,borderColor:X.color,boxShadow:`0 0 6px ${X.color}40`}:void 0},Ge))]},X.key))),r.jsxs("div",{className:"cbc-week-summary",children:[r.jsx("div",{className:"cbc-week-summary-bar",children:r.jsx("div",{className:"cbc-week-summary-fill",style:{width:`${Me}%`}})}),r.jsxs("span",{className:"cbc-week-summary-text",children:[xs,"/",ye," completed (",Me,"%)"]})]})]})]}),r.jsxs("div",{className:"cbc-section anim-fade-up-d4",children:[r.jsx("h2",{className:"cbc-section-title",children:J}),r.jsxs("div",{className:"cbc-calendar-card",children:[r.jsx("div",{className:"cbc-cal-header",children:["M","T","W","T","F","S","S"].map((X,Ae)=>r.jsx("span",{className:"cbc-cal-day-label",children:X},Ae))}),r.jsxs("div",{className:"cbc-cal-grid",children:[Array.from({length:$e},(X,Ae)=>r.jsx("span",{className:"cbc-cal-cell cbc-cal-empty"},`e${Ae}`)),bt.map(X=>{const Ae=X.total>0?X.completed/X.total:0,Ge=X.isFuture?-1:Ae===0?0:Ae<.4?1:Ae<.75?2:Ae<1?3:4;return r.jsx("span",{className:`cbc-cal-cell${X.isToday?" cbc-cal-today":""}${Ge===4?" cbc-cal-perfect":""} cbc-cal-heat-${Ge<0?"future":Ge}`,children:X.day},X.day)})]}),r.jsxs("div",{className:"cbc-cal-legend",children:[r.jsx("span",{className:"cbc-cal-legend-label",children:"Less"}),r.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-0"}),r.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-1"}),r.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-2"}),r.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-3"}),r.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-4"}),r.jsx("span",{className:"cbc-cal-legend-label",children:"More"})]})]})]})]}),r.jsx(ta,{active:"home"}),ze&&r.jsx("div",{className:"cbc-modal-overlay",onClick:()=>gt(!1),children:r.jsxs("div",{className:"cbc-modal",onClick:X=>X.stopPropagation(),children:[r.jsx("h3",{className:"cbc-modal-title",children:"Add Habit"}),r.jsx("p",{className:"cbc-modal-desc",children:"Track something personal to your routine."}),r.jsx("input",{className:"cbc-modal-input",type:"text",placeholder:"e.g. Meditate, Stretch, Read...",value:B,onChange:X=>se(X.target.value),maxLength:30,autoFocus:!0,onKeyDown:X=>X.key==="Enter"&&nn()}),r.jsxs("div",{className:"cbc-modal-actions",children:[r.jsx("button",{className:"cbc-modal-cancel",onClick:()=>{gt(!1),se("")},children:"Cancel"}),r.jsx("button",{className:"cbc-modal-save",onClick:nn,disabled:!B.trim(),children:"Add"})]})]})}),ge&&r.jsx("div",{className:"cbc-modal-overlay",onClick:()=>Re(null),children:r.jsxs("div",{className:"cbc-modal",onClick:X=>X.stopPropagation(),children:[r.jsxs("h3",{className:"cbc-modal-title",children:['Remove "',ge.label,'"?']}),r.jsx("p",{className:"cbc-modal-desc",children:"This will remove the habit from your daily tracker. Past logs won't be affected."}),r.jsxs("div",{className:"cbc-modal-actions",children:[r.jsx("button",{className:"cbc-modal-cancel",onClick:()=>Re(null),children:"Keep"}),r.jsx("button",{className:"cbc-modal-delete",onClick:()=>ge.type==="custom"?Ds(ge.id):Hs(ge.key),children:"Remove"})]})]})}),T&&r.jsx(Jh,{title:"All Habits Complete!",subtitle:wt.current,stats:[{value:`${De}/${qt.length}`,label:"Habits"},{value:Y||1,label:"Day Streak"}],buttonLabel:"Keep Going",holdLabel:"Hold To Complete Today's Habits",shareType:"habits",hideShare:!p,onShareJourney:t?as:null,userName:t?.name,onDone:()=>{S(!1),I(!1)}}),ke&&r.jsx("div",{className:`toast-notification ${ke.type}`,children:ke.message})]})})}function hh(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function D2(n,e){return[n,e].sort().join("_")}function P6(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Rr(),{isDark:l,toggleTheme:u}=Ia(),d=Zn(),[p,g]=b.useState("buddies"),[y,x]=b.useState([]),[_,j]=b.useState([]),[O,$]=b.useState([]),[V,L]=b.useState(""),[ee,Y]=b.useState([]),[te,ke]=b.useState([]),[Te,xe]=b.useState(!0),[R,T]=b.useState(null),[S,D]=b.useState(null),I=b.useCallback((Q,P="info")=>{D({message:Q,type:P}),setTimeout(()=>D(null),3500)},[]);b.useEffect(()=>{!i&&(!n||!e)&&d("/")},[n,e,i,d]);const U=b.useCallback(async()=>{if(t){xe(!0);try{const Q=t.id,ae=(await Is($t(pe,"clients"))).docs.map(et=>({id:et.id,...et.data()}));ke(ae);const Be=Object.fromEntries(ae.map(et=>[et.id,et])),Ue=await Is(Fs($t(pe,"buddies"),bs("user1","==",Q))),Oe=await Is(Fs($t(pe,"buddies"),bs("user2","==",Q))),Ie=new Set;[...Ue.docs,...Oe.docs].forEach(et=>{const Xt=et.data(),Es=Xt.user1===Q?Xt.user2:Xt.user1;Ie.add(Es)}),x(Array.from(Ie).map(et=>Be[et]).filter(Boolean));const ot=await Is(Fs($t(pe,"buddyRequests"),bs("toId","==",Q),bs("status","==","pending")));j(ot.docs.map(et=>({reqId:et.id,...et.data(),fromClient:Be[et.data().fromId]})).filter(et=>et.fromClient));const yt=await Is(Fs($t(pe,"buddyRequests"),bs("fromId","==",Q),bs("status","==","pending")));$(yt.docs.map(et=>({reqId:et.id,...et.data(),toClient:Be[et.data().toId]})).filter(et=>et.toClient))}catch(Q){console.error("Error fetching buddy data:",Q),I("Failed to load buddies","error")}finally{xe(!1)}}},[t,I]);b.useEffect(()=>{U()},[U]),b.useEffect(()=>{if(!V.trim()||!t){Y([]);return}const Q=V.toLowerCase(),P=t.id,ae=new Set(y.map(Ie=>Ie.id)),Be=new Set(O.map(Ie=>Ie.toId)),Ue=new Set(_.map(Ie=>Ie.fromId)),Oe=te.filter(Ie=>Ie.id===P||!Ie.name||!Ie.coreBuddyAccess&&Ie.clientType!=="core_buddy"?!1:Ie.name.toLowerCase().includes(Q)).map(Ie=>({...Ie,isBuddy:ae.has(Ie.id),isPendingOut:Be.has(Ie.id),isPendingIn:Ue.has(Ie.id)})).slice(0,20);Y(Oe)},[V,te,y,O,_,t]);const M=async(Q,P)=>{if(!(!t||Q===t.id))try{await fa($t(pe,"notifications"),{toId:Q,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:P,read:!1,createdAt:vr()})}catch(ae){console.error("Notification error:",ae),ae.code==="permission-denied"&&I("Notifications blocked  check Firestore rules","error")}},ze=async Q=>{T(Q);try{const P=`${t.id}_${Q}`;await Ms(We(pe,"buddyRequests",P),{fromId:t.id,toId:Q,status:"pending",createdAt:vr()}),await M(Q,"buddy_request"),I("Buddy request sent!","success"),await U()}catch(P){console.error("Error sending request:",P),I("Failed to send request","error")}finally{T(null)}},gt=async Q=>{T(Q.reqId);try{const P=D2(Q.fromId,t.id);await Ms(We(pe,"buddies",P),{user1:[Q.fromId,t.id].sort()[0],user2:[Q.fromId,t.id].sort()[1],connectedAt:vr()}),await Tr(We(pe,"buddyRequests",Q.reqId)),await M(Q.fromId,"buddy_accept"),I("Buddy added!","success"),await U()}catch(P){console.error("Error accepting request:",P),I("Failed to accept","error")}finally{T(null)}},B=async Q=>{T(Q.reqId);try{await Tr(We(pe,"buddyRequests",Q.reqId)),I("Request declined","info"),await U()}catch(P){console.error("Error declining:",P),I("Failed to decline","error")}finally{T(null)}},se=async Q=>{T(Q.reqId);try{await Tr(We(pe,"buddyRequests",Q.reqId)),I("Request cancelled","info"),await U()}catch(P){console.error("Error cancelling:",P),I("Failed to cancel","error")}finally{T(null)}},ge=async Q=>{T(Q);try{const P=D2(t.id,Q);await Tr(We(pe,"buddies",P)),I("Buddy removed","info"),await U()}catch(P){console.error("Error removing buddy:",P),I("Failed to remove buddy","error")}finally{T(null)}},Re=_.length;return i?r.jsx("div",{className:"bdy-loading",children:r.jsx("div",{className:"bdy-spinner"})}):!n||!e||!t?null:r.jsx(ga,{children:r.jsxs("div",{className:"bdy-page","data-theme":l?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"bdy-main",children:[r.jsx("h1",{className:"bdy-title",children:"Buddies"}),r.jsxs("button",{className:"bdy-leaderboard-link",onClick:()=>d("/client/leaderboard"),children:[r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C7 4 7 7 7 7"}),r.jsx("path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5C17 4 17 7 17 7"}),r.jsx("rect",{x:"6",y:"9",width:"12",height:"13",rx:"2"}),r.jsx("path",{d:"M12 9v13"}),r.jsx("path",{d:"M2 22h20"})]}),r.jsx("span",{children:"Leaderboard"}),r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("div",{className:"bdy-tabs",children:[r.jsxs("button",{className:`bdy-tab${p==="buddies"?" active":""}`,onClick:()=>g("buddies"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("span",{children:"My Buddies"})]}),r.jsxs("button",{className:`bdy-tab${p==="requests"?" active":""}`,onClick:()=>g("requests"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("line",{x1:"19",y1:"8",x2:"19",y2:"14"}),r.jsx("line",{x1:"22",y1:"11",x2:"16",y2:"11"})]}),r.jsx("span",{children:"Requests"}),Re>0&&r.jsx("span",{className:"bdy-tab-badge",children:Re})]}),r.jsxs("button",{className:`bdy-tab${p==="search"?" active":""}`,onClick:()=>g("search"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("span",{children:"Find"})]})]}),Te?r.jsx("div",{className:"bdy-content-loading",children:r.jsx("div",{className:"bdy-spinner"})}):r.jsxs(r.Fragment,{children:[p==="buddies"&&r.jsx("div",{className:"bdy-section",children:y.length===0?r.jsxs("div",{className:"bdy-empty",children:[r.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("h3",{children:"No buddies yet"}),r.jsx("p",{children:"Find members and send buddy requests to connect!"}),r.jsx("button",{className:"bdy-empty-btn",onClick:()=>g("search"),children:"Find Buddies"})]}):r.jsx("div",{className:"bdy-list",children:y.map(Q=>r.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${Q.id}`),children:[r.jsx("div",{className:"bdy-avatar",children:Q.photoURL?r.jsx("img",{src:Q.photoURL,alt:Q.name}):r.jsx("span",{children:hh(Q.name)})}),r.jsx("div",{className:"bdy-card-info",children:r.jsx("span",{className:"bdy-card-name",children:Q.name})}),r.jsx("button",{className:"bdy-remove-btn",onClick:P=>{P.stopPropagation(),ge(Q.id)},disabled:R===Q.id,"aria-label":"Remove buddy",children:R===Q.id?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},Q.id))})}),p==="requests"&&r.jsxs("div",{className:"bdy-section",children:[_.length>0&&r.jsxs(r.Fragment,{children:[r.jsx("h3",{className:"bdy-section-title",children:"Incoming"}),r.jsx("div",{className:"bdy-list",children:_.map(Q=>r.jsxs("div",{className:"bdy-card",children:[r.jsx("div",{className:"bdy-avatar",children:Q.fromClient.photoURL?r.jsx("img",{src:Q.fromClient.photoURL,alt:Q.fromClient.name}):r.jsx("span",{children:hh(Q.fromClient.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:Q.fromClient.name}),r.jsx("span",{className:"bdy-card-sub",children:"wants to be your buddy"})]}),r.jsxs("div",{className:"bdy-action-pair",children:[r.jsx("button",{className:"bdy-accept-btn",onClick:()=>gt(Q),disabled:R===Q.reqId,children:R===Q.reqId?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}),r.jsx("button",{className:"bdy-decline-btn",onClick:()=>B(Q),disabled:R===Q.reqId,children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]},Q.reqId))})]}),O.length>0&&r.jsxs(r.Fragment,{children:[r.jsx("h3",{className:"bdy-section-title",children:"Sent"}),r.jsx("div",{className:"bdy-list",children:O.map(Q=>r.jsxs("div",{className:"bdy-card",children:[r.jsx("div",{className:"bdy-avatar",children:Q.toClient?.photoURL?r.jsx("img",{src:Q.toClient.photoURL,alt:Q.toClient.name}):r.jsx("span",{children:hh(Q.toClient?.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:Q.toClient?.name}),r.jsx("span",{className:"bdy-card-sub",children:"pending"})]}),r.jsx("button",{className:"bdy-cancel-btn",onClick:()=>se(Q),disabled:R===Q.reqId,children:R===Q.reqId?r.jsx("div",{className:"bdy-btn-spinner"}):"Cancel"})]},Q.reqId))})]}),_.length===0&&O.length===0&&r.jsxs("div",{className:"bdy-empty",children:[r.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[r.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),r.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),r.jsx("h3",{children:"No pending requests"}),r.jsx("p",{children:"All caught up!"})]})]}),p==="search"&&r.jsxs("div",{className:"bdy-section",children:[r.jsxs("div",{className:"bdy-search-bar",children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("input",{type:"text",placeholder:"Search by name...",value:V,onChange:Q=>L(Q.target.value),autoFocus:!0}),V&&r.jsx("button",{className:"bdy-search-clear",onClick:()=>L(""),children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),V.trim()&&ee.length===0&&r.jsx("div",{className:"bdy-empty bdy-empty-sm",children:r.jsxs("p",{children:['No members found for "',V,'"']})}),ee.length>0&&r.jsx("div",{className:"bdy-list",children:ee.map(Q=>r.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${Q.id}`),children:[r.jsx("div",{className:"bdy-avatar",children:Q.photoURL?r.jsx("img",{src:Q.photoURL,alt:Q.name}):r.jsx("span",{children:hh(Q.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:Q.name}),Q.isBuddy&&r.jsx("span",{className:"bdy-card-badge",children:"Buddy"})]}),Q.isBuddy?r.jsx("span",{className:"bdy-status-icon",children:r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-success)",strokeWidth:"2.5",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}):Q.isPendingOut?r.jsx("span",{className:"bdy-pending-label",children:"Pending"}):Q.isPendingIn?r.jsx("button",{className:"bdy-accept-btn",onClick:P=>{P.stopPropagation();const ae=_.find(Be=>Be.fromId===Q.id);ae&&gt(ae)},disabled:!!R,children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}):r.jsx("button",{className:"bdy-add-btn",onClick:P=>{P.stopPropagation(),ze(Q.id)},disabled:R===Q.id,children:R===Q.id?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]},Q.id))})]})]})]}),r.jsx(ta,{}),S&&r.jsxs("div",{className:`toast-notification ${S.type}`,children:[r.jsx("span",{className:"toast-icon",children:S.type==="success"?r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M5 13 L9 17 L19 7"})}):S.type==="error"?r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),r.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),r.jsx("span",{className:"toast-message",children:S.message})]})]})})}function mh(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function Zp(n,e){return[n,e].sort().join("_")}const L6=5;function eg(n){return n.toISOString().split("T")[0]}function O6(n){return n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}T`:`${Math.round(n)}`}const B6={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}};function P2(n){if(!n)return"";const e=n instanceof Date?n:n.toDate?n.toDate():new Date(n),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function V6(){const{userId:n}=wE(),{currentUser:e,isClient:t,clientData:i,loading:l}=Rr(),{isDark:u,toggleTheme:d}=Ia(),p=Zn(),[g,y]=b.useState(null),[x,_]=b.useState("none"),[j,O]=b.useState(null),[$,V]=b.useState(!0),[L,ee]=b.useState(!1),[Y,te]=b.useState(null),[ke,Te]=b.useState([]),[xe,R]=b.useState(!1),[T,S]=b.useState(new Set),[D,I]=b.useState(new Set),[U,M]=b.useState({}),[ze,gt]=b.useState({}),[B,se]=b.useState({}),[ge,Re]=b.useState(!0),[Q,P]=b.useState(0),[ae,Be]=b.useState(0),[Ue,Oe]=b.useState(0),[Ie,ot]=b.useState(0),[yt,et]=b.useState([]),[Xt,Es]=b.useState([]),[Ot,wt]=b.useState(null),[oe,Ct]=b.useState(null),[kt,zt]=b.useState(0),[Et,jt]=b.useState([]),[tt,Mt]=b.useState(!1),[qt,ms]=b.useState(null),[Ft,At]=b.useState([]),us=b.useCallback((J,ne="info")=>{te({message:J,type:ne}),setTimeout(()=>te(null),3500)},[]);b.useEffect(()=>{!l&&(!e||!t)&&p("/")},[e,t,l,p]),b.useEffect(()=>{i&&n&&i.id===n&&p("/client/core-buddy",{replace:!0})},[i,n,p]),b.useEffect(()=>{if(!i||!n||i.id===n)return;let J=!1;return(async()=>{V(!0);try{const bt=(await Is($t(pe,"clients"))).docs.map(Ae=>({id:Ae.id,...Ae.data()})).find(Ae=>Ae.id===n);if(!bt){J||V(!1);return}J||y(bt);const Ye=i.id,vt=Zp(Ye,n);if((await Os(We(pe,"buddies",vt))).exists())J||_("buddy");else{const Ae=`${Ye}_${n}`,Ge=await Os(We(pe,"buddyRequests",Ae));if(Ge.exists()&&Ge.data().status==="pending")J||(_("pending_out"),O(Ae));else{const ht=`${n}_${Ye}`,Je=await Os(We(pe,"buddyRequests",ht));Je.exists()&&Je.data().status==="pending"?J||(_("pending_in"),O(ht)):J||_("none")}}}catch(ne){console.error("Error loading profile:",ne)}finally{J||V(!1)}})(),()=>{J=!0}},[i,n]),b.useEffect(()=>{if(!n||!g)return;let J=!1;return(async()=>{Re(!0);try{const[ne,$e,bt,Ye]=await Promise.all([Is(Fs($t(pe,"workoutLogs"),bs("clientId","==",n))),Os(We(pe,"coreBuddyAchievements",n)),Os(We(pe,"coreBuddyPBs",n)),Os(We(pe,"clientProgrammes",n))]);if(J)return;const vt=ne.docs.length;P(vt),$e.exists()&&Be($e.data().totalVolume||0);let X=0;const Ae=ne.docs.map(Je=>Je.data().date).filter(Boolean).sort().reverse();if(Ae.length>0){const Je=new Date;let Kt=new Date(Je);for(let Ht=0;Ht<52;Ht++){const F=new Date(Kt),fe=F.getDay(),Se=fe===0?6:fe-1;F.setDate(F.getDate()-Se),F.setHours(0,0,0,0);const Ee=new Date(F);Ee.setDate(Ee.getDate()+7);const Ne=eg(F),mt=eg(Ee);if(Ae.some(lt=>lt>=Ne&&lt<mt))X++;else{if(Ht>0)break;break}Kt.setDate(Kt.getDate()-7)}}if(J||Oe(X),bt.exists()){const Je=bt.data().exercises||{},Kt=Object.entries(Je).sort(([,Ht],[,F])=>(F.weight||0)-(Ht.weight||0)).slice(0,3).map(([Ht,F])=>({name:Ht,weight:F.weight,reps:F.reps}));J||et(Kt)}if(Ye.exists()){const Je=Ye.data(),Kt=B6[Je.templateId];if(Kt){const Ht=Object.keys(Je.completedSessions||{}).length,F=Kt.duration*Kt.daysPerWeek;J||(Ct(Je.templateId.replace(/_/g," ").replace(/\b\w/g,fe=>fe.toUpperCase())),zt(F>0?Math.round(Ht/F*100):0))}}const Ge=await Os(We(pe,"achievements",n));if(!J&&Ge.exists()){const Je=Ge.data().badges||{};Es(Object.keys(Je))}let ht=0;for(let Je=0;Je<30;Je++){const Kt=new Date;Kt.setDate(Kt.getDate()-Je);const Ht=eg(Kt);try{const F=await Is(Fs($t(pe,"habitLogs"),bs("clientId","==",n),bs("date","==",Ht)));if(F.empty)break;{const fe=F.docs[0].data().habits||{};if(Object.values(fe).filter(Boolean).length>=L6)ht++;else break}}catch{break}}J||ot(ht)}catch(ne){console.error("Error loading buddy stats:",ne)}finally{J||Re(!1)}})(),()=>{J=!0}},[n,g]),b.useEffect(()=>{if(!i)return;const J=i.id;(async()=>{try{const[ne,$e,bt]=await Promise.all([Is(Fs($t(pe,"buddies"),bs("user1","==",J))),Is(Fs($t(pe,"buddies"),bs("user2","==",J))),Is($t(pe,"clients"))]),Ye=new Set;[...ne.docs,...$e.docs].forEach(X=>{const Ae=X.data();Ye.add(Ae.user1===J?Ae.user2:Ae.user1)});const vt={};bt.docs.forEach(X=>{vt[X.id]=X.data()}),jt(Array.from(Ye).filter(X=>vt[X]).map(X=>({id:X,name:vt[X].name,photoURL:vt[X].photoURL||null})))}catch(ne){console.error("Error loading buddies for mentions:",ne)}})()},[i]);const vs=async(J,ne,$e={})=>{if(!(!i||J===i.id))try{await fa($t(pe,"notifications"),{toId:J,fromId:i.id,fromName:i.name||"Someone",fromPhotoURL:i.photoURL||null,type:ne,read:!1,createdAt:vr(),...$e})}catch(bt){console.error("Notification error:",bt),bt.code==="permission-denied"&&us("Notifications blocked  check Firestore rules","error")}},as=async()=>{ee(!0);try{const J=`${i.id}_${n}`;await Ms(We(pe,"buddyRequests",J),{fromId:i.id,toId:n,status:"pending",createdAt:vr()}),await vs(n,"buddy_request"),_("pending_out"),O(J),us("Buddy request sent!","success")}catch(J){console.error(J),us("Failed to send request","error")}finally{ee(!1)}},nn=async()=>{if(j){ee(!0);try{const J=Zp(i.id,n);await Ms(We(pe,"buddies",J),{user1:[i.id,n].sort()[0],user2:[i.id,n].sort()[1],connectedAt:vr()}),await Tr(We(pe,"buddyRequests",j)),await vs(n,"buddy_accept"),_("buddy"),us("Buddy added!","success")}catch(J){console.error(J),us("Failed to accept","error")}finally{ee(!1)}}},Ds=async()=>{if(j){ee(!0);try{await Tr(We(pe,"buddyRequests",j)),_("none"),us(x==="pending_out"?"Request cancelled":"Request declined","info")}catch(J){console.error(J),us("Failed","error")}finally{ee(!1)}}},Hs=async()=>{ee(!0);try{const J=Zp(i.id,n);await Tr(We(pe,"buddies",J)),_("none"),us("Buddy removed","info")}catch(J){console.error(J),us("Failed to remove","error")}finally{ee(!1)}},is=b.useCallback(async()=>{if(n){R(!0);try{const J=await Is(Fs($t(pe,"posts"),bs("authorId","==",n),Qh("createdAt","desc"),Xh(30)));if(Te(J.docs.map(ne=>({id:ne.id,...ne.data()}))),i){const ne=await Is(Fs($t(pe,"postLikes"),bs("userId","==",i.id)));S(new Set(ne.docs.map($e=>$e.data().postId)))}}catch(J){console.error("Error loading journey:",J)}finally{R(!1)}}},[n,i]);b.useEffect(()=>{!$&&g&&is()},[$,g,is]);const xs=async J=>{if(window.confirm("Delete this post?"))try{await Tr(We(pe,"posts",J)),Te(ne=>ne.filter($e=>$e.id!==J)),us("Post deleted","info")}catch(ne){console.error("Delete error:",ne),us("Failed to delete","error")}},ye=async J=>{if(!i)return;const ne=i.id,$e=`${J}_${ne}`,bt=T.has(J),Ye=new Set(T);bt?Ye.delete(J):Ye.add(J),S(Ye),Te(vt=>vt.map(X=>X.id===J?{...X,likeCount:Math.max(0,(X.likeCount||0)+(bt?-1:1))}:X));try{if(bt)await Tr(We(pe,"postLikes",$e)),await Jr(We(pe,"posts",J),{likeCount:Go(-1)});else{await Ms(We(pe,"postLikes",$e),{postId:J,userId:ne,createdAt:vr()}),await Jr(We(pe,"posts",J),{likeCount:Go(1)});const vt=ke.find(X=>X.id===J);vt&&vs(vt.authorId,"like",{postId:J})}}catch(vt){console.error("Like error:",vt),is()}},Me=async J=>{try{const ne=await Is(Fs($t(pe,"postComments"),bs("postId","==",J),Qh("createdAt","asc"),Xh(50)));M($e=>({...$e,[J]:ne.docs.map(bt=>({id:bt.id,...bt.data()}))}))}catch(ne){console.error("Error loading comments:",ne)}},De=J=>{const ne=new Set(D);ne.has(J)?ne.delete(J):(ne.add(J),U[J]||Me(J)),I(ne)},Qe=(J,ne)=>{const $e=J.match(/@(\w*)$/);if($e){Mt(!0),ms(ne);const bt=Et.filter(Ye=>Ye.name&&Ye.name.toLowerCase().includes($e[1].toLowerCase())).slice(0,5);At(bt)}else Mt(!1),At([])},He=(J,ne)=>{const bt=(ze[ne]||"").replace(/@\w*$/,`@${J.name} `);gt(Ye=>({...Ye,[ne]:bt})),Mt(!1),At([])},Xe=(J,ne)=>{gt($e=>({...$e,[J]:ne})),Qe(ne,J)},ut=async J=>{const ne=(ze[J]||"").trim();if(!(!ne||!i)){se($e=>({...$e,[J]:!0}));try{await fa($t(pe,"postComments"),{postId:J,authorId:i.id,authorName:i.name||"Unknown",authorPhotoURL:i.photoURL||null,content:ne,createdAt:vr()}),await Jr(We(pe,"posts",J),{commentCount:Go(1)});const $e=ke.find(Ye=>Ye.id===J);$e&&vs($e.authorId,"comment",{postId:J});const bt=ne.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(bt){const Ye=new Set;bt.forEach(vt=>{const X=vt.slice(1).trim(),Ae=Et.find(Ge=>Ge.name&&Ge.name.toLowerCase()===X.toLowerCase());Ae&&!Ye.has(Ae.id)&&(Ye.add(Ae.id),vs(Ae.id,"mention",{postId:J}))})}gt(Ye=>({...Ye,[J]:""})),Te(Ye=>Ye.map(vt=>vt.id===J?{...vt,commentCount:(vt.commentCount||0)+1}:vt)),await Me(J)}catch($e){console.error("Comment error:",$e),us("Failed to comment","error")}finally{se($e=>({...$e,[J]:!1}))}}};return l||$||!i?r.jsx("div",{className:"prf-loading","data-theme":u?"dark":"light",children:r.jsx("div",{className:"prf-spinner"})}):!e||!t?null:g?r.jsx(ga,{children:r.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:u?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"prf-main",children:[r.jsxs("div",{className:"prf-hero",children:[r.jsx("div",{className:"prf-avatar-lg",children:g.photoURL?r.jsx("img",{src:g.photoURL,alt:g.name}):r.jsx("span",{children:mh(g.name)})}),r.jsx("h1",{className:"prf-name",children:g.name}),r.jsxs("div",{className:"prf-buddy-action",children:[x==="none"&&r.jsx("button",{className:"prf-btn prf-btn-primary",onClick:as,disabled:L,children:L?r.jsx("div",{className:"prf-btn-spinner"}):r.jsxs(r.Fragment,{children:[r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Buddy"]})}),x==="pending_out"&&r.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:Ds,disabled:L,children:L?r.jsx("div",{className:"prf-btn-spinner dark"}):"Cancel Request"}),x==="pending_in"&&r.jsxs("div",{className:"prf-btn-pair",children:[r.jsx("button",{className:"prf-btn prf-btn-success",onClick:nn,disabled:L,children:L?r.jsx("div",{className:"prf-btn-spinner"}):"Accept"}),r.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:Ds,disabled:L,children:"Decline"})]}),x==="buddy"&&r.jsx("button",{className:"prf-btn prf-btn-danger",onClick:Hs,disabled:L,children:L?r.jsx("div",{className:"prf-btn-spinner"}):"Remove Buddy"})]})]}),ge?r.jsx("div",{className:"prf-stats-loading",children:r.jsx("div",{className:"prf-spinner"})}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"prf-stats",children:[r.jsxs("div",{className:"prf-stat",children:[r.jsx("span",{className:"prf-stat-value",children:Q}),r.jsx("span",{className:"prf-stat-label",children:"Workouts"})]}),r.jsxs("div",{className:"prf-stat",children:[r.jsxs("span",{className:"prf-stat-value",children:[O6(ae),r.jsx("span",{className:"prf-stat-unit",children:ae>=1e3?"":"kg"})]}),r.jsxs("span",{className:"prf-stat-label",children:[ae>=1e6?"Million kg":ae>=1e3?"Tonnes":"Volume"," Lifted"]})]}),r.jsxs("div",{className:"prf-stat",children:[r.jsxs("span",{className:"prf-stat-value",children:[Ue,r.jsx("span",{className:"prf-stat-unit",children:"wk"})]}),r.jsx("span",{className:"prf-stat-label",children:"Streak"})]})]}),(oe||Ie>0)&&r.jsxs("div",{className:"prf-info-row",children:[oe&&r.jsxs("div",{className:"prf-info-card info-programme",children:[r.jsx("div",{className:"prf-info-icon",children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"}),r.jsx("path",{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"})]})}),r.jsxs("div",{className:"prf-info-text",children:[r.jsx("span",{className:"prf-info-label",children:oe}),r.jsx("div",{className:"prf-info-progress-bar",children:r.jsx("div",{className:"prf-info-progress-fill",style:{width:`${Math.min(kt,100)}%`}})}),r.jsxs("span",{className:"prf-info-sub",children:[kt,"% complete"]})]})]}),Ie>0&&r.jsxs("div",{className:"prf-info-card info-habit",children:[r.jsx("div",{className:"prf-info-icon",children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),r.jsx("path",{d:"M22 4L12 14.01l-3-3"})]})}),r.jsxs("div",{className:"prf-info-text",children:[r.jsxs("span",{className:"prf-info-value",children:[Ie," day",Ie!==1?"s":""]}),r.jsx("span",{className:"prf-info-sub",children:"Habit Streak"})]})]})]}),yt.length>0&&r.jsxs("div",{className:"prf-section",children:[r.jsx("h2",{className:"prf-section-title",children:"Top Lifts"}),r.jsx("div",{className:"prf-pb-list",children:yt.map((J,ne)=>r.jsxs("div",{className:"prf-pb-item",children:[r.jsx("div",{className:"prf-pb-rank",children:ne===0?r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:r.jsx("path",{d:"M12 2l2.4 7.4H22l-6 4.4 2.3 7.2L12 16.6 5.7 21l2.3-7.2-6-4.4h7.6z"})}):`#${ne+1}`}),r.jsx("span",{className:"prf-pb-name",children:J.name}),r.jsxs("span",{className:"prf-pb-weight",children:[J.weight,r.jsx("span",{className:"prf-pb-unit",children:"kg"})," x",J.reps]})]},ne))})]}),Xt.length>0&&r.jsxs("div",{className:"prf-section",children:[r.jsxs("h2",{className:"prf-section-title",children:["Badges Earned (",Xt.length,")"]}),r.jsx("div",{className:"prf-badge-row",children:Xt.map(J=>{const ne=Wn.find($e=>$e.id===J);return ne?r.jsx("button",{className:"prf-badge-chip",onClick:()=>wt(ne),children:r.jsx("img",{src:ne.img,alt:ne.name,className:"prf-badge-chip-img"})},J):null})})]}),Ot&&r.jsx("div",{className:"prf-badge-overlay",onClick:()=>wt(null),children:r.jsxs("div",{className:"prf-badge-overlay-content",onClick:J=>J.stopPropagation(),children:[r.jsx("img",{src:Ot.img,alt:Ot.name,className:"prf-badge-overlay-img"}),r.jsx("p",{className:"prf-badge-overlay-desc",children:Ot.desc}),r.jsx("button",{className:"prf-badge-overlay-close",onClick:()=>wt(null),children:"Tap to close"})]})})]}),r.jsxs("div",{className:"prf-section",children:[r.jsx("h2",{className:"prf-section-title",children:`${g.name?.split(" ")[0]}'s Journey`}),xe?r.jsx("div",{className:"journey-loading",children:r.jsx("div",{className:"prf-spinner"})}):ke.length===0?r.jsxs("div",{className:"journey-empty",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]}),r.jsx("p",{children:"No posts yet"})]}):r.jsx("div",{className:"journey-list",children:ke.map(J=>r.jsxs("div",{className:"journey-post",children:[r.jsxs("div",{className:"journey-post-header",children:[r.jsx("div",{className:"journey-post-avatar",children:J.authorPhotoURL?r.jsx("img",{src:J.authorPhotoURL,alt:""}):r.jsx("span",{children:mh(J.authorName)})}),r.jsxs("div",{className:"journey-post-meta",children:[r.jsx("span",{className:"journey-post-name",children:J.authorName}),r.jsx("span",{className:"journey-post-time",children:P2(J.createdAt)})]}),J.authorId===i.id&&r.jsx("button",{className:"journey-delete-btn",onClick:()=>xs(J.id),"aria-label":"Delete post",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),J.content&&r.jsx("p",{className:"journey-post-content",children:J.content}),J.imageURL&&r.jsx("div",{className:"journey-post-image",children:r.jsx("img",{src:J.imageURL,alt:"Post",loading:"lazy"})}),r.jsxs("div",{className:"journey-post-actions",children:[r.jsxs("button",{className:`journey-action-btn${T.has(J.id)?" liked":""}`,onClick:()=>ye(J.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:T.has(J.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),r.jsx("span",{children:J.likeCount||0})]}),r.jsxs("button",{className:`journey-action-btn${D.has(J.id)?" active":""}`,onClick:()=>De(J.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),r.jsx("span",{children:J.commentCount||0})]})]}),D.has(J.id)&&r.jsxs("div",{className:"journey-comments",children:[U[J.id]?.length>0?U[J.id].map(ne=>r.jsxs("div",{className:"journey-comment",children:[r.jsx("div",{className:"journey-comment-avatar",onClick:()=>p(`/client/core-buddy/profile/${ne.authorId}`),children:ne.authorPhotoURL?r.jsx("img",{src:ne.authorPhotoURL,alt:""}):r.jsx("span",{children:mh(ne.authorName)})}),r.jsxs("div",{className:"journey-comment-body",children:[r.jsxs("div",{className:"journey-comment-bubble",children:[r.jsx("span",{className:"journey-comment-name",children:ne.authorName}),r.jsx("span",{className:"journey-comment-text",children:ne.content})]}),r.jsx("span",{className:"journey-comment-time",children:P2(ne.createdAt)})]})]},ne.id)):r.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),r.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[r.jsx("input",{type:"text",placeholder:"Comment... (@ to mention)",value:ze[J.id]||"",onChange:ne=>Xe(J.id,ne.target.value),onKeyDown:ne=>{ne.key==="Enter"&&ut(J.id)},maxLength:300}),tt&&qt===J.id&&Ft.length>0&&r.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:Ft.map(ne=>r.jsxs("button",{className:"mention-option",onClick:()=>He(ne,J.id),children:[r.jsx("div",{className:"mention-option-avatar",children:ne.photoURL?r.jsx("img",{src:ne.photoURL,alt:""}):r.jsx("span",{children:mh(ne.name)})}),r.jsx("span",{children:ne.name})]},ne.id))}),r.jsx("button",{onClick:()=>ut(J.id),disabled:!(ze[J.id]||"").trim()||B[J.id],children:B[J.id]?r.jsx("div",{className:"journey-btn-spinner-sm"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),r.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},J.id))})]})]}),r.jsx(ta,{}),Y&&r.jsxs("div",{className:`toast-notification ${Y.type}`,children:[r.jsx("span",{className:"toast-icon",children:Y.type==="success"?r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M5 13 L9 17 L19 7"})}):Y.type==="error"?r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),r.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),r.jsx("span",{className:"toast-message",children:Y.message})]})]})}):r.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions"})]})}),r.jsx("main",{className:"prf-main",children:r.jsx("p",{style:{textAlign:"center",color:"var(--text-tertiary)",padding:"40px 0"},children:"User not found"})}),r.jsx(ta,{})]})}const Yk=[{name:"Dumbbell Floor Press",type:"weighted",equipment:"dumbbells",group:"push",pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",equipment:"dumbbells",group:"push",pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Tricep Dips",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Pike Push Ups",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/pike push ups.GIF"},{name:"Reverse Plank",type:"timed",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/reverse plank.GIF"},{name:"Dumbbell Squeeze Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Pullover",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Fly",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Tricep Kickback",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Shrug",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Y-Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Wide Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Diamond Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Decline Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Wall Walks",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Press Up Hold",type:"timed",equipment:"bodyweight",group:"push",storagePath:null},{name:"Shoulder Tap Hold",type:"timed",equipment:"bodyweight",group:"push",storagePath:null},{name:"Dumbbell Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Bicep Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Renegade Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Reverse Fly",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Concentration Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Wrist Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Reverse Snow Angel",type:"reps",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Isometric Bicep Hold",type:"timed",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Dumbbell Goblet Squats",type:"weighted",equipment:"dumbbells",group:"lower",pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Romanian Deadlifts",type:"weighted",equipment:"dumbbells",group:"lower",pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Sumo Squats",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"1 Legged RDL",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/1 legged rdl.GIF"},{name:"Dumbbell Box Step Ups",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.GIF"},{name:"Dumbbell Reverse Lunges",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.GIF"},{name:"Kettlebell Romanian Deadlift",type:"weighted",equipment:"kettlebell",group:"lower",storagePath:"exercises/kettlebells/lower/kettlebell romanian deadlift.mp4"},{name:"Reverse Lunge",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/reverse lunge.GIF"},{name:"Box Step Ups",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/box step ups.GIF"},{name:"Bulgarian Split Squats",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Jump Squats",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Hip Thrusts",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/hip thrusts.GIF"},{name:"Donkey Kicks",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/donkey kicks.GIF"},{name:"Skater Jumps",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/skater jumps.GIF"},{name:"Squat And Hold",type:"timed",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/squat and hold.GIF"},{name:"Forearm Plank",type:"timed",equipment:"bodyweight",group:"core",pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Side Plank",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Side Plank.mp4"},{name:"Hollow Body Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Superman Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Superman Hold.mp4"},{name:"Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Fast Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Fast Mountain Climbers.mp4"},{name:"Cross Body Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Russian Twist",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Crunch",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Bicycle Crunch",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Leg Raises",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Dead Bug",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Dead Bug Single Leg Drop",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Bird Dog",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Flutter Kicks",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Hollow Hold Flutter Kicks",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"},{name:"High Plank Shoulder Taps",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"},{name:"Hip Dips Plank",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Single Leg V-Up",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Single Leg V-Up.mp4"},{name:"Hollow Hold To V-Sit",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"},{name:"Toe Reaches",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/toe reaches.GIF"},{name:"Side Plank Rotation",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Plank Walkout",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Russian Twists Dumbbell",type:"weighted",equipment:"dumbbells",group:"core",storagePath:"exercises/dumbbells/core/russian twists dumbbell.GIF"},{name:"Kettlebell Russian Twist",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",type:"reps",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Back Extension Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:null},{name:"Dumbbell Plank Pull Through",type:"weighted",equipment:"dumbbells",group:"core",storagePath:null}],U6=Yk.filter(n=>n.storagePath!==null);async function L2(n){const e=n.headers.get("content-type")||"";if(!n.ok||e.includes("application/json"))try{return{done:!0,error:(await n.json()).error||`Server error (${n.status})`}}catch{return{done:!0,error:`Server error (${n.status})`}}const t=n.body.getReader(),i=new TextDecoder;let l=null,u="";for(;;){const{done:d,value:p}=await t.read();if(d)break;u+=i.decode(p,{stream:!0});const g=u.split(`
`);u=g.pop();for(const y of g)if(y.startsWith("data: "))try{const x=JSON.parse(y.slice(6));x.done&&(l=x)}catch{}}if(u.startsWith("data: "))try{const d=JSON.parse(u.slice(6));d.done&&(l=d)}catch{}return l}function F6(){const n=Zn(),{clientData:e,currentUser:t,resolveClient:i,updateClientData:l}=Rr(),[u,d]=b.useState([]),[p,g]=b.useState(""),[y,x]=b.useState(!1),[_,j]=b.useState(null),[O,$]=b.useState(!1),[V,L]=b.useState(null),ee=b.useRef(null),Y=b.useRef(null),[te,ke]=b.useState(!1),[Te,xe]=b.useState(null),[R,T]=b.useState(null),[S,D]=b.useState(1);if(!e?.buddyEnabled)return r.jsxs("div",{className:"buddy-page",children:[r.jsxs("div",{className:"buddy-container",children:[r.jsx("p",{children:"Buddy is not enabled on your account."}),r.jsx("button",{onClick:()=>n("/client/core-buddy"),children:"Back to Dashboard"})]}),r.jsx(ta,{active:"home"})]});b.useEffect(()=>{ee.current&&ee.current.scrollIntoView({behavior:"smooth"})},[u,y]),b.useEffect(()=>{u.length===0&&!y&&I([])},[]);const I=async B=>{x(!0),j(null);try{const se=await fetch("/api/buddy-onboarding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:B,clientName:e?.name||t?.displayName||"there"})}),ge=await L2(se);if(!ge||ge.error){j(ge?.error||"No response from Buddy  try again.");return}const Re={role:"assistant",content:ge.reply};d(Q=>[...Q,Re]),ge.profileData&&(await gt(ge.profileData),L(ge.profileData),$(!0))}catch(se){console.error("Buddy chat error:",se),j("Something went wrong  try sending again.")}finally{x(!1)}},U=()=>{const B=p.trim();if(!B||y)return;const se={role:"user",content:B},ge=[...u,se];d(ge),g(""),Y.current&&Y.current.focus(),I(ge)},M=B=>{B.key==="Enter"&&!B.shiftKey&&(B.preventDefault(),U())},ze=async B=>{ke(!0),T(null);try{const se=U6.map(Q=>({name:Q.name,type:Q.type,equipment:Q.equipment,group:Q.group})),ge=await fetch("/api/buddy-generate-plan",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({profile:{name:e?.name||t?.displayName||"Client",...B},exerciseLibrary:se})}),Re=await L2(ge);if(!Re){T("No response from Buddy  try again.");return}if(Re.error&&!Re.plan){T(Re.error);return}Re.reply&&d(Q=>[...Q,{role:"assistant",content:Re.reply}]),Re.plan?xe(Re.plan):T("Buddy couldn't structure the plan  try again.")}catch(se){console.error("Plan generation error:",se),T("Something went wrong generating your plan  try again.")}finally{ke(!1)}},gt=async B=>{try{const se=await i();if(!se)return;await Ms(We(pe,"onboardingSubmissions",se.id),{clientId:se.id,clientName:se.name,email:se.email,source:"buddy_chat",welcome:{dob:B.dob||null,gender:B.gender||null,goals:B.goals||[],experience:B.experience||null,injuries:B.injuries||null,activityLevel:B.activityLevel||null,exerciseHistory:B.exerciseHistory||null,sleepHours:B.sleepHours||null,stressLevel:B.stressLevel||null,dietaryInfo:B.dietaryInfo||null,availability:B.availability||null,additionalInfo:B.additionalInfo||null},submittedAt:vr()});const ge=B.goals||[];await Jr(We(pe,"clients",se.id),{fitnessGoal:ge[0]||null,fitnessGoals:ge,experienceLevel:B.experience||null,dob:B.dob||null,injuries:B.injuries||null}),l({fitnessGoal:ge[0]||null,fitnessGoals:ge,experienceLevel:B.experience,dob:B.dob})}catch(se){console.error("Save profile error:",se)}};return r.jsx(ga,{children:r.jsxs("div",{className:"buddy-page buddy-page--chat",children:[r.jsxs("div",{className:"buddy-chat-container",children:[r.jsxs("div",{className:"buddy-chat-top",children:[r.jsx("button",{className:"buddy-back",onClick:()=>n("/client/core-buddy"),children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsxs("div",{className:"buddy-chat-header",children:[r.jsx("div",{className:"buddy-chat-avatar",children:r.jsx("img",{src:"/Logo.webp",alt:"Buddy",className:"buddy-chat-avatar-img"})}),r.jsxs("div",{children:[r.jsx("h2",{className:"buddy-chat-name",children:"Buddy"}),r.jsx("span",{className:"buddy-chat-status",children:y?"typing...":te?"building your plan...":"Your AI Coach"})]})]})]}),r.jsxs("div",{className:"buddy-chat-messages",children:[r.jsx("div",{className:"buddy-chat-watermark",children:r.jsx("img",{src:"/Logo.webp",alt:"",className:"buddy-chat-watermark-img"})}),u.map((B,se)=>r.jsxs("div",{className:`buddy-chat-bubble buddy-chat-${B.role}`,children:[B.role==="assistant"?r.jsx("div",{className:"buddy-chat-bubble-avatar buddy-chat-bubble-avatar--logo",children:r.jsx("img",{src:"/Logo.webp",alt:"Buddy"})}):r.jsx("div",{className:"buddy-chat-bubble-avatar buddy-chat-bubble-avatar--user",children:e?.photoURL?r.jsx("img",{src:e.photoURL,alt:"You"}):r.jsx("span",{children:(e?.name||"?").charAt(0).toUpperCase()})}),r.jsx("div",{className:"buddy-chat-bubble-content",children:B.content})]},se)),y&&r.jsxs("div",{className:"buddy-chat-bubble buddy-chat-assistant",children:[r.jsx("div",{className:"buddy-chat-bubble-avatar buddy-chat-bubble-avatar--logo",children:r.jsx("img",{src:"/Logo.webp",alt:"Buddy"})}),r.jsxs("div",{className:"buddy-chat-bubble-content buddy-chat-typing",children:[r.jsx("span",{}),r.jsx("span",{}),r.jsx("span",{})]})]}),_&&r.jsxs("div",{className:"buddy-chat-error",children:[_,r.jsx("button",{onClick:()=>I(u),children:"Retry"})]}),r.jsx("div",{ref:ee})]}),O?r.jsx("div",{className:"buddy-chat-done",children:Te?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"buddy-plan-preview",children:[r.jsxs("div",{className:"buddy-plan-header",children:[r.jsx("h3",{className:"buddy-plan-name",children:Te.planName}),r.jsxs("div",{className:"buddy-plan-meta",children:[Te.daysPerWeek," days/week  4 weeks  ",Te.experienceLevel]}),r.jsx("div",{className:"buddy-plan-goals",children:(Te.goals||[]).map((B,se)=>r.jsx("span",{className:"buddy-plan-goal-tag",children:B},se))})]}),r.jsx("div",{className:"buddy-plan-weeks",children:(Te.weeks||[]).map(B=>r.jsxs("div",{className:"buddy-plan-week",children:[r.jsxs("button",{className:`buddy-plan-week-toggle ${S===B.weekNumber?"active":""}`,onClick:()=>D(S===B.weekNumber?null:B.weekNumber),children:[r.jsxs("span",{children:["Week ",B.weekNumber]}),r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:S===B.weekNumber?"M18 15l-6-6-6 6":"M6 9l6 6 6-6"})})]}),S===B.weekNumber&&r.jsx("div",{className:"buddy-plan-days",children:(B.days||[]).map(se=>r.jsxs("div",{className:"buddy-plan-day",children:[r.jsxs("div",{className:"buddy-plan-day-header",children:[r.jsxs("span",{className:"buddy-plan-day-num",children:["Day ",se.dayNumber]}),r.jsx("span",{className:"buddy-plan-day-focus",children:se.focus})]}),r.jsx("div",{className:"buddy-plan-exercises",children:(se.exercises||[]).map((ge,Re)=>r.jsxs("div",{className:"buddy-plan-exercise",children:[r.jsx("span",{className:"buddy-plan-ex-name",children:ge.name}),r.jsx("span",{className:"buddy-plan-ex-detail",children:ge.type==="timed"?`${ge.sets}${ge.duration}s`:`${ge.sets}${ge.reps}`}),ge.notes&&r.jsx("span",{className:"buddy-plan-ex-note",children:ge.notes})]},Re))})]},se.dayNumber))})]},B.weekNumber))})]}),r.jsx("button",{className:"buddy-chat-done-btn",onClick:()=>n("/client/core-buddy"),children:"Back to Dashboard"})]}):te?r.jsxs("div",{className:"buddy-plan-loading",children:[r.jsx("div",{className:"buddy-plan-spinner"}),r.jsx("p",{children:"Buddy is building your monthly plan..."})]}):R?r.jsxs("div",{className:"buddy-plan-error",children:[r.jsx("p",{children:R}),r.jsx("button",{className:"buddy-chat-done-btn",onClick:()=>ze(V),children:"Try Again"})]}):V?r.jsxs(r.Fragment,{children:[r.jsx("p",{className:"buddy-chat-done-text",children:"Profile saved! Ready to build your personalised monthly plan?"}),r.jsx("button",{className:"buddy-chat-done-btn",onClick:()=>ze(V),children:"Generate My Plan"}),r.jsx("button",{className:"buddy-chat-skip-btn",onClick:()=>n("/client/core-buddy"),children:"Maybe later"})]}):r.jsxs(r.Fragment,{children:[r.jsx("p",{className:"buddy-chat-done-text",children:"Profile saved  you're all set."}),r.jsx("button",{className:"buddy-chat-done-btn",onClick:()=>n("/client/core-buddy"),children:"Back to Dashboard"})]})}):r.jsxs("div",{className:"buddy-chat-input-wrap",children:[r.jsx("textarea",{ref:Y,className:"buddy-chat-input",placeholder:"Type your message...",value:p,onChange:B=>g(B.target.value),onKeyDown:M,rows:1,disabled:y}),r.jsx("button",{className:"buddy-chat-send",onClick:U,disabled:!p.trim()||y,"aria-label":"Send message",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),r.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]}),r.jsx(ta,{active:"home"})]})})}const tg=[{text:"Build your dashboard...",bold:"your way"},{text:"Pick what matters to you...",bold:"nothing else"},{text:"Your goals, your layout...",bold:"your rules"}],O2=[{id:"stats",label:"Stats Rings",desc:"Programme %, workouts this week, habits today",icon:"rings",defaultOn:!0},{id:"workouts",label:"Workouts",desc:"Sessions this week and total count",icon:"dumbbell",defaultOn:!0},{id:"habits",label:"Habits",desc:"Daily habit tracker dots",icon:"check",defaultOn:!0},{id:"pbs",label:"Personal Bests",desc:"Your top lifts at a glance",icon:"trophy",premium:!0},{id:"nutrition",label:"Nutrition",desc:"Macro rings  protein, carbs, fats, cals",icon:"apple",premium:!0},{id:"leaderboard",label:"Leaderboard",desc:"See where you rank among buddies",icon:"podium",premium:!0},{id:"achievements",label:"Achievements",desc:"Badge showcase and progress",icon:"medal"},{id:"journey",label:"Journey",desc:"Your posts, likes and comments feed",icon:"feed",premium:!0},{id:"coach",label:"Coach Message",desc:"Motivational nudge from Buddy",icon:"message",defaultOn:!0},{id:"nudge",label:"Smart Nudge",desc:"Contextual reminder of what to do next",icon:"lightbulb"}];function z6(n){switch(n){case"rings":return r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("circle",{cx:"12",cy:"12",r:"6"}),r.jsx("circle",{cx:"12",cy:"12",r:"2"})]});case"dumbbell":return r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M6.5 6.5h11v11h-11z",strokeLinejoin:"round"}),r.jsx("line",{x1:"2",y1:"12",x2:"6.5",y2:"12"}),r.jsx("line",{x1:"17.5",y1:"12",x2:"22",y2:"12"})]});case"check":return r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("polyline",{points:"20 6 9 17 4 12"})});case"trophy":return r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M6 9H3V6a1 1 0 0 1 1-1h2M18 9h3V6a1 1 0 0 0-1-1h-2"}),r.jsx("path",{d:"M6 5h12v7a6 6 0 0 1-12 0V5z"}),r.jsx("path",{d:"M9 21h6"}),r.jsx("path",{d:"M12 17v4"})]});case"apple":return r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M12 3c-1.5 0-3 1-3 1s-3-.5-4.5 1.5S3 9 3 12s1.5 6 3 8 3 3 6 3 4.5-1 6-3 3-5 3-8-1.5-4-3-6.5S13.5 3 12 3z"}),r.jsx("path",{d:"M12 3c0 0 1-2 3-2"})]});case"podium":return r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("rect",{x:"2",y:"14",width:"6",height:"8",rx:"1"}),r.jsx("rect",{x:"9",y:"8",width:"6",height:"14",rx:"1"}),r.jsx("rect",{x:"16",y:"11",width:"6",height:"11",rx:"1"})]});case"medal":return r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"15",r:"6"}),r.jsx("path",{d:"M8.21 13.89L7 2h10l-1.21 11.89"})]});case"feed":return r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"3"}),r.jsx("line",{x1:"3",y1:"9",x2:"21",y2:"9"}),r.jsx("line",{x1:"3",y1:"15",x2:"21",y2:"15"})]});case"message":return r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})});case"lightbulb":return r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M9 18h6"}),r.jsx("path",{d:"M10 22h4"}),r.jsx("path",{d:"M12 2a7 7 0 0 0-4 12.7V17h8v-2.3A7 7 0 0 0 12 2z"})]});default:return null}}function q6(){const n=Zn(),{clientData:e,currentUser:t,updateClientData:i}=Rr(),[l,u]=b.useState({hours:0,minutes:0,seconds:0}),[d,p]=b.useState(0),[g,y]=b.useState(0),[x,_]=b.useState(null),[j,O]=b.useState(!1),$=b.useRef(null),[V,L]=b.useState(()=>{const S=e?.dashboardWidgets;return S&&Array.isArray(S)?S:O2.filter(D=>D.defaultOn).map(D=>D.id)}),[ee,Y]=b.useState(!1),[te,ke]=b.useState(!1);b.useEffect(()=>{e?.photoURL&&_(e.photoURL)},[e?.photoURL]),b.useEffect(()=>{const S=()=>{const I=new Date,U=new Date(I);U.setHours(23,59,59,999);const M=U-I;u({hours:Math.floor(M/36e5),minutes:Math.floor(M%36e5/6e4),seconds:Math.floor(M%6e4/1e3)}),p(60-Math.floor(M%6e4/1e3))};S();const D=setInterval(S,1e3);return()=>clearInterval(D)},[]),b.useEffect(()=>{const S=setInterval(()=>y(D=>(D+1)%tg.length),8e3);return()=>clearInterval(S)},[]);const Te=async S=>{const D=S.target.files?.[0];if(!(!D||!e?.id)){O(!0);try{const I=gi(yi,`profilePhotos/${e.id}`);await Sh(I,D);const U=await co(I);await Jr(We(pe,"clients",e.id),{photoURL:U}),_(U),i({photoURL:U})}catch(I){console.error("Photo upload error:",I)}finally{O(!1)}}},xe=S=>{ke(!1),L(D=>D.includes(S)?D.filter(I=>I!==S):[...D,S])},R=(S,D)=>{ke(!1),L(I=>{const U=I.indexOf(S);if(U<0)return I;const M=U+D;if(M<0||M>=I.length)return I;const ze=[...I];return[ze[U],ze[M]]=[ze[M],ze[U]],ze})},T=async()=>{if(e?.id){Y(!0);try{await Jr(We(pe,"clients",e.id),{dashboardWidgets:V}),i({dashboardWidgets:V}),ke(!0)}catch(S){console.error("Save config error:",S)}finally{Y(!1)}}};return r.jsx(ga,{children:r.jsxs("div",{className:"bldr-page",children:[r.jsxs("div",{className:"bldr-container",children:[r.jsxs("div",{className:"bldr-header",children:[r.jsx("button",{className:"bldr-back",onClick:()=>n("/client/core-buddy"),children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("h1",{className:"bldr-title",children:"Build Your Dashboard"})]}),r.jsxs("div",{className:"bldr-ring-container",children:[r.jsxs("div",{className:"bldr-ring",children:[r.jsx("svg",{className:"bldr-ring-svg",viewBox:"0 0 200 200",children:Tm.map((S,D)=>r.jsx("line",{x1:S.x1,y1:S.y1,x2:S.x2,y2:S.y2,className:`bldr-tick ${D<d?"elapsed":"remaining"}`,strokeWidth:S.thick?"3":"2"},D))}),r.jsxs("div",{className:"bldr-ring-center",children:[r.jsxs("div",{className:"bldr-ring-photo",onClick:()=>$.current?.click(),children:[r.jsx("img",{src:x||"/Logo.webp",alt:x?"Profile":"Mind Core Fitness"}),r.jsx("div",{className:`bldr-photo-overlay${j?" uploading":""}`,children:j?r.jsx("div",{className:"bldr-photo-spinner"}):r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[r.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),r.jsx("input",{ref:$,type:"file",accept:"image/*",onChange:Te,style:{display:"none"}})]}),!x&&!j&&r.jsx("div",{className:"bldr-photo-badge",onClick:()=>$.current?.click(),children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[r.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),r.jsxs("div",{className:"bldr-countdown",children:[r.jsx("span",{className:"bldr-timer-digit",children:String(l.hours).padStart(2,"0")}),r.jsx("span",{className:"bldr-timer-colon",children:":"}),r.jsx("span",{className:"bldr-timer-digit",children:String(l.minutes).padStart(2,"0")}),r.jsx("span",{className:"bldr-timer-colon",children:":"}),r.jsx("span",{className:"bldr-timer-digit bldr-timer-sec",children:String(l.seconds).padStart(2,"0")})]}),r.jsx("span",{className:"bldr-ring-label",children:"remaining today"}),r.jsxs("p",{className:"bldr-tagline",children:[tg[g].text," ",r.jsx("strong",{children:tg[g].bold})]})]}),r.jsxs("div",{className:"bldr-section",children:[r.jsx("h2",{className:"bldr-section-title",children:"Choose Your Widgets"}),r.jsx("p",{className:"bldr-section-desc",children:"The countdown ring and your profile always stay at the top. Pick what goes below."}),r.jsx("div",{className:"bldr-widgets-list",children:O2.map(S=>{const D=V.includes(S.id),I=V.indexOf(S.id);return r.jsxs("div",{className:`bldr-widget-card${D?" active":""}${S.premium?" premium":""}`,children:[r.jsx("div",{className:"bldr-widget-icon",children:z6(S.icon)}),r.jsxs("div",{className:"bldr-widget-info",children:[r.jsxs("div",{className:"bldr-widget-label",children:[S.label,S.premium&&r.jsx("span",{className:"bldr-premium-tag",children:"PRO"})]}),r.jsx("div",{className:"bldr-widget-desc",children:S.desc})]}),r.jsxs("div",{className:"bldr-widget-actions",children:[D&&r.jsxs("div",{className:"bldr-widget-order",children:[r.jsx("button",{className:"bldr-order-btn",onClick:()=>R(S.id,-1),disabled:I===0,"aria-label":"Move up",children:r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:r.jsx("path",{d:"M18 15l-6-6-6 6"})})}),r.jsx("span",{className:"bldr-order-num",children:I+1}),r.jsx("button",{className:"bldr-order-btn",onClick:()=>R(S.id,1),disabled:I===V.length-1,"aria-label":"Move down",children:r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:r.jsx("path",{d:"M6 9l6 6 6-6"})})})]}),r.jsx("button",{className:`bldr-toggle${D?" on":""}`,onClick:()=>xe(S.id),"aria-label":D?`Remove ${S.label}`:`Add ${S.label}`,children:r.jsx("div",{className:"bldr-toggle-thumb"})})]})]},S.id)})})]}),r.jsxs("div",{className:"bldr-save-wrap",children:[r.jsx("button",{className:`bldr-save-btn${te?" saved":""}`,onClick:T,disabled:ee||te,children:ee?"Saving...":te?"Saved":"Save Dashboard"}),te&&r.jsx("button",{className:"bldr-view-btn",onClick:()=>n("/client/core-buddy"),children:"View Dashboard"})]})]}),r.jsx(ta,{active:"home"})]})})}const ka=[{key:"pressUps",name:"Press-Ups",category:"Upper Body",unit:"reps"},{key:"squats",name:"Squats",category:"Lower Body",unit:"reps"},{key:"longJump",name:"Standing Long Jump",category:"Power",unit:"distance"},{key:"deadHang",name:"Dead Hang",category:"Upper Body",unit:"time"},{key:"plank",name:"Plank",category:"Core",unit:"time"},{key:"wallSit",name:"Wall Sit",category:"Lower Body",unit:"time"},{key:"chestPress",name:"Chest Press",category:"Upper Body",unit:"weight"}],qo=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function H6(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}function ja(n){const[e,t]=n.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function $6(n){if(!n&&n!==0)return"-";const e=Math.floor(n/60),t=(n%60).toFixed(2);return e>0?`${e}m ${parseFloat(t).toFixed(0)}s`:`${parseFloat(t).toFixed(2)}s`}function W6(n,e){return!n&&n!==0?"-":!e&&e!==0?`${n}kg`:`${n}kg x ${e}`}function fh(n,e){if(!e)return"-";switch(n.unit){case"weight":return W6(e.weight,e.reps);case"time":return $6(e.time);case"reps":return e.reps?`${e.reps} reps`:"-";case"distance":return e.distance?`${e.distance} cm`:"-";default:return"-"}}function zl(n,e){if(!e)return 0;switch(n.unit){case"weight":return(e.weight||0)*(e.reps||0);case"time":return e.time||0;case"reps":return e.reps||0;case"distance":return e.distance||0;default:return 0}}function sg(n,e){return!e||e===0?null:(n-e)/e*100}function G6({data:n,exerciseKey:e,unit:t}){if(!n||n.length<2)return r.jsx("div",{className:"pb-trend-empty",children:r.jsx("p",{children:"Not enough data for trend line yet"})});const i=n.map(V=>{const L=V.benchmarks?.[e];if(!L)return 0;switch(t){case"weight":return(L.weight||0)*(L.reps||0);case"time":return L.time||0;case"reps":return L.reps||0;case"distance":return L.distance||0;default:return 0}}),l=Math.max(...i),u=Math.min(...i),d=l-u||1,p=300,g=100,y=20,x=p-y*2,_=g-y*2,j=i.map((V,L)=>{const ee=y+L/(i.length-1)*x,Y=y+_-(V-u)/d*_;return{x:ee,y:Y,value:V}}),O=j.map((V,L)=>`${L===0?"M":"L"} ${V.x} ${V.y}`).join(" "),$=O+` L ${j[j.length-1].x} ${y+_} L ${j[0].x} ${y+_} Z`;return r.jsxs("div",{className:"pb-trend-chart",children:[r.jsxs("svg",{viewBox:`0 0 ${p} ${g}`,preserveAspectRatio:"xMidYMid meet",children:[r.jsx("defs",{children:r.jsxs("linearGradient",{id:"trendGradientJr",x1:"0",y1:"0",x2:"0",y2:"1",children:[r.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),r.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),r.jsx("path",{d:$,fill:"url(#trendGradientJr)"}),r.jsx("path",{d:O,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),j.map((V,L)=>r.jsx("circle",{cx:V.x,cy:V.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},L))]}),r.jsx("div",{className:"pb-trend-labels",children:n.map((V,L)=>r.jsxs("span",{className:"pb-trend-label",children:[V.month.split("-")[1],"/",V.month.split("-")[0].slice(2)]},L))})]})}function K6(){const[n,e]=b.useState("bests"),[t,i]=b.useState([]),[l,u]=b.useState(!0),[d,p]=b.useState(!1),[g,y]=b.useState(0),[x,_]=b.useState(!1),[j,O]=b.useState(!1),[$,V]=b.useState(!1),[L,ee]=b.useState({}),[Y,te]=b.useState({}),[ke,Te]=b.useState({}),[xe,R]=b.useState({}),[T,S]=b.useState({}),[D,I]=b.useState(!1),[U,M]=b.useState({}),[ze,gt]=b.useState([]),[B,se]=b.useState(null),[ge,Re]=b.useState(null),[Q,P]=b.useState(!1),[ae,Be]=b.useState(""),[Ue,Oe]=b.useState(""),Ie=b.useRef(null),ot=b.useRef(0),yt=b.useRef(0),et=b.useRef("right"),Xt=b.useCallback(F=>{y(fe=>{const Se=Math.max(0,Math.min(ka.length-1,F));return Se===fe?fe:(et.current=Se>fe?"right":"left",Se)})},[]),{currentUser:Es,isClient:Ot,clientData:wt,loading:oe}=Rr(),{isDark:Ct}=Ia(),kt=Zn(),zt=b.useCallback((F,fe="info")=>{Re({message:F,type:fe}),setTimeout(()=>Re(null),4e3)},[]);b.useEffect(()=>{!oe&&(!Es||!Ot)&&kt("/")},[Es,Ot,oe,kt]),b.useEffect(()=>{wt&&Et()},[wt]);const Et=async()=>{try{const F=Fs($t(pe,"juniorPBs"),bs("clientId","==",wt.id)),Se=(await Is(F)).docs.map(lt=>({id:lt.id,...lt.data()}));Se.sort((lt,Bt)=>lt.month.localeCompare(Bt.month)),i(Se);const Ee=Fs($t(pe,"juniorPBTargets"),bs("clientId","==",wt.id)),Ne=await Is(Ee);if(!Ne.empty){const lt=Ne.docs[0].data();Te(lt.targets||{}),R(lt.metricTargets||{}),S(lt.targets||{}),M(lt.metricTargets||{})}const mt=Fs($t(pe,"juniorAchievements"),bs("clientId","==",wt.id)),Nt=await Is(mt);Nt.empty||gt(Nt.docs[0].data().badges||[])}catch(F){console.error("Error fetching junior personal bests:",F)}u(!1)},jt=H6(),tt=t.find(F=>F.month===jt),Mt=t.filter(F=>F.month<jt),qt=Mt.length>0?Mt[Mt.length-1]:null;b.useEffect(()=>{tt?(ee(tt.benchmarks||{}),te(tt.bodyMetrics||{})):(ee({}),te({}))},[tt?.id]);const ms=async(F,fe)=>{const Se=[];if(F==="strength"?ka.forEach(Ee=>{const Ne=ke[Ee.key];if(!Ne)return;const mt=fe[Ee.key];if(!mt)return;let Nt;if(Ne.targetType==="time"){if(!Ne.targetValue)return;const lt=Ne.startValue||0,Bt=mt.time||0,Dt=Ne.targetValue-lt;Nt=Dt===0?Bt>=Ne.targetValue?1:0:Math.max(0,(Bt-lt)/Dt)}else if(Ne.targetType==="reps"){if(!Ne.targetReps)return;const lt=Ne.startReps||0,Bt=mt.reps||0,Dt=Ne.targetReps-lt;Nt=Dt===0?Bt>=Ne.targetReps?1:0:Math.max(0,(Bt-lt)/Dt)}else if(Ne.targetType==="distance"){if(!Ne.targetDistance)return;const lt=Ne.startDistance||0,Bt=mt.distance||0,Dt=Ne.targetDistance-lt;Nt=Dt===0?Bt>=Ne.targetDistance?1:0:Math.max(0,(Bt-lt)/Dt)}else{if(!Ne.targetWeight&&!Ne.targetReps)return;const lt=(Ne.startWeight||0)*(Ne.startReps||0),Bt=(Ne.targetWeight||0)*(Ne.targetReps||0),Dt=(mt.weight||0)*(mt.reps||0),Xs=Bt-lt;Nt=Xs===0?Dt>=Bt?1:0:Math.max(0,(Dt-lt)/Xs)}if(Nt>=1){let lt,Bt;Ne.targetType==="time"?(lt=ze.some(Dt=>Dt.type==="strength"&&Dt.key===Ee.key&&Dt.targetValue===Ne.targetValue),Bt=`${Ee.name} ${Ne.targetValue}s`):Ne.targetType==="reps"?(lt=ze.some(Dt=>Dt.type==="strength"&&Dt.key===Ee.key&&Dt.targetReps===Ne.targetReps),Bt=`${Ee.name} ${Ne.targetReps} reps`):Ne.targetType==="distance"?(lt=ze.some(Dt=>Dt.type==="strength"&&Dt.key===Ee.key&&Dt.targetDistance===Ne.targetDistance),Bt=`${Ee.name} ${Ne.targetDistance}cm`):(lt=ze.some(Dt=>Dt.type==="strength"&&Dt.key===Ee.key&&Dt.targetWeight===Ne.targetWeight&&Dt.targetReps===Ne.targetReps),Bt=`${Ee.name} ${Ne.targetWeight}kg  ${Ne.targetReps}`),lt||Se.push({type:"strength",key:Ee.key,...Ne.targetType==="time"?{targetType:"time",targetValue:Ne.targetValue}:Ne.targetType==="reps"?{targetType:"reps",targetReps:Ne.targetReps}:Ne.targetType==="distance"?{targetType:"distance",targetDistance:Ne.targetDistance}:{targetWeight:Ne.targetWeight,targetReps:Ne.targetReps},achievedMonth:jt,label:Bt})}}):qo.forEach(Ee=>{const Ne=xe[Ee.key];if(!Ne||!Ne.targetValue)return;const mt=fe[Ee.key];if(mt==null)return;const Nt=Ne.startValue||0,lt=Ne.targetValue,Bt=lt-Nt;(Bt===0?mt===lt?1:0:Math.max(0,(mt-Nt)/Bt))>=1&&(ze.some(vn=>vn.type==="metric"&&vn.key===Ee.key&&vn.targetValue===lt)||Se.push({type:"metric",key:Ee.key,targetValue:lt,achievedMonth:jt,label:`${Ee.name} ${lt}${Ee.suffix}`}))}),Se.length>0){const Ee=[...ze,...Se];await Ms(We(pe,"juniorAchievements",wt.id),{clientId:wt.id,badges:Ee,updatedAt:Rt.now()}),gt(Ee),se(Se),setTimeout(()=>se(null),5e3)}},Ft=(F,fe)=>{if(F==="strength"){const Se=ke[fe];if(!Se)return!1;switch(ka.find(Ne=>Ne.key===fe)?.unit){case"time":return ze.some(Ne=>Ne.type==="strength"&&Ne.key===fe&&Ne.targetValue===Se.targetValue);case"reps":return ze.some(Ne=>Ne.type==="strength"&&Ne.key===fe&&Ne.targetReps===Se.targetReps);case"distance":return ze.some(Ne=>Ne.type==="strength"&&Ne.key===fe&&Ne.targetDistance===Se.targetDistance);default:return!Se.targetWeight&&!Se.targetReps?!1:ze.some(Ne=>Ne.type==="strength"&&Ne.key===fe&&Ne.targetWeight===Se.targetWeight&&Ne.targetReps===Se.targetReps)}}else{const Se=xe[fe];return!Se||!Se.targetValue?!1:ze.some(Ee=>Ee.type==="metric"&&Ee.key===fe&&Ee.targetValue===Se.targetValue)}},At=async()=>{p(!0);try{const F=`${wt.id}_${jt}`,fe=tt||{};await Ms(We(pe,"juniorPBs",F),{clientId:wt.id,month:jt,benchmarks:L,bodyMetrics:fe.bodyMetrics||Y||{},createdAt:fe.createdAt||Rt.now(),updatedAt:Rt.now()}),await ms("strength",L),zt("Benchmarks saved!","success"),_(!1),await Et()}catch(F){console.error("Error saving benchmarks:",F),zt("Failed to save. Please try again.","error")}p(!1)},us=async()=>{p(!0);try{const F=`${wt.id}_${jt}`,fe=tt||{};await Ms(We(pe,"juniorPBs",F),{clientId:wt.id,month:jt,benchmarks:fe.benchmarks||L||{},bodyMetrics:Y,createdAt:fe.createdAt||Rt.now(),updatedAt:Rt.now()}),await ms("metric",Y),zt("Body metrics saved!","success"),O(!1),await Et()}catch(F){console.error("Error saving metrics:",F),zt("Failed to save. Please try again.","error")}p(!1)},vs=(F,fe,Se)=>{ee(Ee=>({...Ee,[F]:{...Ee[F],[fe]:Se===""?"":parseFloat(Se)}}))},as=(F,fe)=>{te(Se=>({...Se,[F]:fe===""?"":parseFloat(fe)}))},nn=(F,fe,Se)=>{S(Ee=>({...Ee,[F]:{...Ee[F],[fe]:Se===""?"":parseFloat(Se)}}))},Ds=async()=>{p(!0);try{const F=`targets_${wt.id}`,fe=tt?.benchmarks||{},Se={};ka.forEach(Ee=>{const Ne=fe[Ee.key];switch(Ee.unit){case"time":T[Ee.key]?.targetValue&&(Se[Ee.key]={targetType:"time",targetValue:T[Ee.key].targetValue,startValue:Ne?.time||0});break;case"reps":T[Ee.key]?.targetReps&&(Se[Ee.key]={targetType:"reps",targetReps:T[Ee.key].targetReps,startReps:Ne?.reps||0});break;case"distance":T[Ee.key]?.targetDistance&&(Se[Ee.key]={targetType:"distance",targetDistance:T[Ee.key].targetDistance,startDistance:Ne?.distance||0});break;default:(T[Ee.key]?.targetWeight||T[Ee.key]?.targetReps)&&(Se[Ee.key]={targetWeight:T[Ee.key].targetWeight||0,targetReps:T[Ee.key].targetReps||0,startWeight:Ne?.weight||0,startReps:Ne?.reps||0})}}),await Ms(We(pe,"juniorPBTargets",F),{clientId:wt.id,targets:Se,metricTargets:xe,updatedAt:Rt.now()}),Te(Se),S(Se),zt("Targets saved!","success"),V(!1)}catch(F){console.error("Error saving targets:",F),zt("Failed to save targets.","error")}p(!1)},Hs=(F,fe)=>{M(Se=>({...Se,[F]:{...Se[F],targetValue:fe===""?"":parseFloat(fe)}}))},is=async()=>{p(!0);try{const F=`targets_${wt.id}`,fe={};qo.forEach(Se=>{if(U[Se.key]?.targetValue){const Ee=tt?.bodyMetrics?.[Se.key]||0;fe[Se.key]={targetValue:U[Se.key].targetValue,startValue:Ee}}}),await Ms(We(pe,"juniorPBTargets",F),{clientId:wt.id,targets:ke,metricTargets:fe,updatedAt:Rt.now()}),R(fe),M(fe),zt("Metric targets saved!","success"),I(!1)}catch(F){console.error("Error saving metric targets:",F),zt("Failed to save targets.","error")}p(!1)},xs=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){p(!0);try{const F=We(pe,"juniorPBTargets",`targets_${wt.id}`);await Tr(F),Te({}),R({}),S({}),M({}),zt("All goals have been reset","success")}catch(F){console.error("Error resetting targets:",F),zt("Failed to reset goals","error")}p(!1)}},ye=(F,fe)=>{const Se=ke[F];if(!Se||!fe)return null;if(Se.targetType==="time"){if(!Se.targetValue)return null;const lt=Se.startValue||0,Bt=Se.targetValue,Dt=fe.time||0,Xs=Bt-lt;return Xs<=0?Dt>=Bt?1:0:Math.max(0,Math.min((Dt-lt)/Xs,1))}if(Se.targetType==="reps"){if(!Se.targetReps)return null;const lt=Se.startReps||0,Bt=Se.targetReps,Dt=fe.reps||0,Xs=Bt-lt;return Xs<=0?Dt>=Bt?1:0:Math.max(0,Math.min((Dt-lt)/Xs,1))}if(Se.targetType==="distance"){if(!Se.targetDistance)return null;const lt=Se.startDistance||0,Bt=Se.targetDistance,Dt=fe.distance||0,Xs=Bt-lt;return Xs<=0?Dt>=Bt?1:0:Math.max(0,Math.min((Dt-lt)/Xs,1))}if(!Se.targetWeight&&!Se.targetReps)return null;const Ee=(Se.startWeight||0)*(Se.startReps||0),Ne=(Se.targetWeight||0)*(Se.targetReps||0),mt=(fe.weight||0)*(fe.reps||0),Nt=Ne-Ee;return Nt<=0?mt>=Ne?1:0:Math.max(0,Math.min((mt-Ee)/Nt,1))},Me=F=>{const fe=xe[F];if(!fe||!fe.targetValue)return null;const Se=tt?.bodyMetrics?.[F];if(Se==null)return null;const Ee=fe.startValue||0,Ne=fe.targetValue,mt=Ne-Ee;return mt===0?Se===Ne?1:0:Math.max(0,Math.min((Se-Ee)/mt,1))},De=F=>{ot.current=F.touches[0].clientX,yt.current=0},Qe=F=>{yt.current=F.touches[0].clientX-ot.current},He=()=>{yt.current<-50?Xt(g+1):yt.current>50&&Xt(g-1),yt.current=0},Xe=F=>{const fe=tt?.bodyMetrics?.[F],Se=qt?.bodyMetrics?.[F];return fe==null||Se==null?null:parseFloat((fe-Se).toFixed(2))},ut=t.find(F=>F.month===ae),J=t.find(F=>F.month===Ue);if(oe||l)return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsxs("main",{className:"pb-main",children:[r.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),r.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!Es||!Ot||!wt)return null;const ne=ka[g],$e=tt?.benchmarks?.[ne.key],bt=qt?.benchmarks?.[ne.key],Ye=zl(ne,$e),vt=zl(ne,bt),X=sg(Ye,vt),Ae=ye(ne.key,$e),Ge=Ae!==null,ht=Ae!==null&&Ae>=1,Je=Ge?Math.round(Ae*60):Ye>0?15:0,Kt=ke[ne.key],Ht=F=>F?F.targetType==="time"?`${F.startValue||0}s  ${F.targetValue}s`:F.targetType==="reps"?`${F.startReps||0}  ${F.targetReps} reps`:F.targetType==="distance"?`${F.startDistance||0}  ${F.targetDistance}cm`:`${F.startWeight||0}kg${F.startReps||0}  ${F.targetWeight}kg${F.targetReps}`:null;return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>kt("/client"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsxs("main",{className:"pb-main page-transition-enter",children:[r.jsxs("div",{className:"pb-intro",children:[r.jsx("h2",{children:"Junior Strength Tests"}),r.jsx("p",{children:"Track your strength test results and body measurements each month."})]}),r.jsxs("div",{className:"pb-tabs",children:[r.jsx("button",{className:`pb-tab ${n==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),r.jsx("button",{className:`pb-tab ${n==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),r.jsx("button",{className:`pb-tab ${n==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),n==="bests"&&r.jsxs("div",{className:"pb-strength-section",children:[!x&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-carousel",ref:Ie,onTouchStart:De,onTouchMove:Qe,onTouchEnd:He,children:[r.jsx("div",{className:`pb-ring-container slide-from-${et.current}`,children:r.jsxs("div",{className:"pb-ring",children:[r.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:Tm.map((F,fe)=>{const Se=fe<Math.round(Je);return r.jsx("line",{x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,className:`pb-ring-tick ${Se?ht?"hit":"filled":"empty"}`,strokeWidth:F.thick?"3":"2"},fe)})}),r.jsxs("div",{className:"pb-ring-center",children:[r.jsx("div",{className:"pb-ring-category",children:ne.category}),r.jsxs("div",{className:"pb-ring-exercise",children:[ne.name,Ft("strength",ne.key)&&r.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),r.jsx("div",{className:"pb-ring-value",children:$e?fh(ne,$e):"-"}),X!==null&&r.jsxs("div",{className:`pb-ring-change ${X>=0?"positive":"negative"}`,children:[X>=0?"+":"",X.toFixed(1),"%"]}),X===null&&$e&&r.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),Kt&&r.jsx("div",{className:`pb-ring-target ${ht?"hit":""}`,children:ht?"Target hit!":Ht(Kt)}),!Kt&&r.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},g),r.jsx("div",{className:"pb-carousel-dots",children:ka.map((F,fe)=>r.jsx("button",{className:`pb-dot ${fe===g?"active":""}`,onClick:()=>Xt(fe)},fe))}),r.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>Xt(g-1),disabled:g===0,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),r.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>Xt(g+1),disabled:g===ka.length-1,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),r.jsxs("div",{className:"pb-trend-section",children:[r.jsx("h4",{children:"Trend"}),r.jsx(G6,{data:t,exerciseKey:ne.key,unit:ne.unit})]})]}),!x&&!$&&r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>_(!0),children:tt?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>V(!0),children:Object.keys(ke).length>0?"Edit Targets":"Set Targets"}),(Object.keys(ke).length>0||Object.keys(xe).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:xs,disabled:d,children:"Reset All Goals"})]}),x&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Benchmarks - ",ja(jt)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{_(!1),ee(tt?.benchmarks||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:ka.map(F=>r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:F.name}),F.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:L[F.key]?.weight??"",onChange:fe=>vs(F.key,"weight",fe.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",value:L[F.key]?.reps??"",onChange:fe=>vs(F.key,"reps",fe.target.value),placeholder:"0"})]})]}):F.unit==="reps"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Reps (max in 1 min)"}),r.jsx("input",{type:"number",value:L[F.key]?.reps??"",onChange:fe=>vs(F.key,"reps",fe.target.value),placeholder:"0"})]})}):F.unit==="distance"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Distance (cm)"}),r.jsx("input",{type:"number",step:"0.5",value:L[F.key]?.distance??"",onChange:fe=>vs(F.key,"distance",fe.target.value),placeholder:"0"})]})}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Time (seconds)"}),r.jsx("input",{type:"number",step:"0.01",value:L[F.key]?.time??"",onChange:fe=>vs(F.key,"time",fe.target.value),placeholder:"0"})]})})]},F.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{_(!1),ee(tt?.benchmarks||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:At,disabled:d,children:d?"Saving...":"Save"})]})]}),$&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Set Your Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{V(!1),S(ke)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),ka.map(F=>{const fe=tt?.benchmarks?.[F.key];let Se="-";if(fe)switch(F.unit){case"weight":(fe.weight||fe.reps)&&(Se=`${fe.weight||0}kg  ${fe.reps||0}`);break;case"time":fe.time&&(Se=`${fe.time}s`);break;case"reps":fe.reps&&(Se=`${fe.reps} reps`);break;case"distance":fe.distance&&(Se=`${fe.distance} cm`);break}return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:F.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",Se]})]}),F.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:T[F.key]?.targetWeight??"",onChange:Ee=>nn(F.key,"targetWeight",Ee.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Reps"}),r.jsx("input",{type:"number",value:T[F.key]?.targetReps??"",onChange:Ee=>nn(F.key,"targetReps",Ee.target.value),placeholder:"0"})]})]}):F.unit==="reps"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target Reps (in 1 min)"}),r.jsx("input",{type:"number",value:T[F.key]?.targetReps??"",onChange:Ee=>nn(F.key,"targetReps",Ee.target.value),placeholder:"0"})]})}):F.unit==="distance"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target Distance (cm)"}),r.jsx("input",{type:"number",step:"0.5",value:T[F.key]?.targetDistance??"",onChange:Ee=>nn(F.key,"targetDistance",Ee.target.value),placeholder:"0"})]})}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target (seconds)"}),r.jsx("input",{type:"number",step:"1",value:T[F.key]?.targetValue??"",onChange:Ee=>nn(F.key,"targetValue",Ee.target.value),placeholder:"0"})]})})]},F.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{V(!1),S(ke)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Ds,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="metrics"&&r.jsxs("div",{className:"pb-metrics-section",children:[!j&&!D&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-metrics-card",children:[r.jsx("h3",{children:"Body Measurements"}),r.jsx("p",{className:"pb-metrics-month",children:ja(jt)}),r.jsx("div",{className:"pb-metrics-list",children:qo.map(F=>{const fe=tt?.bodyMetrics?.[F.key],Se=Xe(F.key),Ee=xe[F.key],Ne=Me(F.key),mt=Ne!==null&&Ne>=1;return r.jsxs("div",{className:"pb-metric-row",children:[r.jsxs("div",{className:"pb-metric-top",children:[r.jsxs("div",{className:"pb-metric-left",children:[r.jsxs("span",{className:"pb-metric-name",children:[F.name,Ft("metric",F.key)&&r.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),Ee&&r.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",Ee.targetValue," ",F.suffix]})]}),r.jsxs("div",{className:"pb-metric-values",children:[r.jsx("span",{className:"pb-metric-current",children:fe!=null?`${fe} ${F.suffix}`:"-"}),Se!==null&&r.jsxs("span",{className:`pb-metric-change ${Se>0?"up":Se<0?"down":"same"}`,children:[Se>0?"+":"",Se," ",F.suffix]})]})]}),Ne!==null&&r.jsxs("div",{className:"pb-metric-progress",children:[r.jsx("div",{className:"pb-metric-bar",children:r.jsx("div",{className:`pb-metric-bar-fill ${mt?"hit":""}`,style:{width:`${Math.round(Ne*100)}%`}})}),r.jsx("span",{className:`pb-metric-percent ${mt?"hit":""}`,children:mt?"Hit!":`${Math.round(Ne*100)}%`})]})]},F.key)})})]}),r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>O(!0),children:tt?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>I(!0),children:Object.keys(xe).length>0?"Edit Targets":"Set Targets"}),(Object.keys(ke).length>0||Object.keys(xe).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:xs,disabled:d,children:"Reset All Goals"})]})]}),j&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Measurements - ",ja(jt)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{O(!1),te(tt?.bodyMetrics||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:qo.map(F=>r.jsx("div",{className:"pb-edit-metric",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:[F.name," (",F.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:Y[F.key]??"",onChange:fe=>as(F.key,fe.target.value),placeholder:"0"})]})},F.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{O(!1),te(tt?.bodyMetrics||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:us,disabled:d,children:d?"Saving...":"Save"})]})]}),D&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Body Metric Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{I(!1),M(xe)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),qo.map(F=>{const fe=tt?.bodyMetrics?.[F.key];return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:F.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",fe!=null?`${fe} ${F.suffix}`:"-"]})]}),r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:["Target (",F.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:U[F.key]?.targetValue??"",onChange:Se=>Hs(F.key,Se.target.value),placeholder:"0"})]})})]},F.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{I(!1),M(xe)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:is,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="history"&&r.jsx("div",{className:"pb-history-section",children:t.length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("h4",{children:"No records yet"}),r.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):r.jsxs(r.Fragment,{children:[ze.length>0&&r.jsxs("div",{className:"pb-achievements-wall",children:[r.jsxs("h4",{className:"pb-achievements-wall-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),r.jsx("div",{className:"pb-achievements-list",children:[...ze].reverse().map((F,fe)=>r.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${fe*.05}s`},children:[r.jsx("div",{className:"pb-achievement-star",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("div",{className:"pb-achievement-info",children:[r.jsx("span",{className:"pb-achievement-label",children:F.label}),r.jsx("span",{className:"pb-achievement-date",children:ja(F.achievedMonth)})]})]},fe))})]}),r.jsx("div",{className:"pb-history-controls",children:r.jsx("button",{className:`pb-compare-toggle ${Q?"active":""}`,onClick:()=>{P(!Q),!Q&&t.length>=2&&(Be(t[0].month),Oe(t[t.length-1].month))},children:Q?"Back to Timeline":"Compare Months"})}),Q?r.jsxs("div",{className:"pb-compare",children:[r.jsxs("div",{className:"pb-compare-selectors",children:[r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"From"}),r.jsx("select",{value:ae,onChange:F=>Be(F.target.value),children:t.map(F=>r.jsx("option",{value:F.month,children:ja(F.month)},F.month))})]}),r.jsx("div",{className:"pb-compare-vs",children:"vs"}),r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"To"}),r.jsx("select",{value:Ue,onChange:F=>Oe(F.target.value),children:t.map(F=>r.jsx("option",{value:F.month,children:ja(F.month)},F.month))})]})]}),ut&&J&&r.jsxs("div",{className:"pb-compare-results",children:[r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Strength Tests"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Exercise"}),r.jsx("span",{children:ja(ae).split(" ")[0]}),r.jsx("span",{children:ja(Ue).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),ka.map(F=>{const fe=ut.benchmarks?.[F.key],Se=J.benchmarks?.[F.key],Ee=zl(F,fe),Ne=zl(F,Se),mt=sg(Ne,Ee);return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:F.name}),r.jsx("span",{className:"pb-compare-val",children:fe?fh(F,fe):"-"}),r.jsx("span",{className:"pb-compare-val",children:Se?fh(F,Se):"-"}),r.jsx("span",{className:`pb-compare-change ${mt!==null?mt>=0?"positive":"negative":""}`,children:mt!==null?`${mt>=0?"+":""}${mt.toFixed(1)}%`:"-"})]},F.key)})]})]}),r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Body Measurements"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Measurement"}),r.jsx("span",{children:ja(ae).split(" ")[0]}),r.jsx("span",{children:ja(Ue).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),qo.map(F=>{const fe=ut.bodyMetrics?.[F.key],Se=J.bodyMetrics?.[F.key],Ee=fe!=null&&Se!=null?parseFloat((Se-fe).toFixed(2)):null;return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:F.name}),r.jsx("span",{className:"pb-compare-val",children:fe!=null?`${fe}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:Se!=null?`${Se}`:"-"}),r.jsx("span",{className:`pb-compare-change ${Ee!==null?Ee>0?"positive":Ee<0?"negative":"neutral":""}`,children:Ee!==null?`${Ee>0?"+":""}${Ee} ${F.suffix}`:"-"})]},F.key)})]})]})]})]}):r.jsx("div",{className:"pb-timeline",children:[...t].reverse().map((F,fe)=>{const Se=t.filter(Ee=>Ee.month<F.month).pop();return r.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${fe*.05}s`},children:[r.jsx("div",{className:"pb-timeline-dot"}),r.jsxs("div",{className:"pb-timeline-card",children:[r.jsx("h4",{children:ja(F.month)}),F.benchmarks&&Object.keys(F.benchmarks).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Strength Tests"}),ka.map(Ee=>{const Ne=F.benchmarks[Ee.key];if(!Ne)return null;const mt=Se?.benchmarks?.[Ee.key],Nt=zl(Ee,Ne),lt=zl(Ee,mt),Bt=sg(Nt,lt);return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:Ee.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsx("span",{className:"pb-timeline-value",children:fh(Ee,Ne)}),Bt!==null&&r.jsxs("span",{className:`pb-timeline-change ${Bt>=0?"positive":"negative"}`,children:[Bt>=0?"+":"",Bt.toFixed(1),"%"]})]})]},Ee.key)})]}),F.bodyMetrics&&Object.keys(F.bodyMetrics).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Body Measurements"}),qo.map(Ee=>{const Ne=F.bodyMetrics[Ee.key];if(Ne==null)return null;const mt=Se?.bodyMetrics?.[Ee.key],Nt=mt!=null?parseFloat((Ne-mt).toFixed(2)):null;return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:Ee.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsxs("span",{className:"pb-timeline-value",children:[Ne," ",Ee.suffix]}),Nt!==null&&r.jsxs("span",{className:`pb-timeline-change ${Nt>0?"positive":Nt<0?"negative":"neutral"}`,children:[Nt>0?"+":"",Nt," ",Ee.suffix]})]})]},Ee.key)})]})]})]},F.id)})})]})})]}),B&&r.jsx("div",{className:"pb-celebration-overlay",onClick:()=>se(null),children:r.jsxs("div",{className:"pb-celebration-card",children:[r.jsx("div",{className:"pb-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pb-celebration-title",children:B.length===1?"Target Achieved!":`${B.length} Targets Achieved!`}),r.jsx("div",{className:"pb-celebration-badges",children:B.map((F,fe)=>r.jsx("div",{className:"pb-celebration-badge",children:F.label},fe))}),r.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),ge&&r.jsxs("div",{className:`toast-notification ${ge.type}`,children:[r.jsx("span",{className:"toast-icon",children:ge.type==="success"?r.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),r.jsx("span",{className:"toast-message",children:ge.message}),r.jsx("button",{className:"toast-close",onClick:()=>Re(null),children:""})]}),r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:"block-nav-tab",onClick:()=>kt("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),r.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),r.jsx("span",{children:"Home"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>kt("/client/forms"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),r.jsx("polyline",{points:"14 2 14 8 20 8"}),r.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),r.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),r.jsx("span",{children:"Forms"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>kt("/client/tools"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),r.jsx("span",{children:"Tools"})]}),r.jsxs("button",{className:"block-nav-tab active",children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20V10"}),r.jsx("path",{d:"M18 20V4"}),r.jsx("path",{d:"M6 20v-4"})]}),r.jsx("span",{children:"PBs"})]}),wt?.circuitAccess&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>kt("/client/circuit"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 6v6l4 2"})]}),r.jsx("span",{children:"Circuit"})]})]})]})}const Y6=[{key:"push",label:"Push",subtitle:"Chest / Shoulders / Triceps",color:"#A12F3A",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4"},{key:"pull",label:"Pull",subtitle:"Back / Biceps",color:"#2196f3",icon:"M4 12h16M12 4v16M7 7l10 10M17 7L7 17"},{key:"lower",label:"Lower",subtitle:"Legs / Glutes",color:"#ff9800",icon:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"},{key:"core",label:"Core",subtitle:"Abs / Stability",color:"#7c3aed",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"}],Qk={};Yk.forEach(n=>{Qk[n.name]=n.group});function Q6(n){return Qk[n]||null}const Va=[{key:"chestPress",name:"Chest Press",category:"Upper Body - Push",unit:"weight"},{key:"shoulderPress",name:"Shoulder Press",category:"Upper Body - Push",unit:"weight"},{key:"seatedRow",name:"Seated Row",category:"Upper Body - Pull",unit:"weight"},{key:"latPulldown",name:"Lat Pulldown",category:"Upper Body - Pull",unit:"weight"},{key:"squat",name:"Squat",category:"Lower Body",unit:"weight"},{key:"deadlift",name:"Deadlift",category:"Lower Body",unit:"weight"},{key:"plank",name:"Plank",category:"Core",unit:"time"}],Ho=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function X6(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}function Ta(n){const[e,t]=n.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function ph(n){if(!n&&n!==0)return"-";const e=Math.floor(n/60),t=(n%60).toFixed(2);return e>0?`${e}m ${parseFloat(t).toFixed(0)}s`:`${parseFloat(t).toFixed(2)}s`}function B2(n,e){return!n&&n!==0?"-":!e&&e!==0?`${n}kg`:`${n}kg x ${e}`}function ql(n,e){return e?n.unit==="time"?e.time||0:(e.weight||0)*(e.reps||0):0}function ng(n,e){return!e||e===0?null:(n-e)/e*100}function J6({data:n,exerciseKey:e,unit:t}){if(!n||n.length<2)return r.jsx("div",{className:"pb-trend-empty",children:r.jsx("p",{children:"Not enough data for trend line yet"})});const i=n.map(V=>{const L=V.benchmarks?.[e];return L?t==="time"?L.time||0:(L.weight||0)*(L.reps||0):0}),l=Math.max(...i),u=Math.min(...i),d=l-u||1,p=300,g=100,y=20,x=p-y*2,_=g-y*2,j=i.map((V,L)=>{const ee=y+L/(i.length-1)*x,Y=y+_-(V-u)/d*_;return{x:ee,y:Y,value:V}}),O=j.map((V,L)=>`${L===0?"M":"L"} ${V.x} ${V.y}`).join(" "),$=O+` L ${j[j.length-1].x} ${y+_} L ${j[0].x} ${y+_} Z`;return r.jsxs("div",{className:"pb-trend-chart",children:[r.jsxs("svg",{viewBox:`0 0 ${p} ${g}`,preserveAspectRatio:"xMidYMid meet",children:[r.jsx("defs",{children:r.jsxs("linearGradient",{id:"trendGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[r.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),r.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),r.jsx("path",{d:$,fill:"url(#trendGradient)"}),r.jsx("path",{d:O,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),j.map((V,L)=>r.jsx("circle",{cx:V.x,cy:V.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},L))]}),r.jsx("div",{className:"pb-trend-labels",children:n.map((V,L)=>r.jsxs("span",{className:"pb-trend-label",children:[V.month.split("-")[1],"/",V.month.split("-")[0].slice(2)]},L))})]})}function Z6(){const[n,e]=b.useState("bests"),[t,i]=b.useState([]),[l,u]=b.useState(!0),[d,p]=b.useState(!1),[g,y]=b.useState(0),[x,_]=b.useState(!1),[j,O]=b.useState(!1),[$,V]=b.useState(!1),[L,ee]=b.useState({}),[Y,te]=b.useState({}),[ke,Te]=b.useState({}),[xe,R]=b.useState({}),[T,S]=b.useState({}),[D,I]=b.useState(!1),[U,M]=b.useState({}),[ze,gt]=b.useState([]),[B,se]=b.useState(null),[ge,Re]=b.useState(null),[Q,P]=b.useState(!1),[ae,Be]=b.useState(""),[Ue,Oe]=b.useState(""),[Ie,ot]=b.useState({}),[yt,et]=b.useState({}),[Xt,Es]=b.useState(null),[Ot,wt]=b.useState(null),[oe,Ct]=b.useState(""),[kt,zt]=b.useState({}),Et=b.useRef(null),jt=b.useRef(0),tt=b.useRef(0),Mt=b.useRef("right"),qt=b.useCallback(W=>{y(he=>{const ce=Math.max(0,Math.min(Va.length-1,W));return ce===he?he:(Mt.current=ce>he?"right":"left",ce)})},[]),{currentUser:ms,isClient:Ft,clientData:At,loading:us}=Rr(),{isDark:vs}=Ia(),as=Zn(),[nn]=hN(),Ds=nn.get("mode")==="corebuddy",Hs=!Ds&&(!At?.clientType||At.clientType==="block"),is=b.useCallback((W,he="info")=>{Re({message:W,type:he}),setTimeout(()=>Re(null),4e3)},[]);b.useEffect(()=>{!us&&(!ms||!Ft)&&as("/")},[ms,Ft,us,as]),b.useEffect(()=>{At&&(Hs?xs():(async()=>{try{const[he,ce,_e]=await Promise.all([Os(We(pe,"coreBuddyPBs",At.id)),Os(We(pe,"coreBuddyTargets",At.id)),Os(We(pe,"coreBuddyAchievements",At.id))]);he.exists()&&ot(he.data().exercises||{}),ce.exists()&&et(ce.data().targets||{}),_e.exists()&&Es(_e.data())}catch(he){console.error("Error loading Core Buddy PBs:",he)}u(!1)})())},[At]);const xs=async()=>{try{const W=Fs($t(pe,"personalBests"),bs("clientId","==",At.id)),ce=(await Is(W)).docs.map(re=>({id:re.id,...re.data()}));ce.sort((re,Ke)=>re.month.localeCompare(Ke.month)),i(ce);const _e=Fs($t(pe,"personalBestTargets"),bs("clientId","==",At.id)),E=await Is(_e);if(!E.empty){const re=E.docs[0].data();Te(re.targets||{}),R(re.metricTargets||{}),S(re.targets||{}),M(re.metricTargets||{})}const z=Fs($t(pe,"achievements"),bs("clientId","==",At.id)),ie=await Is(z);ie.empty||gt(ie.docs[0].data().badges||[])}catch(W){console.error("Error fetching personal bests:",W)}u(!1)},ye=async()=>{if(!Ot||!oe||!At)return;const W=parseFloat(oe),he=Ie[Ot];if(!he||W<=he.weight){is("Target must be higher than current PB","error");return}p(!0);try{const ce={...yt,[Ot]:{targetWeight:W,setAt:Rt.now(),currentPBWhenSet:he.weight}};await Ms(We(pe,"coreBuddyTargets",At.id),{clientId:At.id,targets:ce,updatedAt:Rt.now()}),et(ce),wt(null),Ct(""),is("Target set!","success")}catch(ce){console.error("Error saving target:",ce),is("Failed to save target","error")}p(!1)},Me=W=>{if(!Xt?.badges)return!1;const he=yt[W];return he?Xt.badges.some(ce=>ce.type==="pb_target"&&ce.exercise===W&&ce.targetWeight===he.targetWeight):!1},De=W=>{const he=yt[W];if(!he)return null;const ce=Ie[W];if(!ce)return 0;const _e=he.currentPBWhenSet||0,E=he.targetWeight,z=E-_e;return z<=0?ce.weight>=E?1:0:Math.max(0,Math.min((ce.weight-_e)/z,1))},Qe=X6(),He=t.find(W=>W.month===Qe),Xe=t.filter(W=>W.month<Qe),ut=Xe.length>0?Xe[Xe.length-1]:null;b.useEffect(()=>{He?(ee(He.benchmarks||{}),te(He.bodyMetrics||{})):(ee({}),te({}))},[He?.id]);const J=async(W,he)=>{const ce=[];if(W==="strength"?Va.forEach(_e=>{const E=ke[_e.key];if(!E)return;const z=he[_e.key];if(!z)return;let ie;if(E.targetType==="time"){if(!E.targetValue)return;const re=E.startValue||0,Ke=z.time||0,rt=E.targetValue-re;ie=rt===0?Ke>=E.targetValue?1:0:Math.max(0,(Ke-re)/rt)}else{if(!E.targetWeight&&!E.targetReps)return;const re=(E.startWeight||0)*(E.startReps||0),Ke=(E.targetWeight||0)*(E.targetReps||0),rt=(z.weight||0)*(z.reps||0),st=Ke-re;ie=st===0?rt>=Ke?1:0:Math.max(0,(rt-re)/st)}if(ie>=1&&!(E.targetType==="time"?ze.some(Ke=>Ke.type==="strength"&&Ke.key===_e.key&&Ke.targetValue===E.targetValue):ze.some(Ke=>Ke.type==="strength"&&Ke.key===_e.key&&Ke.targetWeight===E.targetWeight&&Ke.targetReps===E.targetReps))){const Ke=E.targetType==="time"?`${_e.name} ${E.targetValue}s`:`${_e.name} ${E.targetWeight}kg  ${E.targetReps}`;ce.push({type:"strength",key:_e.key,...E.targetType==="time"?{targetType:"time",targetValue:E.targetValue}:{targetWeight:E.targetWeight,targetReps:E.targetReps},achievedMonth:Qe,label:Ke})}}):Ho.forEach(_e=>{const E=xe[_e.key];if(!E||!E.targetValue)return;const z=he[_e.key];if(z==null)return;const ie=E.startValue||0,re=E.targetValue,Ke=re-ie;(Ke===0?z===re?1:0:Math.max(0,(z-ie)/Ke))>=1&&(ze.some(It=>It.type==="metric"&&It.key===_e.key&&It.targetValue===re)||ce.push({type:"metric",key:_e.key,targetValue:re,achievedMonth:Qe,label:`${_e.name} ${re}${_e.suffix}`}))}),ce.length>0){const _e=[...ze,...ce];await Ms(We(pe,"achievements",At.id),{clientId:At.id,badges:_e,updatedAt:Rt.now()}),gt(_e),se(ce),setTimeout(()=>se(null),5e3)}},ne=(W,he)=>{if(W==="strength"){const ce=ke[he];return ce?ce.targetType==="time"?ze.some(_e=>_e.type==="strength"&&_e.key===he&&_e.targetValue===ce.targetValue):!ce.targetWeight&&!ce.targetReps?!1:ze.some(_e=>_e.type==="strength"&&_e.key===he&&_e.targetWeight===ce.targetWeight&&_e.targetReps===ce.targetReps):!1}else{const ce=xe[he];return!ce||!ce.targetValue?!1:ze.some(_e=>_e.type==="metric"&&_e.key===he&&_e.targetValue===ce.targetValue)}},$e=async()=>{p(!0);try{const W=`${At.id}_${Qe}`,he=He||{};await Ms(We(pe,"personalBests",W),{clientId:At.id,month:Qe,benchmarks:L,bodyMetrics:he.bodyMetrics||Y||{},createdAt:he.createdAt||Rt.now(),updatedAt:Rt.now()}),await J("strength",L),is("Benchmarks saved!","success"),_(!1),await xs()}catch(W){console.error("Error saving benchmarks:",W),is("Failed to save. Please try again.","error")}p(!1)},bt=async()=>{p(!0);try{const W=`${At.id}_${Qe}`,he=He||{};await Ms(We(pe,"personalBests",W),{clientId:At.id,month:Qe,benchmarks:he.benchmarks||L||{},bodyMetrics:Y,createdAt:he.createdAt||Rt.now(),updatedAt:Rt.now()}),await J("metric",Y),is("Body metrics saved!","success"),O(!1),await xs()}catch(W){console.error("Error saving metrics:",W),is("Failed to save. Please try again.","error")}p(!1)},Ye=(W,he,ce)=>{ee(_e=>({..._e,[W]:{..._e[W],[he]:ce===""?"":parseFloat(ce)}}))},vt=(W,he)=>{te(ce=>({...ce,[W]:he===""?"":parseFloat(he)}))},X=(W,he,ce)=>{S(_e=>({..._e,[W]:{..._e[W],[he]:ce===""?"":parseFloat(ce)}}))},Ae=async()=>{p(!0);try{const W=`targets_${At.id}`,he=He?.benchmarks||{},ce={};Va.forEach(_e=>{const E=he[_e.key];_e.unit==="time"?T[_e.key]?.targetValue&&(ce[_e.key]={targetType:"time",targetValue:T[_e.key].targetValue,startValue:E?.time||0}):(T[_e.key]?.targetWeight||T[_e.key]?.targetReps)&&(ce[_e.key]={targetWeight:T[_e.key].targetWeight||0,targetReps:T[_e.key].targetReps||0,startWeight:E?.weight||0,startReps:E?.reps||0})}),await Ms(We(pe,"personalBestTargets",W),{clientId:At.id,targets:ce,metricTargets:xe,updatedAt:Rt.now()}),Te(ce),S(ce),is("Targets saved!","success"),V(!1)}catch(W){console.error("Error saving targets:",W),is("Failed to save targets.","error")}p(!1)},Ge=(W,he)=>{M(ce=>({...ce,[W]:{...ce[W],targetValue:he===""?"":parseFloat(he)}}))},ht=async()=>{p(!0);try{const W=`targets_${At.id}`,he={};Ho.forEach(ce=>{if(U[ce.key]?.targetValue){const _e=He?.bodyMetrics?.[ce.key]||0;he[ce.key]={targetValue:U[ce.key].targetValue,startValue:_e}}}),await Ms(We(pe,"personalBestTargets",W),{clientId:At.id,targets:ke,metricTargets:he,updatedAt:Rt.now()}),R(he),M(he),is("Metric targets saved!","success"),I(!1)}catch(W){console.error("Error saving metric targets:",W),is("Failed to save targets.","error")}p(!1)},Je=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){p(!0);try{const W=We(pe,"personalBestTargets",`targets_${At.id}`);await Tr(W),Te({}),R({}),S({}),M({}),is("All goals have been reset","success")}catch(W){console.error("Error resetting targets:",W),is("Failed to reset goals","error")}p(!1)}},Kt=(W,he)=>{const ce=ke[W];if(!ce||!he)return null;if(ce.targetType==="time"){if(!ce.targetValue)return null;const re=ce.startValue||0,Ke=ce.targetValue,rt=he.time||0,st=Ke-re;return st<=0?rt>=Ke?1:0:Math.max(0,Math.min((rt-re)/st,1))}if(!ce.targetWeight&&!ce.targetReps)return null;const _e=(ce.startWeight||0)*(ce.startReps||0),E=(ce.targetWeight||0)*(ce.targetReps||0),z=(he.weight||0)*(he.reps||0),ie=E-_e;return ie<=0?z>=E?1:0:Math.max(0,Math.min((z-_e)/ie,1))},Ht=W=>{const he=xe[W];if(!he||!he.targetValue)return null;const ce=He?.bodyMetrics?.[W];if(ce==null)return null;const _e=he.startValue||0,E=he.targetValue,z=E-_e;return z===0?ce===E?1:0:Math.max(0,Math.min((ce-_e)/z,1))},F=W=>{jt.current=W.touches[0].clientX,tt.current=0},fe=W=>{tt.current=W.touches[0].clientX-jt.current},Se=()=>{tt.current<-50?qt(g+1):tt.current>50&&qt(g-1),tt.current=0},Ee=W=>{const he=He?.bodyMetrics?.[W],ce=ut?.bodyMetrics?.[W];return he==null||ce==null?null:parseFloat((he-ce).toFixed(2))},Ne=t.find(W=>W.month===ae),mt=t.find(W=>W.month===Ue);if(us||l)return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsxs("main",{className:"pb-main",children:[r.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),r.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!ms||!Ft||!At)return null;if(Hs&&At?.isJunior)return r.jsx(K6,{});const Nt=Va[g],lt=He?.benchmarks?.[Nt.key],Bt=ut?.benchmarks?.[Nt.key],Dt=ql(Nt,lt),Xs=ql(Nt,Bt),vn=ng(Dt,Xs),mn=Kt(Nt.key,lt),Nn=mn!==null,Ks=mn!==null&&mn>=1,cn=Nn?Math.round(mn*60):Dt>0?15:0,Ns=ke[Nt.key];return r.jsx(ga,{children:r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>as(Ds?"/client/core-buddy":"/client"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsxs("main",{className:"pb-main page-transition-enter",children:[r.jsxs("div",{className:"pb-intro anim-fade-up",children:[r.jsx("h2",{children:"Personal Bests"}),r.jsx("p",{children:Hs?"Track your strength benchmarks and body measurements each month.":"Your all-time best lifts from programme workouts."})]}),!Hs&&r.jsxs("div",{className:"pb-cb-section anim-fade-up-d2",children:[Object.keys(Ie).length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("div",{className:"pb-cb-empty-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})}),r.jsx("h4",{children:"No personal bests yet"}),r.jsx("p",{children:"Complete weight-based workouts to start tracking your personal bests."})]}):r.jsx("div",{className:"pb-cb-grouped",children:(()=>{const W={},he=[];return Object.entries(Ie).forEach(([ce,_e])=>{const E=Q6(ce);E?(W[E]||(W[E]=[]),W[E].push([ce,_e])):he.push([ce,_e])}),Object.values(W).forEach(ce=>ce.sort(([_e],[E])=>_e.localeCompare(E))),he.sort(([ce],[_e])=>ce.localeCompare(_e)),r.jsxs(r.Fragment,{children:[Y6.map(ce=>{const _e=W[ce.key];if(!_e||_e.length===0)return null;const E=!!kt[ce.key],z=_e.reduce((ie,[,re])=>!ie||re.weight>ie.weight?re:ie,null);return r.jsxs("div",{className:`pb-cb-group ${E?"open":""}`,style:{"--group-color":ce.color},children:[r.jsxs("button",{className:"pb-cb-group-header",onClick:()=>zt(ie=>({...ie,[ce.key]:!ie[ce.key]})),children:[r.jsx("div",{className:"pb-cb-group-accent"}),r.jsx("div",{className:"pb-cb-group-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:ce.icon})})}),r.jsxs("div",{className:"pb-cb-group-text",children:[r.jsx("h3",{className:"pb-cb-group-label",children:ce.label}),r.jsx("span",{className:"pb-cb-group-subtitle",children:ce.subtitle})]}),r.jsxs("div",{className:"pb-cb-group-meta",children:[r.jsxs("span",{className:"pb-cb-group-count",children:[_e.length," PB",_e.length!==1?"s":""]}),z&&r.jsxs("span",{className:"pb-cb-group-best",children:["Best: ",z.weight,"kg"]})]}),r.jsx("svg",{className:`pb-cb-group-chevron ${E?"open":""}`,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M6 9l6 6 6-6"})})]}),r.jsx("div",{className:"pb-cb-group-body",style:{display:E?"block":"none"},children:r.jsx("div",{className:"pb-cb-grid",children:_e.map(([ie,re],Ke)=>{const rt=yt[ie],st=De(ie),It=st!==null&&st>=1,ft=Me(ie),ds=st!==null?Math.round(st*60):60;return r.jsxs("div",{className:"pb-cb-card",style:{"--group-color":ce.color,animationDelay:`${Ke*.05}s`},children:[r.jsxs("div",{className:"pb-cb-card-top",children:[r.jsxs("div",{className:"pb-cb-card-ring",children:[r.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:j2.map((rn,wr)=>{const fs=wr<ds;return r.jsx("line",{x1:rn.x1,y1:rn.y1,x2:rn.x2,y2:rn.y2,className:`pb-ring-tick ${fs?It?"hit":"filled":"empty"}`,style:fs&&!It?{stroke:ce.color}:void 0,strokeWidth:rn.thick?"2":"1.5"},wr)})}),r.jsx("div",{className:"pb-cb-ring-icon",style:{color:ce.color},children:ft?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"pb-cb-badge-earned",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:ce.icon})})})]}),r.jsxs("div",{className:"pb-cb-card-info",children:[r.jsx("h4",{className:"pb-cb-card-name",children:ie}),r.jsxs("div",{className:"pb-cb-card-value",style:{color:ce.color},children:[re.weight,"kg  ",re.reps]}),re.achievedAt&&r.jsx("div",{className:"pb-cb-card-date",children:(re.achievedAt.toDate?re.achievedAt.toDate():new Date(re.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),rt&&It&&!ft&&r.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"}),ft&&r.jsx("div",{className:"pb-cb-target-info earned",children:"Badge earned!"})]}),r.jsx("div",{className:"pb-cb-card-action",children:r.jsx("button",{className:"pb-cb-target-btn",style:{borderColor:ce.color,background:`color-mix(in srgb, ${ce.color} 10%, transparent)`,color:ce.color},onClick:()=>{wt(ie),Ct("")},children:rt?It&&ft?r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 5v14M5 12h14"})}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("circle",{cx:"12",cy:"12",r:"6"}),r.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]}),rt&&!It&&r.jsxs("div",{className:"pb-cb-card-progress",children:[r.jsxs("div",{className:"pb-cb-progress-labels",children:[r.jsxs("span",{className:"pb-cb-progress-current",children:[re.weight,"kg"]}),r.jsxs("span",{className:"pb-cb-progress-target",style:{color:ce.color},children:["Target: ",rt.targetWeight,"kg"]})]}),r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill",style:{width:`${Math.round((st||0)*100)}%`,background:ce.color}})}),r.jsxs("div",{className:"pb-cb-progress-pct",style:{color:ce.color},children:[Math.round((st||0)*100),"%"]})]}),rt&&It&&r.jsx("div",{className:"pb-cb-card-progress",children:r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill hit",style:{width:"100%"}})})})]},ie)})})})]},ce.key)}),he.length>0&&(()=>{const ce=!!kt.other;return r.jsxs("div",{className:`pb-cb-group ${ce?"open":""}`,style:{"--group-color":"var(--text-tertiary)"},children:[r.jsxs("button",{className:"pb-cb-group-header",onClick:()=>zt(_e=>({..._e,other:!_e.other})),children:[r.jsx("div",{className:"pb-cb-group-accent"}),r.jsx("div",{className:"pb-cb-group-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})}),r.jsx("div",{className:"pb-cb-group-text",children:r.jsx("h3",{className:"pb-cb-group-label",children:"Other"})}),r.jsx("div",{className:"pb-cb-group-meta",children:r.jsxs("span",{className:"pb-cb-group-count",children:[he.length," PB",he.length!==1?"s":""]})}),r.jsx("svg",{className:`pb-cb-group-chevron ${ce?"open":""}`,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M6 9l6 6 6-6"})})]}),r.jsx("div",{className:"pb-cb-group-body",style:{display:ce?"block":"none"},children:r.jsx("div",{className:"pb-cb-grid",children:he.map(([_e,E],z)=>{const ie=yt[_e],re=De(_e),Ke=re!==null&&re>=1,rt=Me(_e),st=re!==null?Math.round(re*60):60;return r.jsxs("div",{className:"pb-cb-card",style:{animationDelay:`${z*.05}s`},children:[r.jsxs("div",{className:"pb-cb-card-top",children:[r.jsxs("div",{className:"pb-cb-card-ring",children:[r.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:j2.map((It,ft)=>{const ds=ft<st;return r.jsx("line",{x1:It.x1,y1:It.y1,x2:It.x2,y2:It.y2,className:`pb-ring-tick ${ds?Ke?"hit":"filled":"empty"}`,strokeWidth:It.thick?"2":"1.5"},ft)})}),r.jsx("div",{className:"pb-cb-ring-icon",children:rt?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"pb-cb-badge-earned",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})})]}),r.jsxs("div",{className:"pb-cb-card-info",children:[r.jsx("h4",{className:"pb-cb-card-name",children:_e}),r.jsxs("div",{className:"pb-cb-card-value",children:[E.weight,"kg  ",E.reps]}),E.achievedAt&&r.jsx("div",{className:"pb-cb-card-date",children:(E.achievedAt.toDate?E.achievedAt.toDate():new Date(E.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),ie&&Ke&&!rt&&r.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"}),rt&&r.jsx("div",{className:"pb-cb-target-info earned",children:"Badge earned!"})]}),r.jsx("div",{className:"pb-cb-card-action",children:r.jsx("button",{className:"pb-cb-target-btn",onClick:()=>{wt(_e),Ct("")},children:ie?Ke&&rt?r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 5v14M5 12h14"})}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("circle",{cx:"12",cy:"12",r:"6"}),r.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]}),ie&&!Ke&&r.jsxs("div",{className:"pb-cb-card-progress",children:[r.jsxs("div",{className:"pb-cb-progress-labels",children:[r.jsxs("span",{className:"pb-cb-progress-current",children:[E.weight,"kg"]}),r.jsxs("span",{className:"pb-cb-progress-target",children:["Target: ",ie.targetWeight,"kg"]})]}),r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill",style:{width:`${Math.round((re||0)*100)}%`}})}),r.jsxs("div",{className:"pb-cb-progress-pct",children:[Math.round((re||0)*100),"%"]})]}),ie&&Ke&&r.jsx("div",{className:"pb-cb-card-progress",children:r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill hit",style:{width:"100%"}})})})]},_e)})})})]})})()]})})()}),Object.keys(Ie).length>0&&r.jsxs("button",{className:"pb-cb-achievements-link anim-fade-up-d4",onClick:()=>as("/client/core-buddy/achievements"),children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"View Achievements",r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),Ot&&r.jsx("div",{className:"pb-cb-target-modal-overlay",onClick:()=>wt(null),children:r.jsxs("div",{className:"pb-cb-target-modal",onClick:W=>W.stopPropagation(),children:[r.jsx("h3",{children:"Set Target"}),r.jsx("p",{className:"pb-cb-target-exercise-name",children:Ot}),r.jsxs("div",{className:"pb-cb-target-current",children:["Current PB: ",r.jsxs("strong",{children:[Ie[Ot]?.weight,"kg"]})]}),r.jsxs("div",{className:"pb-cb-target-input-wrap",children:[r.jsx("label",{children:"Your target (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",step:"0.5",value:oe,onChange:W=>Ct(W.target.value),placeholder:String((Ie[Ot]?.weight||0)+5),className:"pb-cb-target-input",autoFocus:!0})]}),r.jsxs("div",{className:"pb-cb-target-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>wt(null),children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:ye,disabled:d,children:d?"Saving...":"Set Target"})]})]})})]}),Hs&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-tabs",children:[r.jsx("button",{className:`pb-tab ${n==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),r.jsx("button",{className:`pb-tab ${n==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),r.jsx("button",{className:`pb-tab ${n==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),n==="bests"&&r.jsxs("div",{className:"pb-strength-section",children:[!x&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-carousel",ref:Et,onTouchStart:F,onTouchMove:fe,onTouchEnd:Se,children:[r.jsx("div",{className:`pb-ring-container slide-from-${Mt.current}`,children:r.jsxs("div",{className:"pb-ring",children:[r.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:Tm.map((W,he)=>{const ce=he<Math.round(cn);return r.jsx("line",{x1:W.x1,y1:W.y1,x2:W.x2,y2:W.y2,className:`pb-ring-tick ${ce?Ks?"hit":"filled":"empty"}`,strokeWidth:W.thick?"3":"2"},he)})}),r.jsxs("div",{className:"pb-ring-center",children:[r.jsx("div",{className:"pb-ring-category",children:Nt.category}),r.jsxs("div",{className:"pb-ring-exercise",children:[Nt.name,ne("strength",Nt.key)&&r.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),r.jsx("div",{className:"pb-ring-value",children:lt?Nt.unit==="time"?ph(lt.time):B2(lt.weight,lt.reps):"-"}),vn!==null&&r.jsxs("div",{className:`pb-ring-change ${vn>=0?"positive":"negative"}`,children:[vn>=0?"+":"",vn.toFixed(1),"%"]}),vn===null&&lt&&r.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),Ns&&r.jsx("div",{className:`pb-ring-target ${Ks?"hit":""}`,children:Ks?"Target hit!":Ns.targetType==="time"?`${Ns.startValue||0}s  ${Ns.targetValue}s`:`${Ns.startWeight||0}kg${Ns.startReps||0}  ${Ns.targetWeight}kg${Ns.targetReps}`}),!Ns&&r.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},g),r.jsx("div",{className:"pb-carousel-dots",children:Va.map((W,he)=>r.jsx("button",{className:`pb-dot ${he===g?"active":""}`,onClick:()=>qt(he)},he))}),r.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>qt(g-1),disabled:g===0,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),r.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>qt(g+1),disabled:g===Va.length-1,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),r.jsxs("div",{className:"pb-trend-section",children:[r.jsx("h4",{children:"Trend"}),r.jsx(J6,{data:t,exerciseKey:Nt.key,unit:Nt.unit})]})]}),!x&&!$&&r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>_(!0),children:He?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>V(!0),children:Object.keys(ke).length>0?"Edit Targets":"Set Targets"}),(Object.keys(ke).length>0||Object.keys(xe).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:Je,disabled:d,children:"Reset All Goals"})]}),x&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Benchmarks - ",Ta(Qe)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{_(!1),ee(He?.benchmarks||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:Va.map(W=>r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:W.name}),W.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:L[W.key]?.weight??"",onChange:he=>Ye(W.key,"weight",he.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",value:L[W.key]?.reps??"",onChange:he=>Ye(W.key,"reps",he.target.value),placeholder:"0"})]})]}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Time (seconds)"}),r.jsx("input",{type:"number",step:"0.01",value:L[W.key]?.time??"",onChange:he=>Ye(W.key,"time",he.target.value),placeholder:"0"})]})})]},W.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{_(!1),ee(He?.benchmarks||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:$e,disabled:d,children:d?"Saving...":"Save"})]})]}),$&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Set Your Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{V(!1),S(ke)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),Va.map(W=>{const he=He?.benchmarks?.[W.key];let ce="-";return he&&(W.unit==="time"&&he.time?ce=`${he.time}s`:(he.weight||he.reps)&&(ce=`${he.weight||0}kg  ${he.reps||0}`)),r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:W.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",ce]})]}),W.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:T[W.key]?.targetWeight??"",onChange:_e=>X(W.key,"targetWeight",_e.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Reps"}),r.jsx("input",{type:"number",value:T[W.key]?.targetReps??"",onChange:_e=>X(W.key,"targetReps",_e.target.value),placeholder:"0"})]})]}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target (seconds)"}),r.jsx("input",{type:"number",step:"1",value:T[W.key]?.targetValue??"",onChange:_e=>X(W.key,"targetValue",_e.target.value),placeholder:"0"})]})})]},W.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{V(!1),S(ke)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Ae,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="metrics"&&r.jsxs("div",{className:"pb-metrics-section",children:[!j&&!D&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-metrics-card",children:[r.jsx("h3",{children:"Body Measurements"}),r.jsx("p",{className:"pb-metrics-month",children:Ta(Qe)}),r.jsx("div",{className:"pb-metrics-list",children:Ho.map(W=>{const he=He?.bodyMetrics?.[W.key],ce=Ee(W.key),_e=xe[W.key],E=Ht(W.key),z=E!==null&&E>=1;return r.jsxs("div",{className:"pb-metric-row",children:[r.jsxs("div",{className:"pb-metric-top",children:[r.jsxs("div",{className:"pb-metric-left",children:[r.jsxs("span",{className:"pb-metric-name",children:[W.name,ne("metric",W.key)&&r.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),_e&&r.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",_e.targetValue," ",W.suffix]})]}),r.jsxs("div",{className:"pb-metric-values",children:[r.jsx("span",{className:"pb-metric-current",children:he!=null?`${he} ${W.suffix}`:"-"}),ce!==null&&r.jsxs("span",{className:`pb-metric-change ${ce>0?"up":ce<0?"down":"same"}`,children:[ce>0?"+":"",ce," ",W.suffix]})]})]}),E!==null&&r.jsxs("div",{className:"pb-metric-progress",children:[r.jsx("div",{className:"pb-metric-bar",children:r.jsx("div",{className:`pb-metric-bar-fill ${z?"hit":""}`,style:{width:`${Math.round(E*100)}%`}})}),r.jsx("span",{className:`pb-metric-percent ${z?"hit":""}`,children:z?"Hit!":`${Math.round(E*100)}%`})]})]},W.key)})})]}),r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>O(!0),children:He?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>I(!0),children:Object.keys(xe).length>0?"Edit Targets":"Set Targets"}),(Object.keys(ke).length>0||Object.keys(xe).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:Je,disabled:d,children:"Reset All Goals"})]})]}),j&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Measurements - ",Ta(Qe)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{O(!1),te(He?.bodyMetrics||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:Ho.map(W=>r.jsx("div",{className:"pb-edit-metric",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:[W.name," (",W.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:Y[W.key]??"",onChange:he=>vt(W.key,he.target.value),placeholder:"0"})]})},W.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{O(!1),te(He?.bodyMetrics||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:bt,disabled:d,children:d?"Saving...":"Save"})]})]}),D&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Body Metric Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{I(!1),M(xe)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),Ho.map(W=>{const he=He?.bodyMetrics?.[W.key];return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:W.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",he!=null?`${he} ${W.suffix}`:"-"]})]}),r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:["Target (",W.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:U[W.key]?.targetValue??"",onChange:ce=>Ge(W.key,ce.target.value),placeholder:"0"})]})})]},W.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{I(!1),M(xe)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:ht,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="history"&&r.jsx("div",{className:"pb-history-section",children:t.length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("h4",{children:"No records yet"}),r.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):r.jsxs(r.Fragment,{children:[ze.length>0&&r.jsxs("div",{className:"pb-achievements-wall",children:[r.jsxs("h4",{className:"pb-achievements-wall-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),r.jsx("div",{className:"pb-achievements-list",children:[...ze].reverse().map((W,he)=>r.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${he*.05}s`},children:[r.jsx("div",{className:"pb-achievement-star",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("div",{className:"pb-achievement-info",children:[r.jsx("span",{className:"pb-achievement-label",children:W.label}),r.jsx("span",{className:"pb-achievement-date",children:Ta(W.achievedMonth)})]})]},he))})]}),r.jsx("div",{className:"pb-history-controls",children:r.jsx("button",{className:`pb-compare-toggle ${Q?"active":""}`,onClick:()=>{P(!Q),!Q&&t.length>=2&&(Be(t[0].month),Oe(t[t.length-1].month))},children:Q?"Back to Timeline":"Compare Months"})}),Q?r.jsxs("div",{className:"pb-compare",children:[r.jsxs("div",{className:"pb-compare-selectors",children:[r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"From"}),r.jsx("select",{value:ae,onChange:W=>Be(W.target.value),children:t.map(W=>r.jsx("option",{value:W.month,children:Ta(W.month)},W.month))})]}),r.jsx("div",{className:"pb-compare-vs",children:"vs"}),r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"To"}),r.jsx("select",{value:Ue,onChange:W=>Oe(W.target.value),children:t.map(W=>r.jsx("option",{value:W.month,children:Ta(W.month)},W.month))})]})]}),Ne&&mt&&r.jsxs("div",{className:"pb-compare-results",children:[r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Strength Benchmarks"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Exercise"}),r.jsx("span",{children:Ta(ae).split(" ")[0]}),r.jsx("span",{children:Ta(Ue).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),Va.map(W=>{const he=Ne.benchmarks?.[W.key],ce=mt.benchmarks?.[W.key],_e=ql(W,he),E=ql(W,ce),z=ng(E,_e);return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:W.name}),r.jsx("span",{className:"pb-compare-val",children:he?W.unit==="time"?ph(he.time):`${he.weight}x${he.reps}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:ce?W.unit==="time"?ph(ce.time):`${ce.weight}x${ce.reps}`:"-"}),r.jsx("span",{className:`pb-compare-change ${z!==null?z>=0?"positive":"negative":""}`,children:z!==null?`${z>=0?"+":""}${z.toFixed(1)}%`:"-"})]},W.key)})]})]}),r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Body Measurements"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Measurement"}),r.jsx("span",{children:Ta(ae).split(" ")[0]}),r.jsx("span",{children:Ta(Ue).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),Ho.map(W=>{const he=Ne.bodyMetrics?.[W.key],ce=mt.bodyMetrics?.[W.key],_e=he!=null&&ce!=null?parseFloat((ce-he).toFixed(2)):null;return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:W.name}),r.jsx("span",{className:"pb-compare-val",children:he!=null?`${he}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:ce!=null?`${ce}`:"-"}),r.jsx("span",{className:`pb-compare-change ${_e!==null?_e>0?"positive":_e<0?"negative":"neutral":""}`,children:_e!==null?`${_e>0?"+":""}${_e} ${W.suffix}`:"-"})]},W.key)})]})]})]})]}):r.jsx("div",{className:"pb-timeline",children:[...t].reverse().map((W,he)=>{const ce=t.find(_e=>_e.month<W.month&&t.indexOf(_e)===t.indexOf(W)-1)||t.filter(_e=>_e.month<W.month).pop();return r.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${he*.05}s`},children:[r.jsx("div",{className:"pb-timeline-dot"}),r.jsxs("div",{className:"pb-timeline-card",children:[r.jsx("h4",{children:Ta(W.month)}),W.benchmarks&&Object.keys(W.benchmarks).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Strength Benchmarks"}),Va.map(_e=>{const E=W.benchmarks[_e.key];if(!E)return null;const z=ce?.benchmarks?.[_e.key],ie=ql(_e,E),re=ql(_e,z),Ke=ng(ie,re);return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:_e.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsx("span",{className:"pb-timeline-value",children:_e.unit==="time"?ph(E.time):B2(E.weight,E.reps)}),Ke!==null&&r.jsxs("span",{className:`pb-timeline-change ${Ke>=0?"positive":"negative"}`,children:[Ke>=0?"+":"",Ke.toFixed(1),"%"]})]})]},_e.key)})]}),W.bodyMetrics&&Object.keys(W.bodyMetrics).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Body Measurements"}),Ho.map(_e=>{const E=W.bodyMetrics[_e.key];if(E==null)return null;const z=ce?.bodyMetrics?.[_e.key],ie=z!=null?parseFloat((E-z).toFixed(2)):null;return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:_e.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsxs("span",{className:"pb-timeline-value",children:[E," ",_e.suffix]}),ie!==null&&r.jsxs("span",{className:`pb-timeline-change ${ie>0?"positive":ie<0?"negative":"neutral"}`,children:[ie>0?"+":"",ie," ",_e.suffix]})]})]},_e.key)})]})]})]},W.id)})})]})})]})]}),B&&r.jsx("div",{className:"pb-celebration-overlay",onClick:()=>se(null),children:r.jsxs("div",{className:"pb-celebration-card",children:[r.jsx("div",{className:"pb-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pb-celebration-title",children:B.length===1?"Target Achieved!":`${B.length} Targets Achieved!`}),r.jsx("div",{className:"pb-celebration-badges",children:B.map((W,he)=>r.jsx("div",{className:"pb-celebration-badge",children:W.label},he))}),r.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),ge&&r.jsxs("div",{className:`toast-notification ${ge.type}`,children:[r.jsx("span",{className:"toast-icon",children:ge.type==="success"?r.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),r.jsx("span",{className:"toast-message",children:ge.message}),r.jsx("button",{className:"toast-close",onClick:()=>Re(null),children:""})]}),Hs&&r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:"block-nav-tab",onClick:()=>as("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),r.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),r.jsx("span",{children:"Home"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>as("/client/forms"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),r.jsx("polyline",{points:"14 2 14 8 20 8"}),r.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),r.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),r.jsx("span",{children:"Forms"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>as("/client/tools"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),r.jsx("span",{children:"Tools"})]}),r.jsxs("button",{className:"block-nav-tab active",children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20V10"}),r.jsx("path",{d:"M18 20V4"}),r.jsx("path",{d:"M6 20v-4"})]}),r.jsx("span",{children:"PBs"})]}),At?.circuitAccess&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>as("/client/circuit"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 6v6l4 2"})]}),r.jsx("span",{children:"Circuit"})]})]}),Ds&&r.jsx(ta,{active:"progress"})]})})}const eP=b.lazy(()=>Cr(()=>import("./Dashboard-BcyPkD5j.js"),__vite__mapDeps([0,1,2]))),tP=b.lazy(()=>Cr(()=>import("./AddClient-bv1kC2DJ.js"),__vite__mapDeps([3,4]))),sP=b.lazy(()=>Cr(()=>import("./ClientDashboard-CxIswdTG.js"),__vite__mapDeps([5,1]))),nP=b.lazy(()=>Cr(()=>import("./ClientForms-DRnUPDwG.js"),__vite__mapDeps([6,7]))),rP=b.lazy(()=>Cr(()=>import("./ClientTools-BqG4G-4j.js"),__vite__mapDeps([8,9]))),aP=b.lazy(()=>Cr(()=>import("./MacroCalculator-hc9-yJAk.js"),__vite__mapDeps([10,9]))),iP=b.lazy(()=>Cr(()=>import("./ProteinSnacks-Cm3sGb72.js"),__vite__mapDeps([11,9]))),oP=b.lazy(()=>Cr(()=>import("./DailyMotivation-CjqOo3_G.js"),__vite__mapDeps([12,9]))),lP=b.lazy(()=>Cr(()=>import("./CircuitDashboard-Bws9KKXh.js"),__vite__mapDeps([13,14]))),cP=b.lazy(()=>Cr(()=>import("./CircuitBooking-DgLLKTXH.js"),__vite__mapDeps([15,16,14]))),uP=b.lazy(()=>Cr(()=>import("./Leaderboard-BK7rOap9.js"),__vite__mapDeps([17,18]))),dP=b.lazy(()=>Cr(()=>import("./UpgradePage-DJEAW5XC.js"),__vite__mapDeps([19,20]))),hP=b.lazy(()=>Cr(()=>import("./SignUp-hemmvvqD.js"),[])),mP=b.lazy(()=>Cr(()=>import("./Onboarding-D7euGoS2.js"),__vite__mapDeps([21,22])));function fP({children:n}){const{pathname:e}=Aa();return b.useEffect(()=>{"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")},[]),b.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"})},[e]),n}function pP(){const n=Zn();return b.useEffect(()=>{const e=sessionStorage.getItem("redirect");if(e){sessionStorage.removeItem("redirect");const t=e.replace("/login","")||"/";n(t,{replace:!0})}},[n]),null}function gP(){return r.jsx(Z3,{children:r.jsx(J3,{children:r.jsx(rD,{children:r.jsxs(oN,{basename:"/login",children:[r.jsx(pP,{}),r.jsx(fP,{children:r.jsx(b.Suspense,{fallback:r.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"60vh"},children:r.jsx("div",{style:{width:36,height:36,border:"3px solid var(--color-primary-light)",borderTopColor:"var(--color-primary)",borderRadius:"50%",animation:"app-spin .7s linear infinite"}})}),children:r.jsxs(LE,{children:[r.jsx(tn,{path:"/",element:r.jsx(oD,{})}),r.jsx(tn,{path:"/dashboard",element:r.jsx(eP,{})}),r.jsx(tn,{path:"/add-client",element:r.jsx(tP,{})}),r.jsx(tn,{path:"/client",element:r.jsx(sP,{})}),r.jsx(tn,{path:"/client/forms",element:r.jsx(nP,{})}),r.jsx(tn,{path:"/client/tools",element:r.jsx(rP,{})}),r.jsx(tn,{path:"/client/tools/macros",element:r.jsx(aP,{})}),r.jsx(tn,{path:"/client/tools/snacks",element:r.jsx(iP,{})}),r.jsx(tn,{path:"/client/tools/motivation",element:r.jsx(oP,{})}),r.jsx(tn,{path:"/client/personal-bests",element:r.jsx(Z6,{})}),r.jsx(tn,{path:"/client/circuit",element:r.jsx(lP,{})}),r.jsx(tn,{path:"/client/circuit/booking",element:r.jsx(cP,{})}),r.jsx(tn,{path:"/client/core-buddy",element:r.jsx(CD,{})}),r.jsx(tn,{path:"/client/core-buddy/nutrition",element:r.jsx(Bl,{feature:"nutrition",children:r.jsx(ID,{})})}),r.jsx(tn,{path:"/client/core-buddy/workouts",element:r.jsx(p6,{})}),r.jsx(tn,{path:"/client/core-buddy/programmes",element:r.jsx(Bl,{feature:"programmes",children:r.jsx(x6,{})})}),r.jsx(tn,{path:"/client/core-buddy/achievements",element:r.jsx(Bl,{feature:"achievements",children:r.jsx(E6,{})})}),r.jsx(tn,{path:"/client/core-buddy/consistency",element:r.jsx(Bl,{feature:"consistency",children:r.jsx(D6,{})})}),r.jsx(tn,{path:"/client/core-buddy/buddies",element:r.jsx(Bl,{feature:"buddies",children:r.jsx(P6,{})})}),r.jsx(tn,{path:"/client/core-buddy/buddy",element:r.jsx(F6,{})}),r.jsx(tn,{path:"/client/core-buddy/builder",element:r.jsx(q6,{})}),r.jsx(tn,{path:"/client/core-buddy/profile/:userId",element:r.jsx(V6,{})}),r.jsx(tn,{path:"/client/leaderboard",element:r.jsx(Bl,{feature:"leaderboard",children:r.jsx(uP,{})})}),r.jsx(tn,{path:"/signup",element:r.jsx(hP,{})}),r.jsx(tn,{path:"/onboarding",element:r.jsx(mP,{})}),r.jsx(tn,{path:"/upgrade",element:r.jsx(dP,{})}),r.jsx(tn,{path:"*",element:r.jsx(J2,{to:"/",replace:!0})})]})})})]})})})})}LT.createRoot(document.getElementById("root")).render(r.jsx(b.StrictMode,{children:r.jsx(gP,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/login/sw.js").then(n=>{setInterval(()=>n.update(),3600*1e3)}).catch(n=>console.warn("SW registration failed:",n))});export{vr as A,ta as C,ga as P,Rt as T,fa as a,Tr as b,$t as c,pe as d,We as e,ZC as f,Is as g,r4 as h,Ms as i,r as j,Os as k,Rr as l,Ia as m,Zn as n,Qh as o,Tm as p,Fs as q,b as r,vP as s,pc as t,Jr as u,iD as v,bs as w,aD as x,yP as y,hN as z};
