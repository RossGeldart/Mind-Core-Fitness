const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-SzFL48VI.js","assets/Dashboard-kTCGLGDk.css","assets/AddClient-BvM7E8nH.js","assets/AddClient-DH1OFzHo.css","assets/ClientForms-B0uJ77lz.js","assets/ClientForms-GDNtnrAx.css","assets/ClientTools-BLevk56M.js","assets/ClientTools-DQRPoST3.css","assets/MacroCalculator-DmK8rypd.js","assets/ProteinSnacks-6dSOE8Ub.js","assets/DailyMotivation-C1AJjyOg.js","assets/CircuitDashboard-BPwByCch.js","assets/CircuitDashboard-C8T0uect.css","assets/CircuitBooking-_aNzofL8.js","assets/CircuitBooking-ruk9Q4Wj.css","assets/Leaderboard-CFKNR7fU.js","assets/Leaderboard-Dq-r5svP.css","assets/UpgradePage-CthJwlqQ.js","assets/stripe-7qEIN5w7.js","assets/UpgradePage-Blt11CID.css","assets/Onboarding-_lN8JW-A.js","assets/Onboarding-Bku4iVdQ.css"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function t(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(l){if(l.ep)return;l.ep=!0;const u=t(l);fetch(l.href,u)}})();var bp={exports:{}},Gc={};var k1;function kT(){if(k1)return Gc;k1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,l,u){var d=null;if(u!==void 0&&(d=""+u),l.key!==void 0&&(d=""+l.key),"key"in l){u={};for(var p in l)p!=="key"&&(u[p]=l[p])}else u=l;return l=u.ref,{$$typeof:n,type:i,key:d,ref:l!==void 0?l:null,props:u}}return Gc.Fragment=e,Gc.jsx=t,Gc.jsxs=t,Gc}var j1;function jT(){return j1||(j1=1,bp.exports=kT()),bp.exports}var r=jT(),vp={exports:{}},es={};var T1;function TT(){if(T1)return es;T1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),d=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),j=Symbol.for("react.activity"),T=Symbol.iterator;function B(L){return L===null||typeof L!="object"?null:(L=T&&L[T]||L["@@iterator"],typeof L=="function"?L:null)}var $={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},F=Object.assign,V={};function te(L,se,De){this.props=L,this.context=se,this.refs=V,this.updater=De||$}te.prototype.isReactComponent={},te.prototype.setState=function(L,se){if(typeof L!="object"&&typeof L!="function"&&L!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,L,se,"setState")},te.prototype.forceUpdate=function(L){this.updater.enqueueForceUpdate(this,L,"forceUpdate")};function K(){}K.prototype=te.prototype;function ae(L,se,De){this.props=L,this.context=se,this.refs=V,this.updater=De||$}var ye=ae.prototype=new K;ye.constructor=ae,F(ye,te.prototype),ye.isPureReactComponent=!0;var Ae=Array.isArray;function me(){}var R={H:null,A:null,T:null,S:null},E=Object.prototype.hasOwnProperty;function M(L,se,De){var ue=De.ref;return{$$typeof:n,type:L,key:se,ref:ue!==void 0?ue:null,props:De}}function O(L,se){return M(L.type,se,L.props)}function D(L){return typeof L=="object"&&L!==null&&L.$$typeof===n}function q(L){var se={"=":"=0",":":"=2"};return"$"+L.replace(/[=:]/g,function(De){return se[De]})}var I=/\/+/g;function qe(L,se){return typeof L=="object"&&L!==null&&L.key!=null?q(""+L.key):se.toString(36)}function ft(L){switch(L.status){case"fulfilled":return L.value;case"rejected":throw L.reason;default:switch(typeof L.status=="string"?L.then(me,me):(L.status="pending",L.then(function(se){L.status==="pending"&&(L.status="fulfilled",L.value=se)},function(se){L.status==="pending"&&(L.status="rejected",L.reason=se)})),L.status){case"fulfilled":return L.value;case"rejected":throw L.reason}}throw L}function W(L,se,De,ue,ze){var Le=typeof L;(Le==="undefined"||Le==="boolean")&&(L=null);var it=!1;if(L===null)it=!0;else switch(Le){case"bigint":case"string":case"number":it=!0;break;case"object":switch(L.$$typeof){case n:case e:it=!0;break;case x:return it=L._init,W(it(L._payload),se,De,ue,ze)}}if(it)return ze=ze(L),it=ue===""?"."+qe(L,0):ue,Ae(ze)?(De="",it!=null&&(De=it.replace(I,"$&/")+"/"),W(ze,se,De,"",function(Ht){return Ht})):ze!=null&&(D(ze)&&(ze=O(ze,De+(ze.key==null||L&&L.key===ze.key?"":(""+ze.key).replace(I,"$&/")+"/")+it)),se.push(ze)),1;it=0;var pt=ue===""?".":ue+":";if(Ae(L))for(var Ye=0;Ye<L.length;Ye++)ue=L[Ye],Le=pt+qe(ue,Ye),it+=W(ue,se,De,Le,ze);else if(Ye=B(L),typeof Ye=="function")for(L=Ye.call(L),Ye=0;!(ue=L.next()).done;)ue=ue.value,Le=pt+qe(ue,Ye++),it+=W(ue,se,De,Le,ze);else if(Le==="object"){if(typeof L.then=="function")return W(ft(L),se,De,ue,ze);throw se=String(L),Error("Objects are not valid as a React child (found: "+(se==="[object Object]"?"object with keys {"+Object.keys(L).join(", ")+"}":se)+"). If you meant to render a collection of children, use an array instead.")}return it}function de(L,se,De){if(L==null)return L;var ue=[],ze=0;return W(L,ue,"","",function(Le){return se.call(De,Le,ze++)}),ue}function Ie(L){if(L._status===-1){var se=L._result;se=se(),se.then(function(De){(L._status===0||L._status===-1)&&(L._status=1,L._result=De)},function(De){(L._status===0||L._status===-1)&&(L._status=2,L._result=De)}),L._status===-1&&(L._status=0,L._result=se)}if(L._status===1)return L._result.default;throw L._result}var Ve=typeof reportError=="function"?reportError:function(L){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var se=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof L=="object"&&L!==null&&typeof L.message=="string"?String(L.message):String(L),error:L});if(!window.dispatchEvent(se))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",L);return}console.error(L)},ee={map:de,forEach:function(L,se,De){de(L,function(){se.apply(this,arguments)},De)},count:function(L){var se=0;return de(L,function(){se++}),se},toArray:function(L){return de(L,function(se){return se})||[]},only:function(L){if(!D(L))throw Error("React.Children.only expected to receive a single React element child.");return L}};return es.Activity=j,es.Children=ee,es.Component=te,es.Fragment=t,es.Profiler=l,es.PureComponent=ae,es.StrictMode=i,es.Suspense=g,es.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,es.__COMPILER_RUNTIME={__proto__:null,c:function(L){return R.H.useMemoCache(L)}},es.cache=function(L){return function(){return L.apply(null,arguments)}},es.cacheSignal=function(){return null},es.cloneElement=function(L,se,De){if(L==null)throw Error("The argument must be a React element, but you passed "+L+".");var ue=F({},L.props),ze=L.key;if(se!=null)for(Le in se.key!==void 0&&(ze=""+se.key),se)!E.call(se,Le)||Le==="key"||Le==="__self"||Le==="__source"||Le==="ref"&&se.ref===void 0||(ue[Le]=se[Le]);var Le=arguments.length-2;if(Le===1)ue.children=De;else if(1<Le){for(var it=Array(Le),pt=0;pt<Le;pt++)it[pt]=arguments[pt+2];ue.children=it}return M(L.type,ze,ue)},es.createContext=function(L){return L={$$typeof:d,_currentValue:L,_currentValue2:L,_threadCount:0,Provider:null,Consumer:null},L.Provider=L,L.Consumer={$$typeof:u,_context:L},L},es.createElement=function(L,se,De){var ue,ze={},Le=null;if(se!=null)for(ue in se.key!==void 0&&(Le=""+se.key),se)E.call(se,ue)&&ue!=="key"&&ue!=="__self"&&ue!=="__source"&&(ze[ue]=se[ue]);var it=arguments.length-2;if(it===1)ze.children=De;else if(1<it){for(var pt=Array(it),Ye=0;Ye<it;Ye++)pt[Ye]=arguments[Ye+2];ze.children=pt}if(L&&L.defaultProps)for(ue in it=L.defaultProps,it)ze[ue]===void 0&&(ze[ue]=it[ue]);return M(L,Le,ze)},es.createRef=function(){return{current:null}},es.forwardRef=function(L){return{$$typeof:p,render:L}},es.isValidElement=D,es.lazy=function(L){return{$$typeof:x,_payload:{_status:-1,_result:L},_init:Ie}},es.memo=function(L,se){return{$$typeof:y,type:L,compare:se===void 0?null:se}},es.startTransition=function(L){var se=R.T,De={};R.T=De;try{var ue=L(),ze=R.S;ze!==null&&ze(De,ue),typeof ue=="object"&&ue!==null&&typeof ue.then=="function"&&ue.then(me,Ve)}catch(Le){Ve(Le)}finally{se!==null&&De.types!==null&&(se.types=De.types),R.T=se}},es.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},es.use=function(L){return R.H.use(L)},es.useActionState=function(L,se,De){return R.H.useActionState(L,se,De)},es.useCallback=function(L,se){return R.H.useCallback(L,se)},es.useContext=function(L){return R.H.useContext(L)},es.useDebugValue=function(){},es.useDeferredValue=function(L,se){return R.H.useDeferredValue(L,se)},es.useEffect=function(L,se){return R.H.useEffect(L,se)},es.useEffectEvent=function(L){return R.H.useEffectEvent(L)},es.useId=function(){return R.H.useId()},es.useImperativeHandle=function(L,se,De){return R.H.useImperativeHandle(L,se,De)},es.useInsertionEffect=function(L,se){return R.H.useInsertionEffect(L,se)},es.useLayoutEffect=function(L,se){return R.H.useLayoutEffect(L,se)},es.useMemo=function(L,se){return R.H.useMemo(L,se)},es.useOptimistic=function(L,se){return R.H.useOptimistic(L,se)},es.useReducer=function(L,se,De){return R.H.useReducer(L,se,De)},es.useRef=function(L){return R.H.useRef(L)},es.useState=function(L){return R.H.useState(L)},es.useSyncExternalStore=function(L,se,De){return R.H.useSyncExternalStore(L,se,De)},es.useTransition=function(){return R.H.useTransition()},es.version="19.2.4",es}var E1;function Lg(){return E1||(E1=1,vp.exports=TT()),vp.exports}var v=Lg(),xp={exports:{}},Kc={},wp={exports:{}},_p={};var S1;function ET(){return S1||(S1=1,(function(n){function e(W,de){var Ie=W.length;W.push(de);e:for(;0<Ie;){var Ve=Ie-1>>>1,ee=W[Ve];if(0<l(ee,de))W[Ve]=de,W[Ie]=ee,Ie=Ve;else break e}}function t(W){return W.length===0?null:W[0]}function i(W){if(W.length===0)return null;var de=W[0],Ie=W.pop();if(Ie!==de){W[0]=Ie;e:for(var Ve=0,ee=W.length,L=ee>>>1;Ve<L;){var se=2*(Ve+1)-1,De=W[se],ue=se+1,ze=W[ue];if(0>l(De,Ie))ue<ee&&0>l(ze,De)?(W[Ve]=ze,W[ue]=Ie,Ve=ue):(W[Ve]=De,W[se]=Ie,Ve=se);else if(ue<ee&&0>l(ze,Ie))W[Ve]=ze,W[ue]=Ie,Ve=ue;else break e}}return de}function l(W,de){var Ie=W.sortIndex-de.sortIndex;return Ie!==0?Ie:W.id-de.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;n.unstable_now=function(){return u.now()}}else{var d=Date,p=d.now();n.unstable_now=function(){return d.now()-p}}var g=[],y=[],x=1,j=null,T=3,B=!1,$=!1,F=!1,V=!1,te=typeof setTimeout=="function"?setTimeout:null,K=typeof clearTimeout=="function"?clearTimeout:null,ae=typeof setImmediate<"u"?setImmediate:null;function ye(W){for(var de=t(y);de!==null;){if(de.callback===null)i(y);else if(de.startTime<=W)i(y),de.sortIndex=de.expirationTime,e(g,de);else break;de=t(y)}}function Ae(W){if(F=!1,ye(W),!$)if(t(g)!==null)$=!0,me||(me=!0,q());else{var de=t(y);de!==null&&ft(Ae,de.startTime-W)}}var me=!1,R=-1,E=5,M=-1;function O(){return V?!0:!(n.unstable_now()-M<E)}function D(){if(V=!1,me){var W=n.unstable_now();M=W;var de=!0;try{e:{$=!1,F&&(F=!1,K(R),R=-1),B=!0;var Ie=T;try{t:{for(ye(W),j=t(g);j!==null&&!(j.expirationTime>W&&O());){var Ve=j.callback;if(typeof Ve=="function"){j.callback=null,T=j.priorityLevel;var ee=Ve(j.expirationTime<=W);if(W=n.unstable_now(),typeof ee=="function"){j.callback=ee,ye(W),de=!0;break t}j===t(g)&&i(g),ye(W)}else i(g);j=t(g)}if(j!==null)de=!0;else{var L=t(y);L!==null&&ft(Ae,L.startTime-W),de=!1}}break e}finally{j=null,T=Ie,B=!1}de=void 0}}finally{de?q():me=!1}}}var q;if(typeof ae=="function")q=function(){ae(D)};else if(typeof MessageChannel<"u"){var I=new MessageChannel,qe=I.port2;I.port1.onmessage=D,q=function(){qe.postMessage(null)}}else q=function(){te(D,0)};function ft(W,de){R=te(function(){W(n.unstable_now())},de)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(W){W.callback=null},n.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<W?Math.floor(1e3/W):5},n.unstable_getCurrentPriorityLevel=function(){return T},n.unstable_next=function(W){switch(T){case 1:case 2:case 3:var de=3;break;default:de=T}var Ie=T;T=de;try{return W()}finally{T=Ie}},n.unstable_requestPaint=function(){V=!0},n.unstable_runWithPriority=function(W,de){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var Ie=T;T=W;try{return de()}finally{T=Ie}},n.unstable_scheduleCallback=function(W,de,Ie){var Ve=n.unstable_now();switch(typeof Ie=="object"&&Ie!==null?(Ie=Ie.delay,Ie=typeof Ie=="number"&&0<Ie?Ve+Ie:Ve):Ie=Ve,W){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=Ie+ee,W={id:x++,callback:de,priorityLevel:W,startTime:Ie,expirationTime:ee,sortIndex:-1},Ie>Ve?(W.sortIndex=Ie,e(y,W),t(g)===null&&W===t(y)&&(F?(K(R),R=-1):F=!0,ft(Ae,Ie-Ve))):(W.sortIndex=ee,e(g,W),$||B||($=!0,me||(me=!0,q()))),W},n.unstable_shouldYield=O,n.unstable_wrapCallback=function(W){var de=T;return function(){var Ie=T;T=de;try{return W.apply(this,arguments)}finally{T=Ie}}}})(_p)),_p}var N1;function ST(){return N1||(N1=1,wp.exports=ET()),wp.exports}var kp={exports:{}},fr={};var C1;function NT(){if(C1)return fr;C1=1;var n=Lg();function e(g){var y="https://react.dev/errors/"+g;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)y+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+g+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},l=Symbol.for("react.portal");function u(g,y,x){var j=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:j==null?null:""+j,children:g,containerInfo:y,implementation:x}}var d=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(g,y){if(g==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return fr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,fr.createPortal=function(g,y){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(e(299));return u(g,y,null,x)},fr.flushSync=function(g){var y=d.T,x=i.p;try{if(d.T=null,i.p=2,g)return g()}finally{d.T=y,i.p=x,i.d.f()}},fr.preconnect=function(g,y){typeof g=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,i.d.C(g,y))},fr.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},fr.preinit=function(g,y){if(typeof g=="string"&&y&&typeof y.as=="string"){var x=y.as,j=p(x,y.crossOrigin),T=typeof y.integrity=="string"?y.integrity:void 0,B=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;x==="style"?i.d.S(g,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:j,integrity:T,fetchPriority:B}):x==="script"&&i.d.X(g,{crossOrigin:j,integrity:T,fetchPriority:B,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},fr.preinitModule=function(g,y){if(typeof g=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var x=p(y.as,y.crossOrigin);i.d.M(g,{crossOrigin:x,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&i.d.M(g)},fr.preload=function(g,y){if(typeof g=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var x=y.as,j=p(x,y.crossOrigin);i.d.L(g,x,{crossOrigin:j,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},fr.preloadModule=function(g,y){if(typeof g=="string")if(y){var x=p(y.as,y.crossOrigin);i.d.m(g,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:x,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else i.d.m(g)},fr.requestFormReset=function(g){i.d.r(g)},fr.unstable_batchedUpdates=function(g,y){return g(y)},fr.useFormState=function(g,y,x){return d.H.useFormState(g,y,x)},fr.useFormStatus=function(){return d.H.useHostTransitionStatus()},fr.version="19.2.4",fr}var R1;function CT(){if(R1)return kp.exports;R1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),kp.exports=NT(),kp.exports}var A1;function RT(){if(A1)return Kc;A1=1;var n=ST(),e=Lg(),t=CT();function i(s){var a="https://react.dev/errors/"+s;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)a+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+s+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function u(s){var a=s,o=s;if(s.alternate)for(;a.return;)a=a.return;else{s=a;do a=s,(a.flags&4098)!==0&&(o=a.return),s=a.return;while(s)}return a.tag===3?o:null}function d(s){if(s.tag===13){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function p(s){if(s.tag===31){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function g(s){if(u(s)!==s)throw Error(i(188))}function y(s){var a=s.alternate;if(!a){if(a=u(s),a===null)throw Error(i(188));return a!==s?null:s}for(var o=s,c=a;;){var m=o.return;if(m===null)break;var f=m.alternate;if(f===null){if(c=m.return,c!==null){o=c;continue}break}if(m.child===f.child){for(f=m.child;f;){if(f===o)return g(m),s;if(f===c)return g(m),a;f=f.sibling}throw Error(i(188))}if(o.return!==c.return)o=m,c=f;else{for(var w=!1,S=m.child;S;){if(S===o){w=!0,o=m,c=f;break}if(S===c){w=!0,c=m,o=f;break}S=S.sibling}if(!w){for(S=f.child;S;){if(S===o){w=!0,o=f,c=m;break}if(S===c){w=!0,c=f,o=m;break}S=S.sibling}if(!w)throw Error(i(189))}}if(o.alternate!==c)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?s:a}function x(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s;for(s=s.child;s!==null;){if(a=x(s),a!==null)return a;s=s.sibling}return null}var j=Object.assign,T=Symbol.for("react.element"),B=Symbol.for("react.transitional.element"),$=Symbol.for("react.portal"),F=Symbol.for("react.fragment"),V=Symbol.for("react.strict_mode"),te=Symbol.for("react.profiler"),K=Symbol.for("react.consumer"),ae=Symbol.for("react.context"),ye=Symbol.for("react.forward_ref"),Ae=Symbol.for("react.suspense"),me=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),M=Symbol.for("react.activity"),O=Symbol.for("react.memo_cache_sentinel"),D=Symbol.iterator;function q(s){return s===null||typeof s!="object"?null:(s=D&&s[D]||s["@@iterator"],typeof s=="function"?s:null)}var I=Symbol.for("react.client.reference");function qe(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===I?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case F:return"Fragment";case te:return"Profiler";case V:return"StrictMode";case Ae:return"Suspense";case me:return"SuspenseList";case M:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case $:return"Portal";case ae:return s.displayName||"Context";case K:return(s._context.displayName||"Context")+".Consumer";case ye:var a=s.render;return s=s.displayName,s||(s=a.displayName||a.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case R:return a=s.displayName||null,a!==null?a:qe(s.type)||"Memo";case E:a=s._payload,s=s._init;try{return qe(s(a))}catch{}}return null}var ft=Array.isArray,W=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,de=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ie={pending:!1,data:null,method:null,action:null},Ve=[],ee=-1;function L(s){return{current:s}}function se(s){0>ee||(s.current=Ve[ee],Ve[ee]=null,ee--)}function De(s,a){ee++,Ve[ee]=s.current,s.current=a}var ue=L(null),ze=L(null),Le=L(null),it=L(null);function pt(s,a){switch(De(Le,a),De(ze,s),De(ue,null),a.nodeType){case 9:case 11:s=(s=a.documentElement)&&(s=s.namespaceURI)?Wv(s):0;break;default:if(s=a.tagName,a=a.namespaceURI)a=Wv(a),s=Gv(a,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}se(ue),De(ue,s)}function Ye(){se(ue),se(ze),se(Le)}function Ht(s){s.memoizedState!==null&&De(it,s);var a=ue.current,o=Gv(a,s.type);a!==o&&(De(ze,s),De(ue,o))}function Ms(s){ze.current===s&&(se(ue),se(ze)),it.current===s&&(se(it),qc._currentValue=Ie)}var dt,mt;function ne(s){if(dt===void 0)try{throw Error()}catch(o){var a=o.stack.trim().match(/\n( *(at )?)/);dt=a&&a[1]||"",mt=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+dt+s+mt}var Rt=!1;function Pt(s,a){if(!s||Rt)return"";Rt=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(a){var Pe=function(){throw Error()};if(Object.defineProperty(Pe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Pe,[])}catch(ve){var ce=ve}Reflect.construct(s,[],Pe)}else{try{Pe.call()}catch(ve){ce=ve}s.call(Pe.prototype)}}else{try{throw Error()}catch(ve){ce=ve}(Pe=s())&&typeof Pe.catch=="function"&&Pe.catch(function(){})}}catch(ve){if(ve&&ce&&typeof ve.stack=="string")return[ve.stack,ce.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var f=c.DetermineComponentFrameRoot(),w=f[0],S=f[1];if(w&&S){var z=w.split(`
`),le=S.split(`
`);for(m=c=0;c<z.length&&!z[c].includes("DetermineComponentFrameRoot");)c++;for(;m<le.length&&!le[m].includes("DetermineComponentFrameRoot");)m++;if(c===z.length||m===le.length)for(c=z.length-1,m=le.length-1;1<=c&&0<=m&&z[c]!==le[m];)m--;for(;1<=c&&0<=m;c--,m--)if(z[c]!==le[m]){if(c!==1||m!==1)do if(c--,m--,0>m||z[c]!==le[m]){var Te=`
`+z[c].replace(" at new "," at ");return s.displayName&&Te.includes("<anonymous>")&&(Te=Te.replace("<anonymous>",s.displayName)),Te}while(1<=c&&0<=m);break}}}finally{Rt=!1,Error.prepareStackTrace=o}return(o=s?s.displayName||s.name:"")?ne(o):""}function At(s,a){switch(s.tag){case 26:case 27:case 5:return ne(s.type);case 16:return ne("Lazy");case 13:return s.child!==a&&a!==null?ne("Suspense Fallback"):ne("Suspense");case 19:return ne("SuspenseList");case 0:case 15:return Pt(s.type,!1);case 11:return Pt(s.type.render,!1);case 1:return Pt(s.type,!0);case 31:return ne("Activity");default:return""}}function vt(s){try{var a="",o=null;do a+=At(s,o),o=s,s=s.return;while(s);return a}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var nt=Object.prototype.hasOwnProperty,$e=n.unstable_scheduleCallback,$t=n.unstable_cancelCallback,Ns=n.unstable_shouldYield,Ws=n.unstable_requestPaint,Ut=n.unstable_now,St=n.unstable_getCurrentPriorityLevel,is=n.unstable_ImmediatePriority,Is=n.unstable_UserBlockingPriority,zt=n.unstable_NormalPriority,Js=n.unstable_LowPriority,Lt=n.unstable_IdlePriority,ps=n.log,Wt=n.unstable_setDisableYieldValue,we=null,G=null;function he(s){if(typeof ps=="function"&&Wt(s),G&&typeof G.setStrictMode=="function")try{G.setStrictMode(we,s)}catch{}}var Ee=Math.clz32?Math.clz32:Qe,Oe=Math.log,ke=Math.LN2;function Qe(s){return s>>>=0,s===0?32:31-(Oe(s)/ke|0)|0}var ot=256,Y=262144,re=4194304;function We(s){var a=s&42;if(a!==0)return a;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Ge(s,a,o){var c=s.pendingLanes;if(c===0)return 0;var m=0,f=s.suspendedLanes,w=s.pingedLanes;s=s.warmLanes;var S=c&134217727;return S!==0?(c=S&~f,c!==0?m=We(c):(w&=S,w!==0?m=We(w):o||(o=S&~s,o!==0&&(m=We(o))))):(S=c&~f,S!==0?m=We(S):w!==0?m=We(w):o||(o=c&~s,o!==0&&(m=We(o)))),m===0?0:a!==0&&a!==m&&(a&f)===0&&(f=m&-m,o=a&-a,f>=o||f===32&&(o&4194048)!==0)?a:m}function rt(s,a){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&a)===0}function bt(s,a){switch(s){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function jt(){var s=re;return re<<=1,(re&62914560)===0&&(re=4194304),s}function gt(s){for(var a=[],o=0;31>o;o++)a.push(s);return a}function Gt(s,a){s.pendingLanes|=a,a!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Gs(s,a,o,c,m,f){var w=s.pendingLanes;s.pendingLanes=o,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=o,s.entangledLanes&=o,s.errorRecoveryDisabledLanes&=o,s.shellSuspendCounter=0;var S=s.entanglements,z=s.expirationTimes,le=s.hiddenUpdates;for(o=w&~o;0<o;){var Te=31-Ee(o),Pe=1<<Te;S[Te]=0,z[Te]=-1;var ce=le[Te];if(ce!==null)for(le[Te]=null,Te=0;Te<ce.length;Te++){var ve=ce[Te];ve!==null&&(ve.lane&=-536870913)}o&=~Pe}c!==0&&os(s,c,0),f!==0&&m===0&&s.tag!==0&&(s.suspendedLanes|=f&~(w&~a))}function os(s,a,o){s.pendingLanes|=a,s.suspendedLanes&=~a;var c=31-Ee(a);s.entangledLanes|=a,s.entanglements[c]=s.entanglements[c]|1073741824|o&261930}function ks(s,a){var o=s.entangledLanes|=a;for(s=s.entanglements;o;){var c=31-Ee(o),m=1<<c;m&a|s[c]&a&&(s[c]|=a),o&=~m}}function Us(s,a){var o=a&-a;return o=(o&42)!==0?1:H(o),(o&(s.suspendedLanes|a))!==0?0:o}function H(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function _e(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Ne(){var s=de.p;return s!==0?s:(s=window.event,s===void 0?32:g1(s.type))}function Se(s,a){var o=de.p;try{return de.p=s,a()}finally{de.p=o}}var je=Math.random().toString(36).slice(2),ct="__reactFiber$"+je,xt="__reactProps$"+je,Ze="__reactContainer$"+je,kt="__reactEvents$"+je,Et="__reactListeners$"+je,Cs="__reactHandles$"+je,hn="__reactResources$"+je,gn="__reactMarker$"+je;function Tn(s){delete s[ct],delete s[xt],delete s[kt],delete s[Et],delete s[Cs]}function In(s){var a=s[ct];if(a)return a;for(var o=s.parentNode;o;){if(a=o[Ze]||o[ct]){if(o=a.alternate,a.child!==null||o!==null&&o.child!==null)for(s=e1(s);s!==null;){if(o=s[ct])return o;s=e1(s)}return a}s=o,o=s.parentNode}return null}function yn(s){if(s=s[ct]||s[Ze]){var a=s.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return s}return null}function zs(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s.stateNode;throw Error(i(33))}function k(s){var a=s[hn];return a||(a=s[hn]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function N(s){s[gn]=!0}var P=new Set,U={};function fe(s,a){Ue(s,a),Ue(s+"Capture",a)}function Ue(s,a){for(U[s]=a,s=0;s<a.length;s++)P.add(a[s])}var Fe=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),st={},et={};function ss(s){return nt.call(et,s)?!0:nt.call(st,s)?!1:Fe.test(s)?et[s]=!0:(st[s]=!0,!1)}function js(s,a,o){if(ss(a))if(o===null)s.removeAttribute(a);else{switch(typeof o){case"undefined":case"function":case"symbol":s.removeAttribute(a);return;case"boolean":var c=a.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){s.removeAttribute(a);return}}s.setAttribute(a,""+o)}}function us(s,a,o){if(o===null)s.removeAttribute(a);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(a);return}s.setAttribute(a,""+o)}}function cs(s,a,o,c){if(c===null)s.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttributeNS(a,o,""+c)}}function qs(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function En(s){var a=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function cr(s,a,o){var c=Object.getOwnPropertyDescriptor(s.constructor.prototype,a);if(!s.hasOwnProperty(a)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var m=c.get,f=c.set;return Object.defineProperty(s,a,{configurable:!0,get:function(){return m.call(this)},set:function(w){o=""+w,f.call(this,w)}}),Object.defineProperty(s,a,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(w){o=""+w},stopTracking:function(){s._valueTracker=null,delete s[a]}}}}function ds(s){if(!s._valueTracker){var a=En(s)?"checked":"value";s._valueTracker=cr(s,a,""+s[a])}}function Xr(s){if(!s)return!1;var a=s._valueTracker;if(!a)return!0;var o=a.getValue(),c="";return s&&(c=En(s)?s.checked?"true":"false":s.value),s=c,s!==o?(a.setValue(s),!0):!1}function Dn(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var X=/[\n"\\]/g;function xe(s){return s.replace(X,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function be(s,a,o,c,m,f,w,S){s.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?s.type=w:s.removeAttribute("type"),a!=null?w==="number"?(a===0&&s.value===""||s.value!=a)&&(s.value=""+qs(a)):s.value!==""+qs(a)&&(s.value=""+qs(a)):w!=="submit"&&w!=="reset"||s.removeAttribute("value"),a!=null?Xe(s,w,qs(a)):o!=null?Xe(s,w,qs(o)):c!=null&&s.removeAttribute("value"),m==null&&f!=null&&(s.defaultChecked=!!f),m!=null&&(s.checked=m&&typeof m!="function"&&typeof m!="symbol"),S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?s.name=""+qs(S):s.removeAttribute("name")}function Je(s,a,o,c,m,f,w,S){if(f!=null&&typeof f!="function"&&typeof f!="symbol"&&typeof f!="boolean"&&(s.type=f),a!=null||o!=null){if(!(f!=="submit"&&f!=="reset"||a!=null)){ds(s);return}o=o!=null?""+qs(o):"",a=a!=null?""+qs(a):o,S||a===s.value||(s.value=a),s.defaultValue=a}c=c??m,c=typeof c!="function"&&typeof c!="symbol"&&!!c,s.checked=S?s.checked:!!c,s.defaultChecked=!!c,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(s.name=w),ds(s)}function Xe(s,a,o){a==="number"&&Dn(s.ownerDocument)===s||s.defaultValue===""+o||(s.defaultValue=""+o)}function ut(s,a,o,c){if(s=s.options,a){a={};for(var m=0;m<o.length;m++)a["$"+o[m]]=!0;for(o=0;o<s.length;o++)m=a.hasOwnProperty("$"+s[o].value),s[o].selected!==m&&(s[o].selected=m),m&&c&&(s[o].defaultSelected=!0)}else{for(o=""+qs(o),a=null,m=0;m<s.length;m++){if(s[m].value===o){s[m].selected=!0,c&&(s[m].defaultSelected=!0);return}a!==null||s[m].disabled||(a=s[m])}a!==null&&(a.selected=!0)}}function Kt(s,a,o){if(a!=null&&(a=""+qs(a),a!==s.value&&(s.value=a),o==null)){s.defaultValue!==a&&(s.defaultValue=a);return}s.defaultValue=o!=null?""+qs(o):""}function Yt(s,a,o,c){if(a==null){if(c!=null){if(o!=null)throw Error(i(92));if(ft(c)){if(1<c.length)throw Error(i(93));c=c[0]}o=c}o==null&&(o=""),a=o}o=qs(a),s.defaultValue=o,c=s.textContent,c===o&&c!==""&&c!==null&&(s.value=c),ds(s)}function Ft(s,a){if(a){var o=s.firstChild;if(o&&o===s.lastChild&&o.nodeType===3){o.nodeValue=a;return}}s.textContent=a}var Sn=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Mt(s,a,o){var c=a.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?s.setProperty(a,""):a==="float"?s.cssFloat="":s[a]="":c?s.setProperty(a,o):typeof o!="number"||o===0||Sn.has(a)?a==="float"?s.cssFloat=o:s[a]=(""+o).trim():s[a]=o+"px"}function Ds(s,a,o){if(a!=null&&typeof a!="object")throw Error(i(62));if(s=s.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||a!=null&&a.hasOwnProperty(c)||(c.indexOf("--")===0?s.setProperty(c,""):c==="float"?s.cssFloat="":s[c]="");for(var m in a)c=a[m],a.hasOwnProperty(m)&&o[m]!==c&&Mt(s,m,c)}else for(var f in a)a.hasOwnProperty(f)&&Mt(s,f,a[f])}function bn(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Wn=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Rs=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Zs(s){return Rs.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Zt(){}var en=null;function mn(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Gn=null,Kn=null;function Nn(s){var a=yn(s);if(a&&(s=a.stateNode)){var o=s[xt]||null;e:switch(s=a.stateNode,a.type){case"input":if(be(s,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),a=o.name,o.type==="radio"&&a!=null){for(o=s;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+xe(""+a)+'"][type="radio"]'),a=0;a<o.length;a++){var c=o[a];if(c!==s&&c.form===s.form){var m=c[xt]||null;if(!m)throw Error(i(90));be(c,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(a=0;a<o.length;a++)c=o[a],c.form===s.form&&Xr(c)}break e;case"textarea":Kt(s,o.value,o.defaultValue);break e;case"select":a=o.value,a!=null&&ut(s,!!o.multiple,a,!1)}}}var Yn=!1;function ur(s,a,o){if(Yn)return s(a,o);Yn=!0;try{var c=s(a);return c}finally{if(Yn=!1,(Gn!==null||Kn!==null)&&(Md(),Gn&&(a=Gn,s=Kn,Kn=Gn=null,Nn(a),s)))for(a=0;a<s.length;a++)Nn(s[a])}}function dr(s,a){var o=s.stateNode;if(o===null)return null;var c=o[xt]||null;if(c===null)return null;o=c[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(s=s.type,c=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!c;break e;default:s=!1}if(s)return null;if(o&&typeof o!="function")throw Error(i(231,a,typeof o));return o}var C=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),J=!1;if(C)try{var Ce={};Object.defineProperty(Ce,"passive",{get:function(){J=!0}}),window.addEventListener("test",Ce,Ce),window.removeEventListener("test",Ce,Ce)}catch{J=!1}var tt=null,Tt=null,Dt=null;function lt(){if(Dt)return Dt;var s,a=Tt,o=a.length,c,m="value"in tt?tt.value:tt.textContent,f=m.length;for(s=0;s<o&&a[s]===m[s];s++);var w=o-s;for(c=1;c<=w&&a[o-c]===m[f-c];c++);return Dt=m.slice(s,1<c?1-c:void 0)}function qt(s){var a=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&a===13&&(s=13)):s=a,s===10&&(s=13),32<=s||s===13?s:0}function Xt(){return!0}function ls(){return!1}function Qt(s){function a(o,c,m,f,w){this._reactName=o,this._targetInst=m,this.type=c,this.nativeEvent=f,this.target=w,this.currentTarget=null;for(var S in s)s.hasOwnProperty(S)&&(o=s[S],this[S]=o?o(f):f[S]);return this.isDefaultPrevented=(f.defaultPrevented!=null?f.defaultPrevented:f.returnValue===!1)?Xt:ls,this.isPropagationStopped=ls,this}return j(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Xt)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Xt)},persist:function(){},isPersistent:Xt}),a}var ws={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Qn=Qt(ws),xr=j({},ws,{view:0,detail:0}),rn=Qt(xr),tn,Xn,fn,zn=j({},xr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ki,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==fn&&(fn&&s.type==="mousemove"?(tn=s.screenX-fn.screenX,Xn=s.screenY-fn.screenY):Xn=tn=0,fn=s),tn)},movementY:function(s){return"movementY"in s?s.movementY:Xn}}),hr=Qt(zn),tr=j({},zn,{dataTransfer:0}),wr=Qt(tr),mr=j({},xr,{relatedTarget:0}),vn=Qt(mr),_r=j({},ws,{animationName:0,elapsedTime:0,pseudoElement:0}),Mr=Qt(_r),Ga=j({},ws,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),sl=Qt(Ga),nl=j({},ws,{data:0}),kr=Qt(nl),da={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ha={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Gu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ku(s){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(s):(s=Gu[s])?!!a[s]:!1}function ki(){return Ku}var jr=j({},xr,{key:function(s){if(s.key){var a=da[s.key]||s.key;if(a!=="Unidentified")return a}return s.type==="keypress"?(s=qt(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?ha[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ki,charCode:function(s){return s.type==="keypress"?qt(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?qt(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Yu=Qt(jr),Qu=j({},zn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ka=Qt(Qu),h=j({},xr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ki}),b=Qt(h),_=j({},ws,{propertyName:0,elapsedTime:0,pseudoElement:0}),A=Qt(_),ie=j({},zn,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),ge=Qt(ie),Ke=j({},ws,{newState:0,oldState:0}),ns=Qt(Ke),Cn=[9,13,27,32],Bs=C&&"CompositionEvent"in window,cn=null;C&&"documentMode"in document&&(cn=document.documentMode);var Jr=C&&"TextEvent"in window&&!cn,Ca=C&&(!Bs||cn&&8<cn&&11>=cn),ma=" ",fa=!1;function vo(s,a){switch(s){case"keyup":return Cn.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rl(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var al=!1;function Gk(s,a){switch(s){case"compositionend":return rl(a);case"keypress":return a.which!==32?null:(fa=!0,ma);case"textInput":return s=a.data,s===ma&&fa?null:s;default:return null}}function Kk(s,a){if(al)return s==="compositionend"||!Bs&&vo(s,a)?(s=lt(),Dt=Tt=tt=null,al=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Ca&&a.locale!=="ko"?null:a.data;default:return null}}var Yk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function nb(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a==="input"?!!Yk[s.type]:a==="textarea"}function rb(s,a,o,c){Gn?Kn?Kn.push(c):Kn=[c]:Gn=c,a=Vd(a,"onChange"),0<a.length&&(o=new Qn("onChange","change",null,o,c),s.push({event:o,listeners:a}))}var dc=null,hc=null;function Qk(s){Uv(s,0)}function Xu(s){var a=zs(s);if(Xr(a))return s}function ab(s,a){if(s==="change")return a}var ib=!1;if(C){var jm;if(C){var Tm="oninput"in document;if(!Tm){var ob=document.createElement("div");ob.setAttribute("oninput","return;"),Tm=typeof ob.oninput=="function"}jm=Tm}else jm=!1;ib=jm&&(!document.documentMode||9<document.documentMode)}function lb(){dc&&(dc.detachEvent("onpropertychange",cb),hc=dc=null)}function cb(s){if(s.propertyName==="value"&&Xu(hc)){var a=[];rb(a,hc,s,mn(s)),ur(Qk,a)}}function Xk(s,a,o){s==="focusin"?(lb(),dc=a,hc=o,dc.attachEvent("onpropertychange",cb)):s==="focusout"&&lb()}function Jk(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Xu(hc)}function Zk(s,a){if(s==="click")return Xu(a)}function ej(s,a){if(s==="input"||s==="change")return Xu(a)}function tj(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var Fr=typeof Object.is=="function"?Object.is:tj;function mc(s,a){if(Fr(s,a))return!0;if(typeof s!="object"||s===null||typeof a!="object"||a===null)return!1;var o=Object.keys(s),c=Object.keys(a);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var m=o[c];if(!nt.call(a,m)||!Fr(s[m],a[m]))return!1}return!0}function ub(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function db(s,a){var o=ub(s);s=0;for(var c;o;){if(o.nodeType===3){if(c=s+o.textContent.length,s<=a&&c>=a)return{node:o,offset:a-s};s=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=ub(o)}}function hb(s,a){return s&&a?s===a?!0:s&&s.nodeType===3?!1:a&&a.nodeType===3?hb(s,a.parentNode):"contains"in s?s.contains(a):s.compareDocumentPosition?!!(s.compareDocumentPosition(a)&16):!1:!1}function mb(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var a=Dn(s.document);a instanceof s.HTMLIFrameElement;){try{var o=typeof a.contentWindow.location.href=="string"}catch{o=!1}if(o)s=a.contentWindow;else break;a=Dn(s.document)}return a}function Em(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a&&(a==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||a==="textarea"||s.contentEditable==="true")}var sj=C&&"documentMode"in document&&11>=document.documentMode,il=null,Sm=null,fc=null,Nm=!1;function fb(s,a,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Nm||il==null||il!==Dn(c)||(c=il,"selectionStart"in c&&Em(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),fc&&mc(fc,c)||(fc=c,c=Vd(Sm,"onSelect"),0<c.length&&(a=new Qn("onSelect","select",null,a,o),s.push({event:a,listeners:c}),a.target=il)))}function xo(s,a){var o={};return o[s.toLowerCase()]=a.toLowerCase(),o["Webkit"+s]="webkit"+a,o["Moz"+s]="moz"+a,o}var ol={animationend:xo("Animation","AnimationEnd"),animationiteration:xo("Animation","AnimationIteration"),animationstart:xo("Animation","AnimationStart"),transitionrun:xo("Transition","TransitionRun"),transitionstart:xo("Transition","TransitionStart"),transitioncancel:xo("Transition","TransitionCancel"),transitionend:xo("Transition","TransitionEnd")},Cm={},pb={};C&&(pb=document.createElement("div").style,"AnimationEvent"in window||(delete ol.animationend.animation,delete ol.animationiteration.animation,delete ol.animationstart.animation),"TransitionEvent"in window||delete ol.transitionend.transition);function wo(s){if(Cm[s])return Cm[s];if(!ol[s])return s;var a=ol[s],o;for(o in a)if(a.hasOwnProperty(o)&&o in pb)return Cm[s]=a[o];return s}var gb=wo("animationend"),yb=wo("animationiteration"),bb=wo("animationstart"),nj=wo("transitionrun"),rj=wo("transitionstart"),aj=wo("transitioncancel"),vb=wo("transitionend"),xb=new Map,Rm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Rm.push("scrollEnd");function pa(s,a){xb.set(s,a),fe(a,[s])}var Ju=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Zr=[],ll=0,Am=0;function Zu(){for(var s=ll,a=Am=ll=0;a<s;){var o=Zr[a];Zr[a++]=null;var c=Zr[a];Zr[a++]=null;var m=Zr[a];Zr[a++]=null;var f=Zr[a];if(Zr[a++]=null,c!==null&&m!==null){var w=c.pending;w===null?m.next=m:(m.next=w.next,w.next=m),c.pending=m}f!==0&&wb(o,m,f)}}function ed(s,a,o,c){Zr[ll++]=s,Zr[ll++]=a,Zr[ll++]=o,Zr[ll++]=c,Am|=c,s.lanes|=c,s=s.alternate,s!==null&&(s.lanes|=c)}function Mm(s,a,o,c){return ed(s,a,o,c),td(s)}function _o(s,a){return ed(s,null,null,a),td(s)}function wb(s,a,o){s.lanes|=o;var c=s.alternate;c!==null&&(c.lanes|=o);for(var m=!1,f=s.return;f!==null;)f.childLanes|=o,c=f.alternate,c!==null&&(c.childLanes|=o),f.tag===22&&(s=f.stateNode,s===null||s._visibility&1||(m=!0)),s=f,f=f.return;return s.tag===3?(f=s.stateNode,m&&a!==null&&(m=31-Ee(o),s=f.hiddenUpdates,c=s[m],c===null?s[m]=[a]:c.push(a),a.lane=o|536870912),f):null}function td(s){if(50<Lc)throw Lc=0,zf=null,Error(i(185));for(var a=s.return;a!==null;)s=a,a=s.return;return s.tag===3?s.stateNode:null}var cl={};function ij(s,a,o,c){this.tag=s,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zr(s,a,o,c){return new ij(s,a,o,c)}function Im(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Ya(s,a){var o=s.alternate;return o===null?(o=zr(s.tag,a,s.key,s.mode),o.elementType=s.elementType,o.type=s.type,o.stateNode=s.stateNode,o.alternate=s,s.alternate=o):(o.pendingProps=a,o.type=s.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=s.flags&65011712,o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,a=s.dependencies,o.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},o.sibling=s.sibling,o.index=s.index,o.ref=s.ref,o.refCleanup=s.refCleanup,o}function _b(s,a){s.flags&=65011714;var o=s.alternate;return o===null?(s.childLanes=0,s.lanes=a,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,a=o.dependencies,s.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),s}function sd(s,a,o,c,m,f){var w=0;if(c=s,typeof s=="function")Im(s)&&(w=1);else if(typeof s=="string")w=dT(s,o,ue.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case M:return s=zr(31,o,a,m),s.elementType=M,s.lanes=f,s;case F:return ko(o.children,m,f,a);case V:w=8,m|=24;break;case te:return s=zr(12,o,a,m|2),s.elementType=te,s.lanes=f,s;case Ae:return s=zr(13,o,a,m),s.elementType=Ae,s.lanes=f,s;case me:return s=zr(19,o,a,m),s.elementType=me,s.lanes=f,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case ae:w=10;break e;case K:w=9;break e;case ye:w=11;break e;case R:w=14;break e;case E:w=16,c=null;break e}w=29,o=Error(i(130,s===null?"null":typeof s,"")),c=null}return a=zr(w,o,a,m),a.elementType=s,a.type=c,a.lanes=f,a}function ko(s,a,o,c){return s=zr(7,s,c,a),s.lanes=o,s}function Dm(s,a,o){return s=zr(6,s,null,a),s.lanes=o,s}function kb(s){var a=zr(18,null,null,0);return a.stateNode=s,a}function Pm(s,a,o){return a=zr(4,s.children!==null?s.children:[],s.key,a),a.lanes=o,a.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},a}var jb=new WeakMap;function ea(s,a){if(typeof s=="object"&&s!==null){var o=jb.get(s);return o!==void 0?o:(a={value:s,source:a,stack:vt(a)},jb.set(s,a),a)}return{value:s,source:a,stack:vt(a)}}var ul=[],dl=0,nd=null,pc=0,ta=[],sa=0,ji=null,Ra=1,Aa="";function Qa(s,a){ul[dl++]=pc,ul[dl++]=nd,nd=s,pc=a}function Tb(s,a,o){ta[sa++]=Ra,ta[sa++]=Aa,ta[sa++]=ji,ji=s;var c=Ra;s=Aa;var m=32-Ee(c)-1;c&=~(1<<m),o+=1;var f=32-Ee(a)+m;if(30<f){var w=m-m%5;f=(c&(1<<w)-1).toString(32),c>>=w,m-=w,Ra=1<<32-Ee(a)+m|o<<m|c,Aa=f+s}else Ra=1<<f|o<<m|c,Aa=s}function Lm(s){s.return!==null&&(Qa(s,1),Tb(s,1,0))}function Om(s){for(;s===nd;)nd=ul[--dl],ul[dl]=null,pc=ul[--dl],ul[dl]=null;for(;s===ji;)ji=ta[--sa],ta[sa]=null,Aa=ta[--sa],ta[sa]=null,Ra=ta[--sa],ta[sa]=null}function Eb(s,a){ta[sa++]=Ra,ta[sa++]=Aa,ta[sa++]=ji,Ra=a.id,Aa=a.overflow,ji=s}var sr=null,on=null,_s=!1,Ti=null,na=!1,Bm=Error(i(519));function Ei(s){var a=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw gc(ea(a,s)),Bm}function Sb(s){var a=s.stateNode,o=s.type,c=s.memoizedProps;switch(a[ct]=s,a[xt]=c,o){case"dialog":ms("cancel",a),ms("close",a);break;case"iframe":case"object":case"embed":ms("load",a);break;case"video":case"audio":for(o=0;o<Bc.length;o++)ms(Bc[o],a);break;case"source":ms("error",a);break;case"img":case"image":case"link":ms("error",a),ms("load",a);break;case"details":ms("toggle",a);break;case"input":ms("invalid",a),Je(a,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":ms("invalid",a);break;case"textarea":ms("invalid",a),Yt(a,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||a.textContent===""+o||c.suppressHydrationWarning===!0||Hv(a.textContent,o)?(c.popover!=null&&(ms("beforetoggle",a),ms("toggle",a)),c.onScroll!=null&&ms("scroll",a),c.onScrollEnd!=null&&ms("scrollend",a),c.onClick!=null&&(a.onclick=Zt),a=!0):a=!1,a||Ei(s,!0)}function Nb(s){for(sr=s.return;sr;)switch(sr.tag){case 5:case 31:case 13:na=!1;return;case 27:case 3:na=!0;return;default:sr=sr.return}}function hl(s){if(s!==sr)return!1;if(!_s)return Nb(s),_s=!0,!1;var a=s.tag,o;if((o=a!==3&&a!==27)&&((o=a===5)&&(o=s.type,o=!(o!=="form"&&o!=="button")||np(s.type,s.memoizedProps)),o=!o),o&&on&&Ei(s),Nb(s),a===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));on=Zv(s)}else if(a===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));on=Zv(s)}else a===27?(a=on,Ui(s.type)?(s=lp,lp=null,on=s):on=a):on=sr?aa(s.stateNode.nextSibling):null;return!0}function jo(){on=sr=null,_s=!1}function Vm(){var s=Ti;return s!==null&&(Lr===null?Lr=s:Lr.push.apply(Lr,s),Ti=null),s}function gc(s){Ti===null?Ti=[s]:Ti.push(s)}var Um=L(null),To=null,Xa=null;function Si(s,a,o){De(Um,a._currentValue),a._currentValue=o}function Ja(s){s._currentValue=Um.current,se(Um)}function Fm(s,a,o){for(;s!==null;){var c=s.alternate;if((s.childLanes&a)!==a?(s.childLanes|=a,c!==null&&(c.childLanes|=a)):c!==null&&(c.childLanes&a)!==a&&(c.childLanes|=a),s===o)break;s=s.return}}function zm(s,a,o,c){var m=s.child;for(m!==null&&(m.return=s);m!==null;){var f=m.dependencies;if(f!==null){var w=m.child;f=f.firstContext;e:for(;f!==null;){var S=f;f=m;for(var z=0;z<a.length;z++)if(S.context===a[z]){f.lanes|=o,S=f.alternate,S!==null&&(S.lanes|=o),Fm(f.return,o,s),c||(w=null);break e}f=S.next}}else if(m.tag===18){if(w=m.return,w===null)throw Error(i(341));w.lanes|=o,f=w.alternate,f!==null&&(f.lanes|=o),Fm(w,o,s),w=null}else w=m.child;if(w!==null)w.return=m;else for(w=m;w!==null;){if(w===s){w=null;break}if(m=w.sibling,m!==null){m.return=w.return,w=m;break}w=w.return}m=w}}function ml(s,a,o,c){s=null;for(var m=a,f=!1;m!==null;){if(!f){if((m.flags&524288)!==0)f=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var w=m.alternate;if(w===null)throw Error(i(387));if(w=w.memoizedProps,w!==null){var S=m.type;Fr(m.pendingProps.value,w.value)||(s!==null?s.push(S):s=[S])}}else if(m===it.current){if(w=m.alternate,w===null)throw Error(i(387));w.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(s!==null?s.push(qc):s=[qc])}m=m.return}s!==null&&zm(a,s,o,c),a.flags|=262144}function rd(s){for(s=s.firstContext;s!==null;){if(!Fr(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Eo(s){To=s,Xa=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function nr(s){return Cb(To,s)}function ad(s,a){return To===null&&Eo(s),Cb(s,a)}function Cb(s,a){var o=a._currentValue;if(a={context:a,memoizedValue:o,next:null},Xa===null){if(s===null)throw Error(i(308));Xa=a,s.dependencies={lanes:0,firstContext:a},s.flags|=524288}else Xa=Xa.next=a;return o}var oj=typeof AbortController<"u"?AbortController:function(){var s=[],a=this.signal={aborted:!1,addEventListener:function(o,c){s.push(c)}};this.abort=function(){a.aborted=!0,s.forEach(function(o){return o()})}},lj=n.unstable_scheduleCallback,cj=n.unstable_NormalPriority,Pn={$$typeof:ae,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function qm(){return{controller:new oj,data:new Map,refCount:0}}function yc(s){s.refCount--,s.refCount===0&&lj(cj,function(){s.controller.abort()})}var bc=null,Hm=0,fl=0,pl=null;function uj(s,a){if(bc===null){var o=bc=[];Hm=0,fl=Kf(),pl={status:"pending",value:void 0,then:function(c){o.push(c)}}}return Hm++,a.then(Rb,Rb),a}function Rb(){if(--Hm===0&&bc!==null){pl!==null&&(pl.status="fulfilled");var s=bc;bc=null,fl=0,pl=null;for(var a=0;a<s.length;a++)(0,s[a])()}}function dj(s,a){var o=[],c={status:"pending",value:null,reason:null,then:function(m){o.push(m)}};return s.then(function(){c.status="fulfilled",c.value=a;for(var m=0;m<o.length;m++)(0,o[m])(a)},function(m){for(c.status="rejected",c.reason=m,m=0;m<o.length;m++)(0,o[m])(void 0)}),c}var Ab=W.S;W.S=function(s,a){fv=Ut(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&uj(s,a),Ab!==null&&Ab(s,a)};var So=L(null);function $m(){var s=So.current;return s!==null?s:sn.pooledCache}function id(s,a){a===null?De(So,So.current):De(So,a.pool)}function Mb(){var s=$m();return s===null?null:{parent:Pn._currentValue,pool:s}}var gl=Error(i(460)),Wm=Error(i(474)),od=Error(i(542)),ld={then:function(){}};function Ib(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Db(s,a,o){switch(o=s[o],o===void 0?s.push(a):o!==a&&(a.then(Zt,Zt),a=o),a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,Lb(s),s;default:if(typeof a.status=="string")a.then(Zt,Zt);else{if(s=sn,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=a,s.status="pending",s.then(function(c){if(a.status==="pending"){var m=a;m.status="fulfilled",m.value=c}},function(c){if(a.status==="pending"){var m=a;m.status="rejected",m.reason=c}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,Lb(s),s}throw Co=a,gl}}function No(s){try{var a=s._init;return a(s._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(Co=o,gl):o}}var Co=null;function Pb(){if(Co===null)throw Error(i(459));var s=Co;return Co=null,s}function Lb(s){if(s===gl||s===od)throw Error(i(483))}var yl=null,vc=0;function cd(s){var a=vc;return vc+=1,yl===null&&(yl=[]),Db(yl,s,a)}function xc(s,a){a=a.props.ref,s.ref=a!==void 0?a:null}function ud(s,a){throw a.$$typeof===T?Error(i(525)):(s=Object.prototype.toString.call(a),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":s)))}function Ob(s){function a(Z,Q){if(s){var oe=Z.deletions;oe===null?(Z.deletions=[Q],Z.flags|=16):oe.push(Q)}}function o(Z,Q){if(!s)return null;for(;Q!==null;)a(Z,Q),Q=Q.sibling;return null}function c(Z){for(var Q=new Map;Z!==null;)Z.key!==null?Q.set(Z.key,Z):Q.set(Z.index,Z),Z=Z.sibling;return Q}function m(Z,Q){return Z=Ya(Z,Q),Z.index=0,Z.sibling=null,Z}function f(Z,Q,oe){return Z.index=oe,s?(oe=Z.alternate,oe!==null?(oe=oe.index,oe<Q?(Z.flags|=67108866,Q):oe):(Z.flags|=67108866,Q)):(Z.flags|=1048576,Q)}function w(Z){return s&&Z.alternate===null&&(Z.flags|=67108866),Z}function S(Z,Q,oe,Me){return Q===null||Q.tag!==6?(Q=Dm(oe,Z.mode,Me),Q.return=Z,Q):(Q=m(Q,oe),Q.return=Z,Q)}function z(Z,Q,oe,Me){var Nt=oe.type;return Nt===F?Te(Z,Q,oe.props.children,Me,oe.key):Q!==null&&(Q.elementType===Nt||typeof Nt=="object"&&Nt!==null&&Nt.$$typeof===E&&No(Nt)===Q.type)?(Q=m(Q,oe.props),xc(Q,oe),Q.return=Z,Q):(Q=sd(oe.type,oe.key,oe.props,null,Z.mode,Me),xc(Q,oe),Q.return=Z,Q)}function le(Z,Q,oe,Me){return Q===null||Q.tag!==4||Q.stateNode.containerInfo!==oe.containerInfo||Q.stateNode.implementation!==oe.implementation?(Q=Pm(oe,Z.mode,Me),Q.return=Z,Q):(Q=m(Q,oe.children||[]),Q.return=Z,Q)}function Te(Z,Q,oe,Me,Nt){return Q===null||Q.tag!==7?(Q=ko(oe,Z.mode,Me,Nt),Q.return=Z,Q):(Q=m(Q,oe),Q.return=Z,Q)}function Pe(Z,Q,oe){if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return Q=Dm(""+Q,Z.mode,oe),Q.return=Z,Q;if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case B:return oe=sd(Q.type,Q.key,Q.props,null,Z.mode,oe),xc(oe,Q),oe.return=Z,oe;case $:return Q=Pm(Q,Z.mode,oe),Q.return=Z,Q;case E:return Q=No(Q),Pe(Z,Q,oe)}if(ft(Q)||q(Q))return Q=ko(Q,Z.mode,oe,null),Q.return=Z,Q;if(typeof Q.then=="function")return Pe(Z,cd(Q),oe);if(Q.$$typeof===ae)return Pe(Z,ad(Z,Q),oe);ud(Z,Q)}return null}function ce(Z,Q,oe,Me){var Nt=Q!==null?Q.key:null;if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return Nt!==null?null:S(Z,Q,""+oe,Me);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case B:return oe.key===Nt?z(Z,Q,oe,Me):null;case $:return oe.key===Nt?le(Z,Q,oe,Me):null;case E:return oe=No(oe),ce(Z,Q,oe,Me)}if(ft(oe)||q(oe))return Nt!==null?null:Te(Z,Q,oe,Me,null);if(typeof oe.then=="function")return ce(Z,Q,cd(oe),Me);if(oe.$$typeof===ae)return ce(Z,Q,ad(Z,oe),Me);ud(Z,oe)}return null}function ve(Z,Q,oe,Me,Nt){if(typeof Me=="string"&&Me!==""||typeof Me=="number"||typeof Me=="bigint")return Z=Z.get(oe)||null,S(Q,Z,""+Me,Nt);if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case B:return Z=Z.get(Me.key===null?oe:Me.key)||null,z(Q,Z,Me,Nt);case $:return Z=Z.get(Me.key===null?oe:Me.key)||null,le(Q,Z,Me,Nt);case E:return Me=No(Me),ve(Z,Q,oe,Me,Nt)}if(ft(Me)||q(Me))return Z=Z.get(oe)||null,Te(Q,Z,Me,Nt,null);if(typeof Me.then=="function")return ve(Z,Q,oe,cd(Me),Nt);if(Me.$$typeof===ae)return ve(Z,Q,oe,ad(Q,Me),Nt);ud(Q,Me)}return null}function yt(Z,Q,oe,Me){for(var Nt=null,Ps=null,wt=Q,as=Q=0,ys=null;wt!==null&&as<oe.length;as++){wt.index>as?(ys=wt,wt=null):ys=wt.sibling;var Ls=ce(Z,wt,oe[as],Me);if(Ls===null){wt===null&&(wt=ys);break}s&&wt&&Ls.alternate===null&&a(Z,wt),Q=f(Ls,Q,as),Ps===null?Nt=Ls:Ps.sibling=Ls,Ps=Ls,wt=ys}if(as===oe.length)return o(Z,wt),_s&&Qa(Z,as),Nt;if(wt===null){for(;as<oe.length;as++)wt=Pe(Z,oe[as],Me),wt!==null&&(Q=f(wt,Q,as),Ps===null?Nt=wt:Ps.sibling=wt,Ps=wt);return _s&&Qa(Z,as),Nt}for(wt=c(wt);as<oe.length;as++)ys=ve(wt,Z,as,oe[as],Me),ys!==null&&(s&&ys.alternate!==null&&wt.delete(ys.key===null?as:ys.key),Q=f(ys,Q,as),Ps===null?Nt=ys:Ps.sibling=ys,Ps=ys);return s&&wt.forEach(function($i){return a(Z,$i)}),_s&&Qa(Z,as),Nt}function It(Z,Q,oe,Me){if(oe==null)throw Error(i(151));for(var Nt=null,Ps=null,wt=Q,as=Q=0,ys=null,Ls=oe.next();wt!==null&&!Ls.done;as++,Ls=oe.next()){wt.index>as?(ys=wt,wt=null):ys=wt.sibling;var $i=ce(Z,wt,Ls.value,Me);if($i===null){wt===null&&(wt=ys);break}s&&wt&&$i.alternate===null&&a(Z,wt),Q=f($i,Q,as),Ps===null?Nt=$i:Ps.sibling=$i,Ps=$i,wt=ys}if(Ls.done)return o(Z,wt),_s&&Qa(Z,as),Nt;if(wt===null){for(;!Ls.done;as++,Ls=oe.next())Ls=Pe(Z,Ls.value,Me),Ls!==null&&(Q=f(Ls,Q,as),Ps===null?Nt=Ls:Ps.sibling=Ls,Ps=Ls);return _s&&Qa(Z,as),Nt}for(wt=c(wt);!Ls.done;as++,Ls=oe.next())Ls=ve(wt,Z,as,Ls.value,Me),Ls!==null&&(s&&Ls.alternate!==null&&wt.delete(Ls.key===null?as:Ls.key),Q=f(Ls,Q,as),Ps===null?Nt=Ls:Ps.sibling=Ls,Ps=Ls);return s&&wt.forEach(function(_T){return a(Z,_T)}),_s&&Qa(Z,as),Nt}function Qs(Z,Q,oe,Me){if(typeof oe=="object"&&oe!==null&&oe.type===F&&oe.key===null&&(oe=oe.props.children),typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case B:e:{for(var Nt=oe.key;Q!==null;){if(Q.key===Nt){if(Nt=oe.type,Nt===F){if(Q.tag===7){o(Z,Q.sibling),Me=m(Q,oe.props.children),Me.return=Z,Z=Me;break e}}else if(Q.elementType===Nt||typeof Nt=="object"&&Nt!==null&&Nt.$$typeof===E&&No(Nt)===Q.type){o(Z,Q.sibling),Me=m(Q,oe.props),xc(Me,oe),Me.return=Z,Z=Me;break e}o(Z,Q);break}else a(Z,Q);Q=Q.sibling}oe.type===F?(Me=ko(oe.props.children,Z.mode,Me,oe.key),Me.return=Z,Z=Me):(Me=sd(oe.type,oe.key,oe.props,null,Z.mode,Me),xc(Me,oe),Me.return=Z,Z=Me)}return w(Z);case $:e:{for(Nt=oe.key;Q!==null;){if(Q.key===Nt)if(Q.tag===4&&Q.stateNode.containerInfo===oe.containerInfo&&Q.stateNode.implementation===oe.implementation){o(Z,Q.sibling),Me=m(Q,oe.children||[]),Me.return=Z,Z=Me;break e}else{o(Z,Q);break}else a(Z,Q);Q=Q.sibling}Me=Pm(oe,Z.mode,Me),Me.return=Z,Z=Me}return w(Z);case E:return oe=No(oe),Qs(Z,Q,oe,Me)}if(ft(oe))return yt(Z,Q,oe,Me);if(q(oe)){if(Nt=q(oe),typeof Nt!="function")throw Error(i(150));return oe=Nt.call(oe),It(Z,Q,oe,Me)}if(typeof oe.then=="function")return Qs(Z,Q,cd(oe),Me);if(oe.$$typeof===ae)return Qs(Z,Q,ad(Z,oe),Me);ud(Z,oe)}return typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint"?(oe=""+oe,Q!==null&&Q.tag===6?(o(Z,Q.sibling),Me=m(Q,oe),Me.return=Z,Z=Me):(o(Z,Q),Me=Dm(oe,Z.mode,Me),Me.return=Z,Z=Me),w(Z)):o(Z,Q)}return function(Z,Q,oe,Me){try{vc=0;var Nt=Qs(Z,Q,oe,Me);return yl=null,Nt}catch(wt){if(wt===gl||wt===od)throw wt;var Ps=zr(29,wt,null,Z.mode);return Ps.lanes=Me,Ps.return=Z,Ps}}}var Ro=Ob(!0),Bb=Ob(!1),Ni=!1;function Gm(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Km(s,a){s=s.updateQueue,a.updateQueue===s&&(a.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Ci(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Ri(s,a,o){var c=s.updateQueue;if(c===null)return null;if(c=c.shared,(Vs&2)!==0){var m=c.pending;return m===null?a.next=a:(a.next=m.next,m.next=a),c.pending=a,a=td(s),wb(s,null,o),a}return ed(s,c,a,o),td(s)}function wc(s,a,o){if(a=a.updateQueue,a!==null&&(a=a.shared,(o&4194048)!==0)){var c=a.lanes;c&=s.pendingLanes,o|=c,a.lanes=o,ks(s,o)}}function Ym(s,a){var o=s.updateQueue,c=s.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var m=null,f=null;if(o=o.firstBaseUpdate,o!==null){do{var w={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};f===null?m=f=w:f=f.next=w,o=o.next}while(o!==null);f===null?m=f=a:f=f.next=a}else m=f=a;o={baseState:c.baseState,firstBaseUpdate:m,lastBaseUpdate:f,shared:c.shared,callbacks:c.callbacks},s.updateQueue=o;return}s=o.lastBaseUpdate,s===null?o.firstBaseUpdate=a:s.next=a,o.lastBaseUpdate=a}var Qm=!1;function _c(){if(Qm){var s=pl;if(s!==null)throw s}}function kc(s,a,o,c){Qm=!1;var m=s.updateQueue;Ni=!1;var f=m.firstBaseUpdate,w=m.lastBaseUpdate,S=m.shared.pending;if(S!==null){m.shared.pending=null;var z=S,le=z.next;z.next=null,w===null?f=le:w.next=le,w=z;var Te=s.alternate;Te!==null&&(Te=Te.updateQueue,S=Te.lastBaseUpdate,S!==w&&(S===null?Te.firstBaseUpdate=le:S.next=le,Te.lastBaseUpdate=z))}if(f!==null){var Pe=m.baseState;w=0,Te=le=z=null,S=f;do{var ce=S.lane&-536870913,ve=ce!==S.lane;if(ve?(gs&ce)===ce:(c&ce)===ce){ce!==0&&ce===fl&&(Qm=!0),Te!==null&&(Te=Te.next={lane:0,tag:S.tag,payload:S.payload,callback:null,next:null});e:{var yt=s,It=S;ce=a;var Qs=o;switch(It.tag){case 1:if(yt=It.payload,typeof yt=="function"){Pe=yt.call(Qs,Pe,ce);break e}Pe=yt;break e;case 3:yt.flags=yt.flags&-65537|128;case 0:if(yt=It.payload,ce=typeof yt=="function"?yt.call(Qs,Pe,ce):yt,ce==null)break e;Pe=j({},Pe,ce);break e;case 2:Ni=!0}}ce=S.callback,ce!==null&&(s.flags|=64,ve&&(s.flags|=8192),ve=m.callbacks,ve===null?m.callbacks=[ce]:ve.push(ce))}else ve={lane:ce,tag:S.tag,payload:S.payload,callback:S.callback,next:null},Te===null?(le=Te=ve,z=Pe):Te=Te.next=ve,w|=ce;if(S=S.next,S===null){if(S=m.shared.pending,S===null)break;ve=S,S=ve.next,ve.next=null,m.lastBaseUpdate=ve,m.shared.pending=null}}while(!0);Te===null&&(z=Pe),m.baseState=z,m.firstBaseUpdate=le,m.lastBaseUpdate=Te,f===null&&(m.shared.lanes=0),Pi|=w,s.lanes=w,s.memoizedState=Pe}}function Vb(s,a){if(typeof s!="function")throw Error(i(191,s));s.call(a)}function Ub(s,a){var o=s.callbacks;if(o!==null)for(s.callbacks=null,s=0;s<o.length;s++)Vb(o[s],a)}var bl=L(null),dd=L(0);function Fb(s,a){s=oi,De(dd,s),De(bl,a),oi=s|a.baseLanes}function Xm(){De(dd,oi),De(bl,bl.current)}function Jm(){oi=dd.current,se(bl),se(dd)}var qr=L(null),ra=null;function Ai(s){var a=s.alternate;De(Rn,Rn.current&1),De(qr,s),ra===null&&(a===null||bl.current!==null||a.memoizedState!==null)&&(ra=s)}function Zm(s){De(Rn,Rn.current),De(qr,s),ra===null&&(ra=s)}function zb(s){s.tag===22?(De(Rn,Rn.current),De(qr,s),ra===null&&(ra=s)):Mi()}function Mi(){De(Rn,Rn.current),De(qr,qr.current)}function Hr(s){se(qr),ra===s&&(ra=null),se(Rn)}var Rn=L(0);function hd(s){for(var a=s;a!==null;){if(a.tag===13){var o=a.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||ip(o)||op(o)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Za=0,rs=null,Ks=null,Ln=null,md=!1,vl=!1,Ao=!1,fd=0,jc=0,xl=null,hj=0;function xn(){throw Error(i(321))}function ef(s,a){if(a===null)return!1;for(var o=0;o<a.length&&o<s.length;o++)if(!Fr(s[o],a[o]))return!1;return!0}function tf(s,a,o,c,m,f){return Za=f,rs=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,W.H=s===null||s.memoizedState===null?T0:yf,Ao=!1,f=o(c,m),Ao=!1,vl&&(f=Hb(a,o,c,m)),qb(s),f}function qb(s){W.H=Sc;var a=Ks!==null&&Ks.next!==null;if(Za=0,Ln=Ks=rs=null,md=!1,jc=0,xl=null,a)throw Error(i(300));s===null||On||(s=s.dependencies,s!==null&&rd(s)&&(On=!0))}function Hb(s,a,o,c){rs=s;var m=0;do{if(vl&&(xl=null),jc=0,vl=!1,25<=m)throw Error(i(301));if(m+=1,Ln=Ks=null,s.updateQueue!=null){var f=s.updateQueue;f.lastEffect=null,f.events=null,f.stores=null,f.memoCache!=null&&(f.memoCache.index=0)}W.H=E0,f=a(o,c)}while(vl);return f}function mj(){var s=W.H,a=s.useState()[0];return a=typeof a.then=="function"?Tc(a):a,s=s.useState()[0],(Ks!==null?Ks.memoizedState:null)!==s&&(rs.flags|=1024),a}function sf(){var s=fd!==0;return fd=0,s}function nf(s,a,o){a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~o}function rf(s){if(md){for(s=s.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}md=!1}Za=0,Ln=Ks=rs=null,vl=!1,jc=fd=0,xl=null}function Tr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ln===null?rs.memoizedState=Ln=s:Ln=Ln.next=s,Ln}function An(){if(Ks===null){var s=rs.alternate;s=s!==null?s.memoizedState:null}else s=Ks.next;var a=Ln===null?rs.memoizedState:Ln.next;if(a!==null)Ln=a,Ks=s;else{if(s===null)throw rs.alternate===null?Error(i(467)):Error(i(310));Ks=s,s={memoizedState:Ks.memoizedState,baseState:Ks.baseState,baseQueue:Ks.baseQueue,queue:Ks.queue,next:null},Ln===null?rs.memoizedState=Ln=s:Ln=Ln.next=s}return Ln}function pd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Tc(s){var a=jc;return jc+=1,xl===null&&(xl=[]),s=Db(xl,s,a),a=rs,(Ln===null?a.memoizedState:Ln.next)===null&&(a=a.alternate,W.H=a===null||a.memoizedState===null?T0:yf),s}function gd(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Tc(s);if(s.$$typeof===ae)return nr(s)}throw Error(i(438,String(s)))}function af(s){var a=null,o=rs.updateQueue;if(o!==null&&(a=o.memoCache),a==null){var c=rs.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(a={data:c.data.map(function(m){return m.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),o===null&&(o=pd(),rs.updateQueue=o),o.memoCache=a,o=a.data[a.index],o===void 0)for(o=a.data[a.index]=Array(s),c=0;c<s;c++)o[c]=O;return a.index++,o}function ei(s,a){return typeof a=="function"?a(s):a}function yd(s){var a=An();return of(a,Ks,s)}function of(s,a,o){var c=s.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=o;var m=s.baseQueue,f=c.pending;if(f!==null){if(m!==null){var w=m.next;m.next=f.next,f.next=w}a.baseQueue=m=f,c.pending=null}if(f=s.baseState,m===null)s.memoizedState=f;else{a=m.next;var S=w=null,z=null,le=a,Te=!1;do{var Pe=le.lane&-536870913;if(Pe!==le.lane?(gs&Pe)===Pe:(Za&Pe)===Pe){var ce=le.revertLane;if(ce===0)z!==null&&(z=z.next={lane:0,revertLane:0,gesture:null,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null}),Pe===fl&&(Te=!0);else if((Za&ce)===ce){le=le.next,ce===fl&&(Te=!0);continue}else Pe={lane:0,revertLane:le.revertLane,gesture:null,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null},z===null?(S=z=Pe,w=f):z=z.next=Pe,rs.lanes|=ce,Pi|=ce;Pe=le.action,Ao&&o(f,Pe),f=le.hasEagerState?le.eagerState:o(f,Pe)}else ce={lane:Pe,revertLane:le.revertLane,gesture:le.gesture,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null},z===null?(S=z=ce,w=f):z=z.next=ce,rs.lanes|=Pe,Pi|=Pe;le=le.next}while(le!==null&&le!==a);if(z===null?w=f:z.next=S,!Fr(f,s.memoizedState)&&(On=!0,Te&&(o=pl,o!==null)))throw o;s.memoizedState=f,s.baseState=w,s.baseQueue=z,c.lastRenderedState=f}return m===null&&(c.lanes=0),[s.memoizedState,c.dispatch]}function lf(s){var a=An(),o=a.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=s;var c=o.dispatch,m=o.pending,f=a.memoizedState;if(m!==null){o.pending=null;var w=m=m.next;do f=s(f,w.action),w=w.next;while(w!==m);Fr(f,a.memoizedState)||(On=!0),a.memoizedState=f,a.baseQueue===null&&(a.baseState=f),o.lastRenderedState=f}return[f,c]}function $b(s,a,o){var c=rs,m=An(),f=_s;if(f){if(o===void 0)throw Error(i(407));o=o()}else o=a();var w=!Fr((Ks||m).memoizedState,o);if(w&&(m.memoizedState=o,On=!0),m=m.queue,df(Kb.bind(null,c,m,s),[s]),m.getSnapshot!==a||w||Ln!==null&&Ln.memoizedState.tag&1){if(c.flags|=2048,wl(9,{destroy:void 0},Gb.bind(null,c,m,o,a),null),sn===null)throw Error(i(349));f||(Za&127)!==0||Wb(c,a,o)}return o}function Wb(s,a,o){s.flags|=16384,s={getSnapshot:a,value:o},a=rs.updateQueue,a===null?(a=pd(),rs.updateQueue=a,a.stores=[s]):(o=a.stores,o===null?a.stores=[s]:o.push(s))}function Gb(s,a,o,c){a.value=o,a.getSnapshot=c,Yb(a)&&Qb(s)}function Kb(s,a,o){return o(function(){Yb(a)&&Qb(s)})}function Yb(s){var a=s.getSnapshot;s=s.value;try{var o=a();return!Fr(s,o)}catch{return!0}}function Qb(s){var a=_o(s,2);a!==null&&Or(a,s,2)}function cf(s){var a=Tr();if(typeof s=="function"){var o=s;if(s=o(),Ao){he(!0);try{o()}finally{he(!1)}}}return a.memoizedState=a.baseState=s,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ei,lastRenderedState:s},a}function Xb(s,a,o,c){return s.baseState=o,of(s,Ks,typeof c=="function"?c:ei)}function fj(s,a,o,c,m){if(xd(s))throw Error(i(485));if(s=a.action,s!==null){var f={payload:m,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){f.listeners.push(w)}};W.T!==null?o(!0):f.isTransition=!1,c(f),o=a.pending,o===null?(f.next=a.pending=f,Jb(a,f)):(f.next=o.next,a.pending=o.next=f)}}function Jb(s,a){var o=a.action,c=a.payload,m=s.state;if(a.isTransition){var f=W.T,w={};W.T=w;try{var S=o(m,c),z=W.S;z!==null&&z(w,S),Zb(s,a,S)}catch(le){uf(s,a,le)}finally{f!==null&&w.types!==null&&(f.types=w.types),W.T=f}}else try{f=o(m,c),Zb(s,a,f)}catch(le){uf(s,a,le)}}function Zb(s,a,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){e0(s,a,c)},function(c){return uf(s,a,c)}):e0(s,a,o)}function e0(s,a,o){a.status="fulfilled",a.value=o,t0(a),s.state=o,a=s.pending,a!==null&&(o=a.next,o===a?s.pending=null:(o=o.next,a.next=o,Jb(s,o)))}function uf(s,a,o){var c=s.pending;if(s.pending=null,c!==null){c=c.next;do a.status="rejected",a.reason=o,t0(a),a=a.next;while(a!==c)}s.action=null}function t0(s){s=s.listeners;for(var a=0;a<s.length;a++)(0,s[a])()}function s0(s,a){return a}function n0(s,a){if(_s){var o=sn.formState;if(o!==null){e:{var c=rs;if(_s){if(on){t:{for(var m=on,f=na;m.nodeType!==8;){if(!f){m=null;break t}if(m=aa(m.nextSibling),m===null){m=null;break t}}f=m.data,m=f==="F!"||f==="F"?m:null}if(m){on=aa(m.nextSibling),c=m.data==="F!";break e}}Ei(c)}c=!1}c&&(a=o[0])}}return o=Tr(),o.memoizedState=o.baseState=a,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s0,lastRenderedState:a},o.queue=c,o=_0.bind(null,rs,c),c.dispatch=o,c=cf(!1),f=gf.bind(null,rs,!1,c.queue),c=Tr(),m={state:a,dispatch:null,action:s,pending:null},c.queue=m,o=fj.bind(null,rs,m,f,o),m.dispatch=o,c.memoizedState=s,[a,o,!1]}function r0(s){var a=An();return a0(a,Ks,s)}function a0(s,a,o){if(a=of(s,a,s0)[0],s=yd(ei)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var c=Tc(a)}catch(w){throw w===gl?od:w}else c=a;a=An();var m=a.queue,f=m.dispatch;return o!==a.memoizedState&&(rs.flags|=2048,wl(9,{destroy:void 0},pj.bind(null,m,o),null)),[c,f,s]}function pj(s,a){s.action=a}function i0(s){var a=An(),o=Ks;if(o!==null)return a0(a,o,s);An(),a=a.memoizedState,o=An();var c=o.queue.dispatch;return o.memoizedState=s,[a,c,!1]}function wl(s,a,o,c){return s={tag:s,create:o,deps:c,inst:a,next:null},a=rs.updateQueue,a===null&&(a=pd(),rs.updateQueue=a),o=a.lastEffect,o===null?a.lastEffect=s.next=s:(c=o.next,o.next=s,s.next=c,a.lastEffect=s),s}function o0(){return An().memoizedState}function bd(s,a,o,c){var m=Tr();rs.flags|=s,m.memoizedState=wl(1|a,{destroy:void 0},o,c===void 0?null:c)}function vd(s,a,o,c){var m=An();c=c===void 0?null:c;var f=m.memoizedState.inst;Ks!==null&&c!==null&&ef(c,Ks.memoizedState.deps)?m.memoizedState=wl(a,f,o,c):(rs.flags|=s,m.memoizedState=wl(1|a,f,o,c))}function l0(s,a){bd(8390656,8,s,a)}function df(s,a){vd(2048,8,s,a)}function gj(s){rs.flags|=4;var a=rs.updateQueue;if(a===null)a=pd(),rs.updateQueue=a,a.events=[s];else{var o=a.events;o===null?a.events=[s]:o.push(s)}}function c0(s){var a=An().memoizedState;return gj({ref:a,nextImpl:s}),function(){if((Vs&2)!==0)throw Error(i(440));return a.impl.apply(void 0,arguments)}}function u0(s,a){return vd(4,2,s,a)}function d0(s,a){return vd(4,4,s,a)}function h0(s,a){if(typeof a=="function"){s=s();var o=a(s);return function(){typeof o=="function"?o():a(null)}}if(a!=null)return s=s(),a.current=s,function(){a.current=null}}function m0(s,a,o){o=o!=null?o.concat([s]):null,vd(4,4,h0.bind(null,a,s),o)}function hf(){}function f0(s,a){var o=An();a=a===void 0?null:a;var c=o.memoizedState;return a!==null&&ef(a,c[1])?c[0]:(o.memoizedState=[s,a],s)}function p0(s,a){var o=An();a=a===void 0?null:a;var c=o.memoizedState;if(a!==null&&ef(a,c[1]))return c[0];if(c=s(),Ao){he(!0);try{s()}finally{he(!1)}}return o.memoizedState=[c,a],c}function mf(s,a,o){return o===void 0||(Za&1073741824)!==0&&(gs&261930)===0?s.memoizedState=a:(s.memoizedState=o,s=gv(),rs.lanes|=s,Pi|=s,o)}function g0(s,a,o,c){return Fr(o,a)?o:bl.current!==null?(s=mf(s,o,c),Fr(s,a)||(On=!0),s):(Za&42)===0||(Za&1073741824)!==0&&(gs&261930)===0?(On=!0,s.memoizedState=o):(s=gv(),rs.lanes|=s,Pi|=s,a)}function y0(s,a,o,c,m){var f=de.p;de.p=f!==0&&8>f?f:8;var w=W.T,S={};W.T=S,gf(s,!1,a,o);try{var z=m(),le=W.S;if(le!==null&&le(S,z),z!==null&&typeof z=="object"&&typeof z.then=="function"){var Te=dj(z,c);Ec(s,a,Te,Gr(s))}else Ec(s,a,c,Gr(s))}catch(Pe){Ec(s,a,{then:function(){},status:"rejected",reason:Pe},Gr())}finally{de.p=f,w!==null&&S.types!==null&&(w.types=S.types),W.T=w}}function yj(){}function ff(s,a,o,c){if(s.tag!==5)throw Error(i(476));var m=b0(s).queue;y0(s,m,a,Ie,o===null?yj:function(){return v0(s),o(c)})}function b0(s){var a=s.memoizedState;if(a!==null)return a;a={memoizedState:Ie,baseState:Ie,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ei,lastRenderedState:Ie},next:null};var o={};return a.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ei,lastRenderedState:o},next:null},s.memoizedState=a,s=s.alternate,s!==null&&(s.memoizedState=a),a}function v0(s){var a=b0(s);a.next===null&&(a=s.alternate.memoizedState),Ec(s,a.next.queue,{},Gr())}function pf(){return nr(qc)}function x0(){return An().memoizedState}function w0(){return An().memoizedState}function bj(s){for(var a=s.return;a!==null;){switch(a.tag){case 24:case 3:var o=Gr();s=Ci(o);var c=Ri(a,s,o);c!==null&&(Or(c,a,o),wc(c,a,o)),a={cache:qm()},s.payload=a;return}a=a.return}}function vj(s,a,o){var c=Gr();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},xd(s)?k0(a,o):(o=Mm(s,a,o,c),o!==null&&(Or(o,s,c),j0(o,a,c)))}function _0(s,a,o){var c=Gr();Ec(s,a,o,c)}function Ec(s,a,o,c){var m={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(xd(s))k0(a,m);else{var f=s.alternate;if(s.lanes===0&&(f===null||f.lanes===0)&&(f=a.lastRenderedReducer,f!==null))try{var w=a.lastRenderedState,S=f(w,o);if(m.hasEagerState=!0,m.eagerState=S,Fr(S,w))return ed(s,a,m,0),sn===null&&Zu(),!1}catch{}if(o=Mm(s,a,m,c),o!==null)return Or(o,s,c),j0(o,a,c),!0}return!1}function gf(s,a,o,c){if(c={lane:2,revertLane:Kf(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},xd(s)){if(a)throw Error(i(479))}else a=Mm(s,o,c,2),a!==null&&Or(a,s,2)}function xd(s){var a=s.alternate;return s===rs||a!==null&&a===rs}function k0(s,a){vl=md=!0;var o=s.pending;o===null?a.next=a:(a.next=o.next,o.next=a),s.pending=a}function j0(s,a,o){if((o&4194048)!==0){var c=a.lanes;c&=s.pendingLanes,o|=c,a.lanes=o,ks(s,o)}}var Sc={readContext:nr,use:gd,useCallback:xn,useContext:xn,useEffect:xn,useImperativeHandle:xn,useLayoutEffect:xn,useInsertionEffect:xn,useMemo:xn,useReducer:xn,useRef:xn,useState:xn,useDebugValue:xn,useDeferredValue:xn,useTransition:xn,useSyncExternalStore:xn,useId:xn,useHostTransitionStatus:xn,useFormState:xn,useActionState:xn,useOptimistic:xn,useMemoCache:xn,useCacheRefresh:xn};Sc.useEffectEvent=xn;var T0={readContext:nr,use:gd,useCallback:function(s,a){return Tr().memoizedState=[s,a===void 0?null:a],s},useContext:nr,useEffect:l0,useImperativeHandle:function(s,a,o){o=o!=null?o.concat([s]):null,bd(4194308,4,h0.bind(null,a,s),o)},useLayoutEffect:function(s,a){return bd(4194308,4,s,a)},useInsertionEffect:function(s,a){bd(4,2,s,a)},useMemo:function(s,a){var o=Tr();a=a===void 0?null:a;var c=s();if(Ao){he(!0);try{s()}finally{he(!1)}}return o.memoizedState=[c,a],c},useReducer:function(s,a,o){var c=Tr();if(o!==void 0){var m=o(a);if(Ao){he(!0);try{o(a)}finally{he(!1)}}}else m=a;return c.memoizedState=c.baseState=m,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:m},c.queue=s,s=s.dispatch=vj.bind(null,rs,s),[c.memoizedState,s]},useRef:function(s){var a=Tr();return s={current:s},a.memoizedState=s},useState:function(s){s=cf(s);var a=s.queue,o=_0.bind(null,rs,a);return a.dispatch=o,[s.memoizedState,o]},useDebugValue:hf,useDeferredValue:function(s,a){var o=Tr();return mf(o,s,a)},useTransition:function(){var s=cf(!1);return s=y0.bind(null,rs,s.queue,!0,!1),Tr().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,a,o){var c=rs,m=Tr();if(_s){if(o===void 0)throw Error(i(407));o=o()}else{if(o=a(),sn===null)throw Error(i(349));(gs&127)!==0||Wb(c,a,o)}m.memoizedState=o;var f={value:o,getSnapshot:a};return m.queue=f,l0(Kb.bind(null,c,f,s),[s]),c.flags|=2048,wl(9,{destroy:void 0},Gb.bind(null,c,f,o,a),null),o},useId:function(){var s=Tr(),a=sn.identifierPrefix;if(_s){var o=Aa,c=Ra;o=(c&~(1<<32-Ee(c)-1)).toString(32)+o,a="_"+a+"R_"+o,o=fd++,0<o&&(a+="H"+o.toString(32)),a+="_"}else o=hj++,a="_"+a+"r_"+o.toString(32)+"_";return s.memoizedState=a},useHostTransitionStatus:pf,useFormState:n0,useActionState:n0,useOptimistic:function(s){var a=Tr();a.memoizedState=a.baseState=s;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=o,a=gf.bind(null,rs,!0,o),o.dispatch=a,[s,a]},useMemoCache:af,useCacheRefresh:function(){return Tr().memoizedState=bj.bind(null,rs)},useEffectEvent:function(s){var a=Tr(),o={impl:s};return a.memoizedState=o,function(){if((Vs&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},yf={readContext:nr,use:gd,useCallback:f0,useContext:nr,useEffect:df,useImperativeHandle:m0,useInsertionEffect:u0,useLayoutEffect:d0,useMemo:p0,useReducer:yd,useRef:o0,useState:function(){return yd(ei)},useDebugValue:hf,useDeferredValue:function(s,a){var o=An();return g0(o,Ks.memoizedState,s,a)},useTransition:function(){var s=yd(ei)[0],a=An().memoizedState;return[typeof s=="boolean"?s:Tc(s),a]},useSyncExternalStore:$b,useId:x0,useHostTransitionStatus:pf,useFormState:r0,useActionState:r0,useOptimistic:function(s,a){var o=An();return Xb(o,Ks,s,a)},useMemoCache:af,useCacheRefresh:w0};yf.useEffectEvent=c0;var E0={readContext:nr,use:gd,useCallback:f0,useContext:nr,useEffect:df,useImperativeHandle:m0,useInsertionEffect:u0,useLayoutEffect:d0,useMemo:p0,useReducer:lf,useRef:o0,useState:function(){return lf(ei)},useDebugValue:hf,useDeferredValue:function(s,a){var o=An();return Ks===null?mf(o,s,a):g0(o,Ks.memoizedState,s,a)},useTransition:function(){var s=lf(ei)[0],a=An().memoizedState;return[typeof s=="boolean"?s:Tc(s),a]},useSyncExternalStore:$b,useId:x0,useHostTransitionStatus:pf,useFormState:i0,useActionState:i0,useOptimistic:function(s,a){var o=An();return Ks!==null?Xb(o,Ks,s,a):(o.baseState=s,[s,o.queue.dispatch])},useMemoCache:af,useCacheRefresh:w0};E0.useEffectEvent=c0;function bf(s,a,o,c){a=s.memoizedState,o=o(c,a),o=o==null?a:j({},a,o),s.memoizedState=o,s.lanes===0&&(s.updateQueue.baseState=o)}var vf={enqueueSetState:function(s,a,o){s=s._reactInternals;var c=Gr(),m=Ci(c);m.payload=a,o!=null&&(m.callback=o),a=Ri(s,m,c),a!==null&&(Or(a,s,c),wc(a,s,c))},enqueueReplaceState:function(s,a,o){s=s._reactInternals;var c=Gr(),m=Ci(c);m.tag=1,m.payload=a,o!=null&&(m.callback=o),a=Ri(s,m,c),a!==null&&(Or(a,s,c),wc(a,s,c))},enqueueForceUpdate:function(s,a){s=s._reactInternals;var o=Gr(),c=Ci(o);c.tag=2,a!=null&&(c.callback=a),a=Ri(s,c,o),a!==null&&(Or(a,s,o),wc(a,s,o))}};function S0(s,a,o,c,m,f,w){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(c,f,w):a.prototype&&a.prototype.isPureReactComponent?!mc(o,c)||!mc(m,f):!0}function N0(s,a,o,c){s=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(o,c),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(o,c),a.state!==s&&vf.enqueueReplaceState(a,a.state,null)}function Mo(s,a){var o=a;if("ref"in a){o={};for(var c in a)c!=="ref"&&(o[c]=a[c])}if(s=s.defaultProps){o===a&&(o=j({},o));for(var m in s)o[m]===void 0&&(o[m]=s[m])}return o}function C0(s){Ju(s)}function R0(s){console.error(s)}function A0(s){Ju(s)}function wd(s,a){try{var o=s.onUncaughtError;o(a.value,{componentStack:a.stack})}catch(c){setTimeout(function(){throw c})}}function M0(s,a,o){try{var c=s.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function xf(s,a,o){return o=Ci(o),o.tag=3,o.payload={element:null},o.callback=function(){wd(s,a)},o}function I0(s){return s=Ci(s),s.tag=3,s}function D0(s,a,o,c){var m=o.type.getDerivedStateFromError;if(typeof m=="function"){var f=c.value;s.payload=function(){return m(f)},s.callback=function(){M0(a,o,c)}}var w=o.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(s.callback=function(){M0(a,o,c),typeof m!="function"&&(Li===null?Li=new Set([this]):Li.add(this));var S=c.stack;this.componentDidCatch(c.value,{componentStack:S!==null?S:""})})}function xj(s,a,o,c,m){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(a=o.alternate,a!==null&&ml(a,o,m,!0),o=qr.current,o!==null){switch(o.tag){case 31:case 13:return ra===null?Id():o.alternate===null&&wn===0&&(wn=3),o.flags&=-257,o.flags|=65536,o.lanes=m,c===ld?o.flags|=16384:(a=o.updateQueue,a===null?o.updateQueue=new Set([c]):a.add(c),$f(s,c,m)),!1;case 22:return o.flags|=65536,c===ld?o.flags|=16384:(a=o.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=a):(o=a.retryQueue,o===null?a.retryQueue=new Set([c]):o.add(c)),$f(s,c,m)),!1}throw Error(i(435,o.tag))}return $f(s,c,m),Id(),!1}if(_s)return a=qr.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=m,c!==Bm&&(s=Error(i(422),{cause:c}),gc(ea(s,o)))):(c!==Bm&&(a=Error(i(423),{cause:c}),gc(ea(a,o))),s=s.current.alternate,s.flags|=65536,m&=-m,s.lanes|=m,c=ea(c,o),m=xf(s.stateNode,c,m),Ym(s,m),wn!==4&&(wn=2)),!1;var f=Error(i(520),{cause:c});if(f=ea(f,o),Pc===null?Pc=[f]:Pc.push(f),wn!==4&&(wn=2),a===null)return!0;c=ea(c,o),o=a;do{switch(o.tag){case 3:return o.flags|=65536,s=m&-m,o.lanes|=s,s=xf(o.stateNode,c,s),Ym(o,s),!1;case 1:if(a=o.type,f=o.stateNode,(o.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||f!==null&&typeof f.componentDidCatch=="function"&&(Li===null||!Li.has(f))))return o.flags|=65536,m&=-m,o.lanes|=m,m=I0(m),D0(m,s,o,c),Ym(o,m),!1}o=o.return}while(o!==null);return!1}var wf=Error(i(461)),On=!1;function rr(s,a,o,c){a.child=s===null?Bb(a,null,o,c):Ro(a,s.child,o,c)}function P0(s,a,o,c,m){o=o.render;var f=a.ref;if("ref"in c){var w={};for(var S in c)S!=="ref"&&(w[S]=c[S])}else w=c;return Eo(a),c=tf(s,a,o,w,f,m),S=sf(),s!==null&&!On?(nf(s,a,m),ti(s,a,m)):(_s&&S&&Lm(a),a.flags|=1,rr(s,a,c,m),a.child)}function L0(s,a,o,c,m){if(s===null){var f=o.type;return typeof f=="function"&&!Im(f)&&f.defaultProps===void 0&&o.compare===null?(a.tag=15,a.type=f,O0(s,a,f,c,m)):(s=sd(o.type,null,c,a,a.mode,m),s.ref=a.ref,s.return=a,a.child=s)}if(f=s.child,!Cf(s,m)){var w=f.memoizedProps;if(o=o.compare,o=o!==null?o:mc,o(w,c)&&s.ref===a.ref)return ti(s,a,m)}return a.flags|=1,s=Ya(f,c),s.ref=a.ref,s.return=a,a.child=s}function O0(s,a,o,c,m){if(s!==null){var f=s.memoizedProps;if(mc(f,c)&&s.ref===a.ref)if(On=!1,a.pendingProps=c=f,Cf(s,m))(s.flags&131072)!==0&&(On=!0);else return a.lanes=s.lanes,ti(s,a,m)}return _f(s,a,o,c,m)}function B0(s,a,o,c){var m=c.children,f=s!==null?s.memoizedState:null;if(s===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((a.flags&128)!==0){if(f=f!==null?f.baseLanes|o:o,s!==null){for(c=a.child=s.child,m=0;c!==null;)m=m|c.lanes|c.childLanes,c=c.sibling;c=m&~f}else c=0,a.child=null;return V0(s,a,f,o,c)}if((o&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},s!==null&&id(a,f!==null?f.cachePool:null),f!==null?Fb(a,f):Xm(),zb(a);else return c=a.lanes=536870912,V0(s,a,f!==null?f.baseLanes|o:o,o,c)}else f!==null?(id(a,f.cachePool),Fb(a,f),Mi(),a.memoizedState=null):(s!==null&&id(a,null),Xm(),Mi());return rr(s,a,m,o),a.child}function Nc(s,a){return s!==null&&s.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function V0(s,a,o,c,m){var f=$m();return f=f===null?null:{parent:Pn._currentValue,pool:f},a.memoizedState={baseLanes:o,cachePool:f},s!==null&&id(a,null),Xm(),zb(a),s!==null&&ml(s,a,c,!0),a.childLanes=m,null}function _d(s,a){return a=jd({mode:a.mode,children:a.children},s.mode),a.ref=s.ref,s.child=a,a.return=s,a}function U0(s,a,o){return Ro(a,s.child,null,o),s=_d(a,a.pendingProps),s.flags|=2,Hr(a),a.memoizedState=null,s}function wj(s,a,o){var c=a.pendingProps,m=(a.flags&128)!==0;if(a.flags&=-129,s===null){if(_s){if(c.mode==="hidden")return s=_d(a,c),a.lanes=536870912,Nc(null,s);if(Zm(a),(s=on)?(s=Jv(s,na),s=s!==null&&s.data==="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:ji!==null?{id:Ra,overflow:Aa}:null,retryLane:536870912,hydrationErrors:null},o=kb(s),o.return=a,a.child=o,sr=a,on=null)):s=null,s===null)throw Ei(a);return a.lanes=536870912,null}return _d(a,c)}var f=s.memoizedState;if(f!==null){var w=f.dehydrated;if(Zm(a),m)if(a.flags&256)a.flags&=-257,a=U0(s,a,o);else if(a.memoizedState!==null)a.child=s.child,a.flags|=128,a=null;else throw Error(i(558));else if(On||ml(s,a,o,!1),m=(o&s.childLanes)!==0,On||m){if(c=sn,c!==null&&(w=Us(c,o),w!==0&&w!==f.retryLane))throw f.retryLane=w,_o(s,w),Or(c,s,w),wf;Id(),a=U0(s,a,o)}else s=f.treeContext,on=aa(w.nextSibling),sr=a,_s=!0,Ti=null,na=!1,s!==null&&Eb(a,s),a=_d(a,c),a.flags|=4096;return a}return s=Ya(s.child,{mode:c.mode,children:c.children}),s.ref=a.ref,a.child=s,s.return=a,s}function kd(s,a){var o=a.ref;if(o===null)s!==null&&s.ref!==null&&(a.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(s===null||s.ref!==o)&&(a.flags|=4194816)}}function _f(s,a,o,c,m){return Eo(a),o=tf(s,a,o,c,void 0,m),c=sf(),s!==null&&!On?(nf(s,a,m),ti(s,a,m)):(_s&&c&&Lm(a),a.flags|=1,rr(s,a,o,m),a.child)}function F0(s,a,o,c,m,f){return Eo(a),a.updateQueue=null,o=Hb(a,c,o,m),qb(s),c=sf(),s!==null&&!On?(nf(s,a,f),ti(s,a,f)):(_s&&c&&Lm(a),a.flags|=1,rr(s,a,o,f),a.child)}function z0(s,a,o,c,m){if(Eo(a),a.stateNode===null){var f=cl,w=o.contextType;typeof w=="object"&&w!==null&&(f=nr(w)),f=new o(c,f),a.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,f.updater=vf,a.stateNode=f,f._reactInternals=a,f=a.stateNode,f.props=c,f.state=a.memoizedState,f.refs={},Gm(a),w=o.contextType,f.context=typeof w=="object"&&w!==null?nr(w):cl,f.state=a.memoizedState,w=o.getDerivedStateFromProps,typeof w=="function"&&(bf(a,o,w,c),f.state=a.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(w=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),w!==f.state&&vf.enqueueReplaceState(f,f.state,null),kc(a,c,f,m),_c(),f.state=a.memoizedState),typeof f.componentDidMount=="function"&&(a.flags|=4194308),c=!0}else if(s===null){f=a.stateNode;var S=a.memoizedProps,z=Mo(o,S);f.props=z;var le=f.context,Te=o.contextType;w=cl,typeof Te=="object"&&Te!==null&&(w=nr(Te));var Pe=o.getDerivedStateFromProps;Te=typeof Pe=="function"||typeof f.getSnapshotBeforeUpdate=="function",S=a.pendingProps!==S,Te||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(S||le!==w)&&N0(a,f,c,w),Ni=!1;var ce=a.memoizedState;f.state=ce,kc(a,c,f,m),_c(),le=a.memoizedState,S||ce!==le||Ni?(typeof Pe=="function"&&(bf(a,o,Pe,c),le=a.memoizedState),(z=Ni||S0(a,o,z,c,ce,le,w))?(Te||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(a.flags|=4194308)):(typeof f.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=c,a.memoizedState=le),f.props=c,f.state=le,f.context=w,c=z):(typeof f.componentDidMount=="function"&&(a.flags|=4194308),c=!1)}else{f=a.stateNode,Km(s,a),w=a.memoizedProps,Te=Mo(o,w),f.props=Te,Pe=a.pendingProps,ce=f.context,le=o.contextType,z=cl,typeof le=="object"&&le!==null&&(z=nr(le)),S=o.getDerivedStateFromProps,(le=typeof S=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(w!==Pe||ce!==z)&&N0(a,f,c,z),Ni=!1,ce=a.memoizedState,f.state=ce,kc(a,c,f,m),_c();var ve=a.memoizedState;w!==Pe||ce!==ve||Ni||s!==null&&s.dependencies!==null&&rd(s.dependencies)?(typeof S=="function"&&(bf(a,o,S,c),ve=a.memoizedState),(Te=Ni||S0(a,o,Te,c,ce,ve,z)||s!==null&&s.dependencies!==null&&rd(s.dependencies))?(le||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(c,ve,z),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(c,ve,z)),typeof f.componentDidUpdate=="function"&&(a.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof f.componentDidUpdate!="function"||w===s.memoizedProps&&ce===s.memoizedState||(a.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||w===s.memoizedProps&&ce===s.memoizedState||(a.flags|=1024),a.memoizedProps=c,a.memoizedState=ve),f.props=c,f.state=ve,f.context=z,c=Te):(typeof f.componentDidUpdate!="function"||w===s.memoizedProps&&ce===s.memoizedState||(a.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||w===s.memoizedProps&&ce===s.memoizedState||(a.flags|=1024),c=!1)}return f=c,kd(s,a),c=(a.flags&128)!==0,f||c?(f=a.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:f.render(),a.flags|=1,s!==null&&c?(a.child=Ro(a,s.child,null,m),a.child=Ro(a,null,o,m)):rr(s,a,o,m),a.memoizedState=f.state,s=a.child):s=ti(s,a,m),s}function q0(s,a,o,c){return jo(),a.flags|=256,rr(s,a,o,c),a.child}var kf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function jf(s){return{baseLanes:s,cachePool:Mb()}}function Tf(s,a,o){return s=s!==null?s.childLanes&~o:0,a&&(s|=Wr),s}function H0(s,a,o){var c=a.pendingProps,m=!1,f=(a.flags&128)!==0,w;if((w=f)||(w=s!==null&&s.memoizedState===null?!1:(Rn.current&2)!==0),w&&(m=!0,a.flags&=-129),w=(a.flags&32)!==0,a.flags&=-33,s===null){if(_s){if(m?Ai(a):Mi(),(s=on)?(s=Jv(s,na),s=s!==null&&s.data!=="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:ji!==null?{id:Ra,overflow:Aa}:null,retryLane:536870912,hydrationErrors:null},o=kb(s),o.return=a,a.child=o,sr=a,on=null)):s=null,s===null)throw Ei(a);return op(s)?a.lanes=32:a.lanes=536870912,null}var S=c.children;return c=c.fallback,m?(Mi(),m=a.mode,S=jd({mode:"hidden",children:S},m),c=ko(c,m,o,null),S.return=a,c.return=a,S.sibling=c,a.child=S,c=a.child,c.memoizedState=jf(o),c.childLanes=Tf(s,w,o),a.memoizedState=kf,Nc(null,c)):(Ai(a),Ef(a,S))}var z=s.memoizedState;if(z!==null&&(S=z.dehydrated,S!==null)){if(f)a.flags&256?(Ai(a),a.flags&=-257,a=Sf(s,a,o)):a.memoizedState!==null?(Mi(),a.child=s.child,a.flags|=128,a=null):(Mi(),S=c.fallback,m=a.mode,c=jd({mode:"visible",children:c.children},m),S=ko(S,m,o,null),S.flags|=2,c.return=a,S.return=a,c.sibling=S,a.child=c,Ro(a,s.child,null,o),c=a.child,c.memoizedState=jf(o),c.childLanes=Tf(s,w,o),a.memoizedState=kf,a=Nc(null,c));else if(Ai(a),op(S)){if(w=S.nextSibling&&S.nextSibling.dataset,w)var le=w.dgst;w=le,c=Error(i(419)),c.stack="",c.digest=w,gc({value:c,source:null,stack:null}),a=Sf(s,a,o)}else if(On||ml(s,a,o,!1),w=(o&s.childLanes)!==0,On||w){if(w=sn,w!==null&&(c=Us(w,o),c!==0&&c!==z.retryLane))throw z.retryLane=c,_o(s,c),Or(w,s,c),wf;ip(S)||Id(),a=Sf(s,a,o)}else ip(S)?(a.flags|=192,a.child=s.child,a=null):(s=z.treeContext,on=aa(S.nextSibling),sr=a,_s=!0,Ti=null,na=!1,s!==null&&Eb(a,s),a=Ef(a,c.children),a.flags|=4096);return a}return m?(Mi(),S=c.fallback,m=a.mode,z=s.child,le=z.sibling,c=Ya(z,{mode:"hidden",children:c.children}),c.subtreeFlags=z.subtreeFlags&65011712,le!==null?S=Ya(le,S):(S=ko(S,m,o,null),S.flags|=2),S.return=a,c.return=a,c.sibling=S,a.child=c,Nc(null,c),c=a.child,S=s.child.memoizedState,S===null?S=jf(o):(m=S.cachePool,m!==null?(z=Pn._currentValue,m=m.parent!==z?{parent:z,pool:z}:m):m=Mb(),S={baseLanes:S.baseLanes|o,cachePool:m}),c.memoizedState=S,c.childLanes=Tf(s,w,o),a.memoizedState=kf,Nc(s.child,c)):(Ai(a),o=s.child,s=o.sibling,o=Ya(o,{mode:"visible",children:c.children}),o.return=a,o.sibling=null,s!==null&&(w=a.deletions,w===null?(a.deletions=[s],a.flags|=16):w.push(s)),a.child=o,a.memoizedState=null,o)}function Ef(s,a){return a=jd({mode:"visible",children:a},s.mode),a.return=s,s.child=a}function jd(s,a){return s=zr(22,s,null,a),s.lanes=0,s}function Sf(s,a,o){return Ro(a,s.child,null,o),s=Ef(a,a.pendingProps.children),s.flags|=2,a.memoizedState=null,s}function $0(s,a,o){s.lanes|=a;var c=s.alternate;c!==null&&(c.lanes|=a),Fm(s.return,a,o)}function Nf(s,a,o,c,m,f){var w=s.memoizedState;w===null?s.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:m,treeForkCount:f}:(w.isBackwards=a,w.rendering=null,w.renderingStartTime=0,w.last=c,w.tail=o,w.tailMode=m,w.treeForkCount=f)}function W0(s,a,o){var c=a.pendingProps,m=c.revealOrder,f=c.tail;c=c.children;var w=Rn.current,S=(w&2)!==0;if(S?(w=w&1|2,a.flags|=128):w&=1,De(Rn,w),rr(s,a,c,o),c=_s?pc:0,!S&&s!==null&&(s.flags&128)!==0)e:for(s=a.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&$0(s,o,a);else if(s.tag===19)$0(s,o,a);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(m){case"forwards":for(o=a.child,m=null;o!==null;)s=o.alternate,s!==null&&hd(s)===null&&(m=o),o=o.sibling;o=m,o===null?(m=a.child,a.child=null):(m=o.sibling,o.sibling=null),Nf(a,!1,m,o,f,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,m=a.child,a.child=null;m!==null;){if(s=m.alternate,s!==null&&hd(s)===null){a.child=m;break}s=m.sibling,m.sibling=o,o=m,m=s}Nf(a,!0,o,null,f,c);break;case"together":Nf(a,!1,null,null,void 0,c);break;default:a.memoizedState=null}return a.child}function ti(s,a,o){if(s!==null&&(a.dependencies=s.dependencies),Pi|=a.lanes,(o&a.childLanes)===0)if(s!==null){if(ml(s,a,o,!1),(o&a.childLanes)===0)return null}else return null;if(s!==null&&a.child!==s.child)throw Error(i(153));if(a.child!==null){for(s=a.child,o=Ya(s,s.pendingProps),a.child=o,o.return=a;s.sibling!==null;)s=s.sibling,o=o.sibling=Ya(s,s.pendingProps),o.return=a;o.sibling=null}return a.child}function Cf(s,a){return(s.lanes&a)!==0?!0:(s=s.dependencies,!!(s!==null&&rd(s)))}function _j(s,a,o){switch(a.tag){case 3:pt(a,a.stateNode.containerInfo),Si(a,Pn,s.memoizedState.cache),jo();break;case 27:case 5:Ht(a);break;case 4:pt(a,a.stateNode.containerInfo);break;case 10:Si(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,Zm(a),null;break;case 13:var c=a.memoizedState;if(c!==null)return c.dehydrated!==null?(Ai(a),a.flags|=128,null):(o&a.child.childLanes)!==0?H0(s,a,o):(Ai(a),s=ti(s,a,o),s!==null?s.sibling:null);Ai(a);break;case 19:var m=(s.flags&128)!==0;if(c=(o&a.childLanes)!==0,c||(ml(s,a,o,!1),c=(o&a.childLanes)!==0),m){if(c)return W0(s,a,o);a.flags|=128}if(m=a.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),De(Rn,Rn.current),c)break;return null;case 22:return a.lanes=0,B0(s,a,o,a.pendingProps);case 24:Si(a,Pn,s.memoizedState.cache)}return ti(s,a,o)}function G0(s,a,o){if(s!==null)if(s.memoizedProps!==a.pendingProps)On=!0;else{if(!Cf(s,o)&&(a.flags&128)===0)return On=!1,_j(s,a,o);On=(s.flags&131072)!==0}else On=!1,_s&&(a.flags&1048576)!==0&&Tb(a,pc,a.index);switch(a.lanes=0,a.tag){case 16:e:{var c=a.pendingProps;if(s=No(a.elementType),a.type=s,typeof s=="function")Im(s)?(c=Mo(s,c),a.tag=1,a=z0(null,a,s,c,o)):(a.tag=0,a=_f(null,a,s,c,o));else{if(s!=null){var m=s.$$typeof;if(m===ye){a.tag=11,a=P0(null,a,s,c,o);break e}else if(m===R){a.tag=14,a=L0(null,a,s,c,o);break e}}throw a=qe(s)||s,Error(i(306,a,""))}}return a;case 0:return _f(s,a,a.type,a.pendingProps,o);case 1:return c=a.type,m=Mo(c,a.pendingProps),z0(s,a,c,m,o);case 3:e:{if(pt(a,a.stateNode.containerInfo),s===null)throw Error(i(387));c=a.pendingProps;var f=a.memoizedState;m=f.element,Km(s,a),kc(a,c,null,o);var w=a.memoizedState;if(c=w.cache,Si(a,Pn,c),c!==f.cache&&zm(a,[Pn],o,!0),_c(),c=w.element,f.isDehydrated)if(f={element:c,isDehydrated:!1,cache:w.cache},a.updateQueue.baseState=f,a.memoizedState=f,a.flags&256){a=q0(s,a,c,o);break e}else if(c!==m){m=ea(Error(i(424)),a),gc(m),a=q0(s,a,c,o);break e}else for(s=a.stateNode.containerInfo,s.nodeType===9?s=s.body:s=s.nodeName==="HTML"?s.ownerDocument.body:s,on=aa(s.firstChild),sr=a,_s=!0,Ti=null,na=!0,o=Bb(a,null,c,o),a.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(jo(),c===m){a=ti(s,a,o);break e}rr(s,a,c,o)}a=a.child}return a;case 26:return kd(s,a),s===null?(o=r1(a.type,null,a.pendingProps,null))?a.memoizedState=o:_s||(o=a.type,s=a.pendingProps,c=Ud(Le.current).createElement(o),c[ct]=a,c[xt]=s,ar(c,o,s),N(c),a.stateNode=c):a.memoizedState=r1(a.type,s.memoizedProps,a.pendingProps,s.memoizedState),null;case 27:return Ht(a),s===null&&_s&&(c=a.stateNode=t1(a.type,a.pendingProps,Le.current),sr=a,na=!0,m=on,Ui(a.type)?(lp=m,on=aa(c.firstChild)):on=m),rr(s,a,a.pendingProps.children,o),kd(s,a),s===null&&(a.flags|=4194304),a.child;case 5:return s===null&&_s&&((m=c=on)&&(c=Jj(c,a.type,a.pendingProps,na),c!==null?(a.stateNode=c,sr=a,on=aa(c.firstChild),na=!1,m=!0):m=!1),m||Ei(a)),Ht(a),m=a.type,f=a.pendingProps,w=s!==null?s.memoizedProps:null,c=f.children,np(m,f)?c=null:w!==null&&np(m,w)&&(a.flags|=32),a.memoizedState!==null&&(m=tf(s,a,mj,null,null,o),qc._currentValue=m),kd(s,a),rr(s,a,c,o),a.child;case 6:return s===null&&_s&&((s=o=on)&&(o=Zj(o,a.pendingProps,na),o!==null?(a.stateNode=o,sr=a,on=null,s=!0):s=!1),s||Ei(a)),null;case 13:return H0(s,a,o);case 4:return pt(a,a.stateNode.containerInfo),c=a.pendingProps,s===null?a.child=Ro(a,null,c,o):rr(s,a,c,o),a.child;case 11:return P0(s,a,a.type,a.pendingProps,o);case 7:return rr(s,a,a.pendingProps,o),a.child;case 8:return rr(s,a,a.pendingProps.children,o),a.child;case 12:return rr(s,a,a.pendingProps.children,o),a.child;case 10:return c=a.pendingProps,Si(a,a.type,c.value),rr(s,a,c.children,o),a.child;case 9:return m=a.type._context,c=a.pendingProps.children,Eo(a),m=nr(m),c=c(m),a.flags|=1,rr(s,a,c,o),a.child;case 14:return L0(s,a,a.type,a.pendingProps,o);case 15:return O0(s,a,a.type,a.pendingProps,o);case 19:return W0(s,a,o);case 31:return wj(s,a,o);case 22:return B0(s,a,o,a.pendingProps);case 24:return Eo(a),c=nr(Pn),s===null?(m=$m(),m===null&&(m=sn,f=qm(),m.pooledCache=f,f.refCount++,f!==null&&(m.pooledCacheLanes|=o),m=f),a.memoizedState={parent:c,cache:m},Gm(a),Si(a,Pn,m)):((s.lanes&o)!==0&&(Km(s,a),kc(a,null,null,o),_c()),m=s.memoizedState,f=a.memoizedState,m.parent!==c?(m={parent:c,cache:c},a.memoizedState=m,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=m),Si(a,Pn,c)):(c=f.cache,Si(a,Pn,c),c!==m.cache&&zm(a,[Pn],o,!0))),rr(s,a,a.pendingProps.children,o),a.child;case 29:throw a.pendingProps}throw Error(i(156,a.tag))}function si(s){s.flags|=4}function Rf(s,a,o,c,m){if((a=(s.mode&32)!==0)&&(a=!1),a){if(s.flags|=16777216,(m&335544128)===m)if(s.stateNode.complete)s.flags|=8192;else if(xv())s.flags|=8192;else throw Co=ld,Wm}else s.flags&=-16777217}function K0(s,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!c1(a))if(xv())s.flags|=8192;else throw Co=ld,Wm}function Td(s,a){a!==null&&(s.flags|=4),s.flags&16384&&(a=s.tag!==22?jt():536870912,s.lanes|=a,Tl|=a)}function Cc(s,a){if(!_s)switch(s.tailMode){case"hidden":a=s.tail;for(var o=null;a!==null;)a.alternate!==null&&(o=a),a=a.sibling;o===null?s.tail=null:o.sibling=null;break;case"collapsed":o=s.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?a||s.tail===null?s.tail=null:s.tail.sibling=null:c.sibling=null}}function ln(s){var a=s.alternate!==null&&s.alternate.child===s.child,o=0,c=0;if(a)for(var m=s.child;m!==null;)o|=m.lanes|m.childLanes,c|=m.subtreeFlags&65011712,c|=m.flags&65011712,m.return=s,m=m.sibling;else for(m=s.child;m!==null;)o|=m.lanes|m.childLanes,c|=m.subtreeFlags,c|=m.flags,m.return=s,m=m.sibling;return s.subtreeFlags|=c,s.childLanes=o,a}function kj(s,a,o){var c=a.pendingProps;switch(Om(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ln(a),null;case 1:return ln(a),null;case 3:return o=a.stateNode,c=null,s!==null&&(c=s.memoizedState.cache),a.memoizedState.cache!==c&&(a.flags|=2048),Ja(Pn),Ye(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(s===null||s.child===null)&&(hl(a)?si(a):s===null||s.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Vm())),ln(a),null;case 26:var m=a.type,f=a.memoizedState;return s===null?(si(a),f!==null?(ln(a),K0(a,f)):(ln(a),Rf(a,m,null,c,o))):f?f!==s.memoizedState?(si(a),ln(a),K0(a,f)):(ln(a),a.flags&=-16777217):(s=s.memoizedProps,s!==c&&si(a),ln(a),Rf(a,m,s,c,o)),null;case 27:if(Ms(a),o=Le.current,m=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==c&&si(a);else{if(!c){if(a.stateNode===null)throw Error(i(166));return ln(a),null}s=ue.current,hl(a)?Sb(a):(s=t1(m,c,o),a.stateNode=s,si(a))}return ln(a),null;case 5:if(Ms(a),m=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==c&&si(a);else{if(!c){if(a.stateNode===null)throw Error(i(166));return ln(a),null}if(f=ue.current,hl(a))Sb(a);else{var w=Ud(Le.current);switch(f){case 1:f=w.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:f=w.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":f=w.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":f=w.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":f=w.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild);break;case"select":f=typeof c.is=="string"?w.createElement("select",{is:c.is}):w.createElement("select"),c.multiple?f.multiple=!0:c.size&&(f.size=c.size);break;default:f=typeof c.is=="string"?w.createElement(m,{is:c.is}):w.createElement(m)}}f[ct]=a,f[xt]=c;e:for(w=a.child;w!==null;){if(w.tag===5||w.tag===6)f.appendChild(w.stateNode);else if(w.tag!==4&&w.tag!==27&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===a)break e;for(;w.sibling===null;){if(w.return===null||w.return===a)break e;w=w.return}w.sibling.return=w.return,w=w.sibling}a.stateNode=f;e:switch(ar(f,m,c),m){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&si(a)}}return ln(a),Rf(a,a.type,s===null?null:s.memoizedProps,a.pendingProps,o),null;case 6:if(s&&a.stateNode!=null)s.memoizedProps!==c&&si(a);else{if(typeof c!="string"&&a.stateNode===null)throw Error(i(166));if(s=Le.current,hl(a)){if(s=a.stateNode,o=a.memoizedProps,c=null,m=sr,m!==null)switch(m.tag){case 27:case 5:c=m.memoizedProps}s[ct]=a,s=!!(s.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||Hv(s.nodeValue,o)),s||Ei(a,!0)}else s=Ud(s).createTextNode(c),s[ct]=a,a.stateNode=s}return ln(a),null;case 31:if(o=a.memoizedState,s===null||s.memoizedState!==null){if(c=hl(a),o!==null){if(s===null){if(!c)throw Error(i(318));if(s=a.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[ct]=a}else jo(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;ln(a),s=!1}else o=Vm(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=o),s=!0;if(!s)return a.flags&256?(Hr(a),a):(Hr(a),null);if((a.flags&128)!==0)throw Error(i(558))}return ln(a),null;case 13:if(c=a.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(m=hl(a),c!==null&&c.dehydrated!==null){if(s===null){if(!m)throw Error(i(318));if(m=a.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(i(317));m[ct]=a}else jo(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;ln(a),m=!1}else m=Vm(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=m),m=!0;if(!m)return a.flags&256?(Hr(a),a):(Hr(a),null)}return Hr(a),(a.flags&128)!==0?(a.lanes=o,a):(o=c!==null,s=s!==null&&s.memoizedState!==null,o&&(c=a.child,m=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(m=c.alternate.memoizedState.cachePool.pool),f=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(f=c.memoizedState.cachePool.pool),f!==m&&(c.flags|=2048)),o!==s&&o&&(a.child.flags|=8192),Td(a,a.updateQueue),ln(a),null);case 4:return Ye(),s===null&&Jf(a.stateNode.containerInfo),ln(a),null;case 10:return Ja(a.type),ln(a),null;case 19:if(se(Rn),c=a.memoizedState,c===null)return ln(a),null;if(m=(a.flags&128)!==0,f=c.rendering,f===null)if(m)Cc(c,!1);else{if(wn!==0||s!==null&&(s.flags&128)!==0)for(s=a.child;s!==null;){if(f=hd(s),f!==null){for(a.flags|=128,Cc(c,!1),s=f.updateQueue,a.updateQueue=s,Td(a,s),a.subtreeFlags=0,s=o,o=a.child;o!==null;)_b(o,s),o=o.sibling;return De(Rn,Rn.current&1|2),_s&&Qa(a,c.treeForkCount),a.child}s=s.sibling}c.tail!==null&&Ut()>Rd&&(a.flags|=128,m=!0,Cc(c,!1),a.lanes=4194304)}else{if(!m)if(s=hd(f),s!==null){if(a.flags|=128,m=!0,s=s.updateQueue,a.updateQueue=s,Td(a,s),Cc(c,!0),c.tail===null&&c.tailMode==="hidden"&&!f.alternate&&!_s)return ln(a),null}else 2*Ut()-c.renderingStartTime>Rd&&o!==536870912&&(a.flags|=128,m=!0,Cc(c,!1),a.lanes=4194304);c.isBackwards?(f.sibling=a.child,a.child=f):(s=c.last,s!==null?s.sibling=f:a.child=f,c.last=f)}return c.tail!==null?(s=c.tail,c.rendering=s,c.tail=s.sibling,c.renderingStartTime=Ut(),s.sibling=null,o=Rn.current,De(Rn,m?o&1|2:o&1),_s&&Qa(a,c.treeForkCount),s):(ln(a),null);case 22:case 23:return Hr(a),Jm(),c=a.memoizedState!==null,s!==null?s.memoizedState!==null!==c&&(a.flags|=8192):c&&(a.flags|=8192),c?(o&536870912)!==0&&(a.flags&128)===0&&(ln(a),a.subtreeFlags&6&&(a.flags|=8192)):ln(a),o=a.updateQueue,o!==null&&Td(a,o.retryQueue),o=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),c=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),c!==o&&(a.flags|=2048),s!==null&&se(So),null;case 24:return o=null,s!==null&&(o=s.memoizedState.cache),a.memoizedState.cache!==o&&(a.flags|=2048),Ja(Pn),ln(a),null;case 25:return null;case 30:return null}throw Error(i(156,a.tag))}function jj(s,a){switch(Om(a),a.tag){case 1:return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 3:return Ja(Pn),Ye(),s=a.flags,(s&65536)!==0&&(s&128)===0?(a.flags=s&-65537|128,a):null;case 26:case 27:case 5:return Ms(a),null;case 31:if(a.memoizedState!==null){if(Hr(a),a.alternate===null)throw Error(i(340));jo()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 13:if(Hr(a),s=a.memoizedState,s!==null&&s.dehydrated!==null){if(a.alternate===null)throw Error(i(340));jo()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 19:return se(Rn),null;case 4:return Ye(),null;case 10:return Ja(a.type),null;case 22:case 23:return Hr(a),Jm(),s!==null&&se(So),s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 24:return Ja(Pn),null;case 25:return null;default:return null}}function Y0(s,a){switch(Om(a),a.tag){case 3:Ja(Pn),Ye();break;case 26:case 27:case 5:Ms(a);break;case 4:Ye();break;case 31:a.memoizedState!==null&&Hr(a);break;case 13:Hr(a);break;case 19:se(Rn);break;case 10:Ja(a.type);break;case 22:case 23:Hr(a),Jm(),s!==null&&se(So);break;case 24:Ja(Pn)}}function Rc(s,a){try{var o=a.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var m=c.next;o=m;do{if((o.tag&s)===s){c=void 0;var f=o.create,w=o.inst;c=f(),w.destroy=c}o=o.next}while(o!==m)}}catch(S){$s(a,a.return,S)}}function Ii(s,a,o){try{var c=a.updateQueue,m=c!==null?c.lastEffect:null;if(m!==null){var f=m.next;c=f;do{if((c.tag&s)===s){var w=c.inst,S=w.destroy;if(S!==void 0){w.destroy=void 0,m=a;var z=o,le=S;try{le()}catch(Te){$s(m,z,Te)}}}c=c.next}while(c!==f)}}catch(Te){$s(a,a.return,Te)}}function Q0(s){var a=s.updateQueue;if(a!==null){var o=s.stateNode;try{Ub(a,o)}catch(c){$s(s,s.return,c)}}}function X0(s,a,o){o.props=Mo(s.type,s.memoizedProps),o.state=s.memoizedState;try{o.componentWillUnmount()}catch(c){$s(s,a,c)}}function Ac(s,a){try{var o=s.ref;if(o!==null){switch(s.tag){case 26:case 27:case 5:var c=s.stateNode;break;case 30:c=s.stateNode;break;default:c=s.stateNode}typeof o=="function"?s.refCleanup=o(c):o.current=c}}catch(m){$s(s,a,m)}}function Ma(s,a){var o=s.ref,c=s.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(m){$s(s,a,m)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(m){$s(s,a,m)}else o.current=null}function J0(s){var a=s.type,o=s.memoizedProps,c=s.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(m){$s(s,s.return,m)}}function Af(s,a,o){try{var c=s.stateNode;Wj(c,s.type,o,a),c[xt]=a}catch(m){$s(s,s.return,m)}}function Z0(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Ui(s.type)||s.tag===4}function Mf(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Z0(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Ui(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function If(s,a,o){var c=s.tag;if(c===5||c===6)s=s.stateNode,a?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(s,a):(a=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,a.appendChild(s),o=o._reactRootContainer,o!=null||a.onclick!==null||(a.onclick=Zt));else if(c!==4&&(c===27&&Ui(s.type)&&(o=s.stateNode,a=null),s=s.child,s!==null))for(If(s,a,o),s=s.sibling;s!==null;)If(s,a,o),s=s.sibling}function Ed(s,a,o){var c=s.tag;if(c===5||c===6)s=s.stateNode,a?o.insertBefore(s,a):o.appendChild(s);else if(c!==4&&(c===27&&Ui(s.type)&&(o=s.stateNode),s=s.child,s!==null))for(Ed(s,a,o),s=s.sibling;s!==null;)Ed(s,a,o),s=s.sibling}function ev(s){var a=s.stateNode,o=s.memoizedProps;try{for(var c=s.type,m=a.attributes;m.length;)a.removeAttributeNode(m[0]);ar(a,c,o),a[ct]=s,a[xt]=o}catch(f){$s(s,s.return,f)}}var ni=!1,Bn=!1,Df=!1,tv=typeof WeakSet=="function"?WeakSet:Set,Jn=null;function Tj(s,a){if(s=s.containerInfo,tp=Gd,s=mb(s),Em(s)){if("selectionStart"in s)var o={start:s.selectionStart,end:s.selectionEnd};else e:{o=(o=s.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var m=c.anchorOffset,f=c.focusNode;c=c.focusOffset;try{o.nodeType,f.nodeType}catch{o=null;break e}var w=0,S=-1,z=-1,le=0,Te=0,Pe=s,ce=null;t:for(;;){for(var ve;Pe!==o||m!==0&&Pe.nodeType!==3||(S=w+m),Pe!==f||c!==0&&Pe.nodeType!==3||(z=w+c),Pe.nodeType===3&&(w+=Pe.nodeValue.length),(ve=Pe.firstChild)!==null;)ce=Pe,Pe=ve;for(;;){if(Pe===s)break t;if(ce===o&&++le===m&&(S=w),ce===f&&++Te===c&&(z=w),(ve=Pe.nextSibling)!==null)break;Pe=ce,ce=Pe.parentNode}Pe=ve}o=S===-1||z===-1?null:{start:S,end:z}}else o=null}o=o||{start:0,end:0}}else o=null;for(sp={focusedElem:s,selectionRange:o},Gd=!1,Jn=a;Jn!==null;)if(a=Jn,s=a.child,(a.subtreeFlags&1028)!==0&&s!==null)s.return=a,Jn=s;else for(;Jn!==null;){switch(a=Jn,f=a.alternate,s=a.flags,a.tag){case 0:if((s&4)!==0&&(s=a.updateQueue,s=s!==null?s.events:null,s!==null))for(o=0;o<s.length;o++)m=s[o],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&f!==null){s=void 0,o=a,m=f.memoizedProps,f=f.memoizedState,c=o.stateNode;try{var yt=Mo(o.type,m);s=c.getSnapshotBeforeUpdate(yt,f),c.__reactInternalSnapshotBeforeUpdate=s}catch(It){$s(o,o.return,It)}}break;case 3:if((s&1024)!==0){if(s=a.stateNode.containerInfo,o=s.nodeType,o===9)ap(s);else if(o===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":ap(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=a.sibling,s!==null){s.return=a.return,Jn=s;break}Jn=a.return}}function sv(s,a,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:ai(s,o),c&4&&Rc(5,o);break;case 1:if(ai(s,o),c&4)if(s=o.stateNode,a===null)try{s.componentDidMount()}catch(w){$s(o,o.return,w)}else{var m=Mo(o.type,a.memoizedProps);a=a.memoizedState;try{s.componentDidUpdate(m,a,s.__reactInternalSnapshotBeforeUpdate)}catch(w){$s(o,o.return,w)}}c&64&&Q0(o),c&512&&Ac(o,o.return);break;case 3:if(ai(s,o),c&64&&(s=o.updateQueue,s!==null)){if(a=null,o.child!==null)switch(o.child.tag){case 27:case 5:a=o.child.stateNode;break;case 1:a=o.child.stateNode}try{Ub(s,a)}catch(w){$s(o,o.return,w)}}break;case 27:a===null&&c&4&&ev(o);case 26:case 5:ai(s,o),a===null&&c&4&&J0(o),c&512&&Ac(o,o.return);break;case 12:ai(s,o);break;case 31:ai(s,o),c&4&&av(s,o);break;case 13:ai(s,o),c&4&&iv(s,o),c&64&&(s=o.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(o=Dj.bind(null,o),eT(s,o))));break;case 22:if(c=o.memoizedState!==null||ni,!c){a=a!==null&&a.memoizedState!==null||Bn,m=ni;var f=Bn;ni=c,(Bn=a)&&!f?ii(s,o,(o.subtreeFlags&8772)!==0):ai(s,o),ni=m,Bn=f}break;case 30:break;default:ai(s,o)}}function nv(s){var a=s.alternate;a!==null&&(s.alternate=null,nv(a)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(a=s.stateNode,a!==null&&Tn(a)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var un=null,Ir=!1;function ri(s,a,o){for(o=o.child;o!==null;)rv(s,a,o),o=o.sibling}function rv(s,a,o){if(G&&typeof G.onCommitFiberUnmount=="function")try{G.onCommitFiberUnmount(we,o)}catch{}switch(o.tag){case 26:Bn||Ma(o,a),ri(s,a,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Bn||Ma(o,a);var c=un,m=Ir;Ui(o.type)&&(un=o.stateNode,Ir=!1),ri(s,a,o),Uc(o.stateNode),un=c,Ir=m;break;case 5:Bn||Ma(o,a);case 6:if(c=un,m=Ir,un=null,ri(s,a,o),un=c,Ir=m,un!==null)if(Ir)try{(un.nodeType===9?un.body:un.nodeName==="HTML"?un.ownerDocument.body:un).removeChild(o.stateNode)}catch(f){$s(o,a,f)}else try{un.removeChild(o.stateNode)}catch(f){$s(o,a,f)}break;case 18:un!==null&&(Ir?(s=un,Qv(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,o.stateNode),Il(s)):Qv(un,o.stateNode));break;case 4:c=un,m=Ir,un=o.stateNode.containerInfo,Ir=!0,ri(s,a,o),un=c,Ir=m;break;case 0:case 11:case 14:case 15:Ii(2,o,a),Bn||Ii(4,o,a),ri(s,a,o);break;case 1:Bn||(Ma(o,a),c=o.stateNode,typeof c.componentWillUnmount=="function"&&X0(o,a,c)),ri(s,a,o);break;case 21:ri(s,a,o);break;case 22:Bn=(c=Bn)||o.memoizedState!==null,ri(s,a,o),Bn=c;break;default:ri(s,a,o)}}function av(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Il(s)}catch(o){$s(a,a.return,o)}}}function iv(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Il(s)}catch(o){$s(a,a.return,o)}}function Ej(s){switch(s.tag){case 31:case 13:case 19:var a=s.stateNode;return a===null&&(a=s.stateNode=new tv),a;case 22:return s=s.stateNode,a=s._retryCache,a===null&&(a=s._retryCache=new tv),a;default:throw Error(i(435,s.tag))}}function Sd(s,a){var o=Ej(s);a.forEach(function(c){if(!o.has(c)){o.add(c);var m=Pj.bind(null,s,c);c.then(m,m)}})}function Dr(s,a){var o=a.deletions;if(o!==null)for(var c=0;c<o.length;c++){var m=o[c],f=s,w=a,S=w;e:for(;S!==null;){switch(S.tag){case 27:if(Ui(S.type)){un=S.stateNode,Ir=!1;break e}break;case 5:un=S.stateNode,Ir=!1;break e;case 3:case 4:un=S.stateNode.containerInfo,Ir=!0;break e}S=S.return}if(un===null)throw Error(i(160));rv(f,w,m),un=null,Ir=!1,f=m.alternate,f!==null&&(f.return=null),m.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)ov(a,s),a=a.sibling}var ga=null;function ov(s,a){var o=s.alternate,c=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Dr(a,s),Pr(s),c&4&&(Ii(3,s,s.return),Rc(3,s),Ii(5,s,s.return));break;case 1:Dr(a,s),Pr(s),c&512&&(Bn||o===null||Ma(o,o.return)),c&64&&ni&&(s=s.updateQueue,s!==null&&(c=s.callbacks,c!==null&&(o=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var m=ga;if(Dr(a,s),Pr(s),c&512&&(Bn||o===null||Ma(o,o.return)),c&4){var f=o!==null?o.memoizedState:null;if(c=s.memoizedState,o===null)if(c===null)if(s.stateNode===null){e:{c=s.type,o=s.memoizedProps,m=m.ownerDocument||m;t:switch(c){case"title":f=m.getElementsByTagName("title")[0],(!f||f[gn]||f[ct]||f.namespaceURI==="http://www.w3.org/2000/svg"||f.hasAttribute("itemprop"))&&(f=m.createElement(c),m.head.insertBefore(f,m.querySelector("head > title"))),ar(f,c,o),f[ct]=s,N(f),c=f;break e;case"link":var w=o1("link","href",m).get(c+(o.href||""));if(w){for(var S=0;S<w.length;S++)if(f=w[S],f.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&f.getAttribute("rel")===(o.rel==null?null:o.rel)&&f.getAttribute("title")===(o.title==null?null:o.title)&&f.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){w.splice(S,1);break t}}f=m.createElement(c),ar(f,c,o),m.head.appendChild(f);break;case"meta":if(w=o1("meta","content",m).get(c+(o.content||""))){for(S=0;S<w.length;S++)if(f=w[S],f.getAttribute("content")===(o.content==null?null:""+o.content)&&f.getAttribute("name")===(o.name==null?null:o.name)&&f.getAttribute("property")===(o.property==null?null:o.property)&&f.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&f.getAttribute("charset")===(o.charSet==null?null:o.charSet)){w.splice(S,1);break t}}f=m.createElement(c),ar(f,c,o),m.head.appendChild(f);break;default:throw Error(i(468,c))}f[ct]=s,N(f),c=f}s.stateNode=c}else l1(m,s.type,s.stateNode);else s.stateNode=i1(m,c,s.memoizedProps);else f!==c?(f===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):f.count--,c===null?l1(m,s.type,s.stateNode):i1(m,c,s.memoizedProps)):c===null&&s.stateNode!==null&&Af(s,s.memoizedProps,o.memoizedProps)}break;case 27:Dr(a,s),Pr(s),c&512&&(Bn||o===null||Ma(o,o.return)),o!==null&&c&4&&Af(s,s.memoizedProps,o.memoizedProps);break;case 5:if(Dr(a,s),Pr(s),c&512&&(Bn||o===null||Ma(o,o.return)),s.flags&32){m=s.stateNode;try{Ft(m,"")}catch(yt){$s(s,s.return,yt)}}c&4&&s.stateNode!=null&&(m=s.memoizedProps,Af(s,m,o!==null?o.memoizedProps:m)),c&1024&&(Df=!0);break;case 6:if(Dr(a,s),Pr(s),c&4){if(s.stateNode===null)throw Error(i(162));c=s.memoizedProps,o=s.stateNode;try{o.nodeValue=c}catch(yt){$s(s,s.return,yt)}}break;case 3:if(qd=null,m=ga,ga=Fd(a.containerInfo),Dr(a,s),ga=m,Pr(s),c&4&&o!==null&&o.memoizedState.isDehydrated)try{Il(a.containerInfo)}catch(yt){$s(s,s.return,yt)}Df&&(Df=!1,lv(s));break;case 4:c=ga,ga=Fd(s.stateNode.containerInfo),Dr(a,s),Pr(s),ga=c;break;case 12:Dr(a,s),Pr(s);break;case 31:Dr(a,s),Pr(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Sd(s,c)));break;case 13:Dr(a,s),Pr(s),s.child.flags&8192&&s.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Cd=Ut()),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Sd(s,c)));break;case 22:m=s.memoizedState!==null;var z=o!==null&&o.memoizedState!==null,le=ni,Te=Bn;if(ni=le||m,Bn=Te||z,Dr(a,s),Bn=Te,ni=le,Pr(s),c&8192)e:for(a=s.stateNode,a._visibility=m?a._visibility&-2:a._visibility|1,m&&(o===null||z||ni||Bn||Io(s)),o=null,a=s;;){if(a.tag===5||a.tag===26){if(o===null){z=o=a;try{if(f=z.stateNode,m)w=f.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{S=z.stateNode;var Pe=z.memoizedProps.style,ce=Pe!=null&&Pe.hasOwnProperty("display")?Pe.display:null;S.style.display=ce==null||typeof ce=="boolean"?"":(""+ce).trim()}}catch(yt){$s(z,z.return,yt)}}}else if(a.tag===6){if(o===null){z=a;try{z.stateNode.nodeValue=m?"":z.memoizedProps}catch(yt){$s(z,z.return,yt)}}}else if(a.tag===18){if(o===null){z=a;try{var ve=z.stateNode;m?Xv(ve,!0):Xv(z.stateNode,!1)}catch(yt){$s(z,z.return,yt)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===s)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;o===a&&(o=null),a=a.return}o===a&&(o=null),a.sibling.return=a.return,a=a.sibling}c&4&&(c=s.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,Sd(s,o))));break;case 19:Dr(a,s),Pr(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Sd(s,c)));break;case 30:break;case 21:break;default:Dr(a,s),Pr(s)}}function Pr(s){var a=s.flags;if(a&2){try{for(var o,c=s.return;c!==null;){if(Z0(c)){o=c;break}c=c.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var m=o.stateNode,f=Mf(s);Ed(s,f,m);break;case 5:var w=o.stateNode;o.flags&32&&(Ft(w,""),o.flags&=-33);var S=Mf(s);Ed(s,S,w);break;case 3:case 4:var z=o.stateNode.containerInfo,le=Mf(s);If(s,le,z);break;default:throw Error(i(161))}}catch(Te){$s(s,s.return,Te)}s.flags&=-3}a&4096&&(s.flags&=-4097)}function lv(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var a=s;lv(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),s=s.sibling}}function ai(s,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)sv(s,a.alternate,a),a=a.sibling}function Io(s){for(s=s.child;s!==null;){var a=s;switch(a.tag){case 0:case 11:case 14:case 15:Ii(4,a,a.return),Io(a);break;case 1:Ma(a,a.return);var o=a.stateNode;typeof o.componentWillUnmount=="function"&&X0(a,a.return,o),Io(a);break;case 27:Uc(a.stateNode);case 26:case 5:Ma(a,a.return),Io(a);break;case 22:a.memoizedState===null&&Io(a);break;case 30:Io(a);break;default:Io(a)}s=s.sibling}}function ii(s,a,o){for(o=o&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var c=a.alternate,m=s,f=a,w=f.flags;switch(f.tag){case 0:case 11:case 15:ii(m,f,o),Rc(4,f);break;case 1:if(ii(m,f,o),c=f,m=c.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(le){$s(c,c.return,le)}if(c=f,m=c.updateQueue,m!==null){var S=c.stateNode;try{var z=m.shared.hiddenCallbacks;if(z!==null)for(m.shared.hiddenCallbacks=null,m=0;m<z.length;m++)Vb(z[m],S)}catch(le){$s(c,c.return,le)}}o&&w&64&&Q0(f),Ac(f,f.return);break;case 27:ev(f);case 26:case 5:ii(m,f,o),o&&c===null&&w&4&&J0(f),Ac(f,f.return);break;case 12:ii(m,f,o);break;case 31:ii(m,f,o),o&&w&4&&av(m,f);break;case 13:ii(m,f,o),o&&w&4&&iv(m,f);break;case 22:f.memoizedState===null&&ii(m,f,o),Ac(f,f.return);break;case 30:break;default:ii(m,f,o)}a=a.sibling}}function Pf(s,a){var o=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),s=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(s=a.memoizedState.cachePool.pool),s!==o&&(s!=null&&s.refCount++,o!=null&&yc(o))}function Lf(s,a){s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&yc(s))}function ya(s,a,o,c){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)cv(s,a,o,c),a=a.sibling}function cv(s,a,o,c){var m=a.flags;switch(a.tag){case 0:case 11:case 15:ya(s,a,o,c),m&2048&&Rc(9,a);break;case 1:ya(s,a,o,c);break;case 3:ya(s,a,o,c),m&2048&&(s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&yc(s)));break;case 12:if(m&2048){ya(s,a,o,c),s=a.stateNode;try{var f=a.memoizedProps,w=f.id,S=f.onPostCommit;typeof S=="function"&&S(w,a.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(z){$s(a,a.return,z)}}else ya(s,a,o,c);break;case 31:ya(s,a,o,c);break;case 13:ya(s,a,o,c);break;case 23:break;case 22:f=a.stateNode,w=a.alternate,a.memoizedState!==null?f._visibility&2?ya(s,a,o,c):Mc(s,a):f._visibility&2?ya(s,a,o,c):(f._visibility|=2,_l(s,a,o,c,(a.subtreeFlags&10256)!==0||!1)),m&2048&&Pf(w,a);break;case 24:ya(s,a,o,c),m&2048&&Lf(a.alternate,a);break;default:ya(s,a,o,c)}}function _l(s,a,o,c,m){for(m=m&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var f=s,w=a,S=o,z=c,le=w.flags;switch(w.tag){case 0:case 11:case 15:_l(f,w,S,z,m),Rc(8,w);break;case 23:break;case 22:var Te=w.stateNode;w.memoizedState!==null?Te._visibility&2?_l(f,w,S,z,m):Mc(f,w):(Te._visibility|=2,_l(f,w,S,z,m)),m&&le&2048&&Pf(w.alternate,w);break;case 24:_l(f,w,S,z,m),m&&le&2048&&Lf(w.alternate,w);break;default:_l(f,w,S,z,m)}a=a.sibling}}function Mc(s,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var o=s,c=a,m=c.flags;switch(c.tag){case 22:Mc(o,c),m&2048&&Pf(c.alternate,c);break;case 24:Mc(o,c),m&2048&&Lf(c.alternate,c);break;default:Mc(o,c)}a=a.sibling}}var Ic=8192;function kl(s,a,o){if(s.subtreeFlags&Ic)for(s=s.child;s!==null;)uv(s,a,o),s=s.sibling}function uv(s,a,o){switch(s.tag){case 26:kl(s,a,o),s.flags&Ic&&s.memoizedState!==null&&hT(o,ga,s.memoizedState,s.memoizedProps);break;case 5:kl(s,a,o);break;case 3:case 4:var c=ga;ga=Fd(s.stateNode.containerInfo),kl(s,a,o),ga=c;break;case 22:s.memoizedState===null&&(c=s.alternate,c!==null&&c.memoizedState!==null?(c=Ic,Ic=16777216,kl(s,a,o),Ic=c):kl(s,a,o));break;default:kl(s,a,o)}}function dv(s){var a=s.alternate;if(a!==null&&(s=a.child,s!==null)){a.child=null;do a=s.sibling,s.sibling=null,s=a;while(s!==null)}}function Dc(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var o=0;o<a.length;o++){var c=a[o];Jn=c,mv(c,s)}dv(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)hv(s),s=s.sibling}function hv(s){switch(s.tag){case 0:case 11:case 15:Dc(s),s.flags&2048&&Ii(9,s,s.return);break;case 3:Dc(s);break;case 12:Dc(s);break;case 22:var a=s.stateNode;s.memoizedState!==null&&a._visibility&2&&(s.return===null||s.return.tag!==13)?(a._visibility&=-3,Nd(s)):Dc(s);break;default:Dc(s)}}function Nd(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var o=0;o<a.length;o++){var c=a[o];Jn=c,mv(c,s)}dv(s)}for(s=s.child;s!==null;){switch(a=s,a.tag){case 0:case 11:case 15:Ii(8,a,a.return),Nd(a);break;case 22:o=a.stateNode,o._visibility&2&&(o._visibility&=-3,Nd(a));break;default:Nd(a)}s=s.sibling}}function mv(s,a){for(;Jn!==null;){var o=Jn;switch(o.tag){case 0:case 11:case 15:Ii(8,o,a);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:yc(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,Jn=c;else e:for(o=s;Jn!==null;){c=Jn;var m=c.sibling,f=c.return;if(nv(c),c===o){Jn=null;break e}if(m!==null){m.return=f,Jn=m;break e}Jn=f}}}var Sj={getCacheForType:function(s){var a=nr(Pn),o=a.data.get(s);return o===void 0&&(o=s(),a.data.set(s,o)),o},cacheSignal:function(){return nr(Pn).controller.signal}},Nj=typeof WeakMap=="function"?WeakMap:Map,Vs=0,sn=null,hs=null,gs=0,Hs=0,$r=null,Di=!1,jl=!1,Of=!1,oi=0,wn=0,Pi=0,Do=0,Bf=0,Wr=0,Tl=0,Pc=null,Lr=null,Vf=!1,Cd=0,fv=0,Rd=1/0,Ad=null,Li=null,qn=0,Oi=null,El=null,li=0,Uf=0,Ff=null,pv=null,Lc=0,zf=null;function Gr(){return(Vs&2)!==0&&gs!==0?gs&-gs:W.T!==null?Kf():Ne()}function gv(){if(Wr===0)if((gs&536870912)===0||_s){var s=Y;Y<<=1,(Y&3932160)===0&&(Y=262144),Wr=s}else Wr=536870912;return s=qr.current,s!==null&&(s.flags|=32),Wr}function Or(s,a,o){(s===sn&&(Hs===2||Hs===9)||s.cancelPendingCommit!==null)&&(Sl(s,0),Bi(s,gs,Wr,!1)),Gt(s,o),((Vs&2)===0||s!==sn)&&(s===sn&&((Vs&2)===0&&(Do|=o),wn===4&&Bi(s,gs,Wr,!1)),Ia(s))}function yv(s,a,o){if((Vs&6)!==0)throw Error(i(327));var c=!o&&(a&127)===0&&(a&s.expiredLanes)===0||rt(s,a),m=c?Aj(s,a):Hf(s,a,!0),f=c;do{if(m===0){jl&&!c&&Bi(s,a,0,!1);break}else{if(o=s.current.alternate,f&&!Cj(o)){m=Hf(s,a,!1),f=!1;continue}if(m===2){if(f=a,s.errorRecoveryDisabledLanes&f)var w=0;else w=s.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){a=w;e:{var S=s;m=Pc;var z=S.current.memoizedState.isDehydrated;if(z&&(Sl(S,w).flags|=256),w=Hf(S,w,!1),w!==2){if(Of&&!z){S.errorRecoveryDisabledLanes|=f,Do|=f,m=4;break e}f=Lr,Lr=m,f!==null&&(Lr===null?Lr=f:Lr.push.apply(Lr,f))}m=w}if(f=!1,m!==2)continue}}if(m===1){Sl(s,0),Bi(s,a,0,!0);break}e:{switch(c=s,f=m,f){case 0:case 1:throw Error(i(345));case 4:if((a&4194048)!==a)break;case 6:Bi(c,a,Wr,!Di);break e;case 2:Lr=null;break;case 3:case 5:break;default:throw Error(i(329))}if((a&62914560)===a&&(m=Cd+300-Ut(),10<m)){if(Bi(c,a,Wr,!Di),Ge(c,0,!0)!==0)break e;li=a,c.timeoutHandle=Kv(bv.bind(null,c,o,Lr,Ad,Vf,a,Wr,Do,Tl,Di,f,"Throttled",-0,0),m);break e}bv(c,o,Lr,Ad,Vf,a,Wr,Do,Tl,Di,f,null,-0,0)}}break}while(!0);Ia(s)}function bv(s,a,o,c,m,f,w,S,z,le,Te,Pe,ce,ve){if(s.timeoutHandle=-1,Pe=a.subtreeFlags,Pe&8192||(Pe&16785408)===16785408){Pe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Zt},uv(a,f,Pe);var yt=(f&62914560)===f?Cd-Ut():(f&4194048)===f?fv-Ut():0;if(yt=mT(Pe,yt),yt!==null){li=f,s.cancelPendingCommit=yt(Ev.bind(null,s,a,f,o,c,m,w,S,z,Te,Pe,null,ce,ve)),Bi(s,f,w,!le);return}}Ev(s,a,f,o,c,m,w,S,z)}function Cj(s){for(var a=s;;){var o=a.tag;if((o===0||o===11||o===15)&&a.flags&16384&&(o=a.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var m=o[c],f=m.getSnapshot;m=m.value;try{if(!Fr(f(),m))return!1}catch{return!1}}if(o=a.child,a.subtreeFlags&16384&&o!==null)o.return=a,a=o;else{if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Bi(s,a,o,c){a&=~Bf,a&=~Do,s.suspendedLanes|=a,s.pingedLanes&=~a,c&&(s.warmLanes|=a),c=s.expirationTimes;for(var m=a;0<m;){var f=31-Ee(m),w=1<<f;c[f]=-1,m&=~w}o!==0&&os(s,o,a)}function Md(){return(Vs&6)===0?(Oc(0),!1):!0}function qf(){if(hs!==null){if(Hs===0)var s=hs.return;else s=hs,Xa=To=null,rf(s),yl=null,vc=0,s=hs;for(;s!==null;)Y0(s.alternate,s),s=s.return;hs=null}}function Sl(s,a){var o=s.timeoutHandle;o!==-1&&(s.timeoutHandle=-1,Yj(o)),o=s.cancelPendingCommit,o!==null&&(s.cancelPendingCommit=null,o()),li=0,qf(),sn=s,hs=o=Ya(s.current,null),gs=a,Hs=0,$r=null,Di=!1,jl=rt(s,a),Of=!1,Tl=Wr=Bf=Do=Pi=wn=0,Lr=Pc=null,Vf=!1,(a&8)!==0&&(a|=a&32);var c=s.entangledLanes;if(c!==0)for(s=s.entanglements,c&=a;0<c;){var m=31-Ee(c),f=1<<m;a|=s[m],c&=~f}return oi=a,Zu(),o}function vv(s,a){rs=null,W.H=Sc,a===gl||a===od?(a=Pb(),Hs=3):a===Wm?(a=Pb(),Hs=4):Hs=a===wf?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,$r=a,hs===null&&(wn=1,wd(s,ea(a,s.current)))}function xv(){var s=qr.current;return s===null?!0:(gs&4194048)===gs?ra===null:(gs&62914560)===gs||(gs&536870912)!==0?s===ra:!1}function wv(){var s=W.H;return W.H=Sc,s===null?Sc:s}function _v(){var s=W.A;return W.A=Sj,s}function Id(){wn=4,Di||(gs&4194048)!==gs&&qr.current!==null||(jl=!0),(Pi&134217727)===0&&(Do&134217727)===0||sn===null||Bi(sn,gs,Wr,!1)}function Hf(s,a,o){var c=Vs;Vs|=2;var m=wv(),f=_v();(sn!==s||gs!==a)&&(Ad=null,Sl(s,a)),a=!1;var w=wn;e:do try{if(Hs!==0&&hs!==null){var S=hs,z=$r;switch(Hs){case 8:qf(),w=6;break e;case 3:case 2:case 9:case 6:qr.current===null&&(a=!0);var le=Hs;if(Hs=0,$r=null,Nl(s,S,z,le),o&&jl){w=0;break e}break;default:le=Hs,Hs=0,$r=null,Nl(s,S,z,le)}}Rj(),w=wn;break}catch(Te){vv(s,Te)}while(!0);return a&&s.shellSuspendCounter++,Xa=To=null,Vs=c,W.H=m,W.A=f,hs===null&&(sn=null,gs=0,Zu()),w}function Rj(){for(;hs!==null;)kv(hs)}function Aj(s,a){var o=Vs;Vs|=2;var c=wv(),m=_v();sn!==s||gs!==a?(Ad=null,Rd=Ut()+500,Sl(s,a)):jl=rt(s,a);e:do try{if(Hs!==0&&hs!==null){a=hs;var f=$r;t:switch(Hs){case 1:Hs=0,$r=null,Nl(s,a,f,1);break;case 2:case 9:if(Ib(f)){Hs=0,$r=null,jv(a);break}a=function(){Hs!==2&&Hs!==9||sn!==s||(Hs=7),Ia(s)},f.then(a,a);break e;case 3:Hs=7;break e;case 4:Hs=5;break e;case 7:Ib(f)?(Hs=0,$r=null,jv(a)):(Hs=0,$r=null,Nl(s,a,f,7));break;case 5:var w=null;switch(hs.tag){case 26:w=hs.memoizedState;case 5:case 27:var S=hs;if(w?c1(w):S.stateNode.complete){Hs=0,$r=null;var z=S.sibling;if(z!==null)hs=z;else{var le=S.return;le!==null?(hs=le,Dd(le)):hs=null}break t}}Hs=0,$r=null,Nl(s,a,f,5);break;case 6:Hs=0,$r=null,Nl(s,a,f,6);break;case 8:qf(),wn=6;break e;default:throw Error(i(462))}}Mj();break}catch(Te){vv(s,Te)}while(!0);return Xa=To=null,W.H=c,W.A=m,Vs=o,hs!==null?0:(sn=null,gs=0,Zu(),wn)}function Mj(){for(;hs!==null&&!Ns();)kv(hs)}function kv(s){var a=G0(s.alternate,s,oi);s.memoizedProps=s.pendingProps,a===null?Dd(s):hs=a}function jv(s){var a=s,o=a.alternate;switch(a.tag){case 15:case 0:a=F0(o,a,a.pendingProps,a.type,void 0,gs);break;case 11:a=F0(o,a,a.pendingProps,a.type.render,a.ref,gs);break;case 5:rf(a);default:Y0(o,a),a=hs=_b(a,oi),a=G0(o,a,oi)}s.memoizedProps=s.pendingProps,a===null?Dd(s):hs=a}function Nl(s,a,o,c){Xa=To=null,rf(a),yl=null,vc=0;var m=a.return;try{if(xj(s,m,a,o,gs)){wn=1,wd(s,ea(o,s.current)),hs=null;return}}catch(f){if(m!==null)throw hs=m,f;wn=1,wd(s,ea(o,s.current)),hs=null;return}a.flags&32768?(_s||c===1?s=!0:jl||(gs&536870912)!==0?s=!1:(Di=s=!0,(c===2||c===9||c===3||c===6)&&(c=qr.current,c!==null&&c.tag===13&&(c.flags|=16384))),Tv(a,s)):Dd(a)}function Dd(s){var a=s;do{if((a.flags&32768)!==0){Tv(a,Di);return}s=a.return;var o=kj(a.alternate,a,oi);if(o!==null){hs=o;return}if(a=a.sibling,a!==null){hs=a;return}hs=a=s}while(a!==null);wn===0&&(wn=5)}function Tv(s,a){do{var o=jj(s.alternate,s);if(o!==null){o.flags&=32767,hs=o;return}if(o=s.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!a&&(s=s.sibling,s!==null)){hs=s;return}hs=s=o}while(s!==null);wn=6,hs=null}function Ev(s,a,o,c,m,f,w,S,z){s.cancelPendingCommit=null;do Pd();while(qn!==0);if((Vs&6)!==0)throw Error(i(327));if(a!==null){if(a===s.current)throw Error(i(177));if(f=a.lanes|a.childLanes,f|=Am,Gs(s,o,f,w,S,z),s===sn&&(hs=sn=null,gs=0),El=a,Oi=s,li=o,Uf=f,Ff=m,pv=c,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Lj(zt,function(){return Av(),null})):(s.callbackNode=null,s.callbackPriority=0),c=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||c){c=W.T,W.T=null,m=de.p,de.p=2,w=Vs,Vs|=4;try{Tj(s,a,o)}finally{Vs=w,de.p=m,W.T=c}}qn=1,Sv(),Nv(),Cv()}}function Sv(){if(qn===1){qn=0;var s=Oi,a=El,o=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||o){o=W.T,W.T=null;var c=de.p;de.p=2;var m=Vs;Vs|=4;try{ov(a,s);var f=sp,w=mb(s.containerInfo),S=f.focusedElem,z=f.selectionRange;if(w!==S&&S&&S.ownerDocument&&hb(S.ownerDocument.documentElement,S)){if(z!==null&&Em(S)){var le=z.start,Te=z.end;if(Te===void 0&&(Te=le),"selectionStart"in S)S.selectionStart=le,S.selectionEnd=Math.min(Te,S.value.length);else{var Pe=S.ownerDocument||document,ce=Pe&&Pe.defaultView||window;if(ce.getSelection){var ve=ce.getSelection(),yt=S.textContent.length,It=Math.min(z.start,yt),Qs=z.end===void 0?It:Math.min(z.end,yt);!ve.extend&&It>Qs&&(w=Qs,Qs=It,It=w);var Z=db(S,It),Q=db(S,Qs);if(Z&&Q&&(ve.rangeCount!==1||ve.anchorNode!==Z.node||ve.anchorOffset!==Z.offset||ve.focusNode!==Q.node||ve.focusOffset!==Q.offset)){var oe=Pe.createRange();oe.setStart(Z.node,Z.offset),ve.removeAllRanges(),It>Qs?(ve.addRange(oe),ve.extend(Q.node,Q.offset)):(oe.setEnd(Q.node,Q.offset),ve.addRange(oe))}}}}for(Pe=[],ve=S;ve=ve.parentNode;)ve.nodeType===1&&Pe.push({element:ve,left:ve.scrollLeft,top:ve.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<Pe.length;S++){var Me=Pe[S];Me.element.scrollLeft=Me.left,Me.element.scrollTop=Me.top}}Gd=!!tp,sp=tp=null}finally{Vs=m,de.p=c,W.T=o}}s.current=a,qn=2}}function Nv(){if(qn===2){qn=0;var s=Oi,a=El,o=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||o){o=W.T,W.T=null;var c=de.p;de.p=2;var m=Vs;Vs|=4;try{sv(s,a.alternate,a)}finally{Vs=m,de.p=c,W.T=o}}qn=3}}function Cv(){if(qn===4||qn===3){qn=0,Ws();var s=Oi,a=El,o=li,c=pv;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?qn=5:(qn=0,El=Oi=null,Rv(s,s.pendingLanes));var m=s.pendingLanes;if(m===0&&(Li=null),_e(o),a=a.stateNode,G&&typeof G.onCommitFiberRoot=="function")try{G.onCommitFiberRoot(we,a,void 0,(a.current.flags&128)===128)}catch{}if(c!==null){a=W.T,m=de.p,de.p=2,W.T=null;try{for(var f=s.onRecoverableError,w=0;w<c.length;w++){var S=c[w];f(S.value,{componentStack:S.stack})}}finally{W.T=a,de.p=m}}(li&3)!==0&&Pd(),Ia(s),m=s.pendingLanes,(o&261930)!==0&&(m&42)!==0?s===zf?Lc++:(Lc=0,zf=s):Lc=0,Oc(0)}}function Rv(s,a){(s.pooledCacheLanes&=a)===0&&(a=s.pooledCache,a!=null&&(s.pooledCache=null,yc(a)))}function Pd(){return Sv(),Nv(),Cv(),Av()}function Av(){if(qn!==5)return!1;var s=Oi,a=Uf;Uf=0;var o=_e(li),c=W.T,m=de.p;try{de.p=32>o?32:o,W.T=null,o=Ff,Ff=null;var f=Oi,w=li;if(qn=0,El=Oi=null,li=0,(Vs&6)!==0)throw Error(i(331));var S=Vs;if(Vs|=4,hv(f.current),cv(f,f.current,w,o),Vs=S,Oc(0,!1),G&&typeof G.onPostCommitFiberRoot=="function")try{G.onPostCommitFiberRoot(we,f)}catch{}return!0}finally{de.p=m,W.T=c,Rv(s,a)}}function Mv(s,a,o){a=ea(o,a),a=xf(s.stateNode,a,2),s=Ri(s,a,2),s!==null&&(Gt(s,2),Ia(s))}function $s(s,a,o){if(s.tag===3)Mv(s,s,o);else for(;a!==null;){if(a.tag===3){Mv(a,s,o);break}else if(a.tag===1){var c=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Li===null||!Li.has(c))){s=ea(o,s),o=I0(2),c=Ri(a,o,2),c!==null&&(D0(o,c,a,s),Gt(c,2),Ia(c));break}}a=a.return}}function $f(s,a,o){var c=s.pingCache;if(c===null){c=s.pingCache=new Nj;var m=new Set;c.set(a,m)}else m=c.get(a),m===void 0&&(m=new Set,c.set(a,m));m.has(o)||(Of=!0,m.add(o),s=Ij.bind(null,s,a,o),a.then(s,s))}function Ij(s,a,o){var c=s.pingCache;c!==null&&c.delete(a),s.pingedLanes|=s.suspendedLanes&o,s.warmLanes&=~o,sn===s&&(gs&o)===o&&(wn===4||wn===3&&(gs&62914560)===gs&&300>Ut()-Cd?(Vs&2)===0&&Sl(s,0):Bf|=o,Tl===gs&&(Tl=0)),Ia(s)}function Iv(s,a){a===0&&(a=jt()),s=_o(s,a),s!==null&&(Gt(s,a),Ia(s))}function Dj(s){var a=s.memoizedState,o=0;a!==null&&(o=a.retryLane),Iv(s,o)}function Pj(s,a){var o=0;switch(s.tag){case 31:case 13:var c=s.stateNode,m=s.memoizedState;m!==null&&(o=m.retryLane);break;case 19:c=s.stateNode;break;case 22:c=s.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(a),Iv(s,o)}function Lj(s,a){return $e(s,a)}var Ld=null,Cl=null,Wf=!1,Od=!1,Gf=!1,Vi=0;function Ia(s){s!==Cl&&s.next===null&&(Cl===null?Ld=Cl=s:Cl=Cl.next=s),Od=!0,Wf||(Wf=!0,Bj())}function Oc(s,a){if(!Gf&&Od){Gf=!0;do for(var o=!1,c=Ld;c!==null;){if(s!==0){var m=c.pendingLanes;if(m===0)var f=0;else{var w=c.suspendedLanes,S=c.pingedLanes;f=(1<<31-Ee(42|s)+1)-1,f&=m&~(w&~S),f=f&201326741?f&201326741|1:f?f|2:0}f!==0&&(o=!0,Ov(c,f))}else f=gs,f=Ge(c,c===sn?f:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(f&3)===0||rt(c,f)||(o=!0,Ov(c,f));c=c.next}while(o);Gf=!1}}function Oj(){Dv()}function Dv(){Od=Wf=!1;var s=0;Vi!==0&&Kj()&&(s=Vi);for(var a=Ut(),o=null,c=Ld;c!==null;){var m=c.next,f=Pv(c,a);f===0?(c.next=null,o===null?Ld=m:o.next=m,m===null&&(Cl=o)):(o=c,(s!==0||(f&3)!==0)&&(Od=!0)),c=m}qn!==0&&qn!==5||Oc(s),Vi!==0&&(Vi=0)}function Pv(s,a){for(var o=s.suspendedLanes,c=s.pingedLanes,m=s.expirationTimes,f=s.pendingLanes&-62914561;0<f;){var w=31-Ee(f),S=1<<w,z=m[w];z===-1?((S&o)===0||(S&c)!==0)&&(m[w]=bt(S,a)):z<=a&&(s.expiredLanes|=S),f&=~S}if(a=sn,o=gs,o=Ge(s,s===a?o:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c=s.callbackNode,o===0||s===a&&(Hs===2||Hs===9)||s.cancelPendingCommit!==null)return c!==null&&c!==null&&$t(c),s.callbackNode=null,s.callbackPriority=0;if((o&3)===0||rt(s,o)){if(a=o&-o,a===s.callbackPriority)return a;switch(c!==null&&$t(c),_e(o)){case 2:case 8:o=Is;break;case 32:o=zt;break;case 268435456:o=Lt;break;default:o=zt}return c=Lv.bind(null,s),o=$e(o,c),s.callbackPriority=a,s.callbackNode=o,a}return c!==null&&c!==null&&$t(c),s.callbackPriority=2,s.callbackNode=null,2}function Lv(s,a){if(qn!==0&&qn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var o=s.callbackNode;if(Pd()&&s.callbackNode!==o)return null;var c=gs;return c=Ge(s,s===sn?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c===0?null:(yv(s,c,a),Pv(s,Ut()),s.callbackNode!=null&&s.callbackNode===o?Lv.bind(null,s):null)}function Ov(s,a){if(Pd())return null;yv(s,a,!0)}function Bj(){Qj(function(){(Vs&6)!==0?$e(is,Oj):Dv()})}function Kf(){if(Vi===0){var s=fl;s===0&&(s=ot,ot<<=1,(ot&261888)===0&&(ot=256)),Vi=s}return Vi}function Bv(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Zs(""+s)}function Vv(s,a){var o=a.ownerDocument.createElement("input");return o.name=a.name,o.value=a.value,s.id&&o.setAttribute("form",s.id),a.parentNode.insertBefore(o,a),s=new FormData(s),o.parentNode.removeChild(o),s}function Vj(s,a,o,c,m){if(a==="submit"&&o&&o.stateNode===m){var f=Bv((m[xt]||null).action),w=c.submitter;w&&(a=(a=w[xt]||null)?Bv(a.formAction):w.getAttribute("formAction"),a!==null&&(f=a,w=null));var S=new Qn("action","action",null,c,m);s.push({event:S,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Vi!==0){var z=w?Vv(m,w):new FormData(m);ff(o,{pending:!0,data:z,method:m.method,action:f},null,z)}}else typeof f=="function"&&(S.preventDefault(),z=w?Vv(m,w):new FormData(m),ff(o,{pending:!0,data:z,method:m.method,action:f},f,z))},currentTarget:m}]})}}for(var Yf=0;Yf<Rm.length;Yf++){var Qf=Rm[Yf],Uj=Qf.toLowerCase(),Fj=Qf[0].toUpperCase()+Qf.slice(1);pa(Uj,"on"+Fj)}pa(gb,"onAnimationEnd"),pa(yb,"onAnimationIteration"),pa(bb,"onAnimationStart"),pa("dblclick","onDoubleClick"),pa("focusin","onFocus"),pa("focusout","onBlur"),pa(nj,"onTransitionRun"),pa(rj,"onTransitionStart"),pa(aj,"onTransitionCancel"),pa(vb,"onTransitionEnd"),Ue("onMouseEnter",["mouseout","mouseover"]),Ue("onMouseLeave",["mouseout","mouseover"]),Ue("onPointerEnter",["pointerout","pointerover"]),Ue("onPointerLeave",["pointerout","pointerover"]),fe("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),fe("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),fe("onBeforeInput",["compositionend","keypress","textInput","paste"]),fe("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),fe("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),fe("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zj=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Bc));function Uv(s,a){a=(a&4)!==0;for(var o=0;o<s.length;o++){var c=s[o],m=c.event;c=c.listeners;e:{var f=void 0;if(a)for(var w=c.length-1;0<=w;w--){var S=c[w],z=S.instance,le=S.currentTarget;if(S=S.listener,z!==f&&m.isPropagationStopped())break e;f=S,m.currentTarget=le;try{f(m)}catch(Te){Ju(Te)}m.currentTarget=null,f=z}else for(w=0;w<c.length;w++){if(S=c[w],z=S.instance,le=S.currentTarget,S=S.listener,z!==f&&m.isPropagationStopped())break e;f=S,m.currentTarget=le;try{f(m)}catch(Te){Ju(Te)}m.currentTarget=null,f=z}}}}function ms(s,a){var o=a[kt];o===void 0&&(o=a[kt]=new Set);var c=s+"__bubble";o.has(c)||(Fv(a,s,2,!1),o.add(c))}function Xf(s,a,o){var c=0;a&&(c|=4),Fv(o,s,c,a)}var Bd="_reactListening"+Math.random().toString(36).slice(2);function Jf(s){if(!s[Bd]){s[Bd]=!0,P.forEach(function(o){o!=="selectionchange"&&(zj.has(o)||Xf(o,!1,s),Xf(o,!0,s))});var a=s.nodeType===9?s:s.ownerDocument;a===null||a[Bd]||(a[Bd]=!0,Xf("selectionchange",!1,a))}}function Fv(s,a,o,c){switch(g1(a)){case 2:var m=gT;break;case 8:m=yT;break;default:m=mp}o=m.bind(null,a,o,s),m=void 0,!J||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(m=!0),c?m!==void 0?s.addEventListener(a,o,{capture:!0,passive:m}):s.addEventListener(a,o,!0):m!==void 0?s.addEventListener(a,o,{passive:m}):s.addEventListener(a,o,!1)}function Zf(s,a,o,c,m){var f=c;if((a&1)===0&&(a&2)===0&&c!==null)e:for(;;){if(c===null)return;var w=c.tag;if(w===3||w===4){var S=c.stateNode.containerInfo;if(S===m)break;if(w===4)for(w=c.return;w!==null;){var z=w.tag;if((z===3||z===4)&&w.stateNode.containerInfo===m)return;w=w.return}for(;S!==null;){if(w=In(S),w===null)return;if(z=w.tag,z===5||z===6||z===26||z===27){c=f=w;continue e}S=S.parentNode}}c=c.return}ur(function(){var le=f,Te=mn(o),Pe=[];e:{var ce=xb.get(s);if(ce!==void 0){var ve=Qn,yt=s;switch(s){case"keypress":if(qt(o)===0)break e;case"keydown":case"keyup":ve=Yu;break;case"focusin":yt="focus",ve=vn;break;case"focusout":yt="blur",ve=vn;break;case"beforeblur":case"afterblur":ve=vn;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ve=hr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ve=wr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ve=b;break;case gb:case yb:case bb:ve=Mr;break;case vb:ve=A;break;case"scroll":case"scrollend":ve=rn;break;case"wheel":ve=ge;break;case"copy":case"cut":case"paste":ve=sl;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ve=Ka;break;case"toggle":case"beforetoggle":ve=ns}var It=(a&4)!==0,Qs=!It&&(s==="scroll"||s==="scrollend"),Z=It?ce!==null?ce+"Capture":null:ce;It=[];for(var Q=le,oe;Q!==null;){var Me=Q;if(oe=Me.stateNode,Me=Me.tag,Me!==5&&Me!==26&&Me!==27||oe===null||Z===null||(Me=dr(Q,Z),Me!=null&&It.push(Vc(Q,Me,oe))),Qs)break;Q=Q.return}0<It.length&&(ce=new ve(ce,yt,null,o,Te),Pe.push({event:ce,listeners:It}))}}if((a&7)===0){e:{if(ce=s==="mouseover"||s==="pointerover",ve=s==="mouseout"||s==="pointerout",ce&&o!==en&&(yt=o.relatedTarget||o.fromElement)&&(In(yt)||yt[Ze]))break e;if((ve||ce)&&(ce=Te.window===Te?Te:(ce=Te.ownerDocument)?ce.defaultView||ce.parentWindow:window,ve?(yt=o.relatedTarget||o.toElement,ve=le,yt=yt?In(yt):null,yt!==null&&(Qs=u(yt),It=yt.tag,yt!==Qs||It!==5&&It!==27&&It!==6)&&(yt=null)):(ve=null,yt=le),ve!==yt)){if(It=hr,Me="onMouseLeave",Z="onMouseEnter",Q="mouse",(s==="pointerout"||s==="pointerover")&&(It=Ka,Me="onPointerLeave",Z="onPointerEnter",Q="pointer"),Qs=ve==null?ce:zs(ve),oe=yt==null?ce:zs(yt),ce=new It(Me,Q+"leave",ve,o,Te),ce.target=Qs,ce.relatedTarget=oe,Me=null,In(Te)===le&&(It=new It(Z,Q+"enter",yt,o,Te),It.target=oe,It.relatedTarget=Qs,Me=It),Qs=Me,ve&&yt)t:{for(It=qj,Z=ve,Q=yt,oe=0,Me=Z;Me;Me=It(Me))oe++;Me=0;for(var Nt=Q;Nt;Nt=It(Nt))Me++;for(;0<oe-Me;)Z=It(Z),oe--;for(;0<Me-oe;)Q=It(Q),Me--;for(;oe--;){if(Z===Q||Q!==null&&Z===Q.alternate){It=Z;break t}Z=It(Z),Q=It(Q)}It=null}else It=null;ve!==null&&zv(Pe,ce,ve,It,!1),yt!==null&&Qs!==null&&zv(Pe,Qs,yt,It,!0)}}e:{if(ce=le?zs(le):window,ve=ce.nodeName&&ce.nodeName.toLowerCase(),ve==="select"||ve==="input"&&ce.type==="file")var Ps=ab;else if(nb(ce))if(ib)Ps=ej;else{Ps=Jk;var wt=Xk}else ve=ce.nodeName,!ve||ve.toLowerCase()!=="input"||ce.type!=="checkbox"&&ce.type!=="radio"?le&&bn(le.elementType)&&(Ps=ab):Ps=Zk;if(Ps&&(Ps=Ps(s,le))){rb(Pe,Ps,o,Te);break e}wt&&wt(s,ce,le),s==="focusout"&&le&&ce.type==="number"&&le.memoizedProps.value!=null&&Xe(ce,"number",ce.value)}switch(wt=le?zs(le):window,s){case"focusin":(nb(wt)||wt.contentEditable==="true")&&(il=wt,Sm=le,fc=null);break;case"focusout":fc=Sm=il=null;break;case"mousedown":Nm=!0;break;case"contextmenu":case"mouseup":case"dragend":Nm=!1,fb(Pe,o,Te);break;case"selectionchange":if(sj)break;case"keydown":case"keyup":fb(Pe,o,Te)}var as;if(Bs)e:{switch(s){case"compositionstart":var ys="onCompositionStart";break e;case"compositionend":ys="onCompositionEnd";break e;case"compositionupdate":ys="onCompositionUpdate";break e}ys=void 0}else al?vo(s,o)&&(ys="onCompositionEnd"):s==="keydown"&&o.keyCode===229&&(ys="onCompositionStart");ys&&(Ca&&o.locale!=="ko"&&(al||ys!=="onCompositionStart"?ys==="onCompositionEnd"&&al&&(as=lt()):(tt=Te,Tt="value"in tt?tt.value:tt.textContent,al=!0)),wt=Vd(le,ys),0<wt.length&&(ys=new kr(ys,s,null,o,Te),Pe.push({event:ys,listeners:wt}),as?ys.data=as:(as=rl(o),as!==null&&(ys.data=as)))),(as=Jr?Gk(s,o):Kk(s,o))&&(ys=Vd(le,"onBeforeInput"),0<ys.length&&(wt=new kr("onBeforeInput","beforeinput",null,o,Te),Pe.push({event:wt,listeners:ys}),wt.data=as)),Vj(Pe,s,le,o,Te)}Uv(Pe,a)})}function Vc(s,a,o){return{instance:s,listener:a,currentTarget:o}}function Vd(s,a){for(var o=a+"Capture",c=[];s!==null;){var m=s,f=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||f===null||(m=dr(s,o),m!=null&&c.unshift(Vc(s,m,f)),m=dr(s,a),m!=null&&c.push(Vc(s,m,f))),s.tag===3)return c;s=s.return}return[]}function qj(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function zv(s,a,o,c,m){for(var f=a._reactName,w=[];o!==null&&o!==c;){var S=o,z=S.alternate,le=S.stateNode;if(S=S.tag,z!==null&&z===c)break;S!==5&&S!==26&&S!==27||le===null||(z=le,m?(le=dr(o,f),le!=null&&w.unshift(Vc(o,le,z))):m||(le=dr(o,f),le!=null&&w.push(Vc(o,le,z)))),o=o.return}w.length!==0&&s.push({event:a,listeners:w})}var Hj=/\r\n?/g,$j=/\u0000|\uFFFD/g;function qv(s){return(typeof s=="string"?s:""+s).replace(Hj,`
`).replace($j,"")}function Hv(s,a){return a=qv(a),qv(s)===a}function Ys(s,a,o,c,m,f){switch(o){case"children":typeof c=="string"?a==="body"||a==="textarea"&&c===""||Ft(s,c):(typeof c=="number"||typeof c=="bigint")&&a!=="body"&&Ft(s,""+c);break;case"className":us(s,"class",c);break;case"tabIndex":us(s,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":us(s,o,c);break;case"style":Ds(s,c,f);break;case"data":if(a!=="object"){us(s,"data",c);break}case"src":case"href":if(c===""&&(a!=="a"||o!=="href")){s.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(o);break}c=Zs(""+c),s.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){s.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof f=="function"&&(o==="formAction"?(a!=="input"&&Ys(s,a,"name",m.name,m,null),Ys(s,a,"formEncType",m.formEncType,m,null),Ys(s,a,"formMethod",m.formMethod,m,null),Ys(s,a,"formTarget",m.formTarget,m,null)):(Ys(s,a,"encType",m.encType,m,null),Ys(s,a,"method",m.method,m,null),Ys(s,a,"target",m.target,m,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(o);break}c=Zs(""+c),s.setAttribute(o,c);break;case"onClick":c!=null&&(s.onclick=Zt);break;case"onScroll":c!=null&&ms("scroll",s);break;case"onScrollEnd":c!=null&&ms("scrollend",s);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(m.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"multiple":s.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":s.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){s.removeAttribute("xlink:href");break}o=Zs(""+c),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,""+c):s.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,""):s.removeAttribute(o);break;case"capture":case"download":c===!0?s.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,c):s.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?s.setAttribute(o,c):s.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?s.removeAttribute(o):s.setAttribute(o,c);break;case"popover":ms("beforetoggle",s),ms("toggle",s),js(s,"popover",c);break;case"xlinkActuate":cs(s,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":cs(s,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":cs(s,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":cs(s,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":cs(s,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":cs(s,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":cs(s,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":cs(s,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":cs(s,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":js(s,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Wn.get(o)||o,js(s,o,c))}}function ep(s,a,o,c,m,f){switch(o){case"style":Ds(s,c,f);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(m.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"children":typeof c=="string"?Ft(s,c):(typeof c=="number"||typeof c=="bigint")&&Ft(s,""+c);break;case"onScroll":c!=null&&ms("scroll",s);break;case"onScrollEnd":c!=null&&ms("scrollend",s);break;case"onClick":c!=null&&(s.onclick=Zt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!U.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(m=o.endsWith("Capture"),a=o.slice(2,m?o.length-7:void 0),f=s[xt]||null,f=f!=null?f[o]:null,typeof f=="function"&&s.removeEventListener(a,f,m),typeof c=="function")){typeof f!="function"&&f!==null&&(o in s?s[o]=null:s.hasAttribute(o)&&s.removeAttribute(o)),s.addEventListener(a,c,m);break e}o in s?s[o]=c:c===!0?s.setAttribute(o,""):js(s,o,c)}}}function ar(s,a,o){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ms("error",s),ms("load",s);var c=!1,m=!1,f;for(f in o)if(o.hasOwnProperty(f)){var w=o[f];if(w!=null)switch(f){case"src":c=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Ys(s,a,f,w,o,null)}}m&&Ys(s,a,"srcSet",o.srcSet,o,null),c&&Ys(s,a,"src",o.src,o,null);return;case"input":ms("invalid",s);var S=f=w=m=null,z=null,le=null;for(c in o)if(o.hasOwnProperty(c)){var Te=o[c];if(Te!=null)switch(c){case"name":m=Te;break;case"type":w=Te;break;case"checked":z=Te;break;case"defaultChecked":le=Te;break;case"value":f=Te;break;case"defaultValue":S=Te;break;case"children":case"dangerouslySetInnerHTML":if(Te!=null)throw Error(i(137,a));break;default:Ys(s,a,c,Te,o,null)}}Je(s,f,S,z,le,w,m,!1);return;case"select":ms("invalid",s),c=w=f=null;for(m in o)if(o.hasOwnProperty(m)&&(S=o[m],S!=null))switch(m){case"value":f=S;break;case"defaultValue":w=S;break;case"multiple":c=S;default:Ys(s,a,m,S,o,null)}a=f,o=w,s.multiple=!!c,a!=null?ut(s,!!c,a,!1):o!=null&&ut(s,!!c,o,!0);return;case"textarea":ms("invalid",s),f=m=c=null;for(w in o)if(o.hasOwnProperty(w)&&(S=o[w],S!=null))switch(w){case"value":c=S;break;case"defaultValue":m=S;break;case"children":f=S;break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(i(91));break;default:Ys(s,a,w,S,o,null)}Yt(s,c,m,f);return;case"option":for(z in o)o.hasOwnProperty(z)&&(c=o[z],c!=null)&&(z==="selected"?s.selected=c&&typeof c!="function"&&typeof c!="symbol":Ys(s,a,z,c,o,null));return;case"dialog":ms("beforetoggle",s),ms("toggle",s),ms("cancel",s),ms("close",s);break;case"iframe":case"object":ms("load",s);break;case"video":case"audio":for(c=0;c<Bc.length;c++)ms(Bc[c],s);break;case"image":ms("error",s),ms("load",s);break;case"details":ms("toggle",s);break;case"embed":case"source":case"link":ms("error",s),ms("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(le in o)if(o.hasOwnProperty(le)&&(c=o[le],c!=null))switch(le){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Ys(s,a,le,c,o,null)}return;default:if(bn(a)){for(Te in o)o.hasOwnProperty(Te)&&(c=o[Te],c!==void 0&&ep(s,a,Te,c,o,void 0));return}}for(S in o)o.hasOwnProperty(S)&&(c=o[S],c!=null&&Ys(s,a,S,c,o,null))}function Wj(s,a,o,c){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,f=null,w=null,S=null,z=null,le=null,Te=null;for(ve in o){var Pe=o[ve];if(o.hasOwnProperty(ve)&&Pe!=null)switch(ve){case"checked":break;case"value":break;case"defaultValue":z=Pe;default:c.hasOwnProperty(ve)||Ys(s,a,ve,null,c,Pe)}}for(var ce in c){var ve=c[ce];if(Pe=o[ce],c.hasOwnProperty(ce)&&(ve!=null||Pe!=null))switch(ce){case"type":f=ve;break;case"name":m=ve;break;case"checked":le=ve;break;case"defaultChecked":Te=ve;break;case"value":w=ve;break;case"defaultValue":S=ve;break;case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(i(137,a));break;default:ve!==Pe&&Ys(s,a,ce,ve,c,Pe)}}be(s,w,S,z,le,Te,f,m);return;case"select":ve=w=S=ce=null;for(f in o)if(z=o[f],o.hasOwnProperty(f)&&z!=null)switch(f){case"value":break;case"multiple":ve=z;default:c.hasOwnProperty(f)||Ys(s,a,f,null,c,z)}for(m in c)if(f=c[m],z=o[m],c.hasOwnProperty(m)&&(f!=null||z!=null))switch(m){case"value":ce=f;break;case"defaultValue":S=f;break;case"multiple":w=f;default:f!==z&&Ys(s,a,m,f,c,z)}a=S,o=w,c=ve,ce!=null?ut(s,!!o,ce,!1):!!c!=!!o&&(a!=null?ut(s,!!o,a,!0):ut(s,!!o,o?[]:"",!1));return;case"textarea":ve=ce=null;for(S in o)if(m=o[S],o.hasOwnProperty(S)&&m!=null&&!c.hasOwnProperty(S))switch(S){case"value":break;case"children":break;default:Ys(s,a,S,null,c,m)}for(w in c)if(m=c[w],f=o[w],c.hasOwnProperty(w)&&(m!=null||f!=null))switch(w){case"value":ce=m;break;case"defaultValue":ve=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(i(91));break;default:m!==f&&Ys(s,a,w,m,c,f)}Kt(s,ce,ve);return;case"option":for(var yt in o)ce=o[yt],o.hasOwnProperty(yt)&&ce!=null&&!c.hasOwnProperty(yt)&&(yt==="selected"?s.selected=!1:Ys(s,a,yt,null,c,ce));for(z in c)ce=c[z],ve=o[z],c.hasOwnProperty(z)&&ce!==ve&&(ce!=null||ve!=null)&&(z==="selected"?s.selected=ce&&typeof ce!="function"&&typeof ce!="symbol":Ys(s,a,z,ce,c,ve));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var It in o)ce=o[It],o.hasOwnProperty(It)&&ce!=null&&!c.hasOwnProperty(It)&&Ys(s,a,It,null,c,ce);for(le in c)if(ce=c[le],ve=o[le],c.hasOwnProperty(le)&&ce!==ve&&(ce!=null||ve!=null))switch(le){case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(i(137,a));break;default:Ys(s,a,le,ce,c,ve)}return;default:if(bn(a)){for(var Qs in o)ce=o[Qs],o.hasOwnProperty(Qs)&&ce!==void 0&&!c.hasOwnProperty(Qs)&&ep(s,a,Qs,void 0,c,ce);for(Te in c)ce=c[Te],ve=o[Te],!c.hasOwnProperty(Te)||ce===ve||ce===void 0&&ve===void 0||ep(s,a,Te,ce,c,ve);return}}for(var Z in o)ce=o[Z],o.hasOwnProperty(Z)&&ce!=null&&!c.hasOwnProperty(Z)&&Ys(s,a,Z,null,c,ce);for(Pe in c)ce=c[Pe],ve=o[Pe],!c.hasOwnProperty(Pe)||ce===ve||ce==null&&ve==null||Ys(s,a,Pe,ce,c,ve)}function $v(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Gj(){if(typeof performance.getEntriesByType=="function"){for(var s=0,a=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var m=o[c],f=m.transferSize,w=m.initiatorType,S=m.duration;if(f&&S&&$v(w)){for(w=0,S=m.responseEnd,c+=1;c<o.length;c++){var z=o[c],le=z.startTime;if(le>S)break;var Te=z.transferSize,Pe=z.initiatorType;Te&&$v(Pe)&&(z=z.responseEnd,w+=Te*(z<S?1:(S-le)/(z-le)))}if(--c,a+=8*(f+w)/(m.duration/1e3),s++,10<s)break}}if(0<s)return a/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var tp=null,sp=null;function Ud(s){return s.nodeType===9?s:s.ownerDocument}function Wv(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Gv(s,a){if(s===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&a==="foreignObject"?0:s}function np(s,a){return s==="textarea"||s==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var rp=null;function Kj(){var s=window.event;return s&&s.type==="popstate"?s===rp?!1:(rp=s,!0):(rp=null,!1)}var Kv=typeof setTimeout=="function"?setTimeout:void 0,Yj=typeof clearTimeout=="function"?clearTimeout:void 0,Yv=typeof Promise=="function"?Promise:void 0,Qj=typeof queueMicrotask=="function"?queueMicrotask:typeof Yv<"u"?function(s){return Yv.resolve(null).then(s).catch(Xj)}:Kv;function Xj(s){setTimeout(function(){throw s})}function Ui(s){return s==="head"}function Qv(s,a){var o=a,c=0;do{var m=o.nextSibling;if(s.removeChild(o),m&&m.nodeType===8)if(o=m.data,o==="/$"||o==="/&"){if(c===0){s.removeChild(m),Il(a);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")Uc(s.ownerDocument.documentElement);else if(o==="head"){o=s.ownerDocument.head,Uc(o);for(var f=o.firstChild;f;){var w=f.nextSibling,S=f.nodeName;f[gn]||S==="SCRIPT"||S==="STYLE"||S==="LINK"&&f.rel.toLowerCase()==="stylesheet"||o.removeChild(f),f=w}}else o==="body"&&Uc(s.ownerDocument.body);o=m}while(o);Il(a)}function Xv(s,a){var o=s;s=0;do{var c=o.nextSibling;if(o.nodeType===1?a?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(a?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(s===0)break;s--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||s++;o=c}while(o)}function ap(s){var a=s.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var o=a;switch(a=a.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":ap(o),Tn(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}s.removeChild(o)}}function Jj(s,a,o,c){for(;s.nodeType===1;){var m=o;if(s.nodeName.toLowerCase()!==a.toLowerCase()){if(!c&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(c){if(!s[gn])switch(a){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(f=s.getAttribute("rel"),f==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(f!==m.rel||s.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||s.getAttribute("title")!==(m.title==null?null:m.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(f=s.getAttribute("src"),(f!==(m.src==null?null:m.src)||s.getAttribute("type")!==(m.type==null?null:m.type)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&f&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(a==="input"&&s.type==="hidden"){var f=m.name==null?null:""+m.name;if(m.type==="hidden"&&s.getAttribute("name")===f)return s}else return s;if(s=aa(s.nextSibling),s===null)break}return null}function Zj(s,a,o){if(a==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!o||(s=aa(s.nextSibling),s===null))return null;return s}function Jv(s,a){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!a||(s=aa(s.nextSibling),s===null))return null;return s}function ip(s){return s.data==="$?"||s.data==="$~"}function op(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function eT(s,a){var o=s.ownerDocument;if(s.data==="$~")s._reactRetry=a;else if(s.data!=="$?"||o.readyState!=="loading")a();else{var c=function(){a(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),s._reactRetry=c}}function aa(s){for(;s!=null;s=s.nextSibling){var a=s.nodeType;if(a===1||a===3)break;if(a===8){if(a=s.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return s}var lp=null;function Zv(s){s=s.nextSibling;for(var a=0;s;){if(s.nodeType===8){var o=s.data;if(o==="/$"||o==="/&"){if(a===0)return aa(s.nextSibling);a--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||a++}s=s.nextSibling}return null}function e1(s){s=s.previousSibling;for(var a=0;s;){if(s.nodeType===8){var o=s.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(a===0)return s;a--}else o!=="/$"&&o!=="/&"||a++}s=s.previousSibling}return null}function t1(s,a,o){switch(a=Ud(o),s){case"html":if(s=a.documentElement,!s)throw Error(i(452));return s;case"head":if(s=a.head,!s)throw Error(i(453));return s;case"body":if(s=a.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function Uc(s){for(var a=s.attributes;a.length;)s.removeAttributeNode(a[0]);Tn(s)}var ia=new Map,s1=new Set;function Fd(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var ci=de.d;de.d={f:tT,r:sT,D:nT,C:rT,L:aT,m:iT,X:lT,S:oT,M:cT};function tT(){var s=ci.f(),a=Md();return s||a}function sT(s){var a=yn(s);a!==null&&a.tag===5&&a.type==="form"?v0(a):ci.r(s)}var Rl=typeof document>"u"?null:document;function n1(s,a,o){var c=Rl;if(c&&typeof a=="string"&&a){var m=xe(a);m='link[rel="'+s+'"][href="'+m+'"]',typeof o=="string"&&(m+='[crossorigin="'+o+'"]'),s1.has(m)||(s1.add(m),s={rel:s,crossOrigin:o,href:a},c.querySelector(m)===null&&(a=c.createElement("link"),ar(a,"link",s),N(a),c.head.appendChild(a)))}}function nT(s){ci.D(s),n1("dns-prefetch",s,null)}function rT(s,a){ci.C(s,a),n1("preconnect",s,a)}function aT(s,a,o){ci.L(s,a,o);var c=Rl;if(c&&s&&a){var m='link[rel="preload"][as="'+xe(a)+'"]';a==="image"&&o&&o.imageSrcSet?(m+='[imagesrcset="'+xe(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(m+='[imagesizes="'+xe(o.imageSizes)+'"]')):m+='[href="'+xe(s)+'"]';var f=m;switch(a){case"style":f=Al(s);break;case"script":f=Ml(s)}ia.has(f)||(s=j({rel:"preload",href:a==="image"&&o&&o.imageSrcSet?void 0:s,as:a},o),ia.set(f,s),c.querySelector(m)!==null||a==="style"&&c.querySelector(Fc(f))||a==="script"&&c.querySelector(zc(f))||(a=c.createElement("link"),ar(a,"link",s),N(a),c.head.appendChild(a)))}}function iT(s,a){ci.m(s,a);var o=Rl;if(o&&s){var c=a&&typeof a.as=="string"?a.as:"script",m='link[rel="modulepreload"][as="'+xe(c)+'"][href="'+xe(s)+'"]',f=m;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":f=Ml(s)}if(!ia.has(f)&&(s=j({rel:"modulepreload",href:s},a),ia.set(f,s),o.querySelector(m)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(zc(f)))return}c=o.createElement("link"),ar(c,"link",s),N(c),o.head.appendChild(c)}}}function oT(s,a,o){ci.S(s,a,o);var c=Rl;if(c&&s){var m=k(c).hoistableStyles,f=Al(s);a=a||"default";var w=m.get(f);if(!w){var S={loading:0,preload:null};if(w=c.querySelector(Fc(f)))S.loading=5;else{s=j({rel:"stylesheet",href:s,"data-precedence":a},o),(o=ia.get(f))&&cp(s,o);var z=w=c.createElement("link");N(z),ar(z,"link",s),z._p=new Promise(function(le,Te){z.onload=le,z.onerror=Te}),z.addEventListener("load",function(){S.loading|=1}),z.addEventListener("error",function(){S.loading|=2}),S.loading|=4,zd(w,a,c)}w={type:"stylesheet",instance:w,count:1,state:S},m.set(f,w)}}}function lT(s,a){ci.X(s,a);var o=Rl;if(o&&s){var c=k(o).hoistableScripts,m=Ml(s),f=c.get(m);f||(f=o.querySelector(zc(m)),f||(s=j({src:s,async:!0},a),(a=ia.get(m))&&up(s,a),f=o.createElement("script"),N(f),ar(f,"link",s),o.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},c.set(m,f))}}function cT(s,a){ci.M(s,a);var o=Rl;if(o&&s){var c=k(o).hoistableScripts,m=Ml(s),f=c.get(m);f||(f=o.querySelector(zc(m)),f||(s=j({src:s,async:!0,type:"module"},a),(a=ia.get(m))&&up(s,a),f=o.createElement("script"),N(f),ar(f,"link",s),o.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},c.set(m,f))}}function r1(s,a,o,c){var m=(m=Le.current)?Fd(m):null;if(!m)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(a=Al(o.href),o=k(m).hoistableStyles,c=o.get(a),c||(c={type:"style",instance:null,count:0,state:null},o.set(a,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){s=Al(o.href);var f=k(m).hoistableStyles,w=f.get(s);if(w||(m=m.ownerDocument||m,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},f.set(s,w),(f=m.querySelector(Fc(s)))&&!f._p&&(w.instance=f,w.state.loading=5),ia.has(s)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},ia.set(s,o),f||uT(m,s,o,w.state))),a&&c===null)throw Error(i(528,""));return w}if(a&&c!==null)throw Error(i(529,""));return null;case"script":return a=o.async,o=o.src,typeof o=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Ml(o),o=k(m).hoistableScripts,c=o.get(a),c||(c={type:"script",instance:null,count:0,state:null},o.set(a,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function Al(s){return'href="'+xe(s)+'"'}function Fc(s){return'link[rel="stylesheet"]['+s+"]"}function a1(s){return j({},s,{"data-precedence":s.precedence,precedence:null})}function uT(s,a,o,c){s.querySelector('link[rel="preload"][as="style"]['+a+"]")?c.loading=1:(a=s.createElement("link"),c.preload=a,a.addEventListener("load",function(){return c.loading|=1}),a.addEventListener("error",function(){return c.loading|=2}),ar(a,"link",o),N(a),s.head.appendChild(a))}function Ml(s){return'[src="'+xe(s)+'"]'}function zc(s){return"script[async]"+s}function i1(s,a,o){if(a.count++,a.instance===null)switch(a.type){case"style":var c=s.querySelector('style[data-href~="'+xe(o.href)+'"]');if(c)return a.instance=c,N(c),c;var m=j({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(s.ownerDocument||s).createElement("style"),N(c),ar(c,"style",m),zd(c,o.precedence,s),a.instance=c;case"stylesheet":m=Al(o.href);var f=s.querySelector(Fc(m));if(f)return a.state.loading|=4,a.instance=f,N(f),f;c=a1(o),(m=ia.get(m))&&cp(c,m),f=(s.ownerDocument||s).createElement("link"),N(f);var w=f;return w._p=new Promise(function(S,z){w.onload=S,w.onerror=z}),ar(f,"link",c),a.state.loading|=4,zd(f,o.precedence,s),a.instance=f;case"script":return f=Ml(o.src),(m=s.querySelector(zc(f)))?(a.instance=m,N(m),m):(c=o,(m=ia.get(f))&&(c=j({},o),up(c,m)),s=s.ownerDocument||s,m=s.createElement("script"),N(m),ar(m,"link",c),s.head.appendChild(m),a.instance=m);case"void":return null;default:throw Error(i(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(c=a.instance,a.state.loading|=4,zd(c,o.precedence,s));return a.instance}function zd(s,a,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=c.length?c[c.length-1]:null,f=m,w=0;w<c.length;w++){var S=c[w];if(S.dataset.precedence===a)f=S;else if(f!==m)break}f?f.parentNode.insertBefore(s,f.nextSibling):(a=o.nodeType===9?o.head:o,a.insertBefore(s,a.firstChild))}function cp(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.title==null&&(s.title=a.title)}function up(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.integrity==null&&(s.integrity=a.integrity)}var qd=null;function o1(s,a,o){if(qd===null){var c=new Map,m=qd=new Map;m.set(o,c)}else m=qd,c=m.get(o),c||(c=new Map,m.set(o,c));if(c.has(s))return c;for(c.set(s,null),o=o.getElementsByTagName(s),m=0;m<o.length;m++){var f=o[m];if(!(f[gn]||f[ct]||s==="link"&&f.getAttribute("rel")==="stylesheet")&&f.namespaceURI!=="http://www.w3.org/2000/svg"){var w=f.getAttribute(a)||"";w=s+w;var S=c.get(w);S?S.push(f):c.set(w,[f])}}return c}function l1(s,a,o){s=s.ownerDocument||s,s.head.insertBefore(o,a==="title"?s.querySelector("head > title"):null)}function dT(s,a,o){if(o===1||a.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;return a.rel==="stylesheet"?(s=a.disabled,typeof a.precedence=="string"&&s==null):!0;case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function c1(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function hT(s,a,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var m=Al(c.href),f=a.querySelector(Fc(m));if(f){a=f._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(s.count++,s=Hd.bind(s),a.then(s,s)),o.state.loading|=4,o.instance=f,N(f);return}f=a.ownerDocument||a,c=a1(c),(m=ia.get(m))&&cp(c,m),f=f.createElement("link"),N(f);var w=f;w._p=new Promise(function(S,z){w.onload=S,w.onerror=z}),ar(f,"link",c),o.instance=f}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(o,a),(a=o.state.preload)&&(o.state.loading&3)===0&&(s.count++,o=Hd.bind(s),a.addEventListener("load",o),a.addEventListener("error",o))}}var dp=0;function mT(s,a){return s.stylesheets&&s.count===0&&Wd(s,s.stylesheets),0<s.count||0<s.imgCount?function(o){var c=setTimeout(function(){if(s.stylesheets&&Wd(s,s.stylesheets),s.unsuspend){var f=s.unsuspend;s.unsuspend=null,f()}},6e4+a);0<s.imgBytes&&dp===0&&(dp=62500*Gj());var m=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&Wd(s,s.stylesheets),s.unsuspend)){var f=s.unsuspend;s.unsuspend=null,f()}},(s.imgBytes>dp?50:800)+a);return s.unsuspend=o,function(){s.unsuspend=null,clearTimeout(c),clearTimeout(m)}}:null}function Hd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Wd(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var $d=null;function Wd(s,a){s.stylesheets=null,s.unsuspend!==null&&(s.count++,$d=new Map,a.forEach(fT,s),$d=null,Hd.call(s))}function fT(s,a){if(!(a.state.loading&4)){var o=$d.get(s);if(o)var c=o.get(null);else{o=new Map,$d.set(s,o);for(var m=s.querySelectorAll("link[data-precedence],style[data-precedence]"),f=0;f<m.length;f++){var w=m[f];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(o.set(w.dataset.precedence,w),c=w)}c&&o.set(null,c)}m=a.instance,w=m.getAttribute("data-precedence"),f=o.get(w)||c,f===c&&o.set(null,m),o.set(w,m),this.count++,c=Hd.bind(this),m.addEventListener("load",c),m.addEventListener("error",c),f?f.parentNode.insertBefore(m,f.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(m,s.firstChild)),a.state.loading|=4}}var qc={$$typeof:ae,Provider:null,Consumer:null,_currentValue:Ie,_currentValue2:Ie,_threadCount:0};function pT(s,a,o,c,m,f,w,S,z){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=gt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.hiddenUpdates=gt(null),this.identifierPrefix=c,this.onUncaughtError=m,this.onCaughtError=f,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=z,this.incompleteTransitions=new Map}function u1(s,a,o,c,m,f,w,S,z,le,Te,Pe){return s=new pT(s,a,o,w,z,le,Te,Pe,S),a=1,f===!0&&(a|=24),f=zr(3,null,null,a),s.current=f,f.stateNode=s,a=qm(),a.refCount++,s.pooledCache=a,a.refCount++,f.memoizedState={element:c,isDehydrated:o,cache:a},Gm(f),s}function d1(s){return s?(s=cl,s):cl}function h1(s,a,o,c,m,f){m=d1(m),c.context===null?c.context=m:c.pendingContext=m,c=Ci(a),c.payload={element:o},f=f===void 0?null:f,f!==null&&(c.callback=f),o=Ri(s,c,a),o!==null&&(Or(o,s,a),wc(o,s,a))}function m1(s,a){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var o=s.retryLane;s.retryLane=o!==0&&o<a?o:a}}function hp(s,a){m1(s,a),(s=s.alternate)&&m1(s,a)}function f1(s){if(s.tag===13||s.tag===31){var a=_o(s,67108864);a!==null&&Or(a,s,67108864),hp(s,67108864)}}function p1(s){if(s.tag===13||s.tag===31){var a=Gr();a=H(a);var o=_o(s,a);o!==null&&Or(o,s,a),hp(s,a)}}var Gd=!0;function gT(s,a,o,c){var m=W.T;W.T=null;var f=de.p;try{de.p=2,mp(s,a,o,c)}finally{de.p=f,W.T=m}}function yT(s,a,o,c){var m=W.T;W.T=null;var f=de.p;try{de.p=8,mp(s,a,o,c)}finally{de.p=f,W.T=m}}function mp(s,a,o,c){if(Gd){var m=fp(c);if(m===null)Zf(s,a,c,Kd,o),y1(s,c);else if(vT(m,s,a,o,c))c.stopPropagation();else if(y1(s,c),a&4&&-1<bT.indexOf(s)){for(;m!==null;){var f=yn(m);if(f!==null)switch(f.tag){case 3:if(f=f.stateNode,f.current.memoizedState.isDehydrated){var w=We(f.pendingLanes);if(w!==0){var S=f;for(S.pendingLanes|=2,S.entangledLanes|=2;w;){var z=1<<31-Ee(w);S.entanglements[1]|=z,w&=~z}Ia(f),(Vs&6)===0&&(Rd=Ut()+500,Oc(0))}}break;case 31:case 13:S=_o(f,2),S!==null&&Or(S,f,2),Md(),hp(f,2)}if(f=fp(c),f===null&&Zf(s,a,c,Kd,o),f===m)break;m=f}m!==null&&c.stopPropagation()}else Zf(s,a,c,null,o)}}function fp(s){return s=mn(s),pp(s)}var Kd=null;function pp(s){if(Kd=null,s=In(s),s!==null){var a=u(s);if(a===null)s=null;else{var o=a.tag;if(o===13){if(s=d(a),s!==null)return s;s=null}else if(o===31){if(s=p(a),s!==null)return s;s=null}else if(o===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;s=null}else a!==s&&(s=null)}}return Kd=s,null}function g1(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(St()){case is:return 2;case Is:return 8;case zt:case Js:return 32;case Lt:return 268435456;default:return 32}default:return 32}}var gp=!1,Fi=null,zi=null,qi=null,Hc=new Map,$c=new Map,Hi=[],bT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function y1(s,a){switch(s){case"focusin":case"focusout":Fi=null;break;case"dragenter":case"dragleave":zi=null;break;case"mouseover":case"mouseout":qi=null;break;case"pointerover":case"pointerout":Hc.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":$c.delete(a.pointerId)}}function Wc(s,a,o,c,m,f){return s===null||s.nativeEvent!==f?(s={blockedOn:a,domEventName:o,eventSystemFlags:c,nativeEvent:f,targetContainers:[m]},a!==null&&(a=yn(a),a!==null&&f1(a)),s):(s.eventSystemFlags|=c,a=s.targetContainers,m!==null&&a.indexOf(m)===-1&&a.push(m),s)}function vT(s,a,o,c,m){switch(a){case"focusin":return Fi=Wc(Fi,s,a,o,c,m),!0;case"dragenter":return zi=Wc(zi,s,a,o,c,m),!0;case"mouseover":return qi=Wc(qi,s,a,o,c,m),!0;case"pointerover":var f=m.pointerId;return Hc.set(f,Wc(Hc.get(f)||null,s,a,o,c,m)),!0;case"gotpointercapture":return f=m.pointerId,$c.set(f,Wc($c.get(f)||null,s,a,o,c,m)),!0}return!1}function b1(s){var a=In(s.target);if(a!==null){var o=u(a);if(o!==null){if(a=o.tag,a===13){if(a=d(o),a!==null){s.blockedOn=a,Se(s.priority,function(){p1(o)});return}}else if(a===31){if(a=p(o),a!==null){s.blockedOn=a,Se(s.priority,function(){p1(o)});return}}else if(a===3&&o.stateNode.current.memoizedState.isDehydrated){s.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Yd(s){if(s.blockedOn!==null)return!1;for(var a=s.targetContainers;0<a.length;){var o=fp(s.nativeEvent);if(o===null){o=s.nativeEvent;var c=new o.constructor(o.type,o);en=c,o.target.dispatchEvent(c),en=null}else return a=yn(o),a!==null&&f1(a),s.blockedOn=o,!1;a.shift()}return!0}function v1(s,a,o){Yd(s)&&o.delete(a)}function xT(){gp=!1,Fi!==null&&Yd(Fi)&&(Fi=null),zi!==null&&Yd(zi)&&(zi=null),qi!==null&&Yd(qi)&&(qi=null),Hc.forEach(v1),$c.forEach(v1)}function Qd(s,a){s.blockedOn===a&&(s.blockedOn=null,gp||(gp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,xT)))}var Xd=null;function x1(s){Xd!==s&&(Xd=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Xd===s&&(Xd=null);for(var a=0;a<s.length;a+=3){var o=s[a],c=s[a+1],m=s[a+2];if(typeof c!="function"){if(pp(c||o)===null)continue;break}var f=yn(o);f!==null&&(s.splice(a,3),a-=3,ff(f,{pending:!0,data:m,method:o.method,action:c},c,m))}}))}function Il(s){function a(z){return Qd(z,s)}Fi!==null&&Qd(Fi,s),zi!==null&&Qd(zi,s),qi!==null&&Qd(qi,s),Hc.forEach(a),$c.forEach(a);for(var o=0;o<Hi.length;o++){var c=Hi[o];c.blockedOn===s&&(c.blockedOn=null)}for(;0<Hi.length&&(o=Hi[0],o.blockedOn===null);)b1(o),o.blockedOn===null&&Hi.shift();if(o=(s.ownerDocument||s).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var m=o[c],f=o[c+1],w=m[xt]||null;if(typeof f=="function")w||x1(o);else if(w){var S=null;if(f&&f.hasAttribute("formAction")){if(m=f,w=f[xt]||null)S=w.formAction;else if(pp(m)!==null)continue}else S=w.action;typeof S=="function"?o[c+1]=S:(o.splice(c,3),c-=3),x1(o)}}}function w1(){function s(f){f.canIntercept&&f.info==="react-transition"&&f.intercept({handler:function(){return new Promise(function(w){return m=w})},focusReset:"manual",scroll:"manual"})}function a(){m!==null&&(m(),m=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var f=navigation.currentEntry;f&&f.url!=null&&navigation.navigate(f.url,{state:f.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,m=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),m!==null&&(m(),m=null)}}}function yp(s){this._internalRoot=s}Jd.prototype.render=yp.prototype.render=function(s){var a=this._internalRoot;if(a===null)throw Error(i(409));var o=a.current,c=Gr();h1(o,c,s,a,null,null)},Jd.prototype.unmount=yp.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var a=s.containerInfo;h1(s.current,2,null,s,null,null),Md(),a[Ze]=null}};function Jd(s){this._internalRoot=s}Jd.prototype.unstable_scheduleHydration=function(s){if(s){var a=Ne();s={blockedOn:null,target:s,priority:a};for(var o=0;o<Hi.length&&a!==0&&a<Hi[o].priority;o++);Hi.splice(o,0,s),o===0&&b1(s)}};var _1=e.version;if(_1!=="19.2.4")throw Error(i(527,_1,"19.2.4"));de.findDOMNode=function(s){var a=s._reactInternals;if(a===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=y(a),s=s!==null?x(s):null,s=s===null?null:s.stateNode,s};var wT={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:W,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Zd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Zd.isDisabled&&Zd.supportsFiber)try{we=Zd.inject(wT),G=Zd}catch{}}return Kc.createRoot=function(s,a){if(!l(s))throw Error(i(299));var o=!1,c="",m=C0,f=R0,w=A0;return a!=null&&(a.unstable_strictMode===!0&&(o=!0),a.identifierPrefix!==void 0&&(c=a.identifierPrefix),a.onUncaughtError!==void 0&&(m=a.onUncaughtError),a.onCaughtError!==void 0&&(f=a.onCaughtError),a.onRecoverableError!==void 0&&(w=a.onRecoverableError)),a=u1(s,1,!1,null,null,o,c,null,m,f,w,w1),s[Ze]=a.current,Jf(s),new yp(a)},Kc.hydrateRoot=function(s,a,o){if(!l(s))throw Error(i(299));var c=!1,m="",f=C0,w=R0,S=A0,z=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(m=o.identifierPrefix),o.onUncaughtError!==void 0&&(f=o.onUncaughtError),o.onCaughtError!==void 0&&(w=o.onCaughtError),o.onRecoverableError!==void 0&&(S=o.onRecoverableError),o.formState!==void 0&&(z=o.formState)),a=u1(s,1,!0,a,o??null,c,m,z,f,w,S,w1),a.context=d1(null),o=a.current,c=Gr(),c=H(c),m=Ci(c),m.callback=null,Ri(o,m,c),o=c,a.current.lanes=o,Gt(a,o),Ia(a),s[Ze]=a.current,Jf(s),new Jd(a)},Kc.version="19.2.4",Kc}var M1;function AT(){if(M1)return xp.exports;M1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),xp.exports=RT(),xp.exports}var MT=AT();const IT="modulepreload",DT=function(n){return"/login/"+n},I1={},Ar=function(e,t,i){let l=Promise.resolve();if(t&&t.length>0){let g=function(y){return Promise.all(y.map(x=>Promise.resolve(x).then(j=>({status:"fulfilled",value:j}),j=>({status:"rejected",reason:j}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),p=d?.nonce||d?.getAttribute("nonce");l=g(t.map(y=>{if(y=DT(y),y in I1)return;I1[y]=!0;const x=y.endsWith(".css"),j=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${j}`))return;const T=document.createElement("link");if(T.rel=x?"stylesheet":IT,x||(T.as="script"),T.crossOrigin="",T.href=y,p&&T.setAttribute("nonce",p),document.head.appendChild(T),x)return new Promise((B,$)=>{T.addEventListener("load",B),T.addEventListener("error",()=>$(new Error(`Unable to preload CSS for ${y}`)))})}))}function u(d){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=d,window.dispatchEvent(p),!p.defaultPrevented)throw d}return l.then(d=>{for(const p of d||[])p.status==="rejected"&&u(p.reason);return e().catch(u)})};var D1="popstate";function PT(n={}){function e(i,l){let{pathname:u,search:d,hash:p}=i.location;return rg("",{pathname:u,search:d,hash:p},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function t(i,l){return typeof l=="string"?l:pu(l)}return OT(e,t,null,n)}function dn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function ca(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function LT(){return Math.random().toString(36).substring(2,10)}function P1(n,e){return{usr:n.state,key:n.key,idx:e}}function rg(n,e,t=null,i){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?sc(e):e,state:t,key:e&&e.key||i||LT()}}function pu({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function sc(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substring(i),n=n.substring(0,i)),n&&(e.pathname=n)}return e}function OT(n,e,t,i={}){let{window:l=document.defaultView,v5Compat:u=!1}=i,d=l.history,p="POP",g=null,y=x();y==null&&(y=0,d.replaceState({...d.state,idx:y},""));function x(){return(d.state||{idx:null}).idx}function j(){p="POP";let V=x(),te=V==null?null:V-y;y=V,g&&g({action:p,location:F.location,delta:te})}function T(V,te){p="PUSH";let K=rg(F.location,V,te);y=x()+1;let ae=P1(K,y),ye=F.createHref(K);try{d.pushState(ae,"",ye)}catch(Ae){if(Ae instanceof DOMException&&Ae.name==="DataCloneError")throw Ae;l.location.assign(ye)}u&&g&&g({action:p,location:F.location,delta:1})}function B(V,te){p="REPLACE";let K=rg(F.location,V,te);y=x();let ae=P1(K,y),ye=F.createHref(K);d.replaceState(ae,"",ye),u&&g&&g({action:p,location:F.location,delta:0})}function $(V){return BT(V)}let F={get action(){return p},get location(){return n(l,d)},listen(V){if(g)throw new Error("A history only accepts one active listener");return l.addEventListener(D1,j),g=V,()=>{l.removeEventListener(D1,j),g=null}},createHref(V){return e(l,V)},createURL:$,encodeLocation(V){let te=$(V);return{pathname:te.pathname,search:te.search,hash:te.hash}},push:T,replace:B,go(V){return d.go(V)}};return F}function BT(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),dn(t,"No window.location.(origin|href) available to create URL");let i=typeof n=="string"?n:pu(n);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function L2(n,e,t="/"){return VT(n,e,t,!1)}function VT(n,e,t,i){let l=typeof e=="string"?sc(e):e,u=pi(l.pathname||"/",t);if(u==null)return null;let d=O2(n);UT(d);let p=null;for(let g=0;p==null&&g<d.length;++g){let y=XT(u);p=YT(d[g],y,i)}return p}function O2(n,e=[],t=[],i="",l=!1){let u=(d,p,g=l,y)=>{let x={relativePath:y===void 0?d.path||"":y,caseSensitive:d.caseSensitive===!0,childrenIndex:p,route:d};if(x.relativePath.startsWith("/")){if(!x.relativePath.startsWith(i)&&g)return;dn(x.relativePath.startsWith(i),`Absolute route path "${x.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),x.relativePath=x.relativePath.slice(i.length)}let j=hi([i,x.relativePath]),T=t.concat(x);d.children&&d.children.length>0&&(dn(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${j}".`),O2(d.children,e,T,j,g)),!(d.path==null&&!d.index)&&e.push({path:j,score:GT(j,d.index),routesMeta:T})};return n.forEach((d,p)=>{if(d.path===""||!d.path?.includes("?"))u(d,p);else for(let g of B2(d.path))u(d,p,!0,g)}),e}function B2(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,l=t.endsWith("?"),u=t.replace(/\?$/,"");if(i.length===0)return l?[u,""]:[u];let d=B2(i.join("/")),p=[];return p.push(...d.map(g=>g===""?u:[u,g].join("/"))),l&&p.push(...d),p.map(g=>n.startsWith("/")&&g===""?"/":g)}function UT(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:KT(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var FT=/^:[\w-]+$/,zT=3,qT=2,HT=1,$T=10,WT=-2,L1=n=>n==="*";function GT(n,e){let t=n.split("/"),i=t.length;return t.some(L1)&&(i+=WT),e&&(i+=qT),t.filter(l=>!L1(l)).reduce((l,u)=>l+(FT.test(u)?zT:u===""?HT:$T),i)}function KT(n,e){return n.length===e.length&&n.slice(0,-1).every((i,l)=>i===e[l])?n[n.length-1]-e[e.length-1]:0}function YT(n,e,t=!1){let{routesMeta:i}=n,l={},u="/",d=[];for(let p=0;p<i.length;++p){let g=i[p],y=p===i.length-1,x=u==="/"?e:e.slice(u.length)||"/",j=Sh({path:g.relativePath,caseSensitive:g.caseSensitive,end:y},x),T=g.route;if(!j&&y&&t&&!i[i.length-1].route.index&&(j=Sh({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},x)),!j)return null;Object.assign(l,j.params),d.push({params:l,pathname:hi([u,j.pathname]),pathnameBase:tE(hi([u,j.pathnameBase])),route:T}),j.pathnameBase!=="/"&&(u=hi([u,j.pathnameBase]))}return d}function Sh(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=QT(n.path,n.caseSensitive,n.end),l=e.match(t);if(!l)return null;let u=l[0],d=u.replace(/(.)\/+$/,"$1"),p=l.slice(1);return{params:i.reduce((y,{paramName:x,isOptional:j},T)=>{if(x==="*"){let $=p[T]||"";d=u.slice(0,u.length-$.length).replace(/(.)\/+$/,"$1")}const B=p[T];return j&&!B?y[x]=void 0:y[x]=(B||"").replace(/%2F/g,"/"),y},{}),pathname:u,pathnameBase:d,pattern:n}}function QT(n,e=!1,t=!0){ca(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let i=[],l="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,p,g)=>(i.push({paramName:p,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(i.push({paramName:"*"}),l+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?l+="\\/*$":n!==""&&n!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,e?void 0:"i"),i]}function XT(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ca(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function pi(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}var JT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function ZT(n,e="/"){let{pathname:t,search:i="",hash:l=""}=typeof n=="string"?sc(n):n,u;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?u=O1(t.substring(1),"/"):u=O1(t,e)):u=e,{pathname:u,search:sE(i),hash:nE(l)}}function O1(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(l=>{l===".."?t.length>1&&t.pop():l!=="."&&t.push(l)}),t.length>1?t.join("/"):"/"}function jp(n,e,t,i){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function eE(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Og(n){let e=eE(n);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function Bg(n,e,t,i=!1){let l;typeof n=="string"?l=sc(n):(l={...n},dn(!l.pathname||!l.pathname.includes("?"),jp("?","pathname","search",l)),dn(!l.pathname||!l.pathname.includes("#"),jp("#","pathname","hash",l)),dn(!l.search||!l.search.includes("#"),jp("#","search","hash",l)));let u=n===""||l.pathname==="",d=u?"/":l.pathname,p;if(d==null)p=t;else{let j=e.length-1;if(!i&&d.startsWith("..")){let T=d.split("/");for(;T[0]==="..";)T.shift(),j-=1;l.pathname=T.join("/")}p=j>=0?e[j]:"/"}let g=ZT(l,p),y=d&&d!=="/"&&d.endsWith("/"),x=(u||d===".")&&t.endsWith("/");return!g.pathname.endsWith("/")&&(y||x)&&(g.pathname+="/"),g}var hi=n=>n.join("/").replace(/\/\/+/g,"/"),tE=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),sE=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,nE=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,rE=class{constructor(n,e,t,i=!1){this.status=n,this.statusText=e||"",this.internal=i,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function aE(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function iE(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var V2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function U2(n,e){let t=n;if(typeof t!="string"||!JT.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let i=t,l=!1;if(V2)try{let u=new URL(window.location.href),d=t.startsWith("//")?new URL(u.protocol+t):new URL(t),p=pi(d.pathname,e);d.origin===u.origin&&p!=null?t=p+d.search+d.hash:l=!0}catch{ca(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:l,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var F2=["POST","PUT","PATCH","DELETE"];new Set(F2);var oE=["GET",...F2];new Set(oE);var nc=v.createContext(null);nc.displayName="DataRouter";var Xh=v.createContext(null);Xh.displayName="DataRouterState";var lE=v.createContext(!1),z2=v.createContext({isTransitioning:!1});z2.displayName="ViewTransition";var cE=v.createContext(new Map);cE.displayName="Fetchers";var uE=v.createContext(null);uE.displayName="Await";var Qr=v.createContext(null);Qr.displayName="Navigation";var Nu=v.createContext(null);Nu.displayName="Location";var Ea=v.createContext({outlet:null,matches:[],isDataRoute:!1});Ea.displayName="Route";var Vg=v.createContext(null);Vg.displayName="RouteError";var q2="REACT_ROUTER_ERROR",dE="REDIRECT",hE="ROUTE_ERROR_RESPONSE";function mE(n){if(n.startsWith(`${q2}:${dE}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function fE(n){if(n.startsWith(`${q2}:${hE}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new rE(e.status,e.statusText,e.data)}catch{}}function pE(n,{relative:e}={}){dn(rc(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=v.useContext(Qr),{hash:l,pathname:u,search:d}=Cu(n,{relative:e}),p=u;return t!=="/"&&(p=u==="/"?t:hi([t,u])),i.createHref({pathname:p,search:d,hash:l})}function rc(){return v.useContext(Nu)!=null}function Sa(){return dn(rc(),"useLocation() may be used only in the context of a <Router> component."),v.useContext(Nu).location}var H2="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function $2(n){v.useContext(Qr).static||v.useLayoutEffect(n)}function er(){let{isDataRoute:n}=v.useContext(Ea);return n?CE():gE()}function gE(){dn(rc(),"useNavigate() may be used only in the context of a <Router> component.");let n=v.useContext(nc),{basename:e,navigator:t}=v.useContext(Qr),{matches:i}=v.useContext(Ea),{pathname:l}=Sa(),u=JSON.stringify(Og(i)),d=v.useRef(!1);return $2(()=>{d.current=!0}),v.useCallback((g,y={})=>{if(ca(d.current,H2),!d.current)return;if(typeof g=="number"){t.go(g);return}let x=Bg(g,JSON.parse(u),l,y.relative==="path");n==null&&e!=="/"&&(x.pathname=x.pathname==="/"?e:hi([e,x.pathname])),(y.replace?t.replace:t.push)(x,y.state,y)},[e,t,u,l,n])}v.createContext(null);function yE(){let{matches:n}=v.useContext(Ea),e=n[n.length-1];return e?e.params:{}}function Cu(n,{relative:e}={}){let{matches:t}=v.useContext(Ea),{pathname:i}=Sa(),l=JSON.stringify(Og(t));return v.useMemo(()=>Bg(n,JSON.parse(l),i,e==="path"),[n,l,i,e])}function bE(n,e){return W2(n,e)}function W2(n,e,t,i,l){dn(rc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=v.useContext(Qr),{matches:d}=v.useContext(Ea),p=d[d.length-1],g=p?p.params:{},y=p?p.pathname:"/",x=p?p.pathnameBase:"/",j=p&&p.route;{let K=j&&j.path||"";K2(y,!j||K.endsWith("*")||K.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${y}" (under <Route path="${K}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${K}"> to <Route path="${K==="/"?"*":`${K}/*`}">.`)}let T=Sa(),B;if(e){let K=typeof e=="string"?sc(e):e;dn(x==="/"||K.pathname?.startsWith(x),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${x}" but pathname "${K.pathname}" was given in the \`location\` prop.`),B=K}else B=T;let $=B.pathname||"/",F=$;if(x!=="/"){let K=x.replace(/^\//,"").split("/");F="/"+$.replace(/^\//,"").split("/").slice(K.length).join("/")}let V=L2(n,{pathname:F});ca(j||V!=null,`No routes matched location "${B.pathname}${B.search}${B.hash}" `),ca(V==null||V[V.length-1].route.element!==void 0||V[V.length-1].route.Component!==void 0||V[V.length-1].route.lazy!==void 0,`Matched leaf route at location "${B.pathname}${B.search}${B.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let te=kE(V&&V.map(K=>Object.assign({},K,{params:Object.assign({},g,K.params),pathname:hi([x,u.encodeLocation?u.encodeLocation(K.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:K.pathname]),pathnameBase:K.pathnameBase==="/"?x:hi([x,u.encodeLocation?u.encodeLocation(K.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:K.pathnameBase])})),d,t,i,l);return e&&te?v.createElement(Nu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...B},navigationType:"POP"}},te):te}function vE(){let n=NE(),e=aE(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:i},u={padding:"2px 4px",backgroundColor:i},d=null;return console.error("Error handled by React Router default ErrorBoundary:",n),d=v.createElement(v.Fragment,null,v.createElement("p",null," Hey developer "),v.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",v.createElement("code",{style:u},"ErrorBoundary")," or"," ",v.createElement("code",{style:u},"errorElement")," prop on your route.")),v.createElement(v.Fragment,null,v.createElement("h2",null,"Unexpected Application Error!"),v.createElement("h3",{style:{fontStyle:"italic"}},e),t?v.createElement("pre",{style:l},t):null,d)}var xE=v.createElement(vE,null),G2=class extends v.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=fE(n.digest);t&&(n=t)}let e=n!==void 0?v.createElement(Ea.Provider,{value:this.props.routeContext},v.createElement(Vg.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?v.createElement(wE,{error:n},e):e}};G2.contextType=lE;var Tp=new WeakMap;function wE({children:n,error:e}){let{basename:t}=v.useContext(Qr);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=mE(e.digest);if(i){let l=Tp.get(e);if(l)throw l;let u=U2(i.location,t);if(V2&&!Tp.get(e))if(u.isExternal||i.reloadDocument)window.location.href=u.absoluteURL||u.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(u.to,{replace:i.replace}));throw Tp.set(e,d),d}return v.createElement("meta",{httpEquiv:"refresh",content:`0;url=${u.absoluteURL||u.to}`})}}return n}function _E({routeContext:n,match:e,children:t}){let i=v.useContext(nc);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),v.createElement(Ea.Provider,{value:n},t)}function kE(n,e=[],t=null,i=null,l=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let u=n,d=t?.errors;if(d!=null){let x=u.findIndex(j=>j.route.id&&d?.[j.route.id]!==void 0);dn(x>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),u=u.slice(0,Math.min(u.length,x+1))}let p=!1,g=-1;if(t)for(let x=0;x<u.length;x++){let j=u[x];if((j.route.HydrateFallback||j.route.hydrateFallbackElement)&&(g=x),j.route.id){let{loaderData:T,errors:B}=t,$=j.route.loader&&!T.hasOwnProperty(j.route.id)&&(!B||B[j.route.id]===void 0);if(j.route.lazy||$){p=!0,g>=0?u=u.slice(0,g+1):u=[u[0]];break}}}let y=t&&i?(x,j)=>{i(x,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:iE(t.matches),errorInfo:j})}:void 0;return u.reduceRight((x,j,T)=>{let B,$=!1,F=null,V=null;t&&(B=d&&j.route.id?d[j.route.id]:void 0,F=j.route.errorElement||xE,p&&(g<0&&T===0?(K2("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),$=!0,V=null):g===T&&($=!0,V=j.route.hydrateFallbackElement||null)));let te=e.concat(u.slice(0,T+1)),K=()=>{let ae;return B?ae=F:$?ae=V:j.route.Component?ae=v.createElement(j.route.Component,null):j.route.element?ae=j.route.element:ae=x,v.createElement(_E,{match:j,routeContext:{outlet:x,matches:te,isDataRoute:t!=null},children:ae})};return t&&(j.route.ErrorBoundary||j.route.errorElement||T===0)?v.createElement(G2,{location:t.location,revalidation:t.revalidation,component:F,error:B,children:K(),routeContext:{outlet:null,matches:te,isDataRoute:!0},onError:y}):K()},null)}function Ug(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function jE(n){let e=v.useContext(nc);return dn(e,Ug(n)),e}function TE(n){let e=v.useContext(Xh);return dn(e,Ug(n)),e}function EE(n){let e=v.useContext(Ea);return dn(e,Ug(n)),e}function Fg(n){let e=EE(n),t=e.matches[e.matches.length-1];return dn(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function SE(){return Fg("useRouteId")}function NE(){let n=v.useContext(Vg),e=TE("useRouteError"),t=Fg("useRouteError");return n!==void 0?n:e.errors?.[t]}function CE(){let{router:n}=jE("useNavigate"),e=Fg("useNavigate"),t=v.useRef(!1);return $2(()=>{t.current=!0}),v.useCallback(async(l,u={})=>{ca(t.current,H2),t.current&&(typeof l=="number"?await n.navigate(l):await n.navigate(l,{fromRouteId:e,...u}))},[n,e])}var B1={};function K2(n,e,t){!e&&!B1[n]&&(B1[n]=!0,ca(!1,t))}v.memo(RE);function RE({routes:n,future:e,state:t,onError:i}){return W2(n,void 0,t,i,e)}function AE({to:n,replace:e,state:t,relative:i}){dn(rc(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=v.useContext(Qr);ca(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=v.useContext(Ea),{pathname:d}=Sa(),p=er(),g=Bg(n,Og(u),d,i==="path"),y=JSON.stringify(g);return v.useEffect(()=>{p(JSON.parse(y),{replace:e,state:t,relative:i})},[p,y,i,e,t]),null}function nn(n){dn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function ME({basename:n="/",children:e=null,location:t,navigationType:i="POP",navigator:l,static:u=!1,unstable_useTransitions:d}){dn(!rc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let p=n.replace(/^\/*/,"/"),g=v.useMemo(()=>({basename:p,navigator:l,static:u,unstable_useTransitions:d,future:{}}),[p,l,u,d]);typeof t=="string"&&(t=sc(t));let{pathname:y="/",search:x="",hash:j="",state:T=null,key:B="default"}=t,$=v.useMemo(()=>{let F=pi(y,p);return F==null?null:{location:{pathname:F,search:x,hash:j,state:T,key:B},navigationType:i}},[p,y,x,j,T,B,i]);return ca($!=null,`<Router basename="${p}"> is not able to match the URL "${y}${x}${j}" because it does not start with the basename, so the <Router> won't render anything.`),$==null?null:v.createElement(Qr.Provider,{value:g},v.createElement(Nu.Provider,{children:e,value:$}))}function IE({children:n,location:e}){return bE(ag(n),e)}function ag(n,e=[]){let t=[];return v.Children.forEach(n,(i,l)=>{if(!v.isValidElement(i))return;let u=[...e,l];if(i.type===v.Fragment){t.push.apply(t,ag(i.props.children,u));return}dn(i.type===nn,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),dn(!i.props.index||!i.props.children,"An index route cannot have child routes.");let d={id:i.props.id||u.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(d.children=ag(i.props.children,u)),t.push(d)}),t}var ph="get",gh="application/x-www-form-urlencoded";function Jh(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function DE(n){return Jh(n)&&n.tagName.toLowerCase()==="button"}function PE(n){return Jh(n)&&n.tagName.toLowerCase()==="form"}function LE(n){return Jh(n)&&n.tagName.toLowerCase()==="input"}function OE(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function BE(n,e){return n.button===0&&(!e||e==="_self")&&!OE(n)}function ig(n=""){return new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let i=n[t];return e.concat(Array.isArray(i)?i.map(l=>[t,l]):[[t,i]])},[]))}function VE(n,e){let t=ig(n);return e&&e.forEach((i,l)=>{t.has(l)||e.getAll(l).forEach(u=>{t.append(l,u)})}),t}var eh=null;function UE(){if(eh===null)try{new FormData(document.createElement("form"),0),eh=!1}catch{eh=!0}return eh}var FE=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Ep(n){return n!=null&&!FE.has(n)?(ca(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${gh}"`),null):n}function zE(n,e){let t,i,l,u,d;if(PE(n)){let p=n.getAttribute("action");i=p?pi(p,e):null,t=n.getAttribute("method")||ph,l=Ep(n.getAttribute("enctype"))||gh,u=new FormData(n)}else if(DE(n)||LE(n)&&(n.type==="submit"||n.type==="image")){let p=n.form;if(p==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let g=n.getAttribute("formaction")||p.getAttribute("action");if(i=g?pi(g,e):null,t=n.getAttribute("formmethod")||p.getAttribute("method")||ph,l=Ep(n.getAttribute("formenctype"))||Ep(p.getAttribute("enctype"))||gh,u=new FormData(p,n),!UE()){let{name:y,type:x,value:j}=n;if(x==="image"){let T=y?`${y}.`:"";u.append(`${T}x`,"0"),u.append(`${T}y`,"0")}else y&&u.append(y,j)}}else{if(Jh(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=ph,i=null,l=gh,d=n}return u&&l==="text/plain"&&(d=u,u=void 0),{action:i,method:t.toLowerCase(),encType:l,formData:u,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function zg(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function qE(n,e,t,i){let l=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t?l.pathname.endsWith("/")?l.pathname=`${l.pathname}_.${i}`:l.pathname=`${l.pathname}.${i}`:l.pathname==="/"?l.pathname=`_root.${i}`:e&&pi(l.pathname,e)==="/"?l.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:l.pathname=`${l.pathname.replace(/\/$/,"")}.${i}`,l}async function HE(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function $E(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function WE(n,e,t){let i=await Promise.all(n.map(async l=>{let u=e.routes[l.route.id];if(u){let d=await HE(u,t);return d.links?d.links():[]}return[]}));return QE(i.flat(1).filter($E).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function V1(n,e,t,i,l,u){let d=(g,y)=>t[y]?g.route.id!==t[y].route.id:!0,p=(g,y)=>t[y].pathname!==g.pathname||t[y].route.path?.endsWith("*")&&t[y].params["*"]!==g.params["*"];return u==="assets"?e.filter((g,y)=>d(g,y)||p(g,y)):u==="data"?e.filter((g,y)=>{let x=i.routes[g.route.id];if(!x||!x.hasLoader)return!1;if(d(g,y)||p(g,y))return!0;if(g.route.shouldRevalidate){let j=g.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:g.params,defaultShouldRevalidate:!0});if(typeof j=="boolean")return j}return!0}):[]}function GE(n,e,{includeHydrateFallback:t}={}){return KE(n.map(i=>{let l=e.routes[i.route.id];if(!l)return[];let u=[l.module];return l.clientActionModule&&(u=u.concat(l.clientActionModule)),l.clientLoaderModule&&(u=u.concat(l.clientLoaderModule)),t&&l.hydrateFallbackModule&&(u=u.concat(l.hydrateFallbackModule)),l.imports&&(u=u.concat(l.imports)),u}).flat(1))}function KE(n){return[...new Set(n)]}function YE(n){let e={},t=Object.keys(n).sort();for(let i of t)e[i]=n[i];return e}function QE(n,e){let t=new Set;return new Set(e),n.reduce((i,l)=>{let u=JSON.stringify(YE(l));return t.has(u)||(t.add(u),i.push({key:u,link:l})),i},[])}function Y2(){let n=v.useContext(nc);return zg(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function XE(){let n=v.useContext(Xh);return zg(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var qg=v.createContext(void 0);qg.displayName="FrameworkContext";function Q2(){let n=v.useContext(qg);return zg(n,"You must render this element inside a <HydratedRouter> element"),n}function JE(n,e){let t=v.useContext(qg),[i,l]=v.useState(!1),[u,d]=v.useState(!1),{onFocus:p,onBlur:g,onMouseEnter:y,onMouseLeave:x,onTouchStart:j}=e,T=v.useRef(null);v.useEffect(()=>{if(n==="render"&&d(!0),n==="viewport"){let F=te=>{te.forEach(K=>{d(K.isIntersecting)})},V=new IntersectionObserver(F,{threshold:.5});return T.current&&V.observe(T.current),()=>{V.disconnect()}}},[n]),v.useEffect(()=>{if(i){let F=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(F)}}},[i]);let B=()=>{l(!0)},$=()=>{l(!1),d(!1)};return t?n!=="intent"?[u,T,{}]:[u,T,{onFocus:Yc(p,B),onBlur:Yc(g,$),onMouseEnter:Yc(y,B),onMouseLeave:Yc(x,$),onTouchStart:Yc(j,B)}]:[!1,T,{}]}function Yc(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function ZE({page:n,...e}){let{router:t}=Y2(),i=v.useMemo(()=>L2(t.routes,n,t.basename),[t.routes,n,t.basename]);return i?v.createElement(tS,{page:n,matches:i,...e}):null}function eS(n){let{manifest:e,routeModules:t}=Q2(),[i,l]=v.useState([]);return v.useEffect(()=>{let u=!1;return WE(n,e,t).then(d=>{u||l(d)}),()=>{u=!0}},[n,e,t]),i}function tS({page:n,matches:e,...t}){let i=Sa(),{future:l,manifest:u,routeModules:d}=Q2(),{basename:p}=Y2(),{loaderData:g,matches:y}=XE(),x=v.useMemo(()=>V1(n,e,y,u,i,"data"),[n,e,y,u,i]),j=v.useMemo(()=>V1(n,e,y,u,i,"assets"),[n,e,y,u,i]),T=v.useMemo(()=>{if(n===i.pathname+i.search+i.hash)return[];let F=new Set,V=!1;if(e.forEach(K=>{let ae=u.routes[K.route.id];!ae||!ae.hasLoader||(!x.some(ye=>ye.route.id===K.route.id)&&K.route.id in g&&d[K.route.id]?.shouldRevalidate||ae.hasClientLoader?V=!0:F.add(K.route.id))}),F.size===0)return[];let te=qE(n,p,l.unstable_trailingSlashAwareDataRequests,"data");return V&&F.size>0&&te.searchParams.set("_routes",e.filter(K=>F.has(K.route.id)).map(K=>K.route.id).join(",")),[te.pathname+te.search]},[p,l.unstable_trailingSlashAwareDataRequests,g,i,u,x,e,n,d]),B=v.useMemo(()=>GE(j,u),[j,u]),$=eS(j);return v.createElement(v.Fragment,null,T.map(F=>v.createElement("link",{key:F,rel:"prefetch",as:"fetch",href:F,...t})),B.map(F=>v.createElement("link",{key:F,rel:"modulepreload",href:F,...t})),$.map(({key:F,link:V})=>v.createElement("link",{key:F,nonce:t.nonce,...V,crossOrigin:V.crossOrigin??t.crossOrigin})))}function sS(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var nS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{nS&&(window.__reactRouterVersion="7.13.0")}catch{}function rS({basename:n,children:e,unstable_useTransitions:t,window:i}){let l=v.useRef();l.current==null&&(l.current=PT({window:i,v5Compat:!0}));let u=l.current,[d,p]=v.useState({action:u.action,location:u.location}),g=v.useCallback(y=>{t===!1?p(y):v.startTransition(()=>p(y))},[t]);return v.useLayoutEffect(()=>u.listen(g),[u,g]),v.createElement(ME,{basename:n,children:e,location:d.location,navigationType:d.action,navigator:u,unstable_useTransitions:t})}var X2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,J2=v.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:l,reloadDocument:u,replace:d,state:p,target:g,to:y,preventScrollReset:x,viewTransition:j,unstable_defaultShouldRevalidate:T,...B},$){let{basename:F,unstable_useTransitions:V}=v.useContext(Qr),te=typeof y=="string"&&X2.test(y),K=U2(y,F);y=K.to;let ae=pE(y,{relative:l}),[ye,Ae,me]=JE(i,B),R=lS(y,{replace:d,state:p,target:g,preventScrollReset:x,relative:l,viewTransition:j,unstable_defaultShouldRevalidate:T,unstable_useTransitions:V});function E(O){e&&e(O),O.defaultPrevented||R(O)}let M=v.createElement("a",{...B,...me,href:K.absoluteURL||ae,onClick:K.isExternal||u?e:E,ref:sS($,Ae),target:g,"data-discover":!te&&t==="render"?"true":void 0});return ye&&!te?v.createElement(v.Fragment,null,M,v.createElement(ZE,{page:ae})):M});J2.displayName="Link";var aS=v.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:l=!1,style:u,to:d,viewTransition:p,children:g,...y},x){let j=Cu(d,{relative:y.relative}),T=Sa(),B=v.useContext(Xh),{navigator:$,basename:F}=v.useContext(Qr),V=B!=null&&fS(j)&&p===!0,te=$.encodeLocation?$.encodeLocation(j).pathname:j.pathname,K=T.pathname,ae=B&&B.navigation&&B.navigation.location?B.navigation.location.pathname:null;t||(K=K.toLowerCase(),ae=ae?ae.toLowerCase():null,te=te.toLowerCase()),ae&&F&&(ae=pi(ae,F)||ae);const ye=te!=="/"&&te.endsWith("/")?te.length-1:te.length;let Ae=K===te||!l&&K.startsWith(te)&&K.charAt(ye)==="/",me=ae!=null&&(ae===te||!l&&ae.startsWith(te)&&ae.charAt(te.length)==="/"),R={isActive:Ae,isPending:me,isTransitioning:V},E=Ae?e:void 0,M;typeof i=="function"?M=i(R):M=[i,Ae?"active":null,me?"pending":null,V?"transitioning":null].filter(Boolean).join(" ");let O=typeof u=="function"?u(R):u;return v.createElement(J2,{...y,"aria-current":E,className:M,ref:x,style:O,to:d,viewTransition:p},typeof g=="function"?g(R):g)});aS.displayName="NavLink";var iS=v.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:l,state:u,method:d=ph,action:p,onSubmit:g,relative:y,preventScrollReset:x,viewTransition:j,unstable_defaultShouldRevalidate:T,...B},$)=>{let{unstable_useTransitions:F}=v.useContext(Qr),V=hS(),te=mS(p,{relative:y}),K=d.toLowerCase()==="get"?"get":"post",ae=typeof p=="string"&&X2.test(p),ye=Ae=>{if(g&&g(Ae),Ae.defaultPrevented)return;Ae.preventDefault();let me=Ae.nativeEvent.submitter,R=me?.getAttribute("formmethod")||d,E=()=>V(me||Ae.currentTarget,{fetcherKey:e,method:R,navigate:t,replace:l,state:u,relative:y,preventScrollReset:x,viewTransition:j,unstable_defaultShouldRevalidate:T});F&&t!==!1?v.startTransition(()=>E()):E()};return v.createElement("form",{ref:$,method:K,action:te,onSubmit:i?g:ye,...B,"data-discover":!ae&&n==="render"?"true":void 0})});iS.displayName="Form";function oS(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Z2(n){let e=v.useContext(nc);return dn(e,oS(n)),e}function lS(n,{target:e,replace:t,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p,unstable_useTransitions:g}={}){let y=er(),x=Sa(),j=Cu(n,{relative:u});return v.useCallback(T=>{if(BE(T,e)){T.preventDefault();let B=t!==void 0?t:pu(x)===pu(j),$=()=>y(n,{replace:B,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p});g?v.startTransition(()=>$()):$()}},[x,y,j,t,i,e,n,l,u,d,p,g])}function cS(n){ca(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=v.useRef(ig(n)),t=v.useRef(!1),i=Sa(),l=v.useMemo(()=>VE(i.search,t.current?null:e.current),[i.search]),u=er(),d=v.useCallback((p,g)=>{const y=ig(typeof p=="function"?p(new URLSearchParams(l)):p);t.current=!0,u("?"+y,g)},[u,l]);return[l,d]}var uS=0,dS=()=>`__${String(++uS)}__`;function hS(){let{router:n}=Z2("useSubmit"),{basename:e}=v.useContext(Qr),t=SE(),i=n.fetch,l=n.navigate;return v.useCallback(async(u,d={})=>{let{action:p,method:g,encType:y,formData:x,body:j}=zE(u,e);if(d.navigate===!1){let T=d.fetcherKey||dS();await i(T,t,d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:x,body:j,formMethod:d.method||g,formEncType:d.encType||y,flushSync:d.flushSync})}else await l(d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:x,body:j,formMethod:d.method||g,formEncType:d.encType||y,replace:d.replace,state:d.state,fromRouteId:t,flushSync:d.flushSync,viewTransition:d.viewTransition})},[i,l,e,t])}function mS(n,{relative:e}={}){let{basename:t}=v.useContext(Qr),i=v.useContext(Ea);dn(i,"useFormAction must be used inside a RouteContext");let[l]=i.matches.slice(-1),u={...Cu(n||".",{relative:e})},d=Sa();if(n==null){u.search=d.search;let p=new URLSearchParams(u.search),g=p.getAll("index");if(g.some(x=>x==="")){p.delete("index"),g.filter(j=>j).forEach(j=>p.append("index",j));let x=p.toString();u.search=x?`?${x}`:""}}return(!n||n===".")&&l.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(u.pathname=u.pathname==="/"?t:hi([t,u.pathname])),pu(u)}function fS(n,{relative:e}={}){let t=v.useContext(z2);dn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=Z2("useViewTransitionState"),l=Cu(n,{relative:e});if(!t.isTransitioning)return!1;let u=pi(t.currentLocation.pathname,i)||t.currentLocation.pathname,d=pi(t.nextLocation.pathname,i)||t.nextLocation.pathname;return Sh(l.pathname,d)!=null||Sh(l.pathname,u)!=null}const pS=()=>{};var U1={};const ew=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let l=n.charCodeAt(i);l<128?e[t++]=l:l<2048?(e[t++]=l>>6|192,e[t++]=l&63|128):(l&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(l=65536+((l&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=l>>18|240,e[t++]=l>>12&63|128,e[t++]=l>>6&63|128,e[t++]=l&63|128):(e[t++]=l>>12|224,e[t++]=l>>6&63|128,e[t++]=l&63|128)}return e},gS=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const l=n[t++];if(l<128)e[i++]=String.fromCharCode(l);else if(l>191&&l<224){const u=n[t++];e[i++]=String.fromCharCode((l&31)<<6|u&63)}else if(l>239&&l<365){const u=n[t++],d=n[t++],p=n[t++],g=((l&7)<<18|(u&63)<<12|(d&63)<<6|p&63)-65536;e[i++]=String.fromCharCode(55296+(g>>10)),e[i++]=String.fromCharCode(56320+(g&1023))}else{const u=n[t++],d=n[t++];e[i++]=String.fromCharCode((l&15)<<12|(u&63)<<6|d&63)}}return e.join("")},tw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let l=0;l<n.length;l+=3){const u=n[l],d=l+1<n.length,p=d?n[l+1]:0,g=l+2<n.length,y=g?n[l+2]:0,x=u>>2,j=(u&3)<<4|p>>4;let T=(p&15)<<2|y>>6,B=y&63;g||(B=64,d||(T=64)),i.push(t[x],t[j],t[T],t[B])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(ew(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):gS(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let l=0;l<n.length;){const u=t[n.charAt(l++)],p=l<n.length?t[n.charAt(l)]:0;++l;const y=l<n.length?t[n.charAt(l)]:64;++l;const j=l<n.length?t[n.charAt(l)]:64;if(++l,u==null||p==null||y==null||j==null)throw new yS;const T=u<<2|p>>4;if(i.push(T),y!==64){const B=p<<4&240|y>>2;if(i.push(B),j!==64){const $=y<<6&192|j;i.push($)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class yS extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const bS=function(n){const e=ew(n);return tw.encodeByteArray(e,!0)},Nh=function(n){return bS(n).replace(/\./g,"")},sw=function(n){try{return tw.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function vS(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const xS=()=>vS().__FIREBASE_DEFAULTS__,wS=()=>{if(typeof process>"u"||typeof U1>"u")return;const n=U1.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},_S=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&sw(n[1]);return e&&JSON.parse(e)},Zh=()=>{try{return pS()||xS()||wS()||_S()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},nw=n=>Zh()?.emulatorHosts?.[n],rw=n=>{const e=nw(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},aw=()=>Zh()?.config,iw=n=>Zh()?.[`_${n}`];class kS{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function po(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Hg(n){return(await fetch(n,{credentials:"include"})).ok}function ow(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",l=n.iat||0,u=n.sub||n.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d={iss:`https://securetoken.google.com/${i}`,aud:i,iat:l,exp:l+3600,auth_time:l,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Nh(JSON.stringify(t)),Nh(JSON.stringify(d)),""].join(".")}const lu={};function jS(){const n={prod:[],emulator:[]};for(const e of Object.keys(lu))lu[e]?n.emulator.push(e):n.prod.push(e);return n}function TS(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let F1=!1;function $g(n,e){if(typeof window>"u"||typeof document>"u"||!po(window.location.host)||lu[n]===e||lu[n]||F1)return;lu[n]=e;function t(T){return`__firebase__banner__${T}`}const i="__firebase__banner",u=jS().prod.length>0;function d(){const T=document.getElementById(i);T&&T.remove()}function p(T){T.style.display="flex",T.style.background="#7faaf0",T.style.position="fixed",T.style.bottom="5px",T.style.left="5px",T.style.padding=".5em",T.style.borderRadius="5px",T.style.alignItems="center"}function g(T,B){T.setAttribute("width","24"),T.setAttribute("id",B),T.setAttribute("height","24"),T.setAttribute("viewBox","0 0 24 24"),T.setAttribute("fill","none"),T.style.marginLeft="-6px"}function y(){const T=document.createElement("span");return T.style.cursor="pointer",T.style.marginLeft="16px",T.style.fontSize="24px",T.innerHTML=" &times;",T.onclick=()=>{F1=!0,d()},T}function x(T,B){T.setAttribute("id",B),T.innerText="Learn more",T.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",T.setAttribute("target","__blank"),T.style.paddingLeft="5px",T.style.textDecoration="underline"}function j(){const T=TS(i),B=t("text"),$=document.getElementById(B)||document.createElement("span"),F=t("learnmore"),V=document.getElementById(F)||document.createElement("a"),te=t("preprendIcon"),K=document.getElementById(te)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(T.created){const ae=T.element;p(ae),x(V,F);const ye=y();g(K,te),ae.append(K,$,V,ye),document.body.appendChild(ae)}u?($.innerText="Preview backend disconnected.",K.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(K.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,$.innerText="Preview backend running in this workspace."),$.setAttribute("id",B)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",j):j()}function vr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ES(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(vr())}function SS(){const n=Zh()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function NS(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function CS(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function RS(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function AS(){const n=vr();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function MS(){return!SS()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function IS(){try{return typeof indexedDB=="object"}catch{return!1}}function DS(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",l=self.indexedDB.open(i);l.onsuccess=()=>{l.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},l.onupgradeneeded=()=>{t=!1},l.onerror=()=>{e(l.error?.message||"")}}catch(t){e(t)}})}const PS="FirebaseError";class Wa extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=PS,Object.setPrototypeOf(this,Wa.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ru.prototype.create)}}class Ru{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},l=`${this.service}/${e}`,u=this.errors[e],d=u?LS(u,i):"Error",p=`${this.serviceName}: ${d} (${l}).`;return new Wa(l,p,i)}}function LS(n,e){return n.replace(OS,(t,i)=>{const l=e[i];return l!=null?String(l):`<${i}?>`})}const OS=/\{\$([^}]+)}/g;function BS(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function $o(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const l of t){if(!i.includes(l))return!1;const u=n[l],d=e[l];if(z1(u)&&z1(d)){if(!$o(u,d))return!1}else if(u!==d)return!1}for(const l of i)if(!t.includes(l))return!1;return!0}function z1(n){return n!==null&&typeof n=="object"}function Au(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(l=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(l))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function su(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[l,u]=i.split("=");e[decodeURIComponent(l)]=decodeURIComponent(u)}}),e}function nu(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function VS(n,e){const t=new US(n,e);return t.subscribe.bind(t)}class US{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let l;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");FS(e,["next","error","complete"])?l=e:l={next:e,error:t,complete:i},l.next===void 0&&(l.next=Sp),l.error===void 0&&(l.error=Sp),l.complete===void 0&&(l.complete=Sp);const u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?l.error(this.finalError):l.complete()}catch{}}),this.observers.push(l),u}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function FS(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Sp(){}function Xs(n){return n&&n._delegate?n._delegate:n}class oo{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Bo="[DEFAULT]";class zS{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new kS;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const l=this.getOrInitializeService({instanceIdentifier:t});l&&i.resolve(l)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(l){if(i)return null;throw l}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(HS(e))try{this.getOrInitializeService({instanceIdentifier:Bo})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(t);try{const u=this.getOrInitializeService({instanceIdentifier:l});i.resolve(u)}catch{}}}}clearInstance(e=Bo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Bo){return this.instances.has(e)}getOptions(e=Bo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const l=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[u,d]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(u);i===p&&d.resolve(l)}return l}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),l=this.onInitCallbacks.get(i)??new Set;l.add(e),this.onInitCallbacks.set(i,l);const u=this.instances.get(i);return u&&e(u,i),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const l of i)try{l(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:qS(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Bo){return this.component?this.component.multipleInstances?e:Bo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function qS(n){return n===Bo?void 0:n}function HS(n){return n.instantiationMode==="EAGER"}class $S{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new zS(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var bs;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(bs||(bs={}));const WS={debug:bs.DEBUG,verbose:bs.VERBOSE,info:bs.INFO,warn:bs.WARN,error:bs.ERROR,silent:bs.SILENT},GS=bs.INFO,KS={[bs.DEBUG]:"log",[bs.VERBOSE]:"log",[bs.INFO]:"info",[bs.WARN]:"warn",[bs.ERROR]:"error"},YS=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),l=KS[e];if(l)console[l](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Wg{constructor(e){this.name=e,this._logLevel=GS,this._logHandler=YS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in bs))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?WS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,bs.DEBUG,...e),this._logHandler(this,bs.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,bs.VERBOSE,...e),this._logHandler(this,bs.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,bs.INFO,...e),this._logHandler(this,bs.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,bs.WARN,...e),this._logHandler(this,bs.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,bs.ERROR,...e),this._logHandler(this,bs.ERROR,...e)}}const QS=(n,e)=>e.some(t=>n instanceof t);let q1,H1;function XS(){return q1||(q1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function JS(){return H1||(H1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const lw=new WeakMap,og=new WeakMap,cw=new WeakMap,Np=new WeakMap,Gg=new WeakMap;function ZS(n){const e=new Promise((t,i)=>{const l=()=>{n.removeEventListener("success",u),n.removeEventListener("error",d)},u=()=>{t(no(n.result)),l()},d=()=>{i(n.error),l()};n.addEventListener("success",u),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&lw.set(t,n)}).catch(()=>{}),Gg.set(e,n),e}function eN(n){if(og.has(n))return;const e=new Promise((t,i)=>{const l=()=>{n.removeEventListener("complete",u),n.removeEventListener("error",d),n.removeEventListener("abort",d)},u=()=>{t(),l()},d=()=>{i(n.error||new DOMException("AbortError","AbortError")),l()};n.addEventListener("complete",u),n.addEventListener("error",d),n.addEventListener("abort",d)});og.set(n,e)}let lg={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return og.get(n);if(e==="objectStoreNames")return n.objectStoreNames||cw.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return no(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function tN(n){lg=n(lg)}function sN(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Cp(this),e,...t);return cw.set(i,e.sort?e.sort():[e]),no(i)}:JS().includes(n)?function(...e){return n.apply(Cp(this),e),no(lw.get(this))}:function(...e){return no(n.apply(Cp(this),e))}}function nN(n){return typeof n=="function"?sN(n):(n instanceof IDBTransaction&&eN(n),QS(n,XS())?new Proxy(n,lg):n)}function no(n){if(n instanceof IDBRequest)return ZS(n);if(Np.has(n))return Np.get(n);const e=nN(n);return e!==n&&(Np.set(n,e),Gg.set(e,n)),e}const Cp=n=>Gg.get(n);function rN(n,e,{blocked:t,upgrade:i,blocking:l,terminated:u}={}){const d=indexedDB.open(n,e),p=no(d);return i&&d.addEventListener("upgradeneeded",g=>{i(no(d.result),g.oldVersion,g.newVersion,no(d.transaction),g)}),t&&d.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),p.then(g=>{u&&g.addEventListener("close",()=>u()),l&&g.addEventListener("versionchange",y=>l(y.oldVersion,y.newVersion,y))}).catch(()=>{}),p}const aN=["get","getKey","getAll","getAllKeys","count"],iN=["put","add","delete","clear"],Rp=new Map;function $1(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Rp.get(e))return Rp.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,l=iN.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(l||aN.includes(t)))return;const u=async function(d,...p){const g=this.transaction(d,l?"readwrite":"readonly");let y=g.store;return i&&(y=y.index(p.shift())),(await Promise.all([y[t](...p),l&&g.done]))[0]};return Rp.set(e,u),u}tN(n=>({...n,get:(e,t,i)=>$1(e,t)||n.get(e,t,i),has:(e,t)=>!!$1(e,t)||n.has(e,t)}));class oN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(lN(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function lN(n){return n.getComponent()?.type==="VERSION"}const cg="@firebase/app",W1="0.14.7";const gi=new Wg("@firebase/app"),cN="@firebase/app-compat",uN="@firebase/analytics-compat",dN="@firebase/analytics",hN="@firebase/app-check-compat",mN="@firebase/app-check",fN="@firebase/auth",pN="@firebase/auth-compat",gN="@firebase/database",yN="@firebase/data-connect",bN="@firebase/database-compat",vN="@firebase/functions",xN="@firebase/functions-compat",wN="@firebase/installations",_N="@firebase/installations-compat",kN="@firebase/messaging",jN="@firebase/messaging-compat",TN="@firebase/performance",EN="@firebase/performance-compat",SN="@firebase/remote-config",NN="@firebase/remote-config-compat",CN="@firebase/storage",RN="@firebase/storage-compat",AN="@firebase/firestore",MN="@firebase/ai",IN="@firebase/firestore-compat",DN="firebase",PN="12.8.0";const ug="[DEFAULT]",LN={[cg]:"fire-core",[cN]:"fire-core-compat",[dN]:"fire-analytics",[uN]:"fire-analytics-compat",[mN]:"fire-app-check",[hN]:"fire-app-check-compat",[fN]:"fire-auth",[pN]:"fire-auth-compat",[gN]:"fire-rtdb",[yN]:"fire-data-connect",[bN]:"fire-rtdb-compat",[vN]:"fire-fn",[xN]:"fire-fn-compat",[wN]:"fire-iid",[_N]:"fire-iid-compat",[kN]:"fire-fcm",[jN]:"fire-fcm-compat",[TN]:"fire-perf",[EN]:"fire-perf-compat",[SN]:"fire-rc",[NN]:"fire-rc-compat",[CN]:"fire-gcs",[RN]:"fire-gcs-compat",[AN]:"fire-fst",[IN]:"fire-fst-compat",[MN]:"fire-vertex","fire-js":"fire-js",[DN]:"fire-js-all"};const Ch=new Map,ON=new Map,dg=new Map;function G1(n,e){try{n.container.addComponent(e)}catch(t){gi.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Wo(n){const e=n.name;if(dg.has(e))return gi.debug(`There were multiple attempts to register component ${e}.`),!1;dg.set(e,n);for(const t of Ch.values())G1(t,n);for(const t of ON.values())G1(t,n);return!0}function em(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Kr(n){return n==null?!1:n.settings!==void 0}const BN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ro=new Ru("app","Firebase",BN);class VN{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new oo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ro.create("app-deleted",{appName:this._name})}}const Zo=PN;function Kg(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:ug,automaticDataCollectionEnabled:!0,...e},l=i.name;if(typeof l!="string"||!l)throw ro.create("bad-app-name",{appName:String(l)});if(t||(t=aw()),!t)throw ro.create("no-options");const u=Ch.get(l);if(u){if($o(t,u.options)&&$o(i,u.config))return u;throw ro.create("duplicate-app",{appName:l})}const d=new $S(l);for(const g of dg.values())d.addComponent(g);const p=new VN(t,i,d);return Ch.set(l,p),p}function Yg(n=ug){const e=Ch.get(n);if(!e&&n===ug&&aw())return Kg();if(!e)throw ro.create("no-app",{appName:n});return e}function Ba(n,e,t){let i=LN[n]??n;t&&(i+=`-${t}`);const l=i.match(/\s|\//),u=e.match(/\s|\//);if(l||u){const d=[`Unable to register library "${i}" with version "${e}":`];l&&d.push(`library name "${i}" contains illegal characters (whitespace or "/")`),l&&u&&d.push("and"),u&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),gi.warn(d.join(" "));return}Wo(new oo(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const UN="firebase-heartbeat-database",FN=1,gu="firebase-heartbeat-store";let Ap=null;function uw(){return Ap||(Ap=rN(UN,FN,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(gu)}catch(t){console.warn(t)}}}}).catch(n=>{throw ro.create("idb-open",{originalErrorMessage:n.message})})),Ap}async function zN(n){try{const t=(await uw()).transaction(gu),i=await t.objectStore(gu).get(dw(n));return await t.done,i}catch(e){if(e instanceof Wa)gi.warn(e.message);else{const t=ro.create("idb-get",{originalErrorMessage:e?.message});gi.warn(t.message)}}}async function K1(n,e){try{const i=(await uw()).transaction(gu,"readwrite");await i.objectStore(gu).put(e,dw(n)),await i.done}catch(t){if(t instanceof Wa)gi.warn(t.message);else{const i=ro.create("idb-set",{originalErrorMessage:t?.message});gi.warn(i.message)}}}function dw(n){return`${n.name}!${n.options.appId}`}const qN=1024,HN=30;class $N{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new GN(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Y1();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(l=>l.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>HN){const l=KN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){gi.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Y1(),{heartbeatsToSend:t,unsentEntries:i}=WN(this._heartbeatsCache.heartbeats),l=Nh(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(e){return gi.warn(e),""}}}function Y1(){return new Date().toISOString().substring(0,10)}function WN(n,e=qN){const t=[];let i=n.slice();for(const l of n){const u=t.find(d=>d.agent===l.agent);if(u){if(u.dates.push(l.date),Q1(t)>e){u.dates.pop();break}}else if(t.push({agent:l.agent,dates:[l.date]}),Q1(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class GN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return IS()?DS().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await zN(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return K1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return K1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Q1(n){return Nh(JSON.stringify({version:2,heartbeats:n})).length}function KN(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function YN(n){Wo(new oo("platform-logger",e=>new oN(e),"PRIVATE")),Wo(new oo("heartbeat",e=>new $N(e),"PRIVATE")),Ba(cg,W1,n),Ba(cg,W1,"esm2020"),Ba("fire-js","")}YN("");function hw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const QN=hw,mw=new Ru("auth","Firebase",hw());const Rh=new Wg("@firebase/auth");function XN(n,...e){Rh.logLevel<=bs.WARN&&Rh.warn(`Auth (${Zo}): ${n}`,...e)}function yh(n,...e){Rh.logLevel<=bs.ERROR&&Rh.error(`Auth (${Zo}): ${n}`,...e)}function ka(n,...e){throw Qg(n,...e)}function Va(n,...e){return Qg(n,...e)}function fw(n,e,t){const i={...QN(),[e]:t};return new Ru("auth","Firebase",i).create(e,{appName:n.name})}function mi(n){return fw(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Qg(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return mw.create(n,...e)}function Bt(n,e,...t){if(!n)throw Qg(e,...t)}function ui(n){const e="INTERNAL ASSERTION FAILED: "+n;throw yh(e),new Error(e)}function yi(n,e){n||ui(e)}function hg(){return typeof self<"u"&&self.location?.href||""}function JN(){return X1()==="http:"||X1()==="https:"}function X1(){return typeof self<"u"&&self.location?.protocol||null}function ZN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(JN()||CS()||"connection"in navigator)?navigator.onLine:!0}function eC(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Mu{constructor(e,t){this.shortDelay=e,this.longDelay=t,yi(t>e,"Short delay should be less than long delay!"),this.isMobile=ES()||RS()}get(){return ZN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Xg(n,e){yi(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class pw{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ui("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ui("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ui("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const tC={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const sC=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],nC=new Mu(3e4,6e4);function xi(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function wi(n,e,t,i,l={}){return gw(n,l,async()=>{let u={},d={};i&&(e==="GET"?d=i:u={body:JSON.stringify(i)});const p=Au({key:n.config.apiKey,...d}).slice(1),g=await n._getAdditionalHeaders();g["Content-Type"]="application/json",n.languageCode&&(g["X-Firebase-Locale"]=n.languageCode);const y={method:e,headers:g,...u};return NS()||(y.referrerPolicy="no-referrer"),n.emulatorConfig&&po(n.emulatorConfig.host)&&(y.credentials="include"),pw.fetch()(await yw(n,n.config.apiHost,t,p),y)})}async function gw(n,e,t){n._canInitEmulator=!1;const i={...tC,...e};try{const l=new aC(n),u=await Promise.race([t(),l.promise]);l.clearNetworkTimeout();const d=await u.json();if("needConfirmation"in d)throw th(n,"account-exists-with-different-credential",d);if(u.ok&&!("errorMessage"in d))return d;{const p=u.ok?d.errorMessage:d.error.message,[g,y]=p.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw th(n,"credential-already-in-use",d);if(g==="EMAIL_EXISTS")throw th(n,"email-already-in-use",d);if(g==="USER_DISABLED")throw th(n,"user-disabled",d);const x=i[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw fw(n,x,y);ka(n,x)}}catch(l){if(l instanceof Wa)throw l;ka(n,"network-request-failed",{message:String(l)})}}async function Iu(n,e,t,i,l={}){const u=await wi(n,e,t,i,l);return"mfaPendingCredential"in u&&ka(n,"multi-factor-auth-required",{_serverResponse:u}),u}async function yw(n,e,t,i){const l=`${e}${t}?${i}`,u=n,d=u.config.emulator?Xg(n.config,l):`${n.config.apiScheme}://${l}`;return sC.includes(t)&&(await u._persistenceManagerAvailable,u._getPersistenceType()==="COOKIE")?u._getPersistence()._getFinalTarget(d).toString():d}function rC(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class aC{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Va(this.auth,"network-request-failed")),nC.get())})}}function th(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const l=Va(n,e,i);return l.customData._tokenResponse=t,l}function J1(n){return n!==void 0&&n.enterprise!==void 0}class iC{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return rC(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function oC(n,e){return wi(n,"GET","/v2/recaptchaConfig",xi(n,e))}async function lC(n,e){return wi(n,"POST","/v1/accounts:delete",e)}async function Ah(n,e){return wi(n,"POST","/v1/accounts:lookup",e)}function cu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function cC(n,e=!1){const t=Xs(n),i=await t.getIdToken(e),l=Jg(i);Bt(l&&l.exp&&l.auth_time&&l.iat,t.auth,"internal-error");const u=typeof l.firebase=="object"?l.firebase:void 0,d=u?.sign_in_provider;return{claims:l,token:i,authTime:cu(Mp(l.auth_time)),issuedAtTime:cu(Mp(l.iat)),expirationTime:cu(Mp(l.exp)),signInProvider:d||null,signInSecondFactor:u?.sign_in_second_factor||null}}function Mp(n){return Number(n)*1e3}function Jg(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return yh("JWT malformed, contained fewer than 3 sections"),null;try{const l=sw(t);return l?JSON.parse(l):(yh("Failed to decode base64 JWT payload"),null)}catch(l){return yh("Caught error parsing JWT payload as JSON",l?.toString()),null}}function Z1(n){const e=Jg(n);return Bt(e,"internal-error"),Bt(typeof e.exp<"u","internal-error"),Bt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function yu(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Wa&&uC(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function uC({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class dC{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class mg{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=cu(this.lastLoginAt),this.creationTime=cu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Mh(n){const e=n.auth,t=await n.getIdToken(),i=await yu(n,Ah(e,{idToken:t}));Bt(i?.users.length,e,"internal-error");const l=i.users[0];n._notifyReloadListener(l);const u=l.providerUserInfo?.length?bw(l.providerUserInfo):[],d=mC(n.providerData,u),p=n.isAnonymous,g=!(n.email&&l.passwordHash)&&!d?.length,y=p?g:!1,x={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:d,metadata:new mg(l.createdAt,l.lastLoginAt),isAnonymous:y};Object.assign(n,x)}async function hC(n){const e=Xs(n);await Mh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function mC(n,e){return[...n.filter(i=>!e.some(l=>l.providerId===i.providerId)),...e]}function bw(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function fC(n,e){const t=await gw(n,{},async()=>{const i=Au({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:l,apiKey:u}=n.config,d=await yw(n,l,"/v1/token",`key=${u}`),p=await n._getAdditionalHeaders();p["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:p,body:i};return n.emulatorConfig&&po(n.emulatorConfig.host)&&(g.credentials="include"),pw.fetch()(d,g)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function pC(n,e){return wi(n,"POST","/v2/accounts:revokeToken",xi(n,e))}class $l{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Bt(e.idToken,"internal-error"),Bt(typeof e.idToken<"u","internal-error"),Bt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Z1(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Bt(e.length!==0,"internal-error");const t=Z1(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Bt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:l,expiresIn:u}=await fC(e,t);this.updateTokensAndExpiration(i,l,Number(u))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:l,expirationTime:u}=t,d=new $l;return i&&(Bt(typeof i=="string","internal-error",{appName:e}),d.refreshToken=i),l&&(Bt(typeof l=="string","internal-error",{appName:e}),d.accessToken=l),u&&(Bt(typeof u=="number","internal-error",{appName:e}),d.expirationTime=u),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new $l,this.toJSON())}_performRefresh(){return ui("not implemented")}}function Wi(n,e){Bt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class wa{constructor({uid:e,auth:t,stsTokenManager:i,...l}){this.providerId="firebase",this.proactiveRefresh=new dC(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new mg(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await yu(this,this.stsTokenManager.getToken(this.auth,e));return Bt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return cC(this,e)}reload(){return hC(this)}_assign(e){this!==e&&(Bt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new wa({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Bt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Mh(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Kr(this.auth.app))return Promise.reject(mi(this.auth));const e=await this.getIdToken();return await yu(this,lC(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,l=t.email??void 0,u=t.phoneNumber??void 0,d=t.photoURL??void 0,p=t.tenantId??void 0,g=t._redirectEventId??void 0,y=t.createdAt??void 0,x=t.lastLoginAt??void 0,{uid:j,emailVerified:T,isAnonymous:B,providerData:$,stsTokenManager:F}=t;Bt(j&&F,e,"internal-error");const V=$l.fromJSON(this.name,F);Bt(typeof j=="string",e,"internal-error"),Wi(i,e.name),Wi(l,e.name),Bt(typeof T=="boolean",e,"internal-error"),Bt(typeof B=="boolean",e,"internal-error"),Wi(u,e.name),Wi(d,e.name),Wi(p,e.name),Wi(g,e.name),Wi(y,e.name),Wi(x,e.name);const te=new wa({uid:j,auth:e,email:l,emailVerified:T,displayName:i,isAnonymous:B,photoURL:d,phoneNumber:u,tenantId:p,stsTokenManager:V,createdAt:y,lastLoginAt:x});return $&&Array.isArray($)&&(te.providerData=$.map(K=>({...K}))),g&&(te._redirectEventId=g),te}static async _fromIdTokenResponse(e,t,i=!1){const l=new $l;l.updateFromServerResponse(t);const u=new wa({uid:t.localId,auth:e,stsTokenManager:l,isAnonymous:i});return await Mh(u),u}static async _fromGetAccountInfoResponse(e,t,i){const l=t.users[0];Bt(l.localId!==void 0,"internal-error");const u=l.providerUserInfo!==void 0?bw(l.providerUserInfo):[],d=!(l.email&&l.passwordHash)&&!u?.length,p=new $l;p.updateFromIdToken(i);const g=new wa({uid:l.localId,auth:e,stsTokenManager:p,isAnonymous:d}),y={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:u,metadata:new mg(l.createdAt,l.lastLoginAt),isAnonymous:!(l.email&&l.passwordHash)&&!u?.length};return Object.assign(g,y),g}}const ex=new Map;function di(n){yi(n instanceof Function,"Expected a class definition");let e=ex.get(n);return e?(yi(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,ex.set(n,e),e)}class vw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}vw.type="NONE";const tx=vw;function bh(n,e,t){return`firebase:${n}:${e}:${t}`}class Wl{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:l,name:u}=this.auth;this.fullUserKey=bh(this.userKey,l.apiKey,u),this.fullPersistenceKey=bh("persistence",l.apiKey,u),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Ah(this.auth,{idToken:e}).catch(()=>{});return t?wa._fromGetAccountInfoResponse(this.auth,t,e):null}return wa._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Wl(di(tx),e,i);const l=(await Promise.all(t.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let u=l[0]||di(tx);const d=bh(i,e.config.apiKey,e.name);let p=null;for(const y of t)try{const x=await y._get(d);if(x){let j;if(typeof x=="string"){const T=await Ah(e,{idToken:x}).catch(()=>{});if(!T)break;j=await wa._fromGetAccountInfoResponse(e,T,x)}else j=wa._fromJSON(e,x);y!==u&&(p=j),u=y;break}}catch{}const g=l.filter(y=>y._shouldAllowMigration);return!u._shouldAllowMigration||!g.length?new Wl(u,e,i):(u=g[0],p&&await u._set(d,p.toJSON()),await Promise.all(t.map(async y=>{if(y!==u)try{await y._remove(d)}catch{}})),new Wl(u,e,i))}}function sx(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(kw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(xw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Tw(e))return"Blackberry";if(Ew(e))return"Webos";if(ww(e))return"Safari";if((e.includes("chrome/")||_w(e))&&!e.includes("edge/"))return"Chrome";if(jw(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function xw(n=vr()){return/firefox\//i.test(n)}function ww(n=vr()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function _w(n=vr()){return/crios\//i.test(n)}function kw(n=vr()){return/iemobile/i.test(n)}function jw(n=vr()){return/android/i.test(n)}function Tw(n=vr()){return/blackberry/i.test(n)}function Ew(n=vr()){return/webos/i.test(n)}function Zg(n=vr()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function gC(n=vr()){return Zg(n)&&!!window.navigator?.standalone}function yC(){return AS()&&document.documentMode===10}function Sw(n=vr()){return Zg(n)||jw(n)||Ew(n)||Tw(n)||/windows phone/i.test(n)||kw(n)}function Nw(n,e=[]){let t;switch(n){case"Browser":t=sx(vr());break;case"Worker":t=`${sx(vr())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Zo}/${i}`}class bC{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=u=>new Promise((d,p)=>{try{const g=e(u);d(g)}catch(g){p(g)}});i.onAbort=t,this.queue.push(i);const l=this.queue.length-1;return()=>{this.queue[l]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const l of t)try{l()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function vC(n,e={}){return wi(n,"GET","/v2/passwordPolicy",xi(n,e))}const xC=6;class wC{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??xC,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,l=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),l&&(t.meetsMaxPasswordLength=e.length<=l)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let l=0;l<e.length;l++)i=e.charAt(l),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,l,u){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=l)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=u))}}class _C{constructor(e,t,i,l){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=l,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new nx(this),this.idTokenSubscription=new nx(this),this.beforeStateQueue=new bC(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=mw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=l.sdkClientVersion,this._persistenceManagerAvailable=new Promise(u=>this._resolvePersistenceManagerAvailable=u)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=di(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Wl.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Ah(this,{idToken:e}),i=await wa._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Kr(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=this.redirectUser?._redirectEventId,d=i?._redirectEventId,p=await this.tryRedirectSignIn(e);(!u||u===d)&&p?.user&&(i=p.user,l=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Bt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Mh(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=eC()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Kr(this.app))return Promise.reject(mi(this));const t=e?Xs(e):null;return t&&Bt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Bt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Kr(this.app)?Promise.reject(mi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Kr(this.app)?Promise.reject(mi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(di(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await vC(this),t=new wC(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ru("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await pC(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&di(e)||this._popupRedirectResolver;Bt(t,this,"argument-error"),this.redirectPersistenceManager=await Wl.create(this,[di(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,l){if(this._deleted)return()=>{};const u=typeof t=="function"?t:t.next.bind(t);let d=!1;const p=this._isInitialized?Promise.resolve():this._initializationPromise;if(Bt(p,this,"internal-error"),p.then(()=>{d||u(this.currentUser)}),typeof t=="function"){const g=e.addObserver(t,i,l);return()=>{d=!0,g()}}else{const g=e.addObserver(t);return()=>{d=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Bt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Nw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Kr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&XN(`Error while retrieving App Check token: ${e.error}`),e?.token}}function go(n){return Xs(n)}class nx{constructor(e){this.auth=e,this.observer=null,this.addObserver=VS(t=>this.observer=t)}get next(){return Bt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let tm={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function kC(n){tm=n}function Cw(n){return tm.loadJS(n)}function jC(){return tm.recaptchaEnterpriseScript}function TC(){return tm.gapiScript}function EC(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class SC{constructor(){this.enterprise=new NC}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class NC{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const CC="recaptcha-enterprise",Rw="NO_RECAPTCHA";class RC{constructor(e){this.type=CC,this.auth=go(e)}async verify(e="verify",t=!1){async function i(u){if(!t){if(u.tenantId==null&&u._agentRecaptchaConfig!=null)return u._agentRecaptchaConfig.siteKey;if(u.tenantId!=null&&u._tenantRecaptchaConfigs[u.tenantId]!==void 0)return u._tenantRecaptchaConfigs[u.tenantId].siteKey}return new Promise(async(d,p)=>{oC(u,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)p(new Error("recaptcha Enterprise site key undefined"));else{const y=new iC(g);return u.tenantId==null?u._agentRecaptchaConfig=y:u._tenantRecaptchaConfigs[u.tenantId]=y,d(y.siteKey)}}).catch(g=>{p(g)})})}function l(u,d,p){const g=window.grecaptcha;J1(g)?g.enterprise.ready(()=>{g.enterprise.execute(u,{action:e}).then(y=>{d(y)}).catch(()=>{d(Rw)})}):p(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new SC().execute("siteKey",{action:"verify"}):new Promise((u,d)=>{i(this.auth).then(p=>{if(!t&&J1(window.grecaptcha))l(p,u,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let g=jC();g.length!==0&&(g+=p),Cw(g).then(()=>{l(p,u,d)}).catch(y=>{d(y)})}}).catch(p=>{d(p)})})}}async function rx(n,e,t,i=!1,l=!1){const u=new RC(n);let d;if(l)d=Rw;else try{d=await u.verify(t)}catch{d=await u.verify(t,!0)}const p={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in p){const g=p.phoneEnrollmentInfo.phoneNumber,y=p.phoneEnrollmentInfo.recaptchaToken;Object.assign(p,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:y,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in p){const g=p.phoneSignInInfo.recaptchaToken;Object.assign(p,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return p}return i?Object.assign(p,{captchaResp:d}):Object.assign(p,{captchaResponse:d}),Object.assign(p,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(p,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),p}async function Ih(n,e,t,i,l){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await rx(n,e,t,t==="getOobCode");return i(n,u)}else return i(n,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await rx(n,e,t,t==="getOobCode");return i(n,d)}else return Promise.reject(u)})}function AC(n,e){const t=em(n,"auth");if(t.isInitialized()){const l=t.getImmediate(),u=t.getOptions();if($o(u,e??{}))return l;ka(l,"already-initialized")}return t.initialize({options:e})}function MC(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(di);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function IC(n,e,t){const i=go(n);Bt(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const l=!1,u=Aw(e),{host:d,port:p}=DC(e),g=p===null?"":`:${p}`,y={url:`${u}//${d}${g}/`},x=Object.freeze({host:d,port:p,protocol:u.replace(":",""),options:Object.freeze({disableWarnings:l})});if(!i._canInitEmulator){Bt(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Bt($o(y,i.config.emulator)&&$o(x,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=y,i.emulatorConfig=x,i.settings.appVerificationDisabledForTesting=!0,po(d)?(Hg(`${u}//${d}${g}`),$g("Auth",!0)):PC()}function Aw(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function DC(n){const e=Aw(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",l=/^(\[[^\]]+\])(:|$)/.exec(i);if(l){const u=l[1];return{host:u,port:ax(i.substr(u.length+1))}}else{const[u,d]=i.split(":");return{host:u,port:ax(d)}}}function ax(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function PC(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class ey{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ui("not implemented")}_getIdTokenResponse(e){return ui("not implemented")}_linkToIdToken(e,t){return ui("not implemented")}_getReauthenticationResolver(e){return ui("not implemented")}}async function LC(n,e){return wi(n,"POST","/v1/accounts:signUp",e)}async function OC(n,e){return Iu(n,"POST","/v1/accounts:signInWithPassword",xi(n,e))}async function Mw(n,e){return wi(n,"POST","/v1/accounts:sendOobCode",xi(n,e))}async function BC(n,e){return Mw(n,e)}async function VC(n,e){return Mw(n,e)}async function UC(n,e){return Iu(n,"POST","/v1/accounts:signInWithEmailLink",xi(n,e))}async function FC(n,e){return Iu(n,"POST","/v1/accounts:signInWithEmailLink",xi(n,e))}class bu extends ey{constructor(e,t,i,l=null){super("password",i),this._email=e,this._password=t,this._tenantId=l}static _fromEmailAndPassword(e,t){return new bu(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new bu(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ih(e,t,"signInWithPassword",OC);case"emailLink":return UC(e,{email:this._email,oobCode:this._password});default:ka(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ih(e,i,"signUpPassword",LC);case"emailLink":return FC(e,{idToken:t,email:this._email,oobCode:this._password});default:ka(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Gl(n,e){return Iu(n,"POST","/v1/accounts:signInWithIdp",xi(n,e))}const zC="http://localhost";class Go extends ey{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Go(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ka("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:l,...u}=t;if(!i||!l)return null;const d=new Go(i,l);return d.idToken=u.idToken||void 0,d.accessToken=u.accessToken||void 0,d.secret=u.secret,d.nonce=u.nonce,d.pendingToken=u.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Gl(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Gl(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Gl(e,t)}buildRequest(){const e={requestUri:zC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Au(t)}return e}}function qC(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function HC(n){const e=su(nu(n)).link,t=e?su(nu(e)).deep_link_id:null,i=su(nu(n)).deep_link_id;return(i?su(nu(i)).link:null)||i||t||e||n}class ty{constructor(e){const t=su(nu(e)),i=t.apiKey??null,l=t.oobCode??null,u=qC(t.mode??null);Bt(i&&l&&u,"argument-error"),this.apiKey=i,this.operation=u,this.code=l,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=HC(e);try{return new ty(t)}catch{return null}}}class ac{constructor(){this.providerId=ac.PROVIDER_ID}static credential(e,t){return bu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=ty.parseLink(t);return Bt(i,"argument-error"),bu._fromEmailAndCode(e,i.code,i.tenantId)}}ac.PROVIDER_ID="password";ac.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ac.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Iw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Du extends Iw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Yi extends Du{constructor(){super("facebook.com")}static credential(e){return Go._fromParams({providerId:Yi.PROVIDER_ID,signInMethod:Yi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Yi.credentialFromTaggedObject(e)}static credentialFromError(e){return Yi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Yi.credential(e.oauthAccessToken)}catch{return null}}}Yi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Yi.PROVIDER_ID="facebook.com";class Qi extends Du{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Go._fromParams({providerId:Qi.PROVIDER_ID,signInMethod:Qi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Qi.credentialFromTaggedObject(e)}static credentialFromError(e){return Qi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Qi.credential(t,i)}catch{return null}}}Qi.GOOGLE_SIGN_IN_METHOD="google.com";Qi.PROVIDER_ID="google.com";class Xi extends Du{constructor(){super("github.com")}static credential(e){return Go._fromParams({providerId:Xi.PROVIDER_ID,signInMethod:Xi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Xi.credentialFromTaggedObject(e)}static credentialFromError(e){return Xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Xi.credential(e.oauthAccessToken)}catch{return null}}}Xi.GITHUB_SIGN_IN_METHOD="github.com";Xi.PROVIDER_ID="github.com";class Ji extends Du{constructor(){super("twitter.com")}static credential(e,t){return Go._fromParams({providerId:Ji.PROVIDER_ID,signInMethod:Ji.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ji.credentialFromTaggedObject(e)}static credentialFromError(e){return Ji.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Ji.credential(t,i)}catch{return null}}}Ji.TWITTER_SIGN_IN_METHOD="twitter.com";Ji.PROVIDER_ID="twitter.com";async function $C(n,e){return Iu(n,"POST","/v1/accounts:signUp",xi(n,e))}class Ko{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,l=!1){const u=await wa._fromIdTokenResponse(e,i,l),d=ix(i);return new Ko({user:u,providerId:d,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const l=ix(i);return new Ko({user:e,providerId:l,_tokenResponse:i,operationType:t})}}function ix(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Dh extends Wa{constructor(e,t,i,l){super(t.code,t.message),this.operationType=i,this.user=l,Object.setPrototypeOf(this,Dh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,l){return new Dh(e,t,i,l)}}function Dw(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(u=>{throw u.code==="auth/multi-factor-auth-required"?Dh._fromErrorAndOperation(n,u,e,i):u})}async function WC(n,e,t=!1){const i=await yu(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Ko._forOperation(n,"link",i)}async function GC(n,e,t=!1){const{auth:i}=n;if(Kr(i.app))return Promise.reject(mi(i));const l="reauthenticate";try{const u=await yu(n,Dw(i,l,e,n),t);Bt(u.idToken,i,"internal-error");const d=Jg(u.idToken);Bt(d,i,"internal-error");const{sub:p}=d;return Bt(n.uid===p,i,"user-mismatch"),Ko._forOperation(n,l,u)}catch(u){throw u?.code==="auth/user-not-found"&&ka(i,"user-mismatch"),u}}async function Pw(n,e,t=!1){if(Kr(n.app))return Promise.reject(mi(n));const i="signIn",l=await Dw(n,i,e),u=await Ko._fromIdTokenResponse(n,i,l);return t||await n._updateCurrentUser(u.user),u}async function KC(n,e){return Pw(go(n),e)}async function Lw(n){const e=go(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function YC(n,e,t){const i=go(n);await Ih(i,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",VC)}async function QC(n,e,t){if(Kr(n.app))return Promise.reject(mi(n));const i=go(n),d=await Ih(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",$C).catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&Lw(n),g}),p=await Ko._fromIdTokenResponse(i,"signIn",d);return await i._updateCurrentUser(p.user),p}function XC(n,e,t){return Kr(n.app)?Promise.reject(mi(n)):KC(Xs(n),ac.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&Lw(n),i})}async function FP(n,e){const t=Xs(n),l={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()},{email:u}=await BC(t.auth,l);u!==n.email&&await n.reload()}function ox(n,e){return Xs(n).setPersistence(e)}function JC(n,e,t,i){return Xs(n).onIdTokenChanged(e,t,i)}function ZC(n,e,t){return Xs(n).beforeAuthStateChanged(e,t)}function e4(n,e,t,i){return Xs(n).onAuthStateChanged(e,t,i)}function t4(n){return Xs(n).signOut()}const Ph="__sak";class Ow{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ph,"1"),this.storage.removeItem(Ph),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const s4=1e3,n4=10;class Bw extends Ow{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Sw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),l=this.localCache[t];i!==l&&e(t,l,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,p,g)=>{this.notifyListeners(d,g)});return}const i=e.key;t?this.detachListener():this.stopPolling();const l=()=>{const d=this.storage.getItem(i);!t&&this.localCache[i]===d||this.notifyListeners(i,d)},u=this.storage.getItem(i);yC()&&u!==e.newValue&&e.newValue!==e.oldValue?setTimeout(l,n4):l()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},s4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Bw.type="LOCAL";const fg=Bw;class Vw extends Ow{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Vw.type="SESSION";const sy=Vw;function r4(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class sm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(l=>l.isListeningto(e));if(t)return t;const i=new sm(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:l,data:u}=t.data,d=this.handlersMap[l];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:l});const p=Array.from(d).map(async y=>y(t.origin,u)),g=await r4(p);t.ports[0].postMessage({status:"done",eventId:i,eventType:l,response:g})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}sm.receivers=[];function ny(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class a4{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const l=typeof MessageChannel<"u"?new MessageChannel:null;if(!l)throw new Error("connection_unavailable");let u,d;return new Promise((p,g)=>{const y=ny("",20);l.port1.start();const x=setTimeout(()=>{g(new Error("unsupported_event"))},i);d={messageChannel:l,onMessage(j){const T=j;if(T.data.eventId===y)switch(T.data.status){case"ack":clearTimeout(x),u=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),p(T.data.response);break;default:clearTimeout(x),clearTimeout(u),g(new Error("invalid_response"));break}}},this.handlers.add(d),l.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:y,data:t},[l.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}function Ua(){return window}function i4(n){Ua().location.href=n}function Uw(){return typeof Ua().WorkerGlobalScope<"u"&&typeof Ua().importScripts=="function"}async function o4(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function l4(){return navigator?.serviceWorker?.controller||null}function c4(){return Uw()?self:null}const Fw="firebaseLocalStorageDb",u4=1,Lh="firebaseLocalStorage",zw="fbase_key";class Pu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function nm(n,e){return n.transaction([Lh],e?"readwrite":"readonly").objectStore(Lh)}function d4(){const n=indexedDB.deleteDatabase(Fw);return new Pu(n).toPromise()}function pg(){const n=indexedDB.open(Fw,u4);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Lh,{keyPath:zw})}catch(l){t(l)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Lh)?e(i):(i.close(),await d4(),e(await pg()))})})}async function lx(n,e,t){const i=nm(n,!0).put({[zw]:e,value:t});return new Pu(i).toPromise()}async function h4(n,e){const t=nm(n,!1).get(e),i=await new Pu(t).toPromise();return i===void 0?null:i.value}function cx(n,e){const t=nm(n,!0).delete(e);return new Pu(t).toPromise()}const m4=800,f4=3;class qw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await pg(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>f4)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Uw()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=sm._getInstance(c4()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await o4(),!this.activeServiceWorker)return;this.sender=new a4(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||l4()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await pg();return await lx(e,Ph,"1"),await cx(e,Ph),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>lx(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>h4(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>cx(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(l=>{const u=nm(l,!1).getAll();return new Pu(u).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:l,value:u}of e)i.add(l),JSON.stringify(this.localCache[l])!==JSON.stringify(u)&&(this.notifyListeners(l,u),t.push(l));for(const l of Object.keys(this.localCache))this.localCache[l]&&!i.has(l)&&(this.notifyListeners(l,null),t.push(l));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),m4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}qw.type="LOCAL";const p4=qw;new Mu(3e4,6e4);function g4(n,e){return e?di(e):(Bt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class ry extends ey{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Gl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Gl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Gl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function y4(n){return Pw(n.auth,new ry(n),n.bypassAuthState)}function b4(n){const{auth:e,user:t}=n;return Bt(t,e,"internal-error"),GC(t,new ry(n),n.bypassAuthState)}async function v4(n){const{auth:e,user:t}=n;return Bt(t,e,"internal-error"),WC(t,new ry(n),n.bypassAuthState)}class Hw{constructor(e,t,i,l,u=!1){this.auth=e,this.resolver=i,this.user=l,this.bypassAuthState=u,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:l,tenantId:u,error:d,type:p}=e;if(d){this.reject(d);return}const g={auth:this.auth,requestUri:t,sessionId:i,tenantId:u||void 0,postBody:l||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(p)(g))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return y4;case"linkViaPopup":case"linkViaRedirect":return v4;case"reauthViaPopup":case"reauthViaRedirect":return b4;default:ka(this.auth,"internal-error")}}resolve(e){yi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){yi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const x4=new Mu(2e3,1e4);class Hl extends Hw{constructor(e,t,i,l,u){super(e,t,l,u),this.provider=i,this.authWindow=null,this.pollId=null,Hl.currentPopupAction&&Hl.currentPopupAction.cancel(),Hl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Bt(e,this.auth,"internal-error"),e}async onExecution(){yi(this.filter.length===1,"Popup operations only handle one event");const e=ny();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Va(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Va(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Hl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Va(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,x4.get())};e()}}Hl.currentPopupAction=null;const w4="pendingRedirect",vh=new Map;class _4 extends Hw{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=vh.get(this.auth._key());if(!e){try{const i=await k4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}vh.set(this.auth._key(),e)}return this.bypassAuthState||vh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function k4(n,e){const t=E4(e),i=T4(n);if(!await i._isAvailable())return!1;const l=await i._get(t)==="true";return await i._remove(t),l}function j4(n,e){vh.set(n._key(),e)}function T4(n){return di(n._redirectPersistence)}function E4(n){return bh(w4,n.config.apiKey,n.name)}async function S4(n,e,t=!1){if(Kr(n.app))return Promise.reject(mi(n));const i=go(n),l=g4(i,e),d=await new _4(i,l,t).execute();return d&&!t&&(delete d.user._redirectEventId,await i._persistUserIfCurrent(d.user),await i._setRedirectUser(null,e)),d}const N4=600*1e3;class C4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!R4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!$w(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Va(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=N4&&this.cachedEventUids.clear(),this.cachedEventUids.has(ux(e))}saveEventToCache(e){this.cachedEventUids.add(ux(e)),this.lastProcessedEventTime=Date.now()}}function ux(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function $w({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function R4(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return $w(n);default:return!1}}async function A4(n,e={}){return wi(n,"GET","/v1/projects",e)}const M4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,I4=/^https?/;async function D4(n){if(n.config.emulator)return;const{authorizedDomains:e}=await A4(n);for(const t of e)try{if(P4(t))return}catch{}ka(n,"unauthorized-domain")}function P4(n){const e=hg(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===i}if(!I4.test(t))return!1;if(M4.test(n))return i===n;const l=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+l+"|"+l+")$","i").test(i)}const L4=new Mu(3e4,6e4);function dx(){const n=Ua().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function O4(n){return new Promise((e,t)=>{function i(){dx(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{dx(),t(Va(n,"network-request-failed"))},timeout:L4.get()})}if(Ua().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ua().gapi?.load)i();else{const l=EC("iframefcb");return Ua()[l]=()=>{gapi.load?i():t(Va(n,"network-request-failed"))},Cw(`${TC()}?onload=${l}`).catch(u=>t(u))}}).catch(e=>{throw xh=null,e})}let xh=null;function B4(n){return xh=xh||O4(n),xh}const V4=new Mu(5e3,15e3),U4="__/auth/iframe",F4="emulator/auth/iframe",z4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},q4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function H4(n){const e=n.config;Bt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Xg(e,F4):`https://${n.config.authDomain}/${U4}`,i={apiKey:e.apiKey,appName:n.name,v:Zo},l=q4.get(n.config.apiHost);l&&(i.eid=l);const u=n._getFrameworks();return u.length&&(i.fw=u.join(",")),`${t}?${Au(i).slice(1)}`}async function $4(n){const e=await B4(n),t=Ua().gapi;return Bt(t,n,"internal-error"),e.open({where:document.body,url:H4(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:z4,dontclear:!0},i=>new Promise(async(l,u)=>{await i.restyle({setHideOnLeave:!1});const d=Va(n,"network-request-failed"),p=Ua().setTimeout(()=>{u(d)},V4.get());function g(){Ua().clearTimeout(p),l(i)}i.ping(g).then(g,()=>{u(d)})}))}const W4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},G4=500,K4=600,Y4="_blank",Q4="http://localhost";class hx{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function X4(n,e,t,i=G4,l=K4){const u=Math.max((window.screen.availHeight-l)/2,0).toString(),d=Math.max((window.screen.availWidth-i)/2,0).toString();let p="";const g={...W4,width:i.toString(),height:l.toString(),top:u,left:d},y=vr().toLowerCase();t&&(p=_w(y)?Y4:t),xw(y)&&(e=e||Q4,g.scrollbars="yes");const x=Object.entries(g).reduce((T,[B,$])=>`${T}${B}=${$},`,"");if(gC(y)&&p!=="_self")return J4(e||"",p),new hx(null);const j=window.open(e||"",p,x);Bt(j,n,"popup-blocked");try{j.focus()}catch{}return new hx(j)}function J4(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const Z4="__/auth/handler",eR="emulator/auth/handler",tR=encodeURIComponent("fac");async function mx(n,e,t,i,l,u){Bt(n.config.authDomain,n,"auth-domain-config-required"),Bt(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Zo,eventId:l};if(e instanceof Iw){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",BS(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[x,j]of Object.entries({}))d[x]=j}if(e instanceof Du){const x=e.getScopes().filter(j=>j!=="");x.length>0&&(d.scopes=x.join(","))}n.tenantId&&(d.tid=n.tenantId);const p=d;for(const x of Object.keys(p))p[x]===void 0&&delete p[x];const g=await n._getAppCheckToken(),y=g?`#${tR}=${encodeURIComponent(g)}`:"";return`${sR(n)}?${Au(p).slice(1)}${y}`}function sR({config:n}){return n.emulator?Xg(n,eR):`https://${n.authDomain}/${Z4}`}const Ip="webStorageSupport";class nR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=sy,this._completeRedirectFn=S4,this._overrideRedirectResult=j4}async _openPopup(e,t,i,l){yi(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const u=await mx(e,t,i,hg(),l);return X4(e,u,ny())}async _openRedirect(e,t,i,l){await this._originValidation(e);const u=await mx(e,t,i,hg(),l);return i4(u),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:l,promise:u}=this.eventManagers[t];return l?Promise.resolve(l):(yi(u,"If manager is not set, promise should be"),u)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await $4(e),i=new C4(e);return t.register("authEvent",l=>(Bt(l?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(l.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ip,{type:Ip},l=>{const u=l?.[0]?.[Ip];u!==void 0&&t(!!u),ka(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=D4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Sw()||ww()||Zg()}}const rR=nR;var fx="@firebase/auth",px="1.12.0";class aR{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Bt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function iR(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function oR(n){Wo(new oo("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),l=e.getProvider("heartbeat"),u=e.getProvider("app-check-internal"),{apiKey:d,authDomain:p}=i.options;Bt(d&&!d.includes(":"),"invalid-api-key",{appName:i.name});const g={apiKey:d,authDomain:p,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Nw(n)},y=new _C(i,l,u,g);return MC(y,t),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),Wo(new oo("auth-internal",e=>{const t=go(e.getProvider("auth").getImmediate());return(i=>new aR(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ba(fx,px,iR(n)),Ba(fx,px,"esm2020")}const lR=300,cR=iw("authIdTokenMaxAge")||lR;let gx=null;const uR=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>cR)return;const l=t?.token;gx!==l&&(gx=l,await fetch(n,{method:l?"POST":"DELETE",headers:l?{Authorization:`Bearer ${l}`}:{}}))};function Ww(n=Yg()){const e=em(n,"auth");if(e.isInitialized())return e.getImmediate();const t=AC(n,{popupRedirectResolver:rR,persistence:[p4,fg,sy]}),i=iw("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const u=new URL(i,location.origin);if(location.origin===u.origin){const d=uR(u.toString());ZC(t,d,()=>d(t.currentUser)),JC(t,p=>d(p))}}const l=nw("auth");return l&&IC(t,`http://${l}`),t}function dR(){return document.getElementsByTagName("head")?.[0]??document}kC({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=l=>{const u=Va("internal-error");u.customData=l,t(u)},i.type="text/javascript",i.charset="UTF-8",dR().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});oR("Browser");var yx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ao,Gw;(function(){var n;function e(R,E){function M(){}M.prototype=E.prototype,R.F=E.prototype,R.prototype=new M,R.prototype.constructor=R,R.D=function(O,D,q){for(var I=Array(arguments.length-2),qe=2;qe<arguments.length;qe++)I[qe-2]=arguments[qe];return E.prototype[D].apply(O,I)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function l(R,E,M){M||(M=0);const O=Array(16);if(typeof E=="string")for(var D=0;D<16;++D)O[D]=E.charCodeAt(M++)|E.charCodeAt(M++)<<8|E.charCodeAt(M++)<<16|E.charCodeAt(M++)<<24;else for(D=0;D<16;++D)O[D]=E[M++]|E[M++]<<8|E[M++]<<16|E[M++]<<24;E=R.g[0],M=R.g[1],D=R.g[2];let q=R.g[3],I;I=E+(q^M&(D^q))+O[0]+3614090360&4294967295,E=M+(I<<7&4294967295|I>>>25),I=q+(D^E&(M^D))+O[1]+3905402710&4294967295,q=E+(I<<12&4294967295|I>>>20),I=D+(M^q&(E^M))+O[2]+606105819&4294967295,D=q+(I<<17&4294967295|I>>>15),I=M+(E^D&(q^E))+O[3]+3250441966&4294967295,M=D+(I<<22&4294967295|I>>>10),I=E+(q^M&(D^q))+O[4]+4118548399&4294967295,E=M+(I<<7&4294967295|I>>>25),I=q+(D^E&(M^D))+O[5]+1200080426&4294967295,q=E+(I<<12&4294967295|I>>>20),I=D+(M^q&(E^M))+O[6]+2821735955&4294967295,D=q+(I<<17&4294967295|I>>>15),I=M+(E^D&(q^E))+O[7]+4249261313&4294967295,M=D+(I<<22&4294967295|I>>>10),I=E+(q^M&(D^q))+O[8]+1770035416&4294967295,E=M+(I<<7&4294967295|I>>>25),I=q+(D^E&(M^D))+O[9]+2336552879&4294967295,q=E+(I<<12&4294967295|I>>>20),I=D+(M^q&(E^M))+O[10]+4294925233&4294967295,D=q+(I<<17&4294967295|I>>>15),I=M+(E^D&(q^E))+O[11]+2304563134&4294967295,M=D+(I<<22&4294967295|I>>>10),I=E+(q^M&(D^q))+O[12]+1804603682&4294967295,E=M+(I<<7&4294967295|I>>>25),I=q+(D^E&(M^D))+O[13]+4254626195&4294967295,q=E+(I<<12&4294967295|I>>>20),I=D+(M^q&(E^M))+O[14]+2792965006&4294967295,D=q+(I<<17&4294967295|I>>>15),I=M+(E^D&(q^E))+O[15]+1236535329&4294967295,M=D+(I<<22&4294967295|I>>>10),I=E+(D^q&(M^D))+O[1]+4129170786&4294967295,E=M+(I<<5&4294967295|I>>>27),I=q+(M^D&(E^M))+O[6]+3225465664&4294967295,q=E+(I<<9&4294967295|I>>>23),I=D+(E^M&(q^E))+O[11]+643717713&4294967295,D=q+(I<<14&4294967295|I>>>18),I=M+(q^E&(D^q))+O[0]+3921069994&4294967295,M=D+(I<<20&4294967295|I>>>12),I=E+(D^q&(M^D))+O[5]+3593408605&4294967295,E=M+(I<<5&4294967295|I>>>27),I=q+(M^D&(E^M))+O[10]+38016083&4294967295,q=E+(I<<9&4294967295|I>>>23),I=D+(E^M&(q^E))+O[15]+3634488961&4294967295,D=q+(I<<14&4294967295|I>>>18),I=M+(q^E&(D^q))+O[4]+3889429448&4294967295,M=D+(I<<20&4294967295|I>>>12),I=E+(D^q&(M^D))+O[9]+568446438&4294967295,E=M+(I<<5&4294967295|I>>>27),I=q+(M^D&(E^M))+O[14]+3275163606&4294967295,q=E+(I<<9&4294967295|I>>>23),I=D+(E^M&(q^E))+O[3]+4107603335&4294967295,D=q+(I<<14&4294967295|I>>>18),I=M+(q^E&(D^q))+O[8]+1163531501&4294967295,M=D+(I<<20&4294967295|I>>>12),I=E+(D^q&(M^D))+O[13]+2850285829&4294967295,E=M+(I<<5&4294967295|I>>>27),I=q+(M^D&(E^M))+O[2]+4243563512&4294967295,q=E+(I<<9&4294967295|I>>>23),I=D+(E^M&(q^E))+O[7]+1735328473&4294967295,D=q+(I<<14&4294967295|I>>>18),I=M+(q^E&(D^q))+O[12]+2368359562&4294967295,M=D+(I<<20&4294967295|I>>>12),I=E+(M^D^q)+O[5]+4294588738&4294967295,E=M+(I<<4&4294967295|I>>>28),I=q+(E^M^D)+O[8]+2272392833&4294967295,q=E+(I<<11&4294967295|I>>>21),I=D+(q^E^M)+O[11]+1839030562&4294967295,D=q+(I<<16&4294967295|I>>>16),I=M+(D^q^E)+O[14]+4259657740&4294967295,M=D+(I<<23&4294967295|I>>>9),I=E+(M^D^q)+O[1]+2763975236&4294967295,E=M+(I<<4&4294967295|I>>>28),I=q+(E^M^D)+O[4]+1272893353&4294967295,q=E+(I<<11&4294967295|I>>>21),I=D+(q^E^M)+O[7]+4139469664&4294967295,D=q+(I<<16&4294967295|I>>>16),I=M+(D^q^E)+O[10]+3200236656&4294967295,M=D+(I<<23&4294967295|I>>>9),I=E+(M^D^q)+O[13]+681279174&4294967295,E=M+(I<<4&4294967295|I>>>28),I=q+(E^M^D)+O[0]+3936430074&4294967295,q=E+(I<<11&4294967295|I>>>21),I=D+(q^E^M)+O[3]+3572445317&4294967295,D=q+(I<<16&4294967295|I>>>16),I=M+(D^q^E)+O[6]+76029189&4294967295,M=D+(I<<23&4294967295|I>>>9),I=E+(M^D^q)+O[9]+3654602809&4294967295,E=M+(I<<4&4294967295|I>>>28),I=q+(E^M^D)+O[12]+3873151461&4294967295,q=E+(I<<11&4294967295|I>>>21),I=D+(q^E^M)+O[15]+530742520&4294967295,D=q+(I<<16&4294967295|I>>>16),I=M+(D^q^E)+O[2]+3299628645&4294967295,M=D+(I<<23&4294967295|I>>>9),I=E+(D^(M|~q))+O[0]+4096336452&4294967295,E=M+(I<<6&4294967295|I>>>26),I=q+(M^(E|~D))+O[7]+1126891415&4294967295,q=E+(I<<10&4294967295|I>>>22),I=D+(E^(q|~M))+O[14]+2878612391&4294967295,D=q+(I<<15&4294967295|I>>>17),I=M+(q^(D|~E))+O[5]+4237533241&4294967295,M=D+(I<<21&4294967295|I>>>11),I=E+(D^(M|~q))+O[12]+1700485571&4294967295,E=M+(I<<6&4294967295|I>>>26),I=q+(M^(E|~D))+O[3]+2399980690&4294967295,q=E+(I<<10&4294967295|I>>>22),I=D+(E^(q|~M))+O[10]+4293915773&4294967295,D=q+(I<<15&4294967295|I>>>17),I=M+(q^(D|~E))+O[1]+2240044497&4294967295,M=D+(I<<21&4294967295|I>>>11),I=E+(D^(M|~q))+O[8]+1873313359&4294967295,E=M+(I<<6&4294967295|I>>>26),I=q+(M^(E|~D))+O[15]+4264355552&4294967295,q=E+(I<<10&4294967295|I>>>22),I=D+(E^(q|~M))+O[6]+2734768916&4294967295,D=q+(I<<15&4294967295|I>>>17),I=M+(q^(D|~E))+O[13]+1309151649&4294967295,M=D+(I<<21&4294967295|I>>>11),I=E+(D^(M|~q))+O[4]+4149444226&4294967295,E=M+(I<<6&4294967295|I>>>26),I=q+(M^(E|~D))+O[11]+3174756917&4294967295,q=E+(I<<10&4294967295|I>>>22),I=D+(E^(q|~M))+O[2]+718787259&4294967295,D=q+(I<<15&4294967295|I>>>17),I=M+(q^(D|~E))+O[9]+3951481745&4294967295,R.g[0]=R.g[0]+E&4294967295,R.g[1]=R.g[1]+(D+(I<<21&4294967295|I>>>11))&4294967295,R.g[2]=R.g[2]+D&4294967295,R.g[3]=R.g[3]+q&4294967295}i.prototype.v=function(R,E){E===void 0&&(E=R.length);const M=E-this.blockSize,O=this.C;let D=this.h,q=0;for(;q<E;){if(D==0)for(;q<=M;)l(this,R,q),q+=this.blockSize;if(typeof R=="string"){for(;q<E;)if(O[D++]=R.charCodeAt(q++),D==this.blockSize){l(this,O),D=0;break}}else for(;q<E;)if(O[D++]=R[q++],D==this.blockSize){l(this,O),D=0;break}}this.h=D,this.o+=E},i.prototype.A=function(){var R=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);R[0]=128;for(var E=1;E<R.length-8;++E)R[E]=0;E=this.o*8;for(var M=R.length-8;M<R.length;++M)R[M]=E&255,E/=256;for(this.v(R),R=Array(16),E=0,M=0;M<4;++M)for(let O=0;O<32;O+=8)R[E++]=this.g[M]>>>O&255;return R};function u(R,E){var M=p;return Object.prototype.hasOwnProperty.call(M,R)?M[R]:M[R]=E(R)}function d(R,E){this.h=E;const M=[];let O=!0;for(let D=R.length-1;D>=0;D--){const q=R[D]|0;O&&q==E||(M[D]=q,O=!1)}this.g=M}var p={};function g(R){return-128<=R&&R<128?u(R,function(E){return new d([E|0],E<0?-1:0)}):new d([R|0],R<0?-1:0)}function y(R){if(isNaN(R)||!isFinite(R))return j;if(R<0)return V(y(-R));const E=[];let M=1;for(let O=0;R>=M;O++)E[O]=R/M|0,M*=4294967296;return new d(E,0)}function x(R,E){if(R.length==0)throw Error("number format error: empty string");if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(R.charAt(0)=="-")return V(x(R.substring(1),E));if(R.indexOf("-")>=0)throw Error('number format error: interior "-" character');const M=y(Math.pow(E,8));let O=j;for(let q=0;q<R.length;q+=8){var D=Math.min(8,R.length-q);const I=parseInt(R.substring(q,q+D),E);D<8?(D=y(Math.pow(E,D)),O=O.j(D).add(y(I))):(O=O.j(M),O=O.add(y(I)))}return O}var j=g(0),T=g(1),B=g(16777216);n=d.prototype,n.m=function(){if(F(this))return-V(this).m();let R=0,E=1;for(let M=0;M<this.g.length;M++){const O=this.i(M);R+=(O>=0?O:4294967296+O)*E,E*=4294967296}return R},n.toString=function(R){if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if($(this))return"0";if(F(this))return"-"+V(this).toString(R);const E=y(Math.pow(R,6));var M=this;let O="";for(;;){const D=ye(M,E).g;M=te(M,D.j(E));let q=((M.g.length>0?M.g[0]:M.h)>>>0).toString(R);if(M=D,$(M))return q+O;for(;q.length<6;)q="0"+q;O=q+O}},n.i=function(R){return R<0?0:R<this.g.length?this.g[R]:this.h};function $(R){if(R.h!=0)return!1;for(let E=0;E<R.g.length;E++)if(R.g[E]!=0)return!1;return!0}function F(R){return R.h==-1}n.l=function(R){return R=te(this,R),F(R)?-1:$(R)?0:1};function V(R){const E=R.g.length,M=[];for(let O=0;O<E;O++)M[O]=~R.g[O];return new d(M,~R.h).add(T)}n.abs=function(){return F(this)?V(this):this},n.add=function(R){const E=Math.max(this.g.length,R.g.length),M=[];let O=0;for(let D=0;D<=E;D++){let q=O+(this.i(D)&65535)+(R.i(D)&65535),I=(q>>>16)+(this.i(D)>>>16)+(R.i(D)>>>16);O=I>>>16,q&=65535,I&=65535,M[D]=I<<16|q}return new d(M,M[M.length-1]&-2147483648?-1:0)};function te(R,E){return R.add(V(E))}n.j=function(R){if($(this)||$(R))return j;if(F(this))return F(R)?V(this).j(V(R)):V(V(this).j(R));if(F(R))return V(this.j(V(R)));if(this.l(B)<0&&R.l(B)<0)return y(this.m()*R.m());const E=this.g.length+R.g.length,M=[];for(var O=0;O<2*E;O++)M[O]=0;for(O=0;O<this.g.length;O++)for(let D=0;D<R.g.length;D++){const q=this.i(O)>>>16,I=this.i(O)&65535,qe=R.i(D)>>>16,ft=R.i(D)&65535;M[2*O+2*D]+=I*ft,K(M,2*O+2*D),M[2*O+2*D+1]+=q*ft,K(M,2*O+2*D+1),M[2*O+2*D+1]+=I*qe,K(M,2*O+2*D+1),M[2*O+2*D+2]+=q*qe,K(M,2*O+2*D+2)}for(R=0;R<E;R++)M[R]=M[2*R+1]<<16|M[2*R];for(R=E;R<2*E;R++)M[R]=0;return new d(M,0)};function K(R,E){for(;(R[E]&65535)!=R[E];)R[E+1]+=R[E]>>>16,R[E]&=65535,E++}function ae(R,E){this.g=R,this.h=E}function ye(R,E){if($(E))throw Error("division by zero");if($(R))return new ae(j,j);if(F(R))return E=ye(V(R),E),new ae(V(E.g),V(E.h));if(F(E))return E=ye(R,V(E)),new ae(V(E.g),E.h);if(R.g.length>30){if(F(R)||F(E))throw Error("slowDivide_ only works with positive integers.");for(var M=T,O=E;O.l(R)<=0;)M=Ae(M),O=Ae(O);var D=me(M,1),q=me(O,1);for(O=me(O,2),M=me(M,2);!$(O);){var I=q.add(O);I.l(R)<=0&&(D=D.add(M),q=I),O=me(O,1),M=me(M,1)}return E=te(R,D.j(E)),new ae(D,E)}for(D=j;R.l(E)>=0;){for(M=Math.max(1,Math.floor(R.m()/E.m())),O=Math.ceil(Math.log(M)/Math.LN2),O=O<=48?1:Math.pow(2,O-48),q=y(M),I=q.j(E);F(I)||I.l(R)>0;)M-=O,q=y(M),I=q.j(E);$(q)&&(q=T),D=D.add(q),R=te(R,I)}return new ae(D,R)}n.B=function(R){return ye(this,R).h},n.and=function(R){const E=Math.max(this.g.length,R.g.length),M=[];for(let O=0;O<E;O++)M[O]=this.i(O)&R.i(O);return new d(M,this.h&R.h)},n.or=function(R){const E=Math.max(this.g.length,R.g.length),M=[];for(let O=0;O<E;O++)M[O]=this.i(O)|R.i(O);return new d(M,this.h|R.h)},n.xor=function(R){const E=Math.max(this.g.length,R.g.length),M=[];for(let O=0;O<E;O++)M[O]=this.i(O)^R.i(O);return new d(M,this.h^R.h)};function Ae(R){const E=R.g.length+1,M=[];for(let O=0;O<E;O++)M[O]=R.i(O)<<1|R.i(O-1)>>>31;return new d(M,R.h)}function me(R,E){const M=E>>5;E%=32;const O=R.g.length-M,D=[];for(let q=0;q<O;q++)D[q]=E>0?R.i(q+M)>>>E|R.i(q+M+1)<<32-E:R.i(q+M);return new d(D,R.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,Gw=i,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.B,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=y,d.fromString=x,ao=d}).apply(typeof yx<"u"?yx:typeof self<"u"?self:typeof window<"u"?window:{});var sh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Kw,ru,Yw,wh,gg,Qw,Xw,Jw;(function(){var n,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof sh=="object"&&sh];for(var b=0;b<h.length;++b){var _=h[b];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var i=t(this);function l(h,b){if(b)e:{var _=i;h=h.split(".");for(var A=0;A<h.length-1;A++){var ie=h[A];if(!(ie in _))break e;_=_[ie]}h=h[h.length-1],A=_[h],b=b(A),b!=A&&b!=null&&e(_,h,{configurable:!0,writable:!0,value:b})}}l("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),l("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),l("Object.entries",function(h){return h||function(b){var _=[],A;for(A in b)Object.prototype.hasOwnProperty.call(b,A)&&_.push([A,b[A]]);return _}});var u=u||{},d=this||self;function p(h){var b=typeof h;return b=="object"&&h!=null||b=="function"}function g(h,b,_){return h.call.apply(h.bind,arguments)}function y(h,b,_){return y=g,y.apply(null,arguments)}function x(h,b){var _=Array.prototype.slice.call(arguments,1);return function(){var A=_.slice();return A.push.apply(A,arguments),h.apply(this,A)}}function j(h,b){function _(){}_.prototype=b.prototype,h.Z=b.prototype,h.prototype=new _,h.prototype.constructor=h,h.Ob=function(A,ie,ge){for(var Ke=Array(arguments.length-2),ns=2;ns<arguments.length;ns++)Ke[ns-2]=arguments[ns];return b.prototype[ie].apply(A,Ke)}}var T=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function B(h){const b=h.length;if(b>0){const _=Array(b);for(let A=0;A<b;A++)_[A]=h[A];return _}return[]}function $(h,b){for(let A=1;A<arguments.length;A++){const ie=arguments[A];var _=typeof ie;if(_=_!="object"?_:ie?Array.isArray(ie)?"array":_:"null",_=="array"||_=="object"&&typeof ie.length=="number"){_=h.length||0;const ge=ie.length||0;h.length=_+ge;for(let Ke=0;Ke<ge;Ke++)h[_+Ke]=ie[Ke]}else h.push(ie)}}class F{constructor(b,_){this.i=b,this.j=_,this.h=0,this.g=null}get(){let b;return this.h>0?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function V(h){d.setTimeout(()=>{throw h},0)}function te(){var h=R;let b=null;return h.g&&(b=h.g,h.g=h.g.next,h.g||(h.h=null),b.next=null),b}class K{constructor(){this.h=this.g=null}add(b,_){const A=ae.get();A.set(b,_),this.h?this.h.next=A:this.g=A,this.h=A}}var ae=new F(()=>new ye,h=>h.reset());class ye{constructor(){this.next=this.g=this.h=null}set(b,_){this.h=b,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let Ae,me=!1,R=new K,E=()=>{const h=Promise.resolve(void 0);Ae=()=>{h.then(M)}};function M(){for(var h;h=te();){try{h.h.call(h.g)}catch(_){V(_)}var b=ae;b.j(h),b.h<100&&(b.h++,h.next=b.g,b.g=h)}me=!1}function O(){this.u=this.u,this.C=this.C}O.prototype.u=!1,O.prototype.dispose=function(){this.u||(this.u=!0,this.N())},O.prototype[Symbol.dispose]=function(){this.dispose()},O.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(h,b){this.type=h,this.g=this.target=b,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var q=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var h=!1,b=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const _=()=>{};d.addEventListener("test",_,b),d.removeEventListener("test",_,b)}catch{}return h})();function I(h){return/^[\s\xa0]*$/.test(h)}function qe(h,b){D.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,b)}j(qe,D),qe.prototype.init=function(h,b){const _=this.type=h.type,A=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=b,b=h.relatedTarget,b||(_=="mouseover"?b=h.fromElement:_=="mouseout"&&(b=h.toElement)),this.relatedTarget=b,A?(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&qe.Z.h.call(this)},qe.prototype.h=function(){qe.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var ft="closure_listenable_"+(Math.random()*1e6|0),W=0;function de(h,b,_,A,ie){this.listener=h,this.proxy=null,this.src=b,this.type=_,this.capture=!!A,this.ha=ie,this.key=++W,this.da=this.fa=!1}function Ie(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Ve(h,b,_){for(const A in h)b.call(_,h[A],A,h)}function ee(h,b){for(const _ in h)b.call(void 0,h[_],_,h)}function L(h){const b={};for(const _ in h)b[_]=h[_];return b}const se="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function De(h,b){let _,A;for(let ie=1;ie<arguments.length;ie++){A=arguments[ie];for(_ in A)h[_]=A[_];for(let ge=0;ge<se.length;ge++)_=se[ge],Object.prototype.hasOwnProperty.call(A,_)&&(h[_]=A[_])}}function ue(h){this.src=h,this.g={},this.h=0}ue.prototype.add=function(h,b,_,A,ie){const ge=h.toString();h=this.g[ge],h||(h=this.g[ge]=[],this.h++);const Ke=Le(h,b,A,ie);return Ke>-1?(b=h[Ke],_||(b.fa=!1)):(b=new de(b,this.src,ge,!!A,ie),b.fa=_,h.push(b)),b};function ze(h,b){const _=b.type;if(_ in h.g){var A=h.g[_],ie=Array.prototype.indexOf.call(A,b,void 0),ge;(ge=ie>=0)&&Array.prototype.splice.call(A,ie,1),ge&&(Ie(b),h.g[_].length==0&&(delete h.g[_],h.h--))}}function Le(h,b,_,A){for(let ie=0;ie<h.length;++ie){const ge=h[ie];if(!ge.da&&ge.listener==b&&ge.capture==!!_&&ge.ha==A)return ie}return-1}var it="closure_lm_"+(Math.random()*1e6|0),pt={};function Ye(h,b,_,A,ie){if(Array.isArray(b)){for(let ge=0;ge<b.length;ge++)Ye(h,b[ge],_,A,ie);return null}return _=vt(_),h&&h[ft]?h.J(b,_,p(A)?!!A.capture:!1,ie):Ht(h,b,_,!1,A,ie)}function Ht(h,b,_,A,ie,ge){if(!b)throw Error("Invalid event type");const Ke=p(ie)?!!ie.capture:!!ie;let ns=Pt(h);if(ns||(h[it]=ns=new ue(h)),_=ns.add(b,_,A,Ke,ge),_.proxy)return _;if(A=Ms(),_.proxy=A,A.src=h,A.listener=_,h.addEventListener)q||(ie=Ke),ie===void 0&&(ie=!1),h.addEventListener(b.toString(),A,ie);else if(h.attachEvent)h.attachEvent(ne(b.toString()),A);else if(h.addListener&&h.removeListener)h.addListener(A);else throw Error("addEventListener and attachEvent are unavailable.");return _}function Ms(){function h(_){return b.call(h.src,h.listener,_)}const b=Rt;return h}function dt(h,b,_,A,ie){if(Array.isArray(b))for(var ge=0;ge<b.length;ge++)dt(h,b[ge],_,A,ie);else A=p(A)?!!A.capture:!!A,_=vt(_),h&&h[ft]?(h=h.i,ge=String(b).toString(),ge in h.g&&(b=h.g[ge],_=Le(b,_,A,ie),_>-1&&(Ie(b[_]),Array.prototype.splice.call(b,_,1),b.length==0&&(delete h.g[ge],h.h--)))):h&&(h=Pt(h))&&(b=h.g[b.toString()],h=-1,b&&(h=Le(b,_,A,ie)),(_=h>-1?b[h]:null)&&mt(_))}function mt(h){if(typeof h!="number"&&h&&!h.da){var b=h.src;if(b&&b[ft])ze(b.i,h);else{var _=h.type,A=h.proxy;b.removeEventListener?b.removeEventListener(_,A,h.capture):b.detachEvent?b.detachEvent(ne(_),A):b.addListener&&b.removeListener&&b.removeListener(A),(_=Pt(b))?(ze(_,h),_.h==0&&(_.src=null,b[it]=null)):Ie(h)}}}function ne(h){return h in pt?pt[h]:pt[h]="on"+h}function Rt(h,b){if(h.da)h=!0;else{b=new qe(b,this);const _=h.listener,A=h.ha||h.src;h.fa&&mt(h),h=_.call(A,b)}return h}function Pt(h){return h=h[it],h instanceof ue?h:null}var At="__closure_events_fn_"+(Math.random()*1e9>>>0);function vt(h){return typeof h=="function"?h:(h[At]||(h[At]=function(b){return h.handleEvent(b)}),h[At])}function nt(){O.call(this),this.i=new ue(this),this.M=this,this.G=null}j(nt,O),nt.prototype[ft]=!0,nt.prototype.removeEventListener=function(h,b,_,A){dt(this,h,b,_,A)};function $e(h,b){var _,A=h.G;if(A)for(_=[];A;A=A.G)_.push(A);if(h=h.M,A=b.type||b,typeof b=="string")b=new D(b,h);else if(b instanceof D)b.target=b.target||h;else{var ie=b;b=new D(A,h),De(b,ie)}ie=!0;let ge,Ke;if(_)for(Ke=_.length-1;Ke>=0;Ke--)ge=b.g=_[Ke],ie=$t(ge,A,!0,b)&&ie;if(ge=b.g=h,ie=$t(ge,A,!0,b)&&ie,ie=$t(ge,A,!1,b)&&ie,_)for(Ke=0;Ke<_.length;Ke++)ge=b.g=_[Ke],ie=$t(ge,A,!1,b)&&ie}nt.prototype.N=function(){if(nt.Z.N.call(this),this.i){var h=this.i;for(const b in h.g){const _=h.g[b];for(let A=0;A<_.length;A++)Ie(_[A]);delete h.g[b],h.h--}}this.G=null},nt.prototype.J=function(h,b,_,A){return this.i.add(String(h),b,!1,_,A)},nt.prototype.K=function(h,b,_,A){return this.i.add(String(h),b,!0,_,A)};function $t(h,b,_,A){if(b=h.i.g[String(b)],!b)return!0;b=b.concat();let ie=!0;for(let ge=0;ge<b.length;++ge){const Ke=b[ge];if(Ke&&!Ke.da&&Ke.capture==_){const ns=Ke.listener,Cn=Ke.ha||Ke.src;Ke.fa&&ze(h.i,Ke),ie=ns.call(Cn,A)!==!1&&ie}}return ie&&!A.defaultPrevented}function Ns(h,b){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=y(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(b)>2147483647?-1:d.setTimeout(h,b||0)}function Ws(h){h.g=Ns(()=>{h.g=null,h.i&&(h.i=!1,Ws(h))},h.l);const b=h.h;h.h=null,h.m.apply(null,b)}class Ut extends O{constructor(b,_){super(),this.m=b,this.l=_,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:Ws(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function St(h){O.call(this),this.h=h,this.g={}}j(St,O);var is=[];function Is(h){Ve(h.g,function(b,_){this.g.hasOwnProperty(_)&&mt(b)},h),h.g={}}St.prototype.N=function(){St.Z.N.call(this),Is(this)},St.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var zt=d.JSON.stringify,Js=d.JSON.parse,Lt=class{stringify(h){return d.JSON.stringify(h,void 0)}parse(h){return d.JSON.parse(h,void 0)}};function ps(){}function Wt(){}var we={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function G(){D.call(this,"d")}j(G,D);function he(){D.call(this,"c")}j(he,D);var Ee={},Oe=null;function ke(){return Oe=Oe||new nt}Ee.Ia="serverreachability";function Qe(h){D.call(this,Ee.Ia,h)}j(Qe,D);function ot(h){const b=ke();$e(b,new Qe(b))}Ee.STAT_EVENT="statevent";function Y(h,b){D.call(this,Ee.STAT_EVENT,h),this.stat=b}j(Y,D);function re(h){const b=ke();$e(b,new Y(b,h))}Ee.Ja="timingevent";function We(h,b){D.call(this,Ee.Ja,h),this.size=b}j(We,D);function Ge(h,b){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){h()},b)}function rt(){this.g=!0}rt.prototype.ua=function(){this.g=!1};function bt(h,b,_,A,ie,ge){h.info(function(){if(h.g)if(ge){var Ke="",ns=ge.split("&");for(let Bs=0;Bs<ns.length;Bs++){var Cn=ns[Bs].split("=");if(Cn.length>1){const cn=Cn[0];Cn=Cn[1];const Jr=cn.split("_");Ke=Jr.length>=2&&Jr[1]=="type"?Ke+(cn+"="+Cn+"&"):Ke+(cn+"=redacted&")}}}else Ke=null;else Ke=ge;return"XMLHTTP REQ ("+A+") [attempt "+ie+"]: "+b+`
`+_+`
`+Ke})}function jt(h,b,_,A,ie,ge,Ke){h.info(function(){return"XMLHTTP RESP ("+A+") [ attempt "+ie+"]: "+b+`
`+_+`
`+ge+" "+Ke})}function gt(h,b,_,A){h.info(function(){return"XMLHTTP TEXT ("+b+"): "+Gs(h,_)+(A?" "+A:"")})}function Gt(h,b){h.info(function(){return"TIMEOUT: "+b})}rt.prototype.info=function(){};function Gs(h,b){if(!h.g)return b;if(!b)return null;try{const ge=JSON.parse(b);if(ge){for(h=0;h<ge.length;h++)if(Array.isArray(ge[h])){var _=ge[h];if(!(_.length<2)){var A=_[1];if(Array.isArray(A)&&!(A.length<1)){var ie=A[0];if(ie!="noop"&&ie!="stop"&&ie!="close")for(let Ke=1;Ke<A.length;Ke++)A[Ke]=""}}}}return zt(ge)}catch{return b}}var os={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ks={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Us;function H(){}j(H,ps),H.prototype.g=function(){return new XMLHttpRequest},Us=new H;function _e(h){return encodeURIComponent(String(h))}function Ne(h){var b=1;h=h.split(":");const _=[];for(;b>0&&h.length;)_.push(h.shift()),b--;return h.length&&_.push(h.join(":")),_}function Se(h,b,_,A){this.j=h,this.i=b,this.l=_,this.S=A||1,this.V=new St(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new je}function je(){this.i=null,this.g="",this.h=!1}var ct={},xt={};function Ze(h,b,_){h.M=1,h.A=Xr(cs(b)),h.u=_,h.R=!0,kt(h,null)}function kt(h,b){h.F=Date.now(),gn(h),h.B=cs(h.A);var _=h.B,A=h.S;Array.isArray(A)||(A=[String(A)]),bn(_.i,"t",A),h.C=0,_=h.j.L,h.h=new je,h.g=Gu(h.j,_?b:null,!h.u),h.P>0&&(h.O=new Ut(y(h.Y,h,h.g),h.P)),b=h.V,_=h.g,A=h.ba;var ie="readystatechange";Array.isArray(ie)||(ie&&(is[0]=ie.toString()),ie=is);for(let ge=0;ge<ie.length;ge++){const Ke=Ye(_,ie[ge],A||b.handleEvent,!1,b.h||b);if(!Ke)break;b.g[Ke.key]=Ke}b=h.J?L(h.J):{},h.u?(h.v||(h.v="POST"),b["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,b)):(h.v="GET",h.g.ea(h.B,h.v,null,b)),ot(),bt(h.i,h.v,h.B,h.l,h.S,h.u)}Se.prototype.ba=function(h){h=h.target;const b=this.O;b&&ls(h)==3?b.j():this.Y(h)},Se.prototype.Y=function(h){try{if(h==this.g)e:{const ns=ls(this.g),Cn=this.g.ya(),Bs=this.g.ca();if(!(ns<3)&&(ns!=3||this.g&&(this.h.h||this.g.la()||Qt(this.g)))){this.K||ns!=4||Cn==7||(Cn==8||Bs<=0?ot(3):ot(2)),In(this);var b=this.g.ca();this.X=b;var _=Et(this);if(this.o=b==200,jt(this.i,this.v,this.B,this.l,this.S,ns,b),this.o){if(this.U&&!this.L){t:{if(this.g){var A,ie=this.g;if((A=ie.g?ie.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!I(A)){var ge=A;break t}}ge=null}if(h=ge)gt(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,k(this,h);else{this.o=!1,this.m=3,re(12),zs(this),yn(this);break e}}if(this.R){h=!0;let cn;for(;!this.K&&this.C<_.length;)if(cn=hn(this,_),cn==xt){ns==4&&(this.m=4,re(14),h=!1),gt(this.i,this.l,null,"[Incomplete Response]");break}else if(cn==ct){this.m=4,re(15),gt(this.i,this.l,_,"[Invalid Chunk]"),h=!1;break}else gt(this.i,this.l,cn,null),k(this,cn);if(Cs(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ns!=4||_.length!=0||this.h.h||(this.m=1,re(16),h=!1),this.o=this.o&&h,!h)gt(this.i,this.l,_,"[Invalid Chunked Response]"),zs(this),yn(this);else if(_.length>0&&!this.W){this.W=!0;var Ke=this.j;Ke.g==this&&Ke.aa&&!Ke.P&&(Ke.j.info("Great, no buffering proxy detected. Bytes received: "+_.length),_r(Ke),Ke.P=!0,re(11))}}else gt(this.i,this.l,_,null),k(this,_);ns==4&&zs(this),this.o&&!this.K&&(ns==4?sl(this.j,this):(this.o=!1,gn(this)))}else ws(this.g),b==400&&_.indexOf("Unknown SID")>0?(this.m=3,re(12)):(this.m=0,re(13)),zs(this),yn(this)}}}catch{}};function Et(h){if(!Cs(h))return h.g.la();const b=Qt(h.g);if(b==="")return"";let _="";const A=b.length,ie=ls(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return zs(h),yn(h),"";h.h.i=new d.TextDecoder}for(let ge=0;ge<A;ge++)h.h.h=!0,_+=h.h.i.decode(b[ge],{stream:!(ie&&ge==A-1)});return b.length=0,h.h.g+=_,h.C=0,h.h.g}function Cs(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function hn(h,b){var _=h.C,A=b.indexOf(`
`,_);return A==-1?xt:(_=Number(b.substring(_,A)),isNaN(_)?ct:(A+=1,A+_>b.length?xt:(b=b.slice(A,A+_),h.C=A+_,b)))}Se.prototype.cancel=function(){this.K=!0,zs(this)};function gn(h){h.T=Date.now()+h.H,Tn(h,h.H)}function Tn(h,b){if(h.D!=null)throw Error("WatchDog timer not null");h.D=Ge(y(h.aa,h),b)}function In(h){h.D&&(d.clearTimeout(h.D),h.D=null)}Se.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(Gt(this.i,this.B),this.M!=2&&(ot(),re(17)),zs(this),this.m=2,yn(this)):Tn(this,this.T-h)};function yn(h){h.j.I==0||h.K||sl(h.j,h)}function zs(h){In(h);var b=h.O;b&&typeof b.dispose=="function"&&b.dispose(),h.O=null,Is(h.V),h.g&&(b=h.g,h.g=null,b.abort(),b.dispose())}function k(h,b){try{var _=h.j;if(_.I!=0&&(_.g==h||Ue(_.h,h))){if(!h.L&&Ue(_.h,h)&&_.I==3){try{var A=_.Ba.g.parse(b)}catch{A=null}if(Array.isArray(A)&&A.length==3){var ie=A;if(ie[0]==0){e:if(!_.v){if(_.g)if(_.g.F+3e3<h.F)Ga(_),tn(_);else break e;vn(_),re(18)}}else _.xa=ie[1],0<_.xa-_.K&&ie[2]<37500&&_.F&&_.A==0&&!_.C&&(_.C=Ge(y(_.Va,_),6e3));fe(_.h)<=1&&_.ta&&(_.ta=void 0)}else kr(_,11)}else if((h.L||_.g==h)&&Ga(_),!I(b))for(ie=_.Ba.g.parse(b),b=0;b<ie.length;b++){let Bs=ie[b];const cn=Bs[0];if(!(cn<=_.K))if(_.K=cn,Bs=Bs[1],_.I==2)if(Bs[0]=="c"){_.M=Bs[1],_.ba=Bs[2];const Jr=Bs[3];Jr!=null&&(_.ka=Jr,_.j.info("VER="+_.ka));const Ca=Bs[4];Ca!=null&&(_.za=Ca,_.j.info("SVER="+_.za));const ma=Bs[5];ma!=null&&typeof ma=="number"&&ma>0&&(A=1.5*ma,_.O=A,_.j.info("backChannelRequestTimeoutMs_="+A)),A=_;const fa=h.g;if(fa){const vo=fa.g?fa.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(vo){var ge=A.h;ge.g||vo.indexOf("spdy")==-1&&vo.indexOf("quic")==-1&&vo.indexOf("h2")==-1||(ge.j=ge.l,ge.g=new Set,ge.h&&(Fe(ge,ge.h),ge.h=null))}if(A.G){const rl=fa.g?fa.g.getResponseHeader("X-HTTP-Session-Id"):null;rl&&(A.wa=rl,ds(A.J,A.G,rl))}}_.I=3,_.l&&_.l.ra(),_.aa&&(_.T=Date.now()-h.F,_.j.info("Handshake RTT: "+_.T+"ms")),A=_;var Ke=h;if(A.na=ha(A,A.L?A.ba:null,A.W),Ke.L){st(A.h,Ke);var ns=Ke,Cn=A.O;Cn&&(ns.H=Cn),ns.D&&(In(ns),gn(ns)),A.g=Ke}else mr(A);_.i.length>0&&fn(_)}else Bs[0]!="stop"&&Bs[0]!="close"||kr(_,7);else _.I==3&&(Bs[0]=="stop"||Bs[0]=="close"?Bs[0]=="stop"?kr(_,7):rn(_):Bs[0]!="noop"&&_.l&&_.l.qa(Bs),_.A=0)}}ot(4)}catch{}}var N=class{constructor(h,b){this.g=h,this.map=b}};function P(h){this.l=h||10,d.PerformanceNavigationTiming?(h=d.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function U(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function fe(h){return h.h?1:h.g?h.g.size:0}function Ue(h,b){return h.h?h.h==b:h.g?h.g.has(b):!1}function Fe(h,b){h.g?h.g.add(b):h.h=b}function st(h,b){h.h&&h.h==b?h.h=null:h.g&&h.g.has(b)&&h.g.delete(b)}P.prototype.cancel=function(){if(this.i=et(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function et(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let b=h.i;for(const _ of h.g.values())b=b.concat(_.G);return b}return B(h.i)}var ss=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function js(h,b){if(h){h=h.split("&");for(let _=0;_<h.length;_++){const A=h[_].indexOf("=");let ie,ge=null;A>=0?(ie=h[_].substring(0,A),ge=h[_].substring(A+1)):ie=h[_],b(ie,ge?decodeURIComponent(ge.replace(/\+/g," ")):"")}}}function us(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let b;h instanceof us?(this.l=h.l,qs(this,h.j),this.o=h.o,this.g=h.g,En(this,h.u),this.h=h.h,cr(this,Wn(h.i)),this.m=h.m):h&&(b=String(h).match(ss))?(this.l=!1,qs(this,b[1]||"",!0),this.o=Dn(b[2]||""),this.g=Dn(b[3]||"",!0),En(this,b[4]),this.h=Dn(b[5]||"",!0),cr(this,b[6]||"",!0),this.m=Dn(b[7]||"")):(this.l=!1,this.i=new Yt(null,this.l))}us.prototype.toString=function(){const h=[];var b=this.j;b&&h.push(X(b,be,!0),":");var _=this.g;return(_||b=="file")&&(h.push("//"),(b=this.o)&&h.push(X(b,be,!0),"@"),h.push(_e(_).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.u,_!=null&&h.push(":",String(_))),(_=this.h)&&(this.g&&_.charAt(0)!="/"&&h.push("/"),h.push(X(_,_.charAt(0)=="/"?Xe:Je,!0))),(_=this.i.toString())&&h.push("?",_),(_=this.m)&&h.push("#",X(_,Kt)),h.join("")},us.prototype.resolve=function(h){const b=cs(this);let _=!!h.j;_?qs(b,h.j):_=!!h.o,_?b.o=h.o:_=!!h.g,_?b.g=h.g:_=h.u!=null;var A=h.h;if(_)En(b,h.u);else if(_=!!h.h){if(A.charAt(0)!="/")if(this.g&&!this.h)A="/"+A;else{var ie=b.h.lastIndexOf("/");ie!=-1&&(A=b.h.slice(0,ie+1)+A)}if(ie=A,ie==".."||ie==".")A="";else if(ie.indexOf("./")!=-1||ie.indexOf("/.")!=-1){A=ie.lastIndexOf("/",0)==0,ie=ie.split("/");const ge=[];for(let Ke=0;Ke<ie.length;){const ns=ie[Ke++];ns=="."?A&&Ke==ie.length&&ge.push(""):ns==".."?((ge.length>1||ge.length==1&&ge[0]!="")&&ge.pop(),A&&Ke==ie.length&&ge.push("")):(ge.push(ns),A=!0)}A=ge.join("/")}else A=ie}return _?b.h=A:_=h.i.toString()!=="",_?cr(b,Wn(h.i)):_=!!h.m,_&&(b.m=h.m),b};function cs(h){return new us(h)}function qs(h,b,_){h.j=_?Dn(b,!0):b,h.j&&(h.j=h.j.replace(/:$/,""))}function En(h,b){if(b){if(b=Number(b),isNaN(b)||b<0)throw Error("Bad port number "+b);h.u=b}else h.u=null}function cr(h,b,_){b instanceof Yt?(h.i=b,Zs(h.i,h.l)):(_||(b=X(b,ut)),h.i=new Yt(b,h.l))}function ds(h,b,_){h.i.set(b,_)}function Xr(h){return ds(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function Dn(h,b){return h?b?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function X(h,b,_){return typeof h=="string"?(h=encodeURI(h).replace(b,xe),_&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function xe(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var be=/[#\/\?@]/g,Je=/[#\?:]/g,Xe=/[#\?]/g,ut=/[#\?@]/g,Kt=/#/g;function Yt(h,b){this.h=this.g=null,this.i=h||null,this.j=!!b}function Ft(h){h.g||(h.g=new Map,h.h=0,h.i&&js(h.i,function(b,_){h.add(decodeURIComponent(b.replace(/\+/g," ")),_)}))}n=Yt.prototype,n.add=function(h,b){Ft(this),this.i=null,h=Rs(this,h);let _=this.g.get(h);return _||this.g.set(h,_=[]),_.push(b),this.h+=1,this};function Sn(h,b){Ft(h),b=Rs(h,b),h.g.has(b)&&(h.i=null,h.h-=h.g.get(b).length,h.g.delete(b))}function Mt(h,b){return Ft(h),b=Rs(h,b),h.g.has(b)}n.forEach=function(h,b){Ft(this),this.g.forEach(function(_,A){_.forEach(function(ie){h.call(b,ie,A,this)},this)},this)};function Ds(h,b){Ft(h);let _=[];if(typeof b=="string")Mt(h,b)&&(_=_.concat(h.g.get(Rs(h,b))));else for(h=Array.from(h.g.values()),b=0;b<h.length;b++)_=_.concat(h[b]);return _}n.set=function(h,b){return Ft(this),this.i=null,h=Rs(this,h),Mt(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[b]),this.h+=1,this},n.get=function(h,b){return h?(h=Ds(this,h),h.length>0?String(h[0]):b):b};function bn(h,b,_){Sn(h,b),_.length>0&&(h.i=null,h.g.set(Rs(h,b),B(_)),h.h+=_.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],b=Array.from(this.g.keys());for(let A=0;A<b.length;A++){var _=b[A];const ie=_e(_);_=Ds(this,_);for(let ge=0;ge<_.length;ge++){let Ke=ie;_[ge]!==""&&(Ke+="="+_e(_[ge])),h.push(Ke)}}return this.i=h.join("&")};function Wn(h){const b=new Yt;return b.i=h.i,h.g&&(b.g=new Map(h.g),b.h=h.h),b}function Rs(h,b){return b=String(b),h.j&&(b=b.toLowerCase()),b}function Zs(h,b){b&&!h.j&&(Ft(h),h.i=null,h.g.forEach(function(_,A){const ie=A.toLowerCase();A!=ie&&(Sn(this,A),bn(this,ie,_))},h)),h.j=b}function Zt(h,b){const _=new rt;if(d.Image){const A=new Image;A.onload=x(mn,_,"TestLoadImage: loaded",!0,b,A),A.onerror=x(mn,_,"TestLoadImage: error",!1,b,A),A.onabort=x(mn,_,"TestLoadImage: abort",!1,b,A),A.ontimeout=x(mn,_,"TestLoadImage: timeout",!1,b,A),d.setTimeout(function(){A.ontimeout&&A.ontimeout()},1e4),A.src=h}else b(!1)}function en(h,b){const _=new rt,A=new AbortController,ie=setTimeout(()=>{A.abort(),mn(_,"TestPingServer: timeout",!1,b)},1e4);fetch(h,{signal:A.signal}).then(ge=>{clearTimeout(ie),ge.ok?mn(_,"TestPingServer: ok",!0,b):mn(_,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(ie),mn(_,"TestPingServer: error",!1,b)})}function mn(h,b,_,A,ie){try{ie&&(ie.onload=null,ie.onerror=null,ie.onabort=null,ie.ontimeout=null),A(_)}catch{}}function Gn(){this.g=new Lt}function Kn(h){this.i=h.Sb||null,this.h=h.ab||!1}j(Kn,ps),Kn.prototype.g=function(){return new Nn(this.i,this.h)};function Nn(h,b){nt.call(this),this.H=h,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}j(Nn,nt),n=Nn.prototype,n.open=function(h,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=b,this.readyState=1,dr(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const b={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(b.body=h),(this.H||d).fetch(new Request(this.D,b)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ur(this)),this.readyState=0},n.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,dr(this)),this.g&&(this.readyState=3,dr(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Yn(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function Yn(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}n.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var b=h.value?h.value:new Uint8Array(0);(b=this.B.decode(b,{stream:!h.done}))&&(this.response=this.responseText+=b)}h.done?ur(this):dr(this),this.readyState==3&&Yn(this)}},n.Oa=function(h){this.g&&(this.response=this.responseText=h,ur(this))},n.Na=function(h){this.g&&(this.response=h,ur(this))},n.ga=function(){this.g&&ur(this)};function ur(h){h.readyState=4,h.l=null,h.j=null,h.B=null,dr(h)}n.setRequestHeader=function(h,b){this.A.append(h,b)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],b=this.h.entries();for(var _=b.next();!_.done;)_=_.value,h.push(_[0]+": "+_[1]),_=b.next();return h.join(`\r
`)};function dr(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Nn.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function C(h){let b="";return Ve(h,function(_,A){b+=A,b+=":",b+=_,b+=`\r
`}),b}function J(h,b,_){e:{for(A in _){var A=!1;break e}A=!0}A||(_=C(_),typeof h=="string"?_!=null&&_e(_):ds(h,b,_))}function Ce(h){nt.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}j(Ce,nt);var tt=/^https?$/i,Tt=["POST","PUT"];n=Ce.prototype,n.Fa=function(h){this.H=h},n.ea=function(h,b,_,A){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);b=b?b.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Us.g(),this.g.onreadystatechange=T(y(this.Ca,this));try{this.B=!0,this.g.open(b,String(h),!0),this.B=!1}catch(ge){Dt(this,ge);return}if(h=_||"",_=new Map(this.headers),A)if(Object.getPrototypeOf(A)===Object.prototype)for(var ie in A)_.set(ie,A[ie]);else if(typeof A.keys=="function"&&typeof A.get=="function")for(const ge of A.keys())_.set(ge,A.get(ge));else throw Error("Unknown input type for opt_headers: "+String(A));A=Array.from(_.keys()).find(ge=>ge.toLowerCase()=="content-type"),ie=d.FormData&&h instanceof d.FormData,!(Array.prototype.indexOf.call(Tt,b,void 0)>=0)||A||ie||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ge,Ke]of _)this.g.setRequestHeader(ge,Ke);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(ge){Dt(this,ge)}};function Dt(h,b){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=b,h.o=5,lt(h),Xt(h)}function lt(h){h.A||(h.A=!0,$e(h,"complete"),$e(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,$e(this,"complete"),$e(this,"abort"),Xt(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Xt(this,!0)),Ce.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?qt(this):this.Xa())},n.Xa=function(){qt(this)};function qt(h){if(h.h&&typeof u<"u"){if(h.v&&ls(h)==4)setTimeout(h.Ca.bind(h),0);else if($e(h,"readystatechange"),ls(h)==4){h.h=!1;try{const ge=h.ca();e:switch(ge){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var _;if(!(_=b)){var A;if(A=ge===0){let Ke=String(h.D).match(ss)[1]||null;!Ke&&d.self&&d.self.location&&(Ke=d.self.location.protocol.slice(0,-1)),A=!tt.test(Ke?Ke.toLowerCase():"")}_=A}if(_)$e(h,"complete"),$e(h,"success");else{h.o=6;try{var ie=ls(h)>2?h.g.statusText:""}catch{ie=""}h.l=ie+" ["+h.ca()+"]",lt(h)}}finally{Xt(h)}}}}function Xt(h,b){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const _=h.g;h.g=null,b||$e(h,"ready");try{_.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function ls(h){return h.g?h.g.readyState:0}n.ca=function(){try{return ls(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(h){if(this.g){var b=this.g.responseText;return h&&b.indexOf(h)==0&&(b=b.substring(h.length)),Js(b)}};function Qt(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function ws(h){const b={};h=(h.g&&ls(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let A=0;A<h.length;A++){if(I(h[A]))continue;var _=Ne(h[A]);const ie=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const ge=b[ie]||[];b[ie]=ge,ge.push(_)}ee(b,function(A){return A.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Qn(h,b,_){return _&&_.internalChannelParams&&_.internalChannelParams[h]||b}function xr(h){this.za=0,this.i=[],this.j=new rt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Qn("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Qn("baseRetryDelayMs",5e3,h),this.Za=Qn("retryDelaySeedMs",1e4,h),this.Ta=Qn("forwardChannelMaxRetries",2,h),this.va=Qn("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new P(h&&h.concurrentRequestLimit),this.Ba=new Gn,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=xr.prototype,n.ka=8,n.I=1,n.connect=function(h,b,_,A){re(0),this.W=h,this.H=b||{},_&&A!==void 0&&(this.H.OSID=_,this.H.OAID=A),this.F=this.X,this.J=ha(this,null,this.W),fn(this)};function rn(h){if(Xn(h),h.I==3){var b=h.V++,_=cs(h.J);if(ds(_,"SID",h.M),ds(_,"RID",b),ds(_,"TYPE","terminate"),tr(h,_),b=new Se(h,h.j,b),b.M=2,b.A=Xr(cs(_)),_=!1,d.navigator&&d.navigator.sendBeacon)try{_=d.navigator.sendBeacon(b.A.toString(),"")}catch{}!_&&d.Image&&(new Image().src=b.A,_=!0),_||(b.g=Gu(b.j,null),b.g.ea(b.A)),b.F=Date.now(),gn(b)}da(h)}function tn(h){h.g&&(_r(h),h.g.cancel(),h.g=null)}function Xn(h){tn(h),h.v&&(d.clearTimeout(h.v),h.v=null),Ga(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&d.clearTimeout(h.m),h.m=null)}function fn(h){if(!U(h.h)&&!h.m){h.m=!0;var b=h.Ea;Ae||E(),me||(Ae(),me=!0),R.add(b,h),h.D=0}}function zn(h,b){return fe(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=b.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=Ge(y(h.Ea,h,b),nl(h,h.D)),h.D++,!0)}n.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const ie=new Se(this,this.j,h);let ge=this.o;if(this.U&&(ge?(ge=L(ge),De(ge,this.U)):ge=this.U),this.u!==null||this.R||(ie.J=ge,ge=null),this.S)e:{for(var b=0,_=0;_<this.i.length;_++){t:{var A=this.i[_];if("__data__"in A.map&&(A=A.map.__data__,typeof A=="string")){A=A.length;break t}A=void 0}if(A===void 0)break;if(b+=A,b>4096){b=_;break e}if(b===4096||_===this.i.length-1){b=_+1;break e}}b=1e3}else b=1e3;b=wr(this,ie,b),_=cs(this.J),ds(_,"RID",h),ds(_,"CVER",22),this.G&&ds(_,"X-HTTP-Session-Id",this.G),tr(this,_),ge&&(this.R?b="headers="+_e(C(ge))+"&"+b:this.u&&J(_,this.u,ge)),Fe(this.h,ie),this.Ra&&ds(_,"TYPE","init"),this.S?(ds(_,"$req",b),ds(_,"SID","null"),ie.U=!0,Ze(ie,_,null)):Ze(ie,_,b),this.I=2}}else this.I==3&&(h?hr(this,h):this.i.length==0||U(this.h)||hr(this))};function hr(h,b){var _;b?_=b.l:_=h.V++;const A=cs(h.J);ds(A,"SID",h.M),ds(A,"RID",_),ds(A,"AID",h.K),tr(h,A),h.u&&h.o&&J(A,h.u,h.o),_=new Se(h,h.j,_,h.D+1),h.u===null&&(_.J=h.o),b&&(h.i=b.G.concat(h.i)),b=wr(h,_,1e3),_.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),Fe(h.h,_),Ze(_,A,b)}function tr(h,b){h.H&&Ve(h.H,function(_,A){ds(b,A,_)}),h.l&&Ve({},function(_,A){ds(b,A,_)})}function wr(h,b,_){_=Math.min(h.i.length,_);const A=h.l?y(h.l.Ka,h.l,h):null;e:{var ie=h.i;let ns=-1;for(;;){const Cn=["count="+_];ns==-1?_>0?(ns=ie[0].g,Cn.push("ofs="+ns)):ns=0:Cn.push("ofs="+ns);let Bs=!0;for(let cn=0;cn<_;cn++){var ge=ie[cn].g;const Jr=ie[cn].map;if(ge-=ns,ge<0)ns=Math.max(0,ie[cn].g-100),Bs=!1;else try{ge="req"+ge+"_"||"";try{var Ke=Jr instanceof Map?Jr:Object.entries(Jr);for(const[Ca,ma]of Ke){let fa=ma;p(ma)&&(fa=zt(ma)),Cn.push(ge+Ca+"="+encodeURIComponent(fa))}}catch(Ca){throw Cn.push(ge+"type="+encodeURIComponent("_badmap")),Ca}}catch{A&&A(Jr)}}if(Bs){Ke=Cn.join("&");break e}}Ke=void 0}return h=h.i.splice(0,_),b.G=h,Ke}function mr(h){if(!h.g&&!h.v){h.Y=1;var b=h.Da;Ae||E(),me||(Ae(),me=!0),R.add(b,h),h.A=0}}function vn(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=Ge(y(h.Da,h),nl(h,h.A)),h.A++,!0)}n.Da=function(){if(this.v=null,Mr(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=Ge(y(this.Wa,this),h)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,re(10),tn(this),Mr(this))};function _r(h){h.B!=null&&(d.clearTimeout(h.B),h.B=null)}function Mr(h){h.g=new Se(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var b=cs(h.na);ds(b,"RID","rpc"),ds(b,"SID",h.M),ds(b,"AID",h.K),ds(b,"CI",h.F?"0":"1"),!h.F&&h.ia&&ds(b,"TO",h.ia),ds(b,"TYPE","xmlhttp"),tr(h,b),h.u&&h.o&&J(b,h.u,h.o),h.O&&(h.g.H=h.O);var _=h.g;h=h.ba,_.M=1,_.A=Xr(cs(b)),_.u=null,_.R=!0,kt(_,h)}n.Va=function(){this.C!=null&&(this.C=null,tn(this),vn(this),re(19))};function Ga(h){h.C!=null&&(d.clearTimeout(h.C),h.C=null)}function sl(h,b){var _=null;if(h.g==b){Ga(h),_r(h),h.g=null;var A=2}else if(Ue(h.h,b))_=b.G,st(h.h,b),A=1;else return;if(h.I!=0){if(b.o)if(A==1){_=b.u?b.u.length:0,b=Date.now()-b.F;var ie=h.D;A=ke(),$e(A,new We(A,_)),fn(h)}else mr(h);else if(ie=b.m,ie==3||ie==0&&b.X>0||!(A==1&&zn(h,b)||A==2&&vn(h)))switch(_&&_.length>0&&(b=h.h,b.i=b.i.concat(_)),ie){case 1:kr(h,5);break;case 4:kr(h,10);break;case 3:kr(h,6);break;default:kr(h,2)}}}function nl(h,b){let _=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(_*=2),_*b}function kr(h,b){if(h.j.info("Error code "+b),b==2){var _=y(h.bb,h),A=h.Ua;const ie=!A;A=new us(A||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||qs(A,"https"),Xr(A),ie?Zt(A.toString(),_):en(A.toString(),_)}else re(2);h.I=0,h.l&&h.l.pa(b),da(h),Xn(h)}n.bb=function(h){h?(this.j.info("Successfully pinged google.com"),re(2)):(this.j.info("Failed to ping google.com"),re(1))};function da(h){if(h.I=0,h.ja=[],h.l){const b=et(h.h);(b.length!=0||h.i.length!=0)&&($(h.ja,b),$(h.ja,h.i),h.h.i.length=0,B(h.i),h.i.length=0),h.l.oa()}}function ha(h,b,_){var A=_ instanceof us?cs(_):new us(_);if(A.g!="")b&&(A.g=b+"."+A.g),En(A,A.u);else{var ie=d.location;A=ie.protocol,b=b?b+"."+ie.hostname:ie.hostname,ie=+ie.port;const ge=new us(null);A&&qs(ge,A),b&&(ge.g=b),ie&&En(ge,ie),_&&(ge.h=_),A=ge}return _=h.G,b=h.wa,_&&b&&ds(A,_,b),ds(A,"VER",h.ka),tr(h,A),A}function Gu(h,b,_){if(b&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return b=h.Aa&&!h.ma?new Ce(new Kn({ab:_})):new Ce(h.ma),b.Fa(h.L),b}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ku(){}n=Ku.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function ki(){}ki.prototype.g=function(h,b){return new jr(h,b)};function jr(h,b){nt.call(this),this.g=new xr(b),this.l=h,this.h=b&&b.messageUrlParams||null,h=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(h?h["X-WebChannel-Content-Type"]=b.messageContentType:h={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.sa&&(h?h["X-WebChannel-Client-Profile"]=b.sa:h={"X-WebChannel-Client-Profile":b.sa}),this.g.U=h,(h=b&&b.Qb)&&!I(h)&&(this.g.u=h),this.A=b&&b.supportsCrossDomainXhr||!1,this.v=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!I(b)&&(this.g.G=b,h=this.h,h!==null&&b in h&&(h=this.h,b in h&&delete h[b])),this.j=new Ka(this)}j(jr,nt),jr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},jr.prototype.close=function(){rn(this.g)},jr.prototype.o=function(h){var b=this.g;if(typeof h=="string"){var _={};_.__data__=h,h=_}else this.v&&(_={},_.__data__=zt(h),h=_);b.i.push(new N(b.Ya++,h)),b.I==3&&fn(b)},jr.prototype.N=function(){this.g.l=null,delete this.j,rn(this.g),delete this.g,jr.Z.N.call(this)};function Yu(h){G.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var b=h.__sm__;if(b){e:{for(const _ in b){h=_;break e}h=void 0}(this.i=h)&&(h=this.i,b=b!==null&&h in b?b[h]:void 0),this.data=b}else this.data=h}j(Yu,G);function Qu(){he.call(this),this.status=1}j(Qu,he);function Ka(h){this.g=h}j(Ka,Ku),Ka.prototype.ra=function(){$e(this.g,"a")},Ka.prototype.qa=function(h){$e(this.g,new Yu(h))},Ka.prototype.pa=function(h){$e(this.g,new Qu)},Ka.prototype.oa=function(){$e(this.g,"b")},ki.prototype.createWebChannel=ki.prototype.g,jr.prototype.send=jr.prototype.o,jr.prototype.open=jr.prototype.m,jr.prototype.close=jr.prototype.close,Jw=function(){return new ki},Xw=function(){return ke()},Qw=Ee,gg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},os.NO_ERROR=0,os.TIMEOUT=8,os.HTTP_ERROR=6,wh=os,ks.COMPLETE="complete",Yw=ks,Wt.EventType=we,we.OPEN="a",we.CLOSE="b",we.ERROR="c",we.MESSAGE="d",nt.prototype.listen=nt.prototype.J,ru=Wt,Ce.prototype.listenOnce=Ce.prototype.K,Ce.prototype.getLastError=Ce.prototype.Ha,Ce.prototype.getLastErrorCode=Ce.prototype.ya,Ce.prototype.getStatus=Ce.prototype.ca,Ce.prototype.getResponseJson=Ce.prototype.La,Ce.prototype.getResponseText=Ce.prototype.la,Ce.prototype.send=Ce.prototype.ea,Ce.prototype.setWithCredentials=Ce.prototype.Fa,Kw=Ce}).apply(typeof sh<"u"?sh:typeof self<"u"?self:typeof window<"u"?window:{});class gr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}gr.UNAUTHENTICATED=new gr(null),gr.GOOGLE_CREDENTIALS=new gr("google-credentials-uid"),gr.FIRST_PARTY=new gr("first-party-uid"),gr.MOCK_USER=new gr("mock-user");let ic="12.8.0";function hR(n){ic=n}const Yo=new Wg("@firebase/firestore");function Ul(){return Yo.logLevel}function ht(n,...e){if(Yo.logLevel<=bs.DEBUG){const t=e.map(ay);Yo.debug(`Firestore (${ic}): ${n}`,...t)}}function bi(n,...e){if(Yo.logLevel<=bs.ERROR){const t=e.map(ay);Yo.error(`Firestore (${ic}): ${n}`,...t)}}function Ql(n,...e){if(Yo.logLevel<=bs.WARN){const t=e.map(ay);Yo.warn(`Firestore (${ic}): ${n}`,...t)}}function ay(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Vt(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,Zw(n,i,t)}function Zw(n,e,t){let i=`FIRESTORE (${ic}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw bi(i),new Error(i)}function Fs(n,e,t,i){let l="Unexpected state";typeof t=="string"?l=t:i=t,n||Zw(e,l,i)}function ts(n,e){return n}const Re={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class at extends Wa{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class fi{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class e_{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class mR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(gr.UNAUTHENTICATED)))}shutdown(){}}class fR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class pR{constructor(e){this.t=e,this.currentUser=gr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Fs(this.o===void 0,42304);let i=this.i;const l=g=>this.i!==i?(i=this.i,t(g)):Promise.resolve();let u=new fi;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new fi,e.enqueueRetryable((()=>l(this.currentUser)))};const d=()=>{const g=u;e.enqueueRetryable((async()=>{await g.promise,await l(this.currentUser)}))},p=g=>{ht("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((g=>p(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?p(g):(ht("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new fi)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(ht("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Fs(typeof i.accessToken=="string",31837,{l:i}),new e_(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Fs(e===null||typeof e=="string",2055,{h:e}),new gr(e)}}class gR{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=gr.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class yR{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new gR(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(gr.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class bx{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class bR{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Kr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Fs(this.o===void 0,3512);const i=u=>{u.error!=null&&ht("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const d=u.token!==this.m;return this.m=u.token,ht("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable((()=>i(u)))};const l=u=>{ht("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>l(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?l(u):ht("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new bx(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Fs(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new bx(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function vR(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class iy{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const l=vR(40);for(let u=0;u<l.length;++u)i.length<20&&l[u]<t&&(i+=e.charAt(l[u]%62))}return i}}function vs(n,e){return n<e?-1:n>e?1:0}function yg(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const l=n.charAt(i),u=e.charAt(i);if(l!==u)return Dp(l)===Dp(u)?vs(l,u):Dp(l)?1:-1}return vs(n.length,e.length)}const xR=55296,wR=57343;function Dp(n){const e=n.charCodeAt(0);return e>=xR&&e<=wR}function Xl(n,e,t){return n.length===e.length&&n.every(((i,l)=>t(i,e[l])))}const vx="__name__";class Pa{constructor(e,t,i){t===void 0?t=0:t>e.length&&Vt(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Vt(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Pa.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Pa?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let l=0;l<i;l++){const u=Pa.compareSegments(e.get(l),t.get(l));if(u!==0)return u}return vs(e.length,t.length)}static compareSegments(e,t){const i=Pa.isNumericId(e),l=Pa.isNumericId(t);return i&&!l?-1:!i&&l?1:i&&l?Pa.extractNumericId(e).compare(Pa.extractNumericId(t)):yg(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ao.fromString(e.substring(4,e.length-2))}}class an extends Pa{construct(e,t,i){return new an(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new at(Re.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((l=>l.length>0)))}return new an(t)}static emptyPath(){return new an([])}}const _R=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class or extends Pa{construct(e,t,i){return new or(e,t,i)}static isValidIdentifier(e){return _R.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),or.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===vx}static keyField(){return new or([vx])}static fromServerFormat(e){const t=[];let i="",l=0;const u=()=>{if(i.length===0)throw new at(Re.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let d=!1;for(;l<e.length;){const p=e[l];if(p==="\\"){if(l+1===e.length)throw new at(Re.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[l+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new at(Re.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=g,l+=2}else p==="`"?(d=!d,l++):p!=="."||d?(i+=p,l++):(u(),l++)}if(u(),d)throw new at(Re.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new or(t)}static emptyPath(){return new or([])}}class Ct{constructor(e){this.path=e}static fromPath(e){return new Ct(an.fromString(e))}static fromName(e){return new Ct(an.fromString(e).popFirst(5))}static empty(){return new Ct(an.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&an.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return an.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ct(new an(e.slice()))}}function t_(n,e,t){if(!t)throw new at(Re.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function kR(n,e,t,i){if(e===!0&&i===!0)throw new at(Re.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function xx(n){if(!Ct.isDocumentKey(n))throw new at(Re.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function wx(n){if(Ct.isDocumentKey(n))throw new at(Re.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function s_(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function rm(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Vt(12329,{type:typeof n})}function Cr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new at(Re.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=rm(n);throw new at(Re.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function jR(n,e){if(e<=0)throw new at(Re.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function Fn(n,e){const t={typeString:n};return e&&(t.value=e),t}function Lu(n,e){if(!s_(n))throw new at(Re.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const l=e[i].typeString,u="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const d=n[i];if(l&&typeof d!==l){t=`JSON field '${i}' must be a ${l}.`;break}if(u!==void 0&&d!==u.value){t=`Expected '${i}' field to equal '${u.value}'`;break}}if(t)throw new at(Re.INVALID_ARGUMENT,t);return!0}const _x=-62135596800,kx=1e6;class _t{static now(){return _t.fromMillis(Date.now())}static fromDate(e){return _t.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*kx);return new _t(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new at(Re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new at(Re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<_x)throw new at(Re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new at(Re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/kx}_compareTo(e){return this.seconds===e.seconds?vs(this.nanoseconds,e.nanoseconds):vs(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:_t._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Lu(e,_t._jsonSchema))return new _t(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-_x;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}_t._jsonSchemaVersion="firestore/timestamp/1.0",_t._jsonSchema={type:Fn("string",_t._jsonSchemaVersion),seconds:Fn("number"),nanoseconds:Fn("number")};class Jt{static fromTimestamp(e){return new Jt(e)}static min(){return new Jt(new _t(0,0))}static max(){return new Jt(new _t(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const vu=-1;function TR(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,l=Jt.fromTimestamp(i===1e9?new _t(t+1,0):new _t(t,i));return new lo(l,Ct.empty(),e)}function ER(n){return new lo(n.readTime,n.key,vu)}class lo{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new lo(Jt.min(),Ct.empty(),vu)}static max(){return new lo(Jt.max(),Ct.empty(),vu)}}function SR(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ct.comparator(n.documentKey,e.documentKey),t!==0?t:vs(n.largestBatchId,e.largestBatchId))}const NR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class CR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function oc(n){if(n.code!==Re.FAILED_PRECONDITION||n.message!==NR)throw n;ht("LocalStore","Unexpectedly lost primary lease")}class Be{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Vt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Be(((i,l)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(i,l)},this.catchCallback=u=>{this.wrapFailure(t,u).next(i,l)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Be?t:Be.resolve(t)}catch(t){return Be.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Be.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Be.reject(t)}static resolve(e){return new Be(((t,i)=>{t(e)}))}static reject(e){return new Be(((t,i)=>{i(e)}))}static waitFor(e){return new Be(((t,i)=>{let l=0,u=0,d=!1;e.forEach((p=>{++l,p.next((()=>{++u,d&&u===l&&t()}),(g=>i(g)))})),d=!0,u===l&&t()}))}static or(e){let t=Be.resolve(!1);for(const i of e)t=t.next((l=>l?Be.resolve(l):i()));return t}static forEach(e,t){const i=[];return e.forEach(((l,u)=>{i.push(t.call(this,l,u))})),this.waitFor(i)}static mapArray(e,t){return new Be(((i,l)=>{const u=e.length,d=new Array(u);let p=0;for(let g=0;g<u;g++){const y=g;t(e[y]).next((x=>{d[y]=x,++p,p===u&&i(d)}),(x=>l(x)))}}))}static doWhile(e,t){return new Be(((i,l)=>{const u=()=>{e()===!0?t().next((()=>{u()}),l):i()};u()}))}}function RR(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function lc(n){return n.name==="IndexedDbTransactionError"}class am{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}am.ce=-1;const oy=-1;function im(n){return n==null}function Oh(n){return n===0&&1/n==-1/0}function AR(n){return typeof n=="number"&&Number.isInteger(n)&&!Oh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const n_="";function MR(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=jx(e)),e=IR(n.get(t),e);return jx(e)}function IR(n,e){let t=e;const i=n.length;for(let l=0;l<i;l++){const u=n.charAt(l);switch(u){case"\0":t+="";break;case n_:t+="";break;default:t+=u}}return t}function jx(n){return n+n_+""}function Tx(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function yo(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function r_(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class pn{constructor(e,t){this.comparator=e,this.root=t||ir.EMPTY}insert(e,t){return new pn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ir.BLACK,null,null))}remove(e){return new pn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ir.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const l=this.comparator(e,i.key);if(l===0)return t+i.left.size;l<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new nh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new nh(this.root,e,this.comparator,!1)}getReverseIterator(){return new nh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new nh(this.root,e,this.comparator,!0)}}class nh{constructor(e,t,i,l){this.isReverse=l,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=t?i(e.key,t):1,t&&l&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ir{constructor(e,t,i,l,u){this.key=e,this.value=t,this.color=i??ir.RED,this.left=l??ir.EMPTY,this.right=u??ir.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,l,u){return new ir(e??this.key,t??this.value,i??this.color,l??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let l=this;const u=i(e,l.key);return l=u<0?l.copy(null,null,null,l.left.insert(e,t,i),null):u===0?l.copy(null,t,null,null,null):l.copy(null,null,null,null,l.right.insert(e,t,i)),l.fixUp()}removeMin(){if(this.left.isEmpty())return ir.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,l=this;if(t(e,l.key)<0)l.left.isEmpty()||l.left.isRed()||l.left.left.isRed()||(l=l.moveRedLeft()),l=l.copy(null,null,null,l.left.remove(e,t),null);else{if(l.left.isRed()&&(l=l.rotateRight()),l.right.isEmpty()||l.right.isRed()||l.right.left.isRed()||(l=l.moveRedRight()),t(e,l.key)===0){if(l.right.isEmpty())return ir.EMPTY;i=l.right.min(),l=l.copy(i.key,i.value,null,null,l.right.removeMin())}l=l.copy(null,null,null,null,l.right.remove(e,t))}return l.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ir.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ir.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Vt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Vt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Vt(27949);return e+(this.isRed()?0:1)}}ir.EMPTY=null,ir.RED=!0,ir.BLACK=!1;ir.EMPTY=new class{constructor(){this.size=0}get key(){throw Vt(57766)}get value(){throw Vt(16141)}get color(){throw Vt(16727)}get left(){throw Vt(29726)}get right(){throw Vt(36894)}copy(e,t,i,l,u){return this}insert(e,t,i){return new ir(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class $n{constructor(e){this.comparator=e,this.data=new pn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const l=i.getNext();if(this.comparator(l.key,e[1])>=0)return;t(l.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Ex(this.data.getIterator())}getIteratorFrom(e){return new Ex(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof $n)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(this.comparator(l,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new $n(this.comparator);return t.data=e,t}}class Ex{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Yr{constructor(e){this.fields=e,e.sort(or.comparator)}static empty(){return new Yr([])}unionWith(e){let t=new $n(or.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Yr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Xl(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class a_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class lr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(l){try{return atob(l)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new a_("Invalid base64 string: "+u):u}})(e);return new lr(t)}static fromUint8Array(e){const t=(function(l){let u="";for(let d=0;d<l.length;++d)u+=String.fromCharCode(l[d]);return u})(e);return new lr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return vs(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}lr.EMPTY_BYTE_STRING=new lr("");const DR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function co(n){if(Fs(!!n,39018),typeof n=="string"){let e=0;const t=DR.exec(n);if(Fs(!!t,46558,{timestamp:n}),t[1]){let l=t[1];l=(l+"000000000").substr(0,9),e=Number(l)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Mn(n.seconds),nanos:Mn(n.nanos)}}function Mn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function uo(n){return typeof n=="string"?lr.fromBase64String(n):lr.fromUint8Array(n)}const i_="server_timestamp",o_="__type__",l_="__previous_value__",c_="__local_write_time__";function ly(n){return(n?.mapValue?.fields||{})[o_]?.stringValue===i_}function om(n){const e=n.mapValue.fields[l_];return ly(e)?om(e):e}function xu(n){const e=co(n.mapValue.fields[c_].timestampValue);return new _t(e.seconds,e.nanos)}class PR{constructor(e,t,i,l,u,d,p,g,y,x,j){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=l,this.ssl=u,this.forceLongPolling=d,this.autoDetectLongPolling=p,this.longPollingOptions=g,this.useFetchStreams=y,this.isUsingEmulator=x,this.apiKey=j}}const Bh="(default)";class wu{constructor(e,t){this.projectId=e,this.database=t||Bh}static empty(){return new wu("","")}get isDefaultDatabase(){return this.database===Bh}isEqual(e){return e instanceof wu&&e.projectId===this.projectId&&e.database===this.database}}function LR(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new at(Re.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new wu(n.options.projectId,e)}const u_="__type__",OR="__max__",rh={mapValue:{}},d_="__vector__",Vh="value";function ho(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?ly(n)?4:VR(n)?9007199254740991:BR(n)?10:11:Vt(28295,{value:n})}function Ha(n,e){if(n===e)return!0;const t=ho(n);if(t!==ho(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return xu(n).isEqual(xu(e));case 3:return(function(l,u){if(typeof l.timestampValue=="string"&&typeof u.timestampValue=="string"&&l.timestampValue.length===u.timestampValue.length)return l.timestampValue===u.timestampValue;const d=co(l.timestampValue),p=co(u.timestampValue);return d.seconds===p.seconds&&d.nanos===p.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(l,u){return uo(l.bytesValue).isEqual(uo(u.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(l,u){return Mn(l.geoPointValue.latitude)===Mn(u.geoPointValue.latitude)&&Mn(l.geoPointValue.longitude)===Mn(u.geoPointValue.longitude)})(n,e);case 2:return(function(l,u){if("integerValue"in l&&"integerValue"in u)return Mn(l.integerValue)===Mn(u.integerValue);if("doubleValue"in l&&"doubleValue"in u){const d=Mn(l.doubleValue),p=Mn(u.doubleValue);return d===p?Oh(d)===Oh(p):isNaN(d)&&isNaN(p)}return!1})(n,e);case 9:return Xl(n.arrayValue.values||[],e.arrayValue.values||[],Ha);case 10:case 11:return(function(l,u){const d=l.mapValue.fields||{},p=u.mapValue.fields||{};if(Tx(d)!==Tx(p))return!1;for(const g in d)if(d.hasOwnProperty(g)&&(p[g]===void 0||!Ha(d[g],p[g])))return!1;return!0})(n,e);default:return Vt(52216,{left:n})}}function _u(n,e){return(n.values||[]).find((t=>Ha(t,e)))!==void 0}function Jl(n,e){if(n===e)return 0;const t=ho(n),i=ho(e);if(t!==i)return vs(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return vs(n.booleanValue,e.booleanValue);case 2:return(function(u,d){const p=Mn(u.integerValue||u.doubleValue),g=Mn(d.integerValue||d.doubleValue);return p<g?-1:p>g?1:p===g?0:isNaN(p)?isNaN(g)?0:-1:1})(n,e);case 3:return Sx(n.timestampValue,e.timestampValue);case 4:return Sx(xu(n),xu(e));case 5:return yg(n.stringValue,e.stringValue);case 6:return(function(u,d){const p=uo(u),g=uo(d);return p.compareTo(g)})(n.bytesValue,e.bytesValue);case 7:return(function(u,d){const p=u.split("/"),g=d.split("/");for(let y=0;y<p.length&&y<g.length;y++){const x=vs(p[y],g[y]);if(x!==0)return x}return vs(p.length,g.length)})(n.referenceValue,e.referenceValue);case 8:return(function(u,d){const p=vs(Mn(u.latitude),Mn(d.latitude));return p!==0?p:vs(Mn(u.longitude),Mn(d.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Nx(n.arrayValue,e.arrayValue);case 10:return(function(u,d){const p=u.fields||{},g=d.fields||{},y=p[Vh]?.arrayValue,x=g[Vh]?.arrayValue,j=vs(y?.values?.length||0,x?.values?.length||0);return j!==0?j:Nx(y,x)})(n.mapValue,e.mapValue);case 11:return(function(u,d){if(u===rh.mapValue&&d===rh.mapValue)return 0;if(u===rh.mapValue)return 1;if(d===rh.mapValue)return-1;const p=u.fields||{},g=Object.keys(p),y=d.fields||{},x=Object.keys(y);g.sort(),x.sort();for(let j=0;j<g.length&&j<x.length;++j){const T=yg(g[j],x[j]);if(T!==0)return T;const B=Jl(p[g[j]],y[x[j]]);if(B!==0)return B}return vs(g.length,x.length)})(n.mapValue,e.mapValue);default:throw Vt(23264,{he:t})}}function Sx(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return vs(n,e);const t=co(n),i=co(e),l=vs(t.seconds,i.seconds);return l!==0?l:vs(t.nanos,i.nanos)}function Nx(n,e){const t=n.values||[],i=e.values||[];for(let l=0;l<t.length&&l<i.length;++l){const u=Jl(t[l],i[l]);if(u)return u}return vs(t.length,i.length)}function Zl(n){return bg(n)}function bg(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=co(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return uo(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Ct.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",l=!0;for(const u of t.values||[])l?l=!1:i+=",",i+=bg(u);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let l="{",u=!0;for(const d of i)u?u=!1:l+=",",l+=`${d}:${bg(t.fields[d])}`;return l+"}"})(n.mapValue):Vt(61005,{value:n})}function _h(n){switch(ho(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=om(n);return e?16+_h(e):16;case 5:return 2*n.stringValue.length;case 6:return uo(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((l,u)=>l+_h(u)),0)})(n.arrayValue);case 10:case 11:return(function(i){let l=0;return yo(i.fields,((u,d)=>{l+=u.length+_h(d)})),l})(n.mapValue);default:throw Vt(13486,{value:n})}}function Cx(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function vg(n){return!!n&&"integerValue"in n}function cy(n){return!!n&&"arrayValue"in n}function Rx(n){return!!n&&"nullValue"in n}function Ax(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function kh(n){return!!n&&"mapValue"in n}function BR(n){return(n?.mapValue?.fields||{})[u_]?.stringValue===d_}function uu(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return yo(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=uu(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=uu(n.arrayValue.values[t]);return e}return{...n}}function VR(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===OR}class Vr{constructor(e){this.value=e}static empty(){return new Vr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!kh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=uu(t)}setAll(e){let t=or.emptyPath(),i={},l=[];e.forEach(((d,p)=>{if(!t.isImmediateParentOf(p)){const g=this.getFieldsMap(t);this.applyChanges(g,i,l),i={},l=[],t=p.popLast()}d?i[p.lastSegment()]=uu(d):l.push(p.lastSegment())}));const u=this.getFieldsMap(t);this.applyChanges(u,i,l)}delete(e){const t=this.field(e.popLast());kh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ha(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let l=t.mapValue.fields[e.get(i)];kh(l)&&l.mapValue.fields||(l={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=l),t=l}return t.mapValue.fields}applyChanges(e,t,i){yo(t,((l,u)=>e[l]=u));for(const l of i)delete e[l]}clone(){return new Vr(uu(this.value))}}function h_(n){const e=[];return yo(n.fields,((t,i)=>{const l=new or([t]);if(kh(i)){const u=h_(i.mapValue).fields;if(u.length===0)e.push(l);else for(const d of u)e.push(l.child(d))}else e.push(l)})),new Yr(e)}class yr{constructor(e,t,i,l,u,d,p){this.key=e,this.documentType=t,this.version=i,this.readTime=l,this.createTime=u,this.data=d,this.documentState=p}static newInvalidDocument(e){return new yr(e,0,Jt.min(),Jt.min(),Jt.min(),Vr.empty(),0)}static newFoundDocument(e,t,i,l){return new yr(e,1,t,Jt.min(),i,l,0)}static newNoDocument(e,t){return new yr(e,2,t,Jt.min(),Jt.min(),Vr.empty(),0)}static newUnknownDocument(e,t){return new yr(e,3,t,Jt.min(),Jt.min(),Vr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Jt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Vr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Vr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Jt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof yr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new yr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Uh{constructor(e,t){this.position=e,this.inclusive=t}}function Mx(n,e,t){let i=0;for(let l=0;l<n.position.length;l++){const u=e[l],d=n.position[l];if(u.field.isKeyField()?i=Ct.comparator(Ct.fromName(d.referenceValue),t.key):i=Jl(d,t.data.field(u.field)),u.dir==="desc"&&(i*=-1),i!==0)break}return i}function Ix(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ha(n.position[t],e.position[t]))return!1;return!0}class ku{constructor(e,t="asc"){this.field=e,this.dir=t}}function UR(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class m_{}class Un extends m_{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new zR(e,t,i):t==="array-contains"?new $R(e,i):t==="in"?new WR(e,i):t==="not-in"?new GR(e,i):t==="array-contains-any"?new KR(e,i):new Un(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new qR(e,i):new HR(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Jl(t,this.value)):t!==null&&ho(this.value)===ho(t)&&this.matchesComparison(Jl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Vt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ja extends m_{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new ja(e,t)}matches(e){return f_(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function f_(n){return n.op==="and"}function p_(n){return FR(n)&&f_(n)}function FR(n){for(const e of n.filters)if(e instanceof ja)return!1;return!0}function xg(n){if(n instanceof Un)return n.field.canonicalString()+n.op.toString()+Zl(n.value);if(p_(n))return n.filters.map((e=>xg(e))).join(",");{const e=n.filters.map((t=>xg(t))).join(",");return`${n.op}(${e})`}}function g_(n,e){return n instanceof Un?(function(i,l){return l instanceof Un&&i.op===l.op&&i.field.isEqual(l.field)&&Ha(i.value,l.value)})(n,e):n instanceof ja?(function(i,l){return l instanceof ja&&i.op===l.op&&i.filters.length===l.filters.length?i.filters.reduce(((u,d,p)=>u&&g_(d,l.filters[p])),!0):!1})(n,e):void Vt(19439)}function y_(n){return n instanceof Un?(function(t){return`${t.field.canonicalString()} ${t.op} ${Zl(t.value)}`})(n):n instanceof ja?(function(t){return t.op.toString()+" {"+t.getFilters().map(y_).join(" ,")+"}"})(n):"Filter"}class zR extends Un{constructor(e,t,i){super(e,t,i),this.key=Ct.fromName(i.referenceValue)}matches(e){const t=Ct.comparator(e.key,this.key);return this.matchesComparison(t)}}class qR extends Un{constructor(e,t){super(e,"in",t),this.keys=b_("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class HR extends Un{constructor(e,t){super(e,"not-in",t),this.keys=b_("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function b_(n,e){return(e.arrayValue?.values||[]).map((t=>Ct.fromName(t.referenceValue)))}class $R extends Un{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return cy(t)&&_u(t.arrayValue,this.value)}}class WR extends Un{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&_u(this.value.arrayValue,t)}}class GR extends Un{constructor(e,t){super(e,"not-in",t)}matches(e){if(_u(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!_u(this.value.arrayValue,t)}}class KR extends Un{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!cy(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>_u(this.value.arrayValue,i)))}}class YR{constructor(e,t=null,i=[],l=[],u=null,d=null,p=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=l,this.limit=u,this.startAt=d,this.endAt=p,this.Te=null}}function Dx(n,e=null,t=[],i=[],l=null,u=null,d=null){return new YR(n,e,t,i,l,u,d)}function uy(n){const e=ts(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>xg(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(u){return u.field.canonicalString()+u.dir})(i))).join(","),im(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Zl(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Zl(i))).join(",")),e.Te=t}return e.Te}function dy(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!UR(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!g_(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Ix(n.startAt,e.startAt)&&Ix(n.endAt,e.endAt)}function wg(n){return Ct.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class cc{constructor(e,t=null,i=[],l=[],u=null,d="F",p=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=l,this.limit=u,this.limitType=d,this.startAt=p,this.endAt=g,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function QR(n,e,t,i,l,u,d,p){return new cc(n,e,t,i,l,u,d,p)}function lm(n){return new cc(n)}function Px(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function XR(n){return Ct.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function v_(n){return n.collectionGroup!==null}function du(n){const e=ts(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const u of e.explicitOrderBy)e.Ie.push(u),t.add(u.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let p=new $n(or.comparator);return d.filters.forEach((g=>{g.getFlattenedFilters().forEach((y=>{y.isInequality()&&(p=p.add(y.field))}))})),p})(e).forEach((u=>{t.has(u.canonicalString())||u.isKeyField()||e.Ie.push(new ku(u,i))})),t.has(or.keyField().canonicalString())||e.Ie.push(new ku(or.keyField(),i))}return e.Ie}function Fa(n){const e=ts(n);return e.Ee||(e.Ee=JR(e,du(n))),e.Ee}function JR(n,e){if(n.limitType==="F")return Dx(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((l=>{const u=l.dir==="desc"?"asc":"desc";return new ku(l.field,u)}));const t=n.endAt?new Uh(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Uh(n.startAt.position,n.startAt.inclusive):null;return Dx(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function _g(n,e){const t=n.filters.concat([e]);return new cc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function ZR(n,e){const t=n.explicitOrderBy.concat([e]);return new cc(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function Fh(n,e,t){return new cc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function cm(n,e){return dy(Fa(n),Fa(e))&&n.limitType===e.limitType}function x_(n){return`${uy(Fa(n))}|lt:${n.limitType}`}function Fl(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((l=>y_(l))).join(", ")}]`),im(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((l=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(l))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((l=>Zl(l))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((l=>Zl(l))).join(",")),`Target(${i})`})(Fa(n))}; limitType=${n.limitType})`}function um(n,e){return e.isFoundDocument()&&(function(i,l){const u=l.key.path;return i.collectionGroup!==null?l.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(u):Ct.isDocumentKey(i.path)?i.path.isEqual(u):i.path.isImmediateParentOf(u)})(n,e)&&(function(i,l){for(const u of du(i))if(!u.field.isKeyField()&&l.data.field(u.field)===null)return!1;return!0})(n,e)&&(function(i,l){for(const u of i.filters)if(!u.matches(l))return!1;return!0})(n,e)&&(function(i,l){return!(i.startAt&&!(function(d,p,g){const y=Mx(d,p,g);return d.inclusive?y<=0:y<0})(i.startAt,du(i),l)||i.endAt&&!(function(d,p,g){const y=Mx(d,p,g);return d.inclusive?y>=0:y>0})(i.endAt,du(i),l))})(n,e)}function eA(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function w_(n){return(e,t)=>{let i=!1;for(const l of du(n)){const u=tA(l,e,t);if(u!==0)return u;i=i||l.field.isKeyField()}return 0}}function tA(n,e,t){const i=n.field.isKeyField()?Ct.comparator(e.key,t.key):(function(u,d,p){const g=d.data.field(u),y=p.data.field(u);return g!==null&&y!==null?Jl(g,y):Vt(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Vt(19790,{direction:n.dir})}}class el{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[l,u]of i)if(this.equalsFn(l,e))return u}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),l=this.inner[i];if(l===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let u=0;u<l.length;u++)if(this.equalsFn(l[u][0],e))return void(l[u]=[e,t]);l.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let l=0;l<i.length;l++)if(this.equalsFn(i[l][0],e))return i.length===1?delete this.inner[t]:i.splice(l,1),this.innerSize--,!0;return!1}forEach(e){yo(this.inner,((t,i)=>{for(const[l,u]of i)e(l,u)}))}isEmpty(){return r_(this.inner)}size(){return this.innerSize}}const sA=new pn(Ct.comparator);function vi(){return sA}const __=new pn(Ct.comparator);function au(...n){let e=__;for(const t of n)e=e.insert(t.key,t);return e}function k_(n){let e=__;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Vo(){return hu()}function j_(){return hu()}function hu(){return new el((n=>n.toString()),((n,e)=>n.isEqual(e)))}const nA=new pn(Ct.comparator),rA=new $n(Ct.comparator);function xs(...n){let e=rA;for(const t of n)e=e.add(t);return e}const aA=new $n(vs);function iA(){return aA}function hy(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Oh(e)?"-0":e}}function T_(n){return{integerValue:""+n}}function E_(n,e){return AR(e)?T_(e):hy(n,e)}class dm{constructor(){this._=void 0}}function oA(n,e,t){return n instanceof ju?(function(l,u){const d={fields:{[o_]:{stringValue:i_},[c_]:{timestampValue:{seconds:l.seconds,nanos:l.nanoseconds}}}};return u&&ly(u)&&(u=om(u)),u&&(d.fields[l_]=u),{mapValue:d}})(t,e):n instanceof Tu?N_(n,e):n instanceof Eu?C_(n,e):(function(l,u){const d=S_(l,u),p=Lx(d)+Lx(l.Ae);return vg(d)&&vg(l.Ae)?T_(p):hy(l.serializer,p)})(n,e)}function lA(n,e,t){return n instanceof Tu?N_(n,e):n instanceof Eu?C_(n,e):t}function S_(n,e){return n instanceof Su?(function(i){return vg(i)||(function(u){return!!u&&"doubleValue"in u})(i)})(e)?e:{integerValue:0}:null}class ju extends dm{}class Tu extends dm{constructor(e){super(),this.elements=e}}function N_(n,e){const t=R_(e);for(const i of n.elements)t.some((l=>Ha(l,i)))||t.push(i);return{arrayValue:{values:t}}}class Eu extends dm{constructor(e){super(),this.elements=e}}function C_(n,e){let t=R_(e);for(const i of n.elements)t=t.filter((l=>!Ha(l,i)));return{arrayValue:{values:t}}}class Su extends dm{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Lx(n){return Mn(n.integerValue||n.doubleValue)}function R_(n){return cy(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class A_{constructor(e,t){this.field=e,this.transform=t}}function cA(n,e){return n.field.isEqual(e.field)&&(function(i,l){return i instanceof Tu&&l instanceof Tu||i instanceof Eu&&l instanceof Eu?Xl(i.elements,l.elements,Ha):i instanceof Su&&l instanceof Su?Ha(i.Ae,l.Ae):i instanceof ju&&l instanceof ju})(n.transform,e.transform)}class uA{constructor(e,t){this.version=e,this.transformResults=t}}class Rr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Rr}static exists(e){return new Rr(void 0,e)}static updateTime(e){return new Rr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function jh(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class hm{}function M_(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new mm(n.key,Rr.none()):new Ou(n.key,n.data,Rr.none());{const t=n.data,i=Vr.empty();let l=new $n(or.comparator);for(let u of e.fields)if(!l.has(u)){let d=t.field(u);d===null&&u.length>1&&(u=u.popLast(),d=t.field(u)),d===null?i.delete(u):i.set(u,d),l=l.add(u)}return new bo(n.key,i,new Yr(l.toArray()),Rr.none())}}function dA(n,e,t){n instanceof Ou?(function(l,u,d){const p=l.value.clone(),g=Bx(l.fieldTransforms,u,d.transformResults);p.setAll(g),u.convertToFoundDocument(d.version,p).setHasCommittedMutations()})(n,e,t):n instanceof bo?(function(l,u,d){if(!jh(l.precondition,u))return void u.convertToUnknownDocument(d.version);const p=Bx(l.fieldTransforms,u,d.transformResults),g=u.data;g.setAll(I_(l)),g.setAll(p),u.convertToFoundDocument(d.version,g).setHasCommittedMutations()})(n,e,t):(function(l,u,d){u.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function mu(n,e,t,i){return n instanceof Ou?(function(u,d,p,g){if(!jh(u.precondition,d))return p;const y=u.value.clone(),x=Vx(u.fieldTransforms,g,d);return y.setAll(x),d.convertToFoundDocument(d.version,y).setHasLocalMutations(),null})(n,e,t,i):n instanceof bo?(function(u,d,p,g){if(!jh(u.precondition,d))return p;const y=Vx(u.fieldTransforms,g,d),x=d.data;return x.setAll(I_(u)),x.setAll(y),d.convertToFoundDocument(d.version,x).setHasLocalMutations(),p===null?null:p.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((j=>j.field)))})(n,e,t,i):(function(u,d,p){return jh(u.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):p})(n,e,t)}function hA(n,e){let t=null;for(const i of n.fieldTransforms){const l=e.data.field(i.field),u=S_(i.transform,l||null);u!=null&&(t===null&&(t=Vr.empty()),t.set(i.field,u))}return t||null}function Ox(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,l){return i===void 0&&l===void 0||!(!i||!l)&&Xl(i,l,((u,d)=>cA(u,d)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Ou extends hm{constructor(e,t,i,l=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=l,this.type=0}getFieldMask(){return null}}class bo extends hm{constructor(e,t,i,l,u=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=l,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function I_(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function Bx(n,e,t){const i=new Map;Fs(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let l=0;l<t.length;l++){const u=n[l],d=u.transform,p=e.data.field(u.field);i.set(u.field,lA(d,p,t[l]))}return i}function Vx(n,e,t){const i=new Map;for(const l of n){const u=l.transform,d=t.data.field(l.field);i.set(l.field,oA(u,d,e))}return i}class mm extends hm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class mA extends hm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class fA{constructor(e,t,i,l){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=l}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let l=0;l<this.mutations.length;l++){const u=this.mutations[l];u.key.isEqual(e.key)&&dA(u,e,i[l])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=mu(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=mu(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=j_();return this.mutations.forEach((l=>{const u=e.get(l.key),d=u.overlayedDocument;let p=this.applyToLocalView(d,u.mutatedFields);p=t.has(l.key)?null:p;const g=M_(d,p);g!==null&&i.set(l.key,g),d.isValidDocument()||d.convertToNoDocument(Jt.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),xs())}isEqual(e){return this.batchId===e.batchId&&Xl(this.mutations,e.mutations,((t,i)=>Ox(t,i)))&&Xl(this.baseMutations,e.baseMutations,((t,i)=>Ox(t,i)))}}class my{constructor(e,t,i,l){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=l}static from(e,t,i){Fs(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let l=(function(){return nA})();const u=e.mutations;for(let d=0;d<u.length;d++)l=l.insert(u[d].key,i[d].version);return new my(e,t,i,l)}}class pA{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class gA{constructor(e,t){this.count=e,this.unchangedNames=t}}var Vn,Ts;function yA(n){switch(n){case Re.OK:return Vt(64938);case Re.CANCELLED:case Re.UNKNOWN:case Re.DEADLINE_EXCEEDED:case Re.RESOURCE_EXHAUSTED:case Re.INTERNAL:case Re.UNAVAILABLE:case Re.UNAUTHENTICATED:return!1;case Re.INVALID_ARGUMENT:case Re.NOT_FOUND:case Re.ALREADY_EXISTS:case Re.PERMISSION_DENIED:case Re.FAILED_PRECONDITION:case Re.ABORTED:case Re.OUT_OF_RANGE:case Re.UNIMPLEMENTED:case Re.DATA_LOSS:return!0;default:return Vt(15467,{code:n})}}function D_(n){if(n===void 0)return bi("GRPC error has no .code"),Re.UNKNOWN;switch(n){case Vn.OK:return Re.OK;case Vn.CANCELLED:return Re.CANCELLED;case Vn.UNKNOWN:return Re.UNKNOWN;case Vn.DEADLINE_EXCEEDED:return Re.DEADLINE_EXCEEDED;case Vn.RESOURCE_EXHAUSTED:return Re.RESOURCE_EXHAUSTED;case Vn.INTERNAL:return Re.INTERNAL;case Vn.UNAVAILABLE:return Re.UNAVAILABLE;case Vn.UNAUTHENTICATED:return Re.UNAUTHENTICATED;case Vn.INVALID_ARGUMENT:return Re.INVALID_ARGUMENT;case Vn.NOT_FOUND:return Re.NOT_FOUND;case Vn.ALREADY_EXISTS:return Re.ALREADY_EXISTS;case Vn.PERMISSION_DENIED:return Re.PERMISSION_DENIED;case Vn.FAILED_PRECONDITION:return Re.FAILED_PRECONDITION;case Vn.ABORTED:return Re.ABORTED;case Vn.OUT_OF_RANGE:return Re.OUT_OF_RANGE;case Vn.UNIMPLEMENTED:return Re.UNIMPLEMENTED;case Vn.DATA_LOSS:return Re.DATA_LOSS;default:return Vt(39323,{code:n})}}(Ts=Vn||(Vn={}))[Ts.OK=0]="OK",Ts[Ts.CANCELLED=1]="CANCELLED",Ts[Ts.UNKNOWN=2]="UNKNOWN",Ts[Ts.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ts[Ts.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ts[Ts.NOT_FOUND=5]="NOT_FOUND",Ts[Ts.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ts[Ts.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ts[Ts.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ts[Ts.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ts[Ts.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ts[Ts.ABORTED=10]="ABORTED",Ts[Ts.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ts[Ts.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ts[Ts.INTERNAL=13]="INTERNAL",Ts[Ts.UNAVAILABLE=14]="UNAVAILABLE",Ts[Ts.DATA_LOSS=15]="DATA_LOSS";function bA(){return new TextEncoder}const vA=new ao([4294967295,4294967295],0);function Ux(n){const e=bA().encode(n),t=new Gw;return t.update(e),new Uint8Array(t.digest())}function Fx(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),l=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new ao([t,i],0),new ao([l,u],0)]}class fy{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new iu(`Invalid padding: ${t}`);if(i<0)throw new iu(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new iu(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new iu(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=ao.fromNumber(this.ge)}ye(e,t,i){let l=e.add(t.multiply(ao.fromNumber(i)));return l.compare(vA)===1&&(l=new ao([l.getBits(0),l.getBits(1)],0)),l.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Ux(e),[i,l]=Fx(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);if(!this.we(d))return!1}return!0}static create(e,t,i){const l=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),d=new fy(u,l,t);return i.forEach((p=>d.insert(p))),d}insert(e){if(this.ge===0)return;const t=Ux(e),[i,l]=Fx(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);this.be(d)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class iu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class fm{constructor(e,t,i,l,u){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=l,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const l=new Map;return l.set(e,Bu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new fm(Jt.min(),l,new pn(vs),vi(),xs())}}class Bu{constructor(e,t,i,l,u){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=l,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Bu(i,t,xs(),xs(),xs())}}class Th{constructor(e,t,i,l){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=l}}class P_{constructor(e,t){this.targetId=e,this.Ce=t}}class L_{constructor(e,t,i=lr.EMPTY_BYTE_STRING,l=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=l}}class zx{constructor(){this.ve=0,this.Fe=qx(),this.Me=lr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=xs(),t=xs(),i=xs();return this.Fe.forEach(((l,u)=>{switch(u){case 0:e=e.add(l);break;case 2:t=t.add(l);break;case 1:i=i.add(l);break;default:Vt(38017,{changeType:u})}})),new Bu(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=qx()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Fs(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class xA{constructor(e){this.Ge=e,this.ze=new Map,this.je=vi(),this.He=ah(),this.Je=ah(),this.Ze=new pn(vs)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:Vt(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,l)=>{this.rt(l)&&t(l)}))}st(e){const t=e.targetId,i=e.Ce.count,l=this.ot(t);if(l){const u=l.target;if(wg(u))if(i===0){const d=new Ct(u.path);this.et(t,d,yr.newNoDocument(d,Jt.min()))}else Fs(i===1,20013,{expectedCount:i});else{const d=this._t(t);if(d!==i){const p=this.ut(e),g=p?this.ct(p,e,d):1;if(g!==0){this.it(t);const y=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,y)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:l=0},hashCount:u=0}=t;let d,p;try{d=uo(i).toUint8Array()}catch(g){if(g instanceof a_)return Ql("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{p=new fy(d,l,u)}catch(g){return Ql(g instanceof iu?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return p.ge===0?null:p}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let l=0;return i.forEach((u=>{const d=this.Ge.ht(),p=`projects/${d.projectId}/databases/${d.database}/documents/${u.path.canonicalString()}`;e.mightContain(p)||(this.et(t,u,null),l++)})),l}Tt(e){const t=new Map;this.ze.forEach(((u,d)=>{const p=this.ot(d);if(p){if(u.current&&wg(p.target)){const g=new Ct(p.target.path);this.It(g).has(d)||this.Et(d,g)||this.et(d,g,yr.newNoDocument(g,e))}u.Be&&(t.set(d,u.ke()),u.Ke())}}));let i=xs();this.Je.forEach(((u,d)=>{let p=!0;d.forEachWhile((g=>{const y=this.ot(g);return!y||y.purpose==="TargetPurposeLimboResolution"||(p=!1,!1)})),p&&(i=i.add(u))})),this.je.forEach(((u,d)=>d.setReadTime(e)));const l=new fm(e,t,this.Ze,this.je,i);return this.je=vi(),this.He=ah(),this.Je=ah(),this.Ze=new pn(vs),l}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const l=this.nt(e);this.Et(e,t)?l.qe(t,1):l.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new zx,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new $n(vs),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new $n(vs),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||ht("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new zx),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function ah(){return new pn(Ct.comparator)}function qx(){return new pn(Ct.comparator)}const wA={asc:"ASCENDING",desc:"DESCENDING"},_A={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},kA={and:"AND",or:"OR"};class jA{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function kg(n,e){return n.useProto3Json||im(e)?e:{value:e}}function zh(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function O_(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function TA(n,e){return zh(n,e.toTimestamp())}function za(n){return Fs(!!n,49232),Jt.fromTimestamp((function(t){const i=co(t);return new _t(i.seconds,i.nanos)})(n))}function py(n,e){return jg(n,e).canonicalString()}function jg(n,e){const t=(function(l){return new an(["projects",l.projectId,"databases",l.database])})(n).child("documents");return e===void 0?t:t.child(e)}function B_(n){const e=an.fromString(n);return Fs(q_(e),10190,{key:e.toString()}),e}function Tg(n,e){return py(n.databaseId,e.path)}function Pp(n,e){const t=B_(e);if(t.get(1)!==n.databaseId.projectId)throw new at(Re.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new at(Re.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ct(U_(t))}function V_(n,e){return py(n.databaseId,e)}function EA(n){const e=B_(n);return e.length===4?an.emptyPath():U_(e)}function Eg(n){return new an(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function U_(n){return Fs(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Hx(n,e,t){return{name:Tg(n,e),fields:t.value.mapValue.fields}}function SA(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:Vt(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),l=e.targetChange.targetIds||[],u=(function(y,x){return y.useProto3Json?(Fs(x===void 0||typeof x=="string",58123),lr.fromBase64String(x||"")):(Fs(x===void 0||x instanceof Buffer||x instanceof Uint8Array,16193),lr.fromUint8Array(x||new Uint8Array))})(n,e.targetChange.resumeToken),d=e.targetChange.cause,p=d&&(function(y){const x=y.code===void 0?Re.UNKNOWN:D_(y.code);return new at(x,y.message||"")})(d);t=new L_(i,l,u,p||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const l=Pp(n,i.document.name),u=za(i.document.updateTime),d=i.document.createTime?za(i.document.createTime):Jt.min(),p=new Vr({mapValue:{fields:i.document.fields}}),g=yr.newFoundDocument(l,u,d,p),y=i.targetIds||[],x=i.removedTargetIds||[];t=new Th(y,x,g.key,g)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const l=Pp(n,i.document),u=i.readTime?za(i.readTime):Jt.min(),d=yr.newNoDocument(l,u),p=i.removedTargetIds||[];t=new Th([],p,d.key,d)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const l=Pp(n,i.document),u=i.removedTargetIds||[];t=new Th([],u,l,null)}else{if(!("filter"in e))return Vt(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:l=0,unchangedNames:u}=i,d=new gA(l,u),p=i.targetId;t=new P_(p,d)}}return t}function NA(n,e){let t;if(e instanceof Ou)t={update:Hx(n,e.key,e.value)};else if(e instanceof mm)t={delete:Tg(n,e.key)};else if(e instanceof bo)t={update:Hx(n,e.key,e.data),updateMask:OA(e.fieldMask)};else{if(!(e instanceof mA))return Vt(16599,{dt:e.type});t={verify:Tg(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(u,d){const p=d.transform;if(p instanceof ju)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(p instanceof Tu)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:p.elements}};if(p instanceof Eu)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:p.elements}};if(p instanceof Su)return{fieldPath:d.field.canonicalString(),increment:p.Ae};throw Vt(20930,{transform:d.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(l,u){return u.updateTime!==void 0?{updateTime:TA(l,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:Vt(27497)})(n,e.precondition)),t}function CA(n,e){return n&&n.length>0?(Fs(e!==void 0,14353),n.map((t=>(function(l,u){let d=l.updateTime?za(l.updateTime):za(u);return d.isEqual(Jt.min())&&(d=za(u)),new uA(d,l.transformResults||[])})(t,e)))):[]}function RA(n,e){return{documents:[V_(n,e.path)]}}function AA(n,e){const t={structuredQuery:{}},i=e.path;let l;e.collectionGroup!==null?(l=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(l=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=V_(n,l);const u=(function(y){if(y.length!==0)return z_(ja.create(y,"and"))})(e.filters);u&&(t.structuredQuery.where=u);const d=(function(y){if(y.length!==0)return y.map((x=>(function(T){return{field:zl(T.field),direction:DA(T.dir)}})(x)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const p=kg(n,e.limit);return p!==null&&(t.structuredQuery.limit=p),e.startAt&&(t.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{ft:t,parent:l}}function MA(n){let e=EA(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let l=null;if(i>0){Fs(i===1,65062);const x=t.from[0];x.allDescendants?l=x.collectionId:e=e.child(x.collectionId)}let u=[];t.where&&(u=(function(j){const T=F_(j);return T instanceof ja&&p_(T)?T.getFilters():[T]})(t.where));let d=[];t.orderBy&&(d=(function(j){return j.map((T=>(function($){return new ku(ql($.field),(function(V){switch(V){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})($.direction))})(T)))})(t.orderBy));let p=null;t.limit&&(p=(function(j){let T;return T=typeof j=="object"?j.value:j,im(T)?null:T})(t.limit));let g=null;t.startAt&&(g=(function(j){const T=!!j.before,B=j.values||[];return new Uh(B,T)})(t.startAt));let y=null;return t.endAt&&(y=(function(j){const T=!j.before,B=j.values||[];return new Uh(B,T)})(t.endAt)),QR(e,l,d,u,p,"F",g,y)}function IA(n,e){const t=(function(l){switch(l){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Vt(28987,{purpose:l})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function F_(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=ql(t.unaryFilter.field);return Un.create(i,"==",{doubleValue:NaN});case"IS_NULL":const l=ql(t.unaryFilter.field);return Un.create(l,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=ql(t.unaryFilter.field);return Un.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=ql(t.unaryFilter.field);return Un.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Vt(61313);default:return Vt(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Un.create(ql(t.fieldFilter.field),(function(l){switch(l){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Vt(58110);default:return Vt(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return ja.create(t.compositeFilter.filters.map((i=>F_(i))),(function(l){switch(l){case"AND":return"and";case"OR":return"or";default:return Vt(1026)}})(t.compositeFilter.op))})(n):Vt(30097,{filter:n})}function DA(n){return wA[n]}function PA(n){return _A[n]}function LA(n){return kA[n]}function zl(n){return{fieldPath:n.canonicalString()}}function ql(n){return or.fromServerFormat(n.fieldPath)}function z_(n){return n instanceof Un?(function(t){if(t.op==="=="){if(Ax(t.value))return{unaryFilter:{field:zl(t.field),op:"IS_NAN"}};if(Rx(t.value))return{unaryFilter:{field:zl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Ax(t.value))return{unaryFilter:{field:zl(t.field),op:"IS_NOT_NAN"}};if(Rx(t.value))return{unaryFilter:{field:zl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:zl(t.field),op:PA(t.op),value:t.value}}})(n):n instanceof ja?(function(t){const i=t.getFilters().map((l=>z_(l)));return i.length===1?i[0]:{compositeFilter:{op:LA(t.op),filters:i}}})(n):Vt(54877,{filter:n})}function OA(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function q_(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function H_(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}class eo{constructor(e,t,i,l,u=Jt.min(),d=Jt.min(),p=lr.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=l,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=p,this.expectedCount=g}withSequenceNumber(e){return new eo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new eo(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new eo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new eo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class BA{constructor(e){this.yt=e}}function VA(n){const e=MA({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Fh(e,e.limit,"L"):e}class UA{constructor(){this.Sn=new FA}addToCollectionParentIndex(e,t){return this.Sn.add(t),Be.resolve()}getCollectionParents(e,t){return Be.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return Be.resolve()}deleteFieldIndex(e,t){return Be.resolve()}deleteAllFieldIndexes(e){return Be.resolve()}createTargetIndexes(e,t){return Be.resolve()}getDocumentsMatchingTarget(e,t){return Be.resolve(null)}getIndexType(e,t){return Be.resolve(0)}getFieldIndexes(e,t){return Be.resolve([])}getNextCollectionGroupToUpdate(e){return Be.resolve(null)}getMinOffset(e,t){return Be.resolve(lo.min())}getMinOffsetFromCollectionGroup(e,t){return Be.resolve(lo.min())}updateCollectionGroup(e,t,i){return Be.resolve()}updateIndexEntries(e,t){return Be.resolve()}}class FA{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t]||new $n(an.comparator),u=!l.has(i);return this.index[t]=l.add(i),u}has(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t];return l&&l.has(i)}getEntries(e){return(this.index[e]||new $n(an.comparator)).toArray()}}const $x={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},$_=41943040;class Br{static withCacheSize(e){return new Br(e,Br.DEFAULT_COLLECTION_PERCENTILE,Br.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}Br.DEFAULT_COLLECTION_PERCENTILE=10,Br.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Br.DEFAULT=new Br($_,Br.DEFAULT_COLLECTION_PERCENTILE,Br.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Br.DISABLED=new Br(-1,0,0);class ec{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new ec(0)}static ar(){return new ec(-1)}}const Wx="LruGarbageCollector",zA=1048576;function Gx([n,e],[t,i]){const l=vs(n,t);return l===0?vs(e,i):l}class qA{constructor(e){this.Pr=e,this.buffer=new $n(Gx),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();Gx(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class HA{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){ht(Wx,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){lc(t)?ht(Wx,"Ignoring IndexedDB error during garbage collection: ",t):await oc(t)}await this.Ar(3e5)}))}}class $A{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Be.resolve(am.ce);const i=new qA(t);return this.Vr.forEachTarget(e,(l=>i.Er(l.sequenceNumber))).next((()=>this.Vr.mr(e,(l=>i.Er(l))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ht("LruGarbageCollector","Garbage collection skipped; disabled"),Be.resolve($x)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(ht("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),$x):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,l,u,d,p,g,y;const x=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((j=>(j>this.params.maximumSequenceNumbersToCollect?(ht("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${j}`),l=this.params.maximumSequenceNumbersToCollect):l=j,d=Date.now(),this.nthSequenceNumber(e,l)))).next((j=>(i=j,p=Date.now(),this.removeTargets(e,i,t)))).next((j=>(u=j,g=Date.now(),this.removeOrphanedDocuments(e,i)))).next((j=>(y=Date.now(),Ul()<=bs.DEBUG&&ht("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-x}ms
	Determined least recently used ${l} in `+(p-d)+`ms
	Removed ${u} targets in `+(g-p)+`ms
	Removed ${j} documents in `+(y-g)+`ms
Total Duration: ${y-x}ms`),Be.resolve({didRun:!0,sequenceNumbersCollected:l,targetsRemoved:u,documentsRemoved:j}))))}}function WA(n,e){return new $A(n,e)}class GA{constructor(){this.changes=new el((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,yr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Be.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class KA{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class YA{constructor(e,t,i,l){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=l}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((l=>(i=l,this.remoteDocumentCache.getEntry(e,t)))).next((l=>(i!==null&&mu(i.mutation,l,Yr.empty(),_t.now()),l)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,xs()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=xs()){const l=Vo();return this.populateOverlays(e,l,t).next((()=>this.computeViews(e,t,l,i).next((u=>{let d=au();return u.forEach(((p,g)=>{d=d.insert(p,g.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const i=Vo();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,xs())))}populateOverlays(e,t,i){const l=[];return i.forEach((u=>{t.has(u)||l.push(u)})),this.documentOverlayCache.getOverlays(e,l).next((u=>{u.forEach(((d,p)=>{t.set(d,p)}))}))}computeViews(e,t,i,l){let u=vi();const d=hu(),p=(function(){return hu()})();return t.forEach(((g,y)=>{const x=i.get(y.key);l.has(y.key)&&(x===void 0||x.mutation instanceof bo)?u=u.insert(y.key,y):x!==void 0?(d.set(y.key,x.mutation.getFieldMask()),mu(x.mutation,y,x.mutation.getFieldMask(),_t.now())):d.set(y.key,Yr.empty())})),this.recalculateAndSaveOverlays(e,u).next((g=>(g.forEach(((y,x)=>d.set(y,x))),t.forEach(((y,x)=>p.set(y,new KA(x,d.get(y)??null)))),p)))}recalculateAndSaveOverlays(e,t){const i=hu();let l=new pn(((d,p)=>d-p)),u=xs();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const p of d)p.keys().forEach((g=>{const y=t.get(g);if(y===null)return;let x=i.get(g)||Yr.empty();x=p.applyToLocalView(y,x),i.set(g,x);const j=(l.get(p.batchId)||xs()).add(g);l=l.insert(p.batchId,j)}))})).next((()=>{const d=[],p=l.getReverseIterator();for(;p.hasNext();){const g=p.getNext(),y=g.key,x=g.value,j=j_();x.forEach((T=>{if(!u.has(T)){const B=M_(t.get(T),i.get(T));B!==null&&j.set(T,B),u=u.add(T)}})),d.push(this.documentOverlayCache.saveOverlays(e,y,j))}return Be.waitFor(d)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,l){return XR(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):v_(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,l):this.getDocumentsMatchingCollectionQuery(e,t,i,l)}getNextDocuments(e,t,i,l){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,l).next((u=>{const d=l-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,l-u.size):Be.resolve(Vo());let p=vu,g=u;return d.next((y=>Be.forEach(y,((x,j)=>(p<j.largestBatchId&&(p=j.largestBatchId),u.get(x)?Be.resolve():this.remoteDocumentCache.getEntry(e,x).next((T=>{g=g.insert(x,T)}))))).next((()=>this.populateOverlays(e,y,u))).next((()=>this.computeViews(e,g,y,xs()))).next((x=>({batchId:p,changes:k_(x)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ct(t)).next((i=>{let l=au();return i.isFoundDocument()&&(l=l.insert(i.key,i)),l}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,l){const u=t.collectionGroup;let d=au();return this.indexManager.getCollectionParents(e,u).next((p=>Be.forEach(p,(g=>{const y=(function(j,T){return new cc(T,null,j.explicitOrderBy.slice(),j.filters.slice(),j.limit,j.limitType,j.startAt,j.endAt)})(t,g.child(u));return this.getDocumentsMatchingCollectionQuery(e,y,i,l).next((x=>{x.forEach(((j,T)=>{d=d.insert(j,T)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,i,l){let u;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((d=>(u=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,u,l)))).next((d=>{u.forEach(((g,y)=>{const x=y.getKey();d.get(x)===null&&(d=d.insert(x,yr.newInvalidDocument(x)))}));let p=au();return d.forEach(((g,y)=>{const x=u.get(g);x!==void 0&&mu(x.mutation,y,Yr.empty(),_t.now()),um(t,y)&&(p=p.insert(g,y))})),p}))}}class QA{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return Be.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(l){return{id:l.id,version:l.version,createTime:za(l.createTime)}})(t)),Be.resolve()}getNamedQuery(e,t){return Be.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(l){return{name:l.name,query:VA(l.bundledQuery),readTime:za(l.readTime)}})(t)),Be.resolve()}}class XA{constructor(){this.overlays=new pn(Ct.comparator),this.Lr=new Map}getOverlay(e,t){return Be.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Vo();return Be.forEach(t,(l=>this.getOverlay(e,l).next((u=>{u!==null&&i.set(l,u)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((l,u)=>{this.bt(e,t,u)})),Be.resolve()}removeOverlaysForBatchId(e,t,i){const l=this.Lr.get(i);return l!==void 0&&(l.forEach((u=>this.overlays=this.overlays.remove(u))),this.Lr.delete(i)),Be.resolve()}getOverlaysForCollection(e,t,i){const l=Vo(),u=t.length+1,d=new Ct(t.child("")),p=this.overlays.getIteratorFrom(d);for(;p.hasNext();){const g=p.getNext().value,y=g.getKey();if(!t.isPrefixOf(y.path))break;y.path.length===u&&g.largestBatchId>i&&l.set(g.getKey(),g)}return Be.resolve(l)}getOverlaysForCollectionGroup(e,t,i,l){let u=new pn(((y,x)=>y-x));const d=this.overlays.getIterator();for(;d.hasNext();){const y=d.getNext().value;if(y.getKey().getCollectionGroup()===t&&y.largestBatchId>i){let x=u.get(y.largestBatchId);x===null&&(x=Vo(),u=u.insert(y.largestBatchId,x)),x.set(y.getKey(),y)}}const p=Vo(),g=u.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((y,x)=>p.set(y,x))),!(p.size()>=l)););return Be.resolve(p)}bt(e,t,i){const l=this.overlays.get(i.key);if(l!==null){const d=this.Lr.get(l.largestBatchId).delete(i.key);this.Lr.set(l.largestBatchId,d)}this.overlays=this.overlays.insert(i.key,new pA(t,i));let u=this.Lr.get(t);u===void 0&&(u=xs(),this.Lr.set(t,u)),this.Lr.set(t,u.add(i.key))}}class JA{constructor(){this.sessionToken=lr.EMPTY_BYTE_STRING}getSessionToken(e){return Be.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Be.resolve()}}class gy{constructor(){this.kr=new $n(Zn.Kr),this.qr=new $n(Zn.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new Zn(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new Zn(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new Ct(new an([])),i=new Zn(t,e),l=new Zn(t,e+1),u=[];return this.qr.forEachInRange([i,l],(d=>{this.Wr(d),u.push(d.key)})),u}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new Ct(new an([])),i=new Zn(t,e),l=new Zn(t,e+1);let u=xs();return this.qr.forEachInRange([i,l],(d=>{u=u.add(d.key)})),u}containsKey(e){const t=new Zn(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Zn{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return Ct.comparator(e.key,t.key)||vs(e.Hr,t.Hr)}static Ur(e,t){return vs(e.Hr,t.Hr)||Ct.comparator(e.key,t.key)}}class ZA{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new $n(Zn.Kr)}checkEmpty(e){return Be.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,l){const u=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new fA(u,t,i,l);this.mutationQueue.push(d);for(const p of l)this.Jr=this.Jr.add(new Zn(p.key,u)),this.indexManager.addToCollectionParentIndex(e,p.key.path.popLast());return Be.resolve(d)}lookupMutationBatch(e,t){return Be.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,l=this.Xr(i),u=l<0?0:l;return Be.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return Be.resolve(this.mutationQueue.length===0?oy:this.Yn-1)}getAllMutationBatches(e){return Be.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Zn(t,0),l=new Zn(t,Number.POSITIVE_INFINITY),u=[];return this.Jr.forEachInRange([i,l],(d=>{const p=this.Zr(d.Hr);u.push(p)})),Be.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new $n(vs);return t.forEach((l=>{const u=new Zn(l,0),d=new Zn(l,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([u,d],(p=>{i=i.add(p.Hr)}))})),Be.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,l=i.length+1;let u=i;Ct.isDocumentKey(u)||(u=u.child(""));const d=new Zn(new Ct(u),0);let p=new $n(vs);return this.Jr.forEachWhile((g=>{const y=g.key.path;return!!i.isPrefixOf(y)&&(y.length===l&&(p=p.add(g.Hr)),!0)}),d),Be.resolve(this.Yr(p))}Yr(e){const t=[];return e.forEach((i=>{const l=this.Zr(i);l!==null&&t.push(l)})),t}removeMutationBatch(e,t){Fs(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return Be.forEach(t.mutations,(l=>{const u=new Zn(l.key,t.batchId);return i=i.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,l.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new Zn(t,0),l=this.Jr.firstAfterOrEqual(i);return Be.resolve(t.isEqual(l&&l.key))}performConsistencyCheck(e){return this.mutationQueue.length,Be.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class eM{constructor(e){this.ti=e,this.docs=(function(){return new pn(Ct.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,l=this.docs.get(i),u=l?l.size:0,d=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:d}),this.size+=d-u,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Be.resolve(i?i.document.mutableCopy():yr.newInvalidDocument(t))}getEntries(e,t){let i=vi();return t.forEach((l=>{const u=this.docs.get(l);i=i.insert(l,u?u.document.mutableCopy():yr.newInvalidDocument(l))})),Be.resolve(i)}getDocumentsMatchingQuery(e,t,i,l){let u=vi();const d=t.path,p=new Ct(d.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(p);for(;g.hasNext();){const{key:y,value:{document:x}}=g.getNext();if(!d.isPrefixOf(y.path))break;y.path.length>d.length+1||SR(ER(x),i)<=0||(l.has(x.key)||um(t,x))&&(u=u.insert(x.key,x.mutableCopy()))}return Be.resolve(u)}getAllFromCollectionGroup(e,t,i,l){Vt(9500)}ni(e,t){return Be.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new tM(this)}getSize(e){return Be.resolve(this.size)}}class tM extends GA{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,l)=>{l.isValidDocument()?t.push(this.Mr.addEntry(e,l)):this.Mr.removeEntry(i)})),Be.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class sM{constructor(e){this.persistence=e,this.ri=new el((t=>uy(t)),dy),this.lastRemoteSnapshotVersion=Jt.min(),this.highestTargetId=0,this.ii=0,this.si=new gy,this.targetCount=0,this.oi=ec._r()}forEachTarget(e,t){return this.ri.forEach(((i,l)=>t(l))),Be.resolve()}getLastRemoteSnapshotVersion(e){return Be.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Be.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),Be.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),Be.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new ec(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,Be.resolve()}updateTargetData(e,t){return this.lr(t),Be.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,Be.resolve()}removeTargets(e,t,i){let l=0;const u=[];return this.ri.forEach(((d,p)=>{p.sequenceNumber<=t&&i.get(p.targetId)===null&&(this.ri.delete(d),u.push(this.removeMatchingKeysForTargetId(e,p.targetId)),l++)})),Be.waitFor(u).next((()=>l))}getTargetCount(e){return Be.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return Be.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),Be.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const l=this.persistence.referenceDelegate,u=[];return l&&t.forEach((d=>{u.push(l.markPotentiallyOrphaned(e,d))})),Be.waitFor(u)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),Be.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return Be.resolve(i)}containsKey(e,t){return Be.resolve(this.si.containsKey(t))}}class W_{constructor(e,t){this._i={},this.overlays={},this.ai=new am(0),this.ui=!1,this.ui=!0,this.ci=new JA,this.referenceDelegate=e(this),this.li=new sM(this),this.indexManager=new UA,this.remoteDocumentCache=(function(l){return new eM(l)})((i=>this.referenceDelegate.hi(i))),this.serializer=new BA(t),this.Pi=new QA(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new XA,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new ZA(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){ht("MemoryPersistence","Starting transaction:",e);const l=new nM(this.ai.next());return this.referenceDelegate.Ti(),i(l).next((u=>this.referenceDelegate.Ii(l).next((()=>u)))).toPromise().then((u=>(l.raiseOnCommittedEvent(),u)))}Ei(e,t){return Be.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class nM extends CR{constructor(e){super(),this.currentSequenceNumber=e}}class yy{constructor(e){this.persistence=e,this.Ri=new gy,this.Ai=null}static Vi(e){return new yy(e)}get di(){if(this.Ai)return this.Ai;throw Vt(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),Be.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),Be.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),Be.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((l=>this.di.add(l.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((l=>{l.forEach((u=>this.di.add(u.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Be.forEach(this.di,(i=>{const l=Ct.fromPath(i);return this.mi(e,l).next((u=>{u||t.removeEntry(l,Jt.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return Be.or([()=>Be.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class qh{constructor(e,t){this.persistence=e,this.fi=new el((i=>MR(i.path)),((i,l)=>i.isEqual(l))),this.garbageCollector=WA(this,t)}static Vi(e,t){return new qh(e,t)}Ti(){}Ii(e){return Be.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((l=>i+l))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return Be.forEach(this.fi,((i,l)=>this.wr(e,i,l).next((u=>u?Be.resolve():t(l)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const l=this.persistence.getRemoteDocumentCache(),u=l.newChangeBuffer();return l.ni(e,(d=>this.wr(e,d,t).next((p=>{p||(i++,u.removeEntry(d,Jt.min()))})))).next((()=>u.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),Be.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Be.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Be.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),Be.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=_h(e.data.value)),t}wr(e,t,i){return Be.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const l=this.fi.get(t);return Be.resolve(l!==void 0&&l>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class by{constructor(e,t,i,l){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=l}static Es(e,t){let i=xs(),l=xs();for(const u of t.docChanges)switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:l=l.add(u.doc.key)}return new by(e,t.fromCache,i,l)}}class rM{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class aM{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return MS()?8:RR(vr())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,l){const u={result:null};return this.gs(e,t).next((d=>{u.result=d})).next((()=>{if(!u.result)return this.ps(e,t,l,i).next((d=>{u.result=d}))})).next((()=>{if(u.result)return;const d=new rM;return this.ys(e,t,d).next((p=>{if(u.result=p,this.As)return this.ws(e,t,d,p.size)}))})).next((()=>u.result))}ws(e,t,i,l){return i.documentReadCount<this.Vs?(Ul()<=bs.DEBUG&&ht("QueryEngine","SDK will not create cache indexes for query:",Fl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Be.resolve()):(Ul()<=bs.DEBUG&&ht("QueryEngine","Query:",Fl(t),"scans",i.documentReadCount,"local documents and returns",l,"documents as results."),i.documentReadCount>this.ds*l?(Ul()<=bs.DEBUG&&ht("QueryEngine","The SDK decides to create cache indexes for query:",Fl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Fa(t))):Be.resolve())}gs(e,t){if(Px(t))return Be.resolve(null);let i=Fa(t);return this.indexManager.getIndexType(e,i).next((l=>l===0?null:(t.limit!==null&&l===1&&(t=Fh(t,null,"F"),i=Fa(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((u=>{const d=xs(...u);return this.fs.getDocuments(e,d).next((p=>this.indexManager.getMinOffset(e,i).next((g=>{const y=this.bs(t,p);return this.Ss(t,y,d,g.readTime)?this.gs(e,Fh(t,null,"F")):this.Ds(e,y,t,g)}))))})))))}ps(e,t,i,l){return Px(t)||l.isEqual(Jt.min())?Be.resolve(null):this.fs.getDocuments(e,i).next((u=>{const d=this.bs(t,u);return this.Ss(t,d,i,l)?Be.resolve(null):(Ul()<=bs.DEBUG&&ht("QueryEngine","Re-using previous result from %s to execute query: %s",l.toString(),Fl(t)),this.Ds(e,d,t,TR(l,vu)).next((p=>p)))}))}bs(e,t){let i=new $n(w_(e));return t.forEach(((l,u)=>{um(e,u)&&(i=i.add(u))})),i}Ss(e,t,i,l){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const u=e.limitType==="F"?t.last():t.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(l)>0)}ys(e,t,i){return Ul()<=bs.DEBUG&&ht("QueryEngine","Using full collection scan to execute query:",Fl(t)),this.fs.getDocumentsMatchingQuery(e,t,lo.min(),i)}Ds(e,t,i,l){return this.fs.getDocumentsMatchingQuery(e,i,l).next((u=>(t.forEach((d=>{u=u.insert(d.key,d)})),u)))}}const vy="LocalStore",iM=3e8;class oM{constructor(e,t,i,l){this.persistence=e,this.Cs=t,this.serializer=l,this.vs=new pn(vs),this.Fs=new el((u=>uy(u)),dy),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new YA(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function lM(n,e,t,i){return new oM(n,e,t,i)}async function G_(n,e){const t=ts(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let l;return t.mutationQueue.getAllMutationBatches(i).next((u=>(l=u,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((u=>{const d=[],p=[];let g=xs();for(const y of l){d.push(y.batchId);for(const x of y.mutations)g=g.add(x.key)}for(const y of u){p.push(y.batchId);for(const x of y.mutations)g=g.add(x.key)}return t.localDocuments.getDocuments(i,g).next((y=>({Ns:y,removedBatchIds:d,addedBatchIds:p})))}))}))}function cM(n,e){const t=ts(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const l=e.batch.keys(),u=t.xs.newChangeBuffer({trackRemovals:!0});return(function(p,g,y,x){const j=y.batch,T=j.keys();let B=Be.resolve();return T.forEach(($=>{B=B.next((()=>x.getEntry(g,$))).next((F=>{const V=y.docVersions.get($);Fs(V!==null,48541),F.version.compareTo(V)<0&&(j.applyToRemoteDocument(F,y),F.isValidDocument()&&(F.setReadTime(y.commitVersion),x.addEntry(F)))}))})),B.next((()=>p.mutationQueue.removeMutationBatch(g,j)))})(t,i,e,u).next((()=>u.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,l,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(p){let g=xs();for(let y=0;y<p.mutationResults.length;++y)p.mutationResults[y].transformResults.length>0&&(g=g.add(p.batch.mutations[y].key));return g})(e)))).next((()=>t.localDocuments.getDocuments(i,l)))}))}function K_(n){const e=ts(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function uM(n,e){const t=ts(n),i=e.snapshotVersion;let l=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const d=t.xs.newChangeBuffer({trackRemovals:!0});l=t.vs;const p=[];e.targetChanges.forEach(((x,j)=>{const T=l.get(j);if(!T)return;p.push(t.li.removeMatchingKeys(u,x.removedDocuments,j).next((()=>t.li.addMatchingKeys(u,x.addedDocuments,j))));let B=T.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(j)!==null?B=B.withResumeToken(lr.EMPTY_BYTE_STRING,Jt.min()).withLastLimboFreeSnapshotVersion(Jt.min()):x.resumeToken.approximateByteSize()>0&&(B=B.withResumeToken(x.resumeToken,i)),l=l.insert(j,B),(function(F,V,te){return F.resumeToken.approximateByteSize()===0||V.snapshotVersion.toMicroseconds()-F.snapshotVersion.toMicroseconds()>=iM?!0:te.addedDocuments.size+te.modifiedDocuments.size+te.removedDocuments.size>0})(T,B,x)&&p.push(t.li.updateTargetData(u,B))}));let g=vi(),y=xs();if(e.documentUpdates.forEach((x=>{e.resolvedLimboDocuments.has(x)&&p.push(t.persistence.referenceDelegate.updateLimboDocument(u,x))})),p.push(dM(u,d,e.documentUpdates).next((x=>{g=x.Bs,y=x.Ls}))),!i.isEqual(Jt.min())){const x=t.li.getLastRemoteSnapshotVersion(u).next((j=>t.li.setTargetsMetadata(u,u.currentSequenceNumber,i)));p.push(x)}return Be.waitFor(p).next((()=>d.apply(u))).next((()=>t.localDocuments.getLocalViewOfDocuments(u,g,y))).next((()=>g))})).then((u=>(t.vs=l,u)))}function dM(n,e,t){let i=xs(),l=xs();return t.forEach((u=>i=i.add(u))),e.getEntries(n,i).next((u=>{let d=vi();return t.forEach(((p,g)=>{const y=u.get(p);g.isFoundDocument()!==y.isFoundDocument()&&(l=l.add(p)),g.isNoDocument()&&g.version.isEqual(Jt.min())?(e.removeEntry(p,g.readTime),d=d.insert(p,g)):!y.isValidDocument()||g.version.compareTo(y.version)>0||g.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(g),d=d.insert(p,g)):ht(vy,"Ignoring outdated watch update for ",p,". Current version:",y.version," Watch version:",g.version)})),{Bs:d,Ls:l}}))}function hM(n,e){const t=ts(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=oy),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function mM(n,e){const t=ts(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let l;return t.li.getTargetData(i,e).next((u=>u?(l=u,Be.resolve(l)):t.li.allocateTargetId(i).next((d=>(l=new eo(e,d,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,l).next((()=>l)))))))})).then((i=>{const l=t.vs.get(i.targetId);return(l===null||i.snapshotVersion.compareTo(l.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function Sg(n,e,t){const i=ts(n),l=i.vs.get(e),u=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",u,(d=>i.persistence.referenceDelegate.removeTarget(d,l)))}catch(d){if(!lc(d))throw d;ht(vy,`Failed to update sequence numbers for target ${e}: ${d}`)}i.vs=i.vs.remove(e),i.Fs.delete(l.target)}function Kx(n,e,t){const i=ts(n);let l=Jt.min(),u=xs();return i.persistence.runTransaction("Execute query","readwrite",(d=>(function(g,y,x){const j=ts(g),T=j.Fs.get(x);return T!==void 0?Be.resolve(j.vs.get(T)):j.li.getTargetData(y,x)})(i,d,Fa(e)).next((p=>{if(p)return l=p.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(d,p.targetId).next((g=>{u=g}))})).next((()=>i.Cs.getDocumentsMatchingQuery(d,e,t?l:Jt.min(),t?u:xs()))).next((p=>(fM(i,eA(e),p),{documents:p,ks:u})))))}function fM(n,e,t){let i=n.Ms.get(e)||Jt.min();t.forEach(((l,u)=>{u.readTime.compareTo(i)>0&&(i=u.readTime)})),n.Ms.set(e,i)}class Yx{constructor(){this.activeTargetIds=iA()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class pM{constructor(){this.vo=new Yx,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new Yx,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class gM{Mo(e){}shutdown(){}}const Qx="ConnectivityMonitor";class Xx{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){ht(Qx,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){ht(Qx,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let ih=null;function Ng(){return ih===null?ih=(function(){return 268435456+Math.round(2147483648*Math.random())})():ih++,"0x"+ih.toString(16)}const Lp="RestConnection",yM={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class bM{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),l=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${l}`,this.$o=this.databaseId.database===Bh?`project_id=${i}`:`project_id=${i}&database_id=${l}`}Wo(e,t,i,l,u){const d=Ng(),p=this.Qo(e,t.toUriEncodedString());ht(Lp,`Sending RPC '${e}' ${d}:`,p,i);const g={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(g,l,u);const{host:y}=new URL(p),x=po(y);return this.zo(e,p,g,i,x).then((j=>(ht(Lp,`Received RPC '${e}' ${d}: `,j),j)),(j=>{throw Ql(Lp,`RPC '${e}' ${d} failed with error: `,j,"url: ",p,"request:",i),j}))}jo(e,t,i,l,u,d){return this.Wo(e,t,i,l,u)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+ic})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((l,u)=>e[u]=l)),i&&i.headers.forEach(((l,u)=>e[u]=l))}Qo(e,t){const i=yM[e];let l=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(l=`${l}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),l}terminate(){}}class vM{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const pr="WebChannelConnection",Qc=(n,e,t)=>{n.listen(e,(i=>{try{t(i)}catch(l){setTimeout((()=>{throw l}),0)}}))};class Kl extends bM{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Kl.c_){const e=Xw();Qc(e,Qw.STAT_EVENT,(t=>{t.stat===gg.PROXY?ht(pr,"STAT_EVENT: detected buffering proxy"):t.stat===gg.NOPROXY&&ht(pr,"STAT_EVENT: detected no buffering proxy")})),Kl.c_=!0}}zo(e,t,i,l,u){const d=Ng();return new Promise(((p,g)=>{const y=new Kw;y.setWithCredentials(!0),y.listenOnce(Yw.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case wh.NO_ERROR:const j=y.getResponseJson();ht(pr,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(j)),p(j);break;case wh.TIMEOUT:ht(pr,`RPC '${e}' ${d} timed out`),g(new at(Re.DEADLINE_EXCEEDED,"Request time out"));break;case wh.HTTP_ERROR:const T=y.getStatus();if(ht(pr,`RPC '${e}' ${d} failed with status:`,T,"response text:",y.getResponseText()),T>0){let B=y.getResponseJson();Array.isArray(B)&&(B=B[0]);const $=B?.error;if($&&$.status&&$.message){const F=(function(te){const K=te.toLowerCase().replace(/_/g,"-");return Object.values(Re).indexOf(K)>=0?K:Re.UNKNOWN})($.status);g(new at(F,$.message))}else g(new at(Re.UNKNOWN,"Server responded with status "+y.getStatus()))}else g(new at(Re.UNAVAILABLE,"Connection failed."));break;default:Vt(9055,{l_:e,streamId:d,h_:y.getLastErrorCode(),P_:y.getLastError()})}}finally{ht(pr,`RPC '${e}' ${d} completed.`)}}));const x=JSON.stringify(l);ht(pr,`RPC '${e}' ${d} sending request:`,l),y.send(t,"POST",x,i,15)}))}T_(e,t,i){const l=Ng(),u=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=this.createWebChannelTransport(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(p.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Go(p.initMessageHeaders,t,i),p.encodeInitMessageHeaders=!0;const y=u.join("");ht(pr,`Creating RPC '${e}' stream ${l}: ${y}`,p);const x=d.createWebChannel(y,p);this.I_(x);let j=!1,T=!1;const B=new vM({Ho:$=>{T?ht(pr,`Not sending because RPC '${e}' stream ${l} is closed:`,$):(j||(ht(pr,`Opening RPC '${e}' stream ${l} transport.`),x.open(),j=!0),ht(pr,`RPC '${e}' stream ${l} sending:`,$),x.send($))},Jo:()=>x.close()});return Qc(x,ru.EventType.OPEN,(()=>{T||(ht(pr,`RPC '${e}' stream ${l} transport opened.`),B.i_())})),Qc(x,ru.EventType.CLOSE,(()=>{T||(T=!0,ht(pr,`RPC '${e}' stream ${l} transport closed`),B.o_(),this.E_(x))})),Qc(x,ru.EventType.ERROR,($=>{T||(T=!0,Ql(pr,`RPC '${e}' stream ${l} transport errored. Name:`,$.name,"Message:",$.message),B.o_(new at(Re.UNAVAILABLE,"The operation could not be completed")))})),Qc(x,ru.EventType.MESSAGE,($=>{if(!T){const F=$.data[0];Fs(!!F,16349);const V=F,te=V?.error||V[0]?.error;if(te){ht(pr,`RPC '${e}' stream ${l} received error:`,te);const K=te.status;let ae=(function(me){const R=Vn[me];if(R!==void 0)return D_(R)})(K),ye=te.message;ae===void 0&&(ae=Re.INTERNAL,ye="Unknown error status: "+K+" with message "+te.message),T=!0,B.o_(new at(ae,ye)),x.close()}else ht(pr,`RPC '${e}' stream ${l} received:`,F),B.__(F)}})),Kl.u_(),setTimeout((()=>{B.s_()}),0),B}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return Jw()}}function xM(n){return new Kl(n)}function Op(){return typeof document<"u"?document:null}function pm(n){return new jA(n,!0)}Kl.c_=!1;class Y_{constructor(e,t,i=1e3,l=1.5,u=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=l,this.V_=u,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),l=Math.max(0,t-i);l>0&&ht("ExponentialBackoff",`Backing off for ${l} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,l,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const Jx="PersistentStream";class Q_{constructor(e,t,i,l,u,d,p,g){this.Ci=e,this.b_=i,this.S_=l,this.connection=u,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=p,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Y_(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Re.RESOURCE_EXHAUSTED?(bi(t.toString()),bi("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Re.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,l])=>{this.D_===t&&this.G_(i,l)}),(i=>{e((()=>{const l=new at(Re.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(l)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((l=>{i((()=>this.z_(l)))})),this.stream.onMessage((l=>{i((()=>++this.F_==1?this.H_(l):this.onNext(l)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ht(Jx,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(ht(Jx,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class wM extends Q_{constructor(e,t,i,l,u,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=SA(this.serializer,e),i=(function(u){if(!("targetChange"in u))return Jt.min();const d=u.targetChange;return d.targetIds&&d.targetIds.length?Jt.min():d.readTime?za(d.readTime):Jt.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=Eg(this.serializer),t.addTarget=(function(u,d){let p;const g=d.target;if(p=wg(g)?{documents:RA(u,g)}:{query:AA(u,g).ft},p.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){p.resumeToken=O_(u,d.resumeToken);const y=kg(u,d.expectedCount);y!==null&&(p.expectedCount=y)}else if(d.snapshotVersion.compareTo(Jt.min())>0){p.readTime=zh(u,d.snapshotVersion.toTimestamp());const y=kg(u,d.expectedCount);y!==null&&(p.expectedCount=y)}return p})(this.serializer,e);const i=IA(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=Eg(this.serializer),t.removeTarget=e,this.K_(t)}}class _M extends Q_{constructor(e,t,i,l,u,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return Fs(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Fs(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Fs(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=CA(e.writeResults,e.commitTime),i=za(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=Eg(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>NA(this.serializer,i)))};this.K_(t)}}class kM{}class jM extends kM{constructor(e,t,i,l){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=l,this.ia=!1}sa(){if(this.ia)throw new at(Re.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,d])=>this.connection.Wo(e,jg(t,i),l,u,d))).catch((u=>{throw u.name==="FirebaseError"?(u.code===Re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new at(Re.UNKNOWN,u.toString())}))}jo(e,t,i,l,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,p])=>this.connection.jo(e,jg(t,i),l,d,p,u))).catch((d=>{throw d.name==="FirebaseError"?(d.code===Re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new at(Re.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function TM(n,e,t,i){return new jM(n,e,t,i)}class EM{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(bi(t),this.aa=!1):ht("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Qo="RemoteStore";class SM{constructor(e,t,i,l,u){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=u,this.Aa.Mo((d=>{i.enqueueAndForget((async()=>{tl(this)&&(ht(Qo,"Restarting streams for network reachability change."),await(async function(g){const y=ts(g);y.Ea.add(4),await Vu(y),y.Va.set("Unknown"),y.Ea.delete(4),await gm(y)})(this))}))})),this.Va=new EM(i,l)}}async function gm(n){if(tl(n))for(const e of n.Ra)await e(!0)}async function Vu(n){for(const e of n.Ra)await e(!1)}function X_(n,e){const t=ts(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),ky(t)?_y(t):uc(t).O_()&&wy(t,e))}function xy(n,e){const t=ts(n),i=uc(t);t.Ia.delete(e),i.O_()&&J_(t,e),t.Ia.size===0&&(i.O_()?i.L_():tl(t)&&t.Va.set("Unknown"))}function wy(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Jt.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}uc(n).Z_(e)}function J_(n,e){n.da.$e(e),uc(n).X_(e)}function _y(n){n.da=new xA({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),uc(n).start(),n.Va.ua()}function ky(n){return tl(n)&&!uc(n).x_()&&n.Ia.size>0}function tl(n){return ts(n).Ea.size===0}function Z_(n){n.da=void 0}async function NM(n){n.Va.set("Online")}async function CM(n){n.Ia.forEach(((e,t)=>{wy(n,e)}))}async function RM(n,e){Z_(n),ky(n)?(n.Va.ha(e),_y(n)):n.Va.set("Unknown")}async function AM(n,e,t){if(n.Va.set("Online"),e instanceof L_&&e.state===2&&e.cause)try{await(async function(l,u){const d=u.cause;for(const p of u.targetIds)l.Ia.has(p)&&(await l.remoteSyncer.rejectListen(p,d),l.Ia.delete(p),l.da.removeTarget(p))})(n,e)}catch(i){ht(Qo,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Hh(n,i)}else if(e instanceof Th?n.da.Xe(e):e instanceof P_?n.da.st(e):n.da.tt(e),!t.isEqual(Jt.min()))try{const i=await K_(n.localStore);t.compareTo(i)>=0&&await(function(u,d){const p=u.da.Tt(d);return p.targetChanges.forEach(((g,y)=>{if(g.resumeToken.approximateByteSize()>0){const x=u.Ia.get(y);x&&u.Ia.set(y,x.withResumeToken(g.resumeToken,d))}})),p.targetMismatches.forEach(((g,y)=>{const x=u.Ia.get(g);if(!x)return;u.Ia.set(g,x.withResumeToken(lr.EMPTY_BYTE_STRING,x.snapshotVersion)),J_(u,g);const j=new eo(x.target,g,y,x.sequenceNumber);wy(u,j)})),u.remoteSyncer.applyRemoteEvent(p)})(n,t)}catch(i){ht(Qo,"Failed to raise snapshot:",i),await Hh(n,i)}}async function Hh(n,e,t){if(!lc(e))throw e;n.Ea.add(1),await Vu(n),n.Va.set("Offline"),t||(t=()=>K_(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{ht(Qo,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await gm(n)}))}function ek(n,e){return e().catch((t=>Hh(n,t,e)))}async function ym(n){const e=ts(n),t=mo(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:oy;for(;MM(e);)try{const l=await hM(e.localStore,i);if(l===null){e.Ta.length===0&&t.L_();break}i=l.batchId,IM(e,l)}catch(l){await Hh(e,l)}tk(e)&&sk(e)}function MM(n){return tl(n)&&n.Ta.length<10}function IM(n,e){n.Ta.push(e);const t=mo(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function tk(n){return tl(n)&&!mo(n).x_()&&n.Ta.length>0}function sk(n){mo(n).start()}async function DM(n){mo(n).ra()}async function PM(n){const e=mo(n);for(const t of n.Ta)e.ea(t.mutations)}async function LM(n,e,t){const i=n.Ta.shift(),l=my.from(i,e,t);await ek(n,(()=>n.remoteSyncer.applySuccessfulWrite(l))),await ym(n)}async function OM(n,e){e&&mo(n).Y_&&await(async function(i,l){if((function(d){return yA(d)&&d!==Re.ABORTED})(l.code)){const u=i.Ta.shift();mo(i).B_(),await ek(i,(()=>i.remoteSyncer.rejectFailedWrite(u.batchId,l))),await ym(i)}})(n,e),tk(n)&&sk(n)}async function Zx(n,e){const t=ts(n);t.asyncQueue.verifyOperationInProgress(),ht(Qo,"RemoteStore received new credentials");const i=tl(t);t.Ea.add(3),await Vu(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await gm(t)}async function BM(n,e){const t=ts(n);e?(t.Ea.delete(2),await gm(t)):e||(t.Ea.add(2),await Vu(t),t.Va.set("Unknown"))}function uc(n){return n.ma||(n.ma=(function(t,i,l){const u=ts(t);return u.sa(),new wM(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(n.datastore,n.asyncQueue,{Zo:NM.bind(null,n),Yo:CM.bind(null,n),t_:RM.bind(null,n),J_:AM.bind(null,n)}),n.Ra.push((async e=>{e?(n.ma.B_(),ky(n)?_y(n):n.Va.set("Unknown")):(await n.ma.stop(),Z_(n))}))),n.ma}function mo(n){return n.fa||(n.fa=(function(t,i,l){const u=ts(t);return u.sa(),new _M(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:DM.bind(null,n),t_:OM.bind(null,n),ta:PM.bind(null,n),na:LM.bind(null,n)}),n.Ra.push((async e=>{e?(n.fa.B_(),await ym(n)):(await n.fa.stop(),n.Ta.length>0&&(ht(Qo,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class jy{constructor(e,t,i,l,u){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=l,this.removalCallback=u,this.deferred=new fi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,l,u){const d=Date.now()+i,p=new jy(e,t,d,l,u);return p.start(i),p}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new at(Re.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ty(n,e){if(bi("AsyncQueue",`${e}: ${n}`),lc(n))return new at(Re.UNAVAILABLE,`${e}: ${n}`);throw n}class Yl{static emptySet(e){return new Yl(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Ct.comparator(t.key,i.key):(t,i)=>Ct.comparator(t.key,i.key),this.keyedMap=au(),this.sortedSet=new pn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Yl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(!l.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Yl;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class e2{constructor(){this.ga=new pn(Ct.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Vt(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class tc{constructor(e,t,i,l,u,d,p,g,y){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=l,this.mutatedKeys=u,this.fromCache=d,this.syncStateChanged=p,this.excludesMetadataChanges=g,this.hasCachedResults=y}static fromInitialDocuments(e,t,i,l,u){const d=[];return t.forEach((p=>{d.push({type:0,doc:p})})),new tc(e,t,Yl.emptySet(t),d,i,l,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&cm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let l=0;l<t.length;l++)if(t[l].type!==i[l].type||!t[l].doc.isEqual(i[l].doc))return!1;return!0}}class VM{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class UM{constructor(){this.queries=t2(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const l=ts(t),u=l.queries;l.queries=t2(),u.forEach(((d,p)=>{for(const g of p.ba)g.onError(i)}))})(this,new at(Re.ABORTED,"Firestore shutting down"))}}function t2(){return new el((n=>x_(n)),cm)}async function Ey(n,e){const t=ts(n);let i=3;const l=e.query;let u=t.queries.get(l);u?!u.Sa()&&e.Da()&&(i=2):(u=new VM,i=e.Da()?0:1);try{switch(i){case 0:u.wa=await t.onListen(l,!0);break;case 1:u.wa=await t.onListen(l,!1);break;case 2:await t.onFirstRemoteStoreListen(l)}}catch(d){const p=Ty(d,`Initialization of query '${Fl(e.query)}' failed`);return void e.onError(p)}t.queries.set(l,u),u.ba.push(e),e.va(t.onlineState),u.wa&&e.Fa(u.wa)&&Ny(t)}async function Sy(n,e){const t=ts(n),i=e.query;let l=3;const u=t.queries.get(i);if(u){const d=u.ba.indexOf(e);d>=0&&(u.ba.splice(d,1),u.ba.length===0?l=e.Da()?0:1:!u.Sa()&&e.Da()&&(l=2))}switch(l){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function FM(n,e){const t=ts(n);let i=!1;for(const l of e){const u=l.query,d=t.queries.get(u);if(d){for(const p of d.ba)p.Fa(l)&&(i=!0);d.wa=l}}i&&Ny(t)}function zM(n,e,t){const i=ts(n),l=i.queries.get(e);if(l)for(const u of l.ba)u.onError(t);i.queries.delete(e)}function Ny(n){n.Ca.forEach((e=>{e.next()}))}var Cg,s2;(s2=Cg||(Cg={})).Ma="default",s2.Cache="cache";class Cy{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const l of e.docChanges)l.type!==3&&i.push(l);e=new tc(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=tc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Cg.Cache}}class nk{constructor(e){this.key=e}}class rk{constructor(e){this.key=e}}class qM{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=xs(),this.mutatedKeys=xs(),this.eu=w_(e),this.tu=new Yl(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new e2,l=t?t.tu:this.tu;let u=t?t.mutatedKeys:this.mutatedKeys,d=l,p=!1;const g=this.query.limitType==="F"&&l.size===this.query.limit?l.last():null,y=this.query.limitType==="L"&&l.size===this.query.limit?l.first():null;if(e.inorderTraversal(((x,j)=>{const T=l.get(x),B=um(this.query,j)?j:null,$=!!T&&this.mutatedKeys.has(T.key),F=!!B&&(B.hasLocalMutations||this.mutatedKeys.has(B.key)&&B.hasCommittedMutations);let V=!1;T&&B?T.data.isEqual(B.data)?$!==F&&(i.track({type:3,doc:B}),V=!0):this.su(T,B)||(i.track({type:2,doc:B}),V=!0,(g&&this.eu(B,g)>0||y&&this.eu(B,y)<0)&&(p=!0)):!T&&B?(i.track({type:0,doc:B}),V=!0):T&&!B&&(i.track({type:1,doc:T}),V=!0,(g||y)&&(p=!0)),V&&(B?(d=d.add(B),u=F?u.add(x):u.delete(x)):(d=d.delete(x),u=u.delete(x)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const x=this.query.limitType==="F"?d.last():d.first();d=d.delete(x.key),u=u.delete(x.key),i.track({type:1,doc:x})}return{tu:d,iu:i,Ss:p,mutatedKeys:u}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,l){const u=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((x,j)=>(function(B,$){const F=V=>{switch(V){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Vt(20277,{Vt:V})}};return F(B)-F($)})(x.type,j.type)||this.eu(x.doc,j.doc))),this.ou(i),l=l??!1;const p=t&&!l?this._u():[],g=this.Ya.size===0&&this.current&&!l?1:0,y=g!==this.Xa;return this.Xa=g,d.length!==0||y?{snapshot:new tc(this.query,e.tu,u,d,e.mutatedKeys,g===0,y,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:p}:{au:p}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new e2,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=xs(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new rk(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new nk(i))})),t}cu(e){this.Za=e.ks,this.Ya=xs();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return tc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const Ry="SyncEngine";class HM{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class $M{constructor(e){this.key=e,this.hu=!1}}class WM{constructor(e,t,i,l,u,d){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=l,this.currentUser=u,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new el((p=>x_(p)),cm),this.Iu=new Map,this.Eu=new Set,this.Ru=new pn(Ct.comparator),this.Au=new Map,this.Vu=new gy,this.du={},this.mu=new Map,this.fu=ec.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function GM(n,e,t=!0){const i=uk(n);let l;const u=i.Tu.get(e);return u?(i.sharedClientState.addLocalQueryTarget(u.targetId),l=u.view.lu()):l=await ak(i,e,t,!0),l}async function KM(n,e){const t=uk(n);await ak(t,e,!0,!1)}async function ak(n,e,t,i){const l=await mM(n.localStore,Fa(e)),u=l.targetId,d=n.sharedClientState.addLocalQueryTarget(u,t);let p;return i&&(p=await YM(n,e,u,d==="current",l.resumeToken)),n.isPrimaryClient&&t&&X_(n.remoteStore,l),p}async function YM(n,e,t,i,l){n.pu=(j,T,B)=>(async function(F,V,te,K){let ae=V.view.ru(te);ae.Ss&&(ae=await Kx(F.localStore,V.query,!1).then((({documents:R})=>V.view.ru(R,ae))));const ye=K&&K.targetChanges.get(V.targetId),Ae=K&&K.targetMismatches.get(V.targetId)!=null,me=V.view.applyChanges(ae,F.isPrimaryClient,ye,Ae);return r2(F,V.targetId,me.au),me.snapshot})(n,j,T,B);const u=await Kx(n.localStore,e,!0),d=new qM(e,u.ks),p=d.ru(u.documents),g=Bu.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",l),y=d.applyChanges(p,n.isPrimaryClient,g);r2(n,t,y.au);const x=new HM(e,t,d);return n.Tu.set(e,x),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),y.snapshot}async function QM(n,e,t){const i=ts(n),l=i.Tu.get(e),u=i.Iu.get(l.targetId);if(u.length>1)return i.Iu.set(l.targetId,u.filter((d=>!cm(d,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(l.targetId),i.sharedClientState.isActiveQueryTarget(l.targetId)||await Sg(i.localStore,l.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(l.targetId),t&&xy(i.remoteStore,l.targetId),Rg(i,l.targetId)})).catch(oc)):(Rg(i,l.targetId),await Sg(i.localStore,l.targetId,!0))}async function XM(n,e){const t=ts(n),i=t.Tu.get(e),l=t.Iu.get(i.targetId);t.isPrimaryClient&&l.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),xy(t.remoteStore,i.targetId))}async function JM(n,e,t){const i=aI(n);try{const l=await(function(d,p){const g=ts(d),y=_t.now(),x=p.reduce(((B,$)=>B.add($.key)),xs());let j,T;return g.persistence.runTransaction("Locally write mutations","readwrite",(B=>{let $=vi(),F=xs();return g.xs.getEntries(B,x).next((V=>{$=V,$.forEach(((te,K)=>{K.isValidDocument()||(F=F.add(te))}))})).next((()=>g.localDocuments.getOverlayedDocuments(B,$))).next((V=>{j=V;const te=[];for(const K of p){const ae=hA(K,j.get(K.key).overlayedDocument);ae!=null&&te.push(new bo(K.key,ae,h_(ae.value.mapValue),Rr.exists(!0)))}return g.mutationQueue.addMutationBatch(B,y,te,p)})).next((V=>{T=V;const te=V.applyToLocalDocumentSet(j,F);return g.documentOverlayCache.saveOverlays(B,V.batchId,te)}))})).then((()=>({batchId:T.batchId,changes:k_(j)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(l.batchId),(function(d,p,g){let y=d.du[d.currentUser.toKey()];y||(y=new pn(vs)),y=y.insert(p,g),d.du[d.currentUser.toKey()]=y})(i,l.batchId,t),await Uu(i,l.changes),await ym(i.remoteStore)}catch(l){const u=Ty(l,"Failed to persist write");t.reject(u)}}async function ik(n,e){const t=ts(n);try{const i=await uM(t.localStore,e);e.targetChanges.forEach(((l,u)=>{const d=t.Au.get(u);d&&(Fs(l.addedDocuments.size+l.modifiedDocuments.size+l.removedDocuments.size<=1,22616),l.addedDocuments.size>0?d.hu=!0:l.modifiedDocuments.size>0?Fs(d.hu,14607):l.removedDocuments.size>0&&(Fs(d.hu,42227),d.hu=!1))})),await Uu(t,i,e)}catch(i){await oc(i)}}function n2(n,e,t){const i=ts(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const l=[];i.Tu.forEach(((u,d)=>{const p=d.view.va(e);p.snapshot&&l.push(p.snapshot)})),(function(d,p){const g=ts(d);g.onlineState=p;let y=!1;g.queries.forEach(((x,j)=>{for(const T of j.ba)T.va(p)&&(y=!0)})),y&&Ny(g)})(i.eventManager,e),l.length&&i.Pu.J_(l),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function ZM(n,e,t){const i=ts(n);i.sharedClientState.updateQueryState(e,"rejected",t);const l=i.Au.get(e),u=l&&l.key;if(u){let d=new pn(Ct.comparator);d=d.insert(u,yr.newNoDocument(u,Jt.min()));const p=xs().add(u),g=new fm(Jt.min(),new Map,new pn(vs),d,p);await ik(i,g),i.Ru=i.Ru.remove(u),i.Au.delete(e),Ay(i)}else await Sg(i.localStore,e,!1).then((()=>Rg(i,e,t))).catch(oc)}async function eI(n,e){const t=ts(n),i=e.batch.batchId;try{const l=await cM(t.localStore,e);lk(t,i,null),ok(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Uu(t,l)}catch(l){await oc(l)}}async function tI(n,e,t){const i=ts(n);try{const l=await(function(d,p){const g=ts(d);return g.persistence.runTransaction("Reject batch","readwrite-primary",(y=>{let x;return g.mutationQueue.lookupMutationBatch(y,p).next((j=>(Fs(j!==null,37113),x=j.keys(),g.mutationQueue.removeMutationBatch(y,j)))).next((()=>g.mutationQueue.performConsistencyCheck(y))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(y,x,p))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,x))).next((()=>g.localDocuments.getDocuments(y,x)))}))})(i.localStore,e);lk(i,e,t),ok(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Uu(i,l)}catch(l){await oc(l)}}function ok(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function lk(n,e,t){const i=ts(n);let l=i.du[i.currentUser.toKey()];if(l){const u=l.get(e);u&&(t?u.reject(t):u.resolve(),l=l.remove(e)),i.du[i.currentUser.toKey()]=l}}function Rg(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach((i=>{n.Vu.containsKey(i)||ck(n,i)}))}function ck(n,e){n.Eu.delete(e.path.canonicalString());const t=n.Ru.get(e);t!==null&&(xy(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),Ay(n))}function r2(n,e,t){for(const i of t)i instanceof nk?(n.Vu.addReference(i.key,e),sI(n,i)):i instanceof rk?(ht(Ry,"Document no longer in limbo: "+i.key),n.Vu.removeReference(i.key,e),n.Vu.containsKey(i.key)||ck(n,i.key)):Vt(19791,{wu:i})}function sI(n,e){const t=e.key,i=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(i)||(ht(Ry,"New document in limbo: "+t),n.Eu.add(i),Ay(n))}function Ay(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Ct(an.fromString(e)),i=n.fu.next();n.Au.set(i,new $M(t)),n.Ru=n.Ru.insert(t,i),X_(n.remoteStore,new eo(Fa(lm(t.path)),i,"TargetPurposeLimboResolution",am.ce))}}async function Uu(n,e,t){const i=ts(n),l=[],u=[],d=[];i.Tu.isEmpty()||(i.Tu.forEach(((p,g)=>{d.push(i.pu(g,e,t).then((y=>{if((y||t)&&i.isPrimaryClient){const x=y?!y.fromCache:t?.targetChanges.get(g.targetId)?.current;i.sharedClientState.updateQueryState(g.targetId,x?"current":"not-current")}if(y){l.push(y);const x=by.Es(g.targetId,y);u.push(x)}})))})),await Promise.all(d),i.Pu.J_(l),await(async function(g,y){const x=ts(g);try{await x.persistence.runTransaction("notifyLocalViewChanges","readwrite",(j=>Be.forEach(y,(T=>Be.forEach(T.Ts,(B=>x.persistence.referenceDelegate.addReference(j,T.targetId,B))).next((()=>Be.forEach(T.Is,(B=>x.persistence.referenceDelegate.removeReference(j,T.targetId,B)))))))))}catch(j){if(!lc(j))throw j;ht(vy,"Failed to update sequence numbers: "+j)}for(const j of y){const T=j.targetId;if(!j.fromCache){const B=x.vs.get(T),$=B.snapshotVersion,F=B.withLastLimboFreeSnapshotVersion($);x.vs=x.vs.insert(T,F)}}})(i.localStore,u))}async function nI(n,e){const t=ts(n);if(!t.currentUser.isEqual(e)){ht(Ry,"User change. New user:",e.toKey());const i=await G_(t.localStore,e);t.currentUser=e,(function(u,d){u.mu.forEach((p=>{p.forEach((g=>{g.reject(new at(Re.CANCELLED,d))}))})),u.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Uu(t,i.Ns)}}function rI(n,e){const t=ts(n),i=t.Au.get(e);if(i&&i.hu)return xs().add(i.key);{let l=xs();const u=t.Iu.get(e);if(!u)return l;for(const d of u){const p=t.Tu.get(d);l=l.unionWith(p.view.nu)}return l}}function uk(n){const e=ts(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=ik.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=rI.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=ZM.bind(null,e),e.Pu.J_=FM.bind(null,e.eventManager),e.Pu.yu=zM.bind(null,e.eventManager),e}function aI(n){const e=ts(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=eI.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=tI.bind(null,e),e}class $h{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=pm(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return lM(this.persistence,new aM,e.initialUser,this.serializer)}Cu(e){return new W_(yy.Vi,this.serializer)}Du(e){return new pM}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}$h.provider={build:()=>new $h};class iI extends $h{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Fs(this.persistence.referenceDelegate instanceof qh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new HA(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Br.withCacheSize(this.cacheSizeBytes):Br.DEFAULT;return new W_((i=>qh.Vi(i,t)),this.serializer)}}class Ag{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>n2(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=nI.bind(null,this.syncEngine),await BM(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new UM})()}createDatastore(e){const t=pm(e.databaseInfo.databaseId),i=xM(e.databaseInfo);return TM(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,l,u,d,p){return new SM(i,l,u,d,p)})(this.localStore,this.datastore,e.asyncQueue,(t=>n2(this.syncEngine,t,0)),(function(){return Xx.v()?new Xx:new gM})())}createSyncEngine(e,t){return(function(l,u,d,p,g,y,x){const j=new WM(l,u,d,p,g,y);return x&&(j.gu=!0),j})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=ts(t);ht(Qo,"RemoteStore shutting down."),i.Ea.add(5),await Vu(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Ag.provider={build:()=>new Ag};class My{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):bi("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const fo="FirestoreClient";class oI{constructor(e,t,i,l,u){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=l,this.user=gr.UNAUTHENTICATED,this.clientId=iy.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(i,(async d=>{ht(fo,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(i,(d=>(ht(fo,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new fi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=Ty(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Bp(n,e){n.asyncQueue.verifyOperationInProgress(),ht(fo,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async l=>{i.isEqual(l)||(await G_(e.localStore,l),i=l)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function a2(n,e){n.asyncQueue.verifyOperationInProgress();const t=await lI(n);ht(fo,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>Zx(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,l)=>Zx(e.remoteStore,l))),n._onlineComponents=e}async function lI(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ht(fo,"Using user provided OfflineComponentProvider");try{await Bp(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(l){return l.name==="FirebaseError"?l.code===Re.FAILED_PRECONDITION||l.code===Re.UNIMPLEMENTED:!(typeof DOMException<"u"&&l instanceof DOMException)||l.code===22||l.code===20||l.code===11})(t))throw t;Ql("Error using user provided cache. Falling back to memory cache: "+t),await Bp(n,new $h)}}else ht(fo,"Using default OfflineComponentProvider"),await Bp(n,new iI(void 0));return n._offlineComponents}async function dk(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ht(fo,"Using user provided OnlineComponentProvider"),await a2(n,n._uninitializedComponentsProvider._online)):(ht(fo,"Using default OnlineComponentProvider"),await a2(n,new Ag))),n._onlineComponents}function cI(n){return dk(n).then((e=>e.syncEngine))}async function Wh(n){const e=await dk(n),t=e.eventManager;return t.onListen=GM.bind(null,e.syncEngine),t.onUnlisten=QM.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=KM.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=XM.bind(null,e.syncEngine),t}function uI(n,e,t,i){const l=new My(i),u=new Cy(e,l,t);return n.asyncQueue.enqueueAndForget((async()=>Ey(await Wh(n),u))),()=>{l.Nu(),n.asyncQueue.enqueueAndForget((async()=>Sy(await Wh(n),u)))}}function dI(n,e,t={}){const i=new fi;return n.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,y){const x=new My({next:T=>{x.Nu(),d.enqueueAndForget((()=>Sy(u,j)));const B=T.docs.has(p);!B&&T.fromCache?y.reject(new at(Re.UNAVAILABLE,"Failed to get document because the client is offline.")):B&&T.fromCache&&g&&g.source==="server"?y.reject(new at(Re.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(T)},error:T=>y.reject(T)}),j=new Cy(lm(p.path),x,{includeMetadataChanges:!0,Ka:!0});return Ey(u,j)})(await Wh(n),n.asyncQueue,e,t,i))),i.promise}function hI(n,e,t={}){const i=new fi;return n.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,y){const x=new My({next:T=>{x.Nu(),d.enqueueAndForget((()=>Sy(u,j))),T.fromCache&&g.source==="server"?y.reject(new at(Re.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(T)},error:T=>y.reject(T)}),j=new Cy(p,x,{includeMetadataChanges:!0,Ka:!0});return Ey(u,j)})(await Wh(n),n.asyncQueue,e,t,i))),i.promise}function mI(n,e){const t=new fi;return n.asyncQueue.enqueueAndForget((async()=>JM(await cI(n),e,t))),t.promise}function hk(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const fI="ComponentProvider",i2=new Map;function pI(n,e,t,i,l){return new PR(n,e,t,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,hk(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator,i)}const mk="firestore.googleapis.com",o2=!0;class l2{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new at(Re.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=mk,this.ssl=o2}else this.host=e.host,this.ssl=e.ssl??o2;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=$_;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<zA)throw new at(Re.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}kR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=hk(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new at(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new at(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new at(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,l){return i.timeoutSeconds===l.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class bm{constructor(e,t,i,l){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=l,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new l2({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new at(Re.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new at(Re.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new l2(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new mR;switch(i.type){case"firstParty":return new yR(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new at(Re.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=i2.get(t);i&&(ht(fI,"Removing Datastore"),i2.delete(t),i.terminate())})(this),Promise.resolve()}}function gI(n,e,t,i={}){n=Cr(n,bm);const l=po(e),u=n._getSettings(),d={...u,emulatorOptions:n._getEmulatorOptions()},p=`${e}:${t}`;l&&(Hg(`https://${p}`),$g("Firestore",!0)),u.host!==mk&&u.host!==p&&Ql("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...u,host:p,ssl:l,emulatorOptions:i};if(!$o(g,d)&&(n._setSettings(g),i.mockUserToken)){let y,x;if(typeof i.mockUserToken=="string")y=i.mockUserToken,x=gr.MOCK_USER;else{y=ow(i.mockUserToken,n._app?.options.projectId);const j=i.mockUserToken.sub||i.mockUserToken.user_id;if(!j)throw new at(Re.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");x=new gr(j)}n._authCredentials=new fR(new e_(y,x))}}class _i{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new _i(this.firestore,e,this._query)}}class _n{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new io(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new _n(this.firestore,e,this._key)}toJSON(){return{type:_n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Lu(t,_n._jsonSchema))return new _n(e,i||null,new Ct(an.fromString(t.referencePath)))}}_n._jsonSchemaVersion="firestore/documentReference/1.0",_n._jsonSchema={type:Fn("string",_n._jsonSchemaVersion),referencePath:Fn("string")};class io extends _i{constructor(e,t,i){super(e,t,lm(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new _n(this.firestore,null,new Ct(e))}withConverter(e){return new io(this.firestore,e,this._path)}}function Ot(n,e,...t){if(n=Xs(n),t_("collection","path",e),n instanceof bm){const i=an.fromString(e,...t);return wx(i),new io(n,null,i)}{if(!(n instanceof _n||n instanceof io))throw new at(Re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(an.fromString(e,...t));return wx(i),new io(n.firestore,null,i)}}function He(n,e,...t){if(n=Xs(n),arguments.length===1&&(e=iy.newId()),t_("doc","path",e),n instanceof bm){const i=an.fromString(e,...t);return xx(i),new _n(n,null,new Ct(i))}{if(!(n instanceof _n||n instanceof io))throw new at(Re.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(an.fromString(e,...t));return xx(i),new _n(n.firestore,n instanceof io?n.converter:null,new Ct(i))}}const c2="AsyncQueue";class u2{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Y_(this,"async_queue_retry"),this._c=()=>{const i=Op();i&&ht(c2,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Op();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Op();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new fi;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!lc(e))throw e;ht(c2,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,bi("INTERNAL UNHANDLED ERROR: ",d2(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const l=jy.createAndSchedule(this,e,t,i,(u=>this.hc(u)));return this.tc.push(l),l}uc(){this.nc&&Vt(47125,{Pc:d2(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function d2(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class $a extends bm{constructor(e,t,i,l){super(e,t,i,l),this.type="firestore",this._queue=new u2,this._persistenceKey=l?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new u2(e),this._firestoreClient=void 0,await e}}}function yI(n,e){const t=typeof n=="object"?n:Yg(),i=typeof n=="string"?n:Bh,l=em(t,"firestore").getImmediate({identifier:i});if(!l._initialized){const u=rw("firestore");u&&gI(l,...u)}return l}function Fu(n){if(n._terminated)throw new at(Re.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||bI(n),n._firestoreClient}function bI(n){const e=n._freezeSettings(),t=pI(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new oI(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(l){const u=l?._online.build();return{_offline:l?._offline.build(u),_online:u}})(n._componentsProvider))}class oa{constructor(e){this._byteString=e}static fromBase64String(e){try{return new oa(lr.fromBase64String(e))}catch(t){throw new at(Re.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new oa(lr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:oa._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Lu(e,oa._jsonSchema))return oa.fromBase64String(e.bytes)}}oa._jsonSchemaVersion="firestore/bytes/1.0",oa._jsonSchema={type:Fn("string",oa._jsonSchemaVersion),bytes:Fn("string")};class vm{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new at(Re.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new or(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class zu{constructor(e){this._methodName=e}}class qa{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new at(Re.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new at(Re.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return vs(this._lat,e._lat)||vs(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:qa._jsonSchemaVersion}}static fromJSON(e){if(Lu(e,qa._jsonSchema))return new qa(e.latitude,e.longitude)}}qa._jsonSchemaVersion="firestore/geoPoint/1.0",qa._jsonSchema={type:Fn("string",qa._jsonSchemaVersion),latitude:Fn("number"),longitude:Fn("number")};class _a{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,l){if(i.length!==l.length)return!1;for(let u=0;u<i.length;++u)if(i[u]!==l[u])return!1;return!0})(this._values,e._values)}toJSON(){return{type:_a._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Lu(e,_a._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new _a(e.vectorValues);throw new at(Re.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}_a._jsonSchemaVersion="firestore/vectorValue/1.0",_a._jsonSchema={type:Fn("string",_a._jsonSchemaVersion),vectorValues:Fn("object")};const vI=/^__.*__$/;class xI{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new bo(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ou(e,this.data,t,this.fieldTransforms)}}class fk{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new bo(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function pk(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Vt(40011,{dataSource:n})}}class Iy{constructor(e,t,i,l,u,d){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=l,u===void 0&&this.validatePath(),this.fieldTransforms=u||[],this.fieldMask=d||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Iy({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Gh(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(pk(this.dataSource)&&vI.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class wI{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||pm(e)}createContext(e,t,i,l=!1){return new Iy({dataSource:e,methodName:t,targetDoc:i,path:or.emptyPath(),arrayElement:!1,hasConverter:l},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function qu(n){const e=n._freezeSettings(),t=pm(n._databaseId);return new wI(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Dy(n,e,t,i,l,u={}){const d=n.createContext(u.merge||u.mergeFields?2:0,e,t,l);Oy("Data must be an object, but it was:",d,i);const p=bk(i,d);let g,y;if(u.merge)g=new Yr(d.fieldMask),y=d.fieldTransforms;else if(u.mergeFields){const x=[];for(const j of u.mergeFields){const T=Xo(e,j,t);if(!d.contains(T))throw new at(Re.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);wk(x,T)||x.push(T)}g=new Yr(x),y=d.fieldTransforms.filter((j=>g.covers(j.field)))}else g=null,y=d.fieldTransforms;return new xI(new Vr(p),g,y)}class xm extends zu{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof xm}}class Py extends zu{_toFieldTransform(e){return new A_(e.path,new ju)}isEqual(e){return e instanceof Py}}class Ly extends zu{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new Su(e.serializer,E_(e.serializer,this.Vc));return new A_(e.path,t)}isEqual(e){return e instanceof Ly&&this.Vc===e.Vc}}function gk(n,e,t,i){const l=n.createContext(1,e,t);Oy("Data must be an object, but it was:",l,i);const u=[],d=Vr.empty();yo(i,((g,y)=>{const x=xk(e,g,t);y=Xs(y);const j=l.childContextForFieldPath(x);if(y instanceof xm)u.push(x);else{const T=Hu(y,j);T!=null&&(u.push(x),d.set(x,T))}}));const p=new Yr(u);return new fk(d,p,l.fieldTransforms)}function yk(n,e,t,i,l,u){const d=n.createContext(1,e,t),p=[Xo(e,i,t)],g=[l];if(u.length%2!=0)throw new at(Re.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<u.length;T+=2)p.push(Xo(e,u[T])),g.push(u[T+1]);const y=[],x=Vr.empty();for(let T=p.length-1;T>=0;--T)if(!wk(y,p[T])){const B=p[T];let $=g[T];$=Xs($);const F=d.childContextForFieldPath(B);if($ instanceof xm)y.push(B);else{const V=Hu($,F);V!=null&&(y.push(B),x.set(B,V))}}const j=new Yr(y);return new fk(x,j,d.fieldTransforms)}function _I(n,e,t,i=!1){return Hu(t,n.createContext(i?4:3,e))}function Hu(n,e){if(vk(n=Xs(n)))return Oy("Unsupported field value:",e,n),bk(n,e);if(n instanceof zu)return(function(i,l){if(!pk(l.dataSource))throw l.createError(`${i._methodName}() can only be used with update() and set()`);if(!l.path)throw l.createError(`${i._methodName}() is not currently supported inside arrays`);const u=i._toFieldTransform(l);u&&l.fieldTransforms.push(u)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,l){const u=[];let d=0;for(const p of i){let g=Hu(p,l.childContextForArray(d));g==null&&(g={nullValue:"NULL_VALUE"}),u.push(g),d++}return{arrayValue:{values:u}}})(n,e)}return(function(i,l){if((i=Xs(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return E_(l.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const u=_t.fromDate(i);return{timestampValue:zh(l.serializer,u)}}if(i instanceof _t){const u=new _t(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:zh(l.serializer,u)}}if(i instanceof qa)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof oa)return{bytesValue:O_(l.serializer,i._byteString)};if(i instanceof _n){const u=l.databaseId,d=i.firestore._databaseId;if(!d.isEqual(u))throw l.createError(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:py(i.firestore._databaseId||l.databaseId,i._key.path)}}if(i instanceof _a)return(function(d,p){const g=d instanceof _a?d.toArray():d;return{mapValue:{fields:{[u_]:{stringValue:d_},[Vh]:{arrayValue:{values:g.map((x=>{if(typeof x!="number")throw p.createError("VectorValues must only contain numeric values.");return hy(p.serializer,x)}))}}}}}})(i,l);if(H_(i))return i._toProto(l.serializer);throw l.createError(`Unsupported field value: ${rm(i)}`)})(n,e)}function bk(n,e){const t={};return r_(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):yo(n,((i,l)=>{const u=Hu(l,e.childContextForField(i));u!=null&&(t[i]=u)})),{mapValue:{fields:t}}}function vk(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof _t||n instanceof qa||n instanceof oa||n instanceof _n||n instanceof zu||n instanceof _a||H_(n))}function Oy(n,e,t){if(!vk(t)||!s_(t)){const i=rm(t);throw i==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+i)}}function Xo(n,e,t){if((e=Xs(e))instanceof vm)return e._internalPath;if(typeof e=="string")return xk(n,e);throw Gh("Field path arguments must be of type string or ",n,!1,void 0,t)}const kI=new RegExp("[~\\*/\\[\\]]");function xk(n,e,t){if(e.search(kI)>=0)throw Gh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new vm(...e.split("."))._internalPath}catch{throw Gh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Gh(n,e,t,i,l){const u=i&&!i.isEmpty(),d=l!==void 0;let p=`Function ${e}() called with invalid data`;t&&(p+=" (via `toFirestore()`)"),p+=". ";let g="";return(u||d)&&(g+=" (found",u&&(g+=` in field ${i}`),d&&(g+=` in document ${l}`),g+=")"),new at(Re.INVALID_ARGUMENT,p+n+g)}function wk(n,e){return n.some((t=>t.isEqual(e)))}class jI{convertValue(e,t="none"){switch(ho(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Mn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(uo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Vt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return yo(e,((l,u)=>{i[l]=this.convertValue(u,t)})),i}convertVectorValue(e){const t=e.fields?.[Vh].arrayValue?.values?.map((i=>Mn(i.doubleValue)));return new _a(t)}convertGeoPoint(e){return new qa(Mn(e.latitude),Mn(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=om(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(xu(e));default:return null}}convertTimestamp(e){const t=co(e);return new _t(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=an.fromString(e);Fs(q_(i),9688,{name:e});const l=new wu(i.get(1),i.get(3)),u=new Ct(i.popFirst(5));return l.isEqual(t)||bi(`Document ${u} contains a document reference within a different database (${l.projectId}/${l.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),u}}class By extends jI{constructor(e){super(),this.firestore=e}convertBytes(e){return new oa(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new _n(this.firestore,null,t)}}function br(){return new Py("serverTimestamp")}function Uo(n){return new Ly("increment",n)}const h2="@firebase/firestore",m2="4.10.0";function f2(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;const l=t;for(const u of i)if(u in l&&typeof l[u]=="function")return!0;return!1})(n,["next","error","complete"])}class _k{constructor(e,t,i,l,u){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=l,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new _n(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new TI(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(Xo("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class TI extends _k{data(){return super.data()}}function kk(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new at(Re.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Vy{}class Uy extends Vy{}function Os(n,e,...t){let i=[];e instanceof Vy&&i.push(e),i=i.concat(t),(function(u){const d=u.filter((g=>g instanceof Fy)).length,p=u.filter((g=>g instanceof wm)).length;if(d>1||d>0&&p>0)throw new at(Re.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const l of i)n=l._apply(n);return n}class wm extends Uy{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new wm(e,t,i)}_apply(e){const t=this._parse(e);return jk(e._query,t),new _i(e.firestore,e.converter,_g(e._query,t))}_parse(e){const t=qu(e.firestore);return(function(u,d,p,g,y,x,j){let T;if(y.isKeyField()){if(x==="array-contains"||x==="array-contains-any")throw new at(Re.INVALID_ARGUMENT,`Invalid Query. You can't perform '${x}' queries on documentId().`);if(x==="in"||x==="not-in"){g2(j,x);const $=[];for(const F of j)$.push(p2(g,u,F));T={arrayValue:{values:$}}}else T=p2(g,u,j)}else x!=="in"&&x!=="not-in"&&x!=="array-contains-any"||g2(j,x),T=_I(p,d,j,x==="in"||x==="not-in");return Un.create(y,x,T)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function fs(n,e,t){const i=e,l=Xo("where",n);return wm._create(l,i,t)}class Fy extends Vy{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Fy(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:ja.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(l,u){let d=l;const p=u.getFlattenedFilters();for(const g of p)jk(d,g),d=_g(d,g)})(e._query,t),new _i(e.firestore,e.converter,_g(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class zy extends Uy{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new zy(e,t)}_apply(e){const t=(function(l,u,d){if(l.startAt!==null)throw new at(Re.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(l.endAt!==null)throw new at(Re.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ku(u,d)})(e._query,this._field,this._direction);return new _i(e.firestore,e.converter,ZR(e._query,t))}}function Kh(n,e="asc"){const t=e,i=Xo("orderBy",n);return zy._create(i,t)}class qy extends Uy{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new qy(e,t,i)}_apply(e){return new _i(e.firestore,e.converter,Fh(e._query,this._limit,this._limitType))}}function Yh(n){return jR("limit",n),qy._create("limit",n,"F")}function p2(n,e,t){if(typeof(t=Xs(t))=="string"){if(t==="")throw new at(Re.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!v_(e)&&t.indexOf("/")!==-1)throw new at(Re.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(an.fromString(t));if(!Ct.isDocumentKey(i))throw new at(Re.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Cx(n,new Ct(i))}if(t instanceof _n)return Cx(n,t._key);throw new at(Re.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${rm(t)}.`)}function g2(n,e){if(!Array.isArray(n)||n.length===0)throw new at(Re.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function jk(n,e){const t=(function(l,u){for(const d of l)for(const p of d.getFlattenedFilters())if(u.indexOf(p.op)>=0)return p.op;return null})(n.filters,(function(l){switch(l){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new at(Re.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new at(Re.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function Hy(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class ou{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Fo extends _k{constructor(e,t,i,l,u,d){super(e,t,i,l,d),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Eh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(Xo("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new at(Re.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Fo._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Fo._jsonSchemaVersion="firestore/documentSnapshot/1.0",Fo._jsonSchema={type:Fn("string",Fo._jsonSchemaVersion),bundleSource:Fn("string","DocumentSnapshot"),bundleName:Fn("string"),bundle:Fn("string")};class Eh extends Fo{data(e={}){return super.data(e)}}class zo{constructor(e,t,i,l){this._firestore=e,this._userDataWriter=t,this._snapshot=l,this.metadata=new ou(l.hasPendingWrites,l.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Eh(this._firestore,this._userDataWriter,i.key,i,new ou(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new at(Re.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(l,u){if(l._snapshot.oldDocs.isEmpty()){let d=0;return l._snapshot.docChanges.map((p=>{const g=new Eh(l._firestore,l._userDataWriter,p.doc.key,p.doc,new ou(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);return p.doc,{type:"added",doc:g,oldIndex:-1,newIndex:d++}}))}{let d=l._snapshot.oldDocs;return l._snapshot.docChanges.filter((p=>u||p.type!==3)).map((p=>{const g=new Eh(l._firestore,l._userDataWriter,p.doc.key,p.doc,new ou(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);let y=-1,x=-1;return p.type!==0&&(y=d.indexOf(p.doc.key),d=d.delete(p.doc.key)),p.type!==1&&(d=d.add(p.doc),x=d.indexOf(p.doc.key)),{type:EI(p.type),doc:g,oldIndex:y,newIndex:x}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new at(Re.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=zo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=iy.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],l=[];return this.docs.forEach((u=>{u._document!==null&&(t.push(u._document),i.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),l.push(u.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function EI(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Vt(61501,{type:n})}}zo._jsonSchemaVersion="firestore/querySnapshot/1.0",zo._jsonSchema={type:Fn("string",zo._jsonSchemaVersion),bundleSource:Fn("string","QuerySnapshot"),bundleName:Fn("string"),bundle:Fn("string")};class SI{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=qu(e)}set(e,t,i){this._verifyNotCommitted();const l=Vp(e,this._firestore),u=Hy(l.converter,t,i),d=Dy(this._dataReader,"WriteBatch.set",l._key,u,l.converter!==null,i);return this._mutations.push(d.toMutation(l._key,Rr.none())),this}update(e,t,i,...l){this._verifyNotCommitted();const u=Vp(e,this._firestore);let d;return d=typeof(t=Xs(t))=="string"||t instanceof vm?yk(this._dataReader,"WriteBatch.update",u._key,t,i,l):gk(this._dataReader,"WriteBatch.update",u._key,t),this._mutations.push(d.toMutation(u._key,Rr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Vp(e,this._firestore);return this._mutations=this._mutations.concat(new mm(t._key,Rr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new at(Re.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Vp(n,e){if((n=Xs(n)).firestore!==e)throw new at(Re.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}function As(n){n=Cr(n,_n);const e=Cr(n.firestore,$a),t=Fu(e);return dI(t,n._key).then((i=>Ek(e,n,i)))}function Es(n){n=Cr(n,_i);const e=Cr(n.firestore,$a),t=Fu(e),i=new By(e);return kk(n._query),hI(t,n._query).then((l=>new zo(e,i,n,l)))}function Ss(n,e,t){n=Cr(n,_n);const i=Cr(n.firestore,$a),l=Hy(n.converter,e,t),u=qu(i);return $u(i,[Dy(u,"setDoc",n._key,l,n.converter!==null,t).toMutation(n._key,Rr.none())])}function La(n,e,t,...i){n=Cr(n,_n);const l=Cr(n.firestore,$a),u=qu(l);let d;return d=typeof(e=Xs(e))=="string"||e instanceof vm?yk(u,"updateDoc",n._key,e,t,i):gk(u,"updateDoc",n._key,e),$u(l,[d.toMutation(n._key,Rr.exists(!0))])}function Sr(n){return $u(Cr(n.firestore,$a),[new mm(n._key,Rr.none())])}function la(n,e){const t=Cr(n.firestore,$a),i=He(n),l=Hy(n.converter,e),u=qu(n.firestore);return $u(t,[Dy(u,"addDoc",i._key,l,n.converter!==null,{}).toMutation(i._key,Rr.exists(!1))]).then((()=>i))}function Tk(n,...e){n=Xs(n);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||f2(e[i])||(t=e[i++]);const l={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(f2(e[i])){const y=e[i];e[i]=y.next?.bind(y),e[i+1]=y.error?.bind(y),e[i+2]=y.complete?.bind(y)}let u,d,p;if(n instanceof _n)d=Cr(n.firestore,$a),p=lm(n._key.path),u={next:y=>{e[i]&&e[i](Ek(d,n,y))},error:e[i+1],complete:e[i+2]};else{const y=Cr(n,_i);d=Cr(y.firestore,$a),p=y._query;const x=new By(d);u={next:j=>{e[i]&&e[i](new zo(d,x,y,j))},error:e[i+1],complete:e[i+2]},kk(n._query)}const g=Fu(d);return uI(g,p,l,u)}function $u(n,e){const t=Fu(n);return mI(t,e)}function Ek(n,e,t){const i=t.docs.get(e._key),l=new By(n);return new Fo(n,l,e._key,i,new ou(t.hasPendingWrites,t.fromCache),e.converter)}function y2(n){return n=Cr(n,$a),Fu(n),new SI(n,(e=>$u(n,e)))}(function(e,t=!0){hR(Zo),Wo(new oo("firestore",((i,{instanceIdentifier:l,options:u})=>{const d=i.getProvider("app").getImmediate(),p=new $a(new pR(i.getProvider("auth-internal")),new bR(d,i.getProvider("app-check-internal")),LR(d,l),d);return u={useFetchStreams:t,...u},p._setSettings(u),p}),"PUBLIC").setMultipleInstances(!0)),Ba(h2,m2,e),Ba(h2,m2,"esm2020")})();var NI="firebase",CI="12.8.0";Ba(NI,CI,"app");const Sk="firebasestorage.googleapis.com",Nk="storageBucket",RI=120*1e3,AI=600*1e3;class jn extends Wa{constructor(e,t,i=0){super(Up(e),`Firebase Storage: ${t} (${Up(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,jn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Up(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var kn;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(kn||(kn={}));function Up(n){return"storage/"+n}function $y(){const n="An unknown error occurred, please check the error payload for server response.";return new jn(kn.UNKNOWN,n)}function MI(n){return new jn(kn.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function II(n){return new jn(kn.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function DI(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new jn(kn.UNAUTHENTICATED,n)}function PI(){return new jn(kn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function LI(n){return new jn(kn.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function OI(){return new jn(kn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function BI(){return new jn(kn.CANCELED,"User canceled the upload/download.")}function VI(n){return new jn(kn.INVALID_URL,"Invalid URL '"+n+"'.")}function UI(n){return new jn(kn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function FI(){return new jn(kn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Nk+"' property when initializing the app?")}function zI(){return new jn(kn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function qI(){return new jn(kn.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function HI(n){return new jn(kn.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Mg(n){return new jn(kn.INVALID_ARGUMENT,n)}function Ck(){return new jn(kn.APP_DELETED,"The Firebase app was deleted.")}function $I(n){return new jn(kn.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function fu(n,e){return new jn(kn.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Xc(n){throw new jn(kn.INTERNAL_ERROR,"Internal error: "+n)}class Nr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=Nr.makeFromUrl(e,t)}catch{return new Nr(e,"")}if(i.path==="")return i;throw UI(e)}static makeFromUrl(e,t){let i=null;const l="([A-Za-z0-9.\\-_]+)";function u(ye){ye.path.charAt(ye.path.length-1)==="/"&&(ye.path_=ye.path_.slice(0,-1))}const d="(/(.*))?$",p=new RegExp("^gs://"+l+d,"i"),g={bucket:1,path:3};function y(ye){ye.path_=decodeURIComponent(ye.path)}const x="v[A-Za-z0-9_]+",j=t.replace(/[.]/g,"\\."),T="(/([^?#]*).*)?$",B=new RegExp(`^https?://${j}/${x}/b/${l}/o${T}`,"i"),$={bucket:1,path:3},F=t===Sk?"(?:storage.googleapis.com|storage.cloud.google.com)":t,V="([^?#]*)",te=new RegExp(`^https?://${F}/${l}/${V}`,"i"),ae=[{regex:p,indices:g,postModify:u},{regex:B,indices:$,postModify:y},{regex:te,indices:{bucket:1,path:2},postModify:y}];for(let ye=0;ye<ae.length;ye++){const Ae=ae[ye],me=Ae.regex.exec(e);if(me){const R=me[Ae.indices.bucket];let E=me[Ae.indices.path];E||(E=""),i=new Nr(R,E),Ae.postModify(i);break}}if(i==null)throw VI(e);return i}}class WI{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function GI(n,e,t){let i=1,l=null,u=null,d=!1,p=0;function g(){return p===2}let y=!1;function x(...V){y||(y=!0,e.apply(null,V))}function j(V){l=setTimeout(()=>{l=null,n(B,g())},V)}function T(){u&&clearTimeout(u)}function B(V,...te){if(y){T();return}if(V){T(),x.call(null,V,...te);return}if(g()||d){T(),x.call(null,V,...te);return}i<64&&(i*=2);let ae;p===1?(p=2,ae=0):ae=(i+Math.random())*1e3,j(ae)}let $=!1;function F(V){$||($=!0,T(),!y&&(l!==null?(V||(p=2),clearTimeout(l),j(0)):V||(p=1)))}return j(0),u=setTimeout(()=>{d=!0,F(!0)},t),F}function KI(n){n(!1)}function YI(n){return n!==void 0}function QI(n){return typeof n=="object"&&!Array.isArray(n)}function Wy(n){return typeof n=="string"||n instanceof String}function b2(n){return Gy()&&n instanceof Blob}function Gy(){return typeof Blob<"u"}function Ig(n,e,t,i){if(i<e)throw Mg(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw Mg(`Invalid value for '${n}'. Expected ${t} or less.`)}function _m(n,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${n}`}function Rk(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const l=e(i)+"="+e(n[i]);t=t+l+"&"}return t=t.slice(0,-1),t}var qo;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(qo||(qo={}));function XI(n,e){const t=n>=500&&n<600,l=[408,429].indexOf(n)!==-1,u=e.indexOf(n)!==-1;return t||l||u}class JI{constructor(e,t,i,l,u,d,p,g,y,x,j,T=!0,B=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=l,this.successCodes_=u,this.additionalRetryCodes_=d,this.callback_=p,this.errorCallback_=g,this.timeout_=y,this.progressCallback_=x,this.connectionFactory_=j,this.retry=T,this.isUsingEmulator=B,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise(($,F)=>{this.resolve_=$,this.reject_=F,this.start_()})}start_(){const e=(i,l)=>{if(l){i(!1,new oh(!1,null,!0));return}const u=this.connectionFactory_();this.pendingConnection_=u;const d=p=>{const g=p.loaded,y=p.lengthComputable?p.total:-1;this.progressCallback_!==null&&this.progressCallback_(g,y)};this.progressCallback_!==null&&u.addUploadProgressListener(d),u.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&u.removeUploadProgressListener(d),this.pendingConnection_=null;const p=u.getErrorCode()===qo.NO_ERROR,g=u.getStatus();if(!p||XI(g,this.additionalRetryCodes_)&&this.retry){const x=u.getErrorCode()===qo.ABORT;i(!1,new oh(!1,null,x));return}const y=this.successCodes_.indexOf(g)!==-1;i(!0,new oh(y,u))})},t=(i,l)=>{const u=this.resolve_,d=this.reject_,p=l.connection;if(l.wasSuccessCode)try{const g=this.callback_(p,p.getResponse());YI(g)?u(g):u()}catch(g){d(g)}else if(p!==null){const g=$y();g.serverResponse=p.getErrorText(),this.errorCallback_?d(this.errorCallback_(p,g)):d(g)}else if(l.canceled){const g=this.appDelete_?Ck():BI();d(g)}else{const g=OI();d(g)}};this.canceled_?t(!1,new oh(!1,null,!0)):this.backoffId_=GI(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&KI(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class oh{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function ZI(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function e3(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function t3(n,e){e&&(n["X-Firebase-GMPID"]=e)}function s3(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function n3(n,e,t,i,l,u,d=!0,p=!1){const g=Rk(n.urlParams),y=n.url+g,x=Object.assign({},n.headers);return t3(x,e),ZI(x,t),e3(x,u),s3(x,i),new JI(y,n.method,x,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,l,d,p)}function r3(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function a3(...n){const e=r3();if(e!==void 0){const t=new e;for(let i=0;i<n.length;i++)t.append(n[i]);return t.getBlob()}else{if(Gy())return new Blob(n);throw new jn(kn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function i3(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function o3(n){if(typeof atob>"u")throw HI("base-64");return atob(n)}const Oa={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Fp{constructor(e,t){this.data=e,this.contentType=t||null}}function l3(n,e){switch(n){case Oa.RAW:return new Fp(Ak(e));case Oa.BASE64:case Oa.BASE64URL:return new Fp(Mk(n,e));case Oa.DATA_URL:return new Fp(u3(e),d3(e))}throw $y()}function Ak(n){const e=[];for(let t=0;t<n.length;t++){let i=n.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const u=i,d=n.charCodeAt(++t);i=65536|(u&1023)<<10|d&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function c3(n){let e;try{e=decodeURIComponent(n)}catch{throw fu(Oa.DATA_URL,"Malformed data URL.")}return Ak(e)}function Mk(n,e){switch(n){case Oa.BASE64:{const l=e.indexOf("-")!==-1,u=e.indexOf("_")!==-1;if(l||u)throw fu(n,"Invalid character '"+(l?"-":"_")+"' found: is it base64url encoded?");break}case Oa.BASE64URL:{const l=e.indexOf("+")!==-1,u=e.indexOf("/")!==-1;if(l||u)throw fu(n,"Invalid character '"+(l?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=o3(e)}catch(l){throw l.message.includes("polyfill")?l:fu(n,"Invalid character found")}const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i}class Ik{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw fu(Oa.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=h3(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function u3(n){const e=new Ik(n);return e.base64?Mk(Oa.BASE64,e.rest):c3(e.rest)}function d3(n){return new Ik(n).contentType}function h3(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}class Zi{constructor(e,t){let i=0,l="";b2(e)?(this.data_=e,i=e.size,l=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=l}size(){return this.size_}type(){return this.type_}slice(e,t){if(b2(this.data_)){const i=this.data_,l=i3(i,e,t);return l===null?null:new Zi(l)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new Zi(i,!0)}}static getBlob(...e){if(Gy()){const t=e.map(i=>i instanceof Zi?i.data_:i);return new Zi(a3.apply(null,t))}else{const t=e.map(d=>Wy(d)?l3(Oa.RAW,d).data:d.data_);let i=0;t.forEach(d=>{i+=d.byteLength});const l=new Uint8Array(i);let u=0;return t.forEach(d=>{for(let p=0;p<d.length;p++)l[u++]=d[p]}),new Zi(l,!0)}}uploadData(){return this.data_}}function Ky(n){let e;try{e=JSON.parse(n)}catch{return null}return QI(e)?e:null}function m3(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function f3(n,e){const t=e.split("/").filter(i=>i.length>0).join("/");return n.length===0?t:n+"/"+t}function Dk(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function p3(n,e){return e}class Er{constructor(e,t,i,l){this.server=e,this.local=t||e,this.writable=!!i,this.xform=l||p3}}let lh=null;function g3(n){return!Wy(n)||n.length<2?n:Dk(n)}function Pk(){if(lh)return lh;const n=[];n.push(new Er("bucket")),n.push(new Er("generation")),n.push(new Er("metageneration")),n.push(new Er("name","fullPath",!0));function e(u,d){return g3(d)}const t=new Er("name");t.xform=e,n.push(t);function i(u,d){return d!==void 0?Number(d):d}const l=new Er("size");return l.xform=i,n.push(l),n.push(new Er("timeCreated")),n.push(new Er("updated")),n.push(new Er("md5Hash",null,!0)),n.push(new Er("cacheControl",null,!0)),n.push(new Er("contentDisposition",null,!0)),n.push(new Er("contentEncoding",null,!0)),n.push(new Er("contentLanguage",null,!0)),n.push(new Er("contentType",null,!0)),n.push(new Er("metadata","customMetadata",!0)),lh=n,lh}function y3(n,e){function t(){const i=n.bucket,l=n.fullPath,u=new Nr(i,l);return e._makeStorageReference(u)}Object.defineProperty(n,"ref",{get:t})}function b3(n,e,t){const i={};i.type="file";const l=t.length;for(let u=0;u<l;u++){const d=t[u];i[d.local]=d.xform(i,e[d.server])}return y3(i,n),i}function Lk(n,e,t){const i=Ky(e);return i===null?null:b3(n,i,t)}function v3(n,e,t,i){const l=Ky(e);if(l===null||!Wy(l.downloadTokens))return null;const u=l.downloadTokens;if(u.length===0)return null;const d=encodeURIComponent;return u.split(",").map(y=>{const x=n.bucket,j=n.fullPath,T="/b/"+d(x)+"/o/"+d(j),B=_m(T,t,i),$=Rk({alt:"media",token:y});return B+$})[0]}function x3(n,e){const t={},i=e.length;for(let l=0;l<i;l++){const u=e[l];u.writable&&(t[u.server]=n[u.local])}return JSON.stringify(t)}const v2="prefixes",x2="items";function w3(n,e,t){const i={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[v2])for(const l of t[v2]){const u=l.replace(/\/$/,""),d=n._makeStorageReference(new Nr(e,u));i.prefixes.push(d)}if(t[x2])for(const l of t[x2]){const u=n._makeStorageReference(new Nr(e,l.name));i.items.push(u)}return i}function _3(n,e,t){const i=Ky(t);return i===null?null:w3(n,e,i)}class Yy{constructor(e,t,i,l){this.url=e,this.method=t,this.handler=i,this.timeout=l,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Qy(n){if(!n)throw $y()}function k3(n,e){function t(i,l){const u=Lk(n,l,e);return Qy(u!==null),u}return t}function j3(n,e){function t(i,l){const u=_3(n,e,l);return Qy(u!==null),u}return t}function T3(n,e){function t(i,l){const u=Lk(n,l,e);return Qy(u!==null),v3(u,l,n.host,n._protocol)}return t}function Xy(n){function e(t,i){let l;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?l=PI():l=DI():t.getStatus()===402?l=II(n.bucket):t.getStatus()===403?l=LI(n.path):l=i,l.status=t.getStatus(),l.serverResponse=i.serverResponse,l}return e}function E3(n){const e=Xy(n);function t(i,l){let u=e(i,l);return i.getStatus()===404&&(u=MI(n.path)),u.serverResponse=l.serverResponse,u}return t}function S3(n,e,t,i,l){const u={};e.isRoot?u.prefix="":u.prefix=e.path+"/",t.length>0&&(u.delimiter=t),i&&(u.pageToken=i),l&&(u.maxResults=l);const d=e.bucketOnlyServerUrl(),p=_m(d,n.host,n._protocol),g="GET",y=n.maxOperationRetryTime,x=new Yy(p,g,j3(n,e.bucket),y);return x.urlParams=u,x.errorHandler=Xy(e),x}function N3(n,e,t){const i=e.fullServerUrl(),l=_m(i,n.host,n._protocol),u="GET",d=n.maxOperationRetryTime,p=new Yy(l,u,T3(n,t),d);return p.errorHandler=E3(e),p}function C3(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function R3(n,e,t){const i=Object.assign({},t);return i.fullPath=n.path,i.size=e.size(),i.contentType||(i.contentType=C3(null,e)),i}function A3(n,e,t,i,l){const u=e.bucketOnlyServerUrl(),d={"X-Goog-Upload-Protocol":"multipart"};function p(){let ae="";for(let ye=0;ye<2;ye++)ae=ae+Math.random().toString().slice(2);return ae}const g=p();d["Content-Type"]="multipart/related; boundary="+g;const y=R3(e,i,l),x=x3(y,t),j="--"+g+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+x+`\r
--`+g+`\r
Content-Type: `+y.contentType+`\r
\r
`,T=`\r
--`+g+"--",B=Zi.getBlob(j,i,T);if(B===null)throw zI();const $={name:y.fullPath},F=_m(u,n.host,n._protocol),V="POST",te=n.maxUploadRetryTime,K=new Yy(F,V,k3(n,t),te);return K.urlParams=$,K.headers=d,K.body=B.uploadData(),K.errorHandler=Xy(e),K}class M3{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=qo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=qo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=qo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,l,u){if(this.sent_)throw Xc("cannot .send() more than once");if(po(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),u!==void 0)for(const d in u)u.hasOwnProperty(d)&&this.xhr_.setRequestHeader(d,u[d].toString());return l!==void 0?this.xhr_.send(l):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Xc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Xc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Xc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Xc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class I3 extends M3{initXhr(){this.xhr_.responseType="text"}}function Jy(){return new I3}class Jo{constructor(e,t){this._service=e,t instanceof Nr?this._location=t:this._location=Nr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Jo(e,t)}get root(){const e=new Nr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Dk(this._location.path)}get storage(){return this._service}get parent(){const e=m3(this._location.path);if(e===null)return null;const t=new Nr(this._location.bucket,e);return new Jo(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw $I(e)}}function D3(n,e,t){n._throwIfRoot("uploadBytes");const i=A3(n.storage,n._location,Pk(),new Zi(e,!0),t);return n.storage.makeRequestWithTokens(i,Jy).then(l=>({metadata:l,ref:n}))}function P3(n){const e={prefixes:[],items:[]};return Ok(n,e).then(()=>e)}async function Ok(n,e,t){const l=await L3(n,{pageToken:t});e.prefixes.push(...l.prefixes),e.items.push(...l.items),l.nextPageToken!=null&&await Ok(n,e,l.nextPageToken)}function L3(n,e){e!=null&&typeof e.maxResults=="number"&&Ig("options.maxResults",1,1e3,e.maxResults);const t=e||{},i=S3(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(i,Jy)}function O3(n){n._throwIfRoot("getDownloadURL");const e=N3(n.storage,n._location,Pk());return n.storage.makeRequestWithTokens(e,Jy).then(t=>{if(t===null)throw qI();return t})}function B3(n,e){const t=f3(n._location.path,e),i=new Nr(n._location.bucket,t);return new Jo(n.storage,i)}function V3(n){return/^[A-Za-z]+:\/\//.test(n)}function U3(n,e){return new Jo(n,e)}function Bk(n,e){if(n instanceof Zy){const t=n;if(t._bucket==null)throw FI();const i=new Jo(t,t._bucket);return e!=null?Bk(i,e):i}else return e!==void 0?B3(n,e):n}function F3(n,e){if(e&&V3(e)){if(n instanceof Zy)return U3(n,e);throw Mg("To use ref(service, url), the first argument must be a Storage instance.")}else return Bk(n,e)}function w2(n,e){const t=e?.[Nk];return t==null?null:Nr.makeFromBucketSpec(t,n)}function z3(n,e,t,i={}){n.host=`${e}:${t}`;const l=po(e);l&&(Hg(`https://${n.host}/b`),$g("Storage",!0)),n._isUsingEmulator=!0,n._protocol=l?"https":"http";const{mockUserToken:u}=i;u&&(n._overrideAuthToken=typeof u=="string"?u:ow(u,n.app.options.projectId))}class Zy{constructor(e,t,i,l,u,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=l,this._firebaseVersion=u,this._isUsingEmulator=d,this._bucket=null,this._host=Sk,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=RI,this._maxUploadRetryTime=AI,this._requests=new Set,l!=null?this._bucket=Nr.makeFromBucketSpec(l,this._host):this._bucket=w2(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Nr.makeFromBucketSpec(this._url,e):this._bucket=w2(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Ig("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Ig("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Kr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Jo(this,e)}_makeRequest(e,t,i,l,u=!0){if(this._deleted)return new WI(Ck());{const d=n3(e,this._appId,i,l,t,this._firebaseVersion,u,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[i,l]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,l).getPromise()}}const _2="@firebase/storage",k2="0.14.0";const Vk="storage";function zp(n,e,t){return n=Xs(n),D3(n,e,t)}function j2(n){return n=Xs(n),P3(n)}function Ho(n){return n=Xs(n),O3(n)}function to(n,e){return n=Xs(n),F3(n,e)}function q3(n=Yg(),e){n=Xs(n);const i=em(n,Vk).getImmediate({identifier:e}),l=rw("storage");return l&&H3(i,...l),i}function H3(n,e,t,i={}){z3(n,e,t,i)}function $3(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),l=n.getProvider("app-check-internal");return new Zy(t,i,l,e,Zo)}function W3(){Wo(new oo(Vk,$3,"PUBLIC").setMultipleInstances(!0)),Ba(_2,k2,""),Ba(_2,k2,"esm2020")}W3();const Uk={apiKey:"AIzaSyBCIgMJd3By7qkWH27YiW9VooIBGE3bFLs",authDomain:"mind-core-fitness-client.firebaseapp.com",projectId:"mind-core-fitness-client",storageBucket:"mind-core-fitness-client.firebasestorage.app",messagingSenderId:"669343392406",appId:"1:669343392406:web:f5a35ee062387e7d6f58b7"},eb=Kg(Uk),Po=Ww(eb),pe=yI(eb),so=q3(eb),G3=Kg(Uk,"secondary"),qP=Ww(G3),K3="EYdciKDOi3UYBLk1u8hHams5tmO2",Fk=v.createContext();function Ur(){return v.useContext(Fk)}function Y3({children:n}){const[e,t]=v.useState(null),[i,l]=v.useState(!1),[u,d]=v.useState(!1),[p,g]=v.useState(null),[y,x]=v.useState(!0);v.useEffect(()=>{let K=null;const ae=e4(Po,ye=>{if(t(ye),K&&(K(),K=null),ye)if(ye.uid===K3)l(!0),d(!1),g(null),x(!1);else{l(!1);const Ae=Os(Ot(pe,"clients"),fs("uid","==",ye.uid)),me=async()=>{const R=localStorage.getItem("mcf_clientId");if(R)try{const E=await As(He(pe,"clients",R));E.exists()&&(d(!0),g({id:E.id,...E.data()}))}catch(E){console.error("Direct client read failed:",E)}};K=Tk(Ae,async R=>{if(R.empty)await me();else{const E=R.docs[0];d(!0),g({id:E.id,...E.data()});try{localStorage.setItem("mcf_clientId",E.id)}catch{}}x(!1)},async R=>{console.error("Error listening to client data:",R),await me(),x(!1)})}else l(!1),d(!1),g(null),x(!1)});return()=>{ae(),K&&K()}},[]);const te={currentUser:e,isAdmin:i,isClient:u,clientData:p,updateClientData:K=>{g(ae=>ae?{...ae,...K}:K)},resolveClient:async()=>{if(p)return p;const K=localStorage.getItem("mcf_clientId");if(K)try{const ae=await As(He(pe,"clients",K));if(ae.exists()){const ye={id:ae.id,...ae.data()};return d(!0),g(ye),ye}}catch(ae){console.error("resolveClient direct read failed:",ae)}if(e){const ae=Os(Ot(pe,"clients"),fs("uid","==",e.uid)),ye=await Es(ae);if(!ye.empty){const Ae={id:ye.docs[0].id,...ye.docs[0].data()};return d(!0),g(Ae),Ae}}return null},login:async(K,ae,ye=!0)=>(await ox(Po,ye?fg:sy),await XC(Po,K,ae)),signup:async(K,ae,ye)=>{await ox(Po,fg);const Ae=await QC(Po,ae.trim().toLowerCase(),ye),me=Ae.user,R=He(Ot(pe,"clients")),E={uid:me.uid,name:K.trim(),email:ae.trim().toLowerCase(),clientType:"core_buddy",coreBuddyAccess:!0,status:"active",tier:"free",subscriptionStatus:null,signupSource:"self_signup",createdAt:_t.now()};await Ss(R,E),d(!0),g({id:R.id,...E});try{localStorage.setItem("mcf_clientId",R.id)}catch{}return Ae},logout:()=>{try{localStorage.removeItem("mcf_clientId")}catch{}return t4(Po)},resetPassword:K=>YC(Po,K),loading:y};return r.jsx(Fk.Provider,{value:te,children:n})}const zk=v.createContext();function Na(){return v.useContext(zk)}function Q3({children:n}){const[e,t]=v.useState(()=>{const g=localStorage.getItem("theme");return g?g==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches}),[i,l]=v.useState(()=>localStorage.getItem("accent")||"red");v.useEffect(()=>{document.documentElement.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("theme",e?"dark":"light")},[e]),v.useEffect(()=>{localStorage.setItem("accent",i)},[i]);const p={isDark:e,toggleTheme:()=>{document.documentElement.setAttribute("data-theme-transitioning",""),t(!e),setTimeout(()=>{document.documentElement.removeAttribute("data-theme-transitioning")},350)},accent:i,setAccent:g=>l(g)};return r.jsx(zk.Provider,{value:p,children:n})}const qk=v.createContext();function km(){return v.useContext(qk)}const X3=["nutrition","consistency","personalBests","achievements","buddies","programmes","leaderboard"],J3=[5,10],Z3=1;function eD({children:n}){const{clientData:e,loading:t}=Ur(),i=v.useMemo(()=>{const l=e?.tier||"free",u=e?.subscriptionStatus||null,d=e&&e.signupSource!=="self_signup",p=l==="premium"||!!d;function g(y){return p?!0:!X3.includes(y)}return{tier:l,subscriptionStatus:u,isPremium:p,canAccess:g,loading:t,FREE_RANDOMISER_DURATIONS:J3,FREE_RANDOMISER_WEEKLY_LIMIT:Z3}},[e?.tier,e?.subscriptionStatus,e?.signupSource,t]);return r.jsx(qk.Provider,{value:i,children:n})}function tD(n){if(n?.signupSource==="self_signup"&&!n?.onboardingComplete)return"/onboarding";const e=n?.clientType;return e==="core_buddy"?"/client/core-buddy":e==="circuit_vip"||e==="circuit_dropin"?"/client/circuit":"/client"}function sD({className:n=""}){const{isDark:e,toggleTheme:t}=Na();return r.jsx("button",{className:n||"theme-toggle",onClick:t,"aria-label":e?"Switch to light mode":"Switch to dark mode",children:e?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})})}function nD(){const[n,e]=v.useState(""),[t,i]=v.useState(""),[l,u]=v.useState(!0),[d,p]=v.useState(""),[g,y]=v.useState(!1),[x,j]=v.useState(!1),[T,B]=v.useState(!1),{login:$,resetPassword:F,currentUser:V,isAdmin:te,isClient:K,clientData:ae,loading:ye}=Ur(),Ae=er();if(v.useEffect(()=>{!ye&&V&&(te?Ae("/dashboard"):K?Ae(tD(ae)):(y(!1),p("No account found. Please sign up or contact your trainer.")))},[ye,V,te,K,ae,Ae]),ye||V)return null;const me=async E=>{E.preventDefault(),p(""),y(!0);try{await $(n,t,l)}catch(M){p(M.message||"Failed to log in"),y(!1)}},R=async E=>{if(E.preventDefault(),p(""),!n.trim()){p("Please enter your email address");return}y(!0);try{await F(n.trim()),B(!0)}catch(M){M.code==="auth/user-not-found"?p("No account found with this email"):p(M.message||"Failed to send reset email")}y(!1)};return r.jsxs("div",{className:"login-container",children:[r.jsx(sD,{className:"login-theme-toggle"}),r.jsxs("div",{className:"login-card",children:[r.jsxs("div",{className:"login-header",children:[r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"login-logo"}),r.jsx("p",{children:r.jsx("strong",{children:x?"Reset Password":"Sign in as 1-2-1 or a Core Buddy"})})]}),d&&r.jsx("div",{className:"error-message",children:d}),T?r.jsxs("div",{className:"reset-sent",children:[r.jsx("div",{className:"reset-sent-icon",children:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M22 2L11 13",strokeLinecap:"round",strokeLinejoin:"round"}),r.jsx("path",{d:"M22 2L15 22L11 13L2 9L22 2Z",strokeLinecap:"round",strokeLinejoin:"round"})]})}),r.jsx("p",{children:"Reset email sent!"}),r.jsx("span",{children:"Check your inbox for a password reset link"}),r.jsx("button",{className:"login-btn",style:{marginTop:"20px"},onClick:()=>{j(!1),B(!1),p("")},children:"Back to Log In"})]}):x?r.jsxs("form",{onSubmit:R,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email"}),r.jsx("input",{type:"email",id:"email",value:n,onChange:E=>e(E.target.value),placeholder:"Enter your email",required:!0})]}),r.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Sending...":"Send Reset Link"}),r.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{j(!1),p("")},children:"Back to Log In"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("form",{onSubmit:me,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email"}),r.jsx("input",{type:"email",id:"email",value:n,onChange:E=>e(E.target.value),required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"password",children:"Password"}),r.jsx("input",{type:"password",id:"password",value:t,onChange:E=>i(E.target.value),required:!0})]}),r.jsx("div",{className:"remember-me",children:r.jsxs("label",{children:[r.jsx("input",{type:"checkbox",checked:l,onChange:E=>u(E.target.checked)}),r.jsx("span",{children:"Remember me"})]})}),r.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Logging in...":"Log In"})]}),r.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{j(!0),p("")},children:"Forgot password?"})]}),r.jsx("a",{href:"/",className:"back-link",children:"Back to website"})]})]})}function Dl({feature:n,children:e}){const{canAccess:t,loading:i}=km(),l=er();return i||t(n)?e:r.jsxs("div",{className:"locked-feature-wrap",children:[r.jsx("div",{className:"locked-feature-bg","aria-hidden":"true",children:e}),r.jsx("div",{className:"locked-feature-overlay",children:r.jsxs("div",{className:"locked-feature-card",children:[r.jsx("div",{className:"locked-icon",children:r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),r.jsx("h2",{children:"Premium Feature"}),r.jsx("p",{children:"Upgrade to Core Buddy Premium to unlock this feature and get full access to everything."}),r.jsx("button",{className:"locked-upgrade-btn",onClick:()=>l("/upgrade"),children:"Upgrade Now"})]})})]})}function ua({active:n}){const e=er(),{clientData:t}=Ur(),{isPremium:i}=km(),l=t?.clientType==="block"&&t?.coreBuddyAccess;return r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:`block-nav-tab${n==="home"?" active":""}`,onClick:()=>e("/client/core-buddy"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),r.jsx("span",{children:"Profile"})]}),r.jsxs("button",{className:`block-nav-tab${n==="workouts"?" active":""}`,onClick:()=>e("/client/core-buddy/workouts"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:r.jsx("path",{d:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"})}),r.jsx("span",{children:"Workouts"})]}),r.jsxs("button",{className:`block-nav-tab${n==="nutrition"?" active":""}`,onClick:()=>e(i?"/client/core-buddy/nutrition":"/upgrade"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"})}),r.jsx("span",{children:"Nutrition"})]}),r.jsxs("button",{className:`block-nav-tab${n==="buddies"?" active":""}`,onClick:()=>e(i?"/client/core-buddy/buddies":"/upgrade"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("span",{children:"Buddies"})]}),l&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>e("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),r.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),r.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),r.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),r.jsx("span",{children:"Block"})]})]})}function Ta({children:n,onRefresh:e}){const[t,i]=v.useState(0),[l,u]=v.useState(!1),d=v.useRef(null),p=v.useRef(0),g=v.useRef(!1),y=v.useCallback(T=>{window.scrollY<=0&&(p.current=T.touches[0].clientY,g.current=!0)},[]),x=v.useCallback(T=>{if(!g.current||l)return;const B=T.touches[0].clientY-p.current;B>20&&window.scrollY<=0&&(T.preventDefault(),i(Math.min((B-20)*.35,80)))},[l]),j=v.useCallback(async()=>{t>55&&!l&&(u(!0),e?await e():window.location.reload(),u(!1)),i(0),g.current=!1},[t,l,e]);return r.jsxs("div",{ref:d,onTouchStart:y,onTouchMove:x,onTouchEnd:j,children:[r.jsxs("div",{className:`pull-refresh-indicator ${t>0?"visible":""} ${l?"refreshing":""}`,style:{height:t},children:[r.jsx("div",{className:`refresh-spinner ${l?"spinning":""}`,children:r.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:r.jsx("path",{fill:"currentColor",d:"M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"})})}),r.jsx("span",{className:"refresh-text",children:l?"Refreshing...":"Pull to refresh"})]}),n]})}function Wu(n,e,t,i,l){const u=[];for(let d=0;d<n;d++){const p=(d*(360/n)-90)*(Math.PI/180);u.push({x1:e+i*Math.cos(p),y1:t+i*Math.sin(p),x2:e+l*Math.cos(p),y2:t+l*Math.sin(p),thick:d%5===0})}return u}const tb=Wu(60,100,100,85,96),Hk=Wu(60,100,100,78,94),rD=Wu(60,100,100,82,94);Wu(60,50,50,38,46);const T2=Wu(60,40,40,30,37),aD="/login/assets/first_workout-B8SFkzJX.PNG",iD="/login/assets/workouts_10-Z5R3u0xH.PNG",oD="/login/assets/workouts_25-CzxSlcAj.PNG",lD="/login/assets/workouts_50-BpzWup3V.PNG",cD="/login/assets/workouts_100-D7_r6tn1.PNG",uD="/login/assets/streak_2-CsRr-XA9.PNG",dD="/login/assets/streak_4-BHO09tbw.PNG",hD="/login/assets/streak_8-DX2UWMko.PNG",mD="/login/assets/first_pb-aVf_CNWy.PNG",fD="/login/assets/pbs_5-Cippawgg.PNG",pD="/login/assets/pbs_10-CZgGh9Kv.PNG",gD="/login/assets/pbs_100-C67b1wfS.PNG",yD="/login/assets/nutrition_7-CHVV11fj.PNG",bD="/login/assets/leaderboard_join-BLoId4Hz.PNG",vD="/login/assets/habits_7-Dvki70KO.PNG",Hn=[{id:"first_workout",img:aD,name:"First Rep",desc:"Complete your first workout",category:"workouts",threshold:1},{id:"workouts_10",img:iD,name:"On Fire",desc:"Complete 10 workouts",category:"workouts",threshold:10},{id:"workouts_25",img:oD,name:"Dedicated",desc:"Complete 25 workouts",category:"workouts",threshold:25},{id:"workouts_50",img:lD,name:"Unstoppable",desc:"Complete 50 workouts",category:"workouts",threshold:50},{id:"workouts_100",img:cD,name:"Century",desc:"Complete 100 workouts",category:"workouts",threshold:100},{id:"streak_2",img:uD,name:"2 Week Streak",desc:"Work out for 2 weeks in a row",category:"streaks",threshold:2},{id:"streak_4",img:dD,name:"Month Strong",desc:"Work out for 4 weeks in a row",category:"streaks",threshold:4},{id:"streak_8",img:hD,name:"Iron Will",desc:"Work out for 8 weeks in a row",category:"streaks",threshold:8},{id:"first_pb",img:mD,name:"First PB",desc:"Set your first personal best",category:"pbs",threshold:1},{id:"pbs_5",img:fD,name:"PB Hunter",desc:"Set 5 personal bests",category:"pbs",threshold:5},{id:"pbs_10",img:pD,name:"PB Machine",desc:"Set 10 personal bests",category:"pbs",threshold:10},{id:"pbs_100",img:gD,name:"PB Legend",desc:"Set 100 personal bests",category:"pbs",threshold:100},{id:"nutrition_7",img:yD,name:"Macro Master",desc:"Hit your macro targets 7 days in a row",category:"nutrition",threshold:7},{id:"leaderboard_join",img:bD,name:"Competitor",desc:"Join the leaderboard",category:"leaderboard",threshold:1},{id:"habits_7",img:vD,name:"Habit Streak",desc:"Complete your daily habits 7 days in a row",category:"habits",threshold:7}];function xD({steps:n,onFinish:e,active:t}){const[i,l]=v.useState(0),[u,d]=v.useState(null),[p,g]=v.useState("below"),[y,x]=v.useState(!1),j=v.useRef(null),T=v.useRef(t);T.current=t,v.useEffect(()=>{t||l(0)},[t]),v.useEffect(()=>{if(!t)return;const Ae=me=>me.preventDefault();return document.addEventListener("touchmove",Ae,{passive:!1}),document.addEventListener("wheel",Ae,{passive:!1}),document.body.style.overflow="hidden",()=>{document.removeEventListener("touchmove",Ae),document.removeEventListener("wheel",Ae),document.body.style.overflow=""}},[t]);const B=v.useMemo(()=>t?n.filter(Ae=>document.querySelector(Ae.selector)):[],[t]),$=B[i],F=i===B.length-1,V=$?.selector,te=v.useCallback(()=>{if(!V)return;const Ae=document.querySelector(V);if(!Ae){d(null);return}const me=Ae.getBoundingClientRect(),R=8;d({top:me.top-R,left:me.left-R,width:me.width+R*2,height:me.height+R*2});const E=window.innerHeight-me.bottom;g(E<260?"above":"below")},[V]);if(v.useEffect(()=>{if(!t||!V)return;x(!0);const Ae=document.querySelector(V);if(Ae){document.body.style.overflow="",Ae.scrollIntoView({behavior:"smooth",block:"center"});let me=null,R=0,E=0;const M=60,O=()=>{E++;const I=Ae.getBoundingClientRect(),qe=Math.round(I.top);if(me!==null&&qe===me?R++:R=0,me=qe,R>=3||E>=M){T.current&&(document.body.style.overflow="hidden"),te(),x(!1);return}D=requestAnimationFrame(O)};let D;const q=setTimeout(()=>{D=requestAnimationFrame(O)},120);return()=>{clearTimeout(q),D&&cancelAnimationFrame(D),T.current&&(document.body.style.overflow="hidden")}}},[t,i,V,te]),v.useEffect(()=>{if(!t)return;const Ae=()=>{j.current&&cancelAnimationFrame(j.current),j.current=requestAnimationFrame(te)};return window.addEventListener("scroll",Ae,!0),window.addEventListener("resize",Ae),()=>{window.removeEventListener("scroll",Ae,!0),window.removeEventListener("resize",Ae),j.current&&cancelAnimationFrame(j.current)}},[t,te]),!t||!$||B.length===0)return null;const K=()=>{F?e():l(i+1)},ae=()=>{i>0&&l(i-1)},ye=()=>e();return r.jsxs("div",{className:"st-overlay",onClick:Ae=>{Ae.stopPropagation()},children:[r.jsx("div",{className:"st-backdrop",onClick:K}),u&&r.jsx("div",{className:`st-spotlight${y?" st-transitioning":""}`,style:{top:u.top,left:u.left,width:u.width,height:u.height}}),u&&r.jsxs("div",{className:`st-tooltip st-tooltip-${p}${y?" st-transitioning":""}`,style:{top:p==="below"?Math.min(Math.max(u.top+u.height+16,16),window.innerHeight-200):void 0,bottom:p==="above"?Math.min(Math.max(window.innerHeight-u.top+16,16),window.innerHeight-60):void 0,left:Math.max(16,Math.min(u.left,window.innerWidth-320))},children:[r.jsx("div",{className:"st-dots",children:B.map((Ae,me)=>r.jsx("span",{className:`st-dot${me===i?" active":""}${me<i?" done":""}`},me))}),r.jsx("h3",{className:"st-title",children:$.title}),r.jsx("p",{className:"st-body",children:$.body}),r.jsxs("div",{className:"st-actions",children:[i>0&&r.jsx("button",{className:"st-btn st-btn-back",onClick:ae,children:"Back"}),r.jsx("button",{className:"st-btn st-btn-next",onClick:K,children:$.cta||(F?"Let's Go!":"Next")})]}),r.jsx("button",{className:"st-skip",onClick:ye,children:"Skip tour"})]})]})}const qp=[10,25,50,100,200,500,1e3],Gi=5;function Jc(n){return n.toISOString().split("T")[0]}function wD(n){let e=0;for(const t of qp){if(n<t)return{prev:e,next:t};e=t}return{prev:qp[qp.length-1],next:n+100}}const _D={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},kD={fullbody_4wk:["Push Focus","Pull Focus","Legs & Core"],fullbody_8wk:["Strength","Power","Endurance"],fullbody_12wk:["Upper Push","Lower Body","Upper Pull"],core_4wk:["Abs","Stability","Power Core"],core_8wk:["Anti-Extension","Rotation","Power"],core_12wk:["Strength","Endurance","Power"],upper_4wk:["Push","Pull","Mixed"],lower_4wk:["Quad Dominant","Hamstring & Glute","Power & Stability"]},Hp=[{text:"You have 24 hours a day...",bold:"make it count"},{text:"Discipline beats motivation...",bold:"every single time"},{text:"Rest when you're done,",bold:"not when you're tired"},{text:"Small daily gains...",bold:"create massive results"},{text:"Your body keeps score,",bold:"train it well"},{text:"Consistency over intensity...",bold:"always wins"},{text:"The only bad workout...",bold:"is the one you skipped"}];function $p(n){if(!n)return"";const e=n instanceof Date?n:n.toDate?n.toDate():new Date(n),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function Zc(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function jD(n,e=800){return new Promise(t=>{const i=new Image;i.onload=()=>{const l=document.createElement("canvas");let u=i.width,d=i.height;u>d?u>e&&(d=Math.round(d*e/u),u=e):d>e&&(u=Math.round(u*e/d),d=e),l.width=u,l.height=d,l.getContext("2d").drawImage(i,0,0,u,d),l.toBlob(p=>t(p),"image/jpeg",.8)},i.src=URL.createObjectURL(n)})}function TD(){const{currentUser:n,isClient:e,clientData:t,logout:i,updateClientData:l,loading:u}=Ur(),{isDark:d,toggleTheme:p}=Na(),{isPremium:g}=km(),y=er(),[x,j]=v.useState({hours:0,minutes:0,seconds:0}),[T,B]=v.useState(0),[$,F]=v.useState(0),[V,te]=v.useState(""),[K,ae]=v.useState(0),[ye,Ae]=v.useState(0),[me,R]=v.useState(!1),[E,M]=v.useState({protein:0,carbs:0,fats:0,calories:0}),[O,D]=v.useState(null),[q,I]=v.useState(0),[qe,ft]=v.useState(null),[W,de]=v.useState(!1),[Ie,Ve]=v.useState(!1),[ee,L]=v.useState(0),[se,De]=v.useState(0),[ue,ze]=v.useState([]),[Le,it]=v.useState([]),[pt,Ye]=v.useState(null),[Ht,Ms]=v.useState(!1),dt=v.useRef(null),[mt,ne]=v.useState([]),[Rt,Pt]=v.useState(null),[At,vt]=v.useState(null),nt=v.useRef(null),[$e,$t]=v.useState(0),[Ns,Ws]=v.useState(0),[Ut,St]=v.useState(0),[is,Is]=v.useState(0),[zt,Js]=v.useState(null),Lt=v.useCallback((C,J="info")=>{Js({message:C,type:J}),setTimeout(()=>Js(null),4e3)},[]),[ps,Wt]=v.useState([]),[we,G]=v.useState(!1),[he,Ee]=v.useState(""),[Oe,ke]=v.useState(null),[Qe,ot]=v.useState(null),[Y,re]=v.useState(!1),[We,Ge]=v.useState(new Set),[rt,bt]=v.useState(new Set),[jt,gt]=v.useState({}),[Gt,Gs]=v.useState({}),[os,ks]=v.useState({}),[Us,H]=v.useState({}),[_e,Ne]=v.useState({}),[Se,je]=v.useState({}),ct=v.useRef(null),xt=v.useRef(null),Ze=v.useRef({}),[kt,Et]=v.useState([]),[Cs,hn]=v.useState(!1),gn=v.useRef(null),[Tn,In]=v.useState([]),[yn,zs]=v.useState(""),[k,N]=v.useState(!1),[P,U]=v.useState(null),[fe,Ue]=v.useState([]),[Fe,st]=v.useState(null),[et,ss]=v.useState(!1),js=v.useRef(!1),us=(()=>{const C=[{selector:".cb-ring-container",title:"Your 24-Hour Countdown",body:"Every day resets. This ring tracks the time you have left  tap your photo to personalise your profile.",cta:"Next"},{selector:".cb-stats-row",title:"Progress at a Glance",body:"Programme completion, workouts this week, and daily habits  all in one row. These fill up as you go."},{selector:".cb-nudge-card",title:"Smart Suggestions",body:"We'll highlight what needs your attention  your next session, unfinished habits, or a meal to log."},{selector:".cb-card-workouts-hero",title:"Workouts",body:"Quick randomiser sessions or structured programmes  pick your focus, level and time.",cta:"Next"}];return g&&C.push({selector:".cb-card-nutrition",title:"Nutrition Tracking",body:"Set your macro targets, scan barcodes, and log meals to hit your daily goals."},{selector:".cb-card-consistency",title:"Daily Habits",body:"5 simple habits each day  train, hit protein, 10k steps, sleep, and hydrate. Build your streak."},{selector:".cb-card-buddies",title:"Buddies & Social",body:"Connect with other members, share your journey, and keep each other accountable."},{selector:".cb-journey-section",title:"Share Your Journey",body:"Post photos, updates, and milestones  your fitness journey in one place. Like and comment on each other's posts."},{selector:".cb-achievements-section",title:"Achievements",body:"Every rep counts towards badges  volume milestones, workout streaks, and more to unlock."}),C.push({selector:".block-bottom-nav",title:"You're All Set!",body:"Use the nav bar to jump between your profile, workouts, nutrition, and buddies. Time to get after it.",cta:"Let's Go!"}),C})();v.useEffect(()=>{!u&&!n&&y("/")},[u,n,y]),v.useEffect(()=>{!u&&t&&t.signupSource==="self_signup"&&!t.onboardingComplete&&y("/onboarding")},[u,t,y]),v.useEffect(()=>{let C=t?.tourComplete||js.current;if(!C&&t?.id)try{C=!!localStorage.getItem(`tourDone_${t.id}`)}catch{}if(me&&t&&!C){const J=setTimeout(()=>ss(!0),600);return()=>clearTimeout(J)}},[me,t]),v.useEffect(()=>{if(t)try{const C=sessionStorage.getItem(`cbDash_${t.id}`);if(C){const J=JSON.parse(C);F(J.programmePct??0),te(J.programmeName??""),ae(J.totalWorkouts??0),Ae(J.habitWeekPct??0),M(J.nutritionTotals??{protein:0,carbs:0,fats:0,calories:0}),D(J.nutritionTargetData??null),I(J.todayHabitsCount??0),ft(J.nextSession??null),de(J.hasProgramme??!1),Ve(J.programmeComplete??!1),L(J.weeklyWorkouts??0),De(J.pbCount??0),ze(J.topPBs??[]),it(J.leaderboardTop3??[]),ne(J.unlockedBadges??[]),nt.current=J.unlockedBadges??[],$t(J.streakWeeks??0),R(!0)}}catch{}},[t]),v.useEffect(()=>{t?.photoURL&&Ye(t.photoURL)},[t]),v.useEffect(()=>{if(!t)return;const C=Os(Ot(pe,"notifications"),fs("toId","==",t.id)),J=Tk(C,Ce=>{const tt=Ce.docs.map(Tt=>({id:Tt.id,...Tt.data()}));tt.sort((Tt,Dt)=>{const lt=Tt.createdAt?.toMillis?.()||0;return(Dt.createdAt?.toMillis?.()||0)-lt}),Et(tt.slice(0,50))},Ce=>{console.error("Notification listener error:",Ce),Ce.code==="permission-denied"&&console.warn("Firestore rules may be missing for the notifications collection. Please update your Firestore rules in the Firebase Console.")});return()=>J()},[t]),v.useEffect(()=>{const C=J=>{gn.current&&!gn.current.contains(J.target)&&hn(!1)};return document.addEventListener("mousedown",C),()=>document.removeEventListener("mousedown",C)},[]),v.useEffect(()=>{if(!t)return;const C=t.id;(async()=>{try{const[J,Ce,tt]=await Promise.all([Es(Os(Ot(pe,"buddies"),fs("user1","==",C))),Es(Os(Ot(pe,"buddies"),fs("user2","==",C))),Es(Ot(pe,"clients"))]),Tt=new Set;[...J.docs,...Ce.docs].forEach(lt=>{const qt=lt.data();Tt.add(qt.user1===C?qt.user2:qt.user1)});const Dt={};tt.docs.forEach(lt=>{Dt[lt.id]=lt.data()}),In(Array.from(Tt).filter(lt=>Dt[lt]).map(lt=>({id:lt,name:Dt[lt].name,photoURL:Dt[lt].photoURL||null})))}catch(J){console.error("Error loading buddies for mentions:",J)}})()},[t]);const cs=kt.filter(C=>!C.read).length,qs=async()=>{const C=kt.filter(Ce=>!Ce.read);if(!C.length)return;const J=y2(pe);C.forEach(Ce=>J.update(He(pe,"notifications",Ce.id),{read:!0})),await J.commit()},En=async()=>{if(!kt.length)return;const C=y2(pe);kt.forEach(J=>C.delete(He(pe,"notifications",J.id))),await C.commit()},cr=async(C,J,Ce={})=>{if(!(!t||C===t.id))try{await la(Ot(pe,"notifications"),{toId:C,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:J,read:!1,createdAt:br(),...Ce})}catch(tt){console.error("Notification create error:",tt),tt.code==="permission-denied"&&Lt("Notifications blocked  check Firestore rules","error")}},ds=(C,J)=>{const Ce=J==="compose"?ct.current?.selectionStart:null,Tt=(Ce!=null?C.slice(0,Ce):C).match(/@(\w*)$/);if(Tt){N(!0),U(J),zs(Tt[1].toLowerCase());const Dt=Tn.filter(lt=>lt.name&&lt.name.toLowerCase().includes(Tt[1].toLowerCase())).slice(0,5);Ue(Dt)}else N(!1),Ue([])},Xr=(C,J)=>{if(J==="compose"){const Ce=ct.current,tt=he,Tt=Ce?.selectionStart??tt.length,Dt=tt.slice(0,Tt),lt=tt.slice(Tt),qt=Dt.replace(/@\w*$/,`@${C.name} `);Ee(qt+lt),setTimeout(()=>{Ce?.focus(),Ce.selectionStart=Ce.selectionEnd=qt.length},0)}else{const tt=(Gt[J]||"").replace(/@\w*$/,`@${C.name} `);Gs(Tt=>({...Tt,[J]:tt}))}N(!1),Ue([])},Dn=C=>C&&C.split(/(@\w[\w\s]*?\s)/g).map((Ce,tt)=>Ce.startsWith("@")&&Tn.some(Tt=>Ce.trim()===`@${Tt.name}`)?r.jsx("span",{className:"mention-highlight",children:Ce.trim()},tt):Ce),X=async C=>{const J=C.target.files?.[0];if(!(!J||!t)){if(!J.type.startsWith("image/")){Lt("Please select an image file","error");return}if(J.size>5*1024*1024){Lt("Image must be under 5MB","error");return}Ms(!0);try{const Ce=await new Promise(Dt=>{const lt=new Image;lt.onload=()=>{const qt=document.createElement("canvas"),Xt=400;let ls=lt.width,Qt=lt.height;ls>Qt?(Qt=Qt/ls*Xt,ls=Xt):(ls=ls/Qt*Xt,Qt=Xt),qt.width=ls,qt.height=Qt,qt.getContext("2d").drawImage(lt,0,0,ls,Qt),qt.toBlob(ws=>Dt(ws),"image/jpeg",.75)},lt.src=URL.createObjectURL(J)}),tt=to(so,`profilePhotos/${t.id}`);await zp(tt,Ce);const Tt=await Ho(tt);await La(He(pe,"clients",t.id),{photoURL:Tt}),Ye(Tt),l({photoURL:Tt}),Lt("Profile photo updated!","success")}catch(Ce){console.error("Photo upload error:",Ce),Lt("Failed to upload photo","error")}Ms(!1),dt.current&&(dt.current.value="")}};v.useEffect(()=>{const C=()=>{const Ce=new Date,tt=new Date(Ce);tt.setHours(23,59,59,999);const Tt=tt-Ce,Dt=Math.floor(Tt/(1e3*60*60)),lt=Math.floor(Tt%(1e3*60*60)/(1e3*60)),qt=Math.floor(Tt%(1e3*60)/1e3);j({hours:Dt,minutes:lt,seconds:qt}),B(60-qt)};C();const J=setInterval(C,1e3);return()=>clearInterval(J)},[]),v.useEffect(()=>{const C=setInterval(()=>{Is(J=>(J+1)%Hp.length)},8e3);return()=>clearInterval(C)},[]),v.useEffect(()=>{if(!n||!t)return;(async()=>{let J=null,Ce=0,tt=[],Tt=!1,Dt=null;try{const lt=Jc(new Date),qt=await As(He(pe,"clientProgrammes",t.id));if(qt.exists()){const mr=qt.data(),vn=_D[mr.templateId];if(de(!0),vn){const _r=mr.completedSessions||{},Mr=Object.keys(_r).length,Ga=vn.duration*vn.daysPerWeek;F(Ga>0?Math.round(Mr/Ga*100):0);const sl=mr.templateId.replace(/_/g," ").replace(/\b\w/g,da=>da.toUpperCase());te(sl);const nl=kD[mr.templateId];let kr=!1;for(let da=1;da<=vn.duration&&!kr;da++)for(let ha=0;ha<vn.daysPerWeek&&!kr;ha++)_r[`w${da}d${ha}`]||(ft({week:da,dayIdx:ha,label:nl?.[ha]||`Day ${ha+1}`}),kr=!0);kr||(Ve(!0),Tt=!0)}}const Xt=Ot(pe,"workoutLogs"),ls=Os(Xt,fs("clientId","==",t.id));J=await Es(ls),ae(J.docs.length);const Qt=new Date,ws=Qt.getDay(),Qn=ws===0?6:ws-1,xr=new Date(Qt);xr.setDate(Qt.getDate()-Qn),xr.setHours(0,0,0,0);const rn=xr.getTime(),tn=J.docs.filter(mr=>{const vn=mr.data().completedAt;return vn?(vn.toDate?vn.toDate().getTime():new Date(vn).getTime())>=rn:!1}).length;L(tn);const Xn=Ot(pe,"habitLogs"),fn=Os(Xn,fs("clientId","==",t.id),fs("date","==",lt)),zn=await Es(fn);let hr=0;if(!zn.empty){const mr=zn.docs[0].data().habits||{};hr=Object.values(mr).filter(Boolean).length}Ae(Math.round(hr/Gi*100)),I(hr);const tr=await As(He(pe,"nutritionTargets",t.id));tr.exists()&&(D(tr.data()),Dt=tr.data());const wr=await As(He(pe,"nutritionLogs",`${t.id}_${lt}`));if(wr.exists()){const vn=(wr.data().entries||[]).reduce((_r,Mr)=>({protein:_r.protein+(Mr.protein||0),carbs:_r.carbs+(Mr.carbs||0),fats:_r.fats+(Mr.fats||0),calories:_r.calories+(Mr.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});M(vn)}}catch(lt){console.error("Error loading dashboard stats:",lt)}try{let lt=[];const qt=await As(He(pe,"coreBuddyPBs",t.id));if(qt.exists()){const Xt=qt.data().exercises||{};De(Object.keys(Xt).length),Ce=Object.keys(Xt).length,lt=Object.entries(Xt).sort(([,ls],[,Qt])=>(Qt.weight||0)-(ls.weight||0)).slice(0,3).map(([ls,Qt])=>({name:ls,weight:Qt.weight,reps:Qt.reps}))}tt=lt,ze(lt)}catch(lt){console.error("PB fetch error:",lt)}try{const lt=Ot(pe,"clients"),qt=Os(lt,fs("leaderboardOptIn","==",!0)),ls=(await Es(qt)).docs.map(Qt=>({id:Qt.id,name:Qt.data().name,photoURL:Qt.data().photoURL||null}));it(ls.slice(0,3))}catch(lt){console.error("Leaderboard preview error:",lt)}try{let lt=0;if(J){const rn=J.docs.map(tn=>tn.data().date).filter(Boolean).sort().reverse();if(rn.length>0){const tn=new Date;let Xn=new Date(tn);e:for(let fn=0;fn<52;fn++){const zn=new Date(Xn),hr=zn.getDay(),tr=hr===0?6:hr-1;zn.setDate(zn.getDate()-tr),zn.setHours(0,0,0,0);const wr=new Date(zn);wr.setDate(wr.getDate()+7);const mr=Jc(zn),vn=Jc(wr);if(rn.some(Mr=>Mr>=mr&&Mr<vn))lt++;else{if(fn>0)break e;break}Xn.setDate(Xn.getDate()-7)}}}$t(lt);let qt=0;for(let rn=0;rn<30;rn++){const tn=new Date;tn.setDate(tn.getDate()-rn);const Xn=Jc(tn);try{const fn=await Es(Os(Ot(pe,"habitLogs"),fs("clientId","==",t.id),fs("date","==",Xn)));if(fn.empty)break;{const zn=fn.docs[0].data().habits||{};if(Object.values(zn).filter(Boolean).length>=Gi)qt++;else break}}catch{break}}Ws(qt);let Xt=0;for(let rn=0;rn<30;rn++){const tn=new Date;tn.setDate(tn.getDate()-rn);const Xn=Jc(tn);try{const fn=await As(He(pe,"nutritionLogs",`${t.id}_${Xn}`));if(fn.exists()&&(fn.data().entries||[]).length>0)if(Dt){const hr=(fn.data().entries||[]).reduce((tr,wr)=>({protein:tr.protein+(wr.protein||0),carbs:tr.carbs+(wr.carbs||0),fats:tr.fats+(wr.fats||0)}),{protein:0,carbs:0,fats:0});if(hr.protein>=(Dt.protein||0)&&hr.carbs>=(Dt.carbs||0)&&hr.fats>=(Dt.fats||0))Xt++;else break}else Xt++;else break}catch{break}}St(Xt);const ls=J?J.docs.length:0,Qt=[],ws=rn=>Qt.push(rn);ls>=1&&ws("first_workout"),ls>=10&&ws("workouts_10"),ls>=25&&ws("workouts_25"),ls>=50&&ws("workouts_50"),ls>=100&&ws("workouts_100"),lt>=2&&ws("streak_2"),lt>=4&&ws("streak_4"),lt>=8&&ws("streak_8"),Ce>=1&&ws("first_pb"),Ce>=5&&ws("pbs_5"),Ce>=10&&ws("pbs_10"),Ce>=100&&ws("pbs_100"),Xt>=7&&ws("nutrition_7"),t.leaderboardOptIn&&ws("leaderboard_join"),qt>=7&&ws("habits_7"),ne(Qt);const Qn=nt.current;if(Qn!==null){const rn=Qt.filter(tn=>!Qn.includes(tn));if(rn.length>0){const tn=Hn.find(Xn=>Xn.id===rn[rn.length-1]);tn&&setTimeout(()=>vt(tn),600)}}nt.current=Qt;const xr={};Qt.forEach(rn=>{xr[rn]={unlockedAt:new Date().toISOString()}}),Ss(He(pe,"achievements",t.id),{badges:xr,progress:{streakWeeks:lt,pbCount:Ce,nutritionStreak:Xt,habitStreak:qt},updatedAt:new Date().toISOString()},{merge:!0}).catch(()=>{})}catch(lt){console.error("Achievement computation error:",lt)}R(!0)})()},[n,t]),v.useEffect(()=>{if(!(!me||!t))try{sessionStorage.setItem(`cbDash_${t.id}`,JSON.stringify({programmePct:$,programmeName:V,totalWorkouts:K,habitWeekPct:ye,nutritionTotals:E,nutritionTargetData:O,todayHabitsCount:q,nextSession:qe,hasProgramme:W,programmeComplete:Ie,weeklyWorkouts:ee,pbCount:se,topPBs:ue,leaderboardTop3:Le,unlockedBadges:mt,streakWeeks:$e}))}catch{}},[me,$,V,K,ye,E,O,q,qe,W,Ie,ee,se,ue,Le,mt,$e,t]);const xe=v.useCallback(async()=>{if(js.current=!0,ss(!1),l({tourComplete:!0}),t?.id){try{localStorage.setItem(`tourDone_${t.id}`,"1")}catch{}try{await La(He(pe,"clients",t.id),{tourComplete:!0})}catch(C){console.error("Failed to save tour completion:",C)}}},[t,l]),be=C=>{const J=C.currentTarget,Ce=J.querySelector(".ripple");Ce&&Ce.remove();const tt=J.getBoundingClientRect(),Tt=Math.max(tt.width,tt.height),Dt=C.clientX-tt.left-Tt/2,lt=C.clientY-tt.top-Tt/2,qt=document.createElement("span");qt.className="ripple",qt.style.cssText=`width:${Tt}px;height:${Tt}px;left:${Dt}px;top:${lt}px;`,J.appendChild(qt),setTimeout(()=>qt.remove(),600)},Je=t?.name?.split(" ")[0]||"there",{prev:Xe,next:ut}=wD(K),Kt=ut>Xe?Math.round((K-Xe)/(ut-Xe)*100):100,Yt=[{label:"Programme",value:`${$}%`,pct:$,color:"#14b8a6",size:"normal"},{label:"Workouts",value:`${K}`,pct:Kt,color:"var(--color-primary)",size:"large"},{label:"Habits Today",value:`${ye}%`,pct:ye,color:"#38B6FF",size:"normal"}],Ft=C=>!O||!O[C]?0:Math.min(Math.round(E[C]/O[C]*100),100),Sn=(()=>{const C=new Date().getHours();return me&&q>=Gi&&E.calories>0?{main:"Smashed it today,",sub:"Rest up and go again tomorrow."}:C>=5&&C<12?{main:"Rise and grind,",sub:"let's get after it!"}:C>=12&&C<17?{main:"Oye",sub:"crack on and make it count!"}:C>=17&&C<21?{main:"Evening session?",sub:"Let's finish strong!"}:{main:"Burning the midnight oil,",sub:"Respect the hustle!"}})(),Mt=me?W&&qe&&!Ie?{label:"NEXT SESSION",message:`Week ${qe.week}, Day ${qe.dayIdx+1}  ${qe.label}`,cta:"Continue",action:()=>y("/client/core-buddy/programmes"),pct:$,ringLabel:`${$}%`}:q<Gi?{label:"DAILY HABITS",message:`${q}/${Gi} completed`,cta:"Open Habits",action:()=>y("/client/core-buddy/consistency"),pct:ye,ringLabel:`${q}/${Gi}`}:E.calories===0?{label:"NUTRITION",message:"No meals logged today",cta:"Log Meal",action:()=>y("/client/core-buddy/nutrition"),pct:0,ringLabel:"0"}:W?Ie?{label:"COMPLETE",message:"Programme finished!",cta:"New Programme",action:()=>y("/client/core-buddy/workouts"),pct:100,ringLabel:"100%"}:{label:"TODAY",message:"You're crushing it!",cta:null,action:null,pct:100,ringLabel:""}:{label:"PROGRAMMES",message:"Start a programme to level up",cta:"Browse",action:()=>y("/client/core-buddy/workouts"),pct:0,ringLabel:""}:null,Ds=v.useCallback(async()=>{if(t){G(!0);try{const C=await Es(Os(Ot(pe,"posts"),fs("authorId","==",t.id),Kh("createdAt","desc"),Yh(30)));Wt(C.docs.map(Ce=>({id:Ce.id,...Ce.data()})));const J=await Es(Os(Ot(pe,"postLikes"),fs("userId","==",t.id)));Ge(new Set(J.docs.map(Ce=>Ce.data().postId)))}catch(C){console.error("Error loading journey:",C)}finally{G(!1)}}},[t]);v.useEffect(()=>{me&&t&&Ds()},[me,t,Ds]);const bn=C=>{const J=C.target.files?.[0];if(J){if(!J.type.startsWith("image/")){Lt("Please select an image file","error");return}if(J.size>10*1024*1024){Lt("Image must be under 10MB","error");return}ke(J),ot(URL.createObjectURL(J))}},Wn=()=>{ke(null),Qe&&URL.revokeObjectURL(Qe),ot(null),xt.current&&(xt.current.value="")},Rs=async()=>{if(!(!he.trim()&&!Oe||Y||!t)){re(!0);try{let C=null;if(Oe){const tt=await jD(Oe),Tt=`${Date.now()}_${Math.random().toString(36).slice(2,8)}`,Dt=to(so,`postImages/${t.id}/${Tt}`);await zp(Dt,tt),C=await Ho(Dt)}await la(Ot(pe,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:he.trim(),type:C?"image":"text",imageURL:C||null,createdAt:br(),likeCount:0,commentCount:0});const Ce=he.trim().match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Ce){const tt=new Set;Ce.forEach(Tt=>{const Dt=Tt.slice(1).trim(),lt=Tn.find(qt=>qt.name&&qt.name.toLowerCase()===Dt.toLowerCase());lt&&!tt.has(lt.id)&&(tt.add(lt.id),cr(lt.id,"mention",{}))})}Ee(""),Wn(),ct.current&&(ct.current.style.height="auto"),await Ds(),Lt("Posted!","success")}catch(C){console.error("Error posting:",C),Lt(C?.message||"Failed to post","error")}finally{re(!1)}}},Zs=async C=>{if(window.confirm("Delete this post?"))try{await Sr(He(pe,"posts",C)),Wt(J=>J.filter(Ce=>Ce.id!==C)),Lt("Post deleted","info")}catch(J){console.error("Delete error:",J),Lt("Failed to delete","error")}},Zt=async C=>{if(!t)return;const J=t.id,Ce=`${C}_${J}`,tt=We.has(C),Tt=new Set(We);tt?Tt.delete(C):Tt.add(C),Ge(Tt),Wt(Dt=>Dt.map(lt=>lt.id===C?{...lt,likeCount:Math.max(0,(lt.likeCount||0)+(tt?-1:1))}:lt));try{if(tt)await Sr(He(pe,"postLikes",Ce)),await La(He(pe,"posts",C),{likeCount:Uo(-1)});else{await Ss(He(pe,"postLikes",Ce),{postId:C,userId:J,createdAt:br()}),await La(He(pe,"posts",C),{likeCount:Uo(1)});const Dt=ps.find(lt=>lt.id===C);Dt&&cr(Dt.authorId,"like",{postId:C})}}catch(Dt){console.error("Like error:",Dt),Ds()}},en=async C=>{try{const J=await Es(Os(Ot(pe,"postComments"),fs("postId","==",C),Kh("createdAt","asc"),Yh(50)));gt(Ce=>({...Ce,[C]:J.docs.map(tt=>({id:tt.id,...tt.data()}))}))}catch(J){console.error("Error loading comments:",J)}},mn=C=>{const J=new Set(rt);J.has(C)?J.delete(C):(J.add(C),jt[C]||en(C)),bt(J)},Gn=async C=>{const J=(Gt[C]||"").trim(),Ce=_e[C];if(!(!J&&!Ce||!t)){ks(tt=>({...tt,[C]:!0}));try{let tt=null;if(Ce){const Xt=to(so,`comment-images/${Date.now()}_${Ce.name}`);await zp(Xt,Ce),tt=await Ho(Xt)}const Tt={postId:C,authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:J||"",createdAt:br()};tt&&(Tt.imageURL=tt);const Dt=Us[C];Dt&&(Tt.replyToId=Dt.id,Tt.replyToName=Dt.authorName),await la(Ot(pe,"postComments"),Tt),await La(He(pe,"posts",C),{commentCount:Uo(1)});const lt=ps.find(Xt=>Xt.id===C);lt&&cr(lt.authorId,"comment",{postId:C});const qt=J.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(qt){const Xt=new Set;qt.forEach(ls=>{const Qt=ls.slice(1).trim(),ws=Tn.find(Qn=>Qn.name&&Qn.name.toLowerCase()===Qt.toLowerCase());ws&&!Xt.has(ws.id)&&(Xt.add(ws.id),cr(ws.id,"mention",{postId:C}))})}Gs(Xt=>({...Xt,[C]:""})),Ne(Xt=>({...Xt,[C]:null})),je(Xt=>({...Xt,[C]:null})),H(Xt=>({...Xt,[C]:null})),Ze.current[C]&&(Ze.current[C].value=""),Wt(Xt=>Xt.map(ls=>ls.id===C?{...ls,commentCount:(ls.commentCount||0)+1}:ls)),await en(C)}catch(tt){console.error("Comment error:",tt),Lt("Failed to comment","error")}finally{ks(tt=>({...tt,[C]:!1}))}}},Kn=async(C,J)=>{try{await Sr(He(pe,"postComments",J)),await La(He(pe,"posts",C),{commentCount:Uo(-1)}),gt(Ce=>({...Ce,[C]:(Ce[C]||[]).filter(tt=>tt.id!==J)})),Wt(Ce=>Ce.map(tt=>tt.id===C?{...tt,commentCount:Math.max((tt.commentCount||1)-1,0)}:tt))}catch(Ce){console.error("Delete comment error:",Ce),Lt("Failed to delete comment","error")}},Nn=(C,J)=>{const Ce=J.target.files?.[0];if(!Ce)return;if(Ce.size>5*1024*1024){Lt("Image must be under 5MB","error");return}Ne(Tt=>({...Tt,[C]:Ce}));const tt=new FileReader;tt.onload=Tt=>je(Dt=>({...Dt,[C]:Tt.target.result})),tt.readAsDataURL(Ce)},Yn=C=>{Ne(J=>({...J,[C]:null})),je(J=>({...J,[C]:null})),Ze.current[C]&&(Ze.current[C].value="")},ur=C=>{Ee(C.target.value),C.target.style.height="auto",C.target.style.height=Math.min(C.target.scrollHeight,120)+"px",ds(C.target.value,"compose")},dr=(C,J)=>{Gs(Ce=>({...Ce,[C]:J})),ds(J,C)};return r.jsx(Ta,{children:r.jsxs("div",{className:"cb-dashboard","data-theme":d?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsxs("div",{className:"header-notif-wrap",ref:gn,children:[r.jsxs("button",{className:"header-notif-btn",onClick:()=>{hn(!Cs),Cs||qs()},"aria-label":"Notifications",children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),r.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),cs>0&&r.jsx("span",{className:"header-notif-badge",children:cs>9?"9+":cs})]}),Cs&&r.jsxs("div",{className:"notif-panel",children:[r.jsxs("div",{className:"notif-panel-header",children:[r.jsx("span",{className:"notif-panel-title",children:"Notifications"}),kt.length>0&&r.jsx("button",{className:"notif-clear-btn",onClick:En,children:"Clear all"})]}),r.jsx("div",{className:"notif-panel-list",children:kt.length===0?r.jsx("div",{className:"notif-empty",children:"No notifications yet"}):kt.map(C=>r.jsxs("div",{className:`notif-item${C.read?"":" unread"}`,onClick:()=>{if(hn(!1),C.type==="buddy_request"||C.type==="buddy_accept")y("/client/core-buddy/buddies");else if((C.type==="like"||C.type==="comment")&&C.postId){if(!rt.has(C.postId)){const J=new Set(rt);J.add(C.postId),bt(J),jt[C.postId]||en(C.postId)}setTimeout(()=>{const J=document.getElementById(`post-${C.postId}`);J&&J.scrollIntoView({behavior:"smooth",block:"center"})},150)}else C.type==="like"||C.type==="comment"?document.querySelector(".cb-journey-section")?.scrollIntoView({behavior:"smooth"}):C.type==="mention"&&y(`/client/core-buddy/profile/${C.fromId}`)},children:[r.jsx("div",{className:"notif-item-avatar",children:C.fromPhotoURL?r.jsx("img",{src:C.fromPhotoURL,alt:""}):r.jsx("span",{children:(C.fromName||"?")[0]})}),r.jsxs("div",{className:"notif-item-body",children:[r.jsxs("p",{className:"notif-item-text",children:[r.jsx("strong",{children:C.fromName})," ",C.type==="buddy_request"&&"sent you a buddy request",C.type==="buddy_accept"&&"accepted your buddy request",C.type==="like"&&"liked your post",C.type==="comment"&&"commented on your post",C.type==="mention"&&"mentioned you"]}),r.jsx("span",{className:"notif-item-time",children:$p(C.createdAt)})]})]},C.id))})]})]}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsxs("div",{className:"header-actions",children:[r.jsx("button",{onClick:p,"aria-label":"Toggle theme",children:d?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})}),r.jsx("button",{onClick:i,"aria-label":"Log out",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),r.jsx("polyline",{points:"16 17 21 12 16 7"}),r.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),r.jsxs("main",{className:"cb-main",children:[r.jsxs("div",{className:"cb-ring-container",children:[r.jsxs("div",{className:"cb-ring",children:[r.jsx("svg",{className:"cb-ring-svg",viewBox:"0 0 200 200",children:tb.map((C,J)=>{const Ce=J<T;return r.jsx("line",{x1:C.x1,y1:C.y1,x2:C.x2,y2:C.y2,className:`ring-tick ${Ce?"elapsed":"remaining"}`,strokeWidth:C.thick?"3":"2"},J)})}),r.jsxs("div",{className:"cb-ring-center",children:[r.jsxs("div",{className:"cb-ring-logo",onClick:()=>dt.current?.click(),role:"button",tabIndex:0,"aria-label":"Change profile photo",children:[r.jsx("img",{src:pt||"/Logo.webp",alt:pt?"Profile":"Mind Core Fitness"}),r.jsx("div",{className:`cb-photo-overlay${Ht?" uploading":""}`,children:Ht?r.jsx("div",{className:"cb-photo-spinner"}):r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[r.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),r.jsx("input",{ref:dt,type:"file",accept:"image/*",onChange:X,style:{display:"none"}})]}),!pt&&!Ht&&r.jsx("div",{className:"cb-photo-badge",onClick:()=>dt.current?.click(),children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[r.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),r.jsxs("div",{className:"cb-ring-countdown",children:[r.jsx("span",{className:"cb-timer-digit",children:String(x.hours).padStart(2,"0")}),r.jsx("span",{className:"cb-timer-colon",children:":"}),r.jsx("span",{className:"cb-timer-digit",children:String(x.minutes).padStart(2,"0")}),r.jsx("span",{className:"cb-timer-colon",children:":"}),r.jsx("span",{className:"cb-timer-digit cb-timer-seconds",children:String(x.seconds).padStart(2,"0")})]}),r.jsx("span",{className:"cb-ring-label",children:"remaining today"}),r.jsxs("p",{className:"cb-ring-tagline",children:[Hp[is].text," ",r.jsx("strong",{children:Hp[is].bold})]},is)]}),r.jsx("div",{className:"cb-stats-row",children:Yt.map(C=>{const J=(C.size==="large",38),Ce=2*Math.PI*J,tt=Ce-C.pct/100*Ce;return r.jsxs("div",{className:`cb-stat-item${C.size==="large"?" cb-stat-large":""}`,children:[r.jsxs("div",{className:"cb-stat-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-stat-track",cx:"50",cy:"50",r:J}),r.jsx("circle",{className:"cb-stat-fill",cx:"50",cy:"50",r:J,style:{stroke:C.color},strokeDasharray:Ce,strokeDashoffset:tt})]}),r.jsx("span",{className:"cb-stat-value",style:{color:C.color},children:C.value})]}),r.jsx("span",{className:"cb-stat-label",children:C.label})]},C.label)})}),r.jsxs("p",{className:"cb-coach-msg",children:[Sn.main," ",r.jsx("strong",{children:Je}),"  ",Sn.sub]}),Mt&&r.jsxs("button",{className:"cb-nudge-card",onClick:Mt.action||void 0,style:Mt.action?void 0:{cursor:"default"},children:[r.jsxs("div",{className:"cb-nudge-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-nudge-ring-track",cx:"50",cy:"50",r:"38"}),r.jsx("circle",{className:"cb-nudge-ring-fill",cx:"50",cy:"50",r:"38",strokeDasharray:2*Math.PI*38,strokeDashoffset:2*Math.PI*38-Mt.pct/100*2*Math.PI*38})]}),r.jsx("span",{className:"cb-nudge-ring-val",children:Mt.ringLabel})]}),r.jsxs("div",{className:"cb-nudge-info",children:[r.jsx("span",{className:"cb-nudge-label",children:Mt.label}),r.jsx("span",{className:"cb-nudge-title",children:Mt.message}),Mt.cta&&r.jsxs("span",{className:"cb-nudge-cta",children:[Mt.cta," "]})]})]}),r.jsxs("div",{className:"cb-features",children:[t?.buddyEnabled&&r.jsxs("button",{className:"cb-feature-card cb-card-buddy ripple-btn",onClick:C=>{be(C),y("/client/core-buddy/buddy")},children:[r.jsx("div",{className:"cb-buddy-icon",children:r.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 2a4 4 0 0 1 4 4v2a4 4 0 0 1-8 0V6a4 4 0 0 1 4-4z"}),r.jsx("path",{d:"M18 14c2 1 3 3 3 5v2H3v-2c0-2 1-4 3-5"}),r.jsx("circle",{cx:"9",cy:"7",r:"0.5",fill:"currentColor"}),r.jsx("circle",{cx:"15",cy:"7",r:"0.5",fill:"currentColor"}),r.jsx("path",{d:"M9.5 10a2.5 2.5 0 0 0 5 0"}),r.jsx("path",{d:"M7 13c1.5 1 3.5 1.5 5 1.5s3.5-.5 5-1.5"})]})}),r.jsxs("div",{className:"cb-card-content",children:[r.jsxs("h3",{children:["Buddy ",r.jsx("span",{className:"cb-buddy-badge",children:"AI"})]}),r.jsx("p",{className:"cb-card-desc",children:"Your AI training partner"})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("button",{className:`cb-feature-card cb-card-nutrition cb-card-has-preview ripple-btn${g?"":" cb-card-locked"}`,onClick:C=>{be(C),y(g?"/client/core-buddy/nutrition":"/upgrade")},children:[r.jsxs("div",{className:"cb-card-top-row",children:[r.jsx("div",{className:"cb-card-content",children:r.jsxs("h3",{children:["Today's Nutrition ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]})}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsx("div",{className:"cb-card-preview-row",children:r.jsx("div",{className:"cb-mini-rings",children:[{label:"P",pct:Ft("protein"),color:"#14b8a6"},{label:"C",pct:Ft("carbs"),color:"var(--color-primary)"},{label:"F",pct:Ft("fats"),color:"#eab308"},{label:"Cal",pct:Ft("calories"),color:"#38B6FF"}].map(C=>{const Ce=2*Math.PI*38,tt=Ce-C.pct/100*Ce;return r.jsxs("div",{className:"cb-mini-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-mini-track",cx:"50",cy:"50",r:38}),r.jsx("circle",{className:"cb-mini-fill",cx:"50",cy:"50",r:38,style:{stroke:C.color},strokeDasharray:Ce,strokeDashoffset:tt})]}),r.jsx("span",{style:{color:C.color},children:C.label})]},C.label)})})}),r.jsx("p",{className:"cb-card-desc",children:"Track macros, scan barcodes, log water"})]}),r.jsxs("button",{className:"cb-feature-card cb-card-workouts-hero ripple-btn",onClick:C=>{be(C),y("/client/core-buddy/workouts")},children:[r.jsx("h3",{className:"cb-hero-title",children:"Workouts"}),r.jsxs("div",{className:"cb-hero-stats",children:[r.jsxs("span",{children:[ee," this week"]}),r.jsx("span",{className:"cb-hero-dot",children:""}),r.jsxs("span",{children:[K," total"]})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("div",{className:"cb-grid-row",children:[r.jsxs("button",{className:`cb-feature-card cb-grid-card cb-card-consistency ripple-btn${g?"":" cb-card-locked"}`,onClick:C=>{be(C),y(g?"/client/core-buddy/consistency":"/upgrade")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsxs("h3",{children:["Habits ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),r.jsx("div",{className:"cb-habit-dots",children:Array.from({length:Gi},(C,J)=>r.jsx("span",{className:`cb-habit-dot${J<q?" done":""}`},J))}),r.jsxs("span",{className:"cb-habit-dots-label",children:[q,"/",Gi," today"]})]}),r.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("button",{className:`cb-feature-card cb-grid-card cb-card-progress ripple-btn${g?"":" cb-card-locked"}`,onClick:C=>{be(C),y(g?"/client/personal-bests?mode=corebuddy":"/upgrade")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsxs("h3",{children:["PBs ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),ue.length>0?r.jsx("div",{className:"cb-pb-preview",children:ue.slice(0,2).map(C=>r.jsxs("div",{className:"cb-pb-entry",children:[r.jsx("span",{className:"cb-pb-name",children:C.name}),r.jsxs("span",{className:"cb-pb-value",children:[C.weight,"kg"]})]},C.name))}):r.jsxs("div",{className:"cb-progress-preview",children:[r.jsx("svg",{className:"cb-progress-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),r.jsx("span",{children:"Start lifting!"})]})]}),r.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]})]}),r.jsxs("button",{className:`cb-feature-card cb-card-leaderboard ripple-btn${g?"":" cb-card-locked"}`,onClick:C=>{be(C),y(g?"/client/leaderboard":"/upgrade")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsxs("h3",{children:["Leaderboard ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),Le.length>0?r.jsx("div",{className:"cb-lb-preview",children:Le.map((C,J)=>{const Ce=["#FFD700","#A8B4C0","#CD7F32"][J],tt=C.name?C.name.split(" ").map(Dt=>Dt[0]).join("").slice(0,2).toUpperCase():"?",Tt=C.id===t?.id;return r.jsxs("div",{className:`cb-lb-entry${Tt?" cb-lb-me":""}`,children:[r.jsx("div",{className:"cb-lb-avatar",style:{borderColor:Ce},children:C.photoURL?r.jsx("img",{src:C.photoURL,alt:"",className:"cb-lb-avatar-img"}):r.jsx("span",{children:tt})}),r.jsxs("span",{className:"cb-lb-rank",style:{color:Ce},children:["#",J+1]})]},C.id)})}):r.jsx("p",{children:"Opt in to compete with your Core Buddies"})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("button",{className:`cb-feature-card cb-card-buddies ripple-btn${g?"":" cb-card-locked"}`,onClick:C=>{be(C),y(g?"/client/core-buddy/buddies":"/upgrade")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsxs("h3",{children:["Buddies ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),r.jsx("p",{children:"Connect with other members and track each other's progress"})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("div",{className:`cb-achievements-section${g?"":" cb-card-locked"}`,children:[r.jsxs("h3",{className:"cb-achievements-title",children:["Achievements ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),g?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"cb-badges-scroll",children:Hn.map(C=>{const J=mt.includes(C.id);return r.jsx("button",{className:`cb-badge${J?" unlocked":" locked"}`,onClick:()=>Pt(C),children:r.jsx("img",{src:C.img,alt:C.name,className:"cb-badge-img"})},C.id)})}),r.jsxs("p",{className:"cb-badges-count",children:[mt.length,"/",Hn.length," unlocked"]})]}):r.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>y("/upgrade"),children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),r.jsx("span",{children:"Upgrade to unlock achievements"})]})]}),r.jsxs("div",{className:"cb-journey-section",children:[r.jsxs("h3",{className:"cb-journey-title",children:["My Journey ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),g?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"journey-compose",children:[r.jsx("div",{className:"journey-compose-avatar",children:pt?r.jsx("img",{src:pt,alt:""}):r.jsx("span",{children:Zc(t?.name)})}),r.jsxs("div",{className:"journey-compose-body",style:{position:"relative"},children:[r.jsx("textarea",{ref:ct,placeholder:"Share your progress... (use @ to mention)",value:he,onChange:ur,rows:1,maxLength:500}),k&&P==="compose"&&fe.length>0&&r.jsx("div",{className:"mention-dropdown",children:fe.map(C=>r.jsxs("button",{className:"mention-option",onClick:()=>Xr(C,"compose"),children:[r.jsx("div",{className:"mention-option-avatar",children:C.photoURL?r.jsx("img",{src:C.photoURL,alt:""}):r.jsx("span",{children:Zc(C.name)})}),r.jsx("span",{children:C.name})]},C.id))}),Qe&&r.jsxs("div",{className:"journey-image-preview",children:[r.jsx("img",{src:Qe,alt:"Preview"}),r.jsx("button",{className:"journey-image-remove",onClick:Wn,"aria-label":"Remove image",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),r.jsxs("div",{className:"journey-compose-actions",children:[r.jsx("button",{className:"journey-image-btn",onClick:()=>xt.current?.click(),"aria-label":"Add image",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),r.jsx("input",{ref:xt,type:"file",accept:"image/*",onChange:bn,hidden:!0}),(he.trim()||Oe)&&r.jsx("button",{className:"journey-post-btn",onClick:Rs,disabled:Y,children:Y?r.jsx("div",{className:"journey-btn-spinner"}):"Post"})]})]})]}),we?r.jsx("div",{className:"journey-loading",children:r.jsx("div",{className:"cb-spinner"})}):ps.length===0?r.jsxs("div",{className:"journey-empty",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]}),r.jsx("p",{children:"Start sharing your fitness journey!"})]}):r.jsx("div",{className:"journey-list",children:ps.map(C=>r.jsxs("div",{id:`post-${C.id}`,className:"journey-post",children:[r.jsxs("div",{className:"journey-post-header",children:[r.jsx("div",{className:"journey-post-avatar",children:C.authorPhotoURL?r.jsx("img",{src:C.authorPhotoURL,alt:""}):r.jsx("span",{children:Zc(C.authorName)})}),r.jsxs("div",{className:"journey-post-meta",children:[r.jsx("span",{className:"journey-post-name",children:C.authorName}),r.jsx("span",{className:"journey-post-time",children:$p(C.createdAt)})]}),r.jsx("button",{className:"journey-delete-btn",onClick:()=>Zs(C.id),"aria-label":"Delete post",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),C.type==="workout_summary"&&C.metadata?r.jsxs("div",{className:"journey-card",children:[r.jsx("div",{className:"journey-card-logo-frame",children:r.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),r.jsx("h3",{className:"journey-card-title",children:C.metadata.title}),C.metadata.stats?.length>0&&r.jsx("p",{className:"journey-card-stats-line",children:C.metadata.stats.map(J=>`${J.value} ${J.label}`).join("    ")}),!C.metadata.stats?.length&&C.metadata.subtitle&&r.jsx("p",{className:"journey-card-stats-line",children:C.metadata.subtitle}),r.jsx("p",{className:"journey-card-cta",children:"I just completed a workout using Core Buddy "}),r.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):C.type==="badge_earned"&&C.metadata?r.jsxs("div",{className:"journey-card",children:[r.jsx("div",{className:"journey-card-logo-frame journey-card-logo-badge",children:r.jsx("img",{src:(Hn.find(J=>J.name===C.metadata.title)||Hn.find(J=>C.metadata.badges?.includes(J.name)))?.img||"/Logo.webp",alt:C.metadata.title,className:"journey-card-logo-img"})}),r.jsx("h3",{className:"journey-card-title",children:C.metadata.title}),(C.metadata.badgeDesc||(Hn.find(J=>J.name===C.metadata.title)||Hn.find(J=>C.metadata.badges?.includes(J.name)))?.desc)&&r.jsx("p",{className:"journey-card-stats-line",children:C.metadata.badgeDesc||(Hn.find(J=>J.name===C.metadata.title)||Hn.find(J=>C.metadata.badges?.includes(J.name)))?.desc}),r.jsx("p",{className:"journey-card-cta",children:"I just earned a badge on Core Buddy "}),r.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):C.type==="habits_summary"&&C.metadata?r.jsxs("div",{className:"journey-card",children:[r.jsx("div",{className:"journey-card-logo-frame",children:r.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),r.jsx("h3",{className:"journey-card-title",children:C.metadata.title}),C.metadata.stats?.length>0&&r.jsx("p",{className:"journey-card-stats-line",children:C.metadata.stats.map(J=>`${J.value} ${J.label}`).join("    ")}),C.metadata.subtitle&&r.jsx("p",{className:"journey-card-stats-line",children:C.metadata.subtitle}),r.jsx("p",{className:"journey-card-cta",children:"I just completed my daily habits with Core Buddy "}),r.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):r.jsxs(r.Fragment,{children:[C.content&&r.jsx("p",{className:"journey-post-content",children:Dn(C.content)}),C.imageURL&&r.jsx("div",{className:"journey-post-image",children:r.jsx("img",{src:C.imageURL,alt:"Post",loading:"lazy"})})]}),r.jsxs("div",{className:"journey-post-actions",children:[r.jsxs("button",{className:`journey-action-btn${We.has(C.id)?" liked":""}`,onClick:()=>Zt(C.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:We.has(C.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),r.jsx("span",{children:C.likeCount||0})]}),r.jsxs("button",{className:`journey-action-btn${rt.has(C.id)?" active":""}`,onClick:()=>mn(C.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),r.jsx("span",{children:C.commentCount||0})]})]}),rt.has(C.id)&&r.jsxs("div",{className:"journey-comments",children:[jt[C.id]?.length>0?jt[C.id].map(J=>r.jsxs("div",{className:"journey-comment",children:[r.jsx("div",{className:"journey-comment-avatar",children:J.authorPhotoURL?r.jsx("img",{src:J.authorPhotoURL,alt:""}):r.jsx("span",{children:Zc(J.authorName)})}),r.jsxs("div",{className:"journey-comment-body",children:[r.jsxs("div",{className:"journey-comment-bubble",children:[r.jsx("span",{className:"journey-comment-name",children:J.authorName}),J.replyToName&&r.jsxs("span",{className:"journey-comment-reply-tag",children:[r.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("polyline",{points:"9 14 4 9 9 4"}),r.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),J.replyToName]}),J.content&&r.jsx("span",{className:"journey-comment-text",children:Dn(J.content)}),J.imageURL&&r.jsx("img",{className:"journey-comment-image",src:J.imageURL,alt:"Comment",loading:"lazy"})]}),r.jsxs("div",{className:"journey-comment-actions-row",children:[r.jsx("span",{className:"journey-comment-time",children:$p(J.createdAt)}),r.jsx("button",{className:"journey-comment-reply-btn",onClick:()=>H(Ce=>({...Ce,[C.id]:{id:J.id,authorName:J.authorName}})),children:"Reply"}),r.jsx("button",{className:"journey-comment-delete-btn",onClick:()=>Kn(C.id,J.id),"aria-label":"Delete comment",children:r.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]})]},J.id)):r.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),Us[C.id]&&r.jsxs("div",{className:"journey-comment-replying",children:[r.jsxs("span",{children:["Replying to ",r.jsx("strong",{children:Us[C.id].authorName})]}),r.jsx("button",{onClick:()=>H(J=>({...J,[C.id]:null})),"aria-label":"Cancel reply",children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),Se[C.id]&&r.jsxs("div",{className:"journey-comment-img-preview",children:[r.jsx("img",{src:Se[C.id],alt:"Preview"}),r.jsx("button",{onClick:()=>Yn(C.id),"aria-label":"Remove image",children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),r.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[r.jsx("button",{className:"journey-comment-img-btn",onClick:()=>Ze.current[C.id]?.click(),"aria-label":"Add image",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),r.jsx("input",{ref:J=>{Ze.current[C.id]=J},type:"file",accept:"image/*",onChange:J=>Nn(C.id,J),hidden:!0}),r.jsx("input",{type:"text",placeholder:"Comment",value:Gt[C.id]||"",onChange:J=>dr(C.id,J.target.value),onKeyDown:J=>{J.key==="Enter"&&Gn(C.id)},maxLength:300}),k&&P===C.id&&fe.length>0&&r.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:fe.map(J=>r.jsxs("button",{className:"mention-option",onClick:()=>Xr(J,C.id),children:[r.jsx("div",{className:"mention-option-avatar",children:J.photoURL?r.jsx("img",{src:J.photoURL,alt:""}):r.jsx("span",{children:Zc(J.name)})}),r.jsx("span",{children:J.name})]},J.id))}),r.jsx("button",{onClick:()=>Gn(C.id),disabled:!(Gt[C.id]||"").trim()&&!_e[C.id]||os[C.id],children:os[C.id]?r.jsx("div",{className:"journey-btn-spinner-sm"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),r.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},C.id))})]}):r.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>y("/upgrade"),children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),r.jsx("span",{children:"Upgrade to share your journey"})]})]})]})]}),Rt&&r.jsx("div",{className:"cb-badge-overlay",onClick:()=>Pt(null),children:r.jsxs("div",{className:"cb-badge-overlay-content",onClick:C=>C.stopPropagation(),children:[r.jsx("img",{src:Rt.img,alt:Rt.name,className:`cb-badge-overlay-img${mt.includes(Rt.id)?"":" cb-badge-overlay-img-locked"}`}),mt.includes(Rt.id)?r.jsx("span",{className:"cb-badge-status unlocked",children:"Unlocked"}):r.jsx("span",{className:"cb-badge-status locked",children:"Locked"}),r.jsx("button",{className:"cb-badge-overlay-close",onClick:()=>Pt(null),children:"Tap to close"})]})}),r.jsx(ua,{active:"home"}),zt&&r.jsxs("div",{className:`toast-notification ${zt.type}`,children:[zt.type==="info"&&r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),r.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),zt.message]}),r.jsx(xD,{steps:us,active:et,onFinish:xe}),At&&r.jsxs("div",{className:"cb-celebration-overlay",onClick:()=>vt(null),children:[r.jsx("div",{className:"cb-confetti-container",children:Array.from({length:30},(C,J)=>r.jsx("span",{className:"cb-confetti-piece",style:{"--angle":`${Math.random()*360}deg`,"--distance":`${80+Math.random()*120}px`,"--delay":`${Math.random()*.3}s`,"--color":["#FFD700","#FF6B6B","#4ECDC4","#45B7D1","#F7DC6F","#BB8FCE","#FF8C42","#38B6FF"][J%8],"--size":`${6+Math.random()*6}px`,"--drift":`${(Math.random()-.5)*60}px`}},J))}),r.jsxs("div",{className:"cb-celebration-content",onClick:C=>C.stopPropagation(),children:[r.jsx("div",{className:"cb-celebration-glow"}),r.jsx("img",{src:At.img,alt:At.name,className:"cb-celebration-badge-img"}),r.jsx("h2",{className:"cb-celebration-title",children:"Badge Unlocked!"}),r.jsx("p",{className:"cb-celebration-name",children:At.name}),r.jsx("button",{className:"cb-celebration-dismiss",onClick:()=>vt(null),children:"Tap to continue"})]})]})]})})}const Wp=new Map;function Ki(){return new Date().toISOString().split("T")[0]}const E2=[{key:"breakfast",label:"Breakfast"},{key:"lunch",label:"Lunch"},{key:"dinner",label:"Dinner"},{key:"snacks",label:"Snacks"}],ED={breakfast:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1"}),r.jsx("path",{d:"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"}),r.jsx("line",{x1:"6",y1:"1",x2:"6",y2:"4"}),r.jsx("line",{x1:"10",y1:"1",x2:"10",y2:"4"}),r.jsx("line",{x1:"14",y1:"1",x2:"14",y2:"4"})]}),lunch:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}),dinner:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),snacks:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})};function SD(){const n=new Date().getHours();return n<11?"breakfast":n<14?"lunch":n<17?"snacks":"dinner"}function ND(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Ur(),{isDark:l,toggleTheme:u,accent:d}=Na(),p=er(),[g,y]=v.useState("loading"),[x,j]=v.useState(null),[T,B]=v.useState({gender:"male",age:"",weight:"",weightUnit:"kg",height:"",heightUnit:"cm",heightFeet:"",heightInches:"",dailyActivity:"sedentary",trainingFrequency:"moderate",goal:"maintain",deficitLevel:"moderate"}),[$,F]=v.useState(null),[V,te]=v.useState(Ki()),[K,ae]=v.useState({entries:[],water:0}),[ye,Ae]=v.useState({protein:0,carbs:0,fats:0,calories:0}),[me,R]=v.useState(!1),[E,M]=v.useState(!1),[O,D]=v.useState(()=>{const k=new Date;return{year:k.getFullYear(),month:k.getMonth()}}),[q,I]=v.useState(SD),[qe,ft]=v.useState(null),[W,de]=v.useState(null),[Ie,Ve]=v.useState(!1),[ee,L]=v.useState(null),[se,De]=v.useState(""),[ue,ze]=v.useState(!1),[Le,it]=v.useState(""),[pt,Ye]=v.useState([]),[Ht,Ms]=v.useState(!1),[dt,mt]=v.useState({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),[ne,Rt]=v.useState(null),[Pt,At]=v.useState("100"),[vt,nt]=v.useState(0),[$e,$t]=v.useState("weight"),[Ns,Ws]=v.useState(0),[Ut,St]=v.useState(null);v.useRef(null);const is=v.useRef(!1),Is=v.useRef(null),zt=v.useRef(null),Js=v.useRef(null),Lt=v.useCallback((k,N="info")=>{St({message:k,type:N}),setTimeout(()=>St(null),3e3)},[]);v.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),v.useEffect(()=>{if(!t?.id)return;(async()=>{try{const N=await As(He(pe,"nutritionTargets",t.id));N.exists()?(j(N.data()),y("dashboard")):y("setup")}catch(N){console.error("Error loading nutrition data:",N),y("setup")}})()},[t?.id]),v.useEffect(()=>{if(!t?.id)return;(async()=>{try{const N=await As(He(pe,"nutritionLogs",`${t.id}_${V}`));if(N.exists()){const P=N.data();ae({entries:P.entries||[],water:P.water||0})}else ae({entries:[],water:0})}catch(N){console.error("Error loading log:",N),ae({entries:[],water:0})}})()},[t?.id,V]),v.useEffect(()=>{const k=K.entries.reduce((N,P)=>({protein:N.protein+(P.protein||0),carbs:N.carbs+(P.carbs||0),fats:N.fats+(P.fats||0),calories:N.calories+(P.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});Ae(k)},[K.entries]);const ps=async k=>{try{await Ss(He(pe,"nutritionLogs",`${t.id}_${V}`),{clientId:t.id,date:V,entries:k.entries,water:k.water,updatedAt:_t.now()})}catch(N){console.error("Error saving nutrition log:",N)}},Wt=V===Ki(),we=(k,N)=>new Date(k,N+1,0).getDate(),G=(k,N)=>new Date(k,N,1).getDay(),he=["January","February","March","April","May","June","July","August","September","October","November","December"],Ee=["Su","Mo","Tu","We","Th","Fr","Sa"],Oe=()=>{let k=parseFloat(T.weight);T.weightUnit==="lbs"&&(k*=.453592);let N;T.heightUnit==="cm"?N=parseFloat(T.height):N=(parseFloat(T.heightFeet)||0)*30.48+(parseFloat(T.heightInches)||0)*2.54;const P=parseInt(T.age);let U=T.gender==="male"?10*k+6.25*N-5*P+5:10*k+6.25*N-5*P-161;const Ue=U*{sedentary:1.2,light:1.3,moderate:1.4,active:1.5}[T.dailyActivity],Fe={low:100,moderate:200,high:300,daily:400},st=Math.round(Ue+Fe[T.trainingFrequency]);let et=st,ss,js;switch(T.goal){case"lose":et=st*(1-{light:.15,moderate:.2,harsh:.25}[T.deficitLevel]),ss=2.2,js=.3;break;case"build":et=st*1.1,ss=2,js=.22;break;default:ss=1.8,js=.25}et=Math.max(et,T.gender==="male"?1400:1100);const us=Math.round(k*ss),cs=Math.round(et*js/9),qs=Math.max(0,Math.round((et-us*4-cs*9)/4));F({calories:Math.round(et),protein:us,carbs:qs,fats:cs,bmr:Math.round(U),neat:Math.round(Ue),exerciseAdd:Fe[T.trainingFrequency],tdee:Math.round(st)})},ke=async()=>{if($)try{const k={clientId:t.id,calories:$.calories,protein:$.protein,carbs:$.carbs,fats:$.fats,waterGoal:8,goal:T.goal,updatedAt:_t.now()};await Ss(He(pe,"nutritionTargets",t.id),k),j(k),y("dashboard"),Lt("Macro targets saved!","success")}catch(k){console.error("Error saving targets:",k),Lt("Failed to save targets. Please try again.","error")}},Qe=()=>{const k=T.weight&&parseFloat(T.weight)>0,N=T.age&&parseInt(T.age)>0,P=T.heightUnit==="cm"?T.height&&parseFloat(T.height)>0:T.heightFeet&&parseFloat(T.heightFeet)>0||T.heightInches&&parseFloat(T.heightInches)>0;return k&&N&&P},ot="nut_favourite_foods",Y=()=>{try{return JSON.parse(localStorage.getItem(ot)||"[]")}catch{return[]}},re=k=>Y().some(N=>N.name.toLowerCase()===(k||"").toLowerCase()),We=k=>{const N=Y(),P=N.findIndex(U=>U.name.toLowerCase()===k.name.toLowerCase());P>=0?N.splice(P,1):N.unshift({name:k.name,protein:k.protein,carbs:k.carbs,fats:k.fats,calories:k.calories,serving:k.serving,per100g:k.per100g||null,servingUnit:k.servingUnit||"g",portion:k.portion||null}),localStorage.setItem(ot,JSON.stringify(N)),Ws(U=>U+1)},Ge=k=>{const N=[...K.entries,{...k,meal:q,id:Date.now(),addedAt:new Date().toISOString()}],P={...K,entries:N};ae(P),ps(P),de(null),Rt(null),At("100"),nt(0),$t("weight"),mt({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),Lt("Food added!","success")},rt=k=>{const N=K.entries.filter(U=>U.id!==k),P={...K,entries:N};ae(P),ps(P)},bt=v.useRef(null),jt=async()=>{Ve(!0);const k=document.querySelector("#barcode-reader");if(!k){Ve(!1),Lt("Scanner container not found.","error");return}if(!bt.current)try{const P=await Ar(()=>import("./quagga.min-BbicSfvA.js").then(U=>U.q),[]);bt.current=P.default}catch(P){console.error("Failed to load barcode scanner:",P),Ve(!1),Lt("Could not load scanner.","error");return}const N=bt.current;N.init({inputStream:{type:"LiveStream",target:k,constraints:{facingMode:"environment",width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080}}},locator:{patchSize:"medium",halfSample:!0},numOfWorkers:navigator.hardwareConcurrency||2,decoder:{readers:["ean_reader","ean_8_reader","upc_reader","upc_e_reader","code_128_reader","code_39_reader"]},locate:!0},P=>{if(P){console.error("Quagga init error:",P),Ve(!1),Lt("Could not access camera. Check permissions.","error");return}N.start(),is.current=!0}),N.onDetected(P=>{const U=P.codeResult.decodedCodes?.filter(Ue=>Ue.error!==void 0)?.map(Ue=>Ue.error)||[];if((U.length>0?U.reduce((Ue,Fe)=>Ue+Fe,0)/U.length:1)<.15){const Ue=P.codeResult.code;N.offDetected(),L(Ue)}})},gt=()=>{const k=bt.current;is.current&&k&&(k.stop(),k.offDetected(),is.current=!1),Ve(!1)},Gt=/\b(milk|semi.skimmed|skimmed|whole milk|oat milk|almond milk|soy milk|juice|smoothie|water|squash|cordial|cola|pepsi|fanta|lemonade|soda|beer|wine|cider|lager|spirit|whisky|vodka|rum|gin|brandy|cream|yoghurt drink|milkshake|coffee|tea|broth|stock|soup|sauce|ketchup|vinegar|oil|syrup|honey|custard|coconut water|kombucha|energy drink|protein shake)\b/i,Gs=k=>/ml|cl|\dl(?!b)|litre|liter|fl\s?oz/i.test((k||"").replace(/\s/g,"")),os=k=>{if(!k)return{value:100,unit:"g"};const N=k.toLowerCase().replace(/\s/g,""),P=N.match(/([\d.]+)/),U=P?parseFloat(P[1]):100;return Gs(k)?/cl/.test(N)?{value:U*10,unit:"ml"}:/(?:^|\d)l(?!i)/.test(N)&&!/ml/.test(N)?{value:U*1e3,unit:"ml"}:{value:U,unit:"ml"}:{value:U,unit:"g"}},ks=k=>{if(Gs(k.serving_size)||Gs(k.quantity))return"ml";const N=k.product_name||k.product_name_en||"";return Gt.test(N)?"ml":"g"},Us=[{pattern:/\b(toast|bread|loaf|brioche|bagel|pitta|wrap|tortilla|crumpet|muffin|waffle|pancake)\b/i,label:"slice",weight:36},{pattern:/\begg\b/i,label:"egg",weight:60},{pattern:/\b(biscuit|cookie|digestive|hobnob|rich tea|oreo)\b/i,label:"biscuit",weight:13},{pattern:/\b(sausage|banger)\b/i,label:"sausage",weight:57},{pattern:/\b(rasher|bacon)\b/i,label:"rasher",weight:25},{pattern:/\b(rice cake)\b/i,label:"cake",weight:9},{pattern:/\b(cracker|ryvita)\b/i,label:"cracker",weight:10}],H=(k,N)=>{const P=k||"",U=P.match(/\((\d+\.?\d*)\s*g\)/i),fe=P.match(/(?:^|per\s+)(\d*\s*[a-z][a-z\s]*?)(?:\s*\(|\s*-\s*|\s*$)/i);if(U&&fe){const st=parseFloat(U[1]);let et=fe[1].replace(/^\d+\s*/,"").trim();if(et&&st>0)return{label:et,weight:st}}const Ue=P.match(/(\d+\.?\d*)\s*g\s*[\/=]\s*(\d*\s*[a-z][a-z\s]*)/i);if(Ue){const st=parseFloat(Ue[1]);let et=Ue[2].replace(/^\d+\s*/,"").trim();if(et&&st>0)return{label:et,weight:st}}const Fe=N||"";for(const{pattern:st,label:et,weight:ss}of Us)if(st.test(Fe))return{label:et,weight:ss};return null},_e=k=>{const N=k.nutriments||{},P=ks(k),U=os(k.serving_size),fe=P==="ml"?U.unit==="ml"?U.value:100:U.value,Ue=k.product_name||k.product_name_en||"Unknown Product",Fe=H(k.serving_size,Ue);return{name:Ue,brand:k.brands||"",image:k.image_small_url||k.image_url||null,servingSize:k.serving_size||"100g",servingValue:fe,servingUnit:P,portion:Fe,protein:Math.round(N.proteins_100g||N.proteins||0),carbs:Math.round(N.carbohydrates_100g||N.carbohydrates||0),fats:Math.round(N.fat_100g||N.fat||0),calories:Math.round(N["energy-kcal_100g"]||N["energy-kcal"]||(N.energy_100g?N.energy_100g/4.184:0)),per100g:!0}},Ne=async k=>{ze(!0);try{const N=`https://world.openfoodfacts.org/api/v2/product/${k}?fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,P=await fetch(N);if(!P.ok)throw new Error(`HTTP ${P.status}`);const U=await P.json();if(U.status==="success"||U.status===1||U.product){const fe=_e(U.product);fe.calories===0&&fe.protein===0&&fe.carbs===0?Lt("Product found but no nutrition data available.","error"):(Rt(fe),fe.portion?(nt(1),At(String(fe.portion.weight)),$t("portion")):(nt(0),At(String(fe.servingValue||100)),$t("weight")),De(""))}else Lt("Product not found. Try search or manual entry.","error")}catch(N){console.error("Barcode lookup error:",N),Lt("Failed to look up product. Check your connection.","error")}ze(!1)},Se=(k,N,P)=>{const U=k.toLowerCase().trim(),fe=N.toLowerCase().trim(),Ue=P.toLowerCase().trim();let Fe=0;return(U===Ue||U===Ue+"s"||U+"s"===Ue)&&(Fe+=100),(U.endsWith(" "+Ue)||U.endsWith(" "+Ue+"s"))&&(Fe+=40),(U.startsWith(Ue+" ")||U.startsWith(Ue+"s "))&&(Fe+=15),Ue.split(/\s+/).some(et=>fe===et||fe.startsWith(et))&&(Fe+=30),Fe+=Math.max(0,30-U.length),Fe},je=async()=>{if(!Le.trim())return;Is.current&&Is.current.abort();const k=new AbortController;Is.current=k;const N=Le.trim().toLowerCase(),P=N.split(/\s+/).filter(Boolean);if(Wp.has(N)){Ye(Wp.get(N));return}Ms(!0);try{const fe=`https://world.openfoodfacts.org/cgi/search.pl?search_terms=${encodeURIComponent(Le.trim())}&search_simple=1&action=process&json=1&page_size=10&lc=en&sort_by=unique_scans_n&fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,Ue=await fetch(fe,{signal:k.signal});if(!Ue.ok)throw new Error(`HTTP ${Ue.status}`);const st=((await Ue.json()).products||[]).map(et=>_e(et)).filter(et=>et.name!=="Unknown Product"&&(et.calories>0||et.protein>0)).filter(et=>{const ss=(et.name+" "+et.brand).toLowerCase();return P.every(js=>ss.includes(js))}).sort((et,ss)=>Se(ss.name,ss.brand,N)-Se(et.name,et.brand,N)).slice(0,10);Wp.set(N,st),Ye(st),st.length===0&&Lt("No results found. Try a different search.","info")}catch(U){if(U.name==="AbortError")return;console.error("Search error:",U),Lt("Search failed. Check your connection.","error")}Ms(!1)};v.useEffect(()=>{if(zt.current&&clearTimeout(zt.current),!(!Le.trim()||W!=="search"||ne))return zt.current=setTimeout(()=>{je()},700),()=>clearTimeout(zt.current)},[Le]);const ct=()=>{const k={...K,water:K.water+1};ae(k),ps(k)},xt=()=>{if(K.water<=0)return;const k={...K,water:K.water-1};ae(k),ps(k)},Ze={"ring-protein":"#14b8a6","ring-carbs":"var(--color-primary)","ring-fats":"#eab308","ring-cals":"rgba(150,150,150,0.55)"},kt=80,Et=2*Math.PI*kt,Cs=(k,N,P,U,fe)=>{const Ue=U>0?Math.min(100,Math.round(P/U*100)):0,Fe=Et-Ue/100*Et,st=Ze[fe]||"#14b8a6";return r.jsxs("div",{className:"nut-ring-wrap",children:[r.jsxs("svg",{className:"nut-ring-svg",viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"nut-arc-track",cx:"100",cy:"100",r:kt}),r.jsx("circle",{className:"nut-arc-fill",cx:"100",cy:"100",r:kt,style:{stroke:st},strokeDasharray:Et,strokeDashoffset:Fe})]}),r.jsxs("div",{className:"nut-ring-center",children:[r.jsx("span",{className:"nut-ring-value",style:{color:st},children:Math.round(P)}),r.jsxs("span",{className:"nut-ring-target",children:["/ ",U,k==="Calories"?"":"g"]}),r.jsx("span",{className:"nut-ring-label",style:{color:st},children:N})]}),r.jsxs("span",{className:"nut-ring-pct",style:{color:st},children:[Ue,"%"]})]})};if(v.useEffect(()=>{if(!ee)return;const k=setTimeout(()=>{const N=ee;gt(),L(null),Ne(N)},1500);return()=>clearTimeout(k)},[ee]),v.useEffect(()=>()=>{const k=bt.current;if(is.current&&k){try{k.stop(),k.offDetected()}catch{}is.current=!1}},[]),i||g==="loading")return r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsx("div",{className:"nut-loading-inline",children:r.jsx("div",{className:"cb-loading-spinner"})})]});if(g==="setup")return r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"nut-main",children:[r.jsxs("div",{className:"nut-setup-intro",children:[r.jsx("h2",{children:"Set Your Daily Targets"}),r.jsx("p",{children:"Calculate your personalised macros based on your body and goals."})]}),r.jsxs("div",{className:"nut-calc-form",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Gender"}),r.jsxs("div",{className:"nut-toggle-group",children:[r.jsx("button",{className:T.gender==="male"?"active":"",onClick:()=>{B(k=>({...k,gender:"male"})),F(null)},children:"Male"}),r.jsx("button",{className:T.gender==="female"?"active":"",onClick:()=>{B(k=>({...k,gender:"female"})),F(null)},children:"Female"})]})]}),r.jsxs("div",{className:"nut-form-row",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Age"}),r.jsx("input",{type:"number",value:T.age,onChange:k=>{B(N=>({...N,age:k.target.value})),F(null)},placeholder:"Years",min:"15",max:"100"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Weight"}),r.jsxs("div",{className:"nut-input-unit",children:[r.jsx("input",{type:"number",value:T.weight,onChange:k=>{B(N=>({...N,weight:k.target.value})),F(null)},placeholder:T.weightUnit,min:"30",max:"300"}),r.jsxs("div",{className:"nut-unit-toggle",children:[r.jsx("button",{className:T.weightUnit==="kg"?"active":"",onClick:()=>{B(k=>({...k,weightUnit:"kg"})),F(null)},children:"kg"}),r.jsx("button",{className:T.weightUnit==="lbs"?"active":"",onClick:()=>{B(k=>({...k,weightUnit:"lbs"})),F(null)},children:"lbs"})]})]})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Height"}),r.jsxs("div",{className:"nut-input-unit",children:[T.heightUnit==="cm"?r.jsx("input",{type:"number",value:T.height,onChange:k=>{B(N=>({...N,height:k.target.value})),F(null)},placeholder:"cm",min:"100",max:"250"}):r.jsxs("div",{className:"nut-height-imperial",children:[r.jsx("input",{type:"number",value:T.heightFeet,onChange:k=>{B(N=>({...N,heightFeet:k.target.value})),F(null)},placeholder:"ft",min:"4",max:"7"}),r.jsx("input",{type:"number",value:T.heightInches,onChange:k=>{B(N=>({...N,heightInches:k.target.value})),F(null)},placeholder:"in",min:"0",max:"11"})]}),r.jsxs("div",{className:"nut-unit-toggle",children:[r.jsx("button",{className:T.heightUnit==="cm"?"active":"",onClick:()=>{B(k=>({...k,heightUnit:"cm"})),F(null)},children:"cm"}),r.jsx("button",{className:T.heightUnit==="ft"?"active":"",onClick:()=>{B(k=>({...k,heightUnit:"ft"})),F(null)},children:"ft/in"})]})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Daily Activity (outside of training)"}),r.jsxs("select",{value:T.dailyActivity,onChange:k=>{B(N=>({...N,dailyActivity:k.target.value})),F(null)},children:[r.jsx("option",{value:"sedentary",children:"Sedentary  desk job, under 5k steps"}),r.jsx("option",{value:"light",children:"Lightly Active  office + walking, 5-8k steps"}),r.jsx("option",{value:"moderate",children:"Moderately Active  on feet often, 8-12k steps"}),r.jsx("option",{value:"active",children:"Very Active  physical job, 12k+ steps"})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Training Sessions per Week"}),r.jsxs("select",{value:T.trainingFrequency,onChange:k=>{B(N=>({...N,trainingFrequency:k.target.value})),F(null)},children:[r.jsx("option",{value:"low",children:"1-2 sessions"}),r.jsx("option",{value:"moderate",children:"3-4 sessions"}),r.jsx("option",{value:"high",children:"5-6 sessions"}),r.jsx("option",{value:"daily",children:"7+ sessions"})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Fitness Goal"}),r.jsxs("div",{className:"nut-goal-options",children:[r.jsxs("button",{className:T.goal==="lose"?"active":"",onClick:()=>{B(k=>({...k,goal:"lose"})),F(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"-"}),r.jsx("span",{children:"Lose Weight"})]}),r.jsxs("button",{className:T.goal==="maintain"?"active":"",onClick:()=>{B(k=>({...k,goal:"maintain"})),F(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"="}),r.jsx("span",{children:"Maintain"})]}),r.jsxs("button",{className:T.goal==="build"?"active":"",onClick:()=>{B(k=>({...k,goal:"build"})),F(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"+"}),r.jsx("span",{children:"Build Muscle"})]})]})]}),T.goal==="lose"&&r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Deficit Level"}),r.jsxs("div",{className:"nut-deficit-options",children:[r.jsxs("button",{className:T.deficitLevel==="light"?"active":"",onClick:()=>{B(k=>({...k,deficitLevel:"light"})),F(null)},children:[r.jsx("strong",{children:"Mild"}),r.jsx("span",{children:"15% below TDEE"})]}),r.jsxs("button",{className:T.deficitLevel==="moderate"?"active":"",onClick:()=>{B(k=>({...k,deficitLevel:"moderate"})),F(null)},children:[r.jsx("strong",{children:"Moderate"}),r.jsx("span",{children:"20% below TDEE"})]}),r.jsxs("button",{className:T.deficitLevel==="harsh"?"active":"",onClick:()=>{B(k=>({...k,deficitLevel:"harsh"})),F(null)},children:[r.jsx("strong",{children:"Aggressive"}),r.jsx("span",{children:"25% below TDEE"})]})]})]}),r.jsx("button",{className:"nut-calc-btn",onClick:Oe,disabled:!Qe(),children:"Calculate Macros"})]}),$&&r.jsxs("div",{className:"nut-calc-results",children:[r.jsx("h3",{children:"Your Daily Targets"}),r.jsxs("div",{className:"nut-calc-rings",children:[Cs("Protein","Protein",$.protein,$.protein,"ring-protein"),Cs("Carbs","Carbs",$.carbs,$.carbs,"ring-carbs"),Cs("Fats","Fats",$.fats,$.fats,"ring-fats"),Cs("Calories","Calories",$.calories,$.calories,"ring-cals")]}),r.jsxs("div",{className:"nut-calc-info",children:[r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"BMR (body at rest)"}),r.jsxs("span",{children:[$.bmr," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"+ Daily activity (NEAT)"}),r.jsxs("span",{children:[$.neat," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"+ Training sessions"}),r.jsxs("span",{children:["+",$.exerciseAdd," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",style:{fontWeight:600},children:[r.jsx("span",{children:"TDEE (total burn)"}),r.jsxs("span",{children:[$.tdee," cal"]})]})]}),r.jsx("button",{className:"nut-save-targets-btn",onClick:ke,children:"Set as My Daily Targets"})]})]}),Ut&&r.jsx("div",{className:`toast-notification ${Ut.type}`,children:Ut.message})]});const hn=k=>{const N=new Date(k+"T12:00:00"),P=N.getDay(),U=new Date(N);U.setDate(N.getDate()-(P+6)%7);const fe=[];for(let Ue=0;Ue<7;Ue++){const Fe=new Date(U);Fe.setDate(U.getDate()+Ue),fe.push(Fe.toISOString().split("T")[0])}return fe},gn=["M","T","W","T","F","S","S"],Tn=(k,N="search")=>{I(k),N==="scan"?(de("scan"),Rt(null)):N==="manual"?(de("manual"),mt({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""})):N==="favourites"?de("favourites"):(de("search"),Ye([]),it(""))},In=hn(V),yn=new Date(V+"T12:00:00"),zs=`${he[yn.getMonth()]} ${yn.getFullYear()}`;return r.jsx(Ta,{children:r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsxs("div",{className:"nut-dark-zone",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsxs("div",{className:"header-actions",children:[r.jsx("button",{onClick:()=>{y("setup"),F(null)},"aria-label":"Recalculate macros",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"3"}),r.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]})]})}),r.jsxs("div",{className:"nut-dark-content",children:[r.jsxs("div",{className:"nut-week-strip anim-fade-up",children:[r.jsxs("div",{className:"nut-week-header",children:[r.jsx("button",{className:"nut-week-arrow",onClick:()=>{const k=new Date(V+"T12:00:00");k.setDate(k.getDate()-7);const N=k.toISOString().split("T")[0];te(N)},"aria-label":"Previous week",children:r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:r.jsx("polyline",{points:"15 18 9 12 15 6"})})}),r.jsx("button",{className:"nut-week-month-label",onClick:()=>{R(!me),D({year:yn.getFullYear(),month:yn.getMonth()})},children:zs}),r.jsx("button",{className:"nut-week-arrow",onClick:()=>{const k=new Date(V+"T12:00:00");k.setDate(k.getDate()+7);const N=k.toISOString().split("T")[0];N<=Ki()&&te(N)},"aria-label":"Next week",disabled:In[6]>=Ki(),children:r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:r.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),r.jsx("div",{className:"nut-week-days",children:In.map((k,N)=>{const P=new Date(k+"T12:00:00").getDate(),U=k===V,fe=k>Ki(),Ue=k===Ki();return r.jsxs("button",{className:`nut-week-day${U?" selected":""}${Ue?" today":""}${fe?" future":""}`,disabled:fe,onClick:()=>te(k),children:[r.jsx("span",{className:"nut-week-day-letter",children:gn[N]}),r.jsx("span",{className:"nut-week-day-num",children:P})]},k)})})]}),me&&r.jsxs("div",{className:"nut-calendar nut-calendar-dark",children:[r.jsxs("div",{className:"nut-cal-header",children:[r.jsx("button",{onClick:()=>D(k=>{let N=k.month-1,P=k.year;return N<0&&(N=11,P--),{year:P,month:N}}),children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("polyline",{points:"15 18 9 12 15 6"})})}),r.jsxs("span",{children:[he[O.month]," ",O.year]}),r.jsx("button",{onClick:()=>D(k=>{let N=k.month+1,P=k.year;return N>11&&(N=0,P++),{year:P,month:N}}),disabled:O.year===new Date().getFullYear()&&O.month>=new Date().getMonth(),children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),r.jsx("div",{className:"nut-cal-days-header",children:Ee.map(k=>r.jsx("span",{children:k},k))}),r.jsxs("div",{className:"nut-cal-grid",children:[[...Array(G(O.year,O.month))].map((k,N)=>r.jsx("span",{},`e${N}`)),[...Array(we(O.year,O.month))].map((k,N)=>{const P=N+1,U=`${O.year}-${String(O.month+1).padStart(2,"0")}-${String(P).padStart(2,"0")}`,fe=U>Ki(),Ue=U===V,Fe=U===Ki();return r.jsx("button",{className:`nut-cal-day${Ue?" selected":""}${Fe?" today":""}${fe?" future":""}`,disabled:fe,onClick:()=>{te(U),R(!1)},children:P},P)})]})]}),r.jsxs("div",{className:"nut-rings-row anim-fade-up-d2",children:[Cs("Protein","Protein",ye.protein,x.protein,"ring-protein"),Cs("Carbs","Carbs",ye.carbs,x.carbs,"ring-carbs"),Cs("Fats","Fats",ye.fats,x.fats,"ring-fats"),Cs("Calories","kCal",ye.calories,x.calories,"ring-cals")]})]})]}),r.jsx("div",{className:"nut-light-zone anim-fade-up-d4",children:r.jsxs("div",{className:"nut-light-content",children:[Wt&&r.jsxs("button",{className:"nut-water-quick",onClick:()=>M(!0),children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"18",height:"18",children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),r.jsxs("span",{className:"nut-water-quick-count",children:[K.water," / ",x?.waterGoal||8]}),r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",width:"14",height:"14",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})]}),r.jsx("div",{className:"nut-log-section",children:r.jsx("div",{className:"nut-meals-list",children:E2.map(k=>{const N=K.entries.filter(U=>(U.meal||"snacks")===k.key),P=N.reduce((U,fe)=>({protein:U.protein+(fe.protein||0),carbs:U.carbs+(fe.carbs||0),fats:U.fats+(fe.fats||0),calories:U.calories+(fe.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});return r.jsxs("div",{className:"nut-meal-card",children:[r.jsxs("div",{className:"nut-meal-card-header",children:[r.jsx("span",{className:`nut-meal-card-icon nut-meal-icon-${k.key}`,children:ED[k.key]}),r.jsx("span",{className:"nut-meal-card-title",children:k.label}),N.length>0&&r.jsxs("span",{className:"nut-meal-card-cal",children:[P.calories," cal"]}),Wt&&r.jsx("button",{className:"nut-meal-add-btn",onClick:()=>ft(qe===k.key?null:k.key),"aria-label":`Add to ${k.label}`,children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]}),N.length>0&&r.jsxs("div",{className:"nut-meal-bars",children:[r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-p",children:"P"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-protein",style:{width:`${Math.min(100,x.protein>0?P.protein/x.protein*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[P.protein,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-c",children:"C"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-carbs",style:{width:`${Math.min(100,x.carbs>0?P.carbs/x.carbs*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[P.carbs,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-f",children:"F"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-fats",style:{width:`${Math.min(100,x.fats>0?P.fats/x.fats*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[P.fats,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-cal",children:"K"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-cals",style:{width:`${Math.min(100,x.calories>0?P.calories/x.calories*100:0)}%`}})}),r.jsx("span",{className:"nut-meal-bar-val",children:P.calories})]})]}),N.length>0&&r.jsx("div",{className:"nut-log-list",children:N.map(U=>r.jsxs("div",{className:"nut-log-item",children:[r.jsxs("div",{className:"nut-log-item-info",children:[r.jsx("span",{className:"nut-log-item-name",children:U.name}),U.serving&&r.jsx("span",{className:"nut-log-item-serving",children:U.serving})]}),r.jsxs("div",{className:"nut-log-item-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[U.protein,"p"]}),r.jsxs("span",{className:"nut-macro-c",children:[U.carbs,"c"]}),r.jsxs("span",{className:"nut-macro-f",children:[U.fats,"f"]}),r.jsx("span",{className:"nut-macro-cal",children:U.calories})]}),Wt&&r.jsx("button",{className:"nut-log-delete",onClick:()=>rt(U.id),"aria-label":"Remove",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},U.id))}),N.length===0&&r.jsx("div",{className:"nut-meal-empty",children:r.jsx("p",{children:Wt?"Tap + to add food":"No entries"})})]},k.key)})})})]})}),qe&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"nut-add-picker-backdrop",onClick:()=>ft(null)}),r.jsxs("div",{className:"nut-add-picker",children:[r.jsx("div",{className:"nut-add-picker-handle"}),r.jsxs("h3",{className:"nut-add-picker-title",children:["Add to ",E2.find(k=>k.key===qe)?.label]}),r.jsxs("div",{className:"nut-add-picker-options",children:[r.jsxs("button",{onClick:()=>{const k=qe;ft(null),Tn(k,"scan")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),r.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),r.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),r.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),r.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),r.jsx("span",{children:"Scan Barcode"})]}),r.jsxs("button",{onClick:()=>{const k=qe;ft(null),Tn(k,"search")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("span",{children:"Search Food"})]}),r.jsxs("button",{onClick:()=>{const k=qe;ft(null),Tn(k,"manual")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),r.jsx("span",{children:"Manual Entry"})]}),r.jsxs("button",{onClick:()=>{const k=qe;ft(null),Tn(k,"favourites")},children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),r.jsx("span",{children:"Favourites"})]})]})]})]}),E&&r.jsx("div",{className:"nut-modal-overlay",onClick:()=>M(!1),children:r.jsxs("div",{className:"nut-water-popup",onClick:k=>k.stopPropagation(),children:[r.jsxs("div",{className:"nut-water-popup-header",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"20",height:"20",style:{color:"#2196f3"},children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),r.jsx("span",{children:"Water Intake"}),r.jsx("button",{className:"nut-modal-close",onClick:()=>M(!1),children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),r.jsxs("div",{className:"nut-water-popup-body",children:[r.jsx("div",{className:"nut-water-glasses",children:[...Array(x?.waterGoal||8)].map((k,N)=>r.jsx("div",{className:`nut-water-glass ${N<K.water?"filled":""}`,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:N<K.water?"currentColor":"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})})},N))}),r.jsxs("div",{className:"nut-water-popup-count",children:[K.water," / ",x?.waterGoal||8," glasses"]}),r.jsxs("div",{className:"nut-water-btns",children:[r.jsx("button",{onClick:xt,disabled:K.water<=0,children:"-"}),r.jsx("button",{onClick:ct,children:"+"})]})]})]})}),W&&r.jsx("div",{className:"nut-modal-overlay",onClick:()=>{gt(),L(null),de(null),Rt(null)},children:r.jsxs("div",{className:"nut-modal",onClick:k=>k.stopPropagation(),children:[r.jsxs("div",{className:"nut-modal-header",children:[r.jsx("h3",{children:W==="scan"?"Scan Barcode":W==="search"?"Search Food":W==="favourites"?"Favourites":"Manual Entry"}),r.jsx("button",{className:"nut-modal-close",onClick:()=>{gt(),L(null),de(null),Rt(null)},children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),W==="scan"&&!ne&&r.jsxs("div",{className:"nut-scan-area",children:[r.jsxs("div",{className:"nut-scanner-wrapper",children:[r.jsx("div",{id:"barcode-reader",className:"nut-scanner-view"}),Ie&&!ee&&r.jsx("div",{className:"nut-scan-line"}),ee&&r.jsxs("div",{className:"nut-scan-detected-overlay",children:[r.jsx("svg",{className:"nut-scan-detected-tick",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20 6L9 17l-5-5"})}),r.jsx("p",{className:"nut-scan-detected-label",children:"Barcode found!"}),r.jsx("p",{className:"nut-scan-detected-code",children:ee})]})]}),!Ie&&r.jsxs("button",{className:"nut-scan-start-btn",onClick:jt,children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),r.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),r.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),r.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),r.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),"Open Camera"]}),Ie&&!ee&&r.jsx("p",{className:"nut-scan-hint",children:"Align barcode within the frame"}),r.jsx("div",{className:"nut-barcode-divider",children:r.jsx("span",{children:"or enter barcode manually"})}),r.jsxs("div",{className:"nut-barcode-manual",children:[r.jsx("input",{type:"text",inputMode:"numeric",value:se,onChange:k=>De(k.target.value),onKeyDown:k=>k.key==="Enter"&&se.trim()&&Ne(se.trim()),placeholder:"Enter barcode number"}),r.jsx("button",{onClick:()=>se.trim()&&Ne(se.trim()),disabled:!se.trim()||ue,children:ue?"...":"Look Up"})]})]}),W==="scan"&&ne&&(()=>{const k=ne.servingUnit||"g",N=ne.portion,P=$e==="portion"&&N?vt*N.weight:parseFloat(Pt)||0,U=P/100,fe=k==="ml"?[100,200,250,500]:[50,100,150,200],Ue=$e==="portion"&&N?`${vt} ${N.label}${vt!==1?"s":""} (${Math.round(P)}${k})`:`${Math.round(P)}${k}`;return r.jsxs("div",{className:"nut-product-result",children:[ne.image&&r.jsx("img",{src:ne.image,alt:ne.name||"Product",className:"nut-product-img",loading:"lazy"}),r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:ne.name}),r.jsx("button",{className:`nut-fav-star confirm${re(ne.name)?" active":""}`,onClick:()=>We({name:ne.name,protein:ne.protein,carbs:ne.carbs,fats:ne.fats,calories:ne.calories,serving:ne.servingSize,per100g:{protein:ne.protein,carbs:ne.carbs,fats:ne.fats,calories:ne.calories},servingUnit:ne.servingUnit||"g",portion:ne.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:re(ne.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),ne.brand&&r.jsx("p",{className:"nut-product-brand",children:ne.brand}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",k,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[ne.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[ne.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[ne.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[ne.calories," cal"]})]}),N&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:$e==="portion"?"active":"",onClick:()=>{$t("portion"),vt<1&&nt(1)},children:"Portions"}),r.jsxs("button",{className:$e==="weight"?"active":"",onClick:()=>{$t("weight"),At(String(Math.round(P)||100))},children:["Custom (",k,")"]})]}),$e==="portion"&&N?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>nt(Math.max(1,vt-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:vt}),r.jsxs("span",{className:"nut-stepper-label",children:[N.label,vt!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(P),k]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>nt(vt+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",k,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:Pt,onChange:Fe=>At(Fe.target.value),onFocus:Fe=>Fe.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:fe.map(Fe=>r.jsxs("button",{className:`nut-quick-btn${Pt===String(Fe)?" active":""}`,onClick:()=>At(String(Fe)),children:[Fe,k]},Fe))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(ne.protein*U),"p / ",Math.round(ne.carbs*U),"c / ",Math.round(ne.fats*U),"f / ",Math.round(ne.calories*U)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>{Rt(null),de("scan")},children:"Scan Again"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>Ge({name:ne.name,protein:Math.round(ne.protein*U),carbs:Math.round(ne.carbs*U),fats:Math.round(ne.fats*U),calories:Math.round(ne.calories*U),serving:Ue}),children:"Add"})]})]})})(),W==="search"&&!ne&&r.jsxs("div",{className:"nut-search-area",children:[r.jsxs("div",{className:"nut-search-bar",children:[r.jsx("input",{type:"text",ref:Js,value:Le,onChange:k=>it(k.target.value),onKeyDown:k=>{k.key==="Enter"&&(clearTimeout(zt.current),je())},onFocus:()=>setTimeout(()=>Js.current?.scrollIntoView({behavior:"smooth",block:"center"}),350),placeholder:"Search food or product...",autoFocus:!0}),r.jsx("button",{onClick:je,disabled:Ht,children:Ht?"...":"Search"})]}),r.jsxs("div",{className:"nut-search-results",children:[pt.map((k,N)=>r.jsxs("button",{className:"nut-search-item",onClick:()=>{Rt(k),k.portion?(nt(1),At(String(k.portion.weight)),$t("portion")):(nt(0),At(String(k.servingValue||100)),$t("weight"))},children:[k.image&&r.jsx("img",{src:k.image,alt:k.name||"Product",loading:"lazy"}),r.jsxs("div",{className:"nut-search-item-info",children:[r.jsx("span",{className:"nut-search-item-name",children:k.name}),k.brand&&r.jsx("span",{className:"nut-search-item-brand",children:k.brand}),r.jsxs("span",{className:"nut-search-item-macros",children:[k.calories," cal  ",k.protein,"p  ",k.carbs,"c  ",k.fats,"f per 100",k.servingUnit||"g"]})]})]},N)),pt.length===0&&Le&&!Ht&&r.jsx("p",{className:"nut-search-empty",children:"No results found. Try a different search or use manual entry."})]})]}),W==="search"&&ne&&(()=>{const k=ne.servingUnit||"g",N=ne.portion,P=$e==="portion"&&N?vt*N.weight:parseFloat(Pt)||0,U=P/100,fe=k==="ml"?[100,200,250,500]:[50,100,150,200],Ue=$e==="portion"&&N?`${vt} ${N.label}${vt!==1?"s":""} (${Math.round(P)}${k})`:`${Math.round(P)}${k}`;return r.jsxs("div",{className:"nut-product-result",children:[ne.image&&r.jsx("img",{src:ne.image,alt:ne.name||"Product",className:"nut-product-img",loading:"lazy"}),r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:ne.name}),r.jsx("button",{className:`nut-fav-star confirm${re(ne.name)?" active":""}`,onClick:()=>We({name:ne.name,protein:ne.protein,carbs:ne.carbs,fats:ne.fats,calories:ne.calories,serving:ne.servingSize,per100g:{protein:ne.protein,carbs:ne.carbs,fats:ne.fats,calories:ne.calories},servingUnit:ne.servingUnit||"g",portion:ne.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:re(ne.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),ne.brand&&r.jsx("p",{className:"nut-product-brand",children:ne.brand}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",k,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[ne.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[ne.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[ne.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[ne.calories," cal"]})]}),N&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:$e==="portion"?"active":"",onClick:()=>{$t("portion"),vt<1&&nt(1)},children:"Portions"}),r.jsxs("button",{className:$e==="weight"?"active":"",onClick:()=>{$t("weight"),At(String(Math.round(P)||100))},children:["Custom (",k,")"]})]}),$e==="portion"&&N?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>nt(Math.max(1,vt-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:vt}),r.jsxs("span",{className:"nut-stepper-label",children:[N.label,vt!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(P),k]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>nt(vt+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",k,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:Pt,onChange:Fe=>At(Fe.target.value),onFocus:Fe=>Fe.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:fe.map(Fe=>r.jsxs("button",{className:`nut-quick-btn${Pt===String(Fe)?" active":""}`,onClick:()=>At(String(Fe)),children:[Fe,k]},Fe))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(ne.protein*U),"p / ",Math.round(ne.carbs*U),"c / ",Math.round(ne.fats*U),"f / ",Math.round(ne.calories*U)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>Rt(null),children:"Back to Search"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>Ge({name:ne.name,protein:Math.round(ne.protein*U),carbs:Math.round(ne.carbs*U),fats:Math.round(ne.fats*U),calories:Math.round(ne.calories*U),serving:Ue}),children:"Add"})]})]})})(),W==="manual"&&r.jsxs("div",{className:"nut-manual-form",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Food Name"}),r.jsx("input",{type:"text",value:dt.name,onChange:k=>mt(N=>({...N,name:k.target.value})),placeholder:"e.g. Chicken Breast",autoFocus:!0})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Serving Size (optional)"}),r.jsx("input",{type:"text",value:dt.serving,onChange:k=>mt(N=>({...N,serving:k.target.value})),placeholder:"e.g. 150g, 1 cup"})]}),r.jsxs("div",{className:"nut-manual-macros",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Protein (g)"}),r.jsx("input",{type:"number",value:dt.protein,onChange:k=>mt(N=>({...N,protein:k.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Carbs (g)"}),r.jsx("input",{type:"number",value:dt.carbs,onChange:k=>mt(N=>({...N,carbs:k.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Fats (g)"}),r.jsx("input",{type:"number",value:dt.fats,onChange:k=>mt(N=>({...N,fats:k.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Calories"}),r.jsx("input",{type:"number",value:dt.calories,onChange:k=>mt(N=>({...N,calories:k.target.value})),min:"0"})]})]}),r.jsx("button",{className:"nut-btn-primary",disabled:!dt.name.trim(),onClick:()=>Ge({name:dt.name,protein:parseFloat(dt.protein)||0,carbs:parseFloat(dt.carbs)||0,fats:parseFloat(dt.fats)||0,calories:parseFloat(dt.calories)||0,serving:dt.serving||""}),children:"Add Food"})]}),W==="favourites"&&!ne&&(()=>{const k=Y(),N=P=>{if(P.per100g){const U=P.per100g;Rt({name:P.name,brand:"",image:null,servingSize:P.serving||"100g",servingValue:100,servingUnit:P.servingUnit||"g",portion:P.portion||null,protein:U.protein,carbs:U.carbs,fats:U.fats,calories:U.calories,per100g:!0}),P.portion?(nt(1),At(String(P.portion.weight)),$t("portion")):(nt(0),At("100"),$t("weight"))}else Ge({name:P.name,protein:P.protein,carbs:P.carbs,fats:P.fats,calories:P.calories,serving:P.serving||""})};return r.jsx("div",{className:"nut-recent-area",children:k.length===0?r.jsx("p",{className:"nut-search-empty",children:"No favourites yet. Tap the star on any food to save it here."}):r.jsx("div",{className:"nut-recent-list",children:k.map((P,U)=>r.jsxs("div",{className:"nut-recent-item-row",children:[r.jsx("button",{className:"nut-fav-star active",onClick:fe=>{fe.stopPropagation(),We(P)},children:r.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("button",{className:"nut-recent-item",onClick:()=>N(P),children:[r.jsxs("div",{className:"nut-recent-item-info",children:[r.jsx("span",{className:"nut-recent-item-name",children:P.name}),r.jsx("span",{className:"nut-recent-item-serving",children:P.serving||""})]}),r.jsxs("span",{className:"nut-recent-item-macros",children:[P.calories," cal"]})]})]},U))})})})(),W==="favourites"&&ne&&(()=>{const k=ne.servingUnit||"g",N=ne.portion,P=$e==="portion"&&N?vt*N.weight:parseFloat(Pt)||0,U=P/100,fe=k==="ml"?[100,200,250,500]:[50,100,150,200],Ue=$e==="portion"&&N?`${vt} ${N.label}${vt!==1?"s":""} (${Math.round(P)}${k})`:`${Math.round(P)}${k}`;return r.jsxs("div",{className:"nut-product-result",children:[r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:ne.name}),r.jsx("button",{className:`nut-fav-star confirm${re(ne.name)?" active":""}`,onClick:()=>We({name:ne.name,protein:ne.protein,carbs:ne.carbs,fats:ne.fats,calories:ne.calories,serving:ne.servingSize,per100g:{protein:ne.protein,carbs:ne.carbs,fats:ne.fats,calories:ne.calories},servingUnit:ne.servingUnit||"g",portion:ne.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:re(ne.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",k,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[ne.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[ne.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[ne.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[ne.calories," cal"]})]}),N&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:$e==="portion"?"active":"",onClick:()=>{$t("portion"),vt<1&&nt(1)},children:"Portions"}),r.jsxs("button",{className:$e==="weight"?"active":"",onClick:()=>{$t("weight"),At(String(Math.round(P)||100))},children:["Custom (",k,")"]})]}),$e==="portion"&&N?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>nt(Math.max(1,vt-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:vt}),r.jsxs("span",{className:"nut-stepper-label",children:[N.label,vt!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(P),k]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>nt(vt+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",k,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:Pt,onChange:Fe=>At(Fe.target.value),onFocus:Fe=>Fe.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:fe.map(Fe=>r.jsxs("button",{className:`nut-quick-btn${Pt===String(Fe)?" active":""}`,onClick:()=>At(String(Fe)),children:[Fe,k]},Fe))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(ne.protein*U),"p / ",Math.round(ne.carbs*U),"c / ",Math.round(ne.fats*U),"f / ",Math.round(ne.calories*U)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>Rt(null),children:"Back to Favourites"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>Ge({name:ne.name,protein:Math.round(ne.protein*U),carbs:Math.round(ne.carbs*U),fats:Math.round(ne.fats*U),calories:Math.round(ne.calories*U),serving:Ue}),children:"Add"})]})]})})()]})}),r.jsx(ua,{active:"nutrition"}),Ut&&r.jsx("div",{className:`toast-notification ${Ut.type}`,children:Ut.message})]})})}async function sb(n){const{type:e="workout",title:t="Workout Complete!",stats:i=[],badges:l=[],badgeImage:u,badgeDesc:d}=n,p=1080,g=1920,y=document.createElement("canvas");y.width=p,y.height=g;const x=y.getContext("2d"),j="#2a2a28",T="#ffffff",B="#A12F3A",$="#1a1a1a",F="#555555";x.fillStyle=j,x.fillRect(0,0,p,g);const V=Math.round(p*.82),te=Math.round(g*.75),K=Math.round((p-V)/2),ae=Math.round((g-te)/2),ye=28,Ae=5;x.save(),x.shadowColor="rgba(0, 0, 0, 0.45)",x.shadowBlur=40,x.shadowOffsetY=10,S2(x,K,ae,V,te,ye),x.fillStyle=T,x.fill(),x.restore(),x.save(),S2(x,K,ae,V,te,ye),x.strokeStyle=B,x.lineWidth=Ae,x.stroke(),x.restore();const me=220,R=50,E=52,M=68,O=10,D=36,q=48,I=30,qe=34,ft=46,W=30,de=28;x.font=`bold ${E}px 'Orbitron', sans-serif`;const Ie=eu(x,t.toUpperCase(),V-100);x.font=`500 ${D}px 'Montserrat', sans-serif`;let Ve=[];e==="badge"&&d?Ve=eu(x,d,V-120):e==="badge"&&l.length>0?Ve=eu(x,l.join("    "),V-120):i.length>0&&(Ve=eu(x,i.map(Rt=>`${Rt.value} ${Rt.label}`).join("    "),V-120));const ee=e==="badge"?"I just earned a badge on Core Buddy ":e==="habits"?"I just completed my daily habits with Core Buddy ":"I just completed a workout using Core Buddy ";x.font=`bold ${qe}px 'Montserrat', sans-serif`;const L=eu(x,ee,V-80);let se=Ie.length*M;Ve.length>0&&(se+=O+Ve.length*q),se+=I+L.length*ft,se+=W+de;const ue=ae+te-60-se,Le=ae+40,it=ue-R,pt=p/2,Ye=(Le+it)/2,Ht=e==="badge"&&u?u:"/Logo.webp";x.save();const Ms=e==="badge"?"rgba(255, 193, 7, 0.15)":"rgba(161, 47, 58, 0.12)",dt=x.createRadialGradient(pt,Ye,me*.6,pt,Ye,me*1.5);dt.addColorStop(0,Ms),dt.addColorStop(1,"rgba(0, 0, 0, 0)"),x.fillStyle=dt,x.fillRect(pt-me*1.5,Ye-me*1.5,me*3,me*3),x.restore(),x.beginPath(),x.arc(pt,Ye,me+6,0,Math.PI*2),x.fillStyle=T,x.fill();const mt=e==="badge"?"#ffc107":B;x.beginPath(),x.arc(pt,Ye,me,0,Math.PI*2),x.strokeStyle=mt,x.lineWidth=5,x.stroke();try{const Rt=await CD(Ht);x.save(),x.beginPath(),x.arc(pt,Ye,me-6,0,Math.PI*2),x.clip();const Pt=(me-6)*2;x.drawImage(Rt,pt-me+6,Ye-me+6,Pt,Pt),x.restore()}catch{x.textAlign="center",x.textBaseline="middle",x.fillStyle=B,x.font="bold 80px 'Orbitron', sans-serif",x.fillText(e==="badge"?"":"MCF",pt,Ye)}let ne=ue;x.textAlign="center",x.textBaseline="alphabetic",x.fillStyle=$,x.font=`bold ${E}px 'Orbitron', sans-serif`;for(const Rt of Ie)x.fillText(Rt,p/2,ne),ne+=M;if(Ve.length>0){ne+=O,x.fillStyle=F,x.font=`500 ${D}px 'Montserrat', sans-serif`;for(const Rt of Ve)x.fillText(Rt,p/2,ne),ne+=q}ne+=I,x.fillStyle=$,x.font=`bold ${qe}px 'Montserrat', sans-serif`;for(const Rt of L)x.fillText(Rt,p/2,ne),ne+=ft;return ne+=W,x.fillStyle=B,x.font=`600 ${de}px 'Montserrat', sans-serif`,x.fillText("Make It Count with Core Buddy",p/2,ne),new Promise(Rt=>{y.toBlob(Pt=>Rt(Pt),"image/png")})}function S2(n,e,t,i,l,u){n.beginPath(),n.moveTo(e+u,t),n.lineTo(e+i-u,t),n.quadraticCurveTo(e+i,t,e+i,t+u),n.lineTo(e+i,t+l-u),n.quadraticCurveTo(e+i,t+l,e+i-u,t+l),n.lineTo(e+u,t+l),n.quadraticCurveTo(e,t+l,e,t+l-u),n.lineTo(e,t+u),n.quadraticCurveTo(e,t,e+u,t),n.closePath()}function CD(n){return new Promise((e,t)=>{const i=new Image;i.crossOrigin="anonymous",i.onload=()=>e(i),i.onerror=t,i.src=n})}function eu(n,e,t){if(n.measureText(e).width<=t)return[e];const i=e.split(" "),l=[];let u="";for(const d of i){const p=u?`${u} ${d}`:d;n.measureText(p).width>t&&u?(l.push(u),u=d):u=p}return u&&l.push(u),l}function RD(){const n=v.useRef(null),e=v.useCallback(()=>{if(!n.current)try{n.current=new(window.AudioContext||window.webkitAudioContext)}catch{}const u=n.current;return u?.state==="suspended"&&u.resume(),u},[]),t=v.useCallback(()=>{navigator.vibrate&&navigator.vibrate([40,60,30]);const u=e();if(!u)return;const d=u.currentTime,p=u.createBiquadFilter();p.type="lowpass",p.frequency.value=500,p.Q.value=.7,p.connect(u.destination);const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=50,y.gain.value=.3,y.gain.setTargetAtTime(0,d+.08,.04),g.connect(y).connect(p),g.start(d),g.stop(d+.2);const x=u.createOscillator(),j=u.createGain();x.type="sine",x.frequency.value=70,j.gain.value=.2,j.gain.setTargetAtTime(0,d+.22,.04),x.connect(j).connect(p),x.start(d+.15),x.stop(d+.35)},[e]),i=v.useCallback(()=>{navigator.vibrate&&navigator.vibrate(30);const u=e();if(!u)return;const d=u.currentTime,p=u.createBiquadFilter();p.type="lowpass",p.frequency.value=500,p.Q.value=.7,p.connect(u.destination);const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=55,y.gain.value=.35,y.gain.setTargetAtTime(0,d+.08,.04),g.connect(y).connect(p),g.start(d),g.stop(d+.2)},[e]),l=v.useCallback(()=>{navigator.vibrate&&navigator.vibrate([50,80,100]);const u=e();u&&[0,.12].forEach((d,p)=>{const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=p===0?523:784,y.gain.value=.12,y.gain.setTargetAtTime(0,u.currentTime+d+.15,.02),g.connect(y).connect(u.destination),g.start(u.currentTime+d),g.stop(u.currentTime+d+.2)})},[e]);return v.useEffect(()=>()=>{n.current?.close()},[]),{tap:i,tick:t,complete:l}}const AD=2e3,Dg=42,Pl=2*Math.PI*Dg,MD=1200,N2=["Another one in the bank!","Consistency beats everything.","You showed up  that's what counts.","Stronger every session."];function Qh({title:n,subtitle:e,stats:t,onDone:i,onDismissStart:l,onShareJourney:u,userName:d,buttonLabel:p="Done",holdLabel:g="Hold To Complete Session",shareType:y="workout"}){const[x,j]=v.useState("hold"),[T,B]=v.useState(!1),[$,F]=v.useState(0),[V,te]=v.useState(!1),[K,ae]=v.useState(!1),[ye,Ae]=v.useState(null),me=RD(),R=v.useRef(null),E=v.useRef(null),M=v.useRef(null),O=v.useRef(null),D=v.useRef(!1),q=v.useRef(!1),I=v.useRef(0),qe=v.useRef(N2[Math.floor(Math.random()*N2.length)]),ft=v.useRef([...Array(80)].map((ue,ze)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#ffffff","#000000"][ze%3],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:ze%3}))),W=v.useCallback(()=>{if(D.current)return;D.current=!0,q.current=!1,I.current=0,B(!0),F(0),O.current=performance.now(),me.tap(),R.current&&(R.current.style.strokeDashoffset=Pl);const ue=ze=>{const Le=ze-O.current,it=Math.min(Le/AD,1);if(R.current&&(R.current.style.strokeDashoffset=Pl-it*Pl),E.current){const pt=8*(1-it),Ye=1-it,Ht=1+it*.15;E.current.style.filter=`blur(${pt}px) grayscale(${Ye})`,E.current.style.transform=`scale(${Ht})`}F(it),Le-I.current>=MD&&(I.current=Le,me.tick()),it<1?M.current=requestAnimationFrame(ue):(D.current=!1,q.current=!0,M.current=null,B(!1),F(1),me.complete(),j("celebrate"))};M.current=requestAnimationFrame(ue)},[me]),de=v.useCallback(()=>{D.current&&(D.current=!1,M.current&&(cancelAnimationFrame(M.current),M.current=null),R.current&&(R.current.style.strokeDashoffset=Pl),E.current&&(E.current.style.filter="",E.current.style.transform=""),B(!1),F(0))},[]),Ie=v.useCallback(()=>{te(!0),l?.(),setTimeout(()=>{i?.()},300)},[i,l]),Ve=v.useCallback(()=>{const ue=[n||"Workout Complete!"];return e&&ue.push(e),t?.length&&ue.push(t.map(ze=>`${ze.value} ${ze.label}`).join(" | ")),ue.push("#MindCoreFitness"),ue.join(`
`)},[n,e,t]),ee=v.useCallback(async()=>{if(!(K||!u))try{await u({type:y==="habits"?"habits_summary":"workout_summary",title:n||"Workout Complete!",subtitle:e,stats:t||[],quote:qe.current}),ae(!0),Ae("Posted to Journey!"),setTimeout(()=>Ae(null),2500)}catch(ue){console.error("Journey post failed:",ue),Ae(ue?.message||"Failed to post"),setTimeout(()=>Ae(null),3500)}},[K,u,n,e,t]),[L,se]=v.useState(!1),De=v.useCallback(async()=>{se(!0);try{const ue=await sb({type:y||"workout",title:n||"Workout Complete!",subtitle:e,stats:t||[],quote:qe.current,userName:d}),ze=Ve();if(navigator.share&&navigator.canShare?.({files:[new File([ue],"workout.png",{type:"image/png"})]})){const Le=new File([ue],"workout.png",{type:"image/png"});await navigator.share({title:"Mind Core Fitness",text:ze,files:[Le]})}else navigator.share?await navigator.share({title:"Mind Core Fitness",text:ze}):(await navigator.clipboard.writeText(ze),Ae("Copied to clipboard!"),setTimeout(()=>Ae(null),2500))}catch{try{await navigator.clipboard.writeText(Ve()),Ae("Copied to clipboard!"),setTimeout(()=>Ae(null),2500)}catch{}}finally{se(!1)}},[n,e,t,d,Ve]);return x==="hold"?r.jsxs("div",{className:"wc-hold-page",children:[r.jsx("div",{className:"wc-hold-glow","aria-hidden":"true"}),r.jsx("p",{className:"wc-hold-label",children:g}),r.jsxs("div",{className:`wc-hold-ring-touch ${T?"wc-holding":""}`,onPointerDown:ue=>{ue.preventDefault(),W()},onPointerUp:de,onPointerLeave:de,onPointerCancel:de,onClick:ue=>{ue.stopPropagation(),q.current&&(q.current=!1)},role:"button",tabIndex:0,"aria-label":"Press and hold to finish workout",onKeyDown:ue=>{(ue.key==="Enter"||ue.key===" ")&&(ue.preventDefault(),me.complete(),j("celebrate"))},children:[r.jsx("div",{className:"wc-hold-ring-glow","aria-hidden":"true"}),r.jsxs("svg",{className:"wc-hold-ring-svg",viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"wc-hold-ring-track",cx:"50",cy:"50",r:Dg}),r.jsx("circle",{className:"wc-hold-ring-fill",ref:R,cx:"50",cy:"50",r:Dg,style:{strokeDasharray:Pl,strokeDashoffset:Pl}})]}),r.jsx("img",{ref:E,src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-hold-logo",draggable:!1})]})]}):r.jsxs("div",{className:`wc-celeb-overlay ${V?"wc-celeb-dismissing":""}`,children:[r.jsx("div",{className:"wc-celeb-confetti","aria-hidden":"true",children:ft.current.map((ue,ze)=>r.jsx("span",{className:`wc-celeb-confetti-piece wc-confetti-shape-${ue.shape}`,style:{"--x":`${ue.x}%`,"--delay":`${ue.delay}s`,"--color":ue.color,"--drift":`${ue.drift}px`,"--spin":`${ue.spin}deg`,"--duration":`${ue.duration}s`,width:`${ue.width}px`,height:`${ue.height}px`}},ze))}),r.jsxs("div",{className:"wc-celeb-content",children:[r.jsx("div",{className:"wc-celeb-logo-frame",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-celeb-logo-img"})}),r.jsx("h2",{className:"wc-celeb-heading",children:n||"Congratulations!"}),e&&r.jsx("p",{className:"wc-celeb-subtext",children:e}),r.jsx("p",{className:"wc-celeb-quote",children:qe.current}),t&&t.length>0&&r.jsx("div",{className:"wc-celeb-stats-row",children:t.map((ue,ze)=>r.jsxs("div",{className:"wc-celeb-stat",children:[r.jsx("span",{className:"wc-celeb-stat-val",children:ue.value}),r.jsx("span",{className:"wc-celeb-stat-label",children:ue.label})]},ze))}),r.jsxs("div",{className:"wc-share-row",children:[u&&r.jsxs("button",{className:`wc-share-btn wc-share-journey ${K?"wc-share-done":""}`,onClick:ee,disabled:K,children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20h9"}),r.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4Z"})]}),K?"Posted!":"Post to Journey"]}),r.jsxs("button",{className:"wc-share-btn wc-share-external",onClick:De,disabled:L,children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"18",cy:"5",r:"3"}),r.jsx("circle",{cx:"6",cy:"12",r:"3"}),r.jsx("circle",{cx:"18",cy:"19",r:"3"}),r.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),r.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),L?"Generating...":"Share"]})]}),r.jsx("button",{className:"wc-celeb-btn",onClick:Ie,children:p}),ye&&r.jsx("div",{className:"wc-share-toast",children:ye})]})]})}const C2="/login/assets/randomiser-glq9YJkL.jpg",ID="/login/assets/programme-card-workout-CnNzTYkz.webp",DD="/login/assets/prog-fullbody-4wk-r6m9HJys.jpg",PD="/login/assets/mg-arms-BeOQU3wx.jpg",LD=60,Gp=5,OD=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],BD={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Squeeze Press":"push","Incline Dumbbell Press":"push","Dumbbell Fly":"push","Dumbbell Pullover":"push","Tricep Kickback":"push","Dumbbell Shrug":"push","Dumbbell Y-Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Wide Dumbbell Bent Over Row":"pull","Reverse Fly":"pull","Concentration Curl":"pull","Wide Grip Bicep Curl":"pull","Wrist Curl":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core","Kettlebell Bird Dog Drag":"core"},VD={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},UD={fullbody:"linear-gradient(160deg, rgba(153,49,60,0.15) 0%, rgba(153,49,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",upper:"linear-gradient(160deg, rgba(100,60,140,0.2) 0%, rgba(100,60,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",lower:"linear-gradient(160deg, rgba(40,120,80,0.2) 0%, rgba(40,120,80,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)"},Kp={arms:"linear-gradient(160deg, rgba(180,60,60,0.2) 0%, rgba(180,60,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",chest:"linear-gradient(160deg, rgba(50,100,160,0.2) 0%, rgba(50,100,160,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",back:"linear-gradient(160deg, rgba(80,130,60,0.2) 0%, rgba(80,130,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",shoulders:"linear-gradient(160deg, rgba(160,100,40,0.2) 0%, rgba(160,100,40,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",legs:"linear-gradient(160deg, rgba(100,50,140,0.2) 0%, rgba(100,50,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)"},Yp=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,level:"All Levels",daysPerWeek:3,image:DD},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,level:"Intermediate",daysPerWeek:3},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,level:"Advanced",daysPerWeek:3},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,level:"Beginner",daysPerWeek:3},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,level:"Intermediate",daysPerWeek:3},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,level:"Advanced",daysPerWeek:3},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,level:"Intermediate",daysPerWeek:3},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,level:"Intermediate",daysPerWeek:3}],tu=[{key:"arms",label:"Arms",icon:"M7 5h2v14H7V5zm8 0h2v14h-2V5zm-5 4h4v6h-4V9z",image:PD},{key:"chest",label:"Chest",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15H9v-2h2v2zm4 0h-2v-2h2v2zm3-6c0 1.1-.36 2.12-.97 2.95l-.87-.87C16.7 12.53 17 11.8 17 11c0-2.76-2.24-5-5-5S7 8.24 7 11c0 .8.3 1.53.84 2.08l-.87.87A4.977 4.977 0 0 1 6 11c0-3.31 2.69-6 6-6s6 2.69 6 6z"},{key:"back",label:"Back",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm4 18H8v-6l-4-4 1.41-1.41L8 11.17V8h8v3.17l2.59-2.58L20 10l-4 4v6z"},{key:"shoulders",label:"Shoulders",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"legs",label:"Legs",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"}],R2={chest:[{id:"chest_strength",name:"Chest Strength",desc:"Heavy pressing for max strength",level:"Intermediate",overview:"A heavy pressing session designed to build raw chest strength. Focus on controlled negatives and powerful pressing movements.",tips:["Go heavy  pick a weight where the last 2 reps are a real challenge","Control the negative (lowering phase) for 2-3 seconds","Keep your shoulder blades squeezed together throughout all pressing movements","Rest 90-120 seconds between sets to allow full recovery"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Squeeze Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"chest_hypertrophy",name:"Chest Hypertrophy",desc:"Volume training for muscle growth",level:"Intermediate",overview:"A high-volume chest session focused on time under tension and muscle growth. Lighter weights, more reps, and slow controlled movements.",tips:["Use moderate weight  you should feel the burn by rep 10","Squeeze your chest at the top of every rep for 1 second","Keep rest periods short at 60-90 seconds to keep the pump going","On press ups, go to failure on the final set"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Press Up",type:"reps",sets:3,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"}]},{id:"chest_endurance",name:"Chest Endurance",desc:"Bodyweight pushing to failure",level:"All Levels",overview:"No weights needed. This bodyweight-only session builds chest endurance and muscular stamina through high-rep push up variations.",tips:["Focus on full range of motion  chest to floor on every rep","Keep your core tight and body in a straight line throughout","Scale down to knee press ups if you can't maintain form","Push through the burn  the last 5 reps are where the growth happens"],exercises:[{name:"Press Up",type:"reps",sets:4,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null},{name:"Decline Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Press Up Hold",type:"timed",sets:3,time:30,storagePath:null}]}],back:[{id:"back_strength",name:"Back Strength",desc:"Heavy rows for a thick back",level:"Intermediate",overview:"Build a thick, powerful back with heavy rowing movements. This session targets your lats, rhomboids, and traps for overall back development.",tips:["Go heavy on rows  use a weight that challenges you by rep 6-8","Drive your elbows back and squeeze your shoulder blades together at the top","Keep a slight bend in your knees and hinge at the hips for bent over movements","Rest 90-120 seconds between sets for full recovery"],exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"back_hypertrophy",name:"Back Hypertrophy",desc:"Width and thickness volume work",level:"Intermediate",overview:"A volume-focused back session combining rows and isolation moves to build width and thickness. Focus on the mind-muscle connection.",tips:["Use moderate weight  feel the stretch and squeeze on every rep","On renegade rows, keep your hips square to the floor and avoid rotating","For reverse flys, use lighter weight and focus on squeezing your rear delts","Keep rest to 60-90 seconds to maintain intensity"],exercises:[{name:"Renegade Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Reverse Fly",type:"weighted",sets:3,reps:15,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null}]},{id:"back_endurance",name:"Back Endurance",desc:"Bodyweight back conditioning",level:"All Levels",overview:"A bodyweight session to strengthen your posterior chain and improve posture. Great for back health, mobility, and muscular endurance.",tips:["On superman holds, lift your arms and legs simultaneously and hold tight","Focus on slow, controlled movements  quality over speed","Breathe steadily throughout timed holds  don't hold your breath","Engage your glutes and lower back together on every movement"],exercises:[{name:"Superman Hold",type:"timed",sets:4,time:30,storagePath:"exercises/bodyweight/upper/Superman Hold.mp4"},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:12,storagePath:null},{name:"Reverse Snow Angel",type:"reps",sets:3,reps:12,storagePath:null},{name:"Bird Dog",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Back Extension Hold",type:"timed",sets:3,time:30,storagePath:null}]}],shoulders:[{id:"shoulders_strength",name:"Shoulder Strength",desc:"Heavy pressing for boulder shoulders",level:"Intermediate",overview:"A heavy overhead pressing session to build strong, powerful shoulders. Compound movements first, followed by isolation work for all three delt heads.",tips:["Go heavy on presses  pick a weight where you struggle on the last 2 reps","Brace your core and avoid arching your back during overhead movements","Press straight up and control the weight down slowly","Rest 90-120 seconds between pressing sets, 60 seconds for isolation moves"],exercises:[{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"shoulders_hypertrophy",name:"Shoulder Hypertrophy",desc:"Volume and isolation for 3D delts",level:"Intermediate",overview:"A high-volume session targeting all three heads of the deltoid for that 3D capped shoulder look. Moderate weight, high reps, constant tension.",tips:["Use lighter weight than you think  shoulders respond best to high reps","On lateral raises, lead with your elbows and don't swing the weight","Pause at the top of each raise for a 1-second squeeze","Keep rest periods at 60 seconds to maximise the pump"],exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Y-Raise",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"shoulders_endurance",name:"Shoulder Endurance",desc:"Bodyweight and high-rep work",level:"All Levels",overview:"A shoulder endurance session combining bodyweight movements with high-rep dumbbell work. Builds stamina, stability, and shoulder resilience.",tips:["On pike push ups, walk your feet close to your hands to increase the angle","For high-rep lateral raises, use a very light weight and focus on form","Wall walks are advanced  scale to pike push ups if needed","Keep your core braced throughout to protect your lower back"],exercises:[{name:"Pike Push Ups",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/upper/pike push ups.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,reps:20,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Wall Walks",type:"reps",sets:3,reps:6,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null},{name:"Shoulder Tap Hold",type:"timed",sets:3,time:30,storagePath:null}]}],arms:[{id:"arms_bicep",name:"Bicep Focus",desc:"Curl variations for peak biceps",level:"All Levels",overview:"An arm session dedicated entirely to biceps. Multiple curl variations target different parts of the bicep for maximum peak and thickness.",tips:["Keep your elbows pinned to your sides  no swinging","Control the negative (lowering) for 2-3 seconds on every rep","Start with your heaviest weight and decrease as you fatigue","Squeeze hard at the top of each curl for a full contraction"],exercises:[{name:"Bicep Curl",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Concentration Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Isometric Bicep Hold",type:"timed",sets:3,time:20,storagePath:null}]},{id:"arms_tricep",name:"Tricep Focus",desc:"Extensions and dips for horseshoe triceps",level:"All Levels",overview:"All-out tricep training with extensions, dips, and pressing movements. The triceps make up two-thirds of your arm  this session builds serious size.",tips:["On overhead extensions, keep your elbows close to your head","For skullcrushers, lower the weight slowly to just above your forehead","On dips, lean slightly forward to reduce shoulder strain","Full lockout at the top of every extension for maximum tricep contraction"],exercises:[{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Tricep Dips",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null}]},{id:"arms_full",name:"Full Arms",desc:"Superset biceps and triceps",level:"All Levels",overview:"A balanced arm session alternating between biceps and triceps. Superset style keeps the intensity high and maximises the pump.",tips:["Superset each pair  do biceps then immediately hit triceps","Use moderate weight that lets you maintain strict form for all reps","Rest 60 seconds after each superset pair","Focus on the squeeze at the peak contraction of every rep"],exercises:[{name:"Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Wrist Curl",type:"weighted",sets:3,reps:15,storagePath:null}]}],legs:[{id:"legs_quad",name:"Quad Dominant",desc:"Squats and lunges for quad power",level:"All Levels",overview:"A quad-focused leg session built around squats and lunges. Heavy compound movements to build strong, powerful quads and overall leg strength.",tips:["On goblet squats, hold the dumbbell close to your chest and sit deep","Keep your knees tracking over your toes  don't let them cave inward","Drive through your heels on all squatting movements","Rest 90-120 seconds between heavy sets, 60 seconds on bodyweight moves"],exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/lower/bulgarian split squats.mp4"},{name:"Squat And Hold",type:"timed",sets:3,time:30,storagePath:"exercises/bodyweight/lower/squat and hold.mp4"}]},{id:"legs_ham_glute",name:"Hamstring & Glute",desc:"Posterior chain focus",level:"Intermediate",overview:"Target the back of your legs with deadlift and hip hinge variations. This session builds a strong posterior chain  hamstrings, glutes, and lower back.",tips:["On RDLs, push your hips back and feel the stretch in your hamstrings","Keep a slight bend in your knees throughout hip hinge movements","Squeeze your glutes hard at the top of every rep","For single leg work, start with your weaker side first"],exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/romanian deadlifts.mp4"},{name:"1 Legged RDL",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.mp4"},{name:"Hip Thrusts",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/hip thrusts.mp4"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.mp4"},{name:"Donkey Kicks",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.mp4"}]},{id:"legs_power",name:"Power & Plyo",desc:"Explosive leg training",level:"Intermediate",overview:"An explosive leg session combining plyometrics with weighted movements. Build power, speed, and athletic performance.",tips:["On jump squats, land softly with bent knees to absorb the impact","Explode up on every rep  power comes from speed, not just weight","Keep rest periods at 60-90 seconds to maintain intensity","Focus on landing mechanics  knees out, chest up, soft landing"],exercises:[{name:"Jump Squats",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/lower/jump squats.mp4"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Skater Jumps",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/skater jumps.mp4"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.mp4"}]}],core:[{id:"core_lower_abs",name:"Lower Abs Blast",desc:"40s work / 20s rest  3 rounds",level:"Intermediate",overview:"An interval-based core burner targeting the lower abdominals. 40 seconds of work followed by 20 seconds of rest  keep the intensity high and your lower back pressed into the floor throughout.",tips:["Press your lower back firmly into the floor on every rep","Exhale hard as you contract your abs  don't hold your breath","If your lower back lifts off the ground, reduce the range of motion","Focus on slow, controlled movements rather than speed"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Leg Raises",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Reverse Crunch To Leg Raise",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Flutter Kicks",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Dead Bug Single Leg Drop",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Hollow Hold Flutter Kicks",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"}]},{id:"core_obliques",name:"Obliques & Rotation",desc:"35s work / 25s rest  3 rounds",level:"Intermediate",overview:"Target the obliques and rotational core muscles with this interval session. 35 seconds of work with 25 seconds rest  every exercise involves twisting, rotating, or side-bracing movements.",tips:["Rotate from your ribcage, not just your arms","Keep your hips as still as possible during twisting exercises","Brace your core before each movement  think about squeezing a belt","On side planks, stack your hips and push the floor away"],interval:!0,rounds:3,work:35,rest:25,exercises:[{name:"Russian Twist",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank Rotation",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Cross Body Mountain Climbers",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Hip Dips Plank",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Bicycle Crunch",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank",storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{id:"core_weighted",name:"Weighted Core",desc:"40s work / 20s rest  3 rounds",level:"Advanced",overview:"Add resistance to your core training with dumbbells and kettlebells. 40 seconds of weighted work followed by 20 seconds rest  this session builds serious core strength and stability.",tips:["Start with a moderate weight  form is more important than load","Brace your entire core before picking up the weight each round","Keep movements controlled  no swinging or using momentum","If grip fails before core does, go slightly lighter next time"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Russian Twists Dumbbell",storagePath:"exercises/dumbbells/core/russian twists dumbbell.mp4"},{name:"Kettlebell Russian Twist",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Dumbbell Plank Pull Through",storagePath:null}]}]},A2=[{key:"bodyweight",label:"Bodyweight",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"},{key:"dumbbells",label:"Dumbbells",icon:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"},{key:"kettlebells",label:"Kettlebells",icon:"M12 2C9.24 2 7 4.24 7 7c0 1.1.36 2.12.97 2.95C6.76 11.08 6 12.96 6 15c0 3.87 2.69 7 6 7s6-3.13 6-7c0-2.04-.76-3.92-1.97-5.05.61-.83.97-1.85.97-2.95 0-2.76-2.24-5-5-5zm0 2c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"}],Qp=[{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"},{key:"upper",label:"Upper",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"lower",label:"Lower",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"fullbody",label:"Full Body",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z"},{key:"mix",label:"Mix It Up",icon:"M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm-.83 9.41l-1.42 1.42L17.96 20.54l1.42-1.42-5.71-5.71z"}],Ll=[{key:"beginner",label:"Beginner",work:30,rest:30,desc:"30s work / 30s rest"},{key:"intermediate",label:"Intermediate",work:40,rest:20,desc:"40s work / 20s rest"},{key:"advanced",label:"Advanced",work:40,rest:15,desc:"40s work / 15s rest"}],Xp=[5,10,15,20,30];function FD(n){return n.replace(/\b\w/g,e=>e.toUpperCase())}function zD(n){const e=[...n];for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return e}function qD(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Ur(),{isDark:l,toggleTheme:u,accent:d}=Na(),{isPremium:p,FREE_RANDOMISER_DURATIONS:g,FREE_RANDOMISER_WEEKLY_LIMIT:y}=km(),x=er(),[j,T]=v.useState("menu"),[B,$]=v.useState(["bodyweight"]),[F,V]=v.useState("core"),[te,K]=v.useState("intermediate"),[ae,ye]=v.useState(p?15:5),[Ae,me]=v.useState([]),[R,E]=v.useState(!1),M=v.useRef(!1),O=v.useRef([]),[D,q]=v.useState([]),[I,qe]=v.useState(2),[ft,W]=v.useState(Ll[1]),[de,Ie]=v.useState(1),[Ve,ee]=v.useState(0),[L,se]=v.useState("work"),[De,ue]=v.useState(0),[ze,Le]=v.useState(!1),[it,pt]=v.useState(0),[Ye,Ht]=v.useState(!1),[Ms,dt]=v.useState(!1),[mt,ne]=v.useState(null),Rt=v.useRef(null);v.useRef(null),v.useRef(null);const[Pt,At]=v.useState(null),vt=v.useCallback((X,xe="info")=>{At({message:X,type:xe}),setTimeout(()=>At(null),3e3)},[]),nt=v.useCallback(async X=>{if(!t)throw new Error("Not signed in");const xe=X&&typeof X=="object"&&X.type;await la(Ot(pe,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:xe?"":X,type:xe?X.type:"text",imageURL:null,createdAt:br(),likeCount:0,commentCount:0,...xe?{metadata:{title:X.title||"",subtitle:X.subtitle||"",stats:X.stats||[],quote:X.quote||"",badges:X.badges||[]}}:{}})},[t]),[$e,$t]=v.useState(null),[Ns,Ws]=v.useState(null),[Ut,St]=v.useState(0),[is,Is]=v.useState(0),[zt,Js]=v.useState([]),[Lt,ps]=v.useState(""),[Wt,we]=v.useState(""),[G,he]=v.useState(!1),[Ee,Oe]=v.useState(0),[ke,Qe]=v.useState(!1),[ot,Y]=v.useState({}),re=v.useRef(null),We=v.useRef(null),[Ge,rt]=v.useState([]),[bt,jt]=v.useState(null),[gt,Gt]=v.useState(0),[Gs,os]=v.useState(0),[ks,Us]=v.useState(0),[H,_e]=v.useState(0),[Ne,Se]=v.useState(0),[je,ct]=v.useState(0),[xt,Ze]=v.useState({beginner:0,intermediate:0,advanced:0}),kt=p?Xp:Xp.filter(X=>g.includes(X)),Et=!p&&gt>=y,[Cs,hn]=v.useState(null),[gn,Tn]=v.useState(""),[In,yn]=v.useState(!1);v.useEffect(()=>{!i&&(!n||!e)&&x("/")},[n,e,i,x]),v.useEffect(()=>{if(!n||!t)return;(async()=>{try{const xe=Ot(pe,"workoutLogs"),be=Os(xe,fs("clientId","==",t.id)),Xe=(await Es(be)).docs.map(Zt=>Zt.data()),ut=Xe.filter(Zt=>Zt.type!=="programme");_e(ut.length);const Kt=ut.reduce((Zt,en)=>Zt+(en.duration||0),0);Se(Kt);const Yt={beginner:0,intermediate:0,advanced:0};ut.forEach(Zt=>{Zt.level&&Yt[Zt.level]!==void 0&&Yt[Zt.level]++}),Ze(Yt);const Ft=new Date,Sn=Ft.getDay(),Mt=Sn===0?-6:1-Sn,Ds=new Date(Ft);Ds.setDate(Ft.getDate()+Mt),Ds.setHours(0,0,0,0);const bn=Ds.getTime(),Wn=Xe.filter(Zt=>{const en=Zt.completedAt;return en?(en.toDate?en.toDate().getTime():new Date(en).getTime())>=bn:!1});Gt(Wn.filter(Zt=>Zt.type!=="programme").length);let Rs=0;if(t)try{const Zt=await As(He(pe,"clientProgrammes",t.id));if(Zt.exists()){const en=Zt.data(),mn=en.templateId;Rs=Wn.filter(Nn=>Nn.type==="programme"&&Nn.programmeId===mn).length,hn(mn);const Gn=Yp.find(Nn=>Nn.id===mn);Gn&&Tn(Gn.name);const Kn=VD[mn];if(Kn){const Nn=Object.keys(en.completedSessions||{}).length,Yn=Kn.duration*Kn.daysPerWeek;Us(Yn>0?Math.round(Nn/Yn*100):0)}}else hn(null),Tn(""),Us(0)}catch{}os(Rs);const Zs=ut.map(Zt=>Zt.completedAt).filter(Boolean).map(Zt=>Zt.toDate?Zt.toDate().getTime():new Date(Zt).getTime()).sort((Zt,en)=>en-Zt);if(Zs.length===0)ct(0);else{const Zt=new Set;Zs.forEach(Yn=>{const ur=new Date(Yn),dr=ur.getDay(),C=dr===0?-6:1-dr,J=new Date(ur);J.setDate(ur.getDate()+C),J.setHours(0,0,0,0),Zt.add(J.getTime())});const en=[...Zt].sort((Yn,ur)=>ur-Yn);let mn=0;const Gn=new Date(Ft),Kn=Ft.getDay()===0?-6:1-Ft.getDay();Gn.setDate(Ft.getDate()+Kn),Gn.setHours(0,0,0,0);let Nn=Gn.getTime();en.includes(Nn)||(Nn-=10080*60*1e3);for(let Yn=0;Yn<200&&en.includes(Nn);Yn++)mn++,Nn-=10080*60*1e3;ct(mn)}}catch(xe){console.error("Error loading workout stats:",xe)}finally{yn(!0)}})()},[n,t,j]);const zs=()=>{const X=[];let xe;F==="mix"?xe=["core","upper","lower"]:F==="fullbody"?xe=["upper","lower"]:xe=[F];for(const be of B)for(const Je of xe)X.push(`exercises/${be}/${Je}`);return X},k=async()=>{if(M.current){for(;M.current;)await new Promise(X=>setTimeout(X,200));return O.current}M.current=!0,E(!0);try{const X=zs(),xe=[];for(const ut of X)try{const Kt=to(so,ut),Yt=await j2(Kt);xe.push(...Yt.items)}catch{console.warn(`Folder ${ut} not found, skipping.`)}if(xe.length===0&&B.includes("bodyweight")&&F==="core")try{const ut=to(so,"core"),Kt=await j2(ut);xe.push(...Kt.items)}catch{console.warn("Legacy core/ folder not found either.")}if(xe.length===0){const ut=B.map(Yt=>A2.find(Ft=>Ft.key===Yt)?.label).join(" + "),Kt=Qp.find(Yt=>Yt.key===F)?.label;return vt(`No exercises found for ${ut} / ${Kt}. Upload videos to Firebase Storage.`,"error"),M.current=!1,E(!1),[]}const be=new Set,Je=xe.filter(ut=>{const Kt=ut.name.replace(/\.(mp4|gif)$/i,"");return be.has(Kt)?!1:(be.add(Kt),!0)}),Xe=await Promise.all(Je.map(async ut=>{const Kt=await Ho(ut),Yt=FD(ut.name.replace(/\.(mp4|gif)$/i,"")),Ft=/\.gif$/i.test(ut.name);return{name:Yt,videoUrl:Kt,isGif:Ft}}));return O.current=Xe,me(Xe),M.current=!1,E(!1),Xe}catch(X){console.error("Error loading exercises:",X);const xe=X.code==="storage/unauthorized"?"Storage access denied. Check Firebase Storage rules allow read access.":`Failed to load exercises: ${X.message||X.code||"Unknown error"}`;return vt(xe,"error"),M.current=!1,E(!1),[]}},N=async()=>{if(Et)return;T("spinning"),O.current=[];const X=await k();if(X.length===0){T("setup");return}const xe=Ll.find(Sn=>Sn.key===te);W(xe);const be=xe.work+xe.rest,Je=ae*60,Xe=Math.floor(Je/be);let ut,Kt;Xe<=6?(ut=Math.max(3,Math.floor(Xe/2)),Kt=Math.floor(Xe/ut)):Xe<=12?(ut=Math.min(6,Math.floor(Xe/2)),Kt=Math.floor(Xe/ut)):(ut=Math.min(10,Math.floor(Xe/2)),Kt=Math.floor(Xe/ut)),Kt=Math.max(2,Kt);const Yt=zD(X),Ft=Yt.slice(0,Math.min(ut,Yt.length));q(Ft),qe(Kt),setTimeout(()=>T("preview"),2e3)},P=()=>{T("countdown"),pt(3)};v.useEffect(()=>{if(j!=="countdown")return;if(it<=0){T("workout"),Ie(1),ee(0),se("work"),ue(ft.work),Le(!1),cr();return}En();const X=setTimeout(()=>pt(xe=>xe-1),1e3);return()=>clearTimeout(X)},[it,j]),v.useEffect(()=>{if(j!=="workout"||ze)return;if(De<=0){U();return}De<=3&&En();const X=setTimeout(()=>ue(xe=>xe-1),1e3);return()=>clearTimeout(X)},[De,j,ze]);const U=()=>{if(L==="work")se("rest"),ue(ft.rest);else{const X=Ve+1;if(X>=D.length){const xe=de+1;if(xe>I){Ht(!0),fe();return}Ie(xe),ee(0)}else ee(X);se("work"),ue(ft.work),cr()}},fe=async()=>{if(n)try{await la(Ot(pe,"workoutLogs"),{clientId:t.id,level:te,duration:ae,equipment:B,focus:F,exerciseCount:D.length,rounds:I,exercises:D.map(X=>X.name),completedAt:_t.now()}),Gt(X=>X+1),_e(X=>X+1),Se(X=>X+ae),Ze(X=>({...X,[te]:(X[te]||0)+1}))}catch(X){console.error("Error saving workout log:",X)}},Ue=async(X,xe,be)=>{if(!(!t||!xe))try{const Je=t.id,Xe=await As(He(pe,"coreBuddyPBs",Je)),Kt=(Xe.exists()?Xe.data():null)?.exercises||{},Yt=Kt[X];let Ft=!1;if(Yt?(xe>(Yt.weight||0)||xe===(Yt.weight||0)&&be>(Yt.reps||0))&&(Ft=!0):Ft=!0,Ft){const Sn={...Kt,[X]:{weight:xe,reps:be,achievedAt:_t.now()}};await Ss(He(pe,"coreBuddyPBs",Je),{clientId:t.id,exercises:Sn,updatedAt:_t.now()}),vt(`New PB! ${xe}kg  ${be} reps`,"success"),En(),await Fe(X,xe)}}catch(Je){console.error("Error checking PB:",Je)}},Fe=async(X,xe)=>{if(t)try{const be=await As(He(pe,"coreBuddyTargets",t.id));if(!be.exists())return;const Xe=(be.data().targets||{})[X];if(!Xe||xe<Xe.targetWeight)return;const ut=await As(He(pe,"coreBuddyAchievements",t.id)),Kt=ut.exists()?ut.data():{clientId:t.id,badges:[],totalVolume:0};if(Kt.badges.some(Mt=>Mt.type==="pb_target"&&Mt.exercise===X&&Mt.targetWeight===Xe.targetWeight))return;const Ft={type:"pb_target",exercise:X,group:BD[X]||"push",targetWeight:Xe.targetWeight,achievedAt:_t.now()},Sn=[...Kt.badges,Ft];await Ss(He(pe,"coreBuddyAchievements",t.id),{...Kt,badges:Sn,updatedAt:_t.now()}),rt(Mt=>[...Mt,Ft])}catch(be){console.error("Error checking target badge:",be)}},st=async X=>{if(!(!t||X<=0))try{const xe=await As(He(pe,"coreBuddyAchievements",t.id)),be=xe.exists()?xe.data():{clientId:t.id,badges:[],totalVolume:0},Je=be.totalVolume||0,Xe=Je+X,ut=[];OD.forEach(Yt=>{Xe>=Yt.threshold&&Je<Yt.threshold&&(be.badges.some(Sn=>Sn.type==="volume_milestone"&&Sn.milestone===Yt.threshold)||ut.push({type:"volume_milestone",milestone:Yt.threshold,label:Yt.label,achievedAt:_t.now()}))});const Kt=[...be.badges,...ut];await Ss(He(pe,"coreBuddyAchievements",t.id),{clientId:t.id,badges:Kt,totalVolume:Math.round(Xe),updatedAt:_t.now()}),ut.length>0&&rt(Yt=>[...Yt,...ut])}catch(xe){console.error("Error updating volume:",xe)}},et=async X=>{if(Ws(X),X.interval){const Je=[];for(const Xe of X.exercises){let ut=null,Kt=!1;if(Xe.storagePath)try{const Yt=to(so,Xe.storagePath);ut=await Ho(Yt),Kt=/\.gif$/i.test(Xe.storagePath)}catch{}Je.push({name:Xe.name,videoUrl:ut,isGif:Kt})}q(Je),qe(X.rounds),W({work:X.work,rest:X.rest}),T("preview");return}const xe={};for(const Je of X.exercises)if(Je.storagePath)try{const Xe=to(so,Je.storagePath);xe[Je.name]={url:await Ho(Xe),isGif:/\.gif$/i.test(Je.storagePath)}}catch{}Y(xe);const be=X.exercises.map(Je=>({name:Je.name,type:Je.type,targetSets:Je.sets,targetReps:Je.reps||0,targetTime:Je.time||0,sets:[]}));Js(be),St(0),Is(0),ps(""),we(""),Qe(!1),he(!1),Oe(0),rt([]),jt(null),T("muscle_workout")},ss=()=>{const X=re.current;X&&(X.paused?(X.play(),Qe(!0)):(X.pause(),Qe(!1)))};v.useEffect(()=>{if(j!=="muscle_workout"||!G||Ee<=0){j==="muscle_workout"&&G&&Ee<=0&&(he(!1),En());return}return We.current=setTimeout(()=>Oe(X=>X-1),1e3),()=>clearTimeout(We.current)},[j,G,Ee]);const js=async()=>{const X=zt[Ut];let xe={};if(X.type==="weighted"){const Xe=parseFloat(Lt)||0,ut=parseInt(Wt)||0;if(ut===0){vt("Enter your reps","error");return}xe={weight:Xe,reps:ut}}else if(X.type==="reps"){const Xe=parseInt(Wt)||0;if(Xe===0){vt("Enter your reps","error");return}xe={reps:Xe}}else if(X.type==="timed"){const Xe=X.targetTime-Ee;xe={time:Math.max(Xe,1)}}const be=[...zt];be[Ut]={...X,sets:[...X.sets,xe]},Js(be),X.type==="weighted"&&xe.weight>0&&await Ue(X.name,xe.weight,xe.reps);const Je=X.sets.length+1;if(Je<X.targetSets)Is(Je),we(""),he(!1),Oe(0);else if(Ut+1<zt.length){const Xe=Ut+1;St(Xe),Is(0),ps(""),we(""),Qe(!1),he(!1),Oe(0)}else await us(be),dt(!0)},us=async X=>{if(!(!n||!t))try{const xe=X.reduce((Je,Xe)=>Je+Xe.sets.reduce((ut,Kt)=>ut+(Kt.weight||0)*(Kt.reps||0),0),0),be=X.reduce((Je,Xe)=>Je+Xe.sets.length,0);await la(Ot(pe,"workoutLogs"),{clientId:t.id,type:"muscle_group",muscleGroup:$e,sessionId:Ns?.id,sessionName:Ns?.name,exerciseCount:X.length,totalSets:be,duration:Math.round(be*1.5),volume:Math.round(xe),exercises:X.map(Je=>({name:Je.name,type:Je.type,sets:Je.sets})),completedAt:_t.now()}),xe>0&&await st(xe),Ge.length>0&&jt({badges:[...Ge]})}catch(xe){console.error("Error saving muscle group workout log:",xe)}},cs=v.useRef(null),qs=()=>(cs.current||(cs.current=new(window.AudioContext||window.webkitAudioContext)),cs.current),En=()=>{try{const X=qs(),xe=X.createOscillator(),be=X.createGain();xe.connect(be),be.connect(X.destination),xe.frequency.value=880,be.gain.value=.3,xe.start(X.currentTime),xe.stop(X.currentTime+.15)}catch{}},cr=()=>{try{const X=qs(),xe=X.createOscillator(),be=X.createGain();xe.connect(be),be.connect(X.destination),xe.frequency.value=1200,be.gain.value=.4,xe.start(X.currentTime),xe.stop(X.currentTime+.3)}catch{}};v.useEffect(()=>{if(j!=="workout"||L!=="work"||!D[Ve]?.isGif)return;const xe=setInterval(()=>{const be=Rt.current;if(!be)return;const Je=be.getAttribute("src");be.removeAttribute("src"),setTimeout(()=>{Rt.current&&Rt.current.setAttribute("src",Je)},0)},4e3);return()=>clearInterval(xe)},[j,L,Ve,de,D]);const ds=(X,xe,be)=>{const Je=Math.round(X/xe*LD);return r.jsx("svg",{className:"wk-ring-svg",viewBox:"0 0 200 200",children:rD.map((Xe,ut)=>r.jsx("line",{x1:Xe.x1,y1:Xe.y1,x2:Xe.x2,y2:Xe.y2,className:ut<Je?`wk-tick-filled ${be}`:"wk-tick-empty",strokeWidth:Xe.thick?"3":"2"},ut))})},Xr=()=>{const X=D.length*I;return((de-1)*D.length+Ve+(L==="rest"?.5:0))/X},Dn=Pt&&r.jsx("div",{className:`toast-notification ${Pt.type}`,children:Pt.message});if(i)return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>x("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsx("div",{className:"wk-loading-inline",children:r.jsx("div",{className:"wk-loading-spinner"})})]});if(j==="menu")return r.jsx(Ta,{children:r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>x("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[r.jsxs("div",{className:"wk-menu-heading",children:[r.jsx("h2",{children:"Choose Your Workout"}),r.jsx("p",{children:"No excuses. Just results."})]}),r.jsx("button",{className:"wk-hero-card",onClick:()=>T("setup"),children:r.jsx("img",{src:C2,alt:"Randomise Workout",className:"wk-hero-bg"})}),r.jsxs("div",{className:"wk-section-header",children:[r.jsxs("h2",{children:["Programmes ",!p&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),r.jsxs("span",{className:"wk-section-count",children:[Yp.length," available"]})]}),p?r.jsx("div",{className:"wk-prog-scroll-wrap",children:r.jsx("div",{className:"wk-prog-scroll",children:Yp.map((X,xe)=>X.image?r.jsxs("button",{className:"wk-prog-img-card",onClick:()=>x("/client/core-buddy/programmes",{state:{templateId:X.id}}),style:{animationDelay:`${xe*.06}s`},children:[r.jsx("img",{src:X.image,alt:X.name,className:"wk-prog-img"}),xe===0&&r.jsx("div",{className:"wk-swipe-arrow",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},X.id):r.jsxs("button",{className:"wk-prog-hero-card",onClick:()=>x("/client/core-buddy/programmes",{state:{templateId:X.id}}),style:{animationDelay:`${xe*.06}s`},children:[r.jsx("img",{src:ID,alt:"Programme",className:"wk-prog-hero-bg",loading:"lazy"}),r.jsx("div",{className:"wk-prog-hero-overlay",style:{background:UD[X.focus]}}),r.jsxs("div",{className:"wk-prog-hero-content",children:[r.jsxs("div",{className:"wk-prog-hero-top",children:[r.jsxs("span",{className:"wk-prog-hero-badge",children:[X.duration," WEEKS"]}),r.jsx("span",{className:"wk-prog-hero-level",children:X.level})]}),r.jsxs("div",{className:"wk-prog-hero-bottom",children:[r.jsx("h3",{children:X.name.toUpperCase()}),r.jsxs("p",{children:[X.daysPerWeek,"x per week  ",X.focus==="fullbody"?"Full Body":X.focus.charAt(0).toUpperCase()+X.focus.slice(1)," Focus"]}),r.jsx("span",{className:"wk-prog-hero-go",children:"VIEW PROGRAMME "})]})]}),xe===0&&r.jsx("div",{className:"wk-swipe-arrow",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},X.id))})}):r.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>x("/upgrade"),children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),r.jsx("span",{children:"Upgrade to unlock programmes"})]}),r.jsxs("div",{className:"wk-section-header",children:[r.jsxs("h2",{children:["Muscle Groups ",!p&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),r.jsxs("span",{className:"wk-section-count",children:[tu.length," groups"]})]}),p?r.jsx("div",{className:"wk-muscle-grid",children:tu.map((X,xe)=>r.jsx("button",{className:`wk-muscle-hero-card${X.image?" wk-muscle-thumb":""}`,onClick:()=>{$t(X.key),T("muscle_sessions")},style:{animationDelay:`${xe*.05}s`},children:X.image?r.jsx("img",{src:X.image,alt:X.label,className:"wk-muscle-thumb-img"}):r.jsxs(r.Fragment,{children:[r.jsx("img",{src:C2,alt:"Muscle group",className:"wk-muscle-hero-bg",loading:"lazy"}),r.jsx("div",{className:"wk-muscle-hero-overlay",style:{background:Kp[X.key]}}),r.jsxs("div",{className:"wk-muscle-hero-content",children:[r.jsx("div",{className:"wk-muscle-hero-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:X.icon})})}),r.jsxs("div",{className:"wk-muscle-hero-text",children:[r.jsx("span",{className:"wk-muscle-hero-name",children:X.label}),r.jsxs("span",{className:"wk-muscle-hero-count",children:[R2[X.key]?.length||0," sessions"]})]})]})]})},X.key))}):r.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>x("/upgrade"),children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),r.jsx("span",{children:"Upgrade to unlock muscle group workouts"})]})]}),r.jsx(ua,{active:"workouts"}),Dn]})});if(j==="setup"){const X=Qp.find(be=>be.key===F)?.label||F,xe=Ll.find(be=>be.key===te)?.label||te;return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>T("menu"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main wk-setup-main",children:[r.jsx("div",{className:"wk-stats-row",children:[{label:"Total",value:`${H}`,pct:H>0?Math.min(Math.round(H/100*100),100):0,color:"#14b8a6",size:"normal"},{label:"This Week",value:`${gt}/${Gp}`,pct:Math.round(Math.min(gt,Gp)/Gp*100),color:"var(--color-primary)",size:"large"},{label:"Wk Streak",value:`${je}`,pct:je>0?Math.min(Math.round(je/12*100),100):0,color:"#38B6FF",size:"normal"}].map(be=>{const Xe=2*Math.PI*38,ut=Xe-be.pct/100*Xe;return r.jsxs("div",{className:`wk-stat-item${be.size==="large"?" wk-stat-large":""}`,children:[r.jsxs("div",{className:"wk-stat-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"wk-stat-track",cx:"50",cy:"50",r:38}),r.jsx("circle",{className:"wk-stat-fill",cx:"50",cy:"50",r:38,style:{stroke:be.color},strokeDasharray:Xe,strokeDashoffset:ut})]}),r.jsx("span",{className:"wk-stat-value",style:{color:be.color},children:be.value})]}),r.jsx("span",{className:"wk-stat-label",children:be.label})]},be.label)})}),r.jsxs("div",{className:"wk-setup-flow",children:[r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Focus Area"}),r.jsx("div",{className:"wk-focus-grid",children:Qp.map(be=>r.jsxs("button",{className:`wk-equip-btn${F===be.key?" active":""}${be.key==="mix"?" wk-mix-btn":""}`,onClick:()=>V(be.key),children:[r.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:be.icon})}),r.jsx("span",{children:be.label})]},be.key))})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Level"}),r.jsx("div",{className:"wk-level-cards",children:Ll.map(be=>r.jsxs("button",{className:`wk-level-card wk-level-${be.key}${te===be.key?" active":""}`,onClick:()=>K(be.key),children:[r.jsx("span",{className:"wk-level-name",children:be.label}),r.jsx("span",{className:"wk-level-desc",children:be.desc})]},be.key))})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Time"}),r.jsx("div",{className:"wk-time-options",children:Xp.map(be=>{const Je=!kt.includes(be);return r.jsxs("button",{className:`wk-time-btn${ae===be?" active":""}${Je?" locked":""}`,onClick:()=>!Je&&ye(be),disabled:Je,children:[r.jsx("span",{className:"wk-time-num",children:be}),r.jsx("span",{className:"wk-time-unit",children:Je?r.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}):"min"})]},be)})})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Equipment"}),r.jsx("div",{className:"wk-equip-options",children:A2.map(be=>{const Je=B.includes(be.key);return r.jsxs("button",{className:`wk-equip-btn${Je?" active":""}`,onClick:()=>{$(Xe=>Je&&Xe.length===1?Xe:Je?Xe.filter(ut=>ut!==be.key):[...Xe,be.key])},children:[r.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:be.icon})}),r.jsx("span",{children:be.label})]},be.key)})})]}),r.jsx("div",{className:"wk-setup-summary",children:r.jsxs("span",{children:[X,"  ",xe,"  ",ae," min"]})})]})]}),r.jsxs("div",{className:"wk-go-sticky",children:[Et&&r.jsx("p",{className:"wk-free-limit-msg",children:"You've used your free workout this week. Upgrade for unlimited access."}),r.jsx("button",{className:"wk-randomise-btn",onClick:N,disabled:R||Et,children:R?"Loading exercises...":Et?"Limit Reached":"Randomise Workout"})]}),Dn]})}if(j==="spinning")return r.jsxs("div",{className:"wk-page wk-page-center","data-theme":l?"dark":"light","data-accent":d,children:[r.jsxs("div",{className:"wk-spin-container",children:[r.jsxs("div",{className:"wk-spin-ring",children:[r.jsx("svg",{className:"wk-spin-svg",viewBox:"0 0 200 200",children:Hk.map((X,xe)=>r.jsx("line",{x1:X.x1,y1:X.y1,x2:X.x2,y2:X.y2,className:"wk-spin-tick",strokeWidth:X.thick?"3.5":"2",style:{animationDelay:`${xe*.03}s`}},xe))}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-spin-logo",width:"50",height:"50"})]}),r.jsx("p",{className:"wk-spin-text",children:"Generating workout..."})]}),Dn]});if(j==="preview"){const X=Ns?.interval?{work:Ns.work,rest:Ns.rest}:Ll.find(be=>be.key===te),xe=D.length*I*(X.work+X.rest);return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>T(Ns?.interval?"muscle_sessions":"setup"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[Ns?.interval&&r.jsx("h2",{className:"mg-preview-title",children:Ns.name}),r.jsxs("div",{className:"wk-preview-stats",children:[r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:D.length}),r.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:I}),r.jsx("span",{className:"wk-stat-label",children:"Rounds"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:Math.ceil(xe/60)}),r.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsxs("span",{className:"wk-stat-val",children:[X.work,"/",X.rest]}),r.jsx("span",{className:"wk-stat-label",children:"Work/Rest"})]})]}),r.jsx("div",{className:"wk-preview-list",children:D.map((be,Je)=>r.jsxs("div",{className:"wk-preview-item",style:{animationDelay:`${Je*.06}s`},onClick:()=>ne(be),children:[r.jsx("span",{className:"wk-preview-num",children:Je+1}),r.jsx("div",{className:"wk-preview-thumb",children:be.isGif?r.jsx("img",{src:be.videoUrl,alt:be.name,loading:"lazy"}):r.jsx("video",{src:`${be.videoUrl}#t=0.1`,muted:!0,playsInline:!0,preload:"auto"})}),r.jsx("span",{className:"wk-preview-name",children:be.name}),r.jsx("svg",{className:"wk-preview-play",width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]},Je))}),mt&&r.jsx("div",{className:"wk-preview-modal-backdrop",onClick:()=>ne(null),children:r.jsxs("div",{className:"wk-preview-modal",onClick:be=>be.stopPropagation(),children:[r.jsx("button",{className:"wk-preview-modal-close",onClick:()=>ne(null),"aria-label":"Close preview",children:r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),r.jsx("div",{className:"wk-preview-modal-video",children:mt.isGif?r.jsx("img",{src:mt.videoUrl,alt:mt.name}):r.jsx("video",{src:mt.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0})}),r.jsx("h3",{className:"wk-preview-modal-title",children:mt.name})]})}),r.jsxs("div",{className:"wk-preview-actions",children:[!Ns?.interval&&r.jsxs("button",{className:"wk-btn-secondary",onClick:()=>N(),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("polyline",{points:"1 4 1 10 7 10"}),r.jsx("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})]}),"Reshuffle"]}),r.jsx("button",{className:"wk-btn-primary",onClick:P,children:"Start Workout"})]})]})]})}if(j==="countdown")return r.jsx("div",{className:"wk-page wk-page-center wk-page-dark","data-theme":l?"dark":"light","data-accent":d,children:r.jsxs("div",{className:"wk-countdown-big",children:[r.jsx("span",{className:"wk-countdown-num",children:it}),r.jsx("span",{className:"wk-countdown-label",children:"GET READY"})]})});if(j==="workout"){const X=D[Ve],xe=L==="work"?ft.work:ft.rest,be=L==="rest"?Ve+1<D.length?D[Ve+1]:de<I?D[0]:null:null;return r.jsxs("div",{className:"wk-page wk-page-workout","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("div",{className:"wk-video-container",children:L==="work"?X.isGif?r.jsx("img",{ref:Rt,className:"wk-video",src:X.videoUrl,alt:X.name},X.videoUrl):r.jsx("video",{className:"wk-video",src:X.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0},X.videoUrl):r.jsxs("div",{className:"wk-rest-screen",children:[r.jsx("span",{className:"wk-rest-label",children:"REST"}),be&&r.jsxs("span",{className:"wk-next-label",children:["Next: ",be.name]})]})}),r.jsx("div",{className:"wk-back-row",children:r.jsxs("button",{className:"wk-back-btn",onClick:()=>{confirm("Leave workout?")&&T("menu")},children:[r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]})}),r.jsx("div",{className:"wk-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"wk-exercise-info",children:[r.jsxs("span",{className:"wk-exercise-counter",children:[Ve+1," / ",D.length]}),r.jsx("h2",{className:"wk-exercise-name",children:X.name}),r.jsxs("span",{className:"wk-round-label",children:["Round ",de," of ",I]})]}),r.jsx("div",{className:"wk-timer-section",children:r.jsxs("div",{className:"wk-timer-ring-wrap",children:[ds(De,xe,L==="work"?"wk-tick-work":"wk-tick-rest"),r.jsxs("div",{className:"wk-timer-center",children:[r.jsx("span",{className:"wk-timer-time",children:De}),r.jsx("span",{className:`wk-timer-phase ${L}`,children:L==="work"?"WORK":"REST"})]})]})}),r.jsxs("div",{className:"wk-controls",children:[r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-stop",onClick:()=>{confirm("End workout early?")&&T("menu")},children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})})}),r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-pause",onClick:()=>Le(!ze),children:ze?r.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}):r.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:[r.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),r.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]})}),r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-skip",onClick:()=>{ue(0)},children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:[r.jsx("polygon",{points:"5 4 15 12 5 20 5 4"}),r.jsx("rect",{x:"15",y:"4",width:"4",height:"16"})]})})]}),r.jsx("div",{className:"wk-progress-bar",children:r.jsx("div",{className:"wk-progress-fill",style:{width:`${Xr()*100}%`}})}),Ye&&(()=>{const Je=Ll.find(ut=>ut.key===te),Xe=D.length*I*(Je.work+Je.rest);return r.jsx(Qh,{title:"Workout Complete!",stats:[{value:Math.ceil(Xe/60),label:"Minutes"},{value:D.length*I,label:"Intervals"},{value:I,label:"Rounds"}],onShareJourney:t?nt:null,userName:t?.name,onDismissStart:()=>T("menu"),onDone:()=>{Ht(!1),Ws(null),$t(null)}})})()]})}if(j==="muscle_sessions"){const X=tu.find(be=>be.key===$e),xe=R2[$e]||[];return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>T("menu"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[r.jsxs("div",{className:"mg-sessions-header",children:[r.jsx("div",{className:"mg-sessions-icon",style:{background:Kp[$e]},children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:X?.icon})})}),r.jsxs("h2",{children:[X?.label," Workouts"]}),r.jsxs("p",{children:[xe.length," sessions available"]})]}),r.jsx("div",{className:"mg-sessions-list",children:xe.map((be,Je)=>r.jsxs("button",{className:"mg-session-card",onClick:()=>{Ws(be),T("muscle_overview")},style:{animationDelay:`${Je*.08}s`},children:[r.jsxs("div",{className:"mg-session-info",children:[r.jsx("h3",{children:be.name}),r.jsx("p",{children:be.desc}),r.jsx("div",{className:"mg-session-meta",children:be.interval?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"mg-session-tag mg-tag-interval",children:"Interval"}),r.jsxs("span",{className:"mg-session-tag",children:[be.exercises.length," exercises"]}),r.jsxs("span",{className:"mg-session-tag",children:[be.rounds," rounds"]})]}):r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"mg-session-tag mg-tag-strength",children:"Strength"}),r.jsxs("span",{className:"mg-session-tag",children:[be.exercises.length," exercises"]}),r.jsx("span",{className:"mg-session-tag",children:(()=>{const Xe=be.exercises.map(Yt=>Yt.sets||0),ut=Math.min(...Xe),Kt=Math.max(...Xe);return ut===Kt?`${ut} sets each`:`${ut}-${Kt} sets each`})()})]})})]}),r.jsx("div",{className:"mg-session-arrow",children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},be.id))})]}),Dn]})}if(j==="muscle_overview"){const X=Ns;if(!X)return null;const xe=tu.find(be=>be.key===$e);return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>T("muscle_sessions"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main mg-overview-main",children:[r.jsx("div",{className:"mg-overview-hero",style:{background:Kp[$e]},children:r.jsx("div",{className:"mg-overview-hero-content",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"mg-overview-hero-icon",children:r.jsx("path",{d:xe?.icon})})})}),r.jsxs("div",{className:"mg-overview-header",children:[r.jsxs("div",{className:"mg-overview-title-row",children:[r.jsx("h2",{children:X.name}),X.level&&r.jsx("span",{className:"mg-overview-level",children:X.level})]}),r.jsx("p",{className:"mg-overview-desc",children:X.desc})]}),X.overview&&r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 16v-4M12 8h.01"})]}),"About This Workout"]}),r.jsx("p",{children:X.overview})]}),X.tips&&X.tips.length>0&&r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Tips & Form"]}),r.jsx("ul",{className:"mg-overview-tips",children:X.tips.map((be,Je)=>r.jsx("li",{children:be},Je))})]}),r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"}),r.jsx("rect",{x:"9",y:"3",width:"6",height:"4",rx:"1"}),r.jsx("path",{d:"M9 14l2 2 4-4"})]}),"Exercises (",X.exercises.length,")"]}),r.jsx("div",{className:"mg-overview-exercises",children:X.exercises.map((be,Je)=>r.jsxs("div",{className:"mg-overview-exercise",children:[r.jsx("span",{className:"mg-overview-ex-num",children:Je+1}),r.jsxs("div",{className:"mg-overview-ex-info",children:[r.jsx("span",{className:"mg-overview-ex-name",children:be.name}),X.interval?r.jsxs("span",{className:"mg-overview-ex-detail",children:[X.work,"s work / ",X.rest,"s rest"]}):r.jsxs("span",{className:"mg-overview-ex-detail",children:[be.sets," sets  ",be.reps?`${be.reps} reps`:`${be.time}s`,be.type==="weighted"&&"  weighted"]})]})]},Je))})]}),r.jsxs("button",{className:"mg-overview-start-btn",onClick:()=>et(X),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Workout"]})]}),Dn]})}if(j==="muscle_workout"){const X=Ns;if(!X)return null;const xe=X.exercises[Ut],be=zt[Ut];if(!xe||!be)return null;const Je=be.sets.length,Xe=X.exercises.length,ut=X.exercises.reduce((Mt,Ds)=>Mt+(Ds.sets||0),0),Yt=zt.reduce((Mt,Ds)=>Mt+Ds.sets.length,0)/ut*100,Ft=ot[xe.name];xe.type==="timed"&&Ee===0&&!G&&Je===is&&setTimeout(()=>Oe(xe.time),0);const Sn=Je+1<xe.sets?"Log Set":Ut+1<Xe?"Log Set  Next Exercise":"Log Set  Complete";return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("div",{className:"mg-session-progress",children:r.jsx("div",{className:"mg-session-progress-fill",style:{width:`${Yt}%`}})}),r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>{confirm("End workout early?")&&T("muscle_overview")},"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsxs("span",{className:"mg-header-info",children:["Exercise ",Ut+1,"/",Xe]}),r.jsx("div",{style:{width:22}})]})}),r.jsxs("main",{className:"wk-main",children:[Ft?r.jsxs("div",{className:"mg-video-container",onClick:ss,children:[Ft.isGif?r.jsx("img",{className:"mg-video",src:Ft.url,alt:xe.name}):r.jsx("video",{ref:re,className:"mg-video",src:Ft.url,loop:!0,muted:!0,playsInline:!0},xe.name),!ke&&!Ft.isGif&&r.jsxs("div",{className:"mg-video-overlay",children:[r.jsx("svg",{className:"mg-play-icon",width:"48",height:"48",viewBox:"0 0 24 24",fill:"rgba(255,255,255,0.9)",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),r.jsx("span",{className:"mg-video-hint",children:"Tap for demo"})]})]}):r.jsxs("div",{className:"mg-video-placeholder",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.4",children:[r.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),r.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),r.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),r.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),r.jsx("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),r.jsx("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),r.jsx("line",{x1:"17",y1:"7",x2:"22",y2:"7"}),r.jsx("line",{x1:"17",y1:"17",x2:"22",y2:"17"})]}),r.jsx("span",{children:"Video coming soon"})]}),r.jsx("div",{className:"wk-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"mg-exercise-card",children:[r.jsx("h2",{className:"mg-ex-name",children:xe.name}),r.jsx("span",{className:`mg-ex-type-badge ${xe.type}`,children:xe.type==="weighted"?"Weight + Reps":xe.type==="reps"?"Reps Only":"Timed"}),r.jsxs("div",{className:"mg-ex-set-info",children:[r.jsxs("span",{className:"mg-ex-set-num",children:["Set ",Je+1," of ",xe.sets]}),xe.type!=="timed"&&r.jsxs("span",{className:"mg-ex-target",children:["Target: ",xe.reps," reps"]}),xe.type==="timed"&&r.jsxs("span",{className:"mg-ex-target",children:["Target: ",xe.time,"s"]})]}),xe.type==="weighted"&&r.jsxs("div",{className:"mg-input-area",children:[r.jsxs("div",{className:"mg-input-group",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",className:"mg-input",value:Lt,onChange:Mt=>ps(Mt.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"mg-input-group",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:Wt,onChange:Mt=>we(Mt.target.value),placeholder:"0"})]})]}),xe.type==="reps"&&r.jsx("div",{className:"mg-input-area",children:r.jsxs("div",{className:"mg-input-group mg-input-single",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:Wt,onChange:Mt=>we(Mt.target.value),placeholder:"0"})]})}),xe.type==="timed"&&r.jsxs("div",{className:"mg-timer-area",children:[r.jsx("div",{className:"mg-timer-display",children:r.jsxs("span",{className:"mg-timer-value",children:[Ee,"s"]})}),G?r.jsx("button",{className:"mg-timer-btn mg-timer-stop",onClick:()=>he(!1),children:"Stop"}):r.jsx("button",{className:"mg-timer-btn",onClick:()=>{Ee===0&&Oe(xe.time),he(!0)},children:Ee<xe.time&&Ee>0?"Resume":"Start Timer"})]}),r.jsx("button",{className:"mg-log-set-btn",onClick:js,children:Sn}),be.sets.length>0&&r.jsx("div",{className:"mg-completed-sets",children:be.sets.map((Mt,Ds)=>r.jsxs("div",{className:"mg-completed-set",children:[r.jsx("span",{className:"mg-completed-set-check",children:""}),r.jsxs("span",{children:["Set ",Ds+1,": ",Mt.weight!=null?`${Mt.weight}kg  ${Mt.reps}`:Mt.reps!=null?`${Mt.reps} reps`:`${Mt.time}s`]})]},Ds))})]})]}),Dn,Ms&&(()=>{const Mt=zt.reduce((Rs,Zs)=>Rs+Zs.sets.length,0),Ds=zt.reduce((Rs,Zs)=>Rs+Zs.sets.reduce((Zt,en)=>Zt+(en.weight||0)*(en.reps||0),0),0),bn=tu.find(Rs=>Rs.key===$e)?.label||"",Wn=[{value:zt.length,label:"Exercises"},{value:Mt,label:"Sets"}];return Ds>0&&Wn.push({value:Math.round(Ds).toLocaleString(),label:"Volume (kg)"}),r.jsx(Qh,{title:`${bn} Complete!`,subtitle:Ns?.name,stats:Wn,onShareJourney:t?nt:null,userName:t?.name,onDismissStart:()=>T("menu"),onDone:()=>{dt(!1),Ws(null),$t(null),jt(null)}})})(),bt&&r.jsx("div",{className:"mg-badge-celebration",onClick:()=>jt(null),children:r.jsxs("div",{className:"mg-badge-celebration-card",children:[r.jsx("div",{className:"mg-badge-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",width:"48",height:"48",fill:"#ffc107",children:r.jsx("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})})}),r.jsx("h3",{className:"mg-badge-celebration-title",children:bt.badges.length===1?"Badge Earned!":`${bt.badges.length} Badges Earned!`}),r.jsx("div",{className:"mg-badge-celebration-list",children:bt.badges.map((Mt,Ds)=>r.jsx("div",{className:"mg-badge-celebration-item",children:Mt.type==="pb_target"?`${Mt.exercise}  ${Mt.targetWeight}kg`:Mt.label},Ds))}),r.jsxs("div",{className:"mg-badge-share-row",children:[r.jsxs("button",{className:"mg-badge-share-btn",onClick:async Mt=>{Mt.stopPropagation();const Ds=bt.badges[0],bn=bt.badges.map(Rs=>Rs.type==="pb_target"?`PB Target Hit: ${Rs.exercise}  ${Rs.targetWeight}kg`:Rs.label),Wn=Hn.find(Rs=>Rs.id===Ds?.id)||Hn.find(Rs=>Rs.name===Ds?.label);await nt({type:"badge_earned",title:bn.length===1?bn[0]:`${bn.length} Badges Earned!`,badges:bn,badgeDesc:Wn?.desc}),vt("Posted to Journey!","success")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20h9"}),r.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4Z"})]}),"Journey"]}),r.jsxs("button",{className:"mg-badge-share-btn",onClick:async Mt=>{Mt.stopPropagation();const Ds=bt.badges[0],bn=bt.badges.map(Zs=>Zs.type==="pb_target"?`PB Target Hit: ${Zs.exercise}  ${Zs.targetWeight}kg`:Zs.label),Wn=Hn.find(Zs=>Zs.id===Ds?.id)||Hn.find(Zs=>Zs.name===Ds?.label),Rs=`Badge Earned! ${bn.join(", ")}
#MindCoreFitness`;try{const Zs=await sb({type:"badge",title:bn.length===1?bn[0]:"Badges Earned!",badges:bn,badgeImage:Wn?.img,badgeDesc:Wn?.desc});navigator.share&&navigator.canShare?.({files:[new File([Zs],"badge.png",{type:"image/png"})]})?await navigator.share({title:"Mind Core Fitness",text:Rs,files:[new File([Zs],"badge.png",{type:"image/png"})]}):navigator.share?await navigator.share({title:"Mind Core Fitness",text:Rs}):(await navigator.clipboard.writeText(Rs),vt("Copied!","success"))}catch{try{await navigator.clipboard.writeText(Rs),vt("Copied!","success")}catch{}}},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"18",cy:"5",r:"3"}),r.jsx("circle",{cx:"6",cy:"12",r:"3"}),r.jsx("circle",{cx:"18",cy:"19",r:"3"}),r.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),r.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),"Share"]})]}),r.jsx("button",{className:"mg-badge-celebration-dismiss",children:"Tap to dismiss"})]})})]})}return null}const HD=60,$D={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},WD=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],M2=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,daysPerWeek:3,level:"All Levels",description:"Build total body strength with compound dumbbell movements and bodyweight finishers",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push Focus",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Goblet Squats",type:"weighted",sets:3,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull Focus",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:3,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:3,baseReps:10,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Reverse Lunge",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/reverse lunge.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Legs & Core",exercises:[{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Box Step Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/box step ups.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,daysPerWeek:3,level:"Intermediate",description:"Two-phase programme building strength and endurance across your full body",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Power",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"}]},{name:"Day 3",label:"Endurance",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,daysPerWeek:3,level:"Advanced",description:"Complete transformation programme: push, pull, and legs over three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Upper Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Lower Body",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 3",label:"Upper Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,daysPerWeek:3,level:"Beginner",description:"Build a solid core foundation with targeted ab and stability work",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Abs",exercises:[{name:"Crunch",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Stability",exercises:[{name:"Dead Bug",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Bird Dog",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:20,storagePath:"exercises/bodyweight/core/Side Plank.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"}]},{name:"Day 3",label:"Power Core",exercises:[{name:"Single Leg V-Up",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Single Leg V-Up.mp4"},{name:"Toe Reaches",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/toe reaches.GIF"},{name:"Russian Twists Dumbbell",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/core/russian twists dumbbell.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Fast Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Fast Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,daysPerWeek:3,level:"Intermediate",description:"Develop deep core strength and rotational power over two phases",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Anti-Extension",exercises:[{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Dead Bug",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Plank Walkout",type:"reps",sets:3,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"}]},{name:"Day 2",label:"Rotation",exercises:[{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank Rotation",type:"reps",sets:2,baseReps:10,storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"},{name:"Hollow Hold To V-Sit",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Kettlebell Bird Dog Drag",type:"reps",sets:3,baseReps:10,storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,daysPerWeek:3,level:"Advanced",description:"Ultimate core transformation: stability, strength, and power across three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Forearm Plank",type:"timed",sets:4,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Plank Walkout",type:"reps",sets:4,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Leg Raises",type:"reps",sets:4,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Kettlebell Side Bends",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Dead Bug Single Leg Drop",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 2",label:"Endurance",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:4,baseReps:15,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Hollow Hold Flutter Kicks",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"},{name:"Cross Body Mountain Climbers",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Hollow Hold To V-Sit",type:"reps",sets:4,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Hip Dips Plank",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Kneeling Kettlebell Halo",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,daysPerWeek:3,level:"Intermediate",description:"Sculpt and strengthen your chest, back, shoulders, and arms",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Tricep Dips",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Pike Push Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/upper/pike push ups.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Reverse Plank",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/upper/reverse plank.GIF"}]},{name:"Day 3",label:"Mixed",exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Renegade Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Superman Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Superman Hold.mp4"}]}]},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,daysPerWeek:3,level:"Intermediate",description:"Build powerful legs and glutes with squats, deadlifts, and plyometrics",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Quad Dominant",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Squat And Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/lower/squat and hold.GIF"}]},{name:"Day 2",label:"Hamstring & Glute",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"1 Legged RDL",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.GIF"},{name:"Hip Thrusts",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/hip thrusts.GIF"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.GIF"},{name:"Donkey Kicks",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 3",label:"Power & Stability",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Kettlebell Romanian Deadlift",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/kettlebells/lower/kettlebell romanian deadlift.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Skater Jumps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/skater jumps.GIF"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]}];function ch(n,e,t){const i=n.baseReps?n.baseReps+(e-1)*(t.repProg||0):void 0,l=n.baseTime?n.baseTime+(e-1)*(t.timeProg||0):void 0;return{sets:n.sets,reps:i,time:l}}const GD={fullbody:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z",core:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z",upper:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z",lower:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"};function KD(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Ur(),{isDark:l,toggleTheme:u,accent:d}=Na(),p=er(),g=Sa(),[y,x]=v.useState("loading"),[j,T]=v.useState(null),B=v.useRef(!1),[$,F]=v.useState(null),[V,te]=v.useState(!1),[K,ae]=v.useState(1),[ye,Ae]=v.useState(0),[me,R]=v.useState(0),[E,M]=v.useState(0),[O,D]=v.useState([]),[q,I]=v.useState(""),[qe,ft]=v.useState(""),[W,de]=v.useState(!1),[Ie,Ve]=v.useState(0),ee=v.useRef(null),[L,se]=v.useState({}),[De,ue]=v.useState(!1),ze=v.useRef(null),[Le,it]=v.useState(null),[pt,Ye]=v.useState([]);v.useEffect(()=>{window.scrollTo(0,0)},[y]);const[Ht,Ms]=v.useState(null),dt=v.useCallback((we,G="info")=>{Ms({message:we,type:G}),setTimeout(()=>Ms(null),4e3)},[]),mt=v.useCallback(async we=>{if(!t)throw new Error("Not signed in");const G=we&&typeof we=="object"&&we.type;await la(Ot(pe,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:G?"":we,type:G?we.type:"text",imageURL:null,createdAt:br(),likeCount:0,commentCount:0,...G?{metadata:{title:we.title||"",subtitle:we.subtitle||"",stats:we.stats||[],quote:we.quote||"",badges:we.badges||[]}}:{}})},[t]),ne=v.useRef(null),Rt=()=>(ne.current||(ne.current=new(window.AudioContext||window.webkitAudioContext)),ne.current),Pt=()=>{try{const we=Rt(),G=we.createOscillator(),he=we.createGain();G.connect(he),he.connect(we.destination),G.frequency.value=1200,he.gain.value=.4,G.start(we.currentTime),G.stop(we.currentTime+.3)}catch{}};v.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),v.useEffect(()=>{if(!t)return;(async()=>{try{const G=He(pe,"clientProgrammes",t.id),he=await As(G);he.exists()&&F(he.data());const Ee=g.state?.templateId;if(Ee&&!B.current){const Oe=M2.find(ke=>ke.id===Ee);if(Oe){B.current=!0,T(Oe),x("overview");return}}he.exists()?x("dashboard"):p("/client/core-buddy/workouts",{replace:!0})}catch(G){console.error("Error loading programme:",G),p("/client/core-buddy/workouts",{replace:!0})}})()},[t]),v.useEffect(()=>{if(!W||Ie<=0){W&&Ie<=0&&(de(!1),Pt());return}return ee.current=setTimeout(()=>Ve(we=>we-1),1e3),()=>clearTimeout(ee.current)},[W,Ie]);const At=async we=>{if(t)try{await Ss(He(pe,"clientProgrammes",t.id),we),F(we)}catch(G){console.error("Error saving programme:",G),dt("Failed to save. Check Firestore rules for clientProgrammes.","error")}},vt=async we=>{const G={templateId:we.id,startDate:_t.now(),completedSessions:{}};await At(G),x("dashboard")},nt=async()=>{if(t)try{await Sr(He(pe,"clientProgrammes",t.id)),F(null),x("browse")}catch(we){console.error("Error quitting programme:",we)}},$e=()=>$?M2.find(we=>we.id===$.templateId):null,$t=()=>{if(!$?.startDate)return 1;const we=$.startDate.toDate?$.startDate.toDate():new Date($.startDate),he=new Date-we,Ee=Math.floor(he/(1e3*60*60*24));return Math.floor(Ee/7)+1},Ns=()=>{if(!$)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const we=$.completedSessions||{},G=Object.keys(we).length,he=$e();if(!he)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const Ee=he.duration*he.daysPerWeek,Oe=$t(),ke=Math.min(Oe,he.duration);let Qe=0;for(let Y=0;Y<he.daysPerWeek;Y++)we[`w${ke}d${Y}`]&&Qe++;if(G>=Ee)return{currentWeek:he.duration,completedThisWeek:he.daysPerWeek,nextDay:-1,totalCompleted:G,totalSessions:Ee,complete:!0};if(Oe>he.duration)return{currentWeek:he.duration,completedThisWeek:Qe,nextDay:-1,totalCompleted:G,totalSessions:Ee,complete:!0};let ot=-1;for(let Y=0;Y<he.daysPerWeek;Y++)if(!we[`w${ke}d${Y}`]){ot=Y;break}return{currentWeek:ke,completedThisWeek:Qe,nextDay:ot,nextWeek:ke,totalCompleted:G,totalSessions:Ee}},Ws=we=>{const G=$t();return we<G},Ut=(we,G,he)=>{if(!$||we<=1)return null;const Ee=`w${we-1}d${G}`,Oe=$.completedSessions?.[Ee];if(!Oe)return null;const ke=Oe.exercises?.find(Qe=>Qe.name===he);return ke?.sets?.length?ke.sets[ke.sets.length-1]:null},St=(we,G)=>{const he=$e();if(!he)return;ae(we),Ae(G),R(0),M(0),D([]),ft(""),de(!1),Ve(0),ue(!1),se({});const Ee=he.days[G],Oe=Ee.exercises.map(Y=>{const re=ch(Y,we,he);return{name:Y.name,type:Y.type,pbKey:Y.pbKey,targetSets:re.sets,targetReps:re.reps,targetTime:re.time,sets:[]}});D(Oe);const ke=Ee.exercises[0],Qe=Ut(we,G,ke.name);Qe?.weight&&ke.type==="weighted"?I(String(Qe.weight)):I(""),(async()=>{const Y={};for(const re of Ee.exercises)if(re.storagePath)try{const We=to(so,re.storagePath),Ge=await Ho(We);Y[re.name]={url:Ge,isGif:/\.gif$/i.test(re.storagePath)}}catch(We){console.warn(`Video not found for ${re.name}:`,We)}se(Y)})(),x("session")},is=async()=>{$e();const we=O[me];if(!we)return;let G={};if(we.type==="weighted"){const Oe=parseFloat(q)||0,ke=parseInt(qe)||0;if(ke===0){dt("Enter your reps","error");return}G={weight:Oe,reps:ke}}else if(we.type==="reps"){const Oe=parseInt(qe)||0;if(Oe===0){dt("Enter your reps","error");return}G={reps:Oe}}else if(we.type==="timed"){const Oe=we.targetTime-Ie;G={time:Math.max(Oe,1)}}const he=[...O];he[me]={...we,sets:[...we.sets,G]},D(he),we.type==="weighted"&&G.weight>0&&await Js(we.name,G.weight,G.reps);const Ee=we.sets.length+1;if(Ee<we.targetSets)M(Ee),I(G.weight?String(G.weight):""),ft(""),de(!1),Ve(0);else if(me+1<O.length){const Oe=me+1;R(Oe),M(0),ue(!1);const Qe=$e()?.days[ye]?.exercises[Oe],ot=Ut(K,ye,Qe?.name);ot?.weight&&Qe?.type==="weighted"?I(String(ot.weight)):I(""),ft(""),de(!1),Ve(0)}else await Is(he)},Is=async we=>{if(!$||!t)return;const G=`w${K}d${ye}`,he={...$.completedSessions,[G]:{completedAt:new Date().toISOString(),exercises:we.map(ke=>({name:ke.name,type:ke.type,sets:ke.sets}))}},Ee={...$,completedSessions:he};await At(Ee);const Oe=we.reduce((ke,Qe)=>ke+Qe.sets.reduce((ot,Y)=>ot+(Y.weight||0)*(Y.reps||0),0),0);Oe>0&&await zt(Oe);try{const ke=$e();await la(Ot(pe,"workoutLogs"),{clientId:t.id,type:"programme",programmeId:ke?.id,programmeName:ke?.name,week:K,day:ye+1,exerciseCount:we.length,duration:Math.round(we.reduce((Qe,ot)=>Qe+ot.sets.length*1.5,0)),volume:Math.round(Oe),completedAt:_t.now()})}catch(ke){console.error("Error saving workout log:",ke)}pt.length>0&&(it({badges:[...pt]}),Ye([])),te(!0)},zt=async we=>{if(t)try{const G=await As(He(pe,"coreBuddyAchievements",t.id)),he=G.exists()?G.data():{clientId:t.id,badges:[],totalVolume:0},Ee=he.totalVolume||0,Oe=Ee+we,ke=[];WD.forEach(ot=>{Oe>=ot.threshold&&Ee<ot.threshold&&(he.badges.some(re=>re.type==="volume_milestone"&&re.milestone===ot.threshold)||ke.push({type:"volume_milestone",milestone:ot.threshold,label:ot.label,achievedAt:_t.now()}))});const Qe=[...he.badges,...ke];await Ss(He(pe,"coreBuddyAchievements",t.id),{clientId:t.id,badges:Qe,totalVolume:Math.round(Oe),updatedAt:_t.now()}),ke.length>0&&Ye(ot=>[...ot,...ke])}catch(G){console.error("Error updating volume:",G)}},Js=async(we,G,he)=>{if(t)try{const Ee=t.id,Oe=await As(He(pe,"coreBuddyPBs",Ee)),Qe=(Oe.exists()?Oe.data():null)?.exercises||{},ot=Qe[we];let Y=!1;if(ot?(G>(ot.weight||0)||G===(ot.weight||0)&&he>(ot.reps||0))&&(Y=!0):Y=!0,Y){const re={...Qe,[we]:{weight:G,reps:he,achievedAt:_t.now()}};await Ss(He(pe,"coreBuddyPBs",Ee),{clientId:t.id,exercises:re,updatedAt:_t.now()}),dt(`New PB! ${G}kg  ${he} reps`,"success"),Pt(),await Lt(we,G)}}catch(Ee){console.error("Error checking PB:",Ee)}},Lt=async(we,G)=>{if(t)try{const he=await As(He(pe,"coreBuddyTargets",t.id));if(!he.exists())return;const Oe=(he.data().targets||{})[we];if(!Oe||G<Oe.targetWeight)return;const ke=await As(He(pe,"coreBuddyAchievements",t.id)),Qe=ke.exists()?ke.data():{clientId:t.id,badges:[],totalVolume:0};if(Qe.badges.some(We=>We.type==="pb_target"&&We.exercise===we&&We.targetWeight===Oe.targetWeight))return;const Y={type:"pb_target",exercise:we,group:$D[we]||"push",targetWeight:Oe.targetWeight,achievedAt:_t.now()},re=[...Qe.badges,Y];await Ss(He(pe,"coreBuddyAchievements",t.id),{...Qe,badges:re,updatedAt:_t.now()}),Ye(We=>[...We,Y])}catch(he){console.error("Error checking target badge:",he)}},ps=Ht&&r.jsxs("div",{className:`toast-notification ${Ht.type}`,children:[Ht.type==="success"&&r.jsx("span",{children:" "}),Ht.message]}),Wt=(we,G)=>r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:G,"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})});if(i||y==="loading")return r.jsx("div",{className:"cb-loading",children:r.jsx("div",{className:"cb-loading-spinner"})});if(y==="browse")return p("/client/core-buddy/workouts",{replace:!0}),null;if(y==="overview"&&j){const we=j;return r.jsx(Ta,{children:r.jsxs("div",{className:"pg-page","data-theme":l?"dark":"light","data-accent":d,children:[Wt(we.name,()=>p("/client/core-buddy/workouts")),r.jsxs("main",{className:"pg-main",children:[r.jsxs("div",{className:"pg-overview-hero",children:[r.jsx("svg",{className:"pg-overview-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:GD[we.focus]})}),r.jsx("h2",{className:"pg-overview-name",children:we.name}),r.jsx("p",{className:"pg-overview-desc",children:we.description}),r.jsxs("div",{className:"pg-overview-stats",children:[r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:we.duration}),r.jsx("span",{className:"pg-ov-stat-label",children:"Weeks"})]}),r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:we.daysPerWeek}),r.jsx("span",{className:"pg-ov-stat-label",children:"Days/Week"})]}),r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:we.duration*we.daysPerWeek}),r.jsx("span",{className:"pg-ov-stat-label",children:"Sessions"})]})]})]}),r.jsx("div",{className:"pg-overview-days",children:we.days.map((G,he)=>r.jsxs("div",{className:"pg-day-card",children:[r.jsxs("div",{className:"pg-day-header",children:[r.jsx("span",{className:"pg-day-name",children:G.name}),r.jsx("span",{className:"pg-day-label",children:G.label})]}),r.jsx("div",{className:"pg-day-exercises",children:G.exercises.map((Ee,Oe)=>{const ke=ch(Ee,1,we);return r.jsxs("div",{className:"pg-day-ex",children:[r.jsx("span",{className:"pg-day-ex-name",children:Ee.name}),r.jsx("span",{className:"pg-day-ex-target",children:Ee.type==="timed"?`${ke.sets}${ke.time}s`:`${ke.sets}${ke.reps}`}),r.jsx("span",{className:`pg-day-ex-badge pg-badge-${Ee.type}`,children:Ee.type==="weighted"?"WT":Ee.type==="timed"?"TMR":"BW"})]},Oe)})})]},he))}),r.jsxs("div",{className:"pg-overview-note",children:[r.jsx("strong",{children:"Progressive Overload:"})," +",we.repProg," reps/week",we.timeProg?`, +${we.timeProg}s/week for timed`:""]}),r.jsx("button",{className:"pg-start-btn",onClick:()=>vt(we),children:"Start Programme"})]}),ps]})})}if(y==="dashboard"){const we=$e();if(!we)return x("browse"),null;const G=Ns(),he=$?.completedSessions||{},Ee=G.totalSessions?Math.round(G.totalCompleted/G.totalSessions*100):0;return Math.round(G.totalCompleted/(G.totalSessions||1)*HD),r.jsx(Ta,{children:r.jsxs("div",{className:"pg-page","data-theme":l?"dark":"light","data-accent":d,children:[Wt("Programme",()=>p("/client/core-buddy/workouts")),r.jsxs("main",{className:"pg-main",children:[r.jsxs("div",{className:"pg-dash-hero",children:[r.jsxs("div",{className:"pg-dash-ring-wrap",children:[r.jsxs("svg",{viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"pg-arc-track",cx:"100",cy:"100",r:"80"}),r.jsx("circle",{className:"pg-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-Ee/100*2*Math.PI*80})]}),r.jsxs("div",{className:"pg-ring-center",children:[r.jsxs("span",{className:"pg-ring-pct",children:[Ee,"%"]}),r.jsx("span",{className:"pg-ring-label",children:"complete"})]})]}),r.jsx("h2",{className:"pg-dash-name",children:we.name}),r.jsxs("div",{className:"pg-dash-progress-text",children:[r.jsxs("span",{className:"pg-dash-pct",children:[Ee,"%"]}),r.jsxs("span",{className:"pg-dash-week",children:["Week ",G.currentWeek," of ",we.duration]})]})]}),r.jsx("div",{className:"pg-weeks",children:Array.from({length:we.duration},(Oe,ke)=>{const Qe=ke+1,ot=Ws(Qe);return r.jsxs("div",{className:`pg-week-row${Qe===G.currentWeek?" pg-week-current":""}`,children:[r.jsxs("span",{className:"pg-week-label",children:["W",Qe]}),r.jsx("div",{className:"pg-week-days",children:we.days.map((Y,re)=>{const We=`w${Qe}d${re}`,Ge=!!he[We],rt=!Ge&&ot,bt=!Ge&&!rt&&Qe===G.currentWeek&&!G.complete;return r.jsx("button",{className:`pg-day-dot${Ge?" done":""}${rt?" missed":""}${bt?" next":""}`,disabled:!bt,onClick:()=>{bt&&St(Qe,re)},children:Ge?r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M20 6L9 17l-5-5"})}):rt?r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsx("span",{children:Y.name.replace("Day ","")})},re)})})]},ke)})}),!G.complete&&(()=>{const Oe=we.days.map((ke,Qe)=>({day:ke,d:Qe})).filter(({d:ke})=>!he[`w${G.currentWeek}d${ke}`]);return Oe.length===0?null:r.jsxs("div",{className:"pg-next-session",children:[r.jsx("h3",{children:Oe.length===we.daysPerWeek?"Choose a Session":"Remaining Sessions"}),r.jsxs("p",{className:"pg-next-info",children:["Week ",G.currentWeek,"  ",Oe.length," session",Oe.length!==1?"s":""," left this week"]}),Oe.map(({day:ke,d:Qe})=>r.jsxs("div",{className:"pg-available-session",children:[r.jsxs("div",{className:"pg-next-exercises",children:[r.jsxs("span",{className:"pg-avail-day-label",children:[ke.name,": ",ke.label]}),ke.exercises.map((ot,Y)=>{const re=ch(ot,G.currentWeek,we);return r.jsxs("div",{className:"pg-next-ex",children:[r.jsx("span",{className:"pg-next-ex-name",children:ot.name}),r.jsx("span",{className:"pg-next-ex-target",children:ot.type==="timed"?`${re.sets}${re.time}s`:`${re.sets}${re.reps}`})]},Y)})]}),r.jsxs("button",{className:"pg-start-btn",onClick:()=>St(G.currentWeek,Qe),children:["Start ",ke.name]})]},Qe))]})})(),G.complete&&r.jsxs("div",{className:"pg-complete-msg",children:[r.jsx("h3",{children:"Programme Complete! "}),r.jsxs("p",{children:["You finished all ",G.totalSessions," sessions."]}),r.jsx("button",{className:"pg-start-btn",onClick:nt,children:"Choose New Programme"})]}),r.jsx("button",{className:"pg-quit-btn",onClick:()=>{confirm("Quit this programme? Progress will be lost.")&&nt()},children:"Quit Programme"})]}),r.jsx(ua,{active:"workouts"}),ps]})})}if(y==="session"){const we=$e();if(!we)return null;const G=we.days[ye],he=G.exercises[me],Ee=ch(he,K,we),Oe=O[me],ke=Oe?.sets?.length||0,Qe=G.exercises.length,ot=(me+ke/Ee.sets)/Qe,Y=L[he.name],re=Ut(K,ye,he.name);he.type==="timed"&&Ie===0&&!W&&ke===E&&setTimeout(()=>Ve(Ee.time),0);const We=()=>{Y?.isGif?ue(!De):ze.current&&(De?ze.current.pause():ze.current.play(),ue(!De))};return r.jsxs("div",{className:"pg-page pg-page-session","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("div",{className:"pg-session-progress",children:r.jsx("div",{className:"pg-session-progress-fill",style:{width:`${ot*100}%`}})}),r.jsxs("div",{className:"pg-session-header",children:[r.jsx("button",{className:"pg-session-back",onClick:()=>{confirm("Leave session? Progress will be lost.")&&x("dashboard")},children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M19 12H5M12 5l-7 7 7 7"})})}),r.jsxs("div",{className:"pg-session-title",children:[r.jsxs("span",{className:"pg-session-counter",children:[me+1," / ",Qe]}),r.jsxs("span",{className:"pg-session-week",children:["Week ",K,"  ",G.name]})]})]}),Y&&r.jsxs("div",{className:"pg-video-container",onClick:We,children:[Y.isGif?r.jsx("img",{className:"pg-video",src:Y.url,alt:he.name}):r.jsx("video",{ref:ze,className:"pg-video",src:Y.url,loop:!0,muted:!0,playsInline:!0},he.name),!De&&r.jsxs("div",{className:"pg-video-overlay",children:[r.jsx("svg",{className:"pg-play-icon",viewBox:"0 0 24 24",fill:"white",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),r.jsx("span",{className:"pg-video-hint",children:"Tap for demo"})]})]}),r.jsx("div",{className:"pg-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"pg-exercise-card",children:[r.jsx("h2",{className:"pg-ex-name",children:he.name}),r.jsx("span",{className:`pg-ex-type-badge pg-badge-${he.type}`,children:he.type==="weighted"?"Weight + Reps":he.type==="timed"?"Timed":"Reps Only"}),he.type==="weighted"&&re&&r.jsxs("div",{className:"pg-last-week",children:[r.jsx("span",{className:"pg-last-week-label",children:"Last week:"}),r.jsxs("span",{className:"pg-last-week-value",children:[re.weight,"kg x ",re.reps," reps"]})]}),r.jsxs("div",{className:"pg-ex-set-info",children:[r.jsxs("span",{className:"pg-ex-set-num",children:["Set ",ke+1," of ",Ee.sets]}),r.jsxs("span",{className:"pg-ex-target",children:["Target: ",he.type==="timed"?`${Ee.time}s hold`:`${Ee.reps} reps`]})]}),he.type==="weighted"&&r.jsxs("div",{className:"pg-input-area",children:[r.jsxs("div",{className:"pg-input-group",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",value:q,onChange:Ge=>I(Ge.target.value),placeholder:"0",className:"pg-input"})]}),r.jsxs("div",{className:"pg-input-group",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",value:qe,onChange:Ge=>ft(Ge.target.value),placeholder:String(Ee.reps),className:"pg-input"})]})]}),he.type==="reps"&&r.jsx("div",{className:"pg-input-area",children:r.jsxs("div",{className:"pg-input-group pg-input-single",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",value:qe,onChange:Ge=>ft(Ge.target.value),placeholder:String(Ee.reps),className:"pg-input"})]})}),he.type==="timed"&&r.jsxs("div",{className:"pg-timer-area",children:[r.jsx("div",{className:"pg-timer-display",children:r.jsxs("span",{className:"pg-timer-value",children:[Ie,"s"]})}),W?r.jsx("button",{className:"pg-timer-btn pg-timer-stop",onClick:()=>de(!1),children:"Stop"}):r.jsx("button",{className:"pg-timer-btn",onClick:()=>{Ie===0&&Ve(Ee.time),de(!0)},children:Ie<Ee.time&&Ie>0?"Resume":"Start Timer"})]}),r.jsx("button",{className:"pg-log-set-btn",onClick:is,disabled:he.type==="timed"&&W,children:ke+1<Ee.sets?"Log Set":me+1<Qe?"Log Set  Next Exercise":"Log Set  Complete"}),Oe?.sets?.length>0&&r.jsx("div",{className:"pg-completed-sets",children:Oe.sets.map((Ge,rt)=>r.jsxs("div",{className:"pg-completed-set",children:[r.jsx("span",{className:"pg-completed-set-check",children:""}),r.jsxs("span",{children:["Set ",rt+1,": ",Ge.weight!==void 0?`${Ge.weight}kg  ${Ge.reps}`:Ge.time!==void 0?`${Ge.time}s`:`${Ge.reps} reps`]})]},rt))})]}),V&&(()=>{const rt=$e()?.days[ye],bt=O.reduce((Gt,Gs)=>Gt+Gs.sets.length,0),jt=O.reduce((Gt,Gs)=>Gt+Gs.sets.reduce((os,ks)=>os+(ks.weight||0)*(ks.reps||0),0),0),gt=[{value:O.length,label:"Exercises"},{value:bt,label:"Sets"}];return jt>0&&gt.push({value:Math.round(jt).toLocaleString(),label:"Volume (kg)"}),r.jsx(Qh,{title:"Session Complete!",subtitle:`Week ${K}  ${rt?.name}: ${rt?.label}`,stats:gt,buttonLabel:"Back to Programme",onShareJourney:t?mt:null,userName:t?.name,onDismissStart:()=>x("dashboard"),onDone:()=>{te(!1)}})})(),Le&&r.jsx("div",{className:"pg-badge-celebration",onClick:()=>it(null),children:r.jsxs("div",{className:"pg-badge-celebration-card",onClick:Ge=>Ge.stopPropagation(),children:[r.jsx("div",{className:"pg-badge-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pg-badge-celebration-title",children:Le.badges.length===1?"Badge Earned!":`${Le.badges.length} Badges Earned!`}),r.jsx("div",{className:"pg-badge-celebration-list",children:Le.badges.map((Ge,rt)=>r.jsx("div",{className:"pg-badge-celebration-item",children:Ge.type==="pb_target"?`${Ge.exercise}  ${Ge.targetWeight}kg`:Ge.label},rt))}),r.jsxs("div",{className:"pg-badge-share-row",children:[r.jsxs("button",{className:"pg-badge-share-btn",onClick:async Ge=>{Ge.stopPropagation();const rt=Le.badges[0],bt=Le.badges.map(gt=>gt.type==="pb_target"?`PB Target Hit: ${gt.exercise}  ${gt.targetWeight}kg`:gt.label),jt=Hn.find(gt=>gt.id===rt?.id)||Hn.find(gt=>gt.name===rt?.label);await mt({type:"badge_earned",title:bt.length===1?bt[0]:`${bt.length} Badges Earned!`,badges:bt,badgeDesc:jt?.desc}),dt("Posted to Journey!","success")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20h9"}),r.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4Z"})]}),"Journey"]}),r.jsxs("button",{className:"pg-badge-share-btn",onClick:async Ge=>{Ge.stopPropagation();const rt=Le.badges[0],bt=Le.badges.map(Gt=>Gt.type==="pb_target"?`PB Target Hit: ${Gt.exercise}  ${Gt.targetWeight}kg`:Gt.label),jt=Hn.find(Gt=>Gt.id===rt?.id)||Hn.find(Gt=>Gt.name===rt?.label),gt=`Badge Earned! ${bt.join(", ")}
#MindCoreFitness`;try{const Gt=await sb({type:"badge",title:bt.length===1?bt[0]:"Badges Earned!",badges:bt,badgeImage:jt?.img,badgeDesc:jt?.desc});navigator.share&&navigator.canShare?.({files:[new File([Gt],"badge.png",{type:"image/png"})]})?await navigator.share({title:"Mind Core Fitness",text:gt,files:[new File([Gt],"badge.png",{type:"image/png"})]}):navigator.share?await navigator.share({title:"Mind Core Fitness",text:gt}):(await navigator.clipboard.writeText(gt),dt("Copied!","success"))}catch{try{await navigator.clipboard.writeText(gt),dt("Copied!","success")}catch{}}},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"18",cy:"5",r:"3"}),r.jsx("circle",{cx:"6",cy:"12",r:"3"}),r.jsx("circle",{cx:"18",cy:"19",r:"3"}),r.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),r.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),"Share"]})]}),r.jsx("button",{className:"pg-badge-celebration-dismiss",onClick:()=>it(null),children:"Tap to dismiss"})]})}),ps]})}return null}const YD={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},QD={push:{label:"Push",color:"#c75f6b",icon:"M4 12h3l3-9 4 18 3-9h3"},pull:{label:"Pull",color:"#5f8ac7",icon:"M12 2v10m0 0l-4-4m4 4l4-4M4 20h16"},lower:{label:"Lower",color:"#5fc77a",icon:"M12 2v8m-4 4l4 8 4-8m-8 0h8"},core:{label:"Core",color:"#c7a45f",icon:"M12 2a4 4 0 014 4v1h-2V6a2 2 0 10-4 0v1H8V6a4 4 0 014-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"}},Jp=[{threshold:1e3,label:"1 Tonne",icon:"1T"},{threshold:5e3,label:"5 Tonne",icon:"5T"},{threshold:1e4,label:"10 Tonne",icon:"10T"},{threshold:25e3,label:"25 Tonne",icon:"25T"},{threshold:5e4,label:"50 Tonne",icon:"50T"},{threshold:1e5,label:"100 Tonne",icon:"100T"},{threshold:25e4,label:"250 Tonne",icon:"250T"},{threshold:5e5,label:"500 Tonne",icon:"500T"},{threshold:1e6,label:"1 Million kg",icon:"1M"}];function XD(n){return YD[n]||"push"}function JD(n){return n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}T`:`${Math.round(n)}`}function ZD(n){return n>=1e6?"million kg":n>=1e3?"tonnes":"kg"}function eP(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Ur(),{isDark:l,toggleTheme:u,accent:d}=Na(),p=er(),[g,y]=v.useState(!0),[x,j]=v.useState(null),[T,B]=v.useState({}),[$,F]=v.useState([]),[V,te]=v.useState(null),[K,ae]=v.useState(0),[ye,Ae]=v.useState({});v.useRef(null),v.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),v.useEffect(()=>{if(!t)return;(async()=>{try{const[de,Ie,Ve,ee]=await Promise.all([As(He(pe,"coreBuddyAchievements",t.id)),As(He(pe,"coreBuddyPBs",t.id)),As(He(pe,"achievements",t.id)),Es(Os(Ot(pe,"workoutLogs"),fs("clientId","==",t.id)))]);de.exists()&&j(de.data()),Ie.exists()&&B(Ie.data().exercises||{}),Ve.exists()&&(F(Object.keys(Ve.data().badges||{})),Ae(Ve.data().progress||{})),ae(ee.docs.length)}catch(de){console.error("Error loading achievements:",de)}y(!1)})()},[t]);const me=x?.badges||[],R=x?.totalVolume||0,E=me.filter(W=>W.type==="pb_target"),M=me.filter(W=>W.type==="volume_milestone"),O={push:[],pull:[],lower:[],core:[]};E.forEach(W=>{const de=W.group||XD(W.exercise);O[de]&&O[de].push(W)});const D=Jp.find(W=>R<W.threshold),q=Jp.filter(W=>R>=W.threshold).pop()?.threshold||0,I=D?(R-q)/(D.threshold-q):1;if(i||g)return r.jsxs("div",{className:"ach-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsx("div",{className:"ach-loading-inline",children:r.jsx("div",{className:"cb-loading-spinner"})})]});const qe=me.length+$.length,ft=qe>0||R>0||K>0;return r.jsx(Ta,{children:r.jsxs("div",{className:"ach-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"ach-main",children:[r.jsx("button",{className:"nut-back-btn",onClick:()=>p("/client/personal-bests?mode=corebuddy"),children:" Back"}),r.jsxs("div",{className:"ach-stats-banner",children:[r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:qe}),r.jsx("span",{className:"ach-stat-label",children:qe===1?"Badge":"Badges"})]}),r.jsx("div",{className:"ach-stat-divider"}),r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:JD(R)}),r.jsxs("span",{className:"ach-stat-label",children:[ZD(R)," lifted"]})]}),r.jsx("div",{className:"ach-stat-divider"}),r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:Object.keys(T).length}),r.jsx("span",{className:"ach-stat-label",children:"PBs"})]})]}),!ft&&r.jsxs("div",{className:"ach-empty",children:[r.jsx("div",{className:"ach-empty-icon",children:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[r.jsx("path",{d:"M12 15l-3-3h6l-3 3z"}),r.jsx("path",{d:"M5 7h14l-1.5 9h-11L5 7z"}),r.jsx("path",{d:"M8.5 7V5a3.5 3.5 0 017 0v2"})]})}),r.jsx("h4",{children:"No achievements yet"}),r.jsx("p",{children:"Complete workouts to track volume and set PB targets to start earning badges."})]}),[{key:"workouts",title:"Workout Badges",iconPath:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"},{key:"streaks",title:"Streak Badges",iconPath:"M13.5.67s.74 2.65.74 4.8c0 2.06-1.35 3.73-3.41 3.73-2.07 0-3.63-1.67-3.63-3.73l.03-.36C5.21 7.51 4 10.62 4 14c0 4.42 3.58 8 8 8s8-3.58 8-8C20 8.61 17.41 3.8 13.5.67z"},{key:"pbs",title:"Personal Best Badges",iconPath:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"},{key:"nutrition",title:"Nutrition Badges",iconPath:"M18.06 23h1.66c.84 0 1.53-.65 1.63-1.47L23 5.05h-5V1h-2v4.05h-5l.3 2.34c1.71.47 3.31 1.32 4.27 2.26 1.44 1.42 2.43 2.89 2.43 5.29V23zM1 22v-1h15.03v1c0 .55-.45 1-1.01 1H2.01c-.56 0-1.01-.45-1.01-1zm15.03-7c0-4.87-4.66-5.84-8.03-5.97l.72 5.52L1 15.05v5.95h15.03V15z"},{key:"habits",title:"Habit Badges",iconPath:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"},{key:"leaderboard",title:"Leaderboard Badges",iconPath:"M7.5 21H2V9h5.5v12zm7.25-18h-5.5v18h5.5V3zM22 11h-5.5v10H22V11z"}].map(W=>{const de=Hn.filter(ee=>ee.category===W.key);if(de.length===0)return null;const Ie=(()=>{switch(W.key){case"workouts":return K;case"streaks":return ye.streakWeeks||0;case"pbs":return Object.keys(T).length;case"nutrition":return ye.nutritionStreak||0;case"leaderboard":return t?.leaderboardOptIn?1:0;case"habits":return ye.habitStreak||0;default:return 0}})(),Ve=de.filter(ee=>$.includes(ee.id)).length;return r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:W.iconPath})}),W.title]}),r.jsx("div",{className:"ach-workout-carousel",children:de.map(ee=>{const L=$.includes(ee.id);return r.jsxs("button",{className:`ach-workout-badge${L?" unlocked":" locked"}`,onClick:()=>te(ee),children:[r.jsx("img",{src:ee.img,alt:ee.name,className:"ach-workout-badge-img"}),!L&&ee.threshold&&r.jsx("div",{className:"ach-workout-badge-progress",children:r.jsx("div",{className:"ach-workout-badge-progress-fill",style:{width:`${Math.min(Ie/ee.threshold*100,100)}%`}})})]},ee.id)})}),r.jsxs("p",{className:"ach-workout-badges-count",children:[Ve,"/",de.length," unlocked"]})]},W.key)}),V&&r.jsx("div",{className:"ach-badge-overlay",onClick:()=>te(null),children:r.jsxs("div",{className:"ach-badge-overlay-content",onClick:W=>W.stopPropagation(),children:[r.jsx("img",{src:V.img,alt:V.name,className:`ach-badge-overlay-img${$.includes(V.id)?"":" ach-badge-overlay-img-locked"}`}),r.jsx("p",{className:"ach-badge-overlay-desc",children:V.desc}),$.includes(V.id)?r.jsx("span",{className:"ach-badge-overlay-status unlocked",children:"Unlocked"}):r.jsx("span",{className:"ach-badge-overlay-status locked",children:"Locked"}),r.jsx("button",{className:"ach-badge-overlay-close",onClick:()=>te(null),children:"Tap to close"})]})}),r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})}),"Volume Milestones"]}),r.jsxs("div",{className:"ach-volume-hero",children:[r.jsxs("div",{className:"ach-volume-ring",children:[r.jsx("svg",{className:"ach-volume-ring-svg",viewBox:"0 0 200 200",children:Hk.map((W,de)=>{const Ie=de<Math.round(I*60);return r.jsx("line",{x1:W.x1,y1:W.y1,x2:W.x2,y2:W.y2,className:Ie?"ach-tick-filled":"ach-tick-empty",strokeWidth:W.thick?"3":"2"},de)})}),r.jsxs("div",{className:"ach-volume-center",children:[r.jsx("span",{className:"ach-volume-number",children:Math.round(R).toLocaleString()}),r.jsx("span",{className:"ach-volume-unit",children:"kg lifted"})]})]}),D&&r.jsxs("div",{className:"ach-volume-next",children:["Next: ",r.jsx("strong",{children:D.label})," (",(D.threshold-R).toLocaleString(),"kg to go)"]})]}),r.jsx("div",{className:"ach-milestone-shelf",children:Jp.map((W,de)=>{const Ie=R>=W.threshold,Ve=M.find(ee=>ee.milestone===W.threshold);return r.jsxs("div",{className:`ach-milestone ${Ie?"unlocked":"locked"}`,children:[r.jsx("div",{className:"ach-milestone-hex",children:r.jsx("span",{className:"ach-milestone-icon",children:W.icon})}),r.jsx("span",{className:"ach-milestone-label",children:W.label}),Ve?.achievedAt&&r.jsx("span",{className:"ach-milestone-date",children:(Ve.achievedAt.toDate?Ve.achievedAt.toDate():new Date(Ve.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short"})})]},de)})})]}),r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"PB Target Badges"]}),E.length===0?r.jsx("div",{className:"ach-pb-empty",children:r.jsxs("p",{children:["Set targets on your personal bests to start earning badges. Go to ",r.jsx("strong",{children:"My Progress"}),' and tap "Set Target" on any PB.']})}):Object.entries(O).map(([W,de])=>{if(de.length===0)return null;const Ie=QD[W];return r.jsxs("div",{className:"ach-group",children:[r.jsxs("div",{className:"ach-group-header",style:{borderLeftColor:Ie.color},children:[r.jsx("span",{className:"ach-group-label",style:{color:Ie.color},children:Ie.label}),r.jsx("span",{className:"ach-group-count",children:de.length})]}),r.jsx("div",{className:"ach-badge-grid",children:de.map((Ve,ee)=>r.jsxs("div",{className:"ach-badge-card",style:{animationDelay:`${ee*.06}s`,"--group-color":Ie.color},children:[r.jsx("div",{className:"ach-badge-hex",style:{borderColor:Ie.color,boxShadow:`0 0 12px ${Ie.color}33`},children:r.jsx("svg",{className:"ach-badge-hex-icon",viewBox:"0 0 24 24",fill:"none",stroke:Ie.color,strokeWidth:"2",strokeLinecap:"round",children:r.jsx("path",{d:Ie.icon})})}),r.jsxs("div",{className:"ach-badge-info",children:[r.jsx("span",{className:"ach-badge-exercise",children:Ve.exercise}),r.jsxs("span",{className:"ach-badge-value",style:{color:Ie.color},children:[Ve.targetWeight,"kg"]}),Ve.achievedAt&&r.jsx("span",{className:"ach-badge-date",children:(Ve.achievedAt.toDate?Ve.achievedAt.toDate():new Date(Ve.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})})]})]},ee))})]},W)})]})]}),r.jsx(ua,{active:"home"})]})})}const tP=[{key:"trained",label:"Trained",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4",color:"#A12F3A"},{key:"protein",label:"Hit Protein",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z",color:"#4caf50"},{key:"steps",label:"10k Steps",icon:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20M4 12.5A2.5 2.5 0 0 1 6.5 10H20M4 5.5A2.5 2.5 0 0 1 6.5 3H20",color:"#ff9800"},{key:"sleep",label:"8hrs Sleep",icon:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z",color:"#7c3aed"},{key:"water",label:"2L Water",icon:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z",color:"#2196f3"}],sP="M12 2l2.4 7.2L22 12l-7.6 2.8L12 22l-2.4-7.2L2 12l7.6-2.8z",nP="#e91e63",rP=700,Pg=42,Ol=2*Math.PI*Pg,uh=["Every day counts. See you tomorrow!","Consistency is your superpower.","Perfect day  keep the streak alive!","You showed up for yourself today."];function aP(n){const e=new Date(n),t=e.getDay(),i=t===0?-6:1-t;return e.setDate(e.getDate()+i),e.setHours(0,0,0,0),e}function Zp(n){return n.toISOString().split("T")[0]}function iP(n){return Array.from({length:7},(e,t)=>{const i=new Date(n);return i.setDate(n.getDate()+t),i})}function oP(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Ur(),{isDark:l,toggleTheme:u,accent:d}=Na(),p=er(),[g,y]=v.useState({}),[x,j]=v.useState([]),[T,B]=v.useState(!0),[$,F]=v.useState(!1),[V,te]=v.useState(0),[K,ae]=v.useState(null),[ye,Ae]=v.useState(null),[me,R]=v.useState(!1),[E,M]=v.useState(!1),[O,D]=v.useState(!1),[q,I]=v.useState(!1),[qe,ft]=v.useState(""),[W,de]=v.useState(null),[Ie,Ve]=v.useState([]),[ee,L]=v.useState(null),se=v.useRef(null),De=v.useRef(null),ue=v.useRef(null),ze=v.useRef(null),Le=v.useRef(!1),it=v.useRef({}),pt=v.useRef([]),Ye=v.useRef([]),Ht=v.useRef(null),Ms=v.useRef(uh[Math.floor(Math.random()*uh.length)]),dt=v.useCallback((G,he="info")=>{ae({message:G,type:he}),setTimeout(()=>ae(null),3e3)},[]),mt=new Date,ne=Zp(mt),Rt=aP(mt),Pt=iP(Rt),At=["M","T","W","T","F","S","S"],vt=[...tP.filter(G=>!Ie.includes(G.key)),...x.map(G=>({key:`custom_${G.id}`,label:G.label,icon:sP,color:nP,isCustom:!0,id:G.id}))];v.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),v.useEffect(()=>{if(!n||!t)return;(async()=>{try{const he=Ot(pe,"habitLogs"),Ee=Os(he,fs("clientId","==",t.id)),Oe=await Es(Ee),ke={};Oe.docs.forEach(re=>{const We=re.data();ke[We.date]={...We,_id:re.id}}),y(ke);const Qe=await As(He(pe,"customHabits",t.id));if(Qe.exists()){const re=Qe.data();j(re.habits||[]),Ve(re.hiddenDefaults||[])}let ot=0;const Y=new Date(mt);for(;;){const re=Zp(Y),We=ke[re];if(We)if(Object.values(We.habits||{}).filter(Boolean).length>=3)ot++,Y.setDate(Y.getDate()-1);else break;else if(re===ne)Y.setDate(Y.getDate()-1);else break}te(ot)}catch(he){console.error("Error loading habit logs:",he)}finally{B(!1)}})()},[n,t]);const nt=g[ne]||{habits:{}};v.useEffect(()=>{Object.values(nt.habits||{}).filter(Boolean).length<vt.length&&O&&D(!1)},[vt.length,nt.habits]);const $e=async G=>{if(!(!n||$||nt.habits?.[G])){pt.current=[...Array(10)].map((Ee,Oe)=>{const ke=Oe/10*2*Math.PI,Qe=18+Math.random()*20;return{tx:Math.cos(ke)*Qe,ty:Math.sin(ke)*Qe,size:3+Math.random()*4,duration:.4+Math.random()*.3}}),Ae(G),setTimeout(()=>Ae(null),700),navigator.vibrate&&navigator.vibrate(50),F(!0);try{const Oe={...nt.habits||{},[G]:!0},ke=nt._id||`${t.id}_${ne}`;y(ot=>({...ot,[ne]:{clientId:t.id,date:ne,habits:Oe,_id:ke}})),await Ss(He(pe,"habitLogs",ke),{clientId:t.id,date:ne,habits:Oe}),Object.values(Oe).filter(Boolean).length===vt.length&&!O&&(Ms.current=uh[Math.floor(Math.random()*uh.length)],Ye.current=[...Array(80)].map((ot,Y)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#4caf50","#ff9800","#2196f3","#e91e63","#ffeb3b","#FFD700","#ffffff","#9c27b0"][Y%9],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:Y%3})),setTimeout(()=>{R(!0),D(!0),setTimeout(()=>Ht.current?.focus(),1100)},400))}catch(Ee){console.error("Error saving habit:",Ee),dt("Failed to save. Try again.","error"),y(Oe=>({...Oe,[ne]:{...Oe[ne],habits:{...Oe[ne]?.habits||{},[G]:!1}}}))}finally{F(!1)}}},$t=async G=>{if(!(!n||$)){F(!0);try{const Ee={...nt.habits||{},[G]:!1},Oe=nt._id||`${t.id}_${ne}`;await Ss(He(pe,"habitLogs",Oe),{clientId:t.id,date:ne,habits:Ee}),y(ke=>({...ke,[ne]:{clientId:t.id,date:ne,habits:Ee,_id:Oe}}))}catch(he){console.error("Error undoing habit:",he),dt("Failed to undo. Try again.","error")}finally{F(!1)}}},Ns=G=>{if(nt.habits?.[G]||!1||$||ze.current)return;ze.current=G,L(G),De.current=performance.now();const Ee=it.current[G];Ee&&(Ee.style.strokeDashoffset=Ol);const Oe=ke=>{const Qe=ke-De.current,ot=Math.min(Qe/rP,1),Y=it.current[G];Y&&(Y.style.strokeDashoffset=Ol-ot*Ol),ot<1?ue.current=requestAnimationFrame(Oe):(ze.current=null,Le.current=!0,ue.current=null,L(null),$e(G))};ue.current=requestAnimationFrame(Oe)},Ws=()=>{if(!ze.current)return;const G=ze.current;ze.current=null,ue.current&&(cancelAnimationFrame(ue.current),ue.current=null),se.current&&(clearTimeout(se.current),se.current=null),it.current[G]&&(it.current[G].style.strokeDashoffset=Ol),L(null),De.current=null};v.useEffect(()=>()=>{ue.current&&cancelAnimationFrame(ue.current),se.current&&clearTimeout(se.current)},[]);const Ut=v.useCallback(async G=>{if(!t)throw new Error("Not signed in");const he=G&&typeof G=="object"&&G.type;await la(Ot(pe,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:he?"":G,type:he?G.type:"text",imageURL:null,createdAt:br(),likeCount:0,commentCount:0,...he?{metadata:{title:G.title||"",subtitle:G.subtitle||"",stats:G.stats||[],quote:G.quote||"",badges:G.badges||[]}}:{}})},[t]),St=async()=>{const G=qe.trim();if(!G)return;if(!t?.id){dt("Still loading, try again","error");return}const he=Date.now().toString(36),Ee=[...x,{id:he,label:G}];try{await Ss(He(pe,"customHabits",t.id),{clientId:t.id,habits:Ee,hiddenDefaults:Ie},{merge:!0}),j(Ee),ft(""),I(!1),dt(`Added "${G}"`,"success")}catch(Oe){console.error("Error adding custom habit:",Oe),dt(Oe?.code==="permission-denied"?"Permission denied  check Firestore rules for customHabits":`Failed to add habit: ${Oe?.message||"Unknown error"}`,"error")}},is=async G=>{if(!t?.id)return;const he=x.filter(Ee=>Ee.id!==G);try{await Ss(He(pe,"customHabits",t.id),{clientId:t.id,habits:he,hiddenDefaults:Ie},{merge:!0}),j(he),de(null),dt("Habit removed","success")}catch(Ee){console.error("Error deleting habit:",Ee),dt("Failed to remove","error")}},Is=async G=>{if(!t?.id)return;const he=[...Ie,G];try{await Ss(He(pe,"customHabits",t.id),{clientId:t.id,habits:x,hiddenDefaults:he},{merge:!0}),Ve(he),de(null),dt("Habit removed","success")}catch(Ee){console.error("Error hiding default habit:",Ee),dt("Failed to remove","error")}},zt=Pt.map(G=>{const he=Zp(G),Ee=g[he],Oe=Ee?Object.values(Ee.habits||{}).filter(Boolean).length:0;return{date:G,dateStr:he,completed:Oe,total:vt.length}}),Js=zt.reduce((G,he)=>G+he.completed,0),Lt=zt.reduce((G,he)=>G+he.total,0),ps=Lt>0?Math.round(Js/Lt*100):0,Wt=Object.values(nt.habits||{}).filter(Boolean).length,we=vt.length>0?Math.round(Wt/vt.length*100):0;return r.jsx(Ta,{children:r.jsxs("div",{className:"cbc-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),i||T?r.jsx("div",{className:"cbc-loading-inline",children:r.jsx("div",{className:"cbc-loading-spinner"})}):r.jsxs("main",{className:"cbc-main",children:[r.jsxs("div",{className:"cbc-ring-section anim-fade-up",children:[r.jsxs("div",{className:"cbc-progress-ring",children:[r.jsxs("svg",{viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"cbc-arc-track",cx:"100",cy:"100",r:"80"}),r.jsx("circle",{className:"cbc-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-we/100*2*Math.PI*80})]}),r.jsxs("div",{className:"cbc-ring-center",children:[r.jsxs("span",{className:"cbc-ring-pct",children:[we,"%"]}),r.jsx("span",{className:"cbc-ring-label",children:"today"})]})]}),r.jsxs("div",{className:"cbc-streak",children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-primary)",strokeWidth:"2",children:r.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),r.jsx("span",{className:"cbc-streak-count",children:V}),r.jsx("span",{className:"cbc-streak-label",children:"day streak"})]})]}),r.jsxs("div",{className:"cbc-section anim-fade-up-d2",children:[r.jsx("h2",{className:"cbc-section-title",children:"Today's Habits"}),r.jsxs("div",{className:"cbc-habits-grid",children:[vt.map(G=>{const he=nt.habits?.[G.key]||!1,Ee=ye===G.key,Oe=ee===G.key;return r.jsxs("div",{className:`cbc-habit-tile ${he?"cbc-habit-done":""} ${Ee?"cbc-habit-just-checked":""}`,style:{"--habit-color":G.color},children:[r.jsx("button",{className:"cbc-habit-delete",onClick:ke=>{ke.stopPropagation(),de(G.isCustom?{type:"custom",id:G.id,label:G.label}:{type:"default",key:G.key,label:G.label})},"aria-label":`Remove ${G.label}`,children:r.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),r.jsxs("div",{className:`cbc-habit-ring-touch ${Oe?"cbc-holding":""} ${he?"cbc-ring-completed":""}`,onPointerDown:ke=>{he||(ke.preventDefault(),Ns(G.key))},onPointerUp:Ws,onPointerLeave:Ws,onPointerCancel:Ws,onClick:ke=>{if(ke.stopPropagation(),Le.current){Le.current=!1;return}he&&$t(G.key)},role:"button",tabIndex:0,"aria-label":he?`Undo ${G.label}`:`Press and hold to complete ${G.label}`,onKeyDown:ke=>{(ke.key==="Enter"||ke.key===" ")&&(ke.preventDefault(),he?$t(G.key):$e(G.key))},children:[r.jsxs("svg",{className:"cbc-habit-ring-svg",viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cbc-habit-ring-track",cx:"50",cy:"50",r:Pg}),r.jsx("circle",{className:"cbc-habit-ring-fill",ref:ke=>{ke&&(it.current[G.key]=ke)},cx:"50",cy:"50",r:Pg,style:{stroke:G.color,strokeDasharray:Ol,strokeDashoffset:he?0:Ol}})]}),he&&r.jsx("div",{className:"cbc-habit-glow-orb",style:{"--habit-color":G.color}}),r.jsx("div",{className:"cbc-habit-ring-icon",style:{color:G.color},children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:G.icon})})}),Ee&&r.jsx("div",{className:"cbc-particles",children:pt.current.map((ke,Qe)=>r.jsx("span",{className:"cbc-particle",style:{"--tx":`${ke.tx}px`,"--ty":`${ke.ty}px`,"--size":`${ke.size}px`,"--particle-color":G.color,animationDuration:`${ke.duration}s`}},Qe))})]}),r.jsx("span",{className:"cbc-habit-label",children:G.label}),he?r.jsx("span",{className:"cbc-habit-done-tag",children:"Done"}):r.jsx("span",{className:"cbc-habit-hold-hint",children:"Hold to complete"})]},G.key)}),r.jsxs("div",{className:"cbc-habit-tile cbc-add-tile",onClick:()=>I(!0),role:"button",tabIndex:0,children:[r.jsx("div",{className:"cbc-add-ring",children:r.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})}),r.jsx("span",{className:"cbc-habit-label",children:"Add Habit"}),r.jsx("span",{className:"cbc-habit-hold-hint",children:"Your own"})]})]})]}),r.jsxs("div",{className:"cbc-section anim-fade-up-d4",children:[r.jsx("h2",{className:"cbc-section-title",children:"This Week"}),r.jsx("div",{className:"cbc-week-grid",children:zt.map((G,he)=>{const Ee=G.dateStr===ne,Oe=G.total>0?G.completed/G.total:0,ke=38,Qe=2*Math.PI*ke,ot=Qe-Oe*Qe;return r.jsxs("div",{className:`cbc-day-ring ${Ee?"cbc-day-today":""} ${G.completed>0?"cbc-day-active":""}`,children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cbc-day-track",cx:"50",cy:"50",r:ke}),r.jsx("circle",{className:"cbc-day-fill",cx:"50",cy:"50",r:ke,strokeDasharray:Qe,strokeDashoffset:ot})]}),r.jsx("span",{className:"cbc-day-label",children:At[he]}),r.jsxs("span",{className:"cbc-day-count",children:[G.completed,"/",G.total]})]},he)})}),r.jsxs("div",{className:"cbc-week-summary",children:[r.jsx("div",{className:"cbc-week-summary-bar",children:r.jsx("div",{className:"cbc-week-summary-fill",style:{width:`${ps}%`}})}),r.jsxs("span",{className:"cbc-week-summary-text",children:[Js," / ",Lt," habits this week (",ps,"%)"]})]})]})]}),r.jsx(ua,{active:"home"}),q&&r.jsx("div",{className:"cbc-modal-overlay",onClick:()=>I(!1),children:r.jsxs("div",{className:"cbc-modal",onClick:G=>G.stopPropagation(),children:[r.jsx("h3",{className:"cbc-modal-title",children:"Add Habit"}),r.jsx("p",{className:"cbc-modal-desc",children:"Track something personal to your routine."}),r.jsx("input",{className:"cbc-modal-input",type:"text",placeholder:"e.g. Meditate, Stretch, Read...",value:qe,onChange:G=>ft(G.target.value),maxLength:30,autoFocus:!0,onKeyDown:G=>G.key==="Enter"&&St()}),r.jsxs("div",{className:"cbc-modal-actions",children:[r.jsx("button",{className:"cbc-modal-cancel",onClick:()=>{I(!1),ft("")},children:"Cancel"}),r.jsx("button",{className:"cbc-modal-save",onClick:St,disabled:!qe.trim(),children:"Add"})]})]})}),W&&r.jsx("div",{className:"cbc-modal-overlay",onClick:()=>de(null),children:r.jsxs("div",{className:"cbc-modal",onClick:G=>G.stopPropagation(),children:[r.jsxs("h3",{className:"cbc-modal-title",children:['Remove "',W.label,'"?']}),r.jsx("p",{className:"cbc-modal-desc",children:"This will remove the habit from your daily tracker. Past logs won't be affected."}),r.jsxs("div",{className:"cbc-modal-actions",children:[r.jsx("button",{className:"cbc-modal-cancel",onClick:()=>de(null),children:"Keep"}),r.jsx("button",{className:"cbc-modal-delete",onClick:()=>W.type==="custom"?is(W.id):Is(W.key),children:"Remove"})]})]})}),me&&r.jsx(Qh,{title:"All Habits Complete!",subtitle:Ms.current,stats:[{value:`${Wt}/${vt.length}`,label:"Habits"},{value:V||1,label:"Day Streak"}],buttonLabel:"Keep Going",holdLabel:"Hold To Complete Today's Habits",shareType:"habits",onShareJourney:t?Ut:null,userName:t?.name,onDone:()=>{R(!1),M(!1)}}),K&&r.jsx("div",{className:`toast-notification ${K.type}`,children:K.message})]})})}function dh(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function I2(n,e){return[n,e].sort().join("_")}function lP(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Ur(),{isDark:l,toggleTheme:u}=Na(),d=er(),[p,g]=v.useState("buddies"),[y,x]=v.useState([]),[j,T]=v.useState([]),[B,$]=v.useState([]),[F,V]=v.useState(""),[te,K]=v.useState([]),[ae,ye]=v.useState([]),[Ae,me]=v.useState(!0),[R,E]=v.useState(null),[M,O]=v.useState(null),D=v.useCallback((ee,L="info")=>{O({message:ee,type:L}),setTimeout(()=>O(null),3500)},[]);v.useEffect(()=>{!i&&(!n||!e)&&d("/")},[n,e,i,d]);const q=v.useCallback(async()=>{if(t){me(!0);try{const ee=t.id,se=(await Es(Ot(pe,"clients"))).docs.map(Ye=>({id:Ye.id,...Ye.data()}));ye(se);const De=Object.fromEntries(se.map(Ye=>[Ye.id,Ye])),ue=await Es(Os(Ot(pe,"buddies"),fs("user1","==",ee))),ze=await Es(Os(Ot(pe,"buddies"),fs("user2","==",ee))),Le=new Set;[...ue.docs,...ze.docs].forEach(Ye=>{const Ht=Ye.data(),Ms=Ht.user1===ee?Ht.user2:Ht.user1;Le.add(Ms)}),x(Array.from(Le).map(Ye=>De[Ye]).filter(Boolean));const it=await Es(Os(Ot(pe,"buddyRequests"),fs("toId","==",ee),fs("status","==","pending")));T(it.docs.map(Ye=>({reqId:Ye.id,...Ye.data(),fromClient:De[Ye.data().fromId]})).filter(Ye=>Ye.fromClient));const pt=await Es(Os(Ot(pe,"buddyRequests"),fs("fromId","==",ee),fs("status","==","pending")));$(pt.docs.map(Ye=>({reqId:Ye.id,...Ye.data(),toClient:De[Ye.data().toId]})).filter(Ye=>Ye.toClient))}catch(ee){console.error("Error fetching buddy data:",ee),D("Failed to load buddies","error")}finally{me(!1)}}},[t,D]);v.useEffect(()=>{q()},[q]),v.useEffect(()=>{if(!F.trim()||!t){K([]);return}const ee=F.toLowerCase(),L=t.id,se=new Set(y.map(Le=>Le.id)),De=new Set(B.map(Le=>Le.toId)),ue=new Set(j.map(Le=>Le.fromId)),ze=ae.filter(Le=>Le.id===L||!Le.name||!Le.coreBuddyAccess&&Le.clientType!=="core_buddy"?!1:Le.name.toLowerCase().includes(ee)).map(Le=>({...Le,isBuddy:se.has(Le.id),isPendingOut:De.has(Le.id),isPendingIn:ue.has(Le.id)})).slice(0,20);K(ze)},[F,ae,y,B,j,t]);const I=async(ee,L)=>{if(!(!t||ee===t.id))try{await la(Ot(pe,"notifications"),{toId:ee,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:L,read:!1,createdAt:br()})}catch(se){console.error("Notification error:",se),se.code==="permission-denied"&&D("Notifications blocked  check Firestore rules","error")}},qe=async ee=>{E(ee);try{const L=`${t.id}_${ee}`;await Ss(He(pe,"buddyRequests",L),{fromId:t.id,toId:ee,status:"pending",createdAt:br()}),await I(ee,"buddy_request"),D("Buddy request sent!","success"),await q()}catch(L){console.error("Error sending request:",L),D("Failed to send request","error")}finally{E(null)}},ft=async ee=>{E(ee.reqId);try{const L=I2(ee.fromId,t.id);await Ss(He(pe,"buddies",L),{user1:[ee.fromId,t.id].sort()[0],user2:[ee.fromId,t.id].sort()[1],connectedAt:br()}),await Sr(He(pe,"buddyRequests",ee.reqId)),await I(ee.fromId,"buddy_accept"),D("Buddy added!","success"),await q()}catch(L){console.error("Error accepting request:",L),D("Failed to accept","error")}finally{E(null)}},W=async ee=>{E(ee.reqId);try{await Sr(He(pe,"buddyRequests",ee.reqId)),D("Request declined","info"),await q()}catch(L){console.error("Error declining:",L),D("Failed to decline","error")}finally{E(null)}},de=async ee=>{E(ee.reqId);try{await Sr(He(pe,"buddyRequests",ee.reqId)),D("Request cancelled","info"),await q()}catch(L){console.error("Error cancelling:",L),D("Failed to cancel","error")}finally{E(null)}},Ie=async ee=>{E(ee);try{const L=I2(t.id,ee);await Sr(He(pe,"buddies",L)),D("Buddy removed","info"),await q()}catch(L){console.error("Error removing buddy:",L),D("Failed to remove buddy","error")}finally{E(null)}},Ve=j.length;return i?r.jsx("div",{className:"bdy-loading",children:r.jsx("div",{className:"bdy-spinner"})}):!n||!e||!t?null:r.jsx(Ta,{children:r.jsxs("div",{className:"bdy-page","data-theme":l?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"bdy-main",children:[r.jsx("h1",{className:"bdy-title",children:"Buddies"}),r.jsxs("button",{className:"bdy-leaderboard-link",onClick:()=>d("/client/leaderboard"),children:[r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C7 4 7 7 7 7"}),r.jsx("path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5C17 4 17 7 17 7"}),r.jsx("rect",{x:"6",y:"9",width:"12",height:"13",rx:"2"}),r.jsx("path",{d:"M12 9v13"}),r.jsx("path",{d:"M2 22h20"})]}),r.jsx("span",{children:"Leaderboard"}),r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("div",{className:"bdy-tabs",children:[r.jsxs("button",{className:`bdy-tab${p==="buddies"?" active":""}`,onClick:()=>g("buddies"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("span",{children:"My Buddies"})]}),r.jsxs("button",{className:`bdy-tab${p==="requests"?" active":""}`,onClick:()=>g("requests"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("line",{x1:"19",y1:"8",x2:"19",y2:"14"}),r.jsx("line",{x1:"22",y1:"11",x2:"16",y2:"11"})]}),r.jsx("span",{children:"Requests"}),Ve>0&&r.jsx("span",{className:"bdy-tab-badge",children:Ve})]}),r.jsxs("button",{className:`bdy-tab${p==="search"?" active":""}`,onClick:()=>g("search"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("span",{children:"Find"})]})]}),Ae?r.jsx("div",{className:"bdy-content-loading",children:r.jsx("div",{className:"bdy-spinner"})}):r.jsxs(r.Fragment,{children:[p==="buddies"&&r.jsx("div",{className:"bdy-section",children:y.length===0?r.jsxs("div",{className:"bdy-empty",children:[r.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("h3",{children:"No buddies yet"}),r.jsx("p",{children:"Find members and send buddy requests to connect!"}),r.jsx("button",{className:"bdy-empty-btn",onClick:()=>g("search"),children:"Find Buddies"})]}):r.jsx("div",{className:"bdy-list",children:y.map(ee=>r.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${ee.id}`),children:[r.jsx("div",{className:"bdy-avatar",children:ee.photoURL?r.jsx("img",{src:ee.photoURL,alt:ee.name}):r.jsx("span",{children:dh(ee.name)})}),r.jsx("div",{className:"bdy-card-info",children:r.jsx("span",{className:"bdy-card-name",children:ee.name})}),r.jsx("button",{className:"bdy-remove-btn",onClick:L=>{L.stopPropagation(),Ie(ee.id)},disabled:R===ee.id,"aria-label":"Remove buddy",children:R===ee.id?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},ee.id))})}),p==="requests"&&r.jsxs("div",{className:"bdy-section",children:[j.length>0&&r.jsxs(r.Fragment,{children:[r.jsx("h3",{className:"bdy-section-title",children:"Incoming"}),r.jsx("div",{className:"bdy-list",children:j.map(ee=>r.jsxs("div",{className:"bdy-card",children:[r.jsx("div",{className:"bdy-avatar",children:ee.fromClient.photoURL?r.jsx("img",{src:ee.fromClient.photoURL,alt:ee.fromClient.name}):r.jsx("span",{children:dh(ee.fromClient.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:ee.fromClient.name}),r.jsx("span",{className:"bdy-card-sub",children:"wants to be your buddy"})]}),r.jsxs("div",{className:"bdy-action-pair",children:[r.jsx("button",{className:"bdy-accept-btn",onClick:()=>ft(ee),disabled:R===ee.reqId,children:R===ee.reqId?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}),r.jsx("button",{className:"bdy-decline-btn",onClick:()=>W(ee),disabled:R===ee.reqId,children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]},ee.reqId))})]}),B.length>0&&r.jsxs(r.Fragment,{children:[r.jsx("h3",{className:"bdy-section-title",children:"Sent"}),r.jsx("div",{className:"bdy-list",children:B.map(ee=>r.jsxs("div",{className:"bdy-card",children:[r.jsx("div",{className:"bdy-avatar",children:ee.toClient?.photoURL?r.jsx("img",{src:ee.toClient.photoURL,alt:ee.toClient.name}):r.jsx("span",{children:dh(ee.toClient?.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:ee.toClient?.name}),r.jsx("span",{className:"bdy-card-sub",children:"pending"})]}),r.jsx("button",{className:"bdy-cancel-btn",onClick:()=>de(ee),disabled:R===ee.reqId,children:R===ee.reqId?r.jsx("div",{className:"bdy-btn-spinner"}):"Cancel"})]},ee.reqId))})]}),j.length===0&&B.length===0&&r.jsxs("div",{className:"bdy-empty",children:[r.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[r.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),r.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),r.jsx("h3",{children:"No pending requests"}),r.jsx("p",{children:"All caught up!"})]})]}),p==="search"&&r.jsxs("div",{className:"bdy-section",children:[r.jsxs("div",{className:"bdy-search-bar",children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("input",{type:"text",placeholder:"Search by name...",value:F,onChange:ee=>V(ee.target.value),autoFocus:!0}),F&&r.jsx("button",{className:"bdy-search-clear",onClick:()=>V(""),children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),F.trim()&&te.length===0&&r.jsx("div",{className:"bdy-empty bdy-empty-sm",children:r.jsxs("p",{children:['No members found for "',F,'"']})}),te.length>0&&r.jsx("div",{className:"bdy-list",children:te.map(ee=>r.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${ee.id}`),children:[r.jsx("div",{className:"bdy-avatar",children:ee.photoURL?r.jsx("img",{src:ee.photoURL,alt:ee.name}):r.jsx("span",{children:dh(ee.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:ee.name}),ee.isBuddy&&r.jsx("span",{className:"bdy-card-badge",children:"Buddy"})]}),ee.isBuddy?r.jsx("span",{className:"bdy-status-icon",children:r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-success)",strokeWidth:"2.5",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}):ee.isPendingOut?r.jsx("span",{className:"bdy-pending-label",children:"Pending"}):ee.isPendingIn?r.jsx("button",{className:"bdy-accept-btn",onClick:L=>{L.stopPropagation();const se=j.find(De=>De.fromId===ee.id);se&&ft(se)},disabled:!!R,children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}):r.jsx("button",{className:"bdy-add-btn",onClick:L=>{L.stopPropagation(),qe(ee.id)},disabled:R===ee.id,children:R===ee.id?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]},ee.id))})]})]})]}),r.jsx(ua,{}),M&&r.jsxs("div",{className:`toast-notification ${M.type}`,children:[r.jsx("span",{className:"toast-icon",children:M.type==="success"?r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M5 13 L9 17 L19 7"})}):M.type==="error"?r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),r.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),r.jsx("span",{className:"toast-message",children:M.message})]})]})})}function hh(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function eg(n,e){return[n,e].sort().join("_")}const cP=5;function tg(n){return n.toISOString().split("T")[0]}function uP(n){return n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}T`:`${Math.round(n)}`}const dP={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}};function D2(n){if(!n)return"";const e=n instanceof Date?n:n.toDate?n.toDate():new Date(n),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function hP(){const{userId:n}=yE(),{currentUser:e,isClient:t,clientData:i,loading:l}=Ur(),{isDark:u,toggleTheme:d}=Na(),p=er(),[g,y]=v.useState(null),[x,j]=v.useState("none"),[T,B]=v.useState(null),[$,F]=v.useState(!0),[V,te]=v.useState(!1),[K,ae]=v.useState(null),[ye,Ae]=v.useState([]),[me,R]=v.useState(!1),[E,M]=v.useState(new Set),[O,D]=v.useState(new Set),[q,I]=v.useState({}),[qe,ft]=v.useState({}),[W,de]=v.useState({}),[Ie,Ve]=v.useState(!0),[ee,L]=v.useState(0),[se,De]=v.useState(0),[ue,ze]=v.useState(0),[Le,it]=v.useState(0),[pt,Ye]=v.useState([]),[Ht,Ms]=v.useState([]),[dt,mt]=v.useState(null),[ne,Rt]=v.useState(null),[Pt,At]=v.useState(0),[vt,nt]=v.useState([]),[$e,$t]=v.useState(!1),[Ns,Ws]=v.useState(null),[Ut,St]=v.useState([]),is=v.useCallback((Y,re="info")=>{ae({message:Y,type:re}),setTimeout(()=>ae(null),3500)},[]);v.useEffect(()=>{!l&&(!e||!t)&&p("/")},[e,t,l,p]),v.useEffect(()=>{i&&n&&i.id===n&&p("/client/core-buddy",{replace:!0})},[i,n,p]),v.useEffect(()=>{if(!i||!n||i.id===n)return;let Y=!1;return(async()=>{F(!0);try{const Ge=(await Es(Ot(pe,"clients"))).docs.map(gt=>({id:gt.id,...gt.data()})).find(gt=>gt.id===n);if(!Ge){Y||F(!1);return}Y||y(Ge);const rt=i.id,bt=eg(rt,n);if((await As(He(pe,"buddies",bt))).exists())Y||j("buddy");else{const gt=`${rt}_${n}`,Gt=await As(He(pe,"buddyRequests",gt));if(Gt.exists()&&Gt.data().status==="pending")Y||(j("pending_out"),B(gt));else{const Gs=`${n}_${rt}`,os=await As(He(pe,"buddyRequests",Gs));os.exists()&&os.data().status==="pending"?Y||(j("pending_in"),B(Gs)):Y||j("none")}}}catch(re){console.error("Error loading profile:",re)}finally{Y||F(!1)}})(),()=>{Y=!0}},[i,n]),v.useEffect(()=>{if(!n||!g)return;let Y=!1;return(async()=>{Ve(!0);try{const[re,We,Ge,rt]=await Promise.all([Es(Os(Ot(pe,"workoutLogs"),fs("clientId","==",n))),As(He(pe,"coreBuddyAchievements",n)),As(He(pe,"coreBuddyPBs",n)),As(He(pe,"clientProgrammes",n))]);if(Y)return;const bt=re.docs.length;L(bt),We.exists()&&De(We.data().totalVolume||0);let jt=0;const gt=re.docs.map(os=>os.data().date).filter(Boolean).sort().reverse();if(gt.length>0){const os=new Date;let ks=new Date(os);for(let Us=0;Us<52;Us++){const H=new Date(ks),_e=H.getDay(),Ne=_e===0?6:_e-1;H.setDate(H.getDate()-Ne),H.setHours(0,0,0,0);const Se=new Date(H);Se.setDate(Se.getDate()+7);const je=tg(H),ct=tg(Se);if(gt.some(Ze=>Ze>=je&&Ze<ct))jt++;else{if(Us>0)break;break}ks.setDate(ks.getDate()-7)}}if(Y||ze(jt),Ge.exists()){const os=Ge.data().exercises||{},ks=Object.entries(os).sort(([,Us],[,H])=>(H.weight||0)-(Us.weight||0)).slice(0,3).map(([Us,H])=>({name:Us,weight:H.weight,reps:H.reps}));Y||Ye(ks)}if(rt.exists()){const os=rt.data(),ks=dP[os.templateId];if(ks){const Us=Object.keys(os.completedSessions||{}).length,H=ks.duration*ks.daysPerWeek;Y||(Rt(os.templateId.replace(/_/g," ").replace(/\b\w/g,_e=>_e.toUpperCase())),At(H>0?Math.round(Us/H*100):0))}}const Gt=await As(He(pe,"achievements",n));if(!Y&&Gt.exists()){const os=Gt.data().badges||{};Ms(Object.keys(os))}let Gs=0;for(let os=0;os<30;os++){const ks=new Date;ks.setDate(ks.getDate()-os);const Us=tg(ks);try{const H=await Es(Os(Ot(pe,"habitLogs"),fs("clientId","==",n),fs("date","==",Us)));if(H.empty)break;{const _e=H.docs[0].data().habits||{};if(Object.values(_e).filter(Boolean).length>=cP)Gs++;else break}}catch{break}}Y||it(Gs)}catch(re){console.error("Error loading buddy stats:",re)}finally{Y||Ve(!1)}})(),()=>{Y=!0}},[n,g]),v.useEffect(()=>{if(!i)return;const Y=i.id;(async()=>{try{const[re,We,Ge]=await Promise.all([Es(Os(Ot(pe,"buddies"),fs("user1","==",Y))),Es(Os(Ot(pe,"buddies"),fs("user2","==",Y))),Es(Ot(pe,"clients"))]),rt=new Set;[...re.docs,...We.docs].forEach(jt=>{const gt=jt.data();rt.add(gt.user1===Y?gt.user2:gt.user1)});const bt={};Ge.docs.forEach(jt=>{bt[jt.id]=jt.data()}),nt(Array.from(rt).filter(jt=>bt[jt]).map(jt=>({id:jt,name:bt[jt].name,photoURL:bt[jt].photoURL||null})))}catch(re){console.error("Error loading buddies for mentions:",re)}})()},[i]);const Is=async(Y,re,We={})=>{if(!(!i||Y===i.id))try{await la(Ot(pe,"notifications"),{toId:Y,fromId:i.id,fromName:i.name||"Someone",fromPhotoURL:i.photoURL||null,type:re,read:!1,createdAt:br(),...We})}catch(Ge){console.error("Notification error:",Ge),Ge.code==="permission-denied"&&is("Notifications blocked  check Firestore rules","error")}},zt=async()=>{te(!0);try{const Y=`${i.id}_${n}`;await Ss(He(pe,"buddyRequests",Y),{fromId:i.id,toId:n,status:"pending",createdAt:br()}),await Is(n,"buddy_request"),j("pending_out"),B(Y),is("Buddy request sent!","success")}catch(Y){console.error(Y),is("Failed to send request","error")}finally{te(!1)}},Js=async()=>{if(T){te(!0);try{const Y=eg(i.id,n);await Ss(He(pe,"buddies",Y),{user1:[i.id,n].sort()[0],user2:[i.id,n].sort()[1],connectedAt:br()}),await Sr(He(pe,"buddyRequests",T)),await Is(n,"buddy_accept"),j("buddy"),is("Buddy added!","success")}catch(Y){console.error(Y),is("Failed to accept","error")}finally{te(!1)}}},Lt=async()=>{if(T){te(!0);try{await Sr(He(pe,"buddyRequests",T)),j("none"),is(x==="pending_out"?"Request cancelled":"Request declined","info")}catch(Y){console.error(Y),is("Failed","error")}finally{te(!1)}}},ps=async()=>{te(!0);try{const Y=eg(i.id,n);await Sr(He(pe,"buddies",Y)),j("none"),is("Buddy removed","info")}catch(Y){console.error(Y),is("Failed to remove","error")}finally{te(!1)}},Wt=v.useCallback(async()=>{if(n){R(!0);try{const Y=await Es(Os(Ot(pe,"posts"),fs("authorId","==",n),Kh("createdAt","desc"),Yh(30)));if(Ae(Y.docs.map(re=>({id:re.id,...re.data()}))),i){const re=await Es(Os(Ot(pe,"postLikes"),fs("userId","==",i.id)));M(new Set(re.docs.map(We=>We.data().postId)))}}catch(Y){console.error("Error loading journey:",Y)}finally{R(!1)}}},[n,i]);v.useEffect(()=>{!$&&g&&Wt()},[$,g,Wt]);const we=async Y=>{if(window.confirm("Delete this post?"))try{await Sr(He(pe,"posts",Y)),Ae(re=>re.filter(We=>We.id!==Y)),is("Post deleted","info")}catch(re){console.error("Delete error:",re),is("Failed to delete","error")}},G=async Y=>{if(!i)return;const re=i.id,We=`${Y}_${re}`,Ge=E.has(Y),rt=new Set(E);Ge?rt.delete(Y):rt.add(Y),M(rt),Ae(bt=>bt.map(jt=>jt.id===Y?{...jt,likeCount:Math.max(0,(jt.likeCount||0)+(Ge?-1:1))}:jt));try{if(Ge)await Sr(He(pe,"postLikes",We)),await La(He(pe,"posts",Y),{likeCount:Uo(-1)});else{await Ss(He(pe,"postLikes",We),{postId:Y,userId:re,createdAt:br()}),await La(He(pe,"posts",Y),{likeCount:Uo(1)});const bt=ye.find(jt=>jt.id===Y);bt&&Is(bt.authorId,"like",{postId:Y})}}catch(bt){console.error("Like error:",bt),Wt()}},he=async Y=>{try{const re=await Es(Os(Ot(pe,"postComments"),fs("postId","==",Y),Kh("createdAt","asc"),Yh(50)));I(We=>({...We,[Y]:re.docs.map(Ge=>({id:Ge.id,...Ge.data()}))}))}catch(re){console.error("Error loading comments:",re)}},Ee=Y=>{const re=new Set(O);re.has(Y)?re.delete(Y):(re.add(Y),q[Y]||he(Y)),D(re)},Oe=(Y,re)=>{const We=Y.match(/@(\w*)$/);if(We){$t(!0),Ws(re);const Ge=vt.filter(rt=>rt.name&&rt.name.toLowerCase().includes(We[1].toLowerCase())).slice(0,5);St(Ge)}else $t(!1),St([])},ke=(Y,re)=>{const Ge=(qe[re]||"").replace(/@\w*$/,`@${Y.name} `);ft(rt=>({...rt,[re]:Ge})),$t(!1),St([])},Qe=(Y,re)=>{ft(We=>({...We,[Y]:re})),Oe(re,Y)},ot=async Y=>{const re=(qe[Y]||"").trim();if(!(!re||!i)){de(We=>({...We,[Y]:!0}));try{await la(Ot(pe,"postComments"),{postId:Y,authorId:i.id,authorName:i.name||"Unknown",authorPhotoURL:i.photoURL||null,content:re,createdAt:br()}),await La(He(pe,"posts",Y),{commentCount:Uo(1)});const We=ye.find(rt=>rt.id===Y);We&&Is(We.authorId,"comment",{postId:Y});const Ge=re.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Ge){const rt=new Set;Ge.forEach(bt=>{const jt=bt.slice(1).trim(),gt=vt.find(Gt=>Gt.name&&Gt.name.toLowerCase()===jt.toLowerCase());gt&&!rt.has(gt.id)&&(rt.add(gt.id),Is(gt.id,"mention",{postId:Y}))})}ft(rt=>({...rt,[Y]:""})),Ae(rt=>rt.map(bt=>bt.id===Y?{...bt,commentCount:(bt.commentCount||0)+1}:bt)),await he(Y)}catch(We){console.error("Comment error:",We),is("Failed to comment","error")}finally{de(We=>({...We,[Y]:!1}))}}};return l||$||!i?r.jsx("div",{className:"prf-loading","data-theme":u?"dark":"light",children:r.jsx("div",{className:"prf-spinner"})}):!e||!t?null:g?r.jsx(Ta,{children:r.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:u?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"prf-main",children:[r.jsxs("div",{className:"prf-hero",children:[r.jsx("div",{className:"prf-avatar-lg",children:g.photoURL?r.jsx("img",{src:g.photoURL,alt:g.name}):r.jsx("span",{children:hh(g.name)})}),r.jsx("h1",{className:"prf-name",children:g.name}),r.jsxs("div",{className:"prf-buddy-action",children:[x==="none"&&r.jsx("button",{className:"prf-btn prf-btn-primary",onClick:zt,disabled:V,children:V?r.jsx("div",{className:"prf-btn-spinner"}):r.jsxs(r.Fragment,{children:[r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Buddy"]})}),x==="pending_out"&&r.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:Lt,disabled:V,children:V?r.jsx("div",{className:"prf-btn-spinner dark"}):"Cancel Request"}),x==="pending_in"&&r.jsxs("div",{className:"prf-btn-pair",children:[r.jsx("button",{className:"prf-btn prf-btn-success",onClick:Js,disabled:V,children:V?r.jsx("div",{className:"prf-btn-spinner"}):"Accept"}),r.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:Lt,disabled:V,children:"Decline"})]}),x==="buddy"&&r.jsx("button",{className:"prf-btn prf-btn-danger",onClick:ps,disabled:V,children:V?r.jsx("div",{className:"prf-btn-spinner"}):"Remove Buddy"})]})]}),Ie?r.jsx("div",{className:"prf-stats-loading",children:r.jsx("div",{className:"prf-spinner"})}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"prf-stats",children:[r.jsxs("div",{className:"prf-stat",children:[r.jsx("span",{className:"prf-stat-value",children:ee}),r.jsx("span",{className:"prf-stat-label",children:"Workouts"})]}),r.jsxs("div",{className:"prf-stat",children:[r.jsxs("span",{className:"prf-stat-value",children:[uP(se),r.jsx("span",{className:"prf-stat-unit",children:se>=1e3?"":"kg"})]}),r.jsxs("span",{className:"prf-stat-label",children:[se>=1e6?"Million kg":se>=1e3?"Tonnes":"Volume"," Lifted"]})]}),r.jsxs("div",{className:"prf-stat",children:[r.jsxs("span",{className:"prf-stat-value",children:[ue,r.jsx("span",{className:"prf-stat-unit",children:"wk"})]}),r.jsx("span",{className:"prf-stat-label",children:"Streak"})]})]}),(ne||Le>0)&&r.jsxs("div",{className:"prf-info-row",children:[ne&&r.jsxs("div",{className:"prf-info-card info-programme",children:[r.jsx("div",{className:"prf-info-icon",children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"}),r.jsx("path",{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"})]})}),r.jsxs("div",{className:"prf-info-text",children:[r.jsx("span",{className:"prf-info-label",children:ne}),r.jsx("div",{className:"prf-info-progress-bar",children:r.jsx("div",{className:"prf-info-progress-fill",style:{width:`${Math.min(Pt,100)}%`}})}),r.jsxs("span",{className:"prf-info-sub",children:[Pt,"% complete"]})]})]}),Le>0&&r.jsxs("div",{className:"prf-info-card info-habit",children:[r.jsx("div",{className:"prf-info-icon",children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),r.jsx("path",{d:"M22 4L12 14.01l-3-3"})]})}),r.jsxs("div",{className:"prf-info-text",children:[r.jsxs("span",{className:"prf-info-value",children:[Le," day",Le!==1?"s":""]}),r.jsx("span",{className:"prf-info-sub",children:"Habit Streak"})]})]})]}),pt.length>0&&r.jsxs("div",{className:"prf-section",children:[r.jsx("h2",{className:"prf-section-title",children:"Top Lifts"}),r.jsx("div",{className:"prf-pb-list",children:pt.map((Y,re)=>r.jsxs("div",{className:"prf-pb-item",children:[r.jsx("div",{className:"prf-pb-rank",children:re===0?r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:r.jsx("path",{d:"M12 2l2.4 7.4H22l-6 4.4 2.3 7.2L12 16.6 5.7 21l2.3-7.2-6-4.4h7.6z"})}):`#${re+1}`}),r.jsx("span",{className:"prf-pb-name",children:Y.name}),r.jsxs("span",{className:"prf-pb-weight",children:[Y.weight,r.jsx("span",{className:"prf-pb-unit",children:"kg"})," x",Y.reps]})]},re))})]}),Ht.length>0&&r.jsxs("div",{className:"prf-section",children:[r.jsxs("h2",{className:"prf-section-title",children:["Badges Earned (",Ht.length,")"]}),r.jsx("div",{className:"prf-badge-row",children:Ht.map(Y=>{const re=Hn.find(We=>We.id===Y);return re?r.jsx("button",{className:"prf-badge-chip",onClick:()=>mt(re),children:r.jsx("img",{src:re.img,alt:re.name,className:"prf-badge-chip-img"})},Y):null})})]}),dt&&r.jsx("div",{className:"prf-badge-overlay",onClick:()=>mt(null),children:r.jsxs("div",{className:"prf-badge-overlay-content",onClick:Y=>Y.stopPropagation(),children:[r.jsx("img",{src:dt.img,alt:dt.name,className:"prf-badge-overlay-img"}),r.jsx("p",{className:"prf-badge-overlay-desc",children:dt.desc}),r.jsx("button",{className:"prf-badge-overlay-close",onClick:()=>mt(null),children:"Tap to close"})]})})]}),r.jsxs("div",{className:"prf-section",children:[r.jsx("h2",{className:"prf-section-title",children:`${g.name?.split(" ")[0]}'s Journey`}),me?r.jsx("div",{className:"journey-loading",children:r.jsx("div",{className:"prf-spinner"})}):ye.length===0?r.jsxs("div",{className:"journey-empty",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]}),r.jsx("p",{children:"No posts yet"})]}):r.jsx("div",{className:"journey-list",children:ye.map(Y=>r.jsxs("div",{className:"journey-post",children:[r.jsxs("div",{className:"journey-post-header",children:[r.jsx("div",{className:"journey-post-avatar",children:Y.authorPhotoURL?r.jsx("img",{src:Y.authorPhotoURL,alt:""}):r.jsx("span",{children:hh(Y.authorName)})}),r.jsxs("div",{className:"journey-post-meta",children:[r.jsx("span",{className:"journey-post-name",children:Y.authorName}),r.jsx("span",{className:"journey-post-time",children:D2(Y.createdAt)})]}),Y.authorId===i.id&&r.jsx("button",{className:"journey-delete-btn",onClick:()=>we(Y.id),"aria-label":"Delete post",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),Y.content&&r.jsx("p",{className:"journey-post-content",children:Y.content}),Y.imageURL&&r.jsx("div",{className:"journey-post-image",children:r.jsx("img",{src:Y.imageURL,alt:"Post",loading:"lazy"})}),r.jsxs("div",{className:"journey-post-actions",children:[r.jsxs("button",{className:`journey-action-btn${E.has(Y.id)?" liked":""}`,onClick:()=>G(Y.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:E.has(Y.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),r.jsx("span",{children:Y.likeCount||0})]}),r.jsxs("button",{className:`journey-action-btn${O.has(Y.id)?" active":""}`,onClick:()=>Ee(Y.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),r.jsx("span",{children:Y.commentCount||0})]})]}),O.has(Y.id)&&r.jsxs("div",{className:"journey-comments",children:[q[Y.id]?.length>0?q[Y.id].map(re=>r.jsxs("div",{className:"journey-comment",children:[r.jsx("div",{className:"journey-comment-avatar",onClick:()=>p(`/client/core-buddy/profile/${re.authorId}`),children:re.authorPhotoURL?r.jsx("img",{src:re.authorPhotoURL,alt:""}):r.jsx("span",{children:hh(re.authorName)})}),r.jsxs("div",{className:"journey-comment-body",children:[r.jsxs("div",{className:"journey-comment-bubble",children:[r.jsx("span",{className:"journey-comment-name",children:re.authorName}),r.jsx("span",{className:"journey-comment-text",children:re.content})]}),r.jsx("span",{className:"journey-comment-time",children:D2(re.createdAt)})]})]},re.id)):r.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),r.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[r.jsx("input",{type:"text",placeholder:"Comment... (@ to mention)",value:qe[Y.id]||"",onChange:re=>Qe(Y.id,re.target.value),onKeyDown:re=>{re.key==="Enter"&&ot(Y.id)},maxLength:300}),$e&&Ns===Y.id&&Ut.length>0&&r.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:Ut.map(re=>r.jsxs("button",{className:"mention-option",onClick:()=>ke(re,Y.id),children:[r.jsx("div",{className:"mention-option-avatar",children:re.photoURL?r.jsx("img",{src:re.photoURL,alt:""}):r.jsx("span",{children:hh(re.name)})}),r.jsx("span",{children:re.name})]},re.id))}),r.jsx("button",{onClick:()=>ot(Y.id),disabled:!(qe[Y.id]||"").trim()||W[Y.id],children:W[Y.id]?r.jsx("div",{className:"journey-btn-spinner-sm"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),r.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},Y.id))})]})]}),r.jsx(ua,{}),K&&r.jsxs("div",{className:`toast-notification ${K.type}`,children:[r.jsx("span",{className:"toast-icon",children:K.type==="success"?r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M5 13 L9 17 L19 7"})}):K.type==="error"?r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),r.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),r.jsx("span",{className:"toast-message",children:K.message})]})]})}):r.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions"})]})}),r.jsx("main",{className:"prf-main",children:r.jsx("p",{style:{textAlign:"center",color:"var(--text-tertiary)",padding:"40px 0"},children:"User not found"})}),r.jsx(ua,{})]})}function mP(){const n=er(),{clientData:e,currentUser:t,resolveClient:i,updateClientData:l}=Ur(),[u,d]=v.useState([]),[p,g]=v.useState(""),[y,x]=v.useState(!1),[j,T]=v.useState(null),[B,$]=v.useState(!1),[F,V]=v.useState(null),te=v.useRef(null),K=v.useRef(null);if(!e?.buddyEnabled)return r.jsxs("div",{className:"buddy-page",children:[r.jsxs("div",{className:"buddy-container",children:[r.jsx("p",{children:"Buddy is not enabled on your account."}),r.jsx("button",{onClick:()=>n("/client/core-buddy"),children:"Back to Dashboard"})]}),r.jsx(ua,{active:"home"})]});v.useEffect(()=>{te.current&&te.current.scrollIntoView({behavior:"smooth"})},[u,y]),v.useEffect(()=>{u.length===0&&!y&&ae([])},[]);const ae=async E=>{x(!0),T(null);try{const O=await(await fetch("/api/buddy-onboarding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:E,clientName:e?.name||t?.displayName||"there"})})).json();if(O.error){T(O.error);return}const D={role:"assistant",content:O.reply};d(q=>[...q,D]),O.profileData&&(await R(O.profileData),V(O.profileData),$(!0))}catch(M){console.error("Buddy chat error:",M),T("Something went wrong  try sending again.")}finally{x(!1)}},ye=()=>{const E=p.trim();if(!E||y)return;const M={role:"user",content:E},O=[...u,M];d(O),g(""),K.current&&K.current.focus(),ae(O)},Ae=E=>{E.key==="Enter"&&!E.shiftKey&&(E.preventDefault(),ye())},me=E=>{const M=E?.experience||"beginner";return M==="advanced"?{id:"fullbody_12wk",name:"12-Week Full Body",duration:12,level:"Advanced",daysPerWeek:3,description:"Complete transformation programme  push, pull, and legs over three phases."}:M==="intermediate"?{id:"fullbody_8wk",name:"8-Week Full Body",duration:8,level:"Intermediate",daysPerWeek:3,description:"Two-phase programme building strength and endurance across your full body."}:{id:"fullbody_4wk",name:"4-Week Full Body",duration:4,level:"All Levels",daysPerWeek:3,description:"Build total body strength with compound dumbbell movements and bodyweight finishers."}},R=async E=>{try{const M=await i();if(!M)return;await Ss(He(pe,"onboardingSubmissions",M.id),{clientId:M.id,clientName:M.name,email:M.email,source:"buddy_chat",welcome:{dob:E.dob||null,gender:E.gender||null,goals:E.goals||[],experience:E.experience||null,injuries:E.injuries||null,activityLevel:E.activityLevel||null,exerciseHistory:E.exerciseHistory||null,sleepHours:E.sleepHours||null,stressLevel:E.stressLevel||null,dietaryInfo:E.dietaryInfo||null,availability:E.availability||null,additionalInfo:E.additionalInfo||null},submittedAt:br()});const O=E.goals||[];await La(He(pe,"clients",M.id),{fitnessGoal:O[0]||null,fitnessGoals:O,experienceLevel:E.experience||null,dob:E.dob||null,injuries:E.injuries||null}),l({fitnessGoal:O[0]||null,fitnessGoals:O,experienceLevel:E.experience,dob:E.dob})}catch(M){console.error("Save profile error:",M)}};return r.jsx(Ta,{children:r.jsxs("div",{className:"buddy-page buddy-page--chat",children:[r.jsxs("div",{className:"buddy-chat-container",children:[r.jsxs("div",{className:"buddy-chat-top",children:[r.jsx("button",{className:"buddy-back",onClick:()=>n("/client/core-buddy"),children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsxs("div",{className:"buddy-chat-header",children:[r.jsx("div",{className:"buddy-chat-avatar",children:r.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 2a4 4 0 0 1 4 4v2a4 4 0 0 1-8 0V6a4 4 0 0 1 4-4z"}),r.jsx("path",{d:"M18 14c2 1 3 3 3 5v2H3v-2c0-2 1-4 3-5"}),r.jsx("circle",{cx:"9",cy:"7",r:"0.5",fill:"currentColor"}),r.jsx("circle",{cx:"15",cy:"7",r:"0.5",fill:"currentColor"}),r.jsx("path",{d:"M9.5 10a2.5 2.5 0 0 0 5 0"})]})}),r.jsxs("div",{children:[r.jsx("h2",{className:"buddy-chat-name",children:"Buddy"}),r.jsx("span",{className:"buddy-chat-status",children:y?"typing...":"Your AI Coach"})]})]})]}),r.jsxs("div",{className:"buddy-chat-messages",children:[u.map((E,M)=>r.jsxs("div",{className:`buddy-chat-bubble buddy-chat-${E.role}`,children:[E.role==="assistant"&&r.jsx("div",{className:"buddy-chat-bubble-avatar",children:"B"}),r.jsx("div",{className:"buddy-chat-bubble-content",children:E.content})]},M)),y&&r.jsxs("div",{className:"buddy-chat-bubble buddy-chat-assistant",children:[r.jsx("div",{className:"buddy-chat-bubble-avatar",children:"B"}),r.jsxs("div",{className:"buddy-chat-bubble-content buddy-chat-typing",children:[r.jsx("span",{}),r.jsx("span",{}),r.jsx("span",{})]})]}),j&&r.jsxs("div",{className:"buddy-chat-error",children:[j,r.jsx("button",{onClick:()=>ae(u),children:"Retry"})]}),r.jsx("div",{ref:te})]}),B?r.jsx("div",{className:"buddy-chat-done",children:F?(()=>{const E=me(F);return r.jsxs(r.Fragment,{children:[r.jsx("p",{className:"buddy-chat-done-text",children:"Profile saved! Here's my pick for you:"}),r.jsxs("div",{className:"buddy-rec-card",onClick:()=>n("/client/core-buddy/programmes",{state:{templateId:E.id}}),children:[r.jsx("div",{className:"buddy-rec-name",children:E.name}),r.jsxs("div",{className:"buddy-rec-meta",children:[E.duration," weeks  ",E.daysPerWeek," days/week  ",E.level]}),r.jsx("div",{className:"buddy-rec-desc",children:E.description}),r.jsx("div",{className:"buddy-rec-cta",children:"View Programme"})]}),r.jsx("button",{className:"buddy-chat-skip-btn",onClick:()=>n("/client/core-buddy"),children:"Maybe later"})]})})():r.jsxs(r.Fragment,{children:[r.jsx("p",{className:"buddy-chat-done-text",children:"Profile saved  you're all set."}),r.jsx("button",{className:"buddy-chat-done-btn",onClick:()=>n("/client/core-buddy"),children:"Back to Dashboard"})]})}):r.jsxs("div",{className:"buddy-chat-input-wrap",children:[r.jsx("textarea",{ref:K,className:"buddy-chat-input",placeholder:"Type your message...",value:p,onChange:E=>g(E.target.value),onKeyDown:Ae,rows:1,disabled:y}),r.jsx("button",{className:"buddy-chat-send",onClick:ye,disabled:!p.trim()||y,"aria-label":"Send message",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),r.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]}),r.jsx(ua,{active:"home"})]})})}const ba=[{key:"pressUps",name:"Press-Ups",category:"Upper Body",unit:"reps"},{key:"squats",name:"Squats",category:"Lower Body",unit:"reps"},{key:"longJump",name:"Standing Long Jump",category:"Power",unit:"distance"},{key:"deadHang",name:"Dead Hang",category:"Upper Body",unit:"time"},{key:"plank",name:"Plank",category:"Core",unit:"time"},{key:"wallSit",name:"Wall Sit",category:"Lower Body",unit:"time"},{key:"chestPress",name:"Chest Press",category:"Upper Body",unit:"weight"}],Lo=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function fP(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}function va(n){const[e,t]=n.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function pP(n){if(!n&&n!==0)return"-";const e=Math.floor(n/60),t=(n%60).toFixed(2);return e>0?`${e}m ${parseFloat(t).toFixed(0)}s`:`${parseFloat(t).toFixed(2)}s`}function gP(n,e){return!n&&n!==0?"-":!e&&e!==0?`${n}kg`:`${n}kg x ${e}`}function mh(n,e){if(!e)return"-";switch(n.unit){case"weight":return gP(e.weight,e.reps);case"time":return pP(e.time);case"reps":return e.reps?`${e.reps} reps`:"-";case"distance":return e.distance?`${e.distance} cm`:"-";default:return"-"}}function Bl(n,e){if(!e)return 0;switch(n.unit){case"weight":return(e.weight||0)*(e.reps||0);case"time":return e.time||0;case"reps":return e.reps||0;case"distance":return e.distance||0;default:return 0}}function sg(n,e){return!e||e===0?null:(n-e)/e*100}function yP({data:n,exerciseKey:e,unit:t}){if(!n||n.length<2)return r.jsx("div",{className:"pb-trend-empty",children:r.jsx("p",{children:"Not enough data for trend line yet"})});const i=n.map(F=>{const V=F.benchmarks?.[e];if(!V)return 0;switch(t){case"weight":return(V.weight||0)*(V.reps||0);case"time":return V.time||0;case"reps":return V.reps||0;case"distance":return V.distance||0;default:return 0}}),l=Math.max(...i),u=Math.min(...i),d=l-u||1,p=300,g=100,y=20,x=p-y*2,j=g-y*2,T=i.map((F,V)=>{const te=y+V/(i.length-1)*x,K=y+j-(F-u)/d*j;return{x:te,y:K,value:F}}),B=T.map((F,V)=>`${V===0?"M":"L"} ${F.x} ${F.y}`).join(" "),$=B+` L ${T[T.length-1].x} ${y+j} L ${T[0].x} ${y+j} Z`;return r.jsxs("div",{className:"pb-trend-chart",children:[r.jsxs("svg",{viewBox:`0 0 ${p} ${g}`,preserveAspectRatio:"xMidYMid meet",children:[r.jsx("defs",{children:r.jsxs("linearGradient",{id:"trendGradientJr",x1:"0",y1:"0",x2:"0",y2:"1",children:[r.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),r.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),r.jsx("path",{d:$,fill:"url(#trendGradientJr)"}),r.jsx("path",{d:B,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),T.map((F,V)=>r.jsx("circle",{cx:F.x,cy:F.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},V))]}),r.jsx("div",{className:"pb-trend-labels",children:n.map((F,V)=>r.jsxs("span",{className:"pb-trend-label",children:[F.month.split("-")[1],"/",F.month.split("-")[0].slice(2)]},V))})]})}function bP(){const[n,e]=v.useState("bests"),[t,i]=v.useState([]),[l,u]=v.useState(!0),[d,p]=v.useState(!1),[g,y]=v.useState(0),[x,j]=v.useState(!1),[T,B]=v.useState(!1),[$,F]=v.useState(!1),[V,te]=v.useState({}),[K,ae]=v.useState({}),[ye,Ae]=v.useState({}),[me,R]=v.useState({}),[E,M]=v.useState({}),[O,D]=v.useState(!1),[q,I]=v.useState({}),[qe,ft]=v.useState([]),[W,de]=v.useState(null),[Ie,Ve]=v.useState(null),[ee,L]=v.useState(!1),[se,De]=v.useState(""),[ue,ze]=v.useState(""),Le=v.useRef(null),it=v.useRef(0),pt=v.useRef(0),Ye=v.useRef("right"),Ht=v.useCallback(H=>{y(_e=>{const Ne=Math.max(0,Math.min(ba.length-1,H));return Ne===_e?_e:(Ye.current=Ne>_e?"right":"left",Ne)})},[]),{currentUser:Ms,isClient:dt,clientData:mt,loading:ne}=Ur(),{isDark:Rt}=Na(),Pt=er(),At=v.useCallback((H,_e="info")=>{Ve({message:H,type:_e}),setTimeout(()=>Ve(null),4e3)},[]);v.useEffect(()=>{!ne&&(!Ms||!dt)&&Pt("/")},[Ms,dt,ne,Pt]),v.useEffect(()=>{mt&&vt()},[mt]);const vt=async()=>{try{const H=Os(Ot(pe,"juniorPBs"),fs("clientId","==",mt.id)),Ne=(await Es(H)).docs.map(Ze=>({id:Ze.id,...Ze.data()}));Ne.sort((Ze,kt)=>Ze.month.localeCompare(kt.month)),i(Ne);const Se=Os(Ot(pe,"juniorPBTargets"),fs("clientId","==",mt.id)),je=await Es(Se);if(!je.empty){const Ze=je.docs[0].data();Ae(Ze.targets||{}),R(Ze.metricTargets||{}),M(Ze.targets||{}),I(Ze.metricTargets||{})}const ct=Os(Ot(pe,"juniorAchievements"),fs("clientId","==",mt.id)),xt=await Es(ct);xt.empty||ft(xt.docs[0].data().badges||[])}catch(H){console.error("Error fetching junior personal bests:",H)}u(!1)},nt=fP(),$e=t.find(H=>H.month===nt),$t=t.filter(H=>H.month<nt),Ns=$t.length>0?$t[$t.length-1]:null;v.useEffect(()=>{$e?(te($e.benchmarks||{}),ae($e.bodyMetrics||{})):(te({}),ae({}))},[$e?.id]);const Ws=async(H,_e)=>{const Ne=[];if(H==="strength"?ba.forEach(Se=>{const je=ye[Se.key];if(!je)return;const ct=_e[Se.key];if(!ct)return;let xt;if(je.targetType==="time"){if(!je.targetValue)return;const Ze=je.startValue||0,kt=ct.time||0,Et=je.targetValue-Ze;xt=Et===0?kt>=je.targetValue?1:0:Math.max(0,(kt-Ze)/Et)}else if(je.targetType==="reps"){if(!je.targetReps)return;const Ze=je.startReps||0,kt=ct.reps||0,Et=je.targetReps-Ze;xt=Et===0?kt>=je.targetReps?1:0:Math.max(0,(kt-Ze)/Et)}else if(je.targetType==="distance"){if(!je.targetDistance)return;const Ze=je.startDistance||0,kt=ct.distance||0,Et=je.targetDistance-Ze;xt=Et===0?kt>=je.targetDistance?1:0:Math.max(0,(kt-Ze)/Et)}else{if(!je.targetWeight&&!je.targetReps)return;const Ze=(je.startWeight||0)*(je.startReps||0),kt=(je.targetWeight||0)*(je.targetReps||0),Et=(ct.weight||0)*(ct.reps||0),Cs=kt-Ze;xt=Cs===0?Et>=kt?1:0:Math.max(0,(Et-Ze)/Cs)}if(xt>=1){let Ze,kt;je.targetType==="time"?(Ze=qe.some(Et=>Et.type==="strength"&&Et.key===Se.key&&Et.targetValue===je.targetValue),kt=`${Se.name} ${je.targetValue}s`):je.targetType==="reps"?(Ze=qe.some(Et=>Et.type==="strength"&&Et.key===Se.key&&Et.targetReps===je.targetReps),kt=`${Se.name} ${je.targetReps} reps`):je.targetType==="distance"?(Ze=qe.some(Et=>Et.type==="strength"&&Et.key===Se.key&&Et.targetDistance===je.targetDistance),kt=`${Se.name} ${je.targetDistance}cm`):(Ze=qe.some(Et=>Et.type==="strength"&&Et.key===Se.key&&Et.targetWeight===je.targetWeight&&Et.targetReps===je.targetReps),kt=`${Se.name} ${je.targetWeight}kg  ${je.targetReps}`),Ze||Ne.push({type:"strength",key:Se.key,...je.targetType==="time"?{targetType:"time",targetValue:je.targetValue}:je.targetType==="reps"?{targetType:"reps",targetReps:je.targetReps}:je.targetType==="distance"?{targetType:"distance",targetDistance:je.targetDistance}:{targetWeight:je.targetWeight,targetReps:je.targetReps},achievedMonth:nt,label:kt})}}):Lo.forEach(Se=>{const je=me[Se.key];if(!je||!je.targetValue)return;const ct=_e[Se.key];if(ct==null)return;const xt=je.startValue||0,Ze=je.targetValue,kt=Ze-xt;(kt===0?ct===Ze?1:0:Math.max(0,(ct-xt)/kt))>=1&&(qe.some(hn=>hn.type==="metric"&&hn.key===Se.key&&hn.targetValue===Ze)||Ne.push({type:"metric",key:Se.key,targetValue:Ze,achievedMonth:nt,label:`${Se.name} ${Ze}${Se.suffix}`}))}),Ne.length>0){const Se=[...qe,...Ne];await Ss(He(pe,"juniorAchievements",mt.id),{clientId:mt.id,badges:Se,updatedAt:_t.now()}),ft(Se),de(Ne),setTimeout(()=>de(null),5e3)}},Ut=(H,_e)=>{if(H==="strength"){const Ne=ye[_e];if(!Ne)return!1;switch(ba.find(je=>je.key===_e)?.unit){case"time":return qe.some(je=>je.type==="strength"&&je.key===_e&&je.targetValue===Ne.targetValue);case"reps":return qe.some(je=>je.type==="strength"&&je.key===_e&&je.targetReps===Ne.targetReps);case"distance":return qe.some(je=>je.type==="strength"&&je.key===_e&&je.targetDistance===Ne.targetDistance);default:return!Ne.targetWeight&&!Ne.targetReps?!1:qe.some(je=>je.type==="strength"&&je.key===_e&&je.targetWeight===Ne.targetWeight&&je.targetReps===Ne.targetReps)}}else{const Ne=me[_e];return!Ne||!Ne.targetValue?!1:qe.some(Se=>Se.type==="metric"&&Se.key===_e&&Se.targetValue===Ne.targetValue)}},St=async()=>{p(!0);try{const H=`${mt.id}_${nt}`,_e=$e||{};await Ss(He(pe,"juniorPBs",H),{clientId:mt.id,month:nt,benchmarks:V,bodyMetrics:_e.bodyMetrics||K||{},createdAt:_e.createdAt||_t.now(),updatedAt:_t.now()}),await Ws("strength",V),At("Benchmarks saved!","success"),j(!1),await vt()}catch(H){console.error("Error saving benchmarks:",H),At("Failed to save. Please try again.","error")}p(!1)},is=async()=>{p(!0);try{const H=`${mt.id}_${nt}`,_e=$e||{};await Ss(He(pe,"juniorPBs",H),{clientId:mt.id,month:nt,benchmarks:_e.benchmarks||V||{},bodyMetrics:K,createdAt:_e.createdAt||_t.now(),updatedAt:_t.now()}),await Ws("metric",K),At("Body metrics saved!","success"),B(!1),await vt()}catch(H){console.error("Error saving metrics:",H),At("Failed to save. Please try again.","error")}p(!1)},Is=(H,_e,Ne)=>{te(Se=>({...Se,[H]:{...Se[H],[_e]:Ne===""?"":parseFloat(Ne)}}))},zt=(H,_e)=>{ae(Ne=>({...Ne,[H]:_e===""?"":parseFloat(_e)}))},Js=(H,_e,Ne)=>{M(Se=>({...Se,[H]:{...Se[H],[_e]:Ne===""?"":parseFloat(Ne)}}))},Lt=async()=>{p(!0);try{const H=`targets_${mt.id}`,_e=$e?.benchmarks||{},Ne={};ba.forEach(Se=>{const je=_e[Se.key];switch(Se.unit){case"time":E[Se.key]?.targetValue&&(Ne[Se.key]={targetType:"time",targetValue:E[Se.key].targetValue,startValue:je?.time||0});break;case"reps":E[Se.key]?.targetReps&&(Ne[Se.key]={targetType:"reps",targetReps:E[Se.key].targetReps,startReps:je?.reps||0});break;case"distance":E[Se.key]?.targetDistance&&(Ne[Se.key]={targetType:"distance",targetDistance:E[Se.key].targetDistance,startDistance:je?.distance||0});break;default:(E[Se.key]?.targetWeight||E[Se.key]?.targetReps)&&(Ne[Se.key]={targetWeight:E[Se.key].targetWeight||0,targetReps:E[Se.key].targetReps||0,startWeight:je?.weight||0,startReps:je?.reps||0})}}),await Ss(He(pe,"juniorPBTargets",H),{clientId:mt.id,targets:Ne,metricTargets:me,updatedAt:_t.now()}),Ae(Ne),M(Ne),At("Targets saved!","success"),F(!1)}catch(H){console.error("Error saving targets:",H),At("Failed to save targets.","error")}p(!1)},ps=(H,_e)=>{I(Ne=>({...Ne,[H]:{...Ne[H],targetValue:_e===""?"":parseFloat(_e)}}))},Wt=async()=>{p(!0);try{const H=`targets_${mt.id}`,_e={};Lo.forEach(Ne=>{if(q[Ne.key]?.targetValue){const Se=$e?.bodyMetrics?.[Ne.key]||0;_e[Ne.key]={targetValue:q[Ne.key].targetValue,startValue:Se}}}),await Ss(He(pe,"juniorPBTargets",H),{clientId:mt.id,targets:ye,metricTargets:_e,updatedAt:_t.now()}),R(_e),I(_e),At("Metric targets saved!","success"),D(!1)}catch(H){console.error("Error saving metric targets:",H),At("Failed to save targets.","error")}p(!1)},we=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){p(!0);try{const H=He(pe,"juniorPBTargets",`targets_${mt.id}`);await Sr(H),Ae({}),R({}),M({}),I({}),At("All goals have been reset","success")}catch(H){console.error("Error resetting targets:",H),At("Failed to reset goals","error")}p(!1)}},G=(H,_e)=>{const Ne=ye[H];if(!Ne||!_e)return null;if(Ne.targetType==="time"){if(!Ne.targetValue)return null;const Ze=Ne.startValue||0,kt=Ne.targetValue,Et=_e.time||0,Cs=kt-Ze;return Cs<=0?Et>=kt?1:0:Math.max(0,Math.min((Et-Ze)/Cs,1))}if(Ne.targetType==="reps"){if(!Ne.targetReps)return null;const Ze=Ne.startReps||0,kt=Ne.targetReps,Et=_e.reps||0,Cs=kt-Ze;return Cs<=0?Et>=kt?1:0:Math.max(0,Math.min((Et-Ze)/Cs,1))}if(Ne.targetType==="distance"){if(!Ne.targetDistance)return null;const Ze=Ne.startDistance||0,kt=Ne.targetDistance,Et=_e.distance||0,Cs=kt-Ze;return Cs<=0?Et>=kt?1:0:Math.max(0,Math.min((Et-Ze)/Cs,1))}if(!Ne.targetWeight&&!Ne.targetReps)return null;const Se=(Ne.startWeight||0)*(Ne.startReps||0),je=(Ne.targetWeight||0)*(Ne.targetReps||0),ct=(_e.weight||0)*(_e.reps||0),xt=je-Se;return xt<=0?ct>=je?1:0:Math.max(0,Math.min((ct-Se)/xt,1))},he=H=>{const _e=me[H];if(!_e||!_e.targetValue)return null;const Ne=$e?.bodyMetrics?.[H];if(Ne==null)return null;const Se=_e.startValue||0,je=_e.targetValue,ct=je-Se;return ct===0?Ne===je?1:0:Math.max(0,Math.min((Ne-Se)/ct,1))},Ee=H=>{it.current=H.touches[0].clientX,pt.current=0},Oe=H=>{pt.current=H.touches[0].clientX-it.current},ke=()=>{pt.current<-50?Ht(g+1):pt.current>50&&Ht(g-1),pt.current=0},Qe=H=>{const _e=$e?.bodyMetrics?.[H],Ne=Ns?.bodyMetrics?.[H];return _e==null||Ne==null?null:parseFloat((_e-Ne).toFixed(2))},ot=t.find(H=>H.month===se),Y=t.find(H=>H.month===ue);if(ne||l)return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsxs("main",{className:"pb-main",children:[r.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),r.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!Ms||!dt||!mt)return null;const re=ba[g],We=$e?.benchmarks?.[re.key],Ge=Ns?.benchmarks?.[re.key],rt=Bl(re,We),bt=Bl(re,Ge),jt=sg(rt,bt),gt=G(re.key,We),Gt=gt!==null,Gs=gt!==null&&gt>=1,os=Gt?Math.round(gt*60):rt>0?15:0,ks=ye[re.key],Us=H=>H?H.targetType==="time"?`${H.startValue||0}s  ${H.targetValue}s`:H.targetType==="reps"?`${H.startReps||0}  ${H.targetReps} reps`:H.targetType==="distance"?`${H.startDistance||0}  ${H.targetDistance}cm`:`${H.startWeight||0}kg${H.startReps||0}  ${H.targetWeight}kg${H.targetReps}`:null;return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>Pt("/client"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsxs("main",{className:"pb-main page-transition-enter",children:[r.jsxs("div",{className:"pb-intro",children:[r.jsx("h2",{children:"Junior Strength Tests"}),r.jsx("p",{children:"Track your strength test results and body measurements each month."})]}),r.jsxs("div",{className:"pb-tabs",children:[r.jsx("button",{className:`pb-tab ${n==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),r.jsx("button",{className:`pb-tab ${n==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),r.jsx("button",{className:`pb-tab ${n==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),n==="bests"&&r.jsxs("div",{className:"pb-strength-section",children:[!x&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-carousel",ref:Le,onTouchStart:Ee,onTouchMove:Oe,onTouchEnd:ke,children:[r.jsx("div",{className:`pb-ring-container slide-from-${Ye.current}`,children:r.jsxs("div",{className:"pb-ring",children:[r.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:tb.map((H,_e)=>{const Ne=_e<Math.round(os);return r.jsx("line",{x1:H.x1,y1:H.y1,x2:H.x2,y2:H.y2,className:`pb-ring-tick ${Ne?Gs?"hit":"filled":"empty"}`,strokeWidth:H.thick?"3":"2"},_e)})}),r.jsxs("div",{className:"pb-ring-center",children:[r.jsx("div",{className:"pb-ring-category",children:re.category}),r.jsxs("div",{className:"pb-ring-exercise",children:[re.name,Ut("strength",re.key)&&r.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),r.jsx("div",{className:"pb-ring-value",children:We?mh(re,We):"-"}),jt!==null&&r.jsxs("div",{className:`pb-ring-change ${jt>=0?"positive":"negative"}`,children:[jt>=0?"+":"",jt.toFixed(1),"%"]}),jt===null&&We&&r.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),ks&&r.jsx("div",{className:`pb-ring-target ${Gs?"hit":""}`,children:Gs?"Target hit!":Us(ks)}),!ks&&r.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},g),r.jsx("div",{className:"pb-carousel-dots",children:ba.map((H,_e)=>r.jsx("button",{className:`pb-dot ${_e===g?"active":""}`,onClick:()=>Ht(_e)},_e))}),r.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>Ht(g-1),disabled:g===0,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),r.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>Ht(g+1),disabled:g===ba.length-1,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),r.jsxs("div",{className:"pb-trend-section",children:[r.jsx("h4",{children:"Trend"}),r.jsx(yP,{data:t,exerciseKey:re.key,unit:re.unit})]})]}),!x&&!$&&r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>j(!0),children:$e?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>F(!0),children:Object.keys(ye).length>0?"Edit Targets":"Set Targets"}),(Object.keys(ye).length>0||Object.keys(me).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:we,disabled:d,children:"Reset All Goals"})]}),x&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Benchmarks - ",va(nt)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{j(!1),te($e?.benchmarks||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:ba.map(H=>r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:H.name}),H.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:V[H.key]?.weight??"",onChange:_e=>Is(H.key,"weight",_e.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",value:V[H.key]?.reps??"",onChange:_e=>Is(H.key,"reps",_e.target.value),placeholder:"0"})]})]}):H.unit==="reps"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Reps (max in 1 min)"}),r.jsx("input",{type:"number",value:V[H.key]?.reps??"",onChange:_e=>Is(H.key,"reps",_e.target.value),placeholder:"0"})]})}):H.unit==="distance"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Distance (cm)"}),r.jsx("input",{type:"number",step:"0.5",value:V[H.key]?.distance??"",onChange:_e=>Is(H.key,"distance",_e.target.value),placeholder:"0"})]})}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Time (seconds)"}),r.jsx("input",{type:"number",step:"0.01",value:V[H.key]?.time??"",onChange:_e=>Is(H.key,"time",_e.target.value),placeholder:"0"})]})})]},H.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{j(!1),te($e?.benchmarks||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:St,disabled:d,children:d?"Saving...":"Save"})]})]}),$&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Set Your Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{F(!1),M(ye)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),ba.map(H=>{const _e=$e?.benchmarks?.[H.key];let Ne="-";if(_e)switch(H.unit){case"weight":(_e.weight||_e.reps)&&(Ne=`${_e.weight||0}kg  ${_e.reps||0}`);break;case"time":_e.time&&(Ne=`${_e.time}s`);break;case"reps":_e.reps&&(Ne=`${_e.reps} reps`);break;case"distance":_e.distance&&(Ne=`${_e.distance} cm`);break}return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:H.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",Ne]})]}),H.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:E[H.key]?.targetWeight??"",onChange:Se=>Js(H.key,"targetWeight",Se.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Reps"}),r.jsx("input",{type:"number",value:E[H.key]?.targetReps??"",onChange:Se=>Js(H.key,"targetReps",Se.target.value),placeholder:"0"})]})]}):H.unit==="reps"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target Reps (in 1 min)"}),r.jsx("input",{type:"number",value:E[H.key]?.targetReps??"",onChange:Se=>Js(H.key,"targetReps",Se.target.value),placeholder:"0"})]})}):H.unit==="distance"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target Distance (cm)"}),r.jsx("input",{type:"number",step:"0.5",value:E[H.key]?.targetDistance??"",onChange:Se=>Js(H.key,"targetDistance",Se.target.value),placeholder:"0"})]})}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target (seconds)"}),r.jsx("input",{type:"number",step:"1",value:E[H.key]?.targetValue??"",onChange:Se=>Js(H.key,"targetValue",Se.target.value),placeholder:"0"})]})})]},H.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{F(!1),M(ye)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Lt,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="metrics"&&r.jsxs("div",{className:"pb-metrics-section",children:[!T&&!O&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-metrics-card",children:[r.jsx("h3",{children:"Body Measurements"}),r.jsx("p",{className:"pb-metrics-month",children:va(nt)}),r.jsx("div",{className:"pb-metrics-list",children:Lo.map(H=>{const _e=$e?.bodyMetrics?.[H.key],Ne=Qe(H.key),Se=me[H.key],je=he(H.key),ct=je!==null&&je>=1;return r.jsxs("div",{className:"pb-metric-row",children:[r.jsxs("div",{className:"pb-metric-top",children:[r.jsxs("div",{className:"pb-metric-left",children:[r.jsxs("span",{className:"pb-metric-name",children:[H.name,Ut("metric",H.key)&&r.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),Se&&r.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",Se.targetValue," ",H.suffix]})]}),r.jsxs("div",{className:"pb-metric-values",children:[r.jsx("span",{className:"pb-metric-current",children:_e!=null?`${_e} ${H.suffix}`:"-"}),Ne!==null&&r.jsxs("span",{className:`pb-metric-change ${Ne>0?"up":Ne<0?"down":"same"}`,children:[Ne>0?"+":"",Ne," ",H.suffix]})]})]}),je!==null&&r.jsxs("div",{className:"pb-metric-progress",children:[r.jsx("div",{className:"pb-metric-bar",children:r.jsx("div",{className:`pb-metric-bar-fill ${ct?"hit":""}`,style:{width:`${Math.round(je*100)}%`}})}),r.jsx("span",{className:`pb-metric-percent ${ct?"hit":""}`,children:ct?"Hit!":`${Math.round(je*100)}%`})]})]},H.key)})})]}),r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>B(!0),children:$e?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>D(!0),children:Object.keys(me).length>0?"Edit Targets":"Set Targets"}),(Object.keys(ye).length>0||Object.keys(me).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:we,disabled:d,children:"Reset All Goals"})]})]}),T&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Measurements - ",va(nt)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{B(!1),ae($e?.bodyMetrics||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:Lo.map(H=>r.jsx("div",{className:"pb-edit-metric",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:[H.name," (",H.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:K[H.key]??"",onChange:_e=>zt(H.key,_e.target.value),placeholder:"0"})]})},H.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{B(!1),ae($e?.bodyMetrics||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:is,disabled:d,children:d?"Saving...":"Save"})]})]}),O&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Body Metric Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{D(!1),I(me)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),Lo.map(H=>{const _e=$e?.bodyMetrics?.[H.key];return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:H.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",_e!=null?`${_e} ${H.suffix}`:"-"]})]}),r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:["Target (",H.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:q[H.key]?.targetValue??"",onChange:Ne=>ps(H.key,Ne.target.value),placeholder:"0"})]})})]},H.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{D(!1),I(me)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Wt,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="history"&&r.jsx("div",{className:"pb-history-section",children:t.length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("h4",{children:"No records yet"}),r.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):r.jsxs(r.Fragment,{children:[qe.length>0&&r.jsxs("div",{className:"pb-achievements-wall",children:[r.jsxs("h4",{className:"pb-achievements-wall-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),r.jsx("div",{className:"pb-achievements-list",children:[...qe].reverse().map((H,_e)=>r.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${_e*.05}s`},children:[r.jsx("div",{className:"pb-achievement-star",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("div",{className:"pb-achievement-info",children:[r.jsx("span",{className:"pb-achievement-label",children:H.label}),r.jsx("span",{className:"pb-achievement-date",children:va(H.achievedMonth)})]})]},_e))})]}),r.jsx("div",{className:"pb-history-controls",children:r.jsx("button",{className:`pb-compare-toggle ${ee?"active":""}`,onClick:()=>{L(!ee),!ee&&t.length>=2&&(De(t[0].month),ze(t[t.length-1].month))},children:ee?"Back to Timeline":"Compare Months"})}),ee?r.jsxs("div",{className:"pb-compare",children:[r.jsxs("div",{className:"pb-compare-selectors",children:[r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"From"}),r.jsx("select",{value:se,onChange:H=>De(H.target.value),children:t.map(H=>r.jsx("option",{value:H.month,children:va(H.month)},H.month))})]}),r.jsx("div",{className:"pb-compare-vs",children:"vs"}),r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"To"}),r.jsx("select",{value:ue,onChange:H=>ze(H.target.value),children:t.map(H=>r.jsx("option",{value:H.month,children:va(H.month)},H.month))})]})]}),ot&&Y&&r.jsxs("div",{className:"pb-compare-results",children:[r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Strength Tests"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Exercise"}),r.jsx("span",{children:va(se).split(" ")[0]}),r.jsx("span",{children:va(ue).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),ba.map(H=>{const _e=ot.benchmarks?.[H.key],Ne=Y.benchmarks?.[H.key],Se=Bl(H,_e),je=Bl(H,Ne),ct=sg(je,Se);return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:H.name}),r.jsx("span",{className:"pb-compare-val",children:_e?mh(H,_e):"-"}),r.jsx("span",{className:"pb-compare-val",children:Ne?mh(H,Ne):"-"}),r.jsx("span",{className:`pb-compare-change ${ct!==null?ct>=0?"positive":"negative":""}`,children:ct!==null?`${ct>=0?"+":""}${ct.toFixed(1)}%`:"-"})]},H.key)})]})]}),r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Body Measurements"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Measurement"}),r.jsx("span",{children:va(se).split(" ")[0]}),r.jsx("span",{children:va(ue).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),Lo.map(H=>{const _e=ot.bodyMetrics?.[H.key],Ne=Y.bodyMetrics?.[H.key],Se=_e!=null&&Ne!=null?parseFloat((Ne-_e).toFixed(2)):null;return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:H.name}),r.jsx("span",{className:"pb-compare-val",children:_e!=null?`${_e}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:Ne!=null?`${Ne}`:"-"}),r.jsx("span",{className:`pb-compare-change ${Se!==null?Se>0?"positive":Se<0?"negative":"neutral":""}`,children:Se!==null?`${Se>0?"+":""}${Se} ${H.suffix}`:"-"})]},H.key)})]})]})]})]}):r.jsx("div",{className:"pb-timeline",children:[...t].reverse().map((H,_e)=>{const Ne=t.filter(Se=>Se.month<H.month).pop();return r.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${_e*.05}s`},children:[r.jsx("div",{className:"pb-timeline-dot"}),r.jsxs("div",{className:"pb-timeline-card",children:[r.jsx("h4",{children:va(H.month)}),H.benchmarks&&Object.keys(H.benchmarks).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Strength Tests"}),ba.map(Se=>{const je=H.benchmarks[Se.key];if(!je)return null;const ct=Ne?.benchmarks?.[Se.key],xt=Bl(Se,je),Ze=Bl(Se,ct),kt=sg(xt,Ze);return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:Se.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsx("span",{className:"pb-timeline-value",children:mh(Se,je)}),kt!==null&&r.jsxs("span",{className:`pb-timeline-change ${kt>=0?"positive":"negative"}`,children:[kt>=0?"+":"",kt.toFixed(1),"%"]})]})]},Se.key)})]}),H.bodyMetrics&&Object.keys(H.bodyMetrics).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Body Measurements"}),Lo.map(Se=>{const je=H.bodyMetrics[Se.key];if(je==null)return null;const ct=Ne?.bodyMetrics?.[Se.key],xt=ct!=null?parseFloat((je-ct).toFixed(2)):null;return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:Se.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsxs("span",{className:"pb-timeline-value",children:[je," ",Se.suffix]}),xt!==null&&r.jsxs("span",{className:`pb-timeline-change ${xt>0?"positive":xt<0?"negative":"neutral"}`,children:[xt>0?"+":"",xt," ",Se.suffix]})]})]},Se.key)})]})]})]},H.id)})})]})})]}),W&&r.jsx("div",{className:"pb-celebration-overlay",onClick:()=>de(null),children:r.jsxs("div",{className:"pb-celebration-card",children:[r.jsx("div",{className:"pb-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pb-celebration-title",children:W.length===1?"Target Achieved!":`${W.length} Targets Achieved!`}),r.jsx("div",{className:"pb-celebration-badges",children:W.map((H,_e)=>r.jsx("div",{className:"pb-celebration-badge",children:H.label},_e))}),r.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),Ie&&r.jsxs("div",{className:`toast-notification ${Ie.type}`,children:[r.jsx("span",{className:"toast-icon",children:Ie.type==="success"?r.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),r.jsx("span",{className:"toast-message",children:Ie.message}),r.jsx("button",{className:"toast-close",onClick:()=>Ve(null),children:""})]}),r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:"block-nav-tab",onClick:()=>Pt("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),r.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),r.jsx("span",{children:"Home"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>Pt("/client/forms"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),r.jsx("polyline",{points:"14 2 14 8 20 8"}),r.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),r.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),r.jsx("span",{children:"Forms"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>Pt("/client/tools"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),r.jsx("span",{children:"Tools"})]}),r.jsxs("button",{className:"block-nav-tab active",children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20V10"}),r.jsx("path",{d:"M18 20V4"}),r.jsx("path",{d:"M6 20v-4"})]}),r.jsx("span",{children:"PBs"})]}),mt?.circuitAccess&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>Pt("/client/circuit"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 6v6l4 2"})]}),r.jsx("span",{children:"Circuit"})]})]})]})}const $k=[{name:"Dumbbell Floor Press",type:"weighted",equipment:"dumbbells",group:"push",pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",equipment:"dumbbells",group:"push",pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Tricep Dips",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Pike Push Ups",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/pike push ups.GIF"},{name:"Reverse Plank",type:"timed",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/reverse plank.GIF"},{name:"Dumbbell Squeeze Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Pullover",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Fly",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Tricep Kickback",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Shrug",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Y-Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Wide Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Diamond Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Decline Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Wall Walks",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Press Up Hold",type:"timed",equipment:"bodyweight",group:"push",storagePath:null},{name:"Shoulder Tap Hold",type:"timed",equipment:"bodyweight",group:"push",storagePath:null},{name:"Dumbbell Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Bicep Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Renegade Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Reverse Fly",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Concentration Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Wrist Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Reverse Snow Angel",type:"reps",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Isometric Bicep Hold",type:"timed",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Dumbbell Goblet Squats",type:"weighted",equipment:"dumbbells",group:"lower",pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Romanian Deadlifts",type:"weighted",equipment:"dumbbells",group:"lower",pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Sumo Squats",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"1 Legged RDL",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/1 legged rdl.GIF"},{name:"Dumbbell Box Step Ups",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.GIF"},{name:"Dumbbell Reverse Lunges",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.GIF"},{name:"Kettlebell Romanian Deadlift",type:"weighted",equipment:"kettlebell",group:"lower",storagePath:"exercises/kettlebells/lower/kettlebell romanian deadlift.mp4"},{name:"Reverse Lunge",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/reverse lunge.GIF"},{name:"Box Step Ups",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/box step ups.GIF"},{name:"Bulgarian Split Squats",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Jump Squats",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Hip Thrusts",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/hip thrusts.GIF"},{name:"Donkey Kicks",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/donkey kicks.GIF"},{name:"Skater Jumps",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/skater jumps.GIF"},{name:"Squat And Hold",type:"timed",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/squat and hold.GIF"},{name:"Forearm Plank",type:"timed",equipment:"bodyweight",group:"core",pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Side Plank",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Side Plank.mp4"},{name:"Hollow Body Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Superman Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Superman Hold.mp4"},{name:"Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Fast Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Fast Mountain Climbers.mp4"},{name:"Cross Body Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Russian Twist",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Crunch",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Bicycle Crunch",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Leg Raises",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Dead Bug",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Dead Bug Single Leg Drop",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Bird Dog",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Flutter Kicks",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Hollow Hold Flutter Kicks",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"},{name:"High Plank Shoulder Taps",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"},{name:"Hip Dips Plank",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Single Leg V-Up",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Single Leg V-Up.mp4"},{name:"Hollow Hold To V-Sit",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"},{name:"Toe Reaches",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/toe reaches.GIF"},{name:"Side Plank Rotation",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Plank Walkout",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Russian Twists Dumbbell",type:"weighted",equipment:"dumbbells",group:"core",storagePath:"exercises/dumbbells/core/russian twists dumbbell.GIF"},{name:"Kettlebell Russian Twist",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",type:"reps",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Back Extension Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:null},{name:"Dumbbell Plank Pull Through",type:"weighted",equipment:"dumbbells",group:"core",storagePath:null}];$k.filter(n=>n.storagePath!==null);const vP=[{key:"push",label:"Push",subtitle:"Chest / Shoulders / Triceps",color:"#A12F3A",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4"},{key:"pull",label:"Pull",subtitle:"Back / Biceps",color:"#2196f3",icon:"M4 12h16M12 4v16M7 7l10 10M17 7L7 17"},{key:"lower",label:"Lower",subtitle:"Legs / Glutes",color:"#ff9800",icon:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"},{key:"core",label:"Core",subtitle:"Abs / Stability",color:"#7c3aed",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"}],Wk={};$k.forEach(n=>{Wk[n.name]=n.group});function xP(n){return Wk[n]||null}const Da=[{key:"chestPress",name:"Chest Press",category:"Upper Body - Push",unit:"weight"},{key:"shoulderPress",name:"Shoulder Press",category:"Upper Body - Push",unit:"weight"},{key:"seatedRow",name:"Seated Row",category:"Upper Body - Pull",unit:"weight"},{key:"latPulldown",name:"Lat Pulldown",category:"Upper Body - Pull",unit:"weight"},{key:"squat",name:"Squat",category:"Lower Body",unit:"weight"},{key:"deadlift",name:"Deadlift",category:"Lower Body",unit:"weight"},{key:"plank",name:"Plank",category:"Core",unit:"time"}],Oo=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function wP(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}function xa(n){const[e,t]=n.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function fh(n){if(!n&&n!==0)return"-";const e=Math.floor(n/60),t=(n%60).toFixed(2);return e>0?`${e}m ${parseFloat(t).toFixed(0)}s`:`${parseFloat(t).toFixed(2)}s`}function P2(n,e){return!n&&n!==0?"-":!e&&e!==0?`${n}kg`:`${n}kg x ${e}`}function Vl(n,e){return e?n.unit==="time"?e.time||0:(e.weight||0)*(e.reps||0):0}function ng(n,e){return!e||e===0?null:(n-e)/e*100}function _P({data:n,exerciseKey:e,unit:t}){if(!n||n.length<2)return r.jsx("div",{className:"pb-trend-empty",children:r.jsx("p",{children:"Not enough data for trend line yet"})});const i=n.map(F=>{const V=F.benchmarks?.[e];return V?t==="time"?V.time||0:(V.weight||0)*(V.reps||0):0}),l=Math.max(...i),u=Math.min(...i),d=l-u||1,p=300,g=100,y=20,x=p-y*2,j=g-y*2,T=i.map((F,V)=>{const te=y+V/(i.length-1)*x,K=y+j-(F-u)/d*j;return{x:te,y:K,value:F}}),B=T.map((F,V)=>`${V===0?"M":"L"} ${F.x} ${F.y}`).join(" "),$=B+` L ${T[T.length-1].x} ${y+j} L ${T[0].x} ${y+j} Z`;return r.jsxs("div",{className:"pb-trend-chart",children:[r.jsxs("svg",{viewBox:`0 0 ${p} ${g}`,preserveAspectRatio:"xMidYMid meet",children:[r.jsx("defs",{children:r.jsxs("linearGradient",{id:"trendGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[r.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),r.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),r.jsx("path",{d:$,fill:"url(#trendGradient)"}),r.jsx("path",{d:B,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),T.map((F,V)=>r.jsx("circle",{cx:F.x,cy:F.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},V))]}),r.jsx("div",{className:"pb-trend-labels",children:n.map((F,V)=>r.jsxs("span",{className:"pb-trend-label",children:[F.month.split("-")[1],"/",F.month.split("-")[0].slice(2)]},V))})]})}function kP(){const[n,e]=v.useState("bests"),[t,i]=v.useState([]),[l,u]=v.useState(!0),[d,p]=v.useState(!1),[g,y]=v.useState(0),[x,j]=v.useState(!1),[T,B]=v.useState(!1),[$,F]=v.useState(!1),[V,te]=v.useState({}),[K,ae]=v.useState({}),[ye,Ae]=v.useState({}),[me,R]=v.useState({}),[E,M]=v.useState({}),[O,D]=v.useState(!1),[q,I]=v.useState({}),[qe,ft]=v.useState([]),[W,de]=v.useState(null),[Ie,Ve]=v.useState(null),[ee,L]=v.useState(!1),[se,De]=v.useState(""),[ue,ze]=v.useState(""),[Le,it]=v.useState({}),[pt,Ye]=v.useState({}),[Ht,Ms]=v.useState(null),[dt,mt]=v.useState(null),[ne,Rt]=v.useState(""),[Pt,At]=v.useState({}),vt=v.useRef(null),nt=v.useRef(0),$e=v.useRef(0),$t=v.useRef("right"),Ns=v.useCallback(k=>{y(N=>{const P=Math.max(0,Math.min(Da.length-1,k));return P===N?N:($t.current=P>N?"right":"left",P)})},[]),{currentUser:Ws,isClient:Ut,clientData:St,loading:is}=Ur(),{isDark:Is}=Na(),zt=er(),[Js]=cS(),Lt=Js.get("mode")==="corebuddy",ps=!Lt&&(!St?.clientType||St.clientType==="block"),Wt=v.useCallback((k,N="info")=>{Ve({message:k,type:N}),setTimeout(()=>Ve(null),4e3)},[]);v.useEffect(()=>{!is&&(!Ws||!Ut)&&zt("/")},[Ws,Ut,is,zt]),v.useEffect(()=>{St&&(ps?we():(async()=>{try{const[N,P,U]=await Promise.all([As(He(pe,"coreBuddyPBs",St.id)),As(He(pe,"coreBuddyTargets",St.id)),As(He(pe,"coreBuddyAchievements",St.id))]);N.exists()&&it(N.data().exercises||{}),P.exists()&&Ye(P.data().targets||{}),U.exists()&&Ms(U.data())}catch(N){console.error("Error loading Core Buddy PBs:",N)}u(!1)})())},[St]);const we=async()=>{try{const k=Os(Ot(pe,"personalBests"),fs("clientId","==",St.id)),P=(await Es(k)).docs.map(st=>({id:st.id,...st.data()}));P.sort((st,et)=>st.month.localeCompare(et.month)),i(P);const U=Os(Ot(pe,"personalBestTargets"),fs("clientId","==",St.id)),fe=await Es(U);if(!fe.empty){const st=fe.docs[0].data();Ae(st.targets||{}),R(st.metricTargets||{}),M(st.targets||{}),I(st.metricTargets||{})}const Ue=Os(Ot(pe,"achievements"),fs("clientId","==",St.id)),Fe=await Es(Ue);Fe.empty||ft(Fe.docs[0].data().badges||[])}catch(k){console.error("Error fetching personal bests:",k)}u(!1)},G=async()=>{if(!dt||!ne||!St)return;const k=parseFloat(ne),N=Le[dt];if(!N||k<=N.weight){Wt("Target must be higher than current PB","error");return}p(!0);try{const P={...pt,[dt]:{targetWeight:k,setAt:_t.now(),currentPBWhenSet:N.weight}};await Ss(He(pe,"coreBuddyTargets",St.id),{clientId:St.id,targets:P,updatedAt:_t.now()}),Ye(P),mt(null),Rt(""),Wt("Target set!","success")}catch(P){console.error("Error saving target:",P),Wt("Failed to save target","error")}p(!1)},he=k=>{if(!Ht?.badges)return!1;const N=pt[k];return N?Ht.badges.some(P=>P.type==="pb_target"&&P.exercise===k&&P.targetWeight===N.targetWeight):!1},Ee=k=>{const N=pt[k];if(!N)return null;const P=Le[k];if(!P)return 0;const U=N.currentPBWhenSet||0,fe=N.targetWeight,Ue=fe-U;return Ue<=0?P.weight>=fe?1:0:Math.max(0,Math.min((P.weight-U)/Ue,1))},Oe=wP(),ke=t.find(k=>k.month===Oe),Qe=t.filter(k=>k.month<Oe),ot=Qe.length>0?Qe[Qe.length-1]:null;v.useEffect(()=>{ke?(te(ke.benchmarks||{}),ae(ke.bodyMetrics||{})):(te({}),ae({}))},[ke?.id]);const Y=async(k,N)=>{const P=[];if(k==="strength"?Da.forEach(U=>{const fe=ye[U.key];if(!fe)return;const Ue=N[U.key];if(!Ue)return;let Fe;if(fe.targetType==="time"){if(!fe.targetValue)return;const st=fe.startValue||0,et=Ue.time||0,ss=fe.targetValue-st;Fe=ss===0?et>=fe.targetValue?1:0:Math.max(0,(et-st)/ss)}else{if(!fe.targetWeight&&!fe.targetReps)return;const st=(fe.startWeight||0)*(fe.startReps||0),et=(fe.targetWeight||0)*(fe.targetReps||0),ss=(Ue.weight||0)*(Ue.reps||0),js=et-st;Fe=js===0?ss>=et?1:0:Math.max(0,(ss-st)/js)}if(Fe>=1&&!(fe.targetType==="time"?qe.some(et=>et.type==="strength"&&et.key===U.key&&et.targetValue===fe.targetValue):qe.some(et=>et.type==="strength"&&et.key===U.key&&et.targetWeight===fe.targetWeight&&et.targetReps===fe.targetReps))){const et=fe.targetType==="time"?`${U.name} ${fe.targetValue}s`:`${U.name} ${fe.targetWeight}kg  ${fe.targetReps}`;P.push({type:"strength",key:U.key,...fe.targetType==="time"?{targetType:"time",targetValue:fe.targetValue}:{targetWeight:fe.targetWeight,targetReps:fe.targetReps},achievedMonth:Oe,label:et})}}):Oo.forEach(U=>{const fe=me[U.key];if(!fe||!fe.targetValue)return;const Ue=N[U.key];if(Ue==null)return;const Fe=fe.startValue||0,st=fe.targetValue,et=st-Fe;(et===0?Ue===st?1:0:Math.max(0,(Ue-Fe)/et))>=1&&(qe.some(us=>us.type==="metric"&&us.key===U.key&&us.targetValue===st)||P.push({type:"metric",key:U.key,targetValue:st,achievedMonth:Oe,label:`${U.name} ${st}${U.suffix}`}))}),P.length>0){const U=[...qe,...P];await Ss(He(pe,"achievements",St.id),{clientId:St.id,badges:U,updatedAt:_t.now()}),ft(U),de(P),setTimeout(()=>de(null),5e3)}},re=(k,N)=>{if(k==="strength"){const P=ye[N];return P?P.targetType==="time"?qe.some(U=>U.type==="strength"&&U.key===N&&U.targetValue===P.targetValue):!P.targetWeight&&!P.targetReps?!1:qe.some(U=>U.type==="strength"&&U.key===N&&U.targetWeight===P.targetWeight&&U.targetReps===P.targetReps):!1}else{const P=me[N];return!P||!P.targetValue?!1:qe.some(U=>U.type==="metric"&&U.key===N&&U.targetValue===P.targetValue)}},We=async()=>{p(!0);try{const k=`${St.id}_${Oe}`,N=ke||{};await Ss(He(pe,"personalBests",k),{clientId:St.id,month:Oe,benchmarks:V,bodyMetrics:N.bodyMetrics||K||{},createdAt:N.createdAt||_t.now(),updatedAt:_t.now()}),await Y("strength",V),Wt("Benchmarks saved!","success"),j(!1),await we()}catch(k){console.error("Error saving benchmarks:",k),Wt("Failed to save. Please try again.","error")}p(!1)},Ge=async()=>{p(!0);try{const k=`${St.id}_${Oe}`,N=ke||{};await Ss(He(pe,"personalBests",k),{clientId:St.id,month:Oe,benchmarks:N.benchmarks||V||{},bodyMetrics:K,createdAt:N.createdAt||_t.now(),updatedAt:_t.now()}),await Y("metric",K),Wt("Body metrics saved!","success"),B(!1),await we()}catch(k){console.error("Error saving metrics:",k),Wt("Failed to save. Please try again.","error")}p(!1)},rt=(k,N,P)=>{te(U=>({...U,[k]:{...U[k],[N]:P===""?"":parseFloat(P)}}))},bt=(k,N)=>{ae(P=>({...P,[k]:N===""?"":parseFloat(N)}))},jt=(k,N,P)=>{M(U=>({...U,[k]:{...U[k],[N]:P===""?"":parseFloat(P)}}))},gt=async()=>{p(!0);try{const k=`targets_${St.id}`,N=ke?.benchmarks||{},P={};Da.forEach(U=>{const fe=N[U.key];U.unit==="time"?E[U.key]?.targetValue&&(P[U.key]={targetType:"time",targetValue:E[U.key].targetValue,startValue:fe?.time||0}):(E[U.key]?.targetWeight||E[U.key]?.targetReps)&&(P[U.key]={targetWeight:E[U.key].targetWeight||0,targetReps:E[U.key].targetReps||0,startWeight:fe?.weight||0,startReps:fe?.reps||0})}),await Ss(He(pe,"personalBestTargets",k),{clientId:St.id,targets:P,metricTargets:me,updatedAt:_t.now()}),Ae(P),M(P),Wt("Targets saved!","success"),F(!1)}catch(k){console.error("Error saving targets:",k),Wt("Failed to save targets.","error")}p(!1)},Gt=(k,N)=>{I(P=>({...P,[k]:{...P[k],targetValue:N===""?"":parseFloat(N)}}))},Gs=async()=>{p(!0);try{const k=`targets_${St.id}`,N={};Oo.forEach(P=>{if(q[P.key]?.targetValue){const U=ke?.bodyMetrics?.[P.key]||0;N[P.key]={targetValue:q[P.key].targetValue,startValue:U}}}),await Ss(He(pe,"personalBestTargets",k),{clientId:St.id,targets:ye,metricTargets:N,updatedAt:_t.now()}),R(N),I(N),Wt("Metric targets saved!","success"),D(!1)}catch(k){console.error("Error saving metric targets:",k),Wt("Failed to save targets.","error")}p(!1)},os=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){p(!0);try{const k=He(pe,"personalBestTargets",`targets_${St.id}`);await Sr(k),Ae({}),R({}),M({}),I({}),Wt("All goals have been reset","success")}catch(k){console.error("Error resetting targets:",k),Wt("Failed to reset goals","error")}p(!1)}},ks=(k,N)=>{const P=ye[k];if(!P||!N)return null;if(P.targetType==="time"){if(!P.targetValue)return null;const st=P.startValue||0,et=P.targetValue,ss=N.time||0,js=et-st;return js<=0?ss>=et?1:0:Math.max(0,Math.min((ss-st)/js,1))}if(!P.targetWeight&&!P.targetReps)return null;const U=(P.startWeight||0)*(P.startReps||0),fe=(P.targetWeight||0)*(P.targetReps||0),Ue=(N.weight||0)*(N.reps||0),Fe=fe-U;return Fe<=0?Ue>=fe?1:0:Math.max(0,Math.min((Ue-U)/Fe,1))},Us=k=>{const N=me[k];if(!N||!N.targetValue)return null;const P=ke?.bodyMetrics?.[k];if(P==null)return null;const U=N.startValue||0,fe=N.targetValue,Ue=fe-U;return Ue===0?P===fe?1:0:Math.max(0,Math.min((P-U)/Ue,1))},H=k=>{nt.current=k.touches[0].clientX,$e.current=0},_e=k=>{$e.current=k.touches[0].clientX-nt.current},Ne=()=>{$e.current<-50?Ns(g+1):$e.current>50&&Ns(g-1),$e.current=0},Se=k=>{const N=ke?.bodyMetrics?.[k],P=ot?.bodyMetrics?.[k];return N==null||P==null?null:parseFloat((N-P).toFixed(2))},je=t.find(k=>k.month===se),ct=t.find(k=>k.month===ue);if(is||l)return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsxs("main",{className:"pb-main",children:[r.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),r.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!Ws||!Ut||!St)return null;if(ps&&St?.isJunior)return r.jsx(bP,{});const xt=Da[g],Ze=ke?.benchmarks?.[xt.key],kt=ot?.benchmarks?.[xt.key],Et=Vl(xt,Ze),Cs=Vl(xt,kt),hn=ng(Et,Cs),gn=ks(xt.key,Ze),Tn=gn!==null,In=gn!==null&&gn>=1,yn=Tn?Math.round(gn*60):Et>0?15:0,zs=ye[xt.key];return r.jsx(Ta,{children:r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>zt(Lt?"/client/core-buddy":"/client"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsxs("main",{className:"pb-main page-transition-enter",children:[r.jsxs("div",{className:"pb-intro anim-fade-up",children:[r.jsx("h2",{children:"Personal Bests"}),r.jsx("p",{children:ps?"Track your strength benchmarks and body measurements each month.":"Your all-time best lifts from programme workouts."})]}),!ps&&r.jsxs("div",{className:"pb-cb-section anim-fade-up-d2",children:[Object.keys(Le).length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("div",{className:"pb-cb-empty-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})}),r.jsx("h4",{children:"No personal bests yet"}),r.jsx("p",{children:"Complete weight-based workouts to start tracking your personal bests."})]}):r.jsx("div",{className:"pb-cb-grouped",children:(()=>{const k={},N=[];return Object.entries(Le).forEach(([P,U])=>{const fe=xP(P);fe?(k[fe]||(k[fe]=[]),k[fe].push([P,U])):N.push([P,U])}),Object.values(k).forEach(P=>P.sort(([U],[fe])=>U.localeCompare(fe))),N.sort(([P],[U])=>P.localeCompare(U)),r.jsxs(r.Fragment,{children:[vP.map(P=>{const U=k[P.key];if(!U||U.length===0)return null;const fe=!!Pt[P.key],Ue=U.reduce((Fe,[,st])=>!Fe||st.weight>Fe.weight?st:Fe,null);return r.jsxs("div",{className:`pb-cb-group ${fe?"open":""}`,style:{"--group-color":P.color},children:[r.jsxs("button",{className:"pb-cb-group-header",onClick:()=>At(Fe=>({...Fe,[P.key]:!Fe[P.key]})),children:[r.jsx("div",{className:"pb-cb-group-accent"}),r.jsx("div",{className:"pb-cb-group-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:P.icon})})}),r.jsxs("div",{className:"pb-cb-group-text",children:[r.jsx("h3",{className:"pb-cb-group-label",children:P.label}),r.jsx("span",{className:"pb-cb-group-subtitle",children:P.subtitle})]}),r.jsxs("div",{className:"pb-cb-group-meta",children:[r.jsxs("span",{className:"pb-cb-group-count",children:[U.length," PB",U.length!==1?"s":""]}),Ue&&r.jsxs("span",{className:"pb-cb-group-best",children:["Best: ",Ue.weight,"kg"]})]}),r.jsx("svg",{className:`pb-cb-group-chevron ${fe?"open":""}`,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M6 9l6 6 6-6"})})]}),r.jsx("div",{className:"pb-cb-group-body",style:{display:fe?"block":"none"},children:r.jsx("div",{className:"pb-cb-grid",children:U.map(([Fe,st],et)=>{const ss=pt[Fe],js=Ee(Fe),us=js!==null&&js>=1,cs=he(Fe),qs=js!==null?Math.round(js*60):60;return r.jsxs("div",{className:"pb-cb-card",style:{"--group-color":P.color,animationDelay:`${et*.05}s`},children:[r.jsxs("div",{className:"pb-cb-card-top",children:[r.jsxs("div",{className:"pb-cb-card-ring",children:[r.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:T2.map((En,cr)=>{const ds=cr<qs;return r.jsx("line",{x1:En.x1,y1:En.y1,x2:En.x2,y2:En.y2,className:`pb-ring-tick ${ds?us?"hit":"filled":"empty"}`,style:ds&&!us?{stroke:P.color}:void 0,strokeWidth:En.thick?"2":"1.5"},cr)})}),r.jsx("div",{className:"pb-cb-ring-icon",style:{color:P.color},children:cs?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"pb-cb-badge-earned",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:P.icon})})})]}),r.jsxs("div",{className:"pb-cb-card-info",children:[r.jsx("h4",{className:"pb-cb-card-name",children:Fe}),r.jsxs("div",{className:"pb-cb-card-value",style:{color:P.color},children:[st.weight,"kg  ",st.reps]}),st.achievedAt&&r.jsx("div",{className:"pb-cb-card-date",children:(st.achievedAt.toDate?st.achievedAt.toDate():new Date(st.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),ss&&us&&!cs&&r.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"}),cs&&r.jsx("div",{className:"pb-cb-target-info earned",children:"Badge earned!"})]}),r.jsx("div",{className:"pb-cb-card-action",children:r.jsx("button",{className:"pb-cb-target-btn",style:{borderColor:P.color,background:`color-mix(in srgb, ${P.color} 10%, transparent)`,color:P.color},onClick:()=>{mt(Fe),Rt("")},children:ss?us&&cs?r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 5v14M5 12h14"})}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("circle",{cx:"12",cy:"12",r:"6"}),r.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]}),ss&&!us&&r.jsxs("div",{className:"pb-cb-card-progress",children:[r.jsxs("div",{className:"pb-cb-progress-labels",children:[r.jsxs("span",{className:"pb-cb-progress-current",children:[st.weight,"kg"]}),r.jsxs("span",{className:"pb-cb-progress-target",style:{color:P.color},children:["Target: ",ss.targetWeight,"kg"]})]}),r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill",style:{width:`${Math.round((js||0)*100)}%`,background:P.color}})}),r.jsxs("div",{className:"pb-cb-progress-pct",style:{color:P.color},children:[Math.round((js||0)*100),"%"]})]}),ss&&us&&r.jsx("div",{className:"pb-cb-card-progress",children:r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill hit",style:{width:"100%"}})})})]},Fe)})})})]},P.key)}),N.length>0&&(()=>{const P=!!Pt.other;return r.jsxs("div",{className:`pb-cb-group ${P?"open":""}`,style:{"--group-color":"var(--text-tertiary)"},children:[r.jsxs("button",{className:"pb-cb-group-header",onClick:()=>At(U=>({...U,other:!U.other})),children:[r.jsx("div",{className:"pb-cb-group-accent"}),r.jsx("div",{className:"pb-cb-group-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})}),r.jsx("div",{className:"pb-cb-group-text",children:r.jsx("h3",{className:"pb-cb-group-label",children:"Other"})}),r.jsx("div",{className:"pb-cb-group-meta",children:r.jsxs("span",{className:"pb-cb-group-count",children:[N.length," PB",N.length!==1?"s":""]})}),r.jsx("svg",{className:`pb-cb-group-chevron ${P?"open":""}`,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M6 9l6 6 6-6"})})]}),r.jsx("div",{className:"pb-cb-group-body",style:{display:P?"block":"none"},children:r.jsx("div",{className:"pb-cb-grid",children:N.map(([U,fe],Ue)=>{const Fe=pt[U],st=Ee(U),et=st!==null&&st>=1,ss=he(U),js=st!==null?Math.round(st*60):60;return r.jsxs("div",{className:"pb-cb-card",style:{animationDelay:`${Ue*.05}s`},children:[r.jsxs("div",{className:"pb-cb-card-top",children:[r.jsxs("div",{className:"pb-cb-card-ring",children:[r.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:T2.map((us,cs)=>{const qs=cs<js;return r.jsx("line",{x1:us.x1,y1:us.y1,x2:us.x2,y2:us.y2,className:`pb-ring-tick ${qs?et?"hit":"filled":"empty"}`,strokeWidth:us.thick?"2":"1.5"},cs)})}),r.jsx("div",{className:"pb-cb-ring-icon",children:ss?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"pb-cb-badge-earned",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})})]}),r.jsxs("div",{className:"pb-cb-card-info",children:[r.jsx("h4",{className:"pb-cb-card-name",children:U}),r.jsxs("div",{className:"pb-cb-card-value",children:[fe.weight,"kg  ",fe.reps]}),fe.achievedAt&&r.jsx("div",{className:"pb-cb-card-date",children:(fe.achievedAt.toDate?fe.achievedAt.toDate():new Date(fe.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),Fe&&et&&!ss&&r.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"}),ss&&r.jsx("div",{className:"pb-cb-target-info earned",children:"Badge earned!"})]}),r.jsx("div",{className:"pb-cb-card-action",children:r.jsx("button",{className:"pb-cb-target-btn",onClick:()=>{mt(U),Rt("")},children:Fe?et&&ss?r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 5v14M5 12h14"})}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("circle",{cx:"12",cy:"12",r:"6"}),r.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]}),Fe&&!et&&r.jsxs("div",{className:"pb-cb-card-progress",children:[r.jsxs("div",{className:"pb-cb-progress-labels",children:[r.jsxs("span",{className:"pb-cb-progress-current",children:[fe.weight,"kg"]}),r.jsxs("span",{className:"pb-cb-progress-target",children:["Target: ",Fe.targetWeight,"kg"]})]}),r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill",style:{width:`${Math.round((st||0)*100)}%`}})}),r.jsxs("div",{className:"pb-cb-progress-pct",children:[Math.round((st||0)*100),"%"]})]}),Fe&&et&&r.jsx("div",{className:"pb-cb-card-progress",children:r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill hit",style:{width:"100%"}})})})]},U)})})})]})})()]})})()}),Object.keys(Le).length>0&&r.jsxs("button",{className:"pb-cb-achievements-link anim-fade-up-d4",onClick:()=>zt("/client/core-buddy/achievements"),children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"View Achievements",r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),dt&&r.jsx("div",{className:"pb-cb-target-modal-overlay",onClick:()=>mt(null),children:r.jsxs("div",{className:"pb-cb-target-modal",onClick:k=>k.stopPropagation(),children:[r.jsx("h3",{children:"Set Target"}),r.jsx("p",{className:"pb-cb-target-exercise-name",children:dt}),r.jsxs("div",{className:"pb-cb-target-current",children:["Current PB: ",r.jsxs("strong",{children:[Le[dt]?.weight,"kg"]})]}),r.jsxs("div",{className:"pb-cb-target-input-wrap",children:[r.jsx("label",{children:"Your target (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",step:"0.5",value:ne,onChange:k=>Rt(k.target.value),placeholder:String((Le[dt]?.weight||0)+5),className:"pb-cb-target-input",autoFocus:!0})]}),r.jsxs("div",{className:"pb-cb-target-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>mt(null),children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:G,disabled:d,children:d?"Saving...":"Set Target"})]})]})})]}),ps&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-tabs",children:[r.jsx("button",{className:`pb-tab ${n==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),r.jsx("button",{className:`pb-tab ${n==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),r.jsx("button",{className:`pb-tab ${n==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),n==="bests"&&r.jsxs("div",{className:"pb-strength-section",children:[!x&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-carousel",ref:vt,onTouchStart:H,onTouchMove:_e,onTouchEnd:Ne,children:[r.jsx("div",{className:`pb-ring-container slide-from-${$t.current}`,children:r.jsxs("div",{className:"pb-ring",children:[r.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:tb.map((k,N)=>{const P=N<Math.round(yn);return r.jsx("line",{x1:k.x1,y1:k.y1,x2:k.x2,y2:k.y2,className:`pb-ring-tick ${P?In?"hit":"filled":"empty"}`,strokeWidth:k.thick?"3":"2"},N)})}),r.jsxs("div",{className:"pb-ring-center",children:[r.jsx("div",{className:"pb-ring-category",children:xt.category}),r.jsxs("div",{className:"pb-ring-exercise",children:[xt.name,re("strength",xt.key)&&r.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),r.jsx("div",{className:"pb-ring-value",children:Ze?xt.unit==="time"?fh(Ze.time):P2(Ze.weight,Ze.reps):"-"}),hn!==null&&r.jsxs("div",{className:`pb-ring-change ${hn>=0?"positive":"negative"}`,children:[hn>=0?"+":"",hn.toFixed(1),"%"]}),hn===null&&Ze&&r.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),zs&&r.jsx("div",{className:`pb-ring-target ${In?"hit":""}`,children:In?"Target hit!":zs.targetType==="time"?`${zs.startValue||0}s  ${zs.targetValue}s`:`${zs.startWeight||0}kg${zs.startReps||0}  ${zs.targetWeight}kg${zs.targetReps}`}),!zs&&r.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},g),r.jsx("div",{className:"pb-carousel-dots",children:Da.map((k,N)=>r.jsx("button",{className:`pb-dot ${N===g?"active":""}`,onClick:()=>Ns(N)},N))}),r.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>Ns(g-1),disabled:g===0,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),r.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>Ns(g+1),disabled:g===Da.length-1,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),r.jsxs("div",{className:"pb-trend-section",children:[r.jsx("h4",{children:"Trend"}),r.jsx(_P,{data:t,exerciseKey:xt.key,unit:xt.unit})]})]}),!x&&!$&&r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>j(!0),children:ke?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>F(!0),children:Object.keys(ye).length>0?"Edit Targets":"Set Targets"}),(Object.keys(ye).length>0||Object.keys(me).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:os,disabled:d,children:"Reset All Goals"})]}),x&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Benchmarks - ",xa(Oe)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{j(!1),te(ke?.benchmarks||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:Da.map(k=>r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:k.name}),k.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:V[k.key]?.weight??"",onChange:N=>rt(k.key,"weight",N.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",value:V[k.key]?.reps??"",onChange:N=>rt(k.key,"reps",N.target.value),placeholder:"0"})]})]}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Time (seconds)"}),r.jsx("input",{type:"number",step:"0.01",value:V[k.key]?.time??"",onChange:N=>rt(k.key,"time",N.target.value),placeholder:"0"})]})})]},k.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{j(!1),te(ke?.benchmarks||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:We,disabled:d,children:d?"Saving...":"Save"})]})]}),$&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Set Your Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{F(!1),M(ye)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),Da.map(k=>{const N=ke?.benchmarks?.[k.key];let P="-";return N&&(k.unit==="time"&&N.time?P=`${N.time}s`:(N.weight||N.reps)&&(P=`${N.weight||0}kg  ${N.reps||0}`)),r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:k.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",P]})]}),k.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:E[k.key]?.targetWeight??"",onChange:U=>jt(k.key,"targetWeight",U.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Reps"}),r.jsx("input",{type:"number",value:E[k.key]?.targetReps??"",onChange:U=>jt(k.key,"targetReps",U.target.value),placeholder:"0"})]})]}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target (seconds)"}),r.jsx("input",{type:"number",step:"1",value:E[k.key]?.targetValue??"",onChange:U=>jt(k.key,"targetValue",U.target.value),placeholder:"0"})]})})]},k.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{F(!1),M(ye)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:gt,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="metrics"&&r.jsxs("div",{className:"pb-metrics-section",children:[!T&&!O&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-metrics-card",children:[r.jsx("h3",{children:"Body Measurements"}),r.jsx("p",{className:"pb-metrics-month",children:xa(Oe)}),r.jsx("div",{className:"pb-metrics-list",children:Oo.map(k=>{const N=ke?.bodyMetrics?.[k.key],P=Se(k.key),U=me[k.key],fe=Us(k.key),Ue=fe!==null&&fe>=1;return r.jsxs("div",{className:"pb-metric-row",children:[r.jsxs("div",{className:"pb-metric-top",children:[r.jsxs("div",{className:"pb-metric-left",children:[r.jsxs("span",{className:"pb-metric-name",children:[k.name,re("metric",k.key)&&r.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),U&&r.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",U.targetValue," ",k.suffix]})]}),r.jsxs("div",{className:"pb-metric-values",children:[r.jsx("span",{className:"pb-metric-current",children:N!=null?`${N} ${k.suffix}`:"-"}),P!==null&&r.jsxs("span",{className:`pb-metric-change ${P>0?"up":P<0?"down":"same"}`,children:[P>0?"+":"",P," ",k.suffix]})]})]}),fe!==null&&r.jsxs("div",{className:"pb-metric-progress",children:[r.jsx("div",{className:"pb-metric-bar",children:r.jsx("div",{className:`pb-metric-bar-fill ${Ue?"hit":""}`,style:{width:`${Math.round(fe*100)}%`}})}),r.jsx("span",{className:`pb-metric-percent ${Ue?"hit":""}`,children:Ue?"Hit!":`${Math.round(fe*100)}%`})]})]},k.key)})})]}),r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>B(!0),children:ke?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>D(!0),children:Object.keys(me).length>0?"Edit Targets":"Set Targets"}),(Object.keys(ye).length>0||Object.keys(me).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:os,disabled:d,children:"Reset All Goals"})]})]}),T&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Measurements - ",xa(Oe)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{B(!1),ae(ke?.bodyMetrics||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:Oo.map(k=>r.jsx("div",{className:"pb-edit-metric",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:[k.name," (",k.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:K[k.key]??"",onChange:N=>bt(k.key,N.target.value),placeholder:"0"})]})},k.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{B(!1),ae(ke?.bodyMetrics||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Ge,disabled:d,children:d?"Saving...":"Save"})]})]}),O&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Body Metric Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{D(!1),I(me)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),Oo.map(k=>{const N=ke?.bodyMetrics?.[k.key];return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:k.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",N!=null?`${N} ${k.suffix}`:"-"]})]}),r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:["Target (",k.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:q[k.key]?.targetValue??"",onChange:P=>Gt(k.key,P.target.value),placeholder:"0"})]})})]},k.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{D(!1),I(me)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Gs,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="history"&&r.jsx("div",{className:"pb-history-section",children:t.length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("h4",{children:"No records yet"}),r.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):r.jsxs(r.Fragment,{children:[qe.length>0&&r.jsxs("div",{className:"pb-achievements-wall",children:[r.jsxs("h4",{className:"pb-achievements-wall-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),r.jsx("div",{className:"pb-achievements-list",children:[...qe].reverse().map((k,N)=>r.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${N*.05}s`},children:[r.jsx("div",{className:"pb-achievement-star",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("div",{className:"pb-achievement-info",children:[r.jsx("span",{className:"pb-achievement-label",children:k.label}),r.jsx("span",{className:"pb-achievement-date",children:xa(k.achievedMonth)})]})]},N))})]}),r.jsx("div",{className:"pb-history-controls",children:r.jsx("button",{className:`pb-compare-toggle ${ee?"active":""}`,onClick:()=>{L(!ee),!ee&&t.length>=2&&(De(t[0].month),ze(t[t.length-1].month))},children:ee?"Back to Timeline":"Compare Months"})}),ee?r.jsxs("div",{className:"pb-compare",children:[r.jsxs("div",{className:"pb-compare-selectors",children:[r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"From"}),r.jsx("select",{value:se,onChange:k=>De(k.target.value),children:t.map(k=>r.jsx("option",{value:k.month,children:xa(k.month)},k.month))})]}),r.jsx("div",{className:"pb-compare-vs",children:"vs"}),r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"To"}),r.jsx("select",{value:ue,onChange:k=>ze(k.target.value),children:t.map(k=>r.jsx("option",{value:k.month,children:xa(k.month)},k.month))})]})]}),je&&ct&&r.jsxs("div",{className:"pb-compare-results",children:[r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Strength Benchmarks"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Exercise"}),r.jsx("span",{children:xa(se).split(" ")[0]}),r.jsx("span",{children:xa(ue).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),Da.map(k=>{const N=je.benchmarks?.[k.key],P=ct.benchmarks?.[k.key],U=Vl(k,N),fe=Vl(k,P),Ue=ng(fe,U);return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:k.name}),r.jsx("span",{className:"pb-compare-val",children:N?k.unit==="time"?fh(N.time):`${N.weight}x${N.reps}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:P?k.unit==="time"?fh(P.time):`${P.weight}x${P.reps}`:"-"}),r.jsx("span",{className:`pb-compare-change ${Ue!==null?Ue>=0?"positive":"negative":""}`,children:Ue!==null?`${Ue>=0?"+":""}${Ue.toFixed(1)}%`:"-"})]},k.key)})]})]}),r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Body Measurements"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Measurement"}),r.jsx("span",{children:xa(se).split(" ")[0]}),r.jsx("span",{children:xa(ue).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),Oo.map(k=>{const N=je.bodyMetrics?.[k.key],P=ct.bodyMetrics?.[k.key],U=N!=null&&P!=null?parseFloat((P-N).toFixed(2)):null;return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:k.name}),r.jsx("span",{className:"pb-compare-val",children:N!=null?`${N}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:P!=null?`${P}`:"-"}),r.jsx("span",{className:`pb-compare-change ${U!==null?U>0?"positive":U<0?"negative":"neutral":""}`,children:U!==null?`${U>0?"+":""}${U} ${k.suffix}`:"-"})]},k.key)})]})]})]})]}):r.jsx("div",{className:"pb-timeline",children:[...t].reverse().map((k,N)=>{const P=t.find(U=>U.month<k.month&&t.indexOf(U)===t.indexOf(k)-1)||t.filter(U=>U.month<k.month).pop();return r.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${N*.05}s`},children:[r.jsx("div",{className:"pb-timeline-dot"}),r.jsxs("div",{className:"pb-timeline-card",children:[r.jsx("h4",{children:xa(k.month)}),k.benchmarks&&Object.keys(k.benchmarks).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Strength Benchmarks"}),Da.map(U=>{const fe=k.benchmarks[U.key];if(!fe)return null;const Ue=P?.benchmarks?.[U.key],Fe=Vl(U,fe),st=Vl(U,Ue),et=ng(Fe,st);return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:U.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsx("span",{className:"pb-timeline-value",children:U.unit==="time"?fh(fe.time):P2(fe.weight,fe.reps)}),et!==null&&r.jsxs("span",{className:`pb-timeline-change ${et>=0?"positive":"negative"}`,children:[et>=0?"+":"",et.toFixed(1),"%"]})]})]},U.key)})]}),k.bodyMetrics&&Object.keys(k.bodyMetrics).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Body Measurements"}),Oo.map(U=>{const fe=k.bodyMetrics[U.key];if(fe==null)return null;const Ue=P?.bodyMetrics?.[U.key],Fe=Ue!=null?parseFloat((fe-Ue).toFixed(2)):null;return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:U.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsxs("span",{className:"pb-timeline-value",children:[fe," ",U.suffix]}),Fe!==null&&r.jsxs("span",{className:`pb-timeline-change ${Fe>0?"positive":Fe<0?"negative":"neutral"}`,children:[Fe>0?"+":"",Fe," ",U.suffix]})]})]},U.key)})]})]})]},k.id)})})]})})]})]}),W&&r.jsx("div",{className:"pb-celebration-overlay",onClick:()=>de(null),children:r.jsxs("div",{className:"pb-celebration-card",children:[r.jsx("div",{className:"pb-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pb-celebration-title",children:W.length===1?"Target Achieved!":`${W.length} Targets Achieved!`}),r.jsx("div",{className:"pb-celebration-badges",children:W.map((k,N)=>r.jsx("div",{className:"pb-celebration-badge",children:k.label},N))}),r.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),Ie&&r.jsxs("div",{className:`toast-notification ${Ie.type}`,children:[r.jsx("span",{className:"toast-icon",children:Ie.type==="success"?r.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),r.jsx("span",{className:"toast-message",children:Ie.message}),r.jsx("button",{className:"toast-close",onClick:()=>Ve(null),children:""})]}),ps&&r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:"block-nav-tab",onClick:()=>zt("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),r.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),r.jsx("span",{children:"Home"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>zt("/client/forms"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),r.jsx("polyline",{points:"14 2 14 8 20 8"}),r.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),r.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),r.jsx("span",{children:"Forms"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>zt("/client/tools"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),r.jsx("span",{children:"Tools"})]}),r.jsxs("button",{className:"block-nav-tab active",children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20V10"}),r.jsx("path",{d:"M18 20V4"}),r.jsx("path",{d:"M6 20v-4"})]}),r.jsx("span",{children:"PBs"})]}),St?.circuitAccess&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>zt("/client/circuit"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 6v6l4 2"})]}),r.jsx("span",{children:"Circuit"})]})]}),Lt&&r.jsx(ua,{active:"progress"})]})})}const jP=v.lazy(()=>Ar(()=>import("./Dashboard-SzFL48VI.js"),__vite__mapDeps([0,1]))),TP=v.lazy(()=>Ar(()=>import("./AddClient-BvM7E8nH.js"),__vite__mapDeps([2,3]))),EP=v.lazy(()=>Ar(()=>import("./ClientDashboard-CIjZqfzD.js"),[])),SP=v.lazy(()=>Ar(()=>import("./ClientForms-B0uJ77lz.js"),__vite__mapDeps([4,5]))),NP=v.lazy(()=>Ar(()=>import("./ClientTools-BLevk56M.js"),__vite__mapDeps([6,7]))),CP=v.lazy(()=>Ar(()=>import("./MacroCalculator-DmK8rypd.js"),__vite__mapDeps([8,7]))),RP=v.lazy(()=>Ar(()=>import("./ProteinSnacks-6dSOE8Ub.js"),__vite__mapDeps([9,7]))),AP=v.lazy(()=>Ar(()=>import("./DailyMotivation-C1AJjyOg.js"),__vite__mapDeps([10,7]))),MP=v.lazy(()=>Ar(()=>import("./CircuitDashboard-BPwByCch.js"),__vite__mapDeps([11,12]))),IP=v.lazy(()=>Ar(()=>import("./CircuitBooking-_aNzofL8.js"),__vite__mapDeps([13,14,12]))),DP=v.lazy(()=>Ar(()=>import("./Leaderboard-CFKNR7fU.js"),__vite__mapDeps([15,16]))),PP=v.lazy(()=>Ar(()=>import("./UpgradePage-CthJwlqQ.js"),__vite__mapDeps([17,18,19]))),LP=v.lazy(()=>Ar(()=>import("./SignUp-DGRdi3yQ.js"),[])),OP=v.lazy(()=>Ar(()=>import("./Onboarding-_lN8JW-A.js"),__vite__mapDeps([20,18,21])));function BP({children:n}){const{pathname:e}=Sa();return v.useEffect(()=>{"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")},[]),v.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"})},[e]),n}function VP(){const n=er();return v.useEffect(()=>{const e=sessionStorage.getItem("redirect");if(e){sessionStorage.removeItem("redirect");const t=e.replace("/login","")||"/";n(t,{replace:!0})}},[n]),null}function UP(){return r.jsx(Q3,{children:r.jsx(Y3,{children:r.jsx(eD,{children:r.jsxs(rS,{basename:"/login",children:[r.jsx(VP,{}),r.jsx(BP,{children:r.jsx(v.Suspense,{fallback:null,children:r.jsxs(IE,{children:[r.jsx(nn,{path:"/",element:r.jsx(nD,{})}),r.jsx(nn,{path:"/dashboard",element:r.jsx(jP,{})}),r.jsx(nn,{path:"/add-client",element:r.jsx(TP,{})}),r.jsx(nn,{path:"/client",element:r.jsx(EP,{})}),r.jsx(nn,{path:"/client/forms",element:r.jsx(SP,{})}),r.jsx(nn,{path:"/client/tools",element:r.jsx(NP,{})}),r.jsx(nn,{path:"/client/tools/macros",element:r.jsx(CP,{})}),r.jsx(nn,{path:"/client/tools/snacks",element:r.jsx(RP,{})}),r.jsx(nn,{path:"/client/tools/motivation",element:r.jsx(AP,{})}),r.jsx(nn,{path:"/client/personal-bests",element:r.jsx(kP,{})}),r.jsx(nn,{path:"/client/circuit",element:r.jsx(MP,{})}),r.jsx(nn,{path:"/client/circuit/booking",element:r.jsx(IP,{})}),r.jsx(nn,{path:"/client/core-buddy",element:r.jsx(TD,{})}),r.jsx(nn,{path:"/client/core-buddy/nutrition",element:r.jsx(Dl,{feature:"nutrition",children:r.jsx(ND,{})})}),r.jsx(nn,{path:"/client/core-buddy/workouts",element:r.jsx(qD,{})}),r.jsx(nn,{path:"/client/core-buddy/programmes",element:r.jsx(Dl,{feature:"programmes",children:r.jsx(KD,{})})}),r.jsx(nn,{path:"/client/core-buddy/achievements",element:r.jsx(Dl,{feature:"achievements",children:r.jsx(eP,{})})}),r.jsx(nn,{path:"/client/core-buddy/consistency",element:r.jsx(Dl,{feature:"consistency",children:r.jsx(oP,{})})}),r.jsx(nn,{path:"/client/core-buddy/buddies",element:r.jsx(Dl,{feature:"buddies",children:r.jsx(lP,{})})}),r.jsx(nn,{path:"/client/core-buddy/buddy",element:r.jsx(mP,{})}),r.jsx(nn,{path:"/client/core-buddy/profile/:userId",element:r.jsx(hP,{})}),r.jsx(nn,{path:"/client/leaderboard",element:r.jsx(Dl,{feature:"leaderboard",children:r.jsx(DP,{})})}),r.jsx(nn,{path:"/signup",element:r.jsx(LP,{})}),r.jsx(nn,{path:"/onboarding",element:r.jsx(OP,{})}),r.jsx(nn,{path:"/upgrade",element:r.jsx(PP,{})}),r.jsx(nn,{path:"*",element:r.jsx(AE,{to:"/",replace:!0})})]})})})]})})})})}MT.createRoot(document.getElementById("root")).render(r.jsx(v.StrictMode,{children:r.jsx(UP,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/login/sw.js").catch(()=>{})});export{br as A,ua as C,Ta as P,_t as T,la as a,Sr as b,Ot as c,pe as d,He as e,QC as f,Es as g,t4 as h,Ss as i,r as j,As as k,Ur as l,Na as m,er as n,Kh as o,tb as p,Os as q,v as r,qP as s,km as t,La as u,sD as v,fs as w,tD as x,FP as y,cS as z};
