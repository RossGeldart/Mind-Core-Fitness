const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-CqWdcYN7.js","assets/scheduleUtils-nL0Oblug.js","assets/Dashboard-DCw4kN7s.css","assets/AddClient-CvyzaW6C.js","assets/AddClient-DH1OFzHo.css","assets/ClientDashboard-5kr2u5-s.js","assets/ClientDashboard-CTb3kWfB.css","assets/ClientForms-BYpsj2ab.js","assets/ClientForms-BQ6L6YbL.css","assets/ClientTools-W7ekVfG-.js","assets/ClientTools-CF4E9GcC.css","assets/MacroCalculator-O3yYuFSG.js","assets/ProteinSnacks-DDus_xXs.js","assets/DailyMotivation-My2fPLUv.js","assets/CircuitDashboard-B0jYo5qr.js","assets/CircuitDashboard-Bbgf6q3b.css","assets/CircuitBooking-C6WKlw14.js","assets/CircuitBooking-ruk9Q4Wj.css","assets/PersonalBests-CoXVTzTU.js","assets/PersonalBests-C2b_TGFz.css","assets/Leaderboard-0nSDb6Ay.js","assets/Leaderboard-Bul59-ui.css","assets/UpgradePage-D5I8uvk9.js","assets/stripe-Da7IPrZW.js","assets/UpgradePage-CbxbCKJy.css","assets/Onboarding-DdcIDXbg.js","assets/Onboarding-B35MW945.css"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const c of l)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function t(l){const c={};return l.integrity&&(c.integrity=l.integrity),l.referrerPolicy&&(c.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?c.credentials="include":l.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(l){if(l.ep)return;l.ep=!0;const c=t(l);fetch(l.href,c)}})();var Cg={exports:{}},Qc={};var Yb;function BT(){if(Yb)return Qc;Yb=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,l,c){var d=null;if(c!==void 0&&(d=""+c),l.key!==void 0&&(d=""+l.key),"key"in l){c={};for(var g in l)g!=="key"&&(c[g]=l[g])}else c=l;return l=c.ref,{$$typeof:s,type:i,key:d,ref:l!==void 0?l:null,props:c}}return Qc.Fragment=e,Qc.jsx=t,Qc.jsxs=t,Qc}var Qb;function zT(){return Qb||(Qb=1,Cg.exports=BT()),Cg.exports}var a=zT(),Ng={exports:{}},Lt={};var Xb;function FT(){if(Xb)return Lt;Xb=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),d=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),y=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),_=Symbol.for("react.activity"),j=Symbol.iterator;function I(U){return U===null||typeof U!="object"?null:(U=j&&U[j]||U["@@iterator"],typeof U=="function"?U:null)}var F={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},G=Object.assign,B={};function Y(U,ce,Ee){this.props=U,this.context=ce,this.refs=B,this.updater=Ee||F}Y.prototype.isReactComponent={},Y.prototype.setState=function(U,ce){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,U,ce,"setState")},Y.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};function ee(){}ee.prototype=Y.prototype;function re(U,ce,Ee){this.props=U,this.context=ce,this.refs=B,this.updater=Ee||F}var pe=re.prototype=new ee;pe.constructor=re,G(pe,Y.prototype),pe.isPureReactComponent=!0;var ve=Array.isArray;function he(){}var L={H:null,A:null,T:null,S:null},E=Object.prototype.hasOwnProperty;function A(U,ce,Ee){var Ce=Ee.ref;return{$$typeof:s,type:U,key:ce,ref:Ce!==void 0?Ce:null,props:Ee}}function V(U,ce){return A(U.type,ce,U.props)}function M(U){return typeof U=="object"&&U!==null&&U.$$typeof===s}function P(U){var ce={"=":"=0",":":"=2"};return"$"+U.replace(/[=:]/g,function(Ee){return ce[Ee]})}var C=/\/+/g;function Me(U,ce){return typeof U=="object"&&U!==null&&U.key!=null?P(""+U.key):ce.toString(36)}function Qe(U){switch(U.status){case"fulfilled":return U.value;case"rejected":throw U.reason;default:switch(typeof U.status=="string"?U.then(he,he):(U.status="pending",U.then(function(ce){U.status==="pending"&&(U.status="fulfilled",U.value=ce)},function(ce){U.status==="pending"&&(U.status="rejected",U.reason=ce)})),U.status){case"fulfilled":return U.value;case"rejected":throw U.reason}}throw U}function J(U,ce,Ee,Ce,je){var Ue=typeof U;(Ue==="undefined"||Ue==="boolean")&&(U=null);var $e=!1;if(U===null)$e=!0;else switch(Ue){case"bigint":case"string":case"number":$e=!0;break;case"object":switch(U.$$typeof){case s:case e:$e=!0;break;case b:return $e=U._init,J($e(U._payload),ce,Ee,Ce,je)}}if($e)return je=je(U),$e=Ce===""?"."+Me(U,0):Ce,ve(je)?(Ee="",$e!=null&&(Ee=$e.replace(C,"$&/")+"/"),J(je,ce,Ee,"",function(Wt){return Wt})):je!=null&&(M(je)&&(je=V(je,Ee+(je.key==null||U&&U.key===je.key?"":(""+je.key).replace(C,"$&/")+"/")+$e)),ce.push(je)),1;$e=0;var Xe=Ce===""?".":Ce+":";if(ve(U))for(var Ze=0;Ze<U.length;Ze++)Ce=U[Ze],Ue=Xe+Me(Ce,Ze),$e+=J(Ce,ce,Ee,Ue,je);else if(Ze=I(U),typeof Ze=="function")for(U=Ze.call(U),Ze=0;!(Ce=U.next()).done;)Ce=Ce.value,Ue=Xe+Me(Ce,Ze++),$e+=J(Ce,ce,Ee,Ue,je);else if(Ue==="object"){if(typeof U.then=="function")return J(Qe(U),ce,Ee,Ce,je);throw ce=String(U),Error("Objects are not valid as a React child (found: "+(ce==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":ce)+"). If you meant to render a collection of children, use an array instead.")}return $e}function Se(U,ce,Ee){if(U==null)return U;var Ce=[],je=0;return J(U,Ce,"","",function(Ue){return ce.call(Ee,Ue,je++)}),Ce}function He(U){if(U._status===-1){var ce=U._result;ce=ce(),ce.then(function(Ee){(U._status===0||U._status===-1)&&(U._status=1,U._result=Ee)},function(Ee){(U._status===0||U._status===-1)&&(U._status=2,U._result=Ee)}),U._status===-1&&(U._status=0,U._result=ce)}if(U._status===1)return U._result.default;throw U._result}var ke=typeof reportError=="function"?reportError:function(U){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ce=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof U=="object"&&U!==null&&typeof U.message=="string"?String(U.message):String(U),error:U});if(!window.dispatchEvent(ce))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",U);return}console.error(U)},Pe={map:Se,forEach:function(U,ce,Ee){Se(U,function(){ce.apply(this,arguments)},Ee)},count:function(U){var ce=0;return Se(U,function(){ce++}),ce},toArray:function(U){return Se(U,function(ce){return ce})||[]},only:function(U){if(!M(U))throw Error("React.Children.only expected to receive a single React element child.");return U}};return Lt.Activity=_,Lt.Children=Pe,Lt.Component=Y,Lt.Fragment=t,Lt.Profiler=l,Lt.PureComponent=re,Lt.StrictMode=i,Lt.Suspense=y,Lt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=L,Lt.__COMPILER_RUNTIME={__proto__:null,c:function(U){return L.H.useMemoCache(U)}},Lt.cache=function(U){return function(){return U.apply(null,arguments)}},Lt.cacheSignal=function(){return null},Lt.cloneElement=function(U,ce,Ee){if(U==null)throw Error("The argument must be a React element, but you passed "+U+".");var Ce=G({},U.props),je=U.key;if(ce!=null)for(Ue in ce.key!==void 0&&(je=""+ce.key),ce)!E.call(ce,Ue)||Ue==="key"||Ue==="__self"||Ue==="__source"||Ue==="ref"&&ce.ref===void 0||(Ce[Ue]=ce[Ue]);var Ue=arguments.length-2;if(Ue===1)Ce.children=Ee;else if(1<Ue){for(var $e=Array(Ue),Xe=0;Xe<Ue;Xe++)$e[Xe]=arguments[Xe+2];Ce.children=$e}return A(U.type,je,Ce)},Lt.createContext=function(U){return U={$$typeof:d,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null},U.Provider=U,U.Consumer={$$typeof:c,_context:U},U},Lt.createElement=function(U,ce,Ee){var Ce,je={},Ue=null;if(ce!=null)for(Ce in ce.key!==void 0&&(Ue=""+ce.key),ce)E.call(ce,Ce)&&Ce!=="key"&&Ce!=="__self"&&Ce!=="__source"&&(je[Ce]=ce[Ce]);var $e=arguments.length-2;if($e===1)je.children=Ee;else if(1<$e){for(var Xe=Array($e),Ze=0;Ze<$e;Ze++)Xe[Ze]=arguments[Ze+2];je.children=Xe}if(U&&U.defaultProps)for(Ce in $e=U.defaultProps,$e)je[Ce]===void 0&&(je[Ce]=$e[Ce]);return A(U,Ue,je)},Lt.createRef=function(){return{current:null}},Lt.forwardRef=function(U){return{$$typeof:g,render:U}},Lt.isValidElement=M,Lt.lazy=function(U){return{$$typeof:b,_payload:{_status:-1,_result:U},_init:He}},Lt.memo=function(U,ce){return{$$typeof:p,type:U,compare:ce===void 0?null:ce}},Lt.startTransition=function(U){var ce=L.T,Ee={};L.T=Ee;try{var Ce=U(),je=L.S;je!==null&&je(Ee,Ce),typeof Ce=="object"&&Ce!==null&&typeof Ce.then=="function"&&Ce.then(he,ke)}catch(Ue){ke(Ue)}finally{ce!==null&&Ee.types!==null&&(ce.types=Ee.types),L.T=ce}},Lt.unstable_useCacheRefresh=function(){return L.H.useCacheRefresh()},Lt.use=function(U){return L.H.use(U)},Lt.useActionState=function(U,ce,Ee){return L.H.useActionState(U,ce,Ee)},Lt.useCallback=function(U,ce){return L.H.useCallback(U,ce)},Lt.useContext=function(U){return L.H.useContext(U)},Lt.useDebugValue=function(){},Lt.useDeferredValue=function(U,ce){return L.H.useDeferredValue(U,ce)},Lt.useEffect=function(U,ce){return L.H.useEffect(U,ce)},Lt.useEffectEvent=function(U){return L.H.useEffectEvent(U)},Lt.useId=function(){return L.H.useId()},Lt.useImperativeHandle=function(U,ce,Ee){return L.H.useImperativeHandle(U,ce,Ee)},Lt.useInsertionEffect=function(U,ce){return L.H.useInsertionEffect(U,ce)},Lt.useLayoutEffect=function(U,ce){return L.H.useLayoutEffect(U,ce)},Lt.useMemo=function(U,ce){return L.H.useMemo(U,ce)},Lt.useOptimistic=function(U,ce){return L.H.useOptimistic(U,ce)},Lt.useReducer=function(U,ce,Ee){return L.H.useReducer(U,ce,Ee)},Lt.useRef=function(U){return L.H.useRef(U)},Lt.useState=function(U){return L.H.useState(U)},Lt.useSyncExternalStore=function(U,ce,Ee){return L.H.useSyncExternalStore(U,ce,Ee)},Lt.useTransition=function(){return L.H.useTransition()},Lt.version="19.2.4",Lt}var Jb;function ey(){return Jb||(Jb=1,Ng.exports=FT()),Ng.exports}var w=ey(),Ag={exports:{}},Xc={},Rg={exports:{}},Ig={};var Zb;function HT(){return Zb||(Zb=1,(function(s){function e(J,Se){var He=J.length;J.push(Se);e:for(;0<He;){var ke=He-1>>>1,Pe=J[ke];if(0<l(Pe,Se))J[ke]=Se,J[He]=Pe,He=ke;else break e}}function t(J){return J.length===0?null:J[0]}function i(J){if(J.length===0)return null;var Se=J[0],He=J.pop();if(He!==Se){J[0]=He;e:for(var ke=0,Pe=J.length,U=Pe>>>1;ke<U;){var ce=2*(ke+1)-1,Ee=J[ce],Ce=ce+1,je=J[Ce];if(0>l(Ee,He))Ce<Pe&&0>l(je,Ee)?(J[ke]=je,J[Ce]=He,ke=Ce):(J[ke]=Ee,J[ce]=He,ke=ce);else if(Ce<Pe&&0>l(je,He))J[ke]=je,J[Ce]=He,ke=Ce;else break e}}return Se}function l(J,Se){var He=J.sortIndex-Se.sortIndex;return He!==0?He:J.id-Se.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;s.unstable_now=function(){return c.now()}}else{var d=Date,g=d.now();s.unstable_now=function(){return d.now()-g}}var y=[],p=[],b=1,_=null,j=3,I=!1,F=!1,G=!1,B=!1,Y=typeof setTimeout=="function"?setTimeout:null,ee=typeof clearTimeout=="function"?clearTimeout:null,re=typeof setImmediate<"u"?setImmediate:null;function pe(J){for(var Se=t(p);Se!==null;){if(Se.callback===null)i(p);else if(Se.startTime<=J)i(p),Se.sortIndex=Se.expirationTime,e(y,Se);else break;Se=t(p)}}function ve(J){if(G=!1,pe(J),!F)if(t(y)!==null)F=!0,he||(he=!0,P());else{var Se=t(p);Se!==null&&Qe(ve,Se.startTime-J)}}var he=!1,L=-1,E=5,A=-1;function V(){return B?!0:!(s.unstable_now()-A<E)}function M(){if(B=!1,he){var J=s.unstable_now();A=J;var Se=!0;try{e:{F=!1,G&&(G=!1,ee(L),L=-1),I=!0;var He=j;try{t:{for(pe(J),_=t(y);_!==null&&!(_.expirationTime>J&&V());){var ke=_.callback;if(typeof ke=="function"){_.callback=null,j=_.priorityLevel;var Pe=ke(_.expirationTime<=J);if(J=s.unstable_now(),typeof Pe=="function"){_.callback=Pe,pe(J),Se=!0;break t}_===t(y)&&i(y),pe(J)}else i(y);_=t(y)}if(_!==null)Se=!0;else{var U=t(p);U!==null&&Qe(ve,U.startTime-J),Se=!1}}break e}finally{_=null,j=He,I=!1}Se=void 0}}finally{Se?P():he=!1}}}var P;if(typeof re=="function")P=function(){re(M)};else if(typeof MessageChannel<"u"){var C=new MessageChannel,Me=C.port2;C.port1.onmessage=M,P=function(){Me.postMessage(null)}}else P=function(){Y(M,0)};function Qe(J,Se){L=Y(function(){J(s.unstable_now())},Se)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(J){J.callback=null},s.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<J?Math.floor(1e3/J):5},s.unstable_getCurrentPriorityLevel=function(){return j},s.unstable_next=function(J){switch(j){case 1:case 2:case 3:var Se=3;break;default:Se=j}var He=j;j=Se;try{return J()}finally{j=He}},s.unstable_requestPaint=function(){B=!0},s.unstable_runWithPriority=function(J,Se){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var He=j;j=J;try{return Se()}finally{j=He}},s.unstable_scheduleCallback=function(J,Se,He){var ke=s.unstable_now();switch(typeof He=="object"&&He!==null?(He=He.delay,He=typeof He=="number"&&0<He?ke+He:ke):He=ke,J){case 1:var Pe=-1;break;case 2:Pe=250;break;case 5:Pe=1073741823;break;case 4:Pe=1e4;break;default:Pe=5e3}return Pe=He+Pe,J={id:b++,callback:Se,priorityLevel:J,startTime:He,expirationTime:Pe,sortIndex:-1},He>ke?(J.sortIndex=He,e(p,J),t(y)===null&&J===t(p)&&(G?(ee(L),L=-1):G=!0,Qe(ve,He-ke))):(J.sortIndex=Pe,e(y,J),F||I||(F=!0,he||(he=!0,P()))),J},s.unstable_shouldYield=V,s.unstable_wrapCallback=function(J){var Se=j;return function(){var He=j;j=Se;try{return J.apply(this,arguments)}finally{j=He}}}})(Ig)),Ig}var e2;function qT(){return e2||(e2=1,Rg.exports=HT()),Rg.exports}var Mg={exports:{}},Ys={};var t2;function $T(){if(t2)return Ys;t2=1;var s=ey();function e(y){var p="https://react.dev/errors/"+y;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)p+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+y+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},l=Symbol.for("react.portal");function c(y,p,b){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:_==null?null:""+_,children:y,containerInfo:p,implementation:b}}var d=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function g(y,p){if(y==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return Ys.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Ys.createPortal=function(y,p){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return c(y,p,null,b)},Ys.flushSync=function(y){var p=d.T,b=i.p;try{if(d.T=null,i.p=2,y)return y()}finally{d.T=p,i.p=b,i.d.f()}},Ys.preconnect=function(y,p){typeof y=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,i.d.C(y,p))},Ys.prefetchDNS=function(y){typeof y=="string"&&i.d.D(y)},Ys.preinit=function(y,p){if(typeof y=="string"&&p&&typeof p.as=="string"){var b=p.as,_=g(b,p.crossOrigin),j=typeof p.integrity=="string"?p.integrity:void 0,I=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;b==="style"?i.d.S(y,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:_,integrity:j,fetchPriority:I}):b==="script"&&i.d.X(y,{crossOrigin:_,integrity:j,fetchPriority:I,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},Ys.preinitModule=function(y,p){if(typeof y=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var b=g(p.as,p.crossOrigin);i.d.M(y,{crossOrigin:b,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&i.d.M(y)},Ys.preload=function(y,p){if(typeof y=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var b=p.as,_=g(b,p.crossOrigin);i.d.L(y,b,{crossOrigin:_,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},Ys.preloadModule=function(y,p){if(typeof y=="string")if(p){var b=g(p.as,p.crossOrigin);i.d.m(y,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:b,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else i.d.m(y)},Ys.requestFormReset=function(y){i.d.r(y)},Ys.unstable_batchedUpdates=function(y,p){return y(p)},Ys.useFormState=function(y,p,b){return d.H.useFormState(y,p,b)},Ys.useFormStatus=function(){return d.H.useHostTransitionStatus()},Ys.version="19.2.4",Ys}var n2;function WT(){if(n2)return Mg.exports;n2=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Mg.exports=$T(),Mg.exports}var s2;function GT(){if(s2)return Xc;s2=1;var s=qT(),e=ey(),t=WT();function i(n){var r="https://react.dev/errors/"+n;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)r+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+n+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function c(n){var r=n,o=n;if(n.alternate)for(;r.return;)r=r.return;else{n=r;do r=n,(r.flags&4098)!==0&&(o=r.return),n=r.return;while(n)}return r.tag===3?o:null}function d(n){if(n.tag===13){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function g(n){if(n.tag===31){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function y(n){if(c(n)!==n)throw Error(i(188))}function p(n){var r=n.alternate;if(!r){if(r=c(n),r===null)throw Error(i(188));return r!==n?null:n}for(var o=n,u=r;;){var f=o.return;if(f===null)break;var m=f.alternate;if(m===null){if(u=f.return,u!==null){o=u;continue}break}if(f.child===m.child){for(m=f.child;m;){if(m===o)return y(f),n;if(m===u)return y(f),r;m=m.sibling}throw Error(i(188))}if(o.return!==u.return)o=f,u=m;else{for(var x=!1,T=f.child;T;){if(T===o){x=!0,o=f,u=m;break}if(T===u){x=!0,u=f,o=m;break}T=T.sibling}if(!x){for(T=m.child;T;){if(T===o){x=!0,o=m,u=f;break}if(T===u){x=!0,u=m,o=f;break}T=T.sibling}if(!x)throw Error(i(189))}}if(o.alternate!==u)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?n:r}function b(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n;for(n=n.child;n!==null;){if(r=b(n),r!==null)return r;n=n.sibling}return null}var _=Object.assign,j=Symbol.for("react.element"),I=Symbol.for("react.transitional.element"),F=Symbol.for("react.portal"),G=Symbol.for("react.fragment"),B=Symbol.for("react.strict_mode"),Y=Symbol.for("react.profiler"),ee=Symbol.for("react.consumer"),re=Symbol.for("react.context"),pe=Symbol.for("react.forward_ref"),ve=Symbol.for("react.suspense"),he=Symbol.for("react.suspense_list"),L=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),A=Symbol.for("react.activity"),V=Symbol.for("react.memo_cache_sentinel"),M=Symbol.iterator;function P(n){return n===null||typeof n!="object"?null:(n=M&&n[M]||n["@@iterator"],typeof n=="function"?n:null)}var C=Symbol.for("react.client.reference");function Me(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===C?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case G:return"Fragment";case Y:return"Profiler";case B:return"StrictMode";case ve:return"Suspense";case he:return"SuspenseList";case A:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case F:return"Portal";case re:return n.displayName||"Context";case ee:return(n._context.displayName||"Context")+".Consumer";case pe:var r=n.render;return n=n.displayName,n||(n=r.displayName||r.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case L:return r=n.displayName||null,r!==null?r:Me(n.type)||"Memo";case E:r=n._payload,n=n._init;try{return Me(n(r))}catch{}}return null}var Qe=Array.isArray,J=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Se=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,He={pending:!1,data:null,method:null,action:null},ke=[],Pe=-1;function U(n){return{current:n}}function ce(n){0>Pe||(n.current=ke[Pe],ke[Pe]=null,Pe--)}function Ee(n,r){Pe++,ke[Pe]=n.current,n.current=r}var Ce=U(null),je=U(null),Ue=U(null),$e=U(null);function Xe(n,r){switch(Ee(Ue,r),Ee(je,n),Ee(Ce,null),r.nodeType){case 9:case 11:n=(n=r.documentElement)&&(n=n.namespaceURI)?vb(n):0;break;default:if(n=r.tagName,r=r.namespaceURI)r=vb(r),n=bb(r,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}ce(Ce),Ee(Ce,n)}function Ze(){ce(Ce),ce(je),ce(Ue)}function Wt(n){n.memoizedState!==null&&Ee($e,n);var r=Ce.current,o=bb(r,n.type);r!==o&&(Ee(je,n),Ee(Ce,o))}function It(n){je.current===n&&(ce(Ce),ce(je)),$e.current===n&&(ce($e),Wc._currentValue=He)}var Cn,ln;function qt(n){if(Cn===void 0)try{throw Error()}catch(o){var r=o.stack.trim().match(/\n( *(at )?)/);Cn=r&&r[1]||"",ln=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Cn+n+ln}var Et=!1;function pn(n,r){if(!n||Et)return"";Et=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(r){var Te=function(){throw Error()};if(Object.defineProperty(Te.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Te,[])}catch(ge){var de=ge}Reflect.construct(n,[],Te)}else{try{Te.call()}catch(ge){de=ge}n.call(Te.prototype)}}else{try{throw Error()}catch(ge){de=ge}(Te=n())&&typeof Te.catch=="function"&&Te.catch(function(){})}}catch(ge){if(ge&&de&&typeof ge.stack=="string")return[ge.stack,de.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=u.DetermineComponentFrameRoot(),x=m[0],T=m[1];if(x&&T){var z=x.split(`
`),ae=T.split(`
`);for(f=u=0;u<z.length&&!z[u].includes("DetermineComponentFrameRoot");)u++;for(;f<ae.length&&!ae[f].includes("DetermineComponentFrameRoot");)f++;if(u===z.length||f===ae.length)for(u=z.length-1,f=ae.length-1;1<=u&&0<=f&&z[u]!==ae[f];)f--;for(;1<=u&&0<=f;u--,f--)if(z[u]!==ae[f]){if(u!==1||f!==1)do if(u--,f--,0>f||z[u]!==ae[f]){var we=`
`+z[u].replace(" at new "," at ");return n.displayName&&we.includes("<anonymous>")&&(we=we.replace("<anonymous>",n.displayName)),we}while(1<=u&&0<=f);break}}}finally{Et=!1,Error.prepareStackTrace=o}return(o=n?n.displayName||n.name:"")?qt(o):""}function Tt(n,r){switch(n.tag){case 26:case 27:case 5:return qt(n.type);case 16:return qt("Lazy");case 13:return n.child!==r&&r!==null?qt("Suspense Fallback"):qt("Suspense");case 19:return qt("SuspenseList");case 0:case 15:return pn(n.type,!1);case 11:return pn(n.type.render,!1);case 1:return pn(n.type,!0);case 31:return qt("Activity");default:return""}}function dt(n){try{var r="",o=null;do r+=Tt(n,o),o=n,n=n.return;while(n);return r}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var le=Object.prototype.hasOwnProperty,pt=s.unstable_scheduleCallback,Ht=s.unstable_cancelCallback,it=s.unstable_shouldYield,yt=s.unstable_requestPaint,gt=s.unstable_now,_t=s.unstable_getCurrentPriorityLevel,zt=s.unstable_ImmediatePriority,fs=s.unstable_UserBlockingPriority,rn=s.unstable_NormalPriority,Zn=s.unstable_LowPriority,Fn=s.unstable_IdlePriority,Ln=s.log,Pn=s.unstable_setDisableYieldValue,un=null,Gt=null;function Ct(n){if(typeof Ln=="function"&&Pn(n),Gt&&typeof Gt.setStrictMode=="function")try{Gt.setStrictMode(un,n)}catch{}}var Mt=Math.clz32?Math.clz32:te,Z=Math.log,N=Math.LN2;function te(n){return n>>>=0,n===0?32:31-(Z(n)/N|0)|0}var Re=256,Ie=262144,De=4194304;function Fe(n){var r=n&42;if(r!==0)return r;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function Oe(n,r,o){var u=n.pendingLanes;if(u===0)return 0;var f=0,m=n.suspendedLanes,x=n.pingedLanes;n=n.warmLanes;var T=u&134217727;return T!==0?(u=T&~m,u!==0?f=Fe(u):(x&=T,x!==0?f=Fe(x):o||(o=T&~n,o!==0&&(f=Fe(o))))):(T=u&~m,T!==0?f=Fe(T):x!==0?f=Fe(x):o||(o=u&~n,o!==0&&(f=Fe(o)))),f===0?0:r!==0&&r!==f&&(r&m)===0&&(m=f&-f,o=r&-r,m>=o||m===32&&(o&4194048)!==0)?r:f}function Nt(n,r){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&r)===0}function bt(n,r){switch(n){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function lt(){var n=De;return De<<=1,(De&62914560)===0&&(De=4194304),n}function dn(n){for(var r=[],o=0;31>o;o++)r.push(n);return r}function hn(n,r){n.pendingLanes|=r,r!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function On(n,r,o,u,f,m){var x=n.pendingLanes;n.pendingLanes=o,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=o,n.entangledLanes&=o,n.errorRecoveryDisabledLanes&=o,n.shellSuspendCounter=0;var T=n.entanglements,z=n.expirationTimes,ae=n.hiddenUpdates;for(o=x&~o;0<o;){var we=31-Mt(o),Te=1<<we;T[we]=0,z[we]=-1;var de=ae[we];if(de!==null)for(ae[we]=null,we=0;we<de.length;we++){var ge=de[we];ge!==null&&(ge.lane&=-536870913)}o&=~Te}u!==0&&ms(n,u,0),m!==0&&f===0&&n.tag!==0&&(n.suspendedLanes|=m&~(x&~r))}function ms(n,r,o){n.pendingLanes|=r,n.suspendedLanes&=~r;var u=31-Mt(r);n.entangledLanes|=r,n.entanglements[u]=n.entanglements[u]|1073741824|o&261930}function ue(n,r){var o=n.entangledLanes|=r;for(n=n.entanglements;o;){var u=31-Mt(o),f=1<<u;f&r|n[u]&r&&(n[u]|=r),o&=~f}}function Le(n,r){var o=r&-r;return o=(o&42)!==0?1:Ke(o),(o&(n.suspendedLanes|r))!==0?0:o}function Ke(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function ct(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function rt(){var n=Se.p;return n!==0?n:(n=window.event,n===void 0?32:Fb(n.type))}function Kt(n,r){var o=Se.p;try{return Se.p=n,r()}finally{Se.p=o}}var fn=Math.random().toString(36).slice(2),At="__reactFiber$"+fn,St="__reactProps$"+fn,bn="__reactContainer$"+fn,Ss="__reactEvents$"+fn,si="__reactListeners$"+fn,xi="__reactHandles$"+fn,Vr="__reactResources$"+fn,js="__reactMarker$"+fn;function hr(n){delete n[At],delete n[St],delete n[Ss],delete n[si],delete n[xi]}function Kn(n){var r=n[At];if(r)return r;for(var o=n.parentNode;o;){if(r=o[bn]||o[At]){if(o=r.alternate,r.child!==null||o!==null&&o.child!==null)for(n=Tb(n);n!==null;){if(o=n[At])return o;n=Tb(n)}return r}n=o,o=n.parentNode}return null}function os(n){if(n=n[At]||n[bn]){var r=n.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return n}return null}function ls(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n.stateNode;throw Error(i(33))}function Vn(n){var r=n[Vr];return r||(r=n[Vr]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function wn(n){n[js]=!0}var es=new Set,kr={};function $s(n,r){Yn(n,r),Yn(n+"Capture",r)}function Yn(n,r){for(kr[n]=r,n=0;n<r.length;n++)es.add(r[n])}var jr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ts={},Ur={};function O(n){return le.call(Ur,n)?!0:le.call(ts,n)?!1:jr.test(n)?Ur[n]=!0:(ts[n]=!0,!1)}function q(n,r,o){if(O(r))if(o===null)n.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":n.removeAttribute(r);return;case"boolean":var u=r.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){n.removeAttribute(r);return}}n.setAttribute(r,""+o)}}function oe(n,r,o){if(o===null)n.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(r);return}n.setAttribute(r,""+o)}}function ne(n,r,o,u){if(u===null)n.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(o);return}n.setAttributeNS(r,o,""+u)}}function Ye(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Ge(n){var r=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function qe(n,r,o){var u=Object.getOwnPropertyDescriptor(n.constructor.prototype,r);if(!n.hasOwnProperty(r)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var f=u.get,m=u.set;return Object.defineProperty(n,r,{configurable:!0,get:function(){return f.call(this)},set:function(x){o=""+x,m.call(this,x)}}),Object.defineProperty(n,r,{enumerable:u.enumerable}),{getValue:function(){return o},setValue:function(x){o=""+x},stopTracking:function(){n._valueTracker=null,delete n[r]}}}}function ot(n){if(!n._valueTracker){var r=Ge(n)?"checked":"value";n._valueTracker=qe(n,r,""+n[r])}}function Rt(n){if(!n)return!1;var r=n._valueTracker;if(!r)return!0;var o=r.getValue(),u="";return n&&(u=Ge(n)?n.checked?"true":"false":n.value),n=u,n!==o?(r.setValue(n),!0):!1}function Nn(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var Cs=/[\n"\\]/g;function Qn(n){return n.replace(Cs,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function Ms(n,r,o,u,f,m,x,T){n.name="",x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?n.type=x:n.removeAttribute("type"),r!=null?x==="number"?(r===0&&n.value===""||n.value!=r)&&(n.value=""+Ye(r)):n.value!==""+Ye(r)&&(n.value=""+Ye(r)):x!=="submit"&&x!=="reset"||n.removeAttribute("value"),r!=null?Ds(n,x,Ye(r)):o!=null?Ds(n,x,Ye(o)):u!=null&&n.removeAttribute("value"),f==null&&m!=null&&(n.defaultChecked=!!m),f!=null&&(n.checked=f&&typeof f!="function"&&typeof f!="symbol"),T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?n.name=""+Ye(T):n.removeAttribute("name")}function ri(n,r,o,u,f,m,x,T){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(n.type=m),r!=null||o!=null){if(!(m!=="submit"&&m!=="reset"||r!=null)){ot(n);return}o=o!=null?""+Ye(o):"",r=r!=null?""+Ye(r):o,T||r===n.value||(n.value=r),n.defaultValue=r}u=u??f,u=typeof u!="function"&&typeof u!="symbol"&&!!u,n.checked=T?n.checked:!!u,n.defaultChecked=!!u,x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(n.name=x),ot(n)}function Ds(n,r,o){r==="number"&&Nn(n.ownerDocument)===n||n.defaultValue===""+o||(n.defaultValue=""+o)}function er(n,r,o,u){if(n=n.options,r){r={};for(var f=0;f<o.length;f++)r["$"+o[f]]=!0;for(o=0;o<n.length;o++)f=r.hasOwnProperty("$"+n[o].value),n[o].selected!==f&&(n[o].selected=f),f&&u&&(n[o].defaultSelected=!0)}else{for(o=""+Ye(o),r=null,f=0;f<n.length;f++){if(n[f].value===o){n[f].selected=!0,u&&(n[f].defaultSelected=!0);return}r!==null||n[f].disabled||(r=n[f])}r!==null&&(r.selected=!0)}}function _i(n,r,o){if(r!=null&&(r=""+Ye(r),r!==n.value&&(n.value=r),o==null)){n.defaultValue!==r&&(n.defaultValue=r);return}n.defaultValue=o!=null?""+Ye(o):""}function Er(n,r,o,u){if(r==null){if(u!=null){if(o!=null)throw Error(i(92));if(Qe(u)){if(1<u.length)throw Error(i(93));u=u[0]}o=u}o==null&&(o=""),r=o}o=Ye(r),n.defaultValue=o,u=n.textContent,u===o&&u!==""&&u!==null&&(n.value=u),ot(n)}function Ns(n,r){if(r){var o=n.firstChild;if(o&&o===n.lastChild&&o.nodeType===3){o.nodeValue=r;return}}n.textContent=r}var Ea=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function zi(n,r,o){var u=r.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?u?n.setProperty(r,""):r==="float"?n.cssFloat="":n[r]="":u?n.setProperty(r,o):typeof o!="number"||o===0||Ea.has(r)?r==="float"?n.cssFloat=o:n[r]=(""+o).trim():n[r]=o+"px"}function ii(n,r,o){if(r!=null&&typeof r!="object")throw Error(i(62));if(n=n.style,o!=null){for(var u in o)!o.hasOwnProperty(u)||r!=null&&r.hasOwnProperty(u)||(u.indexOf("--")===0?n.setProperty(u,""):u==="float"?n.cssFloat="":n[u]="");for(var f in r)u=r[f],r.hasOwnProperty(f)&&o[f]!==u&&zi(n,f,u)}else for(var m in r)r.hasOwnProperty(m)&&zi(n,m,r[m])}function ki(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Fi=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Br=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Tr(n){return Br.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function Ws(){}var Gs=null;function Ls(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var S=null,Q=null;function Ae(n){var r=os(n);if(r&&(n=r.stateNode)){var o=n[St]||null;e:switch(n=r.stateNode,r.type){case"input":if(Ms(n,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),r=o.name,o.type==="radio"&&r!=null){for(o=n;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Qn(""+r)+'"][type="radio"]'),r=0;r<o.length;r++){var u=o[r];if(u!==n&&u.form===n.form){var f=u[St]||null;if(!f)throw Error(i(90));Ms(u,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(r=0;r<o.length;r++)u=o[r],u.form===n.form&&Rt(u)}break e;case"textarea":_i(n,o.value,o.defaultValue);break e;case"select":r=o.value,r!=null&&er(n,!!o.multiple,r,!1)}}}var D=!1;function H(n,r,o){if(D)return n(r,o);D=!0;try{var u=n(r);return u}finally{if(D=!1,(S!==null||Q!==null)&&(Bd(),S&&(r=S,n=Q,Q=S=null,Ae(r),n)))for(r=0;r<n.length;r++)Ae(n[r])}}function $(n,r){var o=n.stateNode;if(o===null)return null;var u=o[St]||null;if(u===null)return null;o=u[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(n=n.type,u=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!u;break e;default:n=!1}if(n)return null;if(o&&typeof o!="function")throw Error(i(231,r,typeof o));return o}var K=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),me=!1;if(K)try{var be={};Object.defineProperty(be,"passive",{get:function(){me=!0}}),window.addEventListener("test",be,be),window.removeEventListener("test",be,be)}catch{me=!1}var Ve=null,nt=null,st=null;function vt(){if(st)return st;var n,r=nt,o=r.length,u,f="value"in Ve?Ve.value:Ve.textContent,m=f.length;for(n=0;n<o&&r[n]===f[n];n++);var x=o-n;for(u=1;u<=x&&r[o-u]===f[m-u];u++);return st=f.slice(n,1<u?1-u:void 0)}function kt(n){var r=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&r===13&&(n=13)):n=r,n===10&&(n=13),32<=n||n===13?n:0}function Xt(){return!0}function Hn(){return!1}function tt(n){function r(o,u,f,m,x){this._reactName=o,this._targetInst=f,this.type=u,this.nativeEvent=m,this.target=x,this.currentTarget=null;for(var T in n)n.hasOwnProperty(T)&&(o=n[T],this[T]=o?o(m):m[T]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?Xt:Hn,this.isPropagationStopped=Hn,this}return _(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Xt)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Xt)},persist:function(){},isPersistent:Xt}),r}var mn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},an=tt(mn),mt=_({},mn,{view:0,detail:0}),gn=tt(mt),Xn,tr,Ks,As=_({},mt,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ta,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Ks&&(Ks&&n.type==="mousemove"?(Xn=n.screenX-Ks.screenX,tr=n.screenY-Ks.screenY):tr=Xn=0,Ks=n),Xn)},movementY:function(n){return"movementY"in n?n.movementY:tr}}),nr=tt(As),Sr=_({},As,{dataTransfer:0}),yo=tt(Sr),sl=_({},mt,{relatedTarget:0}),ai=tt(sl),fc=_({},mn,{animationName:0,elapsedTime:0,pseudoElement:0}),Qu=tt(fc),rl=_({},mn,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Xu=tt(rl),Ju=_({},mn,{data:0}),ji=tt(Ju),Zu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ed={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},td={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function nd(n){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(n):(n=td[n])?!!r[n]:!1}function Ta(){return nd}var sr=_({},mt,{key:function(n){if(n.key){var r=Zu[n.key]||n.key;if(r!=="Unidentified")return r}return n.type==="keypress"?(n=kt(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?ed[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ta,charCode:function(n){return n.type==="keypress"?kt(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?kt(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),sd=tt(sr),rd=_({},As,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Hi=tt(rd),h=_({},mt,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ta}),v=tt(h),k=_({},mn,{propertyName:0,elapsedTime:0,pseudoElement:0}),R=tt(k),se=_({},As,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),fe=tt(se),Be=_({},mn,{newState:0,oldState:0}),Vt=tt(Be),cs=[9,13,27,32],xn=K&&"CompositionEvent"in window,qn=null;K&&"documentMode"in document&&(qn=document.documentMode);var zr=K&&"TextEvent"in window&&!qn,Ei=K&&(!xn||qn&&8<qn&&11>=qn),oi=" ",li=!1;function vo(n,r){switch(n){case"keyup":return cs.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function il(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var al=!1;function uE(n,r){switch(n){case"compositionend":return il(r);case"keypress":return r.which!==32?null:(li=!0,oi);case"textInput":return n=r.data,n===oi&&li?null:n;default:return null}}function dE(n,r){if(al)return n==="compositionend"||!xn&&vo(n,r)?(n=vt(),st=nt=Ve=null,al=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return Ei&&r.locale!=="ko"?null:r.data;default:return null}}var hE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function N0(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r==="input"?!!hE[n.type]:r==="textarea"}function A0(n,r,o,u){S?Q?Q.push(u):Q=[u]:S=u,r=Gd(r,"onChange"),0<r.length&&(o=new an("onChange","change",null,o,u),n.push({event:o,listeners:r}))}var mc=null,gc=null;function fE(n){hb(n,0)}function id(n){var r=ls(n);if(Rt(r))return n}function R0(n,r){if(n==="change")return r}var I0=!1;if(K){var Lf;if(K){var Pf="oninput"in document;if(!Pf){var M0=document.createElement("div");M0.setAttribute("oninput","return;"),Pf=typeof M0.oninput=="function"}Lf=Pf}else Lf=!1;I0=Lf&&(!document.documentMode||9<document.documentMode)}function D0(){mc&&(mc.detachEvent("onpropertychange",L0),gc=mc=null)}function L0(n){if(n.propertyName==="value"&&id(gc)){var r=[];A0(r,gc,n,Ls(n)),H(fE,r)}}function mE(n,r,o){n==="focusin"?(D0(),mc=r,gc=o,mc.attachEvent("onpropertychange",L0)):n==="focusout"&&D0()}function gE(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return id(gc)}function pE(n,r){if(n==="click")return id(r)}function yE(n,r){if(n==="input"||n==="change")return id(r)}function vE(n,r){return n===r&&(n!==0||1/n===1/r)||n!==n&&r!==r}var Cr=typeof Object.is=="function"?Object.is:vE;function pc(n,r){if(Cr(n,r))return!0;if(typeof n!="object"||n===null||typeof r!="object"||r===null)return!1;var o=Object.keys(n),u=Object.keys(r);if(o.length!==u.length)return!1;for(u=0;u<o.length;u++){var f=o[u];if(!le.call(r,f)||!Cr(n[f],r[f]))return!1}return!0}function P0(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function O0(n,r){var o=P0(n);n=0;for(var u;o;){if(o.nodeType===3){if(u=n+o.textContent.length,n<=r&&u>=r)return{node:o,offset:r-n};n=u}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=P0(o)}}function V0(n,r){return n&&r?n===r?!0:n&&n.nodeType===3?!1:r&&r.nodeType===3?V0(n,r.parentNode):"contains"in n?n.contains(r):n.compareDocumentPosition?!!(n.compareDocumentPosition(r)&16):!1:!1}function U0(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var r=Nn(n.document);r instanceof n.HTMLIFrameElement;){try{var o=typeof r.contentWindow.location.href=="string"}catch{o=!1}if(o)n=r.contentWindow;else break;r=Nn(n.document)}return r}function Of(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r&&(r==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||r==="textarea"||n.contentEditable==="true")}var bE=K&&"documentMode"in document&&11>=document.documentMode,ol=null,Vf=null,yc=null,Uf=!1;function B0(n,r,o){var u=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Uf||ol==null||ol!==Nn(u)||(u=ol,"selectionStart"in u&&Of(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),yc&&pc(yc,u)||(yc=u,u=Gd(Vf,"onSelect"),0<u.length&&(r=new an("onSelect","select",null,r,o),n.push({event:r,listeners:u}),r.target=ol)))}function bo(n,r){var o={};return o[n.toLowerCase()]=r.toLowerCase(),o["Webkit"+n]="webkit"+r,o["Moz"+n]="moz"+r,o}var ll={animationend:bo("Animation","AnimationEnd"),animationiteration:bo("Animation","AnimationIteration"),animationstart:bo("Animation","AnimationStart"),transitionrun:bo("Transition","TransitionRun"),transitionstart:bo("Transition","TransitionStart"),transitioncancel:bo("Transition","TransitionCancel"),transitionend:bo("Transition","TransitionEnd")},Bf={},z0={};K&&(z0=document.createElement("div").style,"AnimationEvent"in window||(delete ll.animationend.animation,delete ll.animationiteration.animation,delete ll.animationstart.animation),"TransitionEvent"in window||delete ll.transitionend.transition);function wo(n){if(Bf[n])return Bf[n];if(!ll[n])return n;var r=ll[n],o;for(o in r)if(r.hasOwnProperty(o)&&o in z0)return Bf[n]=r[o];return n}var F0=wo("animationend"),H0=wo("animationiteration"),q0=wo("animationstart"),wE=wo("transitionrun"),xE=wo("transitionstart"),_E=wo("transitioncancel"),$0=wo("transitionend"),W0=new Map,zf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");zf.push("scrollEnd");function ci(n,r){W0.set(n,r),$s(r,[n])}var ad=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},Fr=[],cl=0,Ff=0;function od(){for(var n=cl,r=Ff=cl=0;r<n;){var o=Fr[r];Fr[r++]=null;var u=Fr[r];Fr[r++]=null;var f=Fr[r];Fr[r++]=null;var m=Fr[r];if(Fr[r++]=null,u!==null&&f!==null){var x=u.pending;x===null?f.next=f:(f.next=x.next,x.next=f),u.pending=f}m!==0&&G0(o,f,m)}}function ld(n,r,o,u){Fr[cl++]=n,Fr[cl++]=r,Fr[cl++]=o,Fr[cl++]=u,Ff|=u,n.lanes|=u,n=n.alternate,n!==null&&(n.lanes|=u)}function Hf(n,r,o,u){return ld(n,r,o,u),cd(n)}function xo(n,r){return ld(n,null,null,r),cd(n)}function G0(n,r,o){n.lanes|=o;var u=n.alternate;u!==null&&(u.lanes|=o);for(var f=!1,m=n.return;m!==null;)m.childLanes|=o,u=m.alternate,u!==null&&(u.childLanes|=o),m.tag===22&&(n=m.stateNode,n===null||n._visibility&1||(f=!0)),n=m,m=m.return;return n.tag===3?(m=n.stateNode,f&&r!==null&&(f=31-Mt(o),n=m.hiddenUpdates,u=n[f],u===null?n[f]=[r]:u.push(r),r.lane=o|536870912),m):null}function cd(n){if(50<Uc)throw Uc=0,Jm=null,Error(i(185));for(var r=n.return;r!==null;)n=r,r=n.return;return n.tag===3?n.stateNode:null}var ul={};function kE(n,r,o,u){this.tag=n,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nr(n,r,o,u){return new kE(n,r,o,u)}function qf(n){return n=n.prototype,!(!n||!n.isReactComponent)}function qi(n,r){var o=n.alternate;return o===null?(o=Nr(n.tag,r,n.key,n.mode),o.elementType=n.elementType,o.type=n.type,o.stateNode=n.stateNode,o.alternate=n,n.alternate=o):(o.pendingProps=r,o.type=n.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=n.flags&65011712,o.childLanes=n.childLanes,o.lanes=n.lanes,o.child=n.child,o.memoizedProps=n.memoizedProps,o.memoizedState=n.memoizedState,o.updateQueue=n.updateQueue,r=n.dependencies,o.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},o.sibling=n.sibling,o.index=n.index,o.ref=n.ref,o.refCleanup=n.refCleanup,o}function K0(n,r){n.flags&=65011714;var o=n.alternate;return o===null?(n.childLanes=0,n.lanes=r,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,r=o.dependencies,n.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),n}function ud(n,r,o,u,f,m){var x=0;if(u=n,typeof n=="function")qf(n)&&(x=1);else if(typeof n=="string")x=CT(n,o,Ce.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case A:return n=Nr(31,o,r,f),n.elementType=A,n.lanes=m,n;case G:return _o(o.children,f,m,r);case B:x=8,f|=24;break;case Y:return n=Nr(12,o,r,f|2),n.elementType=Y,n.lanes=m,n;case ve:return n=Nr(13,o,r,f),n.elementType=ve,n.lanes=m,n;case he:return n=Nr(19,o,r,f),n.elementType=he,n.lanes=m,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case re:x=10;break e;case ee:x=9;break e;case pe:x=11;break e;case L:x=14;break e;case E:x=16,u=null;break e}x=29,o=Error(i(130,n===null?"null":typeof n,"")),u=null}return r=Nr(x,o,r,f),r.elementType=n,r.type=u,r.lanes=m,r}function _o(n,r,o,u){return n=Nr(7,n,u,r),n.lanes=o,n}function $f(n,r,o){return n=Nr(6,n,null,r),n.lanes=o,n}function Y0(n){var r=Nr(18,null,null,0);return r.stateNode=n,r}function Wf(n,r,o){return r=Nr(4,n.children!==null?n.children:[],n.key,r),r.lanes=o,r.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},r}var Q0=new WeakMap;function Hr(n,r){if(typeof n=="object"&&n!==null){var o=Q0.get(n);return o!==void 0?o:(r={value:n,source:r,stack:dt(r)},Q0.set(n,r),r)}return{value:n,source:r,stack:dt(r)}}var dl=[],hl=0,dd=null,vc=0,qr=[],$r=0,Sa=null,Ti=1,Si="";function $i(n,r){dl[hl++]=vc,dl[hl++]=dd,dd=n,vc=r}function X0(n,r,o){qr[$r++]=Ti,qr[$r++]=Si,qr[$r++]=Sa,Sa=n;var u=Ti;n=Si;var f=32-Mt(u)-1;u&=~(1<<f),o+=1;var m=32-Mt(r)+f;if(30<m){var x=f-f%5;m=(u&(1<<x)-1).toString(32),u>>=x,f-=x,Ti=1<<32-Mt(r)+f|o<<f|u,Si=m+n}else Ti=1<<m|o<<f|u,Si=n}function Gf(n){n.return!==null&&($i(n,1),X0(n,1,0))}function Kf(n){for(;n===dd;)dd=dl[--hl],dl[hl]=null,vc=dl[--hl],dl[hl]=null;for(;n===Sa;)Sa=qr[--$r],qr[$r]=null,Si=qr[--$r],qr[$r]=null,Ti=qr[--$r],qr[$r]=null}function J0(n,r){qr[$r++]=Ti,qr[$r++]=Si,qr[$r++]=Sa,Ti=r.id,Si=r.overflow,Sa=n}var Ps=null,Un=null,on=!1,Ca=null,Wr=!1,Yf=Error(i(519));function Na(n){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw bc(Hr(r,n)),Yf}function Z0(n){var r=n.stateNode,o=n.type,u=n.memoizedProps;switch(r[At]=n,r[St]=u,o){case"dialog":Qt("cancel",r),Qt("close",r);break;case"iframe":case"object":case"embed":Qt("load",r);break;case"video":case"audio":for(o=0;o<zc.length;o++)Qt(zc[o],r);break;case"source":Qt("error",r);break;case"img":case"image":case"link":Qt("error",r),Qt("load",r);break;case"details":Qt("toggle",r);break;case"input":Qt("invalid",r),ri(r,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":Qt("invalid",r);break;case"textarea":Qt("invalid",r),Er(r,u.value,u.defaultValue,u.children)}o=u.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||r.textContent===""+o||u.suppressHydrationWarning===!0||pb(r.textContent,o)?(u.popover!=null&&(Qt("beforetoggle",r),Qt("toggle",r)),u.onScroll!=null&&Qt("scroll",r),u.onScrollEnd!=null&&Qt("scrollend",r),u.onClick!=null&&(r.onclick=Ws),r=!0):r=!1,r||Na(n,!0)}function ev(n){for(Ps=n.return;Ps;)switch(Ps.tag){case 5:case 31:case 13:Wr=!1;return;case 27:case 3:Wr=!0;return;default:Ps=Ps.return}}function fl(n){if(n!==Ps)return!1;if(!on)return ev(n),on=!0,!1;var r=n.tag,o;if((o=r!==3&&r!==27)&&((o=r===5)&&(o=n.type,o=!(o!=="form"&&o!=="button")||fg(n.type,n.memoizedProps)),o=!o),o&&Un&&Na(n),ev(n),r===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));Un=Eb(n)}else if(r===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));Un=Eb(n)}else r===27?(r=Un,Ha(n.type)?(n=vg,vg=null,Un=n):Un=r):Un=Ps?Kr(n.stateNode.nextSibling):null;return!0}function ko(){Un=Ps=null,on=!1}function Qf(){var n=Ca;return n!==null&&(pr===null?pr=n:pr.push.apply(pr,n),Ca=null),n}function bc(n){Ca===null?Ca=[n]:Ca.push(n)}var Xf=U(null),jo=null,Wi=null;function Aa(n,r,o){Ee(Xf,r._currentValue),r._currentValue=o}function Gi(n){n._currentValue=Xf.current,ce(Xf)}function Jf(n,r,o){for(;n!==null;){var u=n.alternate;if((n.childLanes&r)!==r?(n.childLanes|=r,u!==null&&(u.childLanes|=r)):u!==null&&(u.childLanes&r)!==r&&(u.childLanes|=r),n===o)break;n=n.return}}function Zf(n,r,o,u){var f=n.child;for(f!==null&&(f.return=n);f!==null;){var m=f.dependencies;if(m!==null){var x=f.child;m=m.firstContext;e:for(;m!==null;){var T=m;m=f;for(var z=0;z<r.length;z++)if(T.context===r[z]){m.lanes|=o,T=m.alternate,T!==null&&(T.lanes|=o),Jf(m.return,o,n),u||(x=null);break e}m=T.next}}else if(f.tag===18){if(x=f.return,x===null)throw Error(i(341));x.lanes|=o,m=x.alternate,m!==null&&(m.lanes|=o),Jf(x,o,n),x=null}else x=f.child;if(x!==null)x.return=f;else for(x=f;x!==null;){if(x===n){x=null;break}if(f=x.sibling,f!==null){f.return=x.return,x=f;break}x=x.return}f=x}}function ml(n,r,o,u){n=null;for(var f=r,m=!1;f!==null;){if(!m){if((f.flags&524288)!==0)m=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var x=f.alternate;if(x===null)throw Error(i(387));if(x=x.memoizedProps,x!==null){var T=f.type;Cr(f.pendingProps.value,x.value)||(n!==null?n.push(T):n=[T])}}else if(f===$e.current){if(x=f.alternate,x===null)throw Error(i(387));x.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(n!==null?n.push(Wc):n=[Wc])}f=f.return}n!==null&&Zf(r,n,o,u),r.flags|=262144}function hd(n){for(n=n.firstContext;n!==null;){if(!Cr(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function Eo(n){jo=n,Wi=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Os(n){return tv(jo,n)}function fd(n,r){return jo===null&&Eo(n),tv(n,r)}function tv(n,r){var o=r._currentValue;if(r={context:r,memoizedValue:o,next:null},Wi===null){if(n===null)throw Error(i(308));Wi=r,n.dependencies={lanes:0,firstContext:r},n.flags|=524288}else Wi=Wi.next=r;return o}var jE=typeof AbortController<"u"?AbortController:function(){var n=[],r=this.signal={aborted:!1,addEventListener:function(o,u){n.push(u)}};this.abort=function(){r.aborted=!0,n.forEach(function(o){return o()})}},EE=s.unstable_scheduleCallback,TE=s.unstable_NormalPriority,gs={$$typeof:re,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function em(){return{controller:new jE,data:new Map,refCount:0}}function wc(n){n.refCount--,n.refCount===0&&EE(TE,function(){n.controller.abort()})}var xc=null,tm=0,gl=0,pl=null;function SE(n,r){if(xc===null){var o=xc=[];tm=0,gl=rg(),pl={status:"pending",value:void 0,then:function(u){o.push(u)}}}return tm++,r.then(nv,nv),r}function nv(){if(--tm===0&&xc!==null){pl!==null&&(pl.status="fulfilled");var n=xc;xc=null,gl=0,pl=null;for(var r=0;r<n.length;r++)(0,n[r])()}}function CE(n,r){var o=[],u={status:"pending",value:null,reason:null,then:function(f){o.push(f)}};return n.then(function(){u.status="fulfilled",u.value=r;for(var f=0;f<o.length;f++)(0,o[f])(r)},function(f){for(u.status="rejected",u.reason=f,f=0;f<o.length;f++)(0,o[f])(void 0)}),u}var sv=J.S;J.S=function(n,r){B1=gt(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&SE(n,r),sv!==null&&sv(n,r)};var To=U(null);function nm(){var n=To.current;return n!==null?n:Mn.pooledCache}function md(n,r){r===null?Ee(To,To.current):Ee(To,r.pool)}function rv(){var n=nm();return n===null?null:{parent:gs._currentValue,pool:n}}var yl=Error(i(460)),sm=Error(i(474)),gd=Error(i(542)),pd={then:function(){}};function iv(n){return n=n.status,n==="fulfilled"||n==="rejected"}function av(n,r,o){switch(o=n[o],o===void 0?n.push(r):o!==r&&(r.then(Ws,Ws),r=o),r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,lv(n),n;default:if(typeof r.status=="string")r.then(Ws,Ws);else{if(n=Mn,n!==null&&100<n.shellSuspendCounter)throw Error(i(482));n=r,n.status="pending",n.then(function(u){if(r.status==="pending"){var f=r;f.status="fulfilled",f.value=u}},function(u){if(r.status==="pending"){var f=r;f.status="rejected",f.reason=u}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,lv(n),n}throw Co=r,yl}}function So(n){try{var r=n._init;return r(n._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(Co=o,yl):o}}var Co=null;function ov(){if(Co===null)throw Error(i(459));var n=Co;return Co=null,n}function lv(n){if(n===yl||n===gd)throw Error(i(483))}var vl=null,_c=0;function yd(n){var r=_c;return _c+=1,vl===null&&(vl=[]),av(vl,n,r)}function kc(n,r){r=r.props.ref,n.ref=r!==void 0?r:null}function vd(n,r){throw r.$$typeof===j?Error(i(525)):(n=Object.prototype.toString.call(r),Error(i(31,n==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":n)))}function cv(n){function r(X,W){if(n){var ie=X.deletions;ie===null?(X.deletions=[W],X.flags|=16):ie.push(W)}}function o(X,W){if(!n)return null;for(;W!==null;)r(X,W),W=W.sibling;return null}function u(X){for(var W=new Map;X!==null;)X.key!==null?W.set(X.key,X):W.set(X.index,X),X=X.sibling;return W}function f(X,W){return X=qi(X,W),X.index=0,X.sibling=null,X}function m(X,W,ie){return X.index=ie,n?(ie=X.alternate,ie!==null?(ie=ie.index,ie<W?(X.flags|=67108866,W):ie):(X.flags|=67108866,W)):(X.flags|=1048576,W)}function x(X){return n&&X.alternate===null&&(X.flags|=67108866),X}function T(X,W,ie,xe){return W===null||W.tag!==6?(W=$f(ie,X.mode,xe),W.return=X,W):(W=f(W,ie),W.return=X,W)}function z(X,W,ie,xe){var ht=ie.type;return ht===G?we(X,W,ie.props.children,xe,ie.key):W!==null&&(W.elementType===ht||typeof ht=="object"&&ht!==null&&ht.$$typeof===E&&So(ht)===W.type)?(W=f(W,ie.props),kc(W,ie),W.return=X,W):(W=ud(ie.type,ie.key,ie.props,null,X.mode,xe),kc(W,ie),W.return=X,W)}function ae(X,W,ie,xe){return W===null||W.tag!==4||W.stateNode.containerInfo!==ie.containerInfo||W.stateNode.implementation!==ie.implementation?(W=Wf(ie,X.mode,xe),W.return=X,W):(W=f(W,ie.children||[]),W.return=X,W)}function we(X,W,ie,xe,ht){return W===null||W.tag!==7?(W=_o(ie,X.mode,xe,ht),W.return=X,W):(W=f(W,ie),W.return=X,W)}function Te(X,W,ie){if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return W=$f(""+W,X.mode,ie),W.return=X,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case I:return ie=ud(W.type,W.key,W.props,null,X.mode,ie),kc(ie,W),ie.return=X,ie;case F:return W=Wf(W,X.mode,ie),W.return=X,W;case E:return W=So(W),Te(X,W,ie)}if(Qe(W)||P(W))return W=_o(W,X.mode,ie,null),W.return=X,W;if(typeof W.then=="function")return Te(X,yd(W),ie);if(W.$$typeof===re)return Te(X,fd(X,W),ie);vd(X,W)}return null}function de(X,W,ie,xe){var ht=W!==null?W.key:null;if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return ht!==null?null:T(X,W,""+ie,xe);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case I:return ie.key===ht?z(X,W,ie,xe):null;case F:return ie.key===ht?ae(X,W,ie,xe):null;case E:return ie=So(ie),de(X,W,ie,xe)}if(Qe(ie)||P(ie))return ht!==null?null:we(X,W,ie,xe,null);if(typeof ie.then=="function")return de(X,W,yd(ie),xe);if(ie.$$typeof===re)return de(X,W,fd(X,ie),xe);vd(X,ie)}return null}function ge(X,W,ie,xe,ht){if(typeof xe=="string"&&xe!==""||typeof xe=="number"||typeof xe=="bigint")return X=X.get(ie)||null,T(W,X,""+xe,ht);if(typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case I:return X=X.get(xe.key===null?ie:xe.key)||null,z(W,X,xe,ht);case F:return X=X.get(xe.key===null?ie:xe.key)||null,ae(W,X,xe,ht);case E:return xe=So(xe),ge(X,W,ie,xe,ht)}if(Qe(xe)||P(xe))return X=X.get(ie)||null,we(W,X,xe,ht,null);if(typeof xe.then=="function")return ge(X,W,ie,yd(xe),ht);if(xe.$$typeof===re)return ge(X,W,ie,fd(W,xe),ht);vd(W,xe)}return null}function et(X,W,ie,xe){for(var ht=null,yn=null,at=W,Ft=W=0,Zt=null;at!==null&&Ft<ie.length;Ft++){at.index>Ft?(Zt=at,at=null):Zt=at.sibling;var vn=de(X,at,ie[Ft],xe);if(vn===null){at===null&&(at=Zt);break}n&&at&&vn.alternate===null&&r(X,at),W=m(vn,W,Ft),yn===null?ht=vn:yn.sibling=vn,yn=vn,at=Zt}if(Ft===ie.length)return o(X,at),on&&$i(X,Ft),ht;if(at===null){for(;Ft<ie.length;Ft++)at=Te(X,ie[Ft],xe),at!==null&&(W=m(at,W,Ft),yn===null?ht=at:yn.sibling=at,yn=at);return on&&$i(X,Ft),ht}for(at=u(at);Ft<ie.length;Ft++)Zt=ge(at,X,Ft,ie[Ft],xe),Zt!==null&&(n&&Zt.alternate!==null&&at.delete(Zt.key===null?Ft:Zt.key),W=m(Zt,W,Ft),yn===null?ht=Zt:yn.sibling=Zt,yn=Zt);return n&&at.forEach(function(Ka){return r(X,Ka)}),on&&$i(X,Ft),ht}function wt(X,W,ie,xe){if(ie==null)throw Error(i(151));for(var ht=null,yn=null,at=W,Ft=W=0,Zt=null,vn=ie.next();at!==null&&!vn.done;Ft++,vn=ie.next()){at.index>Ft?(Zt=at,at=null):Zt=at.sibling;var Ka=de(X,at,vn.value,xe);if(Ka===null){at===null&&(at=Zt);break}n&&at&&Ka.alternate===null&&r(X,at),W=m(Ka,W,Ft),yn===null?ht=Ka:yn.sibling=Ka,yn=Ka,at=Zt}if(vn.done)return o(X,at),on&&$i(X,Ft),ht;if(at===null){for(;!vn.done;Ft++,vn=ie.next())vn=Te(X,vn.value,xe),vn!==null&&(W=m(vn,W,Ft),yn===null?ht=vn:yn.sibling=vn,yn=vn);return on&&$i(X,Ft),ht}for(at=u(at);!vn.done;Ft++,vn=ie.next())vn=ge(at,X,Ft,vn.value,xe),vn!==null&&(n&&vn.alternate!==null&&at.delete(vn.key===null?Ft:vn.key),W=m(vn,W,Ft),yn===null?ht=vn:yn.sibling=vn,yn=vn);return n&&at.forEach(function(UT){return r(X,UT)}),on&&$i(X,Ft),ht}function In(X,W,ie,xe){if(typeof ie=="object"&&ie!==null&&ie.type===G&&ie.key===null&&(ie=ie.props.children),typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case I:e:{for(var ht=ie.key;W!==null;){if(W.key===ht){if(ht=ie.type,ht===G){if(W.tag===7){o(X,W.sibling),xe=f(W,ie.props.children),xe.return=X,X=xe;break e}}else if(W.elementType===ht||typeof ht=="object"&&ht!==null&&ht.$$typeof===E&&So(ht)===W.type){o(X,W.sibling),xe=f(W,ie.props),kc(xe,ie),xe.return=X,X=xe;break e}o(X,W);break}else r(X,W);W=W.sibling}ie.type===G?(xe=_o(ie.props.children,X.mode,xe,ie.key),xe.return=X,X=xe):(xe=ud(ie.type,ie.key,ie.props,null,X.mode,xe),kc(xe,ie),xe.return=X,X=xe)}return x(X);case F:e:{for(ht=ie.key;W!==null;){if(W.key===ht)if(W.tag===4&&W.stateNode.containerInfo===ie.containerInfo&&W.stateNode.implementation===ie.implementation){o(X,W.sibling),xe=f(W,ie.children||[]),xe.return=X,X=xe;break e}else{o(X,W);break}else r(X,W);W=W.sibling}xe=Wf(ie,X.mode,xe),xe.return=X,X=xe}return x(X);case E:return ie=So(ie),In(X,W,ie,xe)}if(Qe(ie))return et(X,W,ie,xe);if(P(ie)){if(ht=P(ie),typeof ht!="function")throw Error(i(150));return ie=ht.call(ie),wt(X,W,ie,xe)}if(typeof ie.then=="function")return In(X,W,yd(ie),xe);if(ie.$$typeof===re)return In(X,W,fd(X,ie),xe);vd(X,ie)}return typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint"?(ie=""+ie,W!==null&&W.tag===6?(o(X,W.sibling),xe=f(W,ie),xe.return=X,X=xe):(o(X,W),xe=$f(ie,X.mode,xe),xe.return=X,X=xe),x(X)):o(X,W)}return function(X,W,ie,xe){try{_c=0;var ht=In(X,W,ie,xe);return vl=null,ht}catch(at){if(at===yl||at===gd)throw at;var yn=Nr(29,at,null,X.mode);return yn.lanes=xe,yn.return=X,yn}}}var No=cv(!0),uv=cv(!1),Ra=!1;function rm(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function im(n,r){n=n.updateQueue,r.updateQueue===n&&(r.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Ia(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Ma(n,r,o){var u=n.updateQueue;if(u===null)return null;if(u=u.shared,(_n&2)!==0){var f=u.pending;return f===null?r.next=r:(r.next=f.next,f.next=r),u.pending=r,r=cd(n),G0(n,null,o),r}return ld(n,u,r,o),cd(n)}function jc(n,r,o){if(r=r.updateQueue,r!==null&&(r=r.shared,(o&4194048)!==0)){var u=r.lanes;u&=n.pendingLanes,o|=u,r.lanes=o,ue(n,o)}}function am(n,r){var o=n.updateQueue,u=n.alternate;if(u!==null&&(u=u.updateQueue,o===u)){var f=null,m=null;if(o=o.firstBaseUpdate,o!==null){do{var x={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};m===null?f=m=x:m=m.next=x,o=o.next}while(o!==null);m===null?f=m=r:m=m.next=r}else f=m=r;o={baseState:u.baseState,firstBaseUpdate:f,lastBaseUpdate:m,shared:u.shared,callbacks:u.callbacks},n.updateQueue=o;return}n=o.lastBaseUpdate,n===null?o.firstBaseUpdate=r:n.next=r,o.lastBaseUpdate=r}var om=!1;function Ec(){if(om){var n=pl;if(n!==null)throw n}}function Tc(n,r,o,u){om=!1;var f=n.updateQueue;Ra=!1;var m=f.firstBaseUpdate,x=f.lastBaseUpdate,T=f.shared.pending;if(T!==null){f.shared.pending=null;var z=T,ae=z.next;z.next=null,x===null?m=ae:x.next=ae,x=z;var we=n.alternate;we!==null&&(we=we.updateQueue,T=we.lastBaseUpdate,T!==x&&(T===null?we.firstBaseUpdate=ae:T.next=ae,we.lastBaseUpdate=z))}if(m!==null){var Te=f.baseState;x=0,we=ae=z=null,T=m;do{var de=T.lane&-536870913,ge=de!==T.lane;if(ge?(Jt&de)===de:(u&de)===de){de!==0&&de===gl&&(om=!0),we!==null&&(we=we.next={lane:0,tag:T.tag,payload:T.payload,callback:null,next:null});e:{var et=n,wt=T;de=r;var In=o;switch(wt.tag){case 1:if(et=wt.payload,typeof et=="function"){Te=et.call(In,Te,de);break e}Te=et;break e;case 3:et.flags=et.flags&-65537|128;case 0:if(et=wt.payload,de=typeof et=="function"?et.call(In,Te,de):et,de==null)break e;Te=_({},Te,de);break e;case 2:Ra=!0}}de=T.callback,de!==null&&(n.flags|=64,ge&&(n.flags|=8192),ge=f.callbacks,ge===null?f.callbacks=[de]:ge.push(de))}else ge={lane:de,tag:T.tag,payload:T.payload,callback:T.callback,next:null},we===null?(ae=we=ge,z=Te):we=we.next=ge,x|=de;if(T=T.next,T===null){if(T=f.shared.pending,T===null)break;ge=T,T=ge.next,ge.next=null,f.lastBaseUpdate=ge,f.shared.pending=null}}while(!0);we===null&&(z=Te),f.baseState=z,f.firstBaseUpdate=ae,f.lastBaseUpdate=we,m===null&&(f.shared.lanes=0),Va|=x,n.lanes=x,n.memoizedState=Te}}function dv(n,r){if(typeof n!="function")throw Error(i(191,n));n.call(r)}function hv(n,r){var o=n.callbacks;if(o!==null)for(n.callbacks=null,n=0;n<o.length;n++)dv(o[n],r)}var bl=U(null),bd=U(0);function fv(n,r){n=na,Ee(bd,n),Ee(bl,r),na=n|r.baseLanes}function lm(){Ee(bd,na),Ee(bl,bl.current)}function cm(){na=bd.current,ce(bl),ce(bd)}var Ar=U(null),Gr=null;function Da(n){var r=n.alternate;Ee(us,us.current&1),Ee(Ar,n),Gr===null&&(r===null||bl.current!==null||r.memoizedState!==null)&&(Gr=n)}function um(n){Ee(us,us.current),Ee(Ar,n),Gr===null&&(Gr=n)}function mv(n){n.tag===22?(Ee(us,us.current),Ee(Ar,n),Gr===null&&(Gr=n)):La()}function La(){Ee(us,us.current),Ee(Ar,Ar.current)}function Rr(n){ce(Ar),Gr===n&&(Gr=null),ce(us)}var us=U(0);function wd(n){for(var r=n;r!==null;){if(r.tag===13){var o=r.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||pg(o)||yg(o)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Ki=0,Ut=null,An=null,ps=null,xd=!1,wl=!1,Ao=!1,_d=0,Sc=0,xl=null,NE=0;function ns(){throw Error(i(321))}function dm(n,r){if(r===null)return!1;for(var o=0;o<r.length&&o<n.length;o++)if(!Cr(n[o],r[o]))return!1;return!0}function hm(n,r,o,u,f,m){return Ki=m,Ut=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,J.H=n===null||n.memoizedState===null?Xv:Sm,Ao=!1,m=o(u,f),Ao=!1,wl&&(m=pv(r,o,u,f)),gv(n),m}function gv(n){J.H=Ac;var r=An!==null&&An.next!==null;if(Ki=0,ps=An=Ut=null,xd=!1,Sc=0,xl=null,r)throw Error(i(300));n===null||ys||(n=n.dependencies,n!==null&&hd(n)&&(ys=!0))}function pv(n,r,o,u){Ut=n;var f=0;do{if(wl&&(xl=null),Sc=0,wl=!1,25<=f)throw Error(i(301));if(f+=1,ps=An=null,n.updateQueue!=null){var m=n.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}J.H=Jv,m=r(o,u)}while(wl);return m}function AE(){var n=J.H,r=n.useState()[0];return r=typeof r.then=="function"?Cc(r):r,n=n.useState()[0],(An!==null?An.memoizedState:null)!==n&&(Ut.flags|=1024),r}function fm(){var n=_d!==0;return _d=0,n}function mm(n,r,o){r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~o}function gm(n){if(xd){for(n=n.memoizedState;n!==null;){var r=n.queue;r!==null&&(r.pending=null),n=n.next}xd=!1}Ki=0,ps=An=Ut=null,wl=!1,Sc=_d=0,xl=null}function rr(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ps===null?Ut.memoizedState=ps=n:ps=ps.next=n,ps}function ds(){if(An===null){var n=Ut.alternate;n=n!==null?n.memoizedState:null}else n=An.next;var r=ps===null?Ut.memoizedState:ps.next;if(r!==null)ps=r,An=n;else{if(n===null)throw Ut.alternate===null?Error(i(467)):Error(i(310));An=n,n={memoizedState:An.memoizedState,baseState:An.baseState,baseQueue:An.baseQueue,queue:An.queue,next:null},ps===null?Ut.memoizedState=ps=n:ps=ps.next=n}return ps}function kd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Cc(n){var r=Sc;return Sc+=1,xl===null&&(xl=[]),n=av(xl,n,r),r=Ut,(ps===null?r.memoizedState:ps.next)===null&&(r=r.alternate,J.H=r===null||r.memoizedState===null?Xv:Sm),n}function jd(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return Cc(n);if(n.$$typeof===re)return Os(n)}throw Error(i(438,String(n)))}function pm(n){var r=null,o=Ut.updateQueue;if(o!==null&&(r=o.memoCache),r==null){var u=Ut.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(r={data:u.data.map(function(f){return f.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),o===null&&(o=kd(),Ut.updateQueue=o),o.memoCache=r,o=r.data[r.index],o===void 0)for(o=r.data[r.index]=Array(n),u=0;u<n;u++)o[u]=V;return r.index++,o}function Yi(n,r){return typeof r=="function"?r(n):r}function Ed(n){var r=ds();return ym(r,An,n)}function ym(n,r,o){var u=n.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=o;var f=n.baseQueue,m=u.pending;if(m!==null){if(f!==null){var x=f.next;f.next=m.next,m.next=x}r.baseQueue=f=m,u.pending=null}if(m=n.baseState,f===null)n.memoizedState=m;else{r=f.next;var T=x=null,z=null,ae=r,we=!1;do{var Te=ae.lane&-536870913;if(Te!==ae.lane?(Jt&Te)===Te:(Ki&Te)===Te){var de=ae.revertLane;if(de===0)z!==null&&(z=z.next={lane:0,revertLane:0,gesture:null,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null}),Te===gl&&(we=!0);else if((Ki&de)===de){ae=ae.next,de===gl&&(we=!0);continue}else Te={lane:0,revertLane:ae.revertLane,gesture:null,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null},z===null?(T=z=Te,x=m):z=z.next=Te,Ut.lanes|=de,Va|=de;Te=ae.action,Ao&&o(m,Te),m=ae.hasEagerState?ae.eagerState:o(m,Te)}else de={lane:Te,revertLane:ae.revertLane,gesture:ae.gesture,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null},z===null?(T=z=de,x=m):z=z.next=de,Ut.lanes|=Te,Va|=Te;ae=ae.next}while(ae!==null&&ae!==r);if(z===null?x=m:z.next=T,!Cr(m,n.memoizedState)&&(ys=!0,we&&(o=pl,o!==null)))throw o;n.memoizedState=m,n.baseState=x,n.baseQueue=z,u.lastRenderedState=m}return f===null&&(u.lanes=0),[n.memoizedState,u.dispatch]}function vm(n){var r=ds(),o=r.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=n;var u=o.dispatch,f=o.pending,m=r.memoizedState;if(f!==null){o.pending=null;var x=f=f.next;do m=n(m,x.action),x=x.next;while(x!==f);Cr(m,r.memoizedState)||(ys=!0),r.memoizedState=m,r.baseQueue===null&&(r.baseState=m),o.lastRenderedState=m}return[m,u]}function yv(n,r,o){var u=Ut,f=ds(),m=on;if(m){if(o===void 0)throw Error(i(407));o=o()}else o=r();var x=!Cr((An||f).memoizedState,o);if(x&&(f.memoizedState=o,ys=!0),f=f.queue,xm(wv.bind(null,u,f,n),[n]),f.getSnapshot!==r||x||ps!==null&&ps.memoizedState.tag&1){if(u.flags|=2048,_l(9,{destroy:void 0},bv.bind(null,u,f,o,r),null),Mn===null)throw Error(i(349));m||(Ki&127)!==0||vv(u,r,o)}return o}function vv(n,r,o){n.flags|=16384,n={getSnapshot:r,value:o},r=Ut.updateQueue,r===null?(r=kd(),Ut.updateQueue=r,r.stores=[n]):(o=r.stores,o===null?r.stores=[n]:o.push(n))}function bv(n,r,o,u){r.value=o,r.getSnapshot=u,xv(r)&&_v(n)}function wv(n,r,o){return o(function(){xv(r)&&_v(n)})}function xv(n){var r=n.getSnapshot;n=n.value;try{var o=r();return!Cr(n,o)}catch{return!0}}function _v(n){var r=xo(n,2);r!==null&&yr(r,n,2)}function bm(n){var r=rr();if(typeof n=="function"){var o=n;if(n=o(),Ao){Ct(!0);try{o()}finally{Ct(!1)}}}return r.memoizedState=r.baseState=n,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yi,lastRenderedState:n},r}function kv(n,r,o,u){return n.baseState=o,ym(n,An,typeof u=="function"?u:Yi)}function RE(n,r,o,u,f){if(Cd(n))throw Error(i(485));if(n=r.action,n!==null){var m={payload:f,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(x){m.listeners.push(x)}};J.T!==null?o(!0):m.isTransition=!1,u(m),o=r.pending,o===null?(m.next=r.pending=m,jv(r,m)):(m.next=o.next,r.pending=o.next=m)}}function jv(n,r){var o=r.action,u=r.payload,f=n.state;if(r.isTransition){var m=J.T,x={};J.T=x;try{var T=o(f,u),z=J.S;z!==null&&z(x,T),Ev(n,r,T)}catch(ae){wm(n,r,ae)}finally{m!==null&&x.types!==null&&(m.types=x.types),J.T=m}}else try{m=o(f,u),Ev(n,r,m)}catch(ae){wm(n,r,ae)}}function Ev(n,r,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(u){Tv(n,r,u)},function(u){return wm(n,r,u)}):Tv(n,r,o)}function Tv(n,r,o){r.status="fulfilled",r.value=o,Sv(r),n.state=o,r=n.pending,r!==null&&(o=r.next,o===r?n.pending=null:(o=o.next,r.next=o,jv(n,o)))}function wm(n,r,o){var u=n.pending;if(n.pending=null,u!==null){u=u.next;do r.status="rejected",r.reason=o,Sv(r),r=r.next;while(r!==u)}n.action=null}function Sv(n){n=n.listeners;for(var r=0;r<n.length;r++)(0,n[r])()}function Cv(n,r){return r}function Nv(n,r){if(on){var o=Mn.formState;if(o!==null){e:{var u=Ut;if(on){if(Un){t:{for(var f=Un,m=Wr;f.nodeType!==8;){if(!m){f=null;break t}if(f=Kr(f.nextSibling),f===null){f=null;break t}}m=f.data,f=m==="F!"||m==="F"?f:null}if(f){Un=Kr(f.nextSibling),u=f.data==="F!";break e}}Na(u)}u=!1}u&&(r=o[0])}}return o=rr(),o.memoizedState=o.baseState=r,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Cv,lastRenderedState:r},o.queue=u,o=Kv.bind(null,Ut,u),u.dispatch=o,u=bm(!1),m=Tm.bind(null,Ut,!1,u.queue),u=rr(),f={state:r,dispatch:null,action:n,pending:null},u.queue=f,o=RE.bind(null,Ut,f,m,o),f.dispatch=o,u.memoizedState=n,[r,o,!1]}function Av(n){var r=ds();return Rv(r,An,n)}function Rv(n,r,o){if(r=ym(n,r,Cv)[0],n=Ed(Yi)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var u=Cc(r)}catch(x){throw x===yl?gd:x}else u=r;r=ds();var f=r.queue,m=f.dispatch;return o!==r.memoizedState&&(Ut.flags|=2048,_l(9,{destroy:void 0},IE.bind(null,f,o),null)),[u,m,n]}function IE(n,r){n.action=r}function Iv(n){var r=ds(),o=An;if(o!==null)return Rv(r,o,n);ds(),r=r.memoizedState,o=ds();var u=o.queue.dispatch;return o.memoizedState=n,[r,u,!1]}function _l(n,r,o,u){return n={tag:n,create:o,deps:u,inst:r,next:null},r=Ut.updateQueue,r===null&&(r=kd(),Ut.updateQueue=r),o=r.lastEffect,o===null?r.lastEffect=n.next=n:(u=o.next,o.next=n,n.next=u,r.lastEffect=n),n}function Mv(){return ds().memoizedState}function Td(n,r,o,u){var f=rr();Ut.flags|=n,f.memoizedState=_l(1|r,{destroy:void 0},o,u===void 0?null:u)}function Sd(n,r,o,u){var f=ds();u=u===void 0?null:u;var m=f.memoizedState.inst;An!==null&&u!==null&&dm(u,An.memoizedState.deps)?f.memoizedState=_l(r,m,o,u):(Ut.flags|=n,f.memoizedState=_l(1|r,m,o,u))}function Dv(n,r){Td(8390656,8,n,r)}function xm(n,r){Sd(2048,8,n,r)}function ME(n){Ut.flags|=4;var r=Ut.updateQueue;if(r===null)r=kd(),Ut.updateQueue=r,r.events=[n];else{var o=r.events;o===null?r.events=[n]:o.push(n)}}function Lv(n){var r=ds().memoizedState;return ME({ref:r,nextImpl:n}),function(){if((_n&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function Pv(n,r){return Sd(4,2,n,r)}function Ov(n,r){return Sd(4,4,n,r)}function Vv(n,r){if(typeof r=="function"){n=n();var o=r(n);return function(){typeof o=="function"?o():r(null)}}if(r!=null)return n=n(),r.current=n,function(){r.current=null}}function Uv(n,r,o){o=o!=null?o.concat([n]):null,Sd(4,4,Vv.bind(null,r,n),o)}function _m(){}function Bv(n,r){var o=ds();r=r===void 0?null:r;var u=o.memoizedState;return r!==null&&dm(r,u[1])?u[0]:(o.memoizedState=[n,r],n)}function zv(n,r){var o=ds();r=r===void 0?null:r;var u=o.memoizedState;if(r!==null&&dm(r,u[1]))return u[0];if(u=n(),Ao){Ct(!0);try{n()}finally{Ct(!1)}}return o.memoizedState=[u,r],u}function km(n,r,o){return o===void 0||(Ki&1073741824)!==0&&(Jt&261930)===0?n.memoizedState=r:(n.memoizedState=o,n=F1(),Ut.lanes|=n,Va|=n,o)}function Fv(n,r,o,u){return Cr(o,r)?o:bl.current!==null?(n=km(n,o,u),Cr(n,r)||(ys=!0),n):(Ki&42)===0||(Ki&1073741824)!==0&&(Jt&261930)===0?(ys=!0,n.memoizedState=o):(n=F1(),Ut.lanes|=n,Va|=n,r)}function Hv(n,r,o,u,f){var m=Se.p;Se.p=m!==0&&8>m?m:8;var x=J.T,T={};J.T=T,Tm(n,!1,r,o);try{var z=f(),ae=J.S;if(ae!==null&&ae(T,z),z!==null&&typeof z=="object"&&typeof z.then=="function"){var we=CE(z,u);Nc(n,r,we,Dr(n))}else Nc(n,r,u,Dr(n))}catch(Te){Nc(n,r,{then:function(){},status:"rejected",reason:Te},Dr())}finally{Se.p=m,x!==null&&T.types!==null&&(x.types=T.types),J.T=x}}function DE(){}function jm(n,r,o,u){if(n.tag!==5)throw Error(i(476));var f=qv(n).queue;Hv(n,f,r,He,o===null?DE:function(){return $v(n),o(u)})}function qv(n){var r=n.memoizedState;if(r!==null)return r;r={memoizedState:He,baseState:He,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yi,lastRenderedState:He},next:null};var o={};return r.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yi,lastRenderedState:o},next:null},n.memoizedState=r,n=n.alternate,n!==null&&(n.memoizedState=r),r}function $v(n){var r=qv(n);r.next===null&&(r=n.alternate.memoizedState),Nc(n,r.next.queue,{},Dr())}function Em(){return Os(Wc)}function Wv(){return ds().memoizedState}function Gv(){return ds().memoizedState}function LE(n){for(var r=n.return;r!==null;){switch(r.tag){case 24:case 3:var o=Dr();n=Ia(o);var u=Ma(r,n,o);u!==null&&(yr(u,r,o),jc(u,r,o)),r={cache:em()},n.payload=r;return}r=r.return}}function PE(n,r,o){var u=Dr();o={lane:u,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},Cd(n)?Yv(r,o):(o=Hf(n,r,o,u),o!==null&&(yr(o,n,u),Qv(o,r,u)))}function Kv(n,r,o){var u=Dr();Nc(n,r,o,u)}function Nc(n,r,o,u){var f={lane:u,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(Cd(n))Yv(r,f);else{var m=n.alternate;if(n.lanes===0&&(m===null||m.lanes===0)&&(m=r.lastRenderedReducer,m!==null))try{var x=r.lastRenderedState,T=m(x,o);if(f.hasEagerState=!0,f.eagerState=T,Cr(T,x))return ld(n,r,f,0),Mn===null&&od(),!1}catch{}if(o=Hf(n,r,f,u),o!==null)return yr(o,n,u),Qv(o,r,u),!0}return!1}function Tm(n,r,o,u){if(u={lane:2,revertLane:rg(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},Cd(n)){if(r)throw Error(i(479))}else r=Hf(n,o,u,2),r!==null&&yr(r,n,2)}function Cd(n){var r=n.alternate;return n===Ut||r!==null&&r===Ut}function Yv(n,r){wl=xd=!0;var o=n.pending;o===null?r.next=r:(r.next=o.next,o.next=r),n.pending=r}function Qv(n,r,o){if((o&4194048)!==0){var u=r.lanes;u&=n.pendingLanes,o|=u,r.lanes=o,ue(n,o)}}var Ac={readContext:Os,use:jd,useCallback:ns,useContext:ns,useEffect:ns,useImperativeHandle:ns,useLayoutEffect:ns,useInsertionEffect:ns,useMemo:ns,useReducer:ns,useRef:ns,useState:ns,useDebugValue:ns,useDeferredValue:ns,useTransition:ns,useSyncExternalStore:ns,useId:ns,useHostTransitionStatus:ns,useFormState:ns,useActionState:ns,useOptimistic:ns,useMemoCache:ns,useCacheRefresh:ns};Ac.useEffectEvent=ns;var Xv={readContext:Os,use:jd,useCallback:function(n,r){return rr().memoizedState=[n,r===void 0?null:r],n},useContext:Os,useEffect:Dv,useImperativeHandle:function(n,r,o){o=o!=null?o.concat([n]):null,Td(4194308,4,Vv.bind(null,r,n),o)},useLayoutEffect:function(n,r){return Td(4194308,4,n,r)},useInsertionEffect:function(n,r){Td(4,2,n,r)},useMemo:function(n,r){var o=rr();r=r===void 0?null:r;var u=n();if(Ao){Ct(!0);try{n()}finally{Ct(!1)}}return o.memoizedState=[u,r],u},useReducer:function(n,r,o){var u=rr();if(o!==void 0){var f=o(r);if(Ao){Ct(!0);try{o(r)}finally{Ct(!1)}}}else f=r;return u.memoizedState=u.baseState=f,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:f},u.queue=n,n=n.dispatch=PE.bind(null,Ut,n),[u.memoizedState,n]},useRef:function(n){var r=rr();return n={current:n},r.memoizedState=n},useState:function(n){n=bm(n);var r=n.queue,o=Kv.bind(null,Ut,r);return r.dispatch=o,[n.memoizedState,o]},useDebugValue:_m,useDeferredValue:function(n,r){var o=rr();return km(o,n,r)},useTransition:function(){var n=bm(!1);return n=Hv.bind(null,Ut,n.queue,!0,!1),rr().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,r,o){var u=Ut,f=rr();if(on){if(o===void 0)throw Error(i(407));o=o()}else{if(o=r(),Mn===null)throw Error(i(349));(Jt&127)!==0||vv(u,r,o)}f.memoizedState=o;var m={value:o,getSnapshot:r};return f.queue=m,Dv(wv.bind(null,u,m,n),[n]),u.flags|=2048,_l(9,{destroy:void 0},bv.bind(null,u,m,o,r),null),o},useId:function(){var n=rr(),r=Mn.identifierPrefix;if(on){var o=Si,u=Ti;o=(u&~(1<<32-Mt(u)-1)).toString(32)+o,r="_"+r+"R_"+o,o=_d++,0<o&&(r+="H"+o.toString(32)),r+="_"}else o=NE++,r="_"+r+"r_"+o.toString(32)+"_";return n.memoizedState=r},useHostTransitionStatus:Em,useFormState:Nv,useActionState:Nv,useOptimistic:function(n){var r=rr();r.memoizedState=r.baseState=n;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=o,r=Tm.bind(null,Ut,!0,o),o.dispatch=r,[n,r]},useMemoCache:pm,useCacheRefresh:function(){return rr().memoizedState=LE.bind(null,Ut)},useEffectEvent:function(n){var r=rr(),o={impl:n};return r.memoizedState=o,function(){if((_n&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},Sm={readContext:Os,use:jd,useCallback:Bv,useContext:Os,useEffect:xm,useImperativeHandle:Uv,useInsertionEffect:Pv,useLayoutEffect:Ov,useMemo:zv,useReducer:Ed,useRef:Mv,useState:function(){return Ed(Yi)},useDebugValue:_m,useDeferredValue:function(n,r){var o=ds();return Fv(o,An.memoizedState,n,r)},useTransition:function(){var n=Ed(Yi)[0],r=ds().memoizedState;return[typeof n=="boolean"?n:Cc(n),r]},useSyncExternalStore:yv,useId:Wv,useHostTransitionStatus:Em,useFormState:Av,useActionState:Av,useOptimistic:function(n,r){var o=ds();return kv(o,An,n,r)},useMemoCache:pm,useCacheRefresh:Gv};Sm.useEffectEvent=Lv;var Jv={readContext:Os,use:jd,useCallback:Bv,useContext:Os,useEffect:xm,useImperativeHandle:Uv,useInsertionEffect:Pv,useLayoutEffect:Ov,useMemo:zv,useReducer:vm,useRef:Mv,useState:function(){return vm(Yi)},useDebugValue:_m,useDeferredValue:function(n,r){var o=ds();return An===null?km(o,n,r):Fv(o,An.memoizedState,n,r)},useTransition:function(){var n=vm(Yi)[0],r=ds().memoizedState;return[typeof n=="boolean"?n:Cc(n),r]},useSyncExternalStore:yv,useId:Wv,useHostTransitionStatus:Em,useFormState:Iv,useActionState:Iv,useOptimistic:function(n,r){var o=ds();return An!==null?kv(o,An,n,r):(o.baseState=n,[n,o.queue.dispatch])},useMemoCache:pm,useCacheRefresh:Gv};Jv.useEffectEvent=Lv;function Cm(n,r,o,u){r=n.memoizedState,o=o(u,r),o=o==null?r:_({},r,o),n.memoizedState=o,n.lanes===0&&(n.updateQueue.baseState=o)}var Nm={enqueueSetState:function(n,r,o){n=n._reactInternals;var u=Dr(),f=Ia(u);f.payload=r,o!=null&&(f.callback=o),r=Ma(n,f,u),r!==null&&(yr(r,n,u),jc(r,n,u))},enqueueReplaceState:function(n,r,o){n=n._reactInternals;var u=Dr(),f=Ia(u);f.tag=1,f.payload=r,o!=null&&(f.callback=o),r=Ma(n,f,u),r!==null&&(yr(r,n,u),jc(r,n,u))},enqueueForceUpdate:function(n,r){n=n._reactInternals;var o=Dr(),u=Ia(o);u.tag=2,r!=null&&(u.callback=r),r=Ma(n,u,o),r!==null&&(yr(r,n,o),jc(r,n,o))}};function Zv(n,r,o,u,f,m,x){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(u,m,x):r.prototype&&r.prototype.isPureReactComponent?!pc(o,u)||!pc(f,m):!0}function e1(n,r,o,u){n=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(o,u),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(o,u),r.state!==n&&Nm.enqueueReplaceState(r,r.state,null)}function Ro(n,r){var o=r;if("ref"in r){o={};for(var u in r)u!=="ref"&&(o[u]=r[u])}if(n=n.defaultProps){o===r&&(o=_({},o));for(var f in n)o[f]===void 0&&(o[f]=n[f])}return o}function t1(n){ad(n)}function n1(n){console.error(n)}function s1(n){ad(n)}function Nd(n,r){try{var o=n.onUncaughtError;o(r.value,{componentStack:r.stack})}catch(u){setTimeout(function(){throw u})}}function r1(n,r,o){try{var u=n.onCaughtError;u(o.value,{componentStack:o.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function Am(n,r,o){return o=Ia(o),o.tag=3,o.payload={element:null},o.callback=function(){Nd(n,r)},o}function i1(n){return n=Ia(n),n.tag=3,n}function a1(n,r,o,u){var f=o.type.getDerivedStateFromError;if(typeof f=="function"){var m=u.value;n.payload=function(){return f(m)},n.callback=function(){r1(r,o,u)}}var x=o.stateNode;x!==null&&typeof x.componentDidCatch=="function"&&(n.callback=function(){r1(r,o,u),typeof f!="function"&&(Ua===null?Ua=new Set([this]):Ua.add(this));var T=u.stack;this.componentDidCatch(u.value,{componentStack:T!==null?T:""})})}function OE(n,r,o,u,f){if(o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(r=o.alternate,r!==null&&ml(r,o,f,!0),o=Ar.current,o!==null){switch(o.tag){case 31:case 13:return Gr===null?zd():o.alternate===null&&ss===0&&(ss=3),o.flags&=-257,o.flags|=65536,o.lanes=f,u===pd?o.flags|=16384:(r=o.updateQueue,r===null?o.updateQueue=new Set([u]):r.add(u),tg(n,u,f)),!1;case 22:return o.flags|=65536,u===pd?o.flags|=16384:(r=o.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([u])},o.updateQueue=r):(o=r.retryQueue,o===null?r.retryQueue=new Set([u]):o.add(u)),tg(n,u,f)),!1}throw Error(i(435,o.tag))}return tg(n,u,f),zd(),!1}if(on)return r=Ar.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=f,u!==Yf&&(n=Error(i(422),{cause:u}),bc(Hr(n,o)))):(u!==Yf&&(r=Error(i(423),{cause:u}),bc(Hr(r,o))),n=n.current.alternate,n.flags|=65536,f&=-f,n.lanes|=f,u=Hr(u,o),f=Am(n.stateNode,u,f),am(n,f),ss!==4&&(ss=2)),!1;var m=Error(i(520),{cause:u});if(m=Hr(m,o),Vc===null?Vc=[m]:Vc.push(m),ss!==4&&(ss=2),r===null)return!0;u=Hr(u,o),o=r;do{switch(o.tag){case 3:return o.flags|=65536,n=f&-f,o.lanes|=n,n=Am(o.stateNode,u,n),am(o,n),!1;case 1:if(r=o.type,m=o.stateNode,(o.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Ua===null||!Ua.has(m))))return o.flags|=65536,f&=-f,o.lanes|=f,f=i1(f),a1(f,n,o,u),am(o,f),!1}o=o.return}while(o!==null);return!1}var Rm=Error(i(461)),ys=!1;function Vs(n,r,o,u){r.child=n===null?uv(r,null,o,u):No(r,n.child,o,u)}function o1(n,r,o,u,f){o=o.render;var m=r.ref;if("ref"in u){var x={};for(var T in u)T!=="ref"&&(x[T]=u[T])}else x=u;return Eo(r),u=hm(n,r,o,x,m,f),T=fm(),n!==null&&!ys?(mm(n,r,f),Qi(n,r,f)):(on&&T&&Gf(r),r.flags|=1,Vs(n,r,u,f),r.child)}function l1(n,r,o,u,f){if(n===null){var m=o.type;return typeof m=="function"&&!qf(m)&&m.defaultProps===void 0&&o.compare===null?(r.tag=15,r.type=m,c1(n,r,m,u,f)):(n=ud(o.type,null,u,r,r.mode,f),n.ref=r.ref,n.return=r,r.child=n)}if(m=n.child,!Um(n,f)){var x=m.memoizedProps;if(o=o.compare,o=o!==null?o:pc,o(x,u)&&n.ref===r.ref)return Qi(n,r,f)}return r.flags|=1,n=qi(m,u),n.ref=r.ref,n.return=r,r.child=n}function c1(n,r,o,u,f){if(n!==null){var m=n.memoizedProps;if(pc(m,u)&&n.ref===r.ref)if(ys=!1,r.pendingProps=u=m,Um(n,f))(n.flags&131072)!==0&&(ys=!0);else return r.lanes=n.lanes,Qi(n,r,f)}return Im(n,r,o,u,f)}function u1(n,r,o,u){var f=u.children,m=n!==null?n.memoizedState:null;if(n===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((r.flags&128)!==0){if(m=m!==null?m.baseLanes|o:o,n!==null){for(u=r.child=n.child,f=0;u!==null;)f=f|u.lanes|u.childLanes,u=u.sibling;u=f&~m}else u=0,r.child=null;return d1(n,r,m,o,u)}if((o&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},n!==null&&md(r,m!==null?m.cachePool:null),m!==null?fv(r,m):lm(),mv(r);else return u=r.lanes=536870912,d1(n,r,m!==null?m.baseLanes|o:o,o,u)}else m!==null?(md(r,m.cachePool),fv(r,m),La(),r.memoizedState=null):(n!==null&&md(r,null),lm(),La());return Vs(n,r,f,o),r.child}function Rc(n,r){return n!==null&&n.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function d1(n,r,o,u,f){var m=nm();return m=m===null?null:{parent:gs._currentValue,pool:m},r.memoizedState={baseLanes:o,cachePool:m},n!==null&&md(r,null),lm(),mv(r),n!==null&&ml(n,r,u,!0),r.childLanes=f,null}function Ad(n,r){return r=Id({mode:r.mode,children:r.children},n.mode),r.ref=n.ref,n.child=r,r.return=n,r}function h1(n,r,o){return No(r,n.child,null,o),n=Ad(r,r.pendingProps),n.flags|=2,Rr(r),r.memoizedState=null,n}function VE(n,r,o){var u=r.pendingProps,f=(r.flags&128)!==0;if(r.flags&=-129,n===null){if(on){if(u.mode==="hidden")return n=Ad(r,u),r.lanes=536870912,Rc(null,n);if(um(r),(n=Un)?(n=jb(n,Wr),n=n!==null&&n.data==="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:Sa!==null?{id:Ti,overflow:Si}:null,retryLane:536870912,hydrationErrors:null},o=Y0(n),o.return=r,r.child=o,Ps=r,Un=null)):n=null,n===null)throw Na(r);return r.lanes=536870912,null}return Ad(r,u)}var m=n.memoizedState;if(m!==null){var x=m.dehydrated;if(um(r),f)if(r.flags&256)r.flags&=-257,r=h1(n,r,o);else if(r.memoizedState!==null)r.child=n.child,r.flags|=128,r=null;else throw Error(i(558));else if(ys||ml(n,r,o,!1),f=(o&n.childLanes)!==0,ys||f){if(u=Mn,u!==null&&(x=Le(u,o),x!==0&&x!==m.retryLane))throw m.retryLane=x,xo(n,x),yr(u,n,x),Rm;zd(),r=h1(n,r,o)}else n=m.treeContext,Un=Kr(x.nextSibling),Ps=r,on=!0,Ca=null,Wr=!1,n!==null&&J0(r,n),r=Ad(r,u),r.flags|=4096;return r}return n=qi(n.child,{mode:u.mode,children:u.children}),n.ref=r.ref,r.child=n,n.return=r,n}function Rd(n,r){var o=r.ref;if(o===null)n!==null&&n.ref!==null&&(r.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(n===null||n.ref!==o)&&(r.flags|=4194816)}}function Im(n,r,o,u,f){return Eo(r),o=hm(n,r,o,u,void 0,f),u=fm(),n!==null&&!ys?(mm(n,r,f),Qi(n,r,f)):(on&&u&&Gf(r),r.flags|=1,Vs(n,r,o,f),r.child)}function f1(n,r,o,u,f,m){return Eo(r),r.updateQueue=null,o=pv(r,u,o,f),gv(n),u=fm(),n!==null&&!ys?(mm(n,r,m),Qi(n,r,m)):(on&&u&&Gf(r),r.flags|=1,Vs(n,r,o,m),r.child)}function m1(n,r,o,u,f){if(Eo(r),r.stateNode===null){var m=ul,x=o.contextType;typeof x=="object"&&x!==null&&(m=Os(x)),m=new o(u,m),r.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=Nm,r.stateNode=m,m._reactInternals=r,m=r.stateNode,m.props=u,m.state=r.memoizedState,m.refs={},rm(r),x=o.contextType,m.context=typeof x=="object"&&x!==null?Os(x):ul,m.state=r.memoizedState,x=o.getDerivedStateFromProps,typeof x=="function"&&(Cm(r,o,x,u),m.state=r.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(x=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),x!==m.state&&Nm.enqueueReplaceState(m,m.state,null),Tc(r,u,m,f),Ec(),m.state=r.memoizedState),typeof m.componentDidMount=="function"&&(r.flags|=4194308),u=!0}else if(n===null){m=r.stateNode;var T=r.memoizedProps,z=Ro(o,T);m.props=z;var ae=m.context,we=o.contextType;x=ul,typeof we=="object"&&we!==null&&(x=Os(we));var Te=o.getDerivedStateFromProps;we=typeof Te=="function"||typeof m.getSnapshotBeforeUpdate=="function",T=r.pendingProps!==T,we||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(T||ae!==x)&&e1(r,m,u,x),Ra=!1;var de=r.memoizedState;m.state=de,Tc(r,u,m,f),Ec(),ae=r.memoizedState,T||de!==ae||Ra?(typeof Te=="function"&&(Cm(r,o,Te,u),ae=r.memoizedState),(z=Ra||Zv(r,o,z,u,de,ae,x))?(we||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(r.flags|=4194308)):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=u,r.memoizedState=ae),m.props=u,m.state=ae,m.context=x,u=z):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),u=!1)}else{m=r.stateNode,im(n,r),x=r.memoizedProps,we=Ro(o,x),m.props=we,Te=r.pendingProps,de=m.context,ae=o.contextType,z=ul,typeof ae=="object"&&ae!==null&&(z=Os(ae)),T=o.getDerivedStateFromProps,(ae=typeof T=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(x!==Te||de!==z)&&e1(r,m,u,z),Ra=!1,de=r.memoizedState,m.state=de,Tc(r,u,m,f),Ec();var ge=r.memoizedState;x!==Te||de!==ge||Ra||n!==null&&n.dependencies!==null&&hd(n.dependencies)?(typeof T=="function"&&(Cm(r,o,T,u),ge=r.memoizedState),(we=Ra||Zv(r,o,we,u,de,ge,z)||n!==null&&n.dependencies!==null&&hd(n.dependencies))?(ae||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(u,ge,z),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(u,ge,z)),typeof m.componentDidUpdate=="function"&&(r.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof m.componentDidUpdate!="function"||x===n.memoizedProps&&de===n.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||x===n.memoizedProps&&de===n.memoizedState||(r.flags|=1024),r.memoizedProps=u,r.memoizedState=ge),m.props=u,m.state=ge,m.context=z,u=we):(typeof m.componentDidUpdate!="function"||x===n.memoizedProps&&de===n.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||x===n.memoizedProps&&de===n.memoizedState||(r.flags|=1024),u=!1)}return m=u,Rd(n,r),u=(r.flags&128)!==0,m||u?(m=r.stateNode,o=u&&typeof o.getDerivedStateFromError!="function"?null:m.render(),r.flags|=1,n!==null&&u?(r.child=No(r,n.child,null,f),r.child=No(r,null,o,f)):Vs(n,r,o,f),r.memoizedState=m.state,n=r.child):n=Qi(n,r,f),n}function g1(n,r,o,u){return ko(),r.flags|=256,Vs(n,r,o,u),r.child}var Mm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Dm(n){return{baseLanes:n,cachePool:rv()}}function Lm(n,r,o){return n=n!==null?n.childLanes&~o:0,r&&(n|=Mr),n}function p1(n,r,o){var u=r.pendingProps,f=!1,m=(r.flags&128)!==0,x;if((x=m)||(x=n!==null&&n.memoizedState===null?!1:(us.current&2)!==0),x&&(f=!0,r.flags&=-129),x=(r.flags&32)!==0,r.flags&=-33,n===null){if(on){if(f?Da(r):La(),(n=Un)?(n=jb(n,Wr),n=n!==null&&n.data!=="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:Sa!==null?{id:Ti,overflow:Si}:null,retryLane:536870912,hydrationErrors:null},o=Y0(n),o.return=r,r.child=o,Ps=r,Un=null)):n=null,n===null)throw Na(r);return yg(n)?r.lanes=32:r.lanes=536870912,null}var T=u.children;return u=u.fallback,f?(La(),f=r.mode,T=Id({mode:"hidden",children:T},f),u=_o(u,f,o,null),T.return=r,u.return=r,T.sibling=u,r.child=T,u=r.child,u.memoizedState=Dm(o),u.childLanes=Lm(n,x,o),r.memoizedState=Mm,Rc(null,u)):(Da(r),Pm(r,T))}var z=n.memoizedState;if(z!==null&&(T=z.dehydrated,T!==null)){if(m)r.flags&256?(Da(r),r.flags&=-257,r=Om(n,r,o)):r.memoizedState!==null?(La(),r.child=n.child,r.flags|=128,r=null):(La(),T=u.fallback,f=r.mode,u=Id({mode:"visible",children:u.children},f),T=_o(T,f,o,null),T.flags|=2,u.return=r,T.return=r,u.sibling=T,r.child=u,No(r,n.child,null,o),u=r.child,u.memoizedState=Dm(o),u.childLanes=Lm(n,x,o),r.memoizedState=Mm,r=Rc(null,u));else if(Da(r),yg(T)){if(x=T.nextSibling&&T.nextSibling.dataset,x)var ae=x.dgst;x=ae,u=Error(i(419)),u.stack="",u.digest=x,bc({value:u,source:null,stack:null}),r=Om(n,r,o)}else if(ys||ml(n,r,o,!1),x=(o&n.childLanes)!==0,ys||x){if(x=Mn,x!==null&&(u=Le(x,o),u!==0&&u!==z.retryLane))throw z.retryLane=u,xo(n,u),yr(x,n,u),Rm;pg(T)||zd(),r=Om(n,r,o)}else pg(T)?(r.flags|=192,r.child=n.child,r=null):(n=z.treeContext,Un=Kr(T.nextSibling),Ps=r,on=!0,Ca=null,Wr=!1,n!==null&&J0(r,n),r=Pm(r,u.children),r.flags|=4096);return r}return f?(La(),T=u.fallback,f=r.mode,z=n.child,ae=z.sibling,u=qi(z,{mode:"hidden",children:u.children}),u.subtreeFlags=z.subtreeFlags&65011712,ae!==null?T=qi(ae,T):(T=_o(T,f,o,null),T.flags|=2),T.return=r,u.return=r,u.sibling=T,r.child=u,Rc(null,u),u=r.child,T=n.child.memoizedState,T===null?T=Dm(o):(f=T.cachePool,f!==null?(z=gs._currentValue,f=f.parent!==z?{parent:z,pool:z}:f):f=rv(),T={baseLanes:T.baseLanes|o,cachePool:f}),u.memoizedState=T,u.childLanes=Lm(n,x,o),r.memoizedState=Mm,Rc(n.child,u)):(Da(r),o=n.child,n=o.sibling,o=qi(o,{mode:"visible",children:u.children}),o.return=r,o.sibling=null,n!==null&&(x=r.deletions,x===null?(r.deletions=[n],r.flags|=16):x.push(n)),r.child=o,r.memoizedState=null,o)}function Pm(n,r){return r=Id({mode:"visible",children:r},n.mode),r.return=n,n.child=r}function Id(n,r){return n=Nr(22,n,null,r),n.lanes=0,n}function Om(n,r,o){return No(r,n.child,null,o),n=Pm(r,r.pendingProps.children),n.flags|=2,r.memoizedState=null,n}function y1(n,r,o){n.lanes|=r;var u=n.alternate;u!==null&&(u.lanes|=r),Jf(n.return,r,o)}function Vm(n,r,o,u,f,m){var x=n.memoizedState;x===null?n.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:u,tail:o,tailMode:f,treeForkCount:m}:(x.isBackwards=r,x.rendering=null,x.renderingStartTime=0,x.last=u,x.tail=o,x.tailMode=f,x.treeForkCount=m)}function v1(n,r,o){var u=r.pendingProps,f=u.revealOrder,m=u.tail;u=u.children;var x=us.current,T=(x&2)!==0;if(T?(x=x&1|2,r.flags|=128):x&=1,Ee(us,x),Vs(n,r,u,o),u=on?vc:0,!T&&n!==null&&(n.flags&128)!==0)e:for(n=r.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&y1(n,o,r);else if(n.tag===19)y1(n,o,r);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break e;for(;n.sibling===null;){if(n.return===null||n.return===r)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(f){case"forwards":for(o=r.child,f=null;o!==null;)n=o.alternate,n!==null&&wd(n)===null&&(f=o),o=o.sibling;o=f,o===null?(f=r.child,r.child=null):(f=o.sibling,o.sibling=null),Vm(r,!1,f,o,m,u);break;case"backwards":case"unstable_legacy-backwards":for(o=null,f=r.child,r.child=null;f!==null;){if(n=f.alternate,n!==null&&wd(n)===null){r.child=f;break}n=f.sibling,f.sibling=o,o=f,f=n}Vm(r,!0,o,null,m,u);break;case"together":Vm(r,!1,null,null,void 0,u);break;default:r.memoizedState=null}return r.child}function Qi(n,r,o){if(n!==null&&(r.dependencies=n.dependencies),Va|=r.lanes,(o&r.childLanes)===0)if(n!==null){if(ml(n,r,o,!1),(o&r.childLanes)===0)return null}else return null;if(n!==null&&r.child!==n.child)throw Error(i(153));if(r.child!==null){for(n=r.child,o=qi(n,n.pendingProps),r.child=o,o.return=r;n.sibling!==null;)n=n.sibling,o=o.sibling=qi(n,n.pendingProps),o.return=r;o.sibling=null}return r.child}function Um(n,r){return(n.lanes&r)!==0?!0:(n=n.dependencies,!!(n!==null&&hd(n)))}function UE(n,r,o){switch(r.tag){case 3:Xe(r,r.stateNode.containerInfo),Aa(r,gs,n.memoizedState.cache),ko();break;case 27:case 5:Wt(r);break;case 4:Xe(r,r.stateNode.containerInfo);break;case 10:Aa(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,um(r),null;break;case 13:var u=r.memoizedState;if(u!==null)return u.dehydrated!==null?(Da(r),r.flags|=128,null):(o&r.child.childLanes)!==0?p1(n,r,o):(Da(r),n=Qi(n,r,o),n!==null?n.sibling:null);Da(r);break;case 19:var f=(n.flags&128)!==0;if(u=(o&r.childLanes)!==0,u||(ml(n,r,o,!1),u=(o&r.childLanes)!==0),f){if(u)return v1(n,r,o);r.flags|=128}if(f=r.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),Ee(us,us.current),u)break;return null;case 22:return r.lanes=0,u1(n,r,o,r.pendingProps);case 24:Aa(r,gs,n.memoizedState.cache)}return Qi(n,r,o)}function b1(n,r,o){if(n!==null)if(n.memoizedProps!==r.pendingProps)ys=!0;else{if(!Um(n,o)&&(r.flags&128)===0)return ys=!1,UE(n,r,o);ys=(n.flags&131072)!==0}else ys=!1,on&&(r.flags&1048576)!==0&&X0(r,vc,r.index);switch(r.lanes=0,r.tag){case 16:e:{var u=r.pendingProps;if(n=So(r.elementType),r.type=n,typeof n=="function")qf(n)?(u=Ro(n,u),r.tag=1,r=m1(null,r,n,u,o)):(r.tag=0,r=Im(null,r,n,u,o));else{if(n!=null){var f=n.$$typeof;if(f===pe){r.tag=11,r=o1(null,r,n,u,o);break e}else if(f===L){r.tag=14,r=l1(null,r,n,u,o);break e}}throw r=Me(n)||n,Error(i(306,r,""))}}return r;case 0:return Im(n,r,r.type,r.pendingProps,o);case 1:return u=r.type,f=Ro(u,r.pendingProps),m1(n,r,u,f,o);case 3:e:{if(Xe(r,r.stateNode.containerInfo),n===null)throw Error(i(387));u=r.pendingProps;var m=r.memoizedState;f=m.element,im(n,r),Tc(r,u,null,o);var x=r.memoizedState;if(u=x.cache,Aa(r,gs,u),u!==m.cache&&Zf(r,[gs],o,!0),Ec(),u=x.element,m.isDehydrated)if(m={element:u,isDehydrated:!1,cache:x.cache},r.updateQueue.baseState=m,r.memoizedState=m,r.flags&256){r=g1(n,r,u,o);break e}else if(u!==f){f=Hr(Error(i(424)),r),bc(f),r=g1(n,r,u,o);break e}else for(n=r.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,Un=Kr(n.firstChild),Ps=r,on=!0,Ca=null,Wr=!0,o=uv(r,null,u,o),r.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(ko(),u===f){r=Qi(n,r,o);break e}Vs(n,r,u,o)}r=r.child}return r;case 26:return Rd(n,r),n===null?(o=Ab(r.type,null,r.pendingProps,null))?r.memoizedState=o:on||(o=r.type,n=r.pendingProps,u=Kd(Ue.current).createElement(o),u[At]=r,u[St]=n,Us(u,o,n),wn(u),r.stateNode=u):r.memoizedState=Ab(r.type,n.memoizedProps,r.pendingProps,n.memoizedState),null;case 27:return Wt(r),n===null&&on&&(u=r.stateNode=Sb(r.type,r.pendingProps,Ue.current),Ps=r,Wr=!0,f=Un,Ha(r.type)?(vg=f,Un=Kr(u.firstChild)):Un=f),Vs(n,r,r.pendingProps.children,o),Rd(n,r),n===null&&(r.flags|=4194304),r.child;case 5:return n===null&&on&&((f=u=Un)&&(u=gT(u,r.type,r.pendingProps,Wr),u!==null?(r.stateNode=u,Ps=r,Un=Kr(u.firstChild),Wr=!1,f=!0):f=!1),f||Na(r)),Wt(r),f=r.type,m=r.pendingProps,x=n!==null?n.memoizedProps:null,u=m.children,fg(f,m)?u=null:x!==null&&fg(f,x)&&(r.flags|=32),r.memoizedState!==null&&(f=hm(n,r,AE,null,null,o),Wc._currentValue=f),Rd(n,r),Vs(n,r,u,o),r.child;case 6:return n===null&&on&&((n=o=Un)&&(o=pT(o,r.pendingProps,Wr),o!==null?(r.stateNode=o,Ps=r,Un=null,n=!0):n=!1),n||Na(r)),null;case 13:return p1(n,r,o);case 4:return Xe(r,r.stateNode.containerInfo),u=r.pendingProps,n===null?r.child=No(r,null,u,o):Vs(n,r,u,o),r.child;case 11:return o1(n,r,r.type,r.pendingProps,o);case 7:return Vs(n,r,r.pendingProps,o),r.child;case 8:return Vs(n,r,r.pendingProps.children,o),r.child;case 12:return Vs(n,r,r.pendingProps.children,o),r.child;case 10:return u=r.pendingProps,Aa(r,r.type,u.value),Vs(n,r,u.children,o),r.child;case 9:return f=r.type._context,u=r.pendingProps.children,Eo(r),f=Os(f),u=u(f),r.flags|=1,Vs(n,r,u,o),r.child;case 14:return l1(n,r,r.type,r.pendingProps,o);case 15:return c1(n,r,r.type,r.pendingProps,o);case 19:return v1(n,r,o);case 31:return VE(n,r,o);case 22:return u1(n,r,o,r.pendingProps);case 24:return Eo(r),u=Os(gs),n===null?(f=nm(),f===null&&(f=Mn,m=em(),f.pooledCache=m,m.refCount++,m!==null&&(f.pooledCacheLanes|=o),f=m),r.memoizedState={parent:u,cache:f},rm(r),Aa(r,gs,f)):((n.lanes&o)!==0&&(im(n,r),Tc(r,null,null,o),Ec()),f=n.memoizedState,m=r.memoizedState,f.parent!==u?(f={parent:u,cache:u},r.memoizedState=f,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=f),Aa(r,gs,u)):(u=m.cache,Aa(r,gs,u),u!==f.cache&&Zf(r,[gs],o,!0))),Vs(n,r,r.pendingProps.children,o),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function Xi(n){n.flags|=4}function Bm(n,r,o,u,f){if((r=(n.mode&32)!==0)&&(r=!1),r){if(n.flags|=16777216,(f&335544128)===f)if(n.stateNode.complete)n.flags|=8192;else if(W1())n.flags|=8192;else throw Co=pd,sm}else n.flags&=-16777217}function w1(n,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!Lb(r))if(W1())n.flags|=8192;else throw Co=pd,sm}function Md(n,r){r!==null&&(n.flags|=4),n.flags&16384&&(r=n.tag!==22?lt():536870912,n.lanes|=r,Tl|=r)}function Ic(n,r){if(!on)switch(n.tailMode){case"hidden":r=n.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?n.tail=null:o.sibling=null;break;case"collapsed":o=n.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?r||n.tail===null?n.tail=null:n.tail.sibling=null:u.sibling=null}}function Bn(n){var r=n.alternate!==null&&n.alternate.child===n.child,o=0,u=0;if(r)for(var f=n.child;f!==null;)o|=f.lanes|f.childLanes,u|=f.subtreeFlags&65011712,u|=f.flags&65011712,f.return=n,f=f.sibling;else for(f=n.child;f!==null;)o|=f.lanes|f.childLanes,u|=f.subtreeFlags,u|=f.flags,f.return=n,f=f.sibling;return n.subtreeFlags|=u,n.childLanes=o,r}function BE(n,r,o){var u=r.pendingProps;switch(Kf(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bn(r),null;case 1:return Bn(r),null;case 3:return o=r.stateNode,u=null,n!==null&&(u=n.memoizedState.cache),r.memoizedState.cache!==u&&(r.flags|=2048),Gi(gs),Ze(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(n===null||n.child===null)&&(fl(r)?Xi(r):n===null||n.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Qf())),Bn(r),null;case 26:var f=r.type,m=r.memoizedState;return n===null?(Xi(r),m!==null?(Bn(r),w1(r,m)):(Bn(r),Bm(r,f,null,u,o))):m?m!==n.memoizedState?(Xi(r),Bn(r),w1(r,m)):(Bn(r),r.flags&=-16777217):(n=n.memoizedProps,n!==u&&Xi(r),Bn(r),Bm(r,f,n,u,o)),null;case 27:if(It(r),o=Ue.current,f=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==u&&Xi(r);else{if(!u){if(r.stateNode===null)throw Error(i(166));return Bn(r),null}n=Ce.current,fl(r)?Z0(r):(n=Sb(f,u,o),r.stateNode=n,Xi(r))}return Bn(r),null;case 5:if(It(r),f=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==u&&Xi(r);else{if(!u){if(r.stateNode===null)throw Error(i(166));return Bn(r),null}if(m=Ce.current,fl(r))Z0(r);else{var x=Kd(Ue.current);switch(m){case 1:m=x.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:m=x.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":m=x.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":m=x.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":m=x.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild);break;case"select":m=typeof u.is=="string"?x.createElement("select",{is:u.is}):x.createElement("select"),u.multiple?m.multiple=!0:u.size&&(m.size=u.size);break;default:m=typeof u.is=="string"?x.createElement(f,{is:u.is}):x.createElement(f)}}m[At]=r,m[St]=u;e:for(x=r.child;x!==null;){if(x.tag===5||x.tag===6)m.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===r)break e;for(;x.sibling===null;){if(x.return===null||x.return===r)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}r.stateNode=m;e:switch(Us(m,f,u),f){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&Xi(r)}}return Bn(r),Bm(r,r.type,n===null?null:n.memoizedProps,r.pendingProps,o),null;case 6:if(n&&r.stateNode!=null)n.memoizedProps!==u&&Xi(r);else{if(typeof u!="string"&&r.stateNode===null)throw Error(i(166));if(n=Ue.current,fl(r)){if(n=r.stateNode,o=r.memoizedProps,u=null,f=Ps,f!==null)switch(f.tag){case 27:case 5:u=f.memoizedProps}n[At]=r,n=!!(n.nodeValue===o||u!==null&&u.suppressHydrationWarning===!0||pb(n.nodeValue,o)),n||Na(r,!0)}else n=Kd(n).createTextNode(u),n[At]=r,r.stateNode=n}return Bn(r),null;case 31:if(o=r.memoizedState,n===null||n.memoizedState!==null){if(u=fl(r),o!==null){if(n===null){if(!u)throw Error(i(318));if(n=r.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(557));n[At]=r}else ko(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Bn(r),n=!1}else o=Qf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=o),n=!0;if(!n)return r.flags&256?(Rr(r),r):(Rr(r),null);if((r.flags&128)!==0)throw Error(i(558))}return Bn(r),null;case 13:if(u=r.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(f=fl(r),u!==null&&u.dehydrated!==null){if(n===null){if(!f)throw Error(i(318));if(f=r.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(i(317));f[At]=r}else ko(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Bn(r),f=!1}else f=Qf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=f),f=!0;if(!f)return r.flags&256?(Rr(r),r):(Rr(r),null)}return Rr(r),(r.flags&128)!==0?(r.lanes=o,r):(o=u!==null,n=n!==null&&n.memoizedState!==null,o&&(u=r.child,f=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(f=u.alternate.memoizedState.cachePool.pool),m=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(m=u.memoizedState.cachePool.pool),m!==f&&(u.flags|=2048)),o!==n&&o&&(r.child.flags|=8192),Md(r,r.updateQueue),Bn(r),null);case 4:return Ze(),n===null&&lg(r.stateNode.containerInfo),Bn(r),null;case 10:return Gi(r.type),Bn(r),null;case 19:if(ce(us),u=r.memoizedState,u===null)return Bn(r),null;if(f=(r.flags&128)!==0,m=u.rendering,m===null)if(f)Ic(u,!1);else{if(ss!==0||n!==null&&(n.flags&128)!==0)for(n=r.child;n!==null;){if(m=wd(n),m!==null){for(r.flags|=128,Ic(u,!1),n=m.updateQueue,r.updateQueue=n,Md(r,n),r.subtreeFlags=0,n=o,o=r.child;o!==null;)K0(o,n),o=o.sibling;return Ee(us,us.current&1|2),on&&$i(r,u.treeForkCount),r.child}n=n.sibling}u.tail!==null&&gt()>Vd&&(r.flags|=128,f=!0,Ic(u,!1),r.lanes=4194304)}else{if(!f)if(n=wd(m),n!==null){if(r.flags|=128,f=!0,n=n.updateQueue,r.updateQueue=n,Md(r,n),Ic(u,!0),u.tail===null&&u.tailMode==="hidden"&&!m.alternate&&!on)return Bn(r),null}else 2*gt()-u.renderingStartTime>Vd&&o!==536870912&&(r.flags|=128,f=!0,Ic(u,!1),r.lanes=4194304);u.isBackwards?(m.sibling=r.child,r.child=m):(n=u.last,n!==null?n.sibling=m:r.child=m,u.last=m)}return u.tail!==null?(n=u.tail,u.rendering=n,u.tail=n.sibling,u.renderingStartTime=gt(),n.sibling=null,o=us.current,Ee(us,f?o&1|2:o&1),on&&$i(r,u.treeForkCount),n):(Bn(r),null);case 22:case 23:return Rr(r),cm(),u=r.memoizedState!==null,n!==null?n.memoizedState!==null!==u&&(r.flags|=8192):u&&(r.flags|=8192),u?(o&536870912)!==0&&(r.flags&128)===0&&(Bn(r),r.subtreeFlags&6&&(r.flags|=8192)):Bn(r),o=r.updateQueue,o!==null&&Md(r,o.retryQueue),o=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),u=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),u!==o&&(r.flags|=2048),n!==null&&ce(To),null;case 24:return o=null,n!==null&&(o=n.memoizedState.cache),r.memoizedState.cache!==o&&(r.flags|=2048),Gi(gs),Bn(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function zE(n,r){switch(Kf(r),r.tag){case 1:return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 3:return Gi(gs),Ze(),n=r.flags,(n&65536)!==0&&(n&128)===0?(r.flags=n&-65537|128,r):null;case 26:case 27:case 5:return It(r),null;case 31:if(r.memoizedState!==null){if(Rr(r),r.alternate===null)throw Error(i(340));ko()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 13:if(Rr(r),n=r.memoizedState,n!==null&&n.dehydrated!==null){if(r.alternate===null)throw Error(i(340));ko()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 19:return ce(us),null;case 4:return Ze(),null;case 10:return Gi(r.type),null;case 22:case 23:return Rr(r),cm(),n!==null&&ce(To),n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 24:return Gi(gs),null;case 25:return null;default:return null}}function x1(n,r){switch(Kf(r),r.tag){case 3:Gi(gs),Ze();break;case 26:case 27:case 5:It(r);break;case 4:Ze();break;case 31:r.memoizedState!==null&&Rr(r);break;case 13:Rr(r);break;case 19:ce(us);break;case 10:Gi(r.type);break;case 22:case 23:Rr(r),cm(),n!==null&&ce(To);break;case 24:Gi(gs)}}function Mc(n,r){try{var o=r.updateQueue,u=o!==null?o.lastEffect:null;if(u!==null){var f=u.next;o=f;do{if((o.tag&n)===n){u=void 0;var m=o.create,x=o.inst;u=m(),x.destroy=u}o=o.next}while(o!==f)}}catch(T){Tn(r,r.return,T)}}function Pa(n,r,o){try{var u=r.updateQueue,f=u!==null?u.lastEffect:null;if(f!==null){var m=f.next;u=m;do{if((u.tag&n)===n){var x=u.inst,T=x.destroy;if(T!==void 0){x.destroy=void 0,f=r;var z=o,ae=T;try{ae()}catch(we){Tn(f,z,we)}}}u=u.next}while(u!==m)}}catch(we){Tn(r,r.return,we)}}function _1(n){var r=n.updateQueue;if(r!==null){var o=n.stateNode;try{hv(r,o)}catch(u){Tn(n,n.return,u)}}}function k1(n,r,o){o.props=Ro(n.type,n.memoizedProps),o.state=n.memoizedState;try{o.componentWillUnmount()}catch(u){Tn(n,r,u)}}function Dc(n,r){try{var o=n.ref;if(o!==null){switch(n.tag){case 26:case 27:case 5:var u=n.stateNode;break;case 30:u=n.stateNode;break;default:u=n.stateNode}typeof o=="function"?n.refCleanup=o(u):o.current=u}}catch(f){Tn(n,r,f)}}function Ci(n,r){var o=n.ref,u=n.refCleanup;if(o!==null)if(typeof u=="function")try{u()}catch(f){Tn(n,r,f)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(f){Tn(n,r,f)}else o.current=null}function j1(n){var r=n.type,o=n.memoizedProps,u=n.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":o.autoFocus&&u.focus();break e;case"img":o.src?u.src=o.src:o.srcSet&&(u.srcset=o.srcSet)}}catch(f){Tn(n,n.return,f)}}function zm(n,r,o){try{var u=n.stateNode;cT(u,n.type,o,r),u[St]=r}catch(f){Tn(n,n.return,f)}}function E1(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&Ha(n.type)||n.tag===4}function Fm(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||E1(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&Ha(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Hm(n,r,o){var u=n.tag;if(u===5||u===6)n=n.stateNode,r?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(n,r):(r=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,r.appendChild(n),o=o._reactRootContainer,o!=null||r.onclick!==null||(r.onclick=Ws));else if(u!==4&&(u===27&&Ha(n.type)&&(o=n.stateNode,r=null),n=n.child,n!==null))for(Hm(n,r,o),n=n.sibling;n!==null;)Hm(n,r,o),n=n.sibling}function Dd(n,r,o){var u=n.tag;if(u===5||u===6)n=n.stateNode,r?o.insertBefore(n,r):o.appendChild(n);else if(u!==4&&(u===27&&Ha(n.type)&&(o=n.stateNode),n=n.child,n!==null))for(Dd(n,r,o),n=n.sibling;n!==null;)Dd(n,r,o),n=n.sibling}function T1(n){var r=n.stateNode,o=n.memoizedProps;try{for(var u=n.type,f=r.attributes;f.length;)r.removeAttributeNode(f[0]);Us(r,u,o),r[At]=n,r[St]=o}catch(m){Tn(n,n.return,m)}}var Ji=!1,vs=!1,qm=!1,S1=typeof WeakSet=="function"?WeakSet:Set,Rs=null;function FE(n,r){if(n=n.containerInfo,dg=th,n=U0(n),Of(n)){if("selectionStart"in n)var o={start:n.selectionStart,end:n.selectionEnd};else e:{o=(o=n.ownerDocument)&&o.defaultView||window;var u=o.getSelection&&o.getSelection();if(u&&u.rangeCount!==0){o=u.anchorNode;var f=u.anchorOffset,m=u.focusNode;u=u.focusOffset;try{o.nodeType,m.nodeType}catch{o=null;break e}var x=0,T=-1,z=-1,ae=0,we=0,Te=n,de=null;t:for(;;){for(var ge;Te!==o||f!==0&&Te.nodeType!==3||(T=x+f),Te!==m||u!==0&&Te.nodeType!==3||(z=x+u),Te.nodeType===3&&(x+=Te.nodeValue.length),(ge=Te.firstChild)!==null;)de=Te,Te=ge;for(;;){if(Te===n)break t;if(de===o&&++ae===f&&(T=x),de===m&&++we===u&&(z=x),(ge=Te.nextSibling)!==null)break;Te=de,de=Te.parentNode}Te=ge}o=T===-1||z===-1?null:{start:T,end:z}}else o=null}o=o||{start:0,end:0}}else o=null;for(hg={focusedElem:n,selectionRange:o},th=!1,Rs=r;Rs!==null;)if(r=Rs,n=r.child,(r.subtreeFlags&1028)!==0&&n!==null)n.return=r,Rs=n;else for(;Rs!==null;){switch(r=Rs,m=r.alternate,n=r.flags,r.tag){case 0:if((n&4)!==0&&(n=r.updateQueue,n=n!==null?n.events:null,n!==null))for(o=0;o<n.length;o++)f=n[o],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&m!==null){n=void 0,o=r,f=m.memoizedProps,m=m.memoizedState,u=o.stateNode;try{var et=Ro(o.type,f);n=u.getSnapshotBeforeUpdate(et,m),u.__reactInternalSnapshotBeforeUpdate=n}catch(wt){Tn(o,o.return,wt)}}break;case 3:if((n&1024)!==0){if(n=r.stateNode.containerInfo,o=n.nodeType,o===9)gg(n);else if(o===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":gg(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(i(163))}if(n=r.sibling,n!==null){n.return=r.return,Rs=n;break}Rs=r.return}}function C1(n,r,o){var u=o.flags;switch(o.tag){case 0:case 11:case 15:ea(n,o),u&4&&Mc(5,o);break;case 1:if(ea(n,o),u&4)if(n=o.stateNode,r===null)try{n.componentDidMount()}catch(x){Tn(o,o.return,x)}else{var f=Ro(o.type,r.memoizedProps);r=r.memoizedState;try{n.componentDidUpdate(f,r,n.__reactInternalSnapshotBeforeUpdate)}catch(x){Tn(o,o.return,x)}}u&64&&_1(o),u&512&&Dc(o,o.return);break;case 3:if(ea(n,o),u&64&&(n=o.updateQueue,n!==null)){if(r=null,o.child!==null)switch(o.child.tag){case 27:case 5:r=o.child.stateNode;break;case 1:r=o.child.stateNode}try{hv(n,r)}catch(x){Tn(o,o.return,x)}}break;case 27:r===null&&u&4&&T1(o);case 26:case 5:ea(n,o),r===null&&u&4&&j1(o),u&512&&Dc(o,o.return);break;case 12:ea(n,o);break;case 31:ea(n,o),u&4&&R1(n,o);break;case 13:ea(n,o),u&4&&I1(n,o),u&64&&(n=o.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(o=XE.bind(null,o),yT(n,o))));break;case 22:if(u=o.memoizedState!==null||Ji,!u){r=r!==null&&r.memoizedState!==null||vs,f=Ji;var m=vs;Ji=u,(vs=r)&&!m?ta(n,o,(o.subtreeFlags&8772)!==0):ea(n,o),Ji=f,vs=m}break;case 30:break;default:ea(n,o)}}function N1(n){var r=n.alternate;r!==null&&(n.alternate=null,N1(r)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(r=n.stateNode,r!==null&&hr(r)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var $n=null,fr=!1;function Zi(n,r,o){for(o=o.child;o!==null;)A1(n,r,o),o=o.sibling}function A1(n,r,o){if(Gt&&typeof Gt.onCommitFiberUnmount=="function")try{Gt.onCommitFiberUnmount(un,o)}catch{}switch(o.tag){case 26:vs||Ci(o,r),Zi(n,r,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:vs||Ci(o,r);var u=$n,f=fr;Ha(o.type)&&($n=o.stateNode,fr=!1),Zi(n,r,o),Hc(o.stateNode),$n=u,fr=f;break;case 5:vs||Ci(o,r);case 6:if(u=$n,f=fr,$n=null,Zi(n,r,o),$n=u,fr=f,$n!==null)if(fr)try{($n.nodeType===9?$n.body:$n.nodeName==="HTML"?$n.ownerDocument.body:$n).removeChild(o.stateNode)}catch(m){Tn(o,r,m)}else try{$n.removeChild(o.stateNode)}catch(m){Tn(o,r,m)}break;case 18:$n!==null&&(fr?(n=$n,_b(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,o.stateNode),Dl(n)):_b($n,o.stateNode));break;case 4:u=$n,f=fr,$n=o.stateNode.containerInfo,fr=!0,Zi(n,r,o),$n=u,fr=f;break;case 0:case 11:case 14:case 15:Pa(2,o,r),vs||Pa(4,o,r),Zi(n,r,o);break;case 1:vs||(Ci(o,r),u=o.stateNode,typeof u.componentWillUnmount=="function"&&k1(o,r,u)),Zi(n,r,o);break;case 21:Zi(n,r,o);break;case 22:vs=(u=vs)||o.memoizedState!==null,Zi(n,r,o),vs=u;break;default:Zi(n,r,o)}}function R1(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{Dl(n)}catch(o){Tn(r,r.return,o)}}}function I1(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Dl(n)}catch(o){Tn(r,r.return,o)}}function HE(n){switch(n.tag){case 31:case 13:case 19:var r=n.stateNode;return r===null&&(r=n.stateNode=new S1),r;case 22:return n=n.stateNode,r=n._retryCache,r===null&&(r=n._retryCache=new S1),r;default:throw Error(i(435,n.tag))}}function Ld(n,r){var o=HE(n);r.forEach(function(u){if(!o.has(u)){o.add(u);var f=JE.bind(null,n,u);u.then(f,f)}})}function mr(n,r){var o=r.deletions;if(o!==null)for(var u=0;u<o.length;u++){var f=o[u],m=n,x=r,T=x;e:for(;T!==null;){switch(T.tag){case 27:if(Ha(T.type)){$n=T.stateNode,fr=!1;break e}break;case 5:$n=T.stateNode,fr=!1;break e;case 3:case 4:$n=T.stateNode.containerInfo,fr=!0;break e}T=T.return}if($n===null)throw Error(i(160));A1(m,x,f),$n=null,fr=!1,m=f.alternate,m!==null&&(m.return=null),f.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)M1(r,n),r=r.sibling}var ui=null;function M1(n,r){var o=n.alternate,u=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:mr(r,n),gr(n),u&4&&(Pa(3,n,n.return),Mc(3,n),Pa(5,n,n.return));break;case 1:mr(r,n),gr(n),u&512&&(vs||o===null||Ci(o,o.return)),u&64&&Ji&&(n=n.updateQueue,n!==null&&(u=n.callbacks,u!==null&&(o=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=o===null?u:o.concat(u))));break;case 26:var f=ui;if(mr(r,n),gr(n),u&512&&(vs||o===null||Ci(o,o.return)),u&4){var m=o!==null?o.memoizedState:null;if(u=n.memoizedState,o===null)if(u===null)if(n.stateNode===null){e:{u=n.type,o=n.memoizedProps,f=f.ownerDocument||f;t:switch(u){case"title":m=f.getElementsByTagName("title")[0],(!m||m[js]||m[At]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=f.createElement(u),f.head.insertBefore(m,f.querySelector("head > title"))),Us(m,u,o),m[At]=n,wn(m),u=m;break e;case"link":var x=Mb("link","href",f).get(u+(o.href||""));if(x){for(var T=0;T<x.length;T++)if(m=x[T],m.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&m.getAttribute("rel")===(o.rel==null?null:o.rel)&&m.getAttribute("title")===(o.title==null?null:o.title)&&m.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){x.splice(T,1);break t}}m=f.createElement(u),Us(m,u,o),f.head.appendChild(m);break;case"meta":if(x=Mb("meta","content",f).get(u+(o.content||""))){for(T=0;T<x.length;T++)if(m=x[T],m.getAttribute("content")===(o.content==null?null:""+o.content)&&m.getAttribute("name")===(o.name==null?null:o.name)&&m.getAttribute("property")===(o.property==null?null:o.property)&&m.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&m.getAttribute("charset")===(o.charSet==null?null:o.charSet)){x.splice(T,1);break t}}m=f.createElement(u),Us(m,u,o),f.head.appendChild(m);break;default:throw Error(i(468,u))}m[At]=n,wn(m),u=m}n.stateNode=u}else Db(f,n.type,n.stateNode);else n.stateNode=Ib(f,u,n.memoizedProps);else m!==u?(m===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):m.count--,u===null?Db(f,n.type,n.stateNode):Ib(f,u,n.memoizedProps)):u===null&&n.stateNode!==null&&zm(n,n.memoizedProps,o.memoizedProps)}break;case 27:mr(r,n),gr(n),u&512&&(vs||o===null||Ci(o,o.return)),o!==null&&u&4&&zm(n,n.memoizedProps,o.memoizedProps);break;case 5:if(mr(r,n),gr(n),u&512&&(vs||o===null||Ci(o,o.return)),n.flags&32){f=n.stateNode;try{Ns(f,"")}catch(et){Tn(n,n.return,et)}}u&4&&n.stateNode!=null&&(f=n.memoizedProps,zm(n,f,o!==null?o.memoizedProps:f)),u&1024&&(qm=!0);break;case 6:if(mr(r,n),gr(n),u&4){if(n.stateNode===null)throw Error(i(162));u=n.memoizedProps,o=n.stateNode;try{o.nodeValue=u}catch(et){Tn(n,n.return,et)}}break;case 3:if(Xd=null,f=ui,ui=Yd(r.containerInfo),mr(r,n),ui=f,gr(n),u&4&&o!==null&&o.memoizedState.isDehydrated)try{Dl(r.containerInfo)}catch(et){Tn(n,n.return,et)}qm&&(qm=!1,D1(n));break;case 4:u=ui,ui=Yd(n.stateNode.containerInfo),mr(r,n),gr(n),ui=u;break;case 12:mr(r,n),gr(n);break;case 31:mr(r,n),gr(n),u&4&&(u=n.updateQueue,u!==null&&(n.updateQueue=null,Ld(n,u)));break;case 13:mr(r,n),gr(n),n.child.flags&8192&&n.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Od=gt()),u&4&&(u=n.updateQueue,u!==null&&(n.updateQueue=null,Ld(n,u)));break;case 22:f=n.memoizedState!==null;var z=o!==null&&o.memoizedState!==null,ae=Ji,we=vs;if(Ji=ae||f,vs=we||z,mr(r,n),vs=we,Ji=ae,gr(n),u&8192)e:for(r=n.stateNode,r._visibility=f?r._visibility&-2:r._visibility|1,f&&(o===null||z||Ji||vs||Io(n)),o=null,r=n;;){if(r.tag===5||r.tag===26){if(o===null){z=o=r;try{if(m=z.stateNode,f)x=m.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none";else{T=z.stateNode;var Te=z.memoizedProps.style,de=Te!=null&&Te.hasOwnProperty("display")?Te.display:null;T.style.display=de==null||typeof de=="boolean"?"":(""+de).trim()}}catch(et){Tn(z,z.return,et)}}}else if(r.tag===6){if(o===null){z=r;try{z.stateNode.nodeValue=f?"":z.memoizedProps}catch(et){Tn(z,z.return,et)}}}else if(r.tag===18){if(o===null){z=r;try{var ge=z.stateNode;f?kb(ge,!0):kb(z.stateNode,!1)}catch(et){Tn(z,z.return,et)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===n)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break e;for(;r.sibling===null;){if(r.return===null||r.return===n)break e;o===r&&(o=null),r=r.return}o===r&&(o=null),r.sibling.return=r.return,r=r.sibling}u&4&&(u=n.updateQueue,u!==null&&(o=u.retryQueue,o!==null&&(u.retryQueue=null,Ld(n,o))));break;case 19:mr(r,n),gr(n),u&4&&(u=n.updateQueue,u!==null&&(n.updateQueue=null,Ld(n,u)));break;case 30:break;case 21:break;default:mr(r,n),gr(n)}}function gr(n){var r=n.flags;if(r&2){try{for(var o,u=n.return;u!==null;){if(E1(u)){o=u;break}u=u.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var f=o.stateNode,m=Fm(n);Dd(n,m,f);break;case 5:var x=o.stateNode;o.flags&32&&(Ns(x,""),o.flags&=-33);var T=Fm(n);Dd(n,T,x);break;case 3:case 4:var z=o.stateNode.containerInfo,ae=Fm(n);Hm(n,ae,z);break;default:throw Error(i(161))}}catch(we){Tn(n,n.return,we)}n.flags&=-3}r&4096&&(n.flags&=-4097)}function D1(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var r=n;D1(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),n=n.sibling}}function ea(n,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)C1(n,r.alternate,r),r=r.sibling}function Io(n){for(n=n.child;n!==null;){var r=n;switch(r.tag){case 0:case 11:case 14:case 15:Pa(4,r,r.return),Io(r);break;case 1:Ci(r,r.return);var o=r.stateNode;typeof o.componentWillUnmount=="function"&&k1(r,r.return,o),Io(r);break;case 27:Hc(r.stateNode);case 26:case 5:Ci(r,r.return),Io(r);break;case 22:r.memoizedState===null&&Io(r);break;case 30:Io(r);break;default:Io(r)}n=n.sibling}}function ta(n,r,o){for(o=o&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var u=r.alternate,f=n,m=r,x=m.flags;switch(m.tag){case 0:case 11:case 15:ta(f,m,o),Mc(4,m);break;case 1:if(ta(f,m,o),u=m,f=u.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(ae){Tn(u,u.return,ae)}if(u=m,f=u.updateQueue,f!==null){var T=u.stateNode;try{var z=f.shared.hiddenCallbacks;if(z!==null)for(f.shared.hiddenCallbacks=null,f=0;f<z.length;f++)dv(z[f],T)}catch(ae){Tn(u,u.return,ae)}}o&&x&64&&_1(m),Dc(m,m.return);break;case 27:T1(m);case 26:case 5:ta(f,m,o),o&&u===null&&x&4&&j1(m),Dc(m,m.return);break;case 12:ta(f,m,o);break;case 31:ta(f,m,o),o&&x&4&&R1(f,m);break;case 13:ta(f,m,o),o&&x&4&&I1(f,m);break;case 22:m.memoizedState===null&&ta(f,m,o),Dc(m,m.return);break;case 30:break;default:ta(f,m,o)}r=r.sibling}}function $m(n,r){var o=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),n=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(n=r.memoizedState.cachePool.pool),n!==o&&(n!=null&&n.refCount++,o!=null&&wc(o))}function Wm(n,r){n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&wc(n))}function di(n,r,o,u){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)L1(n,r,o,u),r=r.sibling}function L1(n,r,o,u){var f=r.flags;switch(r.tag){case 0:case 11:case 15:di(n,r,o,u),f&2048&&Mc(9,r);break;case 1:di(n,r,o,u);break;case 3:di(n,r,o,u),f&2048&&(n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&wc(n)));break;case 12:if(f&2048){di(n,r,o,u),n=r.stateNode;try{var m=r.memoizedProps,x=m.id,T=m.onPostCommit;typeof T=="function"&&T(x,r.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(z){Tn(r,r.return,z)}}else di(n,r,o,u);break;case 31:di(n,r,o,u);break;case 13:di(n,r,o,u);break;case 23:break;case 22:m=r.stateNode,x=r.alternate,r.memoizedState!==null?m._visibility&2?di(n,r,o,u):Lc(n,r):m._visibility&2?di(n,r,o,u):(m._visibility|=2,kl(n,r,o,u,(r.subtreeFlags&10256)!==0||!1)),f&2048&&$m(x,r);break;case 24:di(n,r,o,u),f&2048&&Wm(r.alternate,r);break;default:di(n,r,o,u)}}function kl(n,r,o,u,f){for(f=f&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var m=n,x=r,T=o,z=u,ae=x.flags;switch(x.tag){case 0:case 11:case 15:kl(m,x,T,z,f),Mc(8,x);break;case 23:break;case 22:var we=x.stateNode;x.memoizedState!==null?we._visibility&2?kl(m,x,T,z,f):Lc(m,x):(we._visibility|=2,kl(m,x,T,z,f)),f&&ae&2048&&$m(x.alternate,x);break;case 24:kl(m,x,T,z,f),f&&ae&2048&&Wm(x.alternate,x);break;default:kl(m,x,T,z,f)}r=r.sibling}}function Lc(n,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var o=n,u=r,f=u.flags;switch(u.tag){case 22:Lc(o,u),f&2048&&$m(u.alternate,u);break;case 24:Lc(o,u),f&2048&&Wm(u.alternate,u);break;default:Lc(o,u)}r=r.sibling}}var Pc=8192;function jl(n,r,o){if(n.subtreeFlags&Pc)for(n=n.child;n!==null;)P1(n,r,o),n=n.sibling}function P1(n,r,o){switch(n.tag){case 26:jl(n,r,o),n.flags&Pc&&n.memoizedState!==null&&NT(o,ui,n.memoizedState,n.memoizedProps);break;case 5:jl(n,r,o);break;case 3:case 4:var u=ui;ui=Yd(n.stateNode.containerInfo),jl(n,r,o),ui=u;break;case 22:n.memoizedState===null&&(u=n.alternate,u!==null&&u.memoizedState!==null?(u=Pc,Pc=16777216,jl(n,r,o),Pc=u):jl(n,r,o));break;default:jl(n,r,o)}}function O1(n){var r=n.alternate;if(r!==null&&(n=r.child,n!==null)){r.child=null;do r=n.sibling,n.sibling=null,n=r;while(n!==null)}}function Oc(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var u=r[o];Rs=u,U1(u,n)}O1(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)V1(n),n=n.sibling}function V1(n){switch(n.tag){case 0:case 11:case 15:Oc(n),n.flags&2048&&Pa(9,n,n.return);break;case 3:Oc(n);break;case 12:Oc(n);break;case 22:var r=n.stateNode;n.memoizedState!==null&&r._visibility&2&&(n.return===null||n.return.tag!==13)?(r._visibility&=-3,Pd(n)):Oc(n);break;default:Oc(n)}}function Pd(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var u=r[o];Rs=u,U1(u,n)}O1(n)}for(n=n.child;n!==null;){switch(r=n,r.tag){case 0:case 11:case 15:Pa(8,r,r.return),Pd(r);break;case 22:o=r.stateNode,o._visibility&2&&(o._visibility&=-3,Pd(r));break;default:Pd(r)}n=n.sibling}}function U1(n,r){for(;Rs!==null;){var o=Rs;switch(o.tag){case 0:case 11:case 15:Pa(8,o,r);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var u=o.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:wc(o.memoizedState.cache)}if(u=o.child,u!==null)u.return=o,Rs=u;else e:for(o=n;Rs!==null;){u=Rs;var f=u.sibling,m=u.return;if(N1(u),u===o){Rs=null;break e}if(f!==null){f.return=m,Rs=f;break e}Rs=m}}}var qE={getCacheForType:function(n){var r=Os(gs),o=r.data.get(n);return o===void 0&&(o=n(),r.data.set(n,o)),o},cacheSignal:function(){return Os(gs).controller.signal}},$E=typeof WeakMap=="function"?WeakMap:Map,_n=0,Mn=null,Yt=null,Jt=0,En=0,Ir=null,Oa=!1,El=!1,Gm=!1,na=0,ss=0,Va=0,Mo=0,Km=0,Mr=0,Tl=0,Vc=null,pr=null,Ym=!1,Od=0,B1=0,Vd=1/0,Ud=null,Ua=null,Es=0,Ba=null,Sl=null,sa=0,Qm=0,Xm=null,z1=null,Uc=0,Jm=null;function Dr(){return(_n&2)!==0&&Jt!==0?Jt&-Jt:J.T!==null?rg():rt()}function F1(){if(Mr===0)if((Jt&536870912)===0||on){var n=Ie;Ie<<=1,(Ie&3932160)===0&&(Ie=262144),Mr=n}else Mr=536870912;return n=Ar.current,n!==null&&(n.flags|=32),Mr}function yr(n,r,o){(n===Mn&&(En===2||En===9)||n.cancelPendingCommit!==null)&&(Cl(n,0),za(n,Jt,Mr,!1)),hn(n,o),((_n&2)===0||n!==Mn)&&(n===Mn&&((_n&2)===0&&(Mo|=o),ss===4&&za(n,Jt,Mr,!1)),Ni(n))}function H1(n,r,o){if((_n&6)!==0)throw Error(i(327));var u=!o&&(r&127)===0&&(r&n.expiredLanes)===0||Nt(n,r),f=u?KE(n,r):eg(n,r,!0),m=u;do{if(f===0){El&&!u&&za(n,r,0,!1);break}else{if(o=n.current.alternate,m&&!WE(o)){f=eg(n,r,!1),m=!1;continue}if(f===2){if(m=r,n.errorRecoveryDisabledLanes&m)var x=0;else x=n.pendingLanes&-536870913,x=x!==0?x:x&536870912?536870912:0;if(x!==0){r=x;e:{var T=n;f=Vc;var z=T.current.memoizedState.isDehydrated;if(z&&(Cl(T,x).flags|=256),x=eg(T,x,!1),x!==2){if(Gm&&!z){T.errorRecoveryDisabledLanes|=m,Mo|=m,f=4;break e}m=pr,pr=f,m!==null&&(pr===null?pr=m:pr.push.apply(pr,m))}f=x}if(m=!1,f!==2)continue}}if(f===1){Cl(n,0),za(n,r,0,!0);break}e:{switch(u=n,m=f,m){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:za(u,r,Mr,!Oa);break e;case 2:pr=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(f=Od+300-gt(),10<f)){if(za(u,r,Mr,!Oa),Oe(u,0,!0)!==0)break e;sa=r,u.timeoutHandle=wb(q1.bind(null,u,o,pr,Ud,Ym,r,Mr,Mo,Tl,Oa,m,"Throttled",-0,0),f);break e}q1(u,o,pr,Ud,Ym,r,Mr,Mo,Tl,Oa,m,null,-0,0)}}break}while(!0);Ni(n)}function q1(n,r,o,u,f,m,x,T,z,ae,we,Te,de,ge){if(n.timeoutHandle=-1,Te=r.subtreeFlags,Te&8192||(Te&16785408)===16785408){Te={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ws},P1(r,m,Te);var et=(m&62914560)===m?Od-gt():(m&4194048)===m?B1-gt():0;if(et=AT(Te,et),et!==null){sa=m,n.cancelPendingCommit=et(J1.bind(null,n,r,m,o,u,f,x,T,z,we,Te,null,de,ge)),za(n,m,x,!ae);return}}J1(n,r,m,o,u,f,x,T,z)}function WE(n){for(var r=n;;){var o=r.tag;if((o===0||o===11||o===15)&&r.flags&16384&&(o=r.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var u=0;u<o.length;u++){var f=o[u],m=f.getSnapshot;f=f.value;try{if(!Cr(m(),f))return!1}catch{return!1}}if(o=r.child,r.subtreeFlags&16384&&o!==null)o.return=r,r=o;else{if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function za(n,r,o,u){r&=~Km,r&=~Mo,n.suspendedLanes|=r,n.pingedLanes&=~r,u&&(n.warmLanes|=r),u=n.expirationTimes;for(var f=r;0<f;){var m=31-Mt(f),x=1<<m;u[m]=-1,f&=~x}o!==0&&ms(n,o,r)}function Bd(){return(_n&6)===0?(Bc(0),!1):!0}function Zm(){if(Yt!==null){if(En===0)var n=Yt.return;else n=Yt,Wi=jo=null,gm(n),vl=null,_c=0,n=Yt;for(;n!==null;)x1(n.alternate,n),n=n.return;Yt=null}}function Cl(n,r){var o=n.timeoutHandle;o!==-1&&(n.timeoutHandle=-1,hT(o)),o=n.cancelPendingCommit,o!==null&&(n.cancelPendingCommit=null,o()),sa=0,Zm(),Mn=n,Yt=o=qi(n.current,null),Jt=r,En=0,Ir=null,Oa=!1,El=Nt(n,r),Gm=!1,Tl=Mr=Km=Mo=Va=ss=0,pr=Vc=null,Ym=!1,(r&8)!==0&&(r|=r&32);var u=n.entangledLanes;if(u!==0)for(n=n.entanglements,u&=r;0<u;){var f=31-Mt(u),m=1<<f;r|=n[f],u&=~m}return na=r,od(),o}function $1(n,r){Ut=null,J.H=Ac,r===yl||r===gd?(r=ov(),En=3):r===sm?(r=ov(),En=4):En=r===Rm?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Ir=r,Yt===null&&(ss=1,Nd(n,Hr(r,n.current)))}function W1(){var n=Ar.current;return n===null?!0:(Jt&4194048)===Jt?Gr===null:(Jt&62914560)===Jt||(Jt&536870912)!==0?n===Gr:!1}function G1(){var n=J.H;return J.H=Ac,n===null?Ac:n}function K1(){var n=J.A;return J.A=qE,n}function zd(){ss=4,Oa||(Jt&4194048)!==Jt&&Ar.current!==null||(El=!0),(Va&134217727)===0&&(Mo&134217727)===0||Mn===null||za(Mn,Jt,Mr,!1)}function eg(n,r,o){var u=_n;_n|=2;var f=G1(),m=K1();(Mn!==n||Jt!==r)&&(Ud=null,Cl(n,r)),r=!1;var x=ss;e:do try{if(En!==0&&Yt!==null){var T=Yt,z=Ir;switch(En){case 8:Zm(),x=6;break e;case 3:case 2:case 9:case 6:Ar.current===null&&(r=!0);var ae=En;if(En=0,Ir=null,Nl(n,T,z,ae),o&&El){x=0;break e}break;default:ae=En,En=0,Ir=null,Nl(n,T,z,ae)}}GE(),x=ss;break}catch(we){$1(n,we)}while(!0);return r&&n.shellSuspendCounter++,Wi=jo=null,_n=u,J.H=f,J.A=m,Yt===null&&(Mn=null,Jt=0,od()),x}function GE(){for(;Yt!==null;)Y1(Yt)}function KE(n,r){var o=_n;_n|=2;var u=G1(),f=K1();Mn!==n||Jt!==r?(Ud=null,Vd=gt()+500,Cl(n,r)):El=Nt(n,r);e:do try{if(En!==0&&Yt!==null){r=Yt;var m=Ir;t:switch(En){case 1:En=0,Ir=null,Nl(n,r,m,1);break;case 2:case 9:if(iv(m)){En=0,Ir=null,Q1(r);break}r=function(){En!==2&&En!==9||Mn!==n||(En=7),Ni(n)},m.then(r,r);break e;case 3:En=7;break e;case 4:En=5;break e;case 7:iv(m)?(En=0,Ir=null,Q1(r)):(En=0,Ir=null,Nl(n,r,m,7));break;case 5:var x=null;switch(Yt.tag){case 26:x=Yt.memoizedState;case 5:case 27:var T=Yt;if(x?Lb(x):T.stateNode.complete){En=0,Ir=null;var z=T.sibling;if(z!==null)Yt=z;else{var ae=T.return;ae!==null?(Yt=ae,Fd(ae)):Yt=null}break t}}En=0,Ir=null,Nl(n,r,m,5);break;case 6:En=0,Ir=null,Nl(n,r,m,6);break;case 8:Zm(),ss=6;break e;default:throw Error(i(462))}}YE();break}catch(we){$1(n,we)}while(!0);return Wi=jo=null,J.H=u,J.A=f,_n=o,Yt!==null?0:(Mn=null,Jt=0,od(),ss)}function YE(){for(;Yt!==null&&!it();)Y1(Yt)}function Y1(n){var r=b1(n.alternate,n,na);n.memoizedProps=n.pendingProps,r===null?Fd(n):Yt=r}function Q1(n){var r=n,o=r.alternate;switch(r.tag){case 15:case 0:r=f1(o,r,r.pendingProps,r.type,void 0,Jt);break;case 11:r=f1(o,r,r.pendingProps,r.type.render,r.ref,Jt);break;case 5:gm(r);default:x1(o,r),r=Yt=K0(r,na),r=b1(o,r,na)}n.memoizedProps=n.pendingProps,r===null?Fd(n):Yt=r}function Nl(n,r,o,u){Wi=jo=null,gm(r),vl=null,_c=0;var f=r.return;try{if(OE(n,f,r,o,Jt)){ss=1,Nd(n,Hr(o,n.current)),Yt=null;return}}catch(m){if(f!==null)throw Yt=f,m;ss=1,Nd(n,Hr(o,n.current)),Yt=null;return}r.flags&32768?(on||u===1?n=!0:El||(Jt&536870912)!==0?n=!1:(Oa=n=!0,(u===2||u===9||u===3||u===6)&&(u=Ar.current,u!==null&&u.tag===13&&(u.flags|=16384))),X1(r,n)):Fd(r)}function Fd(n){var r=n;do{if((r.flags&32768)!==0){X1(r,Oa);return}n=r.return;var o=BE(r.alternate,r,na);if(o!==null){Yt=o;return}if(r=r.sibling,r!==null){Yt=r;return}Yt=r=n}while(r!==null);ss===0&&(ss=5)}function X1(n,r){do{var o=zE(n.alternate,n);if(o!==null){o.flags&=32767,Yt=o;return}if(o=n.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!r&&(n=n.sibling,n!==null)){Yt=n;return}Yt=n=o}while(n!==null);ss=6,Yt=null}function J1(n,r,o,u,f,m,x,T,z){n.cancelPendingCommit=null;do Hd();while(Es!==0);if((_n&6)!==0)throw Error(i(327));if(r!==null){if(r===n.current)throw Error(i(177));if(m=r.lanes|r.childLanes,m|=Ff,On(n,o,m,x,T,z),n===Mn&&(Yt=Mn=null,Jt=0),Sl=r,Ba=n,sa=o,Qm=m,Xm=f,z1=u,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,ZE(rn,function(){return sb(),null})):(n.callbackNode=null,n.callbackPriority=0),u=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||u){u=J.T,J.T=null,f=Se.p,Se.p=2,x=_n,_n|=4;try{FE(n,r,o)}finally{_n=x,Se.p=f,J.T=u}}Es=1,Z1(),eb(),tb()}}function Z1(){if(Es===1){Es=0;var n=Ba,r=Sl,o=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||o){o=J.T,J.T=null;var u=Se.p;Se.p=2;var f=_n;_n|=4;try{M1(r,n);var m=hg,x=U0(n.containerInfo),T=m.focusedElem,z=m.selectionRange;if(x!==T&&T&&T.ownerDocument&&V0(T.ownerDocument.documentElement,T)){if(z!==null&&Of(T)){var ae=z.start,we=z.end;if(we===void 0&&(we=ae),"selectionStart"in T)T.selectionStart=ae,T.selectionEnd=Math.min(we,T.value.length);else{var Te=T.ownerDocument||document,de=Te&&Te.defaultView||window;if(de.getSelection){var ge=de.getSelection(),et=T.textContent.length,wt=Math.min(z.start,et),In=z.end===void 0?wt:Math.min(z.end,et);!ge.extend&&wt>In&&(x=In,In=wt,wt=x);var X=O0(T,wt),W=O0(T,In);if(X&&W&&(ge.rangeCount!==1||ge.anchorNode!==X.node||ge.anchorOffset!==X.offset||ge.focusNode!==W.node||ge.focusOffset!==W.offset)){var ie=Te.createRange();ie.setStart(X.node,X.offset),ge.removeAllRanges(),wt>In?(ge.addRange(ie),ge.extend(W.node,W.offset)):(ie.setEnd(W.node,W.offset),ge.addRange(ie))}}}}for(Te=[],ge=T;ge=ge.parentNode;)ge.nodeType===1&&Te.push({element:ge,left:ge.scrollLeft,top:ge.scrollTop});for(typeof T.focus=="function"&&T.focus(),T=0;T<Te.length;T++){var xe=Te[T];xe.element.scrollLeft=xe.left,xe.element.scrollTop=xe.top}}th=!!dg,hg=dg=null}finally{_n=f,Se.p=u,J.T=o}}n.current=r,Es=2}}function eb(){if(Es===2){Es=0;var n=Ba,r=Sl,o=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||o){o=J.T,J.T=null;var u=Se.p;Se.p=2;var f=_n;_n|=4;try{C1(n,r.alternate,r)}finally{_n=f,Se.p=u,J.T=o}}Es=3}}function tb(){if(Es===4||Es===3){Es=0,yt();var n=Ba,r=Sl,o=sa,u=z1;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Es=5:(Es=0,Sl=Ba=null,nb(n,n.pendingLanes));var f=n.pendingLanes;if(f===0&&(Ua=null),ct(o),r=r.stateNode,Gt&&typeof Gt.onCommitFiberRoot=="function")try{Gt.onCommitFiberRoot(un,r,void 0,(r.current.flags&128)===128)}catch{}if(u!==null){r=J.T,f=Se.p,Se.p=2,J.T=null;try{for(var m=n.onRecoverableError,x=0;x<u.length;x++){var T=u[x];m(T.value,{componentStack:T.stack})}}finally{J.T=r,Se.p=f}}(sa&3)!==0&&Hd(),Ni(n),f=n.pendingLanes,(o&261930)!==0&&(f&42)!==0?n===Jm?Uc++:(Uc=0,Jm=n):Uc=0,Bc(0)}}function nb(n,r){(n.pooledCacheLanes&=r)===0&&(r=n.pooledCache,r!=null&&(n.pooledCache=null,wc(r)))}function Hd(){return Z1(),eb(),tb(),sb()}function sb(){if(Es!==5)return!1;var n=Ba,r=Qm;Qm=0;var o=ct(sa),u=J.T,f=Se.p;try{Se.p=32>o?32:o,J.T=null,o=Xm,Xm=null;var m=Ba,x=sa;if(Es=0,Sl=Ba=null,sa=0,(_n&6)!==0)throw Error(i(331));var T=_n;if(_n|=4,V1(m.current),L1(m,m.current,x,o),_n=T,Bc(0,!1),Gt&&typeof Gt.onPostCommitFiberRoot=="function")try{Gt.onPostCommitFiberRoot(un,m)}catch{}return!0}finally{Se.p=f,J.T=u,nb(n,r)}}function rb(n,r,o){r=Hr(o,r),r=Am(n.stateNode,r,2),n=Ma(n,r,2),n!==null&&(hn(n,2),Ni(n))}function Tn(n,r,o){if(n.tag===3)rb(n,n,o);else for(;r!==null;){if(r.tag===3){rb(r,n,o);break}else if(r.tag===1){var u=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(Ua===null||!Ua.has(u))){n=Hr(o,n),o=i1(2),u=Ma(r,o,2),u!==null&&(a1(o,u,r,n),hn(u,2),Ni(u));break}}r=r.return}}function tg(n,r,o){var u=n.pingCache;if(u===null){u=n.pingCache=new $E;var f=new Set;u.set(r,f)}else f=u.get(r),f===void 0&&(f=new Set,u.set(r,f));f.has(o)||(Gm=!0,f.add(o),n=QE.bind(null,n,r,o),r.then(n,n))}function QE(n,r,o){var u=n.pingCache;u!==null&&u.delete(r),n.pingedLanes|=n.suspendedLanes&o,n.warmLanes&=~o,Mn===n&&(Jt&o)===o&&(ss===4||ss===3&&(Jt&62914560)===Jt&&300>gt()-Od?(_n&2)===0&&Cl(n,0):Km|=o,Tl===Jt&&(Tl=0)),Ni(n)}function ib(n,r){r===0&&(r=lt()),n=xo(n,r),n!==null&&(hn(n,r),Ni(n))}function XE(n){var r=n.memoizedState,o=0;r!==null&&(o=r.retryLane),ib(n,o)}function JE(n,r){var o=0;switch(n.tag){case 31:case 13:var u=n.stateNode,f=n.memoizedState;f!==null&&(o=f.retryLane);break;case 19:u=n.stateNode;break;case 22:u=n.stateNode._retryCache;break;default:throw Error(i(314))}u!==null&&u.delete(r),ib(n,o)}function ZE(n,r){return pt(n,r)}var qd=null,Al=null,ng=!1,$d=!1,sg=!1,Fa=0;function Ni(n){n!==Al&&n.next===null&&(Al===null?qd=Al=n:Al=Al.next=n),$d=!0,ng||(ng=!0,tT())}function Bc(n,r){if(!sg&&$d){sg=!0;do for(var o=!1,u=qd;u!==null;){if(n!==0){var f=u.pendingLanes;if(f===0)var m=0;else{var x=u.suspendedLanes,T=u.pingedLanes;m=(1<<31-Mt(42|n)+1)-1,m&=f&~(x&~T),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(o=!0,cb(u,m))}else m=Jt,m=Oe(u,u===Mn?m:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(m&3)===0||Nt(u,m)||(o=!0,cb(u,m));u=u.next}while(o);sg=!1}}function eT(){ab()}function ab(){$d=ng=!1;var n=0;Fa!==0&&dT()&&(n=Fa);for(var r=gt(),o=null,u=qd;u!==null;){var f=u.next,m=ob(u,r);m===0?(u.next=null,o===null?qd=f:o.next=f,f===null&&(Al=o)):(o=u,(n!==0||(m&3)!==0)&&($d=!0)),u=f}Es!==0&&Es!==5||Bc(n),Fa!==0&&(Fa=0)}function ob(n,r){for(var o=n.suspendedLanes,u=n.pingedLanes,f=n.expirationTimes,m=n.pendingLanes&-62914561;0<m;){var x=31-Mt(m),T=1<<x,z=f[x];z===-1?((T&o)===0||(T&u)!==0)&&(f[x]=bt(T,r)):z<=r&&(n.expiredLanes|=T),m&=~T}if(r=Mn,o=Jt,o=Oe(n,n===r?o:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),u=n.callbackNode,o===0||n===r&&(En===2||En===9)||n.cancelPendingCommit!==null)return u!==null&&u!==null&&Ht(u),n.callbackNode=null,n.callbackPriority=0;if((o&3)===0||Nt(n,o)){if(r=o&-o,r===n.callbackPriority)return r;switch(u!==null&&Ht(u),ct(o)){case 2:case 8:o=fs;break;case 32:o=rn;break;case 268435456:o=Fn;break;default:o=rn}return u=lb.bind(null,n),o=pt(o,u),n.callbackPriority=r,n.callbackNode=o,r}return u!==null&&u!==null&&Ht(u),n.callbackPriority=2,n.callbackNode=null,2}function lb(n,r){if(Es!==0&&Es!==5)return n.callbackNode=null,n.callbackPriority=0,null;var o=n.callbackNode;if(Hd()&&n.callbackNode!==o)return null;var u=Jt;return u=Oe(n,n===Mn?u:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),u===0?null:(H1(n,u,r),ob(n,gt()),n.callbackNode!=null&&n.callbackNode===o?lb.bind(null,n):null)}function cb(n,r){if(Hd())return null;H1(n,r,!0)}function tT(){fT(function(){(_n&6)!==0?pt(zt,eT):ab()})}function rg(){if(Fa===0){var n=gl;n===0&&(n=Re,Re<<=1,(Re&261888)===0&&(Re=256)),Fa=n}return Fa}function ub(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:Tr(""+n)}function db(n,r){var o=r.ownerDocument.createElement("input");return o.name=r.name,o.value=r.value,n.id&&o.setAttribute("form",n.id),r.parentNode.insertBefore(o,r),n=new FormData(n),o.parentNode.removeChild(o),n}function nT(n,r,o,u,f){if(r==="submit"&&o&&o.stateNode===f){var m=ub((f[St]||null).action),x=u.submitter;x&&(r=(r=x[St]||null)?ub(r.formAction):x.getAttribute("formAction"),r!==null&&(m=r,x=null));var T=new an("action","action",null,u,f);n.push({event:T,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(Fa!==0){var z=x?db(f,x):new FormData(f);jm(o,{pending:!0,data:z,method:f.method,action:m},null,z)}}else typeof m=="function"&&(T.preventDefault(),z=x?db(f,x):new FormData(f),jm(o,{pending:!0,data:z,method:f.method,action:m},m,z))},currentTarget:f}]})}}for(var ig=0;ig<zf.length;ig++){var ag=zf[ig],sT=ag.toLowerCase(),rT=ag[0].toUpperCase()+ag.slice(1);ci(sT,"on"+rT)}ci(F0,"onAnimationEnd"),ci(H0,"onAnimationIteration"),ci(q0,"onAnimationStart"),ci("dblclick","onDoubleClick"),ci("focusin","onFocus"),ci("focusout","onBlur"),ci(wE,"onTransitionRun"),ci(xE,"onTransitionStart"),ci(_E,"onTransitionCancel"),ci($0,"onTransitionEnd"),Yn("onMouseEnter",["mouseout","mouseover"]),Yn("onMouseLeave",["mouseout","mouseover"]),Yn("onPointerEnter",["pointerout","pointerover"]),Yn("onPointerLeave",["pointerout","pointerover"]),$s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),$s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),$s("onBeforeInput",["compositionend","keypress","textInput","paste"]),$s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),$s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),$s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),iT=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(zc));function hb(n,r){r=(r&4)!==0;for(var o=0;o<n.length;o++){var u=n[o],f=u.event;u=u.listeners;e:{var m=void 0;if(r)for(var x=u.length-1;0<=x;x--){var T=u[x],z=T.instance,ae=T.currentTarget;if(T=T.listener,z!==m&&f.isPropagationStopped())break e;m=T,f.currentTarget=ae;try{m(f)}catch(we){ad(we)}f.currentTarget=null,m=z}else for(x=0;x<u.length;x++){if(T=u[x],z=T.instance,ae=T.currentTarget,T=T.listener,z!==m&&f.isPropagationStopped())break e;m=T,f.currentTarget=ae;try{m(f)}catch(we){ad(we)}f.currentTarget=null,m=z}}}}function Qt(n,r){var o=r[Ss];o===void 0&&(o=r[Ss]=new Set);var u=n+"__bubble";o.has(u)||(fb(r,n,2,!1),o.add(u))}function og(n,r,o){var u=0;r&&(u|=4),fb(o,n,u,r)}var Wd="_reactListening"+Math.random().toString(36).slice(2);function lg(n){if(!n[Wd]){n[Wd]=!0,es.forEach(function(o){o!=="selectionchange"&&(iT.has(o)||og(o,!1,n),og(o,!0,n))});var r=n.nodeType===9?n:n.ownerDocument;r===null||r[Wd]||(r[Wd]=!0,og("selectionchange",!1,r))}}function fb(n,r,o,u){switch(Fb(r)){case 2:var f=MT;break;case 8:f=DT;break;default:f=kg}o=f.bind(null,r,o,n),f=void 0,!me||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(f=!0),u?f!==void 0?n.addEventListener(r,o,{capture:!0,passive:f}):n.addEventListener(r,o,!0):f!==void 0?n.addEventListener(r,o,{passive:f}):n.addEventListener(r,o,!1)}function cg(n,r,o,u,f){var m=u;if((r&1)===0&&(r&2)===0&&u!==null)e:for(;;){if(u===null)return;var x=u.tag;if(x===3||x===4){var T=u.stateNode.containerInfo;if(T===f)break;if(x===4)for(x=u.return;x!==null;){var z=x.tag;if((z===3||z===4)&&x.stateNode.containerInfo===f)return;x=x.return}for(;T!==null;){if(x=Kn(T),x===null)return;if(z=x.tag,z===5||z===6||z===26||z===27){u=m=x;continue e}T=T.parentNode}}u=u.return}H(function(){var ae=m,we=Ls(o),Te=[];e:{var de=W0.get(n);if(de!==void 0){var ge=an,et=n;switch(n){case"keypress":if(kt(o)===0)break e;case"keydown":case"keyup":ge=sd;break;case"focusin":et="focus",ge=ai;break;case"focusout":et="blur",ge=ai;break;case"beforeblur":case"afterblur":ge=ai;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ge=nr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ge=yo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ge=v;break;case F0:case H0:case q0:ge=Qu;break;case $0:ge=R;break;case"scroll":case"scrollend":ge=gn;break;case"wheel":ge=fe;break;case"copy":case"cut":case"paste":ge=Xu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ge=Hi;break;case"toggle":case"beforetoggle":ge=Vt}var wt=(r&4)!==0,In=!wt&&(n==="scroll"||n==="scrollend"),X=wt?de!==null?de+"Capture":null:de;wt=[];for(var W=ae,ie;W!==null;){var xe=W;if(ie=xe.stateNode,xe=xe.tag,xe!==5&&xe!==26&&xe!==27||ie===null||X===null||(xe=$(W,X),xe!=null&&wt.push(Fc(W,xe,ie))),In)break;W=W.return}0<wt.length&&(de=new ge(de,et,null,o,we),Te.push({event:de,listeners:wt}))}}if((r&7)===0){e:{if(de=n==="mouseover"||n==="pointerover",ge=n==="mouseout"||n==="pointerout",de&&o!==Gs&&(et=o.relatedTarget||o.fromElement)&&(Kn(et)||et[bn]))break e;if((ge||de)&&(de=we.window===we?we:(de=we.ownerDocument)?de.defaultView||de.parentWindow:window,ge?(et=o.relatedTarget||o.toElement,ge=ae,et=et?Kn(et):null,et!==null&&(In=c(et),wt=et.tag,et!==In||wt!==5&&wt!==27&&wt!==6)&&(et=null)):(ge=null,et=ae),ge!==et)){if(wt=nr,xe="onMouseLeave",X="onMouseEnter",W="mouse",(n==="pointerout"||n==="pointerover")&&(wt=Hi,xe="onPointerLeave",X="onPointerEnter",W="pointer"),In=ge==null?de:ls(ge),ie=et==null?de:ls(et),de=new wt(xe,W+"leave",ge,o,we),de.target=In,de.relatedTarget=ie,xe=null,Kn(we)===ae&&(wt=new wt(X,W+"enter",et,o,we),wt.target=ie,wt.relatedTarget=In,xe=wt),In=xe,ge&&et)t:{for(wt=aT,X=ge,W=et,ie=0,xe=X;xe;xe=wt(xe))ie++;xe=0;for(var ht=W;ht;ht=wt(ht))xe++;for(;0<ie-xe;)X=wt(X),ie--;for(;0<xe-ie;)W=wt(W),xe--;for(;ie--;){if(X===W||W!==null&&X===W.alternate){wt=X;break t}X=wt(X),W=wt(W)}wt=null}else wt=null;ge!==null&&mb(Te,de,ge,wt,!1),et!==null&&In!==null&&mb(Te,In,et,wt,!0)}}e:{if(de=ae?ls(ae):window,ge=de.nodeName&&de.nodeName.toLowerCase(),ge==="select"||ge==="input"&&de.type==="file")var yn=R0;else if(N0(de))if(I0)yn=yE;else{yn=gE;var at=mE}else ge=de.nodeName,!ge||ge.toLowerCase()!=="input"||de.type!=="checkbox"&&de.type!=="radio"?ae&&ki(ae.elementType)&&(yn=R0):yn=pE;if(yn&&(yn=yn(n,ae))){A0(Te,yn,o,we);break e}at&&at(n,de,ae),n==="focusout"&&ae&&de.type==="number"&&ae.memoizedProps.value!=null&&Ds(de,"number",de.value)}switch(at=ae?ls(ae):window,n){case"focusin":(N0(at)||at.contentEditable==="true")&&(ol=at,Vf=ae,yc=null);break;case"focusout":yc=Vf=ol=null;break;case"mousedown":Uf=!0;break;case"contextmenu":case"mouseup":case"dragend":Uf=!1,B0(Te,o,we);break;case"selectionchange":if(bE)break;case"keydown":case"keyup":B0(Te,o,we)}var Ft;if(xn)e:{switch(n){case"compositionstart":var Zt="onCompositionStart";break e;case"compositionend":Zt="onCompositionEnd";break e;case"compositionupdate":Zt="onCompositionUpdate";break e}Zt=void 0}else al?vo(n,o)&&(Zt="onCompositionEnd"):n==="keydown"&&o.keyCode===229&&(Zt="onCompositionStart");Zt&&(Ei&&o.locale!=="ko"&&(al||Zt!=="onCompositionStart"?Zt==="onCompositionEnd"&&al&&(Ft=vt()):(Ve=we,nt="value"in Ve?Ve.value:Ve.textContent,al=!0)),at=Gd(ae,Zt),0<at.length&&(Zt=new ji(Zt,n,null,o,we),Te.push({event:Zt,listeners:at}),Ft?Zt.data=Ft:(Ft=il(o),Ft!==null&&(Zt.data=Ft)))),(Ft=zr?uE(n,o):dE(n,o))&&(Zt=Gd(ae,"onBeforeInput"),0<Zt.length&&(at=new ji("onBeforeInput","beforeinput",null,o,we),Te.push({event:at,listeners:Zt}),at.data=Ft)),nT(Te,n,ae,o,we)}hb(Te,r)})}function Fc(n,r,o){return{instance:n,listener:r,currentTarget:o}}function Gd(n,r){for(var o=r+"Capture",u=[];n!==null;){var f=n,m=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||m===null||(f=$(n,o),f!=null&&u.unshift(Fc(n,f,m)),f=$(n,r),f!=null&&u.push(Fc(n,f,m))),n.tag===3)return u;n=n.return}return[]}function aT(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function mb(n,r,o,u,f){for(var m=r._reactName,x=[];o!==null&&o!==u;){var T=o,z=T.alternate,ae=T.stateNode;if(T=T.tag,z!==null&&z===u)break;T!==5&&T!==26&&T!==27||ae===null||(z=ae,f?(ae=$(o,m),ae!=null&&x.unshift(Fc(o,ae,z))):f||(ae=$(o,m),ae!=null&&x.push(Fc(o,ae,z)))),o=o.return}x.length!==0&&n.push({event:r,listeners:x})}var oT=/\r\n?/g,lT=/\u0000|\uFFFD/g;function gb(n){return(typeof n=="string"?n:""+n).replace(oT,`
`).replace(lT,"")}function pb(n,r){return r=gb(r),gb(n)===r}function Rn(n,r,o,u,f,m){switch(o){case"children":typeof u=="string"?r==="body"||r==="textarea"&&u===""||Ns(n,u):(typeof u=="number"||typeof u=="bigint")&&r!=="body"&&Ns(n,""+u);break;case"className":oe(n,"class",u);break;case"tabIndex":oe(n,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":oe(n,o,u);break;case"style":ii(n,u,m);break;case"data":if(r!=="object"){oe(n,"data",u);break}case"src":case"href":if(u===""&&(r!=="a"||o!=="href")){n.removeAttribute(o);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){n.removeAttribute(o);break}u=Tr(""+u),n.setAttribute(o,u);break;case"action":case"formAction":if(typeof u=="function"){n.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(o==="formAction"?(r!=="input"&&Rn(n,r,"name",f.name,f,null),Rn(n,r,"formEncType",f.formEncType,f,null),Rn(n,r,"formMethod",f.formMethod,f,null),Rn(n,r,"formTarget",f.formTarget,f,null)):(Rn(n,r,"encType",f.encType,f,null),Rn(n,r,"method",f.method,f,null),Rn(n,r,"target",f.target,f,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){n.removeAttribute(o);break}u=Tr(""+u),n.setAttribute(o,u);break;case"onClick":u!=null&&(n.onclick=Ws);break;case"onScroll":u!=null&&Qt("scroll",n);break;case"onScrollEnd":u!=null&&Qt("scrollend",n);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(o=u.__html,o!=null){if(f.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"multiple":n.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":n.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){n.removeAttribute("xlink:href");break}o=Tr(""+u),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?n.setAttribute(o,""+u):n.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?n.setAttribute(o,""):n.removeAttribute(o);break;case"capture":case"download":u===!0?n.setAttribute(o,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?n.setAttribute(o,u):n.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?n.setAttribute(o,u):n.removeAttribute(o);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?n.removeAttribute(o):n.setAttribute(o,u);break;case"popover":Qt("beforetoggle",n),Qt("toggle",n),q(n,"popover",u);break;case"xlinkActuate":ne(n,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":ne(n,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":ne(n,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":ne(n,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":ne(n,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":ne(n,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":ne(n,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":ne(n,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":ne(n,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":q(n,"is",u);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Fi.get(o)||o,q(n,o,u))}}function ug(n,r,o,u,f,m){switch(o){case"style":ii(n,u,m);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(o=u.__html,o!=null){if(f.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"children":typeof u=="string"?Ns(n,u):(typeof u=="number"||typeof u=="bigint")&&Ns(n,""+u);break;case"onScroll":u!=null&&Qt("scroll",n);break;case"onScrollEnd":u!=null&&Qt("scrollend",n);break;case"onClick":u!=null&&(n.onclick=Ws);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!kr.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(f=o.endsWith("Capture"),r=o.slice(2,f?o.length-7:void 0),m=n[St]||null,m=m!=null?m[o]:null,typeof m=="function"&&n.removeEventListener(r,m,f),typeof u=="function")){typeof m!="function"&&m!==null&&(o in n?n[o]=null:n.hasAttribute(o)&&n.removeAttribute(o)),n.addEventListener(r,u,f);break e}o in n?n[o]=u:u===!0?n.setAttribute(o,""):q(n,o,u)}}}function Us(n,r,o){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Qt("error",n),Qt("load",n);var u=!1,f=!1,m;for(m in o)if(o.hasOwnProperty(m)){var x=o[m];if(x!=null)switch(m){case"src":u=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:Rn(n,r,m,x,o,null)}}f&&Rn(n,r,"srcSet",o.srcSet,o,null),u&&Rn(n,r,"src",o.src,o,null);return;case"input":Qt("invalid",n);var T=m=x=f=null,z=null,ae=null;for(u in o)if(o.hasOwnProperty(u)){var we=o[u];if(we!=null)switch(u){case"name":f=we;break;case"type":x=we;break;case"checked":z=we;break;case"defaultChecked":ae=we;break;case"value":m=we;break;case"defaultValue":T=we;break;case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(i(137,r));break;default:Rn(n,r,u,we,o,null)}}ri(n,m,T,z,ae,x,f,!1);return;case"select":Qt("invalid",n),u=x=m=null;for(f in o)if(o.hasOwnProperty(f)&&(T=o[f],T!=null))switch(f){case"value":m=T;break;case"defaultValue":x=T;break;case"multiple":u=T;default:Rn(n,r,f,T,o,null)}r=m,o=x,n.multiple=!!u,r!=null?er(n,!!u,r,!1):o!=null&&er(n,!!u,o,!0);return;case"textarea":Qt("invalid",n),m=f=u=null;for(x in o)if(o.hasOwnProperty(x)&&(T=o[x],T!=null))switch(x){case"value":u=T;break;case"defaultValue":f=T;break;case"children":m=T;break;case"dangerouslySetInnerHTML":if(T!=null)throw Error(i(91));break;default:Rn(n,r,x,T,o,null)}Er(n,u,f,m);return;case"option":for(z in o)o.hasOwnProperty(z)&&(u=o[z],u!=null)&&(z==="selected"?n.selected=u&&typeof u!="function"&&typeof u!="symbol":Rn(n,r,z,u,o,null));return;case"dialog":Qt("beforetoggle",n),Qt("toggle",n),Qt("cancel",n),Qt("close",n);break;case"iframe":case"object":Qt("load",n);break;case"video":case"audio":for(u=0;u<zc.length;u++)Qt(zc[u],n);break;case"image":Qt("error",n),Qt("load",n);break;case"details":Qt("toggle",n);break;case"embed":case"source":case"link":Qt("error",n),Qt("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ae in o)if(o.hasOwnProperty(ae)&&(u=o[ae],u!=null))switch(ae){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:Rn(n,r,ae,u,o,null)}return;default:if(ki(r)){for(we in o)o.hasOwnProperty(we)&&(u=o[we],u!==void 0&&ug(n,r,we,u,o,void 0));return}}for(T in o)o.hasOwnProperty(T)&&(u=o[T],u!=null&&Rn(n,r,T,u,o,null))}function cT(n,r,o,u){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,m=null,x=null,T=null,z=null,ae=null,we=null;for(ge in o){var Te=o[ge];if(o.hasOwnProperty(ge)&&Te!=null)switch(ge){case"checked":break;case"value":break;case"defaultValue":z=Te;default:u.hasOwnProperty(ge)||Rn(n,r,ge,null,u,Te)}}for(var de in u){var ge=u[de];if(Te=o[de],u.hasOwnProperty(de)&&(ge!=null||Te!=null))switch(de){case"type":m=ge;break;case"name":f=ge;break;case"checked":ae=ge;break;case"defaultChecked":we=ge;break;case"value":x=ge;break;case"defaultValue":T=ge;break;case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(i(137,r));break;default:ge!==Te&&Rn(n,r,de,ge,u,Te)}}Ms(n,x,T,z,ae,we,m,f);return;case"select":ge=x=T=de=null;for(m in o)if(z=o[m],o.hasOwnProperty(m)&&z!=null)switch(m){case"value":break;case"multiple":ge=z;default:u.hasOwnProperty(m)||Rn(n,r,m,null,u,z)}for(f in u)if(m=u[f],z=o[f],u.hasOwnProperty(f)&&(m!=null||z!=null))switch(f){case"value":de=m;break;case"defaultValue":T=m;break;case"multiple":x=m;default:m!==z&&Rn(n,r,f,m,u,z)}r=T,o=x,u=ge,de!=null?er(n,!!o,de,!1):!!u!=!!o&&(r!=null?er(n,!!o,r,!0):er(n,!!o,o?[]:"",!1));return;case"textarea":ge=de=null;for(T in o)if(f=o[T],o.hasOwnProperty(T)&&f!=null&&!u.hasOwnProperty(T))switch(T){case"value":break;case"children":break;default:Rn(n,r,T,null,u,f)}for(x in u)if(f=u[x],m=o[x],u.hasOwnProperty(x)&&(f!=null||m!=null))switch(x){case"value":de=f;break;case"defaultValue":ge=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(i(91));break;default:f!==m&&Rn(n,r,x,f,u,m)}_i(n,de,ge);return;case"option":for(var et in o)de=o[et],o.hasOwnProperty(et)&&de!=null&&!u.hasOwnProperty(et)&&(et==="selected"?n.selected=!1:Rn(n,r,et,null,u,de));for(z in u)de=u[z],ge=o[z],u.hasOwnProperty(z)&&de!==ge&&(de!=null||ge!=null)&&(z==="selected"?n.selected=de&&typeof de!="function"&&typeof de!="symbol":Rn(n,r,z,de,u,ge));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var wt in o)de=o[wt],o.hasOwnProperty(wt)&&de!=null&&!u.hasOwnProperty(wt)&&Rn(n,r,wt,null,u,de);for(ae in u)if(de=u[ae],ge=o[ae],u.hasOwnProperty(ae)&&de!==ge&&(de!=null||ge!=null))switch(ae){case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(i(137,r));break;default:Rn(n,r,ae,de,u,ge)}return;default:if(ki(r)){for(var In in o)de=o[In],o.hasOwnProperty(In)&&de!==void 0&&!u.hasOwnProperty(In)&&ug(n,r,In,void 0,u,de);for(we in u)de=u[we],ge=o[we],!u.hasOwnProperty(we)||de===ge||de===void 0&&ge===void 0||ug(n,r,we,de,u,ge);return}}for(var X in o)de=o[X],o.hasOwnProperty(X)&&de!=null&&!u.hasOwnProperty(X)&&Rn(n,r,X,null,u,de);for(Te in u)de=u[Te],ge=o[Te],!u.hasOwnProperty(Te)||de===ge||de==null&&ge==null||Rn(n,r,Te,de,u,ge)}function yb(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function uT(){if(typeof performance.getEntriesByType=="function"){for(var n=0,r=0,o=performance.getEntriesByType("resource"),u=0;u<o.length;u++){var f=o[u],m=f.transferSize,x=f.initiatorType,T=f.duration;if(m&&T&&yb(x)){for(x=0,T=f.responseEnd,u+=1;u<o.length;u++){var z=o[u],ae=z.startTime;if(ae>T)break;var we=z.transferSize,Te=z.initiatorType;we&&yb(Te)&&(z=z.responseEnd,x+=we*(z<T?1:(T-ae)/(z-ae)))}if(--u,r+=8*(m+x)/(f.duration/1e3),n++,10<n)break}}if(0<n)return r/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var dg=null,hg=null;function Kd(n){return n.nodeType===9?n:n.ownerDocument}function vb(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function bb(n,r){if(n===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&r==="foreignObject"?0:n}function fg(n,r){return n==="textarea"||n==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var mg=null;function dT(){var n=window.event;return n&&n.type==="popstate"?n===mg?!1:(mg=n,!0):(mg=null,!1)}var wb=typeof setTimeout=="function"?setTimeout:void 0,hT=typeof clearTimeout=="function"?clearTimeout:void 0,xb=typeof Promise=="function"?Promise:void 0,fT=typeof queueMicrotask=="function"?queueMicrotask:typeof xb<"u"?function(n){return xb.resolve(null).then(n).catch(mT)}:wb;function mT(n){setTimeout(function(){throw n})}function Ha(n){return n==="head"}function _b(n,r){var o=r,u=0;do{var f=o.nextSibling;if(n.removeChild(o),f&&f.nodeType===8)if(o=f.data,o==="/$"||o==="/&"){if(u===0){n.removeChild(f),Dl(r);return}u--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")u++;else if(o==="html")Hc(n.ownerDocument.documentElement);else if(o==="head"){o=n.ownerDocument.head,Hc(o);for(var m=o.firstChild;m;){var x=m.nextSibling,T=m.nodeName;m[js]||T==="SCRIPT"||T==="STYLE"||T==="LINK"&&m.rel.toLowerCase()==="stylesheet"||o.removeChild(m),m=x}}else o==="body"&&Hc(n.ownerDocument.body);o=f}while(o);Dl(r)}function kb(n,r){var o=n;n=0;do{var u=o.nextSibling;if(o.nodeType===1?r?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(r?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),u&&u.nodeType===8)if(o=u.data,o==="/$"){if(n===0)break;n--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||n++;o=u}while(o)}function gg(n){var r=n.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var o=r;switch(r=r.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":gg(o),hr(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}n.removeChild(o)}}function gT(n,r,o,u){for(;n.nodeType===1;){var f=o;if(n.nodeName.toLowerCase()!==r.toLowerCase()){if(!u&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(u){if(!n[js])switch(r){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(m=n.getAttribute("rel"),m==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(m!==f.rel||n.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||n.getAttribute("title")!==(f.title==null?null:f.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(m=n.getAttribute("src"),(m!==(f.src==null?null:f.src)||n.getAttribute("type")!==(f.type==null?null:f.type)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&m&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(r==="input"&&n.type==="hidden"){var m=f.name==null?null:""+f.name;if(f.type==="hidden"&&n.getAttribute("name")===m)return n}else return n;if(n=Kr(n.nextSibling),n===null)break}return null}function pT(n,r,o){if(r==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!o||(n=Kr(n.nextSibling),n===null))return null;return n}function jb(n,r){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!r||(n=Kr(n.nextSibling),n===null))return null;return n}function pg(n){return n.data==="$?"||n.data==="$~"}function yg(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function yT(n,r){var o=n.ownerDocument;if(n.data==="$~")n._reactRetry=r;else if(n.data!=="$?"||o.readyState!=="loading")r();else{var u=function(){r(),o.removeEventListener("DOMContentLoaded",u)};o.addEventListener("DOMContentLoaded",u),n._reactRetry=u}}function Kr(n){for(;n!=null;n=n.nextSibling){var r=n.nodeType;if(r===1||r===3)break;if(r===8){if(r=n.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return n}var vg=null;function Eb(n){n=n.nextSibling;for(var r=0;n;){if(n.nodeType===8){var o=n.data;if(o==="/$"||o==="/&"){if(r===0)return Kr(n.nextSibling);r--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||r++}n=n.nextSibling}return null}function Tb(n){n=n.previousSibling;for(var r=0;n;){if(n.nodeType===8){var o=n.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(r===0)return n;r--}else o!=="/$"&&o!=="/&"||r++}n=n.previousSibling}return null}function Sb(n,r,o){switch(r=Kd(o),n){case"html":if(n=r.documentElement,!n)throw Error(i(452));return n;case"head":if(n=r.head,!n)throw Error(i(453));return n;case"body":if(n=r.body,!n)throw Error(i(454));return n;default:throw Error(i(451))}}function Hc(n){for(var r=n.attributes;r.length;)n.removeAttributeNode(r[0]);hr(n)}var Yr=new Map,Cb=new Set;function Yd(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var ra=Se.d;Se.d={f:vT,r:bT,D:wT,C:xT,L:_T,m:kT,X:ET,S:jT,M:TT};function vT(){var n=ra.f(),r=Bd();return n||r}function bT(n){var r=os(n);r!==null&&r.tag===5&&r.type==="form"?$v(r):ra.r(n)}var Rl=typeof document>"u"?null:document;function Nb(n,r,o){var u=Rl;if(u&&typeof r=="string"&&r){var f=Qn(r);f='link[rel="'+n+'"][href="'+f+'"]',typeof o=="string"&&(f+='[crossorigin="'+o+'"]'),Cb.has(f)||(Cb.add(f),n={rel:n,crossOrigin:o,href:r},u.querySelector(f)===null&&(r=u.createElement("link"),Us(r,"link",n),wn(r),u.head.appendChild(r)))}}function wT(n){ra.D(n),Nb("dns-prefetch",n,null)}function xT(n,r){ra.C(n,r),Nb("preconnect",n,r)}function _T(n,r,o){ra.L(n,r,o);var u=Rl;if(u&&n&&r){var f='link[rel="preload"][as="'+Qn(r)+'"]';r==="image"&&o&&o.imageSrcSet?(f+='[imagesrcset="'+Qn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(f+='[imagesizes="'+Qn(o.imageSizes)+'"]')):f+='[href="'+Qn(n)+'"]';var m=f;switch(r){case"style":m=Il(n);break;case"script":m=Ml(n)}Yr.has(m)||(n=_({rel:"preload",href:r==="image"&&o&&o.imageSrcSet?void 0:n,as:r},o),Yr.set(m,n),u.querySelector(f)!==null||r==="style"&&u.querySelector(qc(m))||r==="script"&&u.querySelector($c(m))||(r=u.createElement("link"),Us(r,"link",n),wn(r),u.head.appendChild(r)))}}function kT(n,r){ra.m(n,r);var o=Rl;if(o&&n){var u=r&&typeof r.as=="string"?r.as:"script",f='link[rel="modulepreload"][as="'+Qn(u)+'"][href="'+Qn(n)+'"]',m=f;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=Ml(n)}if(!Yr.has(m)&&(n=_({rel:"modulepreload",href:n},r),Yr.set(m,n),o.querySelector(f)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector($c(m)))return}u=o.createElement("link"),Us(u,"link",n),wn(u),o.head.appendChild(u)}}}function jT(n,r,o){ra.S(n,r,o);var u=Rl;if(u&&n){var f=Vn(u).hoistableStyles,m=Il(n);r=r||"default";var x=f.get(m);if(!x){var T={loading:0,preload:null};if(x=u.querySelector(qc(m)))T.loading=5;else{n=_({rel:"stylesheet",href:n,"data-precedence":r},o),(o=Yr.get(m))&&bg(n,o);var z=x=u.createElement("link");wn(z),Us(z,"link",n),z._p=new Promise(function(ae,we){z.onload=ae,z.onerror=we}),z.addEventListener("load",function(){T.loading|=1}),z.addEventListener("error",function(){T.loading|=2}),T.loading|=4,Qd(x,r,u)}x={type:"stylesheet",instance:x,count:1,state:T},f.set(m,x)}}}function ET(n,r){ra.X(n,r);var o=Rl;if(o&&n){var u=Vn(o).hoistableScripts,f=Ml(n),m=u.get(f);m||(m=o.querySelector($c(f)),m||(n=_({src:n,async:!0},r),(r=Yr.get(f))&&wg(n,r),m=o.createElement("script"),wn(m),Us(m,"link",n),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},u.set(f,m))}}function TT(n,r){ra.M(n,r);var o=Rl;if(o&&n){var u=Vn(o).hoistableScripts,f=Ml(n),m=u.get(f);m||(m=o.querySelector($c(f)),m||(n=_({src:n,async:!0,type:"module"},r),(r=Yr.get(f))&&wg(n,r),m=o.createElement("script"),wn(m),Us(m,"link",n),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},u.set(f,m))}}function Ab(n,r,o,u){var f=(f=Ue.current)?Yd(f):null;if(!f)throw Error(i(446));switch(n){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(r=Il(o.href),o=Vn(f).hoistableStyles,u=o.get(r),u||(u={type:"style",instance:null,count:0,state:null},o.set(r,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){n=Il(o.href);var m=Vn(f).hoistableStyles,x=m.get(n);if(x||(f=f.ownerDocument||f,x={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(n,x),(m=f.querySelector(qc(n)))&&!m._p&&(x.instance=m,x.state.loading=5),Yr.has(n)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},Yr.set(n,o),m||ST(f,n,o,x.state))),r&&u===null)throw Error(i(528,""));return x}if(r&&u!==null)throw Error(i(529,""));return null;case"script":return r=o.async,o=o.src,typeof o=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=Ml(o),o=Vn(f).hoistableScripts,u=o.get(r),u||(u={type:"script",instance:null,count:0,state:null},o.set(r,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,n))}}function Il(n){return'href="'+Qn(n)+'"'}function qc(n){return'link[rel="stylesheet"]['+n+"]"}function Rb(n){return _({},n,{"data-precedence":n.precedence,precedence:null})}function ST(n,r,o,u){n.querySelector('link[rel="preload"][as="style"]['+r+"]")?u.loading=1:(r=n.createElement("link"),u.preload=r,r.addEventListener("load",function(){return u.loading|=1}),r.addEventListener("error",function(){return u.loading|=2}),Us(r,"link",o),wn(r),n.head.appendChild(r))}function Ml(n){return'[src="'+Qn(n)+'"]'}function $c(n){return"script[async]"+n}function Ib(n,r,o){if(r.count++,r.instance===null)switch(r.type){case"style":var u=n.querySelector('style[data-href~="'+Qn(o.href)+'"]');if(u)return r.instance=u,wn(u),u;var f=_({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return u=(n.ownerDocument||n).createElement("style"),wn(u),Us(u,"style",f),Qd(u,o.precedence,n),r.instance=u;case"stylesheet":f=Il(o.href);var m=n.querySelector(qc(f));if(m)return r.state.loading|=4,r.instance=m,wn(m),m;u=Rb(o),(f=Yr.get(f))&&bg(u,f),m=(n.ownerDocument||n).createElement("link"),wn(m);var x=m;return x._p=new Promise(function(T,z){x.onload=T,x.onerror=z}),Us(m,"link",u),r.state.loading|=4,Qd(m,o.precedence,n),r.instance=m;case"script":return m=Ml(o.src),(f=n.querySelector($c(m)))?(r.instance=f,wn(f),f):(u=o,(f=Yr.get(m))&&(u=_({},o),wg(u,f)),n=n.ownerDocument||n,f=n.createElement("script"),wn(f),Us(f,"link",u),n.head.appendChild(f),r.instance=f);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(u=r.instance,r.state.loading|=4,Qd(u,o.precedence,n));return r.instance}function Qd(n,r,o){for(var u=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=u.length?u[u.length-1]:null,m=f,x=0;x<u.length;x++){var T=u[x];if(T.dataset.precedence===r)m=T;else if(m!==f)break}m?m.parentNode.insertBefore(n,m.nextSibling):(r=o.nodeType===9?o.head:o,r.insertBefore(n,r.firstChild))}function bg(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.title==null&&(n.title=r.title)}function wg(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.integrity==null&&(n.integrity=r.integrity)}var Xd=null;function Mb(n,r,o){if(Xd===null){var u=new Map,f=Xd=new Map;f.set(o,u)}else f=Xd,u=f.get(o),u||(u=new Map,f.set(o,u));if(u.has(n))return u;for(u.set(n,null),o=o.getElementsByTagName(n),f=0;f<o.length;f++){var m=o[f];if(!(m[js]||m[At]||n==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var x=m.getAttribute(r)||"";x=n+x;var T=u.get(x);T?T.push(m):u.set(x,[m])}}return u}function Db(n,r,o){n=n.ownerDocument||n,n.head.insertBefore(o,r==="title"?n.querySelector("head > title"):null)}function CT(n,r,o){if(o===1||r.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;return r.rel==="stylesheet"?(n=r.disabled,typeof r.precedence=="string"&&n==null):!0;case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function Lb(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function NT(n,r,o,u){if(o.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var f=Il(u.href),m=r.querySelector(qc(f));if(m){r=m._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(n.count++,n=Jd.bind(n),r.then(n,n)),o.state.loading|=4,o.instance=m,wn(m);return}m=r.ownerDocument||r,u=Rb(u),(f=Yr.get(f))&&bg(u,f),m=m.createElement("link"),wn(m);var x=m;x._p=new Promise(function(T,z){x.onload=T,x.onerror=z}),Us(m,"link",u),o.instance=m}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(o,r),(r=o.state.preload)&&(o.state.loading&3)===0&&(n.count++,o=Jd.bind(n),r.addEventListener("load",o),r.addEventListener("error",o))}}var xg=0;function AT(n,r){return n.stylesheets&&n.count===0&&eh(n,n.stylesheets),0<n.count||0<n.imgCount?function(o){var u=setTimeout(function(){if(n.stylesheets&&eh(n,n.stylesheets),n.unsuspend){var m=n.unsuspend;n.unsuspend=null,m()}},6e4+r);0<n.imgBytes&&xg===0&&(xg=62500*uT());var f=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&eh(n,n.stylesheets),n.unsuspend)){var m=n.unsuspend;n.unsuspend=null,m()}},(n.imgBytes>xg?50:800)+r);return n.unsuspend=o,function(){n.unsuspend=null,clearTimeout(u),clearTimeout(f)}}:null}function Jd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)eh(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Zd=null;function eh(n,r){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Zd=new Map,r.forEach(RT,n),Zd=null,Jd.call(n))}function RT(n,r){if(!(r.state.loading&4)){var o=Zd.get(n);if(o)var u=o.get(null);else{o=new Map,Zd.set(n,o);for(var f=n.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<f.length;m++){var x=f[m];(x.nodeName==="LINK"||x.getAttribute("media")!=="not all")&&(o.set(x.dataset.precedence,x),u=x)}u&&o.set(null,u)}f=r.instance,x=f.getAttribute("data-precedence"),m=o.get(x)||u,m===u&&o.set(null,f),o.set(x,f),this.count++,u=Jd.bind(this),f.addEventListener("load",u),f.addEventListener("error",u),m?m.parentNode.insertBefore(f,m.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(f,n.firstChild)),r.state.loading|=4}}var Wc={$$typeof:re,Provider:null,Consumer:null,_currentValue:He,_currentValue2:He,_threadCount:0};function IT(n,r,o,u,f,m,x,T,z){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=dn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=dn(0),this.hiddenUpdates=dn(null),this.identifierPrefix=u,this.onUncaughtError=f,this.onCaughtError=m,this.onRecoverableError=x,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=z,this.incompleteTransitions=new Map}function Pb(n,r,o,u,f,m,x,T,z,ae,we,Te){return n=new IT(n,r,o,x,z,ae,we,Te,T),r=1,m===!0&&(r|=24),m=Nr(3,null,null,r),n.current=m,m.stateNode=n,r=em(),r.refCount++,n.pooledCache=r,r.refCount++,m.memoizedState={element:u,isDehydrated:o,cache:r},rm(m),n}function Ob(n){return n?(n=ul,n):ul}function Vb(n,r,o,u,f,m){f=Ob(f),u.context===null?u.context=f:u.pendingContext=f,u=Ia(r),u.payload={element:o},m=m===void 0?null:m,m!==null&&(u.callback=m),o=Ma(n,u,r),o!==null&&(yr(o,n,r),jc(o,n,r))}function Ub(n,r){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var o=n.retryLane;n.retryLane=o!==0&&o<r?o:r}}function _g(n,r){Ub(n,r),(n=n.alternate)&&Ub(n,r)}function Bb(n){if(n.tag===13||n.tag===31){var r=xo(n,67108864);r!==null&&yr(r,n,67108864),_g(n,67108864)}}function zb(n){if(n.tag===13||n.tag===31){var r=Dr();r=Ke(r);var o=xo(n,r);o!==null&&yr(o,n,r),_g(n,r)}}var th=!0;function MT(n,r,o,u){var f=J.T;J.T=null;var m=Se.p;try{Se.p=2,kg(n,r,o,u)}finally{Se.p=m,J.T=f}}function DT(n,r,o,u){var f=J.T;J.T=null;var m=Se.p;try{Se.p=8,kg(n,r,o,u)}finally{Se.p=m,J.T=f}}function kg(n,r,o,u){if(th){var f=jg(u);if(f===null)cg(n,r,u,nh,o),Hb(n,u);else if(PT(f,n,r,o,u))u.stopPropagation();else if(Hb(n,u),r&4&&-1<LT.indexOf(n)){for(;f!==null;){var m=os(f);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var x=Fe(m.pendingLanes);if(x!==0){var T=m;for(T.pendingLanes|=2,T.entangledLanes|=2;x;){var z=1<<31-Mt(x);T.entanglements[1]|=z,x&=~z}Ni(m),(_n&6)===0&&(Vd=gt()+500,Bc(0))}}break;case 31:case 13:T=xo(m,2),T!==null&&yr(T,m,2),Bd(),_g(m,2)}if(m=jg(u),m===null&&cg(n,r,u,nh,o),m===f)break;f=m}f!==null&&u.stopPropagation()}else cg(n,r,u,null,o)}}function jg(n){return n=Ls(n),Eg(n)}var nh=null;function Eg(n){if(nh=null,n=Kn(n),n!==null){var r=c(n);if(r===null)n=null;else{var o=r.tag;if(o===13){if(n=d(r),n!==null)return n;n=null}else if(o===31){if(n=g(r),n!==null)return n;n=null}else if(o===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;n=null}else r!==n&&(n=null)}}return nh=n,null}function Fb(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(_t()){case zt:return 2;case fs:return 8;case rn:case Zn:return 32;case Fn:return 268435456;default:return 32}default:return 32}}var Tg=!1,qa=null,$a=null,Wa=null,Gc=new Map,Kc=new Map,Ga=[],LT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Hb(n,r){switch(n){case"focusin":case"focusout":qa=null;break;case"dragenter":case"dragleave":$a=null;break;case"mouseover":case"mouseout":Wa=null;break;case"pointerover":case"pointerout":Gc.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Kc.delete(r.pointerId)}}function Yc(n,r,o,u,f,m){return n===null||n.nativeEvent!==m?(n={blockedOn:r,domEventName:o,eventSystemFlags:u,nativeEvent:m,targetContainers:[f]},r!==null&&(r=os(r),r!==null&&Bb(r)),n):(n.eventSystemFlags|=u,r=n.targetContainers,f!==null&&r.indexOf(f)===-1&&r.push(f),n)}function PT(n,r,o,u,f){switch(r){case"focusin":return qa=Yc(qa,n,r,o,u,f),!0;case"dragenter":return $a=Yc($a,n,r,o,u,f),!0;case"mouseover":return Wa=Yc(Wa,n,r,o,u,f),!0;case"pointerover":var m=f.pointerId;return Gc.set(m,Yc(Gc.get(m)||null,n,r,o,u,f)),!0;case"gotpointercapture":return m=f.pointerId,Kc.set(m,Yc(Kc.get(m)||null,n,r,o,u,f)),!0}return!1}function qb(n){var r=Kn(n.target);if(r!==null){var o=c(r);if(o!==null){if(r=o.tag,r===13){if(r=d(o),r!==null){n.blockedOn=r,Kt(n.priority,function(){zb(o)});return}}else if(r===31){if(r=g(o),r!==null){n.blockedOn=r,Kt(n.priority,function(){zb(o)});return}}else if(r===3&&o.stateNode.current.memoizedState.isDehydrated){n.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}n.blockedOn=null}function sh(n){if(n.blockedOn!==null)return!1;for(var r=n.targetContainers;0<r.length;){var o=jg(n.nativeEvent);if(o===null){o=n.nativeEvent;var u=new o.constructor(o.type,o);Gs=u,o.target.dispatchEvent(u),Gs=null}else return r=os(o),r!==null&&Bb(r),n.blockedOn=o,!1;r.shift()}return!0}function $b(n,r,o){sh(n)&&o.delete(r)}function OT(){Tg=!1,qa!==null&&sh(qa)&&(qa=null),$a!==null&&sh($a)&&($a=null),Wa!==null&&sh(Wa)&&(Wa=null),Gc.forEach($b),Kc.forEach($b)}function rh(n,r){n.blockedOn===r&&(n.blockedOn=null,Tg||(Tg=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,OT)))}var ih=null;function Wb(n){ih!==n&&(ih=n,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){ih===n&&(ih=null);for(var r=0;r<n.length;r+=3){var o=n[r],u=n[r+1],f=n[r+2];if(typeof u!="function"){if(Eg(u||o)===null)continue;break}var m=os(o);m!==null&&(n.splice(r,3),r-=3,jm(m,{pending:!0,data:f,method:o.method,action:u},u,f))}}))}function Dl(n){function r(z){return rh(z,n)}qa!==null&&rh(qa,n),$a!==null&&rh($a,n),Wa!==null&&rh(Wa,n),Gc.forEach(r),Kc.forEach(r);for(var o=0;o<Ga.length;o++){var u=Ga[o];u.blockedOn===n&&(u.blockedOn=null)}for(;0<Ga.length&&(o=Ga[0],o.blockedOn===null);)qb(o),o.blockedOn===null&&Ga.shift();if(o=(n.ownerDocument||n).$$reactFormReplay,o!=null)for(u=0;u<o.length;u+=3){var f=o[u],m=o[u+1],x=f[St]||null;if(typeof m=="function")x||Wb(o);else if(x){var T=null;if(m&&m.hasAttribute("formAction")){if(f=m,x=m[St]||null)T=x.formAction;else if(Eg(f)!==null)continue}else T=x.action;typeof T=="function"?o[u+1]=T:(o.splice(u,3),u-=3),Wb(o)}}}function Gb(){function n(m){m.canIntercept&&m.info==="react-transition"&&m.intercept({handler:function(){return new Promise(function(x){return f=x})},focusReset:"manual",scroll:"manual"})}function r(){f!==null&&(f(),f=null),u||setTimeout(o,20)}function o(){if(!u&&!navigation.transition){var m=navigation.currentEntry;m&&m.url!=null&&navigation.navigate(m.url,{state:m.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,f=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(o,100),function(){u=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),f!==null&&(f(),f=null)}}}function Sg(n){this._internalRoot=n}ah.prototype.render=Sg.prototype.render=function(n){var r=this._internalRoot;if(r===null)throw Error(i(409));var o=r.current,u=Dr();Vb(o,u,n,r,null,null)},ah.prototype.unmount=Sg.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var r=n.containerInfo;Vb(n.current,2,null,n,null,null),Bd(),r[bn]=null}};function ah(n){this._internalRoot=n}ah.prototype.unstable_scheduleHydration=function(n){if(n){var r=rt();n={blockedOn:null,target:n,priority:r};for(var o=0;o<Ga.length&&r!==0&&r<Ga[o].priority;o++);Ga.splice(o,0,n),o===0&&qb(n)}};var Kb=e.version;if(Kb!=="19.2.4")throw Error(i(527,Kb,"19.2.4"));Se.findDOMNode=function(n){var r=n._reactInternals;if(r===void 0)throw typeof n.render=="function"?Error(i(188)):(n=Object.keys(n).join(","),Error(i(268,n)));return n=p(r),n=n!==null?b(n):null,n=n===null?null:n.stateNode,n};var VT={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:J,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var oh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!oh.isDisabled&&oh.supportsFiber)try{un=oh.inject(VT),Gt=oh}catch{}}return Xc.createRoot=function(n,r){if(!l(n))throw Error(i(299));var o=!1,u="",f=t1,m=n1,x=s1;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(u=r.identifierPrefix),r.onUncaughtError!==void 0&&(f=r.onUncaughtError),r.onCaughtError!==void 0&&(m=r.onCaughtError),r.onRecoverableError!==void 0&&(x=r.onRecoverableError)),r=Pb(n,1,!1,null,null,o,u,null,f,m,x,Gb),n[bn]=r.current,lg(n),new Sg(r)},Xc.hydrateRoot=function(n,r,o){if(!l(n))throw Error(i(299));var u=!1,f="",m=t1,x=n1,T=s1,z=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(m=o.onUncaughtError),o.onCaughtError!==void 0&&(x=o.onCaughtError),o.onRecoverableError!==void 0&&(T=o.onRecoverableError),o.formState!==void 0&&(z=o.formState)),r=Pb(n,1,!0,r,o??null,u,f,z,m,x,T,Gb),r.context=Ob(null),o=r.current,u=Dr(),u=Ke(u),f=Ia(u),f.callback=null,Ma(o,f,u),o=u,r.current.lanes=o,hn(r,o),Ni(r),n[bn]=r.current,lg(n),new ah(r)},Xc.version="19.2.4",Xc}var r2;function KT(){if(r2)return Ag.exports;r2=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Ag.exports=GT(),Ag.exports}var YT=KT();const QT="modulepreload",XT=function(s){return"/login/"+s},i2={},Hs=function(e,t,i){let l=Promise.resolve();if(t&&t.length>0){let y=function(p){return Promise.all(p.map(b=>Promise.resolve(b).then(_=>({status:"fulfilled",value:_}),_=>({status:"rejected",reason:_}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),g=d?.nonce||d?.getAttribute("nonce");l=y(t.map(p=>{if(p=XT(p),p in i2)return;i2[p]=!0;const b=p.endsWith(".css"),_=b?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${_}`))return;const j=document.createElement("link");if(j.rel=b?"stylesheet":QT,b||(j.as="script"),j.crossOrigin="",j.href=p,g&&j.setAttribute("nonce",g),document.head.appendChild(j),b)return new Promise((I,F)=>{j.addEventListener("load",I),j.addEventListener("error",()=>F(new Error(`Unable to preload CSS for ${p}`)))})}))}function c(d){const g=new Event("vite:preloadError",{cancelable:!0});if(g.payload=d,window.dispatchEvent(g),!g.defaultPrevented)throw d}return l.then(d=>{for(const g of d||[])g.status==="rejected"&&c(g.reason);return e().catch(c)})};var a2="popstate";function JT(s={}){function e(i,l){let{pathname:c,search:d,hash:g}=i.location;return bp("",{pathname:c,search:d,hash:g},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function t(i,l){return typeof l=="string"?l:xu(l)}return eS(e,t,null,s)}function Gn(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function Zr(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function ZT(){return Math.random().toString(36).substring(2,10)}function o2(s,e){return{usr:s.state,key:s.key,idx:e}}function bp(s,e,t=null,i){return{pathname:typeof s=="string"?s:s.pathname,search:"",hash:"",...typeof e=="string"?nc(e):e,state:t,key:e&&e.key||i||ZT()}}function xu({pathname:s="/",search:e="",hash:t=""}){return e&&e!=="?"&&(s+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(s+=t.charAt(0)==="#"?t:"#"+t),s}function nc(s){let e={};if(s){let t=s.indexOf("#");t>=0&&(e.hash=s.substring(t),s=s.substring(0,t));let i=s.indexOf("?");i>=0&&(e.search=s.substring(i),s=s.substring(0,i)),s&&(e.pathname=s)}return e}function eS(s,e,t,i={}){let{window:l=document.defaultView,v5Compat:c=!1}=i,d=l.history,g="POP",y=null,p=b();p==null&&(p=0,d.replaceState({...d.state,idx:p},""));function b(){return(d.state||{idx:null}).idx}function _(){g="POP";let B=b(),Y=B==null?null:B-p;p=B,y&&y({action:g,location:G.location,delta:Y})}function j(B,Y){g="PUSH";let ee=bp(G.location,B,Y);p=b()+1;let re=o2(ee,p),pe=G.createHref(ee);try{d.pushState(re,"",pe)}catch(ve){if(ve instanceof DOMException&&ve.name==="DataCloneError")throw ve;l.location.assign(pe)}c&&y&&y({action:g,location:G.location,delta:1})}function I(B,Y){g="REPLACE";let ee=bp(G.location,B,Y);p=b();let re=o2(ee,p),pe=G.createHref(ee);d.replaceState(re,"",pe),c&&y&&y({action:g,location:G.location,delta:0})}function F(B){return tS(B)}let G={get action(){return g},get location(){return s(l,d)},listen(B){if(y)throw new Error("A history only accepts one active listener");return l.addEventListener(a2,_),y=B,()=>{l.removeEventListener(a2,_),y=null}},createHref(B){return e(l,B)},createURL:F,encodeLocation(B){let Y=F(B);return{pathname:Y.pathname,search:Y.search,hash:Y.hash}},push:j,replace:I,go(B){return d.go(B)}};return G}function tS(s,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Gn(t,"No window.location.(origin|href) available to create URL");let i=typeof s=="string"?s:xu(s);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function Tx(s,e,t="/"){return nS(s,e,t,!1)}function nS(s,e,t,i){let l=typeof e=="string"?nc(e):e,c=ga(l.pathname||"/",t);if(c==null)return null;let d=Sx(s);sS(d);let g=null;for(let y=0;g==null&&y<d.length;++y){let p=mS(c);g=hS(d[y],p,i)}return g}function Sx(s,e=[],t=[],i="",l=!1){let c=(d,g,y=l,p)=>{let b={relativePath:p===void 0?d.path||"":p,caseSensitive:d.caseSensitive===!0,childrenIndex:g,route:d};if(b.relativePath.startsWith("/")){if(!b.relativePath.startsWith(i)&&y)return;Gn(b.relativePath.startsWith(i),`Absolute route path "${b.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),b.relativePath=b.relativePath.slice(i.length)}let _=da([i,b.relativePath]),j=t.concat(b);d.children&&d.children.length>0&&(Gn(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${_}".`),Sx(d.children,e,j,_,y)),!(d.path==null&&!d.index)&&e.push({path:_,score:uS(_,d.index),routesMeta:j})};return s.forEach((d,g)=>{if(d.path===""||!d.path?.includes("?"))c(d,g);else for(let y of Cx(d.path))c(d,g,!0,y)}),e}function Cx(s){let e=s.split("/");if(e.length===0)return[];let[t,...i]=e,l=t.endsWith("?"),c=t.replace(/\?$/,"");if(i.length===0)return l?[c,""]:[c];let d=Cx(i.join("/")),g=[];return g.push(...d.map(y=>y===""?c:[c,y].join("/"))),l&&g.push(...d),g.map(y=>s.startsWith("/")&&y===""?"/":y)}function sS(s){s.sort((e,t)=>e.score!==t.score?t.score-e.score:dS(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var rS=/^:[\w-]+$/,iS=3,aS=2,oS=1,lS=10,cS=-2,l2=s=>s==="*";function uS(s,e){let t=s.split("/"),i=t.length;return t.some(l2)&&(i+=cS),e&&(i+=aS),t.filter(l=>!l2(l)).reduce((l,c)=>l+(rS.test(c)?iS:c===""?oS:lS),i)}function dS(s,e){return s.length===e.length&&s.slice(0,-1).every((i,l)=>i===e[l])?s[s.length-1]-e[e.length-1]:0}function hS(s,e,t=!1){let{routesMeta:i}=s,l={},c="/",d=[];for(let g=0;g<i.length;++g){let y=i[g],p=g===i.length-1,b=c==="/"?e:e.slice(c.length)||"/",_=Lh({path:y.relativePath,caseSensitive:y.caseSensitive,end:p},b),j=y.route;if(!_&&p&&t&&!i[i.length-1].route.index&&(_=Lh({path:y.relativePath,caseSensitive:y.caseSensitive,end:!1},b)),!_)return null;Object.assign(l,_.params),d.push({params:l,pathname:da([c,_.pathname]),pathnameBase:vS(da([c,_.pathnameBase])),route:j}),_.pathnameBase!=="/"&&(c=da([c,_.pathnameBase]))}return d}function Lh(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[t,i]=fS(s.path,s.caseSensitive,s.end),l=e.match(t);if(!l)return null;let c=l[0],d=c.replace(/(.)\/+$/,"$1"),g=l.slice(1);return{params:i.reduce((p,{paramName:b,isOptional:_},j)=>{if(b==="*"){let F=g[j]||"";d=c.slice(0,c.length-F.length).replace(/(.)\/+$/,"$1")}const I=g[j];return _&&!I?p[b]=void 0:p[b]=(I||"").replace(/%2F/g,"/"),p},{}),pathname:c,pathnameBase:d,pattern:s}}function fS(s,e=!1,t=!0){Zr(s==="*"||!s.endsWith("*")||s.endsWith("/*"),`Route path "${s}" will be treated as if it were "${s.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${s.replace(/\*$/,"/*")}".`);let i=[],l="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,g,y)=>(i.push({paramName:g,isOptional:y!=null}),y?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return s.endsWith("*")?(i.push({paramName:"*"}),l+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?l+="\\/*$":s!==""&&s!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,e?void 0:"i"),i]}function mS(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Zr(!1,`The URL path "${s}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),s}}function ga(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=s.charAt(t);return i&&i!=="/"?null:s.slice(t)||"/"}var gS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function pS(s,e="/"){let{pathname:t,search:i="",hash:l=""}=typeof s=="string"?nc(s):s,c;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?c=c2(t.substring(1),"/"):c=c2(t,e)):c=e,{pathname:c,search:bS(i),hash:wS(l)}}function c2(s,e){let t=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(l=>{l===".."?t.length>1&&t.pop():l!=="."&&t.push(l)}),t.length>1?t.join("/"):"/"}function Dg(s,e,t,i){return`Cannot include a '${s}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function yS(s){return s.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function ty(s){let e=yS(s);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function ny(s,e,t,i=!1){let l;typeof s=="string"?l=nc(s):(l={...s},Gn(!l.pathname||!l.pathname.includes("?"),Dg("?","pathname","search",l)),Gn(!l.pathname||!l.pathname.includes("#"),Dg("#","pathname","hash",l)),Gn(!l.search||!l.search.includes("#"),Dg("#","search","hash",l)));let c=s===""||l.pathname==="",d=c?"/":l.pathname,g;if(d==null)g=t;else{let _=e.length-1;if(!i&&d.startsWith("..")){let j=d.split("/");for(;j[0]==="..";)j.shift(),_-=1;l.pathname=j.join("/")}g=_>=0?e[_]:"/"}let y=pS(l,g),p=d&&d!=="/"&&d.endsWith("/"),b=(c||d===".")&&t.endsWith("/");return!y.pathname.endsWith("/")&&(p||b)&&(y.pathname+="/"),y}var da=s=>s.join("/").replace(/\/\/+/g,"/"),vS=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),bS=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,wS=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s,xS=class{constructor(s,e,t,i=!1){this.status=s,this.statusText=e||"",this.internal=i,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function _S(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}function kS(s){return s.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var Nx=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Ax(s,e){let t=s;if(typeof t!="string"||!gS.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let i=t,l=!1;if(Nx)try{let c=new URL(window.location.href),d=t.startsWith("//")?new URL(c.protocol+t):new URL(t),g=ga(d.pathname,e);d.origin===c.origin&&g!=null?t=g+d.search+d.hash:l=!0}catch{Zr(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:l,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Rx=["POST","PUT","PATCH","DELETE"];new Set(Rx);var jS=["GET",...Rx];new Set(jS);var sc=w.createContext(null);sc.displayName="DataRouter";var rf=w.createContext(null);rf.displayName="DataRouterState";var ES=w.createContext(!1),Ix=w.createContext({isTransitioning:!1});Ix.displayName="ViewTransition";var TS=w.createContext(new Map);TS.displayName="Fetchers";var SS=w.createContext(null);SS.displayName="Await";var Or=w.createContext(null);Or.displayName="Navigation";var Du=w.createContext(null);Du.displayName="Location";var bi=w.createContext({outlet:null,matches:[],isDataRoute:!1});bi.displayName="Route";var sy=w.createContext(null);sy.displayName="RouteError";var Mx="REACT_ROUTER_ERROR",CS="REDIRECT",NS="ROUTE_ERROR_RESPONSE";function AS(s){if(s.startsWith(`${Mx}:${CS}:{`))try{let e=JSON.parse(s.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function RS(s){if(s.startsWith(`${Mx}:${NS}:{`))try{let e=JSON.parse(s.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new xS(e.status,e.statusText,e.data)}catch{}}function IS(s,{relative:e}={}){Gn(rc(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=w.useContext(Or),{hash:l,pathname:c,search:d}=Lu(s,{relative:e}),g=c;return t!=="/"&&(g=c==="/"?t:da([t,c])),i.createHref({pathname:g,search:d,hash:l})}function rc(){return w.useContext(Du)!=null}function Ui(){return Gn(rc(),"useLocation() may be used only in the context of a <Router> component."),w.useContext(Du).location}var Dx="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Lx(s){w.useContext(Or).static||w.useLayoutEffect(s)}function qs(){let{isDataRoute:s}=w.useContext(bi);return s?WS():MS()}function MS(){Gn(rc(),"useNavigate() may be used only in the context of a <Router> component.");let s=w.useContext(sc),{basename:e,navigator:t}=w.useContext(Or),{matches:i}=w.useContext(bi),{pathname:l}=Ui(),c=JSON.stringify(ty(i)),d=w.useRef(!1);return Lx(()=>{d.current=!0}),w.useCallback((y,p={})=>{if(Zr(d.current,Dx),!d.current)return;if(typeof y=="number"){t.go(y);return}let b=ny(y,JSON.parse(c),l,p.relative==="path");s==null&&e!=="/"&&(b.pathname=b.pathname==="/"?e:da([e,b.pathname])),(p.replace?t.replace:t.push)(b,p.state,p)},[e,t,c,l,s])}w.createContext(null);function DS(){let{matches:s}=w.useContext(bi),e=s[s.length-1];return e?e.params:{}}function Lu(s,{relative:e}={}){let{matches:t}=w.useContext(bi),{pathname:i}=Ui(),l=JSON.stringify(ty(t));return w.useMemo(()=>ny(s,JSON.parse(l),i,e==="path"),[s,l,i,e])}function LS(s,e){return Px(s,e)}function Px(s,e,t,i,l){Gn(rc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:c}=w.useContext(Or),{matches:d}=w.useContext(bi),g=d[d.length-1],y=g?g.params:{},p=g?g.pathname:"/",b=g?g.pathnameBase:"/",_=g&&g.route;{let ee=_&&_.path||"";Vx(p,!_||ee.endsWith("*")||ee.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${p}" (under <Route path="${ee}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${ee}"> to <Route path="${ee==="/"?"*":`${ee}/*`}">.`)}let j=Ui(),I;if(e){let ee=typeof e=="string"?nc(e):e;Gn(b==="/"||ee.pathname?.startsWith(b),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${b}" but pathname "${ee.pathname}" was given in the \`location\` prop.`),I=ee}else I=j;let F=I.pathname||"/",G=F;if(b!=="/"){let ee=b.replace(/^\//,"").split("/");G="/"+F.replace(/^\//,"").split("/").slice(ee.length).join("/")}let B=Tx(s,{pathname:G});Zr(_||B!=null,`No routes matched location "${I.pathname}${I.search}${I.hash}" `),Zr(B==null||B[B.length-1].route.element!==void 0||B[B.length-1].route.Component!==void 0||B[B.length-1].route.lazy!==void 0,`Matched leaf route at location "${I.pathname}${I.search}${I.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let Y=BS(B&&B.map(ee=>Object.assign({},ee,{params:Object.assign({},y,ee.params),pathname:da([b,c.encodeLocation?c.encodeLocation(ee.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:ee.pathname]),pathnameBase:ee.pathnameBase==="/"?b:da([b,c.encodeLocation?c.encodeLocation(ee.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:ee.pathnameBase])})),d,t,i,l);return e&&Y?w.createElement(Du.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...I},navigationType:"POP"}},Y):Y}function PS(){let s=$S(),e=_S(s)?`${s.status} ${s.statusText}`:s instanceof Error?s.message:JSON.stringify(s),t=s instanceof Error?s.stack:null,i="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:i},c={padding:"2px 4px",backgroundColor:i},d=null;return console.error("Error handled by React Router default ErrorBoundary:",s),d=w.createElement(w.Fragment,null,w.createElement("p",null," Hey developer "),w.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",w.createElement("code",{style:c},"ErrorBoundary")," or"," ",w.createElement("code",{style:c},"errorElement")," prop on your route.")),w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},e),t?w.createElement("pre",{style:l},t):null,d)}var OS=w.createElement(PS,null),Ox=class extends w.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,e){return e.location!==s.location||e.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:e.error,location:e.location,revalidation:s.revalidation||e.revalidation}}componentDidCatch(s,e){this.props.onError?this.props.onError(s,e):console.error("React Router caught the following error during render",s)}render(){let s=this.state.error;if(this.context&&typeof s=="object"&&s&&"digest"in s&&typeof s.digest=="string"){const t=RS(s.digest);t&&(s=t)}let e=s!==void 0?w.createElement(bi.Provider,{value:this.props.routeContext},w.createElement(sy.Provider,{value:s,children:this.props.component})):this.props.children;return this.context?w.createElement(VS,{error:s},e):e}};Ox.contextType=ES;var Lg=new WeakMap;function VS({children:s,error:e}){let{basename:t}=w.useContext(Or);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=AS(e.digest);if(i){let l=Lg.get(e);if(l)throw l;let c=Ax(i.location,t);if(Nx&&!Lg.get(e))if(c.isExternal||i.reloadDocument)window.location.href=c.absoluteURL||c.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(c.to,{replace:i.replace}));throw Lg.set(e,d),d}return w.createElement("meta",{httpEquiv:"refresh",content:`0;url=${c.absoluteURL||c.to}`})}}return s}function US({routeContext:s,match:e,children:t}){let i=w.useContext(sc);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),w.createElement(bi.Provider,{value:s},t)}function BS(s,e=[],t=null,i=null,l=null){if(s==null){if(!t)return null;if(t.errors)s=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)s=t.matches;else return null}let c=s,d=t?.errors;if(d!=null){let b=c.findIndex(_=>_.route.id&&d?.[_.route.id]!==void 0);Gn(b>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),c=c.slice(0,Math.min(c.length,b+1))}let g=!1,y=-1;if(t)for(let b=0;b<c.length;b++){let _=c[b];if((_.route.HydrateFallback||_.route.hydrateFallbackElement)&&(y=b),_.route.id){let{loaderData:j,errors:I}=t,F=_.route.loader&&!j.hasOwnProperty(_.route.id)&&(!I||I[_.route.id]===void 0);if(_.route.lazy||F){g=!0,y>=0?c=c.slice(0,y+1):c=[c[0]];break}}}let p=t&&i?(b,_)=>{i(b,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:kS(t.matches),errorInfo:_})}:void 0;return c.reduceRight((b,_,j)=>{let I,F=!1,G=null,B=null;t&&(I=d&&_.route.id?d[_.route.id]:void 0,G=_.route.errorElement||OS,g&&(y<0&&j===0?(Vx("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),F=!0,B=null):y===j&&(F=!0,B=_.route.hydrateFallbackElement||null)));let Y=e.concat(c.slice(0,j+1)),ee=()=>{let re;return I?re=G:F?re=B:_.route.Component?re=w.createElement(_.route.Component,null):_.route.element?re=_.route.element:re=b,w.createElement(US,{match:_,routeContext:{outlet:b,matches:Y,isDataRoute:t!=null},children:re})};return t&&(_.route.ErrorBoundary||_.route.errorElement||j===0)?w.createElement(Ox,{location:t.location,revalidation:t.revalidation,component:G,error:I,children:ee(),routeContext:{outlet:null,matches:Y,isDataRoute:!0},onError:p}):ee()},null)}function ry(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function zS(s){let e=w.useContext(sc);return Gn(e,ry(s)),e}function FS(s){let e=w.useContext(rf);return Gn(e,ry(s)),e}function HS(s){let e=w.useContext(bi);return Gn(e,ry(s)),e}function iy(s){let e=HS(s),t=e.matches[e.matches.length-1];return Gn(t.route.id,`${s} can only be used on routes that contain a unique "id"`),t.route.id}function qS(){return iy("useRouteId")}function $S(){let s=w.useContext(sy),e=FS("useRouteError"),t=iy("useRouteError");return s!==void 0?s:e.errors?.[t]}function WS(){let{router:s}=zS("useNavigate"),e=iy("useNavigate"),t=w.useRef(!1);return Lx(()=>{t.current=!0}),w.useCallback(async(l,c={})=>{Zr(t.current,Dx),t.current&&(typeof l=="number"?await s.navigate(l):await s.navigate(l,{fromRouteId:e,...c}))},[s,e])}var u2={};function Vx(s,e,t){!e&&!u2[s]&&(u2[s]=!0,Zr(!1,t))}w.memo(GS);function GS({routes:s,future:e,state:t,onError:i}){return Px(s,void 0,t,i,e)}function Ux({to:s,replace:e,state:t,relative:i}){Gn(rc(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=w.useContext(Or);Zr(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:c}=w.useContext(bi),{pathname:d}=Ui(),g=qs(),y=ny(s,ty(c),d,i==="path"),p=JSON.stringify(y);return w.useEffect(()=>{g(JSON.parse(p),{replace:e,state:t,relative:i})},[g,p,i,e,t]),null}function Sn(s){Gn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function KS({basename:s="/",children:e=null,location:t,navigationType:i="POP",navigator:l,static:c=!1,unstable_useTransitions:d}){Gn(!rc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let g=s.replace(/^\/*/,"/"),y=w.useMemo(()=>({basename:g,navigator:l,static:c,unstable_useTransitions:d,future:{}}),[g,l,c,d]);typeof t=="string"&&(t=nc(t));let{pathname:p="/",search:b="",hash:_="",state:j=null,key:I="default"}=t,F=w.useMemo(()=>{let G=ga(p,g);return G==null?null:{location:{pathname:G,search:b,hash:_,state:j,key:I},navigationType:i}},[g,p,b,_,j,I,i]);return Zr(F!=null,`<Router basename="${g}"> is not able to match the URL "${p}${b}${_}" because it does not start with the basename, so the <Router> won't render anything.`),F==null?null:w.createElement(Or.Provider,{value:y},w.createElement(Du.Provider,{children:e,value:F}))}function YS({children:s,location:e}){return LS(wp(s),e)}function wp(s,e=[]){let t=[];return w.Children.forEach(s,(i,l)=>{if(!w.isValidElement(i))return;let c=[...e,l];if(i.type===w.Fragment){t.push.apply(t,wp(i.props.children,c));return}Gn(i.type===Sn,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Gn(!i.props.index||!i.props.children,"An index route cannot have child routes.");let d={id:i.props.id||c.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(d.children=wp(i.props.children,c)),t.push(d)}),t}var kh="get",jh="application/x-www-form-urlencoded";function af(s){return typeof HTMLElement<"u"&&s instanceof HTMLElement}function QS(s){return af(s)&&s.tagName.toLowerCase()==="button"}function XS(s){return af(s)&&s.tagName.toLowerCase()==="form"}function JS(s){return af(s)&&s.tagName.toLowerCase()==="input"}function ZS(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function eC(s,e){return s.button===0&&(!e||e==="_self")&&!ZS(s)}function xp(s=""){return new URLSearchParams(typeof s=="string"||Array.isArray(s)||s instanceof URLSearchParams?s:Object.keys(s).reduce((e,t)=>{let i=s[t];return e.concat(Array.isArray(i)?i.map(l=>[t,l]):[[t,i]])},[]))}function tC(s,e){let t=xp(s);return e&&e.forEach((i,l)=>{t.has(l)||e.getAll(l).forEach(c=>{t.append(l,c)})}),t}var lh=null;function nC(){if(lh===null)try{new FormData(document.createElement("form"),0),lh=!1}catch{lh=!0}return lh}var sC=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Pg(s){return s!=null&&!sC.has(s)?(Zr(!1,`"${s}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${jh}"`),null):s}function rC(s,e){let t,i,l,c,d;if(XS(s)){let g=s.getAttribute("action");i=g?ga(g,e):null,t=s.getAttribute("method")||kh,l=Pg(s.getAttribute("enctype"))||jh,c=new FormData(s)}else if(QS(s)||JS(s)&&(s.type==="submit"||s.type==="image")){let g=s.form;if(g==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let y=s.getAttribute("formaction")||g.getAttribute("action");if(i=y?ga(y,e):null,t=s.getAttribute("formmethod")||g.getAttribute("method")||kh,l=Pg(s.getAttribute("formenctype"))||Pg(g.getAttribute("enctype"))||jh,c=new FormData(g,s),!nC()){let{name:p,type:b,value:_}=s;if(b==="image"){let j=p?`${p}.`:"";c.append(`${j}x`,"0"),c.append(`${j}y`,"0")}else p&&c.append(p,_)}}else{if(af(s))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=kh,i=null,l=jh,d=s}return c&&l==="text/plain"&&(d=c,c=void 0),{action:i,method:t.toLowerCase(),encType:l,formData:c,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function ay(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function iC(s,e,t,i){let l=typeof s=="string"?new URL(s,typeof window>"u"?"server://singlefetch/":window.location.origin):s;return t?l.pathname.endsWith("/")?l.pathname=`${l.pathname}_.${i}`:l.pathname=`${l.pathname}.${i}`:l.pathname==="/"?l.pathname=`_root.${i}`:e&&ga(l.pathname,e)==="/"?l.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:l.pathname=`${l.pathname.replace(/\/$/,"")}.${i}`,l}async function aC(s,e){if(s.id in e)return e[s.id];try{let t=await import(s.module);return e[s.id]=t,t}catch(t){return console.error(`Error loading route module \`${s.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function oC(s){return s==null?!1:s.href==null?s.rel==="preload"&&typeof s.imageSrcSet=="string"&&typeof s.imageSizes=="string":typeof s.rel=="string"&&typeof s.href=="string"}async function lC(s,e,t){let i=await Promise.all(s.map(async l=>{let c=e.routes[l.route.id];if(c){let d=await aC(c,t);return d.links?d.links():[]}return[]}));return hC(i.flat(1).filter(oC).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function d2(s,e,t,i,l,c){let d=(y,p)=>t[p]?y.route.id!==t[p].route.id:!0,g=(y,p)=>t[p].pathname!==y.pathname||t[p].route.path?.endsWith("*")&&t[p].params["*"]!==y.params["*"];return c==="assets"?e.filter((y,p)=>d(y,p)||g(y,p)):c==="data"?e.filter((y,p)=>{let b=i.routes[y.route.id];if(!b||!b.hasLoader)return!1;if(d(y,p)||g(y,p))return!0;if(y.route.shouldRevalidate){let _=y.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(s,window.origin),nextParams:y.params,defaultShouldRevalidate:!0});if(typeof _=="boolean")return _}return!0}):[]}function cC(s,e,{includeHydrateFallback:t}={}){return uC(s.map(i=>{let l=e.routes[i.route.id];if(!l)return[];let c=[l.module];return l.clientActionModule&&(c=c.concat(l.clientActionModule)),l.clientLoaderModule&&(c=c.concat(l.clientLoaderModule)),t&&l.hydrateFallbackModule&&(c=c.concat(l.hydrateFallbackModule)),l.imports&&(c=c.concat(l.imports)),c}).flat(1))}function uC(s){return[...new Set(s)]}function dC(s){let e={},t=Object.keys(s).sort();for(let i of t)e[i]=s[i];return e}function hC(s,e){let t=new Set;return new Set(e),s.reduce((i,l)=>{let c=JSON.stringify(dC(l));return t.has(c)||(t.add(c),i.push({key:c,link:l})),i},[])}function Bx(){let s=w.useContext(sc);return ay(s,"You must render this element inside a <DataRouterContext.Provider> element"),s}function fC(){let s=w.useContext(rf);return ay(s,"You must render this element inside a <DataRouterStateContext.Provider> element"),s}var oy=w.createContext(void 0);oy.displayName="FrameworkContext";function zx(){let s=w.useContext(oy);return ay(s,"You must render this element inside a <HydratedRouter> element"),s}function mC(s,e){let t=w.useContext(oy),[i,l]=w.useState(!1),[c,d]=w.useState(!1),{onFocus:g,onBlur:y,onMouseEnter:p,onMouseLeave:b,onTouchStart:_}=e,j=w.useRef(null);w.useEffect(()=>{if(s==="render"&&d(!0),s==="viewport"){let G=Y=>{Y.forEach(ee=>{d(ee.isIntersecting)})},B=new IntersectionObserver(G,{threshold:.5});return j.current&&B.observe(j.current),()=>{B.disconnect()}}},[s]),w.useEffect(()=>{if(i){let G=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(G)}}},[i]);let I=()=>{l(!0)},F=()=>{l(!1),d(!1)};return t?s!=="intent"?[c,j,{}]:[c,j,{onFocus:Jc(g,I),onBlur:Jc(y,F),onMouseEnter:Jc(p,I),onMouseLeave:Jc(b,F),onTouchStart:Jc(_,I)}]:[!1,j,{}]}function Jc(s,e){return t=>{s&&s(t),t.defaultPrevented||e(t)}}function gC({page:s,...e}){let{router:t}=Bx(),i=w.useMemo(()=>Tx(t.routes,s,t.basename),[t.routes,s,t.basename]);return i?w.createElement(yC,{page:s,matches:i,...e}):null}function pC(s){let{manifest:e,routeModules:t}=zx(),[i,l]=w.useState([]);return w.useEffect(()=>{let c=!1;return lC(s,e,t).then(d=>{c||l(d)}),()=>{c=!0}},[s,e,t]),i}function yC({page:s,matches:e,...t}){let i=Ui(),{future:l,manifest:c,routeModules:d}=zx(),{basename:g}=Bx(),{loaderData:y,matches:p}=fC(),b=w.useMemo(()=>d2(s,e,p,c,i,"data"),[s,e,p,c,i]),_=w.useMemo(()=>d2(s,e,p,c,i,"assets"),[s,e,p,c,i]),j=w.useMemo(()=>{if(s===i.pathname+i.search+i.hash)return[];let G=new Set,B=!1;if(e.forEach(ee=>{let re=c.routes[ee.route.id];!re||!re.hasLoader||(!b.some(pe=>pe.route.id===ee.route.id)&&ee.route.id in y&&d[ee.route.id]?.shouldRevalidate||re.hasClientLoader?B=!0:G.add(ee.route.id))}),G.size===0)return[];let Y=iC(s,g,l.unstable_trailingSlashAwareDataRequests,"data");return B&&G.size>0&&Y.searchParams.set("_routes",e.filter(ee=>G.has(ee.route.id)).map(ee=>ee.route.id).join(",")),[Y.pathname+Y.search]},[g,l.unstable_trailingSlashAwareDataRequests,y,i,c,b,e,s,d]),I=w.useMemo(()=>cC(_,c),[_,c]),F=pC(_);return w.createElement(w.Fragment,null,j.map(G=>w.createElement("link",{key:G,rel:"prefetch",as:"fetch",href:G,...t})),I.map(G=>w.createElement("link",{key:G,rel:"modulepreload",href:G,...t})),F.map(({key:G,link:B})=>w.createElement("link",{key:G,nonce:t.nonce,...B,crossOrigin:B.crossOrigin??t.crossOrigin})))}function vC(...s){return e=>{s.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var bC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{bC&&(window.__reactRouterVersion="7.13.0")}catch{}function wC({basename:s,children:e,unstable_useTransitions:t,window:i}){let l=w.useRef();l.current==null&&(l.current=JT({window:i,v5Compat:!0}));let c=l.current,[d,g]=w.useState({action:c.action,location:c.location}),y=w.useCallback(p=>{t===!1?g(p):w.startTransition(()=>g(p))},[t]);return w.useLayoutEffect(()=>c.listen(y),[c,y]),w.createElement(KS,{basename:s,children:e,location:d.location,navigationType:d.action,navigator:c,unstable_useTransitions:t})}var Fx=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Hx=w.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:l,reloadDocument:c,replace:d,state:g,target:y,to:p,preventScrollReset:b,viewTransition:_,unstable_defaultShouldRevalidate:j,...I},F){let{basename:G,unstable_useTransitions:B}=w.useContext(Or),Y=typeof p=="string"&&Fx.test(p),ee=Ax(p,G);p=ee.to;let re=IS(p,{relative:l}),[pe,ve,he]=mC(i,I),L=jC(p,{replace:d,state:g,target:y,preventScrollReset:b,relative:l,viewTransition:_,unstable_defaultShouldRevalidate:j,unstable_useTransitions:B});function E(V){e&&e(V),V.defaultPrevented||L(V)}let A=w.createElement("a",{...I,...he,href:ee.absoluteURL||re,onClick:ee.isExternal||c?e:E,ref:vC(F,ve),target:y,"data-discover":!Y&&t==="render"?"true":void 0});return pe&&!Y?w.createElement(w.Fragment,null,A,w.createElement(gC,{page:re})):A});Hx.displayName="Link";var xC=w.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:l=!1,style:c,to:d,viewTransition:g,children:y,...p},b){let _=Lu(d,{relative:p.relative}),j=Ui(),I=w.useContext(rf),{navigator:F,basename:G}=w.useContext(Or),B=I!=null&&AC(_)&&g===!0,Y=F.encodeLocation?F.encodeLocation(_).pathname:_.pathname,ee=j.pathname,re=I&&I.navigation&&I.navigation.location?I.navigation.location.pathname:null;t||(ee=ee.toLowerCase(),re=re?re.toLowerCase():null,Y=Y.toLowerCase()),re&&G&&(re=ga(re,G)||re);const pe=Y!=="/"&&Y.endsWith("/")?Y.length-1:Y.length;let ve=ee===Y||!l&&ee.startsWith(Y)&&ee.charAt(pe)==="/",he=re!=null&&(re===Y||!l&&re.startsWith(Y)&&re.charAt(Y.length)==="/"),L={isActive:ve,isPending:he,isTransitioning:B},E=ve?e:void 0,A;typeof i=="function"?A=i(L):A=[i,ve?"active":null,he?"pending":null,B?"transitioning":null].filter(Boolean).join(" ");let V=typeof c=="function"?c(L):c;return w.createElement(Hx,{...p,"aria-current":E,className:A,ref:b,style:V,to:d,viewTransition:g},typeof y=="function"?y(L):y)});xC.displayName="NavLink";var _C=w.forwardRef(({discover:s="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:l,state:c,method:d=kh,action:g,onSubmit:y,relative:p,preventScrollReset:b,viewTransition:_,unstable_defaultShouldRevalidate:j,...I},F)=>{let{unstable_useTransitions:G}=w.useContext(Or),B=CC(),Y=NC(g,{relative:p}),ee=d.toLowerCase()==="get"?"get":"post",re=typeof g=="string"&&Fx.test(g),pe=ve=>{if(y&&y(ve),ve.defaultPrevented)return;ve.preventDefault();let he=ve.nativeEvent.submitter,L=he?.getAttribute("formmethod")||d,E=()=>B(he||ve.currentTarget,{fetcherKey:e,method:L,navigate:t,replace:l,state:c,relative:p,preventScrollReset:b,viewTransition:_,unstable_defaultShouldRevalidate:j});G&&t!==!1?w.startTransition(()=>E()):E()};return w.createElement("form",{ref:F,method:ee,action:Y,onSubmit:i?y:pe,...I,"data-discover":!re&&s==="render"?"true":void 0})});_C.displayName="Form";function kC(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function qx(s){let e=w.useContext(sc);return Gn(e,kC(s)),e}function jC(s,{target:e,replace:t,state:i,preventScrollReset:l,relative:c,viewTransition:d,unstable_defaultShouldRevalidate:g,unstable_useTransitions:y}={}){let p=qs(),b=Ui(),_=Lu(s,{relative:c});return w.useCallback(j=>{if(eC(j,e)){j.preventDefault();let I=t!==void 0?t:xu(b)===xu(_),F=()=>p(s,{replace:I,state:i,preventScrollReset:l,relative:c,viewTransition:d,unstable_defaultShouldRevalidate:g});y?w.startTransition(()=>F()):F()}},[b,p,_,t,i,e,s,l,c,d,g,y])}function EC(s){Zr(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=w.useRef(xp(s)),t=w.useRef(!1),i=Ui(),l=w.useMemo(()=>tC(i.search,t.current?null:e.current),[i.search]),c=qs(),d=w.useCallback((g,y)=>{const p=xp(typeof g=="function"?g(new URLSearchParams(l)):g);t.current=!0,c("?"+p,y)},[c,l]);return[l,d]}var TC=0,SC=()=>`__${String(++TC)}__`;function CC(){let{router:s}=qx("useSubmit"),{basename:e}=w.useContext(Or),t=qS(),i=s.fetch,l=s.navigate;return w.useCallback(async(c,d={})=>{let{action:g,method:y,encType:p,formData:b,body:_}=rC(c,e);if(d.navigate===!1){let j=d.fetcherKey||SC();await i(j,t,d.action||g,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:b,body:_,formMethod:d.method||y,formEncType:d.encType||p,flushSync:d.flushSync})}else await l(d.action||g,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:b,body:_,formMethod:d.method||y,formEncType:d.encType||p,replace:d.replace,state:d.state,fromRouteId:t,flushSync:d.flushSync,viewTransition:d.viewTransition})},[i,l,e,t])}function NC(s,{relative:e}={}){let{basename:t}=w.useContext(Or),i=w.useContext(bi);Gn(i,"useFormAction must be used inside a RouteContext");let[l]=i.matches.slice(-1),c={...Lu(s||".",{relative:e})},d=Ui();if(s==null){c.search=d.search;let g=new URLSearchParams(c.search),y=g.getAll("index");if(y.some(b=>b==="")){g.delete("index"),y.filter(_=>_).forEach(_=>g.append("index",_));let b=g.toString();c.search=b?`?${b}`:""}}return(!s||s===".")&&l.route.index&&(c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(c.pathname=c.pathname==="/"?t:da([t,c.pathname])),xu(c)}function AC(s,{relative:e}={}){let t=w.useContext(Ix);Gn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=qx("useViewTransitionState"),l=Lu(s,{relative:e});if(!t.isTransitioning)return!1;let c=ga(t.currentLocation.pathname,i)||t.currentLocation.pathname,d=ga(t.nextLocation.pathname,i)||t.nextLocation.pathname;return Lh(l.pathname,d)!=null||Lh(l.pathname,c)!=null}const RC=()=>{};var h2={};const $x=function(s){const e=[];let t=0;for(let i=0;i<s.length;i++){let l=s.charCodeAt(i);l<128?e[t++]=l:l<2048?(e[t++]=l>>6|192,e[t++]=l&63|128):(l&64512)===55296&&i+1<s.length&&(s.charCodeAt(i+1)&64512)===56320?(l=65536+((l&1023)<<10)+(s.charCodeAt(++i)&1023),e[t++]=l>>18|240,e[t++]=l>>12&63|128,e[t++]=l>>6&63|128,e[t++]=l&63|128):(e[t++]=l>>12|224,e[t++]=l>>6&63|128,e[t++]=l&63|128)}return e},IC=function(s){const e=[];let t=0,i=0;for(;t<s.length;){const l=s[t++];if(l<128)e[i++]=String.fromCharCode(l);else if(l>191&&l<224){const c=s[t++];e[i++]=String.fromCharCode((l&31)<<6|c&63)}else if(l>239&&l<365){const c=s[t++],d=s[t++],g=s[t++],y=((l&7)<<18|(c&63)<<12|(d&63)<<6|g&63)-65536;e[i++]=String.fromCharCode(55296+(y>>10)),e[i++]=String.fromCharCode(56320+(y&1023))}else{const c=s[t++],d=s[t++];e[i++]=String.fromCharCode((l&15)<<12|(c&63)<<6|d&63)}}return e.join("")},Wx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let l=0;l<s.length;l+=3){const c=s[l],d=l+1<s.length,g=d?s[l+1]:0,y=l+2<s.length,p=y?s[l+2]:0,b=c>>2,_=(c&3)<<4|g>>4;let j=(g&15)<<2|p>>6,I=p&63;y||(I=64,d||(j=64)),i.push(t[b],t[_],t[j],t[I])}return i.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray($x(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):IC(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let l=0;l<s.length;){const c=t[s.charAt(l++)],g=l<s.length?t[s.charAt(l)]:0;++l;const p=l<s.length?t[s.charAt(l)]:64;++l;const _=l<s.length?t[s.charAt(l)]:64;if(++l,c==null||g==null||p==null||_==null)throw new MC;const j=c<<2|g>>4;if(i.push(j),p!==64){const I=g<<4&240|p>>2;if(i.push(I),_!==64){const F=p<<6&192|_;i.push(F)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class MC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const DC=function(s){const e=$x(s);return Wx.encodeByteArray(e,!0)},Ph=function(s){return DC(s).replace(/\./g,"")},Gx=function(s){try{return Wx.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function LC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const PC=()=>LC().__FIREBASE_DEFAULTS__,OC=()=>{if(typeof process>"u"||typeof h2>"u")return;const s=h2.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},VC=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&Gx(s[1]);return e&&JSON.parse(e)},of=()=>{try{return RC()||PC()||OC()||VC()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},Kx=s=>of()?.emulatorHosts?.[s],Yx=s=>{const e=Kx(s);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},Qx=()=>of()?.config,Xx=s=>of()?.[`_${s}`];class UC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function fo(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function ly(s){return(await fetch(s,{credentials:"include"})).ok}function Jx(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",l=s.iat||0,c=s.sub||s.user_id;if(!c)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d={iss:`https://securetoken.google.com/${i}`,aud:i,iat:l,exp:l+3600,auth_time:l,sub:c,user_id:c,firebase:{sign_in_provider:"custom",identities:{}},...s};return[Ph(JSON.stringify(t)),Ph(JSON.stringify(d)),""].join(".")}const hu={};function BC(){const s={prod:[],emulator:[]};for(const e of Object.keys(hu))hu[e]?s.emulator.push(e):s.prod.push(e);return s}function zC(s){let e=document.getElementById(s),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),t=!0),{created:t,element:e}}let f2=!1;function cy(s,e){if(typeof window>"u"||typeof document>"u"||!fo(window.location.host)||hu[s]===e||hu[s]||f2)return;hu[s]=e;function t(j){return`__firebase__banner__${j}`}const i="__firebase__banner",c=BC().prod.length>0;function d(){const j=document.getElementById(i);j&&j.remove()}function g(j){j.style.display="flex",j.style.background="#7faaf0",j.style.position="fixed",j.style.bottom="5px",j.style.left="5px",j.style.padding=".5em",j.style.borderRadius="5px",j.style.alignItems="center"}function y(j,I){j.setAttribute("width","24"),j.setAttribute("id",I),j.setAttribute("height","24"),j.setAttribute("viewBox","0 0 24 24"),j.setAttribute("fill","none"),j.style.marginLeft="-6px"}function p(){const j=document.createElement("span");return j.style.cursor="pointer",j.style.marginLeft="16px",j.style.fontSize="24px",j.innerHTML=" &times;",j.onclick=()=>{f2=!0,d()},j}function b(j,I){j.setAttribute("id",I),j.innerText="Learn more",j.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",j.setAttribute("target","__blank"),j.style.paddingLeft="5px",j.style.textDecoration="underline"}function _(){const j=zC(i),I=t("text"),F=document.getElementById(I)||document.createElement("span"),G=t("learnmore"),B=document.getElementById(G)||document.createElement("a"),Y=t("preprendIcon"),ee=document.getElementById(Y)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(j.created){const re=j.element;g(re),b(B,G);const pe=p();y(ee,Y),re.append(ee,F,B,pe),document.body.appendChild(re)}c?(F.innerText="Preview backend disconnected.",ee.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(ee.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,F.innerText="Preview backend running in this workspace."),F.setAttribute("id",I)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",_):_()}function Zs(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function FC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Zs())}function HC(){const s=of()?.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function qC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function $C(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function WC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function GC(){const s=Zs();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function KC(){return!HC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Zx(){try{return typeof indexedDB=="object"}catch{return!1}}function e_(){return new Promise((s,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",l=self.indexedDB.open(i);l.onsuccess=()=>{l.result.close(),t||self.indexedDB.deleteDatabase(i),s(!0)},l.onupgradeneeded=()=>{t=!1},l.onerror=()=>{e(l.error?.message||"")}}catch(t){e(t)}})}function YC(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}const QC="FirebaseError";class wi extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=QC,Object.setPrototypeOf(this,wi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Yo.prototype.create)}}class Yo{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},l=`${this.service}/${e}`,c=this.errors[e],d=c?XC(c,i):"Error",g=`${this.serviceName}: ${d} (${l}).`;return new wi(l,g,i)}}function XC(s,e){return s.replace(JC,(t,i)=>{const l=e[i];return l!=null?String(l):`<${i}?>`})}const JC=/\{\$([^}]+)}/g;function ZC(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function pa(s,e){if(s===e)return!0;const t=Object.keys(s),i=Object.keys(e);for(const l of t){if(!i.includes(l))return!1;const c=s[l],d=e[l];if(m2(c)&&m2(d)){if(!pa(c,d))return!1}else if(c!==d)return!1}for(const l of i)if(!t.includes(l))return!1;return!0}function m2(s){return s!==null&&typeof s=="object"}function Pu(s){const e=[];for(const[t,i]of Object.entries(s))Array.isArray(i)?i.forEach(l=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(l))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function iu(s){const e={};return s.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[l,c]=i.split("=");e[decodeURIComponent(l)]=decodeURIComponent(c)}}),e}function au(s){const e=s.indexOf("?");if(!e)return"";const t=s.indexOf("#",e);return s.substring(e,t>0?t:void 0)}function eN(s,e){const t=new tN(s,e);return t.subscribe.bind(t)}class tN{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let l;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");nN(e,["next","error","complete"])?l=e:l={next:e,error:t,complete:i},l.next===void 0&&(l.next=Og),l.error===void 0&&(l.error=Og),l.complete===void 0&&(l.complete=Og);const c=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?l.error(this.finalError):l.complete()}catch{}}),this.observers.push(l),c}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function nN(s,e){if(typeof s!="object"||s===null)return!1;for(const t of e)if(t in s&&typeof s[t]=="function")return!0;return!1}function Og(){}function jn(s){return s&&s._delegate?s._delegate:s}class ei{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Lo="[DEFAULT]";class sN{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new UC;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const l=this.getOrInitializeService({instanceIdentifier:t});l&&i.resolve(l)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(l){if(i)return null;throw l}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(iN(e))try{this.getOrInitializeService({instanceIdentifier:Lo})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(t);try{const c=this.getOrInitializeService({instanceIdentifier:l});i.resolve(c)}catch{}}}}clearInstance(e=Lo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Lo){return this.instances.has(e)}getOptions(e=Lo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const l=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[c,d]of this.instancesDeferred.entries()){const g=this.normalizeInstanceIdentifier(c);i===g&&d.resolve(l)}return l}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),l=this.onInitCallbacks.get(i)??new Set;l.add(e),this.onInitCallbacks.set(i,l);const c=this.instances.get(i);return c&&e(c,i),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const l of i)try{l(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:rN(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Lo){return this.component?this.component.multipleInstances?e:Lo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function rN(s){return s===Lo?void 0:s}function iN(s){return s.instantiationMode==="EAGER"}class aN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new sN(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var en;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(en||(en={}));const oN={debug:en.DEBUG,verbose:en.VERBOSE,info:en.INFO,warn:en.WARN,error:en.ERROR,silent:en.SILENT},lN=en.INFO,cN={[en.DEBUG]:"log",[en.VERBOSE]:"log",[en.INFO]:"info",[en.WARN]:"warn",[en.ERROR]:"error"},uN=(s,e,...t)=>{if(e<s.logLevel)return;const i=new Date().toISOString(),l=cN[e];if(l)console[l](`[${i}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class uy{constructor(e){this.name=e,this._logLevel=lN,this._logHandler=uN,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in en))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?oN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,en.DEBUG,...e),this._logHandler(this,en.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,en.VERBOSE,...e),this._logHandler(this,en.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,en.INFO,...e),this._logHandler(this,en.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,en.WARN,...e),this._logHandler(this,en.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,en.ERROR,...e),this._logHandler(this,en.ERROR,...e)}}const dN=(s,e)=>e.some(t=>s instanceof t);let g2,p2;function hN(){return g2||(g2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function fN(){return p2||(p2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const t_=new WeakMap,_p=new WeakMap,n_=new WeakMap,Vg=new WeakMap,dy=new WeakMap;function mN(s){const e=new Promise((t,i)=>{const l=()=>{s.removeEventListener("success",c),s.removeEventListener("error",d)},c=()=>{t(ha(s.result)),l()},d=()=>{i(s.error),l()};s.addEventListener("success",c),s.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&t_.set(t,s)}).catch(()=>{}),dy.set(e,s),e}function gN(s){if(_p.has(s))return;const e=new Promise((t,i)=>{const l=()=>{s.removeEventListener("complete",c),s.removeEventListener("error",d),s.removeEventListener("abort",d)},c=()=>{t(),l()},d=()=>{i(s.error||new DOMException("AbortError","AbortError")),l()};s.addEventListener("complete",c),s.addEventListener("error",d),s.addEventListener("abort",d)});_p.set(s,e)}let kp={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return _p.get(s);if(e==="objectStoreNames")return s.objectStoreNames||n_.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ha(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function pN(s){kp=s(kp)}function yN(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=s.call(Ug(this),e,...t);return n_.set(i,e.sort?e.sort():[e]),ha(i)}:fN().includes(s)?function(...e){return s.apply(Ug(this),e),ha(t_.get(this))}:function(...e){return ha(s.apply(Ug(this),e))}}function vN(s){return typeof s=="function"?yN(s):(s instanceof IDBTransaction&&gN(s),dN(s,hN())?new Proxy(s,kp):s)}function ha(s){if(s instanceof IDBRequest)return mN(s);if(Vg.has(s))return Vg.get(s);const e=vN(s);return e!==s&&(Vg.set(s,e),dy.set(e,s)),e}const Ug=s=>dy.get(s);function lf(s,e,{blocked:t,upgrade:i,blocking:l,terminated:c}={}){const d=indexedDB.open(s,e),g=ha(d);return i&&d.addEventListener("upgradeneeded",y=>{i(ha(d.result),y.oldVersion,y.newVersion,ha(d.transaction),y)}),t&&d.addEventListener("blocked",y=>t(y.oldVersion,y.newVersion,y)),g.then(y=>{c&&y.addEventListener("close",()=>c()),l&&y.addEventListener("versionchange",p=>l(p.oldVersion,p.newVersion,p))}).catch(()=>{}),g}function Bg(s,{blocked:e}={}){const t=indexedDB.deleteDatabase(s);return e&&t.addEventListener("blocked",i=>e(i.oldVersion,i)),ha(t).then(()=>{})}const bN=["get","getKey","getAll","getAllKeys","count"],wN=["put","add","delete","clear"],zg=new Map;function y2(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(zg.get(e))return zg.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,l=wN.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(l||bN.includes(t)))return;const c=async function(d,...g){const y=this.transaction(d,l?"readwrite":"readonly");let p=y.store;return i&&(p=p.index(g.shift())),(await Promise.all([p[t](...g),l&&y.done]))[0]};return zg.set(e,c),c}pN(s=>({...s,get:(e,t,i)=>y2(e,t)||s.get(e,t,i),has:(e,t)=>!!y2(e,t)||s.has(e,t)}));class xN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(_N(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function _N(s){return s.getComponent()?.type==="VERSION"}const jp="@firebase/app",v2="0.14.7";const ya=new uy("@firebase/app"),kN="@firebase/app-compat",jN="@firebase/analytics-compat",EN="@firebase/analytics",TN="@firebase/app-check-compat",SN="@firebase/app-check",CN="@firebase/auth",NN="@firebase/auth-compat",AN="@firebase/database",RN="@firebase/data-connect",IN="@firebase/database-compat",MN="@firebase/functions",DN="@firebase/functions-compat",LN="@firebase/installations",PN="@firebase/installations-compat",ON="@firebase/messaging",VN="@firebase/messaging-compat",UN="@firebase/performance",BN="@firebase/performance-compat",zN="@firebase/remote-config",FN="@firebase/remote-config-compat",HN="@firebase/storage",qN="@firebase/storage-compat",$N="@firebase/firestore",WN="@firebase/ai",GN="@firebase/firestore-compat",KN="firebase",YN="12.8.0";const Ep="[DEFAULT]",QN={[jp]:"fire-core",[kN]:"fire-core-compat",[EN]:"fire-analytics",[jN]:"fire-analytics-compat",[SN]:"fire-app-check",[TN]:"fire-app-check-compat",[CN]:"fire-auth",[NN]:"fire-auth-compat",[AN]:"fire-rtdb",[RN]:"fire-data-connect",[IN]:"fire-rtdb-compat",[MN]:"fire-fn",[DN]:"fire-fn-compat",[LN]:"fire-iid",[PN]:"fire-iid-compat",[ON]:"fire-fcm",[VN]:"fire-fcm-compat",[UN]:"fire-perf",[BN]:"fire-perf-compat",[zN]:"fire-rc",[FN]:"fire-rc-compat",[HN]:"fire-gcs",[qN]:"fire-gcs-compat",[$N]:"fire-fst",[GN]:"fire-fst-compat",[WN]:"fire-vertex","fire-js":"fire-js",[KN]:"fire-js-all"};const Oh=new Map,XN=new Map,Tp=new Map;function b2(s,e){try{s.container.addComponent(e)}catch(t){ya.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function yi(s){const e=s.name;if(Tp.has(e))return ya.debug(`There were multiple attempts to register component ${e}.`),!1;Tp.set(e,s);for(const t of Oh.values())b2(t,s);for(const t of XN.values())b2(t,s);return!0}function Qo(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function br(s){return s==null?!1:s.settings!==void 0}const JN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},no=new Yo("app","Firebase",JN);class ZN{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ei("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw no.create("app-deleted",{appName:this._name})}}const Xo=YN;function hy(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const i={name:Ep,automaticDataCollectionEnabled:!0,...e},l=i.name;if(typeof l!="string"||!l)throw no.create("bad-app-name",{appName:String(l)});if(t||(t=Qx()),!t)throw no.create("no-options");const c=Oh.get(l);if(c){if(pa(t,c.options)&&pa(i,c.config))return c;throw no.create("duplicate-app",{appName:l})}const d=new aN(l);for(const y of Tp.values())d.addComponent(y);const g=new ZN(t,i,d);return Oh.set(l,g),g}function Ou(s=Ep){const e=Oh.get(s);if(!e&&s===Ep&&Qx())return hy();if(!e)throw no.create("no-app",{appName:s});return e}function xr(s,e,t){let i=QN[s]??s;t&&(i+=`-${t}`);const l=i.match(/\s|\//),c=e.match(/\s|\//);if(l||c){const d=[`Unable to register library "${i}" with version "${e}":`];l&&d.push(`library name "${i}" contains illegal characters (whitespace or "/")`),l&&c&&d.push("and"),c&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ya.warn(d.join(" "));return}yi(new ei(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const eA="firebase-heartbeat-database",tA=1,_u="firebase-heartbeat-store";let Fg=null;function s_(){return Fg||(Fg=lf(eA,tA,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(_u)}catch(t){console.warn(t)}}}}).catch(s=>{throw no.create("idb-open",{originalErrorMessage:s.message})})),Fg}async function nA(s){try{const t=(await s_()).transaction(_u),i=await t.objectStore(_u).get(r_(s));return await t.done,i}catch(e){if(e instanceof wi)ya.warn(e.message);else{const t=no.create("idb-get",{originalErrorMessage:e?.message});ya.warn(t.message)}}}async function w2(s,e){try{const i=(await s_()).transaction(_u,"readwrite");await i.objectStore(_u).put(e,r_(s)),await i.done}catch(t){if(t instanceof wi)ya.warn(t.message);else{const i=no.create("idb-set",{originalErrorMessage:t?.message});ya.warn(i.message)}}}function r_(s){return`${s.name}!${s.options.appId}`}const sA=1024,rA=30;class iA{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new oA(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=x2();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(l=>l.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>rA){const l=lA(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){ya.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=x2(),{heartbeatsToSend:t,unsentEntries:i}=aA(this._heartbeatsCache.heartbeats),l=Ph(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(e){return ya.warn(e),""}}}function x2(){return new Date().toISOString().substring(0,10)}function aA(s,e=sA){const t=[];let i=s.slice();for(const l of s){const c=t.find(d=>d.agent===l.agent);if(c){if(c.dates.push(l.date),_2(t)>e){c.dates.pop();break}}else if(t.push({agent:l.agent,dates:[l.date]}),_2(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class oA{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Zx()?e_().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await nA(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return w2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return w2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function _2(s){return Ph(JSON.stringify({version:2,heartbeats:s})).length}function lA(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let i=1;i<s.length;i++)s[i].date<t&&(t=s[i].date,e=i);return e}function cA(s){yi(new ei("platform-logger",e=>new xN(e),"PRIVATE")),yi(new ei("heartbeat",e=>new iA(e),"PRIVATE")),xr(jp,v2,s),xr(jp,v2,"esm2020"),xr("fire-js","")}cA("");function i_(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const uA=i_,a_=new Yo("auth","Firebase",i_());const Vh=new uy("@firebase/auth");function dA(s,...e){Vh.logLevel<=en.WARN&&Vh.warn(`Auth (${Xo}): ${s}`,...e)}function Eh(s,...e){Vh.logLevel<=en.ERROR&&Vh.error(`Auth (${Xo}): ${s}`,...e)}function ti(s,...e){throw my(s,...e)}function gi(s,...e){return my(s,...e)}function fy(s,e,t){const i={...uA(),[e]:t};return new Yo("auth","Firebase",i).create(e,{appName:s.name})}function fa(s){return fy(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function hA(s,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&ti(s,"argument-error"),fy(s,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function my(s,...e){if(typeof s!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=s.name),s._errorFactory.create(t,...i)}return a_.create(s,...e)}function xt(s,e,...t){if(!s)throw my(e,...t)}function oa(s){const e="INTERNAL ASSERTION FAILED: "+s;throw Eh(e),new Error(e)}function va(s,e){s||oa(e)}function Sp(){return typeof self<"u"&&self.location?.href||""}function fA(){return k2()==="http:"||k2()==="https:"}function k2(){return typeof self<"u"&&self.location?.protocol||null}function mA(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(fA()||$C()||"connection"in navigator)?navigator.onLine:!0}function gA(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}class Vu{constructor(e,t){this.shortDelay=e,this.longDelay=t,va(t>e,"Short delay should be less than long delay!"),this.isMobile=FC()||WC()}get(){return mA()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function gy(s,e){va(s.emulator,"Emulator should always be set here");const{url:t}=s.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class o_{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;oa("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;oa("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;oa("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const pA={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const yA=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],vA=new Vu(3e4,6e4);function _a(s,e){return s.tenantId&&!e.tenantId?{...e,tenantId:s.tenantId}:e}async function ka(s,e,t,i,l={}){return l_(s,l,async()=>{let c={},d={};i&&(e==="GET"?d=i:c={body:JSON.stringify(i)});const g=Pu({key:s.config.apiKey,...d}).slice(1),y=await s._getAdditionalHeaders();y["Content-Type"]="application/json",s.languageCode&&(y["X-Firebase-Locale"]=s.languageCode);const p={method:e,headers:y,...c};return qC()||(p.referrerPolicy="no-referrer"),s.emulatorConfig&&fo(s.emulatorConfig.host)&&(p.credentials="include"),o_.fetch()(await c_(s,s.config.apiHost,t,g),p)})}async function l_(s,e,t){s._canInitEmulator=!1;const i={...pA,...e};try{const l=new wA(s),c=await Promise.race([t(),l.promise]);l.clearNetworkTimeout();const d=await c.json();if("needConfirmation"in d)throw ch(s,"account-exists-with-different-credential",d);if(c.ok&&!("errorMessage"in d))return d;{const g=c.ok?d.errorMessage:d.error.message,[y,p]=g.split(" : ");if(y==="FEDERATED_USER_ID_ALREADY_LINKED")throw ch(s,"credential-already-in-use",d);if(y==="EMAIL_EXISTS")throw ch(s,"email-already-in-use",d);if(y==="USER_DISABLED")throw ch(s,"user-disabled",d);const b=i[y]||y.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw fy(s,b,p);ti(s,b)}}catch(l){if(l instanceof wi)throw l;ti(s,"network-request-failed",{message:String(l)})}}async function Uu(s,e,t,i,l={}){const c=await ka(s,e,t,i,l);return"mfaPendingCredential"in c&&ti(s,"multi-factor-auth-required",{_serverResponse:c}),c}async function c_(s,e,t,i){const l=`${e}${t}?${i}`,c=s,d=c.config.emulator?gy(s.config,l):`${s.config.apiScheme}://${l}`;return yA.includes(t)&&(await c._persistenceManagerAvailable,c._getPersistenceType()==="COOKIE")?c._getPersistence()._getFinalTarget(d).toString():d}function bA(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class wA{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(gi(this.auth,"network-request-failed")),vA.get())})}}function ch(s,e,t){const i={appName:s.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const l=gi(s,e,i);return l.customData._tokenResponse=t,l}function j2(s){return s!==void 0&&s.enterprise!==void 0}class xA{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return bA(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function _A(s,e){return ka(s,"GET","/v2/recaptchaConfig",_a(s,e))}async function kA(s,e){return ka(s,"POST","/v1/accounts:delete",e)}async function Uh(s,e){return ka(s,"POST","/v1/accounts:lookup",e)}function fu(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function jA(s,e=!1){const t=jn(s),i=await t.getIdToken(e),l=py(i);xt(l&&l.exp&&l.auth_time&&l.iat,t.auth,"internal-error");const c=typeof l.firebase=="object"?l.firebase:void 0,d=c?.sign_in_provider;return{claims:l,token:i,authTime:fu(Hg(l.auth_time)),issuedAtTime:fu(Hg(l.iat)),expirationTime:fu(Hg(l.exp)),signInProvider:d||null,signInSecondFactor:c?.sign_in_second_factor||null}}function Hg(s){return Number(s)*1e3}function py(s){const[e,t,i]=s.split(".");if(e===void 0||t===void 0||i===void 0)return Eh("JWT malformed, contained fewer than 3 sections"),null;try{const l=Gx(t);return l?JSON.parse(l):(Eh("Failed to decode base64 JWT payload"),null)}catch(l){return Eh("Caught error parsing JWT payload as JSON",l?.toString()),null}}function E2(s){const e=py(s);return xt(e,"internal-error"),xt(typeof e.exp<"u","internal-error"),xt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function ku(s,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof wi&&EA(i)&&s.auth.currentUser===s&&await s.auth.signOut(),i}}function EA({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}class TA{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Cp{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=fu(this.lastLoginAt),this.creationTime=fu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Bh(s){const e=s.auth,t=await s.getIdToken(),i=await ku(s,Uh(e,{idToken:t}));xt(i?.users.length,e,"internal-error");const l=i.users[0];s._notifyReloadListener(l);const c=l.providerUserInfo?.length?u_(l.providerUserInfo):[],d=CA(s.providerData,c),g=s.isAnonymous,y=!(s.email&&l.passwordHash)&&!d?.length,p=g?y:!1,b={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:d,metadata:new Cp(l.createdAt,l.lastLoginAt),isAnonymous:p};Object.assign(s,b)}async function SA(s){const e=jn(s);await Bh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function CA(s,e){return[...s.filter(i=>!e.some(l=>l.providerId===i.providerId)),...e]}function u_(s){return s.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function NA(s,e){const t=await l_(s,{},async()=>{const i=Pu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:l,apiKey:c}=s.config,d=await c_(s,l,"/v1/token",`key=${c}`),g=await s._getAdditionalHeaders();g["Content-Type"]="application/x-www-form-urlencoded";const y={method:"POST",headers:g,body:i};return s.emulatorConfig&&fo(s.emulatorConfig.host)&&(y.credentials="include"),o_.fetch()(d,y)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function AA(s,e){return ka(s,"POST","/v2/accounts:revokeToken",_a(s,e))}class zl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){xt(e.idToken,"internal-error"),xt(typeof e.idToken<"u","internal-error"),xt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):E2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){xt(e.length!==0,"internal-error");const t=E2(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(xt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:l,expiresIn:c}=await NA(e,t);this.updateTokensAndExpiration(i,l,Number(c))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:l,expirationTime:c}=t,d=new zl;return i&&(xt(typeof i=="string","internal-error",{appName:e}),d.refreshToken=i),l&&(xt(typeof l=="string","internal-error",{appName:e}),d.accessToken=l),c&&(xt(typeof c=="number","internal-error",{appName:e}),d.expirationTime=c),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new zl,this.toJSON())}_performRefresh(){return oa("not implemented")}}function Ya(s,e){xt(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class fi{constructor({uid:e,auth:t,stsTokenManager:i,...l}){this.providerId="firebase",this.proactiveRefresh=new TA(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new Cp(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await ku(this,this.stsTokenManager.getToken(this.auth,e));return xt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return jA(this,e)}reload(){return SA(this)}_assign(e){this!==e&&(xt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new fi({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){xt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Bh(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(br(this.auth.app))return Promise.reject(fa(this.auth));const e=await this.getIdToken();return await ku(this,kA(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,l=t.email??void 0,c=t.phoneNumber??void 0,d=t.photoURL??void 0,g=t.tenantId??void 0,y=t._redirectEventId??void 0,p=t.createdAt??void 0,b=t.lastLoginAt??void 0,{uid:_,emailVerified:j,isAnonymous:I,providerData:F,stsTokenManager:G}=t;xt(_&&G,e,"internal-error");const B=zl.fromJSON(this.name,G);xt(typeof _=="string",e,"internal-error"),Ya(i,e.name),Ya(l,e.name),xt(typeof j=="boolean",e,"internal-error"),xt(typeof I=="boolean",e,"internal-error"),Ya(c,e.name),Ya(d,e.name),Ya(g,e.name),Ya(y,e.name),Ya(p,e.name),Ya(b,e.name);const Y=new fi({uid:_,auth:e,email:l,emailVerified:j,displayName:i,isAnonymous:I,photoURL:d,phoneNumber:c,tenantId:g,stsTokenManager:B,createdAt:p,lastLoginAt:b});return F&&Array.isArray(F)&&(Y.providerData=F.map(ee=>({...ee}))),y&&(Y._redirectEventId=y),Y}static async _fromIdTokenResponse(e,t,i=!1){const l=new zl;l.updateFromServerResponse(t);const c=new fi({uid:t.localId,auth:e,stsTokenManager:l,isAnonymous:i});return await Bh(c),c}static async _fromGetAccountInfoResponse(e,t,i){const l=t.users[0];xt(l.localId!==void 0,"internal-error");const c=l.providerUserInfo!==void 0?u_(l.providerUserInfo):[],d=!(l.email&&l.passwordHash)&&!c?.length,g=new zl;g.updateFromIdToken(i);const y=new fi({uid:l.localId,auth:e,stsTokenManager:g,isAnonymous:d}),p={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:c,metadata:new Cp(l.createdAt,l.lastLoginAt),isAnonymous:!(l.email&&l.passwordHash)&&!c?.length};return Object.assign(y,p),y}}const T2=new Map;function la(s){va(s instanceof Function,"Expected a class definition");let e=T2.get(s);return e?(va(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,T2.set(s,e),e)}class d_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}d_.type="NONE";const S2=d_;function Th(s,e,t){return`firebase:${s}:${e}:${t}`}class Fl{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:l,name:c}=this.auth;this.fullUserKey=Th(this.userKey,l.apiKey,c),this.fullPersistenceKey=Th("persistence",l.apiKey,c),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Uh(this.auth,{idToken:e}).catch(()=>{});return t?fi._fromGetAccountInfoResponse(this.auth,t,e):null}return fi._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Fl(la(S2),e,i);const l=(await Promise.all(t.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let c=l[0]||la(S2);const d=Th(i,e.config.apiKey,e.name);let g=null;for(const p of t)try{const b=await p._get(d);if(b){let _;if(typeof b=="string"){const j=await Uh(e,{idToken:b}).catch(()=>{});if(!j)break;_=await fi._fromGetAccountInfoResponse(e,j,b)}else _=fi._fromJSON(e,b);p!==c&&(g=_),c=p;break}}catch{}const y=l.filter(p=>p._shouldAllowMigration);return!c._shouldAllowMigration||!y.length?new Fl(c,e,i):(c=y[0],g&&await c._set(d,g.toJSON()),await Promise.all(t.map(async p=>{if(p!==c)try{await p._remove(d)}catch{}})),new Fl(c,e,i))}}function C2(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(g_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(h_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(y_(e))return"Blackberry";if(v_(e))return"Webos";if(f_(e))return"Safari";if((e.includes("chrome/")||m_(e))&&!e.includes("edge/"))return"Chrome";if(p_(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=s.match(t);if(i?.length===2)return i[1]}return"Other"}function h_(s=Zs()){return/firefox\//i.test(s)}function f_(s=Zs()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function m_(s=Zs()){return/crios\//i.test(s)}function g_(s=Zs()){return/iemobile/i.test(s)}function p_(s=Zs()){return/android/i.test(s)}function y_(s=Zs()){return/blackberry/i.test(s)}function v_(s=Zs()){return/webos/i.test(s)}function yy(s=Zs()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function RA(s=Zs()){return yy(s)&&!!window.navigator?.standalone}function IA(){return GC()&&document.documentMode===10}function b_(s=Zs()){return yy(s)||p_(s)||v_(s)||y_(s)||/windows phone/i.test(s)||g_(s)}function w_(s,e=[]){let t;switch(s){case"Browser":t=C2(Zs());break;case"Worker":t=`${C2(Zs())}-${s}`;break;default:t=s}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Xo}/${i}`}class MA{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=c=>new Promise((d,g)=>{try{const y=e(c);d(y)}catch(y){g(y)}});i.onAbort=t,this.queue.push(i);const l=this.queue.length-1;return()=>{this.queue[l]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const l of t)try{l()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function DA(s,e={}){return ka(s,"GET","/v2/passwordPolicy",_a(s,e))}const LA=6;class PA{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??LA,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,l=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),l&&(t.meetsMaxPasswordLength=e.length<=l)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let l=0;l<e.length;l++)i=e.charAt(l),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,l,c){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=l)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=c))}}class OA{constructor(e,t,i,l){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=l,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new N2(this),this.idTokenSubscription=new N2(this),this.beforeStateQueue=new MA(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=a_,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=l.sdkClientVersion,this._persistenceManagerAvailable=new Promise(c=>this._resolvePersistenceManagerAvailable=c)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=la(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Fl.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Uh(this,{idToken:e}),i=await fi._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(br(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=this.redirectUser?._redirectEventId,d=i?._redirectEventId,g=await this.tryRedirectSignIn(e);(!c||c===d)&&g?.user&&(i=g.user,l=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(i)}catch(c){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return xt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Bh(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=gA()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(br(this.app))return Promise.reject(fa(this));const t=e?jn(e):null;return t&&xt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&xt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return br(this.app)?Promise.reject(fa(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return br(this.app)?Promise.reject(fa(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(la(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await DA(this),t=new PA(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Yo("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await AA(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&la(e)||this._popupRedirectResolver;xt(t,this,"argument-error"),this.redirectPersistenceManager=await Fl.create(this,[la(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,l){if(this._deleted)return()=>{};const c=typeof t=="function"?t:t.next.bind(t);let d=!1;const g=this._isInitialized?Promise.resolve():this._initializationPromise;if(xt(g,this,"internal-error"),g.then(()=>{d||c(this.currentUser)}),typeof t=="function"){const y=e.addObserver(t,i,l);return()=>{d=!0,y()}}else{const y=e.addObserver(t);return()=>{d=!0,y()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return xt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=w_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(br(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&dA(`Error while retrieving App Check token: ${e.error}`),e?.token}}function ja(s){return jn(s)}class N2{constructor(e){this.auth=e,this.observer=null,this.addObserver=eN(t=>this.observer=t)}get next(){return xt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let cf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function VA(s){cf=s}function x_(s){return cf.loadJS(s)}function UA(){return cf.recaptchaEnterpriseScript}function BA(){return cf.gapiScript}function zA(s){return`__${s}${Math.floor(Math.random()*1e6)}`}class FA{constructor(){this.enterprise=new HA}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class HA{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const qA="recaptcha-enterprise",__="NO_RECAPTCHA";class $A{constructor(e){this.type=qA,this.auth=ja(e)}async verify(e="verify",t=!1){async function i(c){if(!t){if(c.tenantId==null&&c._agentRecaptchaConfig!=null)return c._agentRecaptchaConfig.siteKey;if(c.tenantId!=null&&c._tenantRecaptchaConfigs[c.tenantId]!==void 0)return c._tenantRecaptchaConfigs[c.tenantId].siteKey}return new Promise(async(d,g)=>{_A(c,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(y=>{if(y.recaptchaKey===void 0)g(new Error("recaptcha Enterprise site key undefined"));else{const p=new xA(y);return c.tenantId==null?c._agentRecaptchaConfig=p:c._tenantRecaptchaConfigs[c.tenantId]=p,d(p.siteKey)}}).catch(y=>{g(y)})})}function l(c,d,g){const y=window.grecaptcha;j2(y)?y.enterprise.ready(()=>{y.enterprise.execute(c,{action:e}).then(p=>{d(p)}).catch(()=>{d(__)})}):g(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new FA().execute("siteKey",{action:"verify"}):new Promise((c,d)=>{i(this.auth).then(g=>{if(!t&&j2(window.grecaptcha))l(g,c,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let y=UA();y.length!==0&&(y+=g),x_(y).then(()=>{l(g,c,d)}).catch(p=>{d(p)})}}).catch(g=>{d(g)})})}}async function A2(s,e,t,i=!1,l=!1){const c=new $A(s);let d;if(l)d=__;else try{d=await c.verify(t)}catch{d=await c.verify(t,!0)}const g={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in g){const y=g.phoneEnrollmentInfo.phoneNumber,p=g.phoneEnrollmentInfo.recaptchaToken;Object.assign(g,{phoneEnrollmentInfo:{phoneNumber:y,recaptchaToken:p,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in g){const y=g.phoneSignInInfo.recaptchaToken;Object.assign(g,{phoneSignInInfo:{recaptchaToken:y,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return g}return i?Object.assign(g,{captchaResp:d}):Object.assign(g,{captchaResponse:d}),Object.assign(g,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(g,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),g}async function zh(s,e,t,i,l){if(s._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const c=await A2(s,e,t,t==="getOobCode");return i(s,c)}else return i(s,e).catch(async c=>{if(c.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await A2(s,e,t,t==="getOobCode");return i(s,d)}else return Promise.reject(c)})}function WA(s,e){const t=Qo(s,"auth");if(t.isInitialized()){const l=t.getImmediate(),c=t.getOptions();if(pa(c,e??{}))return l;ti(l,"already-initialized")}return t.initialize({options:e})}function GA(s,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(la);e?.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(i,e?.popupRedirectResolver)}function KA(s,e,t){const i=ja(s);xt(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const l=!1,c=k_(e),{host:d,port:g}=YA(e),y=g===null?"":`:${g}`,p={url:`${c}//${d}${y}/`},b=Object.freeze({host:d,port:g,protocol:c.replace(":",""),options:Object.freeze({disableWarnings:l})});if(!i._canInitEmulator){xt(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),xt(pa(p,i.config.emulator)&&pa(b,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=p,i.emulatorConfig=b,i.settings.appVerificationDisabledForTesting=!0,fo(d)?(ly(`${c}//${d}${y}`),cy("Auth",!0)):QA()}function k_(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function YA(s){const e=k_(s),t=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",l=/^(\[[^\]]+\])(:|$)/.exec(i);if(l){const c=l[1];return{host:c,port:R2(i.substr(c.length+1))}}else{const[c,d]=i.split(":");return{host:c,port:R2(d)}}}function R2(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function QA(){function s(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}class vy{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return oa("not implemented")}_getIdTokenResponse(e){return oa("not implemented")}_linkToIdToken(e,t){return oa("not implemented")}_getReauthenticationResolver(e){return oa("not implemented")}}async function XA(s,e){return ka(s,"POST","/v1/accounts:signUp",e)}async function JA(s,e){return Uu(s,"POST","/v1/accounts:signInWithPassword",_a(s,e))}async function j_(s,e){return ka(s,"POST","/v1/accounts:sendOobCode",_a(s,e))}async function ZA(s,e){return j_(s,e)}async function e4(s,e){return j_(s,e)}async function t4(s,e){return Uu(s,"POST","/v1/accounts:signInWithEmailLink",_a(s,e))}async function n4(s,e){return Uu(s,"POST","/v1/accounts:signInWithEmailLink",_a(s,e))}class ju extends vy{constructor(e,t,i,l=null){super("password",i),this._email=e,this._password=t,this._tenantId=l}static _fromEmailAndPassword(e,t){return new ju(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new ju(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return zh(e,t,"signInWithPassword",JA);case"emailLink":return t4(e,{email:this._email,oobCode:this._password});default:ti(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return zh(e,i,"signUpPassword",XA);case"emailLink":return n4(e,{idToken:t,email:this._email,oobCode:this._password});default:ti(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Hl(s,e){return Uu(s,"POST","/v1/accounts:signInWithIdp",_a(s,e))}const s4="http://localhost";class ba extends vy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new ba(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ti("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:l,...c}=t;if(!i||!l)return null;const d=new ba(i,l);return d.idToken=c.idToken||void 0,d.accessToken=c.accessToken||void 0,d.secret=c.secret,d.nonce=c.nonce,d.pendingToken=c.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Hl(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Hl(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Hl(e,t)}buildRequest(){const e={requestUri:s4,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Pu(t)}return e}}function r4(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function i4(s){const e=iu(au(s)).link,t=e?iu(au(e)).deep_link_id:null,i=iu(au(s)).deep_link_id;return(i?iu(au(i)).link:null)||i||t||e||s}class by{constructor(e){const t=iu(au(e)),i=t.apiKey??null,l=t.oobCode??null,c=r4(t.mode??null);xt(i&&l&&c,"argument-error"),this.apiKey=i,this.operation=c,this.code=l,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=i4(e);try{return new by(t)}catch{return null}}}class ic{constructor(){this.providerId=ic.PROVIDER_ID}static credential(e,t){return ju._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=by.parseLink(t);return xt(i,"argument-error"),ju._fromEmailAndCode(e,i.code,i.tenantId)}}ic.PROVIDER_ID="password";ic.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ic.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class wy{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class ac extends wy{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class mu extends ac{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return xt("providerId"in t&&"signInMethod"in t,"argument-error"),ba._fromParams(t)}credential(e){return this._credential({...e,nonce:e.rawNonce})}_credential(e){return xt(e.idToken||e.accessToken,"argument-error"),ba._fromParams({...e,providerId:this.providerId,signInMethod:this.providerId})}static credentialFromResult(e){return mu.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return mu.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i,oauthTokenSecret:l,pendingToken:c,nonce:d,providerId:g}=e;if(!i&&!l&&!t&&!c||!g)return null;try{return new mu(g)._credential({idToken:t,accessToken:i,nonce:d,pendingToken:c})}catch{return null}}}class Xa extends ac{constructor(){super("facebook.com")}static credential(e){return ba._fromParams({providerId:Xa.PROVIDER_ID,signInMethod:Xa.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Xa.credentialFromTaggedObject(e)}static credentialFromError(e){return Xa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Xa.credential(e.oauthAccessToken)}catch{return null}}}Xa.FACEBOOK_SIGN_IN_METHOD="facebook.com";Xa.PROVIDER_ID="facebook.com";class aa extends ac{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return ba._fromParams({providerId:aa.PROVIDER_ID,signInMethod:aa.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return aa.credentialFromTaggedObject(e)}static credentialFromError(e){return aa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return aa.credential(t,i)}catch{return null}}}aa.GOOGLE_SIGN_IN_METHOD="google.com";aa.PROVIDER_ID="google.com";class Ja extends ac{constructor(){super("github.com")}static credential(e){return ba._fromParams({providerId:Ja.PROVIDER_ID,signInMethod:Ja.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ja.credentialFromTaggedObject(e)}static credentialFromError(e){return Ja.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ja.credential(e.oauthAccessToken)}catch{return null}}}Ja.GITHUB_SIGN_IN_METHOD="github.com";Ja.PROVIDER_ID="github.com";class Za extends ac{constructor(){super("twitter.com")}static credential(e,t){return ba._fromParams({providerId:Za.PROVIDER_ID,signInMethod:Za.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Za.credentialFromTaggedObject(e)}static credentialFromError(e){return Za.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Za.credential(t,i)}catch{return null}}}Za.TWITTER_SIGN_IN_METHOD="twitter.com";Za.PROVIDER_ID="twitter.com";async function a4(s,e){return Uu(s,"POST","/v1/accounts:signUp",_a(s,e))}class Fo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,l=!1){const c=await fi._fromIdTokenResponse(e,i,l),d=I2(i);return new Fo({user:c,providerId:d,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const l=I2(i);return new Fo({user:e,providerId:l,_tokenResponse:i,operationType:t})}}function I2(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}class Fh extends wi{constructor(e,t,i,l){super(t.code,t.message),this.operationType=i,this.user=l,Object.setPrototypeOf(this,Fh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,l){return new Fh(e,t,i,l)}}function E_(s,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(s):t._getIdTokenResponse(s)).catch(c=>{throw c.code==="auth/multi-factor-auth-required"?Fh._fromErrorAndOperation(s,c,e,i):c})}async function o4(s,e,t=!1){const i=await ku(s,e._linkToIdToken(s.auth,await s.getIdToken()),t);return Fo._forOperation(s,"link",i)}async function l4(s,e,t=!1){const{auth:i}=s;if(br(i.app))return Promise.reject(fa(i));const l="reauthenticate";try{const c=await ku(s,E_(i,l,e,s),t);xt(c.idToken,i,"internal-error");const d=py(c.idToken);xt(d,i,"internal-error");const{sub:g}=d;return xt(s.uid===g,i,"user-mismatch"),Fo._forOperation(s,l,c)}catch(c){throw c?.code==="auth/user-not-found"&&ti(i,"user-mismatch"),c}}async function T_(s,e,t=!1){if(br(s.app))return Promise.reject(fa(s));const i="signIn",l=await E_(s,i,e),c=await Fo._fromIdTokenResponse(s,i,l);return t||await s._updateCurrentUser(c.user),c}async function c4(s,e){return T_(ja(s),e)}async function S_(s){const e=ja(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function u4(s,e,t){const i=ja(s);await zh(i,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",e4)}async function d4(s,e,t){if(br(s.app))return Promise.reject(fa(s));const i=ja(s),d=await zh(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",a4).catch(y=>{throw y.code==="auth/password-does-not-meet-requirements"&&S_(s),y}),g=await Fo._fromIdTokenResponse(i,"signIn",d);return await i._updateCurrentUser(g.user),g}function h4(s,e,t){return br(s.app)?Promise.reject(fa(s)):c4(jn(s),ic.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&S_(s),i})}async function sO(s,e){const t=jn(s),l={requestType:"VERIFY_EMAIL",idToken:await s.getIdToken()},{email:c}=await ZA(t.auth,l);c!==s.email&&await s.reload()}function uh(s,e){return jn(s).setPersistence(e)}function f4(s,e,t,i){return jn(s).onIdTokenChanged(e,t,i)}function m4(s,e,t){return jn(s).beforeAuthStateChanged(e,t)}function g4(s,e,t,i){return jn(s).onAuthStateChanged(e,t,i)}function p4(s){return jn(s).signOut()}const Hh="__sak";class C_{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Hh,"1"),this.storage.removeItem(Hh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const y4=1e3,v4=10;class N_ extends C_{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=b_(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),l=this.localCache[t];i!==l&&e(t,l,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,g,y)=>{this.notifyListeners(d,y)});return}const i=e.key;t?this.detachListener():this.stopPolling();const l=()=>{const d=this.storage.getItem(i);!t&&this.localCache[i]===d||this.notifyListeners(i,d)},c=this.storage.getItem(i);IA()&&c!==e.newValue&&e.newValue!==e.oldValue?setTimeout(l,v4):l()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},y4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}N_.type="LOCAL";const ou=N_;class A_ extends C_{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}A_.type="SESSION";const xy=A_;function b4(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class uf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(l=>l.isListeningto(e));if(t)return t;const i=new uf(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:l,data:c}=t.data,d=this.handlersMap[l];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:l});const g=Array.from(d).map(async p=>p(t.origin,c)),y=await b4(g);t.ports[0].postMessage({status:"done",eventId:i,eventType:l,response:y})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}uf.receivers=[];function _y(s="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return s+t}class w4{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const l=typeof MessageChannel<"u"?new MessageChannel:null;if(!l)throw new Error("connection_unavailable");let c,d;return new Promise((g,y)=>{const p=_y("",20);l.port1.start();const b=setTimeout(()=>{y(new Error("unsupported_event"))},i);d={messageChannel:l,onMessage(_){const j=_;if(j.data.eventId===p)switch(j.data.status){case"ack":clearTimeout(b),c=setTimeout(()=>{y(new Error("timeout"))},3e3);break;case"done":clearTimeout(c),g(j.data.response);break;default:clearTimeout(b),clearTimeout(c),y(new Error("invalid_response"));break}}},this.handlers.add(d),l.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:p,data:t},[l.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}function Mi(){return window}function x4(s){Mi().location.href=s}function R_(){return typeof Mi().WorkerGlobalScope<"u"&&typeof Mi().importScripts=="function"}async function _4(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function k4(){return navigator?.serviceWorker?.controller||null}function j4(){return R_()?self:null}const I_="firebaseLocalStorageDb",E4=1,qh="firebaseLocalStorage",M_="fbase_key";class Bu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function df(s,e){return s.transaction([qh],e?"readwrite":"readonly").objectStore(qh)}function T4(){const s=indexedDB.deleteDatabase(I_);return new Bu(s).toPromise()}function Np(){const s=indexedDB.open(I_,E4);return new Promise((e,t)=>{s.addEventListener("error",()=>{t(s.error)}),s.addEventListener("upgradeneeded",()=>{const i=s.result;try{i.createObjectStore(qh,{keyPath:M_})}catch(l){t(l)}}),s.addEventListener("success",async()=>{const i=s.result;i.objectStoreNames.contains(qh)?e(i):(i.close(),await T4(),e(await Np()))})})}async function M2(s,e,t){const i=df(s,!0).put({[M_]:e,value:t});return new Bu(i).toPromise()}async function S4(s,e){const t=df(s,!1).get(e),i=await new Bu(t).toPromise();return i===void 0?null:i.value}function D2(s,e){const t=df(s,!0).delete(e);return new Bu(t).toPromise()}const C4=800,N4=3;class D_{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Np(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>N4)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return R_()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=uf._getInstance(j4()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await _4(),!this.activeServiceWorker)return;this.sender=new w4(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||k4()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Np();return await M2(e,Hh,"1"),await D2(e,Hh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>M2(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>S4(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>D2(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(l=>{const c=df(l,!1).getAll();return new Bu(c).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:l,value:c}of e)i.add(l),JSON.stringify(this.localCache[l])!==JSON.stringify(c)&&(this.notifyListeners(l,c),t.push(l));for(const l of Object.keys(this.localCache))this.localCache[l]&&!i.has(l)&&(this.notifyListeners(l,null),t.push(l));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),C4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}D_.type="LOCAL";const A4=D_;new Vu(3e4,6e4);function L_(s,e){return e?la(e):(xt(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}class ky extends vy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Hl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Hl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Hl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function R4(s){return T_(s.auth,new ky(s),s.bypassAuthState)}function I4(s){const{auth:e,user:t}=s;return xt(t,e,"internal-error"),l4(t,new ky(s),s.bypassAuthState)}async function M4(s){const{auth:e,user:t}=s;return xt(t,e,"internal-error"),o4(t,new ky(s),s.bypassAuthState)}class P_{constructor(e,t,i,l,c=!1){this.auth=e,this.resolver=i,this.user=l,this.bypassAuthState=c,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:l,tenantId:c,error:d,type:g}=e;if(d){this.reject(d);return}const y={auth:this.auth,requestUri:t,sessionId:i,tenantId:c||void 0,postBody:l||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(g)(y))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return R4;case"linkViaPopup":case"linkViaRedirect":return M4;case"reauthViaPopup":case"reauthViaRedirect":return I4;default:ti(this.auth,"internal-error")}}resolve(e){va(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){va(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const D4=new Vu(2e3,1e4);async function L2(s,e,t){if(br(s.app))return Promise.reject(gi(s,"operation-not-supported-in-this-environment"));const i=ja(s);hA(s,e,wy);const l=L_(i,t);return new Po(i,"signInViaPopup",e,l).executeNotNull()}class Po extends P_{constructor(e,t,i,l,c){super(e,t,l,c),this.provider=i,this.authWindow=null,this.pollId=null,Po.currentPopupAction&&Po.currentPopupAction.cancel(),Po.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return xt(e,this.auth,"internal-error"),e}async onExecution(){va(this.filter.length===1,"Popup operations only handle one event");const e=_y();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(gi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(gi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Po.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(gi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,D4.get())};e()}}Po.currentPopupAction=null;const L4="pendingRedirect",Sh=new Map;class P4 extends P_{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Sh.get(this.auth._key());if(!e){try{const i=await O4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Sh.set(this.auth._key(),e)}return this.bypassAuthState||Sh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function O4(s,e){const t=B4(e),i=U4(s);if(!await i._isAvailable())return!1;const l=await i._get(t)==="true";return await i._remove(t),l}function V4(s,e){Sh.set(s._key(),e)}function U4(s){return la(s._redirectPersistence)}function B4(s){return Th(L4,s.config.apiKey,s.name)}async function z4(s,e,t=!1){if(br(s.app))return Promise.reject(fa(s));const i=ja(s),l=L_(i,e),d=await new P4(i,l,t).execute();return d&&!t&&(delete d.user._redirectEventId,await i._persistUserIfCurrent(d.user),await i._setRedirectUser(null,e)),d}const F4=600*1e3;class H4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!q4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!O_(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(gi(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=F4&&this.cachedEventUids.clear(),this.cachedEventUids.has(P2(e))}saveEventToCache(e){this.cachedEventUids.add(P2(e)),this.lastProcessedEventTime=Date.now()}}function P2(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function O_({type:s,error:e}){return s==="unknown"&&e?.code==="auth/no-auth-event"}function q4(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return O_(s);default:return!1}}async function $4(s,e={}){return ka(s,"GET","/v1/projects",e)}const W4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,G4=/^https?/;async function K4(s){if(s.config.emulator)return;const{authorizedDomains:e}=await $4(s);for(const t of e)try{if(Y4(t))return}catch{}ti(s,"unauthorized-domain")}function Y4(s){const e=Sp(),{protocol:t,hostname:i}=new URL(e);if(s.startsWith("chrome-extension://")){const d=new URL(s);return d.hostname===""&&i===""?t==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===i}if(!G4.test(t))return!1;if(W4.test(s))return i===s;const l=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+l+"|"+l+")$","i").test(i)}const Q4=new Vu(3e4,6e4);function O2(){const s=Mi().___jsl;if(s?.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let t=0;t<s.CP.length;t++)s.CP[t]=null}}function X4(s){return new Promise((e,t)=>{function i(){O2(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{O2(),t(gi(s,"network-request-failed"))},timeout:Q4.get()})}if(Mi().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Mi().gapi?.load)i();else{const l=zA("iframefcb");return Mi()[l]=()=>{gapi.load?i():t(gi(s,"network-request-failed"))},x_(`${BA()}?onload=${l}`).catch(c=>t(c))}}).catch(e=>{throw Ch=null,e})}let Ch=null;function J4(s){return Ch=Ch||X4(s),Ch}const Z4=new Vu(5e3,15e3),eR="__/auth/iframe",tR="emulator/auth/iframe",nR={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},sR=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function rR(s){const e=s.config;xt(e.authDomain,s,"auth-domain-config-required");const t=e.emulator?gy(e,tR):`https://${s.config.authDomain}/${eR}`,i={apiKey:e.apiKey,appName:s.name,v:Xo},l=sR.get(s.config.apiHost);l&&(i.eid=l);const c=s._getFrameworks();return c.length&&(i.fw=c.join(",")),`${t}?${Pu(i).slice(1)}`}async function iR(s){const e=await J4(s),t=Mi().gapi;return xt(t,s,"internal-error"),e.open({where:document.body,url:rR(s),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:nR,dontclear:!0},i=>new Promise(async(l,c)=>{await i.restyle({setHideOnLeave:!1});const d=gi(s,"network-request-failed"),g=Mi().setTimeout(()=>{c(d)},Z4.get());function y(){Mi().clearTimeout(g),l(i)}i.ping(y).then(y,()=>{c(d)})}))}const aR={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},oR=500,lR=600,cR="_blank",uR="http://localhost";class V2{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function dR(s,e,t,i=oR,l=lR){const c=Math.max((window.screen.availHeight-l)/2,0).toString(),d=Math.max((window.screen.availWidth-i)/2,0).toString();let g="";const y={...aR,width:i.toString(),height:l.toString(),top:c,left:d},p=Zs().toLowerCase();t&&(g=m_(p)?cR:t),h_(p)&&(e=e||uR,y.scrollbars="yes");const b=Object.entries(y).reduce((j,[I,F])=>`${j}${I}=${F},`,"");if(RA(p)&&g!=="_self")return hR(e||"",g),new V2(null);const _=window.open(e||"",g,b);xt(_,s,"popup-blocked");try{_.focus()}catch{}return new V2(_)}function hR(s,e){const t=document.createElement("a");t.href=s,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const fR="__/auth/handler",mR="emulator/auth/handler",gR=encodeURIComponent("fac");async function U2(s,e,t,i,l,c){xt(s.config.authDomain,s,"auth-domain-config-required"),xt(s.config.apiKey,s,"invalid-api-key");const d={apiKey:s.config.apiKey,appName:s.name,authType:t,redirectUrl:i,v:Xo,eventId:l};if(e instanceof wy){e.setDefaultLanguage(s.languageCode),d.providerId=e.providerId||"",ZC(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[b,_]of Object.entries({}))d[b]=_}if(e instanceof ac){const b=e.getScopes().filter(_=>_!=="");b.length>0&&(d.scopes=b.join(","))}s.tenantId&&(d.tid=s.tenantId);const g=d;for(const b of Object.keys(g))g[b]===void 0&&delete g[b];const y=await s._getAppCheckToken(),p=y?`#${gR}=${encodeURIComponent(y)}`:"";return`${pR(s)}?${Pu(g).slice(1)}${p}`}function pR({config:s}){return s.emulator?gy(s,mR):`https://${s.authDomain}/${fR}`}const qg="webStorageSupport";class yR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=xy,this._completeRedirectFn=z4,this._overrideRedirectResult=V4}async _openPopup(e,t,i,l){va(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const c=await U2(e,t,i,Sp(),l);return dR(e,c,_y())}async _openRedirect(e,t,i,l){await this._originValidation(e);const c=await U2(e,t,i,Sp(),l);return x4(c),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:l,promise:c}=this.eventManagers[t];return l?Promise.resolve(l):(va(c,"If manager is not set, promise should be"),c)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await iR(e),i=new H4(e);return t.register("authEvent",l=>(xt(l?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(l.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(qg,{type:qg},l=>{const c=l?.[0]?.[qg];c!==void 0&&t(!!c),ti(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=K4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return b_()||f_()||yy()}}const vR=yR;var B2="@firebase/auth",z2="1.12.0";class bR{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){xt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function wR(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function xR(s){yi(new ei("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),l=e.getProvider("heartbeat"),c=e.getProvider("app-check-internal"),{apiKey:d,authDomain:g}=i.options;xt(d&&!d.includes(":"),"invalid-api-key",{appName:i.name});const y={apiKey:d,authDomain:g,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:w_(s)},p=new OA(i,l,c,y);return GA(p,t),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),yi(new ei("auth-internal",e=>{const t=ja(e.getProvider("auth").getImmediate());return(i=>new bR(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),xr(B2,z2,wR(s)),xr(B2,z2,"esm2020")}const _R=300,kR=Xx("authIdTokenMaxAge")||_R;let F2=null;const jR=s=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>kR)return;const l=t?.token;F2!==l&&(F2=l,await fetch(s,{method:l?"POST":"DELETE",headers:l?{Authorization:`Bearer ${l}`}:{}}))};function V_(s=Ou()){const e=Qo(s,"auth");if(e.isInitialized())return e.getImmediate();const t=WA(s,{popupRedirectResolver:vR,persistence:[A4,ou,xy]}),i=Xx("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const c=new URL(i,location.origin);if(location.origin===c.origin){const d=jR(c.toString());m4(t,d,()=>d(t.currentUser)),f4(t,g=>d(g))}}const l=Kx("auth");return l&&KA(t,`http://${l}`),t}function ER(){return document.getElementsByTagName("head")?.[0]??document}VA({loadJS(s){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",s),i.onload=e,i.onerror=l=>{const c=gi("internal-error");c.customData=l,t(c)},i.type="text/javascript",i.charset="UTF-8",ER().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});xR("Browser");var H2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var so,U_;(function(){var s;function e(L,E){function A(){}A.prototype=E.prototype,L.F=E.prototype,L.prototype=new A,L.prototype.constructor=L,L.D=function(V,M,P){for(var C=Array(arguments.length-2),Me=2;Me<arguments.length;Me++)C[Me-2]=arguments[Me];return E.prototype[M].apply(V,C)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function l(L,E,A){A||(A=0);const V=Array(16);if(typeof E=="string")for(var M=0;M<16;++M)V[M]=E.charCodeAt(A++)|E.charCodeAt(A++)<<8|E.charCodeAt(A++)<<16|E.charCodeAt(A++)<<24;else for(M=0;M<16;++M)V[M]=E[A++]|E[A++]<<8|E[A++]<<16|E[A++]<<24;E=L.g[0],A=L.g[1],M=L.g[2];let P=L.g[3],C;C=E+(P^A&(M^P))+V[0]+3614090360&4294967295,E=A+(C<<7&4294967295|C>>>25),C=P+(M^E&(A^M))+V[1]+3905402710&4294967295,P=E+(C<<12&4294967295|C>>>20),C=M+(A^P&(E^A))+V[2]+606105819&4294967295,M=P+(C<<17&4294967295|C>>>15),C=A+(E^M&(P^E))+V[3]+3250441966&4294967295,A=M+(C<<22&4294967295|C>>>10),C=E+(P^A&(M^P))+V[4]+4118548399&4294967295,E=A+(C<<7&4294967295|C>>>25),C=P+(M^E&(A^M))+V[5]+1200080426&4294967295,P=E+(C<<12&4294967295|C>>>20),C=M+(A^P&(E^A))+V[6]+2821735955&4294967295,M=P+(C<<17&4294967295|C>>>15),C=A+(E^M&(P^E))+V[7]+4249261313&4294967295,A=M+(C<<22&4294967295|C>>>10),C=E+(P^A&(M^P))+V[8]+1770035416&4294967295,E=A+(C<<7&4294967295|C>>>25),C=P+(M^E&(A^M))+V[9]+2336552879&4294967295,P=E+(C<<12&4294967295|C>>>20),C=M+(A^P&(E^A))+V[10]+4294925233&4294967295,M=P+(C<<17&4294967295|C>>>15),C=A+(E^M&(P^E))+V[11]+2304563134&4294967295,A=M+(C<<22&4294967295|C>>>10),C=E+(P^A&(M^P))+V[12]+1804603682&4294967295,E=A+(C<<7&4294967295|C>>>25),C=P+(M^E&(A^M))+V[13]+4254626195&4294967295,P=E+(C<<12&4294967295|C>>>20),C=M+(A^P&(E^A))+V[14]+2792965006&4294967295,M=P+(C<<17&4294967295|C>>>15),C=A+(E^M&(P^E))+V[15]+1236535329&4294967295,A=M+(C<<22&4294967295|C>>>10),C=E+(M^P&(A^M))+V[1]+4129170786&4294967295,E=A+(C<<5&4294967295|C>>>27),C=P+(A^M&(E^A))+V[6]+3225465664&4294967295,P=E+(C<<9&4294967295|C>>>23),C=M+(E^A&(P^E))+V[11]+643717713&4294967295,M=P+(C<<14&4294967295|C>>>18),C=A+(P^E&(M^P))+V[0]+3921069994&4294967295,A=M+(C<<20&4294967295|C>>>12),C=E+(M^P&(A^M))+V[5]+3593408605&4294967295,E=A+(C<<5&4294967295|C>>>27),C=P+(A^M&(E^A))+V[10]+38016083&4294967295,P=E+(C<<9&4294967295|C>>>23),C=M+(E^A&(P^E))+V[15]+3634488961&4294967295,M=P+(C<<14&4294967295|C>>>18),C=A+(P^E&(M^P))+V[4]+3889429448&4294967295,A=M+(C<<20&4294967295|C>>>12),C=E+(M^P&(A^M))+V[9]+568446438&4294967295,E=A+(C<<5&4294967295|C>>>27),C=P+(A^M&(E^A))+V[14]+3275163606&4294967295,P=E+(C<<9&4294967295|C>>>23),C=M+(E^A&(P^E))+V[3]+4107603335&4294967295,M=P+(C<<14&4294967295|C>>>18),C=A+(P^E&(M^P))+V[8]+1163531501&4294967295,A=M+(C<<20&4294967295|C>>>12),C=E+(M^P&(A^M))+V[13]+2850285829&4294967295,E=A+(C<<5&4294967295|C>>>27),C=P+(A^M&(E^A))+V[2]+4243563512&4294967295,P=E+(C<<9&4294967295|C>>>23),C=M+(E^A&(P^E))+V[7]+1735328473&4294967295,M=P+(C<<14&4294967295|C>>>18),C=A+(P^E&(M^P))+V[12]+2368359562&4294967295,A=M+(C<<20&4294967295|C>>>12),C=E+(A^M^P)+V[5]+4294588738&4294967295,E=A+(C<<4&4294967295|C>>>28),C=P+(E^A^M)+V[8]+2272392833&4294967295,P=E+(C<<11&4294967295|C>>>21),C=M+(P^E^A)+V[11]+1839030562&4294967295,M=P+(C<<16&4294967295|C>>>16),C=A+(M^P^E)+V[14]+4259657740&4294967295,A=M+(C<<23&4294967295|C>>>9),C=E+(A^M^P)+V[1]+2763975236&4294967295,E=A+(C<<4&4294967295|C>>>28),C=P+(E^A^M)+V[4]+1272893353&4294967295,P=E+(C<<11&4294967295|C>>>21),C=M+(P^E^A)+V[7]+4139469664&4294967295,M=P+(C<<16&4294967295|C>>>16),C=A+(M^P^E)+V[10]+3200236656&4294967295,A=M+(C<<23&4294967295|C>>>9),C=E+(A^M^P)+V[13]+681279174&4294967295,E=A+(C<<4&4294967295|C>>>28),C=P+(E^A^M)+V[0]+3936430074&4294967295,P=E+(C<<11&4294967295|C>>>21),C=M+(P^E^A)+V[3]+3572445317&4294967295,M=P+(C<<16&4294967295|C>>>16),C=A+(M^P^E)+V[6]+76029189&4294967295,A=M+(C<<23&4294967295|C>>>9),C=E+(A^M^P)+V[9]+3654602809&4294967295,E=A+(C<<4&4294967295|C>>>28),C=P+(E^A^M)+V[12]+3873151461&4294967295,P=E+(C<<11&4294967295|C>>>21),C=M+(P^E^A)+V[15]+530742520&4294967295,M=P+(C<<16&4294967295|C>>>16),C=A+(M^P^E)+V[2]+3299628645&4294967295,A=M+(C<<23&4294967295|C>>>9),C=E+(M^(A|~P))+V[0]+4096336452&4294967295,E=A+(C<<6&4294967295|C>>>26),C=P+(A^(E|~M))+V[7]+1126891415&4294967295,P=E+(C<<10&4294967295|C>>>22),C=M+(E^(P|~A))+V[14]+2878612391&4294967295,M=P+(C<<15&4294967295|C>>>17),C=A+(P^(M|~E))+V[5]+4237533241&4294967295,A=M+(C<<21&4294967295|C>>>11),C=E+(M^(A|~P))+V[12]+1700485571&4294967295,E=A+(C<<6&4294967295|C>>>26),C=P+(A^(E|~M))+V[3]+2399980690&4294967295,P=E+(C<<10&4294967295|C>>>22),C=M+(E^(P|~A))+V[10]+4293915773&4294967295,M=P+(C<<15&4294967295|C>>>17),C=A+(P^(M|~E))+V[1]+2240044497&4294967295,A=M+(C<<21&4294967295|C>>>11),C=E+(M^(A|~P))+V[8]+1873313359&4294967295,E=A+(C<<6&4294967295|C>>>26),C=P+(A^(E|~M))+V[15]+4264355552&4294967295,P=E+(C<<10&4294967295|C>>>22),C=M+(E^(P|~A))+V[6]+2734768916&4294967295,M=P+(C<<15&4294967295|C>>>17),C=A+(P^(M|~E))+V[13]+1309151649&4294967295,A=M+(C<<21&4294967295|C>>>11),C=E+(M^(A|~P))+V[4]+4149444226&4294967295,E=A+(C<<6&4294967295|C>>>26),C=P+(A^(E|~M))+V[11]+3174756917&4294967295,P=E+(C<<10&4294967295|C>>>22),C=M+(E^(P|~A))+V[2]+718787259&4294967295,M=P+(C<<15&4294967295|C>>>17),C=A+(P^(M|~E))+V[9]+3951481745&4294967295,L.g[0]=L.g[0]+E&4294967295,L.g[1]=L.g[1]+(M+(C<<21&4294967295|C>>>11))&4294967295,L.g[2]=L.g[2]+M&4294967295,L.g[3]=L.g[3]+P&4294967295}i.prototype.v=function(L,E){E===void 0&&(E=L.length);const A=E-this.blockSize,V=this.C;let M=this.h,P=0;for(;P<E;){if(M==0)for(;P<=A;)l(this,L,P),P+=this.blockSize;if(typeof L=="string"){for(;P<E;)if(V[M++]=L.charCodeAt(P++),M==this.blockSize){l(this,V),M=0;break}}else for(;P<E;)if(V[M++]=L[P++],M==this.blockSize){l(this,V),M=0;break}}this.h=M,this.o+=E},i.prototype.A=function(){var L=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);L[0]=128;for(var E=1;E<L.length-8;++E)L[E]=0;E=this.o*8;for(var A=L.length-8;A<L.length;++A)L[A]=E&255,E/=256;for(this.v(L),L=Array(16),E=0,A=0;A<4;++A)for(let V=0;V<32;V+=8)L[E++]=this.g[A]>>>V&255;return L};function c(L,E){var A=g;return Object.prototype.hasOwnProperty.call(A,L)?A[L]:A[L]=E(L)}function d(L,E){this.h=E;const A=[];let V=!0;for(let M=L.length-1;M>=0;M--){const P=L[M]|0;V&&P==E||(A[M]=P,V=!1)}this.g=A}var g={};function y(L){return-128<=L&&L<128?c(L,function(E){return new d([E|0],E<0?-1:0)}):new d([L|0],L<0?-1:0)}function p(L){if(isNaN(L)||!isFinite(L))return _;if(L<0)return B(p(-L));const E=[];let A=1;for(let V=0;L>=A;V++)E[V]=L/A|0,A*=4294967296;return new d(E,0)}function b(L,E){if(L.length==0)throw Error("number format error: empty string");if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(L.charAt(0)=="-")return B(b(L.substring(1),E));if(L.indexOf("-")>=0)throw Error('number format error: interior "-" character');const A=p(Math.pow(E,8));let V=_;for(let P=0;P<L.length;P+=8){var M=Math.min(8,L.length-P);const C=parseInt(L.substring(P,P+M),E);M<8?(M=p(Math.pow(E,M)),V=V.j(M).add(p(C))):(V=V.j(A),V=V.add(p(C)))}return V}var _=y(0),j=y(1),I=y(16777216);s=d.prototype,s.m=function(){if(G(this))return-B(this).m();let L=0,E=1;for(let A=0;A<this.g.length;A++){const V=this.i(A);L+=(V>=0?V:4294967296+V)*E,E*=4294967296}return L},s.toString=function(L){if(L=L||10,L<2||36<L)throw Error("radix out of range: "+L);if(F(this))return"0";if(G(this))return"-"+B(this).toString(L);const E=p(Math.pow(L,6));var A=this;let V="";for(;;){const M=pe(A,E).g;A=Y(A,M.j(E));let P=((A.g.length>0?A.g[0]:A.h)>>>0).toString(L);if(A=M,F(A))return P+V;for(;P.length<6;)P="0"+P;V=P+V}},s.i=function(L){return L<0?0:L<this.g.length?this.g[L]:this.h};function F(L){if(L.h!=0)return!1;for(let E=0;E<L.g.length;E++)if(L.g[E]!=0)return!1;return!0}function G(L){return L.h==-1}s.l=function(L){return L=Y(this,L),G(L)?-1:F(L)?0:1};function B(L){const E=L.g.length,A=[];for(let V=0;V<E;V++)A[V]=~L.g[V];return new d(A,~L.h).add(j)}s.abs=function(){return G(this)?B(this):this},s.add=function(L){const E=Math.max(this.g.length,L.g.length),A=[];let V=0;for(let M=0;M<=E;M++){let P=V+(this.i(M)&65535)+(L.i(M)&65535),C=(P>>>16)+(this.i(M)>>>16)+(L.i(M)>>>16);V=C>>>16,P&=65535,C&=65535,A[M]=C<<16|P}return new d(A,A[A.length-1]&-2147483648?-1:0)};function Y(L,E){return L.add(B(E))}s.j=function(L){if(F(this)||F(L))return _;if(G(this))return G(L)?B(this).j(B(L)):B(B(this).j(L));if(G(L))return B(this.j(B(L)));if(this.l(I)<0&&L.l(I)<0)return p(this.m()*L.m());const E=this.g.length+L.g.length,A=[];for(var V=0;V<2*E;V++)A[V]=0;for(V=0;V<this.g.length;V++)for(let M=0;M<L.g.length;M++){const P=this.i(V)>>>16,C=this.i(V)&65535,Me=L.i(M)>>>16,Qe=L.i(M)&65535;A[2*V+2*M]+=C*Qe,ee(A,2*V+2*M),A[2*V+2*M+1]+=P*Qe,ee(A,2*V+2*M+1),A[2*V+2*M+1]+=C*Me,ee(A,2*V+2*M+1),A[2*V+2*M+2]+=P*Me,ee(A,2*V+2*M+2)}for(L=0;L<E;L++)A[L]=A[2*L+1]<<16|A[2*L];for(L=E;L<2*E;L++)A[L]=0;return new d(A,0)};function ee(L,E){for(;(L[E]&65535)!=L[E];)L[E+1]+=L[E]>>>16,L[E]&=65535,E++}function re(L,E){this.g=L,this.h=E}function pe(L,E){if(F(E))throw Error("division by zero");if(F(L))return new re(_,_);if(G(L))return E=pe(B(L),E),new re(B(E.g),B(E.h));if(G(E))return E=pe(L,B(E)),new re(B(E.g),E.h);if(L.g.length>30){if(G(L)||G(E))throw Error("slowDivide_ only works with positive integers.");for(var A=j,V=E;V.l(L)<=0;)A=ve(A),V=ve(V);var M=he(A,1),P=he(V,1);for(V=he(V,2),A=he(A,2);!F(V);){var C=P.add(V);C.l(L)<=0&&(M=M.add(A),P=C),V=he(V,1),A=he(A,1)}return E=Y(L,M.j(E)),new re(M,E)}for(M=_;L.l(E)>=0;){for(A=Math.max(1,Math.floor(L.m()/E.m())),V=Math.ceil(Math.log(A)/Math.LN2),V=V<=48?1:Math.pow(2,V-48),P=p(A),C=P.j(E);G(C)||C.l(L)>0;)A-=V,P=p(A),C=P.j(E);F(P)&&(P=j),M=M.add(P),L=Y(L,C)}return new re(M,L)}s.B=function(L){return pe(this,L).h},s.and=function(L){const E=Math.max(this.g.length,L.g.length),A=[];for(let V=0;V<E;V++)A[V]=this.i(V)&L.i(V);return new d(A,this.h&L.h)},s.or=function(L){const E=Math.max(this.g.length,L.g.length),A=[];for(let V=0;V<E;V++)A[V]=this.i(V)|L.i(V);return new d(A,this.h|L.h)},s.xor=function(L){const E=Math.max(this.g.length,L.g.length),A=[];for(let V=0;V<E;V++)A[V]=this.i(V)^L.i(V);return new d(A,this.h^L.h)};function ve(L){const E=L.g.length+1,A=[];for(let V=0;V<E;V++)A[V]=L.i(V)<<1|L.i(V-1)>>>31;return new d(A,L.h)}function he(L,E){const A=E>>5;E%=32;const V=L.g.length-A,M=[];for(let P=0;P<V;P++)M[P]=E>0?L.i(P+A)>>>E|L.i(P+A+1)<<32-E:L.i(P+A);return new d(M,L.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,U_=i,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.B,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=p,d.fromString=b,so=d}).apply(typeof H2<"u"?H2:typeof self<"u"?self:typeof window<"u"?window:{});var dh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var B_,lu,z_,Nh,Ap,F_,H_,q_;(function(){var s,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof dh=="object"&&dh];for(var v=0;v<h.length;++v){var k=h[v];if(k&&k.Math==Math)return k}throw Error("Cannot find global object")}var i=t(this);function l(h,v){if(v)e:{var k=i;h=h.split(".");for(var R=0;R<h.length-1;R++){var se=h[R];if(!(se in k))break e;k=k[se]}h=h[h.length-1],R=k[h],v=v(R),v!=R&&v!=null&&e(k,h,{configurable:!0,writable:!0,value:v})}}l("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),l("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),l("Object.entries",function(h){return h||function(v){var k=[],R;for(R in v)Object.prototype.hasOwnProperty.call(v,R)&&k.push([R,v[R]]);return k}});var c=c||{},d=this||self;function g(h){var v=typeof h;return v=="object"&&h!=null||v=="function"}function y(h,v,k){return h.call.apply(h.bind,arguments)}function p(h,v,k){return p=y,p.apply(null,arguments)}function b(h,v){var k=Array.prototype.slice.call(arguments,1);return function(){var R=k.slice();return R.push.apply(R,arguments),h.apply(this,R)}}function _(h,v){function k(){}k.prototype=v.prototype,h.Z=v.prototype,h.prototype=new k,h.prototype.constructor=h,h.Ob=function(R,se,fe){for(var Be=Array(arguments.length-2),Vt=2;Vt<arguments.length;Vt++)Be[Vt-2]=arguments[Vt];return v.prototype[se].apply(R,Be)}}var j=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function I(h){const v=h.length;if(v>0){const k=Array(v);for(let R=0;R<v;R++)k[R]=h[R];return k}return[]}function F(h,v){for(let R=1;R<arguments.length;R++){const se=arguments[R];var k=typeof se;if(k=k!="object"?k:se?Array.isArray(se)?"array":k:"null",k=="array"||k=="object"&&typeof se.length=="number"){k=h.length||0;const fe=se.length||0;h.length=k+fe;for(let Be=0;Be<fe;Be++)h[k+Be]=se[Be]}else h.push(se)}}class G{constructor(v,k){this.i=v,this.j=k,this.h=0,this.g=null}get(){let v;return this.h>0?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function B(h){d.setTimeout(()=>{throw h},0)}function Y(){var h=L;let v=null;return h.g&&(v=h.g,h.g=h.g.next,h.g||(h.h=null),v.next=null),v}class ee{constructor(){this.h=this.g=null}add(v,k){const R=re.get();R.set(v,k),this.h?this.h.next=R:this.g=R,this.h=R}}var re=new G(()=>new pe,h=>h.reset());class pe{constructor(){this.next=this.g=this.h=null}set(v,k){this.h=v,this.g=k,this.next=null}reset(){this.next=this.g=this.h=null}}let ve,he=!1,L=new ee,E=()=>{const h=Promise.resolve(void 0);ve=()=>{h.then(A)}};function A(){for(var h;h=Y();){try{h.h.call(h.g)}catch(k){B(k)}var v=re;v.j(h),v.h<100&&(v.h++,h.next=v.g,v.g=h)}he=!1}function V(){this.u=this.u,this.C=this.C}V.prototype.u=!1,V.prototype.dispose=function(){this.u||(this.u=!0,this.N())},V.prototype[Symbol.dispose]=function(){this.dispose()},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function M(h,v){this.type=h,this.g=this.target=v,this.defaultPrevented=!1}M.prototype.h=function(){this.defaultPrevented=!0};var P=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var h=!1,v=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const k=()=>{};d.addEventListener("test",k,v),d.removeEventListener("test",k,v)}catch{}return h})();function C(h){return/^[\s\xa0]*$/.test(h)}function Me(h,v){M.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,v)}_(Me,M),Me.prototype.init=function(h,v){const k=this.type=h.type,R=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=v,v=h.relatedTarget,v||(k=="mouseover"?v=h.fromElement:k=="mouseout"&&(v=h.toElement)),this.relatedTarget=v,R?(this.clientX=R.clientX!==void 0?R.clientX:R.pageX,this.clientY=R.clientY!==void 0?R.clientY:R.pageY,this.screenX=R.screenX||0,this.screenY=R.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&Me.Z.h.call(this)},Me.prototype.h=function(){Me.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var Qe="closure_listenable_"+(Math.random()*1e6|0),J=0;function Se(h,v,k,R,se){this.listener=h,this.proxy=null,this.src=v,this.type=k,this.capture=!!R,this.ha=se,this.key=++J,this.da=this.fa=!1}function He(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function ke(h,v,k){for(const R in h)v.call(k,h[R],R,h)}function Pe(h,v){for(const k in h)v.call(void 0,h[k],k,h)}function U(h){const v={};for(const k in h)v[k]=h[k];return v}const ce="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ee(h,v){let k,R;for(let se=1;se<arguments.length;se++){R=arguments[se];for(k in R)h[k]=R[k];for(let fe=0;fe<ce.length;fe++)k=ce[fe],Object.prototype.hasOwnProperty.call(R,k)&&(h[k]=R[k])}}function Ce(h){this.src=h,this.g={},this.h=0}Ce.prototype.add=function(h,v,k,R,se){const fe=h.toString();h=this.g[fe],h||(h=this.g[fe]=[],this.h++);const Be=Ue(h,v,R,se);return Be>-1?(v=h[Be],k||(v.fa=!1)):(v=new Se(v,this.src,fe,!!R,se),v.fa=k,h.push(v)),v};function je(h,v){const k=v.type;if(k in h.g){var R=h.g[k],se=Array.prototype.indexOf.call(R,v,void 0),fe;(fe=se>=0)&&Array.prototype.splice.call(R,se,1),fe&&(He(v),h.g[k].length==0&&(delete h.g[k],h.h--))}}function Ue(h,v,k,R){for(let se=0;se<h.length;++se){const fe=h[se];if(!fe.da&&fe.listener==v&&fe.capture==!!k&&fe.ha==R)return se}return-1}var $e="closure_lm_"+(Math.random()*1e6|0),Xe={};function Ze(h,v,k,R,se){if(Array.isArray(v)){for(let fe=0;fe<v.length;fe++)Ze(h,v[fe],k,R,se);return null}return k=dt(k),h&&h[Qe]?h.J(v,k,g(R)?!!R.capture:!1,se):Wt(h,v,k,!1,R,se)}function Wt(h,v,k,R,se,fe){if(!v)throw Error("Invalid event type");const Be=g(se)?!!se.capture:!!se;let Vt=pn(h);if(Vt||(h[$e]=Vt=new Ce(h)),k=Vt.add(v,k,R,Be,fe),k.proxy)return k;if(R=It(),k.proxy=R,R.src=h,R.listener=k,h.addEventListener)P||(se=Be),se===void 0&&(se=!1),h.addEventListener(v.toString(),R,se);else if(h.attachEvent)h.attachEvent(qt(v.toString()),R);else if(h.addListener&&h.removeListener)h.addListener(R);else throw Error("addEventListener and attachEvent are unavailable.");return k}function It(){function h(k){return v.call(h.src,h.listener,k)}const v=Et;return h}function Cn(h,v,k,R,se){if(Array.isArray(v))for(var fe=0;fe<v.length;fe++)Cn(h,v[fe],k,R,se);else R=g(R)?!!R.capture:!!R,k=dt(k),h&&h[Qe]?(h=h.i,fe=String(v).toString(),fe in h.g&&(v=h.g[fe],k=Ue(v,k,R,se),k>-1&&(He(v[k]),Array.prototype.splice.call(v,k,1),v.length==0&&(delete h.g[fe],h.h--)))):h&&(h=pn(h))&&(v=h.g[v.toString()],h=-1,v&&(h=Ue(v,k,R,se)),(k=h>-1?v[h]:null)&&ln(k))}function ln(h){if(typeof h!="number"&&h&&!h.da){var v=h.src;if(v&&v[Qe])je(v.i,h);else{var k=h.type,R=h.proxy;v.removeEventListener?v.removeEventListener(k,R,h.capture):v.detachEvent?v.detachEvent(qt(k),R):v.addListener&&v.removeListener&&v.removeListener(R),(k=pn(v))?(je(k,h),k.h==0&&(k.src=null,v[$e]=null)):He(h)}}}function qt(h){return h in Xe?Xe[h]:Xe[h]="on"+h}function Et(h,v){if(h.da)h=!0;else{v=new Me(v,this);const k=h.listener,R=h.ha||h.src;h.fa&&ln(h),h=k.call(R,v)}return h}function pn(h){return h=h[$e],h instanceof Ce?h:null}var Tt="__closure_events_fn_"+(Math.random()*1e9>>>0);function dt(h){return typeof h=="function"?h:(h[Tt]||(h[Tt]=function(v){return h.handleEvent(v)}),h[Tt])}function le(){V.call(this),this.i=new Ce(this),this.M=this,this.G=null}_(le,V),le.prototype[Qe]=!0,le.prototype.removeEventListener=function(h,v,k,R){Cn(this,h,v,k,R)};function pt(h,v){var k,R=h.G;if(R)for(k=[];R;R=R.G)k.push(R);if(h=h.M,R=v.type||v,typeof v=="string")v=new M(v,h);else if(v instanceof M)v.target=v.target||h;else{var se=v;v=new M(R,h),Ee(v,se)}se=!0;let fe,Be;if(k)for(Be=k.length-1;Be>=0;Be--)fe=v.g=k[Be],se=Ht(fe,R,!0,v)&&se;if(fe=v.g=h,se=Ht(fe,R,!0,v)&&se,se=Ht(fe,R,!1,v)&&se,k)for(Be=0;Be<k.length;Be++)fe=v.g=k[Be],se=Ht(fe,R,!1,v)&&se}le.prototype.N=function(){if(le.Z.N.call(this),this.i){var h=this.i;for(const v in h.g){const k=h.g[v];for(let R=0;R<k.length;R++)He(k[R]);delete h.g[v],h.h--}}this.G=null},le.prototype.J=function(h,v,k,R){return this.i.add(String(h),v,!1,k,R)},le.prototype.K=function(h,v,k,R){return this.i.add(String(h),v,!0,k,R)};function Ht(h,v,k,R){if(v=h.i.g[String(v)],!v)return!0;v=v.concat();let se=!0;for(let fe=0;fe<v.length;++fe){const Be=v[fe];if(Be&&!Be.da&&Be.capture==k){const Vt=Be.listener,cs=Be.ha||Be.src;Be.fa&&je(h.i,Be),se=Vt.call(cs,R)!==!1&&se}}return se&&!R.defaultPrevented}function it(h,v){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=p(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(v)>2147483647?-1:d.setTimeout(h,v||0)}function yt(h){h.g=it(()=>{h.g=null,h.i&&(h.i=!1,yt(h))},h.l);const v=h.h;h.h=null,h.m.apply(null,v)}class gt extends V{constructor(v,k){super(),this.m=v,this.l=k,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:yt(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function _t(h){V.call(this),this.h=h,this.g={}}_(_t,V);var zt=[];function fs(h){ke(h.g,function(v,k){this.g.hasOwnProperty(k)&&ln(v)},h),h.g={}}_t.prototype.N=function(){_t.Z.N.call(this),fs(this)},_t.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var rn=d.JSON.stringify,Zn=d.JSON.parse,Fn=class{stringify(h){return d.JSON.stringify(h,void 0)}parse(h){return d.JSON.parse(h,void 0)}};function Ln(){}function Pn(){}var un={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Gt(){M.call(this,"d")}_(Gt,M);function Ct(){M.call(this,"c")}_(Ct,M);var Mt={},Z=null;function N(){return Z=Z||new le}Mt.Ia="serverreachability";function te(h){M.call(this,Mt.Ia,h)}_(te,M);function Re(h){const v=N();pt(v,new te(v))}Mt.STAT_EVENT="statevent";function Ie(h,v){M.call(this,Mt.STAT_EVENT,h),this.stat=v}_(Ie,M);function De(h){const v=N();pt(v,new Ie(v,h))}Mt.Ja="timingevent";function Fe(h,v){M.call(this,Mt.Ja,h),this.size=v}_(Fe,M);function Oe(h,v){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){h()},v)}function Nt(){this.g=!0}Nt.prototype.ua=function(){this.g=!1};function bt(h,v,k,R,se,fe){h.info(function(){if(h.g)if(fe){var Be="",Vt=fe.split("&");for(let xn=0;xn<Vt.length;xn++){var cs=Vt[xn].split("=");if(cs.length>1){const qn=cs[0];cs=cs[1];const zr=qn.split("_");Be=zr.length>=2&&zr[1]=="type"?Be+(qn+"="+cs+"&"):Be+(qn+"=redacted&")}}}else Be=null;else Be=fe;return"XMLHTTP REQ ("+R+") [attempt "+se+"]: "+v+`
`+k+`
`+Be})}function lt(h,v,k,R,se,fe,Be){h.info(function(){return"XMLHTTP RESP ("+R+") [ attempt "+se+"]: "+v+`
`+k+`
`+fe+" "+Be})}function dn(h,v,k,R){h.info(function(){return"XMLHTTP TEXT ("+v+"): "+On(h,k)+(R?" "+R:"")})}function hn(h,v){h.info(function(){return"TIMEOUT: "+v})}Nt.prototype.info=function(){};function On(h,v){if(!h.g)return v;if(!v)return null;try{const fe=JSON.parse(v);if(fe){for(h=0;h<fe.length;h++)if(Array.isArray(fe[h])){var k=fe[h];if(!(k.length<2)){var R=k[1];if(Array.isArray(R)&&!(R.length<1)){var se=R[0];if(se!="noop"&&se!="stop"&&se!="close")for(let Be=1;Be<R.length;Be++)R[Be]=""}}}}return rn(fe)}catch{return v}}var ms={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ue={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Le;function Ke(){}_(Ke,Ln),Ke.prototype.g=function(){return new XMLHttpRequest},Le=new Ke;function ct(h){return encodeURIComponent(String(h))}function rt(h){var v=1;h=h.split(":");const k=[];for(;v>0&&h.length;)k.push(h.shift()),v--;return h.length&&k.push(h.join(":")),k}function Kt(h,v,k,R){this.j=h,this.i=v,this.l=k,this.S=R||1,this.V=new _t(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new fn}function fn(){this.i=null,this.g="",this.h=!1}var At={},St={};function bn(h,v,k){h.M=1,h.A=Rt(ne(v)),h.u=k,h.R=!0,Ss(h,null)}function Ss(h,v){h.F=Date.now(),js(h),h.B=ne(h.A);var k=h.B,R=h.S;Array.isArray(R)||(R=[String(R)]),ki(k.i,"t",R),h.C=0,k=h.j.L,h.h=new fn,h.g=td(h.j,k?v:null,!h.u),h.P>0&&(h.O=new gt(p(h.Y,h,h.g),h.P)),v=h.V,k=h.g,R=h.ba;var se="readystatechange";Array.isArray(se)||(se&&(zt[0]=se.toString()),se=zt);for(let fe=0;fe<se.length;fe++){const Be=Ze(k,se[fe],R||v.handleEvent,!1,v.h||v);if(!Be)break;v.g[Be.key]=Be}v=h.J?U(h.J):{},h.u?(h.v||(h.v="POST"),v["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,v)):(h.v="GET",h.g.ea(h.B,h.v,null,v)),Re(),bt(h.i,h.v,h.B,h.l,h.S,h.u)}Kt.prototype.ba=function(h){h=h.target;const v=this.O;v&&Hn(h)==3?v.j():this.Y(h)},Kt.prototype.Y=function(h){try{if(h==this.g)e:{const Vt=Hn(this.g),cs=this.g.ya(),xn=this.g.ca();if(!(Vt<3)&&(Vt!=3||this.g&&(this.h.h||this.g.la()||tt(this.g)))){this.K||Vt!=4||cs==7||(cs==8||xn<=0?Re(3):Re(2)),Kn(this);var v=this.g.ca();this.X=v;var k=si(this);if(this.o=v==200,lt(this.i,this.v,this.B,this.l,this.S,Vt,v),this.o){if(this.U&&!this.L){t:{if(this.g){var R,se=this.g;if((R=se.g?se.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!C(R)){var fe=R;break t}}fe=null}if(h=fe)dn(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Vn(this,h);else{this.o=!1,this.m=3,De(12),ls(this),os(this);break e}}if(this.R){h=!0;let qn;for(;!this.K&&this.C<k.length;)if(qn=Vr(this,k),qn==St){Vt==4&&(this.m=4,De(14),h=!1),dn(this.i,this.l,null,"[Incomplete Response]");break}else if(qn==At){this.m=4,De(15),dn(this.i,this.l,k,"[Invalid Chunk]"),h=!1;break}else dn(this.i,this.l,qn,null),Vn(this,qn);if(xi(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Vt!=4||k.length!=0||this.h.h||(this.m=1,De(16),h=!1),this.o=this.o&&h,!h)dn(this.i,this.l,k,"[Invalid Chunked Response]"),ls(this),os(this);else if(k.length>0&&!this.W){this.W=!0;var Be=this.j;Be.g==this&&Be.aa&&!Be.P&&(Be.j.info("Great, no buffering proxy detected. Bytes received: "+k.length),fc(Be),Be.P=!0,De(11))}}else dn(this.i,this.l,k,null),Vn(this,k);Vt==4&&ls(this),this.o&&!this.K&&(Vt==4?Xu(this.j,this):(this.o=!1,js(this)))}else mn(this.g),v==400&&k.indexOf("Unknown SID")>0?(this.m=3,De(12)):(this.m=0,De(13)),ls(this),os(this)}}}catch{}};function si(h){if(!xi(h))return h.g.la();const v=tt(h.g);if(v==="")return"";let k="";const R=v.length,se=Hn(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return ls(h),os(h),"";h.h.i=new d.TextDecoder}for(let fe=0;fe<R;fe++)h.h.h=!0,k+=h.h.i.decode(v[fe],{stream:!(se&&fe==R-1)});return v.length=0,h.h.g+=k,h.C=0,h.h.g}function xi(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function Vr(h,v){var k=h.C,R=v.indexOf(`
`,k);return R==-1?St:(k=Number(v.substring(k,R)),isNaN(k)?At:(R+=1,R+k>v.length?St:(v=v.slice(R,R+k),h.C=R+k,v)))}Kt.prototype.cancel=function(){this.K=!0,ls(this)};function js(h){h.T=Date.now()+h.H,hr(h,h.H)}function hr(h,v){if(h.D!=null)throw Error("WatchDog timer not null");h.D=Oe(p(h.aa,h),v)}function Kn(h){h.D&&(d.clearTimeout(h.D),h.D=null)}Kt.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(hn(this.i,this.B),this.M!=2&&(Re(),De(17)),ls(this),this.m=2,os(this)):hr(this,this.T-h)};function os(h){h.j.I==0||h.K||Xu(h.j,h)}function ls(h){Kn(h);var v=h.O;v&&typeof v.dispose=="function"&&v.dispose(),h.O=null,fs(h.V),h.g&&(v=h.g,h.g=null,v.abort(),v.dispose())}function Vn(h,v){try{var k=h.j;if(k.I!=0&&(k.g==h||Yn(k.h,h))){if(!h.L&&Yn(k.h,h)&&k.I==3){try{var R=k.Ba.g.parse(v)}catch{R=null}if(Array.isArray(R)&&R.length==3){var se=R;if(se[0]==0){e:if(!k.v){if(k.g)if(k.g.F+3e3<h.F)rl(k),Xn(k);else break e;ai(k),De(18)}}else k.xa=se[1],0<k.xa-k.K&&se[2]<37500&&k.F&&k.A==0&&!k.C&&(k.C=Oe(p(k.Va,k),6e3));$s(k.h)<=1&&k.ta&&(k.ta=void 0)}else ji(k,11)}else if((h.L||k.g==h)&&rl(k),!C(v))for(se=k.Ba.g.parse(v),v=0;v<se.length;v++){let xn=se[v];const qn=xn[0];if(!(qn<=k.K))if(k.K=qn,xn=xn[1],k.I==2)if(xn[0]=="c"){k.M=xn[1],k.ba=xn[2];const zr=xn[3];zr!=null&&(k.ka=zr,k.j.info("VER="+k.ka));const Ei=xn[4];Ei!=null&&(k.za=Ei,k.j.info("SVER="+k.za));const oi=xn[5];oi!=null&&typeof oi=="number"&&oi>0&&(R=1.5*oi,k.O=R,k.j.info("backChannelRequestTimeoutMs_="+R)),R=k;const li=h.g;if(li){const vo=li.g?li.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(vo){var fe=R.h;fe.g||vo.indexOf("spdy")==-1&&vo.indexOf("quic")==-1&&vo.indexOf("h2")==-1||(fe.j=fe.l,fe.g=new Set,fe.h&&(jr(fe,fe.h),fe.h=null))}if(R.G){const il=li.g?li.g.getResponseHeader("X-HTTP-Session-Id"):null;il&&(R.wa=il,ot(R.J,R.G,il))}}k.I=3,k.l&&k.l.ra(),k.aa&&(k.T=Date.now()-h.F,k.j.info("Handshake RTT: "+k.T+"ms")),R=k;var Be=h;if(R.na=ed(R,R.L?R.ba:null,R.W),Be.L){ts(R.h,Be);var Vt=Be,cs=R.O;cs&&(Vt.H=cs),Vt.D&&(Kn(Vt),js(Vt)),R.g=Be}else sl(R);k.i.length>0&&Ks(k)}else xn[0]!="stop"&&xn[0]!="close"||ji(k,7);else k.I==3&&(xn[0]=="stop"||xn[0]=="close"?xn[0]=="stop"?ji(k,7):gn(k):xn[0]!="noop"&&k.l&&k.l.qa(xn),k.A=0)}}Re(4)}catch{}}var wn=class{constructor(h,v){this.g=h,this.map=v}};function es(h){this.l=h||10,d.PerformanceNavigationTiming?(h=d.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function kr(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function $s(h){return h.h?1:h.g?h.g.size:0}function Yn(h,v){return h.h?h.h==v:h.g?h.g.has(v):!1}function jr(h,v){h.g?h.g.add(v):h.h=v}function ts(h,v){h.h&&h.h==v?h.h=null:h.g&&h.g.has(v)&&h.g.delete(v)}es.prototype.cancel=function(){if(this.i=Ur(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Ur(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let v=h.i;for(const k of h.g.values())v=v.concat(k.G);return v}return I(h.i)}var O=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function q(h,v){if(h){h=h.split("&");for(let k=0;k<h.length;k++){const R=h[k].indexOf("=");let se,fe=null;R>=0?(se=h[k].substring(0,R),fe=h[k].substring(R+1)):se=h[k],v(se,fe?decodeURIComponent(fe.replace(/\+/g," ")):"")}}}function oe(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let v;h instanceof oe?(this.l=h.l,Ye(this,h.j),this.o=h.o,this.g=h.g,Ge(this,h.u),this.h=h.h,qe(this,Fi(h.i)),this.m=h.m):h&&(v=String(h).match(O))?(this.l=!1,Ye(this,v[1]||"",!0),this.o=Nn(v[2]||""),this.g=Nn(v[3]||"",!0),Ge(this,v[4]),this.h=Nn(v[5]||"",!0),qe(this,v[6]||"",!0),this.m=Nn(v[7]||"")):(this.l=!1,this.i=new Er(null,this.l))}oe.prototype.toString=function(){const h=[];var v=this.j;v&&h.push(Cs(v,Ms,!0),":");var k=this.g;return(k||v=="file")&&(h.push("//"),(v=this.o)&&h.push(Cs(v,Ms,!0),"@"),h.push(ct(k).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),k=this.u,k!=null&&h.push(":",String(k))),(k=this.h)&&(this.g&&k.charAt(0)!="/"&&h.push("/"),h.push(Cs(k,k.charAt(0)=="/"?Ds:ri,!0))),(k=this.i.toString())&&h.push("?",k),(k=this.m)&&h.push("#",Cs(k,_i)),h.join("")},oe.prototype.resolve=function(h){const v=ne(this);let k=!!h.j;k?Ye(v,h.j):k=!!h.o,k?v.o=h.o:k=!!h.g,k?v.g=h.g:k=h.u!=null;var R=h.h;if(k)Ge(v,h.u);else if(k=!!h.h){if(R.charAt(0)!="/")if(this.g&&!this.h)R="/"+R;else{var se=v.h.lastIndexOf("/");se!=-1&&(R=v.h.slice(0,se+1)+R)}if(se=R,se==".."||se==".")R="";else if(se.indexOf("./")!=-1||se.indexOf("/.")!=-1){R=se.lastIndexOf("/",0)==0,se=se.split("/");const fe=[];for(let Be=0;Be<se.length;){const Vt=se[Be++];Vt=="."?R&&Be==se.length&&fe.push(""):Vt==".."?((fe.length>1||fe.length==1&&fe[0]!="")&&fe.pop(),R&&Be==se.length&&fe.push("")):(fe.push(Vt),R=!0)}R=fe.join("/")}else R=se}return k?v.h=R:k=h.i.toString()!=="",k?qe(v,Fi(h.i)):k=!!h.m,k&&(v.m=h.m),v};function ne(h){return new oe(h)}function Ye(h,v,k){h.j=k?Nn(v,!0):v,h.j&&(h.j=h.j.replace(/:$/,""))}function Ge(h,v){if(v){if(v=Number(v),isNaN(v)||v<0)throw Error("Bad port number "+v);h.u=v}else h.u=null}function qe(h,v,k){v instanceof Er?(h.i=v,Tr(h.i,h.l)):(k||(v=Cs(v,er)),h.i=new Er(v,h.l))}function ot(h,v,k){h.i.set(v,k)}function Rt(h){return ot(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function Nn(h,v){return h?v?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Cs(h,v,k){return typeof h=="string"?(h=encodeURI(h).replace(v,Qn),k&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function Qn(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Ms=/[#\/\?@]/g,ri=/[#\?:]/g,Ds=/[#\?]/g,er=/[#\?@]/g,_i=/#/g;function Er(h,v){this.h=this.g=null,this.i=h||null,this.j=!!v}function Ns(h){h.g||(h.g=new Map,h.h=0,h.i&&q(h.i,function(v,k){h.add(decodeURIComponent(v.replace(/\+/g," ")),k)}))}s=Er.prototype,s.add=function(h,v){Ns(this),this.i=null,h=Br(this,h);let k=this.g.get(h);return k||this.g.set(h,k=[]),k.push(v),this.h+=1,this};function Ea(h,v){Ns(h),v=Br(h,v),h.g.has(v)&&(h.i=null,h.h-=h.g.get(v).length,h.g.delete(v))}function zi(h,v){return Ns(h),v=Br(h,v),h.g.has(v)}s.forEach=function(h,v){Ns(this),this.g.forEach(function(k,R){k.forEach(function(se){h.call(v,se,R,this)},this)},this)};function ii(h,v){Ns(h);let k=[];if(typeof v=="string")zi(h,v)&&(k=k.concat(h.g.get(Br(h,v))));else for(h=Array.from(h.g.values()),v=0;v<h.length;v++)k=k.concat(h[v]);return k}s.set=function(h,v){return Ns(this),this.i=null,h=Br(this,h),zi(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[v]),this.h+=1,this},s.get=function(h,v){return h?(h=ii(this,h),h.length>0?String(h[0]):v):v};function ki(h,v,k){Ea(h,v),k.length>0&&(h.i=null,h.g.set(Br(h,v),I(k)),h.h+=k.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],v=Array.from(this.g.keys());for(let R=0;R<v.length;R++){var k=v[R];const se=ct(k);k=ii(this,k);for(let fe=0;fe<k.length;fe++){let Be=se;k[fe]!==""&&(Be+="="+ct(k[fe])),h.push(Be)}}return this.i=h.join("&")};function Fi(h){const v=new Er;return v.i=h.i,h.g&&(v.g=new Map(h.g),v.h=h.h),v}function Br(h,v){return v=String(v),h.j&&(v=v.toLowerCase()),v}function Tr(h,v){v&&!h.j&&(Ns(h),h.i=null,h.g.forEach(function(k,R){const se=R.toLowerCase();R!=se&&(Ea(this,R),ki(this,se,k))},h)),h.j=v}function Ws(h,v){const k=new Nt;if(d.Image){const R=new Image;R.onload=b(Ls,k,"TestLoadImage: loaded",!0,v,R),R.onerror=b(Ls,k,"TestLoadImage: error",!1,v,R),R.onabort=b(Ls,k,"TestLoadImage: abort",!1,v,R),R.ontimeout=b(Ls,k,"TestLoadImage: timeout",!1,v,R),d.setTimeout(function(){R.ontimeout&&R.ontimeout()},1e4),R.src=h}else v(!1)}function Gs(h,v){const k=new Nt,R=new AbortController,se=setTimeout(()=>{R.abort(),Ls(k,"TestPingServer: timeout",!1,v)},1e4);fetch(h,{signal:R.signal}).then(fe=>{clearTimeout(se),fe.ok?Ls(k,"TestPingServer: ok",!0,v):Ls(k,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(se),Ls(k,"TestPingServer: error",!1,v)})}function Ls(h,v,k,R,se){try{se&&(se.onload=null,se.onerror=null,se.onabort=null,se.ontimeout=null),R(k)}catch{}}function S(){this.g=new Fn}function Q(h){this.i=h.Sb||null,this.h=h.ab||!1}_(Q,Ln),Q.prototype.g=function(){return new Ae(this.i,this.h)};function Ae(h,v){le.call(this),this.H=h,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}_(Ae,le),s=Ae.prototype,s.open=function(h,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=v,this.readyState=1,$(this)},s.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const v={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(v.body=h),(this.H||d).fetch(new Request(this.D,v)).then(this.Pa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,H(this)),this.readyState=0},s.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,$(this)),this.g&&(this.readyState=3,$(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;D(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function D(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}s.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var v=h.value?h.value:new Uint8Array(0);(v=this.B.decode(v,{stream:!h.done}))&&(this.response=this.responseText+=v)}h.done?H(this):$(this),this.readyState==3&&D(this)}},s.Oa=function(h){this.g&&(this.response=this.responseText=h,H(this))},s.Na=function(h){this.g&&(this.response=h,H(this))},s.ga=function(){this.g&&H(this)};function H(h){h.readyState=4,h.l=null,h.j=null,h.B=null,$(h)}s.setRequestHeader=function(h,v){this.A.append(h,v)},s.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],v=this.h.entries();for(var k=v.next();!k.done;)k=k.value,h.push(k[0]+": "+k[1]),k=v.next();return h.join(`\r
`)};function $(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Ae.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function K(h){let v="";return ke(h,function(k,R){v+=R,v+=":",v+=k,v+=`\r
`}),v}function me(h,v,k){e:{for(R in k){var R=!1;break e}R=!0}R||(k=K(k),typeof h=="string"?k!=null&&ct(k):ot(h,v,k))}function be(h){le.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}_(be,le);var Ve=/^https?$/i,nt=["POST","PUT"];s=be.prototype,s.Fa=function(h){this.H=h},s.ea=function(h,v,k,R){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);v=v?v.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Le.g(),this.g.onreadystatechange=j(p(this.Ca,this));try{this.B=!0,this.g.open(v,String(h),!0),this.B=!1}catch(fe){st(this,fe);return}if(h=k||"",k=new Map(this.headers),R)if(Object.getPrototypeOf(R)===Object.prototype)for(var se in R)k.set(se,R[se]);else if(typeof R.keys=="function"&&typeof R.get=="function")for(const fe of R.keys())k.set(fe,R.get(fe));else throw Error("Unknown input type for opt_headers: "+String(R));R=Array.from(k.keys()).find(fe=>fe.toLowerCase()=="content-type"),se=d.FormData&&h instanceof d.FormData,!(Array.prototype.indexOf.call(nt,v,void 0)>=0)||R||se||k.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[fe,Be]of k)this.g.setRequestHeader(fe,Be);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(fe){st(this,fe)}};function st(h,v){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=v,h.o=5,vt(h),Xt(h)}function vt(h){h.A||(h.A=!0,pt(h,"complete"),pt(h,"error"))}s.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,pt(this,"complete"),pt(this,"abort"),Xt(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Xt(this,!0)),be.Z.N.call(this)},s.Ca=function(){this.u||(this.B||this.v||this.j?kt(this):this.Xa())},s.Xa=function(){kt(this)};function kt(h){if(h.h&&typeof c<"u"){if(h.v&&Hn(h)==4)setTimeout(h.Ca.bind(h),0);else if(pt(h,"readystatechange"),Hn(h)==4){h.h=!1;try{const fe=h.ca();e:switch(fe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var k;if(!(k=v)){var R;if(R=fe===0){let Be=String(h.D).match(O)[1]||null;!Be&&d.self&&d.self.location&&(Be=d.self.location.protocol.slice(0,-1)),R=!Ve.test(Be?Be.toLowerCase():"")}k=R}if(k)pt(h,"complete"),pt(h,"success");else{h.o=6;try{var se=Hn(h)>2?h.g.statusText:""}catch{se=""}h.l=se+" ["+h.ca()+"]",vt(h)}}finally{Xt(h)}}}}function Xt(h,v){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const k=h.g;h.g=null,v||pt(h,"ready");try{k.onreadystatechange=null}catch{}}}s.isActive=function(){return!!this.g};function Hn(h){return h.g?h.g.readyState:0}s.ca=function(){try{return Hn(this)>2?this.g.status:-1}catch{return-1}},s.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.La=function(h){if(this.g){var v=this.g.responseText;return h&&v.indexOf(h)==0&&(v=v.substring(h.length)),Zn(v)}};function tt(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function mn(h){const v={};h=(h.g&&Hn(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let R=0;R<h.length;R++){if(C(h[R]))continue;var k=rt(h[R]);const se=k[0];if(k=k[1],typeof k!="string")continue;k=k.trim();const fe=v[se]||[];v[se]=fe,fe.push(k)}Pe(v,function(R){return R.join(", ")})}s.ya=function(){return this.o},s.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function an(h,v,k){return k&&k.internalChannelParams&&k.internalChannelParams[h]||v}function mt(h){this.za=0,this.i=[],this.j=new Nt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=an("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=an("baseRetryDelayMs",5e3,h),this.Za=an("retryDelaySeedMs",1e4,h),this.Ta=an("forwardChannelMaxRetries",2,h),this.va=an("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new es(h&&h.concurrentRequestLimit),this.Ba=new S,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}s=mt.prototype,s.ka=8,s.I=1,s.connect=function(h,v,k,R){De(0),this.W=h,this.H=v||{},k&&R!==void 0&&(this.H.OSID=k,this.H.OAID=R),this.F=this.X,this.J=ed(this,null,this.W),Ks(this)};function gn(h){if(tr(h),h.I==3){var v=h.V++,k=ne(h.J);if(ot(k,"SID",h.M),ot(k,"RID",v),ot(k,"TYPE","terminate"),Sr(h,k),v=new Kt(h,h.j,v),v.M=2,v.A=Rt(ne(k)),k=!1,d.navigator&&d.navigator.sendBeacon)try{k=d.navigator.sendBeacon(v.A.toString(),"")}catch{}!k&&d.Image&&(new Image().src=v.A,k=!0),k||(v.g=td(v.j,null),v.g.ea(v.A)),v.F=Date.now(),js(v)}Zu(h)}function Xn(h){h.g&&(fc(h),h.g.cancel(),h.g=null)}function tr(h){Xn(h),h.v&&(d.clearTimeout(h.v),h.v=null),rl(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&d.clearTimeout(h.m),h.m=null)}function Ks(h){if(!kr(h.h)&&!h.m){h.m=!0;var v=h.Ea;ve||E(),he||(ve(),he=!0),L.add(v,h),h.D=0}}function As(h,v){return $s(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=v.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=Oe(p(h.Ea,h,v),Ju(h,h.D)),h.D++,!0)}s.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const se=new Kt(this,this.j,h);let fe=this.o;if(this.U&&(fe?(fe=U(fe),Ee(fe,this.U)):fe=this.U),this.u!==null||this.R||(se.J=fe,fe=null),this.S)e:{for(var v=0,k=0;k<this.i.length;k++){t:{var R=this.i[k];if("__data__"in R.map&&(R=R.map.__data__,typeof R=="string")){R=R.length;break t}R=void 0}if(R===void 0)break;if(v+=R,v>4096){v=k;break e}if(v===4096||k===this.i.length-1){v=k+1;break e}}v=1e3}else v=1e3;v=yo(this,se,v),k=ne(this.J),ot(k,"RID",h),ot(k,"CVER",22),this.G&&ot(k,"X-HTTP-Session-Id",this.G),Sr(this,k),fe&&(this.R?v="headers="+ct(K(fe))+"&"+v:this.u&&me(k,this.u,fe)),jr(this.h,se),this.Ra&&ot(k,"TYPE","init"),this.S?(ot(k,"$req",v),ot(k,"SID","null"),se.U=!0,bn(se,k,null)):bn(se,k,v),this.I=2}}else this.I==3&&(h?nr(this,h):this.i.length==0||kr(this.h)||nr(this))};function nr(h,v){var k;v?k=v.l:k=h.V++;const R=ne(h.J);ot(R,"SID",h.M),ot(R,"RID",k),ot(R,"AID",h.K),Sr(h,R),h.u&&h.o&&me(R,h.u,h.o),k=new Kt(h,h.j,k,h.D+1),h.u===null&&(k.J=h.o),v&&(h.i=v.G.concat(h.i)),v=yo(h,k,1e3),k.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),jr(h.h,k),bn(k,R,v)}function Sr(h,v){h.H&&ke(h.H,function(k,R){ot(v,R,k)}),h.l&&ke({},function(k,R){ot(v,R,k)})}function yo(h,v,k){k=Math.min(h.i.length,k);const R=h.l?p(h.l.Ka,h.l,h):null;e:{var se=h.i;let Vt=-1;for(;;){const cs=["count="+k];Vt==-1?k>0?(Vt=se[0].g,cs.push("ofs="+Vt)):Vt=0:cs.push("ofs="+Vt);let xn=!0;for(let qn=0;qn<k;qn++){var fe=se[qn].g;const zr=se[qn].map;if(fe-=Vt,fe<0)Vt=Math.max(0,se[qn].g-100),xn=!1;else try{fe="req"+fe+"_"||"";try{var Be=zr instanceof Map?zr:Object.entries(zr);for(const[Ei,oi]of Be){let li=oi;g(oi)&&(li=rn(oi)),cs.push(fe+Ei+"="+encodeURIComponent(li))}}catch(Ei){throw cs.push(fe+"type="+encodeURIComponent("_badmap")),Ei}}catch{R&&R(zr)}}if(xn){Be=cs.join("&");break e}}Be=void 0}return h=h.i.splice(0,k),v.G=h,Be}function sl(h){if(!h.g&&!h.v){h.Y=1;var v=h.Da;ve||E(),he||(ve(),he=!0),L.add(v,h),h.A=0}}function ai(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=Oe(p(h.Da,h),Ju(h,h.A)),h.A++,!0)}s.Da=function(){if(this.v=null,Qu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=Oe(p(this.Wa,this),h)}},s.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,De(10),Xn(this),Qu(this))};function fc(h){h.B!=null&&(d.clearTimeout(h.B),h.B=null)}function Qu(h){h.g=new Kt(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var v=ne(h.na);ot(v,"RID","rpc"),ot(v,"SID",h.M),ot(v,"AID",h.K),ot(v,"CI",h.F?"0":"1"),!h.F&&h.ia&&ot(v,"TO",h.ia),ot(v,"TYPE","xmlhttp"),Sr(h,v),h.u&&h.o&&me(v,h.u,h.o),h.O&&(h.g.H=h.O);var k=h.g;h=h.ba,k.M=1,k.A=Rt(ne(v)),k.u=null,k.R=!0,Ss(k,h)}s.Va=function(){this.C!=null&&(this.C=null,Xn(this),ai(this),De(19))};function rl(h){h.C!=null&&(d.clearTimeout(h.C),h.C=null)}function Xu(h,v){var k=null;if(h.g==v){rl(h),fc(h),h.g=null;var R=2}else if(Yn(h.h,v))k=v.G,ts(h.h,v),R=1;else return;if(h.I!=0){if(v.o)if(R==1){k=v.u?v.u.length:0,v=Date.now()-v.F;var se=h.D;R=N(),pt(R,new Fe(R,k)),Ks(h)}else sl(h);else if(se=v.m,se==3||se==0&&v.X>0||!(R==1&&As(h,v)||R==2&&ai(h)))switch(k&&k.length>0&&(v=h.h,v.i=v.i.concat(k)),se){case 1:ji(h,5);break;case 4:ji(h,10);break;case 3:ji(h,6);break;default:ji(h,2)}}}function Ju(h,v){let k=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(k*=2),k*v}function ji(h,v){if(h.j.info("Error code "+v),v==2){var k=p(h.bb,h),R=h.Ua;const se=!R;R=new oe(R||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||Ye(R,"https"),Rt(R),se?Ws(R.toString(),k):Gs(R.toString(),k)}else De(2);h.I=0,h.l&&h.l.pa(v),Zu(h),tr(h)}s.bb=function(h){h?(this.j.info("Successfully pinged google.com"),De(2)):(this.j.info("Failed to ping google.com"),De(1))};function Zu(h){if(h.I=0,h.ja=[],h.l){const v=Ur(h.h);(v.length!=0||h.i.length!=0)&&(F(h.ja,v),F(h.ja,h.i),h.h.i.length=0,I(h.i),h.i.length=0),h.l.oa()}}function ed(h,v,k){var R=k instanceof oe?ne(k):new oe(k);if(R.g!="")v&&(R.g=v+"."+R.g),Ge(R,R.u);else{var se=d.location;R=se.protocol,v=v?v+"."+se.hostname:se.hostname,se=+se.port;const fe=new oe(null);R&&Ye(fe,R),v&&(fe.g=v),se&&Ge(fe,se),k&&(fe.h=k),R=fe}return k=h.G,v=h.wa,k&&v&&ot(R,k,v),ot(R,"VER",h.ka),Sr(h,R),R}function td(h,v,k){if(v&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return v=h.Aa&&!h.ma?new be(new Q({ab:k})):new be(h.ma),v.Fa(h.L),v}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function nd(){}s=nd.prototype,s.ra=function(){},s.qa=function(){},s.pa=function(){},s.oa=function(){},s.isActive=function(){return!0},s.Ka=function(){};function Ta(){}Ta.prototype.g=function(h,v){return new sr(h,v)};function sr(h,v){le.call(this),this.g=new mt(v),this.l=h,this.h=v&&v.messageUrlParams||null,h=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(h?h["X-WebChannel-Content-Type"]=v.messageContentType:h={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.sa&&(h?h["X-WebChannel-Client-Profile"]=v.sa:h={"X-WebChannel-Client-Profile":v.sa}),this.g.U=h,(h=v&&v.Qb)&&!C(h)&&(this.g.u=h),this.A=v&&v.supportsCrossDomainXhr||!1,this.v=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!C(v)&&(this.g.G=v,h=this.h,h!==null&&v in h&&(h=this.h,v in h&&delete h[v])),this.j=new Hi(this)}_(sr,le),sr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},sr.prototype.close=function(){gn(this.g)},sr.prototype.o=function(h){var v=this.g;if(typeof h=="string"){var k={};k.__data__=h,h=k}else this.v&&(k={},k.__data__=rn(h),h=k);v.i.push(new wn(v.Ya++,h)),v.I==3&&Ks(v)},sr.prototype.N=function(){this.g.l=null,delete this.j,gn(this.g),delete this.g,sr.Z.N.call(this)};function sd(h){Gt.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var v=h.__sm__;if(v){e:{for(const k in v){h=k;break e}h=void 0}(this.i=h)&&(h=this.i,v=v!==null&&h in v?v[h]:void 0),this.data=v}else this.data=h}_(sd,Gt);function rd(){Ct.call(this),this.status=1}_(rd,Ct);function Hi(h){this.g=h}_(Hi,nd),Hi.prototype.ra=function(){pt(this.g,"a")},Hi.prototype.qa=function(h){pt(this.g,new sd(h))},Hi.prototype.pa=function(h){pt(this.g,new rd)},Hi.prototype.oa=function(){pt(this.g,"b")},Ta.prototype.createWebChannel=Ta.prototype.g,sr.prototype.send=sr.prototype.o,sr.prototype.open=sr.prototype.m,sr.prototype.close=sr.prototype.close,q_=function(){return new Ta},H_=function(){return N()},F_=Mt,Ap={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ms.NO_ERROR=0,ms.TIMEOUT=8,ms.HTTP_ERROR=6,Nh=ms,ue.COMPLETE="complete",z_=ue,Pn.EventType=un,un.OPEN="a",un.CLOSE="b",un.ERROR="c",un.MESSAGE="d",le.prototype.listen=le.prototype.J,lu=Pn,be.prototype.listenOnce=be.prototype.K,be.prototype.getLastError=be.prototype.Ha,be.prototype.getLastErrorCode=be.prototype.ya,be.prototype.getStatus=be.prototype.ca,be.prototype.getResponseJson=be.prototype.La,be.prototype.getResponseText=be.prototype.la,be.prototype.send=be.prototype.ea,be.prototype.setWithCredentials=be.prototype.Fa,B_=be}).apply(typeof dh<"u"?dh:typeof self<"u"?self:typeof window<"u"?window:{});class Xs{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Xs.UNAUTHENTICATED=new Xs(null),Xs.GOOGLE_CREDENTIALS=new Xs("google-credentials-uid"),Xs.FIRST_PARTY=new Xs("first-party-uid"),Xs.MOCK_USER=new Xs("mock-user");let oc="12.8.0";function TR(s){oc=s}const Ho=new uy("@firebase/firestore");function Ol(){return Ho.logLevel}function Je(s,...e){if(Ho.logLevel<=en.DEBUG){const t=e.map(jy);Ho.debug(`Firestore (${oc}): ${s}`,...t)}}function wa(s,...e){if(Ho.logLevel<=en.ERROR){const t=e.map(jy);Ho.error(`Firestore (${oc}): ${s}`,...t)}}function Gl(s,...e){if(Ho.logLevel<=en.WARN){const t=e.map(jy);Ho.warn(`Firestore (${oc}): ${s}`,...t)}}function jy(s){if(typeof s=="string")return s;try{return(function(t){return JSON.stringify(t)})(s)}catch{return s}}function jt(s,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,$_(s,i,t)}function $_(s,e,t){let i=`FIRESTORE (${oc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw wa(i),new Error(i)}function kn(s,e,t,i){let l="Unexpected state";typeof t=="string"?l=t:i=t,s||$_(e,l,i)}function Pt(s,e){return s}const _e={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class We extends wi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ma{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class W_{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class SR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Xs.UNAUTHENTICATED)))}shutdown(){}}class CR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class NR{constructor(e){this.t=e,this.currentUser=Xs.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){kn(this.o===void 0,42304);let i=this.i;const l=y=>this.i!==i?(i=this.i,t(y)):Promise.resolve();let c=new ma;this.o=()=>{this.i++,this.currentUser=this.u(),c.resolve(),c=new ma,e.enqueueRetryable((()=>l(this.currentUser)))};const d=()=>{const y=c;e.enqueueRetryable((async()=>{await y.promise,await l(this.currentUser)}))},g=y=>{Je("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=y,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((y=>g(y))),setTimeout((()=>{if(!this.auth){const y=this.t.getImmediate({optional:!0});y?g(y):(Je("FirebaseAuthCredentialsProvider","Auth not yet detected"),c.resolve(),c=new ma)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(Je("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(kn(typeof i.accessToken=="string",31837,{l:i}),new W_(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return kn(e===null||typeof e=="string",2055,{h:e}),new Xs(e)}}class AR{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=Xs.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class RR{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new AR(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Xs.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class q2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class IR{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,br(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){kn(this.o===void 0,3512);const i=c=>{c.error!=null&&Je("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${c.error.message}`);const d=c.token!==this.m;return this.m=c.token,Je("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(c.token):Promise.resolve()};this.o=c=>{e.enqueueRetryable((()=>i(c)))};const l=c=>{Je("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=c,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((c=>l(c))),setTimeout((()=>{if(!this.appCheck){const c=this.V.getImmediate({optional:!0});c?l(c):Je("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new q2(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(kn(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new q2(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function MR(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<s;i++)t[i]=Math.floor(256*Math.random());return t}class Ey{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const l=MR(40);for(let c=0;c<l.length;++c)i.length<20&&l[c]<t&&(i+=e.charAt(l[c]%62))}return i}}function nn(s,e){return s<e?-1:s>e?1:0}function Rp(s,e){const t=Math.min(s.length,e.length);for(let i=0;i<t;i++){const l=s.charAt(i),c=e.charAt(i);if(l!==c)return $g(l)===$g(c)?nn(l,c):$g(l)?1:-1}return nn(s.length,e.length)}const DR=55296,LR=57343;function $g(s){const e=s.charCodeAt(0);return e>=DR&&e<=LR}function Kl(s,e,t){return s.length===e.length&&s.every(((i,l)=>t(i,e[l])))}const $2="__name__";class Ri{constructor(e,t,i){t===void 0?t=0:t>e.length&&jt(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&jt(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Ri.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ri?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let l=0;l<i;l++){const c=Ri.compareSegments(e.get(l),t.get(l));if(c!==0)return c}return nn(e.length,t.length)}static compareSegments(e,t){const i=Ri.isNumericId(e),l=Ri.isNumericId(t);return i&&!l?-1:!i&&l?1:i&&l?Ri.extractNumericId(e).compare(Ri.extractNumericId(t)):Rp(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return so.fromString(e.substring(4,e.length-2))}}class Dn extends Ri{construct(e,t,i){return new Dn(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new We(_e.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((l=>l.length>0)))}return new Dn(t)}static emptyPath(){return new Dn([])}}const PR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class zs extends Ri{construct(e,t,i){return new zs(e,t,i)}static isValidIdentifier(e){return PR.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),zs.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===$2}static keyField(){return new zs([$2])}static fromServerFormat(e){const t=[];let i="",l=0;const c=()=>{if(i.length===0)throw new We(_e.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let d=!1;for(;l<e.length;){const g=e[l];if(g==="\\"){if(l+1===e.length)throw new We(_e.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const y=e[l+1];if(y!=="\\"&&y!=="."&&y!=="`")throw new We(_e.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=y,l+=2}else g==="`"?(d=!d,l++):g!=="."||d?(i+=g,l++):(c(),l++)}if(c(),d)throw new We(_e.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new zs(t)}static emptyPath(){return new zs([])}}class ft{constructor(e){this.path=e}static fromPath(e){return new ft(Dn.fromString(e))}static fromName(e){return new ft(Dn.fromString(e).popFirst(5))}static empty(){return new ft(Dn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Dn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Dn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ft(new Dn(e.slice()))}}function G_(s,e,t){if(!t)throw new We(_e.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function OR(s,e,t,i){if(e===!0&&i===!0)throw new We(_e.INVALID_ARGUMENT,`${s} and ${t} cannot be used together.`)}function W2(s){if(!ft.isDocumentKey(s))throw new We(_e.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function G2(s){if(ft.isDocumentKey(s))throw new We(_e.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function K_(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function hf(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":jt(12329,{type:typeof s})}function cr(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new We(_e.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=hf(s);throw new We(_e.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return s}function ks(s,e){const t={typeString:s};return e&&(t.value=e),t}function zu(s,e){if(!K_(s))throw new We(_e.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const l=e[i].typeString,c="value"in e[i]?{value:e[i].value}:void 0;if(!(i in s)){t=`JSON missing required field: '${i}'`;break}const d=s[i];if(l&&typeof d!==l){t=`JSON field '${i}' must be a ${l}.`;break}if(c!==void 0&&d!==c.value){t=`Expected '${i}' field to equal '${c.value}'`;break}}if(t)throw new We(_e.INVALID_ARGUMENT,t);return!0}const K2=-62135596800,Y2=1e6;class Bt{static now(){return Bt.fromMillis(Date.now())}static fromDate(e){return Bt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*Y2);return new Bt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new We(_e.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new We(_e.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<K2)throw new We(_e.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new We(_e.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Y2}_compareTo(e){return this.seconds===e.seconds?nn(this.nanoseconds,e.nanoseconds):nn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Bt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(zu(e,Bt._jsonSchema))return new Bt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-K2;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Bt._jsonSchemaVersion="firestore/timestamp/1.0",Bt._jsonSchema={type:ks("string",Bt._jsonSchemaVersion),seconds:ks("number"),nanoseconds:ks("number")};class Dt{static fromTimestamp(e){return new Dt(e)}static min(){return new Dt(new Bt(0,0))}static max(){return new Dt(new Bt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Eu=-1;function VR(s,e){const t=s.toTimestamp().seconds,i=s.toTimestamp().nanoseconds+1,l=Dt.fromTimestamp(i===1e9?new Bt(t+1,0):new Bt(t,i));return new ao(l,ft.empty(),e)}function UR(s){return new ao(s.readTime,s.key,Eu)}class ao{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new ao(Dt.min(),ft.empty(),Eu)}static max(){return new ao(Dt.max(),ft.empty(),Eu)}}function BR(s,e){let t=s.readTime.compareTo(e.readTime);return t!==0?t:(t=ft.comparator(s.documentKey,e.documentKey),t!==0?t:nn(s.largestBatchId,e.largestBatchId))}const zR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class FR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function lc(s){if(s.code!==_e.FAILED_PRECONDITION||s.message!==zR)throw s;Je("LocalStore","Unexpectedly lost primary lease")}class Ne{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&jt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Ne(((i,l)=>{this.nextCallback=c=>{this.wrapSuccess(e,c).next(i,l)},this.catchCallback=c=>{this.wrapFailure(t,c).next(i,l)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Ne?t:Ne.resolve(t)}catch(t){return Ne.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Ne.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Ne.reject(t)}static resolve(e){return new Ne(((t,i)=>{t(e)}))}static reject(e){return new Ne(((t,i)=>{i(e)}))}static waitFor(e){return new Ne(((t,i)=>{let l=0,c=0,d=!1;e.forEach((g=>{++l,g.next((()=>{++c,d&&c===l&&t()}),(y=>i(y)))})),d=!0,c===l&&t()}))}static or(e){let t=Ne.resolve(!1);for(const i of e)t=t.next((l=>l?Ne.resolve(l):i()));return t}static forEach(e,t){const i=[];return e.forEach(((l,c)=>{i.push(t.call(this,l,c))})),this.waitFor(i)}static mapArray(e,t){return new Ne(((i,l)=>{const c=e.length,d=new Array(c);let g=0;for(let y=0;y<c;y++){const p=y;t(e[p]).next((b=>{d[p]=b,++g,g===c&&i(d)}),(b=>l(b)))}}))}static doWhile(e,t){return new Ne(((i,l)=>{const c=()=>{e()===!0?t().next((()=>{c()}),l):i()};c()}))}}function HR(s){const e=s.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function cc(s){return s.name==="IndexedDbTransactionError"}class ff{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}ff.ce=-1;const Ty=-1;function mf(s){return s==null}function $h(s){return s===0&&1/s==-1/0}function qR(s){return typeof s=="number"&&Number.isInteger(s)&&!$h(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}const Y_="";function $R(s){let e="";for(let t=0;t<s.length;t++)e.length>0&&(e=Q2(e)),e=WR(s.get(t),e);return Q2(e)}function WR(s,e){let t=e;const i=s.length;for(let l=0;l<i;l++){const c=s.charAt(l);switch(c){case"\0":t+="";break;case Y_:t+="";break;default:t+=c}}return t}function Q2(s){return s+Y_+""}function X2(s){let e=0;for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e++;return e}function mo(s,e){for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e(t,s[t])}function Q_(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}class Jn{constructor(e,t){this.comparator=e,this.root=t||Bs.EMPTY}insert(e,t){return new Jn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Bs.BLACK,null,null))}remove(e){return new Jn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Bs.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const l=this.comparator(e,i.key);if(l===0)return t+i.left.size;l<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new hh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new hh(this.root,e,this.comparator,!1)}getReverseIterator(){return new hh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new hh(this.root,e,this.comparator,!0)}}class hh{constructor(e,t,i,l){this.isReverse=l,this.nodeStack=[];let c=1;for(;!e.isEmpty();)if(c=t?i(e.key,t):1,t&&l&&(c*=-1),c<0)e=this.isReverse?e.left:e.right;else{if(c===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Bs{constructor(e,t,i,l,c){this.key=e,this.value=t,this.color=i??Bs.RED,this.left=l??Bs.EMPTY,this.right=c??Bs.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,l,c){return new Bs(e??this.key,t??this.value,i??this.color,l??this.left,c??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let l=this;const c=i(e,l.key);return l=c<0?l.copy(null,null,null,l.left.insert(e,t,i),null):c===0?l.copy(null,t,null,null,null):l.copy(null,null,null,null,l.right.insert(e,t,i)),l.fixUp()}removeMin(){if(this.left.isEmpty())return Bs.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,l=this;if(t(e,l.key)<0)l.left.isEmpty()||l.left.isRed()||l.left.left.isRed()||(l=l.moveRedLeft()),l=l.copy(null,null,null,l.left.remove(e,t),null);else{if(l.left.isRed()&&(l=l.rotateRight()),l.right.isEmpty()||l.right.isRed()||l.right.left.isRed()||(l=l.moveRedRight()),t(e,l.key)===0){if(l.right.isEmpty())return Bs.EMPTY;i=l.right.min(),l=l.copy(i.key,i.value,null,null,l.right.removeMin())}l=l.copy(null,null,null,null,l.right.remove(e,t))}return l.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Bs.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Bs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw jt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw jt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw jt(27949);return e+(this.isRed()?0:1)}}Bs.EMPTY=null,Bs.RED=!0,Bs.BLACK=!1;Bs.EMPTY=new class{constructor(){this.size=0}get key(){throw jt(57766)}get value(){throw jt(16141)}get color(){throw jt(16727)}get left(){throw jt(29726)}get right(){throw jt(36894)}copy(e,t,i,l,c){return this}insert(e,t,i){return new Bs(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Ts{constructor(e){this.comparator=e,this.data=new Jn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const l=i.getNext();if(this.comparator(l.key,e[1])>=0)return;t(l.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new J2(this.data.getIterator())}getIteratorFrom(e){return new J2(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Ts)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const l=t.getNext().key,c=i.getNext().key;if(this.comparator(l,c)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Ts(this.comparator);return t.data=e,t}}class J2{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Lr{constructor(e){this.fields=e,e.sort(zs.comparator)}static empty(){return new Lr([])}unionWith(e){let t=new Ts(zs.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Lr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Kl(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class X_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Fs{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(l){try{return atob(l)}catch(c){throw typeof DOMException<"u"&&c instanceof DOMException?new X_("Invalid base64 string: "+c):c}})(e);return new Fs(t)}static fromUint8Array(e){const t=(function(l){let c="";for(let d=0;d<l.length;++d)c+=String.fromCharCode(l[d]);return c})(e);return new Fs(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return nn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Fs.EMPTY_BYTE_STRING=new Fs("");const GR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function oo(s){if(kn(!!s,39018),typeof s=="string"){let e=0;const t=GR.exec(s);if(kn(!!t,46558,{timestamp:s}),t[1]){let l=t[1];l=(l+"000000000").substr(0,9),e=Number(l)}const i=new Date(s);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:hs(s.seconds),nanos:hs(s.nanos)}}function hs(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function lo(s){return typeof s=="string"?Fs.fromBase64String(s):Fs.fromUint8Array(s)}const J_="server_timestamp",Z_="__type__",ek="__previous_value__",tk="__local_write_time__";function Sy(s){return(s?.mapValue?.fields||{})[Z_]?.stringValue===J_}function gf(s){const e=s.mapValue.fields[ek];return Sy(e)?gf(e):e}function Tu(s){const e=oo(s.mapValue.fields[tk].timestampValue);return new Bt(e.seconds,e.nanos)}class KR{constructor(e,t,i,l,c,d,g,y,p,b,_){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=l,this.ssl=c,this.forceLongPolling=d,this.autoDetectLongPolling=g,this.longPollingOptions=y,this.useFetchStreams=p,this.isUsingEmulator=b,this.apiKey=_}}const Wh="(default)";class Su{constructor(e,t){this.projectId=e,this.database=t||Wh}static empty(){return new Su("","")}get isDefaultDatabase(){return this.database===Wh}isEqual(e){return e instanceof Su&&e.projectId===this.projectId&&e.database===this.database}}function YR(s,e){if(!Object.prototype.hasOwnProperty.apply(s.options,["projectId"]))throw new We(_e.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Su(s.options.projectId,e)}const nk="__type__",QR="__max__",fh={mapValue:{}},sk="__vector__",Gh="value";function co(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?Sy(s)?4:JR(s)?9007199254740991:XR(s)?10:11:jt(28295,{value:s})}function Oi(s,e){if(s===e)return!0;const t=co(s);if(t!==co(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return Tu(s).isEqual(Tu(e));case 3:return(function(l,c){if(typeof l.timestampValue=="string"&&typeof c.timestampValue=="string"&&l.timestampValue.length===c.timestampValue.length)return l.timestampValue===c.timestampValue;const d=oo(l.timestampValue),g=oo(c.timestampValue);return d.seconds===g.seconds&&d.nanos===g.nanos})(s,e);case 5:return s.stringValue===e.stringValue;case 6:return(function(l,c){return lo(l.bytesValue).isEqual(lo(c.bytesValue))})(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return(function(l,c){return hs(l.geoPointValue.latitude)===hs(c.geoPointValue.latitude)&&hs(l.geoPointValue.longitude)===hs(c.geoPointValue.longitude)})(s,e);case 2:return(function(l,c){if("integerValue"in l&&"integerValue"in c)return hs(l.integerValue)===hs(c.integerValue);if("doubleValue"in l&&"doubleValue"in c){const d=hs(l.doubleValue),g=hs(c.doubleValue);return d===g?$h(d)===$h(g):isNaN(d)&&isNaN(g)}return!1})(s,e);case 9:return Kl(s.arrayValue.values||[],e.arrayValue.values||[],Oi);case 10:case 11:return(function(l,c){const d=l.mapValue.fields||{},g=c.mapValue.fields||{};if(X2(d)!==X2(g))return!1;for(const y in d)if(d.hasOwnProperty(y)&&(g[y]===void 0||!Oi(d[y],g[y])))return!1;return!0})(s,e);default:return jt(52216,{left:s})}}function Cu(s,e){return(s.values||[]).find((t=>Oi(t,e)))!==void 0}function Yl(s,e){if(s===e)return 0;const t=co(s),i=co(e);if(t!==i)return nn(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return nn(s.booleanValue,e.booleanValue);case 2:return(function(c,d){const g=hs(c.integerValue||c.doubleValue),y=hs(d.integerValue||d.doubleValue);return g<y?-1:g>y?1:g===y?0:isNaN(g)?isNaN(y)?0:-1:1})(s,e);case 3:return Z2(s.timestampValue,e.timestampValue);case 4:return Z2(Tu(s),Tu(e));case 5:return Rp(s.stringValue,e.stringValue);case 6:return(function(c,d){const g=lo(c),y=lo(d);return g.compareTo(y)})(s.bytesValue,e.bytesValue);case 7:return(function(c,d){const g=c.split("/"),y=d.split("/");for(let p=0;p<g.length&&p<y.length;p++){const b=nn(g[p],y[p]);if(b!==0)return b}return nn(g.length,y.length)})(s.referenceValue,e.referenceValue);case 8:return(function(c,d){const g=nn(hs(c.latitude),hs(d.latitude));return g!==0?g:nn(hs(c.longitude),hs(d.longitude))})(s.geoPointValue,e.geoPointValue);case 9:return ew(s.arrayValue,e.arrayValue);case 10:return(function(c,d){const g=c.fields||{},y=d.fields||{},p=g[Gh]?.arrayValue,b=y[Gh]?.arrayValue,_=nn(p?.values?.length||0,b?.values?.length||0);return _!==0?_:ew(p,b)})(s.mapValue,e.mapValue);case 11:return(function(c,d){if(c===fh.mapValue&&d===fh.mapValue)return 0;if(c===fh.mapValue)return 1;if(d===fh.mapValue)return-1;const g=c.fields||{},y=Object.keys(g),p=d.fields||{},b=Object.keys(p);y.sort(),b.sort();for(let _=0;_<y.length&&_<b.length;++_){const j=Rp(y[_],b[_]);if(j!==0)return j;const I=Yl(g[y[_]],p[b[_]]);if(I!==0)return I}return nn(y.length,b.length)})(s.mapValue,e.mapValue);default:throw jt(23264,{he:t})}}function Z2(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return nn(s,e);const t=oo(s),i=oo(e),l=nn(t.seconds,i.seconds);return l!==0?l:nn(t.nanos,i.nanos)}function ew(s,e){const t=s.values||[],i=e.values||[];for(let l=0;l<t.length&&l<i.length;++l){const c=Yl(t[l],i[l]);if(c)return c}return nn(t.length,i.length)}function Ql(s){return Ip(s)}function Ip(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?(function(t){const i=oo(t);return`time(${i.seconds},${i.nanos})`})(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?(function(t){return lo(t).toBase64()})(s.bytesValue):"referenceValue"in s?(function(t){return ft.fromName(t).toString()})(s.referenceValue):"geoPointValue"in s?(function(t){return`geo(${t.latitude},${t.longitude})`})(s.geoPointValue):"arrayValue"in s?(function(t){let i="[",l=!0;for(const c of t.values||[])l?l=!1:i+=",",i+=Ip(c);return i+"]"})(s.arrayValue):"mapValue"in s?(function(t){const i=Object.keys(t.fields||{}).sort();let l="{",c=!0;for(const d of i)c?c=!1:l+=",",l+=`${d}:${Ip(t.fields[d])}`;return l+"}"})(s.mapValue):jt(61005,{value:s})}function Ah(s){switch(co(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=gf(s);return e?16+Ah(e):16;case 5:return 2*s.stringValue.length;case 6:return lo(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((l,c)=>l+Ah(c)),0)})(s.arrayValue);case 10:case 11:return(function(i){let l=0;return mo(i.fields,((c,d)=>{l+=c.length+Ah(d)})),l})(s.mapValue);default:throw jt(13486,{value:s})}}function tw(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function Mp(s){return!!s&&"integerValue"in s}function Cy(s){return!!s&&"arrayValue"in s}function nw(s){return!!s&&"nullValue"in s}function sw(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function Rh(s){return!!s&&"mapValue"in s}function XR(s){return(s?.mapValue?.fields||{})[nk]?.stringValue===sk}function gu(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return mo(s.mapValue.fields,((t,i)=>e.mapValue.fields[t]=gu(i))),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(s.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=gu(s.arrayValue.values[t]);return e}return{...s}}function JR(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===QR}class wr{constructor(e){this.value=e}static empty(){return new wr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Rh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=gu(t)}setAll(e){let t=zs.emptyPath(),i={},l=[];e.forEach(((d,g)=>{if(!t.isImmediateParentOf(g)){const y=this.getFieldsMap(t);this.applyChanges(y,i,l),i={},l=[],t=g.popLast()}d?i[g.lastSegment()]=gu(d):l.push(g.lastSegment())}));const c=this.getFieldsMap(t);this.applyChanges(c,i,l)}delete(e){const t=this.field(e.popLast());Rh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Oi(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let l=t.mapValue.fields[e.get(i)];Rh(l)&&l.mapValue.fields||(l={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=l),t=l}return t.mapValue.fields}applyChanges(e,t,i){mo(t,((l,c)=>e[l]=c));for(const l of i)delete e[l]}clone(){return new wr(gu(this.value))}}function rk(s){const e=[];return mo(s.fields,((t,i)=>{const l=new zs([t]);if(Rh(i)){const c=rk(i.mapValue).fields;if(c.length===0)e.push(l);else for(const d of c)e.push(l.child(d))}else e.push(l)})),new Lr(e)}class Js{constructor(e,t,i,l,c,d,g){this.key=e,this.documentType=t,this.version=i,this.readTime=l,this.createTime=c,this.data=d,this.documentState=g}static newInvalidDocument(e){return new Js(e,0,Dt.min(),Dt.min(),Dt.min(),wr.empty(),0)}static newFoundDocument(e,t,i,l){return new Js(e,1,t,Dt.min(),i,l,0)}static newNoDocument(e,t){return new Js(e,2,t,Dt.min(),Dt.min(),wr.empty(),0)}static newUnknownDocument(e,t){return new Js(e,3,t,Dt.min(),Dt.min(),wr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Dt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=wr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=wr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Dt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Js&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Js(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Kh{constructor(e,t){this.position=e,this.inclusive=t}}function rw(s,e,t){let i=0;for(let l=0;l<s.position.length;l++){const c=e[l],d=s.position[l];if(c.field.isKeyField()?i=ft.comparator(ft.fromName(d.referenceValue),t.key):i=Yl(d,t.data.field(c.field)),c.dir==="desc"&&(i*=-1),i!==0)break}return i}function iw(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let t=0;t<s.position.length;t++)if(!Oi(s.position[t],e.position[t]))return!1;return!0}class Nu{constructor(e,t="asc"){this.field=e,this.dir=t}}function ZR(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}class ik{}class ws extends ik{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new tI(e,t,i):t==="array-contains"?new rI(e,i):t==="in"?new iI(e,i):t==="not-in"?new aI(e,i):t==="array-contains-any"?new oI(e,i):new ws(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new nI(e,i):new sI(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Yl(t,this.value)):t!==null&&co(this.value)===co(t)&&this.matchesComparison(Yl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return jt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class vi extends ik{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new vi(e,t)}matches(e){return ak(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function ak(s){return s.op==="and"}function ok(s){return eI(s)&&ak(s)}function eI(s){for(const e of s.filters)if(e instanceof vi)return!1;return!0}function Dp(s){if(s instanceof ws)return s.field.canonicalString()+s.op.toString()+Ql(s.value);if(ok(s))return s.filters.map((e=>Dp(e))).join(",");{const e=s.filters.map((t=>Dp(t))).join(",");return`${s.op}(${e})`}}function lk(s,e){return s instanceof ws?(function(i,l){return l instanceof ws&&i.op===l.op&&i.field.isEqual(l.field)&&Oi(i.value,l.value)})(s,e):s instanceof vi?(function(i,l){return l instanceof vi&&i.op===l.op&&i.filters.length===l.filters.length?i.filters.reduce(((c,d,g)=>c&&lk(d,l.filters[g])),!0):!1})(s,e):void jt(19439)}function ck(s){return s instanceof ws?(function(t){return`${t.field.canonicalString()} ${t.op} ${Ql(t.value)}`})(s):s instanceof vi?(function(t){return t.op.toString()+" {"+t.getFilters().map(ck).join(" ,")+"}"})(s):"Filter"}class tI extends ws{constructor(e,t,i){super(e,t,i),this.key=ft.fromName(i.referenceValue)}matches(e){const t=ft.comparator(e.key,this.key);return this.matchesComparison(t)}}class nI extends ws{constructor(e,t){super(e,"in",t),this.keys=uk("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class sI extends ws{constructor(e,t){super(e,"not-in",t),this.keys=uk("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function uk(s,e){return(e.arrayValue?.values||[]).map((t=>ft.fromName(t.referenceValue)))}class rI extends ws{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Cy(t)&&Cu(t.arrayValue,this.value)}}class iI extends ws{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Cu(this.value.arrayValue,t)}}class aI extends ws{constructor(e,t){super(e,"not-in",t)}matches(e){if(Cu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Cu(this.value.arrayValue,t)}}class oI extends ws{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Cy(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Cu(this.value.arrayValue,i)))}}class lI{constructor(e,t=null,i=[],l=[],c=null,d=null,g=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=l,this.limit=c,this.startAt=d,this.endAt=g,this.Te=null}}function aw(s,e=null,t=[],i=[],l=null,c=null,d=null){return new lI(s,e,t,i,l,c,d)}function Ny(s){const e=Pt(s);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>Dp(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(c){return c.field.canonicalString()+c.dir})(i))).join(","),mf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Ql(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Ql(i))).join(",")),e.Te=t}return e.Te}function Ay(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<s.orderBy.length;t++)if(!ZR(s.orderBy[t],e.orderBy[t]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let t=0;t<s.filters.length;t++)if(!lk(s.filters[t],e.filters[t]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!iw(s.startAt,e.startAt)&&iw(s.endAt,e.endAt)}function Lp(s){return ft.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}class uc{constructor(e,t=null,i=[],l=[],c=null,d="F",g=null,y=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=l,this.limit=c,this.limitType=d,this.startAt=g,this.endAt=y,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function cI(s,e,t,i,l,c,d,g){return new uc(s,e,t,i,l,c,d,g)}function pf(s){return new uc(s)}function ow(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function uI(s){return ft.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}function dk(s){return s.collectionGroup!==null}function pu(s){const e=Pt(s);if(e.Ie===null){e.Ie=[];const t=new Set;for(const c of e.explicitOrderBy)e.Ie.push(c),t.add(c.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let g=new Ts(zs.comparator);return d.filters.forEach((y=>{y.getFlattenedFilters().forEach((p=>{p.isInequality()&&(g=g.add(p.field))}))})),g})(e).forEach((c=>{t.has(c.canonicalString())||c.isKeyField()||e.Ie.push(new Nu(c,i))})),t.has(zs.keyField().canonicalString())||e.Ie.push(new Nu(zs.keyField(),i))}return e.Ie}function Di(s){const e=Pt(s);return e.Ee||(e.Ee=dI(e,pu(s))),e.Ee}function dI(s,e){if(s.limitType==="F")return aw(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map((l=>{const c=l.dir==="desc"?"asc":"desc";return new Nu(l.field,c)}));const t=s.endAt?new Kh(s.endAt.position,s.endAt.inclusive):null,i=s.startAt?new Kh(s.startAt.position,s.startAt.inclusive):null;return aw(s.path,s.collectionGroup,e,s.filters,s.limit,t,i)}}function Pp(s,e){const t=s.filters.concat([e]);return new uc(s.path,s.collectionGroup,s.explicitOrderBy.slice(),t,s.limit,s.limitType,s.startAt,s.endAt)}function hI(s,e){const t=s.explicitOrderBy.concat([e]);return new uc(s.path,s.collectionGroup,t,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}function Op(s,e,t){return new uc(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,t,s.startAt,s.endAt)}function yf(s,e){return Ay(Di(s),Di(e))&&s.limitType===e.limitType}function hk(s){return`${Ny(Di(s))}|lt:${s.limitType}`}function Vl(s){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((l=>ck(l))).join(", ")}]`),mf(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((l=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(l))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((l=>Ql(l))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((l=>Ql(l))).join(",")),`Target(${i})`})(Di(s))}; limitType=${s.limitType})`}function vf(s,e){return e.isFoundDocument()&&(function(i,l){const c=l.key.path;return i.collectionGroup!==null?l.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(c):ft.isDocumentKey(i.path)?i.path.isEqual(c):i.path.isImmediateParentOf(c)})(s,e)&&(function(i,l){for(const c of pu(i))if(!c.field.isKeyField()&&l.data.field(c.field)===null)return!1;return!0})(s,e)&&(function(i,l){for(const c of i.filters)if(!c.matches(l))return!1;return!0})(s,e)&&(function(i,l){return!(i.startAt&&!(function(d,g,y){const p=rw(d,g,y);return d.inclusive?p<=0:p<0})(i.startAt,pu(i),l)||i.endAt&&!(function(d,g,y){const p=rw(d,g,y);return d.inclusive?p>=0:p>0})(i.endAt,pu(i),l))})(s,e)}function fI(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function fk(s){return(e,t)=>{let i=!1;for(const l of pu(s)){const c=mI(l,e,t);if(c!==0)return c;i=i||l.field.isKeyField()}return 0}}function mI(s,e,t){const i=s.field.isKeyField()?ft.comparator(e.key,t.key):(function(c,d,g){const y=d.data.field(c),p=g.data.field(c);return y!==null&&p!==null?Yl(y,p):jt(42886)})(s.field,e,t);switch(s.dir){case"asc":return i;case"desc":return-1*i;default:return jt(19790,{direction:s.dir})}}class Jo{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[l,c]of i)if(this.equalsFn(l,e))return c}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),l=this.inner[i];if(l===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let c=0;c<l.length;c++)if(this.equalsFn(l[c][0],e))return void(l[c]=[e,t]);l.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let l=0;l<i.length;l++)if(this.equalsFn(i[l][0],e))return i.length===1?delete this.inner[t]:i.splice(l,1),this.innerSize--,!0;return!1}forEach(e){mo(this.inner,((t,i)=>{for(const[l,c]of i)e(l,c)}))}isEmpty(){return Q_(this.inner)}size(){return this.innerSize}}const gI=new Jn(ft.comparator);function xa(){return gI}const mk=new Jn(ft.comparator);function cu(...s){let e=mk;for(const t of s)e=e.insert(t.key,t);return e}function gk(s){let e=mk;return s.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Oo(){return yu()}function pk(){return yu()}function yu(){return new Jo((s=>s.toString()),((s,e)=>s.isEqual(e)))}const pI=new Jn(ft.comparator),yI=new Ts(ft.comparator);function sn(...s){let e=yI;for(const t of s)e=e.add(t);return e}const vI=new Ts(nn);function bI(){return vI}function Ry(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:$h(e)?"-0":e}}function yk(s){return{integerValue:""+s}}function vk(s,e){return qR(e)?yk(e):Ry(s,e)}class bf{constructor(){this._=void 0}}function wI(s,e,t){return s instanceof Au?(function(l,c){const d={fields:{[Z_]:{stringValue:J_},[tk]:{timestampValue:{seconds:l.seconds,nanos:l.nanoseconds}}}};return c&&Sy(c)&&(c=gf(c)),c&&(d.fields[ek]=c),{mapValue:d}})(t,e):s instanceof Xl?wk(s,e):s instanceof Jl?xk(s,e):(function(l,c){const d=bk(l,c),g=lw(d)+lw(l.Ae);return Mp(d)&&Mp(l.Ae)?yk(g):Ry(l.serializer,g)})(s,e)}function xI(s,e,t){return s instanceof Xl?wk(s,e):s instanceof Jl?xk(s,e):t}function bk(s,e){return s instanceof Ru?(function(i){return Mp(i)||(function(c){return!!c&&"doubleValue"in c})(i)})(e)?e:{integerValue:0}:null}class Au extends bf{}class Xl extends bf{constructor(e){super(),this.elements=e}}function wk(s,e){const t=_k(e);for(const i of s.elements)t.some((l=>Oi(l,i)))||t.push(i);return{arrayValue:{values:t}}}class Jl extends bf{constructor(e){super(),this.elements=e}}function xk(s,e){let t=_k(e);for(const i of s.elements)t=t.filter((l=>!Oi(l,i)));return{arrayValue:{values:t}}}class Ru extends bf{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function lw(s){return hs(s.integerValue||s.doubleValue)}function _k(s){return Cy(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}class wf{constructor(e,t){this.field=e,this.transform=t}}function _I(s,e){return s.field.isEqual(e.field)&&(function(i,l){return i instanceof Xl&&l instanceof Xl||i instanceof Jl&&l instanceof Jl?Kl(i.elements,l.elements,Oi):i instanceof Ru&&l instanceof Ru?Oi(i.Ae,l.Ae):i instanceof Au&&l instanceof Au})(s.transform,e.transform)}class kI{constructor(e,t){this.version=e,this.transformResults=t}}class ur{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ur}static exists(e){return new ur(void 0,e)}static updateTime(e){return new ur(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ih(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class xf{}function kk(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new _f(s.key,ur.none()):new Fu(s.key,s.data,ur.none());{const t=s.data,i=wr.empty();let l=new Ts(zs.comparator);for(let c of e.fields)if(!l.has(c)){let d=t.field(c);d===null&&c.length>1&&(c=c.popLast(),d=t.field(c)),d===null?i.delete(c):i.set(c,d),l=l.add(c)}return new go(s.key,i,new Lr(l.toArray()),ur.none())}}function jI(s,e,t){s instanceof Fu?(function(l,c,d){const g=l.value.clone(),y=uw(l.fieldTransforms,c,d.transformResults);g.setAll(y),c.convertToFoundDocument(d.version,g).setHasCommittedMutations()})(s,e,t):s instanceof go?(function(l,c,d){if(!Ih(l.precondition,c))return void c.convertToUnknownDocument(d.version);const g=uw(l.fieldTransforms,c,d.transformResults),y=c.data;y.setAll(jk(l)),y.setAll(g),c.convertToFoundDocument(d.version,y).setHasCommittedMutations()})(s,e,t):(function(l,c,d){c.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function vu(s,e,t,i){return s instanceof Fu?(function(c,d,g,y){if(!Ih(c.precondition,d))return g;const p=c.value.clone(),b=dw(c.fieldTransforms,y,d);return p.setAll(b),d.convertToFoundDocument(d.version,p).setHasLocalMutations(),null})(s,e,t,i):s instanceof go?(function(c,d,g,y){if(!Ih(c.precondition,d))return g;const p=dw(c.fieldTransforms,y,d),b=d.data;return b.setAll(jk(c)),b.setAll(p),d.convertToFoundDocument(d.version,b).setHasLocalMutations(),g===null?null:g.unionWith(c.fieldMask.fields).unionWith(c.fieldTransforms.map((_=>_.field)))})(s,e,t,i):(function(c,d,g){return Ih(c.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):g})(s,e,t)}function EI(s,e){let t=null;for(const i of s.fieldTransforms){const l=e.data.field(i.field),c=bk(i.transform,l||null);c!=null&&(t===null&&(t=wr.empty()),t.set(i.field,c))}return t||null}function cw(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!(function(i,l){return i===void 0&&l===void 0||!(!i||!l)&&Kl(i,l,((c,d)=>_I(c,d)))})(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class Fu extends xf{constructor(e,t,i,l=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=l,this.type=0}getFieldMask(){return null}}class go extends xf{constructor(e,t,i,l,c=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=l,this.fieldTransforms=c,this.type=1}getFieldMask(){return this.fieldMask}}function jk(s){const e=new Map;return s.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=s.data.field(t);e.set(t,i)}})),e}function uw(s,e,t){const i=new Map;kn(s.length===t.length,32656,{Ve:t.length,de:s.length});for(let l=0;l<t.length;l++){const c=s[l],d=c.transform,g=e.data.field(c.field);i.set(c.field,xI(d,g,t[l]))}return i}function dw(s,e,t){const i=new Map;for(const l of s){const c=l.transform,d=t.data.field(l.field);i.set(l.field,wI(c,d,e))}return i}class _f extends xf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class TI extends xf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class SI{constructor(e,t,i,l){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=l}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let l=0;l<this.mutations.length;l++){const c=this.mutations[l];c.key.isEqual(e.key)&&jI(c,e,i[l])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=vu(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=vu(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=pk();return this.mutations.forEach((l=>{const c=e.get(l.key),d=c.overlayedDocument;let g=this.applyToLocalView(d,c.mutatedFields);g=t.has(l.key)?null:g;const y=kk(d,g);y!==null&&i.set(l.key,y),d.isValidDocument()||d.convertToNoDocument(Dt.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),sn())}isEqual(e){return this.batchId===e.batchId&&Kl(this.mutations,e.mutations,((t,i)=>cw(t,i)))&&Kl(this.baseMutations,e.baseMutations,((t,i)=>cw(t,i)))}}class Iy{constructor(e,t,i,l){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=l}static from(e,t,i){kn(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let l=(function(){return pI})();const c=e.mutations;for(let d=0;d<c.length;d++)l=l.insert(c[d].key,i[d].version);return new Iy(e,t,i,l)}}class CI{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class NI{constructor(e,t){this.count=e,this.unchangedNames=t}}var bs,cn;function AI(s){switch(s){case _e.OK:return jt(64938);case _e.CANCELLED:case _e.UNKNOWN:case _e.DEADLINE_EXCEEDED:case _e.RESOURCE_EXHAUSTED:case _e.INTERNAL:case _e.UNAVAILABLE:case _e.UNAUTHENTICATED:return!1;case _e.INVALID_ARGUMENT:case _e.NOT_FOUND:case _e.ALREADY_EXISTS:case _e.PERMISSION_DENIED:case _e.FAILED_PRECONDITION:case _e.ABORTED:case _e.OUT_OF_RANGE:case _e.UNIMPLEMENTED:case _e.DATA_LOSS:return!0;default:return jt(15467,{code:s})}}function Ek(s){if(s===void 0)return wa("GRPC error has no .code"),_e.UNKNOWN;switch(s){case bs.OK:return _e.OK;case bs.CANCELLED:return _e.CANCELLED;case bs.UNKNOWN:return _e.UNKNOWN;case bs.DEADLINE_EXCEEDED:return _e.DEADLINE_EXCEEDED;case bs.RESOURCE_EXHAUSTED:return _e.RESOURCE_EXHAUSTED;case bs.INTERNAL:return _e.INTERNAL;case bs.UNAVAILABLE:return _e.UNAVAILABLE;case bs.UNAUTHENTICATED:return _e.UNAUTHENTICATED;case bs.INVALID_ARGUMENT:return _e.INVALID_ARGUMENT;case bs.NOT_FOUND:return _e.NOT_FOUND;case bs.ALREADY_EXISTS:return _e.ALREADY_EXISTS;case bs.PERMISSION_DENIED:return _e.PERMISSION_DENIED;case bs.FAILED_PRECONDITION:return _e.FAILED_PRECONDITION;case bs.ABORTED:return _e.ABORTED;case bs.OUT_OF_RANGE:return _e.OUT_OF_RANGE;case bs.UNIMPLEMENTED:return _e.UNIMPLEMENTED;case bs.DATA_LOSS:return _e.DATA_LOSS;default:return jt(39323,{code:s})}}(cn=bs||(bs={}))[cn.OK=0]="OK",cn[cn.CANCELLED=1]="CANCELLED",cn[cn.UNKNOWN=2]="UNKNOWN",cn[cn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",cn[cn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",cn[cn.NOT_FOUND=5]="NOT_FOUND",cn[cn.ALREADY_EXISTS=6]="ALREADY_EXISTS",cn[cn.PERMISSION_DENIED=7]="PERMISSION_DENIED",cn[cn.UNAUTHENTICATED=16]="UNAUTHENTICATED",cn[cn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",cn[cn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",cn[cn.ABORTED=10]="ABORTED",cn[cn.OUT_OF_RANGE=11]="OUT_OF_RANGE",cn[cn.UNIMPLEMENTED=12]="UNIMPLEMENTED",cn[cn.INTERNAL=13]="INTERNAL",cn[cn.UNAVAILABLE=14]="UNAVAILABLE",cn[cn.DATA_LOSS=15]="DATA_LOSS";function RI(){return new TextEncoder}const II=new so([4294967295,4294967295],0);function hw(s){const e=RI().encode(s),t=new U_;return t.update(e),new Uint8Array(t.digest())}function fw(s){const e=new DataView(s.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),l=e.getUint32(8,!0),c=e.getUint32(12,!0);return[new so([t,i],0),new so([l,c],0)]}class My{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new uu(`Invalid padding: ${t}`);if(i<0)throw new uu(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new uu(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new uu(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=so.fromNumber(this.ge)}ye(e,t,i){let l=e.add(t.multiply(so.fromNumber(i)));return l.compare(II)===1&&(l=new so([l.getBits(0),l.getBits(1)],0)),l.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=hw(e),[i,l]=fw(t);for(let c=0;c<this.hashCount;c++){const d=this.ye(i,l,c);if(!this.we(d))return!1}return!0}static create(e,t,i){const l=e%8==0?0:8-e%8,c=new Uint8Array(Math.ceil(e/8)),d=new My(c,l,t);return i.forEach((g=>d.insert(g))),d}insert(e){if(this.ge===0)return;const t=hw(e),[i,l]=fw(t);for(let c=0;c<this.hashCount;c++){const d=this.ye(i,l,c);this.be(d)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class uu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class kf{constructor(e,t,i,l,c){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=l,this.resolvedLimboDocuments=c}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const l=new Map;return l.set(e,Hu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new kf(Dt.min(),l,new Jn(nn),xa(),sn())}}class Hu{constructor(e,t,i,l,c){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=l,this.removedDocuments=c}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Hu(i,t,sn(),sn(),sn())}}class Mh{constructor(e,t,i,l){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=l}}class Tk{constructor(e,t){this.targetId=e,this.Ce=t}}class Sk{constructor(e,t,i=Fs.EMPTY_BYTE_STRING,l=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=l}}class mw{constructor(){this.ve=0,this.Fe=gw(),this.Me=Fs.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=sn(),t=sn(),i=sn();return this.Fe.forEach(((l,c)=>{switch(c){case 0:e=e.add(l);break;case 2:t=t.add(l);break;case 1:i=i.add(l);break;default:jt(38017,{changeType:c})}})),new Hu(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=gw()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,kn(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class MI{constructor(e){this.Ge=e,this.ze=new Map,this.je=xa(),this.He=mh(),this.Je=mh(),this.Ze=new Jn(nn)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:jt(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,l)=>{this.rt(l)&&t(l)}))}st(e){const t=e.targetId,i=e.Ce.count,l=this.ot(t);if(l){const c=l.target;if(Lp(c))if(i===0){const d=new ft(c.path);this.et(t,d,Js.newNoDocument(d,Dt.min()))}else kn(i===1,20013,{expectedCount:i});else{const d=this._t(t);if(d!==i){const g=this.ut(e),y=g?this.ct(g,e,d):1;if(y!==0){this.it(t);const p=y===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,p)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:l=0},hashCount:c=0}=t;let d,g;try{d=lo(i).toUint8Array()}catch(y){if(y instanceof X_)return Gl("Decoding the base64 bloom filter in existence filter failed ("+y.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw y}try{g=new My(d,l,c)}catch(y){return Gl(y instanceof uu?"BloomFilter error: ":"Applying bloom filter failed: ",y),null}return g.ge===0?null:g}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let l=0;return i.forEach((c=>{const d=this.Ge.ht(),g=`projects/${d.projectId}/databases/${d.database}/documents/${c.path.canonicalString()}`;e.mightContain(g)||(this.et(t,c,null),l++)})),l}Tt(e){const t=new Map;this.ze.forEach(((c,d)=>{const g=this.ot(d);if(g){if(c.current&&Lp(g.target)){const y=new ft(g.target.path);this.It(y).has(d)||this.Et(d,y)||this.et(d,y,Js.newNoDocument(y,e))}c.Be&&(t.set(d,c.ke()),c.Ke())}}));let i=sn();this.Je.forEach(((c,d)=>{let g=!0;d.forEachWhile((y=>{const p=this.ot(y);return!p||p.purpose==="TargetPurposeLimboResolution"||(g=!1,!1)})),g&&(i=i.add(c))})),this.je.forEach(((c,d)=>d.setReadTime(e)));const l=new kf(e,t,this.Ze,this.je,i);return this.je=xa(),this.He=mh(),this.Je=mh(),this.Ze=new Jn(nn),l}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const l=this.nt(e);this.Et(e,t)?l.qe(t,1):l.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new mw,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Ts(nn),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Ts(nn),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Je("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new mw),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function mh(){return new Jn(ft.comparator)}function gw(){return new Jn(ft.comparator)}const DI={asc:"ASCENDING",desc:"DESCENDING"},LI={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},PI={and:"AND",or:"OR"};class OI{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Vp(s,e){return s.useProto3Json||mf(e)?e:{value:e}}function Yh(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ck(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function VI(s,e){return Yh(s,e.toTimestamp())}function Li(s){return kn(!!s,49232),Dt.fromTimestamp((function(t){const i=oo(t);return new Bt(i.seconds,i.nanos)})(s))}function Dy(s,e){return Up(s,e).canonicalString()}function Up(s,e){const t=(function(l){return new Dn(["projects",l.projectId,"databases",l.database])})(s).child("documents");return e===void 0?t:t.child(e)}function Nk(s){const e=Dn.fromString(s);return kn(Dk(e),10190,{key:e.toString()}),e}function Bp(s,e){return Dy(s.databaseId,e.path)}function Wg(s,e){const t=Nk(e);if(t.get(1)!==s.databaseId.projectId)throw new We(_e.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+s.databaseId.projectId);if(t.get(3)!==s.databaseId.database)throw new We(_e.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+s.databaseId.database);return new ft(Rk(t))}function Ak(s,e){return Dy(s.databaseId,e)}function UI(s){const e=Nk(s);return e.length===4?Dn.emptyPath():Rk(e)}function zp(s){return new Dn(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function Rk(s){return kn(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function pw(s,e,t){return{name:Bp(s,e),fields:t.value.mapValue.fields}}function BI(s,e){let t;if("targetChange"in e){e.targetChange;const i=(function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:jt(39313,{state:p})})(e.targetChange.targetChangeType||"NO_CHANGE"),l=e.targetChange.targetIds||[],c=(function(p,b){return p.useProto3Json?(kn(b===void 0||typeof b=="string",58123),Fs.fromBase64String(b||"")):(kn(b===void 0||b instanceof Buffer||b instanceof Uint8Array,16193),Fs.fromUint8Array(b||new Uint8Array))})(s,e.targetChange.resumeToken),d=e.targetChange.cause,g=d&&(function(p){const b=p.code===void 0?_e.UNKNOWN:Ek(p.code);return new We(b,p.message||"")})(d);t=new Sk(i,l,c,g||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const l=Wg(s,i.document.name),c=Li(i.document.updateTime),d=i.document.createTime?Li(i.document.createTime):Dt.min(),g=new wr({mapValue:{fields:i.document.fields}}),y=Js.newFoundDocument(l,c,d,g),p=i.targetIds||[],b=i.removedTargetIds||[];t=new Mh(p,b,y.key,y)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const l=Wg(s,i.document),c=i.readTime?Li(i.readTime):Dt.min(),d=Js.newNoDocument(l,c),g=i.removedTargetIds||[];t=new Mh([],g,d.key,d)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const l=Wg(s,i.document),c=i.removedTargetIds||[];t=new Mh([],c,l,null)}else{if(!("filter"in e))return jt(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:l=0,unchangedNames:c}=i,d=new NI(l,c),g=i.targetId;t=new Tk(g,d)}}return t}function zI(s,e){let t;if(e instanceof Fu)t={update:pw(s,e.key,e.value)};else if(e instanceof _f)t={delete:Bp(s,e.key)};else if(e instanceof go)t={update:pw(s,e.key,e.data),updateMask:QI(e.fieldMask)};else{if(!(e instanceof TI))return jt(16599,{dt:e.type});t={verify:Bp(s,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(c,d){const g=d.transform;if(g instanceof Au)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(g instanceof Xl)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:g.elements}};if(g instanceof Jl)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:g.elements}};if(g instanceof Ru)return{fieldPath:d.field.canonicalString(),increment:g.Ae};throw jt(20930,{transform:d.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(l,c){return c.updateTime!==void 0?{updateTime:VI(l,c.updateTime)}:c.exists!==void 0?{exists:c.exists}:jt(27497)})(s,e.precondition)),t}function FI(s,e){return s&&s.length>0?(kn(e!==void 0,14353),s.map((t=>(function(l,c){let d=l.updateTime?Li(l.updateTime):Li(c);return d.isEqual(Dt.min())&&(d=Li(c)),new kI(d,l.transformResults||[])})(t,e)))):[]}function HI(s,e){return{documents:[Ak(s,e.path)]}}function qI(s,e){const t={structuredQuery:{}},i=e.path;let l;e.collectionGroup!==null?(l=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(l=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=Ak(s,l);const c=(function(p){if(p.length!==0)return Mk(vi.create(p,"and"))})(e.filters);c&&(t.structuredQuery.where=c);const d=(function(p){if(p.length!==0)return p.map((b=>(function(j){return{field:Ul(j.field),direction:GI(j.dir)}})(b)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const g=Vp(s,e.limit);return g!==null&&(t.structuredQuery.limit=g),e.startAt&&(t.structuredQuery.startAt=(function(p){return{before:p.inclusive,values:p.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(p){return{before:!p.inclusive,values:p.position}})(e.endAt)),{ft:t,parent:l}}function $I(s){let e=UI(s.parent);const t=s.structuredQuery,i=t.from?t.from.length:0;let l=null;if(i>0){kn(i===1,65062);const b=t.from[0];b.allDescendants?l=b.collectionId:e=e.child(b.collectionId)}let c=[];t.where&&(c=(function(_){const j=Ik(_);return j instanceof vi&&ok(j)?j.getFilters():[j]})(t.where));let d=[];t.orderBy&&(d=(function(_){return _.map((j=>(function(F){return new Nu(Bl(F.field),(function(B){switch(B){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(F.direction))})(j)))})(t.orderBy));let g=null;t.limit&&(g=(function(_){let j;return j=typeof _=="object"?_.value:_,mf(j)?null:j})(t.limit));let y=null;t.startAt&&(y=(function(_){const j=!!_.before,I=_.values||[];return new Kh(I,j)})(t.startAt));let p=null;return t.endAt&&(p=(function(_){const j=!_.before,I=_.values||[];return new Kh(I,j)})(t.endAt)),cI(e,l,d,c,g,"F",y,p)}function WI(s,e){const t=(function(l){switch(l){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return jt(28987,{purpose:l})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Ik(s){return s.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Bl(t.unaryFilter.field);return ws.create(i,"==",{doubleValue:NaN});case"IS_NULL":const l=Bl(t.unaryFilter.field);return ws.create(l,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const c=Bl(t.unaryFilter.field);return ws.create(c,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=Bl(t.unaryFilter.field);return ws.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return jt(61313);default:return jt(60726)}})(s):s.fieldFilter!==void 0?(function(t){return ws.create(Bl(t.fieldFilter.field),(function(l){switch(l){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return jt(58110);default:return jt(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(s):s.compositeFilter!==void 0?(function(t){return vi.create(t.compositeFilter.filters.map((i=>Ik(i))),(function(l){switch(l){case"AND":return"and";case"OR":return"or";default:return jt(1026)}})(t.compositeFilter.op))})(s):jt(30097,{filter:s})}function GI(s){return DI[s]}function KI(s){return LI[s]}function YI(s){return PI[s]}function Ul(s){return{fieldPath:s.canonicalString()}}function Bl(s){return zs.fromServerFormat(s.fieldPath)}function Mk(s){return s instanceof ws?(function(t){if(t.op==="=="){if(sw(t.value))return{unaryFilter:{field:Ul(t.field),op:"IS_NAN"}};if(nw(t.value))return{unaryFilter:{field:Ul(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(sw(t.value))return{unaryFilter:{field:Ul(t.field),op:"IS_NOT_NAN"}};if(nw(t.value))return{unaryFilter:{field:Ul(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ul(t.field),op:KI(t.op),value:t.value}}})(s):s instanceof vi?(function(t){const i=t.getFilters().map((l=>Mk(l)));return i.length===1?i[0]:{compositeFilter:{op:YI(t.op),filters:i}}})(s):jt(54877,{filter:s})}function QI(s){const e=[];return s.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Dk(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}function Lk(s){return!!s&&typeof s._toProto=="function"&&s._protoValueType==="ProtoValue"}class to{constructor(e,t,i,l,c=Dt.min(),d=Dt.min(),g=Fs.EMPTY_BYTE_STRING,y=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=l,this.snapshotVersion=c,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=g,this.expectedCount=y}withSequenceNumber(e){return new to(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new to(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new to(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new to(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class XI{constructor(e){this.yt=e}}function JI(s){const e=$I({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?Op(e,e.limit,"L"):e}class ZI{constructor(){this.Sn=new e6}addToCollectionParentIndex(e,t){return this.Sn.add(t),Ne.resolve()}getCollectionParents(e,t){return Ne.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return Ne.resolve()}deleteFieldIndex(e,t){return Ne.resolve()}deleteAllFieldIndexes(e){return Ne.resolve()}createTargetIndexes(e,t){return Ne.resolve()}getDocumentsMatchingTarget(e,t){return Ne.resolve(null)}getIndexType(e,t){return Ne.resolve(0)}getFieldIndexes(e,t){return Ne.resolve([])}getNextCollectionGroupToUpdate(e){return Ne.resolve(null)}getMinOffset(e,t){return Ne.resolve(ao.min())}getMinOffsetFromCollectionGroup(e,t){return Ne.resolve(ao.min())}updateCollectionGroup(e,t,i){return Ne.resolve()}updateIndexEntries(e,t){return Ne.resolve()}}class e6{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t]||new Ts(Dn.comparator),c=!l.has(i);return this.index[t]=l.add(i),c}has(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t];return l&&l.has(i)}getEntries(e){return(this.index[e]||new Ts(Dn.comparator)).toArray()}}const yw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Pk=41943040;class vr{static withCacheSize(e){return new vr(e,vr.DEFAULT_COLLECTION_PERCENTILE,vr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}vr.DEFAULT_COLLECTION_PERCENTILE=10,vr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,vr.DEFAULT=new vr(Pk,vr.DEFAULT_COLLECTION_PERCENTILE,vr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),vr.DISABLED=new vr(-1,0,0);class Zl{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Zl(0)}static ar(){return new Zl(-1)}}const vw="LruGarbageCollector",t6=1048576;function bw([s,e],[t,i]){const l=nn(s,t);return l===0?nn(e,i):l}class n6{constructor(e){this.Pr=e,this.buffer=new Ts(bw),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();bw(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class s6{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){Je(vw,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){cc(t)?Je(vw,"Ignoring IndexedDB error during garbage collection: ",t):await lc(t)}await this.Ar(3e5)}))}}class r6{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Ne.resolve(ff.ce);const i=new n6(t);return this.Vr.forEachTarget(e,(l=>i.Er(l.sequenceNumber))).next((()=>this.Vr.mr(e,(l=>i.Er(l))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Je("LruGarbageCollector","Garbage collection skipped; disabled"),Ne.resolve(yw)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(Je("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),yw):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,l,c,d,g,y,p;const b=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((_=>(_>this.params.maximumSequenceNumbersToCollect?(Je("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${_}`),l=this.params.maximumSequenceNumbersToCollect):l=_,d=Date.now(),this.nthSequenceNumber(e,l)))).next((_=>(i=_,g=Date.now(),this.removeTargets(e,i,t)))).next((_=>(c=_,y=Date.now(),this.removeOrphanedDocuments(e,i)))).next((_=>(p=Date.now(),Ol()<=en.DEBUG&&Je("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-b}ms
	Determined least recently used ${l} in `+(g-d)+`ms
	Removed ${c} targets in `+(y-g)+`ms
	Removed ${_} documents in `+(p-y)+`ms
Total Duration: ${p-b}ms`),Ne.resolve({didRun:!0,sequenceNumbersCollected:l,targetsRemoved:c,documentsRemoved:_}))))}}function i6(s,e){return new r6(s,e)}class a6{constructor(){this.changes=new Jo((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Js.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Ne.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class o6{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class l6{constructor(e,t,i,l){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=l}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((l=>(i=l,this.remoteDocumentCache.getEntry(e,t)))).next((l=>(i!==null&&vu(i.mutation,l,Lr.empty(),Bt.now()),l)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,sn()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=sn()){const l=Oo();return this.populateOverlays(e,l,t).next((()=>this.computeViews(e,t,l,i).next((c=>{let d=cu();return c.forEach(((g,y)=>{d=d.insert(g,y.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const i=Oo();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,sn())))}populateOverlays(e,t,i){const l=[];return i.forEach((c=>{t.has(c)||l.push(c)})),this.documentOverlayCache.getOverlays(e,l).next((c=>{c.forEach(((d,g)=>{t.set(d,g)}))}))}computeViews(e,t,i,l){let c=xa();const d=yu(),g=(function(){return yu()})();return t.forEach(((y,p)=>{const b=i.get(p.key);l.has(p.key)&&(b===void 0||b.mutation instanceof go)?c=c.insert(p.key,p):b!==void 0?(d.set(p.key,b.mutation.getFieldMask()),vu(b.mutation,p,b.mutation.getFieldMask(),Bt.now())):d.set(p.key,Lr.empty())})),this.recalculateAndSaveOverlays(e,c).next((y=>(y.forEach(((p,b)=>d.set(p,b))),t.forEach(((p,b)=>g.set(p,new o6(b,d.get(p)??null)))),g)))}recalculateAndSaveOverlays(e,t){const i=yu();let l=new Jn(((d,g)=>d-g)),c=sn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const g of d)g.keys().forEach((y=>{const p=t.get(y);if(p===null)return;let b=i.get(y)||Lr.empty();b=g.applyToLocalView(p,b),i.set(y,b);const _=(l.get(g.batchId)||sn()).add(y);l=l.insert(g.batchId,_)}))})).next((()=>{const d=[],g=l.getReverseIterator();for(;g.hasNext();){const y=g.getNext(),p=y.key,b=y.value,_=pk();b.forEach((j=>{if(!c.has(j)){const I=kk(t.get(j),i.get(j));I!==null&&_.set(j,I),c=c.add(j)}})),d.push(this.documentOverlayCache.saveOverlays(e,p,_))}return Ne.waitFor(d)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,l){return uI(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):dk(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,l):this.getDocumentsMatchingCollectionQuery(e,t,i,l)}getNextDocuments(e,t,i,l){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,l).next((c=>{const d=l-c.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,l-c.size):Ne.resolve(Oo());let g=Eu,y=c;return d.next((p=>Ne.forEach(p,((b,_)=>(g<_.largestBatchId&&(g=_.largestBatchId),c.get(b)?Ne.resolve():this.remoteDocumentCache.getEntry(e,b).next((j=>{y=y.insert(b,j)}))))).next((()=>this.populateOverlays(e,p,c))).next((()=>this.computeViews(e,y,p,sn()))).next((b=>({batchId:g,changes:gk(b)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ft(t)).next((i=>{let l=cu();return i.isFoundDocument()&&(l=l.insert(i.key,i)),l}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,l){const c=t.collectionGroup;let d=cu();return this.indexManager.getCollectionParents(e,c).next((g=>Ne.forEach(g,(y=>{const p=(function(_,j){return new uc(j,null,_.explicitOrderBy.slice(),_.filters.slice(),_.limit,_.limitType,_.startAt,_.endAt)})(t,y.child(c));return this.getDocumentsMatchingCollectionQuery(e,p,i,l).next((b=>{b.forEach(((_,j)=>{d=d.insert(_,j)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,i,l){let c;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((d=>(c=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,c,l)))).next((d=>{c.forEach(((y,p)=>{const b=p.getKey();d.get(b)===null&&(d=d.insert(b,Js.newInvalidDocument(b)))}));let g=cu();return d.forEach(((y,p)=>{const b=c.get(y);b!==void 0&&vu(b.mutation,p,Lr.empty(),Bt.now()),vf(t,p)&&(g=g.insert(y,p))})),g}))}}class c6{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return Ne.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(l){return{id:l.id,version:l.version,createTime:Li(l.createTime)}})(t)),Ne.resolve()}getNamedQuery(e,t){return Ne.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(l){return{name:l.name,query:JI(l.bundledQuery),readTime:Li(l.readTime)}})(t)),Ne.resolve()}}class u6{constructor(){this.overlays=new Jn(ft.comparator),this.Lr=new Map}getOverlay(e,t){return Ne.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Oo();return Ne.forEach(t,(l=>this.getOverlay(e,l).next((c=>{c!==null&&i.set(l,c)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((l,c)=>{this.bt(e,t,c)})),Ne.resolve()}removeOverlaysForBatchId(e,t,i){const l=this.Lr.get(i);return l!==void 0&&(l.forEach((c=>this.overlays=this.overlays.remove(c))),this.Lr.delete(i)),Ne.resolve()}getOverlaysForCollection(e,t,i){const l=Oo(),c=t.length+1,d=new ft(t.child("")),g=this.overlays.getIteratorFrom(d);for(;g.hasNext();){const y=g.getNext().value,p=y.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===c&&y.largestBatchId>i&&l.set(y.getKey(),y)}return Ne.resolve(l)}getOverlaysForCollectionGroup(e,t,i,l){let c=new Jn(((p,b)=>p-b));const d=this.overlays.getIterator();for(;d.hasNext();){const p=d.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>i){let b=c.get(p.largestBatchId);b===null&&(b=Oo(),c=c.insert(p.largestBatchId,b)),b.set(p.getKey(),p)}}const g=Oo(),y=c.getIterator();for(;y.hasNext()&&(y.getNext().value.forEach(((p,b)=>g.set(p,b))),!(g.size()>=l)););return Ne.resolve(g)}bt(e,t,i){const l=this.overlays.get(i.key);if(l!==null){const d=this.Lr.get(l.largestBatchId).delete(i.key);this.Lr.set(l.largestBatchId,d)}this.overlays=this.overlays.insert(i.key,new CI(t,i));let c=this.Lr.get(t);c===void 0&&(c=sn(),this.Lr.set(t,c)),this.Lr.set(t,c.add(i.key))}}class d6{constructor(){this.sessionToken=Fs.EMPTY_BYTE_STRING}getSessionToken(e){return Ne.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Ne.resolve()}}class Ly{constructor(){this.kr=new Ts(Is.Kr),this.qr=new Ts(Is.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new Is(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new Is(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new ft(new Dn([])),i=new Is(t,e),l=new Is(t,e+1),c=[];return this.qr.forEachInRange([i,l],(d=>{this.Wr(d),c.push(d.key)})),c}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new ft(new Dn([])),i=new Is(t,e),l=new Is(t,e+1);let c=sn();return this.qr.forEachInRange([i,l],(d=>{c=c.add(d.key)})),c}containsKey(e){const t=new Is(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Is{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return ft.comparator(e.key,t.key)||nn(e.Hr,t.Hr)}static Ur(e,t){return nn(e.Hr,t.Hr)||ft.comparator(e.key,t.key)}}class h6{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Ts(Is.Kr)}checkEmpty(e){return Ne.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,l){const c=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new SI(c,t,i,l);this.mutationQueue.push(d);for(const g of l)this.Jr=this.Jr.add(new Is(g.key,c)),this.indexManager.addToCollectionParentIndex(e,g.key.path.popLast());return Ne.resolve(d)}lookupMutationBatch(e,t){return Ne.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,l=this.Xr(i),c=l<0?0:l;return Ne.resolve(this.mutationQueue.length>c?this.mutationQueue[c]:null)}getHighestUnacknowledgedBatchId(){return Ne.resolve(this.mutationQueue.length===0?Ty:this.Yn-1)}getAllMutationBatches(e){return Ne.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Is(t,0),l=new Is(t,Number.POSITIVE_INFINITY),c=[];return this.Jr.forEachInRange([i,l],(d=>{const g=this.Zr(d.Hr);c.push(g)})),Ne.resolve(c)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Ts(nn);return t.forEach((l=>{const c=new Is(l,0),d=new Is(l,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([c,d],(g=>{i=i.add(g.Hr)}))})),Ne.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,l=i.length+1;let c=i;ft.isDocumentKey(c)||(c=c.child(""));const d=new Is(new ft(c),0);let g=new Ts(nn);return this.Jr.forEachWhile((y=>{const p=y.key.path;return!!i.isPrefixOf(p)&&(p.length===l&&(g=g.add(y.Hr)),!0)}),d),Ne.resolve(this.Yr(g))}Yr(e){const t=[];return e.forEach((i=>{const l=this.Zr(i);l!==null&&t.push(l)})),t}removeMutationBatch(e,t){kn(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return Ne.forEach(t.mutations,(l=>{const c=new Is(l.key,t.batchId);return i=i.delete(c),this.referenceDelegate.markPotentiallyOrphaned(e,l.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new Is(t,0),l=this.Jr.firstAfterOrEqual(i);return Ne.resolve(t.isEqual(l&&l.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ne.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class f6{constructor(e){this.ti=e,this.docs=(function(){return new Jn(ft.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,l=this.docs.get(i),c=l?l.size:0,d=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:d}),this.size+=d-c,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Ne.resolve(i?i.document.mutableCopy():Js.newInvalidDocument(t))}getEntries(e,t){let i=xa();return t.forEach((l=>{const c=this.docs.get(l);i=i.insert(l,c?c.document.mutableCopy():Js.newInvalidDocument(l))})),Ne.resolve(i)}getDocumentsMatchingQuery(e,t,i,l){let c=xa();const d=t.path,g=new ft(d.child("__id-9223372036854775808__")),y=this.docs.getIteratorFrom(g);for(;y.hasNext();){const{key:p,value:{document:b}}=y.getNext();if(!d.isPrefixOf(p.path))break;p.path.length>d.length+1||BR(UR(b),i)<=0||(l.has(b.key)||vf(t,b))&&(c=c.insert(b.key,b.mutableCopy()))}return Ne.resolve(c)}getAllFromCollectionGroup(e,t,i,l){jt(9500)}ni(e,t){return Ne.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new m6(this)}getSize(e){return Ne.resolve(this.size)}}class m6 extends a6{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,l)=>{l.isValidDocument()?t.push(this.Mr.addEntry(e,l)):this.Mr.removeEntry(i)})),Ne.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class g6{constructor(e){this.persistence=e,this.ri=new Jo((t=>Ny(t)),Ay),this.lastRemoteSnapshotVersion=Dt.min(),this.highestTargetId=0,this.ii=0,this.si=new Ly,this.targetCount=0,this.oi=Zl._r()}forEachTarget(e,t){return this.ri.forEach(((i,l)=>t(l))),Ne.resolve()}getLastRemoteSnapshotVersion(e){return Ne.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ne.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),Ne.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),Ne.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new Zl(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,Ne.resolve()}updateTargetData(e,t){return this.lr(t),Ne.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,Ne.resolve()}removeTargets(e,t,i){let l=0;const c=[];return this.ri.forEach(((d,g)=>{g.sequenceNumber<=t&&i.get(g.targetId)===null&&(this.ri.delete(d),c.push(this.removeMatchingKeysForTargetId(e,g.targetId)),l++)})),Ne.waitFor(c).next((()=>l))}getTargetCount(e){return Ne.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return Ne.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),Ne.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const l=this.persistence.referenceDelegate,c=[];return l&&t.forEach((d=>{c.push(l.markPotentiallyOrphaned(e,d))})),Ne.waitFor(c)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),Ne.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return Ne.resolve(i)}containsKey(e,t){return Ne.resolve(this.si.containsKey(t))}}class Ok{constructor(e,t){this._i={},this.overlays={},this.ai=new ff(0),this.ui=!1,this.ui=!0,this.ci=new d6,this.referenceDelegate=e(this),this.li=new g6(this),this.indexManager=new ZI,this.remoteDocumentCache=(function(l){return new f6(l)})((i=>this.referenceDelegate.hi(i))),this.serializer=new XI(t),this.Pi=new c6(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new u6,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new h6(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){Je("MemoryPersistence","Starting transaction:",e);const l=new p6(this.ai.next());return this.referenceDelegate.Ti(),i(l).next((c=>this.referenceDelegate.Ii(l).next((()=>c)))).toPromise().then((c=>(l.raiseOnCommittedEvent(),c)))}Ei(e,t){return Ne.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class p6 extends FR{constructor(e){super(),this.currentSequenceNumber=e}}class Py{constructor(e){this.persistence=e,this.Ri=new Ly,this.Ai=null}static Vi(e){return new Py(e)}get di(){if(this.Ai)return this.Ai;throw jt(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),Ne.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),Ne.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),Ne.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((l=>this.di.add(l.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((l=>{l.forEach((c=>this.di.add(c.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ne.forEach(this.di,(i=>{const l=ft.fromPath(i);return this.mi(e,l).next((c=>{c||t.removeEntry(l,Dt.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return Ne.or([()=>Ne.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Qh{constructor(e,t){this.persistence=e,this.fi=new Jo((i=>$R(i.path)),((i,l)=>i.isEqual(l))),this.garbageCollector=i6(this,t)}static Vi(e,t){return new Qh(e,t)}Ti(){}Ii(e){return Ne.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((l=>i+l))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return Ne.forEach(this.fi,((i,l)=>this.wr(e,i,l).next((c=>c?Ne.resolve():t(l)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const l=this.persistence.getRemoteDocumentCache(),c=l.newChangeBuffer();return l.ni(e,(d=>this.wr(e,d,t).next((g=>{g||(i++,c.removeEntry(d,Dt.min()))})))).next((()=>c.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),Ne.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Ne.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Ne.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),Ne.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Ah(e.data.value)),t}wr(e,t,i){return Ne.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const l=this.fi.get(t);return Ne.resolve(l!==void 0&&l>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Oy{constructor(e,t,i,l){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=l}static Es(e,t){let i=sn(),l=sn();for(const c of t.docChanges)switch(c.type){case 0:i=i.add(c.doc.key);break;case 1:l=l.add(c.doc.key)}return new Oy(e,t.fromCache,i,l)}}class y6{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class v6{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return KC()?8:HR(Zs())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,l){const c={result:null};return this.gs(e,t).next((d=>{c.result=d})).next((()=>{if(!c.result)return this.ps(e,t,l,i).next((d=>{c.result=d}))})).next((()=>{if(c.result)return;const d=new y6;return this.ys(e,t,d).next((g=>{if(c.result=g,this.As)return this.ws(e,t,d,g.size)}))})).next((()=>c.result))}ws(e,t,i,l){return i.documentReadCount<this.Vs?(Ol()<=en.DEBUG&&Je("QueryEngine","SDK will not create cache indexes for query:",Vl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Ne.resolve()):(Ol()<=en.DEBUG&&Je("QueryEngine","Query:",Vl(t),"scans",i.documentReadCount,"local documents and returns",l,"documents as results."),i.documentReadCount>this.ds*l?(Ol()<=en.DEBUG&&Je("QueryEngine","The SDK decides to create cache indexes for query:",Vl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Di(t))):Ne.resolve())}gs(e,t){if(ow(t))return Ne.resolve(null);let i=Di(t);return this.indexManager.getIndexType(e,i).next((l=>l===0?null:(t.limit!==null&&l===1&&(t=Op(t,null,"F"),i=Di(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((c=>{const d=sn(...c);return this.fs.getDocuments(e,d).next((g=>this.indexManager.getMinOffset(e,i).next((y=>{const p=this.bs(t,g);return this.Ss(t,p,d,y.readTime)?this.gs(e,Op(t,null,"F")):this.Ds(e,p,t,y)}))))})))))}ps(e,t,i,l){return ow(t)||l.isEqual(Dt.min())?Ne.resolve(null):this.fs.getDocuments(e,i).next((c=>{const d=this.bs(t,c);return this.Ss(t,d,i,l)?Ne.resolve(null):(Ol()<=en.DEBUG&&Je("QueryEngine","Re-using previous result from %s to execute query: %s",l.toString(),Vl(t)),this.Ds(e,d,t,VR(l,Eu)).next((g=>g)))}))}bs(e,t){let i=new Ts(fk(e));return t.forEach(((l,c)=>{vf(e,c)&&(i=i.add(c))})),i}Ss(e,t,i,l){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const c=e.limitType==="F"?t.last():t.first();return!!c&&(c.hasPendingWrites||c.version.compareTo(l)>0)}ys(e,t,i){return Ol()<=en.DEBUG&&Je("QueryEngine","Using full collection scan to execute query:",Vl(t)),this.fs.getDocumentsMatchingQuery(e,t,ao.min(),i)}Ds(e,t,i,l){return this.fs.getDocumentsMatchingQuery(e,i,l).next((c=>(t.forEach((d=>{c=c.insert(d.key,d)})),c)))}}const Vy="LocalStore",b6=3e8;class w6{constructor(e,t,i,l){this.persistence=e,this.Cs=t,this.serializer=l,this.vs=new Jn(nn),this.Fs=new Jo((c=>Ny(c)),Ay),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new l6(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function x6(s,e,t,i){return new w6(s,e,t,i)}async function Vk(s,e){const t=Pt(s);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let l;return t.mutationQueue.getAllMutationBatches(i).next((c=>(l=c,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((c=>{const d=[],g=[];let y=sn();for(const p of l){d.push(p.batchId);for(const b of p.mutations)y=y.add(b.key)}for(const p of c){g.push(p.batchId);for(const b of p.mutations)y=y.add(b.key)}return t.localDocuments.getDocuments(i,y).next((p=>({Ns:p,removedBatchIds:d,addedBatchIds:g})))}))}))}function _6(s,e){const t=Pt(s);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const l=e.batch.keys(),c=t.xs.newChangeBuffer({trackRemovals:!0});return(function(g,y,p,b){const _=p.batch,j=_.keys();let I=Ne.resolve();return j.forEach((F=>{I=I.next((()=>b.getEntry(y,F))).next((G=>{const B=p.docVersions.get(F);kn(B!==null,48541),G.version.compareTo(B)<0&&(_.applyToRemoteDocument(G,p),G.isValidDocument()&&(G.setReadTime(p.commitVersion),b.addEntry(G)))}))})),I.next((()=>g.mutationQueue.removeMutationBatch(y,_)))})(t,i,e,c).next((()=>c.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,l,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(g){let y=sn();for(let p=0;p<g.mutationResults.length;++p)g.mutationResults[p].transformResults.length>0&&(y=y.add(g.batch.mutations[p].key));return y})(e)))).next((()=>t.localDocuments.getDocuments(i,l)))}))}function Uk(s){const e=Pt(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function k6(s,e){const t=Pt(s),i=e.snapshotVersion;let l=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(c=>{const d=t.xs.newChangeBuffer({trackRemovals:!0});l=t.vs;const g=[];e.targetChanges.forEach(((b,_)=>{const j=l.get(_);if(!j)return;g.push(t.li.removeMatchingKeys(c,b.removedDocuments,_).next((()=>t.li.addMatchingKeys(c,b.addedDocuments,_))));let I=j.withSequenceNumber(c.currentSequenceNumber);e.targetMismatches.get(_)!==null?I=I.withResumeToken(Fs.EMPTY_BYTE_STRING,Dt.min()).withLastLimboFreeSnapshotVersion(Dt.min()):b.resumeToken.approximateByteSize()>0&&(I=I.withResumeToken(b.resumeToken,i)),l=l.insert(_,I),(function(G,B,Y){return G.resumeToken.approximateByteSize()===0||B.snapshotVersion.toMicroseconds()-G.snapshotVersion.toMicroseconds()>=b6?!0:Y.addedDocuments.size+Y.modifiedDocuments.size+Y.removedDocuments.size>0})(j,I,b)&&g.push(t.li.updateTargetData(c,I))}));let y=xa(),p=sn();if(e.documentUpdates.forEach((b=>{e.resolvedLimboDocuments.has(b)&&g.push(t.persistence.referenceDelegate.updateLimboDocument(c,b))})),g.push(j6(c,d,e.documentUpdates).next((b=>{y=b.Bs,p=b.Ls}))),!i.isEqual(Dt.min())){const b=t.li.getLastRemoteSnapshotVersion(c).next((_=>t.li.setTargetsMetadata(c,c.currentSequenceNumber,i)));g.push(b)}return Ne.waitFor(g).next((()=>d.apply(c))).next((()=>t.localDocuments.getLocalViewOfDocuments(c,y,p))).next((()=>y))})).then((c=>(t.vs=l,c)))}function j6(s,e,t){let i=sn(),l=sn();return t.forEach((c=>i=i.add(c))),e.getEntries(s,i).next((c=>{let d=xa();return t.forEach(((g,y)=>{const p=c.get(g);y.isFoundDocument()!==p.isFoundDocument()&&(l=l.add(g)),y.isNoDocument()&&y.version.isEqual(Dt.min())?(e.removeEntry(g,y.readTime),d=d.insert(g,y)):!p.isValidDocument()||y.version.compareTo(p.version)>0||y.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(y),d=d.insert(g,y)):Je(Vy,"Ignoring outdated watch update for ",g,". Current version:",p.version," Watch version:",y.version)})),{Bs:d,Ls:l}}))}function E6(s,e){const t=Pt(s);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=Ty),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function T6(s,e){const t=Pt(s);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let l;return t.li.getTargetData(i,e).next((c=>c?(l=c,Ne.resolve(l)):t.li.allocateTargetId(i).next((d=>(l=new to(e,d,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,l).next((()=>l)))))))})).then((i=>{const l=t.vs.get(i.targetId);return(l===null||i.snapshotVersion.compareTo(l.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function Fp(s,e,t){const i=Pt(s),l=i.vs.get(e),c=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",c,(d=>i.persistence.referenceDelegate.removeTarget(d,l)))}catch(d){if(!cc(d))throw d;Je(Vy,`Failed to update sequence numbers for target ${e}: ${d}`)}i.vs=i.vs.remove(e),i.Fs.delete(l.target)}function ww(s,e,t){const i=Pt(s);let l=Dt.min(),c=sn();return i.persistence.runTransaction("Execute query","readwrite",(d=>(function(y,p,b){const _=Pt(y),j=_.Fs.get(b);return j!==void 0?Ne.resolve(_.vs.get(j)):_.li.getTargetData(p,b)})(i,d,Di(e)).next((g=>{if(g)return l=g.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(d,g.targetId).next((y=>{c=y}))})).next((()=>i.Cs.getDocumentsMatchingQuery(d,e,t?l:Dt.min(),t?c:sn()))).next((g=>(S6(i,fI(e),g),{documents:g,ks:c})))))}function S6(s,e,t){let i=s.Ms.get(e)||Dt.min();t.forEach(((l,c)=>{c.readTime.compareTo(i)>0&&(i=c.readTime)})),s.Ms.set(e,i)}class xw{constructor(){this.activeTargetIds=bI()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class C6{constructor(){this.vo=new xw,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new xw,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class N6{Mo(e){}shutdown(){}}const _w="ConnectivityMonitor";class kw{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){Je(_w,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){Je(_w,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let gh=null;function Hp(){return gh===null?gh=(function(){return 268435456+Math.round(2147483648*Math.random())})():gh++,"0x"+gh.toString(16)}const Gg="RestConnection",A6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class R6{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),l=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${l}`,this.$o=this.databaseId.database===Wh?`project_id=${i}`:`project_id=${i}&database_id=${l}`}Wo(e,t,i,l,c){const d=Hp(),g=this.Qo(e,t.toUriEncodedString());Je(Gg,`Sending RPC '${e}' ${d}:`,g,i);const y={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(y,l,c);const{host:p}=new URL(g),b=fo(p);return this.zo(e,g,y,i,b).then((_=>(Je(Gg,`Received RPC '${e}' ${d}: `,_),_)),(_=>{throw Gl(Gg,`RPC '${e}' ${d} failed with error: `,_,"url: ",g,"request:",i),_}))}jo(e,t,i,l,c,d){return this.Wo(e,t,i,l,c)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+oc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((l,c)=>e[c]=l)),i&&i.headers.forEach(((l,c)=>e[c]=l))}Qo(e,t){const i=A6[e];let l=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(l=`${l}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),l}terminate(){}}class I6{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const Qs="WebChannelConnection",Zc=(s,e,t)=>{s.listen(e,(i=>{try{t(i)}catch(l){setTimeout((()=>{throw l}),0)}}))};class ql extends R6{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!ql.c_){const e=H_();Zc(e,F_.STAT_EVENT,(t=>{t.stat===Ap.PROXY?Je(Qs,"STAT_EVENT: detected buffering proxy"):t.stat===Ap.NOPROXY&&Je(Qs,"STAT_EVENT: detected no buffering proxy")})),ql.c_=!0}}zo(e,t,i,l,c){const d=Hp();return new Promise(((g,y)=>{const p=new B_;p.setWithCredentials(!0),p.listenOnce(z_.COMPLETE,(()=>{try{switch(p.getLastErrorCode()){case Nh.NO_ERROR:const _=p.getResponseJson();Je(Qs,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(_)),g(_);break;case Nh.TIMEOUT:Je(Qs,`RPC '${e}' ${d} timed out`),y(new We(_e.DEADLINE_EXCEEDED,"Request time out"));break;case Nh.HTTP_ERROR:const j=p.getStatus();if(Je(Qs,`RPC '${e}' ${d} failed with status:`,j,"response text:",p.getResponseText()),j>0){let I=p.getResponseJson();Array.isArray(I)&&(I=I[0]);const F=I?.error;if(F&&F.status&&F.message){const G=(function(Y){const ee=Y.toLowerCase().replace(/_/g,"-");return Object.values(_e).indexOf(ee)>=0?ee:_e.UNKNOWN})(F.status);y(new We(G,F.message))}else y(new We(_e.UNKNOWN,"Server responded with status "+p.getStatus()))}else y(new We(_e.UNAVAILABLE,"Connection failed."));break;default:jt(9055,{l_:e,streamId:d,h_:p.getLastErrorCode(),P_:p.getLastError()})}}finally{Je(Qs,`RPC '${e}' ${d} completed.`)}}));const b=JSON.stringify(l);Je(Qs,`RPC '${e}' ${d} sending request:`,l),p.send(t,"POST",b,i,15)}))}T_(e,t,i){const l=Hp(),c=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=this.createWebChannelTransport(),g={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},y=this.longPollingOptions.timeoutSeconds;y!==void 0&&(g.longPollingTimeout=Math.round(1e3*y)),this.useFetchStreams&&(g.useFetchStreams=!0),this.Go(g.initMessageHeaders,t,i),g.encodeInitMessageHeaders=!0;const p=c.join("");Je(Qs,`Creating RPC '${e}' stream ${l}: ${p}`,g);const b=d.createWebChannel(p,g);this.I_(b);let _=!1,j=!1;const I=new I6({Ho:F=>{j?Je(Qs,`Not sending because RPC '${e}' stream ${l} is closed:`,F):(_||(Je(Qs,`Opening RPC '${e}' stream ${l} transport.`),b.open(),_=!0),Je(Qs,`RPC '${e}' stream ${l} sending:`,F),b.send(F))},Jo:()=>b.close()});return Zc(b,lu.EventType.OPEN,(()=>{j||(Je(Qs,`RPC '${e}' stream ${l} transport opened.`),I.i_())})),Zc(b,lu.EventType.CLOSE,(()=>{j||(j=!0,Je(Qs,`RPC '${e}' stream ${l} transport closed`),I.o_(),this.E_(b))})),Zc(b,lu.EventType.ERROR,(F=>{j||(j=!0,Gl(Qs,`RPC '${e}' stream ${l} transport errored. Name:`,F.name,"Message:",F.message),I.o_(new We(_e.UNAVAILABLE,"The operation could not be completed")))})),Zc(b,lu.EventType.MESSAGE,(F=>{if(!j){const G=F.data[0];kn(!!G,16349);const B=G,Y=B?.error||B[0]?.error;if(Y){Je(Qs,`RPC '${e}' stream ${l} received error:`,Y);const ee=Y.status;let re=(function(he){const L=bs[he];if(L!==void 0)return Ek(L)})(ee),pe=Y.message;re===void 0&&(re=_e.INTERNAL,pe="Unknown error status: "+ee+" with message "+Y.message),j=!0,I.o_(new We(re,pe)),b.close()}else Je(Qs,`RPC '${e}' stream ${l} received:`,G),I.__(G)}})),ql.u_(),setTimeout((()=>{I.s_()}),0),I}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return q_()}}function M6(s){return new ql(s)}function Kg(){return typeof document<"u"?document:null}function jf(s){return new OI(s,!0)}ql.c_=!1;class Bk{constructor(e,t,i=1e3,l=1.5,c=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=l,this.V_=c,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),l=Math.max(0,t-i);l>0&&Je("ExponentialBackoff",`Backing off for ${l} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,l,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const jw="PersistentStream";class zk{constructor(e,t,i,l,c,d,g,y){this.Ci=e,this.b_=i,this.S_=l,this.connection=c,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=g,this.listener=y,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Bk(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===_e.RESOURCE_EXHAUSTED?(wa(t.toString()),wa("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===_e.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,l])=>{this.D_===t&&this.G_(i,l)}),(i=>{e((()=>{const l=new We(_e.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(l)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((l=>{i((()=>this.z_(l)))})),this.stream.onMessage((l=>{i((()=>++this.F_==1?this.H_(l):this.onNext(l)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Je(jw,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(Je(jw,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class D6 extends zk{constructor(e,t,i,l,c,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,l,d),this.serializer=c}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=BI(this.serializer,e),i=(function(c){if(!("targetChange"in c))return Dt.min();const d=c.targetChange;return d.targetIds&&d.targetIds.length?Dt.min():d.readTime?Li(d.readTime):Dt.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=zp(this.serializer),t.addTarget=(function(c,d){let g;const y=d.target;if(g=Lp(y)?{documents:HI(c,y)}:{query:qI(c,y).ft},g.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){g.resumeToken=Ck(c,d.resumeToken);const p=Vp(c,d.expectedCount);p!==null&&(g.expectedCount=p)}else if(d.snapshotVersion.compareTo(Dt.min())>0){g.readTime=Yh(c,d.snapshotVersion.toTimestamp());const p=Vp(c,d.expectedCount);p!==null&&(g.expectedCount=p)}return g})(this.serializer,e);const i=WI(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=zp(this.serializer),t.removeTarget=e,this.K_(t)}}class L6 extends zk{constructor(e,t,i,l,c,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,l,d),this.serializer=c}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return kn(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,kn(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){kn(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=FI(e.writeResults,e.commitTime),i=Li(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=zp(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>zI(this.serializer,i)))};this.K_(t)}}class P6{}class O6 extends P6{constructor(e,t,i,l){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=l,this.ia=!1}sa(){if(this.ia)throw new We(_e.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,d])=>this.connection.Wo(e,Up(t,i),l,c,d))).catch((c=>{throw c.name==="FirebaseError"?(c.code===_e.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new We(_e.UNKNOWN,c.toString())}))}jo(e,t,i,l,c){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,g])=>this.connection.jo(e,Up(t,i),l,d,g,c))).catch((d=>{throw d.name==="FirebaseError"?(d.code===_e.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new We(_e.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function V6(s,e,t,i){return new O6(s,e,t,i)}class U6{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(wa(t),this.aa=!1):Je("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const qo="RemoteStore";class B6{constructor(e,t,i,l,c){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=c,this.Aa.Mo((d=>{i.enqueueAndForget((async()=>{Zo(this)&&(Je(qo,"Restarting streams for network reachability change."),await(async function(y){const p=Pt(y);p.Ea.add(4),await qu(p),p.Va.set("Unknown"),p.Ea.delete(4),await Ef(p)})(this))}))})),this.Va=new U6(i,l)}}async function Ef(s){if(Zo(s))for(const e of s.Ra)await e(!0)}async function qu(s){for(const e of s.Ra)await e(!1)}function Fk(s,e){const t=Pt(s);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Fy(t)?zy(t):dc(t).O_()&&By(t,e))}function Uy(s,e){const t=Pt(s),i=dc(t);t.Ia.delete(e),i.O_()&&Hk(t,e),t.Ia.size===0&&(i.O_()?i.L_():Zo(t)&&t.Va.set("Unknown"))}function By(s,e){if(s.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Dt.min())>0){const t=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}dc(s).Z_(e)}function Hk(s,e){s.da.$e(e),dc(s).X_(e)}function zy(s){s.da=new MI({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),dc(s).start(),s.Va.ua()}function Fy(s){return Zo(s)&&!dc(s).x_()&&s.Ia.size>0}function Zo(s){return Pt(s).Ea.size===0}function qk(s){s.da=void 0}async function z6(s){s.Va.set("Online")}async function F6(s){s.Ia.forEach(((e,t)=>{By(s,e)}))}async function H6(s,e){qk(s),Fy(s)?(s.Va.ha(e),zy(s)):s.Va.set("Unknown")}async function q6(s,e,t){if(s.Va.set("Online"),e instanceof Sk&&e.state===2&&e.cause)try{await(async function(l,c){const d=c.cause;for(const g of c.targetIds)l.Ia.has(g)&&(await l.remoteSyncer.rejectListen(g,d),l.Ia.delete(g),l.da.removeTarget(g))})(s,e)}catch(i){Je(qo,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Xh(s,i)}else if(e instanceof Mh?s.da.Xe(e):e instanceof Tk?s.da.st(e):s.da.tt(e),!t.isEqual(Dt.min()))try{const i=await Uk(s.localStore);t.compareTo(i)>=0&&await(function(c,d){const g=c.da.Tt(d);return g.targetChanges.forEach(((y,p)=>{if(y.resumeToken.approximateByteSize()>0){const b=c.Ia.get(p);b&&c.Ia.set(p,b.withResumeToken(y.resumeToken,d))}})),g.targetMismatches.forEach(((y,p)=>{const b=c.Ia.get(y);if(!b)return;c.Ia.set(y,b.withResumeToken(Fs.EMPTY_BYTE_STRING,b.snapshotVersion)),Hk(c,y);const _=new to(b.target,y,p,b.sequenceNumber);By(c,_)})),c.remoteSyncer.applyRemoteEvent(g)})(s,t)}catch(i){Je(qo,"Failed to raise snapshot:",i),await Xh(s,i)}}async function Xh(s,e,t){if(!cc(e))throw e;s.Ea.add(1),await qu(s),s.Va.set("Offline"),t||(t=()=>Uk(s.localStore)),s.asyncQueue.enqueueRetryable((async()=>{Je(qo,"Retrying IndexedDB access"),await t(),s.Ea.delete(1),await Ef(s)}))}function $k(s,e){return e().catch((t=>Xh(s,t,e)))}async function Tf(s){const e=Pt(s),t=uo(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Ty;for(;$6(e);)try{const l=await E6(e.localStore,i);if(l===null){e.Ta.length===0&&t.L_();break}i=l.batchId,W6(e,l)}catch(l){await Xh(e,l)}Wk(e)&&Gk(e)}function $6(s){return Zo(s)&&s.Ta.length<10}function W6(s,e){s.Ta.push(e);const t=uo(s);t.O_()&&t.Y_&&t.ea(e.mutations)}function Wk(s){return Zo(s)&&!uo(s).x_()&&s.Ta.length>0}function Gk(s){uo(s).start()}async function G6(s){uo(s).ra()}async function K6(s){const e=uo(s);for(const t of s.Ta)e.ea(t.mutations)}async function Y6(s,e,t){const i=s.Ta.shift(),l=Iy.from(i,e,t);await $k(s,(()=>s.remoteSyncer.applySuccessfulWrite(l))),await Tf(s)}async function Q6(s,e){e&&uo(s).Y_&&await(async function(i,l){if((function(d){return AI(d)&&d!==_e.ABORTED})(l.code)){const c=i.Ta.shift();uo(i).B_(),await $k(i,(()=>i.remoteSyncer.rejectFailedWrite(c.batchId,l))),await Tf(i)}})(s,e),Wk(s)&&Gk(s)}async function Ew(s,e){const t=Pt(s);t.asyncQueue.verifyOperationInProgress(),Je(qo,"RemoteStore received new credentials");const i=Zo(t);t.Ea.add(3),await qu(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Ef(t)}async function X6(s,e){const t=Pt(s);e?(t.Ea.delete(2),await Ef(t)):e||(t.Ea.add(2),await qu(t),t.Va.set("Unknown"))}function dc(s){return s.ma||(s.ma=(function(t,i,l){const c=Pt(t);return c.sa(),new D6(i,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,l)})(s.datastore,s.asyncQueue,{Zo:z6.bind(null,s),Yo:F6.bind(null,s),t_:H6.bind(null,s),J_:q6.bind(null,s)}),s.Ra.push((async e=>{e?(s.ma.B_(),Fy(s)?zy(s):s.Va.set("Unknown")):(await s.ma.stop(),qk(s))}))),s.ma}function uo(s){return s.fa||(s.fa=(function(t,i,l){const c=Pt(t);return c.sa(),new L6(i,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,l)})(s.datastore,s.asyncQueue,{Zo:()=>Promise.resolve(),Yo:G6.bind(null,s),t_:Q6.bind(null,s),ta:K6.bind(null,s),na:Y6.bind(null,s)}),s.Ra.push((async e=>{e?(s.fa.B_(),await Tf(s)):(await s.fa.stop(),s.Ta.length>0&&(Je(qo,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))}))),s.fa}class Hy{constructor(e,t,i,l,c){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=l,this.removalCallback=c,this.deferred=new ma,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,l,c){const d=Date.now()+i,g=new Hy(e,t,d,l,c);return g.start(i),g}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new We(_e.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function qy(s,e){if(wa("AsyncQueue",`${e}: ${s}`),cc(s))return new We(_e.UNAVAILABLE,`${e}: ${s}`);throw s}class $l{static emptySet(e){return new $l(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||ft.comparator(t.key,i.key):(t,i)=>ft.comparator(t.key,i.key),this.keyedMap=cu(),this.sortedSet=new Jn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof $l)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const l=t.getNext().key,c=i.getNext().key;if(!l.isEqual(c))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new $l;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class Tw{constructor(){this.ga=new Jn(ft.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):jt(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class ec{constructor(e,t,i,l,c,d,g,y,p){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=l,this.mutatedKeys=c,this.fromCache=d,this.syncStateChanged=g,this.excludesMetadataChanges=y,this.hasCachedResults=p}static fromInitialDocuments(e,t,i,l,c){const d=[];return t.forEach((g=>{d.push({type:0,doc:g})})),new ec(e,t,$l.emptySet(t),d,i,l,!0,!1,c)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&yf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let l=0;l<t.length;l++)if(t[l].type!==i[l].type||!t[l].doc.isEqual(i[l].doc))return!1;return!0}}class J6{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class Z6{constructor(){this.queries=Sw(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const l=Pt(t),c=l.queries;l.queries=Sw(),c.forEach(((d,g)=>{for(const y of g.ba)y.onError(i)}))})(this,new We(_e.ABORTED,"Firestore shutting down"))}}function Sw(){return new Jo((s=>hk(s)),yf)}async function $y(s,e){const t=Pt(s);let i=3;const l=e.query;let c=t.queries.get(l);c?!c.Sa()&&e.Da()&&(i=2):(c=new J6,i=e.Da()?0:1);try{switch(i){case 0:c.wa=await t.onListen(l,!0);break;case 1:c.wa=await t.onListen(l,!1);break;case 2:await t.onFirstRemoteStoreListen(l)}}catch(d){const g=qy(d,`Initialization of query '${Vl(e.query)}' failed`);return void e.onError(g)}t.queries.set(l,c),c.ba.push(e),e.va(t.onlineState),c.wa&&e.Fa(c.wa)&&Gy(t)}async function Wy(s,e){const t=Pt(s),i=e.query;let l=3;const c=t.queries.get(i);if(c){const d=c.ba.indexOf(e);d>=0&&(c.ba.splice(d,1),c.ba.length===0?l=e.Da()?0:1:!c.Sa()&&e.Da()&&(l=2))}switch(l){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function eM(s,e){const t=Pt(s);let i=!1;for(const l of e){const c=l.query,d=t.queries.get(c);if(d){for(const g of d.ba)g.Fa(l)&&(i=!0);d.wa=l}}i&&Gy(t)}function tM(s,e,t){const i=Pt(s),l=i.queries.get(e);if(l)for(const c of l.ba)c.onError(t);i.queries.delete(e)}function Gy(s){s.Ca.forEach((e=>{e.next()}))}var qp,Cw;(Cw=qp||(qp={})).Ma="default",Cw.Cache="cache";class Ky{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const l of e.docChanges)l.type!==3&&i.push(l);e=new ec(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=ec.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==qp.Cache}}class Kk{constructor(e){this.key=e}}class Yk{constructor(e){this.key=e}}class nM{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=sn(),this.mutatedKeys=sn(),this.eu=fk(e),this.tu=new $l(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new Tw,l=t?t.tu:this.tu;let c=t?t.mutatedKeys:this.mutatedKeys,d=l,g=!1;const y=this.query.limitType==="F"&&l.size===this.query.limit?l.last():null,p=this.query.limitType==="L"&&l.size===this.query.limit?l.first():null;if(e.inorderTraversal(((b,_)=>{const j=l.get(b),I=vf(this.query,_)?_:null,F=!!j&&this.mutatedKeys.has(j.key),G=!!I&&(I.hasLocalMutations||this.mutatedKeys.has(I.key)&&I.hasCommittedMutations);let B=!1;j&&I?j.data.isEqual(I.data)?F!==G&&(i.track({type:3,doc:I}),B=!0):this.su(j,I)||(i.track({type:2,doc:I}),B=!0,(y&&this.eu(I,y)>0||p&&this.eu(I,p)<0)&&(g=!0)):!j&&I?(i.track({type:0,doc:I}),B=!0):j&&!I&&(i.track({type:1,doc:j}),B=!0,(y||p)&&(g=!0)),B&&(I?(d=d.add(I),c=G?c.add(b):c.delete(b)):(d=d.delete(b),c=c.delete(b)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const b=this.query.limitType==="F"?d.last():d.first();d=d.delete(b.key),c=c.delete(b.key),i.track({type:1,doc:b})}return{tu:d,iu:i,Ss:g,mutatedKeys:c}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,l){const c=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((b,_)=>(function(I,F){const G=B=>{switch(B){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return jt(20277,{Vt:B})}};return G(I)-G(F)})(b.type,_.type)||this.eu(b.doc,_.doc))),this.ou(i),l=l??!1;const g=t&&!l?this._u():[],y=this.Ya.size===0&&this.current&&!l?1:0,p=y!==this.Xa;return this.Xa=y,d.length!==0||p?{snapshot:new ec(this.query,e.tu,c,d,e.mutatedKeys,y===0,p,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:g}:{au:g}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Tw,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=sn(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new Yk(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new Kk(i))})),t}cu(e){this.Za=e.ks,this.Ya=sn();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return ec.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const Yy="SyncEngine";class sM{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class rM{constructor(e){this.key=e,this.hu=!1}}class iM{constructor(e,t,i,l,c,d){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=l,this.currentUser=c,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new Jo((g=>hk(g)),yf),this.Iu=new Map,this.Eu=new Set,this.Ru=new Jn(ft.comparator),this.Au=new Map,this.Vu=new Ly,this.du={},this.mu=new Map,this.fu=Zl.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function aM(s,e,t=!0){const i=tj(s);let l;const c=i.Tu.get(e);return c?(i.sharedClientState.addLocalQueryTarget(c.targetId),l=c.view.lu()):l=await Qk(i,e,t,!0),l}async function oM(s,e){const t=tj(s);await Qk(t,e,!0,!1)}async function Qk(s,e,t,i){const l=await T6(s.localStore,Di(e)),c=l.targetId,d=s.sharedClientState.addLocalQueryTarget(c,t);let g;return i&&(g=await lM(s,e,c,d==="current",l.resumeToken)),s.isPrimaryClient&&t&&Fk(s.remoteStore,l),g}async function lM(s,e,t,i,l){s.pu=(_,j,I)=>(async function(G,B,Y,ee){let re=B.view.ru(Y);re.Ss&&(re=await ww(G.localStore,B.query,!1).then((({documents:L})=>B.view.ru(L,re))));const pe=ee&&ee.targetChanges.get(B.targetId),ve=ee&&ee.targetMismatches.get(B.targetId)!=null,he=B.view.applyChanges(re,G.isPrimaryClient,pe,ve);return Aw(G,B.targetId,he.au),he.snapshot})(s,_,j,I);const c=await ww(s.localStore,e,!0),d=new nM(e,c.ks),g=d.ru(c.documents),y=Hu.createSynthesizedTargetChangeForCurrentChange(t,i&&s.onlineState!=="Offline",l),p=d.applyChanges(g,s.isPrimaryClient,y);Aw(s,t,p.au);const b=new sM(e,t,d);return s.Tu.set(e,b),s.Iu.has(t)?s.Iu.get(t).push(e):s.Iu.set(t,[e]),p.snapshot}async function cM(s,e,t){const i=Pt(s),l=i.Tu.get(e),c=i.Iu.get(l.targetId);if(c.length>1)return i.Iu.set(l.targetId,c.filter((d=>!yf(d,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(l.targetId),i.sharedClientState.isActiveQueryTarget(l.targetId)||await Fp(i.localStore,l.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(l.targetId),t&&Uy(i.remoteStore,l.targetId),$p(i,l.targetId)})).catch(lc)):($p(i,l.targetId),await Fp(i.localStore,l.targetId,!0))}async function uM(s,e){const t=Pt(s),i=t.Tu.get(e),l=t.Iu.get(i.targetId);t.isPrimaryClient&&l.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Uy(t.remoteStore,i.targetId))}async function dM(s,e,t){const i=vM(s);try{const l=await(function(d,g){const y=Pt(d),p=Bt.now(),b=g.reduce(((I,F)=>I.add(F.key)),sn());let _,j;return y.persistence.runTransaction("Locally write mutations","readwrite",(I=>{let F=xa(),G=sn();return y.xs.getEntries(I,b).next((B=>{F=B,F.forEach(((Y,ee)=>{ee.isValidDocument()||(G=G.add(Y))}))})).next((()=>y.localDocuments.getOverlayedDocuments(I,F))).next((B=>{_=B;const Y=[];for(const ee of g){const re=EI(ee,_.get(ee.key).overlayedDocument);re!=null&&Y.push(new go(ee.key,re,rk(re.value.mapValue),ur.exists(!0)))}return y.mutationQueue.addMutationBatch(I,p,Y,g)})).next((B=>{j=B;const Y=B.applyToLocalDocumentSet(_,G);return y.documentOverlayCache.saveOverlays(I,B.batchId,Y)}))})).then((()=>({batchId:j.batchId,changes:gk(_)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(l.batchId),(function(d,g,y){let p=d.du[d.currentUser.toKey()];p||(p=new Jn(nn)),p=p.insert(g,y),d.du[d.currentUser.toKey()]=p})(i,l.batchId,t),await $u(i,l.changes),await Tf(i.remoteStore)}catch(l){const c=qy(l,"Failed to persist write");t.reject(c)}}async function Xk(s,e){const t=Pt(s);try{const i=await k6(t.localStore,e);e.targetChanges.forEach(((l,c)=>{const d=t.Au.get(c);d&&(kn(l.addedDocuments.size+l.modifiedDocuments.size+l.removedDocuments.size<=1,22616),l.addedDocuments.size>0?d.hu=!0:l.modifiedDocuments.size>0?kn(d.hu,14607):l.removedDocuments.size>0&&(kn(d.hu,42227),d.hu=!1))})),await $u(t,i,e)}catch(i){await lc(i)}}function Nw(s,e,t){const i=Pt(s);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const l=[];i.Tu.forEach(((c,d)=>{const g=d.view.va(e);g.snapshot&&l.push(g.snapshot)})),(function(d,g){const y=Pt(d);y.onlineState=g;let p=!1;y.queries.forEach(((b,_)=>{for(const j of _.ba)j.va(g)&&(p=!0)})),p&&Gy(y)})(i.eventManager,e),l.length&&i.Pu.J_(l),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function hM(s,e,t){const i=Pt(s);i.sharedClientState.updateQueryState(e,"rejected",t);const l=i.Au.get(e),c=l&&l.key;if(c){let d=new Jn(ft.comparator);d=d.insert(c,Js.newNoDocument(c,Dt.min()));const g=sn().add(c),y=new kf(Dt.min(),new Map,new Jn(nn),d,g);await Xk(i,y),i.Ru=i.Ru.remove(c),i.Au.delete(e),Qy(i)}else await Fp(i.localStore,e,!1).then((()=>$p(i,e,t))).catch(lc)}async function fM(s,e){const t=Pt(s),i=e.batch.batchId;try{const l=await _6(t.localStore,e);Zk(t,i,null),Jk(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await $u(t,l)}catch(l){await lc(l)}}async function mM(s,e,t){const i=Pt(s);try{const l=await(function(d,g){const y=Pt(d);return y.persistence.runTransaction("Reject batch","readwrite-primary",(p=>{let b;return y.mutationQueue.lookupMutationBatch(p,g).next((_=>(kn(_!==null,37113),b=_.keys(),y.mutationQueue.removeMutationBatch(p,_)))).next((()=>y.mutationQueue.performConsistencyCheck(p))).next((()=>y.documentOverlayCache.removeOverlaysForBatchId(p,b,g))).next((()=>y.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,b))).next((()=>y.localDocuments.getDocuments(p,b)))}))})(i.localStore,e);Zk(i,e,t),Jk(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await $u(i,l)}catch(l){await lc(l)}}function Jk(s,e){(s.mu.get(e)||[]).forEach((t=>{t.resolve()})),s.mu.delete(e)}function Zk(s,e,t){const i=Pt(s);let l=i.du[i.currentUser.toKey()];if(l){const c=l.get(e);c&&(t?c.reject(t):c.resolve(),l=l.remove(e)),i.du[i.currentUser.toKey()]=l}}function $p(s,e,t=null){s.sharedClientState.removeLocalQueryTarget(e);for(const i of s.Iu.get(e))s.Tu.delete(i),t&&s.Pu.yu(i,t);s.Iu.delete(e),s.isPrimaryClient&&s.Vu.Gr(e).forEach((i=>{s.Vu.containsKey(i)||ej(s,i)}))}function ej(s,e){s.Eu.delete(e.path.canonicalString());const t=s.Ru.get(e);t!==null&&(Uy(s.remoteStore,t),s.Ru=s.Ru.remove(e),s.Au.delete(t),Qy(s))}function Aw(s,e,t){for(const i of t)i instanceof Kk?(s.Vu.addReference(i.key,e),gM(s,i)):i instanceof Yk?(Je(Yy,"Document no longer in limbo: "+i.key),s.Vu.removeReference(i.key,e),s.Vu.containsKey(i.key)||ej(s,i.key)):jt(19791,{wu:i})}function gM(s,e){const t=e.key,i=t.path.canonicalString();s.Ru.get(t)||s.Eu.has(i)||(Je(Yy,"New document in limbo: "+t),s.Eu.add(i),Qy(s))}function Qy(s){for(;s.Eu.size>0&&s.Ru.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const t=new ft(Dn.fromString(e)),i=s.fu.next();s.Au.set(i,new rM(t)),s.Ru=s.Ru.insert(t,i),Fk(s.remoteStore,new to(Di(pf(t.path)),i,"TargetPurposeLimboResolution",ff.ce))}}async function $u(s,e,t){const i=Pt(s),l=[],c=[],d=[];i.Tu.isEmpty()||(i.Tu.forEach(((g,y)=>{d.push(i.pu(y,e,t).then((p=>{if((p||t)&&i.isPrimaryClient){const b=p?!p.fromCache:t?.targetChanges.get(y.targetId)?.current;i.sharedClientState.updateQueryState(y.targetId,b?"current":"not-current")}if(p){l.push(p);const b=Oy.Es(y.targetId,p);c.push(b)}})))})),await Promise.all(d),i.Pu.J_(l),await(async function(y,p){const b=Pt(y);try{await b.persistence.runTransaction("notifyLocalViewChanges","readwrite",(_=>Ne.forEach(p,(j=>Ne.forEach(j.Ts,(I=>b.persistence.referenceDelegate.addReference(_,j.targetId,I))).next((()=>Ne.forEach(j.Is,(I=>b.persistence.referenceDelegate.removeReference(_,j.targetId,I)))))))))}catch(_){if(!cc(_))throw _;Je(Vy,"Failed to update sequence numbers: "+_)}for(const _ of p){const j=_.targetId;if(!_.fromCache){const I=b.vs.get(j),F=I.snapshotVersion,G=I.withLastLimboFreeSnapshotVersion(F);b.vs=b.vs.insert(j,G)}}})(i.localStore,c))}async function pM(s,e){const t=Pt(s);if(!t.currentUser.isEqual(e)){Je(Yy,"User change. New user:",e.toKey());const i=await Vk(t.localStore,e);t.currentUser=e,(function(c,d){c.mu.forEach((g=>{g.forEach((y=>{y.reject(new We(_e.CANCELLED,d))}))})),c.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await $u(t,i.Ns)}}function yM(s,e){const t=Pt(s),i=t.Au.get(e);if(i&&i.hu)return sn().add(i.key);{let l=sn();const c=t.Iu.get(e);if(!c)return l;for(const d of c){const g=t.Tu.get(d);l=l.unionWith(g.view.nu)}return l}}function tj(s){const e=Pt(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=Xk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=yM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=hM.bind(null,e),e.Pu.J_=eM.bind(null,e.eventManager),e.Pu.yu=tM.bind(null,e.eventManager),e}function vM(s){const e=Pt(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=fM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=mM.bind(null,e),e}class Jh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=jf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return x6(this.persistence,new v6,e.initialUser,this.serializer)}Cu(e){return new Ok(Py.Vi,this.serializer)}Du(e){return new C6}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Jh.provider={build:()=>new Jh};class bM extends Jh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){kn(this.persistence.referenceDelegate instanceof Qh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new s6(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?vr.withCacheSize(this.cacheSizeBytes):vr.DEFAULT;return new Ok((i=>Qh.Vi(i,t)),this.serializer)}}class Wp{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Nw(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=pM.bind(null,this.syncEngine),await X6(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new Z6})()}createDatastore(e){const t=jf(e.databaseInfo.databaseId),i=M6(e.databaseInfo);return V6(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,l,c,d,g){return new B6(i,l,c,d,g)})(this.localStore,this.datastore,e.asyncQueue,(t=>Nw(this.syncEngine,t,0)),(function(){return kw.v()?new kw:new N6})())}createSyncEngine(e,t){return(function(l,c,d,g,y,p,b){const _=new iM(l,c,d,g,y,p);return b&&(_.gu=!0),_})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=Pt(t);Je(qo,"RemoteStore shutting down."),i.Ea.add(5),await qu(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Wp.provider={build:()=>new Wp};class Xy{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):wa("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const ho="FirestoreClient";class wM{constructor(e,t,i,l,c){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=l,this.user=Xs.UNAUTHENTICATED,this.clientId=Ey.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=c,this.authCredentials.start(i,(async d=>{Je(ho,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(i,(d=>(Je(ho,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ma;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=qy(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Yg(s,e){s.asyncQueue.verifyOperationInProgress(),Je(ho,"Initializing OfflineComponentProvider");const t=s.configuration;await e.initialize(t);let i=t.initialUser;s.setCredentialChangeListener((async l=>{i.isEqual(l)||(await Vk(e.localStore,l),i=l)})),e.persistence.setDatabaseDeletedListener((()=>s.terminate())),s._offlineComponents=e}async function Rw(s,e){s.asyncQueue.verifyOperationInProgress();const t=await xM(s);Je(ho,"Initializing OnlineComponentProvider"),await e.initialize(t,s.configuration),s.setCredentialChangeListener((i=>Ew(e.remoteStore,i))),s.setAppCheckTokenChangeListener(((i,l)=>Ew(e.remoteStore,l))),s._onlineComponents=e}async function xM(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){Je(ho,"Using user provided OfflineComponentProvider");try{await Yg(s,s._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(l){return l.name==="FirebaseError"?l.code===_e.FAILED_PRECONDITION||l.code===_e.UNIMPLEMENTED:!(typeof DOMException<"u"&&l instanceof DOMException)||l.code===22||l.code===20||l.code===11})(t))throw t;Gl("Error using user provided cache. Falling back to memory cache: "+t),await Yg(s,new Jh)}}else Je(ho,"Using default OfflineComponentProvider"),await Yg(s,new bM(void 0));return s._offlineComponents}async function nj(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(Je(ho,"Using user provided OnlineComponentProvider"),await Rw(s,s._uninitializedComponentsProvider._online)):(Je(ho,"Using default OnlineComponentProvider"),await Rw(s,new Wp))),s._onlineComponents}function _M(s){return nj(s).then((e=>e.syncEngine))}async function Zh(s){const e=await nj(s),t=e.eventManager;return t.onListen=aM.bind(null,e.syncEngine),t.onUnlisten=cM.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=oM.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=uM.bind(null,e.syncEngine),t}function kM(s,e,t,i){const l=new Xy(i),c=new Ky(e,l,t);return s.asyncQueue.enqueueAndForget((async()=>$y(await Zh(s),c))),()=>{l.Nu(),s.asyncQueue.enqueueAndForget((async()=>Wy(await Zh(s),c)))}}function jM(s,e,t={}){const i=new ma;return s.asyncQueue.enqueueAndForget((async()=>(function(c,d,g,y,p){const b=new Xy({next:j=>{b.Nu(),d.enqueueAndForget((()=>Wy(c,_)));const I=j.docs.has(g);!I&&j.fromCache?p.reject(new We(_e.UNAVAILABLE,"Failed to get document because the client is offline.")):I&&j.fromCache&&y&&y.source==="server"?p.reject(new We(_e.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(j)},error:j=>p.reject(j)}),_=new Ky(pf(g.path),b,{includeMetadataChanges:!0,Ka:!0});return $y(c,_)})(await Zh(s),s.asyncQueue,e,t,i))),i.promise}function EM(s,e,t={}){const i=new ma;return s.asyncQueue.enqueueAndForget((async()=>(function(c,d,g,y,p){const b=new Xy({next:j=>{b.Nu(),d.enqueueAndForget((()=>Wy(c,_))),j.fromCache&&y.source==="server"?p.reject(new We(_e.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(j)},error:j=>p.reject(j)}),_=new Ky(g,b,{includeMetadataChanges:!0,Ka:!0});return $y(c,_)})(await Zh(s),s.asyncQueue,e,t,i))),i.promise}function TM(s,e){const t=new ma;return s.asyncQueue.enqueueAndForget((async()=>dM(await _M(s),e,t))),t.promise}function sj(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}const SM="ComponentProvider",Iw=new Map;function CM(s,e,t,i,l){return new KR(s,e,t,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,sj(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator,i)}const rj="firestore.googleapis.com",Mw=!0;class Dw{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new We(_e.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=rj,this.ssl=Mw}else this.host=e.host,this.ssl=e.ssl??Mw;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Pk;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<t6)throw new We(_e.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}OR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=sj(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new We(_e.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new We(_e.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new We(_e.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,l){return i.timeoutSeconds===l.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Sf{constructor(e,t,i,l){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=l,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Dw({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new We(_e.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new We(_e.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Dw(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new SR;switch(i.type){case"firstParty":return new RR(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new We(_e.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=Iw.get(t);i&&(Je(SM,"Removing Datastore"),Iw.delete(t),i.terminate())})(this),Promise.resolve()}}function NM(s,e,t,i={}){s=cr(s,Sf);const l=fo(e),c=s._getSettings(),d={...c,emulatorOptions:s._getEmulatorOptions()},g=`${e}:${t}`;l&&(ly(`https://${g}`),cy("Firestore",!0)),c.host!==rj&&c.host!==g&&Gl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const y={...c,host:g,ssl:l,emulatorOptions:i};if(!pa(y,d)&&(s._setSettings(y),i.mockUserToken)){let p,b;if(typeof i.mockUserToken=="string")p=i.mockUserToken,b=Xs.MOCK_USER;else{p=Jx(i.mockUserToken,s._app?.options.projectId);const _=i.mockUserToken.sub||i.mockUserToken.user_id;if(!_)throw new We(_e.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");b=new Xs(_)}s._authCredentials=new CR(new W_(p,b))}}class po{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new po(this.firestore,e,this._query)}}class rs{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ro(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new rs(this.firestore,e,this._key)}toJSON(){return{type:rs._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(zu(t,rs._jsonSchema))return new rs(e,i||null,new ft(Dn.fromString(t.referencePath)))}}rs._jsonSchemaVersion="firestore/documentReference/1.0",rs._jsonSchema={type:ks("string",rs._jsonSchemaVersion),referencePath:ks("string")};class ro extends po{constructor(e,t,i){super(e,t,pf(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new rs(this.firestore,null,new ft(e))}withConverter(e){return new ro(this.firestore,e,this._path)}}function ut(s,e,...t){if(s=jn(s),G_("collection","path",e),s instanceof Sf){const i=Dn.fromString(e,...t);return G2(i),new ro(s,null,i)}{if(!(s instanceof rs||s instanceof ro))throw new We(_e.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(Dn.fromString(e,...t));return G2(i),new ro(s.firestore,null,i)}}function ze(s,e,...t){if(s=jn(s),arguments.length===1&&(e=Ey.newId()),G_("doc","path",e),s instanceof Sf){const i=Dn.fromString(e,...t);return W2(i),new rs(s,null,new ft(i))}{if(!(s instanceof rs||s instanceof ro))throw new We(_e.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(Dn.fromString(e,...t));return W2(i),new rs(s.firestore,s instanceof ro?s.converter:null,new ft(i))}}const Lw="AsyncQueue";class Pw{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Bk(this,"async_queue_retry"),this._c=()=>{const i=Kg();i&&Je(Lw,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Kg();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Kg();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new ma;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!cc(e))throw e;Je(Lw,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,wa("INTERNAL UNHANDLED ERROR: ",Ow(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const l=Hy.createAndSchedule(this,e,t,i,(c=>this.hc(c)));return this.tc.push(l),l}uc(){this.nc&&jt(47125,{Pc:Ow(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Ow(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}class Vi extends Sf{constructor(e,t,i,l){super(e,t,i,l),this.type="firestore",this._queue=new Pw,this._persistenceKey=l?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Pw(e),this._firestoreClient=void 0,await e}}}function AM(s,e){const t=typeof s=="object"?s:Ou(),i=typeof s=="string"?s:Wh,l=Qo(t,"firestore").getImmediate({identifier:i});if(!l._initialized){const c=Yx("firestore");c&&NM(l,...c)}return l}function Wu(s){if(s._terminated)throw new We(_e.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||RM(s),s._firestoreClient}function RM(s){const e=s._freezeSettings(),t=CM(s._databaseId,s._app?.options.appId||"",s._persistenceKey,s._app?.options.apiKey,e);s._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new wM(s._authCredentials,s._appCheckCredentials,s._queue,t,s._componentsProvider&&(function(l){const c=l?._online.build();return{_offline:l?._offline.build(c),_online:c}})(s._componentsProvider))}class Jr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Jr(Fs.fromBase64String(e))}catch(t){throw new We(_e.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Jr(Fs.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Jr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(zu(e,Jr._jsonSchema))return Jr.fromBase64String(e.bytes)}}Jr._jsonSchemaVersion="firestore/bytes/1.0",Jr._jsonSchema={type:ks("string",Jr._jsonSchemaVersion),bytes:ks("string")};class Cf{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new We(_e.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new zs(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class el{constructor(e){this._methodName=e}}class Pi{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new We(_e.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new We(_e.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return nn(this._lat,e._lat)||nn(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Pi._jsonSchemaVersion}}static fromJSON(e){if(zu(e,Pi._jsonSchema))return new Pi(e.latitude,e.longitude)}}Pi._jsonSchemaVersion="firestore/geoPoint/1.0",Pi._jsonSchema={type:ks("string",Pi._jsonSchemaVersion),latitude:ks("number"),longitude:ks("number")};class pi{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,l){if(i.length!==l.length)return!1;for(let c=0;c<i.length;++c)if(i[c]!==l[c])return!1;return!0})(this._values,e._values)}toJSON(){return{type:pi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(zu(e,pi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new pi(e.vectorValues);throw new We(_e.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}pi._jsonSchemaVersion="firestore/vectorValue/1.0",pi._jsonSchema={type:ks("string",pi._jsonSchemaVersion),vectorValues:ks("object")};const IM=/^__.*__$/;class MM{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new go(e,this.data,this.fieldMask,t,this.fieldTransforms):new Fu(e,this.data,t,this.fieldTransforms)}}class ij{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new go(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function aj(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw jt(40011,{dataSource:s})}}class Nf{constructor(e,t,i,l,c,d){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=l,c===void 0&&this.validatePath(),this.fieldTransforms=c||[],this.fieldMask=d||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Nf({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return ef(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(aj(this.dataSource)&&IM.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class DM{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||jf(e)}createContext(e,t,i,l=!1){return new Nf({dataSource:e,methodName:t,targetDoc:i,path:zs.emptyPath(),arrayElement:!1,hasConverter:l},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Gu(s){const e=s._freezeSettings(),t=jf(s._databaseId);return new DM(s._databaseId,!!e.ignoreUndefinedProperties,t)}function Jy(s,e,t,i,l,c={}){const d=s.createContext(c.merge||c.mergeFields?2:0,e,t,l);s0("Data must be an object, but it was:",d,i);const g=uj(i,d);let y,p;if(c.merge)y=new Lr(d.fieldMask),p=d.fieldTransforms;else if(c.mergeFields){const b=[];for(const _ of c.mergeFields){const j=$o(e,_,t);if(!d.contains(j))throw new We(_e.INVALID_ARGUMENT,`Field '${j}' is specified in your field mask but missing from your input data.`);fj(b,j)||b.push(j)}y=new Lr(b),p=d.fieldTransforms.filter((_=>y.covers(_.field)))}else y=null,p=d.fieldTransforms;return new MM(new wr(g),y,p)}class Af extends el{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Af}}function oj(s,e,t){return new Nf({dataSource:3,targetDoc:e.settings.targetDoc,methodName:s._methodName,arrayElement:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Zy extends el{_toFieldTransform(e){return new wf(e.path,new Au)}isEqual(e){return e instanceof Zy}}class e0 extends el{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=oj(this,e,!0),i=this.Ac.map((c=>tl(c,t))),l=new Xl(i);return new wf(e.path,l)}isEqual(e){return e instanceof e0&&pa(this.Ac,e.Ac)}}class t0 extends el{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=oj(this,e,!0),i=this.Ac.map((c=>tl(c,t))),l=new Jl(i);return new wf(e.path,l)}isEqual(e){return e instanceof t0&&pa(this.Ac,e.Ac)}}class n0 extends el{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new Ru(e.serializer,vk(e.serializer,this.Vc));return new wf(e.path,t)}isEqual(e){return e instanceof n0&&this.Vc===e.Vc}}function lj(s,e,t,i){const l=s.createContext(1,e,t);s0("Data must be an object, but it was:",l,i);const c=[],d=wr.empty();mo(i,((y,p)=>{const b=hj(e,y,t);p=jn(p);const _=l.childContextForFieldPath(b);if(p instanceof Af)c.push(b);else{const j=tl(p,_);j!=null&&(c.push(b),d.set(b,j))}}));const g=new Lr(c);return new ij(d,g,l.fieldTransforms)}function cj(s,e,t,i,l,c){const d=s.createContext(1,e,t),g=[$o(e,i,t)],y=[l];if(c.length%2!=0)throw new We(_e.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let j=0;j<c.length;j+=2)g.push($o(e,c[j])),y.push(c[j+1]);const p=[],b=wr.empty();for(let j=g.length-1;j>=0;--j)if(!fj(p,g[j])){const I=g[j];let F=y[j];F=jn(F);const G=d.childContextForFieldPath(I);if(F instanceof Af)p.push(I);else{const B=tl(F,G);B!=null&&(p.push(I),b.set(I,B))}}const _=new Lr(p);return new ij(b,_,d.fieldTransforms)}function LM(s,e,t,i=!1){return tl(t,s.createContext(i?4:3,e))}function tl(s,e){if(dj(s=jn(s)))return s0("Unsupported field value:",e,s),uj(s,e);if(s instanceof el)return(function(i,l){if(!aj(l.dataSource))throw l.createError(`${i._methodName}() can only be used with update() and set()`);if(!l.path)throw l.createError(`${i._methodName}() is not currently supported inside arrays`);const c=i._toFieldTransform(l);c&&l.fieldTransforms.push(c)})(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,l){const c=[];let d=0;for(const g of i){let y=tl(g,l.childContextForArray(d));y==null&&(y={nullValue:"NULL_VALUE"}),c.push(y),d++}return{arrayValue:{values:c}}})(s,e)}return(function(i,l){if((i=jn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return vk(l.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const c=Bt.fromDate(i);return{timestampValue:Yh(l.serializer,c)}}if(i instanceof Bt){const c=new Bt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Yh(l.serializer,c)}}if(i instanceof Pi)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Jr)return{bytesValue:Ck(l.serializer,i._byteString)};if(i instanceof rs){const c=l.databaseId,d=i.firestore._databaseId;if(!d.isEqual(c))throw l.createError(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${c.projectId}/${c.database}`);return{referenceValue:Dy(i.firestore._databaseId||l.databaseId,i._key.path)}}if(i instanceof pi)return(function(d,g){const y=d instanceof pi?d.toArray():d;return{mapValue:{fields:{[nk]:{stringValue:sk},[Gh]:{arrayValue:{values:y.map((b=>{if(typeof b!="number")throw g.createError("VectorValues must only contain numeric values.");return Ry(g.serializer,b)}))}}}}}})(i,l);if(Lk(i))return i._toProto(l.serializer);throw l.createError(`Unsupported field value: ${hf(i)}`)})(s,e)}function uj(s,e){const t={};return Q_(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):mo(s,((i,l)=>{const c=tl(l,e.childContextForField(i));c!=null&&(t[i]=c)})),{mapValue:{fields:t}}}function dj(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof Bt||s instanceof Pi||s instanceof Jr||s instanceof rs||s instanceof el||s instanceof pi||Lk(s))}function s0(s,e,t){if(!dj(t)||!K_(t)){const i=hf(t);throw i==="an object"?e.createError(s+" a custom object"):e.createError(s+" "+i)}}function $o(s,e,t){if((e=jn(e))instanceof Cf)return e._internalPath;if(typeof e=="string")return hj(s,e);throw ef("Field path arguments must be of type string or ",s,!1,void 0,t)}const PM=new RegExp("[~\\*/\\[\\]]");function hj(s,e,t){if(e.search(PM)>=0)throw ef(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,t);try{return new Cf(...e.split("."))._internalPath}catch{throw ef(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,t)}}function ef(s,e,t,i,l){const c=i&&!i.isEmpty(),d=l!==void 0;let g=`Function ${e}() called with invalid data`;t&&(g+=" (via `toFirestore()`)"),g+=". ";let y="";return(c||d)&&(y+=" (found",c&&(y+=` in field ${i}`),d&&(y+=` in document ${l}`),y+=")"),new We(_e.INVALID_ARGUMENT,g+s+y)}function fj(s,e){return s.some((t=>t.isEqual(e)))}class OM{convertValue(e,t="none"){switch(co(e)){case 0:return null;case 1:return e.booleanValue;case 2:return hs(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(lo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw jt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return mo(e,((l,c)=>{i[l]=this.convertValue(c,t)})),i}convertVectorValue(e){const t=e.fields?.[Gh].arrayValue?.values?.map((i=>hs(i.doubleValue)));return new pi(t)}convertGeoPoint(e){return new Pi(hs(e.latitude),hs(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=gf(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Tu(e));default:return null}}convertTimestamp(e){const t=oo(e);return new Bt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=Dn.fromString(e);kn(Dk(i),9688,{name:e});const l=new Su(i.get(1),i.get(3)),c=new ft(i.popFirst(5));return l.isEqual(t)||wa(`Document ${c} contains a document reference within a different database (${l.projectId}/${l.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),c}}class r0 extends OM{constructor(e){super(),this.firestore=e}convertBytes(e){return new Jr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new rs(this.firestore,null,t)}}function xs(){return new Zy("serverTimestamp")}function VM(...s){return new e0("arrayUnion",s)}function UM(...s){return new t0("arrayRemove",s)}function mi(s){return new n0("increment",s)}const Vw="@firebase/firestore",Uw="4.10.0";function Bw(s){return(function(t,i){if(typeof t!="object"||t===null)return!1;const l=t;for(const c of i)if(c in l&&typeof l[c]=="function")return!0;return!1})(s,["next","error","complete"])}class mj{constructor(e,t,i,l,c){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=l,this._converter=c}get id(){return this._key.path.lastSegment()}get ref(){return new rs(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new BM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field($o("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class BM extends mj{data(){return super.data()}}function gj(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new We(_e.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class i0{}class pj extends i0{}function tn(s,e,...t){let i=[];e instanceof i0&&i.push(e),i=i.concat(t),(function(c){const d=c.filter((y=>y instanceof a0)).length,g=c.filter((y=>y instanceof Rf)).length;if(d>1||d>0&&g>0)throw new We(_e.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const l of i)s=l._apply(s);return s}class Rf extends pj{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new Rf(e,t,i)}_apply(e){const t=this._parse(e);return yj(e._query,t),new po(e.firestore,e.converter,Pp(e._query,t))}_parse(e){const t=Gu(e.firestore);return(function(c,d,g,y,p,b,_){let j;if(p.isKeyField()){if(b==="array-contains"||b==="array-contains-any")throw new We(_e.INVALID_ARGUMENT,`Invalid Query. You can't perform '${b}' queries on documentId().`);if(b==="in"||b==="not-in"){Fw(_,b);const F=[];for(const G of _)F.push(zw(y,c,G));j={arrayValue:{values:F}}}else j=zw(y,c,_)}else b!=="in"&&b!=="not-in"&&b!=="array-contains-any"||Fw(_,b),j=LM(g,d,_,b==="in"||b==="not-in");return ws.create(p,b,j)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Ot(s,e,t){const i=e,l=$o("where",s);return Rf._create(l,i,t)}class a0 extends i0{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new a0(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:vi.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(l,c){let d=l;const g=c.getFlattenedFilters();for(const y of g)yj(d,y),d=Pp(d,y)})(e._query,t),new po(e.firestore,e.converter,Pp(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class o0 extends pj{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new o0(e,t)}_apply(e){const t=(function(l,c,d){if(l.startAt!==null)throw new We(_e.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(l.endAt!==null)throw new We(_e.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Nu(c,d)})(e._query,this._field,this._direction);return new po(e.firestore,e.converter,hI(e._query,t))}}function iO(s,e="asc"){const t=e,i=$o("orderBy",s);return o0._create(i,t)}function zw(s,e,t){if(typeof(t=jn(t))=="string"){if(t==="")throw new We(_e.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!dk(e)&&t.indexOf("/")!==-1)throw new We(_e.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(Dn.fromString(t));if(!ft.isDocumentKey(i))throw new We(_e.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return tw(s,new ft(i))}if(t instanceof rs)return tw(s,t._key);throw new We(_e.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${hf(t)}.`)}function Fw(s,e){if(!Array.isArray(s)||s.length===0)throw new We(_e.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function yj(s,e){const t=(function(l,c){for(const d of l)for(const g of d.getFlattenedFilters())if(c.indexOf(g.op)>=0)return g.op;return null})(s.filters,(function(l){switch(l){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new We(_e.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new We(_e.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function l0(s,e,t){let i;return i=s?t&&(t.merge||t.mergeFields)?s.toFirestore(e,t):s.toFirestore(e):e,i}class du{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Uo extends mj{constructor(e,t,i,l,c,d){super(e,t,i,l,d),this._firestore=e,this._firestoreImpl=e,this.metadata=c}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Dh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field($o("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new We(_e.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Uo._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Uo._jsonSchemaVersion="firestore/documentSnapshot/1.0",Uo._jsonSchema={type:ks("string",Uo._jsonSchemaVersion),bundleSource:ks("string","DocumentSnapshot"),bundleName:ks("string"),bundle:ks("string")};class Dh extends Uo{data(e={}){return super.data(e)}}class Bo{constructor(e,t,i,l){this._firestore=e,this._userDataWriter=t,this._snapshot=l,this.metadata=new du(l.hasPendingWrites,l.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Dh(this._firestore,this._userDataWriter,i.key,i,new du(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new We(_e.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(l,c){if(l._snapshot.oldDocs.isEmpty()){let d=0;return l._snapshot.docChanges.map((g=>{const y=new Dh(l._firestore,l._userDataWriter,g.doc.key,g.doc,new du(l._snapshot.mutatedKeys.has(g.doc.key),l._snapshot.fromCache),l.query.converter);return g.doc,{type:"added",doc:y,oldIndex:-1,newIndex:d++}}))}{let d=l._snapshot.oldDocs;return l._snapshot.docChanges.filter((g=>c||g.type!==3)).map((g=>{const y=new Dh(l._firestore,l._userDataWriter,g.doc.key,g.doc,new du(l._snapshot.mutatedKeys.has(g.doc.key),l._snapshot.fromCache),l.query.converter);let p=-1,b=-1;return g.type!==0&&(p=d.indexOf(g.doc.key),d=d.delete(g.doc.key)),g.type!==1&&(d=d.add(g.doc),b=d.indexOf(g.doc.key)),{type:zM(g.type),doc:y,oldIndex:p,newIndex:b}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new We(_e.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Bo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Ey.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],l=[];return this.docs.forEach((c=>{c._document!==null&&(t.push(c._document),i.push(this._userDataWriter.convertObjectMap(c._document.data.value.mapValue.fields,"previous")),l.push(c.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function zM(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return jt(61501,{type:s})}}Bo._jsonSchemaVersion="firestore/querySnapshot/1.0",Bo._jsonSchema={type:ks("string",Bo._jsonSchemaVersion),bundleSource:ks("string","QuerySnapshot"),bundleName:ks("string"),bundle:ks("string")};class FM{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Gu(e)}set(e,t,i){this._verifyNotCommitted();const l=Qg(e,this._firestore),c=l0(l.converter,t,i),d=Jy(this._dataReader,"WriteBatch.set",l._key,c,l.converter!==null,i);return this._mutations.push(d.toMutation(l._key,ur.none())),this}update(e,t,i,...l){this._verifyNotCommitted();const c=Qg(e,this._firestore);let d;return d=typeof(t=jn(t))=="string"||t instanceof Cf?cj(this._dataReader,"WriteBatch.update",c._key,t,i,l):lj(this._dataReader,"WriteBatch.update",c._key,t),this._mutations.push(d.toMutation(c._key,ur.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Qg(e,this._firestore);return this._mutations=this._mutations.concat(new _f(t._key,ur.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new We(_e.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Qg(s,e){if((s=jn(s)).firestore!==e)throw new We(_e.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return s}function _s(s){s=cr(s,rs);const e=cr(s.firestore,Vi),t=Wu(e);return jM(t,s._key).then((i=>bj(e,s,i)))}function $t(s){s=cr(s,po);const e=cr(s.firestore,Vi),t=Wu(e),i=new r0(e);return gj(s._query),EM(t,s._query).then((l=>new Bo(e,i,s,l)))}function Wn(s,e,t){s=cr(s,rs);const i=cr(s.firestore,Vi),l=l0(s.converter,e,t),c=Gu(i);return Ku(i,[Jy(c,"setDoc",s._key,l,s.converter!==null,t).toMutation(s._key,ur.none())])}function zn(s,e,t,...i){s=cr(s,rs);const l=cr(s.firestore,Vi),c=Gu(l);let d;return d=typeof(e=jn(e))=="string"||e instanceof Cf?cj(c,"updateDoc",s._key,e,t,i):lj(c,"updateDoc",s._key,e),Ku(l,[d.toMutation(s._key,ur.exists(!0))])}function ar(s){return Ku(cr(s.firestore,Vi),[new _f(s._key,ur.none())])}function or(s,e){const t=cr(s.firestore,Vi),i=ze(s),l=l0(s.converter,e),c=Gu(s.firestore);return Ku(t,[Jy(c,"addDoc",i._key,l,s.converter!==null,{}).toMutation(i._key,ur.exists(!1))]).then((()=>i))}function vj(s,...e){s=jn(s);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||Bw(e[i])||(t=e[i++]);const l={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Bw(e[i])){const p=e[i];e[i]=p.next?.bind(p),e[i+1]=p.error?.bind(p),e[i+2]=p.complete?.bind(p)}let c,d,g;if(s instanceof rs)d=cr(s.firestore,Vi),g=pf(s._key.path),c={next:p=>{e[i]&&e[i](bj(d,s,p))},error:e[i+1],complete:e[i+2]};else{const p=cr(s,po);d=cr(p.firestore,Vi),g=p._query;const b=new r0(d);c={next:_=>{e[i]&&e[i](new Bo(d,b,p,_))},error:e[i+1],complete:e[i+2]},gj(s._query)}const y=Wu(d);return kM(y,g,l,c)}function Ku(s,e){const t=Wu(s);return TM(t,e)}function bj(s,e,t){const i=t.docs.get(e._key),l=new r0(s);return new Uo(s,l,e._key,i,new du(t.hasPendingWrites,t.fromCache),e.converter)}function Hw(s){return s=cr(s,Vi),Wu(s),new FM(s,(e=>Ku(s,e)))}(function(e,t=!0){TR(Xo),yi(new ei("firestore",((i,{instanceIdentifier:l,options:c})=>{const d=i.getProvider("app").getImmediate(),g=new Vi(new NR(i.getProvider("auth-internal")),new IR(d,i.getProvider("app-check-internal")),YR(d,l),d);return c={useFetchStreams:t,...c},g._setSettings(c),g}),"PUBLIC").setMultipleInstances(!0)),xr(Vw,Uw,e),xr(Vw,Uw,"esm2020")})();var HM="firebase",qM="12.8.0";xr(HM,qM,"app");const wj="firebasestorage.googleapis.com",xj="storageBucket",$M=120*1e3,WM=600*1e3;class as extends wi{constructor(e,t,i=0){super(Xg(e),`Firebase Storage: ${t} (${Xg(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,as.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Xg(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var is;(function(s){s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(is||(is={}));function Xg(s){return"storage/"+s}function c0(){const s="An unknown error occurred, please check the error payload for server response.";return new as(is.UNKNOWN,s)}function GM(s){return new as(is.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")}function KM(s){return new as(is.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function YM(){const s="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new as(is.UNAUTHENTICATED,s)}function QM(){return new as(is.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function XM(s){return new as(is.UNAUTHORIZED,"User does not have permission to access '"+s+"'.")}function JM(){return new as(is.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function ZM(){return new as(is.CANCELED,"User canceled the upload/download.")}function eD(s){return new as(is.INVALID_URL,"Invalid URL '"+s+"'.")}function tD(s){return new as(is.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function nD(){return new as(is.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+xj+"' property when initializing the app?")}function sD(){return new as(is.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function rD(){return new as(is.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function iD(s){return new as(is.UNSUPPORTED_ENVIRONMENT,`${s} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Gp(s){return new as(is.INVALID_ARGUMENT,s)}function _j(){return new as(is.APP_DELETED,"The Firebase app was deleted.")}function aD(s){return new as(is.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function bu(s,e){return new as(is.INVALID_FORMAT,"String does not match format '"+s+"': "+e)}function eu(s){throw new as(is.INTERNAL_ERROR,"Internal error: "+s)}class lr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=lr.makeFromUrl(e,t)}catch{return new lr(e,"")}if(i.path==="")return i;throw tD(e)}static makeFromUrl(e,t){let i=null;const l="([A-Za-z0-9.\\-_]+)";function c(pe){pe.path.charAt(pe.path.length-1)==="/"&&(pe.path_=pe.path_.slice(0,-1))}const d="(/(.*))?$",g=new RegExp("^gs://"+l+d,"i"),y={bucket:1,path:3};function p(pe){pe.path_=decodeURIComponent(pe.path)}const b="v[A-Za-z0-9_]+",_=t.replace(/[.]/g,"\\."),j="(/([^?#]*).*)?$",I=new RegExp(`^https?://${_}/${b}/b/${l}/o${j}`,"i"),F={bucket:1,path:3},G=t===wj?"(?:storage.googleapis.com|storage.cloud.google.com)":t,B="([^?#]*)",Y=new RegExp(`^https?://${G}/${l}/${B}`,"i"),re=[{regex:g,indices:y,postModify:c},{regex:I,indices:F,postModify:p},{regex:Y,indices:{bucket:1,path:2},postModify:p}];for(let pe=0;pe<re.length;pe++){const ve=re[pe],he=ve.regex.exec(e);if(he){const L=he[ve.indices.bucket];let E=he[ve.indices.path];E||(E=""),i=new lr(L,E),ve.postModify(i);break}}if(i==null)throw eD(e);return i}}class oD{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function lD(s,e,t){let i=1,l=null,c=null,d=!1,g=0;function y(){return g===2}let p=!1;function b(...B){p||(p=!0,e.apply(null,B))}function _(B){l=setTimeout(()=>{l=null,s(I,y())},B)}function j(){c&&clearTimeout(c)}function I(B,...Y){if(p){j();return}if(B){j(),b.call(null,B,...Y);return}if(y()||d){j(),b.call(null,B,...Y);return}i<64&&(i*=2);let re;g===1?(g=2,re=0):re=(i+Math.random())*1e3,_(re)}let F=!1;function G(B){F||(F=!0,j(),!p&&(l!==null?(B||(g=2),clearTimeout(l),_(0)):B||(g=1)))}return _(0),c=setTimeout(()=>{d=!0,G(!0)},t),G}function cD(s){s(!1)}function uD(s){return s!==void 0}function dD(s){return typeof s=="object"&&!Array.isArray(s)}function u0(s){return typeof s=="string"||s instanceof String}function qw(s){return d0()&&s instanceof Blob}function d0(){return typeof Blob<"u"}function Kp(s,e,t,i){if(i<e)throw Gp(`Invalid value for '${s}'. Expected ${e} or greater.`);if(i>t)throw Gp(`Invalid value for '${s}'. Expected ${t} or less.`)}function If(s,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${s}`}function kj(s){const e=encodeURIComponent;let t="?";for(const i in s)if(s.hasOwnProperty(i)){const l=e(i)+"="+e(s[i]);t=t+l+"&"}return t=t.slice(0,-1),t}var zo;(function(s){s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT"})(zo||(zo={}));function hD(s,e){const t=s>=500&&s<600,l=[408,429].indexOf(s)!==-1,c=e.indexOf(s)!==-1;return t||l||c}class fD{constructor(e,t,i,l,c,d,g,y,p,b,_,j=!0,I=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=l,this.successCodes_=c,this.additionalRetryCodes_=d,this.callback_=g,this.errorCallback_=y,this.timeout_=p,this.progressCallback_=b,this.connectionFactory_=_,this.retry=j,this.isUsingEmulator=I,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((F,G)=>{this.resolve_=F,this.reject_=G,this.start_()})}start_(){const e=(i,l)=>{if(l){i(!1,new ph(!1,null,!0));return}const c=this.connectionFactory_();this.pendingConnection_=c;const d=g=>{const y=g.loaded,p=g.lengthComputable?g.total:-1;this.progressCallback_!==null&&this.progressCallback_(y,p)};this.progressCallback_!==null&&c.addUploadProgressListener(d),c.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&c.removeUploadProgressListener(d),this.pendingConnection_=null;const g=c.getErrorCode()===zo.NO_ERROR,y=c.getStatus();if(!g||hD(y,this.additionalRetryCodes_)&&this.retry){const b=c.getErrorCode()===zo.ABORT;i(!1,new ph(!1,null,b));return}const p=this.successCodes_.indexOf(y)!==-1;i(!0,new ph(p,c))})},t=(i,l)=>{const c=this.resolve_,d=this.reject_,g=l.connection;if(l.wasSuccessCode)try{const y=this.callback_(g,g.getResponse());uD(y)?c(y):c()}catch(y){d(y)}else if(g!==null){const y=c0();y.serverResponse=g.getErrorText(),this.errorCallback_?d(this.errorCallback_(g,y)):d(y)}else if(l.canceled){const y=this.appDelete_?_j():ZM();d(y)}else{const y=JM();d(y)}};this.canceled_?t(!1,new ph(!1,null,!0)):this.backoffId_=lD(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&cD(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class ph{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function mD(s,e){e!==null&&e.length>0&&(s.Authorization="Firebase "+e)}function gD(s,e){s["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function pD(s,e){e&&(s["X-Firebase-GMPID"]=e)}function yD(s,e){e!==null&&(s["X-Firebase-AppCheck"]=e)}function vD(s,e,t,i,l,c,d=!0,g=!1){const y=kj(s.urlParams),p=s.url+y,b=Object.assign({},s.headers);return pD(b,e),mD(b,t),gD(b,c),yD(b,i),new fD(p,s.method,b,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,l,d,g)}function bD(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function wD(...s){const e=bD();if(e!==void 0){const t=new e;for(let i=0;i<s.length;i++)t.append(s[i]);return t.getBlob()}else{if(d0())return new Blob(s);throw new as(is.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function xD(s,e,t){return s.webkitSlice?s.webkitSlice(e,t):s.mozSlice?s.mozSlice(e,t):s.slice?s.slice(e,t):null}function _D(s){if(typeof atob>"u")throw iD("base-64");return atob(s)}const Ii={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Jg{constructor(e,t){this.data=e,this.contentType=t||null}}function kD(s,e){switch(s){case Ii.RAW:return new Jg(jj(e));case Ii.BASE64:case Ii.BASE64URL:return new Jg(Ej(s,e));case Ii.DATA_URL:return new Jg(ED(e),TD(e))}throw c0()}function jj(s){const e=[];for(let t=0;t<s.length;t++){let i=s.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<s.length-1&&(s.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const c=i,d=s.charCodeAt(++t);i=65536|(c&1023)<<10|d&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function jD(s){let e;try{e=decodeURIComponent(s)}catch{throw bu(Ii.DATA_URL,"Malformed data URL.")}return jj(e)}function Ej(s,e){switch(s){case Ii.BASE64:{const l=e.indexOf("-")!==-1,c=e.indexOf("_")!==-1;if(l||c)throw bu(s,"Invalid character '"+(l?"-":"_")+"' found: is it base64url encoded?");break}case Ii.BASE64URL:{const l=e.indexOf("+")!==-1,c=e.indexOf("/")!==-1;if(l||c)throw bu(s,"Invalid character '"+(l?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=_D(e)}catch(l){throw l.message.includes("polyfill")?l:bu(s,"Invalid character found")}const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i}class Tj{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw bu(Ii.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=SD(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function ED(s){const e=new Tj(s);return e.base64?Ej(Ii.BASE64,e.rest):jD(e.rest)}function TD(s){return new Tj(s).contentType}function SD(s,e){return s.length>=e.length?s.substring(s.length-e.length)===e:!1}class eo{constructor(e,t){let i=0,l="";qw(e)?(this.data_=e,i=e.size,l=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=l}size(){return this.size_}type(){return this.type_}slice(e,t){if(qw(this.data_)){const i=this.data_,l=xD(i,e,t);return l===null?null:new eo(l)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new eo(i,!0)}}static getBlob(...e){if(d0()){const t=e.map(i=>i instanceof eo?i.data_:i);return new eo(wD.apply(null,t))}else{const t=e.map(d=>u0(d)?kD(Ii.RAW,d).data:d.data_);let i=0;t.forEach(d=>{i+=d.byteLength});const l=new Uint8Array(i);let c=0;return t.forEach(d=>{for(let g=0;g<d.length;g++)l[c++]=d[g]}),new eo(l,!0)}}uploadData(){return this.data_}}function h0(s){let e;try{e=JSON.parse(s)}catch{return null}return dD(e)?e:null}function CD(s){if(s.length===0)return null;const e=s.lastIndexOf("/");return e===-1?"":s.slice(0,e)}function ND(s,e){const t=e.split("/").filter(i=>i.length>0).join("/");return s.length===0?t:s+"/"+t}function Sj(s){const e=s.lastIndexOf("/",s.length-2);return e===-1?s:s.slice(e+1)}function AD(s,e){return e}class ir{constructor(e,t,i,l){this.server=e,this.local=t||e,this.writable=!!i,this.xform=l||AD}}let yh=null;function RD(s){return!u0(s)||s.length<2?s:Sj(s)}function Cj(){if(yh)return yh;const s=[];s.push(new ir("bucket")),s.push(new ir("generation")),s.push(new ir("metageneration")),s.push(new ir("name","fullPath",!0));function e(c,d){return RD(d)}const t=new ir("name");t.xform=e,s.push(t);function i(c,d){return d!==void 0?Number(d):d}const l=new ir("size");return l.xform=i,s.push(l),s.push(new ir("timeCreated")),s.push(new ir("updated")),s.push(new ir("md5Hash",null,!0)),s.push(new ir("cacheControl",null,!0)),s.push(new ir("contentDisposition",null,!0)),s.push(new ir("contentEncoding",null,!0)),s.push(new ir("contentLanguage",null,!0)),s.push(new ir("contentType",null,!0)),s.push(new ir("metadata","customMetadata",!0)),yh=s,yh}function ID(s,e){function t(){const i=s.bucket,l=s.fullPath,c=new lr(i,l);return e._makeStorageReference(c)}Object.defineProperty(s,"ref",{get:t})}function MD(s,e,t){const i={};i.type="file";const l=t.length;for(let c=0;c<l;c++){const d=t[c];i[d.local]=d.xform(i,e[d.server])}return ID(i,s),i}function Nj(s,e,t){const i=h0(e);return i===null?null:MD(s,i,t)}function DD(s,e,t,i){const l=h0(e);if(l===null||!u0(l.downloadTokens))return null;const c=l.downloadTokens;if(c.length===0)return null;const d=encodeURIComponent;return c.split(",").map(p=>{const b=s.bucket,_=s.fullPath,j="/b/"+d(b)+"/o/"+d(_),I=If(j,t,i),F=kj({alt:"media",token:p});return I+F})[0]}function LD(s,e){const t={},i=e.length;for(let l=0;l<i;l++){const c=e[l];c.writable&&(t[c.server]=s[c.local])}return JSON.stringify(t)}const $w="prefixes",Ww="items";function PD(s,e,t){const i={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[$w])for(const l of t[$w]){const c=l.replace(/\/$/,""),d=s._makeStorageReference(new lr(e,c));i.prefixes.push(d)}if(t[Ww])for(const l of t[Ww]){const c=s._makeStorageReference(new lr(e,l.name));i.items.push(c)}return i}function OD(s,e,t){const i=h0(t);return i===null?null:PD(s,e,i)}class f0{constructor(e,t,i,l){this.url=e,this.method=t,this.handler=i,this.timeout=l,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function m0(s){if(!s)throw c0()}function VD(s,e){function t(i,l){const c=Nj(s,l,e);return m0(c!==null),c}return t}function UD(s,e){function t(i,l){const c=OD(s,e,l);return m0(c!==null),c}return t}function BD(s,e){function t(i,l){const c=Nj(s,l,e);return m0(c!==null),DD(c,l,s.host,s._protocol)}return t}function g0(s){function e(t,i){let l;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?l=QM():l=YM():t.getStatus()===402?l=KM(s.bucket):t.getStatus()===403?l=XM(s.path):l=i,l.status=t.getStatus(),l.serverResponse=i.serverResponse,l}return e}function zD(s){const e=g0(s);function t(i,l){let c=e(i,l);return i.getStatus()===404&&(c=GM(s.path)),c.serverResponse=l.serverResponse,c}return t}function FD(s,e,t,i,l){const c={};e.isRoot?c.prefix="":c.prefix=e.path+"/",t.length>0&&(c.delimiter=t),i&&(c.pageToken=i),l&&(c.maxResults=l);const d=e.bucketOnlyServerUrl(),g=If(d,s.host,s._protocol),y="GET",p=s.maxOperationRetryTime,b=new f0(g,y,UD(s,e.bucket),p);return b.urlParams=c,b.errorHandler=g0(e),b}function HD(s,e,t){const i=e.fullServerUrl(),l=If(i,s.host,s._protocol),c="GET",d=s.maxOperationRetryTime,g=new f0(l,c,BD(s,t),d);return g.errorHandler=zD(e),g}function qD(s,e){return s&&s.contentType||e&&e.type()||"application/octet-stream"}function $D(s,e,t){const i=Object.assign({},t);return i.fullPath=s.path,i.size=e.size(),i.contentType||(i.contentType=qD(null,e)),i}function WD(s,e,t,i,l){const c=e.bucketOnlyServerUrl(),d={"X-Goog-Upload-Protocol":"multipart"};function g(){let re="";for(let pe=0;pe<2;pe++)re=re+Math.random().toString().slice(2);return re}const y=g();d["Content-Type"]="multipart/related; boundary="+y;const p=$D(e,i,l),b=LD(p,t),_="--"+y+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+b+`\r
--`+y+`\r
Content-Type: `+p.contentType+`\r
\r
`,j=`\r
--`+y+"--",I=eo.getBlob(_,i,j);if(I===null)throw sD();const F={name:p.fullPath},G=If(c,s.host,s._protocol),B="POST",Y=s.maxUploadRetryTime,ee=new f0(G,B,VD(s,t),Y);return ee.urlParams=F,ee.headers=d,ee.body=I.uploadData(),ee.errorHandler=g0(e),ee}class GD{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=zo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=zo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=zo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,l,c){if(this.sent_)throw eu("cannot .send() more than once");if(fo(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),c!==void 0)for(const d in c)c.hasOwnProperty(d)&&this.xhr_.setRequestHeader(d,c[d].toString());return l!==void 0?this.xhr_.send(l):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw eu("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw eu("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw eu("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw eu("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class KD extends GD{initXhr(){this.xhr_.responseType="text"}}function p0(){return new KD}class Wo{constructor(e,t){this._service=e,t instanceof lr?this._location=t:this._location=lr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Wo(e,t)}get root(){const e=new lr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Sj(this._location.path)}get storage(){return this._service}get parent(){const e=CD(this._location.path);if(e===null)return null;const t=new lr(this._location.bucket,e);return new Wo(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw aD(e)}}function YD(s,e,t){s._throwIfRoot("uploadBytes");const i=WD(s.storage,s._location,Cj(),new eo(e,!0),t);return s.storage.makeRequestWithTokens(i,p0).then(l=>({metadata:l,ref:s}))}function QD(s){const e={prefixes:[],items:[]};return Aj(s,e).then(()=>e)}async function Aj(s,e,t){const l=await XD(s,{pageToken:t});e.prefixes.push(...l.prefixes),e.items.push(...l.items),l.nextPageToken!=null&&await Aj(s,e,l.nextPageToken)}function XD(s,e){e!=null&&typeof e.maxResults=="number"&&Kp("options.maxResults",1,1e3,e.maxResults);const t=e||{},i=FD(s.storage,s._location,"/",t.pageToken,t.maxResults);return s.storage.makeRequestWithTokens(i,p0)}function JD(s){s._throwIfRoot("getDownloadURL");const e=HD(s.storage,s._location,Cj());return s.storage.makeRequestWithTokens(e,p0).then(t=>{if(t===null)throw rD();return t})}function ZD(s,e){const t=ND(s._location.path,e),i=new lr(s._location.bucket,t);return new Wo(s.storage,i)}function e3(s){return/^[A-Za-z]+:\/\//.test(s)}function t3(s,e){return new Wo(s,e)}function Rj(s,e){if(s instanceof y0){const t=s;if(t._bucket==null)throw nD();const i=new Wo(t,t._bucket);return e!=null?Rj(i,e):i}else return e!==void 0?ZD(s,e):s}function n3(s,e){if(e&&e3(e)){if(s instanceof y0)return t3(s,e);throw Gp("To use ref(service, url), the first argument must be a Storage instance.")}else return Rj(s,e)}function Gw(s,e){const t=e?.[xj];return t==null?null:lr.makeFromBucketSpec(t,s)}function s3(s,e,t,i={}){s.host=`${e}:${t}`;const l=fo(e);l&&(ly(`https://${s.host}/b`),cy("Storage",!0)),s._isUsingEmulator=!0,s._protocol=l?"https":"http";const{mockUserToken:c}=i;c&&(s._overrideAuthToken=typeof c=="string"?c:Jx(c,s.app.options.projectId))}class y0{constructor(e,t,i,l,c,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=l,this._firebaseVersion=c,this._isUsingEmulator=d,this._bucket=null,this._host=wj,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=$M,this._maxUploadRetryTime=WM,this._requests=new Set,l!=null?this._bucket=lr.makeFromBucketSpec(l,this._host):this._bucket=Gw(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=lr.makeFromBucketSpec(this._url,e):this._bucket=Gw(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Kp("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Kp("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(br(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Wo(this,e)}_makeRequest(e,t,i,l,c=!0){if(this._deleted)return new oD(_j());{const d=vD(e,this._appId,i,l,t,this._firebaseVersion,c,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[i,l]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,l).getPromise()}}const Kw="@firebase/storage",Yw="0.14.0";const Ij="storage";function wu(s,e,t){return s=jn(s),YD(s,e,t)}function Qw(s){return s=jn(s),QD(s)}function io(s){return s=jn(s),JD(s)}function ca(s,e){return s=jn(s),n3(s,e)}function r3(s=Ou(),e){s=jn(s);const i=Qo(s,Ij).getImmediate({identifier:e}),l=Yx("storage");return l&&i3(i,...l),i}function i3(s,e,t,i={}){s3(s,e,t,i)}function a3(s,{instanceIdentifier:e}){const t=s.getProvider("app").getImmediate(),i=s.getProvider("auth-internal"),l=s.getProvider("app-check-internal");return new y0(t,i,l,e,Xo)}function o3(){yi(new ei(Ij,a3,"PUBLIC").setMultipleInstances(!0)),xr(Kw,Yw,""),xr(Kw,Yw,"esm2020")}o3();const Mj={apiKey:"AIzaSyBCIgMJd3By7qkWH27YiW9VooIBGE3bFLs",authDomain:"mind-core-fitness-client.firebaseapp.com",projectId:"mind-core-fitness-client",storageBucket:"mind-core-fitness-client.firebasestorage.app",messagingSenderId:"669343392406",appId:"1:669343392406:web:f5a35ee062387e7d6f58b7"},v0=hy(Mj),hi=V_(v0),ye=AM(v0),ua=r3(v0),l3=new aa,b0=new mu("apple.com");b0.addScope("email");b0.addScope("name");const c3=hy(Mj,"secondary"),aO=V_(c3),u3="EYdciKDOi3UYBLk1u8hHams5tmO2",Dj=w.createContext();function _r(){return w.useContext(Dj)}function d3({children:s}){const[e,t]=w.useState(null),[i,l]=w.useState(!1),[c,d]=w.useState(!1),[g,y]=w.useState(null),[p,b]=w.useState(!0);w.useEffect(()=>{let pe=null;const ve=g4(hi,he=>{if(t(he),pe&&(pe(),pe=null),he)if(he.uid===u3)l(!0),d(!1),y(null),b(!1);else{l(!1);const L=tn(ut(ye,"clients"),Ot("uid","==",he.uid)),E=async()=>{const A=localStorage.getItem("mcf_clientId");if(A)try{const V=await _s(ze(ye,"clients",A));V.exists()&&(d(!0),y({id:V.id,...V.data()}))}catch(V){console.error("Direct client read failed:",V)}};pe=vj(L,async A=>{if(A.empty)await E();else{const V=A.docs[0];d(!0),y({id:V.id,...V.data()});try{localStorage.setItem("mcf_clientId",V.id)}catch{}}b(!1)},async A=>{console.error("Error listening to client data:",A),await E(),b(!1)})}else l(!1),d(!1),y(null),b(!1)});return()=>{ve(),pe&&pe()}},[]);const re={currentUser:e,isAdmin:i,isClient:c,clientData:g,updateClientData:pe=>{y(ve=>ve?{...ve,...pe}:pe)},resolveClient:async()=>{if(g)return g;const pe=localStorage.getItem("mcf_clientId");if(pe)try{const ve=await _s(ze(ye,"clients",pe));if(ve.exists()){const he={id:ve.id,...ve.data()};return d(!0),y(he),he}}catch(ve){console.error("resolveClient direct read failed:",ve)}if(e){const ve=tn(ut(ye,"clients"),Ot("uid","==",e.uid)),he=await $t(ve);if(!he.empty){const L={id:he.docs[0].id,...he.docs[0].data()};return d(!0),y(L),L}}return null},login:async(pe,ve,he=!0)=>(await uh(hi,he?ou:xy),await h4(hi,pe,ve)),loginWithGoogle:async()=>{await uh(hi,ou);const pe=await L2(hi,l3),ve=pe.user,he=tn(ut(ye,"clients"),Ot("uid","==",ve.uid));if((await $t(he)).empty){const E=ze(ut(ye,"clients")),A={uid:ve.uid,name:ve.displayName||"",email:ve.email.toLowerCase(),clientType:"core_buddy",coreBuddyAccess:!0,status:"active",tier:"free",subscriptionStatus:null,signupSource:"google",createdAt:Bt.now()};await Wn(E,A),d(!0),y({id:E.id,...A});try{localStorage.setItem("mcf_clientId",E.id)}catch{}}return pe},loginWithApple:async()=>{await uh(hi,ou);const pe=await L2(hi,b0),ve=pe.user,he=tn(ut(ye,"clients"),Ot("uid","==",ve.uid));if((await $t(he)).empty){const E=ze(ut(ye,"clients")),A={uid:ve.uid,name:ve.displayName||"",email:(ve.email||"").toLowerCase(),clientType:"core_buddy",coreBuddyAccess:!0,status:"active",tier:"free",subscriptionStatus:null,signupSource:"apple",createdAt:Bt.now()};await Wn(E,A),d(!0),y({id:E.id,...A});try{localStorage.setItem("mcf_clientId",E.id)}catch{}}return pe},signup:async(pe,ve,he)=>{await uh(hi,ou);const L=await d4(hi,ve.trim().toLowerCase(),he),E=L.user,A=ze(ut(ye,"clients")),V={uid:E.uid,name:pe.trim(),email:ve.trim().toLowerCase(),clientType:"core_buddy",coreBuddyAccess:!0,status:"active",tier:"free",subscriptionStatus:null,signupSource:"self_signup",createdAt:Bt.now()};await Wn(A,V),d(!0),y({id:A.id,...V});try{localStorage.setItem("mcf_clientId",A.id)}catch{}return L},logout:()=>{try{localStorage.removeItem("mcf_clientId")}catch{}return p4(hi)},resetPassword:pe=>u4(hi,pe),loading:p};return a.jsx(Dj.Provider,{value:re,children:s})}var tc;(function(s){s.Unimplemented="UNIMPLEMENTED",s.Unavailable="UNAVAILABLE"})(tc||(tc={}));class Zg extends Error{constructor(e,t,i){super(e),this.message=e,this.code=t,this.data=i}}const h3=s=>{var e,t;return s?.androidBridge?"android":!((t=(e=s?.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||t===void 0)&&t.bridge?"ios":"web"},f3=s=>{const e=s.CapacitorCustomPlatform||null,t=s.Capacitor||{},i=t.Plugins=t.Plugins||{},l=()=>e!==null?e.name:h3(s),c=()=>l()!=="web",d=_=>{const j=p.get(_);return!!(j?.platforms.has(l())||g(_))},g=_=>{var j;return(j=t.PluginHeaders)===null||j===void 0?void 0:j.find(I=>I.name===_)},y=_=>s.console.error(_),p=new Map,b=(_,j={})=>{const I=p.get(_);if(I)return console.warn(`Capacitor plugin "${_}" already registered. Cannot register plugins twice.`),I.proxy;const F=l(),G=g(_);let B;const Y=async()=>(!B&&F in j?B=typeof j[F]=="function"?B=await j[F]():B=j[F]:e!==null&&!B&&"web"in j&&(B=typeof j.web=="function"?B=await j.web():B=j.web),B),ee=(E,A)=>{var V,M;if(G){const P=G?.methods.find(C=>A===C.name);if(P)return P.rtype==="promise"?C=>t.nativePromise(_,A.toString(),C):(C,Me)=>t.nativeCallback(_,A.toString(),C,Me);if(E)return(V=E[A])===null||V===void 0?void 0:V.bind(E)}else{if(E)return(M=E[A])===null||M===void 0?void 0:M.bind(E);throw new Zg(`"${_}" plugin is not implemented on ${F}`,tc.Unimplemented)}},re=E=>{let A;const V=(...M)=>{const P=Y().then(C=>{const Me=ee(C,E);if(Me){const Qe=Me(...M);return A=Qe?.remove,Qe}else throw new Zg(`"${_}.${E}()" is not implemented on ${F}`,tc.Unimplemented)});return E==="addListener"&&(P.remove=async()=>A()),P};return V.toString=()=>`${E.toString()}() { [capacitor code] }`,Object.defineProperty(V,"name",{value:E,writable:!1,configurable:!1}),V},pe=re("addListener"),ve=re("removeListener"),he=(E,A)=>{const V=pe({eventName:E},A),M=async()=>{const C=await V;ve({eventName:E,callbackId:C},A)},P=new Promise(C=>V.then(()=>C({remove:M})));return P.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await M()},P},L=new Proxy({},{get(E,A){switch(A){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return G?he:pe;case"removeListener":return ve;default:return re(A)}}});return i[_]=L,p.set(_,{name:_,proxy:L,platforms:new Set([...Object.keys(j),...G?[F]:[]])}),L};return t.convertFileSrc||(t.convertFileSrc=_=>_),t.getPlatform=l,t.handleError=y,t.isNativePlatform=c,t.isPluginAvailable=d,t.registerPlugin=b,t.Exception=Zg,t.DEBUG=!!t.DEBUG,t.isLoggingEnabled=!!t.isLoggingEnabled,t},m3=s=>s.Capacitor=f3(s),tf=m3(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),w0=tf.registerPlugin;class x0{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,t){let i=!1;this.listeners[e]||(this.listeners[e]=[],i=!0),this.listeners[e].push(t);const c=this.windowListeners[e];c&&!c.registered&&this.addWindowListener(c),i&&this.sendRetainedArgumentsForEvent(e);const d=async()=>this.removeListener(e,t);return Promise.resolve({remove:d})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t,i){const l=this.listeners[e];if(!l){if(i){let c=this.retainedEventArguments[e];c||(c=[]),c.push(t),this.retainedEventArguments[e]=c}return}l.forEach(c=>c(t))}hasListeners(e){var t;return!!(!((t=this.listeners[e])===null||t===void 0)&&t.length)}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:i=>{this.notifyListeners(t,i)}}}unimplemented(e="not implemented"){return new tf.Exception(e,tc.Unimplemented)}unavailable(e="not available"){return new tf.Exception(e,tc.Unavailable)}async removeListener(e,t){const i=this.listeners[e];if(!i)return;const l=i.indexOf(t);this.listeners[e].splice(l,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach(i=>{this.notifyListeners(e,i)}))}}const Xw=s=>encodeURIComponent(s).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),Jw=s=>s.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class g3 extends x0{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach(i=>{if(i.length<=0)return;let[l,c]=i.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");l=Jw(l).trim(),c=Jw(c).trim(),t[l]=c}),t}async setCookie(e){try{const t=Xw(e.key),i=Xw(e.value),l=e.expires?`; expires=${e.expires.replace("expires=","")}`:"",c=(e.path||"/").replace("path=",""),d=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${i||""}${l}; path=${c}; ${d};`}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}w0("CapacitorCookies",{web:()=>new g3});const p3=async s=>new Promise((e,t)=>{const i=new FileReader;i.onload=()=>{const l=i.result;e(l.indexOf(",")>=0?l.split(",")[1]:l)},i.onerror=l=>t(l),i.readAsDataURL(s)}),y3=(s={})=>{const e=Object.keys(s);return Object.keys(s).map(l=>l.toLocaleLowerCase()).reduce((l,c,d)=>(l[c]=s[e[d]],l),{})},v3=(s,e=!0)=>s?Object.entries(s).reduce((i,l)=>{const[c,d]=l;let g,y;return Array.isArray(d)?(y="",d.forEach(p=>{g=e?encodeURIComponent(p):p,y+=`${c}=${g}&`}),y.slice(0,-1)):(g=e?encodeURIComponent(d):d,y=`${c}=${g}`),`${i}&${y}`},"").substr(1):null,b3=(s,e={})=>{const t=Object.assign({method:s.method||"GET",headers:s.headers},e),l=y3(s.headers)["content-type"]||"";if(typeof s.data=="string")t.body=s.data;else if(l.includes("application/x-www-form-urlencoded")){const c=new URLSearchParams;for(const[d,g]of Object.entries(s.data||{}))c.set(d,g);t.body=c.toString()}else if(l.includes("multipart/form-data")||s.data instanceof FormData){const c=new FormData;if(s.data instanceof FormData)s.data.forEach((g,y)=>{c.append(y,g)});else for(const g of Object.keys(s.data))c.append(g,s.data[g]);t.body=c;const d=new Headers(t.headers);d.delete("content-type"),t.headers=d}else(l.includes("application/json")||typeof s.data=="object")&&(t.body=JSON.stringify(s.data));return t};class w3 extends x0{async request(e){const t=b3(e,e.webFetchExtra),i=v3(e.params,e.shouldEncodeUrlParams),l=i?`${e.url}?${i}`:e.url,c=await fetch(l,t),d=c.headers.get("content-type")||"";let{responseType:g="text"}=c.ok?e:{};d.includes("application/json")&&(g="json");let y,p;switch(g){case"arraybuffer":case"blob":p=await c.blob(),y=await p3(p);break;case"json":y=await c.json();break;default:y=await c.text()}const b={};return c.headers.forEach((_,j)=>{b[j]=_}),{data:y,headers:b,status:c.status,url:c.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}w0("CapacitorHttp",{web:()=>new w3});var Zw;(function(s){s.Dark="DARK",s.Light="LIGHT",s.Default="DEFAULT"})(Zw||(Zw={}));var ex;(function(s){s.StatusBar="StatusBar",s.NavigationBar="NavigationBar"})(ex||(ex={}));class x3 extends x0{async setStyle(){this.unavailable("not available for web")}async setAnimation(){this.unavailable("not available for web")}async show(){this.unavailable("not available for web")}async hide(){this.unavailable("not available for web")}}w0("SystemBars",{web:()=>new x3});const Lj=w.createContext();async function _3(s){if(tf.isNativePlatform())try{const{StatusBar:e,Style:t}=await Hs(async()=>{const{StatusBar:i,Style:l}=await import("./index-DMTZZNW-.js");return{StatusBar:i,Style:l}},[]);await e.setStyle({style:s?t.Dark:t.Light}),await e.setOverlaysWebView({overlay:!0}),await e.setBackgroundColor({color:"#00000000"})}catch{}}function Bi(){return w.useContext(Lj)}function k3({children:s}){const[e,t]=w.useState(()=>{const _=localStorage.getItem("theme");return _?_==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches}),[i,l]=w.useState(()=>localStorage.getItem("accent")||"red"),[c,d]=w.useState(()=>localStorage.getItem("mono")==="true");w.useEffect(()=>{document.documentElement.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("theme",e?"dark":"light"),_3(e);const _=document.querySelector('meta[name="theme-color"]');_&&_.setAttribute("content",e?"#111114":"#333331")},[e]),w.useEffect(()=>{document.documentElement.setAttribute("data-accent",i),localStorage.setItem("accent",i)},[i]),w.useEffect(()=>{document.documentElement.setAttribute("data-mono",c?"true":"false"),localStorage.setItem("mono",c?"true":"false")},[c]);const b={isDark:e,toggleTheme:()=>{document.documentElement.setAttribute("data-theme-transitioning",""),t(!e),setTimeout(()=>{document.documentElement.removeAttribute("data-theme-transitioning")},350)},accent:i,setAccent:_=>l(_),isMono:c,toggleMono:()=>{document.documentElement.setAttribute("data-theme-transitioning",""),d(!c),setTimeout(()=>{document.documentElement.removeAttribute("data-theme-transitioning")},350)}};return a.jsx(Lj.Provider,{value:b,children:s})}const Pj=w.createContext();function hc(){return w.useContext(Pj)}const j3=["nutrition","buddies"],E3=[5,10],T3=2,S3=1;function C3({children:s}){const{clientData:e,loading:t}=_r(),i=w.useMemo(()=>{const l=e?.tier||"free",c=e?.subscriptionStatus||null,g=e&&!["self_signup","google","apple"].includes(e.signupSource),y=l==="premium"||!!g;function p(b){return y?!0:!j3.includes(b)}return{tier:l,subscriptionStatus:c,isPremium:y,canAccess:p,loading:t,FREE_RANDOMISER_DURATIONS:E3,FREE_RANDOMISER_WEEKLY_LIMIT:T3,FREE_HABIT_LIMIT:S3}},[e?.tier,e?.subscriptionStatus,e?.signupSource,t]);return a.jsx(Pj.Provider,{value:i,children:s})}function Oj(s){if(["self_signup","google","apple"].includes(s?.signupSource)&&!s?.onboardingComplete)return"/onboarding";const e=s?.clientType;return e==="core_buddy"?"/client/core-buddy":e==="circuit_vip"||e==="circuit_dropin"?"/client/circuit":"/client"}function Vj({className:s=""}){const{isDark:e,toggleTheme:t}=Bi();return a.jsx("button",{className:s||"theme-toggle",onClick:t,"aria-label":e?"Switch to light mode":"Switch to dark mode",children:e?a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})})}const N3={admin:"Admin Login",block:"1-2-1 Client Login",circuit:"Circuit Login",core_buddy:"Core Buddy Login"};function A3(){const[s,e]=w.useState(""),[t,i]=w.useState(""),[l,c]=w.useState(!0),[d,g]=w.useState(""),[y,p]=w.useState(!1),[b,_]=w.useState(!1),[j,I]=w.useState(!1),[F,G]=w.useState(!1),[B,Y]=w.useState(!1),{login:ee,loginWithGoogle:re,loginWithApple:pe,resetPassword:ve,currentUser:he,isAdmin:L,isClient:E,clientData:A,loading:V}=_r(),M=qs(),[P]=EC(),C=P.get("type")||"",Me=N3[C]||"Sign In",Qe=!C||C==="core_buddy";if(w.useEffect(()=>{if(!V&&he){if(!he.emailVerified&&A?.signupSource==="self_signup"){M("/signup");return}L?M("/dashboard"):E?M(Oj(A)):(p(!1),g("No account found. Please sign up or contact your trainer."))}},[V,he,L,E,A,M]),V||he)return a.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh",background:"var(--bg-body)"},children:a.jsx("div",{style:{width:36,height:36,border:"3px solid var(--color-primary-light)",borderTopColor:"var(--color-primary)",borderRadius:"50%",animation:"app-spin .7s linear infinite"}})});const J=async Pe=>{Pe.preventDefault(),g(""),p(!0);try{await ee(s,t,l)}catch(U){g(U.message||"Failed to log in"),p(!1)}},Se=async()=>{g(""),G(!0);try{await re()}catch(Pe){Pe.code!=="auth/popup-closed-by-user"&&g(Pe.message||"Failed to sign in with Google"),G(!1)}},He=async()=>{g(""),Y(!0);try{await pe()}catch(Pe){Pe.code!=="auth/popup-closed-by-user"&&g(Pe.message||"Failed to sign in with Apple"),Y(!1)}},ke=async Pe=>{if(Pe.preventDefault(),g(""),!s.trim()){g("Please enter your email address");return}p(!0);try{await ve(s.trim()),I(!0)}catch(U){U.code==="auth/user-not-found"?g("No account found with this email"):g(U.message||"Failed to send reset email")}p(!1)};return a.jsxs("div",{className:"login-container",children:[a.jsx(Vj,{className:"login-theme-toggle"}),a.jsxs("div",{className:"login-card",children:[!b&&a.jsxs("button",{className:"login-back-btn",onClick:()=>M("/"),children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})}),"Back"]}),a.jsxs("div",{className:"login-header",children:[a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"login-logo"}),a.jsx("p",{children:a.jsx("strong",{children:b?"Reset Password":"Mind Core Fitness"})}),!b&&a.jsx("span",{className:"login-type-label",children:Me})]}),d&&a.jsx("div",{className:"error-message",children:d}),j?a.jsxs("div",{className:"reset-sent",children:[a.jsx("div",{className:"reset-sent-icon",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M22 2L11 13",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("path",{d:"M22 2L15 22L11 13L2 9L22 2Z",strokeLinecap:"round",strokeLinejoin:"round"})]})}),a.jsx("p",{children:"Reset email sent!"}),a.jsx("span",{children:"Check your inbox for a password reset link"}),a.jsx("button",{className:"login-btn",style:{marginTop:"20px"},onClick:()=>{_(!1),I(!1),g("")},children:"Back to Log In"})]}):b?a.jsxs("form",{onSubmit:ke,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:s,onChange:Pe=>e(Pe.target.value),placeholder:"Enter your email",required:!0})]}),a.jsx("button",{type:"submit",className:"login-btn",disabled:y,children:y?"Sending...":"Send Reset Link"}),a.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{_(!1),g("")},children:"Back to Log In"})]}):a.jsxs(a.Fragment,{children:[Qe&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{type:"button",className:"google-btn",onClick:Se,disabled:F,children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 48 48",children:[a.jsx("path",{fill:"#4285F4",d:"M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"}),a.jsx("path",{fill:"#34A853",d:"M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"}),a.jsx("path",{fill:"#FBBC05",d:"M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"}),a.jsx("path",{fill:"#EA4335",d:"M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.18 1.48-4.96 2.35-8.16 2.35-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"})]}),F?"Signing in...":"Continue with Google"]}),a.jsxs("button",{type:"button",className:"apple-btn",onClick:He,disabled:B,children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M17.05 20.28c-.98.95-2.05.88-3.08.4-1.09-.5-2.08-.48-3.24 0-1.44.62-2.2.44-3.06-.4C2.79 15.25 3.51 7.59 9.05 7.31c1.35.07 2.29.74 3.08.8 1.18-.24 2.31-.93 3.57-.84 1.51.12 2.65.72 3.4 1.8-3.12 1.87-2.38 5.98.48 7.13-.57 1.5-1.31 2.99-2.54 4.09zM12.03 7.25c-.15-2.23 1.66-4.07 3.74-4.25.29 2.58-2.34 4.5-3.74 4.25z"})}),B?"Signing in...":"Continue with Apple"]}),a.jsx("button",{type:"button",className:"login-btn login-btn-outline",onClick:()=>M("/signup"),children:"Create Free Account"}),a.jsx("div",{className:"login-divider",children:a.jsx("span",{children:"or"})})]}),a.jsxs("form",{onSubmit:J,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:s,onChange:Pe=>e(Pe.target.value),required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"password",children:"Password"}),a.jsx("input",{type:"password",id:"password",value:t,onChange:Pe=>i(Pe.target.value),required:!0})]}),a.jsx("div",{className:"remember-me",children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:l,onChange:Pe=>c(Pe.target.checked)}),a.jsx("span",{children:"Remember me"})]})}),a.jsx("button",{type:"submit",className:"login-btn",disabled:y,children:y?"Logging in...":"Log In"})]}),a.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{_(!0),g("")},children:"Forgot password?"})]}),a.jsx("a",{href:"/",className:"back-link",children:"Back to website"})]})]})}const R3=[{type:"block",label:"1-2-1 Training",description:"View sessions & your schedule",icon:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M6.5 6.5h11M6.5 17.5h11M4 9.5v5M20 9.5v5M2 11v2M22 11v2"})})},{type:"circuit",label:"Circuit Training",description:"Book & manage circuit sessions",icon:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})})},{type:"core_buddy",label:"Core Buddy",description:"Workouts, nutrition & habits",icon:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})}];function I3(){const s=qs(),{currentUser:e,isAdmin:t,isClient:i,clientData:l,loading:c}=_r();return w.useEffect(()=>{!c&&e&&(t?s("/dashboard",{replace:!0}):i&&s(Oj(l),{replace:!0}))},[c,e,t,i,l,s]),c||e?a.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh",background:"var(--bg-body)"},children:a.jsx("div",{style:{width:36,height:36,border:"3px solid var(--color-primary-light)",borderTopColor:"var(--color-primary)",borderRadius:"50%",animation:"app-spin .7s linear infinite"}})}):a.jsxs("div",{className:"login-container",children:[a.jsx(Vj,{className:"login-theme-toggle"}),a.jsxs("div",{className:"portal-card",children:[a.jsxs("div",{className:"login-header",children:[a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"login-logo"}),a.jsx("p",{children:a.jsx("strong",{children:"Welcome back"})}),a.jsx("p",{className:"portal-subtitle",children:"Select how you're logging in"})]}),a.jsx("div",{className:"portal-grid",children:R3.map(({type:d,label:g,description:y,icon:p})=>a.jsxs("button",{className:"portal-option",onClick:()=>s(`/login?type=${d}`),children:[a.jsx("div",{className:"portal-option-icon",children:p}),a.jsx("div",{className:"portal-option-label",children:g}),a.jsx("div",{className:"portal-option-desc",children:y})]},d))}),a.jsx("a",{href:"/",className:"back-link",children:"Back to website"})]})]})}function vh({feature:s,children:e}){const{canAccess:t,loading:i}=hc();return i||t(s)?e:a.jsx(Ux,{to:"/upgrade",replace:!0})}function ni({active:s}){const e=qs(),{clientData:t}=_r(),{isPremium:i}=hc(),l=t?.clientType==="block"&&t?.coreBuddyAccess;return a.jsxs("nav",{className:"block-bottom-nav",children:[a.jsxs("button",{className:`block-nav-tab${s==="home"?" active":""}`,onClick:()=>e("/client/core-buddy"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),a.jsx("span",{children:"Profile"})]}),a.jsxs("button",{className:`block-nav-tab${s==="workouts"?" active":""}`,onClick:()=>e("/client/core-buddy/workouts"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:a.jsx("path",{d:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"})}),a.jsx("span",{children:"Workout"})]}),i&&a.jsxs("button",{className:`block-nav-tab${s==="nutrition"?" active":""}`,onClick:()=>e("/client/core-buddy/nutrition"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"})}),a.jsx("span",{children:"Nutrition"})]}),i&&a.jsxs("button",{className:`block-nav-tab${s==="buddies"?" active":""}`,onClick:()=>e("/client/core-buddy/buddies"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("span",{children:"Buddies"})]}),l&&a.jsxs("button",{className:"block-nav-tab",onClick:()=>e("/client"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),a.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),a.jsx("span",{children:"Block"})]})]})}function nl({children:s,onRefresh:e}){const[t,i]=w.useState(0),[l,c]=w.useState(!1),d=w.useRef(null),g=w.useRef(0),y=w.useRef(!1),p=w.useCallback(j=>{window.scrollY<=0&&(g.current=j.touches[0].clientY,y.current=!0)},[]),b=w.useCallback(j=>{if(!y.current||l)return;const I=j.touches[0].clientY-g.current;I>20&&window.scrollY<=0&&(j.preventDefault(),i(Math.min((I-20)*.35,80)))},[l]),_=w.useCallback(async()=>{t>55&&!l&&(c(!0),e?await e():window.location.reload(),c(!1)),i(0),y.current=!1},[t,l,e]);return a.jsxs("div",{ref:d,onTouchStart:p,onTouchMove:b,onTouchEnd:_,children:[a.jsxs("div",{className:`pull-refresh-indicator ${t>0?"visible":""} ${l?"refreshing":""}`,style:{height:t},children:[a.jsx("div",{className:`refresh-spinner ${l?"spinning":""}`,children:a.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:a.jsx("path",{fill:"currentColor",d:"M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"})})}),a.jsx("span",{className:"refresh-text",children:l?"Refreshing...":"Pull to refresh"})]}),s]})}function Yu(s,e,t,i,l){const c=[];for(let d=0;d<s;d++){const g=(d*(360/s)-90)*(Math.PI/180);c.push({x1:e+i*Math.cos(g),y1:t+i*Math.sin(g),x2:e+l*Math.cos(g),y2:t+l*Math.sin(g),thick:d%5===0})}return c}const Uj=Yu(60,100,100,85,96),M3=Yu(60,100,100,78,94),D3=Yu(60,100,100,82,94);Yu(60,50,50,38,46);const oO=Yu(60,40,40,30,37);function L3({steps:s,onFinish:e,active:t}){const[i,l]=w.useState(0),[c,d]=w.useState(null),[g,y]=w.useState("below"),[p,b]=w.useState(!1),_=w.useRef(null),j=w.useRef(t);j.current=t,w.useEffect(()=>{t||l(0)},[t]),w.useEffect(()=>{if(!t)return;const ve=he=>he.preventDefault();return document.addEventListener("touchmove",ve,{passive:!1}),document.addEventListener("wheel",ve,{passive:!1}),document.body.style.overflow="hidden",()=>{document.removeEventListener("touchmove",ve),document.removeEventListener("wheel",ve),document.body.style.overflow=""}},[t]);const I=w.useMemo(()=>t?s.filter(ve=>document.querySelector(ve.selector)):[],[t]),F=I[i],G=i===I.length-1,B=F?.selector,Y=w.useCallback(()=>{if(!B)return;const ve=document.querySelector(B);if(!ve){d(null);return}const he=ve.getBoundingClientRect(),L=8;d({top:he.top-L,left:he.left-L,width:he.width+L*2,height:he.height+L*2});const E=window.innerHeight-he.bottom;y(E<260?"above":"below")},[B]);if(w.useEffect(()=>{if(!t||!B)return;b(!0);const ve=document.querySelector(B);if(ve){document.body.style.overflow="",ve.scrollIntoView({behavior:"smooth",block:"center"});let he=null,L=0,E=0;const A=60,V=()=>{E++;const C=ve.getBoundingClientRect(),Me=Math.round(C.top);if(he!==null&&Me===he?L++:L=0,he=Me,L>=3||E>=A){j.current&&(document.body.style.overflow="hidden"),Y(),b(!1);return}M=requestAnimationFrame(V)};let M;const P=setTimeout(()=>{M=requestAnimationFrame(V)},120);return()=>{clearTimeout(P),M&&cancelAnimationFrame(M),j.current&&(document.body.style.overflow="hidden")}}},[t,i,B,Y]),w.useEffect(()=>{if(!t)return;const ve=()=>{_.current&&cancelAnimationFrame(_.current),_.current=requestAnimationFrame(Y)};return window.addEventListener("scroll",ve,!0),window.addEventListener("resize",ve),()=>{window.removeEventListener("scroll",ve,!0),window.removeEventListener("resize",ve),_.current&&cancelAnimationFrame(_.current)}},[t,Y]),!t||!F||I.length===0)return null;const ee=()=>{G?e():l(i+1)},re=()=>{i>0&&l(i-1)},pe=()=>e();return a.jsxs("div",{className:"st-overlay",onClick:ve=>{ve.stopPropagation()},children:[a.jsx("div",{className:"st-backdrop",onClick:ee}),c&&a.jsx("div",{className:`st-spotlight${p?" st-transitioning":""}`,style:{top:c.top,left:c.left,width:c.width,height:c.height}}),c&&a.jsxs("div",{className:`st-tooltip st-tooltip-${g}${p?" st-transitioning":""}`,style:{top:g==="below"?Math.min(Math.max(c.top+c.height+16,16),window.innerHeight-200):void 0,bottom:g==="above"?Math.min(Math.max(window.innerHeight-c.top+16,16),window.innerHeight-60):void 0,left:Math.max(16,Math.min(c.left,window.innerWidth-320))},children:[a.jsx("div",{className:"st-dots",children:I.map((ve,he)=>a.jsx("span",{className:`st-dot${he===i?" active":""}${he<i?" done":""}`},he))}),a.jsx("h3",{className:"st-title",children:F.title}),a.jsx("p",{className:"st-body",children:F.body}),a.jsxs("div",{className:"st-actions",children:[i>0&&a.jsx("button",{className:"st-btn st-btn-back",onClick:re,children:"Back"}),a.jsx("button",{className:"st-btn st-btn-next",onClick:ee,children:F.cta||(G?"Let's Go!":"Next")})]}),a.jsx("button",{className:"st-skip",onClick:pe,children:"Skip tour"})]})]})}const P3="/login/assets/first_workout-B8SFkzJX.PNG",O3="/login/assets/workouts_10-Z5R3u0xH.PNG",V3="/login/assets/workouts_25-CzxSlcAj.PNG",U3="/login/assets/workouts_50-BpzWup3V.PNG",B3="/login/assets/workouts_100-D7_r6tn1.PNG",z3="/login/assets/streak_2-CsRr-XA9.PNG",F3="/login/assets/streak_4-BHO09tbw.PNG",H3="/login/assets/streak_8-DX2UWMko.PNG",q3="/login/assets/nutrition_7-CHVV11fj.PNG",$3="/login/assets/leaderboard_join-BLoId4Hz.PNG",W3="/login/assets/habits_7-Dvki70KO.PNG",G3="/login/assets/starter_streak-CCltAfrC.PNG",K3="/login/assets/consistency_king-Cho2jxBt.PNG",Y3="/login/assets/thirty_in_thirty-B0BVHafW.PNG",Q3="/login/assets/minute_master-hA2RLkIL.PNG",X3="/login/assets/habit_machine--nFXaIUW.PNG",J3="/login/assets/iron_will-Dh2dTaie.PNG",Pr=[{id:"first_workout",img:P3,name:"First Rep",desc:"Complete your first workout",category:"workouts",threshold:1},{id:"workouts_10",img:O3,name:"On Fire",desc:"Complete 10 workouts",category:"workouts",threshold:10},{id:"workouts_25",img:V3,name:"Dedicated",desc:"Complete 25 workouts",category:"workouts",threshold:25},{id:"workouts_50",img:U3,name:"Unstoppable",desc:"Complete 50 workouts",category:"workouts",threshold:50},{id:"workouts_100",img:B3,name:"Century",desc:"Complete 100 workouts",category:"workouts",threshold:100},{id:"streak_2",img:z3,name:"2 Week Streak",desc:"Work out for 2 weeks in a row",category:"streaks",threshold:2},{id:"streak_4",img:F3,name:"Month Strong",desc:"Work out for 4 weeks in a row",category:"streaks",threshold:4},{id:"streak_8",img:H3,name:"8 Week Warrior",desc:"Work out for 8 weeks in a row",category:"streaks",threshold:8},{id:"nutrition_7",img:q3,name:"Macro Master",desc:"Hit your macro targets 7 days in a row",category:"nutrition",threshold:7},{id:"leaderboard_join",img:$3,name:"Competitor",desc:"Join the leaderboard",category:"leaderboard",threshold:1},{id:"habits_7",img:W3,name:"Habit Streak",desc:"Complete your daily habits 7 days in a row",category:"habits",threshold:7},{id:"starter_streak",img:G3,name:"Starter Streak",desc:"Complete 5 workouts in 7 days",category:"challenges",threshold:1},{id:"consistency_king",img:K3,name:"Consistency King",desc:"Complete 12 workouts in 30 days",category:"challenges",threshold:1},{id:"thirty_in_thirty",img:Y3,name:"30 in 30",desc:"Complete 30 workouts in 30 days",category:"challenges",threshold:1},{id:"minute_master",img:Q3,name:"Minute Master",desc:"Train for 300 total minutes in 30 days",category:"challenges",threshold:1},{id:"habit_machine",img:X3,name:"Habit Machine",desc:"Hit all daily habits for 7 days straight",category:"challenges",threshold:1},{id:"iron_will",img:J3,name:"Iron Will",desc:"Work out every day for 14 days straight",category:"challenges",threshold:1}],tx=3,nx=5,Z3=["trained","protein","steps","sleep","water"];function ep(s){return s.toISOString().split("T")[0]}const tp=[{text:"You have 24 hours a day...",bold:"make it count"},{text:"Discipline beats motivation...",bold:"every single time"},{text:"Rest when you're done,",bold:"not when you're tired"},{text:"Small daily gains...",bold:"create massive results"},{text:"Your body keeps score,",bold:"train it well"},{text:"Consistency over intensity...",bold:"always wins"},{text:"The only bad workout...",bold:"is the one you skipped"}],tu={morning:[{main:"Rise and grind,",sub:"let's get after it!"},{main:"New day, new gains,",sub:"let's build something!"},{main:"The early bird gets the gains,",sub:"let's go!"},{main:"Winners wake up ready,",sub:"you showed up!"}],afternoon:[{main:"Oye",sub:"crack on and make it count!"},{main:"Halfway through the day,",sub:"don't ease off now!"},{main:"Afternoon push,",sub:"this is where champions are made!"},{main:"Still time to make today count,",sub:"let's go!"}],evening:[{main:"Evening session?",sub:"Let's finish strong!"},{main:"End the day on a high,",sub:"you earned it!"},{main:"Night owls lift heavier,",sub:"prove it!"},{main:"One more session today?",sub:"Close it out!"}],night:[{main:"Burning the midnight oil,",sub:"Respect the hustle!"},{main:"Late night dedication,",sub:"that's what sets you apart!"},{main:"While they sleep,",sub:"you grind!"}],allDone:[{main:"Smashed it today,",sub:"Rest up and go again tomorrow."},{main:"All tasks crushed,",sub:"Absolute machine!"},{main:"Nothing left undone,",sub:"That's elite-level discipline."}]};function np(s){if(!s)return"";const e=s instanceof Date?s:s.toDate?s.toDate():new Date(s),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function nu(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function e5(s,e=800){return new Promise(t=>{const i=new Image;i.onload=()=>{const l=document.createElement("canvas");let c=i.width,d=i.height;c>d?c>e&&(d=Math.round(d*e/c),c=e):d>e&&(c=Math.round(c*e/d),d=e),l.width=c,l.height=d,l.getContext("2d").drawImage(i,0,0,c,d),l.toBlob(g=>t(g),"image/jpeg",.8)},i.src=URL.createObjectURL(s)})}function t5(){const{currentUser:s,isClient:e,clientData:t,logout:i,updateClientData:l,loading:c}=_r(),{isDark:d,toggleTheme:g}=Bi(),{isPremium:y,FREE_HABIT_LIMIT:p}=hc(),b=qs(),[_,j]=w.useState(y?nx:p),I=_,[F,G]=w.useState({hours:0,minutes:0,seconds:0}),[B,Y]=w.useState(0),[ee,re]=w.useState(0),[pe,ve]=w.useState(0),[he,L]=w.useState(!1),[E,A]=w.useState({protein:0,carbs:0,fats:0,calories:0}),[V,M]=w.useState(null),[P,C]=w.useState(0),[Me,Qe]=w.useState(0),[J,Se]=w.useState(tx),[He,ke]=w.useState(!1),[Pe,U]=w.useState(!1),[ce,Ee]=w.useState([]),[Ce,je]=w.useState(null),[Ue,$e]=w.useState(!1),Xe=w.useRef(null),[Ze,Wt]=w.useState(0),[It,Cn]=w.useState(0),[ln,qt]=w.useState(null),Et=w.useCallback((S,Q="info")=>{qt({message:S,type:Q}),setTimeout(()=>qt(null),4e3)},[]),[pn,Tt]=w.useState([]),[dt,le]=w.useState(!1),[pt,Ht]=w.useState(""),[it,yt]=w.useState(null),[gt,_t]=w.useState(null),[zt,fs]=w.useState(!1),[rn,Zn]=w.useState(new Set),[Fn,Ln]=w.useState(new Set),[Pn,un]=w.useState({}),[Gt,Ct]=w.useState({}),[Mt,Z]=w.useState({}),[N,te]=w.useState({}),[Re,Ie]=w.useState({}),[De,Fe]=w.useState({}),Oe=w.useRef(null),Nt=w.useRef(null),bt=w.useRef({}),[lt,dn]=w.useState([]),[hn,On]=w.useState(!1),ms=w.useRef(null),[ue,Le]=w.useState([]),[Ke,ct]=w.useState(""),[rt,Kt]=w.useState(!1),[fn,At]=w.useState(null),[St,bn]=w.useState([]),[Ss,si]=w.useState(null),[xi,Vr]=w.useState(!1),js=w.useRef(!1),[hr,Kn]=w.useState(null),[os,ls]=w.useState(!1),Vn=w.useRef(!1),wn=(()=>{const S=[{selector:".cb-ring-container",title:"Your 24-Hour Countdown",body:"Every day resets. This ring tracks the time you have left  tap your photo to personalise your profile.",cta:"Next"},{selector:".cb-stats-row",title:"Progress at a Glance",body:"Your workout streak, sessions this week, and daily habits  all in one row. These fill up as you go."},{selector:".cb-nudge-card",title:"Smart Suggestions",body:"We'll highlight what needs your attention  your next session, unfinished habits, or a meal to log."},{selector:".cb-card-workouts-hero",title:"Workout",body:"Randomiser workouts  pick your focus, level and time. Save and replay your favourites.",cta:"Next"}];return y&&S.push({selector:".cb-card-nutrition",title:"Nutrition Tracking",body:"Set your macro targets, scan barcodes, and log meals to hit your daily goals."},{selector:".cb-card-consistency",title:"Daily Habits",body:"5 simple habits each day  train, hit protein, 10k steps, sleep, and hydrate. Build your streak."},{selector:".cb-card-buddies",title:"Buddies & Social",body:"Connect with other members, share your journey, and keep each other accountable."},{selector:".cb-journey-section",title:"Share Your Journey",body:"Post photos, updates, and milestones  your fitness journey in one place. Like and comment on each other's posts."}),S.push({selector:".block-bottom-nav",title:"You're All Set!",body:"Use the nav bar to jump between your profile, workouts, nutrition, and buddies. Time to get after it.",cta:"Let's Go!"}),S})();w.useEffect(()=>{!c&&!s&&b("/")},[c,s,b]),w.useEffect(()=>{!c&&t&&t.signupSource==="self_signup"&&!t.onboardingComplete&&b("/onboarding")},[c,t,b]),w.useEffect(()=>{let S=t?.tourComplete||Vn.current;if(!S&&t?.id)try{S=!!localStorage.getItem(`tourDone_${t.id}`)}catch{}if(he&&t&&!S){const Q=setTimeout(()=>ls(!0),600);return()=>clearTimeout(Q)}},[he,t]),w.useEffect(()=>{if(!(!he||!t?.id)){try{if(localStorage.getItem(`targetHint_${t.id}`))return}catch{}if(!t?.weeklyWorkoutTarget){const S=setTimeout(()=>U(!0),1500);return()=>clearTimeout(S)}}},[he,t]),w.useEffect(()=>{if(t)try{const S=sessionStorage.getItem(`cbDash_${t.id}`);if(S){const Q=JSON.parse(S);re(Q.totalWorkouts??0),ve(Q.habitWeekPct??0),A(Q.nutritionTotals??{protein:0,carbs:0,fats:0,calories:0}),M(Q.nutritionTargetData??null),C(Q.todayHabitsCount??0),Q.realHabitCount&&j(Q.realHabitCount),Qe(Q.weeklyWorkouts??0),Se(Q.weeklyWorkoutTarget??tx),Ee(Q.leaderboardTop3??[]),Wt(Q.streakWeeks??0),L(!0)}}catch{}},[t]),w.useEffect(()=>{t?.photoURL&&je(t.photoURL),t?.weeklyWorkoutTarget&&Se(t.weeklyWorkoutTarget)},[t]),w.useEffect(()=>{if(!t)return;const S=tn(ut(ye,"notifications"),Ot("toId","==",t.id)),Q=vj(S,Ae=>{const D=Ae.docs.map(H=>({id:H.id,...H.data()}));D.sort((H,$)=>{const K=H.createdAt?.toMillis?.()||0;return($.createdAt?.toMillis?.()||0)-K}),dn(D.slice(0,50))},Ae=>{console.error("Notification listener error:",Ae),Ae.code==="permission-denied"&&console.warn("Firestore rules may be missing for the notifications collection. Please update your Firestore rules in the Firebase Console.")});return()=>Q()},[t]),w.useEffect(()=>{const S=Q=>{ms.current&&!ms.current.contains(Q.target)&&On(!1)};return document.addEventListener("mousedown",S),()=>document.removeEventListener("mousedown",S)},[]),w.useEffect(()=>{if(!t)return;const S=t.id;(async()=>{try{const[Q,Ae,D]=await Promise.all([$t(tn(ut(ye,"buddies"),Ot("user1","==",S))),$t(tn(ut(ye,"buddies"),Ot("user2","==",S))),$t(ut(ye,"clients"))]),H=new Set;[...Q.docs,...Ae.docs].forEach(K=>{const me=K.data();H.add(me.user1===S?me.user2:me.user1)});const $={};D.docs.forEach(K=>{$[K.id]=K.data()}),Le(Array.from(H).filter(K=>$[K]).map(K=>({id:K,name:$[K].name,photoURL:$[K].photoURL||null})))}catch(Q){console.error("Error loading buddies for mentions:",Q)}})()},[t]);const es=lt.filter(S=>!S.read).length,kr=async()=>{const S=lt.filter(Ae=>!Ae.read);if(!S.length)return;const Q=Hw(ye);S.forEach(Ae=>Q.update(ze(ye,"notifications",Ae.id),{read:!0})),await Q.commit()},$s=async()=>{if(!lt.length)return;const S=Hw(ye);lt.forEach(Q=>S.delete(ze(ye,"notifications",Q.id))),await S.commit()},Yn=async(S,Q,Ae={})=>{if(!(!t||S===t.id))try{await or(ut(ye,"notifications"),{toId:S,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:Q,read:!1,createdAt:xs(),...Ae})}catch(D){console.error("Notification create error:",D),D.code==="permission-denied"&&Et("Notifications blocked  check Firestore rules","error")}},jr=(S,Q)=>{const Ae=Q==="compose"?Oe.current?.selectionStart:null,H=(Ae!=null?S.slice(0,Ae):S).match(/@(\w*)$/);if(H){Kt(!0),At(Q),ct(H[1].toLowerCase());const $=ue.filter(K=>K.name&&K.name.toLowerCase().includes(H[1].toLowerCase())).slice(0,5);bn($)}else Kt(!1),bn([])},ts=(S,Q)=>{if(Q==="compose"){const Ae=Oe.current,D=pt,H=Ae?.selectionStart??D.length,$=D.slice(0,H),K=D.slice(H),me=$.replace(/@\w*$/,`@${S.name} `);Ht(me+K),setTimeout(()=>{Ae?.focus(),Ae.selectionStart=Ae.selectionEnd=me.length},0)}else{const D=(Gt[Q]||"").replace(/@\w*$/,`@${S.name} `);Ct(H=>({...H,[Q]:D}))}Kt(!1),bn([])},Ur=S=>S&&S.split(/(@\w[\w\s]*?\s)/g).map((Ae,D)=>Ae.startsWith("@")&&ue.some(H=>Ae.trim()===`@${H.name}`)?a.jsx("span",{className:"mention-highlight",children:Ae.trim()},D):Ae),O=async S=>{const Q=S.target.files?.[0];if(!(!Q||!t)){if(!Q.type.startsWith("image/")){Et("Please select an image file","error");return}if(Q.size>5*1024*1024){Et("Image must be under 5MB","error");return}$e(!0);try{const Ae=await new Promise($=>{const K=new Image;K.onload=()=>{const me=document.createElement("canvas"),be=400;let Ve=K.width,nt=K.height;Ve>nt?(nt=nt/Ve*be,Ve=be):(Ve=Ve/nt*be,nt=be),me.width=Ve,me.height=nt,me.getContext("2d").drawImage(K,0,0,Ve,nt),me.toBlob(st=>$(st),"image/jpeg",.75)},K.src=URL.createObjectURL(Q)}),D=ca(ua,`profilePhotos/${t.id}`);await wu(D,Ae);const H=await io(D);await zn(ze(ye,"clients",t.id),{photoURL:H}),je(H),l({photoURL:H}),Et("Profile photo updated!","success")}catch(Ae){console.error("Photo upload error:",Ae),Et("Failed to upload photo","error")}$e(!1),Xe.current&&(Xe.current.value="")}};w.useEffect(()=>{const S=()=>{const Ae=new Date,D=new Date(Ae);D.setHours(23,59,59,999);const H=D-Ae,$=Math.floor(H/(1e3*60*60)),K=Math.floor(H%(1e3*60*60)/(1e3*60)),me=Math.floor(H%(1e3*60)/1e3);G({hours:$,minutes:K,seconds:me}),Y(60-me)};S();const Q=setInterval(S,1e3);return()=>clearInterval(Q)},[]),w.useEffect(()=>{const S=setInterval(()=>{Cn(Q=>(Q+1)%tp.length)},8e3);return()=>clearInterval(S)},[]),w.useEffect(()=>{if(!s||!t)return;(async()=>{let Q=null,Ae=null;try{const D=ep(new Date),H=ut(ye,"workoutLogs"),$=tn(H,Ot("clientId","==",t.id));Q=await $t($),re(Q.docs.length);const K=new Date,me=K.getDay(),be=me===0?6:me-1,Ve=new Date(K);Ve.setDate(K.getDate()-be),Ve.setHours(0,0,0,0);const nt=Ve.getTime(),st=Q.docs.filter(an=>{const mt=an.data().completedAt;return mt?(mt.toDate?mt.toDate().getTime():new Date(mt).getTime())>=nt:!1}).length;Qe(st);const[vt,kt]=await Promise.all([$t(tn(ut(ye,"habitLogs"),Ot("clientId","==",t.id),Ot("date","==",D))),_s(ze(ye,"customHabits",t.id))]);let Xt=nx;if(kt.exists()){const an=kt.data(),mt=an.habits||[],gn=an.hiddenDefaults||[];Xt=Z3.filter(tr=>!gn.includes(tr)).length+mt.length}y||(Xt=Math.min(Xt,p)),j(Xt);let Hn=0;if(!vt.empty){const an=vt.docs[0].data().habits||{};Hn=Object.values(an).filter(Boolean).length}ve(Math.round(Hn/Xt*100)),C(Hn);const tt=await _s(ze(ye,"nutritionTargets",t.id));tt.exists()&&(M(tt.data()),Ae=tt.data());const mn=await _s(ze(ye,"nutritionLogs",`${t.id}_${D}`));if(mn.exists()){const mt=(mn.data().entries||[]).reduce((gn,Xn)=>({protein:gn.protein+(Xn.protein||0),carbs:gn.carbs+(Xn.carbs||0),fats:gn.fats+(Xn.fats||0),calories:gn.calories+(Xn.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});A(mt)}}catch(D){console.error("Error loading dashboard stats:",D)}try{const D=ut(ye,"clients"),H=tn(D,Ot("leaderboardOptIn","==",!0)),K=(await $t(H)).docs.map(me=>({id:me.id,name:me.data().name,photoURL:me.data().photoURL||null}));if(Ee(K.slice(0,3)),t?.id){const me=K.findIndex(Ve=>Ve.id===t.id),be=me>=0?me+1:null;try{const Ve=`lbRank_${t.id}`,nt=sessionStorage.getItem(Ve);nt&&Kn(parseInt(nt,10)),be&&sessionStorage.setItem(Ve,String(be))}catch{}}}catch(D){console.error("Leaderboard preview error:",D)}try{let D=0;if(Q){const H=Q.docs.map($=>$.data().date).filter(Boolean).sort().reverse();if(H.length>0){const $=new Date;let K=new Date($);e:for(let me=0;me<52;me++){const be=new Date(K),Ve=be.getDay(),nt=Ve===0?6:Ve-1;be.setDate(be.getDate()-nt),be.setHours(0,0,0,0);const st=new Date(be);st.setDate(st.getDate()+7);const vt=ep(be),kt=ep(st);if(H.some(Hn=>Hn>=vt&&Hn<kt))D++;else{if(me>0)break e;break}K.setDate(K.getDate()-7)}}}Wt(D)}catch(D){console.error("Streak computation error:",D)}L(!0)})()},[s,t,I]),w.useEffect(()=>{if(!(!he||!t))try{sessionStorage.setItem(`cbDash_${t.id}`,JSON.stringify({totalWorkouts:ee,habitWeekPct:pe,nutritionTotals:E,nutritionTargetData:V,todayHabitsCount:P,realHabitCount:_,weeklyWorkouts:Me,weeklyWorkoutTarget:J,leaderboardTop3:ce,streakWeeks:Ze}))}catch{}},[he,ee,pe,E,V,P,Me,J,ce,Ze,t]),w.useEffect(()=>{if(!(!he||js.current)&&Me>=J&&J>0){const S=`weekCeleb_${t?.id}_${new Date().toISOString().slice(0,10).replace(/-\d{2}$/,"")}`;try{if(localStorage.getItem(S))return;localStorage.setItem(S,"1")}catch{}js.current=!0,Vr(!0),setTimeout(()=>Vr(!1),3500)}},[he,Me,J,t]);const q=w.useCallback(async()=>{if(Vn.current=!0,ls(!1),l({tourComplete:!0}),t?.id){try{localStorage.setItem(`tourDone_${t.id}`,"1")}catch{}try{await zn(ze(ye,"clients",t.id),{tourComplete:!0})}catch(S){console.error("Failed to save tour completion:",S)}}},[t,l]),oe=w.useCallback(async S=>{if(Se(S),ke(!1),U(!1),t?.id){try{localStorage.setItem(`targetHint_${t.id}`,"1")}catch{}try{await zn(ze(ye,"clients",t.id),{weeklyWorkoutTarget:S})}catch(Q){console.error("Failed to save weekly target:",Q)}}},[t]),ne=S=>{const Q=S.currentTarget,Ae=Q.querySelector(".ripple");Ae&&Ae.remove();const D=Q.getBoundingClientRect(),H=Math.max(D.width,D.height),$=S.clientX-D.left-H/2,K=S.clientY-D.top-H/2,me=document.createElement("span");me.className="ripple",me.style.cssText=`width:${H}px;height:${H}px;left:${$}px;top:${K}px;`,Q.appendChild(me),setTimeout(()=>me.remove(),600)},Ye=t?.name?.split(" ")[0]||"there",Ge=Math.min(Math.round(Me/J*100),100),qe=Ze>0?Math.min(Math.round(Ze/12*100),100):0,ot=[{label:"Wk Streak",value:`${Ze}`,pct:qe,color:"var(--color-primary)",size:"normal"},{label:"Workouts",value:`${Me}/${J}`,pct:Ge,color:"var(--color-primary)",size:"large",editable:!0},{label:"Habits Today",value:`${pe}%`,pct:pe,color:"var(--color-primary)",size:"normal"}],Rt=E.calories>0&&V?.calories&&E.calories>=V.calories*.8,Nn=Me>=J&&J>0,Cs=P>=I,Qn=(()=>{if(!he)return null;const S=J-Me;return S===1?"1 more workout to hit your weekly target":S===2?"2 more workouts to hit your weekly target":I-P===1?"1 habit left to complete today":null})(),Ms=S=>!V||!V[S]?0:Math.min(Math.round(E[S]/V[S]*100),100),ri=(()=>{const S=new Date().getHours(),Q=he&&P>=I&&E.calories>0,Ae=D=>D[Math.floor(Date.now()/6e4%D.length)];return Q?Ae(tu.allDone):S>=5&&S<12?Ae(tu.morning):S>=12&&S<17?Ae(tu.afternoon):S>=17&&S<21?Ae(tu.evening):Ae(tu.night)})(),Ds=he?Me===0?{label:"WORKOUT",message:"No workouts this week yet",cta:"Start One",action:()=>b("/client/core-buddy/workouts"),pct:0,ringLabel:"0"}:P<I?{label:"DAILY HABITS",message:`${P}/${I} completed`,cta:"Open Habits",action:()=>b("/client/core-buddy/consistency"),pct:pe,ringLabel:`${P}/${I}`}:y&&E.calories===0?{label:"NUTRITION",message:"No meals logged today",cta:"Log Meal",action:()=>b("/client/core-buddy/nutrition"),pct:0,ringLabel:"0"}:{label:"TODAY",message:"You're crushing it!",cta:null,action:null,pct:100,ringLabel:""}:null,er=w.useCallback(async()=>{if(t){le(!0);try{const Q=(await $t(tn(ut(ye,"posts"),Ot("authorId","==",t.id)))).docs.map(D=>({id:D.id,...D.data()})).sort((D,H)=>{const $=D.createdAt?.toDate?.()||new Date(0);return(H.createdAt?.toDate?.()||new Date(0))-$}).slice(0,30);Tt(Q);const Ae=await $t(tn(ut(ye,"postLikes"),Ot("userId","==",t.id)));Zn(new Set(Ae.docs.map(D=>D.data().postId)))}catch(S){console.error("Error loading journey:",S)}finally{le(!1)}}},[t]);w.useEffect(()=>{he&&t&&er()},[he,t,er]);const _i=S=>{const Q=S.target.files?.[0];if(Q){if(!Q.type.startsWith("image/")){Et("Please select an image file","error");return}if(Q.size>10*1024*1024){Et("Image must be under 10MB","error");return}yt(Q),_t(URL.createObjectURL(Q))}},Er=()=>{yt(null),gt&&URL.revokeObjectURL(gt),_t(null),Nt.current&&(Nt.current.value="")},Ns=async()=>{if(!(!pt.trim()&&!it||zt||!t)){fs(!0);try{let S=null;if(it){const H=await e5(it),$=`${Date.now()}_${Math.random().toString(36).slice(2,8)}`,K=ca(ua,`postImages/${t.id}/${$}`);await wu(K,H),S=await io(K)}await or(ut(ye,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:pt.trim(),type:S?"image":"text",imageURL:S||null,createdAt:xs(),likeCount:0,commentCount:0});const Ae=pt.trim().match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Ae){const H=new Set;Ae.forEach($=>{const K=$.slice(1).trim(),me=ue.find(be=>be.name&&be.name.toLowerCase()===K.toLowerCase());me&&!H.has(me.id)&&(H.add(me.id),Yn(me.id,"mention",{}))})}Ht(""),Er(),Oe.current&&(Oe.current.style.height="auto"),await er();const D=ue.length;Et(D>0?`Shared with ${D} ${D===1?"buddy":"buddies"}`:"Posted to your journey!","success")}catch(S){console.error("Error posting:",S),Et(S?.message||"Failed to post","error")}finally{fs(!1)}}},Ea=async S=>{if(window.confirm("Delete this post?"))try{await ar(ze(ye,"posts",S)),Tt(Q=>Q.filter(Ae=>Ae.id!==S)),Et("Post deleted","info")}catch(Q){console.error("Delete error:",Q),Et("Failed to delete","error")}},zi=async S=>{if(!t)return;const Q=t.id,Ae=`${S}_${Q}`,D=rn.has(S),H=new Set(rn);D?H.delete(S):H.add(S),Zn(H),Tt($=>$.map(K=>K.id===S?{...K,likeCount:Math.max(0,(K.likeCount||0)+(D?-1:1))}:K));try{if(D)await ar(ze(ye,"postLikes",Ae)),await zn(ze(ye,"posts",S),{likeCount:mi(-1)});else{await Wn(ze(ye,"postLikes",Ae),{postId:S,userId:Q,createdAt:xs()}),await zn(ze(ye,"posts",S),{likeCount:mi(1)});const $=pn.find(K=>K.id===S);$&&Yn($.authorId,"like",{postId:S})}}catch($){console.error("Like error:",$),er()}},ii=async S=>{try{const Ae=(await $t(tn(ut(ye,"postComments"),Ot("postId","==",S)))).docs.map(D=>({id:D.id,...D.data()})).sort((D,H)=>{const $=D.createdAt?.toDate?.()||new Date(0),K=H.createdAt?.toDate?.()||new Date(0);return $-K}).slice(0,50);un(D=>({...D,[S]:Ae}))}catch(Q){console.error("Error loading comments:",Q)}},ki=S=>{const Q=new Set(Fn);Q.has(S)?Q.delete(S):(Q.add(S),Pn[S]||ii(S)),Ln(Q)},Fi=async S=>{const Q=(Gt[S]||"").trim(),Ae=Re[S];if(!(!Q&&!Ae||!t)){Z(D=>({...D,[S]:!0}));try{let D=null;if(Ae){const be=ca(ua,`comment-images/${Date.now()}_${Ae.name}`);await wu(be,Ae),D=await io(be)}const H={postId:S,authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Q||"",createdAt:xs()};D&&(H.imageURL=D);const $=N[S];$&&(H.replyToId=$.id,H.replyToName=$.authorName),await or(ut(ye,"postComments"),H),await zn(ze(ye,"posts",S),{commentCount:mi(1)});const K=pn.find(be=>be.id===S);K&&Yn(K.authorId,"comment",{postId:S});const me=Q.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(me){const be=new Set;me.forEach(Ve=>{const nt=Ve.slice(1).trim(),st=ue.find(vt=>vt.name&&vt.name.toLowerCase()===nt.toLowerCase());st&&!be.has(st.id)&&(be.add(st.id),Yn(st.id,"mention",{postId:S}))})}Ct(be=>({...be,[S]:""})),Ie(be=>({...be,[S]:null})),Fe(be=>({...be,[S]:null})),te(be=>({...be,[S]:null})),bt.current[S]&&(bt.current[S].value=""),Tt(be=>be.map(Ve=>Ve.id===S?{...Ve,commentCount:(Ve.commentCount||0)+1}:Ve)),await ii(S)}catch(D){console.error("Comment error:",D),Et("Failed to comment","error")}finally{Z(D=>({...D,[S]:!1}))}}},Br=async(S,Q)=>{try{await ar(ze(ye,"postComments",Q)),await zn(ze(ye,"posts",S),{commentCount:mi(-1)}),un(Ae=>({...Ae,[S]:(Ae[S]||[]).filter(D=>D.id!==Q)})),Tt(Ae=>Ae.map(D=>D.id===S?{...D,commentCount:Math.max((D.commentCount||1)-1,0)}:D))}catch(Ae){console.error("Delete comment error:",Ae),Et("Failed to delete comment","error")}},Tr=(S,Q)=>{const Ae=Q.target.files?.[0];if(!Ae)return;if(Ae.size>5*1024*1024){Et("Image must be under 5MB","error");return}Ie(H=>({...H,[S]:Ae}));const D=new FileReader;D.onload=H=>Fe($=>({...$,[S]:H.target.result})),D.readAsDataURL(Ae)},Ws=S=>{Ie(Q=>({...Q,[S]:null})),Fe(Q=>({...Q,[S]:null})),bt.current[S]&&(bt.current[S].value="")},Gs=S=>{Ht(S.target.value),S.target.style.height="auto",S.target.style.height=Math.min(S.target.scrollHeight,120)+"px",jr(S.target.value,"compose")},Ls=(S,Q)=>{Ct(Ae=>({...Ae,[S]:Q})),jr(Q,S)};return a.jsx(nl,{children:a.jsxs("div",{className:"cb-dashboard",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsxs("div",{className:"header-left-group",children:[a.jsxs("div",{className:"header-notif-wrap",ref:ms,children:[a.jsxs("button",{className:"header-notif-btn",onClick:()=>{On(!hn),hn||kr()},"aria-label":"Notifications",children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),a.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),es>0&&a.jsx("span",{className:"header-notif-badge",children:es>9?"9+":es})]}),hn&&a.jsxs("div",{className:"notif-panel",children:[a.jsxs("div",{className:"notif-panel-header",children:[a.jsx("span",{className:"notif-panel-title",children:"Notifications"}),lt.length>0&&a.jsx("button",{className:"notif-clear-btn",onClick:$s,children:"Clear all"})]}),a.jsx("div",{className:"notif-panel-list",children:lt.length===0?a.jsx("div",{className:"notif-empty",children:"No notifications yet"}):lt.map(S=>a.jsxs("div",{className:`notif-item${S.read?"":" unread"}`,onClick:()=>{if(On(!1),S.type==="buddy_request"||S.type==="buddy_accept")b(y?"/client/core-buddy/buddies":"/upgrade");else if((S.type==="like"||S.type==="comment")&&S.postId){if(!Fn.has(S.postId)){const Q=new Set(Fn);Q.add(S.postId),Ln(Q),Pn[S.postId]||ii(S.postId)}setTimeout(()=>{const Q=document.getElementById(`post-${S.postId}`);Q&&Q.scrollIntoView({behavior:"smooth",block:"center"})},150)}else S.type==="like"||S.type==="comment"?document.querySelector(".cb-journey-section")?.scrollIntoView({behavior:"smooth"}):S.type==="mention"&&b(`/client/core-buddy/profile/${S.fromId}`)},children:[a.jsx("div",{className:"notif-item-avatar",children:S.fromPhotoURL?a.jsx("img",{src:S.fromPhotoURL,alt:""}):a.jsx("span",{children:(S.fromName||"?")[0]})}),a.jsxs("div",{className:"notif-item-body",children:[a.jsxs("p",{className:"notif-item-text",children:[a.jsx("strong",{children:S.fromName})," ",S.type==="buddy_request"&&"sent you a buddy request",S.type==="buddy_accept"&&"accepted your buddy request",S.type==="like"&&"liked your post",S.type==="comment"&&"commented on your post",S.type==="mention"&&"mentioned you"]}),a.jsx("span",{className:"notif-item-time",children:np(S.createdAt)})]})]},S.id))})]})]}),a.jsx("button",{className:"header-icon-btn",onClick:()=>b("/client/core-buddy/settings"),"aria-label":"Settings",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})})]}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{className:"header-icon-btn",onClick:g,"aria-label":d?"Switch to light mode":"Switch to dark mode",children:d?a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})}),a.jsx("button",{className:"header-icon-btn",onClick:i,"aria-label":"Log out",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),a.jsxs("main",{className:"cb-main",children:[a.jsxs("div",{className:"cb-ring-container",children:[a.jsxs("div",{className:"cb-ring",children:[a.jsx("svg",{className:"cb-ring-svg",viewBox:"0 0 200 200",children:Uj.map((S,Q)=>{const Ae=Q<B;return a.jsx("line",{x1:S.x1,y1:S.y1,x2:S.x2,y2:S.y2,className:`ring-tick ${Ae?"elapsed":"remaining"}`,strokeWidth:S.thick?"3":"2"},Q)})}),a.jsxs("div",{className:"cb-ring-center",children:[a.jsxs("div",{className:"cb-ring-logo",onClick:()=>Xe.current?.click(),role:"button",tabIndex:0,"aria-label":"Change profile photo",children:[a.jsx("img",{src:Ce||"/Logo.webp",alt:Ce?"Profile":"Mind Core Fitness"}),a.jsx("div",{className:`cb-photo-overlay${Ue?" uploading":""}`,children:Ue?a.jsx("div",{className:"cb-photo-spinner"}):a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),a.jsx("input",{ref:Xe,type:"file",accept:"image/*",onChange:O,style:{display:"none"}})]}),!Ce&&!Ue&&a.jsx("div",{className:"cb-photo-badge",onClick:()=>Xe.current?.click(),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),a.jsxs("div",{className:"cb-ring-countdown",children:[a.jsx("span",{className:"cb-timer-digit",children:String(F.hours).padStart(2,"0")}),a.jsx("span",{className:"cb-timer-colon",children:":"}),a.jsx("span",{className:"cb-timer-digit",children:String(F.minutes).padStart(2,"0")}),a.jsx("span",{className:"cb-timer-colon",children:":"}),a.jsx("span",{className:"cb-timer-digit cb-timer-seconds",children:String(F.seconds).padStart(2,"0")})]}),a.jsx("span",{className:"cb-ring-label",children:"remaining today"}),a.jsxs("p",{className:"cb-ring-tagline",children:[tp[It].text," ",a.jsx("strong",{children:tp[It].bold})]},It)]}),a.jsx("div",{className:"cb-stats-row",children:ot.map(S=>{const Q=(S.size==="large",38),Ae=2*Math.PI*Q,D=Ae-S.pct/100*Ae,H=S.editable,$=S.pct>=75&&S.pct<100,K=S.pct>=100;return a.jsxs("div",{className:`cb-stat-item${S.size==="large"?" cb-stat-large":""}`,children:[a.jsxs("div",{className:`cb-stat-ring${H?" cb-stat-tappable":""}${H&&Pe?" cb-stat-hint":""}${$?" cb-stat-near":""}${K?" cb-stat-complete":""}`,onClick:H?()=>{ke(!0),U(!1)}:void 0,children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-stat-track",cx:"50",cy:"50",r:Q}),a.jsx("circle",{className:`cb-stat-fill${$?" cb-fill-near":""}${K?" cb-fill-complete":""}`,cx:"50",cy:"50",r:Q,strokeDasharray:Ae,strokeDashoffset:D})]}),a.jsx("span",{className:`cb-stat-value${K?" cb-val-complete":""}`,children:S.value})]}),a.jsxs("span",{className:"cb-stat-label",children:[S.label==="Wk Streak"&&Ze>0&&a.jsx("svg",{className:"cb-streak-flame",width:"12",height:"12",viewBox:"0 0 24 24",fill:"var(--color-primary)",stroke:"none",children:a.jsx("path",{d:"M12 12c2-2.96 0-7-1-8 0 3.038-1.773 4.741-3 6-1.226 1.26-2 3.24-2 5a6 6 0 1 0 12 0c0-1.532-1.056-3.94-2-5-1.786 3-2.791 3-4 2z"})}),S.label]})]},S.label)})}),He&&a.jsx("div",{className:"cb-target-overlay",onClick:()=>ke(!1),children:a.jsxs("div",{className:"cb-target-picker",onClick:S=>S.stopPropagation(),children:[a.jsx("h4",{children:"Weekly workout target"}),a.jsx("p",{children:"How many sessions per week?"}),a.jsx("div",{className:"cb-target-options",children:[1,2,3,4,5,6,7].map(S=>a.jsx("button",{className:`cb-target-option${S===J?" active":""}`,onClick:()=>oe(S),children:S},S))})]})}),a.jsxs("p",{className:"cb-coach-msg",children:[ri.main," ",a.jsx("strong",{children:Ye}),"  ",ri.sub]}),Qn&&a.jsxs("div",{className:"cb-milestone-hint",children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),a.jsx("span",{children:Qn})]}),Ds&&a.jsxs("button",{className:"cb-nudge-card",onClick:Ds.action||void 0,style:Ds.action?void 0:{cursor:"default"},children:[a.jsxs("div",{className:"cb-nudge-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-nudge-ring-track",cx:"50",cy:"50",r:"38"}),a.jsx("circle",{className:"cb-nudge-ring-fill",cx:"50",cy:"50",r:"38",strokeDasharray:2*Math.PI*38,strokeDashoffset:2*Math.PI*38-Ds.pct/100*2*Math.PI*38})]}),a.jsx("span",{className:"cb-nudge-ring-val",children:Ds.ringLabel})]}),a.jsxs("div",{className:"cb-nudge-info",children:[a.jsx("span",{className:"cb-nudge-label",children:Ds.label}),a.jsx("span",{className:"cb-nudge-title",children:Ds.message}),Ds.cta&&a.jsxs("span",{className:"cb-nudge-cta",children:[Ds.cta," "]})]})]}),a.jsxs("div",{className:"cb-features",children:[y&&a.jsxs("button",{className:`cb-feature-card cb-card-nutrition cb-card-has-preview ripple-btn${Rt?" cb-card-done":""}`,onClick:S=>{ne(S),b("/client/core-buddy/nutrition")},children:[a.jsxs("div",{className:"cb-card-top-row",children:[a.jsx("div",{className:"cb-card-content",children:a.jsx("h3",{children:"Today's Nutrition"})}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsx("div",{className:"cb-card-preview-row",children:a.jsx("div",{className:"cb-mini-rings",children:[{label:"P",pct:Ms("protein"),color:"var(--color-primary)"},{label:"C",pct:Ms("carbs"),color:"var(--color-primary)"},{label:"F",pct:Ms("fats"),color:"var(--color-primary)"},{label:"Cal",pct:Ms("calories"),color:"var(--color-primary)"}].map(S=>{const Ae=2*Math.PI*38,D=Ae-S.pct/100*Ae;return a.jsxs("div",{className:"cb-mini-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-mini-track",cx:"50",cy:"50",r:38}),a.jsx("circle",{className:"cb-mini-fill",cx:"50",cy:"50",r:38,style:{stroke:S.color},strokeDasharray:Ae,strokeDashoffset:D})]}),a.jsx("span",{style:{color:S.color},children:S.label})]},S.label)})})}),a.jsx("p",{className:"cb-card-desc",children:"Track macros, scan barcodes, log water"})]}),a.jsxs("button",{className:`cb-feature-card cb-card-workouts-hero ripple-btn${Nn?" cb-card-done":""}`,onClick:S=>{ne(S),b("/client/core-buddy/workouts")},children:[a.jsx("h3",{className:"cb-hero-title",children:"Workout"}),a.jsxs("div",{className:"cb-hero-stats",children:[a.jsxs("span",{children:[Me," this week"]}),a.jsx("span",{className:"cb-hero-dot",children:""}),a.jsxs("span",{children:[ee," total"]})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:`cb-feature-card cb-card-consistency ripple-btn${Cs?" cb-card-done":""}`,onClick:S=>{ne(S),b("/client/core-buddy/consistency")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Habits"}),a.jsx("div",{className:`cb-habit-dots${P>=I?" cb-habits-all-done":""}`,children:Array.from({length:I},(S,Q)=>a.jsx("span",{className:`cb-habit-dot${Q<P?" done":""}${!Q&&P>0&&Q>=P?" cb-dot-warming":""}`,style:Q>=P&&P>0?{"--glow-intensity":Math.min(P/I,.9)}:void 0},Q))}),a.jsxs("span",{className:"cb-habit-dots-label",children:[P,"/",I," today"]})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:"cb-feature-card cb-card-leaderboard ripple-btn",onClick:S=>{ne(S),b("/client/leaderboard")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Leaderboard"}),ce.length>0?a.jsx("div",{className:"cb-lb-preview",children:ce.map((S,Q)=>{const Ae=["#FFD700","#A8B4C0","#CD7F32"][Q],D=S.name?S.name.split(" ").map(me=>me[0]).join("").slice(0,2).toUpperCase():"?",H=S.id===t?.id,$=Q+1,K=H&&hr?hr-$:0;return a.jsxs("div",{className:`cb-lb-entry${H?" cb-lb-me":""}`,children:[a.jsx("div",{className:"cb-lb-avatar",style:{borderColor:Ae},children:S.photoURL?a.jsx("img",{src:S.photoURL,alt:"",className:"cb-lb-avatar-img"}):a.jsx("span",{children:D})}),a.jsxs("span",{className:"cb-lb-rank",style:{color:Ae},children:["#",$,H&&K>0&&a.jsxs("span",{className:"cb-lb-movement cb-lb-up",children:["+",K]}),H&&K<0&&a.jsx("span",{className:"cb-lb-movement cb-lb-down",children:K})]})]},S.id)})}):a.jsx("p",{children:"Opt in to compete with your Core Buddies"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),y&&a.jsxs("div",{className:"cb-grid-row",children:[a.jsxs("button",{className:"cb-feature-card cb-grid-card cb-card-challenge ripple-btn",onClick:S=>{ne(S),b("/client/core-buddy/challenges")},children:[a.jsx("div",{className:"cb-card-icon-wrap cb-card-icon-challenge",children:a.jsx("img",{src:Pr.find(S=>S.id==="iron_will")?.img,alt:"",className:"cb-card-badge-img",loading:"lazy"})}),a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Challenges"}),a.jsx("p",{children:"Push yourself with timed fitness challenges"})]}),a.jsx("svg",{className:"cb-grid-arrow",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:"cb-feature-card cb-grid-card cb-card-badges ripple-btn",onClick:S=>{ne(S),b("/client/core-buddy/badges")},children:[a.jsx("div",{className:"cb-card-icon-wrap cb-card-icon-badges",children:a.jsx("img",{src:Pr.find(S=>S.id==="first_workout")?.img,alt:"",className:"cb-card-badge-img",loading:"lazy"})}),a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Badges"}),a.jsx("p",{children:"Collect badges as you hit milestones"})]}),a.jsx("svg",{className:"cb-grid-arrow",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]})]}),y&&a.jsxs("button",{className:"cb-feature-card cb-card-buddies ripple-btn",onClick:S=>{ne(S),b("/client/core-buddy/buddies")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Buddies"}),a.jsx("p",{children:"Connect with other members and track each other's progress"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),y&&a.jsxs("div",{className:"cb-journey-section",children:[a.jsx("h3",{className:"cb-journey-title",children:"My Journey"}),a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"journey-compose",children:[a.jsx("div",{className:"journey-compose-avatar",children:Ce?a.jsx("img",{src:Ce,alt:""}):a.jsx("span",{children:nu(t?.name)})}),a.jsxs("div",{className:"journey-compose-body",style:{position:"relative"},children:[a.jsx("textarea",{ref:Oe,placeholder:"Share your progress... (use @ to mention)",value:pt,onChange:Gs,rows:1,maxLength:500}),rt&&fn==="compose"&&St.length>0&&a.jsx("div",{className:"mention-dropdown",children:St.map(S=>a.jsxs("button",{className:"mention-option",onClick:()=>ts(S,"compose"),children:[a.jsx("div",{className:"mention-option-avatar",children:S.photoURL?a.jsx("img",{src:S.photoURL,alt:""}):a.jsx("span",{children:nu(S.name)})}),a.jsx("span",{children:S.name})]},S.id))}),gt&&a.jsxs("div",{className:"journey-image-preview",children:[a.jsx("img",{src:gt,alt:"Preview"}),a.jsx("button",{className:"journey-image-remove",onClick:Er,"aria-label":"Remove image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"journey-compose-actions",children:[a.jsx("button",{className:"journey-image-btn",onClick:()=>Nt.current?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:Nt,type:"file",accept:"image/*",onChange:_i,hidden:!0}),(pt.trim()||it)&&a.jsx("button",{className:"journey-post-btn",onClick:Ns,disabled:zt,children:zt?a.jsx("div",{className:"journey-btn-spinner"}):"Post"})]})]})]}),dt?a.jsx("div",{className:"journey-loading",children:a.jsx("div",{className:"cb-spinner"})}):pn.length===0?a.jsxs("div",{className:"journey-empty",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("p",{children:"Start sharing your fitness journey!"})]}):a.jsx("div",{className:"journey-list",children:pn.map(S=>a.jsxs("div",{id:`post-${S.id}`,className:"journey-post",children:[a.jsxs("div",{className:"journey-post-header",children:[a.jsx("div",{className:"journey-post-avatar",children:S.authorPhotoURL?a.jsx("img",{src:S.authorPhotoURL,alt:""}):a.jsx("span",{children:nu(S.authorName)})}),a.jsxs("div",{className:"journey-post-meta",children:[a.jsx("span",{className:"journey-post-name",children:S.authorName}),a.jsx("span",{className:"journey-post-time",children:np(S.createdAt)})]}),a.jsx("button",{className:"journey-delete-btn",onClick:()=>Ea(S.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),S.type==="workout_summary"&&S.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:S.metadata.title}),S.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:S.metadata.stats.map(Q=>`${Q.value} ${Q.label}`).join("    ")}),!S.metadata.stats?.length&&S.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:S.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed a workout using Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):S.type==="badge_earned"&&S.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame journey-card-logo-badge",children:(()=>{const Q=Pr.find(Ae=>Ae.id===S.metadata.badgeId);return Q?.img?a.jsx("img",{src:Q.img,alt:S.metadata.title,className:"journey-card-logo-img",loading:"lazy"}):a.jsx("img",{src:"/Logo.webp",alt:S.metadata.title,className:"journey-card-logo-img"})})()}),a.jsx("h3",{className:"journey-card-title",children:S.metadata.title}),S.metadata.badgeDesc&&a.jsx("p",{className:"journey-card-stats-line",children:S.metadata.badgeDesc}),a.jsx("p",{className:"journey-card-cta",children:"I just earned a badge on Core Buddy"}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):S.type==="habits_summary"&&S.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:S.metadata.title}),S.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:S.metadata.stats.map(Q=>`${Q.value} ${Q.label}`).join("    ")}),S.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:S.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed my daily habits with Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):a.jsxs(a.Fragment,{children:[S.content&&a.jsx("p",{className:"journey-post-content",children:Ur(S.content)}),S.imageURL&&a.jsx("div",{className:"journey-post-image",children:a.jsx("img",{src:S.imageURL,alt:"Post",loading:"lazy"})})]}),a.jsxs("div",{className:"journey-post-actions",children:[a.jsxs("button",{className:`journey-action-btn${rn.has(S.id)?" liked":""}`,onClick:()=>zi(S.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:rn.has(S.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:S.likeCount||0})]}),a.jsxs("button",{className:`journey-action-btn${Fn.has(S.id)?" active":""}`,onClick:()=>ki(S.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:S.commentCount||0})]})]}),Fn.has(S.id)&&a.jsxs("div",{className:"journey-comments",children:[Pn[S.id]?.length>0?Pn[S.id].map(Q=>a.jsxs("div",{className:"journey-comment",children:[a.jsx("div",{className:"journey-comment-avatar",children:Q.authorPhotoURL?a.jsx("img",{src:Q.authorPhotoURL,alt:""}):a.jsx("span",{children:nu(Q.authorName)})}),a.jsxs("div",{className:"journey-comment-body",children:[a.jsxs("div",{className:"journey-comment-bubble",children:[a.jsx("span",{className:"journey-comment-name",children:Q.authorName}),Q.replyToName&&a.jsxs("span",{className:"journey-comment-reply-tag",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"9 14 4 9 9 4"}),a.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),Q.replyToName]}),Q.content&&a.jsx("span",{className:"journey-comment-text",children:Ur(Q.content)}),Q.imageURL&&a.jsx("img",{className:"journey-comment-image",src:Q.imageURL,alt:"Comment",loading:"lazy"})]}),a.jsxs("div",{className:"journey-comment-actions-row",children:[a.jsx("span",{className:"journey-comment-time",children:np(Q.createdAt)}),a.jsx("button",{className:"journey-comment-reply-btn",onClick:()=>te(Ae=>({...Ae,[S.id]:{id:Q.id,authorName:Q.authorName}})),children:"Reply"}),a.jsx("button",{className:"journey-comment-delete-btn",onClick:()=>Br(S.id,Q.id),"aria-label":"Delete comment",children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]})]},Q.id)):a.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),N[S.id]&&a.jsxs("div",{className:"journey-comment-replying",children:[a.jsxs("span",{children:["Replying to ",a.jsx("strong",{children:N[S.id].authorName})]}),a.jsx("button",{onClick:()=>te(Q=>({...Q,[S.id]:null})),"aria-label":"Cancel reply",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),De[S.id]&&a.jsxs("div",{className:"journey-comment-img-preview",children:[a.jsx("img",{src:De[S.id],alt:"Preview"}),a.jsx("button",{onClick:()=>Ws(S.id),"aria-label":"Remove image",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[a.jsx("button",{className:"journey-comment-img-btn",onClick:()=>bt.current[S.id]?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:Q=>{bt.current[S.id]=Q},type:"file",accept:"image/*",onChange:Q=>Tr(S.id,Q),hidden:!0}),a.jsx("input",{type:"text",placeholder:"Comment",value:Gt[S.id]||"",onChange:Q=>Ls(S.id,Q.target.value),onKeyDown:Q=>{Q.key==="Enter"&&Fi(S.id)},maxLength:300}),rt&&fn===S.id&&St.length>0&&a.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:St.map(Q=>a.jsxs("button",{className:"mention-option",onClick:()=>ts(Q,S.id),children:[a.jsx("div",{className:"mention-option-avatar",children:Q.photoURL?a.jsx("img",{src:Q.photoURL,alt:""}):a.jsx("span",{children:nu(Q.name)})}),a.jsx("span",{children:Q.name})]},Q.id))}),a.jsx("button",{onClick:()=>Fi(S.id),disabled:!(Gt[S.id]||"").trim()&&!Re[S.id]||Mt[S.id],children:Mt[S.id]?a.jsx("div",{className:"journey-btn-spinner-sm"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),a.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},S.id))})]})]}),!y&&a.jsxs("button",{className:"cb-upgrade-cta",onClick:()=>b("/upgrade"),children:[a.jsx("span",{className:"cb-upgrade-cta-text",children:"Unlock the full experience"}),a.jsx("span",{className:"cb-upgrade-cta-sub",children:"Unlimited workout times, nutrition, buddies & more"}),a.jsxs("svg",{className:"cb-upgrade-cta-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]})]})]}),a.jsx(ni,{active:"home"}),xi&&a.jsx("div",{className:"cb-weekly-celebration",children:a.jsxs("div",{className:"cb-weekly-celebration-card",children:[a.jsx("span",{className:"cb-weekly-celebration-icon",children:a.jsx("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsx("h4",{children:"Weekly Target Smashed!"}),a.jsxs("p",{children:[Me,"/",J," sessions complete"]})]})}),ln&&a.jsxs("div",{className:`toast-notification ${ln.type}`,children:[ln.type==="info"&&a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),a.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),ln.type==="success"&&a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),ln.message]}),a.jsx(L3,{steps:wn,active:os,onFinish:q})]})})}async function nf(s,e){const t=Pr.find(i=>i.id===s);if(!t||!e?.id)return null;try{const i=ze(ye,"coreBuddyBadges",e.id),l=await _s(i),c=l.exists()?l.data().earned||[]:[];if(c.some(g=>g.id===t.id))return null;const d={id:t.id,earnedAt:new Date().toISOString()};return l.exists()?await zn(i,{earned:[...c,d]}):await Wn(i,{earned:[d]}),await or(ut(ye,"posts"),{authorId:e.id,authorName:e.name||"Anonymous",authorPhotoURL:e.photoURL||null,type:"badge_earned",metadata:{title:t.name,badgeDesc:t.desc,badgeId:t.id},createdAt:xs(),likeCount:0,commentCount:0}),t}catch(i){return console.error("Badge award failed:",i),null}}function Wl({badge:s,onDismiss:e}){if(!s)return null;const t=Array.from({length:60}).map((i,l)=>({x:5+Math.random()*90,delay:Math.random()*.5,color:["#A12F3A","#ffffff","#000000"][l%3],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.6+Math.random()*1.8,width:4+Math.random()*6,height:4+Math.random()*8,shape:l%3}));return a.jsxs("div",{className:"bc-overlay",onClick:e,children:[a.jsx("div",{className:"bc-confetti","aria-hidden":"true",children:t.map((i,l)=>a.jsx("span",{className:`bc-confetti-piece bc-shape-${i.shape}`,style:{"--x":`${i.x}%`,"--delay":`${i.delay}s`,"--color":i.color,"--drift":`${i.drift}px`,"--spin":`${i.spin}deg`,"--duration":`${i.duration}s`,width:`${i.width}px`,height:`${i.height}px`}},l))}),a.jsxs("div",{className:"bc-content",onClick:i=>i.stopPropagation(),children:[a.jsx("div",{className:"bc-glow"}),s.img&&a.jsx("img",{src:s.img,alt:s.name,className:"bc-badge-img"}),a.jsx("h2",{className:"bc-title",children:"Badge Unlocked!"}),a.jsx("p",{className:"bc-name",children:s.name}),a.jsx("p",{className:"bc-desc",children:s.desc}),a.jsx("button",{className:"bc-dismiss",onClick:e,children:"Tap to dismiss"})]})]})}const sp=new Map;function Qr(){return new Date().toISOString().split("T")[0]}const sx=[{key:"breakfast",label:"Breakfast"},{key:"lunch",label:"Lunch"},{key:"dinner",label:"Dinner"},{key:"snacks",label:"Snacks"}],n5={breakfast:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1"}),a.jsx("path",{d:"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"}),a.jsx("line",{x1:"6",y1:"1",x2:"6",y2:"4"}),a.jsx("line",{x1:"10",y1:"1",x2:"10",y2:"4"}),a.jsx("line",{x1:"14",y1:"1",x2:"14",y2:"4"})]}),lunch:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}),dinner:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),snacks:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})};function s5(){const s=new Date().getHours();return s<11?"breakfast":s<14?"lunch":s<17?"snacks":"dinner"}function r5(){const{currentUser:s,isClient:e,clientData:t,loading:i}=_r(),{isDark:l,toggleTheme:c}=Bi(),d=qs(),[g,y]=w.useState("loading"),[p,b]=w.useState(null),[_,j]=w.useState(null),[I,F]=w.useState({gender:"male",age:"",weight:"",weightUnit:"kg",height:"",heightUnit:"cm",heightFeet:"",heightInches:"",dailyActivity:"sedentary",trainingFrequency:"moderate",goal:"maintain",deficitLevel:"moderate"}),[G,B]=w.useState(null),[Y,ee]=w.useState(Qr()),[re,pe]=w.useState({entries:[]}),[ve,he]=w.useState({protein:0,carbs:0,fats:0,calories:0}),[L,E]=w.useState(!1),[A,V]=w.useState(()=>{const O=new Date;return{year:O.getFullYear(),month:O.getMonth()}}),[M,P]=w.useState(!1),[C,Me]=w.useState(()=>{const O=new Date;return{year:O.getFullYear(),month:O.getMonth()}}),[Qe,J]=w.useState(!1),[Se,He]=w.useState(s5),[ke,Pe]=w.useState(null),[U,ce]=w.useState(null),[Ee,Ce]=w.useState(!1),[je,Ue]=w.useState(null),[$e,Xe]=w.useState(""),[Ze,Wt]=w.useState(!1),[It,Cn]=w.useState(""),[ln,qt]=w.useState([]),[Et,pn]=w.useState(!1),[Tt,dt]=w.useState({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),[le,pt]=w.useState(null),[Ht,it]=w.useState("100"),[yt,gt]=w.useState(0),[_t,zt]=w.useState("weight"),[fs,rn]=w.useState(0),[Zn,Fn]=w.useState(null);w.useRef(null);const Ln=w.useRef(!1),Pn=w.useRef(null),un=w.useRef(null),Gt=w.useRef(null),Ct=w.useCallback((O,q="info")=>{Fn({message:O,type:q}),setTimeout(()=>Fn(null),3e3)},[]);w.useEffect(()=>{!i&&(!s||!e)&&d("/")},[s,e,i,d]),w.useEffect(()=>{if(!t?.id)return;(async()=>{try{const q=await _s(ze(ye,"nutritionTargets",t.id));q.exists()?(b(q.data()),y("dashboard")):y("setup")}catch(q){console.error("Error loading nutrition data:",q),y("setup")}})()},[t?.id]),w.useEffect(()=>{if(!t?.id)return;(async()=>{try{const q=await _s(ze(ye,"nutritionLogs",`${t.id}_${Y}`));if(q.exists()){const oe=q.data();pe({entries:oe.entries||[]})}else pe({entries:[]})}catch(q){console.error("Error loading log:",q),pe({entries:[]})}})()},[t?.id,Y]),w.useEffect(()=>{const O=re.entries.reduce((q,oe)=>({protein:q.protein+(oe.protein||0),carbs:q.carbs+(oe.carbs||0),fats:q.fats+(oe.fats||0),calories:q.calories+(oe.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});he(O)},[re.entries]);const Mt=async O=>{try{if(await Wn(ze(ye,"nutritionLogs",`${t.id}_${Y}`),{clientId:t.id,date:Y,entries:O.entries,updatedAt:Bt.now()}),p?.protein&&Y===Qr()&&O.entries.reduce((oe,ne)=>oe+(ne.protein||0),0)>=p.protein){let oe=1;for(let ne=1;ne<7;ne++){const Ye=new Date;Ye.setDate(Ye.getDate()-ne);const Ge=Ye.toISOString().split("T")[0];try{const qe=await _s(ze(ye,"nutritionLogs",`${t.id}_${Ge}`));if(qe.exists())if((qe.data().entries||[]).reduce((Rt,Nn)=>Rt+(Nn.protein||0),0)>=p.protein)oe++;else break;else break}catch{break}}if(oe>=7){const ne=await nf("nutrition_7",t);ne&&j(ne)}}}catch(q){console.error("Error saving nutrition log:",q)}},Z=Y===Qr(),N=(O,q)=>new Date(O,q+1,0).getDate(),te=(O,q)=>new Date(O,q,1).getDay(),Re=O=>{if(O===Qr())return"Today";const q=new Date(O+"T12:00:00"),oe=new Date;return oe.setDate(oe.getDate()-1),O===oe.toISOString().split("T")[0]?"Yesterday":q.toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short"})},Ie=["January","February","March","April","May","June","July","August","September","October","November","December"],De=["Su","Mo","Tu","We","Th","Fr","Sa"],Fe=()=>{let O=parseFloat(I.weight);I.weightUnit==="lbs"&&(O*=.453592);let q;I.heightUnit==="cm"?q=parseFloat(I.height):q=(parseFloat(I.heightFeet)||0)*30.48+(parseFloat(I.heightInches)||0)*2.54;const oe=parseInt(I.age);let ne=I.gender==="male"?10*O+6.25*q-5*oe+5:10*O+6.25*q-5*oe-161;const Ge=ne*{sedentary:1.2,light:1.3,moderate:1.4,active:1.5}[I.dailyActivity],qe={low:100,moderate:200,high:300,daily:400},ot=Math.round(Ge+qe[I.trainingFrequency]);let Rt=ot,Nn,Cs;switch(I.goal){case"lose":Rt=ot*(1-{light:.15,moderate:.2,harsh:.25}[I.deficitLevel]),Nn=2.2,Cs=.3;break;case"build":Rt=ot*1.1,Nn=2,Cs=.22;break;default:Nn=1.8,Cs=.25}Rt=Math.max(Rt,I.gender==="male"?1400:1100);const Qn=Math.round(O*Nn),Ms=Math.round(Rt*Cs/9),ri=Math.max(0,Math.round((Rt-Qn*4-Ms*9)/4));B({calories:Math.round(Rt),protein:Qn,carbs:ri,fats:Ms,bmr:Math.round(ne),neat:Math.round(Ge),exerciseAdd:qe[I.trainingFrequency],tdee:Math.round(ot)}),setTimeout(()=>{document.querySelector(".nut-calc-results")?.scrollIntoView({behavior:"smooth",block:"start"})},100)},Oe=async()=>{if(G)try{const O={clientId:t.id,calories:G.calories,protein:G.protein,carbs:G.carbs,fats:G.fats,goal:I.goal,updatedAt:Bt.now()};await Wn(ze(ye,"nutritionTargets",t.id),O),b(O),y("dashboard"),Ct("Macro targets saved!","success")}catch(O){console.error("Error saving targets:",O),Ct("Failed to save targets. Please try again.","error")}},Nt=()=>{const O=I.weight&&parseFloat(I.weight)>0,q=I.age&&parseInt(I.age)>0,oe=I.heightUnit==="cm"?I.height&&parseFloat(I.height)>0:I.heightFeet&&parseFloat(I.heightFeet)>0||I.heightInches&&parseFloat(I.heightInches)>0;return O&&q&&oe},bt="nut_favourite_foods",lt=()=>{try{return JSON.parse(localStorage.getItem(bt)||"[]")}catch{return[]}};w.useEffect(()=>{if(!t?.id)return;(async()=>{try{const q=await _s(ze(ye,"favouriteFoods",t.id));if(q.exists()){const oe=q.data().items||[];localStorage.setItem(bt,JSON.stringify(oe)),rn(ne=>ne+1)}else{const oe=lt();oe.length>0&&await Wn(ze(ye,"favouriteFoods",t.id),{items:oe,updatedAt:Bt.now()})}}catch(q){console.error("Error loading favourites:",q)}})()},[t?.id]);const dn=O=>lt().some(q=>q.name.toLowerCase()===(O||"").toLowerCase()),hn=O=>{const q=lt(),oe=q.findIndex(ne=>ne.name.toLowerCase()===O.name.toLowerCase());oe>=0?q.splice(oe,1):q.unshift({name:O.name,protein:O.protein,carbs:O.carbs,fats:O.fats,calories:O.calories,serving:O.serving,per100g:O.per100g||null,servingUnit:O.servingUnit||"g",portion:O.portion||null}),localStorage.setItem(bt,JSON.stringify(q)),t?.id&&Wn(ze(ye,"favouriteFoods",t.id),{items:q,updatedAt:Bt.now()}).catch(ne=>console.error("Error saving favourites:",ne)),rn(ne=>ne+1)},On=O=>{const q=[...re.entries,{...O,meal:Se,id:Date.now(),addedAt:new Date().toISOString()}],oe={...re,entries:q};pe(oe),Mt(oe),ce(null),pt(null),it("100"),gt(0),zt("weight"),dt({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),Ct("Food added!","success")},ms=O=>{const q=re.entries.filter(ne=>ne.id!==O),oe={...re,entries:q};pe(oe),Mt(oe)},ue=async O=>{if(!(!t?.id||O===Y)){J(!0);try{const q=await _s(ze(ye,"nutritionLogs",`${t.id}_${O}`));if(!q.exists()||!q.data().entries?.length){Ct("No food logged on that day","error");return}const oe=q.data().entries.map(Ge=>({...Ge,id:Date.now()+Math.random(),addedAt:new Date().toISOString()})),ne=[...re.entries,...oe],Ye={...re,entries:ne};pe(Ye),Mt(Ye),P(!1),Ct(`Copied ${oe.length} items from ${Re(O)}`,"success")}catch(q){console.error("Error copying day:",q),Ct("Failed to copy day","error")}finally{J(!1)}}},Le=w.useRef(null),Ke=w.useRef([]),ct=3,rt=5,Kt=async()=>{Ce(!0);const O=document.querySelector("#barcode-reader");if(!O){Ce(!1),Ct("Scanner container not found.","error");return}if(!Le.current)try{const oe=await Hs(()=>import("./quagga.min-BbicSfvA.js").then(ne=>ne.q),[]);Le.current=oe.default}catch(oe){console.error("Failed to load barcode scanner:",oe),Ce(!1),Ct("Could not load scanner.","error");return}const q=Le.current;q.init({inputStream:{type:"LiveStream",target:O,constraints:{facingMode:"environment",width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080}}},locator:{patchSize:"medium",halfSample:!0},numOfWorkers:navigator.hardwareConcurrency||2,decoder:{readers:["ean_reader","ean_8_reader","upc_reader","upc_e_reader","code_128_reader","code_39_reader"]},locate:!0},oe=>{if(oe){console.error("Quagga init error:",oe),Ce(!1),Ct("Could not access camera. Check permissions.","error");return}q.start(),Ln.current=!0}),Ke.current=[],q.onDetected(oe=>{const ne=oe.codeResult.decodedCodes?.filter(Ge=>Ge.error!==void 0)?.map(Ge=>Ge.error)||[];if((ne.length>0?ne.reduce((Ge,qe)=>Ge+qe,0)/ne.length:1)<.15){const Ge=oe.codeResult.code,qe=Ke.current;qe.push(Ge),qe.length>rt&&qe.shift(),qe.filter(Rt=>Rt===Ge).length>=ct&&(q.offDetected(),Ke.current=[],Ue(Ge))}})},fn=()=>{const O=Le.current;Ln.current&&O&&(O.stop(),O.offDetected(),Ln.current=!1),Ce(!1)},At=/\b(milk|semi.skimmed|skimmed|whole milk|oat milk|almond milk|soy milk|juice|smoothie|water|squash|cordial|cola|pepsi|fanta|lemonade|soda|beer|wine|cider|lager|spirit|whisky|vodka|rum|gin|brandy|cream|yoghurt drink|milkshake|coffee|tea|broth|stock|soup|sauce|ketchup|vinegar|oil|syrup|honey|custard|coconut water|kombucha|energy drink|protein shake)\b/i,St=O=>/ml|cl|\dl(?!b)|litre|liter|fl\s?oz/i.test((O||"").replace(/\s/g,"")),bn=O=>{if(!O)return{value:100,unit:"g"};const q=O.toLowerCase().replace(/\s/g,""),oe=q.match(/([\d.]+)/),ne=oe?parseFloat(oe[1]):100;return St(O)?/cl/.test(q)?{value:ne*10,unit:"ml"}:/(?:^|\d)l(?!i)/.test(q)&&!/ml/.test(q)?{value:ne*1e3,unit:"ml"}:{value:ne,unit:"ml"}:{value:ne,unit:"g"}},Ss=O=>{if(St(O.serving_size)||St(O.quantity))return"ml";const q=O.product_name||O.product_name_en||"";return At.test(q)?"ml":"g"},si=[{pattern:/\b(toast|bread|loaf|brioche|bagel|pitta|wrap|tortilla|crumpet|muffin|waffle|pancake)\b/i,label:"slice",weight:36},{pattern:/\begg\b/i,label:"egg",weight:60},{pattern:/\b(biscuit|cookie|digestive|hobnob|rich tea|oreo)\b/i,label:"biscuit",weight:13},{pattern:/\b(sausage|banger)\b/i,label:"sausage",weight:57},{pattern:/\b(rasher|bacon)\b/i,label:"rasher",weight:25},{pattern:/\b(rice cake)\b/i,label:"cake",weight:9},{pattern:/\b(cracker|ryvita)\b/i,label:"cracker",weight:10}],xi=(O,q)=>{const oe=O||"",ne=oe.match(/\((\d+\.?\d*)\s*g\)/i),Ye=oe.match(/(?:^|per\s+)(\d*\s*[a-z][a-z\s]*?)(?:\s*\(|\s*-\s*|\s*$)/i);if(ne&&Ye){const ot=parseFloat(ne[1]);let Rt=Ye[1].replace(/^\d+\s*/,"").trim();if(Rt&&ot>0)return{label:Rt,weight:ot}}const Ge=oe.match(/(\d+\.?\d*)\s*g\s*[\/=]\s*(\d*\s*[a-z][a-z\s]*)/i);if(Ge){const ot=parseFloat(Ge[1]);let Rt=Ge[2].replace(/^\d+\s*/,"").trim();if(Rt&&ot>0)return{label:Rt,weight:ot}}const qe=q||"";for(const{pattern:ot,label:Rt,weight:Nn}of si)if(ot.test(qe))return{label:Rt,weight:Nn};return null},Vr=O=>{const q=O.nutriments||{},oe=Ss(O),ne=bn(O.serving_size),Ye=oe==="ml"?ne.unit==="ml"?ne.value:100:ne.value,Ge=O.product_name||O.product_name_en||"Unknown Product",qe=xi(O.serving_size,Ge);return{name:Ge,brand:O.brands||"",image:O.image_small_url||O.image_url||null,servingSize:O.serving_size||"100g",servingValue:Ye,servingUnit:oe,portion:qe,protein:Math.round(q.proteins_100g||q.proteins||0),carbs:Math.round(q.carbohydrates_100g||q.carbohydrates||0),fats:Math.round(q.fat_100g||q.fat||0),calories:Math.round(q["energy-kcal_100g"]||q["energy-kcal"]||(q.energy_100g?q.energy_100g/4.184:0)),per100g:!0}},js=async O=>{Wt(!0);try{const q=new AbortController,oe=setTimeout(()=>q.abort(),1e4),ne=`https://world.openfoodfacts.org/api/v2/product/${O}?fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,Ye=await fetch(ne,{signal:q.signal});if(clearTimeout(oe),Ye.status===404){Ct("Product not found. Try search or manual entry.","error"),Wt(!1);return}if(!Ye.ok)throw new Error(`HTTP ${Ye.status}`);const Ge=await Ye.json();if(Ge.status==="success"||Ge.status===1||Ge.product){const qe=Vr(Ge.product);qe.calories===0&&qe.protein===0&&qe.carbs===0?Ct("Product found but no nutrition data available.","error"):(pt(qe),qe.portion?(gt(1),it(String(qe.portion.weight)),zt("portion")):(gt(0),it(String(qe.servingValue||100)),zt("weight")),Xe(""))}else Ct("Product not found. Try search or manual entry.","error")}catch(q){console.error("Barcode lookup error:",q),q.name==="AbortError"?Ct("Lookup timed out. Check your connection and try again.","error"):Ct("Failed to look up product. Check your connection.","error")}Wt(!1)},hr=(O,q,oe)=>{const ne=O.toLowerCase().trim(),Ye=q.toLowerCase().trim(),Ge=oe.toLowerCase().trim();let qe=0;return(ne===Ge||ne===Ge+"s"||ne+"s"===Ge)&&(qe+=100),(ne.endsWith(" "+Ge)||ne.endsWith(" "+Ge+"s"))&&(qe+=40),(ne.startsWith(Ge+" ")||ne.startsWith(Ge+"s "))&&(qe+=15),Ge.split(/\s+/).some(Rt=>Ye===Rt||Ye.startsWith(Rt))&&(qe+=30),qe+=Math.max(0,30-ne.length),qe},Kn=async()=>{if(!It.trim())return;Pn.current&&Pn.current.abort();const O=new AbortController;Pn.current=O;const q=It.trim().toLowerCase(),oe=q.split(/\s+/).filter(Boolean);if(sp.has(q)){qt(sp.get(q));return}pn(!0);try{const Ye=`https://world.openfoodfacts.org/cgi/search.pl?search_terms=${encodeURIComponent(It.trim())}&search_simple=1&action=process&json=1&page_size=10&lc=en&sort_by=unique_scans_n&fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,Ge=await fetch(Ye,{signal:O.signal});if(!Ge.ok)throw new Error(`HTTP ${Ge.status}`);const ot=((await Ge.json()).products||[]).map(Rt=>Vr(Rt)).filter(Rt=>Rt.name!=="Unknown Product"&&(Rt.calories>0||Rt.protein>0)).filter(Rt=>{const Nn=(Rt.name+" "+Rt.brand).toLowerCase();return oe.every(Cs=>Nn.includes(Cs))}).sort((Rt,Nn)=>hr(Nn.name,Nn.brand,q)-hr(Rt.name,Rt.brand,q)).slice(0,10);sp.set(q,ot),qt(ot),ot.length===0&&Ct("No results found. Try a different search.","info")}catch(ne){if(ne.name==="AbortError")return;console.error("Search error:",ne),Ct("Search failed. Check your connection.","error")}pn(!1)};w.useEffect(()=>{if(un.current&&clearTimeout(un.current),!(!It.trim()||U!=="search"||le))return un.current=setTimeout(()=>{Kn()},700),()=>clearTimeout(un.current)},[It]);const os=l,ls={"ring-protein":os?"#2dd4bf":"#14b8a6","ring-carbs":os?"#fbbf24":"#f59e0b","ring-fats":os?"#a78bfa":"#8b5cf6","ring-cals":"var(--color-primary)"},Vn=80,wn=2*Math.PI*Vn,es=(O,q,oe,ne,Ye)=>{const Ge=ne>0?Math.min(100,Math.round(oe/ne*100)):0,qe=wn-Ge/100*wn,ot=ls[Ye]||"#14b8a6";return a.jsxs("div",{className:"nut-ring-wrap",children:[a.jsxs("svg",{className:"nut-ring-svg",viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"nut-arc-track",cx:"100",cy:"100",r:Vn}),a.jsx("circle",{className:"nut-arc-fill",cx:"100",cy:"100",r:Vn,style:{stroke:ot},strokeDasharray:wn,strokeDashoffset:qe})]}),a.jsxs("div",{className:"nut-ring-center",children:[a.jsx("span",{className:"nut-ring-value",style:{color:ot},children:Math.round(oe)}),a.jsxs("span",{className:"nut-ring-target",children:["/ ",ne,O==="Calories"?"":"g"]}),a.jsx("span",{className:"nut-ring-label",style:{color:ot},children:q})]}),a.jsxs("span",{className:"nut-ring-pct",style:{color:ot},children:[Ge,"%"]})]})};if(w.useEffect(()=>{if(!je)return;const O=setTimeout(()=>{const q=je;fn(),Ue(null),js(q)},1500);return()=>clearTimeout(O)},[je]),w.useEffect(()=>()=>{const O=Le.current;if(Ln.current&&O){try{O.stop(),O.offDetected()}catch{}Ln.current=!1}},[]),i||g==="loading")return a.jsxs("div",{className:"nut-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsx("div",{className:"nut-loading-inline",children:a.jsx("div",{className:"cb-loading-spinner"})})]});if(g==="setup")return a.jsxs("div",{className:"nut-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"nut-main",children:[a.jsxs("div",{className:"nut-setup-intro",children:[a.jsx("h2",{children:"Set Your Daily Targets"}),a.jsx("p",{children:"Calculate your personalised macros based on your body and goals."})]}),a.jsxs("div",{className:"nut-calc-form",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Gender"}),a.jsxs("div",{className:"nut-toggle-group",children:[a.jsx("button",{className:I.gender==="male"?"active":"",onClick:()=>{F(O=>({...O,gender:"male"})),B(null)},children:"Male"}),a.jsx("button",{className:I.gender==="female"?"active":"",onClick:()=>{F(O=>({...O,gender:"female"})),B(null)},children:"Female"})]})]}),a.jsxs("div",{className:"nut-form-row",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Age"}),a.jsx("input",{type:"number",value:I.age,onChange:O=>{F(q=>({...q,age:O.target.value})),B(null)},placeholder:"Years",min:"15",max:"100"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Weight"}),a.jsxs("div",{className:"nut-input-unit",children:[a.jsx("input",{type:"number",value:I.weight,onChange:O=>{F(q=>({...q,weight:O.target.value})),B(null)},placeholder:I.weightUnit,min:"30",max:"300"}),a.jsxs("div",{className:"nut-unit-toggle",children:[a.jsx("button",{className:I.weightUnit==="kg"?"active":"",onClick:()=>{F(O=>({...O,weightUnit:"kg"})),B(null)},children:"kg"}),a.jsx("button",{className:I.weightUnit==="lbs"?"active":"",onClick:()=>{F(O=>({...O,weightUnit:"lbs"})),B(null)},children:"lbs"})]})]})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Height"}),a.jsxs("div",{className:"nut-input-unit",children:[I.heightUnit==="cm"?a.jsx("input",{type:"number",value:I.height,onChange:O=>{F(q=>({...q,height:O.target.value})),B(null)},placeholder:"cm",min:"100",max:"250"}):a.jsxs("div",{className:"nut-height-imperial",children:[a.jsx("input",{type:"number",value:I.heightFeet,onChange:O=>{F(q=>({...q,heightFeet:O.target.value})),B(null)},placeholder:"ft",min:"4",max:"7"}),a.jsx("input",{type:"number",value:I.heightInches,onChange:O=>{F(q=>({...q,heightInches:O.target.value})),B(null)},placeholder:"in",min:"0",max:"11"})]}),a.jsxs("div",{className:"nut-unit-toggle",children:[a.jsx("button",{className:I.heightUnit==="cm"?"active":"",onClick:()=>{F(O=>({...O,heightUnit:"cm"})),B(null)},children:"cm"}),a.jsx("button",{className:I.heightUnit==="ft"?"active":"",onClick:()=>{F(O=>({...O,heightUnit:"ft"})),B(null)},children:"ft/in"})]})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Daily Activity (outside of training)"}),a.jsxs("select",{value:I.dailyActivity,onChange:O=>{F(q=>({...q,dailyActivity:O.target.value})),B(null)},children:[a.jsx("option",{value:"sedentary",children:"Sedentary  desk job, under 5k steps"}),a.jsx("option",{value:"light",children:"Lightly Active  office + walking, 5-8k steps"}),a.jsx("option",{value:"moderate",children:"Moderately Active  on feet often, 8-12k steps"}),a.jsx("option",{value:"active",children:"Very Active  physical job, 12k+ steps"})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Training Sessions per Week"}),a.jsxs("select",{value:I.trainingFrequency,onChange:O=>{F(q=>({...q,trainingFrequency:O.target.value})),B(null)},children:[a.jsx("option",{value:"low",children:"1-2 sessions"}),a.jsx("option",{value:"moderate",children:"3-4 sessions"}),a.jsx("option",{value:"high",children:"5-6 sessions"}),a.jsx("option",{value:"daily",children:"7+ sessions"})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Fitness Goal"}),a.jsxs("div",{className:"nut-goal-options",children:[a.jsxs("button",{className:I.goal==="lose"?"active":"",onClick:()=>{F(O=>({...O,goal:"lose"})),B(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"-"}),a.jsx("span",{children:"Lose Weight"})]}),a.jsxs("button",{className:I.goal==="maintain"?"active":"",onClick:()=>{F(O=>({...O,goal:"maintain"})),B(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"="}),a.jsx("span",{children:"Maintain"})]}),a.jsxs("button",{className:I.goal==="build"?"active":"",onClick:()=>{F(O=>({...O,goal:"build"})),B(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"+"}),a.jsx("span",{children:"Build Muscle"})]})]})]}),I.goal==="lose"&&a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Deficit Level"}),a.jsxs("div",{className:"nut-deficit-options",children:[a.jsxs("button",{className:I.deficitLevel==="light"?"active":"",onClick:()=>{F(O=>({...O,deficitLevel:"light"})),B(null)},children:[a.jsx("strong",{children:"Mild"}),a.jsx("span",{children:"15% below TDEE"})]}),a.jsxs("button",{className:I.deficitLevel==="moderate"?"active":"",onClick:()=>{F(O=>({...O,deficitLevel:"moderate"})),B(null)},children:[a.jsx("strong",{children:"Moderate"}),a.jsx("span",{children:"20% below TDEE"})]}),a.jsxs("button",{className:I.deficitLevel==="harsh"?"active":"",onClick:()=>{F(O=>({...O,deficitLevel:"harsh"})),B(null)},children:[a.jsx("strong",{children:"Aggressive"}),a.jsx("span",{children:"25% below TDEE"})]})]})]}),a.jsx("button",{className:"nut-calc-btn",onClick:Fe,disabled:!Nt(),children:"Calculate Macros"})]}),G&&a.jsxs("div",{className:"nut-calc-results",children:[a.jsx("h3",{children:"Your Daily Targets"}),a.jsxs("div",{className:"nut-calc-rings",children:[es("Protein","Protein",G.protein,G.protein,"ring-protein"),es("Carbs","Carbs",G.carbs,G.carbs,"ring-carbs"),es("Fats","Fats",G.fats,G.fats,"ring-fats"),es("Calories","Calories",G.calories,G.calories,"ring-cals")]}),a.jsxs("div",{className:"nut-calc-info",children:[a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"BMR (body at rest)"}),a.jsxs("span",{children:[G.bmr," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"+ Daily activity (NEAT)"}),a.jsxs("span",{children:[G.neat," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"+ Training sessions"}),a.jsxs("span",{children:["+",G.exerciseAdd," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",style:{fontWeight:600},children:[a.jsx("span",{children:"TDEE (total burn)"}),a.jsxs("span",{children:[G.tdee," cal"]})]})]}),a.jsx("button",{className:"nut-save-targets-btn",onClick:Oe,children:"Set as My Daily Targets"})]})]}),Zn&&a.jsx("div",{className:`toast-notification ${Zn.type}`,children:Zn.message})]});const kr=O=>{const q=new Date(O+"T12:00:00"),oe=q.getDay(),ne=new Date(q);ne.setDate(q.getDate()-(oe+6)%7);const Ye=[];for(let Ge=0;Ge<7;Ge++){const qe=new Date(ne);qe.setDate(ne.getDate()+Ge),Ye.push(qe.toISOString().split("T")[0])}return Ye},$s=["M","T","W","T","F","S","S"],Yn=(O,q="search")=>{He(O),q==="scan"?(ce("scan"),pt(null)):q==="manual"?(ce("manual"),dt({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""})):q==="favourites"?ce("favourites"):(ce("search"),qt([]),Cn(""))},jr=kr(Y),ts=new Date(Y+"T12:00:00"),Ur=`${Ie[ts.getMonth()]} ${ts.getFullYear()}`;return a.jsx(nl,{children:a.jsxs("div",{className:"nut-page",children:[a.jsxs("div",{className:"nut-dark-zone",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:()=>{y("setup"),B(null)},"aria-label":"Recalculate macros",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]})]})}),a.jsxs("div",{className:"nut-dark-content",children:[a.jsxs("div",{className:"nut-week-strip anim-fade-up",children:[a.jsxs("div",{className:"nut-week-header",children:[a.jsx("button",{className:"nut-week-arrow",onClick:()=>{const O=new Date(Y+"T12:00:00");O.setDate(O.getDate()-7);const q=O.toISOString().split("T")[0];ee(q)},"aria-label":"Previous week",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsx("button",{className:"nut-week-month-label",onClick:()=>{E(!L),V({year:ts.getFullYear(),month:ts.getMonth()})},children:Ur}),a.jsx("button",{className:"nut-week-arrow",onClick:()=>{const O=new Date(Y+"T12:00:00");O.setDate(O.getDate()+7);const q=O.toISOString().split("T")[0];q<=Qr()&&ee(q)},"aria-label":"Next week",disabled:jr[6]>=Qr(),children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-week-days",children:jr.map((O,q)=>{const oe=new Date(O+"T12:00:00").getDate(),ne=O===Y,Ye=O>Qr(),Ge=O===Qr();return a.jsxs("button",{className:`nut-week-day${ne?" selected":""}${Ge?" today":""}${Ye?" future":""}`,disabled:Ye,onClick:()=>ee(O),children:[a.jsx("span",{className:"nut-week-day-letter",children:$s[q]}),a.jsx("span",{className:"nut-week-day-num",children:oe})]},O)})})]}),L&&a.jsxs("div",{className:"nut-calendar",children:[a.jsxs("div",{className:"nut-cal-header",children:[a.jsx("button",{onClick:()=>V(O=>{let q=O.month-1,oe=O.year;return q<0&&(q=11,oe--),{year:oe,month:q}}),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsxs("span",{children:[Ie[A.month]," ",A.year]}),a.jsx("button",{onClick:()=>V(O=>{let q=O.month+1,oe=O.year;return q>11&&(q=0,oe++),{year:oe,month:q}}),disabled:A.year===new Date().getFullYear()&&A.month>=new Date().getMonth(),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-cal-days-header",children:De.map(O=>a.jsx("span",{children:O},O))}),a.jsxs("div",{className:"nut-cal-grid",children:[[...Array(te(A.year,A.month))].map((O,q)=>a.jsx("span",{},`e${q}`)),[...Array(N(A.year,A.month))].map((O,q)=>{const oe=q+1,ne=`${A.year}-${String(A.month+1).padStart(2,"0")}-${String(oe).padStart(2,"0")}`,Ye=ne>Qr(),Ge=ne===Y,qe=ne===Qr();return a.jsx("button",{className:`nut-cal-day${Ge?" selected":""}${qe?" today":""}${Ye?" future":""}`,disabled:Ye,onClick:()=>{ee(ne),E(!1)},children:oe},oe)})]})]}),a.jsxs("div",{className:"nut-rings-row anim-fade-up-d2",children:[es("Protein","Protein",ve.protein,p.protein,"ring-protein"),es("Carbs","Carbs",ve.carbs,p.carbs,"ring-carbs"),es("Fats","Fats",ve.fats,p.fats,"ring-fats"),es("Calories","kCal",ve.calories,p.calories,"ring-cals")]})]})]}),a.jsx("div",{className:"nut-light-zone anim-fade-up-d4",children:a.jsxs("div",{className:"nut-light-content",children:[Z&&a.jsx("div",{className:"nut-quick-row",children:a.jsxs("button",{className:"nut-copy-day-btn",onClick:()=>{P(!0),Me({year:new Date().getFullYear(),month:new Date().getMonth()})},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",width:"18",height:"18",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),a.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),a.jsx("span",{children:"Copy day"})]})}),a.jsx("div",{className:"nut-log-section",children:a.jsx("div",{className:"nut-meals-list",children:sx.map(O=>{const q=re.entries.filter(ne=>(ne.meal||"snacks")===O.key),oe=q.reduce((ne,Ye)=>({protein:ne.protein+(Ye.protein||0),carbs:ne.carbs+(Ye.carbs||0),fats:ne.fats+(Ye.fats||0),calories:ne.calories+(Ye.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});return a.jsxs("div",{className:"nut-meal-card",children:[a.jsxs("div",{className:"nut-meal-card-header",children:[a.jsx("span",{className:`nut-meal-card-icon nut-meal-icon-${O.key}`,children:n5[O.key]}),a.jsx("span",{className:"nut-meal-card-title",children:O.label}),q.length>0&&a.jsxs("span",{className:"nut-meal-card-cal",children:[oe.calories," cal"]}),Z&&a.jsx("button",{className:"nut-meal-add-btn",onClick:()=>Pe(ke===O.key?null:O.key),"aria-label":`Add to ${O.label}`,children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]}),q.length>0&&a.jsxs("div",{className:"nut-meal-bars",children:[a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-p",children:"P"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-protein",style:{width:`${Math.min(100,p.protein>0?oe.protein/p.protein*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[oe.protein,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-c",children:"C"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-carbs",style:{width:`${Math.min(100,p.carbs>0?oe.carbs/p.carbs*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[oe.carbs,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-f",children:"F"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-fats",style:{width:`${Math.min(100,p.fats>0?oe.fats/p.fats*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[oe.fats,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-cal",children:"K"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-cals",style:{width:`${Math.min(100,p.calories>0?oe.calories/p.calories*100:0)}%`}})}),a.jsx("span",{className:"nut-meal-bar-val",children:oe.calories})]})]}),q.length>0&&a.jsx("div",{className:"nut-log-list",children:q.map(ne=>a.jsxs("div",{className:"nut-log-item",children:[a.jsx("button",{className:`nut-fav-star log${dn(ne.name)?" active":""}`,onClick:()=>hn(ne),"aria-label":dn(ne.name)?"Remove from favourites":"Add to favourites",children:a.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:dn(ne.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("div",{className:"nut-log-item-info",children:[a.jsx("span",{className:"nut-log-item-name",children:ne.name}),ne.serving&&a.jsx("span",{className:"nut-log-item-serving",children:ne.serving})]}),a.jsxs("div",{className:"nut-log-item-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[ne.protein,"p"]}),a.jsxs("span",{className:"nut-macro-c",children:[ne.carbs,"c"]}),a.jsxs("span",{className:"nut-macro-f",children:[ne.fats,"f"]}),a.jsx("span",{className:"nut-macro-cal",children:ne.calories})]}),Z&&a.jsx("button",{className:"nut-log-delete",onClick:()=>ms(ne.id),"aria-label":"Remove",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},ne.id))}),q.length===0&&a.jsx("div",{className:"nut-meal-empty",children:a.jsx("p",{children:Z?"Tap + to add food":"No entries"})})]},O.key)})})})]})}),ke&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"nut-add-picker-backdrop",onClick:()=>Pe(null)}),a.jsxs("div",{className:"nut-add-picker",children:[a.jsx("div",{className:"nut-add-picker-handle"}),a.jsxs("h3",{className:"nut-add-picker-title",children:["Add to ",sx.find(O=>O.key===ke)?.label]}),a.jsxs("div",{className:"nut-add-picker-options",children:[a.jsxs("button",{onClick:()=>{const O=ke;Pe(null),Yn(O,"scan")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),a.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),a.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),a.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),a.jsx("span",{children:"Scan Barcode"})]}),a.jsxs("button",{onClick:()=>{const O=ke;Pe(null),Yn(O,"search")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("span",{children:"Search Food"})]}),a.jsxs("button",{onClick:()=>{const O=ke;Pe(null),Yn(O,"manual")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),a.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),a.jsx("span",{children:"Manual Entry"})]}),a.jsxs("button",{onClick:()=>{const O=ke;Pe(null),Yn(O,"favourites")},children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),a.jsx("span",{children:"Favourites"})]})]})]})]}),M&&a.jsx("div",{className:"nut-modal-overlay",onClick:()=>P(!1),children:a.jsxs("div",{className:"nut-copy-from-popup",onClick:O=>O.stopPropagation(),children:[a.jsxs("div",{className:"nut-copy-from-header",children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",width:"20",height:"20",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),a.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),a.jsx("span",{children:"Copy from..."}),a.jsx("button",{className:"nut-modal-close",onClick:()=>P(!1),children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),a.jsx("p",{className:"nut-copy-from-hint",children:"Pick a day to copy its food log into today"}),a.jsxs("div",{className:"nut-cal-header",children:[a.jsx("button",{onClick:()=>Me(O=>{let q=O.month-1,oe=O.year;return q<0&&(q=11,oe--),{year:oe,month:q}}),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsxs("span",{children:[Ie[C.month]," ",C.year]}),a.jsx("button",{onClick:()=>Me(O=>{let q=O.month+1,oe=O.year;return q>11&&(q=0,oe++),{year:oe,month:q}}),disabled:C.year===new Date().getFullYear()&&C.month>=new Date().getMonth(),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-cal-days-header",children:De.map(O=>a.jsx("span",{children:O},O))}),a.jsxs("div",{className:"nut-cal-grid",children:[[...Array(te(C.year,C.month))].map((O,q)=>a.jsx("span",{},`e${q}`)),[...Array(N(C.year,C.month))].map((O,q)=>{const oe=q+1,ne=`${C.year}-${String(C.month+1).padStart(2,"0")}-${String(oe).padStart(2,"0")}`,Ye=ne>Qr(),Ge=ne===Y,qe=ne===Qr(),ot=Ye||Ge;return a.jsx("button",{className:`nut-cal-day${Ge?" selected":""}${qe?" today":""}${Ye?" future":""}`,disabled:ot,onClick:()=>ue(ne),children:oe},oe)})]}),Qe&&a.jsxs("div",{className:"nut-copy-from-loading",children:[a.jsx("div",{className:"wk-loading-spinner"}),a.jsx("span",{children:"Copying..."})]})]})}),U&&a.jsx("div",{className:"nut-modal-overlay",onClick:()=>{fn(),Ue(null),ce(null),pt(null)},children:a.jsxs("div",{className:"nut-modal",onClick:O=>O.stopPropagation(),children:[a.jsxs("div",{className:"nut-modal-header",children:[a.jsx("h3",{children:U==="scan"?"Scan Barcode":U==="search"?"Search Food":U==="favourites"?"Favourites":"Manual Entry"}),a.jsx("button",{className:"nut-modal-close",onClick:()=>{fn(),Ue(null),ce(null),pt(null)},children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),U==="scan"&&!le&&a.jsxs("div",{className:"nut-scan-area",children:[a.jsxs("div",{className:"nut-scanner-wrapper",children:[a.jsx("div",{id:"barcode-reader",className:"nut-scanner-view"}),Ee&&!je&&a.jsx("div",{className:"nut-scan-line"}),je&&a.jsxs("div",{className:"nut-scan-detected-overlay",children:[a.jsx("svg",{className:"nut-scan-detected-tick",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),a.jsx("p",{className:"nut-scan-detected-label",children:"Barcode found!"}),a.jsx("p",{className:"nut-scan-detected-code",children:je})]})]}),!Ee&&a.jsxs("button",{className:"nut-scan-start-btn",onClick:Kt,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),a.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),a.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),a.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),"Open Camera"]}),Ee&&!je&&a.jsx("p",{className:"nut-scan-hint",children:"Align barcode within the frame"}),a.jsx("div",{className:"nut-barcode-divider",children:a.jsx("span",{children:"or enter barcode manually"})}),a.jsxs("div",{className:"nut-barcode-manual",children:[a.jsx("input",{type:"text",inputMode:"numeric",value:$e,onChange:O=>Xe(O.target.value),onKeyDown:O=>O.key==="Enter"&&$e.trim()&&js($e.trim()),placeholder:"Enter barcode number"}),a.jsx("button",{onClick:()=>$e.trim()&&js($e.trim()),disabled:!$e.trim()||Ze,children:Ze?"...":"Look Up"})]}),a.jsxs("p",{className:"nut-off-credit",children:["Food data powered by ",a.jsx("a",{href:"https://openfoodfacts.org",target:"_blank",rel:"noopener noreferrer",children:"Open Food Facts"})]})]}),U==="scan"&&le&&(()=>{const O=le.servingUnit||"g",q=le.portion,oe=_t==="portion"&&q?yt*q.weight:parseFloat(Ht)||0,ne=oe/100,Ye=O==="ml"?[100,200,250,500]:[50,100,150,200],Ge=_t==="portion"&&q?`${yt} ${q.label}${yt!==1?"s":""} (${Math.round(oe)}${O})`:`${Math.round(oe)}${O}`;return a.jsxs("div",{className:"nut-product-result",children:[le.image&&a.jsx("img",{src:le.image,alt:le.name||"Product",className:"nut-product-img",loading:"lazy"}),a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:le.name}),a.jsx("button",{className:`nut-fav-star confirm${dn(le.name)?" active":""}`,onClick:()=>hn({name:le.name,protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories,serving:le.servingSize,per100g:{protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories},servingUnit:le.servingUnit||"g",portion:le.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:dn(le.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),le.brand&&a.jsx("p",{className:"nut-product-brand",children:le.brand}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",O,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[le.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[le.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[le.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[le.calories," cal"]})]}),q&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:_t==="portion"?"active":"",onClick:()=>{zt("portion"),yt<1&&gt(1)},children:"Portions"}),a.jsxs("button",{className:_t==="weight"?"active":"",onClick:()=>{zt("weight"),it(String(Math.round(oe)||100))},children:["Custom (",O,")"]})]}),_t==="portion"&&q?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>gt(Math.max(1,yt-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:yt}),a.jsxs("span",{className:"nut-stepper-label",children:[q.label,yt!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(oe),O]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>gt(yt+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",O,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:Ht,onChange:qe=>it(qe.target.value),onFocus:qe=>qe.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Ye.map(qe=>a.jsxs("button",{className:`nut-quick-btn${Ht===String(qe)?" active":""}`,onClick:()=>it(String(qe)),children:[qe,O]},qe))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(le.protein*ne),"p / ",Math.round(le.carbs*ne),"c / ",Math.round(le.fats*ne),"f / ",Math.round(le.calories*ne)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>{pt(null),ce("scan")},children:"Scan Again"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>On({name:le.name,protein:Math.round(le.protein*ne),carbs:Math.round(le.carbs*ne),fats:Math.round(le.fats*ne),calories:Math.round(le.calories*ne),serving:Ge}),children:"Add"})]})]})})(),U==="search"&&!le&&a.jsxs("div",{className:"nut-search-area",children:[a.jsxs("div",{className:"nut-search-bar",children:[a.jsx("input",{type:"text",ref:Gt,value:It,onChange:O=>Cn(O.target.value),onKeyDown:O=>{O.key==="Enter"&&(clearTimeout(un.current),Kn())},onFocus:()=>setTimeout(()=>Gt.current?.scrollIntoView({behavior:"smooth",block:"center"}),350),placeholder:"Search food or product...",autoFocus:!0}),a.jsx("button",{onClick:Kn,disabled:Et,children:Et?"...":"Search"})]}),a.jsxs("div",{className:"nut-search-results",children:[ln.map((O,q)=>a.jsxs("button",{className:"nut-search-item",onClick:()=>{pt(O),O.portion?(gt(1),it(String(O.portion.weight)),zt("portion")):(gt(0),it(String(O.servingValue||100)),zt("weight"))},children:[O.image&&a.jsx("img",{src:O.image,alt:O.name||"Product",loading:"lazy"}),a.jsxs("div",{className:"nut-search-item-info",children:[a.jsx("span",{className:"nut-search-item-name",children:O.name}),O.brand&&a.jsx("span",{className:"nut-search-item-brand",children:O.brand}),a.jsxs("span",{className:"nut-search-item-macros",children:[O.calories," cal  ",O.protein,"p  ",O.carbs,"c  ",O.fats,"f per 100",O.servingUnit||"g"]})]})]},q)),ln.length===0&&It&&!Et&&a.jsx("p",{className:"nut-search-empty",children:"No results found. Try a different search or use manual entry."})]}),a.jsxs("p",{className:"nut-off-credit",children:["Food data powered by ",a.jsx("a",{href:"https://openfoodfacts.org",target:"_blank",rel:"noopener noreferrer",children:"Open Food Facts"})]})]}),U==="search"&&le&&(()=>{const O=le.servingUnit||"g",q=le.portion,oe=_t==="portion"&&q?yt*q.weight:parseFloat(Ht)||0,ne=oe/100,Ye=O==="ml"?[100,200,250,500]:[50,100,150,200],Ge=_t==="portion"&&q?`${yt} ${q.label}${yt!==1?"s":""} (${Math.round(oe)}${O})`:`${Math.round(oe)}${O}`;return a.jsxs("div",{className:"nut-product-result",children:[le.image&&a.jsx("img",{src:le.image,alt:le.name||"Product",className:"nut-product-img",loading:"lazy"}),a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:le.name}),a.jsx("button",{className:`nut-fav-star confirm${dn(le.name)?" active":""}`,onClick:()=>hn({name:le.name,protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories,serving:le.servingSize,per100g:{protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories},servingUnit:le.servingUnit||"g",portion:le.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:dn(le.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),le.brand&&a.jsx("p",{className:"nut-product-brand",children:le.brand}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",O,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[le.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[le.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[le.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[le.calories," cal"]})]}),q&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:_t==="portion"?"active":"",onClick:()=>{zt("portion"),yt<1&&gt(1)},children:"Portions"}),a.jsxs("button",{className:_t==="weight"?"active":"",onClick:()=>{zt("weight"),it(String(Math.round(oe)||100))},children:["Custom (",O,")"]})]}),_t==="portion"&&q?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>gt(Math.max(1,yt-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:yt}),a.jsxs("span",{className:"nut-stepper-label",children:[q.label,yt!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(oe),O]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>gt(yt+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",O,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:Ht,onChange:qe=>it(qe.target.value),onFocus:qe=>qe.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Ye.map(qe=>a.jsxs("button",{className:`nut-quick-btn${Ht===String(qe)?" active":""}`,onClick:()=>it(String(qe)),children:[qe,O]},qe))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(le.protein*ne),"p / ",Math.round(le.carbs*ne),"c / ",Math.round(le.fats*ne),"f / ",Math.round(le.calories*ne)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>pt(null),children:"Back to Search"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>On({name:le.name,protein:Math.round(le.protein*ne),carbs:Math.round(le.carbs*ne),fats:Math.round(le.fats*ne),calories:Math.round(le.calories*ne),serving:Ge}),children:"Add"})]})]})})(),U==="manual"&&a.jsxs("div",{className:"nut-manual-form",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Food Name"}),a.jsx("input",{type:"text",value:Tt.name,onChange:O=>dt(q=>({...q,name:O.target.value})),placeholder:"e.g. Chicken Breast",autoFocus:!0})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Serving Size (optional)"}),a.jsx("input",{type:"text",value:Tt.serving,onChange:O=>dt(q=>({...q,serving:O.target.value})),placeholder:"e.g. 150g, 1 cup"})]}),a.jsxs("div",{className:"nut-manual-macros",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Protein (g)"}),a.jsx("input",{type:"number",value:Tt.protein,onChange:O=>dt(q=>({...q,protein:O.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Carbs (g)"}),a.jsx("input",{type:"number",value:Tt.carbs,onChange:O=>dt(q=>({...q,carbs:O.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Fats (g)"}),a.jsx("input",{type:"number",value:Tt.fats,onChange:O=>dt(q=>({...q,fats:O.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Calories"}),a.jsx("input",{type:"number",value:Tt.calories,onChange:O=>dt(q=>({...q,calories:O.target.value})),min:"0"})]})]}),a.jsx("button",{className:"nut-btn-primary",disabled:!Tt.name.trim(),onClick:()=>On({name:Tt.name,protein:parseFloat(Tt.protein)||0,carbs:parseFloat(Tt.carbs)||0,fats:parseFloat(Tt.fats)||0,calories:parseFloat(Tt.calories)||0,serving:Tt.serving||""}),children:"Add Food"})]}),U==="favourites"&&!le&&(()=>{const O=lt(),q=oe=>{if(oe.per100g){const ne=oe.per100g;pt({name:oe.name,brand:"",image:null,servingSize:oe.serving||"100g",servingValue:100,servingUnit:oe.servingUnit||"g",portion:oe.portion||null,protein:ne.protein,carbs:ne.carbs,fats:ne.fats,calories:ne.calories,per100g:!0}),oe.portion?(gt(1),it(String(oe.portion.weight)),zt("portion")):(gt(0),it("100"),zt("weight"))}else On({name:oe.name,protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories,serving:oe.serving||""})};return a.jsx("div",{className:"nut-recent-area",children:O.length===0?a.jsx("p",{className:"nut-search-empty",children:"No favourites yet. Tap the star on any food to save it here."}):a.jsx("div",{className:"nut-recent-list",children:O.map((oe,ne)=>a.jsxs("div",{className:"nut-recent-item-row",children:[a.jsx("button",{className:"nut-fav-star active",onClick:Ye=>{Ye.stopPropagation(),hn(oe)},children:a.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("button",{className:"nut-recent-item",onClick:()=>q(oe),children:[a.jsxs("div",{className:"nut-recent-item-info",children:[a.jsx("span",{className:"nut-recent-item-name",children:oe.name}),a.jsx("span",{className:"nut-recent-item-serving",children:oe.serving||""})]}),a.jsxs("span",{className:"nut-recent-item-macros",children:[oe.calories," cal"]})]})]},ne))})})})(),U==="favourites"&&le&&(()=>{const O=le.servingUnit||"g",q=le.portion,oe=_t==="portion"&&q?yt*q.weight:parseFloat(Ht)||0,ne=oe/100,Ye=O==="ml"?[100,200,250,500]:[50,100,150,200],Ge=_t==="portion"&&q?`${yt} ${q.label}${yt!==1?"s":""} (${Math.round(oe)}${O})`:`${Math.round(oe)}${O}`;return a.jsxs("div",{className:"nut-product-result",children:[a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:le.name}),a.jsx("button",{className:`nut-fav-star confirm${dn(le.name)?" active":""}`,onClick:()=>hn({name:le.name,protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories,serving:le.servingSize,per100g:{protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories},servingUnit:le.servingUnit||"g",portion:le.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:dn(le.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",O,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[le.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[le.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[le.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[le.calories," cal"]})]}),q&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:_t==="portion"?"active":"",onClick:()=>{zt("portion"),yt<1&&gt(1)},children:"Portions"}),a.jsxs("button",{className:_t==="weight"?"active":"",onClick:()=>{zt("weight"),it(String(Math.round(oe)||100))},children:["Custom (",O,")"]})]}),_t==="portion"&&q?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>gt(Math.max(1,yt-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:yt}),a.jsxs("span",{className:"nut-stepper-label",children:[q.label,yt!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(oe),O]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>gt(yt+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",O,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:Ht,onChange:qe=>it(qe.target.value),onFocus:qe=>qe.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Ye.map(qe=>a.jsxs("button",{className:`nut-quick-btn${Ht===String(qe)?" active":""}`,onClick:()=>it(String(qe)),children:[qe,O]},qe))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(le.protein*ne),"p / ",Math.round(le.carbs*ne),"c / ",Math.round(le.fats*ne),"f / ",Math.round(le.calories*ne)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>pt(null),children:"Back to Favourites"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>On({name:le.name,protein:Math.round(le.protein*ne),carbs:Math.round(le.carbs*ne),fats:Math.round(le.fats*ne),calories:Math.round(le.calories*ne),serving:Ge}),children:"Add"})]})]})})()]})}),a.jsx(ni,{active:"nutrition"}),Zn&&a.jsx("div",{className:`toast-notification ${Zn.type}`,children:Zn.message}),a.jsx(Wl,{badge:_,onDismiss:()=>j(null)})]})})}async function i5(s){const{type:e="workout",title:t="Workout Complete!",stats:i=[],badges:l=[],badgeImage:c,badgeDesc:d}=s,g=1080,y=1920,p=document.createElement("canvas");p.width=g,p.height=y;const b=p.getContext("2d"),_="#2a2a28",j="#ffffff",I="#A12F3A",F="#1a1a1a",G="#555555";b.fillStyle=_,b.fillRect(0,0,g,y);const B=Math.round(g*.82),Y=Math.round(y*.75),ee=Math.round((g-B)/2),re=Math.round((y-Y)/2),pe=28,ve=5;b.save(),b.shadowColor="rgba(0, 0, 0, 0.45)",b.shadowBlur=40,b.shadowOffsetY=10,rx(b,ee,re,B,Y,pe),b.fillStyle=j,b.fill(),b.restore(),b.save(),rx(b,ee,re,B,Y,pe),b.strokeStyle=I,b.lineWidth=ve,b.stroke(),b.restore();const he=220,L=50,E=52,A=68,V=10,M=36,P=48,C=30,Me=34,Qe=46,J=30,Se=28;b.font=`bold ${E}px 'Orbitron', sans-serif`;const He=su(b,t.toUpperCase(),B-100);b.font=`500 ${M}px 'Montserrat', sans-serif`;let ke=[];e==="badge"&&d?ke=su(b,d,B-120):e==="badge"&&l.length>0?ke=su(b,l.join("    "),B-120):i.length>0&&(ke=su(b,i.map(Et=>`${Et.value} ${Et.label}`).join("    "),B-120));const Pe=e==="badge"?"I just earned a badge on Core Buddy ":e==="habits"?"I just completed my daily habits with Core Buddy ":"I just completed a workout using Core Buddy ";b.font=`bold ${Me}px 'Montserrat', sans-serif`;const U=su(b,Pe,B-80);let ce=He.length*A;ke.length>0&&(ce+=V+ke.length*P),ce+=C+U.length*Qe,ce+=J+Se;const Ce=re+Y-60-ce,Ue=re+40,$e=Ce-L,Xe=g/2,Ze=(Ue+$e)/2,Wt=e==="badge"&&c?c:"/Logo.webp";b.save();const It=e==="badge"?"rgba(255, 193, 7, 0.15)":"rgba(161, 47, 58, 0.12)",Cn=b.createRadialGradient(Xe,Ze,he*.6,Xe,Ze,he*1.5);Cn.addColorStop(0,It),Cn.addColorStop(1,"rgba(0, 0, 0, 0)"),b.fillStyle=Cn,b.fillRect(Xe-he*1.5,Ze-he*1.5,he*3,he*3),b.restore(),b.beginPath(),b.arc(Xe,Ze,he+6,0,Math.PI*2),b.fillStyle=j,b.fill();const ln=e==="badge"?"#ffc107":I;b.beginPath(),b.arc(Xe,Ze,he,0,Math.PI*2),b.strokeStyle=ln,b.lineWidth=5,b.stroke();try{const Et=await a5(Wt);b.save(),b.beginPath(),b.arc(Xe,Ze,he-6,0,Math.PI*2),b.clip();const pn=(he-6)*2;b.drawImage(Et,Xe-he+6,Ze-he+6,pn,pn),b.restore()}catch{b.textAlign="center",b.textBaseline="middle",b.fillStyle=I,b.font="bold 80px 'Orbitron', sans-serif",b.fillText(e==="badge"?"":"MCF",Xe,Ze)}let qt=Ce;b.textAlign="center",b.textBaseline="alphabetic",b.fillStyle=F,b.font=`bold ${E}px 'Orbitron', sans-serif`;for(const Et of He)b.fillText(Et,g/2,qt),qt+=A;if(ke.length>0){qt+=V,b.fillStyle=G,b.font=`500 ${M}px 'Montserrat', sans-serif`;for(const Et of ke)b.fillText(Et,g/2,qt),qt+=P}qt+=C,b.fillStyle=F,b.font=`bold ${Me}px 'Montserrat', sans-serif`;for(const Et of U)b.fillText(Et,g/2,qt),qt+=Qe;return qt+=J,b.fillStyle=I,b.font=`600 ${Se}px 'Montserrat', sans-serif`,b.fillText("Make It Count with Core Buddy",g/2,qt),new Promise(Et=>{p.toBlob(pn=>Et(pn),"image/png")})}function rx(s,e,t,i,l,c){s.beginPath(),s.moveTo(e+c,t),s.lineTo(e+i-c,t),s.quadraticCurveTo(e+i,t,e+i,t+c),s.lineTo(e+i,t+l-c),s.quadraticCurveTo(e+i,t+l,e+i-c,t+l),s.lineTo(e+c,t+l),s.quadraticCurveTo(e,t+l,e,t+l-c),s.lineTo(e,t+c),s.quadraticCurveTo(e,t,e+c,t),s.closePath()}function a5(s){return new Promise((e,t)=>{const i=new Image;i.crossOrigin="anonymous",i.onload=()=>e(i),i.onerror=t,i.src=s})}function su(s,e,t){if(s.measureText(e).width<=t)return[e];const i=e.split(" "),l=[];let c="";for(const d of i){const g=c?`${c} ${d}`:d;s.measureText(g).width>t&&c?(l.push(c),c=d):c=g}return c&&l.push(c),l}function o5(){const s=w.useRef(null),e=w.useCallback(()=>{if(!s.current)try{s.current=new(window.AudioContext||window.webkitAudioContext)}catch{}const c=s.current;return c?.state==="suspended"&&c.resume(),c},[]),t=w.useCallback(()=>{navigator.vibrate&&navigator.vibrate([40,60,30]);const c=e();if(!c)return;const d=c.currentTime,g=c.createBiquadFilter();g.type="lowpass",g.frequency.value=500,g.Q.value=.7,g.connect(c.destination);const y=c.createOscillator(),p=c.createGain();y.type="sine",y.frequency.value=50,p.gain.value=.3,p.gain.setTargetAtTime(0,d+.08,.04),y.connect(p).connect(g),y.start(d),y.stop(d+.2);const b=c.createOscillator(),_=c.createGain();b.type="sine",b.frequency.value=70,_.gain.value=.2,_.gain.setTargetAtTime(0,d+.22,.04),b.connect(_).connect(g),b.start(d+.15),b.stop(d+.35)},[e]),i=w.useCallback(()=>{navigator.vibrate&&navigator.vibrate(30);const c=e();if(!c)return;const d=c.currentTime,g=c.createBiquadFilter();g.type="lowpass",g.frequency.value=500,g.Q.value=.7,g.connect(c.destination);const y=c.createOscillator(),p=c.createGain();y.type="sine",y.frequency.value=55,p.gain.value=.35,p.gain.setTargetAtTime(0,d+.08,.04),y.connect(p).connect(g),y.start(d),y.stop(d+.2)},[e]),l=w.useCallback(()=>{navigator.vibrate&&navigator.vibrate([50,80,100]);const c=e();c&&[0,.12].forEach((d,g)=>{const y=c.createOscillator(),p=c.createGain();y.type="sine",y.frequency.value=g===0?523:784,p.gain.value=.12,p.gain.setTargetAtTime(0,c.currentTime+d+.15,.02),y.connect(p).connect(c.destination),y.start(c.currentTime+d),y.stop(c.currentTime+d+.2)})},[e]);return w.useEffect(()=>()=>{s.current?.close()},[]),{tap:i,tick:t,complete:l}}const l5=2e3,Yp=42,Ll=2*Math.PI*Yp,c5=1200,ix=["Another one in the bank!","Consistency beats everything.","You showed up  that's what counts.","Stronger every session."];function Qp({title:s,subtitle:e,stats:t,onDone:i,onDismissStart:l,onShareJourney:c,userName:d,buttonLabel:g="Done",holdLabel:y="Hold To Complete Session",shareType:p="workout",hideShare:b=!1}){const[_,j]=w.useState("hold"),[I,F]=w.useState(!1),[G,B]=w.useState(0),[Y,ee]=w.useState(!1),[re,pe]=w.useState(!1),[ve,he]=w.useState(null),L=o5(),E=w.useRef(null),A=w.useRef(null),V=w.useRef(null),M=w.useRef(null),P=w.useRef(!1),C=w.useRef(!1),Me=w.useRef(0),Qe=w.useRef(ix[Math.floor(Math.random()*ix.length)]),J=w.useRef([...Array(80)].map((je,Ue)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#ffffff","#000000"][Ue%3],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:Ue%3}))),Se=w.useCallback(()=>{if(P.current)return;P.current=!0,C.current=!1,Me.current=0,F(!0),B(0),M.current=performance.now(),L.tap(),E.current&&(E.current.style.strokeDashoffset=Ll);const je=Ue=>{const $e=Ue-M.current,Xe=Math.min($e/l5,1);if(E.current&&(E.current.style.strokeDashoffset=Ll-Xe*Ll),A.current){const Ze=8*(1-Xe),Wt=1-Xe,It=1+Xe*.15;A.current.style.filter=`blur(${Ze}px) grayscale(${Wt})`,A.current.style.transform=`scale(${It})`}B(Xe),$e-Me.current>=c5&&(Me.current=$e,L.tick()),Xe<1?V.current=requestAnimationFrame(je):(P.current=!1,C.current=!0,V.current=null,F(!1),B(1),L.complete(),j("celebrate"))};V.current=requestAnimationFrame(je)},[L]),He=w.useCallback(()=>{P.current&&(P.current=!1,V.current&&(cancelAnimationFrame(V.current),V.current=null),E.current&&(E.current.style.strokeDashoffset=Ll),A.current&&(A.current.style.filter="",A.current.style.transform=""),F(!1),B(0))},[]),ke=w.useCallback(()=>{ee(!0),l?.(),setTimeout(()=>{i?.()},300)},[i,l]),Pe=w.useCallback(()=>{const je=[s||"Workout Complete!"];return e&&je.push(e),t?.length&&je.push(t.map(Ue=>`${Ue.value} ${Ue.label}`).join(" | ")),je.push("#MindCoreFitness"),je.join(`
`)},[s,e,t]),U=w.useCallback(async()=>{if(!(re||!c))try{await c({type:p==="habits"?"habits_summary":"workout_summary",title:s||"Workout Complete!",subtitle:e,stats:t||[],quote:Qe.current}),pe(!0),he("Posted to Journey!"),setTimeout(()=>he(null),2500)}catch(je){console.error("Journey post failed:",je),he(je?.message||"Failed to post"),setTimeout(()=>he(null),3500)}},[re,c,s,e,t]),[ce,Ee]=w.useState(!1),Ce=w.useCallback(async()=>{Ee(!0);try{const je=await i5({type:p||"workout",title:s||"Workout Complete!",subtitle:e,stats:t||[],quote:Qe.current,userName:d}),Ue=Pe();if(navigator.share&&navigator.canShare?.({files:[new File([je],"workout.png",{type:"image/png"})]})){const $e=new File([je],"workout.png",{type:"image/png"});await navigator.share({title:"Mind Core Fitness",text:Ue,files:[$e]})}else navigator.share?await navigator.share({title:"Mind Core Fitness",text:Ue}):(await navigator.clipboard.writeText(Ue),he("Copied to clipboard!"),setTimeout(()=>he(null),2500))}catch{try{await navigator.clipboard.writeText(Pe()),he("Copied to clipboard!"),setTimeout(()=>he(null),2500)}catch{}}finally{Ee(!1)}},[s,e,t,d,Pe]);return _==="hold"?a.jsxs("div",{className:"wc-hold-page",children:[a.jsx("div",{className:"wc-hold-glow","aria-hidden":"true"}),a.jsx("p",{className:"wc-hold-label",children:y}),a.jsxs("div",{className:`wc-hold-ring-touch ${I?"wc-holding":""}`,onPointerDown:je=>{je.preventDefault(),Se()},onPointerUp:He,onPointerLeave:He,onPointerCancel:He,onClick:je=>{je.stopPropagation(),C.current&&(C.current=!1)},role:"button",tabIndex:0,"aria-label":"Press and hold to finish workout",onKeyDown:je=>{(je.key==="Enter"||je.key===" ")&&(je.preventDefault(),L.complete(),j("celebrate"))},children:[a.jsx("div",{className:"wc-hold-ring-glow","aria-hidden":"true"}),a.jsxs("svg",{className:"wc-hold-ring-svg",viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"wc-hold-ring-track",cx:"50",cy:"50",r:Yp}),a.jsx("circle",{className:"wc-hold-ring-fill",ref:E,cx:"50",cy:"50",r:Yp,style:{strokeDasharray:Ll,strokeDashoffset:Ll}})]}),a.jsx("img",{ref:A,src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-hold-logo",draggable:!1})]})]}):a.jsxs("div",{className:`wc-celeb-overlay ${Y?"wc-celeb-dismissing":""}`,children:[a.jsx("div",{className:"wc-celeb-confetti","aria-hidden":"true",children:J.current.map((je,Ue)=>a.jsx("span",{className:`wc-celeb-confetti-piece wc-confetti-shape-${je.shape}`,style:{"--x":`${je.x}%`,"--delay":`${je.delay}s`,"--color":je.color,"--drift":`${je.drift}px`,"--spin":`${je.spin}deg`,"--duration":`${je.duration}s`,width:`${je.width}px`,height:`${je.height}px`}},Ue))}),a.jsxs("div",{className:"wc-celeb-content",children:[a.jsx("div",{className:"wc-celeb-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-celeb-logo-img"})}),a.jsx("h2",{className:"wc-celeb-heading",children:s||"Congratulations!"}),e&&a.jsx("p",{className:"wc-celeb-subtext",children:e}),a.jsx("p",{className:"wc-celeb-quote",children:Qe.current}),t&&t.length>0&&a.jsx("div",{className:"wc-celeb-stats-row",children:t.map((je,Ue)=>a.jsxs("div",{className:"wc-celeb-stat",children:[a.jsx("span",{className:"wc-celeb-stat-val",children:je.value}),a.jsx("span",{className:"wc-celeb-stat-label",children:je.label})]},Ue))}),!b&&a.jsxs("div",{className:"wc-share-row",children:[c&&a.jsxs("button",{className:`wc-share-btn wc-share-journey ${re?"wc-share-done":""}`,onClick:U,disabled:re,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 20h9"}),a.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4Z"})]}),re?"Posted!":"Post to Journey"]}),a.jsxs("button",{className:"wc-share-btn wc-share-external",onClick:Ce,disabled:ce,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"18",cy:"5",r:"3"}),a.jsx("circle",{cx:"6",cy:"12",r:"3"}),a.jsx("circle",{cx:"18",cy:"19",r:"3"}),a.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),a.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),ce?"Generating...":"Share"]})]}),a.jsx("button",{className:"wc-celeb-btn",onClick:ke,children:g}),ve&&a.jsx("div",{className:"wc-share-toast",children:ve})]})]})}const ax="/login/assets/randomiser-glq9YJkL.jpg",ox="/login/assets/programme-card-workout-CnNzTYkz.webp",u5="/login/assets/prog-fullbody-4wk-r6m9HJys.jpg",d5="/login/assets/muscle-group-arms-C9AdZL4-.png",h5="/login/assets/arms-bicep-BUrmT1o-.png",f5="/login/assets/arms-tricep-D9tAnFnS.png",m5="/login/assets/arms-full-arms-BY3TvpJm.png",g5="/login/assets/muscle-group-chest-Cxfuc7XI.png",p5="/login/assets/chest-strength-BR4BAFTH.png",y5="/login/assets/chest-hypertrophy-B8yNrvjB.png",v5="/login/assets/chest-endurance-e-OSWtWO.png",b5="/login/assets/muscle-group-shoulders-DibNtCLF.png",w5="/login/assets/shoulders-strength-CKlZBF5A.png",x5="/login/assets/shoulders-hypertrophy-BUd76jiS.png",_5="/login/assets/shoulders-endurance-HuqNG5rD.png",k5="/login/assets/muscle-group-core-CPR-bdRg.png",j5="/login/assets/core-lower-abs-TVcqGMFJ.png",E5="/login/assets/core-obliques-rotation-Djb7Qlbk.png",T5="/login/assets/core-weighted-core-4Kwh9mTv.png",S5="/login/assets/muscle-group-back-8JPV-YUo.png",C5="/login/assets/back-strength-BmSRxnwo.png",N5="/login/assets/back-hypertrophy-CXHmsnCz.png",A5="/login/assets/back-endurance-C8qJ8l5I.png",R5="/login/assets/muscle-group-legs-B8jcbdov.png",I5="/login/assets/legs-quads-DbnfsebI.png",M5="/login/assets/legs-hamstrings-glutes-BrfsvvzX.png",D5="/login/assets/legs-power-plyo-D2qBXeUR.png",L5=60,rp=5,P5={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},O5={fullbody:"linear-gradient(160deg, rgba(153,49,60,0.15) 0%, rgba(153,49,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",upper:"linear-gradient(160deg, rgba(100,60,140,0.2) 0%, rgba(100,60,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",lower:"linear-gradient(160deg, rgba(40,120,80,0.2) 0%, rgba(40,120,80,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)"},ip={arms:"linear-gradient(160deg, rgba(180,60,60,0.2) 0%, rgba(180,60,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",chest:"linear-gradient(160deg, rgba(50,100,160,0.2) 0%, rgba(50,100,160,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",back:"linear-gradient(160deg, rgba(80,130,60,0.2) 0%, rgba(80,130,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",shoulders:"linear-gradient(160deg, rgba(160,100,40,0.2) 0%, rgba(160,100,40,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",legs:"linear-gradient(160deg, rgba(100,50,140,0.2) 0%, rgba(100,50,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)"},ap=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,level:"All Levels",daysPerWeek:3,image:u5},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,level:"Intermediate",daysPerWeek:3},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,level:"Advanced",daysPerWeek:3},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,level:"Beginner",daysPerWeek:3},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,level:"Intermediate",daysPerWeek:3},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,level:"Advanced",daysPerWeek:3},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,level:"Intermediate",daysPerWeek:3},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,level:"Intermediate",daysPerWeek:3}],ru=[{key:"arms",label:"Arms",icon:"M7 5h2v14H7V5zm8 0h2v14h-2V5zm-5 4h4v6h-4V9z",image:d5},{key:"chest",label:"Chest",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15H9v-2h2v2zm4 0h-2v-2h2v2zm3-6c0 1.1-.36 2.12-.97 2.95l-.87-.87C16.7 12.53 17 11.8 17 11c0-2.76-2.24-5-5-5S7 8.24 7 11c0 .8.3 1.53.84 2.08l-.87.87A4.977 4.977 0 0 1 6 11c0-3.31 2.69-6 6-6s6 2.69 6 6z",image:g5},{key:"back",label:"Back",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm4 18H8v-6l-4-4 1.41-1.41L8 11.17V8h8v3.17l2.59-2.58L20 10l-4 4v6z",image:S5},{key:"shoulders",label:"Shoulders",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z",image:b5},{key:"legs",label:"Legs",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z",image:R5},{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z",image:k5}],lx={chest:[{id:"chest_strength",name:"Chest Strength",desc:"Heavy pressing for max strength",image:p5,level:"Intermediate",overview:"A heavy pressing session designed to build raw chest strength. Focus on controlled negatives and powerful pressing movements.",tips:["Go heavy  pick a weight where the last 2 reps are a real challenge","Control the negative (lowering phase) for 2-3 seconds","Keep your shoulder blades squeezed together throughout all pressing movements","Rest 90-120 seconds between sets to allow full recovery"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Squeeze Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"chest_hypertrophy",name:"Chest Hypertrophy",desc:"Volume training for muscle growth",image:y5,level:"Intermediate",overview:"A high-volume chest session focused on time under tension and muscle growth. Lighter weights, more reps, and slow controlled movements.",tips:["Use moderate weight  you should feel the burn by rep 10","Squeeze your chest at the top of every rep for 1 second","Keep rest periods short at 60-90 seconds to keep the pump going","On press ups, go to failure on the final set"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Press Up",type:"reps",sets:3,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"}]},{id:"chest_endurance",name:"Chest Endurance",desc:"Bodyweight pushing to failure",image:v5,level:"All Levels",overview:"No weights needed. This bodyweight-only session builds chest endurance and muscular stamina through high-rep push up variations.",tips:["Focus on full range of motion  chest to floor on every rep","Keep your core tight and body in a straight line throughout","Scale down to knee press ups if you can't maintain form","Push through the burn  the last 5 reps are where the growth happens"],exercises:[{name:"Press Up",type:"reps",sets:4,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null},{name:"Decline Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Press Up Hold",type:"timed",sets:3,time:30,storagePath:null}]}],back:[{id:"back_strength",name:"Back Strength",desc:"Heavy rows for a thick back",image:C5,level:"Intermediate",overview:"Build a thick, powerful back with heavy rowing movements. This session targets your lats, rhomboids, and traps for overall back development.",tips:["Go heavy on rows  use a weight that challenges you by rep 6-8","Drive your elbows back and squeeze your shoulder blades together at the top","Keep a slight bend in your knees and hinge at the hips for bent over movements","Rest 90-120 seconds between sets for full recovery"],exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"back_hypertrophy",name:"Back Hypertrophy",desc:"Width and thickness volume work",image:N5,level:"Intermediate",overview:"A volume-focused back session combining rows and isolation moves to build width and thickness. Focus on the mind-muscle connection.",tips:["Use moderate weight  feel the stretch and squeeze on every rep","On renegade rows, keep your hips square to the floor and avoid rotating","For reverse flys, use lighter weight and focus on squeezing your rear delts","Keep rest to 60-90 seconds to maintain intensity"],exercises:[{name:"Renegade Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Reverse Fly",type:"weighted",sets:3,reps:15,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null}]},{id:"back_endurance",name:"Back Endurance",desc:"Bodyweight back conditioning",image:A5,level:"All Levels",overview:"A bodyweight session to strengthen your posterior chain and improve posture. Great for back health, mobility, and muscular endurance.",tips:["On superman holds, lift your arms and legs simultaneously and hold tight","Focus on slow, controlled movements  quality over speed","Breathe steadily throughout timed holds  don't hold your breath","Engage your glutes and lower back together on every movement"],exercises:[{name:"Superman Hold",type:"timed",sets:4,time:30,storagePath:"exercises/bodyweight/upper/Superman Hold.mp4"},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:12,storagePath:null},{name:"Reverse Snow Angel",type:"reps",sets:3,reps:12,storagePath:null},{name:"Bird Dog",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Back Extension Hold",type:"timed",sets:3,time:30,storagePath:null}]}],shoulders:[{id:"shoulders_strength",name:"Shoulder Strength",desc:"Heavy pressing for boulder shoulders",image:w5,level:"Intermediate",overview:"A heavy overhead pressing session to build strong, powerful shoulders. Compound movements first, followed by isolation work for all three delt heads.",tips:["Go heavy on presses  pick a weight where you struggle on the last 2 reps","Brace your core and avoid arching your back during overhead movements","Press straight up and control the weight down slowly","Rest 90-120 seconds between pressing sets, 60 seconds for isolation moves"],exercises:[{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"shoulders_hypertrophy",name:"Shoulder Hypertrophy",desc:"Volume and isolation for 3D delts",image:x5,level:"Intermediate",overview:"A high-volume session targeting all three heads of the deltoid for that 3D capped shoulder look. Moderate weight, high reps, constant tension.",tips:["Use lighter weight than you think  shoulders respond best to high reps","On lateral raises, lead with your elbows and don't swing the weight","Pause at the top of each raise for a 1-second squeeze","Keep rest periods at 60 seconds to maximise the pump"],exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Y-Raise",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"shoulders_endurance",name:"Shoulder Endurance",desc:"Bodyweight and high-rep work",image:_5,level:"All Levels",overview:"A shoulder endurance session combining bodyweight movements with high-rep dumbbell work. Builds stamina, stability, and shoulder resilience.",tips:["On pike push ups, walk your feet close to your hands to increase the angle","For high-rep lateral raises, use a very light weight and focus on form","Wall walks are advanced  scale to pike push ups if needed","Keep your core braced throughout to protect your lower back"],exercises:[{name:"Pike Push Ups",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/upper/pike push ups.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,reps:20,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Wall Walks",type:"reps",sets:3,reps:6,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null},{name:"Shoulder Tap Hold",type:"timed",sets:3,time:30,storagePath:null}]}],arms:[{id:"arms_bicep",name:"Bicep Focus",desc:"Curl variations for peak biceps",image:h5,level:"All Levels",overview:"An arm session dedicated entirely to biceps. Multiple curl variations target different parts of the bicep for maximum peak and thickness.",tips:["Keep your elbows pinned to your sides  no swinging","Control the negative (lowering) for 2-3 seconds on every rep","Start with your heaviest weight and decrease as you fatigue","Squeeze hard at the top of each curl for a full contraction"],exercises:[{name:"Bicep Curl",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Concentration Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Isometric Bicep Hold",type:"timed",sets:3,time:20,storagePath:null}]},{id:"arms_tricep",name:"Tricep Focus",desc:"Extensions and dips for horseshoe triceps",image:f5,level:"All Levels",overview:"All-out tricep training with extensions, dips, and pressing movements. The triceps make up two-thirds of your arm  this session builds serious size.",tips:["On overhead extensions, keep your elbows close to your head","For skullcrushers, lower the weight slowly to just above your forehead","On dips, lean slightly forward to reduce shoulder strain","Full lockout at the top of every extension for maximum tricep contraction"],exercises:[{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Tricep Dips",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null}]},{id:"arms_full",name:"Full Arms",desc:"Superset biceps and triceps",image:m5,level:"All Levels",overview:"A balanced arm session alternating between biceps and triceps. Superset style keeps the intensity high and maximises the pump.",tips:["Superset each pair  do biceps then immediately hit triceps","Use moderate weight that lets you maintain strict form for all reps","Rest 60 seconds after each superset pair","Focus on the squeeze at the peak contraction of every rep"],exercises:[{name:"Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Wrist Curl",type:"weighted",sets:3,reps:15,storagePath:null}]}],legs:[{id:"legs_quad",name:"Quad Dominant",desc:"Squats and lunges for quad power",image:I5,level:"All Levels",overview:"A quad-focused leg session built around squats and lunges. Heavy compound movements to build strong, powerful quads and overall leg strength.",tips:["On goblet squats, hold the dumbbell close to your chest and sit deep","Keep your knees tracking over your toes  don't let them cave inward","Drive through your heels on all squatting movements","Rest 90-120 seconds between heavy sets, 60 seconds on bodyweight moves"],exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/lower/bulgarian split squats.mp4"},{name:"Squat And Hold",type:"timed",sets:3,time:30,storagePath:"exercises/bodyweight/lower/squat and hold.mp4"}]},{id:"legs_ham_glute",name:"Hamstring & Glute",desc:"Posterior chain focus",image:M5,level:"Intermediate",overview:"Target the back of your legs with deadlift and hip hinge variations. This session builds a strong posterior chain  hamstrings, glutes, and lower back.",tips:["On RDLs, push your hips back and feel the stretch in your hamstrings","Keep a slight bend in your knees throughout hip hinge movements","Squeeze your glutes hard at the top of every rep","For single leg work, start with your weaker side first"],exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/romanian deadlifts.mp4"},{name:"1 Legged RDL",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.mp4"},{name:"Hip Thrusts",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/hip thrusts.mp4"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.mp4"},{name:"Donkey Kicks",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.mp4"}]},{id:"legs_power",name:"Power & Plyo",desc:"Explosive leg training",image:D5,level:"Intermediate",overview:"An explosive leg session combining plyometrics with weighted movements. Build power, speed, and athletic performance.",tips:["On jump squats, land softly with bent knees to absorb the impact","Explode up on every rep  power comes from speed, not just weight","Keep rest periods at 60-90 seconds to maintain intensity","Focus on landing mechanics  knees out, chest up, soft landing"],exercises:[{name:"Jump Squats",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/lower/jump squats.mp4"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Skater Jumps",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/skater jumps.mp4"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.mp4"}]}],core:[{id:"core_lower_abs",name:"Lower Abs Blast",desc:"40s work / 20s rest  3 rounds",image:j5,level:"Intermediate",overview:"An interval-based core burner targeting the lower abdominals. 40 seconds of work followed by 20 seconds of rest  keep the intensity high and your lower back pressed into the floor throughout.",tips:["Press your lower back firmly into the floor on every rep","Exhale hard as you contract your abs  don't hold your breath","If your lower back lifts off the ground, reduce the range of motion","Focus on slow, controlled movements rather than speed"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Leg Raises",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Reverse Crunch To Leg Raise",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Flutter Kicks",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Dead Bug Single Leg Drop",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Hollow Hold Flutter Kicks",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"}]},{id:"core_obliques",name:"Obliques & Rotation",desc:"35s work / 25s rest  3 rounds",image:E5,level:"Intermediate",overview:"Target the obliques and rotational core muscles with this interval session. 35 seconds of work with 25 seconds rest  every exercise involves twisting, rotating, or side-bracing movements.",tips:["Rotate from your ribcage, not just your arms","Keep your hips as still as possible during twisting exercises","Brace your core before each movement  think about squeezing a belt","On side planks, stack your hips and push the floor away"],interval:!0,rounds:3,work:35,rest:25,exercises:[{name:"Russian Twist",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank Rotation",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Cross Body Mountain Climbers",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Hip Dips Plank",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Bicycle Crunch",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank",storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{id:"core_weighted",name:"Weighted Core",desc:"40s work / 20s rest  3 rounds",image:T5,level:"Advanced",overview:"Add resistance to your core training with dumbbells and kettlebells. 40 seconds of weighted work followed by 20 seconds rest  this session builds serious core strength and stability.",tips:["Start with a moderate weight  form is more important than load","Brace your entire core before picking up the weight each round","Keep movements controlled  no swinging or using momentum","If grip fails before core does, go slightly lighter next time"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Russian Twists Dumbbell",storagePath:"exercises/dumbbells/core/russian twists dumbbell.mp4"},{name:"Kettlebell Russian Twist",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Dumbbell Plank Pull Through",storagePath:null}]}]},op=[{key:"bodyweight",label:"Bodyweight",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"},{key:"dumbbells",label:"Dumbbells",icon:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"},{key:"kettlebells",label:"Kettlebells",icon:"M12 2C9.24 2 7 4.24 7 7c0 1.1.36 2.12.97 2.95C6.76 11.08 6 12.96 6 15c0 3.87 2.69 7 6 7s6-3.13 6-7c0-2.04-.76-3.92-1.97-5.05.61-.83.97-1.85.97-2.95 0-2.76-2.24-5-5-5zm0 2c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"}],Xr=[{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"},{key:"upper",label:"Upper",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"lower",label:"Lower",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"fullbody",label:"Full Body",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z"},{key:"mix",label:"Mix It Up",icon:"M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm-.83 9.41l-1.42 1.42L17.96 20.54l1.42-1.42-5.71-5.71z"}],Ai=[{key:"beginner",label:"Beginner",work:30,rest:30,desc:"30s work / 30s rest"},{key:"intermediate",label:"Intermediate",work:40,rest:20,desc:"40s work / 20s rest"},{key:"advanced",label:"Advanced",work:40,rest:15,desc:"40s work / 15s rest"}],lp=[5,10,15,20,30],V5=new Set(["single leg v-up","hollow hold to v-sit","reverse crunch to leg raise","side plank rotation","hip dips plank","alternating cross body v-up","alternating cross body v up","bent hollow hold","heels elevated glute bridge","hollow body hold","hollow body rock","star side plank","straddle leg lift","leg raise to hip lift","scorpion kicks","seated v hold"]),bh={core:"#e85d04",upper:"#2196f3",lower:"#4caf50",fullbody:"#9c27b0",mix:"#ff9800"},cx=["Mix up your focus areas to build balanced strength.","Consistency beats intensity  show up and press play.","Try a new difficulty level to keep your body guessing.","Short on time? A 5-minute blast still counts.","Save your favourite combos so you can replay them anytime.","Your body adapts  switch equipment for fresh stimulus.","Rest days are growth days. Listen to your body.","Challenge yourself: go one level higher this week."];function U5(s){return s.replace(/\b\w/g,e=>e.toUpperCase())}function B5(s){const e=[...s];for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return e}function z5({src:s,...e}){const t=w.useRef(null),[i,l]=w.useState(!1);return w.useEffect(()=>{const c=t.current;if(!c)return;const d=new IntersectionObserver(([g])=>{g.isIntersecting&&(l(!0),d.disconnect())},{rootMargin:"200px"});return d.observe(c),()=>d.disconnect()},[]),a.jsx("video",{ref:t,src:i?s:void 0,...e})}function F5(){const{currentUser:s,isClient:e,clientData:t,loading:i}=_r(),{isDark:l,toggleTheme:c}=Bi(),{isPremium:d,FREE_RANDOMISER_DURATIONS:g,FREE_RANDOMISER_WEEKLY_LIMIT:y}=hc(),p=qs(),[b,_]=w.useState("randomiser_hub"),[j,I]=w.useState(["bodyweight"]),[F,G]=w.useState("core"),[B,Y]=w.useState("intermediate"),[ee,re]=w.useState(d?15:5),[pe,ve]=w.useState([]),[he,L]=w.useState(!1),E=w.useRef(!1),A=w.useRef([]),V=w.useRef(""),[M,P]=w.useState([]),[C,Me]=w.useState(2),[Qe,J]=w.useState(Ai[1]),[Se,He]=w.useState(1),[ke,Pe]=w.useState(0),[U,ce]=w.useState("work"),[Ee,Ce]=w.useState(0),[je,Ue]=w.useState(!1),[$e,Xe]=w.useState(0),[Ze,Wt]=w.useState(!1),[It,Cn]=w.useState(!1),[ln,qt]=w.useState(null),Et=w.useRef(null);w.useRef(null),w.useRef(null);const[pn,Tt]=w.useState(null),dt=w.useCallback((D,H="info")=>{Tt({message:D,type:H}),setTimeout(()=>Tt(null),3e3)},[]),le=w.useCallback(async D=>{if(!t)throw new Error("Not signed in");const H=D&&typeof D=="object"&&D.type;await or(ut(ye,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:H?"":D,type:H?D.type:"text",imageURL:null,createdAt:xs(),likeCount:0,commentCount:0,...H?{metadata:{title:D.title||"",subtitle:D.subtitle||"",stats:D.stats||[],quote:D.quote||"",badges:D.badges||[]}}:{}})},[t]),[pt,Ht]=w.useState(null),[it,yt]=w.useState(null),[gt,_t]=w.useState(0),[zt,fs]=w.useState(0),[rn,Zn]=w.useState([]),[Fn,Ln]=w.useState(""),[Pn,un]=w.useState(""),[Gt,Ct]=w.useState(!1),[Mt,Z]=w.useState(0),[N,te]=w.useState(!1),[Re,Ie]=w.useState({}),De=w.useRef(null),Fe=w.useRef(null),[Oe,Nt]=w.useState(0),[bt,lt]=w.useState(0),[dn,hn]=w.useState(0),[On,ms]=w.useState(0),[ue,Le]=w.useState(0),[Ke,ct]=w.useState(0),[rt,Kt]=w.useState(null),[fn,At]=w.useState({beginner:0,intermediate:0,advanced:0}),St=d?lp:lp.filter(D=>g.includes(D)),bn=!d&&Oe>=y,[Ss,si]=w.useState([]),[xi,Vr]=w.useState(!1),[js,hr]=w.useState({}),[Kn,os]=w.useState(!1),[ls,Vn]=w.useState(!1),[wn,es]=w.useState(""),[kr,$s]=w.useState(null),[Yn,jr]=w.useState([]),[ts,Ur]=w.useState({total:0,favouriteFocus:null,streak:0}),[O,q]=w.useState(null),[oe,ne]=w.useState(""),[Ye,Ge]=w.useState(!1);w.useEffect(()=>{!i&&(!s||!e)&&p("/")},[s,e,i,p]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const H=ut(ye,"workoutLogs"),$=tn(H,Ot("clientId","==",t.id)),me=(await $t($)).docs.map(mt=>mt.data()),be=me.filter(mt=>mt.type!=="programme");ms(be.length);const Ve=be.reduce((mt,gn)=>mt+(gn.duration||0),0);Le(Ve);const nt={beginner:0,intermediate:0,advanced:0};be.forEach(mt=>{mt.level&&nt[mt.level]!==void 0&&nt[mt.level]++}),At(nt);const st=new Date,vt=st.getDay(),kt=vt===0?-6:1-vt,Xt=new Date(st);Xt.setDate(st.getDate()+kt),Xt.setHours(0,0,0,0);const Hn=Xt.getTime(),tt=me.filter(mt=>{const gn=mt.completedAt;return gn?(gn.toDate?gn.toDate().getTime():new Date(gn).getTime())>=Hn:!1});Nt(tt.filter(mt=>mt.type!=="programme").length);let mn=0;if(t)try{const mt=await _s(ze(ye,"clientProgrammes",t.id));if(mt.exists()){const gn=mt.data(),Xn=gn.templateId;mn=tt.filter(As=>As.type==="programme"&&As.programmeId===Xn).length,q(Xn);const tr=ap.find(As=>As.id===Xn);tr&&ne(tr.name);const Ks=P5[Xn];if(Ks){const As=Object.keys(gn.completedSessions||{}).length,nr=Ks.duration*Ks.daysPerWeek;hn(nr>0?Math.round(As/nr*100):0)}}else q(null),ne(""),hn(0)}catch{}lt(mn);const an=be.map(mt=>mt.completedAt).filter(Boolean).map(mt=>mt.toDate?mt.toDate().getTime():new Date(mt).getTime()).sort((mt,gn)=>gn-mt);if(an.length===0)ct(0);else{const mt=new Set;an.forEach(nr=>{const Sr=new Date(nr),yo=Sr.getDay(),sl=yo===0?-6:1-yo,ai=new Date(Sr);ai.setDate(Sr.getDate()+sl),ai.setHours(0,0,0,0),mt.add(ai.getTime())});const gn=[...mt].sort((nr,Sr)=>Sr-nr);let Xn=0;const tr=new Date(st),Ks=st.getDay()===0?-6:1-st.getDay();tr.setDate(st.getDate()+Ks),tr.setHours(0,0,0,0);let As=tr.getTime();gn.includes(As)||(As-=10080*60*1e3);for(let nr=0;nr<200&&gn.includes(As);nr++)Xn++,As-=10080*60*1e3;ct(Xn)}}catch(H){console.error("Error loading workout stats:",H)}finally{Ge(!0)}})()},[s,t,b]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const H=tn(ut(ye,"savedWorkouts"),Ot("clientId","==",t.id)),K=(await $t(H)).docs.map(me=>({id:me.id,...me.data()}));K.sort((me,be)=>{const Ve=me.savedAt?.toMillis?.()||me.savedAt?.seconds*1e3||0;return(be.savedAt?.toMillis?.()||be.savedAt?.seconds*1e3||0)-Ve}),si(K)}catch(H){console.error("Error loading saved workouts:",H)}finally{Vr(!0)}})()},[s,t]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const H=tn(ut(ye,"workoutLogs"),Ot("clientId","==",t.id)),me=(await $t(H)).docs.map(tt=>tt.data()).sort((tt,mn)=>{const an=tt.completedAt?.toDate?.()||new Date(0);return(mn.completedAt?.toDate?.()||new Date(0))-an}).slice(0,20).filter(tt=>tt.type!=="programme"&&tt.type!=="muscle_group");jr(me.slice(0,3));const be=me.length,Ve={};me.forEach(tt=>{tt.focus&&(Ve[tt.focus]=(Ve[tt.focus]||0)+1)});const nt=Object.keys(Ve).sort((tt,mn)=>Ve[mn]-Ve[tt])[0]||null;let st=0;if(me.length>0){const tt=new Set;me.forEach(mt=>{const gn=mt.completedAt?.toDate?mt.completedAt.toDate():mt.completedAt?new Date(mt.completedAt):null;gn&&tt.add(new Date(gn.getFullYear(),gn.getMonth(),gn.getDate()).toDateString())});const mn=new Date;mn.setHours(0,0,0,0);let an=new Date(mn);for(tt.has(an.toDateString())||an.setDate(an.getDate()-1);tt.has(an.toDateString());)st++,an.setDate(an.getDate()-1)}Ur({total:be,favouriteFocus:nt,streak:st});const vt={core:null,upper:null,lower:null,fullbody:null};me.forEach(tt=>{if(tt.focus&&vt[tt.focus]===null&&tt.completedAt){const mn=tt.completedAt.toDate?tt.completedAt.toDate():new Date(tt.completedAt);vt[tt.focus]=mn}});let kt=null,Xt=new Date;const Hn=["core","upper","lower","fullbody"];for(const tt of Hn){if(vt[tt]===null){const mn=Xr.find(an=>an.key===tt)?.label||tt;kt={focus:tt,label:mn,daysAgo:null,message:`You haven't tried ${mn} yet`};break}if(vt[tt]<Xt){Xt=vt[tt];const mn=Math.floor((Date.now()-vt[tt].getTime())/864e5);if(mn>=5){const an=Xr.find(mt=>mt.key===tt)?.label||tt;kt={focus:tt,label:an,daysAgo:mn,message:`${an}  ${mn} days ago`}}}}$s(kt)}catch(H){console.error("Error loading recent workouts:",H)}})()},[s,t,b]);const qe=async D=>{if(!(!s||!t||M.length===0)){os(!0);try{const H=Xr.find(me=>me.key===F)?.label||F,$=D||`${H} ${ee}min`,K=await or(ut(ye,"savedWorkouts"),{clientId:t.id,name:$,equipment:j,focus:F,level:B,duration:ee,exercises:M.map(me=>({name:me.name,videoUrl:me.videoUrl,isGif:me.isGif||!1})),rounds:C,savedAt:Bt.now()});si(me=>[{id:K.id,clientId:t.id,name:$,equipment:j,focus:F,level:B,duration:ee,exercises:M.map(be=>({name:be.name,videoUrl:be.videoUrl,isGif:be.isGif||!1})),rounds:C,savedAt:Bt.now()},...me]),dt("Workout saved!","success")}catch(H){console.error("Error saving workout:",H),dt("Failed to save workout","error")}finally{os(!1),Vn(!1),es("")}}},ot=async D=>{try{await ar(ze(ye,"savedWorkouts",D)),si(H=>H.filter($=>$.id!==D)),dt("Workout removed","info")}catch(H){console.error("Error deleting saved workout:",H),dt("Failed to remove workout","error")}},Rt=D=>{I(D.equipment||["bodyweight"]),G(D.focus||"core"),Y(D.level||"intermediate"),re(D.duration||15);const H=Ai.find($=>$.key===(D.level||"intermediate"));J(H),P(D.exercises||[]),Me(D.rounds||2),_("preview")},Nn=async()=>{const D=JSON.parse(localStorage.getItem("mcf_last_randomiser")||"null");I(D?.equipment||["bodyweight"]),G(D?.focus||"core"),Y(D?.level||"intermediate"),re(D?.duration||15),setTimeout(()=>_i(),50)},Cs=()=>{localStorage.setItem("mcf_last_randomiser",JSON.stringify({equipment:j,focus:F,level:B,duration:ee}))};localStorage.getItem("mcf_last_randomiser");const Qn=()=>{const D=[];let H;F==="mix"?H=["core","upper","lower"]:F==="fullbody"?H=["upper","lower"]:H=[F];for(const $ of j)for(const K of H)D.push(`exercises/${$}/${K}`);return D},Ms="mcf_exercise_urls",ri=()=>{try{return JSON.parse(sessionStorage.getItem(Ms)||"{}")}catch{return{}}},Ds=D=>{try{sessionStorage.setItem(Ms,JSON.stringify(D))}catch{}},er=async()=>{if(E.current){for(;E.current;)await new Promise(H=>setTimeout(H,200));return A.current}const D=Qn().sort().join("|");if(A.current.length>0&&V.current===D)return A.current;E.current=!0,L(!0);try{const H=Qn(),$=[];for(const nt of H)try{const st=ca(ua,nt),vt=await Qw(st);$.push(...vt.items)}catch{console.warn(`Folder ${nt} not found, skipping.`)}if($.length===0&&j.includes("bodyweight")&&F==="core")try{const nt=ca(ua,"core"),st=await Qw(nt);$.push(...st.items)}catch{console.warn("Legacy core/ folder not found either.")}if($.length===0){const nt=j.map(vt=>op.find(kt=>kt.key===vt)?.label).join(" + "),st=Xr.find(vt=>vt.key===F)?.label;return dt(`No exercises found for ${nt} / ${st}. Upload videos to Firebase Storage.`,"error"),E.current=!1,L(!1),[]}const K=new Set,me=$.filter(nt=>{const st=nt.name.replace(/\.(mp4|gif)$/i,"");return K.has(st)?!1:(K.add(st),!0)}),be=ri(),Ve=await Promise.all(me.map(async nt=>{const st=nt.fullPath;let vt=be[st];vt||(vt=await io(nt),be[st]=vt);const kt=U5(nt.name.replace(/\.(mp4|gif)$/i,"")),Xt=/\.gif$/i.test(nt.name);return{name:kt,videoUrl:vt,isGif:Xt}}));return Ds(be),A.current=Ve,V.current=D,ve(Ve),E.current=!1,L(!1),Ve}catch(H){console.error("Error loading exercises:",H);const $=H.code==="storage/unauthorized"?"Storage access denied. Check Firebase Storage rules allow read access.":`Failed to load exercises: ${H.message||H.code||"Unknown error"}`;return dt($,"error"),E.current=!1,L(!1),[]}},_i=async()=>{if(bn)return;Cs(),_("spinning");const D=await er();if(D.length===0){_("setup");return}const H=Ai.find(kt=>kt.key===B);J(H);const $=H.work+H.rest,K=ee*60,me=Math.floor(K/$);let be,Ve;me<=6?(be=Math.max(3,Math.floor(me/2)),Ve=Math.floor(me/be)):me<=12?(be=Math.min(6,Math.floor(me/2)),Ve=Math.floor(me/be)):(be=Math.min(10,Math.floor(me/2)),Ve=Math.floor(me/be)),Ve=Math.max(2,Ve);const nt=B==="beginner"?D.filter(kt=>!V5.has(kt.name.toLowerCase())):D,st=B5(nt),vt=st.slice(0,Math.min(be,st.length));P(vt),Me(Ve),setTimeout(()=>_("preview"),2e3)},Er=()=>{_("countdown"),Xe(3)};w.useEffect(()=>{if(b!=="countdown")return;if($e<=0){_("workout"),He(1),Pe(0),ce("work"),Ce(Qe.work),Ue(!1),Ls();return}Gs();const D=setTimeout(()=>Xe(H=>H-1),1e3);return()=>clearTimeout(D)},[$e,b]),w.useEffect(()=>{if(b!=="workout"||je)return;if(Ee<=0){Ns();return}Ee<=3&&Gs();const D=setTimeout(()=>Ce(H=>H-1),1e3);return()=>clearTimeout(D)},[Ee,b,je]);const Ns=()=>{if(U==="work")ce("rest"),Ce(Qe.rest);else{const D=ke+1;if(D>=M.length){const H=Se+1;if(H>C){Wt(!0),Ea();return}He(H),Pe(0)}else Pe(D);ce("work"),Ce(Qe.work),Ls()}},Ea=async()=>{if(s)try{await or(ut(ye,"workoutLogs"),{clientId:t.id,level:B,duration:ee,equipment:j,focus:F,exerciseCount:M.length,rounds:C,exercises:M.map(K=>K.name),completedAt:Bt.now()}),typeof fbq=="function"&&fbq("trackCustom","WorkoutCompleted",{duration:ee,level:B,focus_area:F,exercise_count:M.length}),Nt(K=>K+1);const D=On+1;ms(D),Le(K=>K+ee),At(K=>({...K,[B]:(K[B]||0)+1}));let H=null;const $=[{count:1,id:"first_workout"},{count:10,id:"workouts_10"},{count:25,id:"workouts_25"},{count:50,id:"workouts_50"},{count:100,id:"workouts_100"}];for(const K of $)if(D>=K.count){const me=await nf(K.id,t);if(me){H=me;break}}if(!H){const K=Ke+(Oe===0?1:0),me=[{weeks:8,id:"streak_8"},{weeks:4,id:"streak_4"},{weeks:2,id:"streak_2"}];for(const be of me)if(K>=be.weeks){const Ve=await nf(be.id,t);if(Ve){H=Ve;break}}}H&&Kt(H)}catch(D){console.error("Error saving workout log:",D)}},zi=async(D,H,$)=>{if(!(!t||!H))try{const K=t.id,me=await _s(ze(ye,"coreBuddyPBs",K)),Ve=(me.exists()?me.data():null)?.exercises||{},nt=Ve[D];let st=!1;if(nt?(H>(nt.weight||0)||H===(nt.weight||0)&&$>(nt.reps||0))&&(st=!0):st=!0,st){const vt={...Ve,[D]:{weight:H,reps:$,achievedAt:Bt.now()}};await Wn(ze(ye,"coreBuddyPBs",K),{clientId:t.id,exercises:vt,updatedAt:Bt.now()}),dt(`New PB! ${H}kg  ${$} reps`,"success"),Gs()}}catch(K){console.error("Error checking PB:",K)}},ii=async D=>{if(yt(D),D.interval){const K=[];for(const me of D.exercises){let be=null,Ve=!1;if(me.storagePath)try{const nt=ca(ua,me.storagePath);be=await io(nt),Ve=/\.gif$/i.test(me.storagePath)}catch{}K.push({name:me.name,videoUrl:be,isGif:Ve})}P(K),Me(D.rounds),J({work:D.work,rest:D.rest}),_("preview");return}const H={};for(const K of D.exercises)if(K.storagePath)try{const me=ca(ua,K.storagePath);H[K.name]={url:await io(me),isGif:/\.gif$/i.test(K.storagePath)}}catch{}Ie(H);const $=D.exercises.map(K=>({name:K.name,type:K.type,targetSets:K.sets,targetReps:K.reps||0,targetTime:K.time||0,sets:[]}));Zn($),_t(0),fs(0),Ln(""),un(""),te(!1),Ct(!1),Z(0),setMgSessionBadges([]),setMgBadgeCelebration(null),_("muscle_workout")},ki=()=>{const D=De.current;D&&(D.paused?(D.play(),te(!0)):(D.pause(),te(!1)))};w.useEffect(()=>{if(b!=="muscle_workout"||!Gt||Mt<=0){b==="muscle_workout"&&Gt&&Mt<=0&&(Ct(!1),Gs());return}return Fe.current=setTimeout(()=>Z(D=>D-1),1e3),()=>clearTimeout(Fe.current)},[b,Gt,Mt]);const Fi=async()=>{const D=rn[gt];let H={};if(D.type==="weighted"){const me=parseFloat(Fn)||0,be=parseInt(Pn)||0;if(be===0){dt("Enter your reps","error");return}H={weight:me,reps:be}}else if(D.type==="reps"){const me=parseInt(Pn)||0;if(me===0){dt("Enter your reps","error");return}H={reps:me}}else if(D.type==="timed"){const me=D.targetTime-Mt;H={time:Math.max(me,1)}}const $=[...rn];$[gt]={...D,sets:[...D.sets,H]},Zn($),D.type==="weighted"&&H.weight>0&&await zi(D.name,H.weight,H.reps);const K=D.sets.length+1;if(K<D.targetSets)fs(K),un(""),Ct(!1),Z(0);else if(gt+1<rn.length){const me=gt+1;_t(me),fs(0),Ln(""),un(""),te(!1),Ct(!1),Z(0)}else await Br($),Cn(!0)},Br=async D=>{if(!(!s||!t))try{const H=D.reduce(($,K)=>$+K.sets.length,0);await or(ut(ye,"workoutLogs"),{clientId:t.id,type:"muscle_group",muscleGroup:pt,sessionId:it?.id,sessionName:it?.name,exerciseCount:D.length,totalSets:H,duration:Math.round(H*1.5),exercises:D.map($=>({name:$.name,type:$.type,sets:$.sets})),completedAt:Bt.now()})}catch(H){console.error("Error saving muscle group workout log:",H)}},Tr=w.useRef(null),Ws=()=>{(!Tr.current||Tr.current.state==="closed")&&(Tr.current=new(window.AudioContext||window.webkitAudioContext));const D=Tr.current;return D.state==="suspended"&&D.resume(),D},Gs=()=>{try{const D=Ws(),H=D.createOscillator(),$=D.createGain();H.connect($),$.connect(D.destination),H.frequency.value=880,$.gain.value=.3,H.start(D.currentTime),H.stop(D.currentTime+.15)}catch{}},Ls=()=>{try{const D=Ws(),H=D.createOscillator(),$=D.createGain();H.connect($),$.connect(D.destination),H.frequency.value=1200,$.gain.value=.4,H.start(D.currentTime),H.stop(D.currentTime+.3)}catch{}};w.useEffect(()=>{if(b!=="workout"||U!=="work"||!M[ke]?.isGif)return;const H=setInterval(()=>{const $=Et.current;if(!$)return;const K=$.getAttribute("src");$.removeAttribute("src"),setTimeout(()=>{Et.current&&Et.current.setAttribute("src",K)},0)},4e3);return()=>clearInterval(H)},[b,U,ke,Se,M]);const S=(D,H,$)=>{const K=Math.round(D/H*L5);return a.jsx("svg",{className:"wk-ring-svg",viewBox:"0 0 200 200",children:D3.map((me,be)=>a.jsx("line",{x1:me.x1,y1:me.y1,x2:me.x2,y2:me.y2,className:be<K?`wk-tick-filled ${$}`:"wk-tick-empty",strokeWidth:me.thick?"3":"2"},be))})},Q=()=>{const D=M.length*C;return((Se-1)*M.length+ke+(U==="rest"?.5:0))/D},Ae=pn&&a.jsx("div",{className:`toast-notification ${pn.type}`,children:pn.message});if(i)return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsx("div",{className:"wk-loading-inline",children:a.jsx("div",{className:"wk-loading-spinner"})})]});if(b==="menu")return a.jsx(nl,{children:a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"wk-menu-heading",children:[a.jsx("h2",{children:"Choose Your Workout"}),a.jsx("p",{children:"No excuses. Just results."})]}),a.jsx("button",{className:"wk-hero-card",onClick:()=>_("randomiser_hub"),children:a.jsx("img",{src:ax,alt:"Randomise Workout",className:"wk-hero-bg"})}),!d&&a.jsxs("button",{className:"wk-hero-card wk-free-card-premium",onClick:()=>p("/upgrade"),children:[a.jsx("img",{src:ox,alt:"Programmes",className:"wk-hero-bg"}),a.jsx("div",{className:"wk-free-card-overlay"}),a.jsxs("div",{className:"wk-free-card-content",children:[a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{className:"wk-free-card-label",children:"Unlock Full Access"})]})]}),d&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"wk-section-header",children:[a.jsx("h2",{children:"Programmes"}),a.jsxs("span",{className:"wk-section-count",children:[ap.length," available"]})]}),a.jsx("div",{className:"wk-prog-scroll-wrap",children:a.jsx("div",{className:"wk-prog-scroll",children:ap.map((D,H)=>D.image?a.jsxs("button",{className:"wk-prog-img-card",onClick:()=>p("/client/core-buddy/programmes",{state:{templateId:D.id}}),style:{animationDelay:`${H*.06}s`},children:[a.jsx("img",{src:D.image,alt:D.name,className:"wk-prog-img"}),H===0&&a.jsx("div",{className:"wk-swipe-arrow",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},D.id):a.jsxs("button",{className:"wk-prog-hero-card",onClick:()=>p("/client/core-buddy/programmes",{state:{templateId:D.id}}),style:{animationDelay:`${H*.06}s`},children:[a.jsx("img",{src:ox,alt:"Programme",className:"wk-prog-hero-bg",loading:"lazy"}),a.jsx("div",{className:"wk-prog-hero-overlay",style:{background:O5[D.focus]}}),a.jsxs("div",{className:"wk-prog-hero-content",children:[a.jsxs("div",{className:"wk-prog-hero-top",children:[a.jsxs("span",{className:"wk-prog-hero-badge",children:[D.duration," WEEKS"]}),a.jsx("span",{className:"wk-prog-hero-level",children:D.level})]}),a.jsxs("div",{className:"wk-prog-hero-bottom",children:[a.jsx("h3",{children:D.name.toUpperCase()}),a.jsxs("p",{children:[D.daysPerWeek,"x per week  ",D.focus==="fullbody"?"Full Body":D.focus.charAt(0).toUpperCase()+D.focus.slice(1)," Focus"]}),a.jsx("span",{className:"wk-prog-hero-go",children:"VIEW PROGRAMME "})]})]}),H===0&&a.jsx("div",{className:"wk-swipe-arrow",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},D.id))})})]}),d&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"wk-section-header",children:[a.jsx("h2",{children:"Muscle Groups"}),a.jsxs("span",{className:"wk-section-count",children:[ru.length," groups"]})]}),a.jsx("div",{className:"wk-muscle-grid",children:ru.map((D,H)=>a.jsx("button",{className:`wk-muscle-hero-card${D.image?" wk-muscle-thumb":""}`,onClick:()=>{Ht(D.key),_("muscle_sessions")},style:{animationDelay:`${H*.05}s`},children:D.image?a.jsx("img",{src:D.image,alt:D.label,className:"wk-muscle-thumb-img"}):a.jsxs(a.Fragment,{children:[a.jsx("img",{src:ax,alt:"Muscle group",className:"wk-muscle-hero-bg",loading:"lazy"}),a.jsx("div",{className:"wk-muscle-hero-overlay",style:{background:ip[D.key]}}),a.jsxs("div",{className:"wk-muscle-hero-content",children:[a.jsx("div",{className:"wk-muscle-hero-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:D.icon})})}),a.jsxs("div",{className:"wk-muscle-hero-text",children:[a.jsx("span",{className:"wk-muscle-hero-name",children:D.label}),a.jsxs("span",{className:"wk-muscle-hero-count",children:[lx[D.key]?.length||0," sessions"]})]})]})]})},D.key))})]})]}),a.jsx(ni,{active:"workouts"}),Ae,a.jsx(Wl,{badge:rt,onDismiss:()=>Kt(null)})]})});if(b==="randomiser_hub"){const D=JSON.parse(localStorage.getItem("mcf_last_randomiser")||"null")||{focus:"core",level:"intermediate",duration:15},H=Xr.find(K=>K.key===D.focus)?.label||D.focus,$=Ai.find(K=>K.key===D.level)?.label||D.level;return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"wk-hub-heading wk-hub-heading-hero",children:[a.jsx("div",{className:"wk-hub-circle-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-hub-circle-logo"})}),a.jsx("h2",{children:"Randomiser"}),a.jsx("p",{children:"Generate, save & replay workouts"})]}),a.jsxs("div",{className:"wk-hub-launch-zone",children:[ts.total>0&&a.jsxs("div",{className:"wk-hub-stats",children:[a.jsxs("div",{className:"wk-hub-stat",children:[a.jsx("span",{className:"wk-hub-stat-value",children:ts.total}),a.jsx("span",{className:"wk-hub-stat-label",children:"Workouts"})]}),ts.streak>0&&a.jsxs("div",{className:"wk-hub-stat",children:[a.jsxs("span",{className:"wk-hub-stat-value",children:[ts.streak,a.jsx("small",{children:"d"})]}),a.jsx("span",{className:"wk-hub-stat-label",children:"Streak"})]}),ts.favouriteFocus&&a.jsxs("div",{className:"wk-hub-stat",children:[a.jsx("span",{className:"wk-hub-stat-value wk-hub-stat-focus",style:{color:bh[ts.favouriteFocus]||"var(--color-primary)"},children:Xr.find(K=>K.key===ts.favouriteFocus)?.label||ts.favouriteFocus}),a.jsx("span",{className:"wk-hub-stat-label",children:"Top Focus"})]})]}),a.jsxs("div",{className:"wk-hub-actions",children:[a.jsxs("button",{className:"wk-hub-action-btn wk-hub-new wk-hub-new-glow",onClick:()=>_("setup"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"New Workout"]}),a.jsxs("button",{className:"wk-hub-action-btn wk-hub-quick",onClick:Nn,disabled:bn,children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})}),"Quick Start",a.jsxs("span",{className:"wk-hub-quick-meta",children:[H,"  ",$,"  ",D.duration,"min"]})]})]}),kr&&a.jsxs("button",{className:"wk-hub-suggestion",onClick:()=>{G(kr.focus),_("setup")},children:[a.jsx("svg",{className:"wk-hub-suggestion-bulb",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),a.jsxs("div",{className:"wk-hub-suggestion-info",children:[a.jsx("span",{className:"wk-hub-suggestion-label",children:kr.message}),a.jsx("span",{className:"wk-hub-suggestion-cta",children:"Tap to set up "})]}),a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"wk-hub-tip",children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),cx[Math.floor(Date.now()/864e5)%cx.length]]})]}),d&&a.jsxs("div",{className:"wk-hub-section wk-hub-section--saved",children:[a.jsxs("h3",{className:"wk-hub-section-title",children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Saved Workouts",Ss.length>0&&a.jsx("span",{className:"wk-hub-count",children:Ss.length})]}),xi?Ss.length===0?a.jsxs("div",{className:"wk-hub-empty wk-hub-empty-enhanced",children:[a.jsx("svg",{className:"wk-hub-empty-icon",width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),a.jsx("p",{children:a.jsx("strong",{children:"No saved workouts yet"})}),a.jsx("p",{className:"wk-hub-empty-sub",children:"Generate a workout and hit save to stash it here for quick replay."})]}):a.jsx("div",{className:"wk-hub-saved-categories",children:Xr.map(K=>{const me=Ss.filter(Ve=>Ve.focus===K.key);if(me.length===0)return null;const be=js[K.key]||!1;return a.jsxs("div",{className:"wk-hub-saved-cat",children:[a.jsxs("button",{className:`wk-hub-saved-cat-header${be?" wk-hub-saved-cat-open":""}`,style:{"--cat-color":bh[K.key]||"var(--color-primary)"},onClick:()=>hr(Ve=>({...Ve,[K.key]:!Ve[K.key]})),children:[a.jsxs("span",{className:"wk-hub-saved-cat-label",children:[a.jsx("span",{className:"wk-hub-focus-pill",style:{"--pill-color":bh[K.key]||"var(--color-primary)"},children:K.label}),a.jsx("span",{className:"wk-hub-saved-cat-count",children:me.length})]}),a.jsx("svg",{className:`wk-hub-saved-cat-chevron${be?" wk-hub-saved-cat-chevron-open":""}`,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),be&&a.jsx("div",{className:"wk-hub-saved-list",children:me.map((Ve,nt)=>{const st=(Ve.equipment||[]).map(kt=>op.find(Xt=>Xt.key===kt)?.label||kt).join(", "),vt=Ai.find(kt=>kt.key===Ve.level)?.label||Ve.level;return a.jsxs("div",{className:"wk-hub-saved-card",style:{animationDelay:`${nt*.05}s`},children:[a.jsxs("button",{className:"wk-hub-saved-main",onClick:()=>Rt(Ve),children:[a.jsxs("div",{className:"wk-hub-saved-info",children:[a.jsx("span",{className:"wk-hub-saved-name",children:Ve.name}),a.jsx("span",{className:"wk-hub-saved-tags",children:a.jsxs("span",{className:"wk-hub-saved-meta",children:[vt,"  ",Ve.duration,"min  ",(Ve.exercises||[]).length," ex"]})}),st&&a.jsx("span",{className:"wk-hub-saved-equip",children:st})]}),a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]}),a.jsx("button",{className:"wk-hub-saved-delete",onClick:()=>ot(Ve.id),"aria-label":"Remove saved workout",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("polyline",{points:"3 6 5 6 21 6"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]},Ve.id)})})]},K.key)})}):a.jsx("div",{className:"wk-hub-empty",children:a.jsx("div",{className:"wk-loading-spinner"})})]}),a.jsxs("div",{className:"wk-hub-section wk-hub-section--recent",children:[a.jsxs("h3",{className:"wk-hub-section-title",children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("polyline",{points:"12 6 12 12 16 14"})]}),"Recent"]}),Yn.length===0?a.jsxs("div",{className:"wk-hub-empty wk-hub-empty-enhanced",children:[a.jsxs("svg",{className:"wk-hub-empty-icon",width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("polyline",{points:"12 6 12 12 16 14"})]}),a.jsx("p",{children:a.jsx("strong",{children:"No workouts yet"})}),a.jsx("p",{className:"wk-hub-empty-sub",children:"Complete your first workout to see your history here."})]}):a.jsx("div",{className:"wk-hub-recent-list",children:Yn.map((K,me)=>{const be=Xr.find(vt=>vt.key===K.focus)?.label||K.focus||"",Ve=Ai.find(vt=>vt.key===K.level)?.label||K.level||"",nt=K.completedAt?.toDate?K.completedAt.toDate():K.completedAt?new Date(K.completedAt):null,st=nt?(()=>{const vt=Math.floor((Date.now()-nt.getTime())/1e3);return vt<3600?`${Math.floor(vt/60)}m ago`:vt<86400?`${Math.floor(vt/3600)}h ago`:`${Math.floor(vt/86400)}d ago`})():"";return a.jsxs("button",{className:"wk-hub-recent-card",style:{animationDelay:`${me*.05}s`},onClick:()=>{G(K.focus||"core"),Y(K.level||"intermediate"),re(K.duration||15),K.equipment&&I(K.equipment),_("setup")},children:[a.jsx("div",{className:"wk-hub-recent-info",children:a.jsxs("span",{className:"wk-hub-recent-tags",children:[a.jsx("span",{className:"wk-hub-focus-pill",style:{"--pill-color":bh[K.focus]||"var(--color-primary)"},children:be}),a.jsxs("span",{className:"wk-hub-recent-meta",children:[Ve,"  ",K.duration||"?","min  ",K.exerciseCount||"?"," ex"]})]})}),a.jsxs("div",{className:"wk-hub-recent-action",children:[a.jsx("span",{className:"wk-hub-recent-time",children:st}),a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]})]},me)})})]})]}),a.jsx(ni,{active:"workouts"}),Ae,a.jsx(Wl,{badge:rt,onDismiss:()=>Kt(null)})]})}if(b==="setup"){const D=Xr.find($=>$.key===F)?.label||F,H=Ai.find($=>$.key===B)?.label||B;return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>_("randomiser_hub"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main wk-setup-main",children:[a.jsx("div",{className:"wk-stats-row",children:[{label:"Total",value:`${On}`,pct:On>0?Math.min(Math.round(On/100*100),100):0,color:"#14b8a6",size:"normal"},{label:"This Week",value:`${Oe}/${rp}`,pct:Math.round(Math.min(Oe,rp)/rp*100),color:"var(--color-primary)",size:"large"},{label:"Wk Streak",value:`${Ke}`,pct:Ke>0?Math.min(Math.round(Ke/12*100),100):0,color:"#38B6FF",size:"normal"}].map($=>{const me=2*Math.PI*38,be=me-$.pct/100*me;return a.jsxs("div",{className:`wk-stat-item${$.size==="large"?" wk-stat-large":""}`,children:[a.jsxs("div",{className:"wk-stat-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"wk-stat-track",cx:"50",cy:"50",r:38}),a.jsx("circle",{className:"wk-stat-fill",cx:"50",cy:"50",r:38,style:{stroke:$.color},strokeDasharray:me,strokeDashoffset:be})]}),a.jsx("span",{className:"wk-stat-value",style:{color:$.color},children:$.value})]}),a.jsx("span",{className:"wk-stat-label",children:$.label})]},$.label)})}),a.jsxs("div",{className:"wk-setup-flow",children:[a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Focus Area"}),a.jsx("div",{className:"wk-focus-grid",children:Xr.map($=>a.jsxs("button",{className:`wk-equip-btn${F===$.key?" active":""}${$.key==="mix"?" wk-mix-btn":""}`,onClick:()=>{Gs(),G($.key)},children:[a.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:$.icon})}),a.jsx("span",{children:$.label})]},$.key))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Level"}),a.jsx("div",{className:"wk-level-cards",children:Ai.map($=>a.jsxs("button",{className:`wk-level-card wk-level-${$.key}${B===$.key?" active":""}`,onClick:()=>{Gs(),Y($.key)},children:[a.jsx("span",{className:"wk-level-name",children:$.label}),a.jsx("span",{className:"wk-level-desc",children:$.desc})]},$.key))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Time"}),a.jsx("div",{className:"wk-time-options",children:lp.map($=>{const K=!St.includes($);return a.jsxs("button",{className:`wk-time-btn${ee===$?" active":""}${K?" locked":""}`,onClick:()=>{K||(Gs(),re($))},disabled:K,children:[a.jsx("span",{className:"wk-time-num",children:$}),a.jsx("span",{className:"wk-time-unit",children:K?a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}):"min"})]},$)})})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Equipment"}),a.jsx("div",{className:"wk-equip-options",children:op.map($=>{const K=j.includes($.key);return a.jsxs("button",{className:`wk-equip-btn${K?" active":""}`,onClick:()=>{K&&j.length===1||(Gs(),I(me=>K&&me.length===1?me:K?me.filter(be=>be!==$.key):[...me,$.key]))},children:[a.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:$.icon})}),a.jsx("span",{children:$.label})]},$.key)})})]}),a.jsx("div",{className:"wk-setup-summary",children:a.jsxs("span",{children:[D,"  ",H,"  ",ee," min"]})})]})]}),a.jsxs("div",{className:"wk-go-sticky",children:[bn&&a.jsx("p",{className:"wk-free-limit-msg",children:"You've used your free workout this week. Upgrade for unlimited access."}),a.jsx("button",{className:"wk-randomise-btn",onClick:_i,disabled:he||bn,children:he?"Loading exercises...":bn?"Limit Reached":"Randomise Workout"})]}),Ae]})}if(b==="spinning")return a.jsxs("div",{className:"wk-page wk-page-center",children:[a.jsxs("div",{className:"wk-spin-container",children:[a.jsxs("div",{className:"wk-spin-ring",children:[a.jsx("svg",{className:"wk-spin-svg",viewBox:"0 0 200 200",children:M3.map((D,H)=>a.jsx("line",{x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,className:"wk-spin-tick",strokeWidth:D.thick?"3.5":"2",style:{animationDelay:`${H*.03}s`}},H))}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-spin-logo",width:"50",height:"50"})]}),a.jsx("p",{className:"wk-spin-text",children:"Generating workout..."})]}),Ae]});if(b==="preview"){const D=it?.interval?{work:it.work,rest:it.rest}:Ai.find($=>$.key===B),H=M.length*C*(D.work+D.rest);return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>_(it?.interval?"muscle_sessions":"setup"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[it?.interval&&a.jsx("h2",{className:"mg-preview-title",children:it.name}),a.jsxs("div",{className:"wk-preview-stats",children:[a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:M.length}),a.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:C}),a.jsx("span",{className:"wk-stat-label",children:"Rounds"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Math.ceil(H/60)}),a.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsxs("span",{className:"wk-stat-val",children:[D.work,"/",D.rest]}),a.jsx("span",{className:"wk-stat-label",children:"Work/Rest"})]})]}),a.jsx("div",{className:"wk-preview-list",children:M.map(($,K)=>a.jsxs("div",{className:"wk-preview-item",style:{animationDelay:`${K*.06}s`},onClick:()=>qt($),children:[a.jsx("span",{className:"wk-preview-num",children:K+1}),a.jsx("div",{className:"wk-preview-thumb",children:$.isGif?a.jsx("img",{src:$.videoUrl,alt:$.name,loading:"lazy"}):a.jsx(z5,{src:`${$.videoUrl}#t=0.1`,muted:!0,playsInline:!0,preload:"metadata"})}),a.jsx("span",{className:"wk-preview-name",children:$.name}),a.jsx("svg",{className:"wk-preview-play",width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]},K))}),ln&&a.jsx("div",{className:"wk-preview-modal-backdrop",onClick:()=>qt(null),children:a.jsxs("div",{className:"wk-preview-modal",onClick:$=>$.stopPropagation(),children:[a.jsx("button",{className:"wk-preview-modal-close",onClick:()=>qt(null),"aria-label":"Close preview",children:a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),a.jsx("div",{className:"wk-preview-modal-video",children:ln.isGif?a.jsx("img",{src:ln.videoUrl,alt:ln.name}):a.jsx("video",{src:ln.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0})}),a.jsx("h3",{className:"wk-preview-modal-title",children:ln.name})]})}),a.jsxs("div",{className:"wk-preview-actions",children:[!it?.interval&&a.jsxs("div",{className:"wk-preview-actions-row",children:[a.jsxs("button",{className:"wk-btn-secondary wk-btn-half",onClick:()=>_i(),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"1 4 1 10 7 10"}),a.jsx("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})]}),"Reshuffle"]}),d&&a.jsxs("button",{className:"wk-btn-secondary wk-btn-half",onClick:()=>Vn(!0),disabled:Kn,children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Save"]})]}),a.jsx("button",{className:"wk-btn-primary wk-btn-full",onClick:Er,children:"Start Workout"})]}),ls&&a.jsx("div",{className:"wk-save-modal-backdrop",onClick:()=>Vn(!1),children:a.jsxs("div",{className:"wk-save-modal",onClick:$=>$.stopPropagation(),children:[a.jsx("h3",{children:"Save Workout"}),a.jsx("p",{children:"Give this workout a name (or leave blank for auto-name)"}),a.jsx("input",{type:"text",className:"wk-save-input",value:wn,onChange:$=>es($.target.value),placeholder:`${Xr.find($=>$.key===F)?.label||F} ${ee}min`,maxLength:40,autoFocus:!0}),a.jsxs("div",{className:"wk-save-modal-actions",children:[a.jsx("button",{className:"wk-btn-secondary",onClick:()=>Vn(!1),children:"Cancel"}),a.jsx("button",{className:"wk-btn-primary",onClick:()=>qe(wn),disabled:Kn,children:Kn?"Saving...":"Save"})]})]})})]})]})}if(b==="countdown")return a.jsx("div",{className:"wk-page wk-page-center wk-page-dark",children:a.jsxs("div",{className:"wk-countdown-big",children:[a.jsx("span",{className:"wk-countdown-num",children:$e}),a.jsx("span",{className:"wk-countdown-label",children:"GET READY"})]})});if(b==="workout"){const D=M[ke],H=U==="work"?Qe.work:Qe.rest,$=U==="rest"?ke+1<M.length?M[ke+1]:Se<C?M[0]:null:null;return a.jsxs("div",{className:"wk-page wk-page-workout",children:[a.jsx("div",{className:"wk-video-container",children:U==="work"?D.isGif?a.jsx("img",{ref:Et,className:"wk-video",src:D.videoUrl,alt:D.name},D.videoUrl):a.jsx("video",{className:"wk-video",src:D.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0},D.videoUrl):a.jsxs("div",{className:"wk-rest-screen",children:[$&&($.isGif?a.jsx("img",{className:"wk-rest-preview",src:$.videoUrl,alt:$.name}):a.jsx("video",{className:"wk-rest-preview",src:$.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0})),a.jsx("div",{className:"wk-rest-overlay"}),a.jsxs("div",{className:"wk-rest-text",children:[a.jsx("span",{className:"wk-rest-label",children:"REST"}),$&&a.jsxs("div",{className:"wk-rest-next",children:[a.jsx("span",{className:"wk-rest-next-tag",children:"UP NEXT"}),a.jsx("span",{className:"wk-rest-next-name",children:$.name})]})]})]})}),a.jsx("div",{className:"wk-back-row",children:a.jsxs("button",{className:"wk-back-btn",onClick:()=>{confirm("Leave workout?")&&_("randomiser_hub")},children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]})}),a.jsx("div",{className:"wk-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"wk-exercise-info",children:[a.jsxs("span",{className:"wk-exercise-counter",children:[ke+1," / ",M.length]}),a.jsx("h2",{className:"wk-exercise-name",children:D.name}),a.jsxs("span",{className:"wk-round-label",children:["Round ",Se," of ",C]})]}),a.jsx("div",{className:"wk-timer-section",children:a.jsxs("div",{className:"wk-timer-ring-wrap",children:[S(Ee,H,U==="work"?"wk-tick-work":"wk-tick-rest"),a.jsxs("div",{className:"wk-timer-center",children:[a.jsx("span",{className:"wk-timer-time",children:Ee}),a.jsx("span",{className:`wk-timer-phase ${U}`,children:U==="work"?"WORK":"REST"})]})]})}),a.jsxs("div",{className:"wk-controls",children:[a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-stop",onClick:()=>{confirm("End workout early?")&&_("randomiser_hub")},children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})})}),a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-pause",onClick:()=>Ue(!je),children:je?a.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}):a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),a.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]})}),a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-skip",onClick:()=>{Ce(0)},children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("polygon",{points:"5 4 15 12 5 20 5 4"}),a.jsx("rect",{x:"15",y:"4",width:"4",height:"16"})]})})]}),a.jsx("div",{className:"wk-progress-bar",children:a.jsx("div",{className:"wk-progress-fill",style:{width:`${Q()*100}%`}})}),Ze&&(()=>{const K=Ai.find(be=>be.key===B),me=M.length*C*(K.work+K.rest);return a.jsxs(a.Fragment,{children:[a.jsx(Qp,{title:"Workout Complete!",stats:[{value:Math.ceil(me/60),label:"Minutes"},{value:M.length*C,label:"Intervals"},{value:C,label:"Rounds"}],hideShare:!d,onShareJourney:t?le:null,userName:t?.name,onDismissStart:()=>_("randomiser_hub"),onDone:()=>{Wt(!1),yt(null),Ht(null)}}),!it?.interval&&a.jsxs("button",{className:"wk-complete-save-btn",onClick:()=>Vn(!0),disabled:Kn,children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Save This Workout"]}),ls&&a.jsx("div",{className:"wk-save-modal-backdrop",onClick:()=>Vn(!1),style:{zIndex:10001},children:a.jsxs("div",{className:"wk-save-modal",onClick:be=>be.stopPropagation(),children:[a.jsx("h3",{children:"Save Workout"}),a.jsx("p",{children:"Give this workout a name (or leave blank for auto-name)"}),a.jsx("input",{type:"text",className:"wk-save-input",value:wn,onChange:be=>es(be.target.value),placeholder:`${Xr.find(be=>be.key===F)?.label||F} ${ee}min`,maxLength:40,autoFocus:!0}),a.jsxs("div",{className:"wk-save-modal-actions",children:[a.jsx("button",{className:"wk-btn-secondary",onClick:()=>Vn(!1),children:"Cancel"}),a.jsx("button",{className:"wk-btn-primary",onClick:()=>qe(wn),disabled:Kn,children:Kn?"Saving...":"Save"})]})]})})]})})()]})}if(b==="muscle_sessions"){const D=ru.find($=>$.key===pt),H=lx[pt]||[];return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>_("randomiser_hub"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"mg-sessions-header",children:[a.jsx("div",{className:"mg-sessions-icon",style:{background:ip[pt]},children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:D?.icon})})}),a.jsxs("h2",{children:[D?.label," Workouts"]}),a.jsxs("p",{children:[H.length," sessions available"]})]}),a.jsx("div",{className:"mg-sessions-list",children:H.map(($,K)=>a.jsxs("button",{className:"mg-session-card",onClick:()=>{yt($),_("muscle_overview")},style:{animationDelay:`${K*.08}s`},children:[a.jsxs("div",{className:"mg-session-info",children:[a.jsx("h3",{children:$.name}),a.jsx("p",{children:$.desc}),a.jsx("div",{className:"mg-session-meta",children:$.interval?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mg-session-tag mg-tag-interval",children:"Interval"}),a.jsxs("span",{className:"mg-session-tag",children:[$.exercises.length," exercises"]}),a.jsxs("span",{className:"mg-session-tag",children:[$.rounds," rounds"]})]}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mg-session-tag mg-tag-strength",children:"Strength"}),a.jsxs("span",{className:"mg-session-tag",children:[$.exercises.length," exercises"]}),a.jsx("span",{className:"mg-session-tag",children:(()=>{const me=$.exercises.map(nt=>nt.sets||0),be=Math.min(...me),Ve=Math.max(...me);return be===Ve?`${be} sets each`:`${be}-${Ve} sets each`})()})]})})]}),a.jsx("div",{className:"mg-session-arrow",children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},$.id))})]}),Ae]})}if(b==="muscle_overview"){const D=it;if(!D)return null;const H=ru.find($=>$.key===pt);return a.jsxs("div",{className:"wk-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>_("muscle_sessions"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main mg-overview-main",children:[a.jsx("div",{className:"mg-overview-hero",style:D.image?void 0:{background:ip[pt]},children:D.image?a.jsx("img",{src:D.image,alt:D.name,className:"mg-overview-hero-img"}):a.jsx("div",{className:"mg-overview-hero-content",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"mg-overview-hero-icon",children:a.jsx("path",{d:H?.icon})})})}),a.jsxs("div",{className:"mg-overview-header",children:[a.jsxs("div",{className:"mg-overview-title-row",children:[a.jsx("h2",{children:D.name}),D.level&&a.jsx("span",{className:"mg-overview-level",children:D.level})]}),a.jsx("p",{className:"mg-overview-desc",children:D.desc})]}),D.overview&&a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 16v-4M12 8h.01"})]}),"About This Workout"]}),a.jsx("p",{children:D.overview})]}),D.tips&&D.tips.length>0&&a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Tips & Form"]}),a.jsx("ul",{className:"mg-overview-tips",children:D.tips.map(($,K)=>a.jsx("li",{children:$},K))})]}),a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"}),a.jsx("rect",{x:"9",y:"3",width:"6",height:"4",rx:"1"}),a.jsx("path",{d:"M9 14l2 2 4-4"})]}),"Exercises (",D.exercises.length,")"]}),a.jsx("div",{className:"mg-overview-exercises",children:D.exercises.map(($,K)=>a.jsxs("div",{className:"mg-overview-exercise",children:[a.jsx("span",{className:"mg-overview-ex-num",children:K+1}),a.jsxs("div",{className:"mg-overview-ex-info",children:[a.jsx("span",{className:"mg-overview-ex-name",children:$.name}),D.interval?a.jsxs("span",{className:"mg-overview-ex-detail",children:[D.work,"s work / ",D.rest,"s rest"]}):a.jsxs("span",{className:"mg-overview-ex-detail",children:[$.sets," sets  ",$.reps?`${$.reps} reps`:`${$.time}s`,$.type==="weighted"&&"  weighted"]})]})]},K))})]}),a.jsxs("button",{className:"mg-overview-start-btn",onClick:()=>ii(D),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Workout"]})]}),Ae]})}if(b==="muscle_workout"){const D=it;if(!D)return null;const H=D.exercises[gt],$=rn[gt];if(!H||!$)return null;const K=$.sets.length,me=D.exercises.length,be=D.exercises.reduce((kt,Xt)=>kt+(Xt.sets||0),0),nt=rn.reduce((kt,Xt)=>kt+Xt.sets.length,0)/be*100,st=Re[H.name];H.type==="timed"&&Mt===0&&!Gt&&K===zt&&setTimeout(()=>Z(H.time),0);const vt=K+1<H.sets?"Log Set":gt+1<me?"Log Set  Next Exercise":"Log Set  Complete";return a.jsxs("div",{className:"wk-page",children:[a.jsx("div",{className:"mg-session-progress",children:a.jsx("div",{className:"mg-session-progress-fill",style:{width:`${nt}%`}})}),a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>{confirm("End workout early?")&&_("muscle_overview")},"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsxs("span",{className:"mg-header-info",children:["Exercise ",gt+1,"/",me]}),a.jsx("div",{style:{width:22}})]})}),a.jsxs("main",{className:"wk-main",children:[st?a.jsxs("div",{className:"mg-video-container",onClick:ki,children:[st.isGif?a.jsx("img",{className:"mg-video",src:st.url,alt:H.name}):a.jsx("video",{ref:De,className:"mg-video",src:st.url,loop:!0,muted:!0,playsInline:!0},H.name),!N&&!st.isGif&&a.jsxs("div",{className:"mg-video-overlay",children:[a.jsx("svg",{className:"mg-play-icon",width:"48",height:"48",viewBox:"0 0 24 24",fill:"rgba(255,255,255,0.9)",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),a.jsx("span",{className:"mg-video-hint",children:"Tap for demo"})]})]}):a.jsxs("div",{className:"mg-video-placeholder",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.4",children:[a.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),a.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),a.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),a.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),a.jsx("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),a.jsx("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),a.jsx("line",{x1:"17",y1:"7",x2:"22",y2:"7"}),a.jsx("line",{x1:"17",y1:"17",x2:"22",y2:"17"})]}),a.jsx("span",{children:"Video coming soon"})]}),a.jsx("div",{className:"wk-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"mg-exercise-card",children:[a.jsx("h2",{className:"mg-ex-name",children:H.name}),a.jsx("span",{className:`mg-ex-type-badge ${H.type}`,children:H.type==="weighted"?"Weight + Reps":H.type==="reps"?"Reps Only":"Timed"}),a.jsxs("div",{className:"mg-ex-set-info",children:[a.jsxs("span",{className:"mg-ex-set-num",children:["Set ",K+1," of ",H.sets]}),H.type!=="timed"&&a.jsxs("span",{className:"mg-ex-target",children:["Target: ",H.reps," reps"]}),H.type==="timed"&&a.jsxs("span",{className:"mg-ex-target",children:["Target: ",H.time,"s"]})]}),H.type==="weighted"&&a.jsxs("div",{className:"mg-input-area",children:[a.jsxs("div",{className:"mg-input-group",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",inputMode:"decimal",className:"mg-input",value:Fn,onChange:kt=>Ln(kt.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"mg-input-group",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:Pn,onChange:kt=>un(kt.target.value),placeholder:"0"})]})]}),H.type==="reps"&&a.jsx("div",{className:"mg-input-area",children:a.jsxs("div",{className:"mg-input-group mg-input-single",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:Pn,onChange:kt=>un(kt.target.value),placeholder:"0"})]})}),H.type==="timed"&&a.jsxs("div",{className:"mg-timer-area",children:[a.jsx("div",{className:"mg-timer-display",children:a.jsxs("span",{className:"mg-timer-value",children:[Mt,"s"]})}),Gt?a.jsx("button",{className:"mg-timer-btn mg-timer-stop",onClick:()=>Ct(!1),children:"Stop"}):a.jsx("button",{className:"mg-timer-btn",onClick:()=>{Mt===0&&Z(H.time),Ct(!0)},children:Mt<H.time&&Mt>0?"Resume":"Start Timer"})]}),a.jsx("button",{className:"mg-log-set-btn",onClick:Fi,children:vt}),$.sets.length>0&&a.jsx("div",{className:"mg-completed-sets",children:$.sets.map((kt,Xt)=>a.jsxs("div",{className:"mg-completed-set",children:[a.jsx("span",{className:"mg-completed-set-check",children:""}),a.jsxs("span",{children:["Set ",Xt+1,": ",kt.weight!=null?`${kt.weight}kg  ${kt.reps}`:kt.reps!=null?`${kt.reps} reps`:`${kt.time}s`]})]},Xt))})]})]}),Ae,It&&(()=>{const kt=rn.reduce((tt,mn)=>tt+mn.sets.length,0),Xt=ru.find(tt=>tt.key===pt)?.label||"",Hn=[{value:rn.length,label:"Exercises"},{value:kt,label:"Sets"}];return a.jsx(Qp,{title:`${Xt} Complete!`,subtitle:it?.name,stats:Hn,hideShare:!d,onShareJourney:t?le:null,userName:t?.name,onDismissStart:()=>_("randomiser_hub"),onDone:()=>{Cn(!1),yt(null),Ht(null)}})})()]})}return a.jsx(Wl,{badge:rt,onDismiss:()=>Kt(null)})}const H5=[{key:"trained",label:"Trained",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4",color:"#A12F3A",darkColor:"#E8475A"},{key:"protein",label:"Hit Protein",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z",color:"#4caf50",darkColor:"#5CDB61"},{key:"steps",label:"10k Steps",icon:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20M4 12.5A2.5 2.5 0 0 1 6.5 10H20M4 5.5A2.5 2.5 0 0 1 6.5 3H20",color:"#ff9800",darkColor:"#FFB020"},{key:"sleep",label:"8hrs Sleep",icon:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z",color:"#7c3aed",darkColor:"#9B5AF2"},{key:"water",label:"2L Water",icon:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z",color:"#2196f3",darkColor:"#42A5F5"}],q5="M12 2l2.4 7.2L22 12l-7.6 2.8L12 22l-2.4-7.2L2 12l7.6-2.8z",ux=[{color:"#e91e63",darkColor:"#FF4D88"},{color:"#00bcd4",darkColor:"#26D9EC"},{color:"#ff5722",darkColor:"#FF7A50"},{color:"#009688",darkColor:"#26B8A8"},{color:"#ffc107",darkColor:"#FFD54F"},{color:"#673ab7",darkColor:"#9575CD"},{color:"#8bc34a",darkColor:"#AED581"},{color:"#f44336",darkColor:"#EF5350"},{color:"#3f51b5",darkColor:"#7986CB"},{color:"#795548",darkColor:"#A1887F"}],$5=700,Xp=42,Pl=2*Math.PI*Xp,wh=["Every day counts. See you tomorrow!","Consistency is your superpower.","Perfect day  keep the streak alive!","You showed up for yourself today."];function W5(s){const e=new Date(s),t=e.getDay(),i=t===0?-6:1-t;return e.setDate(e.getDate()+i),e.setHours(0,0,0,0),e}function Qa(s){return s.toISOString().split("T")[0]}function G5(s){return Array.from({length:7},(e,t)=>{const i=new Date(s);return i.setDate(s.getDate()+t),i})}function K5(){const{currentUser:s,isClient:e,clientData:t,loading:i}=_r(),{isDark:l,toggleTheme:c}=Bi(),{isPremium:d,FREE_HABIT_LIMIT:g}=hc(),y=qs(),[p,b]=w.useState({}),[_,j]=w.useState([]),[I,F]=w.useState(!0),[G,B]=w.useState(!1),[Y,ee]=w.useState(0),[re,pe]=w.useState(null),[ve,he]=w.useState(null),[L,E]=w.useState(!1),[A,V]=w.useState(null),[M,P]=w.useState(!1),[C,Me]=w.useState(!1),[Qe,J]=w.useState(!1),[Se,He]=w.useState(""),[ke,Pe]=w.useState(null),[U,ce]=w.useState([]),[Ee,Ce]=w.useState([]),[je,Ue]=w.useState(null),$e=w.useRef(null),Xe=w.useRef(null),Ze=w.useRef(null),Wt=w.useRef(null),It=w.useRef(!1),Cn=w.useRef({}),ln=w.useRef([]),qt=w.useRef([]),Et=w.useRef(null),pn=w.useRef(wh[Math.floor(Math.random()*wh.length)]),Tt=w.useCallback((ue,Le="info")=>{pe({message:ue,type:Le}),setTimeout(()=>pe(null),3e3)},[]),dt=new Date,le=Qa(dt),pt=W5(dt),Ht=G5(pt),it=["M","T","W","T","F","S","S"],yt=(ue,Le)=>l&&Le?Le:ue,gt=[...H5.filter(ue=>!U.includes(ue.key)).map(ue=>({...ue,color:yt(ue.color,ue.darkColor)})),..._.map((ue,Le)=>{const Ke=ux[Le%ux.length];return{key:`custom_${ue.id}`,label:ue.label,icon:q5,color:yt(Ke.color,Ke.darkColor),isCustom:!0,id:ue.id}})],_t=d?gt:gt.slice(0,g);w.useEffect(()=>{!i&&(!s||!e)&&y("/")},[s,e,i,y]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const Le=ut(ye,"habitLogs"),Ke=tn(Le,Ot("clientId","==",t.id)),ct=await $t(Ke),rt={};ct.docs.forEach(St=>{const bn=St.data();rt[bn.date]={...bn,_id:St.id}}),b(rt);const Kt=await _s(ze(ye,"customHabits",t.id));if(Kt.exists()){const St=Kt.data();j(St.habits||[]),ce(St.hiddenDefaults||[]),Ce(St.savedHabits||[])}let fn=0;const At=new Date(dt);for(;;){const St=Qa(At),bn=rt[St];if(bn)if(Object.values(bn.habits||{}).filter(Boolean).length>=3)fn++,At.setDate(At.getDate()-1);else break;else if(St===le)At.setDate(At.getDate()-1);else break}ee(fn)}catch(Le){console.error("Error loading habit logs:",Le)}finally{F(!1)}})()},[s,t]);const zt=p[le]||{habits:{}};w.useEffect(()=>{Object.values(zt.habits||{}).filter(Boolean).length<_t.length&&C&&Me(!1)},[_t.length,zt.habits]);const fs=async ue=>{if(!(!s||G||zt.habits?.[ue])){ln.current=[...Array(10)].map((Ke,ct)=>{const rt=ct/10*2*Math.PI,Kt=18+Math.random()*20;return{tx:Math.cos(rt)*Kt,ty:Math.sin(rt)*Kt,size:3+Math.random()*4,duration:.4+Math.random()*.3}}),he(ue),setTimeout(()=>he(null),700),navigator.vibrate&&navigator.vibrate(50),B(!0);try{const ct={...zt.habits||{},[ue]:!0},rt=zt._id||`${t.id}_${le}`;if(b(fn=>({...fn,[le]:{clientId:t.id,date:le,habits:ct,_id:rt}})),await Wn(ze(ye,"habitLogs",rt),{clientId:t.id,date:le,habits:ct}),Object.values(ct).filter(Boolean).length===_t.length&&!C){pn.current=wh[Math.floor(Math.random()*wh.length)],qt.current=[...Array(80)].map((At,St)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#ffffff","#000000"][St%3],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:St%3})),setTimeout(()=>{E(!0),Me(!0),setTimeout(()=>Et.current?.focus(),1100)},400);let fn=1;for(let At=1;At<7;At++){const St=new Date;St.setDate(St.getDate()-At);const bn=Qa(St),Ss=p[bn];if(Ss)if(Object.values(Ss.habits||{}).filter(Boolean).length>=_t.length)fn++;else break;else break}fn>=7&&nf("habits_7",t).then(At=>{At&&V(At)})}}catch(Ke){console.error("Error saving habit:",Ke),Tt("Failed to save. Try again.","error"),b(ct=>({...ct,[le]:{...ct[le],habits:{...ct[le]?.habits||{},[ue]:!1}}}))}finally{B(!1)}}},rn=async ue=>{if(!(!s||G)){B(!0);try{const Ke={...zt.habits||{},[ue]:!1},ct=zt._id||`${t.id}_${le}`;await Wn(ze(ye,"habitLogs",ct),{clientId:t.id,date:le,habits:Ke}),b(rt=>({...rt,[le]:{clientId:t.id,date:le,habits:Ke,_id:ct}}))}catch(Le){console.error("Error undoing habit:",Le),Tt("Failed to undo. Try again.","error")}finally{B(!1)}}},Zn=ue=>{if(zt.habits?.[ue]||!1||G||Wt.current)return;Wt.current=ue,Ue(ue),Xe.current=performance.now();const Ke=Cn.current[ue];Ke&&(Ke.style.strokeDashoffset=Pl);const ct=rt=>{const Kt=rt-Xe.current,fn=Math.min(Kt/$5,1),At=Cn.current[ue];At&&(At.style.strokeDashoffset=Pl-fn*Pl),fn<1?Ze.current=requestAnimationFrame(ct):(Wt.current=null,It.current=!0,Ze.current=null,Ue(null),fs(ue))};Ze.current=requestAnimationFrame(ct)},Fn=()=>{if(!Wt.current)return;const ue=Wt.current;Wt.current=null,Ze.current&&(cancelAnimationFrame(Ze.current),Ze.current=null),$e.current&&(clearTimeout($e.current),$e.current=null),Cn.current[ue]&&(Cn.current[ue].style.strokeDashoffset=Pl),Ue(null),Xe.current=null};w.useEffect(()=>()=>{Ze.current&&cancelAnimationFrame(Ze.current),$e.current&&clearTimeout($e.current)},[]);const Ln=w.useCallback(async ue=>{if(!t)throw new Error("Not signed in");const Le=ue&&typeof ue=="object"&&ue.type;await or(ut(ye,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Le?"":ue,type:Le?ue.type:"text",imageURL:null,createdAt:xs(),likeCount:0,commentCount:0,...Le?{metadata:{title:ue.title||"",subtitle:ue.subtitle||"",stats:ue.stats||[],quote:ue.quote||"",badges:ue.badges||[]}}:{}})},[t]),Pn=async()=>{const ue=Se.trim();if(!ue)return;if(!t?.id){Tt("Still loading, try again","error");return}const Le=Date.now().toString(36),Ke=[..._,{id:Le,label:ue}];try{await Wn(ze(ye,"customHabits",t.id),{clientId:t.id,habits:Ke,hiddenDefaults:U,savedHabits:Ee},{merge:!0}),j(Ke),He(""),J(!1),Tt(`Added "${ue}"`,"success")}catch(ct){console.error("Error adding custom habit:",ct),Tt(ct?.code==="permission-denied"?"Permission denied  check Firestore rules for customHabits":`Failed to add habit: ${ct?.message||"Unknown error"}`,"error")}},un=async ue=>{if(!t?.id)return;const Le=_.find(rt=>rt.id===ue),Ke=_.filter(rt=>rt.id!==ue),ct=Le&&!Ee.includes(Le.label)?[...Ee,Le.label]:Ee;try{await Wn(ze(ye,"customHabits",t.id),{clientId:t.id,habits:Ke,hiddenDefaults:U,savedHabits:ct},{merge:!0}),j(Ke),Ce(ct),Pe(null),Tt("Habit saved for later","success")}catch(rt){console.error("Error deleting habit:",rt),Tt("Failed to remove","error")}},Gt=async ue=>{if(!t?.id)return;const Le=Date.now().toString(36),Ke=[..._,{id:Le,label:ue}],ct=Ee.filter(rt=>rt!==ue);try{await Wn(ze(ye,"customHabits",t.id),{clientId:t.id,habits:Ke,hiddenDefaults:U,savedHabits:ct},{merge:!0}),j(Ke),Ce(ct),J(!1),Tt(`Added "${ue}"`,"success")}catch(rt){console.error("Error re-adding habit:",rt),Tt("Failed to add","error")}},Ct=async ue=>{if(!t?.id)return;const Le=Ee.filter(Ke=>Ke!==ue);try{await Wn(ze(ye,"customHabits",t.id),{clientId:t.id,habits:_,hiddenDefaults:U,savedHabits:Le},{merge:!0}),Ce(Le)}catch(Ke){console.error("Error removing saved habit:",Ke)}},Mt=async ue=>{if(!t?.id)return;const Le=[...U,ue];try{await Wn(ze(ye,"customHabits",t.id),{clientId:t.id,habits:_,hiddenDefaults:Le,savedHabits:Ee},{merge:!0}),ce(Le),Pe(null),Tt("Habit removed","success")}catch(Ke){console.error("Error hiding default habit:",Ke),Tt("Failed to remove","error")}},Z=Ht.map(ue=>{const Le=Qa(ue),Ke=p[Le],ct=Ke?Object.values(Ke.habits||{}).filter(Boolean).length:0;return{date:ue,dateStr:Le,completed:ct,total:_t.length}}),N=Z.reduce((ue,Le)=>ue+Le.completed,0),te=Z.reduce((ue,Le)=>ue+Le.total,0),Re=te>0?Math.round(N/te*100):0,Ie=Object.values(zt.habits||{}).filter(Boolean).length,De=_t.length>0?Math.round(Ie/_t.length*100):0,Fe=Ie===_t.length&&_t.length>0,Oe=(()=>{const ue=Object.keys(p).sort();let Le=0,Ke=0,ct=null;for(const rt of ue){const Kt=p[rt];if(Object.values(Kt.habits||{}).filter(Boolean).length>=3){if(ct){const At=new Date(ct);Ke=(new Date(rt)-At)/(1e3*60*60*24)===1?Ke+1:1}else Ke=1;Ke>Le&&(Le=Ke),ct=rt}else Ke=0,ct=null}return Math.max(Le,Y)})(),Nt=new Date(dt.getFullYear(),dt.getMonth(),1),bt=Nt.toLocaleString("default",{month:"long"}),lt=new Date(dt.getFullYear(),dt.getMonth()+1,0).getDate(),dn=(Nt.getDay()+6)%7,hn=Array.from({length:lt},(ue,Le)=>{const Ke=new Date(dt.getFullYear(),dt.getMonth(),Le+1),ct=Qa(Ke),rt=p[ct],Kt=rt?Object.values(rt.habits||{}).filter(Boolean).length:0,fn=Ke>dt;return{day:Le+1,dateStr:ct,completed:Kt,total:_t.length,isFuture:fn,isToday:ct===le}}),On=_t.map(ue=>({...ue,days:Ht.map(Le=>{const Ke=Qa(Le);return p[Ke]?.habits?.[ue.key]||!1})})),ms=Z.filter(ue=>ue.completed===ue.total&&ue.total>0).length;return a.jsx(nl,{children:a.jsxs("div",{className:"cbc-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>y("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),i||I?a.jsx("div",{className:"cbc-loading-inline",children:a.jsx("div",{className:"cbc-loading-spinner"})}):a.jsxs("main",{className:"cbc-main",children:[a.jsxs("div",{className:"cbc-hero anim-fade-up",children:[a.jsxs("div",{className:`cbc-progress-ring${Fe?" cbc-ring-complete":""}`,children:[a.jsxs("svg",{viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"cbc-arc-track",cx:"100",cy:"100",r:"80"}),a.jsx("circle",{className:"cbc-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-De/100*2*Math.PI*80})]}),a.jsxs("div",{className:"cbc-ring-center",children:[a.jsxs("span",{className:"cbc-ring-count",children:[Ie,a.jsx("span",{className:"cbc-ring-divider",children:"/"}),_t.length]}),a.jsx("span",{className:"cbc-ring-label",children:Fe?"complete":"today"})]})]}),a.jsx("p",{className:"cbc-hero-tagline",children:Fe?"You showed up for yourself today.":Ie===0?"Start your day strong.":`${_t.length-Ie} to go  keep pushing.`})]}),a.jsxs("div",{className:"cbc-streak-card anim-fade-up-d1",children:[a.jsx("div",{className:"cbc-streak-icon",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})})}),a.jsxs("div",{className:"cbc-streak-info",children:[a.jsx("span",{className:"cbc-streak-count",children:Y}),a.jsx("span",{className:"cbc-streak-label",children:"day streak"})]}),a.jsxs("div",{className:"cbc-streak-best",children:[a.jsx("span",{className:"cbc-streak-best-val",children:Oe}),a.jsx("span",{className:"cbc-streak-best-label",children:"best"})]})]}),a.jsxs("div",{className:"cbc-section anim-fade-up-d2",children:[a.jsx("h2",{className:"cbc-section-title",children:"Today's Habits"}),a.jsxs("div",{className:"cbc-habits-grid",children:[_t.map(ue=>{const Le=zt.habits?.[ue.key]||!1,Ke=ve===ue.key,ct=je===ue.key;return a.jsxs("div",{className:`cbc-habit-tile ${Le?"cbc-habit-done":""} ${Ke?"cbc-habit-just-checked":""}`,style:{"--habit-color":ue.color},children:[d&&a.jsx("button",{className:"cbc-habit-delete",onClick:rt=>{rt.stopPropagation(),Pe(ue.isCustom?{type:"custom",id:ue.id,label:ue.label}:{type:"default",key:ue.key,label:ue.label})},"aria-label":`Remove ${ue.label}`,children:a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),a.jsxs("div",{className:`cbc-habit-ring-touch ${ct?"cbc-holding":""} ${Le?"cbc-ring-completed":""}`,onPointerDown:rt=>{Le||(rt.preventDefault(),Zn(ue.key))},onPointerUp:Fn,onPointerLeave:Fn,onPointerCancel:Fn,onClick:rt=>{if(rt.stopPropagation(),It.current){It.current=!1;return}Le&&rn(ue.key)},role:"button",tabIndex:0,"aria-label":Le?`Undo ${ue.label}`:`Press and hold to complete ${ue.label}`,onKeyDown:rt=>{(rt.key==="Enter"||rt.key===" ")&&(rt.preventDefault(),Le?rn(ue.key):fs(ue.key))},children:[a.jsxs("svg",{className:"cbc-habit-ring-svg",viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cbc-habit-ring-track",cx:"50",cy:"50",r:Xp}),a.jsx("circle",{className:"cbc-habit-ring-fill",ref:rt=>{rt&&(Cn.current[ue.key]=rt)},cx:"50",cy:"50",r:Xp,style:{stroke:ue.color,strokeDasharray:Pl,strokeDashoffset:Le?0:Pl}})]}),Le&&a.jsx("div",{className:"cbc-habit-glow-orb",style:{"--habit-color":ue.color}}),a.jsx("div",{className:"cbc-habit-ring-icon",style:{color:ue.color},children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:ue.icon})})}),Ke&&a.jsx("div",{className:"cbc-particles",children:ln.current.map((rt,Kt)=>a.jsx("span",{className:"cbc-particle",style:{"--tx":`${rt.tx}px`,"--ty":`${rt.ty}px`,"--size":`${rt.size}px`,"--particle-color":ue.color,animationDuration:`${rt.duration}s`}},Kt))})]}),a.jsx("span",{className:"cbc-habit-label",children:ue.label}),Le?a.jsx("span",{className:"cbc-habit-done-tag",children:"Done"}):a.jsx("span",{className:"cbc-habit-hold-hint",children:"Hold to complete"})]},ue.key)}),d?a.jsxs("div",{className:"cbc-habit-tile cbc-add-tile",onClick:()=>J(!0),role:"button",tabIndex:0,children:[a.jsx("div",{className:"cbc-add-ring",children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})}),a.jsx("span",{className:"cbc-habit-label",children:"Add Habit"}),a.jsx("span",{className:"cbc-habit-hold-hint",children:"Your own"})]}):a.jsxs("div",{className:"cbc-habit-tile cbc-unlock-tile",onClick:()=>y("/upgrade"),role:"button",tabIndex:0,children:[a.jsx("div",{className:"cbc-unlock-ring",children:a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),a.jsx("span",{className:"cbc-habit-label",children:"More Habits"}),a.jsx("span",{className:"cbc-habit-hold-hint",children:"Custom & editable"})]})]})]}),a.jsxs("div",{className:"cbc-section anim-fade-up-d3",children:[a.jsxs("div",{className:"cbc-section-header",children:[a.jsx("h2",{className:"cbc-section-title",children:"This Week"}),a.jsxs("span",{className:"cbc-section-badge",children:[ms,"/7 perfect"]})]}),a.jsxs("div",{className:"cbc-weekly-card",children:[a.jsxs("div",{className:"cbc-weekly-header",children:[a.jsx("span",{className:"cbc-weekly-habit-name"}),it.map((ue,Le)=>a.jsx("span",{className:`cbc-weekly-day-label${Ht[Le]&&Qa(Ht[Le])===le?" cbc-today-label":""}`,children:ue},Le))]}),On.map(ue=>(ue.days.filter(Boolean).length,a.jsxs("div",{className:"cbc-weekly-row",children:[a.jsx("span",{className:"cbc-weekly-habit-name",style:{color:ue.color},children:ue.label}),ue.days.map((Le,Ke)=>a.jsx("span",{className:`cbc-weekly-dot${Le?" cbc-dot-done":""}${Ht[Ke]&&Qa(Ht[Ke])===le?" cbc-dot-today":""}`,style:Le?{background:ue.color,borderColor:ue.color,boxShadow:`0 0 6px ${ue.color}40`}:void 0},Ke))]},ue.key))),a.jsxs("div",{className:"cbc-week-summary",children:[a.jsx("div",{className:"cbc-week-summary-bar",children:a.jsx("div",{className:"cbc-week-summary-fill",style:{width:`${Re}%`}})}),a.jsxs("span",{className:"cbc-week-summary-text",children:[N,"/",te," completed (",Re,"%)"]})]})]})]}),a.jsxs("div",{className:"cbc-section anim-fade-up-d4",children:[a.jsx("h2",{className:"cbc-section-title",children:bt}),a.jsxs("div",{className:"cbc-calendar-card",children:[a.jsx("div",{className:"cbc-cal-header",children:["M","T","W","T","F","S","S"].map((ue,Le)=>a.jsx("span",{className:"cbc-cal-day-label",children:ue},Le))}),a.jsxs("div",{className:"cbc-cal-grid",children:[Array.from({length:dn},(ue,Le)=>a.jsx("span",{className:"cbc-cal-cell cbc-cal-empty"},`e${Le}`)),hn.map(ue=>{const Le=ue.total>0?ue.completed/ue.total:0,Ke=ue.isFuture?-1:Le===0?0:Le<.4?1:Le<.75?2:Le<1?3:4;return a.jsx("span",{className:`cbc-cal-cell${ue.isToday?" cbc-cal-today":""}${Ke===4?" cbc-cal-perfect":""} cbc-cal-heat-${Ke<0?"future":Ke}`,children:ue.day},ue.day)})]}),a.jsxs("div",{className:"cbc-cal-legend",children:[a.jsx("span",{className:"cbc-cal-legend-label",children:"Less"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-0"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-1"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-2"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-3"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-4"}),a.jsx("span",{className:"cbc-cal-legend-label",children:"More"})]})]})]})]}),a.jsx(ni,{active:"home"}),Qe&&a.jsx("div",{className:"cbc-modal-overlay",onClick:()=>J(!1),children:a.jsxs("div",{className:"cbc-modal",onClick:ue=>ue.stopPropagation(),children:[a.jsx("h3",{className:"cbc-modal-title",children:"Add Habit"}),a.jsx("p",{className:"cbc-modal-desc",children:"Track something personal to your routine."}),Ee.length>0&&a.jsxs("div",{className:"cbc-saved-habits",children:[a.jsx("span",{className:"cbc-saved-label",children:"Quick add"}),a.jsx("div",{className:"cbc-saved-chips",children:Ee.map(ue=>a.jsxs("div",{className:"cbc-saved-chip",children:[a.jsx("button",{className:"cbc-saved-chip-add",onClick:()=>Gt(ue),children:ue}),a.jsx("button",{className:"cbc-saved-chip-remove",onClick:()=>Ct(ue),"aria-label":`Remove ${ue}`,children:""})]},ue))})]}),a.jsx("input",{className:"cbc-modal-input",type:"text",placeholder:"e.g. Meditate, Stretch, Read...",value:Se,onChange:ue=>He(ue.target.value),maxLength:30,autoFocus:!0,onKeyDown:ue=>ue.key==="Enter"&&Pn()}),a.jsxs("div",{className:"cbc-modal-actions",children:[a.jsx("button",{className:"cbc-modal-cancel",onClick:()=>{J(!1),He("")},children:"Cancel"}),a.jsx("button",{className:"cbc-modal-save",onClick:Pn,disabled:!Se.trim(),children:"Add"})]})]})}),ke&&a.jsx("div",{className:"cbc-modal-overlay",onClick:()=>Pe(null),children:a.jsxs("div",{className:"cbc-modal",onClick:ue=>ue.stopPropagation(),children:[a.jsxs("h3",{className:"cbc-modal-title",children:['Remove "',ke.label,'"?']}),a.jsx("p",{className:"cbc-modal-desc",children:"This will remove the habit from your daily tracker. Past logs won't be affected."}),a.jsxs("div",{className:"cbc-modal-actions",children:[a.jsx("button",{className:"cbc-modal-cancel",onClick:()=>Pe(null),children:"Keep"}),a.jsx("button",{className:"cbc-modal-delete",onClick:()=>ke.type==="custom"?un(ke.id):Mt(ke.key),children:"Remove"})]})]})}),L&&a.jsx(Qp,{title:"All Habits Complete!",subtitle:pn.current,stats:[{value:`${Ie}/${_t.length}`,label:"Habits"},{value:Y||1,label:"Day Streak"}],buttonLabel:"Keep Going",holdLabel:"Hold To Complete Today's Habits",shareType:"habits",hideShare:!d,onShareJourney:t?Ln:null,userName:t?.name,onDone:()=>{E(!1),P(!1)}}),re&&a.jsx("div",{className:`toast-notification ${re.type}`,children:re.message}),a.jsx(Wl,{badge:A,onDismiss:()=>V(null)})]})})}function Do(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function Y5(s,e){return[s,e].sort().join("_")}function dx(s){if(!s)return"";const e=s instanceof Date?s:s.toDate?s.toDate():new Date(s),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function Q5(){const{currentUser:s,isClient:e,clientData:t,loading:i}=_r(),{isDark:l,toggleTheme:c}=Bi(),d=qs(),[g,y]=w.useState("feed"),[p,b]=w.useState([]),[_,j]=w.useState([]),[I,F]=w.useState([]),[G,B]=w.useState(""),[Y,ee]=w.useState([]),[re,pe]=w.useState([]),[ve,he]=w.useState(!0),[L,E]=w.useState(null),[A,V]=w.useState(null),[M,P]=w.useState([]),[C,Me]=w.useState(!1),[Qe,J]=w.useState(new Set),[Se,He]=w.useState(new Set),[ke,Pe]=w.useState({}),[U,ce]=w.useState({}),[Ee,Ce]=w.useState({}),[je,Ue]=w.useState({}),[$e,Xe]=w.useState({}),[Ze,Wt]=w.useState({}),It=w.useRef({}),[Cn,ln]=w.useState(!1),[qt,Et]=w.useState(null),[pn,Tt]=w.useState([]),dt=w.useCallback((N,te="info")=>{V({message:N,type:te}),setTimeout(()=>V(null),3500)},[]),le=(N,te)=>{const Re=N.match(/@(\w*)$/);if(Re){ln(!0),Et(te);const Ie=p.filter(De=>De.name&&De.name.toLowerCase().includes(Re[1].toLowerCase())).slice(0,5);Tt(Ie)}else ln(!1),Tt([])},pt=(N,te)=>{const Ie=(U[te]||"").replace(/@\w*$/,`@${N.name} `);ce(De=>({...De,[te]:Ie})),ln(!1),Tt([])},Ht=N=>N&&N.split(/(@\w[\w\s]*?\s)/g).map((Re,Ie)=>Re.startsWith("@")&&p.some(De=>Re.trim()===`@${De.name}`)?a.jsx("span",{className:"mention-highlight",children:Re.trim()},Ie):Re);w.useEffect(()=>{!i&&(!s||!e)&&d("/")},[s,e,i,d]);const it=w.useCallback(async()=>{if(t){he(!0);try{const N=t.id,Re=(await $t(ut(ye,"clients"))).docs.map(lt=>({id:lt.id,...lt.data()}));pe(Re);const Ie=Object.fromEntries(Re.map(lt=>[lt.id,lt])),De=await $t(tn(ut(ye,"buddies"),Ot("user1","==",N))),Fe=await $t(tn(ut(ye,"buddies"),Ot("user2","==",N))),Oe=new Set;[...De.docs,...Fe.docs].forEach(lt=>{const dn=lt.data(),hn=dn.user1===N?dn.user2:dn.user1;Oe.add(hn)}),b(Array.from(Oe).map(lt=>Ie[lt]).filter(Boolean));const Nt=await $t(tn(ut(ye,"buddyRequests"),Ot("toId","==",N),Ot("status","==","pending")));j(Nt.docs.map(lt=>({reqId:lt.id,...lt.data(),fromClient:Ie[lt.data().fromId]})).filter(lt=>lt.fromClient));const bt=await $t(tn(ut(ye,"buddyRequests"),Ot("fromId","==",N),Ot("status","==","pending")));F(bt.docs.map(lt=>({reqId:lt.id,...lt.data(),toClient:Ie[lt.data().toId]})).filter(lt=>lt.toClient))}catch(N){console.error("Error fetching buddy data:",N),dt("Failed to load buddies","error")}finally{he(!1)}}},[t,dt]);w.useEffect(()=>{it()},[it]),w.useEffect(()=>{if(!G.trim()||!t){ee([]);return}const N=G.toLowerCase(),te=t.id,Re=new Set(p.map(Oe=>Oe.id)),Ie=new Set(I.map(Oe=>Oe.toId)),De=new Set(_.map(Oe=>Oe.fromId)),Fe=re.filter(Oe=>{if(Oe.id===te||!Oe.name||!Oe.coreBuddyAccess&&Oe.clientType!=="core_buddy")return!1;const Nt=["self_signup","google","apple"];return Oe.tier==="premium"||!Nt.includes(Oe.signupSource)?Oe.name.toLowerCase().includes(N):!1}).map(Oe=>({...Oe,isBuddy:Re.has(Oe.id),isPendingOut:Ie.has(Oe.id),isPendingIn:De.has(Oe.id)})).slice(0,20);ee(Fe)},[G,re,p,I,_,t]);const yt=async(N,te)=>{if(!(!t||N===t.id))try{await or(ut(ye,"notifications"),{toId:N,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:te,read:!1,createdAt:xs()})}catch(Re){console.error("Notification error:",Re),Re.code==="permission-denied"&&dt("Notifications blocked  check Firestore rules","error")}},gt=async N=>{E(N);try{const te=`${t.id}_${N}`;await Wn(ze(ye,"buddyRequests",te),{fromId:t.id,toId:N,status:"pending",createdAt:xs()}),await yt(N,"buddy_request"),dt("Buddy request sent!","success"),await it()}catch(te){console.error("Error sending request:",te),dt("Failed to send request","error")}finally{E(null)}},_t=async N=>{E(N.reqId);try{const te=Y5(N.fromId,t.id);await Wn(ze(ye,"buddies",te),{user1:[N.fromId,t.id].sort()[0],user2:[N.fromId,t.id].sort()[1],connectedAt:xs()}),await ar(ze(ye,"buddyRequests",N.reqId)),await yt(N.fromId,"buddy_accept"),dt("Buddy added!","success"),await it()}catch(te){console.error("Error accepting request:",te),dt("Failed to accept","error")}finally{E(null)}},zt=async N=>{E(N.reqId);try{await ar(ze(ye,"buddyRequests",N.reqId)),dt("Request declined","info"),await it()}catch(te){console.error("Error declining:",te),dt("Failed to decline","error")}finally{E(null)}},fs=async N=>{E(N.reqId);try{await ar(ze(ye,"buddyRequests",N.reqId)),dt("Request cancelled","info"),await it()}catch(te){console.error("Error cancelling:",te),dt("Failed to cancel","error")}finally{E(null)}},rn=w.useCallback(async()=>{if(!t||p.length===0){P([]);return}Me(!0);try{const N=[t.id,...p.map(De=>De.id)],te=[];for(let De=0;De<N.length;De+=30)te.push(N.slice(De,De+30));let Re=[];for(const De of te){const Fe=await $t(tn(ut(ye,"posts"),Ot("authorId","in",De)));Re.push(...Fe.docs.map(Oe=>({id:Oe.id,...Oe.data()})))}Re.sort((De,Fe)=>{const Oe=De.createdAt?.toDate?.()||new Date(0);return(Fe.createdAt?.toDate?.()||new Date(0))-Oe}),P(Re.slice(0,50));const Ie=await $t(tn(ut(ye,"postLikes"),Ot("userId","==",t.id)));J(new Set(Ie.docs.map(De=>De.data().postId)))}catch(N){console.error("Error loading feed:",N)}finally{Me(!1)}},[t,p]);w.useEffect(()=>{p.length>0&&g==="feed"&&rn()},[p,g,rn]);const Zn=async N=>{if(!t)return;const te=t.id,Re=`${N}_${te}`,Ie=Qe.has(N),De=new Set(Qe);Ie?De.delete(N):De.add(N),J(De),P(Fe=>Fe.map(Oe=>Oe.id===N?{...Oe,likeCount:Math.max(0,(Oe.likeCount||0)+(Ie?-1:1))}:Oe));try{if(Ie)await ar(ze(ye,"postLikes",Re)),await zn(ze(ye,"posts",N),{likeCount:mi(-1)});else{await Wn(ze(ye,"postLikes",Re),{postId:N,userId:te,createdAt:xs()}),await zn(ze(ye,"posts",N),{likeCount:mi(1)});const Fe=M.find(Oe=>Oe.id===N);Fe&&yt(Fe.authorId,"like")}}catch(Fe){console.error("Like error:",Fe),rn()}},Fn=async N=>{if(window.confirm("Delete this post?"))try{await ar(ze(ye,"posts",N)),P(te=>te.filter(Re=>Re.id!==N)),dt("Post deleted","info")}catch(te){console.error("Delete error:",te),dt("Failed to delete","error")}},Ln=async N=>{try{const Re=(await $t(tn(ut(ye,"postComments"),Ot("postId","==",N)))).docs.map(Ie=>({id:Ie.id,...Ie.data()})).sort((Ie,De)=>{const Fe=Ie.createdAt?.toDate?.()||new Date(0),Oe=De.createdAt?.toDate?.()||new Date(0);return Fe-Oe}).slice(0,50);Pe(Ie=>({...Ie,[N]:Re}))}catch(te){console.error("Error loading comments:",te)}},Pn=N=>{const te=new Set(Se);te.has(N)?te.delete(N):(te.add(N),ke[N]||Ln(N)),He(te)},un=async N=>{const te=(U[N]||"").trim(),Re=$e[N];if(!(!te&&!Re||!t)){Ce(Ie=>({...Ie,[N]:!0}));try{let Ie=null;if(Re){const bt=ca(ua,`comment-images/${Date.now()}_${Re.name}`);await wu(bt,Re),Ie=await io(bt)}const De={postId:N,authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:te||"",createdAt:xs()};Ie&&(De.imageURL=Ie);const Fe=je[N];Fe&&(De.replyToId=Fe.id,De.replyToName=Fe.authorName),await or(ut(ye,"postComments"),De),await zn(ze(ye,"posts",N),{commentCount:mi(1)});const Oe=M.find(bt=>bt.id===N);Oe&&yt(Oe.authorId,"comment");const Nt=te.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Nt){const bt=new Set;Nt.forEach(lt=>{const dn=lt.slice(1).trim(),hn=p.find(On=>On.name&&On.name.toLowerCase()===dn.toLowerCase());hn&&!bt.has(hn.id)&&(bt.add(hn.id),yt(hn.id,"mention"))})}ce(bt=>({...bt,[N]:""})),Xe(bt=>({...bt,[N]:null})),Wt(bt=>({...bt,[N]:null})),Ue(bt=>({...bt,[N]:null})),It.current[N]&&(It.current[N].value=""),P(bt=>bt.map(lt=>lt.id===N?{...lt,commentCount:(lt.commentCount||0)+1}:lt)),await Ln(N)}catch(Ie){console.error("Comment error:",Ie),dt("Failed to comment","error")}finally{Ce(Ie=>({...Ie,[N]:!1}))}}},Gt=async(N,te)=>{try{await ar(ze(ye,"postComments",te)),await zn(ze(ye,"posts",N),{commentCount:mi(-1)}),Pe(Re=>({...Re,[N]:(Re[N]||[]).filter(Ie=>Ie.id!==te)})),P(Re=>Re.map(Ie=>Ie.id===N?{...Ie,commentCount:Math.max((Ie.commentCount||1)-1,0)}:Ie))}catch(Re){console.error("Delete comment error:",Re),dt("Failed to delete comment","error")}},Ct=(N,te)=>{const Re=te.target.files?.[0];if(!Re)return;if(Re.size>5*1024*1024){dt("Image must be under 5MB","error");return}Xe(De=>({...De,[N]:Re}));const Ie=new FileReader;Ie.onload=De=>Wt(Fe=>({...Fe,[N]:De.target.result})),Ie.readAsDataURL(Re)},Mt=N=>{Xe(te=>({...te,[N]:null})),Wt(te=>({...te,[N]:null})),It.current[N]&&(It.current[N].value="")},Z=_.length;return i?a.jsx("div",{className:"bdy-loading",children:a.jsx("div",{className:"bdy-spinner"})}):!s||!e||!t?null:a.jsx(nl,{children:a.jsxs("div",{className:"bdy-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"bdy-main",children:[a.jsx("h1",{className:"bdy-title",children:"Buddies"}),a.jsxs("button",{className:"bdy-leaderboard-link",onClick:()=>d("/client/leaderboard"),children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C7 4 7 7 7 7"}),a.jsx("path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5C17 4 17 7 17 7"}),a.jsx("rect",{x:"6",y:"9",width:"12",height:"13",rx:"2"}),a.jsx("path",{d:"M12 9v13"}),a.jsx("path",{d:"M2 22h20"})]}),a.jsx("span",{children:"Leaderboard"}),a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"bdy-tabs",children:[a.jsxs("button",{className:`bdy-tab${g==="feed"?" active":""}`,onClick:()=>y("feed"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M4 11a9 9 0 0 1 9 9"}),a.jsx("path",{d:"M4 4a16 16 0 0 1 16 16"}),a.jsx("circle",{cx:"5",cy:"19",r:"1"})]}),a.jsx("span",{children:"Feed"})]}),a.jsxs("button",{className:`bdy-tab${g==="buddies"?" active":""}`,onClick:()=>y("buddies"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("span",{children:"Buddies"})]}),a.jsxs("button",{className:`bdy-tab${g==="requests"?" active":""}`,onClick:()=>y("requests"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("line",{x1:"19",y1:"8",x2:"19",y2:"14"}),a.jsx("line",{x1:"22",y1:"11",x2:"16",y2:"11"})]}),a.jsx("span",{children:"Requests"}),Z>0&&a.jsx("span",{className:"bdy-tab-badge",children:Z})]}),a.jsxs("button",{className:`bdy-tab${g==="search"?" active":""}`,onClick:()=>y("search"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("span",{children:"Find"})]})]}),ve?a.jsx("div",{className:"bdy-content-loading",children:a.jsx("div",{className:"bdy-spinner"})}):a.jsxs(a.Fragment,{children:[g==="feed"&&a.jsx("div",{className:"bdy-section",children:p.length===0?a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M4 11a9 9 0 0 1 9 9"}),a.jsx("path",{d:"M4 4a16 16 0 0 1 16 16"}),a.jsx("circle",{cx:"5",cy:"19",r:"1"})]}),a.jsx("h3",{children:"No buddies yet"}),a.jsx("p",{children:"Add buddies to see their posts here!"}),a.jsx("button",{className:"bdy-empty-btn",onClick:()=>y("search"),children:"Find Buddies"})]}):C?a.jsx("div",{className:"bdy-content-loading",children:a.jsx("div",{className:"bdy-spinner"})}):M.length===0?a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("h3",{children:"No posts yet"}),a.jsx("p",{children:"Your buddies haven't posted anything yet"})]}):a.jsx("div",{className:"bdy-feed-list",children:M.map(N=>a.jsxs("div",{className:"bdy-feed-post",children:[a.jsxs("div",{className:"bdy-feed-post-header",children:[a.jsx("div",{className:"bdy-feed-avatar",onClick:()=>d(`/client/core-buddy/profile/${N.authorId}`),children:N.authorPhotoURL?a.jsx("img",{src:N.authorPhotoURL,alt:""}):a.jsx("span",{children:Do(N.authorName)})}),a.jsxs("div",{className:"bdy-feed-meta",onClick:()=>d(`/client/core-buddy/profile/${N.authorId}`),children:[a.jsx("span",{className:"bdy-feed-name",children:N.authorName}),a.jsx("span",{className:"bdy-feed-time",children:dx(N.createdAt)})]}),N.authorId===t?.id&&a.jsx("button",{className:"bdy-feed-delete-btn",onClick:()=>Fn(N.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),N.type==="workout_summary"&&N.metadata?a.jsxs("div",{className:"bdy-feed-card",children:[a.jsx("div",{className:"bdy-feed-card-logo",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF"})}),a.jsx("h3",{className:"bdy-feed-card-title",children:N.metadata.title}),N.metadata.stats?.length>0&&a.jsx("p",{className:"bdy-feed-card-stats",children:N.metadata.stats.map(te=>`${te.value} ${te.label}`).join("    ")}),!N.metadata.stats?.length&&N.metadata.subtitle&&a.jsx("p",{className:"bdy-feed-card-stats",children:N.metadata.subtitle}),a.jsx("p",{className:"bdy-feed-card-cta",children:"Completed a workout using Core Buddy"})]}):N.type==="badge_earned"&&N.metadata?a.jsxs("div",{className:"bdy-feed-card",children:[a.jsx("div",{className:"bdy-feed-card-logo bdy-feed-card-badge",children:(()=>{const te=Pr.find(Re=>Re.id===N.metadata.badgeId);return te?.img?a.jsx("img",{src:te.img,alt:N.metadata.title,loading:"lazy"}):a.jsx("img",{src:"/Logo.webp",alt:N.metadata.title})})()}),a.jsx("h3",{className:"bdy-feed-card-title",children:N.metadata.title}),N.metadata.badgeDesc&&a.jsx("p",{className:"bdy-feed-card-stats",children:N.metadata.badgeDesc}),a.jsx("p",{className:"bdy-feed-card-cta",children:"Earned a badge on Core Buddy"})]}):N.type==="habits_summary"&&N.metadata?a.jsxs("div",{className:"bdy-feed-card",children:[a.jsx("div",{className:"bdy-feed-card-logo",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF"})}),a.jsx("h3",{className:"bdy-feed-card-title",children:N.metadata.title}),N.metadata.stats?.length>0&&a.jsx("p",{className:"bdy-feed-card-stats",children:N.metadata.stats.map(te=>`${te.value} ${te.label}`).join("    ")}),N.metadata.subtitle&&a.jsx("p",{className:"bdy-feed-card-stats",children:N.metadata.subtitle}),a.jsx("p",{className:"bdy-feed-card-cta",children:"Completed daily habits with Core Buddy"})]}):a.jsxs(a.Fragment,{children:[N.content&&a.jsx("p",{className:"bdy-feed-content",children:Ht(N.content)}),N.imageURL&&a.jsx("div",{className:"bdy-feed-image",children:a.jsx("img",{src:N.imageURL,alt:"Post",loading:"lazy"})})]}),a.jsxs("div",{className:"bdy-feed-actions",children:[a.jsxs("button",{className:`bdy-feed-action-btn${Qe.has(N.id)?" liked":""}`,onClick:()=>Zn(N.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:Qe.has(N.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:N.likeCount||0})]}),a.jsxs("button",{className:`bdy-feed-action-btn${Se.has(N.id)?" active":""}`,onClick:()=>Pn(N.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:N.commentCount||0})]})]}),Se.has(N.id)&&a.jsxs("div",{className:"bdy-feed-comments",children:[ke[N.id]?.length>0?ke[N.id].map(te=>a.jsxs("div",{className:"bdy-feed-comment",children:[a.jsx("div",{className:"bdy-feed-comment-avatar",children:te.authorPhotoURL?a.jsx("img",{src:te.authorPhotoURL,alt:""}):a.jsx("span",{children:Do(te.authorName)})}),a.jsxs("div",{className:"bdy-feed-comment-body",children:[a.jsxs("div",{className:"bdy-feed-comment-bubble",children:[a.jsx("span",{className:"bdy-feed-comment-name",children:te.authorName}),te.replyToName&&a.jsxs("span",{className:"bdy-feed-comment-reply-tag",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"9 14 4 9 9 4"}),a.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),te.replyToName]}),te.content&&a.jsx("span",{className:"bdy-feed-comment-text",children:Ht(te.content)}),te.imageURL&&a.jsx("img",{className:"bdy-feed-comment-img",src:te.imageURL,alt:"Comment",loading:"lazy"})]}),a.jsxs("div",{className:"bdy-feed-comment-row",children:[a.jsx("span",{className:"bdy-feed-comment-time",children:dx(te.createdAt)}),a.jsx("button",{className:"bdy-feed-comment-reply-btn",onClick:()=>Ue(Re=>({...Re,[N.id]:{id:te.id,authorName:te.authorName}})),children:"Reply"}),te.authorId===t?.id&&a.jsx("button",{className:"bdy-feed-comment-del-btn",onClick:()=>Gt(N.id,te.id),"aria-label":"Delete comment",children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]})]},te.id)):a.jsx("p",{className:"bdy-feed-no-comments",children:"No comments yet"}),je[N.id]&&a.jsxs("div",{className:"bdy-feed-replying",children:[a.jsxs("span",{children:["Replying to ",a.jsx("strong",{children:je[N.id].authorName})]}),a.jsx("button",{onClick:()=>Ue(te=>({...te,[N.id]:null})),"aria-label":"Cancel reply",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),Ze[N.id]&&a.jsxs("div",{className:"bdy-feed-comment-img-preview",children:[a.jsx("img",{src:Ze[N.id],alt:"Preview"}),a.jsx("button",{onClick:()=>Mt(N.id),"aria-label":"Remove image",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"bdy-feed-comment-input",style:{position:"relative"},children:[a.jsx("button",{className:"bdy-feed-comment-img-btn",onClick:()=>It.current[N.id]?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:te=>{It.current[N.id]=te},type:"file",accept:"image/*",onChange:te=>Ct(N.id,te),hidden:!0}),a.jsx("input",{type:"text",placeholder:"Comment",value:U[N.id]||"",onChange:te=>{ce(Re=>({...Re,[N.id]:te.target.value})),le(te.target.value,N.id)},onKeyDown:te=>{te.key==="Enter"&&un(N.id)},maxLength:300}),Cn&&qt===N.id&&pn.length>0&&a.jsx("div",{className:"bdy-feed-mention-dropdown",children:pn.map(te=>a.jsxs("button",{className:"bdy-feed-mention-option",onClick:()=>pt(te,N.id),children:[a.jsx("div",{className:"bdy-feed-mention-avatar",children:te.photoURL?a.jsx("img",{src:te.photoURL,alt:""}):a.jsx("span",{children:Do(te.name)})}),a.jsx("span",{children:te.name})]},te.id))}),a.jsx("button",{onClick:()=>un(N.id),disabled:!(U[N.id]||"").trim()&&!$e[N.id]||Ee[N.id],children:Ee[N.id]?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"var(--color-primary)",stroke:"none",children:a.jsx("path",{d:"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"})})})]})]})]},N.id))})}),g==="buddies"&&a.jsx("div",{className:"bdy-section",children:p.length===0?a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("h3",{children:"No buddies yet"}),a.jsx("p",{children:"Find members and send buddy requests to connect!"}),a.jsx("button",{className:"bdy-empty-btn",onClick:()=>y("search"),children:"Find Buddies"})]}):a.jsx("div",{className:"bdy-list",children:p.map(N=>a.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${N.id}`),children:[a.jsx("div",{className:"bdy-avatar",children:N.photoURL?a.jsx("img",{src:N.photoURL,alt:N.name}):a.jsx("span",{children:Do(N.name)})}),a.jsx("div",{className:"bdy-card-info",children:a.jsx("span",{className:"bdy-card-name",children:N.name})}),a.jsx("button",{className:"bdy-view-btn",onClick:te=>{te.stopPropagation(),d(`/client/core-buddy/profile/${N.id}`)},"aria-label":"View profile",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]})})]},N.id))})}),g==="requests"&&a.jsxs("div",{className:"bdy-section",children:[_.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"bdy-section-title",children:"Incoming"}),a.jsx("div",{className:"bdy-list",children:_.map(N=>a.jsxs("div",{className:"bdy-card",children:[a.jsx("div",{className:"bdy-avatar",children:N.fromClient.photoURL?a.jsx("img",{src:N.fromClient.photoURL,alt:N.fromClient.name}):a.jsx("span",{children:Do(N.fromClient.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:N.fromClient.name}),a.jsx("span",{className:"bdy-card-sub",children:"wants to be your buddy"})]}),a.jsxs("div",{className:"bdy-action-pair",children:[a.jsx("button",{className:"bdy-accept-btn",onClick:()=>_t(N),disabled:L===N.reqId,children:L===N.reqId?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}),a.jsx("button",{className:"bdy-decline-btn",onClick:()=>zt(N),disabled:L===N.reqId,children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]},N.reqId))})]}),I.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"bdy-section-title",children:"Sent"}),a.jsx("div",{className:"bdy-list",children:I.map(N=>a.jsxs("div",{className:"bdy-card",children:[a.jsx("div",{className:"bdy-avatar",children:N.toClient?.photoURL?a.jsx("img",{src:N.toClient.photoURL,alt:N.toClient.name}):a.jsx("span",{children:Do(N.toClient?.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:N.toClient?.name}),a.jsx("span",{className:"bdy-card-sub",children:"pending"})]}),a.jsx("button",{className:"bdy-cancel-btn",onClick:()=>fs(N),disabled:L===N.reqId,children:L===N.reqId?a.jsx("div",{className:"bdy-btn-spinner"}):"Cancel"})]},N.reqId))})]}),_.length===0&&I.length===0&&a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),a.jsx("h3",{children:"No pending requests"}),a.jsx("p",{children:"All caught up!"})]})]}),g==="search"&&a.jsxs("div",{className:"bdy-section",children:[a.jsxs("div",{className:"bdy-search-bar",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("input",{type:"text",placeholder:"Search by name...",value:G,onChange:N=>B(N.target.value),autoFocus:!0}),G&&a.jsx("button",{className:"bdy-search-clear",onClick:()=>B(""),children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),G.trim()&&Y.length===0&&a.jsx("div",{className:"bdy-empty bdy-empty-sm",children:a.jsxs("p",{children:['No members found for "',G,'"']})}),Y.length>0&&a.jsx("div",{className:"bdy-list",children:Y.map(N=>a.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${N.id}`),children:[a.jsx("div",{className:"bdy-avatar",children:N.photoURL?a.jsx("img",{src:N.photoURL,alt:N.name}):a.jsx("span",{children:Do(N.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:N.name}),N.isBuddy&&a.jsx("span",{className:"bdy-card-badge",children:"Buddy"})]}),N.isBuddy?a.jsx("span",{className:"bdy-status-icon",children:a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-success)",strokeWidth:"2.5",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}):N.isPendingOut?a.jsx("span",{className:"bdy-pending-label",children:"Pending"}):N.isPendingIn?a.jsx("button",{className:"bdy-accept-btn",onClick:te=>{te.stopPropagation();const Re=_.find(Ie=>Ie.fromId===N.id);Re&&_t(Re)},disabled:!!L,children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}):a.jsx("button",{className:"bdy-add-btn",onClick:te=>{te.stopPropagation(),gt(N.id)},disabled:L===N.id,children:L===N.id?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]},N.id))})]})]})]}),a.jsx(ni,{active:"buddies"}),A&&a.jsxs("div",{className:`toast-notification ${A.type}`,children:[a.jsx("span",{className:"toast-icon",children:A.type==="success"?a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M5 13 L9 17 L19 7"})}):A.type==="error"?a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),a.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),a.jsx("span",{className:"toast-message",children:A.message})]})]})})}function xh(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function cp(s,e){return[s,e].sort().join("_")}const X5=5;function up(s){return s.toISOString().split("T")[0]}function hx(s){if(!s)return"";const e=s instanceof Date?s:s.toDate?s.toDate():new Date(s),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function J5(){const{userId:s}=DS(),{currentUser:e,isClient:t,clientData:i,loading:l}=_r(),{isDark:c,toggleTheme:d}=Bi(),g=qs(),[y,p]=w.useState(null),[b,_]=w.useState("none"),[j,I]=w.useState(null),[F,G]=w.useState(!0),[B,Y]=w.useState(!1),[ee,re]=w.useState(null),[pe,ve]=w.useState([]),[he,L]=w.useState(!1),[E,A]=w.useState(new Set),[V,M]=w.useState(new Set),[P,C]=w.useState({}),[Me,Qe]=w.useState({}),[J,Se]=w.useState({}),[He,ke]=w.useState(!0),[Pe,U]=w.useState(0),[ce,Ee]=w.useState(0),[Ce,je]=w.useState(0),[Ue,$e]=w.useState(new Set),[Xe,Ze]=w.useState(null),[Wt,It]=w.useState(!1),[Cn,ln]=w.useState(!1),[qt,Et]=w.useState([]),[pn,Tt]=w.useState(!1),[dt,le]=w.useState(null),[pt,Ht]=w.useState([]),it=w.useCallback((Z,N="info")=>{re({message:Z,type:N}),setTimeout(()=>re(null),3500)},[]);w.useEffect(()=>{!l&&(!e||!t)&&g("/")},[e,t,l,g]),w.useEffect(()=>{i&&s&&i.id===s&&g("/client/core-buddy",{replace:!0})},[i,s,g]),w.useEffect(()=>{if(!i||!s||i.id===s)return;let Z=!1;return(async()=>{G(!0);try{const Re=(await $t(ut(ye,"clients"))).docs.map(Oe=>({id:Oe.id,...Oe.data()})).find(Oe=>Oe.id===s);if(!Re){Z||G(!1);return}Z||p(Re);const Ie=i.id,De=cp(Ie,s);if((await _s(ze(ye,"buddies",De))).exists())Z||_("buddy");else{const Oe=`${Ie}_${s}`,Nt=await _s(ze(ye,"buddyRequests",Oe));if(Nt.exists()&&Nt.data().status==="pending")Z||(_("pending_out"),I(Oe));else{const bt=`${s}_${Ie}`,lt=await _s(ze(ye,"buddyRequests",bt));lt.exists()&&lt.data().status==="pending"?Z||(_("pending_in"),I(bt)):Z||_("none")}}}catch(N){console.error("Error loading profile:",N)}finally{Z||G(!1)}})(),()=>{Z=!0}},[i,s]),w.useEffect(()=>{if(!s||!y)return;let Z=!1;return(async()=>{ke(!0);try{const N=await $t(tn(ut(ye,"workoutLogs"),Ot("clientId","==",s)));if(Z)return;const te=N.docs.length;U(te);let Re=0;const Ie=N.docs.map(Fe=>Fe.data().date).filter(Boolean).sort().reverse();if(Ie.length>0){const Fe=new Date;let Oe=new Date(Fe);for(let Nt=0;Nt<52;Nt++){const bt=new Date(Oe),lt=bt.getDay(),dn=lt===0?6:lt-1;bt.setDate(bt.getDate()-dn),bt.setHours(0,0,0,0);const hn=new Date(bt);hn.setDate(hn.getDate()+7);const On=up(bt),ms=up(hn);if(Ie.some(Le=>Le>=On&&Le<ms))Re++;else{if(Nt>0)break;break}Oe.setDate(Oe.getDate()-7)}}Z||Ee(Re);let De=0;for(let Fe=0;Fe<30;Fe++){const Oe=new Date;Oe.setDate(Oe.getDate()-Fe);const Nt=up(Oe);try{const bt=await $t(tn(ut(ye,"habitLogs"),Ot("clientId","==",s),Ot("date","==",Nt)));if(bt.empty)break;{const lt=bt.docs[0].data().habits||{};if(Object.values(lt).filter(Boolean).length>=X5)De++;else break}}catch{break}}Z||je(De);try{const Fe=await _s(ze(ye,"coreBuddyBadges",s));if(!Z&&Fe.exists()){const Oe=Fe.data().earned||[];$e(new Set(Oe.map(Nt=>Nt.id)))}}catch(Fe){console.error("Error loading buddy badges:",Fe)}}catch(N){console.error("Error loading buddy stats:",N)}finally{Z||ke(!1)}})(),()=>{Z=!0}},[s,y]),w.useEffect(()=>{if(!i)return;const Z=i.id;(async()=>{try{const[N,te,Re]=await Promise.all([$t(tn(ut(ye,"buddies"),Ot("user1","==",Z))),$t(tn(ut(ye,"buddies"),Ot("user2","==",Z))),$t(ut(ye,"clients"))]),Ie=new Set;[...N.docs,...te.docs].forEach(Fe=>{const Oe=Fe.data();Ie.add(Oe.user1===Z?Oe.user2:Oe.user1)});const De={};Re.docs.forEach(Fe=>{De[Fe.id]=Fe.data()}),Et(Array.from(Ie).filter(Fe=>De[Fe]).map(Fe=>({id:Fe,name:De[Fe].name,photoURL:De[Fe].photoURL||null})))}catch(N){console.error("Error loading buddies for mentions:",N)}})()},[i]);const yt=async(Z,N,te={})=>{if(!(!i||Z===i.id))try{await or(ut(ye,"notifications"),{toId:Z,fromId:i.id,fromName:i.name||"Someone",fromPhotoURL:i.photoURL||null,type:N,read:!1,createdAt:xs(),...te})}catch(Re){console.error("Notification error:",Re),Re.code==="permission-denied"&&it("Notifications blocked  check Firestore rules","error")}},gt=async()=>{Y(!0);try{const Z=`${i.id}_${s}`;await Wn(ze(ye,"buddyRequests",Z),{fromId:i.id,toId:s,status:"pending",createdAt:xs()}),await yt(s,"buddy_request"),_("pending_out"),I(Z),it("Buddy request sent!","success")}catch(Z){console.error(Z),it("Failed to send request","error")}finally{Y(!1)}},_t=async()=>{if(j){Y(!0);try{const Z=cp(i.id,s);await Wn(ze(ye,"buddies",Z),{user1:[i.id,s].sort()[0],user2:[i.id,s].sort()[1],connectedAt:xs()}),await ar(ze(ye,"buddyRequests",j)),await yt(s,"buddy_accept"),_("buddy"),it("Buddy added!","success")}catch(Z){console.error(Z),it("Failed to accept","error")}finally{Y(!1)}}},zt=async()=>{if(j){Y(!0);try{await ar(ze(ye,"buddyRequests",j)),_("none"),it(b==="pending_out"?"Request cancelled":"Request declined","info")}catch(Z){console.error(Z),it("Failed","error")}finally{Y(!1)}}},fs=async()=>{Y(!0);try{const Z=cp(i.id,s);await ar(ze(ye,"buddies",Z)),_("none"),It(!1),it("Buddy removed","info")}catch(Z){console.error(Z),it("Failed to remove","error")}finally{Y(!1)}},rn=w.useCallback(async()=>{if(s){L(!0);try{const N=(await $t(tn(ut(ye,"posts"),Ot("authorId","==",s)))).docs.map(te=>({id:te.id,...te.data()})).sort((te,Re)=>{const Ie=te.createdAt?.toDate?.()||new Date(0);return(Re.createdAt?.toDate?.()||new Date(0))-Ie}).slice(0,30);if(ve(N),i){const te=await $t(tn(ut(ye,"postLikes"),Ot("userId","==",i.id)));A(new Set(te.docs.map(Re=>Re.data().postId)))}}catch(Z){console.error("Error loading journey:",Z)}finally{L(!1)}}},[s,i]);w.useEffect(()=>{!F&&y&&rn()},[F,y,rn]);const Zn=async Z=>{if(window.confirm("Delete this post?"))try{await ar(ze(ye,"posts",Z)),ve(N=>N.filter(te=>te.id!==Z)),it("Post deleted","info")}catch(N){console.error("Delete error:",N),it("Failed to delete","error")}},Fn=async Z=>{if(!i)return;const N=i.id,te=`${Z}_${N}`,Re=E.has(Z),Ie=new Set(E);Re?Ie.delete(Z):Ie.add(Z),A(Ie),ve(De=>De.map(Fe=>Fe.id===Z?{...Fe,likeCount:Math.max(0,(Fe.likeCount||0)+(Re?-1:1))}:Fe));try{if(Re)await ar(ze(ye,"postLikes",te)),await zn(ze(ye,"posts",Z),{likeCount:mi(-1)});else{await Wn(ze(ye,"postLikes",te),{postId:Z,userId:N,createdAt:xs()}),await zn(ze(ye,"posts",Z),{likeCount:mi(1)});const De=pe.find(Fe=>Fe.id===Z);De&&yt(De.authorId,"like",{postId:Z})}}catch(De){console.error("Like error:",De),rn()}},Ln=async Z=>{try{const te=(await $t(tn(ut(ye,"postComments"),Ot("postId","==",Z)))).docs.map(Re=>({id:Re.id,...Re.data()})).sort((Re,Ie)=>{const De=Re.createdAt?.toDate?.()||new Date(0),Fe=Ie.createdAt?.toDate?.()||new Date(0);return De-Fe}).slice(0,50);C(Re=>({...Re,[Z]:te}))}catch(N){console.error("Error loading comments:",N)}},Pn=Z=>{const N=new Set(V);N.has(Z)?N.delete(Z):(N.add(Z),P[Z]||Ln(Z)),M(N)},un=(Z,N)=>{const te=Z.match(/@(\w*)$/);if(te){Tt(!0),le(N);const Re=qt.filter(Ie=>Ie.name&&Ie.name.toLowerCase().includes(te[1].toLowerCase())).slice(0,5);Ht(Re)}else Tt(!1),Ht([])},Gt=(Z,N)=>{const Re=(Me[N]||"").replace(/@\w*$/,`@${Z.name} `);Qe(Ie=>({...Ie,[N]:Re})),Tt(!1),Ht([])},Ct=(Z,N)=>{Qe(te=>({...te,[Z]:N})),un(N,Z)},Mt=async Z=>{const N=(Me[Z]||"").trim();if(!(!N||!i)){Se(te=>({...te,[Z]:!0}));try{await or(ut(ye,"postComments"),{postId:Z,authorId:i.id,authorName:i.name||"Unknown",authorPhotoURL:i.photoURL||null,content:N,createdAt:xs()}),await zn(ze(ye,"posts",Z),{commentCount:mi(1)});const te=pe.find(Ie=>Ie.id===Z);te&&yt(te.authorId,"comment",{postId:Z});const Re=N.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Re){const Ie=new Set;Re.forEach(De=>{const Fe=De.slice(1).trim(),Oe=qt.find(Nt=>Nt.name&&Nt.name.toLowerCase()===Fe.toLowerCase());Oe&&!Ie.has(Oe.id)&&(Ie.add(Oe.id),yt(Oe.id,"mention",{postId:Z}))})}Qe(Ie=>({...Ie,[Z]:""})),ve(Ie=>Ie.map(De=>De.id===Z?{...De,commentCount:(De.commentCount||0)+1}:De)),await Ln(Z)}catch(te){console.error("Comment error:",te),it("Failed to comment","error")}finally{Se(te=>({...te,[Z]:!1}))}}};return l||F||!i?a.jsx("div",{className:"prf-loading",children:a.jsx("div",{className:"prf-spinner"})}):!e||!t?null:y?a.jsx(nl,{children:a.jsxs("div",{className:"prf-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>g(-1),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:c?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"prf-main",children:[a.jsxs("div",{className:"prf-hero",children:[b==="buddy"&&a.jsx("div",{className:"prf-manage-wrap",children:a.jsx("button",{className:"prf-manage-btn",onClick:()=>It(!0),"aria-label":"Manage buddy",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("circle",{cx:"12",cy:"5",r:"2"}),a.jsx("circle",{cx:"12",cy:"12",r:"2"}),a.jsx("circle",{cx:"12",cy:"19",r:"2"})]})})}),a.jsx("div",{className:`prf-avatar-lg${y.photoURL?" tappable":""}`,onClick:()=>y.photoURL&&ln(!0),children:y.photoURL?a.jsx("img",{src:y.photoURL,alt:y.name}):a.jsx("span",{children:xh(y.name)})}),a.jsx("h1",{className:"prf-name",children:y.name}),a.jsxs("div",{className:"prf-buddy-action",children:[b==="none"&&a.jsx("button",{className:"prf-btn prf-btn-primary",onClick:gt,disabled:B,children:B?a.jsx("div",{className:"prf-btn-spinner"}):a.jsxs(a.Fragment,{children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Buddy"]})}),b==="pending_out"&&a.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:zt,disabled:B,children:B?a.jsx("div",{className:"prf-btn-spinner dark"}):"Cancel Request"}),b==="pending_in"&&a.jsxs("div",{className:"prf-btn-pair",children:[a.jsx("button",{className:"prf-btn prf-btn-success",onClick:_t,disabled:B,children:B?a.jsx("div",{className:"prf-btn-spinner"}):"Accept"}),a.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:zt,disabled:B,children:"Decline"})]}),b==="buddy"&&a.jsxs("span",{className:"prf-buddy-label",children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),"Buddies"]})]})]}),He?a.jsx("div",{className:"prf-stats-loading",children:a.jsx("div",{className:"prf-spinner"})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"prf-stats",children:[a.jsxs("div",{className:"prf-stat",children:[a.jsx("span",{className:"prf-stat-value",children:Pe}),a.jsx("span",{className:"prf-stat-label",children:"Workouts"})]}),a.jsxs("div",{className:"prf-stat",children:[a.jsxs("span",{className:"prf-stat-value",children:[ce,a.jsx("span",{className:"prf-stat-unit",children:"wk"})]}),a.jsx("span",{className:"prf-stat-label",children:"Streak"})]})]}),Ce>0&&a.jsx("div",{className:"prf-info-row",children:a.jsxs("div",{className:"prf-info-card info-habit",children:[a.jsx("div",{className:"prf-info-icon",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]})}),a.jsxs("div",{className:"prf-info-text",children:[a.jsxs("span",{className:"prf-info-value",children:[Ce," day",Ce!==1?"s":""]}),a.jsx("span",{className:"prf-info-sub",children:"Habit Streak"})]})]})}),(()=>{const Z=Pr.filter(N=>Ue.has(N.id));return Z.length>0?a.jsxs("div",{className:"prf-section prf-badges-section",children:[a.jsxs("h2",{className:"prf-section-title",children:[`${y.name?.split(" ")[0]}'s Badges`," ",a.jsxs("span",{className:"prf-badges-tally",children:[Z.length,"/",Pr.length]})]}),a.jsx("div",{className:"prf-badges-carousel",children:Z.map(N=>a.jsxs("button",{className:"prf-carousel-badge",onClick:()=>Ze(N),children:[a.jsx("img",{src:N.img,alt:N.name,className:"prf-carousel-badge-img",loading:"lazy"}),a.jsx("span",{className:"prf-carousel-badge-name",children:N.name})]},N.id))})]}):null})()]}),a.jsxs("div",{className:"prf-section",children:[a.jsx("h2",{className:"prf-section-title",children:`${y.name?.split(" ")[0]}'s Journey`}),he?a.jsx("div",{className:"journey-loading",children:a.jsx("div",{className:"prf-spinner"})}):pe.length===0?a.jsxs("div",{className:"journey-empty",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("p",{children:"No posts yet"})]}):a.jsx("div",{className:"journey-list",children:pe.map(Z=>a.jsxs("div",{className:"journey-post",children:[a.jsxs("div",{className:"journey-post-header",children:[a.jsx("div",{className:"journey-post-avatar",children:Z.authorPhotoURL?a.jsx("img",{src:Z.authorPhotoURL,alt:""}):a.jsx("span",{children:xh(Z.authorName)})}),a.jsxs("div",{className:"journey-post-meta",children:[a.jsx("span",{className:"journey-post-name",children:Z.authorName}),a.jsx("span",{className:"journey-post-time",children:hx(Z.createdAt)})]}),Z.authorId===i.id&&a.jsx("button",{className:"journey-delete-btn",onClick:()=>Zn(Z.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),Z.type==="workout_summary"&&Z.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:Z.metadata.title}),Z.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:Z.metadata.stats.map(N=>`${N.value} ${N.label}`).join("    ")}),!Z.metadata.stats?.length&&Z.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:Z.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed a workout using Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):Z.type==="badge_earned"&&Z.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame journey-card-logo-badge",children:(()=>{const N=Pr.find(te=>te.id===Z.metadata.badgeId);return N?.img?a.jsx("img",{src:N.img,alt:Z.metadata.title,className:"journey-card-logo-img",loading:"lazy"}):a.jsx("img",{src:"/Logo.webp",alt:Z.metadata.title,className:"journey-card-logo-img"})})()}),a.jsx("h3",{className:"journey-card-title",children:Z.metadata.title}),Z.metadata.badgeDesc&&a.jsx("p",{className:"journey-card-stats-line",children:Z.metadata.badgeDesc}),a.jsx("p",{className:"journey-card-cta",children:"I just earned a badge on Core Buddy"}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):Z.type==="habits_summary"&&Z.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:Z.metadata.title}),Z.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:Z.metadata.stats.map(N=>`${N.value} ${N.label}`).join("    ")}),Z.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:Z.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed my daily habits with Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):a.jsxs(a.Fragment,{children:[Z.content&&a.jsx("p",{className:"journey-post-content",children:Z.content}),Z.imageURL&&a.jsx("div",{className:"journey-post-image",children:a.jsx("img",{src:Z.imageURL,alt:"Post",loading:"lazy"})})]}),a.jsxs("div",{className:"journey-post-actions",children:[a.jsxs("button",{className:`journey-action-btn${E.has(Z.id)?" liked":""}`,onClick:()=>Fn(Z.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:E.has(Z.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:Z.likeCount||0})]}),a.jsxs("button",{className:`journey-action-btn${V.has(Z.id)?" active":""}`,onClick:()=>Pn(Z.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:Z.commentCount||0})]})]}),V.has(Z.id)&&a.jsxs("div",{className:"journey-comments",children:[P[Z.id]?.length>0?P[Z.id].map(N=>a.jsxs("div",{className:"journey-comment",children:[a.jsx("div",{className:"journey-comment-avatar",onClick:()=>g(`/client/core-buddy/profile/${N.authorId}`),children:N.authorPhotoURL?a.jsx("img",{src:N.authorPhotoURL,alt:""}):a.jsx("span",{children:xh(N.authorName)})}),a.jsxs("div",{className:"journey-comment-body",children:[a.jsxs("div",{className:"journey-comment-bubble",children:[a.jsx("span",{className:"journey-comment-name",children:N.authorName}),a.jsx("span",{className:"journey-comment-text",children:N.content})]}),a.jsx("span",{className:"journey-comment-time",children:hx(N.createdAt)})]})]},N.id)):a.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),a.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[a.jsx("input",{type:"text",placeholder:"Comment... (@ to mention)",value:Me[Z.id]||"",onChange:N=>Ct(Z.id,N.target.value),onKeyDown:N=>{N.key==="Enter"&&Mt(Z.id)},maxLength:300}),pn&&dt===Z.id&&pt.length>0&&a.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:pt.map(N=>a.jsxs("button",{className:"mention-option",onClick:()=>Gt(N,Z.id),children:[a.jsx("div",{className:"mention-option-avatar",children:N.photoURL?a.jsx("img",{src:N.photoURL,alt:""}):a.jsx("span",{children:xh(N.name)})}),a.jsx("span",{children:N.name})]},N.id))}),a.jsx("button",{onClick:()=>Mt(Z.id),disabled:!(Me[Z.id]||"").trim()||J[Z.id],children:J[Z.id]?a.jsx("div",{className:"journey-btn-spinner-sm"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),a.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},Z.id))})]})]}),a.jsx(ni,{active:"buddies"}),Cn&&y.photoURL&&a.jsx("div",{className:"prf-photo-overlay",onClick:()=>ln(!1),children:a.jsx("img",{src:y.photoURL,alt:y.name,className:"prf-photo-overlay-img"})}),Xe&&a.jsx("div",{className:"prf-badge-overlay",onClick:()=>Ze(null),children:a.jsxs("div",{className:"prf-badge-overlay-content",onClick:Z=>Z.stopPropagation(),children:[a.jsx("img",{src:Xe.img,alt:Xe.name,className:"prf-badge-overlay-img"}),a.jsx("h3",{className:"prf-badge-overlay-name",children:Xe.name}),a.jsx("p",{className:"prf-badge-overlay-desc",children:Xe.desc}),a.jsx("button",{className:"prf-badge-overlay-close",onClick:()=>Ze(null),children:"Close"})]})}),Wt&&a.jsx("div",{className:"prf-confirm-overlay",onClick:()=>It(!1),children:a.jsxs("div",{className:"prf-confirm-card",onClick:Z=>Z.stopPropagation(),children:[a.jsx("div",{className:"prf-confirm-icon",children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("line",{x1:"18",y1:"11",x2:"23",y2:"11"})]})}),a.jsx("h3",{className:"prf-confirm-title",children:"Remove Buddy"}),a.jsxs("p",{className:"prf-confirm-text",children:["Are you sure you want to remove ",y.name?.split(" ")[0]," as a buddy?"]}),a.jsxs("div",{className:"prf-confirm-actions",children:[a.jsx("button",{className:"prf-confirm-btn prf-confirm-cancel",onClick:()=>It(!1),children:"Cancel"}),a.jsx("button",{className:"prf-confirm-btn prf-confirm-remove",onClick:fs,disabled:B,children:B?a.jsx("div",{className:"prf-btn-spinner dark"}):"Remove"})]})]})}),ee&&a.jsxs("div",{className:`toast-notification ${ee.type}`,children:[a.jsx("span",{className:"toast-icon",children:ee.type==="success"?a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M5 13 L9 17 L19 7"})}):ee.type==="error"?a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),a.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),a.jsx("span",{className:"toast-message",children:ee.message})]})]})}):a.jsxs("div",{className:"prf-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>g(-1),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions"})]})}),a.jsx("main",{className:"prf-main",children:a.jsx("p",{style:{textAlign:"center",color:"var(--text-tertiary)",padding:"40px 0"},children:"User not found"})}),a.jsx(ni,{active:"buddies"})]})}const dp=[{text:"Build your dashboard...",bold:"your way"},{text:"Pick what matters to you...",bold:"nothing else"},{text:"Your goals, your layout...",bold:"your rules"}],fx=[{id:"stats",label:"Stats Rings",desc:"Programme %, workouts this week, habits today",icon:"rings",defaultOn:!0},{id:"workouts",label:"Workouts",desc:"Sessions this week and total count",icon:"dumbbell",defaultOn:!0},{id:"habits",label:"Habits",desc:"Daily habit tracker dots",icon:"check",defaultOn:!0},{id:"pbs",label:"Personal Bests",desc:"Your top lifts at a glance",icon:"trophy"},{id:"nutrition",label:"Nutrition",desc:"Macro rings  protein, carbs, fats, cals",icon:"apple"},{id:"leaderboard",label:"Leaderboard",desc:"See where you rank among buddies",icon:"podium"},{id:"journey",label:"Journey",desc:"Your posts, likes and comments feed",icon:"feed"},{id:"coach",label:"Coach Message",desc:"Motivational nudge from Buddy",icon:"message",defaultOn:!0},{id:"nudge",label:"Smart Nudge",desc:"Contextual reminder of what to do next",icon:"lightbulb"}];function Z5(s){switch(s){case"rings":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("circle",{cx:"12",cy:"12",r:"6"}),a.jsx("circle",{cx:"12",cy:"12",r:"2"})]});case"dumbbell":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M6.5 6.5h11v11h-11z",strokeLinejoin:"round"}),a.jsx("line",{x1:"2",y1:"12",x2:"6.5",y2:"12"}),a.jsx("line",{x1:"17.5",y1:"12",x2:"22",y2:"12"})]});case"check":return a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})});case"trophy":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M6 9H3V6a1 1 0 0 1 1-1h2M18 9h3V6a1 1 0 0 0-1-1h-2"}),a.jsx("path",{d:"M6 5h12v7a6 6 0 0 1-12 0V5z"}),a.jsx("path",{d:"M9 21h6"}),a.jsx("path",{d:"M12 17v4"})]});case"apple":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M12 3c-1.5 0-3 1-3 1s-3-.5-4.5 1.5S3 9 3 12s1.5 6 3 8 3 3 6 3 4.5-1 6-3 3-5 3-8-1.5-4-3-6.5S13.5 3 12 3z"}),a.jsx("path",{d:"M12 3c0 0 1-2 3-2"})]});case"podium":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"2",y:"14",width:"6",height:"8",rx:"1"}),a.jsx("rect",{x:"9",y:"8",width:"6",height:"14",rx:"1"}),a.jsx("rect",{x:"16",y:"11",width:"6",height:"11",rx:"1"})]});case"medal":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"15",r:"6"}),a.jsx("path",{d:"M8.21 13.89L7 2h10l-1.21 11.89"})]});case"feed":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"3"}),a.jsx("line",{x1:"3",y1:"9",x2:"21",y2:"9"}),a.jsx("line",{x1:"3",y1:"15",x2:"21",y2:"15"})]});case"message":return a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})});case"lightbulb":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 18h6"}),a.jsx("path",{d:"M10 22h4"}),a.jsx("path",{d:"M12 2a7 7 0 0 0-4 12.7V17h8v-2.3A7 7 0 0 0 12 2z"})]});default:return null}}function eL(){const s=qs(),{clientData:e,currentUser:t,updateClientData:i,resolveClient:l}=_r(),[c,d]=w.useState({hours:0,minutes:0,seconds:0}),[g,y]=w.useState(0),[p,b]=w.useState(0),[_,j]=w.useState(null),[I,F]=w.useState(!1),G=w.useRef(null),[B,Y]=w.useState(()=>{const P=e?.dashboardWidgets;return P&&Array.isArray(P)?P:fx.filter(C=>C.defaultOn).map(C=>C.id)}),[ee,re]=w.useState(!1),[pe,ve]=w.useState(!1),[he,L]=w.useState(null);w.useEffect(()=>{e?.photoURL&&j(e.photoURL)},[e?.photoURL]),w.useEffect(()=>{const P=()=>{const Me=new Date,Qe=new Date(Me);Qe.setHours(23,59,59,999);const J=Qe-Me;d({hours:Math.floor(J/36e5),minutes:Math.floor(J%36e5/6e4),seconds:Math.floor(J%6e4/1e3)}),y(60-Math.floor(J%6e4/1e3))};P();const C=setInterval(P,1e3);return()=>clearInterval(C)},[]),w.useEffect(()=>{const P=setInterval(()=>b(C=>(C+1)%dp.length),8e3);return()=>clearInterval(P)},[]);const E=async P=>{const C=P.target.files?.[0];if(!(!C||!e?.id)){F(!0);try{const Me=ca(ua,`profilePhotos/${e.id}`);await wu(Me,C);const Qe=await io(Me);await zn(ze(ye,"clients",e.id),{photoURL:Qe}),j(Qe),i({photoURL:Qe})}catch(Me){console.error("Photo upload error:",Me)}finally{F(!1)}}},A=P=>{ve(!1),Y(C=>C.includes(P)?C.filter(Me=>Me!==P):[...C,P])},V=(P,C)=>{ve(!1),Y(Me=>{const Qe=Me.indexOf(P);if(Qe<0)return Me;const J=Qe+C;if(J<0||J>=Me.length)return Me;const Se=[...Me];return[Se[Qe],Se[J]]=[Se[J],Se[Qe]],Se})},M=async()=>{re(!0),L(null);try{const P=e||await l();if(!P?.id){L("Could not find your profile. Try refreshing."),re(!1);return}await zn(ze(ye,"clients",P.id),{dashboardWidgets:B}),i({dashboardWidgets:B}),ve(!0)}catch(P){console.error("Save config error:",P),L("Save failed  please try again.")}finally{re(!1)}};return a.jsx(nl,{children:a.jsxs("div",{className:"bldr-page",children:[a.jsxs("div",{className:"bldr-container",children:[a.jsxs("div",{className:"bldr-header",children:[a.jsx("button",{className:"bldr-back",onClick:()=>s("/client/core-buddy"),children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("h1",{className:"bldr-title",children:"Build Your Dashboard"})]}),a.jsxs("div",{className:"bldr-ring-container",children:[a.jsxs("div",{className:"bldr-ring",children:[a.jsx("svg",{className:"bldr-ring-svg",viewBox:"0 0 200 200",children:Uj.map((P,C)=>a.jsx("line",{x1:P.x1,y1:P.y1,x2:P.x2,y2:P.y2,className:`bldr-tick ${C<g?"elapsed":"remaining"}`,strokeWidth:P.thick?"3":"2"},C))}),a.jsxs("div",{className:"bldr-ring-center",children:[a.jsxs("div",{className:"bldr-ring-photo",onClick:()=>G.current?.click(),children:[a.jsx("img",{src:_||"/Logo.webp",alt:_?"Profile":"Mind Core Fitness"}),a.jsx("div",{className:`bldr-photo-overlay${I?" uploading":""}`,children:I?a.jsx("div",{className:"bldr-photo-spinner"}):a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),a.jsx("input",{ref:G,type:"file",accept:"image/*",onChange:E,style:{display:"none"}})]}),!_&&!I&&a.jsx("div",{className:"bldr-photo-badge",onClick:()=>G.current?.click(),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),a.jsxs("div",{className:"bldr-countdown",children:[a.jsx("span",{className:"bldr-timer-digit",children:String(c.hours).padStart(2,"0")}),a.jsx("span",{className:"bldr-timer-colon",children:":"}),a.jsx("span",{className:"bldr-timer-digit",children:String(c.minutes).padStart(2,"0")}),a.jsx("span",{className:"bldr-timer-colon",children:":"}),a.jsx("span",{className:"bldr-timer-digit bldr-timer-sec",children:String(c.seconds).padStart(2,"0")})]}),a.jsx("span",{className:"bldr-ring-label",children:"remaining today"}),a.jsxs("p",{className:"bldr-tagline",children:[dp[p].text," ",a.jsx("strong",{children:dp[p].bold})]})]}),a.jsxs("div",{className:"bldr-section",children:[a.jsx("h2",{className:"bldr-section-title",children:"Choose Your Widgets"}),a.jsx("p",{className:"bldr-section-desc",children:"The countdown ring and your profile always stay at the top. Pick what goes below."}),a.jsx("div",{className:"bldr-widgets-list",children:fx.map(P=>{const C=B.includes(P.id),Me=B.indexOf(P.id);return a.jsxs("div",{className:`bldr-widget-card${C?" active":""}`,children:[a.jsx("div",{className:"bldr-widget-icon",children:Z5(P.icon)}),a.jsxs("div",{className:"bldr-widget-info",children:[a.jsx("div",{className:"bldr-widget-label",children:P.label}),a.jsx("div",{className:"bldr-widget-desc",children:P.desc})]}),a.jsxs("div",{className:"bldr-widget-actions",children:[C&&a.jsxs("div",{className:"bldr-widget-order",children:[a.jsx("button",{className:"bldr-order-btn",onClick:()=>V(P.id,-1),disabled:Me===0,"aria-label":"Move up",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M18 15l-6-6-6 6"})})}),a.jsx("span",{className:"bldr-order-num",children:Me+1}),a.jsx("button",{className:"bldr-order-btn",onClick:()=>V(P.id,1),disabled:Me===B.length-1,"aria-label":"Move down",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M6 9l6 6 6-6"})})})]}),a.jsx("button",{className:`bldr-toggle${C?" on":""}`,onClick:()=>A(P.id),"aria-label":C?`Remove ${P.label}`:`Add ${P.label}`,children:a.jsx("div",{className:"bldr-toggle-thumb"})})]})]},P.id)})})]}),a.jsxs("div",{className:"bldr-save-wrap",children:[a.jsx("button",{className:`bldr-save-btn${pe?" saved":""}`,onClick:M,disabled:ee||pe,children:ee?"Saving...":pe?"Saved":"Save Dashboard"}),he&&a.jsx("p",{className:"bldr-save-error",children:he}),pe&&a.jsx("button",{className:"bldr-view-btn",onClick:()=>s("/client/core-buddy"),children:"View Dashboard"})]})]}),a.jsx(ni,{active:"home"})]})})}const Bj="@firebase/installations",_0="0.6.19";const zj=1e4,Fj=`w:${_0}`,Hj="FIS_v2",tL="https://firebaseinstallations.googleapis.com/v1",nL=3600*1e3,sL="installations",rL="Installations";const iL={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Go=new Yo(sL,rL,iL);function qj(s){return s instanceof wi&&s.code.includes("request-failed")}function $j({projectId:s}){return`${tL}/projects/${s}/installations`}function Wj(s){return{token:s.token,requestStatus:2,expiresIn:oL(s.expiresIn),creationTime:Date.now()}}async function Gj(s,e){const i=(await e.json()).error;return Go.create("request-failed",{requestName:s,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function Kj({apiKey:s}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":s})}function aL(s,{refreshToken:e}){const t=Kj(s);return t.append("Authorization",lL(e)),t}async function Yj(s){const e=await s();return e.status>=500&&e.status<600?s():e}function oL(s){return Number(s.replace("s","000"))}function lL(s){return`${Hj} ${s}`}async function cL({appConfig:s,heartbeatServiceProvider:e},{fid:t}){const i=$j(s),l=Kj(s),c=e.getImmediate({optional:!0});if(c){const p=await c.getHeartbeatsHeader();p&&l.append("x-firebase-client",p)}const d={fid:t,authVersion:Hj,appId:s.appId,sdkVersion:Fj},g={method:"POST",headers:l,body:JSON.stringify(d)},y=await Yj(()=>fetch(i,g));if(y.ok){const p=await y.json();return{fid:p.fid||t,registrationStatus:2,refreshToken:p.refreshToken,authToken:Wj(p.authToken)}}else throw await Gj("Create Installation",y)}function Qj(s){return new Promise(e=>{setTimeout(e,s)})}function uL(s){return btoa(String.fromCharCode(...s)).replace(/\+/g,"-").replace(/\//g,"_")}const dL=/^[cdef][\w-]{21}$/,Jp="";function hL(){try{const s=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(s),s[0]=112+s[0]%16;const t=fL(s);return dL.test(t)?t:Jp}catch{return Jp}}function fL(s){return uL(s).substr(0,22)}function Mf(s){return`${s.appName}!${s.appId}`}const Xj=new Map;function Jj(s,e){const t=Mf(s);Zj(t,e),mL(t,e)}function Zj(s,e){const t=Xj.get(s);if(t)for(const i of t)i(e)}function mL(s,e){const t=gL();t&&t.postMessage({key:s,fid:e}),pL()}let Vo=null;function gL(){return!Vo&&"BroadcastChannel"in self&&(Vo=new BroadcastChannel("[Firebase] FID Change"),Vo.onmessage=s=>{Zj(s.data.key,s.data.fid)}),Vo}function pL(){Xj.size===0&&Vo&&(Vo.close(),Vo=null)}const yL="firebase-installations-database",vL=1,Ko="firebase-installations-store";let hp=null;function k0(){return hp||(hp=lf(yL,vL,{upgrade:(s,e)=>{e===0&&s.createObjectStore(Ko)}})),hp}async function sf(s,e){const t=Mf(s),l=(await k0()).transaction(Ko,"readwrite"),c=l.objectStore(Ko),d=await c.get(t);return await c.put(e,t),await l.done,(!d||d.fid!==e.fid)&&Jj(s,e.fid),e}async function eE(s){const e=Mf(s),i=(await k0()).transaction(Ko,"readwrite");await i.objectStore(Ko).delete(e),await i.done}async function Df(s,e){const t=Mf(s),l=(await k0()).transaction(Ko,"readwrite"),c=l.objectStore(Ko),d=await c.get(t),g=e(d);return g===void 0?await c.delete(t):await c.put(g,t),await l.done,g&&(!d||d.fid!==g.fid)&&Jj(s,g.fid),g}async function j0(s){let e;const t=await Df(s.appConfig,i=>{const l=bL(i),c=wL(s,l);return e=c.registrationPromise,c.installationEntry});return t.fid===Jp?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function bL(s){const e=s||{fid:hL(),registrationStatus:0};return tE(e)}function wL(s,e){if(e.registrationStatus===0){if(!navigator.onLine){const l=Promise.reject(Go.create("app-offline"));return{installationEntry:e,registrationPromise:l}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=xL(s,t);return{installationEntry:t,registrationPromise:i}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:_L(s)}:{installationEntry:e}}async function xL(s,e){try{const t=await cL(s,e);return sf(s.appConfig,t)}catch(t){throw qj(t)&&t.customData.serverCode===409?await eE(s.appConfig):await sf(s.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function _L(s){let e=await mx(s.appConfig);for(;e.registrationStatus===1;)await Qj(100),e=await mx(s.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:i}=await j0(s);return i||t}return e}function mx(s){return Df(s,e=>{if(!e)throw Go.create("installation-not-found");return tE(e)})}function tE(s){return kL(s)?{fid:s.fid,registrationStatus:0}:s}function kL(s){return s.registrationStatus===1&&s.registrationTime+zj<Date.now()}async function jL({appConfig:s,heartbeatServiceProvider:e},t){const i=EL(s,t),l=aL(s,t),c=e.getImmediate({optional:!0});if(c){const p=await c.getHeartbeatsHeader();p&&l.append("x-firebase-client",p)}const d={installation:{sdkVersion:Fj,appId:s.appId}},g={method:"POST",headers:l,body:JSON.stringify(d)},y=await Yj(()=>fetch(i,g));if(y.ok){const p=await y.json();return Wj(p)}else throw await Gj("Generate Auth Token",y)}function EL(s,{fid:e}){return`${$j(s)}/${e}/authTokens:generate`}async function E0(s,e=!1){let t;const i=await Df(s.appConfig,c=>{if(!nE(c))throw Go.create("not-registered");const d=c.authToken;if(!e&&CL(d))return c;if(d.requestStatus===1)return t=TL(s,e),c;{if(!navigator.onLine)throw Go.create("app-offline");const g=AL(c);return t=SL(s,g),g}});return t?await t:i.authToken}async function TL(s,e){let t=await gx(s.appConfig);for(;t.authToken.requestStatus===1;)await Qj(100),t=await gx(s.appConfig);const i=t.authToken;return i.requestStatus===0?E0(s,e):i}function gx(s){return Df(s,e=>{if(!nE(e))throw Go.create("not-registered");const t=e.authToken;return RL(t)?{...e,authToken:{requestStatus:0}}:e})}async function SL(s,e){try{const t=await jL(s,e),i={...e,authToken:t};return await sf(s.appConfig,i),t}catch(t){if(qj(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await eE(s.appConfig);else{const i={...e,authToken:{requestStatus:0}};await sf(s.appConfig,i)}throw t}}function nE(s){return s!==void 0&&s.registrationStatus===2}function CL(s){return s.requestStatus===2&&!NL(s)}function NL(s){const e=Date.now();return e<s.creationTime||s.creationTime+s.expiresIn<e+nL}function AL(s){const e={requestStatus:1,requestTime:Date.now()};return{...s,authToken:e}}function RL(s){return s.requestStatus===1&&s.requestTime+zj<Date.now()}async function IL(s){const e=s,{installationEntry:t,registrationPromise:i}=await j0(e);return i?i.catch(console.error):E0(e).catch(console.error),t.fid}async function ML(s,e=!1){const t=s;return await DL(t),(await E0(t,e)).token}async function DL(s){const{registrationPromise:e}=await j0(s);e&&await e}function LL(s){if(!s||!s.options)throw fp("App Configuration");if(!s.name)throw fp("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!s.options[t])throw fp(t);return{appName:s.name,projectId:s.options.projectId,apiKey:s.options.apiKey,appId:s.options.appId}}function fp(s){return Go.create("missing-app-config-values",{valueName:s})}const sE="installations",PL="installations-internal",OL=s=>{const e=s.getProvider("app").getImmediate(),t=LL(e),i=Qo(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},VL=s=>{const e=s.getProvider("app").getImmediate(),t=Qo(e,sE).getImmediate();return{getId:()=>IL(t),getToken:l=>ML(t,l)}};function UL(){yi(new ei(sE,OL,"PUBLIC")),yi(new ei(PL,VL,"PRIVATE"))}UL();xr(Bj,_0);xr(Bj,_0,"esm2020");const BL="/firebase-messaging-sw.js",zL="/firebase-cloud-messaging-push-scope",rE="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",FL="https://fcmregistrations.googleapis.com/v1",iE="google.c.a.c_id",HL="google.c.a.c_l",qL="google.c.a.ts",$L="google.c.a.e",px=1e4;var yx;(function(s){s[s.DATA_MESSAGE=1]="DATA_MESSAGE",s[s.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(yx||(yx={}));var Iu;(function(s){s.PUSH_RECEIVED="push-received",s.NOTIFICATION_CLICKED="notification-clicked"})(Iu||(Iu={}));function ia(s){const e=new Uint8Array(s);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function WL(s){const e="=".repeat((4-s.length%4)%4),t=(s+e).replace(/\-/g,"+").replace(/_/g,"/"),i=atob(t),l=new Uint8Array(i.length);for(let c=0;c<i.length;++c)l[c]=i.charCodeAt(c);return l}const mp="fcm_token_details_db",GL=5,vx="fcm_token_object_Store";async function KL(s){if("databases"in indexedDB&&!(await indexedDB.databases()).map(c=>c.name).includes(mp))return null;let e=null;return(await lf(mp,GL,{upgrade:async(i,l,c,d)=>{if(l<2||!i.objectStoreNames.contains(vx))return;const g=d.objectStore(vx),y=await g.index("fcmSenderId").get(s);if(await g.clear(),!!y){if(l===2){const p=y;if(!p.auth||!p.p256dh||!p.endpoint)return;e={token:p.fcmToken,createTime:p.createTime??Date.now(),subscriptionOptions:{auth:p.auth,p256dh:p.p256dh,endpoint:p.endpoint,swScope:p.swScope,vapidKey:typeof p.vapidKey=="string"?p.vapidKey:ia(p.vapidKey)}}}else if(l===3){const p=y;e={token:p.fcmToken,createTime:p.createTime,subscriptionOptions:{auth:ia(p.auth),p256dh:ia(p.p256dh),endpoint:p.endpoint,swScope:p.swScope,vapidKey:ia(p.vapidKey)}}}else if(l===4){const p=y;e={token:p.fcmToken,createTime:p.createTime,subscriptionOptions:{auth:ia(p.auth),p256dh:ia(p.p256dh),endpoint:p.endpoint,swScope:p.swScope,vapidKey:ia(p.vapidKey)}}}}}})).close(),await Bg(mp),await Bg("fcm_vapid_details_db"),await Bg("undefined"),YL(e)?e:null}function YL(s){if(!s||!s.subscriptionOptions)return!1;const{subscriptionOptions:e}=s;return typeof s.createTime=="number"&&s.createTime>0&&typeof s.token=="string"&&s.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}const QL="firebase-messaging-database",XL=1,Mu="firebase-messaging-store";let gp=null;function aE(){return gp||(gp=lf(QL,XL,{upgrade:(s,e)=>{e===0&&s.createObjectStore(Mu)}})),gp}async function JL(s){const e=oE(s),i=await(await aE()).transaction(Mu).objectStore(Mu).get(e);if(i)return i;{const l=await KL(s.appConfig.senderId);if(l)return await T0(s,l),l}}async function T0(s,e){const t=oE(s),l=(await aE()).transaction(Mu,"readwrite");return await l.objectStore(Mu).put(e,t),await l.done,e}function oE({appConfig:s}){return s.appId}const ZL={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},dr=new Yo("messaging","Messaging",ZL);async function eP(s,e){const t=await C0(s),i=lE(e),l={method:"POST",headers:t,body:JSON.stringify(i)};let c;try{c=await(await fetch(S0(s.appConfig),l)).json()}catch(d){throw dr.create("token-subscribe-failed",{errorInfo:d?.toString()})}if(c.error){const d=c.error.message;throw dr.create("token-subscribe-failed",{errorInfo:d})}if(!c.token)throw dr.create("token-subscribe-no-token");return c.token}async function tP(s,e){const t=await C0(s),i=lE(e.subscriptionOptions),l={method:"PATCH",headers:t,body:JSON.stringify(i)};let c;try{c=await(await fetch(`${S0(s.appConfig)}/${e.token}`,l)).json()}catch(d){throw dr.create("token-update-failed",{errorInfo:d?.toString()})}if(c.error){const d=c.error.message;throw dr.create("token-update-failed",{errorInfo:d})}if(!c.token)throw dr.create("token-update-no-token");return c.token}async function nP(s,e){const i={method:"DELETE",headers:await C0(s)};try{const c=await(await fetch(`${S0(s.appConfig)}/${e}`,i)).json();if(c.error){const d=c.error.message;throw dr.create("token-unsubscribe-failed",{errorInfo:d})}}catch(l){throw dr.create("token-unsubscribe-failed",{errorInfo:l?.toString()})}}function S0({projectId:s}){return`${FL}/projects/${s}/registrations`}async function C0({appConfig:s,installations:e}){const t=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":s.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})}function lE({p256dh:s,auth:e,endpoint:t,vapidKey:i}){const l={web:{endpoint:t,auth:e,p256dh:s}};return i!==rE&&(l.web.applicationPubKey=i),l}const sP=10080*60*1e3;async function rP(s){const e=await aP(s.swRegistration,s.vapidKey),t={vapidKey:s.vapidKey,swScope:s.swRegistration.scope,endpoint:e.endpoint,auth:ia(e.getKey("auth")),p256dh:ia(e.getKey("p256dh"))},i=await JL(s.firebaseDependencies);if(i){if(oP(i.subscriptionOptions,t))return Date.now()>=i.createTime+sP?iP(s,{token:i.token,createTime:Date.now(),subscriptionOptions:t}):i.token;try{await nP(s.firebaseDependencies,i.token)}catch(l){console.warn(l)}return bx(s.firebaseDependencies,t)}else return bx(s.firebaseDependencies,t)}async function iP(s,e){try{const t=await tP(s.firebaseDependencies,e),i={...e,token:t,createTime:Date.now()};return await T0(s.firebaseDependencies,i),t}catch(t){throw t}}async function bx(s,e){const i={token:await eP(s,e),createTime:Date.now(),subscriptionOptions:e};return await T0(s,i),i.token}async function aP(s,e){const t=await s.pushManager.getSubscription();return t||s.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:WL(e)})}function oP(s,e){const t=e.vapidKey===s.vapidKey,i=e.endpoint===s.endpoint,l=e.auth===s.auth,c=e.p256dh===s.p256dh;return t&&i&&l&&c}function wx(s){const e={from:s.from,collapseKey:s.collapse_key,messageId:s.fcmMessageId};return lP(e,s),cP(e,s),uP(e,s),e}function lP(s,e){if(!e.notification)return;s.notification={};const t=e.notification.title;t&&(s.notification.title=t);const i=e.notification.body;i&&(s.notification.body=i);const l=e.notification.image;l&&(s.notification.image=l);const c=e.notification.icon;c&&(s.notification.icon=c)}function cP(s,e){e.data&&(s.data=e.data)}function uP(s,e){if(!e.fcmOptions&&!e.notification?.click_action)return;s.fcmOptions={};const t=e.fcmOptions?.link??e.notification?.click_action;t&&(s.fcmOptions.link=t);const i=e.fcmOptions?.analytics_label;i&&(s.fcmOptions.analyticsLabel=i)}function dP(s){return typeof s=="object"&&!!s&&iE in s}function hP(s){if(!s||!s.options)throw pp("App Configuration Object");if(!s.name)throw pp("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=s;for(const i of e)if(!t[i])throw pp(i);return{appName:s.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}function pp(s){return dr.create("missing-app-config-values",{valueName:s})}class fP{constructor(e,t,i){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const l=hP(e);this.firebaseDependencies={app:e,appConfig:l,installations:t,analyticsProvider:i}}_delete(){return Promise.resolve()}}async function mP(s){try{s.swRegistration=await navigator.serviceWorker.register(BL,{scope:zL}),s.swRegistration.update().catch(()=>{}),await gP(s.swRegistration)}catch(e){throw dr.create("failed-service-worker-registration",{browserErrorMessage:e?.message})}}async function gP(s){return new Promise((e,t)=>{const i=setTimeout(()=>t(new Error(`Service worker not registered after ${px} ms`)),px),l=s.installing||s.waiting;s.active?(clearTimeout(i),e()):l?l.onstatechange=c=>{c.target?.state==="activated"&&(l.onstatechange=null,clearTimeout(i),e())}:(clearTimeout(i),t(new Error("No incoming service worker found.")))})}async function pP(s,e){if(!e&&!s.swRegistration&&await mP(s),!(!e&&s.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw dr.create("invalid-sw-registration");s.swRegistration=e}}async function yP(s,e){e?s.vapidKey=e:s.vapidKey||(s.vapidKey=rE)}async function cE(s,e){if(!navigator)throw dr.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw dr.create("permission-blocked");return await yP(s,e?.vapidKey),await pP(s,e?.serviceWorkerRegistration),rP(s)}async function vP(s,e,t){const i=bP(e);(await s.firebaseDependencies.analyticsProvider.get()).logEvent(i,{message_id:t[iE],message_name:t[HL],message_time:t[qL],message_device_time:Math.floor(Date.now()/1e3)})}function bP(s){switch(s){case Iu.NOTIFICATION_CLICKED:return"notification_open";case Iu.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}async function wP(s,e){const t=e.data;if(!t.isFirebaseMessaging)return;s.onMessageHandler&&t.messageType===Iu.PUSH_RECEIVED&&(typeof s.onMessageHandler=="function"?s.onMessageHandler(wx(t)):s.onMessageHandler.next(wx(t)));const i=t.data;dP(i)&&i[$L]==="1"&&await vP(s,t.messageType,i)}const xx="@firebase/messaging",_x="0.12.23";const xP=s=>{const e=new fP(s.getProvider("app").getImmediate(),s.getProvider("installations-internal").getImmediate(),s.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>wP(e,t)),e},_P=s=>{const e=s.getProvider("messaging").getImmediate();return{getToken:i=>cE(e,i)}};function kP(){yi(new ei("messaging",xP,"PUBLIC")),yi(new ei("messaging-internal",_P,"PRIVATE")),xr(xx,_x),xr(xx,_x,"esm2020")}async function jP(){try{await e_()}catch{return!1}return typeof window<"u"&&Zx()&&YC()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}function EP(s=Ou()){return jP().then(e=>{if(!e)throw dr.create("unsupported-browser")},e=>{throw dr.create("indexed-db-unsupported")}),Qo(jn(s),"messaging").getImmediate()}async function TP(s,e){return s=jn(s),cE(s,e)}kP();const SP="BNVNdqAPfJYhKBjF9qd-YPEMYIbecZLWiOGUF5tOBfNuv6P1iXgJS6IoS9dHLM5gp-WMrExfir0pCpkMzOdTWKY";let yp=null;function CP(){if(!yp)try{yp=EP(Ou())}catch{return null}return yp}function Zp(){return"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window}function kx(){return"Notification"in window?Notification.permission:"denied"}function NP(s){const e=Object.getOwnPropertyDescriptor(Notification,"permission");Object.defineProperty(Notification,"permission",{get:()=>"granted",configurable:!0});const t=()=>{e?Object.defineProperty(Notification,"permission",e):delete Notification.permission};try{const i=s();return i&&typeof i.then=="function"?i.then(l=>(t(),l),l=>{throw t(),l}):(t(),i)}catch(i){throw t(),i}}async function AP(s){if(!Zp())return null;try{const e=await Notification.requestPermission(),t=CP();if(!t)return console.error("Push: could not initialise Firebase Messaging"),null;const i=await navigator.serviceWorker.ready,l=e!=="granted";let c=null;const d=3;for(let g=1;g<=d;g++){try{const y=()=>TP(t,{vapidKey:SP,serviceWorkerRegistration:i});if(c=l?await NP(y):await y(),c)break}catch(y){console.warn(`Push getToken attempt ${g}/${d} failed:`,y)}g<d&&await new Promise(y=>setTimeout(y,1500*g))}return c&&s&&await zn(ze(ye,"clients",s),{fcmTokens:VM(c)}),c}catch(e){return console.error("Push permission request failed:",e),null}}async function RP(s,e){if(!(!e||!s))try{await zn(ze(ye,"clients",s),{fcmTokens:UM(e)})}catch(t){console.error("Token revoke failed:",t)}}const IP=[{key:"daily_morning",label:"Morning motivation",desc:"Daily 6 AM motivational nudge to start your day"},{key:"daily_evening",label:"Evening check-in",desc:"Daily 6 PM reminder to log your habits"},{key:"buddy_request",label:"Buddy requests",desc:"When someone sends you a buddy request"},{key:"buddy_accept",label:"Buddy accepted",desc:"When your buddy request is accepted"},{key:"like",label:"Likes",desc:"When someone likes your post"},{key:"comment",label:"Comments",desc:"When someone comments on your post"},{key:"mention",label:"Mentions",desc:"When someone @mentions you"}];function MP(){const{currentUser:s,clientData:e,updateClientData:t,logout:i,loading:l}=_r(),{isDark:c,toggleTheme:d,accent:g,setAccent:y,isMono:p,toggleMono:b}=Bi(),_=qs(),[j,I]=w.useState(!1),[F,G]=w.useState(null),[B,Y]=w.useState(!1),[ee,re]=w.useState("default"),[pe,ve]=w.useState({daily_morning:!0,daily_evening:!0,buddy_request:!0,buddy_accept:!0,like:!0,comment:!0,mention:!0}),[he,L]=w.useState(null),E=w.useCallback((M,P="info")=>{L({message:M,type:P}),setTimeout(()=>L(null),4e3)},[]);w.useEffect(()=>{!l&&!s&&_("/")},[l,s,_]),w.useEffect(()=>{if(!e)return;const M=e.notificationPrefs;M&&ve(C=>({...C,...M}));const P=e.fcmTokens||[];P.length>0&&(I(!0),G(P[P.length-1])),re(kx())},[e]);const A=async()=>{if(e){Y(!0);try{if(j)F&&await RP(e.id,F),I(!1),G(null),t({fcmTokens:[]}),E("Push notifications disabled","info");else{if(!Zp()){E("Push notifications are not supported on this device","error");return}const M=await AP(e.id),P=kx();re(P),M?(I(!0),G(M),t({fcmTokens:[...e.fcmTokens||[],M]}),E("Push notifications enabled!","success")):E(P==="denied"?"Notifications blocked  enable them in your device settings, remove the app from your home screen and re-add it":P==="granted"?"Permission granted but setup failed  try closing and reopening the app, then toggle again":"Could not enable notifications  please try again","error")}}catch(M){console.error("Push toggle failed:",M),E("Something went wrong  please try again","error")}finally{Y(!1)}}},V=async M=>{if(!e)return;const P={...pe,[M]:!pe[M]};ve(P);try{await zn(ze(ye,"clients",e.id),{notificationPrefs:P}),t({notificationPrefs:P})}catch(C){console.error("Failed to save pref:",C),ve(Me=>({...Me,[M]:!Me[M]})),E("Failed to save preference","error")}};return l||!e?a.jsx("div",{className:"cb-loading",children:a.jsx("div",{className:"cb-loading-spinner"})}):a.jsxs("div",{className:"cb-settings",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>_("/client/core-buddy"),"aria-label":"Back",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M19 12H5"}),a.jsx("path",{d:"M12 19l-7-7 7-7"})]})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:c?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})}),a.jsx("button",{onClick:i,"aria-label":"Log out",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),a.jsxs("main",{className:"settings-main",children:[a.jsx("h1",{className:"settings-title",children:"Settings"}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"13.5",cy:"6.5",r:"2.5"}),a.jsx("circle",{cx:"19",cy:"13.5",r:"2.5"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"2.5"}),a.jsx("circle",{cx:"5",cy:"15.5",r:"2.5"}),a.jsx("circle",{cx:"11",cy:"19.5",r:"2.5"}),a.jsx("path",{d:"M12 2a10 10 0 0 0 0 20 2 2 0 0 0 2-2v-1a2 2 0 0 1 2-2h1a2 2 0 0 0 2-2 10 10 0 0 0-7-13z"})]}),"Accent Colour"]}),a.jsx("div",{className:"settings-accent-row",children:[{key:"red",color:"#B8313D",label:"Red"},{key:"orange",color:"#FF8533",label:"Orange"},{key:"blue",color:"#1AADFF",label:"Blue"},{key:"green",color:"#C1FF72",label:"Green"},{key:"purple",color:"#CB6CE6",label:"Purple"}].map(M=>a.jsxs("button",{className:`settings-accent-option${g===M.key?" active":""}`,onClick:()=>y(M.key),"aria-label":`${M.label} accent`,children:[a.jsx("span",{className:"settings-accent-dot",style:{background:M.color}}),a.jsx("span",{className:"settings-accent-label",children:M.label})]},M.key))}),a.jsxs("div",{className:"settings-row settings-mono-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Mono"}),a.jsx("span",{className:"settings-row-desc",children:"Black & white with frosted glass"})]}),a.jsx("button",{className:`settings-toggle${p?" on":""}`,onClick:b,"aria-label":"Toggle mono theme",children:a.jsx("span",{className:"settings-toggle-knob"})})]})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),a.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),"Notifications"]}),Zp()?a.jsxs("div",{className:"settings-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Push notifications"}),a.jsx("span",{className:"settings-row-desc",children:"Receive notifications even when the app is closed"})]}),a.jsx("button",{className:`settings-toggle${j?" on":""}${B?" loading":""}`,onClick:A,disabled:B,"aria-label":"Toggle push notifications",children:a.jsx("span",{className:"settings-toggle-knob"})})]}):a.jsx("p",{className:"settings-hint",children:"Add the app to your home screen for background push notifications. In-app notifications still work below."}),a.jsxs("div",{className:"settings-sub-section",children:[a.jsx("span",{className:"settings-sub-title",children:"Notify me about"}),IP.map(M=>a.jsxs("div",{className:"settings-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:M.label}),a.jsx("span",{className:"settings-row-desc",children:M.desc})]}),a.jsx("button",{className:`settings-toggle${pe[M.key]?" on":""}`,onClick:()=>V(M.key),"aria-label":`Toggle ${M.label}`,children:a.jsx("span",{className:"settings-toggle-knob"})})]},M.key))]})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),"Account"]}),a.jsxs("div",{className:"settings-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Dark mode"}),a.jsx("span",{className:"settings-row-desc",children:"Switch between light and dark themes"})]}),a.jsx("button",{className:`settings-toggle${c?" on":""}`,onClick:d,"aria-label":"Toggle dark mode",children:a.jsx("span",{className:"settings-toggle-knob"})})]}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Email"}),a.jsx("span",{className:"settings-row-desc",children:e?.email||""})]})}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Plan"}),a.jsx("span",{className:"settings-row-desc",style:{textTransform:"capitalize"},children:e?.tier||"free"})]})})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),"Support & Feedback"]}),a.jsxs("a",{href:"mailto:ross@mindcorefitness.com?subject=Core%20Buddy%20Bug%20Report",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Report a Bug"}),a.jsx("span",{className:"settings-row-desc",children:"Found something not working? Let us know"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]}),a.jsxs("a",{href:"mailto:ross@mindcorefitness.com?subject=Core%20Buddy%20Feature%20Request",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Request a Feature"}),a.jsx("span",{className:"settings-row-desc",children:"Have an idea to improve Core Buddy?"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]}),a.jsxs("a",{href:"mailto:ross@mindcorefitness.com?subject=Core%20Buddy%20Feedback",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"General Feedback"}),a.jsx("span",{className:"settings-row-desc",children:"We'd love to hear from you"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Contact Email"}),a.jsx("span",{className:"settings-row-desc",children:"ross@mindcorefitness.com"})]})})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),a.jsx("polyline",{points:"10 9 9 9 8 9"})]}),"Legal"]}),a.jsxs("a",{href:"/privacy-policy",target:"_blank",rel:"noopener noreferrer",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Privacy Policy"}),a.jsx("span",{className:"settings-row-desc",children:"How we collect, use, and protect your data"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),a.jsx("polyline",{points:"15 3 21 3 21 9"}),a.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})]}),a.jsxs("a",{href:"/terms",target:"_blank",rel:"noopener noreferrer",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Terms & Conditions"}),a.jsx("span",{className:"settings-row-desc",children:"Terms of use for Core Buddy"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),a.jsx("polyline",{points:"15 3 21 3 21 9"}),a.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})]})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),a.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),"About"]}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Core Buddy"}),a.jsx("span",{className:"settings-row-desc",children:"Food. Habits. Move."})]})}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Version"}),a.jsx("span",{className:"settings-row-desc",children:"1.0.0"})]})}),a.jsxs("a",{href:"/core-buddy",target:"_blank",rel:"noopener noreferrer",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Visit Our Website"}),a.jsx("span",{className:"settings-row-desc",children:"mindcorefitness.com"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),a.jsx("polyline",{points:"15 3 21 3 21 9"}),a.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})]})]})]}),he&&a.jsx("div",{className:`settings-toast ${he.type}`,children:he.message}),a.jsx(ni,{active:"home"})]})}const _h=[{id:"starter_streak",name:"Starter Streak",description:"Complete 5 workouts in 7 days",goal:5,duration:7,type:"workouts",difficulty:"easy",icon:"flame",premium:!0},{id:"consistency_king",name:"Consistency King",description:"Complete 12 workouts in 30 days",goal:12,duration:30,type:"workouts",difficulty:"medium",icon:"crown",premium:!0},{id:"thirty_in_thirty",name:"30 in 30",description:"Complete 30 workouts in 30 days",goal:30,duration:30,type:"workouts",difficulty:"hard",icon:"fire",premium:!0},{id:"minute_master",name:"Minute Master",description:"Train for 300 total minutes in 30 days",goal:300,duration:30,type:"minutes",difficulty:"medium",icon:"clock",premium:!0},{id:"habit_machine",name:"Habit Machine",description:"Hit all daily habits for 7 days straight",goal:7,duration:7,type:"habits_perfect",difficulty:"medium",icon:"check",premium:!0},{id:"iron_will",name:"Iron Will",description:"Work out every day for 14 days straight",goal:14,duration:14,type:"streak",difficulty:"hard",icon:"shield",premium:!0}];function vp({icon:s,size:e=28}){const t={width:e,height:e};switch(s){case"flame":return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 12c2-2.96 0-7-1-8 0 3.038-1.773 4.741-3 6-1.226 1.26-2 3.24-2 5a6 6 0 1 0 12 0c0-1.532-1.056-3.94-2-5-1.786 3-2.791 3-4 2z"})});case"crown":return a.jsxs("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M2 4l3 12h14l3-12-6 7-4-7-4 7-6-7z"}),a.jsx("path",{d:"M3 20h18"})]});case"fire":return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 12c2-2.96 0-7-1-8 0 3.038-1.773 4.741-3 6-1.226 1.26-2 3.24-2 5a6 6 0 1 0 12 0c0-1.532-1.056-3.94-2-5-1.786 3-2.791 3-4 2z"})});case"clock":return a.jsxs("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 6v6l4 2"})]});case"check":return a.jsxs("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]});case"shield":return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})});default:return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("circle",{cx:"12",cy:"12",r:"10"})})}}function jx({progress:s,goal:e,size:t=160,stroke:i=10,label:l}){const c=Math.min(s/e,1),d=(t-i)/2,g=2*Math.PI*d,y=g*(1-c);return a.jsxs("div",{className:"ch-ring-wrap",children:[a.jsxs("svg",{width:t,height:t,className:"ch-ring-svg",children:[a.jsx("circle",{cx:t/2,cy:t/2,r:d,fill:"none",stroke:"var(--ch-ring-bg)",strokeWidth:i}),a.jsx("circle",{cx:t/2,cy:t/2,r:d,fill:"none",stroke:"var(--color-primary)",strokeWidth:i,strokeDasharray:g,strokeDashoffset:y,strokeLinecap:"round",style:{transition:"stroke-dashoffset 0.6s ease",transform:"rotate(-90deg)",transformOrigin:"50% 50%"}})]}),a.jsxs("div",{className:"ch-ring-centre",children:[a.jsxs("span",{className:"ch-ring-num",children:[s,a.jsxs("span",{className:"ch-ring-slash",children:[" / ",e]})]}),l&&a.jsx("span",{className:"ch-ring-label",children:l})]})]})}const Ex={easy:"#34C759",medium:"#FF9500",hard:"#FF3B30"};async function DP(s,e,t){const i=t instanceof Bt?t:Bt.fromDate(new Date(t)),l=i.toDate().getTime(),c=Date.now(),d=async()=>{const g=tn(ut(ye,"workoutLogs"),Ot("clientId","==",e));return(await $t(g)).docs.filter(p=>{const b=p.data().completedAt;if(!b)return!1;const _=b.toDate?b.toDate().getTime():new Date(b).getTime();return _>=l&&_<=c})};switch(s.type){case"workouts":return(await d()).length;case"minutes":return(await d()).reduce((y,p)=>y+(p.data().duration||0),0);case"habits_perfect":{const g=i.toDate().toISOString().slice(0,10),y=new Date().toISOString().slice(0,10),p=tn(ut(ye,"habitLogs"),Ot("clientId","==",e));return(await $t(p)).docs.filter(_=>{const j=_.data().date;if(j<g||j>y)return!1;const I=_.data().habits||{};return Object.values(I).length>0&&Object.values(I).every(F=>F===!0)}).length}case"streak":{const g=await d(),y=new Set(g.map(j=>j.data().completedAt.toDate().toISOString().slice(0,10)));let p=0;const b=new Date(i.toDate()),_=new Date;for(;y.has(b.toISOString().slice(0,10))&&b<=_;)p++,b.setDate(b.getDate()+1);return p}default:return 0}}function LP(){const{currentUser:s,clientData:e,loading:t}=_r(),{isDark:i,toggleTheme:l}=Bi(),{isPremium:c}=hc(),d=qs(),[g,y]=w.useState(null),[p,b]=w.useState(null),[_,j]=w.useState(0),[I,F]=w.useState(0),[G,B]=w.useState(!0),[Y,ee]=w.useState(!1),[re,pe]=w.useState(null),[ve,he]=w.useState(null),[L,E]=w.useState(!1),[A,V]=w.useState(null),M=w.useCallback((ke,Pe="info")=>{he({message:ke,type:Pe}),setTimeout(()=>he(null),4e3)},[]);w.useEffect(()=>{!t&&!s&&d("/")},[t,s,d]);const P=w.useCallback(async()=>{if(e){B(!0);try{const ke=tn(ut(ye,"userChallenges"),Ot("clientId","==",e.id),Ot("status","==","active")),Pe=await $t(ke);if(Pe.empty)y(null),b(null);else{const Ee=Pe.docs[0],Ce={id:Ee.id,...Ee.data()},je=_h.find(Ue=>Ue.id===Ce.challengeId);if(Ce.endDate.toDate()<new Date)await zn(ze(ye,"userChallenges",Ee.id),{status:"failed"}),y(null),b(null),M("Challenge expired  time ran out","error");else if(y(Ce),b(je),je){const Ue=await DP(je,e.id,Ce.startDate);if(j(Ue),Ue>=je.goal&&Ce.status==="active"){if(await zn(ze(ye,"userChallenges",Ee.id),{status:"completed",completedAt:xs()}),E(!0),y($e=>$e?{...$e,status:"completed"}:null),!Ce.badgeAwarded){const $e=Pr.find(Xe=>Xe.id===je.id);if($e)try{const Xe=ze(ye,"coreBuddyBadges",e.id),Ze=await _s(Xe),Wt=Ze.exists()?Ze.data().earned||[]:[];if(!Wt.some(It=>It.id===$e.id)){const It={id:$e.id,earnedAt:new Date().toISOString()};Ze.exists()?await zn(Xe,{earned:[...Wt,It]}):await Wn(Xe,{earned:[It]})}await zn(ze(ye,"userChallenges",Ee.id),{badgeAwarded:!0}),await or(ut(ye,"posts"),{authorId:e.id,authorName:e.name||"Anonymous",authorPhotoURL:e.photoURL||null,type:"badge_earned",metadata:{title:$e.name,badgeDesc:$e.desc,badgeId:$e.id},createdAt:xs(),likeCount:0,commentCount:0}),V($e)}catch(Xe){console.error("Badge award failed:",Xe)}}typeof fbq=="function"&&fbq("trackCustom","ChallengeCompleted",{challenge_name:je.name,challenge_type:je.type,duration_days:je.duration})}}}const U=tn(ut(ye,"userChallenges"),Ot("clientId","==",e.id),Ot("status","==","completed")),ce=await $t(U);F(ce.size)}catch(ke){console.error("Failed to load challenges:",ke)}finally{B(!1)}}},[e,M]);w.useEffect(()=>{P()},[P]);const C=async ke=>{if(!(!e||Y)){ee(!0);try{const Pe=_h.find(je=>je.id===ke);if(!Pe)return;const U=tn(ut(ye,"userChallenges"),Ot("clientId","==",e.id),Ot("status","==","active"));if(!(await $t(U)).empty){pe(null),M("You already have an active challenge","info"),await P();return}const Ee=Bt.now(),Ce=Bt.fromDate(new Date(Date.now()+Pe.duration*864e5));await or(ut(ye,"userChallenges"),{clientId:e.id,challengeId:ke,startDate:Ee,endDate:Ce,status:"active",completedAt:null,badgeAwarded:!1,createdAt:xs()}),pe(null),M(`${Pe.name} started  let's go!`,"success"),await P()}catch(Pe){console.error("Start challenge failed:",Pe),Pe?.code==="permission-denied"?M("Permission denied  please re-login and try again","error"):M("Something went wrong  try again","error")}finally{ee(!1)}}},Me=async()=>{if(!(!g||Y)){ee(!0);try{await zn(ze(ye,"userChallenges",g.id),{status:"failed"}),y(null),b(null),j(0),pe(null),M("Challenge abandoned","info"),await P()}catch(ke){console.error("Give up failed:",ke),M("Something went wrong","error")}finally{ee(!1)}}},Qe=g?.endDate?Math.max(0,Math.ceil((g.endDate.toDate()-new Date)/864e5)):0,J=()=>{if(!p||!g)return"";const ke=Math.max(1,Math.ceil((Date.now()-g.startDate.toDate())/864e5)),Pe=p.goal/p.duration*ke;return _>=Pe*1.15?"Ahead":_>=Pe*.85?"On Track":"Behind"};if(t||!e)return a.jsx("div",{className:"ch-loading",children:a.jsx("div",{className:"ch-spinner"})});const Se=g&&g.status==="active"&&p,He=L||g&&g.status==="completed";return a.jsxs("div",{className:"ch-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Back",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M19 12H5"}),a.jsx("path",{d:"M12 19l-7-7 7-7"})]})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:l,"aria-label":"Toggle theme",children:i?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"ch-main",children:[a.jsx("h1",{className:"ch-title",children:"Challenges"}),a.jsx("p",{className:"ch-subtitle",children:"Push yourself with timed fitness challenges"}),G?a.jsx("div",{className:"ch-loading",children:a.jsx("div",{className:"ch-spinner"})}):He?(()=>{const ke=Pr.find(Pe=>Pe.id===p?.id);return a.jsxs("div",{className:"ch-completed-section",children:[a.jsxs("div",{className:"ch-completed-badge-wrap",children:[a.jsx("div",{className:"ch-completed-glow"}),ke?.img?a.jsx("img",{src:ke.img,alt:ke.name,className:"ch-completed-badge-img"}):a.jsx(jx,{progress:p?.goal||1,goal:p?.goal||1,label:"Complete"})]}),a.jsx("h2",{className:"ch-completed-heading",children:"Challenge Complete!"}),a.jsx("p",{className:"ch-completed-name",children:p?.name}),ke?.desc&&a.jsx("p",{className:"ch-completed-desc",children:ke.desc}),a.jsxs("p",{className:"ch-completed-count",children:[I+(L?1:0)," challenge",I!==0?"s":""," completed"]}),a.jsx("button",{className:"ch-btn ch-btn-primary",onClick:()=>{E(!1),y(null),b(null),P()},children:"Start New Challenge"})]})})():Se?a.jsxs("div",{className:"ch-active-section",children:[a.jsx(jx,{progress:_,goal:p.goal,label:p.type==="minutes"?"minutes":p.type==="streak"?"day streak":p.type==="habits_perfect"?"perfect days":"workouts"}),a.jsxs("div",{className:"ch-active-info",children:[a.jsxs("div",{className:"ch-info-row",children:[a.jsxs("div",{className:"ch-info-item",children:[a.jsx("span",{className:"ch-info-val",children:Qe}),a.jsx("span",{className:"ch-info-key",children:"days left"})]}),a.jsx("div",{className:`ch-pace ch-pace-${J().toLowerCase().replace(" ","")}`,children:J()})]}),a.jsx("h2",{className:"ch-active-name",children:p.name}),a.jsx("p",{className:"ch-active-desc",children:p.description})]}),a.jsx("button",{className:"ch-give-up",onClick:()=>pe("giveup"),children:"Give Up"}),a.jsxs("div",{className:"ch-browse-locked",children:[a.jsx("p",{className:"ch-browse-locked-note",children:"Complete your current challenge to start a new one"}),a.jsx("div",{className:"ch-grid ch-grid-dimmed",children:_h.filter(ke=>ke.id!==p.id).map(ke=>a.jsxs("div",{className:"ch-card ch-card-locked",children:[a.jsx("div",{className:"ch-card-icon",children:a.jsx(vp,{icon:ke.icon,size:24})}),a.jsxs("div",{className:"ch-card-body",children:[a.jsx("h3",{children:ke.name}),a.jsx("p",{children:ke.description})]})]},ke.id))})]})]}):a.jsxs("div",{className:"ch-browse-section",children:[!c&&a.jsxs("div",{className:"ch-premium-banner",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{children:"Challenges are a premium feature"}),a.jsx("button",{className:"ch-upgrade-link",onClick:()=>d("/upgrade"),children:"Upgrade"})]}),a.jsx("div",{className:"ch-grid",children:_h.map(ke=>a.jsxs("button",{className:`ch-card${c?"":" ch-card-gated"}`,onClick:()=>c?pe(ke):d("/upgrade"),children:[!c&&a.jsx("div",{className:"ch-lock-overlay",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),a.jsx("div",{className:"ch-card-icon",children:a.jsx(vp,{icon:ke.icon})}),a.jsxs("div",{className:"ch-card-body",children:[a.jsx("h3",{children:ke.name}),a.jsx("p",{children:ke.description}),a.jsxs("div",{className:"ch-card-tags",children:[a.jsxs("span",{className:"ch-tag ch-tag-dur",children:[ke.duration," days"]}),a.jsx("span",{className:"ch-tag ch-tag-diff",style:{color:Ex[ke.difficulty]},children:ke.difficulty})]})]}),a.jsx("svg",{className:"ch-card-arrow",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]},ke.id))})]})]}),re&&re!=="giveup"&&a.jsx("div",{className:"ch-modal-backdrop",onClick:()=>!Y&&pe(null),children:a.jsxs("div",{className:"ch-modal",onClick:ke=>ke.stopPropagation(),children:[a.jsx("div",{className:"ch-modal-icon",children:a.jsx(vp,{icon:re.icon,size:36})}),a.jsx("h2",{children:re.name}),a.jsx("p",{children:re.description}),a.jsxs("div",{className:"ch-modal-details",children:[a.jsxs("span",{children:[re.duration," days"]}),a.jsx("span",{style:{color:Ex[re.difficulty]},children:re.difficulty})]}),a.jsx("button",{className:"ch-btn ch-btn-primary",onClick:()=>C(re.id),disabled:Y,children:Y?"Starting...":"Start Challenge"}),a.jsx("button",{className:"ch-btn ch-btn-secondary",onClick:()=>pe(null),disabled:Y,children:"Cancel"})]})}),re==="giveup"&&a.jsx("div",{className:"ch-modal-backdrop",onClick:()=>!Y&&pe(null),children:a.jsxs("div",{className:"ch-modal",onClick:ke=>ke.stopPropagation(),children:[a.jsx("h2",{children:"Give Up?"}),a.jsx("p",{children:"Your progress will be lost and this challenge will be marked as failed."}),a.jsx("button",{className:"ch-btn ch-btn-danger",onClick:Me,disabled:Y,children:Y?"Abandoning...":"Yes, Give Up"}),a.jsx("button",{className:"ch-btn ch-btn-secondary",onClick:()=>pe(null),disabled:Y,children:"Keep Going"})]})}),a.jsx(Wl,{badge:A,onDismiss:()=>V(null)}),ve&&a.jsx("div",{className:`ch-toast ch-toast-${ve.type}`,children:ve.message}),a.jsx(ni,{})]})}const PP={workouts:"Workouts",streaks:"Streaks",nutrition:"Nutrition",leaderboard:"Leaderboard",habits:"Habits",challenges:"Challenges"},OP=["workouts","streaks","nutrition","leaderboard","habits","challenges"];function VP(){const{currentUser:s,isClient:e,clientData:t,loading:i}=_r(),{isDark:l,toggleTheme:c}=Bi(),d=qs(),[g,y]=w.useState(new Set),[p,b]=w.useState({}),[_,j]=w.useState(!0),[I,F]=w.useState(null);w.useEffect(()=>{!i&&(!s||!e)&&d("/")},[s,e,i,d]),w.useEffect(()=>{t&&(async()=>{j(!0);try{const Y=await _s(ze(ye,"coreBuddyBadges",t.id));if(Y.exists()){const ee=Y.data().earned||[];y(new Set(ee.map(pe=>pe.id)));const re={};ee.forEach(pe=>{re[pe.id]=pe}),b(re)}}catch(Y){console.error("Failed to load badges:",Y)}finally{j(!1)}})()},[t]);const G=OP.map(Y=>({key:Y,label:PP[Y],badges:Pr.filter(ee=>ee.category===Y)})).filter(Y=>Y.badges.length>0),B=Pr.filter(Y=>g.has(Y.id)).length;return i||!t?a.jsx("div",{className:"bdg-loading",children:a.jsx("div",{className:"bdg-spinner"})}):a.jsxs("div",{className:"bdg-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Back",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M19 12H5"}),a.jsx("path",{d:"M12 19l-7-7 7-7"})]})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:c,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"bdg-main",children:[a.jsx("h1",{className:"bdg-title",children:"Badges"}),a.jsxs("p",{className:"bdg-subtitle",children:[B," / ",Pr.length," earned"]}),_?a.jsx("div",{className:"bdg-loading-inline",children:a.jsx("div",{className:"bdg-spinner"})}):G.map(Y=>a.jsxs("div",{className:"bdg-category",children:[a.jsx("h2",{className:"bdg-category-title",children:Y.label}),a.jsx("div",{className:"bdg-grid",children:Y.badges.map(ee=>{const re=g.has(ee.id);return a.jsxs("button",{className:`bdg-item${re?" earned":" locked"}`,onClick:()=>F(ee),children:[a.jsxs("div",{className:"bdg-img-wrap",children:[ee.img?a.jsx("img",{src:ee.img,alt:ee.name,className:"bdg-img",loading:"lazy"}):a.jsx("div",{className:"bdg-img-placeholder",children:a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("circle",{cx:"12",cy:"8",r:"6"}),a.jsx("path",{d:"M9 14l-4 8h14l-4-8"})]})}),!re&&a.jsx("div",{className:"bdg-lock-overlay",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})})]}),a.jsx("span",{className:"bdg-name",children:ee.name})]},ee.id)})})]},Y.key))]}),I&&a.jsx("div",{className:"bdg-modal-backdrop",onClick:()=>F(null),children:a.jsxs("div",{className:"bdg-modal",onClick:Y=>Y.stopPropagation(),children:[a.jsx("div",{className:`bdg-modal-img-wrap${g.has(I.id)?" earned":" locked"}`,children:I.img?a.jsx("img",{src:I.img,alt:I.name,className:"bdg-modal-img"}):a.jsx("div",{className:"bdg-modal-placeholder",children:a.jsxs("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("circle",{cx:"12",cy:"8",r:"6"}),a.jsx("path",{d:"M9 14l-4 8h14l-4-8"})]})})}),a.jsx("h2",{className:"bdg-modal-name",children:I.name}),a.jsx("p",{className:"bdg-modal-desc",children:I.desc}),g.has(I.id)?a.jsxs("span",{className:"bdg-modal-status earned",children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})}),"Earned",p[I.id]?.earnedAt?`  ${new Date(p[I.id].earnedAt).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}`:""]}):a.jsxs("span",{className:"bdg-modal-status locked",children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),"Locked"]}),a.jsx("button",{className:"bdg-modal-close",onClick:()=>F(null),children:"Close"})]})}),a.jsx(ni,{active:"badges"})]})}const UP=w.lazy(()=>Hs(()=>import("./Dashboard-CqWdcYN7.js"),__vite__mapDeps([0,1,2]))),BP=w.lazy(()=>Hs(()=>import("./AddClient-CvyzaW6C.js"),__vite__mapDeps([3,4]))),zP=w.lazy(()=>Hs(()=>import("./ClientDashboard-5kr2u5-s.js"),__vite__mapDeps([5,1,6]))),FP=w.lazy(()=>Hs(()=>import("./ClientForms-BYpsj2ab.js"),__vite__mapDeps([7,8,6]))),HP=w.lazy(()=>Hs(()=>import("./ClientTools-W7ekVfG-.js"),__vite__mapDeps([9,10,6]))),qP=w.lazy(()=>Hs(()=>import("./MacroCalculator-O3yYuFSG.js"),__vite__mapDeps([11,10,6]))),$P=w.lazy(()=>Hs(()=>import("./ProteinSnacks-DDus_xXs.js"),__vite__mapDeps([12,10,6]))),WP=w.lazy(()=>Hs(()=>import("./DailyMotivation-My2fPLUv.js"),__vite__mapDeps([13,10,6]))),GP=w.lazy(()=>Hs(()=>import("./CircuitDashboard-B0jYo5qr.js"),__vite__mapDeps([14,15]))),KP=w.lazy(()=>Hs(()=>import("./CircuitBooking-C6WKlw14.js"),__vite__mapDeps([16,17,15]))),YP=w.lazy(()=>Hs(()=>import("./PersonalBests-CoXVTzTU.js"),__vite__mapDeps([18,19,6]))),QP=w.lazy(()=>Hs(()=>import("./Leaderboard-0nSDb6Ay.js"),__vite__mapDeps([20,21]))),XP=w.lazy(()=>Hs(()=>import("./UpgradePage-D5I8uvk9.js"),__vite__mapDeps([22,23,24]))),JP=w.lazy(()=>Hs(()=>import("./SignUp-D-s9-7FW.js"),[])),ZP=w.lazy(()=>Hs(()=>import("./Onboarding-DdcIDXbg.js"),__vite__mapDeps([25,23,26])));function eO({children:s}){const{pathname:e}=Ui();return w.useEffect(()=>{"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")},[]),w.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"})},[e]),s}function tO(){const s=qs();return w.useEffect(()=>{const e=sessionStorage.getItem("redirect");if(e){sessionStorage.removeItem("redirect");const t=e.replace("/login","")||"/";s(t,{replace:!0})}},[s]),null}function nO(){return a.jsx(k3,{children:a.jsx(d3,{children:a.jsx(C3,{children:a.jsxs(wC,{basename:"/login",children:[a.jsx(tO,{}),a.jsx(eO,{children:a.jsx(w.Suspense,{fallback:a.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"60vh"},children:a.jsx("div",{style:{width:36,height:36,border:"3px solid var(--color-primary-light)",borderTopColor:"var(--color-primary)",borderRadius:"50%",animation:"app-spin .7s linear infinite"}})}),children:a.jsxs(YS,{children:[a.jsx(Sn,{path:"/",element:a.jsx(I3,{})}),a.jsx(Sn,{path:"/login",element:a.jsx(A3,{})}),a.jsx(Sn,{path:"/dashboard",element:a.jsx(UP,{})}),a.jsx(Sn,{path:"/add-client",element:a.jsx(BP,{})}),a.jsx(Sn,{path:"/client",element:a.jsx(zP,{})}),a.jsx(Sn,{path:"/client/forms",element:a.jsx(FP,{})}),a.jsx(Sn,{path:"/client/tools",element:a.jsx(HP,{})}),a.jsx(Sn,{path:"/client/tools/macros",element:a.jsx(qP,{})}),a.jsx(Sn,{path:"/client/tools/snacks",element:a.jsx($P,{})}),a.jsx(Sn,{path:"/client/tools/motivation",element:a.jsx(WP,{})}),a.jsx(Sn,{path:"/client/personal-bests",element:a.jsx(YP,{})}),a.jsx(Sn,{path:"/client/circuit",element:a.jsx(GP,{})}),a.jsx(Sn,{path:"/client/circuit/booking",element:a.jsx(KP,{})}),a.jsx(Sn,{path:"/client/core-buddy",element:a.jsx(t5,{})}),a.jsx(Sn,{path:"/client/core-buddy/nutrition",element:a.jsx(vh,{feature:"nutrition",children:a.jsx(r5,{})})}),a.jsx(Sn,{path:"/client/core-buddy/workouts",element:a.jsx(F5,{})}),a.jsx(Sn,{path:"/client/core-buddy/consistency",element:a.jsx(vh,{feature:"consistency",children:a.jsx(K5,{})})}),a.jsx(Sn,{path:"/client/core-buddy/buddies",element:a.jsx(vh,{feature:"buddies",children:a.jsx(Q5,{})})}),a.jsx(Sn,{path:"/client/core-buddy/builder",element:a.jsx(eL,{})}),a.jsx(Sn,{path:"/client/core-buddy/profile/:userId",element:a.jsx(J5,{})}),a.jsx(Sn,{path:"/client/core-buddy/settings",element:a.jsx(MP,{})}),a.jsx(Sn,{path:"/client/core-buddy/challenges",element:a.jsx(LP,{})}),a.jsx(Sn,{path:"/client/core-buddy/badges",element:a.jsx(VP,{})}),a.jsx(Sn,{path:"/client/leaderboard",element:a.jsx(vh,{feature:"leaderboard",children:a.jsx(QP,{})})}),a.jsx(Sn,{path:"/signup",element:a.jsx(JP,{})}),a.jsx(Sn,{path:"/onboarding",element:a.jsx(ZP,{})}),a.jsx(Sn,{path:"/upgrade",element:a.jsx(XP,{})}),a.jsx(Sn,{path:"*",element:a.jsx(Ux,{to:"/",replace:!0})})]})})})]})})})})}YT.createRoot(document.getElementById("root")).render(a.jsx(w.StrictMode,{children:a.jsx(nO,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/login/sw.js").then(s=>{setInterval(()=>s.update(),3600*1e3)}).catch(s=>console.warn("SW registration failed:",s))});export{Oj as A,Wl as B,ni as C,sO as D,xs as E,w0 as F,nl as P,Bt as T,or as a,ar as b,ut as c,ye as d,ze as e,d4 as f,$t as g,p4 as h,Wn as i,a as j,_s as k,_r as l,Bi as m,qs as n,iO as o,Uj as p,tn as q,w as r,aO as s,EC as t,zn as u,oO as v,Ot as w,nf as x,hc as y,Vj as z};
