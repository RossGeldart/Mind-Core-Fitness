const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-NejMejMz.js","assets/Dashboard-kTCGLGDk.css","assets/AddClient-CUyDBorz.js","assets/AddClient-DH1OFzHo.css","assets/ClientForms-C1cfcQEA.js","assets/ClientForms-GDNtnrAx.css","assets/ClientTools-BhEZbPS0.js","assets/ClientTools-DQRPoST3.css","assets/MacroCalculator-CCbxIbo0.js","assets/ProteinSnacks-SVV6tjuE.js","assets/DailyMotivation-DVmQaCDv.js","assets/CircuitDashboard-Cf1Ye90f.js","assets/CircuitDashboard-C8T0uect.css","assets/CircuitBooking-Cggw6SPs.js","assets/CircuitBooking-ruk9Q4Wj.css","assets/Leaderboard-5ht5Rdhe.js","assets/Leaderboard-Dq-r5svP.css","assets/UpgradePage-Cq2WeiJO.js","assets/stripe-7qEIN5w7.js","assets/UpgradePage-Blt11CID.css","assets/Onboarding-DYeR6Xca.js","assets/Onboarding-Bku4iVdQ.css"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function t(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(l){if(l.ep)return;l.ep=!0;const u=t(l);fetch(l.href,u)}})();var gp={exports:{}},Wc={};var w1;function xT(){if(w1)return Wc;w1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,l,u){var d=null;if(u!==void 0&&(d=""+u),l.key!==void 0&&(d=""+l.key),"key"in l){u={};for(var p in l)p!=="key"&&(u[p]=l[p])}else u=l;return l=u.ref,{$$typeof:n,type:i,key:d,ref:l!==void 0?l:null,props:u}}return Wc.Fragment=e,Wc.jsx=t,Wc.jsxs=t,Wc}var _1;function wT(){return _1||(_1=1,gp.exports=xT()),gp.exports}var r=wT(),yp={exports:{}},Yt={};var k1;function _T(){if(k1)return Yt;k1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),d=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),j=Symbol.for("react.activity"),T=Symbol.iterator;function O(L){return L===null||typeof L!="object"?null:(L=T&&L[T]||L["@@iterator"],typeof L=="function"?L:null)}var $={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},F=Object.assign,B={};function te(L,se,De){this.props=L,this.context=se,this.refs=B,this.updater=De||$}te.prototype.isReactComponent={},te.prototype.setState=function(L,se){if(typeof L!="object"&&typeof L!="function"&&L!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,L,se,"setState")},te.prototype.forceUpdate=function(L){this.updater.enqueueForceUpdate(this,L,"forceUpdate")};function K(){}K.prototype=te.prototype;function ae(L,se,De){this.props=L,this.context=se,this.refs=B,this.updater=De||$}var be=ae.prototype=new K;be.constructor=ae,F(be,te.prototype),be.isPureReactComponent=!0;var ve=Array.isArray;function _e(){}var R={H:null,A:null,T:null,S:null},E=Object.prototype.hasOwnProperty;function A(L,se,De){var Le=De.ref;return{$$typeof:n,type:L,key:se,ref:Le!==void 0?Le:null,props:De}}function V(L,se){return A(L.type,se,L.props)}function D(L){return typeof L=="object"&&L!==null&&L.$$typeof===n}function H(L){var se={"=":"=0",":":"=2"};return"$"+L.replace(/[=:]/g,function(De){return se[De]})}var M=/\/+/g;function $e(L,se){return typeof L=="object"&&L!==null&&L.key!=null?H(""+L.key):se.toString(36)}function pt(L){switch(L.status){case"fulfilled":return L.value;case"rejected":throw L.reason;default:switch(typeof L.status=="string"?L.then(_e,_e):(L.status="pending",L.then(function(se){L.status==="pending"&&(L.status="fulfilled",L.value=se)},function(se){L.status==="pending"&&(L.status="rejected",L.reason=se)})),L.status){case"fulfilled":return L.value;case"rejected":throw L.reason}}throw L}function W(L,se,De,Le,Qe){var Fe=typeof L;(Fe==="undefined"||Fe==="boolean")&&(L=null);var ft=!1;if(L===null)ft=!0;else switch(Fe){case"bigint":case"string":case"number":ft=!0;break;case"object":switch(L.$$typeof){case n:case e:ft=!0;break;case w:return ft=L._init,W(ft(L._payload),se,De,Le,Qe)}}if(ft)return Qe=Qe(L),ft=Le===""?"."+$e(L,0):Le,ve(Qe)?(De="",ft!=null&&(De=ft.replace(M,"$&/")+"/"),W(Qe,se,De,"",function(Gt){return Gt})):Qe!=null&&(D(Qe)&&(Qe=V(Qe,De+(Qe.key==null||L&&L.key===Qe.key?"":(""+Qe.key).replace(M,"$&/")+"/")+ft)),se.push(Qe)),1;ft=0;var jt=Le===""?".":Le+":";if(ve(L))for(var at=0;at<L.length;at++)Le=L[at],Fe=jt+$e(Le,at),ft+=W(Le,se,De,Fe,Qe);else if(at=O(L),typeof at=="function")for(L=at.call(L),at=0;!(Le=L.next()).done;)Le=Le.value,Fe=jt+$e(Le,at++),ft+=W(Le,se,De,Fe,Qe);else if(Fe==="object"){if(typeof L.then=="function")return W(pt(L),se,De,Le,Qe);throw se=String(L),Error("Objects are not valid as a React child (found: "+(se==="[object Object]"?"object with keys {"+Object.keys(L).join(", ")+"}":se)+"). If you meant to render a collection of children, use an array instead.")}return ft}function pe(L,se,De){if(L==null)return L;var Le=[],Qe=0;return W(L,Le,"","",function(Fe){return se.call(De,Fe,Qe++)}),Le}function Ve(L){if(L._status===-1){var se=L._result;se=se(),se.then(function(De){(L._status===0||L._status===-1)&&(L._status=1,L._result=De)},function(De){(L._status===0||L._status===-1)&&(L._status=2,L._result=De)}),L._status===-1&&(L._status=0,L._result=se)}if(L._status===1)return L._result.default;throw L._result}var We=typeof reportError=="function"?reportError:function(L){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var se=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof L=="object"&&L!==null&&typeof L.message=="string"?String(L.message):String(L),error:L});if(!window.dispatchEvent(se))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",L);return}console.error(L)},ee={map:pe,forEach:function(L,se,De){pe(L,function(){se.apply(this,arguments)},De)},count:function(L){var se=0;return pe(L,function(){se++}),se},toArray:function(L){return pe(L,function(se){return se})||[]},only:function(L){if(!D(L))throw Error("React.Children.only expected to receive a single React element child.");return L}};return Yt.Activity=j,Yt.Children=ee,Yt.Component=te,Yt.Fragment=t,Yt.Profiler=l,Yt.PureComponent=ae,Yt.StrictMode=i,Yt.Suspense=g,Yt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,Yt.__COMPILER_RUNTIME={__proto__:null,c:function(L){return R.H.useMemoCache(L)}},Yt.cache=function(L){return function(){return L.apply(null,arguments)}},Yt.cacheSignal=function(){return null},Yt.cloneElement=function(L,se,De){if(L==null)throw Error("The argument must be a React element, but you passed "+L+".");var Le=F({},L.props),Qe=L.key;if(se!=null)for(Fe in se.key!==void 0&&(Qe=""+se.key),se)!E.call(se,Fe)||Fe==="key"||Fe==="__self"||Fe==="__source"||Fe==="ref"&&se.ref===void 0||(Le[Fe]=se[Fe]);var Fe=arguments.length-2;if(Fe===1)Le.children=De;else if(1<Fe){for(var ft=Array(Fe),jt=0;jt<Fe;jt++)ft[jt]=arguments[jt+2];Le.children=ft}return A(L.type,Qe,Le)},Yt.createContext=function(L){return L={$$typeof:d,_currentValue:L,_currentValue2:L,_threadCount:0,Provider:null,Consumer:null},L.Provider=L,L.Consumer={$$typeof:u,_context:L},L},Yt.createElement=function(L,se,De){var Le,Qe={},Fe=null;if(se!=null)for(Le in se.key!==void 0&&(Fe=""+se.key),se)E.call(se,Le)&&Le!=="key"&&Le!=="__self"&&Le!=="__source"&&(Qe[Le]=se[Le]);var ft=arguments.length-2;if(ft===1)Qe.children=De;else if(1<ft){for(var jt=Array(ft),at=0;at<ft;at++)jt[at]=arguments[at+2];Qe.children=jt}if(L&&L.defaultProps)for(Le in ft=L.defaultProps,ft)Qe[Le]===void 0&&(Qe[Le]=ft[Le]);return A(L,Fe,Qe)},Yt.createRef=function(){return{current:null}},Yt.forwardRef=function(L){return{$$typeof:p,render:L}},Yt.isValidElement=D,Yt.lazy=function(L){return{$$typeof:w,_payload:{_status:-1,_result:L},_init:Ve}},Yt.memo=function(L,se){return{$$typeof:y,type:L,compare:se===void 0?null:se}},Yt.startTransition=function(L){var se=R.T,De={};R.T=De;try{var Le=L(),Qe=R.S;Qe!==null&&Qe(De,Le),typeof Le=="object"&&Le!==null&&typeof Le.then=="function"&&Le.then(_e,We)}catch(Fe){We(Fe)}finally{se!==null&&De.types!==null&&(se.types=De.types),R.T=se}},Yt.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},Yt.use=function(L){return R.H.use(L)},Yt.useActionState=function(L,se,De){return R.H.useActionState(L,se,De)},Yt.useCallback=function(L,se){return R.H.useCallback(L,se)},Yt.useContext=function(L){return R.H.useContext(L)},Yt.useDebugValue=function(){},Yt.useDeferredValue=function(L,se){return R.H.useDeferredValue(L,se)},Yt.useEffect=function(L,se){return R.H.useEffect(L,se)},Yt.useEffectEvent=function(L){return R.H.useEffectEvent(L)},Yt.useId=function(){return R.H.useId()},Yt.useImperativeHandle=function(L,se,De){return R.H.useImperativeHandle(L,se,De)},Yt.useInsertionEffect=function(L,se){return R.H.useInsertionEffect(L,se)},Yt.useLayoutEffect=function(L,se){return R.H.useLayoutEffect(L,se)},Yt.useMemo=function(L,se){return R.H.useMemo(L,se)},Yt.useOptimistic=function(L,se){return R.H.useOptimistic(L,se)},Yt.useReducer=function(L,se,De){return R.H.useReducer(L,se,De)},Yt.useRef=function(L){return R.H.useRef(L)},Yt.useState=function(L){return R.H.useState(L)},Yt.useSyncExternalStore=function(L,se,De){return R.H.useSyncExternalStore(L,se,De)},Yt.useTransition=function(){return R.H.useTransition()},Yt.version="19.2.4",Yt}var j1;function Pg(){return j1||(j1=1,yp.exports=_T()),yp.exports}var v=Pg(),bp={exports:{}},Gc={},vp={exports:{}},xp={};var T1;function kT(){return T1||(T1=1,(function(n){function e(W,pe){var Ve=W.length;W.push(pe);e:for(;0<Ve;){var We=Ve-1>>>1,ee=W[We];if(0<l(ee,pe))W[We]=pe,W[Ve]=ee,Ve=We;else break e}}function t(W){return W.length===0?null:W[0]}function i(W){if(W.length===0)return null;var pe=W[0],Ve=W.pop();if(Ve!==pe){W[0]=Ve;e:for(var We=0,ee=W.length,L=ee>>>1;We<L;){var se=2*(We+1)-1,De=W[se],Le=se+1,Qe=W[Le];if(0>l(De,Ve))Le<ee&&0>l(Qe,De)?(W[We]=Qe,W[Le]=Ve,We=Le):(W[We]=De,W[se]=Ve,We=se);else if(Le<ee&&0>l(Qe,Ve))W[We]=Qe,W[Le]=Ve,We=Le;else break e}}return pe}function l(W,pe){var Ve=W.sortIndex-pe.sortIndex;return Ve!==0?Ve:W.id-pe.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;n.unstable_now=function(){return u.now()}}else{var d=Date,p=d.now();n.unstable_now=function(){return d.now()-p}}var g=[],y=[],w=1,j=null,T=3,O=!1,$=!1,F=!1,B=!1,te=typeof setTimeout=="function"?setTimeout:null,K=typeof clearTimeout=="function"?clearTimeout:null,ae=typeof setImmediate<"u"?setImmediate:null;function be(W){for(var pe=t(y);pe!==null;){if(pe.callback===null)i(y);else if(pe.startTime<=W)i(y),pe.sortIndex=pe.expirationTime,e(g,pe);else break;pe=t(y)}}function ve(W){if(F=!1,be(W),!$)if(t(g)!==null)$=!0,_e||(_e=!0,H());else{var pe=t(y);pe!==null&&pt(ve,pe.startTime-W)}}var _e=!1,R=-1,E=5,A=-1;function V(){return B?!0:!(n.unstable_now()-A<E)}function D(){if(B=!1,_e){var W=n.unstable_now();A=W;var pe=!0;try{e:{$=!1,F&&(F=!1,K(R),R=-1),O=!0;var Ve=T;try{t:{for(be(W),j=t(g);j!==null&&!(j.expirationTime>W&&V());){var We=j.callback;if(typeof We=="function"){j.callback=null,T=j.priorityLevel;var ee=We(j.expirationTime<=W);if(W=n.unstable_now(),typeof ee=="function"){j.callback=ee,be(W),pe=!0;break t}j===t(g)&&i(g),be(W)}else i(g);j=t(g)}if(j!==null)pe=!0;else{var L=t(y);L!==null&&pt(ve,L.startTime-W),pe=!1}}break e}finally{j=null,T=Ve,O=!1}pe=void 0}}finally{pe?H():_e=!1}}}var H;if(typeof ae=="function")H=function(){ae(D)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,$e=M.port2;M.port1.onmessage=D,H=function(){$e.postMessage(null)}}else H=function(){te(D,0)};function pt(W,pe){R=te(function(){W(n.unstable_now())},pe)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(W){W.callback=null},n.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<W?Math.floor(1e3/W):5},n.unstable_getCurrentPriorityLevel=function(){return T},n.unstable_next=function(W){switch(T){case 1:case 2:case 3:var pe=3;break;default:pe=T}var Ve=T;T=pe;try{return W()}finally{T=Ve}},n.unstable_requestPaint=function(){B=!0},n.unstable_runWithPriority=function(W,pe){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var Ve=T;T=W;try{return pe()}finally{T=Ve}},n.unstable_scheduleCallback=function(W,pe,Ve){var We=n.unstable_now();switch(typeof Ve=="object"&&Ve!==null?(Ve=Ve.delay,Ve=typeof Ve=="number"&&0<Ve?We+Ve:We):Ve=We,W){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=Ve+ee,W={id:w++,callback:pe,priorityLevel:W,startTime:Ve,expirationTime:ee,sortIndex:-1},Ve>We?(W.sortIndex=Ve,e(y,W),t(g)===null&&W===t(y)&&(F?(K(R),R=-1):F=!0,pt(ve,Ve-We))):(W.sortIndex=ee,e(g,W),$||O||($=!0,_e||(_e=!0,H()))),W},n.unstable_shouldYield=V,n.unstable_wrapCallback=function(W){var pe=T;return function(){var Ve=T;T=pe;try{return W.apply(this,arguments)}finally{T=Ve}}}})(xp)),xp}var E1;function jT(){return E1||(E1=1,vp.exports=kT()),vp.exports}var wp={exports:{}},ar={};var S1;function TT(){if(S1)return ar;S1=1;var n=Pg();function e(g){var y="https://react.dev/errors/"+g;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var w=2;w<arguments.length;w++)y+="&args[]="+encodeURIComponent(arguments[w])}return"Minified React error #"+g+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},l=Symbol.for("react.portal");function u(g,y,w){var j=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:j==null?null:""+j,children:g,containerInfo:y,implementation:w}}var d=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(g,y){if(g==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return ar.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,ar.createPortal=function(g,y){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(e(299));return u(g,y,null,w)},ar.flushSync=function(g){var y=d.T,w=i.p;try{if(d.T=null,i.p=2,g)return g()}finally{d.T=y,i.p=w,i.d.f()}},ar.preconnect=function(g,y){typeof g=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,i.d.C(g,y))},ar.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},ar.preinit=function(g,y){if(typeof g=="string"&&y&&typeof y.as=="string"){var w=y.as,j=p(w,y.crossOrigin),T=typeof y.integrity=="string"?y.integrity:void 0,O=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;w==="style"?i.d.S(g,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:j,integrity:T,fetchPriority:O}):w==="script"&&i.d.X(g,{crossOrigin:j,integrity:T,fetchPriority:O,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},ar.preinitModule=function(g,y){if(typeof g=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var w=p(y.as,y.crossOrigin);i.d.M(g,{crossOrigin:w,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&i.d.M(g)},ar.preload=function(g,y){if(typeof g=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var w=y.as,j=p(w,y.crossOrigin);i.d.L(g,w,{crossOrigin:j,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},ar.preloadModule=function(g,y){if(typeof g=="string")if(y){var w=p(y.as,y.crossOrigin);i.d.m(g,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:w,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else i.d.m(g)},ar.requestFormReset=function(g){i.d.r(g)},ar.unstable_batchedUpdates=function(g,y){return g(y)},ar.useFormState=function(g,y,w){return d.H.useFormState(g,y,w)},ar.useFormStatus=function(){return d.H.useHostTransitionStatus()},ar.version="19.2.4",ar}var N1;function ET(){if(N1)return wp.exports;N1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),wp.exports=TT(),wp.exports}var C1;function ST(){if(C1)return Gc;C1=1;var n=jT(),e=Pg(),t=ET();function i(s){var a="https://react.dev/errors/"+s;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)a+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+s+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function u(s){var a=s,o=s;if(s.alternate)for(;a.return;)a=a.return;else{s=a;do a=s,(a.flags&4098)!==0&&(o=a.return),s=a.return;while(s)}return a.tag===3?o:null}function d(s){if(s.tag===13){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function p(s){if(s.tag===31){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function g(s){if(u(s)!==s)throw Error(i(188))}function y(s){var a=s.alternate;if(!a){if(a=u(s),a===null)throw Error(i(188));return a!==s?null:s}for(var o=s,c=a;;){var m=o.return;if(m===null)break;var f=m.alternate;if(f===null){if(c=m.return,c!==null){o=c;continue}break}if(m.child===f.child){for(f=m.child;f;){if(f===o)return g(m),s;if(f===c)return g(m),a;f=f.sibling}throw Error(i(188))}if(o.return!==c.return)o=m,c=f;else{for(var x=!1,S=m.child;S;){if(S===o){x=!0,o=m,c=f;break}if(S===c){x=!0,c=m,o=f;break}S=S.sibling}if(!x){for(S=f.child;S;){if(S===o){x=!0,o=f,c=m;break}if(S===c){x=!0,c=f,o=m;break}S=S.sibling}if(!x)throw Error(i(189))}}if(o.alternate!==c)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?s:a}function w(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s;for(s=s.child;s!==null;){if(a=w(s),a!==null)return a;s=s.sibling}return null}var j=Object.assign,T=Symbol.for("react.element"),O=Symbol.for("react.transitional.element"),$=Symbol.for("react.portal"),F=Symbol.for("react.fragment"),B=Symbol.for("react.strict_mode"),te=Symbol.for("react.profiler"),K=Symbol.for("react.consumer"),ae=Symbol.for("react.context"),be=Symbol.for("react.forward_ref"),ve=Symbol.for("react.suspense"),_e=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),A=Symbol.for("react.activity"),V=Symbol.for("react.memo_cache_sentinel"),D=Symbol.iterator;function H(s){return s===null||typeof s!="object"?null:(s=D&&s[D]||s["@@iterator"],typeof s=="function"?s:null)}var M=Symbol.for("react.client.reference");function $e(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===M?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case F:return"Fragment";case te:return"Profiler";case B:return"StrictMode";case ve:return"Suspense";case _e:return"SuspenseList";case A:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case $:return"Portal";case ae:return s.displayName||"Context";case K:return(s._context.displayName||"Context")+".Consumer";case be:var a=s.render;return s=s.displayName,s||(s=a.displayName||a.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case R:return a=s.displayName||null,a!==null?a:$e(s.type)||"Memo";case E:a=s._payload,s=s._init;try{return $e(s(a))}catch{}}return null}var pt=Array.isArray,W=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,pe=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ve={pending:!1,data:null,method:null,action:null},We=[],ee=-1;function L(s){return{current:s}}function se(s){0>ee||(s.current=We[ee],We[ee]=null,ee--)}function De(s,a){ee++,We[ee]=s.current,s.current=a}var Le=L(null),Qe=L(null),Fe=L(null),ft=L(null);function jt(s,a){switch(De(Fe,a),De(Qe,s),De(Le,null),a.nodeType){case 9:case 11:s=(s=a.documentElement)&&(s=s.namespaceURI)?H0(s):0;break;default:if(s=a.tagName,a=a.namespaceURI)a=H0(a),s=$0(a,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}se(Le),De(Le,s)}function at(){se(Le),se(Qe),se(Fe)}function Gt(s){s.memoizedState!==null&&De(ft,s);var a=Le.current,o=$0(a,s.type);a!==o&&(De(Qe,s),De(Le,o))}function _s(s){Qe.current===s&&(se(Le),se(Qe)),ft.current===s&&(se(ft),zc._currentValue=Ve)}var wt,gt;function le(s){if(wt===void 0)try{throw Error()}catch(o){var a=o.stack.trim().match(/\n( *(at )?)/);wt=a&&a[1]||"",gt=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+wt+s+gt}var Xt=!1;function Kt(s,a){if(!s||Xt)return"";Xt=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(a){var Me=function(){throw Error()};if(Object.defineProperty(Me.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Me,[])}catch(ye){var ce=ye}Reflect.construct(s,[],Me)}else{try{Me.call()}catch(ye){ce=ye}s.call(Me.prototype)}}else{try{throw Error()}catch(ye){ce=ye}(Me=s())&&typeof Me.catch=="function"&&Me.catch(function(){})}}catch(ye){if(ye&&ce&&typeof ye.stack=="string")return[ye.stack,ce.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var f=c.DetermineComponentFrameRoot(),x=f[0],S=f[1];if(x&&S){var z=x.split(`
`),oe=S.split(`
`);for(m=c=0;c<z.length&&!z[c].includes("DetermineComponentFrameRoot");)c++;for(;m<oe.length&&!oe[m].includes("DetermineComponentFrameRoot");)m++;if(c===z.length||m===oe.length)for(c=z.length-1,m=oe.length-1;1<=c&&0<=m&&z[c]!==oe[m];)m--;for(;1<=c&&0<=m;c--,m--)if(z[c]!==oe[m]){if(c!==1||m!==1)do if(c--,m--,0>m||z[c]!==oe[m]){var je=`
`+z[c].replace(" at new "," at ");return s.displayName&&je.includes("<anonymous>")&&(je=je.replace("<anonymous>",s.displayName)),je}while(1<=c&&0<=m);break}}}finally{Xt=!1,Error.prepareStackTrace=o}return(o=s?s.displayName||s.name:"")?le(o):""}function ut(s,a){switch(s.tag){case 26:case 27:case 5:return le(s.type);case 16:return le("Lazy");case 13:return s.child!==a&&a!==null?le("Suspense Fallback"):le("Suspense");case 19:return le("SuspenseList");case 0:case 15:return Kt(s.type,!1);case 11:return Kt(s.type.render,!1);case 1:return Kt(s.type,!0);case 31:return le("Activity");default:return""}}function bt(s){try{var a="",o=null;do a+=ut(s,o),o=s,s=s.return;while(s);return a}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var Xe=Object.prototype.hasOwnProperty,rt=n.unstable_scheduleCallback,qt=n.unstable_cancelCallback,en=n.unstable_shouldYield,As=n.unstable_requestPaint,ts=n.unstable_now,Ct=n.unstable_getCurrentPriorityLevel,Jt=n.unstable_ImmediatePriority,Ss=n.unstable_UserBlockingPriority,Ot=n.unstable_NormalPriority,Ps=n.unstable_LowPriority,ue=n.unstable_IdlePriority,Se=n.log,Ie=n.unstable_setDisableYieldValue,Ge=null,X=null;function he(s){if(typeof Se=="function"&&Ie(s),X&&typeof X.setStrictMode=="function")try{X.setStrictMode(Ge,s)}catch{}}var Pe=Math.clz32?Math.clz32:dt,qe=Math.log,Ae=Math.LN2;function dt(s){return s>>>=0,s===0?32:31-(qe(s)/Ae|0)|0}var Tt=256,Q=262144,de=4194304;function tt(s){var a=s&42;if(a!==0)return a;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function At(s,a,o){var c=s.pendingLanes;if(c===0)return 0;var m=0,f=s.suspendedLanes,x=s.pingedLanes;s=s.warmLanes;var S=c&134217727;return S!==0?(c=S&~f,c!==0?m=tt(c):(x&=S,x!==0?m=tt(x):o||(o=S&~s,o!==0&&(m=tt(o))))):(S=c&~f,S!==0?m=tt(S):x!==0?m=tt(x):o||(o=c&~s,o!==0&&(m=tt(o)))),m===0?0:a!==0&&a!==m&&(a&f)===0&&(f=m&-m,o=a&-a,f>=o||f===32&&(o&4194048)!==0)?a:m}function Et(s,a){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&a)===0}function ss(s,a){switch(s){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ut(){var s=de;return de<<=1,(de&62914560)===0&&(de=4194304),s}function Vt(s){for(var a=[],o=0;31>o;o++)a.push(s);return a}function Ls(s,a){s.pendingLanes|=a,a!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Xs(s,a,o,c,m,f){var x=s.pendingLanes;s.pendingLanes=o,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=o,s.entangledLanes&=o,s.errorRecoveryDisabledLanes&=o,s.shellSuspendCounter=0;var S=s.entanglements,z=s.expirationTimes,oe=s.hiddenUpdates;for(o=x&~o;0<o;){var je=31-Pe(o),Me=1<<je;S[je]=0,z[je]=-1;var ce=oe[je];if(ce!==null)for(oe[je]=null,je=0;je<ce.length;je++){var ye=ce[je];ye!==null&&(ye.lane&=-536870913)}o&=~Me}c!==0&&is(s,c,0),f!==0&&m===0&&s.tag!==0&&(s.suspendedLanes|=f&~(x&~a))}function is(s,a,o){s.pendingLanes|=a,s.suspendedLanes&=~a;var c=31-Pe(a);s.entangledLanes|=a,s.entanglements[c]=s.entanglements[c]|1073741824|o&261930}function Ns(s,a){var o=s.entangledLanes|=a;for(s=s.entanglements;o;){var c=31-Pe(o),m=1<<c;m&a|s[c]&a&&(s[c]|=a),o&=~m}}function Os(s,a){var o=a&-a;return o=(o&42)!==0?1:q(o),(o&(s.suspendedLanes|a))!==0?0:o}function q(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function we(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Te(){var s=pe.p;return s!==0?s:(s=window.event,s===void 0?32:f1(s.type))}function Ee(s,a){var o=pe.p;try{return pe.p=s,a()}finally{pe.p=o}}var ke=Math.random().toString(36).slice(2),lt="__reactFiber$"+ke,ht="__reactProps$"+ke,st="__reactContainer$"+ke,vt="__reactEvents$"+ke,It="__reactListeners$"+ke,ks="__reactHandles$"+ke,mn="__reactResources$"+ke,ln="__reactMarker$"+ke;function _n(s){delete s[lt],delete s[ht],delete s[vt],delete s[It],delete s[ks]}function kn(s){var a=s[lt];if(a)return a;for(var o=s.parentNode;o;){if(a=o[st]||o[lt]){if(o=a.alternate,a.child!==null||o!==null&&o.child!==null)for(s=J0(s);s!==null;){if(o=s[lt])return o;s=J0(s)}return a}s=o,o=s.parentNode}return null}function fn(s){if(s=s[lt]||s[st]){var a=s.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return s}return null}function Fs(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s.stateNode;throw Error(i(33))}function k(s){var a=s[mn];return a||(a=s[mn]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function N(s){s[ln]=!0}var P=new Set,U={};function me(s,a){Be(s,a),Be(s+"Capture",a)}function Be(s,a){for(U[s]=a,s=0;s<a.length;s++)P.add(a[s])}var Ue=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Je={},Ze={};function Ht(s){return Xe.call(Ze,s)?!0:Xe.call(Je,s)?!1:Ue.test(s)?Ze[s]=!0:(Je[s]=!0,!1)}function bs(s,a,o){if(Ht(a))if(o===null)s.removeAttribute(a);else{switch(typeof o){case"undefined":case"function":case"symbol":s.removeAttribute(a);return;case"boolean":var c=a.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){s.removeAttribute(a);return}}s.setAttribute(a,""+o)}}function os(s,a,o){if(o===null)s.removeAttribute(a);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(a);return}s.setAttribute(a,""+o)}}function ls(s,a,o,c){if(c===null)s.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttributeNS(a,o,""+c)}}function Cs(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Y(s){var a=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function xe(s,a,o){var c=Object.getOwnPropertyDescriptor(s.constructor.prototype,a);if(!s.hasOwnProperty(a)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var m=c.get,f=c.set;return Object.defineProperty(s,a,{configurable:!0,get:function(){return m.call(this)},set:function(x){o=""+x,f.call(this,x)}}),Object.defineProperty(s,a,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(x){o=""+x},stopTracking:function(){s._valueTracker=null,delete s[a]}}}}function ne(s){if(!s._valueTracker){var a=Y(s)?"checked":"value";s._valueTracker=xe(s,a,""+s[a])}}function Ke(s){if(!s)return!1;var a=s._valueTracker;if(!a)return!0;var o=a.getValue(),c="";return s&&(c=Y(s)?s.checked?"true":"false":s.value),s=c,s!==o?(a.setValue(s),!0):!1}function He(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var it=/[\n"\\]/g;function _t(s){return s.replace(it,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function Rt(s,a,o,c,m,f,x,S){s.name="",x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?s.type=x:s.removeAttribute("type"),a!=null?x==="number"?(a===0&&s.value===""||s.value!=a)&&(s.value=""+Cs(a)):s.value!==""+Cs(a)&&(s.value=""+Cs(a)):x!=="submit"&&x!=="reset"||s.removeAttribute("value"),a!=null?cn(s,x,Cs(a)):o!=null?cn(s,x,Cs(o)):c!=null&&s.removeAttribute("value"),m==null&&f!=null&&(s.defaultChecked=!!f),m!=null&&(s.checked=m&&typeof m!="function"&&typeof m!="symbol"),S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?s.name=""+Cs(S):s.removeAttribute("name")}function vs(s,a,o,c,m,f,x,S){if(f!=null&&typeof f!="function"&&typeof f!="symbol"&&typeof f!="boolean"&&(s.type=f),a!=null||o!=null){if(!(f!=="submit"&&f!=="reset"||a!=null)){ne(s);return}o=o!=null?""+Cs(o):"",a=a!=null?""+Cs(a):o,S||a===s.value||(s.value=a),s.defaultValue=a}c=c??m,c=typeof c!="function"&&typeof c!="symbol"&&!!c,s.checked=S?s.checked:!!c,s.defaultChecked=!!c,x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(s.name=x),ne(s)}function cn(s,a,o){a==="number"&&He(s.ownerDocument)===s||s.defaultValue===""+o||(s.defaultValue=""+o)}function hs(s,a,o,c){if(s=s.options,a){a={};for(var m=0;m<o.length;m++)a["$"+o[m]]=!0;for(o=0;o<s.length;o++)m=a.hasOwnProperty("$"+s[o].value),s[o].selected!==m&&(s[o].selected=m),m&&c&&(s[o].defaultSelected=!0)}else{for(o=""+Cs(o),a=null,m=0;m<s.length;m++){if(s[m].value===o){s[m].selected=!0,c&&(s[m].defaultSelected=!0);return}a!==null||s[m].disabled||(a=s[m])}a!==null&&(a.selected=!0)}}function Wn(s,a,o){if(a!=null&&(a=""+Cs(a),a!==s.value&&(s.value=a),o==null)){s.defaultValue!==a&&(s.defaultValue=a);return}s.defaultValue=o!=null?""+Cs(o):""}function Gr(s,a,o,c){if(a==null){if(c!=null){if(o!=null)throw Error(i(92));if(pt(c)){if(1<c.length)throw Error(i(93));c=c[0]}o=c}o==null&&(o=""),a=o}o=Cs(a),s.defaultValue=o,c=s.textContent,c===o&&c!==""&&c!==null&&(s.value=c),ne(s)}function pn(s,a){if(a){var o=s.firstChild;if(o&&o===s.lastChild&&o.nodeType===3){o.nodeValue=a;return}}s.textContent=a}var ja=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Un(s,a,o){var c=a.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?s.setProperty(a,""):a==="float"?s.cssFloat="":s[a]="":c?s.setProperty(a,o):typeof o!="number"||o===0||ja.has(a)?a==="float"?s.cssFloat=o:s[a]=(""+o).trim():s[a]=o+"px"}function as(s,a,o){if(a!=null&&typeof a!="object")throw Error(i(62));if(s=s.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||a!=null&&a.hasOwnProperty(c)||(c.indexOf("--")===0?s.setProperty(c,""):c==="float"?s.cssFloat="":s[c]="");for(var m in a)c=a[m],a.hasOwnProperty(m)&&o[m]!==c&&Un(s,m,c)}else for(var f in a)a.hasOwnProperty(f)&&Un(s,f,a[f])}function un(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sr=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Gn=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function _r(s){return Gn.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function tn(){}var Ln=null;function Nn(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var kr=null,jr=null;function Dr(s){var a=fn(s);if(a&&(s=a.stateNode)){var o=s[ht]||null;e:switch(s=a.stateNode,a.type){case"input":if(Rt(s,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),a=o.name,o.type==="radio"&&a!=null){for(o=s;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+_t(""+a)+'"][type="radio"]'),a=0;a<o.length;a++){var c=o[a];if(c!==s&&c.form===s.form){var m=c[ht]||null;if(!m)throw Error(i(90));Rt(c,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(a=0;a<o.length;a++)c=o[a],c.form===s.form&&Ke(c)}break e;case"textarea":Wn(s,o.value,o.defaultValue);break e;case"select":a=o.value,a!=null&&hs(s,!!o.multiple,a,!1)}}}var wi=!1;function Ta(s,a,o){if(wi)return s(a,o);wi=!0;try{var c=s(a);return c}finally{if(wi=!1,(kr!==null||jr!==null)&&(Ad(),kr&&(a=kr,s=jr,jr=kr=null,Dr(a),s)))for(a=0;a<s.length;a++)Dr(s[a])}}function Pr(s,a){var o=s.stateNode;if(o===null)return null;var c=o[ht]||null;if(c===null)return null;o=c[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(s=s.type,c=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!c;break e;default:s=!1}if(s)return null;if(o&&typeof o!="function")throw Error(i(231,a,typeof o));return o}var I=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Z=!1;if(I)try{var Ne={};Object.defineProperty(Ne,"passive",{get:function(){Z=!0}}),window.addEventListener("test",Ne,Ne),window.removeEventListener("test",Ne,Ne)}catch{Z=!1}var et=null,kt=null,Dt=null;function ot(){if(Dt)return Dt;var s,a=kt,o=a.length,c,m="value"in et?et.value:et.textContent,f=m.length;for(s=0;s<o&&a[s]===m[s];s++);var x=o-s;for(c=1;c<=x&&a[o-c]===m[f-c];c++);return Dt=m.slice(s,1<c?1-c:void 0)}function Bt(s){var a=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&a===13&&(s=13)):s=a,s===10&&(s=13),32<=s||s===13?s:0}function $t(){return!0}function rs(){return!1}function Ft(s){function a(o,c,m,f,x){this._reactName=o,this._targetInst=m,this.type=c,this.nativeEvent=f,this.target=x,this.currentTarget=null;for(var S in s)s.hasOwnProperty(S)&&(o=s[S],this[S]=o?o(f):f[S]);return this.isDefaultPrevented=(f.defaultPrevented!=null?f.defaultPrevented:f.returnValue===!1)?$t:rs,this.isPropagationStopped=rs,this}return j(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=$t)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=$t)},persist:function(){},isPersistent:$t}),a}var xs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Fn=Ft(xs),ur=j({},xs,{view:0,detail:0}),Js=Ft(ur),Ks,zn,dn,On=j({},ur,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_i,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==dn&&(dn&&s.type==="mousemove"?(Ks=s.screenX-dn.screenX,zn=s.screenY-dn.screenY):zn=Ks=0,dn=s),Ks)},movementY:function(s){return"movementY"in s?s.movementY:zn}}),nr=Ft(On),Kn=j({},On,{dataTransfer:0}),dr=Ft(Kn),rr=j({},ur,{relatedTarget:0}),gn=Ft(rr),hr=j({},xs,{animationName:0,elapsedTime:0,pseudoElement:0}),Tr=Ft(hr),Ha=j({},xs,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),tl=Ft(Ha),sl=j({},xs,{data:0}),mr=Ft(sl),ia={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},oa={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Wu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Gu(s){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(s):(s=Wu[s])?!!a[s]:!1}function _i(){return Gu}var fr=j({},ur,{key:function(s){if(s.key){var a=ia[s.key]||s.key;if(a!=="Unidentified")return a}return s.type==="keypress"?(s=Bt(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?oa[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_i,charCode:function(s){return s.type==="keypress"?Bt(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Bt(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Ku=Ft(fr),Yu=j({},On,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$a=Ft(Yu),h=j({},ur,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_i}),b=Ft(h),_=j({},xs,{propertyName:0,elapsedTime:0,pseudoElement:0}),C=Ft(_),re=j({},On,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),fe=Ft(re),Ye=j({},xs,{newState:0,oldState:0}),Zt=Ft(Ye),jn=[9,13,27,32],Vs=I&&"CompositionEvent"in window,rn=null;I&&"documentMode"in document&&(rn=document.documentMode);var Kr=I&&"TextEvent"in window&&!rn,Ea=I&&(!Vs||rn&&8<rn&&11>=rn),la=" ",ca=!1;function bo(s,a){switch(s){case"keyup":return jn.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function nl(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var rl=!1;function Hk(s,a){switch(s){case"compositionend":return nl(a);case"keypress":return a.which!==32?null:(ca=!0,la);case"textInput":return s=a.data,s===la&&ca?null:s;default:return null}}function $k(s,a){if(rl)return s==="compositionend"||!Vs&&bo(s,a)?(s=ot(),Dt=kt=et=null,rl=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Ea&&a.locale!=="ko"?null:a.data;default:return null}}var Wk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function tb(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a==="input"?!!Wk[s.type]:a==="textarea"}function sb(s,a,o,c){kr?jr?jr.push(c):jr=[c]:kr=c,a=Vd(a,"onChange"),0<a.length&&(o=new Fn("onChange","change",null,o,c),s.push({event:o,listeners:a}))}var uc=null,dc=null;function Gk(s){V0(s,0)}function Qu(s){var a=Fs(s);if(Ke(a))return s}function nb(s,a){if(s==="change")return a}var rb=!1;if(I){var _m;if(I){var km="oninput"in document;if(!km){var ab=document.createElement("div");ab.setAttribute("oninput","return;"),km=typeof ab.oninput=="function"}_m=km}else _m=!1;rb=_m&&(!document.documentMode||9<document.documentMode)}function ib(){uc&&(uc.detachEvent("onpropertychange",ob),dc=uc=null)}function ob(s){if(s.propertyName==="value"&&Qu(dc)){var a=[];sb(a,dc,s,Nn(s)),Ta(Gk,a)}}function Kk(s,a,o){s==="focusin"?(ib(),uc=a,dc=o,uc.attachEvent("onpropertychange",ob)):s==="focusout"&&ib()}function Yk(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Qu(dc)}function Qk(s,a){if(s==="click")return Qu(a)}function Xk(s,a){if(s==="input"||s==="change")return Qu(a)}function Jk(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var Lr=typeof Object.is=="function"?Object.is:Jk;function hc(s,a){if(Lr(s,a))return!0;if(typeof s!="object"||s===null||typeof a!="object"||a===null)return!1;var o=Object.keys(s),c=Object.keys(a);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var m=o[c];if(!Xe.call(a,m)||!Lr(s[m],a[m]))return!1}return!0}function lb(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function cb(s,a){var o=lb(s);s=0;for(var c;o;){if(o.nodeType===3){if(c=s+o.textContent.length,s<=a&&c>=a)return{node:o,offset:a-s};s=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=lb(o)}}function ub(s,a){return s&&a?s===a?!0:s&&s.nodeType===3?!1:a&&a.nodeType===3?ub(s,a.parentNode):"contains"in s?s.contains(a):s.compareDocumentPosition?!!(s.compareDocumentPosition(a)&16):!1:!1}function db(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var a=He(s.document);a instanceof s.HTMLIFrameElement;){try{var o=typeof a.contentWindow.location.href=="string"}catch{o=!1}if(o)s=a.contentWindow;else break;a=He(s.document)}return a}function jm(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a&&(a==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||a==="textarea"||s.contentEditable==="true")}var Zk=I&&"documentMode"in document&&11>=document.documentMode,al=null,Tm=null,mc=null,Em=!1;function hb(s,a,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Em||al==null||al!==He(c)||(c=al,"selectionStart"in c&&jm(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),mc&&hc(mc,c)||(mc=c,c=Vd(Tm,"onSelect"),0<c.length&&(a=new Fn("onSelect","select",null,a,o),s.push({event:a,listeners:c}),a.target=al)))}function vo(s,a){var o={};return o[s.toLowerCase()]=a.toLowerCase(),o["Webkit"+s]="webkit"+a,o["Moz"+s]="moz"+a,o}var il={animationend:vo("Animation","AnimationEnd"),animationiteration:vo("Animation","AnimationIteration"),animationstart:vo("Animation","AnimationStart"),transitionrun:vo("Transition","TransitionRun"),transitionstart:vo("Transition","TransitionStart"),transitioncancel:vo("Transition","TransitionCancel"),transitionend:vo("Transition","TransitionEnd")},Sm={},mb={};I&&(mb=document.createElement("div").style,"AnimationEvent"in window||(delete il.animationend.animation,delete il.animationiteration.animation,delete il.animationstart.animation),"TransitionEvent"in window||delete il.transitionend.transition);function xo(s){if(Sm[s])return Sm[s];if(!il[s])return s;var a=il[s],o;for(o in a)if(a.hasOwnProperty(o)&&o in mb)return Sm[s]=a[o];return s}var fb=xo("animationend"),pb=xo("animationiteration"),gb=xo("animationstart"),ej=xo("transitionrun"),tj=xo("transitionstart"),sj=xo("transitioncancel"),yb=xo("transitionend"),bb=new Map,Nm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Nm.push("scrollEnd");function ua(s,a){bb.set(s,a),me(a,[s])}var Xu=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Yr=[],ol=0,Cm=0;function Ju(){for(var s=ol,a=Cm=ol=0;a<s;){var o=Yr[a];Yr[a++]=null;var c=Yr[a];Yr[a++]=null;var m=Yr[a];Yr[a++]=null;var f=Yr[a];if(Yr[a++]=null,c!==null&&m!==null){var x=c.pending;x===null?m.next=m:(m.next=x.next,x.next=m),c.pending=m}f!==0&&vb(o,m,f)}}function Zu(s,a,o,c){Yr[ol++]=s,Yr[ol++]=a,Yr[ol++]=o,Yr[ol++]=c,Cm|=c,s.lanes|=c,s=s.alternate,s!==null&&(s.lanes|=c)}function Rm(s,a,o,c){return Zu(s,a,o,c),ed(s)}function wo(s,a){return Zu(s,null,null,a),ed(s)}function vb(s,a,o){s.lanes|=o;var c=s.alternate;c!==null&&(c.lanes|=o);for(var m=!1,f=s.return;f!==null;)f.childLanes|=o,c=f.alternate,c!==null&&(c.childLanes|=o),f.tag===22&&(s=f.stateNode,s===null||s._visibility&1||(m=!0)),s=f,f=f.return;return s.tag===3?(f=s.stateNode,m&&a!==null&&(m=31-Pe(o),s=f.hiddenUpdates,c=s[m],c===null?s[m]=[a]:c.push(a),a.lane=o|536870912),f):null}function ed(s){if(50<Pc)throw Pc=0,Uf=null,Error(i(185));for(var a=s.return;a!==null;)s=a,a=s.return;return s.tag===3?s.stateNode:null}var ll={};function nj(s,a,o,c){this.tag=s,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Or(s,a,o,c){return new nj(s,a,o,c)}function Am(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Wa(s,a){var o=s.alternate;return o===null?(o=Or(s.tag,a,s.key,s.mode),o.elementType=s.elementType,o.type=s.type,o.stateNode=s.stateNode,o.alternate=s,s.alternate=o):(o.pendingProps=a,o.type=s.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=s.flags&65011712,o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,a=s.dependencies,o.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},o.sibling=s.sibling,o.index=s.index,o.ref=s.ref,o.refCleanup=s.refCleanup,o}function xb(s,a){s.flags&=65011714;var o=s.alternate;return o===null?(s.childLanes=0,s.lanes=a,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,a=o.dependencies,s.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),s}function td(s,a,o,c,m,f){var x=0;if(c=s,typeof s=="function")Am(s)&&(x=1);else if(typeof s=="string")x=lT(s,o,Le.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case A:return s=Or(31,o,a,m),s.elementType=A,s.lanes=f,s;case F:return _o(o.children,m,f,a);case B:x=8,m|=24;break;case te:return s=Or(12,o,a,m|2),s.elementType=te,s.lanes=f,s;case ve:return s=Or(13,o,a,m),s.elementType=ve,s.lanes=f,s;case _e:return s=Or(19,o,a,m),s.elementType=_e,s.lanes=f,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case ae:x=10;break e;case K:x=9;break e;case be:x=11;break e;case R:x=14;break e;case E:x=16,c=null;break e}x=29,o=Error(i(130,s===null?"null":typeof s,"")),c=null}return a=Or(x,o,a,m),a.elementType=s,a.type=c,a.lanes=f,a}function _o(s,a,o,c){return s=Or(7,s,c,a),s.lanes=o,s}function Im(s,a,o){return s=Or(6,s,null,a),s.lanes=o,s}function wb(s){var a=Or(18,null,null,0);return a.stateNode=s,a}function Mm(s,a,o){return a=Or(4,s.children!==null?s.children:[],s.key,a),a.lanes=o,a.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},a}var _b=new WeakMap;function Qr(s,a){if(typeof s=="object"&&s!==null){var o=_b.get(s);return o!==void 0?o:(a={value:s,source:a,stack:bt(a)},_b.set(s,a),a)}return{value:s,source:a,stack:bt(a)}}var cl=[],ul=0,sd=null,fc=0,Xr=[],Jr=0,ki=null,Sa=1,Na="";function Ga(s,a){cl[ul++]=fc,cl[ul++]=sd,sd=s,fc=a}function kb(s,a,o){Xr[Jr++]=Sa,Xr[Jr++]=Na,Xr[Jr++]=ki,ki=s;var c=Sa;s=Na;var m=32-Pe(c)-1;c&=~(1<<m),o+=1;var f=32-Pe(a)+m;if(30<f){var x=m-m%5;f=(c&(1<<x)-1).toString(32),c>>=x,m-=x,Sa=1<<32-Pe(a)+m|o<<m|c,Na=f+s}else Sa=1<<f|o<<m|c,Na=s}function Dm(s){s.return!==null&&(Ga(s,1),kb(s,1,0))}function Pm(s){for(;s===sd;)sd=cl[--ul],cl[ul]=null,fc=cl[--ul],cl[ul]=null;for(;s===ki;)ki=Xr[--Jr],Xr[Jr]=null,Na=Xr[--Jr],Xr[Jr]=null,Sa=Xr[--Jr],Xr[Jr]=null}function jb(s,a){Xr[Jr++]=Sa,Xr[Jr++]=Na,Xr[Jr++]=ki,Sa=a.id,Na=a.overflow,ki=s}var Yn=null,sn=null,ws=!1,ji=null,Zr=!1,Lm=Error(i(519));function Ti(s){var a=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw pc(Qr(a,s)),Lm}function Tb(s){var a=s.stateNode,o=s.type,c=s.memoizedProps;switch(a[lt]=s,a[ht]=c,o){case"dialog":us("cancel",a),us("close",a);break;case"iframe":case"object":case"embed":us("load",a);break;case"video":case"audio":for(o=0;o<Oc.length;o++)us(Oc[o],a);break;case"source":us("error",a);break;case"img":case"image":case"link":us("error",a),us("load",a);break;case"details":us("toggle",a);break;case"input":us("invalid",a),vs(a,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":us("invalid",a);break;case"textarea":us("invalid",a),Gr(a,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||a.textContent===""+o||c.suppressHydrationWarning===!0||z0(a.textContent,o)?(c.popover!=null&&(us("beforetoggle",a),us("toggle",a)),c.onScroll!=null&&us("scroll",a),c.onScrollEnd!=null&&us("scrollend",a),c.onClick!=null&&(a.onclick=tn),a=!0):a=!1,a||Ti(s,!0)}function Eb(s){for(Yn=s.return;Yn;)switch(Yn.tag){case 5:case 31:case 13:Zr=!1;return;case 27:case 3:Zr=!0;return;default:Yn=Yn.return}}function dl(s){if(s!==Yn)return!1;if(!ws)return Eb(s),ws=!0,!1;var a=s.tag,o;if((o=a!==3&&a!==27)&&((o=a===5)&&(o=s.type,o=!(o!=="form"&&o!=="button")||tp(s.type,s.memoizedProps)),o=!o),o&&sn&&Ti(s),Eb(s),a===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));sn=X0(s)}else if(a===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));sn=X0(s)}else a===27?(a=sn,Bi(s.type)?(s=ip,ip=null,sn=s):sn=a):sn=Yn?ta(s.stateNode.nextSibling):null;return!0}function ko(){sn=Yn=null,ws=!1}function Om(){var s=ji;return s!==null&&(Cr===null?Cr=s:Cr.push.apply(Cr,s),ji=null),s}function pc(s){ji===null?ji=[s]:ji.push(s)}var Vm=L(null),jo=null,Ka=null;function Ei(s,a,o){De(Vm,a._currentValue),a._currentValue=o}function Ya(s){s._currentValue=Vm.current,se(Vm)}function Bm(s,a,o){for(;s!==null;){var c=s.alternate;if((s.childLanes&a)!==a?(s.childLanes|=a,c!==null&&(c.childLanes|=a)):c!==null&&(c.childLanes&a)!==a&&(c.childLanes|=a),s===o)break;s=s.return}}function Um(s,a,o,c){var m=s.child;for(m!==null&&(m.return=s);m!==null;){var f=m.dependencies;if(f!==null){var x=m.child;f=f.firstContext;e:for(;f!==null;){var S=f;f=m;for(var z=0;z<a.length;z++)if(S.context===a[z]){f.lanes|=o,S=f.alternate,S!==null&&(S.lanes|=o),Bm(f.return,o,s),c||(x=null);break e}f=S.next}}else if(m.tag===18){if(x=m.return,x===null)throw Error(i(341));x.lanes|=o,f=x.alternate,f!==null&&(f.lanes|=o),Bm(x,o,s),x=null}else x=m.child;if(x!==null)x.return=m;else for(x=m;x!==null;){if(x===s){x=null;break}if(m=x.sibling,m!==null){m.return=x.return,x=m;break}x=x.return}m=x}}function hl(s,a,o,c){s=null;for(var m=a,f=!1;m!==null;){if(!f){if((m.flags&524288)!==0)f=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var x=m.alternate;if(x===null)throw Error(i(387));if(x=x.memoizedProps,x!==null){var S=m.type;Lr(m.pendingProps.value,x.value)||(s!==null?s.push(S):s=[S])}}else if(m===ft.current){if(x=m.alternate,x===null)throw Error(i(387));x.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(s!==null?s.push(zc):s=[zc])}m=m.return}s!==null&&Um(a,s,o,c),a.flags|=262144}function nd(s){for(s=s.firstContext;s!==null;){if(!Lr(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function To(s){jo=s,Ka=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Qn(s){return Sb(jo,s)}function rd(s,a){return jo===null&&To(s),Sb(s,a)}function Sb(s,a){var o=a._currentValue;if(a={context:a,memoizedValue:o,next:null},Ka===null){if(s===null)throw Error(i(308));Ka=a,s.dependencies={lanes:0,firstContext:a},s.flags|=524288}else Ka=Ka.next=a;return o}var rj=typeof AbortController<"u"?AbortController:function(){var s=[],a=this.signal={aborted:!1,addEventListener:function(o,c){s.push(c)}};this.abort=function(){a.aborted=!0,s.forEach(function(o){return o()})}},aj=n.unstable_scheduleCallback,ij=n.unstable_NormalPriority,Cn={$$typeof:ae,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Fm(){return{controller:new rj,data:new Map,refCount:0}}function gc(s){s.refCount--,s.refCount===0&&aj(ij,function(){s.controller.abort()})}var yc=null,zm=0,ml=0,fl=null;function oj(s,a){if(yc===null){var o=yc=[];zm=0,ml=Wf(),fl={status:"pending",value:void 0,then:function(c){o.push(c)}}}return zm++,a.then(Nb,Nb),a}function Nb(){if(--zm===0&&yc!==null){fl!==null&&(fl.status="fulfilled");var s=yc;yc=null,ml=0,fl=null;for(var a=0;a<s.length;a++)(0,s[a])()}}function lj(s,a){var o=[],c={status:"pending",value:null,reason:null,then:function(m){o.push(m)}};return s.then(function(){c.status="fulfilled",c.value=a;for(var m=0;m<o.length;m++)(0,o[m])(a)},function(m){for(c.status="rejected",c.reason=m,m=0;m<o.length;m++)(0,o[m])(void 0)}),c}var Cb=W.S;W.S=function(s,a){h0=ts(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&oj(s,a),Cb!==null&&Cb(s,a)};var Eo=L(null);function qm(){var s=Eo.current;return s!==null?s:Ys.pooledCache}function ad(s,a){a===null?De(Eo,Eo.current):De(Eo,a.pool)}function Rb(){var s=qm();return s===null?null:{parent:Cn._currentValue,pool:s}}var pl=Error(i(460)),Hm=Error(i(474)),id=Error(i(542)),od={then:function(){}};function Ab(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Ib(s,a,o){switch(o=s[o],o===void 0?s.push(a):o!==a&&(a.then(tn,tn),a=o),a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,Db(s),s;default:if(typeof a.status=="string")a.then(tn,tn);else{if(s=Ys,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=a,s.status="pending",s.then(function(c){if(a.status==="pending"){var m=a;m.status="fulfilled",m.value=c}},function(c){if(a.status==="pending"){var m=a;m.status="rejected",m.reason=c}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,Db(s),s}throw No=a,pl}}function So(s){try{var a=s._init;return a(s._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(No=o,pl):o}}var No=null;function Mb(){if(No===null)throw Error(i(459));var s=No;return No=null,s}function Db(s){if(s===pl||s===id)throw Error(i(483))}var gl=null,bc=0;function ld(s){var a=bc;return bc+=1,gl===null&&(gl=[]),Ib(gl,s,a)}function vc(s,a){a=a.props.ref,s.ref=a!==void 0?a:null}function cd(s,a){throw a.$$typeof===T?Error(i(525)):(s=Object.prototype.toString.call(a),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":s)))}function Pb(s){function a(J,G){if(s){var ie=J.deletions;ie===null?(J.deletions=[G],J.flags|=16):ie.push(G)}}function o(J,G){if(!s)return null;for(;G!==null;)a(J,G),G=G.sibling;return null}function c(J){for(var G=new Map;J!==null;)J.key!==null?G.set(J.key,J):G.set(J.index,J),J=J.sibling;return G}function m(J,G){return J=Wa(J,G),J.index=0,J.sibling=null,J}function f(J,G,ie){return J.index=ie,s?(ie=J.alternate,ie!==null?(ie=ie.index,ie<G?(J.flags|=67108866,G):ie):(J.flags|=67108866,G)):(J.flags|=1048576,G)}function x(J){return s&&J.alternate===null&&(J.flags|=67108866),J}function S(J,G,ie,Re){return G===null||G.tag!==6?(G=Im(ie,J.mode,Re),G.return=J,G):(G=m(G,ie),G.return=J,G)}function z(J,G,ie,Re){var St=ie.type;return St===F?je(J,G,ie.props.children,Re,ie.key):G!==null&&(G.elementType===St||typeof St=="object"&&St!==null&&St.$$typeof===E&&So(St)===G.type)?(G=m(G,ie.props),vc(G,ie),G.return=J,G):(G=td(ie.type,ie.key,ie.props,null,J.mode,Re),vc(G,ie),G.return=J,G)}function oe(J,G,ie,Re){return G===null||G.tag!==4||G.stateNode.containerInfo!==ie.containerInfo||G.stateNode.implementation!==ie.implementation?(G=Mm(ie,J.mode,Re),G.return=J,G):(G=m(G,ie.children||[]),G.return=J,G)}function je(J,G,ie,Re,St){return G===null||G.tag!==7?(G=_o(ie,J.mode,Re,St),G.return=J,G):(G=m(G,ie),G.return=J,G)}function Me(J,G,ie){if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return G=Im(""+G,J.mode,ie),G.return=J,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case O:return ie=td(G.type,G.key,G.props,null,J.mode,ie),vc(ie,G),ie.return=J,ie;case $:return G=Mm(G,J.mode,ie),G.return=J,G;case E:return G=So(G),Me(J,G,ie)}if(pt(G)||H(G))return G=_o(G,J.mode,ie,null),G.return=J,G;if(typeof G.then=="function")return Me(J,ld(G),ie);if(G.$$typeof===ae)return Me(J,rd(J,G),ie);cd(J,G)}return null}function ce(J,G,ie,Re){var St=G!==null?G.key:null;if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return St!==null?null:S(J,G,""+ie,Re);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case O:return ie.key===St?z(J,G,ie,Re):null;case $:return ie.key===St?oe(J,G,ie,Re):null;case E:return ie=So(ie),ce(J,G,ie,Re)}if(pt(ie)||H(ie))return St!==null?null:je(J,G,ie,Re,null);if(typeof ie.then=="function")return ce(J,G,ld(ie),Re);if(ie.$$typeof===ae)return ce(J,G,rd(J,ie),Re);cd(J,ie)}return null}function ye(J,G,ie,Re,St){if(typeof Re=="string"&&Re!==""||typeof Re=="number"||typeof Re=="bigint")return J=J.get(ie)||null,S(G,J,""+Re,St);if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case O:return J=J.get(Re.key===null?ie:Re.key)||null,z(G,J,Re,St);case $:return J=J.get(Re.key===null?ie:Re.key)||null,oe(G,J,Re,St);case E:return Re=So(Re),ye(J,G,ie,Re,St)}if(pt(Re)||H(Re))return J=J.get(ie)||null,je(G,J,Re,St,null);if(typeof Re.then=="function")return ye(J,G,ie,ld(Re),St);if(Re.$$typeof===ae)return ye(J,G,ie,rd(G,Re),St);cd(G,Re)}return null}function mt(J,G,ie,Re){for(var St=null,Is=null,yt=G,ns=G=0,fs=null;yt!==null&&ns<ie.length;ns++){yt.index>ns?(fs=yt,yt=null):fs=yt.sibling;var Ms=ce(J,yt,ie[ns],Re);if(Ms===null){yt===null&&(yt=fs);break}s&&yt&&Ms.alternate===null&&a(J,yt),G=f(Ms,G,ns),Is===null?St=Ms:Is.sibling=Ms,Is=Ms,yt=fs}if(ns===ie.length)return o(J,yt),ws&&Ga(J,ns),St;if(yt===null){for(;ns<ie.length;ns++)yt=Me(J,ie[ns],Re),yt!==null&&(G=f(yt,G,ns),Is===null?St=yt:Is.sibling=yt,Is=yt);return ws&&Ga(J,ns),St}for(yt=c(yt);ns<ie.length;ns++)fs=ye(yt,J,ns,ie[ns],Re),fs!==null&&(s&&fs.alternate!==null&&yt.delete(fs.key===null?ns:fs.key),G=f(fs,G,ns),Is===null?St=fs:Is.sibling=fs,Is=fs);return s&&yt.forEach(function(Hi){return a(J,Hi)}),ws&&Ga(J,ns),St}function Mt(J,G,ie,Re){if(ie==null)throw Error(i(151));for(var St=null,Is=null,yt=G,ns=G=0,fs=null,Ms=ie.next();yt!==null&&!Ms.done;ns++,Ms=ie.next()){yt.index>ns?(fs=yt,yt=null):fs=yt.sibling;var Hi=ce(J,yt,Ms.value,Re);if(Hi===null){yt===null&&(yt=fs);break}s&&yt&&Hi.alternate===null&&a(J,yt),G=f(Hi,G,ns),Is===null?St=Hi:Is.sibling=Hi,Is=Hi,yt=fs}if(Ms.done)return o(J,yt),ws&&Ga(J,ns),St;if(yt===null){for(;!Ms.done;ns++,Ms=ie.next())Ms=Me(J,Ms.value,Re),Ms!==null&&(G=f(Ms,G,ns),Is===null?St=Ms:Is.sibling=Ms,Is=Ms);return ws&&Ga(J,ns),St}for(yt=c(yt);!Ms.done;ns++,Ms=ie.next())Ms=ye(yt,J,ns,Ms.value,Re),Ms!==null&&(s&&Ms.alternate!==null&&yt.delete(Ms.key===null?ns:Ms.key),G=f(Ms,G,ns),Is===null?St=Ms:Is.sibling=Ms,Is=Ms);return s&&yt.forEach(function(vT){return a(J,vT)}),ws&&Ga(J,ns),St}function Ws(J,G,ie,Re){if(typeof ie=="object"&&ie!==null&&ie.type===F&&ie.key===null&&(ie=ie.props.children),typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case O:e:{for(var St=ie.key;G!==null;){if(G.key===St){if(St=ie.type,St===F){if(G.tag===7){o(J,G.sibling),Re=m(G,ie.props.children),Re.return=J,J=Re;break e}}else if(G.elementType===St||typeof St=="object"&&St!==null&&St.$$typeof===E&&So(St)===G.type){o(J,G.sibling),Re=m(G,ie.props),vc(Re,ie),Re.return=J,J=Re;break e}o(J,G);break}else a(J,G);G=G.sibling}ie.type===F?(Re=_o(ie.props.children,J.mode,Re,ie.key),Re.return=J,J=Re):(Re=td(ie.type,ie.key,ie.props,null,J.mode,Re),vc(Re,ie),Re.return=J,J=Re)}return x(J);case $:e:{for(St=ie.key;G!==null;){if(G.key===St)if(G.tag===4&&G.stateNode.containerInfo===ie.containerInfo&&G.stateNode.implementation===ie.implementation){o(J,G.sibling),Re=m(G,ie.children||[]),Re.return=J,J=Re;break e}else{o(J,G);break}else a(J,G);G=G.sibling}Re=Mm(ie,J.mode,Re),Re.return=J,J=Re}return x(J);case E:return ie=So(ie),Ws(J,G,ie,Re)}if(pt(ie))return mt(J,G,ie,Re);if(H(ie)){if(St=H(ie),typeof St!="function")throw Error(i(150));return ie=St.call(ie),Mt(J,G,ie,Re)}if(typeof ie.then=="function")return Ws(J,G,ld(ie),Re);if(ie.$$typeof===ae)return Ws(J,G,rd(J,ie),Re);cd(J,ie)}return typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint"?(ie=""+ie,G!==null&&G.tag===6?(o(J,G.sibling),Re=m(G,ie),Re.return=J,J=Re):(o(J,G),Re=Im(ie,J.mode,Re),Re.return=J,J=Re),x(J)):o(J,G)}return function(J,G,ie,Re){try{bc=0;var St=Ws(J,G,ie,Re);return gl=null,St}catch(yt){if(yt===pl||yt===id)throw yt;var Is=Or(29,yt,null,J.mode);return Is.lanes=Re,Is.return=J,Is}}}var Co=Pb(!0),Lb=Pb(!1),Si=!1;function $m(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Wm(s,a){s=s.updateQueue,a.updateQueue===s&&(a.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Ni(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Ci(s,a,o){var c=s.updateQueue;if(c===null)return null;if(c=c.shared,(Bs&2)!==0){var m=c.pending;return m===null?a.next=a:(a.next=m.next,m.next=a),c.pending=a,a=ed(s),vb(s,null,o),a}return Zu(s,c,a,o),ed(s)}function xc(s,a,o){if(a=a.updateQueue,a!==null&&(a=a.shared,(o&4194048)!==0)){var c=a.lanes;c&=s.pendingLanes,o|=c,a.lanes=o,Ns(s,o)}}function Gm(s,a){var o=s.updateQueue,c=s.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var m=null,f=null;if(o=o.firstBaseUpdate,o!==null){do{var x={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};f===null?m=f=x:f=f.next=x,o=o.next}while(o!==null);f===null?m=f=a:f=f.next=a}else m=f=a;o={baseState:c.baseState,firstBaseUpdate:m,lastBaseUpdate:f,shared:c.shared,callbacks:c.callbacks},s.updateQueue=o;return}s=o.lastBaseUpdate,s===null?o.firstBaseUpdate=a:s.next=a,o.lastBaseUpdate=a}var Km=!1;function wc(){if(Km){var s=fl;if(s!==null)throw s}}function _c(s,a,o,c){Km=!1;var m=s.updateQueue;Si=!1;var f=m.firstBaseUpdate,x=m.lastBaseUpdate,S=m.shared.pending;if(S!==null){m.shared.pending=null;var z=S,oe=z.next;z.next=null,x===null?f=oe:x.next=oe,x=z;var je=s.alternate;je!==null&&(je=je.updateQueue,S=je.lastBaseUpdate,S!==x&&(S===null?je.firstBaseUpdate=oe:S.next=oe,je.lastBaseUpdate=z))}if(f!==null){var Me=m.baseState;x=0,je=oe=z=null,S=f;do{var ce=S.lane&-536870913,ye=ce!==S.lane;if(ye?(ms&ce)===ce:(c&ce)===ce){ce!==0&&ce===ml&&(Km=!0),je!==null&&(je=je.next={lane:0,tag:S.tag,payload:S.payload,callback:null,next:null});e:{var mt=s,Mt=S;ce=a;var Ws=o;switch(Mt.tag){case 1:if(mt=Mt.payload,typeof mt=="function"){Me=mt.call(Ws,Me,ce);break e}Me=mt;break e;case 3:mt.flags=mt.flags&-65537|128;case 0:if(mt=Mt.payload,ce=typeof mt=="function"?mt.call(Ws,Me,ce):mt,ce==null)break e;Me=j({},Me,ce);break e;case 2:Si=!0}}ce=S.callback,ce!==null&&(s.flags|=64,ye&&(s.flags|=8192),ye=m.callbacks,ye===null?m.callbacks=[ce]:ye.push(ce))}else ye={lane:ce,tag:S.tag,payload:S.payload,callback:S.callback,next:null},je===null?(oe=je=ye,z=Me):je=je.next=ye,x|=ce;if(S=S.next,S===null){if(S=m.shared.pending,S===null)break;ye=S,S=ye.next,ye.next=null,m.lastBaseUpdate=ye,m.shared.pending=null}}while(!0);je===null&&(z=Me),m.baseState=z,m.firstBaseUpdate=oe,m.lastBaseUpdate=je,f===null&&(m.shared.lanes=0),Di|=x,s.lanes=x,s.memoizedState=Me}}function Ob(s,a){if(typeof s!="function")throw Error(i(191,s));s.call(a)}function Vb(s,a){var o=s.callbacks;if(o!==null)for(s.callbacks=null,s=0;s<o.length;s++)Ob(o[s],a)}var yl=L(null),ud=L(0);function Bb(s,a){s=ri,De(ud,s),De(yl,a),ri=s|a.baseLanes}function Ym(){De(ud,ri),De(yl,yl.current)}function Qm(){ri=ud.current,se(yl),se(ud)}var Vr=L(null),ea=null;function Ri(s){var a=s.alternate;De(Tn,Tn.current&1),De(Vr,s),ea===null&&(a===null||yl.current!==null||a.memoizedState!==null)&&(ea=s)}function Xm(s){De(Tn,Tn.current),De(Vr,s),ea===null&&(ea=s)}function Ub(s){s.tag===22?(De(Tn,Tn.current),De(Vr,s),ea===null&&(ea=s)):Ai()}function Ai(){De(Tn,Tn.current),De(Vr,Vr.current)}function Br(s){se(Vr),ea===s&&(ea=null),se(Tn)}var Tn=L(0);function dd(s){for(var a=s;a!==null;){if(a.tag===13){var o=a.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||rp(o)||ap(o)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Qa=0,es=null,Hs=null,Rn=null,hd=!1,bl=!1,Ro=!1,md=0,kc=0,vl=null,cj=0;function yn(){throw Error(i(321))}function Jm(s,a){if(a===null)return!1;for(var o=0;o<a.length&&o<s.length;o++)if(!Lr(s[o],a[o]))return!1;return!0}function Zm(s,a,o,c,m,f){return Qa=f,es=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,W.H=s===null||s.memoizedState===null?kv:pf,Ro=!1,f=o(c,m),Ro=!1,bl&&(f=zb(a,o,c,m)),Fb(s),f}function Fb(s){W.H=Ec;var a=Hs!==null&&Hs.next!==null;if(Qa=0,Rn=Hs=es=null,hd=!1,kc=0,vl=null,a)throw Error(i(300));s===null||An||(s=s.dependencies,s!==null&&nd(s)&&(An=!0))}function zb(s,a,o,c){es=s;var m=0;do{if(bl&&(vl=null),kc=0,bl=!1,25<=m)throw Error(i(301));if(m+=1,Rn=Hs=null,s.updateQueue!=null){var f=s.updateQueue;f.lastEffect=null,f.events=null,f.stores=null,f.memoCache!=null&&(f.memoCache.index=0)}W.H=jv,f=a(o,c)}while(bl);return f}function uj(){var s=W.H,a=s.useState()[0];return a=typeof a.then=="function"?jc(a):a,s=s.useState()[0],(Hs!==null?Hs.memoizedState:null)!==s&&(es.flags|=1024),a}function ef(){var s=md!==0;return md=0,s}function tf(s,a,o){a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~o}function sf(s){if(hd){for(s=s.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}hd=!1}Qa=0,Rn=Hs=es=null,bl=!1,kc=md=0,vl=null}function pr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Rn===null?es.memoizedState=Rn=s:Rn=Rn.next=s,Rn}function En(){if(Hs===null){var s=es.alternate;s=s!==null?s.memoizedState:null}else s=Hs.next;var a=Rn===null?es.memoizedState:Rn.next;if(a!==null)Rn=a,Hs=s;else{if(s===null)throw es.alternate===null?Error(i(467)):Error(i(310));Hs=s,s={memoizedState:Hs.memoizedState,baseState:Hs.baseState,baseQueue:Hs.baseQueue,queue:Hs.queue,next:null},Rn===null?es.memoizedState=Rn=s:Rn=Rn.next=s}return Rn}function fd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function jc(s){var a=kc;return kc+=1,vl===null&&(vl=[]),s=Ib(vl,s,a),a=es,(Rn===null?a.memoizedState:Rn.next)===null&&(a=a.alternate,W.H=a===null||a.memoizedState===null?kv:pf),s}function pd(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return jc(s);if(s.$$typeof===ae)return Qn(s)}throw Error(i(438,String(s)))}function nf(s){var a=null,o=es.updateQueue;if(o!==null&&(a=o.memoCache),a==null){var c=es.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(a={data:c.data.map(function(m){return m.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),o===null&&(o=fd(),es.updateQueue=o),o.memoCache=a,o=a.data[a.index],o===void 0)for(o=a.data[a.index]=Array(s),c=0;c<s;c++)o[c]=V;return a.index++,o}function Xa(s,a){return typeof a=="function"?a(s):a}function gd(s){var a=En();return rf(a,Hs,s)}function rf(s,a,o){var c=s.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=o;var m=s.baseQueue,f=c.pending;if(f!==null){if(m!==null){var x=m.next;m.next=f.next,f.next=x}a.baseQueue=m=f,c.pending=null}if(f=s.baseState,m===null)s.memoizedState=f;else{a=m.next;var S=x=null,z=null,oe=a,je=!1;do{var Me=oe.lane&-536870913;if(Me!==oe.lane?(ms&Me)===Me:(Qa&Me)===Me){var ce=oe.revertLane;if(ce===0)z!==null&&(z=z.next={lane:0,revertLane:0,gesture:null,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null}),Me===ml&&(je=!0);else if((Qa&ce)===ce){oe=oe.next,ce===ml&&(je=!0);continue}else Me={lane:0,revertLane:oe.revertLane,gesture:null,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null},z===null?(S=z=Me,x=f):z=z.next=Me,es.lanes|=ce,Di|=ce;Me=oe.action,Ro&&o(f,Me),f=oe.hasEagerState?oe.eagerState:o(f,Me)}else ce={lane:Me,revertLane:oe.revertLane,gesture:oe.gesture,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null},z===null?(S=z=ce,x=f):z=z.next=ce,es.lanes|=Me,Di|=Me;oe=oe.next}while(oe!==null&&oe!==a);if(z===null?x=f:z.next=S,!Lr(f,s.memoizedState)&&(An=!0,je&&(o=fl,o!==null)))throw o;s.memoizedState=f,s.baseState=x,s.baseQueue=z,c.lastRenderedState=f}return m===null&&(c.lanes=0),[s.memoizedState,c.dispatch]}function af(s){var a=En(),o=a.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=s;var c=o.dispatch,m=o.pending,f=a.memoizedState;if(m!==null){o.pending=null;var x=m=m.next;do f=s(f,x.action),x=x.next;while(x!==m);Lr(f,a.memoizedState)||(An=!0),a.memoizedState=f,a.baseQueue===null&&(a.baseState=f),o.lastRenderedState=f}return[f,c]}function qb(s,a,o){var c=es,m=En(),f=ws;if(f){if(o===void 0)throw Error(i(407));o=o()}else o=a();var x=!Lr((Hs||m).memoizedState,o);if(x&&(m.memoizedState=o,An=!0),m=m.queue,cf(Wb.bind(null,c,m,s),[s]),m.getSnapshot!==a||x||Rn!==null&&Rn.memoizedState.tag&1){if(c.flags|=2048,xl(9,{destroy:void 0},$b.bind(null,c,m,o,a),null),Ys===null)throw Error(i(349));f||(Qa&127)!==0||Hb(c,a,o)}return o}function Hb(s,a,o){s.flags|=16384,s={getSnapshot:a,value:o},a=es.updateQueue,a===null?(a=fd(),es.updateQueue=a,a.stores=[s]):(o=a.stores,o===null?a.stores=[s]:o.push(s))}function $b(s,a,o,c){a.value=o,a.getSnapshot=c,Gb(a)&&Kb(s)}function Wb(s,a,o){return o(function(){Gb(a)&&Kb(s)})}function Gb(s){var a=s.getSnapshot;s=s.value;try{var o=a();return!Lr(s,o)}catch{return!0}}function Kb(s){var a=wo(s,2);a!==null&&Rr(a,s,2)}function of(s){var a=pr();if(typeof s=="function"){var o=s;if(s=o(),Ro){he(!0);try{o()}finally{he(!1)}}}return a.memoizedState=a.baseState=s,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xa,lastRenderedState:s},a}function Yb(s,a,o,c){return s.baseState=o,rf(s,Hs,typeof c=="function"?c:Xa)}function dj(s,a,o,c,m){if(vd(s))throw Error(i(485));if(s=a.action,s!==null){var f={payload:m,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(x){f.listeners.push(x)}};W.T!==null?o(!0):f.isTransition=!1,c(f),o=a.pending,o===null?(f.next=a.pending=f,Qb(a,f)):(f.next=o.next,a.pending=o.next=f)}}function Qb(s,a){var o=a.action,c=a.payload,m=s.state;if(a.isTransition){var f=W.T,x={};W.T=x;try{var S=o(m,c),z=W.S;z!==null&&z(x,S),Xb(s,a,S)}catch(oe){lf(s,a,oe)}finally{f!==null&&x.types!==null&&(f.types=x.types),W.T=f}}else try{f=o(m,c),Xb(s,a,f)}catch(oe){lf(s,a,oe)}}function Xb(s,a,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){Jb(s,a,c)},function(c){return lf(s,a,c)}):Jb(s,a,o)}function Jb(s,a,o){a.status="fulfilled",a.value=o,Zb(a),s.state=o,a=s.pending,a!==null&&(o=a.next,o===a?s.pending=null:(o=o.next,a.next=o,Qb(s,o)))}function lf(s,a,o){var c=s.pending;if(s.pending=null,c!==null){c=c.next;do a.status="rejected",a.reason=o,Zb(a),a=a.next;while(a!==c)}s.action=null}function Zb(s){s=s.listeners;for(var a=0;a<s.length;a++)(0,s[a])()}function ev(s,a){return a}function tv(s,a){if(ws){var o=Ys.formState;if(o!==null){e:{var c=es;if(ws){if(sn){t:{for(var m=sn,f=Zr;m.nodeType!==8;){if(!f){m=null;break t}if(m=ta(m.nextSibling),m===null){m=null;break t}}f=m.data,m=f==="F!"||f==="F"?m:null}if(m){sn=ta(m.nextSibling),c=m.data==="F!";break e}}Ti(c)}c=!1}c&&(a=o[0])}}return o=pr(),o.memoizedState=o.baseState=a,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ev,lastRenderedState:a},o.queue=c,o=xv.bind(null,es,c),c.dispatch=o,c=of(!1),f=ff.bind(null,es,!1,c.queue),c=pr(),m={state:a,dispatch:null,action:s,pending:null},c.queue=m,o=dj.bind(null,es,m,f,o),m.dispatch=o,c.memoizedState=s,[a,o,!1]}function sv(s){var a=En();return nv(a,Hs,s)}function nv(s,a,o){if(a=rf(s,a,ev)[0],s=gd(Xa)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var c=jc(a)}catch(x){throw x===pl?id:x}else c=a;a=En();var m=a.queue,f=m.dispatch;return o!==a.memoizedState&&(es.flags|=2048,xl(9,{destroy:void 0},hj.bind(null,m,o),null)),[c,f,s]}function hj(s,a){s.action=a}function rv(s){var a=En(),o=Hs;if(o!==null)return nv(a,o,s);En(),a=a.memoizedState,o=En();var c=o.queue.dispatch;return o.memoizedState=s,[a,c,!1]}function xl(s,a,o,c){return s={tag:s,create:o,deps:c,inst:a,next:null},a=es.updateQueue,a===null&&(a=fd(),es.updateQueue=a),o=a.lastEffect,o===null?a.lastEffect=s.next=s:(c=o.next,o.next=s,s.next=c,a.lastEffect=s),s}function av(){return En().memoizedState}function yd(s,a,o,c){var m=pr();es.flags|=s,m.memoizedState=xl(1|a,{destroy:void 0},o,c===void 0?null:c)}function bd(s,a,o,c){var m=En();c=c===void 0?null:c;var f=m.memoizedState.inst;Hs!==null&&c!==null&&Jm(c,Hs.memoizedState.deps)?m.memoizedState=xl(a,f,o,c):(es.flags|=s,m.memoizedState=xl(1|a,f,o,c))}function iv(s,a){yd(8390656,8,s,a)}function cf(s,a){bd(2048,8,s,a)}function mj(s){es.flags|=4;var a=es.updateQueue;if(a===null)a=fd(),es.updateQueue=a,a.events=[s];else{var o=a.events;o===null?a.events=[s]:o.push(s)}}function ov(s){var a=En().memoizedState;return mj({ref:a,nextImpl:s}),function(){if((Bs&2)!==0)throw Error(i(440));return a.impl.apply(void 0,arguments)}}function lv(s,a){return bd(4,2,s,a)}function cv(s,a){return bd(4,4,s,a)}function uv(s,a){if(typeof a=="function"){s=s();var o=a(s);return function(){typeof o=="function"?o():a(null)}}if(a!=null)return s=s(),a.current=s,function(){a.current=null}}function dv(s,a,o){o=o!=null?o.concat([s]):null,bd(4,4,uv.bind(null,a,s),o)}function uf(){}function hv(s,a){var o=En();a=a===void 0?null:a;var c=o.memoizedState;return a!==null&&Jm(a,c[1])?c[0]:(o.memoizedState=[s,a],s)}function mv(s,a){var o=En();a=a===void 0?null:a;var c=o.memoizedState;if(a!==null&&Jm(a,c[1]))return c[0];if(c=s(),Ro){he(!0);try{s()}finally{he(!1)}}return o.memoizedState=[c,a],c}function df(s,a,o){return o===void 0||(Qa&1073741824)!==0&&(ms&261930)===0?s.memoizedState=a:(s.memoizedState=o,s=f0(),es.lanes|=s,Di|=s,o)}function fv(s,a,o,c){return Lr(o,a)?o:yl.current!==null?(s=df(s,o,c),Lr(s,a)||(An=!0),s):(Qa&42)===0||(Qa&1073741824)!==0&&(ms&261930)===0?(An=!0,s.memoizedState=o):(s=f0(),es.lanes|=s,Di|=s,a)}function pv(s,a,o,c,m){var f=pe.p;pe.p=f!==0&&8>f?f:8;var x=W.T,S={};W.T=S,ff(s,!1,a,o);try{var z=m(),oe=W.S;if(oe!==null&&oe(S,z),z!==null&&typeof z=="object"&&typeof z.then=="function"){var je=lj(z,c);Tc(s,a,je,zr(s))}else Tc(s,a,c,zr(s))}catch(Me){Tc(s,a,{then:function(){},status:"rejected",reason:Me},zr())}finally{pe.p=f,x!==null&&S.types!==null&&(x.types=S.types),W.T=x}}function fj(){}function hf(s,a,o,c){if(s.tag!==5)throw Error(i(476));var m=gv(s).queue;pv(s,m,a,Ve,o===null?fj:function(){return yv(s),o(c)})}function gv(s){var a=s.memoizedState;if(a!==null)return a;a={memoizedState:Ve,baseState:Ve,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xa,lastRenderedState:Ve},next:null};var o={};return a.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xa,lastRenderedState:o},next:null},s.memoizedState=a,s=s.alternate,s!==null&&(s.memoizedState=a),a}function yv(s){var a=gv(s);a.next===null&&(a=s.alternate.memoizedState),Tc(s,a.next.queue,{},zr())}function mf(){return Qn(zc)}function bv(){return En().memoizedState}function vv(){return En().memoizedState}function pj(s){for(var a=s.return;a!==null;){switch(a.tag){case 24:case 3:var o=zr();s=Ni(o);var c=Ci(a,s,o);c!==null&&(Rr(c,a,o),xc(c,a,o)),a={cache:Fm()},s.payload=a;return}a=a.return}}function gj(s,a,o){var c=zr();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},vd(s)?wv(a,o):(o=Rm(s,a,o,c),o!==null&&(Rr(o,s,c),_v(o,a,c)))}function xv(s,a,o){var c=zr();Tc(s,a,o,c)}function Tc(s,a,o,c){var m={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(vd(s))wv(a,m);else{var f=s.alternate;if(s.lanes===0&&(f===null||f.lanes===0)&&(f=a.lastRenderedReducer,f!==null))try{var x=a.lastRenderedState,S=f(x,o);if(m.hasEagerState=!0,m.eagerState=S,Lr(S,x))return Zu(s,a,m,0),Ys===null&&Ju(),!1}catch{}if(o=Rm(s,a,m,c),o!==null)return Rr(o,s,c),_v(o,a,c),!0}return!1}function ff(s,a,o,c){if(c={lane:2,revertLane:Wf(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},vd(s)){if(a)throw Error(i(479))}else a=Rm(s,o,c,2),a!==null&&Rr(a,s,2)}function vd(s){var a=s.alternate;return s===es||a!==null&&a===es}function wv(s,a){bl=hd=!0;var o=s.pending;o===null?a.next=a:(a.next=o.next,o.next=a),s.pending=a}function _v(s,a,o){if((o&4194048)!==0){var c=a.lanes;c&=s.pendingLanes,o|=c,a.lanes=o,Ns(s,o)}}var Ec={readContext:Qn,use:pd,useCallback:yn,useContext:yn,useEffect:yn,useImperativeHandle:yn,useLayoutEffect:yn,useInsertionEffect:yn,useMemo:yn,useReducer:yn,useRef:yn,useState:yn,useDebugValue:yn,useDeferredValue:yn,useTransition:yn,useSyncExternalStore:yn,useId:yn,useHostTransitionStatus:yn,useFormState:yn,useActionState:yn,useOptimistic:yn,useMemoCache:yn,useCacheRefresh:yn};Ec.useEffectEvent=yn;var kv={readContext:Qn,use:pd,useCallback:function(s,a){return pr().memoizedState=[s,a===void 0?null:a],s},useContext:Qn,useEffect:iv,useImperativeHandle:function(s,a,o){o=o!=null?o.concat([s]):null,yd(4194308,4,uv.bind(null,a,s),o)},useLayoutEffect:function(s,a){return yd(4194308,4,s,a)},useInsertionEffect:function(s,a){yd(4,2,s,a)},useMemo:function(s,a){var o=pr();a=a===void 0?null:a;var c=s();if(Ro){he(!0);try{s()}finally{he(!1)}}return o.memoizedState=[c,a],c},useReducer:function(s,a,o){var c=pr();if(o!==void 0){var m=o(a);if(Ro){he(!0);try{o(a)}finally{he(!1)}}}else m=a;return c.memoizedState=c.baseState=m,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:m},c.queue=s,s=s.dispatch=gj.bind(null,es,s),[c.memoizedState,s]},useRef:function(s){var a=pr();return s={current:s},a.memoizedState=s},useState:function(s){s=of(s);var a=s.queue,o=xv.bind(null,es,a);return a.dispatch=o,[s.memoizedState,o]},useDebugValue:uf,useDeferredValue:function(s,a){var o=pr();return df(o,s,a)},useTransition:function(){var s=of(!1);return s=pv.bind(null,es,s.queue,!0,!1),pr().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,a,o){var c=es,m=pr();if(ws){if(o===void 0)throw Error(i(407));o=o()}else{if(o=a(),Ys===null)throw Error(i(349));(ms&127)!==0||Hb(c,a,o)}m.memoizedState=o;var f={value:o,getSnapshot:a};return m.queue=f,iv(Wb.bind(null,c,f,s),[s]),c.flags|=2048,xl(9,{destroy:void 0},$b.bind(null,c,f,o,a),null),o},useId:function(){var s=pr(),a=Ys.identifierPrefix;if(ws){var o=Na,c=Sa;o=(c&~(1<<32-Pe(c)-1)).toString(32)+o,a="_"+a+"R_"+o,o=md++,0<o&&(a+="H"+o.toString(32)),a+="_"}else o=cj++,a="_"+a+"r_"+o.toString(32)+"_";return s.memoizedState=a},useHostTransitionStatus:mf,useFormState:tv,useActionState:tv,useOptimistic:function(s){var a=pr();a.memoizedState=a.baseState=s;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=o,a=ff.bind(null,es,!0,o),o.dispatch=a,[s,a]},useMemoCache:nf,useCacheRefresh:function(){return pr().memoizedState=pj.bind(null,es)},useEffectEvent:function(s){var a=pr(),o={impl:s};return a.memoizedState=o,function(){if((Bs&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},pf={readContext:Qn,use:pd,useCallback:hv,useContext:Qn,useEffect:cf,useImperativeHandle:dv,useInsertionEffect:lv,useLayoutEffect:cv,useMemo:mv,useReducer:gd,useRef:av,useState:function(){return gd(Xa)},useDebugValue:uf,useDeferredValue:function(s,a){var o=En();return fv(o,Hs.memoizedState,s,a)},useTransition:function(){var s=gd(Xa)[0],a=En().memoizedState;return[typeof s=="boolean"?s:jc(s),a]},useSyncExternalStore:qb,useId:bv,useHostTransitionStatus:mf,useFormState:sv,useActionState:sv,useOptimistic:function(s,a){var o=En();return Yb(o,Hs,s,a)},useMemoCache:nf,useCacheRefresh:vv};pf.useEffectEvent=ov;var jv={readContext:Qn,use:pd,useCallback:hv,useContext:Qn,useEffect:cf,useImperativeHandle:dv,useInsertionEffect:lv,useLayoutEffect:cv,useMemo:mv,useReducer:af,useRef:av,useState:function(){return af(Xa)},useDebugValue:uf,useDeferredValue:function(s,a){var o=En();return Hs===null?df(o,s,a):fv(o,Hs.memoizedState,s,a)},useTransition:function(){var s=af(Xa)[0],a=En().memoizedState;return[typeof s=="boolean"?s:jc(s),a]},useSyncExternalStore:qb,useId:bv,useHostTransitionStatus:mf,useFormState:rv,useActionState:rv,useOptimistic:function(s,a){var o=En();return Hs!==null?Yb(o,Hs,s,a):(o.baseState=s,[s,o.queue.dispatch])},useMemoCache:nf,useCacheRefresh:vv};jv.useEffectEvent=ov;function gf(s,a,o,c){a=s.memoizedState,o=o(c,a),o=o==null?a:j({},a,o),s.memoizedState=o,s.lanes===0&&(s.updateQueue.baseState=o)}var yf={enqueueSetState:function(s,a,o){s=s._reactInternals;var c=zr(),m=Ni(c);m.payload=a,o!=null&&(m.callback=o),a=Ci(s,m,c),a!==null&&(Rr(a,s,c),xc(a,s,c))},enqueueReplaceState:function(s,a,o){s=s._reactInternals;var c=zr(),m=Ni(c);m.tag=1,m.payload=a,o!=null&&(m.callback=o),a=Ci(s,m,c),a!==null&&(Rr(a,s,c),xc(a,s,c))},enqueueForceUpdate:function(s,a){s=s._reactInternals;var o=zr(),c=Ni(o);c.tag=2,a!=null&&(c.callback=a),a=Ci(s,c,o),a!==null&&(Rr(a,s,o),xc(a,s,o))}};function Tv(s,a,o,c,m,f,x){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(c,f,x):a.prototype&&a.prototype.isPureReactComponent?!hc(o,c)||!hc(m,f):!0}function Ev(s,a,o,c){s=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(o,c),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(o,c),a.state!==s&&yf.enqueueReplaceState(a,a.state,null)}function Ao(s,a){var o=a;if("ref"in a){o={};for(var c in a)c!=="ref"&&(o[c]=a[c])}if(s=s.defaultProps){o===a&&(o=j({},o));for(var m in s)o[m]===void 0&&(o[m]=s[m])}return o}function Sv(s){Xu(s)}function Nv(s){console.error(s)}function Cv(s){Xu(s)}function xd(s,a){try{var o=s.onUncaughtError;o(a.value,{componentStack:a.stack})}catch(c){setTimeout(function(){throw c})}}function Rv(s,a,o){try{var c=s.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function bf(s,a,o){return o=Ni(o),o.tag=3,o.payload={element:null},o.callback=function(){xd(s,a)},o}function Av(s){return s=Ni(s),s.tag=3,s}function Iv(s,a,o,c){var m=o.type.getDerivedStateFromError;if(typeof m=="function"){var f=c.value;s.payload=function(){return m(f)},s.callback=function(){Rv(a,o,c)}}var x=o.stateNode;x!==null&&typeof x.componentDidCatch=="function"&&(s.callback=function(){Rv(a,o,c),typeof m!="function"&&(Pi===null?Pi=new Set([this]):Pi.add(this));var S=c.stack;this.componentDidCatch(c.value,{componentStack:S!==null?S:""})})}function yj(s,a,o,c,m){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(a=o.alternate,a!==null&&hl(a,o,m,!0),o=Vr.current,o!==null){switch(o.tag){case 31:case 13:return ea===null?Id():o.alternate===null&&bn===0&&(bn=3),o.flags&=-257,o.flags|=65536,o.lanes=m,c===od?o.flags|=16384:(a=o.updateQueue,a===null?o.updateQueue=new Set([c]):a.add(c),qf(s,c,m)),!1;case 22:return o.flags|=65536,c===od?o.flags|=16384:(a=o.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=a):(o=a.retryQueue,o===null?a.retryQueue=new Set([c]):o.add(c)),qf(s,c,m)),!1}throw Error(i(435,o.tag))}return qf(s,c,m),Id(),!1}if(ws)return a=Vr.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=m,c!==Lm&&(s=Error(i(422),{cause:c}),pc(Qr(s,o)))):(c!==Lm&&(a=Error(i(423),{cause:c}),pc(Qr(a,o))),s=s.current.alternate,s.flags|=65536,m&=-m,s.lanes|=m,c=Qr(c,o),m=bf(s.stateNode,c,m),Gm(s,m),bn!==4&&(bn=2)),!1;var f=Error(i(520),{cause:c});if(f=Qr(f,o),Dc===null?Dc=[f]:Dc.push(f),bn!==4&&(bn=2),a===null)return!0;c=Qr(c,o),o=a;do{switch(o.tag){case 3:return o.flags|=65536,s=m&-m,o.lanes|=s,s=bf(o.stateNode,c,s),Gm(o,s),!1;case 1:if(a=o.type,f=o.stateNode,(o.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||f!==null&&typeof f.componentDidCatch=="function"&&(Pi===null||!Pi.has(f))))return o.flags|=65536,m&=-m,o.lanes|=m,m=Av(m),Iv(m,s,o,c),Gm(o,m),!1}o=o.return}while(o!==null);return!1}var vf=Error(i(461)),An=!1;function Xn(s,a,o,c){a.child=s===null?Lb(a,null,o,c):Co(a,s.child,o,c)}function Mv(s,a,o,c,m){o=o.render;var f=a.ref;if("ref"in c){var x={};for(var S in c)S!=="ref"&&(x[S]=c[S])}else x=c;return To(a),c=Zm(s,a,o,x,f,m),S=ef(),s!==null&&!An?(tf(s,a,m),Ja(s,a,m)):(ws&&S&&Dm(a),a.flags|=1,Xn(s,a,c,m),a.child)}function Dv(s,a,o,c,m){if(s===null){var f=o.type;return typeof f=="function"&&!Am(f)&&f.defaultProps===void 0&&o.compare===null?(a.tag=15,a.type=f,Pv(s,a,f,c,m)):(s=td(o.type,null,c,a,a.mode,m),s.ref=a.ref,s.return=a,a.child=s)}if(f=s.child,!Sf(s,m)){var x=f.memoizedProps;if(o=o.compare,o=o!==null?o:hc,o(x,c)&&s.ref===a.ref)return Ja(s,a,m)}return a.flags|=1,s=Wa(f,c),s.ref=a.ref,s.return=a,a.child=s}function Pv(s,a,o,c,m){if(s!==null){var f=s.memoizedProps;if(hc(f,c)&&s.ref===a.ref)if(An=!1,a.pendingProps=c=f,Sf(s,m))(s.flags&131072)!==0&&(An=!0);else return a.lanes=s.lanes,Ja(s,a,m)}return xf(s,a,o,c,m)}function Lv(s,a,o,c){var m=c.children,f=s!==null?s.memoizedState:null;if(s===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((a.flags&128)!==0){if(f=f!==null?f.baseLanes|o:o,s!==null){for(c=a.child=s.child,m=0;c!==null;)m=m|c.lanes|c.childLanes,c=c.sibling;c=m&~f}else c=0,a.child=null;return Ov(s,a,f,o,c)}if((o&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},s!==null&&ad(a,f!==null?f.cachePool:null),f!==null?Bb(a,f):Ym(),Ub(a);else return c=a.lanes=536870912,Ov(s,a,f!==null?f.baseLanes|o:o,o,c)}else f!==null?(ad(a,f.cachePool),Bb(a,f),Ai(),a.memoizedState=null):(s!==null&&ad(a,null),Ym(),Ai());return Xn(s,a,m,o),a.child}function Sc(s,a){return s!==null&&s.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function Ov(s,a,o,c,m){var f=qm();return f=f===null?null:{parent:Cn._currentValue,pool:f},a.memoizedState={baseLanes:o,cachePool:f},s!==null&&ad(a,null),Ym(),Ub(a),s!==null&&hl(s,a,c,!0),a.childLanes=m,null}function wd(s,a){return a=kd({mode:a.mode,children:a.children},s.mode),a.ref=s.ref,s.child=a,a.return=s,a}function Vv(s,a,o){return Co(a,s.child,null,o),s=wd(a,a.pendingProps),s.flags|=2,Br(a),a.memoizedState=null,s}function bj(s,a,o){var c=a.pendingProps,m=(a.flags&128)!==0;if(a.flags&=-129,s===null){if(ws){if(c.mode==="hidden")return s=wd(a,c),a.lanes=536870912,Sc(null,s);if(Xm(a),(s=sn)?(s=Q0(s,Zr),s=s!==null&&s.data==="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:ki!==null?{id:Sa,overflow:Na}:null,retryLane:536870912,hydrationErrors:null},o=wb(s),o.return=a,a.child=o,Yn=a,sn=null)):s=null,s===null)throw Ti(a);return a.lanes=536870912,null}return wd(a,c)}var f=s.memoizedState;if(f!==null){var x=f.dehydrated;if(Xm(a),m)if(a.flags&256)a.flags&=-257,a=Vv(s,a,o);else if(a.memoizedState!==null)a.child=s.child,a.flags|=128,a=null;else throw Error(i(558));else if(An||hl(s,a,o,!1),m=(o&s.childLanes)!==0,An||m){if(c=Ys,c!==null&&(x=Os(c,o),x!==0&&x!==f.retryLane))throw f.retryLane=x,wo(s,x),Rr(c,s,x),vf;Id(),a=Vv(s,a,o)}else s=f.treeContext,sn=ta(x.nextSibling),Yn=a,ws=!0,ji=null,Zr=!1,s!==null&&jb(a,s),a=wd(a,c),a.flags|=4096;return a}return s=Wa(s.child,{mode:c.mode,children:c.children}),s.ref=a.ref,a.child=s,s.return=a,s}function _d(s,a){var o=a.ref;if(o===null)s!==null&&s.ref!==null&&(a.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(s===null||s.ref!==o)&&(a.flags|=4194816)}}function xf(s,a,o,c,m){return To(a),o=Zm(s,a,o,c,void 0,m),c=ef(),s!==null&&!An?(tf(s,a,m),Ja(s,a,m)):(ws&&c&&Dm(a),a.flags|=1,Xn(s,a,o,m),a.child)}function Bv(s,a,o,c,m,f){return To(a),a.updateQueue=null,o=zb(a,c,o,m),Fb(s),c=ef(),s!==null&&!An?(tf(s,a,f),Ja(s,a,f)):(ws&&c&&Dm(a),a.flags|=1,Xn(s,a,o,f),a.child)}function Uv(s,a,o,c,m){if(To(a),a.stateNode===null){var f=ll,x=o.contextType;typeof x=="object"&&x!==null&&(f=Qn(x)),f=new o(c,f),a.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,f.updater=yf,a.stateNode=f,f._reactInternals=a,f=a.stateNode,f.props=c,f.state=a.memoizedState,f.refs={},$m(a),x=o.contextType,f.context=typeof x=="object"&&x!==null?Qn(x):ll,f.state=a.memoizedState,x=o.getDerivedStateFromProps,typeof x=="function"&&(gf(a,o,x,c),f.state=a.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(x=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),x!==f.state&&yf.enqueueReplaceState(f,f.state,null),_c(a,c,f,m),wc(),f.state=a.memoizedState),typeof f.componentDidMount=="function"&&(a.flags|=4194308),c=!0}else if(s===null){f=a.stateNode;var S=a.memoizedProps,z=Ao(o,S);f.props=z;var oe=f.context,je=o.contextType;x=ll,typeof je=="object"&&je!==null&&(x=Qn(je));var Me=o.getDerivedStateFromProps;je=typeof Me=="function"||typeof f.getSnapshotBeforeUpdate=="function",S=a.pendingProps!==S,je||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(S||oe!==x)&&Ev(a,f,c,x),Si=!1;var ce=a.memoizedState;f.state=ce,_c(a,c,f,m),wc(),oe=a.memoizedState,S||ce!==oe||Si?(typeof Me=="function"&&(gf(a,o,Me,c),oe=a.memoizedState),(z=Si||Tv(a,o,z,c,ce,oe,x))?(je||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(a.flags|=4194308)):(typeof f.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=c,a.memoizedState=oe),f.props=c,f.state=oe,f.context=x,c=z):(typeof f.componentDidMount=="function"&&(a.flags|=4194308),c=!1)}else{f=a.stateNode,Wm(s,a),x=a.memoizedProps,je=Ao(o,x),f.props=je,Me=a.pendingProps,ce=f.context,oe=o.contextType,z=ll,typeof oe=="object"&&oe!==null&&(z=Qn(oe)),S=o.getDerivedStateFromProps,(oe=typeof S=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(x!==Me||ce!==z)&&Ev(a,f,c,z),Si=!1,ce=a.memoizedState,f.state=ce,_c(a,c,f,m),wc();var ye=a.memoizedState;x!==Me||ce!==ye||Si||s!==null&&s.dependencies!==null&&nd(s.dependencies)?(typeof S=="function"&&(gf(a,o,S,c),ye=a.memoizedState),(je=Si||Tv(a,o,je,c,ce,ye,z)||s!==null&&s.dependencies!==null&&nd(s.dependencies))?(oe||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(c,ye,z),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(c,ye,z)),typeof f.componentDidUpdate=="function"&&(a.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof f.componentDidUpdate!="function"||x===s.memoizedProps&&ce===s.memoizedState||(a.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||x===s.memoizedProps&&ce===s.memoizedState||(a.flags|=1024),a.memoizedProps=c,a.memoizedState=ye),f.props=c,f.state=ye,f.context=z,c=je):(typeof f.componentDidUpdate!="function"||x===s.memoizedProps&&ce===s.memoizedState||(a.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||x===s.memoizedProps&&ce===s.memoizedState||(a.flags|=1024),c=!1)}return f=c,_d(s,a),c=(a.flags&128)!==0,f||c?(f=a.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:f.render(),a.flags|=1,s!==null&&c?(a.child=Co(a,s.child,null,m),a.child=Co(a,null,o,m)):Xn(s,a,o,m),a.memoizedState=f.state,s=a.child):s=Ja(s,a,m),s}function Fv(s,a,o,c){return ko(),a.flags|=256,Xn(s,a,o,c),a.child}var wf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function _f(s){return{baseLanes:s,cachePool:Rb()}}function kf(s,a,o){return s=s!==null?s.childLanes&~o:0,a&&(s|=Fr),s}function zv(s,a,o){var c=a.pendingProps,m=!1,f=(a.flags&128)!==0,x;if((x=f)||(x=s!==null&&s.memoizedState===null?!1:(Tn.current&2)!==0),x&&(m=!0,a.flags&=-129),x=(a.flags&32)!==0,a.flags&=-33,s===null){if(ws){if(m?Ri(a):Ai(),(s=sn)?(s=Q0(s,Zr),s=s!==null&&s.data!=="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:ki!==null?{id:Sa,overflow:Na}:null,retryLane:536870912,hydrationErrors:null},o=wb(s),o.return=a,a.child=o,Yn=a,sn=null)):s=null,s===null)throw Ti(a);return ap(s)?a.lanes=32:a.lanes=536870912,null}var S=c.children;return c=c.fallback,m?(Ai(),m=a.mode,S=kd({mode:"hidden",children:S},m),c=_o(c,m,o,null),S.return=a,c.return=a,S.sibling=c,a.child=S,c=a.child,c.memoizedState=_f(o),c.childLanes=kf(s,x,o),a.memoizedState=wf,Sc(null,c)):(Ri(a),jf(a,S))}var z=s.memoizedState;if(z!==null&&(S=z.dehydrated,S!==null)){if(f)a.flags&256?(Ri(a),a.flags&=-257,a=Tf(s,a,o)):a.memoizedState!==null?(Ai(),a.child=s.child,a.flags|=128,a=null):(Ai(),S=c.fallback,m=a.mode,c=kd({mode:"visible",children:c.children},m),S=_o(S,m,o,null),S.flags|=2,c.return=a,S.return=a,c.sibling=S,a.child=c,Co(a,s.child,null,o),c=a.child,c.memoizedState=_f(o),c.childLanes=kf(s,x,o),a.memoizedState=wf,a=Sc(null,c));else if(Ri(a),ap(S)){if(x=S.nextSibling&&S.nextSibling.dataset,x)var oe=x.dgst;x=oe,c=Error(i(419)),c.stack="",c.digest=x,pc({value:c,source:null,stack:null}),a=Tf(s,a,o)}else if(An||hl(s,a,o,!1),x=(o&s.childLanes)!==0,An||x){if(x=Ys,x!==null&&(c=Os(x,o),c!==0&&c!==z.retryLane))throw z.retryLane=c,wo(s,c),Rr(x,s,c),vf;rp(S)||Id(),a=Tf(s,a,o)}else rp(S)?(a.flags|=192,a.child=s.child,a=null):(s=z.treeContext,sn=ta(S.nextSibling),Yn=a,ws=!0,ji=null,Zr=!1,s!==null&&jb(a,s),a=jf(a,c.children),a.flags|=4096);return a}return m?(Ai(),S=c.fallback,m=a.mode,z=s.child,oe=z.sibling,c=Wa(z,{mode:"hidden",children:c.children}),c.subtreeFlags=z.subtreeFlags&65011712,oe!==null?S=Wa(oe,S):(S=_o(S,m,o,null),S.flags|=2),S.return=a,c.return=a,c.sibling=S,a.child=c,Sc(null,c),c=a.child,S=s.child.memoizedState,S===null?S=_f(o):(m=S.cachePool,m!==null?(z=Cn._currentValue,m=m.parent!==z?{parent:z,pool:z}:m):m=Rb(),S={baseLanes:S.baseLanes|o,cachePool:m}),c.memoizedState=S,c.childLanes=kf(s,x,o),a.memoizedState=wf,Sc(s.child,c)):(Ri(a),o=s.child,s=o.sibling,o=Wa(o,{mode:"visible",children:c.children}),o.return=a,o.sibling=null,s!==null&&(x=a.deletions,x===null?(a.deletions=[s],a.flags|=16):x.push(s)),a.child=o,a.memoizedState=null,o)}function jf(s,a){return a=kd({mode:"visible",children:a},s.mode),a.return=s,s.child=a}function kd(s,a){return s=Or(22,s,null,a),s.lanes=0,s}function Tf(s,a,o){return Co(a,s.child,null,o),s=jf(a,a.pendingProps.children),s.flags|=2,a.memoizedState=null,s}function qv(s,a,o){s.lanes|=a;var c=s.alternate;c!==null&&(c.lanes|=a),Bm(s.return,a,o)}function Ef(s,a,o,c,m,f){var x=s.memoizedState;x===null?s.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:m,treeForkCount:f}:(x.isBackwards=a,x.rendering=null,x.renderingStartTime=0,x.last=c,x.tail=o,x.tailMode=m,x.treeForkCount=f)}function Hv(s,a,o){var c=a.pendingProps,m=c.revealOrder,f=c.tail;c=c.children;var x=Tn.current,S=(x&2)!==0;if(S?(x=x&1|2,a.flags|=128):x&=1,De(Tn,x),Xn(s,a,c,o),c=ws?fc:0,!S&&s!==null&&(s.flags&128)!==0)e:for(s=a.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&qv(s,o,a);else if(s.tag===19)qv(s,o,a);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(m){case"forwards":for(o=a.child,m=null;o!==null;)s=o.alternate,s!==null&&dd(s)===null&&(m=o),o=o.sibling;o=m,o===null?(m=a.child,a.child=null):(m=o.sibling,o.sibling=null),Ef(a,!1,m,o,f,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,m=a.child,a.child=null;m!==null;){if(s=m.alternate,s!==null&&dd(s)===null){a.child=m;break}s=m.sibling,m.sibling=o,o=m,m=s}Ef(a,!0,o,null,f,c);break;case"together":Ef(a,!1,null,null,void 0,c);break;default:a.memoizedState=null}return a.child}function Ja(s,a,o){if(s!==null&&(a.dependencies=s.dependencies),Di|=a.lanes,(o&a.childLanes)===0)if(s!==null){if(hl(s,a,o,!1),(o&a.childLanes)===0)return null}else return null;if(s!==null&&a.child!==s.child)throw Error(i(153));if(a.child!==null){for(s=a.child,o=Wa(s,s.pendingProps),a.child=o,o.return=a;s.sibling!==null;)s=s.sibling,o=o.sibling=Wa(s,s.pendingProps),o.return=a;o.sibling=null}return a.child}function Sf(s,a){return(s.lanes&a)!==0?!0:(s=s.dependencies,!!(s!==null&&nd(s)))}function vj(s,a,o){switch(a.tag){case 3:jt(a,a.stateNode.containerInfo),Ei(a,Cn,s.memoizedState.cache),ko();break;case 27:case 5:Gt(a);break;case 4:jt(a,a.stateNode.containerInfo);break;case 10:Ei(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,Xm(a),null;break;case 13:var c=a.memoizedState;if(c!==null)return c.dehydrated!==null?(Ri(a),a.flags|=128,null):(o&a.child.childLanes)!==0?zv(s,a,o):(Ri(a),s=Ja(s,a,o),s!==null?s.sibling:null);Ri(a);break;case 19:var m=(s.flags&128)!==0;if(c=(o&a.childLanes)!==0,c||(hl(s,a,o,!1),c=(o&a.childLanes)!==0),m){if(c)return Hv(s,a,o);a.flags|=128}if(m=a.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),De(Tn,Tn.current),c)break;return null;case 22:return a.lanes=0,Lv(s,a,o,a.pendingProps);case 24:Ei(a,Cn,s.memoizedState.cache)}return Ja(s,a,o)}function $v(s,a,o){if(s!==null)if(s.memoizedProps!==a.pendingProps)An=!0;else{if(!Sf(s,o)&&(a.flags&128)===0)return An=!1,vj(s,a,o);An=(s.flags&131072)!==0}else An=!1,ws&&(a.flags&1048576)!==0&&kb(a,fc,a.index);switch(a.lanes=0,a.tag){case 16:e:{var c=a.pendingProps;if(s=So(a.elementType),a.type=s,typeof s=="function")Am(s)?(c=Ao(s,c),a.tag=1,a=Uv(null,a,s,c,o)):(a.tag=0,a=xf(null,a,s,c,o));else{if(s!=null){var m=s.$$typeof;if(m===be){a.tag=11,a=Mv(null,a,s,c,o);break e}else if(m===R){a.tag=14,a=Dv(null,a,s,c,o);break e}}throw a=$e(s)||s,Error(i(306,a,""))}}return a;case 0:return xf(s,a,a.type,a.pendingProps,o);case 1:return c=a.type,m=Ao(c,a.pendingProps),Uv(s,a,c,m,o);case 3:e:{if(jt(a,a.stateNode.containerInfo),s===null)throw Error(i(387));c=a.pendingProps;var f=a.memoizedState;m=f.element,Wm(s,a),_c(a,c,null,o);var x=a.memoizedState;if(c=x.cache,Ei(a,Cn,c),c!==f.cache&&Um(a,[Cn],o,!0),wc(),c=x.element,f.isDehydrated)if(f={element:c,isDehydrated:!1,cache:x.cache},a.updateQueue.baseState=f,a.memoizedState=f,a.flags&256){a=Fv(s,a,c,o);break e}else if(c!==m){m=Qr(Error(i(424)),a),pc(m),a=Fv(s,a,c,o);break e}else for(s=a.stateNode.containerInfo,s.nodeType===9?s=s.body:s=s.nodeName==="HTML"?s.ownerDocument.body:s,sn=ta(s.firstChild),Yn=a,ws=!0,ji=null,Zr=!0,o=Lb(a,null,c,o),a.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(ko(),c===m){a=Ja(s,a,o);break e}Xn(s,a,c,o)}a=a.child}return a;case 26:return _d(s,a),s===null?(o=s1(a.type,null,a.pendingProps,null))?a.memoizedState=o:ws||(o=a.type,s=a.pendingProps,c=Bd(Fe.current).createElement(o),c[lt]=a,c[ht]=s,Jn(c,o,s),N(c),a.stateNode=c):a.memoizedState=s1(a.type,s.memoizedProps,a.pendingProps,s.memoizedState),null;case 27:return Gt(a),s===null&&ws&&(c=a.stateNode=Z0(a.type,a.pendingProps,Fe.current),Yn=a,Zr=!0,m=sn,Bi(a.type)?(ip=m,sn=ta(c.firstChild)):sn=m),Xn(s,a,a.pendingProps.children,o),_d(s,a),s===null&&(a.flags|=4194304),a.child;case 5:return s===null&&ws&&((m=c=sn)&&(c=Yj(c,a.type,a.pendingProps,Zr),c!==null?(a.stateNode=c,Yn=a,sn=ta(c.firstChild),Zr=!1,m=!0):m=!1),m||Ti(a)),Gt(a),m=a.type,f=a.pendingProps,x=s!==null?s.memoizedProps:null,c=f.children,tp(m,f)?c=null:x!==null&&tp(m,x)&&(a.flags|=32),a.memoizedState!==null&&(m=Zm(s,a,uj,null,null,o),zc._currentValue=m),_d(s,a),Xn(s,a,c,o),a.child;case 6:return s===null&&ws&&((s=o=sn)&&(o=Qj(o,a.pendingProps,Zr),o!==null?(a.stateNode=o,Yn=a,sn=null,s=!0):s=!1),s||Ti(a)),null;case 13:return zv(s,a,o);case 4:return jt(a,a.stateNode.containerInfo),c=a.pendingProps,s===null?a.child=Co(a,null,c,o):Xn(s,a,c,o),a.child;case 11:return Mv(s,a,a.type,a.pendingProps,o);case 7:return Xn(s,a,a.pendingProps,o),a.child;case 8:return Xn(s,a,a.pendingProps.children,o),a.child;case 12:return Xn(s,a,a.pendingProps.children,o),a.child;case 10:return c=a.pendingProps,Ei(a,a.type,c.value),Xn(s,a,c.children,o),a.child;case 9:return m=a.type._context,c=a.pendingProps.children,To(a),m=Qn(m),c=c(m),a.flags|=1,Xn(s,a,c,o),a.child;case 14:return Dv(s,a,a.type,a.pendingProps,o);case 15:return Pv(s,a,a.type,a.pendingProps,o);case 19:return Hv(s,a,o);case 31:return bj(s,a,o);case 22:return Lv(s,a,o,a.pendingProps);case 24:return To(a),c=Qn(Cn),s===null?(m=qm(),m===null&&(m=Ys,f=Fm(),m.pooledCache=f,f.refCount++,f!==null&&(m.pooledCacheLanes|=o),m=f),a.memoizedState={parent:c,cache:m},$m(a),Ei(a,Cn,m)):((s.lanes&o)!==0&&(Wm(s,a),_c(a,null,null,o),wc()),m=s.memoizedState,f=a.memoizedState,m.parent!==c?(m={parent:c,cache:c},a.memoizedState=m,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=m),Ei(a,Cn,c)):(c=f.cache,Ei(a,Cn,c),c!==m.cache&&Um(a,[Cn],o,!0))),Xn(s,a,a.pendingProps.children,o),a.child;case 29:throw a.pendingProps}throw Error(i(156,a.tag))}function Za(s){s.flags|=4}function Nf(s,a,o,c,m){if((a=(s.mode&32)!==0)&&(a=!1),a){if(s.flags|=16777216,(m&335544128)===m)if(s.stateNode.complete)s.flags|=8192;else if(b0())s.flags|=8192;else throw No=od,Hm}else s.flags&=-16777217}function Wv(s,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!o1(a))if(b0())s.flags|=8192;else throw No=od,Hm}function jd(s,a){a!==null&&(s.flags|=4),s.flags&16384&&(a=s.tag!==22?Ut():536870912,s.lanes|=a,jl|=a)}function Nc(s,a){if(!ws)switch(s.tailMode){case"hidden":a=s.tail;for(var o=null;a!==null;)a.alternate!==null&&(o=a),a=a.sibling;o===null?s.tail=null:o.sibling=null;break;case"collapsed":o=s.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?a||s.tail===null?s.tail=null:s.tail.sibling=null:c.sibling=null}}function nn(s){var a=s.alternate!==null&&s.alternate.child===s.child,o=0,c=0;if(a)for(var m=s.child;m!==null;)o|=m.lanes|m.childLanes,c|=m.subtreeFlags&65011712,c|=m.flags&65011712,m.return=s,m=m.sibling;else for(m=s.child;m!==null;)o|=m.lanes|m.childLanes,c|=m.subtreeFlags,c|=m.flags,m.return=s,m=m.sibling;return s.subtreeFlags|=c,s.childLanes=o,a}function xj(s,a,o){var c=a.pendingProps;switch(Pm(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nn(a),null;case 1:return nn(a),null;case 3:return o=a.stateNode,c=null,s!==null&&(c=s.memoizedState.cache),a.memoizedState.cache!==c&&(a.flags|=2048),Ya(Cn),at(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(s===null||s.child===null)&&(dl(a)?Za(a):s===null||s.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Om())),nn(a),null;case 26:var m=a.type,f=a.memoizedState;return s===null?(Za(a),f!==null?(nn(a),Wv(a,f)):(nn(a),Nf(a,m,null,c,o))):f?f!==s.memoizedState?(Za(a),nn(a),Wv(a,f)):(nn(a),a.flags&=-16777217):(s=s.memoizedProps,s!==c&&Za(a),nn(a),Nf(a,m,s,c,o)),null;case 27:if(_s(a),o=Fe.current,m=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==c&&Za(a);else{if(!c){if(a.stateNode===null)throw Error(i(166));return nn(a),null}s=Le.current,dl(a)?Tb(a):(s=Z0(m,c,o),a.stateNode=s,Za(a))}return nn(a),null;case 5:if(_s(a),m=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==c&&Za(a);else{if(!c){if(a.stateNode===null)throw Error(i(166));return nn(a),null}if(f=Le.current,dl(a))Tb(a);else{var x=Bd(Fe.current);switch(f){case 1:f=x.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:f=x.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":f=x.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":f=x.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":f=x.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild);break;case"select":f=typeof c.is=="string"?x.createElement("select",{is:c.is}):x.createElement("select"),c.multiple?f.multiple=!0:c.size&&(f.size=c.size);break;default:f=typeof c.is=="string"?x.createElement(m,{is:c.is}):x.createElement(m)}}f[lt]=a,f[ht]=c;e:for(x=a.child;x!==null;){if(x.tag===5||x.tag===6)f.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===a)break e;for(;x.sibling===null;){if(x.return===null||x.return===a)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}a.stateNode=f;e:switch(Jn(f,m,c),m){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&Za(a)}}return nn(a),Nf(a,a.type,s===null?null:s.memoizedProps,a.pendingProps,o),null;case 6:if(s&&a.stateNode!=null)s.memoizedProps!==c&&Za(a);else{if(typeof c!="string"&&a.stateNode===null)throw Error(i(166));if(s=Fe.current,dl(a)){if(s=a.stateNode,o=a.memoizedProps,c=null,m=Yn,m!==null)switch(m.tag){case 27:case 5:c=m.memoizedProps}s[lt]=a,s=!!(s.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||z0(s.nodeValue,o)),s||Ti(a,!0)}else s=Bd(s).createTextNode(c),s[lt]=a,a.stateNode=s}return nn(a),null;case 31:if(o=a.memoizedState,s===null||s.memoizedState!==null){if(c=dl(a),o!==null){if(s===null){if(!c)throw Error(i(318));if(s=a.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[lt]=a}else ko(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;nn(a),s=!1}else o=Om(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=o),s=!0;if(!s)return a.flags&256?(Br(a),a):(Br(a),null);if((a.flags&128)!==0)throw Error(i(558))}return nn(a),null;case 13:if(c=a.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(m=dl(a),c!==null&&c.dehydrated!==null){if(s===null){if(!m)throw Error(i(318));if(m=a.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(i(317));m[lt]=a}else ko(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;nn(a),m=!1}else m=Om(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=m),m=!0;if(!m)return a.flags&256?(Br(a),a):(Br(a),null)}return Br(a),(a.flags&128)!==0?(a.lanes=o,a):(o=c!==null,s=s!==null&&s.memoizedState!==null,o&&(c=a.child,m=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(m=c.alternate.memoizedState.cachePool.pool),f=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(f=c.memoizedState.cachePool.pool),f!==m&&(c.flags|=2048)),o!==s&&o&&(a.child.flags|=8192),jd(a,a.updateQueue),nn(a),null);case 4:return at(),s===null&&Qf(a.stateNode.containerInfo),nn(a),null;case 10:return Ya(a.type),nn(a),null;case 19:if(se(Tn),c=a.memoizedState,c===null)return nn(a),null;if(m=(a.flags&128)!==0,f=c.rendering,f===null)if(m)Nc(c,!1);else{if(bn!==0||s!==null&&(s.flags&128)!==0)for(s=a.child;s!==null;){if(f=dd(s),f!==null){for(a.flags|=128,Nc(c,!1),s=f.updateQueue,a.updateQueue=s,jd(a,s),a.subtreeFlags=0,s=o,o=a.child;o!==null;)xb(o,s),o=o.sibling;return De(Tn,Tn.current&1|2),ws&&Ga(a,c.treeForkCount),a.child}s=s.sibling}c.tail!==null&&ts()>Cd&&(a.flags|=128,m=!0,Nc(c,!1),a.lanes=4194304)}else{if(!m)if(s=dd(f),s!==null){if(a.flags|=128,m=!0,s=s.updateQueue,a.updateQueue=s,jd(a,s),Nc(c,!0),c.tail===null&&c.tailMode==="hidden"&&!f.alternate&&!ws)return nn(a),null}else 2*ts()-c.renderingStartTime>Cd&&o!==536870912&&(a.flags|=128,m=!0,Nc(c,!1),a.lanes=4194304);c.isBackwards?(f.sibling=a.child,a.child=f):(s=c.last,s!==null?s.sibling=f:a.child=f,c.last=f)}return c.tail!==null?(s=c.tail,c.rendering=s,c.tail=s.sibling,c.renderingStartTime=ts(),s.sibling=null,o=Tn.current,De(Tn,m?o&1|2:o&1),ws&&Ga(a,c.treeForkCount),s):(nn(a),null);case 22:case 23:return Br(a),Qm(),c=a.memoizedState!==null,s!==null?s.memoizedState!==null!==c&&(a.flags|=8192):c&&(a.flags|=8192),c?(o&536870912)!==0&&(a.flags&128)===0&&(nn(a),a.subtreeFlags&6&&(a.flags|=8192)):nn(a),o=a.updateQueue,o!==null&&jd(a,o.retryQueue),o=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),c=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),c!==o&&(a.flags|=2048),s!==null&&se(Eo),null;case 24:return o=null,s!==null&&(o=s.memoizedState.cache),a.memoizedState.cache!==o&&(a.flags|=2048),Ya(Cn),nn(a),null;case 25:return null;case 30:return null}throw Error(i(156,a.tag))}function wj(s,a){switch(Pm(a),a.tag){case 1:return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 3:return Ya(Cn),at(),s=a.flags,(s&65536)!==0&&(s&128)===0?(a.flags=s&-65537|128,a):null;case 26:case 27:case 5:return _s(a),null;case 31:if(a.memoizedState!==null){if(Br(a),a.alternate===null)throw Error(i(340));ko()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 13:if(Br(a),s=a.memoizedState,s!==null&&s.dehydrated!==null){if(a.alternate===null)throw Error(i(340));ko()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 19:return se(Tn),null;case 4:return at(),null;case 10:return Ya(a.type),null;case 22:case 23:return Br(a),Qm(),s!==null&&se(Eo),s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 24:return Ya(Cn),null;case 25:return null;default:return null}}function Gv(s,a){switch(Pm(a),a.tag){case 3:Ya(Cn),at();break;case 26:case 27:case 5:_s(a);break;case 4:at();break;case 31:a.memoizedState!==null&&Br(a);break;case 13:Br(a);break;case 19:se(Tn);break;case 10:Ya(a.type);break;case 22:case 23:Br(a),Qm(),s!==null&&se(Eo);break;case 24:Ya(Cn)}}function Cc(s,a){try{var o=a.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var m=c.next;o=m;do{if((o.tag&s)===s){c=void 0;var f=o.create,x=o.inst;c=f(),x.destroy=c}o=o.next}while(o!==m)}}catch(S){qs(a,a.return,S)}}function Ii(s,a,o){try{var c=a.updateQueue,m=c!==null?c.lastEffect:null;if(m!==null){var f=m.next;c=f;do{if((c.tag&s)===s){var x=c.inst,S=x.destroy;if(S!==void 0){x.destroy=void 0,m=a;var z=o,oe=S;try{oe()}catch(je){qs(m,z,je)}}}c=c.next}while(c!==f)}}catch(je){qs(a,a.return,je)}}function Kv(s){var a=s.updateQueue;if(a!==null){var o=s.stateNode;try{Vb(a,o)}catch(c){qs(s,s.return,c)}}}function Yv(s,a,o){o.props=Ao(s.type,s.memoizedProps),o.state=s.memoizedState;try{o.componentWillUnmount()}catch(c){qs(s,a,c)}}function Rc(s,a){try{var o=s.ref;if(o!==null){switch(s.tag){case 26:case 27:case 5:var c=s.stateNode;break;case 30:c=s.stateNode;break;default:c=s.stateNode}typeof o=="function"?s.refCleanup=o(c):o.current=c}}catch(m){qs(s,a,m)}}function Ca(s,a){var o=s.ref,c=s.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(m){qs(s,a,m)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(m){qs(s,a,m)}else o.current=null}function Qv(s){var a=s.type,o=s.memoizedProps,c=s.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(m){qs(s,s.return,m)}}function Cf(s,a,o){try{var c=s.stateNode;qj(c,s.type,o,a),c[ht]=a}catch(m){qs(s,s.return,m)}}function Xv(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Bi(s.type)||s.tag===4}function Rf(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Xv(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Bi(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Af(s,a,o){var c=s.tag;if(c===5||c===6)s=s.stateNode,a?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(s,a):(a=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,a.appendChild(s),o=o._reactRootContainer,o!=null||a.onclick!==null||(a.onclick=tn));else if(c!==4&&(c===27&&Bi(s.type)&&(o=s.stateNode,a=null),s=s.child,s!==null))for(Af(s,a,o),s=s.sibling;s!==null;)Af(s,a,o),s=s.sibling}function Td(s,a,o){var c=s.tag;if(c===5||c===6)s=s.stateNode,a?o.insertBefore(s,a):o.appendChild(s);else if(c!==4&&(c===27&&Bi(s.type)&&(o=s.stateNode),s=s.child,s!==null))for(Td(s,a,o),s=s.sibling;s!==null;)Td(s,a,o),s=s.sibling}function Jv(s){var a=s.stateNode,o=s.memoizedProps;try{for(var c=s.type,m=a.attributes;m.length;)a.removeAttributeNode(m[0]);Jn(a,c,o),a[lt]=s,a[ht]=o}catch(f){qs(s,s.return,f)}}var ei=!1,In=!1,If=!1,Zv=typeof WeakSet=="function"?WeakSet:Set,qn=null;function _j(s,a){if(s=s.containerInfo,Zf=Wd,s=db(s),jm(s)){if("selectionStart"in s)var o={start:s.selectionStart,end:s.selectionEnd};else e:{o=(o=s.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var m=c.anchorOffset,f=c.focusNode;c=c.focusOffset;try{o.nodeType,f.nodeType}catch{o=null;break e}var x=0,S=-1,z=-1,oe=0,je=0,Me=s,ce=null;t:for(;;){for(var ye;Me!==o||m!==0&&Me.nodeType!==3||(S=x+m),Me!==f||c!==0&&Me.nodeType!==3||(z=x+c),Me.nodeType===3&&(x+=Me.nodeValue.length),(ye=Me.firstChild)!==null;)ce=Me,Me=ye;for(;;){if(Me===s)break t;if(ce===o&&++oe===m&&(S=x),ce===f&&++je===c&&(z=x),(ye=Me.nextSibling)!==null)break;Me=ce,ce=Me.parentNode}Me=ye}o=S===-1||z===-1?null:{start:S,end:z}}else o=null}o=o||{start:0,end:0}}else o=null;for(ep={focusedElem:s,selectionRange:o},Wd=!1,qn=a;qn!==null;)if(a=qn,s=a.child,(a.subtreeFlags&1028)!==0&&s!==null)s.return=a,qn=s;else for(;qn!==null;){switch(a=qn,f=a.alternate,s=a.flags,a.tag){case 0:if((s&4)!==0&&(s=a.updateQueue,s=s!==null?s.events:null,s!==null))for(o=0;o<s.length;o++)m=s[o],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&f!==null){s=void 0,o=a,m=f.memoizedProps,f=f.memoizedState,c=o.stateNode;try{var mt=Ao(o.type,m);s=c.getSnapshotBeforeUpdate(mt,f),c.__reactInternalSnapshotBeforeUpdate=s}catch(Mt){qs(o,o.return,Mt)}}break;case 3:if((s&1024)!==0){if(s=a.stateNode.containerInfo,o=s.nodeType,o===9)np(s);else if(o===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":np(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=a.sibling,s!==null){s.return=a.return,qn=s;break}qn=a.return}}function e0(s,a,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:si(s,o),c&4&&Cc(5,o);break;case 1:if(si(s,o),c&4)if(s=o.stateNode,a===null)try{s.componentDidMount()}catch(x){qs(o,o.return,x)}else{var m=Ao(o.type,a.memoizedProps);a=a.memoizedState;try{s.componentDidUpdate(m,a,s.__reactInternalSnapshotBeforeUpdate)}catch(x){qs(o,o.return,x)}}c&64&&Kv(o),c&512&&Rc(o,o.return);break;case 3:if(si(s,o),c&64&&(s=o.updateQueue,s!==null)){if(a=null,o.child!==null)switch(o.child.tag){case 27:case 5:a=o.child.stateNode;break;case 1:a=o.child.stateNode}try{Vb(s,a)}catch(x){qs(o,o.return,x)}}break;case 27:a===null&&c&4&&Jv(o);case 26:case 5:si(s,o),a===null&&c&4&&Qv(o),c&512&&Rc(o,o.return);break;case 12:si(s,o);break;case 31:si(s,o),c&4&&n0(s,o);break;case 13:si(s,o),c&4&&r0(s,o),c&64&&(s=o.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(o=Aj.bind(null,o),Xj(s,o))));break;case 22:if(c=o.memoizedState!==null||ei,!c){a=a!==null&&a.memoizedState!==null||In,m=ei;var f=In;ei=c,(In=a)&&!f?ni(s,o,(o.subtreeFlags&8772)!==0):si(s,o),ei=m,In=f}break;case 30:break;default:si(s,o)}}function t0(s){var a=s.alternate;a!==null&&(s.alternate=null,t0(a)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(a=s.stateNode,a!==null&&_n(a)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var an=null,Er=!1;function ti(s,a,o){for(o=o.child;o!==null;)s0(s,a,o),o=o.sibling}function s0(s,a,o){if(X&&typeof X.onCommitFiberUnmount=="function")try{X.onCommitFiberUnmount(Ge,o)}catch{}switch(o.tag){case 26:In||Ca(o,a),ti(s,a,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:In||Ca(o,a);var c=an,m=Er;Bi(o.type)&&(an=o.stateNode,Er=!1),ti(s,a,o),Bc(o.stateNode),an=c,Er=m;break;case 5:In||Ca(o,a);case 6:if(c=an,m=Er,an=null,ti(s,a,o),an=c,Er=m,an!==null)if(Er)try{(an.nodeType===9?an.body:an.nodeName==="HTML"?an.ownerDocument.body:an).removeChild(o.stateNode)}catch(f){qs(o,a,f)}else try{an.removeChild(o.stateNode)}catch(f){qs(o,a,f)}break;case 18:an!==null&&(Er?(s=an,K0(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,o.stateNode),Il(s)):K0(an,o.stateNode));break;case 4:c=an,m=Er,an=o.stateNode.containerInfo,Er=!0,ti(s,a,o),an=c,Er=m;break;case 0:case 11:case 14:case 15:Ii(2,o,a),In||Ii(4,o,a),ti(s,a,o);break;case 1:In||(Ca(o,a),c=o.stateNode,typeof c.componentWillUnmount=="function"&&Yv(o,a,c)),ti(s,a,o);break;case 21:ti(s,a,o);break;case 22:In=(c=In)||o.memoizedState!==null,ti(s,a,o),In=c;break;default:ti(s,a,o)}}function n0(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Il(s)}catch(o){qs(a,a.return,o)}}}function r0(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Il(s)}catch(o){qs(a,a.return,o)}}function kj(s){switch(s.tag){case 31:case 13:case 19:var a=s.stateNode;return a===null&&(a=s.stateNode=new Zv),a;case 22:return s=s.stateNode,a=s._retryCache,a===null&&(a=s._retryCache=new Zv),a;default:throw Error(i(435,s.tag))}}function Ed(s,a){var o=kj(s);a.forEach(function(c){if(!o.has(c)){o.add(c);var m=Ij.bind(null,s,c);c.then(m,m)}})}function Sr(s,a){var o=a.deletions;if(o!==null)for(var c=0;c<o.length;c++){var m=o[c],f=s,x=a,S=x;e:for(;S!==null;){switch(S.tag){case 27:if(Bi(S.type)){an=S.stateNode,Er=!1;break e}break;case 5:an=S.stateNode,Er=!1;break e;case 3:case 4:an=S.stateNode.containerInfo,Er=!0;break e}S=S.return}if(an===null)throw Error(i(160));s0(f,x,m),an=null,Er=!1,f=m.alternate,f!==null&&(f.return=null),m.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)a0(a,s),a=a.sibling}var da=null;function a0(s,a){var o=s.alternate,c=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Sr(a,s),Nr(s),c&4&&(Ii(3,s,s.return),Cc(3,s),Ii(5,s,s.return));break;case 1:Sr(a,s),Nr(s),c&512&&(In||o===null||Ca(o,o.return)),c&64&&ei&&(s=s.updateQueue,s!==null&&(c=s.callbacks,c!==null&&(o=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var m=da;if(Sr(a,s),Nr(s),c&512&&(In||o===null||Ca(o,o.return)),c&4){var f=o!==null?o.memoizedState:null;if(c=s.memoizedState,o===null)if(c===null)if(s.stateNode===null){e:{c=s.type,o=s.memoizedProps,m=m.ownerDocument||m;t:switch(c){case"title":f=m.getElementsByTagName("title")[0],(!f||f[ln]||f[lt]||f.namespaceURI==="http://www.w3.org/2000/svg"||f.hasAttribute("itemprop"))&&(f=m.createElement(c),m.head.insertBefore(f,m.querySelector("head > title"))),Jn(f,c,o),f[lt]=s,N(f),c=f;break e;case"link":var x=a1("link","href",m).get(c+(o.href||""));if(x){for(var S=0;S<x.length;S++)if(f=x[S],f.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&f.getAttribute("rel")===(o.rel==null?null:o.rel)&&f.getAttribute("title")===(o.title==null?null:o.title)&&f.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){x.splice(S,1);break t}}f=m.createElement(c),Jn(f,c,o),m.head.appendChild(f);break;case"meta":if(x=a1("meta","content",m).get(c+(o.content||""))){for(S=0;S<x.length;S++)if(f=x[S],f.getAttribute("content")===(o.content==null?null:""+o.content)&&f.getAttribute("name")===(o.name==null?null:o.name)&&f.getAttribute("property")===(o.property==null?null:o.property)&&f.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&f.getAttribute("charset")===(o.charSet==null?null:o.charSet)){x.splice(S,1);break t}}f=m.createElement(c),Jn(f,c,o),m.head.appendChild(f);break;default:throw Error(i(468,c))}f[lt]=s,N(f),c=f}s.stateNode=c}else i1(m,s.type,s.stateNode);else s.stateNode=r1(m,c,s.memoizedProps);else f!==c?(f===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):f.count--,c===null?i1(m,s.type,s.stateNode):r1(m,c,s.memoizedProps)):c===null&&s.stateNode!==null&&Cf(s,s.memoizedProps,o.memoizedProps)}break;case 27:Sr(a,s),Nr(s),c&512&&(In||o===null||Ca(o,o.return)),o!==null&&c&4&&Cf(s,s.memoizedProps,o.memoizedProps);break;case 5:if(Sr(a,s),Nr(s),c&512&&(In||o===null||Ca(o,o.return)),s.flags&32){m=s.stateNode;try{pn(m,"")}catch(mt){qs(s,s.return,mt)}}c&4&&s.stateNode!=null&&(m=s.memoizedProps,Cf(s,m,o!==null?o.memoizedProps:m)),c&1024&&(If=!0);break;case 6:if(Sr(a,s),Nr(s),c&4){if(s.stateNode===null)throw Error(i(162));c=s.memoizedProps,o=s.stateNode;try{o.nodeValue=c}catch(mt){qs(s,s.return,mt)}}break;case 3:if(zd=null,m=da,da=Ud(a.containerInfo),Sr(a,s),da=m,Nr(s),c&4&&o!==null&&o.memoizedState.isDehydrated)try{Il(a.containerInfo)}catch(mt){qs(s,s.return,mt)}If&&(If=!1,i0(s));break;case 4:c=da,da=Ud(s.stateNode.containerInfo),Sr(a,s),Nr(s),da=c;break;case 12:Sr(a,s),Nr(s);break;case 31:Sr(a,s),Nr(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Ed(s,c)));break;case 13:Sr(a,s),Nr(s),s.child.flags&8192&&s.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Nd=ts()),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Ed(s,c)));break;case 22:m=s.memoizedState!==null;var z=o!==null&&o.memoizedState!==null,oe=ei,je=In;if(ei=oe||m,In=je||z,Sr(a,s),In=je,ei=oe,Nr(s),c&8192)e:for(a=s.stateNode,a._visibility=m?a._visibility&-2:a._visibility|1,m&&(o===null||z||ei||In||Io(s)),o=null,a=s;;){if(a.tag===5||a.tag===26){if(o===null){z=o=a;try{if(f=z.stateNode,m)x=f.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none";else{S=z.stateNode;var Me=z.memoizedProps.style,ce=Me!=null&&Me.hasOwnProperty("display")?Me.display:null;S.style.display=ce==null||typeof ce=="boolean"?"":(""+ce).trim()}}catch(mt){qs(z,z.return,mt)}}}else if(a.tag===6){if(o===null){z=a;try{z.stateNode.nodeValue=m?"":z.memoizedProps}catch(mt){qs(z,z.return,mt)}}}else if(a.tag===18){if(o===null){z=a;try{var ye=z.stateNode;m?Y0(ye,!0):Y0(z.stateNode,!1)}catch(mt){qs(z,z.return,mt)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===s)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;o===a&&(o=null),a=a.return}o===a&&(o=null),a.sibling.return=a.return,a=a.sibling}c&4&&(c=s.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,Ed(s,o))));break;case 19:Sr(a,s),Nr(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Ed(s,c)));break;case 30:break;case 21:break;default:Sr(a,s),Nr(s)}}function Nr(s){var a=s.flags;if(a&2){try{for(var o,c=s.return;c!==null;){if(Xv(c)){o=c;break}c=c.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var m=o.stateNode,f=Rf(s);Td(s,f,m);break;case 5:var x=o.stateNode;o.flags&32&&(pn(x,""),o.flags&=-33);var S=Rf(s);Td(s,S,x);break;case 3:case 4:var z=o.stateNode.containerInfo,oe=Rf(s);Af(s,oe,z);break;default:throw Error(i(161))}}catch(je){qs(s,s.return,je)}s.flags&=-3}a&4096&&(s.flags&=-4097)}function i0(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var a=s;i0(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),s=s.sibling}}function si(s,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)e0(s,a.alternate,a),a=a.sibling}function Io(s){for(s=s.child;s!==null;){var a=s;switch(a.tag){case 0:case 11:case 14:case 15:Ii(4,a,a.return),Io(a);break;case 1:Ca(a,a.return);var o=a.stateNode;typeof o.componentWillUnmount=="function"&&Yv(a,a.return,o),Io(a);break;case 27:Bc(a.stateNode);case 26:case 5:Ca(a,a.return),Io(a);break;case 22:a.memoizedState===null&&Io(a);break;case 30:Io(a);break;default:Io(a)}s=s.sibling}}function ni(s,a,o){for(o=o&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var c=a.alternate,m=s,f=a,x=f.flags;switch(f.tag){case 0:case 11:case 15:ni(m,f,o),Cc(4,f);break;case 1:if(ni(m,f,o),c=f,m=c.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(oe){qs(c,c.return,oe)}if(c=f,m=c.updateQueue,m!==null){var S=c.stateNode;try{var z=m.shared.hiddenCallbacks;if(z!==null)for(m.shared.hiddenCallbacks=null,m=0;m<z.length;m++)Ob(z[m],S)}catch(oe){qs(c,c.return,oe)}}o&&x&64&&Kv(f),Rc(f,f.return);break;case 27:Jv(f);case 26:case 5:ni(m,f,o),o&&c===null&&x&4&&Qv(f),Rc(f,f.return);break;case 12:ni(m,f,o);break;case 31:ni(m,f,o),o&&x&4&&n0(m,f);break;case 13:ni(m,f,o),o&&x&4&&r0(m,f);break;case 22:f.memoizedState===null&&ni(m,f,o),Rc(f,f.return);break;case 30:break;default:ni(m,f,o)}a=a.sibling}}function Mf(s,a){var o=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),s=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(s=a.memoizedState.cachePool.pool),s!==o&&(s!=null&&s.refCount++,o!=null&&gc(o))}function Df(s,a){s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&gc(s))}function ha(s,a,o,c){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)o0(s,a,o,c),a=a.sibling}function o0(s,a,o,c){var m=a.flags;switch(a.tag){case 0:case 11:case 15:ha(s,a,o,c),m&2048&&Cc(9,a);break;case 1:ha(s,a,o,c);break;case 3:ha(s,a,o,c),m&2048&&(s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&gc(s)));break;case 12:if(m&2048){ha(s,a,o,c),s=a.stateNode;try{var f=a.memoizedProps,x=f.id,S=f.onPostCommit;typeof S=="function"&&S(x,a.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(z){qs(a,a.return,z)}}else ha(s,a,o,c);break;case 31:ha(s,a,o,c);break;case 13:ha(s,a,o,c);break;case 23:break;case 22:f=a.stateNode,x=a.alternate,a.memoizedState!==null?f._visibility&2?ha(s,a,o,c):Ac(s,a):f._visibility&2?ha(s,a,o,c):(f._visibility|=2,wl(s,a,o,c,(a.subtreeFlags&10256)!==0||!1)),m&2048&&Mf(x,a);break;case 24:ha(s,a,o,c),m&2048&&Df(a.alternate,a);break;default:ha(s,a,o,c)}}function wl(s,a,o,c,m){for(m=m&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var f=s,x=a,S=o,z=c,oe=x.flags;switch(x.tag){case 0:case 11:case 15:wl(f,x,S,z,m),Cc(8,x);break;case 23:break;case 22:var je=x.stateNode;x.memoizedState!==null?je._visibility&2?wl(f,x,S,z,m):Ac(f,x):(je._visibility|=2,wl(f,x,S,z,m)),m&&oe&2048&&Mf(x.alternate,x);break;case 24:wl(f,x,S,z,m),m&&oe&2048&&Df(x.alternate,x);break;default:wl(f,x,S,z,m)}a=a.sibling}}function Ac(s,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var o=s,c=a,m=c.flags;switch(c.tag){case 22:Ac(o,c),m&2048&&Mf(c.alternate,c);break;case 24:Ac(o,c),m&2048&&Df(c.alternate,c);break;default:Ac(o,c)}a=a.sibling}}var Ic=8192;function _l(s,a,o){if(s.subtreeFlags&Ic)for(s=s.child;s!==null;)l0(s,a,o),s=s.sibling}function l0(s,a,o){switch(s.tag){case 26:_l(s,a,o),s.flags&Ic&&s.memoizedState!==null&&cT(o,da,s.memoizedState,s.memoizedProps);break;case 5:_l(s,a,o);break;case 3:case 4:var c=da;da=Ud(s.stateNode.containerInfo),_l(s,a,o),da=c;break;case 22:s.memoizedState===null&&(c=s.alternate,c!==null&&c.memoizedState!==null?(c=Ic,Ic=16777216,_l(s,a,o),Ic=c):_l(s,a,o));break;default:_l(s,a,o)}}function c0(s){var a=s.alternate;if(a!==null&&(s=a.child,s!==null)){a.child=null;do a=s.sibling,s.sibling=null,s=a;while(s!==null)}}function Mc(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var o=0;o<a.length;o++){var c=a[o];qn=c,d0(c,s)}c0(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)u0(s),s=s.sibling}function u0(s){switch(s.tag){case 0:case 11:case 15:Mc(s),s.flags&2048&&Ii(9,s,s.return);break;case 3:Mc(s);break;case 12:Mc(s);break;case 22:var a=s.stateNode;s.memoizedState!==null&&a._visibility&2&&(s.return===null||s.return.tag!==13)?(a._visibility&=-3,Sd(s)):Mc(s);break;default:Mc(s)}}function Sd(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var o=0;o<a.length;o++){var c=a[o];qn=c,d0(c,s)}c0(s)}for(s=s.child;s!==null;){switch(a=s,a.tag){case 0:case 11:case 15:Ii(8,a,a.return),Sd(a);break;case 22:o=a.stateNode,o._visibility&2&&(o._visibility&=-3,Sd(a));break;default:Sd(a)}s=s.sibling}}function d0(s,a){for(;qn!==null;){var o=qn;switch(o.tag){case 0:case 11:case 15:Ii(8,o,a);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:gc(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,qn=c;else e:for(o=s;qn!==null;){c=qn;var m=c.sibling,f=c.return;if(t0(c),c===o){qn=null;break e}if(m!==null){m.return=f,qn=m;break e}qn=f}}}var jj={getCacheForType:function(s){var a=Qn(Cn),o=a.data.get(s);return o===void 0&&(o=s(),a.data.set(s,o)),o},cacheSignal:function(){return Qn(Cn).controller.signal}},Tj=typeof WeakMap=="function"?WeakMap:Map,Bs=0,Ys=null,cs=null,ms=0,zs=0,Ur=null,Mi=!1,kl=!1,Pf=!1,ri=0,bn=0,Di=0,Mo=0,Lf=0,Fr=0,jl=0,Dc=null,Cr=null,Of=!1,Nd=0,h0=0,Cd=1/0,Rd=null,Pi=null,Vn=0,Li=null,Tl=null,ai=0,Vf=0,Bf=null,m0=null,Pc=0,Uf=null;function zr(){return(Bs&2)!==0&&ms!==0?ms&-ms:W.T!==null?Wf():Te()}function f0(){if(Fr===0)if((ms&536870912)===0||ws){var s=Q;Q<<=1,(Q&3932160)===0&&(Q=262144),Fr=s}else Fr=536870912;return s=Vr.current,s!==null&&(s.flags|=32),Fr}function Rr(s,a,o){(s===Ys&&(zs===2||zs===9)||s.cancelPendingCommit!==null)&&(El(s,0),Oi(s,ms,Fr,!1)),Ls(s,o),((Bs&2)===0||s!==Ys)&&(s===Ys&&((Bs&2)===0&&(Mo|=o),bn===4&&Oi(s,ms,Fr,!1)),Ra(s))}function p0(s,a,o){if((Bs&6)!==0)throw Error(i(327));var c=!o&&(a&127)===0&&(a&s.expiredLanes)===0||Et(s,a),m=c?Nj(s,a):zf(s,a,!0),f=c;do{if(m===0){kl&&!c&&Oi(s,a,0,!1);break}else{if(o=s.current.alternate,f&&!Ej(o)){m=zf(s,a,!1),f=!1;continue}if(m===2){if(f=a,s.errorRecoveryDisabledLanes&f)var x=0;else x=s.pendingLanes&-536870913,x=x!==0?x:x&536870912?536870912:0;if(x!==0){a=x;e:{var S=s;m=Dc;var z=S.current.memoizedState.isDehydrated;if(z&&(El(S,x).flags|=256),x=zf(S,x,!1),x!==2){if(Pf&&!z){S.errorRecoveryDisabledLanes|=f,Mo|=f,m=4;break e}f=Cr,Cr=m,f!==null&&(Cr===null?Cr=f:Cr.push.apply(Cr,f))}m=x}if(f=!1,m!==2)continue}}if(m===1){El(s,0),Oi(s,a,0,!0);break}e:{switch(c=s,f=m,f){case 0:case 1:throw Error(i(345));case 4:if((a&4194048)!==a)break;case 6:Oi(c,a,Fr,!Mi);break e;case 2:Cr=null;break;case 3:case 5:break;default:throw Error(i(329))}if((a&62914560)===a&&(m=Nd+300-ts(),10<m)){if(Oi(c,a,Fr,!Mi),At(c,0,!0)!==0)break e;ai=a,c.timeoutHandle=W0(g0.bind(null,c,o,Cr,Rd,Of,a,Fr,Mo,jl,Mi,f,"Throttled",-0,0),m);break e}g0(c,o,Cr,Rd,Of,a,Fr,Mo,jl,Mi,f,null,-0,0)}}break}while(!0);Ra(s)}function g0(s,a,o,c,m,f,x,S,z,oe,je,Me,ce,ye){if(s.timeoutHandle=-1,Me=a.subtreeFlags,Me&8192||(Me&16785408)===16785408){Me={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:tn},l0(a,f,Me);var mt=(f&62914560)===f?Nd-ts():(f&4194048)===f?h0-ts():0;if(mt=uT(Me,mt),mt!==null){ai=f,s.cancelPendingCommit=mt(j0.bind(null,s,a,f,o,c,m,x,S,z,je,Me,null,ce,ye)),Oi(s,f,x,!oe);return}}j0(s,a,f,o,c,m,x,S,z)}function Ej(s){for(var a=s;;){var o=a.tag;if((o===0||o===11||o===15)&&a.flags&16384&&(o=a.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var m=o[c],f=m.getSnapshot;m=m.value;try{if(!Lr(f(),m))return!1}catch{return!1}}if(o=a.child,a.subtreeFlags&16384&&o!==null)o.return=a,a=o;else{if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Oi(s,a,o,c){a&=~Lf,a&=~Mo,s.suspendedLanes|=a,s.pingedLanes&=~a,c&&(s.warmLanes|=a),c=s.expirationTimes;for(var m=a;0<m;){var f=31-Pe(m),x=1<<f;c[f]=-1,m&=~x}o!==0&&is(s,o,a)}function Ad(){return(Bs&6)===0?(Lc(0),!1):!0}function Ff(){if(cs!==null){if(zs===0)var s=cs.return;else s=cs,Ka=jo=null,sf(s),gl=null,bc=0,s=cs;for(;s!==null;)Gv(s.alternate,s),s=s.return;cs=null}}function El(s,a){var o=s.timeoutHandle;o!==-1&&(s.timeoutHandle=-1,Wj(o)),o=s.cancelPendingCommit,o!==null&&(s.cancelPendingCommit=null,o()),ai=0,Ff(),Ys=s,cs=o=Wa(s.current,null),ms=a,zs=0,Ur=null,Mi=!1,kl=Et(s,a),Pf=!1,jl=Fr=Lf=Mo=Di=bn=0,Cr=Dc=null,Of=!1,(a&8)!==0&&(a|=a&32);var c=s.entangledLanes;if(c!==0)for(s=s.entanglements,c&=a;0<c;){var m=31-Pe(c),f=1<<m;a|=s[m],c&=~f}return ri=a,Ju(),o}function y0(s,a){es=null,W.H=Ec,a===pl||a===id?(a=Mb(),zs=3):a===Hm?(a=Mb(),zs=4):zs=a===vf?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Ur=a,cs===null&&(bn=1,xd(s,Qr(a,s.current)))}function b0(){var s=Vr.current;return s===null?!0:(ms&4194048)===ms?ea===null:(ms&62914560)===ms||(ms&536870912)!==0?s===ea:!1}function v0(){var s=W.H;return W.H=Ec,s===null?Ec:s}function x0(){var s=W.A;return W.A=jj,s}function Id(){bn=4,Mi||(ms&4194048)!==ms&&Vr.current!==null||(kl=!0),(Di&134217727)===0&&(Mo&134217727)===0||Ys===null||Oi(Ys,ms,Fr,!1)}function zf(s,a,o){var c=Bs;Bs|=2;var m=v0(),f=x0();(Ys!==s||ms!==a)&&(Rd=null,El(s,a)),a=!1;var x=bn;e:do try{if(zs!==0&&cs!==null){var S=cs,z=Ur;switch(zs){case 8:Ff(),x=6;break e;case 3:case 2:case 9:case 6:Vr.current===null&&(a=!0);var oe=zs;if(zs=0,Ur=null,Sl(s,S,z,oe),o&&kl){x=0;break e}break;default:oe=zs,zs=0,Ur=null,Sl(s,S,z,oe)}}Sj(),x=bn;break}catch(je){y0(s,je)}while(!0);return a&&s.shellSuspendCounter++,Ka=jo=null,Bs=c,W.H=m,W.A=f,cs===null&&(Ys=null,ms=0,Ju()),x}function Sj(){for(;cs!==null;)w0(cs)}function Nj(s,a){var o=Bs;Bs|=2;var c=v0(),m=x0();Ys!==s||ms!==a?(Rd=null,Cd=ts()+500,El(s,a)):kl=Et(s,a);e:do try{if(zs!==0&&cs!==null){a=cs;var f=Ur;t:switch(zs){case 1:zs=0,Ur=null,Sl(s,a,f,1);break;case 2:case 9:if(Ab(f)){zs=0,Ur=null,_0(a);break}a=function(){zs!==2&&zs!==9||Ys!==s||(zs=7),Ra(s)},f.then(a,a);break e;case 3:zs=7;break e;case 4:zs=5;break e;case 7:Ab(f)?(zs=0,Ur=null,_0(a)):(zs=0,Ur=null,Sl(s,a,f,7));break;case 5:var x=null;switch(cs.tag){case 26:x=cs.memoizedState;case 5:case 27:var S=cs;if(x?o1(x):S.stateNode.complete){zs=0,Ur=null;var z=S.sibling;if(z!==null)cs=z;else{var oe=S.return;oe!==null?(cs=oe,Md(oe)):cs=null}break t}}zs=0,Ur=null,Sl(s,a,f,5);break;case 6:zs=0,Ur=null,Sl(s,a,f,6);break;case 8:Ff(),bn=6;break e;default:throw Error(i(462))}}Cj();break}catch(je){y0(s,je)}while(!0);return Ka=jo=null,W.H=c,W.A=m,Bs=o,cs!==null?0:(Ys=null,ms=0,Ju(),bn)}function Cj(){for(;cs!==null&&!en();)w0(cs)}function w0(s){var a=$v(s.alternate,s,ri);s.memoizedProps=s.pendingProps,a===null?Md(s):cs=a}function _0(s){var a=s,o=a.alternate;switch(a.tag){case 15:case 0:a=Bv(o,a,a.pendingProps,a.type,void 0,ms);break;case 11:a=Bv(o,a,a.pendingProps,a.type.render,a.ref,ms);break;case 5:sf(a);default:Gv(o,a),a=cs=xb(a,ri),a=$v(o,a,ri)}s.memoizedProps=s.pendingProps,a===null?Md(s):cs=a}function Sl(s,a,o,c){Ka=jo=null,sf(a),gl=null,bc=0;var m=a.return;try{if(yj(s,m,a,o,ms)){bn=1,xd(s,Qr(o,s.current)),cs=null;return}}catch(f){if(m!==null)throw cs=m,f;bn=1,xd(s,Qr(o,s.current)),cs=null;return}a.flags&32768?(ws||c===1?s=!0:kl||(ms&536870912)!==0?s=!1:(Mi=s=!0,(c===2||c===9||c===3||c===6)&&(c=Vr.current,c!==null&&c.tag===13&&(c.flags|=16384))),k0(a,s)):Md(a)}function Md(s){var a=s;do{if((a.flags&32768)!==0){k0(a,Mi);return}s=a.return;var o=xj(a.alternate,a,ri);if(o!==null){cs=o;return}if(a=a.sibling,a!==null){cs=a;return}cs=a=s}while(a!==null);bn===0&&(bn=5)}function k0(s,a){do{var o=wj(s.alternate,s);if(o!==null){o.flags&=32767,cs=o;return}if(o=s.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!a&&(s=s.sibling,s!==null)){cs=s;return}cs=s=o}while(s!==null);bn=6,cs=null}function j0(s,a,o,c,m,f,x,S,z){s.cancelPendingCommit=null;do Dd();while(Vn!==0);if((Bs&6)!==0)throw Error(i(327));if(a!==null){if(a===s.current)throw Error(i(177));if(f=a.lanes|a.childLanes,f|=Cm,Xs(s,o,f,x,S,z),s===Ys&&(cs=Ys=null,ms=0),Tl=a,Li=s,ai=o,Vf=f,Bf=m,m0=c,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Mj(Ot,function(){return C0(),null})):(s.callbackNode=null,s.callbackPriority=0),c=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||c){c=W.T,W.T=null,m=pe.p,pe.p=2,x=Bs,Bs|=4;try{_j(s,a,o)}finally{Bs=x,pe.p=m,W.T=c}}Vn=1,T0(),E0(),S0()}}function T0(){if(Vn===1){Vn=0;var s=Li,a=Tl,o=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||o){o=W.T,W.T=null;var c=pe.p;pe.p=2;var m=Bs;Bs|=4;try{a0(a,s);var f=ep,x=db(s.containerInfo),S=f.focusedElem,z=f.selectionRange;if(x!==S&&S&&S.ownerDocument&&ub(S.ownerDocument.documentElement,S)){if(z!==null&&jm(S)){var oe=z.start,je=z.end;if(je===void 0&&(je=oe),"selectionStart"in S)S.selectionStart=oe,S.selectionEnd=Math.min(je,S.value.length);else{var Me=S.ownerDocument||document,ce=Me&&Me.defaultView||window;if(ce.getSelection){var ye=ce.getSelection(),mt=S.textContent.length,Mt=Math.min(z.start,mt),Ws=z.end===void 0?Mt:Math.min(z.end,mt);!ye.extend&&Mt>Ws&&(x=Ws,Ws=Mt,Mt=x);var J=cb(S,Mt),G=cb(S,Ws);if(J&&G&&(ye.rangeCount!==1||ye.anchorNode!==J.node||ye.anchorOffset!==J.offset||ye.focusNode!==G.node||ye.focusOffset!==G.offset)){var ie=Me.createRange();ie.setStart(J.node,J.offset),ye.removeAllRanges(),Mt>Ws?(ye.addRange(ie),ye.extend(G.node,G.offset)):(ie.setEnd(G.node,G.offset),ye.addRange(ie))}}}}for(Me=[],ye=S;ye=ye.parentNode;)ye.nodeType===1&&Me.push({element:ye,left:ye.scrollLeft,top:ye.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<Me.length;S++){var Re=Me[S];Re.element.scrollLeft=Re.left,Re.element.scrollTop=Re.top}}Wd=!!Zf,ep=Zf=null}finally{Bs=m,pe.p=c,W.T=o}}s.current=a,Vn=2}}function E0(){if(Vn===2){Vn=0;var s=Li,a=Tl,o=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||o){o=W.T,W.T=null;var c=pe.p;pe.p=2;var m=Bs;Bs|=4;try{e0(s,a.alternate,a)}finally{Bs=m,pe.p=c,W.T=o}}Vn=3}}function S0(){if(Vn===4||Vn===3){Vn=0,As();var s=Li,a=Tl,o=ai,c=m0;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?Vn=5:(Vn=0,Tl=Li=null,N0(s,s.pendingLanes));var m=s.pendingLanes;if(m===0&&(Pi=null),we(o),a=a.stateNode,X&&typeof X.onCommitFiberRoot=="function")try{X.onCommitFiberRoot(Ge,a,void 0,(a.current.flags&128)===128)}catch{}if(c!==null){a=W.T,m=pe.p,pe.p=2,W.T=null;try{for(var f=s.onRecoverableError,x=0;x<c.length;x++){var S=c[x];f(S.value,{componentStack:S.stack})}}finally{W.T=a,pe.p=m}}(ai&3)!==0&&Dd(),Ra(s),m=s.pendingLanes,(o&261930)!==0&&(m&42)!==0?s===Uf?Pc++:(Pc=0,Uf=s):Pc=0,Lc(0)}}function N0(s,a){(s.pooledCacheLanes&=a)===0&&(a=s.pooledCache,a!=null&&(s.pooledCache=null,gc(a)))}function Dd(){return T0(),E0(),S0(),C0()}function C0(){if(Vn!==5)return!1;var s=Li,a=Vf;Vf=0;var o=we(ai),c=W.T,m=pe.p;try{pe.p=32>o?32:o,W.T=null,o=Bf,Bf=null;var f=Li,x=ai;if(Vn=0,Tl=Li=null,ai=0,(Bs&6)!==0)throw Error(i(331));var S=Bs;if(Bs|=4,u0(f.current),o0(f,f.current,x,o),Bs=S,Lc(0,!1),X&&typeof X.onPostCommitFiberRoot=="function")try{X.onPostCommitFiberRoot(Ge,f)}catch{}return!0}finally{pe.p=m,W.T=c,N0(s,a)}}function R0(s,a,o){a=Qr(o,a),a=bf(s.stateNode,a,2),s=Ci(s,a,2),s!==null&&(Ls(s,2),Ra(s))}function qs(s,a,o){if(s.tag===3)R0(s,s,o);else for(;a!==null;){if(a.tag===3){R0(a,s,o);break}else if(a.tag===1){var c=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Pi===null||!Pi.has(c))){s=Qr(o,s),o=Av(2),c=Ci(a,o,2),c!==null&&(Iv(o,c,a,s),Ls(c,2),Ra(c));break}}a=a.return}}function qf(s,a,o){var c=s.pingCache;if(c===null){c=s.pingCache=new Tj;var m=new Set;c.set(a,m)}else m=c.get(a),m===void 0&&(m=new Set,c.set(a,m));m.has(o)||(Pf=!0,m.add(o),s=Rj.bind(null,s,a,o),a.then(s,s))}function Rj(s,a,o){var c=s.pingCache;c!==null&&c.delete(a),s.pingedLanes|=s.suspendedLanes&o,s.warmLanes&=~o,Ys===s&&(ms&o)===o&&(bn===4||bn===3&&(ms&62914560)===ms&&300>ts()-Nd?(Bs&2)===0&&El(s,0):Lf|=o,jl===ms&&(jl=0)),Ra(s)}function A0(s,a){a===0&&(a=Ut()),s=wo(s,a),s!==null&&(Ls(s,a),Ra(s))}function Aj(s){var a=s.memoizedState,o=0;a!==null&&(o=a.retryLane),A0(s,o)}function Ij(s,a){var o=0;switch(s.tag){case 31:case 13:var c=s.stateNode,m=s.memoizedState;m!==null&&(o=m.retryLane);break;case 19:c=s.stateNode;break;case 22:c=s.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(a),A0(s,o)}function Mj(s,a){return rt(s,a)}var Pd=null,Nl=null,Hf=!1,Ld=!1,$f=!1,Vi=0;function Ra(s){s!==Nl&&s.next===null&&(Nl===null?Pd=Nl=s:Nl=Nl.next=s),Ld=!0,Hf||(Hf=!0,Pj())}function Lc(s,a){if(!$f&&Ld){$f=!0;do for(var o=!1,c=Pd;c!==null;){if(s!==0){var m=c.pendingLanes;if(m===0)var f=0;else{var x=c.suspendedLanes,S=c.pingedLanes;f=(1<<31-Pe(42|s)+1)-1,f&=m&~(x&~S),f=f&201326741?f&201326741|1:f?f|2:0}f!==0&&(o=!0,P0(c,f))}else f=ms,f=At(c,c===Ys?f:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(f&3)===0||Et(c,f)||(o=!0,P0(c,f));c=c.next}while(o);$f=!1}}function Dj(){I0()}function I0(){Ld=Hf=!1;var s=0;Vi!==0&&$j()&&(s=Vi);for(var a=ts(),o=null,c=Pd;c!==null;){var m=c.next,f=M0(c,a);f===0?(c.next=null,o===null?Pd=m:o.next=m,m===null&&(Nl=o)):(o=c,(s!==0||(f&3)!==0)&&(Ld=!0)),c=m}Vn!==0&&Vn!==5||Lc(s),Vi!==0&&(Vi=0)}function M0(s,a){for(var o=s.suspendedLanes,c=s.pingedLanes,m=s.expirationTimes,f=s.pendingLanes&-62914561;0<f;){var x=31-Pe(f),S=1<<x,z=m[x];z===-1?((S&o)===0||(S&c)!==0)&&(m[x]=ss(S,a)):z<=a&&(s.expiredLanes|=S),f&=~S}if(a=Ys,o=ms,o=At(s,s===a?o:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c=s.callbackNode,o===0||s===a&&(zs===2||zs===9)||s.cancelPendingCommit!==null)return c!==null&&c!==null&&qt(c),s.callbackNode=null,s.callbackPriority=0;if((o&3)===0||Et(s,o)){if(a=o&-o,a===s.callbackPriority)return a;switch(c!==null&&qt(c),we(o)){case 2:case 8:o=Ss;break;case 32:o=Ot;break;case 268435456:o=ue;break;default:o=Ot}return c=D0.bind(null,s),o=rt(o,c),s.callbackPriority=a,s.callbackNode=o,a}return c!==null&&c!==null&&qt(c),s.callbackPriority=2,s.callbackNode=null,2}function D0(s,a){if(Vn!==0&&Vn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var o=s.callbackNode;if(Dd()&&s.callbackNode!==o)return null;var c=ms;return c=At(s,s===Ys?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c===0?null:(p0(s,c,a),M0(s,ts()),s.callbackNode!=null&&s.callbackNode===o?D0.bind(null,s):null)}function P0(s,a){if(Dd())return null;p0(s,a,!0)}function Pj(){Gj(function(){(Bs&6)!==0?rt(Jt,Dj):I0()})}function Wf(){if(Vi===0){var s=ml;s===0&&(s=Tt,Tt<<=1,(Tt&261888)===0&&(Tt=256)),Vi=s}return Vi}function L0(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:_r(""+s)}function O0(s,a){var o=a.ownerDocument.createElement("input");return o.name=a.name,o.value=a.value,s.id&&o.setAttribute("form",s.id),a.parentNode.insertBefore(o,a),s=new FormData(s),o.parentNode.removeChild(o),s}function Lj(s,a,o,c,m){if(a==="submit"&&o&&o.stateNode===m){var f=L0((m[ht]||null).action),x=c.submitter;x&&(a=(a=x[ht]||null)?L0(a.formAction):x.getAttribute("formAction"),a!==null&&(f=a,x=null));var S=new Fn("action","action",null,c,m);s.push({event:S,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Vi!==0){var z=x?O0(m,x):new FormData(m);hf(o,{pending:!0,data:z,method:m.method,action:f},null,z)}}else typeof f=="function"&&(S.preventDefault(),z=x?O0(m,x):new FormData(m),hf(o,{pending:!0,data:z,method:m.method,action:f},f,z))},currentTarget:m}]})}}for(var Gf=0;Gf<Nm.length;Gf++){var Kf=Nm[Gf],Oj=Kf.toLowerCase(),Vj=Kf[0].toUpperCase()+Kf.slice(1);ua(Oj,"on"+Vj)}ua(fb,"onAnimationEnd"),ua(pb,"onAnimationIteration"),ua(gb,"onAnimationStart"),ua("dblclick","onDoubleClick"),ua("focusin","onFocus"),ua("focusout","onBlur"),ua(ej,"onTransitionRun"),ua(tj,"onTransitionStart"),ua(sj,"onTransitionCancel"),ua(yb,"onTransitionEnd"),Be("onMouseEnter",["mouseout","mouseover"]),Be("onMouseLeave",["mouseout","mouseover"]),Be("onPointerEnter",["pointerout","pointerover"]),Be("onPointerLeave",["pointerout","pointerover"]),me("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),me("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),me("onBeforeInput",["compositionend","keypress","textInput","paste"]),me("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),me("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),me("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Oc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Bj=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Oc));function V0(s,a){a=(a&4)!==0;for(var o=0;o<s.length;o++){var c=s[o],m=c.event;c=c.listeners;e:{var f=void 0;if(a)for(var x=c.length-1;0<=x;x--){var S=c[x],z=S.instance,oe=S.currentTarget;if(S=S.listener,z!==f&&m.isPropagationStopped())break e;f=S,m.currentTarget=oe;try{f(m)}catch(je){Xu(je)}m.currentTarget=null,f=z}else for(x=0;x<c.length;x++){if(S=c[x],z=S.instance,oe=S.currentTarget,S=S.listener,z!==f&&m.isPropagationStopped())break e;f=S,m.currentTarget=oe;try{f(m)}catch(je){Xu(je)}m.currentTarget=null,f=z}}}}function us(s,a){var o=a[vt];o===void 0&&(o=a[vt]=new Set);var c=s+"__bubble";o.has(c)||(B0(a,s,2,!1),o.add(c))}function Yf(s,a,o){var c=0;a&&(c|=4),B0(o,s,c,a)}var Od="_reactListening"+Math.random().toString(36).slice(2);function Qf(s){if(!s[Od]){s[Od]=!0,P.forEach(function(o){o!=="selectionchange"&&(Bj.has(o)||Yf(o,!1,s),Yf(o,!0,s))});var a=s.nodeType===9?s:s.ownerDocument;a===null||a[Od]||(a[Od]=!0,Yf("selectionchange",!1,a))}}function B0(s,a,o,c){switch(f1(a)){case 2:var m=mT;break;case 8:m=fT;break;default:m=dp}o=m.bind(null,a,o,s),m=void 0,!Z||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(m=!0),c?m!==void 0?s.addEventListener(a,o,{capture:!0,passive:m}):s.addEventListener(a,o,!0):m!==void 0?s.addEventListener(a,o,{passive:m}):s.addEventListener(a,o,!1)}function Xf(s,a,o,c,m){var f=c;if((a&1)===0&&(a&2)===0&&c!==null)e:for(;;){if(c===null)return;var x=c.tag;if(x===3||x===4){var S=c.stateNode.containerInfo;if(S===m)break;if(x===4)for(x=c.return;x!==null;){var z=x.tag;if((z===3||z===4)&&x.stateNode.containerInfo===m)return;x=x.return}for(;S!==null;){if(x=kn(S),x===null)return;if(z=x.tag,z===5||z===6||z===26||z===27){c=f=x;continue e}S=S.parentNode}}c=c.return}Ta(function(){var oe=f,je=Nn(o),Me=[];e:{var ce=bb.get(s);if(ce!==void 0){var ye=Fn,mt=s;switch(s){case"keypress":if(Bt(o)===0)break e;case"keydown":case"keyup":ye=Ku;break;case"focusin":mt="focus",ye=gn;break;case"focusout":mt="blur",ye=gn;break;case"beforeblur":case"afterblur":ye=gn;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ye=nr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ye=dr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ye=b;break;case fb:case pb:case gb:ye=Tr;break;case yb:ye=C;break;case"scroll":case"scrollend":ye=Js;break;case"wheel":ye=fe;break;case"copy":case"cut":case"paste":ye=tl;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ye=$a;break;case"toggle":case"beforetoggle":ye=Zt}var Mt=(a&4)!==0,Ws=!Mt&&(s==="scroll"||s==="scrollend"),J=Mt?ce!==null?ce+"Capture":null:ce;Mt=[];for(var G=oe,ie;G!==null;){var Re=G;if(ie=Re.stateNode,Re=Re.tag,Re!==5&&Re!==26&&Re!==27||ie===null||J===null||(Re=Pr(G,J),Re!=null&&Mt.push(Vc(G,Re,ie))),Ws)break;G=G.return}0<Mt.length&&(ce=new ye(ce,mt,null,o,je),Me.push({event:ce,listeners:Mt}))}}if((a&7)===0){e:{if(ce=s==="mouseover"||s==="pointerover",ye=s==="mouseout"||s==="pointerout",ce&&o!==Ln&&(mt=o.relatedTarget||o.fromElement)&&(kn(mt)||mt[st]))break e;if((ye||ce)&&(ce=je.window===je?je:(ce=je.ownerDocument)?ce.defaultView||ce.parentWindow:window,ye?(mt=o.relatedTarget||o.toElement,ye=oe,mt=mt?kn(mt):null,mt!==null&&(Ws=u(mt),Mt=mt.tag,mt!==Ws||Mt!==5&&Mt!==27&&Mt!==6)&&(mt=null)):(ye=null,mt=oe),ye!==mt)){if(Mt=nr,Re="onMouseLeave",J="onMouseEnter",G="mouse",(s==="pointerout"||s==="pointerover")&&(Mt=$a,Re="onPointerLeave",J="onPointerEnter",G="pointer"),Ws=ye==null?ce:Fs(ye),ie=mt==null?ce:Fs(mt),ce=new Mt(Re,G+"leave",ye,o,je),ce.target=Ws,ce.relatedTarget=ie,Re=null,kn(je)===oe&&(Mt=new Mt(J,G+"enter",mt,o,je),Mt.target=ie,Mt.relatedTarget=Ws,Re=Mt),Ws=Re,ye&&mt)t:{for(Mt=Uj,J=ye,G=mt,ie=0,Re=J;Re;Re=Mt(Re))ie++;Re=0;for(var St=G;St;St=Mt(St))Re++;for(;0<ie-Re;)J=Mt(J),ie--;for(;0<Re-ie;)G=Mt(G),Re--;for(;ie--;){if(J===G||G!==null&&J===G.alternate){Mt=J;break t}J=Mt(J),G=Mt(G)}Mt=null}else Mt=null;ye!==null&&U0(Me,ce,ye,Mt,!1),mt!==null&&Ws!==null&&U0(Me,Ws,mt,Mt,!0)}}e:{if(ce=oe?Fs(oe):window,ye=ce.nodeName&&ce.nodeName.toLowerCase(),ye==="select"||ye==="input"&&ce.type==="file")var Is=nb;else if(tb(ce))if(rb)Is=Xk;else{Is=Yk;var yt=Kk}else ye=ce.nodeName,!ye||ye.toLowerCase()!=="input"||ce.type!=="checkbox"&&ce.type!=="radio"?oe&&un(oe.elementType)&&(Is=nb):Is=Qk;if(Is&&(Is=Is(s,oe))){sb(Me,Is,o,je);break e}yt&&yt(s,ce,oe),s==="focusout"&&oe&&ce.type==="number"&&oe.memoizedProps.value!=null&&cn(ce,"number",ce.value)}switch(yt=oe?Fs(oe):window,s){case"focusin":(tb(yt)||yt.contentEditable==="true")&&(al=yt,Tm=oe,mc=null);break;case"focusout":mc=Tm=al=null;break;case"mousedown":Em=!0;break;case"contextmenu":case"mouseup":case"dragend":Em=!1,hb(Me,o,je);break;case"selectionchange":if(Zk)break;case"keydown":case"keyup":hb(Me,o,je)}var ns;if(Vs)e:{switch(s){case"compositionstart":var fs="onCompositionStart";break e;case"compositionend":fs="onCompositionEnd";break e;case"compositionupdate":fs="onCompositionUpdate";break e}fs=void 0}else rl?bo(s,o)&&(fs="onCompositionEnd"):s==="keydown"&&o.keyCode===229&&(fs="onCompositionStart");fs&&(Ea&&o.locale!=="ko"&&(rl||fs!=="onCompositionStart"?fs==="onCompositionEnd"&&rl&&(ns=ot()):(et=je,kt="value"in et?et.value:et.textContent,rl=!0)),yt=Vd(oe,fs),0<yt.length&&(fs=new mr(fs,s,null,o,je),Me.push({event:fs,listeners:yt}),ns?fs.data=ns:(ns=nl(o),ns!==null&&(fs.data=ns)))),(ns=Kr?Hk(s,o):$k(s,o))&&(fs=Vd(oe,"onBeforeInput"),0<fs.length&&(yt=new mr("onBeforeInput","beforeinput",null,o,je),Me.push({event:yt,listeners:fs}),yt.data=ns)),Lj(Me,s,oe,o,je)}V0(Me,a)})}function Vc(s,a,o){return{instance:s,listener:a,currentTarget:o}}function Vd(s,a){for(var o=a+"Capture",c=[];s!==null;){var m=s,f=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||f===null||(m=Pr(s,o),m!=null&&c.unshift(Vc(s,m,f)),m=Pr(s,a),m!=null&&c.push(Vc(s,m,f))),s.tag===3)return c;s=s.return}return[]}function Uj(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function U0(s,a,o,c,m){for(var f=a._reactName,x=[];o!==null&&o!==c;){var S=o,z=S.alternate,oe=S.stateNode;if(S=S.tag,z!==null&&z===c)break;S!==5&&S!==26&&S!==27||oe===null||(z=oe,m?(oe=Pr(o,f),oe!=null&&x.unshift(Vc(o,oe,z))):m||(oe=Pr(o,f),oe!=null&&x.push(Vc(o,oe,z)))),o=o.return}x.length!==0&&s.push({event:a,listeners:x})}var Fj=/\r\n?/g,zj=/\u0000|\uFFFD/g;function F0(s){return(typeof s=="string"?s:""+s).replace(Fj,`
`).replace(zj,"")}function z0(s,a){return a=F0(a),F0(s)===a}function $s(s,a,o,c,m,f){switch(o){case"children":typeof c=="string"?a==="body"||a==="textarea"&&c===""||pn(s,c):(typeof c=="number"||typeof c=="bigint")&&a!=="body"&&pn(s,""+c);break;case"className":os(s,"class",c);break;case"tabIndex":os(s,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":os(s,o,c);break;case"style":as(s,c,f);break;case"data":if(a!=="object"){os(s,"data",c);break}case"src":case"href":if(c===""&&(a!=="a"||o!=="href")){s.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(o);break}c=_r(""+c),s.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){s.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof f=="function"&&(o==="formAction"?(a!=="input"&&$s(s,a,"name",m.name,m,null),$s(s,a,"formEncType",m.formEncType,m,null),$s(s,a,"formMethod",m.formMethod,m,null),$s(s,a,"formTarget",m.formTarget,m,null)):($s(s,a,"encType",m.encType,m,null),$s(s,a,"method",m.method,m,null),$s(s,a,"target",m.target,m,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(o);break}c=_r(""+c),s.setAttribute(o,c);break;case"onClick":c!=null&&(s.onclick=tn);break;case"onScroll":c!=null&&us("scroll",s);break;case"onScrollEnd":c!=null&&us("scrollend",s);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(m.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"multiple":s.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":s.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){s.removeAttribute("xlink:href");break}o=_r(""+c),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,""+c):s.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,""):s.removeAttribute(o);break;case"capture":case"download":c===!0?s.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,c):s.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?s.setAttribute(o,c):s.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?s.removeAttribute(o):s.setAttribute(o,c);break;case"popover":us("beforetoggle",s),us("toggle",s),bs(s,"popover",c);break;case"xlinkActuate":ls(s,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":ls(s,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":ls(s,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":ls(s,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":ls(s,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":ls(s,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":ls(s,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":ls(s,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":ls(s,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":bs(s,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=sr.get(o)||o,bs(s,o,c))}}function Jf(s,a,o,c,m,f){switch(o){case"style":as(s,c,f);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(m.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"children":typeof c=="string"?pn(s,c):(typeof c=="number"||typeof c=="bigint")&&pn(s,""+c);break;case"onScroll":c!=null&&us("scroll",s);break;case"onScrollEnd":c!=null&&us("scrollend",s);break;case"onClick":c!=null&&(s.onclick=tn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!U.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(m=o.endsWith("Capture"),a=o.slice(2,m?o.length-7:void 0),f=s[ht]||null,f=f!=null?f[o]:null,typeof f=="function"&&s.removeEventListener(a,f,m),typeof c=="function")){typeof f!="function"&&f!==null&&(o in s?s[o]=null:s.hasAttribute(o)&&s.removeAttribute(o)),s.addEventListener(a,c,m);break e}o in s?s[o]=c:c===!0?s.setAttribute(o,""):bs(s,o,c)}}}function Jn(s,a,o){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":us("error",s),us("load",s);var c=!1,m=!1,f;for(f in o)if(o.hasOwnProperty(f)){var x=o[f];if(x!=null)switch(f){case"src":c=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:$s(s,a,f,x,o,null)}}m&&$s(s,a,"srcSet",o.srcSet,o,null),c&&$s(s,a,"src",o.src,o,null);return;case"input":us("invalid",s);var S=f=x=m=null,z=null,oe=null;for(c in o)if(o.hasOwnProperty(c)){var je=o[c];if(je!=null)switch(c){case"name":m=je;break;case"type":x=je;break;case"checked":z=je;break;case"defaultChecked":oe=je;break;case"value":f=je;break;case"defaultValue":S=je;break;case"children":case"dangerouslySetInnerHTML":if(je!=null)throw Error(i(137,a));break;default:$s(s,a,c,je,o,null)}}vs(s,f,S,z,oe,x,m,!1);return;case"select":us("invalid",s),c=x=f=null;for(m in o)if(o.hasOwnProperty(m)&&(S=o[m],S!=null))switch(m){case"value":f=S;break;case"defaultValue":x=S;break;case"multiple":c=S;default:$s(s,a,m,S,o,null)}a=f,o=x,s.multiple=!!c,a!=null?hs(s,!!c,a,!1):o!=null&&hs(s,!!c,o,!0);return;case"textarea":us("invalid",s),f=m=c=null;for(x in o)if(o.hasOwnProperty(x)&&(S=o[x],S!=null))switch(x){case"value":c=S;break;case"defaultValue":m=S;break;case"children":f=S;break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(i(91));break;default:$s(s,a,x,S,o,null)}Gr(s,c,m,f);return;case"option":for(z in o)o.hasOwnProperty(z)&&(c=o[z],c!=null)&&(z==="selected"?s.selected=c&&typeof c!="function"&&typeof c!="symbol":$s(s,a,z,c,o,null));return;case"dialog":us("beforetoggle",s),us("toggle",s),us("cancel",s),us("close",s);break;case"iframe":case"object":us("load",s);break;case"video":case"audio":for(c=0;c<Oc.length;c++)us(Oc[c],s);break;case"image":us("error",s),us("load",s);break;case"details":us("toggle",s);break;case"embed":case"source":case"link":us("error",s),us("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(oe in o)if(o.hasOwnProperty(oe)&&(c=o[oe],c!=null))switch(oe){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:$s(s,a,oe,c,o,null)}return;default:if(un(a)){for(je in o)o.hasOwnProperty(je)&&(c=o[je],c!==void 0&&Jf(s,a,je,c,o,void 0));return}}for(S in o)o.hasOwnProperty(S)&&(c=o[S],c!=null&&$s(s,a,S,c,o,null))}function qj(s,a,o,c){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,f=null,x=null,S=null,z=null,oe=null,je=null;for(ye in o){var Me=o[ye];if(o.hasOwnProperty(ye)&&Me!=null)switch(ye){case"checked":break;case"value":break;case"defaultValue":z=Me;default:c.hasOwnProperty(ye)||$s(s,a,ye,null,c,Me)}}for(var ce in c){var ye=c[ce];if(Me=o[ce],c.hasOwnProperty(ce)&&(ye!=null||Me!=null))switch(ce){case"type":f=ye;break;case"name":m=ye;break;case"checked":oe=ye;break;case"defaultChecked":je=ye;break;case"value":x=ye;break;case"defaultValue":S=ye;break;case"children":case"dangerouslySetInnerHTML":if(ye!=null)throw Error(i(137,a));break;default:ye!==Me&&$s(s,a,ce,ye,c,Me)}}Rt(s,x,S,z,oe,je,f,m);return;case"select":ye=x=S=ce=null;for(f in o)if(z=o[f],o.hasOwnProperty(f)&&z!=null)switch(f){case"value":break;case"multiple":ye=z;default:c.hasOwnProperty(f)||$s(s,a,f,null,c,z)}for(m in c)if(f=c[m],z=o[m],c.hasOwnProperty(m)&&(f!=null||z!=null))switch(m){case"value":ce=f;break;case"defaultValue":S=f;break;case"multiple":x=f;default:f!==z&&$s(s,a,m,f,c,z)}a=S,o=x,c=ye,ce!=null?hs(s,!!o,ce,!1):!!c!=!!o&&(a!=null?hs(s,!!o,a,!0):hs(s,!!o,o?[]:"",!1));return;case"textarea":ye=ce=null;for(S in o)if(m=o[S],o.hasOwnProperty(S)&&m!=null&&!c.hasOwnProperty(S))switch(S){case"value":break;case"children":break;default:$s(s,a,S,null,c,m)}for(x in c)if(m=c[x],f=o[x],c.hasOwnProperty(x)&&(m!=null||f!=null))switch(x){case"value":ce=m;break;case"defaultValue":ye=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(i(91));break;default:m!==f&&$s(s,a,x,m,c,f)}Wn(s,ce,ye);return;case"option":for(var mt in o)ce=o[mt],o.hasOwnProperty(mt)&&ce!=null&&!c.hasOwnProperty(mt)&&(mt==="selected"?s.selected=!1:$s(s,a,mt,null,c,ce));for(z in c)ce=c[z],ye=o[z],c.hasOwnProperty(z)&&ce!==ye&&(ce!=null||ye!=null)&&(z==="selected"?s.selected=ce&&typeof ce!="function"&&typeof ce!="symbol":$s(s,a,z,ce,c,ye));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Mt in o)ce=o[Mt],o.hasOwnProperty(Mt)&&ce!=null&&!c.hasOwnProperty(Mt)&&$s(s,a,Mt,null,c,ce);for(oe in c)if(ce=c[oe],ye=o[oe],c.hasOwnProperty(oe)&&ce!==ye&&(ce!=null||ye!=null))switch(oe){case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(i(137,a));break;default:$s(s,a,oe,ce,c,ye)}return;default:if(un(a)){for(var Ws in o)ce=o[Ws],o.hasOwnProperty(Ws)&&ce!==void 0&&!c.hasOwnProperty(Ws)&&Jf(s,a,Ws,void 0,c,ce);for(je in c)ce=c[je],ye=o[je],!c.hasOwnProperty(je)||ce===ye||ce===void 0&&ye===void 0||Jf(s,a,je,ce,c,ye);return}}for(var J in o)ce=o[J],o.hasOwnProperty(J)&&ce!=null&&!c.hasOwnProperty(J)&&$s(s,a,J,null,c,ce);for(Me in c)ce=c[Me],ye=o[Me],!c.hasOwnProperty(Me)||ce===ye||ce==null&&ye==null||$s(s,a,Me,ce,c,ye)}function q0(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Hj(){if(typeof performance.getEntriesByType=="function"){for(var s=0,a=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var m=o[c],f=m.transferSize,x=m.initiatorType,S=m.duration;if(f&&S&&q0(x)){for(x=0,S=m.responseEnd,c+=1;c<o.length;c++){var z=o[c],oe=z.startTime;if(oe>S)break;var je=z.transferSize,Me=z.initiatorType;je&&q0(Me)&&(z=z.responseEnd,x+=je*(z<S?1:(S-oe)/(z-oe)))}if(--c,a+=8*(f+x)/(m.duration/1e3),s++,10<s)break}}if(0<s)return a/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var Zf=null,ep=null;function Bd(s){return s.nodeType===9?s:s.ownerDocument}function H0(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function $0(s,a){if(s===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&a==="foreignObject"?0:s}function tp(s,a){return s==="textarea"||s==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var sp=null;function $j(){var s=window.event;return s&&s.type==="popstate"?s===sp?!1:(sp=s,!0):(sp=null,!1)}var W0=typeof setTimeout=="function"?setTimeout:void 0,Wj=typeof clearTimeout=="function"?clearTimeout:void 0,G0=typeof Promise=="function"?Promise:void 0,Gj=typeof queueMicrotask=="function"?queueMicrotask:typeof G0<"u"?function(s){return G0.resolve(null).then(s).catch(Kj)}:W0;function Kj(s){setTimeout(function(){throw s})}function Bi(s){return s==="head"}function K0(s,a){var o=a,c=0;do{var m=o.nextSibling;if(s.removeChild(o),m&&m.nodeType===8)if(o=m.data,o==="/$"||o==="/&"){if(c===0){s.removeChild(m),Il(a);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")Bc(s.ownerDocument.documentElement);else if(o==="head"){o=s.ownerDocument.head,Bc(o);for(var f=o.firstChild;f;){var x=f.nextSibling,S=f.nodeName;f[ln]||S==="SCRIPT"||S==="STYLE"||S==="LINK"&&f.rel.toLowerCase()==="stylesheet"||o.removeChild(f),f=x}}else o==="body"&&Bc(s.ownerDocument.body);o=m}while(o);Il(a)}function Y0(s,a){var o=s;s=0;do{var c=o.nextSibling;if(o.nodeType===1?a?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(a?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(s===0)break;s--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||s++;o=c}while(o)}function np(s){var a=s.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var o=a;switch(a=a.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":np(o),_n(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}s.removeChild(o)}}function Yj(s,a,o,c){for(;s.nodeType===1;){var m=o;if(s.nodeName.toLowerCase()!==a.toLowerCase()){if(!c&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(c){if(!s[ln])switch(a){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(f=s.getAttribute("rel"),f==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(f!==m.rel||s.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||s.getAttribute("title")!==(m.title==null?null:m.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(f=s.getAttribute("src"),(f!==(m.src==null?null:m.src)||s.getAttribute("type")!==(m.type==null?null:m.type)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&f&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(a==="input"&&s.type==="hidden"){var f=m.name==null?null:""+m.name;if(m.type==="hidden"&&s.getAttribute("name")===f)return s}else return s;if(s=ta(s.nextSibling),s===null)break}return null}function Qj(s,a,o){if(a==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!o||(s=ta(s.nextSibling),s===null))return null;return s}function Q0(s,a){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!a||(s=ta(s.nextSibling),s===null))return null;return s}function rp(s){return s.data==="$?"||s.data==="$~"}function ap(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function Xj(s,a){var o=s.ownerDocument;if(s.data==="$~")s._reactRetry=a;else if(s.data!=="$?"||o.readyState!=="loading")a();else{var c=function(){a(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),s._reactRetry=c}}function ta(s){for(;s!=null;s=s.nextSibling){var a=s.nodeType;if(a===1||a===3)break;if(a===8){if(a=s.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return s}var ip=null;function X0(s){s=s.nextSibling;for(var a=0;s;){if(s.nodeType===8){var o=s.data;if(o==="/$"||o==="/&"){if(a===0)return ta(s.nextSibling);a--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||a++}s=s.nextSibling}return null}function J0(s){s=s.previousSibling;for(var a=0;s;){if(s.nodeType===8){var o=s.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(a===0)return s;a--}else o!=="/$"&&o!=="/&"||a++}s=s.previousSibling}return null}function Z0(s,a,o){switch(a=Bd(o),s){case"html":if(s=a.documentElement,!s)throw Error(i(452));return s;case"head":if(s=a.head,!s)throw Error(i(453));return s;case"body":if(s=a.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function Bc(s){for(var a=s.attributes;a.length;)s.removeAttributeNode(a[0]);_n(s)}var sa=new Map,e1=new Set;function Ud(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var ii=pe.d;pe.d={f:Jj,r:Zj,D:eT,C:tT,L:sT,m:nT,X:aT,S:rT,M:iT};function Jj(){var s=ii.f(),a=Ad();return s||a}function Zj(s){var a=fn(s);a!==null&&a.tag===5&&a.type==="form"?yv(a):ii.r(s)}var Cl=typeof document>"u"?null:document;function t1(s,a,o){var c=Cl;if(c&&typeof a=="string"&&a){var m=_t(a);m='link[rel="'+s+'"][href="'+m+'"]',typeof o=="string"&&(m+='[crossorigin="'+o+'"]'),e1.has(m)||(e1.add(m),s={rel:s,crossOrigin:o,href:a},c.querySelector(m)===null&&(a=c.createElement("link"),Jn(a,"link",s),N(a),c.head.appendChild(a)))}}function eT(s){ii.D(s),t1("dns-prefetch",s,null)}function tT(s,a){ii.C(s,a),t1("preconnect",s,a)}function sT(s,a,o){ii.L(s,a,o);var c=Cl;if(c&&s&&a){var m='link[rel="preload"][as="'+_t(a)+'"]';a==="image"&&o&&o.imageSrcSet?(m+='[imagesrcset="'+_t(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(m+='[imagesizes="'+_t(o.imageSizes)+'"]')):m+='[href="'+_t(s)+'"]';var f=m;switch(a){case"style":f=Rl(s);break;case"script":f=Al(s)}sa.has(f)||(s=j({rel:"preload",href:a==="image"&&o&&o.imageSrcSet?void 0:s,as:a},o),sa.set(f,s),c.querySelector(m)!==null||a==="style"&&c.querySelector(Uc(f))||a==="script"&&c.querySelector(Fc(f))||(a=c.createElement("link"),Jn(a,"link",s),N(a),c.head.appendChild(a)))}}function nT(s,a){ii.m(s,a);var o=Cl;if(o&&s){var c=a&&typeof a.as=="string"?a.as:"script",m='link[rel="modulepreload"][as="'+_t(c)+'"][href="'+_t(s)+'"]',f=m;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":f=Al(s)}if(!sa.has(f)&&(s=j({rel:"modulepreload",href:s},a),sa.set(f,s),o.querySelector(m)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Fc(f)))return}c=o.createElement("link"),Jn(c,"link",s),N(c),o.head.appendChild(c)}}}function rT(s,a,o){ii.S(s,a,o);var c=Cl;if(c&&s){var m=k(c).hoistableStyles,f=Rl(s);a=a||"default";var x=m.get(f);if(!x){var S={loading:0,preload:null};if(x=c.querySelector(Uc(f)))S.loading=5;else{s=j({rel:"stylesheet",href:s,"data-precedence":a},o),(o=sa.get(f))&&op(s,o);var z=x=c.createElement("link");N(z),Jn(z,"link",s),z._p=new Promise(function(oe,je){z.onload=oe,z.onerror=je}),z.addEventListener("load",function(){S.loading|=1}),z.addEventListener("error",function(){S.loading|=2}),S.loading|=4,Fd(x,a,c)}x={type:"stylesheet",instance:x,count:1,state:S},m.set(f,x)}}}function aT(s,a){ii.X(s,a);var o=Cl;if(o&&s){var c=k(o).hoistableScripts,m=Al(s),f=c.get(m);f||(f=o.querySelector(Fc(m)),f||(s=j({src:s,async:!0},a),(a=sa.get(m))&&lp(s,a),f=o.createElement("script"),N(f),Jn(f,"link",s),o.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},c.set(m,f))}}function iT(s,a){ii.M(s,a);var o=Cl;if(o&&s){var c=k(o).hoistableScripts,m=Al(s),f=c.get(m);f||(f=o.querySelector(Fc(m)),f||(s=j({src:s,async:!0,type:"module"},a),(a=sa.get(m))&&lp(s,a),f=o.createElement("script"),N(f),Jn(f,"link",s),o.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},c.set(m,f))}}function s1(s,a,o,c){var m=(m=Fe.current)?Ud(m):null;if(!m)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(a=Rl(o.href),o=k(m).hoistableStyles,c=o.get(a),c||(c={type:"style",instance:null,count:0,state:null},o.set(a,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){s=Rl(o.href);var f=k(m).hoistableStyles,x=f.get(s);if(x||(m=m.ownerDocument||m,x={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},f.set(s,x),(f=m.querySelector(Uc(s)))&&!f._p&&(x.instance=f,x.state.loading=5),sa.has(s)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},sa.set(s,o),f||oT(m,s,o,x.state))),a&&c===null)throw Error(i(528,""));return x}if(a&&c!==null)throw Error(i(529,""));return null;case"script":return a=o.async,o=o.src,typeof o=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Al(o),o=k(m).hoistableScripts,c=o.get(a),c||(c={type:"script",instance:null,count:0,state:null},o.set(a,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function Rl(s){return'href="'+_t(s)+'"'}function Uc(s){return'link[rel="stylesheet"]['+s+"]"}function n1(s){return j({},s,{"data-precedence":s.precedence,precedence:null})}function oT(s,a,o,c){s.querySelector('link[rel="preload"][as="style"]['+a+"]")?c.loading=1:(a=s.createElement("link"),c.preload=a,a.addEventListener("load",function(){return c.loading|=1}),a.addEventListener("error",function(){return c.loading|=2}),Jn(a,"link",o),N(a),s.head.appendChild(a))}function Al(s){return'[src="'+_t(s)+'"]'}function Fc(s){return"script[async]"+s}function r1(s,a,o){if(a.count++,a.instance===null)switch(a.type){case"style":var c=s.querySelector('style[data-href~="'+_t(o.href)+'"]');if(c)return a.instance=c,N(c),c;var m=j({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(s.ownerDocument||s).createElement("style"),N(c),Jn(c,"style",m),Fd(c,o.precedence,s),a.instance=c;case"stylesheet":m=Rl(o.href);var f=s.querySelector(Uc(m));if(f)return a.state.loading|=4,a.instance=f,N(f),f;c=n1(o),(m=sa.get(m))&&op(c,m),f=(s.ownerDocument||s).createElement("link"),N(f);var x=f;return x._p=new Promise(function(S,z){x.onload=S,x.onerror=z}),Jn(f,"link",c),a.state.loading|=4,Fd(f,o.precedence,s),a.instance=f;case"script":return f=Al(o.src),(m=s.querySelector(Fc(f)))?(a.instance=m,N(m),m):(c=o,(m=sa.get(f))&&(c=j({},o),lp(c,m)),s=s.ownerDocument||s,m=s.createElement("script"),N(m),Jn(m,"link",c),s.head.appendChild(m),a.instance=m);case"void":return null;default:throw Error(i(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(c=a.instance,a.state.loading|=4,Fd(c,o.precedence,s));return a.instance}function Fd(s,a,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=c.length?c[c.length-1]:null,f=m,x=0;x<c.length;x++){var S=c[x];if(S.dataset.precedence===a)f=S;else if(f!==m)break}f?f.parentNode.insertBefore(s,f.nextSibling):(a=o.nodeType===9?o.head:o,a.insertBefore(s,a.firstChild))}function op(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.title==null&&(s.title=a.title)}function lp(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.integrity==null&&(s.integrity=a.integrity)}var zd=null;function a1(s,a,o){if(zd===null){var c=new Map,m=zd=new Map;m.set(o,c)}else m=zd,c=m.get(o),c||(c=new Map,m.set(o,c));if(c.has(s))return c;for(c.set(s,null),o=o.getElementsByTagName(s),m=0;m<o.length;m++){var f=o[m];if(!(f[ln]||f[lt]||s==="link"&&f.getAttribute("rel")==="stylesheet")&&f.namespaceURI!=="http://www.w3.org/2000/svg"){var x=f.getAttribute(a)||"";x=s+x;var S=c.get(x);S?S.push(f):c.set(x,[f])}}return c}function i1(s,a,o){s=s.ownerDocument||s,s.head.insertBefore(o,a==="title"?s.querySelector("head > title"):null)}function lT(s,a,o){if(o===1||a.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;return a.rel==="stylesheet"?(s=a.disabled,typeof a.precedence=="string"&&s==null):!0;case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function o1(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function cT(s,a,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var m=Rl(c.href),f=a.querySelector(Uc(m));if(f){a=f._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(s.count++,s=qd.bind(s),a.then(s,s)),o.state.loading|=4,o.instance=f,N(f);return}f=a.ownerDocument||a,c=n1(c),(m=sa.get(m))&&op(c,m),f=f.createElement("link"),N(f);var x=f;x._p=new Promise(function(S,z){x.onload=S,x.onerror=z}),Jn(f,"link",c),o.instance=f}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(o,a),(a=o.state.preload)&&(o.state.loading&3)===0&&(s.count++,o=qd.bind(s),a.addEventListener("load",o),a.addEventListener("error",o))}}var cp=0;function uT(s,a){return s.stylesheets&&s.count===0&&$d(s,s.stylesheets),0<s.count||0<s.imgCount?function(o){var c=setTimeout(function(){if(s.stylesheets&&$d(s,s.stylesheets),s.unsuspend){var f=s.unsuspend;s.unsuspend=null,f()}},6e4+a);0<s.imgBytes&&cp===0&&(cp=62500*Hj());var m=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&$d(s,s.stylesheets),s.unsuspend)){var f=s.unsuspend;s.unsuspend=null,f()}},(s.imgBytes>cp?50:800)+a);return s.unsuspend=o,function(){s.unsuspend=null,clearTimeout(c),clearTimeout(m)}}:null}function qd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)$d(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Hd=null;function $d(s,a){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Hd=new Map,a.forEach(dT,s),Hd=null,qd.call(s))}function dT(s,a){if(!(a.state.loading&4)){var o=Hd.get(s);if(o)var c=o.get(null);else{o=new Map,Hd.set(s,o);for(var m=s.querySelectorAll("link[data-precedence],style[data-precedence]"),f=0;f<m.length;f++){var x=m[f];(x.nodeName==="LINK"||x.getAttribute("media")!=="not all")&&(o.set(x.dataset.precedence,x),c=x)}c&&o.set(null,c)}m=a.instance,x=m.getAttribute("data-precedence"),f=o.get(x)||c,f===c&&o.set(null,m),o.set(x,m),this.count++,c=qd.bind(this),m.addEventListener("load",c),m.addEventListener("error",c),f?f.parentNode.insertBefore(m,f.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(m,s.firstChild)),a.state.loading|=4}}var zc={$$typeof:ae,Provider:null,Consumer:null,_currentValue:Ve,_currentValue2:Ve,_threadCount:0};function hT(s,a,o,c,m,f,x,S,z){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Vt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Vt(0),this.hiddenUpdates=Vt(null),this.identifierPrefix=c,this.onUncaughtError=m,this.onCaughtError=f,this.onRecoverableError=x,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=z,this.incompleteTransitions=new Map}function l1(s,a,o,c,m,f,x,S,z,oe,je,Me){return s=new hT(s,a,o,x,z,oe,je,Me,S),a=1,f===!0&&(a|=24),f=Or(3,null,null,a),s.current=f,f.stateNode=s,a=Fm(),a.refCount++,s.pooledCache=a,a.refCount++,f.memoizedState={element:c,isDehydrated:o,cache:a},$m(f),s}function c1(s){return s?(s=ll,s):ll}function u1(s,a,o,c,m,f){m=c1(m),c.context===null?c.context=m:c.pendingContext=m,c=Ni(a),c.payload={element:o},f=f===void 0?null:f,f!==null&&(c.callback=f),o=Ci(s,c,a),o!==null&&(Rr(o,s,a),xc(o,s,a))}function d1(s,a){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var o=s.retryLane;s.retryLane=o!==0&&o<a?o:a}}function up(s,a){d1(s,a),(s=s.alternate)&&d1(s,a)}function h1(s){if(s.tag===13||s.tag===31){var a=wo(s,67108864);a!==null&&Rr(a,s,67108864),up(s,67108864)}}function m1(s){if(s.tag===13||s.tag===31){var a=zr();a=q(a);var o=wo(s,a);o!==null&&Rr(o,s,a),up(s,a)}}var Wd=!0;function mT(s,a,o,c){var m=W.T;W.T=null;var f=pe.p;try{pe.p=2,dp(s,a,o,c)}finally{pe.p=f,W.T=m}}function fT(s,a,o,c){var m=W.T;W.T=null;var f=pe.p;try{pe.p=8,dp(s,a,o,c)}finally{pe.p=f,W.T=m}}function dp(s,a,o,c){if(Wd){var m=hp(c);if(m===null)Xf(s,a,c,Gd,o),p1(s,c);else if(gT(m,s,a,o,c))c.stopPropagation();else if(p1(s,c),a&4&&-1<pT.indexOf(s)){for(;m!==null;){var f=fn(m);if(f!==null)switch(f.tag){case 3:if(f=f.stateNode,f.current.memoizedState.isDehydrated){var x=tt(f.pendingLanes);if(x!==0){var S=f;for(S.pendingLanes|=2,S.entangledLanes|=2;x;){var z=1<<31-Pe(x);S.entanglements[1]|=z,x&=~z}Ra(f),(Bs&6)===0&&(Cd=ts()+500,Lc(0))}}break;case 31:case 13:S=wo(f,2),S!==null&&Rr(S,f,2),Ad(),up(f,2)}if(f=hp(c),f===null&&Xf(s,a,c,Gd,o),f===m)break;m=f}m!==null&&c.stopPropagation()}else Xf(s,a,c,null,o)}}function hp(s){return s=Nn(s),mp(s)}var Gd=null;function mp(s){if(Gd=null,s=kn(s),s!==null){var a=u(s);if(a===null)s=null;else{var o=a.tag;if(o===13){if(s=d(a),s!==null)return s;s=null}else if(o===31){if(s=p(a),s!==null)return s;s=null}else if(o===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;s=null}else a!==s&&(s=null)}}return Gd=s,null}function f1(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ct()){case Jt:return 2;case Ss:return 8;case Ot:case Ps:return 32;case ue:return 268435456;default:return 32}default:return 32}}var fp=!1,Ui=null,Fi=null,zi=null,qc=new Map,Hc=new Map,qi=[],pT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function p1(s,a){switch(s){case"focusin":case"focusout":Ui=null;break;case"dragenter":case"dragleave":Fi=null;break;case"mouseover":case"mouseout":zi=null;break;case"pointerover":case"pointerout":qc.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hc.delete(a.pointerId)}}function $c(s,a,o,c,m,f){return s===null||s.nativeEvent!==f?(s={blockedOn:a,domEventName:o,eventSystemFlags:c,nativeEvent:f,targetContainers:[m]},a!==null&&(a=fn(a),a!==null&&h1(a)),s):(s.eventSystemFlags|=c,a=s.targetContainers,m!==null&&a.indexOf(m)===-1&&a.push(m),s)}function gT(s,a,o,c,m){switch(a){case"focusin":return Ui=$c(Ui,s,a,o,c,m),!0;case"dragenter":return Fi=$c(Fi,s,a,o,c,m),!0;case"mouseover":return zi=$c(zi,s,a,o,c,m),!0;case"pointerover":var f=m.pointerId;return qc.set(f,$c(qc.get(f)||null,s,a,o,c,m)),!0;case"gotpointercapture":return f=m.pointerId,Hc.set(f,$c(Hc.get(f)||null,s,a,o,c,m)),!0}return!1}function g1(s){var a=kn(s.target);if(a!==null){var o=u(a);if(o!==null){if(a=o.tag,a===13){if(a=d(o),a!==null){s.blockedOn=a,Ee(s.priority,function(){m1(o)});return}}else if(a===31){if(a=p(o),a!==null){s.blockedOn=a,Ee(s.priority,function(){m1(o)});return}}else if(a===3&&o.stateNode.current.memoizedState.isDehydrated){s.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Kd(s){if(s.blockedOn!==null)return!1;for(var a=s.targetContainers;0<a.length;){var o=hp(s.nativeEvent);if(o===null){o=s.nativeEvent;var c=new o.constructor(o.type,o);Ln=c,o.target.dispatchEvent(c),Ln=null}else return a=fn(o),a!==null&&h1(a),s.blockedOn=o,!1;a.shift()}return!0}function y1(s,a,o){Kd(s)&&o.delete(a)}function yT(){fp=!1,Ui!==null&&Kd(Ui)&&(Ui=null),Fi!==null&&Kd(Fi)&&(Fi=null),zi!==null&&Kd(zi)&&(zi=null),qc.forEach(y1),Hc.forEach(y1)}function Yd(s,a){s.blockedOn===a&&(s.blockedOn=null,fp||(fp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,yT)))}var Qd=null;function b1(s){Qd!==s&&(Qd=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Qd===s&&(Qd=null);for(var a=0;a<s.length;a+=3){var o=s[a],c=s[a+1],m=s[a+2];if(typeof c!="function"){if(mp(c||o)===null)continue;break}var f=fn(o);f!==null&&(s.splice(a,3),a-=3,hf(f,{pending:!0,data:m,method:o.method,action:c},c,m))}}))}function Il(s){function a(z){return Yd(z,s)}Ui!==null&&Yd(Ui,s),Fi!==null&&Yd(Fi,s),zi!==null&&Yd(zi,s),qc.forEach(a),Hc.forEach(a);for(var o=0;o<qi.length;o++){var c=qi[o];c.blockedOn===s&&(c.blockedOn=null)}for(;0<qi.length&&(o=qi[0],o.blockedOn===null);)g1(o),o.blockedOn===null&&qi.shift();if(o=(s.ownerDocument||s).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var m=o[c],f=o[c+1],x=m[ht]||null;if(typeof f=="function")x||b1(o);else if(x){var S=null;if(f&&f.hasAttribute("formAction")){if(m=f,x=f[ht]||null)S=x.formAction;else if(mp(m)!==null)continue}else S=x.action;typeof S=="function"?o[c+1]=S:(o.splice(c,3),c-=3),b1(o)}}}function v1(){function s(f){f.canIntercept&&f.info==="react-transition"&&f.intercept({handler:function(){return new Promise(function(x){return m=x})},focusReset:"manual",scroll:"manual"})}function a(){m!==null&&(m(),m=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var f=navigation.currentEntry;f&&f.url!=null&&navigation.navigate(f.url,{state:f.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,m=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),m!==null&&(m(),m=null)}}}function pp(s){this._internalRoot=s}Xd.prototype.render=pp.prototype.render=function(s){var a=this._internalRoot;if(a===null)throw Error(i(409));var o=a.current,c=zr();u1(o,c,s,a,null,null)},Xd.prototype.unmount=pp.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var a=s.containerInfo;u1(s.current,2,null,s,null,null),Ad(),a[st]=null}};function Xd(s){this._internalRoot=s}Xd.prototype.unstable_scheduleHydration=function(s){if(s){var a=Te();s={blockedOn:null,target:s,priority:a};for(var o=0;o<qi.length&&a!==0&&a<qi[o].priority;o++);qi.splice(o,0,s),o===0&&g1(s)}};var x1=e.version;if(x1!=="19.2.4")throw Error(i(527,x1,"19.2.4"));pe.findDOMNode=function(s){var a=s._reactInternals;if(a===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=y(a),s=s!==null?w(s):null,s=s===null?null:s.stateNode,s};var bT={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:W,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Jd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Jd.isDisabled&&Jd.supportsFiber)try{Ge=Jd.inject(bT),X=Jd}catch{}}return Gc.createRoot=function(s,a){if(!l(s))throw Error(i(299));var o=!1,c="",m=Sv,f=Nv,x=Cv;return a!=null&&(a.unstable_strictMode===!0&&(o=!0),a.identifierPrefix!==void 0&&(c=a.identifierPrefix),a.onUncaughtError!==void 0&&(m=a.onUncaughtError),a.onCaughtError!==void 0&&(f=a.onCaughtError),a.onRecoverableError!==void 0&&(x=a.onRecoverableError)),a=l1(s,1,!1,null,null,o,c,null,m,f,x,v1),s[st]=a.current,Qf(s),new pp(a)},Gc.hydrateRoot=function(s,a,o){if(!l(s))throw Error(i(299));var c=!1,m="",f=Sv,x=Nv,S=Cv,z=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(m=o.identifierPrefix),o.onUncaughtError!==void 0&&(f=o.onUncaughtError),o.onCaughtError!==void 0&&(x=o.onCaughtError),o.onRecoverableError!==void 0&&(S=o.onRecoverableError),o.formState!==void 0&&(z=o.formState)),a=l1(s,1,!0,a,o??null,c,m,z,f,x,S,v1),a.context=c1(null),o=a.current,c=zr(),c=q(c),m=Ni(c),m.callback=null,Ci(o,m,c),o=c,a.current.lanes=o,Ls(a,o),Ra(a),s[st]=a.current,Qf(s),new Xd(a)},Gc.version="19.2.4",Gc}var R1;function NT(){if(R1)return bp.exports;R1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),bp.exports=ST(),bp.exports}var CT=NT();const RT="modulepreload",AT=function(n){return"/login/"+n},A1={},wr=function(e,t,i){let l=Promise.resolve();if(t&&t.length>0){let g=function(y){return Promise.all(y.map(w=>Promise.resolve(w).then(j=>({status:"fulfilled",value:j}),j=>({status:"rejected",reason:j}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),p=d?.nonce||d?.getAttribute("nonce");l=g(t.map(y=>{if(y=AT(y),y in A1)return;A1[y]=!0;const w=y.endsWith(".css"),j=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${j}`))return;const T=document.createElement("link");if(T.rel=w?"stylesheet":RT,w||(T.as="script"),T.crossOrigin="",T.href=y,p&&T.setAttribute("nonce",p),document.head.appendChild(T),w)return new Promise((O,$)=>{T.addEventListener("load",O),T.addEventListener("error",()=>$(new Error(`Unable to preload CSS for ${y}`)))})}))}function u(d){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=d,window.dispatchEvent(p),!p.defaultPrevented)throw d}return l.then(d=>{for(const p of d||[])p.status==="rejected"&&u(p.reason);return e().catch(u)})};var I1="popstate";function IT(n={}){function e(i,l){let{pathname:u,search:d,hash:p}=i.location;return sg("",{pathname:u,search:d,hash:p},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function t(i,l){return typeof l=="string"?l:fu(l)}return DT(e,t,null,n)}function on(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function ra(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function MT(){return Math.random().toString(36).substring(2,10)}function M1(n,e){return{usr:n.state,key:n.key,idx:e}}function sg(n,e,t=null,i){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?tc(e):e,state:t,key:e&&e.key||i||MT()}}function fu({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function tc(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substring(i),n=n.substring(0,i)),n&&(e.pathname=n)}return e}function DT(n,e,t,i={}){let{window:l=document.defaultView,v5Compat:u=!1}=i,d=l.history,p="POP",g=null,y=w();y==null&&(y=0,d.replaceState({...d.state,idx:y},""));function w(){return(d.state||{idx:null}).idx}function j(){p="POP";let B=w(),te=B==null?null:B-y;y=B,g&&g({action:p,location:F.location,delta:te})}function T(B,te){p="PUSH";let K=sg(F.location,B,te);y=w()+1;let ae=M1(K,y),be=F.createHref(K);try{d.pushState(ae,"",be)}catch(ve){if(ve instanceof DOMException&&ve.name==="DataCloneError")throw ve;l.location.assign(be)}u&&g&&g({action:p,location:F.location,delta:1})}function O(B,te){p="REPLACE";let K=sg(F.location,B,te);y=w();let ae=M1(K,y),be=F.createHref(K);d.replaceState(ae,"",be),u&&g&&g({action:p,location:F.location,delta:0})}function $(B){return PT(B)}let F={get action(){return p},get location(){return n(l,d)},listen(B){if(g)throw new Error("A history only accepts one active listener");return l.addEventListener(I1,j),g=B,()=>{l.removeEventListener(I1,j),g=null}},createHref(B){return e(l,B)},createURL:$,encodeLocation(B){let te=$(B);return{pathname:te.pathname,search:te.search,hash:te.hash}},push:T,replace:O,go(B){return d.go(B)}};return F}function PT(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),on(t,"No window.location.(origin|href) available to create URL");let i=typeof n=="string"?n:fu(n);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function M2(n,e,t="/"){return LT(n,e,t,!1)}function LT(n,e,t,i){let l=typeof e=="string"?tc(e):e,u=mi(l.pathname||"/",t);if(u==null)return null;let d=D2(n);OT(d);let p=null;for(let g=0;p==null&&g<d.length;++g){let y=KT(u);p=WT(d[g],y,i)}return p}function D2(n,e=[],t=[],i="",l=!1){let u=(d,p,g=l,y)=>{let w={relativePath:y===void 0?d.path||"":y,caseSensitive:d.caseSensitive===!0,childrenIndex:p,route:d};if(w.relativePath.startsWith("/")){if(!w.relativePath.startsWith(i)&&g)return;on(w.relativePath.startsWith(i),`Absolute route path "${w.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),w.relativePath=w.relativePath.slice(i.length)}let j=ci([i,w.relativePath]),T=t.concat(w);d.children&&d.children.length>0&&(on(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${j}".`),D2(d.children,e,T,j,g)),!(d.path==null&&!d.index)&&e.push({path:j,score:HT(j,d.index),routesMeta:T})};return n.forEach((d,p)=>{if(d.path===""||!d.path?.includes("?"))u(d,p);else for(let g of P2(d.path))u(d,p,!0,g)}),e}function P2(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,l=t.endsWith("?"),u=t.replace(/\?$/,"");if(i.length===0)return l?[u,""]:[u];let d=P2(i.join("/")),p=[];return p.push(...d.map(g=>g===""?u:[u,g].join("/"))),l&&p.push(...d),p.map(g=>n.startsWith("/")&&g===""?"/":g)}function OT(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:$T(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var VT=/^:[\w-]+$/,BT=3,UT=2,FT=1,zT=10,qT=-2,D1=n=>n==="*";function HT(n,e){let t=n.split("/"),i=t.length;return t.some(D1)&&(i+=qT),e&&(i+=UT),t.filter(l=>!D1(l)).reduce((l,u)=>l+(VT.test(u)?BT:u===""?FT:zT),i)}function $T(n,e){return n.length===e.length&&n.slice(0,-1).every((i,l)=>i===e[l])?n[n.length-1]-e[e.length-1]:0}function WT(n,e,t=!1){let{routesMeta:i}=n,l={},u="/",d=[];for(let p=0;p<i.length;++p){let g=i[p],y=p===i.length-1,w=u==="/"?e:e.slice(u.length)||"/",j=Eh({path:g.relativePath,caseSensitive:g.caseSensitive,end:y},w),T=g.route;if(!j&&y&&t&&!i[i.length-1].route.index&&(j=Eh({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},w)),!j)return null;Object.assign(l,j.params),d.push({params:l,pathname:ci([u,j.pathname]),pathnameBase:JT(ci([u,j.pathnameBase])),route:T}),j.pathnameBase!=="/"&&(u=ci([u,j.pathnameBase]))}return d}function Eh(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=GT(n.path,n.caseSensitive,n.end),l=e.match(t);if(!l)return null;let u=l[0],d=u.replace(/(.)\/+$/,"$1"),p=l.slice(1);return{params:i.reduce((y,{paramName:w,isOptional:j},T)=>{if(w==="*"){let $=p[T]||"";d=u.slice(0,u.length-$.length).replace(/(.)\/+$/,"$1")}const O=p[T];return j&&!O?y[w]=void 0:y[w]=(O||"").replace(/%2F/g,"/"),y},{}),pathname:u,pathnameBase:d,pattern:n}}function GT(n,e=!1,t=!0){ra(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let i=[],l="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,p,g)=>(i.push({paramName:p,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(i.push({paramName:"*"}),l+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?l+="\\/*$":n!==""&&n!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,e?void 0:"i"),i]}function KT(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ra(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function mi(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}var YT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function QT(n,e="/"){let{pathname:t,search:i="",hash:l=""}=typeof n=="string"?tc(n):n,u;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?u=P1(t.substring(1),"/"):u=P1(t,e)):u=e,{pathname:u,search:ZT(i),hash:eE(l)}}function P1(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(l=>{l===".."?t.length>1&&t.pop():l!=="."&&t.push(l)}),t.length>1?t.join("/"):"/"}function _p(n,e,t,i){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function XT(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Lg(n){let e=XT(n);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function Og(n,e,t,i=!1){let l;typeof n=="string"?l=tc(n):(l={...n},on(!l.pathname||!l.pathname.includes("?"),_p("?","pathname","search",l)),on(!l.pathname||!l.pathname.includes("#"),_p("#","pathname","hash",l)),on(!l.search||!l.search.includes("#"),_p("#","search","hash",l)));let u=n===""||l.pathname==="",d=u?"/":l.pathname,p;if(d==null)p=t;else{let j=e.length-1;if(!i&&d.startsWith("..")){let T=d.split("/");for(;T[0]==="..";)T.shift(),j-=1;l.pathname=T.join("/")}p=j>=0?e[j]:"/"}let g=QT(l,p),y=d&&d!=="/"&&d.endsWith("/"),w=(u||d===".")&&t.endsWith("/");return!g.pathname.endsWith("/")&&(y||w)&&(g.pathname+="/"),g}var ci=n=>n.join("/").replace(/\/\/+/g,"/"),JT=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),ZT=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,eE=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,tE=class{constructor(n,e,t,i=!1){this.status=n,this.statusText=e||"",this.internal=i,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function sE(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function nE(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var L2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function O2(n,e){let t=n;if(typeof t!="string"||!YT.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let i=t,l=!1;if(L2)try{let u=new URL(window.location.href),d=t.startsWith("//")?new URL(u.protocol+t):new URL(t),p=mi(d.pathname,e);d.origin===u.origin&&p!=null?t=p+d.search+d.hash:l=!0}catch{ra(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:l,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var V2=["POST","PUT","PATCH","DELETE"];new Set(V2);var rE=["GET",...V2];new Set(rE);var sc=v.createContext(null);sc.displayName="DataRouter";var Yh=v.createContext(null);Yh.displayName="DataRouterState";var aE=v.createContext(!1),B2=v.createContext({isTransitioning:!1});B2.displayName="ViewTransition";var iE=v.createContext(new Map);iE.displayName="Fetchers";var oE=v.createContext(null);oE.displayName="Await";var Wr=v.createContext(null);Wr.displayName="Navigation";var Su=v.createContext(null);Su.displayName="Location";var wa=v.createContext({outlet:null,matches:[],isDataRoute:!1});wa.displayName="Route";var Vg=v.createContext(null);Vg.displayName="RouteError";var U2="REACT_ROUTER_ERROR",lE="REDIRECT",cE="ROUTE_ERROR_RESPONSE";function uE(n){if(n.startsWith(`${U2}:${lE}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function dE(n){if(n.startsWith(`${U2}:${cE}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new tE(e.status,e.statusText,e.data)}catch{}}function hE(n,{relative:e}={}){on(nc(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=v.useContext(Wr),{hash:l,pathname:u,search:d}=Nu(n,{relative:e}),p=u;return t!=="/"&&(p=u==="/"?t:ci([t,u])),i.createHref({pathname:p,search:d,hash:l})}function nc(){return v.useContext(Su)!=null}function _a(){return on(nc(),"useLocation() may be used only in the context of a <Router> component."),v.useContext(Su).location}var F2="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function z2(n){v.useContext(Wr).static||v.useLayoutEffect(n)}function $n(){let{isDataRoute:n}=v.useContext(wa);return n?EE():mE()}function mE(){on(nc(),"useNavigate() may be used only in the context of a <Router> component.");let n=v.useContext(sc),{basename:e,navigator:t}=v.useContext(Wr),{matches:i}=v.useContext(wa),{pathname:l}=_a(),u=JSON.stringify(Lg(i)),d=v.useRef(!1);return z2(()=>{d.current=!0}),v.useCallback((g,y={})=>{if(ra(d.current,F2),!d.current)return;if(typeof g=="number"){t.go(g);return}let w=Og(g,JSON.parse(u),l,y.relative==="path");n==null&&e!=="/"&&(w.pathname=w.pathname==="/"?e:ci([e,w.pathname])),(y.replace?t.replace:t.push)(w,y.state,y)},[e,t,u,l,n])}v.createContext(null);function fE(){let{matches:n}=v.useContext(wa),e=n[n.length-1];return e?e.params:{}}function Nu(n,{relative:e}={}){let{matches:t}=v.useContext(wa),{pathname:i}=_a(),l=JSON.stringify(Lg(t));return v.useMemo(()=>Og(n,JSON.parse(l),i,e==="path"),[n,l,i,e])}function pE(n,e){return q2(n,e)}function q2(n,e,t,i,l){on(nc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=v.useContext(Wr),{matches:d}=v.useContext(wa),p=d[d.length-1],g=p?p.params:{},y=p?p.pathname:"/",w=p?p.pathnameBase:"/",j=p&&p.route;{let K=j&&j.path||"";$2(y,!j||K.endsWith("*")||K.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${y}" (under <Route path="${K}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${K}"> to <Route path="${K==="/"?"*":`${K}/*`}">.`)}let T=_a(),O;if(e){let K=typeof e=="string"?tc(e):e;on(w==="/"||K.pathname?.startsWith(w),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${w}" but pathname "${K.pathname}" was given in the \`location\` prop.`),O=K}else O=T;let $=O.pathname||"/",F=$;if(w!=="/"){let K=w.replace(/^\//,"").split("/");F="/"+$.replace(/^\//,"").split("/").slice(K.length).join("/")}let B=M2(n,{pathname:F});ra(j||B!=null,`No routes matched location "${O.pathname}${O.search}${O.hash}" `),ra(B==null||B[B.length-1].route.element!==void 0||B[B.length-1].route.Component!==void 0||B[B.length-1].route.lazy!==void 0,`Matched leaf route at location "${O.pathname}${O.search}${O.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let te=xE(B&&B.map(K=>Object.assign({},K,{params:Object.assign({},g,K.params),pathname:ci([w,u.encodeLocation?u.encodeLocation(K.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:K.pathname]),pathnameBase:K.pathnameBase==="/"?w:ci([w,u.encodeLocation?u.encodeLocation(K.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:K.pathnameBase])})),d,t,i,l);return e&&te?v.createElement(Su.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...O},navigationType:"POP"}},te):te}function gE(){let n=TE(),e=sE(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:i},u={padding:"2px 4px",backgroundColor:i},d=null;return console.error("Error handled by React Router default ErrorBoundary:",n),d=v.createElement(v.Fragment,null,v.createElement("p",null," Hey developer "),v.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",v.createElement("code",{style:u},"ErrorBoundary")," or"," ",v.createElement("code",{style:u},"errorElement")," prop on your route.")),v.createElement(v.Fragment,null,v.createElement("h2",null,"Unexpected Application Error!"),v.createElement("h3",{style:{fontStyle:"italic"}},e),t?v.createElement("pre",{style:l},t):null,d)}var yE=v.createElement(gE,null),H2=class extends v.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=dE(n.digest);t&&(n=t)}let e=n!==void 0?v.createElement(wa.Provider,{value:this.props.routeContext},v.createElement(Vg.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?v.createElement(bE,{error:n},e):e}};H2.contextType=aE;var kp=new WeakMap;function bE({children:n,error:e}){let{basename:t}=v.useContext(Wr);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=uE(e.digest);if(i){let l=kp.get(e);if(l)throw l;let u=O2(i.location,t);if(L2&&!kp.get(e))if(u.isExternal||i.reloadDocument)window.location.href=u.absoluteURL||u.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(u.to,{replace:i.replace}));throw kp.set(e,d),d}return v.createElement("meta",{httpEquiv:"refresh",content:`0;url=${u.absoluteURL||u.to}`})}}return n}function vE({routeContext:n,match:e,children:t}){let i=v.useContext(sc);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),v.createElement(wa.Provider,{value:n},t)}function xE(n,e=[],t=null,i=null,l=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let u=n,d=t?.errors;if(d!=null){let w=u.findIndex(j=>j.route.id&&d?.[j.route.id]!==void 0);on(w>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),u=u.slice(0,Math.min(u.length,w+1))}let p=!1,g=-1;if(t)for(let w=0;w<u.length;w++){let j=u[w];if((j.route.HydrateFallback||j.route.hydrateFallbackElement)&&(g=w),j.route.id){let{loaderData:T,errors:O}=t,$=j.route.loader&&!T.hasOwnProperty(j.route.id)&&(!O||O[j.route.id]===void 0);if(j.route.lazy||$){p=!0,g>=0?u=u.slice(0,g+1):u=[u[0]];break}}}let y=t&&i?(w,j)=>{i(w,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:nE(t.matches),errorInfo:j})}:void 0;return u.reduceRight((w,j,T)=>{let O,$=!1,F=null,B=null;t&&(O=d&&j.route.id?d[j.route.id]:void 0,F=j.route.errorElement||yE,p&&(g<0&&T===0?($2("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),$=!0,B=null):g===T&&($=!0,B=j.route.hydrateFallbackElement||null)));let te=e.concat(u.slice(0,T+1)),K=()=>{let ae;return O?ae=F:$?ae=B:j.route.Component?ae=v.createElement(j.route.Component,null):j.route.element?ae=j.route.element:ae=w,v.createElement(vE,{match:j,routeContext:{outlet:w,matches:te,isDataRoute:t!=null},children:ae})};return t&&(j.route.ErrorBoundary||j.route.errorElement||T===0)?v.createElement(H2,{location:t.location,revalidation:t.revalidation,component:F,error:O,children:K(),routeContext:{outlet:null,matches:te,isDataRoute:!0},onError:y}):K()},null)}function Bg(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function wE(n){let e=v.useContext(sc);return on(e,Bg(n)),e}function _E(n){let e=v.useContext(Yh);return on(e,Bg(n)),e}function kE(n){let e=v.useContext(wa);return on(e,Bg(n)),e}function Ug(n){let e=kE(n),t=e.matches[e.matches.length-1];return on(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function jE(){return Ug("useRouteId")}function TE(){let n=v.useContext(Vg),e=_E("useRouteError"),t=Ug("useRouteError");return n!==void 0?n:e.errors?.[t]}function EE(){let{router:n}=wE("useNavigate"),e=Ug("useNavigate"),t=v.useRef(!1);return z2(()=>{t.current=!0}),v.useCallback(async(l,u={})=>{ra(t.current,F2),t.current&&(typeof l=="number"?await n.navigate(l):await n.navigate(l,{fromRouteId:e,...u}))},[n,e])}var L1={};function $2(n,e,t){!e&&!L1[n]&&(L1[n]=!0,ra(!1,t))}v.memo(SE);function SE({routes:n,future:e,state:t,onError:i}){return q2(n,void 0,t,i,e)}function NE({to:n,replace:e,state:t,relative:i}){on(nc(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=v.useContext(Wr);ra(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=v.useContext(wa),{pathname:d}=_a(),p=$n(),g=Og(n,Lg(u),d,i==="path"),y=JSON.stringify(g);return v.useEffect(()=>{p(JSON.parse(y),{replace:e,state:t,relative:i})},[p,y,i,e,t]),null}function Qs(n){on(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function CE({basename:n="/",children:e=null,location:t,navigationType:i="POP",navigator:l,static:u=!1,unstable_useTransitions:d}){on(!nc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let p=n.replace(/^\/*/,"/"),g=v.useMemo(()=>({basename:p,navigator:l,static:u,unstable_useTransitions:d,future:{}}),[p,l,u,d]);typeof t=="string"&&(t=tc(t));let{pathname:y="/",search:w="",hash:j="",state:T=null,key:O="default"}=t,$=v.useMemo(()=>{let F=mi(y,p);return F==null?null:{location:{pathname:F,search:w,hash:j,state:T,key:O},navigationType:i}},[p,y,w,j,T,O,i]);return ra($!=null,`<Router basename="${p}"> is not able to match the URL "${y}${w}${j}" because it does not start with the basename, so the <Router> won't render anything.`),$==null?null:v.createElement(Wr.Provider,{value:g},v.createElement(Su.Provider,{children:e,value:$}))}function RE({children:n,location:e}){return pE(ng(n),e)}function ng(n,e=[]){let t=[];return v.Children.forEach(n,(i,l)=>{if(!v.isValidElement(i))return;let u=[...e,l];if(i.type===v.Fragment){t.push.apply(t,ng(i.props.children,u));return}on(i.type===Qs,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),on(!i.props.index||!i.props.children,"An index route cannot have child routes.");let d={id:i.props.id||u.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(d.children=ng(i.props.children,u)),t.push(d)}),t}var fh="get",ph="application/x-www-form-urlencoded";function Qh(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function AE(n){return Qh(n)&&n.tagName.toLowerCase()==="button"}function IE(n){return Qh(n)&&n.tagName.toLowerCase()==="form"}function ME(n){return Qh(n)&&n.tagName.toLowerCase()==="input"}function DE(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function PE(n,e){return n.button===0&&(!e||e==="_self")&&!DE(n)}function rg(n=""){return new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let i=n[t];return e.concat(Array.isArray(i)?i.map(l=>[t,l]):[[t,i]])},[]))}function LE(n,e){let t=rg(n);return e&&e.forEach((i,l)=>{t.has(l)||e.getAll(l).forEach(u=>{t.append(l,u)})}),t}var Zd=null;function OE(){if(Zd===null)try{new FormData(document.createElement("form"),0),Zd=!1}catch{Zd=!0}return Zd}var VE=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function jp(n){return n!=null&&!VE.has(n)?(ra(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${ph}"`),null):n}function BE(n,e){let t,i,l,u,d;if(IE(n)){let p=n.getAttribute("action");i=p?mi(p,e):null,t=n.getAttribute("method")||fh,l=jp(n.getAttribute("enctype"))||ph,u=new FormData(n)}else if(AE(n)||ME(n)&&(n.type==="submit"||n.type==="image")){let p=n.form;if(p==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let g=n.getAttribute("formaction")||p.getAttribute("action");if(i=g?mi(g,e):null,t=n.getAttribute("formmethod")||p.getAttribute("method")||fh,l=jp(n.getAttribute("formenctype"))||jp(p.getAttribute("enctype"))||ph,u=new FormData(p,n),!OE()){let{name:y,type:w,value:j}=n;if(w==="image"){let T=y?`${y}.`:"";u.append(`${T}x`,"0"),u.append(`${T}y`,"0")}else y&&u.append(y,j)}}else{if(Qh(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=fh,i=null,l=ph,d=n}return u&&l==="text/plain"&&(d=u,u=void 0),{action:i,method:t.toLowerCase(),encType:l,formData:u,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Fg(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function UE(n,e,t,i){let l=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t?l.pathname.endsWith("/")?l.pathname=`${l.pathname}_.${i}`:l.pathname=`${l.pathname}.${i}`:l.pathname==="/"?l.pathname=`_root.${i}`:e&&mi(l.pathname,e)==="/"?l.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:l.pathname=`${l.pathname.replace(/\/$/,"")}.${i}`,l}async function FE(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function zE(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function qE(n,e,t){let i=await Promise.all(n.map(async l=>{let u=e.routes[l.route.id];if(u){let d=await FE(u,t);return d.links?d.links():[]}return[]}));return GE(i.flat(1).filter(zE).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function O1(n,e,t,i,l,u){let d=(g,y)=>t[y]?g.route.id!==t[y].route.id:!0,p=(g,y)=>t[y].pathname!==g.pathname||t[y].route.path?.endsWith("*")&&t[y].params["*"]!==g.params["*"];return u==="assets"?e.filter((g,y)=>d(g,y)||p(g,y)):u==="data"?e.filter((g,y)=>{let w=i.routes[g.route.id];if(!w||!w.hasLoader)return!1;if(d(g,y)||p(g,y))return!0;if(g.route.shouldRevalidate){let j=g.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:g.params,defaultShouldRevalidate:!0});if(typeof j=="boolean")return j}return!0}):[]}function HE(n,e,{includeHydrateFallback:t}={}){return $E(n.map(i=>{let l=e.routes[i.route.id];if(!l)return[];let u=[l.module];return l.clientActionModule&&(u=u.concat(l.clientActionModule)),l.clientLoaderModule&&(u=u.concat(l.clientLoaderModule)),t&&l.hydrateFallbackModule&&(u=u.concat(l.hydrateFallbackModule)),l.imports&&(u=u.concat(l.imports)),u}).flat(1))}function $E(n){return[...new Set(n)]}function WE(n){let e={},t=Object.keys(n).sort();for(let i of t)e[i]=n[i];return e}function GE(n,e){let t=new Set;return new Set(e),n.reduce((i,l)=>{let u=JSON.stringify(WE(l));return t.has(u)||(t.add(u),i.push({key:u,link:l})),i},[])}function W2(){let n=v.useContext(sc);return Fg(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function KE(){let n=v.useContext(Yh);return Fg(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var zg=v.createContext(void 0);zg.displayName="FrameworkContext";function G2(){let n=v.useContext(zg);return Fg(n,"You must render this element inside a <HydratedRouter> element"),n}function YE(n,e){let t=v.useContext(zg),[i,l]=v.useState(!1),[u,d]=v.useState(!1),{onFocus:p,onBlur:g,onMouseEnter:y,onMouseLeave:w,onTouchStart:j}=e,T=v.useRef(null);v.useEffect(()=>{if(n==="render"&&d(!0),n==="viewport"){let F=te=>{te.forEach(K=>{d(K.isIntersecting)})},B=new IntersectionObserver(F,{threshold:.5});return T.current&&B.observe(T.current),()=>{B.disconnect()}}},[n]),v.useEffect(()=>{if(i){let F=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(F)}}},[i]);let O=()=>{l(!0)},$=()=>{l(!1),d(!1)};return t?n!=="intent"?[u,T,{}]:[u,T,{onFocus:Kc(p,O),onBlur:Kc(g,$),onMouseEnter:Kc(y,O),onMouseLeave:Kc(w,$),onTouchStart:Kc(j,O)}]:[!1,T,{}]}function Kc(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function QE({page:n,...e}){let{router:t}=W2(),i=v.useMemo(()=>M2(t.routes,n,t.basename),[t.routes,n,t.basename]);return i?v.createElement(JE,{page:n,matches:i,...e}):null}function XE(n){let{manifest:e,routeModules:t}=G2(),[i,l]=v.useState([]);return v.useEffect(()=>{let u=!1;return qE(n,e,t).then(d=>{u||l(d)}),()=>{u=!0}},[n,e,t]),i}function JE({page:n,matches:e,...t}){let i=_a(),{future:l,manifest:u,routeModules:d}=G2(),{basename:p}=W2(),{loaderData:g,matches:y}=KE(),w=v.useMemo(()=>O1(n,e,y,u,i,"data"),[n,e,y,u,i]),j=v.useMemo(()=>O1(n,e,y,u,i,"assets"),[n,e,y,u,i]),T=v.useMemo(()=>{if(n===i.pathname+i.search+i.hash)return[];let F=new Set,B=!1;if(e.forEach(K=>{let ae=u.routes[K.route.id];!ae||!ae.hasLoader||(!w.some(be=>be.route.id===K.route.id)&&K.route.id in g&&d[K.route.id]?.shouldRevalidate||ae.hasClientLoader?B=!0:F.add(K.route.id))}),F.size===0)return[];let te=UE(n,p,l.unstable_trailingSlashAwareDataRequests,"data");return B&&F.size>0&&te.searchParams.set("_routes",e.filter(K=>F.has(K.route.id)).map(K=>K.route.id).join(",")),[te.pathname+te.search]},[p,l.unstable_trailingSlashAwareDataRequests,g,i,u,w,e,n,d]),O=v.useMemo(()=>HE(j,u),[j,u]),$=XE(j);return v.createElement(v.Fragment,null,T.map(F=>v.createElement("link",{key:F,rel:"prefetch",as:"fetch",href:F,...t})),O.map(F=>v.createElement("link",{key:F,rel:"modulepreload",href:F,...t})),$.map(({key:F,link:B})=>v.createElement("link",{key:F,nonce:t.nonce,...B,crossOrigin:B.crossOrigin??t.crossOrigin})))}function ZE(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var eS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{eS&&(window.__reactRouterVersion="7.13.0")}catch{}function tS({basename:n,children:e,unstable_useTransitions:t,window:i}){let l=v.useRef();l.current==null&&(l.current=IT({window:i,v5Compat:!0}));let u=l.current,[d,p]=v.useState({action:u.action,location:u.location}),g=v.useCallback(y=>{t===!1?p(y):v.startTransition(()=>p(y))},[t]);return v.useLayoutEffect(()=>u.listen(g),[u,g]),v.createElement(CE,{basename:n,children:e,location:d.location,navigationType:d.action,navigator:u,unstable_useTransitions:t})}var K2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Y2=v.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:l,reloadDocument:u,replace:d,state:p,target:g,to:y,preventScrollReset:w,viewTransition:j,unstable_defaultShouldRevalidate:T,...O},$){let{basename:F,unstable_useTransitions:B}=v.useContext(Wr),te=typeof y=="string"&&K2.test(y),K=O2(y,F);y=K.to;let ae=hE(y,{relative:l}),[be,ve,_e]=YE(i,O),R=aS(y,{replace:d,state:p,target:g,preventScrollReset:w,relative:l,viewTransition:j,unstable_defaultShouldRevalidate:T,unstable_useTransitions:B});function E(V){e&&e(V),V.defaultPrevented||R(V)}let A=v.createElement("a",{...O,..._e,href:K.absoluteURL||ae,onClick:K.isExternal||u?e:E,ref:ZE($,ve),target:g,"data-discover":!te&&t==="render"?"true":void 0});return be&&!te?v.createElement(v.Fragment,null,A,v.createElement(QE,{page:ae})):A});Y2.displayName="Link";var sS=v.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:l=!1,style:u,to:d,viewTransition:p,children:g,...y},w){let j=Nu(d,{relative:y.relative}),T=_a(),O=v.useContext(Yh),{navigator:$,basename:F}=v.useContext(Wr),B=O!=null&&dS(j)&&p===!0,te=$.encodeLocation?$.encodeLocation(j).pathname:j.pathname,K=T.pathname,ae=O&&O.navigation&&O.navigation.location?O.navigation.location.pathname:null;t||(K=K.toLowerCase(),ae=ae?ae.toLowerCase():null,te=te.toLowerCase()),ae&&F&&(ae=mi(ae,F)||ae);const be=te!=="/"&&te.endsWith("/")?te.length-1:te.length;let ve=K===te||!l&&K.startsWith(te)&&K.charAt(be)==="/",_e=ae!=null&&(ae===te||!l&&ae.startsWith(te)&&ae.charAt(te.length)==="/"),R={isActive:ve,isPending:_e,isTransitioning:B},E=ve?e:void 0,A;typeof i=="function"?A=i(R):A=[i,ve?"active":null,_e?"pending":null,B?"transitioning":null].filter(Boolean).join(" ");let V=typeof u=="function"?u(R):u;return v.createElement(Y2,{...y,"aria-current":E,className:A,ref:w,style:V,to:d,viewTransition:p},typeof g=="function"?g(R):g)});sS.displayName="NavLink";var nS=v.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:l,state:u,method:d=fh,action:p,onSubmit:g,relative:y,preventScrollReset:w,viewTransition:j,unstable_defaultShouldRevalidate:T,...O},$)=>{let{unstable_useTransitions:F}=v.useContext(Wr),B=cS(),te=uS(p,{relative:y}),K=d.toLowerCase()==="get"?"get":"post",ae=typeof p=="string"&&K2.test(p),be=ve=>{if(g&&g(ve),ve.defaultPrevented)return;ve.preventDefault();let _e=ve.nativeEvent.submitter,R=_e?.getAttribute("formmethod")||d,E=()=>B(_e||ve.currentTarget,{fetcherKey:e,method:R,navigate:t,replace:l,state:u,relative:y,preventScrollReset:w,viewTransition:j,unstable_defaultShouldRevalidate:T});F&&t!==!1?v.startTransition(()=>E()):E()};return v.createElement("form",{ref:$,method:K,action:te,onSubmit:i?g:be,...O,"data-discover":!ae&&n==="render"?"true":void 0})});nS.displayName="Form";function rS(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Q2(n){let e=v.useContext(sc);return on(e,rS(n)),e}function aS(n,{target:e,replace:t,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p,unstable_useTransitions:g}={}){let y=$n(),w=_a(),j=Nu(n,{relative:u});return v.useCallback(T=>{if(PE(T,e)){T.preventDefault();let O=t!==void 0?t:fu(w)===fu(j),$=()=>y(n,{replace:O,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p});g?v.startTransition(()=>$()):$()}},[w,y,j,t,i,e,n,l,u,d,p,g])}function iS(n){ra(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=v.useRef(rg(n)),t=v.useRef(!1),i=_a(),l=v.useMemo(()=>LE(i.search,t.current?null:e.current),[i.search]),u=$n(),d=v.useCallback((p,g)=>{const y=rg(typeof p=="function"?p(new URLSearchParams(l)):p);t.current=!0,u("?"+y,g)},[u,l]);return[l,d]}var oS=0,lS=()=>`__${String(++oS)}__`;function cS(){let{router:n}=Q2("useSubmit"),{basename:e}=v.useContext(Wr),t=jE(),i=n.fetch,l=n.navigate;return v.useCallback(async(u,d={})=>{let{action:p,method:g,encType:y,formData:w,body:j}=BE(u,e);if(d.navigate===!1){let T=d.fetcherKey||lS();await i(T,t,d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:w,body:j,formMethod:d.method||g,formEncType:d.encType||y,flushSync:d.flushSync})}else await l(d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:w,body:j,formMethod:d.method||g,formEncType:d.encType||y,replace:d.replace,state:d.state,fromRouteId:t,flushSync:d.flushSync,viewTransition:d.viewTransition})},[i,l,e,t])}function uS(n,{relative:e}={}){let{basename:t}=v.useContext(Wr),i=v.useContext(wa);on(i,"useFormAction must be used inside a RouteContext");let[l]=i.matches.slice(-1),u={...Nu(n||".",{relative:e})},d=_a();if(n==null){u.search=d.search;let p=new URLSearchParams(u.search),g=p.getAll("index");if(g.some(w=>w==="")){p.delete("index"),g.filter(j=>j).forEach(j=>p.append("index",j));let w=p.toString();u.search=w?`?${w}`:""}}return(!n||n===".")&&l.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(u.pathname=u.pathname==="/"?t:ci([t,u.pathname])),fu(u)}function dS(n,{relative:e}={}){let t=v.useContext(B2);on(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=Q2("useViewTransitionState"),l=Nu(n,{relative:e});if(!t.isTransitioning)return!1;let u=mi(t.currentLocation.pathname,i)||t.currentLocation.pathname,d=mi(t.nextLocation.pathname,i)||t.nextLocation.pathname;return Eh(l.pathname,d)!=null||Eh(l.pathname,u)!=null}const hS=()=>{};var V1={};const X2=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let l=n.charCodeAt(i);l<128?e[t++]=l:l<2048?(e[t++]=l>>6|192,e[t++]=l&63|128):(l&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(l=65536+((l&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=l>>18|240,e[t++]=l>>12&63|128,e[t++]=l>>6&63|128,e[t++]=l&63|128):(e[t++]=l>>12|224,e[t++]=l>>6&63|128,e[t++]=l&63|128)}return e},mS=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const l=n[t++];if(l<128)e[i++]=String.fromCharCode(l);else if(l>191&&l<224){const u=n[t++];e[i++]=String.fromCharCode((l&31)<<6|u&63)}else if(l>239&&l<365){const u=n[t++],d=n[t++],p=n[t++],g=((l&7)<<18|(u&63)<<12|(d&63)<<6|p&63)-65536;e[i++]=String.fromCharCode(55296+(g>>10)),e[i++]=String.fromCharCode(56320+(g&1023))}else{const u=n[t++],d=n[t++];e[i++]=String.fromCharCode((l&15)<<12|(u&63)<<6|d&63)}}return e.join("")},J2={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let l=0;l<n.length;l+=3){const u=n[l],d=l+1<n.length,p=d?n[l+1]:0,g=l+2<n.length,y=g?n[l+2]:0,w=u>>2,j=(u&3)<<4|p>>4;let T=(p&15)<<2|y>>6,O=y&63;g||(O=64,d||(T=64)),i.push(t[w],t[j],t[T],t[O])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(X2(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):mS(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let l=0;l<n.length;){const u=t[n.charAt(l++)],p=l<n.length?t[n.charAt(l)]:0;++l;const y=l<n.length?t[n.charAt(l)]:64;++l;const j=l<n.length?t[n.charAt(l)]:64;if(++l,u==null||p==null||y==null||j==null)throw new fS;const T=u<<2|p>>4;if(i.push(T),y!==64){const O=p<<4&240|y>>2;if(i.push(O),j!==64){const $=y<<6&192|j;i.push($)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class fS extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const pS=function(n){const e=X2(n);return J2.encodeByteArray(e,!0)},Sh=function(n){return pS(n).replace(/\./g,"")},Z2=function(n){try{return J2.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function gS(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const yS=()=>gS().__FIREBASE_DEFAULTS__,bS=()=>{if(typeof process>"u"||typeof V1>"u")return;const n=V1.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},vS=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Z2(n[1]);return e&&JSON.parse(e)},Xh=()=>{try{return hS()||yS()||bS()||vS()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},ew=n=>Xh()?.emulatorHosts?.[n],tw=n=>{const e=ew(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},sw=()=>Xh()?.config,nw=n=>Xh()?.[`_${n}`];class xS{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function fo(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function qg(n){return(await fetch(n,{credentials:"include"})).ok}function rw(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",l=n.iat||0,u=n.sub||n.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d={iss:`https://securetoken.google.com/${i}`,aud:i,iat:l,exp:l+3600,auth_time:l,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Sh(JSON.stringify(t)),Sh(JSON.stringify(d)),""].join(".")}const iu={};function wS(){const n={prod:[],emulator:[]};for(const e of Object.keys(iu))iu[e]?n.emulator.push(e):n.prod.push(e);return n}function _S(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let B1=!1;function Hg(n,e){if(typeof window>"u"||typeof document>"u"||!fo(window.location.host)||iu[n]===e||iu[n]||B1)return;iu[n]=e;function t(T){return`__firebase__banner__${T}`}const i="__firebase__banner",u=wS().prod.length>0;function d(){const T=document.getElementById(i);T&&T.remove()}function p(T){T.style.display="flex",T.style.background="#7faaf0",T.style.position="fixed",T.style.bottom="5px",T.style.left="5px",T.style.padding=".5em",T.style.borderRadius="5px",T.style.alignItems="center"}function g(T,O){T.setAttribute("width","24"),T.setAttribute("id",O),T.setAttribute("height","24"),T.setAttribute("viewBox","0 0 24 24"),T.setAttribute("fill","none"),T.style.marginLeft="-6px"}function y(){const T=document.createElement("span");return T.style.cursor="pointer",T.style.marginLeft="16px",T.style.fontSize="24px",T.innerHTML=" &times;",T.onclick=()=>{B1=!0,d()},T}function w(T,O){T.setAttribute("id",O),T.innerText="Learn more",T.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",T.setAttribute("target","__blank"),T.style.paddingLeft="5px",T.style.textDecoration="underline"}function j(){const T=_S(i),O=t("text"),$=document.getElementById(O)||document.createElement("span"),F=t("learnmore"),B=document.getElementById(F)||document.createElement("a"),te=t("preprendIcon"),K=document.getElementById(te)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(T.created){const ae=T.element;p(ae),w(B,F);const be=y();g(K,te),ae.append(K,$,B,be),document.body.appendChild(ae)}u?($.innerText="Preview backend disconnected.",K.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(K.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,$.innerText="Preview backend running in this workspace."),$.setAttribute("id",O)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",j):j()}function cr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function kS(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(cr())}function jS(){const n=Xh()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function TS(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function ES(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function SS(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function NS(){const n=cr();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function CS(){return!jS()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function RS(){try{return typeof indexedDB=="object"}catch{return!1}}function AS(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",l=self.indexedDB.open(i);l.onsuccess=()=>{l.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},l.onupgradeneeded=()=>{t=!1},l.onerror=()=>{e(l.error?.message||"")}}catch(t){e(t)}})}const IS="FirebaseError";class qa extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=IS,Object.setPrototypeOf(this,qa.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Cu.prototype.create)}}class Cu{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},l=`${this.service}/${e}`,u=this.errors[e],d=u?MS(u,i):"Error",p=`${this.serviceName}: ${d} (${l}).`;return new qa(l,p,i)}}function MS(n,e){return n.replace(DS,(t,i)=>{const l=e[i];return l!=null?String(l):`<${i}?>`})}const DS=/\{\$([^}]+)}/g;function PS(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Ho(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const l of t){if(!i.includes(l))return!1;const u=n[l],d=e[l];if(U1(u)&&U1(d)){if(!Ho(u,d))return!1}else if(u!==d)return!1}for(const l of i)if(!t.includes(l))return!1;return!0}function U1(n){return n!==null&&typeof n=="object"}function Ru(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(l=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(l))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function eu(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[l,u]=i.split("=");e[decodeURIComponent(l)]=decodeURIComponent(u)}}),e}function tu(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function LS(n,e){const t=new OS(n,e);return t.subscribe.bind(t)}class OS{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let l;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");VS(e,["next","error","complete"])?l=e:l={next:e,error:t,complete:i},l.next===void 0&&(l.next=Tp),l.error===void 0&&(l.error=Tp),l.complete===void 0&&(l.complete=Tp);const u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?l.error(this.finalError):l.complete()}catch{}}),this.observers.push(l),u}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function VS(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Tp(){}function Gs(n){return n&&n._delegate?n._delegate:n}class io{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Oo="[DEFAULT]";class BS{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new xS;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const l=this.getOrInitializeService({instanceIdentifier:t});l&&i.resolve(l)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(l){if(i)return null;throw l}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(FS(e))try{this.getOrInitializeService({instanceIdentifier:Oo})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(t);try{const u=this.getOrInitializeService({instanceIdentifier:l});i.resolve(u)}catch{}}}}clearInstance(e=Oo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Oo){return this.instances.has(e)}getOptions(e=Oo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const l=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[u,d]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(u);i===p&&d.resolve(l)}return l}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),l=this.onInitCallbacks.get(i)??new Set;l.add(e),this.onInitCallbacks.set(i,l);const u=this.instances.get(i);return u&&e(u,i),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const l of i)try{l(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:US(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Oo){return this.component?this.component.multipleInstances?e:Oo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function US(n){return n===Oo?void 0:n}function FS(n){return n.instantiationMode==="EAGER"}class zS{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new BS(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var ps;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(ps||(ps={}));const qS={debug:ps.DEBUG,verbose:ps.VERBOSE,info:ps.INFO,warn:ps.WARN,error:ps.ERROR,silent:ps.SILENT},HS=ps.INFO,$S={[ps.DEBUG]:"log",[ps.VERBOSE]:"log",[ps.INFO]:"info",[ps.WARN]:"warn",[ps.ERROR]:"error"},WS=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),l=$S[e];if(l)console[l](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class $g{constructor(e){this.name=e,this._logLevel=HS,this._logHandler=WS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ps))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?qS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ps.DEBUG,...e),this._logHandler(this,ps.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ps.VERBOSE,...e),this._logHandler(this,ps.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ps.INFO,...e),this._logHandler(this,ps.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ps.WARN,...e),this._logHandler(this,ps.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ps.ERROR,...e),this._logHandler(this,ps.ERROR,...e)}}const GS=(n,e)=>e.some(t=>n instanceof t);let F1,z1;function KS(){return F1||(F1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function YS(){return z1||(z1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const aw=new WeakMap,ag=new WeakMap,iw=new WeakMap,Ep=new WeakMap,Wg=new WeakMap;function QS(n){const e=new Promise((t,i)=>{const l=()=>{n.removeEventListener("success",u),n.removeEventListener("error",d)},u=()=>{t(so(n.result)),l()},d=()=>{i(n.error),l()};n.addEventListener("success",u),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&aw.set(t,n)}).catch(()=>{}),Wg.set(e,n),e}function XS(n){if(ag.has(n))return;const e=new Promise((t,i)=>{const l=()=>{n.removeEventListener("complete",u),n.removeEventListener("error",d),n.removeEventListener("abort",d)},u=()=>{t(),l()},d=()=>{i(n.error||new DOMException("AbortError","AbortError")),l()};n.addEventListener("complete",u),n.addEventListener("error",d),n.addEventListener("abort",d)});ag.set(n,e)}let ig={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return ag.get(n);if(e==="objectStoreNames")return n.objectStoreNames||iw.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return so(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function JS(n){ig=n(ig)}function ZS(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Sp(this),e,...t);return iw.set(i,e.sort?e.sort():[e]),so(i)}:YS().includes(n)?function(...e){return n.apply(Sp(this),e),so(aw.get(this))}:function(...e){return so(n.apply(Sp(this),e))}}function eN(n){return typeof n=="function"?ZS(n):(n instanceof IDBTransaction&&XS(n),GS(n,KS())?new Proxy(n,ig):n)}function so(n){if(n instanceof IDBRequest)return QS(n);if(Ep.has(n))return Ep.get(n);const e=eN(n);return e!==n&&(Ep.set(n,e),Wg.set(e,n)),e}const Sp=n=>Wg.get(n);function tN(n,e,{blocked:t,upgrade:i,blocking:l,terminated:u}={}){const d=indexedDB.open(n,e),p=so(d);return i&&d.addEventListener("upgradeneeded",g=>{i(so(d.result),g.oldVersion,g.newVersion,so(d.transaction),g)}),t&&d.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),p.then(g=>{u&&g.addEventListener("close",()=>u()),l&&g.addEventListener("versionchange",y=>l(y.oldVersion,y.newVersion,y))}).catch(()=>{}),p}const sN=["get","getKey","getAll","getAllKeys","count"],nN=["put","add","delete","clear"],Np=new Map;function q1(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Np.get(e))return Np.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,l=nN.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(l||sN.includes(t)))return;const u=async function(d,...p){const g=this.transaction(d,l?"readwrite":"readonly");let y=g.store;return i&&(y=y.index(p.shift())),(await Promise.all([y[t](...p),l&&g.done]))[0]};return Np.set(e,u),u}JS(n=>({...n,get:(e,t,i)=>q1(e,t)||n.get(e,t,i),has:(e,t)=>!!q1(e,t)||n.has(e,t)}));class rN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(aN(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function aN(n){return n.getComponent()?.type==="VERSION"}const og="@firebase/app",H1="0.14.7";const fi=new $g("@firebase/app"),iN="@firebase/app-compat",oN="@firebase/analytics-compat",lN="@firebase/analytics",cN="@firebase/app-check-compat",uN="@firebase/app-check",dN="@firebase/auth",hN="@firebase/auth-compat",mN="@firebase/database",fN="@firebase/data-connect",pN="@firebase/database-compat",gN="@firebase/functions",yN="@firebase/functions-compat",bN="@firebase/installations",vN="@firebase/installations-compat",xN="@firebase/messaging",wN="@firebase/messaging-compat",_N="@firebase/performance",kN="@firebase/performance-compat",jN="@firebase/remote-config",TN="@firebase/remote-config-compat",EN="@firebase/storage",SN="@firebase/storage-compat",NN="@firebase/firestore",CN="@firebase/ai",RN="@firebase/firestore-compat",AN="firebase",IN="12.8.0";const lg="[DEFAULT]",MN={[og]:"fire-core",[iN]:"fire-core-compat",[lN]:"fire-analytics",[oN]:"fire-analytics-compat",[uN]:"fire-app-check",[cN]:"fire-app-check-compat",[dN]:"fire-auth",[hN]:"fire-auth-compat",[mN]:"fire-rtdb",[fN]:"fire-data-connect",[pN]:"fire-rtdb-compat",[gN]:"fire-fn",[yN]:"fire-fn-compat",[bN]:"fire-iid",[vN]:"fire-iid-compat",[xN]:"fire-fcm",[wN]:"fire-fcm-compat",[_N]:"fire-perf",[kN]:"fire-perf-compat",[jN]:"fire-rc",[TN]:"fire-rc-compat",[EN]:"fire-gcs",[SN]:"fire-gcs-compat",[NN]:"fire-fst",[RN]:"fire-fst-compat",[CN]:"fire-vertex","fire-js":"fire-js",[AN]:"fire-js-all"};const Nh=new Map,DN=new Map,cg=new Map;function $1(n,e){try{n.container.addComponent(e)}catch(t){fi.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function $o(n){const e=n.name;if(cg.has(e))return fi.debug(`There were multiple attempts to register component ${e}.`),!1;cg.set(e,n);for(const t of Nh.values())$1(t,n);for(const t of DN.values())$1(t,n);return!0}function Jh(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function qr(n){return n==null?!1:n.settings!==void 0}const PN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},no=new Cu("app","Firebase",PN);class LN{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new io("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw no.create("app-deleted",{appName:this._name})}}const Jo=IN;function Gg(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:lg,automaticDataCollectionEnabled:!0,...e},l=i.name;if(typeof l!="string"||!l)throw no.create("bad-app-name",{appName:String(l)});if(t||(t=sw()),!t)throw no.create("no-options");const u=Nh.get(l);if(u){if(Ho(t,u.options)&&Ho(i,u.config))return u;throw no.create("duplicate-app",{appName:l})}const d=new zS(l);for(const g of cg.values())d.addComponent(g);const p=new LN(t,i,d);return Nh.set(l,p),p}function Kg(n=lg){const e=Nh.get(n);if(!e&&n===lg&&sw())return Gg();if(!e)throw no.create("no-app",{appName:n});return e}function Pa(n,e,t){let i=MN[n]??n;t&&(i+=`-${t}`);const l=i.match(/\s|\//),u=e.match(/\s|\//);if(l||u){const d=[`Unable to register library "${i}" with version "${e}":`];l&&d.push(`library name "${i}" contains illegal characters (whitespace or "/")`),l&&u&&d.push("and"),u&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),fi.warn(d.join(" "));return}$o(new io(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const ON="firebase-heartbeat-database",VN=1,pu="firebase-heartbeat-store";let Cp=null;function ow(){return Cp||(Cp=tN(ON,VN,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(pu)}catch(t){console.warn(t)}}}}).catch(n=>{throw no.create("idb-open",{originalErrorMessage:n.message})})),Cp}async function BN(n){try{const t=(await ow()).transaction(pu),i=await t.objectStore(pu).get(lw(n));return await t.done,i}catch(e){if(e instanceof qa)fi.warn(e.message);else{const t=no.create("idb-get",{originalErrorMessage:e?.message});fi.warn(t.message)}}}async function W1(n,e){try{const i=(await ow()).transaction(pu,"readwrite");await i.objectStore(pu).put(e,lw(n)),await i.done}catch(t){if(t instanceof qa)fi.warn(t.message);else{const i=no.create("idb-set",{originalErrorMessage:t?.message});fi.warn(i.message)}}}function lw(n){return`${n.name}!${n.options.appId}`}const UN=1024,FN=30;class zN{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new HN(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=G1();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(l=>l.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>FN){const l=$N(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){fi.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=G1(),{heartbeatsToSend:t,unsentEntries:i}=qN(this._heartbeatsCache.heartbeats),l=Sh(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(e){return fi.warn(e),""}}}function G1(){return new Date().toISOString().substring(0,10)}function qN(n,e=UN){const t=[];let i=n.slice();for(const l of n){const u=t.find(d=>d.agent===l.agent);if(u){if(u.dates.push(l.date),K1(t)>e){u.dates.pop();break}}else if(t.push({agent:l.agent,dates:[l.date]}),K1(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class HN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return RS()?AS().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await BN(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return W1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return W1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function K1(n){return Sh(JSON.stringify({version:2,heartbeats:n})).length}function $N(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function WN(n){$o(new io("platform-logger",e=>new rN(e),"PRIVATE")),$o(new io("heartbeat",e=>new zN(e),"PRIVATE")),Pa(og,H1,n),Pa(og,H1,"esm2020"),Pa("fire-js","")}WN("");function cw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const GN=cw,uw=new Cu("auth","Firebase",cw());const Ch=new $g("@firebase/auth");function KN(n,...e){Ch.logLevel<=ps.WARN&&Ch.warn(`Auth (${Jo}): ${n}`,...e)}function gh(n,...e){Ch.logLevel<=ps.ERROR&&Ch.error(`Auth (${Jo}): ${n}`,...e)}function ba(n,...e){throw Yg(n,...e)}function La(n,...e){return Yg(n,...e)}function dw(n,e,t){const i={...GN(),[e]:t};return new Cu("auth","Firebase",i).create(e,{appName:n.name})}function ui(n){return dw(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Yg(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return uw.create(n,...e)}function Pt(n,e,...t){if(!n)throw Yg(e,...t)}function oi(n){const e="INTERNAL ASSERTION FAILED: "+n;throw gh(e),new Error(e)}function pi(n,e){n||oi(e)}function ug(){return typeof self<"u"&&self.location?.href||""}function YN(){return Y1()==="http:"||Y1()==="https:"}function Y1(){return typeof self<"u"&&self.location?.protocol||null}function QN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(YN()||ES()||"connection"in navigator)?navigator.onLine:!0}function XN(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Au{constructor(e,t){this.shortDelay=e,this.longDelay=t,pi(t>e,"Short delay should be less than long delay!"),this.isMobile=kS()||SS()}get(){return QN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Qg(n,e){pi(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class hw{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;oi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;oi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;oi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const JN={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const ZN=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],eC=new Au(3e4,6e4);function bi(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function vi(n,e,t,i,l={}){return mw(n,l,async()=>{let u={},d={};i&&(e==="GET"?d=i:u={body:JSON.stringify(i)});const p=Ru({key:n.config.apiKey,...d}).slice(1),g=await n._getAdditionalHeaders();g["Content-Type"]="application/json",n.languageCode&&(g["X-Firebase-Locale"]=n.languageCode);const y={method:e,headers:g,...u};return TS()||(y.referrerPolicy="no-referrer"),n.emulatorConfig&&fo(n.emulatorConfig.host)&&(y.credentials="include"),hw.fetch()(await fw(n,n.config.apiHost,t,p),y)})}async function mw(n,e,t){n._canInitEmulator=!1;const i={...JN,...e};try{const l=new sC(n),u=await Promise.race([t(),l.promise]);l.clearNetworkTimeout();const d=await u.json();if("needConfirmation"in d)throw eh(n,"account-exists-with-different-credential",d);if(u.ok&&!("errorMessage"in d))return d;{const p=u.ok?d.errorMessage:d.error.message,[g,y]=p.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw eh(n,"credential-already-in-use",d);if(g==="EMAIL_EXISTS")throw eh(n,"email-already-in-use",d);if(g==="USER_DISABLED")throw eh(n,"user-disabled",d);const w=i[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw dw(n,w,y);ba(n,w)}}catch(l){if(l instanceof qa)throw l;ba(n,"network-request-failed",{message:String(l)})}}async function Iu(n,e,t,i,l={}){const u=await vi(n,e,t,i,l);return"mfaPendingCredential"in u&&ba(n,"multi-factor-auth-required",{_serverResponse:u}),u}async function fw(n,e,t,i){const l=`${e}${t}?${i}`,u=n,d=u.config.emulator?Qg(n.config,l):`${n.config.apiScheme}://${l}`;return ZN.includes(t)&&(await u._persistenceManagerAvailable,u._getPersistenceType()==="COOKIE")?u._getPersistence()._getFinalTarget(d).toString():d}function tC(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class sC{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(La(this.auth,"network-request-failed")),eC.get())})}}function eh(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const l=La(n,e,i);return l.customData._tokenResponse=t,l}function Q1(n){return n!==void 0&&n.enterprise!==void 0}class nC{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return tC(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function rC(n,e){return vi(n,"GET","/v2/recaptchaConfig",bi(n,e))}async function aC(n,e){return vi(n,"POST","/v1/accounts:delete",e)}async function Rh(n,e){return vi(n,"POST","/v1/accounts:lookup",e)}function ou(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function iC(n,e=!1){const t=Gs(n),i=await t.getIdToken(e),l=Xg(i);Pt(l&&l.exp&&l.auth_time&&l.iat,t.auth,"internal-error");const u=typeof l.firebase=="object"?l.firebase:void 0,d=u?.sign_in_provider;return{claims:l,token:i,authTime:ou(Rp(l.auth_time)),issuedAtTime:ou(Rp(l.iat)),expirationTime:ou(Rp(l.exp)),signInProvider:d||null,signInSecondFactor:u?.sign_in_second_factor||null}}function Rp(n){return Number(n)*1e3}function Xg(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return gh("JWT malformed, contained fewer than 3 sections"),null;try{const l=Z2(t);return l?JSON.parse(l):(gh("Failed to decode base64 JWT payload"),null)}catch(l){return gh("Caught error parsing JWT payload as JSON",l?.toString()),null}}function X1(n){const e=Xg(n);return Pt(e,"internal-error"),Pt(typeof e.exp<"u","internal-error"),Pt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function gu(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof qa&&oC(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function oC({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class lC{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class dg{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ou(this.lastLoginAt),this.creationTime=ou(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Ah(n){const e=n.auth,t=await n.getIdToken(),i=await gu(n,Rh(e,{idToken:t}));Pt(i?.users.length,e,"internal-error");const l=i.users[0];n._notifyReloadListener(l);const u=l.providerUserInfo?.length?pw(l.providerUserInfo):[],d=uC(n.providerData,u),p=n.isAnonymous,g=!(n.email&&l.passwordHash)&&!d?.length,y=p?g:!1,w={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:d,metadata:new dg(l.createdAt,l.lastLoginAt),isAnonymous:y};Object.assign(n,w)}async function cC(n){const e=Gs(n);await Ah(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function uC(n,e){return[...n.filter(i=>!e.some(l=>l.providerId===i.providerId)),...e]}function pw(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function dC(n,e){const t=await mw(n,{},async()=>{const i=Ru({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:l,apiKey:u}=n.config,d=await fw(n,l,"/v1/token",`key=${u}`),p=await n._getAdditionalHeaders();p["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:p,body:i};return n.emulatorConfig&&fo(n.emulatorConfig.host)&&(g.credentials="include"),hw.fetch()(d,g)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function hC(n,e){return vi(n,"POST","/v2/accounts:revokeToken",bi(n,e))}class Hl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Pt(e.idToken,"internal-error"),Pt(typeof e.idToken<"u","internal-error"),Pt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):X1(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Pt(e.length!==0,"internal-error");const t=X1(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Pt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:l,expiresIn:u}=await dC(e,t);this.updateTokensAndExpiration(i,l,Number(u))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:l,expirationTime:u}=t,d=new Hl;return i&&(Pt(typeof i=="string","internal-error",{appName:e}),d.refreshToken=i),l&&(Pt(typeof l=="string","internal-error",{appName:e}),d.accessToken=l),u&&(Pt(typeof u=="number","internal-error",{appName:e}),d.expirationTime=u),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Hl,this.toJSON())}_performRefresh(){return oi("not implemented")}}function $i(n,e){Pt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class ga{constructor({uid:e,auth:t,stsTokenManager:i,...l}){this.providerId="firebase",this.proactiveRefresh=new lC(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new dg(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await gu(this,this.stsTokenManager.getToken(this.auth,e));return Pt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return iC(this,e)}reload(){return cC(this)}_assign(e){this!==e&&(Pt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ga({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Pt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Ah(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(qr(this.auth.app))return Promise.reject(ui(this.auth));const e=await this.getIdToken();return await gu(this,aC(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,l=t.email??void 0,u=t.phoneNumber??void 0,d=t.photoURL??void 0,p=t.tenantId??void 0,g=t._redirectEventId??void 0,y=t.createdAt??void 0,w=t.lastLoginAt??void 0,{uid:j,emailVerified:T,isAnonymous:O,providerData:$,stsTokenManager:F}=t;Pt(j&&F,e,"internal-error");const B=Hl.fromJSON(this.name,F);Pt(typeof j=="string",e,"internal-error"),$i(i,e.name),$i(l,e.name),Pt(typeof T=="boolean",e,"internal-error"),Pt(typeof O=="boolean",e,"internal-error"),$i(u,e.name),$i(d,e.name),$i(p,e.name),$i(g,e.name),$i(y,e.name),$i(w,e.name);const te=new ga({uid:j,auth:e,email:l,emailVerified:T,displayName:i,isAnonymous:O,photoURL:d,phoneNumber:u,tenantId:p,stsTokenManager:B,createdAt:y,lastLoginAt:w});return $&&Array.isArray($)&&(te.providerData=$.map(K=>({...K}))),g&&(te._redirectEventId=g),te}static async _fromIdTokenResponse(e,t,i=!1){const l=new Hl;l.updateFromServerResponse(t);const u=new ga({uid:t.localId,auth:e,stsTokenManager:l,isAnonymous:i});return await Ah(u),u}static async _fromGetAccountInfoResponse(e,t,i){const l=t.users[0];Pt(l.localId!==void 0,"internal-error");const u=l.providerUserInfo!==void 0?pw(l.providerUserInfo):[],d=!(l.email&&l.passwordHash)&&!u?.length,p=new Hl;p.updateFromIdToken(i);const g=new ga({uid:l.localId,auth:e,stsTokenManager:p,isAnonymous:d}),y={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:u,metadata:new dg(l.createdAt,l.lastLoginAt),isAnonymous:!(l.email&&l.passwordHash)&&!u?.length};return Object.assign(g,y),g}}const J1=new Map;function li(n){pi(n instanceof Function,"Expected a class definition");let e=J1.get(n);return e?(pi(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,J1.set(n,e),e)}class gw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}gw.type="NONE";const Z1=gw;function yh(n,e,t){return`firebase:${n}:${e}:${t}`}class $l{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:l,name:u}=this.auth;this.fullUserKey=yh(this.userKey,l.apiKey,u),this.fullPersistenceKey=yh("persistence",l.apiKey,u),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Rh(this.auth,{idToken:e}).catch(()=>{});return t?ga._fromGetAccountInfoResponse(this.auth,t,e):null}return ga._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new $l(li(Z1),e,i);const l=(await Promise.all(t.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let u=l[0]||li(Z1);const d=yh(i,e.config.apiKey,e.name);let p=null;for(const y of t)try{const w=await y._get(d);if(w){let j;if(typeof w=="string"){const T=await Rh(e,{idToken:w}).catch(()=>{});if(!T)break;j=await ga._fromGetAccountInfoResponse(e,T,w)}else j=ga._fromJSON(e,w);y!==u&&(p=j),u=y;break}}catch{}const g=l.filter(y=>y._shouldAllowMigration);return!u._shouldAllowMigration||!g.length?new $l(u,e,i):(u=g[0],p&&await u._set(d,p.toJSON()),await Promise.all(t.map(async y=>{if(y!==u)try{await y._remove(d)}catch{}})),new $l(u,e,i))}}function ex(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(xw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(yw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(_w(e))return"Blackberry";if(kw(e))return"Webos";if(bw(e))return"Safari";if((e.includes("chrome/")||vw(e))&&!e.includes("edge/"))return"Chrome";if(ww(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function yw(n=cr()){return/firefox\//i.test(n)}function bw(n=cr()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function vw(n=cr()){return/crios\//i.test(n)}function xw(n=cr()){return/iemobile/i.test(n)}function ww(n=cr()){return/android/i.test(n)}function _w(n=cr()){return/blackberry/i.test(n)}function kw(n=cr()){return/webos/i.test(n)}function Jg(n=cr()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function mC(n=cr()){return Jg(n)&&!!window.navigator?.standalone}function fC(){return NS()&&document.documentMode===10}function jw(n=cr()){return Jg(n)||ww(n)||kw(n)||_w(n)||/windows phone/i.test(n)||xw(n)}function Tw(n,e=[]){let t;switch(n){case"Browser":t=ex(cr());break;case"Worker":t=`${ex(cr())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Jo}/${i}`}class pC{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=u=>new Promise((d,p)=>{try{const g=e(u);d(g)}catch(g){p(g)}});i.onAbort=t,this.queue.push(i);const l=this.queue.length-1;return()=>{this.queue[l]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const l of t)try{l()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function gC(n,e={}){return vi(n,"GET","/v2/passwordPolicy",bi(n,e))}const yC=6;class bC{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??yC,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,l=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),l&&(t.meetsMaxPasswordLength=e.length<=l)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let l=0;l<e.length;l++)i=e.charAt(l),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,l,u){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=l)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=u))}}class vC{constructor(e,t,i,l){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=l,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new tx(this),this.idTokenSubscription=new tx(this),this.beforeStateQueue=new pC(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=uw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=l.sdkClientVersion,this._persistenceManagerAvailable=new Promise(u=>this._resolvePersistenceManagerAvailable=u)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=li(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await $l.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Rh(this,{idToken:e}),i=await ga._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(qr(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=this.redirectUser?._redirectEventId,d=i?._redirectEventId,p=await this.tryRedirectSignIn(e);(!u||u===d)&&p?.user&&(i=p.user,l=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Pt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Ah(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=XN()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(qr(this.app))return Promise.reject(ui(this));const t=e?Gs(e):null;return t&&Pt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Pt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return qr(this.app)?Promise.reject(ui(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return qr(this.app)?Promise.reject(ui(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(li(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await gC(this),t=new bC(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Cu("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await hC(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&li(e)||this._popupRedirectResolver;Pt(t,this,"argument-error"),this.redirectPersistenceManager=await $l.create(this,[li(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,l){if(this._deleted)return()=>{};const u=typeof t=="function"?t:t.next.bind(t);let d=!1;const p=this._isInitialized?Promise.resolve():this._initializationPromise;if(Pt(p,this,"internal-error"),p.then(()=>{d||u(this.currentUser)}),typeof t=="function"){const g=e.addObserver(t,i,l);return()=>{d=!0,g()}}else{const g=e.addObserver(t);return()=>{d=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Pt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Tw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(qr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&KN(`Error while retrieving App Check token: ${e.error}`),e?.token}}function po(n){return Gs(n)}class tx{constructor(e){this.auth=e,this.observer=null,this.addObserver=LS(t=>this.observer=t)}get next(){return Pt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Zh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function xC(n){Zh=n}function Ew(n){return Zh.loadJS(n)}function wC(){return Zh.recaptchaEnterpriseScript}function _C(){return Zh.gapiScript}function kC(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class jC{constructor(){this.enterprise=new TC}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class TC{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const EC="recaptcha-enterprise",Sw="NO_RECAPTCHA";class SC{constructor(e){this.type=EC,this.auth=po(e)}async verify(e="verify",t=!1){async function i(u){if(!t){if(u.tenantId==null&&u._agentRecaptchaConfig!=null)return u._agentRecaptchaConfig.siteKey;if(u.tenantId!=null&&u._tenantRecaptchaConfigs[u.tenantId]!==void 0)return u._tenantRecaptchaConfigs[u.tenantId].siteKey}return new Promise(async(d,p)=>{rC(u,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)p(new Error("recaptcha Enterprise site key undefined"));else{const y=new nC(g);return u.tenantId==null?u._agentRecaptchaConfig=y:u._tenantRecaptchaConfigs[u.tenantId]=y,d(y.siteKey)}}).catch(g=>{p(g)})})}function l(u,d,p){const g=window.grecaptcha;Q1(g)?g.enterprise.ready(()=>{g.enterprise.execute(u,{action:e}).then(y=>{d(y)}).catch(()=>{d(Sw)})}):p(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new jC().execute("siteKey",{action:"verify"}):new Promise((u,d)=>{i(this.auth).then(p=>{if(!t&&Q1(window.grecaptcha))l(p,u,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let g=wC();g.length!==0&&(g+=p),Ew(g).then(()=>{l(p,u,d)}).catch(y=>{d(y)})}}).catch(p=>{d(p)})})}}async function sx(n,e,t,i=!1,l=!1){const u=new SC(n);let d;if(l)d=Sw;else try{d=await u.verify(t)}catch{d=await u.verify(t,!0)}const p={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in p){const g=p.phoneEnrollmentInfo.phoneNumber,y=p.phoneEnrollmentInfo.recaptchaToken;Object.assign(p,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:y,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in p){const g=p.phoneSignInInfo.recaptchaToken;Object.assign(p,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return p}return i?Object.assign(p,{captchaResp:d}):Object.assign(p,{captchaResponse:d}),Object.assign(p,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(p,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),p}async function Ih(n,e,t,i,l){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await sx(n,e,t,t==="getOobCode");return i(n,u)}else return i(n,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await sx(n,e,t,t==="getOobCode");return i(n,d)}else return Promise.reject(u)})}function NC(n,e){const t=Jh(n,"auth");if(t.isInitialized()){const l=t.getImmediate(),u=t.getOptions();if(Ho(u,e??{}))return l;ba(l,"already-initialized")}return t.initialize({options:e})}function CC(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(li);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function RC(n,e,t){const i=po(n);Pt(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const l=!1,u=Nw(e),{host:d,port:p}=AC(e),g=p===null?"":`:${p}`,y={url:`${u}//${d}${g}/`},w=Object.freeze({host:d,port:p,protocol:u.replace(":",""),options:Object.freeze({disableWarnings:l})});if(!i._canInitEmulator){Pt(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Pt(Ho(y,i.config.emulator)&&Ho(w,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=y,i.emulatorConfig=w,i.settings.appVerificationDisabledForTesting=!0,fo(d)?(qg(`${u}//${d}${g}`),Hg("Auth",!0)):IC()}function Nw(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function AC(n){const e=Nw(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",l=/^(\[[^\]]+\])(:|$)/.exec(i);if(l){const u=l[1];return{host:u,port:nx(i.substr(u.length+1))}}else{const[u,d]=i.split(":");return{host:u,port:nx(d)}}}function nx(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function IC(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Zg{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return oi("not implemented")}_getIdTokenResponse(e){return oi("not implemented")}_linkToIdToken(e,t){return oi("not implemented")}_getReauthenticationResolver(e){return oi("not implemented")}}async function MC(n,e){return vi(n,"POST","/v1/accounts:signUp",e)}async function DC(n,e){return Iu(n,"POST","/v1/accounts:signInWithPassword",bi(n,e))}async function Cw(n,e){return vi(n,"POST","/v1/accounts:sendOobCode",bi(n,e))}async function PC(n,e){return Cw(n,e)}async function LC(n,e){return Cw(n,e)}async function OC(n,e){return Iu(n,"POST","/v1/accounts:signInWithEmailLink",bi(n,e))}async function VC(n,e){return Iu(n,"POST","/v1/accounts:signInWithEmailLink",bi(n,e))}class yu extends Zg{constructor(e,t,i,l=null){super("password",i),this._email=e,this._password=t,this._tenantId=l}static _fromEmailAndPassword(e,t){return new yu(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new yu(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ih(e,t,"signInWithPassword",DC);case"emailLink":return OC(e,{email:this._email,oobCode:this._password});default:ba(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ih(e,i,"signUpPassword",MC);case"emailLink":return VC(e,{idToken:t,email:this._email,oobCode:this._password});default:ba(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Wl(n,e){return Iu(n,"POST","/v1/accounts:signInWithIdp",bi(n,e))}const BC="http://localhost";class Wo extends Zg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Wo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ba("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:l,...u}=t;if(!i||!l)return null;const d=new Wo(i,l);return d.idToken=u.idToken||void 0,d.accessToken=u.accessToken||void 0,d.secret=u.secret,d.nonce=u.nonce,d.pendingToken=u.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Wl(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Wl(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Wl(e,t)}buildRequest(){const e={requestUri:BC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Ru(t)}return e}}function UC(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function FC(n){const e=eu(tu(n)).link,t=e?eu(tu(e)).deep_link_id:null,i=eu(tu(n)).deep_link_id;return(i?eu(tu(i)).link:null)||i||t||e||n}class ey{constructor(e){const t=eu(tu(e)),i=t.apiKey??null,l=t.oobCode??null,u=UC(t.mode??null);Pt(i&&l&&u,"argument-error"),this.apiKey=i,this.operation=u,this.code=l,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=FC(e);try{return new ey(t)}catch{return null}}}class rc{constructor(){this.providerId=rc.PROVIDER_ID}static credential(e,t){return yu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=ey.parseLink(t);return Pt(i,"argument-error"),yu._fromEmailAndCode(e,i.code,i.tenantId)}}rc.PROVIDER_ID="password";rc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";rc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Rw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Mu extends Rw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ki extends Mu{constructor(){super("facebook.com")}static credential(e){return Wo._fromParams({providerId:Ki.PROVIDER_ID,signInMethod:Ki.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ki.credentialFromTaggedObject(e)}static credentialFromError(e){return Ki.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ki.credential(e.oauthAccessToken)}catch{return null}}}Ki.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ki.PROVIDER_ID="facebook.com";class Yi extends Mu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Wo._fromParams({providerId:Yi.PROVIDER_ID,signInMethod:Yi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Yi.credentialFromTaggedObject(e)}static credentialFromError(e){return Yi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Yi.credential(t,i)}catch{return null}}}Yi.GOOGLE_SIGN_IN_METHOD="google.com";Yi.PROVIDER_ID="google.com";class Qi extends Mu{constructor(){super("github.com")}static credential(e){return Wo._fromParams({providerId:Qi.PROVIDER_ID,signInMethod:Qi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Qi.credentialFromTaggedObject(e)}static credentialFromError(e){return Qi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Qi.credential(e.oauthAccessToken)}catch{return null}}}Qi.GITHUB_SIGN_IN_METHOD="github.com";Qi.PROVIDER_ID="github.com";class Xi extends Mu{constructor(){super("twitter.com")}static credential(e,t){return Wo._fromParams({providerId:Xi.PROVIDER_ID,signInMethod:Xi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Xi.credentialFromTaggedObject(e)}static credentialFromError(e){return Xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Xi.credential(t,i)}catch{return null}}}Xi.TWITTER_SIGN_IN_METHOD="twitter.com";Xi.PROVIDER_ID="twitter.com";async function zC(n,e){return Iu(n,"POST","/v1/accounts:signUp",bi(n,e))}class Go{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,l=!1){const u=await ga._fromIdTokenResponse(e,i,l),d=rx(i);return new Go({user:u,providerId:d,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const l=rx(i);return new Go({user:e,providerId:l,_tokenResponse:i,operationType:t})}}function rx(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Mh extends qa{constructor(e,t,i,l){super(t.code,t.message),this.operationType=i,this.user=l,Object.setPrototypeOf(this,Mh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,l){return new Mh(e,t,i,l)}}function Aw(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(u=>{throw u.code==="auth/multi-factor-auth-required"?Mh._fromErrorAndOperation(n,u,e,i):u})}async function qC(n,e,t=!1){const i=await gu(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Go._forOperation(n,"link",i)}async function HC(n,e,t=!1){const{auth:i}=n;if(qr(i.app))return Promise.reject(ui(i));const l="reauthenticate";try{const u=await gu(n,Aw(i,l,e,n),t);Pt(u.idToken,i,"internal-error");const d=Xg(u.idToken);Pt(d,i,"internal-error");const{sub:p}=d;return Pt(n.uid===p,i,"user-mismatch"),Go._forOperation(n,l,u)}catch(u){throw u?.code==="auth/user-not-found"&&ba(i,"user-mismatch"),u}}async function Iw(n,e,t=!1){if(qr(n.app))return Promise.reject(ui(n));const i="signIn",l=await Aw(n,i,e),u=await Go._fromIdTokenResponse(n,i,l);return t||await n._updateCurrentUser(u.user),u}async function $C(n,e){return Iw(po(n),e)}async function Mw(n){const e=po(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function WC(n,e,t){const i=po(n);await Ih(i,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",LC)}async function GC(n,e,t){if(qr(n.app))return Promise.reject(ui(n));const i=po(n),d=await Ih(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",zC).catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&Mw(n),g}),p=await Go._fromIdTokenResponse(i,"signIn",d);return await i._updateCurrentUser(p.user),p}function KC(n,e,t){return qr(n.app)?Promise.reject(ui(n)):$C(Gs(n),rc.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&Mw(n),i})}async function PP(n,e){const t=Gs(n),l={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()},{email:u}=await PC(t.auth,l);u!==n.email&&await n.reload()}function ax(n,e){return Gs(n).setPersistence(e)}function YC(n,e,t,i){return Gs(n).onIdTokenChanged(e,t,i)}function QC(n,e,t){return Gs(n).beforeAuthStateChanged(e,t)}function XC(n,e,t,i){return Gs(n).onAuthStateChanged(e,t,i)}function JC(n){return Gs(n).signOut()}const Dh="__sak";class Dw{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Dh,"1"),this.storage.removeItem(Dh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const ZC=1e3,e4=10;class Pw extends Dw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=jw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),l=this.localCache[t];i!==l&&e(t,l,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,p,g)=>{this.notifyListeners(d,g)});return}const i=e.key;t?this.detachListener():this.stopPolling();const l=()=>{const d=this.storage.getItem(i);!t&&this.localCache[i]===d||this.notifyListeners(i,d)},u=this.storage.getItem(i);fC()&&u!==e.newValue&&e.newValue!==e.oldValue?setTimeout(l,e4):l()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},ZC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Pw.type="LOCAL";const hg=Pw;class Lw extends Dw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Lw.type="SESSION";const ty=Lw;function t4(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class em{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(l=>l.isListeningto(e));if(t)return t;const i=new em(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:l,data:u}=t.data,d=this.handlersMap[l];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:l});const p=Array.from(d).map(async y=>y(t.origin,u)),g=await t4(p);t.ports[0].postMessage({status:"done",eventId:i,eventType:l,response:g})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}em.receivers=[];function sy(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class s4{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const l=typeof MessageChannel<"u"?new MessageChannel:null;if(!l)throw new Error("connection_unavailable");let u,d;return new Promise((p,g)=>{const y=sy("",20);l.port1.start();const w=setTimeout(()=>{g(new Error("unsupported_event"))},i);d={messageChannel:l,onMessage(j){const T=j;if(T.data.eventId===y)switch(T.data.status){case"ack":clearTimeout(w),u=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),p(T.data.response);break;default:clearTimeout(w),clearTimeout(u),g(new Error("invalid_response"));break}}},this.handlers.add(d),l.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:y,data:t},[l.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}function Oa(){return window}function n4(n){Oa().location.href=n}function Ow(){return typeof Oa().WorkerGlobalScope<"u"&&typeof Oa().importScripts=="function"}async function r4(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function a4(){return navigator?.serviceWorker?.controller||null}function i4(){return Ow()?self:null}const Vw="firebaseLocalStorageDb",o4=1,Ph="firebaseLocalStorage",Bw="fbase_key";class Du{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function tm(n,e){return n.transaction([Ph],e?"readwrite":"readonly").objectStore(Ph)}function l4(){const n=indexedDB.deleteDatabase(Vw);return new Du(n).toPromise()}function mg(){const n=indexedDB.open(Vw,o4);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Ph,{keyPath:Bw})}catch(l){t(l)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Ph)?e(i):(i.close(),await l4(),e(await mg()))})})}async function ix(n,e,t){const i=tm(n,!0).put({[Bw]:e,value:t});return new Du(i).toPromise()}async function c4(n,e){const t=tm(n,!1).get(e),i=await new Du(t).toPromise();return i===void 0?null:i.value}function ox(n,e){const t=tm(n,!0).delete(e);return new Du(t).toPromise()}const u4=800,d4=3;class Uw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await mg(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>d4)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Ow()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=em._getInstance(i4()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await r4(),!this.activeServiceWorker)return;this.sender=new s4(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||a4()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await mg();return await ix(e,Dh,"1"),await ox(e,Dh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>ix(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>c4(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>ox(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(l=>{const u=tm(l,!1).getAll();return new Du(u).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:l,value:u}of e)i.add(l),JSON.stringify(this.localCache[l])!==JSON.stringify(u)&&(this.notifyListeners(l,u),t.push(l));for(const l of Object.keys(this.localCache))this.localCache[l]&&!i.has(l)&&(this.notifyListeners(l,null),t.push(l));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),u4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Uw.type="LOCAL";const h4=Uw;new Au(3e4,6e4);function m4(n,e){return e?li(e):(Pt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class ny extends Zg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Wl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Wl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Wl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function f4(n){return Iw(n.auth,new ny(n),n.bypassAuthState)}function p4(n){const{auth:e,user:t}=n;return Pt(t,e,"internal-error"),HC(t,new ny(n),n.bypassAuthState)}async function g4(n){const{auth:e,user:t}=n;return Pt(t,e,"internal-error"),qC(t,new ny(n),n.bypassAuthState)}class Fw{constructor(e,t,i,l,u=!1){this.auth=e,this.resolver=i,this.user=l,this.bypassAuthState=u,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:l,tenantId:u,error:d,type:p}=e;if(d){this.reject(d);return}const g={auth:this.auth,requestUri:t,sessionId:i,tenantId:u||void 0,postBody:l||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(p)(g))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return f4;case"linkViaPopup":case"linkViaRedirect":return g4;case"reauthViaPopup":case"reauthViaRedirect":return p4;default:ba(this.auth,"internal-error")}}resolve(e){pi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){pi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const y4=new Au(2e3,1e4);class ql extends Fw{constructor(e,t,i,l,u){super(e,t,l,u),this.provider=i,this.authWindow=null,this.pollId=null,ql.currentPopupAction&&ql.currentPopupAction.cancel(),ql.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Pt(e,this.auth,"internal-error"),e}async onExecution(){pi(this.filter.length===1,"Popup operations only handle one event");const e=sy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(La(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(La(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ql.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(La(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,y4.get())};e()}}ql.currentPopupAction=null;const b4="pendingRedirect",bh=new Map;class v4 extends Fw{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=bh.get(this.auth._key());if(!e){try{const i=await x4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}bh.set(this.auth._key(),e)}return this.bypassAuthState||bh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function x4(n,e){const t=k4(e),i=_4(n);if(!await i._isAvailable())return!1;const l=await i._get(t)==="true";return await i._remove(t),l}function w4(n,e){bh.set(n._key(),e)}function _4(n){return li(n._redirectPersistence)}function k4(n){return yh(b4,n.config.apiKey,n.name)}async function j4(n,e,t=!1){if(qr(n.app))return Promise.reject(ui(n));const i=po(n),l=m4(i,e),d=await new v4(i,l,t).execute();return d&&!t&&(delete d.user._redirectEventId,await i._persistUserIfCurrent(d.user),await i._setRedirectUser(null,e)),d}const T4=600*1e3;class E4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!S4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!zw(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(La(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=T4&&this.cachedEventUids.clear(),this.cachedEventUids.has(lx(e))}saveEventToCache(e){this.cachedEventUids.add(lx(e)),this.lastProcessedEventTime=Date.now()}}function lx(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function zw({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function S4(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return zw(n);default:return!1}}async function N4(n,e={}){return vi(n,"GET","/v1/projects",e)}const C4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,R4=/^https?/;async function A4(n){if(n.config.emulator)return;const{authorizedDomains:e}=await N4(n);for(const t of e)try{if(I4(t))return}catch{}ba(n,"unauthorized-domain")}function I4(n){const e=ug(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===i}if(!R4.test(t))return!1;if(C4.test(n))return i===n;const l=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+l+"|"+l+")$","i").test(i)}const M4=new Au(3e4,6e4);function cx(){const n=Oa().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function D4(n){return new Promise((e,t)=>{function i(){cx(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{cx(),t(La(n,"network-request-failed"))},timeout:M4.get()})}if(Oa().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Oa().gapi?.load)i();else{const l=kC("iframefcb");return Oa()[l]=()=>{gapi.load?i():t(La(n,"network-request-failed"))},Ew(`${_C()}?onload=${l}`).catch(u=>t(u))}}).catch(e=>{throw vh=null,e})}let vh=null;function P4(n){return vh=vh||D4(n),vh}const L4=new Au(5e3,15e3),O4="__/auth/iframe",V4="emulator/auth/iframe",B4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},U4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function F4(n){const e=n.config;Pt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Qg(e,V4):`https://${n.config.authDomain}/${O4}`,i={apiKey:e.apiKey,appName:n.name,v:Jo},l=U4.get(n.config.apiHost);l&&(i.eid=l);const u=n._getFrameworks();return u.length&&(i.fw=u.join(",")),`${t}?${Ru(i).slice(1)}`}async function z4(n){const e=await P4(n),t=Oa().gapi;return Pt(t,n,"internal-error"),e.open({where:document.body,url:F4(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:B4,dontclear:!0},i=>new Promise(async(l,u)=>{await i.restyle({setHideOnLeave:!1});const d=La(n,"network-request-failed"),p=Oa().setTimeout(()=>{u(d)},L4.get());function g(){Oa().clearTimeout(p),l(i)}i.ping(g).then(g,()=>{u(d)})}))}const q4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},H4=500,$4=600,W4="_blank",G4="http://localhost";class ux{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function K4(n,e,t,i=H4,l=$4){const u=Math.max((window.screen.availHeight-l)/2,0).toString(),d=Math.max((window.screen.availWidth-i)/2,0).toString();let p="";const g={...q4,width:i.toString(),height:l.toString(),top:u,left:d},y=cr().toLowerCase();t&&(p=vw(y)?W4:t),yw(y)&&(e=e||G4,g.scrollbars="yes");const w=Object.entries(g).reduce((T,[O,$])=>`${T}${O}=${$},`,"");if(mC(y)&&p!=="_self")return Y4(e||"",p),new ux(null);const j=window.open(e||"",p,w);Pt(j,n,"popup-blocked");try{j.focus()}catch{}return new ux(j)}function Y4(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const Q4="__/auth/handler",X4="emulator/auth/handler",J4=encodeURIComponent("fac");async function dx(n,e,t,i,l,u){Pt(n.config.authDomain,n,"auth-domain-config-required"),Pt(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Jo,eventId:l};if(e instanceof Rw){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",PS(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[w,j]of Object.entries({}))d[w]=j}if(e instanceof Mu){const w=e.getScopes().filter(j=>j!=="");w.length>0&&(d.scopes=w.join(","))}n.tenantId&&(d.tid=n.tenantId);const p=d;for(const w of Object.keys(p))p[w]===void 0&&delete p[w];const g=await n._getAppCheckToken(),y=g?`#${J4}=${encodeURIComponent(g)}`:"";return`${Z4(n)}?${Ru(p).slice(1)}${y}`}function Z4({config:n}){return n.emulator?Qg(n,X4):`https://${n.authDomain}/${Q4}`}const Ap="webStorageSupport";class eR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ty,this._completeRedirectFn=j4,this._overrideRedirectResult=w4}async _openPopup(e,t,i,l){pi(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const u=await dx(e,t,i,ug(),l);return K4(e,u,sy())}async _openRedirect(e,t,i,l){await this._originValidation(e);const u=await dx(e,t,i,ug(),l);return n4(u),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:l,promise:u}=this.eventManagers[t];return l?Promise.resolve(l):(pi(u,"If manager is not set, promise should be"),u)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await z4(e),i=new E4(e);return t.register("authEvent",l=>(Pt(l?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(l.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ap,{type:Ap},l=>{const u=l?.[0]?.[Ap];u!==void 0&&t(!!u),ba(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=A4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return jw()||bw()||Jg()}}const tR=eR;var hx="@firebase/auth",mx="1.12.0";class sR{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Pt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function nR(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function rR(n){$o(new io("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),l=e.getProvider("heartbeat"),u=e.getProvider("app-check-internal"),{apiKey:d,authDomain:p}=i.options;Pt(d&&!d.includes(":"),"invalid-api-key",{appName:i.name});const g={apiKey:d,authDomain:p,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Tw(n)},y=new vC(i,l,u,g);return CC(y,t),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),$o(new io("auth-internal",e=>{const t=po(e.getProvider("auth").getImmediate());return(i=>new sR(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Pa(hx,mx,nR(n)),Pa(hx,mx,"esm2020")}const aR=300,iR=nw("authIdTokenMaxAge")||aR;let fx=null;const oR=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>iR)return;const l=t?.token;fx!==l&&(fx=l,await fetch(n,{method:l?"POST":"DELETE",headers:l?{Authorization:`Bearer ${l}`}:{}}))};function qw(n=Kg()){const e=Jh(n,"auth");if(e.isInitialized())return e.getImmediate();const t=NC(n,{popupRedirectResolver:tR,persistence:[h4,hg,ty]}),i=nw("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const u=new URL(i,location.origin);if(location.origin===u.origin){const d=oR(u.toString());QC(t,d,()=>d(t.currentUser)),YC(t,p=>d(p))}}const l=ew("auth");return l&&RC(t,`http://${l}`),t}function lR(){return document.getElementsByTagName("head")?.[0]??document}xC({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=l=>{const u=La("internal-error");u.customData=l,t(u)},i.type="text/javascript",i.charset="UTF-8",lR().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});rR("Browser");var px=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ro,Hw;(function(){var n;function e(R,E){function A(){}A.prototype=E.prototype,R.F=E.prototype,R.prototype=new A,R.prototype.constructor=R,R.D=function(V,D,H){for(var M=Array(arguments.length-2),$e=2;$e<arguments.length;$e++)M[$e-2]=arguments[$e];return E.prototype[D].apply(V,M)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function l(R,E,A){A||(A=0);const V=Array(16);if(typeof E=="string")for(var D=0;D<16;++D)V[D]=E.charCodeAt(A++)|E.charCodeAt(A++)<<8|E.charCodeAt(A++)<<16|E.charCodeAt(A++)<<24;else for(D=0;D<16;++D)V[D]=E[A++]|E[A++]<<8|E[A++]<<16|E[A++]<<24;E=R.g[0],A=R.g[1],D=R.g[2];let H=R.g[3],M;M=E+(H^A&(D^H))+V[0]+3614090360&4294967295,E=A+(M<<7&4294967295|M>>>25),M=H+(D^E&(A^D))+V[1]+3905402710&4294967295,H=E+(M<<12&4294967295|M>>>20),M=D+(A^H&(E^A))+V[2]+606105819&4294967295,D=H+(M<<17&4294967295|M>>>15),M=A+(E^D&(H^E))+V[3]+3250441966&4294967295,A=D+(M<<22&4294967295|M>>>10),M=E+(H^A&(D^H))+V[4]+4118548399&4294967295,E=A+(M<<7&4294967295|M>>>25),M=H+(D^E&(A^D))+V[5]+1200080426&4294967295,H=E+(M<<12&4294967295|M>>>20),M=D+(A^H&(E^A))+V[6]+2821735955&4294967295,D=H+(M<<17&4294967295|M>>>15),M=A+(E^D&(H^E))+V[7]+4249261313&4294967295,A=D+(M<<22&4294967295|M>>>10),M=E+(H^A&(D^H))+V[8]+1770035416&4294967295,E=A+(M<<7&4294967295|M>>>25),M=H+(D^E&(A^D))+V[9]+2336552879&4294967295,H=E+(M<<12&4294967295|M>>>20),M=D+(A^H&(E^A))+V[10]+4294925233&4294967295,D=H+(M<<17&4294967295|M>>>15),M=A+(E^D&(H^E))+V[11]+2304563134&4294967295,A=D+(M<<22&4294967295|M>>>10),M=E+(H^A&(D^H))+V[12]+1804603682&4294967295,E=A+(M<<7&4294967295|M>>>25),M=H+(D^E&(A^D))+V[13]+4254626195&4294967295,H=E+(M<<12&4294967295|M>>>20),M=D+(A^H&(E^A))+V[14]+2792965006&4294967295,D=H+(M<<17&4294967295|M>>>15),M=A+(E^D&(H^E))+V[15]+1236535329&4294967295,A=D+(M<<22&4294967295|M>>>10),M=E+(D^H&(A^D))+V[1]+4129170786&4294967295,E=A+(M<<5&4294967295|M>>>27),M=H+(A^D&(E^A))+V[6]+3225465664&4294967295,H=E+(M<<9&4294967295|M>>>23),M=D+(E^A&(H^E))+V[11]+643717713&4294967295,D=H+(M<<14&4294967295|M>>>18),M=A+(H^E&(D^H))+V[0]+3921069994&4294967295,A=D+(M<<20&4294967295|M>>>12),M=E+(D^H&(A^D))+V[5]+3593408605&4294967295,E=A+(M<<5&4294967295|M>>>27),M=H+(A^D&(E^A))+V[10]+38016083&4294967295,H=E+(M<<9&4294967295|M>>>23),M=D+(E^A&(H^E))+V[15]+3634488961&4294967295,D=H+(M<<14&4294967295|M>>>18),M=A+(H^E&(D^H))+V[4]+3889429448&4294967295,A=D+(M<<20&4294967295|M>>>12),M=E+(D^H&(A^D))+V[9]+568446438&4294967295,E=A+(M<<5&4294967295|M>>>27),M=H+(A^D&(E^A))+V[14]+3275163606&4294967295,H=E+(M<<9&4294967295|M>>>23),M=D+(E^A&(H^E))+V[3]+4107603335&4294967295,D=H+(M<<14&4294967295|M>>>18),M=A+(H^E&(D^H))+V[8]+1163531501&4294967295,A=D+(M<<20&4294967295|M>>>12),M=E+(D^H&(A^D))+V[13]+2850285829&4294967295,E=A+(M<<5&4294967295|M>>>27),M=H+(A^D&(E^A))+V[2]+4243563512&4294967295,H=E+(M<<9&4294967295|M>>>23),M=D+(E^A&(H^E))+V[7]+1735328473&4294967295,D=H+(M<<14&4294967295|M>>>18),M=A+(H^E&(D^H))+V[12]+2368359562&4294967295,A=D+(M<<20&4294967295|M>>>12),M=E+(A^D^H)+V[5]+4294588738&4294967295,E=A+(M<<4&4294967295|M>>>28),M=H+(E^A^D)+V[8]+2272392833&4294967295,H=E+(M<<11&4294967295|M>>>21),M=D+(H^E^A)+V[11]+1839030562&4294967295,D=H+(M<<16&4294967295|M>>>16),M=A+(D^H^E)+V[14]+4259657740&4294967295,A=D+(M<<23&4294967295|M>>>9),M=E+(A^D^H)+V[1]+2763975236&4294967295,E=A+(M<<4&4294967295|M>>>28),M=H+(E^A^D)+V[4]+1272893353&4294967295,H=E+(M<<11&4294967295|M>>>21),M=D+(H^E^A)+V[7]+4139469664&4294967295,D=H+(M<<16&4294967295|M>>>16),M=A+(D^H^E)+V[10]+3200236656&4294967295,A=D+(M<<23&4294967295|M>>>9),M=E+(A^D^H)+V[13]+681279174&4294967295,E=A+(M<<4&4294967295|M>>>28),M=H+(E^A^D)+V[0]+3936430074&4294967295,H=E+(M<<11&4294967295|M>>>21),M=D+(H^E^A)+V[3]+3572445317&4294967295,D=H+(M<<16&4294967295|M>>>16),M=A+(D^H^E)+V[6]+76029189&4294967295,A=D+(M<<23&4294967295|M>>>9),M=E+(A^D^H)+V[9]+3654602809&4294967295,E=A+(M<<4&4294967295|M>>>28),M=H+(E^A^D)+V[12]+3873151461&4294967295,H=E+(M<<11&4294967295|M>>>21),M=D+(H^E^A)+V[15]+530742520&4294967295,D=H+(M<<16&4294967295|M>>>16),M=A+(D^H^E)+V[2]+3299628645&4294967295,A=D+(M<<23&4294967295|M>>>9),M=E+(D^(A|~H))+V[0]+4096336452&4294967295,E=A+(M<<6&4294967295|M>>>26),M=H+(A^(E|~D))+V[7]+1126891415&4294967295,H=E+(M<<10&4294967295|M>>>22),M=D+(E^(H|~A))+V[14]+2878612391&4294967295,D=H+(M<<15&4294967295|M>>>17),M=A+(H^(D|~E))+V[5]+4237533241&4294967295,A=D+(M<<21&4294967295|M>>>11),M=E+(D^(A|~H))+V[12]+1700485571&4294967295,E=A+(M<<6&4294967295|M>>>26),M=H+(A^(E|~D))+V[3]+2399980690&4294967295,H=E+(M<<10&4294967295|M>>>22),M=D+(E^(H|~A))+V[10]+4293915773&4294967295,D=H+(M<<15&4294967295|M>>>17),M=A+(H^(D|~E))+V[1]+2240044497&4294967295,A=D+(M<<21&4294967295|M>>>11),M=E+(D^(A|~H))+V[8]+1873313359&4294967295,E=A+(M<<6&4294967295|M>>>26),M=H+(A^(E|~D))+V[15]+4264355552&4294967295,H=E+(M<<10&4294967295|M>>>22),M=D+(E^(H|~A))+V[6]+2734768916&4294967295,D=H+(M<<15&4294967295|M>>>17),M=A+(H^(D|~E))+V[13]+1309151649&4294967295,A=D+(M<<21&4294967295|M>>>11),M=E+(D^(A|~H))+V[4]+4149444226&4294967295,E=A+(M<<6&4294967295|M>>>26),M=H+(A^(E|~D))+V[11]+3174756917&4294967295,H=E+(M<<10&4294967295|M>>>22),M=D+(E^(H|~A))+V[2]+718787259&4294967295,D=H+(M<<15&4294967295|M>>>17),M=A+(H^(D|~E))+V[9]+3951481745&4294967295,R.g[0]=R.g[0]+E&4294967295,R.g[1]=R.g[1]+(D+(M<<21&4294967295|M>>>11))&4294967295,R.g[2]=R.g[2]+D&4294967295,R.g[3]=R.g[3]+H&4294967295}i.prototype.v=function(R,E){E===void 0&&(E=R.length);const A=E-this.blockSize,V=this.C;let D=this.h,H=0;for(;H<E;){if(D==0)for(;H<=A;)l(this,R,H),H+=this.blockSize;if(typeof R=="string"){for(;H<E;)if(V[D++]=R.charCodeAt(H++),D==this.blockSize){l(this,V),D=0;break}}else for(;H<E;)if(V[D++]=R[H++],D==this.blockSize){l(this,V),D=0;break}}this.h=D,this.o+=E},i.prototype.A=function(){var R=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);R[0]=128;for(var E=1;E<R.length-8;++E)R[E]=0;E=this.o*8;for(var A=R.length-8;A<R.length;++A)R[A]=E&255,E/=256;for(this.v(R),R=Array(16),E=0,A=0;A<4;++A)for(let V=0;V<32;V+=8)R[E++]=this.g[A]>>>V&255;return R};function u(R,E){var A=p;return Object.prototype.hasOwnProperty.call(A,R)?A[R]:A[R]=E(R)}function d(R,E){this.h=E;const A=[];let V=!0;for(let D=R.length-1;D>=0;D--){const H=R[D]|0;V&&H==E||(A[D]=H,V=!1)}this.g=A}var p={};function g(R){return-128<=R&&R<128?u(R,function(E){return new d([E|0],E<0?-1:0)}):new d([R|0],R<0?-1:0)}function y(R){if(isNaN(R)||!isFinite(R))return j;if(R<0)return B(y(-R));const E=[];let A=1;for(let V=0;R>=A;V++)E[V]=R/A|0,A*=4294967296;return new d(E,0)}function w(R,E){if(R.length==0)throw Error("number format error: empty string");if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(R.charAt(0)=="-")return B(w(R.substring(1),E));if(R.indexOf("-")>=0)throw Error('number format error: interior "-" character');const A=y(Math.pow(E,8));let V=j;for(let H=0;H<R.length;H+=8){var D=Math.min(8,R.length-H);const M=parseInt(R.substring(H,H+D),E);D<8?(D=y(Math.pow(E,D)),V=V.j(D).add(y(M))):(V=V.j(A),V=V.add(y(M)))}return V}var j=g(0),T=g(1),O=g(16777216);n=d.prototype,n.m=function(){if(F(this))return-B(this).m();let R=0,E=1;for(let A=0;A<this.g.length;A++){const V=this.i(A);R+=(V>=0?V:4294967296+V)*E,E*=4294967296}return R},n.toString=function(R){if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if($(this))return"0";if(F(this))return"-"+B(this).toString(R);const E=y(Math.pow(R,6));var A=this;let V="";for(;;){const D=be(A,E).g;A=te(A,D.j(E));let H=((A.g.length>0?A.g[0]:A.h)>>>0).toString(R);if(A=D,$(A))return H+V;for(;H.length<6;)H="0"+H;V=H+V}},n.i=function(R){return R<0?0:R<this.g.length?this.g[R]:this.h};function $(R){if(R.h!=0)return!1;for(let E=0;E<R.g.length;E++)if(R.g[E]!=0)return!1;return!0}function F(R){return R.h==-1}n.l=function(R){return R=te(this,R),F(R)?-1:$(R)?0:1};function B(R){const E=R.g.length,A=[];for(let V=0;V<E;V++)A[V]=~R.g[V];return new d(A,~R.h).add(T)}n.abs=function(){return F(this)?B(this):this},n.add=function(R){const E=Math.max(this.g.length,R.g.length),A=[];let V=0;for(let D=0;D<=E;D++){let H=V+(this.i(D)&65535)+(R.i(D)&65535),M=(H>>>16)+(this.i(D)>>>16)+(R.i(D)>>>16);V=M>>>16,H&=65535,M&=65535,A[D]=M<<16|H}return new d(A,A[A.length-1]&-2147483648?-1:0)};function te(R,E){return R.add(B(E))}n.j=function(R){if($(this)||$(R))return j;if(F(this))return F(R)?B(this).j(B(R)):B(B(this).j(R));if(F(R))return B(this.j(B(R)));if(this.l(O)<0&&R.l(O)<0)return y(this.m()*R.m());const E=this.g.length+R.g.length,A=[];for(var V=0;V<2*E;V++)A[V]=0;for(V=0;V<this.g.length;V++)for(let D=0;D<R.g.length;D++){const H=this.i(V)>>>16,M=this.i(V)&65535,$e=R.i(D)>>>16,pt=R.i(D)&65535;A[2*V+2*D]+=M*pt,K(A,2*V+2*D),A[2*V+2*D+1]+=H*pt,K(A,2*V+2*D+1),A[2*V+2*D+1]+=M*$e,K(A,2*V+2*D+1),A[2*V+2*D+2]+=H*$e,K(A,2*V+2*D+2)}for(R=0;R<E;R++)A[R]=A[2*R+1]<<16|A[2*R];for(R=E;R<2*E;R++)A[R]=0;return new d(A,0)};function K(R,E){for(;(R[E]&65535)!=R[E];)R[E+1]+=R[E]>>>16,R[E]&=65535,E++}function ae(R,E){this.g=R,this.h=E}function be(R,E){if($(E))throw Error("division by zero");if($(R))return new ae(j,j);if(F(R))return E=be(B(R),E),new ae(B(E.g),B(E.h));if(F(E))return E=be(R,B(E)),new ae(B(E.g),E.h);if(R.g.length>30){if(F(R)||F(E))throw Error("slowDivide_ only works with positive integers.");for(var A=T,V=E;V.l(R)<=0;)A=ve(A),V=ve(V);var D=_e(A,1),H=_e(V,1);for(V=_e(V,2),A=_e(A,2);!$(V);){var M=H.add(V);M.l(R)<=0&&(D=D.add(A),H=M),V=_e(V,1),A=_e(A,1)}return E=te(R,D.j(E)),new ae(D,E)}for(D=j;R.l(E)>=0;){for(A=Math.max(1,Math.floor(R.m()/E.m())),V=Math.ceil(Math.log(A)/Math.LN2),V=V<=48?1:Math.pow(2,V-48),H=y(A),M=H.j(E);F(M)||M.l(R)>0;)A-=V,H=y(A),M=H.j(E);$(H)&&(H=T),D=D.add(H),R=te(R,M)}return new ae(D,R)}n.B=function(R){return be(this,R).h},n.and=function(R){const E=Math.max(this.g.length,R.g.length),A=[];for(let V=0;V<E;V++)A[V]=this.i(V)&R.i(V);return new d(A,this.h&R.h)},n.or=function(R){const E=Math.max(this.g.length,R.g.length),A=[];for(let V=0;V<E;V++)A[V]=this.i(V)|R.i(V);return new d(A,this.h|R.h)},n.xor=function(R){const E=Math.max(this.g.length,R.g.length),A=[];for(let V=0;V<E;V++)A[V]=this.i(V)^R.i(V);return new d(A,this.h^R.h)};function ve(R){const E=R.g.length+1,A=[];for(let V=0;V<E;V++)A[V]=R.i(V)<<1|R.i(V-1)>>>31;return new d(A,R.h)}function _e(R,E){const A=E>>5;E%=32;const V=R.g.length-A,D=[];for(let H=0;H<V;H++)D[H]=E>0?R.i(H+A)>>>E|R.i(H+A+1)<<32-E:R.i(H+A);return new d(D,R.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,Hw=i,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.B,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=y,d.fromString=w,ro=d}).apply(typeof px<"u"?px:typeof self<"u"?self:typeof window<"u"?window:{});var th=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var $w,su,Ww,xh,fg,Gw,Kw,Yw;(function(){var n,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof th=="object"&&th];for(var b=0;b<h.length;++b){var _=h[b];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var i=t(this);function l(h,b){if(b)e:{var _=i;h=h.split(".");for(var C=0;C<h.length-1;C++){var re=h[C];if(!(re in _))break e;_=_[re]}h=h[h.length-1],C=_[h],b=b(C),b!=C&&b!=null&&e(_,h,{configurable:!0,writable:!0,value:b})}}l("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),l("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),l("Object.entries",function(h){return h||function(b){var _=[],C;for(C in b)Object.prototype.hasOwnProperty.call(b,C)&&_.push([C,b[C]]);return _}});var u=u||{},d=this||self;function p(h){var b=typeof h;return b=="object"&&h!=null||b=="function"}function g(h,b,_){return h.call.apply(h.bind,arguments)}function y(h,b,_){return y=g,y.apply(null,arguments)}function w(h,b){var _=Array.prototype.slice.call(arguments,1);return function(){var C=_.slice();return C.push.apply(C,arguments),h.apply(this,C)}}function j(h,b){function _(){}_.prototype=b.prototype,h.Z=b.prototype,h.prototype=new _,h.prototype.constructor=h,h.Ob=function(C,re,fe){for(var Ye=Array(arguments.length-2),Zt=2;Zt<arguments.length;Zt++)Ye[Zt-2]=arguments[Zt];return b.prototype[re].apply(C,Ye)}}var T=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function O(h){const b=h.length;if(b>0){const _=Array(b);for(let C=0;C<b;C++)_[C]=h[C];return _}return[]}function $(h,b){for(let C=1;C<arguments.length;C++){const re=arguments[C];var _=typeof re;if(_=_!="object"?_:re?Array.isArray(re)?"array":_:"null",_=="array"||_=="object"&&typeof re.length=="number"){_=h.length||0;const fe=re.length||0;h.length=_+fe;for(let Ye=0;Ye<fe;Ye++)h[_+Ye]=re[Ye]}else h.push(re)}}class F{constructor(b,_){this.i=b,this.j=_,this.h=0,this.g=null}get(){let b;return this.h>0?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function B(h){d.setTimeout(()=>{throw h},0)}function te(){var h=R;let b=null;return h.g&&(b=h.g,h.g=h.g.next,h.g||(h.h=null),b.next=null),b}class K{constructor(){this.h=this.g=null}add(b,_){const C=ae.get();C.set(b,_),this.h?this.h.next=C:this.g=C,this.h=C}}var ae=new F(()=>new be,h=>h.reset());class be{constructor(){this.next=this.g=this.h=null}set(b,_){this.h=b,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let ve,_e=!1,R=new K,E=()=>{const h=Promise.resolve(void 0);ve=()=>{h.then(A)}};function A(){for(var h;h=te();){try{h.h.call(h.g)}catch(_){B(_)}var b=ae;b.j(h),b.h<100&&(b.h++,h.next=b.g,b.g=h)}_e=!1}function V(){this.u=this.u,this.C=this.C}V.prototype.u=!1,V.prototype.dispose=function(){this.u||(this.u=!0,this.N())},V.prototype[Symbol.dispose]=function(){this.dispose()},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(h,b){this.type=h,this.g=this.target=b,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var H=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var h=!1,b=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const _=()=>{};d.addEventListener("test",_,b),d.removeEventListener("test",_,b)}catch{}return h})();function M(h){return/^[\s\xa0]*$/.test(h)}function $e(h,b){D.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,b)}j($e,D),$e.prototype.init=function(h,b){const _=this.type=h.type,C=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=b,b=h.relatedTarget,b||(_=="mouseover"?b=h.fromElement:_=="mouseout"&&(b=h.toElement)),this.relatedTarget=b,C?(this.clientX=C.clientX!==void 0?C.clientX:C.pageX,this.clientY=C.clientY!==void 0?C.clientY:C.pageY,this.screenX=C.screenX||0,this.screenY=C.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&$e.Z.h.call(this)},$e.prototype.h=function(){$e.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var pt="closure_listenable_"+(Math.random()*1e6|0),W=0;function pe(h,b,_,C,re){this.listener=h,this.proxy=null,this.src=b,this.type=_,this.capture=!!C,this.ha=re,this.key=++W,this.da=this.fa=!1}function Ve(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function We(h,b,_){for(const C in h)b.call(_,h[C],C,h)}function ee(h,b){for(const _ in h)b.call(void 0,h[_],_,h)}function L(h){const b={};for(const _ in h)b[_]=h[_];return b}const se="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function De(h,b){let _,C;for(let re=1;re<arguments.length;re++){C=arguments[re];for(_ in C)h[_]=C[_];for(let fe=0;fe<se.length;fe++)_=se[fe],Object.prototype.hasOwnProperty.call(C,_)&&(h[_]=C[_])}}function Le(h){this.src=h,this.g={},this.h=0}Le.prototype.add=function(h,b,_,C,re){const fe=h.toString();h=this.g[fe],h||(h=this.g[fe]=[],this.h++);const Ye=Fe(h,b,C,re);return Ye>-1?(b=h[Ye],_||(b.fa=!1)):(b=new pe(b,this.src,fe,!!C,re),b.fa=_,h.push(b)),b};function Qe(h,b){const _=b.type;if(_ in h.g){var C=h.g[_],re=Array.prototype.indexOf.call(C,b,void 0),fe;(fe=re>=0)&&Array.prototype.splice.call(C,re,1),fe&&(Ve(b),h.g[_].length==0&&(delete h.g[_],h.h--))}}function Fe(h,b,_,C){for(let re=0;re<h.length;++re){const fe=h[re];if(!fe.da&&fe.listener==b&&fe.capture==!!_&&fe.ha==C)return re}return-1}var ft="closure_lm_"+(Math.random()*1e6|0),jt={};function at(h,b,_,C,re){if(Array.isArray(b)){for(let fe=0;fe<b.length;fe++)at(h,b[fe],_,C,re);return null}return _=bt(_),h&&h[pt]?h.J(b,_,p(C)?!!C.capture:!1,re):Gt(h,b,_,!1,C,re)}function Gt(h,b,_,C,re,fe){if(!b)throw Error("Invalid event type");const Ye=p(re)?!!re.capture:!!re;let Zt=Kt(h);if(Zt||(h[ft]=Zt=new Le(h)),_=Zt.add(b,_,C,Ye,fe),_.proxy)return _;if(C=_s(),_.proxy=C,C.src=h,C.listener=_,h.addEventListener)H||(re=Ye),re===void 0&&(re=!1),h.addEventListener(b.toString(),C,re);else if(h.attachEvent)h.attachEvent(le(b.toString()),C);else if(h.addListener&&h.removeListener)h.addListener(C);else throw Error("addEventListener and attachEvent are unavailable.");return _}function _s(){function h(_){return b.call(h.src,h.listener,_)}const b=Xt;return h}function wt(h,b,_,C,re){if(Array.isArray(b))for(var fe=0;fe<b.length;fe++)wt(h,b[fe],_,C,re);else C=p(C)?!!C.capture:!!C,_=bt(_),h&&h[pt]?(h=h.i,fe=String(b).toString(),fe in h.g&&(b=h.g[fe],_=Fe(b,_,C,re),_>-1&&(Ve(b[_]),Array.prototype.splice.call(b,_,1),b.length==0&&(delete h.g[fe],h.h--)))):h&&(h=Kt(h))&&(b=h.g[b.toString()],h=-1,b&&(h=Fe(b,_,C,re)),(_=h>-1?b[h]:null)&&gt(_))}function gt(h){if(typeof h!="number"&&h&&!h.da){var b=h.src;if(b&&b[pt])Qe(b.i,h);else{var _=h.type,C=h.proxy;b.removeEventListener?b.removeEventListener(_,C,h.capture):b.detachEvent?b.detachEvent(le(_),C):b.addListener&&b.removeListener&&b.removeListener(C),(_=Kt(b))?(Qe(_,h),_.h==0&&(_.src=null,b[ft]=null)):Ve(h)}}}function le(h){return h in jt?jt[h]:jt[h]="on"+h}function Xt(h,b){if(h.da)h=!0;else{b=new $e(b,this);const _=h.listener,C=h.ha||h.src;h.fa&&gt(h),h=_.call(C,b)}return h}function Kt(h){return h=h[ft],h instanceof Le?h:null}var ut="__closure_events_fn_"+(Math.random()*1e9>>>0);function bt(h){return typeof h=="function"?h:(h[ut]||(h[ut]=function(b){return h.handleEvent(b)}),h[ut])}function Xe(){V.call(this),this.i=new Le(this),this.M=this,this.G=null}j(Xe,V),Xe.prototype[pt]=!0,Xe.prototype.removeEventListener=function(h,b,_,C){wt(this,h,b,_,C)};function rt(h,b){var _,C=h.G;if(C)for(_=[];C;C=C.G)_.push(C);if(h=h.M,C=b.type||b,typeof b=="string")b=new D(b,h);else if(b instanceof D)b.target=b.target||h;else{var re=b;b=new D(C,h),De(b,re)}re=!0;let fe,Ye;if(_)for(Ye=_.length-1;Ye>=0;Ye--)fe=b.g=_[Ye],re=qt(fe,C,!0,b)&&re;if(fe=b.g=h,re=qt(fe,C,!0,b)&&re,re=qt(fe,C,!1,b)&&re,_)for(Ye=0;Ye<_.length;Ye++)fe=b.g=_[Ye],re=qt(fe,C,!1,b)&&re}Xe.prototype.N=function(){if(Xe.Z.N.call(this),this.i){var h=this.i;for(const b in h.g){const _=h.g[b];for(let C=0;C<_.length;C++)Ve(_[C]);delete h.g[b],h.h--}}this.G=null},Xe.prototype.J=function(h,b,_,C){return this.i.add(String(h),b,!1,_,C)},Xe.prototype.K=function(h,b,_,C){return this.i.add(String(h),b,!0,_,C)};function qt(h,b,_,C){if(b=h.i.g[String(b)],!b)return!0;b=b.concat();let re=!0;for(let fe=0;fe<b.length;++fe){const Ye=b[fe];if(Ye&&!Ye.da&&Ye.capture==_){const Zt=Ye.listener,jn=Ye.ha||Ye.src;Ye.fa&&Qe(h.i,Ye),re=Zt.call(jn,C)!==!1&&re}}return re&&!C.defaultPrevented}function en(h,b){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=y(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(b)>2147483647?-1:d.setTimeout(h,b||0)}function As(h){h.g=en(()=>{h.g=null,h.i&&(h.i=!1,As(h))},h.l);const b=h.h;h.h=null,h.m.apply(null,b)}class ts extends V{constructor(b,_){super(),this.m=b,this.l=_,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:As(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ct(h){V.call(this),this.h=h,this.g={}}j(Ct,V);var Jt=[];function Ss(h){We(h.g,function(b,_){this.g.hasOwnProperty(_)&&gt(b)},h),h.g={}}Ct.prototype.N=function(){Ct.Z.N.call(this),Ss(this)},Ct.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ot=d.JSON.stringify,Ps=d.JSON.parse,ue=class{stringify(h){return d.JSON.stringify(h,void 0)}parse(h){return d.JSON.parse(h,void 0)}};function Se(){}function Ie(){}var Ge={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function X(){D.call(this,"d")}j(X,D);function he(){D.call(this,"c")}j(he,D);var Pe={},qe=null;function Ae(){return qe=qe||new Xe}Pe.Ia="serverreachability";function dt(h){D.call(this,Pe.Ia,h)}j(dt,D);function Tt(h){const b=Ae();rt(b,new dt(b))}Pe.STAT_EVENT="statevent";function Q(h,b){D.call(this,Pe.STAT_EVENT,h),this.stat=b}j(Q,D);function de(h){const b=Ae();rt(b,new Q(b,h))}Pe.Ja="timingevent";function tt(h,b){D.call(this,Pe.Ja,h),this.size=b}j(tt,D);function At(h,b){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){h()},b)}function Et(){this.g=!0}Et.prototype.ua=function(){this.g=!1};function ss(h,b,_,C,re,fe){h.info(function(){if(h.g)if(fe){var Ye="",Zt=fe.split("&");for(let Vs=0;Vs<Zt.length;Vs++){var jn=Zt[Vs].split("=");if(jn.length>1){const rn=jn[0];jn=jn[1];const Kr=rn.split("_");Ye=Kr.length>=2&&Kr[1]=="type"?Ye+(rn+"="+jn+"&"):Ye+(rn+"=redacted&")}}}else Ye=null;else Ye=fe;return"XMLHTTP REQ ("+C+") [attempt "+re+"]: "+b+`
`+_+`
`+Ye})}function Ut(h,b,_,C,re,fe,Ye){h.info(function(){return"XMLHTTP RESP ("+C+") [ attempt "+re+"]: "+b+`
`+_+`
`+fe+" "+Ye})}function Vt(h,b,_,C){h.info(function(){return"XMLHTTP TEXT ("+b+"): "+Xs(h,_)+(C?" "+C:"")})}function Ls(h,b){h.info(function(){return"TIMEOUT: "+b})}Et.prototype.info=function(){};function Xs(h,b){if(!h.g)return b;if(!b)return null;try{const fe=JSON.parse(b);if(fe){for(h=0;h<fe.length;h++)if(Array.isArray(fe[h])){var _=fe[h];if(!(_.length<2)){var C=_[1];if(Array.isArray(C)&&!(C.length<1)){var re=C[0];if(re!="noop"&&re!="stop"&&re!="close")for(let Ye=1;Ye<C.length;Ye++)C[Ye]=""}}}}return Ot(fe)}catch{return b}}var is={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Ns={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Os;function q(){}j(q,Se),q.prototype.g=function(){return new XMLHttpRequest},Os=new q;function we(h){return encodeURIComponent(String(h))}function Te(h){var b=1;h=h.split(":");const _=[];for(;b>0&&h.length;)_.push(h.shift()),b--;return h.length&&_.push(h.join(":")),_}function Ee(h,b,_,C){this.j=h,this.i=b,this.l=_,this.S=C||1,this.V=new Ct(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new ke}function ke(){this.i=null,this.g="",this.h=!1}var lt={},ht={};function st(h,b,_){h.M=1,h.A=Ke(ls(b)),h.u=_,h.R=!0,vt(h,null)}function vt(h,b){h.F=Date.now(),ln(h),h.B=ls(h.A);var _=h.B,C=h.S;Array.isArray(C)||(C=[String(C)]),un(_.i,"t",C),h.C=0,_=h.j.L,h.h=new ke,h.g=Wu(h.j,_?b:null,!h.u),h.P>0&&(h.O=new ts(y(h.Y,h,h.g),h.P)),b=h.V,_=h.g,C=h.ba;var re="readystatechange";Array.isArray(re)||(re&&(Jt[0]=re.toString()),re=Jt);for(let fe=0;fe<re.length;fe++){const Ye=at(_,re[fe],C||b.handleEvent,!1,b.h||b);if(!Ye)break;b.g[Ye.key]=Ye}b=h.J?L(h.J):{},h.u?(h.v||(h.v="POST"),b["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,b)):(h.v="GET",h.g.ea(h.B,h.v,null,b)),Tt(),ss(h.i,h.v,h.B,h.l,h.S,h.u)}Ee.prototype.ba=function(h){h=h.target;const b=this.O;b&&rs(h)==3?b.j():this.Y(h)},Ee.prototype.Y=function(h){try{if(h==this.g)e:{const Zt=rs(this.g),jn=this.g.ya(),Vs=this.g.ca();if(!(Zt<3)&&(Zt!=3||this.g&&(this.h.h||this.g.la()||Ft(this.g)))){this.K||Zt!=4||jn==7||(jn==8||Vs<=0?Tt(3):Tt(2)),kn(this);var b=this.g.ca();this.X=b;var _=It(this);if(this.o=b==200,Ut(this.i,this.v,this.B,this.l,this.S,Zt,b),this.o){if(this.U&&!this.L){t:{if(this.g){var C,re=this.g;if((C=re.g?re.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(C)){var fe=C;break t}}fe=null}if(h=fe)Vt(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,k(this,h);else{this.o=!1,this.m=3,de(12),Fs(this),fn(this);break e}}if(this.R){h=!0;let rn;for(;!this.K&&this.C<_.length;)if(rn=mn(this,_),rn==ht){Zt==4&&(this.m=4,de(14),h=!1),Vt(this.i,this.l,null,"[Incomplete Response]");break}else if(rn==lt){this.m=4,de(15),Vt(this.i,this.l,_,"[Invalid Chunk]"),h=!1;break}else Vt(this.i,this.l,rn,null),k(this,rn);if(ks(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Zt!=4||_.length!=0||this.h.h||(this.m=1,de(16),h=!1),this.o=this.o&&h,!h)Vt(this.i,this.l,_,"[Invalid Chunked Response]"),Fs(this),fn(this);else if(_.length>0&&!this.W){this.W=!0;var Ye=this.j;Ye.g==this&&Ye.aa&&!Ye.P&&(Ye.j.info("Great, no buffering proxy detected. Bytes received: "+_.length),hr(Ye),Ye.P=!0,de(11))}}else Vt(this.i,this.l,_,null),k(this,_);Zt==4&&Fs(this),this.o&&!this.K&&(Zt==4?tl(this.j,this):(this.o=!1,ln(this)))}else xs(this.g),b==400&&_.indexOf("Unknown SID")>0?(this.m=3,de(12)):(this.m=0,de(13)),Fs(this),fn(this)}}}catch{}};function It(h){if(!ks(h))return h.g.la();const b=Ft(h.g);if(b==="")return"";let _="";const C=b.length,re=rs(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return Fs(h),fn(h),"";h.h.i=new d.TextDecoder}for(let fe=0;fe<C;fe++)h.h.h=!0,_+=h.h.i.decode(b[fe],{stream:!(re&&fe==C-1)});return b.length=0,h.h.g+=_,h.C=0,h.h.g}function ks(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function mn(h,b){var _=h.C,C=b.indexOf(`
`,_);return C==-1?ht:(_=Number(b.substring(_,C)),isNaN(_)?lt:(C+=1,C+_>b.length?ht:(b=b.slice(C,C+_),h.C=C+_,b)))}Ee.prototype.cancel=function(){this.K=!0,Fs(this)};function ln(h){h.T=Date.now()+h.H,_n(h,h.H)}function _n(h,b){if(h.D!=null)throw Error("WatchDog timer not null");h.D=At(y(h.aa,h),b)}function kn(h){h.D&&(d.clearTimeout(h.D),h.D=null)}Ee.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(Ls(this.i,this.B),this.M!=2&&(Tt(),de(17)),Fs(this),this.m=2,fn(this)):_n(this,this.T-h)};function fn(h){h.j.I==0||h.K||tl(h.j,h)}function Fs(h){kn(h);var b=h.O;b&&typeof b.dispose=="function"&&b.dispose(),h.O=null,Ss(h.V),h.g&&(b=h.g,h.g=null,b.abort(),b.dispose())}function k(h,b){try{var _=h.j;if(_.I!=0&&(_.g==h||Be(_.h,h))){if(!h.L&&Be(_.h,h)&&_.I==3){try{var C=_.Ba.g.parse(b)}catch{C=null}if(Array.isArray(C)&&C.length==3){var re=C;if(re[0]==0){e:if(!_.v){if(_.g)if(_.g.F+3e3<h.F)Ha(_),Ks(_);else break e;gn(_),de(18)}}else _.xa=re[1],0<_.xa-_.K&&re[2]<37500&&_.F&&_.A==0&&!_.C&&(_.C=At(y(_.Va,_),6e3));me(_.h)<=1&&_.ta&&(_.ta=void 0)}else mr(_,11)}else if((h.L||_.g==h)&&Ha(_),!M(b))for(re=_.Ba.g.parse(b),b=0;b<re.length;b++){let Vs=re[b];const rn=Vs[0];if(!(rn<=_.K))if(_.K=rn,Vs=Vs[1],_.I==2)if(Vs[0]=="c"){_.M=Vs[1],_.ba=Vs[2];const Kr=Vs[3];Kr!=null&&(_.ka=Kr,_.j.info("VER="+_.ka));const Ea=Vs[4];Ea!=null&&(_.za=Ea,_.j.info("SVER="+_.za));const la=Vs[5];la!=null&&typeof la=="number"&&la>0&&(C=1.5*la,_.O=C,_.j.info("backChannelRequestTimeoutMs_="+C)),C=_;const ca=h.g;if(ca){const bo=ca.g?ca.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(bo){var fe=C.h;fe.g||bo.indexOf("spdy")==-1&&bo.indexOf("quic")==-1&&bo.indexOf("h2")==-1||(fe.j=fe.l,fe.g=new Set,fe.h&&(Ue(fe,fe.h),fe.h=null))}if(C.G){const nl=ca.g?ca.g.getResponseHeader("X-HTTP-Session-Id"):null;nl&&(C.wa=nl,ne(C.J,C.G,nl))}}_.I=3,_.l&&_.l.ra(),_.aa&&(_.T=Date.now()-h.F,_.j.info("Handshake RTT: "+_.T+"ms")),C=_;var Ye=h;if(C.na=oa(C,C.L?C.ba:null,C.W),Ye.L){Je(C.h,Ye);var Zt=Ye,jn=C.O;jn&&(Zt.H=jn),Zt.D&&(kn(Zt),ln(Zt)),C.g=Ye}else rr(C);_.i.length>0&&dn(_)}else Vs[0]!="stop"&&Vs[0]!="close"||mr(_,7);else _.I==3&&(Vs[0]=="stop"||Vs[0]=="close"?Vs[0]=="stop"?mr(_,7):Js(_):Vs[0]!="noop"&&_.l&&_.l.qa(Vs),_.A=0)}}Tt(4)}catch{}}var N=class{constructor(h,b){this.g=h,this.map=b}};function P(h){this.l=h||10,d.PerformanceNavigationTiming?(h=d.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function U(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function me(h){return h.h?1:h.g?h.g.size:0}function Be(h,b){return h.h?h.h==b:h.g?h.g.has(b):!1}function Ue(h,b){h.g?h.g.add(b):h.h=b}function Je(h,b){h.h&&h.h==b?h.h=null:h.g&&h.g.has(b)&&h.g.delete(b)}P.prototype.cancel=function(){if(this.i=Ze(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Ze(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let b=h.i;for(const _ of h.g.values())b=b.concat(_.G);return b}return O(h.i)}var Ht=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function bs(h,b){if(h){h=h.split("&");for(let _=0;_<h.length;_++){const C=h[_].indexOf("=");let re,fe=null;C>=0?(re=h[_].substring(0,C),fe=h[_].substring(C+1)):re=h[_],b(re,fe?decodeURIComponent(fe.replace(/\+/g," ")):"")}}}function os(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let b;h instanceof os?(this.l=h.l,Cs(this,h.j),this.o=h.o,this.g=h.g,Y(this,h.u),this.h=h.h,xe(this,sr(h.i)),this.m=h.m):h&&(b=String(h).match(Ht))?(this.l=!1,Cs(this,b[1]||"",!0),this.o=He(b[2]||""),this.g=He(b[3]||"",!0),Y(this,b[4]),this.h=He(b[5]||"",!0),xe(this,b[6]||"",!0),this.m=He(b[7]||"")):(this.l=!1,this.i=new Gr(null,this.l))}os.prototype.toString=function(){const h=[];var b=this.j;b&&h.push(it(b,Rt,!0),":");var _=this.g;return(_||b=="file")&&(h.push("//"),(b=this.o)&&h.push(it(b,Rt,!0),"@"),h.push(we(_).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.u,_!=null&&h.push(":",String(_))),(_=this.h)&&(this.g&&_.charAt(0)!="/"&&h.push("/"),h.push(it(_,_.charAt(0)=="/"?cn:vs,!0))),(_=this.i.toString())&&h.push("?",_),(_=this.m)&&h.push("#",it(_,Wn)),h.join("")},os.prototype.resolve=function(h){const b=ls(this);let _=!!h.j;_?Cs(b,h.j):_=!!h.o,_?b.o=h.o:_=!!h.g,_?b.g=h.g:_=h.u!=null;var C=h.h;if(_)Y(b,h.u);else if(_=!!h.h){if(C.charAt(0)!="/")if(this.g&&!this.h)C="/"+C;else{var re=b.h.lastIndexOf("/");re!=-1&&(C=b.h.slice(0,re+1)+C)}if(re=C,re==".."||re==".")C="";else if(re.indexOf("./")!=-1||re.indexOf("/.")!=-1){C=re.lastIndexOf("/",0)==0,re=re.split("/");const fe=[];for(let Ye=0;Ye<re.length;){const Zt=re[Ye++];Zt=="."?C&&Ye==re.length&&fe.push(""):Zt==".."?((fe.length>1||fe.length==1&&fe[0]!="")&&fe.pop(),C&&Ye==re.length&&fe.push("")):(fe.push(Zt),C=!0)}C=fe.join("/")}else C=re}return _?b.h=C:_=h.i.toString()!=="",_?xe(b,sr(h.i)):_=!!h.m,_&&(b.m=h.m),b};function ls(h){return new os(h)}function Cs(h,b,_){h.j=_?He(b,!0):b,h.j&&(h.j=h.j.replace(/:$/,""))}function Y(h,b){if(b){if(b=Number(b),isNaN(b)||b<0)throw Error("Bad port number "+b);h.u=b}else h.u=null}function xe(h,b,_){b instanceof Gr?(h.i=b,_r(h.i,h.l)):(_||(b=it(b,hs)),h.i=new Gr(b,h.l))}function ne(h,b,_){h.i.set(b,_)}function Ke(h){return ne(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function He(h,b){return h?b?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function it(h,b,_){return typeof h=="string"?(h=encodeURI(h).replace(b,_t),_&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function _t(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Rt=/[#\/\?@]/g,vs=/[#\?:]/g,cn=/[#\?]/g,hs=/[#\?@]/g,Wn=/#/g;function Gr(h,b){this.h=this.g=null,this.i=h||null,this.j=!!b}function pn(h){h.g||(h.g=new Map,h.h=0,h.i&&bs(h.i,function(b,_){h.add(decodeURIComponent(b.replace(/\+/g," ")),_)}))}n=Gr.prototype,n.add=function(h,b){pn(this),this.i=null,h=Gn(this,h);let _=this.g.get(h);return _||this.g.set(h,_=[]),_.push(b),this.h+=1,this};function ja(h,b){pn(h),b=Gn(h,b),h.g.has(b)&&(h.i=null,h.h-=h.g.get(b).length,h.g.delete(b))}function Un(h,b){return pn(h),b=Gn(h,b),h.g.has(b)}n.forEach=function(h,b){pn(this),this.g.forEach(function(_,C){_.forEach(function(re){h.call(b,re,C,this)},this)},this)};function as(h,b){pn(h);let _=[];if(typeof b=="string")Un(h,b)&&(_=_.concat(h.g.get(Gn(h,b))));else for(h=Array.from(h.g.values()),b=0;b<h.length;b++)_=_.concat(h[b]);return _}n.set=function(h,b){return pn(this),this.i=null,h=Gn(this,h),Un(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[b]),this.h+=1,this},n.get=function(h,b){return h?(h=as(this,h),h.length>0?String(h[0]):b):b};function un(h,b,_){ja(h,b),_.length>0&&(h.i=null,h.g.set(Gn(h,b),O(_)),h.h+=_.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],b=Array.from(this.g.keys());for(let C=0;C<b.length;C++){var _=b[C];const re=we(_);_=as(this,_);for(let fe=0;fe<_.length;fe++){let Ye=re;_[fe]!==""&&(Ye+="="+we(_[fe])),h.push(Ye)}}return this.i=h.join("&")};function sr(h){const b=new Gr;return b.i=h.i,h.g&&(b.g=new Map(h.g),b.h=h.h),b}function Gn(h,b){return b=String(b),h.j&&(b=b.toLowerCase()),b}function _r(h,b){b&&!h.j&&(pn(h),h.i=null,h.g.forEach(function(_,C){const re=C.toLowerCase();C!=re&&(ja(this,C),un(this,re,_))},h)),h.j=b}function tn(h,b){const _=new Et;if(d.Image){const C=new Image;C.onload=w(Nn,_,"TestLoadImage: loaded",!0,b,C),C.onerror=w(Nn,_,"TestLoadImage: error",!1,b,C),C.onabort=w(Nn,_,"TestLoadImage: abort",!1,b,C),C.ontimeout=w(Nn,_,"TestLoadImage: timeout",!1,b,C),d.setTimeout(function(){C.ontimeout&&C.ontimeout()},1e4),C.src=h}else b(!1)}function Ln(h,b){const _=new Et,C=new AbortController,re=setTimeout(()=>{C.abort(),Nn(_,"TestPingServer: timeout",!1,b)},1e4);fetch(h,{signal:C.signal}).then(fe=>{clearTimeout(re),fe.ok?Nn(_,"TestPingServer: ok",!0,b):Nn(_,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(re),Nn(_,"TestPingServer: error",!1,b)})}function Nn(h,b,_,C,re){try{re&&(re.onload=null,re.onerror=null,re.onabort=null,re.ontimeout=null),C(_)}catch{}}function kr(){this.g=new ue}function jr(h){this.i=h.Sb||null,this.h=h.ab||!1}j(jr,Se),jr.prototype.g=function(){return new Dr(this.i,this.h)};function Dr(h,b){Xe.call(this),this.H=h,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}j(Dr,Xe),n=Dr.prototype,n.open=function(h,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=b,this.readyState=1,Pr(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const b={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(b.body=h),(this.H||d).fetch(new Request(this.D,b)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ta(this)),this.readyState=0},n.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Pr(this)),this.g&&(this.readyState=3,Pr(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;wi(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function wi(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}n.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var b=h.value?h.value:new Uint8Array(0);(b=this.B.decode(b,{stream:!h.done}))&&(this.response=this.responseText+=b)}h.done?Ta(this):Pr(this),this.readyState==3&&wi(this)}},n.Oa=function(h){this.g&&(this.response=this.responseText=h,Ta(this))},n.Na=function(h){this.g&&(this.response=h,Ta(this))},n.ga=function(){this.g&&Ta(this)};function Ta(h){h.readyState=4,h.l=null,h.j=null,h.B=null,Pr(h)}n.setRequestHeader=function(h,b){this.A.append(h,b)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],b=this.h.entries();for(var _=b.next();!_.done;)_=_.value,h.push(_[0]+": "+_[1]),_=b.next();return h.join(`\r
`)};function Pr(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Dr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function I(h){let b="";return We(h,function(_,C){b+=C,b+=":",b+=_,b+=`\r
`}),b}function Z(h,b,_){e:{for(C in _){var C=!1;break e}C=!0}C||(_=I(_),typeof h=="string"?_!=null&&we(_):ne(h,b,_))}function Ne(h){Xe.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}j(Ne,Xe);var et=/^https?$/i,kt=["POST","PUT"];n=Ne.prototype,n.Fa=function(h){this.H=h},n.ea=function(h,b,_,C){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);b=b?b.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Os.g(),this.g.onreadystatechange=T(y(this.Ca,this));try{this.B=!0,this.g.open(b,String(h),!0),this.B=!1}catch(fe){Dt(this,fe);return}if(h=_||"",_=new Map(this.headers),C)if(Object.getPrototypeOf(C)===Object.prototype)for(var re in C)_.set(re,C[re]);else if(typeof C.keys=="function"&&typeof C.get=="function")for(const fe of C.keys())_.set(fe,C.get(fe));else throw Error("Unknown input type for opt_headers: "+String(C));C=Array.from(_.keys()).find(fe=>fe.toLowerCase()=="content-type"),re=d.FormData&&h instanceof d.FormData,!(Array.prototype.indexOf.call(kt,b,void 0)>=0)||C||re||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[fe,Ye]of _)this.g.setRequestHeader(fe,Ye);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(fe){Dt(this,fe)}};function Dt(h,b){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=b,h.o=5,ot(h),$t(h)}function ot(h){h.A||(h.A=!0,rt(h,"complete"),rt(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,rt(this,"complete"),rt(this,"abort"),$t(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),$t(this,!0)),Ne.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Bt(this):this.Xa())},n.Xa=function(){Bt(this)};function Bt(h){if(h.h&&typeof u<"u"){if(h.v&&rs(h)==4)setTimeout(h.Ca.bind(h),0);else if(rt(h,"readystatechange"),rs(h)==4){h.h=!1;try{const fe=h.ca();e:switch(fe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var _;if(!(_=b)){var C;if(C=fe===0){let Ye=String(h.D).match(Ht)[1]||null;!Ye&&d.self&&d.self.location&&(Ye=d.self.location.protocol.slice(0,-1)),C=!et.test(Ye?Ye.toLowerCase():"")}_=C}if(_)rt(h,"complete"),rt(h,"success");else{h.o=6;try{var re=rs(h)>2?h.g.statusText:""}catch{re=""}h.l=re+" ["+h.ca()+"]",ot(h)}}finally{$t(h)}}}}function $t(h,b){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const _=h.g;h.g=null,b||rt(h,"ready");try{_.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function rs(h){return h.g?h.g.readyState:0}n.ca=function(){try{return rs(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(h){if(this.g){var b=this.g.responseText;return h&&b.indexOf(h)==0&&(b=b.substring(h.length)),Ps(b)}};function Ft(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function xs(h){const b={};h=(h.g&&rs(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let C=0;C<h.length;C++){if(M(h[C]))continue;var _=Te(h[C]);const re=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const fe=b[re]||[];b[re]=fe,fe.push(_)}ee(b,function(C){return C.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Fn(h,b,_){return _&&_.internalChannelParams&&_.internalChannelParams[h]||b}function ur(h){this.za=0,this.i=[],this.j=new Et,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Fn("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Fn("baseRetryDelayMs",5e3,h),this.Za=Fn("retryDelaySeedMs",1e4,h),this.Ta=Fn("forwardChannelMaxRetries",2,h),this.va=Fn("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new P(h&&h.concurrentRequestLimit),this.Ba=new kr,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=ur.prototype,n.ka=8,n.I=1,n.connect=function(h,b,_,C){de(0),this.W=h,this.H=b||{},_&&C!==void 0&&(this.H.OSID=_,this.H.OAID=C),this.F=this.X,this.J=oa(this,null,this.W),dn(this)};function Js(h){if(zn(h),h.I==3){var b=h.V++,_=ls(h.J);if(ne(_,"SID",h.M),ne(_,"RID",b),ne(_,"TYPE","terminate"),Kn(h,_),b=new Ee(h,h.j,b),b.M=2,b.A=Ke(ls(_)),_=!1,d.navigator&&d.navigator.sendBeacon)try{_=d.navigator.sendBeacon(b.A.toString(),"")}catch{}!_&&d.Image&&(new Image().src=b.A,_=!0),_||(b.g=Wu(b.j,null),b.g.ea(b.A)),b.F=Date.now(),ln(b)}ia(h)}function Ks(h){h.g&&(hr(h),h.g.cancel(),h.g=null)}function zn(h){Ks(h),h.v&&(d.clearTimeout(h.v),h.v=null),Ha(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&d.clearTimeout(h.m),h.m=null)}function dn(h){if(!U(h.h)&&!h.m){h.m=!0;var b=h.Ea;ve||E(),_e||(ve(),_e=!0),R.add(b,h),h.D=0}}function On(h,b){return me(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=b.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=At(y(h.Ea,h,b),sl(h,h.D)),h.D++,!0)}n.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const re=new Ee(this,this.j,h);let fe=this.o;if(this.U&&(fe?(fe=L(fe),De(fe,this.U)):fe=this.U),this.u!==null||this.R||(re.J=fe,fe=null),this.S)e:{for(var b=0,_=0;_<this.i.length;_++){t:{var C=this.i[_];if("__data__"in C.map&&(C=C.map.__data__,typeof C=="string")){C=C.length;break t}C=void 0}if(C===void 0)break;if(b+=C,b>4096){b=_;break e}if(b===4096||_===this.i.length-1){b=_+1;break e}}b=1e3}else b=1e3;b=dr(this,re,b),_=ls(this.J),ne(_,"RID",h),ne(_,"CVER",22),this.G&&ne(_,"X-HTTP-Session-Id",this.G),Kn(this,_),fe&&(this.R?b="headers="+we(I(fe))+"&"+b:this.u&&Z(_,this.u,fe)),Ue(this.h,re),this.Ra&&ne(_,"TYPE","init"),this.S?(ne(_,"$req",b),ne(_,"SID","null"),re.U=!0,st(re,_,null)):st(re,_,b),this.I=2}}else this.I==3&&(h?nr(this,h):this.i.length==0||U(this.h)||nr(this))};function nr(h,b){var _;b?_=b.l:_=h.V++;const C=ls(h.J);ne(C,"SID",h.M),ne(C,"RID",_),ne(C,"AID",h.K),Kn(h,C),h.u&&h.o&&Z(C,h.u,h.o),_=new Ee(h,h.j,_,h.D+1),h.u===null&&(_.J=h.o),b&&(h.i=b.G.concat(h.i)),b=dr(h,_,1e3),_.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),Ue(h.h,_),st(_,C,b)}function Kn(h,b){h.H&&We(h.H,function(_,C){ne(b,C,_)}),h.l&&We({},function(_,C){ne(b,C,_)})}function dr(h,b,_){_=Math.min(h.i.length,_);const C=h.l?y(h.l.Ka,h.l,h):null;e:{var re=h.i;let Zt=-1;for(;;){const jn=["count="+_];Zt==-1?_>0?(Zt=re[0].g,jn.push("ofs="+Zt)):Zt=0:jn.push("ofs="+Zt);let Vs=!0;for(let rn=0;rn<_;rn++){var fe=re[rn].g;const Kr=re[rn].map;if(fe-=Zt,fe<0)Zt=Math.max(0,re[rn].g-100),Vs=!1;else try{fe="req"+fe+"_"||"";try{var Ye=Kr instanceof Map?Kr:Object.entries(Kr);for(const[Ea,la]of Ye){let ca=la;p(la)&&(ca=Ot(la)),jn.push(fe+Ea+"="+encodeURIComponent(ca))}}catch(Ea){throw jn.push(fe+"type="+encodeURIComponent("_badmap")),Ea}}catch{C&&C(Kr)}}if(Vs){Ye=jn.join("&");break e}}Ye=void 0}return h=h.i.splice(0,_),b.G=h,Ye}function rr(h){if(!h.g&&!h.v){h.Y=1;var b=h.Da;ve||E(),_e||(ve(),_e=!0),R.add(b,h),h.A=0}}function gn(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=At(y(h.Da,h),sl(h,h.A)),h.A++,!0)}n.Da=function(){if(this.v=null,Tr(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=At(y(this.Wa,this),h)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,de(10),Ks(this),Tr(this))};function hr(h){h.B!=null&&(d.clearTimeout(h.B),h.B=null)}function Tr(h){h.g=new Ee(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var b=ls(h.na);ne(b,"RID","rpc"),ne(b,"SID",h.M),ne(b,"AID",h.K),ne(b,"CI",h.F?"0":"1"),!h.F&&h.ia&&ne(b,"TO",h.ia),ne(b,"TYPE","xmlhttp"),Kn(h,b),h.u&&h.o&&Z(b,h.u,h.o),h.O&&(h.g.H=h.O);var _=h.g;h=h.ba,_.M=1,_.A=Ke(ls(b)),_.u=null,_.R=!0,vt(_,h)}n.Va=function(){this.C!=null&&(this.C=null,Ks(this),gn(this),de(19))};function Ha(h){h.C!=null&&(d.clearTimeout(h.C),h.C=null)}function tl(h,b){var _=null;if(h.g==b){Ha(h),hr(h),h.g=null;var C=2}else if(Be(h.h,b))_=b.G,Je(h.h,b),C=1;else return;if(h.I!=0){if(b.o)if(C==1){_=b.u?b.u.length:0,b=Date.now()-b.F;var re=h.D;C=Ae(),rt(C,new tt(C,_)),dn(h)}else rr(h);else if(re=b.m,re==3||re==0&&b.X>0||!(C==1&&On(h,b)||C==2&&gn(h)))switch(_&&_.length>0&&(b=h.h,b.i=b.i.concat(_)),re){case 1:mr(h,5);break;case 4:mr(h,10);break;case 3:mr(h,6);break;default:mr(h,2)}}}function sl(h,b){let _=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(_*=2),_*b}function mr(h,b){if(h.j.info("Error code "+b),b==2){var _=y(h.bb,h),C=h.Ua;const re=!C;C=new os(C||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||Cs(C,"https"),Ke(C),re?tn(C.toString(),_):Ln(C.toString(),_)}else de(2);h.I=0,h.l&&h.l.pa(b),ia(h),zn(h)}n.bb=function(h){h?(this.j.info("Successfully pinged google.com"),de(2)):(this.j.info("Failed to ping google.com"),de(1))};function ia(h){if(h.I=0,h.ja=[],h.l){const b=Ze(h.h);(b.length!=0||h.i.length!=0)&&($(h.ja,b),$(h.ja,h.i),h.h.i.length=0,O(h.i),h.i.length=0),h.l.oa()}}function oa(h,b,_){var C=_ instanceof os?ls(_):new os(_);if(C.g!="")b&&(C.g=b+"."+C.g),Y(C,C.u);else{var re=d.location;C=re.protocol,b=b?b+"."+re.hostname:re.hostname,re=+re.port;const fe=new os(null);C&&Cs(fe,C),b&&(fe.g=b),re&&Y(fe,re),_&&(fe.h=_),C=fe}return _=h.G,b=h.wa,_&&b&&ne(C,_,b),ne(C,"VER",h.ka),Kn(h,C),C}function Wu(h,b,_){if(b&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return b=h.Aa&&!h.ma?new Ne(new jr({ab:_})):new Ne(h.ma),b.Fa(h.L),b}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Gu(){}n=Gu.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function _i(){}_i.prototype.g=function(h,b){return new fr(h,b)};function fr(h,b){Xe.call(this),this.g=new ur(b),this.l=h,this.h=b&&b.messageUrlParams||null,h=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(h?h["X-WebChannel-Content-Type"]=b.messageContentType:h={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.sa&&(h?h["X-WebChannel-Client-Profile"]=b.sa:h={"X-WebChannel-Client-Profile":b.sa}),this.g.U=h,(h=b&&b.Qb)&&!M(h)&&(this.g.u=h),this.A=b&&b.supportsCrossDomainXhr||!1,this.v=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!M(b)&&(this.g.G=b,h=this.h,h!==null&&b in h&&(h=this.h,b in h&&delete h[b])),this.j=new $a(this)}j(fr,Xe),fr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},fr.prototype.close=function(){Js(this.g)},fr.prototype.o=function(h){var b=this.g;if(typeof h=="string"){var _={};_.__data__=h,h=_}else this.v&&(_={},_.__data__=Ot(h),h=_);b.i.push(new N(b.Ya++,h)),b.I==3&&dn(b)},fr.prototype.N=function(){this.g.l=null,delete this.j,Js(this.g),delete this.g,fr.Z.N.call(this)};function Ku(h){X.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var b=h.__sm__;if(b){e:{for(const _ in b){h=_;break e}h=void 0}(this.i=h)&&(h=this.i,b=b!==null&&h in b?b[h]:void 0),this.data=b}else this.data=h}j(Ku,X);function Yu(){he.call(this),this.status=1}j(Yu,he);function $a(h){this.g=h}j($a,Gu),$a.prototype.ra=function(){rt(this.g,"a")},$a.prototype.qa=function(h){rt(this.g,new Ku(h))},$a.prototype.pa=function(h){rt(this.g,new Yu)},$a.prototype.oa=function(){rt(this.g,"b")},_i.prototype.createWebChannel=_i.prototype.g,fr.prototype.send=fr.prototype.o,fr.prototype.open=fr.prototype.m,fr.prototype.close=fr.prototype.close,Yw=function(){return new _i},Kw=function(){return Ae()},Gw=Pe,fg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},is.NO_ERROR=0,is.TIMEOUT=8,is.HTTP_ERROR=6,xh=is,Ns.COMPLETE="complete",Ww=Ns,Ie.EventType=Ge,Ge.OPEN="a",Ge.CLOSE="b",Ge.ERROR="c",Ge.MESSAGE="d",Xe.prototype.listen=Xe.prototype.J,su=Ie,Ne.prototype.listenOnce=Ne.prototype.K,Ne.prototype.getLastError=Ne.prototype.Ha,Ne.prototype.getLastErrorCode=Ne.prototype.ya,Ne.prototype.getStatus=Ne.prototype.ca,Ne.prototype.getResponseJson=Ne.prototype.La,Ne.prototype.getResponseText=Ne.prototype.la,Ne.prototype.send=Ne.prototype.ea,Ne.prototype.setWithCredentials=Ne.prototype.Fa,$w=Ne}).apply(typeof th<"u"?th:typeof self<"u"?self:typeof window<"u"?window:{});class or{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}or.UNAUTHENTICATED=new or(null),or.GOOGLE_CREDENTIALS=new or("google-credentials-uid"),or.FIRST_PARTY=new or("first-party-uid"),or.MOCK_USER=new or("mock-user");let ac="12.8.0";function cR(n){ac=n}const Ko=new $g("@firebase/firestore");function Bl(){return Ko.logLevel}function ct(n,...e){if(Ko.logLevel<=ps.DEBUG){const t=e.map(ry);Ko.debug(`Firestore (${ac}): ${n}`,...t)}}function gi(n,...e){if(Ko.logLevel<=ps.ERROR){const t=e.map(ry);Ko.error(`Firestore (${ac}): ${n}`,...t)}}function Yl(n,...e){if(Ko.logLevel<=ps.WARN){const t=e.map(ry);Ko.warn(`Firestore (${ac}): ${n}`,...t)}}function ry(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Lt(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,Qw(n,i,t)}function Qw(n,e,t){let i=`FIRESTORE (${ac}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw gi(i),new Error(i)}function Us(n,e,t,i){let l="Unexpected state";typeof t=="string"?l=t:i=t,n||Qw(e,l,i)}function Qt(n,e){return n}const Ce={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class nt extends qa{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class di{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Xw{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class uR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(or.UNAUTHENTICATED)))}shutdown(){}}class dR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class hR{constructor(e){this.t=e,this.currentUser=or.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Us(this.o===void 0,42304);let i=this.i;const l=g=>this.i!==i?(i=this.i,t(g)):Promise.resolve();let u=new di;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new di,e.enqueueRetryable((()=>l(this.currentUser)))};const d=()=>{const g=u;e.enqueueRetryable((async()=>{await g.promise,await l(this.currentUser)}))},p=g=>{ct("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((g=>p(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?p(g):(ct("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new di)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(ct("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Us(typeof i.accessToken=="string",31837,{l:i}),new Xw(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Us(e===null||typeof e=="string",2055,{h:e}),new or(e)}}class mR{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=or.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class fR{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new mR(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(or.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class gx{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class pR{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,qr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Us(this.o===void 0,3512);const i=u=>{u.error!=null&&ct("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const d=u.token!==this.m;return this.m=u.token,ct("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable((()=>i(u)))};const l=u=>{ct("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>l(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?l(u):ct("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new gx(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Us(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new gx(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function gR(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class ay{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const l=gR(40);for(let u=0;u<l.length;++u)i.length<20&&l[u]<t&&(i+=e.charAt(l[u]%62))}return i}}function gs(n,e){return n<e?-1:n>e?1:0}function pg(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const l=n.charAt(i),u=e.charAt(i);if(l!==u)return Ip(l)===Ip(u)?gs(l,u):Ip(l)?1:-1}return gs(n.length,e.length)}const yR=55296,bR=57343;function Ip(n){const e=n.charCodeAt(0);return e>=yR&&e<=bR}function Ql(n,e,t){return n.length===e.length&&n.every(((i,l)=>t(i,e[l])))}const yx="__name__";class Ia{constructor(e,t,i){t===void 0?t=0:t>e.length&&Lt(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Lt(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Ia.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ia?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let l=0;l<i;l++){const u=Ia.compareSegments(e.get(l),t.get(l));if(u!==0)return u}return gs(e.length,t.length)}static compareSegments(e,t){const i=Ia.isNumericId(e),l=Ia.isNumericId(t);return i&&!l?-1:!i&&l?1:i&&l?Ia.extractNumericId(e).compare(Ia.extractNumericId(t)):pg(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ro.fromString(e.substring(4,e.length-2))}}class Zs extends Ia{construct(e,t,i){return new Zs(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new nt(Ce.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((l=>l.length>0)))}return new Zs(t)}static emptyPath(){return new Zs([])}}const vR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class er extends Ia{construct(e,t,i){return new er(e,t,i)}static isValidIdentifier(e){return vR.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),er.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===yx}static keyField(){return new er([yx])}static fromServerFormat(e){const t=[];let i="",l=0;const u=()=>{if(i.length===0)throw new nt(Ce.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let d=!1;for(;l<e.length;){const p=e[l];if(p==="\\"){if(l+1===e.length)throw new nt(Ce.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[l+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new nt(Ce.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=g,l+=2}else p==="`"?(d=!d,l++):p!=="."||d?(i+=p,l++):(u(),l++)}if(u(),d)throw new nt(Ce.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new er(t)}static emptyPath(){return new er([])}}class Nt{constructor(e){this.path=e}static fromPath(e){return new Nt(Zs.fromString(e))}static fromName(e){return new Nt(Zs.fromString(e).popFirst(5))}static empty(){return new Nt(Zs.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Zs.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Zs.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Nt(new Zs(e.slice()))}}function Jw(n,e,t){if(!t)throw new nt(Ce.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function xR(n,e,t,i){if(e===!0&&i===!0)throw new nt(Ce.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function bx(n){if(!Nt.isDocumentKey(n))throw new nt(Ce.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function vx(n){if(Nt.isDocumentKey(n))throw new nt(Ce.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Zw(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function sm(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Lt(12329,{type:typeof n})}function vr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new nt(Ce.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=sm(n);throw new nt(Ce.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function wR(n,e){if(e<=0)throw new nt(Ce.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function Pn(n,e){const t={typeString:n};return e&&(t.value=e),t}function Pu(n,e){if(!Zw(n))throw new nt(Ce.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const l=e[i].typeString,u="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const d=n[i];if(l&&typeof d!==l){t=`JSON field '${i}' must be a ${l}.`;break}if(u!==void 0&&d!==u.value){t=`Expected '${i}' field to equal '${u.value}'`;break}}if(t)throw new nt(Ce.INVALID_ARGUMENT,t);return!0}const xx=-62135596800,wx=1e6;class xt{static now(){return xt.fromMillis(Date.now())}static fromDate(e){return xt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*wx);return new xt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new nt(Ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new nt(Ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<xx)throw new nt(Ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new nt(Ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/wx}_compareTo(e){return this.seconds===e.seconds?gs(this.nanoseconds,e.nanoseconds):gs(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:xt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Pu(e,xt._jsonSchema))return new xt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-xx;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}xt._jsonSchemaVersion="firestore/timestamp/1.0",xt._jsonSchema={type:Pn("string",xt._jsonSchemaVersion),seconds:Pn("number"),nanoseconds:Pn("number")};class Wt{static fromTimestamp(e){return new Wt(e)}static min(){return new Wt(new xt(0,0))}static max(){return new Wt(new xt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const bu=-1;function _R(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,l=Wt.fromTimestamp(i===1e9?new xt(t+1,0):new xt(t,i));return new oo(l,Nt.empty(),e)}function kR(n){return new oo(n.readTime,n.key,bu)}class oo{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new oo(Wt.min(),Nt.empty(),bu)}static max(){return new oo(Wt.max(),Nt.empty(),bu)}}function jR(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Nt.comparator(n.documentKey,e.documentKey),t!==0?t:gs(n.largestBatchId,e.largestBatchId))}const TR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ER{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function ic(n){if(n.code!==Ce.FAILED_PRECONDITION||n.message!==TR)throw n;ct("LocalStore","Unexpectedly lost primary lease")}class Oe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Lt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Oe(((i,l)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(i,l)},this.catchCallback=u=>{this.wrapFailure(t,u).next(i,l)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Oe?t:Oe.resolve(t)}catch(t){return Oe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Oe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Oe.reject(t)}static resolve(e){return new Oe(((t,i)=>{t(e)}))}static reject(e){return new Oe(((t,i)=>{i(e)}))}static waitFor(e){return new Oe(((t,i)=>{let l=0,u=0,d=!1;e.forEach((p=>{++l,p.next((()=>{++u,d&&u===l&&t()}),(g=>i(g)))})),d=!0,u===l&&t()}))}static or(e){let t=Oe.resolve(!1);for(const i of e)t=t.next((l=>l?Oe.resolve(l):i()));return t}static forEach(e,t){const i=[];return e.forEach(((l,u)=>{i.push(t.call(this,l,u))})),this.waitFor(i)}static mapArray(e,t){return new Oe(((i,l)=>{const u=e.length,d=new Array(u);let p=0;for(let g=0;g<u;g++){const y=g;t(e[y]).next((w=>{d[y]=w,++p,p===u&&i(d)}),(w=>l(w)))}}))}static doWhile(e,t){return new Oe(((i,l)=>{const u=()=>{e()===!0?t().next((()=>{u()}),l):i()};u()}))}}function SR(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function oc(n){return n.name==="IndexedDbTransactionError"}class nm{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}nm.ce=-1;const iy=-1;function rm(n){return n==null}function Lh(n){return n===0&&1/n==-1/0}function NR(n){return typeof n=="number"&&Number.isInteger(n)&&!Lh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const e_="";function CR(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=_x(e)),e=RR(n.get(t),e);return _x(e)}function RR(n,e){let t=e;const i=n.length;for(let l=0;l<i;l++){const u=n.charAt(l);switch(u){case"\0":t+="";break;case e_:t+="";break;default:t+=u}}return t}function _x(n){return n+e_+""}function kx(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function go(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function t_(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class hn{constructor(e,t){this.comparator=e,this.root=t||Zn.EMPTY}insert(e,t){return new hn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Zn.BLACK,null,null))}remove(e){return new hn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Zn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const l=this.comparator(e,i.key);if(l===0)return t+i.left.size;l<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new sh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new sh(this.root,e,this.comparator,!1)}getReverseIterator(){return new sh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new sh(this.root,e,this.comparator,!0)}}class sh{constructor(e,t,i,l){this.isReverse=l,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=t?i(e.key,t):1,t&&l&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Zn{constructor(e,t,i,l,u){this.key=e,this.value=t,this.color=i??Zn.RED,this.left=l??Zn.EMPTY,this.right=u??Zn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,l,u){return new Zn(e??this.key,t??this.value,i??this.color,l??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let l=this;const u=i(e,l.key);return l=u<0?l.copy(null,null,null,l.left.insert(e,t,i),null):u===0?l.copy(null,t,null,null,null):l.copy(null,null,null,null,l.right.insert(e,t,i)),l.fixUp()}removeMin(){if(this.left.isEmpty())return Zn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,l=this;if(t(e,l.key)<0)l.left.isEmpty()||l.left.isRed()||l.left.left.isRed()||(l=l.moveRedLeft()),l=l.copy(null,null,null,l.left.remove(e,t),null);else{if(l.left.isRed()&&(l=l.rotateRight()),l.right.isEmpty()||l.right.isRed()||l.right.left.isRed()||(l=l.moveRedRight()),t(e,l.key)===0){if(l.right.isEmpty())return Zn.EMPTY;i=l.right.min(),l=l.copy(i.key,i.value,null,null,l.right.removeMin())}l=l.copy(null,null,null,null,l.right.remove(e,t))}return l.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Zn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Zn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Lt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Lt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Lt(27949);return e+(this.isRed()?0:1)}}Zn.EMPTY=null,Zn.RED=!0,Zn.BLACK=!1;Zn.EMPTY=new class{constructor(){this.size=0}get key(){throw Lt(57766)}get value(){throw Lt(16141)}get color(){throw Lt(16727)}get left(){throw Lt(29726)}get right(){throw Lt(36894)}copy(e,t,i,l,u){return this}insert(e,t,i){return new Zn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Bn{constructor(e){this.comparator=e,this.data=new hn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const l=i.getNext();if(this.comparator(l.key,e[1])>=0)return;t(l.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new jx(this.data.getIterator())}getIteratorFrom(e){return new jx(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Bn)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(this.comparator(l,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Bn(this.comparator);return t.data=e,t}}class jx{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class $r{constructor(e){this.fields=e,e.sort(er.comparator)}static empty(){return new $r([])}unionWith(e){let t=new Bn(er.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new $r(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ql(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class s_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class tr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(l){try{return atob(l)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new s_("Invalid base64 string: "+u):u}})(e);return new tr(t)}static fromUint8Array(e){const t=(function(l){let u="";for(let d=0;d<l.length;++d)u+=String.fromCharCode(l[d]);return u})(e);return new tr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return gs(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}tr.EMPTY_BYTE_STRING=new tr("");const AR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function lo(n){if(Us(!!n,39018),typeof n=="string"){let e=0;const t=AR.exec(n);if(Us(!!t,46558,{timestamp:n}),t[1]){let l=t[1];l=(l+"000000000").substr(0,9),e=Number(l)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Sn(n.seconds),nanos:Sn(n.nanos)}}function Sn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function co(n){return typeof n=="string"?tr.fromBase64String(n):tr.fromUint8Array(n)}const n_="server_timestamp",r_="__type__",a_="__previous_value__",i_="__local_write_time__";function oy(n){return(n?.mapValue?.fields||{})[r_]?.stringValue===n_}function am(n){const e=n.mapValue.fields[a_];return oy(e)?am(e):e}function vu(n){const e=lo(n.mapValue.fields[i_].timestampValue);return new xt(e.seconds,e.nanos)}class IR{constructor(e,t,i,l,u,d,p,g,y,w,j){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=l,this.ssl=u,this.forceLongPolling=d,this.autoDetectLongPolling=p,this.longPollingOptions=g,this.useFetchStreams=y,this.isUsingEmulator=w,this.apiKey=j}}const Oh="(default)";class xu{constructor(e,t){this.projectId=e,this.database=t||Oh}static empty(){return new xu("","")}get isDefaultDatabase(){return this.database===Oh}isEqual(e){return e instanceof xu&&e.projectId===this.projectId&&e.database===this.database}}function MR(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new nt(Ce.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new xu(n.options.projectId,e)}const o_="__type__",DR="__max__",nh={mapValue:{}},l_="__vector__",Vh="value";function uo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?oy(n)?4:LR(n)?9007199254740991:PR(n)?10:11:Lt(28295,{value:n})}function Fa(n,e){if(n===e)return!0;const t=uo(n);if(t!==uo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return vu(n).isEqual(vu(e));case 3:return(function(l,u){if(typeof l.timestampValue=="string"&&typeof u.timestampValue=="string"&&l.timestampValue.length===u.timestampValue.length)return l.timestampValue===u.timestampValue;const d=lo(l.timestampValue),p=lo(u.timestampValue);return d.seconds===p.seconds&&d.nanos===p.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(l,u){return co(l.bytesValue).isEqual(co(u.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(l,u){return Sn(l.geoPointValue.latitude)===Sn(u.geoPointValue.latitude)&&Sn(l.geoPointValue.longitude)===Sn(u.geoPointValue.longitude)})(n,e);case 2:return(function(l,u){if("integerValue"in l&&"integerValue"in u)return Sn(l.integerValue)===Sn(u.integerValue);if("doubleValue"in l&&"doubleValue"in u){const d=Sn(l.doubleValue),p=Sn(u.doubleValue);return d===p?Lh(d)===Lh(p):isNaN(d)&&isNaN(p)}return!1})(n,e);case 9:return Ql(n.arrayValue.values||[],e.arrayValue.values||[],Fa);case 10:case 11:return(function(l,u){const d=l.mapValue.fields||{},p=u.mapValue.fields||{};if(kx(d)!==kx(p))return!1;for(const g in d)if(d.hasOwnProperty(g)&&(p[g]===void 0||!Fa(d[g],p[g])))return!1;return!0})(n,e);default:return Lt(52216,{left:n})}}function wu(n,e){return(n.values||[]).find((t=>Fa(t,e)))!==void 0}function Xl(n,e){if(n===e)return 0;const t=uo(n),i=uo(e);if(t!==i)return gs(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return gs(n.booleanValue,e.booleanValue);case 2:return(function(u,d){const p=Sn(u.integerValue||u.doubleValue),g=Sn(d.integerValue||d.doubleValue);return p<g?-1:p>g?1:p===g?0:isNaN(p)?isNaN(g)?0:-1:1})(n,e);case 3:return Tx(n.timestampValue,e.timestampValue);case 4:return Tx(vu(n),vu(e));case 5:return pg(n.stringValue,e.stringValue);case 6:return(function(u,d){const p=co(u),g=co(d);return p.compareTo(g)})(n.bytesValue,e.bytesValue);case 7:return(function(u,d){const p=u.split("/"),g=d.split("/");for(let y=0;y<p.length&&y<g.length;y++){const w=gs(p[y],g[y]);if(w!==0)return w}return gs(p.length,g.length)})(n.referenceValue,e.referenceValue);case 8:return(function(u,d){const p=gs(Sn(u.latitude),Sn(d.latitude));return p!==0?p:gs(Sn(u.longitude),Sn(d.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Ex(n.arrayValue,e.arrayValue);case 10:return(function(u,d){const p=u.fields||{},g=d.fields||{},y=p[Vh]?.arrayValue,w=g[Vh]?.arrayValue,j=gs(y?.values?.length||0,w?.values?.length||0);return j!==0?j:Ex(y,w)})(n.mapValue,e.mapValue);case 11:return(function(u,d){if(u===nh.mapValue&&d===nh.mapValue)return 0;if(u===nh.mapValue)return 1;if(d===nh.mapValue)return-1;const p=u.fields||{},g=Object.keys(p),y=d.fields||{},w=Object.keys(y);g.sort(),w.sort();for(let j=0;j<g.length&&j<w.length;++j){const T=pg(g[j],w[j]);if(T!==0)return T;const O=Xl(p[g[j]],y[w[j]]);if(O!==0)return O}return gs(g.length,w.length)})(n.mapValue,e.mapValue);default:throw Lt(23264,{he:t})}}function Tx(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return gs(n,e);const t=lo(n),i=lo(e),l=gs(t.seconds,i.seconds);return l!==0?l:gs(t.nanos,i.nanos)}function Ex(n,e){const t=n.values||[],i=e.values||[];for(let l=0;l<t.length&&l<i.length;++l){const u=Xl(t[l],i[l]);if(u)return u}return gs(t.length,i.length)}function Jl(n){return gg(n)}function gg(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=lo(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return co(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Nt.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",l=!0;for(const u of t.values||[])l?l=!1:i+=",",i+=gg(u);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let l="{",u=!0;for(const d of i)u?u=!1:l+=",",l+=`${d}:${gg(t.fields[d])}`;return l+"}"})(n.mapValue):Lt(61005,{value:n})}function wh(n){switch(uo(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=am(n);return e?16+wh(e):16;case 5:return 2*n.stringValue.length;case 6:return co(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((l,u)=>l+wh(u)),0)})(n.arrayValue);case 10:case 11:return(function(i){let l=0;return go(i.fields,((u,d)=>{l+=u.length+wh(d)})),l})(n.mapValue);default:throw Lt(13486,{value:n})}}function Sx(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function yg(n){return!!n&&"integerValue"in n}function ly(n){return!!n&&"arrayValue"in n}function Nx(n){return!!n&&"nullValue"in n}function Cx(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function _h(n){return!!n&&"mapValue"in n}function PR(n){return(n?.mapValue?.fields||{})[o_]?.stringValue===l_}function lu(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return go(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=lu(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=lu(n.arrayValue.values[t]);return e}return{...n}}function LR(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===DR}class Ir{constructor(e){this.value=e}static empty(){return new Ir({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!_h(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=lu(t)}setAll(e){let t=er.emptyPath(),i={},l=[];e.forEach(((d,p)=>{if(!t.isImmediateParentOf(p)){const g=this.getFieldsMap(t);this.applyChanges(g,i,l),i={},l=[],t=p.popLast()}d?i[p.lastSegment()]=lu(d):l.push(p.lastSegment())}));const u=this.getFieldsMap(t);this.applyChanges(u,i,l)}delete(e){const t=this.field(e.popLast());_h(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Fa(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let l=t.mapValue.fields[e.get(i)];_h(l)&&l.mapValue.fields||(l={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=l),t=l}return t.mapValue.fields}applyChanges(e,t,i){go(t,((l,u)=>e[l]=u));for(const l of i)delete e[l]}clone(){return new Ir(lu(this.value))}}function c_(n){const e=[];return go(n.fields,((t,i)=>{const l=new er([t]);if(_h(i)){const u=c_(i.mapValue).fields;if(u.length===0)e.push(l);else for(const d of u)e.push(l.child(d))}else e.push(l)})),new $r(e)}class lr{constructor(e,t,i,l,u,d,p){this.key=e,this.documentType=t,this.version=i,this.readTime=l,this.createTime=u,this.data=d,this.documentState=p}static newInvalidDocument(e){return new lr(e,0,Wt.min(),Wt.min(),Wt.min(),Ir.empty(),0)}static newFoundDocument(e,t,i,l){return new lr(e,1,t,Wt.min(),i,l,0)}static newNoDocument(e,t){return new lr(e,2,t,Wt.min(),Wt.min(),Ir.empty(),0)}static newUnknownDocument(e,t){return new lr(e,3,t,Wt.min(),Wt.min(),Ir.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Wt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ir.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ir.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Wt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof lr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new lr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Bh{constructor(e,t){this.position=e,this.inclusive=t}}function Rx(n,e,t){let i=0;for(let l=0;l<n.position.length;l++){const u=e[l],d=n.position[l];if(u.field.isKeyField()?i=Nt.comparator(Nt.fromName(d.referenceValue),t.key):i=Xl(d,t.data.field(u.field)),u.dir==="desc"&&(i*=-1),i!==0)break}return i}function Ax(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Fa(n.position[t],e.position[t]))return!1;return!0}class _u{constructor(e,t="asc"){this.field=e,this.dir=t}}function OR(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class u_{}class Dn extends u_{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new BR(e,t,i):t==="array-contains"?new zR(e,i):t==="in"?new qR(e,i):t==="not-in"?new HR(e,i):t==="array-contains-any"?new $R(e,i):new Dn(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new UR(e,i):new FR(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Xl(t,this.value)):t!==null&&uo(this.value)===uo(t)&&this.matchesComparison(Xl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Lt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class va extends u_{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new va(e,t)}matches(e){return d_(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function d_(n){return n.op==="and"}function h_(n){return VR(n)&&d_(n)}function VR(n){for(const e of n.filters)if(e instanceof va)return!1;return!0}function bg(n){if(n instanceof Dn)return n.field.canonicalString()+n.op.toString()+Jl(n.value);if(h_(n))return n.filters.map((e=>bg(e))).join(",");{const e=n.filters.map((t=>bg(t))).join(",");return`${n.op}(${e})`}}function m_(n,e){return n instanceof Dn?(function(i,l){return l instanceof Dn&&i.op===l.op&&i.field.isEqual(l.field)&&Fa(i.value,l.value)})(n,e):n instanceof va?(function(i,l){return l instanceof va&&i.op===l.op&&i.filters.length===l.filters.length?i.filters.reduce(((u,d,p)=>u&&m_(d,l.filters[p])),!0):!1})(n,e):void Lt(19439)}function f_(n){return n instanceof Dn?(function(t){return`${t.field.canonicalString()} ${t.op} ${Jl(t.value)}`})(n):n instanceof va?(function(t){return t.op.toString()+" {"+t.getFilters().map(f_).join(" ,")+"}"})(n):"Filter"}class BR extends Dn{constructor(e,t,i){super(e,t,i),this.key=Nt.fromName(i.referenceValue)}matches(e){const t=Nt.comparator(e.key,this.key);return this.matchesComparison(t)}}class UR extends Dn{constructor(e,t){super(e,"in",t),this.keys=p_("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class FR extends Dn{constructor(e,t){super(e,"not-in",t),this.keys=p_("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function p_(n,e){return(e.arrayValue?.values||[]).map((t=>Nt.fromName(t.referenceValue)))}class zR extends Dn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return ly(t)&&wu(t.arrayValue,this.value)}}class qR extends Dn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&wu(this.value.arrayValue,t)}}class HR extends Dn{constructor(e,t){super(e,"not-in",t)}matches(e){if(wu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!wu(this.value.arrayValue,t)}}class $R extends Dn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!ly(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>wu(this.value.arrayValue,i)))}}class WR{constructor(e,t=null,i=[],l=[],u=null,d=null,p=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=l,this.limit=u,this.startAt=d,this.endAt=p,this.Te=null}}function Ix(n,e=null,t=[],i=[],l=null,u=null,d=null){return new WR(n,e,t,i,l,u,d)}function cy(n){const e=Qt(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>bg(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(u){return u.field.canonicalString()+u.dir})(i))).join(","),rm(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Jl(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Jl(i))).join(",")),e.Te=t}return e.Te}function uy(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!OR(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!m_(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Ax(n.startAt,e.startAt)&&Ax(n.endAt,e.endAt)}function vg(n){return Nt.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class lc{constructor(e,t=null,i=[],l=[],u=null,d="F",p=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=l,this.limit=u,this.limitType=d,this.startAt=p,this.endAt=g,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function GR(n,e,t,i,l,u,d,p){return new lc(n,e,t,i,l,u,d,p)}function im(n){return new lc(n)}function Mx(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function KR(n){return Nt.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function g_(n){return n.collectionGroup!==null}function cu(n){const e=Qt(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const u of e.explicitOrderBy)e.Ie.push(u),t.add(u.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let p=new Bn(er.comparator);return d.filters.forEach((g=>{g.getFlattenedFilters().forEach((y=>{y.isInequality()&&(p=p.add(y.field))}))})),p})(e).forEach((u=>{t.has(u.canonicalString())||u.isKeyField()||e.Ie.push(new _u(u,i))})),t.has(er.keyField().canonicalString())||e.Ie.push(new _u(er.keyField(),i))}return e.Ie}function Va(n){const e=Qt(n);return e.Ee||(e.Ee=YR(e,cu(n))),e.Ee}function YR(n,e){if(n.limitType==="F")return Ix(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((l=>{const u=l.dir==="desc"?"asc":"desc";return new _u(l.field,u)}));const t=n.endAt?new Bh(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Bh(n.startAt.position,n.startAt.inclusive):null;return Ix(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function xg(n,e){const t=n.filters.concat([e]);return new lc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function QR(n,e){const t=n.explicitOrderBy.concat([e]);return new lc(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function Uh(n,e,t){return new lc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function om(n,e){return uy(Va(n),Va(e))&&n.limitType===e.limitType}function y_(n){return`${cy(Va(n))}|lt:${n.limitType}`}function Ul(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((l=>f_(l))).join(", ")}]`),rm(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((l=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(l))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((l=>Jl(l))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((l=>Jl(l))).join(",")),`Target(${i})`})(Va(n))}; limitType=${n.limitType})`}function lm(n,e){return e.isFoundDocument()&&(function(i,l){const u=l.key.path;return i.collectionGroup!==null?l.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(u):Nt.isDocumentKey(i.path)?i.path.isEqual(u):i.path.isImmediateParentOf(u)})(n,e)&&(function(i,l){for(const u of cu(i))if(!u.field.isKeyField()&&l.data.field(u.field)===null)return!1;return!0})(n,e)&&(function(i,l){for(const u of i.filters)if(!u.matches(l))return!1;return!0})(n,e)&&(function(i,l){return!(i.startAt&&!(function(d,p,g){const y=Rx(d,p,g);return d.inclusive?y<=0:y<0})(i.startAt,cu(i),l)||i.endAt&&!(function(d,p,g){const y=Rx(d,p,g);return d.inclusive?y>=0:y>0})(i.endAt,cu(i),l))})(n,e)}function XR(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function b_(n){return(e,t)=>{let i=!1;for(const l of cu(n)){const u=JR(l,e,t);if(u!==0)return u;i=i||l.field.isKeyField()}return 0}}function JR(n,e,t){const i=n.field.isKeyField()?Nt.comparator(e.key,t.key):(function(u,d,p){const g=d.data.field(u),y=p.data.field(u);return g!==null&&y!==null?Xl(g,y):Lt(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Lt(19790,{direction:n.dir})}}class Zo{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[l,u]of i)if(this.equalsFn(l,e))return u}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),l=this.inner[i];if(l===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let u=0;u<l.length;u++)if(this.equalsFn(l[u][0],e))return void(l[u]=[e,t]);l.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let l=0;l<i.length;l++)if(this.equalsFn(i[l][0],e))return i.length===1?delete this.inner[t]:i.splice(l,1),this.innerSize--,!0;return!1}forEach(e){go(this.inner,((t,i)=>{for(const[l,u]of i)e(l,u)}))}isEmpty(){return t_(this.inner)}size(){return this.innerSize}}const ZR=new hn(Nt.comparator);function yi(){return ZR}const v_=new hn(Nt.comparator);function nu(...n){let e=v_;for(const t of n)e=e.insert(t.key,t);return e}function x_(n){let e=v_;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Vo(){return uu()}function w_(){return uu()}function uu(){return new Zo((n=>n.toString()),((n,e)=>n.isEqual(e)))}const eA=new hn(Nt.comparator),tA=new Bn(Nt.comparator);function ys(...n){let e=tA;for(const t of n)e=e.add(t);return e}const sA=new Bn(gs);function nA(){return sA}function dy(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Lh(e)?"-0":e}}function __(n){return{integerValue:""+n}}function k_(n,e){return NR(e)?__(e):dy(n,e)}class cm{constructor(){this._=void 0}}function rA(n,e,t){return n instanceof ku?(function(l,u){const d={fields:{[r_]:{stringValue:n_},[i_]:{timestampValue:{seconds:l.seconds,nanos:l.nanoseconds}}}};return u&&oy(u)&&(u=am(u)),u&&(d.fields[a_]=u),{mapValue:d}})(t,e):n instanceof ju?T_(n,e):n instanceof Tu?E_(n,e):(function(l,u){const d=j_(l,u),p=Dx(d)+Dx(l.Ae);return yg(d)&&yg(l.Ae)?__(p):dy(l.serializer,p)})(n,e)}function aA(n,e,t){return n instanceof ju?T_(n,e):n instanceof Tu?E_(n,e):t}function j_(n,e){return n instanceof Eu?(function(i){return yg(i)||(function(u){return!!u&&"doubleValue"in u})(i)})(e)?e:{integerValue:0}:null}class ku extends cm{}class ju extends cm{constructor(e){super(),this.elements=e}}function T_(n,e){const t=S_(e);for(const i of n.elements)t.some((l=>Fa(l,i)))||t.push(i);return{arrayValue:{values:t}}}class Tu extends cm{constructor(e){super(),this.elements=e}}function E_(n,e){let t=S_(e);for(const i of n.elements)t=t.filter((l=>!Fa(l,i)));return{arrayValue:{values:t}}}class Eu extends cm{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Dx(n){return Sn(n.integerValue||n.doubleValue)}function S_(n){return ly(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class N_{constructor(e,t){this.field=e,this.transform=t}}function iA(n,e){return n.field.isEqual(e.field)&&(function(i,l){return i instanceof ju&&l instanceof ju||i instanceof Tu&&l instanceof Tu?Ql(i.elements,l.elements,Fa):i instanceof Eu&&l instanceof Eu?Fa(i.Ae,l.Ae):i instanceof ku&&l instanceof ku})(n.transform,e.transform)}class oA{constructor(e,t){this.version=e,this.transformResults=t}}class xr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new xr}static exists(e){return new xr(void 0,e)}static updateTime(e){return new xr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function kh(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class um{}function C_(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new dm(n.key,xr.none()):new Lu(n.key,n.data,xr.none());{const t=n.data,i=Ir.empty();let l=new Bn(er.comparator);for(let u of e.fields)if(!l.has(u)){let d=t.field(u);d===null&&u.length>1&&(u=u.popLast(),d=t.field(u)),d===null?i.delete(u):i.set(u,d),l=l.add(u)}return new yo(n.key,i,new $r(l.toArray()),xr.none())}}function lA(n,e,t){n instanceof Lu?(function(l,u,d){const p=l.value.clone(),g=Lx(l.fieldTransforms,u,d.transformResults);p.setAll(g),u.convertToFoundDocument(d.version,p).setHasCommittedMutations()})(n,e,t):n instanceof yo?(function(l,u,d){if(!kh(l.precondition,u))return void u.convertToUnknownDocument(d.version);const p=Lx(l.fieldTransforms,u,d.transformResults),g=u.data;g.setAll(R_(l)),g.setAll(p),u.convertToFoundDocument(d.version,g).setHasCommittedMutations()})(n,e,t):(function(l,u,d){u.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function du(n,e,t,i){return n instanceof Lu?(function(u,d,p,g){if(!kh(u.precondition,d))return p;const y=u.value.clone(),w=Ox(u.fieldTransforms,g,d);return y.setAll(w),d.convertToFoundDocument(d.version,y).setHasLocalMutations(),null})(n,e,t,i):n instanceof yo?(function(u,d,p,g){if(!kh(u.precondition,d))return p;const y=Ox(u.fieldTransforms,g,d),w=d.data;return w.setAll(R_(u)),w.setAll(y),d.convertToFoundDocument(d.version,w).setHasLocalMutations(),p===null?null:p.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((j=>j.field)))})(n,e,t,i):(function(u,d,p){return kh(u.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):p})(n,e,t)}function cA(n,e){let t=null;for(const i of n.fieldTransforms){const l=e.data.field(i.field),u=j_(i.transform,l||null);u!=null&&(t===null&&(t=Ir.empty()),t.set(i.field,u))}return t||null}function Px(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,l){return i===void 0&&l===void 0||!(!i||!l)&&Ql(i,l,((u,d)=>iA(u,d)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Lu extends um{constructor(e,t,i,l=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=l,this.type=0}getFieldMask(){return null}}class yo extends um{constructor(e,t,i,l,u=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=l,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function R_(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function Lx(n,e,t){const i=new Map;Us(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let l=0;l<t.length;l++){const u=n[l],d=u.transform,p=e.data.field(u.field);i.set(u.field,aA(d,p,t[l]))}return i}function Ox(n,e,t){const i=new Map;for(const l of n){const u=l.transform,d=t.data.field(l.field);i.set(l.field,rA(u,d,e))}return i}class dm extends um{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class uA extends um{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class dA{constructor(e,t,i,l){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=l}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let l=0;l<this.mutations.length;l++){const u=this.mutations[l];u.key.isEqual(e.key)&&lA(u,e,i[l])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=du(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=du(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=w_();return this.mutations.forEach((l=>{const u=e.get(l.key),d=u.overlayedDocument;let p=this.applyToLocalView(d,u.mutatedFields);p=t.has(l.key)?null:p;const g=C_(d,p);g!==null&&i.set(l.key,g),d.isValidDocument()||d.convertToNoDocument(Wt.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),ys())}isEqual(e){return this.batchId===e.batchId&&Ql(this.mutations,e.mutations,((t,i)=>Px(t,i)))&&Ql(this.baseMutations,e.baseMutations,((t,i)=>Px(t,i)))}}class hy{constructor(e,t,i,l){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=l}static from(e,t,i){Us(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let l=(function(){return eA})();const u=e.mutations;for(let d=0;d<u.length;d++)l=l.insert(u[d].key,i[d].version);return new hy(e,t,i,l)}}class hA{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class mA{constructor(e,t){this.count=e,this.unchangedNames=t}}var Mn,js;function fA(n){switch(n){case Ce.OK:return Lt(64938);case Ce.CANCELLED:case Ce.UNKNOWN:case Ce.DEADLINE_EXCEEDED:case Ce.RESOURCE_EXHAUSTED:case Ce.INTERNAL:case Ce.UNAVAILABLE:case Ce.UNAUTHENTICATED:return!1;case Ce.INVALID_ARGUMENT:case Ce.NOT_FOUND:case Ce.ALREADY_EXISTS:case Ce.PERMISSION_DENIED:case Ce.FAILED_PRECONDITION:case Ce.ABORTED:case Ce.OUT_OF_RANGE:case Ce.UNIMPLEMENTED:case Ce.DATA_LOSS:return!0;default:return Lt(15467,{code:n})}}function A_(n){if(n===void 0)return gi("GRPC error has no .code"),Ce.UNKNOWN;switch(n){case Mn.OK:return Ce.OK;case Mn.CANCELLED:return Ce.CANCELLED;case Mn.UNKNOWN:return Ce.UNKNOWN;case Mn.DEADLINE_EXCEEDED:return Ce.DEADLINE_EXCEEDED;case Mn.RESOURCE_EXHAUSTED:return Ce.RESOURCE_EXHAUSTED;case Mn.INTERNAL:return Ce.INTERNAL;case Mn.UNAVAILABLE:return Ce.UNAVAILABLE;case Mn.UNAUTHENTICATED:return Ce.UNAUTHENTICATED;case Mn.INVALID_ARGUMENT:return Ce.INVALID_ARGUMENT;case Mn.NOT_FOUND:return Ce.NOT_FOUND;case Mn.ALREADY_EXISTS:return Ce.ALREADY_EXISTS;case Mn.PERMISSION_DENIED:return Ce.PERMISSION_DENIED;case Mn.FAILED_PRECONDITION:return Ce.FAILED_PRECONDITION;case Mn.ABORTED:return Ce.ABORTED;case Mn.OUT_OF_RANGE:return Ce.OUT_OF_RANGE;case Mn.UNIMPLEMENTED:return Ce.UNIMPLEMENTED;case Mn.DATA_LOSS:return Ce.DATA_LOSS;default:return Lt(39323,{code:n})}}(js=Mn||(Mn={}))[js.OK=0]="OK",js[js.CANCELLED=1]="CANCELLED",js[js.UNKNOWN=2]="UNKNOWN",js[js.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",js[js.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",js[js.NOT_FOUND=5]="NOT_FOUND",js[js.ALREADY_EXISTS=6]="ALREADY_EXISTS",js[js.PERMISSION_DENIED=7]="PERMISSION_DENIED",js[js.UNAUTHENTICATED=16]="UNAUTHENTICATED",js[js.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",js[js.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",js[js.ABORTED=10]="ABORTED",js[js.OUT_OF_RANGE=11]="OUT_OF_RANGE",js[js.UNIMPLEMENTED=12]="UNIMPLEMENTED",js[js.INTERNAL=13]="INTERNAL",js[js.UNAVAILABLE=14]="UNAVAILABLE",js[js.DATA_LOSS=15]="DATA_LOSS";function pA(){return new TextEncoder}const gA=new ro([4294967295,4294967295],0);function Vx(n){const e=pA().encode(n),t=new Hw;return t.update(e),new Uint8Array(t.digest())}function Bx(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),l=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new ro([t,i],0),new ro([l,u],0)]}class my{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new ru(`Invalid padding: ${t}`);if(i<0)throw new ru(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new ru(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new ru(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=ro.fromNumber(this.ge)}ye(e,t,i){let l=e.add(t.multiply(ro.fromNumber(i)));return l.compare(gA)===1&&(l=new ro([l.getBits(0),l.getBits(1)],0)),l.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Vx(e),[i,l]=Bx(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);if(!this.we(d))return!1}return!0}static create(e,t,i){const l=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),d=new my(u,l,t);return i.forEach((p=>d.insert(p))),d}insert(e){if(this.ge===0)return;const t=Vx(e),[i,l]=Bx(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);this.be(d)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class ru extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class hm{constructor(e,t,i,l,u){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=l,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const l=new Map;return l.set(e,Ou.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new hm(Wt.min(),l,new hn(gs),yi(),ys())}}class Ou{constructor(e,t,i,l,u){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=l,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Ou(i,t,ys(),ys(),ys())}}class jh{constructor(e,t,i,l){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=l}}class I_{constructor(e,t){this.targetId=e,this.Ce=t}}class M_{constructor(e,t,i=tr.EMPTY_BYTE_STRING,l=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=l}}class Ux{constructor(){this.ve=0,this.Fe=Fx(),this.Me=tr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ys(),t=ys(),i=ys();return this.Fe.forEach(((l,u)=>{switch(u){case 0:e=e.add(l);break;case 2:t=t.add(l);break;case 1:i=i.add(l);break;default:Lt(38017,{changeType:u})}})),new Ou(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=Fx()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Us(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class yA{constructor(e){this.Ge=e,this.ze=new Map,this.je=yi(),this.He=rh(),this.Je=rh(),this.Ze=new hn(gs)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:Lt(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,l)=>{this.rt(l)&&t(l)}))}st(e){const t=e.targetId,i=e.Ce.count,l=this.ot(t);if(l){const u=l.target;if(vg(u))if(i===0){const d=new Nt(u.path);this.et(t,d,lr.newNoDocument(d,Wt.min()))}else Us(i===1,20013,{expectedCount:i});else{const d=this._t(t);if(d!==i){const p=this.ut(e),g=p?this.ct(p,e,d):1;if(g!==0){this.it(t);const y=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,y)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:l=0},hashCount:u=0}=t;let d,p;try{d=co(i).toUint8Array()}catch(g){if(g instanceof s_)return Yl("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{p=new my(d,l,u)}catch(g){return Yl(g instanceof ru?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return p.ge===0?null:p}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let l=0;return i.forEach((u=>{const d=this.Ge.ht(),p=`projects/${d.projectId}/databases/${d.database}/documents/${u.path.canonicalString()}`;e.mightContain(p)||(this.et(t,u,null),l++)})),l}Tt(e){const t=new Map;this.ze.forEach(((u,d)=>{const p=this.ot(d);if(p){if(u.current&&vg(p.target)){const g=new Nt(p.target.path);this.It(g).has(d)||this.Et(d,g)||this.et(d,g,lr.newNoDocument(g,e))}u.Be&&(t.set(d,u.ke()),u.Ke())}}));let i=ys();this.Je.forEach(((u,d)=>{let p=!0;d.forEachWhile((g=>{const y=this.ot(g);return!y||y.purpose==="TargetPurposeLimboResolution"||(p=!1,!1)})),p&&(i=i.add(u))})),this.je.forEach(((u,d)=>d.setReadTime(e)));const l=new hm(e,t,this.Ze,this.je,i);return this.je=yi(),this.He=rh(),this.Je=rh(),this.Ze=new hn(gs),l}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const l=this.nt(e);this.Et(e,t)?l.qe(t,1):l.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new Ux,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Bn(gs),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Bn(gs),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||ct("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Ux),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function rh(){return new hn(Nt.comparator)}function Fx(){return new hn(Nt.comparator)}const bA={asc:"ASCENDING",desc:"DESCENDING"},vA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},xA={and:"AND",or:"OR"};class wA{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function wg(n,e){return n.useProto3Json||rm(e)?e:{value:e}}function Fh(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function D_(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function _A(n,e){return Fh(n,e.toTimestamp())}function Ba(n){return Us(!!n,49232),Wt.fromTimestamp((function(t){const i=lo(t);return new xt(i.seconds,i.nanos)})(n))}function fy(n,e){return _g(n,e).canonicalString()}function _g(n,e){const t=(function(l){return new Zs(["projects",l.projectId,"databases",l.database])})(n).child("documents");return e===void 0?t:t.child(e)}function P_(n){const e=Zs.fromString(n);return Us(U_(e),10190,{key:e.toString()}),e}function kg(n,e){return fy(n.databaseId,e.path)}function Mp(n,e){const t=P_(e);if(t.get(1)!==n.databaseId.projectId)throw new nt(Ce.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new nt(Ce.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Nt(O_(t))}function L_(n,e){return fy(n.databaseId,e)}function kA(n){const e=P_(n);return e.length===4?Zs.emptyPath():O_(e)}function jg(n){return new Zs(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function O_(n){return Us(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function zx(n,e,t){return{name:kg(n,e),fields:t.value.mapValue.fields}}function jA(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:Lt(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),l=e.targetChange.targetIds||[],u=(function(y,w){return y.useProto3Json?(Us(w===void 0||typeof w=="string",58123),tr.fromBase64String(w||"")):(Us(w===void 0||w instanceof Buffer||w instanceof Uint8Array,16193),tr.fromUint8Array(w||new Uint8Array))})(n,e.targetChange.resumeToken),d=e.targetChange.cause,p=d&&(function(y){const w=y.code===void 0?Ce.UNKNOWN:A_(y.code);return new nt(w,y.message||"")})(d);t=new M_(i,l,u,p||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const l=Mp(n,i.document.name),u=Ba(i.document.updateTime),d=i.document.createTime?Ba(i.document.createTime):Wt.min(),p=new Ir({mapValue:{fields:i.document.fields}}),g=lr.newFoundDocument(l,u,d,p),y=i.targetIds||[],w=i.removedTargetIds||[];t=new jh(y,w,g.key,g)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const l=Mp(n,i.document),u=i.readTime?Ba(i.readTime):Wt.min(),d=lr.newNoDocument(l,u),p=i.removedTargetIds||[];t=new jh([],p,d.key,d)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const l=Mp(n,i.document),u=i.removedTargetIds||[];t=new jh([],u,l,null)}else{if(!("filter"in e))return Lt(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:l=0,unchangedNames:u}=i,d=new mA(l,u),p=i.targetId;t=new I_(p,d)}}return t}function TA(n,e){let t;if(e instanceof Lu)t={update:zx(n,e.key,e.value)};else if(e instanceof dm)t={delete:kg(n,e.key)};else if(e instanceof yo)t={update:zx(n,e.key,e.data),updateMask:DA(e.fieldMask)};else{if(!(e instanceof uA))return Lt(16599,{dt:e.type});t={verify:kg(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(u,d){const p=d.transform;if(p instanceof ku)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(p instanceof ju)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:p.elements}};if(p instanceof Tu)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:p.elements}};if(p instanceof Eu)return{fieldPath:d.field.canonicalString(),increment:p.Ae};throw Lt(20930,{transform:d.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(l,u){return u.updateTime!==void 0?{updateTime:_A(l,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:Lt(27497)})(n,e.precondition)),t}function EA(n,e){return n&&n.length>0?(Us(e!==void 0,14353),n.map((t=>(function(l,u){let d=l.updateTime?Ba(l.updateTime):Ba(u);return d.isEqual(Wt.min())&&(d=Ba(u)),new oA(d,l.transformResults||[])})(t,e)))):[]}function SA(n,e){return{documents:[L_(n,e.path)]}}function NA(n,e){const t={structuredQuery:{}},i=e.path;let l;e.collectionGroup!==null?(l=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(l=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=L_(n,l);const u=(function(y){if(y.length!==0)return B_(va.create(y,"and"))})(e.filters);u&&(t.structuredQuery.where=u);const d=(function(y){if(y.length!==0)return y.map((w=>(function(T){return{field:Fl(T.field),direction:AA(T.dir)}})(w)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const p=wg(n,e.limit);return p!==null&&(t.structuredQuery.limit=p),e.startAt&&(t.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{ft:t,parent:l}}function CA(n){let e=kA(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let l=null;if(i>0){Us(i===1,65062);const w=t.from[0];w.allDescendants?l=w.collectionId:e=e.child(w.collectionId)}let u=[];t.where&&(u=(function(j){const T=V_(j);return T instanceof va&&h_(T)?T.getFilters():[T]})(t.where));let d=[];t.orderBy&&(d=(function(j){return j.map((T=>(function($){return new _u(zl($.field),(function(B){switch(B){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})($.direction))})(T)))})(t.orderBy));let p=null;t.limit&&(p=(function(j){let T;return T=typeof j=="object"?j.value:j,rm(T)?null:T})(t.limit));let g=null;t.startAt&&(g=(function(j){const T=!!j.before,O=j.values||[];return new Bh(O,T)})(t.startAt));let y=null;return t.endAt&&(y=(function(j){const T=!j.before,O=j.values||[];return new Bh(O,T)})(t.endAt)),GR(e,l,d,u,p,"F",g,y)}function RA(n,e){const t=(function(l){switch(l){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Lt(28987,{purpose:l})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function V_(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=zl(t.unaryFilter.field);return Dn.create(i,"==",{doubleValue:NaN});case"IS_NULL":const l=zl(t.unaryFilter.field);return Dn.create(l,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=zl(t.unaryFilter.field);return Dn.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=zl(t.unaryFilter.field);return Dn.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Lt(61313);default:return Lt(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Dn.create(zl(t.fieldFilter.field),(function(l){switch(l){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Lt(58110);default:return Lt(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return va.create(t.compositeFilter.filters.map((i=>V_(i))),(function(l){switch(l){case"AND":return"and";case"OR":return"or";default:return Lt(1026)}})(t.compositeFilter.op))})(n):Lt(30097,{filter:n})}function AA(n){return bA[n]}function IA(n){return vA[n]}function MA(n){return xA[n]}function Fl(n){return{fieldPath:n.canonicalString()}}function zl(n){return er.fromServerFormat(n.fieldPath)}function B_(n){return n instanceof Dn?(function(t){if(t.op==="=="){if(Cx(t.value))return{unaryFilter:{field:Fl(t.field),op:"IS_NAN"}};if(Nx(t.value))return{unaryFilter:{field:Fl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Cx(t.value))return{unaryFilter:{field:Fl(t.field),op:"IS_NOT_NAN"}};if(Nx(t.value))return{unaryFilter:{field:Fl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Fl(t.field),op:IA(t.op),value:t.value}}})(n):n instanceof va?(function(t){const i=t.getFilters().map((l=>B_(l)));return i.length===1?i[0]:{compositeFilter:{op:MA(t.op),filters:i}}})(n):Lt(54877,{filter:n})}function DA(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function U_(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function F_(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}class Zi{constructor(e,t,i,l,u=Wt.min(),d=Wt.min(),p=tr.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=l,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=p,this.expectedCount=g}withSequenceNumber(e){return new Zi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Zi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Zi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Zi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class PA{constructor(e){this.yt=e}}function LA(n){const e=CA({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Uh(e,e.limit,"L"):e}class OA{constructor(){this.Sn=new VA}addToCollectionParentIndex(e,t){return this.Sn.add(t),Oe.resolve()}getCollectionParents(e,t){return Oe.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return Oe.resolve()}deleteFieldIndex(e,t){return Oe.resolve()}deleteAllFieldIndexes(e){return Oe.resolve()}createTargetIndexes(e,t){return Oe.resolve()}getDocumentsMatchingTarget(e,t){return Oe.resolve(null)}getIndexType(e,t){return Oe.resolve(0)}getFieldIndexes(e,t){return Oe.resolve([])}getNextCollectionGroupToUpdate(e){return Oe.resolve(null)}getMinOffset(e,t){return Oe.resolve(oo.min())}getMinOffsetFromCollectionGroup(e,t){return Oe.resolve(oo.min())}updateCollectionGroup(e,t,i){return Oe.resolve()}updateIndexEntries(e,t){return Oe.resolve()}}class VA{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t]||new Bn(Zs.comparator),u=!l.has(i);return this.index[t]=l.add(i),u}has(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t];return l&&l.has(i)}getEntries(e){return(this.index[e]||new Bn(Zs.comparator)).toArray()}}const qx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},z_=41943040;class Ar{static withCacheSize(e){return new Ar(e,Ar.DEFAULT_COLLECTION_PERCENTILE,Ar.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}Ar.DEFAULT_COLLECTION_PERCENTILE=10,Ar.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ar.DEFAULT=new Ar(z_,Ar.DEFAULT_COLLECTION_PERCENTILE,Ar.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ar.DISABLED=new Ar(-1,0,0);class Zl{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Zl(0)}static ar(){return new Zl(-1)}}const Hx="LruGarbageCollector",BA=1048576;function $x([n,e],[t,i]){const l=gs(n,t);return l===0?gs(e,i):l}class UA{constructor(e){this.Pr=e,this.buffer=new Bn($x),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();$x(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class FA{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){ct(Hx,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){oc(t)?ct(Hx,"Ignoring IndexedDB error during garbage collection: ",t):await ic(t)}await this.Ar(3e5)}))}}class zA{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Oe.resolve(nm.ce);const i=new UA(t);return this.Vr.forEachTarget(e,(l=>i.Er(l.sequenceNumber))).next((()=>this.Vr.mr(e,(l=>i.Er(l))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ct("LruGarbageCollector","Garbage collection skipped; disabled"),Oe.resolve(qx)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(ct("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),qx):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,l,u,d,p,g,y;const w=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((j=>(j>this.params.maximumSequenceNumbersToCollect?(ct("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${j}`),l=this.params.maximumSequenceNumbersToCollect):l=j,d=Date.now(),this.nthSequenceNumber(e,l)))).next((j=>(i=j,p=Date.now(),this.removeTargets(e,i,t)))).next((j=>(u=j,g=Date.now(),this.removeOrphanedDocuments(e,i)))).next((j=>(y=Date.now(),Bl()<=ps.DEBUG&&ct("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-w}ms
	Determined least recently used ${l} in `+(p-d)+`ms
	Removed ${u} targets in `+(g-p)+`ms
	Removed ${j} documents in `+(y-g)+`ms
Total Duration: ${y-w}ms`),Oe.resolve({didRun:!0,sequenceNumbersCollected:l,targetsRemoved:u,documentsRemoved:j}))))}}function qA(n,e){return new zA(n,e)}class HA{constructor(){this.changes=new Zo((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,lr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Oe.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class $A{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class WA{constructor(e,t,i,l){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=l}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((l=>(i=l,this.remoteDocumentCache.getEntry(e,t)))).next((l=>(i!==null&&du(i.mutation,l,$r.empty(),xt.now()),l)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,ys()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=ys()){const l=Vo();return this.populateOverlays(e,l,t).next((()=>this.computeViews(e,t,l,i).next((u=>{let d=nu();return u.forEach(((p,g)=>{d=d.insert(p,g.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const i=Vo();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,ys())))}populateOverlays(e,t,i){const l=[];return i.forEach((u=>{t.has(u)||l.push(u)})),this.documentOverlayCache.getOverlays(e,l).next((u=>{u.forEach(((d,p)=>{t.set(d,p)}))}))}computeViews(e,t,i,l){let u=yi();const d=uu(),p=(function(){return uu()})();return t.forEach(((g,y)=>{const w=i.get(y.key);l.has(y.key)&&(w===void 0||w.mutation instanceof yo)?u=u.insert(y.key,y):w!==void 0?(d.set(y.key,w.mutation.getFieldMask()),du(w.mutation,y,w.mutation.getFieldMask(),xt.now())):d.set(y.key,$r.empty())})),this.recalculateAndSaveOverlays(e,u).next((g=>(g.forEach(((y,w)=>d.set(y,w))),t.forEach(((y,w)=>p.set(y,new $A(w,d.get(y)??null)))),p)))}recalculateAndSaveOverlays(e,t){const i=uu();let l=new hn(((d,p)=>d-p)),u=ys();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const p of d)p.keys().forEach((g=>{const y=t.get(g);if(y===null)return;let w=i.get(g)||$r.empty();w=p.applyToLocalView(y,w),i.set(g,w);const j=(l.get(p.batchId)||ys()).add(g);l=l.insert(p.batchId,j)}))})).next((()=>{const d=[],p=l.getReverseIterator();for(;p.hasNext();){const g=p.getNext(),y=g.key,w=g.value,j=w_();w.forEach((T=>{if(!u.has(T)){const O=C_(t.get(T),i.get(T));O!==null&&j.set(T,O),u=u.add(T)}})),d.push(this.documentOverlayCache.saveOverlays(e,y,j))}return Oe.waitFor(d)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,l){return KR(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):g_(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,l):this.getDocumentsMatchingCollectionQuery(e,t,i,l)}getNextDocuments(e,t,i,l){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,l).next((u=>{const d=l-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,l-u.size):Oe.resolve(Vo());let p=bu,g=u;return d.next((y=>Oe.forEach(y,((w,j)=>(p<j.largestBatchId&&(p=j.largestBatchId),u.get(w)?Oe.resolve():this.remoteDocumentCache.getEntry(e,w).next((T=>{g=g.insert(w,T)}))))).next((()=>this.populateOverlays(e,y,u))).next((()=>this.computeViews(e,g,y,ys()))).next((w=>({batchId:p,changes:x_(w)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Nt(t)).next((i=>{let l=nu();return i.isFoundDocument()&&(l=l.insert(i.key,i)),l}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,l){const u=t.collectionGroup;let d=nu();return this.indexManager.getCollectionParents(e,u).next((p=>Oe.forEach(p,(g=>{const y=(function(j,T){return new lc(T,null,j.explicitOrderBy.slice(),j.filters.slice(),j.limit,j.limitType,j.startAt,j.endAt)})(t,g.child(u));return this.getDocumentsMatchingCollectionQuery(e,y,i,l).next((w=>{w.forEach(((j,T)=>{d=d.insert(j,T)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,i,l){let u;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((d=>(u=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,u,l)))).next((d=>{u.forEach(((g,y)=>{const w=y.getKey();d.get(w)===null&&(d=d.insert(w,lr.newInvalidDocument(w)))}));let p=nu();return d.forEach(((g,y)=>{const w=u.get(g);w!==void 0&&du(w.mutation,y,$r.empty(),xt.now()),lm(t,y)&&(p=p.insert(g,y))})),p}))}}class GA{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return Oe.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(l){return{id:l.id,version:l.version,createTime:Ba(l.createTime)}})(t)),Oe.resolve()}getNamedQuery(e,t){return Oe.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(l){return{name:l.name,query:LA(l.bundledQuery),readTime:Ba(l.readTime)}})(t)),Oe.resolve()}}class KA{constructor(){this.overlays=new hn(Nt.comparator),this.Lr=new Map}getOverlay(e,t){return Oe.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Vo();return Oe.forEach(t,(l=>this.getOverlay(e,l).next((u=>{u!==null&&i.set(l,u)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((l,u)=>{this.bt(e,t,u)})),Oe.resolve()}removeOverlaysForBatchId(e,t,i){const l=this.Lr.get(i);return l!==void 0&&(l.forEach((u=>this.overlays=this.overlays.remove(u))),this.Lr.delete(i)),Oe.resolve()}getOverlaysForCollection(e,t,i){const l=Vo(),u=t.length+1,d=new Nt(t.child("")),p=this.overlays.getIteratorFrom(d);for(;p.hasNext();){const g=p.getNext().value,y=g.getKey();if(!t.isPrefixOf(y.path))break;y.path.length===u&&g.largestBatchId>i&&l.set(g.getKey(),g)}return Oe.resolve(l)}getOverlaysForCollectionGroup(e,t,i,l){let u=new hn(((y,w)=>y-w));const d=this.overlays.getIterator();for(;d.hasNext();){const y=d.getNext().value;if(y.getKey().getCollectionGroup()===t&&y.largestBatchId>i){let w=u.get(y.largestBatchId);w===null&&(w=Vo(),u=u.insert(y.largestBatchId,w)),w.set(y.getKey(),y)}}const p=Vo(),g=u.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((y,w)=>p.set(y,w))),!(p.size()>=l)););return Oe.resolve(p)}bt(e,t,i){const l=this.overlays.get(i.key);if(l!==null){const d=this.Lr.get(l.largestBatchId).delete(i.key);this.Lr.set(l.largestBatchId,d)}this.overlays=this.overlays.insert(i.key,new hA(t,i));let u=this.Lr.get(t);u===void 0&&(u=ys(),this.Lr.set(t,u)),this.Lr.set(t,u.add(i.key))}}class YA{constructor(){this.sessionToken=tr.EMPTY_BYTE_STRING}getSessionToken(e){return Oe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Oe.resolve()}}class py{constructor(){this.kr=new Bn(Hn.Kr),this.qr=new Bn(Hn.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new Hn(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new Hn(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new Nt(new Zs([])),i=new Hn(t,e),l=new Hn(t,e+1),u=[];return this.qr.forEachInRange([i,l],(d=>{this.Wr(d),u.push(d.key)})),u}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new Nt(new Zs([])),i=new Hn(t,e),l=new Hn(t,e+1);let u=ys();return this.qr.forEachInRange([i,l],(d=>{u=u.add(d.key)})),u}containsKey(e){const t=new Hn(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Hn{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return Nt.comparator(e.key,t.key)||gs(e.Hr,t.Hr)}static Ur(e,t){return gs(e.Hr,t.Hr)||Nt.comparator(e.key,t.key)}}class QA{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Bn(Hn.Kr)}checkEmpty(e){return Oe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,l){const u=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new dA(u,t,i,l);this.mutationQueue.push(d);for(const p of l)this.Jr=this.Jr.add(new Hn(p.key,u)),this.indexManager.addToCollectionParentIndex(e,p.key.path.popLast());return Oe.resolve(d)}lookupMutationBatch(e,t){return Oe.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,l=this.Xr(i),u=l<0?0:l;return Oe.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return Oe.resolve(this.mutationQueue.length===0?iy:this.Yn-1)}getAllMutationBatches(e){return Oe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Hn(t,0),l=new Hn(t,Number.POSITIVE_INFINITY),u=[];return this.Jr.forEachInRange([i,l],(d=>{const p=this.Zr(d.Hr);u.push(p)})),Oe.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Bn(gs);return t.forEach((l=>{const u=new Hn(l,0),d=new Hn(l,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([u,d],(p=>{i=i.add(p.Hr)}))})),Oe.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,l=i.length+1;let u=i;Nt.isDocumentKey(u)||(u=u.child(""));const d=new Hn(new Nt(u),0);let p=new Bn(gs);return this.Jr.forEachWhile((g=>{const y=g.key.path;return!!i.isPrefixOf(y)&&(y.length===l&&(p=p.add(g.Hr)),!0)}),d),Oe.resolve(this.Yr(p))}Yr(e){const t=[];return e.forEach((i=>{const l=this.Zr(i);l!==null&&t.push(l)})),t}removeMutationBatch(e,t){Us(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return Oe.forEach(t.mutations,(l=>{const u=new Hn(l.key,t.batchId);return i=i.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,l.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new Hn(t,0),l=this.Jr.firstAfterOrEqual(i);return Oe.resolve(t.isEqual(l&&l.key))}performConsistencyCheck(e){return this.mutationQueue.length,Oe.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class XA{constructor(e){this.ti=e,this.docs=(function(){return new hn(Nt.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,l=this.docs.get(i),u=l?l.size:0,d=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:d}),this.size+=d-u,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Oe.resolve(i?i.document.mutableCopy():lr.newInvalidDocument(t))}getEntries(e,t){let i=yi();return t.forEach((l=>{const u=this.docs.get(l);i=i.insert(l,u?u.document.mutableCopy():lr.newInvalidDocument(l))})),Oe.resolve(i)}getDocumentsMatchingQuery(e,t,i,l){let u=yi();const d=t.path,p=new Nt(d.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(p);for(;g.hasNext();){const{key:y,value:{document:w}}=g.getNext();if(!d.isPrefixOf(y.path))break;y.path.length>d.length+1||jR(kR(w),i)<=0||(l.has(w.key)||lm(t,w))&&(u=u.insert(w.key,w.mutableCopy()))}return Oe.resolve(u)}getAllFromCollectionGroup(e,t,i,l){Lt(9500)}ni(e,t){return Oe.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new JA(this)}getSize(e){return Oe.resolve(this.size)}}class JA extends HA{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,l)=>{l.isValidDocument()?t.push(this.Mr.addEntry(e,l)):this.Mr.removeEntry(i)})),Oe.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class ZA{constructor(e){this.persistence=e,this.ri=new Zo((t=>cy(t)),uy),this.lastRemoteSnapshotVersion=Wt.min(),this.highestTargetId=0,this.ii=0,this.si=new py,this.targetCount=0,this.oi=Zl._r()}forEachTarget(e,t){return this.ri.forEach(((i,l)=>t(l))),Oe.resolve()}getLastRemoteSnapshotVersion(e){return Oe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Oe.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),Oe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),Oe.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new Zl(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,Oe.resolve()}updateTargetData(e,t){return this.lr(t),Oe.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,Oe.resolve()}removeTargets(e,t,i){let l=0;const u=[];return this.ri.forEach(((d,p)=>{p.sequenceNumber<=t&&i.get(p.targetId)===null&&(this.ri.delete(d),u.push(this.removeMatchingKeysForTargetId(e,p.targetId)),l++)})),Oe.waitFor(u).next((()=>l))}getTargetCount(e){return Oe.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return Oe.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),Oe.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const l=this.persistence.referenceDelegate,u=[];return l&&t.forEach((d=>{u.push(l.markPotentiallyOrphaned(e,d))})),Oe.waitFor(u)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),Oe.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return Oe.resolve(i)}containsKey(e,t){return Oe.resolve(this.si.containsKey(t))}}class q_{constructor(e,t){this._i={},this.overlays={},this.ai=new nm(0),this.ui=!1,this.ui=!0,this.ci=new YA,this.referenceDelegate=e(this),this.li=new ZA(this),this.indexManager=new OA,this.remoteDocumentCache=(function(l){return new XA(l)})((i=>this.referenceDelegate.hi(i))),this.serializer=new PA(t),this.Pi=new GA(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new KA,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new QA(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){ct("MemoryPersistence","Starting transaction:",e);const l=new eI(this.ai.next());return this.referenceDelegate.Ti(),i(l).next((u=>this.referenceDelegate.Ii(l).next((()=>u)))).toPromise().then((u=>(l.raiseOnCommittedEvent(),u)))}Ei(e,t){return Oe.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class eI extends ER{constructor(e){super(),this.currentSequenceNumber=e}}class gy{constructor(e){this.persistence=e,this.Ri=new py,this.Ai=null}static Vi(e){return new gy(e)}get di(){if(this.Ai)return this.Ai;throw Lt(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),Oe.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),Oe.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),Oe.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((l=>this.di.add(l.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((l=>{l.forEach((u=>this.di.add(u.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Oe.forEach(this.di,(i=>{const l=Nt.fromPath(i);return this.mi(e,l).next((u=>{u||t.removeEntry(l,Wt.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return Oe.or([()=>Oe.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class zh{constructor(e,t){this.persistence=e,this.fi=new Zo((i=>CR(i.path)),((i,l)=>i.isEqual(l))),this.garbageCollector=qA(this,t)}static Vi(e,t){return new zh(e,t)}Ti(){}Ii(e){return Oe.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((l=>i+l))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return Oe.forEach(this.fi,((i,l)=>this.wr(e,i,l).next((u=>u?Oe.resolve():t(l)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const l=this.persistence.getRemoteDocumentCache(),u=l.newChangeBuffer();return l.ni(e,(d=>this.wr(e,d,t).next((p=>{p||(i++,u.removeEntry(d,Wt.min()))})))).next((()=>u.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),Oe.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Oe.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Oe.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),Oe.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=wh(e.data.value)),t}wr(e,t,i){return Oe.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const l=this.fi.get(t);return Oe.resolve(l!==void 0&&l>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class yy{constructor(e,t,i,l){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=l}static Es(e,t){let i=ys(),l=ys();for(const u of t.docChanges)switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:l=l.add(u.doc.key)}return new yy(e,t.fromCache,i,l)}}class tI{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class sI{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return CS()?8:SR(cr())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,l){const u={result:null};return this.gs(e,t).next((d=>{u.result=d})).next((()=>{if(!u.result)return this.ps(e,t,l,i).next((d=>{u.result=d}))})).next((()=>{if(u.result)return;const d=new tI;return this.ys(e,t,d).next((p=>{if(u.result=p,this.As)return this.ws(e,t,d,p.size)}))})).next((()=>u.result))}ws(e,t,i,l){return i.documentReadCount<this.Vs?(Bl()<=ps.DEBUG&&ct("QueryEngine","SDK will not create cache indexes for query:",Ul(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Oe.resolve()):(Bl()<=ps.DEBUG&&ct("QueryEngine","Query:",Ul(t),"scans",i.documentReadCount,"local documents and returns",l,"documents as results."),i.documentReadCount>this.ds*l?(Bl()<=ps.DEBUG&&ct("QueryEngine","The SDK decides to create cache indexes for query:",Ul(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Va(t))):Oe.resolve())}gs(e,t){if(Mx(t))return Oe.resolve(null);let i=Va(t);return this.indexManager.getIndexType(e,i).next((l=>l===0?null:(t.limit!==null&&l===1&&(t=Uh(t,null,"F"),i=Va(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((u=>{const d=ys(...u);return this.fs.getDocuments(e,d).next((p=>this.indexManager.getMinOffset(e,i).next((g=>{const y=this.bs(t,p);return this.Ss(t,y,d,g.readTime)?this.gs(e,Uh(t,null,"F")):this.Ds(e,y,t,g)}))))})))))}ps(e,t,i,l){return Mx(t)||l.isEqual(Wt.min())?Oe.resolve(null):this.fs.getDocuments(e,i).next((u=>{const d=this.bs(t,u);return this.Ss(t,d,i,l)?Oe.resolve(null):(Bl()<=ps.DEBUG&&ct("QueryEngine","Re-using previous result from %s to execute query: %s",l.toString(),Ul(t)),this.Ds(e,d,t,_R(l,bu)).next((p=>p)))}))}bs(e,t){let i=new Bn(b_(e));return t.forEach(((l,u)=>{lm(e,u)&&(i=i.add(u))})),i}Ss(e,t,i,l){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const u=e.limitType==="F"?t.last():t.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(l)>0)}ys(e,t,i){return Bl()<=ps.DEBUG&&ct("QueryEngine","Using full collection scan to execute query:",Ul(t)),this.fs.getDocumentsMatchingQuery(e,t,oo.min(),i)}Ds(e,t,i,l){return this.fs.getDocumentsMatchingQuery(e,i,l).next((u=>(t.forEach((d=>{u=u.insert(d.key,d)})),u)))}}const by="LocalStore",nI=3e8;class rI{constructor(e,t,i,l){this.persistence=e,this.Cs=t,this.serializer=l,this.vs=new hn(gs),this.Fs=new Zo((u=>cy(u)),uy),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new WA(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function aI(n,e,t,i){return new rI(n,e,t,i)}async function H_(n,e){const t=Qt(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let l;return t.mutationQueue.getAllMutationBatches(i).next((u=>(l=u,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((u=>{const d=[],p=[];let g=ys();for(const y of l){d.push(y.batchId);for(const w of y.mutations)g=g.add(w.key)}for(const y of u){p.push(y.batchId);for(const w of y.mutations)g=g.add(w.key)}return t.localDocuments.getDocuments(i,g).next((y=>({Ns:y,removedBatchIds:d,addedBatchIds:p})))}))}))}function iI(n,e){const t=Qt(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const l=e.batch.keys(),u=t.xs.newChangeBuffer({trackRemovals:!0});return(function(p,g,y,w){const j=y.batch,T=j.keys();let O=Oe.resolve();return T.forEach(($=>{O=O.next((()=>w.getEntry(g,$))).next((F=>{const B=y.docVersions.get($);Us(B!==null,48541),F.version.compareTo(B)<0&&(j.applyToRemoteDocument(F,y),F.isValidDocument()&&(F.setReadTime(y.commitVersion),w.addEntry(F)))}))})),O.next((()=>p.mutationQueue.removeMutationBatch(g,j)))})(t,i,e,u).next((()=>u.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,l,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(p){let g=ys();for(let y=0;y<p.mutationResults.length;++y)p.mutationResults[y].transformResults.length>0&&(g=g.add(p.batch.mutations[y].key));return g})(e)))).next((()=>t.localDocuments.getDocuments(i,l)))}))}function $_(n){const e=Qt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function oI(n,e){const t=Qt(n),i=e.snapshotVersion;let l=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const d=t.xs.newChangeBuffer({trackRemovals:!0});l=t.vs;const p=[];e.targetChanges.forEach(((w,j)=>{const T=l.get(j);if(!T)return;p.push(t.li.removeMatchingKeys(u,w.removedDocuments,j).next((()=>t.li.addMatchingKeys(u,w.addedDocuments,j))));let O=T.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(j)!==null?O=O.withResumeToken(tr.EMPTY_BYTE_STRING,Wt.min()).withLastLimboFreeSnapshotVersion(Wt.min()):w.resumeToken.approximateByteSize()>0&&(O=O.withResumeToken(w.resumeToken,i)),l=l.insert(j,O),(function(F,B,te){return F.resumeToken.approximateByteSize()===0||B.snapshotVersion.toMicroseconds()-F.snapshotVersion.toMicroseconds()>=nI?!0:te.addedDocuments.size+te.modifiedDocuments.size+te.removedDocuments.size>0})(T,O,w)&&p.push(t.li.updateTargetData(u,O))}));let g=yi(),y=ys();if(e.documentUpdates.forEach((w=>{e.resolvedLimboDocuments.has(w)&&p.push(t.persistence.referenceDelegate.updateLimboDocument(u,w))})),p.push(lI(u,d,e.documentUpdates).next((w=>{g=w.Bs,y=w.Ls}))),!i.isEqual(Wt.min())){const w=t.li.getLastRemoteSnapshotVersion(u).next((j=>t.li.setTargetsMetadata(u,u.currentSequenceNumber,i)));p.push(w)}return Oe.waitFor(p).next((()=>d.apply(u))).next((()=>t.localDocuments.getLocalViewOfDocuments(u,g,y))).next((()=>g))})).then((u=>(t.vs=l,u)))}function lI(n,e,t){let i=ys(),l=ys();return t.forEach((u=>i=i.add(u))),e.getEntries(n,i).next((u=>{let d=yi();return t.forEach(((p,g)=>{const y=u.get(p);g.isFoundDocument()!==y.isFoundDocument()&&(l=l.add(p)),g.isNoDocument()&&g.version.isEqual(Wt.min())?(e.removeEntry(p,g.readTime),d=d.insert(p,g)):!y.isValidDocument()||g.version.compareTo(y.version)>0||g.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(g),d=d.insert(p,g)):ct(by,"Ignoring outdated watch update for ",p,". Current version:",y.version," Watch version:",g.version)})),{Bs:d,Ls:l}}))}function cI(n,e){const t=Qt(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=iy),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function uI(n,e){const t=Qt(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let l;return t.li.getTargetData(i,e).next((u=>u?(l=u,Oe.resolve(l)):t.li.allocateTargetId(i).next((d=>(l=new Zi(e,d,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,l).next((()=>l)))))))})).then((i=>{const l=t.vs.get(i.targetId);return(l===null||i.snapshotVersion.compareTo(l.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function Tg(n,e,t){const i=Qt(n),l=i.vs.get(e),u=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",u,(d=>i.persistence.referenceDelegate.removeTarget(d,l)))}catch(d){if(!oc(d))throw d;ct(by,`Failed to update sequence numbers for target ${e}: ${d}`)}i.vs=i.vs.remove(e),i.Fs.delete(l.target)}function Wx(n,e,t){const i=Qt(n);let l=Wt.min(),u=ys();return i.persistence.runTransaction("Execute query","readwrite",(d=>(function(g,y,w){const j=Qt(g),T=j.Fs.get(w);return T!==void 0?Oe.resolve(j.vs.get(T)):j.li.getTargetData(y,w)})(i,d,Va(e)).next((p=>{if(p)return l=p.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(d,p.targetId).next((g=>{u=g}))})).next((()=>i.Cs.getDocumentsMatchingQuery(d,e,t?l:Wt.min(),t?u:ys()))).next((p=>(dI(i,XR(e),p),{documents:p,ks:u})))))}function dI(n,e,t){let i=n.Ms.get(e)||Wt.min();t.forEach(((l,u)=>{u.readTime.compareTo(i)>0&&(i=u.readTime)})),n.Ms.set(e,i)}class Gx{constructor(){this.activeTargetIds=nA()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class hI{constructor(){this.vo=new Gx,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new Gx,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class mI{Mo(e){}shutdown(){}}const Kx="ConnectivityMonitor";class Yx{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){ct(Kx,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){ct(Kx,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let ah=null;function Eg(){return ah===null?ah=(function(){return 268435456+Math.round(2147483648*Math.random())})():ah++,"0x"+ah.toString(16)}const Dp="RestConnection",fI={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class pI{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),l=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${l}`,this.$o=this.databaseId.database===Oh?`project_id=${i}`:`project_id=${i}&database_id=${l}`}Wo(e,t,i,l,u){const d=Eg(),p=this.Qo(e,t.toUriEncodedString());ct(Dp,`Sending RPC '${e}' ${d}:`,p,i);const g={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(g,l,u);const{host:y}=new URL(p),w=fo(y);return this.zo(e,p,g,i,w).then((j=>(ct(Dp,`Received RPC '${e}' ${d}: `,j),j)),(j=>{throw Yl(Dp,`RPC '${e}' ${d} failed with error: `,j,"url: ",p,"request:",i),j}))}jo(e,t,i,l,u,d){return this.Wo(e,t,i,l,u)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+ac})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((l,u)=>e[u]=l)),i&&i.headers.forEach(((l,u)=>e[u]=l))}Qo(e,t){const i=fI[e];let l=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(l=`${l}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),l}terminate(){}}class gI{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const ir="WebChannelConnection",Yc=(n,e,t)=>{n.listen(e,(i=>{try{t(i)}catch(l){setTimeout((()=>{throw l}),0)}}))};class Gl extends pI{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Gl.c_){const e=Kw();Yc(e,Gw.STAT_EVENT,(t=>{t.stat===fg.PROXY?ct(ir,"STAT_EVENT: detected buffering proxy"):t.stat===fg.NOPROXY&&ct(ir,"STAT_EVENT: detected no buffering proxy")})),Gl.c_=!0}}zo(e,t,i,l,u){const d=Eg();return new Promise(((p,g)=>{const y=new $w;y.setWithCredentials(!0),y.listenOnce(Ww.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case xh.NO_ERROR:const j=y.getResponseJson();ct(ir,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(j)),p(j);break;case xh.TIMEOUT:ct(ir,`RPC '${e}' ${d} timed out`),g(new nt(Ce.DEADLINE_EXCEEDED,"Request time out"));break;case xh.HTTP_ERROR:const T=y.getStatus();if(ct(ir,`RPC '${e}' ${d} failed with status:`,T,"response text:",y.getResponseText()),T>0){let O=y.getResponseJson();Array.isArray(O)&&(O=O[0]);const $=O?.error;if($&&$.status&&$.message){const F=(function(te){const K=te.toLowerCase().replace(/_/g,"-");return Object.values(Ce).indexOf(K)>=0?K:Ce.UNKNOWN})($.status);g(new nt(F,$.message))}else g(new nt(Ce.UNKNOWN,"Server responded with status "+y.getStatus()))}else g(new nt(Ce.UNAVAILABLE,"Connection failed."));break;default:Lt(9055,{l_:e,streamId:d,h_:y.getLastErrorCode(),P_:y.getLastError()})}}finally{ct(ir,`RPC '${e}' ${d} completed.`)}}));const w=JSON.stringify(l);ct(ir,`RPC '${e}' ${d} sending request:`,l),y.send(t,"POST",w,i,15)}))}T_(e,t,i){const l=Eg(),u=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=this.createWebChannelTransport(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(p.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Go(p.initMessageHeaders,t,i),p.encodeInitMessageHeaders=!0;const y=u.join("");ct(ir,`Creating RPC '${e}' stream ${l}: ${y}`,p);const w=d.createWebChannel(y,p);this.I_(w);let j=!1,T=!1;const O=new gI({Ho:$=>{T?ct(ir,`Not sending because RPC '${e}' stream ${l} is closed:`,$):(j||(ct(ir,`Opening RPC '${e}' stream ${l} transport.`),w.open(),j=!0),ct(ir,`RPC '${e}' stream ${l} sending:`,$),w.send($))},Jo:()=>w.close()});return Yc(w,su.EventType.OPEN,(()=>{T||(ct(ir,`RPC '${e}' stream ${l} transport opened.`),O.i_())})),Yc(w,su.EventType.CLOSE,(()=>{T||(T=!0,ct(ir,`RPC '${e}' stream ${l} transport closed`),O.o_(),this.E_(w))})),Yc(w,su.EventType.ERROR,($=>{T||(T=!0,Yl(ir,`RPC '${e}' stream ${l} transport errored. Name:`,$.name,"Message:",$.message),O.o_(new nt(Ce.UNAVAILABLE,"The operation could not be completed")))})),Yc(w,su.EventType.MESSAGE,($=>{if(!T){const F=$.data[0];Us(!!F,16349);const B=F,te=B?.error||B[0]?.error;if(te){ct(ir,`RPC '${e}' stream ${l} received error:`,te);const K=te.status;let ae=(function(_e){const R=Mn[_e];if(R!==void 0)return A_(R)})(K),be=te.message;ae===void 0&&(ae=Ce.INTERNAL,be="Unknown error status: "+K+" with message "+te.message),T=!0,O.o_(new nt(ae,be)),w.close()}else ct(ir,`RPC '${e}' stream ${l} received:`,F),O.__(F)}})),Gl.u_(),setTimeout((()=>{O.s_()}),0),O}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return Yw()}}function yI(n){return new Gl(n)}function Pp(){return typeof document<"u"?document:null}function mm(n){return new wA(n,!0)}Gl.c_=!1;class W_{constructor(e,t,i=1e3,l=1.5,u=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=l,this.V_=u,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),l=Math.max(0,t-i);l>0&&ct("ExponentialBackoff",`Backing off for ${l} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,l,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const Qx="PersistentStream";class G_{constructor(e,t,i,l,u,d,p,g){this.Ci=e,this.b_=i,this.S_=l,this.connection=u,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=p,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new W_(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Ce.RESOURCE_EXHAUSTED?(gi(t.toString()),gi("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Ce.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,l])=>{this.D_===t&&this.G_(i,l)}),(i=>{e((()=>{const l=new nt(Ce.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(l)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((l=>{i((()=>this.z_(l)))})),this.stream.onMessage((l=>{i((()=>++this.F_==1?this.H_(l):this.onNext(l)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ct(Qx,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(ct(Qx,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class bI extends G_{constructor(e,t,i,l,u,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=jA(this.serializer,e),i=(function(u){if(!("targetChange"in u))return Wt.min();const d=u.targetChange;return d.targetIds&&d.targetIds.length?Wt.min():d.readTime?Ba(d.readTime):Wt.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=jg(this.serializer),t.addTarget=(function(u,d){let p;const g=d.target;if(p=vg(g)?{documents:SA(u,g)}:{query:NA(u,g).ft},p.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){p.resumeToken=D_(u,d.resumeToken);const y=wg(u,d.expectedCount);y!==null&&(p.expectedCount=y)}else if(d.snapshotVersion.compareTo(Wt.min())>0){p.readTime=Fh(u,d.snapshotVersion.toTimestamp());const y=wg(u,d.expectedCount);y!==null&&(p.expectedCount=y)}return p})(this.serializer,e);const i=RA(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=jg(this.serializer),t.removeTarget=e,this.K_(t)}}class vI extends G_{constructor(e,t,i,l,u,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return Us(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Us(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Us(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=EA(e.writeResults,e.commitTime),i=Ba(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=jg(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>TA(this.serializer,i)))};this.K_(t)}}class xI{}class wI extends xI{constructor(e,t,i,l){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=l,this.ia=!1}sa(){if(this.ia)throw new nt(Ce.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,d])=>this.connection.Wo(e,_g(t,i),l,u,d))).catch((u=>{throw u.name==="FirebaseError"?(u.code===Ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new nt(Ce.UNKNOWN,u.toString())}))}jo(e,t,i,l,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,p])=>this.connection.jo(e,_g(t,i),l,d,p,u))).catch((d=>{throw d.name==="FirebaseError"?(d.code===Ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new nt(Ce.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function _I(n,e,t,i){return new wI(n,e,t,i)}class kI{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(gi(t),this.aa=!1):ct("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Yo="RemoteStore";class jI{constructor(e,t,i,l,u){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=u,this.Aa.Mo((d=>{i.enqueueAndForget((async()=>{el(this)&&(ct(Yo,"Restarting streams for network reachability change."),await(async function(g){const y=Qt(g);y.Ea.add(4),await Vu(y),y.Va.set("Unknown"),y.Ea.delete(4),await fm(y)})(this))}))})),this.Va=new kI(i,l)}}async function fm(n){if(el(n))for(const e of n.Ra)await e(!0)}async function Vu(n){for(const e of n.Ra)await e(!1)}function K_(n,e){const t=Qt(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),_y(t)?wy(t):cc(t).O_()&&xy(t,e))}function vy(n,e){const t=Qt(n),i=cc(t);t.Ia.delete(e),i.O_()&&Y_(t,e),t.Ia.size===0&&(i.O_()?i.L_():el(t)&&t.Va.set("Unknown"))}function xy(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Wt.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}cc(n).Z_(e)}function Y_(n,e){n.da.$e(e),cc(n).X_(e)}function wy(n){n.da=new yA({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),cc(n).start(),n.Va.ua()}function _y(n){return el(n)&&!cc(n).x_()&&n.Ia.size>0}function el(n){return Qt(n).Ea.size===0}function Q_(n){n.da=void 0}async function TI(n){n.Va.set("Online")}async function EI(n){n.Ia.forEach(((e,t)=>{xy(n,e)}))}async function SI(n,e){Q_(n),_y(n)?(n.Va.ha(e),wy(n)):n.Va.set("Unknown")}async function NI(n,e,t){if(n.Va.set("Online"),e instanceof M_&&e.state===2&&e.cause)try{await(async function(l,u){const d=u.cause;for(const p of u.targetIds)l.Ia.has(p)&&(await l.remoteSyncer.rejectListen(p,d),l.Ia.delete(p),l.da.removeTarget(p))})(n,e)}catch(i){ct(Yo,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await qh(n,i)}else if(e instanceof jh?n.da.Xe(e):e instanceof I_?n.da.st(e):n.da.tt(e),!t.isEqual(Wt.min()))try{const i=await $_(n.localStore);t.compareTo(i)>=0&&await(function(u,d){const p=u.da.Tt(d);return p.targetChanges.forEach(((g,y)=>{if(g.resumeToken.approximateByteSize()>0){const w=u.Ia.get(y);w&&u.Ia.set(y,w.withResumeToken(g.resumeToken,d))}})),p.targetMismatches.forEach(((g,y)=>{const w=u.Ia.get(g);if(!w)return;u.Ia.set(g,w.withResumeToken(tr.EMPTY_BYTE_STRING,w.snapshotVersion)),Y_(u,g);const j=new Zi(w.target,g,y,w.sequenceNumber);xy(u,j)})),u.remoteSyncer.applyRemoteEvent(p)})(n,t)}catch(i){ct(Yo,"Failed to raise snapshot:",i),await qh(n,i)}}async function qh(n,e,t){if(!oc(e))throw e;n.Ea.add(1),await Vu(n),n.Va.set("Offline"),t||(t=()=>$_(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{ct(Yo,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await fm(n)}))}function X_(n,e){return e().catch((t=>qh(n,t,e)))}async function pm(n){const e=Qt(n),t=ho(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:iy;for(;CI(e);)try{const l=await cI(e.localStore,i);if(l===null){e.Ta.length===0&&t.L_();break}i=l.batchId,RI(e,l)}catch(l){await qh(e,l)}J_(e)&&Z_(e)}function CI(n){return el(n)&&n.Ta.length<10}function RI(n,e){n.Ta.push(e);const t=ho(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function J_(n){return el(n)&&!ho(n).x_()&&n.Ta.length>0}function Z_(n){ho(n).start()}async function AI(n){ho(n).ra()}async function II(n){const e=ho(n);for(const t of n.Ta)e.ea(t.mutations)}async function MI(n,e,t){const i=n.Ta.shift(),l=hy.from(i,e,t);await X_(n,(()=>n.remoteSyncer.applySuccessfulWrite(l))),await pm(n)}async function DI(n,e){e&&ho(n).Y_&&await(async function(i,l){if((function(d){return fA(d)&&d!==Ce.ABORTED})(l.code)){const u=i.Ta.shift();ho(i).B_(),await X_(i,(()=>i.remoteSyncer.rejectFailedWrite(u.batchId,l))),await pm(i)}})(n,e),J_(n)&&Z_(n)}async function Xx(n,e){const t=Qt(n);t.asyncQueue.verifyOperationInProgress(),ct(Yo,"RemoteStore received new credentials");const i=el(t);t.Ea.add(3),await Vu(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await fm(t)}async function PI(n,e){const t=Qt(n);e?(t.Ea.delete(2),await fm(t)):e||(t.Ea.add(2),await Vu(t),t.Va.set("Unknown"))}function cc(n){return n.ma||(n.ma=(function(t,i,l){const u=Qt(t);return u.sa(),new bI(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(n.datastore,n.asyncQueue,{Zo:TI.bind(null,n),Yo:EI.bind(null,n),t_:SI.bind(null,n),J_:NI.bind(null,n)}),n.Ra.push((async e=>{e?(n.ma.B_(),_y(n)?wy(n):n.Va.set("Unknown")):(await n.ma.stop(),Q_(n))}))),n.ma}function ho(n){return n.fa||(n.fa=(function(t,i,l){const u=Qt(t);return u.sa(),new vI(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:AI.bind(null,n),t_:DI.bind(null,n),ta:II.bind(null,n),na:MI.bind(null,n)}),n.Ra.push((async e=>{e?(n.fa.B_(),await pm(n)):(await n.fa.stop(),n.Ta.length>0&&(ct(Yo,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class ky{constructor(e,t,i,l,u){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=l,this.removalCallback=u,this.deferred=new di,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,l,u){const d=Date.now()+i,p=new ky(e,t,d,l,u);return p.start(i),p}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new nt(Ce.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function jy(n,e){if(gi("AsyncQueue",`${e}: ${n}`),oc(n))return new nt(Ce.UNAVAILABLE,`${e}: ${n}`);throw n}class Kl{static emptySet(e){return new Kl(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Nt.comparator(t.key,i.key):(t,i)=>Nt.comparator(t.key,i.key),this.keyedMap=nu(),this.sortedSet=new hn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Kl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(!l.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Kl;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class Jx{constructor(){this.ga=new hn(Nt.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Lt(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class ec{constructor(e,t,i,l,u,d,p,g,y){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=l,this.mutatedKeys=u,this.fromCache=d,this.syncStateChanged=p,this.excludesMetadataChanges=g,this.hasCachedResults=y}static fromInitialDocuments(e,t,i,l,u){const d=[];return t.forEach((p=>{d.push({type:0,doc:p})})),new ec(e,t,Kl.emptySet(t),d,i,l,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&om(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let l=0;l<t.length;l++)if(t[l].type!==i[l].type||!t[l].doc.isEqual(i[l].doc))return!1;return!0}}class LI{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class OI{constructor(){this.queries=Zx(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const l=Qt(t),u=l.queries;l.queries=Zx(),u.forEach(((d,p)=>{for(const g of p.ba)g.onError(i)}))})(this,new nt(Ce.ABORTED,"Firestore shutting down"))}}function Zx(){return new Zo((n=>y_(n)),om)}async function Ty(n,e){const t=Qt(n);let i=3;const l=e.query;let u=t.queries.get(l);u?!u.Sa()&&e.Da()&&(i=2):(u=new LI,i=e.Da()?0:1);try{switch(i){case 0:u.wa=await t.onListen(l,!0);break;case 1:u.wa=await t.onListen(l,!1);break;case 2:await t.onFirstRemoteStoreListen(l)}}catch(d){const p=jy(d,`Initialization of query '${Ul(e.query)}' failed`);return void e.onError(p)}t.queries.set(l,u),u.ba.push(e),e.va(t.onlineState),u.wa&&e.Fa(u.wa)&&Sy(t)}async function Ey(n,e){const t=Qt(n),i=e.query;let l=3;const u=t.queries.get(i);if(u){const d=u.ba.indexOf(e);d>=0&&(u.ba.splice(d,1),u.ba.length===0?l=e.Da()?0:1:!u.Sa()&&e.Da()&&(l=2))}switch(l){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function VI(n,e){const t=Qt(n);let i=!1;for(const l of e){const u=l.query,d=t.queries.get(u);if(d){for(const p of d.ba)p.Fa(l)&&(i=!0);d.wa=l}}i&&Sy(t)}function BI(n,e,t){const i=Qt(n),l=i.queries.get(e);if(l)for(const u of l.ba)u.onError(t);i.queries.delete(e)}function Sy(n){n.Ca.forEach((e=>{e.next()}))}var Sg,e2;(e2=Sg||(Sg={})).Ma="default",e2.Cache="cache";class Ny{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const l of e.docChanges)l.type!==3&&i.push(l);e=new ec(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=ec.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Sg.Cache}}class ek{constructor(e){this.key=e}}class tk{constructor(e){this.key=e}}class UI{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=ys(),this.mutatedKeys=ys(),this.eu=b_(e),this.tu=new Kl(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new Jx,l=t?t.tu:this.tu;let u=t?t.mutatedKeys:this.mutatedKeys,d=l,p=!1;const g=this.query.limitType==="F"&&l.size===this.query.limit?l.last():null,y=this.query.limitType==="L"&&l.size===this.query.limit?l.first():null;if(e.inorderTraversal(((w,j)=>{const T=l.get(w),O=lm(this.query,j)?j:null,$=!!T&&this.mutatedKeys.has(T.key),F=!!O&&(O.hasLocalMutations||this.mutatedKeys.has(O.key)&&O.hasCommittedMutations);let B=!1;T&&O?T.data.isEqual(O.data)?$!==F&&(i.track({type:3,doc:O}),B=!0):this.su(T,O)||(i.track({type:2,doc:O}),B=!0,(g&&this.eu(O,g)>0||y&&this.eu(O,y)<0)&&(p=!0)):!T&&O?(i.track({type:0,doc:O}),B=!0):T&&!O&&(i.track({type:1,doc:T}),B=!0,(g||y)&&(p=!0)),B&&(O?(d=d.add(O),u=F?u.add(w):u.delete(w)):(d=d.delete(w),u=u.delete(w)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const w=this.query.limitType==="F"?d.last():d.first();d=d.delete(w.key),u=u.delete(w.key),i.track({type:1,doc:w})}return{tu:d,iu:i,Ss:p,mutatedKeys:u}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,l){const u=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((w,j)=>(function(O,$){const F=B=>{switch(B){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Lt(20277,{Vt:B})}};return F(O)-F($)})(w.type,j.type)||this.eu(w.doc,j.doc))),this.ou(i),l=l??!1;const p=t&&!l?this._u():[],g=this.Ya.size===0&&this.current&&!l?1:0,y=g!==this.Xa;return this.Xa=g,d.length!==0||y?{snapshot:new ec(this.query,e.tu,u,d,e.mutatedKeys,g===0,y,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:p}:{au:p}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Jx,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=ys(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new tk(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new ek(i))})),t}cu(e){this.Za=e.ks,this.Ya=ys();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return ec.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const Cy="SyncEngine";class FI{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class zI{constructor(e){this.key=e,this.hu=!1}}class qI{constructor(e,t,i,l,u,d){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=l,this.currentUser=u,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new Zo((p=>y_(p)),om),this.Iu=new Map,this.Eu=new Set,this.Ru=new hn(Nt.comparator),this.Au=new Map,this.Vu=new py,this.du={},this.mu=new Map,this.fu=Zl.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function HI(n,e,t=!0){const i=ok(n);let l;const u=i.Tu.get(e);return u?(i.sharedClientState.addLocalQueryTarget(u.targetId),l=u.view.lu()):l=await sk(i,e,t,!0),l}async function $I(n,e){const t=ok(n);await sk(t,e,!0,!1)}async function sk(n,e,t,i){const l=await uI(n.localStore,Va(e)),u=l.targetId,d=n.sharedClientState.addLocalQueryTarget(u,t);let p;return i&&(p=await WI(n,e,u,d==="current",l.resumeToken)),n.isPrimaryClient&&t&&K_(n.remoteStore,l),p}async function WI(n,e,t,i,l){n.pu=(j,T,O)=>(async function(F,B,te,K){let ae=B.view.ru(te);ae.Ss&&(ae=await Wx(F.localStore,B.query,!1).then((({documents:R})=>B.view.ru(R,ae))));const be=K&&K.targetChanges.get(B.targetId),ve=K&&K.targetMismatches.get(B.targetId)!=null,_e=B.view.applyChanges(ae,F.isPrimaryClient,be,ve);return s2(F,B.targetId,_e.au),_e.snapshot})(n,j,T,O);const u=await Wx(n.localStore,e,!0),d=new UI(e,u.ks),p=d.ru(u.documents),g=Ou.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",l),y=d.applyChanges(p,n.isPrimaryClient,g);s2(n,t,y.au);const w=new FI(e,t,d);return n.Tu.set(e,w),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),y.snapshot}async function GI(n,e,t){const i=Qt(n),l=i.Tu.get(e),u=i.Iu.get(l.targetId);if(u.length>1)return i.Iu.set(l.targetId,u.filter((d=>!om(d,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(l.targetId),i.sharedClientState.isActiveQueryTarget(l.targetId)||await Tg(i.localStore,l.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(l.targetId),t&&vy(i.remoteStore,l.targetId),Ng(i,l.targetId)})).catch(ic)):(Ng(i,l.targetId),await Tg(i.localStore,l.targetId,!0))}async function KI(n,e){const t=Qt(n),i=t.Tu.get(e),l=t.Iu.get(i.targetId);t.isPrimaryClient&&l.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),vy(t.remoteStore,i.targetId))}async function YI(n,e,t){const i=sM(n);try{const l=await(function(d,p){const g=Qt(d),y=xt.now(),w=p.reduce(((O,$)=>O.add($.key)),ys());let j,T;return g.persistence.runTransaction("Locally write mutations","readwrite",(O=>{let $=yi(),F=ys();return g.xs.getEntries(O,w).next((B=>{$=B,$.forEach(((te,K)=>{K.isValidDocument()||(F=F.add(te))}))})).next((()=>g.localDocuments.getOverlayedDocuments(O,$))).next((B=>{j=B;const te=[];for(const K of p){const ae=cA(K,j.get(K.key).overlayedDocument);ae!=null&&te.push(new yo(K.key,ae,c_(ae.value.mapValue),xr.exists(!0)))}return g.mutationQueue.addMutationBatch(O,y,te,p)})).next((B=>{T=B;const te=B.applyToLocalDocumentSet(j,F);return g.documentOverlayCache.saveOverlays(O,B.batchId,te)}))})).then((()=>({batchId:T.batchId,changes:x_(j)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(l.batchId),(function(d,p,g){let y=d.du[d.currentUser.toKey()];y||(y=new hn(gs)),y=y.insert(p,g),d.du[d.currentUser.toKey()]=y})(i,l.batchId,t),await Bu(i,l.changes),await pm(i.remoteStore)}catch(l){const u=jy(l,"Failed to persist write");t.reject(u)}}async function nk(n,e){const t=Qt(n);try{const i=await oI(t.localStore,e);e.targetChanges.forEach(((l,u)=>{const d=t.Au.get(u);d&&(Us(l.addedDocuments.size+l.modifiedDocuments.size+l.removedDocuments.size<=1,22616),l.addedDocuments.size>0?d.hu=!0:l.modifiedDocuments.size>0?Us(d.hu,14607):l.removedDocuments.size>0&&(Us(d.hu,42227),d.hu=!1))})),await Bu(t,i,e)}catch(i){await ic(i)}}function t2(n,e,t){const i=Qt(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const l=[];i.Tu.forEach(((u,d)=>{const p=d.view.va(e);p.snapshot&&l.push(p.snapshot)})),(function(d,p){const g=Qt(d);g.onlineState=p;let y=!1;g.queries.forEach(((w,j)=>{for(const T of j.ba)T.va(p)&&(y=!0)})),y&&Sy(g)})(i.eventManager,e),l.length&&i.Pu.J_(l),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function QI(n,e,t){const i=Qt(n);i.sharedClientState.updateQueryState(e,"rejected",t);const l=i.Au.get(e),u=l&&l.key;if(u){let d=new hn(Nt.comparator);d=d.insert(u,lr.newNoDocument(u,Wt.min()));const p=ys().add(u),g=new hm(Wt.min(),new Map,new hn(gs),d,p);await nk(i,g),i.Ru=i.Ru.remove(u),i.Au.delete(e),Ry(i)}else await Tg(i.localStore,e,!1).then((()=>Ng(i,e,t))).catch(ic)}async function XI(n,e){const t=Qt(n),i=e.batch.batchId;try{const l=await iI(t.localStore,e);ak(t,i,null),rk(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Bu(t,l)}catch(l){await ic(l)}}async function JI(n,e,t){const i=Qt(n);try{const l=await(function(d,p){const g=Qt(d);return g.persistence.runTransaction("Reject batch","readwrite-primary",(y=>{let w;return g.mutationQueue.lookupMutationBatch(y,p).next((j=>(Us(j!==null,37113),w=j.keys(),g.mutationQueue.removeMutationBatch(y,j)))).next((()=>g.mutationQueue.performConsistencyCheck(y))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(y,w,p))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,w))).next((()=>g.localDocuments.getDocuments(y,w)))}))})(i.localStore,e);ak(i,e,t),rk(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Bu(i,l)}catch(l){await ic(l)}}function rk(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function ak(n,e,t){const i=Qt(n);let l=i.du[i.currentUser.toKey()];if(l){const u=l.get(e);u&&(t?u.reject(t):u.resolve(),l=l.remove(e)),i.du[i.currentUser.toKey()]=l}}function Ng(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach((i=>{n.Vu.containsKey(i)||ik(n,i)}))}function ik(n,e){n.Eu.delete(e.path.canonicalString());const t=n.Ru.get(e);t!==null&&(vy(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),Ry(n))}function s2(n,e,t){for(const i of t)i instanceof ek?(n.Vu.addReference(i.key,e),ZI(n,i)):i instanceof tk?(ct(Cy,"Document no longer in limbo: "+i.key),n.Vu.removeReference(i.key,e),n.Vu.containsKey(i.key)||ik(n,i.key)):Lt(19791,{wu:i})}function ZI(n,e){const t=e.key,i=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(i)||(ct(Cy,"New document in limbo: "+t),n.Eu.add(i),Ry(n))}function Ry(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Nt(Zs.fromString(e)),i=n.fu.next();n.Au.set(i,new zI(t)),n.Ru=n.Ru.insert(t,i),K_(n.remoteStore,new Zi(Va(im(t.path)),i,"TargetPurposeLimboResolution",nm.ce))}}async function Bu(n,e,t){const i=Qt(n),l=[],u=[],d=[];i.Tu.isEmpty()||(i.Tu.forEach(((p,g)=>{d.push(i.pu(g,e,t).then((y=>{if((y||t)&&i.isPrimaryClient){const w=y?!y.fromCache:t?.targetChanges.get(g.targetId)?.current;i.sharedClientState.updateQueryState(g.targetId,w?"current":"not-current")}if(y){l.push(y);const w=yy.Es(g.targetId,y);u.push(w)}})))})),await Promise.all(d),i.Pu.J_(l),await(async function(g,y){const w=Qt(g);try{await w.persistence.runTransaction("notifyLocalViewChanges","readwrite",(j=>Oe.forEach(y,(T=>Oe.forEach(T.Ts,(O=>w.persistence.referenceDelegate.addReference(j,T.targetId,O))).next((()=>Oe.forEach(T.Is,(O=>w.persistence.referenceDelegate.removeReference(j,T.targetId,O)))))))))}catch(j){if(!oc(j))throw j;ct(by,"Failed to update sequence numbers: "+j)}for(const j of y){const T=j.targetId;if(!j.fromCache){const O=w.vs.get(T),$=O.snapshotVersion,F=O.withLastLimboFreeSnapshotVersion($);w.vs=w.vs.insert(T,F)}}})(i.localStore,u))}async function eM(n,e){const t=Qt(n);if(!t.currentUser.isEqual(e)){ct(Cy,"User change. New user:",e.toKey());const i=await H_(t.localStore,e);t.currentUser=e,(function(u,d){u.mu.forEach((p=>{p.forEach((g=>{g.reject(new nt(Ce.CANCELLED,d))}))})),u.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Bu(t,i.Ns)}}function tM(n,e){const t=Qt(n),i=t.Au.get(e);if(i&&i.hu)return ys().add(i.key);{let l=ys();const u=t.Iu.get(e);if(!u)return l;for(const d of u){const p=t.Tu.get(d);l=l.unionWith(p.view.nu)}return l}}function ok(n){const e=Qt(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=nk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=tM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=QI.bind(null,e),e.Pu.J_=VI.bind(null,e.eventManager),e.Pu.yu=BI.bind(null,e.eventManager),e}function sM(n){const e=Qt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=XI.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=JI.bind(null,e),e}class Hh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=mm(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return aI(this.persistence,new sI,e.initialUser,this.serializer)}Cu(e){return new q_(gy.Vi,this.serializer)}Du(e){return new hI}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Hh.provider={build:()=>new Hh};class nM extends Hh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Us(this.persistence.referenceDelegate instanceof zh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new FA(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Ar.withCacheSize(this.cacheSizeBytes):Ar.DEFAULT;return new q_((i=>zh.Vi(i,t)),this.serializer)}}class Cg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>t2(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=eM.bind(null,this.syncEngine),await PI(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new OI})()}createDatastore(e){const t=mm(e.databaseInfo.databaseId),i=yI(e.databaseInfo);return _I(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,l,u,d,p){return new jI(i,l,u,d,p)})(this.localStore,this.datastore,e.asyncQueue,(t=>t2(this.syncEngine,t,0)),(function(){return Yx.v()?new Yx:new mI})())}createSyncEngine(e,t){return(function(l,u,d,p,g,y,w){const j=new qI(l,u,d,p,g,y);return w&&(j.gu=!0),j})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=Qt(t);ct(Yo,"RemoteStore shutting down."),i.Ea.add(5),await Vu(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Cg.provider={build:()=>new Cg};class Ay{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):gi("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const mo="FirestoreClient";class rM{constructor(e,t,i,l,u){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=l,this.user=or.UNAUTHENTICATED,this.clientId=ay.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(i,(async d=>{ct(mo,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(i,(d=>(ct(mo,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new di;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=jy(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Lp(n,e){n.asyncQueue.verifyOperationInProgress(),ct(mo,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async l=>{i.isEqual(l)||(await H_(e.localStore,l),i=l)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function n2(n,e){n.asyncQueue.verifyOperationInProgress();const t=await aM(n);ct(mo,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>Xx(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,l)=>Xx(e.remoteStore,l))),n._onlineComponents=e}async function aM(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ct(mo,"Using user provided OfflineComponentProvider");try{await Lp(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(l){return l.name==="FirebaseError"?l.code===Ce.FAILED_PRECONDITION||l.code===Ce.UNIMPLEMENTED:!(typeof DOMException<"u"&&l instanceof DOMException)||l.code===22||l.code===20||l.code===11})(t))throw t;Yl("Error using user provided cache. Falling back to memory cache: "+t),await Lp(n,new Hh)}}else ct(mo,"Using default OfflineComponentProvider"),await Lp(n,new nM(void 0));return n._offlineComponents}async function lk(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ct(mo,"Using user provided OnlineComponentProvider"),await n2(n,n._uninitializedComponentsProvider._online)):(ct(mo,"Using default OnlineComponentProvider"),await n2(n,new Cg))),n._onlineComponents}function iM(n){return lk(n).then((e=>e.syncEngine))}async function $h(n){const e=await lk(n),t=e.eventManager;return t.onListen=HI.bind(null,e.syncEngine),t.onUnlisten=GI.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=$I.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=KI.bind(null,e.syncEngine),t}function oM(n,e,t,i){const l=new Ay(i),u=new Ny(e,l,t);return n.asyncQueue.enqueueAndForget((async()=>Ty(await $h(n),u))),()=>{l.Nu(),n.asyncQueue.enqueueAndForget((async()=>Ey(await $h(n),u)))}}function lM(n,e,t={}){const i=new di;return n.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,y){const w=new Ay({next:T=>{w.Nu(),d.enqueueAndForget((()=>Ey(u,j)));const O=T.docs.has(p);!O&&T.fromCache?y.reject(new nt(Ce.UNAVAILABLE,"Failed to get document because the client is offline.")):O&&T.fromCache&&g&&g.source==="server"?y.reject(new nt(Ce.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(T)},error:T=>y.reject(T)}),j=new Ny(im(p.path),w,{includeMetadataChanges:!0,Ka:!0});return Ty(u,j)})(await $h(n),n.asyncQueue,e,t,i))),i.promise}function cM(n,e,t={}){const i=new di;return n.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,y){const w=new Ay({next:T=>{w.Nu(),d.enqueueAndForget((()=>Ey(u,j))),T.fromCache&&g.source==="server"?y.reject(new nt(Ce.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(T)},error:T=>y.reject(T)}),j=new Ny(p,w,{includeMetadataChanges:!0,Ka:!0});return Ty(u,j)})(await $h(n),n.asyncQueue,e,t,i))),i.promise}function uM(n,e){const t=new di;return n.asyncQueue.enqueueAndForget((async()=>YI(await iM(n),e,t))),t.promise}function ck(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const dM="ComponentProvider",r2=new Map;function hM(n,e,t,i,l){return new IR(n,e,t,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,ck(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator,i)}const uk="firestore.googleapis.com",a2=!0;class i2{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new nt(Ce.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=uk,this.ssl=a2}else this.host=e.host,this.ssl=e.ssl??a2;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=z_;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<BA)throw new nt(Ce.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}xR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ck(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new nt(Ce.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new nt(Ce.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new nt(Ce.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,l){return i.timeoutSeconds===l.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class gm{constructor(e,t,i,l){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=l,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new i2({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new nt(Ce.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new nt(Ce.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new i2(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new uR;switch(i.type){case"firstParty":return new fR(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new nt(Ce.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=r2.get(t);i&&(ct(dM,"Removing Datastore"),r2.delete(t),i.terminate())})(this),Promise.resolve()}}function mM(n,e,t,i={}){n=vr(n,gm);const l=fo(e),u=n._getSettings(),d={...u,emulatorOptions:n._getEmulatorOptions()},p=`${e}:${t}`;l&&(qg(`https://${p}`),Hg("Firestore",!0)),u.host!==uk&&u.host!==p&&Yl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...u,host:p,ssl:l,emulatorOptions:i};if(!Ho(g,d)&&(n._setSettings(g),i.mockUserToken)){let y,w;if(typeof i.mockUserToken=="string")y=i.mockUserToken,w=or.MOCK_USER;else{y=rw(i.mockUserToken,n._app?.options.projectId);const j=i.mockUserToken.sub||i.mockUserToken.user_id;if(!j)throw new nt(Ce.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");w=new or(j)}n._authCredentials=new dR(new Xw(y,w))}}class xi{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new xi(this.firestore,e,this._query)}}class vn{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ao(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new vn(this.firestore,e,this._key)}toJSON(){return{type:vn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Pu(t,vn._jsonSchema))return new vn(e,i||null,new Nt(Zs.fromString(t.referencePath)))}}vn._jsonSchemaVersion="firestore/documentReference/1.0",vn._jsonSchema={type:Pn("string",vn._jsonSchemaVersion),referencePath:Pn("string")};class ao extends xi{constructor(e,t,i){super(e,t,im(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new vn(this.firestore,null,new Nt(e))}withConverter(e){return new ao(this.firestore,e,this._path)}}function zt(n,e,...t){if(n=Gs(n),Jw("collection","path",e),n instanceof gm){const i=Zs.fromString(e,...t);return vx(i),new ao(n,null,i)}{if(!(n instanceof vn||n instanceof ao))throw new nt(Ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Zs.fromString(e,...t));return vx(i),new ao(n.firestore,null,i)}}function ze(n,e,...t){if(n=Gs(n),arguments.length===1&&(e=ay.newId()),Jw("doc","path",e),n instanceof gm){const i=Zs.fromString(e,...t);return bx(i),new vn(n,null,new Nt(i))}{if(!(n instanceof vn||n instanceof ao))throw new nt(Ce.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Zs.fromString(e,...t));return bx(i),new vn(n.firestore,n instanceof ao?n.converter:null,new Nt(i))}}const o2="AsyncQueue";class l2{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new W_(this,"async_queue_retry"),this._c=()=>{const i=Pp();i&&ct(o2,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Pp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Pp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new di;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!oc(e))throw e;ct(o2,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,gi("INTERNAL UNHANDLED ERROR: ",c2(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const l=ky.createAndSchedule(this,e,t,i,(u=>this.hc(u)));return this.tc.push(l),l}uc(){this.nc&&Lt(47125,{Pc:c2(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function c2(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class za extends gm{constructor(e,t,i,l){super(e,t,i,l),this.type="firestore",this._queue=new l2,this._persistenceKey=l?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new l2(e),this._firestoreClient=void 0,await e}}}function fM(n,e){const t=typeof n=="object"?n:Kg(),i=typeof n=="string"?n:Oh,l=Jh(t,"firestore").getImmediate({identifier:i});if(!l._initialized){const u=tw("firestore");u&&mM(l,...u)}return l}function Uu(n){if(n._terminated)throw new nt(Ce.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||pM(n),n._firestoreClient}function pM(n){const e=n._freezeSettings(),t=hM(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new rM(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(l){const u=l?._online.build();return{_offline:l?._offline.build(u),_online:u}})(n._componentsProvider))}class na{constructor(e){this._byteString=e}static fromBase64String(e){try{return new na(tr.fromBase64String(e))}catch(t){throw new nt(Ce.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new na(tr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:na._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Pu(e,na._jsonSchema))return na.fromBase64String(e.bytes)}}na._jsonSchemaVersion="firestore/bytes/1.0",na._jsonSchema={type:Pn("string",na._jsonSchemaVersion),bytes:Pn("string")};class ym{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new nt(Ce.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new er(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Fu{constructor(e){this._methodName=e}}class Ua{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new nt(Ce.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new nt(Ce.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return gs(this._lat,e._lat)||gs(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ua._jsonSchemaVersion}}static fromJSON(e){if(Pu(e,Ua._jsonSchema))return new Ua(e.latitude,e.longitude)}}Ua._jsonSchemaVersion="firestore/geoPoint/1.0",Ua._jsonSchema={type:Pn("string",Ua._jsonSchemaVersion),latitude:Pn("number"),longitude:Pn("number")};class ya{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,l){if(i.length!==l.length)return!1;for(let u=0;u<i.length;++u)if(i[u]!==l[u])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ya._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Pu(e,ya._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ya(e.vectorValues);throw new nt(Ce.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ya._jsonSchemaVersion="firestore/vectorValue/1.0",ya._jsonSchema={type:Pn("string",ya._jsonSchemaVersion),vectorValues:Pn("object")};const gM=/^__.*__$/;class yM{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new yo(e,this.data,this.fieldMask,t,this.fieldTransforms):new Lu(e,this.data,t,this.fieldTransforms)}}class dk{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new yo(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function hk(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Lt(40011,{dataSource:n})}}class Iy{constructor(e,t,i,l,u,d){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=l,u===void 0&&this.validatePath(),this.fieldTransforms=u||[],this.fieldMask=d||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Iy({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Wh(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(hk(this.dataSource)&&gM.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class bM{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||mm(e)}createContext(e,t,i,l=!1){return new Iy({dataSource:e,methodName:t,targetDoc:i,path:er.emptyPath(),arrayElement:!1,hasConverter:l},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function zu(n){const e=n._freezeSettings(),t=mm(n._databaseId);return new bM(n._databaseId,!!e.ignoreUndefinedProperties,t)}function My(n,e,t,i,l,u={}){const d=n.createContext(u.merge||u.mergeFields?2:0,e,t,l);Ly("Data must be an object, but it was:",d,i);const p=pk(i,d);let g,y;if(u.merge)g=new $r(d.fieldMask),y=d.fieldTransforms;else if(u.mergeFields){const w=[];for(const j of u.mergeFields){const T=Qo(e,j,t);if(!d.contains(T))throw new nt(Ce.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);bk(w,T)||w.push(T)}g=new $r(w),y=d.fieldTransforms.filter((j=>g.covers(j.field)))}else g=null,y=d.fieldTransforms;return new yM(new Ir(p),g,y)}class bm extends Fu{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof bm}}class Dy extends Fu{_toFieldTransform(e){return new N_(e.path,new ku)}isEqual(e){return e instanceof Dy}}class Py extends Fu{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new Eu(e.serializer,k_(e.serializer,this.Vc));return new N_(e.path,t)}isEqual(e){return e instanceof Py&&this.Vc===e.Vc}}function mk(n,e,t,i){const l=n.createContext(1,e,t);Ly("Data must be an object, but it was:",l,i);const u=[],d=Ir.empty();go(i,((g,y)=>{const w=yk(e,g,t);y=Gs(y);const j=l.childContextForFieldPath(w);if(y instanceof bm)u.push(w);else{const T=qu(y,j);T!=null&&(u.push(w),d.set(w,T))}}));const p=new $r(u);return new dk(d,p,l.fieldTransforms)}function fk(n,e,t,i,l,u){const d=n.createContext(1,e,t),p=[Qo(e,i,t)],g=[l];if(u.length%2!=0)throw new nt(Ce.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<u.length;T+=2)p.push(Qo(e,u[T])),g.push(u[T+1]);const y=[],w=Ir.empty();for(let T=p.length-1;T>=0;--T)if(!bk(y,p[T])){const O=p[T];let $=g[T];$=Gs($);const F=d.childContextForFieldPath(O);if($ instanceof bm)y.push(O);else{const B=qu($,F);B!=null&&(y.push(O),w.set(O,B))}}const j=new $r(y);return new dk(w,j,d.fieldTransforms)}function vM(n,e,t,i=!1){return qu(t,n.createContext(i?4:3,e))}function qu(n,e){if(gk(n=Gs(n)))return Ly("Unsupported field value:",e,n),pk(n,e);if(n instanceof Fu)return(function(i,l){if(!hk(l.dataSource))throw l.createError(`${i._methodName}() can only be used with update() and set()`);if(!l.path)throw l.createError(`${i._methodName}() is not currently supported inside arrays`);const u=i._toFieldTransform(l);u&&l.fieldTransforms.push(u)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,l){const u=[];let d=0;for(const p of i){let g=qu(p,l.childContextForArray(d));g==null&&(g={nullValue:"NULL_VALUE"}),u.push(g),d++}return{arrayValue:{values:u}}})(n,e)}return(function(i,l){if((i=Gs(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return k_(l.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const u=xt.fromDate(i);return{timestampValue:Fh(l.serializer,u)}}if(i instanceof xt){const u=new xt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Fh(l.serializer,u)}}if(i instanceof Ua)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof na)return{bytesValue:D_(l.serializer,i._byteString)};if(i instanceof vn){const u=l.databaseId,d=i.firestore._databaseId;if(!d.isEqual(u))throw l.createError(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:fy(i.firestore._databaseId||l.databaseId,i._key.path)}}if(i instanceof ya)return(function(d,p){const g=d instanceof ya?d.toArray():d;return{mapValue:{fields:{[o_]:{stringValue:l_},[Vh]:{arrayValue:{values:g.map((w=>{if(typeof w!="number")throw p.createError("VectorValues must only contain numeric values.");return dy(p.serializer,w)}))}}}}}})(i,l);if(F_(i))return i._toProto(l.serializer);throw l.createError(`Unsupported field value: ${sm(i)}`)})(n,e)}function pk(n,e){const t={};return t_(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):go(n,((i,l)=>{const u=qu(l,e.childContextForField(i));u!=null&&(t[i]=u)})),{mapValue:{fields:t}}}function gk(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof xt||n instanceof Ua||n instanceof na||n instanceof vn||n instanceof Fu||n instanceof ya||F_(n))}function Ly(n,e,t){if(!gk(t)||!Zw(t)){const i=sm(t);throw i==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+i)}}function Qo(n,e,t){if((e=Gs(e))instanceof ym)return e._internalPath;if(typeof e=="string")return yk(n,e);throw Wh("Field path arguments must be of type string or ",n,!1,void 0,t)}const xM=new RegExp("[~\\*/\\[\\]]");function yk(n,e,t){if(e.search(xM)>=0)throw Wh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ym(...e.split("."))._internalPath}catch{throw Wh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Wh(n,e,t,i,l){const u=i&&!i.isEmpty(),d=l!==void 0;let p=`Function ${e}() called with invalid data`;t&&(p+=" (via `toFirestore()`)"),p+=". ";let g="";return(u||d)&&(g+=" (found",u&&(g+=` in field ${i}`),d&&(g+=` in document ${l}`),g+=")"),new nt(Ce.INVALID_ARGUMENT,p+n+g)}function bk(n,e){return n.some((t=>t.isEqual(e)))}class wM{convertValue(e,t="none"){switch(uo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Sn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(co(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Lt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return go(e,((l,u)=>{i[l]=this.convertValue(u,t)})),i}convertVectorValue(e){const t=e.fields?.[Vh].arrayValue?.values?.map((i=>Sn(i.doubleValue)));return new ya(t)}convertGeoPoint(e){return new Ua(Sn(e.latitude),Sn(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=am(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(vu(e));default:return null}}convertTimestamp(e){const t=lo(e);return new xt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=Zs.fromString(e);Us(U_(i),9688,{name:e});const l=new xu(i.get(1),i.get(3)),u=new Nt(i.popFirst(5));return l.isEqual(t)||gi(`Document ${u} contains a document reference within a different database (${l.projectId}/${l.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),u}}class Oy extends wM{constructor(e){super(),this.firestore=e}convertBytes(e){return new na(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new vn(this.firestore,null,t)}}function Hr(){return new Dy("serverTimestamp")}function Bo(n){return new Py("increment",n)}const u2="@firebase/firestore",d2="4.10.0";function h2(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;const l=t;for(const u of i)if(u in l&&typeof l[u]=="function")return!0;return!1})(n,["next","error","complete"])}class vk{constructor(e,t,i,l,u){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=l,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new vn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new _M(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(Qo("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class _M extends vk{data(){return super.data()}}function xk(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new nt(Ce.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Vy{}class By extends Vy{}function Ds(n,e,...t){let i=[];e instanceof Vy&&i.push(e),i=i.concat(t),(function(u){const d=u.filter((g=>g instanceof Uy)).length,p=u.filter((g=>g instanceof vm)).length;if(d>1||d>0&&p>0)throw new nt(Ce.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const l of i)n=l._apply(n);return n}class vm extends By{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new vm(e,t,i)}_apply(e){const t=this._parse(e);return wk(e._query,t),new xi(e.firestore,e.converter,xg(e._query,t))}_parse(e){const t=zu(e.firestore);return(function(u,d,p,g,y,w,j){let T;if(y.isKeyField()){if(w==="array-contains"||w==="array-contains-any")throw new nt(Ce.INVALID_ARGUMENT,`Invalid Query. You can't perform '${w}' queries on documentId().`);if(w==="in"||w==="not-in"){f2(j,w);const $=[];for(const F of j)$.push(m2(g,u,F));T={arrayValue:{values:$}}}else T=m2(g,u,j)}else w!=="in"&&w!=="not-in"&&w!=="array-contains-any"||f2(j,w),T=vM(p,d,j,w==="in"||w==="not-in");return Dn.create(y,w,T)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function ds(n,e,t){const i=e,l=Qo("where",n);return vm._create(l,i,t)}class Uy extends Vy{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Uy(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:va.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(l,u){let d=l;const p=u.getFlattenedFilters();for(const g of p)wk(d,g),d=xg(d,g)})(e._query,t),new xi(e.firestore,e.converter,xg(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Fy extends By{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Fy(e,t)}_apply(e){const t=(function(l,u,d){if(l.startAt!==null)throw new nt(Ce.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(l.endAt!==null)throw new nt(Ce.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new _u(u,d)})(e._query,this._field,this._direction);return new xi(e.firestore,e.converter,QR(e._query,t))}}function Gh(n,e="asc"){const t=e,i=Qo("orderBy",n);return Fy._create(i,t)}class zy extends By{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new zy(e,t,i)}_apply(e){return new xi(e.firestore,e.converter,Uh(e._query,this._limit,this._limitType))}}function Kh(n){return wR("limit",n),zy._create("limit",n,"F")}function m2(n,e,t){if(typeof(t=Gs(t))=="string"){if(t==="")throw new nt(Ce.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!g_(e)&&t.indexOf("/")!==-1)throw new nt(Ce.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(Zs.fromString(t));if(!Nt.isDocumentKey(i))throw new nt(Ce.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Sx(n,new Nt(i))}if(t instanceof vn)return Sx(n,t._key);throw new nt(Ce.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${sm(t)}.`)}function f2(n,e){if(!Array.isArray(n)||n.length===0)throw new nt(Ce.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function wk(n,e){const t=(function(l,u){for(const d of l)for(const p of d.getFlattenedFilters())if(u.indexOf(p.op)>=0)return p.op;return null})(n.filters,(function(l){switch(l){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new nt(Ce.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new nt(Ce.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function qy(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class au{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Uo extends vk{constructor(e,t,i,l,u,d){super(e,t,i,l,d),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Th(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(Qo("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new nt(Ce.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Uo._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Uo._jsonSchemaVersion="firestore/documentSnapshot/1.0",Uo._jsonSchema={type:Pn("string",Uo._jsonSchemaVersion),bundleSource:Pn("string","DocumentSnapshot"),bundleName:Pn("string"),bundle:Pn("string")};class Th extends Uo{data(e={}){return super.data(e)}}class Fo{constructor(e,t,i,l){this._firestore=e,this._userDataWriter=t,this._snapshot=l,this.metadata=new au(l.hasPendingWrites,l.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Th(this._firestore,this._userDataWriter,i.key,i,new au(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new nt(Ce.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(l,u){if(l._snapshot.oldDocs.isEmpty()){let d=0;return l._snapshot.docChanges.map((p=>{const g=new Th(l._firestore,l._userDataWriter,p.doc.key,p.doc,new au(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);return p.doc,{type:"added",doc:g,oldIndex:-1,newIndex:d++}}))}{let d=l._snapshot.oldDocs;return l._snapshot.docChanges.filter((p=>u||p.type!==3)).map((p=>{const g=new Th(l._firestore,l._userDataWriter,p.doc.key,p.doc,new au(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);let y=-1,w=-1;return p.type!==0&&(y=d.indexOf(p.doc.key),d=d.delete(p.doc.key)),p.type!==1&&(d=d.add(p.doc),w=d.indexOf(p.doc.key)),{type:kM(p.type),doc:g,oldIndex:y,newIndex:w}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new nt(Ce.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Fo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ay.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],l=[];return this.docs.forEach((u=>{u._document!==null&&(t.push(u._document),i.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),l.push(u.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function kM(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Lt(61501,{type:n})}}Fo._jsonSchemaVersion="firestore/querySnapshot/1.0",Fo._jsonSchema={type:Pn("string",Fo._jsonSchemaVersion),bundleSource:Pn("string","QuerySnapshot"),bundleName:Pn("string"),bundle:Pn("string")};class jM{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=zu(e)}set(e,t,i){this._verifyNotCommitted();const l=Op(e,this._firestore),u=qy(l.converter,t,i),d=My(this._dataReader,"WriteBatch.set",l._key,u,l.converter!==null,i);return this._mutations.push(d.toMutation(l._key,xr.none())),this}update(e,t,i,...l){this._verifyNotCommitted();const u=Op(e,this._firestore);let d;return d=typeof(t=Gs(t))=="string"||t instanceof ym?fk(this._dataReader,"WriteBatch.update",u._key,t,i,l):mk(this._dataReader,"WriteBatch.update",u._key,t),this._mutations.push(d.toMutation(u._key,xr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Op(e,this._firestore);return this._mutations=this._mutations.concat(new dm(t._key,xr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new nt(Ce.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Op(n,e){if((n=Gs(n)).firestore!==e)throw new nt(Ce.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}function Rs(n){n=vr(n,vn);const e=vr(n.firestore,za),t=Uu(e);return lM(t,n._key).then((i=>kk(e,n,i)))}function Ts(n){n=vr(n,xi);const e=vr(n.firestore,za),t=Uu(e),i=new Oy(e);return xk(n._query),cM(t,n._query).then((l=>new Fo(e,i,n,l)))}function Es(n,e,t){n=vr(n,vn);const i=vr(n.firestore,za),l=qy(n.converter,e,t),u=zu(i);return Hu(i,[My(u,"setDoc",n._key,l,n.converter!==null,t).toMutation(n._key,xr.none())])}function Ma(n,e,t,...i){n=vr(n,vn);const l=vr(n.firestore,za),u=zu(l);let d;return d=typeof(e=Gs(e))=="string"||e instanceof ym?fk(u,"updateDoc",n._key,e,t,i):mk(u,"updateDoc",n._key,e),Hu(l,[d.toMutation(n._key,xr.exists(!0))])}function yr(n){return Hu(vr(n.firestore,za),[new dm(n._key,xr.none())])}function hi(n,e){const t=vr(n.firestore,za),i=ze(n),l=qy(n.converter,e),u=zu(n.firestore);return Hu(t,[My(u,"addDoc",i._key,l,n.converter!==null,{}).toMutation(i._key,xr.exists(!1))]).then((()=>i))}function _k(n,...e){n=Gs(n);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||h2(e[i])||(t=e[i++]);const l={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(h2(e[i])){const y=e[i];e[i]=y.next?.bind(y),e[i+1]=y.error?.bind(y),e[i+2]=y.complete?.bind(y)}let u,d,p;if(n instanceof vn)d=vr(n.firestore,za),p=im(n._key.path),u={next:y=>{e[i]&&e[i](kk(d,n,y))},error:e[i+1],complete:e[i+2]};else{const y=vr(n,xi);d=vr(y.firestore,za),p=y._query;const w=new Oy(d);u={next:j=>{e[i]&&e[i](new Fo(d,w,y,j))},error:e[i+1],complete:e[i+2]},xk(n._query)}const g=Uu(d);return oM(g,p,l,u)}function Hu(n,e){const t=Uu(n);return uM(t,e)}function kk(n,e,t){const i=t.docs.get(e._key),l=new Oy(n);return new Uo(n,l,e._key,i,new au(t.hasPendingWrites,t.fromCache),e.converter)}function p2(n){return n=vr(n,za),Uu(n),new jM(n,(e=>Hu(n,e)))}(function(e,t=!0){cR(Jo),$o(new io("firestore",((i,{instanceIdentifier:l,options:u})=>{const d=i.getProvider("app").getImmediate(),p=new za(new hR(i.getProvider("auth-internal")),new pR(d,i.getProvider("app-check-internal")),MR(d,l),d);return u={useFetchStreams:t,...u},p._setSettings(u),p}),"PUBLIC").setMultipleInstances(!0)),Pa(u2,d2,e),Pa(u2,d2,"esm2020")})();var TM="firebase",EM="12.8.0";Pa(TM,EM,"app");const jk="firebasestorage.googleapis.com",Tk="storageBucket",SM=120*1e3,NM=600*1e3;class wn extends qa{constructor(e,t,i=0){super(Vp(e),`Firebase Storage: ${t} (${Vp(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,wn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Vp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var xn;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(xn||(xn={}));function Vp(n){return"storage/"+n}function Hy(){const n="An unknown error occurred, please check the error payload for server response.";return new wn(xn.UNKNOWN,n)}function CM(n){return new wn(xn.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function RM(n){return new wn(xn.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function AM(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new wn(xn.UNAUTHENTICATED,n)}function IM(){return new wn(xn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function MM(n){return new wn(xn.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function DM(){return new wn(xn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function PM(){return new wn(xn.CANCELED,"User canceled the upload/download.")}function LM(n){return new wn(xn.INVALID_URL,"Invalid URL '"+n+"'.")}function OM(n){return new wn(xn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function VM(){return new wn(xn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Tk+"' property when initializing the app?")}function BM(){return new wn(xn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function UM(){return new wn(xn.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function FM(n){return new wn(xn.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Rg(n){return new wn(xn.INVALID_ARGUMENT,n)}function Ek(){return new wn(xn.APP_DELETED,"The Firebase app was deleted.")}function zM(n){return new wn(xn.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function hu(n,e){return new wn(xn.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Qc(n){throw new wn(xn.INTERNAL_ERROR,"Internal error: "+n)}class br{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=br.makeFromUrl(e,t)}catch{return new br(e,"")}if(i.path==="")return i;throw OM(e)}static makeFromUrl(e,t){let i=null;const l="([A-Za-z0-9.\\-_]+)";function u(be){be.path.charAt(be.path.length-1)==="/"&&(be.path_=be.path_.slice(0,-1))}const d="(/(.*))?$",p=new RegExp("^gs://"+l+d,"i"),g={bucket:1,path:3};function y(be){be.path_=decodeURIComponent(be.path)}const w="v[A-Za-z0-9_]+",j=t.replace(/[.]/g,"\\."),T="(/([^?#]*).*)?$",O=new RegExp(`^https?://${j}/${w}/b/${l}/o${T}`,"i"),$={bucket:1,path:3},F=t===jk?"(?:storage.googleapis.com|storage.cloud.google.com)":t,B="([^?#]*)",te=new RegExp(`^https?://${F}/${l}/${B}`,"i"),ae=[{regex:p,indices:g,postModify:u},{regex:O,indices:$,postModify:y},{regex:te,indices:{bucket:1,path:2},postModify:y}];for(let be=0;be<ae.length;be++){const ve=ae[be],_e=ve.regex.exec(e);if(_e){const R=_e[ve.indices.bucket];let E=_e[ve.indices.path];E||(E=""),i=new br(R,E),ve.postModify(i);break}}if(i==null)throw LM(e);return i}}class qM{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function HM(n,e,t){let i=1,l=null,u=null,d=!1,p=0;function g(){return p===2}let y=!1;function w(...B){y||(y=!0,e.apply(null,B))}function j(B){l=setTimeout(()=>{l=null,n(O,g())},B)}function T(){u&&clearTimeout(u)}function O(B,...te){if(y){T();return}if(B){T(),w.call(null,B,...te);return}if(g()||d){T(),w.call(null,B,...te);return}i<64&&(i*=2);let ae;p===1?(p=2,ae=0):ae=(i+Math.random())*1e3,j(ae)}let $=!1;function F(B){$||($=!0,T(),!y&&(l!==null?(B||(p=2),clearTimeout(l),j(0)):B||(p=1)))}return j(0),u=setTimeout(()=>{d=!0,F(!0)},t),F}function $M(n){n(!1)}function WM(n){return n!==void 0}function GM(n){return typeof n=="object"&&!Array.isArray(n)}function $y(n){return typeof n=="string"||n instanceof String}function g2(n){return Wy()&&n instanceof Blob}function Wy(){return typeof Blob<"u"}function Ag(n,e,t,i){if(i<e)throw Rg(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw Rg(`Invalid value for '${n}'. Expected ${t} or less.`)}function xm(n,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${n}`}function Sk(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const l=e(i)+"="+e(n[i]);t=t+l+"&"}return t=t.slice(0,-1),t}var zo;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(zo||(zo={}));function KM(n,e){const t=n>=500&&n<600,l=[408,429].indexOf(n)!==-1,u=e.indexOf(n)!==-1;return t||l||u}class YM{constructor(e,t,i,l,u,d,p,g,y,w,j,T=!0,O=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=l,this.successCodes_=u,this.additionalRetryCodes_=d,this.callback_=p,this.errorCallback_=g,this.timeout_=y,this.progressCallback_=w,this.connectionFactory_=j,this.retry=T,this.isUsingEmulator=O,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise(($,F)=>{this.resolve_=$,this.reject_=F,this.start_()})}start_(){const e=(i,l)=>{if(l){i(!1,new ih(!1,null,!0));return}const u=this.connectionFactory_();this.pendingConnection_=u;const d=p=>{const g=p.loaded,y=p.lengthComputable?p.total:-1;this.progressCallback_!==null&&this.progressCallback_(g,y)};this.progressCallback_!==null&&u.addUploadProgressListener(d),u.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&u.removeUploadProgressListener(d),this.pendingConnection_=null;const p=u.getErrorCode()===zo.NO_ERROR,g=u.getStatus();if(!p||KM(g,this.additionalRetryCodes_)&&this.retry){const w=u.getErrorCode()===zo.ABORT;i(!1,new ih(!1,null,w));return}const y=this.successCodes_.indexOf(g)!==-1;i(!0,new ih(y,u))})},t=(i,l)=>{const u=this.resolve_,d=this.reject_,p=l.connection;if(l.wasSuccessCode)try{const g=this.callback_(p,p.getResponse());WM(g)?u(g):u()}catch(g){d(g)}else if(p!==null){const g=Hy();g.serverResponse=p.getErrorText(),this.errorCallback_?d(this.errorCallback_(p,g)):d(g)}else if(l.canceled){const g=this.appDelete_?Ek():PM();d(g)}else{const g=DM();d(g)}};this.canceled_?t(!1,new ih(!1,null,!0)):this.backoffId_=HM(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&$M(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class ih{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function QM(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function XM(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function JM(n,e){e&&(n["X-Firebase-GMPID"]=e)}function ZM(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function e3(n,e,t,i,l,u,d=!0,p=!1){const g=Sk(n.urlParams),y=n.url+g,w=Object.assign({},n.headers);return JM(w,e),QM(w,t),XM(w,u),ZM(w,i),new YM(y,n.method,w,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,l,d,p)}function t3(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function s3(...n){const e=t3();if(e!==void 0){const t=new e;for(let i=0;i<n.length;i++)t.append(n[i]);return t.getBlob()}else{if(Wy())return new Blob(n);throw new wn(xn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function n3(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function r3(n){if(typeof atob>"u")throw FM("base-64");return atob(n)}const Da={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Bp{constructor(e,t){this.data=e,this.contentType=t||null}}function a3(n,e){switch(n){case Da.RAW:return new Bp(Nk(e));case Da.BASE64:case Da.BASE64URL:return new Bp(Ck(n,e));case Da.DATA_URL:return new Bp(o3(e),l3(e))}throw Hy()}function Nk(n){const e=[];for(let t=0;t<n.length;t++){let i=n.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const u=i,d=n.charCodeAt(++t);i=65536|(u&1023)<<10|d&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function i3(n){let e;try{e=decodeURIComponent(n)}catch{throw hu(Da.DATA_URL,"Malformed data URL.")}return Nk(e)}function Ck(n,e){switch(n){case Da.BASE64:{const l=e.indexOf("-")!==-1,u=e.indexOf("_")!==-1;if(l||u)throw hu(n,"Invalid character '"+(l?"-":"_")+"' found: is it base64url encoded?");break}case Da.BASE64URL:{const l=e.indexOf("+")!==-1,u=e.indexOf("/")!==-1;if(l||u)throw hu(n,"Invalid character '"+(l?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=r3(e)}catch(l){throw l.message.includes("polyfill")?l:hu(n,"Invalid character found")}const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i}class Rk{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw hu(Da.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=c3(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function o3(n){const e=new Rk(n);return e.base64?Ck(Da.BASE64,e.rest):i3(e.rest)}function l3(n){return new Rk(n).contentType}function c3(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}class Ji{constructor(e,t){let i=0,l="";g2(e)?(this.data_=e,i=e.size,l=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=l}size(){return this.size_}type(){return this.type_}slice(e,t){if(g2(this.data_)){const i=this.data_,l=n3(i,e,t);return l===null?null:new Ji(l)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new Ji(i,!0)}}static getBlob(...e){if(Wy()){const t=e.map(i=>i instanceof Ji?i.data_:i);return new Ji(s3.apply(null,t))}else{const t=e.map(d=>$y(d)?a3(Da.RAW,d).data:d.data_);let i=0;t.forEach(d=>{i+=d.byteLength});const l=new Uint8Array(i);let u=0;return t.forEach(d=>{for(let p=0;p<d.length;p++)l[u++]=d[p]}),new Ji(l,!0)}}uploadData(){return this.data_}}function Gy(n){let e;try{e=JSON.parse(n)}catch{return null}return GM(e)?e:null}function u3(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function d3(n,e){const t=e.split("/").filter(i=>i.length>0).join("/");return n.length===0?t:n+"/"+t}function Ak(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function h3(n,e){return e}class gr{constructor(e,t,i,l){this.server=e,this.local=t||e,this.writable=!!i,this.xform=l||h3}}let oh=null;function m3(n){return!$y(n)||n.length<2?n:Ak(n)}function Ik(){if(oh)return oh;const n=[];n.push(new gr("bucket")),n.push(new gr("generation")),n.push(new gr("metageneration")),n.push(new gr("name","fullPath",!0));function e(u,d){return m3(d)}const t=new gr("name");t.xform=e,n.push(t);function i(u,d){return d!==void 0?Number(d):d}const l=new gr("size");return l.xform=i,n.push(l),n.push(new gr("timeCreated")),n.push(new gr("updated")),n.push(new gr("md5Hash",null,!0)),n.push(new gr("cacheControl",null,!0)),n.push(new gr("contentDisposition",null,!0)),n.push(new gr("contentEncoding",null,!0)),n.push(new gr("contentLanguage",null,!0)),n.push(new gr("contentType",null,!0)),n.push(new gr("metadata","customMetadata",!0)),oh=n,oh}function f3(n,e){function t(){const i=n.bucket,l=n.fullPath,u=new br(i,l);return e._makeStorageReference(u)}Object.defineProperty(n,"ref",{get:t})}function p3(n,e,t){const i={};i.type="file";const l=t.length;for(let u=0;u<l;u++){const d=t[u];i[d.local]=d.xform(i,e[d.server])}return f3(i,n),i}function Mk(n,e,t){const i=Gy(e);return i===null?null:p3(n,i,t)}function g3(n,e,t,i){const l=Gy(e);if(l===null||!$y(l.downloadTokens))return null;const u=l.downloadTokens;if(u.length===0)return null;const d=encodeURIComponent;return u.split(",").map(y=>{const w=n.bucket,j=n.fullPath,T="/b/"+d(w)+"/o/"+d(j),O=xm(T,t,i),$=Sk({alt:"media",token:y});return O+$})[0]}function y3(n,e){const t={},i=e.length;for(let l=0;l<i;l++){const u=e[l];u.writable&&(t[u.server]=n[u.local])}return JSON.stringify(t)}const y2="prefixes",b2="items";function b3(n,e,t){const i={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[y2])for(const l of t[y2]){const u=l.replace(/\/$/,""),d=n._makeStorageReference(new br(e,u));i.prefixes.push(d)}if(t[b2])for(const l of t[b2]){const u=n._makeStorageReference(new br(e,l.name));i.items.push(u)}return i}function v3(n,e,t){const i=Gy(t);return i===null?null:b3(n,e,i)}class Ky{constructor(e,t,i,l){this.url=e,this.method=t,this.handler=i,this.timeout=l,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Yy(n){if(!n)throw Hy()}function x3(n,e){function t(i,l){const u=Mk(n,l,e);return Yy(u!==null),u}return t}function w3(n,e){function t(i,l){const u=v3(n,e,l);return Yy(u!==null),u}return t}function _3(n,e){function t(i,l){const u=Mk(n,l,e);return Yy(u!==null),g3(u,l,n.host,n._protocol)}return t}function Qy(n){function e(t,i){let l;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?l=IM():l=AM():t.getStatus()===402?l=RM(n.bucket):t.getStatus()===403?l=MM(n.path):l=i,l.status=t.getStatus(),l.serverResponse=i.serverResponse,l}return e}function k3(n){const e=Qy(n);function t(i,l){let u=e(i,l);return i.getStatus()===404&&(u=CM(n.path)),u.serverResponse=l.serverResponse,u}return t}function j3(n,e,t,i,l){const u={};e.isRoot?u.prefix="":u.prefix=e.path+"/",t.length>0&&(u.delimiter=t),i&&(u.pageToken=i),l&&(u.maxResults=l);const d=e.bucketOnlyServerUrl(),p=xm(d,n.host,n._protocol),g="GET",y=n.maxOperationRetryTime,w=new Ky(p,g,w3(n,e.bucket),y);return w.urlParams=u,w.errorHandler=Qy(e),w}function T3(n,e,t){const i=e.fullServerUrl(),l=xm(i,n.host,n._protocol),u="GET",d=n.maxOperationRetryTime,p=new Ky(l,u,_3(n,t),d);return p.errorHandler=k3(e),p}function E3(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function S3(n,e,t){const i=Object.assign({},t);return i.fullPath=n.path,i.size=e.size(),i.contentType||(i.contentType=E3(null,e)),i}function N3(n,e,t,i,l){const u=e.bucketOnlyServerUrl(),d={"X-Goog-Upload-Protocol":"multipart"};function p(){let ae="";for(let be=0;be<2;be++)ae=ae+Math.random().toString().slice(2);return ae}const g=p();d["Content-Type"]="multipart/related; boundary="+g;const y=S3(e,i,l),w=y3(y,t),j="--"+g+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+w+`\r
--`+g+`\r
Content-Type: `+y.contentType+`\r
\r
`,T=`\r
--`+g+"--",O=Ji.getBlob(j,i,T);if(O===null)throw BM();const $={name:y.fullPath},F=xm(u,n.host,n._protocol),B="POST",te=n.maxUploadRetryTime,K=new Ky(F,B,x3(n,t),te);return K.urlParams=$,K.headers=d,K.body=O.uploadData(),K.errorHandler=Qy(e),K}class C3{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=zo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=zo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=zo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,l,u){if(this.sent_)throw Qc("cannot .send() more than once");if(fo(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),u!==void 0)for(const d in u)u.hasOwnProperty(d)&&this.xhr_.setRequestHeader(d,u[d].toString());return l!==void 0?this.xhr_.send(l):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Qc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Qc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Qc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Qc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class R3 extends C3{initXhr(){this.xhr_.responseType="text"}}function Xy(){return new R3}class Xo{constructor(e,t){this._service=e,t instanceof br?this._location=t:this._location=br.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Xo(e,t)}get root(){const e=new br(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Ak(this._location.path)}get storage(){return this._service}get parent(){const e=u3(this._location.path);if(e===null)return null;const t=new br(this._location.bucket,e);return new Xo(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw zM(e)}}function A3(n,e,t){n._throwIfRoot("uploadBytes");const i=N3(n.storage,n._location,Ik(),new Ji(e,!0),t);return n.storage.makeRequestWithTokens(i,Xy).then(l=>({metadata:l,ref:n}))}function I3(n){const e={prefixes:[],items:[]};return Dk(n,e).then(()=>e)}async function Dk(n,e,t){const l=await M3(n,{pageToken:t});e.prefixes.push(...l.prefixes),e.items.push(...l.items),l.nextPageToken!=null&&await Dk(n,e,l.nextPageToken)}function M3(n,e){e!=null&&typeof e.maxResults=="number"&&Ag("options.maxResults",1,1e3,e.maxResults);const t=e||{},i=j3(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(i,Xy)}function D3(n){n._throwIfRoot("getDownloadURL");const e=T3(n.storage,n._location,Ik());return n.storage.makeRequestWithTokens(e,Xy).then(t=>{if(t===null)throw UM();return t})}function P3(n,e){const t=d3(n._location.path,e),i=new br(n._location.bucket,t);return new Xo(n.storage,i)}function L3(n){return/^[A-Za-z]+:\/\//.test(n)}function O3(n,e){return new Xo(n,e)}function Pk(n,e){if(n instanceof Jy){const t=n;if(t._bucket==null)throw VM();const i=new Xo(t,t._bucket);return e!=null?Pk(i,e):i}else return e!==void 0?P3(n,e):n}function V3(n,e){if(e&&L3(e)){if(n instanceof Jy)return O3(n,e);throw Rg("To use ref(service, url), the first argument must be a Storage instance.")}else return Pk(n,e)}function v2(n,e){const t=e?.[Tk];return t==null?null:br.makeFromBucketSpec(t,n)}function B3(n,e,t,i={}){n.host=`${e}:${t}`;const l=fo(e);l&&(qg(`https://${n.host}/b`),Hg("Storage",!0)),n._isUsingEmulator=!0,n._protocol=l?"https":"http";const{mockUserToken:u}=i;u&&(n._overrideAuthToken=typeof u=="string"?u:rw(u,n.app.options.projectId))}class Jy{constructor(e,t,i,l,u,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=l,this._firebaseVersion=u,this._isUsingEmulator=d,this._bucket=null,this._host=jk,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=SM,this._maxUploadRetryTime=NM,this._requests=new Set,l!=null?this._bucket=br.makeFromBucketSpec(l,this._host):this._bucket=v2(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=br.makeFromBucketSpec(this._url,e):this._bucket=v2(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Ag("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Ag("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(qr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Xo(this,e)}_makeRequest(e,t,i,l,u=!0){if(this._deleted)return new qM(Ek());{const d=e3(e,this._appId,i,l,t,this._firebaseVersion,u,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[i,l]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,l).getPromise()}}const x2="@firebase/storage",w2="0.14.0";const Lk="storage";function Up(n,e,t){return n=Gs(n),A3(n,e,t)}function _2(n){return n=Gs(n),I3(n)}function qo(n){return n=Gs(n),D3(n)}function eo(n,e){return n=Gs(n),V3(n,e)}function U3(n=Kg(),e){n=Gs(n);const i=Jh(n,Lk).getImmediate({identifier:e}),l=tw("storage");return l&&F3(i,...l),i}function F3(n,e,t,i={}){B3(n,e,t,i)}function z3(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),l=n.getProvider("app-check-internal");return new Jy(t,i,l,e,Jo)}function q3(){$o(new io(Lk,z3,"PUBLIC").setMultipleInstances(!0)),Pa(x2,w2,""),Pa(x2,w2,"esm2020")}q3();const Ok={apiKey:"AIzaSyBCIgMJd3By7qkWH27YiW9VooIBGE3bFLs",authDomain:"mind-core-fitness-client.firebaseapp.com",projectId:"mind-core-fitness-client",storageBucket:"mind-core-fitness-client.firebasestorage.app",messagingSenderId:"669343392406",appId:"1:669343392406:web:f5a35ee062387e7d6f58b7"},Zy=Gg(Ok),Do=qw(Zy),ge=fM(Zy),to=U3(Zy),H3=Gg(Ok,"secondary"),OP=qw(H3),$3="EYdciKDOi3UYBLk1u8hHams5tmO2",Vk=v.createContext();function Mr(){return v.useContext(Vk)}function W3({children:n}){const[e,t]=v.useState(null),[i,l]=v.useState(!1),[u,d]=v.useState(!1),[p,g]=v.useState(null),[y,w]=v.useState(!0);v.useEffect(()=>{let K=null;const ae=XC(Do,be=>{if(t(be),K&&(K(),K=null),be)if(be.uid===$3)l(!0),d(!1),g(null),w(!1);else{l(!1);const ve=Ds(zt(ge,"clients"),ds("uid","==",be.uid)),_e=async()=>{const R=localStorage.getItem("mcf_clientId");if(R)try{const E=await Rs(ze(ge,"clients",R));E.exists()&&(d(!0),g({id:E.id,...E.data()}))}catch(E){console.error("Direct client read failed:",E)}};K=_k(ve,async R=>{if(R.empty)await _e();else{const E=R.docs[0];d(!0),g({id:E.id,...E.data()});try{localStorage.setItem("mcf_clientId",E.id)}catch{}}w(!1)},async R=>{console.error("Error listening to client data:",R),await _e(),w(!1)})}else l(!1),d(!1),g(null),w(!1)});return()=>{ae(),K&&K()}},[]);const te={currentUser:e,isAdmin:i,isClient:u,clientData:p,updateClientData:K=>{g(ae=>ae?{...ae,...K}:K)},resolveClient:async()=>{if(p)return p;const K=localStorage.getItem("mcf_clientId");if(K)try{const ae=await Rs(ze(ge,"clients",K));if(ae.exists()){const be={id:ae.id,...ae.data()};return d(!0),g(be),be}}catch(ae){console.error("resolveClient direct read failed:",ae)}if(e){const ae=Ds(zt(ge,"clients"),ds("uid","==",e.uid)),be=await Ts(ae);if(!be.empty){const ve={id:be.docs[0].id,...be.docs[0].data()};return d(!0),g(ve),ve}}return null},login:async(K,ae,be=!0)=>(await ax(Do,be?hg:ty),await KC(Do,K,ae)),signup:async(K,ae,be)=>{await ax(Do,hg);const ve=await GC(Do,ae.trim().toLowerCase(),be),_e=ve.user,R=ze(zt(ge,"clients")),E={uid:_e.uid,name:K.trim(),email:ae.trim().toLowerCase(),clientType:"core_buddy",coreBuddyAccess:!0,status:"active",tier:"free",subscriptionStatus:null,signupSource:"self_signup",createdAt:xt.now()};await Es(R,E),d(!0),g({id:R.id,...E});try{localStorage.setItem("mcf_clientId",R.id)}catch{}return ve},logout:()=>{try{localStorage.removeItem("mcf_clientId")}catch{}return JC(Do)},resetPassword:K=>WC(Do,K),loading:y};return r.jsx(Vk.Provider,{value:te,children:n})}const Bk=v.createContext();function ka(){return v.useContext(Bk)}function G3({children:n}){const[e,t]=v.useState(()=>{const g=localStorage.getItem("theme");return g?g==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches}),[i,l]=v.useState(()=>localStorage.getItem("accent")||"red");v.useEffect(()=>{document.documentElement.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("theme",e?"dark":"light")},[e]),v.useEffect(()=>{localStorage.setItem("accent",i)},[i]);const p={isDark:e,toggleTheme:()=>{document.documentElement.setAttribute("data-theme-transitioning",""),t(!e),setTimeout(()=>{document.documentElement.removeAttribute("data-theme-transitioning")},350)},accent:i,setAccent:g=>l(g)};return r.jsx(Bk.Provider,{value:p,children:n})}const Uk=v.createContext();function wm(){return v.useContext(Uk)}const K3=["nutrition","consistency","personalBests","achievements","buddies","programmes","leaderboard"],Y3=[5,10],Q3=1;function X3({children:n}){const{clientData:e,loading:t}=Mr(),i=v.useMemo(()=>{const l=e?.tier||"free",u=e?.subscriptionStatus||null,d=e&&e.signupSource!=="self_signup",p=l==="premium"||!!d;function g(y){return p?!0:!K3.includes(y)}return{tier:l,subscriptionStatus:u,isPremium:p,canAccess:g,loading:t,FREE_RANDOMISER_DURATIONS:Y3,FREE_RANDOMISER_WEEKLY_LIMIT:Q3}},[e?.tier,e?.subscriptionStatus,e?.signupSource,t]);return r.jsx(Uk.Provider,{value:i,children:n})}function J3(n){if(n?.signupSource==="self_signup"&&!n?.onboardingComplete)return"/onboarding";const e=n?.clientType;return e==="core_buddy"?"/client/core-buddy":e==="circuit_vip"||e==="circuit_dropin"?"/client/circuit":"/client"}function Z3({className:n=""}){const{isDark:e,toggleTheme:t}=ka();return r.jsx("button",{className:n||"theme-toggle",onClick:t,"aria-label":e?"Switch to light mode":"Switch to dark mode",children:e?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})})}function eD(){const[n,e]=v.useState(""),[t,i]=v.useState(""),[l,u]=v.useState(!0),[d,p]=v.useState(""),[g,y]=v.useState(!1),[w,j]=v.useState(!1),[T,O]=v.useState(!1),{login:$,resetPassword:F,currentUser:B,isAdmin:te,isClient:K,clientData:ae,loading:be}=Mr(),ve=$n();if(v.useEffect(()=>{!be&&B&&(te?ve("/dashboard"):K?ve(J3(ae)):(y(!1),p("No account found. Please sign up or contact your trainer.")))},[be,B,te,K,ae,ve]),be||B)return null;const _e=async E=>{E.preventDefault(),p(""),y(!0);try{await $(n,t,l)}catch(A){p(A.message||"Failed to log in"),y(!1)}},R=async E=>{if(E.preventDefault(),p(""),!n.trim()){p("Please enter your email address");return}y(!0);try{await F(n.trim()),O(!0)}catch(A){A.code==="auth/user-not-found"?p("No account found with this email"):p(A.message||"Failed to send reset email")}y(!1)};return r.jsxs("div",{className:"login-container",children:[r.jsx(Z3,{className:"login-theme-toggle"}),r.jsxs("div",{className:"login-card",children:[r.jsxs("div",{className:"login-header",children:[r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"login-logo"}),r.jsx("p",{children:r.jsx("strong",{children:w?"Reset Password":"Sign in as 1-2-1 or a Core Buddy"})})]}),d&&r.jsx("div",{className:"error-message",children:d}),T?r.jsxs("div",{className:"reset-sent",children:[r.jsx("div",{className:"reset-sent-icon",children:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M22 2L11 13",strokeLinecap:"round",strokeLinejoin:"round"}),r.jsx("path",{d:"M22 2L15 22L11 13L2 9L22 2Z",strokeLinecap:"round",strokeLinejoin:"round"})]})}),r.jsx("p",{children:"Reset email sent!"}),r.jsx("span",{children:"Check your inbox for a password reset link"}),r.jsx("button",{className:"login-btn",style:{marginTop:"20px"},onClick:()=>{j(!1),O(!1),p("")},children:"Back to Log In"})]}):w?r.jsxs("form",{onSubmit:R,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email"}),r.jsx("input",{type:"email",id:"email",value:n,onChange:E=>e(E.target.value),placeholder:"Enter your email",required:!0})]}),r.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Sending...":"Send Reset Link"}),r.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{j(!1),p("")},children:"Back to Log In"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("form",{onSubmit:_e,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email"}),r.jsx("input",{type:"email",id:"email",value:n,onChange:E=>e(E.target.value),required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"password",children:"Password"}),r.jsx("input",{type:"password",id:"password",value:t,onChange:E=>i(E.target.value),required:!0})]}),r.jsx("div",{className:"remember-me",children:r.jsxs("label",{children:[r.jsx("input",{type:"checkbox",checked:l,onChange:E=>u(E.target.checked)}),r.jsx("span",{children:"Remember me"})]})}),r.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Logging in...":"Log In"})]}),r.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{j(!0),p("")},children:"Forgot password?"})]}),r.jsx("a",{href:"/",className:"back-link",children:"Back to website"})]})]})}function Ml({feature:n,children:e}){const{canAccess:t,loading:i}=wm(),l=$n();return i||t(n)?e:r.jsxs("div",{className:"locked-feature-wrap",children:[r.jsx("div",{className:"locked-feature-bg","aria-hidden":"true",children:e}),r.jsx("div",{className:"locked-feature-overlay",children:r.jsxs("div",{className:"locked-feature-card",children:[r.jsx("div",{className:"locked-icon",children:r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),r.jsx("h2",{children:"Premium Feature"}),r.jsx("p",{children:"Upgrade to Core Buddy Premium to unlock this feature and get full access to everything."}),r.jsx("button",{className:"locked-upgrade-btn",onClick:()=>l("/upgrade"),children:"Upgrade Now"})]})})]})}function aa({active:n}){const e=$n(),{clientData:t}=Mr(),{isPremium:i}=wm(),l=t?.clientType==="block"&&t?.coreBuddyAccess;return r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:`block-nav-tab${n==="home"?" active":""}`,onClick:()=>e("/client/core-buddy"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),r.jsx("span",{children:"Profile"})]}),r.jsxs("button",{className:`block-nav-tab${n==="workouts"?" active":""}`,onClick:()=>e("/client/core-buddy/workouts"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:r.jsx("path",{d:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"})}),r.jsx("span",{children:"Workouts"})]}),r.jsxs("button",{className:`block-nav-tab${n==="nutrition"?" active":""}`,onClick:()=>e(i?"/client/core-buddy/nutrition":"/upgrade"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"})}),r.jsx("span",{children:"Nutrition"})]}),r.jsxs("button",{className:`block-nav-tab${n==="buddies"?" active":""}`,onClick:()=>e(i?"/client/core-buddy/buddies":"/upgrade"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("span",{children:"Buddies"})]}),l&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>e("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),r.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),r.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),r.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),r.jsx("span",{children:"Block"})]})]})}function xa({children:n,onRefresh:e}){const[t,i]=v.useState(0),[l,u]=v.useState(!1),d=v.useRef(null),p=v.useRef(0),g=v.useRef(!1),y=v.useCallback(T=>{window.scrollY<=0&&(p.current=T.touches[0].clientY,g.current=!0)},[]),w=v.useCallback(T=>{if(!g.current||l)return;const O=T.touches[0].clientY-p.current;O>20&&window.scrollY<=0&&(T.preventDefault(),i(Math.min((O-20)*.35,80)))},[l]),j=v.useCallback(async()=>{t>55&&!l&&(u(!0),e?await e():window.location.reload(),u(!1)),i(0),g.current=!1},[t,l,e]);return r.jsxs("div",{ref:d,onTouchStart:y,onTouchMove:w,onTouchEnd:j,children:[r.jsxs("div",{className:`pull-refresh-indicator ${t>0?"visible":""} ${l?"refreshing":""}`,style:{height:t},children:[r.jsx("div",{className:`refresh-spinner ${l?"spinning":""}`,children:r.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:r.jsx("path",{fill:"currentColor",d:"M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"})})}),r.jsx("span",{className:"refresh-text",children:l?"Refreshing...":"Pull to refresh"})]}),n]})}function $u(n,e,t,i,l){const u=[];for(let d=0;d<n;d++){const p=(d*(360/n)-90)*(Math.PI/180);u.push({x1:e+i*Math.cos(p),y1:t+i*Math.sin(p),x2:e+l*Math.cos(p),y2:t+l*Math.sin(p),thick:d%5===0})}return u}const eb=$u(60,100,100,85,96),Fk=$u(60,100,100,78,94),tD=$u(60,100,100,82,94);$u(60,50,50,38,46);const k2=$u(60,40,40,30,37),sD="/login/assets/first_workout-B8SFkzJX.PNG",nD="/login/assets/workouts_10-Z5R3u0xH.PNG",rD="/login/assets/workouts_25-CzxSlcAj.PNG",aD="/login/assets/workouts_50-BpzWup3V.PNG",iD="/login/assets/workouts_100-D7_r6tn1.PNG",oD="/login/assets/streak_2-CsRr-XA9.PNG",lD="/login/assets/streak_4-BHO09tbw.PNG",cD="/login/assets/streak_8-DX2UWMko.PNG",uD="/login/assets/first_pb-aVf_CNWy.PNG",dD="/login/assets/pbs_5-Cippawgg.PNG",hD="/login/assets/pbs_10-CZgGh9Kv.PNG",mD="/login/assets/pbs_100-C67b1wfS.PNG",fD="/login/assets/nutrition_7-CHVV11fj.PNG",pD="/login/assets/leaderboard_join-BLoId4Hz.PNG",gD="/login/assets/habits_7-Dvki70KO.PNG",mu=[{id:"first_workout",img:sD,name:"First Rep",desc:"Complete your first workout",category:"workouts",threshold:1},{id:"workouts_10",img:nD,name:"On Fire",desc:"Complete 10 workouts",category:"workouts",threshold:10},{id:"workouts_25",img:rD,name:"Dedicated",desc:"Complete 25 workouts",category:"workouts",threshold:25},{id:"workouts_50",img:aD,name:"Unstoppable",desc:"Complete 50 workouts",category:"workouts",threshold:50},{id:"workouts_100",img:iD,name:"Century",desc:"Complete 100 workouts",category:"workouts",threshold:100},{id:"streak_2",img:oD,name:"2 Week Streak",desc:"Work out for 2 weeks in a row",category:"streaks",threshold:2},{id:"streak_4",img:lD,name:"Month Strong",desc:"Work out for 4 weeks in a row",category:"streaks",threshold:4},{id:"streak_8",img:cD,name:"Iron Will",desc:"Work out for 8 weeks in a row",category:"streaks",threshold:8},{id:"first_pb",img:uD,name:"First PB",desc:"Set your first personal best",category:"pbs",threshold:1},{id:"pbs_5",img:dD,name:"PB Hunter",desc:"Set 5 personal bests",category:"pbs",threshold:5},{id:"pbs_10",img:hD,name:"PB Machine",desc:"Set 10 personal bests",category:"pbs",threshold:10},{id:"pbs_100",img:mD,name:"PB Legend",desc:"Set 100 personal bests",category:"pbs",threshold:100},{id:"nutrition_7",img:fD,name:"Macro Master",desc:"Hit your macro targets 7 days in a row",category:"nutrition",threshold:7},{id:"leaderboard_join",img:pD,name:"Competitor",desc:"Join the leaderboard",category:"leaderboard",threshold:1},{id:"habits_7",img:gD,name:"Habit Streak",desc:"Complete your daily habits 7 days in a row",category:"habits",threshold:7}];function yD({steps:n,onFinish:e,active:t}){const[i,l]=v.useState(0),[u,d]=v.useState(null),[p,g]=v.useState("below"),[y,w]=v.useState(!1),j=v.useRef(null),T=v.useRef(t);T.current=t,v.useEffect(()=>{t||l(0)},[t]),v.useEffect(()=>{if(!t)return;const ve=_e=>_e.preventDefault();return document.addEventListener("touchmove",ve,{passive:!1}),document.addEventListener("wheel",ve,{passive:!1}),document.body.style.overflow="hidden",()=>{document.removeEventListener("touchmove",ve),document.removeEventListener("wheel",ve),document.body.style.overflow=""}},[t]);const O=v.useMemo(()=>t?n.filter(ve=>document.querySelector(ve.selector)):[],[t]),$=O[i],F=i===O.length-1,B=$?.selector,te=v.useCallback(()=>{if(!B)return;const ve=document.querySelector(B);if(!ve){d(null);return}const _e=ve.getBoundingClientRect(),R=8;d({top:_e.top-R,left:_e.left-R,width:_e.width+R*2,height:_e.height+R*2});const E=window.innerHeight-_e.bottom;g(E<260?"above":"below")},[B]);if(v.useEffect(()=>{if(!t||!B)return;w(!0);const ve=document.querySelector(B);if(ve){document.body.style.overflow="",ve.scrollIntoView({behavior:"smooth",block:"center"});let _e=null,R=0,E=0;const A=60,V=()=>{E++;const M=ve.getBoundingClientRect(),$e=Math.round(M.top);if(_e!==null&&$e===_e?R++:R=0,_e=$e,R>=3||E>=A){T.current&&(document.body.style.overflow="hidden"),te(),w(!1);return}D=requestAnimationFrame(V)};let D;const H=setTimeout(()=>{D=requestAnimationFrame(V)},120);return()=>{clearTimeout(H),D&&cancelAnimationFrame(D),T.current&&(document.body.style.overflow="hidden")}}},[t,i,B,te]),v.useEffect(()=>{if(!t)return;const ve=()=>{j.current&&cancelAnimationFrame(j.current),j.current=requestAnimationFrame(te)};return window.addEventListener("scroll",ve,!0),window.addEventListener("resize",ve),()=>{window.removeEventListener("scroll",ve,!0),window.removeEventListener("resize",ve),j.current&&cancelAnimationFrame(j.current)}},[t,te]),!t||!$||O.length===0)return null;const K=()=>{F?e():l(i+1)},ae=()=>{i>0&&l(i-1)},be=()=>e();return r.jsxs("div",{className:"st-overlay",onClick:ve=>{ve.stopPropagation()},children:[r.jsx("div",{className:"st-backdrop",onClick:K}),u&&r.jsx("div",{className:`st-spotlight${y?" st-transitioning":""}`,style:{top:u.top,left:u.left,width:u.width,height:u.height}}),u&&r.jsxs("div",{className:`st-tooltip st-tooltip-${p}${y?" st-transitioning":""}`,style:{top:p==="below"?Math.min(Math.max(u.top+u.height+16,16),window.innerHeight-200):void 0,bottom:p==="above"?Math.min(Math.max(window.innerHeight-u.top+16,16),window.innerHeight-60):void 0,left:Math.max(16,Math.min(u.left,window.innerWidth-320))},children:[r.jsx("div",{className:"st-dots",children:O.map((ve,_e)=>r.jsx("span",{className:`st-dot${_e===i?" active":""}${_e<i?" done":""}`},_e))}),r.jsx("h3",{className:"st-title",children:$.title}),r.jsx("p",{className:"st-body",children:$.body}),r.jsxs("div",{className:"st-actions",children:[i>0&&r.jsx("button",{className:"st-btn st-btn-back",onClick:ae,children:"Back"}),r.jsx("button",{className:"st-btn st-btn-next",onClick:K,children:$.cta||(F?"Let's Go!":"Next")})]}),r.jsx("button",{className:"st-skip",onClick:be,children:"Skip tour"})]})]})}const Fp=[10,25,50,100,200,500,1e3],Wi=5;function Xc(n){return n.toISOString().split("T")[0]}function bD(n){let e=0;for(const t of Fp){if(n<t)return{prev:e,next:t};e=t}return{prev:Fp[Fp.length-1],next:n+100}}const vD={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},xD={fullbody_4wk:["Push Focus","Pull Focus","Legs & Core"],fullbody_8wk:["Strength","Power","Endurance"],fullbody_12wk:["Upper Push","Lower Body","Upper Pull"],core_4wk:["Abs","Stability","Power Core"],core_8wk:["Anti-Extension","Rotation","Power"],core_12wk:["Strength","Endurance","Power"],upper_4wk:["Push","Pull","Mixed"],lower_4wk:["Quad Dominant","Hamstring & Glute","Power & Stability"]},zp=[{text:"You have 24 hours a day...",bold:"make it count"},{text:"Discipline beats motivation...",bold:"every single time"},{text:"Rest when you're done,",bold:"not when you're tired"},{text:"Small daily gains...",bold:"create massive results"},{text:"Your body keeps score,",bold:"train it well"},{text:"Consistency over intensity...",bold:"always wins"},{text:"The only bad workout...",bold:"is the one you skipped"}];function qp(n){if(!n)return"";const e=n instanceof Date?n:n.toDate?n.toDate():new Date(n),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function Jc(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function wD(n,e=800){return new Promise(t=>{const i=new Image;i.onload=()=>{const l=document.createElement("canvas");let u=i.width,d=i.height;u>d?u>e&&(d=Math.round(d*e/u),u=e):d>e&&(u=Math.round(u*e/d),d=e),l.width=u,l.height=d,l.getContext("2d").drawImage(i,0,0,u,d),l.toBlob(p=>t(p),"image/jpeg",.8)},i.src=URL.createObjectURL(n)})}function _D(){const{currentUser:n,isClient:e,clientData:t,logout:i,updateClientData:l,loading:u}=Mr(),{isDark:d,toggleTheme:p}=ka(),{isPremium:g}=wm(),y=$n(),[w,j]=v.useState({hours:0,minutes:0,seconds:0}),[T,O]=v.useState(0),[$,F]=v.useState(0),[B,te]=v.useState(""),[K,ae]=v.useState(0),[be,ve]=v.useState(0),[_e,R]=v.useState(!1),[E,A]=v.useState({protein:0,carbs:0,fats:0,calories:0}),[V,D]=v.useState(null),[H,M]=v.useState(0),[$e,pt]=v.useState(null),[W,pe]=v.useState(!1),[Ve,We]=v.useState(!1),[ee,L]=v.useState(0),[se,De]=v.useState(0),[Le,Qe]=v.useState([]),[Fe,ft]=v.useState([]),[jt,at]=v.useState(null),[Gt,_s]=v.useState(!1),wt=v.useRef(null),[gt,le]=v.useState([]),[Xt,Kt]=v.useState(null),[ut,bt]=v.useState(null),Xe=v.useRef(null),[rt,qt]=v.useState(0),[en,As]=v.useState(0),[ts,Ct]=v.useState(0),[Jt,Ss]=v.useState(0),[Ot,Ps]=v.useState(null),ue=v.useCallback((I,Z="info")=>{Ps({message:I,type:Z}),setTimeout(()=>Ps(null),4e3)},[]),[Se,Ie]=v.useState([]),[Ge,X]=v.useState(!1),[he,Pe]=v.useState(""),[qe,Ae]=v.useState(null),[dt,Tt]=v.useState(null),[Q,de]=v.useState(!1),[tt,At]=v.useState(new Set),[Et,ss]=v.useState(new Set),[Ut,Vt]=v.useState({}),[Ls,Xs]=v.useState({}),[is,Ns]=v.useState({}),[Os,q]=v.useState({}),[we,Te]=v.useState({}),[Ee,ke]=v.useState({}),lt=v.useRef(null),ht=v.useRef(null),st=v.useRef({}),[vt,It]=v.useState([]),[ks,mn]=v.useState(!1),ln=v.useRef(null),[_n,kn]=v.useState([]),[fn,Fs]=v.useState(""),[k,N]=v.useState(!1),[P,U]=v.useState(null),[me,Be]=v.useState([]),[Ue,Je]=v.useState(null),[Ze,Ht]=v.useState(!1),bs=v.useRef(!1),os=(()=>{const I=[{selector:".cb-ring-container",title:"Your 24-Hour Countdown",body:"Every day resets. This ring tracks the time you have left  tap your photo to personalise your profile.",cta:"Next"},{selector:".cb-stats-row",title:"Progress at a Glance",body:"Programme completion, workouts this week, and daily habits  all in one row. These fill up as you go."},{selector:".cb-nudge-card",title:"Smart Suggestions",body:"We'll highlight what needs your attention  your next session, unfinished habits, or a meal to log."},{selector:".cb-card-workouts-hero",title:"Workouts",body:"Quick randomiser sessions or structured programmes  pick your focus, level and time.",cta:"Next"}];return g&&I.push({selector:".cb-card-nutrition",title:"Nutrition Tracking",body:"Set your macro targets, scan barcodes, and log meals to hit your daily goals."},{selector:".cb-card-consistency",title:"Daily Habits",body:"5 simple habits each day  train, hit protein, 10k steps, sleep, and hydrate. Build your streak."},{selector:".cb-card-buddies",title:"Buddies & Social",body:"Connect with other members, share your journey, and keep each other accountable."},{selector:".cb-journey-section",title:"Share Your Journey",body:"Post photos, updates, and milestones  your fitness journey in one place. Like and comment on each other's posts."},{selector:".cb-achievements-section",title:"Achievements",body:"Every rep counts towards badges  volume milestones, workout streaks, and more to unlock."}),I.push({selector:".block-bottom-nav",title:"You're All Set!",body:"Use the nav bar to jump between your profile, workouts, nutrition, and buddies. Time to get after it.",cta:"Let's Go!"}),I})();v.useEffect(()=>{!u&&!n&&y("/")},[u,n,y]),v.useEffect(()=>{!u&&t&&t.signupSource==="self_signup"&&!t.onboardingComplete&&y("/onboarding")},[u,t,y]),v.useEffect(()=>{let I=t?.tourComplete||bs.current;if(!I&&t?.id)try{I=!!localStorage.getItem(`tourDone_${t.id}`)}catch{}if(_e&&t&&!I){const Z=setTimeout(()=>Ht(!0),600);return()=>clearTimeout(Z)}},[_e,t]),v.useEffect(()=>{if(t)try{const I=sessionStorage.getItem(`cbDash_${t.id}`);if(I){const Z=JSON.parse(I);F(Z.programmePct??0),te(Z.programmeName??""),ae(Z.totalWorkouts??0),ve(Z.habitWeekPct??0),A(Z.nutritionTotals??{protein:0,carbs:0,fats:0,calories:0}),D(Z.nutritionTargetData??null),M(Z.todayHabitsCount??0),pt(Z.nextSession??null),pe(Z.hasProgramme??!1),We(Z.programmeComplete??!1),L(Z.weeklyWorkouts??0),De(Z.pbCount??0),Qe(Z.topPBs??[]),ft(Z.leaderboardTop3??[]),le(Z.unlockedBadges??[]),Xe.current=Z.unlockedBadges??[],qt(Z.streakWeeks??0),R(!0)}}catch{}},[t]),v.useEffect(()=>{t?.photoURL&&at(t.photoURL)},[t]),v.useEffect(()=>{if(!t)return;const I=Ds(zt(ge,"notifications"),ds("toId","==",t.id)),Z=_k(I,Ne=>{const et=Ne.docs.map(kt=>({id:kt.id,...kt.data()}));et.sort((kt,Dt)=>{const ot=kt.createdAt?.toMillis?.()||0;return(Dt.createdAt?.toMillis?.()||0)-ot}),It(et.slice(0,50))},Ne=>{console.error("Notification listener error:",Ne),Ne.code==="permission-denied"&&console.warn("Firestore rules may be missing for the notifications collection. Please update your Firestore rules in the Firebase Console.")});return()=>Z()},[t]),v.useEffect(()=>{const I=Z=>{ln.current&&!ln.current.contains(Z.target)&&mn(!1)};return document.addEventListener("mousedown",I),()=>document.removeEventListener("mousedown",I)},[]),v.useEffect(()=>{if(!t)return;const I=t.id;(async()=>{try{const[Z,Ne,et]=await Promise.all([Ts(Ds(zt(ge,"buddies"),ds("user1","==",I))),Ts(Ds(zt(ge,"buddies"),ds("user2","==",I))),Ts(zt(ge,"clients"))]),kt=new Set;[...Z.docs,...Ne.docs].forEach(ot=>{const Bt=ot.data();kt.add(Bt.user1===I?Bt.user2:Bt.user1)});const Dt={};et.docs.forEach(ot=>{Dt[ot.id]=ot.data()}),kn(Array.from(kt).filter(ot=>Dt[ot]).map(ot=>({id:ot,name:Dt[ot].name,photoURL:Dt[ot].photoURL||null})))}catch(Z){console.error("Error loading buddies for mentions:",Z)}})()},[t]);const ls=vt.filter(I=>!I.read).length,Cs=async()=>{const I=vt.filter(Ne=>!Ne.read);if(!I.length)return;const Z=p2(ge);I.forEach(Ne=>Z.update(ze(ge,"notifications",Ne.id),{read:!0})),await Z.commit()},Y=async()=>{if(!vt.length)return;const I=p2(ge);vt.forEach(Z=>I.delete(ze(ge,"notifications",Z.id))),await I.commit()},xe=async(I,Z,Ne={})=>{if(!(!t||I===t.id))try{await hi(zt(ge,"notifications"),{toId:I,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:Z,read:!1,createdAt:Hr(),...Ne})}catch(et){console.error("Notification create error:",et),et.code==="permission-denied"&&ue("Notifications blocked  check Firestore rules","error")}},ne=(I,Z)=>{const Ne=Z==="compose"?lt.current?.selectionStart:null,kt=(Ne!=null?I.slice(0,Ne):I).match(/@(\w*)$/);if(kt){N(!0),U(Z),Fs(kt[1].toLowerCase());const Dt=_n.filter(ot=>ot.name&&ot.name.toLowerCase().includes(kt[1].toLowerCase())).slice(0,5);Be(Dt)}else N(!1),Be([])},Ke=(I,Z)=>{if(Z==="compose"){const Ne=lt.current,et=he,kt=Ne?.selectionStart??et.length,Dt=et.slice(0,kt),ot=et.slice(kt),Bt=Dt.replace(/@\w*$/,`@${I.name} `);Pe(Bt+ot),setTimeout(()=>{Ne?.focus(),Ne.selectionStart=Ne.selectionEnd=Bt.length},0)}else{const et=(Ls[Z]||"").replace(/@\w*$/,`@${I.name} `);Xs(kt=>({...kt,[Z]:et}))}N(!1),Be([])},He=I=>I&&I.split(/(@\w[\w\s]*?\s)/g).map((Ne,et)=>Ne.startsWith("@")&&_n.some(kt=>Ne.trim()===`@${kt.name}`)?r.jsx("span",{className:"mention-highlight",children:Ne.trim()},et):Ne),it=async I=>{const Z=I.target.files?.[0];if(!(!Z||!t)){if(!Z.type.startsWith("image/")){ue("Please select an image file","error");return}if(Z.size>5*1024*1024){ue("Image must be under 5MB","error");return}_s(!0);try{const Ne=await new Promise(Dt=>{const ot=new Image;ot.onload=()=>{const Bt=document.createElement("canvas"),$t=400;let rs=ot.width,Ft=ot.height;rs>Ft?(Ft=Ft/rs*$t,rs=$t):(rs=rs/Ft*$t,Ft=$t),Bt.width=rs,Bt.height=Ft,Bt.getContext("2d").drawImage(ot,0,0,rs,Ft),Bt.toBlob(xs=>Dt(xs),"image/jpeg",.75)},ot.src=URL.createObjectURL(Z)}),et=eo(to,`profilePhotos/${t.id}`);await Up(et,Ne);const kt=await qo(et);await Ma(ze(ge,"clients",t.id),{photoURL:kt}),at(kt),l({photoURL:kt}),ue("Profile photo updated!","success")}catch(Ne){console.error("Photo upload error:",Ne),ue("Failed to upload photo","error")}_s(!1),wt.current&&(wt.current.value="")}};v.useEffect(()=>{const I=()=>{const Ne=new Date,et=new Date(Ne);et.setHours(23,59,59,999);const kt=et-Ne,Dt=Math.floor(kt/(1e3*60*60)),ot=Math.floor(kt%(1e3*60*60)/(1e3*60)),Bt=Math.floor(kt%(1e3*60)/1e3);j({hours:Dt,minutes:ot,seconds:Bt}),O(60-Bt)};I();const Z=setInterval(I,1e3);return()=>clearInterval(Z)},[]),v.useEffect(()=>{const I=setInterval(()=>{Ss(Z=>(Z+1)%zp.length)},8e3);return()=>clearInterval(I)},[]),v.useEffect(()=>{if(!n||!t)return;(async()=>{let Z=null,Ne=0,et=[],kt=!1,Dt=null;try{const ot=Xc(new Date),Bt=await Rs(ze(ge,"clientProgrammes",t.id));if(Bt.exists()){const rr=Bt.data(),gn=vD[rr.templateId];if(pe(!0),gn){const hr=rr.completedSessions||{},Tr=Object.keys(hr).length,Ha=gn.duration*gn.daysPerWeek;F(Ha>0?Math.round(Tr/Ha*100):0);const tl=rr.templateId.replace(/_/g," ").replace(/\b\w/g,ia=>ia.toUpperCase());te(tl);const sl=xD[rr.templateId];let mr=!1;for(let ia=1;ia<=gn.duration&&!mr;ia++)for(let oa=0;oa<gn.daysPerWeek&&!mr;oa++)hr[`w${ia}d${oa}`]||(pt({week:ia,dayIdx:oa,label:sl?.[oa]||`Day ${oa+1}`}),mr=!0);mr||(We(!0),kt=!0)}}const $t=zt(ge,"workoutLogs"),rs=Ds($t,ds("clientId","==",t.id));Z=await Ts(rs),ae(Z.docs.length);const Ft=new Date,xs=Ft.getDay(),Fn=xs===0?6:xs-1,ur=new Date(Ft);ur.setDate(Ft.getDate()-Fn),ur.setHours(0,0,0,0);const Js=ur.getTime(),Ks=Z.docs.filter(rr=>{const gn=rr.data().completedAt;return gn?(gn.toDate?gn.toDate().getTime():new Date(gn).getTime())>=Js:!1}).length;L(Ks);const zn=zt(ge,"habitLogs"),dn=Ds(zn,ds("clientId","==",t.id),ds("date","==",ot)),On=await Ts(dn);let nr=0;if(!On.empty){const rr=On.docs[0].data().habits||{};nr=Object.values(rr).filter(Boolean).length}ve(Math.round(nr/Wi*100)),M(nr);const Kn=await Rs(ze(ge,"nutritionTargets",t.id));Kn.exists()&&(D(Kn.data()),Dt=Kn.data());const dr=await Rs(ze(ge,"nutritionLogs",`${t.id}_${ot}`));if(dr.exists()){const gn=(dr.data().entries||[]).reduce((hr,Tr)=>({protein:hr.protein+(Tr.protein||0),carbs:hr.carbs+(Tr.carbs||0),fats:hr.fats+(Tr.fats||0),calories:hr.calories+(Tr.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});A(gn)}}catch(ot){console.error("Error loading dashboard stats:",ot)}try{let ot=[];const Bt=await Rs(ze(ge,"coreBuddyPBs",t.id));if(Bt.exists()){const $t=Bt.data().exercises||{};De(Object.keys($t).length),Ne=Object.keys($t).length,ot=Object.entries($t).sort(([,rs],[,Ft])=>(Ft.weight||0)-(rs.weight||0)).slice(0,3).map(([rs,Ft])=>({name:rs,weight:Ft.weight,reps:Ft.reps}))}et=ot,Qe(ot)}catch(ot){console.error("PB fetch error:",ot)}try{const ot=zt(ge,"clients"),Bt=Ds(ot,ds("leaderboardOptIn","==",!0)),rs=(await Ts(Bt)).docs.map(Ft=>({id:Ft.id,name:Ft.data().name,photoURL:Ft.data().photoURL||null}));ft(rs.slice(0,3))}catch(ot){console.error("Leaderboard preview error:",ot)}try{let ot=0;if(Z){const Js=Z.docs.map(Ks=>Ks.data().date).filter(Boolean).sort().reverse();if(Js.length>0){const Ks=new Date;let zn=new Date(Ks);e:for(let dn=0;dn<52;dn++){const On=new Date(zn),nr=On.getDay(),Kn=nr===0?6:nr-1;On.setDate(On.getDate()-Kn),On.setHours(0,0,0,0);const dr=new Date(On);dr.setDate(dr.getDate()+7);const rr=Xc(On),gn=Xc(dr);if(Js.some(Tr=>Tr>=rr&&Tr<gn))ot++;else{if(dn>0)break e;break}zn.setDate(zn.getDate()-7)}}}qt(ot);let Bt=0;for(let Js=0;Js<30;Js++){const Ks=new Date;Ks.setDate(Ks.getDate()-Js);const zn=Xc(Ks);try{const dn=await Ts(Ds(zt(ge,"habitLogs"),ds("clientId","==",t.id),ds("date","==",zn)));if(dn.empty)break;{const On=dn.docs[0].data().habits||{};if(Object.values(On).filter(Boolean).length>=Wi)Bt++;else break}}catch{break}}As(Bt);let $t=0;for(let Js=0;Js<30;Js++){const Ks=new Date;Ks.setDate(Ks.getDate()-Js);const zn=Xc(Ks);try{const dn=await Rs(ze(ge,"nutritionLogs",`${t.id}_${zn}`));if(dn.exists()&&(dn.data().entries||[]).length>0)if(Dt){const nr=(dn.data().entries||[]).reduce((Kn,dr)=>({protein:Kn.protein+(dr.protein||0),carbs:Kn.carbs+(dr.carbs||0),fats:Kn.fats+(dr.fats||0)}),{protein:0,carbs:0,fats:0});if(nr.protein>=(Dt.protein||0)&&nr.carbs>=(Dt.carbs||0)&&nr.fats>=(Dt.fats||0))$t++;else break}else $t++;else break}catch{break}}Ct($t);const rs=Z?Z.docs.length:0,Ft=[],xs=Js=>Ft.push(Js);rs>=1&&xs("first_workout"),rs>=10&&xs("workouts_10"),rs>=25&&xs("workouts_25"),rs>=50&&xs("workouts_50"),rs>=100&&xs("workouts_100"),ot>=2&&xs("streak_2"),ot>=4&&xs("streak_4"),ot>=8&&xs("streak_8"),Ne>=1&&xs("first_pb"),Ne>=5&&xs("pbs_5"),Ne>=10&&xs("pbs_10"),Ne>=100&&xs("pbs_100"),$t>=7&&xs("nutrition_7"),t.leaderboardOptIn&&xs("leaderboard_join"),Bt>=7&&xs("habits_7"),le(Ft);const Fn=Xe.current;if(Fn!==null){const Js=Ft.filter(Ks=>!Fn.includes(Ks));if(Js.length>0){const Ks=mu.find(zn=>zn.id===Js[Js.length-1]);Ks&&setTimeout(()=>bt(Ks),600)}}Xe.current=Ft;const ur={};Ft.forEach(Js=>{ur[Js]={unlockedAt:new Date().toISOString()}}),Es(ze(ge,"achievements",t.id),{badges:ur,progress:{streakWeeks:ot,pbCount:Ne,nutritionStreak:$t,habitStreak:Bt},updatedAt:new Date().toISOString()},{merge:!0}).catch(()=>{})}catch(ot){console.error("Achievement computation error:",ot)}R(!0)})()},[n,t]),v.useEffect(()=>{if(!(!_e||!t))try{sessionStorage.setItem(`cbDash_${t.id}`,JSON.stringify({programmePct:$,programmeName:B,totalWorkouts:K,habitWeekPct:be,nutritionTotals:E,nutritionTargetData:V,todayHabitsCount:H,nextSession:$e,hasProgramme:W,programmeComplete:Ve,weeklyWorkouts:ee,pbCount:se,topPBs:Le,leaderboardTop3:Fe,unlockedBadges:gt,streakWeeks:rt}))}catch{}},[_e,$,B,K,be,E,V,H,$e,W,Ve,ee,se,Le,Fe,gt,rt,t]);const _t=v.useCallback(async()=>{if(bs.current=!0,Ht(!1),l({tourComplete:!0}),t?.id){try{localStorage.setItem(`tourDone_${t.id}`,"1")}catch{}try{await Ma(ze(ge,"clients",t.id),{tourComplete:!0})}catch(I){console.error("Failed to save tour completion:",I)}}},[t,l]),Rt=I=>{const Z=I.currentTarget,Ne=Z.querySelector(".ripple");Ne&&Ne.remove();const et=Z.getBoundingClientRect(),kt=Math.max(et.width,et.height),Dt=I.clientX-et.left-kt/2,ot=I.clientY-et.top-kt/2,Bt=document.createElement("span");Bt.className="ripple",Bt.style.cssText=`width:${kt}px;height:${kt}px;left:${Dt}px;top:${ot}px;`,Z.appendChild(Bt),setTimeout(()=>Bt.remove(),600)},vs=t?.name?.split(" ")[0]||"there",{prev:cn,next:hs}=bD(K),Wn=hs>cn?Math.round((K-cn)/(hs-cn)*100):100,Gr=[{label:"Programme",value:`${$}%`,pct:$,color:"#14b8a6",size:"normal"},{label:"Workouts",value:`${K}`,pct:Wn,color:"var(--color-primary)",size:"large"},{label:"Habits Today",value:`${be}%`,pct:be,color:"#38B6FF",size:"normal"}],pn=I=>!V||!V[I]?0:Math.min(Math.round(E[I]/V[I]*100),100),ja=(()=>{const I=new Date().getHours();return _e&&H>=Wi&&E.calories>0?{main:"Smashed it today,",sub:"Rest up and go again tomorrow."}:I>=5&&I<12?{main:"Rise and grind,",sub:"let's get after it!"}:I>=12&&I<17?{main:"Oye",sub:"crack on and make it count!"}:I>=17&&I<21?{main:"Evening session?",sub:"Let's finish strong!"}:{main:"Burning the midnight oil,",sub:"Respect the hustle!"}})(),Un=_e?W&&$e&&!Ve?{label:"NEXT SESSION",message:`Week ${$e.week}, Day ${$e.dayIdx+1}  ${$e.label}`,cta:"Continue",action:()=>y("/client/core-buddy/programmes"),pct:$,ringLabel:`${$}%`}:H<Wi?{label:"DAILY HABITS",message:`${H}/${Wi} completed`,cta:"Open Habits",action:()=>y("/client/core-buddy/consistency"),pct:be,ringLabel:`${H}/${Wi}`}:E.calories===0?{label:"NUTRITION",message:"No meals logged today",cta:"Log Meal",action:()=>y("/client/core-buddy/nutrition"),pct:0,ringLabel:"0"}:W?Ve?{label:"COMPLETE",message:"Programme finished!",cta:"New Programme",action:()=>y("/client/core-buddy/workouts"),pct:100,ringLabel:"100%"}:{label:"TODAY",message:"You're crushing it!",cta:null,action:null,pct:100,ringLabel:""}:{label:"PROGRAMMES",message:"Start a programme to level up",cta:"Browse",action:()=>y("/client/core-buddy/workouts"),pct:0,ringLabel:""}:null,as=v.useCallback(async()=>{if(t){X(!0);try{const I=await Ts(Ds(zt(ge,"posts"),ds("authorId","==",t.id),Gh("createdAt","desc"),Kh(30)));Ie(I.docs.map(Ne=>({id:Ne.id,...Ne.data()})));const Z=await Ts(Ds(zt(ge,"postLikes"),ds("userId","==",t.id)));At(new Set(Z.docs.map(Ne=>Ne.data().postId)))}catch(I){console.error("Error loading journey:",I)}finally{X(!1)}}},[t]);v.useEffect(()=>{_e&&t&&as()},[_e,t,as]);const un=I=>{const Z=I.target.files?.[0];if(Z){if(!Z.type.startsWith("image/")){ue("Please select an image file","error");return}if(Z.size>10*1024*1024){ue("Image must be under 10MB","error");return}Ae(Z),Tt(URL.createObjectURL(Z))}},sr=()=>{Ae(null),dt&&URL.revokeObjectURL(dt),Tt(null),ht.current&&(ht.current.value="")},Gn=async()=>{if(!(!he.trim()&&!qe||Q||!t)){de(!0);try{let I=null;if(qe){const et=await wD(qe),kt=`${Date.now()}_${Math.random().toString(36).slice(2,8)}`,Dt=eo(to,`postImages/${t.id}/${kt}`);await Up(Dt,et),I=await qo(Dt)}await hi(zt(ge,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:he.trim(),type:I?"image":"text",imageURL:I||null,createdAt:Hr(),likeCount:0,commentCount:0});const Ne=he.trim().match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Ne){const et=new Set;Ne.forEach(kt=>{const Dt=kt.slice(1).trim(),ot=_n.find(Bt=>Bt.name&&Bt.name.toLowerCase()===Dt.toLowerCase());ot&&!et.has(ot.id)&&(et.add(ot.id),xe(ot.id,"mention",{}))})}Pe(""),sr(),lt.current&&(lt.current.style.height="auto"),await as(),ue("Posted!","success")}catch(I){console.error("Error posting:",I),ue(I?.message||"Failed to post","error")}finally{de(!1)}}},_r=async I=>{if(window.confirm("Delete this post?"))try{await yr(ze(ge,"posts",I)),Ie(Z=>Z.filter(Ne=>Ne.id!==I)),ue("Post deleted","info")}catch(Z){console.error("Delete error:",Z),ue("Failed to delete","error")}},tn=async I=>{if(!t)return;const Z=t.id,Ne=`${I}_${Z}`,et=tt.has(I),kt=new Set(tt);et?kt.delete(I):kt.add(I),At(kt),Ie(Dt=>Dt.map(ot=>ot.id===I?{...ot,likeCount:Math.max(0,(ot.likeCount||0)+(et?-1:1))}:ot));try{if(et)await yr(ze(ge,"postLikes",Ne)),await Ma(ze(ge,"posts",I),{likeCount:Bo(-1)});else{await Es(ze(ge,"postLikes",Ne),{postId:I,userId:Z,createdAt:Hr()}),await Ma(ze(ge,"posts",I),{likeCount:Bo(1)});const Dt=Se.find(ot=>ot.id===I);Dt&&xe(Dt.authorId,"like",{postId:I})}}catch(Dt){console.error("Like error:",Dt),as()}},Ln=async I=>{try{const Z=await Ts(Ds(zt(ge,"postComments"),ds("postId","==",I),Gh("createdAt","asc"),Kh(50)));Vt(Ne=>({...Ne,[I]:Z.docs.map(et=>({id:et.id,...et.data()}))}))}catch(Z){console.error("Error loading comments:",Z)}},Nn=I=>{const Z=new Set(Et);Z.has(I)?Z.delete(I):(Z.add(I),Ut[I]||Ln(I)),ss(Z)},kr=async I=>{const Z=(Ls[I]||"").trim(),Ne=we[I];if(!(!Z&&!Ne||!t)){Ns(et=>({...et,[I]:!0}));try{let et=null;if(Ne){const $t=eo(to,`comment-images/${Date.now()}_${Ne.name}`);await Up($t,Ne),et=await qo($t)}const kt={postId:I,authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Z||"",createdAt:Hr()};et&&(kt.imageURL=et);const Dt=Os[I];Dt&&(kt.replyToId=Dt.id,kt.replyToName=Dt.authorName),await hi(zt(ge,"postComments"),kt),await Ma(ze(ge,"posts",I),{commentCount:Bo(1)});const ot=Se.find($t=>$t.id===I);ot&&xe(ot.authorId,"comment",{postId:I});const Bt=Z.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Bt){const $t=new Set;Bt.forEach(rs=>{const Ft=rs.slice(1).trim(),xs=_n.find(Fn=>Fn.name&&Fn.name.toLowerCase()===Ft.toLowerCase());xs&&!$t.has(xs.id)&&($t.add(xs.id),xe(xs.id,"mention",{postId:I}))})}Xs($t=>({...$t,[I]:""})),Te($t=>({...$t,[I]:null})),ke($t=>({...$t,[I]:null})),q($t=>({...$t,[I]:null})),st.current[I]&&(st.current[I].value=""),Ie($t=>$t.map(rs=>rs.id===I?{...rs,commentCount:(rs.commentCount||0)+1}:rs)),await Ln(I)}catch(et){console.error("Comment error:",et),ue("Failed to comment","error")}finally{Ns(et=>({...et,[I]:!1}))}}},jr=async(I,Z)=>{try{await yr(ze(ge,"postComments",Z)),await Ma(ze(ge,"posts",I),{commentCount:Bo(-1)}),Vt(Ne=>({...Ne,[I]:(Ne[I]||[]).filter(et=>et.id!==Z)})),Ie(Ne=>Ne.map(et=>et.id===I?{...et,commentCount:Math.max((et.commentCount||1)-1,0)}:et))}catch(Ne){console.error("Delete comment error:",Ne),ue("Failed to delete comment","error")}},Dr=(I,Z)=>{const Ne=Z.target.files?.[0];if(!Ne)return;if(Ne.size>5*1024*1024){ue("Image must be under 5MB","error");return}Te(kt=>({...kt,[I]:Ne}));const et=new FileReader;et.onload=kt=>ke(Dt=>({...Dt,[I]:kt.target.result})),et.readAsDataURL(Ne)},wi=I=>{Te(Z=>({...Z,[I]:null})),ke(Z=>({...Z,[I]:null})),st.current[I]&&(st.current[I].value="")},Ta=I=>{Pe(I.target.value),I.target.style.height="auto",I.target.style.height=Math.min(I.target.scrollHeight,120)+"px",ne(I.target.value,"compose")},Pr=(I,Z)=>{Xs(Ne=>({...Ne,[I]:Z})),ne(Z,I)};return r.jsx(xa,{children:r.jsxs("div",{className:"cb-dashboard","data-theme":d?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsxs("div",{className:"header-notif-wrap",ref:ln,children:[r.jsxs("button",{className:"header-notif-btn",onClick:()=>{mn(!ks),ks||Cs()},"aria-label":"Notifications",children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),r.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),ls>0&&r.jsx("span",{className:"header-notif-badge",children:ls>9?"9+":ls})]}),ks&&r.jsxs("div",{className:"notif-panel",children:[r.jsxs("div",{className:"notif-panel-header",children:[r.jsx("span",{className:"notif-panel-title",children:"Notifications"}),vt.length>0&&r.jsx("button",{className:"notif-clear-btn",onClick:Y,children:"Clear all"})]}),r.jsx("div",{className:"notif-panel-list",children:vt.length===0?r.jsx("div",{className:"notif-empty",children:"No notifications yet"}):vt.map(I=>r.jsxs("div",{className:`notif-item${I.read?"":" unread"}`,onClick:()=>{if(mn(!1),I.type==="buddy_request"||I.type==="buddy_accept")y("/client/core-buddy/buddies");else if((I.type==="like"||I.type==="comment")&&I.postId){if(!Et.has(I.postId)){const Z=new Set(Et);Z.add(I.postId),ss(Z),Ut[I.postId]||Ln(I.postId)}setTimeout(()=>{const Z=document.getElementById(`post-${I.postId}`);Z&&Z.scrollIntoView({behavior:"smooth",block:"center"})},150)}else I.type==="like"||I.type==="comment"?document.querySelector(".cb-journey-section")?.scrollIntoView({behavior:"smooth"}):I.type==="mention"&&y(`/client/core-buddy/profile/${I.fromId}`)},children:[r.jsx("div",{className:"notif-item-avatar",children:I.fromPhotoURL?r.jsx("img",{src:I.fromPhotoURL,alt:""}):r.jsx("span",{children:(I.fromName||"?")[0]})}),r.jsxs("div",{className:"notif-item-body",children:[r.jsxs("p",{className:"notif-item-text",children:[r.jsx("strong",{children:I.fromName})," ",I.type==="buddy_request"&&"sent you a buddy request",I.type==="buddy_accept"&&"accepted your buddy request",I.type==="like"&&"liked your post",I.type==="comment"&&"commented on your post",I.type==="mention"&&"mentioned you"]}),r.jsx("span",{className:"notif-item-time",children:qp(I.createdAt)})]})]},I.id))})]})]}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsxs("div",{className:"header-actions",children:[r.jsx("button",{onClick:p,"aria-label":"Toggle theme",children:d?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})}),r.jsx("button",{onClick:i,"aria-label":"Log out",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),r.jsx("polyline",{points:"16 17 21 12 16 7"}),r.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),r.jsxs("main",{className:"cb-main",children:[r.jsxs("div",{className:"cb-ring-container",children:[r.jsxs("div",{className:"cb-ring",children:[r.jsx("svg",{className:"cb-ring-svg",viewBox:"0 0 200 200",children:eb.map((I,Z)=>{const Ne=Z<T;return r.jsx("line",{x1:I.x1,y1:I.y1,x2:I.x2,y2:I.y2,className:`ring-tick ${Ne?"elapsed":"remaining"}`,strokeWidth:I.thick?"3":"2"},Z)})}),r.jsxs("div",{className:"cb-ring-center",children:[r.jsxs("div",{className:"cb-ring-logo",onClick:()=>wt.current?.click(),role:"button",tabIndex:0,"aria-label":"Change profile photo",children:[r.jsx("img",{src:jt||"/Logo.webp",alt:jt?"Profile":"Mind Core Fitness"}),r.jsx("div",{className:`cb-photo-overlay${Gt?" uploading":""}`,children:Gt?r.jsx("div",{className:"cb-photo-spinner"}):r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[r.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),r.jsx("input",{ref:wt,type:"file",accept:"image/*",onChange:it,style:{display:"none"}})]}),!jt&&!Gt&&r.jsx("div",{className:"cb-photo-badge",onClick:()=>wt.current?.click(),children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[r.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),r.jsxs("div",{className:"cb-ring-countdown",children:[r.jsx("span",{className:"cb-timer-digit",children:String(w.hours).padStart(2,"0")}),r.jsx("span",{className:"cb-timer-colon",children:":"}),r.jsx("span",{className:"cb-timer-digit",children:String(w.minutes).padStart(2,"0")}),r.jsx("span",{className:"cb-timer-colon",children:":"}),r.jsx("span",{className:"cb-timer-digit cb-timer-seconds",children:String(w.seconds).padStart(2,"0")})]}),r.jsx("span",{className:"cb-ring-label",children:"remaining today"}),r.jsxs("p",{className:"cb-ring-tagline",children:[zp[Jt].text," ",r.jsx("strong",{children:zp[Jt].bold})]},Jt)]}),r.jsx("div",{className:"cb-stats-row",children:Gr.map(I=>{const Z=(I.size==="large",38),Ne=2*Math.PI*Z,et=Ne-I.pct/100*Ne;return r.jsxs("div",{className:`cb-stat-item${I.size==="large"?" cb-stat-large":""}`,children:[r.jsxs("div",{className:"cb-stat-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-stat-track",cx:"50",cy:"50",r:Z}),r.jsx("circle",{className:"cb-stat-fill",cx:"50",cy:"50",r:Z,style:{stroke:I.color},strokeDasharray:Ne,strokeDashoffset:et})]}),r.jsx("span",{className:"cb-stat-value",style:{color:I.color},children:I.value})]}),r.jsx("span",{className:"cb-stat-label",children:I.label})]},I.label)})}),r.jsxs("p",{className:"cb-coach-msg",children:[ja.main," ",r.jsx("strong",{children:vs}),"  ",ja.sub]}),Un&&r.jsxs("button",{className:"cb-nudge-card",onClick:Un.action||void 0,style:Un.action?void 0:{cursor:"default"},children:[r.jsxs("div",{className:"cb-nudge-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-nudge-ring-track",cx:"50",cy:"50",r:"38"}),r.jsx("circle",{className:"cb-nudge-ring-fill",cx:"50",cy:"50",r:"38",strokeDasharray:2*Math.PI*38,strokeDashoffset:2*Math.PI*38-Un.pct/100*2*Math.PI*38})]}),r.jsx("span",{className:"cb-nudge-ring-val",children:Un.ringLabel})]}),r.jsxs("div",{className:"cb-nudge-info",children:[r.jsx("span",{className:"cb-nudge-label",children:Un.label}),r.jsx("span",{className:"cb-nudge-title",children:Un.message}),Un.cta&&r.jsxs("span",{className:"cb-nudge-cta",children:[Un.cta," "]})]})]}),r.jsxs("div",{className:"cb-features",children:[t?.buddyEnabled&&r.jsxs("button",{className:"cb-feature-card cb-card-buddy ripple-btn",onClick:I=>{Rt(I),y("/client/core-buddy/buddy")},children:[r.jsx("div",{className:"cb-buddy-icon",children:r.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 2a4 4 0 0 1 4 4v2a4 4 0 0 1-8 0V6a4 4 0 0 1 4-4z"}),r.jsx("path",{d:"M18 14c2 1 3 3 3 5v2H3v-2c0-2 1-4 3-5"}),r.jsx("circle",{cx:"9",cy:"7",r:"0.5",fill:"currentColor"}),r.jsx("circle",{cx:"15",cy:"7",r:"0.5",fill:"currentColor"}),r.jsx("path",{d:"M9.5 10a2.5 2.5 0 0 0 5 0"}),r.jsx("path",{d:"M7 13c1.5 1 3.5 1.5 5 1.5s3.5-.5 5-1.5"})]})}),r.jsxs("div",{className:"cb-card-content",children:[r.jsxs("h3",{children:["Buddy ",r.jsx("span",{className:"cb-buddy-badge",children:"AI"})]}),r.jsx("p",{className:"cb-card-desc",children:"Your AI training partner"})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("button",{className:`cb-feature-card cb-card-nutrition cb-card-has-preview ripple-btn${g?"":" cb-card-locked"}`,onClick:I=>{Rt(I),y(g?"/client/core-buddy/nutrition":"/upgrade")},children:[r.jsxs("div",{className:"cb-card-top-row",children:[r.jsx("div",{className:"cb-card-content",children:r.jsxs("h3",{children:["Today's Nutrition ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]})}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsx("div",{className:"cb-card-preview-row",children:r.jsx("div",{className:"cb-mini-rings",children:[{label:"P",pct:pn("protein"),color:"#14b8a6"},{label:"C",pct:pn("carbs"),color:"var(--color-primary)"},{label:"F",pct:pn("fats"),color:"#eab308"},{label:"Cal",pct:pn("calories"),color:"#38B6FF"}].map(I=>{const Ne=2*Math.PI*38,et=Ne-I.pct/100*Ne;return r.jsxs("div",{className:"cb-mini-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-mini-track",cx:"50",cy:"50",r:38}),r.jsx("circle",{className:"cb-mini-fill",cx:"50",cy:"50",r:38,style:{stroke:I.color},strokeDasharray:Ne,strokeDashoffset:et})]}),r.jsx("span",{style:{color:I.color},children:I.label})]},I.label)})})}),r.jsx("p",{className:"cb-card-desc",children:"Track macros, scan barcodes, log water"})]}),r.jsxs("button",{className:"cb-feature-card cb-card-workouts-hero ripple-btn",onClick:I=>{Rt(I),y("/client/core-buddy/workouts")},children:[r.jsx("h3",{className:"cb-hero-title",children:"Workouts"}),r.jsxs("div",{className:"cb-hero-stats",children:[r.jsxs("span",{children:[ee," this week"]}),r.jsx("span",{className:"cb-hero-dot",children:""}),r.jsxs("span",{children:[K," total"]})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("div",{className:"cb-grid-row",children:[r.jsxs("button",{className:`cb-feature-card cb-grid-card cb-card-consistency ripple-btn${g?"":" cb-card-locked"}`,onClick:I=>{Rt(I),y(g?"/client/core-buddy/consistency":"/upgrade")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsxs("h3",{children:["Habits ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),r.jsx("div",{className:"cb-habit-dots",children:Array.from({length:Wi},(I,Z)=>r.jsx("span",{className:`cb-habit-dot${Z<H?" done":""}`},Z))}),r.jsxs("span",{className:"cb-habit-dots-label",children:[H,"/",Wi," today"]})]}),r.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("button",{className:`cb-feature-card cb-grid-card cb-card-progress ripple-btn${g?"":" cb-card-locked"}`,onClick:I=>{Rt(I),y(g?"/client/personal-bests?mode=corebuddy":"/upgrade")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsxs("h3",{children:["PBs ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),Le.length>0?r.jsx("div",{className:"cb-pb-preview",children:Le.slice(0,2).map(I=>r.jsxs("div",{className:"cb-pb-entry",children:[r.jsx("span",{className:"cb-pb-name",children:I.name}),r.jsxs("span",{className:"cb-pb-value",children:[I.weight,"kg"]})]},I.name))}):r.jsxs("div",{className:"cb-progress-preview",children:[r.jsx("svg",{className:"cb-progress-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),r.jsx("span",{children:"Start lifting!"})]})]}),r.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]})]}),r.jsxs("button",{className:`cb-feature-card cb-card-leaderboard ripple-btn${g?"":" cb-card-locked"}`,onClick:I=>{Rt(I),y(g?"/client/leaderboard":"/upgrade")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsxs("h3",{children:["Leaderboard ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),Fe.length>0?r.jsx("div",{className:"cb-lb-preview",children:Fe.map((I,Z)=>{const Ne=["#FFD700","#A8B4C0","#CD7F32"][Z],et=I.name?I.name.split(" ").map(Dt=>Dt[0]).join("").slice(0,2).toUpperCase():"?",kt=I.id===t?.id;return r.jsxs("div",{className:`cb-lb-entry${kt?" cb-lb-me":""}`,children:[r.jsx("div",{className:"cb-lb-avatar",style:{borderColor:Ne},children:I.photoURL?r.jsx("img",{src:I.photoURL,alt:"",className:"cb-lb-avatar-img"}):r.jsx("span",{children:et})}),r.jsxs("span",{className:"cb-lb-rank",style:{color:Ne},children:["#",Z+1]})]},I.id)})}):r.jsx("p",{children:"Opt in to compete with your Core Buddies"})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("button",{className:`cb-feature-card cb-card-buddies ripple-btn${g?"":" cb-card-locked"}`,onClick:I=>{Rt(I),y(g?"/client/core-buddy/buddies":"/upgrade")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsxs("h3",{children:["Buddies ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),r.jsx("p",{children:"Connect with other members and track each other's progress"})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("div",{className:`cb-achievements-section${g?"":" cb-card-locked"}`,children:[r.jsxs("h3",{className:"cb-achievements-title",children:["Achievements ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),g?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"cb-badges-scroll",children:mu.map(I=>{const Z=gt.includes(I.id);return r.jsx("button",{className:`cb-badge${Z?" unlocked":" locked"}`,onClick:()=>Kt(I),children:r.jsx("img",{src:I.img,alt:I.name,className:"cb-badge-img"})},I.id)})}),r.jsxs("p",{className:"cb-badges-count",children:[gt.length,"/",mu.length," unlocked"]})]}):r.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>y("/upgrade"),children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),r.jsx("span",{children:"Upgrade to unlock achievements"})]})]}),r.jsxs("div",{className:"cb-journey-section",children:[r.jsxs("h3",{className:"cb-journey-title",children:["My Journey ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),g?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"journey-compose",children:[r.jsx("div",{className:"journey-compose-avatar",children:jt?r.jsx("img",{src:jt,alt:""}):r.jsx("span",{children:Jc(t?.name)})}),r.jsxs("div",{className:"journey-compose-body",style:{position:"relative"},children:[r.jsx("textarea",{ref:lt,placeholder:"Share your progress... (use @ to mention)",value:he,onChange:Ta,rows:1,maxLength:500}),k&&P==="compose"&&me.length>0&&r.jsx("div",{className:"mention-dropdown",children:me.map(I=>r.jsxs("button",{className:"mention-option",onClick:()=>Ke(I,"compose"),children:[r.jsx("div",{className:"mention-option-avatar",children:I.photoURL?r.jsx("img",{src:I.photoURL,alt:""}):r.jsx("span",{children:Jc(I.name)})}),r.jsx("span",{children:I.name})]},I.id))}),dt&&r.jsxs("div",{className:"journey-image-preview",children:[r.jsx("img",{src:dt,alt:"Preview"}),r.jsx("button",{className:"journey-image-remove",onClick:sr,"aria-label":"Remove image",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),r.jsxs("div",{className:"journey-compose-actions",children:[r.jsx("button",{className:"journey-image-btn",onClick:()=>ht.current?.click(),"aria-label":"Add image",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),r.jsx("input",{ref:ht,type:"file",accept:"image/*",onChange:un,hidden:!0}),(he.trim()||qe)&&r.jsx("button",{className:"journey-post-btn",onClick:Gn,disabled:Q,children:Q?r.jsx("div",{className:"journey-btn-spinner"}):"Post"})]})]})]}),Ge?r.jsx("div",{className:"journey-loading",children:r.jsx("div",{className:"cb-spinner"})}):Se.length===0?r.jsxs("div",{className:"journey-empty",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]}),r.jsx("p",{children:"Start sharing your fitness journey!"})]}):r.jsx("div",{className:"journey-list",children:Se.map(I=>r.jsxs("div",{id:`post-${I.id}`,className:"journey-post",children:[r.jsxs("div",{className:"journey-post-header",children:[r.jsx("div",{className:"journey-post-avatar",children:I.authorPhotoURL?r.jsx("img",{src:I.authorPhotoURL,alt:""}):r.jsx("span",{children:Jc(I.authorName)})}),r.jsxs("div",{className:"journey-post-meta",children:[r.jsx("span",{className:"journey-post-name",children:I.authorName}),r.jsx("span",{className:"journey-post-time",children:qp(I.createdAt)})]}),r.jsx("button",{className:"journey-delete-btn",onClick:()=>_r(I.id),"aria-label":"Delete post",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),I.content&&r.jsx("p",{className:"journey-post-content",children:He(I.content)}),I.imageURL&&r.jsx("div",{className:"journey-post-image",children:r.jsx("img",{src:I.imageURL,alt:"Post",loading:"lazy"})}),r.jsxs("div",{className:"journey-post-actions",children:[r.jsxs("button",{className:`journey-action-btn${tt.has(I.id)?" liked":""}`,onClick:()=>tn(I.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:tt.has(I.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),r.jsx("span",{children:I.likeCount||0})]}),r.jsxs("button",{className:`journey-action-btn${Et.has(I.id)?" active":""}`,onClick:()=>Nn(I.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),r.jsx("span",{children:I.commentCount||0})]})]}),Et.has(I.id)&&r.jsxs("div",{className:"journey-comments",children:[Ut[I.id]?.length>0?Ut[I.id].map(Z=>r.jsxs("div",{className:"journey-comment",children:[r.jsx("div",{className:"journey-comment-avatar",children:Z.authorPhotoURL?r.jsx("img",{src:Z.authorPhotoURL,alt:""}):r.jsx("span",{children:Jc(Z.authorName)})}),r.jsxs("div",{className:"journey-comment-body",children:[r.jsxs("div",{className:"journey-comment-bubble",children:[r.jsx("span",{className:"journey-comment-name",children:Z.authorName}),Z.replyToName&&r.jsxs("span",{className:"journey-comment-reply-tag",children:[r.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("polyline",{points:"9 14 4 9 9 4"}),r.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),Z.replyToName]}),Z.content&&r.jsx("span",{className:"journey-comment-text",children:He(Z.content)}),Z.imageURL&&r.jsx("img",{className:"journey-comment-image",src:Z.imageURL,alt:"Comment",loading:"lazy"})]}),r.jsxs("div",{className:"journey-comment-actions-row",children:[r.jsx("span",{className:"journey-comment-time",children:qp(Z.createdAt)}),r.jsx("button",{className:"journey-comment-reply-btn",onClick:()=>q(Ne=>({...Ne,[I.id]:{id:Z.id,authorName:Z.authorName}})),children:"Reply"}),r.jsx("button",{className:"journey-comment-delete-btn",onClick:()=>jr(I.id,Z.id),"aria-label":"Delete comment",children:r.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]})]},Z.id)):r.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),Os[I.id]&&r.jsxs("div",{className:"journey-comment-replying",children:[r.jsxs("span",{children:["Replying to ",r.jsx("strong",{children:Os[I.id].authorName})]}),r.jsx("button",{onClick:()=>q(Z=>({...Z,[I.id]:null})),"aria-label":"Cancel reply",children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),Ee[I.id]&&r.jsxs("div",{className:"journey-comment-img-preview",children:[r.jsx("img",{src:Ee[I.id],alt:"Preview"}),r.jsx("button",{onClick:()=>wi(I.id),"aria-label":"Remove image",children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),r.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[r.jsx("button",{className:"journey-comment-img-btn",onClick:()=>st.current[I.id]?.click(),"aria-label":"Add image",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),r.jsx("input",{ref:Z=>{st.current[I.id]=Z},type:"file",accept:"image/*",onChange:Z=>Dr(I.id,Z),hidden:!0}),r.jsx("input",{type:"text",placeholder:"Comment",value:Ls[I.id]||"",onChange:Z=>Pr(I.id,Z.target.value),onKeyDown:Z=>{Z.key==="Enter"&&kr(I.id)},maxLength:300}),k&&P===I.id&&me.length>0&&r.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:me.map(Z=>r.jsxs("button",{className:"mention-option",onClick:()=>Ke(Z,I.id),children:[r.jsx("div",{className:"mention-option-avatar",children:Z.photoURL?r.jsx("img",{src:Z.photoURL,alt:""}):r.jsx("span",{children:Jc(Z.name)})}),r.jsx("span",{children:Z.name})]},Z.id))}),r.jsx("button",{onClick:()=>kr(I.id),disabled:!(Ls[I.id]||"").trim()&&!we[I.id]||is[I.id],children:is[I.id]?r.jsx("div",{className:"journey-btn-spinner-sm"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),r.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},I.id))})]}):r.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>y("/upgrade"),children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),r.jsx("span",{children:"Upgrade to share your journey"})]})]})]})]}),Xt&&r.jsx("div",{className:"cb-badge-overlay",onClick:()=>Kt(null),children:r.jsxs("div",{className:"cb-badge-overlay-content",onClick:I=>I.stopPropagation(),children:[r.jsx("img",{src:Xt.img,alt:Xt.name,className:`cb-badge-overlay-img${gt.includes(Xt.id)?"":" cb-badge-overlay-img-locked"}`}),gt.includes(Xt.id)?r.jsx("span",{className:"cb-badge-status unlocked",children:"Unlocked"}):r.jsx("span",{className:"cb-badge-status locked",children:"Locked"}),r.jsx("button",{className:"cb-badge-overlay-close",onClick:()=>Kt(null),children:"Tap to close"})]})}),r.jsx(aa,{active:"home"}),Ot&&r.jsxs("div",{className:`toast-notification ${Ot.type}`,children:[Ot.type==="info"&&r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),r.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),Ot.message]}),r.jsx(yD,{steps:os,active:Ze,onFinish:_t}),ut&&r.jsxs("div",{className:"cb-celebration-overlay",onClick:()=>bt(null),children:[r.jsx("div",{className:"cb-confetti-container",children:Array.from({length:30},(I,Z)=>r.jsx("span",{className:"cb-confetti-piece",style:{"--angle":`${Math.random()*360}deg`,"--distance":`${80+Math.random()*120}px`,"--delay":`${Math.random()*.3}s`,"--color":["#FFD700","#FF6B6B","#4ECDC4","#45B7D1","#F7DC6F","#BB8FCE","#FF8C42","#38B6FF"][Z%8],"--size":`${6+Math.random()*6}px`,"--drift":`${(Math.random()-.5)*60}px`}},Z))}),r.jsxs("div",{className:"cb-celebration-content",onClick:I=>I.stopPropagation(),children:[r.jsx("div",{className:"cb-celebration-glow"}),r.jsx("img",{src:ut.img,alt:ut.name,className:"cb-celebration-badge-img"}),r.jsx("h2",{className:"cb-celebration-title",children:"Badge Unlocked!"}),r.jsx("p",{className:"cb-celebration-name",children:ut.name}),r.jsx("button",{className:"cb-celebration-dismiss",onClick:()=>bt(null),children:"Tap to continue"})]})]})]})})}const Hp=new Map;function Gi(){return new Date().toISOString().split("T")[0]}const j2=[{key:"breakfast",label:"Breakfast"},{key:"lunch",label:"Lunch"},{key:"dinner",label:"Dinner"},{key:"snacks",label:"Snacks"}],kD={breakfast:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1"}),r.jsx("path",{d:"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"}),r.jsx("line",{x1:"6",y1:"1",x2:"6",y2:"4"}),r.jsx("line",{x1:"10",y1:"1",x2:"10",y2:"4"}),r.jsx("line",{x1:"14",y1:"1",x2:"14",y2:"4"})]}),lunch:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}),dinner:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),snacks:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})};function jD(){const n=new Date().getHours();return n<11?"breakfast":n<14?"lunch":n<17?"snacks":"dinner"}function TD(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Mr(),{isDark:l,toggleTheme:u,accent:d}=ka(),p=$n(),[g,y]=v.useState("loading"),[w,j]=v.useState(null),[T,O]=v.useState({gender:"male",age:"",weight:"",weightUnit:"kg",height:"",heightUnit:"cm",heightFeet:"",heightInches:"",dailyActivity:"sedentary",trainingFrequency:"moderate",goal:"maintain",deficitLevel:"moderate"}),[$,F]=v.useState(null),[B,te]=v.useState(Gi()),[K,ae]=v.useState({entries:[],water:0}),[be,ve]=v.useState({protein:0,carbs:0,fats:0,calories:0}),[_e,R]=v.useState(!1),[E,A]=v.useState(!1),[V,D]=v.useState(()=>{const k=new Date;return{year:k.getFullYear(),month:k.getMonth()}}),[H,M]=v.useState(jD),[$e,pt]=v.useState(null),[W,pe]=v.useState(null),[Ve,We]=v.useState(!1),[ee,L]=v.useState(null),[se,De]=v.useState(""),[Le,Qe]=v.useState(!1),[Fe,ft]=v.useState(""),[jt,at]=v.useState([]),[Gt,_s]=v.useState(!1),[wt,gt]=v.useState({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),[le,Xt]=v.useState(null),[Kt,ut]=v.useState("100"),[bt,Xe]=v.useState(0),[rt,qt]=v.useState("weight"),[en,As]=v.useState(0),[ts,Ct]=v.useState(null);v.useRef(null);const Jt=v.useRef(!1),Ss=v.useRef(null),Ot=v.useRef(null),Ps=v.useRef(null),ue=v.useCallback((k,N="info")=>{Ct({message:k,type:N}),setTimeout(()=>Ct(null),3e3)},[]);v.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),v.useEffect(()=>{if(!t?.id)return;(async()=>{try{const N=await Rs(ze(ge,"nutritionTargets",t.id));N.exists()?(j(N.data()),y("dashboard")):y("setup")}catch(N){console.error("Error loading nutrition data:",N),y("setup")}})()},[t?.id]),v.useEffect(()=>{if(!t?.id)return;(async()=>{try{const N=await Rs(ze(ge,"nutritionLogs",`${t.id}_${B}`));if(N.exists()){const P=N.data();ae({entries:P.entries||[],water:P.water||0})}else ae({entries:[],water:0})}catch(N){console.error("Error loading log:",N),ae({entries:[],water:0})}})()},[t?.id,B]),v.useEffect(()=>{const k=K.entries.reduce((N,P)=>({protein:N.protein+(P.protein||0),carbs:N.carbs+(P.carbs||0),fats:N.fats+(P.fats||0),calories:N.calories+(P.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});ve(k)},[K.entries]);const Se=async k=>{try{await Es(ze(ge,"nutritionLogs",`${t.id}_${B}`),{clientId:t.id,date:B,entries:k.entries,water:k.water,updatedAt:xt.now()})}catch(N){console.error("Error saving nutrition log:",N)}},Ie=B===Gi(),Ge=(k,N)=>new Date(k,N+1,0).getDate(),X=(k,N)=>new Date(k,N,1).getDay(),he=["January","February","March","April","May","June","July","August","September","October","November","December"],Pe=["Su","Mo","Tu","We","Th","Fr","Sa"],qe=()=>{let k=parseFloat(T.weight);T.weightUnit==="lbs"&&(k*=.453592);let N;T.heightUnit==="cm"?N=parseFloat(T.height):N=(parseFloat(T.heightFeet)||0)*30.48+(parseFloat(T.heightInches)||0)*2.54;const P=parseInt(T.age);let U=T.gender==="male"?10*k+6.25*N-5*P+5:10*k+6.25*N-5*P-161;const Be=U*{sedentary:1.2,light:1.3,moderate:1.4,active:1.5}[T.dailyActivity],Ue={low:100,moderate:200,high:300,daily:400},Je=Math.round(Be+Ue[T.trainingFrequency]);let Ze=Je,Ht,bs;switch(T.goal){case"lose":Ze=Je*(1-{light:.15,moderate:.2,harsh:.25}[T.deficitLevel]),Ht=2.2,bs=.3;break;case"build":Ze=Je*1.1,Ht=2,bs=.22;break;default:Ht=1.8,bs=.25}Ze=Math.max(Ze,T.gender==="male"?1400:1100);const os=Math.round(k*Ht),ls=Math.round(Ze*bs/9),Cs=Math.max(0,Math.round((Ze-os*4-ls*9)/4));F({calories:Math.round(Ze),protein:os,carbs:Cs,fats:ls,bmr:Math.round(U),neat:Math.round(Be),exerciseAdd:Ue[T.trainingFrequency],tdee:Math.round(Je)})},Ae=async()=>{if($)try{const k={clientId:t.id,calories:$.calories,protein:$.protein,carbs:$.carbs,fats:$.fats,waterGoal:8,goal:T.goal,updatedAt:xt.now()};await Es(ze(ge,"nutritionTargets",t.id),k),j(k),y("dashboard"),ue("Macro targets saved!","success")}catch(k){console.error("Error saving targets:",k),ue("Failed to save targets. Please try again.","error")}},dt=()=>{const k=T.weight&&parseFloat(T.weight)>0,N=T.age&&parseInt(T.age)>0,P=T.heightUnit==="cm"?T.height&&parseFloat(T.height)>0:T.heightFeet&&parseFloat(T.heightFeet)>0||T.heightInches&&parseFloat(T.heightInches)>0;return k&&N&&P},Tt="nut_favourite_foods",Q=()=>{try{return JSON.parse(localStorage.getItem(Tt)||"[]")}catch{return[]}},de=k=>Q().some(N=>N.name.toLowerCase()===(k||"").toLowerCase()),tt=k=>{const N=Q(),P=N.findIndex(U=>U.name.toLowerCase()===k.name.toLowerCase());P>=0?N.splice(P,1):N.unshift({name:k.name,protein:k.protein,carbs:k.carbs,fats:k.fats,calories:k.calories,serving:k.serving,per100g:k.per100g||null,servingUnit:k.servingUnit||"g",portion:k.portion||null}),localStorage.setItem(Tt,JSON.stringify(N)),As(U=>U+1)},At=k=>{const N=[...K.entries,{...k,meal:H,id:Date.now(),addedAt:new Date().toISOString()}],P={...K,entries:N};ae(P),Se(P),pe(null),Xt(null),ut("100"),Xe(0),qt("weight"),gt({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),ue("Food added!","success")},Et=k=>{const N=K.entries.filter(U=>U.id!==k),P={...K,entries:N};ae(P),Se(P)},ss=v.useRef(null),Ut=async()=>{We(!0);const k=document.querySelector("#barcode-reader");if(!k){We(!1),ue("Scanner container not found.","error");return}if(!ss.current)try{const P=await wr(()=>import("./quagga.min-BbicSfvA.js").then(U=>U.q),[]);ss.current=P.default}catch(P){console.error("Failed to load barcode scanner:",P),We(!1),ue("Could not load scanner.","error");return}const N=ss.current;N.init({inputStream:{type:"LiveStream",target:k,constraints:{facingMode:"environment",width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080}}},locator:{patchSize:"medium",halfSample:!0},numOfWorkers:navigator.hardwareConcurrency||2,decoder:{readers:["ean_reader","ean_8_reader","upc_reader","upc_e_reader","code_128_reader","code_39_reader"]},locate:!0},P=>{if(P){console.error("Quagga init error:",P),We(!1),ue("Could not access camera. Check permissions.","error");return}N.start(),Jt.current=!0}),N.onDetected(P=>{const U=P.codeResult.decodedCodes?.filter(Be=>Be.error!==void 0)?.map(Be=>Be.error)||[];if((U.length>0?U.reduce((Be,Ue)=>Be+Ue,0)/U.length:1)<.15){const Be=P.codeResult.code;N.offDetected(),L(Be)}})},Vt=()=>{const k=ss.current;Jt.current&&k&&(k.stop(),k.offDetected(),Jt.current=!1),We(!1)},Ls=/\b(milk|semi.skimmed|skimmed|whole milk|oat milk|almond milk|soy milk|juice|smoothie|water|squash|cordial|cola|pepsi|fanta|lemonade|soda|beer|wine|cider|lager|spirit|whisky|vodka|rum|gin|brandy|cream|yoghurt drink|milkshake|coffee|tea|broth|stock|soup|sauce|ketchup|vinegar|oil|syrup|honey|custard|coconut water|kombucha|energy drink|protein shake)\b/i,Xs=k=>/ml|cl|\dl(?!b)|litre|liter|fl\s?oz/i.test((k||"").replace(/\s/g,"")),is=k=>{if(!k)return{value:100,unit:"g"};const N=k.toLowerCase().replace(/\s/g,""),P=N.match(/([\d.]+)/),U=P?parseFloat(P[1]):100;return Xs(k)?/cl/.test(N)?{value:U*10,unit:"ml"}:/(?:^|\d)l(?!i)/.test(N)&&!/ml/.test(N)?{value:U*1e3,unit:"ml"}:{value:U,unit:"ml"}:{value:U,unit:"g"}},Ns=k=>{if(Xs(k.serving_size)||Xs(k.quantity))return"ml";const N=k.product_name||k.product_name_en||"";return Ls.test(N)?"ml":"g"},Os=[{pattern:/\b(toast|bread|loaf|brioche|bagel|pitta|wrap|tortilla|crumpet|muffin|waffle|pancake)\b/i,label:"slice",weight:36},{pattern:/\begg\b/i,label:"egg",weight:60},{pattern:/\b(biscuit|cookie|digestive|hobnob|rich tea|oreo)\b/i,label:"biscuit",weight:13},{pattern:/\b(sausage|banger)\b/i,label:"sausage",weight:57},{pattern:/\b(rasher|bacon)\b/i,label:"rasher",weight:25},{pattern:/\b(rice cake)\b/i,label:"cake",weight:9},{pattern:/\b(cracker|ryvita)\b/i,label:"cracker",weight:10}],q=(k,N)=>{const P=k||"",U=P.match(/\((\d+\.?\d*)\s*g\)/i),me=P.match(/(?:^|per\s+)(\d*\s*[a-z][a-z\s]*?)(?:\s*\(|\s*-\s*|\s*$)/i);if(U&&me){const Je=parseFloat(U[1]);let Ze=me[1].replace(/^\d+\s*/,"").trim();if(Ze&&Je>0)return{label:Ze,weight:Je}}const Be=P.match(/(\d+\.?\d*)\s*g\s*[\/=]\s*(\d*\s*[a-z][a-z\s]*)/i);if(Be){const Je=parseFloat(Be[1]);let Ze=Be[2].replace(/^\d+\s*/,"").trim();if(Ze&&Je>0)return{label:Ze,weight:Je}}const Ue=N||"";for(const{pattern:Je,label:Ze,weight:Ht}of Os)if(Je.test(Ue))return{label:Ze,weight:Ht};return null},we=k=>{const N=k.nutriments||{},P=Ns(k),U=is(k.serving_size),me=P==="ml"?U.unit==="ml"?U.value:100:U.value,Be=k.product_name||k.product_name_en||"Unknown Product",Ue=q(k.serving_size,Be);return{name:Be,brand:k.brands||"",image:k.image_small_url||k.image_url||null,servingSize:k.serving_size||"100g",servingValue:me,servingUnit:P,portion:Ue,protein:Math.round(N.proteins_100g||N.proteins||0),carbs:Math.round(N.carbohydrates_100g||N.carbohydrates||0),fats:Math.round(N.fat_100g||N.fat||0),calories:Math.round(N["energy-kcal_100g"]||N["energy-kcal"]||(N.energy_100g?N.energy_100g/4.184:0)),per100g:!0}},Te=async k=>{Qe(!0);try{const N=`https://world.openfoodfacts.org/api/v2/product/${k}?fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,P=await fetch(N);if(!P.ok)throw new Error(`HTTP ${P.status}`);const U=await P.json();if(U.status==="success"||U.status===1||U.product){const me=we(U.product);me.calories===0&&me.protein===0&&me.carbs===0?ue("Product found but no nutrition data available.","error"):(Xt(me),me.portion?(Xe(1),ut(String(me.portion.weight)),qt("portion")):(Xe(0),ut(String(me.servingValue||100)),qt("weight")),De(""))}else ue("Product not found. Try search or manual entry.","error")}catch(N){console.error("Barcode lookup error:",N),ue("Failed to look up product. Check your connection.","error")}Qe(!1)},Ee=(k,N,P)=>{const U=k.toLowerCase().trim(),me=N.toLowerCase().trim(),Be=P.toLowerCase().trim();let Ue=0;return(U===Be||U===Be+"s"||U+"s"===Be)&&(Ue+=100),(U.endsWith(" "+Be)||U.endsWith(" "+Be+"s"))&&(Ue+=40),(U.startsWith(Be+" ")||U.startsWith(Be+"s "))&&(Ue+=15),Be.split(/\s+/).some(Ze=>me===Ze||me.startsWith(Ze))&&(Ue+=30),Ue+=Math.max(0,30-U.length),Ue},ke=async()=>{if(!Fe.trim())return;Ss.current&&Ss.current.abort();const k=new AbortController;Ss.current=k;const N=Fe.trim().toLowerCase(),P=N.split(/\s+/).filter(Boolean);if(Hp.has(N)){at(Hp.get(N));return}_s(!0);try{const me=`https://world.openfoodfacts.org/cgi/search.pl?search_terms=${encodeURIComponent(Fe.trim())}&search_simple=1&action=process&json=1&page_size=10&lc=en&sort_by=unique_scans_n&fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,Be=await fetch(me,{signal:k.signal});if(!Be.ok)throw new Error(`HTTP ${Be.status}`);const Je=((await Be.json()).products||[]).map(Ze=>we(Ze)).filter(Ze=>Ze.name!=="Unknown Product"&&(Ze.calories>0||Ze.protein>0)).filter(Ze=>{const Ht=(Ze.name+" "+Ze.brand).toLowerCase();return P.every(bs=>Ht.includes(bs))}).sort((Ze,Ht)=>Ee(Ht.name,Ht.brand,N)-Ee(Ze.name,Ze.brand,N)).slice(0,10);Hp.set(N,Je),at(Je),Je.length===0&&ue("No results found. Try a different search.","info")}catch(U){if(U.name==="AbortError")return;console.error("Search error:",U),ue("Search failed. Check your connection.","error")}_s(!1)};v.useEffect(()=>{if(Ot.current&&clearTimeout(Ot.current),!(!Fe.trim()||W!=="search"||le))return Ot.current=setTimeout(()=>{ke()},700),()=>clearTimeout(Ot.current)},[Fe]);const lt=()=>{const k={...K,water:K.water+1};ae(k),Se(k)},ht=()=>{if(K.water<=0)return;const k={...K,water:K.water-1};ae(k),Se(k)},st={"ring-protein":"#14b8a6","ring-carbs":"var(--color-primary)","ring-fats":"#eab308","ring-cals":"rgba(150,150,150,0.55)"},vt=80,It=2*Math.PI*vt,ks=(k,N,P,U,me)=>{const Be=U>0?Math.min(100,Math.round(P/U*100)):0,Ue=It-Be/100*It,Je=st[me]||"#14b8a6";return r.jsxs("div",{className:"nut-ring-wrap",children:[r.jsxs("svg",{className:"nut-ring-svg",viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"nut-arc-track",cx:"100",cy:"100",r:vt}),r.jsx("circle",{className:"nut-arc-fill",cx:"100",cy:"100",r:vt,style:{stroke:Je},strokeDasharray:It,strokeDashoffset:Ue})]}),r.jsxs("div",{className:"nut-ring-center",children:[r.jsx("span",{className:"nut-ring-value",style:{color:Je},children:Math.round(P)}),r.jsxs("span",{className:"nut-ring-target",children:["/ ",U,k==="Calories"?"":"g"]}),r.jsx("span",{className:"nut-ring-label",style:{color:Je},children:N})]}),r.jsxs("span",{className:"nut-ring-pct",style:{color:Je},children:[Be,"%"]})]})};if(v.useEffect(()=>{if(!ee)return;const k=setTimeout(()=>{const N=ee;Vt(),L(null),Te(N)},1500);return()=>clearTimeout(k)},[ee]),v.useEffect(()=>()=>{const k=ss.current;if(Jt.current&&k){try{k.stop(),k.offDetected()}catch{}Jt.current=!1}},[]),i||g==="loading")return r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsx("div",{className:"nut-loading-inline",children:r.jsx("div",{className:"cb-loading-spinner"})})]});if(g==="setup")return r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"nut-main",children:[r.jsxs("div",{className:"nut-setup-intro",children:[r.jsx("h2",{children:"Set Your Daily Targets"}),r.jsx("p",{children:"Calculate your personalised macros based on your body and goals."})]}),r.jsxs("div",{className:"nut-calc-form",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Gender"}),r.jsxs("div",{className:"nut-toggle-group",children:[r.jsx("button",{className:T.gender==="male"?"active":"",onClick:()=>{O(k=>({...k,gender:"male"})),F(null)},children:"Male"}),r.jsx("button",{className:T.gender==="female"?"active":"",onClick:()=>{O(k=>({...k,gender:"female"})),F(null)},children:"Female"})]})]}),r.jsxs("div",{className:"nut-form-row",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Age"}),r.jsx("input",{type:"number",value:T.age,onChange:k=>{O(N=>({...N,age:k.target.value})),F(null)},placeholder:"Years",min:"15",max:"100"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Weight"}),r.jsxs("div",{className:"nut-input-unit",children:[r.jsx("input",{type:"number",value:T.weight,onChange:k=>{O(N=>({...N,weight:k.target.value})),F(null)},placeholder:T.weightUnit,min:"30",max:"300"}),r.jsxs("div",{className:"nut-unit-toggle",children:[r.jsx("button",{className:T.weightUnit==="kg"?"active":"",onClick:()=>{O(k=>({...k,weightUnit:"kg"})),F(null)},children:"kg"}),r.jsx("button",{className:T.weightUnit==="lbs"?"active":"",onClick:()=>{O(k=>({...k,weightUnit:"lbs"})),F(null)},children:"lbs"})]})]})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Height"}),r.jsxs("div",{className:"nut-input-unit",children:[T.heightUnit==="cm"?r.jsx("input",{type:"number",value:T.height,onChange:k=>{O(N=>({...N,height:k.target.value})),F(null)},placeholder:"cm",min:"100",max:"250"}):r.jsxs("div",{className:"nut-height-imperial",children:[r.jsx("input",{type:"number",value:T.heightFeet,onChange:k=>{O(N=>({...N,heightFeet:k.target.value})),F(null)},placeholder:"ft",min:"4",max:"7"}),r.jsx("input",{type:"number",value:T.heightInches,onChange:k=>{O(N=>({...N,heightInches:k.target.value})),F(null)},placeholder:"in",min:"0",max:"11"})]}),r.jsxs("div",{className:"nut-unit-toggle",children:[r.jsx("button",{className:T.heightUnit==="cm"?"active":"",onClick:()=>{O(k=>({...k,heightUnit:"cm"})),F(null)},children:"cm"}),r.jsx("button",{className:T.heightUnit==="ft"?"active":"",onClick:()=>{O(k=>({...k,heightUnit:"ft"})),F(null)},children:"ft/in"})]})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Daily Activity (outside of training)"}),r.jsxs("select",{value:T.dailyActivity,onChange:k=>{O(N=>({...N,dailyActivity:k.target.value})),F(null)},children:[r.jsx("option",{value:"sedentary",children:"Sedentary  desk job, under 5k steps"}),r.jsx("option",{value:"light",children:"Lightly Active  office + walking, 5-8k steps"}),r.jsx("option",{value:"moderate",children:"Moderately Active  on feet often, 8-12k steps"}),r.jsx("option",{value:"active",children:"Very Active  physical job, 12k+ steps"})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Training Sessions per Week"}),r.jsxs("select",{value:T.trainingFrequency,onChange:k=>{O(N=>({...N,trainingFrequency:k.target.value})),F(null)},children:[r.jsx("option",{value:"low",children:"1-2 sessions"}),r.jsx("option",{value:"moderate",children:"3-4 sessions"}),r.jsx("option",{value:"high",children:"5-6 sessions"}),r.jsx("option",{value:"daily",children:"7+ sessions"})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Fitness Goal"}),r.jsxs("div",{className:"nut-goal-options",children:[r.jsxs("button",{className:T.goal==="lose"?"active":"",onClick:()=>{O(k=>({...k,goal:"lose"})),F(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"-"}),r.jsx("span",{children:"Lose Weight"})]}),r.jsxs("button",{className:T.goal==="maintain"?"active":"",onClick:()=>{O(k=>({...k,goal:"maintain"})),F(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"="}),r.jsx("span",{children:"Maintain"})]}),r.jsxs("button",{className:T.goal==="build"?"active":"",onClick:()=>{O(k=>({...k,goal:"build"})),F(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"+"}),r.jsx("span",{children:"Build Muscle"})]})]})]}),T.goal==="lose"&&r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Deficit Level"}),r.jsxs("div",{className:"nut-deficit-options",children:[r.jsxs("button",{className:T.deficitLevel==="light"?"active":"",onClick:()=>{O(k=>({...k,deficitLevel:"light"})),F(null)},children:[r.jsx("strong",{children:"Mild"}),r.jsx("span",{children:"15% below TDEE"})]}),r.jsxs("button",{className:T.deficitLevel==="moderate"?"active":"",onClick:()=>{O(k=>({...k,deficitLevel:"moderate"})),F(null)},children:[r.jsx("strong",{children:"Moderate"}),r.jsx("span",{children:"20% below TDEE"})]}),r.jsxs("button",{className:T.deficitLevel==="harsh"?"active":"",onClick:()=>{O(k=>({...k,deficitLevel:"harsh"})),F(null)},children:[r.jsx("strong",{children:"Aggressive"}),r.jsx("span",{children:"25% below TDEE"})]})]})]}),r.jsx("button",{className:"nut-calc-btn",onClick:qe,disabled:!dt(),children:"Calculate Macros"})]}),$&&r.jsxs("div",{className:"nut-calc-results",children:[r.jsx("h3",{children:"Your Daily Targets"}),r.jsxs("div",{className:"nut-calc-rings",children:[ks("Protein","Protein",$.protein,$.protein,"ring-protein"),ks("Carbs","Carbs",$.carbs,$.carbs,"ring-carbs"),ks("Fats","Fats",$.fats,$.fats,"ring-fats"),ks("Calories","Calories",$.calories,$.calories,"ring-cals")]}),r.jsxs("div",{className:"nut-calc-info",children:[r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"BMR (body at rest)"}),r.jsxs("span",{children:[$.bmr," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"+ Daily activity (NEAT)"}),r.jsxs("span",{children:[$.neat," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"+ Training sessions"}),r.jsxs("span",{children:["+",$.exerciseAdd," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",style:{fontWeight:600},children:[r.jsx("span",{children:"TDEE (total burn)"}),r.jsxs("span",{children:[$.tdee," cal"]})]})]}),r.jsx("button",{className:"nut-save-targets-btn",onClick:Ae,children:"Set as My Daily Targets"})]})]}),ts&&r.jsx("div",{className:`toast-notification ${ts.type}`,children:ts.message})]});const mn=k=>{const N=new Date(k+"T12:00:00"),P=N.getDay(),U=new Date(N);U.setDate(N.getDate()-(P+6)%7);const me=[];for(let Be=0;Be<7;Be++){const Ue=new Date(U);Ue.setDate(U.getDate()+Be),me.push(Ue.toISOString().split("T")[0])}return me},ln=["M","T","W","T","F","S","S"],_n=(k,N="search")=>{M(k),N==="scan"?(pe("scan"),Xt(null)):N==="manual"?(pe("manual"),gt({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""})):N==="favourites"?pe("favourites"):(pe("search"),at([]),ft(""))},kn=mn(B),fn=new Date(B+"T12:00:00"),Fs=`${he[fn.getMonth()]} ${fn.getFullYear()}`;return r.jsx(xa,{children:r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsxs("div",{className:"nut-dark-zone",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsxs("div",{className:"header-actions",children:[r.jsx("button",{onClick:()=>{y("setup"),F(null)},"aria-label":"Recalculate macros",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"3"}),r.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]})]})}),r.jsxs("div",{className:"nut-dark-content",children:[r.jsxs("div",{className:"nut-week-strip anim-fade-up",children:[r.jsxs("div",{className:"nut-week-header",children:[r.jsx("button",{className:"nut-week-arrow",onClick:()=>{const k=new Date(B+"T12:00:00");k.setDate(k.getDate()-7);const N=k.toISOString().split("T")[0];te(N)},"aria-label":"Previous week",children:r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:r.jsx("polyline",{points:"15 18 9 12 15 6"})})}),r.jsx("button",{className:"nut-week-month-label",onClick:()=>{R(!_e),D({year:fn.getFullYear(),month:fn.getMonth()})},children:Fs}),r.jsx("button",{className:"nut-week-arrow",onClick:()=>{const k=new Date(B+"T12:00:00");k.setDate(k.getDate()+7);const N=k.toISOString().split("T")[0];N<=Gi()&&te(N)},"aria-label":"Next week",disabled:kn[6]>=Gi(),children:r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:r.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),r.jsx("div",{className:"nut-week-days",children:kn.map((k,N)=>{const P=new Date(k+"T12:00:00").getDate(),U=k===B,me=k>Gi(),Be=k===Gi();return r.jsxs("button",{className:`nut-week-day${U?" selected":""}${Be?" today":""}${me?" future":""}`,disabled:me,onClick:()=>te(k),children:[r.jsx("span",{className:"nut-week-day-letter",children:ln[N]}),r.jsx("span",{className:"nut-week-day-num",children:P})]},k)})})]}),_e&&r.jsxs("div",{className:"nut-calendar nut-calendar-dark",children:[r.jsxs("div",{className:"nut-cal-header",children:[r.jsx("button",{onClick:()=>D(k=>{let N=k.month-1,P=k.year;return N<0&&(N=11,P--),{year:P,month:N}}),children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("polyline",{points:"15 18 9 12 15 6"})})}),r.jsxs("span",{children:[he[V.month]," ",V.year]}),r.jsx("button",{onClick:()=>D(k=>{let N=k.month+1,P=k.year;return N>11&&(N=0,P++),{year:P,month:N}}),disabled:V.year===new Date().getFullYear()&&V.month>=new Date().getMonth(),children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),r.jsx("div",{className:"nut-cal-days-header",children:Pe.map(k=>r.jsx("span",{children:k},k))}),r.jsxs("div",{className:"nut-cal-grid",children:[[...Array(X(V.year,V.month))].map((k,N)=>r.jsx("span",{},`e${N}`)),[...Array(Ge(V.year,V.month))].map((k,N)=>{const P=N+1,U=`${V.year}-${String(V.month+1).padStart(2,"0")}-${String(P).padStart(2,"0")}`,me=U>Gi(),Be=U===B,Ue=U===Gi();return r.jsx("button",{className:`nut-cal-day${Be?" selected":""}${Ue?" today":""}${me?" future":""}`,disabled:me,onClick:()=>{te(U),R(!1)},children:P},P)})]})]}),r.jsxs("div",{className:"nut-rings-row anim-fade-up-d2",children:[ks("Protein","Protein",be.protein,w.protein,"ring-protein"),ks("Carbs","Carbs",be.carbs,w.carbs,"ring-carbs"),ks("Fats","Fats",be.fats,w.fats,"ring-fats"),ks("Calories","kCal",be.calories,w.calories,"ring-cals")]})]})]}),r.jsx("div",{className:"nut-light-zone anim-fade-up-d4",children:r.jsxs("div",{className:"nut-light-content",children:[Ie&&r.jsxs("button",{className:"nut-water-quick",onClick:()=>A(!0),children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"18",height:"18",children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),r.jsxs("span",{className:"nut-water-quick-count",children:[K.water," / ",w?.waterGoal||8]}),r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",width:"14",height:"14",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})]}),r.jsx("div",{className:"nut-log-section",children:r.jsx("div",{className:"nut-meals-list",children:j2.map(k=>{const N=K.entries.filter(U=>(U.meal||"snacks")===k.key),P=N.reduce((U,me)=>({protein:U.protein+(me.protein||0),carbs:U.carbs+(me.carbs||0),fats:U.fats+(me.fats||0),calories:U.calories+(me.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});return r.jsxs("div",{className:"nut-meal-card",children:[r.jsxs("div",{className:"nut-meal-card-header",children:[r.jsx("span",{className:`nut-meal-card-icon nut-meal-icon-${k.key}`,children:kD[k.key]}),r.jsx("span",{className:"nut-meal-card-title",children:k.label}),N.length>0&&r.jsxs("span",{className:"nut-meal-card-cal",children:[P.calories," cal"]}),Ie&&r.jsx("button",{className:"nut-meal-add-btn",onClick:()=>pt($e===k.key?null:k.key),"aria-label":`Add to ${k.label}`,children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]}),N.length>0&&r.jsxs("div",{className:"nut-meal-bars",children:[r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-p",children:"P"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-protein",style:{width:`${Math.min(100,w.protein>0?P.protein/w.protein*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[P.protein,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-c",children:"C"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-carbs",style:{width:`${Math.min(100,w.carbs>0?P.carbs/w.carbs*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[P.carbs,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-f",children:"F"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-fats",style:{width:`${Math.min(100,w.fats>0?P.fats/w.fats*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[P.fats,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-cal",children:"K"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-cals",style:{width:`${Math.min(100,w.calories>0?P.calories/w.calories*100:0)}%`}})}),r.jsx("span",{className:"nut-meal-bar-val",children:P.calories})]})]}),N.length>0&&r.jsx("div",{className:"nut-log-list",children:N.map(U=>r.jsxs("div",{className:"nut-log-item",children:[r.jsxs("div",{className:"nut-log-item-info",children:[r.jsx("span",{className:"nut-log-item-name",children:U.name}),U.serving&&r.jsx("span",{className:"nut-log-item-serving",children:U.serving})]}),r.jsxs("div",{className:"nut-log-item-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[U.protein,"p"]}),r.jsxs("span",{className:"nut-macro-c",children:[U.carbs,"c"]}),r.jsxs("span",{className:"nut-macro-f",children:[U.fats,"f"]}),r.jsx("span",{className:"nut-macro-cal",children:U.calories})]}),Ie&&r.jsx("button",{className:"nut-log-delete",onClick:()=>Et(U.id),"aria-label":"Remove",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},U.id))}),N.length===0&&r.jsx("div",{className:"nut-meal-empty",children:r.jsx("p",{children:Ie?"Tap + to add food":"No entries"})})]},k.key)})})})]})}),$e&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"nut-add-picker-backdrop",onClick:()=>pt(null)}),r.jsxs("div",{className:"nut-add-picker",children:[r.jsx("div",{className:"nut-add-picker-handle"}),r.jsxs("h3",{className:"nut-add-picker-title",children:["Add to ",j2.find(k=>k.key===$e)?.label]}),r.jsxs("div",{className:"nut-add-picker-options",children:[r.jsxs("button",{onClick:()=>{const k=$e;pt(null),_n(k,"scan")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),r.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),r.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),r.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),r.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),r.jsx("span",{children:"Scan Barcode"})]}),r.jsxs("button",{onClick:()=>{const k=$e;pt(null),_n(k,"search")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("span",{children:"Search Food"})]}),r.jsxs("button",{onClick:()=>{const k=$e;pt(null),_n(k,"manual")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),r.jsx("span",{children:"Manual Entry"})]}),r.jsxs("button",{onClick:()=>{const k=$e;pt(null),_n(k,"favourites")},children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),r.jsx("span",{children:"Favourites"})]})]})]})]}),E&&r.jsx("div",{className:"nut-modal-overlay",onClick:()=>A(!1),children:r.jsxs("div",{className:"nut-water-popup",onClick:k=>k.stopPropagation(),children:[r.jsxs("div",{className:"nut-water-popup-header",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"20",height:"20",style:{color:"#2196f3"},children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),r.jsx("span",{children:"Water Intake"}),r.jsx("button",{className:"nut-modal-close",onClick:()=>A(!1),children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),r.jsxs("div",{className:"nut-water-popup-body",children:[r.jsx("div",{className:"nut-water-glasses",children:[...Array(w?.waterGoal||8)].map((k,N)=>r.jsx("div",{className:`nut-water-glass ${N<K.water?"filled":""}`,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:N<K.water?"currentColor":"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})})},N))}),r.jsxs("div",{className:"nut-water-popup-count",children:[K.water," / ",w?.waterGoal||8," glasses"]}),r.jsxs("div",{className:"nut-water-btns",children:[r.jsx("button",{onClick:ht,disabled:K.water<=0,children:"-"}),r.jsx("button",{onClick:lt,children:"+"})]})]})]})}),W&&r.jsx("div",{className:"nut-modal-overlay",onClick:()=>{Vt(),L(null),pe(null),Xt(null)},children:r.jsxs("div",{className:"nut-modal",onClick:k=>k.stopPropagation(),children:[r.jsxs("div",{className:"nut-modal-header",children:[r.jsx("h3",{children:W==="scan"?"Scan Barcode":W==="search"?"Search Food":W==="favourites"?"Favourites":"Manual Entry"}),r.jsx("button",{className:"nut-modal-close",onClick:()=>{Vt(),L(null),pe(null),Xt(null)},children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),W==="scan"&&!le&&r.jsxs("div",{className:"nut-scan-area",children:[r.jsxs("div",{className:"nut-scanner-wrapper",children:[r.jsx("div",{id:"barcode-reader",className:"nut-scanner-view"}),Ve&&!ee&&r.jsx("div",{className:"nut-scan-line"}),ee&&r.jsxs("div",{className:"nut-scan-detected-overlay",children:[r.jsx("svg",{className:"nut-scan-detected-tick",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20 6L9 17l-5-5"})}),r.jsx("p",{className:"nut-scan-detected-label",children:"Barcode found!"}),r.jsx("p",{className:"nut-scan-detected-code",children:ee})]})]}),!Ve&&r.jsxs("button",{className:"nut-scan-start-btn",onClick:Ut,children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),r.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),r.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),r.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),r.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),"Open Camera"]}),Ve&&!ee&&r.jsx("p",{className:"nut-scan-hint",children:"Align barcode within the frame"}),r.jsx("div",{className:"nut-barcode-divider",children:r.jsx("span",{children:"or enter barcode manually"})}),r.jsxs("div",{className:"nut-barcode-manual",children:[r.jsx("input",{type:"text",inputMode:"numeric",value:se,onChange:k=>De(k.target.value),onKeyDown:k=>k.key==="Enter"&&se.trim()&&Te(se.trim()),placeholder:"Enter barcode number"}),r.jsx("button",{onClick:()=>se.trim()&&Te(se.trim()),disabled:!se.trim()||Le,children:Le?"...":"Look Up"})]})]}),W==="scan"&&le&&(()=>{const k=le.servingUnit||"g",N=le.portion,P=rt==="portion"&&N?bt*N.weight:parseFloat(Kt)||0,U=P/100,me=k==="ml"?[100,200,250,500]:[50,100,150,200],Be=rt==="portion"&&N?`${bt} ${N.label}${bt!==1?"s":""} (${Math.round(P)}${k})`:`${Math.round(P)}${k}`;return r.jsxs("div",{className:"nut-product-result",children:[le.image&&r.jsx("img",{src:le.image,alt:le.name||"Product",className:"nut-product-img",loading:"lazy"}),r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:le.name}),r.jsx("button",{className:`nut-fav-star confirm${de(le.name)?" active":""}`,onClick:()=>tt({name:le.name,protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories,serving:le.servingSize,per100g:{protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories},servingUnit:le.servingUnit||"g",portion:le.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:de(le.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),le.brand&&r.jsx("p",{className:"nut-product-brand",children:le.brand}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",k,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[le.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[le.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[le.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[le.calories," cal"]})]}),N&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:rt==="portion"?"active":"",onClick:()=>{qt("portion"),bt<1&&Xe(1)},children:"Portions"}),r.jsxs("button",{className:rt==="weight"?"active":"",onClick:()=>{qt("weight"),ut(String(Math.round(P)||100))},children:["Custom (",k,")"]})]}),rt==="portion"&&N?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>Xe(Math.max(1,bt-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:bt}),r.jsxs("span",{className:"nut-stepper-label",children:[N.label,bt!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(P),k]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>Xe(bt+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",k,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:Kt,onChange:Ue=>ut(Ue.target.value),onFocus:Ue=>Ue.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:me.map(Ue=>r.jsxs("button",{className:`nut-quick-btn${Kt===String(Ue)?" active":""}`,onClick:()=>ut(String(Ue)),children:[Ue,k]},Ue))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(le.protein*U),"p / ",Math.round(le.carbs*U),"c / ",Math.round(le.fats*U),"f / ",Math.round(le.calories*U)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>{Xt(null),pe("scan")},children:"Scan Again"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>At({name:le.name,protein:Math.round(le.protein*U),carbs:Math.round(le.carbs*U),fats:Math.round(le.fats*U),calories:Math.round(le.calories*U),serving:Be}),children:"Add"})]})]})})(),W==="search"&&!le&&r.jsxs("div",{className:"nut-search-area",children:[r.jsxs("div",{className:"nut-search-bar",children:[r.jsx("input",{type:"text",ref:Ps,value:Fe,onChange:k=>ft(k.target.value),onKeyDown:k=>{k.key==="Enter"&&(clearTimeout(Ot.current),ke())},onFocus:()=>setTimeout(()=>Ps.current?.scrollIntoView({behavior:"smooth",block:"center"}),350),placeholder:"Search food or product...",autoFocus:!0}),r.jsx("button",{onClick:ke,disabled:Gt,children:Gt?"...":"Search"})]}),r.jsxs("div",{className:"nut-search-results",children:[jt.map((k,N)=>r.jsxs("button",{className:"nut-search-item",onClick:()=>{Xt(k),k.portion?(Xe(1),ut(String(k.portion.weight)),qt("portion")):(Xe(0),ut(String(k.servingValue||100)),qt("weight"))},children:[k.image&&r.jsx("img",{src:k.image,alt:k.name||"Product",loading:"lazy"}),r.jsxs("div",{className:"nut-search-item-info",children:[r.jsx("span",{className:"nut-search-item-name",children:k.name}),k.brand&&r.jsx("span",{className:"nut-search-item-brand",children:k.brand}),r.jsxs("span",{className:"nut-search-item-macros",children:[k.calories," cal  ",k.protein,"p  ",k.carbs,"c  ",k.fats,"f per 100",k.servingUnit||"g"]})]})]},N)),jt.length===0&&Fe&&!Gt&&r.jsx("p",{className:"nut-search-empty",children:"No results found. Try a different search or use manual entry."})]})]}),W==="search"&&le&&(()=>{const k=le.servingUnit||"g",N=le.portion,P=rt==="portion"&&N?bt*N.weight:parseFloat(Kt)||0,U=P/100,me=k==="ml"?[100,200,250,500]:[50,100,150,200],Be=rt==="portion"&&N?`${bt} ${N.label}${bt!==1?"s":""} (${Math.round(P)}${k})`:`${Math.round(P)}${k}`;return r.jsxs("div",{className:"nut-product-result",children:[le.image&&r.jsx("img",{src:le.image,alt:le.name||"Product",className:"nut-product-img",loading:"lazy"}),r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:le.name}),r.jsx("button",{className:`nut-fav-star confirm${de(le.name)?" active":""}`,onClick:()=>tt({name:le.name,protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories,serving:le.servingSize,per100g:{protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories},servingUnit:le.servingUnit||"g",portion:le.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:de(le.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),le.brand&&r.jsx("p",{className:"nut-product-brand",children:le.brand}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",k,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[le.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[le.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[le.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[le.calories," cal"]})]}),N&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:rt==="portion"?"active":"",onClick:()=>{qt("portion"),bt<1&&Xe(1)},children:"Portions"}),r.jsxs("button",{className:rt==="weight"?"active":"",onClick:()=>{qt("weight"),ut(String(Math.round(P)||100))},children:["Custom (",k,")"]})]}),rt==="portion"&&N?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>Xe(Math.max(1,bt-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:bt}),r.jsxs("span",{className:"nut-stepper-label",children:[N.label,bt!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(P),k]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>Xe(bt+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",k,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:Kt,onChange:Ue=>ut(Ue.target.value),onFocus:Ue=>Ue.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:me.map(Ue=>r.jsxs("button",{className:`nut-quick-btn${Kt===String(Ue)?" active":""}`,onClick:()=>ut(String(Ue)),children:[Ue,k]},Ue))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(le.protein*U),"p / ",Math.round(le.carbs*U),"c / ",Math.round(le.fats*U),"f / ",Math.round(le.calories*U)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>Xt(null),children:"Back to Search"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>At({name:le.name,protein:Math.round(le.protein*U),carbs:Math.round(le.carbs*U),fats:Math.round(le.fats*U),calories:Math.round(le.calories*U),serving:Be}),children:"Add"})]})]})})(),W==="manual"&&r.jsxs("div",{className:"nut-manual-form",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Food Name"}),r.jsx("input",{type:"text",value:wt.name,onChange:k=>gt(N=>({...N,name:k.target.value})),placeholder:"e.g. Chicken Breast",autoFocus:!0})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Serving Size (optional)"}),r.jsx("input",{type:"text",value:wt.serving,onChange:k=>gt(N=>({...N,serving:k.target.value})),placeholder:"e.g. 150g, 1 cup"})]}),r.jsxs("div",{className:"nut-manual-macros",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Protein (g)"}),r.jsx("input",{type:"number",value:wt.protein,onChange:k=>gt(N=>({...N,protein:k.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Carbs (g)"}),r.jsx("input",{type:"number",value:wt.carbs,onChange:k=>gt(N=>({...N,carbs:k.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Fats (g)"}),r.jsx("input",{type:"number",value:wt.fats,onChange:k=>gt(N=>({...N,fats:k.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Calories"}),r.jsx("input",{type:"number",value:wt.calories,onChange:k=>gt(N=>({...N,calories:k.target.value})),min:"0"})]})]}),r.jsx("button",{className:"nut-btn-primary",disabled:!wt.name.trim(),onClick:()=>At({name:wt.name,protein:parseFloat(wt.protein)||0,carbs:parseFloat(wt.carbs)||0,fats:parseFloat(wt.fats)||0,calories:parseFloat(wt.calories)||0,serving:wt.serving||""}),children:"Add Food"})]}),W==="favourites"&&!le&&(()=>{const k=Q(),N=P=>{if(P.per100g){const U=P.per100g;Xt({name:P.name,brand:"",image:null,servingSize:P.serving||"100g",servingValue:100,servingUnit:P.servingUnit||"g",portion:P.portion||null,protein:U.protein,carbs:U.carbs,fats:U.fats,calories:U.calories,per100g:!0}),P.portion?(Xe(1),ut(String(P.portion.weight)),qt("portion")):(Xe(0),ut("100"),qt("weight"))}else At({name:P.name,protein:P.protein,carbs:P.carbs,fats:P.fats,calories:P.calories,serving:P.serving||""})};return r.jsx("div",{className:"nut-recent-area",children:k.length===0?r.jsx("p",{className:"nut-search-empty",children:"No favourites yet. Tap the star on any food to save it here."}):r.jsx("div",{className:"nut-recent-list",children:k.map((P,U)=>r.jsxs("div",{className:"nut-recent-item-row",children:[r.jsx("button",{className:"nut-fav-star active",onClick:me=>{me.stopPropagation(),tt(P)},children:r.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("button",{className:"nut-recent-item",onClick:()=>N(P),children:[r.jsxs("div",{className:"nut-recent-item-info",children:[r.jsx("span",{className:"nut-recent-item-name",children:P.name}),r.jsx("span",{className:"nut-recent-item-serving",children:P.serving||""})]}),r.jsxs("span",{className:"nut-recent-item-macros",children:[P.calories," cal"]})]})]},U))})})})(),W==="favourites"&&le&&(()=>{const k=le.servingUnit||"g",N=le.portion,P=rt==="portion"&&N?bt*N.weight:parseFloat(Kt)||0,U=P/100,me=k==="ml"?[100,200,250,500]:[50,100,150,200],Be=rt==="portion"&&N?`${bt} ${N.label}${bt!==1?"s":""} (${Math.round(P)}${k})`:`${Math.round(P)}${k}`;return r.jsxs("div",{className:"nut-product-result",children:[r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:le.name}),r.jsx("button",{className:`nut-fav-star confirm${de(le.name)?" active":""}`,onClick:()=>tt({name:le.name,protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories,serving:le.servingSize,per100g:{protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories},servingUnit:le.servingUnit||"g",portion:le.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:de(le.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",k,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[le.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[le.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[le.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[le.calories," cal"]})]}),N&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:rt==="portion"?"active":"",onClick:()=>{qt("portion"),bt<1&&Xe(1)},children:"Portions"}),r.jsxs("button",{className:rt==="weight"?"active":"",onClick:()=>{qt("weight"),ut(String(Math.round(P)||100))},children:["Custom (",k,")"]})]}),rt==="portion"&&N?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>Xe(Math.max(1,bt-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:bt}),r.jsxs("span",{className:"nut-stepper-label",children:[N.label,bt!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(P),k]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>Xe(bt+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",k,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:Kt,onChange:Ue=>ut(Ue.target.value),onFocus:Ue=>Ue.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:me.map(Ue=>r.jsxs("button",{className:`nut-quick-btn${Kt===String(Ue)?" active":""}`,onClick:()=>ut(String(Ue)),children:[Ue,k]},Ue))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(le.protein*U),"p / ",Math.round(le.carbs*U),"c / ",Math.round(le.fats*U),"f / ",Math.round(le.calories*U)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>Xt(null),children:"Back to Favourites"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>At({name:le.name,protein:Math.round(le.protein*U),carbs:Math.round(le.carbs*U),fats:Math.round(le.fats*U),calories:Math.round(le.calories*U),serving:Be}),children:"Add"})]})]})})()]})}),r.jsx(aa,{active:"nutrition"}),ts&&r.jsx("div",{className:`toast-notification ${ts.type}`,children:ts.message})]})})}const ED=700,Ig=42,Dl=2*Math.PI*Ig,T2=["Another one in the bank!","Consistency beats everything.","You showed up  that's what counts.","Stronger every session."];function Mg({title:n,subtitle:e,stats:t,onDone:i,buttonLabel:l="Done"}){const[u,d]=v.useState("hold"),[p,g]=v.useState(!1),[y,w]=v.useState(!1),j=v.useRef(null),T=v.useRef(null),O=v.useRef(null),$=v.useRef(!1),F=v.useRef(!1),B=v.useRef(T2[Math.floor(Math.random()*T2.length)]),te=v.useRef([...Array(80)].map((ve,_e)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#4caf50","#ff9800","#2196f3","#e91e63","#ffeb3b","#FFD700","#ffffff","#9c27b0"][_e%9],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:_e%3}))),K=v.useCallback(()=>{if($.current)return;$.current=!0,F.current=!1,g(!0),O.current=performance.now(),j.current&&(j.current.style.strokeDashoffset=Dl);const ve=_e=>{const R=_e-O.current,E=Math.min(R/ED,1);j.current&&(j.current.style.strokeDashoffset=Dl-E*Dl),E<1?T.current=requestAnimationFrame(ve):($.current=!1,F.current=!0,T.current=null,g(!1),navigator.vibrate&&navigator.vibrate(50),d("celebrate"))};T.current=requestAnimationFrame(ve)},[]),ae=v.useCallback(()=>{$.current&&($.current=!1,T.current&&(cancelAnimationFrame(T.current),T.current=null),j.current&&(j.current.style.strokeDashoffset=Dl),g(!1))},[]),be=v.useCallback(()=>{w(!0),setTimeout(()=>{i?.()},300)},[i]);return u==="hold"?r.jsxs("div",{className:"wc-hold-page",children:[r.jsx("div",{className:"wc-hold-glow","aria-hidden":"true"}),r.jsx("h2",{className:"wc-hold-title",children:"You Crushed It!"}),e&&r.jsx("p",{className:"wc-hold-subtitle",children:e}),t&&t.length>0&&r.jsx("div",{className:"wc-hold-stats",children:t.map((ve,_e)=>r.jsxs("div",{className:"wc-hold-stat",children:[r.jsx("span",{className:"wc-hold-stat-val",children:ve.value}),r.jsx("span",{className:"wc-hold-stat-label",children:ve.label})]},_e))}),r.jsx("p",{className:"wc-hold-hint",children:"Hold to finish"}),r.jsxs("div",{className:`wc-hold-ring-touch ${p?"wc-holding":""}`,onPointerDown:ve=>{ve.preventDefault(),K()},onPointerUp:ae,onPointerLeave:ae,onPointerCancel:ae,onClick:ve=>{ve.stopPropagation(),F.current&&(F.current=!1)},role:"button",tabIndex:0,"aria-label":"Press and hold to finish workout",onKeyDown:ve=>{(ve.key==="Enter"||ve.key===" ")&&(ve.preventDefault(),d("celebrate"))},children:[r.jsx("div",{className:"wc-hold-ring-glow","aria-hidden":"true"}),r.jsxs("svg",{className:"wc-hold-ring-svg",viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"wc-hold-ring-track",cx:"50",cy:"50",r:Ig}),r.jsx("circle",{className:"wc-hold-ring-fill",ref:j,cx:"50",cy:"50",r:Ig,style:{strokeDasharray:Dl,strokeDashoffset:Dl}})]}),r.jsx("div",{className:"wc-hold-icon",children:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M6 9H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h2"}),r.jsx("path",{d:"M18 9h2a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-2"}),r.jsx("path",{d:"M6 3h12v7a6 6 0 0 1-12 0V3z"}),r.jsx("path",{d:"M9 21h6"}),r.jsx("path",{d:"M12 16v5"})]})})]})]}):r.jsxs("div",{className:`wc-celeb-overlay ${y?"wc-celeb-dismissing":""}`,children:[r.jsx("div",{className:"wc-celeb-confetti","aria-hidden":"true",children:te.current.map((ve,_e)=>r.jsx("span",{className:`wc-celeb-confetti-piece wc-confetti-shape-${ve.shape}`,style:{"--x":`${ve.x}%`,"--delay":`${ve.delay}s`,"--color":ve.color,"--drift":`${ve.drift}px`,"--spin":`${ve.spin}deg`,"--duration":`${ve.duration}s`,width:`${ve.width}px`,height:`${ve.height}px`}},_e))}),r.jsxs("div",{className:"wc-celeb-content",children:[r.jsx("div",{className:"wc-celeb-logo-frame",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-celeb-logo-img"})}),r.jsx("h2",{className:"wc-celeb-heading",children:n||"Congratulations!"}),e&&r.jsx("p",{className:"wc-celeb-subtext",children:e}),r.jsx("p",{className:"wc-celeb-quote",children:B.current}),t&&t.length>0&&r.jsx("div",{className:"wc-celeb-stats-row",children:t.map((ve,_e)=>r.jsxs("div",{className:"wc-celeb-stat",children:[r.jsx("span",{className:"wc-celeb-stat-val",children:ve.value}),r.jsx("span",{className:"wc-celeb-stat-label",children:ve.label})]},_e))}),r.jsx("button",{className:"wc-celeb-btn",onClick:be,children:l})]})]})}const E2="/login/assets/randomiser-glq9YJkL.jpg",SD="/login/assets/programme-card-workout-CnNzTYkz.webp",ND="/login/assets/prog-fullbody-4wk-r6m9HJys.jpg",CD="/login/assets/mg-arms-BeOQU3wx.jpg",RD=60,$p=5,AD=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],ID={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Squeeze Press":"push","Incline Dumbbell Press":"push","Dumbbell Fly":"push","Dumbbell Pullover":"push","Tricep Kickback":"push","Dumbbell Shrug":"push","Dumbbell Y-Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Wide Dumbbell Bent Over Row":"pull","Reverse Fly":"pull","Concentration Curl":"pull","Wide Grip Bicep Curl":"pull","Wrist Curl":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core","Kettlebell Bird Dog Drag":"core"},MD={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},DD={fullbody:"linear-gradient(160deg, rgba(153,49,60,0.15) 0%, rgba(153,49,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",upper:"linear-gradient(160deg, rgba(100,60,140,0.2) 0%, rgba(100,60,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",lower:"linear-gradient(160deg, rgba(40,120,80,0.2) 0%, rgba(40,120,80,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)"},Wp={arms:"linear-gradient(160deg, rgba(180,60,60,0.2) 0%, rgba(180,60,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",chest:"linear-gradient(160deg, rgba(50,100,160,0.2) 0%, rgba(50,100,160,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",back:"linear-gradient(160deg, rgba(80,130,60,0.2) 0%, rgba(80,130,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",shoulders:"linear-gradient(160deg, rgba(160,100,40,0.2) 0%, rgba(160,100,40,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",legs:"linear-gradient(160deg, rgba(100,50,140,0.2) 0%, rgba(100,50,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)"},Gp=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,level:"All Levels",daysPerWeek:3,image:ND},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,level:"Intermediate",daysPerWeek:3},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,level:"Advanced",daysPerWeek:3},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,level:"Beginner",daysPerWeek:3},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,level:"Intermediate",daysPerWeek:3},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,level:"Advanced",daysPerWeek:3},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,level:"Intermediate",daysPerWeek:3},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,level:"Intermediate",daysPerWeek:3}],Zc=[{key:"arms",label:"Arms",icon:"M7 5h2v14H7V5zm8 0h2v14h-2V5zm-5 4h4v6h-4V9z",image:CD},{key:"chest",label:"Chest",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15H9v-2h2v2zm4 0h-2v-2h2v2zm3-6c0 1.1-.36 2.12-.97 2.95l-.87-.87C16.7 12.53 17 11.8 17 11c0-2.76-2.24-5-5-5S7 8.24 7 11c0 .8.3 1.53.84 2.08l-.87.87A4.977 4.977 0 0 1 6 11c0-3.31 2.69-6 6-6s6 2.69 6 6z"},{key:"back",label:"Back",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm4 18H8v-6l-4-4 1.41-1.41L8 11.17V8h8v3.17l2.59-2.58L20 10l-4 4v6z"},{key:"shoulders",label:"Shoulders",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"legs",label:"Legs",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"}],S2={chest:[{id:"chest_strength",name:"Chest Strength",desc:"Heavy pressing for max strength",level:"Intermediate",overview:"A heavy pressing session designed to build raw chest strength. Focus on controlled negatives and powerful pressing movements.",tips:["Go heavy  pick a weight where the last 2 reps are a real challenge","Control the negative (lowering phase) for 2-3 seconds","Keep your shoulder blades squeezed together throughout all pressing movements","Rest 90-120 seconds between sets to allow full recovery"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Squeeze Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"chest_hypertrophy",name:"Chest Hypertrophy",desc:"Volume training for muscle growth",level:"Intermediate",overview:"A high-volume chest session focused on time under tension and muscle growth. Lighter weights, more reps, and slow controlled movements.",tips:["Use moderate weight  you should feel the burn by rep 10","Squeeze your chest at the top of every rep for 1 second","Keep rest periods short at 60-90 seconds to keep the pump going","On press ups, go to failure on the final set"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Press Up",type:"reps",sets:3,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"}]},{id:"chest_endurance",name:"Chest Endurance",desc:"Bodyweight pushing to failure",level:"All Levels",overview:"No weights needed. This bodyweight-only session builds chest endurance and muscular stamina through high-rep push up variations.",tips:["Focus on full range of motion  chest to floor on every rep","Keep your core tight and body in a straight line throughout","Scale down to knee press ups if you can't maintain form","Push through the burn  the last 5 reps are where the growth happens"],exercises:[{name:"Press Up",type:"reps",sets:4,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null},{name:"Decline Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Press Up Hold",type:"timed",sets:3,time:30,storagePath:null}]}],back:[{id:"back_strength",name:"Back Strength",desc:"Heavy rows for a thick back",level:"Intermediate",overview:"Build a thick, powerful back with heavy rowing movements. This session targets your lats, rhomboids, and traps for overall back development.",tips:["Go heavy on rows  use a weight that challenges you by rep 6-8","Drive your elbows back and squeeze your shoulder blades together at the top","Keep a slight bend in your knees and hinge at the hips for bent over movements","Rest 90-120 seconds between sets for full recovery"],exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"back_hypertrophy",name:"Back Hypertrophy",desc:"Width and thickness volume work",level:"Intermediate",overview:"A volume-focused back session combining rows and isolation moves to build width and thickness. Focus on the mind-muscle connection.",tips:["Use moderate weight  feel the stretch and squeeze on every rep","On renegade rows, keep your hips square to the floor and avoid rotating","For reverse flys, use lighter weight and focus on squeezing your rear delts","Keep rest to 60-90 seconds to maintain intensity"],exercises:[{name:"Renegade Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Reverse Fly",type:"weighted",sets:3,reps:15,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null}]},{id:"back_endurance",name:"Back Endurance",desc:"Bodyweight back conditioning",level:"All Levels",overview:"A bodyweight session to strengthen your posterior chain and improve posture. Great for back health, mobility, and muscular endurance.",tips:["On superman holds, lift your arms and legs simultaneously and hold tight","Focus on slow, controlled movements  quality over speed","Breathe steadily throughout timed holds  don't hold your breath","Engage your glutes and lower back together on every movement"],exercises:[{name:"Superman Hold",type:"timed",sets:4,time:30,storagePath:"exercises/bodyweight/upper/Superman Hold.mp4"},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:12,storagePath:null},{name:"Reverse Snow Angel",type:"reps",sets:3,reps:12,storagePath:null},{name:"Bird Dog",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Back Extension Hold",type:"timed",sets:3,time:30,storagePath:null}]}],shoulders:[{id:"shoulders_strength",name:"Shoulder Strength",desc:"Heavy pressing for boulder shoulders",level:"Intermediate",overview:"A heavy overhead pressing session to build strong, powerful shoulders. Compound movements first, followed by isolation work for all three delt heads.",tips:["Go heavy on presses  pick a weight where you struggle on the last 2 reps","Brace your core and avoid arching your back during overhead movements","Press straight up and control the weight down slowly","Rest 90-120 seconds between pressing sets, 60 seconds for isolation moves"],exercises:[{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"shoulders_hypertrophy",name:"Shoulder Hypertrophy",desc:"Volume and isolation for 3D delts",level:"Intermediate",overview:"A high-volume session targeting all three heads of the deltoid for that 3D capped shoulder look. Moderate weight, high reps, constant tension.",tips:["Use lighter weight than you think  shoulders respond best to high reps","On lateral raises, lead with your elbows and don't swing the weight","Pause at the top of each raise for a 1-second squeeze","Keep rest periods at 60 seconds to maximise the pump"],exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Y-Raise",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"shoulders_endurance",name:"Shoulder Endurance",desc:"Bodyweight and high-rep work",level:"All Levels",overview:"A shoulder endurance session combining bodyweight movements with high-rep dumbbell work. Builds stamina, stability, and shoulder resilience.",tips:["On pike push ups, walk your feet close to your hands to increase the angle","For high-rep lateral raises, use a very light weight and focus on form","Wall walks are advanced  scale to pike push ups if needed","Keep your core braced throughout to protect your lower back"],exercises:[{name:"Pike Push Ups",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/upper/pike push ups.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,reps:20,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Wall Walks",type:"reps",sets:3,reps:6,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null},{name:"Shoulder Tap Hold",type:"timed",sets:3,time:30,storagePath:null}]}],arms:[{id:"arms_bicep",name:"Bicep Focus",desc:"Curl variations for peak biceps",level:"All Levels",overview:"An arm session dedicated entirely to biceps. Multiple curl variations target different parts of the bicep for maximum peak and thickness.",tips:["Keep your elbows pinned to your sides  no swinging","Control the negative (lowering) for 2-3 seconds on every rep","Start with your heaviest weight and decrease as you fatigue","Squeeze hard at the top of each curl for a full contraction"],exercises:[{name:"Bicep Curl",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Concentration Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Isometric Bicep Hold",type:"timed",sets:3,time:20,storagePath:null}]},{id:"arms_tricep",name:"Tricep Focus",desc:"Extensions and dips for horseshoe triceps",level:"All Levels",overview:"All-out tricep training with extensions, dips, and pressing movements. The triceps make up two-thirds of your arm  this session builds serious size.",tips:["On overhead extensions, keep your elbows close to your head","For skullcrushers, lower the weight slowly to just above your forehead","On dips, lean slightly forward to reduce shoulder strain","Full lockout at the top of every extension for maximum tricep contraction"],exercises:[{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Tricep Dips",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null}]},{id:"arms_full",name:"Full Arms",desc:"Superset biceps and triceps",level:"All Levels",overview:"A balanced arm session alternating between biceps and triceps. Superset style keeps the intensity high and maximises the pump.",tips:["Superset each pair  do biceps then immediately hit triceps","Use moderate weight that lets you maintain strict form for all reps","Rest 60 seconds after each superset pair","Focus on the squeeze at the peak contraction of every rep"],exercises:[{name:"Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Wrist Curl",type:"weighted",sets:3,reps:15,storagePath:null}]}],legs:[{id:"legs_quad",name:"Quad Dominant",desc:"Squats and lunges for quad power",level:"All Levels",overview:"A quad-focused leg session built around squats and lunges. Heavy compound movements to build strong, powerful quads and overall leg strength.",tips:["On goblet squats, hold the dumbbell close to your chest and sit deep","Keep your knees tracking over your toes  don't let them cave inward","Drive through your heels on all squatting movements","Rest 90-120 seconds between heavy sets, 60 seconds on bodyweight moves"],exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/lower/bulgarian split squats.mp4"},{name:"Squat And Hold",type:"timed",sets:3,time:30,storagePath:"exercises/bodyweight/lower/squat and hold.mp4"}]},{id:"legs_ham_glute",name:"Hamstring & Glute",desc:"Posterior chain focus",level:"Intermediate",overview:"Target the back of your legs with deadlift and hip hinge variations. This session builds a strong posterior chain  hamstrings, glutes, and lower back.",tips:["On RDLs, push your hips back and feel the stretch in your hamstrings","Keep a slight bend in your knees throughout hip hinge movements","Squeeze your glutes hard at the top of every rep","For single leg work, start with your weaker side first"],exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/romanian deadlifts.mp4"},{name:"1 Legged RDL",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.mp4"},{name:"Hip Thrusts",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/hip thrusts.mp4"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.mp4"},{name:"Donkey Kicks",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.mp4"}]},{id:"legs_power",name:"Power & Plyo",desc:"Explosive leg training",level:"Intermediate",overview:"An explosive leg session combining plyometrics with weighted movements. Build power, speed, and athletic performance.",tips:["On jump squats, land softly with bent knees to absorb the impact","Explode up on every rep  power comes from speed, not just weight","Keep rest periods at 60-90 seconds to maintain intensity","Focus on landing mechanics  knees out, chest up, soft landing"],exercises:[{name:"Jump Squats",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/lower/jump squats.mp4"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Skater Jumps",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/skater jumps.mp4"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.mp4"}]}],core:[{id:"core_lower_abs",name:"Lower Abs Blast",desc:"40s work / 20s rest  3 rounds",level:"Intermediate",overview:"An interval-based core burner targeting the lower abdominals. 40 seconds of work followed by 20 seconds of rest  keep the intensity high and your lower back pressed into the floor throughout.",tips:["Press your lower back firmly into the floor on every rep","Exhale hard as you contract your abs  don't hold your breath","If your lower back lifts off the ground, reduce the range of motion","Focus on slow, controlled movements rather than speed"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Leg Raises",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Reverse Crunch To Leg Raise",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Flutter Kicks",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Dead Bug Single Leg Drop",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Hollow Hold Flutter Kicks",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"}]},{id:"core_obliques",name:"Obliques & Rotation",desc:"35s work / 25s rest  3 rounds",level:"Intermediate",overview:"Target the obliques and rotational core muscles with this interval session. 35 seconds of work with 25 seconds rest  every exercise involves twisting, rotating, or side-bracing movements.",tips:["Rotate from your ribcage, not just your arms","Keep your hips as still as possible during twisting exercises","Brace your core before each movement  think about squeezing a belt","On side planks, stack your hips and push the floor away"],interval:!0,rounds:3,work:35,rest:25,exercises:[{name:"Russian Twist",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank Rotation",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Cross Body Mountain Climbers",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Hip Dips Plank",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Bicycle Crunch",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank",storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{id:"core_weighted",name:"Weighted Core",desc:"40s work / 20s rest  3 rounds",level:"Advanced",overview:"Add resistance to your core training with dumbbells and kettlebells. 40 seconds of weighted work followed by 20 seconds rest  this session builds serious core strength and stability.",tips:["Start with a moderate weight  form is more important than load","Brace your entire core before picking up the weight each round","Keep movements controlled  no swinging or using momentum","If grip fails before core does, go slightly lighter next time"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Russian Twists Dumbbell",storagePath:"exercises/dumbbells/core/russian twists dumbbell.mp4"},{name:"Kettlebell Russian Twist",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Dumbbell Plank Pull Through",storagePath:null}]}]},N2=[{key:"bodyweight",label:"Bodyweight",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"},{key:"dumbbells",label:"Dumbbells",icon:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"},{key:"kettlebells",label:"Kettlebells",icon:"M12 2C9.24 2 7 4.24 7 7c0 1.1.36 2.12.97 2.95C6.76 11.08 6 12.96 6 15c0 3.87 2.69 7 6 7s6-3.13 6-7c0-2.04-.76-3.92-1.97-5.05.61-.83.97-1.85.97-2.95 0-2.76-2.24-5-5-5zm0 2c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"}],Kp=[{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"},{key:"upper",label:"Upper",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"lower",label:"Lower",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"fullbody",label:"Full Body",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z"},{key:"mix",label:"Mix It Up",icon:"M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm-.83 9.41l-1.42 1.42L17.96 20.54l1.42-1.42-5.71-5.71z"}],Pl=[{key:"beginner",label:"Beginner",work:30,rest:30,desc:"30s work / 30s rest"},{key:"intermediate",label:"Intermediate",work:40,rest:20,desc:"40s work / 20s rest"},{key:"advanced",label:"Advanced",work:40,rest:15,desc:"40s work / 15s rest"}],Yp=[5,10,15,20,30];function PD(n){return n.replace(/\b\w/g,e=>e.toUpperCase())}function LD(n){const e=[...n];for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return e}function OD(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Mr(),{isDark:l,toggleTheme:u,accent:d}=ka(),{isPremium:p,FREE_RANDOMISER_DURATIONS:g,FREE_RANDOMISER_WEEKLY_LIMIT:y}=wm(),w=$n(),[j,T]=v.useState("menu"),[O,$]=v.useState(["bodyweight"]),[F,B]=v.useState("core"),[te,K]=v.useState("intermediate"),[ae,be]=v.useState(p?15:5),[ve,_e]=v.useState([]),[R,E]=v.useState(!1),A=v.useRef(!1),V=v.useRef([]),[D,H]=v.useState([]),[M,$e]=v.useState(2),[pt,W]=v.useState(Pl[1]),[pe,Ve]=v.useState(1),[We,ee]=v.useState(0),[L,se]=v.useState("work"),[De,Le]=v.useState(0),[Qe,Fe]=v.useState(!1),[ft,jt]=v.useState(0),[at,Gt]=v.useState(null),_s=v.useRef(null);v.useRef(null),v.useRef(null);const[wt,gt]=v.useState(null),le=v.useCallback((Y,xe="info")=>{gt({message:Y,type:xe}),setTimeout(()=>gt(null),3e3)},[]),[Xt,Kt]=v.useState(null),[ut,bt]=v.useState(null),[Xe,rt]=v.useState(0),[qt,en]=v.useState(0),[As,ts]=v.useState([]),[Ct,Jt]=v.useState(""),[Ss,Ot]=v.useState(""),[Ps,ue]=v.useState(!1),[Se,Ie]=v.useState(0),[Ge,X]=v.useState(!1),[he,Pe]=v.useState({}),qe=v.useRef(null),Ae=v.useRef(null),[dt,Tt]=v.useState([]),[Q,de]=v.useState(null),[tt,At]=v.useState(0),[Et,ss]=v.useState(0),[Ut,Vt]=v.useState(0),[Ls,Xs]=v.useState(0),[is,Ns]=v.useState(0),[Os,q]=v.useState(0),[we,Te]=v.useState({beginner:0,intermediate:0,advanced:0}),Ee=p?Yp:Yp.filter(Y=>g.includes(Y)),ke=!p&&tt>=y,[lt,ht]=v.useState(null),[st,vt]=v.useState(""),[It,ks]=v.useState(!1);v.useEffect(()=>{!i&&(!n||!e)&&w("/")},[n,e,i,w]),v.useEffect(()=>{if(!n||!t)return;(async()=>{try{const xe=zt(ge,"workoutLogs"),ne=Ds(xe,ds("clientId","==",t.id)),He=(await Ts(ne)).docs.map(as=>as.data()),it=He.filter(as=>as.type!=="programme");Xs(it.length);const _t=it.reduce((as,un)=>as+(un.duration||0),0);Ns(_t);const Rt={beginner:0,intermediate:0,advanced:0};it.forEach(as=>{as.level&&Rt[as.level]!==void 0&&Rt[as.level]++}),Te(Rt);const vs=new Date,cn=vs.getDay(),hs=cn===0?-6:1-cn,Wn=new Date(vs);Wn.setDate(vs.getDate()+hs),Wn.setHours(0,0,0,0);const Gr=Wn.getTime(),pn=He.filter(as=>{const un=as.completedAt;return un?(un.toDate?un.toDate().getTime():new Date(un).getTime())>=Gr:!1});At(pn.filter(as=>as.type!=="programme").length);let ja=0;if(t)try{const as=await Rs(ze(ge,"clientProgrammes",t.id));if(as.exists()){const un=as.data(),sr=un.templateId;ja=pn.filter(tn=>tn.type==="programme"&&tn.programmeId===sr).length,ht(sr);const Gn=Gp.find(tn=>tn.id===sr);Gn&&vt(Gn.name);const _r=MD[sr];if(_r){const tn=Object.keys(un.completedSessions||{}).length,Ln=_r.duration*_r.daysPerWeek;Vt(Ln>0?Math.round(tn/Ln*100):0)}}else ht(null),vt(""),Vt(0)}catch{}ss(ja);const Un=it.map(as=>as.completedAt).filter(Boolean).map(as=>as.toDate?as.toDate().getTime():new Date(as).getTime()).sort((as,un)=>un-as);if(Un.length===0)q(0);else{const as=new Set;Un.forEach(Ln=>{const Nn=new Date(Ln),kr=Nn.getDay(),jr=kr===0?-6:1-kr,Dr=new Date(Nn);Dr.setDate(Nn.getDate()+jr),Dr.setHours(0,0,0,0),as.add(Dr.getTime())});const un=[...as].sort((Ln,Nn)=>Nn-Ln);let sr=0;const Gn=new Date(vs),_r=vs.getDay()===0?-6:1-vs.getDay();Gn.setDate(vs.getDate()+_r),Gn.setHours(0,0,0,0);let tn=Gn.getTime();un.includes(tn)||(tn-=10080*60*1e3);for(let Ln=0;Ln<200&&un.includes(tn);Ln++)sr++,tn-=10080*60*1e3;q(sr)}}catch(xe){console.error("Error loading workout stats:",xe)}finally{ks(!0)}})()},[n,t,j]);const mn=()=>{const Y=[];let xe;F==="mix"?xe=["core","upper","lower"]:F==="fullbody"?xe=["upper","lower"]:xe=[F];for(const ne of O)for(const Ke of xe)Y.push(`exercises/${ne}/${Ke}`);return Y},ln=async()=>{if(A.current){for(;A.current;)await new Promise(Y=>setTimeout(Y,200));return V.current}A.current=!0,E(!0);try{const Y=mn(),xe=[];for(const it of Y)try{const _t=eo(to,it),Rt=await _2(_t);xe.push(...Rt.items)}catch{console.warn(`Folder ${it} not found, skipping.`)}if(xe.length===0&&O.includes("bodyweight")&&F==="core")try{const it=eo(to,"core"),_t=await _2(it);xe.push(..._t.items)}catch{console.warn("Legacy core/ folder not found either.")}if(xe.length===0){const it=O.map(Rt=>N2.find(vs=>vs.key===Rt)?.label).join(" + "),_t=Kp.find(Rt=>Rt.key===F)?.label;return le(`No exercises found for ${it} / ${_t}. Upload videos to Firebase Storage.`,"error"),A.current=!1,E(!1),[]}const ne=new Set,Ke=xe.filter(it=>{const _t=it.name.replace(/\.(mp4|gif)$/i,"");return ne.has(_t)?!1:(ne.add(_t),!0)}),He=await Promise.all(Ke.map(async it=>{const _t=await qo(it),Rt=PD(it.name.replace(/\.(mp4|gif)$/i,"")),vs=/\.gif$/i.test(it.name);return{name:Rt,videoUrl:_t,isGif:vs}}));return V.current=He,_e(He),A.current=!1,E(!1),He}catch(Y){console.error("Error loading exercises:",Y);const xe=Y.code==="storage/unauthorized"?"Storage access denied. Check Firebase Storage rules allow read access.":`Failed to load exercises: ${Y.message||Y.code||"Unknown error"}`;return le(xe,"error"),A.current=!1,E(!1),[]}},_n=async()=>{if(ke)return;T("spinning"),V.current=[];const Y=await ln();if(Y.length===0){T("setup");return}const xe=Pl.find(cn=>cn.key===te);W(xe);const ne=xe.work+xe.rest,Ke=ae*60,He=Math.floor(Ke/ne);let it,_t;He<=6?(it=Math.max(3,Math.floor(He/2)),_t=Math.floor(He/it)):He<=12?(it=Math.min(6,Math.floor(He/2)),_t=Math.floor(He/it)):(it=Math.min(10,Math.floor(He/2)),_t=Math.floor(He/it)),_t=Math.max(2,_t);const Rt=LD(Y),vs=Rt.slice(0,Math.min(it,Rt.length));H(vs),$e(_t),setTimeout(()=>T("preview"),2e3)},kn=()=>{T("countdown"),jt(3)};v.useEffect(()=>{if(j!=="countdown")return;if(ft<=0){T("workout"),Ve(1),ee(0),se("work"),Le(pt.work),Fe(!1),bs();return}Ht();const Y=setTimeout(()=>jt(xe=>xe-1),1e3);return()=>clearTimeout(Y)},[ft,j]),v.useEffect(()=>{if(j!=="workout"||Qe)return;if(De<=0){fn();return}De<=3&&Ht();const Y=setTimeout(()=>Le(xe=>xe-1),1e3);return()=>clearTimeout(Y)},[De,j,Qe]);const fn=()=>{if(L==="work")se("rest"),Le(pt.rest);else{const Y=We+1;if(Y>=D.length){const xe=pe+1;if(xe>M){T("complete"),Fs();return}Ve(xe),ee(0)}else ee(Y);se("work"),Le(pt.work),bs()}},Fs=async()=>{if(n)try{await hi(zt(ge,"workoutLogs"),{clientId:t.id,level:te,duration:ae,equipment:O,focus:F,exerciseCount:D.length,rounds:M,exercises:D.map(Y=>Y.name),completedAt:xt.now()}),At(Y=>Y+1),Xs(Y=>Y+1),Ns(Y=>Y+ae),Te(Y=>({...Y,[te]:(Y[te]||0)+1}))}catch(Y){console.error("Error saving workout log:",Y)}},k=async(Y,xe,ne)=>{if(!(!t||!xe))try{const Ke=t.id,He=await Rs(ze(ge,"coreBuddyPBs",Ke)),_t=(He.exists()?He.data():null)?.exercises||{},Rt=_t[Y];let vs=!1;if(Rt?(xe>(Rt.weight||0)||xe===(Rt.weight||0)&&ne>(Rt.reps||0))&&(vs=!0):vs=!0,vs){const cn={..._t,[Y]:{weight:xe,reps:ne,achievedAt:xt.now()}};await Es(ze(ge,"coreBuddyPBs",Ke),{clientId:t.id,exercises:cn,updatedAt:xt.now()}),le(`New PB! ${xe}kg  ${ne} reps`,"success"),Ht(),await N(Y,xe)}}catch(Ke){console.error("Error checking PB:",Ke)}},N=async(Y,xe)=>{if(t)try{const ne=await Rs(ze(ge,"coreBuddyTargets",t.id));if(!ne.exists())return;const He=(ne.data().targets||{})[Y];if(!He||xe<He.targetWeight)return;const it=await Rs(ze(ge,"coreBuddyAchievements",t.id)),_t=it.exists()?it.data():{clientId:t.id,badges:[],totalVolume:0};if(_t.badges.some(hs=>hs.type==="pb_target"&&hs.exercise===Y&&hs.targetWeight===He.targetWeight))return;const vs={type:"pb_target",exercise:Y,group:ID[Y]||"push",targetWeight:He.targetWeight,achievedAt:xt.now()},cn=[..._t.badges,vs];await Es(ze(ge,"coreBuddyAchievements",t.id),{..._t,badges:cn,updatedAt:xt.now()}),Tt(hs=>[...hs,vs])}catch(ne){console.error("Error checking target badge:",ne)}},P=async Y=>{if(!(!t||Y<=0))try{const xe=await Rs(ze(ge,"coreBuddyAchievements",t.id)),ne=xe.exists()?xe.data():{clientId:t.id,badges:[],totalVolume:0},Ke=ne.totalVolume||0,He=Ke+Y,it=[];AD.forEach(Rt=>{He>=Rt.threshold&&Ke<Rt.threshold&&(ne.badges.some(cn=>cn.type==="volume_milestone"&&cn.milestone===Rt.threshold)||it.push({type:"volume_milestone",milestone:Rt.threshold,label:Rt.label,achievedAt:xt.now()}))});const _t=[...ne.badges,...it];await Es(ze(ge,"coreBuddyAchievements",t.id),{clientId:t.id,badges:_t,totalVolume:Math.round(He),updatedAt:xt.now()}),it.length>0&&Tt(Rt=>[...Rt,...it])}catch(xe){console.error("Error updating volume:",xe)}},U=async Y=>{if(bt(Y),Y.interval){const Ke=[];for(const He of Y.exercises){let it=null,_t=!1;if(He.storagePath)try{const Rt=eo(to,He.storagePath);it=await qo(Rt),_t=/\.gif$/i.test(He.storagePath)}catch{}Ke.push({name:He.name,videoUrl:it,isGif:_t})}H(Ke),$e(Y.rounds),W({work:Y.work,rest:Y.rest}),T("preview");return}const xe={};for(const Ke of Y.exercises)if(Ke.storagePath)try{const He=eo(to,Ke.storagePath);xe[Ke.name]={url:await qo(He),isGif:/\.gif$/i.test(Ke.storagePath)}}catch{}Pe(xe);const ne=Y.exercises.map(Ke=>({name:Ke.name,type:Ke.type,targetSets:Ke.sets,targetReps:Ke.reps||0,targetTime:Ke.time||0,sets:[]}));ts(ne),rt(0),en(0),Jt(""),Ot(""),X(!1),ue(!1),Ie(0),Tt([]),de(null),T("muscle_workout")},me=()=>{const Y=qe.current;Y&&(Y.paused?(Y.play(),X(!0)):(Y.pause(),X(!1)))};v.useEffect(()=>{if(j!=="muscle_workout"||!Ps||Se<=0){j==="muscle_workout"&&Ps&&Se<=0&&(ue(!1),Ht());return}return Ae.current=setTimeout(()=>Ie(Y=>Y-1),1e3),()=>clearTimeout(Ae.current)},[j,Ps,Se]);const Be=async()=>{const Y=As[Xe];let xe={};if(Y.type==="weighted"){const He=parseFloat(Ct)||0,it=parseInt(Ss)||0;if(it===0){le("Enter your reps","error");return}xe={weight:He,reps:it}}else if(Y.type==="reps"){const He=parseInt(Ss)||0;if(He===0){le("Enter your reps","error");return}xe={reps:He}}else if(Y.type==="timed"){const He=Y.targetTime-Se;xe={time:Math.max(He,1)}}const ne=[...As];ne[Xe]={...Y,sets:[...Y.sets,xe]},ts(ne),Y.type==="weighted"&&xe.weight>0&&await k(Y.name,xe.weight,xe.reps);const Ke=Y.sets.length+1;if(Ke<Y.targetSets)en(Ke),Ot(""),ue(!1),Ie(0);else if(Xe+1<As.length){const He=Xe+1;rt(He),en(0),Jt(""),Ot(""),X(!1),ue(!1),Ie(0)}else await Ue(ne),T("muscle_complete")},Ue=async Y=>{if(!(!n||!t))try{const xe=Y.reduce((Ke,He)=>Ke+He.sets.reduce((it,_t)=>it+(_t.weight||0)*(_t.reps||0),0),0),ne=Y.reduce((Ke,He)=>Ke+He.sets.length,0);await hi(zt(ge,"workoutLogs"),{clientId:t.id,type:"muscle_group",muscleGroup:Xt,sessionId:ut?.id,sessionName:ut?.name,exerciseCount:Y.length,totalSets:ne,duration:Math.round(ne*1.5),volume:Math.round(xe),exercises:Y.map(Ke=>({name:Ke.name,type:Ke.type,sets:Ke.sets})),completedAt:xt.now()}),xe>0&&await P(xe),dt.length>0&&de({badges:[...dt]})}catch(xe){console.error("Error saving muscle group workout log:",xe)}},Je=v.useRef(null),Ze=()=>(Je.current||(Je.current=new(window.AudioContext||window.webkitAudioContext)),Je.current),Ht=()=>{try{const Y=Ze(),xe=Y.createOscillator(),ne=Y.createGain();xe.connect(ne),ne.connect(Y.destination),xe.frequency.value=880,ne.gain.value=.3,xe.start(Y.currentTime),xe.stop(Y.currentTime+.15)}catch{}},bs=()=>{try{const Y=Ze(),xe=Y.createOscillator(),ne=Y.createGain();xe.connect(ne),ne.connect(Y.destination),xe.frequency.value=1200,ne.gain.value=.4,xe.start(Y.currentTime),xe.stop(Y.currentTime+.3)}catch{}};v.useEffect(()=>{if(j!=="workout"||L!=="work"||!D[We]?.isGif)return;const xe=setInterval(()=>{const ne=_s.current;if(!ne)return;const Ke=ne.getAttribute("src");ne.removeAttribute("src"),setTimeout(()=>{_s.current&&_s.current.setAttribute("src",Ke)},0)},4e3);return()=>clearInterval(xe)},[j,L,We,pe,D]);const os=(Y,xe,ne)=>{const Ke=Math.round(Y/xe*RD);return r.jsx("svg",{className:"wk-ring-svg",viewBox:"0 0 200 200",children:tD.map((He,it)=>r.jsx("line",{x1:He.x1,y1:He.y1,x2:He.x2,y2:He.y2,className:it<Ke?`wk-tick-filled ${ne}`:"wk-tick-empty",strokeWidth:He.thick?"3":"2"},it))})},ls=()=>{const Y=D.length*M;return((pe-1)*D.length+We+(L==="rest"?.5:0))/Y},Cs=wt&&r.jsx("div",{className:`toast-notification ${wt.type}`,children:wt.message});if(i)return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>w("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsx("div",{className:"wk-loading-inline",children:r.jsx("div",{className:"wk-loading-spinner"})})]});if(j==="menu")return r.jsx(xa,{children:r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>w("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[r.jsxs("div",{className:"wk-menu-heading",children:[r.jsx("h2",{children:"Choose Your Workout"}),r.jsx("p",{children:"No excuses. Just results."})]}),r.jsx("button",{className:"wk-hero-card",onClick:()=>T("setup"),children:r.jsx("img",{src:E2,alt:"Randomise Workout",className:"wk-hero-bg"})}),r.jsxs("div",{className:"wk-section-header",children:[r.jsxs("h2",{children:["Programmes ",!p&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),r.jsxs("span",{className:"wk-section-count",children:[Gp.length," available"]})]}),p?r.jsx("div",{className:"wk-prog-scroll-wrap",children:r.jsx("div",{className:"wk-prog-scroll",children:Gp.map((Y,xe)=>Y.image?r.jsxs("button",{className:"wk-prog-img-card",onClick:()=>w("/client/core-buddy/programmes",{state:{templateId:Y.id}}),style:{animationDelay:`${xe*.06}s`},children:[r.jsx("img",{src:Y.image,alt:Y.name,className:"wk-prog-img"}),xe===0&&r.jsx("div",{className:"wk-swipe-arrow",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},Y.id):r.jsxs("button",{className:"wk-prog-hero-card",onClick:()=>w("/client/core-buddy/programmes",{state:{templateId:Y.id}}),style:{animationDelay:`${xe*.06}s`},children:[r.jsx("img",{src:SD,alt:"Programme",className:"wk-prog-hero-bg",loading:"lazy"}),r.jsx("div",{className:"wk-prog-hero-overlay",style:{background:DD[Y.focus]}}),r.jsxs("div",{className:"wk-prog-hero-content",children:[r.jsxs("div",{className:"wk-prog-hero-top",children:[r.jsxs("span",{className:"wk-prog-hero-badge",children:[Y.duration," WEEKS"]}),r.jsx("span",{className:"wk-prog-hero-level",children:Y.level})]}),r.jsxs("div",{className:"wk-prog-hero-bottom",children:[r.jsx("h3",{children:Y.name.toUpperCase()}),r.jsxs("p",{children:[Y.daysPerWeek,"x per week  ",Y.focus==="fullbody"?"Full Body":Y.focus.charAt(0).toUpperCase()+Y.focus.slice(1)," Focus"]}),r.jsx("span",{className:"wk-prog-hero-go",children:"VIEW PROGRAMME "})]})]}),xe===0&&r.jsx("div",{className:"wk-swipe-arrow",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},Y.id))})}):r.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>w("/upgrade"),children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),r.jsx("span",{children:"Upgrade to unlock programmes"})]}),r.jsxs("div",{className:"wk-section-header",children:[r.jsxs("h2",{children:["Muscle Groups ",!p&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),r.jsxs("span",{className:"wk-section-count",children:[Zc.length," groups"]})]}),p?r.jsx("div",{className:"wk-muscle-grid",children:Zc.map((Y,xe)=>r.jsx("button",{className:`wk-muscle-hero-card${Y.image?" wk-muscle-thumb":""}`,onClick:()=>{Kt(Y.key),T("muscle_sessions")},style:{animationDelay:`${xe*.05}s`},children:Y.image?r.jsx("img",{src:Y.image,alt:Y.label,className:"wk-muscle-thumb-img"}):r.jsxs(r.Fragment,{children:[r.jsx("img",{src:E2,alt:"Muscle group",className:"wk-muscle-hero-bg",loading:"lazy"}),r.jsx("div",{className:"wk-muscle-hero-overlay",style:{background:Wp[Y.key]}}),r.jsxs("div",{className:"wk-muscle-hero-content",children:[r.jsx("div",{className:"wk-muscle-hero-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:Y.icon})})}),r.jsxs("div",{className:"wk-muscle-hero-text",children:[r.jsx("span",{className:"wk-muscle-hero-name",children:Y.label}),r.jsxs("span",{className:"wk-muscle-hero-count",children:[S2[Y.key]?.length||0," sessions"]})]})]})]})},Y.key))}):r.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>w("/upgrade"),children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),r.jsx("span",{children:"Upgrade to unlock muscle group workouts"})]})]}),r.jsx(aa,{active:"workouts"}),Cs]})});if(j==="setup"){const Y=Kp.find(ne=>ne.key===F)?.label||F,xe=Pl.find(ne=>ne.key===te)?.label||te;return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>T("menu"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main wk-setup-main",children:[r.jsx("div",{className:"wk-stats-row",children:[{label:"Total",value:`${Ls}`,pct:Ls>0?Math.min(Math.round(Ls/100*100),100):0,color:"#14b8a6",size:"normal"},{label:"This Week",value:`${tt}/${$p}`,pct:Math.round(Math.min(tt,$p)/$p*100),color:"var(--color-primary)",size:"large"},{label:"Wk Streak",value:`${Os}`,pct:Os>0?Math.min(Math.round(Os/12*100),100):0,color:"#38B6FF",size:"normal"}].map(ne=>{const He=2*Math.PI*38,it=He-ne.pct/100*He;return r.jsxs("div",{className:`wk-stat-item${ne.size==="large"?" wk-stat-large":""}`,children:[r.jsxs("div",{className:"wk-stat-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"wk-stat-track",cx:"50",cy:"50",r:38}),r.jsx("circle",{className:"wk-stat-fill",cx:"50",cy:"50",r:38,style:{stroke:ne.color},strokeDasharray:He,strokeDashoffset:it})]}),r.jsx("span",{className:"wk-stat-value",style:{color:ne.color},children:ne.value})]}),r.jsx("span",{className:"wk-stat-label",children:ne.label})]},ne.label)})}),r.jsxs("div",{className:"wk-setup-flow",children:[r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Focus Area"}),r.jsx("div",{className:"wk-focus-grid",children:Kp.map(ne=>r.jsxs("button",{className:`wk-equip-btn${F===ne.key?" active":""}${ne.key==="mix"?" wk-mix-btn":""}`,onClick:()=>B(ne.key),children:[r.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:ne.icon})}),r.jsx("span",{children:ne.label})]},ne.key))})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Level"}),r.jsx("div",{className:"wk-level-cards",children:Pl.map(ne=>r.jsxs("button",{className:`wk-level-card wk-level-${ne.key}${te===ne.key?" active":""}`,onClick:()=>K(ne.key),children:[r.jsx("span",{className:"wk-level-name",children:ne.label}),r.jsx("span",{className:"wk-level-desc",children:ne.desc})]},ne.key))})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Time"}),r.jsx("div",{className:"wk-time-options",children:Yp.map(ne=>{const Ke=!Ee.includes(ne);return r.jsxs("button",{className:`wk-time-btn${ae===ne?" active":""}${Ke?" locked":""}`,onClick:()=>!Ke&&be(ne),disabled:Ke,children:[r.jsx("span",{className:"wk-time-num",children:ne}),r.jsx("span",{className:"wk-time-unit",children:Ke?r.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}):"min"})]},ne)})})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Equipment"}),r.jsx("div",{className:"wk-equip-options",children:N2.map(ne=>{const Ke=O.includes(ne.key);return r.jsxs("button",{className:`wk-equip-btn${Ke?" active":""}`,onClick:()=>{$(He=>Ke&&He.length===1?He:Ke?He.filter(it=>it!==ne.key):[...He,ne.key])},children:[r.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:ne.icon})}),r.jsx("span",{children:ne.label})]},ne.key)})})]}),r.jsx("div",{className:"wk-setup-summary",children:r.jsxs("span",{children:[Y,"  ",xe,"  ",ae," min"]})})]})]}),r.jsxs("div",{className:"wk-go-sticky",children:[ke&&r.jsx("p",{className:"wk-free-limit-msg",children:"You've used your free workout this week. Upgrade for unlimited access."}),r.jsx("button",{className:"wk-randomise-btn",onClick:_n,disabled:R||ke,children:R?"Loading exercises...":ke?"Limit Reached":"Randomise Workout"})]}),Cs]})}if(j==="spinning")return r.jsxs("div",{className:"wk-page wk-page-center","data-theme":l?"dark":"light","data-accent":d,children:[r.jsxs("div",{className:"wk-spin-container",children:[r.jsxs("div",{className:"wk-spin-ring",children:[r.jsx("svg",{className:"wk-spin-svg",viewBox:"0 0 200 200",children:Fk.map((Y,xe)=>r.jsx("line",{x1:Y.x1,y1:Y.y1,x2:Y.x2,y2:Y.y2,className:"wk-spin-tick",strokeWidth:Y.thick?"3.5":"2",style:{animationDelay:`${xe*.03}s`}},xe))}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-spin-logo",width:"50",height:"50"})]}),r.jsx("p",{className:"wk-spin-text",children:"Generating workout..."})]}),Cs]});if(j==="preview"){const Y=ut?.interval?{work:ut.work,rest:ut.rest}:Pl.find(ne=>ne.key===te),xe=D.length*M*(Y.work+Y.rest);return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>T(ut?.interval?"muscle_sessions":"setup"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[ut?.interval&&r.jsx("h2",{className:"mg-preview-title",children:ut.name}),r.jsxs("div",{className:"wk-preview-stats",children:[r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:D.length}),r.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:M}),r.jsx("span",{className:"wk-stat-label",children:"Rounds"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:Math.ceil(xe/60)}),r.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsxs("span",{className:"wk-stat-val",children:[Y.work,"/",Y.rest]}),r.jsx("span",{className:"wk-stat-label",children:"Work/Rest"})]})]}),r.jsx("div",{className:"wk-preview-list",children:D.map((ne,Ke)=>r.jsxs("div",{className:"wk-preview-item",style:{animationDelay:`${Ke*.06}s`},onClick:()=>Gt(ne),children:[r.jsx("span",{className:"wk-preview-num",children:Ke+1}),r.jsx("div",{className:"wk-preview-thumb",children:ne.isGif?r.jsx("img",{src:ne.videoUrl,alt:ne.name,loading:"lazy"}):r.jsx("video",{src:`${ne.videoUrl}#t=0.1`,muted:!0,playsInline:!0,preload:"auto"})}),r.jsx("span",{className:"wk-preview-name",children:ne.name}),r.jsx("svg",{className:"wk-preview-play",width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]},Ke))}),at&&r.jsx("div",{className:"wk-preview-modal-backdrop",onClick:()=>Gt(null),children:r.jsxs("div",{className:"wk-preview-modal",onClick:ne=>ne.stopPropagation(),children:[r.jsx("button",{className:"wk-preview-modal-close",onClick:()=>Gt(null),"aria-label":"Close preview",children:r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),r.jsx("div",{className:"wk-preview-modal-video",children:at.isGif?r.jsx("img",{src:at.videoUrl,alt:at.name}):r.jsx("video",{src:at.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0})}),r.jsx("h3",{className:"wk-preview-modal-title",children:at.name})]})}),r.jsxs("div",{className:"wk-preview-actions",children:[!ut?.interval&&r.jsxs("button",{className:"wk-btn-secondary",onClick:()=>_n(),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("polyline",{points:"1 4 1 10 7 10"}),r.jsx("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})]}),"Reshuffle"]}),r.jsx("button",{className:"wk-btn-primary",onClick:kn,children:"Start Workout"})]})]})]})}if(j==="countdown")return r.jsx("div",{className:"wk-page wk-page-center wk-page-dark","data-theme":l?"dark":"light","data-accent":d,children:r.jsxs("div",{className:"wk-countdown-big",children:[r.jsx("span",{className:"wk-countdown-num",children:ft}),r.jsx("span",{className:"wk-countdown-label",children:"GET READY"})]})});if(j==="workout"){const Y=D[We],xe=L==="work"?pt.work:pt.rest,ne=L==="rest"?We+1<D.length?D[We+1]:pe<M?D[0]:null:null;return r.jsxs("div",{className:"wk-page wk-page-workout","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("div",{className:"wk-video-container",children:L==="work"?Y.isGif?r.jsx("img",{ref:_s,className:"wk-video",src:Y.videoUrl,alt:Y.name},Y.videoUrl):r.jsx("video",{className:"wk-video",src:Y.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0},Y.videoUrl):r.jsxs("div",{className:"wk-rest-screen",children:[r.jsx("span",{className:"wk-rest-label",children:"REST"}),ne&&r.jsxs("span",{className:"wk-next-label",children:["Next: ",ne.name]})]})}),r.jsx("div",{className:"wk-back-row",children:r.jsxs("button",{className:"wk-back-btn",onClick:()=>{confirm("Leave workout?")&&T("menu")},children:[r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]})}),r.jsx("div",{className:"wk-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"wk-exercise-info",children:[r.jsxs("span",{className:"wk-exercise-counter",children:[We+1," / ",D.length]}),r.jsx("h2",{className:"wk-exercise-name",children:Y.name}),r.jsxs("span",{className:"wk-round-label",children:["Round ",pe," of ",M]})]}),r.jsx("div",{className:"wk-timer-section",children:r.jsxs("div",{className:"wk-timer-ring-wrap",children:[os(De,xe,L==="work"?"wk-tick-work":"wk-tick-rest"),r.jsxs("div",{className:"wk-timer-center",children:[r.jsx("span",{className:"wk-timer-time",children:De}),r.jsx("span",{className:`wk-timer-phase ${L}`,children:L==="work"?"WORK":"REST"})]})]})}),r.jsxs("div",{className:"wk-controls",children:[r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-stop",onClick:()=>{confirm("End workout early?")&&T("menu")},children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})})}),r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-pause",onClick:()=>Fe(!Qe),children:Qe?r.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}):r.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:[r.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),r.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]})}),r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-skip",onClick:()=>{Le(0)},children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:[r.jsx("polygon",{points:"5 4 15 12 5 20 5 4"}),r.jsx("rect",{x:"15",y:"4",width:"4",height:"16"})]})})]}),r.jsx("div",{className:"wk-progress-bar",children:r.jsx("div",{className:"wk-progress-fill",style:{width:`${ls()*100}%`}})})]})}if(j==="complete"){const Y=Pl.find(ne=>ne.key===te),xe=D.length*M*(Y.work+Y.rest);return r.jsx("div",{className:"wk-page wk-page-center","data-theme":l?"dark":"light","data-accent":d,children:r.jsx(Mg,{title:"Workout Complete!",stats:[{value:Math.ceil(xe/60),label:"Minutes"},{value:D.length*M,label:"Intervals"},{value:M,label:"Rounds"}],onDone:()=>{bt(null),Kt(null),T("menu")}})})}if(j==="muscle_sessions"){const Y=Zc.find(ne=>ne.key===Xt),xe=S2[Xt]||[];return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>T("menu"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[r.jsxs("div",{className:"mg-sessions-header",children:[r.jsx("div",{className:"mg-sessions-icon",style:{background:Wp[Xt]},children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:Y?.icon})})}),r.jsxs("h2",{children:[Y?.label," Workouts"]}),r.jsxs("p",{children:[xe.length," sessions available"]})]}),r.jsx("div",{className:"mg-sessions-list",children:xe.map((ne,Ke)=>r.jsxs("button",{className:"mg-session-card",onClick:()=>{bt(ne),T("muscle_overview")},style:{animationDelay:`${Ke*.08}s`},children:[r.jsxs("div",{className:"mg-session-info",children:[r.jsx("h3",{children:ne.name}),r.jsx("p",{children:ne.desc}),r.jsx("div",{className:"mg-session-meta",children:ne.interval?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"mg-session-tag mg-tag-interval",children:"Interval"}),r.jsxs("span",{className:"mg-session-tag",children:[ne.exercises.length," exercises"]}),r.jsxs("span",{className:"mg-session-tag",children:[ne.rounds," rounds"]})]}):r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"mg-session-tag mg-tag-strength",children:"Strength"}),r.jsxs("span",{className:"mg-session-tag",children:[ne.exercises.length," exercises"]}),r.jsx("span",{className:"mg-session-tag",children:(()=>{const He=ne.exercises.map(Rt=>Rt.sets||0),it=Math.min(...He),_t=Math.max(...He);return it===_t?`${it} sets each`:`${it}-${_t} sets each`})()})]})})]}),r.jsx("div",{className:"mg-session-arrow",children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},ne.id))})]}),Cs]})}if(j==="muscle_overview"){const Y=ut;if(!Y)return null;const xe=Zc.find(ne=>ne.key===Xt);return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>T("muscle_sessions"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main mg-overview-main",children:[r.jsx("div",{className:"mg-overview-hero",style:{background:Wp[Xt]},children:r.jsx("div",{className:"mg-overview-hero-content",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"mg-overview-hero-icon",children:r.jsx("path",{d:xe?.icon})})})}),r.jsxs("div",{className:"mg-overview-header",children:[r.jsxs("div",{className:"mg-overview-title-row",children:[r.jsx("h2",{children:Y.name}),Y.level&&r.jsx("span",{className:"mg-overview-level",children:Y.level})]}),r.jsx("p",{className:"mg-overview-desc",children:Y.desc})]}),Y.overview&&r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 16v-4M12 8h.01"})]}),"About This Workout"]}),r.jsx("p",{children:Y.overview})]}),Y.tips&&Y.tips.length>0&&r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Tips & Form"]}),r.jsx("ul",{className:"mg-overview-tips",children:Y.tips.map((ne,Ke)=>r.jsx("li",{children:ne},Ke))})]}),r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"}),r.jsx("rect",{x:"9",y:"3",width:"6",height:"4",rx:"1"}),r.jsx("path",{d:"M9 14l2 2 4-4"})]}),"Exercises (",Y.exercises.length,")"]}),r.jsx("div",{className:"mg-overview-exercises",children:Y.exercises.map((ne,Ke)=>r.jsxs("div",{className:"mg-overview-exercise",children:[r.jsx("span",{className:"mg-overview-ex-num",children:Ke+1}),r.jsxs("div",{className:"mg-overview-ex-info",children:[r.jsx("span",{className:"mg-overview-ex-name",children:ne.name}),Y.interval?r.jsxs("span",{className:"mg-overview-ex-detail",children:[Y.work,"s work / ",Y.rest,"s rest"]}):r.jsxs("span",{className:"mg-overview-ex-detail",children:[ne.sets," sets  ",ne.reps?`${ne.reps} reps`:`${ne.time}s`,ne.type==="weighted"&&"  weighted"]})]})]},Ke))})]}),r.jsxs("button",{className:"mg-overview-start-btn",onClick:()=>U(Y),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Workout"]})]}),Cs]})}if(j==="muscle_workout"){const Y=ut;if(!Y)return null;const xe=Y.exercises[Xe],ne=As[Xe];if(!xe||!ne)return null;const Ke=ne.sets.length,He=Y.exercises.length,it=Y.exercises.reduce((hs,Wn)=>hs+(Wn.sets||0),0),Rt=As.reduce((hs,Wn)=>hs+Wn.sets.length,0)/it*100,vs=he[xe.name];xe.type==="timed"&&Se===0&&!Ps&&Ke===qt&&setTimeout(()=>Ie(xe.time),0);const cn=Ke+1<xe.sets?"Log Set":Xe+1<He?"Log Set  Next Exercise":"Log Set  Complete";return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("div",{className:"mg-session-progress",children:r.jsx("div",{className:"mg-session-progress-fill",style:{width:`${Rt}%`}})}),r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>{confirm("End workout early?")&&T("muscle_overview")},"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsxs("span",{className:"mg-header-info",children:["Exercise ",Xe+1,"/",He]}),r.jsx("div",{style:{width:22}})]})}),r.jsxs("main",{className:"wk-main",children:[vs?r.jsxs("div",{className:"mg-video-container",onClick:me,children:[vs.isGif?r.jsx("img",{className:"mg-video",src:vs.url,alt:xe.name}):r.jsx("video",{ref:qe,className:"mg-video",src:vs.url,loop:!0,muted:!0,playsInline:!0},xe.name),!Ge&&!vs.isGif&&r.jsxs("div",{className:"mg-video-overlay",children:[r.jsx("svg",{className:"mg-play-icon",width:"48",height:"48",viewBox:"0 0 24 24",fill:"rgba(255,255,255,0.9)",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),r.jsx("span",{className:"mg-video-hint",children:"Tap for demo"})]})]}):r.jsxs("div",{className:"mg-video-placeholder",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.4",children:[r.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),r.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),r.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),r.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),r.jsx("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),r.jsx("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),r.jsx("line",{x1:"17",y1:"7",x2:"22",y2:"7"}),r.jsx("line",{x1:"17",y1:"17",x2:"22",y2:"17"})]}),r.jsx("span",{children:"Video coming soon"})]}),r.jsx("div",{className:"wk-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"mg-exercise-card",children:[r.jsx("h2",{className:"mg-ex-name",children:xe.name}),r.jsx("span",{className:`mg-ex-type-badge ${xe.type}`,children:xe.type==="weighted"?"Weight + Reps":xe.type==="reps"?"Reps Only":"Timed"}),r.jsxs("div",{className:"mg-ex-set-info",children:[r.jsxs("span",{className:"mg-ex-set-num",children:["Set ",Ke+1," of ",xe.sets]}),xe.type!=="timed"&&r.jsxs("span",{className:"mg-ex-target",children:["Target: ",xe.reps," reps"]}),xe.type==="timed"&&r.jsxs("span",{className:"mg-ex-target",children:["Target: ",xe.time,"s"]})]}),xe.type==="weighted"&&r.jsxs("div",{className:"mg-input-area",children:[r.jsxs("div",{className:"mg-input-group",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",className:"mg-input",value:Ct,onChange:hs=>Jt(hs.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"mg-input-group",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:Ss,onChange:hs=>Ot(hs.target.value),placeholder:"0"})]})]}),xe.type==="reps"&&r.jsx("div",{className:"mg-input-area",children:r.jsxs("div",{className:"mg-input-group mg-input-single",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:Ss,onChange:hs=>Ot(hs.target.value),placeholder:"0"})]})}),xe.type==="timed"&&r.jsxs("div",{className:"mg-timer-area",children:[r.jsx("div",{className:"mg-timer-display",children:r.jsxs("span",{className:"mg-timer-value",children:[Se,"s"]})}),Ps?r.jsx("button",{className:"mg-timer-btn mg-timer-stop",onClick:()=>ue(!1),children:"Stop"}):r.jsx("button",{className:"mg-timer-btn",onClick:()=>{Se===0&&Ie(xe.time),ue(!0)},children:Se<xe.time&&Se>0?"Resume":"Start Timer"})]}),r.jsx("button",{className:"mg-log-set-btn",onClick:Be,children:cn}),ne.sets.length>0&&r.jsx("div",{className:"mg-completed-sets",children:ne.sets.map((hs,Wn)=>r.jsxs("div",{className:"mg-completed-set",children:[r.jsx("span",{className:"mg-completed-set-check",children:""}),r.jsxs("span",{children:["Set ",Wn+1,": ",hs.weight!=null?`${hs.weight}kg  ${hs.reps}`:hs.reps!=null?`${hs.reps} reps`:`${hs.time}s`]})]},Wn))})]})]}),Cs]})}if(j==="muscle_complete"){const Y=As.reduce((He,it)=>He+it.sets.length,0),xe=As.reduce((He,it)=>He+it.sets.reduce((_t,Rt)=>_t+(Rt.weight||0)*(Rt.reps||0),0),0),ne=Zc.find(He=>He.key===Xt)?.label||"",Ke=[{value:As.length,label:"Exercises"},{value:Y,label:"Sets"}];return xe>0&&Ke.push({value:Math.round(xe).toLocaleString(),label:"Volume (kg)"}),r.jsxs("div",{className:"wk-page wk-page-center","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx(Mg,{title:`${ne} Complete!`,subtitle:ut?.name,stats:Ke,onDone:()=>{bt(null),Kt(null),de(null),T("menu")}}),Q&&r.jsx("div",{className:"mg-badge-celebration",onClick:()=>de(null),children:r.jsxs("div",{className:"mg-badge-celebration-card",children:[r.jsx("div",{className:"mg-badge-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",width:"48",height:"48",fill:"#ffc107",children:r.jsx("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})})}),r.jsx("h3",{className:"mg-badge-celebration-title",children:Q.badges.length===1?"Badge Earned!":`${Q.badges.length} Badges Earned!`}),r.jsx("div",{className:"mg-badge-celebration-list",children:Q.badges.map((He,it)=>r.jsx("div",{className:"mg-badge-celebration-item",children:He.type==="pb_target"?`${He.exercise}  ${He.targetWeight}kg`:He.label},it))}),r.jsx("button",{className:"mg-badge-celebration-dismiss",children:"Tap to dismiss"})]})})]})}return null}const VD=60,BD={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},UD=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],C2=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,daysPerWeek:3,level:"All Levels",description:"Build total body strength with compound dumbbell movements and bodyweight finishers",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push Focus",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Goblet Squats",type:"weighted",sets:3,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull Focus",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:3,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:3,baseReps:10,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Reverse Lunge",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/reverse lunge.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Legs & Core",exercises:[{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Box Step Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/box step ups.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,daysPerWeek:3,level:"Intermediate",description:"Two-phase programme building strength and endurance across your full body",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Power",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"}]},{name:"Day 3",label:"Endurance",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,daysPerWeek:3,level:"Advanced",description:"Complete transformation programme: push, pull, and legs over three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Upper Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Lower Body",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 3",label:"Upper Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,daysPerWeek:3,level:"Beginner",description:"Build a solid core foundation with targeted ab and stability work",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Abs",exercises:[{name:"Crunch",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Stability",exercises:[{name:"Dead Bug",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Bird Dog",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:20,storagePath:"exercises/bodyweight/core/Side Plank.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"}]},{name:"Day 3",label:"Power Core",exercises:[{name:"Single Leg V-Up",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Single Leg V-Up.mp4"},{name:"Toe Reaches",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/toe reaches.GIF"},{name:"Russian Twists Dumbbell",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/core/russian twists dumbbell.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Fast Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Fast Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,daysPerWeek:3,level:"Intermediate",description:"Develop deep core strength and rotational power over two phases",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Anti-Extension",exercises:[{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Dead Bug",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Plank Walkout",type:"reps",sets:3,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"}]},{name:"Day 2",label:"Rotation",exercises:[{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank Rotation",type:"reps",sets:2,baseReps:10,storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"},{name:"Hollow Hold To V-Sit",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Kettlebell Bird Dog Drag",type:"reps",sets:3,baseReps:10,storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,daysPerWeek:3,level:"Advanced",description:"Ultimate core transformation: stability, strength, and power across three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Forearm Plank",type:"timed",sets:4,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Plank Walkout",type:"reps",sets:4,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Leg Raises",type:"reps",sets:4,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Kettlebell Side Bends",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Dead Bug Single Leg Drop",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 2",label:"Endurance",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:4,baseReps:15,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Hollow Hold Flutter Kicks",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"},{name:"Cross Body Mountain Climbers",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Hollow Hold To V-Sit",type:"reps",sets:4,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Hip Dips Plank",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Kneeling Kettlebell Halo",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,daysPerWeek:3,level:"Intermediate",description:"Sculpt and strengthen your chest, back, shoulders, and arms",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Tricep Dips",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Pike Push Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/upper/pike push ups.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Reverse Plank",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/upper/reverse plank.GIF"}]},{name:"Day 3",label:"Mixed",exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Renegade Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Superman Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Superman Hold.mp4"}]}]},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,daysPerWeek:3,level:"Intermediate",description:"Build powerful legs and glutes with squats, deadlifts, and plyometrics",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Quad Dominant",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Squat And Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/lower/squat and hold.GIF"}]},{name:"Day 2",label:"Hamstring & Glute",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"1 Legged RDL",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.GIF"},{name:"Hip Thrusts",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/hip thrusts.GIF"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.GIF"},{name:"Donkey Kicks",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 3",label:"Power & Stability",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Kettlebell Romanian Deadlift",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/kettlebells/lower/kettlebell romanian deadlift.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Skater Jumps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/skater jumps.GIF"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]}];function lh(n,e,t){const i=n.baseReps?n.baseReps+(e-1)*(t.repProg||0):void 0,l=n.baseTime?n.baseTime+(e-1)*(t.timeProg||0):void 0;return{sets:n.sets,reps:i,time:l}}const FD={fullbody:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z",core:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z",upper:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z",lower:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"};function zD(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Mr(),{isDark:l,toggleTheme:u,accent:d}=ka(),p=$n(),g=_a(),[y,w]=v.useState("loading"),[j,T]=v.useState(null),O=v.useRef(!1),[$,F]=v.useState(null),[B,te]=v.useState(1),[K,ae]=v.useState(0),[be,ve]=v.useState(0),[_e,R]=v.useState(0),[E,A]=v.useState([]),[V,D]=v.useState(""),[H,M]=v.useState(""),[$e,pt]=v.useState(!1),[W,pe]=v.useState(0),Ve=v.useRef(null),[We,ee]=v.useState({}),[L,se]=v.useState(!1),De=v.useRef(null),[Le,Qe]=v.useState(null),[Fe,ft]=v.useState([]);v.useEffect(()=>{window.scrollTo(0,0)},[y]);const[jt,at]=v.useState(null),Gt=v.useCallback((ue,Se="info")=>{at({message:ue,type:Se}),setTimeout(()=>at(null),4e3)},[]),_s=v.useRef(null),wt=()=>(_s.current||(_s.current=new(window.AudioContext||window.webkitAudioContext)),_s.current),gt=()=>{try{const ue=wt(),Se=ue.createOscillator(),Ie=ue.createGain();Se.connect(Ie),Ie.connect(ue.destination),Se.frequency.value=1200,Ie.gain.value=.4,Se.start(ue.currentTime),Se.stop(ue.currentTime+.3)}catch{}};v.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),v.useEffect(()=>{if(!t)return;(async()=>{try{const Se=ze(ge,"clientProgrammes",t.id),Ie=await Rs(Se);Ie.exists()&&F(Ie.data());const Ge=g.state?.templateId;if(Ge&&!O.current){const X=C2.find(he=>he.id===Ge);if(X){O.current=!0,T(X),w("overview");return}}Ie.exists()?w("dashboard"):p("/client/core-buddy/workouts",{replace:!0})}catch(Se){console.error("Error loading programme:",Se),p("/client/core-buddy/workouts",{replace:!0})}})()},[t]),v.useEffect(()=>{if(!$e||W<=0){$e&&W<=0&&(pt(!1),gt());return}return Ve.current=setTimeout(()=>pe(ue=>ue-1),1e3),()=>clearTimeout(Ve.current)},[$e,W]);const le=async ue=>{if(t)try{await Es(ze(ge,"clientProgrammes",t.id),ue),F(ue)}catch(Se){console.error("Error saving programme:",Se),Gt("Failed to save. Check Firestore rules for clientProgrammes.","error")}},Xt=async ue=>{const Se={templateId:ue.id,startDate:xt.now(),completedSessions:{}};await le(Se),w("dashboard")},Kt=async()=>{if(t)try{await yr(ze(ge,"clientProgrammes",t.id)),F(null),w("browse")}catch(ue){console.error("Error quitting programme:",ue)}},ut=()=>$?C2.find(ue=>ue.id===$.templateId):null,bt=()=>{if(!$?.startDate)return 1;const ue=$.startDate.toDate?$.startDate.toDate():new Date($.startDate),Ie=new Date-ue,Ge=Math.floor(Ie/(1e3*60*60*24));return Math.floor(Ge/7)+1},Xe=()=>{if(!$)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const ue=$.completedSessions||{},Se=Object.keys(ue).length,Ie=ut();if(!Ie)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const Ge=Ie.duration*Ie.daysPerWeek,X=bt(),he=Math.min(X,Ie.duration);let Pe=0;for(let Ae=0;Ae<Ie.daysPerWeek;Ae++)ue[`w${he}d${Ae}`]&&Pe++;if(Se>=Ge)return{currentWeek:Ie.duration,completedThisWeek:Ie.daysPerWeek,nextDay:-1,totalCompleted:Se,totalSessions:Ge,complete:!0};if(X>Ie.duration)return{currentWeek:Ie.duration,completedThisWeek:Pe,nextDay:-1,totalCompleted:Se,totalSessions:Ge,complete:!0};let qe=-1;for(let Ae=0;Ae<Ie.daysPerWeek;Ae++)if(!ue[`w${he}d${Ae}`]){qe=Ae;break}return{currentWeek:he,completedThisWeek:Pe,nextDay:qe,nextWeek:he,totalCompleted:Se,totalSessions:Ge}},rt=ue=>{const Se=bt();return ue<Se},qt=(ue,Se,Ie)=>{if(!$||ue<=1)return null;const Ge=`w${ue-1}d${Se}`,X=$.completedSessions?.[Ge];if(!X)return null;const he=X.exercises?.find(Pe=>Pe.name===Ie);return he?.sets?.length?he.sets[he.sets.length-1]:null},en=(ue,Se)=>{const Ie=ut();if(!Ie)return;te(ue),ae(Se),ve(0),R(0),A([]),M(""),pt(!1),pe(0),se(!1),ee({});const Ge=Ie.days[Se],X=Ge.exercises.map(Ae=>{const dt=lh(Ae,ue,Ie);return{name:Ae.name,type:Ae.type,pbKey:Ae.pbKey,targetSets:dt.sets,targetReps:dt.reps,targetTime:dt.time,sets:[]}});A(X);const he=Ge.exercises[0],Pe=qt(ue,Se,he.name);Pe?.weight&&he.type==="weighted"?D(String(Pe.weight)):D(""),(async()=>{const Ae={};for(const dt of Ge.exercises)if(dt.storagePath)try{const Tt=eo(to,dt.storagePath),Q=await qo(Tt);Ae[dt.name]={url:Q,isGif:/\.gif$/i.test(dt.storagePath)}}catch(Tt){console.warn(`Video not found for ${dt.name}:`,Tt)}ee(Ae)})(),w("session")},As=async()=>{ut();const ue=E[be];if(!ue)return;let Se={};if(ue.type==="weighted"){const X=parseFloat(V)||0,he=parseInt(H)||0;if(he===0){Gt("Enter your reps","error");return}Se={weight:X,reps:he}}else if(ue.type==="reps"){const X=parseInt(H)||0;if(X===0){Gt("Enter your reps","error");return}Se={reps:X}}else if(ue.type==="timed"){const X=ue.targetTime-W;Se={time:Math.max(X,1)}}const Ie=[...E];Ie[be]={...ue,sets:[...ue.sets,Se]},A(Ie),ue.type==="weighted"&&Se.weight>0&&await Jt(ue.name,Se.weight,Se.reps);const Ge=ue.sets.length+1;if(Ge<ue.targetSets)R(Ge),D(Se.weight?String(Se.weight):""),M(""),pt(!1),pe(0);else if(be+1<E.length){const X=be+1;ve(X),R(0),se(!1);const Pe=ut()?.days[K]?.exercises[X],qe=qt(B,K,Pe?.name);qe?.weight&&Pe?.type==="weighted"?D(String(qe.weight)):D(""),M(""),pt(!1),pe(0)}else await ts(Ie)},ts=async ue=>{if(!$||!t)return;const Se=`w${B}d${K}`,Ie={...$.completedSessions,[Se]:{completedAt:new Date().toISOString(),exercises:ue.map(he=>({name:he.name,type:he.type,sets:he.sets}))}},Ge={...$,completedSessions:Ie};await le(Ge);const X=ue.reduce((he,Pe)=>he+Pe.sets.reduce((qe,Ae)=>qe+(Ae.weight||0)*(Ae.reps||0),0),0);X>0&&await Ct(X);try{const he=ut();await hi(zt(ge,"workoutLogs"),{clientId:t.id,type:"programme",programmeId:he?.id,programmeName:he?.name,week:B,day:K+1,exerciseCount:ue.length,duration:Math.round(ue.reduce((Pe,qe)=>Pe+qe.sets.length*1.5,0)),volume:Math.round(X),completedAt:xt.now()})}catch(he){console.error("Error saving workout log:",he)}Fe.length>0&&(Qe({badges:[...Fe]}),ft([])),w("sessionComplete")},Ct=async ue=>{if(t)try{const Se=await Rs(ze(ge,"coreBuddyAchievements",t.id)),Ie=Se.exists()?Se.data():{clientId:t.id,badges:[],totalVolume:0},Ge=Ie.totalVolume||0,X=Ge+ue,he=[];UD.forEach(qe=>{X>=qe.threshold&&Ge<qe.threshold&&(Ie.badges.some(dt=>dt.type==="volume_milestone"&&dt.milestone===qe.threshold)||he.push({type:"volume_milestone",milestone:qe.threshold,label:qe.label,achievedAt:xt.now()}))});const Pe=[...Ie.badges,...he];await Es(ze(ge,"coreBuddyAchievements",t.id),{clientId:t.id,badges:Pe,totalVolume:Math.round(X),updatedAt:xt.now()}),he.length>0&&ft(qe=>[...qe,...he])}catch(Se){console.error("Error updating volume:",Se)}},Jt=async(ue,Se,Ie)=>{if(t)try{const Ge=t.id,X=await Rs(ze(ge,"coreBuddyPBs",Ge)),Pe=(X.exists()?X.data():null)?.exercises||{},qe=Pe[ue];let Ae=!1;if(qe?(Se>(qe.weight||0)||Se===(qe.weight||0)&&Ie>(qe.reps||0))&&(Ae=!0):Ae=!0,Ae){const dt={...Pe,[ue]:{weight:Se,reps:Ie,achievedAt:xt.now()}};await Es(ze(ge,"coreBuddyPBs",Ge),{clientId:t.id,exercises:dt,updatedAt:xt.now()}),Gt(`New PB! ${Se}kg  ${Ie} reps`,"success"),gt(),await Ss(ue,Se)}}catch(Ge){console.error("Error checking PB:",Ge)}},Ss=async(ue,Se)=>{if(t)try{const Ie=await Rs(ze(ge,"coreBuddyTargets",t.id));if(!Ie.exists())return;const X=(Ie.data().targets||{})[ue];if(!X||Se<X.targetWeight)return;const he=await Rs(ze(ge,"coreBuddyAchievements",t.id)),Pe=he.exists()?he.data():{clientId:t.id,badges:[],totalVolume:0};if(Pe.badges.some(Tt=>Tt.type==="pb_target"&&Tt.exercise===ue&&Tt.targetWeight===X.targetWeight))return;const Ae={type:"pb_target",exercise:ue,group:BD[ue]||"push",targetWeight:X.targetWeight,achievedAt:xt.now()},dt=[...Pe.badges,Ae];await Es(ze(ge,"coreBuddyAchievements",t.id),{...Pe,badges:dt,updatedAt:xt.now()}),ft(Tt=>[...Tt,Ae])}catch(Ie){console.error("Error checking target badge:",Ie)}},Ot=jt&&r.jsxs("div",{className:`toast-notification ${jt.type}`,children:[jt.type==="success"&&r.jsx("span",{children:" "}),jt.message]}),Ps=(ue,Se)=>r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:Se,"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})});if(i||y==="loading")return r.jsx("div",{className:"cb-loading",children:r.jsx("div",{className:"cb-loading-spinner"})});if(y==="browse")return p("/client/core-buddy/workouts",{replace:!0}),null;if(y==="overview"&&j){const ue=j;return r.jsx(xa,{children:r.jsxs("div",{className:"pg-page","data-theme":l?"dark":"light","data-accent":d,children:[Ps(ue.name,()=>p("/client/core-buddy/workouts")),r.jsxs("main",{className:"pg-main",children:[r.jsxs("div",{className:"pg-overview-hero",children:[r.jsx("svg",{className:"pg-overview-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:FD[ue.focus]})}),r.jsx("h2",{className:"pg-overview-name",children:ue.name}),r.jsx("p",{className:"pg-overview-desc",children:ue.description}),r.jsxs("div",{className:"pg-overview-stats",children:[r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:ue.duration}),r.jsx("span",{className:"pg-ov-stat-label",children:"Weeks"})]}),r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:ue.daysPerWeek}),r.jsx("span",{className:"pg-ov-stat-label",children:"Days/Week"})]}),r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:ue.duration*ue.daysPerWeek}),r.jsx("span",{className:"pg-ov-stat-label",children:"Sessions"})]})]})]}),r.jsx("div",{className:"pg-overview-days",children:ue.days.map((Se,Ie)=>r.jsxs("div",{className:"pg-day-card",children:[r.jsxs("div",{className:"pg-day-header",children:[r.jsx("span",{className:"pg-day-name",children:Se.name}),r.jsx("span",{className:"pg-day-label",children:Se.label})]}),r.jsx("div",{className:"pg-day-exercises",children:Se.exercises.map((Ge,X)=>{const he=lh(Ge,1,ue);return r.jsxs("div",{className:"pg-day-ex",children:[r.jsx("span",{className:"pg-day-ex-name",children:Ge.name}),r.jsx("span",{className:"pg-day-ex-target",children:Ge.type==="timed"?`${he.sets}${he.time}s`:`${he.sets}${he.reps}`}),r.jsx("span",{className:`pg-day-ex-badge pg-badge-${Ge.type}`,children:Ge.type==="weighted"?"WT":Ge.type==="timed"?"TMR":"BW"})]},X)})})]},Ie))}),r.jsxs("div",{className:"pg-overview-note",children:[r.jsx("strong",{children:"Progressive Overload:"})," +",ue.repProg," reps/week",ue.timeProg?`, +${ue.timeProg}s/week for timed`:""]}),r.jsx("button",{className:"pg-start-btn",onClick:()=>Xt(ue),children:"Start Programme"})]}),Ot]})})}if(y==="dashboard"){const ue=ut();if(!ue)return w("browse"),null;const Se=Xe(),Ie=$?.completedSessions||{},Ge=Se.totalSessions?Math.round(Se.totalCompleted/Se.totalSessions*100):0;return Math.round(Se.totalCompleted/(Se.totalSessions||1)*VD),r.jsx(xa,{children:r.jsxs("div",{className:"pg-page","data-theme":l?"dark":"light","data-accent":d,children:[Ps("Programme",()=>p("/client/core-buddy/workouts")),r.jsxs("main",{className:"pg-main",children:[r.jsxs("div",{className:"pg-dash-hero",children:[r.jsxs("div",{className:"pg-dash-ring-wrap",children:[r.jsxs("svg",{viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"pg-arc-track",cx:"100",cy:"100",r:"80"}),r.jsx("circle",{className:"pg-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-Ge/100*2*Math.PI*80})]}),r.jsxs("div",{className:"pg-ring-center",children:[r.jsxs("span",{className:"pg-ring-pct",children:[Ge,"%"]}),r.jsx("span",{className:"pg-ring-label",children:"complete"})]})]}),r.jsx("h2",{className:"pg-dash-name",children:ue.name}),r.jsxs("div",{className:"pg-dash-progress-text",children:[r.jsxs("span",{className:"pg-dash-pct",children:[Ge,"%"]}),r.jsxs("span",{className:"pg-dash-week",children:["Week ",Se.currentWeek," of ",ue.duration]})]})]}),r.jsx("div",{className:"pg-weeks",children:Array.from({length:ue.duration},(X,he)=>{const Pe=he+1,qe=rt(Pe);return r.jsxs("div",{className:`pg-week-row${Pe===Se.currentWeek?" pg-week-current":""}`,children:[r.jsxs("span",{className:"pg-week-label",children:["W",Pe]}),r.jsx("div",{className:"pg-week-days",children:ue.days.map((Ae,dt)=>{const Tt=`w${Pe}d${dt}`,Q=!!Ie[Tt],de=!Q&&qe,tt=!Q&&!de&&Pe===Se.currentWeek&&!Se.complete;return r.jsx("button",{className:`pg-day-dot${Q?" done":""}${de?" missed":""}${tt?" next":""}`,disabled:!tt,onClick:()=>{tt&&en(Pe,dt)},children:Q?r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M20 6L9 17l-5-5"})}):de?r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsx("span",{children:Ae.name.replace("Day ","")})},dt)})})]},he)})}),!Se.complete&&(()=>{const X=ue.days.map((he,Pe)=>({day:he,d:Pe})).filter(({d:he})=>!Ie[`w${Se.currentWeek}d${he}`]);return X.length===0?null:r.jsxs("div",{className:"pg-next-session",children:[r.jsx("h3",{children:X.length===ue.daysPerWeek?"Choose a Session":"Remaining Sessions"}),r.jsxs("p",{className:"pg-next-info",children:["Week ",Se.currentWeek,"  ",X.length," session",X.length!==1?"s":""," left this week"]}),X.map(({day:he,d:Pe})=>r.jsxs("div",{className:"pg-available-session",children:[r.jsxs("div",{className:"pg-next-exercises",children:[r.jsxs("span",{className:"pg-avail-day-label",children:[he.name,": ",he.label]}),he.exercises.map((qe,Ae)=>{const dt=lh(qe,Se.currentWeek,ue);return r.jsxs("div",{className:"pg-next-ex",children:[r.jsx("span",{className:"pg-next-ex-name",children:qe.name}),r.jsx("span",{className:"pg-next-ex-target",children:qe.type==="timed"?`${dt.sets}${dt.time}s`:`${dt.sets}${dt.reps}`})]},Ae)})]}),r.jsxs("button",{className:"pg-start-btn",onClick:()=>en(Se.currentWeek,Pe),children:["Start ",he.name]})]},Pe))]})})(),Se.complete&&r.jsxs("div",{className:"pg-complete-msg",children:[r.jsx("h3",{children:"Programme Complete! "}),r.jsxs("p",{children:["You finished all ",Se.totalSessions," sessions."]}),r.jsx("button",{className:"pg-start-btn",onClick:Kt,children:"Choose New Programme"})]}),r.jsx("button",{className:"pg-quit-btn",onClick:()=>{confirm("Quit this programme? Progress will be lost.")&&Kt()},children:"Quit Programme"})]}),r.jsx(aa,{active:"workouts"}),Ot]})})}if(y==="session"){const ue=ut();if(!ue)return null;const Se=ue.days[K],Ie=Se.exercises[be],Ge=lh(Ie,B,ue),X=E[be],he=X?.sets?.length||0,Pe=Se.exercises.length,qe=(be+he/Ge.sets)/Pe,Ae=We[Ie.name],dt=qt(B,K,Ie.name);Ie.type==="timed"&&W===0&&!$e&&he===_e&&setTimeout(()=>pe(Ge.time),0);const Tt=()=>{Ae?.isGif?se(!L):De.current&&(L?De.current.pause():De.current.play(),se(!L))};return r.jsxs("div",{className:"pg-page pg-page-session","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("div",{className:"pg-session-progress",children:r.jsx("div",{className:"pg-session-progress-fill",style:{width:`${qe*100}%`}})}),r.jsxs("div",{className:"pg-session-header",children:[r.jsx("button",{className:"pg-session-back",onClick:()=>{confirm("Leave session? Progress will be lost.")&&w("dashboard")},children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M19 12H5M12 5l-7 7 7 7"})})}),r.jsxs("div",{className:"pg-session-title",children:[r.jsxs("span",{className:"pg-session-counter",children:[be+1," / ",Pe]}),r.jsxs("span",{className:"pg-session-week",children:["Week ",B,"  ",Se.name]})]})]}),Ae&&r.jsxs("div",{className:"pg-video-container",onClick:Tt,children:[Ae.isGif?r.jsx("img",{className:"pg-video",src:Ae.url,alt:Ie.name}):r.jsx("video",{ref:De,className:"pg-video",src:Ae.url,loop:!0,muted:!0,playsInline:!0},Ie.name),!L&&r.jsxs("div",{className:"pg-video-overlay",children:[r.jsx("svg",{className:"pg-play-icon",viewBox:"0 0 24 24",fill:"white",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),r.jsx("span",{className:"pg-video-hint",children:"Tap for demo"})]})]}),r.jsx("div",{className:"pg-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"pg-exercise-card",children:[r.jsx("h2",{className:"pg-ex-name",children:Ie.name}),r.jsx("span",{className:`pg-ex-type-badge pg-badge-${Ie.type}`,children:Ie.type==="weighted"?"Weight + Reps":Ie.type==="timed"?"Timed":"Reps Only"}),Ie.type==="weighted"&&dt&&r.jsxs("div",{className:"pg-last-week",children:[r.jsx("span",{className:"pg-last-week-label",children:"Last week:"}),r.jsxs("span",{className:"pg-last-week-value",children:[dt.weight,"kg x ",dt.reps," reps"]})]}),r.jsxs("div",{className:"pg-ex-set-info",children:[r.jsxs("span",{className:"pg-ex-set-num",children:["Set ",he+1," of ",Ge.sets]}),r.jsxs("span",{className:"pg-ex-target",children:["Target: ",Ie.type==="timed"?`${Ge.time}s hold`:`${Ge.reps} reps`]})]}),Ie.type==="weighted"&&r.jsxs("div",{className:"pg-input-area",children:[r.jsxs("div",{className:"pg-input-group",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",value:V,onChange:Q=>D(Q.target.value),placeholder:"0",className:"pg-input"})]}),r.jsxs("div",{className:"pg-input-group",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",value:H,onChange:Q=>M(Q.target.value),placeholder:String(Ge.reps),className:"pg-input"})]})]}),Ie.type==="reps"&&r.jsx("div",{className:"pg-input-area",children:r.jsxs("div",{className:"pg-input-group pg-input-single",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",value:H,onChange:Q=>M(Q.target.value),placeholder:String(Ge.reps),className:"pg-input"})]})}),Ie.type==="timed"&&r.jsxs("div",{className:"pg-timer-area",children:[r.jsx("div",{className:"pg-timer-display",children:r.jsxs("span",{className:"pg-timer-value",children:[W,"s"]})}),$e?r.jsx("button",{className:"pg-timer-btn pg-timer-stop",onClick:()=>pt(!1),children:"Stop"}):r.jsx("button",{className:"pg-timer-btn",onClick:()=>{W===0&&pe(Ge.time),pt(!0)},children:W<Ge.time&&W>0?"Resume":"Start Timer"})]}),r.jsx("button",{className:"pg-log-set-btn",onClick:As,disabled:Ie.type==="timed"&&$e,children:he+1<Ge.sets?"Log Set":be+1<Pe?"Log Set  Next Exercise":"Log Set  Complete"}),X?.sets?.length>0&&r.jsx("div",{className:"pg-completed-sets",children:X.sets.map((Q,de)=>r.jsxs("div",{className:"pg-completed-set",children:[r.jsx("span",{className:"pg-completed-set-check",children:""}),r.jsxs("span",{children:["Set ",de+1,": ",Q.weight!==void 0?`${Q.weight}kg  ${Q.reps}`:Q.time!==void 0?`${Q.time}s`:`${Q.reps} reps`]})]},de))})]}),Ot]})}if(y==="sessionComplete"){const Se=ut()?.days[K],Ie=E.reduce((he,Pe)=>he+Pe.sets.length,0),Ge=E.reduce((he,Pe)=>he+Pe.sets.reduce((qe,Ae)=>qe+(Ae.weight||0)*(Ae.reps||0),0),0),X=[{value:E.length,label:"Exercises"},{value:Ie,label:"Sets"}];return Ge>0&&X.push({value:Math.round(Ge).toLocaleString(),label:"Volume (kg)"}),r.jsxs("div",{className:"pg-page pg-page-center","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx(Mg,{title:"Session Complete!",subtitle:`Week ${B}  ${Se?.name}: ${Se?.label}`,stats:X,buttonLabel:"Back to Programme",onDone:()=>w("dashboard")}),Le&&r.jsx("div",{className:"pg-badge-celebration",onClick:()=>Qe(null),children:r.jsxs("div",{className:"pg-badge-celebration-card",onClick:he=>he.stopPropagation(),children:[r.jsx("div",{className:"pg-badge-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pg-badge-celebration-title",children:Le.badges.length===1?"Badge Earned!":`${Le.badges.length} Badges Earned!`}),r.jsx("div",{className:"pg-badge-celebration-list",children:Le.badges.map((he,Pe)=>r.jsx("div",{className:"pg-badge-celebration-item",children:he.type==="pb_target"?`${he.exercise}  ${he.targetWeight}kg`:he.label},Pe))}),r.jsx("button",{className:"pg-badge-celebration-dismiss",onClick:()=>Qe(null),children:"Tap to dismiss"})]})}),Ot]})}return null}const qD={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},HD={push:{label:"Push",color:"#c75f6b",icon:"M4 12h3l3-9 4 18 3-9h3"},pull:{label:"Pull",color:"#5f8ac7",icon:"M12 2v10m0 0l-4-4m4 4l4-4M4 20h16"},lower:{label:"Lower",color:"#5fc77a",icon:"M12 2v8m-4 4l4 8 4-8m-8 0h8"},core:{label:"Core",color:"#c7a45f",icon:"M12 2a4 4 0 014 4v1h-2V6a2 2 0 10-4 0v1H8V6a4 4 0 014-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"}},Qp=[{threshold:1e3,label:"1 Tonne",icon:"1T"},{threshold:5e3,label:"5 Tonne",icon:"5T"},{threshold:1e4,label:"10 Tonne",icon:"10T"},{threshold:25e3,label:"25 Tonne",icon:"25T"},{threshold:5e4,label:"50 Tonne",icon:"50T"},{threshold:1e5,label:"100 Tonne",icon:"100T"},{threshold:25e4,label:"250 Tonne",icon:"250T"},{threshold:5e5,label:"500 Tonne",icon:"500T"},{threshold:1e6,label:"1 Million kg",icon:"1M"}];function $D(n){return qD[n]||"push"}function WD(n){return n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}T`:`${Math.round(n)}`}function GD(n){return n>=1e6?"million kg":n>=1e3?"tonnes":"kg"}function KD(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Mr(),{isDark:l,toggleTheme:u,accent:d}=ka(),p=$n(),[g,y]=v.useState(!0),[w,j]=v.useState(null),[T,O]=v.useState({}),[$,F]=v.useState([]),[B,te]=v.useState(null),[K,ae]=v.useState(0),[be,ve]=v.useState({});v.useRef(null),v.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),v.useEffect(()=>{if(!t)return;(async()=>{try{const[pe,Ve,We,ee]=await Promise.all([Rs(ze(ge,"coreBuddyAchievements",t.id)),Rs(ze(ge,"coreBuddyPBs",t.id)),Rs(ze(ge,"achievements",t.id)),Ts(Ds(zt(ge,"workoutLogs"),ds("clientId","==",t.id)))]);pe.exists()&&j(pe.data()),Ve.exists()&&O(Ve.data().exercises||{}),We.exists()&&(F(Object.keys(We.data().badges||{})),ve(We.data().progress||{})),ae(ee.docs.length)}catch(pe){console.error("Error loading achievements:",pe)}y(!1)})()},[t]);const _e=w?.badges||[],R=w?.totalVolume||0,E=_e.filter(W=>W.type==="pb_target"),A=_e.filter(W=>W.type==="volume_milestone"),V={push:[],pull:[],lower:[],core:[]};E.forEach(W=>{const pe=W.group||$D(W.exercise);V[pe]&&V[pe].push(W)});const D=Qp.find(W=>R<W.threshold),H=Qp.filter(W=>R>=W.threshold).pop()?.threshold||0,M=D?(R-H)/(D.threshold-H):1;if(i||g)return r.jsxs("div",{className:"ach-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsx("div",{className:"ach-loading-inline",children:r.jsx("div",{className:"cb-loading-spinner"})})]});const $e=_e.length+$.length,pt=$e>0||R>0||K>0;return r.jsx(xa,{children:r.jsxs("div",{className:"ach-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"ach-main",children:[r.jsx("button",{className:"nut-back-btn",onClick:()=>p("/client/personal-bests?mode=corebuddy"),children:" Back"}),r.jsxs("div",{className:"ach-stats-banner",children:[r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:$e}),r.jsx("span",{className:"ach-stat-label",children:$e===1?"Badge":"Badges"})]}),r.jsx("div",{className:"ach-stat-divider"}),r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:WD(R)}),r.jsxs("span",{className:"ach-stat-label",children:[GD(R)," lifted"]})]}),r.jsx("div",{className:"ach-stat-divider"}),r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:Object.keys(T).length}),r.jsx("span",{className:"ach-stat-label",children:"PBs"})]})]}),!pt&&r.jsxs("div",{className:"ach-empty",children:[r.jsx("div",{className:"ach-empty-icon",children:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[r.jsx("path",{d:"M12 15l-3-3h6l-3 3z"}),r.jsx("path",{d:"M5 7h14l-1.5 9h-11L5 7z"}),r.jsx("path",{d:"M8.5 7V5a3.5 3.5 0 017 0v2"})]})}),r.jsx("h4",{children:"No achievements yet"}),r.jsx("p",{children:"Complete workouts to track volume and set PB targets to start earning badges."})]}),[{key:"workouts",title:"Workout Badges",iconPath:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"},{key:"streaks",title:"Streak Badges",iconPath:"M13.5.67s.74 2.65.74 4.8c0 2.06-1.35 3.73-3.41 3.73-2.07 0-3.63-1.67-3.63-3.73l.03-.36C5.21 7.51 4 10.62 4 14c0 4.42 3.58 8 8 8s8-3.58 8-8C20 8.61 17.41 3.8 13.5.67z"},{key:"pbs",title:"Personal Best Badges",iconPath:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"},{key:"nutrition",title:"Nutrition Badges",iconPath:"M18.06 23h1.66c.84 0 1.53-.65 1.63-1.47L23 5.05h-5V1h-2v4.05h-5l.3 2.34c1.71.47 3.31 1.32 4.27 2.26 1.44 1.42 2.43 2.89 2.43 5.29V23zM1 22v-1h15.03v1c0 .55-.45 1-1.01 1H2.01c-.56 0-1.01-.45-1.01-1zm15.03-7c0-4.87-4.66-5.84-8.03-5.97l.72 5.52L1 15.05v5.95h15.03V15z"},{key:"habits",title:"Habit Badges",iconPath:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"},{key:"leaderboard",title:"Leaderboard Badges",iconPath:"M7.5 21H2V9h5.5v12zm7.25-18h-5.5v18h5.5V3zM22 11h-5.5v10H22V11z"}].map(W=>{const pe=mu.filter(ee=>ee.category===W.key);if(pe.length===0)return null;const Ve=(()=>{switch(W.key){case"workouts":return K;case"streaks":return be.streakWeeks||0;case"pbs":return Object.keys(T).length;case"nutrition":return be.nutritionStreak||0;case"leaderboard":return t?.leaderboardOptIn?1:0;case"habits":return be.habitStreak||0;default:return 0}})(),We=pe.filter(ee=>$.includes(ee.id)).length;return r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:W.iconPath})}),W.title]}),r.jsx("div",{className:"ach-workout-carousel",children:pe.map(ee=>{const L=$.includes(ee.id);return r.jsxs("button",{className:`ach-workout-badge${L?" unlocked":" locked"}`,onClick:()=>te(ee),children:[r.jsx("img",{src:ee.img,alt:ee.name,className:"ach-workout-badge-img"}),!L&&ee.threshold&&r.jsx("div",{className:"ach-workout-badge-progress",children:r.jsx("div",{className:"ach-workout-badge-progress-fill",style:{width:`${Math.min(Ve/ee.threshold*100,100)}%`}})})]},ee.id)})}),r.jsxs("p",{className:"ach-workout-badges-count",children:[We,"/",pe.length," unlocked"]})]},W.key)}),B&&r.jsx("div",{className:"ach-badge-overlay",onClick:()=>te(null),children:r.jsxs("div",{className:"ach-badge-overlay-content",onClick:W=>W.stopPropagation(),children:[r.jsx("img",{src:B.img,alt:B.name,className:`ach-badge-overlay-img${$.includes(B.id)?"":" ach-badge-overlay-img-locked"}`}),r.jsx("p",{className:"ach-badge-overlay-desc",children:B.desc}),$.includes(B.id)?r.jsx("span",{className:"ach-badge-overlay-status unlocked",children:"Unlocked"}):r.jsx("span",{className:"ach-badge-overlay-status locked",children:"Locked"}),r.jsx("button",{className:"ach-badge-overlay-close",onClick:()=>te(null),children:"Tap to close"})]})}),r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})}),"Volume Milestones"]}),r.jsxs("div",{className:"ach-volume-hero",children:[r.jsxs("div",{className:"ach-volume-ring",children:[r.jsx("svg",{className:"ach-volume-ring-svg",viewBox:"0 0 200 200",children:Fk.map((W,pe)=>{const Ve=pe<Math.round(M*60);return r.jsx("line",{x1:W.x1,y1:W.y1,x2:W.x2,y2:W.y2,className:Ve?"ach-tick-filled":"ach-tick-empty",strokeWidth:W.thick?"3":"2"},pe)})}),r.jsxs("div",{className:"ach-volume-center",children:[r.jsx("span",{className:"ach-volume-number",children:Math.round(R).toLocaleString()}),r.jsx("span",{className:"ach-volume-unit",children:"kg lifted"})]})]}),D&&r.jsxs("div",{className:"ach-volume-next",children:["Next: ",r.jsx("strong",{children:D.label})," (",(D.threshold-R).toLocaleString(),"kg to go)"]})]}),r.jsx("div",{className:"ach-milestone-shelf",children:Qp.map((W,pe)=>{const Ve=R>=W.threshold,We=A.find(ee=>ee.milestone===W.threshold);return r.jsxs("div",{className:`ach-milestone ${Ve?"unlocked":"locked"}`,children:[r.jsx("div",{className:"ach-milestone-hex",children:r.jsx("span",{className:"ach-milestone-icon",children:W.icon})}),r.jsx("span",{className:"ach-milestone-label",children:W.label}),We?.achievedAt&&r.jsx("span",{className:"ach-milestone-date",children:(We.achievedAt.toDate?We.achievedAt.toDate():new Date(We.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short"})})]},pe)})})]}),r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"PB Target Badges"]}),E.length===0?r.jsx("div",{className:"ach-pb-empty",children:r.jsxs("p",{children:["Set targets on your personal bests to start earning badges. Go to ",r.jsx("strong",{children:"My Progress"}),' and tap "Set Target" on any PB.']})}):Object.entries(V).map(([W,pe])=>{if(pe.length===0)return null;const Ve=HD[W];return r.jsxs("div",{className:"ach-group",children:[r.jsxs("div",{className:"ach-group-header",style:{borderLeftColor:Ve.color},children:[r.jsx("span",{className:"ach-group-label",style:{color:Ve.color},children:Ve.label}),r.jsx("span",{className:"ach-group-count",children:pe.length})]}),r.jsx("div",{className:"ach-badge-grid",children:pe.map((We,ee)=>r.jsxs("div",{className:"ach-badge-card",style:{animationDelay:`${ee*.06}s`,"--group-color":Ve.color},children:[r.jsx("div",{className:"ach-badge-hex",style:{borderColor:Ve.color,boxShadow:`0 0 12px ${Ve.color}33`},children:r.jsx("svg",{className:"ach-badge-hex-icon",viewBox:"0 0 24 24",fill:"none",stroke:Ve.color,strokeWidth:"2",strokeLinecap:"round",children:r.jsx("path",{d:Ve.icon})})}),r.jsxs("div",{className:"ach-badge-info",children:[r.jsx("span",{className:"ach-badge-exercise",children:We.exercise}),r.jsxs("span",{className:"ach-badge-value",style:{color:Ve.color},children:[We.targetWeight,"kg"]}),We.achievedAt&&r.jsx("span",{className:"ach-badge-date",children:(We.achievedAt.toDate?We.achievedAt.toDate():new Date(We.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})})]})]},ee))})]},W)})]})]}),r.jsx(aa,{active:"home"})]})})}const YD=[{key:"trained",label:"Trained",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4",color:"#A12F3A"},{key:"protein",label:"Hit Protein",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z",color:"#4caf50"},{key:"steps",label:"10k Steps",icon:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20M4 12.5A2.5 2.5 0 0 1 6.5 10H20M4 5.5A2.5 2.5 0 0 1 6.5 3H20",color:"#ff9800"},{key:"sleep",label:"8hrs Sleep",icon:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z",color:"#7c3aed"},{key:"water",label:"2L Water",icon:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z",color:"#2196f3"}],QD="M12 2l2.4 7.2L22 12l-7.6 2.8L12 22l-2.4-7.2L2 12l7.6-2.8z",XD="#e91e63",JD=700,Dg=42,Ll=2*Math.PI*Dg,ch=["Every day counts. See you tomorrow!","Consistency is your superpower.","Perfect day  keep the streak alive!","You showed up for yourself today."];function ZD(n){const e=new Date(n),t=e.getDay(),i=t===0?-6:1-t;return e.setDate(e.getDate()+i),e.setHours(0,0,0,0),e}function Xp(n){return n.toISOString().split("T")[0]}function eP(n){return Array.from({length:7},(e,t)=>{const i=new Date(n);return i.setDate(n.getDate()+t),i})}function tP(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Mr(),{isDark:l,toggleTheme:u,accent:d}=ka(),p=$n(),[g,y]=v.useState({}),[w,j]=v.useState([]),[T,O]=v.useState(!0),[$,F]=v.useState(!1),[B,te]=v.useState(0),[K,ae]=v.useState(null),[be,ve]=v.useState(null),[_e,R]=v.useState(!1),[E,A]=v.useState(!1),[V,D]=v.useState(!1),[H,M]=v.useState(!1),[$e,pt]=v.useState(""),[W,pe]=v.useState(null),[Ve,We]=v.useState([]),[ee,L]=v.useState(null),se=v.useRef(null),De=v.useRef(null),Le=v.useRef(null),Qe=v.useRef(null),Fe=v.useRef(!1),ft=v.useRef({}),jt=v.useRef([]),at=v.useRef([]),Gt=v.useRef(null),_s=v.useRef(ch[Math.floor(Math.random()*ch.length)]),wt=v.useCallback((X,he="info")=>{ae({message:X,type:he}),setTimeout(()=>ae(null),3e3)},[]),gt=new Date,le=Xp(gt),Xt=ZD(gt),Kt=eP(Xt),ut=["M","T","W","T","F","S","S"],bt=[...YD.filter(X=>!Ve.includes(X.key)),...w.map(X=>({key:`custom_${X.id}`,label:X.label,icon:QD,color:XD,isCustom:!0,id:X.id}))];v.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),v.useEffect(()=>{if(!n||!t)return;(async()=>{try{const he=zt(ge,"habitLogs"),Pe=Ds(he,ds("clientId","==",t.id)),qe=await Ts(Pe),Ae={};qe.docs.forEach(de=>{const tt=de.data();Ae[tt.date]={...tt,_id:de.id}}),y(Ae);const dt=await Rs(ze(ge,"customHabits",t.id));if(dt.exists()){const de=dt.data();j(de.habits||[]),We(de.hiddenDefaults||[])}let Tt=0;const Q=new Date(gt);for(;;){const de=Xp(Q),tt=Ae[de];if(tt)if(Object.values(tt.habits||{}).filter(Boolean).length>=3)Tt++,Q.setDate(Q.getDate()-1);else break;else if(de===le)Q.setDate(Q.getDate()-1);else break}te(Tt)}catch(he){console.error("Error loading habit logs:",he)}finally{O(!1)}})()},[n,t]);const Xe=g[le]||{habits:{}};v.useEffect(()=>{Object.values(Xe.habits||{}).filter(Boolean).length<bt.length&&V&&D(!1)},[bt.length,Xe.habits]);const rt=async X=>{if(!(!n||$||Xe.habits?.[X])){jt.current=[...Array(10)].map((Pe,qe)=>{const Ae=qe/10*2*Math.PI,dt=18+Math.random()*20;return{tx:Math.cos(Ae)*dt,ty:Math.sin(Ae)*dt,size:3+Math.random()*4,duration:.4+Math.random()*.3}}),ve(X),setTimeout(()=>ve(null),700),navigator.vibrate&&navigator.vibrate(50),F(!0);try{const qe={...Xe.habits||{},[X]:!0},Ae=Xe._id||`${t.id}_${le}`;y(Tt=>({...Tt,[le]:{clientId:t.id,date:le,habits:qe,_id:Ae}})),await Es(ze(ge,"habitLogs",Ae),{clientId:t.id,date:le,habits:qe}),Object.values(qe).filter(Boolean).length===bt.length&&!V&&(_s.current=ch[Math.floor(Math.random()*ch.length)],at.current=[...Array(80)].map((Tt,Q)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#4caf50","#ff9800","#2196f3","#e91e63","#ffeb3b","#FFD700","#ffffff","#9c27b0"][Q%9],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:Q%3})),setTimeout(()=>{R(!0),D(!0),setTimeout(()=>Gt.current?.focus(),1100)},400))}catch(Pe){console.error("Error saving habit:",Pe),wt("Failed to save. Try again.","error"),y(qe=>({...qe,[le]:{...qe[le],habits:{...qe[le]?.habits||{},[X]:!1}}}))}finally{F(!1)}}},qt=async X=>{if(!(!n||$)){F(!0);try{const Pe={...Xe.habits||{},[X]:!1},qe=Xe._id||`${t.id}_${le}`;await Es(ze(ge,"habitLogs",qe),{clientId:t.id,date:le,habits:Pe}),y(Ae=>({...Ae,[le]:{clientId:t.id,date:le,habits:Pe,_id:qe}}))}catch(he){console.error("Error undoing habit:",he),wt("Failed to undo. Try again.","error")}finally{F(!1)}}},en=X=>{if(Xe.habits?.[X]||!1||$||Qe.current)return;Qe.current=X,L(X),De.current=performance.now();const Pe=ft.current[X];Pe&&(Pe.style.strokeDashoffset=Ll);const qe=Ae=>{const dt=Ae-De.current,Tt=Math.min(dt/JD,1),Q=ft.current[X];Q&&(Q.style.strokeDashoffset=Ll-Tt*Ll),Tt<1?Le.current=requestAnimationFrame(qe):(Qe.current=null,Fe.current=!0,Le.current=null,L(null),rt(X))};Le.current=requestAnimationFrame(qe)},As=()=>{if(!Qe.current)return;const X=Qe.current;Qe.current=null,Le.current&&(cancelAnimationFrame(Le.current),Le.current=null),se.current&&(clearTimeout(se.current),se.current=null),ft.current[X]&&(ft.current[X].style.strokeDashoffset=Ll),L(null),De.current=null};v.useEffect(()=>()=>{Le.current&&cancelAnimationFrame(Le.current),se.current&&clearTimeout(se.current)},[]);const ts=()=>{A(!0),setTimeout(()=>{R(!1),A(!1)},300)},Ct=async()=>{const X=$e.trim();if(!X)return;if(!t?.id){wt("Still loading, try again","error");return}const he=Date.now().toString(36),Pe=[...w,{id:he,label:X}];try{await Es(ze(ge,"customHabits",t.id),{clientId:t.id,habits:Pe,hiddenDefaults:Ve},{merge:!0}),j(Pe),pt(""),M(!1),wt(`Added "${X}"`,"success")}catch(qe){console.error("Error adding custom habit:",qe),wt(qe?.code==="permission-denied"?"Permission denied  check Firestore rules for customHabits":`Failed to add habit: ${qe?.message||"Unknown error"}`,"error")}},Jt=async X=>{if(!t?.id)return;const he=w.filter(Pe=>Pe.id!==X);try{await Es(ze(ge,"customHabits",t.id),{clientId:t.id,habits:he,hiddenDefaults:Ve},{merge:!0}),j(he),pe(null),wt("Habit removed","success")}catch(Pe){console.error("Error deleting habit:",Pe),wt("Failed to remove","error")}},Ss=async X=>{if(!t?.id)return;const he=[...Ve,X];try{await Es(ze(ge,"customHabits",t.id),{clientId:t.id,habits:w,hiddenDefaults:he},{merge:!0}),We(he),pe(null),wt("Habit removed","success")}catch(Pe){console.error("Error hiding default habit:",Pe),wt("Failed to remove","error")}},Ot=Kt.map(X=>{const he=Xp(X),Pe=g[he],qe=Pe?Object.values(Pe.habits||{}).filter(Boolean).length:0;return{date:X,dateStr:he,completed:qe,total:bt.length}}),Ps=Ot.reduce((X,he)=>X+he.completed,0),ue=Ot.reduce((X,he)=>X+he.total,0),Se=ue>0?Math.round(Ps/ue*100):0,Ie=Object.values(Xe.habits||{}).filter(Boolean).length,Ge=bt.length>0?Math.round(Ie/bt.length*100):0;return r.jsx(xa,{children:r.jsxs("div",{className:"cbc-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),i||T?r.jsx("div",{className:"cbc-loading-inline",children:r.jsx("div",{className:"cbc-loading-spinner"})}):r.jsxs("main",{className:"cbc-main",children:[r.jsxs("div",{className:"cbc-ring-section anim-fade-up",children:[r.jsxs("div",{className:"cbc-progress-ring",children:[r.jsxs("svg",{viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"cbc-arc-track",cx:"100",cy:"100",r:"80"}),r.jsx("circle",{className:"cbc-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-Ge/100*2*Math.PI*80})]}),r.jsxs("div",{className:"cbc-ring-center",children:[r.jsxs("span",{className:"cbc-ring-pct",children:[Ge,"%"]}),r.jsx("span",{className:"cbc-ring-label",children:"today"})]})]}),r.jsxs("div",{className:"cbc-streak",children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-primary)",strokeWidth:"2",children:r.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),r.jsx("span",{className:"cbc-streak-count",children:B}),r.jsx("span",{className:"cbc-streak-label",children:"day streak"})]})]}),r.jsxs("div",{className:"cbc-section anim-fade-up-d2",children:[r.jsx("h2",{className:"cbc-section-title",children:"Today's Habits"}),r.jsxs("div",{className:"cbc-habits-grid",children:[bt.map(X=>{const he=Xe.habits?.[X.key]||!1,Pe=be===X.key,qe=ee===X.key;return r.jsxs("div",{className:`cbc-habit-tile ${he?"cbc-habit-done":""} ${Pe?"cbc-habit-just-checked":""}`,style:{"--habit-color":X.color},children:[r.jsx("button",{className:"cbc-habit-delete",onClick:Ae=>{Ae.stopPropagation(),pe(X.isCustom?{type:"custom",id:X.id,label:X.label}:{type:"default",key:X.key,label:X.label})},"aria-label":`Remove ${X.label}`,children:r.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),r.jsxs("div",{className:`cbc-habit-ring-touch ${qe?"cbc-holding":""} ${he?"cbc-ring-completed":""}`,onPointerDown:Ae=>{he||(Ae.preventDefault(),en(X.key))},onPointerUp:As,onPointerLeave:As,onPointerCancel:As,onClick:Ae=>{if(Ae.stopPropagation(),Fe.current){Fe.current=!1;return}he&&qt(X.key)},role:"button",tabIndex:0,"aria-label":he?`Undo ${X.label}`:`Press and hold to complete ${X.label}`,onKeyDown:Ae=>{(Ae.key==="Enter"||Ae.key===" ")&&(Ae.preventDefault(),he?qt(X.key):rt(X.key))},children:[r.jsxs("svg",{className:"cbc-habit-ring-svg",viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cbc-habit-ring-track",cx:"50",cy:"50",r:Dg}),r.jsx("circle",{className:"cbc-habit-ring-fill",ref:Ae=>{Ae&&(ft.current[X.key]=Ae)},cx:"50",cy:"50",r:Dg,style:{stroke:X.color,strokeDasharray:Ll,strokeDashoffset:he?0:Ll}})]}),he&&r.jsx("div",{className:"cbc-habit-glow-orb",style:{"--habit-color":X.color}}),r.jsx("div",{className:"cbc-habit-ring-icon",style:{color:X.color},children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:X.icon})})}),Pe&&r.jsx("div",{className:"cbc-particles",children:jt.current.map((Ae,dt)=>r.jsx("span",{className:"cbc-particle",style:{"--tx":`${Ae.tx}px`,"--ty":`${Ae.ty}px`,"--size":`${Ae.size}px`,"--particle-color":X.color,animationDuration:`${Ae.duration}s`}},dt))})]}),r.jsx("span",{className:"cbc-habit-label",children:X.label}),he?r.jsx("span",{className:"cbc-habit-done-tag",children:"Done"}):r.jsx("span",{className:"cbc-habit-hold-hint",children:"Hold to complete"})]},X.key)}),r.jsxs("div",{className:"cbc-habit-tile cbc-add-tile",onClick:()=>M(!0),role:"button",tabIndex:0,children:[r.jsx("div",{className:"cbc-add-ring",children:r.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})}),r.jsx("span",{className:"cbc-habit-label",children:"Add Habit"}),r.jsx("span",{className:"cbc-habit-hold-hint",children:"Your own"})]})]})]}),r.jsxs("div",{className:"cbc-section anim-fade-up-d4",children:[r.jsx("h2",{className:"cbc-section-title",children:"This Week"}),r.jsx("div",{className:"cbc-week-grid",children:Ot.map((X,he)=>{const Pe=X.dateStr===le,qe=X.total>0?X.completed/X.total:0,Ae=38,dt=2*Math.PI*Ae,Tt=dt-qe*dt;return r.jsxs("div",{className:`cbc-day-ring ${Pe?"cbc-day-today":""} ${X.completed>0?"cbc-day-active":""}`,children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cbc-day-track",cx:"50",cy:"50",r:Ae}),r.jsx("circle",{className:"cbc-day-fill",cx:"50",cy:"50",r:Ae,strokeDasharray:dt,strokeDashoffset:Tt})]}),r.jsx("span",{className:"cbc-day-label",children:ut[he]}),r.jsxs("span",{className:"cbc-day-count",children:[X.completed,"/",X.total]})]},he)})}),r.jsxs("div",{className:"cbc-week-summary",children:[r.jsx("div",{className:"cbc-week-summary-bar",children:r.jsx("div",{className:"cbc-week-summary-fill",style:{width:`${Se}%`}})}),r.jsxs("span",{className:"cbc-week-summary-text",children:[Ps," / ",ue," habits this week (",Se,"%)"]})]})]})]}),r.jsx(aa,{active:"home"}),H&&r.jsx("div",{className:"cbc-modal-overlay",onClick:()=>M(!1),children:r.jsxs("div",{className:"cbc-modal",onClick:X=>X.stopPropagation(),children:[r.jsx("h3",{className:"cbc-modal-title",children:"Add Habit"}),r.jsx("p",{className:"cbc-modal-desc",children:"Track something personal to your routine."}),r.jsx("input",{className:"cbc-modal-input",type:"text",placeholder:"e.g. Meditate, Stretch, Read...",value:$e,onChange:X=>pt(X.target.value),maxLength:30,autoFocus:!0,onKeyDown:X=>X.key==="Enter"&&Ct()}),r.jsxs("div",{className:"cbc-modal-actions",children:[r.jsx("button",{className:"cbc-modal-cancel",onClick:()=>{M(!1),pt("")},children:"Cancel"}),r.jsx("button",{className:"cbc-modal-save",onClick:Ct,disabled:!$e.trim(),children:"Add"})]})]})}),W&&r.jsx("div",{className:"cbc-modal-overlay",onClick:()=>pe(null),children:r.jsxs("div",{className:"cbc-modal",onClick:X=>X.stopPropagation(),children:[r.jsxs("h3",{className:"cbc-modal-title",children:['Remove "',W.label,'"?']}),r.jsx("p",{className:"cbc-modal-desc",children:"This will remove the habit from your daily tracker. Past logs won't be affected."}),r.jsxs("div",{className:"cbc-modal-actions",children:[r.jsx("button",{className:"cbc-modal-cancel",onClick:()=>pe(null),children:"Keep"}),r.jsx("button",{className:"cbc-modal-delete",onClick:()=>W.type==="custom"?Jt(W.id):Ss(W.key),children:"Remove"})]})]})}),_e&&r.jsxs("div",{className:`cbc-celeb-overlay ${E?"cbc-celeb-dismissing":""}`,onClick:ts,role:"dialog","aria-modal":"true","aria-label":"All habits complete celebration",children:[r.jsx("div",{className:"cbc-celeb-confetti","aria-hidden":"true",children:at.current.map((X,he)=>r.jsx("span",{className:`cbc-celeb-confetti-piece cbc-confetti-shape-${X.shape}`,style:{"--x":`${X.x}%`,"--delay":`${X.delay}s`,"--color":X.color,"--drift":`${X.drift}px`,"--spin":`${X.spin}deg`,"--duration":`${X.duration}s`,width:`${X.width}px`,height:`${X.height}px`}},he))}),r.jsxs("div",{className:"cbc-celeb-content",onClick:X=>X.stopPropagation(),children:[r.jsx("div",{className:"cbc-celeb-logo-frame",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"cbc-celeb-logo-img"})}),r.jsx("h2",{className:"cbc-celeb-heading",children:"All Habits Complete!"}),r.jsx("p",{className:"cbc-celeb-subtext",children:_s.current}),r.jsxs("p",{className:"cbc-celeb-stats",children:[Ie,"/",bt.length," habits  Day ",B||1]}),r.jsx("button",{ref:Gt,className:"cbc-celeb-btn",onClick:ts,children:"Keep Going"})]})]}),K&&r.jsx("div",{className:`toast-notification ${K.type}`,children:K.message})]})})}function uh(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function R2(n,e){return[n,e].sort().join("_")}function sP(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Mr(),{isDark:l,toggleTheme:u}=ka(),d=$n(),[p,g]=v.useState("buddies"),[y,w]=v.useState([]),[j,T]=v.useState([]),[O,$]=v.useState([]),[F,B]=v.useState(""),[te,K]=v.useState([]),[ae,be]=v.useState([]),[ve,_e]=v.useState(!0),[R,E]=v.useState(null),[A,V]=v.useState(null),D=v.useCallback((ee,L="info")=>{V({message:ee,type:L}),setTimeout(()=>V(null),3500)},[]);v.useEffect(()=>{!i&&(!n||!e)&&d("/")},[n,e,i,d]);const H=v.useCallback(async()=>{if(t){_e(!0);try{const ee=t.id,se=(await Ts(zt(ge,"clients"))).docs.map(at=>({id:at.id,...at.data()}));be(se);const De=Object.fromEntries(se.map(at=>[at.id,at])),Le=await Ts(Ds(zt(ge,"buddies"),ds("user1","==",ee))),Qe=await Ts(Ds(zt(ge,"buddies"),ds("user2","==",ee))),Fe=new Set;[...Le.docs,...Qe.docs].forEach(at=>{const Gt=at.data(),_s=Gt.user1===ee?Gt.user2:Gt.user1;Fe.add(_s)}),w(Array.from(Fe).map(at=>De[at]).filter(Boolean));const ft=await Ts(Ds(zt(ge,"buddyRequests"),ds("toId","==",ee),ds("status","==","pending")));T(ft.docs.map(at=>({reqId:at.id,...at.data(),fromClient:De[at.data().fromId]})).filter(at=>at.fromClient));const jt=await Ts(Ds(zt(ge,"buddyRequests"),ds("fromId","==",ee),ds("status","==","pending")));$(jt.docs.map(at=>({reqId:at.id,...at.data(),toClient:De[at.data().toId]})).filter(at=>at.toClient))}catch(ee){console.error("Error fetching buddy data:",ee),D("Failed to load buddies","error")}finally{_e(!1)}}},[t,D]);v.useEffect(()=>{H()},[H]),v.useEffect(()=>{if(!F.trim()||!t){K([]);return}const ee=F.toLowerCase(),L=t.id,se=new Set(y.map(Fe=>Fe.id)),De=new Set(O.map(Fe=>Fe.toId)),Le=new Set(j.map(Fe=>Fe.fromId)),Qe=ae.filter(Fe=>Fe.id===L||!Fe.name||!Fe.coreBuddyAccess&&Fe.clientType!=="core_buddy"?!1:Fe.name.toLowerCase().includes(ee)).map(Fe=>({...Fe,isBuddy:se.has(Fe.id),isPendingOut:De.has(Fe.id),isPendingIn:Le.has(Fe.id)})).slice(0,20);K(Qe)},[F,ae,y,O,j,t]);const M=async(ee,L)=>{if(!(!t||ee===t.id))try{await hi(zt(ge,"notifications"),{toId:ee,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:L,read:!1,createdAt:Hr()})}catch(se){console.error("Notification error:",se),se.code==="permission-denied"&&D("Notifications blocked  check Firestore rules","error")}},$e=async ee=>{E(ee);try{const L=`${t.id}_${ee}`;await Es(ze(ge,"buddyRequests",L),{fromId:t.id,toId:ee,status:"pending",createdAt:Hr()}),await M(ee,"buddy_request"),D("Buddy request sent!","success"),await H()}catch(L){console.error("Error sending request:",L),D("Failed to send request","error")}finally{E(null)}},pt=async ee=>{E(ee.reqId);try{const L=R2(ee.fromId,t.id);await Es(ze(ge,"buddies",L),{user1:[ee.fromId,t.id].sort()[0],user2:[ee.fromId,t.id].sort()[1],connectedAt:Hr()}),await yr(ze(ge,"buddyRequests",ee.reqId)),await M(ee.fromId,"buddy_accept"),D("Buddy added!","success"),await H()}catch(L){console.error("Error accepting request:",L),D("Failed to accept","error")}finally{E(null)}},W=async ee=>{E(ee.reqId);try{await yr(ze(ge,"buddyRequests",ee.reqId)),D("Request declined","info"),await H()}catch(L){console.error("Error declining:",L),D("Failed to decline","error")}finally{E(null)}},pe=async ee=>{E(ee.reqId);try{await yr(ze(ge,"buddyRequests",ee.reqId)),D("Request cancelled","info"),await H()}catch(L){console.error("Error cancelling:",L),D("Failed to cancel","error")}finally{E(null)}},Ve=async ee=>{E(ee);try{const L=R2(t.id,ee);await yr(ze(ge,"buddies",L)),D("Buddy removed","info"),await H()}catch(L){console.error("Error removing buddy:",L),D("Failed to remove buddy","error")}finally{E(null)}},We=j.length;return i?r.jsx("div",{className:"bdy-loading",children:r.jsx("div",{className:"bdy-spinner"})}):!n||!e||!t?null:r.jsx(xa,{children:r.jsxs("div",{className:"bdy-page","data-theme":l?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"bdy-main",children:[r.jsx("h1",{className:"bdy-title",children:"Buddies"}),r.jsxs("button",{className:"bdy-leaderboard-link",onClick:()=>d("/client/leaderboard"),children:[r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C7 4 7 7 7 7"}),r.jsx("path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5C17 4 17 7 17 7"}),r.jsx("rect",{x:"6",y:"9",width:"12",height:"13",rx:"2"}),r.jsx("path",{d:"M12 9v13"}),r.jsx("path",{d:"M2 22h20"})]}),r.jsx("span",{children:"Leaderboard"}),r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("div",{className:"bdy-tabs",children:[r.jsxs("button",{className:`bdy-tab${p==="buddies"?" active":""}`,onClick:()=>g("buddies"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("span",{children:"My Buddies"})]}),r.jsxs("button",{className:`bdy-tab${p==="requests"?" active":""}`,onClick:()=>g("requests"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("line",{x1:"19",y1:"8",x2:"19",y2:"14"}),r.jsx("line",{x1:"22",y1:"11",x2:"16",y2:"11"})]}),r.jsx("span",{children:"Requests"}),We>0&&r.jsx("span",{className:"bdy-tab-badge",children:We})]}),r.jsxs("button",{className:`bdy-tab${p==="search"?" active":""}`,onClick:()=>g("search"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("span",{children:"Find"})]})]}),ve?r.jsx("div",{className:"bdy-content-loading",children:r.jsx("div",{className:"bdy-spinner"})}):r.jsxs(r.Fragment,{children:[p==="buddies"&&r.jsx("div",{className:"bdy-section",children:y.length===0?r.jsxs("div",{className:"bdy-empty",children:[r.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("h3",{children:"No buddies yet"}),r.jsx("p",{children:"Find members and send buddy requests to connect!"}),r.jsx("button",{className:"bdy-empty-btn",onClick:()=>g("search"),children:"Find Buddies"})]}):r.jsx("div",{className:"bdy-list",children:y.map(ee=>r.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${ee.id}`),children:[r.jsx("div",{className:"bdy-avatar",children:ee.photoURL?r.jsx("img",{src:ee.photoURL,alt:ee.name}):r.jsx("span",{children:uh(ee.name)})}),r.jsx("div",{className:"bdy-card-info",children:r.jsx("span",{className:"bdy-card-name",children:ee.name})}),r.jsx("button",{className:"bdy-remove-btn",onClick:L=>{L.stopPropagation(),Ve(ee.id)},disabled:R===ee.id,"aria-label":"Remove buddy",children:R===ee.id?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},ee.id))})}),p==="requests"&&r.jsxs("div",{className:"bdy-section",children:[j.length>0&&r.jsxs(r.Fragment,{children:[r.jsx("h3",{className:"bdy-section-title",children:"Incoming"}),r.jsx("div",{className:"bdy-list",children:j.map(ee=>r.jsxs("div",{className:"bdy-card",children:[r.jsx("div",{className:"bdy-avatar",children:ee.fromClient.photoURL?r.jsx("img",{src:ee.fromClient.photoURL,alt:ee.fromClient.name}):r.jsx("span",{children:uh(ee.fromClient.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:ee.fromClient.name}),r.jsx("span",{className:"bdy-card-sub",children:"wants to be your buddy"})]}),r.jsxs("div",{className:"bdy-action-pair",children:[r.jsx("button",{className:"bdy-accept-btn",onClick:()=>pt(ee),disabled:R===ee.reqId,children:R===ee.reqId?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}),r.jsx("button",{className:"bdy-decline-btn",onClick:()=>W(ee),disabled:R===ee.reqId,children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]},ee.reqId))})]}),O.length>0&&r.jsxs(r.Fragment,{children:[r.jsx("h3",{className:"bdy-section-title",children:"Sent"}),r.jsx("div",{className:"bdy-list",children:O.map(ee=>r.jsxs("div",{className:"bdy-card",children:[r.jsx("div",{className:"bdy-avatar",children:ee.toClient?.photoURL?r.jsx("img",{src:ee.toClient.photoURL,alt:ee.toClient.name}):r.jsx("span",{children:uh(ee.toClient?.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:ee.toClient?.name}),r.jsx("span",{className:"bdy-card-sub",children:"pending"})]}),r.jsx("button",{className:"bdy-cancel-btn",onClick:()=>pe(ee),disabled:R===ee.reqId,children:R===ee.reqId?r.jsx("div",{className:"bdy-btn-spinner"}):"Cancel"})]},ee.reqId))})]}),j.length===0&&O.length===0&&r.jsxs("div",{className:"bdy-empty",children:[r.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[r.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),r.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),r.jsx("h3",{children:"No pending requests"}),r.jsx("p",{children:"All caught up!"})]})]}),p==="search"&&r.jsxs("div",{className:"bdy-section",children:[r.jsxs("div",{className:"bdy-search-bar",children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("input",{type:"text",placeholder:"Search by name...",value:F,onChange:ee=>B(ee.target.value),autoFocus:!0}),F&&r.jsx("button",{className:"bdy-search-clear",onClick:()=>B(""),children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),F.trim()&&te.length===0&&r.jsx("div",{className:"bdy-empty bdy-empty-sm",children:r.jsxs("p",{children:['No members found for "',F,'"']})}),te.length>0&&r.jsx("div",{className:"bdy-list",children:te.map(ee=>r.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${ee.id}`),children:[r.jsx("div",{className:"bdy-avatar",children:ee.photoURL?r.jsx("img",{src:ee.photoURL,alt:ee.name}):r.jsx("span",{children:uh(ee.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:ee.name}),ee.isBuddy&&r.jsx("span",{className:"bdy-card-badge",children:"Buddy"})]}),ee.isBuddy?r.jsx("span",{className:"bdy-status-icon",children:r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-success)",strokeWidth:"2.5",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}):ee.isPendingOut?r.jsx("span",{className:"bdy-pending-label",children:"Pending"}):ee.isPendingIn?r.jsx("button",{className:"bdy-accept-btn",onClick:L=>{L.stopPropagation();const se=j.find(De=>De.fromId===ee.id);se&&pt(se)},disabled:!!R,children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}):r.jsx("button",{className:"bdy-add-btn",onClick:L=>{L.stopPropagation(),$e(ee.id)},disabled:R===ee.id,children:R===ee.id?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]},ee.id))})]})]})]}),r.jsx(aa,{}),A&&r.jsxs("div",{className:`toast-notification ${A.type}`,children:[r.jsx("span",{className:"toast-icon",children:A.type==="success"?r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M5 13 L9 17 L19 7"})}):A.type==="error"?r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),r.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),r.jsx("span",{className:"toast-message",children:A.message})]})]})})}function dh(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function Jp(n,e){return[n,e].sort().join("_")}const nP=5;function Zp(n){return n.toISOString().split("T")[0]}function rP(n){return n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}T`:`${Math.round(n)}`}const aP={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}};function A2(n){if(!n)return"";const e=n instanceof Date?n:n.toDate?n.toDate():new Date(n),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function iP(){const{userId:n}=fE(),{currentUser:e,isClient:t,clientData:i,loading:l}=Mr(),{isDark:u,toggleTheme:d}=ka(),p=$n(),[g,y]=v.useState(null),[w,j]=v.useState("none"),[T,O]=v.useState(null),[$,F]=v.useState(!0),[B,te]=v.useState(!1),[K,ae]=v.useState(null),[be,ve]=v.useState([]),[_e,R]=v.useState(!1),[E,A]=v.useState(new Set),[V,D]=v.useState(new Set),[H,M]=v.useState({}),[$e,pt]=v.useState({}),[W,pe]=v.useState({}),[Ve,We]=v.useState(!0),[ee,L]=v.useState(0),[se,De]=v.useState(0),[Le,Qe]=v.useState(0),[Fe,ft]=v.useState(0),[jt,at]=v.useState([]),[Gt,_s]=v.useState([]),[wt,gt]=v.useState(null),[le,Xt]=v.useState(null),[Kt,ut]=v.useState(0),[bt,Xe]=v.useState([]),[rt,qt]=v.useState(!1),[en,As]=v.useState(null),[ts,Ct]=v.useState([]),Jt=v.useCallback((Q,de="info")=>{ae({message:Q,type:de}),setTimeout(()=>ae(null),3500)},[]);v.useEffect(()=>{!l&&(!e||!t)&&p("/")},[e,t,l,p]),v.useEffect(()=>{i&&n&&i.id===n&&p("/client/core-buddy",{replace:!0})},[i,n,p]),v.useEffect(()=>{if(!i||!n||i.id===n)return;let Q=!1;return(async()=>{F(!0);try{const At=(await Ts(zt(ge,"clients"))).docs.map(Vt=>({id:Vt.id,...Vt.data()})).find(Vt=>Vt.id===n);if(!At){Q||F(!1);return}Q||y(At);const Et=i.id,ss=Jp(Et,n);if((await Rs(ze(ge,"buddies",ss))).exists())Q||j("buddy");else{const Vt=`${Et}_${n}`,Ls=await Rs(ze(ge,"buddyRequests",Vt));if(Ls.exists()&&Ls.data().status==="pending")Q||(j("pending_out"),O(Vt));else{const Xs=`${n}_${Et}`,is=await Rs(ze(ge,"buddyRequests",Xs));is.exists()&&is.data().status==="pending"?Q||(j("pending_in"),O(Xs)):Q||j("none")}}}catch(de){console.error("Error loading profile:",de)}finally{Q||F(!1)}})(),()=>{Q=!0}},[i,n]),v.useEffect(()=>{if(!n||!g)return;let Q=!1;return(async()=>{We(!0);try{const[de,tt,At,Et]=await Promise.all([Ts(Ds(zt(ge,"workoutLogs"),ds("clientId","==",n))),Rs(ze(ge,"coreBuddyAchievements",n)),Rs(ze(ge,"coreBuddyPBs",n)),Rs(ze(ge,"clientProgrammes",n))]);if(Q)return;const ss=de.docs.length;L(ss),tt.exists()&&De(tt.data().totalVolume||0);let Ut=0;const Vt=de.docs.map(is=>is.data().date).filter(Boolean).sort().reverse();if(Vt.length>0){const is=new Date;let Ns=new Date(is);for(let Os=0;Os<52;Os++){const q=new Date(Ns),we=q.getDay(),Te=we===0?6:we-1;q.setDate(q.getDate()-Te),q.setHours(0,0,0,0);const Ee=new Date(q);Ee.setDate(Ee.getDate()+7);const ke=Zp(q),lt=Zp(Ee);if(Vt.some(st=>st>=ke&&st<lt))Ut++;else{if(Os>0)break;break}Ns.setDate(Ns.getDate()-7)}}if(Q||Qe(Ut),At.exists()){const is=At.data().exercises||{},Ns=Object.entries(is).sort(([,Os],[,q])=>(q.weight||0)-(Os.weight||0)).slice(0,3).map(([Os,q])=>({name:Os,weight:q.weight,reps:q.reps}));Q||at(Ns)}if(Et.exists()){const is=Et.data(),Ns=aP[is.templateId];if(Ns){const Os=Object.keys(is.completedSessions||{}).length,q=Ns.duration*Ns.daysPerWeek;Q||(Xt(is.templateId.replace(/_/g," ").replace(/\b\w/g,we=>we.toUpperCase())),ut(q>0?Math.round(Os/q*100):0))}}const Ls=await Rs(ze(ge,"achievements",n));if(!Q&&Ls.exists()){const is=Ls.data().badges||{};_s(Object.keys(is))}let Xs=0;for(let is=0;is<30;is++){const Ns=new Date;Ns.setDate(Ns.getDate()-is);const Os=Zp(Ns);try{const q=await Ts(Ds(zt(ge,"habitLogs"),ds("clientId","==",n),ds("date","==",Os)));if(q.empty)break;{const we=q.docs[0].data().habits||{};if(Object.values(we).filter(Boolean).length>=nP)Xs++;else break}}catch{break}}Q||ft(Xs)}catch(de){console.error("Error loading buddy stats:",de)}finally{Q||We(!1)}})(),()=>{Q=!0}},[n,g]),v.useEffect(()=>{if(!i)return;const Q=i.id;(async()=>{try{const[de,tt,At]=await Promise.all([Ts(Ds(zt(ge,"buddies"),ds("user1","==",Q))),Ts(Ds(zt(ge,"buddies"),ds("user2","==",Q))),Ts(zt(ge,"clients"))]),Et=new Set;[...de.docs,...tt.docs].forEach(Ut=>{const Vt=Ut.data();Et.add(Vt.user1===Q?Vt.user2:Vt.user1)});const ss={};At.docs.forEach(Ut=>{ss[Ut.id]=Ut.data()}),Xe(Array.from(Et).filter(Ut=>ss[Ut]).map(Ut=>({id:Ut,name:ss[Ut].name,photoURL:ss[Ut].photoURL||null})))}catch(de){console.error("Error loading buddies for mentions:",de)}})()},[i]);const Ss=async(Q,de,tt={})=>{if(!(!i||Q===i.id))try{await hi(zt(ge,"notifications"),{toId:Q,fromId:i.id,fromName:i.name||"Someone",fromPhotoURL:i.photoURL||null,type:de,read:!1,createdAt:Hr(),...tt})}catch(At){console.error("Notification error:",At),At.code==="permission-denied"&&Jt("Notifications blocked  check Firestore rules","error")}},Ot=async()=>{te(!0);try{const Q=`${i.id}_${n}`;await Es(ze(ge,"buddyRequests",Q),{fromId:i.id,toId:n,status:"pending",createdAt:Hr()}),await Ss(n,"buddy_request"),j("pending_out"),O(Q),Jt("Buddy request sent!","success")}catch(Q){console.error(Q),Jt("Failed to send request","error")}finally{te(!1)}},Ps=async()=>{if(T){te(!0);try{const Q=Jp(i.id,n);await Es(ze(ge,"buddies",Q),{user1:[i.id,n].sort()[0],user2:[i.id,n].sort()[1],connectedAt:Hr()}),await yr(ze(ge,"buddyRequests",T)),await Ss(n,"buddy_accept"),j("buddy"),Jt("Buddy added!","success")}catch(Q){console.error(Q),Jt("Failed to accept","error")}finally{te(!1)}}},ue=async()=>{if(T){te(!0);try{await yr(ze(ge,"buddyRequests",T)),j("none"),Jt(w==="pending_out"?"Request cancelled":"Request declined","info")}catch(Q){console.error(Q),Jt("Failed","error")}finally{te(!1)}}},Se=async()=>{te(!0);try{const Q=Jp(i.id,n);await yr(ze(ge,"buddies",Q)),j("none"),Jt("Buddy removed","info")}catch(Q){console.error(Q),Jt("Failed to remove","error")}finally{te(!1)}},Ie=v.useCallback(async()=>{if(n){R(!0);try{const Q=await Ts(Ds(zt(ge,"posts"),ds("authorId","==",n),Gh("createdAt","desc"),Kh(30)));if(ve(Q.docs.map(de=>({id:de.id,...de.data()}))),i){const de=await Ts(Ds(zt(ge,"postLikes"),ds("userId","==",i.id)));A(new Set(de.docs.map(tt=>tt.data().postId)))}}catch(Q){console.error("Error loading journey:",Q)}finally{R(!1)}}},[n,i]);v.useEffect(()=>{!$&&g&&Ie()},[$,g,Ie]);const Ge=async Q=>{if(window.confirm("Delete this post?"))try{await yr(ze(ge,"posts",Q)),ve(de=>de.filter(tt=>tt.id!==Q)),Jt("Post deleted","info")}catch(de){console.error("Delete error:",de),Jt("Failed to delete","error")}},X=async Q=>{if(!i)return;const de=i.id,tt=`${Q}_${de}`,At=E.has(Q),Et=new Set(E);At?Et.delete(Q):Et.add(Q),A(Et),ve(ss=>ss.map(Ut=>Ut.id===Q?{...Ut,likeCount:Math.max(0,(Ut.likeCount||0)+(At?-1:1))}:Ut));try{if(At)await yr(ze(ge,"postLikes",tt)),await Ma(ze(ge,"posts",Q),{likeCount:Bo(-1)});else{await Es(ze(ge,"postLikes",tt),{postId:Q,userId:de,createdAt:Hr()}),await Ma(ze(ge,"posts",Q),{likeCount:Bo(1)});const ss=be.find(Ut=>Ut.id===Q);ss&&Ss(ss.authorId,"like",{postId:Q})}}catch(ss){console.error("Like error:",ss),Ie()}},he=async Q=>{try{const de=await Ts(Ds(zt(ge,"postComments"),ds("postId","==",Q),Gh("createdAt","asc"),Kh(50)));M(tt=>({...tt,[Q]:de.docs.map(At=>({id:At.id,...At.data()}))}))}catch(de){console.error("Error loading comments:",de)}},Pe=Q=>{const de=new Set(V);de.has(Q)?de.delete(Q):(de.add(Q),H[Q]||he(Q)),D(de)},qe=(Q,de)=>{const tt=Q.match(/@(\w*)$/);if(tt){qt(!0),As(de);const At=bt.filter(Et=>Et.name&&Et.name.toLowerCase().includes(tt[1].toLowerCase())).slice(0,5);Ct(At)}else qt(!1),Ct([])},Ae=(Q,de)=>{const At=($e[de]||"").replace(/@\w*$/,`@${Q.name} `);pt(Et=>({...Et,[de]:At})),qt(!1),Ct([])},dt=(Q,de)=>{pt(tt=>({...tt,[Q]:de})),qe(de,Q)},Tt=async Q=>{const de=($e[Q]||"").trim();if(!(!de||!i)){pe(tt=>({...tt,[Q]:!0}));try{await hi(zt(ge,"postComments"),{postId:Q,authorId:i.id,authorName:i.name||"Unknown",authorPhotoURL:i.photoURL||null,content:de,createdAt:Hr()}),await Ma(ze(ge,"posts",Q),{commentCount:Bo(1)});const tt=be.find(Et=>Et.id===Q);tt&&Ss(tt.authorId,"comment",{postId:Q});const At=de.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(At){const Et=new Set;At.forEach(ss=>{const Ut=ss.slice(1).trim(),Vt=bt.find(Ls=>Ls.name&&Ls.name.toLowerCase()===Ut.toLowerCase());Vt&&!Et.has(Vt.id)&&(Et.add(Vt.id),Ss(Vt.id,"mention",{postId:Q}))})}pt(Et=>({...Et,[Q]:""})),ve(Et=>Et.map(ss=>ss.id===Q?{...ss,commentCount:(ss.commentCount||0)+1}:ss)),await he(Q)}catch(tt){console.error("Comment error:",tt),Jt("Failed to comment","error")}finally{pe(tt=>({...tt,[Q]:!1}))}}};return l||$||!i?r.jsx("div",{className:"prf-loading","data-theme":u?"dark":"light",children:r.jsx("div",{className:"prf-spinner"})}):!e||!t?null:g?r.jsx(xa,{children:r.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:u?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"prf-main",children:[r.jsxs("div",{className:"prf-hero",children:[r.jsx("div",{className:"prf-avatar-lg",children:g.photoURL?r.jsx("img",{src:g.photoURL,alt:g.name}):r.jsx("span",{children:dh(g.name)})}),r.jsx("h1",{className:"prf-name",children:g.name}),r.jsxs("div",{className:"prf-buddy-action",children:[w==="none"&&r.jsx("button",{className:"prf-btn prf-btn-primary",onClick:Ot,disabled:B,children:B?r.jsx("div",{className:"prf-btn-spinner"}):r.jsxs(r.Fragment,{children:[r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Buddy"]})}),w==="pending_out"&&r.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:ue,disabled:B,children:B?r.jsx("div",{className:"prf-btn-spinner dark"}):"Cancel Request"}),w==="pending_in"&&r.jsxs("div",{className:"prf-btn-pair",children:[r.jsx("button",{className:"prf-btn prf-btn-success",onClick:Ps,disabled:B,children:B?r.jsx("div",{className:"prf-btn-spinner"}):"Accept"}),r.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:ue,disabled:B,children:"Decline"})]}),w==="buddy"&&r.jsx("button",{className:"prf-btn prf-btn-danger",onClick:Se,disabled:B,children:B?r.jsx("div",{className:"prf-btn-spinner"}):"Remove Buddy"})]})]}),Ve?r.jsx("div",{className:"prf-stats-loading",children:r.jsx("div",{className:"prf-spinner"})}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"prf-stats",children:[r.jsxs("div",{className:"prf-stat",children:[r.jsx("span",{className:"prf-stat-value",children:ee}),r.jsx("span",{className:"prf-stat-label",children:"Workouts"})]}),r.jsxs("div",{className:"prf-stat",children:[r.jsxs("span",{className:"prf-stat-value",children:[rP(se),r.jsx("span",{className:"prf-stat-unit",children:se>=1e3?"":"kg"})]}),r.jsxs("span",{className:"prf-stat-label",children:[se>=1e6?"Million kg":se>=1e3?"Tonnes":"Volume"," Lifted"]})]}),r.jsxs("div",{className:"prf-stat",children:[r.jsxs("span",{className:"prf-stat-value",children:[Le,r.jsx("span",{className:"prf-stat-unit",children:"wk"})]}),r.jsx("span",{className:"prf-stat-label",children:"Streak"})]})]}),(le||Fe>0)&&r.jsxs("div",{className:"prf-info-row",children:[le&&r.jsxs("div",{className:"prf-info-card info-programme",children:[r.jsx("div",{className:"prf-info-icon",children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"}),r.jsx("path",{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"})]})}),r.jsxs("div",{className:"prf-info-text",children:[r.jsx("span",{className:"prf-info-label",children:le}),r.jsx("div",{className:"prf-info-progress-bar",children:r.jsx("div",{className:"prf-info-progress-fill",style:{width:`${Math.min(Kt,100)}%`}})}),r.jsxs("span",{className:"prf-info-sub",children:[Kt,"% complete"]})]})]}),Fe>0&&r.jsxs("div",{className:"prf-info-card info-habit",children:[r.jsx("div",{className:"prf-info-icon",children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),r.jsx("path",{d:"M22 4L12 14.01l-3-3"})]})}),r.jsxs("div",{className:"prf-info-text",children:[r.jsxs("span",{className:"prf-info-value",children:[Fe," day",Fe!==1?"s":""]}),r.jsx("span",{className:"prf-info-sub",children:"Habit Streak"})]})]})]}),jt.length>0&&r.jsxs("div",{className:"prf-section",children:[r.jsx("h2",{className:"prf-section-title",children:"Top Lifts"}),r.jsx("div",{className:"prf-pb-list",children:jt.map((Q,de)=>r.jsxs("div",{className:"prf-pb-item",children:[r.jsx("div",{className:"prf-pb-rank",children:de===0?r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:r.jsx("path",{d:"M12 2l2.4 7.4H22l-6 4.4 2.3 7.2L12 16.6 5.7 21l2.3-7.2-6-4.4h7.6z"})}):`#${de+1}`}),r.jsx("span",{className:"prf-pb-name",children:Q.name}),r.jsxs("span",{className:"prf-pb-weight",children:[Q.weight,r.jsx("span",{className:"prf-pb-unit",children:"kg"})," x",Q.reps]})]},de))})]}),Gt.length>0&&r.jsxs("div",{className:"prf-section",children:[r.jsxs("h2",{className:"prf-section-title",children:["Badges Earned (",Gt.length,")"]}),r.jsx("div",{className:"prf-badge-row",children:Gt.map(Q=>{const de=mu.find(tt=>tt.id===Q);return de?r.jsx("button",{className:"prf-badge-chip",onClick:()=>gt(de),children:r.jsx("img",{src:de.img,alt:de.name,className:"prf-badge-chip-img"})},Q):null})})]}),wt&&r.jsx("div",{className:"prf-badge-overlay",onClick:()=>gt(null),children:r.jsxs("div",{className:"prf-badge-overlay-content",onClick:Q=>Q.stopPropagation(),children:[r.jsx("img",{src:wt.img,alt:wt.name,className:"prf-badge-overlay-img"}),r.jsx("p",{className:"prf-badge-overlay-desc",children:wt.desc}),r.jsx("button",{className:"prf-badge-overlay-close",onClick:()=>gt(null),children:"Tap to close"})]})})]}),r.jsxs("div",{className:"prf-section",children:[r.jsx("h2",{className:"prf-section-title",children:`${g.name?.split(" ")[0]}'s Journey`}),_e?r.jsx("div",{className:"journey-loading",children:r.jsx("div",{className:"prf-spinner"})}):be.length===0?r.jsxs("div",{className:"journey-empty",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]}),r.jsx("p",{children:"No posts yet"})]}):r.jsx("div",{className:"journey-list",children:be.map(Q=>r.jsxs("div",{className:"journey-post",children:[r.jsxs("div",{className:"journey-post-header",children:[r.jsx("div",{className:"journey-post-avatar",children:Q.authorPhotoURL?r.jsx("img",{src:Q.authorPhotoURL,alt:""}):r.jsx("span",{children:dh(Q.authorName)})}),r.jsxs("div",{className:"journey-post-meta",children:[r.jsx("span",{className:"journey-post-name",children:Q.authorName}),r.jsx("span",{className:"journey-post-time",children:A2(Q.createdAt)})]}),Q.authorId===i.id&&r.jsx("button",{className:"journey-delete-btn",onClick:()=>Ge(Q.id),"aria-label":"Delete post",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),Q.content&&r.jsx("p",{className:"journey-post-content",children:Q.content}),Q.imageURL&&r.jsx("div",{className:"journey-post-image",children:r.jsx("img",{src:Q.imageURL,alt:"Post",loading:"lazy"})}),r.jsxs("div",{className:"journey-post-actions",children:[r.jsxs("button",{className:`journey-action-btn${E.has(Q.id)?" liked":""}`,onClick:()=>X(Q.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:E.has(Q.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),r.jsx("span",{children:Q.likeCount||0})]}),r.jsxs("button",{className:`journey-action-btn${V.has(Q.id)?" active":""}`,onClick:()=>Pe(Q.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),r.jsx("span",{children:Q.commentCount||0})]})]}),V.has(Q.id)&&r.jsxs("div",{className:"journey-comments",children:[H[Q.id]?.length>0?H[Q.id].map(de=>r.jsxs("div",{className:"journey-comment",children:[r.jsx("div",{className:"journey-comment-avatar",onClick:()=>p(`/client/core-buddy/profile/${de.authorId}`),children:de.authorPhotoURL?r.jsx("img",{src:de.authorPhotoURL,alt:""}):r.jsx("span",{children:dh(de.authorName)})}),r.jsxs("div",{className:"journey-comment-body",children:[r.jsxs("div",{className:"journey-comment-bubble",children:[r.jsx("span",{className:"journey-comment-name",children:de.authorName}),r.jsx("span",{className:"journey-comment-text",children:de.content})]}),r.jsx("span",{className:"journey-comment-time",children:A2(de.createdAt)})]})]},de.id)):r.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),r.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[r.jsx("input",{type:"text",placeholder:"Comment... (@ to mention)",value:$e[Q.id]||"",onChange:de=>dt(Q.id,de.target.value),onKeyDown:de=>{de.key==="Enter"&&Tt(Q.id)},maxLength:300}),rt&&en===Q.id&&ts.length>0&&r.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:ts.map(de=>r.jsxs("button",{className:"mention-option",onClick:()=>Ae(de,Q.id),children:[r.jsx("div",{className:"mention-option-avatar",children:de.photoURL?r.jsx("img",{src:de.photoURL,alt:""}):r.jsx("span",{children:dh(de.name)})}),r.jsx("span",{children:de.name})]},de.id))}),r.jsx("button",{onClick:()=>Tt(Q.id),disabled:!($e[Q.id]||"").trim()||W[Q.id],children:W[Q.id]?r.jsx("div",{className:"journey-btn-spinner-sm"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),r.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},Q.id))})]})]}),r.jsx(aa,{}),K&&r.jsxs("div",{className:`toast-notification ${K.type}`,children:[r.jsx("span",{className:"toast-icon",children:K.type==="success"?r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M5 13 L9 17 L19 7"})}):K.type==="error"?r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),r.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),r.jsx("span",{className:"toast-message",children:K.message})]})]})}):r.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions"})]})}),r.jsx("main",{className:"prf-main",children:r.jsx("p",{style:{textAlign:"center",color:"var(--text-tertiary)",padding:"40px 0"},children:"User not found"})}),r.jsx(aa,{})]})}function oP(){const n=$n(),{clientData:e,currentUser:t,resolveClient:i,updateClientData:l}=Mr(),[u,d]=v.useState([]),[p,g]=v.useState(""),[y,w]=v.useState(!1),[j,T]=v.useState(null),[O,$]=v.useState(!1),[F,B]=v.useState(null),te=v.useRef(null),K=v.useRef(null);if(!e?.buddyEnabled)return r.jsxs("div",{className:"buddy-page",children:[r.jsxs("div",{className:"buddy-container",children:[r.jsx("p",{children:"Buddy is not enabled on your account."}),r.jsx("button",{onClick:()=>n("/client/core-buddy"),children:"Back to Dashboard"})]}),r.jsx(aa,{active:"home"})]});v.useEffect(()=>{te.current&&te.current.scrollIntoView({behavior:"smooth"})},[u,y]),v.useEffect(()=>{u.length===0&&!y&&ae([])},[]);const ae=async E=>{w(!0),T(null);try{const V=await(await fetch("/api/buddy-onboarding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:E,clientName:e?.name||t?.displayName||"there"})})).json();if(V.error){T(V.error);return}const D={role:"assistant",content:V.reply};d(H=>[...H,D]),V.profileData&&(await R(V.profileData),B(V.profileData),$(!0))}catch(A){console.error("Buddy chat error:",A),T("Something went wrong  try sending again.")}finally{w(!1)}},be=()=>{const E=p.trim();if(!E||y)return;const A={role:"user",content:E},V=[...u,A];d(V),g(""),K.current&&K.current.focus(),ae(V)},ve=E=>{E.key==="Enter"&&!E.shiftKey&&(E.preventDefault(),be())},_e=E=>{const A=E?.experience||"beginner";return A==="advanced"?{id:"fullbody_12wk",name:"12-Week Full Body",duration:12,level:"Advanced",daysPerWeek:3,description:"Complete transformation programme  push, pull, and legs over three phases."}:A==="intermediate"?{id:"fullbody_8wk",name:"8-Week Full Body",duration:8,level:"Intermediate",daysPerWeek:3,description:"Two-phase programme building strength and endurance across your full body."}:{id:"fullbody_4wk",name:"4-Week Full Body",duration:4,level:"All Levels",daysPerWeek:3,description:"Build total body strength with compound dumbbell movements and bodyweight finishers."}},R=async E=>{try{const A=await i();if(!A)return;await Es(ze(ge,"onboardingSubmissions",A.id),{clientId:A.id,clientName:A.name,email:A.email,source:"buddy_chat",welcome:{dob:E.dob||null,gender:E.gender||null,goals:E.goals||[],experience:E.experience||null,injuries:E.injuries||null,activityLevel:E.activityLevel||null,exerciseHistory:E.exerciseHistory||null,sleepHours:E.sleepHours||null,stressLevel:E.stressLevel||null,dietaryInfo:E.dietaryInfo||null,availability:E.availability||null,additionalInfo:E.additionalInfo||null},submittedAt:Hr()});const V=E.goals||[];await Ma(ze(ge,"clients",A.id),{fitnessGoal:V[0]||null,fitnessGoals:V,experienceLevel:E.experience||null,dob:E.dob||null,injuries:E.injuries||null}),l({fitnessGoal:V[0]||null,fitnessGoals:V,experienceLevel:E.experience,dob:E.dob})}catch(A){console.error("Save profile error:",A)}};return r.jsx(xa,{children:r.jsxs("div",{className:"buddy-page buddy-page--chat",children:[r.jsxs("div",{className:"buddy-chat-container",children:[r.jsxs("div",{className:"buddy-chat-top",children:[r.jsx("button",{className:"buddy-back",onClick:()=>n("/client/core-buddy"),children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsxs("div",{className:"buddy-chat-header",children:[r.jsx("div",{className:"buddy-chat-avatar",children:r.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 2a4 4 0 0 1 4 4v2a4 4 0 0 1-8 0V6a4 4 0 0 1 4-4z"}),r.jsx("path",{d:"M18 14c2 1 3 3 3 5v2H3v-2c0-2 1-4 3-5"}),r.jsx("circle",{cx:"9",cy:"7",r:"0.5",fill:"currentColor"}),r.jsx("circle",{cx:"15",cy:"7",r:"0.5",fill:"currentColor"}),r.jsx("path",{d:"M9.5 10a2.5 2.5 0 0 0 5 0"})]})}),r.jsxs("div",{children:[r.jsx("h2",{className:"buddy-chat-name",children:"Buddy"}),r.jsx("span",{className:"buddy-chat-status",children:y?"typing...":"Your AI Coach"})]})]})]}),r.jsxs("div",{className:"buddy-chat-messages",children:[u.map((E,A)=>r.jsxs("div",{className:`buddy-chat-bubble buddy-chat-${E.role}`,children:[E.role==="assistant"&&r.jsx("div",{className:"buddy-chat-bubble-avatar",children:"B"}),r.jsx("div",{className:"buddy-chat-bubble-content",children:E.content})]},A)),y&&r.jsxs("div",{className:"buddy-chat-bubble buddy-chat-assistant",children:[r.jsx("div",{className:"buddy-chat-bubble-avatar",children:"B"}),r.jsxs("div",{className:"buddy-chat-bubble-content buddy-chat-typing",children:[r.jsx("span",{}),r.jsx("span",{}),r.jsx("span",{})]})]}),j&&r.jsxs("div",{className:"buddy-chat-error",children:[j,r.jsx("button",{onClick:()=>ae(u),children:"Retry"})]}),r.jsx("div",{ref:te})]}),O?r.jsx("div",{className:"buddy-chat-done",children:F?(()=>{const E=_e(F);return r.jsxs(r.Fragment,{children:[r.jsx("p",{className:"buddy-chat-done-text",children:"Profile saved! Here's my pick for you:"}),r.jsxs("div",{className:"buddy-rec-card",onClick:()=>n("/client/core-buddy/programmes",{state:{templateId:E.id}}),children:[r.jsx("div",{className:"buddy-rec-name",children:E.name}),r.jsxs("div",{className:"buddy-rec-meta",children:[E.duration," weeks  ",E.daysPerWeek," days/week  ",E.level]}),r.jsx("div",{className:"buddy-rec-desc",children:E.description}),r.jsx("div",{className:"buddy-rec-cta",children:"View Programme"})]}),r.jsx("button",{className:"buddy-chat-skip-btn",onClick:()=>n("/client/core-buddy"),children:"Maybe later"})]})})():r.jsxs(r.Fragment,{children:[r.jsx("p",{className:"buddy-chat-done-text",children:"Profile saved  you're all set."}),r.jsx("button",{className:"buddy-chat-done-btn",onClick:()=>n("/client/core-buddy"),children:"Back to Dashboard"})]})}):r.jsxs("div",{className:"buddy-chat-input-wrap",children:[r.jsx("textarea",{ref:K,className:"buddy-chat-input",placeholder:"Type your message...",value:p,onChange:E=>g(E.target.value),onKeyDown:ve,rows:1,disabled:y}),r.jsx("button",{className:"buddy-chat-send",onClick:be,disabled:!p.trim()||y,"aria-label":"Send message",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),r.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]}),r.jsx(aa,{active:"home"})]})})}const ma=[{key:"pressUps",name:"Press-Ups",category:"Upper Body",unit:"reps"},{key:"squats",name:"Squats",category:"Lower Body",unit:"reps"},{key:"longJump",name:"Standing Long Jump",category:"Power",unit:"distance"},{key:"deadHang",name:"Dead Hang",category:"Upper Body",unit:"time"},{key:"plank",name:"Plank",category:"Core",unit:"time"},{key:"wallSit",name:"Wall Sit",category:"Lower Body",unit:"time"},{key:"chestPress",name:"Chest Press",category:"Upper Body",unit:"weight"}],Po=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function lP(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}function fa(n){const[e,t]=n.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function cP(n){if(!n&&n!==0)return"-";const e=Math.floor(n/60),t=(n%60).toFixed(2);return e>0?`${e}m ${parseFloat(t).toFixed(0)}s`:`${parseFloat(t).toFixed(2)}s`}function uP(n,e){return!n&&n!==0?"-":!e&&e!==0?`${n}kg`:`${n}kg x ${e}`}function hh(n,e){if(!e)return"-";switch(n.unit){case"weight":return uP(e.weight,e.reps);case"time":return cP(e.time);case"reps":return e.reps?`${e.reps} reps`:"-";case"distance":return e.distance?`${e.distance} cm`:"-";default:return"-"}}function Ol(n,e){if(!e)return 0;switch(n.unit){case"weight":return(e.weight||0)*(e.reps||0);case"time":return e.time||0;case"reps":return e.reps||0;case"distance":return e.distance||0;default:return 0}}function eg(n,e){return!e||e===0?null:(n-e)/e*100}function dP({data:n,exerciseKey:e,unit:t}){if(!n||n.length<2)return r.jsx("div",{className:"pb-trend-empty",children:r.jsx("p",{children:"Not enough data for trend line yet"})});const i=n.map(F=>{const B=F.benchmarks?.[e];if(!B)return 0;switch(t){case"weight":return(B.weight||0)*(B.reps||0);case"time":return B.time||0;case"reps":return B.reps||0;case"distance":return B.distance||0;default:return 0}}),l=Math.max(...i),u=Math.min(...i),d=l-u||1,p=300,g=100,y=20,w=p-y*2,j=g-y*2,T=i.map((F,B)=>{const te=y+B/(i.length-1)*w,K=y+j-(F-u)/d*j;return{x:te,y:K,value:F}}),O=T.map((F,B)=>`${B===0?"M":"L"} ${F.x} ${F.y}`).join(" "),$=O+` L ${T[T.length-1].x} ${y+j} L ${T[0].x} ${y+j} Z`;return r.jsxs("div",{className:"pb-trend-chart",children:[r.jsxs("svg",{viewBox:`0 0 ${p} ${g}`,preserveAspectRatio:"xMidYMid meet",children:[r.jsx("defs",{children:r.jsxs("linearGradient",{id:"trendGradientJr",x1:"0",y1:"0",x2:"0",y2:"1",children:[r.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),r.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),r.jsx("path",{d:$,fill:"url(#trendGradientJr)"}),r.jsx("path",{d:O,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),T.map((F,B)=>r.jsx("circle",{cx:F.x,cy:F.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},B))]}),r.jsx("div",{className:"pb-trend-labels",children:n.map((F,B)=>r.jsxs("span",{className:"pb-trend-label",children:[F.month.split("-")[1],"/",F.month.split("-")[0].slice(2)]},B))})]})}function hP(){const[n,e]=v.useState("bests"),[t,i]=v.useState([]),[l,u]=v.useState(!0),[d,p]=v.useState(!1),[g,y]=v.useState(0),[w,j]=v.useState(!1),[T,O]=v.useState(!1),[$,F]=v.useState(!1),[B,te]=v.useState({}),[K,ae]=v.useState({}),[be,ve]=v.useState({}),[_e,R]=v.useState({}),[E,A]=v.useState({}),[V,D]=v.useState(!1),[H,M]=v.useState({}),[$e,pt]=v.useState([]),[W,pe]=v.useState(null),[Ve,We]=v.useState(null),[ee,L]=v.useState(!1),[se,De]=v.useState(""),[Le,Qe]=v.useState(""),Fe=v.useRef(null),ft=v.useRef(0),jt=v.useRef(0),at=v.useRef("right"),Gt=v.useCallback(q=>{y(we=>{const Te=Math.max(0,Math.min(ma.length-1,q));return Te===we?we:(at.current=Te>we?"right":"left",Te)})},[]),{currentUser:_s,isClient:wt,clientData:gt,loading:le}=Mr(),{isDark:Xt}=ka(),Kt=$n(),ut=v.useCallback((q,we="info")=>{We({message:q,type:we}),setTimeout(()=>We(null),4e3)},[]);v.useEffect(()=>{!le&&(!_s||!wt)&&Kt("/")},[_s,wt,le,Kt]),v.useEffect(()=>{gt&&bt()},[gt]);const bt=async()=>{try{const q=Ds(zt(ge,"juniorPBs"),ds("clientId","==",gt.id)),Te=(await Ts(q)).docs.map(st=>({id:st.id,...st.data()}));Te.sort((st,vt)=>st.month.localeCompare(vt.month)),i(Te);const Ee=Ds(zt(ge,"juniorPBTargets"),ds("clientId","==",gt.id)),ke=await Ts(Ee);if(!ke.empty){const st=ke.docs[0].data();ve(st.targets||{}),R(st.metricTargets||{}),A(st.targets||{}),M(st.metricTargets||{})}const lt=Ds(zt(ge,"juniorAchievements"),ds("clientId","==",gt.id)),ht=await Ts(lt);ht.empty||pt(ht.docs[0].data().badges||[])}catch(q){console.error("Error fetching junior personal bests:",q)}u(!1)},Xe=lP(),rt=t.find(q=>q.month===Xe),qt=t.filter(q=>q.month<Xe),en=qt.length>0?qt[qt.length-1]:null;v.useEffect(()=>{rt?(te(rt.benchmarks||{}),ae(rt.bodyMetrics||{})):(te({}),ae({}))},[rt?.id]);const As=async(q,we)=>{const Te=[];if(q==="strength"?ma.forEach(Ee=>{const ke=be[Ee.key];if(!ke)return;const lt=we[Ee.key];if(!lt)return;let ht;if(ke.targetType==="time"){if(!ke.targetValue)return;const st=ke.startValue||0,vt=lt.time||0,It=ke.targetValue-st;ht=It===0?vt>=ke.targetValue?1:0:Math.max(0,(vt-st)/It)}else if(ke.targetType==="reps"){if(!ke.targetReps)return;const st=ke.startReps||0,vt=lt.reps||0,It=ke.targetReps-st;ht=It===0?vt>=ke.targetReps?1:0:Math.max(0,(vt-st)/It)}else if(ke.targetType==="distance"){if(!ke.targetDistance)return;const st=ke.startDistance||0,vt=lt.distance||0,It=ke.targetDistance-st;ht=It===0?vt>=ke.targetDistance?1:0:Math.max(0,(vt-st)/It)}else{if(!ke.targetWeight&&!ke.targetReps)return;const st=(ke.startWeight||0)*(ke.startReps||0),vt=(ke.targetWeight||0)*(ke.targetReps||0),It=(lt.weight||0)*(lt.reps||0),ks=vt-st;ht=ks===0?It>=vt?1:0:Math.max(0,(It-st)/ks)}if(ht>=1){let st,vt;ke.targetType==="time"?(st=$e.some(It=>It.type==="strength"&&It.key===Ee.key&&It.targetValue===ke.targetValue),vt=`${Ee.name} ${ke.targetValue}s`):ke.targetType==="reps"?(st=$e.some(It=>It.type==="strength"&&It.key===Ee.key&&It.targetReps===ke.targetReps),vt=`${Ee.name} ${ke.targetReps} reps`):ke.targetType==="distance"?(st=$e.some(It=>It.type==="strength"&&It.key===Ee.key&&It.targetDistance===ke.targetDistance),vt=`${Ee.name} ${ke.targetDistance}cm`):(st=$e.some(It=>It.type==="strength"&&It.key===Ee.key&&It.targetWeight===ke.targetWeight&&It.targetReps===ke.targetReps),vt=`${Ee.name} ${ke.targetWeight}kg  ${ke.targetReps}`),st||Te.push({type:"strength",key:Ee.key,...ke.targetType==="time"?{targetType:"time",targetValue:ke.targetValue}:ke.targetType==="reps"?{targetType:"reps",targetReps:ke.targetReps}:ke.targetType==="distance"?{targetType:"distance",targetDistance:ke.targetDistance}:{targetWeight:ke.targetWeight,targetReps:ke.targetReps},achievedMonth:Xe,label:vt})}}):Po.forEach(Ee=>{const ke=_e[Ee.key];if(!ke||!ke.targetValue)return;const lt=we[Ee.key];if(lt==null)return;const ht=ke.startValue||0,st=ke.targetValue,vt=st-ht;(vt===0?lt===st?1:0:Math.max(0,(lt-ht)/vt))>=1&&($e.some(mn=>mn.type==="metric"&&mn.key===Ee.key&&mn.targetValue===st)||Te.push({type:"metric",key:Ee.key,targetValue:st,achievedMonth:Xe,label:`${Ee.name} ${st}${Ee.suffix}`}))}),Te.length>0){const Ee=[...$e,...Te];await Es(ze(ge,"juniorAchievements",gt.id),{clientId:gt.id,badges:Ee,updatedAt:xt.now()}),pt(Ee),pe(Te),setTimeout(()=>pe(null),5e3)}},ts=(q,we)=>{if(q==="strength"){const Te=be[we];if(!Te)return!1;switch(ma.find(ke=>ke.key===we)?.unit){case"time":return $e.some(ke=>ke.type==="strength"&&ke.key===we&&ke.targetValue===Te.targetValue);case"reps":return $e.some(ke=>ke.type==="strength"&&ke.key===we&&ke.targetReps===Te.targetReps);case"distance":return $e.some(ke=>ke.type==="strength"&&ke.key===we&&ke.targetDistance===Te.targetDistance);default:return!Te.targetWeight&&!Te.targetReps?!1:$e.some(ke=>ke.type==="strength"&&ke.key===we&&ke.targetWeight===Te.targetWeight&&ke.targetReps===Te.targetReps)}}else{const Te=_e[we];return!Te||!Te.targetValue?!1:$e.some(Ee=>Ee.type==="metric"&&Ee.key===we&&Ee.targetValue===Te.targetValue)}},Ct=async()=>{p(!0);try{const q=`${gt.id}_${Xe}`,we=rt||{};await Es(ze(ge,"juniorPBs",q),{clientId:gt.id,month:Xe,benchmarks:B,bodyMetrics:we.bodyMetrics||K||{},createdAt:we.createdAt||xt.now(),updatedAt:xt.now()}),await As("strength",B),ut("Benchmarks saved!","success"),j(!1),await bt()}catch(q){console.error("Error saving benchmarks:",q),ut("Failed to save. Please try again.","error")}p(!1)},Jt=async()=>{p(!0);try{const q=`${gt.id}_${Xe}`,we=rt||{};await Es(ze(ge,"juniorPBs",q),{clientId:gt.id,month:Xe,benchmarks:we.benchmarks||B||{},bodyMetrics:K,createdAt:we.createdAt||xt.now(),updatedAt:xt.now()}),await As("metric",K),ut("Body metrics saved!","success"),O(!1),await bt()}catch(q){console.error("Error saving metrics:",q),ut("Failed to save. Please try again.","error")}p(!1)},Ss=(q,we,Te)=>{te(Ee=>({...Ee,[q]:{...Ee[q],[we]:Te===""?"":parseFloat(Te)}}))},Ot=(q,we)=>{ae(Te=>({...Te,[q]:we===""?"":parseFloat(we)}))},Ps=(q,we,Te)=>{A(Ee=>({...Ee,[q]:{...Ee[q],[we]:Te===""?"":parseFloat(Te)}}))},ue=async()=>{p(!0);try{const q=`targets_${gt.id}`,we=rt?.benchmarks||{},Te={};ma.forEach(Ee=>{const ke=we[Ee.key];switch(Ee.unit){case"time":E[Ee.key]?.targetValue&&(Te[Ee.key]={targetType:"time",targetValue:E[Ee.key].targetValue,startValue:ke?.time||0});break;case"reps":E[Ee.key]?.targetReps&&(Te[Ee.key]={targetType:"reps",targetReps:E[Ee.key].targetReps,startReps:ke?.reps||0});break;case"distance":E[Ee.key]?.targetDistance&&(Te[Ee.key]={targetType:"distance",targetDistance:E[Ee.key].targetDistance,startDistance:ke?.distance||0});break;default:(E[Ee.key]?.targetWeight||E[Ee.key]?.targetReps)&&(Te[Ee.key]={targetWeight:E[Ee.key].targetWeight||0,targetReps:E[Ee.key].targetReps||0,startWeight:ke?.weight||0,startReps:ke?.reps||0})}}),await Es(ze(ge,"juniorPBTargets",q),{clientId:gt.id,targets:Te,metricTargets:_e,updatedAt:xt.now()}),ve(Te),A(Te),ut("Targets saved!","success"),F(!1)}catch(q){console.error("Error saving targets:",q),ut("Failed to save targets.","error")}p(!1)},Se=(q,we)=>{M(Te=>({...Te,[q]:{...Te[q],targetValue:we===""?"":parseFloat(we)}}))},Ie=async()=>{p(!0);try{const q=`targets_${gt.id}`,we={};Po.forEach(Te=>{if(H[Te.key]?.targetValue){const Ee=rt?.bodyMetrics?.[Te.key]||0;we[Te.key]={targetValue:H[Te.key].targetValue,startValue:Ee}}}),await Es(ze(ge,"juniorPBTargets",q),{clientId:gt.id,targets:be,metricTargets:we,updatedAt:xt.now()}),R(we),M(we),ut("Metric targets saved!","success"),D(!1)}catch(q){console.error("Error saving metric targets:",q),ut("Failed to save targets.","error")}p(!1)},Ge=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){p(!0);try{const q=ze(ge,"juniorPBTargets",`targets_${gt.id}`);await yr(q),ve({}),R({}),A({}),M({}),ut("All goals have been reset","success")}catch(q){console.error("Error resetting targets:",q),ut("Failed to reset goals","error")}p(!1)}},X=(q,we)=>{const Te=be[q];if(!Te||!we)return null;if(Te.targetType==="time"){if(!Te.targetValue)return null;const st=Te.startValue||0,vt=Te.targetValue,It=we.time||0,ks=vt-st;return ks<=0?It>=vt?1:0:Math.max(0,Math.min((It-st)/ks,1))}if(Te.targetType==="reps"){if(!Te.targetReps)return null;const st=Te.startReps||0,vt=Te.targetReps,It=we.reps||0,ks=vt-st;return ks<=0?It>=vt?1:0:Math.max(0,Math.min((It-st)/ks,1))}if(Te.targetType==="distance"){if(!Te.targetDistance)return null;const st=Te.startDistance||0,vt=Te.targetDistance,It=we.distance||0,ks=vt-st;return ks<=0?It>=vt?1:0:Math.max(0,Math.min((It-st)/ks,1))}if(!Te.targetWeight&&!Te.targetReps)return null;const Ee=(Te.startWeight||0)*(Te.startReps||0),ke=(Te.targetWeight||0)*(Te.targetReps||0),lt=(we.weight||0)*(we.reps||0),ht=ke-Ee;return ht<=0?lt>=ke?1:0:Math.max(0,Math.min((lt-Ee)/ht,1))},he=q=>{const we=_e[q];if(!we||!we.targetValue)return null;const Te=rt?.bodyMetrics?.[q];if(Te==null)return null;const Ee=we.startValue||0,ke=we.targetValue,lt=ke-Ee;return lt===0?Te===ke?1:0:Math.max(0,Math.min((Te-Ee)/lt,1))},Pe=q=>{ft.current=q.touches[0].clientX,jt.current=0},qe=q=>{jt.current=q.touches[0].clientX-ft.current},Ae=()=>{jt.current<-50?Gt(g+1):jt.current>50&&Gt(g-1),jt.current=0},dt=q=>{const we=rt?.bodyMetrics?.[q],Te=en?.bodyMetrics?.[q];return we==null||Te==null?null:parseFloat((we-Te).toFixed(2))},Tt=t.find(q=>q.month===se),Q=t.find(q=>q.month===Le);if(le||l)return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsxs("main",{className:"pb-main",children:[r.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),r.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!_s||!wt||!gt)return null;const de=ma[g],tt=rt?.benchmarks?.[de.key],At=en?.benchmarks?.[de.key],Et=Ol(de,tt),ss=Ol(de,At),Ut=eg(Et,ss),Vt=X(de.key,tt),Ls=Vt!==null,Xs=Vt!==null&&Vt>=1,is=Ls?Math.round(Vt*60):Et>0?15:0,Ns=be[de.key],Os=q=>q?q.targetType==="time"?`${q.startValue||0}s  ${q.targetValue}s`:q.targetType==="reps"?`${q.startReps||0}  ${q.targetReps} reps`:q.targetType==="distance"?`${q.startDistance||0}  ${q.targetDistance}cm`:`${q.startWeight||0}kg${q.startReps||0}  ${q.targetWeight}kg${q.targetReps}`:null;return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>Kt("/client"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsxs("main",{className:"pb-main page-transition-enter",children:[r.jsxs("div",{className:"pb-intro",children:[r.jsx("h2",{children:"Junior Strength Tests"}),r.jsx("p",{children:"Track your strength test results and body measurements each month."})]}),r.jsxs("div",{className:"pb-tabs",children:[r.jsx("button",{className:`pb-tab ${n==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),r.jsx("button",{className:`pb-tab ${n==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),r.jsx("button",{className:`pb-tab ${n==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),n==="bests"&&r.jsxs("div",{className:"pb-strength-section",children:[!w&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-carousel",ref:Fe,onTouchStart:Pe,onTouchMove:qe,onTouchEnd:Ae,children:[r.jsx("div",{className:`pb-ring-container slide-from-${at.current}`,children:r.jsxs("div",{className:"pb-ring",children:[r.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:eb.map((q,we)=>{const Te=we<Math.round(is);return r.jsx("line",{x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,className:`pb-ring-tick ${Te?Xs?"hit":"filled":"empty"}`,strokeWidth:q.thick?"3":"2"},we)})}),r.jsxs("div",{className:"pb-ring-center",children:[r.jsx("div",{className:"pb-ring-category",children:de.category}),r.jsxs("div",{className:"pb-ring-exercise",children:[de.name,ts("strength",de.key)&&r.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),r.jsx("div",{className:"pb-ring-value",children:tt?hh(de,tt):"-"}),Ut!==null&&r.jsxs("div",{className:`pb-ring-change ${Ut>=0?"positive":"negative"}`,children:[Ut>=0?"+":"",Ut.toFixed(1),"%"]}),Ut===null&&tt&&r.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),Ns&&r.jsx("div",{className:`pb-ring-target ${Xs?"hit":""}`,children:Xs?"Target hit!":Os(Ns)}),!Ns&&r.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},g),r.jsx("div",{className:"pb-carousel-dots",children:ma.map((q,we)=>r.jsx("button",{className:`pb-dot ${we===g?"active":""}`,onClick:()=>Gt(we)},we))}),r.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>Gt(g-1),disabled:g===0,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),r.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>Gt(g+1),disabled:g===ma.length-1,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),r.jsxs("div",{className:"pb-trend-section",children:[r.jsx("h4",{children:"Trend"}),r.jsx(dP,{data:t,exerciseKey:de.key,unit:de.unit})]})]}),!w&&!$&&r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>j(!0),children:rt?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>F(!0),children:Object.keys(be).length>0?"Edit Targets":"Set Targets"}),(Object.keys(be).length>0||Object.keys(_e).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:Ge,disabled:d,children:"Reset All Goals"})]}),w&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Benchmarks - ",fa(Xe)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{j(!1),te(rt?.benchmarks||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:ma.map(q=>r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:q.name}),q.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:B[q.key]?.weight??"",onChange:we=>Ss(q.key,"weight",we.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",value:B[q.key]?.reps??"",onChange:we=>Ss(q.key,"reps",we.target.value),placeholder:"0"})]})]}):q.unit==="reps"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Reps (max in 1 min)"}),r.jsx("input",{type:"number",value:B[q.key]?.reps??"",onChange:we=>Ss(q.key,"reps",we.target.value),placeholder:"0"})]})}):q.unit==="distance"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Distance (cm)"}),r.jsx("input",{type:"number",step:"0.5",value:B[q.key]?.distance??"",onChange:we=>Ss(q.key,"distance",we.target.value),placeholder:"0"})]})}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Time (seconds)"}),r.jsx("input",{type:"number",step:"0.01",value:B[q.key]?.time??"",onChange:we=>Ss(q.key,"time",we.target.value),placeholder:"0"})]})})]},q.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{j(!1),te(rt?.benchmarks||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Ct,disabled:d,children:d?"Saving...":"Save"})]})]}),$&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Set Your Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{F(!1),A(be)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),ma.map(q=>{const we=rt?.benchmarks?.[q.key];let Te="-";if(we)switch(q.unit){case"weight":(we.weight||we.reps)&&(Te=`${we.weight||0}kg  ${we.reps||0}`);break;case"time":we.time&&(Te=`${we.time}s`);break;case"reps":we.reps&&(Te=`${we.reps} reps`);break;case"distance":we.distance&&(Te=`${we.distance} cm`);break}return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:q.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",Te]})]}),q.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:E[q.key]?.targetWeight??"",onChange:Ee=>Ps(q.key,"targetWeight",Ee.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Reps"}),r.jsx("input",{type:"number",value:E[q.key]?.targetReps??"",onChange:Ee=>Ps(q.key,"targetReps",Ee.target.value),placeholder:"0"})]})]}):q.unit==="reps"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target Reps (in 1 min)"}),r.jsx("input",{type:"number",value:E[q.key]?.targetReps??"",onChange:Ee=>Ps(q.key,"targetReps",Ee.target.value),placeholder:"0"})]})}):q.unit==="distance"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target Distance (cm)"}),r.jsx("input",{type:"number",step:"0.5",value:E[q.key]?.targetDistance??"",onChange:Ee=>Ps(q.key,"targetDistance",Ee.target.value),placeholder:"0"})]})}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target (seconds)"}),r.jsx("input",{type:"number",step:"1",value:E[q.key]?.targetValue??"",onChange:Ee=>Ps(q.key,"targetValue",Ee.target.value),placeholder:"0"})]})})]},q.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{F(!1),A(be)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:ue,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="metrics"&&r.jsxs("div",{className:"pb-metrics-section",children:[!T&&!V&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-metrics-card",children:[r.jsx("h3",{children:"Body Measurements"}),r.jsx("p",{className:"pb-metrics-month",children:fa(Xe)}),r.jsx("div",{className:"pb-metrics-list",children:Po.map(q=>{const we=rt?.bodyMetrics?.[q.key],Te=dt(q.key),Ee=_e[q.key],ke=he(q.key),lt=ke!==null&&ke>=1;return r.jsxs("div",{className:"pb-metric-row",children:[r.jsxs("div",{className:"pb-metric-top",children:[r.jsxs("div",{className:"pb-metric-left",children:[r.jsxs("span",{className:"pb-metric-name",children:[q.name,ts("metric",q.key)&&r.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),Ee&&r.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",Ee.targetValue," ",q.suffix]})]}),r.jsxs("div",{className:"pb-metric-values",children:[r.jsx("span",{className:"pb-metric-current",children:we!=null?`${we} ${q.suffix}`:"-"}),Te!==null&&r.jsxs("span",{className:`pb-metric-change ${Te>0?"up":Te<0?"down":"same"}`,children:[Te>0?"+":"",Te," ",q.suffix]})]})]}),ke!==null&&r.jsxs("div",{className:"pb-metric-progress",children:[r.jsx("div",{className:"pb-metric-bar",children:r.jsx("div",{className:`pb-metric-bar-fill ${lt?"hit":""}`,style:{width:`${Math.round(ke*100)}%`}})}),r.jsx("span",{className:`pb-metric-percent ${lt?"hit":""}`,children:lt?"Hit!":`${Math.round(ke*100)}%`})]})]},q.key)})})]}),r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>O(!0),children:rt?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>D(!0),children:Object.keys(_e).length>0?"Edit Targets":"Set Targets"}),(Object.keys(be).length>0||Object.keys(_e).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:Ge,disabled:d,children:"Reset All Goals"})]})]}),T&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Measurements - ",fa(Xe)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{O(!1),ae(rt?.bodyMetrics||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:Po.map(q=>r.jsx("div",{className:"pb-edit-metric",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:[q.name," (",q.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:K[q.key]??"",onChange:we=>Ot(q.key,we.target.value),placeholder:"0"})]})},q.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{O(!1),ae(rt?.bodyMetrics||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Jt,disabled:d,children:d?"Saving...":"Save"})]})]}),V&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Body Metric Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{D(!1),M(_e)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),Po.map(q=>{const we=rt?.bodyMetrics?.[q.key];return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:q.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",we!=null?`${we} ${q.suffix}`:"-"]})]}),r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:["Target (",q.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:H[q.key]?.targetValue??"",onChange:Te=>Se(q.key,Te.target.value),placeholder:"0"})]})})]},q.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{D(!1),M(_e)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Ie,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="history"&&r.jsx("div",{className:"pb-history-section",children:t.length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("h4",{children:"No records yet"}),r.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):r.jsxs(r.Fragment,{children:[$e.length>0&&r.jsxs("div",{className:"pb-achievements-wall",children:[r.jsxs("h4",{className:"pb-achievements-wall-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),r.jsx("div",{className:"pb-achievements-list",children:[...$e].reverse().map((q,we)=>r.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${we*.05}s`},children:[r.jsx("div",{className:"pb-achievement-star",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("div",{className:"pb-achievement-info",children:[r.jsx("span",{className:"pb-achievement-label",children:q.label}),r.jsx("span",{className:"pb-achievement-date",children:fa(q.achievedMonth)})]})]},we))})]}),r.jsx("div",{className:"pb-history-controls",children:r.jsx("button",{className:`pb-compare-toggle ${ee?"active":""}`,onClick:()=>{L(!ee),!ee&&t.length>=2&&(De(t[0].month),Qe(t[t.length-1].month))},children:ee?"Back to Timeline":"Compare Months"})}),ee?r.jsxs("div",{className:"pb-compare",children:[r.jsxs("div",{className:"pb-compare-selectors",children:[r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"From"}),r.jsx("select",{value:se,onChange:q=>De(q.target.value),children:t.map(q=>r.jsx("option",{value:q.month,children:fa(q.month)},q.month))})]}),r.jsx("div",{className:"pb-compare-vs",children:"vs"}),r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"To"}),r.jsx("select",{value:Le,onChange:q=>Qe(q.target.value),children:t.map(q=>r.jsx("option",{value:q.month,children:fa(q.month)},q.month))})]})]}),Tt&&Q&&r.jsxs("div",{className:"pb-compare-results",children:[r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Strength Tests"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Exercise"}),r.jsx("span",{children:fa(se).split(" ")[0]}),r.jsx("span",{children:fa(Le).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),ma.map(q=>{const we=Tt.benchmarks?.[q.key],Te=Q.benchmarks?.[q.key],Ee=Ol(q,we),ke=Ol(q,Te),lt=eg(ke,Ee);return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:q.name}),r.jsx("span",{className:"pb-compare-val",children:we?hh(q,we):"-"}),r.jsx("span",{className:"pb-compare-val",children:Te?hh(q,Te):"-"}),r.jsx("span",{className:`pb-compare-change ${lt!==null?lt>=0?"positive":"negative":""}`,children:lt!==null?`${lt>=0?"+":""}${lt.toFixed(1)}%`:"-"})]},q.key)})]})]}),r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Body Measurements"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Measurement"}),r.jsx("span",{children:fa(se).split(" ")[0]}),r.jsx("span",{children:fa(Le).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),Po.map(q=>{const we=Tt.bodyMetrics?.[q.key],Te=Q.bodyMetrics?.[q.key],Ee=we!=null&&Te!=null?parseFloat((Te-we).toFixed(2)):null;return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:q.name}),r.jsx("span",{className:"pb-compare-val",children:we!=null?`${we}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:Te!=null?`${Te}`:"-"}),r.jsx("span",{className:`pb-compare-change ${Ee!==null?Ee>0?"positive":Ee<0?"negative":"neutral":""}`,children:Ee!==null?`${Ee>0?"+":""}${Ee} ${q.suffix}`:"-"})]},q.key)})]})]})]})]}):r.jsx("div",{className:"pb-timeline",children:[...t].reverse().map((q,we)=>{const Te=t.filter(Ee=>Ee.month<q.month).pop();return r.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${we*.05}s`},children:[r.jsx("div",{className:"pb-timeline-dot"}),r.jsxs("div",{className:"pb-timeline-card",children:[r.jsx("h4",{children:fa(q.month)}),q.benchmarks&&Object.keys(q.benchmarks).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Strength Tests"}),ma.map(Ee=>{const ke=q.benchmarks[Ee.key];if(!ke)return null;const lt=Te?.benchmarks?.[Ee.key],ht=Ol(Ee,ke),st=Ol(Ee,lt),vt=eg(ht,st);return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:Ee.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsx("span",{className:"pb-timeline-value",children:hh(Ee,ke)}),vt!==null&&r.jsxs("span",{className:`pb-timeline-change ${vt>=0?"positive":"negative"}`,children:[vt>=0?"+":"",vt.toFixed(1),"%"]})]})]},Ee.key)})]}),q.bodyMetrics&&Object.keys(q.bodyMetrics).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Body Measurements"}),Po.map(Ee=>{const ke=q.bodyMetrics[Ee.key];if(ke==null)return null;const lt=Te?.bodyMetrics?.[Ee.key],ht=lt!=null?parseFloat((ke-lt).toFixed(2)):null;return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:Ee.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsxs("span",{className:"pb-timeline-value",children:[ke," ",Ee.suffix]}),ht!==null&&r.jsxs("span",{className:`pb-timeline-change ${ht>0?"positive":ht<0?"negative":"neutral"}`,children:[ht>0?"+":"",ht," ",Ee.suffix]})]})]},Ee.key)})]})]})]},q.id)})})]})})]}),W&&r.jsx("div",{className:"pb-celebration-overlay",onClick:()=>pe(null),children:r.jsxs("div",{className:"pb-celebration-card",children:[r.jsx("div",{className:"pb-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pb-celebration-title",children:W.length===1?"Target Achieved!":`${W.length} Targets Achieved!`}),r.jsx("div",{className:"pb-celebration-badges",children:W.map((q,we)=>r.jsx("div",{className:"pb-celebration-badge",children:q.label},we))}),r.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),Ve&&r.jsxs("div",{className:`toast-notification ${Ve.type}`,children:[r.jsx("span",{className:"toast-icon",children:Ve.type==="success"?r.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),r.jsx("span",{className:"toast-message",children:Ve.message}),r.jsx("button",{className:"toast-close",onClick:()=>We(null),children:""})]}),r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:"block-nav-tab",onClick:()=>Kt("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),r.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),r.jsx("span",{children:"Home"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>Kt("/client/forms"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),r.jsx("polyline",{points:"14 2 14 8 20 8"}),r.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),r.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),r.jsx("span",{children:"Forms"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>Kt("/client/tools"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),r.jsx("span",{children:"Tools"})]}),r.jsxs("button",{className:"block-nav-tab active",children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20V10"}),r.jsx("path",{d:"M18 20V4"}),r.jsx("path",{d:"M6 20v-4"})]}),r.jsx("span",{children:"PBs"})]}),gt?.circuitAccess&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>Kt("/client/circuit"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 6v6l4 2"})]}),r.jsx("span",{children:"Circuit"})]})]})]})}const zk=[{name:"Dumbbell Floor Press",type:"weighted",equipment:"dumbbells",group:"push",pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",equipment:"dumbbells",group:"push",pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Tricep Dips",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Pike Push Ups",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/pike push ups.GIF"},{name:"Reverse Plank",type:"timed",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/reverse plank.GIF"},{name:"Dumbbell Squeeze Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Pullover",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Fly",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Tricep Kickback",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Shrug",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Y-Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Wide Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Diamond Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Decline Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Wall Walks",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Press Up Hold",type:"timed",equipment:"bodyweight",group:"push",storagePath:null},{name:"Shoulder Tap Hold",type:"timed",equipment:"bodyweight",group:"push",storagePath:null},{name:"Dumbbell Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Bicep Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Renegade Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Reverse Fly",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Concentration Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Wrist Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Reverse Snow Angel",type:"reps",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Isometric Bicep Hold",type:"timed",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Dumbbell Goblet Squats",type:"weighted",equipment:"dumbbells",group:"lower",pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Romanian Deadlifts",type:"weighted",equipment:"dumbbells",group:"lower",pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Sumo Squats",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"1 Legged RDL",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/1 legged rdl.GIF"},{name:"Dumbbell Box Step Ups",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.GIF"},{name:"Dumbbell Reverse Lunges",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.GIF"},{name:"Kettlebell Romanian Deadlift",type:"weighted",equipment:"kettlebell",group:"lower",storagePath:"exercises/kettlebells/lower/kettlebell romanian deadlift.mp4"},{name:"Reverse Lunge",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/reverse lunge.GIF"},{name:"Box Step Ups",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/box step ups.GIF"},{name:"Bulgarian Split Squats",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Jump Squats",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Hip Thrusts",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/hip thrusts.GIF"},{name:"Donkey Kicks",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/donkey kicks.GIF"},{name:"Skater Jumps",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/skater jumps.GIF"},{name:"Squat And Hold",type:"timed",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/squat and hold.GIF"},{name:"Forearm Plank",type:"timed",equipment:"bodyweight",group:"core",pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Side Plank",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Side Plank.mp4"},{name:"Hollow Body Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Superman Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Superman Hold.mp4"},{name:"Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Fast Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Fast Mountain Climbers.mp4"},{name:"Cross Body Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Russian Twist",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Crunch",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Bicycle Crunch",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Leg Raises",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Dead Bug",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Dead Bug Single Leg Drop",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Bird Dog",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Flutter Kicks",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Hollow Hold Flutter Kicks",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"},{name:"High Plank Shoulder Taps",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"},{name:"Hip Dips Plank",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Single Leg V-Up",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Single Leg V-Up.mp4"},{name:"Hollow Hold To V-Sit",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"},{name:"Toe Reaches",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/toe reaches.GIF"},{name:"Side Plank Rotation",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Plank Walkout",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Russian Twists Dumbbell",type:"weighted",equipment:"dumbbells",group:"core",storagePath:"exercises/dumbbells/core/russian twists dumbbell.GIF"},{name:"Kettlebell Russian Twist",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",type:"reps",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Back Extension Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:null},{name:"Dumbbell Plank Pull Through",type:"weighted",equipment:"dumbbells",group:"core",storagePath:null}];zk.filter(n=>n.storagePath!==null);const mP=[{key:"push",label:"Push",subtitle:"Chest / Shoulders / Triceps",color:"#A12F3A",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4"},{key:"pull",label:"Pull",subtitle:"Back / Biceps",color:"#2196f3",icon:"M4 12h16M12 4v16M7 7l10 10M17 7L7 17"},{key:"lower",label:"Lower",subtitle:"Legs / Glutes",color:"#ff9800",icon:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"},{key:"core",label:"Core",subtitle:"Abs / Stability",color:"#7c3aed",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"}],qk={};zk.forEach(n=>{qk[n.name]=n.group});function fP(n){return qk[n]||null}const Aa=[{key:"chestPress",name:"Chest Press",category:"Upper Body - Push",unit:"weight"},{key:"shoulderPress",name:"Shoulder Press",category:"Upper Body - Push",unit:"weight"},{key:"seatedRow",name:"Seated Row",category:"Upper Body - Pull",unit:"weight"},{key:"latPulldown",name:"Lat Pulldown",category:"Upper Body - Pull",unit:"weight"},{key:"squat",name:"Squat",category:"Lower Body",unit:"weight"},{key:"deadlift",name:"Deadlift",category:"Lower Body",unit:"weight"},{key:"plank",name:"Plank",category:"Core",unit:"time"}],Lo=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function pP(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}function pa(n){const[e,t]=n.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function mh(n){if(!n&&n!==0)return"-";const e=Math.floor(n/60),t=(n%60).toFixed(2);return e>0?`${e}m ${parseFloat(t).toFixed(0)}s`:`${parseFloat(t).toFixed(2)}s`}function I2(n,e){return!n&&n!==0?"-":!e&&e!==0?`${n}kg`:`${n}kg x ${e}`}function Vl(n,e){return e?n.unit==="time"?e.time||0:(e.weight||0)*(e.reps||0):0}function tg(n,e){return!e||e===0?null:(n-e)/e*100}function gP({data:n,exerciseKey:e,unit:t}){if(!n||n.length<2)return r.jsx("div",{className:"pb-trend-empty",children:r.jsx("p",{children:"Not enough data for trend line yet"})});const i=n.map(F=>{const B=F.benchmarks?.[e];return B?t==="time"?B.time||0:(B.weight||0)*(B.reps||0):0}),l=Math.max(...i),u=Math.min(...i),d=l-u||1,p=300,g=100,y=20,w=p-y*2,j=g-y*2,T=i.map((F,B)=>{const te=y+B/(i.length-1)*w,K=y+j-(F-u)/d*j;return{x:te,y:K,value:F}}),O=T.map((F,B)=>`${B===0?"M":"L"} ${F.x} ${F.y}`).join(" "),$=O+` L ${T[T.length-1].x} ${y+j} L ${T[0].x} ${y+j} Z`;return r.jsxs("div",{className:"pb-trend-chart",children:[r.jsxs("svg",{viewBox:`0 0 ${p} ${g}`,preserveAspectRatio:"xMidYMid meet",children:[r.jsx("defs",{children:r.jsxs("linearGradient",{id:"trendGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[r.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),r.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),r.jsx("path",{d:$,fill:"url(#trendGradient)"}),r.jsx("path",{d:O,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),T.map((F,B)=>r.jsx("circle",{cx:F.x,cy:F.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},B))]}),r.jsx("div",{className:"pb-trend-labels",children:n.map((F,B)=>r.jsxs("span",{className:"pb-trend-label",children:[F.month.split("-")[1],"/",F.month.split("-")[0].slice(2)]},B))})]})}function yP(){const[n,e]=v.useState("bests"),[t,i]=v.useState([]),[l,u]=v.useState(!0),[d,p]=v.useState(!1),[g,y]=v.useState(0),[w,j]=v.useState(!1),[T,O]=v.useState(!1),[$,F]=v.useState(!1),[B,te]=v.useState({}),[K,ae]=v.useState({}),[be,ve]=v.useState({}),[_e,R]=v.useState({}),[E,A]=v.useState({}),[V,D]=v.useState(!1),[H,M]=v.useState({}),[$e,pt]=v.useState([]),[W,pe]=v.useState(null),[Ve,We]=v.useState(null),[ee,L]=v.useState(!1),[se,De]=v.useState(""),[Le,Qe]=v.useState(""),[Fe,ft]=v.useState({}),[jt,at]=v.useState({}),[Gt,_s]=v.useState(null),[wt,gt]=v.useState(null),[le,Xt]=v.useState(""),[Kt,ut]=v.useState({}),bt=v.useRef(null),Xe=v.useRef(0),rt=v.useRef(0),qt=v.useRef("right"),en=v.useCallback(k=>{y(N=>{const P=Math.max(0,Math.min(Aa.length-1,k));return P===N?N:(qt.current=P>N?"right":"left",P)})},[]),{currentUser:As,isClient:ts,clientData:Ct,loading:Jt}=Mr(),{isDark:Ss}=ka(),Ot=$n(),[Ps]=iS(),ue=Ps.get("mode")==="corebuddy",Se=!ue&&(!Ct?.clientType||Ct.clientType==="block"),Ie=v.useCallback((k,N="info")=>{We({message:k,type:N}),setTimeout(()=>We(null),4e3)},[]);v.useEffect(()=>{!Jt&&(!As||!ts)&&Ot("/")},[As,ts,Jt,Ot]),v.useEffect(()=>{Ct&&(Se?Ge():(async()=>{try{const[N,P,U]=await Promise.all([Rs(ze(ge,"coreBuddyPBs",Ct.id)),Rs(ze(ge,"coreBuddyTargets",Ct.id)),Rs(ze(ge,"coreBuddyAchievements",Ct.id))]);N.exists()&&ft(N.data().exercises||{}),P.exists()&&at(P.data().targets||{}),U.exists()&&_s(U.data())}catch(N){console.error("Error loading Core Buddy PBs:",N)}u(!1)})())},[Ct]);const Ge=async()=>{try{const k=Ds(zt(ge,"personalBests"),ds("clientId","==",Ct.id)),P=(await Ts(k)).docs.map(Je=>({id:Je.id,...Je.data()}));P.sort((Je,Ze)=>Je.month.localeCompare(Ze.month)),i(P);const U=Ds(zt(ge,"personalBestTargets"),ds("clientId","==",Ct.id)),me=await Ts(U);if(!me.empty){const Je=me.docs[0].data();ve(Je.targets||{}),R(Je.metricTargets||{}),A(Je.targets||{}),M(Je.metricTargets||{})}const Be=Ds(zt(ge,"achievements"),ds("clientId","==",Ct.id)),Ue=await Ts(Be);Ue.empty||pt(Ue.docs[0].data().badges||[])}catch(k){console.error("Error fetching personal bests:",k)}u(!1)},X=async()=>{if(!wt||!le||!Ct)return;const k=parseFloat(le),N=Fe[wt];if(!N||k<=N.weight){Ie("Target must be higher than current PB","error");return}p(!0);try{const P={...jt,[wt]:{targetWeight:k,setAt:xt.now(),currentPBWhenSet:N.weight}};await Es(ze(ge,"coreBuddyTargets",Ct.id),{clientId:Ct.id,targets:P,updatedAt:xt.now()}),at(P),gt(null),Xt(""),Ie("Target set!","success")}catch(P){console.error("Error saving target:",P),Ie("Failed to save target","error")}p(!1)},he=k=>{if(!Gt?.badges)return!1;const N=jt[k];return N?Gt.badges.some(P=>P.type==="pb_target"&&P.exercise===k&&P.targetWeight===N.targetWeight):!1},Pe=k=>{const N=jt[k];if(!N)return null;const P=Fe[k];if(!P)return 0;const U=N.currentPBWhenSet||0,me=N.targetWeight,Be=me-U;return Be<=0?P.weight>=me?1:0:Math.max(0,Math.min((P.weight-U)/Be,1))},qe=pP(),Ae=t.find(k=>k.month===qe),dt=t.filter(k=>k.month<qe),Tt=dt.length>0?dt[dt.length-1]:null;v.useEffect(()=>{Ae?(te(Ae.benchmarks||{}),ae(Ae.bodyMetrics||{})):(te({}),ae({}))},[Ae?.id]);const Q=async(k,N)=>{const P=[];if(k==="strength"?Aa.forEach(U=>{const me=be[U.key];if(!me)return;const Be=N[U.key];if(!Be)return;let Ue;if(me.targetType==="time"){if(!me.targetValue)return;const Je=me.startValue||0,Ze=Be.time||0,Ht=me.targetValue-Je;Ue=Ht===0?Ze>=me.targetValue?1:0:Math.max(0,(Ze-Je)/Ht)}else{if(!me.targetWeight&&!me.targetReps)return;const Je=(me.startWeight||0)*(me.startReps||0),Ze=(me.targetWeight||0)*(me.targetReps||0),Ht=(Be.weight||0)*(Be.reps||0),bs=Ze-Je;Ue=bs===0?Ht>=Ze?1:0:Math.max(0,(Ht-Je)/bs)}if(Ue>=1&&!(me.targetType==="time"?$e.some(Ze=>Ze.type==="strength"&&Ze.key===U.key&&Ze.targetValue===me.targetValue):$e.some(Ze=>Ze.type==="strength"&&Ze.key===U.key&&Ze.targetWeight===me.targetWeight&&Ze.targetReps===me.targetReps))){const Ze=me.targetType==="time"?`${U.name} ${me.targetValue}s`:`${U.name} ${me.targetWeight}kg  ${me.targetReps}`;P.push({type:"strength",key:U.key,...me.targetType==="time"?{targetType:"time",targetValue:me.targetValue}:{targetWeight:me.targetWeight,targetReps:me.targetReps},achievedMonth:qe,label:Ze})}}):Lo.forEach(U=>{const me=_e[U.key];if(!me||!me.targetValue)return;const Be=N[U.key];if(Be==null)return;const Ue=me.startValue||0,Je=me.targetValue,Ze=Je-Ue;(Ze===0?Be===Je?1:0:Math.max(0,(Be-Ue)/Ze))>=1&&($e.some(os=>os.type==="metric"&&os.key===U.key&&os.targetValue===Je)||P.push({type:"metric",key:U.key,targetValue:Je,achievedMonth:qe,label:`${U.name} ${Je}${U.suffix}`}))}),P.length>0){const U=[...$e,...P];await Es(ze(ge,"achievements",Ct.id),{clientId:Ct.id,badges:U,updatedAt:xt.now()}),pt(U),pe(P),setTimeout(()=>pe(null),5e3)}},de=(k,N)=>{if(k==="strength"){const P=be[N];return P?P.targetType==="time"?$e.some(U=>U.type==="strength"&&U.key===N&&U.targetValue===P.targetValue):!P.targetWeight&&!P.targetReps?!1:$e.some(U=>U.type==="strength"&&U.key===N&&U.targetWeight===P.targetWeight&&U.targetReps===P.targetReps):!1}else{const P=_e[N];return!P||!P.targetValue?!1:$e.some(U=>U.type==="metric"&&U.key===N&&U.targetValue===P.targetValue)}},tt=async()=>{p(!0);try{const k=`${Ct.id}_${qe}`,N=Ae||{};await Es(ze(ge,"personalBests",k),{clientId:Ct.id,month:qe,benchmarks:B,bodyMetrics:N.bodyMetrics||K||{},createdAt:N.createdAt||xt.now(),updatedAt:xt.now()}),await Q("strength",B),Ie("Benchmarks saved!","success"),j(!1),await Ge()}catch(k){console.error("Error saving benchmarks:",k),Ie("Failed to save. Please try again.","error")}p(!1)},At=async()=>{p(!0);try{const k=`${Ct.id}_${qe}`,N=Ae||{};await Es(ze(ge,"personalBests",k),{clientId:Ct.id,month:qe,benchmarks:N.benchmarks||B||{},bodyMetrics:K,createdAt:N.createdAt||xt.now(),updatedAt:xt.now()}),await Q("metric",K),Ie("Body metrics saved!","success"),O(!1),await Ge()}catch(k){console.error("Error saving metrics:",k),Ie("Failed to save. Please try again.","error")}p(!1)},Et=(k,N,P)=>{te(U=>({...U,[k]:{...U[k],[N]:P===""?"":parseFloat(P)}}))},ss=(k,N)=>{ae(P=>({...P,[k]:N===""?"":parseFloat(N)}))},Ut=(k,N,P)=>{A(U=>({...U,[k]:{...U[k],[N]:P===""?"":parseFloat(P)}}))},Vt=async()=>{p(!0);try{const k=`targets_${Ct.id}`,N=Ae?.benchmarks||{},P={};Aa.forEach(U=>{const me=N[U.key];U.unit==="time"?E[U.key]?.targetValue&&(P[U.key]={targetType:"time",targetValue:E[U.key].targetValue,startValue:me?.time||0}):(E[U.key]?.targetWeight||E[U.key]?.targetReps)&&(P[U.key]={targetWeight:E[U.key].targetWeight||0,targetReps:E[U.key].targetReps||0,startWeight:me?.weight||0,startReps:me?.reps||0})}),await Es(ze(ge,"personalBestTargets",k),{clientId:Ct.id,targets:P,metricTargets:_e,updatedAt:xt.now()}),ve(P),A(P),Ie("Targets saved!","success"),F(!1)}catch(k){console.error("Error saving targets:",k),Ie("Failed to save targets.","error")}p(!1)},Ls=(k,N)=>{M(P=>({...P,[k]:{...P[k],targetValue:N===""?"":parseFloat(N)}}))},Xs=async()=>{p(!0);try{const k=`targets_${Ct.id}`,N={};Lo.forEach(P=>{if(H[P.key]?.targetValue){const U=Ae?.bodyMetrics?.[P.key]||0;N[P.key]={targetValue:H[P.key].targetValue,startValue:U}}}),await Es(ze(ge,"personalBestTargets",k),{clientId:Ct.id,targets:be,metricTargets:N,updatedAt:xt.now()}),R(N),M(N),Ie("Metric targets saved!","success"),D(!1)}catch(k){console.error("Error saving metric targets:",k),Ie("Failed to save targets.","error")}p(!1)},is=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){p(!0);try{const k=ze(ge,"personalBestTargets",`targets_${Ct.id}`);await yr(k),ve({}),R({}),A({}),M({}),Ie("All goals have been reset","success")}catch(k){console.error("Error resetting targets:",k),Ie("Failed to reset goals","error")}p(!1)}},Ns=(k,N)=>{const P=be[k];if(!P||!N)return null;if(P.targetType==="time"){if(!P.targetValue)return null;const Je=P.startValue||0,Ze=P.targetValue,Ht=N.time||0,bs=Ze-Je;return bs<=0?Ht>=Ze?1:0:Math.max(0,Math.min((Ht-Je)/bs,1))}if(!P.targetWeight&&!P.targetReps)return null;const U=(P.startWeight||0)*(P.startReps||0),me=(P.targetWeight||0)*(P.targetReps||0),Be=(N.weight||0)*(N.reps||0),Ue=me-U;return Ue<=0?Be>=me?1:0:Math.max(0,Math.min((Be-U)/Ue,1))},Os=k=>{const N=_e[k];if(!N||!N.targetValue)return null;const P=Ae?.bodyMetrics?.[k];if(P==null)return null;const U=N.startValue||0,me=N.targetValue,Be=me-U;return Be===0?P===me?1:0:Math.max(0,Math.min((P-U)/Be,1))},q=k=>{Xe.current=k.touches[0].clientX,rt.current=0},we=k=>{rt.current=k.touches[0].clientX-Xe.current},Te=()=>{rt.current<-50?en(g+1):rt.current>50&&en(g-1),rt.current=0},Ee=k=>{const N=Ae?.bodyMetrics?.[k],P=Tt?.bodyMetrics?.[k];return N==null||P==null?null:parseFloat((N-P).toFixed(2))},ke=t.find(k=>k.month===se),lt=t.find(k=>k.month===Le);if(Jt||l)return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsxs("main",{className:"pb-main",children:[r.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),r.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!As||!ts||!Ct)return null;if(Se&&Ct?.isJunior)return r.jsx(hP,{});const ht=Aa[g],st=Ae?.benchmarks?.[ht.key],vt=Tt?.benchmarks?.[ht.key],It=Vl(ht,st),ks=Vl(ht,vt),mn=tg(It,ks),ln=Ns(ht.key,st),_n=ln!==null,kn=ln!==null&&ln>=1,fn=_n?Math.round(ln*60):It>0?15:0,Fs=be[ht.key];return r.jsx(xa,{children:r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>Ot(ue?"/client/core-buddy":"/client"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsxs("main",{className:"pb-main page-transition-enter",children:[r.jsxs("div",{className:"pb-intro anim-fade-up",children:[r.jsx("h2",{children:"Personal Bests"}),r.jsx("p",{children:Se?"Track your strength benchmarks and body measurements each month.":"Your all-time best lifts from programme workouts."})]}),!Se&&r.jsxs("div",{className:"pb-cb-section anim-fade-up-d2",children:[Object.keys(Fe).length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("div",{className:"pb-cb-empty-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})}),r.jsx("h4",{children:"No personal bests yet"}),r.jsx("p",{children:"Complete weight-based workouts to start tracking your personal bests."})]}):r.jsx("div",{className:"pb-cb-grouped",children:(()=>{const k={},N=[];return Object.entries(Fe).forEach(([P,U])=>{const me=fP(P);me?(k[me]||(k[me]=[]),k[me].push([P,U])):N.push([P,U])}),Object.values(k).forEach(P=>P.sort(([U],[me])=>U.localeCompare(me))),N.sort(([P],[U])=>P.localeCompare(U)),r.jsxs(r.Fragment,{children:[mP.map(P=>{const U=k[P.key];if(!U||U.length===0)return null;const me=!!Kt[P.key],Be=U.reduce((Ue,[,Je])=>!Ue||Je.weight>Ue.weight?Je:Ue,null);return r.jsxs("div",{className:`pb-cb-group ${me?"open":""}`,style:{"--group-color":P.color},children:[r.jsxs("button",{className:"pb-cb-group-header",onClick:()=>ut(Ue=>({...Ue,[P.key]:!Ue[P.key]})),children:[r.jsx("div",{className:"pb-cb-group-accent"}),r.jsx("div",{className:"pb-cb-group-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:P.icon})})}),r.jsxs("div",{className:"pb-cb-group-text",children:[r.jsx("h3",{className:"pb-cb-group-label",children:P.label}),r.jsx("span",{className:"pb-cb-group-subtitle",children:P.subtitle})]}),r.jsxs("div",{className:"pb-cb-group-meta",children:[r.jsxs("span",{className:"pb-cb-group-count",children:[U.length," PB",U.length!==1?"s":""]}),Be&&r.jsxs("span",{className:"pb-cb-group-best",children:["Best: ",Be.weight,"kg"]})]}),r.jsx("svg",{className:`pb-cb-group-chevron ${me?"open":""}`,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M6 9l6 6 6-6"})})]}),r.jsx("div",{className:"pb-cb-group-body",style:{display:me?"block":"none"},children:r.jsx("div",{className:"pb-cb-grid",children:U.map(([Ue,Je],Ze)=>{const Ht=jt[Ue],bs=Pe(Ue),os=bs!==null&&bs>=1,ls=he(Ue),Cs=bs!==null?Math.round(bs*60):60;return r.jsxs("div",{className:"pb-cb-card",style:{"--group-color":P.color,animationDelay:`${Ze*.05}s`},children:[r.jsxs("div",{className:"pb-cb-card-top",children:[r.jsxs("div",{className:"pb-cb-card-ring",children:[r.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:k2.map((Y,xe)=>{const ne=xe<Cs;return r.jsx("line",{x1:Y.x1,y1:Y.y1,x2:Y.x2,y2:Y.y2,className:`pb-ring-tick ${ne?os?"hit":"filled":"empty"}`,style:ne&&!os?{stroke:P.color}:void 0,strokeWidth:Y.thick?"2":"1.5"},xe)})}),r.jsx("div",{className:"pb-cb-ring-icon",style:{color:P.color},children:ls?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"pb-cb-badge-earned",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:P.icon})})})]}),r.jsxs("div",{className:"pb-cb-card-info",children:[r.jsx("h4",{className:"pb-cb-card-name",children:Ue}),r.jsxs("div",{className:"pb-cb-card-value",style:{color:P.color},children:[Je.weight,"kg  ",Je.reps]}),Je.achievedAt&&r.jsx("div",{className:"pb-cb-card-date",children:(Je.achievedAt.toDate?Je.achievedAt.toDate():new Date(Je.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),Ht&&os&&!ls&&r.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"}),ls&&r.jsx("div",{className:"pb-cb-target-info earned",children:"Badge earned!"})]}),r.jsx("div",{className:"pb-cb-card-action",children:r.jsx("button",{className:"pb-cb-target-btn",style:{borderColor:P.color,background:`color-mix(in srgb, ${P.color} 10%, transparent)`,color:P.color},onClick:()=>{gt(Ue),Xt("")},children:Ht?os&&ls?r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 5v14M5 12h14"})}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("circle",{cx:"12",cy:"12",r:"6"}),r.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]}),Ht&&!os&&r.jsxs("div",{className:"pb-cb-card-progress",children:[r.jsxs("div",{className:"pb-cb-progress-labels",children:[r.jsxs("span",{className:"pb-cb-progress-current",children:[Je.weight,"kg"]}),r.jsxs("span",{className:"pb-cb-progress-target",style:{color:P.color},children:["Target: ",Ht.targetWeight,"kg"]})]}),r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill",style:{width:`${Math.round((bs||0)*100)}%`,background:P.color}})}),r.jsxs("div",{className:"pb-cb-progress-pct",style:{color:P.color},children:[Math.round((bs||0)*100),"%"]})]}),Ht&&os&&r.jsx("div",{className:"pb-cb-card-progress",children:r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill hit",style:{width:"100%"}})})})]},Ue)})})})]},P.key)}),N.length>0&&(()=>{const P=!!Kt.other;return r.jsxs("div",{className:`pb-cb-group ${P?"open":""}`,style:{"--group-color":"var(--text-tertiary)"},children:[r.jsxs("button",{className:"pb-cb-group-header",onClick:()=>ut(U=>({...U,other:!U.other})),children:[r.jsx("div",{className:"pb-cb-group-accent"}),r.jsx("div",{className:"pb-cb-group-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})}),r.jsx("div",{className:"pb-cb-group-text",children:r.jsx("h3",{className:"pb-cb-group-label",children:"Other"})}),r.jsx("div",{className:"pb-cb-group-meta",children:r.jsxs("span",{className:"pb-cb-group-count",children:[N.length," PB",N.length!==1?"s":""]})}),r.jsx("svg",{className:`pb-cb-group-chevron ${P?"open":""}`,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M6 9l6 6 6-6"})})]}),r.jsx("div",{className:"pb-cb-group-body",style:{display:P?"block":"none"},children:r.jsx("div",{className:"pb-cb-grid",children:N.map(([U,me],Be)=>{const Ue=jt[U],Je=Pe(U),Ze=Je!==null&&Je>=1,Ht=he(U),bs=Je!==null?Math.round(Je*60):60;return r.jsxs("div",{className:"pb-cb-card",style:{animationDelay:`${Be*.05}s`},children:[r.jsxs("div",{className:"pb-cb-card-top",children:[r.jsxs("div",{className:"pb-cb-card-ring",children:[r.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:k2.map((os,ls)=>{const Cs=ls<bs;return r.jsx("line",{x1:os.x1,y1:os.y1,x2:os.x2,y2:os.y2,className:`pb-ring-tick ${Cs?Ze?"hit":"filled":"empty"}`,strokeWidth:os.thick?"2":"1.5"},ls)})}),r.jsx("div",{className:"pb-cb-ring-icon",children:Ht?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"pb-cb-badge-earned",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})})]}),r.jsxs("div",{className:"pb-cb-card-info",children:[r.jsx("h4",{className:"pb-cb-card-name",children:U}),r.jsxs("div",{className:"pb-cb-card-value",children:[me.weight,"kg  ",me.reps]}),me.achievedAt&&r.jsx("div",{className:"pb-cb-card-date",children:(me.achievedAt.toDate?me.achievedAt.toDate():new Date(me.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),Ue&&Ze&&!Ht&&r.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"}),Ht&&r.jsx("div",{className:"pb-cb-target-info earned",children:"Badge earned!"})]}),r.jsx("div",{className:"pb-cb-card-action",children:r.jsx("button",{className:"pb-cb-target-btn",onClick:()=>{gt(U),Xt("")},children:Ue?Ze&&Ht?r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 5v14M5 12h14"})}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("circle",{cx:"12",cy:"12",r:"6"}),r.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]}),Ue&&!Ze&&r.jsxs("div",{className:"pb-cb-card-progress",children:[r.jsxs("div",{className:"pb-cb-progress-labels",children:[r.jsxs("span",{className:"pb-cb-progress-current",children:[me.weight,"kg"]}),r.jsxs("span",{className:"pb-cb-progress-target",children:["Target: ",Ue.targetWeight,"kg"]})]}),r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill",style:{width:`${Math.round((Je||0)*100)}%`}})}),r.jsxs("div",{className:"pb-cb-progress-pct",children:[Math.round((Je||0)*100),"%"]})]}),Ue&&Ze&&r.jsx("div",{className:"pb-cb-card-progress",children:r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill hit",style:{width:"100%"}})})})]},U)})})})]})})()]})})()}),Object.keys(Fe).length>0&&r.jsxs("button",{className:"pb-cb-achievements-link anim-fade-up-d4",onClick:()=>Ot("/client/core-buddy/achievements"),children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"View Achievements",r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),wt&&r.jsx("div",{className:"pb-cb-target-modal-overlay",onClick:()=>gt(null),children:r.jsxs("div",{className:"pb-cb-target-modal",onClick:k=>k.stopPropagation(),children:[r.jsx("h3",{children:"Set Target"}),r.jsx("p",{className:"pb-cb-target-exercise-name",children:wt}),r.jsxs("div",{className:"pb-cb-target-current",children:["Current PB: ",r.jsxs("strong",{children:[Fe[wt]?.weight,"kg"]})]}),r.jsxs("div",{className:"pb-cb-target-input-wrap",children:[r.jsx("label",{children:"Your target (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",step:"0.5",value:le,onChange:k=>Xt(k.target.value),placeholder:String((Fe[wt]?.weight||0)+5),className:"pb-cb-target-input",autoFocus:!0})]}),r.jsxs("div",{className:"pb-cb-target-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>gt(null),children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:X,disabled:d,children:d?"Saving...":"Set Target"})]})]})})]}),Se&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-tabs",children:[r.jsx("button",{className:`pb-tab ${n==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),r.jsx("button",{className:`pb-tab ${n==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),r.jsx("button",{className:`pb-tab ${n==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),n==="bests"&&r.jsxs("div",{className:"pb-strength-section",children:[!w&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-carousel",ref:bt,onTouchStart:q,onTouchMove:we,onTouchEnd:Te,children:[r.jsx("div",{className:`pb-ring-container slide-from-${qt.current}`,children:r.jsxs("div",{className:"pb-ring",children:[r.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:eb.map((k,N)=>{const P=N<Math.round(fn);return r.jsx("line",{x1:k.x1,y1:k.y1,x2:k.x2,y2:k.y2,className:`pb-ring-tick ${P?kn?"hit":"filled":"empty"}`,strokeWidth:k.thick?"3":"2"},N)})}),r.jsxs("div",{className:"pb-ring-center",children:[r.jsx("div",{className:"pb-ring-category",children:ht.category}),r.jsxs("div",{className:"pb-ring-exercise",children:[ht.name,de("strength",ht.key)&&r.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),r.jsx("div",{className:"pb-ring-value",children:st?ht.unit==="time"?mh(st.time):I2(st.weight,st.reps):"-"}),mn!==null&&r.jsxs("div",{className:`pb-ring-change ${mn>=0?"positive":"negative"}`,children:[mn>=0?"+":"",mn.toFixed(1),"%"]}),mn===null&&st&&r.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),Fs&&r.jsx("div",{className:`pb-ring-target ${kn?"hit":""}`,children:kn?"Target hit!":Fs.targetType==="time"?`${Fs.startValue||0}s  ${Fs.targetValue}s`:`${Fs.startWeight||0}kg${Fs.startReps||0}  ${Fs.targetWeight}kg${Fs.targetReps}`}),!Fs&&r.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},g),r.jsx("div",{className:"pb-carousel-dots",children:Aa.map((k,N)=>r.jsx("button",{className:`pb-dot ${N===g?"active":""}`,onClick:()=>en(N)},N))}),r.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>en(g-1),disabled:g===0,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),r.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>en(g+1),disabled:g===Aa.length-1,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),r.jsxs("div",{className:"pb-trend-section",children:[r.jsx("h4",{children:"Trend"}),r.jsx(gP,{data:t,exerciseKey:ht.key,unit:ht.unit})]})]}),!w&&!$&&r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>j(!0),children:Ae?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>F(!0),children:Object.keys(be).length>0?"Edit Targets":"Set Targets"}),(Object.keys(be).length>0||Object.keys(_e).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:is,disabled:d,children:"Reset All Goals"})]}),w&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Benchmarks - ",pa(qe)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{j(!1),te(Ae?.benchmarks||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:Aa.map(k=>r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:k.name}),k.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:B[k.key]?.weight??"",onChange:N=>Et(k.key,"weight",N.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",value:B[k.key]?.reps??"",onChange:N=>Et(k.key,"reps",N.target.value),placeholder:"0"})]})]}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Time (seconds)"}),r.jsx("input",{type:"number",step:"0.01",value:B[k.key]?.time??"",onChange:N=>Et(k.key,"time",N.target.value),placeholder:"0"})]})})]},k.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{j(!1),te(Ae?.benchmarks||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:tt,disabled:d,children:d?"Saving...":"Save"})]})]}),$&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Set Your Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{F(!1),A(be)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),Aa.map(k=>{const N=Ae?.benchmarks?.[k.key];let P="-";return N&&(k.unit==="time"&&N.time?P=`${N.time}s`:(N.weight||N.reps)&&(P=`${N.weight||0}kg  ${N.reps||0}`)),r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:k.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",P]})]}),k.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:E[k.key]?.targetWeight??"",onChange:U=>Ut(k.key,"targetWeight",U.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Reps"}),r.jsx("input",{type:"number",value:E[k.key]?.targetReps??"",onChange:U=>Ut(k.key,"targetReps",U.target.value),placeholder:"0"})]})]}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target (seconds)"}),r.jsx("input",{type:"number",step:"1",value:E[k.key]?.targetValue??"",onChange:U=>Ut(k.key,"targetValue",U.target.value),placeholder:"0"})]})})]},k.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{F(!1),A(be)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Vt,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="metrics"&&r.jsxs("div",{className:"pb-metrics-section",children:[!T&&!V&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-metrics-card",children:[r.jsx("h3",{children:"Body Measurements"}),r.jsx("p",{className:"pb-metrics-month",children:pa(qe)}),r.jsx("div",{className:"pb-metrics-list",children:Lo.map(k=>{const N=Ae?.bodyMetrics?.[k.key],P=Ee(k.key),U=_e[k.key],me=Os(k.key),Be=me!==null&&me>=1;return r.jsxs("div",{className:"pb-metric-row",children:[r.jsxs("div",{className:"pb-metric-top",children:[r.jsxs("div",{className:"pb-metric-left",children:[r.jsxs("span",{className:"pb-metric-name",children:[k.name,de("metric",k.key)&&r.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),U&&r.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",U.targetValue," ",k.suffix]})]}),r.jsxs("div",{className:"pb-metric-values",children:[r.jsx("span",{className:"pb-metric-current",children:N!=null?`${N} ${k.suffix}`:"-"}),P!==null&&r.jsxs("span",{className:`pb-metric-change ${P>0?"up":P<0?"down":"same"}`,children:[P>0?"+":"",P," ",k.suffix]})]})]}),me!==null&&r.jsxs("div",{className:"pb-metric-progress",children:[r.jsx("div",{className:"pb-metric-bar",children:r.jsx("div",{className:`pb-metric-bar-fill ${Be?"hit":""}`,style:{width:`${Math.round(me*100)}%`}})}),r.jsx("span",{className:`pb-metric-percent ${Be?"hit":""}`,children:Be?"Hit!":`${Math.round(me*100)}%`})]})]},k.key)})})]}),r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>O(!0),children:Ae?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>D(!0),children:Object.keys(_e).length>0?"Edit Targets":"Set Targets"}),(Object.keys(be).length>0||Object.keys(_e).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:is,disabled:d,children:"Reset All Goals"})]})]}),T&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Measurements - ",pa(qe)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{O(!1),ae(Ae?.bodyMetrics||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:Lo.map(k=>r.jsx("div",{className:"pb-edit-metric",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:[k.name," (",k.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:K[k.key]??"",onChange:N=>ss(k.key,N.target.value),placeholder:"0"})]})},k.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{O(!1),ae(Ae?.bodyMetrics||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:At,disabled:d,children:d?"Saving...":"Save"})]})]}),V&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Body Metric Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{D(!1),M(_e)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),Lo.map(k=>{const N=Ae?.bodyMetrics?.[k.key];return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:k.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",N!=null?`${N} ${k.suffix}`:"-"]})]}),r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:["Target (",k.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:H[k.key]?.targetValue??"",onChange:P=>Ls(k.key,P.target.value),placeholder:"0"})]})})]},k.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{D(!1),M(_e)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Xs,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="history"&&r.jsx("div",{className:"pb-history-section",children:t.length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("h4",{children:"No records yet"}),r.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):r.jsxs(r.Fragment,{children:[$e.length>0&&r.jsxs("div",{className:"pb-achievements-wall",children:[r.jsxs("h4",{className:"pb-achievements-wall-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),r.jsx("div",{className:"pb-achievements-list",children:[...$e].reverse().map((k,N)=>r.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${N*.05}s`},children:[r.jsx("div",{className:"pb-achievement-star",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("div",{className:"pb-achievement-info",children:[r.jsx("span",{className:"pb-achievement-label",children:k.label}),r.jsx("span",{className:"pb-achievement-date",children:pa(k.achievedMonth)})]})]},N))})]}),r.jsx("div",{className:"pb-history-controls",children:r.jsx("button",{className:`pb-compare-toggle ${ee?"active":""}`,onClick:()=>{L(!ee),!ee&&t.length>=2&&(De(t[0].month),Qe(t[t.length-1].month))},children:ee?"Back to Timeline":"Compare Months"})}),ee?r.jsxs("div",{className:"pb-compare",children:[r.jsxs("div",{className:"pb-compare-selectors",children:[r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"From"}),r.jsx("select",{value:se,onChange:k=>De(k.target.value),children:t.map(k=>r.jsx("option",{value:k.month,children:pa(k.month)},k.month))})]}),r.jsx("div",{className:"pb-compare-vs",children:"vs"}),r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"To"}),r.jsx("select",{value:Le,onChange:k=>Qe(k.target.value),children:t.map(k=>r.jsx("option",{value:k.month,children:pa(k.month)},k.month))})]})]}),ke&&lt&&r.jsxs("div",{className:"pb-compare-results",children:[r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Strength Benchmarks"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Exercise"}),r.jsx("span",{children:pa(se).split(" ")[0]}),r.jsx("span",{children:pa(Le).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),Aa.map(k=>{const N=ke.benchmarks?.[k.key],P=lt.benchmarks?.[k.key],U=Vl(k,N),me=Vl(k,P),Be=tg(me,U);return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:k.name}),r.jsx("span",{className:"pb-compare-val",children:N?k.unit==="time"?mh(N.time):`${N.weight}x${N.reps}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:P?k.unit==="time"?mh(P.time):`${P.weight}x${P.reps}`:"-"}),r.jsx("span",{className:`pb-compare-change ${Be!==null?Be>=0?"positive":"negative":""}`,children:Be!==null?`${Be>=0?"+":""}${Be.toFixed(1)}%`:"-"})]},k.key)})]})]}),r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Body Measurements"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Measurement"}),r.jsx("span",{children:pa(se).split(" ")[0]}),r.jsx("span",{children:pa(Le).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),Lo.map(k=>{const N=ke.bodyMetrics?.[k.key],P=lt.bodyMetrics?.[k.key],U=N!=null&&P!=null?parseFloat((P-N).toFixed(2)):null;return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:k.name}),r.jsx("span",{className:"pb-compare-val",children:N!=null?`${N}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:P!=null?`${P}`:"-"}),r.jsx("span",{className:`pb-compare-change ${U!==null?U>0?"positive":U<0?"negative":"neutral":""}`,children:U!==null?`${U>0?"+":""}${U} ${k.suffix}`:"-"})]},k.key)})]})]})]})]}):r.jsx("div",{className:"pb-timeline",children:[...t].reverse().map((k,N)=>{const P=t.find(U=>U.month<k.month&&t.indexOf(U)===t.indexOf(k)-1)||t.filter(U=>U.month<k.month).pop();return r.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${N*.05}s`},children:[r.jsx("div",{className:"pb-timeline-dot"}),r.jsxs("div",{className:"pb-timeline-card",children:[r.jsx("h4",{children:pa(k.month)}),k.benchmarks&&Object.keys(k.benchmarks).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Strength Benchmarks"}),Aa.map(U=>{const me=k.benchmarks[U.key];if(!me)return null;const Be=P?.benchmarks?.[U.key],Ue=Vl(U,me),Je=Vl(U,Be),Ze=tg(Ue,Je);return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:U.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsx("span",{className:"pb-timeline-value",children:U.unit==="time"?mh(me.time):I2(me.weight,me.reps)}),Ze!==null&&r.jsxs("span",{className:`pb-timeline-change ${Ze>=0?"positive":"negative"}`,children:[Ze>=0?"+":"",Ze.toFixed(1),"%"]})]})]},U.key)})]}),k.bodyMetrics&&Object.keys(k.bodyMetrics).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Body Measurements"}),Lo.map(U=>{const me=k.bodyMetrics[U.key];if(me==null)return null;const Be=P?.bodyMetrics?.[U.key],Ue=Be!=null?parseFloat((me-Be).toFixed(2)):null;return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:U.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsxs("span",{className:"pb-timeline-value",children:[me," ",U.suffix]}),Ue!==null&&r.jsxs("span",{className:`pb-timeline-change ${Ue>0?"positive":Ue<0?"negative":"neutral"}`,children:[Ue>0?"+":"",Ue," ",U.suffix]})]})]},U.key)})]})]})]},k.id)})})]})})]})]}),W&&r.jsx("div",{className:"pb-celebration-overlay",onClick:()=>pe(null),children:r.jsxs("div",{className:"pb-celebration-card",children:[r.jsx("div",{className:"pb-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pb-celebration-title",children:W.length===1?"Target Achieved!":`${W.length} Targets Achieved!`}),r.jsx("div",{className:"pb-celebration-badges",children:W.map((k,N)=>r.jsx("div",{className:"pb-celebration-badge",children:k.label},N))}),r.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),Ve&&r.jsxs("div",{className:`toast-notification ${Ve.type}`,children:[r.jsx("span",{className:"toast-icon",children:Ve.type==="success"?r.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),r.jsx("span",{className:"toast-message",children:Ve.message}),r.jsx("button",{className:"toast-close",onClick:()=>We(null),children:""})]}),Se&&r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:"block-nav-tab",onClick:()=>Ot("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),r.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),r.jsx("span",{children:"Home"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>Ot("/client/forms"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),r.jsx("polyline",{points:"14 2 14 8 20 8"}),r.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),r.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),r.jsx("span",{children:"Forms"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>Ot("/client/tools"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),r.jsx("span",{children:"Tools"})]}),r.jsxs("button",{className:"block-nav-tab active",children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20V10"}),r.jsx("path",{d:"M18 20V4"}),r.jsx("path",{d:"M6 20v-4"})]}),r.jsx("span",{children:"PBs"})]}),Ct?.circuitAccess&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>Ot("/client/circuit"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 6v6l4 2"})]}),r.jsx("span",{children:"Circuit"})]})]}),ue&&r.jsx(aa,{active:"progress"})]})})}const bP=v.lazy(()=>wr(()=>import("./Dashboard-NejMejMz.js"),__vite__mapDeps([0,1]))),vP=v.lazy(()=>wr(()=>import("./AddClient-CUyDBorz.js"),__vite__mapDeps([2,3]))),xP=v.lazy(()=>wr(()=>import("./ClientDashboard-BlM05aFF.js"),[])),wP=v.lazy(()=>wr(()=>import("./ClientForms-C1cfcQEA.js"),__vite__mapDeps([4,5]))),_P=v.lazy(()=>wr(()=>import("./ClientTools-BhEZbPS0.js"),__vite__mapDeps([6,7]))),kP=v.lazy(()=>wr(()=>import("./MacroCalculator-CCbxIbo0.js"),__vite__mapDeps([8,7]))),jP=v.lazy(()=>wr(()=>import("./ProteinSnacks-SVV6tjuE.js"),__vite__mapDeps([9,7]))),TP=v.lazy(()=>wr(()=>import("./DailyMotivation-DVmQaCDv.js"),__vite__mapDeps([10,7]))),EP=v.lazy(()=>wr(()=>import("./CircuitDashboard-Cf1Ye90f.js"),__vite__mapDeps([11,12]))),SP=v.lazy(()=>wr(()=>import("./CircuitBooking-Cggw6SPs.js"),__vite__mapDeps([13,14,12]))),NP=v.lazy(()=>wr(()=>import("./Leaderboard-5ht5Rdhe.js"),__vite__mapDeps([15,16]))),CP=v.lazy(()=>wr(()=>import("./UpgradePage-Cq2WeiJO.js"),__vite__mapDeps([17,18,19]))),RP=v.lazy(()=>wr(()=>import("./SignUp-DCdXOgTj.js"),[])),AP=v.lazy(()=>wr(()=>import("./Onboarding-DYeR6Xca.js"),__vite__mapDeps([20,18,21])));function IP({children:n}){const{pathname:e}=_a();return v.useEffect(()=>{"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")},[]),v.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"})},[e]),n}function MP(){const n=$n();return v.useEffect(()=>{const e=sessionStorage.getItem("redirect");if(e){sessionStorage.removeItem("redirect");const t=e.replace("/login","")||"/";n(t,{replace:!0})}},[n]),null}function DP(){return r.jsx(G3,{children:r.jsx(W3,{children:r.jsx(X3,{children:r.jsxs(tS,{basename:"/login",children:[r.jsx(MP,{}),r.jsx(IP,{children:r.jsx(v.Suspense,{fallback:null,children:r.jsxs(RE,{children:[r.jsx(Qs,{path:"/",element:r.jsx(eD,{})}),r.jsx(Qs,{path:"/dashboard",element:r.jsx(bP,{})}),r.jsx(Qs,{path:"/add-client",element:r.jsx(vP,{})}),r.jsx(Qs,{path:"/client",element:r.jsx(xP,{})}),r.jsx(Qs,{path:"/client/forms",element:r.jsx(wP,{})}),r.jsx(Qs,{path:"/client/tools",element:r.jsx(_P,{})}),r.jsx(Qs,{path:"/client/tools/macros",element:r.jsx(kP,{})}),r.jsx(Qs,{path:"/client/tools/snacks",element:r.jsx(jP,{})}),r.jsx(Qs,{path:"/client/tools/motivation",element:r.jsx(TP,{})}),r.jsx(Qs,{path:"/client/personal-bests",element:r.jsx(yP,{})}),r.jsx(Qs,{path:"/client/circuit",element:r.jsx(EP,{})}),r.jsx(Qs,{path:"/client/circuit/booking",element:r.jsx(SP,{})}),r.jsx(Qs,{path:"/client/core-buddy",element:r.jsx(_D,{})}),r.jsx(Qs,{path:"/client/core-buddy/nutrition",element:r.jsx(Ml,{feature:"nutrition",children:r.jsx(TD,{})})}),r.jsx(Qs,{path:"/client/core-buddy/workouts",element:r.jsx(OD,{})}),r.jsx(Qs,{path:"/client/core-buddy/programmes",element:r.jsx(Ml,{feature:"programmes",children:r.jsx(zD,{})})}),r.jsx(Qs,{path:"/client/core-buddy/achievements",element:r.jsx(Ml,{feature:"achievements",children:r.jsx(KD,{})})}),r.jsx(Qs,{path:"/client/core-buddy/consistency",element:r.jsx(Ml,{feature:"consistency",children:r.jsx(tP,{})})}),r.jsx(Qs,{path:"/client/core-buddy/buddies",element:r.jsx(Ml,{feature:"buddies",children:r.jsx(sP,{})})}),r.jsx(Qs,{path:"/client/core-buddy/buddy",element:r.jsx(oP,{})}),r.jsx(Qs,{path:"/client/core-buddy/profile/:userId",element:r.jsx(iP,{})}),r.jsx(Qs,{path:"/client/leaderboard",element:r.jsx(Ml,{feature:"leaderboard",children:r.jsx(NP,{})})}),r.jsx(Qs,{path:"/signup",element:r.jsx(RP,{})}),r.jsx(Qs,{path:"/onboarding",element:r.jsx(AP,{})}),r.jsx(Qs,{path:"/upgrade",element:r.jsx(CP,{})}),r.jsx(Qs,{path:"*",element:r.jsx(NE,{to:"/",replace:!0})})]})})})]})})})})}CT.createRoot(document.getElementById("root")).render(r.jsx(v.StrictMode,{children:r.jsx(DP,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/login/sw.js").catch(()=>{})});export{Hr as A,aa as C,xa as P,xt as T,hi as a,yr as b,zt as c,ge as d,ze as e,GC as f,Ts as g,JC as h,Es as i,r as j,Rs as k,Mr as l,ka as m,$n as n,Gh as o,eb as p,Ds as q,v as r,OP as s,wm as t,Ma as u,Z3 as v,ds as w,J3 as x,PP as y,iS as z};
